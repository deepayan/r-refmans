<!DOCTYPE html><html><head><title>Help for package RRTCS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RRTCS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#RRTCS-package'><p>Randomized Response Techniques for Complex Surveys</p></a></li>
<li><a href='#BarLev'><p>BarLev model</p></a></li>
<li><a href='#BarLevData'><p>Randomized Response Survey on industrial company income</p></a></li>
<li><a href='#ChaudhuriChristofides'><p>Chaudhuri-Christofides model</p></a></li>
<li><a href='#ChaudhuriChristofidesData'><p>Randomized Response Survey on agricultural subsidies</p></a></li>
<li><a href='#ChaudhuriChristofidesDatapij'><p>Matrix of the second-order inclusion probabilities</p></a></li>
<li><a href='#Christofides'><p>Christofides model</p></a></li>
<li><a href='#ChristofidesData'><p>Randomized Response Survey on eating disorders</p></a></li>
<li><a href='#Devore'><p>Devore model</p></a></li>
<li><a href='#DevoreData'><p>Randomized Response Survey on instant messaging</p></a></li>
<li><a href='#DianaPerri1'><p>Diana-Perri-1 model</p></a></li>
<li><a href='#DianaPerri1Data'><p>Randomized Response Survey on defrauded taxes</p></a></li>
<li><a href='#DianaPerri2'><p>Diana-Perri-2 model</p></a></li>
<li><a href='#DianaPerri2Data'><p>Randomized Response Survey of a simulated population</p></a></li>
<li><a href='#EichhornHayre'><p>Eichhorn-Hayre model</p></a></li>
<li><a href='#EichhornHayreData'><p>Randomized Response Survey on family income</p></a></li>
<li><a href='#Eriksson'><p>Eriksson model</p></a></li>
<li><a href='#ErikssonData'><p>Randomized Response Survey on student cheating</p></a></li>
<li><a href='#ForcedResponse'><p>Forced-Response model</p></a></li>
<li><a href='#ForcedResponseData'><p>Randomized Response Survey of a simulated population</p></a></li>
<li><a href='#ForcedResponseDataSt'><p>Randomized Response Survey on infertility</p></a></li>
<li><a href='#Horvitz'><p>Horvitz model</p></a></li>
<li><a href='#HorvitzData'><p>Randomized Response Survey on student bullying</p></a></li>
<li><a href='#HorvitzDataRealSurvey'><p>Randomized Response Survey on a sensitive questions</p></a></li>
<li><a href='#HorvitzDataStCl'><p>Randomized Response Survey on infidelity</p></a></li>
<li><a href='#HorvitzUB'><p>Horvitz-UB model</p></a></li>
<li><a href='#HorvitzUBData'><p>Randomized Response Survey on drugs use</p></a></li>
<li><a href='#Kuk'><p>Kuk model</p></a></li>
<li><a href='#KukData'><p>Randomized Response Survey on excessive sexual activity</p></a></li>
<li><a href='#Mangat'><p>Mangat model</p></a></li>
<li><a href='#MangatSingh'><p>Mangat-Singh model</p></a></li>
<li><a href='#MangatSinghData'><p>Randomized Response Survey on cannabis use</p></a></li>
<li><a href='#MangatSinghSingh'><p>Mangat-Singh-Singh model</p></a></li>
<li><a href='#MangatSinghSinghData'><p>Randomized Response Survey on internet betting</p></a></li>
<li><a href='#MangatSinghSinghUB'><p>Mangat-Singh-Singh-UB model</p></a></li>
<li><a href='#MangatSinghSinghUBData'><p>Randomized Response Survey on overuse of the internet</p></a></li>
<li><a href='#MangatUB'><p>Mangat-UB model</p></a></li>
<li><a href='#ResamplingVariance'><p>Resampling variance of randomized response models</p></a></li>
<li><a href='#RRTCS-internal'><p>Internal RRTCS Functions</p></a></li>
<li><a href='#Saha'><p>Saha model</p></a></li>
<li><a href='#SahaData'><p>Randomized Response Survey on spending on alcohol</p></a></li>
<li><a href='#SinghJoarder'><p>Singh-Joarder model</p></a></li>
<li><a href='#SinghJoarderData'><p>Randomized Response Survey on compulsive spending</p></a></li>
<li><a href='#SoberanisCruz'><p>SoberanisCruz model</p></a></li>
<li><a href='#SoberanisCruzData'><p>Randomized Response Survey on speeding</p></a></li>
<li><a href='#Warner'><p>Warner model</p></a></li>
<li><a href='#WarnerData'><p>Randomized Response Survey on alcohol abuse</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Randomized Response Techniques for Complex Surveys</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-04-22</td>
</tr>
<tr>
<td>Author:</td>
<td>Beatriz Cobo Rodríguez, María del Mar Rueda García, Antonio Arcos
    Cebrián</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Beatriz Cobo Rodríguez &lt;beacr@ugr.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Point and interval estimation of linear parameters with data
    obtained from complex surveys (including stratified and clustered samples)
    when randomization techniques are used. The randomized response technique
    was developed to obtain estimates that are more valid when studying
    sensitive topics. Estimators and variances for 14 randomized response
    methods for qualitative variables and 7 randomized response methods for
    quantitative variables are also implemented. In addition, some data sets
    from surveys with these randomization methods are included in the package.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>sampling, samplingVarEst, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>markdown, knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-04-21 07:59:22 UTC; Beatriz</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-04-21 08:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='RRTCS-package'>Randomized Response Techniques for Complex Surveys</h2><span id='topic+RRTCS-package'></span>

<h3>Description</h3>

<p>The aim of this package is to calculate point and interval estimation for linear parameters with data obtained from randomized response surveys.
Twenty one RR methods are implemented for complex surveys:
</p>
<p>- Randomized response procedures to estimate parameters of a qualitative stigmatizing characteristic: Christofides model, Devore model, Forced-Response model,
Horvitz model, Horvitz model with unknown B, Kuk model, Mangat model, Mangat model with unknown B, Mangat-Singh model, Mangat-Singh-Singh model,
Mangat-Singh-Singh model with unknown B, Singh-Joarder model, SoberanisCruz model and Warner model.
</p>
<p>- Randomized response procedures to estimate parameters of a quantitative stigmatizing characteristic: BarLev model, Chaudhuri-Christofides model,
Diana-Perri-1 model, Diana-Perri-2 model, Eichhorn-Hayre model, Eriksson model and Saha model.
</p>
<p>Using the usual notation in survey sampling, we consider a finite population <code class="reqn">U=\{1,\ldots,i,\ldots,N\}</code>, consisting of <code class="reqn">N</code> different elements.
Let <code class="reqn">y_i</code> be the value of the sensitive aspect under study for the <code class="reqn">i</code>th population element. Our aim is to estimate the finite population total
<code class="reqn">Y=\sum_{i=1}^N y_i</code> of the variable of interest <code class="reqn">y</code> or the population mean <code class="reqn">\bar{Y}=\frac{1}{N}\sum_{i=1}^N y_i</code>. If we can estimate the
proportion of the population presenting a certain stigmatized behaviour <code class="reqn">A</code>, the variable <code class="reqn">y_i</code> takes the value 1 if <code class="reqn">i\in G_A</code>
(the group with the stigmatized behaviour) and the value zero otherwise. Some qualitative models use an innocuous or related attribute <code class="reqn">B</code> whose
population proportion can be known or unknown.
</p>
<p>Assume that a sample <code class="reqn">s</code> is chosen according to a general design <code class="reqn">p</code> with inclusion probabilities <code class="reqn">\pi_i=\sum_{s\ni i}p(s),i\in U</code>.
</p>
<p>In order to include a wide variety of RR procedures, we consider the unified approach given by Arnab (1994). The interviews of individuals in the sample <code class="reqn">s</code>
are conducted in accordance with the RR model. For each <code class="reqn">i\in s</code> the RR induces a random response <code class="reqn">z_i</code> (denoted scrambled response) so that the revised
randomized response <code class="reqn">r_i</code> (Chaudhuri and Christofides, 2013) is an unbiased estimation of <code class="reqn">y_i</code>. Then, an unbiased estimator for the population total of
the sensitive characteristic <code class="reqn">y</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">\widehat{Y}_R=\sum_{i\in s}\frac{r_i}{\pi_i}</code>
</p>

<p>The variance of this estimator is given by:
</p>
<p style="text-align: center;"><code class="reqn">V(\widehat{Y}_R)=\sum_{i\in U}\frac{V_R(r_i)}{\pi_i}+V_{HT}(r)</code>
</p>

<p>where <code class="reqn">V_R(r_i)</code> is the variance of <code class="reqn">r_i</code> under the randomized device and <code class="reqn">V_{HT}(r)</code> is the design-variance of the Horvitz Thompson estimator
of <code class="reqn">r_i</code> values.
</p>
<p>This variance is estimated by:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{V}(\widehat{Y}_R)=\sum_{i\in s}\frac{\widehat{V}_R(r_i)}{\pi_i}+\widehat{V}(r)</code>
</p>

<p>where <code class="reqn">\widehat{V}_R(r_i)</code> varies with the RR device and the estimation of the design-variance, <code class="reqn">\widehat{V}(r)</code>, is obtained using Deville's method
(Deville, 1993).
</p>
<p>The confidence interval at <code class="reqn">(1-\alpha)</code> % level is given by
</p>
<p style="text-align: center;"><code class="reqn">ci=\left(\widehat{Y}_R-z_{1-\frac{\alpha}{2}}\sqrt{\widehat{V}(\widehat{Y}_R)},\widehat{Y}_R+z_{1-\frac{\alpha}{2}}\sqrt{\widehat{V}(\widehat{Y}_R)}\right)</code>
</p>

<p>where <code class="reqn">z_{1-\frac{\alpha}{2}}</code> denotes the <code class="reqn">(1-\alpha)</code> % quantile of a standard normal distribution.
</p>
<p>Similarly, an unbiased estimator for the population mean <code class="reqn">\bar{Y}</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\bar{Y}}_R= \frac{1}{N}\sum_{i\in s}\frac{r_i}{\pi_i}</code>
</p>

<p>and an unbiased estimator for its variance is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{V}(\widehat{\bar{Y}}_R)=\frac{1}{N^2}\left(\sum_{i\in s}\frac{\widehat{V}_R(r_i)}{\pi_i}+\widehat{V}(r)\right)</code>
</p>

<p>In cases where the population size <code class="reqn">N</code> is unknown, we consider Hàjek-type estimators for the mean:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\bar{Y}}_{RH}=\frac{\sum_{i\in s}r_i}{\sum_{i\in s}\frac{1}{\pi_i}}</code>
</p>

<p>and Taylor-series linearization variance estimation of the ratio (Wolter, 2007) is used.
</p>
<p>In qualitative models, the values <code class="reqn">r_i</code> and <code class="reqn">\widehat{V}_R(r_i)</code> for <code class="reqn">i\in s</code> are described in each model.
</p>
<p>In some quantitative models, the values <code class="reqn">r_i</code> and <code class="reqn">\widehat{V}_R(r_i)</code> for <code class="reqn">i\in s</code> are calculated in a general form (Arcos et al, 2015) as follows:
</p>
<p>The randomized response given by the person <code class="reqn">i</code> is
</p>
<p style="text-align: center;"><code class="reqn">z_i=\left\{\begin{array}{lccc}
y_i &amp; \textrm{with probability } p_1\\
y_iS_1+S_2 &amp; \textrm{with probability } p_2\\
S_3 &amp; \textrm{with probability } p_3
\end{array}
\right.</code>
</p>

<p>with <code class="reqn">p_1+p_2+p_3=1</code> and where <code class="reqn">S_1,S_2</code> and <code class="reqn">S_3</code> are scramble variables whose distributions are assumed to be known. We denote by <code class="reqn">\mu_i</code>
and <code class="reqn">\sigma_i</code> respectively the mean and standard deviation of the variable <code class="reqn">S_i,(i=1,2,3)</code>.
</p>
<p>The transformed variable is
</p>
<p style="text-align: center;"><code class="reqn">r_i=\frac{z_i-p_2\mu_2-p_3\mu_3}{p_1+p_2\mu_1},</code>
</p>

<p>its variance is
</p>
<p style="text-align: center;"><code class="reqn">V_R(r_i)=\frac{1}{(p_1+p_2\mu_1)^2}(y_i^2A+y_iB+C)</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">A=p_1(1-p_1)+\sigma_1^2p_2+\mu_1^2p_2-\mu_1^2p_2^2-2p_1p_2\mu_1</code>
</p>

<p style="text-align: center;"><code class="reqn">B=2p_2\mu_1\mu_2-2\mu_1\mu_2p_2^2-2p_1p_2\mu_2-2\mu_3p_1p_3-2\mu_1\mu_3p_2p_3</code>
</p>

<p style="text-align: center;"><code class="reqn">C=(\sigma_2^2+\mu_2^2)p_2+(\sigma_3^2+\mu_3^2)p_3-(\mu_2p_2+\mu_3p_3)^2</code>
</p>

<p>and the estimated variance is
</p>
<p style="text-align: center;"><code class="reqn">\widehat{V}_R(r_i)=\frac{1}{(p_1+p_2\mu_1)^2}(r_i^2A+r_iB+C).</code>
</p>

<p>Some of the quantitative techniques considered can be viewed as particular cases of the above described procedure. Other models are described in the respective function.
</p>
<p>Alternatively, the variance can be estimated using certain resampling methods.
</p>


<h3>Author(s)</h3>

<p>Beatriz Cobo Rodríguez, Department of Statistics and Operations Research. University of Granada <a href="mailto:beacr@ugr.es">beacr@ugr.es</a>
</p>
<p>María del Mar Rueda García, Department of Statistics and Operations Research. University of Granada <a href="mailto:mrueda@ugr.es">mrueda@ugr.es</a>
</p>
<p>Antonio Arcos Cebrián, Department of Statistics and Operations Research. University of Granada <a href="mailto:arcos@ugr.es">arcos@ugr.es</a>
</p>
<p>Maintainer: Beatriz Cobo Rodríguez <a href="mailto:beacr@ugr.es">beacr@ugr.es</a>
</p>


<h3>References</h3>

<p>Arcos, A., Rueda, M., Singh, S. (2015).
<em>A generalized approach to randomised response for quantitative variables.</em>
Quality and Quantity 49, 1239-1256.
</p>
<p>Arnab, R. (1994).
<em>Non-negative variance estimator in randomized response surveys.</em>
Comm. Stat. Theo. Math. 23, 1743-1752.
</p>
<p>Chaudhuri, A., Christofides, T.C. (2013).
<em>Indirect Questioning in Sample Surveys</em>
Springer-Verlag Berlin Heidelberg.
</p>
<p>Deville, J.C. (1993).
<em>Estimation de la variance pour les enquêtes en deux phases.</em>
Manuscript, INSEE, Paris.
</p>
<p>Wolter, K.M. (2007).
<em>Introduction to Variance Estimation.</em>
2nd Edition. Springer.
</p>

<hr>
<h2 id='BarLev'>BarLev model</h2><span id='topic+BarLev'></span>

<h3>Description</h3>

<p>Computes the randomized response estimation, its variance estimation and its confidence interval through the BarLev model.
The function can also return the transformed variable.
The BarLev model was proposed by Bar-Lev et al. in 2004.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BarLev(z,p,mu,sigma,pi,type=c("total","mean"),cl,N=NULL,pij=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BarLev_+3A_z">z</code></td>
<td>
<p>vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="BarLev_+3A_p">p</code></td>
<td>
<p>probability of direct response</p>
</td></tr>
<tr><td><code id="BarLev_+3A_mu">mu</code></td>
<td>
<p>mean of the scramble variable <code class="reqn">S</code></p>
</td></tr>
<tr><td><code id="BarLev_+3A_sigma">sigma</code></td>
<td>
<p>standard deviation of the scramble variable <code class="reqn">S</code></p>
</td></tr>
<tr><td><code id="BarLev_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilities</p>
</td></tr>
<tr><td><code id="BarLev_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="BarLev_+3A_cl">cl</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="BarLev_+3A_n">N</code></td>
<td>
<p>size of the population. By default it is NULL</p>
</td></tr>
<tr><td><code id="BarLev_+3A_pij">pij</code></td>
<td>
<p>matrix of the second-order inclusion probabilities. By default it is NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The randomized  response given by the person <code class="reqn">i</code> is
</p>
<p style="text-align: center;"><code class="reqn">z_i=\left\{\begin{array}{lcc}
y_i &amp; \textrm{with probability } p\\
y_iS &amp; \textrm{with probability } 1-p\\
\end{array}
\right.</code>
</p>

<p>where <code class="reqn">S</code> is a scramble variable, whose mean <code class="reqn">\mu</code> and standard deviation <code class="reqn">\sigma</code> are known.
</p>


<h3>Value</h3>

<p>Point and confidence estimates of the sensitive characteristics using the BarLev model. The transformed variable is also reported, if required.
</p>


<h3>References</h3>

<p>Bar-Lev S.K., Bobovitch, E., Boukai, B. (2004).
<em>A note on randomized response models for quantitative data.</em>
Metrika, 60, 255-260.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BarLevData">BarLevData</a></code>
</p>
<p><code><a href="#topic+ResamplingVariance">ResamplingVariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(BarLevData)
dat=with(BarLevData,data.frame(z,Pi))
p=0.6
mu=1
sigma=1
cl=0.95
BarLev(dat$z,p,mu,sigma,dat$Pi,"total",cl)
</code></pre>

<hr>
<h2 id='BarLevData'>Randomized Response Survey on industrial company income</h2><span id='topic+BarLevData'></span>

<h3>Description</h3>

<p>This data set contains observations from a randomized response survey conducted in a population of 2396 industrial companies in a city to investigate their income.
The sample is drawn by stratified sampling with probabilities proportional to the size of the company.
The randomized response technique used is the BarLev model (Bar-Lev et al, 2004) with parameter <code class="reqn">p=0.6</code> and scramble variable <code class="reqn">S=exp(1)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(BarLevData)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 370 observations of a sample of companies divided into three strata.
The variables are:
</p>

<ul>
<li><p> ID: Survey ID
</p>
</li>
<li><p> ST: Strata ID
</p>
</li>
<li><p> z: The randomized response to the question: What was the company's income in the previous fiscal year?
</p>
</li>
<li><p> Pi: first-order inclusion probabilities
</p>
</li></ul>


<h3>References</h3>

<p>Bar-Lev S.K., Bobovitch, E., Boukai, B. (2004).
<em>A note on randomized response models for quantitative data.</em>
Metrika, 60, 255-260.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BarLev">BarLev</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(BarLevData)
</code></pre>

<hr>
<h2 id='ChaudhuriChristofides'>Chaudhuri-Christofides model</h2><span id='topic+ChaudhuriChristofides'></span>

<h3>Description</h3>

<p>Computes the randomized response estimation, its variance estimation and its confidence interval through the Chaudhuri-Christofides model.
The function can also return the transformed variable.
The Chaudhuri-Christofides model can be seen in Chaudhuri and Christofides (2013, page 97).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ChaudhuriChristofides(z,mu,sigma,pi,type=c("total","mean"),cl,N=NULL,pij=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ChaudhuriChristofides_+3A_z">z</code></td>
<td>
<p>vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="ChaudhuriChristofides_+3A_mu">mu</code></td>
<td>
<p>vector with the means of the scramble variables</p>
</td></tr>
<tr><td><code id="ChaudhuriChristofides_+3A_sigma">sigma</code></td>
<td>
<p>vector with the standard deviations of the scramble variables</p>
</td></tr>
<tr><td><code id="ChaudhuriChristofides_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilities</p>
</td></tr>
<tr><td><code id="ChaudhuriChristofides_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="ChaudhuriChristofides_+3A_cl">cl</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="ChaudhuriChristofides_+3A_n">N</code></td>
<td>
<p>size of the population. By default it is NULL</p>
</td></tr>
<tr><td><code id="ChaudhuriChristofides_+3A_pij">pij</code></td>
<td>
<p>matrix of the second-order inclusion probabilities. By default it is NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The randomized response given by the person <code class="reqn">i</code> is <code class="reqn">z_i=y_iS_1+S_2</code> where <code class="reqn">S_1,S_2</code> are scramble variables, whose mean <code class="reqn">\mu</code> and
standard deviation <code class="reqn">\sigma</code> are known.
</p>


<h3>Value</h3>

<p>Point and confidence estimates of the sensitive characteristics using the Chaudhuri-Christofides model. The transformed variable is also reported, if required.
</p>


<h3>References</h3>

<p>Chaudhuri, A., and Christofides, T.C. (2013)
<em>Indirect Questioning in Sample Surveys.</em>
Springer-Verlag Berlin Heidelberg.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ChaudhuriChristofidesData">ChaudhuriChristofidesData</a></code>
</p>
<p><code><a href="#topic+ChaudhuriChristofidesDatapij">ChaudhuriChristofidesDatapij</a></code>
</p>
<p><code><a href="#topic+ResamplingVariance">ResamplingVariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N=417
data(ChaudhuriChristofidesData)
dat=with(ChaudhuriChristofidesData,data.frame(z,Pi))
mu=c(6,6)
sigma=sqrt(c(10,10))
cl=0.95
data(ChaudhuriChristofidesDatapij)
ChaudhuriChristofides(dat$z,mu,sigma,dat$Pi,"mean",cl,pij=ChaudhuriChristofidesDatapij)
</code></pre>

<hr>
<h2 id='ChaudhuriChristofidesData'>Randomized Response Survey on agricultural subsidies</h2><span id='topic+ChaudhuriChristofidesData'></span>

<h3>Description</h3>

<p>This data set contains observations from a randomized response survey conducted in a population of 417 individuals in a municipality to investigate the agricultural subsidies.
The sample is drawn by sampling with unequal probabilities (probability proportional to agricultural subsidies in the previous year).
The randomized response technique used is the Chaudhuri-Christofides model (Chaudhuri and Christofides, 2013) with scramble variables <code class="reqn">S_1=U(1,...,11)</code> and <code class="reqn">S_2=U(1,...,11)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ChaudhuriChristofidesData)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 100 observations.
The variables are:
</p>

<ul>
<li><p> ID: Survey ID
</p>
</li>
<li><p> z: The randomized response to the question: What are your annual agricultural subsidies?
</p>
</li>
<li><p> Pi: first-order inclusion probabilities
</p>
</li></ul>


<h3>References</h3>

<p>Chaudhuri, A., and Christofides, T.C. (2013)
<em>Indirect Questioning in Sample Surveys.</em>
Springer-Verlag Berlin Heidelberg.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ChaudhuriChristofides">ChaudhuriChristofides</a></code>
</p>
<p><code><a href="#topic+ChaudhuriChristofidesDatapij">ChaudhuriChristofidesDatapij</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ChaudhuriChristofidesData)
</code></pre>

<hr>
<h2 id='ChaudhuriChristofidesDatapij'>Matrix of the second-order inclusion probabilities</h2><span id='topic+ChaudhuriChristofidesDatapij'></span>

<h3>Description</h3>

<p>This dataset consists of a square matrix of dimension 100 with the first and second order inclusion probabilities
for the units included in sample <code class="reqn">s</code>, drawn from a population of size <code class="reqn">N=417</code> according to a
sampling with unequal probabilities (probability proportional to agricultural subsidies in the previous year).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ChaudhuriChristofidesDatapij)
</code></pre>


<h3>See Also</h3>

<p><code><a href="#topic+ChaudhuriChristofides">ChaudhuriChristofides</a></code>
</p>
<p><code><a href="#topic+ChaudhuriChristofidesData">ChaudhuriChristofidesData</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ChaudhuriChristofidesDatapij)
#Now, let select only the first-order inclusion probabilities
diag(ChaudhuriChristofidesDatapij)
</code></pre>

<hr>
<h2 id='Christofides'>Christofides model</h2><span id='topic+Christofides'></span>

<h3>Description</h3>

<p>Computes the randomized response estimation, its variance estimation and its confidence interval through the Christofides model.
The function can also return the transformed variable.
The Christofides model was proposed by Christofides in 2003.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Christofides(z,mm,pm,pi,type=c("total","mean"),cl,N=NULL,pij=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Christofides_+3A_z">z</code></td>
<td>
<p>vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="Christofides_+3A_mm">mm</code></td>
<td>
<p>vector with the marks of the cards</p>
</td></tr>
<tr><td><code id="Christofides_+3A_pm">pm</code></td>
<td>
<p>vector with the probabilities of previous marks</p>
</td></tr>
<tr><td><code id="Christofides_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilities</p>
</td></tr>
<tr><td><code id="Christofides_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="Christofides_+3A_cl">cl</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="Christofides_+3A_n">N</code></td>
<td>
<p>size of the population. By default it is NULL</p>
</td></tr>
<tr><td><code id="Christofides_+3A_pij">pij</code></td>
<td>
<p>matrix of the second-order inclusion probabilities. By default it is NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the Christofides randomized response technique, a sampled person <code class="reqn">i</code> is given a box with identical cards, each bearing a separate mark as
<code class="reqn">1,\dots,k,\dots m</code> with <code class="reqn">m\geq 2</code> but in known proportions <code class="reqn">p_1,\dots,p_k,\dots p_m</code> with <code class="reqn">0&lt;p_k&lt; 1</code> for <code class="reqn">k=1,\dots,m</code> and
<code class="reqn">\sum_{k=1}^{m}p_k=1</code>. The person sampled is requested to draw one of the cards and respond
</p>
<p style="text-align: center;"><code class="reqn">z_i=\left \{\begin{array}{lcc}
k &amp; \textrm{if a card marked } k \textrm{ is drawn and the person bears } A^c\\
m-k+1 &amp; \textrm{if a card marked } k \textrm{ is drawn but the person bears } A
\end{array}
\right .</code>
</p>

<p>The transformed variable is <code class="reqn">r_i=\frac{z_i-\mu}{m+1-2\mu}</code> where <code class="reqn">\mu=\sum_{k=1}^{m}kp_k</code> and the estimated variance is
<code class="reqn">\widehat{V}_R(r_i)=\frac{V_R(k)}{(m+1-2\mu)^2}</code>, where <code class="reqn">V_R(k)=\sum_{k=1}^{m}k^2p_k-\mu^2</code>.
</p>


<h3>Value</h3>

<p>Point and confidence estimates of the sensitive characteristics using the Christofides model. The transformed variable is also reported, if required.
</p>


<h3>References</h3>

<p>Christofides, T.C. (2003).
<em>A generalized randomized response technique.</em>
Metrika, 57, 195-200.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ChristofidesData">ChristofidesData</a></code>
</p>
<p><code><a href="#topic+ResamplingVariance">ResamplingVariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N=802
data(ChristofidesData)
dat=with(ChristofidesData,data.frame(z,Pi))
mm=c(1,2,3,4,5)
pm=c(0.1,0.2,0.3,0.2,0.2)
cl=0.95
Christofides(dat$z,mm,pm,dat$Pi,"mean",cl,N)
</code></pre>

<hr>
<h2 id='ChristofidesData'>Randomized Response Survey on eating disorders</h2><span id='topic+ChristofidesData'></span>

<h3>Description</h3>

<p>This data set contains observations from a randomized response survey conducted in a university to investigate eating disorders.
The sample is drawn by simple random sampling without replacement.
The randomized response technique used is the Christofides model (Christofides, 2003) with parameters, <code class="reqn">mm=(1,2,3,4,5)</code> and <code class="reqn">pm=(0.1,0.2,0.3,0.2,0.2)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ChristofidesData)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 150 observations from a population of <code class="reqn">N=802</code> students. The variables are:
</p>

<ul>
<li><p> ID: Survey ID of student respondent
</p>
</li>
<li><p> z: The randomized response to the question: Do you have problems of anorexia or bulimia?
</p>
</li>
<li><p> Pi: first-order inclusion probabilities
</p>
</li></ul>


<h3>References</h3>

<p>Christofides, T.C. (2003).
<em>A generalized randomized response technique.</em>
Metrika, 57, 195-200.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Christofides">Christofides</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ChristofidesData)
</code></pre>

<hr>
<h2 id='Devore'>Devore model</h2><span id='topic+Devore'></span>

<h3>Description</h3>

<p>Computes the randomized response estimation, its variance estimation and its confidence interval through the Devore model.
The function can also return the transformed variable.
The Devore model was proposed by Devore in 1977.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Devore(z,p,pi,type=c("total","mean"),cl,N=NULL,pij=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Devore_+3A_z">z</code></td>
<td>
<p>vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="Devore_+3A_p">p</code></td>
<td>
<p>proportion of cards bearing the mark <code class="reqn">A</code></p>
</td></tr>
<tr><td><code id="Devore_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilities</p>
</td></tr>
<tr><td><code id="Devore_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="Devore_+3A_cl">cl</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="Devore_+3A_n">N</code></td>
<td>
<p>size of the population. By default it is NULL</p>
</td></tr>
<tr><td><code id="Devore_+3A_pij">pij</code></td>
<td>
<p>matrix of the second-order inclusion probabilities. By default it is NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the Devore model, the randomized response device presents to the sampled person labelled <code class="reqn">i</code> a box containing a large number of identical cards with a
proportion <code class="reqn">p,(0&lt;p&lt;1)</code> bearing the mark <code class="reqn">A</code> and the rest marked <code class="reqn">B</code> (an innocuous attribute). The response solicited denoted by <code class="reqn">z_i</code> takes the value
<code class="reqn">y_i</code> if <code class="reqn">i</code> bears <code class="reqn">A</code> and the card drawn is marked <code class="reqn">A</code>. Otherwise <code class="reqn">z_i</code> takes the value 1.
</p>
<p>The transformed variable is <code class="reqn">r_i=\frac{z_i-(1-p)}{p}</code> and the estimated variance is <code class="reqn">\widehat{V}_R(r_i)=r_i(r_i-1)</code>.
</p>


<h3>Value</h3>

<p>Point and confidence estimates of the sensitive characteristics using the Devore model. The transformed variable is also reported, if required.
</p>


<h3>References</h3>

<p>Devore, J.L. (1977).
<em>A note on the randomized response technique.</em>
Communications in Statistics Theory and Methods 6: 1525-1529.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DevoreData">DevoreData</a></code>
</p>
<p><code><a href="#topic+ResamplingVariance">ResamplingVariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DevoreData)
dat=with(DevoreData,data.frame(z,Pi))
p=0.7
cl=0.95
Devore(dat$z,p,dat$Pi,"total",cl)
</code></pre>

<hr>
<h2 id='DevoreData'>Randomized Response Survey on instant messaging</h2><span id='topic+DevoreData'></span>

<h3>Description</h3>

<p>This data set contains observations from a randomized response survey conducted in a university to investigate the use of instant messaging.
The sample is drawn by stratified sampling by academic year.
The randomized response technique used is the Devore model (Devore, 1977) with parameter <code class="reqn">p=0.7</code>.
The unrelated question is: Are you alive?
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(DevoreData)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 240 observations divided into four strata. The sample is selected from a population of <code class="reqn">N=802</code> students.
The variables are:
</p>

<ul>
<li><p> ID: Survey ID of student respondent
</p>
</li>
<li><p> ST: Strata ID
</p>
</li>
<li><p> z: The randomized response to the question: Do you use whatsapp / line or similar instant messaging while you study?
</p>
</li>
<li><p> Pi: first-order inclusion probabilities
</p>
</li></ul>


<h3>References</h3>

<p>Devore, J.L. (1977).
<em>A note on the randomized response technique.</em>
Communications in Statistics Theory and Methods 6: 1525-1529.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Devore">Devore</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DevoreData)
</code></pre>

<hr>
<h2 id='DianaPerri1'>Diana-Perri-1 model</h2><span id='topic+DianaPerri1'></span>

<h3>Description</h3>

<p>Computes the randomized response estimation, its variance estimation and its confidence interval through the Diana-Perri-1 model.
The function can also return the transformed variable.
The Diana-Perri-1 model was proposed by Diana and Perri (2010, page 1877).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DianaPerri1(z,p,mu,pi,type=c("total","mean"),cl,N=NULL,method="srswr")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DianaPerri1_+3A_z">z</code></td>
<td>
<p>vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="DianaPerri1_+3A_p">p</code></td>
<td>
<p>probability of direct response</p>
</td></tr>
<tr><td><code id="DianaPerri1_+3A_mu">mu</code></td>
<td>
<p>vector with the means of the scramble variables <code class="reqn">W</code> and <code class="reqn">U</code></p>
</td></tr>
<tr><td><code id="DianaPerri1_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilities</p>
</td></tr>
<tr><td><code id="DianaPerri1_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="DianaPerri1_+3A_cl">cl</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="DianaPerri1_+3A_n">N</code></td>
<td>
<p>size of the population. By default it is NULL</p>
</td></tr>
<tr><td><code id="DianaPerri1_+3A_method">method</code></td>
<td>
<p>method used to draw the sample: srswr or srswor. By default it is srswr</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the Diana-Perri-1 model let <code class="reqn">p\in [0,1]</code> be a design parameter, controlled by the experimenter, which is used to randomize the response as follows: with probability
<code class="reqn">p</code> the interviewer responds with the true value of the sensitive variable, whereas with probability <code class="reqn">1-p</code> the respondent gives a coded value,
<code class="reqn">z_i=W(y_i+U)</code> where <code class="reqn">W,U</code> are scramble variables whose distribution is assumed to be known.
</p>
<p>To estimate <code class="reqn">\bar{Y}</code> a sample of respondents is selected according to simple random sampling with replacement.
The transformed variable is
</p>
<p style="text-align: center;"><code class="reqn">r_i=\frac{z_i-(1-p)\mu_W\mu_U}{p+(1-p)\mu_W}</code>
</p>

<p>where <code class="reqn">\mu_W,\mu_U</code> are the means of <code class="reqn">W,U</code> scramble variables, respectively.
</p>
<p>The estimated variance in this model is
</p>
<p style="text-align: center;"><code class="reqn">\widehat{V}(\widehat{\bar{Y}}_R)=\frac{s_z^2}{n(p+(1-p)\mu_W)^2}</code>
</p>

<p>where <code class="reqn">s_z^2=\sum_{i=1}^n\frac{(z_i-\bar{z})^2}{n-1}</code>.
</p>
<p>If the sample is selected by simple random sampling without replacement, the estimated variance is
</p>
<p style="text-align: center;"><code class="reqn">\widehat{V}(\widehat{\bar{Y}}_R)=\frac{s_z^2}{n(p+(1-p)\mu_W)^2}\left(1-\frac{n}{N}\right)</code>
</p>



<h3>Value</h3>

<p>Point and confidence estimates of the sensitive characteristics using the Diana-Perri-1 model. The transformed variable is also reported, if required.
</p>


<h3>References</h3>

<p>Diana, G., Perri, P.F. (2010).
<em>New scrambled response models for estimating the mean of a sensitive quantitative character.</em>
Journal of Applied Statistics 37 (11), 1875-1890.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DianaPerri1Data">DianaPerri1Data</a></code>
</p>
<p><code><a href="#topic+DianaPerri2">DianaPerri2</a></code>
</p>
<p><code><a href="#topic+ResamplingVariance">ResamplingVariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N=417
data(DianaPerri1Data)
dat=with(DianaPerri1Data,data.frame(z,Pi))
p=0.6
mu=c(5/3,5/3)
cl=0.95
DianaPerri1(dat$z,p,mu,dat$Pi,"mean",cl,N,"srswor")
</code></pre>

<hr>
<h2 id='DianaPerri1Data'>Randomized Response Survey on defrauded taxes</h2><span id='topic+DianaPerri1Data'></span>

<h3>Description</h3>

<p>This data set contains observations from a randomized response survey conducted in a population of 417 individuals in a municipality to investigate defrauded taxes.
The sample is drawn by simple random sampling without replacement.
The randomized response technique used is the Diana and Perri 1 model (Diana and Perri, 2010) with parameters <code class="reqn">p=0.6</code>, <code class="reqn">W=F(10,5)</code> and <code class="reqn">U=F(5,5)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(DianaPerri1Data)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 150 observations from a population of <code class="reqn">N=417</code>.
The variables are:
</p>

<ul>
<li><p> ID: Survey ID
</p>
</li>
<li><p> z: The randomized response to the question: What quantity of your agricultural subsidy do you declare in your income tax return?
</p>
</li>
<li><p> Pi: first-order inclusion probabilities
</p>
</li></ul>


<h3>References</h3>

<p>Diana, G., Perri, P.F. (2010).
<em>New scrambled response models for estimating the mean of a sensitive quantitative character.</em>
Journal of Applied Statistics 37 (11), 1875–1890.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DianaPerri1">DianaPerri1</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DianaPerri1Data)
</code></pre>

<hr>
<h2 id='DianaPerri2'>Diana-Perri-2 model</h2><span id='topic+DianaPerri2'></span>

<h3>Description</h3>

<p>Computes the randomized response estimation, its variance estimation and its confidence interval through the Diana-Perri-2 model.
The function can also return the transformed variable.
The Diana-Perri-2 model was proposed by Diana and Perri (2010, page 1879).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DianaPerri2(z,mu,beta,pi,type=c("total","mean"),cl,N=NULL,method="srswr")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DianaPerri2_+3A_z">z</code></td>
<td>
<p>vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="DianaPerri2_+3A_mu">mu</code></td>
<td>
<p>vector with the means of the scramble variables <code class="reqn">W</code> and <code class="reqn">U</code></p>
</td></tr>
<tr><td><code id="DianaPerri2_+3A_beta">beta</code></td>
<td>
<p>the constant of weighting</p>
</td></tr>
<tr><td><code id="DianaPerri2_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilities</p>
</td></tr>
<tr><td><code id="DianaPerri2_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="DianaPerri2_+3A_cl">cl</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="DianaPerri2_+3A_n">N</code></td>
<td>
<p>size of the population. By default it is NULL</p>
</td></tr>
<tr><td><code id="DianaPerri2_+3A_method">method</code></td>
<td>
<p>method used to draw the sample: srswr or srswor. By default it is srswr</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the Diana-Perri-2 model, each respondent is asked to report the scrambled response <code class="reqn">z_i=W(\beta U+(1-\beta)y_i)</code> where <code class="reqn">\beta \in [0,1)</code> is a suitable constant
controlled by the researcher and <code class="reqn">W,U</code> are scramble variables whose distribution is assumed to be known.
</p>
<p>To estimate <code class="reqn">\bar{Y}</code> a sample of respondents is selected according to simple random sampling with replacement.
The transformed variable is
</p>
<p style="text-align: center;"><code class="reqn">r_i=\frac{z_i-\beta\mu_W\mu_U}{(1-\beta)\mu_W}</code>
</p>

<p>where <code class="reqn">\mu_W,\mu_U</code> are the means of <code class="reqn">W,U</code> scramble variables, respectively.
</p>
<p>The estimated variance in this model is
</p>
<p style="text-align: center;"><code class="reqn">\widehat{V}(\widehat{\bar{Y}}_R)=\frac{s_z^2}{n(1-\beta)^2\mu_W^2}</code>
</p>

<p>where <code class="reqn">s_z^2=\sum_{i=1}^n\frac{(z_i-\bar{z})^2}{n-1}</code>.
</p>
<p>If the sample is selected by simple random sampling without replacement, the estimated variance is
</p>
<p style="text-align: center;"><code class="reqn">\widehat{V}(\widehat{\bar{Y}}_R)=\frac{s_z^2}{n(1-\beta)^2\mu_W^2}\left(1-\frac{n}{N}\right)</code>
</p>



<h3>Value</h3>

<p>Point and confidence estimates of the sensitive characteristics using the Diana-Perri-2 model. The transformed variable is also reported, if required.
</p>


<h3>References</h3>

<p>Diana, G., Perri, P.F. (2010).
<em>New scrambled response models for estimating the mean of a sensitive quantitative character.</em>
Journal of Applied Statistics 37 (11), 1875-1890.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DianaPerri2Data">DianaPerri2Data</a></code>
</p>
<p><code><a href="#topic+DianaPerri1">DianaPerri1</a></code>
</p>
<p><code><a href="#topic+ResamplingVariance">ResamplingVariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N=100000
data(DianaPerri2Data)
dat=with(DianaPerri2Data,data.frame(z,Pi))
beta=0.8
mu=c(50/48,5/3)
cl=0.95
DianaPerri2(dat$z,mu,beta,dat$Pi,"mean",cl,N,"srswor")
</code></pre>

<hr>
<h2 id='DianaPerri2Data'>Randomized Response Survey of a simulated population</h2><span id='topic+DianaPerri2Data'></span>

<h3>Description</h3>

<p>This data set contains observations from a simulated randomized response survey.
The interest variable is a normal distribution with mean 1500 and standard deviation 4.
The sample is drawn by simple random sampling without replacement.
The randomized response technique used is the Diana and Perri 2 model (Diana and Perri, 2010) with parameters <code class="reqn">W=F(10,50), U=F(1,5)</code> and <code class="reqn">\beta=0.8</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(DianaPerri2Data)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 1000 observations from a population of <code class="reqn">N=100000</code>.
The variables are:
</p>

<ul>
<li><p> ID: Survey ID
</p>
</li>
<li><p> z: The randomized response
</p>
</li>
<li><p> Pi: first-order inclusion probabilities
</p>
</li></ul>


<h3>References</h3>

<p>Diana, G., Perri, P.F. (2010).
<em>New scrambled response models for estimating the mean of a sensitive quantitative character.</em>
Journal of Applied Statistics 37 (11), 1875–1890.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DianaPerri2">DianaPerri2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DianaPerri2Data)
</code></pre>

<hr>
<h2 id='EichhornHayre'>Eichhorn-Hayre model</h2><span id='topic+EichhornHayre'></span>

<h3>Description</h3>

<p>Computes the randomized response estimation, its variance estimation and its confidence interval through the Eichhorn-Hayre model.
The function can also return the transformed variable.
The Eichhorn-Hayre model was proposed by Eichhorn and Hayre in 1983.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EichhornHayre(z,mu,sigma,pi,type=c("total","mean"),cl,N=NULL,pij=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EichhornHayre_+3A_z">z</code></td>
<td>
<p>vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="EichhornHayre_+3A_mu">mu</code></td>
<td>
<p>mean of the scramble variable <code class="reqn">S</code></p>
</td></tr>
<tr><td><code id="EichhornHayre_+3A_sigma">sigma</code></td>
<td>
<p>standard deviation of the scramble variable <code class="reqn">S</code></p>
</td></tr>
<tr><td><code id="EichhornHayre_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilities</p>
</td></tr>
<tr><td><code id="EichhornHayre_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="EichhornHayre_+3A_cl">cl</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="EichhornHayre_+3A_n">N</code></td>
<td>
<p>size of the population. By default it is NULL</p>
</td></tr>
<tr><td><code id="EichhornHayre_+3A_pij">pij</code></td>
<td>
<p>matrix of the second-order inclusion probabilities. By default it is NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The randomized response given by the person labelled <code class="reqn">i</code> is <code class="reqn">z_i=y_iS</code> where <code class="reqn">S</code> is a scramble variable whose distribution is assumed to be known.
</p>


<h3>Value</h3>

<p>Point and confidence estimates of the sensitive characteristics using the Eichhorn-Hayre model. The transformed variable is also reported, if required.
</p>


<h3>References</h3>

<p>Eichhorn, B.H., Hayre, L.S. (1983).
<em>Scrambled randomized response methods for obtaining sensitive quantitative data.</em>
Journal of Statistical Planning and Inference, 7, 306-316.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EichhornHayreData">EichhornHayreData</a></code>
</p>
<p><code><a href="#topic+ResamplingVariance">ResamplingVariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(EichhornHayreData)
dat=with(EichhornHayreData,data.frame(z,Pi))
mu=1.111111
sigma=0.5414886
cl=0.95
#This line returns a warning showing why the variance estimation is not possible.
#See ResamplingVariance for several alternatives.
EichhornHayre(dat$z,mu,sigma,dat$Pi,"mean",cl)
</code></pre>

<hr>
<h2 id='EichhornHayreData'>Randomized Response Survey on family income</h2><span id='topic+EichhornHayreData'></span>

<h3>Description</h3>

<p>This data set contains observations from a randomized response survey conducted in a population of families to investigate their income.
The sample is drawn by stratified sampling by house ownership.
The randomized response technique used is the Eichhorn and Hayre model (Eichhorn and Hayre, 1983) with scramble variable <code class="reqn">S=F(20,20)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(EichhornHayreData)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 150 observations of a sample extracted from a population of families divided into two strata.
The variables are:
</p>

<ul>
<li><p> ID: Survey ID
</p>
</li>
<li><p> ST: Strata ID
</p>
</li>
<li><p> z: The randomized response to the question: What is the annual household income?
</p>
</li>
<li><p> Pi: first-order inclusion probabilities
</p>
</li></ul>


<h3>References</h3>

<p>Eichhorn, B.H., Hayre, L.S. (1983).
<em>Scrambled randomized response methods for obtaining sensitive quantitative data.</em>
Journal of Statistical Planning and Inference, 7, 306-316.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EichhornHayre">EichhornHayre</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(EichhornHayreData)
</code></pre>

<hr>
<h2 id='Eriksson'>Eriksson model</h2><span id='topic+Eriksson'></span>

<h3>Description</h3>

<p>Computes the randomized response estimation, its variance estimation and its confidence interval through the Eriksson model.
The function can also return the transformed variable.
The Eriksson model was proposed by Eriksson in 1973.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Eriksson(z,p,mu,sigma,pi,type=c("total","mean"),cl,N=NULL,pij=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Eriksson_+3A_z">z</code></td>
<td>
<p>vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="Eriksson_+3A_p">p</code></td>
<td>
<p>probability of direct response</p>
</td></tr>
<tr><td><code id="Eriksson_+3A_mu">mu</code></td>
<td>
<p>mean of the scramble variable <code class="reqn">S</code></p>
</td></tr>
<tr><td><code id="Eriksson_+3A_sigma">sigma</code></td>
<td>
<p>standard deviation of the scramble variable <code class="reqn">S</code></p>
</td></tr>
<tr><td><code id="Eriksson_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilities</p>
</td></tr>
<tr><td><code id="Eriksson_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="Eriksson_+3A_cl">cl</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="Eriksson_+3A_n">N</code></td>
<td>
<p>size of the population. By default it is NULL</p>
</td></tr>
<tr><td><code id="Eriksson_+3A_pij">pij</code></td>
<td>
<p>matrix of the second-order inclusion probabilities. By default it is NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The randomized response given by the person labelled <code class="reqn">i</code> is <code class="reqn">y_i</code> with probability <code class="reqn">p</code> and a discrete uniform variable <code class="reqn">S</code> with probabilities <code class="reqn">q_1,q_2,...,q_j</code>
verifying <code class="reqn">q_1+q_2+...+q_j=1-p</code>.
</p>


<h3>Value</h3>

<p>Point and confidence estimates of the sensitive characteristics using the Eriksson model. The transformed variable is also reported, if required.
</p>


<h3>References</h3>

<p>Eriksson, S.A. (1973).
<em>A new model for randomized response.</em>
International Statistical Review 41, 40-43.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ErikssonData">ErikssonData</a></code>
</p>
<p><code><a href="#topic+ResamplingVariance">ResamplingVariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N=53376
data(ErikssonData)
dat=with(ErikssonData,data.frame(z,Pi))
p=0.5
mu=mean(c(0,1,3,5,8))
sigma=sqrt(4/5*var(c(0,1,3,5,8)))
cl=0.95
Eriksson(dat$z,p,mu,sigma,dat$Pi,"mean",cl,N)
</code></pre>

<hr>
<h2 id='ErikssonData'>Randomized Response Survey on student cheating</h2><span id='topic+ErikssonData'></span>

<h3>Description</h3>

<p>This data set contains observations from a randomized response survey conducted in a university to investigate cheating behaviour in exams.
The sample is drawn by stratified sampling by university faculty with uniform allocation.
The randomized response technique used is the Eriksson model (Eriksson, 1973) with parameter <code class="reqn">p=0.5</code> and <code class="reqn">S</code> a discrete uniform variable at the points (0,1,3,5,8).
</p>
<p>The data were used by Arcos et al. (2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ErikssonData)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 102 students of a sample extracted from a population of <code class="reqn">N=53376</code> divided into four strata.
The variables are:
</p>

<ul>
<li><p> ID: Survey ID of student respondent
</p>
</li>
<li><p> ST: Strata ID
</p>
</li>
<li><p> z: The randomized response to the question: How many times have you cheated in an exam in the past year?
</p>
</li>
<li><p> Pi: first-order inclusion probabilities
</p>
</li></ul>


<h3>References</h3>

<p>Arcos, A., Rueda, M. and Singh, S. (2015).
<em>A generalized approach to randomised response for quantitative variables.</em>
Quality and Quantity 49, 1239-1256.
</p>
<p>Eriksson, S.A. (1973).
<em>A new model for randomized response.</em>
International Statistical Review 41, 40-43.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Eriksson">Eriksson</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ErikssonData)
</code></pre>

<hr>
<h2 id='ForcedResponse'>Forced-Response model</h2><span id='topic+ForcedResponse'></span>

<h3>Description</h3>

<p>Computes the randomized response estimation, its variance estimation and its confidence interval through the Forced-Response model.
The function can also return the transformed variable.
The Forced-Response model was proposed by Boruch in 1972.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ForcedResponse(z,p1,p2,pi,type=c("total","mean"),cl,N=NULL,pij=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ForcedResponse_+3A_z">z</code></td>
<td>
<p>vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="ForcedResponse_+3A_p1">p1</code></td>
<td>
<p>proportion of cards marked &quot;Yes&quot;</p>
</td></tr>
<tr><td><code id="ForcedResponse_+3A_p2">p2</code></td>
<td>
<p>proportion of cards marked &quot;No&quot;</p>
</td></tr>
<tr><td><code id="ForcedResponse_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilities</p>
</td></tr>
<tr><td><code id="ForcedResponse_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="ForcedResponse_+3A_cl">cl</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="ForcedResponse_+3A_n">N</code></td>
<td>
<p>size of the population. By default it is NULL</p>
</td></tr>
<tr><td><code id="ForcedResponse_+3A_pij">pij</code></td>
<td>
<p>matrix of the second-order inclusion probabilities. By default it is NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the Forced-Response scheme, the sampled person <code class="reqn">i</code> is offered a box with cards: some are marked &quot;Yes&quot; with a proportion <code class="reqn">p_1</code>, some are marked &quot;No&quot; with a
proportion <code class="reqn">p_2</code> and the rest are marked &quot;Genuine&quot;, in the remaining proportion <code class="reqn">p_3=1-p_1-p_2</code>, where <code class="reqn">0&lt;p_1,p_2&lt;1,p_1\neq p_2,p_1+p_2&lt;1</code>. The person is
requested to randomly draw one of them, to observe the mark on the card, and to respond
</p>
<p style="text-align: center;"><code class="reqn">z_i=\left \{\begin{array}{lccc}
1 &amp; \textrm{if the card is type "Yes"}\\
0 &amp; \textrm{if the card is type "No"}\\
y_i &amp; \textrm{if the card is type "Genuine"}
\end{array}
\right .</code>
</p>

<p>The transformed variable is <code class="reqn">r_i=\frac{z_i-p_1}{1-p_1-p_2}</code> and the estimated variance is <code class="reqn">\widehat{V}_R(r_i)=r_i(r_i-1)</code>.
</p>


<h3>Value</h3>

<p>Point and confidence estimates of the sensitive characteristics using the Forced-Response model. The transformed variable is also reported, if required.
</p>


<h3>References</h3>

<p>Boruch, R.F. (1972).
<em>Relations among statistical methods for assuring confidentiality of social research data.</em>
Social Science Research, 1, 403-414.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ForcedResponseData">ForcedResponseData</a></code>
</p>
<p><code><a href="#topic+ForcedResponseDataSt">ForcedResponseDataSt</a></code>
</p>
<p><code><a href="#topic+ResamplingVariance">ResamplingVariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ForcedResponseData)
dat=with(ForcedResponseData,data.frame(z,Pi))
p1=0.2
p2=0.2
cl=0.95
ForcedResponse(dat$z,p1,p2,dat$Pi,"total",cl)

#Forced Response with strata
data(ForcedResponseDataSt)
dat=with(ForcedResponseDataSt,data.frame(ST,z,Pi))
p1=0.2
p2=0.2
cl=0.95
ForcedResponse(dat$z,p1,p2,dat$Pi,"total",cl)
</code></pre>

<hr>
<h2 id='ForcedResponseData'>Randomized Response Survey of a simulated population</h2><span id='topic+ForcedResponseData'></span>

<h3>Description</h3>

<p>This data set contains observations from a randomized response survey obtained from a simulated population.
The main variable is a binomial distribution with a probability 0.5.
The sample is drawn by simple random sampling without replacement.
The randomized response technique used is the Forced Response model (Boruch, 1972) with parameters <code class="reqn">p_1=0.2</code> and <code class="reqn">p_2=0.2</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ForcedResponseData)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 1000 observations from a population of <code class="reqn">N=10000</code>. The variables are:
</p>

<ul>
<li><p> ID: Survey ID
</p>
</li>
<li><p> z: The randomized response
</p>
</li>
<li><p> Pi: first-order inclusion probabilities
</p>
</li></ul>


<h3>References</h3>

<p>Boruch, R.F. (1972).
<em>Relations among statistical methods for assuring confidentiality of social research data.</em>
Social Science Research, 1, 403-414.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ForcedResponse">ForcedResponse</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ForcedResponseData)
</code></pre>

<hr>
<h2 id='ForcedResponseDataSt'>Randomized Response Survey on infertility</h2><span id='topic+ForcedResponseDataSt'></span>

<h3>Description</h3>

<p>This data set contains observations from a randomized response survey to determine the prevalence of infertility among women of childbearing age in a population-base study.
The sample is drawn by stratified sampling.
The randomized response technique used is the Forced Response model (Boruch, 1972) with parameters <code class="reqn">p_1=0.2</code> and <code class="reqn">p_2=0.2</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ForcedResponseDataSt)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 442 observations. The variables are:
</p>

<ul>
<li><p> ID: Survey ID
</p>
</li>
<li><p> ST: Strata ID
</p>
</li>
<li><p> z: The randomized response to the question: Did you ever have some medical treatment for the infertility?
</p>
</li>
<li><p> Pi: first-order inclusion probabilities
</p>
</li></ul>


<h3>References</h3>

<p>Boruch, R.F. (1972).
<em>Relations among statistical methods for assuring confidentiality of social research data.</em>
Social Science Research, 1, 403-414.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ForcedResponse">ForcedResponse</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ForcedResponseDataSt)
</code></pre>

<hr>
<h2 id='Horvitz'>Horvitz model</h2><span id='topic+Horvitz'></span>

<h3>Description</h3>

<p>Computes the randomized response estimation, its variance estimation and its confidence interval through the Horvitz model.
The function can also return the transformed variable.
The Horvitz model was proposed by Horvitz et al. (1967) and by Greenberg et al. (1969).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Horvitz(z,p,alpha,pi,type=c("total","mean"),cl,N=NULL,pij=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Horvitz_+3A_z">z</code></td>
<td>
<p>vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="Horvitz_+3A_p">p</code></td>
<td>
<p>proportion of marked cards with the sensitive question</p>
</td></tr>
<tr><td><code id="Horvitz_+3A_alpha">alpha</code></td>
<td>
<p>proportion of people with the innocuous attribute</p>
</td></tr>
<tr><td><code id="Horvitz_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilities</p>
</td></tr>
<tr><td><code id="Horvitz_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="Horvitz_+3A_cl">cl</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="Horvitz_+3A_n">N</code></td>
<td>
<p>size of the population. By default it is NULL</p>
</td></tr>
<tr><td><code id="Horvitz_+3A_pij">pij</code></td>
<td>
<p>matrix of the second-order inclusion probabilities. By default it is NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the Horvitz model, the randomized response device presents to the sampled person labelled <code class="reqn">i</code> a box containing a large number of identical cards, with a
proportion <code class="reqn">p,(0 &lt;p &lt; 1)</code> bearing the mark <code class="reqn">A</code> and the rest marked <code class="reqn">B</code> (an innocuous attribute whose population proportion <code class="reqn">\alpha</code> is known).
The response solicited denoted by <code class="reqn">z_i</code> takes the value <code class="reqn">y_i</code> if <code class="reqn">i</code> bears <code class="reqn">A</code> and the card drawn is marked <code class="reqn">A</code> or if <code class="reqn">i</code> bears
<code class="reqn">B</code> and the card drawn is marked <code class="reqn">B</code>. Otherwise <code class="reqn">z_i</code> takes the value 0.
</p>
<p>The transformed variable is <code class="reqn">r_i=\frac{z_i-(1-p)\alpha}{p}</code> and the estimated variance is <code class="reqn">\widehat{V}_R(r_i)=r_i(r_i-1)</code>.
</p>


<h3>Value</h3>

<p>Point and confidence estimates of the sensitive characteristics using the Horvitz model. The transformed variable is also reported, if required.
</p>


<h3>References</h3>

<p>Greenberg, B.G., Abul-Ela, A.L., Simmons, W.R., Horvitz, D.G. (1969).
<em>The unrelated question RR model: Theoretical framework.</em>
Journal of the American Statistical Association, 64, 520-539.
</p>
<p>Horvitz, D.G., Shah, B.V., Simmons, W.R. (1967).
<em>The unrelated question RR model.</em>
Proceedings of the Social Statistics Section of the American Statistical Association. 65-72. Alexandria, VA: ASA.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HorvitzData">HorvitzData</a></code>
</p>
<p><code><a href="#topic+HorvitzDataStCl">HorvitzDataStCl</a></code>
</p>
<p><code><a href="#topic+HorvitzDataRealSurvey">HorvitzDataRealSurvey</a></code>
</p>
<p><code><a href="#topic+HorvitzUB">HorvitzUB</a></code>
</p>
<p><code><a href="#topic+SoberanisCruz">SoberanisCruz</a></code>
</p>
<p><code><a href="#topic+ResamplingVariance">ResamplingVariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N=10777
data(HorvitzData)
dat=with(HorvitzData,data.frame(z,Pi))
p=0.5
alpha=0.6666667
cl=0.95
Horvitz(dat$z,p,alpha,dat$Pi,"mean",cl,N)

#Horvitz real survey
N=10777
n=710
data(HorvitzDataRealSurvey)
p=0.5
alpha=1/12
pi=rep(n/N,n)
cl=0.95
Horvitz(HorvitzDataRealSurvey$sex,p,alpha,pi,"mean",cl,N)
</code></pre>

<hr>
<h2 id='HorvitzData'>Randomized Response Survey on student bullying</h2><span id='topic+HorvitzData'></span>

<h3>Description</h3>

<p>This data set contains observations from a randomized response survey conducted in a university to investigate bullying.
The sample is drawn by simple random sampling without replacement.
The randomized response technique used is the Horvitz model (Horvitz et al., 1967 and Greenberg et al., 1969) with parameter <code class="reqn">p=0.5</code>.
The unrelated question is: Were you born between the 1st and 20th of the month? with <code class="reqn">\alpha=0.6666667</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(HorvitzData)
</code></pre>


<h3>Format</h3>

<p>A data frame containing a sample of 411 observations from a population of <code class="reqn">N=10777</code> students.
The variables are:
</p>

<ul>
<li><p> ID: Survey ID of student respondent
</p>
</li>
<li><p> z: The randomized response to the question: Have you been bullied?
</p>
</li>
<li><p> Pi: first-order inclusion probabilities
</p>
</li></ul>


<h3>References</h3>

<p>Greenberg, B.G., Abul-Ela, A.L., Simmons, W.R., Horvitz, D.G. (1969).
<em>The unrelated question RR model: Theoretical framework.</em>
Journal of the American Statistical Association, 64, 520-539.
</p>
<p>Horvitz, D.G., Shah, B.V., Simmons, W.R. (1967).
<em>The unrelated question RR model.</em>
Proceedings of the Social Statistics Section of the American Statistical Association. 65-72. Alexandria, VA: ASA.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Horvitz">Horvitz</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HorvitzData)
</code></pre>

<hr>
<h2 id='HorvitzDataRealSurvey'>Randomized Response Survey on a sensitive questions</h2><span id='topic+HorvitzDataRealSurvey'></span>

<h3>Description</h3>

<p>This data set contains observations from a randomized response survey conducted in a university to sensitive questions described below.
The sample is drawn by simple random sampling without replacement.
The randomized response technique used is the Horvitz model (Horvitz et al., 1967 and Greenberg et al., 1969) with parameter <code class="reqn">p=0.5</code>.
Each sensitive question is associated with a unrelated question.
</p>
<p>1. Were you born in July? with <code class="reqn">\alpha=1/12</code>
</p>
<p>2. Does your ID number end in 2? with <code class="reqn">\alpha=1/10</code>
</p>
<p>3. Were you born of 1 to 20 of the month? with <code class="reqn">\alpha=20/30</code>
</p>
<p>4. Does your ID number end in 5? with <code class="reqn">\alpha=1/10</code>
</p>
<p>5. Were you born of 15 to 25 of the month? with <code class="reqn">\alpha=10/30</code>
</p>
<p>6. Were you born in April? with <code class="reqn">\alpha=1/12</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(HorvitzData)
</code></pre>


<h3>Format</h3>

<p>A data frame containing a sample of 710 observations from a population of <code class="reqn">N=10777</code> students.
The variables are:
</p>

<ul>
<li><p> copied: The randomized response to the question: Have you ever copied in an exam?
</p>
</li>
<li><p> fought: The randomized response to the question: Have you ever fought with a teacher?
</p>
</li>
<li><p> bullied: The randomized response to the question: Have you been bullied?
</p>
</li>
<li><p> bullying: The randomized response to the question: Have you ever bullied someone?
</p>
</li>
<li><p> drug: The randomized response to the question: Have you ever taken drugs on the campus?
</p>
</li>
<li><p> sex: The randomized response to the question: Have you had sex on the premises of the university?
</p>
</li></ul>


<h3>References</h3>

<p>Greenberg, B.G., Abul-Ela, A.L., Simmons, W.R., Horvitz, D.G. (1969).
<em>The unrelated question RR model: Theoretical framework.</em>
Journal of the American Statistical Association, 64, 520-539.
</p>
<p>Horvitz, D.G., Shah, B.V., Simmons, W.R. (1967).
<em>The unrelated question RR model.</em>
Proceedings of the Social Statistics Section of the American Statistical Association. 65-72. Alexandria, VA: ASA.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Horvitz">Horvitz</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HorvitzDataRealSurvey)
</code></pre>

<hr>
<h2 id='HorvitzDataStCl'>Randomized Response Survey on infidelity</h2><span id='topic+HorvitzDataStCl'></span>

<h3>Description</h3>

<p>This data set contains observations from a randomized response survey conducted in a university to investigate the infidelity.
The sample is drawn by stratified (by faculty) cluster (by group) sampling.
The randomized response technique used is the Horvitz model (Horvitz et al., 1967 and Greenberg et al., 1969) with parameter <code class="reqn">p=0.6</code>.
The unrelated question is: Does your identity card end in an odd number? with a probability <code class="reqn">\alpha=0.5</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(HorvitzDataStCl)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 365 observations from a population of <code class="reqn">N=1500</code> students divided into two strata. The first strata has 14 cluster and the second has 11 cluster.
The variables are:
</p>

<ul>
<li><p> ID: Survey ID of student respondent
</p>
</li>
<li><p> ST: Strata ID
</p>
</li>
<li><p> CL: Cluster ID
</p>
</li>
<li><p> z: The randomized response to the question: Have you ever been unfaithful?
</p>
</li>
<li><p> Pi: first-order inclusion probabilities
</p>
</li></ul>


<h3>References</h3>

<p>Greenberg, B.G., Abul-Ela, A.L., Simmons, W.R., Horvitz, D.G. (1969).
<em>The unrelated question RR model: Theoretical framework.</em>
Journal of the American Statistical Association, 64, 520-539.
</p>
<p>Horvitz, D.G., Shah, B.V., Simmons, W.R. (1967).
<em>The unrelated question RR model.</em>
Proceedings of the Social Statistics Section of the American Statistical Association. 65-72. Alexandria, VA: ASA.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Horvitz">Horvitz</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HorvitzDataStCl)
</code></pre>

<hr>
<h2 id='HorvitzUB'>Horvitz-UB model</h2><span id='topic+HorvitzUB'></span>

<h3>Description</h3>

<p>Computes the randomized response estimation, its variance estimation and its confidence interval through the Horvitz model (Horvitz et al., 1967, and Greenberg et al., 1969)
when the proportion of people bearing the innocuous attribute is unknown.
The function can also return the transformed variable.
The Horvitz-UB model can be seen in Chaudhuri (2011, page 42).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HorvitzUB(I,J,p1,p2,pi,type=c("total","mean"),cl,N=NULL,pij=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HorvitzUB_+3A_i">I</code></td>
<td>
<p>first vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="HorvitzUB_+3A_j">J</code></td>
<td>
<p>second vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="HorvitzUB_+3A_p1">p1</code></td>
<td>
<p>proportion of marked cards with the sensitive attribute in the first box</p>
</td></tr>
<tr><td><code id="HorvitzUB_+3A_p2">p2</code></td>
<td>
<p>proportion of marked cards with the sensitive attribute in the second box</p>
</td></tr>
<tr><td><code id="HorvitzUB_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilities</p>
</td></tr>
<tr><td><code id="HorvitzUB_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="HorvitzUB_+3A_cl">cl</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="HorvitzUB_+3A_n">N</code></td>
<td>
<p>size of the population. By default it is NULL</p>
</td></tr>
<tr><td><code id="HorvitzUB_+3A_pij">pij</code></td>
<td>
<p>matrix of the second-order inclusion probabilities. By default it is NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the Horvitz model, when the population proportion <code class="reqn">\alpha</code> is not known, two independent samples are taken. Two boxes are filled with a large number of similar
cards except that in the first box a proportion <code class="reqn">p_1(0&lt;p_1&lt;1)</code> of them is marked <code class="reqn">A</code> and the complementary proportion <code class="reqn">(1-p_1)</code> each bearing the mark <code class="reqn">B</code>,
while in the second box these proportions are <code class="reqn">p_2</code> and <code class="reqn">1-p_2</code>, maintaining <code class="reqn">p_2</code> different from <code class="reqn">p_1</code>. A sample is chosen and every person sampled is requested
to draw one card randomly from the first box and to repeat this independently with the second box. In the first case, a randomized response should be given, as
</p>
<p style="text-align: center;"><code class="reqn">I_i=\left\{\begin{array}{lcc}
1 &amp; \textrm{if card type draws "matches" the sensitive trait } A \textrm{ or the innocuous trait } B \\
0 &amp; \textrm{if there is "no match" with the first box }
\end{array}
\right.</code>
</p>

<p>and the second case given a randomized response as
</p>
<p style="text-align: center;"><code class="reqn">J_i=\left\{\begin{array}{lcc}
1 &amp; \textrm{if there is "match" for the second box} \\
0 &amp; \textrm{if there is "no match" for the second box}
\end{array}
\right.</code>
</p>

<p>The transformed variable is <code class="reqn">r_i=\frac{(1-p_2)I_i-(1-p_1)J_i}{p_1-p_2}</code> and the estimated variance is <code class="reqn">\widehat{V}_R(r_i)=r_i(r_i-1)</code>.
</p>


<h3>Value</h3>

<p>Point and confidence estimates of the sensitive characteristics using the Horvitz-UB model. The transformed variable is also reported, if required.
</p>


<h3>References</h3>

<p>Chaudhuri, A. (2011).
<em>Randomized response and indirect questioning techniques in surveys.</em>
Boca Raton: Chapman and Hall, CRC Press.
</p>
<p>Greenberg, B.G., Abul-Ela, A.L., Simmons, W.R., Horvitz, D.G. (1969).
<em>The unrelated question RR model: Theoretical framework.</em>
Journal of the American Statistical Association, 64, 520-539.
</p>
<p>Horvitz, D.G., Shah, B.V., Simmons, W.R. (1967).
<em>The unrelated question RR model.</em>
Proceedings of the Social Statistics Section of the American Statistical Association. 65-72. Alexandria, VA: ASA.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HorvitzUBData">HorvitzUBData</a></code>
</p>
<p><code><a href="#topic+Horvitz">Horvitz</a></code>
</p>
<p><code><a href="#topic+ResamplingVariance">ResamplingVariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N=802
data(HorvitzUBData)
dat=with(HorvitzUBData,data.frame(I,J,Pi))
p1=0.6
p2=0.7
cl=0.95
HorvitzUB(dat$I,dat$J,p1,p2,dat$Pi,"mean",cl,N)
</code></pre>

<hr>
<h2 id='HorvitzUBData'>Randomized Response Survey on drugs use</h2><span id='topic+HorvitzUBData'></span>

<h3>Description</h3>

<p>This data set contains observations from a randomized response survey conducted in a university to investigate drugs use.
The sample is drawn by cluster sampling with the probabilities proportional to the size.
The randomized response technique used is the Horvitz-UB model (Chaudhuri, 2011) with parameters <code class="reqn">p_1=0.6</code> and <code class="reqn">p_2=0.7</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(HorvitzUBData)
</code></pre>


<h3>Format</h3>

<p>A data frame containing a sample of 188 observations from a population of <code class="reqn">N=802</code> students divided into four cluster.
The variables are:
</p>

<ul>
<li><p> ID: Survey ID of student respondent
</p>
</li>
<li><p> CL: Cluster ID
</p>
</li>
<li><p> I: The first randomized response to the question: Have you ever used drugs?
</p>
</li>
<li><p> J: The second randomized response to the question: Have you ever used drugs?
</p>
</li>
<li><p> Pi: first-order inclusion probabilities
</p>
</li></ul>


<h3>References</h3>

<p>Chaudhuri, A. (2011).
<em>Randomized response and indirect questioning techniques in surveys.</em>
Boca Raton: Chapman and Hall, CRC Press.
</p>
<p>Greenberg, B.G., Abul-Ela, A.L., Simmons, W.R., Horvitz, D.G. (1969).
<em>The unrelated question RR model: Theoretical framework.</em>
Journal of the American Statistical Association, 64, 520-539.
</p>
<p>Horvitz, D.G., Shah, B.V., Simmons, W.R. (1967).
<em>The unrelated question RR model.</em>
Proceedings of the Social Statistics Section of the American Statistical Association. 65-72. Alexandria, VA: ASA.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HorvitzUB">HorvitzUB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HorvitzUBData)
</code></pre>

<hr>
<h2 id='Kuk'>Kuk model</h2><span id='topic+Kuk'></span>

<h3>Description</h3>

<p>Computes the randomized response estimation, its variance estimation and its confidence through the Kuk model.
The function can also return the transformed variable.
The Kuk model was proposed by Kuk in 1990.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Kuk(z,p1,p2,k,pi,type=c("total","mean"),cl,N=NULL,pij=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Kuk_+3A_z">z</code></td>
<td>
<p>vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="Kuk_+3A_p1">p1</code></td>
<td>
<p>proportion of red cards in the first box</p>
</td></tr>
<tr><td><code id="Kuk_+3A_p2">p2</code></td>
<td>
<p>proportion of red cards in the second box</p>
</td></tr>
<tr><td><code id="Kuk_+3A_k">k</code></td>
<td>
<p>total number of cards drawn</p>
</td></tr>
<tr><td><code id="Kuk_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilities</p>
</td></tr>
<tr><td><code id="Kuk_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="Kuk_+3A_cl">cl</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="Kuk_+3A_n">N</code></td>
<td>
<p>size of the population. By default it is NULL</p>
</td></tr>
<tr><td><code id="Kuk_+3A_pij">pij</code></td>
<td>
<p>matrix of the second-order inclusion probabilities. By default it is NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the Kuk randomized response technique, the sampled person <code class="reqn">i</code> is offered two boxes. Each box contains cards that are identical exception colour, either red
or white, in sufficiently large numbers with proportions <code class="reqn">p_1</code> and <code class="reqn">1-p_1</code> in the first and <code class="reqn">p_2</code> and <code class="reqn">1-p_2</code>, in the second (<code class="reqn">p_1\neq p_2</code>).
The person sampled is requested to use the first box, if his/her trait is <code class="reqn">A</code> and the second box if his/her trait is <code class="reqn">A^c</code> and to make <code class="reqn">k</code> independent
draws of cards, with replacement each time. The person is asked to reports <code class="reqn">z_i=f_i</code>, the number of times a red card is drawn.
</p>
<p>The transformed variable is <code class="reqn">r_i=\frac{f_i/k-p_2}{p_1-p_2}</code> and the estimated variance is <code class="reqn">\widehat{V}_R(r_i)=br_i+c</code>,
where <code class="reqn">b=\frac{1-p_1-p_2}{k(p_1-p_2)}</code> and <code class="reqn">c=\frac{p_2(1-p_2)}{k(p_1-p_2)^2}</code>.
</p>


<h3>Value</h3>

<p>Point and confidence estimates of the sensitive characteristics using the Kuk model. The transformed variable is also reported, if required.
</p>


<h3>References</h3>

<p>Kuk, A.Y.C. (1990).
<em>Asking sensitive questions indirectly.</em>
Biometrika, 77, 436-438.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+KukData">KukData</a></code>
</p>
<p><code><a href="#topic+ResamplingVariance">ResamplingVariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N=802
data(KukData)
dat=with(KukData,data.frame(z,Pi))
p1=0.6
p2=0.2
k=25
cl=0.95
Kuk(dat$z,p1,p2,k,dat$Pi,"mean",cl,N)
</code></pre>

<hr>
<h2 id='KukData'>Randomized Response Survey on excessive sexual activity</h2><span id='topic+KukData'></span>

<h3>Description</h3>

<p>This data set contains the data from a randomized response survey conducted in a university to investigate excessive sexual activity.
The sample is drawn by simple random sampling without replacement.
The randomized response technique used is the Kuk model (Kuk, 1990) with parameters <code class="reqn">p_1=0.6</code>, <code class="reqn">p_2=0.2</code> and <code class="reqn">k=25</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(KukData)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 200 observations from a population of <code class="reqn">N=802</code> students. The variables are:
</p>

<ul>
<li><p> ID: Survey ID of student respondent
</p>
</li>
<li><p> z: The randomized response to the question: Do you practice excessive sexual activity?
</p>
</li>
<li><p> Pi: first-order inclusion probabilities
</p>
</li></ul>


<h3>References</h3>

<p>Kuk, A.Y.C. (1990).
<em>Asking sensitive questions indirectly.</em>
Biometrika, 77, 436-438.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Kuk">Kuk</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(KukData)
</code></pre>

<hr>
<h2 id='Mangat'>Mangat model</h2><span id='topic+Mangat'></span>

<h3>Description</h3>

<p>Computes the randomized response estimation, its variance estimation and its confidence interval through the Mangat model.
The function can also return the transformed variable.
The Mangat model was proposed by Mangat in 1992.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Mangat(z,p,alpha,t,pi,type=c("total","mean"),cl,N=NULL,pij=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Mangat_+3A_z">z</code></td>
<td>
<p>vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="Mangat_+3A_p">p</code></td>
<td>
<p>proportion of marked cards with the sensitive attribute in the second box</p>
</td></tr>
<tr><td><code id="Mangat_+3A_alpha">alpha</code></td>
<td>
<p>proportion of people with the innocuous attribute</p>
</td></tr>
<tr><td><code id="Mangat_+3A_t">t</code></td>
<td>
<p>proportion of marked cards with &quot;True&quot; in the first box</p>
</td></tr>
<tr><td><code id="Mangat_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilities</p>
</td></tr>
<tr><td><code id="Mangat_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="Mangat_+3A_cl">cl</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="Mangat_+3A_n">N</code></td>
<td>
<p>size of the population. By default it is NULL</p>
</td></tr>
<tr><td><code id="Mangat_+3A_pij">pij</code></td>
<td>
<p>matrix of the second-order inclusion probabilities. By default it is NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In Mangat's method, there are two boxes, the first containing cards marked &quot;True&quot; and &quot;RR&quot; in proportions <code class="reqn">t</code> and <code class="reqn">(1-t),(0&lt;t&lt;1)</code>. A person drawing a
&quot;True&quot; marked card is asked to tell the truth about bearing <code class="reqn">A</code> or <code class="reqn">A^c</code>. A person drawing and “RR” marked card is then asked to apply Horvitz’s device
by drawing a card from a second box with cards marked <code class="reqn">A</code> and <code class="reqn">B</code> in proportions <code class="reqn">p</code> and <code class="reqn">(1-p)</code>. If an <code class="reqn">A</code> marked card is now drawn the
truthful response will be about bearing the sensitive attribute <code class="reqn">A</code> and otherwise about <code class="reqn">B</code>. The true proportion of people bearing <code class="reqn">A</code> is to be
estimated but <code class="reqn">\alpha</code>, the proportion of people bearing the innocuous trait <code class="reqn">B</code> unrelated to <code class="reqn">A</code>, is assumed to be known. The observed variable is
</p>
<p style="text-align: center;"><code class="reqn">z_i=\left \{\begin{array}{lcc}
y_i &amp; \textrm{if a card marked "True" is drawn from the first box}\\
I_i &amp; \textrm{if a card marked "RR" is drawn}
\end{array}
\right .</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">I_i=\left \{\begin{array}{lcc}
1 &amp; \textrm{if the type of card drawn from the second box matches trait } A \textrm{ or } B\\
0 &amp; \textrm{if the type of card drawn from the second box does not match trait } A \textrm{ or } B.
\end{array}
\right .</code>
</p>

<p>The transformed variable is <code class="reqn">r_i=\frac{z_i-(1-t)(1-p)\alpha}{t+(1-t)p}</code> and the estimated variance is <code class="reqn">\widehat{V}_R(r_i)=r_i(r_i-1)</code>.
</p>


<h3>Value</h3>

<p>Point and confidence estimates of the sensitive characteristics using the Mangat model. The transformed variable is also reported, if required.
</p>


<h3>References</h3>

<p>Mangat, N.S. (1992).
<em>Two stage randomized response sampling procedure using unrelated question.</em>
Journal of the Indian Society of Agricultural Statistics, 44, 82-87.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MangatUB">MangatUB</a></code>
</p>
<p><code><a href="#topic+ResamplingVariance">ResamplingVariance</a></code>
</p>

<hr>
<h2 id='MangatSingh'>Mangat-Singh model</h2><span id='topic+MangatSingh'></span>

<h3>Description</h3>

<p>Computes the randomized response estimation, its variance estimation and its confidence interval through the Mangat-Singh model.
The function can also return the transformed variable.
The Mangat-Singh model was proposed by Mangat and Singh in 1990.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MangatSingh(z,p,t,pi,type=c("total","mean"),cl,N=NULL,pij=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MangatSingh_+3A_z">z</code></td>
<td>
<p>vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="MangatSingh_+3A_p">p</code></td>
<td>
<p>proportion of marked cards with the sensitive attribute in the second box</p>
</td></tr>
<tr><td><code id="MangatSingh_+3A_t">t</code></td>
<td>
<p>proportion of marked cards with &quot;True&quot; in the first box</p>
</td></tr>
<tr><td><code id="MangatSingh_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilities</p>
</td></tr>
<tr><td><code id="MangatSingh_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="MangatSingh_+3A_cl">cl</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="MangatSingh_+3A_n">N</code></td>
<td>
<p>size of the population. By default it is NULL</p>
</td></tr>
<tr><td><code id="MangatSingh_+3A_pij">pij</code></td>
<td>
<p>matrix of the second-order inclusion probabilities. By default it is NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the Mangat-Singh model, the sampled person is offered two boxes of cards. In the first box a known proportion <code class="reqn">t,(0&lt;t&lt;1)</code> of cards is marked &quot;True&quot; and the
remaining ones are marked &quot;RR&quot;. One card is to be drawn, observed and returned to the box. If the card drawn is marked &quot;True&quot;, then the respondent should respond &quot;Yes&quot;
if he/she belongs to the sensitive category, otherwise &quot;No&quot;. If the card drawn is marked &quot;RR&quot;, then the respondent must use the second box and draw a card from it.
This second box contains a proportion <code class="reqn">p,(0&lt;p&lt;1,p\neq 0.5)</code> of cards marked <code class="reqn">A</code> and the remaining ones are marked <code class="reqn">A^c</code>. If the card drawn from the second
box matches his/her status as related to the stigmatizing characteristic, he/she must respond &quot;Yes&quot;, otherwise &quot;No&quot;.
The randomized response from a person labelled <code class="reqn">i</code> is assumed to be:
</p>
<p style="text-align: center;"><code class="reqn">z_i=\left \{\begin{array}{lcc}
y_i &amp; \textrm{if a card marked "True" is drawn from the first box}\\
I_i &amp; \textrm{if a card marked "RR" is drawn}
\end{array}
\right .</code>
</p>

<p style="text-align: center;"><code class="reqn">I_i=\left \{\begin{array}{lcc}
1 &amp; \textrm{if the "card type" } A \textrm{ or } A^c  \textrm{ "matches" the genuine trait } A \textrm{ or } A^c\\
0 &amp; \textrm{if a "mismatch" is observed}
\end{array}
\right .</code>
</p>

<p>The transformed variable is <code class="reqn">r_i=\frac{z_i-(1-t)(1-p)}{t+(1-t)(2p-1)}</code> and the estimated variance is <code class="reqn">\widehat{V}_R(r_i)=r_i(r_i-1)</code>.
</p>


<h3>Value</h3>

<p>Point and confidence estimates of the sensitive characteristics using the Mangat-Singh model. The transformed variable is also reported, if required.
</p>


<h3>References</h3>

<p>Mangat, N.S., Singh, R. (1990).
<em>An alternative randomized response procedure.</em>
Biometrika, 77, 439-442.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MangatSinghData">MangatSinghData</a></code>
</p>
<p><code><a href="#topic+ResamplingVariance">ResamplingVariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N=802
data(MangatSinghData)
dat=with(MangatSinghData,data.frame(z,Pi))
p=0.7
t=0.55
cl=0.95
MangatSingh(dat$z,p,t,dat$Pi,"mean",cl,N)
</code></pre>

<hr>
<h2 id='MangatSinghData'>Randomized Response Survey on cannabis use</h2><span id='topic+MangatSinghData'></span>

<h3>Description</h3>

<p>This data set contains observations from a randomized response survey conducted in a university to investigate cannabis use.
The sample is drawn by stratified sampling by academic year.
The randomized response technique used is the Mangat-Singh model (Mangat and Singh, 1990) with parameters <code class="reqn">p=0.7</code> and <code class="reqn">t=0.55</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MangatSinghData)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 240 observations from a population of <code class="reqn">N=802</code> students divided into four strata.
The variables are:
</p>

<ul>
<li><p> ID: Survey ID of student respondent
</p>
</li>
<li><p> ST: Strata ID
</p>
</li>
<li><p> z: The randomized response to the question: Have you ever used cannabis?
</p>
</li>
<li><p> Pi: first-order inclusion probabilities
</p>
</li></ul>


<h3>References</h3>

<p>Mangat, N.S., Singh, R. (1990).
<em>An alternative randomized response procedure.</em>
Biometrika, 77, 439-442.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MangatSingh">MangatSingh</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MangatSinghData)
</code></pre>

<hr>
<h2 id='MangatSinghSingh'>Mangat-Singh-Singh model</h2><span id='topic+MangatSinghSingh'></span>

<h3>Description</h3>

<p>Computes the randomized response estimation, its variance estimation and its confidence interval through the Mangat-Singh-Singh model.
The function can also return the transformed variable.
The Mangat-Singh-Singh model was proposed by Mangat, Singh and Singh in 1992.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MangatSinghSingh(z,p,alpha,pi,type=c("total","mean"),cl,N=NULL,pij=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MangatSinghSingh_+3A_z">z</code></td>
<td>
<p>vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="MangatSinghSingh_+3A_p">p</code></td>
<td>
<p>proportion of marked cards with the sensitive attribute in the box</p>
</td></tr>
<tr><td><code id="MangatSinghSingh_+3A_alpha">alpha</code></td>
<td>
<p>proportion of people with the innocuous attribute</p>
</td></tr>
<tr><td><code id="MangatSinghSingh_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilities</p>
</td></tr>
<tr><td><code id="MangatSinghSingh_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="MangatSinghSingh_+3A_cl">cl</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="MangatSinghSingh_+3A_n">N</code></td>
<td>
<p>size of the population. By default it is NULL</p>
</td></tr>
<tr><td><code id="MangatSinghSingh_+3A_pij">pij</code></td>
<td>
<p>matrix of the second-order inclusion probabilities. By default it is NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the Mangat-Singh-Singh scheme, a person labelled <code class="reqn">i</code>, if sampled, is offered a box and told to answer &quot;yes&quot; if the person bears <code class="reqn">A</code>. But if the person bears
<code class="reqn">A^c</code> then the person is to draw a card from the box with a proportion <code class="reqn">p(0&lt;p&lt; 1)</code> of cards marked <code class="reqn">A</code> and the rest marked <code class="reqn">B</code>; if the person draws
a card marked <code class="reqn">B</code> he/she is told to say &quot;yes&quot; again if he/she actually bears <code class="reqn">B</code>; in any other case, &quot;no&quot; is to be answered.
</p>
<p>The transformed variable is <code class="reqn">r_i=\frac{z_i-(1-p)\alpha}{1-(1-p)\alpha}</code> and the estimated variance is <code class="reqn">\widehat{V}_R(r_i)=r_i(r_i-1)</code>.
</p>


<h3>Value</h3>

<p>Point and confidence estimates of the sensitive characteristics using the Mangat-Singh-Singh model. The transformed variable is also reported, if required.
</p>


<h3>References</h3>

<p>Mangat, N.S., Singh, R., Singh, S. (1992).
<em>An improved unrelated question randomized response strategy.</em>
Calcutta Statistical Association Bulletin, 42, 277-281.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MangatSinghSinghData">MangatSinghSinghData</a></code>
</p>
<p><code><a href="#topic+MangatSinghSinghUB">MangatSinghSinghUB</a></code>
</p>
<p><code><a href="#topic+ResamplingVariance">ResamplingVariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MangatSinghSinghData)
dat=with(MangatSinghSinghData,data.frame(z,Pi))
p=0.6
alpha=0.5
cl=0.95
MangatSinghSingh(dat$z,p,alpha,dat$Pi,"total",cl)
</code></pre>

<hr>
<h2 id='MangatSinghSinghData'>Randomized Response Survey on internet betting</h2><span id='topic+MangatSinghSinghData'></span>

<h3>Description</h3>

<p>This data set contains observations from a randomized response survey conducted in a university to investigate internet betting.
The sample is drawn by stratified (by faculty) cluster (by group) sampling.
The randomized response technique used is the Mangat-Singh-Singh model (Mangat, Singh and Singh, 1992) with parameter <code class="reqn">p=0.6</code>.
The unrelated question is: Does your identity card end in an even number? with a probability <code class="reqn">\alpha=0.5</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MangatSinghSinghData)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 802 observations from a population of students divided into eight strata. Each strata has a certain number of clusters, totalling 23.
The variables are:
</p>

<ul>
<li><p> ID: Survey ID of student respondent
</p>
</li>
<li><p> ST: Strata ID
</p>
</li>
<li><p> CL: Cluster ID
</p>
</li>
<li><p> z: The randomized response to the question: In the last year, did you bet on internet?
</p>
</li>
<li><p> Pi: first-order inclusion probabilities
</p>
</li></ul>


<h3>References</h3>

<p>Mangat, N.S., Singh, R., Singh, S. (1992).
<em>An improved unrelated question randomized response strategy.</em>
Calcutta Statistical Association Bulletin, 42, 277-281.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MangatSinghSingh">MangatSinghSingh</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MangatSinghSinghData)
</code></pre>

<hr>
<h2 id='MangatSinghSinghUB'>Mangat-Singh-Singh-UB model</h2><span id='topic+MangatSinghSinghUB'></span>

<h3>Description</h3>

<p>Computes the randomized response estimation, its variance estimation and its confidence interval through the Mangat-Singh-Singh model (Mangat el al., 1992)
when the proportion of people bearing the innocuous attribute is unknown.
The function can also return the transformed variable.
The Mangat-Singh-Singh-UB model can be seen in Chauduri (2011, page 54).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MangatSinghSinghUB(I,J,p1,p2,pi,type=c("total","mean"),cl,N=NULL,pij=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MangatSinghSinghUB_+3A_i">I</code></td>
<td>
<p>first vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="MangatSinghSinghUB_+3A_j">J</code></td>
<td>
<p>second vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="MangatSinghSinghUB_+3A_p1">p1</code></td>
<td>
<p>proportion of marked cards with the sensitive attribute in the first box</p>
</td></tr>
<tr><td><code id="MangatSinghSinghUB_+3A_p2">p2</code></td>
<td>
<p>proportion of marked cards with the sensitive attribute in the second box</p>
</td></tr>
<tr><td><code id="MangatSinghSinghUB_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilities</p>
</td></tr>
<tr><td><code id="MangatSinghSinghUB_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="MangatSinghSinghUB_+3A_cl">cl</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="MangatSinghSinghUB_+3A_n">N</code></td>
<td>
<p>size of the population. By default it is NULL</p>
</td></tr>
<tr><td><code id="MangatSinghSinghUB_+3A_pij">pij</code></td>
<td>
<p>matrix of the second-order inclusion probabilities. By default it is NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A person labelled <code class="reqn">i</code> who is chosen, is instructed to say &quot;yes&quot; if he/she bears <code class="reqn">A</code>, and if not, to randomly take a card from a box containing
cards marked <code class="reqn">A,B</code> in proportions <code class="reqn">p_1</code> and <code class="reqn">(1-p_1),(0&lt;p_1&lt;1)</code>; they are then told to report the value <code class="reqn">x_i</code> if a <code class="reqn">B</code>-type card is chosen and he/she bears <code class="reqn">B</code>;
otherwise he/she is told to report &quot;No&quot;. This entire exercise is to be repeated independently with the second box with <code class="reqn">A</code> and <code class="reqn">B</code>-marked cards in proportions <code class="reqn">p_2</code>
and <code class="reqn">(1-p_2),(0&lt;p_2&lt;1,p_2\neq p_1)</code>. Let <code class="reqn">I_i</code> the first response and <code class="reqn">J_i</code> the second response for the respondent <code class="reqn">i</code>.
</p>
<p>The transformed variable is <code class="reqn">r_i=\frac{(1-p_2)I_i-(1-p_1)J_i}{p_1-p_2}</code> and the estimated variance is <code class="reqn">\widehat{V}_R(r_i)=r_i(r_i-1)</code>.
</p>


<h3>Value</h3>

<p>Point and confidence estimates of the sensitive characteristics using the Mangat-Singh-Singh-UB model. The transformed variable is also reported, if required.
</p>


<h3>References</h3>

<p>Chaudhuri, A. (2011).
<em>Randomized response and indirect questioning techniques in surveys.</em>
Boca Raton: Chapman and Hall, CRC Press.
</p>
<p>Mangat, N.S., Singh, R., Singh, S. (1992).
<em>An improved unrelated question randomized response strategy.</em>
Calcutta Statistical Association Bulletin, 42, 277-281.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MangatSinghSinghUBData">MangatSinghSinghUBData</a></code>
</p>
<p><code><a href="#topic+MangatSinghSingh">MangatSinghSingh</a></code>
</p>
<p><code><a href="#topic+ResamplingVariance">ResamplingVariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N=802
data(MangatSinghSinghUBData)
dat=with(MangatSinghSinghUBData,data.frame(I,J,Pi))
p1=0.6
p2=0.8
cl=0.95
MangatSinghSinghUB(dat$I,dat$J,p1,p2,dat$Pi,"mean",cl,N)
</code></pre>

<hr>
<h2 id='MangatSinghSinghUBData'>Randomized Response Survey on overuse of the internet</h2><span id='topic+MangatSinghSinghUBData'></span>

<h3>Description</h3>

<p>This data set contains observations from a randomized response survey conducted in a university to investigate overuse of the internet.
The sample is drawn by simple random sampling without replacement.
The randomized response technique used is the Mangat-Singh-Singh-UB model (Chaudhuri, 2011) with parameters <code class="reqn">p_1=0.6</code> and <code class="reqn">p_2=0.8</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MangatSinghSinghUBData)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 500 observations.
The variables are:
</p>

<ul>
<li><p> ID: Survey ID of student respondent
</p>
</li>
<li><p> z: The randomized response to the question: Do you spend a lot of time surfing the internet?
</p>
</li>
<li><p> Pi: first-order inclusion probabilities
</p>
</li></ul>


<h3>References</h3>

<p>Chaudhuri, A. (2011).
<em>Randomized response and indirect questioning techniques in surveys.</em>
Boca Raton: Chapman and Hall, CRC Press.
</p>
<p>Mangat, N.S., Singh, R., Singh, S. (1992).
<em>An improved unrelated question randomized response strategy.</em>
Calcutta Statistical Association Bulletin, 42, 277-281.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MangatSinghSinghUB">MangatSinghSinghUB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MangatSinghSinghUBData)
</code></pre>

<hr>
<h2 id='MangatUB'>Mangat-UB model</h2><span id='topic+MangatUB'></span>

<h3>Description</h3>

<p>Computes the randomized response estimation, its variance estimation and its confidence interval through the Mangat model (Mangat, 1992)
when the proportion of people bearing the innocuous attribute is unknown.
The function can also return the transformed variable.
The Mangat-UB model can be seen in Chaudhuri (2011, page 53).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MangatUB(I,J,p1,p2,t,pi,type=c("total","mean"),cl,N=NULL,pij=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MangatUB_+3A_i">I</code></td>
<td>
<p>first vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="MangatUB_+3A_j">J</code></td>
<td>
<p>second vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="MangatUB_+3A_p1">p1</code></td>
<td>
<p>proportion of marked cards with the sensitive attribute in the second box</p>
</td></tr>
<tr><td><code id="MangatUB_+3A_p2">p2</code></td>
<td>
<p>proportion of marked cards with the sensitive attribute in the third box</p>
</td></tr>
<tr><td><code id="MangatUB_+3A_t">t</code></td>
<td>
<p>probability of response to the sensitive questions without using random response in the first box</p>
</td></tr>
<tr><td><code id="MangatUB_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilities</p>
</td></tr>
<tr><td><code id="MangatUB_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="MangatUB_+3A_cl">cl</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="MangatUB_+3A_n">N</code></td>
<td>
<p>size of the population. By default it is NULL</p>
</td></tr>
<tr><td><code id="MangatUB_+3A_pij">pij</code></td>
<td>
<p>matrix of the second-order inclusion probabilities. By default it is NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In Mangat's extended scheme, three boxes containing cards are presented to the sampled person, labelled <code class="reqn">i</code>. The first box contains cards marked &quot;True&quot; and &quot;RR&quot;
in proportions <code class="reqn">t</code> and <code class="reqn">1-t</code>, the second one contains <code class="reqn">A</code> and <code class="reqn">B</code>-marked cards in proportions <code class="reqn">p_1</code> and <code class="reqn">(1-p_1),(0&lt;p_1&lt;1)</code> and the third box
contains <code class="reqn">A</code> and <code class="reqn">B</code>-marked cards in proportions <code class="reqn">p_2</code> and <code class="reqn">1-p_2,(0&lt;p_2&lt;1),p_1\neq p_2</code>. The subject is requested to draw a card from the first box.
The sample respondent <code class="reqn">i</code> is then instructed to tell the truth, using &quot;the first box and if necessary also the second box&quot; and next, independently, to give a second
truthful response also using &quot;the first box and if necessary, the third box.&quot; Let <code class="reqn">I_i</code> represent the first response and <code class="reqn">J_i</code> the second response for
respondent <code class="reqn">i</code>.
</p>
<p>The transformed variable is <code class="reqn">r_i=\frac{(1-p_2)I_i-(1-p_1)J_i}{p_1-p_2}</code> and the estimated variance is <code class="reqn">\widehat{V}_R(r_i)=r_i(r_i-1)</code>.
</p>


<h3>Value</h3>

<p>Point and confidence estimates of the sensitive characteristics using the Mangat-UB model. The transformed variable is also reported, if required.
</p>


<h3>References</h3>

<p>Chaudhuri, A. (2011).
<em>Randomized response and indirect questioning techniques in surveys.</em>
Boca Raton: Chapman and Hall, CRC Press.
</p>
<p>Mangat, N.S. (1992).
<em>Two stage randomized response sampling procedure using unrelated question.</em>
Journal of the Indian Society of Agricultural Statistics, 44, 82-87.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Mangat">Mangat</a></code>
</p>
<p><code><a href="#topic+ResamplingVariance">ResamplingVariance</a></code>
</p>

<hr>
<h2 id='ResamplingVariance'>Resampling variance of randomized response models</h2><span id='topic+ResamplingVariance'></span>

<h3>Description</h3>

<p>To estimate the variance of the randomized response estimators using resampling methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ResamplingVariance(output,pi,type=c("total","mean"),option=1,N=NULL,pij=NULL,str=NULL,
clu=NULL,srswr=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ResamplingVariance_+3A_output">output</code></td>
<td>
<p>output of the qualitative or quantitative method depending on the variable of interest</p>
</td></tr>
<tr><td><code id="ResamplingVariance_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilities. By default it is NULL</p>
</td></tr>
<tr><td><code id="ResamplingVariance_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="ResamplingVariance_+3A_option">option</code></td>
<td>
<p>method used to calculate the variance (1: Jackknife, 2: Escobar-Berger, 3: Campbell-Berger-Skinner). By default it is 1</p>
</td></tr>
<tr><td><code id="ResamplingVariance_+3A_n">N</code></td>
<td>
<p>size of the population</p>
</td></tr>
<tr><td><code id="ResamplingVariance_+3A_pij">pij</code></td>
<td>
<p>matrix of the second-order inclusion probabilities. This matrix is necessary for the Escobar-Berger and Campbell-Berger-Skinner options. By default it is NULL</p>
</td></tr>
<tr><td><code id="ResamplingVariance_+3A_str">str</code></td>
<td>
<p>strata ID. This vector is necessary for the Jackknife option. By default it is NULL</p>
</td></tr>
<tr><td><code id="ResamplingVariance_+3A_clu">clu</code></td>
<td>
<p>cluster ID. This vector is necessary for the Jackknife option. By default it is NULL</p>
</td></tr>
<tr><td><code id="ResamplingVariance_+3A_srswr">srswr</code></td>
<td>
<p>variable indicating whether sampling is with replacement. By default it is NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Functions to estimate the variance under stratified, cluster and unequal probability sampling by resampling methods (Wolter, 2007).
The function ResamplingVariance allows us to choose from three models:
</p>
<p>- The Jackknife method (Quenouille, 1949)
</p>
<p>- The Escobar-Berger method (Escobar and Berger, 2013)
</p>
<p>- The Campbell-Berger-Skinner method (Campbell, 1980; Berger and Skinner, 2005).
</p>
<p>The Escobar-Berger and Campbell-Berger-Skinner methods are implemented using the functions defined in samplingVarEst package:
</p>
<p>VE.EB.SYG.Total.Hajek, VE.EB.SYG.Mean.Hajek;
</p>
<p>VE.Jk.CBS.SYG.Total.Hajek, VE.Jk.CBS.SYG.Mean.Hajek
</p>
<p>(see López, E., Barrios, E., 2014, for a detailed description of its use).
</p>
<p>Note: Both methods require the matrix of the second-order inclusion probabilities. When this matrix is not an input, the program will give a warning and, by default, a jackknife
method is used.
</p>


<h3>Value</h3>

<p>The resampling variance of the randomized response technique
</p>


<h3>References</h3>

<p>Berger, Y.G., Skinner, C.J. (2005).
<em>A jackknife variance estimator for unequal probability sampling.</em>
Journal of the Royal Statistical Society B, 67, 79-89.
</p>
<p>Campbell, C. (1980).
<em>A different view of finite population estimation.</em>
Proceedings of the Survey Research Methods Section of the American Statistical Association, 319-324.
</p>
<p>Escobar, E.L., Berger, Y.G. (2013).
<em>A new replicate variance estimator for unequal probability sampling without replacement.</em>
Canadian Journal of Statistics 41, 3, 508-524.
</p>
<p>López, E., Barrios, E. (2014).
<em>samplingVarEst: Sampling Variance Estimation.</em>
R package version 0.9-9. Online http://cran.r-project.org/web/packages/survey/index.html
</p>
<p>Quenouille, M.H. (1949).
<em>Problems in Plane Sampling.</em>
The Annals of Mathematical Statistics 20, 355-375.
</p>
<p>Wolter, K.M. (2007).
<em>Introduction to Variance Estimation.</em>
2nd Edition. Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Warner">Warner</a></code>
</p>
<p><code><a href="#topic+ChaudhuriChristofides">ChaudhuriChristofides</a></code>
</p>
<p><code><a href="#topic+EichhornHayre">EichhornHayre</a></code>
</p>
<p><code><a href="#topic+SoberanisCruz">SoberanisCruz</a></code>
</p>
<p><code><a href="#topic+Horvitz">Horvitz</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N=417
data(ChaudhuriChristofidesData)
dat=with(ChaudhuriChristofidesData,data.frame(z,Pi))
mu=c(6,6)
sigma=sqrt(c(10,10))
cl=0.95
data(ChaudhuriChristofidesDatapij)
out=ChaudhuriChristofides(dat$z,mu,sigma,dat$Pi,"mean",cl,pij=ChaudhuriChristofidesDatapij)
out
ResamplingVariance(out,dat$Pi,"mean",2,N,ChaudhuriChristofidesDatapij)

#Resampling with strata
data(EichhornHayreData)
dat=with(EichhornHayreData,data.frame(ST,z,Pi))
mu=1.111111
sigma=0.5414886
cl=0.95
out=EichhornHayre(dat$z,mu,sigma,dat$Pi,"mean",cl)
out
ResamplingVariance(out,dat$Pi,"mean",1,str=dat$ST)

#Resampling with cluster
N=1500
data(SoberanisCruzData)
dat=with(SoberanisCruzData, data.frame(CL,z,Pi))
p=0.7
alpha=0.5
cl=0.90
out=SoberanisCruz(dat$z,p,alpha,dat$Pi,"total",cl)
out
ResamplingVariance(out,dat$Pi,"total",2,N,samplingVarEst::Pkl.Hajek.s(dat$Pi))

#Resampling with strata and cluster
N=1500
data(HorvitzDataStCl)
dat=with(HorvitzDataStCl, data.frame(ST,CL,z,Pi))
p=0.6
alpha=0.5
cl=0.95
out=Horvitz(dat$z,p,alpha,dat$Pi,"mean",cl,N)
out
ResamplingVariance(out,dat$Pi,"mean",3,N,samplingVarEst::Pkl.Hajek.s(dat$Pi))
</code></pre>

<hr>
<h2 id='RRTCS-internal'>Internal RRTCS Functions</h2><span id='topic+RRTCS-S3method'></span>

<h3>Description</h3>

<p>Internal RRTCS functions
</p>


<h3>Details</h3>

<p>These are not to be called by the user.
</p>

<hr>
<h2 id='Saha'>Saha model</h2><span id='topic+Saha'></span>

<h3>Description</h3>

<p>Computes the randomized response estimation, its variance estimation and its confidence interval through the Saha model.
The function can also return the transformed variable.
The Saha model was proposed by Saha in 2007.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Saha(z,mu,sigma,pi,type=c("total","mean"),cl,N=NULL,method="srswr")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Saha_+3A_z">z</code></td>
<td>
<p>vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="Saha_+3A_mu">mu</code></td>
<td>
<p>vector with the means of the scramble variables <code class="reqn">W</code> and <code class="reqn">U</code></p>
</td></tr>
<tr><td><code id="Saha_+3A_sigma">sigma</code></td>
<td>
<p>vector with the standard deviations of the scramble variables <code class="reqn">W</code> and <code class="reqn">U</code></p>
</td></tr>
<tr><td><code id="Saha_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilities</p>
</td></tr>
<tr><td><code id="Saha_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="Saha_+3A_cl">cl</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="Saha_+3A_n">N</code></td>
<td>
<p>size of the population. By default it is NULL</p>
</td></tr>
<tr><td><code id="Saha_+3A_method">method</code></td>
<td>
<p>method used to draw the sample: srswr or srswor. By default it is srswr</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the Saha model, each respondent selected is asked to report the randomized response <code class="reqn">z_i=W(y_i+U)</code> where <code class="reqn">W,U</code> are scramble variables whose distribution
is assumed to be known.
</p>
<p>To estimate <code class="reqn">\bar{Y}</code> a sample of respondents is selected according to simple random sampling with replacement.
The transformed variable is
</p>
<p style="text-align: center;"><code class="reqn">r_i=\frac{z_i-\mu_W\mu_U}{\mu_W}</code>
</p>

<p>where <code class="reqn">\mu_W,\mu_U</code> are the means of <code class="reqn">W,U</code> scramble variables respectively
</p>
<p>The estimated variance in this model is
</p>
<p style="text-align: center;"><code class="reqn">\widehat{V}(\widehat{\bar{Y}}_R)=\frac{s_z^2}{n\mu_W^2}</code>
</p>

<p>where <code class="reqn">s_z^2=\sum_{i=1}^n\frac{(z_i-\bar{z})^2}{n-1}</code>.
</p>
<p>If the sample is selected by simple random sampling without replacement, the estimated variance is
</p>
<p style="text-align: center;"><code class="reqn">\widehat{V}(\widehat{\bar{Y}}_R)=\frac{s_z^2}{n\mu_W^2}\left(1-\frac{n}{N}\right)</code>
</p>



<h3>Value</h3>

<p>Point and confidence estimates of the sensitive characteristics using the Saha model. The transformed variable is also reported, if required.
</p>


<h3>References</h3>

<p>Saha, A. (2007).
<em>A simple randomized response technique in complex surveys.</em>
Metron LXV, 59-66.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SahaData">SahaData</a></code>
</p>
<p><code><a href="#topic+ResamplingVariance">ResamplingVariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N=228
data(SahaData)
dat=with(SahaData,data.frame(z,Pi))
mu=c(1.5,5.5)
sigma=sqrt(c(1/12,81/12))
cl=0.95
Saha(dat$z,mu,sigma,dat$Pi,"mean",cl,N)
</code></pre>

<hr>
<h2 id='SahaData'>Randomized Response Survey on spending on alcohol</h2><span id='topic+SahaData'></span>

<h3>Description</h3>

<p>This data set contains observations from a randomized response survey conducted in a population of students to investigate spending on alcohol.
The sample is drawn by simple random sampling with replacement.
The randomized response technique used is the Saha model (Saha, 2007) with scramble variables <code class="reqn">W=U(1,2)</code> and <code class="reqn">U=U(1,10)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SahaData)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 100 observations.
The variables are:
</p>

<ul>
<li><p> ID: Survey ID
</p>
</li>
<li><p> z: The randomized response to the queston: How much money did you spend on alcohol, last weekend?
</p>
</li>
<li><p> Pi: first-order inclusion probabilities
</p>
</li></ul>


<h3>References</h3>

<p>Saha, A. (2007).
<em>A simple randomized response technique in complex surveys.</em>
Metron LXV, 59-66.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Saha">Saha</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SahaData)
</code></pre>

<hr>
<h2 id='SinghJoarder'>Singh-Joarder model</h2><span id='topic+SinghJoarder'></span>

<h3>Description</h3>

<p>Computes the randomized response estimation, its variance estimation and its confidence interval through the Singh-Joarder model.
The function can also return the transformed variable.
The Singh-Joarder model was proposed by Singh and Joarder in 1997.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SinghJoarder(z,p,pi,type=c("total","mean"),cl,N=NULL,pij=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SinghJoarder_+3A_z">z</code></td>
<td>
<p>vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="SinghJoarder_+3A_p">p</code></td>
<td>
<p>proportion of marked cards with the sensitive question</p>
</td></tr>
<tr><td><code id="SinghJoarder_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilities</p>
</td></tr>
<tr><td><code id="SinghJoarder_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="SinghJoarder_+3A_cl">cl</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="SinghJoarder_+3A_n">N</code></td>
<td>
<p>size of the population. By default it is NULL</p>
</td></tr>
<tr><td><code id="SinghJoarder_+3A_pij">pij</code></td>
<td>
<p>matrix of the second-order inclusion probabilities. By default it is NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The basics of the Singh-Joarder scheme are similar to Warner's randomized response device, with the following difference. If a person labelled <code class="reqn">i</code> bears
<code class="reqn">A^c</code> he/she is told to say so if so guided by a card drawn from a box of <code class="reqn">A</code> and <code class="reqn">A^c</code> marked cards in proportions <code class="reqn">p</code> and <code class="reqn">(1-p),(0&lt;p&lt;1)</code>.
However, if he/she bears <code class="reqn">A</code> and is directed by the card to admit it, he/she is told to postpone the reporting based on the first draw of the card from
the box but to report on the basis of a second draw. Therefore,
</p>
<p style="text-align: center;"><code class="reqn">z_i=\left \{\begin{array}{lcc}
1 &amp; \textrm{if person } i \textrm{ responds "Yes"}\\
0 &amp; \textrm{if person } i \textrm{ responds "No"}
\end{array}
\right .</code>
</p>

<p>The transformed variable is <code class="reqn">r_i=\frac{z_i-(1-p)}{(2p-1)+p(1-p)}</code> and the estimated variance is <code class="reqn">\widehat{V}_R(r_i)=r_i(r_i-1)</code>.
</p>


<h3>Value</h3>

<p>Point and confidence estimates of the sensitive characteristics using the Singh-Joarder model. The transformed variable is also reported, if required.
</p>


<h3>References</h3>

<p>Singh, S., Joarder, A.H. (1997).
<em>Unknown repeated trials in randomized response sampling.</em>
Journal of the Indian Statistical Association, 30, 109-122.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SinghJoarderData">SinghJoarderData</a></code>
</p>
<p><code><a href="#topic+ResamplingVariance">ResamplingVariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N=802
data(SinghJoarderData)
dat=with(SinghJoarderData,data.frame(z,Pi))
p=0.6
cl=0.95
SinghJoarder(dat$z,p,dat$Pi,"mean",cl,N)
</code></pre>

<hr>
<h2 id='SinghJoarderData'>Randomized Response Survey on compulsive spending</h2><span id='topic+SinghJoarderData'></span>

<h3>Description</h3>

<p>This data set contains observations from a randomized response survey conducted in a university to investigate compulsive spending.
The sample is drawn by simple random sampling without replacement.
The randomized response technique used is the Singh-Joarder model (Singh and Joarder, 1997) with parameter <code class="reqn">p=0.6</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SinghJoarderData)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 170 observations from a population of <code class="reqn">N=802</code> students. The variables are:
</p>

<ul>
<li><p> ID: Survey ID of student respondent
</p>
</li>
<li><p> z: The randomized response to the question: Do you have spend compulsively?
</p>
</li>
<li><p> Pi: first-order inclusion probabilities
</p>
</li></ul>


<h3>References</h3>

<p>Singh, S., Joarder, A.H. (1997).
<em>Unknown repeated trials in randomized response sampling.</em>
Journal of the Indian Statistical Association, 30, 109-122.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SinghJoarder">SinghJoarder</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SinghJoarderData)
</code></pre>

<hr>
<h2 id='SoberanisCruz'>SoberanisCruz model</h2><span id='topic+SoberanisCruz'></span>

<h3>Description</h3>

<p>Computes the randomized response estimation, its variance estimation and its confidence interval through the SoberanisCruz model.
The function can also return the transformed variable.
The SoberanisCruz model was proposed by Soberanis Cruz et al. in 2008.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SoberanisCruz(z,p,alpha,pi,type=c("total","mean"),cl,N=NULL,pij=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SoberanisCruz_+3A_z">z</code></td>
<td>
<p>vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="SoberanisCruz_+3A_p">p</code></td>
<td>
<p>proportion of marked cards with the sensitive question</p>
</td></tr>
<tr><td><code id="SoberanisCruz_+3A_alpha">alpha</code></td>
<td>
<p>proportion of people with the innocuous attribute</p>
</td></tr>
<tr><td><code id="SoberanisCruz_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilites</p>
</td></tr>
<tr><td><code id="SoberanisCruz_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="SoberanisCruz_+3A_cl">cl</code></td>
<td>
<p>confidence leve</p>
</td></tr>
<tr><td><code id="SoberanisCruz_+3A_n">N</code></td>
<td>
<p>size of the population. By default it is NULL</p>
</td></tr>
<tr><td><code id="SoberanisCruz_+3A_pij">pij</code></td>
<td>
<p>matrix of the second-order inclusion probabilities. By default it is NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The SoberanisCruz model considers the introduction of an innocuous variable correlated with the sensitive variable.
This variable does not affect individual sensitivity, and maintains reliability.
The sampling procedure is the same as in the Horvitz model.
</p>


<h3>Value</h3>

<p>Point and confidence estimates of the sensitive characteristics using the SoberanisCruz model. The transformed variable is also reported, if required.
</p>


<h3>References</h3>

<p>Soberanis Cruz, V., Ramírez Valverde, G., Pérez Elizalde, S., González Cossio, F. (2008).
<em>Muestreo de respuestas aleatorizadas en poblaciones finitas: Un enfoque unificador.</em>
Agrociencia Vol. 42 Núm. 5 537-549.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SoberanisCruzData">SoberanisCruzData</a></code>
</p>
<p><code><a href="#topic+Horvitz">Horvitz</a></code>
</p>
<p><code><a href="#topic+ResamplingVariance">ResamplingVariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SoberanisCruzData)
dat=with(SoberanisCruzData,data.frame(z,Pi))
p=0.7
alpha=0.5
cl=0.90
SoberanisCruz(dat$z,p,alpha,dat$Pi,"total",cl)
</code></pre>

<hr>
<h2 id='SoberanisCruzData'>Randomized Response Survey on speeding</h2><span id='topic+SoberanisCruzData'></span>

<h3>Description</h3>

<p>This data set contains observations from a randomized response survey conducted in a population of 1500 families in a Spanish town
to investigate speeding.
The sample is drawn by cluster sampling by district.
The randomized response technique used is the SoberanisCruz model (Soberanis Cruz et al., 2008) with parameter <code class="reqn">p=0.7</code>.
The innocuous question is: Is your car medium/high quality? with <code class="reqn">\alpha=0.5</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SoberanisCruzData)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 290 observations from a population of <code class="reqn">N=1500</code> families divided into twenty cluster.
The variables are:
</p>

<ul>
<li><p> ID: Survey ID
</p>
</li>
<li><p> CL: Cluster ID
</p>
</li>
<li><p> z: The randomized response to the question: Do you often break the speed limit?
</p>
</li>
<li><p> Pi: first-order inclusion probabilities
</p>
</li></ul>


<h3>References</h3>

<p>Soberanis Cruz, V., Ramírez Valverde, G., Pérez Elizalde, S., González Cossio, F. (2008).
<em>Muestreo de respuestas aleatorizadas en poblaciones finitas: Un enfoque unificador.</em>
Agrociencia Vol. 42 Núm. 5 537-549.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SoberanisCruz">SoberanisCruz</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SoberanisCruzData)
</code></pre>

<hr>
<h2 id='Warner'>Warner model</h2><span id='topic+Warner'></span>

<h3>Description</h3>

<p>Computes the randomized response estimation, its variance estimation and its confidence interval through the Warner model.
The function can also return the transformed variable.
The Warner model was proposed by Warner in 1965.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Warner(z,p,pi,type=c("total","mean"),cl,N=NULL,pij=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Warner_+3A_z">z</code></td>
<td>
<p>vector of the observed variable; its length is equal to <code class="reqn">n</code> (the sample size)</p>
</td></tr>
<tr><td><code id="Warner_+3A_p">p</code></td>
<td>
<p>proportion of marked cards with the sensitive attribute</p>
</td></tr>
<tr><td><code id="Warner_+3A_pi">pi</code></td>
<td>
<p>vector of the first-order inclusion probabilities</p>
</td></tr>
<tr><td><code id="Warner_+3A_type">type</code></td>
<td>
<p>the estimator type: total or mean</p>
</td></tr>
<tr><td><code id="Warner_+3A_cl">cl</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="Warner_+3A_n">N</code></td>
<td>
<p>size of the population. By default it is NULL</p>
</td></tr>
<tr><td><code id="Warner_+3A_pij">pij</code></td>
<td>
<p>matrix of the second-order inclusion probabilities. By default it is NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Warner's randomized response device works as follows. A sampled person labelled <code class="reqn">i</code> is offered a box of a considerable number of identical cards with a proportion
<code class="reqn">p,(0&lt;p&lt;1,p\neq 0.5)</code> of them marked <code class="reqn">A</code> and the rest marked <code class="reqn">A^c</code>. The person is requested, randomly, to draw one of them, to observe the mark on the card,
and to give the response
</p>
<p style="text-align: center;"><code class="reqn">z_i=\left\{\begin{array}{lcc}
 1 &amp; \textrm{if card type "matches" the trait } A \textrm{ or } A^c \\
 0 &amp; \textrm{if a "no match" results }
 \end{array}
 \right.</code>
</p>

<p>The randomized response is given by <code class="reqn">r_i=\frac{z_i-(1-p)}{2p-1}</code> and the estimated variance is <code class="reqn">\widehat{V}_R(r_i)=r_i(r_i-1)</code>.
</p>


<h3>Value</h3>

<p>Point and confidence estimates of the sensitive characteristics using the Warner model. The transformed variable is also reported, if required.
</p>


<h3>References</h3>

<p>Warner, S.L. (1965).
<em>Randomized Response: a survey technique for eliminating evasive answer bias.</em>
Journal of the American Statistical Association 60, 63-69.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WarnerData">WarnerData</a></code>
</p>
<p><code><a href="#topic+ResamplingVariance">ResamplingVariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N=802
data(WarnerData)
dat=with(WarnerData,data.frame(z,Pi))
p=0.7
cl=0.95
Warner(dat$z,p,dat$Pi,"total",cl)
</code></pre>

<hr>
<h2 id='WarnerData'>Randomized Response Survey on alcohol abuse</h2><span id='topic+WarnerData'></span>

<h3>Description</h3>

<p>This data set contains observations from a randomized response survey related to alcohol abuse.
The sample is drawn by simple random sampling without replacement.
The randomized response technique used is the Warner model (Warner, 1965) with parameter <code class="reqn">p=0.7</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(WarnerData)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 125 observations from a population of <code class="reqn">N=802</code> students. The variables are:
</p>

<ul>
<li><p> ID: Survey ID of student respondent
</p>
</li>
<li><p> z: The randomized response to the question: During the last month, did you ever have more than five drinks (beer/wine) in succession?
</p>
</li>
<li><p> Pi: first-order inclusion probabilities
</p>
</li></ul>


<h3>References</h3>

<p>Warner, S.L. (1965).
<em>Randomized Response: a survey technique for eliminating evasive answer bias.</em>
Journal of the American Statistical Association 60, 63-69.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Warner">Warner</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(WarnerData)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
