<!DOCTYPE html><html lang="en"><head><title>Help for package TSSS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TSSS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#TSSS-package'>
<p>Time Series Analysis with State Space Model</p></a></li>
<li><a href='#arfit'><p>Univariate AR Model Fitting</p></a></li>
<li><a href='#armachar'><p>Calculate Characteristics of Scalar ARMA Model</p></a></li>
<li><a href='#armafit'><p>Scalar ARMA Model Fitting</p></a></li>
<li><a href='#armafit2'><p>Scalar ARMA Model Fitting</p></a></li>
<li><a href='#BLSALLFOOD'><p>BLSALLFOOD Data</p></a></li>
<li><a href='#boxcox'><p>Box-Cox Transformation</p></a></li>
<li><a href='#crscor'><p>Cross-Covariance and Cross-Correlation</p></a></li>
<li><a href='#fftper'><p>Compute a Periodogram via FFT</p></a></li>
<li><a href='#Haibara'><p>Haibara Data</p></a></li>
<li><a href='#HAKUSAN'><p>Ship's Navigation Data</p></a></li>
<li><a href='#klinfo'><p>Kullback-Leibler Information</p></a></li>
<li><a href='#lsar'><p>Decomposition of Time Interval to Stationary Subintervals</p></a></li>
<li><a href='#lsar.chgpt'><p>Estimation of the Change Point</p></a></li>
<li><a href='#lsqr'><p>The Least Squares Method via Householder Transformation</p></a></li>
<li><a href='#marfit'><p>Yule-Walker Method of Fitting Multivariate AR Model</p></a></li>
<li><a href='#marlsq'><p>Least Squares Method for Multivariate AR Model</p></a></li>
<li><a href='#marspc'><p>Cross Spectra and Power Contribution</p></a></li>
<li><a href='#MYE1F'><p>Seismic Data</p></a></li>
<li><a href='#ngsim'><p>Simulation by Non-Gaussian State Space Model</p></a></li>
<li><a href='#ngsmth'><p>Non-Gaussian Smoothing</p></a></li>
<li><a href='#Nikkei225'><p>Nikkei225</p></a></li>
<li><a href='#NLmodel'><p>The Nonlinear State-Space Model Data</p></a></li>
<li><a href='#pdfunc'><p>Probability Density Function</p></a></li>
<li><a href='#period'><p>Compute a Periodogram</p></a></li>
<li><a href='#pfilter'><p>Particle Filtering and Smoothing</p></a></li>
<li><a href='#pfilterNL'><p>Particle Filtering and Smoothing for Nonlinear State-Space Model</p></a></li>
<li><a href='#PfilterSample'><p>Sample Data for Particle Filter and Smoother</p></a></li>
<li><a href='#plot.boxcox'><p>Plot Box-Cox Transformed Data</p></a></li>
<li><a href='#plot.lsqr'><p>Plot Fitted Trigonometric Polynomial</p></a></li>
<li><a href='#plot.ngsmth'><p>Plot Smoothed Density Function</p></a></li>
<li><a href='#plot.polreg'><p>Plot Fitted Polynomial Trend</p></a></li>
<li><a href='#plot.season'><p>Plot Trend, Seasonal and AR Components</p></a></li>
<li><a href='#plot.simulate'><p>Plot Simulated Data Generated by State Space Model</p></a></li>
<li><a href='#plot.smooth'><p>Plot Posterior Distribution of Smoother</p></a></li>
<li><a href='#plot.spg'><p>Plot Smoothed Periodogram</p></a></li>
<li><a href='#plot.trend'><p>Plot Trend and Residuals</p></a></li>
<li><a href='#plot.tvspc'><p>Plot Evolutionary Power Spectra Obtained by Time Varying AR Model</p></a></li>
<li><a href='#polreg'><p>Polynomial Regression Model</p></a></li>
<li><a href='#Rainfall'><p>Rainfall Data</p></a></li>
<li><a href='#season'><p>Seasonal Adjustment</p></a></li>
<li><a href='#simssm'><p>Simulation by Gaussian State Space Model</p></a></li>
<li><a href='#Sunspot'><p>Sunspot Number Data</p></a></li>
<li><a href='#Temperature'><p>Temperatures Data</p></a></li>
<li><a href='#trend'><p>Trend Estimation</p></a></li>
<li><a href='#tsmooth'><p>Prediction and Interpolation of Time Series</p></a></li>
<li><a href='#tvar'><p>Time Varying Coefficients AR Model</p></a></li>
<li><a href='#tvspc'><p>Evolutionary Power Spectra by Time Varying AR Model</p></a></li>
<li><a href='#tvvar'><p>Time Varying Variance</p></a></li>
<li><a href='#unicor'><p>Autocovariance and Autocorrelation</p></a></li>
<li><a href='#WHARD'><p>Wholesale Hardware Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.3.4-5</td>
</tr>
<tr>
<td>Title:</td>
<td>Time Series Analysis with State Space Model</td>
</tr>
<tr>
<td>Author:</td>
<td>The Institute of Statistical Mathematics, based on the program by
 Genshiro Kitagawa</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Masami Saga &lt;msaga@mtb.biglobe.ne.jp&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6), datasets, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>utils</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for statistical analysis, modeling and simulation of time
 series with state space model, based on the methodology in Kitagawa
 (2020, ISBN: 978-0-367-18733-0).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Contact:</td>
<td>Bug report mailing list &lt;ismrp@grp.ism.ac.jp&gt;</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-29 02:08:48 UTC; msaga</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-29 04:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='TSSS-package'>
Time Series Analysis with State Space Model
</h2><span id='topic+TSSS-package'></span><span id='topic+TSSS'></span>

<h3>Description</h3>

<p>R functions for statistical analysis, modeling and simulation of time series
with state space model.
</p>


<h3>Details</h3>

<p>This package provides functions for statistical analysis, modeling and
simulation of time series. These functions are developed based on source code
of &quot;FORTRAN 77 Programming for Time Series Analysis&quot;.
</p>
<p>After that, the revised edition &quot;Introduction to Time Series Analysis (in Japanese)&quot; 
and the translation version &quot;Introduction to Time Series Modeling&quot; are published.
</p>
<p>Currently the revised edition &quot;Introduction to Time Series Modeling with Applications in R&quot;
is published, in which calculations of most of the modeling or methods are explained using
this package.
</p>


<h3>References</h3>

<p>Kitagawa, G. and Gersch, W. (1996)
<em>Smoothness Priors Analysis of Time Series</em>. Lecture Notes in Statistics,
No.116, Springer-Verlag.
</p>
<p>Kitagawa, G. (2010)
<em>Introduction to Time Series Modeling</em>. Chapman &amp; Hall/CRC.
</p>
<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>. Chapman &amp; Hall/CRC.
</p>
<p>Kitagawa, G. (1993)
<em>FORTRAN 77 Programming for Time Series Analysis</em>.
The Iwanami Computer Science Series, Iwanami Publishing Company (in Japanese).
</p>
<p>Kitagawa, G. (2005)
<em>Introduction to Time Series Analysis</em>.
Iwanami Publishing Company (in Japanese).
</p>
<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with R</em>.
Iwanami Publishing Company (in Japanese).
</p>

<hr>
<h2 id='arfit'>Univariate AR Model Fitting</h2><span id='topic+arfit'></span>

<h3>Description</h3>

<p>Fit a univariate AR model by the Yule-Walker method, the least squares (Householder)
method or the PARCOR method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arfit(y, lag = NULL, method = 1, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arfit_+3A_y">y</code></td>
<td>
<p>a univariate time series.</p>
</td></tr>
<tr><td><code id="arfit_+3A_lag">lag</code></td>
<td>
<p>highest order of AR model. Default is <code class="reqn">2 \sqrt{n}</code>,
where <code class="reqn">n</code> is the length of the time series <code>y</code>.</p>
</td></tr>
<tr><td><code id="arfit_+3A_method">method</code></td>
<td>
<p>estimation procedure.
</p>

<table>
<tr>
 <td style="text-align: right;">
      1 : </td><td style="text-align: left;"> Yule-Walker method</td>
</tr>
<tr>
 <td style="text-align: right;">
      2 : </td><td style="text-align: left;"> Least squares (Householder) method</td>
</tr>
<tr>
 <td style="text-align: right;">
      3 : </td><td style="text-align: left;"> PARCOR method (Partial autoregression)</td>
</tr>
<tr>
 <td style="text-align: right;">
      4 : </td><td style="text-align: left;"> PARCOR method (PARCOR)</td>
</tr>
<tr>
 <td style="text-align: right;">
      5 : </td><td style="text-align: left;"> PARCOR method (Burg's algorithm)</td>
</tr>

</table>

</td></tr>
<tr><td><code id="arfit_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), PARCOR, AIC and power spectrum
are plotted.</p>
</td></tr>
<tr><td><code id="arfit_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to the <code>plot</code> method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"arfit"</code> which has a <code>plot</code> method. This is a
list with the following components:
</p>
<table role = "presentation">
<tr><td><code>sigma2</code></td>
<td>
<p>innovation variance.</p>
</td></tr>
<tr><td><code>maice.order</code></td>
<td>
<p>order of minimum AIC.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>AICs of the estimated AR models.</p>
</td></tr>
<tr><td><code>arcoef</code></td>
<td>
<p>AR coefficients of the estimated AR models.</p>
</td></tr>
<tr><td><code>parcor</code></td>
<td>
<p>PARCOR.</p>
</td></tr>
<tr><td><code>spec</code></td>
<td>
<p>power spectrum (in log scale) of the AIC best AR model.</p>
</td></tr>
<tr><td><code>tsname</code></td>
<td>
<p>the name of the univariate time series <code>y</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sunspot number data
data(Sunspot)
arfit(log10(Sunspot), lag = 20, method = 1)

# BLSALLFOOD data
data(BLSALLFOOD)
arfit(BLSALLFOOD)
</code></pre>

<hr>
<h2 id='armachar'>Calculate Characteristics of Scalar ARMA Model</h2><span id='topic+armachar'></span>

<h3>Description</h3>

<p>Calculate impulse response function, autocovariance function, autocorrelation
function and characteristic roots of given scalar ARMA model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>armachar(arcoef = NULL, macoef = NULL, v, lag = 50, nf = 200, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="armachar_+3A_arcoef">arcoef</code></td>
<td>
<p>AR coefficients.</p>
</td></tr>
<tr><td><code id="armachar_+3A_macoef">macoef</code></td>
<td>
<p>MA coefficients.</p>
</td></tr>
<tr><td><code id="armachar_+3A_v">v</code></td>
<td>
<p>innovation variance.</p>
</td></tr>
<tr><td><code id="armachar_+3A_lag">lag</code></td>
<td>
<p>maximum lag of autocovariance function.</p>
</td></tr>
<tr><td><code id="armachar_+3A_nf">nf</code></td>
<td>
<p>number of frequencies in evaluating spectrum.</p>
</td></tr>
<tr><td><code id="armachar_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), impulse response function,
autocovariance, power spectrum, PARCOR and characteristic roots are plotted.</p>
</td></tr>
<tr><td><code id="armachar_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to the <code>plot</code> method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ARMA model is given by
</p>
<p style="text-align: center;"><code class="reqn">y_t - a_1y_{t-1} - \dots - a_py_{t-p} = u_t - b_1u_{t-1} - \dots - b_qu_{t-q},</code>
</p>

<p>where <code class="reqn">p</code> is AR order, <code class="reqn">q</code> is MA order and <code class="reqn">u_t</code> is a zero
mean white noise.
</p>
<p>Characteristic roots of AR / MA operator is a list with the following components:
</p>

<ul>
<li><p> re: real part <code class="reqn">R</code>
</p>
</li>
<li><p> im: imaginary part <code class="reqn">I</code>
</p>
</li>
<li><p> amp: <code class="reqn">\sqrt{R^2+I^2}</code>
</p>
</li>
<li><p> atan: <code class="reqn">\arctan(I/R)</code>
</p>
</li>
<li><p> degree
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class <code>"arma"</code> which has a <code>plot</code> method. This is a
list with components:
</p>
<table role = "presentation">
<tr><td><code>impuls</code></td>
<td>
<p>impulse response function.</p>
</td></tr>
<tr><td><code>acov</code></td>
<td>
<p>autocovariance function.</p>
</td></tr>
<tr><td><code>parcor</code></td>
<td>
<p>PARCOR.</p>
</td></tr>
<tr><td><code>spec</code></td>
<td>
<p>power spectrum.</p>
</td></tr>
<tr><td><code>croot.ar</code></td>
<td>
<p>characteristic roots of AR operator. See Details.</p>
</td></tr>
<tr><td><code>croot.ma</code></td>
<td>
<p>characteristic roots of MA operator. See Details.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># AR model : y(n) = a(1)*y(n-1) + a(2)*y(n-2) + v(n)
a &lt;- c(0.9 * sqrt(3), -0.81)
armachar(arcoef = a, v = 1.0, lag = 20)

# MA model : y(n) = v(n) - b(1)*v(n-1) - b(2)*v(n-2)
b &lt;- c(0.9 * sqrt(2), -0.81)
armachar(macoef = b, v = 1.0, lag = 20)

# ARMA model :  y(n) = a(1)*y(n-1) + a(2)*y(n-2)
#                      + v(n) - b(1)*v(n-1) - b(2)*v(n-2)
armachar(arcoef = a, macoef = b, v = 1.0, lag = 20)
</code></pre>

<hr>
<h2 id='armafit'>Scalar ARMA Model Fitting</h2><span id='topic+armafit'></span>

<h3>Description</h3>

<p>Fit a scalar ARMA model by maximum likelihood method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>armafit(y, ar.order, ar = NULL, ma.order, ma = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="armafit_+3A_y">y</code></td>
<td>
<p>a univariate time series.</p>
</td></tr>
<tr><td><code id="armafit_+3A_ar.order">ar.order</code></td>
<td>
<p>AR order.</p>
</td></tr>
<tr><td><code id="armafit_+3A_ar">ar</code></td>
<td>
<p>initial AR coefficients. If <code>NULL</code> (default), use default
initial values.</p>
</td></tr>
<tr><td><code id="armafit_+3A_ma.order">ma.order</code></td>
<td>
<p>MA order.</p>
</td></tr>
<tr><td><code id="armafit_+3A_ma">ma</code></td>
<td>
<p>initial MA coefficients. If <code>NULL</code> (default), use default
initial values.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>sigma2</code></td>
<td>
<p>innovation variance.</p>
</td></tr>
<tr><td><code>llkhood</code></td>
<td>
<p>log-likelihood of the model.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>AIC of the model.</p>
</td></tr>
<tr><td><code>arcoef</code></td>
<td>
<p>AR coefficients.</p>
</td></tr>
<tr><td><code>macoef</code></td>
<td>
<p>MA coefficients.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sunspot number data
data(Sunspot)
y &lt;- log10(Sunspot)
z &lt;- armafit(y, ar.order = 3, ma.order = 3)
z

armachar(arcoef = z$arcoef, macoef = z$macoef, v = z$sigma2, lag = 20)
</code></pre>

<hr>
<h2 id='armafit2'>Scalar ARMA Model Fitting</h2><span id='topic+armafit2'></span>

<h3>Description</h3>

<p>Estimate all ARMA models within the user-specified maximum order by
maximum likelihood method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>armafit2(y, ar.order, ma.order)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="armafit2_+3A_y">y</code></td>
<td>
<p>a univariate time series.</p>
</td></tr>
<tr><td><code id="armafit2_+3A_ar.order">ar.order</code></td>
<td>
<p>maximum AR order.</p>
</td></tr>
<tr><td><code id="armafit2_+3A_ma.order">ma.order</code></td>
<td>
<p>maximum MA order.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>aicmin</code></td>
<td>
<p>minimum AIC.</p>
</td></tr>
<tr><td><code>maice.order</code></td>
<td>
<p>AR and MA orders of minimum AIC model.</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>innovation variance of all models.</p>
</td></tr>
<tr><td><code>llkhood</code></td>
<td>
<p>log-likelihood of all models.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>AIC of all models.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>AR and MA coefficients of all models.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sunspot number data
data(Sunspot)
y &lt;- log10(Sunspot)
armafit2(y, ar.order = 5, ma.order = 5)
</code></pre>

<hr>
<h2 id='BLSALLFOOD'>BLSALLFOOD Data</h2><span id='topic+BLSALLFOOD'></span>

<h3>Description</h3>

<p>The monthly time series of the number of workers engaged in food industries in
the United States (January 1967 - December 1979).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(BLSALLFOOD)
</code></pre>


<h3>Format</h3>

<p>A time series of 156 observations.
</p>


<h3>Source</h3>

<p>The data were obtained from the United States Bureau of Labor Statistics (BLS).
</p>

<hr>
<h2 id='boxcox'>Box-Cox Transformation</h2><span id='topic+boxcox'></span>

<h3>Description</h3>

<p>Compute Box-Cox transformation and find an optimal lambda with minimum AIC.</p>


<h3>Usage</h3>

<pre><code class='language-R'>boxcox(y, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="boxcox_+3A_y">y</code></td>
<td>
<p>a univariate time series.</p>
</td></tr>
<tr><td><code id="boxcox_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), original data and transformed
data with minimum AIC are plotted.</p>
</td></tr>
<tr><td><code id="boxcox_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to <code><a href="#topic+plot.boxcox">plot.boxcox</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"boxcox"</code>, which is a list with the following
components:
</p>
<table role = "presentation">
<tr><td><code>mean</code></td>
<td>
<p>mean of original data.</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>variance of original data.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>AIC of the model with respect to the original data.</p>
</td></tr>
<tr><td><code>llkhood</code></td>
<td>
<p>log-likelihood of the model with respect to the original data.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>transformed data with the AIC best lambda.</p>
</td></tr>
<tr><td><code>aic.z</code></td>
<td>
<p>AIC of the model with respect to the transformed data.</p>
</td></tr>
<tr><td><code>llkhood.z</code></td>
<td>
<p>log-likelihood of the model with respect to the transformed
data.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sunspot number data
data(Sunspot)
boxcox(Sunspot)

# Wholesale hardware data
data(WHARD)
boxcox(WHARD)
</code></pre>

<hr>
<h2 id='crscor'>Cross-Covariance and Cross-Correlation</h2><span id='topic+crscor'></span>

<h3>Description</h3>

<p>Compute cross-covariance and cross-correlation functions of the multivariate
time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crscor(y, lag = NULL, outmin = NULL, outmax = NULL, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crscor_+3A_y">y</code></td>
<td>
<p>a multivariate time series.</p>
</td></tr>
<tr><td><code id="crscor_+3A_lag">lag</code></td>
<td>
<p>maximum lag. Default is <code class="reqn">2 \sqrt{n}</code>, where <code class="reqn">n</code>
is the length of the time series <code>y</code>.</p>
</td></tr>
<tr><td><code id="crscor_+3A_outmin">outmin</code></td>
<td>
<p>bound for outliers in low side. A default value is -1.0e+30 for
each dimension.</p>
</td></tr>
<tr><td><code id="crscor_+3A_outmax">outmax</code></td>
<td>
<p>bound for outliers in high side. A default value is 1.0e+30 for
each dimension.</p>
</td></tr>
<tr><td><code id="crscor_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), cross-correlations are plotted.</p>
</td></tr>
<tr><td><code id="crscor_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to the <code>plot</code> method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"crscor"</code> which has a <code>plot</code> method. This is a
list with the following components:
</p>
<table role = "presentation">
<tr><td><code>cov</code></td>
<td>
<p>cross-covariances.</p>
</td></tr>
<tr><td><code>cor</code></td>
<td>
<p>cross-correlations.</p>
</td></tr>
<tr><td><code>mean</code></td>
<td>
<p>mean vector.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Yaw rate, rolling, pitching and rudder angle of a ship
data(HAKUSAN)
y &lt;- as.matrix(HAKUSAN[, 2:4])   # Rolling, Pitching, Rudder
crscor(y, lag = 50)

# The groundwater level and the atmospheric pressure
data(Haibara)
crscor(Haibara, lag = 50)
</code></pre>

<hr>
<h2 id='fftper'>Compute a Periodogram via FFT</h2><span id='topic+fftper'></span>

<h3>Description</h3>

<p>Compute a periodogram of the univariate time series via FFT.</p>


<h3>Usage</h3>

<pre><code class='language-R'>fftper(y, window = 1, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fftper_+3A_y">y</code></td>
<td>
<p>a univariate time series.</p>
</td></tr>
<tr><td><code id="fftper_+3A_window">window</code></td>
<td>
<p>smoothing window type. (0: box-car, 1: Hanning, 2: Hamming)</p>
</td></tr>
<tr><td><code id="fftper_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), smoothed (log-)periodogram is
plotted.</p>
</td></tr>
<tr><td><code id="fftper_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to <code><a href="#topic+plot.spg">plot.spg</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: right;">
    Hanning Window : </td><td style="text-align: left;"> <code class="reqn">W_0</code> = 0.5 </td><td style="text-align: left;"> <code class="reqn">W_1</code> = 0.25 </td>
</tr>
<tr>
 <td style="text-align: right;">
    Hamming Window : </td><td style="text-align: left;"> <code class="reqn">W_0</code> = 0.54 </td><td style="text-align: left;"> <code class="reqn">W_1</code> = 0.23</td>
</tr>

</table>



<h3>Value</h3>

<p>An object of class <code>"spg"</code>, which is a list with the following components:
</p>
<table role = "presentation">
<tr><td><code>period</code></td>
<td>
<p>periodogram.</p>
</td></tr>
<tr><td><code>smoothed.period</code></td>
<td>
<p>smoothed periodogram. If there is not a negative
number, logarithm of smoothed periodogram.</p>
</td></tr>
<tr><td><code>log.scale</code></td>
<td>
<p>logical. If <code>TRUE</code> <code>smoothed.period</code> is logarithm
of smoothed periodogram.</p>
</td></tr>
<tr><td><code>tsname</code></td>
<td>
<p>the name of the univariate time series <code>y</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>We assume that the length <code class="reqn">N</code> of the input time series <code>y</code> is a power
of 2. If <code class="reqn">N</code> is not a power of 2, calculate using the FFT by appending 0's
behind the data <code>y</code>. 
</p>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Yaw rate, rolling, pitching and rudder angle of a ship
data(HAKUSAN)
YawRate &lt;- HAKUSAN[, 1]
fftper(YawRate, window = 0)
</code></pre>

<hr>
<h2 id='Haibara'>Haibara Data</h2><span id='topic+Haibara'></span>

<h3>Description</h3>

<p>A bivariate time series of the groundwater level and the atmospheric pressure
that were observed at 10-minuite intervals at the Haibara observatory of the
Tokai region, Japan.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Haibara)
</code></pre>


<h3>Format</h3>

<p>A data frame with 400 observations on the following 2 variables.
</p>

<table>
<tr>
 <td style="text-align: right;">
  [, 1] </td><td style="text-align: left;"> Groundwater level</td>
</tr>
<tr>
 <td style="text-align: right;">
  [, 2] </td><td style="text-align: left;"> Atmospheric pressure
  </td>
</tr>

</table>



<h3>Source</h3>

<p>The data were offered by Dr. M. Takahashi and Dr. N. Matsumoto of National
Institute of Advanced Industrial Science and Technology.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Haibara)

## put histograms on the diagonal
panel.hist &lt;- function(x, ...)
{
    usr &lt;- par("usr")
    par(usr = c(usr[1:2], 0, 1.3))
    nB &lt;- 15; nB1 &lt;- nB + 1
    xmin &lt;- min(x, na.rm = TRUE)
    xmax &lt;- max(x, na.rm = TRUE)
    w &lt;- (xmax - xmin) / nB
    breaks &lt;- xmin
    b &lt;- xmin
    for (i in 1:nB) {
      b &lt;- b + w
      breaks &lt;- c(breaks, b)
    }
    h &lt;- hist(x, breaks = breaks, plot = FALSE)
    y &lt;- h$counts
    y &lt;- y / max(y)
    rect(breaks[1:nB], 0, breaks[2:nB1], y, ...)
}

par(xaxs = "i", yaxs = "i", xaxt = "n", yaxt = "n")
pairs(Haibara, diag.panel = panel.hist, pch = 20, cex.labels = 1.5,
      label.pos = 0.9, lower.panel = NULL)
</code></pre>

<hr>
<h2 id='HAKUSAN'>Ship's Navigation Data</h2><span id='topic+HAKUSAN'></span>

<h3>Description</h3>

<p>A multivariate time series of a ship's yaw rate, rolling, pitching and rudder
angles which were recorded every second while navigating across the Pacific
Ocean.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(HAKUSAN)
</code></pre>


<h3>Format</h3>

<p>A data frame with 1000 observations on the following 4 variables.
</p>

<table>
<tr>
 <td style="text-align: right;">
  [, 1] </td><td style="text-align: left;"> YawRate </td><td style="text-align: left;"> yaw rate</td>
</tr>
<tr>
 <td style="text-align: right;">
  [, 2] </td><td style="text-align: left;"> Rolling </td><td style="text-align: left;"> rolling</td>
</tr>
<tr>
 <td style="text-align: right;">
  [, 3] </td><td style="text-align: left;"> Pitching</td><td style="text-align: left;"> pitching</td>
</tr>
<tr>
 <td style="text-align: right;">
  [, 4] </td><td style="text-align: left;"> Rudder  </td><td style="text-align: left;"> rudder angle
  </td>
</tr>

</table>



<h3>Source</h3>

<p>The data were offered by Prof. K. Ohtsu of Tokyo University of Marine Science
and Technology.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HAKUSAN)
HAKUSAN234 &lt;- HAKUSAN[, c(2,3,4)]

## put histograms on the diagonal
panel.hist &lt;- function(x, ...)
{
    usr &lt;- par("usr")
    par(usr = c(usr[1:2], 0, 1.3))
    nB &lt;- 20; nB1 &lt;- nB + 1
    xmin &lt;- min(x)
    xmax &lt;- max(x)
    w &lt;- (xmax - xmin) / nB
    breaks &lt;- xmin
    b &lt;- xmin
    for (i in 1:nB) {
      b &lt;- b + w
      breaks &lt;- c(breaks, b)
    }
    h &lt;- hist(x, breaks = breaks, plot = FALSE)
    y &lt;- h$counts; y &lt;- y / max(y)
    rect(breaks[1:nB], 0, breaks[2:nB1], y, ...)

}

par(xaxs = "i", yaxs = "i", xaxt = "n", yaxt = "n")
pairs(HAKUSAN234, diag.panel = panel.hist, pch = 20, cex.labels = 1.5, 
      label.pos = 0.9, lower.panel = NULL)
</code></pre>

<hr>
<h2 id='klinfo'>Kullback-Leibler Information</h2><span id='topic+klinfo'></span>

<h3>Description</h3>

<p>Compute Kullback-Leibler information.</p>


<h3>Usage</h3>

<pre><code class='language-R'>klinfo(distg = 1, paramg = c(0, 1), distf = 1, paramf, xmax = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="klinfo_+3A_distg">distg</code></td>
<td>
<p>function for the true density (1 or 2).
</p>

<table>
<tr>
 <td style="text-align: right;">
      1 : </td><td style="text-align: left;"> Gaussian (normal) distribution</td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> paramg(1): mean</td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> paramg(2): variance</td>
</tr>
<tr>
 <td style="text-align: right;">
      2 : </td><td style="text-align: left;"> Cauchy distribution</td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> paramg(1): <code class="reqn">\mu</code> (location parameter)</td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> paramg(2): <code class="reqn">\tau^2</code> (dispersion parameter)</td>
</tr>

</table>

</td></tr>
<tr><td><code id="klinfo_+3A_paramg">paramg</code></td>
<td>
<p>parameter vector of true density.</p>
</td></tr>
<tr><td><code id="klinfo_+3A_distf">distf</code></td>
<td>
<p>function for the model density (1 or 2).
</p>

<table>
<tr>
 <td style="text-align: right;">
      1 : </td><td style="text-align: left;"> Gaussian (normal) distribution</td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> paramf(1): mean</td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> paramf(2): variance</td>
</tr>
<tr>
 <td style="text-align: right;">
      2 : </td><td style="text-align: left;"> Cauchy distribution</td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> paramf(1): <code class="reqn">\mu</code> (location parameter)</td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> paramf(2): <code class="reqn">\tau^2</code> (dispersion parameter)</td>
</tr>

</table>

</td></tr>
<tr><td><code id="klinfo_+3A_paramf">paramf</code></td>
<td>
<p>parameter vector of the model density.</p>
</td></tr>
<tr><td><code id="klinfo_+3A_xmax">xmax</code></td>
<td>
<p>upper limit of integration. lower limit xmin = -<code>xmax</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>nint</code></td>
<td>
<p>number of function evaluation.</p>
</td></tr>
<tr><td><code>dx</code></td>
<td>
<p>delta.</p>
</td></tr>
<tr><td><code>KLI</code></td>
<td>
<p>Kullback-Leibler information, <code class="reqn">I(g;f)</code>.</p>
</td></tr>
<tr><td><code>gint</code></td>
<td>
<p>integration of <code class="reqn">g(y)</code> over [-<code>xmax</code>, <code>xmax</code>].</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># g:Gauss, f:Gauss
klinfo(distg = 1, paramg = c(0, 1), distf = 1, paramf = c(0.1, 1.5), xmax = 8)

# g:Gauss, f:Cauchy
klinfo(distg = 1, paramg = c(0, 1), distf = 2, paramf = c(0, 1), xmax = 8)
</code></pre>

<hr>
<h2 id='lsar'>Decomposition of Time Interval to Stationary Subintervals</h2><span id='topic+lsar'></span>

<h3>Description</h3>

<p>Decompose time series to stationary subintervals and estimate local spectrum.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lsar(y, max.arorder = 20, ns0, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lsar_+3A_y">y</code></td>
<td>
<p>a univariate time series.</p>
</td></tr>
<tr><td><code id="lsar_+3A_max.arorder">max.arorder</code></td>
<td>
<p>highest order of AR model.</p>
</td></tr>
<tr><td><code id="lsar_+3A_ns0">ns0</code></td>
<td>
<p>length of basic local span.</p>
</td></tr>
<tr><td><code id="lsar_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), local spectra are plotted.</p>
</td></tr>
<tr><td><code id="lsar_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to the <code>plot</code> method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"lsar"</code> which has a <code>plot</code> method. This is a
list with the following components:
</p>
<table role = "presentation">
<tr><td><code>model</code></td>
<td>
<p>1: pooled model is accepted.<br /> 2: switched model is accepted.</p>
</td></tr> 
<tr><td><code>ns</code></td>
<td>
<p>number of observations of local span.</p>
</td></tr>
<tr><td><code>span</code></td>
<td>
<p>start points and end points of local spans.</p>
</td></tr>
<tr><td><code>nf</code></td>
<td>
<p>number of frequencies in computing local power spectrum.</p>
</td></tr>
<tr><td><code>ms</code></td>
<td>
<p>order of switched model.</p>
</td></tr>
<tr><td><code>sds</code></td>
<td>
<p>innovation variance of switched model.</p>
</td></tr>
<tr><td><code>aics</code></td>
<td>
<p>AIC of switched model.</p>
</td></tr>
<tr><td><code>mp</code></td>
<td>
<p>order of pooled model.</p>
</td></tr>
<tr><td><code>sdp</code></td>
<td>
<p>innovation variance of pooled model.</p>
</td></tr>
<tr><td><code>aics</code></td>
<td>
<p>AIC of pooled model.</p>
</td></tr>
<tr><td><code>spec</code></td>
<td>
<p>local spectrum.</p>
</td></tr>
<tr><td><code>tsname</code></td>
<td>
<p>the name of the univariate time series <code>y</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># seismic data
data(MYE1F)
lsar(MYE1F, max.arorder = 10, ns0 = 100)
</code></pre>

<hr>
<h2 id='lsar.chgpt'>Estimation of the Change Point</h2><span id='topic+lsar.chgpt'></span>

<h3>Description</h3>

<p>Precisely estimate a change point of subinterval for locally stationary AR
model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lsar.chgpt(y, max.arorder = 20, subinterval, candidate, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lsar.chgpt_+3A_y">y</code></td>
<td>
<p>a univariate time series.</p>
</td></tr>
<tr><td><code id="lsar.chgpt_+3A_max.arorder">max.arorder</code></td>
<td>
<p>highest order of AR model.</p>
</td></tr>
<tr><td><code id="lsar.chgpt_+3A_subinterval">subinterval</code></td>
<td>
<p>a vector of the form <code>c(n0, ne)</code> which gives a start
and end point of time interval used for model fitting.</p>
</td></tr>
<tr><td><code id="lsar.chgpt_+3A_candidate">candidate</code></td>
<td>
<p>a vector of the form <code>c(n1, n2)</code> which gives minimum
and maximum of the candidate for change point.
</p>
<p><code>n0+2k</code> &lt; <code>n1</code> &lt; <code>n2+k</code> &lt; <code>ne</code>,
( <code>k</code> is <code>max.arorder</code> )</p>
</td></tr>
<tr><td><code id="lsar.chgpt_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), <code>y[n0:ne]</code> and
<code>aic</code> are plotted.</p>
</td></tr>
<tr><td><code id="lsar.chgpt_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to the <code>plot</code> method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"chgpt"</code> which has a <code>plot</code> method. This is a
list with the following components:
</p>
<table role = "presentation">
<tr><td><code>aic</code></td>
<td>
<p>AICs of the AR models fitted on <code>[n1, n2]</code>.</p>
</td></tr>
<tr><td><code>aicmin</code></td>
<td>
<p>minimum AIC.</p>
</td></tr>
<tr><td><code>change.point</code></td>
<td>
<p>estimated change point.</p>
</td></tr>
<tr><td><code>subint</code></td>
<td>
<p>information about the original sub-interval.</p>
</td></tr> 
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># seismic data
data(MYE1F)
lsar.chgpt(MYE1F, max.arorder = 10, subinterval = c(200, 1000),
           candidate = c(400, 800))

lsar.chgpt(MYE1F, max.arorder = 10, subinterval = c(600, 1400),
           candidate = c(800, 1200))
</code></pre>

<hr>
<h2 id='lsqr'>The Least Squares Method via Householder Transformation</h2><span id='topic+lsqr'></span>

<h3>Description</h3>

<p>Compute regression coefficients of the model with minimum AIC by the least
squares method via Householder transformation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lsqr(y, lag = NULL, period = 365, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lsqr_+3A_y">y</code></td>
<td>
<p>a univariate time series.</p>
</td></tr>
<tr><td><code id="lsqr_+3A_lag">lag</code></td>
<td>
<p>number of sine and cosine components. Default is <code class="reqn">\sqrt{n}</code>,
where <code class="reqn">n</code> is the length of the time series <code>y</code>.</p>
</td></tr>
<tr><td><code id="lsqr_+3A_period">period</code></td>
<td>
<p>period of one cycle.</p>
</td></tr>
<tr><td><code id="lsqr_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), original data and fitted
trigonometric polynomial are plotted.</p>
</td></tr>
<tr><td><code id="lsqr_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to <code><a href="#topic+plot.lsqr">plot.lsqr</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"lsqr"</code>, which is a list with the following
components:
</p>
<table role = "presentation">
<tr><td><code>aic</code></td>
<td>

<p>AIC's of the model with order <code class="reqn">0,\dots,k ( = 2</code><code>lag</code><code class="reqn"> + 1)</code>.</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>residual variance of the model with order <code class="reqn">0,\dots,k</code>.</p>
</td></tr>
<tr><td><code>maice.order</code></td>
<td>
<p>order of minimum AIC.</p>
</td></tr>
<tr><td><code>regress</code></td>
<td>
<p>regression coefficients of the model.</p>
</td></tr>
<tr><td><code>tripoly</code></td>
<td>
<p>trigonometric polynomial.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The daily maximum temperatures in Tokyo
data(Temperature)
lsqr(Temperature, lag = 10)
</code></pre>

<hr>
<h2 id='marfit'>Yule-Walker Method of Fitting Multivariate AR Model</h2><span id='topic+marfit'></span>

<h3>Description</h3>

<p>Fit a multivariate AR model by the Yule-Walker method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marfit(y, lag = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="marfit_+3A_y">y</code></td>
<td>
<p>a multivariate time series.</p>
</td></tr>
<tr><td><code id="marfit_+3A_lag">lag</code></td>
<td>
<p>highest order of fitted AR models. Default is <code class="reqn">2 \sqrt{n}</code>, where <code class="reqn">n</code> is the length of the time series <code>y</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"maryule"</code>, which is a list with the following
components:
</p>
<table role = "presentation">
<tr><td><code>maice.order</code></td>
<td>
<p>order of minimum AIC.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>AIC's of the AR models with order <code class="reqn">0,\dots,</code><code>lag</code>.</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>innovation covariance matrix of the AIC best model.</p>
</td></tr>
<tr><td><code>arcoef</code></td>
<td>
<p>AR coefficients of the AIC best model.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Yaw rate, rolling, pitching and rudder angle of a ship
data(HAKUSAN)
yy &lt;- as.matrix(HAKUSAN[, c(1,2,4)])   # Yaw rate, Pitching, Rudder angle
nc &lt;- dim(yy)[1]
n &lt;- seq(1, nc, by = 2) 
y &lt;- yy[n, ]
marfit(y, 20)
</code></pre>

<hr>
<h2 id='marlsq'>Least Squares Method for Multivariate AR Model</h2><span id='topic+marlsq'></span>

<h3>Description</h3>

<p>Fit a multivariate AR model by least squares method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marlsq(y, lag = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="marlsq_+3A_y">y</code></td>
<td>
<p>a multivariate time series.</p>
</td></tr>
<tr><td><code id="marlsq_+3A_lag">lag</code></td>
<td>
<p>highest AR order. Default is <code class="reqn">2 \sqrt{n}</code>, where
<code class="reqn">n</code> is the length of the time series <code>y</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"marlsq"</code>, which is a list with the following
components:
</p>
<table role = "presentation">
<tr><td><code>maice.order</code></td>
<td>
<p>order of the MAICE model.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>AIC of the MAR model with minimum AIC orders.</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>innovation covariance matrix.</p>
</td></tr>
<tr><td><code>arcoef</code></td>
<td>
<p>AR coefficient matrices.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Yaw rate, rolling, pitching and rudder angle of a ship
data(HAKUSAN)
y &lt;- as.matrix(HAKUSAN[, c(1,2,4)])   # Yaw rate, Rolling, Rudder angle
z &lt;- marlsq(y)
z

marspc(z$arcoef, v = z$v)
</code></pre>

<hr>
<h2 id='marspc'>Cross Spectra and Power Contribution</h2><span id='topic+marspc'></span>

<h3>Description</h3>

<p>Compute cross spectra, coherency and power contribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marspc(arcoef, v, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="marspc_+3A_arcoef">arcoef</code></td>
<td>
<p>AR coefficient matrices.</p>
</td></tr>
<tr><td><code id="marspc_+3A_v">v</code></td>
<td>
<p>innovation variance matrix.</p>
</td></tr>
<tr><td><code id="marspc_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), cross spectra, coherency and
power contribution are plotted.</p>
</td></tr>
<tr><td><code id="marspc_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to the <code>plot</code> method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"marspc"</code> which has a <code>plot</code> method. This is a
list with the following components:
</p>
<table role = "presentation">
<tr><td><code>spec</code></td>
<td>
<p>cross spectra.</p>
</td></tr>
<tr><td><code>amp</code></td>
<td>
<p>amplitude spectra.</p>
</td></tr>
<tr><td><code>phase</code></td>
<td>
<p>phase spectra.</p>
</td></tr>
<tr><td><code>coh</code></td>
<td>
<p>simple coherency.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>decomposition of power spectra.</p>
</td></tr>
<tr><td><code>rpower</code></td>
<td>
<p>relative power contribution.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Yaw rate, rolling, pitching and rudder angle of a ship
data(HAKUSAN)
yy &lt;- as.matrix(HAKUSAN[, c(1,2,4)])
nc &lt;- dim(yy)[1]
n &lt;- seq(1, nc, by = 2) 
y &lt;- yy[n, ]
z &lt;- marfit(y, lag = 20)

marspc(z$arcoef, v = z$v)
</code></pre>

<hr>
<h2 id='MYE1F'>Seismic Data</h2><span id='topic+MYE1F'></span>

<h3>Description</h3>

<p>The time series of East-West components of seismic waves, recorded every 0.02
seconds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MYE1F)
</code></pre>


<h3>Format</h3>

<p>A time series of 2600 observations.
</p>


<h3>Source</h3>

<p>Takanami, T. (1991), &quot;ISM data 43-3-01: Seismograms of foreshocks of 1982
Urakawa-Oki earthquake&quot;, Ann. Inst. Statist. Math., 43, 605.
</p>

<hr>
<h2 id='ngsim'>Simulation by Non-Gaussian State Space Model</h2><span id='topic+ngsim'></span>

<h3>Description</h3>

<p>Simulation by non-Gaussian state space model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ngsim(n = 200, trend = NULL, seasonal.order = 0, seasonal = NULL, arcoef = NULL, 
      ar = NULL, noisew = 1, wminmax = NULL, paramw = NULL, noisev = 1,
      vminmax = NULL, paramv = NULL, seed = NULL, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ngsim_+3A_n">n</code></td>
<td>
<p>number of data generated by simulation.</p>
</td></tr>
<tr><td><code id="ngsim_+3A_trend">trend</code></td>
<td>
<p>initial values of trend component of length <code class="reqn">m1</code>, where
<code class="reqn">m1</code> is trend order (1, 2). If <code>NULL</code> (default), trend order is 0.</p>
</td></tr>
<tr><td><code id="ngsim_+3A_seasonal.order">seasonal.order</code></td>
<td>
<p>order of seasonal component model (0, 1, 2).</p>
</td></tr> 
<tr><td><code id="ngsim_+3A_seasonal">seasonal</code></td>
<td>
<p>if <code>seasonal.order</code> &gt; 0, initial values of seasonal component
of length <code class="reqn">p-1</code>, where <code class="reqn">p</code> is period of one season.</p>
</td></tr>
<tr><td><code id="ngsim_+3A_arcoef">arcoef</code></td>
<td>
<p>AR coefficients.</p>
</td></tr>
<tr><td><code id="ngsim_+3A_ar">ar</code></td>
<td>
<p>initial values of AR component.</p>
</td></tr>
<tr><td><code id="ngsim_+3A_noisew">noisew</code></td>
<td>
<p>type of the observational noise.
</p>

<table>
<tr>
 <td style="text-align: right;">
      -1 : </td><td style="text-align: left;"> Cauchy random number </td>
</tr>
<tr>
 <td style="text-align: right;">
      -2 : </td><td style="text-align: left;"> exponential distribution </td>
</tr>
<tr>
 <td style="text-align: right;">
      -3 : </td><td style="text-align: left;"> double exponential distribution </td>
</tr>
<tr>
 <td style="text-align: right;">
       0 : </td><td style="text-align: left;"> double exponential distribution (+ Euler's constant) </td>
</tr>
<tr>
 <td style="text-align: right;">
       1 : </td><td style="text-align: left;"> normal distribution (generated by inverse function) </td>
</tr>
<tr>
 <td style="text-align: right;">
       2 : </td><td style="text-align: left;"> Pearson distribution (generated by inverse function) </td>
</tr>
<tr>
 <td style="text-align: right;">
       3 : </td><td style="text-align: left;"> double exponential distribution (generated by inverse function)</td>
</tr>

</table>

</td></tr>
<tr><td><code id="ngsim_+3A_wminmax">wminmax</code></td>
<td>
<p>lower and upper bound of observational noise.</p>
</td></tr>
<tr><td><code id="ngsim_+3A_paramw">paramw</code></td>
<td>
<p>parameter of the observational noise density.
</p>

<table>
<tr>
 <td style="text-align: right;">
      noisew = 1 : </td><td style="text-align: left;"> variance</td>
</tr>
<tr>
 <td style="text-align: right;">
      noisew = 2 : </td><td style="text-align: left;"> dispersion parameter (tau square) and shape parameter</td>
</tr>

</table>

</td></tr>
<tr><td><code id="ngsim_+3A_noisev">noisev</code></td>
<td>
<p>type of the system noise.
</p>

<table>
<tr>
 <td style="text-align: right;">
      -1 : </td><td style="text-align: left;"> Cauchy random number </td>
</tr>
<tr>
 <td style="text-align: right;">
      -2 : </td><td style="text-align: left;"> exponential distribution </td>
</tr>
<tr>
 <td style="text-align: right;">
      -3 : </td><td style="text-align: left;"> double exponential distribution </td>
</tr>
<tr>
 <td style="text-align: right;">
       0 : </td><td style="text-align: left;"> double exponential distribution (+ Euler's constant) </td>
</tr>
<tr>
 <td style="text-align: right;">
       1 : </td><td style="text-align: left;"> normal distribution (generated by inverse function) </td>
</tr>
<tr>
 <td style="text-align: right;">
       2 : </td><td style="text-align: left;"> Pearson distribution (generated by inverse function) </td>
</tr>
<tr>
 <td style="text-align: right;">
       3 : </td><td style="text-align: left;"> double exponential distribution (generated by inverse function)</td>
</tr>

</table>

</td></tr>
<tr><td><code id="ngsim_+3A_vminmax">vminmax</code></td>
<td>
<p>lower and upper bound of system noise.</p>
</td></tr>
<tr><td><code id="ngsim_+3A_paramv">paramv</code></td>
<td>
<p>parameter of the system noise density.
</p>

<table>
<tr>
 <td style="text-align: right;">
    noisev = 1 : </td><td style="text-align: left;"> variance</td>
</tr>
<tr>
 <td style="text-align: right;">
    noisev = 2 : </td><td style="text-align: left;"> dispersion parameter (tau square) and shape parameter</td>
</tr>

</table>

</td></tr>
<tr><td><code id="ngsim_+3A_seed">seed</code></td>
<td>
<p>arbitrary positive integer to generate a sequence of uniform
random numbers. The default seed is based on the current time.</p>
</td></tr>
<tr><td><code id="ngsim_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), simulated data are plotted.</p>
</td></tr>
<tr><td><code id="ngsim_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to <code><a href="#topic+plot.simulate">plot.simulate</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"simulate"</code>, giving simulated data of non-Gaussian
state space model.
</p>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ar1 &lt;- ngsim(n = 400, arcoef = 0.95, noisew = 1, paramw = 1, noisev = 1,
             paramv = 1, seed = 555)
plot(ar1, use = c(201, 400))

ar2 &lt;- ngsim(n = 400, arcoef = c(1.3, -0.8), noisew = 1, paramw = 1, noisev = 1,
             paramv = 1, seed = 555)
plot(ar2, use = c(201, 400))


</code></pre>

<hr>
<h2 id='ngsmth'>Non-Gaussian Smoothing</h2><span id='topic+ngsmth'></span>

<h3>Description</h3>

<p>Trend estimation by non-Gaussian smoothing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ngsmth(y, noisev = 2, tau2, bv = 1.0, noisew = 1, sigma2, bw = 1.0, 
       initd = 1, k = 200, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ngsmth_+3A_y">y</code></td>
<td>
<p>a univariate time series.</p>
</td></tr>
<tr><td><code id="ngsmth_+3A_noisev">noisev</code></td>
<td>
<p>type of system noise density.
</p>

<table>
<tr>
 <td style="text-align: right;">
      1 : </td><td style="text-align: left;"> Gaussian (normal) </td>
</tr>
<tr>
 <td style="text-align: right;">
      2 : </td><td style="text-align: left;"> Pearson family </td>
</tr>
<tr>
 <td style="text-align: right;">
      3 : </td><td style="text-align: left;"> two-sided exponential</td>
</tr>

</table>

</td></tr>
<tr><td><code id="ngsmth_+3A_tau2">tau2</code></td>
<td>
<p>variance or dispersion of system noise.</p>
</td></tr>
<tr><td><code id="ngsmth_+3A_bv">bv</code></td>
<td>
<p>shape parameter of system noise (for <code>noisev</code> = 2).</p>
</td></tr>
<tr><td><code id="ngsmth_+3A_noisew">noisew</code></td>
<td>
<p>type of observation noise density
</p>

<table>
<tr>
 <td style="text-align: right;">
      1 : </td><td style="text-align: left;"> Gaussian (normal) </td>
</tr>
<tr>
 <td style="text-align: right;">
      2 : </td><td style="text-align: left;"> Pearson family </td>
</tr>
<tr>
 <td style="text-align: right;">
      3 : </td><td style="text-align: left;"> two-sided exponential </td>
</tr>
<tr>
 <td style="text-align: right;">
      4 : </td><td style="text-align: left;"> double exponential</td>
</tr>

</table>

</td></tr>
<tr><td><code id="ngsmth_+3A_sigma2">sigma2</code></td>
<td>
<p>variance or dispersion of observation noise.</p>
</td></tr>
<tr><td><code id="ngsmth_+3A_bw">bw</code></td>
<td>
<p>shape parameter of observation noise (for <code>noisew</code> = 2).</p>
</td></tr>
<tr><td><code id="ngsmth_+3A_initd">initd</code></td>
<td>
<p>type of density function.
</p>

<table>
<tr>
 <td style="text-align: right;">
      1 : </td><td style="text-align: left;"> Gaussian (normal) </td>
</tr>
<tr>
 <td style="text-align: right;">
      2 : </td><td style="text-align: left;"> uniform </td>
</tr>
<tr>
 <td style="text-align: right;">
      3 : </td><td style="text-align: left;"> two-sided exponential</td>
</tr>

</table>

</td></tr>
<tr><td><code id="ngsmth_+3A_k">k</code></td>
<td>
<p>number of intervals in numerical integration.</p>
</td></tr>
<tr><td><code id="ngsmth_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), trend is plotted.</p>
</td></tr>
<tr><td><code id="ngsmth_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to <code><a href="#topic+plot.ngsmth">plot.ngsmth</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Consider a one-dimensional state space model
</p>
<p style="text-align: center;"><code class="reqn">x_n = x_{n-1} + v_n,</code>
</p>

<p style="text-align: center;"><code class="reqn">y_n = x_n + w_n,</code>
</p>

<p>where the observation noise <code class="reqn">w_n</code> is assumed to be Gaussian
distributed and the system noise <code class="reqn">v_n</code> is assumed to be distributed
as the Pearson system
</p>
<p style="text-align: center;"><code class="reqn">q(v_n) = c/(\tau^2 + v_n^2)^b</code>
</p>

<p>with <code class="reqn">\frac{1}{2} &lt; b &lt; \infty</code> and
<code class="reqn">c = \tau^{2b-1}\Gamma(b) \bigm/ \Gamma(\frac{1}{2})\Gamma(b-\frac{1}{2})</code>.
</p>
<p>This broad family of distributions includes the Cauchy distribution
(<code class="reqn">b = 1</code>) and <code class="reqn">t</code>-distribution (<code class="reqn">b = (k+1)/2</code>).
</p>


<h3>Value</h3>

<p>An object of class <code>"ngsmth"</code>, which is a list with the following
components:
</p>
<table role = "presentation">
<tr><td><code>llkhood</code></td>
<td>
<p>log-likelihood.</p>
</td></tr>
<tr><td><code>trend</code></td>
<td>
<p>trend.</p>
</td></tr>
<tr><td><code>smt</code></td>
<td>
<p>smoothed density.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>
<p>Kitagawa, G. and Gersch, W. (1996)
<em>Smoothness Priors Analysis of Time Series</em>. Lecture Notes in Statistics,
No.116, Springer-Verlag.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## test data
data(PfilterSample)
par(mar = c(3, 3, 1, 1) + 0.1)

# system noise density : Gaussian (normal)
s1 &lt;- ngsmth(PfilterSample, noisev = 1, tau2 = 1.4e-02, noisew = 1, sigma2 = 1.048)
s1
plot(s1, "smt", theta = 25, phi = 30, expand = 0.25, col = "white")

# system noise density : Pearson family
s2 &lt;- ngsmth(PfilterSample, noisev = 2, tau2 = 2.11e-10, bv = 0.6, noisew = 1,
             sigma2 = 1.042)
s2
plot(s2, "smt", theta = 25, phi = 30, expand = 0.25, col = "white")

## seismic data
data(MYE1F)
n &lt;- length(MYE1F)
yy &lt;- rep(0, n)
for (i in 2:n) yy[i] &lt;- MYE1F[i] - 0.5 * MYE1F[i-1]
m &lt;- seq(1, n, by = 2)
y &lt;- yy[m]
z &lt;- tvvar(y, trend.order = 2, tau2.ini = 4.909e-02, delta = 1.0e-06)

# system noise density : Gaussian (normal)
s3 &lt;- ngsmth(z$sm, noisev = 1, tau2 = z$tau2, noisew = 2, sigma2 = pi*pi/6,
             k = 190)
s3
plot(s3, "smt", phi = 50, expand = 0.5, col = 8)
</code></pre>

<hr>
<h2 id='Nikkei225'>Nikkei225</h2><span id='topic+Nikkei225'></span>

<h3>Description</h3>

<p>A daily closing values of the Japanese stock price index, Nikkei225, quoted from
January 4, 1988, to December 30, 1993.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Nikkei225)
</code></pre>


<h3>Format</h3>

<p>A time series of 1480 observations.
</p>


<h3>Source</h3>

<p><a href="https://indexes.nikkei.co.jp/nkave/archives/data">https://indexes.nikkei.co.jp/nkave/archives/data</a>
</p>

<hr>
<h2 id='NLmodel'>The Nonlinear State-Space Model Data</h2><span id='topic+NLmodel'></span>

<h3>Description</h3>

<p>The series generated by the nonlinear state-space model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(NLmodel)
</code></pre>


<h3>Format</h3>

<p>A matrix with 100 rows and 2 columns.
</p>

<table>
<tr>
 <td style="text-align: right;">
  [, 1] </td><td style="text-align: left;"> <code class="reqn">x_n</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
  [, 2] </td><td style="text-align: left;"> <code class="reqn">y_n</code>
</td>
</tr>

</table>



<h3>Details</h3>

<p>The system model <code class="reqn">x_n</code> and the observation model <code class="reqn">y_n</code> are
generated by following state-space model:
</p>
<p style="text-align: center;"><code class="reqn">x_n = \frac{1}{2} x_{n-1} + \frac{25x_{n-1}}{x_{n-1}^2+1} + 8cos(1.2n) + v_n</code>
</p>

<p style="text-align: center;"><code class="reqn">y_n = \frac{x_n^2}{10} + w_n,</code>
</p>

<p>where <code class="reqn">v_n</code> ~ <code class="reqn">N(0, 1)</code>, <code class="reqn">w_n</code> ~ <code class="reqn">N(0, 10)</code>,
<code class="reqn">v_0</code> ~ <code class="reqn">N(0, 5)</code>.
</p>

<hr>
<h2 id='pdfunc'>Probability Density Function</h2><span id='topic+pdfunc'></span>

<h3>Description</h3>

<p>Evaluate probability density function for normal distribution, Cauchy
distribution, Pearson distribution, exponential distribution, Chi-square
distributions, double exponential distribution and uniform distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pdfunc(model = "norm", mean = 0, sigma2 = 1, mu = 0, tau2 = 1, shape,
       lambda = 1, side = 1, df, xmin = 0, xmax = 1, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pdfunc_+3A_model">model</code></td>
<td>
<p>a character string indicating the model type of probability
density function: either <code>"norm"</code>, <code>"Cauchy"</code>, <code>"Pearson"</code>,
<code>"exp"</code>, <code>"Chi2"</code>, <code>"dexp"</code> or <code>"unif"</code>.</p>
</td></tr>
<tr><td><code id="pdfunc_+3A_mean">mean</code></td>
<td>
<p>mean. (valid for <code>"norm"</code>)</p>
</td></tr>
<tr><td><code id="pdfunc_+3A_sigma2">sigma2</code></td>
<td>
<p>variance. (valid for <code>"norm"</code>)</p>
</td></tr>
<tr><td><code id="pdfunc_+3A_mu">mu</code></td>
<td>
<p>location parameter <code class="reqn">\mu</code>. (valid for <code>"Cauchy"</code> and
<code>"Pearson"</code>)</p>
</td></tr>
<tr><td><code id="pdfunc_+3A_tau2">tau2</code></td>
<td>
<p>dispersion parameter <code class="reqn">\tau^2</code>. (valid for <code>"Cauchy"</code> and
<code>"Pearson"</code>)</p>
</td></tr>
<tr><td><code id="pdfunc_+3A_shape">shape</code></td>
<td>
<p>shape parameter (&gt; 0.5). (valid for <code>"Pearson"</code>)</p>
</td></tr>
<tr><td><code id="pdfunc_+3A_lambda">lambda</code></td>
<td>
<p>lambda <code class="reqn">\lambda</code>. (valid for <code>"exp"</code>)</p>
</td></tr>
<tr><td><code id="pdfunc_+3A_side">side</code></td>
<td>
<p>1: exponential, 2: two-sided exponential.
(valid for <code>"exp"</code>)</p>
</td></tr>
<tr><td><code id="pdfunc_+3A_df">df</code></td>
<td>
<p>degree of freedoms <code class="reqn">k</code>.  (valid for <code>"Chi2"</code>)</p>
</td></tr>
<tr><td><code id="pdfunc_+3A_xmin">xmin</code></td>
<td>
<p>lower bound of the interval.</p>
</td></tr>
<tr><td><code id="pdfunc_+3A_xmax">xmax</code></td>
<td>
<p>upper bound of the interval.</p>
</td></tr>
<tr><td><code id="pdfunc_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), probability density function is
plotted.</p>
</td></tr>
<tr><td><code id="pdfunc_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to the <code>plot</code> method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"pdfunc"</code> which has a <code>plot</code> method. This is a
list with the following components:
</p>
<table role = "presentation">
<tr><td><code>density</code></td>
<td>
<p>values of density function.</p>
</td></tr>
<tr><td><code>interval</code></td>
<td>
<p>lower and upper bound of interval.</p>
</td></tr>
<tr><td><code>param</code></td>
<td>
<p>parameters of model.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># normal distribution
pdfunc(model = "norm", xmin = -4, xmax = 4) 

# Cauchy distribution
pdfunc(model = "Cauchy", xmin = -4, xmax = 4) 

# Pearson distribution
pdfunc(model = "Pearson", shape = 2, xmin = -4, xmax = 4) 

# exponential distribution
pdfunc(model = "exp", xmin = 0, xmax = 8) 

pdfunc(model = "exp", xmin = -4, xmax = 4)

# Chi-square distribution
pdfunc(model = "Chi2", df = 3, xmin = 0, xmax = 8) 

# double exponential distribution
pdfunc(model = "dexp", xmin = -4, xmax = 2) 

# uniform distribution
pdfunc(model = "unif", xmin = 0, xmax = 1) 
</code></pre>

<hr>
<h2 id='period'>Compute a Periodogram</h2><span id='topic+period'></span>

<h3>Description</h3>

<p>Compute a periodogram of the univariate time series.</p>


<h3>Usage</h3>

<pre><code class='language-R'>period(y, window = 1, lag = NULL, minmax = c(-1.0e+30, 1.0e+30),
       plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="period_+3A_y">y</code></td>
<td>
<p>a univariate time series.</p>
</td></tr>
<tr><td><code id="period_+3A_window">window</code></td>
<td>
<p>smoothing window type. (0: box-car, 1: Hanning, 2: Hamming)</p>
</td></tr>
<tr><td><code id="period_+3A_lag">lag</code></td>
<td>
<p>maximum lag of autocovariance. If <code>NULL</code> (default), <br />
<code>window</code> = 0 : <code>lag</code> = <code class="reqn">n</code> - 1, <br />
<code>window</code> &gt; 0 : <code>lag</code> = 2 <code class="reqn">\sqrt{n}</code>, <br />
where <code class="reqn">n</code> is the length of data.</p>
</td></tr>
<tr><td><code id="period_+3A_minmax">minmax</code></td>
<td>
<p>bound for outliers in low side and high side.</p>
</td></tr>
<tr><td><code id="period_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), smoothed periodogram is plotted.</p>
</td></tr>
<tr><td><code id="period_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to <code><a href="#topic+plot.spg">plot.spg</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: right;">
    Hanning Window : </td><td style="text-align: left;"> <code class="reqn">W_0</code> = 0.5 </td><td style="text-align: left;"> <code class="reqn">W_1</code> = 0.25 </td>
</tr>
<tr>
 <td style="text-align: right;">
    Hamming Window : </td><td style="text-align: left;"> <code class="reqn">W_0</code> = 0.54 </td><td style="text-align: left;"> <code class="reqn">W_1</code> = 0.23</td>
</tr>

</table>



<h3>Value</h3>

<p>An object of class <code>"spg"</code>, which is a list with the following components:
</p>
<table role = "presentation">
<tr><td><code>period</code></td>
<td>
<p>periodogram(or raw spectrum).</p>
</td></tr>
<tr><td><code>smoothed.period</code></td>
<td>
<p>smoothed log-periodogram. Smoothed periodogram is given
if there is a negative value in the smoothed periodogram.</p>
</td></tr>
<tr><td><code>log.scale</code></td>
<td>
<p>if <code>TRUE</code> &quot;smooth the periodogram on log scale.</p>
</td></tr>
<tr><td><code>tsname</code></td>
<td>
<p>the name of the univariate time series <code>y</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## BLSALLFOOD data
data(BLSALLFOOD)
period(BLSALLFOOD)

## seismic Data
data(MYE1F)

# smoothed periodogram 
period(MYE1F)

# periodogram
period(MYE1F, window = 0)

# raw spectrum
period(MYE1F, window = 0, lag = 200)

# Hamming window
period(MYE1F, window = 2)
</code></pre>

<hr>
<h2 id='pfilter'>Particle Filtering and Smoothing</h2><span id='topic+pfilter'></span><span id='topic+plot.pfilter'></span>

<h3>Description</h3>

<p>Trend estimation by particle filter and smoother.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pfilter(y, m = 10000, model = 0, lag = 20, initd = 0, sigma2, tau2,
        alpha = 0.99, bigtau2 = NULL, init.sigma2 = 1, xrange = NULL,
        seed = NULL, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pfilter_+3A_y">y</code></td>
<td>
<p>univariate time series.</p>
</td></tr>
<tr><td><code id="pfilter_+3A_m">m</code></td>
<td>
<p>number of particles.</p>
</td></tr>
<tr><td><code id="pfilter_+3A_model">model</code></td>
<td>
<p>model for the system noise.
</p>

<table>
<tr>
 <td style="text-align: right;">
      0: </td><td style="text-align: left;"> normal distribution </td>
</tr>
<tr>
 <td style="text-align: right;">
      1: </td><td style="text-align: left;"> Cauchy distribution </td>
</tr>
<tr>
 <td style="text-align: right;">
      2: </td><td style="text-align: left;"> Gaussian mixture distribution </td>
</tr>
<tr>
 <td style="text-align: right;">
           </td><td style="text-align: left;"> <code class="reqn">\alpha</code> <code class="reqn">N</code>(0, <code class="reqn">\tau^2</code>) + (1 - <code class="reqn">\alpha</code>) <code class="reqn">N</code>(0, <code class="reqn">T^2</code>), </td>
</tr>
<tr>
 <td style="text-align: right;">
           </td><td style="text-align: left;"> where <code class="reqn">N</code> is the normal density.</td>
</tr>

</table>
</td></tr>
<tr><td><code id="pfilter_+3A_lag">lag</code></td>
<td>
<p>lag length for fixed-lag smoothing.</p>
</td></tr>
<tr><td><code id="pfilter_+3A_initd">initd</code></td>
<td>
<p>type of initial state distribution.
</p>

<table>
<tr>
 <td style="text-align: right;">
      0: </td><td style="text-align: left;"> normal distribution </td>
</tr>
<tr>
 <td style="text-align: right;">
      1: </td><td style="text-align: left;"> uniform distribution </td>
</tr>
<tr>
 <td style="text-align: right;">
      2: </td><td style="text-align: left;"> Cauchy distribution </td>
</tr>
<tr>
 <td style="text-align: right;">
      3: </td><td style="text-align: left;"> fixed point (default value = 0)</td>
</tr>

</table>
</td></tr>
<tr><td><code id="pfilter_+3A_sigma2">sigma2</code></td>
<td>
<p>observation noise variance <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code id="pfilter_+3A_tau2">tau2</code></td>
<td>
<p>system noise variance <code class="reqn">\tau^2</code> for <code>model</code> = 0 or dispersion parameter
for <code>model</code> = 1.</p>
</td></tr>
<tr><td><code id="pfilter_+3A_alpha">alpha</code></td>
<td>
<p>mixture weight <code class="reqn">\alpha</code>. (valid for <code>model</code> = 2)</p>
</td></tr>
<tr><td><code id="pfilter_+3A_bigtau2">bigtau2</code></td>
<td>
<p>variance of the second component <code class="reqn">T^2</code>. (valid for <code>model</code> = 2)</p>
</td></tr>
<tr><td><code id="pfilter_+3A_init.sigma2">init.sigma2</code></td>
<td>
<p>variance for <code>initd</code> = 0 or dispersion parameter of
initial state distribution for <code>initd</code> = 2.</p>
</td></tr>
<tr><td><code id="pfilter_+3A_xrange">xrange</code></td>
<td>
<p>specify the lower and upper bounds of the distribution's range.</p>
</td></tr> 
<tr><td><code id="pfilter_+3A_seed">seed</code></td>
<td>
<p>arbitrary positive integer to generate a sequence of uniform
random numbers. The default seed is based on the current time.</p>
</td></tr>
<tr><td><code id="pfilter_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), marginal smoothed distribution
is plotted.</p>
</td></tr>
<tr><td><code id="pfilter_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to the <code>plot</code> method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs particle filtering and smoothing for the first order trend model;
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code class="reqn">x_n = x_{n-1} + v_n,</code> </td><td style="text-align: left;"> (system model) </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    <code class="reqn">y_n = x_n + w_n,</code> </td><td style="text-align: left;"> (observation model)</td>
</tr>

</table>
 
<p>where <code class="reqn">y_n</code> is a time series, <code class="reqn">x_n</code> is the state vector.
The system noise <code class="reqn">v_n</code> and the observation noise <code class="reqn">w_n</code> are assumed to be white noises
which follow a Gaussian distribution or a Cauchy distribution, and non-Gaussian distribution, respectively.
</p>
<p>The algorithm of the particle filter and smoother are presented in Kitagawa (2020).
For more details, please refer to Kitagawa (1996) and Doucet et al. (2001).
</p>


<h3>Value</h3>

<p>An object of class <code>"pfilter"</code> which has a <code>plot</code> method. This is a
list with the following components:
</p>
<table role = "presentation">
<tr><td><code>llkhood</code></td>
<td>
<p>log-likelihood.</p>
</td></tr>
<tr><td><code>smooth.dist</code></td>
<td>
<p>marginal smoothed distribution of the trend <code class="reqn">T(i,j)</code> 
<code class="reqn">(i = 1,...,n, j = 1,...,7)</code>, where <code class="reqn">n</code> is the length of <code>y</code>.
</p>

<table>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> j = 4: </td><td style="text-align: left;"> 50% point </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> j = 3, 5: </td><td style="text-align: left;"> 1-sigma points (15.87% and 84.14% points) </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> j = 2, 6: </td><td style="text-align: left;"> 2-sigma points (2.27% and 97.73% points) </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> j = 1, 7: </td><td style="text-align: left;"> 3-sigma points (0.13% and 99.87% points)</td>
</tr>

</table>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (1996)
<em>Monte Carlo filter and smoother for non-Gaussian nonlinear state space models</em>,
J. of Comp. and Graph. Statist., 5, 1-25.
</p>
<p>Doucet, A., de Freitas, N. and Gordon, N. (2001)
<em>Sequential Monte Carlo Methods in Practice</em>, Springer, New York.
</p>
<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>. Chapman &amp; Hall/CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pfilterNL">pfilterNL</a></code> performs particle filtering and smoothing for nonlinear
non-Gaussian state-space model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PfilterSample)
y &lt;- PfilterSample

## Not run: 
pfilter(y, m = 100000, model = 0, lag = 20, initd = 0, sigma2 = 1.048,
        tau2 = 1.4e-2, xrange = c(-4, 4), seed = 2019071117)

pfilter(y, m = 100000, model = 1, lag = 20 , initd = 0, sigma2 = 1.045,
        tau2 = 3.53e-5, xrange = c(-4, 4), seed = 2019071117)

pfilter(y, m = 100000, model = 2, lag = 20 , initd = 0, sigma2 = 1.03,
        tau2 = 0.00013, alpha = 0.991, xrange = c(-4, 4), seed = 2019071117)

## End(Not run)
</code></pre>

<hr>
<h2 id='pfilterNL'>Particle Filtering and Smoothing for Nonlinear State-Space Model</h2><span id='topic+pfilterNL'></span>

<h3>Description</h3>

<p>Trend estimation by particle filter and smoother via nonlinear state-space model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pfilterNL(y, m = 10000, lag = 20, sigma2, tau2, xrange = NULL, seed = NULL,
          plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pfilterNL_+3A_y">y</code></td>
<td>
<p>univariate time series.</p>
</td></tr>
<tr><td><code id="pfilterNL_+3A_m">m</code></td>
<td>
<p>number of particles.</p>
</td></tr>
<tr><td><code id="pfilterNL_+3A_lag">lag</code></td>
<td>
<p>lag length for fixed-lag smoothing.</p>
</td></tr>
<tr><td><code id="pfilterNL_+3A_sigma2">sigma2</code></td>
<td>
<p>observation noise variance.</p>
</td></tr>
<tr><td><code id="pfilterNL_+3A_tau2">tau2</code></td>
<td>
<p>system noise variance.</p>
</td></tr>
<tr><td><code id="pfilterNL_+3A_xrange">xrange</code></td>
<td>
<p>specify the lower and upper bounds of the distribution's range.</p>
</td></tr> 
<tr><td><code id="pfilterNL_+3A_seed">seed</code></td>
<td>
<p>arbitrary positive integer to generate a sequence of uniform
random numbers. The default seed is based on the current time.</p>
</td></tr>
<tr><td><code id="pfilterNL_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), marginal smoothed distribution
is plotted.</p>
</td></tr>
<tr><td><code id="pfilterNL_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to the <code>plot</code> method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs particle filtering and smoothing for the following nonlinear state-space model;
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code class="reqn">x_n = \frac{1}{2} x_{n-1} + \frac{25 x_{n-1}}{x_{n-1}^2 + 1} + 8cos(1.2n) + v_n,</code> </td><td style="text-align: left;"> (system model) </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code class="reqn">y_n = \frac{x_n^2}{10} + w_n,</code> </td><td style="text-align: left;"> (observation model)
  </td>
</tr>

</table>

<p>where <code class="reqn">y_n</code> is a time series, <code class="reqn">x_n</code> is the state vector.
The system noise <code class="reqn">v_n</code> and the observation noise <code class="reqn">w_n</code> are assumed to be white noises
which follow a Gaussian distribution and <code class="reqn">v_0</code> ~ <code class="reqn">N(0, 5)</code>.
</p>
<p>The algorithm of the particle filtering and smoothing are presented in Kitagawa (2020).
For more details, please refer to Kitagawa (1996) and Doucet et al. (2001).
</p>


<h3>Value</h3>

<p>An object of class <code>"pfilter"</code> which has a <code>plot</code> method. This is a
list with the following components:
</p>
<table role = "presentation">
<tr><td><code>llkhood</code></td>
<td>
<p>log-likelihood.</p>
</td></tr>
<tr><td><code>smooth.dist</code></td>
<td>
<p>marginal smoothed distribution of the trend <code class="reqn">T(i,j)</code> 
<code class="reqn">(i = 1,...,n, j = 1,...,7)</code>, where <code class="reqn">n</code> is the length of <code>y</code>.
</p>

<table>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> j = 4: </td><td style="text-align: left;"> 50% point </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> j = 3, 5: </td><td style="text-align: left;"> 1-sigma points (15.87% and 84.14% points) </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> j = 2, 6: </td><td style="text-align: left;"> 2-sigma points (2.27% and 97.73% points) </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> j = 1, 7: </td><td style="text-align: left;"> 3-sigma points (0.13% and 99.87% points)</td>
</tr>

</table>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (1996)
<em>Monte Carlo filter and smoother for non-Gaussian nonlinear state space models</em>,
J. of Comp. and Graph. Statist., 5, 1-25.
</p>
<p>Doucet, A., de Freitas, N. and Gordon, N. (2001)
<em>Sequential Monte Carlo Methods in Practice</em>, Springer, New York.
</p>
<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>. Chapman &amp; Hall/CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pfilter">pfilter</a></code> performs particle filtering and smoothing for linear
non-Gaussian state-space model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(NLmodel)
x &lt;- NLmodel[, 2]
pfilterNL(x, m = 100000, lag = 20 , sigma2 = 10.0, tau2 = 1.0,
          xrange = c(-20, 20), seed = 2019071117)
</code></pre>

<hr>
<h2 id='PfilterSample'>Sample Data for Particle Filter and Smoother</h2><span id='topic+PfilterSample'></span>

<h3>Description</h3>

<p>An artificially generated sample data with shifting mean value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PfilterSample)
</code></pre>


<h3>Format</h3>

<p>A time series of 400 observations.
</p>


<h3>Details</h3>

<p>This data generated by the following models;
</p>

<table>
<tr>
 <td style="text-align: right;">
    <code class="reqn">y_n</code> ~ <code class="reqn">N(\mu_n, 1)</code>, </td><td style="text-align: right;"> <code class="reqn">\mu_n</code> </td><td style="text-align: left;">  = 0, </td><td style="text-align: right;"> 1 &lt;= n &lt;= 100 </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: right;"> </td><td style="text-align: left;">  = 1, </td><td style="text-align: right;"> 101 &lt;= n &lt;= 200 </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: right;"> </td><td style="text-align: left;">  = -1, </td><td style="text-align: right;"> 201 &lt;= n &lt;= 300 </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: right;"> </td><td style="text-align: left;">  = 0, </td><td style="text-align: right;"> 301 &lt;= n &lt;= 400 
  </td>
</tr>

</table>


<hr>
<h2 id='plot.boxcox'>Plot Box-Cox Transformed Data</h2><span id='topic+plot.boxcox'></span>

<h3>Description</h3>

<p>Plot original data and transformed data with minimum AIC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'boxcox'
plot(x, rdata = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.boxcox_+3A_x">x</code></td>
<td>
<p>an object of class <code>"boxcox"</code>.</p>
</td></tr>
<tr><td><code id="plot.boxcox_+3A_rdata">rdata</code></td>
<td>
<p>original data, if necessary.</p>
</td></tr>
<tr><td><code id="plot.boxcox_+3A_...">...</code></td>
<td>
<p>further graphical parameters may also be supplied as arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.lsqr'>Plot Fitted Trigonometric Polynomial</h2><span id='topic+plot.lsqr'></span>

<h3>Description</h3>

<p>Plot original data and fitted trigonometric polynomial returned by
<code><a href="#topic+lsqr">lsqr</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lsqr'
plot(x, rdata = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.lsqr_+3A_x">x</code></td>
<td>
<p>an object of class <code>"lsqr"</code>.</p>
</td></tr>
<tr><td><code id="plot.lsqr_+3A_rdata">rdata</code></td>
<td>
<p>original data, if necessary.</p>
</td></tr>
<tr><td><code id="plot.lsqr_+3A_...">...</code></td>
<td>
<p>further graphical parameters may also be supplied as arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.ngsmth'>Plot Smoothed Density Function</h2><span id='topic+plot.ngsmth'></span>

<h3>Description</h3>

<p>Plot the smoothed density function returned by <code><a href="#topic+ngsmth">ngsmth</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ngsmth'
plot(x, type = c("trend", "smt"), theta = 0, phi = 15,
          expand = 1, col = "lightblue", ticktype= "detail", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.ngsmth_+3A_x">x</code></td>
<td>
<p>an object of class <code>"ngsmth"</code>.</p>
</td></tr>
<tr><td><code id="plot.ngsmth_+3A_type">type</code></td>
<td>
<p>plotted values, either or both of &quot;trend&quot; and &quot;smt&quot;.</p>
</td></tr>
<tr><td><code id="plot.ngsmth_+3A_theta">theta</code>, <code id="plot.ngsmth_+3A_phi">phi</code>, <code id="plot.ngsmth_+3A_expand">expand</code>, <code id="plot.ngsmth_+3A_col">col</code>, <code id="plot.ngsmth_+3A_ticktype">ticktype</code></td>
<td>
<p>graphical parameters in perspective
plot <code><a href="graphics.html#topic+persp">persp</a></code>.</p>
</td></tr>
<tr><td><code id="plot.ngsmth_+3A_...">...</code></td>
<td>
<p>further graphical parameters may also be supplied as arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.polreg'>Plot Fitted Polynomial Trend</h2><span id='topic+plot.polreg'></span>

<h3>Description</h3>

<p>Plot trend component of fitted polynomial returned by <code><a href="#topic+polreg">polreg</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'polreg'
plot(x, rdata = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.polreg_+3A_x">x</code></td>
<td>
<p>an object of class <code>"polreg"</code>.</p>
</td></tr>
<tr><td><code id="plot.polreg_+3A_rdata">rdata</code></td>
<td>
<p>original data, if necessary.</p>
</td></tr>
<tr><td><code id="plot.polreg_+3A_...">...</code></td>
<td>
<p>further graphical parameters may also be supplied as arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.season'>Plot Trend, Seasonal and AR Components</h2><span id='topic+plot.season'></span>

<h3>Description</h3>

<p>Plot trend component, seasonal component, AR component and noise returned by
<code><a href="#topic+season">season</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'season'
plot(x, rdata = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.season_+3A_x">x</code></td>
<td>
<p>an object of class <code>"season"</code>.</p>
</td></tr>
<tr><td><code id="plot.season_+3A_rdata">rdata</code></td>
<td>
<p>original data, if necessary.</p>
</td></tr>
<tr><td><code id="plot.season_+3A_...">...</code></td>
<td>
<p>further graphical parameters may also be supplied as arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.simulate'>Plot Simulated Data Generated by State Space Model</h2><span id='topic+plot.simulate'></span>

<h3>Description</h3>

<p>Plot simulated data of Gaussian / non-Gaussian generated by state space model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simulate'
plot(x, use = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.simulate_+3A_x">x</code></td>
<td>
<p>an object of class <code>"simulate"</code> as returned by 
<code><a href="#topic+simssm">simssm</a></code> and <code><a href="#topic+ngsim">ngsim</a></code>.</p>
</td></tr>
<tr><td><code id="plot.simulate_+3A_use">use</code></td>
<td>
<p>start and end time <code>c(x1, x2)</code> to be plotted actually.</p>
</td></tr>
<tr><td><code id="plot.simulate_+3A_...">...</code></td>
<td>
<p>further graphical parameters may also be supplied as arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.smooth'>Plot Posterior Distribution of Smoother</h2><span id='topic+plot.smooth'></span>

<h3>Description</h3>

<p>Plot posterior distribution (mean and standard deviations) of the smoother returned by
<code><a href="#topic+tsmooth">tsmooth</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'smooth'
plot(x, rdata = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.smooth_+3A_x">x</code></td>
<td>
<p>an object of class <code>"smooth"</code>.</p>
</td></tr>
<tr><td><code id="plot.smooth_+3A_rdata">rdata</code></td>
<td>
<p>original data, if necessary.</p>
</td></tr>
<tr><td><code id="plot.smooth_+3A_...">...</code></td>
<td>
<p>further graphical parameters may also be supplied as arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.spg'>Plot Smoothed Periodogram</h2><span id='topic+plot.spg'></span>

<h3>Description</h3>

<p>Plot smoothed periodogram or logarithm of smoothed periodogram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spg'
plot(x, type = "vl", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.spg_+3A_x">x</code></td>
<td>
<p>an object of class <code>"spg"</code> as returned by <code><a href="#topic+period">period</a></code> 
and <code><a href="#topic+fftper">fftper</a></code>.</p>
</td></tr>
<tr><td><code id="plot.spg_+3A_type">type</code></td>
<td>
<p>type of plot. (&quot;l&quot;: lines, &quot;vl&quot; : vertical lines)</p>
</td></tr>
<tr><td><code id="plot.spg_+3A_...">...</code></td>
<td>
<p>further graphical parameters may also be supplied as arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.trend'>Plot Trend and Residuals</h2><span id='topic+plot.trend'></span>

<h3>Description</h3>

<p>Plot trend component and residuals returned by <code><a href="#topic+trend">trend</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'trend'
plot(x, rdata = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.trend_+3A_x">x</code></td>
<td>
<p>an object of class <code>"trend"</code>.</p>
</td></tr>
<tr><td><code id="plot.trend_+3A_rdata">rdata</code></td>
<td>
<p>original data, if necessary.</p>
</td></tr>
<tr><td><code id="plot.trend_+3A_...">...</code></td>
<td>
<p>further graphical parameters may also be supplied as arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.tvspc'>Plot Evolutionary Power Spectra Obtained by Time Varying AR Model</h2><span id='topic+plot.tvspc'></span>

<h3>Description</h3>

<p>Plot evolutionary power spectra obtained by time varying AR model returned
by <code><a href="#topic+tvspc">tvspc</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tvspc'
plot(x, tvv = NULL, dx = 2, dy = 0.25, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.tvspc_+3A_x">x</code></td>
<td>
<p>an object of class <code>"tvspc"</code>.</p>
</td></tr>
<tr><td><code id="plot.tvspc_+3A_tvv">tvv</code></td>
<td>
<p>time varying variance as returned by <code><a href="#topic+tvvar">tvvar</a></code>.</p>
</td></tr>
<tr><td><code id="plot.tvspc_+3A_dx">dx</code></td>
<td>
<p>step width for the X axis.</p>
</td></tr>
<tr><td><code id="plot.tvspc_+3A_dy">dy</code></td>
<td>
<p>step width for the Y axis.</p>
</td></tr>
<tr><td><code id="plot.tvspc_+3A_...">...</code></td>
<td>
<p>further graphical parameters may also be supplied as arguments.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># seismic data
data(MYE1F)
v &lt;- tvvar(MYE1F, trend.order = 2, tau2.ini = 6.6e-06, delta = 1.0e-06,
           plot = FALSE )

z &lt;- tvar(v$nordata, trend.order = 2, ar.order = 8, span = 20,
          outlier = c(630, 1026), tau2.ini = 6.6e-06, delta = 1.0e-06,
          plot = FALSE)

spec &lt;- tvspc(z$arcoef, z$sigma2, span = 20, nf = 400)
plot(spec, tvv = v$tvv, dx = 2, dy = 0.10)
</code></pre>

<hr>
<h2 id='polreg'>Polynomial Regression Model</h2><span id='topic+polreg'></span>

<h3>Description</h3>

<p>Estimate the trend using the AIC best polynomial regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>polreg(y, order, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="polreg_+3A_y">y</code></td>
<td>
<p>a univariate time series.</p>
</td></tr>
<tr><td><code id="polreg_+3A_order">order</code></td>
<td>
<p>maximum order of polynomial regression.</p>
</td></tr>
<tr><td><code id="polreg_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), original data and trend
component are plotted.</p>
</td></tr>
<tr><td><code id="polreg_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to <code><a href="#topic+plot.polreg">plot.polreg</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"polreg"</code>, which is a list with the following
components:
</p>
<table role = "presentation">
<tr><td><code>order.maice</code></td>
<td>
<p>MAICE (minimum AIC estimate) order.</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>residual variance of the model with order <code class="reqn">M</code>.
(<code class="reqn">0 \leq M \leq</code> <code>order</code>)</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>AIC of the model with order <code class="reqn">M</code>.
(<code class="reqn">0 \leq M \leq</code> <code>order</code>)</p>
</td></tr>
<tr><td><code>daic</code></td>
<td>
<p>AIC - minimum AIC.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>regression coefficients <code class="reqn">A(I,M)</code> with order <code class="reqn">M</code>.
</p>
<p>(<code class="reqn">1 \leq M \leq</code> <code>order</code>,
<code class="reqn">1 \leq I \leq M</code>)</p>
</td></tr>
<tr><td><code>trend</code></td>
<td>
<p>trend component.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The daily maximum temperatures for Tokyo
data(Temperature)
polreg(Temperature, order = 7)

# Wholesale hardware data
data(WHARD)
y &lt;- log10(WHARD)
polreg(y, order = 15)
</code></pre>

<hr>
<h2 id='Rainfall'>Rainfall Data</h2><span id='topic+Rainfall'></span>

<h3>Description</h3>

<p>Number of rainy days in two years (1975-1976) at Tokyo, Japan.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Rainfall)
</code></pre>


<h3>Format</h3>

<p>Integer-valued time series of 366 observations.
</p>


<h3>Source</h3>

<p>The data were obtained from Tokyo District Meteorological Observatory.
<a href="https://www.data.jma.go.jp/obd/stats/etrn/">https://www.data.jma.go.jp/obd/stats/etrn/</a>
</p>

<hr>
<h2 id='season'>Seasonal Adjustment</h2><span id='topic+season'></span>

<h3>Description</h3>

<p>Seasonal adjustment by state space modeling. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>season(y, trend.order = 1, seasonal.order = 1, ar.order = 0, trade = FALSE,
       period = NULL, tau2.ini = NULL, filter = c(1, length(y)),
       predict = length(y), arcoef.ini = NULL, log = FALSE, log.base = "e",
       minmax = c(-1.0e+30, 1.0e+30), plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="season_+3A_y">y</code></td>
<td>
<p>a univariate time series with or without the tsp attribute.</p>
</td></tr>
<tr><td><code id="season_+3A_trend.order">trend.order</code></td>
<td>
<p>trend order (0, 1, 2 or 3).</p>
</td></tr>
<tr><td><code id="season_+3A_seasonal.order">seasonal.order</code></td>
<td>
<p>seasonal order (0, 1 or 2).</p>
</td></tr>
<tr><td><code id="season_+3A_ar.order">ar.order</code></td>
<td>
<p>AR order (0, 1, 2, 3, 4 or 5).</p>
</td></tr>
<tr><td><code id="season_+3A_trade">trade</code></td>
<td>
<p>logical; if <code>TRUE</code>, the model including trading day effect
component is considered.</p>
</td></tr>
<tr><td><code id="season_+3A_period">period</code></td>
<td>
<p>If the tsp attribute of <code>y</code> is <code>NULL</code>, valid number of
seasons in one period in the case that <code>seasonal.order</code> &gt; 0 
and/or <code>trade</code> = <code>TRUE</code>.
</p>

<table>
<tr>
 <td style="text-align: right;">
      4 : </td><td style="text-align: left;"> quarterly data</td>
</tr>
<tr>
 <td style="text-align: right;">
      12 : </td><td style="text-align: left;"> monthly data</td>
</tr>
<tr>
 <td style="text-align: right;">
      5 : </td><td style="text-align: left;"> daily data (5 days a week)</td>
</tr>
<tr>
 <td style="text-align: right;">
      7 : </td><td style="text-align: left;"> daily data (7 days a week)</td>
</tr>
<tr>
 <td style="text-align: right;">
      24 : </td><td style="text-align: left;"> hourly data
    </td>
</tr>

</table>
</td></tr>
<tr><td><code id="season_+3A_tau2.ini">tau2.ini</code></td>
<td>
<p>initial estimate of variance of the system noise <code class="reqn">\tau^2</code> 
less than 1.</p>
</td></tr>
<tr><td><code id="season_+3A_filter">filter</code></td>
<td>
<p>a numerical vector of the form <code>c(x1,x2)</code> which gives start
and end position of filtering.</p>
</td></tr>
<tr><td><code id="season_+3A_predict">predict</code></td>
<td>
<p>the end position of prediction (<code class="reqn">\geq</code> <code>x2</code>).</p>
</td></tr>
<tr><td><code id="season_+3A_arcoef.ini">arcoef.ini</code></td>
<td>
<p>initial estimate of AR coefficients (for <code>ar.order</code> &gt;
0).</p>
</td></tr>
<tr><td><code id="season_+3A_log">log</code></td>
<td>
<p>logical. If <code>TRUE</code>, the data <code>y</code> is log-transformed.</p>
</td></tr>
<tr><td><code id="season_+3A_log.base">log.base</code></td>
<td>
<p>the letter &quot;e&quot; (default) or &quot;10&quot; specifying the base of
logarithmic transformation. Valid only if log = TRUE.</p>
</td></tr>
<tr><td><code id="season_+3A_minmax">minmax</code></td>
<td>
<p>lower and upper limits of observations.</p>
</td></tr>
<tr><td><code id="season_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), trend, seasonal, AR and noise 
components are plotted.</p>
</td></tr>
<tr><td><code id="season_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to <code><a href="#topic+plot.season">plot.season</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"season"</code>, which is a list with the following
components:
</p>
<table role = "presentation">
<tr><td><code>tau2</code></td>
<td>
<p>variance of the system noise.</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>variance of the observational noise.</p>
</td></tr>
<tr><td><code>llkhood</code></td>
<td>
<p>log-likelihood of the model.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>AIC of the model.</p>
</td></tr>
<tr><td><code>trend</code></td>
<td>
<p>trend component (for <code>trend.order</code> &gt; 0).</p>
</td></tr>
<tr><td><code>seasonal</code></td>
<td>
<p>seasonal component (for <code>seasonal.order</code> &gt; 0).</p>
</td></tr>
<tr><td><code>arcoef</code></td>
<td>
<p>AR coefficients (for <code>ar.order</code> &gt; 0).</p>
</td></tr>
<tr><td><code>ar</code></td>
<td>
<p>AR component (for <code>ar.order</code> &gt; 0).</p>
</td></tr>
<tr><td><code>day.effect</code></td>
<td>
<p>trading day effect (for <code>trade</code> = <code>TRUE</code>).</p>
</td></tr>
<tr><td><code>noise</code></td>
<td>
<p>noise component.</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p>covariance matrix of smoother.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>For time series with the tsp attribute, set <code>frequency</code> to
<code>period</code>.
</p>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># BLSALLFOOD data
data(BLSALLFOOD)
season(BLSALLFOOD, trend.order = 2, seasonal.order = 1, ar.order = 2)

season(BLSALLFOOD, trend.order = 2, seasonal.order = 1, ar.order = 2,
       filter = c(1, 132))

# Wholesale hardware data
data(WHARD)
season(WHARD, trend.order = 2, seasonal.order = 1, ar.order = 0, trade = TRUE,
       log = TRUE)

season(WHARD, trend.order = 2, seasonal.order = 1, ar.order = 0, trade = TRUE,
       filter = c(1, 132), log = TRUE)
</code></pre>

<hr>
<h2 id='simssm'>Simulation by Gaussian State Space Model</h2><span id='topic+simssm'></span>

<h3>Description</h3>

<p>Simulate time series by Gaussian State Space Model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simssm(n = 200, trend = NULL, seasonal.order = 0, seasonal = NULL,
       arcoef = NULL,  ar = NULL, tau1 = NULL, tau2 = NULL, tau3 = NULL,
       sigma2 = 1.0, seed = NULL, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simssm_+3A_n">n</code></td>
<td>
<p>the number of data generated by simulation.</p>
</td></tr>
<tr><td><code id="simssm_+3A_trend">trend</code></td>
<td>
<p>initial values of trend component of length <code class="reqn">m1</code>, where
<code class="reqn">m1</code> is trend order (1, 2). If <code>NULL</code> (default), trend order is 0.</p>
</td></tr>
<tr><td><code id="simssm_+3A_seasonal.order">seasonal.order</code></td>
<td>
<p>order of seasonal component model (0, 1, 2).</p>
</td></tr> 
<tr><td><code id="simssm_+3A_seasonal">seasonal</code></td>
<td>
<p>if <code>seasonal.order</code> &gt; 0, initial values of seasonal component
of length <code class="reqn">p-1</code>, where <code class="reqn">p</code> is period of one season.</p>
</td></tr>
<tr><td><code id="simssm_+3A_arcoef">arcoef</code></td>
<td>
<p>AR coefficients.</p>
</td></tr> 
<tr><td><code id="simssm_+3A_ar">ar</code></td>
<td>
<p>initial values of AR component.</p>
</td></tr>
<tr><td><code id="simssm_+3A_tau1">tau1</code></td>
<td>
<p>variance of trend component model.</p>
</td></tr>
<tr><td><code id="simssm_+3A_tau2">tau2</code></td>
<td>
<p>variance of AR component model.</p>
</td></tr>
<tr><td><code id="simssm_+3A_tau3">tau3</code></td>
<td>
<p>variance of seasonal component model.</p>
</td></tr>
<tr><td><code id="simssm_+3A_sigma2">sigma2</code></td>
<td>
<p>variance of the observation noise.</p>
</td></tr>
<tr><td><code id="simssm_+3A_seed">seed</code></td>
<td>
<p>arbitrary positive integer to generate a sequence of uniform
random numbers. The default seed is based on the current time.</p>
</td></tr>
<tr><td><code id="simssm_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), simulated data are plotted.</p>
</td></tr>
<tr><td><code id="simssm_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to <code><a href="#topic+plot.simulate">plot.simulate</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"simulate"</code>, giving simulated data of Gaussian state
space model.
</p>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># BLSALLFOOD data
data(BLSALLFOOD)
m1 &lt;- 2; m2 &lt;- 1; m3 &lt;- 2
z &lt;- season(BLSALLFOOD, trend.order = m1, seasonal.order = m2, ar.order = m3)

nl &lt;- length(BLSALLFOOD)
trend &lt;- z$trend[m1:1]
arcoef &lt;- z$arcoef
period &lt;- 12
seasonal &lt;- z$seasonal[(period-1):1]
ar &lt;- z$ar[m3:1]
tau1 &lt;- z$tau2[1]
tau2 &lt;- z$tau2[2]
tau3 &lt;- z$tau2[3]
simssm(n = nl, trend, seasonal.order = m2, seasonal, arcoef, ar, tau1, tau2, tau3,
        sigma2 = z$sigma2, seed = 333)
</code></pre>

<hr>
<h2 id='Sunspot'>Sunspot Number Data</h2><span id='topic+Sunspot'></span>

<h3>Description</h3>

<p>Yearly numbers of sunspots from to 1749 to 1979.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Sunspot)
</code></pre>


<h3>Format</h3>

<p>A time series of 231 observations; yearly from 1749 to 1979.
</p>


<h3>Details</h3>

<p>Sunspot is a part of the dataset <code><a href="datasets.html#topic+sunspot.year">sunspot.year</a></code> from 1700 to 1988.
Value &quot;0&quot; is converted into &quot;0.1&quot; for log transformation.
</p>

<hr>
<h2 id='Temperature'>Temperatures Data</h2><span id='topic+Temperature'></span>

<h3>Description</h3>

<p>The daily maximum temperatures in Tokyo (from 1979-01-01 to 1980-04-30).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Temperature)
</code></pre>


<h3>Format</h3>

<p>A time series of 486 observations.
</p>


<h3>Source</h3>

<p>The data were obtained from Tokyo District Meteorological Observatory.
<a href="https://www.data.jma.go.jp/obd/stats/etrn/">https://www.data.jma.go.jp/obd/stats/etrn/</a>
</p>

<hr>
<h2 id='trend'>Trend Estimation</h2><span id='topic+trend'></span>

<h3>Description</h3>

<p>Estimate the trend by state space model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trend(y, trend.order = 1, tau2.ini = NULL, delta, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trend_+3A_y">y</code></td>
<td>
<p>a univariate time series.</p>
</td></tr>
<tr><td><code id="trend_+3A_trend.order">trend.order</code></td>
<td>
<p>trend order.</p>
</td></tr>
<tr><td><code id="trend_+3A_tau2.ini">tau2.ini</code></td>
<td>
<p>initial estimate of variance of the system noise <code class="reqn">\tau^2</code>.
If <code>tau2.ini</code> = <code>NULL</code>, the most suitable value is chosen in
<code class="reqn">\tau^2 = 2^{-k}</code>.</p>
</td></tr>
<tr><td><code id="trend_+3A_delta">delta</code></td>
<td>
<p>search width (for <code>tau2.ini</code> is specified (not <code>NULL</code>))
.</p>
</td></tr>
<tr><td><code id="trend_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), trend component and residuals
are plotted.</p>
</td></tr>
<tr><td><code id="trend_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to <code><a href="#topic+plot.trend">plot.trend</a></code>.</p>
</td></tr></table>


<h3>Details</h3>

<p>The trend model can be represented by a state space model
</p>
<p style="text-align: center;"><code class="reqn">x_n = Fx_{n-1} + Gv_n,</code>
</p>

<p style="text-align: center;"><code class="reqn">y_n = Hx_n + w_n,</code>
</p>

<p>where <code class="reqn">F</code>, <code class="reqn">G</code> and <code class="reqn">H</code> are matrices with appropriate dimensions.
We assume that <code class="reqn">v_n</code> and <code class="reqn">w_n</code> are white noises that have
the normal distributions <code class="reqn">N(0,\tau^2)</code> and <code class="reqn">N(0, \sigma^2)</code>,
respectively.
</p>


<h3>Value</h3>

<p>An object of class <code>"trend"</code>, which is a list with the following
components:
</p>
<table role = "presentation">
<tr><td><code>trend</code></td>
<td>
<p>trend component.</p>
</td></tr>
<tr><td><code>residual</code></td>
<td>
<p>residuals.</p>
</td></tr>
<tr><td><code>tau2</code></td>
<td>
<p>variance of the system noise <code class="reqn">\tau^2</code>.</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>variance of the observational noise <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code>llkhood</code></td>
<td>
<p>log-likelihood of the model.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>AIC.</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p>covariance matrix of smoother.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The daily maximum temperatures for Tokyo
data(Temperature)
trend(Temperature, trend.order = 1, tau2.ini = 0.223, delta = 0.001)

trend(Temperature, trend.order = 2)
</code></pre>

<hr>
<h2 id='tsmooth'>Prediction and Interpolation of Time Series</h2><span id='topic+tsmooth'></span>

<h3>Description</h3>

<p>Predict and interpolate time series based on state space model by Kalman filter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tsmooth(y, f, g, h, q, r, x0 = NULL, v0 = NULL, filter.end = NULL,
        predict.end = NULL, minmax = c(-1.0e+30, 1.0e+30), missed = NULL,
        np = NULL, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tsmooth_+3A_y">y</code></td>
<td>
<p>a univariate time series <code class="reqn">y_n</code>.</p>
</td></tr>
<tr><td><code id="tsmooth_+3A_f">f</code></td>
<td>
<p>state transition matrix <code class="reqn">F_n</code>.</p>
</td></tr>
<tr><td><code id="tsmooth_+3A_g">g</code></td>
<td>
<p>matrix <code class="reqn">G_n</code>.</p>
</td></tr>
<tr><td><code id="tsmooth_+3A_h">h</code></td>
<td>
<p>matrix <code class="reqn">H_n</code>.</p>
</td></tr>
<tr><td><code id="tsmooth_+3A_q">q</code></td>
<td>
<p>system noise variance <code class="reqn">Q_n</code>.</p>
</td></tr>
<tr><td><code id="tsmooth_+3A_r">r</code></td>
<td>
<p>observational noise variance <code class="reqn">R</code>.</p>
</td></tr>
<tr><td><code id="tsmooth_+3A_x0">x0</code></td>
<td>
<p>initial state vector <code class="reqn">X(0\mid0)</code>.</p>
</td></tr>
<tr><td><code id="tsmooth_+3A_v0">v0</code></td>
<td>
<p>initial state covariance matrix <code class="reqn">V(0\mid0)</code>.</p>
</td></tr>
<tr><td><code id="tsmooth_+3A_filter.end">filter.end</code></td>
<td>
<p>end point of filtering.</p>
</td></tr>
<tr><td><code id="tsmooth_+3A_predict.end">predict.end</code></td>
<td>
<p>end point of prediction.</p>
</td></tr>
<tr><td><code id="tsmooth_+3A_minmax">minmax</code></td>
<td>
<p>lower and upper limits of observations.</p>
</td></tr>
<tr><td><code id="tsmooth_+3A_missed">missed</code></td>
<td>
<p>start position of missed intervals.</p>
</td></tr>
<tr><td><code id="tsmooth_+3A_np">np</code></td>
<td>
<p>number of missed observations.</p>
</td></tr>
<tr><td><code id="tsmooth_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), mean vectors of the smoother
and estimation error are plotted.</p>
</td></tr>
<tr><td><code id="tsmooth_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to <code><a href="#topic+plot.smooth">plot.smooth</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The linear Gaussian state space model is
</p>
<p style="text-align: center;"><code class="reqn">x_n = F_n x_{n-1} + G_n v_n,</code>
</p>

<p style="text-align: center;"><code class="reqn">y_n = H_n x_n + w_n,</code>
</p>

<p>where <code class="reqn">y_n</code> is a univariate time series, <code class="reqn">x_n</code> is an
<code class="reqn">m</code>-dimensional state vector.
</p>
<p><code class="reqn">F_n</code>, <code class="reqn">G_n</code> and <code class="reqn">H_n</code> are <code class="reqn">m \times m</code>,
<code class="reqn">m \times k</code> matrices and a vector of length <code class="reqn">m</code> , respectively.
<code class="reqn">Q_n</code> is <code class="reqn">k \times k</code> matrix and <code class="reqn">R_n</code> is a scalar.
<code class="reqn">v_n</code> is system noise and <code class="reqn">w_n</code> is observation noise,
where we assume that <code class="reqn">E(v_n, w_n) = 0</code>,
<code class="reqn">v_n \sim N(0, Q_n)</code> and
<code class="reqn">w_n \sim N(0, R_n)</code>. User should give all the matrices
of a state space model and its parameters. In current version, <code class="reqn">F_n</code>,
<code class="reqn">G_n</code>, <code class="reqn">H_n</code>, <code class="reqn">Q_n</code>, <code class="reqn">R_n</code> should be
time invariant.
</p>


<h3>Value</h3>

<p>An object of class <code>"smooth"</code>, which is a list with the following
components:
</p>
<table role = "presentation">
<tr><td><code>mean.smooth</code></td>
<td>
<p>mean vectors of the smoother.</p>
</td></tr>
<tr><td><code>cov.smooth</code></td>
<td>
<p>variance of the smoother.</p>
</td></tr>
<tr><td><code>esterr</code></td>
<td>
<p>estimation error.</p>
</td></tr>
<tr><td><code>llkhood</code></td>
<td>
<p>log-likelihood.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>AIC.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>
<p>Kitagawa, G. and Gersch, W. (1996)
<em>Smoothness Priors Analysis of Time Series</em>.
Lecture Notes in Statistics, No.116, Springer-Verlag.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example of prediction (AR model)
data(BLSALLFOOD)
BLS120 &lt;- BLSALLFOOD[1:120]
z1 &lt;- arfit(BLS120, plot = FALSE)
tau2 &lt;- z1$sigma2

# m = maice.order, k=1
m1 &lt;- z1$maice.order
arcoef &lt;- z1$arcoef[[m1]]
f &lt;- matrix(0.0e0, m1, m1)
f[1, ] &lt;- arcoef
if (m1 != 1)
  for (i in 2:m1) f[i, i-1] &lt;- 1
g &lt;- c(1, rep(0.0e0, m1-1))
h &lt;- c(1, rep(0.0e0, m1-1))
q &lt;- tau2[m1+1]
r &lt;- 0.0e0
x0 &lt;- rep(0.0e0, m1)
v0 &lt;- NULL

s1 &lt;- tsmooth(BLS120, f, g, h, q, r, x0, v0, filter.end = 120, predict.end = 156)
s1

plot(s1, BLSALLFOOD)

## Example of interpolation of missing values (AR model)
z2 &lt;- arfit(BLSALLFOOD, plot = FALSE)
tau2 &lt;- z2$sigma2

# m = maice.order, k=1
m2 &lt;- z2$maice.order
arcoef &lt;- z2$arcoef[[m2]]
f &lt;- matrix(0.0e0, m2, m2)
f[1, ] &lt;- arcoef
if (m2 != 1)
  for (i in 2:m2) f[i, i-1] &lt;- 1
g &lt;- c(1, rep(0.0e0, m2-1))
h &lt;- c(1, rep(0.0e0, m2-1))
q &lt;- tau2[m2+1]
r &lt;- 0.0e0
x0 &lt;- rep(0.0e0, m2)
v0 &lt;- NULL

tsmooth(BLSALLFOOD, f, g, h, q, r, x0, v0, missed = c(41, 101), np = c(30, 20))
</code></pre>

<hr>
<h2 id='tvar'>Time Varying Coefficients AR Model</h2><span id='topic+tvar'></span>

<h3>Description</h3>

<p>Estimate time varying coefficients AR model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tvar(y, trend.order = 2, ar.order = 2, span, outlier = NULL, tau2.ini = NULL,
     delta, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tvar_+3A_y">y</code></td>
<td>
<p>a univariate time series.</p>
</td></tr>
<tr><td><code id="tvar_+3A_trend.order">trend.order</code></td>
<td>
<p>trend order (1 or 2).</p>
</td></tr>
<tr><td><code id="tvar_+3A_ar.order">ar.order</code></td>
<td>
<p>AR order.</p>
</td></tr>
<tr><td><code id="tvar_+3A_span">span</code></td>
<td>
<p>local stationary span.</p>
</td></tr>
<tr><td><code id="tvar_+3A_outlier">outlier</code></td>
<td>
<p>positions of outliers.</p>
</td></tr>
<tr><td><code id="tvar_+3A_tau2.ini">tau2.ini</code></td>
<td>
<p>initial estimate of variance of the system noise <code class="reqn">\tau^2</code>.
If <code>tau2.ini</code> = <code>NULL</code>, the most suitable value is chosen in
<code class="reqn">\tau^2 = 2^{-k}</code>.</p>
</td></tr>
<tr><td><code id="tvar_+3A_delta">delta</code></td>
<td>
<p>search width.</p>
</td></tr> 
<tr><td><code id="tvar_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), PARCOR is plotted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The time-varying coefficients AR model is given by
</p>
<p style="text-align: center;"><code class="reqn">y_t = a_{1,t}y_{t-1} + \ldots + a_{p,t}y_{t-p} + u_t</code>
</p>

<p>where <code class="reqn">a_{i,t}</code> is <code class="reqn">i</code>-lag AR coefficient at time <code class="reqn">t</code>
and <code class="reqn">u_t</code> is a zero mean white noise.
</p>
<p>The time-varying spectrum can be plotted using AR coefficient <code>arcoef</code>
and variance of the observational noise <code>sigma2</code> by <code><a href="#topic+tvspc">tvspc</a></code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>arcoef</code></td>
<td>
<p>time varying AR coefficients.</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>variance of the observational noise <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code>tau2</code></td>
<td>
<p>variance of the system noise <code class="reqn">\tau^2</code>.</p>
</td></tr>
<tr><td><code>llkhood</code></td>
<td>
<p>log-likelihood of the model.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>AIC.</p>
</td></tr>
<tr><td><code>parcor</code></td>
<td>
<p>PARCOR.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>
<p>Kitagawa, G. and Gersch, W. (1996)
<em>Smoothness Priors Analysis of Time Series</em>.
Lecture Notes in Statistics, No.116, Springer-Verlag.
</p>
<p>Kitagawa, G. and Gersch, W. (1985)
<em>A smoothness priors time varying AR coefficient modeling of
nonstationary time series</em>. IEEE trans. on Automatic Control, AC-30, 48-56.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tvspc">tvspc</a></code>, <code><a href="#topic+plot.tvspc">plot.tvspc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># seismic data
data(MYE1F)
z &lt;- tvar(MYE1F, trend.order = 2, ar.order = 8, span = 20,
          outlier = c(630, 1026), tau2.ini = 6.6e-06, delta = 1.0e-06)
z

spec &lt;- tvspc(z$arcoef, z$sigma2)
plot(spec)
</code></pre>

<hr>
<h2 id='tvspc'>Evolutionary Power Spectra by Time Varying AR Model</h2><span id='topic+tvspc'></span>

<h3>Description</h3>

<p>Estimate evolutionary power spectra by time varying AR model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tvspc(arcoef, sigma2, var = NULL, span = 20, nf = 200)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tvspc_+3A_arcoef">arcoef</code></td>
<td>
<p>time varying AR coefficients.</p>
</td></tr>
<tr><td><code id="tvspc_+3A_sigma2">sigma2</code></td>
<td>
<p>variance of the observational noise.</p>
</td></tr>
<tr><td><code id="tvspc_+3A_var">var</code></td>
<td>
<p>time varying variance.</p>
</td></tr>
<tr><td><code id="tvspc_+3A_span">span</code></td>
<td>
<p>local stationary span.</p>
</td></tr>
<tr><td><code id="tvspc_+3A_nf">nf</code></td>
<td>
<p>number of frequencies in evaluating power spectrum.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return an object of class <code>"tvspc"</code> giving power spectra, which has a
<code>plot</code> method (<code><a href="#topic+plot.tvspc">plot.tvspc</a></code>).
</p>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>
<p>Kitagawa, G. and Gersch, W. (1996)
<em>Smoothness Priors Analysis of Time Series</em>. Lecture Notes in Statistics,
No.116, Springer-Verlag.
</p>
<p>Kitagawa, G. and Gersch, W. (1985)
<em>A smoothness priors time varying AR coefficient modeling 
of nonstationary time series</em>. IEEE trans. on Automatic Control, AC-30, 48-56.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># seismic data
data(MYE1F)
z &lt;- tvar(MYE1F, trend.order = 2, ar.order = 8, span = 20,
          outlier = c(630, 1026), tau2.ini = 6.6e-06, delta = 1.0e-06)
spec &lt;- tvspc(z$arcoef, z$sigma2)
plot(spec)
</code></pre>

<hr>
<h2 id='tvvar'>Time Varying Variance</h2><span id='topic+tvvar'></span><span id='topic+print.tvvar'></span><span id='topic+plot.tvvar'></span>

<h3>Description</h3>

<p>Estimate time-varying variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tvvar(y, trend.order, tau2.ini = NULL, delta, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tvvar_+3A_y">y</code></td>
<td>
<p>a univariate time series.</p>
</td></tr>
<tr><td><code id="tvvar_+3A_trend.order">trend.order</code></td>
<td>
<p>trend order.</p>
</td></tr>
<tr><td><code id="tvvar_+3A_tau2.ini">tau2.ini</code></td>
<td>
<p>initial estimate of variance of the system noise <code class="reqn">\tau^2</code>.
If <code>tau2.ini</code> = <code>NULL</code>, the most suitable value is chosen in
<code class="reqn">\tau^2 = 2^{-k}</code>.</p>
</td></tr>
<tr><td><code id="tvvar_+3A_delta">delta</code></td>
<td>
<p>search width.</p>
</td></tr>
<tr><td><code id="tvvar_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), transformed data, trend and
residuals are plotted.</p>
</td></tr>
<tr><td><code id="tvvar_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to the <code>plot</code> method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Assuming that <code class="reqn">\sigma_{2m-1}^2 = \sigma_{2m}^2</code>, we define a transformed time series
<code class="reqn">s_1,\dots,s_{N/2}</code> by 
</p>
<p style="text-align: center;"><code class="reqn">s_m = y_{2m-1}^2 + y_{2m}^2,</code>
</p>

<p>where <code class="reqn">y_n</code> is a Gaussian white noise with mean <code class="reqn">0</code> and variance
<code class="reqn">\sigma_n^2</code>. <code class="reqn">s_m</code> is distributed as a <code class="reqn">\chi^2</code> distribution with
<code class="reqn">2</code> degrees of freedom, so the probability density function of <code class="reqn">s_m</code>
is given by
</p>
<p style="text-align: center;"><code class="reqn">f(s) = \frac{1}{2\sigma^2} e^{-s/2\sigma^2}.</code>
</p>

<p>By further transformation
</p>
<p style="text-align: center;"><code class="reqn">z_m = \log \left( \frac{s_m}{2} \right),</code>
</p>

<p>the probability density function of <code class="reqn">z_m</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">g(z) = \frac{1}{\sigma^2} \exp{ \left\{ z-\frac{e^z}{\sigma^2} \right\} } = \exp{ \left\{ (z-\log\sigma^2) - e^{(z-\log\sigma^2)} \right\} }.</code>
</p>

<p>Therefore, the transformed time series is given by
</p>
<p style="text-align: center;"><code class="reqn">z_m = \log \sigma^2 + w_m,</code>
</p>

<p>where <code class="reqn">w_m</code> is a double exponential distribution with probability density
function 
</p>
<p style="text-align: center;"><code class="reqn">h(w) = \exp{\{w-e^w\}}.</code>
</p>

<p>In the space state model 
</p>
<p style="text-align: center;"><code class="reqn">z_m = t_m + w_m</code>
</p>

<p>by identifying trend components of <code class="reqn">z_m</code>, the log variance of original
time series <code class="reqn">y_n</code> is obtained.
</p>


<h3>Value</h3>

<p>An object of class <code>"tvvar"</code> which has a <code>plot</code> method. This is a
list with the following components:
</p>
<table role = "presentation">
<tr><td><code>tvv</code></td>
<td>
<p>time varying variance.</p>
</td></tr>
<tr><td><code>nordata</code></td>
<td>
<p>normalized data.</p>
</td></tr>
<tr><td><code>sm</code></td>
<td>
<p>transformed data.</p>
</td></tr>
<tr><td><code>trend</code></td>
<td>
<p>trend.</p>
</td></tr>
<tr><td><code>noise</code></td>
<td>
<p>residuals.</p>
</td></tr>
<tr><td><code>tau2</code></td>
<td>
<p>variance of the system noise.</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>variance of the observational noise.</p>
</td></tr>
<tr><td><code>llkhood</code></td>
<td>
<p>log-likelihood of the model.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>AIC.</p>
</td></tr>
<tr><td><code>tsname</code></td>
<td>
<p>the name of the univariate time series <code>y</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>
<p>Kitagawa, G. and Gersch, W. (1996)
<em>Smoothness Priors Analysis of Time Series</em>. Lecture Notes in Statistics,
No.116, Springer-Verlag.
</p>
<p>Kitagawa, G. and Gersch, W. (1985)
<em>A smoothness priors time varying AR coefficient modeling of
nonstationary time series</em>. IEEE trans. on Automatic Control, AC-30, 48-56.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># seismic data
data(MYE1F)
tvvar(MYE1F, trend.order = 2, tau2.ini = 6.6e-06, delta = 1.0e-06)
</code></pre>

<hr>
<h2 id='unicor'>Autocovariance and Autocorrelation</h2><span id='topic+unicor'></span>

<h3>Description</h3>

<p>Compute autocovariance and autocorrelation function of the univariate time
series.</p>


<h3>Usage</h3>

<pre><code class='language-R'>unicor(y, lag = NULL, minmax = c(-1.0e+30, 1.0e+30), plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="unicor_+3A_y">y</code></td>
<td>
<p>a univariate time series.</p>
</td></tr>
<tr><td><code id="unicor_+3A_lag">lag</code></td>
<td>
<p>maximum lag. Default is <code class="reqn">2 \sqrt{n}</code>, where <code class="reqn">n</code>
is the length of the time series <code>y</code>.</p>
</td></tr>
<tr><td><code id="unicor_+3A_minmax">minmax</code></td>
<td>
<p>thresholds for outliers in low side and high side.</p>
</td></tr>
<tr><td><code id="unicor_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), autocorrelations are plotted.</p>
</td></tr>
<tr><td><code id="unicor_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to the <code>plot</code> method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"unicor"</code> which has a <code>plot</code> method. This is a
list with the following components:
</p>
<table role = "presentation">
<tr><td><code>acov</code></td>
<td>
<p>autocovariances.</p>
</td></tr>
<tr><td><code>acor</code></td>
<td>
<p>autocorrelations.</p>
</td></tr>
<tr><td><code>acov.err</code></td>
<td>
<p>error bound for autocovariances.</p>
</td></tr>
<tr><td><code>acor.err</code></td>
<td>
<p>error bound for autocorrelations.</p>
</td></tr>
<tr><td><code>mean</code></td>
<td>
<p>mean of <code>y</code>.</p>
</td></tr>
<tr><td><code>tsname</code></td>
<td>
<p>the name of the univariate time series <code>y</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kitagawa, G. (2020)
<em>Introduction to Time Series Modeling with Applications in R</em>.
Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Yaw rate, rolling, pitching and rudder angle of a ship
data(HAKUSAN)
Yawrate &lt;- HAKUSAN[, 1]
unicor(Yawrate, lag = 50)

# seismic data
data(MYE1F)
unicor(MYE1F, lag = 50)
</code></pre>

<hr>
<h2 id='WHARD'>Wholesale Hardware Data</h2><span id='topic+WHARD'></span>

<h3>Description</h3>

<p>The monthly record of wholesale hardware data. (January 1967 - November 1979)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(WHARD)
</code></pre>


<h3>Format</h3>

<p>A time series of 155 observations.
</p>


<h3>Source</h3>

<p>The data were obtained from the United States Bureau of Labor Statistics (BLS).
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
