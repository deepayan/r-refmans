<!DOCTYPE html><html><head><title>Help for package snap</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {snap}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#friedman3'><p>friedman3 data set</p></a></li>
<li><a href='#snap'><p>snap</p></a></li>
<li><a href='#threenorm'><p>threenorm data set</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Simple Neural Application</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Giancarlo Vercellino</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Giancarlo Vercellino &lt;giancarlo.vercellino@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A simple wrapper to easily design vanilla deep neural networks using 'Tensorflow'/'Keras' backend for regression, classification and multi-label tasks, with some tweaks and tricks (skip shortcuts, embedding, feature selection and anomaly detection).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6)</td>
</tr>
<tr>
<td>Imports:</td>
<td>keras (&ge; 2.3.0.0), tensorflow (&ge; 2.2.0), dplyr (&ge; 1.0.2),
purrr (&ge; 0.3.4), forcats (&ge; 0.5.0), tictoc (&ge; 1.0.1), readr
(&ge; 1.4.0), ggplot2 (&ge; 3.3.3), CORElearn (&ge; 1.54.2), dbscan
(&ge; 1.1-5), stringr (&ge; 1.4.0), reticulate (&ge; 1.18)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://rpubs.com/giancarlo_vercellino/snap">https://rpubs.com/giancarlo_vercellino/snap</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-06-30 07:41:14 UTC; gvercellino</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-06-30 08:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='friedman3'>friedman3 data set</h2><span id='topic+friedman3'></span>

<h3>Description</h3>

<p>Data set to demonstrate regression task.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>friedman3
</code></pre>


<h3>Format</h3>

<p>A dummy data frame with 5 columns and 150 rows created using Benchmark Problem Friedman 3 by mlbench. The target feature is &quot;y&quot;.
</p>


<h3>Source</h3>

<p>mlbench.friedman3(n = 150, sd = 3)
</p>

<hr>
<h2 id='snap'>snap</h2><span id='topic+snap'></span><span id='topic+snap-package'></span>

<h3>Description</h3>

<p>A simple wrapper to easily design vanilla deep neural networks using 'Tensorflow'/'Keras' backend for regression, classification and multi-label tasks, with some tweaks and tricks (skip shortcuts, embedding, feature selection and anomaly detection).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>snap(
  data,
  target,
  task = NULL,
  positive = NULL,
  skip_shortcut = FALSE,
  embedding = "none",
  embedding_size = 10,
  folds = 3,
  reps = 1,
  holdout = 0.3,
  layers = 1,
  activations = "relu",
  regularization_L1 = 0,
  regularization_L2 = 0,
  nodes = 32,
  dropout = 0,
  span = 0.2,
  min_delta = 0,
  batch_size = 32,
  epochs = 50,
  imp_thresh = 0,
  anom_thresh = 1,
  output_activation = NULL,
  optimizer = "Adam",
  loss = NULL,
  metrics = NULL,
  winsor = FALSE,
  q_min = 0.01,
  q_max = 0.99,
  normalization = TRUE,
  seed = 42,
  verbose = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="snap_+3A_data">data</code></td>
<td>
<p>A data frame including all the features and targets.</p>
</td></tr>
<tr><td><code id="snap_+3A_target">target</code></td>
<td>
<p>String. Single label for target feature when task is &quot;regr&quot; or &quot;classif&quot;. String vector with multiple labels for target features when task is &quot;multilabel&quot;.</p>
</td></tr>
<tr><td><code id="snap_+3A_task">task</code></td>
<td>
<p>String. Inferred by data type of target feature(s). Available options are: &quot;regr&quot;, &quot;classif&quot;, &quot;multilabel&quot;. Default: NULL.</p>
</td></tr>
<tr><td><code id="snap_+3A_positive">positive</code></td>
<td>
<p>String. Positive class label (only for classification task). Default: NULL.</p>
</td></tr>
<tr><td><code id="snap_+3A_skip_shortcut">skip_shortcut</code></td>
<td>
<p>Logical. Option to add a skip shortcut to improve network performance in case of many layers. Default: FALSE.</p>
</td></tr>
<tr><td><code id="snap_+3A_embedding">embedding</code></td>
<td>
<p>String. Available options are: &quot;none&quot;, &quot;global&quot; (when identical values for different features hold different meanings), &quot;sequence&quot; (when identical values for different features hold the same meaning). Default: NULL.</p>
</td></tr>
<tr><td><code id="snap_+3A_embedding_size">embedding_size</code></td>
<td>
<p>Integer. Output dimension for the embedding layer. Default: 10.</p>
</td></tr>
<tr><td><code id="snap_+3A_folds">folds</code></td>
<td>
<p>Positive integer. Number of folds for repeated cross-validation. Default: 3.</p>
</td></tr>
<tr><td><code id="snap_+3A_reps">reps</code></td>
<td>
<p>Positive integer. Number of repetitions for repeated cross-validation. Default: 1.</p>
</td></tr>
<tr><td><code id="snap_+3A_holdout">holdout</code></td>
<td>
<p>Positive numeric. Percentage of cases for holdout validation. Default: 0.3.</p>
</td></tr>
<tr><td><code id="snap_+3A_layers">layers</code></td>
<td>
<p>Positive integer. Number of layers for the neural net. Default: 1.</p>
</td></tr>
<tr><td><code id="snap_+3A_activations">activations</code></td>
<td>
<p>String. String vector with the activation functions for each layer (for example, a neural net with 3 layers may have activations = c(&quot;relu&quot;, &quot;gelu&quot;, &quot;tanh&quot;)). Besides standard Tensorflow/Keras activations, you can also choose: &quot;swish&quot;, &quot;mish&quot;, &quot;gelu&quot;, &quot;bent&quot;. Default: &quot;relu&quot;.</p>
</td></tr>
<tr><td><code id="snap_+3A_regularization_l1">regularization_L1</code></td>
<td>
<p>Positive numeric. Value for L1 regularization of the loss function. Default: 0.</p>
</td></tr>
<tr><td><code id="snap_+3A_regularization_l2">regularization_L2</code></td>
<td>
<p>Positive numeric. Value for L2 regularization of the loss function. Default: 0.</p>
</td></tr>
<tr><td><code id="snap_+3A_nodes">nodes</code></td>
<td>
<p>Positive integer. Integer vector with the nodes for each layer (for example, a neural net with 3 layers may have nodes = c(32, 64, 16)). Default: 32.</p>
</td></tr>
<tr><td><code id="snap_+3A_dropout">dropout</code></td>
<td>
<p>Positive numeric. Value for the dropout parameter for each layer (for example, a neural net with 3 layers may have dropout = c(0, 0.5, 0.3)). Default: 0.</p>
</td></tr>
<tr><td><code id="snap_+3A_span">span</code></td>
<td>
<p>Positive numeric. Percentage of epoch for the patience parameter. Default: 0.2.</p>
</td></tr>
<tr><td><code id="snap_+3A_min_delta">min_delta</code></td>
<td>
<p>Positive numeric. Minimum improvement on metric to trigger the early stop. Default: 0.</p>
</td></tr>
<tr><td><code id="snap_+3A_batch_size">batch_size</code></td>
<td>
<p>Positive integer. Maximum batch size for training. Default: 32.</p>
</td></tr>
<tr><td><code id="snap_+3A_epochs">epochs</code></td>
<td>
<p>Positive integer. Maximum number of forward and backward propagations. Default: 50.</p>
</td></tr>
<tr><td><code id="snap_+3A_imp_thresh">imp_thresh</code></td>
<td>
<p>Positive numeric. Importance threshold (in percentiles) above which the features are included in the model (using ReliefFbestK metric by CORElearn). Default: 0 (all features included).</p>
</td></tr>
<tr><td><code id="snap_+3A_anom_thresh">anom_thresh</code></td>
<td>
<p>Positive numeric. Anomaly threshold (in percentiles) above which the instances are excluded by the model (using lof by dbscan). Default: 1 (all instances included).</p>
</td></tr>
<tr><td><code id="snap_+3A_output_activation">output_activation</code></td>
<td>
<p>String. Default: NULL. If not specified otherwise, it will be &quot;Linear&quot; for regression task, &quot;Softmax&quot; for classification task, &quot;Sigmoid&quot; for multilabel task.</p>
</td></tr>
<tr><td><code id="snap_+3A_optimizer">optimizer</code></td>
<td>
<p>String. Standard Tensorflow/Keras Optimization methods are available. Default: &quot;Adam&quot;.</p>
</td></tr>
<tr><td><code id="snap_+3A_loss">loss</code></td>
<td>
<p>Default: NULL. If not specified otherwise, it will be &quot;mean_absolute_error&quot; for regression task, &quot;categorical_crossentropy&quot; for classification task, &quot;binary_crossentropy&quot; for multilabel task.</p>
</td></tr>
<tr><td><code id="snap_+3A_metrics">metrics</code></td>
<td>
<p>Default: NULL. If not specified otherwise, it will be &quot;mean_absolute_error&quot; for regression task, &quot;categorical_crossentropy&quot; for classification task, &quot;binary_crossentropy&quot; for multilabel task.</p>
</td></tr>
<tr><td><code id="snap_+3A_winsor">winsor</code></td>
<td>
<p>Logical. Set to TRUE in case you want to perform Winsorization on regression tasks. Default: FALSE.</p>
</td></tr>
<tr><td><code id="snap_+3A_q_min">q_min</code></td>
<td>
<p>Positive numeric. Minimum quantile threshold for Winsorization. Default: 0.01.</p>
</td></tr>
<tr><td><code id="snap_+3A_q_max">q_max</code></td>
<td>
<p>Positive numeric. Maximum quantile threshold for Winsorization. Default: 0.99.</p>
</td></tr>
<tr><td><code id="snap_+3A_normalization">normalization</code></td>
<td>
<p>Logical. After each layer it performs a batch normalization. Default: TRUE.</p>
</td></tr>
<tr><td><code id="snap_+3A_seed">seed</code></td>
<td>
<p>Positive integer. Seed value to control random processes. Default: 42.</p>
</td></tr>
<tr><td><code id="snap_+3A_verbose">verbose</code></td>
<td>
<p>Positive integer. Set the level of information from Keras. Default: 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a list including:
</p>

<ul>
<li><p> task: kind of task solved
</p>
</li>
<li><p> configuration: main hyper-parameters describing the neural net (layers, activations, regularization_L1, regularization_L2, nodes, dropout)
</p>
</li>
<li><p> model: Keras standard model description
</p>
</li>
<li><p> pred_fun: function to use on the same data scheme to predict new values
</p>
</li>
<li><p> plot: Keras standard history plot
</p>
</li>
<li><p> testing_frame: testing set with the related predictions, including
</p>
</li>
<li><p> trials: statistics for each trial during the repeated cross-validation (train set and validation set):
</p>

<ul>
<li><p> task &quot;classif&quot;: balanced accuracy (bac), precision (prc), sensitivity (sen), critical success index (csi), FALSE-score (fsc), Kappa (kpp), Kendall (kdl)
</p>
</li>
<li><p> task &quot;regr&quot;: root mean square error(rmse), mean absolute error (mae), median absolute error (mdae), relative root square error (rrse), relative absolute error (rae), Pearson (prsn)
</p>
</li>
<li><p> task &quot;multilabel&quot;: macro bac, macro prc, macro sensitivity, macro sen, macro csi, macro fsc, micro kpp, micro kdl
</p>
</li></ul>

</li>
<li><p> metrics: summary statistics as above for training, validation (both averaged over trials) and testing
</p>
</li>
<li><p> selected_feat: labels of features included within the model
</p>
</li>
<li><p> selected_inst: index of instances included within the model
</p>
</li>
<li><p> time_log
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Giancarlo Vercellino <a href="mailto:giancarlo.vercellino@gmail.com">giancarlo.vercellino@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://rpubs.com/giancarlo_vercellino/snap">https://rpubs.com/giancarlo_vercellino/snap</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
snap(friedman3, target="y")

snap(threenorm, target="classes", imp_thresh = 0.3, anom_thresh = 0.95)

snap(threenorm, "classes", layers = 2, activations = c("gelu", "swish"), nodes = c(32, 64))

## End(Not run)

</code></pre>

<hr>
<h2 id='threenorm'>threenorm data set</h2><span id='topic+threenorm'></span>

<h3>Description</h3>

<p>Data set to demonstrate classification task.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>threenorm
</code></pre>


<h3>Format</h3>

<p>A dummy data frame with 5 columns and 150 rows created using Threenorm Benchmark Problem by mlbench. The target feature is &quot;classes&quot;.
</p>


<h3>Source</h3>

<p>mlbench.threenorm(150, d = 20)
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
