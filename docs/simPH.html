<!DOCTYPE html><html><head><title>Help for package simPH</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {simPH}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as.data.frame.coxsim'><p>Convert a coxsim class object into a data frame</p></a></li>
<li><a href='#CarpenterFdaData'><p>A data set from Carpenter (2002).</p></a></li>
<li><a href='#coxsimInteract'><p>Simulate quantities of interest for linear multiplicative interactions</p>
from Cox Proportional Hazards models</a></li>
<li><a href='#coxsimLinear'><p>Simulate quantities of interest for covariates from Cox Proportional Hazards</p>
models that are not interacted with time or nonlinearly transformed</a></li>
<li><a href='#coxsimPoly'><p>Simulate quantities of interest for a range of values for a polynomial</p>
nonlinear effect from Cox Proportional Hazards models</a></li>
<li><a href='#coxsimSpline'><p>Simulate quantities of interest for penalized splines from Cox Proportional</p>
Hazards models</a></li>
<li><a href='#coxsimtvc'><p>Simulate time-interactive quantities of interest from Cox Proportional</p>
Hazards models</a></li>
<li><a href='#ggfitStrata'><p>Graph fitted stratified survival curves from Cox Proportional Hazards models</p></a></li>
<li><a href='#GolubEUPData'><p>A data set from Golub &amp; Steunenberg (2007)</p></a></li>
<li><a href='#hmohiv'><p>Simulated HIV patient data from UCLA IDRE</p></a></li>
<li><a href='#MinMaxLines'><p>Transform the simulation object to include only the min and max of the</p>
constricted intervals, as well as the lower and upper bounds of the middle 50
percent of the constricted intervals</a></li>
<li><a href='#setXl'><p>Create a sequence of Xl values</p></a></li>
<li><a href='#simGG'><p>A method for plotting simulation objects created by simPH</p></a></li>
<li><a href='#simGG.siminteract'><p>Plot simulated linear multiplicative interactions from Cox Proportional</p>
Hazards Models</a></li>
<li><a href='#simGG.simlinear'><p>Plot simulated linear, non-time interacted quantities of interest from Cox</p>
Proportional Hazards Models</a></li>
<li><a href='#simGG.simpoly'><p>Plot simulated polynomial quantities of interest from Cox Proportional</p>
Hazards Models</a></li>
<li><a href='#simGG.simspline'><p>Plot simulated penalised spline hazards from Cox Proportional Hazards Models</p></a></li>
<li><a href='#simGG.simtvc'><p>Plot simulated time-interactive hazard ratios or stratified time-interactive</p>
hazard rates from Cox Proportional Hazards Models</a></li>
<li><a href='#simPH'><p>An R package for simulating and plotting quantities of interest from Cox</p>
Proportional Hazard models.</a></li>
<li><a href='#SurvExpand'><p>Convert a data frame of non-equal interval continuous observations into</p>
equal interval continuous observations</a></li>
<li><a href='#tvc'><p>Create a time interaction variable</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Simulate and Plot Estimates from Cox Proportional Hazards Models</td>
</tr>
<tr>
<td>Description:</td>
<td>Simulates and plots quantities of interest (relative
    hazards, first differences, and hazard ratios) for linear coefficients,
    multiplicative interactions, polynomials, penalised splines, and
    non-proportional hazards, as well as stratified survival curves from Cox
    Proportional Hazard models. It also simulates and plots marginal effects
    for multiplicative interactions. Methods described in Gandrud (2015)
    &lt;<a href="https://doi.org/10.18637%2Fjss.v065.i03">doi:10.18637/jss.v065.i03</a>&gt;.</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.13</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-01-09</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://CRAN.R-project.org/package=simPH">https://CRAN.R-project.org/package=simPH</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/christophergandrud/simPH/issues">https://github.com/christophergandrud/simPH/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.2)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table (&ge; 1.9.6), dplyr (&ge; 0.4), ggplot2, gridExtra,
lazyeval, MASS, mgcv, stringr, survival, quadprog</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, stats, testthat, covr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BuildVignettes:</td>
<td>true</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-01-09 06:48:22 UTC; cgandrud</td>
</tr>
<tr>
<td>Author:</td>
<td>Christopher Gandrud [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Christopher Gandrud &lt;christopher.gandrud@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-01-10 14:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='as.data.frame.coxsim'>Convert a coxsim class object into a data frame</h2><span id='topic+as.data.frame.coxsim'></span>

<h3>Description</h3>

<p>Convert a coxsim class object into a data frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'coxsim'
as.data.frame(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.data.frame.coxsim_+3A_x">x</code></td>
<td>
<p>a <code>coxsim</code> class object.</p>
</td></tr>
<tr><td><code id="as.data.frame.coxsim_+3A_...">...</code></td>
<td>
<p>arguments to pass to <code>data.frame</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='CarpenterFdaData'>A data set from Carpenter (2002).</h2><span id='topic+CarpenterFdaData'></span>

<h3>Description</h3>

<p>A data set from Carpenter (2002).
</p>


<h3>Format</h3>

<p>A data set with 408 observations and 32 variables.
</p>


<h3>Source</h3>

<p>Carpenter, Daniel P. 2002. &rdquo;Groups, the Media, Agency Waiting Costs, 
and FDA Drug Approval.&rdquo; American Journal of Political Science 46(3): 490-505.
</p>
<p>Luke Keele, &quot;Replication data for: Proportionally Difficult: Testing for 
Nonproportional Hazards In Cox Models&quot;. 
doi: <a href="https://doi.org/10.7910/DVN/VJAHRG">10.7910/DVN/VJAHRG</a>. V1 [Version].
</p>

<hr>
<h2 id='coxsimInteract'>Simulate quantities of interest for linear multiplicative interactions
from Cox Proportional Hazards models</h2><span id='topic+coxsimInteract'></span>

<h3>Description</h3>

<p><code>coxsimInteract</code> simulates quantities of interest for linear
multiplicative interactions using multivariate normal distributions.
These can be plotted with <code><a href="#topic+simGG">simGG</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coxsimInteract(
  obj,
  b1,
  b2,
  qi = "Marginal Effect",
  X1 = NULL,
  X2 = NULL,
  means = FALSE,
  expMarg = TRUE,
  nsim = 1000,
  ci = 0.95,
  spin = FALSE,
  extremesDrop = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coxsimInteract_+3A_obj">obj</code></td>
<td>
<p>a <code><a href="survival.html#topic+coxph">coxph</a></code> class fitted model object with a linear
multiplicative interaction.</p>
</td></tr>
<tr><td><code id="coxsimInteract_+3A_b1">b1</code></td>
<td>
<p>character string of the first constitutive variable's name.
Note <code>b1</code> and <code>b2</code> must be entered in the order in which they are
entered into the <code>coxph</code> model.</p>
</td></tr>
<tr><td><code id="coxsimInteract_+3A_b2">b2</code></td>
<td>
<p>character string of the second constitutive variable's name.</p>
</td></tr>
<tr><td><code id="coxsimInteract_+3A_qi">qi</code></td>
<td>
<p>quantity of interest to simulate. Values can be
<code>"Marginal Effect"</code>, <code>"First Difference"</code>, <code>"Hazard Ratio"</code>,
and <code>"Hazard Rate"</code>. The default is <code>qi = "Hazard Ratio"</code>.
If <code>qi = "Hazard Rate"</code> and the <code>coxph</code> model has strata, then
hazard rates for each strata will also be calculated.</p>
</td></tr>
<tr><td><code id="coxsimInteract_+3A_x1">X1</code></td>
<td>
<p>numeric vector of fitted values of <code>b1</code> to simulate for.
If <code>qi = "Marginal Effect"</code> then only <code>X2</code> can be set. If you want
to plot the results, <code>X1</code> should have more than one value.</p>
</td></tr>
<tr><td><code id="coxsimInteract_+3A_x2">X2</code></td>
<td>
<p>numeric vector of fitted values of <code>b2</code> to simulate for.</p>
</td></tr>
<tr><td><code id="coxsimInteract_+3A_means">means</code></td>
<td>
<p>logical, whether or not to use the mean values to fit the
hazard rate for covaraiates other than <code>b1</code> <code>b2</code> and <code>b1*b2</code>.
Note: it does not currently support models that include polynomials created
by <code><a href="base.html#topic+I">I</a></code>. Note: EXPERIMENTAL. <code>lines</code> are not currently
supported in <code><a href="#topic+simGG">simGG</a></code> if <code>means = TRUE</code>.</p>
</td></tr>
<tr><td><code id="coxsimInteract_+3A_expmarg">expMarg</code></td>
<td>
<p>logical. Whether or not to exponentiate the marginal effect.</p>
</td></tr>
<tr><td><code id="coxsimInteract_+3A_nsim">nsim</code></td>
<td>
<p>the number of simulations to run per value of X. Default is
<code>nsim = 1000</code>.</p>
</td></tr>
<tr><td><code id="coxsimInteract_+3A_ci">ci</code></td>
<td>
<p>the proportion of middle simulations to keep. The default is
<code>ci = 0.95</code>, i.e. keep the middle 95 percent. If <code>spin = TRUE</code>
then <code>ci</code> is the confidence level of the shortest probability interval.
Any value from 0 through 1 may be used.</p>
</td></tr>
<tr><td><code id="coxsimInteract_+3A_spin">spin</code></td>
<td>
<p>logical, whether or not to keep only the shortest probability
interval rather than the middle simulations. Currently not supported for
hazard rates.</p>
</td></tr>
<tr><td><code id="coxsimInteract_+3A_extremesdrop">extremesDrop</code></td>
<td>
<p>logical whether or not to drop simulated quantity of
interest values that are <code>Inf</code>, <code>NA</code>, <code>NaN</code> and
<code class="reqn">&gt; 1000000</code> for <code>spin = FALSE</code> or <code class="reqn">&gt; 800</code> for <code>spin = TRUE</code>.
These values are difficult to plot <code><a href="#topic+simGG">simGG</a></code> and may prevent
<code>spin</code> from finding the central interval.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simulates marginal effects, first differences, hazard ratios, and
hazard rates for linear multiplicative interactions.
Marginal effects are calculated as in Brambor et al. (2006) with the
addition that we take the exponent, so that it resembles a hazard ratio.
You can choose not to take the exponent by setting the argument
<code>expMarg = FALSE</code>. For an interaction between variables <code class="reqn">X</code> and
<code class="reqn">Z</code> the marginal effect for <code class="reqn">X</code> is:
</p>
<p style="text-align: center;"><code class="reqn">ME_{X} = e^(\beta_{X} + \beta_{XZ}Z)</code>
</p>

<p>Note that for First Differences the comparison is not between two values of
the same variable but two values of the constitute variable and 0 for the
two variables.
</p>


<h3>Value</h3>

<p>a <code>siminteract</code> class object
</p>


<h3>References</h3>

<p>Gandrud, Christopher. 2015. simPH: An R Package for Illustrating
Estimates from Cox Proportional Hazard Models Including for Interactive and
Nonlinear Effects. Journal of Statistical Software. 65(3)1-20.
</p>
<p>Brambor, Thomas, William Roberts Clark, and Matt Golder. 2006.
&rdquo;Understanding Interaction Models: Improving Empirical Analyses.&rdquo;
Political Analysis 14(1): 63-82.
</p>
<p>King, Gary, Michael Tomz, and Jason Wittenberg. 2000. &rdquo;Making the Most of
Statistical Analyses: Improving Interpretation and Presentation.&rdquo; American
Journal of Political Science 44(2): 347-61.
</p>
<p>Liu, Ying, Andrew Gelman, and Tian Zheng. 2013. &rdquo;Simulation-Efficient
Shortest Probability Intervals.&rdquo; Arvix.
<a href="https://arxiv.org/pdf/1302.2142v1.pdf">https://arxiv.org/pdf/1302.2142v1.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simGG">simGG</a></code>, <code><a href="boot.html#topic+survival">survival</a></code>, <code><a href="survival.html#topic+strata">strata</a></code>,
and <code><a href="survival.html#topic+coxph">coxph</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Carpenter (2002) data
data("CarpenterFdaData")

# Load survival package
library(survival)

# Run basic model
M1 &lt;- coxph(Surv(acttime, censor) ~ lethal*prevgenx,
            data = CarpenterFdaData)

# Simulate Marginal Effect of lethal for multiple
# values of prevgenx
Sim1 &lt;- coxsimInteract(M1, b1 = "lethal", b2 = "prevgenx",
                       X2 = seq(2, 115, by = 5), spin = TRUE)

## Not run: 
# Change the order of the covariates to make a more easily
# interpretable relative hazard graph.
M2 &lt;- coxph(Surv(acttime, censor) ~ prevgenx*lethal +
             orphdum, data = CarpenterFdaData)

# Simulate Hazard Ratio of lethal for multiple
# values of prevgenx
Sim2 &lt;- coxsimInteract(M2, b1 = "prevgenx", b2 = "lethal",
                    X1 = seq(2, 115, by = 2),
                    X2 = c(0, 1),
                    qi = "Hazard Ratio", ci = 0.9)

# Simulate First Difference
Sim3 &lt;- coxsimInteract(M2, b1 = "prevgenx", b2 = "lethal",
                       X1 = seq(2, 115, by = 2),
                       X2 = c(0, 1),
                       qi = "First Difference", spin = TRUE)

# Simulate Hazard Rate
Sim4 &lt;- coxsimInteract(M2, b1 = "prevgenx", b2 = "lethal",
                       X1 = 90, X2 = 1, qi = "Hazard Rate",
                       means = TRUE)

## End(Not run)

# Example with a categorical variable
# Download data
data(hmohiv)

# Create category lables
hmohiv$drug &lt;- factor(hmohiv$drug, labels = c('not treated', 'treated'))

M3 &lt;- coxph(Surv(time,censor) ~ drug*age, data = hmohiv)

# Note: Use relevant coefficient name as shown in model summary, e.g.
# 'drugtreated'.
Sim5 &lt;- coxsimInteract(M3, b1 = "drugtreated", b2 = 'age', X2 = 20:54)

</code></pre>

<hr>
<h2 id='coxsimLinear'>Simulate quantities of interest for covariates from Cox Proportional Hazards
models that are not interacted with time or nonlinearly transformed</h2><span id='topic+coxsimLinear'></span>

<h3>Description</h3>

<p>Simulates relative hazards, first differences, hazard ratios,
and hazard rates for linear, non-time interacted covariates from Cox
Proportional Hazard models. These can be plotted with <code><a href="#topic+simGG">simGG</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coxsimLinear(
  obj,
  b,
  qi = "Relative Hazard",
  Xj = NULL,
  Xl = NULL,
  means = FALSE,
  nsim = 1000,
  ci = 0.95,
  spin = FALSE,
  extremesDrop = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coxsimLinear_+3A_obj">obj</code></td>
<td>
<p>a <code><a href="survival.html#topic+coxph">coxph</a></code> class fitted model object.</p>
</td></tr>
<tr><td><code id="coxsimLinear_+3A_b">b</code></td>
<td>
<p>character string name of the coefficient you would like to simulate.</p>
</td></tr>
<tr><td><code id="coxsimLinear_+3A_qi">qi</code></td>
<td>
<p>quantity of interest to simulate. Values can be
<code>"Relative Hazard"</code>, <code>"First Difference"</code>, <code>"Hazard Ratio"</code>,
and <code>"Hazard Rate"</code>. The default is <code>qi = "Relative Hazard"</code>. If
<code>qi = "Hazard Rate"</code> and the <code>coxph</code> model has strata, then hazard
rates for each strata will also be calculated.</p>
</td></tr>
<tr><td><code id="coxsimLinear_+3A_xj">Xj</code></td>
<td>
<p>numeric vector of fitted values for <code>b</code> to simulate for.</p>
</td></tr>
<tr><td><code id="coxsimLinear_+3A_xl">Xl</code></td>
<td>
<p>numeric vector of values to compare <code>Xj</code> to. Note if
<code>code = "Relative Hazard"</code> only <code>Xj</code> is relevant.</p>
</td></tr>
<tr><td><code id="coxsimLinear_+3A_means">means</code></td>
<td>
<p>logical, whether or not to use the mean values to fit the
hazard rate for covaraiates other than <code>b</code>. Note: EXPERIMENTAL.
<code>lines</code> are not currently supported in <code><a href="#topic+simGG">simGG</a></code> if
<code>means = TRUE</code>.</p>
</td></tr>
<tr><td><code id="coxsimLinear_+3A_nsim">nsim</code></td>
<td>
<p>the number of simulations to run per value of X. Default is
<code>nsim = 1000</code>. Note: it does not currently support models that include
polynomials created by <code><a href="base.html#topic+I">I</a></code>.</p>
</td></tr>
<tr><td><code id="coxsimLinear_+3A_ci">ci</code></td>
<td>
<p>the proportion of simulations to keep. The default is
<code>ci = 0.95</code>, i.e. keep the middle 95 percent. If <code>spin = TRUE</code>
then <code>ci</code> is the confidence level of the shortest probability interval.
Any value from 0 through 1 may be used.</p>
</td></tr>
<tr><td><code id="coxsimLinear_+3A_spin">spin</code></td>
<td>
<p>logical, whether or not to keep only the shortest probability
interval rather than the middle simulations. Currently not supported for
Hazard Rates.</p>
</td></tr>
<tr><td><code id="coxsimLinear_+3A_extremesdrop">extremesDrop</code></td>
<td>
<p>logical whether or not to drop simulated quantity of
interest values that are <code>Inf</code>, <code>NA</code>, <code>NaN</code> and
<code class="reqn">&gt; 1000000</code> for <code>spin = FALSE</code> or <code class="reqn">&gt; 800</code> for
<code>spin = TRUE</code>. These values are difficult to plot <code><a href="#topic+simGG">simGG</a></code>
and may prevent <code>spin</code> from finding the central interval.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>coxsimLinear</code> simulates relative hazards, first differences, and
hazard ratios for linear covariates that are not interacted with time or
nonlinearly transformed from models estimated with <code><a href="survival.html#topic+coxph">coxph</a></code> using
the multivariate normal distribution. These can be plotted with
<code><a href="#topic+simGG">simGG</a></code>.
</p>


<h3>Value</h3>

<p>a <code>simlinear</code>, <code>coxsim</code> object
</p>


<h3>References</h3>

<p>Gandrud, Christopher. 2015. simPH: An R Package for Illustrating
Estimates from Cox Proportional Hazard Models Including for Interactive and
Nonlinear Effects. Journal of Statistical Software. 65(3)1-20.
</p>
<p>Licht, Amanda A. 2011. &rdquo;Change Comes with Time: Substantive
Interpretation of Nonproportional Hazards in Event History Analysis.&rdquo;
Political Analysis 19: 227-43.
</p>
<p>King, Gary, Michael Tomz, and Jason Wittenberg. 2000. &rdquo;Making the Most of
Statistical Analyses: Improving Interpretation and Presentation.&rdquo; American
Journal of Political Science 44(2): 347-61.
</p>
<p>Liu, Ying, Andrew Gelman, and Tian Zheng. 2013. &rdquo;Simulation-Efficient
Shortest Probability Intervals.&rdquo; Arvix.
<a href="https://arxiv.org/pdf/1302.2142v1.pdf">https://arxiv.org/pdf/1302.2142v1.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simGG.simlinear">simGG.simlinear</a></code>, <code><a href="boot.html#topic+survival">survival</a></code>,
<code><a href="survival.html#topic+strata">strata</a></code>, and <code><a href="survival.html#topic+coxph">coxph</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Carpenter (2002) data
data("CarpenterFdaData")

# Load survival package
library(survival)

# Run basic model
M1 &lt;- coxph(Surv(acttime, censor) ~ prevgenx + lethal +
            deathrt1 + acutediz + hosp01  + hhosleng +
            mandiz01 + femdiz01 + peddiz01 + orphdum +
            vandavg3 + wpnoavg3 + condavg3 + orderent +
            stafcder, data = CarpenterFdaData)

# Simulate Hazard Ratios
Sim1 &lt;- coxsimLinear(M1, b = "stafcder",
                     Xj = c(1237, 1600),
                     Xl = c(1000, 1000),
                     qi = "Hazard Ratio",
                     spin = TRUE, ci = 0.99)

## Not run: 
# Simulate Hazard Rates
Sim2 &lt;- coxsimLinear(M1, b = "stafcder",
                      Xj = 1237,
                      ci = 0.99)

## End(Not run)

</code></pre>

<hr>
<h2 id='coxsimPoly'>Simulate quantities of interest for a range of values for a polynomial
nonlinear effect from Cox Proportional Hazards models</h2><span id='topic+coxsimPoly'></span>

<h3>Description</h3>

<p><code>coxsimPoly</code> simulates quantities of interest for polynomial covariate
effects estimated from Cox Proportional Hazards models. These can be plotted
with <code><a href="#topic+simGG">simGG</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coxsimPoly(
  obj,
  b = NULL,
  qi = "Relative Hazard",
  pow = 2,
  Xj = NULL,
  Xl = NULL,
  nsim = 1000,
  ci = 0.95,
  spin = FALSE,
  extremesDrop = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coxsimPoly_+3A_obj">obj</code></td>
<td>
<p>a <code><a href="survival.html#topic+coxph">coxph</a></code> class fitted model object with a polynomial
coefficient. These can be plotted with <code><a href="#topic+simGG">simGG</a></code>.</p>
</td></tr>
<tr><td><code id="coxsimPoly_+3A_b">b</code></td>
<td>
<p>character string name of the coefficient you would like to simulate.
To find the quantity of interest using only the polynomial and not the
polynomial + the linear terms enter the polynomial created using
<code><a href="base.html#topic+I">I</a></code>, e.g. <code>I(natreg^2)</code> as a string.</p>
</td></tr>
<tr><td><code id="coxsimPoly_+3A_qi">qi</code></td>
<td>
<p>quantity of interest to simulate. Values can be
<code>"Relative Hazard"</code>, <code>"First Difference"</code>, <code>"Hazard Ratio"</code>,
and <code>"Hazard Rate"</code>. The default is <code>qi = "Relative Hazard"</code>. If
<code>qi = "Hazard Rate"</code> and the <code>coxph</code> model has strata, then hazard
rates for each strata will also be calculated.</p>
</td></tr>
<tr><td><code id="coxsimPoly_+3A_pow">pow</code></td>
<td>
<p>numeric polynomial used in <code>coxph</code>.</p>
</td></tr>
<tr><td><code id="coxsimPoly_+3A_xj">Xj</code></td>
<td>
<p>numeric vector of fitted values for <code>b</code> to simulate for.</p>
</td></tr>
<tr><td><code id="coxsimPoly_+3A_xl">Xl</code></td>
<td>
<p>numeric vector of values to compare <code>Xj</code> to. If <code>NULL</code>,
then it is automatically set to 0.</p>
</td></tr>
<tr><td><code id="coxsimPoly_+3A_nsim">nsim</code></td>
<td>
<p>the number of simulations to run per value of <code>Xj</code>. Default
is <code>nsim = 1000</code>.</p>
</td></tr>
<tr><td><code id="coxsimPoly_+3A_ci">ci</code></td>
<td>
<p>the proportion of simulations to keep. The default is
<code>ci = 0.95</code>, i.e. keep the middle 95 percent. If <code>spin = TRUE</code>
then <code>ci</code> is the confidence level of the shortest probability interval.
Any value from 0 through 1 may be used.</p>
</td></tr>
<tr><td><code id="coxsimPoly_+3A_spin">spin</code></td>
<td>
<p>logical, whether or not to keep only the shortest probability
interval rather than the middle simulations. Currently not supported for
hazard rates.</p>
</td></tr>
<tr><td><code id="coxsimPoly_+3A_extremesdrop">extremesDrop</code></td>
<td>
<p>logical whether or not to drop simulated quantity of
interest values that are <code>Inf</code>, <code>NA</code>, <code>NaN</code> and
<code class="reqn">&gt; 1000000</code> for <code>spin = FALSE</code> or <code class="reqn">&gt; 800</code> for <code>spin = TRUE</code>.
These values are difficult to plot <code><a href="#topic+simGG">simGG</a></code> and may prevent
<code>spin</code> from finding the central interval.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simulates quantities of interest for polynomial covariate effects.
For example if a nonlinear effect is modeled with a second order
polynomial&ndash;i.e. <code class="reqn">\beta_{1}x_{i} + \beta_{2}x_{i}^{2}</code>&ndash;we can draw <code class="reqn">n</code> simulations from the
multivariate normal distribution for both <code class="reqn">\beta_{1}</code> and
<code class="reqn">\beta_{2}</code>. Then we simply calculate quantities of interest
for a range of values and plot the results as before. For example, we find
the first difference for a second order polynomial with:
</p>
<p style="text-align: center;"><code class="reqn">\%\triangle h_{i}(t) = (\mathrm{e}^{\beta_{1}x_{j-1} +
\beta_{2}x_{j-l}^{2}} - 1) * 100</code>
</p>

<p>where <code class="reqn">x_{j-l} = x_{j} - x_{l}</code>.
</p>
<p>Note, you must use <code><a href="base.html#topic+I">I</a></code> to create the polynomials.
</p>


<h3>Value</h3>

<p>a <code>simpoly</code>, <code>coxsim</code> object
</p>


<h3>References</h3>

<p>Gandrud, Christopher. 2015. simPH: An R Package for Illustrating
Estimates from Cox Proportional Hazard Models Including for Interactive and
Nonlinear Effects. Journal of Statistical Software. 65(3)1-20.
</p>
<p>Keele, Luke. 2010. &rdquo;Proportionally Difficult: Testing for
Nonproportional Hazards in Cox Models.&rdquo; Political Analysis 18(2): 189-205.
</p>
<p>Carpenter, Daniel P. 2002. &rdquo;Groups, the Media, Agency Waiting Costs, and
FDA Drug Approval.&rdquo; American Journal of Political Science 46(3): 490-505.
</p>
<p>King, Gary, Michael Tomz, and Jason Wittenberg. 2000. &rdquo;Making the Most of
Statistical Analyses: Improving Interpretation and Presentation.&rdquo; American
Journal of Political Science 44(2): 347-61.
</p>
<p>Liu, Ying, Andrew Gelman, and Tian Zheng. 2013. &rdquo;Simulation-Efficient
Shortest Probability Intervals.&rdquo; Arvix.
<a href="https://arxiv.org/pdf/1302.2142v1.pdf">https://arxiv.org/pdf/1302.2142v1.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simGG.simpoly">simGG.simpoly</a></code>, <code><a href="boot.html#topic+survival">survival</a></code>,
<code><a href="survival.html#topic+strata">strata</a></code>, and <code><a href="survival.html#topic+coxph">coxph</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Carpenter (2002) data
data("CarpenterFdaData")

# Load survival package
library(survival)

# Run basic model
M1 &lt;- coxph(Surv(acttime, censor) ~ prevgenx + lethal + deathrt1 +
            acutediz + hosp01  + hhosleng + mandiz01 + femdiz01 +
            peddiz01 + orphdum + natreg + I(natreg^2) +
            I(natreg^3) + vandavg3 + wpnoavg3 +
            condavg3 + orderent + stafcder, data = CarpenterFdaData)

# Simulate simpoly First Difference
Sim1 &lt;- coxsimPoly(M1, b = "natreg", qi = "First Difference",
                pow = 3, Xj = seq(1, 150, by = 5), nsim = 100)

## Not run: 
# Simulate simpoly Hazard Ratio with spin probibility interval
Sim2 &lt;- coxsimPoly(M1, b = "natreg", qi = "Hazard Ratio",
              pow = 3, Xj = seq(1, 150, by = 5), spin = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='coxsimSpline'>Simulate quantities of interest for penalized splines from Cox Proportional
Hazards models</h2><span id='topic+coxsimSpline'></span>

<h3>Description</h3>

<p><code>coxsimSpline</code> simulates quantities of interest from penalized splines
using multivariate normal distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coxsimSpline(
  obj,
  bspline,
  bdata,
  qi = "Relative Hazard",
  Xj = 1,
  Xl = 0,
  nsim = 1000,
  ci = 0.95,
  spin = FALSE,
  extremesDrop = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coxsimSpline_+3A_obj">obj</code></td>
<td>
<p>a <code><a href="survival.html#topic+coxph">coxph</a></code> class fitted model object with a penalized
spline. These can be plotted with <code><a href="#topic+simGG">simGG</a></code>.</p>
</td></tr>
<tr><td><code id="coxsimSpline_+3A_bspline">bspline</code></td>
<td>
<p>a character string of the full <code><a href="survival.html#topic+pspline">pspline</a></code> call
used in <code>obj</code>. It should be exactly the same as how you entered it in
<code><a href="survival.html#topic+coxph">coxph</a></code>.</p>
</td></tr>
<tr><td><code id="coxsimSpline_+3A_bdata">bdata</code></td>
<td>
<p>a numeric vector of the splined variable's values.</p>
</td></tr>
<tr><td><code id="coxsimSpline_+3A_qi">qi</code></td>
<td>
<p>quantity of interest to simulate. Values can be
<code>"Relative Hazard"</code>, <code>"First Difference"</code>, <code>"Hazard Ratio"</code>,
and <code>"Hazard Rate"</code>. The default is <code>qi = "Relative Hazard"</code>.
Think carefully before using <code>qi = "Hazard Rate"</code>. You may be creating
very many simulated values which can be very computationally intensive to do.
Adjust the number of simulations per fitted value with <code>nsim</code>.</p>
</td></tr>
<tr><td><code id="coxsimSpline_+3A_xj">Xj</code></td>
<td>
<p>numeric vector of fitted values for <code>b</code> to simulate for.</p>
</td></tr>
<tr><td><code id="coxsimSpline_+3A_xl">Xl</code></td>
<td>
<p>numeric vector of values to compare <code>Xj</code> to. Note if
<code>qi = "Relative Hazard"</code> or <code>"Hazard Rate"</code> only <code>Xj</code> is
relevant.</p>
</td></tr>
<tr><td><code id="coxsimSpline_+3A_nsim">nsim</code></td>
<td>
<p>the number of simulations to run per value of <code>Xj</code>. Default
is <code>nsim = 1000</code>.</p>
</td></tr>
<tr><td><code id="coxsimSpline_+3A_ci">ci</code></td>
<td>
<p>the proportion of simulations to keep. The default is
<code>ci = 0.95</code>, i.e. keep the middle 95 percent. If <code>spin = TRUE</code>
then <code>ci</code> is the confidence level of the shortest probability interval.
Any value from 0 through 1 may be used.</p>
</td></tr>
<tr><td><code id="coxsimSpline_+3A_spin">spin</code></td>
<td>
<p>logical, whether or not to keep only the shortest probability
interval rather than the middle simulations. Currently not supported for
hazard rates.</p>
</td></tr>
<tr><td><code id="coxsimSpline_+3A_extremesdrop">extremesDrop</code></td>
<td>
<p>logical whether or not to drop simulated quantity of
interest values that are <code>Inf</code>, <code>NA</code>, <code>NaN</code> and
<code class="reqn">&gt; 1000000</code> for <code>spin = FALSE</code> or <code class="reqn">&gt; 800</code> for <code>spin = TRUE</code>.
These values are difficult to plot <code><a href="#topic+simGG">simGG</a></code> and may prevent
<code>spin</code> from finding the central interval.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simulates relative hazards, first differences, hazard ratios, and
hazard rates for penalized splines from Cox Proportional Hazards models.
These can be plotted with <code><a href="#topic+simGG">simGG</a></code>.
A Cox PH model with one penalized spline is given by:
</p>
<p style="text-align: center;"><code class="reqn">h(t|\mathbf{X}_{i})=h_{0}(t)\mathrm{e}^{g(x)}</code>
</p>

<p>where <code class="reqn">g(x)</code> is the penalized spline function. For our post-estimation
purposes <code class="reqn">g(x)</code> is basically a series of linearly combined coefficients
such that:
</p>
<p style="text-align: center;"><code class="reqn">g(x) = \beta_{k_{1}}(x)_{1+} + \beta_{k_{2}}(x)_{2+} + \beta_{k_{3}}(x)_{3+} + \ldots + \beta_{k_{n}}(x)_{n+}</code>
</p>

<p>where <code class="reqn">k</code> are the equally spaced spline knots with values inside of the
range of observed <code class="reqn">x</code> and <code class="reqn">n</code> is the number of knots.
</p>
<p>We can again draw values of each <code class="reqn">\beta_{k_{1}},\: \ldots \beta_{k_{n}}</code>
from the multivariate normal distribution
described above. We then use these simulated coefficients to estimates
quantities of interest for a range covariate values. For example, the first
difference between two values <code class="reqn">x_{j}</code> and <code class="reqn">x_{l}</code> is:
</p>
<p style="text-align: center;"><code class="reqn">\%\triangle h_{i}(t) = (\mathrm{e}^{g(x_{j}) - g(x_{l})} - 1) * 100</code>
</p>

<p>FD(h[i](t)) = (exp(g(x[j]) - g(x[l])) - 1) * 100
</p>
<p>Relative hazards and hazard ratios can be calculated by extension.
</p>
<p>Currently <code>coxsimSpline</code> does not support simulating hazard rates form
multiple stratified models.
</p>


<h3>Value</h3>

<p>a <code>simspline</code> object
</p>


<h3>References</h3>

<p>Gandrud, Christopher. 2015. simPH: An R Package for Illustrating
Estimates from Cox Proportional Hazard Models Including for Interactive and
Nonlinear Effects. Journal of Statistical Software. 65(3)1-20.
</p>
<p>Luke Keele, &quot;Replication data for: Proportionally Difficult:
Testing for Nonproportional Hazards In Cox Models&quot;, 2010,
doi: <a href="https://doi.org/10.7910/DVN/VJAHRG">10.7910/DVN/VJAHRG</a> V1 [Version].
</p>
<p>King, Gary, Michael Tomz, and Jason Wittenberg. 2000. &rdquo;Making the Most of
Statistical Analyses: Improving Interpretation and Presentation.&rdquo; American
Journal of Political Science 44(2): 347-61.
</p>
<p>Liu, Ying, Andrew Gelman, and Tian Zheng. 2013. &rdquo;Simulation-Efficient
Shortest Probability Intervals.&rdquo; Arvix.
<a href="https://arxiv.org/pdf/1302.2142v1.pdf">https://arxiv.org/pdf/1302.2142v1.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simGG">simGG</a></code>, <code><a href="boot.html#topic+survival">survival</a></code>, <code><a href="survival.html#topic+strata">strata</a></code>,
and <code><a href="survival.html#topic+coxph">coxph</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Carpenter (2002) data
data("CarpenterFdaData")

# Load survival package
library(survival)

# Run basic model
# From Keele (2010) replication data
M1 &lt;- coxph(Surv(acttime, censor) ~  prevgenx + lethal + deathrt1 +
           acutediz + hosp01  + pspline(hospdisc, df = 4) +
           pspline(hhosleng, df = 4) + mandiz01 + femdiz01 + peddiz01 +
           orphdum + natreg + vandavg3 + wpnoavg3 +
           pspline(condavg3, df = 4) + pspline(orderent, df = 4) +
           pspline(stafcder, df = 4), data = CarpenterFdaData)

## Not run: 
# Simulate Relative Hazards for orderent
Sim1 &lt;- coxsimSpline(M1, bspline = "pspline(stafcder, df = 4)",
                    bdata = CarpenterFdaData$stafcder,
                    qi = "Hazard Ratio",
                    Xj = seq(1100, 1700, by = 10),
                    Xl = seq(1099, 1699, by = 10), spin = TRUE)


## End(Not run)
# Simulate Hazard Rates for orderent
Sim2 &lt;- coxsimSpline(M1, bspline = "pspline(orderent, df = 4)",
                       bdata = CarpenterFdaData$orderent,
                       qi = "Hazard Rate",
                       Xj = seq(2, 53, by = 3), nsim = 100)

</code></pre>

<hr>
<h2 id='coxsimtvc'>Simulate time-interactive quantities of interest from Cox Proportional
Hazards models</h2><span id='topic+coxsimtvc'></span>

<h3>Description</h3>

<p><code>coxsimtvc</code> simulates time-interactive relative hazards, first
differences, and hazard ratios from models estimated with <code><a href="survival.html#topic+coxph">coxph</a></code>
using the multivariate normal distribution. These can be plotted with
<code><a href="#topic+simGG">simGG</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coxsimtvc(
  obj,
  b,
  btvc,
  qi = "Relative Hazard",
  Xj = NULL,
  Xl = NULL,
  tfun = "linear",
  pow = NULL,
  nsim = 1000,
  from,
  to,
  by = 1,
  ci = 0.95,
  spin = FALSE,
  extremesDrop = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coxsimtvc_+3A_obj">obj</code></td>
<td>
<p>a <code><a href="survival.html#topic+coxph">coxph</a></code> fitted model object with a time interaction.</p>
</td></tr>
<tr><td><code id="coxsimtvc_+3A_b">b</code></td>
<td>
<p>the non-time interacted variable's name.</p>
</td></tr>
<tr><td><code id="coxsimtvc_+3A_btvc">btvc</code></td>
<td>
<p>the time interacted variable's name.</p>
</td></tr>
<tr><td><code id="coxsimtvc_+3A_qi">qi</code></td>
<td>
<p>character string indicating what quantity of interest you would
like to calculate. Can be <code>'Relative Hazard'</code>,
<code>'First Difference'</code>, <code>'Hazard Ratio'</code>, <code>'Hazard Rate'</code>.
Default is <code>qi = 'Relative Hazard'</code>. If <code>qi = 'First Difference'</code>
or <code>qi = 'Hazard Ratio'</code> then you can set <code>Xj</code> and <code>Xl</code>.</p>
</td></tr>
<tr><td><code id="coxsimtvc_+3A_xj">Xj</code></td>
<td>
<p>numeric vector of fitted values for <code>b</code>. Must be the same
length as <code>Xl</code> or <code>Xl</code> must be <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="coxsimtvc_+3A_xl">Xl</code></td>
<td>
<p>numeric vector of fitted values for Xl. Must be the same length as
<code>Xj</code>. Only applies if <code>qi = 'First Difference'</code> or
<code>qi = 'Hazard Ratio'</code>.</p>
</td></tr>
<tr><td><code id="coxsimtvc_+3A_tfun">tfun</code></td>
<td>
<p>function of time that btvc was multiplied by. Default is
&quot;linear&quot;. It can also be &quot;log&quot; (natural log) and &quot;power&quot;. If
<code>tfun = "power"</code> then the pow argument needs to be specified also.</p>
</td></tr>
<tr><td><code id="coxsimtvc_+3A_pow">pow</code></td>
<td>
<p>if <code>tfun = "power"</code>, then use pow to specify what power the
time interaction was raised to.</p>
</td></tr>
<tr><td><code id="coxsimtvc_+3A_nsim">nsim</code></td>
<td>
<p>the number of simulations to run per point in time. Default is
<code>nsim = 1000</code>.</p>
</td></tr>
<tr><td><code id="coxsimtvc_+3A_from">from</code></td>
<td>
<p>point in time from when to begin simulating coefficient values</p>
</td></tr>
<tr><td><code id="coxsimtvc_+3A_to">to</code></td>
<td>
<p>point in time to stop simulating coefficient values.</p>
</td></tr>
<tr><td><code id="coxsimtvc_+3A_by">by</code></td>
<td>
<p>time intervals by which to simulate coefficient values.</p>
</td></tr>
<tr><td><code id="coxsimtvc_+3A_ci">ci</code></td>
<td>
<p>the proportion of simulations to keep. The default is
<code>ci = 0.95</code>, i.e. keep the middle 95 percent. If <code>spin = TRUE</code>
then <code>ci</code> is the confidence level of the shortest probability interval.
Any value from 0 through 1 may be used.</p>
</td></tr>
<tr><td><code id="coxsimtvc_+3A_spin">spin</code></td>
<td>
<p>logical, whether or not to keep only the shortest probability
interval rather than the middle simulations. Currently not supported for
hazard rates.</p>
</td></tr>
<tr><td><code id="coxsimtvc_+3A_extremesdrop">extremesDrop</code></td>
<td>
<p>logical whether or not to drop simulated quantity of
interest values that are <code>Inf</code>, <code>NA</code>, <code>NaN</code> and
<code class="reqn">&gt; 1000000</code> for <code>spin = FALSE</code> or <code class="reqn">&gt; 800</code> for
<code>spin = TRUE</code>.
These values are difficult to plot <code><a href="#topic+simGG">simGG</a></code> and may prevent
<code>spin</code> from finding the central interval.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simulates time-varying relative hazards, first differences, and
hazard ratios using parameter estimates from <code>coxph</code> models. Can also
simulate hazard rates for multiple strata.
</p>
<p>Relative hazards are found using:
</p>
<p style="text-align: center;"><code class="reqn">RH = e^{\beta_{1} + \beta_{2}f(t)}</code>
</p>

<p>where <code class="reqn">f(t)</code> is the function of time.
</p>
<p>First differences are found using:
</p>
<p style="text-align: center;"><code class="reqn">FD = (e^{(X_{j} - X_{l}) (\beta_{1} + \beta_{2}f(t))} - 1) * 100</code>
</p>

<p>where <code class="reqn">X_{j}</code> and <code class="reqn">X_{l}</code> are some values of <code class="reqn">X</code> to
contrast.
</p>
<p>Hazard ratios are calculated using:
</p>
<p style="text-align: center;"><code class="reqn">FD = e^{(X_{j} - X_{l}) (\beta_{1} + \beta_{2}f(t))}</code>
</p>

<p>When simulating non-stratifed time-varying harzards <code>coxsimtvc</code> uses
the point estimates for a given coefficient <code class="reqn">\hat{\beta}_{x}</code> and its time interaction <code class="reqn">\hat{\beta}_{xt}</code>
along with the variance matrix (<code class="reqn">\hat{V}(\hat{\beta})</code>)
estimated from a <code>coxph</code> model. These are used to draw values of
<code class="reqn">\beta_{1}</code> and <code class="reqn">\beta_{2}</code> from the
multivariate normal distribution <code class="reqn">N(\hat{\beta},\: \hat{V}(\hat{\beta}))</code>.
</p>
<p>When simulating stratified time-varying hazard rates <code class="reqn">H</code> for a given
strata <code class="reqn">k</code>, <code>coxsimtvc</code> uses:
</p>
<p style="text-align: center;"><code class="reqn">H_{kxt} = \hat{\beta}_{k0t}e^{\hat{\beta_{1}} + \beta_{2}f(t)}</code>
</p>

<p>The resulting simulation values can be plotted using <code><a href="#topic+simGG">simGG</a></code>.
</p>


<h3>Value</h3>

<p>a <code>simtvc</code> object
</p>


<h3>References</h3>

<p>Gandrud, Christopher. 2015. simPH: An R Package for Illustrating
Estimates from Cox Proportional Hazard Models Including for Interactive and
Nonlinear Effects. Journal of Statistical Software. 65(3)1-20.
</p>
<p>Golub, Jonathan, and Bernard Steunenberg. 2007. &rdquo;How Time
Affects EU Decision-Making.&rdquo; European Union Politics 8(4): 555-66.
</p>
<p>Licht, Amanda A. 2011. &rdquo;Change Comes with Time: Substantive Interpretation
of Nonproportional Hazards in Event History Analysis.&rdquo; Political Analysis
19: 227-43.
</p>
<p>King, Gary, Michael Tomz, and Jason Wittenberg. 2000. &rdquo;Making the Most of
Statistical Analyses: Improving Interpretation and Presentation.&rdquo; American
Journal of Political Science 44(2): 347-61.
</p>
<p>Liu, Ying, Andrew Gelman, and Tian Zheng. 2013. &rdquo;Simulation-Efficient
Shortest Probability Intervals.&rdquo; Arvix.
<a href="https://arxiv.org/pdf/1302.2142v1.pdf">https://arxiv.org/pdf/1302.2142v1.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simGG">simGG</a></code>, <code><a href="boot.html#topic+survival">survival</a></code>, <code><a href="survival.html#topic+strata">strata</a></code>,
and <code><a href="survival.html#topic+coxph">coxph</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load Golub &amp; Steunenberg (2007) Data
data("GolubEUPData")

# Load survival package
library(survival)

# Expand data (not run to speed processing time, but should be run)
GolubEUPData &lt;- SurvExpand(GolubEUPData, GroupVar = 'caseno',
                     Time = 'begin', Time2 = 'end', event = 'event')

# Create time interactions
BaseVars &lt;- c('qmv', 'backlog', 'coop', 'codec', 'qmvpostsea', 'thatcher')
GolubEUPData &lt;- tvc(GolubEUPData, b = BaseVars, tvar = 'end', tfun = 'log')

# Run Cox PH Model
M1 &lt;- coxph(Surv(begin, end, event) ~ qmv + qmvpostsea + qmvpostteu +
                coop + codec + eu9 + eu10 + eu12 + eu15 + thatcher +
                agenda + backlog + qmv_log + qmvpostsea_log + coop_log +
                codec_log + thatcher_log + backlog_log,
            data = GolubEUPData, ties = "efron")

# Create simtvc object for Relative Hazard
Sim1 &lt;- coxsimtvc(obj = M1, b = "qmv", btvc = "qmv_log",
                   tfun = "log", from = 80, to = 2000,
                   Xj = 1, by = 15, ci = 0.99, nsim = 100)

# Create simtvc object for First Difference
Sim2 &lt;- coxsimtvc(obj = M1, b = "qmv", btvc = "qmv_log",
                 qi = "First Difference", Xj = 1,
                 tfun = "log", from = 80, to = 2000,
                 by = 15, ci = 0.95)

# Create simtvc object for Hazard Ratio
Sim3 &lt;- coxsimtvc(obj = M1, b = "backlog", btvc = "backlog_log",
                  qi = "Hazard Ratio", Xj = c(191, 229),
                  Xl = c(0, 0),
                  tfun = "log", from = 80, to = 2000,
                  by = 15, ci = 0.5)

## End(Not run)

</code></pre>

<hr>
<h2 id='ggfitStrata'>Graph fitted stratified survival curves from Cox Proportional Hazards models</h2><span id='topic+ggfitStrata'></span>

<h3>Description</h3>

<p>This function largely improves <code><a href="survival.html#topic+plot.survfit">plot.survfit</a></code>. It
plots the curves using ggplot2 rather than base R graphics. One major
advantage is the ability to split the survival curves into multiple plots and
arrange them in a grid. This makes it easier to examine many strata at once.
Otherwise they can be very bunched up.
</p>
<p>Note: the strata legend labels need to be changed manually (see
<code>revalue</code>) in the <code>survfit</code> object with the <code>strata</code>
component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggfitStrata(
  obj,
  byStrata = FALSE,
  xlab = "",
  ylab = "",
  title = "",
  lcolour = "#2C7FB8",
  rcolour = "#2C7FB8"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggfitStrata_+3A_obj">obj</code></td>
<td>
<p>a <code>survfit</code> object.</p>
</td></tr>
<tr><td><code id="ggfitStrata_+3A_bystrata">byStrata</code></td>
<td>
<p>logical, whether or not you want to include all of the
stratified survival curves on one plot or separate them into a grid arranged
plot.</p>
</td></tr>
<tr><td><code id="ggfitStrata_+3A_xlab">xlab</code></td>
<td>
<p>a label for the plot's x-axis</p>
</td></tr>
<tr><td><code id="ggfitStrata_+3A_ylab">ylab</code></td>
<td>
<p>a label of the plot's y-axis</p>
</td></tr>
<tr><td><code id="ggfitStrata_+3A_title">title</code></td>
<td>
<p>plot title.</p>
</td></tr>
<tr><td><code id="ggfitStrata_+3A_lcolour">lcolour</code></td>
<td>
<p>line color. Currently only works if <code>byStrata = TRUE</code>.
The default it <code>lcolour = "#2C7FB8"</code> (a bluish hexadecimal colour)</p>
</td></tr>
<tr><td><code id="ggfitStrata_+3A_rcolour">rcolour</code></td>
<td>
<p>confidence bounds ribbon color. Either a single color or a
vector of colours. The default it <code>lcolour = "#2C7FB8"</code>
(a bluish hexadecimal colour)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ggfitStrata</code> graphs fitted survival curves created with
<code><a href="survival.html#topic+survfit">survfit</a></code> using ggplot2.
</p>


<h3>See Also</h3>

<p><code><a href="survival.html#topic+survfit">survfit</a></code>, <code>ggplot2</code> and
<code><a href="survival.html#topic+strata">strata</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load packages
library(survival)
library(simPH)

# Subset data
bladder1 &lt;- bladder[bladder$enum &lt; 5, ]

# Estimate coxph model (note that this model is for code illustration only)
M1 &lt;- coxph(Surv(stop, event) ~ (rx + size + number) + strata(enum) +
                cluster(id), bladder1)

# Find predicted values
M1Fit &lt;- survfit(M1)

# Plot strata in a grid
ggfitStrata(M1Fit, byStrata = TRUE)

# Plot all in one
ggfitStrata(M1Fit, byStrata = FALSE)

</code></pre>

<hr>
<h2 id='GolubEUPData'>A data set from Golub &amp; Steunenberg (2007)</h2><span id='topic+GolubEUPData'></span>

<h3>Description</h3>

<p>A data set from Golub &amp; Steunenberg (2007)
</p>


<h3>Format</h3>

<p>A data set with 3001 observations and 17 variables.
</p>


<h3>Source</h3>

<p>Golub, Jonathan, and Bernard Steunenberg. 2007. &rdquo;How Time Affects 
EU Decision-Making.&rdquo; European Union Politics 8(4): 555-66.
</p>
<p>Amanda A. Licht, 2011, &quot;Replication data for: Change Comes with Time&quot;. 
doi: <a href="https://doi.org/10.7910/DVN/VJAHRG">10.7910/DVN/VJAHRG</a>. IQSS Dataverse Network 
[Distributor] V3 [Version].
</p>

<hr>
<h2 id='hmohiv'>Simulated HIV patient data from UCLA IDRE</h2><span id='topic+hmohiv'></span>

<h3>Description</h3>

<p>Simulated HIV patient data from UCLA IDRE
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hmohiv
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 100 rows and 7 columns.
</p>


<h3>Source</h3>

<p>UCLA IDRE <a href="https://stats.idre.ucla.edu/r/examples/asa/r-applied-survival-analysis-ch-1/">https://stats.idre.ucla.edu/r/examples/asa/r-applied-survival-analysis-ch-1/</a>
</p>

<hr>
<h2 id='MinMaxLines'>Transform the simulation object to include only the min and max of the
constricted intervals, as well as the lower and upper bounds of the middle 50
percent of the constricted intervals</h2><span id='topic+MinMaxLines'></span>

<h3>Description</h3>

<p><code>MinMaxLines</code> is an internal function to transform the simulation
object to include only the min and max of the intervals set by <code>ci</code> in
the <code>coxsim</code> command, as well as the lower and upper bounds of the
middle 50 percent of these intervals. It also returns the medians.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MinMaxLines(df, byVars = "Xj", hr = FALSE, strata = FALSE, clean = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MinMaxLines_+3A_df">df</code></td>
<td>
<p>a data frame or a simulation class object.</p>
</td></tr>
<tr><td><code id="MinMaxLines_+3A_byvars">byVars</code></td>
<td>
<p>character vector of the variables to subset the data frame by.
The default is <code>'Xj'</code>.</p>
</td></tr>
<tr><td><code id="MinMaxLines_+3A_hr">hr</code></td>
<td>
<p>logical indicating whether or not <code>df</code> contains a hazard rate.</p>
</td></tr>
<tr><td><code id="MinMaxLines_+3A_strata">strata</code></td>
<td>
<p>logical indicating whether or not <code>df</code> contains a
stratified hazard rate.</p>
</td></tr>
<tr><td><code id="MinMaxLines_+3A_clean">clean</code></td>
<td>
<p>logical, whether or not to clean up the output data frame to
only include <code>byVars</code>, <code>Min_CI</code>, <code>Lower50_CI</code>, <code>median</code>,
<code>Upper50_CI</code>, <code>Max_CI</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Load Carpenter (2002) data
data("CarpenterFdaData")

# Load survival package
library(survival)

# Run basic model
M1 &lt;- coxph(Surv(acttime, censor) ~ prevgenx + lethal +
           deathrt1 + acutediz + hosp01  + hhosleng +
           mandiz01 + femdiz01 + peddiz01 + orphdum +
           vandavg3 + wpnoavg3 + condavg3 + orderent +
           stafcder, data = CarpenterFdaData)

 # Simulate Hazard Ratios
 Sim1 &lt;- coxsimLinear(M1, b = "stafcder",
                      Xj = c(1237, 1600),
                      Xl = c(1000, 1000),
                      qi = "Hazard Ratio",
                      spin = TRUE, ci = 0.99)

# Find summary statistics of the constricted interval
Sum &lt;- MinMaxLines(Sim1, clean = TRUE)

</code></pre>

<hr>
<h2 id='setXl'>Create a sequence of Xl values</h2><span id='topic+setXl'></span>

<h3>Description</h3>

<p><code>setXl</code> creates a sequence of <code>Xl</code> values given a sequence of
<code>Xj</code> values and a fixed difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setXl(Xj, diff = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setXl_+3A_xj">Xj</code></td>
<td>
<p>numeric vector of fitted values for the covariate of interest to
simulate for.</p>
</td></tr>
<tr><td><code id="setXl_+3A_diff">diff</code></td>
<td>
<p>numeric vector of length 1. It specifies the difference between
<code>Xj</code> and <code>Xl</code>. <code>Xl</code> is always smaller than <code>Xj</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set Xj
setXj = seq(1100, 1700, by = 10)

# Find Xl that are 1 less than Xj
setXl(Xj = setXj, diff = 1)
</code></pre>

<hr>
<h2 id='simGG'>A method for plotting simulation objects created by simPH</h2><span id='topic+simGG'></span>

<h3>Description</h3>

<p><code>simGG</code> a method for ploting simulation objects created by simPH.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simGG(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simGG_+3A_obj">obj</code></td>
<td>
<p>an object created by one of simPH's simulation commands.</p>
</td></tr>
<tr><td><code id="simGG_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Gandrud, Christopher. 2015. simPH: An R Package for Illustrating
Estimates from Cox Proportional Hazard Models Including for Interactive and
Nonlinear Effects. Journal of Statistical Software. 65(3)1-20.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simGG.siminteract">simGG.siminteract</a></code>, <code><a href="#topic+simGG.simtvc">simGG.simtvc</a></code>,
<code><a href="#topic+simGG.simlinear">simGG.simlinear</a></code>, <code><a href="#topic+simGG.simpoly">simGG.simpoly</a></code>,
<code><a href="#topic+simGG.simspline">simGG.simspline</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
 # Load Carpenter (2002) data
data("CarpenterFdaData")

# Load survival package
library(survival)

# Run basic model
M1 &lt;- coxph(Surv(acttime, censor) ~ lethal*prevgenx,
            data = CarpenterFdaData)

# Simulate Marginal Effect of lethal for multiple
# values of prevgenx
Sim1 &lt;- coxsimInteract(M1, b1 = "lethal", b2 = "prevgenx",
                       X2 = seq(2, 115, by = 5), spin = TRUE)

# Plot simulations
simGG(Sim1)

## End(Not run)

</code></pre>

<hr>
<h2 id='simGG.siminteract'>Plot simulated linear multiplicative interactions from Cox Proportional
Hazards Models</h2><span id='topic+simGG.siminteract'></span>

<h3>Description</h3>

<p><code>simGG.siminteract</code> uses ggplot2 to plot the quantities of
interest from <code>siminteract</code> objects, including marginal effects, first
differences, hazard ratios, and hazard rates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'siminteract'
simGG(
  obj,
  from = NULL,
  rug = TRUE,
  rug_position = "identity",
  to = NULL,
  xlab = NULL,
  ylab = NULL,
  title = NULL,
  method = "auto",
  spalette = "Set1",
  legend = "legend",
  leg.name = "",
  lcolour = "#2B8CBE",
  lsize = 1,
  pcolour = "#A6CEE3",
  psize = 1,
  alpha = 0.2,
  type = "ribbons",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simGG.siminteract_+3A_obj">obj</code></td>
<td>
<p>a <code>siminteract</code> class object</p>
</td></tr>
<tr><td><code id="simGG.siminteract_+3A_from">from</code></td>
<td>
<p>numeric time to start the plot from. Only relevant if
<code>qi = "Hazard Rate"</code>.</p>
</td></tr>
<tr><td><code id="simGG.siminteract_+3A_rug">rug</code></td>
<td>
<p>logical indicating whether or not to include a rug plot showing
the distribution of values in the sample used to estimate the <code>coxph</code>
model. Only relevant when the quantity of interest is not
<code>"Hazard Rate"</code>.</p>
</td></tr>
<tr><td><code id="simGG.siminteract_+3A_rug_position">rug_position</code></td>
<td>
<p>character string. The position adjustment to use for
overlapping points in the rug plot. Use <code>"jitter"</code> to jitter the points.</p>
</td></tr>
<tr><td><code id="simGG.siminteract_+3A_to">to</code></td>
<td>
<p>numeric time to plot to. Only relevant if
<code>qi = "Hazard Rate"</code>.</p>
</td></tr>
<tr><td><code id="simGG.siminteract_+3A_xlab">xlab</code></td>
<td>
<p>a label for the plot's x-axis.</p>
</td></tr>
<tr><td><code id="simGG.siminteract_+3A_ylab">ylab</code></td>
<td>
<p>a label of the plot's y-axis. The default uses the value of
<code>qi</code>.</p>
</td></tr>
<tr><td><code id="simGG.siminteract_+3A_title">title</code></td>
<td>
<p>the plot's main title.</p>
</td></tr>
<tr><td><code id="simGG.siminteract_+3A_method">method</code></td>
<td>
<p>what type of smoothing method to use to summarize the center
of the simulation distribution.</p>
</td></tr>
<tr><td><code id="simGG.siminteract_+3A_spalette">spalette</code></td>
<td>
<p>colour palette for when there are multiple sets of
comparisons to plot. Not relevant for <code>qi = "Marginal Effect"</code>. Default
palette is <code>"Set1"</code>. See <code><a href="ggplot2.html#topic+scale_colour_brewer">scale_colour_brewer</a></code>.</p>
</td></tr>
<tr><td><code id="simGG.siminteract_+3A_legend">legend</code></td>
<td>
<p>specifies what type of legend to include (if applicable). The
default is <code>legend = "legend"</code>. To hide the legend use
<code>legend = FALSE</code>. See the <code><a href="ggplot2.html#topic+discrete_scale">discrete_scale</a></code> for more details.</p>
</td></tr>
<tr><td><code id="simGG.siminteract_+3A_leg.name">leg.name</code></td>
<td>
<p>name of the legend (if applicable).</p>
</td></tr>
<tr><td><code id="simGG.siminteract_+3A_lcolour">lcolour</code></td>
<td>
<p>character string colour of the smoothing line. The default is
hexadecimal colour <code>lcolour = '#2B8CBE'</code>. Only relevant if
<code>qi = "Marginal Effect"</code>.</p>
</td></tr>
<tr><td><code id="simGG.siminteract_+3A_lsize">lsize</code></td>
<td>
<p>size of the smoothing line. Default is 1. See
<code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="simGG.siminteract_+3A_pcolour">pcolour</code></td>
<td>
<p>character string colour of the simulated points or ribbons
(when there are not multiple sets of simulations). Default is hexadecimal
colour <code>pcolour = '#A6CEE3'</code>.</p>
</td></tr>
<tr><td><code id="simGG.siminteract_+3A_psize">psize</code></td>
<td>
<p>size of the plotted simulation points. Default is
<code>psize = 1</code>. See <code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="simGG.siminteract_+3A_alpha">alpha</code></td>
<td>
<p>numeric. Alpha (e.g. transparency) for the points, lines, or
ribbons. Default is <code>alpha = 0.2</code>. See <code>ggplot2</code>. Note, if
<code>type = "lines"</code> or <code>type = "points"</code> then <code>alpah</code> sets the
maximum value per line or point at the center of the distribution. Lines or
points further from the center are more transparent the further they get
from the middle.</p>
</td></tr>
<tr><td><code id="simGG.siminteract_+3A_type">type</code></td>
<td>
<p>character string. Specifies how to plot the simulations. Can be
<code>points</code>, <code>lines</code>, or <code>ribbons</code>. If points then each
simulation value will be plotted. If <code>lines</code> is chosen then each
simulation is plotted using a different line. Note: any simulation with a
value along its length that is outside of the specified central interval
will be dropped. This is to create a smooth plot. If <code>type = "ribbons"</code>
a plot will be created with shaded areas ('ribbons') for the minimum and
maximum simulation values (i.e. the middle interval set with <code>qi</code> in
<code><a href="#topic+coxsimSpline">coxsimSpline</a></code>) as well as the central 50 percent of this area.
It also plots a line for the median value of the full area, so values in
<code>method</code> are ignored. One of the key advantages of using ribbons
rather than points is that it creates plots with smaller file sizes.</p>
</td></tr>
<tr><td><code id="simGG.siminteract_+3A_...">...</code></td>
<td>
<p>Additional arguments. (Currently ignored.)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses ggplot2 to plot the quantities of interest from
<code>siminteract</code> objects, including marginal effects, first differences,
hazard ratios, and hazard rates. If there are multiple strata, the quantities
of interest will be plotted in a grid by strata.
</p>
<p>Note: A dotted line is created at y = 1 (0 for first difference), i.e. no
effect, for time-varying hazard ratio graphs. No line is created for hazard
rates.
</p>
<p>Note: if <code>qi = "Hazard Ratio"</code> or <code>qi = "First Difference"</code> then
you need to have choosen more than one fitted value for <code>X1</code> in
<code><a href="#topic+coxsimInteract">coxsimInteract</a></code>.
</p>


<h3>Value</h3>

<p>a <code>gg</code> <code>ggplot</code> class object
</p>


<h3>References</h3>

<p>Gandrud, Christopher. 2015. simPH: An R Package for Illustrating
Estimates from Cox Proportional Hazard Models Including for Interactive and
Nonlinear Effects. Journal of Statistical Software. 65(3)1-20.
</p>
<p>Brambor, Thomas, William Roberts Clark, and Matt Golder. 2006.
&rdquo;Understanding Interaction Models: Improving Empirical Analyses.&rdquo; Political
Analysis 14(1): 63-82.
</p>
<p>Keele, Luke. 2010. &rdquo;Proportionally Difficult: Testing for Nonproportional
Hazards in Cox Models.&rdquo; Political Analysis 18(2): 189-205.
</p>
<p>Carpenter, Daniel P. 2002. &rdquo;Groups, the Media, Agency Waiting Costs, and
FDA Drug Approval.&rdquo; American Journal of Political Science 46(3): 490-505.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coxsimInteract">coxsimInteract</a></code>, <code><a href="#topic+simGG.simlinear">simGG.simlinear</a></code>,
and <code>ggplot2</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Carpenter (2002) data
data("CarpenterFdaData")

# Load survival package
library(survival)

# Run basic model
M1 &lt;- coxph(Surv(acttime, censor) ~ lethal*prevgenx,
            data = CarpenterFdaData)

# Simulate Marginal Effect of lethal for multiple values of prevgenx
Sim1 &lt;- coxsimInteract(M1, b1 = "lethal", b2 = "prevgenx",
                     X2 = seq(2, 115, by = 2), nsim = 100)

# Plot quantities of interest
simGG(Sim1)
simGG(Sim1, rug_position = 'jitter')

## Not run: 
# Change the order of the covariates to make a more easily
# interpretable hazard ratio graph.
M2 &lt;- coxph(Surv(acttime, censor) ~ prevgenx*lethal,
             data = CarpenterFdaData)

# Simulate Hazard Ratio of lethal for multiple values of prevgenx
Sim2 &lt;- coxsimInteract(M2, b1 = "prevgenx", b2 = "lethal",
                    X1 = seq(2, 115, by = 2),
                    X2 = c(0, 1),
                    qi = "Hazard Ratio", ci = 0.9)

# Simulate First Difference
Sim3 &lt;- coxsimInteract(M2, b1 = "prevgenx", b2 = "lethal",
                       X1 = seq(2, 115, by = 2),
                       X2 = c(0, 1),
                       qi = "First Difference", spin = TRUE)

# Simulate Hazard Rate
Sim4 &lt;- coxsimInteract(M2, b1 = "prevgenx", b2 = "lethal",
                       X1 = 100, X2 = 1, qi = "Hazard Rate")

# Plot quantities of interest
simGG(Sim1, xlab = "\nprevgenx",
       ylab = "Marginal Effect of lethal\n")
simGG(Sim2, type = 'ribbons', rug_position = 'jitter')
simGG(Sim3)
simGG(Sim4, to = 150, type = 'lines', legend = FALSE)

## End(Not run)

</code></pre>

<hr>
<h2 id='simGG.simlinear'>Plot simulated linear, non-time interacted quantities of interest from Cox
Proportional Hazards Models</h2><span id='topic+simGG.simlinear'></span>

<h3>Description</h3>

<p><code>simGG.simlinear</code> uses ggplot2 to plot the quantities of interest
from <code>simlinear</code> objects, including relative hazards, first
differences, hazard ratios, and hazard rates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simlinear'
simGG(
  obj,
  from = NULL,
  to = NULL,
  rug = TRUE,
  rug_position = "identity",
  xlab = NULL,
  ylab = NULL,
  title = NULL,
  method = "auto",
  spalette = "Set1",
  legend = "legend",
  leg.name = "",
  lcolour = "#2B8CBE",
  lsize = 1,
  pcolour = "#A6CEE3",
  psize = 1,
  alpha = 0.2,
  type = "ribbons",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simGG.simlinear_+3A_obj">obj</code></td>
<td>
<p>a <code>simlinear</code> class object.</p>
</td></tr>
<tr><td><code id="simGG.simlinear_+3A_from">from</code></td>
<td>
<p>numeric time to start the plot from. Only relevant if
<code>qi = "Hazard Rate"</code>.</p>
</td></tr>
<tr><td><code id="simGG.simlinear_+3A_to">to</code></td>
<td>
<p>numeric time to plot to. Only relevant if
<code>qi = "Hazard Rate"</code>.</p>
</td></tr>
<tr><td><code id="simGG.simlinear_+3A_rug">rug</code></td>
<td>
<p>logical indicating whether or not to include a rug plot showing
the distribution of values in the sample used to estimate the <code>coxph</code>
model. Only relevant when the quantity of interest is not
<code>"Hazard Rate"</code>.</p>
</td></tr>
<tr><td><code id="simGG.simlinear_+3A_rug_position">rug_position</code></td>
<td>
<p>character string. The position adjustment to use for
overlapping points in the rug plot. Use <code>"jitter"</code> to jitter the points.</p>
</td></tr>
<tr><td><code id="simGG.simlinear_+3A_xlab">xlab</code></td>
<td>
<p>a label for the plot's x-axis.</p>
</td></tr>
<tr><td><code id="simGG.simlinear_+3A_ylab">ylab</code></td>
<td>
<p>a label of the plot's y-axis. The default uses the value of
<code>qi</code>.</p>
</td></tr>
<tr><td><code id="simGG.simlinear_+3A_title">title</code></td>
<td>
<p>the plot's main title.</p>
</td></tr>
<tr><td><code id="simGG.simlinear_+3A_method">method</code></td>
<td>
<p>what type of smoothing method to use to summarize the center
of the simulation distribution.</p>
</td></tr>
<tr><td><code id="simGG.simlinear_+3A_spalette">spalette</code></td>
<td>
<p>colour palette for when there are multiple sets of
comparisons to plot. Default palette is <code>"Set1"</code>. See
<code><a href="ggplot2.html#topic+scale_colour_brewer">scale_colour_brewer</a></code>.</p>
</td></tr>
<tr><td><code id="simGG.simlinear_+3A_legend">legend</code></td>
<td>
<p>specifies what type of legend to include (if applicable).
The default is <code>legend = "legend"</code>. To hide the legend use
<code>legend = FALSE</code>. See the <code><a href="ggplot2.html#topic+discrete_scale">discrete_scale</a></code> for more details.</p>
</td></tr>
<tr><td><code id="simGG.simlinear_+3A_leg.name">leg.name</code></td>
<td>
<p>name of the legend (if applicable).</p>
</td></tr>
<tr><td><code id="simGG.simlinear_+3A_lcolour">lcolour</code></td>
<td>
<p>character string colour of the smoothing line. The default is
hexadecimal colour <code>lcolour = '#2B8CBE'</code>. Only relevant if
<code>qi = "First Difference"</code>.</p>
</td></tr>
<tr><td><code id="simGG.simlinear_+3A_lsize">lsize</code></td>
<td>
<p>size of the smoothing line. Default is 1. See
<code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="simGG.simlinear_+3A_pcolour">pcolour</code></td>
<td>
<p>character string colour of the simulated points or ribbons
(when there are not multiple sets of simulations). Default is hexadecimal
colour <code>pcolour = '#A6CEE3'</code>.</p>
</td></tr>
<tr><td><code id="simGG.simlinear_+3A_psize">psize</code></td>
<td>
<p>size of the plotted simulation points. Default is
<code>psize = 1</code>. See <code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="simGG.simlinear_+3A_alpha">alpha</code></td>
<td>
<p>numeric. Alpha (e.g. transparency) for the points, lines, or
ribbons. Default is <code>alpha = 0.2</code>. See <code>ggplot2</code>. Note, if
<code>type = "lines"</code> or <code>type = "points"</code> then <code>alpah</code> sets the
maximum value per line or point at the center of the distribution. Lines or
points further from the center are more transparent the further they get from
the middle.</p>
</td></tr>
<tr><td><code id="simGG.simlinear_+3A_type">type</code></td>
<td>
<p>character string. Specifies how to plot the simulations. Can be
<code>points</code>, <code>lines</code>, or <code>ribbons</code>. If points then each
simulation value will be plotted. If <code>lines</code> is chosen then each
simulation is plotted using a different line. Note: any simulation with a
value along its length that is outside of the specified central interval will
be dropped. This is to create a smooth plot. If <code>type = "ribbons"</code> a
plot will be created with shaded areas ('ribbons') for the minimum and
maximum simulation values (i.e. the middle interval set with <code>qi</code> in
<code><a href="#topic+coxsimSpline">coxsimSpline</a></code>) as well as the central 50 percent of this area.
It also plots a line for the median value of the full area, so values in
<code>method</code> are ignored. One of the key advantages of using ribbons
rather than points is that it creates plots with smaller file sizes.</p>
</td></tr>
<tr><td><code id="simGG.simlinear_+3A_...">...</code></td>
<td>
<p>Additional arguments. (Currently ignored.)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses ggplot2 to plot the quantities of interest from
<code>simlinear</code> objects, including relative hazards, first differences,
hazard ratios, and hazard rates. If there are multiple strata, the
quantities of interest will be plotted in a grid by strata.
Note: A dotted line is created at y = 1 (0 for first difference), i.e. no
effect, for time-varying hazard ratio graphs. No line is created for hazard
rates.
</p>


<h3>Value</h3>

<p>a <code>gg</code> <code>ggplot</code> class object
</p>


<h3>References</h3>

<p>Gandrud, Christopher. 2015. simPH: An R Package for Illustrating
Estimates from Cox Proportional Hazard Models Including for Interactive and
Nonlinear Effects. Journal of Statistical Software. 65(3)1-20.
</p>
<p>Licht, Amanda A. 2011. &rdquo;Change Comes with Time: Substantive
Interpretation of Nonproportional Hazards in Event History Analysis.&rdquo;
Political Analysis 19: 227-43.
</p>
<p>Keele, Luke. 2010. &rdquo;Proportionally Difficult: Testing for Nonproportional
Hazards in Cox Models.&rdquo; Political Analysis 18(2): 189-205.
</p>
<p>Carpenter, Daniel P. 2002. &rdquo;Groups, the Media, Agency Waiting Costs, and
FDA Drug Approval.&rdquo; American Journal of Political Science 46(3): 490-505.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coxsimLinear">coxsimLinear</a></code>, <code><a href="#topic+simGG.simtvc">simGG.simtvc</a></code>, and
<code>ggplot2</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load survival package
library(survival)
# Load Carpenter (2002) data
data("CarpenterFdaData")

# Estimate basic model
M1 &lt;- coxph(Surv(acttime, censor) ~ prevgenx + lethal +
            deathrt1 + acutediz + hosp01  + hhosleng +
            mandiz01 + femdiz01 + peddiz01 + orphdum +
            vandavg3 + wpnoavg3 + condavg3 + orderent +
            stafcder, data = CarpenterFdaData)

# Simulate and plot Hazard Ratios for stafcder variable
Sim1 &lt;- coxsimLinear(M1, b = "stafcder",
                     Xj = c(1237, 1600),
                     Xl = c(1000, 1000),
                     qi = "Hazard Ratio",
                     spin = TRUE, ci = 0.99)
simGG(Sim1, method = 'lm', rug_position = 'jitter')
simGG(Sim1, rug_position = 'jitter')

## Not run: 
# Simulate and plot Hazard Rate for stafcder variable
Sim2 &lt;- coxsimLinear(M1, b = "stafcder", nsim = 100,
                      qi = "Hazard Rate",
                      Xj = c(1237, 1600))
simGG(Sim2, type = 'points')
simGG(Sim2, type = 'lines')

## End(Not run)

</code></pre>

<hr>
<h2 id='simGG.simpoly'>Plot simulated polynomial quantities of interest from Cox Proportional
Hazards Models</h2><span id='topic+simGG.simpoly'></span>

<h3>Description</h3>

<p><code>simGG.simpoly</code> uses ggplot2 to plot simulated relative
quantities of interest from a <code>simpoly</code> class object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simpoly'
simGG(
  obj,
  from = NULL,
  to = NULL,
  rug = TRUE,
  rug_position = "identity",
  xlab = NULL,
  ylab = NULL,
  title = NULL,
  method = "auto",
  spalette = "Set1",
  legend = "legend",
  leg.name = "",
  lcolour = "#2B8CBE",
  lsize = 1,
  pcolour = "#A6CEE3",
  psize = 1,
  alpha = 0.2,
  type = "ribbons",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simGG.simpoly_+3A_obj">obj</code></td>
<td>
<p>a <code>simpoly</code> class object.</p>
</td></tr>
<tr><td><code id="simGG.simpoly_+3A_from">from</code></td>
<td>
<p>numeric time to start the plot from. Only relevant if
<code>qi = "Hazard Rate"</code>.</p>
</td></tr>
<tr><td><code id="simGG.simpoly_+3A_to">to</code></td>
<td>
<p>numeric time to plot to. Only relevant if
<code>qi = "Hazard Rate"</code>.</p>
</td></tr>
<tr><td><code id="simGG.simpoly_+3A_rug">rug</code></td>
<td>
<p>logical indicating whether or not to include a rug plot showing
the distribution of values in the sample used to estimate the <code>coxph</code>
model. Only relevant when the quantity of interest is not
<code>"Hazard Rate"</code>.</p>
</td></tr>
<tr><td><code id="simGG.simpoly_+3A_rug_position">rug_position</code></td>
<td>
<p>character string. The position adjustment to use for
overlapping points in the rug plot. Use <code>"jitter"</code> to jitter the points.</p>
</td></tr>
<tr><td><code id="simGG.simpoly_+3A_xlab">xlab</code></td>
<td>
<p>a label for the plot's x-axis.</p>
</td></tr>
<tr><td><code id="simGG.simpoly_+3A_ylab">ylab</code></td>
<td>
<p>a label of the plot's y-axis. The default uses the value of
<code>qi</code>.</p>
</td></tr>
<tr><td><code id="simGG.simpoly_+3A_title">title</code></td>
<td>
<p>the plot's main title.</p>
</td></tr>
<tr><td><code id="simGG.simpoly_+3A_method">method</code></td>
<td>
<p>what type of smoothing method to use to summarize the center
of the simulation distribution.</p>
</td></tr>
<tr><td><code id="simGG.simpoly_+3A_spalette">spalette</code></td>
<td>
<p>colour palette for when there are multiple sets of
comparisons to plot. Default palette is <code>"Set1"</code>. See
<code><a href="ggplot2.html#topic+scale_colour_brewer">scale_colour_brewer</a></code>.</p>
</td></tr>
<tr><td><code id="simGG.simpoly_+3A_legend">legend</code></td>
<td>
<p>specifies what type of legend to include (if applicable). The
default is <code>legend = "legend"</code>. To hide the legend use
<code>legend = FALSE</code>. See the <code><a href="ggplot2.html#topic+discrete_scale">discrete_scale</a></code> for more details.</p>
</td></tr>
<tr><td><code id="simGG.simpoly_+3A_leg.name">leg.name</code></td>
<td>
<p>name of the legend (if applicable).</p>
</td></tr>
<tr><td><code id="simGG.simpoly_+3A_lcolour">lcolour</code></td>
<td>
<p>character string colour of the smoothing line. The default is
hexadecimal colour <code>lcolour = '#2B8CBE'</code>. Only relevant if
<code>qi = "First Difference"</code>.</p>
</td></tr>
<tr><td><code id="simGG.simpoly_+3A_lsize">lsize</code></td>
<td>
<p>size of the smoothing line. Default is 1. See
<code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="simGG.simpoly_+3A_pcolour">pcolour</code></td>
<td>
<p>character string colour of the simulated points or ribbons
(when there are not multiple sets of simulations). Default is hexadecimal
colour <code>pcolour = '#A6CEE3'</code>.</p>
</td></tr>
<tr><td><code id="simGG.simpoly_+3A_psize">psize</code></td>
<td>
<p>size of the plotted simulation points. Default is
<code>psize = 1</code>. See <code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="simGG.simpoly_+3A_alpha">alpha</code></td>
<td>
<p>numeric. Alpha (e.g. transparency) for the points, lines, or
ribbons. Default is <code>alpha = 0.2</code>. See <code>ggplot2</code>. Note, if
<code>type = "lines"</code> or <code>type = "points"</code> then <code>alpah</code> sets the
maximum value per line or point at the center of the distribution. Lines or
points further from the center are more transparent the further they get
from the middle.</p>
</td></tr>
<tr><td><code id="simGG.simpoly_+3A_type">type</code></td>
<td>
<p>character string. Specifies how to plot the simulations. Can be
<code>points</code>, <code>lines</code>, or <code>ribbons</code>. If points then each
simulation value will be plotted. If <code>lines</code> is chosen then each
simulation is plotted using a different line. Note: any simulation with a
value along its length that is outside of the specified central interval
will be dropped. This is to create a smooth plot. If <code>type = "ribbons"</code>
a plot will be created with shaded areas ('ribbons') for the minimum and
maximum simulation values (i.e. the middle interval set with <code>qi</code> in
<code><a href="#topic+coxsimSpline">coxsimSpline</a></code>) as well as the central 50 percent of this area.
It also plots a line for the median value of the full area, so values in
<code>method</code> are ignored. One of the key advantages of using ribbons
rather than points is that it creates plots with smaller file sizes.</p>
</td></tr>
<tr><td><code id="simGG.simpoly_+3A_...">...</code></td>
<td>
<p>Additional arguments. (Currently ignored.)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses ggplot2 to plot the quantities of interest from
<code>simpoly</code> objects.
</p>


<h3>Value</h3>

<p>a <code>gg</code> <code>ggplot</code> class object
</p>


<h3>References</h3>

<p>Gandrud, Christopher. 2015. simPH: An R Package for Illustrating
Estimates from Cox Proportional Hazard Models Including for Interactive and
Nonlinear Effects. Journal of Statistical Software. 65(3)1-20.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coxsimPoly">coxsimPoly</a></code> and <code>ggplot2</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Carpenter (2002) data
data("CarpenterFdaData")

# Load survival package
library(survival)

# Run basic model
M1 &lt;- coxph(Surv(acttime, censor) ~ prevgenx + lethal +
       deathrt1 + acutediz + hosp01  + hhosleng + mandiz01 +
       femdiz01 + peddiz01 + orphdum + natreg +
       I(natreg^2) + I(natreg^3) + vandavg3 + wpnoavg3 +
       condavg3 + orderent + stafcder, data = CarpenterFdaData)

# Simulate simpoly First Difference
Sim1 &lt;- coxsimPoly(M1, b = "natreg", qi = "First Difference",
           pow = 3, Xj = seq(1, 150, by = 5), nsim = 100)

# Plot simulations
simGG(Sim1, rug_position = 'jitter')

## Not run: 
# Simulate simpoly Hazard Ratio with spin probibility interval
Sim2 &lt;- coxsimPoly(M1, b = "natreg", qi = "Hazard Ratio",
          pow = 3, Xj = seq(1, 150, by = 5), spin = TRUE,
          nsim = 100)

# Plot simulations
simGG(Sim2, type = 'ribbons', rug_position = 'jitter')

Sim3 &lt;- coxsimPoly(M1, b = "natreg", qi = "Hazard Rate",
           pow = 3, Xj = c(1, 150), nsim = 100)

# Plot simulations
simGG(Sim3, type = 'lines')

## End(Not run)

</code></pre>

<hr>
<h2 id='simGG.simspline'>Plot simulated penalised spline hazards from Cox Proportional Hazards Models</h2><span id='topic+simGG.simspline'></span>

<h3>Description</h3>

<p><code>simGG.simspline</code> uses ggplot2 to plot
quantities of interest from <code>simspline</code> objects, including relative
hazards, first differences, hazard ratios, and hazard rates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simspline'
simGG(
  obj,
  SmoothSpline = TRUE,
  FacetTime = NULL,
  from = NULL,
  to = NULL,
  rug = TRUE,
  rug_position = "identity",
  xlab = NULL,
  ylab = NULL,
  zlab = NULL,
  title = NULL,
  method = "auto",
  lcolour = "#2B8CBE",
  lsize = 1,
  pcolour = "#A6CEE3",
  psize = 1,
  alpha = 0.2,
  type = "ribbons",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simGG.simspline_+3A_obj">obj</code></td>
<td>
<p>a <code>simspline</code> class object</p>
</td></tr>
<tr><td><code id="simGG.simspline_+3A_smoothspline">SmoothSpline</code></td>
<td>
<p>logical whether or not to fit the simulations with
smoothing splines. Creates a smoother plot. See <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>
for more information. Note: currently the degrees of freedom are set at 10.</p>
</td></tr>
<tr><td><code id="simGG.simspline_+3A_facettime">FacetTime</code></td>
<td>
<p>a numeric vector of points in time where you would like to
plot Hazard Rates in a facet grid. Only relevant if
<code>qi == 'Hazard Rate'</code>. Note: the values of Facet Time must exactly
match values of the <code>time</code> element of <code>obj</code>.</p>
</td></tr>
<tr><td><code id="simGG.simspline_+3A_from">from</code></td>
<td>
<p>numeric time to start the plot from. Only relevant if
<code>qi = "Hazard Rate"</code>.</p>
</td></tr>
<tr><td><code id="simGG.simspline_+3A_to">to</code></td>
<td>
<p>numeric time to plot to. Only relevant if
<code>qi = "Hazard Rate"</code>.</p>
</td></tr>
<tr><td><code id="simGG.simspline_+3A_rug">rug</code></td>
<td>
<p>logical indicating whether or not to include a rug plot showing
the distribution of values in the sample used to estimate the <code>coxph</code>
model. Only relevant when the quantity of interest is not
<code>"Hazard Rate"</code>.</p>
</td></tr>
<tr><td><code id="simGG.simspline_+3A_rug_position">rug_position</code></td>
<td>
<p>character string. The position adjustment to use for
overlapping points in the rug plot. Use <code>"jitter"</code> to jitter the points.</p>
</td></tr>
<tr><td><code id="simGG.simspline_+3A_xlab">xlab</code></td>
<td>
<p>a label for the plot's x-axis.</p>
</td></tr>
<tr><td><code id="simGG.simspline_+3A_ylab">ylab</code></td>
<td>
<p>a label of the plot's y-axis. The default uses the value of
<code>qi</code>.</p>
</td></tr>
<tr><td><code id="simGG.simspline_+3A_zlab">zlab</code></td>
<td>
<p>a label for the plot's z-axis. Only relevant if
<code>qi = "Hazard Rate"</code> and <code>FacetTime == NULL</code>.</p>
</td></tr>
<tr><td><code id="simGG.simspline_+3A_title">title</code></td>
<td>
<p>the plot's main title.</p>
</td></tr>
<tr><td><code id="simGG.simspline_+3A_method">method</code></td>
<td>
<p>what type of smoothing method to use to summarize the center
of the simulation distribution.</p>
</td></tr>
<tr><td><code id="simGG.simspline_+3A_lcolour">lcolour</code></td>
<td>
<p>character string colour of the smoothing line. The default is
hexadecimal colour <code>lcolour = '#2B8CBE'</code>. Only relevant if
<code>qi = "Relative Hazard"</code> or <code>qi = "First Difference"</code>.</p>
</td></tr>
<tr><td><code id="simGG.simspline_+3A_lsize">lsize</code></td>
<td>
<p>size of the smoothing line. Default is 1. See
<code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="simGG.simspline_+3A_pcolour">pcolour</code></td>
<td>
<p>character string colour of the simulated points or ribbons
(when there are not multiple sets of simulations). Default is hexadecimal
colour <code>pcolour = '#A6CEE3'</code>. Only relevant if
<code>qi = "Relative Hazard"</code> or <code>qi = "First Difference"</code> or
<code>qi = "Hazard Rate"</code> with facets.</p>
</td></tr>
<tr><td><code id="simGG.simspline_+3A_psize">psize</code></td>
<td>
<p>size of the plotted simulation points. Default is
<code>psize = 1</code>. See <code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="simGG.simspline_+3A_alpha">alpha</code></td>
<td>
<p>numeric. Alpha (e.g. transparency) for the points, lines, or
ribbons. Default is <code>alpha = 0.2</code>. See <code>ggplot2</code>. Note, if
<code>type = "lines"</code> or <code>type = "points"</code> then <code>alpah</code> sets the
maximum value per line or point at the center of the distribution. Lines or
points further from the center are more transparent the further they get
from the middle.</p>
</td></tr>
<tr><td><code id="simGG.simspline_+3A_type">type</code></td>
<td>
<p>character string. Specifies how to plot the simulations. Can be
<code>points</code>, <code>lines</code>, or <code>ribbons</code>. If points then each
simulation value will be plotted. If <code>lines</code> is chosen then each
simulation is plotted using a different line. Note: any simulation with a
value along its length that is outside of the specified central interval
will be dropped. This is to create a smooth plot. If <code>type = "ribbons"</code>
a plot will be created with shaded areas ('ribbons') for the minimum and
maximum simulation values (i.e. the middle interval set with <code>qi</code> in
<code><a href="#topic+coxsimSpline">coxsimSpline</a></code>) as well as the central 50 percent of this area.
It also plots a line for the median value of the full area, so values in
<code>method</code> are ignored. One of the key advantages of using ribbons
rather than points is that it creates plots with smaller file sizes.</p>
</td></tr>
<tr><td><code id="simGG.simspline_+3A_...">...</code></td>
<td>
<p>Additional arguments. (Currently ignored.)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses <code>ggplot2</code> to plot the quantities of
interest from <code>simspline</code> objects, including relative hazards, first
differences, hazard ratios, and hazard rates. If currently does not support
hazard rates for multiple strata.
</p>
<p>You can to plot hazard rates for a range of values of <code>Xj</code> in two
dimensional plots at specific points in time. Each plot is arranged in a
facet grid.
</p>
<p>Note: A dotted line is created at y = 1 (0 for first difference), i.e. no
effect, for time-varying hazard ratio graphs. No line is created for hazard
rates.
</p>


<h3>Value</h3>

<p>a <code>gg</code> <code>ggplot</code> class object.
</p>


<h3>References</h3>

<p>Gandrud, Christopher. 2015. simPH: An R Package for Illustrating
Estimates from Cox Proportional Hazard Models Including for Interactive and
Nonlinear Effects. Journal of Statistical Software. 65(3)1-20.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coxsimLinear">coxsimLinear</a></code>, <code><a href="#topic+simGG.simtvc">simGG.simtvc</a></code>,
<code>ggplot2</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Carpenter (2002) data
data("CarpenterFdaData")

# Load survival package
library(survival)

# Run basic model
# From Keele (2010) replication data
M1 &lt;- coxph(Surv(acttime, censor) ~  prevgenx + lethal + deathrt1 +
                acutediz + hosp01  + pspline(hospdisc, df = 4) +
                pspline(hhosleng, df = 4) + mandiz01 + femdiz01 +
                peddiz01 + orphdum + natreg + vandavg3 + wpnoavg3 +
                pspline(condavg3, df = 4) + pspline(orderent, df = 4) +
                pspline(stafcder, df = 4), data = CarpenterFdaData)

# Simulate Relative Hazards for orderent
Sim1 &lt;- coxsimSpline(M1, bspline = "pspline(stafcder, df = 4)",
                    bdata = CarpenterFdaData$stafcder,
                    qi = "Hazard Ratio",
                    Xj = seq(1100, 1700, by = 10),
                    Xl = seq(1099, 1699, by = 10), spin = TRUE, nsim = 100)

# Plot relative hazard
simGG(Sim1, alpha = 0.5)

## Not run: 
# Simulate Hazard Rate for orderent
Sim2 &lt;- coxsimSpline(M1, bspline = "pspline(orderent, df = 4)",
                    bdata = CarpenterFdaData$orderent,
                    qi = "Hazard Rate",
                    Xj = seq(1, 30, by = 2), ci = 0.9, nsim = 10)

# Create a time grid plot
# Find all points in time where baseline hazard was found
unique(Sim2$sims$Time)

# Round time values so they can be exactly matched with FacetTime
Sim2$sims$Time &lt;- round(Sim2$sims$Time, digits = 2)

# Create plot
simGG(Sim2, FacetTime = c(6.21, 25.68, 100.64, 202.36),
       type = 'ribbons', alpha = 0.5)

# Simulated Fitted Values of stafcder
Sim3 &lt;- coxsimSpline(M1, bspline = "pspline(stafcder, df = 4)",
                    bdata = CarpenterFdaData$stafcder,
                    qi = "Hazard Ratio",
                    Xj = seq(1100, 1700, by = 10),
                    Xl = seq(1099, 1699, by = 10), ci = 0.90)

# Plot simulated Hazard Ratios
simGG(Sim3, xlab = "\nFDA Drug Review Staff", type = 'lines', alpha = 0.2)
simGG(Sim3, xlab = "\nFDA Drug Review Staff", alpha = 0.2,
      SmoothSpline = TRUE, type = 'points')

## End(Not run)

</code></pre>

<hr>
<h2 id='simGG.simtvc'>Plot simulated time-interactive hazard ratios or stratified time-interactive
hazard rates from Cox Proportional Hazards Models</h2><span id='topic+simGG.simtvc'></span>

<h3>Description</h3>

<p><code>simGG.simtvc</code> uses ggplot2 to plot the simulated hazards from a
<code>simtvc</code> class object created by <code><a href="#topic+coxsimtvc">coxsimtvc</a></code> using
ggplot2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simtvc'
simGG(
  obj,
  from = NULL,
  to = NULL,
  xlab = NULL,
  ylab = NULL,
  title = NULL,
  method = "auto",
  spalette = "Set1",
  legend = "legend",
  leg.name = "",
  lsize = 1,
  psize = 1,
  alpha = 0.2,
  type = "ribbons",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simGG.simtvc_+3A_obj">obj</code></td>
<td>
<p>a <code>simtvc</code> class object</p>
</td></tr>
<tr><td><code id="simGG.simtvc_+3A_from">from</code></td>
<td>
<p>numeric time to start the plot from.</p>
</td></tr>
<tr><td><code id="simGG.simtvc_+3A_to">to</code></td>
<td>
<p>numeric time to plot to.</p>
</td></tr>
<tr><td><code id="simGG.simtvc_+3A_xlab">xlab</code></td>
<td>
<p>a label for the plot's x-axis.</p>
</td></tr>
<tr><td><code id="simGG.simtvc_+3A_ylab">ylab</code></td>
<td>
<p>a label of the plot's y-axis. The default uses the value of
<code>qi</code>.</p>
</td></tr>
<tr><td><code id="simGG.simtvc_+3A_title">title</code></td>
<td>
<p>the plot's main title.</p>
</td></tr>
<tr><td><code id="simGG.simtvc_+3A_method">method</code></td>
<td>
<p>what type of smoothing method to use to summarize the center
of the simulation distribution.</p>
</td></tr>
<tr><td><code id="simGG.simtvc_+3A_spalette">spalette</code></td>
<td>
<p>colour palette for when there are multiple sets of
comparisons to plot. Default palette is <code>"Set1"</code>. See
<code><a href="ggplot2.html#topic+scale_colour_brewer">scale_colour_brewer</a></code>.</p>
</td></tr>
<tr><td><code id="simGG.simtvc_+3A_legend">legend</code></td>
<td>
<p>specifies what type of legend to include (if applicable).
The default is <code>legend = "legend"</code>. To hide the legend use
<code>legend = FALSE</code>. See the <code><a href="ggplot2.html#topic+discrete_scale">discrete_scale</a></code> for more details.</p>
</td></tr>
<tr><td><code id="simGG.simtvc_+3A_leg.name">leg.name</code></td>
<td>
<p>name of the legend (if applicable).</p>
</td></tr>
<tr><td><code id="simGG.simtvc_+3A_lsize">lsize</code></td>
<td>
<p>size of the smoothing line. Default is 1. See
<code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="simGG.simtvc_+3A_psize">psize</code></td>
<td>
<p>size of the plotted simulation points. Default is
<code>psize = 1</code>. See <code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="simGG.simtvc_+3A_alpha">alpha</code></td>
<td>
<p>numeric. Alpha (e.g. transparency) for the points, lines, or
ribbons. Default is <code>alpha = 0.2</code>. See <code>ggplot2</code>. Note, if
<code>type = "lines"</code> or <code>type = "points"</code> then <code>alpah</code> sets the
maximum value per line or point at the center of the distribution. Lines or
points further from the center are more transparent the further they get
from the middle.</p>
</td></tr>
<tr><td><code id="simGG.simtvc_+3A_type">type</code></td>
<td>
<p>character string. Specifies how to plot the simulations. Can be
<code>points</code>, <code>lines</code>, or <code>ribbons</code>. If points then each
simulation value will be plotted. If <code>lines</code> is chosen then each
simulation is plotted using a different line. Note: any simulation with a
value along its length that is outside of the specified central interval
will be dropped. This is to create a smooth plot. If <code>type = "ribbons"</code>
a plot will be created with shaded areas ('ribbons') for the minimum and
maximum simulation values (i.e. the middle interval set with <code>qi</code> in
<code><a href="#topic+coxsimSpline">coxsimSpline</a></code>) as well as the central 50 percent of this area.
It also plots a line for the median value of the full area, so values in
<code>method</code> are ignored. One of the key advantages of using ribbons
rather than points is that it creates plots with smaller file sizes.</p>
</td></tr>
<tr><td><code id="simGG.simtvc_+3A_...">...</code></td>
<td>
<p>Additional arguments. (Currently ignored.)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plots either a time-interactive hazard ratios, first differences,
and relative hazards, or the hazard rates for multiple strata. Currently the
strata legend labels need to be changed manually (see <code>revalue</code>
in the plyr package) in the <code>simtvc</code> object with the
<code>strata</code> component. Also, currently the x-axis tick marks and break
labels must be adjusted manually for non-linear functions of time.
Note: A dotted line is created at y = 1 (0 for first difference), i.e. no
effect, for time-varying hazard ratio graphs. No line is created for hazard
rates.
</p>


<h3>Value</h3>

<p>a <code>gg</code> <code>ggplot</code> class object
</p>


<h3>References</h3>

<p>Gandrud, Christopher. 2015. simPH: An R Package for Illustrating
Estimates from Cox Proportional Hazard Models Including for Interactive and
Nonlinear Effects. Journal of Statistical Software. 65(3)1-20.
</p>
<p>Licht, Amanda A. 2011. &rdquo;Change Comes with Time: Substantive
Interpretation of Nonproportional Hazards in Event History Analysis.&rdquo;
Political Analysis 19: 227-43.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load Golub &amp; Steunenberg (2007) Data
data("GolubEUPData")

# Load survival package
library(survival)

# Expand data
GolubEUPData &lt;- SurvExpand(GolubEUPData, GroupVar = 'caseno',
                     Time = 'begin', Time2 = 'end', event = 'event')

# Create time interactions
BaseVars &lt;- c('qmv', 'backlog', 'coop', 'codec', 'qmvpostsea', 'thatcher')
GolubEUPData &lt;- tvc(GolubEUPData, b = BaseVars, tvar = 'end', tfun = 'log')

# Run Cox PH Model
M1 &lt;- coxph(Surv(begin, end, event) ~ qmv + qmvpostsea + qmvpostteu +
                coop + codec + eu9 + eu10 + eu12 + eu15 + thatcher +
                agenda + backlog + qmv_log + qmvpostsea_log + coop_log +
                codec_log + thatcher_log + backlog_log,
            data = GolubEUPData, ties = "efron")

# Create simtvc object for Relative Hazard
Sim1 &lt;- coxsimtvc(obj = M1, b = "qmv", btvc = "qmv_log",
                   tfun = "log", from = 80, to = 2000,
                   Xj = 1, by = 15, ci = 0.99, nsim = 100)

# Create plot
simGG(Sim1, legend = FALSE)

# Create simtvc object for First Difference
Sim2 &lt;- coxsimtvc(obj = M1, b = "qmv", btvc = "qmv_log",
                 qi = "First Difference", Xj = 1,
                 tfun = "log", from = 80, to = 2000,
                 by = 15, ci = 0.95)

# Create simtvc object for Hazard Ratio
Sim3 &lt;- coxsimtvc(obj = M1, b = "backlog", btvc = "backlog_log",
                  qi = "Hazard Ratio", Xj = c(191, 229),
                  Xl = c(0, 0),
                  tfun = "log", from = 100, to = 2000,
                  by = 15, ci = 0.99)

# Create plots
simGG(Sim2, type = 'points')
simGG(Sim3, leg.name = "Comparision", from = 1200, type = 'lines')

## End(Not run)

</code></pre>

<hr>
<h2 id='simPH'>An R package for simulating and plotting quantities of interest from Cox
Proportional Hazard models.</h2><span id='topic+simPH'></span>

<h3>Description</h3>

<p>An R package for simulating and plotting quantities of interest
(relative hazards, first differences, and hazard ratios) for linear
coefficients, multiplicative interactions, polynomials, penalised splines,
and non-proportional hazards, as well as stratified survival curves from Cox
Proportional Hazard models.
</p>
<p>The package includes the following simulation functions:
</p>

<ul>
<li><p><code><a href="#topic+coxsimLinear">coxsimLinear</a></code>: a function for simulating relative
hazards, first differences, hazard ratios, and hazard rates for linear,
non-time interacted covariates from Cox Proportional Hazard
(<code><a href="survival.html#topic+coxph">coxph</a></code>) models.
</p>
</li>
<li><p><code><a href="#topic+coxsimtvc">coxsimtvc</a></code>: a function for simulating time-interactive
hazards (relative hazards, first differences, and hazard ratios) for
covariates from Cox Proportional Hazard models. The function will calculate
time-interactive hazard ratios for multiple strata estimated from a
stratified Cox Proportional Hazard model.
</p>
</li>
<li><p><code><a href="#topic+coxsimSpline">coxsimSpline</a></code>: a function for simulating quantities
of interest from penalised splines using multivariate normal distributions.
Currently does not support simulating hazard rates from stratified models.
Note: be extremely careful about the number of simulations you ask the
function to find. It is very easy to ask for more than your computer can
handle.
</p>
</li>
<li><p><code><a href="#topic+coxsimPoly">coxsimPoly</a></code>: a function for simulating quantities of
interest for a range of values for a polynomial nonlinear effect from Cox
Proportional Hazard models.
</p>
</li>
<li><p><code><a href="#topic+coxsimInteract">coxsimInteract</a></code>: a function for simulating quantities
of interest for linear multiplicative interactions, including marginal
effects and hazard rates.
</p>
</li></ul>

<p>Results from these functions can be plotted using the <code><a href="#topic+simGG">simGG</a></code>
method.
</p>
<p>The package also includes two functions that make it easier to create time
interactions:
</p>

<ul>
<li><p><code><a href="#topic+SurvExpand">SurvExpand</a></code>: a function to convert a data frame of
non-equal interval continuous observations into equal interval continuous
observations.
</p>
</li>
<li><p><code><a href="#topic+tvc">tvc</a></code>: a function to create time interaction variables
that can be used in a <code><a href="survival.html#topic+coxph">coxph</a></code> model (or any other model with time
interactions).
</p>
</li>
<li><p>setXl: a function for setting valid <code>Xl</code> values given a
sequence of fitted <code>Xj</code> values. This makes it more intituitive to find
hazard ratios and first differences for comparisons between some <code class="reqn">Xj</code>
fitted values and <code class="reqn">Xl</code> values other than 0.
</p>
</li></ul>



<h3>References</h3>

<p>Gandrud, Christopher. 2015. simPH: An R Package for Illustrating
Estimates from Cox Proportional Hazard Models Including for Interactive and
Nonlinear Effects. Journal of Statistical Software. 65(3)1-20.
</p>

<hr>
<h2 id='SurvExpand'>Convert a data frame of non-equal interval continuous observations into
equal interval continuous observations</h2><span id='topic+SurvExpand'></span>

<h3>Description</h3>

<p><code>SurvExpand</code> convert a data frame of non-equal interval continuous
observations into equal interval continuous observations. This is useful for
creating time-interactions with <code><a href="#topic+tvc">tvc</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SurvExpand(
  data,
  GroupVar,
  Time,
  Time2,
  event,
  PartialData = TRUE,
  messages = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SurvExpand_+3A_data">data</code></td>
<td>
<p>a data frame.</p>
</td></tr>
<tr><td><code id="SurvExpand_+3A_groupvar">GroupVar</code></td>
<td>
<p>a character string naming the unit grouping variable.</p>
</td></tr>
<tr><td><code id="SurvExpand_+3A_time">Time</code></td>
<td>
<p>a character string naming the variable with the interval start
time.</p>
</td></tr>
<tr><td><code id="SurvExpand_+3A_time2">Time2</code></td>
<td>
<p>a character string naming the variable with the interval end
time.</p>
</td></tr>
<tr><td><code id="SurvExpand_+3A_event">event</code></td>
<td>
<p>a character string naming the event variable. Note: must be
numeric with 0 indicating no event.</p>
</td></tr>
<tr><td><code id="SurvExpand_+3A_partialdata">PartialData</code></td>
<td>
<p>logical indicating whether or not to keep only the
expanded data required to find the Cox partial likelihood.</p>
</td></tr>
<tr><td><code id="SurvExpand_+3A_messages">messages</code></td>
<td>
<p>logical indicating if you want messages returned while the
function is working.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function primarily prepares data from the creation of accurate
time-interactions with the <code><a href="#topic+tvc">tvc</a></code> command.
Note: the function will work best if your original time intervals are
recorded in whole numbers. It also currently does not support repeated
events data.
</p>


<h3>Value</h3>

<p>Returns a data frame where observations have been expanded into
equally spaced time intervals.
</p>


<h3>References</h3>

<p>Gandrud, Christopher. 2015. simPH: An R Package for Illustrating
Estimates from Cox Proportional Hazard Models Including for Interactive and
Nonlinear Effects. Journal of Statistical Software. 65(3)1-20.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tvc">tvc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Golub &amp; Steunenberg (2007) Data
data("GolubEUPData")

# Subset PURELY TO SPEED UP THE EXAMPLE
GolubEUPData &lt;- GolubEUPData[1:500, ]

# Expand data
GolubEUPDataExpand &lt;- SurvExpand(GolubEUPData, GroupVar = 'caseno',
                       Time = 'begin', Time2 = 'end', event = 'event')

</code></pre>

<hr>
<h2 id='tvc'>Create a time interaction variable</h2><span id='topic+tvc'></span>

<h3>Description</h3>

<p><code>tvc</code> creates a time interaction variable that can be used in a coxph
model (or any other model with time interactions)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tvc(data, b, tvar, tfun = "linear", pow = NULL, vector = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tvc_+3A_data">data</code></td>
<td>
<p>a data frame</p>
</td></tr>
<tr><td><code id="tvc_+3A_b">b</code></td>
<td>
<p>the non-time interacted variable's name. Either a single value or a
vector of variable names can be entered.</p>
</td></tr>
<tr><td><code id="tvc_+3A_tvar">tvar</code></td>
<td>
<p>the time variable's name</p>
</td></tr>
<tr><td><code id="tvc_+3A_tfun">tfun</code></td>
<td>
<p>function of time that btvc was multiplied by. Default is
<code>tfun = "linear"</code>. Can also be <code>tfun = 'log'</code> (natural log) and
<code>tfun = 'power'</code>. If <code>tfun = 'power'</code> then the pow argument needs
to be specified also.</p>
</td></tr>
<tr><td><code id="tvc_+3A_pow">pow</code></td>
<td>
<p>if <code>tfun = 'power'</code>, then use pow to specify what power to
raise the time interaction to.</p>
</td></tr>
<tr><td><code id="tvc_+3A_vector">vector</code></td>
<td>
<p>logical. Whether or not to return one vector a or a data frame.
Can only be used if only one <code>b</code> is included.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Interacts a variable with a specified function of time. Possible
functions of time include <code>'linear'</code>, natural <code>'log'</code>, and
exponentiated (<code>'power'</code>).
</p>


<h3>Value</h3>

<p>a data frame or vector. If a data frame is returned it will include
all of the original variables as well as the interactions denoted by a
variable name '<code>bn</code>_<code>tfun</code>', where <code>bn</code> is one variable name
from <code>b</code> and <code>tfun</code> as entered into the function.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SurvExpand">SurvExpand</a></code>, <code><a href="#topic+simGG.simtvc">simGG.simtvc</a></code>,
<code><a href="#topic+coxsimtvc">coxsimtvc</a></code>, <code><a href="boot.html#topic+survival">survival</a></code>, and <code><a href="survival.html#topic+coxph">coxph</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Golub &amp; Steunenberg (2007) Data
data('GolubEUPData')

# Subset PURELY TO SPEED UP THE EXAMPLE
GolubEUPData &lt;- GolubEUPData[1:500, ]

# Expand data into equally spaced time intervals
GolubEUPData &lt;- SurvExpand(GolubEUPData, GroupVar = 'caseno',
                  Time = 'begin', Time2 = 'end', event = 'event')

# Create natural log time interaction with the qmv variable
GolubEUPData$Lqmv &lt;- tvc(GolubEUPData, b = 'qmv', tvar = 'end', tfun = 'log',
                         vector = TRUE)

# Create interactions for a vector of variables
BaseVars &lt;- c('qmv', 'backlog', 'coop', 'codec', 'qmvpostsea', 'thatcher')

Test &lt;- tvc(GolubEUPData, b = BaseVars, tvar = 'end', tfun = 'log')

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
