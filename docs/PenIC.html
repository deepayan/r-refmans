<!DOCTYPE html><html><head><title>Help for package PenIC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PenIC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#PenIC-package'>
<p>A statistical package for regression analysis of interval-censored data under the generalized odds-rates model using penalized B-splines</p></a></li>
<li><a href='#dataPA'>
<p>Date generation function</p></a></li>
<li><a href='#EM_fit'>
<p>EM algorithm for fitting generalized odds-rate model with specified link function (i.e., alpha value) under interval-censored data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Title:</td>
<td>Semiparametric Regression Analysis of Interval-Censored Data
using Penalized Splines</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yan Liu &lt;yanliuresearch@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Currently incorporate the generalized odds-rate model (a type of linear 
    transformation model) for interval-censored data based on penalized monotonic B-Spline. 
    More methods under other semiparametric models such as cure model or additive model will
    be included in future versions. For more details see Lu, M., Liu, Y., Li, C. and Sun, J. 
    (2019) &lt;<a href="https://doi.org/10.48550/arXiv.1912.11703">doi:10.48550/arXiv.1912.11703</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, numDeriv, splines, Matrix, MASS</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-01-07 21:41:37 UTC; yliu23</td>
</tr>
<tr>
<td>Author:</td>
<td>Yan Liu [aut, cre],
  Minggen Lu [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-01-09 16:40:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='PenIC-package'>
A statistical package for regression analysis of interval-censored data under the generalized odds-rates model using penalized B-splines
</h2><span id='topic+PenIC-package'></span>

<h3>Description</h3>

<p>This package is designed to conduct the semiparametric regression analysis of interval-censored data under the generalized odds-rates model. To estimate the unknown nondecreasing cumulative baseline hazard function, monotone B-splines are used. An expectation maximization (EM) algorithm is developed to facilitate model fitting.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> PenIC</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2019-12-11</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>  Yan Liu  and Minggen Lu
</p>

<hr>
<h2 id='dataPA'>
Date generation function
</h2><span id='topic+dataPA'></span>

<h3>Description</h3>

<p>Generate interval-censored data under generalized odds-rate model, with different combinations of right-censoring
rate and cumulative baseline hazard function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataPA(N, case, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dataPA_+3A_n">N</code></td>
<td>
<p>size of dataset</p>
</td></tr>
<tr><td><code id="dataPA_+3A_case">case</code></td>
<td>
<p>data generation configuration; takes value in 1, 2 and 3. </p>
</td></tr>
<tr><td><code id="dataPA_+3A_alpha">alpha</code></td>
<td>
<p>parameter of link function; alpha=0 for the PH model and alpha=1 for the PO model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The above function generate interval-censored data from generalized odds-rate model, under different simulation configurations. For further details please see Lu et al. (2019+).
</p>


<h3>Value</h3>

<table>
<tr><td><code>d1</code></td>
<td>
<p>vector indicating whether an observation is left-censored (1) or not (0).</p>
</td></tr>
<tr><td><code>d2</code></td>
<td>
<p>vector indicating whether an observation is interval-censored (1) or not (0).</p>
</td></tr>
<tr><td><code>d3</code></td>
<td>
<p>vector indicating whether an observation is right-censored (1) or not (0).</p>
</td></tr>
<tr><td><code>Li</code></td>
<td>
<p>the left endpoint of the observed interval; if an observation is left-censored, its corresponding entry should be 0. </p>
</td></tr>
<tr><td><code>Ri</code></td>
<td>
<p>the right endpoint of the observed interval; if an observation is right-censored, its corresponding entry should be Inf. </p>
</td></tr>
<tr><td><code>Z</code></td>
<td>
<p>design matrix of predictor variables (in columns); should be specified without an intercept term.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Lu, M., Liu, Y., Li, C. and Sun, J. (2019+). An efficient penalized estimation approach for a semi-parametric linear transformation model with interval-censored data. arXiv:1912.11703.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>case  &lt;- 3
nsub  &lt;- 100

# Generate interval-censored data under PH model

dat &lt;- dataPA(nsub,case,alpha=0)
rp  &lt;- c(mean(dat$d1),mean(dat$d2),mean(dat$d3))
rp

# [1] 0.63 0.22 0.15

</code></pre>

<hr>
<h2 id='EM_fit'>
EM algorithm for fitting generalized odds-rate model with specified link function (i.e., alpha value) under interval-censored data
</h2><span id='topic+EM_fit'></span>

<h3>Description</h3>

<p>Fits the generalized odds-rate model based on penalized B-splines to interval censored data via an EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EM_fit(g0,b0,d1,d2,d3,Li,Ri,Z,nsub,alpha,qn,order,t.seq,tol=1e-5,itmax=500,lamu=1e5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EM_fit_+3A_g0">g0</code></td>
<td>
<p>initial estimate of the spline coefficients; should be of length qn+order+1.</p>
</td></tr>
<tr><td><code id="EM_fit_+3A_b0">b0</code></td>
<td>
<p>initial estimate of regression coefficients; should be of length dim(Z)[2].</p>
</td></tr>
<tr><td><code id="EM_fit_+3A_d1">d1</code></td>
<td>
<p>vector indicating whether an observation is left-censored (1) or not (0).</p>
</td></tr>
<tr><td><code id="EM_fit_+3A_d2">d2</code></td>
<td>
<p>vector indicating whether an observation is interval-censored (1) or not (0).</p>
</td></tr>
<tr><td><code id="EM_fit_+3A_d3">d3</code></td>
<td>
<p>vector indicating whether an observation is right-censored (1) or not (0).</p>
</td></tr>
<tr><td><code id="EM_fit_+3A_li">Li</code></td>
<td>
<p>the left endpoint of the observed interval; if an observation is left-censored, its corresponding entry should be 0. </p>
</td></tr>
<tr><td><code id="EM_fit_+3A_ri">Ri</code></td>
<td>
<p>the right endpoint of the observed interval; if an observation is right-censored, its corresponding entry should be Inf. </p>
</td></tr>
<tr><td><code id="EM_fit_+3A_z">Z</code></td>
<td>
<p>design matrix of predictor variables (in columns); should be specified without an intercept term.</p>
</td></tr>
<tr><td><code id="EM_fit_+3A_nsub">nsub</code></td>
<td>
<p>size of observed dataset.</p>
</td></tr>
<tr><td><code id="EM_fit_+3A_alpha">alpha</code></td>
<td>
<p>parameter of link function; alpha=0 for the PH model and alpha=1 for the PO model.</p>
</td></tr>
<tr><td><code id="EM_fit_+3A_qn">qn</code></td>
<td>
<p>the number of interior knots to be used; should not exceed square root of sample size.</p>
</td></tr>
<tr><td><code id="EM_fit_+3A_order">order</code></td>
<td>
<p>the order of the basis functions; order=3 for cubic spline.</p>
</td></tr>
<tr><td><code id="EM_fit_+3A_tol">tol</code></td>
<td>
<p>the convergence criterion of the EM algorithm.</p>
</td></tr>
<tr><td><code id="EM_fit_+3A_t.seq">t.seq</code></td>
<td>
<p>an increasing sequence of points at which the cumulative baseline hazard function is evaluated.</p>
</td></tr>
<tr><td><code id="EM_fit_+3A_itmax">itmax</code></td>
<td>
<p>maximum iterations of EM procedure.</p>
</td></tr>
<tr><td><code id="EM_fit_+3A_lamu">lamu</code></td>
<td>
<p>upper limit of smoothing parameter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The above function fits the generalized odds-rate model (with specified value of alpha) to interval censored data via an EM algorithm using penalized monotone B-splines.
</p>


<h3>Value</h3>

<table>
<tr><td><code>b</code></td>
<td>
<p>estimates of the regression coefficients.</p>
</td></tr>
<tr><td><code>g</code></td>
<td>
<p>estimates of the spline coefficients.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>the standard deviation of b.</p>
</td></tr>
<tr><td><code>base</code></td>
<td>
<p>estimated cumulative baseline hazard function evaluated at the points t.seq.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>final value of smooth parameter.</p>
</td></tr>
<tr><td><code>flag</code></td>
<td>
<p>the indicator whether the procedure converged; 0 if converged.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Lu, M., Liu, Y., Li, C. and Sun, J. (2019+). An efficient penalized estimation approach for
a semi-parametric linear transformation model with interval-censored data. arXiv:1912.11703.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
case  &lt;- 2
nsub  &lt;- 35

# Generate interval-censored data under PH model

dat &lt;- dataPA(nsub,case,alpha=0)
rp  &lt;- c(mean(dat$d1),mean(dat$d2),mean(dat$d3))
rp

# [1] 0.2571429 0.3428571 0.4000000

t.seq &lt;- seq(0.01,4,0.01)

# number of interior knots to be used
qn    &lt;- ceiling(nsub^(1/3))-2
order &lt;- 3
d1    &lt;- dat$d1
d2    &lt;- dat$d2
d3    &lt;- dat$d3
Ri    &lt;- dat$Ri
Li    &lt;- dat$Li
Z     &lt;- dat$Z
p     &lt;- ncol(Z)
b0    &lt;- rep(0,p)
g0    &lt;- sort(runif(qn+order+1,-1,1))

# Fit data under PH model

fit &lt;- EM_fit(g0,b0,d1,d2,d3,Li,Ri,Z,nsub,alpha=0,qn,order,t.seq,tol=1e-2,itmax=100,lamu=1e5)
cbind(fit$b,fit$se)


#           [,1]      [,2]
#[1,] -1.0655212 0.5021835
#[2,]  0.7649178 0.3185045

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
