<!DOCTYPE html><html><head><title>Help for package bhpm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bhpm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bhpm-package'><p> Bayesian Hierarchical Possion Models for Mulitple Grouped Outcomes with Clustering</p></a></li>
<li><a href='#bhpm.cluster.1a.hier2'><p>A Two-Level Hierarchical Model for Grouped Data with Clusters and without Point-Mass.</p></a></li>
<li><a href='#bhpm.cluster.1a.hier3'><p>A Three-Level Hierarchical Model for Grouped Data with Clusters and without Point-Mass.</p></a></li>
<li><a href='#bhpm.cluster.BB.hier2'><p>A Two-Level Hierarchical Model for grouped data and clusters with Point-Mass.</p></a></li>
<li><a href='#bhpm.cluster.BB.hier3'><p>A Three-Level Hierarchical Model for grouped data and clusters with Point-Mass.</p></a></li>
<li><a href='#bhpm.cluster.data1'><p>Cluster analysis data.</p></a></li>
<li><a href='#bhpm.cluster.data2'><p>Cluster analysis data.</p></a></li>
<li><a href='#bhpm.convergence.diag'><p>Convergence Diagnostics of the Simulation</p></a></li>
<li><a href='#bhpm.gen.initial.values'><p>Generate a template simulation initial values.</p></a></li>
<li><a href='#bhpm.global.sim.param.defaults'><p>Generate default global simulation parameters for a model.</p></a></li>
<li><a href='#bhpm.hyper.param.defaults'><p>Generate default hyperparameter values for a model.</p></a></li>
<li><a href='#bhpm.monitor.defaults'><p>Generate default variable monitor list for a model.</p></a></li>
<li><a href='#bhpm.monitor.samples'><p>Generate a template for choosing which samples to monitor.</p></a></li>
<li><a href='#bhpm.multi.treatments'><p>Cluster analysis data.</p></a></li>
<li><a href='#bhpm.multi.treatments.random.order'><p>Cluster analysis data.</p></a></li>
<li><a href='#bhpm.npm'><p>Fit a  Bayesian Hierarchical Model for Grouped Data with Clusters and without Point-Mass.</p></a></li>
<li><a href='#bhpm.pm'><p>A Bayesian Hierarchical Model for grouped data and clusters with Point-Mass.</p></a></li>
<li><a href='#bhpm.pointmass.weights'><p>Generate a template for the point-mass weightings.</p></a></li>
<li><a href='#bhpm.print.convergence.summary'><p>Print a Summary of the Convergence Diagnostics of the Simulation</p></a></li>
<li><a href='#bhpm.print.summary.stats'><p>Print the Summary Statistics of Posterior Distributions</p></a></li>
<li><a href='#bhpm.ptheta'><p>Reports the posterior probability that theta (the increase in the log-odds) is greater than zero, zero, and less than zero for each outcome</p></a></li>
<li><a href='#bhpm.sim.control.params'><p>Generate a template for the individual model parameter simulation control parameters.</p></a></li>
<li><a href='#bhpm.summary.stats'><p>Summary Statistics for the Posterior Distributions in the model.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Hierarchical Poisson Models for Multiple Grouped
Outcomes with Clustering</td>
</tr>
<tr>
<td>Version:</td>
<td>1.7</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-03-31</td>
</tr>
<tr>
<td>Author:</td>
<td>Raymond Carragher <a href="https://orcid.org/0000-0002-0120-625X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Raymond Carragher &lt;raymond.carragher@strath.ac.uk&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>coda</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Description:</td>
<td>Bayesian hierarchical methods for the detection of differences in rates of related outcomes for multiple treatments for clustered observations. Theoretical background for the models is given in Carragher (2017) <a href="https://ethos.bl.uk/OrderDetails.do?uin=uk.bl.ethos.736866">https://ethos.bl.uk/OrderDetails.do?uin=uk.bl.ethos.736866</a>. The models in this package are extensions for multiple treatments and clusters. This software was developed for the Precision Drug Theraputics: Risk Prediction in Pharmacoepidemiology project as part of a Rutherford Fund Fellowship at Health Data Research (UK), Medical Research Council (UK) award reference MR/S003967/1 (<a href="https://gtr.ukri.org/">https://gtr.ukri.org/</a>). Principal Investigator: Raymond Carragher.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-03-31 14:31:31 UTC; clb13102</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-04-01 09:50:18 UTC</td>
</tr>
</table>
<hr>
<h2 id='bhpm-package'> Bayesian Hierarchical Possion Models for Mulitple Grouped Outcomes with Clustering</h2><span id='topic+bhpm-package'></span>

<h3>Description</h3>

<p>This package implements Bayesian Hierarchical models for the detection of differences in rates of outcomes for multiple treatments for clustered observations using groupings of outcomes.
</p>


<h3>Details</h3>

<p>The methods implemented use assumed groupings of outcomes to 
detect differences in the occurrence of the outcome for different treatments. Methods based on Bayesian Hierarchical
models are provided.
The methods are extension of those described in Carragher (2017) for multiple treatments and clusters.
</p>


<h3>Author(s)</h3>

<p>R. Carragher&lt;raymond.carragher@strath.ac.uk; rcarragh@gmail.com&gt;
</p>


<h3>References</h3>

<p>Carragher R. Detection of Safety Signals in Randomised Controlled Trials. PhD thesis. University of Strathclyde, 2017 &lt;https://ethos.bl.uk/OrderDetails.do?uin=uk.bl.ethos.736866&gt;.
</p>

<hr>
<h2 id='bhpm.cluster.1a.hier2'>A Two-Level Hierarchical Model for Grouped Data with Clusters and without Point-Mass.</h2><span id='topic+bhpm.cluster.1a.hier2'></span>

<h3>Description</h3>

<p>Implementation of a Two-Level Hierarchical for Grouped Data with Clusters and without Point-Mass.</p>


<h3>Usage</h3>

<pre><code class='language-R'>	bhpm.cluster.1a.hier2(cluster.data, sim_type = "SLICE", burnin = 10000,
	iter = 40000, nchains = 3,
	global.sim.params = data.frame(type = c("MH", "SLICE"),
	param = c("sigma_MH", "w"), value = c(0.2,1), control = c(0,6),
	stringsAsFactors = FALSE),
	sim.params = NULL,
	monitor = data.frame(variable = c("theta", "gamma", "mu.gamma",
	"mu.theta", "sigma2.theta", "sigma2.gamma"),
	monitor = c(1, 1, 1, 1, 1, 1),
	stringsAsFactors = FALSE),
	initial_values = NULL,
	level = 1,
	hyper_params = list(mu.gamma.0 = 0, tau2.gamma.0 = 10, mu.theta.0 = 0,
	tau2.theta.0 = 10, alpha.gamma = 3, beta.gamma = 1,
	alpha.theta = 3, beta.theta = 1),
	memory_model = "HIGH")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bhpm.cluster.1a.hier2_+3A_cluster.data">cluster.data</code></td>
<td>

<p>A file or data frame containing the cluster data. It must contain the columns <em>Cluster</em>, <em>Outcome.Grp</em>, <em>Outcome</em>, <em>Trt.Grp</em> (1 - control, 2,... comparator treatments), <em>Count</em> (total number of events), <em>Exposure</em> (total exposure of time of all patients for the Trt.Grp in the Cluster).
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier2_+3A_sim_type">sim_type</code></td>
<td>

<p>The type of MCMC method to use for simulating from non-standard distributions. Allowed values are <em>&quot;MH&quot;</em>
and <em>&quot;SLICE&quot;</em> for Metropis_Hastings and Slice sampling respectively.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier2_+3A_burnin">burnin</code></td>
<td>

<p>The burnin period for the monte-carlo simulation. These are discarded from the returned samples.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier2_+3A_iter">iter</code></td>
<td>
<p> The total number of iterations for which the monte-carlo simulation is run. This includes the burnin period.
The total number of samples returned is <em>iter - burnin</em>
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier2_+3A_nchains">nchains</code></td>
<td>

<p>The number of independent chains to run.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier2_+3A_global.sim.params">global.sim.params</code></td>
<td>

<p>A data frame containing the parameters for the simuation type <em>sim_type</em>. For <em>&quot;MH&quot;</em> the parameter
is the variance of the normal distribution used to simulate the next candidate value centred on the current
value. For <em>&quot;SLICE&quot;</em> the parameters are the estimated width of the slice and a value limiting the search for the next sample.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier2_+3A_sim.params">sim.params</code></td>
<td>

<p>A dataframe containing simulation parameters which override the global simulation parameters (<em>global.sim.params</em>) for particular model
parameters. <em>sim.params</em> must contain the following columns: type: the simulation type (&quot;MH&quot; or &quot;SLICE&quot;); variable: the model parameter 
for which the simulation parameters are being overridden; Outcome.Grp: the outcome grouping (if applicable); Outcome: the outcome (if applicable);
param: the simulation parameter; value: the overridden value; control: the overridden control value.
</p>
<p>The function <em>bhpm.sim.control.params</em> generates a template for <em>sim.params</em> which can be edited by the user.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier2_+3A_monitor">monitor</code></td>
<td>

<p>A dataframe indicating which sets of variables to monitor.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier2_+3A_initial_values">initial_values</code></td>
<td>

<p>The initial values for starting the chains. If NULL (the default) is passed the function generates the initial
values for the chains. initial_values is a list with the following format:
</p>
<pre>
list(gamma, theta, mu.gamma, mu.theta, sigma2.gamma,
		sigma2.theta)
</pre>
<p>where each element of the list is either a dataframe or array.
The function <em>bhpm.gen.initial.values</em> can be used to generate a template for the list which can be updated by the user if required.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier2_+3A_level">level</code></td>
<td>

<p>The level of dependancy between the clusters. 0 - independent clusters, 1 - common cluster means.
dependancy.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier2_+3A_hyper_params">hyper_params</code></td>
<td>

<p>The hyperparameters for the model.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier2_+3A_memory_model">memory_model</code></td>
<td>

<p>Allowed values are &quot;HIGH&quot; and &quot;LOW&quot;. &quot;HIGH&quot; means use as much memory as possible. &quot;LOW&quot; means use the minimum amount of memory.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model is fitted by a Gibbs sampler.
The posterior distributions for <em>gamma</em> and <em>theta</em> are sampled with either a Metropolis-Hastings step or a slice sampler.
</p>


<h3>Value</h3>

<p>The output from the simulation including all the sampled values is as follows:
</p>
<pre>
list(id, sim_type, chains, nClusters, Clusters, Trt.Grps, nOutcome.Grp, maxOutcome.Grps,
	maxOutcomes, nOutcome, Outcome, Outcome.Grp, burnin, iter, monitor,
	mu.gamma, mu.theta, sigma2.gamma, sigma2.theta, gamma,
	theta, gamma_acc, theta_acc)
</pre>
<p>where
</p>
<p><em>id</em> - a string identifying the verion of the function
</p>
<p><em>sim_type</em> - an string identifying the samlping method used for non-standard distributions, either <em>&quot;MH&quot;</em> or <em>&quot;SLICE&quot;</em>
</p>
<p><em>chains</em> - the number of chains for which the simulation was run.
</p>
<p><em>nClusters</em> - the number of clusters in the simulation
</p>
<p><em>Clusters</em> - an array. The clusters.
</p>
<p><em>Trt.Grps</em> - an array. The treatments.
</p>
<p><em>nOutcome.Grp</em> - the number of outcome groupings.
</p>
<p><em>maxOutcome.Grps</em> - the maximum number of outcome groupings in a cluster.
</p>
<p><em>maxOutcomes</em> - the maximum number of outcomes in an outcome grouping.
</p>
<p><em>nOutcome</em> - an array. The number of outcomes in each outcome grouping.
</p>
<p><em>Outcome</em> - an array of dimension <em>nOutcome.Grp</em>, <em>nOutcome</em>. The outcomes.
</p>
<p><em>Outcome.Grp</em> - an array. The outcome groupings.
</p>
<p><em>burnin</em> - burn-in used for the simulation.
</p>
<p><em>iter</em> - the total number of iterations in the simulation.
</p>
<p><em>monitor</em> - the variables being monitored. A dataframe.
</p>
<p><em>mu.gamma</em> - array of generated samples.
</p>
<p><em>mu.theta</em> - array of generated samples.
</p>
<p><em>sigma2.gamma</em> - array of generated samples.
</p>
<p><em>sigma2.theta</em> - array of generated samples.
</p>
<p><em>gamma</em> - array of generated samples.
</p>
<p><em>theta</em> - array of generated samples.
</p>
<p><em>gamma_acc</em> - array of generated samples.
</p>
<p><em>theta_acc</em> - the acceptance rate for the theta samples if a Metropolis-Hastings method is used.
</p>


<h3>Note</h3>

<p>The function performs the simulation and returns the raw output. No checks for convergence are performed. 
</p>


<h3>Author(s)</h3>

<p>R. Carragher
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bhpm.cluster.data1)
raw = bhpm.cluster.1a.hier2(bhpm.cluster.data1, level = 1, burnin = 100, iter = 200)

data(bhpm.cluster.data1)
raw = bhpm.cluster.1a.hier2(bhpm.cluster.data1, level = 1)

</code></pre>

<hr>
<h2 id='bhpm.cluster.1a.hier3'>A Three-Level Hierarchical Model for Grouped Data with Clusters and without Point-Mass.</h2><span id='topic+bhpm.cluster.1a.hier3'></span>

<h3>Description</h3>

<p>Implementation of a Three-Level Hierarchical for Grouped Data with Clusters and without Point-Mass.</p>


<h3>Usage</h3>

<pre><code class='language-R'>	bhpm.cluster.1a.hier3(cluster.data, sim_type = "SLICE", burnin = 10000,
	iter = 40000, nchains = 3,
	global.sim.params = data.frame(type = c("MH", "SLICE"),
	param = c("sigma_MH", "w"), value = c(0.2,1), control = c(0,6),
	stringsAsFactors = FALSE),
	sim.params = NULL,
	monitor = data.frame(variable = c("theta", "gamma", "mu.gamma",
	"mu.theta", "sigma2.theta", "sigma2.gamma",
	"mu.theta.0", "mu.gamma.0", "tau2.theta.0", "tau2.gamma.0"),
	monitor = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
	stringsAsFactors = FALSE),
	initial_values = NULL,
	level = 1,
	hyper_params = list(mu.gamma.0.0 = 0, tau2.gamma.0.0 = 10,
	mu.theta.0.0 = 0, tau2.theta.0.0 = 10, alpha.gamma.0.0 = 3,
	beta.gamma.0.0 = 1, alpha.theta.0.0 = 3, beta.theta.0.0 = 1,
	alpha.gamma = 3, beta.gamma = 1,
	alpha.theta = 3, beta.theta = 1),
	memory_model = "HIGH")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bhpm.cluster.1a.hier3_+3A_cluster.data">cluster.data</code></td>
<td>

<p>A file or data frame containing the cluster data. It must contain the columns <em>Cluster</em>, <em>Outcome.Grp</em>, <em>Outcome</em>, <em>Trt.Grp</em> (1 - control, 2,... comparator treatments), <em>Count</em> (total number of events), <em>Exposure</em> (total exposure of time of all patients for the Trt.Grp in the Cluster).
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier3_+3A_sim_type">sim_type</code></td>
<td>

<p>The type of MCMC method to use for simulating from non-standard distributions. Allowed values are <em>&quot;MH&quot;</em>
and <em>&quot;SLICE&quot;</em> for Metropis_Hastings and Slice sampling respectively.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier3_+3A_burnin">burnin</code></td>
<td>

<p>The burnin period for the monte-carlo simulation. These are discarded from the returned samples.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier3_+3A_iter">iter</code></td>
<td>

<p>The total number of iterations for which the monte-carlo simulation is run. This includes the burnin period.
The total number of samples returned is <em>iter - burnin</em>
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier3_+3A_nchains">nchains</code></td>
<td>

<p>The number of independent chains to run.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier3_+3A_global.sim.params">global.sim.params</code></td>
<td>

<p>A data frame containing the parameters for the simuation type <em>sim_type</em>. For <em>&quot;MH&quot;</em> the parameter
is the variance of the normal distribution used to simulate the next candidate value centred on the current
value. For <em>&quot;SLICE&quot;</em> the parameters are the estimated width of the slice and a value limiting the search for the next sample.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier3_+3A_sim.params">sim.params</code></td>
<td>

<p>A dataframe containing simulation parameters which override the global simulation parameters (<em>global.sim.params</em>) for particular model
parameters. <em>sim.params</em> must contain the following columns: type: the simulation type (&quot;MH&quot; or &quot;SLICE&quot;); variable: the model parameter 
for which the simulation parameters are being overridden; Outcome.Grp (if applicable); Outcome (if applicable);
param: the simulation parameter; value: the overridden value; control: the overridden control value.
</p>
<p>The function <em>bhpm.sim.control.params</em> generates a template for <em>sim.params</em> which can be edited by the user.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier3_+3A_monitor">monitor</code></td>
<td>

<p>A dataframe indicating which sets of variables to monitor.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier3_+3A_initial_values">initial_values</code></td>
<td>

<p>The initial values for starting the chains. If NULL (the default) is passed the function generates the initial
values for the chains. initial_values is a list with the following format:
</p>
<pre>
list(gamma, theta, mu.gamma, mu.theta, sigma2.gamma,
	sigma2.theta, mu.gamma.0, mu.theta.0, tau2.gamma.0,
	tau2.theta.0)
</pre>
<p>where each element of the list is either a dataframe or array.
The function <em>bhpm.gen.initial.values</em> can be used to generate a template for the list which can be updated by the user if required.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier3_+3A_level">level</code></td>
<td>

<p>The level of dependancy between the clusters. 0 - independent clusters, 1 - common cluster means, 2 - weak dependancy between clusters.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier3_+3A_hyper_params">hyper_params</code></td>
<td>

<p>The hyperparameters for the model.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.1a.hier3_+3A_memory_model">memory_model</code></td>
<td>

<p>Allowed values are &quot;HIGH&quot; and &quot;LOW&quot;. &quot;HIGH&quot; means use as much memory as possible. &quot;LOW&quot; means use the minimum amount of memory.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model is fitted by a Gibbs sampler.
The posterior distributions for <em>gamma</em> and <em>theta</em> are sampled with either a Metropolis-Hastings step or a slice sampler.
</p>


<h3>Value</h3>

<p>The output from the simulation including all the sampled values is as follows:
</p>
<pre>
list(id, sim_type, chains, nClusters, Clusters, nOutcome.Grp, maxOutcome.Grps,
	maxOutcomes, nOutcome, Outcome, Outcome.Grp, burnin, iter, monitor,
	mu.gamma.0, mu.theta.0, tau2.gamma.0, tau2.theta.0,
	mu.gamma, mu.theta, sigma2.gamma, sigma2.theta, gamma,
	theta, gamma_acc, theta_acc)
</pre>
<p>where
</p>
<p><em>id</em> - a string identifying the verion of the function
</p>
<p><em>sim_type</em> - an string identifying the samlping method used for non-standard distributions, either <em>&quot;MH&quot;</em> or <em>&quot;SLICE&quot;</em>
</p>
<p><em>chains</em> - the number of chains for which the simulation was run.
</p>
<p><em>nClusters</em> - the number of clusters in the simulation
</p>
<p><em>Clusters</em> - an array. The clusters.
</p>
<p><em>nOutcome.Grp</em> - the number of outcome groupings.
</p>
<p><em>maxOutcome.Grps</em> - the maximum number of outcome groupings in a cluster.
</p>
<p><em>maxOutcomes</em> - the maximum number of outcomes in an outcome grouping.
</p>
<p><em>nOutcome</em> - an array. The number of outcomes in each outcome grouping.
</p>
<p><em>Outcome</em> - an array of dimension <em>nOutcome.Grp</em>, <em>maxOutcomes</em>. The outcomes.
</p>
<p><em>Outcome.Grp</em> - an array. The outcome groupings.
</p>
<p><em>burnin</em> - burnin used for the simulation.
</p>
<p><em>iter</em> - the total number of iterations in the simulation.
</p>
<p><em>monitor</em> - the variables being monitored. A dataframe.
</p>
<p><em>mu.gamma.0</em> - array of generated samples.
</p>
<p><em>mu.theta.0</em> - array of generated samples.
</p>
<p><em>tau2.gamma.0</em> - array of generated samples.
</p>
<p><em>tau2.theta.0</em> - array of generated samples.
</p>
<p><em>mu.gamma</em> - array of generated samples.
</p>
<p><em>mu.theta</em> - array of generated samples.
</p>
<p><em>sigma2.gamma</em> - array of generated samples.
</p>
<p><em>sigma2.theta</em> - array of generated samples.
</p>
<p><em>gamma</em> - array of generated samples.
</p>
<p><em>theta</em> - array of generated samples.
</p>
<p><em>gamma_acc</em> - the acceptance rate for the gamma samples if a Metropolis-Hastings method is used.
</p>
<p><em>theta_acc</em> - the acceptance rate for the theta samples if a Metropolis-Hastings method is used.
</p>


<h3>Note</h3>

<p>The function performs the simulation and returns the raw output. No checks for convergence are performed. 
</p>


<h3>Author(s)</h3>

<p>R. Carragher
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bhpm.cluster.data1)
raw = bhpm.cluster.1a.hier3(bhpm.cluster.data1, level = 1, burnin = 100, iter = 200)

data(bhpm.cluster.data1)
raw = bhpm.cluster.1a.hier3(bhpm.cluster.data1, level = 1)

</code></pre>

<hr>
<h2 id='bhpm.cluster.BB.hier2'>A Two-Level Hierarchical Model for grouped data and clusters with Point-Mass.</h2><span id='topic+bhpm.cluster.BB.hier2'></span>

<h3>Description</h3>

<p>Implementation of a Two-Level Hierarchical for grouped data and clusters with Point-Mass.</p>


<h3>Usage</h3>

<pre><code class='language-R'>	bhpm.cluster.BB.hier2(cluster.data, sim_type = "SLICE", burnin = 20000,
	iter = 60000, nchains = 5, theta_algorithm = "MH",
	global.sim.params = data.frame(type = c("MH", "MH", "MH", "MH",
	"SLICE", "SLICE", "SLICE"),
	param = c("sigma_MH_alpha", "sigma_MH_beta", "sigma_MH_gamma",
	"sigma_MH_theta", "w_alpha", "w_beta", "w_gamma"),
	value = c(3, 3, 0.2, 0.5, 1, 1, 1), control = c(0, 0, 0, 0, 6, 6, 6),
	stringsAsFactors = FALSE),
	sim.params = NULL,
	monitor = data.frame(variable = c("theta", "gamma", "mu.gamma",
	"mu.theta", "sigma2.theta", "sigma2.gamma", "pi"),
	monitor = c(1, 1, 1, 1, 1, 1, 1), stringsAsFactors = FALSE),
	initial_values = NULL, level = 1,
	hyper_params = list(mu.gamma.0 = 0, tau2.gamma.0 = 10, mu.theta.0 = 0,
	tau2.theta.0 = 10, alpha.gamma = 3, beta.gamma = 1, alpha.theta = 3,
	beta.theta = 1, alpha.pi = 1.1, beta.pi = 1.1),
	global.pm.weight = 0.5,
	pm.weights = NULL,
	adapt_phase=1, memory_model = "HIGH")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bhpm.cluster.BB.hier2_+3A_cluster.data">cluster.data</code></td>
<td>

<p>A file or data frame containing the cluster data. It must contain the columns <em>Cluster</em>, <em>Outcome.Grp</em>, <em>Outcome</em>, <em>Trt.Grp</em> (1 - control, 2,... comparator treatments), <em>Count</em> (total number of events), <em>Exposure</em> (total exposure of time of all patients fot the Trt.Grp in the Cluster).
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier2_+3A_burnin">burnin</code></td>
<td>

<p>The burnin period for the monte-carlo simulation. These are discarded from the returned samples.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier2_+3A_iter">iter</code></td>
<td>

<p>The total number of iterations for which the monte-carlo simulation is run. This includes the burnin period.
The total number of samples returned is <em>iter - burnin</em>
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier2_+3A_nchains">nchains</code></td>
<td>

<p>The number of independent chains to run.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier2_+3A_theta_algorithm">theta_algorithm</code></td>
<td>

<p>MCMC algorithm used to sample the theta variables. &quot;MH&quot; is the only currently supported stable algorithm.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier2_+3A_sim_type">sim_type</code></td>
<td>

<p>The type of MCMC method to use for simulating from non-standard distributions apart from theta. Allowed values are <em>&quot;MH&quot;</em> and <em>&quot;SLICE&quot;</em> for Metropis_Hastings and Slice sampling respectively.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier2_+3A_monitor">monitor</code></td>
<td>

<p>A dataframe indicating which sets of variables to monitor.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier2_+3A_global.sim.params">global.sim.params</code></td>
<td>

<p>A data frame containing the parameters for the simuation type <em>sim_type</em>. For <em>&quot;MH&quot;</em> the parameter
is the variance of the normal distribution used to simulate the next candidate value centred on the current
value. For <em>&quot;SLICE&quot;</em> the parameters are the estimated width of the slice and a value limiting the search for the next sample.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier2_+3A_sim.params">sim.params</code></td>
<td>

<p>A dataframe containing simulation parameters which override the global simulation parameters (<em>global.sim.params</em>) for particular model
parameters. <em>sim.params</em> must contain the following columns: type: the simulation type (&quot;MH&quot; or &quot;SLICE&quot;); variable: the model parameter 
for which the simulation parameters are being overridden; Outcome.Grp: the outcome grouping (if applicable); Outcome: the outcome (if applicable);
param: the simulation parameter; value: the overridden value; control: the overridden control value.
</p>
<p>The function <em>bhpm.sim.control.params</em> generates a template for <em>sim.params</em> which can be edited by the user.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier2_+3A_initial_values">initial_values</code></td>
<td>

<p>The initial values for starting the chains. If NULL (the default) is passed the function generates the initial
values for the chains. initial_values is a list with the following format:
</p>
<pre>
list(gamma, theta, mu.gamma, mu.theta, sigma2.gamma,
	sigma2.theta, pi, mu.gamma.0, mu.theta.0,
	tau2.gamma.0, tau2.theta.0, alpha.pi, beta.pi)
</pre>
<p>The function <em>bhpm.gen.initial.values</em> can be used to generate a template for the list which can be updated by the user if required.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier2_+3A_level">level</code></td>
<td>

<p>Allowed valus are 0, 1. Respectively these indicate independent clusters, common means across the clusters.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier2_+3A_hyper_params">hyper_params</code></td>
<td>

<p>The hyperparameters for the model.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier2_+3A_global.pm.weight">global.pm.weight</code></td>
<td>
<p>A global weighting for the proposal distribution used to sample theta.</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier2_+3A_pm.weights">pm.weights</code></td>
<td>
<p>Override global.pm.weight for specific outcomes.</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier2_+3A_adapt_phase">adapt_phase</code></td>
<td>

<p>Unused parameter.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier2_+3A_memory_model">memory_model</code></td>
<td>

<p>Allowed values are &quot;HIGH&quot; and &quot;LOW&quot;. &quot;HIGH&quot; means use as much memory as possible. &quot;LOW&quot; means use the minimum amount of memory.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model is fitted by a Gibbs sampler.
</p>


<h3>Value</h3>

<p>The output from the simulation including all the sampled values is as follows:
</p>
<pre>
list(id, theta_alg, sim_type, chains, nClusters, Clusters, Trt.Grps, nOutcome.Grp,
	maxOutcome.Grps, maxOutcomes, nOutcome, Outcome, Outcome.Grp, burnin,
	iter, monitor,
	mu.gamma, mu.theta, sigma2.gamma, sigma2.theta, pi,
	gamma, theta, gamma_acc, theta_acc)
</pre>
<p>where
</p>
<p><em>id</em> - a string identifying the verions of the function
</p>
<p><em>theta_alg</em> - an string identifying the algorithm used to smaple theta
</p>
<p><em>sim_type</em> - an string identifying the samlping method used for non-standard distributions, either <em>&quot;MH&quot;</em> or <em>&quot;SLICE&quot;</em>
</p>
<p><em>chains</em> - the number of chains for which the simulation was run
</p>
<p><em>nClusters</em> - the number of clusters in the simulation
</p>
<p><em>Clusters</em> - an array. The clusters.
</p>
<p><em>nOutcome.Grp</em> - the number of outcome groupings.
</p>
<p><em>maxOutcome.Grps</em> - the maximum number of outcome groupings in a cluster.
</p>
<p><em>maxOutcomes</em> - the maximum number of outcomes in an outcome grouping.
</p>
<p><em>nOutcome</em> - an array. The number of outcomes in each outcome grouping.
</p>
<p><em>Outcome</em> - an array of dimension <em>nOutcome.Grp</em>, <em>maxOutcomes</em>. The outcomes.
</p>
<p><em>Outcome.Grp</em> - an array. The outcome groupings.
</p>
<p><em>burnin</em> - burnin used for the simulation.
</p>
<p><em>iter</em> - the total number of iterations in the simulation.
</p>
<p><em>monitor</em> - the variables being monitored. A dataframe.
</p>
<p><em>mu.gamma</em> - array of generated samples.
</p>
<p><em>mu.theta</em> - array of generated samples.
</p>
<p><em>sigma2.gamma</em> - array of generated samples.
</p>
<p><em>sigma2.theta</em> - array of generated samples.
</p>
<p><em>pi</em> - array of generated samples.
</p>
<p><em>gamma</em> - array of generated samples.
</p>
<p><em>theta</em> - array of generated samples.
</p>
<p><em>gamma_acc</em> - the acceptance rate for the gamma samples if a Metropolis-Hastings method is used.
</p>
<p><em>theta_acc</em> - the acceptance rate for the theta samples.
</p>


<h3>Note</h3>

<p>The function performs the simulation and returns the raw output. No checks for convergence are performed. 
</p>


<h3>Author(s)</h3>

<p>R. Carragher
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bhpm.cluster.data1)
raw = bhpm.cluster.BB.hier2(bhpm.cluster.data1, level = 1, burnin = 100, iter = 200)

data(bhpm.cluster.data1)
raw = bhpm.cluster.BB.hier2(bhpm.cluster.data1, level = 1)

</code></pre>

<hr>
<h2 id='bhpm.cluster.BB.hier3'>A Three-Level Hierarchical Model for grouped data and clusters with Point-Mass.</h2><span id='topic+bhpm.cluster.BB.hier3'></span>

<h3>Description</h3>

<p>Implementation of a Three-Level Hierarchical for grouped data and clusters with Point-Mass.</p>


<h3>Usage</h3>

<pre><code class='language-R'>	bhpm.cluster.BB.hier3(cluster.data, sim_type = "SLICE", burnin = 20000,
	iter = 60000, nchains = 5, theta_algorithm = "MH",
	global.sim.params = data.frame(type = c("MH", "MH", "MH", "MH",
	"SLICE", "SLICE", "SLICE"),
	param = c("sigma_MH_alpha", "sigma_MH_beta", "sigma_MH_gamma",
	"sigma_MH_theta", "w_alpha", "w_beta", "w_gamma"),
	value = c(3, 3, 0.2, 0.25, 1, 1, 1), control = c(0, 0, 0, 0, 6, 6, 6),
	stringsAsFactors = FALSE),
	sim.params = NULL,
	monitor = data.frame(variable = c("theta", "gamma", "mu.gamma", "mu.theta",
	"sigma2.theta", "sigma2.gamma",
	"mu.theta.0", "mu.gamma.0", "tau2.theta.0", "tau2.gamma.0",
	"pi", "alpha.pi", "beta.pi"),
	monitor = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
	stringsAsFactors = FALSE),
	initial_values = NULL, level = 1, hyper_params = list(mu.gamma.0.0 = 0,
	tau2.gamma.0.0 = 10, mu.theta.0.0 = 0, tau2.theta.0.0 = 10,
	alpha.gamma.0.0 = 3, beta.gamma.0.0 = 1, alpha.theta.0.0 = 3,
	beta.theta.0.0 = 1, alpha.gamma = 3,
	beta.gamma = 1, alpha.theta = 3, beta.theta = 1,
	lambda.alpha = 1.0, lambda.beta = 1.0),
	global.pm.weight = 0.5,
	pm.weights = NULL,
	adapt_phase=1, memory_model = "HIGH")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bhpm.cluster.BB.hier3_+3A_cluster.data">cluster.data</code></td>
<td>

<p>A file or data frame containing the cluster data. It must contain the columns <em>Cluster</em>, <em>Outcome.Grp</em>, <em>Outcome</em>, <em>Trt.Grp</em> (1 - control, 2,... comparator treatments), <em>Count</em> (total number of events), <em>Exposure</em> (total exposure of time of all patients fot the Trt.Grp in the Cluster).
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier3_+3A_burnin">burnin</code></td>
<td>

<p>The burnin period for the monte-carlo simulation. These are discarded from the returned samples.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier3_+3A_iter">iter</code></td>
<td>

<p>The total number of iterations for which the monte-carlo simulation is run. This includes the burnin period.
The total number of samples returned is <em>iter - burnin</em>
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier3_+3A_nchains">nchains</code></td>
<td>

<p>The number of independent chains to run.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier3_+3A_theta_algorithm">theta_algorithm</code></td>
<td>

<p>MCMC algorithm used to sample the theta variables. &quot;MH&quot; is the only currently supported stable algorithm.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier3_+3A_sim_type">sim_type</code></td>
<td>

<p>The type of MCMC method to use for simulating from non-standard distributions apart from theta. Allowed values are <em>&quot;MH&quot;</em> and <em>&quot;SLICE&quot;</em> for Metropis_Hastings and Slice sampling respectively.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier3_+3A_monitor">monitor</code></td>
<td>

<p>A dataframe indicating which sets of variables to monitor.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier3_+3A_global.sim.params">global.sim.params</code></td>
<td>

<p>A data frame containing the parameters for the simuation type <em>sim_type</em>. For <em>&quot;MH&quot;</em> the parameter
is the variance of the normal distribution used to simulate the next candidate value centred on the current
value. For <em>&quot;SLICE&quot;</em> the parameters are the estimated width of the slice and a value limiting the search for the next sample.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier3_+3A_sim.params">sim.params</code></td>
<td>

<p>A dataframe containing simulation parameters which override the global simulation parameters (<em>global.sim.params</em>) for particular model
parameters. <em>sim.params</em> must contain the following columns: type: the simulation type (&quot;MH&quot; or &quot;SLICE&quot;); variable: the model parameter 
for which the simulation parameters are being overridden; Outcome.Grp (if applicable); Outcome (if applicable);
param: the simulation parameter; value: the overridden value; control: the overridden control value.
</p>
<p>The function <em>bhpm.sim.control.params</em> generates a template for <em>sim.params</em> which can be edited by the user.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier3_+3A_initial_values">initial_values</code></td>
<td>

<p>The initial values for starting the chains. If NULL (the default) is passed the function generates the initial
values for the chains. initial_values is a list with the following format:
</p>
<pre>
list(gamma, theta, mu.gamma, mu.theta, sigma2.gamma,
	sigma2.theta, pi, mu.gamma.0, mu.theta.0,
	tau2.gamma.0, tau2.theta.0, alpha.pi, beta.pi)
</pre>
<p>The function <em>bhpm.gen.initial.values</em> can be used to generate a template for the list which can be updated by the user if required.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier3_+3A_level">level</code></td>
<td>

<p>Allowed valus are 0, 1, 2. Respectively these indicate independent clusters, common means across the clusters and weak relationships between the clusters.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier3_+3A_hyper_params">hyper_params</code></td>
<td>

<p>The hyperparameters for the model.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier3_+3A_global.pm.weight">global.pm.weight</code></td>
<td>
<p>A global weighting for the proposal distribution used to sample theta.</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier3_+3A_pm.weights">pm.weights</code></td>
<td>
<p>Override global.pm.weight for specific outcomes.</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier3_+3A_adapt_phase">adapt_phase</code></td>
<td>

<p>Unused parameter.
</p>
</td></tr>
<tr><td><code id="bhpm.cluster.BB.hier3_+3A_memory_model">memory_model</code></td>
<td>

<p>Allowed values are &quot;HIGH&quot; and &quot;LOW&quot;. &quot;HIGH&quot; means use as much memory as possible. &quot;LOW&quot; means use the minimum amount of memory.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model is fitted by a Gibbs sampler.
</p>


<h3>Value</h3>

<p>The output from the simulation including all the sampled values is as follows:
</p>
<pre>
list(id, theta_alg, sim_type, chains, nClusters, Clusters, nOutcome.Grp,
	maxOutcome.Grps, maxOutcomes, nAE, AE, B, burnin,
	iter, monitor, mu.gamma.0, mu.theta.0, tau2.gamma.0, tau2.theta.0,
	mu.gamma, mu.theta, sigma2.gamma, sigma2.theta, pi, alpha.pi, beta.pi,
	alpha.pi_acc, beta.pi_acc, gamma, theta, gamma_acc, theta_acc)
</pre>
<p>where
</p>
<p><em>id</em> - a string identifying the verions of the function.
</p>
<p><em>theta_alg</em> - an string identifying the algorithm used to smaple theta.
</p>
<p><em>sim_type</em> - an string identifying the samlping method used for non-standard distributions, either <em>&quot;MH&quot;</em> or <em>&quot;SLICE&quot;</em>.
</p>
<p><em>chains</em> - the number of chains for which the simulation was run.
</p>
<p><em>nClusters</em> - the number of clusters in the simulation.
</p>
<p><em>Clusters</em> - an array. The clusters.
</p>
<p><em>nOutcome.Grp</em> - the number of outcome groupings.
</p>
<p><em>maxOutcome.Grps</em> - the maximum number of outcome groupings in a cluster.
</p>
<p><em>maxOutcomes</em> - the maximum number of outcome in a outcome grouping.
</p>
<p><em>nOutcome</em> - an array. The number of outcomes in each outcome grouping.
</p>
<p><em>Outcome</em> - an array of dimension <em>nOutcome.Grp</em>, <em>maxOutcomes</em>. The outcomes.
</p>
<p><em>Outcome.Grp</em> - an array. The outcome groupings.
</p>
<p><em>burnin</em> - burnin used for the simulation.
</p>
<p><em>iter</em> - the total number of iterations in the simulation.
</p>
<p><em>monitor</em> - the variables being monitored. A dataframe.
</p>
<p><em>mu.gamma.0</em> - array of generated samples.
</p>
<p><em>mu.theta.0</em> - array of generated samples.
</p>
<p><em>tau2.gamma.0</em> - array of generated samples.
</p>
<p><em>tau2.theta.0</em> - array of generated samples.
</p>
<p><em>mu.gamma</em> - array of generated samples.
</p>
<p><em>mu.theta</em> - array of generated samples.
</p>
<p><em>sigma2.gamma</em> - array of generated samples.
</p>
<p><em>sigma2.theta</em> - array of generated samples.
</p>
<p><em>pi</em> - array of generated samples.
<em>alpha.pi</em> - array of generated samples.
<em>beta.pi</em> - array of generated samples.
</p>
<p><em>alpha.pi_acc</em> - the acceptance rate for the alpha.pi samples if a Metropolis-Hastings method is used.
</p>
<p><em>beta.pi_acc</em> - the acceptance rate for the beta.pi samples if a Metropolis-Hastings method is used.
</p>
<p><em>gamma</em> - array of generated samples.
</p>
<p><em>theta</em> - array of generated samples.
</p>
<p><em>gamma_acc</em> - the acceptance rate for the gamma samples if a Metropolis-Hastings method is used.
</p>
<p><em>theta_acc</em> - the acceptance rate for the theta samples.
</p>


<h3>Note</h3>

<p>The function performs the simulation and returns the raw output. No checks for convergence are performed. 
</p>


<h3>Author(s)</h3>

<p>R. Carragher
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bhpm.cluster.data1)
raw = bhpm.cluster.BB.hier3(bhpm.cluster.data1, level = 1, , burnin = 100, iter = 200)


data(bhpm.cluster.data1)
raw = bhpm.cluster.BB.hier3(bhpm.cluster.data1, level = 1)

</code></pre>

<hr>
<h2 id='bhpm.cluster.data1'>Cluster analysis data.</h2><span id='topic+bhpm.cluster.data1'></span>

<h3>Description</h3>

<p>This dataset contains counts of the outcomes and exposure times for two treatment groups and six clusters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bhpm.cluster.data1)</code></pre>


<h3>Format</h3>

<p>A dataframe with columns <em>Cluster</em>, <em>Outcome.Grp</em>, <em>Outcoome</em>, <em>Trt.Grp</em>, <em>Count</em>, <em>Exposure</em>.
The dataframe contains 1860 observations.</p>

<hr>
<h2 id='bhpm.cluster.data2'>Cluster analysis data.</h2><span id='topic+bhpm.cluster.data2'></span>

<h3>Description</h3>

<p>This dataset contains counts of the coutcome and exposures for two treatments and ten clusters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bhpm.cluster.data2)</code></pre>


<h3>Format</h3>

<p>A dataframe with columns <em>Cluster</em>, <em>Outcome.Grp</em>, <em>Outcome</em>, <em>Trt.Grp</em>, <em>Count</em>, <em>Exposure</em>.
The dataframe contains 1860 observations.</p>

<hr>
<h2 id='bhpm.convergence.diag'>Convergence Diagnostics of the Simulation</h2><span id='topic+bhpm.convergence.diag'></span>

<h3>Description</h3>

<p>The function applies either Gelman-Rubin or the Geweke diagnostic to the raw output of model simulation (e.g. bhpm.cluster.BB.hier3).
It returns the convergence diagnostics and, if applicable, the acceptance rates for the sampling distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	bhpm.convergence.diag(raw, debug_diagnostic = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bhpm.convergence.diag_+3A_raw">raw</code></td>
<td>

<p>The output from a model simulation.
</p>
</td></tr>
<tr><td><code id="bhpm.convergence.diag_+3A_debug_diagnostic">debug_diagnostic</code></td>
<td>

<p>Unused parameter.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function applies one of two convergence diagnostics to the raw output of a model simulation
in order to allow convergence to be assessed. The two diagnotics are:
</p>
<p>i) Gelman-Rubin diagnostic - used when there is more than one chain. A value close to 1 is consistent with
an MCMC simulation which has converged. The &lsquo;coda&rsquo; diagnostic returns a point estimate and upper confidence
limits.
</p>
<p>ii) Geweke diagnostic - used when there is a single chain. A Z-score which is consistent with a standard normal
distribution is expected from an MCMC simulation which has converged.
</p>
<p>The raw sample data is converted to &lsquo;coda&rsquo; format (mcmc objects) and the &lsquo;coda&rsquo; methods gelman.diag and
geweke.diag are used to perform the checks.
</p>


<h3>Value</h3>

<p>Returns a list of the diagnostics for each sampled variable. Each individual element of the list is a
data.frame containing at least the columns <em>type</em>, which is the type of diagnostic
(&lsquo;Gelman-Rubin&rsquo; or &lsquo;Geweke&rsquo;), <em>stat</em>, which is the value of the dignostic, and <em>upper_ci</em> which is
the upper confidence interval for the Gelman-Rubin diagnostic. For the Geweke diagnostic <em>upper_ci</em>
contains the value NA. Depending on the simulation performed the return from <em>bhpm.convergence.diag</em> will contain different
variables.
Columns which may be used to indentify the individual samples are <em>Trt.Grp</em>, <em>Outcome.Grp</em>,
<em>Outcome</em>, and <em>Cluster</em>.
</p>


<h3>Author(s)</h3>

<p>R. Carragher
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bhpm.cluster.data1)
data &lt;- subset(bhpm.cluster.data1, Cluster == '0.0-180.0' | Cluster == '180.0-360.0')
raw = bhpm.npm(data, burnin = 100, iter = 200)
conv = bhpm.convergence.diag(raw)


data(bhpm.cluster.data1)
raw = bhpm.npm(bhpm.cluster.data1)
conv = bhpm.convergence.diag(raw)

</code></pre>

<hr>
<h2 id='bhpm.gen.initial.values'>Generate a template simulation initial values.</h2><span id='topic+bhpm.gen.initial.values'></span>

<h3>Description</h3>

<p>This function generates a template for the initial values to be used to start the simulation. They can be updated by the caller and passed to the simulation function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	bhpm.gen.initial.values(cluster.data, nchains = 3,
						model = "1a", hier = 3, level = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bhpm.gen.initial.values_+3A_cluster.data">cluster.data</code></td>
<td>

<p>A file or data frame containing the data for analysis.
</p>
</td></tr>
<tr><td><code id="bhpm.gen.initial.values_+3A_nchains">nchains</code></td>
<td>

<p>The number of chains in the simulation.
</p>
</td></tr>
<tr><td><code id="bhpm.gen.initial.values_+3A_model">model</code></td>
<td>

<p>The model type: &quot;BB&quot; for point-mass models, &quot;1a&quot; for non-point-mass models.
</p>
</td></tr>
<tr><td><code id="bhpm.gen.initial.values_+3A_hier">hier</code></td>
<td>

<p>Allowed values are 2, 3 indicating two or three level hierarchies.
</p>
</td></tr>
<tr><td><code id="bhpm.gen.initial.values_+3A_level">level</code></td>
<td>

<p>The dependency level in the model: 0, 1, 2.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe containing the template of intial values.
</p>


<h3>Author(s)</h3>

<p>R. Carragher
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bhpm.cluster.data1)
initial.values &lt;- bhpm.gen.initial.values(bhpm.cluster.data1)
print(initial.values$mu.gamma.0)

data(bhpm.cluster.data1)
initial.values &lt;- bhpm.gen.initial.values(bhpm.cluster.data1)
print(initial.values$mu.gamma.0)

</code></pre>

<hr>
<h2 id='bhpm.global.sim.param.defaults'>Generate default global simulation parameters for a model.</h2><span id='topic+bhpm.global.sim.param.defaults'></span>

<h3>Description</h3>

<p>Generate default global simulation parameters for a model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	bhpm.global.sim.param.defaults(model = "BB", hier = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bhpm.global.sim.param.defaults_+3A_model">model</code></td>
<td>

<p>Allowed values are &quot;BB&quot; and &quot;1a&quot; for point-mass and non-point-mass models respectively.
</p>
</td></tr>
<tr><td><code id="bhpm.global.sim.param.defaults_+3A_hier">hier</code></td>
<td>

<p>Allowed values are 2 and 3 two-level and three-level hierarchies repsectively.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe containing the global simulation parameters.
</p>


<h3>Author(s)</h3>

<p>R. Carragher
</p>


<h3>Examples</h3>

<pre><code class='language-R'>g.s.p &lt;- bhpm.global.sim.param.defaults("BB", 3)
print(g.s.p)

g.s.p &lt;- bhpm.global.sim.param.defaults("BB", 3)
print(g.s.p)

</code></pre>

<hr>
<h2 id='bhpm.hyper.param.defaults'>Generate default hyperparameter values for a model.</h2><span id='topic+bhpm.hyper.param.defaults'></span>

<h3>Description</h3>

<p>Generate default hyperparameter values for a model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	bhpm.hyper.param.defaults(model = "BB", hier = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bhpm.hyper.param.defaults_+3A_model">model</code></td>
<td>

<p>Allowed values are &quot;BB&quot; and &quot;1a&quot; for point-mass and non-point-mass models respectively.
</p>
</td></tr>
<tr><td><code id="bhpm.hyper.param.defaults_+3A_hier">hier</code></td>
<td>

<p>Allowed values are 2 and 3 two-level and three-level hierarchies repsectively.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the default parameter values.
</p>


<h3>Author(s)</h3>

<p>R. Carragher
</p>


<h3>Examples</h3>

<pre><code class='language-R'>h.p &lt;- bhpm.hyper.param.defaults("BB", 3)
print(h.p$mu.gamma.0.0)

h.p &lt;- bhpm.hyper.param.defaults("BB", 3)
print(h.p$mu.gamma.0.0)

</code></pre>

<hr>
<h2 id='bhpm.monitor.defaults'>Generate default variable monitor list for a model.</h2><span id='topic+bhpm.monitor.defaults'></span>

<h3>Description</h3>

<p>Generate default variable monitor list for a model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	bhpm.monitor.defaults(model = "BB", hier = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bhpm.monitor.defaults_+3A_model">model</code></td>
<td>

<p>Allowed values are &quot;BB&quot; and &quot;1a&quot; for point-mass and non-point-mass models respectively.
</p>
</td></tr>
<tr><td><code id="bhpm.monitor.defaults_+3A_hier">hier</code></td>
<td>

<p>Allowed values are 2 and 3 two-level and three-level hierarchies repsectively.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe containing the default monitored variables.
</p>


<h3>Author(s)</h3>

<p>R. Carragher
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mon &lt;- bhpm.monitor.defaults("BB", 3)
print(mon)

mon &lt;- bhpm.monitor.defaults("BB", 3)
print(mon)

</code></pre>

<hr>
<h2 id='bhpm.monitor.samples'>Generate a template for choosing which samples to monitor.</h2><span id='topic+bhpm.monitor.samples'></span>

<h3>Description</h3>

<p>This function generate a template for choosing which samples to monitor based on the model and hierarchy. As some of the MCMC model 
simulations require large amounts of memory choosing not to monitor samples reduced the overall memory footprint.</p>


<h3>Usage</h3>

<pre><code class='language-R'>	bhpm.monitor.samples(model = "1a", hier = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bhpm.monitor.samples_+3A_model">model</code></td>
<td>

<p>Allowed values are &quot;1a&quot; and &quot;BB&quot;. &quot;BB&quot; models include a point-mass. 
</p>
</td></tr>
<tr><td><code id="bhpm.monitor.samples_+3A_hier">hier</code></td>
<td>

<p>Allowed values are 2 and 3. Generate a template for a 2 or 3 level hierarchy.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe containing two columns:
</p>
<p><em>variable</em>: the name of a class of variables e.g. &quot;theta&quot;
<em>monitor</em>: 0 - don't monitor, 1 - monitor.
</p>


<h3>Author(s)</h3>

<p>R. Carragher
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mon &lt;- bhpm.monitor.samples("1a", hier = 3)
print(mon)

mon &lt;- bhpm.monitor.samples("1a", hier = 3)
print(mon)

</code></pre>

<hr>
<h2 id='bhpm.multi.treatments'>Cluster analysis data.</h2><span id='topic+bhpm.multi.treatments'></span>

<h3>Description</h3>

<p>This data set contains counts of outcomes and exposure times for four treatments over all six clusters of an observational study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bhpm.multi.treatments)</code></pre>


<h3>Format</h3>

<p>A dataframe with columns <em>Cluster</em>, <em>Outcome.Grp</em>, <em>Outcome</em>, <em>Trt.Grp</em>, <em>Count</em>, <em>Exposure</em>.
The dataframe contains 3720 observations.</p>

<hr>
<h2 id='bhpm.multi.treatments.random.order'>Cluster analysis data.</h2><span id='topic+bhpm.multi.treatments.random.order'></span>

<h3>Description</h3>

<p>This data set contains count of outcome for four treatments over six clusters of an observational study. The data are in random order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bhpm.multi.treatments.random.order)</code></pre>


<h3>Format</h3>

<p>A dataframe with columns <em>Cluster</em>, <em>Outcome.Grp</em>, <em>Outcome</em>, <em>Trt.Grp</em>, <em>Count</em>, <em>Exposure</em>.
The dataframe contains 3720 observations.</p>

<hr>
<h2 id='bhpm.npm'>Fit a  Bayesian Hierarchical Model for Grouped Data with Clusters and without Point-Mass.</h2><span id='topic+bhpm.npm'></span>

<h3>Description</h3>

<p>Implementation of a Bayesian Hierarchical for Grouped Data with Clusters and without Point-Mass.</p>


<h3>Usage</h3>

<pre><code class='language-R'>	bhpm.npm(cluster.data, hier = 3, sim_type = "SLICE", burnin = 10000,
	iter = 40000, nchains = 3,
	global.sim.params = NULL,
	sim.params = NULL,
	monitor = NULL,
	initial_values = NULL,
	level = 1,
	hyper_params = NULL,
	memory_model = "HIGH")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bhpm.npm_+3A_cluster.data">cluster.data</code></td>
<td>

<p>A file or data frame containing the cluster data. It must contain the columns <em>Cluster</em>, <em>Outcome.Grp</em>, <em>Outcome</em>, <em>Trt.Grp</em> (1 - control, 2,... comparator treatments), <em>Count</em> (total number of events), <em>Exposure</em> (total exposure of time of all patients for the Trt.Grp in the Cluster).
</p>
</td></tr>
<tr><td><code id="bhpm.npm_+3A_hier">hier</code></td>
<td>

<p>Fit a 2 or 3 level hierarcical model.
</p>
</td></tr>
<tr><td><code id="bhpm.npm_+3A_sim_type">sim_type</code></td>
<td>

<p>The type of MCMC method to use for simulating from non-standard distributions. Allowed values are <em>&quot;MH&quot;</em>
and <em>&quot;SLICE&quot;</em> for Metropis_Hastings and Slice sampling respectively.
</p>
</td></tr>
<tr><td><code id="bhpm.npm_+3A_burnin">burnin</code></td>
<td>

<p>The burnin period for the monte-carlo simulation. These are discarded from the returned samples.
</p>
</td></tr>
<tr><td><code id="bhpm.npm_+3A_iter">iter</code></td>
<td>

<p>The total number of iterations for which the monte-carlo simulation is run. This includes the burnin period.
The total number of samples returned is <em>iter - burnin</em>
</p>
</td></tr>
<tr><td><code id="bhpm.npm_+3A_nchains">nchains</code></td>
<td>

<p>The number of independent chains to run.
</p>
</td></tr>
<tr><td><code id="bhpm.npm_+3A_global.sim.params">global.sim.params</code></td>
<td>

<p>A data frame containing the parameters for the simuation type <em>sim_type</em>. For <em>&quot;MH&quot;</em> the parameter
is the variance of the normal distribution used to simulate the next candidate value centred on the current
value. For <em>&quot;SLICE&quot;</em> the parameters are the estimated width of the slice and a value limiting the search for the next sample.
Passing NULL uses the model defaults.
</p>
</td></tr>
<tr><td><code id="bhpm.npm_+3A_sim.params">sim.params</code></td>
<td>

<p>A dataframe containing simulation parameters which override the global simulation parameters (<em>global.sim.params</em>) for particular model
parameters. <em>sim.params</em> must contain the following columns: type: the simulation type (&quot;MH&quot; or &quot;SLICE&quot;); variable: the model parameter 
for which the simulation parameters are being overridden; Outcome.Grp (if applicable); Outcome (if applicable);
param: the simulation parameter; value: the overridden value; control: the overridden control value.
</p>
<p>The function <em>bhpm.sim.control.params</em> generates a template for <em>sim.params</em> which can be edited by the user.
</p>
</td></tr>
<tr><td><code id="bhpm.npm_+3A_monitor">monitor</code></td>
<td>

<p>A dataframe indicating which sets of variables to monitor.
Passing NULL uses the model defaults.
</p>
</td></tr>
<tr><td><code id="bhpm.npm_+3A_initial_values">initial_values</code></td>
<td>

<p>The initial values for starting the chains. If NULL (the default) is passed the function generates the initial
values for the chains. initial_values is a list with the following format:
</p>
<pre>
list(gamma, theta, mu.gamma, mu.theta, sigma2.gamma,
	sigma2.theta, mu.gamma.0, mu.theta.0, tau2.gamma.0,
	tau2.theta.0)
</pre>
<p>where each element of the list is either a dataframe or array.
The function <em>bhpm.gen.initial.values</em> can be used to generate a template for the list which can be updated by the user if required.
</p>
</td></tr>
<tr><td><code id="bhpm.npm_+3A_level">level</code></td>
<td>

<p>The level of dependancy between the clusters. 0 - independent clusters, 1 - common cluster means, 2 - weak dependancy between clusters.
</p>
</td></tr>
<tr><td><code id="bhpm.npm_+3A_hyper_params">hyper_params</code></td>
<td>

<p>The hyperparameters for the model.
Passing NULL uses the model defaults.
</p>
</td></tr>
<tr><td><code id="bhpm.npm_+3A_memory_model">memory_model</code></td>
<td>

<p>Allowed values are &quot;HIGH&quot; and &quot;LOW&quot;. &quot;HIGH&quot; means use as much memory as possible. &quot;LOW&quot; means use the minimum amount of memory.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model is fitted by a Gibbs sampler.
The posterior distributions for <em>gamma</em> and <em>theta</em> are sampled with either a Metropolis-Hastings step or a slice sampler.
</p>


<h3>Value</h3>

<p>The output from the simulation including all the sampled values is as follows:
</p>
<pre>
list(id, sim_type, chains, nClusters, Clusters, nOutcome.Grp, maxOutcome.Grps,
	maxOutcomes, nOutcome, Outcome, Outcome.Grp, burnin, iter, monitor,
	mu.gamma.0, mu.theta.0, tau2.gamma.0, tau2.theta.0,
	mu.gamma, mu.theta, sigma2.gamma, sigma2.theta, gamma,
	theta, gamma_acc, theta_acc)
</pre>
<p>where
</p>
<p><em>id</em> - a string identifying the verion of the function
</p>
<p><em>sim_type</em> - an string identifying the samlping method used for non-standard distributions, either <em>&quot;MH&quot;</em> or <em>&quot;SLICE&quot;</em>
</p>
<p><em>chains</em> - the number of chains for which the simulation was run.
</p>
<p><em>nClusters</em> - the number of clusters in the simulation
</p>
<p><em>Clusters</em> - an array. The clusters.
</p>
<p><em>nOutcome.Grp</em> - the number of outcome groupings.
</p>
<p><em>maxOutcome.Grps</em> - the maximum number of outcome groupings in a cluster.
</p>
<p><em>maxOutcomes</em> - the maximum number of outcomes in an outcome grouping.
</p>
<p><em>nOutcome</em> - an array. The number of outcomes in each outcome grouping.
</p>
<p><em>Outcome</em> - an array of dimension <em>nOutcome.Grp</em>, <em>maxOutcomes</em>. The outcomes.
</p>
<p><em>Outcome.Grp</em> - an array. The outcome groupings.
</p>
<p><em>burnin</em> - burnin used for the simulation.
</p>
<p><em>iter</em> - the total number of iterations in the simulation.
</p>
<p><em>monitor</em> - the variables being monitored. A dataframe.
</p>
<p><em>mu.gamma.0</em> - array of generated samples.
</p>
<p><em>mu.theta.0</em> - array of generated samples.
</p>
<p><em>tau2.gamma.0</em> - array of generated samples.
</p>
<p><em>tau2.theta.0</em> - array of generated samples.
</p>
<p><em>mu.gamma</em> - array of generated samples.
</p>
<p><em>mu.theta</em> - array of generated samples.
</p>
<p><em>sigma2.gamma</em> - array of generated samples.
</p>
<p><em>sigma2.theta</em> - array of generated samples.
</p>
<p><em>gamma</em> - array of generated samples.
</p>
<p><em>theta</em> - array of generated samples.
</p>
<p><em>gamma_acc</em> - the acceptance rate for the gamma samples if a Metropolis-Hastings method is used.
</p>
<p><em>theta_acc</em> - the acceptance rate for the theta samples if a Metropolis-Hastings method is used.
</p>


<h3>Note</h3>

<p>The function performs the simulation and returns the raw output. No checks for convergence are performed. 
</p>


<h3>Author(s)</h3>

<p>R. Carragher
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bhpm.cluster.data1)
raw = bhpm.npm(cluster.data = bhpm.cluster.data1, burnin = 100, iter = 200)

data(bhpm.cluster.data1)
raw = bhpm.npm(cluster.data = bhpm.cluster.data1, level = 1)

</code></pre>

<hr>
<h2 id='bhpm.pm'>A Bayesian Hierarchical Model for grouped data and clusters with Point-Mass.</h2><span id='topic+bhpm.pm'></span>

<h3>Description</h3>

<p>Implementation of a bayesian Hierarchical for grouped data and clusters with Point-Mass.</p>


<h3>Usage</h3>

<pre><code class='language-R'>	bhpm.pm(cluster.data, hier = 3, sim_type = "SLICE", burnin = 20000,
	iter = 60000, nchains = 5, theta_algorithm = "MH",
	global.sim.params = NULL,
	sim.params = NULL,
	monitor = NULL,
	initial_values = NULL, level = 1, hyper_params = NULL,
	global.pm.weight = 0.5,
	pm.weights = NULL,
	adapt_phase=1, memory_model = "HIGH")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bhpm.pm_+3A_cluster.data">cluster.data</code></td>
<td>

<p>A file or data frame containing the cluster data. It must contain the columns <em>Cluster</em>, <em>Outcome.Grp</em>, <em>Outcome</em>, <em>Trt.Grp</em> (1 - control, 2,... comparator treatments), <em>Count</em> (total number of events), <em>Exposure</em> (total exposure of time of all patients fot the Trt.Grp in the Cluster).
</p>
</td></tr>
<tr><td><code id="bhpm.pm_+3A_hier">hier</code></td>
<td>

<p>Fit a 2 or 3 level model.
</p>
</td></tr>
<tr><td><code id="bhpm.pm_+3A_burnin">burnin</code></td>
<td>

<p>The burnin period for the monte-carlo simulation. These are discarded from the returned samples.
</p>
</td></tr>
<tr><td><code id="bhpm.pm_+3A_iter">iter</code></td>
<td>

<p>The total number of iterations for which the monte-carlo simulation is run. This includes the burnin period.
The total number of samples returned is <em>iter - burnin</em>
</p>
</td></tr>
<tr><td><code id="bhpm.pm_+3A_nchains">nchains</code></td>
<td>

<p>The number of independent chains to run.
</p>
</td></tr>
<tr><td><code id="bhpm.pm_+3A_theta_algorithm">theta_algorithm</code></td>
<td>

<p>MCMC algorithm used to sample the theta variables. &quot;MH&quot; is the only currently supported stable algorithm.
</p>
</td></tr>
<tr><td><code id="bhpm.pm_+3A_sim_type">sim_type</code></td>
<td>

<p>The type of MCMC method to use for simulating from non-standard distributions apart from theta. Allowed values are <em>&quot;MH&quot;</em> and <em>&quot;SLICE&quot;</em> for Metropis_Hastings and Slice sampling respectively.
</p>
</td></tr>
<tr><td><code id="bhpm.pm_+3A_monitor">monitor</code></td>
<td>

<p>A dataframe indicating which sets of variables to monitor.
Passing NULL uses the model defaults.
</p>
</td></tr>
<tr><td><code id="bhpm.pm_+3A_global.sim.params">global.sim.params</code></td>
<td>

<p>A data frame containing the parameters for the simuation type <em>sim_type</em>. For <em>&quot;MH&quot;</em> the parameter
is the variance of the normal distribution used to simulate the next candidate value centred on the current
value. For <em>&quot;SLICE&quot;</em> the parameters are the estimated width of the slice and a value limiting the search for the next sample.
Passing NULL uses the model defaults.
</p>
</td></tr>
<tr><td><code id="bhpm.pm_+3A_sim.params">sim.params</code></td>
<td>

<p>A dataframe containing simulation parameters which override the global simulation parameters (<em>global.sim.params</em>) for particular model
parameters. <em>sim.params</em> must contain the following columns: type: the simulation type (&quot;MH&quot; or &quot;SLICE&quot;); variable: the model parameter 
for which the simulation parameters are being overridden; Outcome.Grp (if applicable); Outcome (if applicable);
param: the simulation parameter; value: the overridden value; control: the overridden control value.
</p>
<p>The function <em>bhpm.sim.control.params</em> generates a template for <em>sim.params</em> which can be edited by the user.
</p>
</td></tr>
<tr><td><code id="bhpm.pm_+3A_initial_values">initial_values</code></td>
<td>

<p>The initial values for starting the chains. If NULL (the default) is passed the function generates the initial
values for the chains. initial_values is a list with the following format:
</p>
<pre>
list(gamma, theta, mu.gamma, mu.theta, sigma2.gamma,
	sigma2.theta, pi, mu.gamma.0, mu.theta.0,
	tau2.gamma.0, tau2.theta.0, alpha.pi, beta.pi)
</pre>
<p>The function <em>bhpm.gen.initial.values</em> can be used to generate a template for the list which can be updated by the user if required.
</p>
</td></tr>
<tr><td><code id="bhpm.pm_+3A_level">level</code></td>
<td>

<p>Allowed valus are 0, 1, 2. Respectively these indicate independent clusters, common means across the clusters and weak relationships between the clusters.
</p>
</td></tr>
<tr><td><code id="bhpm.pm_+3A_hyper_params">hyper_params</code></td>
<td>

<p>The hyperparameters for the model.
Passing NULL uses the model defaults.
</p>
</td></tr>
<tr><td><code id="bhpm.pm_+3A_global.pm.weight">global.pm.weight</code></td>
<td>
<p>A global weighting for the proposal distribution used to sample theta.</p>
</td></tr>
<tr><td><code id="bhpm.pm_+3A_pm.weights">pm.weights</code></td>
<td>
<p>Override global.pm.weight for specific outcomes.</p>
</td></tr>
<tr><td><code id="bhpm.pm_+3A_adapt_phase">adapt_phase</code></td>
<td>

<p>Unused parameter.
</p>
</td></tr>
<tr><td><code id="bhpm.pm_+3A_memory_model">memory_model</code></td>
<td>

<p>Allowed values are &quot;HIGH&quot; and &quot;LOW&quot;. &quot;HIGH&quot; means use as much memory as possible. &quot;LOW&quot; means use the minimum amount of memory.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model is fitted by a Gibbs sampler.
</p>


<h3>Value</h3>

<p>The output from the simulation including all the sampled values is as follows:
</p>
<pre>
list(id, theta_alg, sim_type, chains, nClusters, Clusters, nOutcome.Grp,
	maxOutcome.Grps, maxOutcomes, nAE, AE, B, burnin,
	iter, monitor, mu.gamma.0, mu.theta.0, tau2.gamma.0, tau2.theta.0,
	mu.gamma, mu.theta, sigma2.gamma, sigma2.theta, pi, alpha.pi, beta.pi,
	alpha.pi_acc, beta.pi_acc, gamma, theta, gamma_acc, theta_acc)
</pre>
<p>where
</p>
<p><em>id</em> - a string identifying the verions of the function.
</p>
<p><em>theta_alg</em> - an string identifying the algorithm used to smaple theta.
</p>
<p><em>sim_type</em> - an string identifying the samlping method used for non-standard distributions, either <em>&quot;MH&quot;</em> or <em>&quot;SLICE&quot;</em>.
</p>
<p><em>chains</em> - the number of chains for which the simulation was run.
</p>
<p><em>nClusters</em> - the number of clusters in the simulation.
</p>
<p><em>Clusters</em> - an array. The clusters.
</p>
<p><em>nOutcome.Grp</em> - the number of outcome groupings.
</p>
<p><em>maxOutcome.Grps</em> - the maximum number of outcome groupings in a cluster.
</p>
<p><em>maxOutcomes</em> - the maximum number of outcome in a outcome grouping.
</p>
<p><em>nOutcome</em> - an array. The number of outcomes in each outcome grouping.
</p>
<p><em>Outcome</em> - an array of dimension <em>nOutcome.Grp</em>, <em>maxOutcomes</em>. The outcomes.
</p>
<p><em>Outcome.Grp</em> - an array. The outcome groupings.
</p>
<p><em>burnin</em> - burnin used for the simulation.
</p>
<p><em>iter</em> - the total number of iterations in the simulation.
</p>
<p><em>monitor</em> - the variables being monitored. A dataframe.
</p>
<p><em>mu.gamma.0</em> - array of generated samples.
</p>
<p><em>mu.theta.0</em> - array of generated samples.
</p>
<p><em>tau2.gamma.0</em> - array of generated samples.
</p>
<p><em>tau2.theta.0</em> - array of generated samples.
</p>
<p><em>mu.gamma</em> - array of generated samples.
</p>
<p><em>mu.theta</em> - array of generated samples.
</p>
<p><em>sigma2.gamma</em> - array of generated samples.
</p>
<p><em>sigma2.theta</em> - array of generated samples.
</p>
<p><em>pi</em> - array of generated samples.
<em>alpha.pi</em> - array of generated samples.
<em>beta.pi</em> - array of generated samples.
</p>
<p><em>alpha.pi_acc</em> - the acceptance rate for the alpha.pi samples if a Metropolis-Hastings method is used.
</p>
<p><em>beta.pi_acc</em> - the acceptance rate for the beta.pi samples if a Metropolis-Hastings method is used.
</p>
<p><em>gamma</em> - array of generated samples.
</p>
<p><em>theta</em> - array of generated samples.
</p>
<p><em>gamma_acc</em> - the acceptance rate for the gamma samples if a Metropolis-Hastings method is used.
</p>
<p><em>theta_acc</em> - the acceptance rate for the theta samples.
</p>


<h3>Note</h3>

<p>The function performs the simulation and returns the raw output. No checks for convergence are performed. 
</p>


<h3>Author(s)</h3>

<p>R. Carragher
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(bhpm.cluster.data1)
raw = bhpm.pm(cluster.data = bhpm.cluster.data1, burnin = 100, iter = 200)


data(bhpm.cluster.data1)
raw = bhpm.pm(cluster.data = bhpm.cluster.data1)

</code></pre>

<hr>
<h2 id='bhpm.pointmass.weights'>Generate a template for the point-mass weightings.</h2><span id='topic+bhpm.pointmass.weights'></span>

<h3>Description</h3>

<p>This function generate a template for weights for the proposal distribution used to sample <em>theta</em> variables in models which 
use a point-mass.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	bhpm.pointmass.weights(cluster.data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bhpm.pointmass.weights_+3A_cluster.data">cluster.data</code></td>
<td>

<p>A file or data frame containing the cluster data for analysis.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe containing the weightings template for each outcome grouping, outcome and, if required, cluster.
</p>


<h3>Author(s)</h3>

<p>R. Carragher
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bhpm.cluster.data1)
pmw &lt;- bhpm.pointmass.weights(bhpm.cluster.data1)
head(pmw, 2)
</code></pre>

<hr>
<h2 id='bhpm.print.convergence.summary'>Print a Summary of the Convergence Diagnostics of the Simulation</h2><span id='topic+bhpm.print.convergence.summary'></span>

<h3>Description</h3>

<p>The function prints the maximum and minimum values of either Gelman-Rubin diagnostic or the Geweke diagnostic
for each group of samples, e.g. theta, gamma, mu.gamma etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	bhpm.print.convergence.summary(conv)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bhpm.print.convergence.summary_+3A_conv">conv</code></td>
<td>

<p>The output from a call to <em>bhpm.check.convergence</em>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Note</h3>

<p>The Geweke statistic is a Z-score calculated from a single chain. Due to the large number of variables sampled
it is possible that a certain number will be deemed significant (at the 5% level) even though the simulation
may have converged.
</p>


<h3>Author(s)</h3>

<p>R. Carragher
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bhpm.cluster.data1)
data &lt;- subset(bhpm.cluster.data1, Cluster == '0.0-180.0' | Cluster == '180.0-360.0')
raw = bhpm.npm(data, burnin = 100, iter = 200)
conv = bhpm.convergence.diag(raw)
bhpm.print.convergence.summary(conv)

data(bhpm.cluster.data1)
raw = bhpm.npm(bhpm.cluster.data1)
conv = bhpm.convergence.diag(raw)
bhpm.print.convergence.summary(conv)

</code></pre>

<hr>
<h2 id='bhpm.print.summary.stats'>Print the Summary Statistics of Posterior Distributions</h2><span id='topic+bhpm.print.summary.stats'></span>

<h3>Description</h3>

<p>The function prints the variable names, the mean, the HPI interval, the standard distribtion and the
MCMC standard error for the simulated sample.</p>


<h3>Usage</h3>

<pre><code class='language-R'>	bhpm.print.summary.stats(summ)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bhpm.print.summary.stats_+3A_summ">summ</code></td>
<td>

<p>The output from a call to bhpm.summary.stats
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Author(s)</h3>

<p>R. Carragher
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bhpm.cluster.data1)
data &lt;- subset(bhpm.cluster.data1, Cluster == '0.0-180.0')
raw = bhpm.npm(data, burnin = 100, iter = 200)
summ = bhpm.summary.stats(raw)
bhpm.print.summary.stats(summ)


data(bhpm.cluster.data1)
raw = bhpm.npm(bhpm.cluster.data1)
summ = bhpm.summary.stats(raw)
bhpm.print.summary.stats(summ)

</code></pre>

<hr>
<h2 id='bhpm.ptheta'>Reports the posterior probability that theta (the increase in the log-odds) is greater than zero, zero, and less than zero for each outcome</h2><span id='topic+bhpm.ptheta'></span>

<h3>Description</h3>

<p>This function reports the posterior probability that theta is positive negative or zero, i.e. that there is an increase, decrease, or no difference in the log
odds of an outcome being associated with treatment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	bhpm.ptheta(raw)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bhpm.ptheta_+3A_raw">raw</code></td>
<td>

<p>The output from a call to one of bhpm.cluster.BB.hier3, bhpm.cluster.1a.hier3, bhpm.cluster.BB.hier2, bhpm.cluster.1a.hier2.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the columns: <em>Trt.Grp</em>, <em>Cluster</em>, <em>Outcome.Grp</em>, <em>Outcome</em>, <em>ptheta</em>, <em>ptheta.pos</em>, <em>ptheta.zero</em>, <em>ptheta.neg</em>.
</p>


<h3>Author(s)</h3>

<p>R. Carragher
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(bhpm.cluster.data1)
data &lt;- subset(bhpm.cluster.data1, Cluster == '0.0-180.0' | Cluster == '180.0-360.0')
raw = bhpm.npm(data, burnin = 10, iter = 100)
p = bhpm.ptheta(raw)
head(p, 2)


data(bhpm.cluster.data1)
raw = bhpm.npm(bhpm.cluster.data1)
p = bhpm.ptheta(raw)
head(p, 2)

</code></pre>

<hr>
<h2 id='bhpm.sim.control.params'>Generate a template for the individual model parameter simulation control parameters.</h2><span id='topic+bhpm.sim.control.params'></span>

<h3>Description</h3>

<p>This function generates a template for overriding the global simulation parameters used by the model simulation functions (e.g. bhpm.cluster.BB.hier3).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	bhpm.sim.control.params(cluster.data, model = "1a")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bhpm.sim.control.params_+3A_cluster.data">cluster.data</code></td>
<td>

<p>A file or data frame containing the cluster data.
</p>
</td></tr>
<tr><td><code id="bhpm.sim.control.params_+3A_model">model</code></td>
<td>

<p>Allowed values are &quot;BB&quot; and &quot;1a&quot; for point-mass and non-point-mass models respectively.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe containing the simulation parameters template.
</p>


<h3>Author(s)</h3>

<p>R. Carragher
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bhpm.cluster.data1)
s.c.p &lt;- bhpm.sim.control.params(bhpm.cluster.data1)
head(s.c.p)

data(bhpm.cluster.data1)
s.c.p &lt;- bhpm.sim.control.params(bhpm.cluster.data1)
head(s.c.p)

</code></pre>

<hr>
<h2 id='bhpm.summary.stats'>Summary Statistics for the Posterior Distributions in the model.</h2><span id='topic+bhpm.summary.stats'></span>

<h3>Description</h3>

<p>Returns the Summary Statistics for the Posterior Distributions in the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	bhpm.summary.stats(raw, prob)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bhpm.summary.stats_+3A_raw">raw</code></td>
<td>

<p>The output from a model simulation (e.g. bhpm.cluster.BB.hier3).
</p>
</td></tr>
<tr><td><code id="bhpm.summary.stats_+3A_prob">prob</code></td>
<td>

<p>The probability level for HPI. Default is 0.95.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function reports the mean, upper and lower bounds of the HPI (highest probabily interval), the 
standard deviation and MCMC standard error.
</p>


<h3>Value</h3>

<p>Returns a list of the summary statistics for each sampled variable.
Each element of the list is a data.frame containing at least the columns <em>mean</em>, <em>median</em>, <em>hpi_lower</em>,
<em>hpi_upper</em>, <em>SD</em> and <em>SE</em>.
Columns which may be used to indentify the individual variables are <em>Outcome.Grp</em>, <em>Outcome</em>, and <em>Cluster</em>.
</p>


<h3>Note</h3>

<p>The MCMC error is found using the 'coda' summary function.
</p>


<h3>Author(s)</h3>

<p>R. Carragher
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bhpm.cluster.data1)
data &lt;- subset(bhpm.cluster.data1, Cluster == '0.0-180.0')
raw = bhpm.npm(data, burnin = 100, iter = 200)
summ = bhpm.summary.stats(raw)


data(bhpm.cluster.data1)
raw = bhpm.npm(bhpm.cluster.data1)
summ = bhpm.summary.stats(raw)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
