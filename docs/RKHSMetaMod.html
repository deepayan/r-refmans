<!DOCTYPE html><html><head><title>Help for package RKHSMetaMod</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RKHSMetaMod}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#RKHSMetaMod-package'>
<p>Set of Rcpp and R functions to produce a sequence of meta models that are the solutions of the RKHS Ridge Group Sparse or RKHS Group Lasso optimization problems, calulate their associated prediction errors as well as their empirical sensitivity indices.</p></a></li>
<li><a href='#calc_Kv'>
<p>Function to calculate the Gram matrices and their eigenvalues and eigenvectors for a chosen reproducing kernel.</p></a></li>
<li><a href='#grplasso_q'>
<p>Function to fit a solution with q active groups of an RKHS Group Lasso problem.</p></a></li>
<li><a href='#mu_max'>
<p>Function to find the maximal value of the penalty parameter in the RKHS Group Lasso problem.</p></a></li>
<li><a href='#pen_MetMod'>
<p>Function to fit a solution of the RKHS Ridge Group Sparse problem.</p></a></li>
<li><a href='#PredErr'>
<p>Function to calculate the prediction error.</p></a></li>
<li><a href='#RKHSgrplasso'>
<p>Function to fit a solution of an RKHS Group Lasso problem.</p></a></li>
<li><a href='#RKHSMetMod'>
<p>Function to produce a sequence of meta models that are the solutions of the RKHS Ridge Group Sparse or RKHS Group Lasso optimization problems.</p></a></li>
<li><a href='#RKHSMetMod_qmax'>
<p>Function to produce a sequence of meta models, with at most qmax active groups in each meta model. The meta models are the solutions of the RKHS Ridge Group Sparse or RKHS Group Lasso optimization problems.</p></a></li>
<li><a href='#SI_emp'>
<p>Function to calculate the empirical sensitivity indices for an input or a group of inputs.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Ridge Group Sparse Optimization Problem for Estimation of a Meta
Model Based on Reproducing Kernel Hilbert Spaces</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-07-06</td>
</tr>
<tr>
<td>Author:</td>
<td>Halaleh Kamari </td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Halaleh Kamari &lt;halaleh.kamari@univ-evry.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates the Hoeffding decomposition of an unknown function by solving ridge group sparse optimization problem based on reproducing kernel Hilbert spaces, and approximates its sensitivity indices (see Kamari, H., Huet, S. and Taupin, M.-L. (2019) &lt;<a href="https://doi.org/10.48550/arXiv.1905.13695">doi:10.48550/arXiv.1905.13695</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>lhs</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen, RcppGSL</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-07-06 17:51:59 UTC; hkamari</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-07-06 22:10:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='RKHSMetaMod-package'>
Set of Rcpp and R functions to produce a sequence of meta models that are the solutions of the RKHS Ridge Group Sparse or RKHS Group Lasso optimization problems, calulate their associated prediction errors as well as their empirical sensitivity indices.
</h2><span id='topic+RKHSMetaMod-package'></span><span id='topic+RKHSMetaMod'></span>

<h3>Description</h3>

<p>Fits a meta model to an unknown model <code class="reqn">m</code> by solving the ridge group sparse (or group lasso) optimization problem based on the reproducing kernel Hilbert spaces (RKHS), for the Gaussian regression model : </p>
<p style="text-align: center;"><code class="reqn">Y=m(X)+\sigma\varepsilon,</code>
</p>

<p>where variables <code class="reqn">X_{1},...,X_{d}</code> are independent and uniformly distributed on <code class="reqn">[0,1]</code> and are independent of <code class="reqn">\varepsilon</code>'s.
</p>
<p>We define the ridge group sparse criteria by :
</p>
<p style="text-align: center;"><code class="reqn">C(f_{0},\theta)=\Vert Y-f_{0}I_{n}-\sum_{v\in\mathcal{P}}K_{v}\theta_{v}\Vert ^2+\sqrt{n}\gamma\sum_{v\in\mathcal{P}}\Vert K_v\theta_{v}\Vert +n\mu\sum_{v\in\mathcal{P}}\Vert K_{v}^{1/2}\theta_{v}\Vert,</code>
</p>

<p>and the group lasso criteria is obtained by setting <code class="reqn">\gamma=0</code> in the criteria above. We set <code class="reqn">\mu_g=\sqrt{n}\mu</code> to be the group lasso penalty parameter.
</p>
<p>For each pair of the penalty parameters <code class="reqn">(\mu,\gamma)</code> in the ridge group sparse criteria, one meta model, called RKHS meta model, is calculated. The RKHS meta model is an additive model with at most vMax groups. It satisfies the properties of the Hoeffding decomposition, and its terms estimate the terms in the Hoeffding decomposition of the function <code class="reqn">m</code>.
</p>
<p>These estimators are evaluated using a testing dataset. That is, the prediction error is calculated for each RKHS meta model and the one with the minimum prediction error is the &quot;best&quot; estimator for the true model <code class="reqn">m</code>. It provides a function that estimates the empirical sensitivity indices of the &quot;best&quot; RKHS meta model as an approximation of the true sensitivity indices.
</p>


<h3>Details</h3>

<p>Details.
</p>


<h3>Author(s)</h3>

<p>Halaleh Kamari.
</p>
<p>Maintainer: <a href="mailto:halaleh.kamari@univ-evry.fr">halaleh.kamari@univ-evry.fr</a>
</p>


<h3>References</h3>

<p>Kamari, H., Huet, S. and Taupin, M.-L. (2019) RKHSMetaMod : An R package to estimate the Hoeffding decomposition of an unknown function by solving RKHS Ridge Group Sparse optimization problem. &lt;arXiv:1905.13695&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+RKHSMetaMod">RKHSMetaMod</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- 3
n &lt;- 50
library(lhs)
X &lt;- maximinLHS(n, d)
c &lt;- c(0.2,0.6,0.8)
F &lt;- 1;for (a in 1:d) F &lt;- F*(abs(4*X[,a]-2)+c[a])/(1+c[a])
epsilon &lt;- rnorm(n,0,1);sigma &lt;- 0.2
Y &lt;- F + sigma*epsilon
Dmax &lt;- 3
kernel &lt;- "matern"
frc &lt;- c(10,100)
gamma &lt;- c(.5,.01,.001,0)
result &lt;- RKHSMetMod(Y,X,kernel,Dmax,gamma,frc,FALSE)  
</code></pre>

<hr>
<h2 id='calc_Kv'>
Function to calculate the Gram matrices and their eigenvalues and eigenvectors for a chosen reproducing kernel.
</h2><span id='topic+calc_Kv'></span>

<h3>Description</h3>

<p>Calculates the Gram matrices <code class="reqn">K_v</code> for <code class="reqn">v=1,\ldots,</code>vMax, and returns their associated eigenvalues and eigenvectors. The calculated Gram matrices may be not positive definite. The option &quot;correction&quot; of this function allows to replace the matrices <code class="reqn">K_v</code> that are not positive definite by their &quot;nearest positive definite&quot; matrices.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_Kv(X, kernel, Dmax, correction, verbose, tol)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_Kv_+3A_x">X</code></td>
<td>
<p>Matrix of observations with <code class="reqn">n</code> rows and <code class="reqn">d</code> columns.</p>
</td></tr>
<tr><td><code id="calc_Kv_+3A_kernel">kernel</code></td>
<td>
<p>Character, the type of the reproducing kernel: matern <code class="reqn">(</code>matern kernel<code class="reqn">)</code>, brownian <code class="reqn">(</code>brownian kernel<code class="reqn">)</code>, gaussian <code class="reqn">(</code>gaussian kernel<code class="reqn">)</code>, linear <code class="reqn">(</code>linear kernel<code class="reqn">)</code>, quad <code class="reqn">(</code>quadratic kernel<code class="reqn">)</code>.</p>
</td></tr>
<tr><td><code id="calc_Kv_+3A_dmax">Dmax</code></td>
<td>
<p>Integer, between <code class="reqn">1</code> and <code class="reqn">d</code>, indicates the order of interactions considered in the meta model: Dmax<code class="reqn">=1</code> is used to consider only the main effects, Dmax<code class="reqn">=2</code> to include the main effects and the interactions of order <code class="reqn">2,\ldots</code>.</p>
</td></tr>
<tr><td><code id="calc_Kv_+3A_correction">correction</code></td>
<td>
<p>Logical, if TRUE, the program makes the correction to the matrices <code class="reqn">K_v</code> that are not positive definite (see details). Set as TRUE by default.</p>
</td></tr>
<tr><td><code id="calc_Kv_+3A_verbose">verbose</code></td>
<td>
<p>Logical, if TRUE, the group <code class="reqn">v</code> for which the correction is done is printed. Set as TRUE by default.</p>
</td></tr>
<tr><td><code id="calc_Kv_+3A_tol">tol</code></td>
<td>
<p>Scalar, used if correction is TRUE. For each matrix <code class="reqn">K_v</code> if <code class="reqn">\lambda_{min} &lt; \lambda_{max}\times</code>tol, then the correction to <code class="reqn">K_v</code> is done (see details). Set as <code class="reqn">1e^{-8}</code> by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">\lambda_{v,i},i=1,...,n</code> be the eigenvalues associated with matrix <code class="reqn">K_v</code>. Set <code class="reqn">\lambda_{max}={max}_{i}\lambda_{v,i}</code> and <code class="reqn">\lambda_{min}={min}_{i}\lambda_{v,i}</code>. The eigenvalues of <code class="reqn">K_v</code> that is not positive definite are replaced by <code class="reqn">\lambda_{v,i}+</code>epsilon, with espilon<code class="reqn">=\lambda_{max}\times</code>tol. The value of tol depends on the type of the kernel and it is chosen small.
</p>


<h3>Value</h3>

<p>List of two components &quot;names.Grp&quot; and &quot;kv&quot;:
</p>
<table>
<tr><td><code>names.Grp</code></td>
<td>
<p>Vector of size vMax, indicates the name of groups included in the meta model.</p>
</td></tr>
<tr><td><code>kv</code></td>
<td>
<p>List of vMax components with the same names as the vector names.Grp. Each element of the list is a list of two components &quot;Evalues&quot; and &quot;Q&quot;:</p>
</td></tr>
<tr><td><code>Evalues</code></td>
<td>
<p>Vector of size <code class="reqn">n</code>, eigenvalues of each Gram matrix <code class="reqn">K_v</code>.</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>Matrix with <code class="reqn">n</code> rows and <code class="reqn">n</code> columns, eigenvectors of each Gram matrix <code class="reqn">K_v</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Note.
</p>


<h3>Author(s)</h3>

<p>Halaleh Kamari
</p>


<h3>References</h3>

<p>Kamari, H., Huet, S. and Taupin, M.-L. (2019) RKHSMetaMod : An R package to estimate the Hoeffding decomposition of an unknown function by solving RKHS Ridge Group Sparse optimization problem. &lt;arXiv:1905.13695&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+RKHSMetaMod">RKHSMetaMod</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- 3
n &lt;- 50
library(lhs)
X &lt;- maximinLHS(n, d)
c &lt;- c(0.2,0.6,0.8)
F &lt;- 1;for (a in 1:d) F &lt;- F*(abs(4*X[,a]-2)+c[a])/(1+c[a])
epsilon &lt;- rnorm(n,0,1);sigma &lt;- 0.2
Y &lt;- F + sigma*epsilon
Dmax &lt;- 3
kernel &lt;- "matern"
Kv &lt;- calc_Kv(X, kernel, Dmax)
names &lt;- Kv$names.Grp
Eigen.val1 &lt;- Kv$kv$v1.$Evalues
Eigen.vec1 &lt;- Kv$kv$v1.$Q
</code></pre>

<hr>
<h2 id='grplasso_q'>
Function to fit a solution with q active groups of an RKHS Group Lasso problem.
</h2><span id='topic+grplasso_q'></span>

<h3>Description</h3>

<p>Fits a solution of the group lasso problem based on RKHS, with <code class="reqn">q</code> active groups in the obtained solution for the Gaussian regression model. It determines <code class="reqn">\mu_{g}(q)</code>, for which the number of active groups in the solution of the RKHS group lasso problem is equal to <code class="reqn">q</code>, and returns the RKHS meta model associated with <code class="reqn">\mu_{g}(q)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grplasso_q(Y, Kv, q, rat, Num)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grplasso_q_+3A_y">Y</code></td>
<td>
<p>Vector of response observations of size <code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="grplasso_q_+3A_kv">Kv</code></td>
<td>
<p>List of eigenvalues and eigenvectors of positive definite Gram matrices <code class="reqn">K_v</code> and their associated group names. It should have the same format as the output of the function <code><a href="#topic+calc_Kv">calc_Kv</a></code> (see details).</p>
</td></tr>
<tr><td><code id="grplasso_q_+3A_q">q</code></td>
<td>
<p>Integer, the number of active groups in the obtained solution.</p>
</td></tr>
<tr><td><code id="grplasso_q_+3A_rat">rat</code></td>
<td>
<p>Positive scalar, used to restrict the minimum value of <code class="reqn">\mu_g</code>, to be evaluted in the RKHS Group Lasso algorithm, <code class="reqn">\mu_{min}=\mu_{max}/rat</code>. The value <code class="reqn">\mu_{max}</code> is calculated inside the program, see function <code><a href="#topic+mu_max">mu_max</a></code>.</p>
</td></tr>
<tr><td><code id="grplasso_q_+3A_num">Num</code></td>
<td>
<p>Integer, used to restrict the number of different values of the penalty parameter <code class="reqn">\mu_g</code> to be evaluated in the RKHS Group Lasso algorithm, until it achieves <code class="reqn">\mu_g(q)</code>: for Num <code class="reqn">= 1</code> the program is done for <code class="reqn">3</code> values of <code class="reqn">\mu_g</code>, <code class="reqn">\mu_{1}=(\mu_{min}+\mu_{max})/2</code>, <code class="reqn">\mu_{2}=(\mu_{min}+\mu_{1})/2</code> or <code class="reqn">\mu_{2}=(\mu_{1}+\mu_{max})/2</code> depending on the value of <code class="reqn">q</code> associated with <code class="reqn">\mu_{1}</code>, <code class="reqn">\mu_{3}=\mu_{min}</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Input Kv should contain the eigenvalues and eigenvectors of positive definite Gram matrices <code class="reqn">K_v</code>. It is necessary to set input &quot;correction&quot; in the function <code><a href="#topic+calc_Kv">calc_Kv</a></code> equal to &quot;TRUE&quot;.
</p>


<h3>Value</h3>

<p>List of <code class="reqn">4</code> components: &quot;mus&quot;, &quot;qs&quot;, &quot;mu&quot;, &quot;res&quot;:
</p>
<table>
<tr><td><code>mus</code></td>
<td>
<p>Vector, values of the evaluated penalty parameters <code class="reqn">\mu_g</code> in the RKHS group lasso algorithm until it achieves <code class="reqn">\mu_{g}(q)</code>.</p>
</td></tr>
<tr><td><code>qs</code></td>
<td>
<p>Vector, number of active groups associated with each value of <code class="reqn">\mu_g</code> in mus.</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>Scalar, value of <code class="reqn">\mu_{g}(q)</code>.</p>
</td></tr>
<tr><td><code>res</code></td>
<td>
<p>An RKHS Group Lasso object:</p>
</td></tr>
<tr><td><code>intercept</code></td>
<td>
<p>Scalar, estimated value of intercept.</p>
</td></tr>
<tr><td><code>teta</code></td>
<td>
<p>Matrix with vMax rows and <code class="reqn">n</code> columns. Each row of the matrix is the estimated vector <code class="reqn">\theta_{v}</code> for <code class="reqn">v=1,...,</code>vMax.</p>
</td></tr>
<tr><td><code>fit.v</code></td>
<td>
<p>Matrix with <code class="reqn">n</code> rows and vMax columns. Each row of the matrix is the estimated value of <code class="reqn">f_{v}=K_{v}\theta_{v}</code>.</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>Vector of size <code class="reqn">n</code>, indicates the estimator of <code class="reqn">m</code>.</p>
</td></tr>
<tr><td><code>Norm.H</code></td>
<td>
<p>Vector of size vMax, estimated values of the penalty norm.</p>
</td></tr>
<tr><td><code>supp</code></td>
<td>
<p>Vector of active groups.</p>
</td></tr>
<tr><td><code>Nsupp</code></td>
<td>
<p>Vector of the names of the active groups.</p>
</td></tr>
<tr><td><code>SCR</code></td>
<td>
<p>Scalar, equals to <code class="reqn">\Vert Y-f_{0}-\sum_{v}K_{v}\theta_{v}\Vert ^{2}</code>.</p>
</td></tr>
<tr><td><code>crit</code></td>
<td>
<p>Scalar, indicates the value of the penalized criteria.</p>
</td></tr>
<tr><td><code>MaxIter</code></td>
<td>
<p>Integer, number of iterations until convergence is reached.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>TRUE or FALSE. Indicates whether the algorithm has converged or not.</p>
</td></tr>
<tr><td><code>RelDiffCrit</code></td>
<td>
<p>Scalar, value of the first convergence criteria at the last iteration, <code class="reqn">\frac{crit_{lastIter}-crit_{lastIter-1}}{crit_{lastIter-1}}</code>.</p>
</td></tr>
<tr><td><code>RelDiffPar</code></td>
<td>
<p>Scalar, value of the second convergence criteria at the last iteration, <code class="reqn">\Vert\frac{\theta_{lastIter}-\theta_{lastIter-1}}{\theta_{lastIter-1}}\Vert ^{2}</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Note.
</p>


<h3>Author(s)</h3>

<p>Halaleh Kamari
</p>


<h3>References</h3>

<p>Kamari, H., Huet, S. and Taupin, M.-L. (2019) RKHSMetaMod : An R package to estimate the Hoeffding decomposition of an unknown function by solving RKHS Ridge Group Sparse optimization problem. &lt;arXiv:1905.13695&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_Kv">calc_Kv</a></code>, <code><a href="#topic+mu_max">mu_max</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- 3
n &lt;- 50
library(lhs)
X &lt;- maximinLHS(n, d)
c &lt;- c(0.2,0.6,0.8)
F &lt;- 1;for (a in 1:d) F &lt;- F*(abs(4*X[,a]-2)+c[a])/(1+c[a])
epsilon &lt;- rnorm(n,0,1);sigma &lt;- 0.2 
Y &lt;- F + sigma*epsilon
Dmax &lt;- 3
kernel &lt;- "matern"
Kv &lt;- calc_Kv(X, kernel, Dmax, TRUE, TRUE)
result &lt;- grplasso_q(Y,Kv,5,100 ,Num=10)
result$mu
result$res$Nsupp
</code></pre>

<hr>
<h2 id='mu_max'>
Function to find the maximal value of the penalty parameter in the RKHS Group Lasso problem.
</h2><span id='topic+mu_max'></span>

<h3>Description</h3>

<p>Calculates the value of the penalty parameter in the RKHS group lasso problem when the first penalized parameter group enters the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mu_max(Y, matZ)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mu_max_+3A_y">Y</code></td>
<td>
<p>Vector of response observations of size <code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="mu_max_+3A_matz">matZ</code></td>
<td>
<p>List of vMax components. Each component includes the eigenvalues and eigenvectors of the positive definite Gram matrices <code class="reqn">K_v, v=1,...,</code>vMax. It should have the same format as the output &quot;kv&quot; of the function <code><a href="#topic+calc_Kv">calc_Kv</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details.
</p>


<h3>Value</h3>

<p>An object of type numeric is returned.
</p>


<h3>Note</h3>

<p>Note.
</p>


<h3>Author(s)</h3>

<p>Halaleh Kamari
</p>


<h3>References</h3>

<p>Kamari, H., Huet, S. and Taupin, M.-L. (2019) RKHSMetaMod : An R package to estimate the Hoeffding decomposition of an unknown function by solving RKHS Ridge Group Sparse optimization problem. &lt;arXiv:1905.13695&gt;
</p>
<p>Meier, L. Van de Geer, S. and Buhlmann, P. (2008) The group LASSO for logistic regression. Journal of the Royal Statistical Society Series B. 70. 53-71. 10.1111/j.1467-9868.2007.00627.x. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_Kv">calc_Kv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- 3
n &lt;- 50
library(lhs)
X &lt;- maximinLHS(n, d)
c &lt;- c(0.2,0.6,0.8)
F &lt;- 1;for (a in 1:d) F &lt;- F*(abs(4*X[,a]-2)+c[a])/(1+c[a])
epsilon &lt;- rnorm(n,0,1);sigma &lt;- 0.2
Y &lt;- F + sigma*epsilon
Dmax &lt;- 3
kernel &lt;- "matern"
Kv &lt;- calc_Kv(X, kernel, Dmax, TRUE,TRUE)
matZ &lt;- Kv$kv
mumax &lt;- mu_max(Y, matZ)
mumax
</code></pre>

<hr>
<h2 id='pen_MetMod'>
Function to fit a solution of the RKHS Ridge Group Sparse problem.
</h2><span id='topic+pen_MetMod'></span>

<h3>Description</h3>

<p>Fits the solution of the RKHS ridge group sparse optimization problem for the Gaussian regression model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pen_MetMod(Y, Kv, gamma, mu, resg, gama_v, mu_v, maxIter, verbose, calcStwo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pen_MetMod_+3A_y">Y</code></td>
<td>
<p>Vector of response observations of size <code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="pen_MetMod_+3A_kv">Kv</code></td>
<td>
<p>List, includes the eigenvalues and eigenvectors of the positive definite Gram matrices <code class="reqn">K_v, v=1,...,</code>vMax and their associated group names. It should have the same format as the output of the function <code><a href="#topic+calc_Kv">calc_Kv</a></code> (see details).</p>
</td></tr>
<tr><td><code id="pen_MetMod_+3A_gamma">gamma</code></td>
<td>
<p>Vector of positive scalars. Values of the penalty parameter <code class="reqn">\gamma</code> in decreasing order.</p>
</td></tr>
<tr><td><code id="pen_MetMod_+3A_mu">mu</code></td>
<td>
<p>Vector of positive scalars. Values of the penalty parameter <code class="reqn">\mu</code> in decreasing order.</p>
</td></tr>
<tr><td><code id="pen_MetMod_+3A_resg">resg</code></td>
<td>
<p>List of initial parameters, includes the <code><a href="#topic+RKHSgrplasso">RKHSgrplasso</a></code> objects for each value of the penalty parameter <code class="reqn">\mu</code>.</p>
</td></tr>
<tr><td><code id="pen_MetMod_+3A_gama_v">gama_v</code></td>
<td>
<p>Scalar zero or vector of vMax positive scalars, considered as weights for the Ridge penalty. Set to zero, to consider no weights, i.e. all weights equal to <code class="reqn">1</code>.</p>
</td></tr>
<tr><td><code id="pen_MetMod_+3A_mu_v">mu_v</code></td>
<td>
<p>Scalar zero or a vector with vMax scalars, considered as weigths of Sparse Group penalty. Set to zero, to consider no weights, i.e. all weights equal to <code class="reqn">1</code>.</p>
</td></tr>
<tr><td><code id="pen_MetMod_+3A_maxiter">maxIter</code></td>
<td>
<p>Integer, shows the maximum number of loops through initial active groups at the first step and maximum number of loops through all groups at the second step. Set as <code class="reqn">1000</code> by default.</p>
</td></tr>
<tr><td><code id="pen_MetMod_+3A_verbose">verbose</code></td>
<td>
<p>Logical, if TRUE, for each pair of penalty parameters <code class="reqn">(\mu,\gamma)</code> it prints: the number of current iteration, active groups and convergence criterias. Set as FALSE by default.</p>
</td></tr>
<tr><td><code id="pen_MetMod_+3A_calcstwo">calcStwo</code></td>
<td>
<p>Logical, if TRUE, the program does a second step after convergence: the algorithm is done over all groups by taking the estimated parameters at the first step as initial values. Set as FALSE by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Input Kv should contain the eigenvalues and eigenvectors of positive definite Gram matrices <code class="reqn">K_v</code>. It is necessary to set input &quot;correction&quot; in the function <code><a href="#topic+calc_Kv">calc_Kv</a></code> equal to &quot;TRUE&quot;.
</p>


<h3>Value</h3>

<p>List of l components, with l equals to the number of pairs of the penalty parameters <code class="reqn">(\mu,\gamma)</code>. Each component of the list is a list of <code class="reqn">3</code> components &quot;mu&quot;, &quot;gamma&quot; and &quot;Meta-Model&quot;:
</p>
<table>
<tr><td><code>mu</code></td>
<td>
<p>Positive scalar, an element of the input vector mu associated with the estimated Meta-Model.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Positive scalar, an element of the input vector gamma associated with the estimated Meta-Model.</p>
</td></tr>
<tr><td><code>Meta-Model</code></td>
<td>
<p>Estimated meta model associated with penalty parameters mu and gamma. List of <code class="reqn">16</code> components:</p>
</td></tr>
<tr><td><code>intercept</code></td>
<td>
<p>Scalar, estimated value of intercept.</p>
</td></tr>
<tr><td><code>teta</code></td>
<td>
<p>Matrix with vMax rows and <code class="reqn">n</code> columns. Each row of the matrix is the estimated vector <code class="reqn">\theta_{v}</code> for <code class="reqn">v=1,...,</code>vMax.</p>
</td></tr>
<tr><td><code>fit.v</code></td>
<td>
<p>Matrix with <code class="reqn">n</code> rows and vMax columns. Each row of the matrix is the estimated value of <code class="reqn">f_{v}=K_{v}\theta_{v}</code>.</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>Vector of size <code class="reqn">n</code>, indicates the estimator of <code class="reqn">m</code>.</p>
</td></tr>
<tr><td><code>Norm.n</code></td>
<td>
<p>Vector of size vMax, estimated values for the Ridge penalty norm.</p>
</td></tr>
<tr><td><code>Norm.H</code></td>
<td>
<p>Vector of size vMax, estimated values for the Group Sparse penalty norm.</p>
</td></tr>
<tr><td><code>supp</code></td>
<td>
<p>Vector of active groups.</p>
</td></tr>
<tr><td><code>Nsupp</code></td>
<td>
<p>Vector of the names of the active groups.</p>
</td></tr>
<tr><td><code>SCR</code></td>
<td>
<p>Scalar equals to <code class="reqn">\Vert Y-f_{0}-\sum_{v}K_{v}\theta_{v}\Vert ^{2}</code>.</p>
</td></tr>
<tr><td><code>crit</code></td>
<td>
<p>Scalar indicates the value of the penalized criteria.</p>
</td></tr>
<tr><td><code>gamma.v</code></td>
<td>
<p>Vector of size vMax, coefficients of the Ridge penalty norm, <code class="reqn">\sqrt{n}\gamma\times</code>gama_v.</p>
</td></tr>
<tr><td><code>mu.v</code></td>
<td>
<p>Vector of size vMax, coefficients of the Group Sparse penalty norm, <code class="reqn">n\mu\times</code>mu_v.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>List of three components if calcStwo<code class="reqn">=</code>TRUE <code class="reqn">(</code>two components if calcStwo<code class="reqn">=</code>FALSE<code class="reqn">)</code>: maxIter, number of iterations until convergence is reached at first step and the number of iterations until convergence is reached at second step <code class="reqn">(</code>maxIter, and the number of iterations until convergence is reached at first step<code class="reqn">)</code>.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>TRUE or FALSE. Indicates whether the algorithm has converged or not.</p>
</td></tr>
<tr><td><code>RelDiffCrit</code></td>
<td>
<p>List of two components if calcStwo<code class="reqn">=</code>TRUE <code class="reqn">(</code>one component if calcStwo<code class="reqn">=</code>FALSE<code class="reqn">)</code>: value of convergence criteria at the last iteration of each step, <code class="reqn">\Vert\frac{\theta_{lastIter}-\theta_{lastIter-1}}{\theta_{lastIter-1}}\Vert ^{2}</code>.</p>
</td></tr>
<tr><td><code>RelDiffPar</code></td>
<td>
<p>List of two components if calcStwo<code class="reqn">=</code>TRUE (one component if calcStwo<code class="reqn">=</code>FALSE): value of convergence criteria at the last iteration, <code class="reqn">\frac{crit_{lastIter}-crit_{lastIter-1}}{crit_{lastIter-1}}</code> of each step.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Note.
</p>


<h3>Author(s)</h3>

<p>Halaleh Kamari
</p>


<h3>References</h3>

<p>Huet, S. and Taupin, M. L. (2017) Metamodel construction for sensitivity analysis. ESAIM:
Procs 60, 27-69.
</p>
<p>Kamari, H., Huet, S. and Taupin, M.-L. (2019) RKHSMetaMod : An R package to estimate the Hoeffding decomposition of an unknown function by solving RKHS Ridge Group Sparse optimization problem. &lt;arXiv:1905.13695&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_Kv">calc_Kv</a></code>, <code><a href="#topic+RKHSgrplasso">RKHSgrplasso</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- 3
n &lt;- 50
library(lhs)
X &lt;- maximinLHS(n, d)
c &lt;- c(0.2,0.6,0.8)
F &lt;- 1;for (a in 1:d) F &lt;- F*(abs(4*X[,a]-2)+c[a])/(1+c[a])
epsilon &lt;- rnorm(n,0,1);sigma &lt;- 0.2
Y &lt;- F + sigma*epsilon
Dmax &lt;- 3
kernel &lt;- "matern"
Kv &lt;- calc_Kv(X, kernel, Dmax, TRUE,TRUE, tol = 1e-08)
vMax &lt;- length(Kv$names.Grp)
matZ &lt;- Kv$kv
mumax &lt;- mu_max(Y, matZ)
mug1 &lt;- mumax/10
mug2 &lt;- mumax/100
gr1 &lt;- RKHSgrplasso(Y,Kv, mug1)
gr2 &lt;- RKHSgrplasso(Y,Kv, mug2)
gamma &lt;- c(.5,.01,.001)
#rescaling the penalty parameter
mu &lt;- c(mug1/sqrt(n),mug2/sqrt(n))
resg &lt;- list(gr1,gr2)
res &lt;- pen_MetMod(Y,Kv,gamma,mu,resg,0,0)
l &lt;- length(res)
for(i in 1:l){print(res[[i]]$mu)}
for(i in 1:l){print(res[[i]]$gamma)}
for(i in 1:l){print(res[[i]]$`Meta-Model`$Nsupp)}
gama_v &lt;- rep(1,vMax)
mu_v &lt;- rep(1,vMax)
res.w &lt;- pen_MetMod(Y,Kv,gamma,mu,resg,gama_v,mu_v)
for(i in 1:l){print(res.w[[i]]$`Meta-Model`$Nsupp)}
</code></pre>

<hr>
<h2 id='PredErr'>
Function to calculate the prediction error.
</h2><span id='topic+PredErr'></span>

<h3>Description</h3>

<p>Computes the prediction error by considering a testing dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PredErr(X, XT, YT, mu, gamma, res, kernel, Dmax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PredErr_+3A_x">X</code></td>
<td>
<p>Matrix of observations with <code class="reqn">n</code> rows and <code class="reqn">d</code> columns.</p>
</td></tr>
<tr><td><code id="PredErr_+3A_xt">XT</code></td>
<td>
<p>Matrix of observations of the testing dataset with <code class="reqn">n^{test}</code> rows and <code class="reqn">d</code> columns.</p>
</td></tr>
<tr><td><code id="PredErr_+3A_yt">YT</code></td>
<td>
<p>Vector of response observations of testing dataset of size <code class="reqn">n^{test}</code>.</p>
</td></tr>
<tr><td><code id="PredErr_+3A_mu">mu</code></td>
<td>
<p>Vector of positive scalars. Values of the Group Sparse penalty parameter in decreasing order. See function <code><a href="#topic+RKHSMetMod">RKHSMetMod</a></code>.</p>
</td></tr>
<tr><td><code id="PredErr_+3A_gamma">gamma</code></td>
<td>
<p>Vector of positive scalars. Values of the Ridge penalty parameter in decreasing order. See function <code><a href="#topic+RKHSMetMod">RKHSMetMod</a></code>.</p>
</td></tr>
<tr><td><code id="PredErr_+3A_res">res</code></td>
<td>
<p>List, includes a squence of estimated meta models for the learning dataset, using RKHS Ridge Group Sparse or RKHS Group Lasso algorithm, associated with the penalty parameters mu and gamma. It should have the same format as the output of one of the functions: <code><a href="#topic+pen_MetMod">pen_MetMod</a></code>, <code><a href="#topic+RKHSMetMod">RKHSMetMod</a></code> or <code><a href="#topic+RKHSMetMod_qmax">RKHSMetMod_qmax</a></code>.</p>
</td></tr>
<tr><td><code id="PredErr_+3A_kernel">kernel</code></td>
<td>
<p>Character, shows the type of the reproducing kernel: matern, brownian, gaussian, linear, quad. The same kernel should be chosen as the one used for the learning dataset. See function <code><a href="#topic+calc_Kv">calc_Kv</a></code>.</p>
</td></tr>
<tr><td><code id="PredErr_+3A_dmax">Dmax</code></td>
<td>
<p>Integer between <code class="reqn">1</code> and <code class="reqn">d</code>. The same Dmax should be chosen as the one used for learning dataset. See function <code><a href="#topic+calc_Kv">calc_Kv</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details.
</p>


<h3>Value</h3>

<p>Matrix of the prediction errors is returned. Each element of the matrix is the obtained prediction error associated with one RKHS meta model in &quot;res&quot;.
</p>


<h3>Note</h3>

<p>Note.
</p>


<h3>Author(s)</h3>

<p>Halaleh Kamari
</p>


<h3>References</h3>

<p>Kamari, H., Huet, S. and Taupin, M.-L. (2019) RKHSMetaMod : An R package to estimate the Hoeffding decomposition of an unknown function by solving RKHS Ridge Group Sparse optimization problem. &lt;arXiv:1905.13695&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_Kv">calc_Kv</a></code>, <code><a href="#topic+pen_MetMod">pen_MetMod</a></code>, <code><a href="#topic+RKHSMetMod">RKHSMetMod</a></code>, <code><a href="#topic+RKHSMetMod_qmax">RKHSMetMod_qmax</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- 3
n &lt;- 50
nT &lt;- 50
library(lhs)
X &lt;- maximinLHS(n, d)
XT &lt;- maximinLHS(nT, d)
c &lt;- c(0.2,0.6,0.8)
F &lt;- 1;for (a in 1:d) F &lt;- F*(abs(4*X[,a]-2)+c[a])/(1+c[a])
FT &lt;- 1;for (a in 1:d) FT &lt;- FT*(abs(4*XT[,a]-2)+c[a])/(1+c[a])
sigma &lt;- 0.2
epsilon &lt;- rnorm(n,0,1);Y &lt;- F + sigma*epsilon
epsilonT &lt;- rnorm(nT,0,1);YT &lt;- FT + sigma*epsilonT
Dmax &lt;- 3
kernel &lt;- "matern"
frc &lt;- c(10,100)
gamma &lt;- c(.5,.01,.001)
res &lt;- RKHSMetMod(Y,X,kernel,Dmax,gamma,frc,FALSE)
mu &lt;- vector()
l &lt;- length(gamma)
for(i in 1:length(frc)){mu[i]=res[[(i-1)*l+1]]$mu}
error &lt;- PredErr(X,XT, YT,mu,gamma, res, kernel,Dmax)
error
</code></pre>

<hr>
<h2 id='RKHSgrplasso'>
Function to fit a solution of an RKHS Group Lasso problem.
</h2><span id='topic+RKHSgrplasso'></span>

<h3>Description</h3>

<p>Fits the solution of an RKHS group lasso problem for the Gaussian regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RKHSgrplasso(Y, Kv, mu, maxIter, verbose)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RKHSgrplasso_+3A_y">Y</code></td>
<td>
<p>Vector of response observations of size <code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="RKHSgrplasso_+3A_kv">Kv</code></td>
<td>
<p>List, includes the eigenvalues and eigenvectors of the positive definite Gram matrices <code class="reqn">K_v, v=1,...,</code>vMax and their associated group names. It should have the same format as the output of the function <code><a href="#topic+calc_Kv">calc_Kv</a></code> (see details).</p>
</td></tr>
<tr><td><code id="RKHSgrplasso_+3A_mu">mu</code></td>
<td>
<p>Positive scalar, value of the penalty parameter <code class="reqn">\mu_g</code> in the RKHS Group Lasso problem.</p>
</td></tr>
<tr><td><code id="RKHSgrplasso_+3A_maxiter">maxIter</code></td>
<td>
<p>Integer, shows the maximum number of loops through all groups. Set as <code class="reqn">1000</code> by default.</p>
</td></tr>
<tr><td><code id="RKHSgrplasso_+3A_verbose">verbose</code></td>
<td>
<p>Logical, if TRUE, prints: the number of current iteration, active groups and convergence criterias. Set as FALSE by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Input Kv should contain the eigenvalues and eigenvectors of positive definite Gram matrices <code class="reqn">K_v</code>. It is necessary to set input correction in the function <code><a href="#topic+calc_Kv">calc_Kv</a></code> equal to &quot;TRUE&quot;.
</p>


<h3>Value</h3>

<p>Estimated RKHS meta model, list with <code class="reqn">13</code> components:
</p>
<table>
<tr><td><code>intercept</code></td>
<td>
<p>Scalar, estimated value of intercept.</p>
</td></tr>
<tr><td><code>teta</code></td>
<td>
<p>Matrix with vMax rows and <code class="reqn">n</code> columns. Each row of the matrix is the estimated vector <code class="reqn">\theta_{v}</code> for <code class="reqn">v=1,...,</code>vMax.</p>
</td></tr>
<tr><td><code>fit.v</code></td>
<td>
<p>Matrix with <code class="reqn">n</code> rows and vMax columns. Each row of the matrix is the estimated value of <code class="reqn">f_{v}=K_{v}\theta_{v}</code>.</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>Vector of size <code class="reqn">n</code>, indicates the estimator of <code class="reqn">m</code>.</p>
</td></tr>
<tr><td><code>Norm.H</code></td>
<td>
<p>Vector of size vMax, estimated values of the penalty norm.</p>
</td></tr>
<tr><td><code>supp</code></td>
<td>
<p>Vector of active groups.</p>
</td></tr>
<tr><td><code>Nsupp</code></td>
<td>
<p>Vector of the names of the active groups.</p>
</td></tr>
<tr><td><code>SCR</code></td>
<td>
<p>Scalar, equals to <code class="reqn">\Vert Y-f_{0}-\sum_{v}K_{v}\theta_{v}\Vert ^{2}</code>.</p>
</td></tr>
<tr><td><code>crit</code></td>
<td>
<p>Scalar, indicates the value of penalized criteria.</p>
</td></tr>
<tr><td><code>MaxIter</code></td>
<td>
<p>Integer, number of iterations until convergence is reached.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>TRUE or FALSE. Indicates whether the algorithm has converged or not.</p>
</td></tr>
<tr><td><code>RelDiffCrit</code></td>
<td>
<p>Scalar, value of the first convergence criteria at the last iteration, <code class="reqn">\frac{crit_{lastIter}-crit_{lastIter-1}}{crit_{lastIter-1}}</code>.</p>
</td></tr>
<tr><td><code>RelDiffPar</code></td>
<td>
<p>Scalar, value of the second convergence criteria at the last iteration, <code class="reqn">\Vert\frac{\theta_{lastIter}-\theta_{lastIter-1}}{\theta_{lastIter-1}}\Vert ^{2}</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Note.
</p>


<h3>Author(s)</h3>

<p>Halaleh Kamari
</p>


<h3>References</h3>

<p>Kamari, H., Huet, S. and Taupin, M.-L. (2019) RKHSMetaMod : An R package to estimate the Hoeffding decomposition of an unknown function by solving RKHS Ridge Group Sparse optimization problem. &lt;arXiv:1905.13695&gt;
</p>
<p>Meier, L. Van de Geer, S. and Buhlmann, P. (2008) The group LASSO for logistic regression. Journal of the Royal Statistical Society Series B. 70. 53-71. 10.1111/j.1467-9868.2007.00627.x.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_Kv">calc_Kv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- 3
n &lt;- 50
library(lhs)
X &lt;- maximinLHS(n, d)
c &lt;- c(0.2,0.6,0.8)
F &lt;- 1;for (a in 1:d) F &lt;- F*(abs(4*X[,a]-2)+c[a])/(1+c[a])
epsilon &lt;- rnorm(n,0,1);sigma &lt;- 0.2
Y &lt;- F + sigma*epsilon
Dmax &lt;- 3
kernel &lt;- "matern"
Kv &lt;- calc_Kv(X, kernel, Dmax, TRUE, TRUE)
matZ &lt;- Kv$kv
mumax &lt;- mu_max(Y, matZ)
mug &lt;- mumax/10
gr &lt;- RKHSgrplasso(Y,Kv, mug , 1000, FALSE)
gr$Nsupp
</code></pre>

<hr>
<h2 id='RKHSMetMod'>
Function to produce a sequence of meta models that are the solutions of the RKHS Ridge Group Sparse or RKHS Group Lasso optimization problems.
</h2><span id='topic+RKHSMetMod'></span>

<h3>Description</h3>

<p>Calculates the Gram matrices <code class="reqn">K_v</code> for a chosen reproducing kernel and fits the solution of an RKHS ridge group sparse or an RKHS group lasso problem for each pair of penalty parameters <code class="reqn">(\mu,\gamma)</code>, for the Gaussian regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RKHSMetMod(Y, X, kernel, Dmax, gamma, frc, verbose)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RKHSMetMod_+3A_y">Y</code></td>
<td>
<p>Vector of response observations of size <code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="RKHSMetMod_+3A_x">X</code></td>
<td>
<p>Matrix of observations with <code class="reqn">n</code> rows and <code class="reqn">d</code> columns.</p>
</td></tr>
<tr><td><code id="RKHSMetMod_+3A_kernel">kernel</code></td>
<td>
<p>Character, indicates the type of the reproducing kernel: matern <code class="reqn">(</code>matern kernel<code class="reqn">)</code>, brownian <code class="reqn">(</code>brownian kernel<code class="reqn">)</code>, gaussian <code class="reqn">(</code>gaussian kernel<code class="reqn">)</code>, linear <code class="reqn">(</code>linear kernel<code class="reqn">)</code>, quad <code class="reqn">(</code>quadratic kernel<code class="reqn">)</code>. See the function <code><a href="#topic+calc_Kv">calc_Kv</a></code></p>
</td></tr>
<tr><td><code id="RKHSMetMod_+3A_dmax">Dmax</code></td>
<td>
<p>Integer, between <code class="reqn">1</code> and <code class="reqn">d</code>, indicates the order of interactions considered in the meta model: Dmax<code class="reqn">=1</code> is used to consider only the main effects, Dmax<code class="reqn">=2</code> to include the main effects and the interactions of order <code class="reqn">2,\ldots</code>. See the function <code><a href="#topic+calc_Kv">calc_Kv</a></code></p>
</td></tr>
<tr><td><code id="RKHSMetMod_+3A_gamma">gamma</code></td>
<td>
<p>Vector of non negative scalars, values of the penalty parameter <code class="reqn">\gamma</code> in decreasing order. If <code class="reqn">\gamma=0</code> the function solves an RKHS Group Lasso problem and for <code class="reqn">\gamma&gt;0</code> it solves an RKHS Ridge Group Sparse problem.</p>
</td></tr>
<tr><td><code id="RKHSMetMod_+3A_frc">frc</code></td>
<td>
<p>Vector of positive scalars. Each element of the vector sets a value to the penalty parameter <code class="reqn">\mu</code>, <code class="reqn">\mu=\mu_{max}/(\sqrt{n}\times frc)</code>. The value <code class="reqn">\mu_{max}</code> is calculated by the program. See the function <code><a href="#topic+mu_max">mu_max</a></code>.</p>
</td></tr>
<tr><td><code id="RKHSMetMod_+3A_verbose">verbose</code></td>
<td>
<p>Logical, if TRUE, prints: the group <code class="reqn">v</code> for which the correction of Gram matrix <code class="reqn">K_v</code> is done, and for each pair of the penalty parameters <code class="reqn">(\mu,\gamma)</code>: the number of current iteration, active groups and convergence criterias. Set as FALSE by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details.
</p>


<h3>Value</h3>

<p>List of l components, with l equals to the number of pairs of the penalty parameters <code class="reqn">(\mu,\gamma)</code>. Each component of the list is a list of <code class="reqn">3</code> components &quot;mu&quot;, &quot;gamma&quot; and &quot;Meta-Model&quot;:
</p>
<table>
<tr><td><code>mu</code></td>
<td>
<p>Positive scalar, penalty parameter <code class="reqn">\mu</code> associated with the estimated Meta-Model.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Positive scalar, an element of the input vector gamma associated with the estimated Meta-Model.</p>
</td></tr>
<tr><td><code>Meta-Model</code></td>
<td>
<p>An RKHS Ridge Group Sparse or RKHS Group Lasso object associated with the penalty parameters mu and gamma:</p>
</td></tr>
<tr><td><code>intercept</code></td>
<td>
<p>Scalar, estimated value of intercept.</p>
</td></tr>
<tr><td><code>teta</code></td>
<td>
<p>Matrix with vMax rows and <code class="reqn">n</code> columns. Each row of the matrix is the estimated vector <code class="reqn">\theta_{v}</code> for <code class="reqn">v=1,...,</code>vMax.</p>
</td></tr>
<tr><td><code>fit.v</code></td>
<td>
<p>Matrix with <code class="reqn">n</code> rows and vMax columns. Each row of the matrix is the estimated value of <code class="reqn">f_{v}=K_{v}\theta_{v}</code>.</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>Vector of size <code class="reqn">n</code>, indicates the estimator of <code class="reqn">m</code>.</p>
</td></tr>
<tr><td><code>Norm.n</code></td>
<td>
<p>Vector of size vMax, estimated values for the Ridge penalty norm.</p>
</td></tr>
<tr><td><code>Norm.H</code></td>
<td>
<p>Vector of size vMax, estimated values of the Sparse Group penalty norm.</p>
</td></tr>
<tr><td><code>supp</code></td>
<td>
<p>Vector of active groups.</p>
</td></tr>
<tr><td><code>Nsupp</code></td>
<td>
<p>Vector of the names of the active groups.</p>
</td></tr>
<tr><td><code>SCR</code></td>
<td>
<p>Scalar, equals to <code class="reqn">\Vert Y-f_{0}-\sum_{v}K_{v}\theta_{v}\Vert ^{2}</code>.</p>
</td></tr>
<tr><td><code>crit</code></td>
<td>
<p>Scalar, indicates the value of the penalized criteria.</p>
</td></tr>
<tr><td><code>gamma.v</code></td>
<td>
<p>Vector of size vMax, coefficients of the Ridge penalty norm, <code class="reqn">\sqrt{n}\gamma\times</code>gama_v.</p>
</td></tr>
<tr><td><code>mu.v</code></td>
<td>
<p>Vector of size vMax, coefficients of the Group Sparse penalty norm, <code class="reqn">n\mu\times</code>mu_v.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>List of two components: maxIter, and the number of iterations until the convergence is achieved.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>TRUE or FALSE. Indicates whether the algorithm has converged or not.</p>
</td></tr>
<tr><td><code>RelDiffCrit</code></td>
<td>
<p>Scalar, value of the first convergence criteria at the last iteration, <code class="reqn">\Vert\frac{\theta_{lastIter}-\theta_{lastIter-1}}{\theta_{lastIter-1}}\Vert ^{2}</code>.</p>
</td></tr>
<tr><td><code>RelDiffPar</code></td>
<td>
<p>Scalar, value of the second convergence criteria at the last iteration, <code class="reqn">\frac{crit_{lastIter}-crit_{lastIter-1}}{crit_{lastIter-1}}</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>For the case <code class="reqn">\gamma=0</code> the outputs &quot;mu&quot;<code class="reqn">=\mu_g</code> and &quot;Meta-Model&quot; is the same as the one returned by the function <code><a href="#topic+RKHSgrplasso">RKHSgrplasso</a></code>.
</p>


<h3>Author(s)</h3>

<p>Halaleh Kamari
</p>


<h3>References</h3>

<p>Kamari, H., Huet, S. and Taupin, M.-L. (2019) RKHSMetaMod : An R package to estimate the Hoeffding decomposition of an unknown function by solving RKHS Ridge Group Sparse optimization problem. &lt;arXiv:1905.13695&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_Kv">calc_Kv</a></code>, <code><a href="#topic+mu_max">mu_max</a></code>, <code><a href="#topic+RKHSgrplasso">RKHSgrplasso</a></code>, <code><a href="#topic+pen_MetMod">pen_MetMod</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- 3
n &lt;- 50
library(lhs)
X &lt;- maximinLHS(n, d)
c &lt;- c(0.2,0.6,0.8)
F &lt;- 1;for (a in 1:d) F &lt;- F*(abs(4*X[,a]-2)+c[a])/(1+c[a])
epsilon &lt;- rnorm(n,0,1);sigma &lt;- 0.2
Y &lt;- F + sigma*epsilon
Dmax &lt;- 3
kernel &lt;- "matern"
frc &lt;- c(10,100)
gamma &lt;- c(.5,.01,.001,0)
result &lt;- RKHSMetMod(Y,X,kernel,Dmax,gamma,frc,FALSE)
l &lt;- length(result)
for(i in 1:l){print(result[[i]]$mu)}
for(i in 1:l){print(result[[i]]$gamma)}
for(i in 1:l){print(result[[i]]$`Meta-Model`$Nsupp)}
</code></pre>

<hr>
<h2 id='RKHSMetMod_qmax'>
Function to produce a sequence of meta models, with at most qmax active groups in each meta model. The meta models are the solutions of the RKHS Ridge Group Sparse or RKHS Group Lasso optimization problems.
</h2><span id='topic+RKHSMetMod_qmax'></span>

<h3>Description</h3>

<p>Calculates the Gram matrices <code class="reqn">K_v</code> for a chosen kernel, determines <code class="reqn">\mu</code>, note <code class="reqn">\mu (qmax)</code>, for which the number of active groups in the RKHS group lasso solution is equal to qmax, and fits a solution of an RKHS ridge group sparse or an RKHS group lasso problem for each pair of penalty parameters <code class="reqn">(\mu (qmax),\gamma)</code>, in the Gaussian regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RKHSMetMod_qmax(Y, X, kernel, Dmax, gamma, qmax, rat, Num, verbose)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RKHSMetMod_qmax_+3A_y">Y</code></td>
<td>
<p>Vector of response observations of size <code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="RKHSMetMod_qmax_+3A_x">X</code></td>
<td>
<p>Matrix of observations with <code class="reqn">n</code> rows and <code class="reqn">d</code> columns.</p>
</td></tr>
<tr><td><code id="RKHSMetMod_qmax_+3A_kernel">kernel</code></td>
<td>
<p>Character, indicates the type of the reproducing kernel: matern <code class="reqn">(</code>matern kernel<code class="reqn">)</code>, brownian <code class="reqn">(</code>brownian kernel<code class="reqn">)</code>, gaussian <code class="reqn">(</code>gaussian kernel<code class="reqn">)</code>, linear <code class="reqn">(</code>linear kernel<code class="reqn">)</code>, quad <code class="reqn">(</code>quadratic kernel<code class="reqn">)</code>. See the function <code><a href="#topic+calc_Kv">calc_Kv</a></code>.</p>
</td></tr>
<tr><td><code id="RKHSMetMod_qmax_+3A_dmax">Dmax</code></td>
<td>
<p>Integer, between <code class="reqn">1</code> and <code class="reqn">d</code>, indicates the order of interactions considered in the meta model: Dmax<code class="reqn">=1</code> is used to consider only the main effects, Dmax<code class="reqn">=2</code> to include the main effects and the interactions of order <code class="reqn">2,\ldots</code>. See the function <code><a href="#topic+calc_Kv">calc_Kv</a></code>.</p>
</td></tr>
<tr><td><code id="RKHSMetMod_qmax_+3A_gamma">gamma</code></td>
<td>
<p>Vector of non negative scalars, values of the penalty parameter <code class="reqn">\gamma</code> in decreasing order. If <code class="reqn">\gamma=0</code> the function solves an RKHS Group Lasso problem and for <code class="reqn">\gamma&gt;0</code> it solves an RKHS Ridge Group Sparse problem.</p>
</td></tr>
<tr><td><code id="RKHSMetMod_qmax_+3A_qmax">qmax</code></td>
<td>
<p>Integer, shows the maximum number of active groups in the obtained solution.</p>
</td></tr>
<tr><td><code id="RKHSMetMod_qmax_+3A_rat">rat</code></td>
<td>
<p>Positive scalar, to restrict the minimum value of <code class="reqn">\mu</code> considered in the algorithm, <code class="reqn">\mu_{min}=\mu_{max}/(\sqrt{n}\times rat)</code>. The value <code class="reqn">\mu_{max}</code> is calculated inside the program, see function <code><a href="#topic+mu_max">mu_max</a></code>.</p>
</td></tr>
<tr><td><code id="RKHSMetMod_qmax_+3A_num">Num</code></td>
<td>
<p>Integer, it is used to restrict the number of different values of the penalty parameter <code class="reqn">\mu</code> to be evaluated in the RKHS Group Lasso algorithm until it achieves <code class="reqn">\mu (qmax)</code>: for Num <code class="reqn">= 1</code> the program is done for <code class="reqn">3</code> different values of <code class="reqn">\mu</code>, <code class="reqn">\mu_{1}=(\mu_{min}+\mu_{max})/2</code>, <code class="reqn">\mu_{2}=(\mu_{min}+\mu_{1})/2</code> or <code class="reqn">\mu_{2}=(\mu_{1}+\mu_{max})/2</code> depending on the number of active groups in the meta model associated with <code class="reqn">\mu_{1}</code>, <code class="reqn">\mu_{3}=\mu_{min}</code>.</p>
</td></tr>
<tr><td><code id="RKHSMetMod_qmax_+3A_verbose">verbose</code></td>
<td>
<p>Logical, if TRUE, prints: the group <code class="reqn">v</code> for which the correction of Gram matrix <code class="reqn">K_v</code> is done, and for each pair of <code class="reqn">(\mu,\gamma)</code>: the number of current iteration, active groups and convergence criterias. Set as FALSE by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details.
</p>


<h3>Value</h3>

<p>List of three components &quot;mus&quot;, &quot;qs&quot;, and &quot;MetaModel&quot;:
</p>
<table>
<tr><td><code>mus</code></td>
<td>
<p>Vector, values of the evaluated penalty parameters <code class="reqn">\mu</code> in the RKHS Group Lasso algorithm until it achieves <code class="reqn">\mu (qmax)</code>.</p>
</td></tr>
<tr><td><code>qs</code></td>
<td>
<p>Vector, number of active groups associated with each element in mus.</p>
</td></tr>
<tr><td><code>MetaModel</code></td>
<td>
<p>List with the same length as the vector gamma. Each component of the list is a list of <code class="reqn">3</code> components &quot;mu&quot;, &quot;gamma&quot; and &quot;Meta-Model&quot;: </p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>Scalar, the value <code class="reqn">\mu (qmax)</code>.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Positive scalar, element of the input vector gamma associated with the estimated Meta-Model.</p>
</td></tr>
<tr><td><code>Meta-Model</code></td>
<td>
<p>An RKHS Ridge Group Sparse or RKHS Group Lasso object associated with the penalty parameters mu and gamma:</p>
</td></tr>
<tr><td><code>intercept</code></td>
<td>
<p>Scalar, estimated value of intercept.</p>
</td></tr>
<tr><td><code>teta</code></td>
<td>
<p>Matrix with vMax rows and <code class="reqn">n</code> columns. Each row of the matrix is the estimated vector <code class="reqn">\theta_{v}</code> for <code class="reqn">v=1,...,</code>vMax.</p>
</td></tr>
<tr><td><code>fit.v</code></td>
<td>
<p>Matrix with <code class="reqn">n</code> rows and vMax columns. Each row of the matrix is the estimated value of <code class="reqn">f_{v}=K_{v}\theta_{v}</code>.</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>Vector of size <code class="reqn">n</code>, indicates the estimator of <code class="reqn">m</code>.</p>
</td></tr>
<tr><td><code>Norm.n</code></td>
<td>
<p>Vector of size vMax, estimated values for the Ridge penalty norm.</p>
</td></tr>
<tr><td><code>Norm.H</code></td>
<td>
<p>Vector of size vMax, estimated values of the Sparse Group penalty norm.</p>
</td></tr>
<tr><td><code>supp</code></td>
<td>
<p>Vector of active groups.</p>
</td></tr>
<tr><td><code>Nsupp</code></td>
<td>
<p>Vector of the names of the active groups.</p>
</td></tr>
<tr><td><code>SCR</code></td>
<td>
<p>Scalar, equals to <code class="reqn">\Vert Y-f_{0}-\sum_{v}K_{v}\theta_{v}\Vert ^{2}</code>.</p>
</td></tr>
<tr><td><code>crit</code></td>
<td>
<p>Scalar, indicates the value of penalized criteria.</p>
</td></tr>
<tr><td><code>gamma.v</code></td>
<td>
<p>Vector, coefficients of the Ridge penalty norm, <code class="reqn">\sqrt{n}\gamma\times</code>gama_v.</p>
</td></tr>
<tr><td><code>mu.v</code></td>
<td>
<p>Vector, coefficients of the Group Sparse penalty norm, <code class="reqn">n\mu\times</code>mu_v.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>List of two components: maxIter, and the number of iterations until the convergence is achieved.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>TRUE or FALSE. Indicates whether the algorithm has converged or not.</p>
</td></tr>
<tr><td><code>RelDiffCrit</code></td>
<td>
<p>Scalar, value of the first convergence criteria at the last iteration, <code class="reqn">\Vert\frac{\theta_{lastIter}-\theta_{lastIter-1}}{\theta_{lastIter-1}}\Vert ^{2}</code>.</p>
</td></tr>
<tr><td><code>RelDiffPar</code></td>
<td>
<p>Scalar, value of the second convergence criteria at the last iteration, <code class="reqn">\frac{crit_{lastIter}-crit_{lastIter-1}}{crit_{lastIter-1}}</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>For the case <code class="reqn">\gamma=0</code> the outputs &quot;mu&quot;<code class="reqn">=\mu_{g}</code> and &quot;Meta-Model&quot; is the same as the one returned by the function <code><a href="#topic+RKHSgrplasso">RKHSgrplasso</a></code>.
</p>


<h3>Author(s)</h3>

<p>Halaleh Kamari
</p>


<h3>References</h3>

<p>Kamari, H., Huet, S. and Taupin, M.-L. (2019) RKHSMetaMod : An R package to estimate the Hoeffding decomposition of an unknown function by solving RKHS Ridge Group Sparse optimization problem. &lt;arXiv:1905.13695&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_Kv">calc_Kv</a></code>, <code><a href="#topic+mu_max">mu_max</a></code>, <code><a href="#topic+RKHSgrplasso">RKHSgrplasso</a></code>, <code><a href="#topic+pen_MetMod">pen_MetMod</a></code>, <code><a href="#topic+grplasso_q">grplasso_q</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- 3
n &lt;- 50
library(lhs)
X &lt;- maximinLHS(n, d)
c &lt;- c(0.2,0.6,0.8)
F &lt;- 1;for (a in 1:d) F &lt;- F*(abs(4*X[,a]-2)+c[a])/(1+c[a])
epsilon &lt;- rnorm(n,0,1);sigma &lt;- 0.2
Y &lt;- F + sigma*epsilon
Dmax &lt;- 3
kernel &lt;- "matern"
gamma &lt;- c(.5,.01,.001,0)
Num &lt;- 10
rat &lt;- 100
qmax &lt;- 4
result &lt;- RKHSMetMod_qmax(Y, X, kernel, Dmax, gamma, qmax, rat, Num,FALSE)
names(result)
result$mus
result$qs
l &lt;- length(gamma)
for(i in 1:l){print(result$MetaModel[[i]]$mu)}
for(i in 1:l){print(result$MetaModel[[i]]$gamma)}
for(i in 1:l){print(result$MetaModel[[i]]$`Meta-Model`$Nsupp)}
</code></pre>

<hr>
<h2 id='SI_emp'>
Function to calculate the empirical sensitivity indices for an input or a group of inputs.
</h2><span id='topic+SI_emp'></span>

<h3>Description</h3>

<p>Calculates the empirical sensitivity indices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SI_emp(res,ErrPred)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SI_emp_+3A_res">res</code></td>
<td>
<p>List, includes a sequence of estimated meta models, the solutions of the RKHS Ridge Group Sparse or RKHS Group Lasso problems. It should has the same format as the output of one of the functions: <code><a href="#topic+pen_MetMod">pen_MetMod</a></code>, <code><a href="#topic+RKHSMetMod">RKHSMetMod</a></code> or <code><a href="#topic+RKHSMetMod_qmax">RKHSMetMod_qmax</a></code>.</p>
</td></tr>
<tr><td><code id="SI_emp_+3A_errpred">ErrPred</code></td>
<td>
<p>Matrix or NULL. If matrix, each element of the matrix is the obtained prediction error associated with one RKHS meta model in &quot;res&quot;. It should have the same format as the output of the function <code><a href="#topic+PredErr">PredErr</a></code>. Set as &quot;NULL&quot; by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details.
</p>


<h3>Value</h3>

<p>If input ErrPred<code class="reqn">\neq</code>&quot;NULL&quot;, Vector of the empirical sensitivity incdices for the meta model with the minimum Prediction error is returned. If ErrPred<code class="reqn">=</code>&quot;NULL&quot;, a list of the vectors is returned. Each vector is the obtained sensitivity indices associated with one meta model in &quot;res&quot;.
</p>


<h3>Note</h3>

<p>Note.
</p>


<h3>Author(s)</h3>

<p>Halaleh Kamari
</p>


<h3>References</h3>

<p>Kamari, H., Huet, S. and Taupin, M.-L. (2019) RKHSMetaMod : An R package to estimate the Hoeffding decomposition of an unknown function by solving RKHS Ridge Group Sparse optimization problem. &lt;arXiv:1905.13695&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PredErr">PredErr</a></code>, <code><a href="#topic+pen_MetMod">pen_MetMod</a></code>, <code><a href="#topic+RKHSMetMod">RKHSMetMod</a></code>, <code><a href="#topic+RKHSMetMod_qmax">RKHSMetMod_qmax</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- 3
n &lt;- 50;nT &lt;- 50
library(lhs)
X &lt;- maximinLHS(n, d);XT &lt;- maximinLHS(nT, d)
c &lt;- c(0.2,0.6,0.8)
F &lt;- 1;for (a in 1:d) F &lt;- F*(abs(4*X[,a]-2)+c[a])/(1+c[a])
FT &lt;- 1;for (a in 1:d) FT &lt;- FT*(abs(4*XT[,a]-2)+c[a])/(1+c[a])
sigma &lt;- 0.2
epsilon &lt;- rnorm(n,0,1);Y &lt;- F + sigma*epsilon
epsilonT &lt;- rnorm(nT,0,1);YT &lt;- FT + sigma*epsilonT
Dmax &lt;- 3
kernel &lt;- "matern"
frc &lt;- c(10)
gamma=c(.5,.01,.001)
res &lt;- RKHSMetMod(Y,X,kernel,Dmax,gamma,frc,FALSE)
mu &lt;- vector()
l &lt;- length(gamma)
for(i in 1:length(frc)){mu[i]=res[[(i-1)*l+1]]$mu}
error &lt;- PredErr(X,XT, YT,mu,gamma, res, kernel,Dmax)
SI.minErr  &lt;- SI_emp(res, error)
SI.minErr
SI &lt;- SI_emp(res, NULL)
SI
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
