<!DOCTYPE html><html><head><title>Help for package biogas</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {biogas}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calcBgGD'>
<p>Calculate Biogas Production from Gas Density Data (GD-BMP)</p></a></li>
<li><a href='#calcBgMan'>
<p>Calculate Cumulative Biogas Production from Pressure Data</p></a></li>
<li><a href='#calcBgVol'>
<p>Calculate Cumulative Biogas Production from Volumetric Data</p></a></li>
<li><a href='#calcCOD'>
<p>Calculate Oxygen Demand</p></a></li>
<li><a href='#comp'>
<p>Methane Content of Biogas</p></a></li>
<li><a href='#comp2'>
<p>Methane Content of Biogas</p></a></li>
<li><a href='#cumBg'>
<p>Calculate Cumulative Biogas Production</p></a></li>
<li><a href='#feedSetup'>
<p>Setup Details for Batch Reactors</p></a></li>
<li><a href='#feedVol'>
<p>Biogas Volume from Batch Reactors</p></a></li>
<li><a href='#interp'>
<p>Interpolate Biogas Composition or Cumulative Production</p></a></li>
<li><a href='#mass'>
<p>Mass Change of Batch Reactors</p></a></li>
<li><a href='#mass2vol'>
<p>Calculate Biogas Production Gravimetrically</p></a></li>
<li><a href='#massw'>
<p>Mass Change of Batch Reactors</p></a></li>
<li><a href='#molMass'>
<p>Calculate Molar Mass of Compound</p></a></li>
<li><a href='#planBMP'>
<p>Claculate Inoculum and Substrate Mass for BMP Experiments</p></a></li>
<li><a href='#predBg'>
<p>Predict Biogas Production</p></a></li>
<li><a href='#s3compl'>
<p>Methane Content of Biogas from Batch Reactors</p></a></li>
<li><a href='#s3compw'>
<p>Methane Content of Biogas from Batch Reactors</p></a></li>
<li><a href='#s3lcombo'>
<p>Biogas Volume and Methane Content from Batch Bottles</p></a></li>
<li><a href='#s3voll'>
<p>Biogas Volume from Batch Bottles</p></a></li>
<li><a href='#s3volw'>
<p>Biogas Volume from Batch Reactors</p></a></li>
<li><a href='#setup'>
<p>Setup Details for Batch Reactors</p></a></li>
<li><a href='#setup2'>
<p>Setup Details for Some Batch Reactors</p></a></li>
<li><a href='#sludgeTwoBiogas'>
<p>Headspace Pressure, Mass measurements, and Methane and Carbondioxid Content from Batch Bottles</p></a></li>
<li><a href='#sludgeTwoSetup'>
<p>Setup Details for Batch Reactors</p></a></li>
<li><a href='#stdVol'>
<p>Correct Gas Volume to 'Standard' Conditions</p></a></li>
<li><a href='#strawComp'>
<p>Methane Content of Biogas</p></a></li>
<li><a href='#strawMass'>
<p>Mass Change of Batch Reactors</p></a></li>
<li><a href='#strawPressure'>
<p>Headspace Pressure in Batch Reactors</p></a></li>
<li><a href='#strawSetup'>
<p>Setup Details for Batch Reactors</p></a></li>
<li><a href='#summBg'>
<p>Summarise and Normalise Cumulative Methane Production</p></a></li>
<li><a href='#UQGDBiogas'>
<p>Biogas Volume and Mass Loss from BMP bottles</p></a></li>
<li><a href='#UQGDSetup'>
<p>BMP Bottle Setup Information</p></a></li>
<li><a href='#vol'>
<p>Biogas Volume from Batch Reactors</p></a></li>
<li><a href='#vol2'>
<p>Biogas Volume from Batch Reactors</p></a></li>
<li><a href='#vol2mass'>
<p>Calculate Mass of Biogas</p></a></li>
<li><a href='#vol2mol'>
<p>Calculate Moles of a Gas</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Process Biogas Data and Predict Biogas Production</td>
</tr>
<tr>
<td>Version:</td>
<td>1.23.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-12-25</td>
</tr>
<tr>
<td>Author:</td>
<td>Sasha D. Hafner [aut, cre],
  Charlotte Rennuit [aut],
  Camilla Justesen [aut],
  Nanna Lojborg [aut],
  Jacob Mortensen [aut],
  Sergi Astals [ctb],
  Konrad Koch [ctb],
  Soeren Weinrich [ctb],
  Jin Mi Triolo [ctb],
  Ali Heidarzadeh Vazifehkhoran [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sasha D. Hafner &lt;sasha.hafner@eng.au.dk&gt;</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, ggplot2, testthat</td>
</tr>
<tr>
<td>Description:</td>
<td>High- and low-level functions for processing biogas data and predicting biogas production. Molar mass and calculated oxygen demand (COD') can be determined from a chemical formula. Measured gas volume can be corrected for water vapor and to (possibly user-defined) standard temperature and pressure. Gas quantity can be converted between volume, mass, and moles. Gas composition, cumulative production, or other variables can be interpolated to a specified time. Cumulative biogas and methane production (and rates) can be calculated using volumetric, manometric, gravimetric, or gas density methods for any number of bottles. With cumulative methane production data and data on bottle contents, biochemical methane potential (BMP) can be calculated and summarized, including subtraction of the inoculum contribution and normalization by substrate mass. Cumulative production and production rates can be summarized in several different ways (e.g., omitting normalization) using the same function. Biogas quantity and composition can be predicted from substrate composition and additional, optional data. Lastly, inoculum and substrate mass can be determined for planning BMP experiments.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-12-26 11:14:28 UTC; sasha</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-01-08 12:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='calcBgGD'>
Calculate Biogas Production from Gas Density Data (GD-BMP)
</h2><span id='topic+calcBgGD'></span>

<h3>Description</h3>

<p><code>calcBgGD</code> (for <em>calc</em>ulate <em>b</em>io<em>g</em>as from <em>GD</em> (gas density) measurements) calculates cumulative biogas, methane production and production rates from mass loss and volume measurements for any number of bottles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcBgGD(
  # Main arguments
  dat, 
  temp.vol,
  temp.grav,
  pres.vol,
  pres.grav,
  # Column names
  id.name, 
  time.name, 
  vol.name,
  m.pre.name = NULL,
  m.post.name,
  comp.name = 'xCH4',       
  # Settings
  vented.mass = FALSE,
  averaging = 'final',  
  temp.init = NULL,       
  pres.init = NULL,      
  headspace = NULL,     
  vol.hs.name = NULL,  
  headcomp = 'N2',    
  # Calculation method and other settings
  vmethod = 'vol',   
  comp.lim = c(0, 1), 
  comp.sub = NA,     
  imethod = 'linear',
  extrap = FALSE,
  addt0 = TRUE,
  showt0 = TRUE,
  dry = FALSE,
  # Warnings and messages
  std.message = TRUE,
  check = TRUE,
  # Units and standard conditions
  temp.std = getOption('temp.std', as.numeric(NA)),
  pres.std = getOption('pres.std', as.numeric(NA)),
  unit.temp = getOption('unit.temp', 'C'),
  unit.pres = getOption('unit.pres', 'atm')
  ) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calcBgGD_+3A_dat">dat</code></td>
<td>

<p>a data frame with bottle identification code, time of measurement (as <code>numeric</code>, or <code>POSIX</code>), bottle mass, and measured biogas volume.
See Details section for details on units.
Additional columns can be present&ndash;these will be returned in the output data frame.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_temp.vol">temp.vol</code></td>
<td>

<p>temperature at which biogas volume was measured.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_temp.grav">temp.grav</code></td>
<td>

<p>temperature of bottle headspace at time of biogas venting, prior to gravimetric measurement.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_pres.vol">pres.vol</code></td>
<td>

<p>pressure at which biogas volume was measured.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_pres.grav">pres.grav</code></td>
<td>

<p>pressure of bottle headspace at time of biogas venting, prior to gravimetric measurement.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_id.name">id.name</code></td>
<td>

<p>name of the bottle identification code column in <code>dat</code>. Must be the same in all data frames used in the function. 
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_time.name">time.name</code></td>
<td>

<p>name of column containing time data (cumulative time) in <code>dat</code>. 
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_vol.name">vol.name</code></td>
<td>

<p>name of the measured biogas volume column in <code>dat</code>. 
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_m.pre.name">m.pre.name</code></td>
<td>

<p>name of column containing pre-venting bottle mass in <code>dat</code> data frame. 
Optional, required for <code>vented.mass = TRUE</code> and to calculate leakage.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_m.post.name">m.post.name</code></td>
<td>

<p>name of column containing post-venting bottle mass in <code>dat</code> data frame. 
See details.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_comp.name">comp.name</code></td>
<td>

<p>name of column with biogas composition to be added to output data frame. 
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_vented.mass">vented.mass</code></td>
<td>

<p>Set to <code>TRUE</code> to use vented mass loss (GD_v method) instead of total mass loss (GD_t method) in calculations.
See details.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_averaging">averaging</code></td>
<td>

<p>type of averaging used for calculating biogas composition.
Default is <code>final</code>.
See details.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_temp.init">temp.init</code></td>
<td>

<p>optional initial headspace temperature.
Used to correct results for initial headspace.
See details.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_pres.init">pres.init</code></td>
<td>

<p>optional initial headspace pressure.
Used to correct results for initial headspace.
See details.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_headspace">headspace</code></td>
<td>

<p>optional data frame or length-one numeric vector with reactor headspace volume(s).
If a data frame is used, it should at least contain a <code>"id"</code> (reactor identification code) column (see <code>"id.name"</code>) and headspace volume column (see <code>vol.hs.name</code> argument).
Required if <code>cmethod = "total"</code>.
Default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_vol.hs.name">vol.hs.name</code></td>
<td>

<p>optional name of column containing headspace volume data in optional <code>headspace</code> data frame. 
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_headcomp">headcomp</code></td>
<td>

<p>optional initial headspace composition used to correct results for initial headspace.
Default of <code>"N2"</code> is only logical value.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_vmethod">vmethod</code></td>
<td>

<p>method used for calculating biogas volume.
Default of <code>'vol'</code> is based on measured biogas volume in <code>vol.name</code> column.
Alternative is <code>'grav'</code> for gravimetric method, which should be used with <code>vented.mass = TRUE</code>.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_comp.lim">comp.lim</code></td>
<td>

<p>acceptable limits on calculated methane mole fraction.
Any values outside of this range are set to <code>comp.sub</code>.
Default of <code>c(0, 1)</code>.
Length two vector.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_comp.sub">comp.sub</code></td>
<td>

<p>Value substituted in for calculated methane mole fraction when calculated value is outside of <code>comp.lim</code> range.
Length one vector.
Default value of <code>NA</code> should generally never be changed.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_imethod">imethod</code></td>
<td>

<p>method used for interpolation of <code>xCH4</code>.
This is passed as the <code>method</code> argument to <code><a href="#topic+interp">interp</a></code>.
Length one character vector. 
Default is <code>"linear"</code> for linear interpolation.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_extrap">extrap</code></td>
<td>

<p>should <code>comp.name</code> be extrapolated? 
Length one logical vector.
This is passed as the <code>extrap</code> argument to <code><a href="#topic+interp">interp</a></code>. 
Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_addt0">addt0</code></td>
<td>

<p>is the earliest time in <code>dat</code> data frame &ldquo;time zero&rdquo; (start time)? 
If not, this argument adds a row with <code>time.name = 0</code> for each reactor in order to calculate production rates for the first observation.
This addition is only made when <code>time.name</code> is <code>numeric</code> (or <code>integer</code>).
Length-one logical vector.
Default is <code>TRUE</code>.
To return these additional rows in the output, see <code>showt0</code>.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_showt0">showt0</code></td>
<td>

<p>should &ldquo;time zero&rdquo; rows be returned in the output?
Can be convenient for plotting cumulative volumes.
Only applies if <code>time.name</code> is <code>numeric</code> (or <code>integer</code>).
These rows may have been present in the original data (<code>dat</code>) or added by the function (see <code>addt0</code>).
Default value depends on <code>dat</code> <code>time.name</code> column content. 
If <code>time.name</code> column is numeric and contains 0 then the default value is <code>TRUE</code> and otherwise <code>FALSE</code>. 
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_dry">dry</code></td>
<td>

<p>set to <code>TRUE</code> if volume data are standardized to dry conditions.
The default (<code>FALSE</code>) means biogas is assumed to be saturated with water vapor.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_std.message">std.message</code></td>
<td>

<p>should a message with the standard conditions be displayed? 
Default is <code>TRUE</code>. 
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_check">check</code></td>
<td>

<p>should input data be checked for unreasonable values (with warnings)? 
Currently only composition values are checked.
Default is <code>TRUE</code>.
Values are changed if outside 0, 1 (divided by 100).
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_temp.std">temp.std</code></td>
<td>

<p>standard temperature for presentation of biogas and methane results.
Length one numeric vector.
Default value is 0 degrees C (set in <code><a href="#topic+stdVol">stdVol</a></code>).
Argument is passed to <code><a href="#topic+stdVol">stdVol</a></code>.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_pres.std">pres.std</code></td>
<td>

<p>standard pressure for presentation of biogas and methane results.
Length one numeric vector.
Default value is 1.0 atm (101325 Pa) (set in <code><a href="#topic+stdVol">stdVol</a></code>).
Argument is passed to <code><a href="#topic+stdVol">stdVol</a></code>.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_unit.temp">unit.temp</code></td>
<td>

<p>temperature units for <code>temp</code> and <code>temp.std</code> arguments.
Default is <code>"C"</code> for degrees Celcius. 
Argument is passed to <code><a href="#topic+stdVol">stdVol</a></code>.
</p>
</td></tr>
<tr><td><code id="calcBgGD_+3A_unit.pres">unit.pres</code></td>
<td>

<p>pressure units for <code>pres</code> and <code>pres.std</code> arguments.
Default is <code>"atm"</code>.
Argument is passed to <code><a href="#topic+stdVol">stdVol</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using volume and mass loss data from <code>dat</code>, this function will calculate standardized biogas and methane production for each observation using the gas density (GD) method.
See reference below for details on the method.
</p>
<p>Standard values and units for temperature and pressure can be globally set using the function <code><a href="base.html#topic+options">options</a></code>.
See <code><a href="#topic+stdVol">stdVol</a></code>.
</p>


<h3>Value</h3>

<p>a data frame with all the columns originally present in <code>dat</code>, plus others including these:
</p>
<table>
<tr><td><code>vBg</code></td>
<td>
<p>Standardized volume of biogas production for individual event.</p>
</td></tr>
<tr><td><code>xCH4</code></td>
<td>
<p>Calculated mole fraction of methane in biogas.</p>
</td></tr>
<tr><td><code>vCH4</code></td>
<td>
<p>Standardized volume of methane production for individual event.</p>
</td></tr>
<tr><td><code>cvBg</code></td>
<td>
<p>Standardized cumulative volume of biogas production.</p>
</td></tr>
<tr><td><code>cvCH4</code></td>
<td>
<p>Standardized cumulative volume of methane production.</p>
</td></tr>
<tr><td><code>rvBg</code></td>
<td>
<p>Production rate of biogas.</p>
</td></tr>
<tr><td><code>rvCH4</code></td>
<td>
<p>Production rate of methane.</p>
</td></tr>
</table>
<p>Units are based on units in input data.
</p>


<h3>Author(s)</h3>

<p>Sasha D. Hafner, Camilla Justesen, Jacob Mortensen
</p>


<h3>References</h3>

<p>Justesen, C.G., Astals, S., Mortensen, J.R., Thorsen, R., Koch, K., Weinrich, S., Triolo, J.M., Hafner, S.D. 2019. Development and validation of a low-cost gas density method for measuring biochemical potential (BMP) <em>Water (MDPI)</em> <b>11(12)</b>: 2431.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calcBgMan">calcBgMan</a></code>,
<code><a href="#topic+calcBgVol">calcBgVol</a></code>,
<code><a href="#topic+summBg">summBg</a></code>,
<code><a href="#topic+interp">interp</a></code>,
<code><a href="#topic+stdVol">stdVol</a></code>,
<code><a href="base.html#topic+options">options</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 

data("UQGDBiogas")
data("UQGDSetup")

head(UQGDBiogas)
head(UQGDSetup)

cbg &lt;- calcBgGD(UQGDBiogas,
                temp.vol = 20, pres.vol = 1013.25,
                temp.grav = 30, pres.grav = 1500,
                id.name = 'id', vol.name = 'vol',
                m.pre.name = 'mass.init', m.post.name = 'mass.final',
                time.name = 'time.d', unit.pres = 'mbar')


BMP &lt;- summBg(cbg, UQGDSetup, id.name = "id",
              time.name = 'time.d', descrip.name = 'descrip',
              inoc.name = "Inoculum", inoc.m.name = "m.inoc", norm.name = "m.sub.vs",
              when = 'end')

BMP

</code></pre>

<hr>
<h2 id='calcBgMan'>
Calculate Cumulative Biogas Production from Pressure Data
</h2><span id='topic+calcBgMan'></span>

<h3>Description</h3>

<p><code>calcBgMan</code> (for <em>cum</em>ulative <em>b</em>io<em>g</em>as <em>man</em>ometric) calculates cumulative biogas, methane production and production rates from individual pressure and composition measurements for any number of reactors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcBgMan(
  # Main arguments
  dat, comp = NULL, temp, interval = TRUE,
  data.struct = 'longcombo',
  # Column names 
  id.name = 'id', time.name = 'time',
  pres.name = 'pres', comp.name = NULL,
  # Additional arguments
  pres.resid = NULL, temp.init = NULL, pres.init = NULL,
  rh.resid = NULL,
  rh.resid.init = 1, headspace = NULL, 
  vol.hs.name = 'vol.hs',
  absolute = TRUE, pres.amb = NULL,
  # Calculation method and other settings
  cmethod = 'removed', imethod = 'linear', extrap = FALSE,
  addt0 = TRUE, showt0 = TRUE, 
  # Warnings and messages
  std.message = !quiet, 
  check = TRUE,
  # Units and standard conditions
  temp.std = getOption('temp.std', as.numeric(NA)), 
  pres.std = getOption('pres.std', as.numeric(NA)),
  unit.temp = getOption('unit.temp', 'C'),
  unit.pres = getOption('unit.pres', 'atm'),
  quiet = FALSE
  ) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calcBgMan_+3A_dat">dat</code></td>
<td>

<p>a data frame with reactor identification code; time of measurement (as <code>numeric</code>, or <code>POSIX</code>); and measured pressure in <code>pres.unit</code>.
See Details section for details on units.
Additional columns can be present&ndash;these will be returned in the output data frame.
See <code>data.struct</code> argument for details on how data frames are structured.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_comp">comp</code></td>
<td>

<p>(optional) a data frame with the columns reactor identification code; time of measurement, (as <code>numeric</code>, or <code>POSIX</code>); and methane concentration within dry biogas as a mole fraction, considering only methane and carbon dioxide (unless <code>cmethod = "total"</code>) or a single numeric value.
If omitted, cumulative biogas volume will still be calculated and returned (but no methane data will be returned).
The names of these columns are specified with <code>id.name</code>, <code>time.name</code>, and <code>comp.name</code>.
Default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_temp">temp</code></td>
<td>

<p>the temperature at which headspace pressure was measured.
A length-one numeric vector or length-one character vector referring to a column in <code>dat</code>.
Degrees Celcius by default (see <code>unit.temp</code> argument). 
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_interval">interval</code></td>
<td>

<p>do biogas pressure measurements represent production only from the time interval between observations (default)?
<code>interval = FALSE</code> means measured pressure is cumulative.
For mixed manometric measurements (some observations vented, some not), use <code>interval = TRUE</code>, include a column for <code>pres.resid</code>, and, if composition was only measured for vented observations, use <code>imethod = "f1"</code>.
Default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_data.struct">data.struct</code></td>
<td>

<p>the structure of input data. The default of 'longcombo' means headspace pressure and composition in a single column.
The <code>dat</code> data frame must have reactor identification code and time columns with names specified with <code>id.name</code> and <code>time.name</code>, volume data in a single column with the name specified by <code>pres.name</code>, and biogas composition in a single column with the name specified by <code>comp.name</code>
For the <code>data.struct = 'long'</code> option, two separate data frames are needed, one with volume and one with composition.
Each data frame must have reactor identification code and time columns with names specified with <code>id.name</code> and <code>time.name</code>.
The <code>dat</code> data frame must have volume data in a single column with the name specified by <code>pres.name</code>.
The <code>comp</code> data frame must have biogas composition in a single column with the name specified by <code>comp.name</code>.
For the <code>data.struct = 'wide'</code> option, two separate data frames are needed as in <code>'long'</code>, but there are no reactor identification code columns.
Instead, in <code>dat</code>, volume data are in a separate column for each bottle, and column names are reactor identification codes.
Here, <code>pres.name</code> should be the name of the first column with volume data.
All following columns are assumed to also have volume data.
And in <code>comp</code>, biogas composition data are also in a separate column for each bottle, also with reactor identification codes for column names.
Here, <code>comp.name</code> should be the name of the first column with biogas composition data, as for <code>dat</code>.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_id.name">id.name</code></td>
<td>

<p>name of the reactor identification code column in <code>dat</code>. Must be the same in all data frames used in the function. Default is <code>"id"</code>.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_time.name">time.name</code></td>
<td>

<p>name of column containing time data in <code>dat</code> and <code>comp</code> data frames. Default is <code>"time"</code>.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_pres.name">pres.name</code></td>
<td>

<p>name of column containing the primary response variable (pressure) in <code>dat</code> data frame. Default is <code>dat.type</code> value. See <code>dat.type</code> argument.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_comp.name">comp.name</code></td>
<td>

<p>name of column containing biogas mole fraction of methane in <code>comp</code> data frame. Default is <code>"xCH4"</code>. Must be normalised so xCH4 + xCO2 = 1.0 unless <code>cmethod = "total"</code>.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_pres.resid">pres.resid</code></td>
<td>

<p>headspace pressure after venting. 
Either a single numeric value, assumed to be the same for all observations, or the name of a column in <code>dat</code> that contains these values for each observation.
Can be absolute (default) or gauge depending on the value of <code>absolute</code>.
Length one numeric or character vector.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_temp.init">temp.init</code></td>
<td>

<p>initial headspace temperature in <code>unit.temp</code> units.
Used to determine initial gas volume.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_pres.init">pres.init</code></td>
<td>

<p>headspace pressure at the begining of the experiment. 
Can be absolute (default) or gauge depending on the value of <code>absolute</code>.
Length one numeric vector.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_rh.resid">rh.resid</code></td>
<td>

<p>relative humidity of the gas in the headspace after venting.
If NULL (default), it is calculated for each interval as the ratio of post- to pre-venting pressure (equivalent to assuming relative water vapor concentration (mixing ratio) is the same before and after venting.
If entered, typically should be 1.0.
Length one numeric vector.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_rh.resid.init">rh.resid.init</code></td>
<td>

<p>relative humidity of the gas in the headspace at the begining of the experiment. 
Typically should be 1.0 (the default).
Length one numeric vector.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_headspace">headspace</code></td>
<td>

<p>(optional) a data frame or length-one numeric vector with reactor headspace volume(s).
If a data frame is used, it should at least contain a <code>"id"</code> (reactor identification code) column (see <code>"id.name"</code>) and headspace volume column (see <code>vol.hs.name</code> argument).
Required if <code>cmethod = "total"</code>.
Default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_vol.hs.name">vol.hs.name</code></td>
<td>

<p>name of column containing headspace volume data in optional <code>headspace</code> data frame. 
Default is <code>"vol.hs"</code>.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_absolute">absolute</code></td>
<td>

<p>is the headspace pressure measured (<code>pres.name</code> and <code>pres.resid</code> values/columns) absolute or gauge pressure? 
Default is <code>TRUE</code>. 
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_pres.amb">pres.amb</code></td>
<td>

<p>absolute ambient pressure needed to calculate absolute pressure from gauge pressure measurements.
In atmospheres by default (see <code>unit.pres</code> argument). 
Only a single value is accepted. 
If ambient pressure differed among measurements, it is necessary to convert pressures to absolute values and use <code>absolute = TRUE</code> instead.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_cmethod">cmethod</code></td>
<td>

<p>method for calculating cumulative methane production.
Use <code>"removed"</code> to base production on <code>xCH4</code> and gas volumes removed (default).
Use <code>"total"</code> to base it on the sum of methane removed and methane remaining in the reactor headspace.
For <code>"removed"</code>, <em><code>xCH4</code> should be calculated based on methane and CO2 only (xCH4 + xCO2 = 1.0).</em>
For <code>"total"</code>, <em><code>xCH4</code> should be calculated including all biogas components (CH4, CO2, N2, H2S, etc.) except water.</em>
Length one character vector. 
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_imethod">imethod</code></td>
<td>

<p>method used for interpolation of <code>xCH4</code>.
This is passed as the <code>method</code> argument to <code><a href="#topic+interp">interp</a></code>.
Length one character vector. 
Default is <code>"linear"</code> for linear interpolation.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_extrap">extrap</code></td>
<td>

<p>should <code>comp.name</code> be extrapolated? 
Length one logical vector.
This is passed as the <code>extrap</code> argument to <code><a href="#topic+interp">interp</a></code>. 
Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_addt0">addt0</code></td>
<td>

<p>is the earliest time in <code>dat</code> data frame &ldquo;time zero&rdquo; (start time)? 
If not, this argument adds a row with <code>time.name = 0</code> for each reactor in order to calculate production rates for the first observation.
This addition is only made when <code>time.name</code> is <code>numeric</code> (or <code>integer</code>).
Length-one logical vector.
Default is <code>TRUE</code>.
To return these additional rows in the output, see <code>showt0</code>.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_showt0">showt0</code></td>
<td>

<p>should &ldquo;time zero&rdquo; rows be returned in the output?
Can be convenient for plotting cumulative volumes.
Only applies if <code>time.name</code> is <code>numeric</code> (or <code>integer</code>).
These rows may have been present in the original data (<code>dat</code>) or added by the function (see <code>addt0</code>).
Default value depends on <code>dat</code> <code>time.name</code> column content. 
If <code>time.name</code> column is numeric and contains 0 then the default value is <code>TRUE</code> and otherwise <code>FALSE</code>. 
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_std.message">std.message</code></td>
<td>

<p>should a message with the standard conditions be displayed? 
Default is <code>TRUE</code>. 
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_check">check</code></td>
<td>

<p>should input data be checked for unreasonable values (with warnings)? 
Currently only composition values are checked.
Default is <code>TRUE</code>.
Values are changed if outside 0, 1 (divided by 100).
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_temp.std">temp.std</code></td>
<td>

<p>standard temperature for presentation of biogas and methane results.
Length one numeric vector.
Default value is 0 degrees C (set in <code><a href="#topic+stdVol">stdVol</a></code>).
Argument is passed to <code><a href="#topic+stdVol">stdVol</a></code>.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_pres.std">pres.std</code></td>
<td>

<p>standard pressure for presentation of biogas and methane results.
Length one numeric vector.
Default value is 1.0 atm (101325 Pa) (set in <code><a href="#topic+stdVol">stdVol</a></code>).
Argument is passed to <code><a href="#topic+stdVol">stdVol</a></code>.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_unit.temp">unit.temp</code></td>
<td>

<p>temperature units for <code>temp</code> and <code>temp.std</code> arguments.

Default is <code>"C"</code>. 
Argument is passed to <code><a href="#topic+stdVol">stdVol</a></code>.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_unit.pres">unit.pres</code></td>
<td>

<p>pressure units for <code>pres</code> and <code>pres.std</code> arguments.

Default is <code>"atm"</code>.
Argument is passed to <code><a href="#topic+stdVol">stdVol</a></code>.
</p>
</td></tr>
<tr><td><code id="calcBgMan_+3A_quiet">quiet</code></td>
<td>

<p>use to suppress messages. Default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using pressure data from <code>dat</code> and gas composition from <code>comp</code>, this function will calculate standardised biogas and methane production (if <code>comp</code> is provided) for each observation,  interpolating <code>comp.name</code> (from <code>comp</code> argument) to each <code>time.name</code> in <code>dat</code> if needed, and summing these for cumulative values.
Inputs units are specified with <code>unit.pres</code>, and output volumes are the same as headspace volume, e.g., mL or L.
</p>
<p>Biogas composition (<code>comp.name</code> column in <code>comp</code>) is specified as the mole fraction of methane in dry biogas, normalised so mole fractions of methane and carbon dioxide sum to unity (Richards et al. 1991). Alternatively, if <code>cmethod</code> is set to <code>"total"</code>, biogas composition is the mole fraction of methane in dry biogas (include all the other gases except water). 
</p>
<p>Standard values and units for temperature and pressure can be globally set using the function <code><a href="base.html#topic+options">options</a></code>.
See <code><a href="#topic+stdVol">stdVol</a></code>.
To surpress volume correction to a &ldquo;standard&rdquo; temperature and pressure, leave <code>temp</code> as <code>NULL</code> (the default).
</p>
<p>If <code>check = TRUE</code>, the input values of mole fraction of methane in biogas are checked, and a warning is returned if the are outside 0, 1.
</p>
<p>See associated vignette (<code>calcBgMan_function.Rnw</code>) for more information.
</p>


<h3>Value</h3>

<p>a data frame with all the columns originally present in <code>dat</code>, plus these others:
</p>
<table>
<tr><td><code>vBg</code></td>
<td>
<p>Standardised volume of biogas production for individual event.</p>
</td></tr>
<tr><td><code>xCH4</code></td>
<td>
<p>Interpolated mole fraction of methane in biogas.</p>
</td></tr>
<tr><td><code>vCH4</code></td>
<td>
<p>Standardised volume of methane production for individual event. Only if <code>comp</code> is provided.</p>
</td></tr>
<tr><td><code>vhsCH4</code></td>
<td>
<p>Standardised volume of methane present in reactor headspace. Only if <code>method = "total"</code> is used.</p>
</td></tr>
<tr><td><code>cvBg</code></td>
<td>
<p>Standardised cumulative volume of biogas production.</p>
</td></tr>
<tr><td><code>cvCH4</code></td>
<td>
<p>Standardised cumulative volume of methane production. Only if <code>comp</code> is provided.</p>
</td></tr>
<tr><td><code>rvBg</code></td>
<td>
<p>Production rate of biogas.</p>
</td></tr>
<tr><td><code>rvCH4</code></td>
<td>
<p>Production rate of methane. Only if <code>comp</code> is provided.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sasha D. Hafner and Nanna Lojborg
</p>


<h3>References</h3>

<p>Hafner, S.D., Rennuit, C., Triolo, J.M., Richards, B.K. 2015. Validation of a simple gravimetric method for measuring biogas production in laboratory experiments. <em>Biomass and Bioenergy</em> <b>83</b>, 297-301.
</p>
<p>Hansen, T.L., Schmidt, J.E., Angelidaki, I., Marca, E., Jansen, J. la C., Mosbak, H. and Christensen, T.H. 2004. Method for determination of methane potentials of solid organic waste. <em>Waste Management</em> <b>24</b>, 393-400
</p>
<p>Richards, B.K., Cummings, R.J., White, T.E., Jewell, W.J. 1991. Methods for kinetic analysis of methane fermentation in high solids biomass digesters. <em>Biomass and Bioenergy</em> 1: 65-73.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cumBg">cumBg</a></code>,
<code><a href="#topic+calcBgVol">calcBgVol</a></code>,
<code><a href="#topic+calcBgGD">calcBgGD</a></code>,
<code><a href="#topic+summBg">summBg</a></code>,
<code><a href="#topic+interp">interp</a></code>,
<code><a href="#topic+stdVol">stdVol</a></code>,
<code><a href="base.html#topic+options">options</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example with longcombo structured input data frame
data("sludgeTwoBiogas")
data("sludgeTwoSetup")


head(sludgeTwoBiogas)
head(sludgeTwoSetup)

# Calculate cumulative production and rates 
# Pressure is gauge (not absolute) so absolute argument needed
# Data structure is default of longcombo
cbg &lt;- calcBgMan(sludgeTwoBiogas, temp = 30,
                 id.name = "id", time.name = "time.d", 
                 pres.name = "pres", comp.name = "xCH4n",
                 temp.init = 30, pres.resid = 0, pres.init = 0,
                 headspace = sludgeTwoSetup, vol.hs.name = "vol.hs",
                 pres.amb = 1013, absolute = FALSE,
                 unit.pres = "mbar")
head(cbg)

# Plot results
## Not run: 
  # Not run just because it is a bit slow
  library(ggplot2)

  ggplot(cbg, aes(time.d, cvCH4, colour = factor(id))) + 
    geom_point() +
    geom_line(aes(group = id)) +
    labs(x = "Time (d)", y = "Cumulative methane production  (mL)", colour = "Bottle id")  + 
    theme_bw() 

## End(Not run)

# This sludgeTwoBiogas dataset has original xCH4 as well as normalized values
# So "method 2" can also be used by changing comp.name and cmethod arguments
cbg2 &lt;- calcBgMan(sludgeTwoBiogas, temp = 30,
                  id.name = "id", time.name = "time.d", 
                  pres.name = "pres", comp.name = "xCH4",
                  temp.init = 30, pres.resid = 0, pres.init = 0,
                  headspace = sludgeTwoSetup, vol.hs.name = "vol.hs",
                  pres.amb = 1013, cmethod = 'total', absolute = FALSE,
                  unit.pres = "mbar")
head(cbg2)

# Compare
quantile(cbg2$vCH4 - cbg$vCH4)
# Median difference of 0.2 mL

# Example with long structured input data frame
data("strawPressure")
data("strawComp")
data("strawSetup")

# Need to specify data structure with \code{data.struct} argument
# Using default values for time.name, pres.name
cbg &lt;- calcBgMan(strawPressure, comp = strawComp, temp = 31,
                 data.struct = "long",
                 id.name = "bottle", comp.name = "xCH4",
                 temp.init = 21.55, pres.resid = "pres.resid", pres.init = 0,
                 headspace = strawSetup, vol.hs.name = "headspace",
                 pres.amb = 101.3, absolute = FALSE,
                 unit.pres = "kPa")

# Because of missing composition measurements at last time for some bottles
# CH4 volume will be missing
# Can estimate xCH4 here by extrapolation using argument of same name

cbg2 &lt;- calcBgMan(strawPressure, comp = strawComp, temp = 31,
                 data.struct = "long",
                 id.name = "bottle", comp.name = "xCH4",
                 temp.init = 21.55, pres.resid = "pres.resid", pres.init = 0,
                 headspace = strawSetup, vol.hs.name = "headspace",
                 pres.amb = 101.3, absolute = FALSE, 
                 extrap = TRUE, unit.pres = "kPa")


# For example with wide structured input data frame calcBgVol() help file

</code></pre>

<hr>
<h2 id='calcBgVol'>
Calculate Cumulative Biogas Production from Volumetric Data
</h2><span id='topic+calcBgVol'></span>

<h3>Description</h3>

<p><code>calcBgVol</code> (for <em>calc</em>ulation of <em>b</em>io<em>g</em>as production from <em>vol</em>umetric) measurements) calculates cumulative biogas, methane production and production rates from individual volume and composition measurements for any number of bottles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcBgVol(
  # Main arguments
  dat, comp = NULL, temp = NULL,
  pres = NULL, interval = TRUE, 
  data.struct = 'longcombo',
  # Column names
  id.name = 'id', time.name = 'time', vol.name = 'vol',
  comp.name = NULL,
  # Additional arguments
  headspace = NULL, vol.hs.name = 'vol.hs',
  # Calculation method and other settings
  cmethod = 'removed', imethod = 'linear', extrap = FALSE, 
  addt0 = TRUE, showt0 = TRUE,
  dry = FALSE, 
  empty.name = NULL,
  # Warnings and messages
  std.message = !quiet,
  check = TRUE,
  # Units and standard conditions
  temp.std = getOption('temp.std', as.numeric(NA)),
  pres.std = getOption('pres.std', as.numeric(NA)),
  unit.temp = getOption('unit.temp', 'C'),
  unit.pres = getOption('unit.pres', 'atm'),
  quiet = FALSE
  ) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calcBgVol_+3A_dat">dat</code></td>
<td>

<p>a data frame with bottle identification code; time of measurement (as <code>numeric</code>, or <code>POSIX</code>); and measured biogas volume.
See Details section for details on units.
Additional columns can be present&ndash;these will be returned in the output data frame.
See <code>data.struct</code> argument for details on how data frames are structured.
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_comp">comp</code></td>
<td>

<p>(optional) a data frame with the columns bottle identification code; time of measurement, (as <code>numeric</code>, or <code>POSIX</code>); and methane concentration within dry biogas as a mole fraction, considering only methane and carbon dioxide (unless <code>cmethod = "total"</code>) or a single numeric value.
If omitted, cumulative biogas volume will still be calculated and returned (but no methane data will be returned).
The names of these columns are specified with <code>id.name</code>, <code>time.name</code>, and <code>comp.name</code>.
Default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_temp">temp</code></td>
<td>

<p>the temperature at which biogas volume was measured.
A length-one numeric vector.
Degrees Celcius by default (see <code>unit.temp</code> argument). 
Default is <code>NULL</code>, which suppresses correction for temperature and pressure. 
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_pres">pres</code></td>
<td>

<p>the absolute pressure at which biogas volume was measured.
A length-one numeric vector or a character vector giving the name of the column in <code>dat</code> with the pressure measurements.
Atmospheres by default (see <code>unit.pres</code> argument). 
Default is <code>NULL</code>, which suppresses correction for temperature and pressure. 
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_interval">interval</code></td>
<td>

<p>do biogas volume measurements represent production only from the time interval between observations (default)?
<code>interval = FALSE</code> means measured gas volume is cumulative.
Default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_data.struct">data.struct</code></td>
<td>

<p>the structure of input data. The default of 'longcombo' means separate objects for volume and composition (if available).
The <code>dat</code> data frame must have bottle identification code and time columns with names specified with <code>id.name</code> and <code>time.name</code>, volume data in a single column with the name specified by <code>vol.name</code>, and biogas composition in a single column with the name specified by <code>comp.name</code>
For the <code>data.struct = 'long'</code> option, two separate data frames are needed, one for volume and one for composition (if available).
Each data frame must have bottle identification code and time columns with names specified with <code>id.name</code> and <code>time.name</code>.
The <code>dat</code> data frame must have volume data in a single column with the name specified by <code>vol.name</code>.
The <code>comp</code> data frame must have biogas composition in a single column with the name specified by <code>comp.name</code>.
For the <code>data.struct = 'wide'</code> option, two separate data frames are needed as in <code>'long'</code>, but there are no bottle identification code columns.
Instead, in <code>dat</code>, volume data are in a separate column for each bottle, and column names are bottle identification codes.
Here, <code>vol.name</code> should be the name of the first column with volume data.
All following columns are assumed to also have volume data.
And in <code>comp</code>, biogas composition data are also in a separate column for each bottle, also with bottle identification codes for column names.
Here, <code>comp.name</code> should be the name of the first column with biogas composition data, as for <code>dat</code>.
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_id.name">id.name</code></td>
<td>

<p>name of the bottle identification code column in <code>dat</code>. Must be the same in all data frames used in the function. Default is <code>"id"</code>.
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_time.name">time.name</code></td>
<td>

<p>name of column containing time data in <code>dat</code> and <code>comp</code> data frames. Default is <code>"time"</code>.
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_vol.name">vol.name</code></td>
<td>

<p>name of column containing the primary response variable (as-measured volume) in <code>dat</code> data frame. Default is <code>vol</code>.
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_comp.name">comp.name</code></td>
<td>

<p>name of column containing biogas mole fraction of methane in <code>comp</code> data frame. Default is <code>"xCH4"</code>. Must be normalised so xCH4 + xCO2 = 1.0 unless <code>cmethod = "total"</code>.
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_headspace">headspace</code></td>
<td>

<p>(optional) a data frame or length-one numeric vector with bottle headspace volume(s).
If a data frame is used, it should at least contain a <code>"id"</code> (bottle identification code) column (see <code>"id.name"</code>) and headspace volume column (see <code>vol.hs.name</code> argument).
Required if <code>cmethod = "total"</code>.
Default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_vol.hs.name">vol.hs.name</code></td>
<td>

<p>name of column containing headspace volume data in optional <code>headspace</code> data frame. 
Default is <code>"vol.hs"</code>.
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_cmethod">cmethod</code></td>
<td>

<p>method for calculating cumulative methane production.
Use <code>"removed"</code> to base production on <code>xCH4</code> and gas volumes removed (default).
Use <code>"total"</code> to base it on the sum of methane removed and methane remaining in the bottle headspace.
For <code>"removed"</code>, <em><code>xCH4</code> should be calculated based on methane and CO2 only (xCH4 + xCO2 = 1.0).</em>
For <code>"total"</code>, <em><code>xCH4</code> should be calculated including all biogas components (CH4, CO2, N2, H2S, etc.) except water.</em>
Length one character vector. 
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_imethod">imethod</code></td>
<td>

<p>method used for interpolation of <code>xCH4</code>.
This is passed as the <code>method</code> argument to <code><a href="#topic+interp">interp</a></code>.
Length one character vector. 
Default is <code>"linear"</code> for linear interpolation.
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_extrap">extrap</code></td>
<td>

<p>should <code>comp.name</code> be extrapolated? 
Length one logical vector.
This is passed as the <code>extrap</code> argument to <code><a href="#topic+interp">interp</a></code>. 
Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_addt0">addt0</code></td>
<td>

<p>is the earliest time in <code>dat</code> data frame &ldquo;time zero&rdquo; (start time)? 
If not, this argument adds a row with <code>time.name = 0</code> for each bottle in order to calculate production rates for the first observation.
This addition is only made when <code>time.name</code> is <code>numeric</code> (or <code>integer</code>).
Length-one logical vector.
Default is <code>TRUE</code>.
To return these additional rows in the output, see <code>showt0</code>.
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_showt0">showt0</code></td>
<td>

<p>should &ldquo;time zero&rdquo; rows be returned in the output?
Can be convenient for plotting cumulative volumes.
Only applies if <code>time.name</code> is <code>numeric</code> (or <code>integer</code>).
These rows may have been present in the original data (<code>dat</code>) or added by the function (see <code>addt0</code>).
Default value depends on <code>dat</code> <code>time.name</code> column content. 
If <code>time.name</code> column is numeric and contains 0 then the default value is <code>TRUE</code> and otherwise <code>FALSE</code>. 
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_dry">dry</code></td>
<td>

<p>set to <code>TRUE</code> if volume data are standardised to dry conditions (e.g., AMPTS II data). 
The default (<code>FALSE</code>) means biogas is assumed to be saturated with water vapor.
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_empty.name">empty.name</code></td>
<td>

<p>column containing a binary (logical, or integer or numeric (1 or 0)) variable indicating when accumulated biogas was emptied. 
Use for mix of cumulative/interval data.
If used, <code>interval</code> is ignored.
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_std.message">std.message</code></td>
<td>

<p>should a message with the standard conditions be displayed? 
Default is <code>TRUE</code>. 
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_check">check</code></td>
<td>

<p>should input data be checked for unreasonable values (with warnings)? 
Currently only composition values are checked.
Default is <code>TRUE</code>.
Values are changed if outside 0, 1 (divided by 100).
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_temp.std">temp.std</code></td>
<td>

<p>standard temperature for presentation of biogas and methane results.
Length one numeric vector.
Default value is 0 degrees C (set in <code><a href="#topic+stdVol">stdVol</a></code>).
Argument is passed to <code><a href="#topic+stdVol">stdVol</a></code>.
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_pres.std">pres.std</code></td>
<td>

<p>standard pressure for presentation of biogas and methane results.
Length one numeric vector.
Default value is 1.0 atm (101325 Pa) (set in <code><a href="#topic+stdVol">stdVol</a></code>).
Argument is passed to <code><a href="#topic+stdVol">stdVol</a></code>.
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_unit.temp">unit.temp</code></td>
<td>

<p>temperature units for <code>temp</code> and <code>temp.std</code> arguments.

Default is <code>"C"</code>. 
Argument is passed to <code><a href="#topic+stdVol">stdVol</a></code>.
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_unit.pres">unit.pres</code></td>
<td>

<p>pressure units for <code>pres</code> and <code>pres.std</code> arguments.

Default is <code>"atm"</code>.
Argument is passed to <code><a href="#topic+stdVol">stdVol</a></code>.
</p>
</td></tr>
<tr><td><code id="calcBgVol_+3A_quiet">quiet</code></td>
<td>

<p>use to suppress messages. Default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using volume data from <code>dat</code> and gas composition from <code>comp</code>, this function will calculate standardised biogas and methane production (if <code>comp</code> is provided) for each observation,  interpolating <code>comp.name</code> (from <code>comp</code> argument) to each <code>time.name</code> in <code>dat</code> if needed, and summing these for cumulative values. 
All volumes (input and output) have the same units, e.g., mL, L, SCF.
</p>
<p>Biogas composition (<code>comp.name</code> column in <code>comp</code>) is specified as the mole fraction of methane in dry biogas, normalised so mole fractions of methane and carbon dioxide sum to unity (Richards et al. 1991). Alternatively, if <code>cmethod</code> is set to <code>"total"</code>, biogas composition is the mole fraction of methane in dry biogas (include all the other gases except water). 
</p>
<p>Standard values and units for temperature and pressure can be globally set using the function <code><a href="base.html#topic+options">options</a></code>.
See <code><a href="#topic+stdVol">stdVol</a></code>.
To surpress volume correction to a &ldquo;standard&rdquo; temperature and pressure, leave <code>temp</code> as <code>NULL</code> (the default).
</p>
<p>If <code>check = TRUE</code>, the input values of mole fraction of methane in biogas are checked, and a warning is returned if the are outside 0, 1.
</p>
<p>See associated vignette (<code>calcBgVol_function.Rnw</code>) for more information.
</p>


<h3>Value</h3>

<p>a data frame with all the columns originally present in <code>dat</code>, plus these others:
</p>
<table>
<tr><td><code>vBg</code></td>
<td>
<p>Standardised volume of biogas production for individual event.</p>
</td></tr>
<tr><td><code>xCH4</code></td>
<td>
<p>Interpolated mole fraction of methane in biogas.</p>
</td></tr>
<tr><td><code>vCH4</code></td>
<td>
<p>Standardised volume of methane production for individual event. Only if <code>comp</code> is provided.</p>
</td></tr>
<tr><td><code>vhsCH4</code></td>
<td>
<p>Standardised volume of methane present in bottle headspace. Only if <code>method = "total"</code> is used.</p>
</td></tr>
<tr><td><code>cvBg</code></td>
<td>
<p>Standardised cumulative volume of biogas production.</p>
</td></tr>
<tr><td><code>cvCH4</code></td>
<td>
<p>Standardised cumulative volume of methane production. Only if <code>comp</code> is provided.</p>
</td></tr>
<tr><td><code>rvBg</code></td>
<td>
<p>Production rate of biogas.</p>
</td></tr>
<tr><td><code>rvCH4</code></td>
<td>
<p>Production rate of methane. Only if <code>comp</code> is provided.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sasha D. Hafner and Nanna Lojborg
</p>


<h3>References</h3>

<p>Hafner, S.D., Rennuit, C., Triolo, J.M., Richards, B.K. 2015. Validation of a simple gravimetric method for measuring biogas production in laboratory experiments. <em>Biomass and Bioenergy</em> <b>83</b>, 297-301.
</p>
<p>Richards, B.K., Cummings, R.J., White, T.E., Jewell, W.J. 1991. Methods for kinetic analysis of methane fermentation in high solids biomass digesters. <em>Biomass and Bioenergy</em> 1: 65-73.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cumBg">cumBg</a></code>,
<code><a href="#topic+calcBgMan">calcBgMan</a></code>,
<code><a href="#topic+calcBgGD">calcBgGD</a></code>,
<code><a href="#topic+summBg">summBg</a></code>,
<code><a href="#topic+interp">interp</a></code>,
<code><a href="#topic+stdVol">stdVol</a></code>,
<code><a href="base.html#topic+options">options</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
# Example with long structured input data frame

data("s3lcombo")
s3lcombo

# Calculate cumulative production and rates from s3lcombo
# With default data structure comp argument is not needed
# Necessary to extrapolate because first observations are missing xCH4
cbg &lt;- calcBgVol(s3lcombo, 
                 temp = 25, pres = 1,
                 id.name = 'id', time.name = 'time.d', 
                 vol.name = 'vol.ml', comp.name = 'xCH4', 
                 extrap = TRUE)
head(cbg)

# Plot results
## Not run: 
  # Not run just because it is a bit slow
  ggplot(cbg, aes(time.d, cvCH4, colour = id)) + 
         geom_point() + geom_line(aes(group = id)) +
         labs(x = "Time (d)", y = "Cumulative methane production  (mL)", colour = "Bottle ID")  + 
         theme_bw() 

  plot(ggplot)

## End(Not run)


# Wide data structure, from AMPTS II in this case
data("feedVol")
head(feedVol)

# By default biogas is assumed to be saturated with water vapor
# Composition is set to a single value. 
# Data are cumulative
args(calcBgVol)
cbg &lt;- calcBgVol(feedVol, comp = 1, temp = 0, pres = 1,
                 interval = FALSE, data.struct = 'wide',
                 id.name = "id", time.name = 'time.d', vol.name = '1', 
                 dry = TRUE)

head(cbg)


# Calculate cumulative production and rates from vol and comp
# Biogas volume and composition can be in separate data frames
data("vol")
data("comp")

head(vol)
head(comp)

# extrap = TRUE is needed to get CH4 results here because first xCH4 values are missing
cbg &lt;- calcBgVol(vol, comp = comp, temp = 20, pres = 1, 
                 data.struct = "long",
                 id.name = "id", time.name = "days", comp.name = "xCH4", 
                 vol.name = "vol", extrap = TRUE)

head(cbg)


</code></pre>

<hr>
<h2 id='calcCOD'>
Calculate Oxygen Demand
</h2><span id='topic+calcCOD'></span>

<h3>Description</h3>

<p><code>calcCOD</code> is used to calculate the oxygen demand (&ldquo;calculated oxygen demand&rdquo;, or COD' as described by Rittmann and McCarty (2001)) of a compound.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcCOD(form)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calcCOD_+3A_form">form</code></td>
<td>

<p>a chemical formula, as a character vector, e.g., <code>"C6H12O6"</code> for glucose or <code>"CH3COOH"</code> for acetic acid, or <code>c("C6H12O6", "CH3COOH")</code> for both at once.
Not case-sensitive for single letter elements (see &lsquo;Details&rsquo;).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on Eqs. (2.2) and (2.3) in Rittmann and McCarty (2001) (p 128), but using molar mass calculated with <code><a href="#topic+molMass">molMass</a></code>.
<code>calcCOD</code> is not case-sensitive as long as all elements have single letter abbreviations.
The function is vectorized.
</p>


<h3>Value</h3>

<p>A numeric vector with length equal to length of <code>form</code> with COD' in g of oxygen per g of compound.
</p>


<h3>Author(s)</h3>

<p>Sasha D. Hafner and Charlotte Rennuit
</p>


<h3>References</h3>

<p>Rittmann, B., McCarty, P. 2001 <em>Environmental Biotechnology</em>. McGraw-Hill.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+molMass">molMass</a></code>, 
<code><a href="#topic+predBg">predBg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  calcCOD("C6H12O6")

  calcCOD("CH3COOH")

  calcCOD("CH3CH2OH")

  calcCOD("CH4")

  calcCOD("ch4")

  calcCOD(c("C6H12O6", "CH3COOH", "CH3CH2OH"))
</code></pre>

<hr>
<h2 id='comp'>
Methane Content of Biogas
</h2><span id='topic+comp'></span>

<h3>Description</h3>

<p>Methane content (biogas composition) measurements from nine batch reactors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("comp")</code></pre>


<h3>Format</h3>

<p>A data frame with 132 observations on the following 4 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>identification code, a unique value for each reactor in the dataset. A factor with levels <code>2_1</code>, <code>2_2</code>, <code>2_3</code>, <code>2_4</code>, <code>2_5</code>, <code>2_6</code>, <code>2_7</code>, <code>2_8</code>, <code>2_9</code>, <code>2_10</code>, <code>2_11</code>, and <code>2_12</code> </p>
</dd>
<dt><code>date.time</code></dt><dd><p>date and time of mass measurement, a POSIXct object.</p>
</dd>
<dt><code>days</code></dt><dd><p>elapsed time of mass measurements (from reactor setup) in days, a numeric vector.</p>
</dd>
<dt><code>xCH4</code></dt><dd><p>biogas methane content as a mole fraction, excluding water and all other gases other than carbon dioxide, a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for multiple functions, e.g., <code><a href="#topic+interp">interp</a></code>, <code><a href="#topic+cumBg">cumBg</a></code>, or <code><a href="#topic+summBg">summBg</a></code>.
Reactors were 500 mL glass serum bottles with butyl rubber septa and screw caps. 
Methane and carbon dioxide contents were determined by gas chromatography using a thermal conductivity detector and normalised so methane and carbon dioxide sum to 1.0.
Data in <code>vol</code>, <code>mass</code>, <code>comp</code>, and <code>setup</code> are from the same reactors.
</p>


<h3>Source</h3>

<p>Measurements by Charlotte Rennuit and Ali Heidarzadeh Vazifehkhoran.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(comp)
</code></pre>

<hr>
<h2 id='comp2'>
Methane Content of Biogas
</h2><span id='topic+comp2'></span>

<h3>Description</h3>

<p>Methane content (biogas composition) measurements from 15 batch reactors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("comp2")</code></pre>


<h3>Format</h3>

<p>A data frame with 360 observations on the following 3 variables.
</p>

<dl>
<dt><code>bottle</code></dt><dd><p>identification code, a unique value for each reactor in the dataset. A factor with levels <code>1_1</code>, <code>1_2</code>, <code>1_3</code>, <code>2_1</code>, <code>2_2</code>, <code>2_2</code>, ... through <code>5_3</code>. The first number indicates the sample, the second the replicate.</p>
</dd>
<dt><code>days</code></dt><dd><p>elapsed time of mass measurements (from reactor setup) in days, a numeric vector.</p>
</dd>
<dt><code>CH4.conc</code></dt><dd><p>biogas methane content as a mole fraction, excluding water and all other gases other than carbon dioxide, a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for multiple functions, e.g., <code><a href="#topic+interp">interp</a></code>, <code><a href="#topic+cumBg">cumBg</a></code>, or <code><a href="#topic+summBg">summBg</a></code>.
Reactors were 500 mL or 1000 mL glass serum bottles with butyl rubber septa and screw caps. 
Methane and carbon dioxide contents were determined by gas chromatography using a thermal conductivity detector and normalised so methane and carbon dioxide sum to 1.0.
Data in <code>vol2</code>, <code>comp2</code>, and <code>setup2</code> are from the same reactors.
</p>


<h3>Source</h3>

<p>Measurements made by Ali Heidarzadeh Vazifehkhoran
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(comp2)
</code></pre>

<hr>
<h2 id='cumBg'>
Calculate Cumulative Biogas Production
</h2><span id='topic+cumBg'></span>

<h3>Description</h3>

<p><code>cumBg</code> (for <em>cum</em>ulative <em>b</em>io<em>g</em>as) calculates cumulative biogas, methane production and production rates from individual volume (or mass) and composition measurements for any number of reactors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cumBg(
  # Main arguments
  dat, dat.type = 'vol', comp = NULL, temp = NULL, 
  pres = NULL, interval = TRUE,
  data.struct = 'long',
  # Column names for volumetric method
  id.name = 'id', time.name = 'time', dat.name = dat.type,
  comp.name = 'xCH4', 
  # Additional arguments for manometric and gravimetric methods
  pres.resid = NULL, temp.init = NULL, pres.init = NULL,
  rh.resid = NULL,
  rh.resid.init = 1, headspace = NULL, 
  vol.hs.name = 'vol.hs', headcomp = 'N2',
  absolute = TRUE, pres.amb = NULL,
  # Additional arguments for GCA method
  mol.f.name = NULL, vol.syr = NULL,
  # Calculation method and other settings
  cmethod = 'removed', imethod = 'linear', extrap = FALSE,
  addt0 = TRUE, showt0 = TRUE, 
  dry = FALSE,
  empty.name = NULL,
  # Warnings and messages
  std.message = !quiet, 
  check = TRUE,
  # Units and standard conditions
  temp.std = getOption('temp.std', as.numeric(NA)), 
  pres.std = getOption('pres.std', as.numeric(NA)),
  unit.temp = getOption('unit.temp', 'C'),
  unit.pres = getOption('unit.pres', 'atm'),
  quiet = FALSE
  ) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cumBg_+3A_dat">dat</code></td>
<td>

<p>a data frame with reactor identification code; time of measurement (as <code>numeric</code>, or <code>POSIX</code>); and measured biogas volume, pressure in <code>pres.unit</code>, or total reactor mass (see <code>dat.type</code> argument).
See Details section for details on units.
Additional columns can be present&ndash;these will be returned in the output data frame.
See <code>data.struct</code> argument for details on how data frames are structured.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_dat.type">dat.type</code></td>
<td>

<p>the type of data contained in <code>dat</code>. 
Use <code>"vol"</code> or <code>"volume"</code> for biogas volume (volumetric method will be used), <code>"mass"</code> for reactor masses (gravimetric method will be used) or <code>"pres"</code> (<code>"pressure"</code>) for headspace pressure (pressure of the headspace will be converted to gas volume).
Default is <code>"vol"</code>.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_comp">comp</code></td>
<td>

<p>(optional) a data frame with the columns reactor identification code; time of measurement, (as <code>numeric</code>, or <code>POSIX</code>); and methane concentration within dry biogas as a mole fraction, considering only methane and carbon dioxide (unless <code>cmethod = "total"</code>) or a single numeric value.
If omitted, cumulative biogas volume will still be calculated and returned (but no methane data will be returned).
The names of these columns are specified with <code>id.name</code>, <code>time.name</code>, and <code>comp.name</code>.
Default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_temp">temp</code></td>
<td>

<p>the temperature at which biogas volume was measured (when <code>dat.type = "vol"</code>), or of biogas just prior to exiting the reactor (when <code>dat.type = "mass"</code>).
A length-one numeric vector.
Degrees Celcius by default (see <code>unit.temp</code> argument). 
Default is <code>NULL</code>, which suppresses correction for temperature and pressure. 
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_pres">pres</code></td>
<td>

<p>the absolute pressure at which biogas volume was measured (when <code>dat.type = "vol"</code>), or of biogas just prior to exiting the reactor (when <code>dat.type = "mass"</code>).
A length-one numeric vector or a character vector giving the name of the column in <code>dat</code> with the pressure measurements.
Atmospheres by default (see <code>unit.pres</code> argument). 
Default is <code>NULL</code>, which suppresses correction for temperature and pressure. 
Not used for manometric method (when <code>dat.type = "pres"</code>).
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_interval">interval</code></td>
<td>

<p>do biogas measurements (volume or pressure) represent production only from the time interval between observations (default)?
<code>interval = FALSE</code> means measured gas volume or pressure is cumulative.
Applies to volumetric (<code>dat.type = "vol"</code>) and manometric methods (<code>dat.type = "pres"</code>). 
The gravimetric method (<code>dat.type = "mass"</code>) is cumulative by nature and the <code>interval</code> argument is not used.
For mixed manometric measurements (some observations vented, some not), use <code>interval = TRUE</code>, include a column for <code>pres.resid</code>, and, if composition was only measured for vented observations, use <code>imethod = "f1"</code>.
Default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_data.struct">data.struct</code></td>
<td>

<p>the structure of input data. The default of 'long' means separate objects for volume (or pressure or mass for manometric and gravimetric methods) and composition (if available). 
Each data frame must have reactor identification code and time columns with names specified with <code>id.name</code> and <code>time.name</code>.
The <code>dat</code> data frame must have volume (or pressure or mass) data in a single column with the name specified by <code>dat.name</code>.
The <code>comp</code> data frame must have biogas composition in a single column with the name specified by <code>comp.name</code>.
For the <code>data.struct = 'longcombo'</code> option, the composition column should be in the <code>dat</code> data frame, and the <code>comp</code> argument is not used.
For the <code>data.struct = 'wide'</code> option, two separate data frames are needed as in <code>'long'</code>, but there are no reactor identification code columns.
Instead, in <code>dat</code>, volume (or pressure or mass) data are in a separate column for each bottle, and column names are reactor identification codes.
Here, <code>dat.name</code> should be the name of the first column with volume (or pressure or mass) data.
All following columns are assumed to also have volume (or pressure or mass) data.
And in <code>comp</code>, biogas composition data are also in a separate column for each bottle, also with reactor identification codes for column names.
Here, <code>comp.name</code> should be the name of the first column with biogas composition data, as for <code>dat</code>.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_id.name">id.name</code></td>
<td>

<p>name of the reactor identification code column in <code>dat</code>. Must be the same in all data frames used in the function. Default is <code>"id"</code>.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_time.name">time.name</code></td>
<td>

<p>name of column containing time data in <code>dat</code> and <code>comp</code> data frames. Default is <code>"time"</code>.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_dat.name">dat.name</code></td>
<td>

<p>name of column containing the primary response variable (volume or mass) in <code>dat</code> data frame. Default is <code>dat.type</code> value. See <code>dat.type</code> argument.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_comp.name">comp.name</code></td>
<td>

<p>name of column containing biogas mole fraction of methane in <code>comp</code> data frame. Default is <code>"xCH4"</code>. Must be normalised so xCH4 + xCO2 = 1.0 unless <code>cmethod = "total"</code>.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_pres.resid">pres.resid</code></td>
<td>

<p>headspace pressure after venting. 
Either a single numeric value, assumed to be the same for all observations, or the name of a column in <code>dat</code> that contains these values for each observation.
Used in manometric method only (<code>dat.type = "pres"</code>).
Can be absolute (default) or gauge depending on the value of <code>absolute</code>.
Length one numeric or character vector.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_temp.init">temp.init</code></td>
<td>

<p>initial headspace temperature in <code>unit.temp</code> units.
Used to correct for effect of initial reactor headspace on mass loss for the gravimetric method (<code>dat.type = "mass"</code>), and to determine initial gas volume in the manometric method (<code>dat.type = "pres"</code>).
Not used for volumetric method (<code>dat.type = "vol"</code>).
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_pres.init">pres.init</code></td>
<td>

<p>headspace pressure at the begining of the experiment. 
Used in manometric method only (<code>dat.type = "pres"</code>).
Can be absolute (default) or gauge depending on the value of <code>absolute</code>.
Length one numeric vector.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_rh.resid">rh.resid</code></td>
<td>

<p>relative humidity of the gas in the headspace after venting.
If NULL (default), it is calculated for each interval as the ratio of post- to pre-venting pressure (equivalent to assuming relative water vapor concentration (mixing ratio) is the same before and after venting.
If entered, typically should be 1.0.
Length one numeric vector.
Used in manometric method only (<code>dat.type = "pres"</code>).
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_rh.resid.init">rh.resid.init</code></td>
<td>

<p>relative humidity of the gas in the headspace at the begining of the experiment. 
Typically should be 1.0 (the default).
Length one numeric vector.
Used in manometric method only (<code>dat.type = "pres"</code>).
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_headspace">headspace</code></td>
<td>

<p>(optional) a data frame or length-one numeric vector with reactor headspace volume(s).
If a data frame is used, it should at least contain a <code>"id"</code> (reactor identification code) column (see <code>"id.name"</code>) and headspace volume column (see <code>vol.hs.name</code> argument).
Required if <code>method = "total"</code> for the volumetric method, for initial headspace correction for the gravimetric method (see <code>headcomp</code> and <code>temp.init</code>) and for the manometric method using pressure measurements (<code>dat.type = "pres"</code>).
Default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_vol.hs.name">vol.hs.name</code></td>
<td>

<p>name of column containing headspace volume data in optional <code>headspace</code> data frame. 
Default is <code>"vol.hs"</code>.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_headcomp">headcomp</code></td>
<td>

<p>(optional) Composition of headspace for correction of initial headspace mass for gravimetric method only.
If provided, correction will be applied to first mass loss observation for each individual reactor.
See argument of the same name in <code><a href="#topic+mass2vol">mass2vol</a></code>.
Currently, the only option is <code>"N2"</code> for dinitrogen gas.
Use of any other value will be ignored with a warning.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_absolute">absolute</code></td>
<td>

<p>is the headspace pressure measured in the manometric method (<code>dat.name</code> and <code>pres.resid</code> values/columns) absolute or gauge pressure? 
Applies to manometric method only (<code>dat.type = "pres"</code>).
Default is <code>TRUE</code>. 
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_pres.amb">pres.amb</code></td>
<td>

<p>absolute ambient pressure needed to calculate absolute pressure from gauge pressure measurements.
In atmospheres by default (see <code>unit.pres</code> argument). 
Only a single value is accepted. 
If ambient pressure differed among measurements, it is necessary to convert pressures to absolute values and use <code>absolute = TRUE</code> instead.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_mol.f.name">mol.f.name</code></td>
<td>

<p>name of the column in <code>dat</code> that contains the post-venting (f for final) quantity of methane in the syringe. 
Used for the absolute GC method (<code>dat.type = "gca"</code>) only (Hansen et al., 2004).
If venting was not done for a particular observation, the value in this column should be NA.
The pre-venting column name is given in the <code>dat.name</code> column.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_vol.syr">vol.syr</code></td>
<td>

<p>volume of the syringe used in the absolute GC method (Hansen et al., 2004) (<code>dat.type = "gca"</code>) in mL.
Only a single value is accepted. 
If other volume units are used (e.g., microL), the units used for the (<code>headspace</code>) argument must match, and the output volume unit will be the same.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_cmethod">cmethod</code></td>
<td>

<p>method for calculating cumulative methane production.
Applies to <code>dat.type = "vol"</code> and <code>dat.type = "pres"</code> methods only. 
Use <code>"removed"</code> to base production on <code>xCH4</code> and gas volumes removed (default).
Use <code>"total"</code> to base it on the sum of methane removed and methane remaining in the reactor headspace.
For <code>"removed"</code>, <em><code>xCH4</code> should be calculated based on methane and CO2 only (xCH4 + xCO2 = 1.0).</em>
For <code>"total"</code>, <em><code>xCH4</code> should be calculated including all biogas components (CH4, CO2, N2, H2S, etc.) except water.</em>
Length one character vector. 
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_imethod">imethod</code></td>
<td>

<p>method used for interpolation of <code>xCH4</code>.
This is passed as the <code>method</code> argument to <code><a href="#topic+interp">interp</a></code>.
Length one character vector. 
Default is <code>"linear"</code> for linear interpolation.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_extrap">extrap</code></td>
<td>

<p>should <code>comp.name</code> be extrapolated? 
Length one logical vector.
This is passed as the <code>extrap</code> argument to <code><a href="#topic+interp">interp</a></code>. 
Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_addt0">addt0</code></td>
<td>

<p>is the earliest time in <code>dat</code> data frame &ldquo;time zero&rdquo; (start time)? 
If not, this argument adds a row with <code>time.name = 0</code> for each reactor in order to calculate production rates for the first observation.
This addition is only made when <code>dat.type = "vol"</code> or <code>dat.type = "pres"</code> and <code>time.name</code> is <code>numeric</code> (or <code>integer</code>).
Length-one logical vector.
Default is <code>TRUE</code>.
To return these additional rows in the output, see <code>showt0</code>.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_showt0">showt0</code></td>
<td>

<p>should &ldquo;time zero&rdquo; rows be returned in the output?
Can be convenient for plotting cumulative volumes.
Only applies if <code>time.name</code> is <code>numeric</code> (or <code>integer</code>).
These rows may have been present in the original data (<code>dat</code>) or added by the function (see <code>addt0</code>).
Default value depends on <code>dat</code> <code>time.name</code> column content. 
If <code>time.name</code> column is numeric and contains 0 then the default value is <code>TRUE</code> and otherwise <code>FALSE</code>. 
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_dry">dry</code></td>
<td>

<p>set to <code>TRUE</code> is volume data are standardised to dry conditions (e.g., AMPTS II data). 
Only applies to volumetric data (dat.type = 'vol').
The default (<code>FALSE</code>) means biogas is assumed to be saturated with water vapor.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_empty.name">empty.name</code></td>
<td>

<p>column containing a binary (logical, or integer or numeric (1 or 0)) variable indicating when accumulated biogas was emptied. 
Use for mix of cumulative/interval data.
Only applies to volumetric data (dat.type = 'vol').
If used, <code>interval</code> is ignored.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_std.message">std.message</code></td>
<td>

<p>should a message with the standard conditions be displayed? 
Default is <code>TRUE</code>. 
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_check">check</code></td>
<td>

<p>should input data be checked for unreasonable values (with warnings)? 
Currently only composition values are checked.
Default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_temp.std">temp.std</code></td>
<td>

<p>standard temperature for presentation of biogas and methane results.
Length one numeric vector.
Default value is 0 degrees C (set in <code><a href="#topic+stdVol">stdVol</a></code>).
Argument is passed to <code><a href="#topic+stdVol">stdVol</a></code>.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_pres.std">pres.std</code></td>
<td>

<p>standard pressure for presentation of biogas and methane results.
Length one numeric vector.
Default value is 1.0 atm (101325 Pa) (set in <code><a href="#topic+stdVol">stdVol</a></code>).
Argument is passed to <code><a href="#topic+stdVol">stdVol</a></code>.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_unit.temp">unit.temp</code></td>
<td>

<p>temperature units for <code>temp</code> and <code>temp.std</code> arguments.

Default is <code>"C"</code>. 
Argument is passed to <code><a href="#topic+stdVol">stdVol</a></code>.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_unit.pres">unit.pres</code></td>
<td>

<p>pressure units for <code>pres</code> and <code>pres.std</code> arguments.

Default is <code>"atm"</code>.
Argument is passed to <code><a href="#topic+stdVol">stdVol</a></code>.
</p>
</td></tr>
<tr><td><code id="cumBg_+3A_quiet">quiet</code></td>
<td>

<p>use to suppress messages. Default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using volume, mass, pressure, or molar quantity data from <code>dat</code> and gas composition from <code>comp</code>, this function will calculate standardised biogas and methane production (if <code>comp</code> is provided) for each observation,  interpolating <code>comp.name</code> (from <code>comp</code> argument) to each <code>time.name</code> in <code>dat</code> if needed, and summing these for cumulative values.
Use of volumetric measurements is the default case. 
However, this function is essentially deprecated for both volumetric and manometric methods, and the new <code><a href="#topic+calcBgMan">calcBgMan</a></code> and <code><a href="#topic+calcBgVol">calcBgVol</a></code> functions are recommended instead.
</p>
<p>Alternatively, if reactor mass is given in <code>dat</code>, a gravimetric approach (Hafner et al. 2015) can be applied by setting <code>dat.type</code> to <code>"mass"</code>.
In this case, to determine total cumulative biogas production for batch reactors, an initial mass should be included for each reactor.
If pressure is measured in <code>dat</code>, a manometric method can be applied by setting <code>dat.type</code> to <code>"pres"</code>.  
Lastly, molar quantity of methane can be used in the absolute GC method by setting <code>dat.type</code> to <code>"gca"</code>.  
</p>
<p>For the volumetric and absolute GC methods, all volumes (input and output) have the same units, e.g., mL, L, SCF.
For the gravimetric method, output volumes will be in mL if input masses are in g (or in L if input masses are in kg, etc.).
For the manometric method, inputs units are specified with <code>unit.pres</code>, and output volumes are the same as headspace volume, e.g., mL or L.
</p>
<p>Biogas composition (<code>comp.name</code> column in <code>comp</code>) is specified as the mole fraction of methane in dry biogas, normalised so mole fractions of methane and carbon dioxide sum to unity (Richards et al. 1991). Alternatively, if <code>cmethod</code> is set to <code>"total"</code>, biogas composition is the mole fraction of methane in dry biogas (include all the other gases except water). 
</p>
<p>Standard values and units for temperature and pressure can be globally set using the function <code><a href="base.html#topic+options">options</a></code>.
See <code><a href="#topic+stdVol">stdVol</a></code>.
To surpress volume correction to a &ldquo;standard&rdquo; temperature and pressure, leave <code>temp</code> as <code>NULL</code> (the default).
</p>
<p>If <code>check = TRUE</code>, the input values of mole fraction of methane in biogas are checked, and a warning is returned if the are outside 0, 1.
</p>


<h3>Value</h3>

<p>a data frame with all the columns originally present in <code>dat</code>, plus these others:
</p>
<table>
<tr><td><code>vBg</code></td>
<td>
<p>Standardised volume of biogas production for individual event.</p>
</td></tr>
<tr><td><code>xCH4</code></td>
<td>
<p>Interpolated mole fraction of methane in biogas.</p>
</td></tr>
<tr><td><code>vCH4</code></td>
<td>
<p>Standardised volume of methane production for individual event. Only if <code>comp</code> is provided.</p>
</td></tr>
<tr><td><code>vhsCH4</code></td>
<td>
<p>Standardised volume of methane present in reactor headspace. Only if <code>method = "total"</code> is used.</p>
</td></tr>
<tr><td><code>cvBg</code></td>
<td>
<p>Standardised cumulative volume of biogas production.</p>
</td></tr>
<tr><td><code>cvCH4</code></td>
<td>
<p>Standardised cumulative volume of methane production. Only if <code>comp</code> is provided.</p>
</td></tr>
<tr><td><code>rvBg</code></td>
<td>
<p>Production rate of biogas.</p>
</td></tr>
<tr><td><code>rvCH4</code></td>
<td>
<p>Production rate of methane. Only if <code>comp</code> is provided.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sasha D. Hafner and Charlotte Rennuit
</p>


<h3>References</h3>

<p>Hafner, S.D., Rennuit, C., Triolo, J.M., Richards, B.K. 2015. Validation of a simple gravimetric method for measuring biogas production in laboratory experiments. <em>Biomass and Bioenergy</em> <b>83</b>, 297-301.
</p>
<p>Hansen, T.L., Schmidt, J.E., Angelidaki, I., Marca, E., Jansen, J. la C., Mosbak, H. and Christensen, T.H. 2004. Method for determination of methane potentials of solid organic waste. <em>Waste Management</em> <b>24</b>, 393-400
</p>
<p>Richards, B.K., Cummings, R.J., White, T.E., Jewell, W.J. 1991. Methods for kinetic analysis of methane fermentation in high solids biomass digesters. <em>Biomass and Bioenergy</em> 1: 65-73.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calcBgMan">calcBgMan</a></code>,
<code><a href="#topic+calcBgVol">calcBgVol</a></code>,
<code><a href="#topic+calcBgGD">calcBgGD</a></code>,
<code><a href="#topic+summBg">summBg</a></code>,
<code><a href="#topic+interp">interp</a></code>,
<code><a href="#topic+stdVol">stdVol</a></code>,
<code><a href="base.html#topic+options">options</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("vol")
data("comp")

head(vol)
head(comp)

# Calculate cumulative production and rates from vol and comp
cum.prod &lt;- cumBg(vol, comp = comp, temp = 20, pres = 1, id.name = "id", time.name = "days", 
		  comp.name = "xCH4", dat.name = "vol")
head(cum.prod)

# Note warnings and related NAs in results
# Set extrap = TRUE to extrapolate xCH4 to earliest times

# Calculate cumulative production and rates from vol and comp
cum.prod &lt;- cumBg(vol, comp = comp, temp = 20, pres = 1, id.name = "id", time.name = "days", 
		  comp.name = "xCH4", dat.name = "vol", extrap = TRUE)
head(cum.prod)

# In this case, we can use default values for some column names, so this call is identical
cum.prod &lt;- cumBg(vol, comp = comp, temp = 20, pres = 1, time.name = "days", extrap = TRUE)

# Plot results
## Not run: 
# Not run just because it is a bit slow
library(ggplot2)
qplot(x = days, y = cvCH4, data = cum.prod, xlab = "Time (d)", 
      ylab = "Cumulative methane production (mL)",color = id, geom = "line")

## End(Not run)

# Omit added time zero rows
cum.prod &lt;- cumBg(vol, comp = comp, temp = 20, pres = 1, time.name = "days", extrap = TRUE, 
		  showt0 = FALSE)
head(cum.prod)

## Not run: 
# Not run just because it is a bit slow
qplot(x = days, y = cvCH4, data = cum.prod, xlab = "Time (d)", 
      ylab = "Cumulative methane production (mL)", color = id, geom = "line")

## End(Not run)

# Previous is different from never adding them in the first place (rates not calculated for first 
# observations here)
cum.prod &lt;- cumBg(vol, comp = comp, temp = 20, pres = 1, time.name = "days", extrap = TRUE, 
		  addt0 = FALSE)
head(cum.prod)

## Not run: 
# Not run just because it is a bit slow
qplot(x = days, y = cvCH4, data = cum.prod, xlab = "Time (d)", 
      ylab = "Cumulative methane production (mL)", color = id, geom = "line")

## End(Not run)

# Can use POSIX objects for time (but cumBg cannot add t0 rows here)
class(vol$date.time)
class(comp$date.time)
cum.prod &lt;- cumBg(vol, comp = comp, temp = 20, pres = 1, time.name = "date.time", extrap = TRUE)
head(cum.prod)

## Not run: 
# Not run just because it is a bit slow
qplot(x = date.time, y = cvCH4, data = cum.prod, xlab = "Time (d)", 
      ylab = "Cumulative methane production (mL)", color = id, geom = "line")

## End(Not run)

# Can leave out composition data, and then CH4 is not included in results
cum.prod &lt;- cumBg(vol, temp = 20, pres = 1, time.name = "days")
head(cum.prod)

# Leave out pres or temp, and results are not standardised
cum.prod &lt;- cumBg(vol, time.name = "days")
head(cum.prod)

# Example with input data frames with different column names
data("vol2")
data("comp2")

head(vol2)
head(comp2)

cum.prod &lt;- cumBg(vol2, comp = comp2, temp = 20, pres = 1, 
                  id.name = "bottle", time.name = "days", 
		  dat.name = "meas.vol", comp.name = "CH4.conc")
head(cum.prod)
tail(cum.prod)

# Note warnings and related NAs in results
warnings()

# Set extrap = TRUE to avoid
cum.prod &lt;- cumBg(vol2, comp = comp2, temp = 20, pres = 1, 
                  id.name = "bottle", time.name = "days", 
		  dat.name = "meas.vol", comp.name = "CH4.conc", 
                  extrap = TRUE)
head(cum.prod)

## Not run: 
# Not run just because it is a bit slow
qplot(x = days, y = cvCH4, data = cum.prod, xlab = "Time (d)", 
      ylab = "Cumulative methane production (mL)", 
      color = bottle, geom = "line")

## End(Not run)

# Mass example
data("mass")

mass

# Need to specify data type with dat.type argument (using default 
# values for id.name, dat.name, and comp.name)
cum.prod &lt;- cumBg(mass, dat.type = "mass", comp = comp, temp = 35, 
                  pres = 1, time.name = "days")
cum.prod

# Drop time 0 rows
cum.prod &lt;- cumBg(mass, dat.type = "mass", comp = comp, temp = 35, 
                  pres = 1, time.name = "days", showt0 = FALSE)
cum.prod

# Add initial headspace correction (alternatively, headspace could 
# be a data frame with a different volume for each reactor)
cum.prod &lt;- cumBg(mass, dat.type = "mass", comp = comp, temp = 35, 
                  pres = 1, time.name = "days", headspace = 300, 
                  headcomp = "N2", temp.init = 20, showt0 = FALSE)
cum.prod

# Pressure example
data("strawPressure")
data("strawComp")
data("strawSetup")

cum.prod &lt;- cumBg(strawPressure, dat.type = 'pres', 
                  comp = strawComp, temp = 35, 
                  id.name = 'bottle', time.name ='time', 
                  dat.name = 'pres', comp.name = 'xCH4',
                  pres.resid = 'pres.resid', temp.init = 20, 
                  pres.init = 101.325,
                  headspace = strawSetup, 
                  vol.hs.name = 'headspace', 
                  extrap = TRUE, 
                  unit.pres = 'kPa', pres.std = 101.325)

head(cum.prod)

# Absolute GC method (long format is the only option)

# Generate some data--two bottles with identical results
# Units for n1 and n2 are micromoles of CH4
biogas &lt;- data.frame(id = rep(c('A', 'B'), each = 5), 
                     time.d = rep(1:5, 2), 
                     n1 = rep(c(1.1, 2.4, 3.8, 5.9, 2.3), 2), 
                     n2 = rep(c(NA, NA, NA, 1.2, NA), 2))

# Bottles were vented after the measurements on day 4
biogas

# Syringe volume is 0.25 mL
# Headspace volume is 50 mL

cp &lt;- cumBg(biogas, id.name = 'id', time.name = 'time.d', 
            dat.name = 'n1', mol.f.name = 'n2', vol.syr= 0.25,
            headspace = 50, dat.type = 'gca')
cp

# Suppose the bottles had two difference headspace volumes
setup &lt;- data.frame(id = c('A', 'B'), vol.hs = c(50, 60))

cp2 &lt;- cumBg(biogas, id.name = 'id', time.name = 'time.d', 
            dat.name = 'n1', mol.f.name = 'n2', vol.syr= 0.25,
            headspace = setup, vol.hs.name = 'vol.hs', dat.type = 'gca')
cp2


# Different data structures
# Load example data
data("s3voll")
data("s3volw")
data("s3compl")
data("s3compw")
data("s3lcombo")

# wide

# Check data structure first
s3volw

s3compw

cum.prod &lt;- cumBg(s3volw, comp = s3compw, temp = 25, pres = 1,
                  time.name = 'time.d',
                  data.struct = 'wide',
                  dat.name = 'D', comp.name = 'D',
                  extrap = TRUE)

cum.prod

# longcombo
s3lcombo

cum.prod &lt;- cumBg(s3lcombo, temp = 25, pres = 1,
                  id.name = 'id', time.name = 'time.d',
                  data.struct = 'longcombo',
                  dat.name = 'vol.ml', comp.name = 'xCH4',
                  extrap = TRUE)

# Compare wide and longcombo to long (default)
s3voll
s3compl

cum.prod &lt;- cumBg(s3lcombo, comp = s3compl, temp = 25, pres = 1,
                  id.name = 'id', time.name = 'time.d',
                  dat.name = 'vol.ml', comp.name = 'xCH4',
                  extrap = TRUE)

cum.prod


</code></pre>

<hr>
<h2 id='feedSetup'>
Setup Details for Batch Reactors
</h2><span id='topic+feedSetup'></span>

<h3>Description</h3>

<p>Information on bottle id, substrates and, inoculum initial masses for 12 anaerobic bottles with animal feed ingredients for substrate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("feedSetup")</code></pre>


<h3>Format</h3>

<p>A data frame with 12 observations on the following 3 variables:
</p>

<dl>
<dt><code>id</code></dt><dd><p>identification code, a unique value for each bottle in the dataset. Numeric with all values from 1 to 12.</p>
</dd>
<dt><code>m.inoc</code></dt><dd><p>mass of inoculum added to the bottle at the start in g, a numeric vector.</p>
</dd>
<dt><code>m.sub.vs</code></dt><dd><p>mass of volatile solids (VS) of substrate added to the bottle at the start in g, a numeric vector.</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for <code><a href="#topic+summBg">summBg</a></code>.
Inoculum was digestate from a stable laboratory reactor (400 L) operated at mesophilic temperatures (38 degrees C) and a retention time of ca. 98 days
Substrates were cellulose, wheat straw (WS), and animal feed ingredients (FI).
Additinally, 1 mL each of a vitamin mixture and trace element solution was added to each BMP bottle.
</p>
<p>BMP tests were operated with a total volume of ca. 400 mL at 38 degrees C. 
</p>
<p>Data in <code>feedVol</code> and <code>feedSetup</code> are from the same bottles.
</p>


<h3>Source</h3>

<p>Data were originally collected by Soeren Weinrich and others at DBFZ in Leipzig Germany.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(feedSetup)
</code></pre>

<hr>
<h2 id='feedVol'>
Biogas Volume from Batch Reactors
</h2><span id='topic+feedVol'></span>

<h3>Description</h3>

<p>Cumulative standardized measurements of biogas volume from 12 batch bottles, organized in a &ldquo;wide&rdquo; format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("feedVol")</code></pre>


<h3>Format</h3>

<p>A data frame with 44 observations on the following 13 variables (note that all biogas volume columns, 2-13, are similar):
</p>

<dl>
<dt><code>time.d</code></dt><dd><p>elapsed time of volume measurements in days, a numeric vector.</p>
</dd>
<dt><code>1</code></dt><dd><p> cumulative standardized volume of biogas produced at time given in <code>time</code> from bottle &ldquo;1&rdquo; in mL, a numeric vector.</p>
</dd>
<dt><code>2</code></dt><dd><p> volume of biogas from bottle &ldquo;2&rdquo;.</p>
</dd>
<dt><code>3</code></dt><dd><p> volume of biogas from bottle &ldquo;3&rdquo;.</p>
</dd>
<dt><code>4</code></dt><dd><p> volume of biogas from bottle &ldquo;4&rdquo;.</p>
</dd>
<dt><code>5</code></dt><dd><p> volume of biogas from bottle &ldquo;5&rdquo;.</p>
</dd>
<dt><code>6</code></dt><dd><p> volume of biogas from bottle &ldquo;6&rdquo;.</p>
</dd>
<dt><code>7</code></dt><dd><p> volume of biogas from bottle &ldquo;7&rdquo;.</p>
</dd>
<dt><code>8</code></dt><dd><p> volume of biogas from bottle &ldquo;8&rdquo;.</p>
</dd>
<dt><code>9</code></dt><dd><p> volume of biogas from bottle &ldquo;9&rdquo;.</p>
</dd>
<dt><code>10</code></dt><dd><p>volume of biogas from bottle &ldquo;10&rdquo;.</p>
</dd>
<dt><code>11</code></dt><dd><p>volume of biogas from bottle &ldquo;11&rdquo;.</p>
</dd>
<dt><code>12</code></dt><dd><p>volume of biogas from bottle &ldquo;12&rdquo;.</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for <code><a href="#topic+calcBgVol">calcBgVol</a></code> and <code><a href="#topic+summBg">summBg</a></code>.
Inoculum was digestate from a stable laboratory reactor (400 L) operated at mesophilic temperatures (38 degrees C) and a retention time of ca. 98 days
Substrates were cellulose, wheat straw (WS), and animal feed ingredients (FI).
Additinally, 1 mL each of a vitamin mixture and trace element solution was added to each BMP bottle.
BMP tests were operated with a total volume of ca. 400 mL at 38 degrees C. 
</p>
<p>Biogas productions was measured using the online volumtric AMPTS II method.
Carbon dioxide was produced using an alkaline trap, so biogas volume is equal to methane volume.
</p>
<p>Data in <code>feedSetup</code> and <code>feedVol</code> are from the same bottles.
</p>


<h3>Source</h3>

<p>Data were originally collected by Soeren Weinrich and others at DBFZ in Leipzig Germany.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(feedVol)
</code></pre>

<hr>
<h2 id='interp'>
Interpolate Biogas Composition or Cumulative Production
</h2><span id='topic+interp'></span>

<h3>Description</h3>

<p><code>interp</code> interpolates (or extrapolates) biogas composition (methane concentration) or cumulative production data to a wanted time using one of several possible methods. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interp(times, y, time.out, method = "linear", extrap = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interp_+3A_times">times</code></td>
<td>

<p>measurement times.
Numeric vector or <code>POSIX</code>.
</p>
</td></tr>
<tr><td><code id="interp_+3A_y">y</code></td>
<td>

<p>response variable at <code>times</code>, e.g., mole fraction of methane in biogas, or biogas cumulative production.
Numeric vector.
</p>
</td></tr>
<tr><td><code id="interp_+3A_time.out">time.out</code></td>
<td>

<p>time or times at which interpolated values are needed.
Numeric vector or <code>POSIX</code>.
</p>
</td></tr>
<tr><td><code id="interp_+3A_method">method</code></td>
<td>

<p>method used for interpolation.
Default is <code>"linear"</code>, which uses the <code><a href="stats.html#topic+approx">approx</a></code> function.
Use <code>"f1"</code> for to always use nearest value to right (see <code>f = 1</code> argument in <code><a href="stats.html#topic+approx">approx</a></code>).
For spline interpolation, use <code>"ffm"</code> or the other options available (see <code><a href="stats.html#topic+spline">spline</a></code>).
</p>
</td></tr>
<tr><td><code id="interp_+3A_extrap">extrap</code></td>
<td>

<p>should <code>y</code> be exptrapolated?
Logical. Default is <code>FALSE</code>. 
See &lsquo;Details&rsquo;.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>interp</code> is really a wrapper for the interpolation functions <code><a href="stats.html#topic+approx">approx</a></code> and <code><a href="stats.html#topic+spline">spline</a></code>.
For cumulative production, which (usually) must monotonically increase, <code>method = "hyman"</code> is the best choice.
Extrapolation behavior depends on <code>method</code>.
For <code>method = "linear"</code>, <code>extrap = TRUE</code> simply returns the value of the closest <code>y</code>.
For manometric measurement with mix of venting/no venting with composition measurements only when venting use <code>method = "f1"</code>.
See <code><a href="stats.html#topic+approx">approx</a></code> and <code><a href="stats.html#topic+spline">spline</a></code> for more information.
</p>


<h3>Value</h3>

<p>Interpolated estimates of <code>y</code> at given <code>times</code>.
</p>


<h3>Author(s)</h3>

<p>Sasha D. Hafner and Charlotte Rennuit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cumBg">cumBg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Fake composition data 
dat &lt;- data.frame(time = c(1, 7, 14, 28), 
                  xCH4 = c(0.3, 0.5, 0.61, 0.65))
interp(dat$time, dat$xCH4, time.out = 10)
interp(dat$time, dat$xCH4, time.out = 10, method = "natural")
interp(dat$time, dat$xCH4, time.out = c(10, 30))
interp(dat$time, dat$xCH4, time.out = c(10, 30), method = "natural")
interp(dat$time, dat$xCH4, time.out = c(10, 30), extrap = TRUE)

# Actual data
data(comp)
# Work with one reactor
bgc &lt;- subset(comp, id=="2_1")

# With numeric time, interpolate to 1, 7, and 30 days
interp(bgc$days, bgc$xCH4, time.out = c(1, 7, 30))

# If extrapolation is OK
interp(bgc$days, bgc$xCH4, time.out = c(1, 7, 30), extrap = TRUE)

# Or POSIXct
interp(bgc$date.time, bgc$xCH4, 
       time.out = as.POSIXct("2014-07-12 13:00:00"))

# For cumulative gas production
data(vol)
# Work with one reactor
bgv &lt;- subset(vol, id=="2_1")
# Calculate cumulative volume
bgv &lt;- cumBg(bgv, time.name = "days")
# The interpolate of cumulative production to 1, 7, and 30 days
interp(bgv$days, bgv$cvBg, time.out = c(1, 7, 30), method = "hyman")
</code></pre>

<hr>
<h2 id='mass'>
Mass Change of Batch Reactors
</h2><span id='topic+mass'></span>

<h3>Description</h3>

<p>Mass measurements for 9 batch anaerobic reactors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("mass")</code></pre>


<h3>Format</h3>

<p>A data frame with 18 observations on the following 4 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>identification code, a unique value for each reactor in the dataset. A factor with levels <code>2_1</code>, <code>2_2</code>, <code>2_3</code>, <code>2_4</code>, <code>2_5</code>, <code>2_6</code>, <code>2_10</code>, <code>2_11</code>, and <code>2_12</code> </p>
</dd>
<dt><code>date.time</code></dt><dd><p>date and time of mass measurement, a POSIXct object.</p>
</dd>
<dt><code>days</code></dt><dd><p>elapsed time of mass measurements (from reactor setup) in days, a numeric vector.</p>
</dd>
<dt><code>mass</code></dt><dd><p>total reactor mass in g, a numeric vector.</p>
</dd>
<dt><code>when</code></dt><dd><p>when was measurement taken? A character vector with two values.</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for <code><a href="#topic+mass2vol">mass2vol</a></code>, for gravimetric determination of biogas production.
Reactors were 500 mL glass serum bottles with butyl rubber septa and screw caps. 
Masses were measured with an electronic balance to 100 mg.
Data in <code>vol</code>, <code>mass</code>, <code>massw</code>, <code>comp</code>, and <code>setup</code> are from the same reactors.
</p>


<h3>Source</h3>

<p>Measurements by Charlotte Rennuit and Sasha Hafner.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mass)
</code></pre>

<hr>
<h2 id='mass2vol'>
Calculate Biogas Production Gravimetrically
</h2><span id='topic+mass2vol'></span>

<h3>Description</h3>

<p><code>mass2vol</code> calculates biogas volume based on measured reactor mass loss.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mass2vol(mass, xCH4, temp, pres, 
  temp.std = getOption('temp.std', as.numeric(NA)), 
  pres.std = getOption('pres.std', as.numeric(NA)), 
  unit.temp = getOption('unit.temp', 'C'), 
  unit.pres = getOption('unit.pres', 'atm'), 
  value = "CH4", headspace = NULL, headcomp = 'N2', 
  temp.init = NULL, std.message = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mass2vol_+3A_mass">mass</code></td>
<td>

<p>reactor mass loss in g. A numeric vector.
</p>
</td></tr>
<tr><td><code id="mass2vol_+3A_xch4">xCH4</code></td>
<td>

<p>biogas mole fraction of methane. Must be normalised so xCH4 + xCO2 = 1.0. A numeric vector.
</p>
</td></tr>
<tr><td><code id="mass2vol_+3A_temp">temp</code></td>
<td>

<p>the temperature of biogas as it exited the reactor. A length-one numeric vector.
Degrees Celcius by default (see <code>unit.temp</code> argument).
</p>
</td></tr>
<tr><td><code id="mass2vol_+3A_pres">pres</code></td>
<td>

<p>the pressure of biogas as it exited the reactor. A length-one numeric vector.
Atmospheres (atm) by default (see <code>unit.pres</code> argument).
</p>
</td></tr>
<tr><td><code id="mass2vol_+3A_temp.std">temp.std</code></td>
<td>

<p>standard temperature for presentation of biogas and methane results.
Default value is 0 degrees C.
Argument is passed to <code><a href="#topic+stdVol">stdVol</a></code>.
Length one numeric vector.
</p>
</td></tr>
<tr><td><code id="mass2vol_+3A_pres.std">pres.std</code></td>
<td>

<p>standard pressure for presentation of biogas and methane results.
Default value is 1.0 atm.
Argument is passed to <code><a href="#topic+stdVol">stdVol</a></code>.
Length one numeric vector.
</p>
</td></tr>
<tr><td><code id="mass2vol_+3A_unit.temp">unit.temp</code></td>
<td>

<p>temperature units for <code>temp</code> and <code>temp.std</code> arguments.
Default is <code>"C"</code>.
Argument is passed to <code><a href="#topic+stdVol">stdVol</a></code>.
</p>
</td></tr>
<tr><td><code id="mass2vol_+3A_unit.pres">unit.pres</code></td>
<td>

<p>pressure units for <code>pres</code> and <code>pres.std</code> arguments.
Default is <code>"atm"</code>.
Argument is passed to <code><a href="#topic+stdVol">stdVol</a></code>.
</p>
</td></tr>
<tr><td><code id="mass2vol_+3A_value">value</code></td>
<td>

<p>what should be returned?
Default is <code>"CH4"</code>, which returns methane volume in mL.
<code>"all"</code> returns biogas, methane, and carbon dioxide volumes.
</p>
</td></tr>
<tr><td><code id="mass2vol_+3A_headspace">headspace</code></td>
<td>

<p>(optional) reactor headspace volume in mL. 
Used to correct for effect of initial reactor headspace on mass loss.
A numeric vector.
</p>
</td></tr>
<tr><td><code id="mass2vol_+3A_headcomp">headcomp</code></td>
<td>

<p>(optional) composition of the initial reactor headspace.
Only required if <code>headspace</code> argument is specified.
Used to correct for effect of initial reactor headspace on mass loss.
Currently, the only option is <code>"N2"</code> for dinitrogen gas.
Use of any other value will be ignored with a warning.
</p>
</td></tr>
<tr><td><code id="mass2vol_+3A_temp.init">temp.init</code></td>
<td>

<p>(optional) initial headspace temperature in unit.temp units.
Used to correct for effect of initial reactor headspace on mass loss.
</p>
</td></tr>
<tr><td><code id="mass2vol_+3A_std.message">std.message</code></td>
<td>
<p>should a message with the standard conditions be displayed? 
Default is TRUE. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses the method described in Hafner et al. (2015) to calculate biogas production from reactor mass loss.
It is essential that the only change in reactor mass is due to biogas removal!
Users are advised to read the original reference before applying the method.
This function is vectorized.
Instead of using this function directly when working with multiple measurements on multiple reactors, use the <code><a href="#topic+cumBg">cumBg</a></code> function (which can call up <code>mass2vol</code>). 
</p>
<p>Standard values and units of temperature and pressure can be globally set using the function <code><a href="base.html#topic+options">options</a></code>.
</p>


<h3>Value</h3>

<p>volume of methane in mL as a numeric vector (if <code>value = "CH4"</code>) or a matrix with columns for biogas, methane, and carbon dioxide volumes in mL.
</p>
<table>
<tr><td><code>vBg</code></td>
<td>
<p>standardised volume of biogas in mL</p>
</td></tr>
<tr><td><code>vCH4</code></td>
<td>
<p>standardised volume of methane in mL</p>
</td></tr> 
<tr><td><code>vCH4</code></td>
<td>
<p>standardised volume of carbon dioxyde in mL</p>
</td></tr> 
</table>
<p>All volumes are standardised using <code>pres.std</code> and <code>temp.std</code> arguments (see <code><a href="#topic+stdVol">stdVol</a></code>).
</p>


<h3>Author(s)</h3>

<p>Sasha D. Hafner and Charlotte Rennuit
</p>


<h3>References</h3>

<p>Hafner, S.D., Rennuit, C., Triolo, J.M., Richards, B.K. 2015. Validation of a simple gravimetric method for measuring biogas production in laboratory experiments. <em>Biomass and Bioenergy</em> <b>83</b>, 297-301.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vol2mass">vol2mass</a></code>,
<code><a href="#topic+stdVol">stdVol</a></code>,
<code><a href="#topic+cumBg">cumBg</a></code>,
<code><a href="base.html#topic+options">options</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Volume of methane if measured mass loss was 3.1 g
  mass2vol(3.1, xCH4 = 0.65, temp = 35, pres = 1)

  # More details
  mass2vol(3.1, xCH4 = 0.65, temp = 35, pres = 1, value = "all")
  
  # Vectorized
  data("massw")
  massw$massloss &lt;- massw$start - massw$end
  massw$vCH4 &lt;- mass2vol(massw$massloss, xCH4 = 0.65, temp = 35, 
                         pres = 1)
  massw
  
</code></pre>

<hr>
<h2 id='massw'>
Mass Change of Batch Reactors
</h2><span id='topic+massw'></span>

<h3>Description</h3>

<p>Mass measurements for 9 batch anaerobic reactors in a &ldquo;wide&rdquo; format (separate columns for initial and final mass).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("massw")</code></pre>


<h3>Format</h3>

<p>A data frame with 9 observations on the following 3 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>identification code, a unique value for each reactor in the dataset. A factor with levels <code>2_1</code>, <code>2_2</code>, <code>2_3</code>, <code>2_4</code>, <code>2_5</code>, <code>2_6</code>, <code>2_10</code>, <code>2_11</code>, and <code>2_12</code> </p>
</dd>
<dt><code>start</code></dt><dd><p>total reactor mass at the start of its incubation in g, a numeric vector.</p>
</dd>
<dt><code>end</code></dt><dd><p>total reactor mass at the end of its incubation in g, a numeric vector.</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for application of <code><a href="#topic+mass2vol">mass2vol</a></code>, for gravimetric determination of biogas production.
Reactors were 500 mL glass serum bottles with butyl rubber septa and screw caps. 
Masses were measured with an electronic balance to 100 mg.
These are the same data as in <code>mass</code>, but simply in a &ldquo;wide&rdquo; format.
Data in <code>vol</code>, <code>mass</code>, <code>massw</code>, <code>comp</code>, and <code>setup</code> are from the same reactors.
</p>


<h3>Source</h3>

<p>Measurements by Charlotte Rennuit and Sasha Hafner.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(massw)
</code></pre>

<hr>
<h2 id='molMass'>
Calculate Molar Mass of Compound
</h2><span id='topic+molMass'></span>

<h3>Description</h3>

<p><code>molMass</code> calculates the molar mass of any organic compound (and some salts) based on its chemical formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>molMass(form)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="molMass_+3A_form">form</code></td>
<td>
<p>a chemical formula, as a character vector, e.g., <code>"C6H12O6"</code> for glucose or <code>"CH3COOH"</code> for acetic acid, or <code>c("C6H12O6", "CH3COOH")</code> for both at once. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Standard atomic weights are from CIAAW, and were rounded to three or more digits (with the exception of Li) depending on the range of the reported interval for &ldquo;normal materials&rdquo;.
In general <code>form</code> should follow capitalization rules for elements (i.e., first letter capitalized, second lower-case). 
However, if <code>form</code> contains single-letter elements only, it is possible to use lower-case letters for all elements (but for clarity this is not recommended).
The function is vectorized.
</p>


<h3>Value</h3>

<p>Numeric vector with length equal to length of <code>form</code> with molar mass (g/mol)
</p>


<h3>Author(s)</h3>

<p>Charlotte Rennuit and Sasha D. Hafner
</p>


<h3>References</h3>

<p>CIAAW &lt;http://www.ciaaw.org/atomic-weights.htm&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calcCOD">calcCOD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  molMass("C6H12O6")

  molMass("CH3COOH")

  molMass("CH3CH2OH")

  molMass("CH4")

  molMass("ch4")

  molMass(c("C6H12O6", "CH3COOH", "CH3CH2OH"))

  # Case-sentitive for two letter elements
  molMass("NaHCO3")

  # Complex formulas OK
  molMass("H3C(CH2)5COOH")

  molMass("(C6H12O6)0.24999 (H3COOH)0.75001")

  # Database is quite complete 
  molMass('CdSiO3')

  # Use care for, e.g., hydrates
  molMass('FeSO4(H2O)7')

</code></pre>

<hr>
<h2 id='planBMP'>
Claculate Inoculum and Substrate Mass for BMP Experiments 
</h2><span id='topic+planBMP'></span>

<h3>Description</h3>

<p><code>planBMP</code> assists in the design of BMP experiments. 
It can be used to determine inoculum and substrate masses based on inoculum-to-substrate ratio and volatile solids concentrations, or to calculate inoculum-to-substrate ratio based on masses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>planBMP(vs.inoc, vs.sub, isr = NA, m.inoc = NA, m.sub = NA, 
        m.tot = NA, m.vs.sub = vs.sub * m.sub, digits = 3, warn = TRUE,
        nice = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="planBMP_+3A_vs.inoc">vs.inoc</code></td>
<td>

<p>volatile solids (VS) concentration of inoculum (g/g = g VS per g inoculum).
Required.
Numeric vector.
</p>
</td></tr>
<tr><td><code id="planBMP_+3A_vs.sub">vs.sub</code></td>
<td>

<p>volatile solids (VS) concentration of substrate (g/g = g VS per g substrate).
Required.
Numeric vector.
</p>
</td></tr>
<tr><td><code id="planBMP_+3A_isr">isr</code></td>
<td>

<p>inoculum-to-substrate ratio, VS mass basis.
Optional.
Numeric vector.
</p>
</td></tr>
<tr><td><code id="planBMP_+3A_m.inoc">m.inoc</code></td>
<td>

<p>total mass of inoculum (g).
Optional.
Numeric vector.
</p>
</td></tr>
<tr><td><code id="planBMP_+3A_m.sub">m.sub</code></td>
<td>

<p>total mass of substrate (g).
Optional.
Numeric vector.
</p>
</td></tr>
<tr><td><code id="planBMP_+3A_m.tot">m.tot</code></td>
<td>

<p>total mass of mixture (inoculum plus substrate) (g).
Optional.
Numeric vector.
</p>
</td></tr>
<tr><td><code id="planBMP_+3A_m.vs.sub">m.vs.sub</code></td>
<td>

<p>VS mass of substrate (g).
Optional.
Numeric vector.
</p>
</td></tr>
<tr><td><code id="planBMP_+3A_digits">digits</code></td>
<td>

<p>number of significant digits to display in output.
Default of 3.
Integer vector with length 1.
</p>
</td></tr>
<tr><td><code id="planBMP_+3A_warn">warn</code></td>
<td>

<p>control whether warnings are displayed.
Default of TRUE.
Logical vector with length 1.
</p>
</td></tr>
<tr><td><code id="planBMP_+3A_nice">nice</code></td>
<td>

<p>control whether output is formatted to look nice and make reading easier.
Default of TRUE.
Only applied for non-vectorized (length 1) calls.
Logical vector with length 1.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BMP experiments should be designed giving consideration to the inoculum-to-substrate ratio (ISR), the substrate VS mass, and the mixture VS concentration. 
This function calculates inoculum and substrate masses based on VS concentrations and ISR, along with either total mixture mass or substrate VS mass.
Alternatively, it can be used to calculate ISR if the masses have been selected.
Warnings are based on the guidelines of Holliger et al. (2016).
</p>


<h3>Value</h3>

<p>A named numeric vector, or (if any of the first 7 input arguments have a length &gt; 1, i.e., a vectorized call), a data frame.
Names and interpretation are identical to the first 7 input arguments, and also include:
</p>
<table>
<tr><td><code>vs.mix</code></td>
<td>
<p>VS concentration in mixture (g/g)</p>
</td></tr>
<tr><td><code>m.vs.tot</code></td>
<td>
<p>total VS mass in mixture (g)</p>
</td></tr>
</table>
<p>For non-vectorized calls, the results is returned invisibly and a easy-to-read summary is printed (see <code>nice</code> argument).
</p>


<h3>Note</h3>

<p>Calculations used in this function are trivial, and they could also be done with a spreadsheet or even pencil and paper.
The advantage here is ease and some flexibility. 
In addition to ISR and the other parameters included in this function, expected biogas production rate and bottle headspace volume are important, depending on the method.
For more details, see Holliger et al. (2016).
</p>


<h3>Author(s)</h3>

<p>Sasha D. Hafner, based on suggestion by Konrad Koch
</p>


<h3>References</h3>

<p>Holliger, C., Alves, M., Andrade, D., Angelidaki, I., Astals, S., Baier, U., Bougrier, C., Buffiere, P., Carbella, M., de Wilde, V., Ebertseder, F., Fernandez, B., Ficara, E., Fotidis, I., Frigon, J.-C., Fruteau de Laclos, H., S. M. Ghasimi, D., Hack, G., Hartel, M., Heerenklage, J., Sarvari Horvath, I., Jenicek, P., Koch, K., Krautwald, J., Lizasoain, J., Liu, J., Mosberger, L., Nistor, M., Oechsner, H., Oliveira, J.V., Paterson, M., Pauss, A., Pommier, S., Porqueddu, I., Raposo, F., Ribeiro, T., Rusch Pfund, F., Stromberg, S., Torrijos, M., van Eekert, M., van Lier, J., Wedwitschka, H., Wierinck, I., 2016. Towards a standardization of biomethane potential tests. <em>Water Science and Technology</em> <b>74</b>, 2515-2522.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calcBgVol">calcBgVol</a></code>,
<code><a href="#topic+calcBgMan">calcBgMan</a></code>,
<code><a href="#topic+calcBgGD">calcBgGD</a></code>,
<code><a href="#topic+cumBg">cumBg</a></code>,
<code><a href="#topic+summBg">summBg</a></code>,
<code><a href="#topic+predBg">predBg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  # Bottles are 500 mL, substrate is wastewater sludge.
  # Assume we want no more than 250 mL reacting volume (~250 g)
  # First try setting ISR and total mass.
  # VS concentrations: 0.02 g/g in inoculum, 0.07 g/g for substrate, ISR = 2.
  planBMP(vs.inoc = 0.02, vs.sub = 0.07, isr = 2, m.tot = 250)
  # Get 31 g substrate, 220 g inoculum.
  
  # After setup, we can check final values.
  planBMP(vs.inoc = 0.018, vs.sub = 0.072, m.sub = 32, m.inoc = 218)
  # We didn't quite meet our target in this case--next time use more inoculum to be sure
  
  # We can alternatively specify substrate VS mass
  planBMP(vs.inoc = 0.02, vs.sub = 0.07, isr = 2, m.vs.sub = 2)
  
  # Some options
  planBMP(vs.inoc = 0.02, vs.sub = 0.07, isr = 2, m.vs.sub = 2, nice = FALSE)
  # Perhaps we want to use three different ISRs
  planBMP(vs.inoc = 0.02, vs.sub = 0.07, isr = 2:4, m.vs.sub = 2, nice = FALSE)
</code></pre>

<hr>
<h2 id='predBg'>
Predict Biogas Production
</h2><span id='topic+predBg'></span>

<h3>Description</h3>

<p><code>predBg</code> predicts biogas and methane production based on composition and other, optional, details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predBg(form = NULL, mass = 1, mol = NULL, fs = 0, fd = 1, 
       mcomp = NULL, COD = NULL, conc.sub = NULL, pH = NULL, 
       temp = NULL, mu = 0.1, shortform = NULL, value = "CH4")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predBg_+3A_form">form</code></td>
<td>

<p>(optional) a chemical formula for the substrate, as a character vector of length one, e.g., <code>"C6H12O6"</code> for glucose or <code>"CH3COOH"</code> for acetic acid.
</p>
</td></tr>
<tr><td><code id="predBg_+3A_mass">mass</code></td>
<td>

<p>mass of substrate present, in g.
A numeric vector.
</p>
</td></tr>
<tr><td><code id="predBg_+3A_mol">mol</code></td>
<td>

<p>(optional) moles of substrate present.
A numeric vector.
</p>
</td></tr>
<tr><td><code id="predBg_+3A_fs">fs</code></td>
<td>

<p>fraction of substrate used for microbial biomass production (<code>0&lt;=fs&lt;=1</code>).
See &quot;Details&quot;.
A numeric vector.
</p>
</td></tr>
<tr><td><code id="predBg_+3A_fd">fd</code></td>
<td>

<p>fraction of substrate that is degradable (<code>0&lt;=fd&lt;=1</code>).
See &quot;Details&quot;.
A numeric vector.
</p>
</td></tr>
<tr><td><code id="predBg_+3A_mcomp">mcomp</code></td>
<td>

<p>(optional) &ldquo;macromolecule&rdquo;-based composition of the substrate.
A named numeric vector with relative masses of macromolecular groups or any chemical. 
Options for macromolecular groups include: <code>VFA</code> (volatile fatty acids, VFAs), <code>protein</code>, <code>carbohydrate</code>, <code>lipid</code>, and <code>lignin</code>.
An empirical <code>form</code> will be calculated from fixed chemical formulas.
To see the available options, use <code>biogas:::std.forms</code>.
</p>
</td></tr>
<tr><td><code id="predBg_+3A_cod">COD</code></td>
<td>

<p>(optional) chemical oxygen demand (COD) of the substrate (g oxygen).
If provided, <code>mass</code> will be ignored.
A numeric vector. 
</p>
</td></tr>
<tr><td><code id="predBg_+3A_conc.sub">conc.sub</code></td>
<td>

<p>(optional) concentration of the substrate relative to water, as g substrate per kg water.
Used only for carbon dioxide partitioning.
A numeric vector.
</p>
</td></tr>
<tr><td><code id="predBg_+3A_ph">pH</code></td>
<td>

<p>(optional) pH of the solution.
Used only for carbon dioxide partitioning.
A numeric vector.
</p>
</td></tr>
<tr><td><code id="predBg_+3A_temp">temp</code></td>
<td>

<p>(optional) temperature of the system in degrees C.
Used only for carbon dioxide partitioning.
A numeric vector.
</p>
</td></tr>
<tr><td><code id="predBg_+3A_mu">mu</code></td>
<td>

<p>(optional) ionic strength of the solution.
Used only for carbon dioxide partitioning.
A numeric vector.
</p>
</td></tr>
<tr><td><code id="predBg_+3A_shortform">shortform</code></td>
<td>

<p>should formula from <code>form</code> or <code>mcomp</code> arguments be shortened?
Default is <code>FALSE</code> if <code>form</code> is used, <code>TRUE</code> if <code>mcomp</code> is used.
</p>
</td></tr>
<tr><td><code id="predBg_+3A_value">value</code></td>
<td>

<p>what should be returned?
Four options are currently available.
<code>"CH4"</code> (default) returns standardised methane volume only.
<code>"all"</code> returns all available additional results.
<code>"reactionn"</code> returns a numeric reaction (names are chemical species).
<code>"reactionc"</code> returns a text reaction.
Length-one character vector.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>predBg</code> is a flexible function that returns different details depending on the data provided. 
Calculations can be based on <code>form</code>, <code>COD</code>, or <code>mcomp</code> (at least one of these is required).
See &lsquo;Examples&rsquo; for more information.
</p>
<p>In its simplest usage, <code>predBg</code> calculates theoretical biochemical methane potential (theoretical BMP).

With more parameters, it can also predict carbon dioxide partitioning, total biogas production and composition, as well as microbial biomass production and nitrogen requirement.
Stoichiometry is based on Eq. 13.5 in Rittmann and McCarty (2001).
Partitioning of carbon dioxide is based on an equilibrium speciation model using temperature-dependent parameters (Henry's law constant and dissociation constants) based on Hafner et al. (2012).
<code>predBg</code> is vectorized for all arguments except <code>mcomp</code>, and will recycle argument elements as needed.
</p>


<h3>Value</h3>

<p>Standardised volume (at 0 degrees C and 1 atmosphere) of methane produced in mL (for <code>value = "CH4"</code>), or a data frame with some of these columns (depending on provided arguments):
</p>
<table>
<tr><td><code>form</code></td>
<td>
<p>empirical chemical formula of substrate, typically from the input argument</p>
</td></tr>
<tr><td><code>mass</code></td>
<td>
<p>substrate mass in g, typically from the input argument</p>
</td></tr>
<tr><td><code>mol.mass</code></td>
<td>
<p>substrate molar mass in g/mol</p>
</td></tr>
<tr><td><code>moles</code></td>
<td>
<p>moles of subtrate</p>
</td></tr>
<tr><td><code>COD</code></td>
<td>
<p>total calculated oxygen demand (COD') based on <code>form</code> (or echoed chemical oxygen demand (COD)) of substrate in g oxygen</p>
</td></tr>
<tr><td><code>fs</code></td>
<td>
<p><code>fs</code> argument echoed</p>
</td></tr>
<tr><td><code>fe</code></td>
<td>
<p>Rittmann and McCarty's fe (<code>fe = 1 - fs</code>)</p>
</td></tr>
<tr><td><code>fd</code></td>
<td>
<p><code>fd</code> argument echoed</p>
</td></tr>
<tr><td><code>conc.sub</code></td>
<td>
<p><code>conc.sub</code> argument echoed</p>
</td></tr>
<tr><td><code>temp</code></td>
<td>
<p><code>temp</code> argument echoed</p>
</td></tr>
<tr><td><code>pH</code></td>
<td>
<p><code>pH</code> argument echoed</p>
</td></tr>
<tr><td><code>hydro</code></td>
<td>
<p>hydrolytic water consumption (g water)</p>
</td></tr>
<tr><td><code>fCH4</code></td>
<td>
<p>moles methane producted divided by the sum of methane and carbon dioxide moles. Equal to <code>xCH4</code> in biogas if carbon dioxide (and related aqueous species) in solution are negligible</p>
</td></tr>
<tr><td><code>xCH4</code></td>
<td>
<p>mole fraction of methane in dry biogas</p>
</td></tr>
<tr><td><code>vCH4</code></td>
<td>
<p>standardised volume (dry, 0 degrees C, 1.0 atm) of methane produced in mL</p>
</td></tr>
<tr><td><code>mCH4</code></td>
<td>
<p>mass of methane produced in g</p>
</td></tr>
<tr><td><code>mCO2</code></td>
<td>
<p>mass of carbon dioxide produced in g (including both biogas and inorganic carbon in solution)</p>
</td></tr>
<tr><td><code>mCO2Bg</code></td>
<td>
<p>mass of carbon dioxide in biogas in g</p>
</td></tr>
<tr><td><code>mCO2.sol</code></td>
<td>
<p>mass of inorganic carbon in solution in g</p>
</td></tr>
<tr><td><code>cTIC</code></td>
<td>
<p>concentration of inorganic carbon in solution in mol/kg (per kg water)</p>
</td></tr>
<tr><td><code>m.bio</code></td>
<td>
<p>mass of microbial biomass produced, VS only, in g</p>
</td></tr>
<tr><td><code>N.req</code></td>
<td>
<p>nitrogen required for production of required microbial biomass in g of N. Negative value indicates mineralization</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Predictions will only be as good as the parameter values provided, and maybe not even that good.
<code>fs</code> should be interpreted as $f_s$ in Ritttmann and McCarty (2001), i.e., the effective value after decay of microbial biomass, and not $f_s^0$.
The original reference (Section 2.3 and Eq. (3.33) in Rittmann and McCarty (2001)) and the <code>predBg</code> vignette provide more details.
Partitioning of carbon dioxide is based on equilibrium between all biogas produced and the solution, and represents a continuous reactor running at steady-state.
</p>


<h3>Author(s)</h3>

<p>Sasha D. Hafner and Charlotte Rennuit
</p>


<h3>References</h3>

<p>Hafner, S.D. 2007 <em>Ammonia Speciation in Anaerobic Digesters</em>. PhD dissertation, Cornell University.
</p>
<p>Hafner, S.D., Montes, F., Rotz, C.A. 2012 The role of carbon dioxide in emission of ammonia from manure. <em>Atmospheric Environment</em> <b>66</b>, 63-71.
</p>
<p>Moller, H.B., Sommer, S.G., Ahring, B.K. 2004 Methane productivity of manure, straw and solid fractions of manure. <em>Biomass and Bioenergy</em> <b>26</b>, 485-495.  
</p>
<p>Rittmann, B., McCarty, P. 2001 <em>Environmental Biotechnology</em>. McGraw-Hill.
</p>
<p>Triolo, J.M., Sommer, S.G., Moller, H.B., Weisbjerg, M.R., Jiang, X.Y. 2011 A new algorithm to characterize biodegradability of biomass during anaerobic digestion: Influence of lignin concentration on methane production potential. <em>Bioresource Technology</em> <b>102</b>, 9395-9402.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calcCOD">calcCOD</a></code>,
<code><a href="#topic+molMass">molMass</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # BMP of cellulose in mL CH4/g
  predBg("C6H10O5")

  # How much is produced in a real reactor? Assume 10% goes to 
  # biomass production
  predBg("C6H10O5", fs = 0.1)

  # And substrate is 80% degradable
  predBg("C6H10O5", fs = 0.1, fd = 0.8)

  # More detailed results
  predBg("C6H10O5", value = "all")

  # Given a substrate with a COD of 1.4 g
  predBg(COD = 1.4)

  # But CH4 production is reduced if substrate is 80% degradable 
  # and 10% goes to cell synthesis
  predBg(COD = 1.4, fd = 0.8, fs = 0.1)

  # Can use macromolecule composition, e.g., for pig manure
  predBg(mcomp = c(vfa = 0.2, protein = 0.25, carbohydrate = 0.32, 
                   lipid = 0.15, lignin = 0.08), 
         value = "all")

  # Function expects sum(mcomp) == 1 but this is not required
  # But unless mass is set, mass is taken as sum(mcomp)
  predBg(mcomp = c(vfa = 20, protein = 25, carbohydrate = 32, 
                   lipid = 15, lignin = 8), 
         value = "all")

  # Specify mass if this is not the case
  predBg(mcomp = c(vfa = 20, protein = 25, carbohydrate = 32, 
                   lipid = 15, lignin = 8), 
         mass = 1, value = "all")

  # Can mix formulas and macromolecular groups in mcomp
  predBg(mcomp = c(C6H12O6 = 0.5, protein = 0.5))

  # For CO2 partitioning, must provide conc.sub, pH, and temp 
  # cattle manure example from Hafner (2007)
  predBg("C13H20O11N", mass = 1, fs = 0.1, fd = 0.56, 
         conc.sub = 85, pH = 7.7, temp = 35, value = "all")

  # Or, mix of waste paper and waste vegetable oil from vignette
  predBg(mcomp = c(C6H10O5 = 5/6, C54H100O7 = 1/6), mass = 1, 
	 fd = 0.8, fs = 0.1, conc.sub = 50, pH = 7.5, temp = 35, 
	 value = "all")

  # Note that form can also be used for mixtures, but here it is 
  # molar ratios that are specified
  predBg('(C6H10O5)5(C54H100O7)1)', mass = 1, 
	 fd = 0.8, fs = 0.1, conc.sub = 50, pH = 7.5, temp = 35, 
	 value = "all")
  
  # Function is vectorized for everything except mcomp, e.g., 
  # fs
  predBg("C6H10O5", fs = c(0, 0.05, 0.1), value = "all")

  # form
  predBg(c("C6H10O5", "C10H19O3N", "CH3CH2OH"), value = "all")
  
  # pH
  predBg("C13H20O11N", conc.sub = 85, fs = 0.1, fd = 0.56, 
         pH = 7+0:10/10, temp = 35, value = "all")
</code></pre>

<hr>
<h2 id='s3compl'>
Methane Content of Biogas from Batch Reactors
</h2><span id='topic+s3compl'></span>

<h3>Description</h3>

<p>Methane content (biogas composition) measurements from three batch bottles, organized in a &ldquo;long&rdquo; format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("s3compl")</code></pre>


<h3>Format</h3>

<p>A data frame with 14 observations on the following 3 variables:
</p>

<dl>
<dt><code>id</code></dt><dd><p>identification code, a unique value for each bottle in the dataset. </p>
</dd>
<dt><code>time.d</code></dt><dd><p>elapsed time of mass measurements (from bottle setup) in days, a numeric vector.</p>
</dd>
<dt><code>xCH4</code></dt><dd><p>biogas methane content as a mole fraction, excluding water and all other gases other than carbon dioxide, a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for <code><a href="#topic+cumBg">cumBg</a></code>.
Reactors were 300 mL glass serum bottles with butyl rubber septa and screw caps. 
Substrate was municipal wastewater sludge.
Methane and carbon dioxide contents were determined by gas chromatography using a thermal conductivity detector and normalised so methane and carbon dioxide sum to 1.0.
Data in <code>s3voll</code>, <code>s3compl</code>, <code>s3volw</code>, <code>s3compw</code>, and <code>s3lcombo</code> are from the same bottles.
</p>


<h3>Source</h3>

<p>Sasha D. Hafner. Measurements by Johanna Maria Pedersen.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(s3compl)
</code></pre>

<hr>
<h2 id='s3compw'>
Methane Content of Biogas from Batch Reactors
</h2><span id='topic+s3compw'></span>

<h3>Description</h3>

<p>Methane content (biogas composition) measurements from three batch bottles, organized in a &ldquo;wide&rdquo; format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("vol")</code></pre>


<h3>Format</h3>

<p>A data frame with 5 observations on the following 4 variables:
</p>

<dl>
<dt><code>time.d</code></dt><dd><p>elapsed time of mass measurements (from bottle setup) in days, a numeric vector.</p>
</dd>
<dt><code>D</code></dt><dd><p>biogas methane content at <code>time</code> from bottle &ldquo;D&rdquo; as mole fraction, a numeric vector.</p>
</dd>
<dt><code>E</code></dt><dd><p>biogas methane content at <code>time</code> from bottle &ldquo;E&rdquo; as mole fraction, a numeric vector.</p>
</dd>
<dt><code>F</code></dt><dd><p>biogas methane content at <code>time</code> from bottle &ldquo;F&rdquo; as mole fraction, a numeric vector.</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for <code><a href="#topic+cumBg">cumBg</a></code>.
Reactors were 300 mL glass serum bottles with butyl rubber septa and screw caps. 
Substrate was municipal wastewater sludge.
Methane and carbon dioxide contents were determined by gas chromatography using a thermal conductivity detector and normalised so methane and carbon dioxide sum to 1.0.
Data in <code>s3voll</code>, <code>s3compl</code>, <code>s3volw</code>, <code>s3compw</code>, and <code>s3lcombo</code> are from the same bottles.
</p>


<h3>Source</h3>

<p>Sasha D. Hafner. Measurements by Johanna Maria Pedersen.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(s3compw)
</code></pre>

<hr>
<h2 id='s3lcombo'>
Biogas Volume and Methane Content from Batch Bottles
</h2><span id='topic+s3lcombo'></span>

<h3>Description</h3>

<p>Biogas volume and methane content measurements from three batch bottles, organized in a &ldquo;long&rdquo; format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("s3lcombo")</code></pre>


<h3>Format</h3>

<p>A data frame with 21 observations on the following 4 variables:
</p>

<dl>
<dt><code>id</code></dt><dd><p>identification code, a unique value for each bottle in the dataset. </p>
</dd>
<dt><code>time.d</code></dt><dd><p>elapsed time of mass measurements (from bottle setup) in days, a numeric vector.</p>
</dd>
<dt><code>vol.ml</code></dt><dd><p>volume of biogas removed at <code>time</code> in mL, a numeric vector.</p>
</dd>
<dt><code>xCH4</code></dt><dd><p>biogas methane content as a mole fraction, excluding water and all other gases other than carbon dioxide, a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for <code><a href="#topic+cumBg">cumBg</a></code>.
Reactors were 300 mL glass serum bottles with butyl rubber septa and screw caps. 
Substrate was municipal wastewater sludge.
Volume was measured using syringes.
Methane and carbon dioxide contents were determined by gas chromatography using a thermal conductivity detector and normalised so methane and carbon dioxide sum to 1.0.
Data in <code>s3voll</code>, <code>s3compl</code>, <code>s3volw</code>, <code>s3compw</code>, and <code>s3lcombo</code> are from the same bottles.
</p>


<h3>Source</h3>

<p>Sasha D. Hafner. Measurements by Johanna Maria Pedersen.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(s3lcombo)
</code></pre>

<hr>
<h2 id='s3voll'>
Biogas Volume from Batch Bottles
</h2><span id='topic+s3voll'></span>

<h3>Description</h3>

<p>Biogas volume measurements from three batch bottles, organized in a &ldquo;long&rdquo; format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("s3voll")</code></pre>


<h3>Format</h3>

<p>A data frame with 21 observations on the following 4 variables:
</p>

<dl>
<dt><code>id</code></dt><dd><p>identification code, a unique value for each bottle in the dataset. </p>
</dd>
<dt><code>time.d</code></dt><dd><p>elapsed time of mass measurements (from bottle setup) in days, a numeric vector.</p>
</dd>
<dt><code>vol.ml</code></dt><dd><p>volume of biogas removed at <code>time</code> in mL, a numeric vector.</p>
</dd>
<dt><code>cvol.ml</code></dt><dd><p>cumulative sum of <code>vol</code>.</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for <code><a href="#topic+cumBg">cumBg</a></code>.
Reactors were 300 mL glass serum bottles with butyl rubber septa and screw caps. 
Substrate was municipal wastewater sludge.
Volume was measured using syringes.
Data in <code>s3voll</code>, <code>s3compl</code>, <code>s3volw</code>, <code>s3compw</code>, and <code>s3lcombo</code> are from the same bottles.
</p>


<h3>Source</h3>

<p>Sasha D. Hafner. Measurements by Johanna Maria Pedersen.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(s3voll)
</code></pre>

<hr>
<h2 id='s3volw'>
Biogas Volume from Batch Reactors
</h2><span id='topic+s3volw'></span>

<h3>Description</h3>

<p>Biogas volume measurements from three batch bottles, organized in a &ldquo;wide&rdquo; format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("vol")</code></pre>


<h3>Format</h3>

<p>A data frame with 7 observations on the following 5 variables:
</p>

<dl>
<dt><code>time.d</code></dt><dd><p>elapsed time of mass measurements (from bottle setup) in days, a numeric vector.</p>
</dd>
<dt><code>D</code></dt><dd><p>volume of biogas removed at <code>time</code> from bottle &ldquo;D&rdquo; in mL, a numeric vector.</p>
</dd>
<dt><code>E</code></dt><dd><p>volume of biogas removed at <code>time</code> from bottle &ldquo;E&rdquo; in mL, a numeric vector.</p>
</dd>
<dt><code>F</code></dt><dd><p>volume of biogas removed at <code>time</code> from bottle &ldquo;F&rdquo; in mL, a numeric vector.</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for <code><a href="#topic+cumBg">cumBg</a></code>.
Reactors were 300 mL glass serum bottles with butyl rubber septa and screw caps. 
Volume was measured using syringes.
Data in <code>s3voll</code>, <code>s3compl</code>, <code>s3volw</code>, <code>s3compw</code>, and <code>s3lcombo</code> are from the same bottles.
</p>


<h3>Source</h3>

<p>Sasha D. Hafner. Measurements by Johanna Maria Pedersen.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(vol)
</code></pre>

<hr>
<h2 id='setup'>
Setup Details for Batch Reactors
</h2><span id='topic+setup'></span>

<h3>Description</h3>

<p>Description of reactor substrates and information on reactor, substrates and, inoculum initial masses for twelve anaerobic reactors. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("setup")</code></pre>


<h3>Format</h3>

<p>A data frame with 12 observations on the following 11 variables:
</p>

<dl>
<dt><code>id</code></dt><dd><p>identification code, a unique value for each reactor in the dataset. A factor with levels <code>2_1</code>, <code>2_2</code>, <code>2_3</code>, <code>2_4</code>, <code>2_5</code>, <code>2_6</code>, <code>2_7</code>, <code>2_8</code>, <code>2_9</code>, <code>2_10</code>, <code>2_11</code>, and <code>2_12</code> </p>
</dd>
<dt><code>descrip</code></dt><dd><p>description of substrate, a factor with levels <code>A</code> <code>B</code> <code>inoc</code>.</p>
</dd>
<dt><code>msub</code></dt><dd><p> mass of substrate added to the reactor at the start in g, a numeric vector.</p>
</dd>
<dt><code>minoc</code></dt><dd><p>mass of inoculum added to the reactor at the start in g, a numeric vector.</p>
</dd>
<dt><code>mvs.sub</code></dt><dd><p>mass of volatile solids (VS) of substrate added to the reactor at the start in g, a numeric vector.</p>
</dd>
<dt><code>mvs.inoc</code></dt><dd><p>mass of volatile solids (VS) of inoculum added to the reactor at the start in g, a numeric vector.</p>
</dd>
<dt><code>mcod.sub</code></dt><dd><p>mass of chemical oxygen demand (COD) of substrate added to the reactor at the start in g oxygen, a numeric vector.</p>
</dd>
<dt><code>mcod.inoc</code></dt><dd><p>mass of chemical oxygen demand (COD) of inoculum added to the reactor at the start in g oxygen, a numeric vector.</p>
</dd>
<dt><code>m.tot</code></dt><dd><p>total mass added to the reactor at the start in g, a numeric vector.</p>
</dd>
<dt><code>mvs.tot</code></dt><dd><p>total mass of VS in the reactor at the start in g, a numeric vector.</p>
</dd>
<dt><code>mcod.tot</code></dt><dd><p>total mass of COD in the reactor at the start in g oxygen, a numeric vector.</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for <code><a href="#topic+summBg">summBg</a></code>.
Reactors were 500 mL glass serum bottles with butyl rubber septa and screw caps. 
Data in <code>vol</code>, <code>mass</code>, <code>massw</code>, <code>comp</code>, and <code>setup</code> are from the same reactors.
</p>


<h3>Source</h3>

<p>Measurements made by Charlotte Rennuit and Ali Heidarzadeh Vazifehkhoran
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(setup)
</code></pre>

<hr>
<h2 id='setup2'>
Setup Details for Some Batch Reactors
</h2><span id='topic+setup2'></span>

<h3>Description</h3>

<p>Information on reactor substrates and substrate and inoculum masses for 15 anaerobic reactors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("setup2")</code></pre>


<h3>Format</h3>

<p>A data frame with 15 observations on the following 4 variables:
</p>

<dl>
<dt><code>bottle</code></dt><dd><p>identification code, a unique value for each reactor in the dataset. A factor with levels <code>1_1</code>, <code>1_2</code>, <code>1_3</code>, <code>2_1</code>, <code>2_2</code>, <code>2_2</code>, ... through <code>5_3</code>. The first number indicates the sample, the second the replicate.</p>
</dd>
<dt><code>description</code></dt><dd><p>description of substrate, a factor.</p>
</dd>
<dt><code>sub.vs</code></dt><dd><p>mass of substrate volatile solids (VS) added to the reactor at the start in g, a numeric vector</p>
</dd>
<dt><code>inoc.mass</code></dt><dd><p>mass of inoculum added to the reactor at the start in g, a numeric vector.</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for <code><a href="#topic+summBg">summBg</a></code>.
Reactors were 500 mL or 1000 mL glass serum bottles with butyl rubber septa and screw caps. 
Data in <code>vol2</code>, <code>xCH42</code>, and <code>setup2</code> are from the same reactors.
</p>


<h3>Source</h3>

<p>Measurements made by Ali Heidarzadeh Vazifehkhoran
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(setup2)
</code></pre>

<hr>
<h2 id='sludgeTwoBiogas'>
Headspace Pressure, Mass measurements, and Methane and Carbondioxid Content from Batch Bottles
</h2><span id='topic+sludgeTwoBiogas'></span>

<h3>Description</h3>

<p>Interval-based measurements of headspace pressure, mass, and methane and carbondioxide content from anaerobic batch bottles, organized in a &ldquo;longcombo&rdquo; format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("sludgeTwoBiogas")</code></pre>


<h3>Format</h3>

<p>A data frame with 224 observations on the following 8 variables:
</p>

<dl>
<dt><code>id</code></dt><dd><p>identification code, a unique value for each bottle in the dataset.</p>
</dd>
<dt><code>time.d</code></dt><dd><p>elapsed time of mass and pressure measurements in days, a numeric vector.</p>
</dd>
<dt><code>pres</code></dt><dd><p>bottle headspace pressure at <code>time</code> in mbar (gauge), a numeric vector</p>
</dd>
<dt><code>mass.init</code></dt><dd><p>total reactor mass at the start of its incubation in g, a numeric vector.</p>
</dd>
<dt><code>mass.final</code></dt><dd><p>total reactor mass at the end of its incubation in g, a numeric vector.</p>
</dd>
<dt><code>xCH4</code></dt><dd><p>biogas methane content as a mole fraction, excluding water, a numeric vector</p>
</dd>
<dt><code>xCO2</code></dt><dd><p>biogas carbon dioxide content as a mole fraction, excluding water, a numeric vector</p>
</dd>
<dt><code>xCH4n</code></dt><dd><p>biogas methane content as a mole fraction in dry biogas, normalized so the sum of mole fractions of CH$_4$ and CO$_2$ is unity, a numeric vector.</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for <code><a href="#topic+cumBg">cumBg</a></code> and <code><a href="#topic+calcBgMan">calcBgMan</a></code> for respectively, gravimetric and manometric determination of biogas production.
BMP test were carried out in 160 mL serum bottles sealed with a butyl rubber septum retained with an aluminum crimp seal at mesophilic conditions (37 degrees C). 
Substrate was primary wastewater sludge.
</p>
<p>Cumulative methane production was measured from the same set of bottles by both manometric and gravimetric methods. 
BMP was evaluated at 18 days
At each sampling event, headspace pressure was measured using a manometer and composition (CH4 and CO2) with a gas chromatograph). 
All reported pressure measurements are gauge unless stated otherwise.
After each sampling event, the headspace of the serum bottles (including blanks) was vented to near atmospheric pressure.
</p>
<p>Data in <code>sludgeTwoBiogas</code> and <code>sludgeTwoSetup</code> are from the same batch bottles.
</p>


<h3>Source</h3>

<p>Data were originally collected by Sergi Astals at the University of Queensland and are described in the following paper.
Hafner, S.D., Astals, S. 2019.Systematic error in manometric measurement of biochemical methane potential: Sources and solutions. <em>Waste Management</em> <b>91</b>, 147-155.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sludgeTwoBiogas)
</code></pre>

<hr>
<h2 id='sludgeTwoSetup'>
Setup Details for Batch Reactors
</h2><span id='topic+sludgeTwoSetup'></span>

<h3>Description</h3>

<p>Description of reactor substrates and information on bottle, substrates, inoculum initial masses, and headspace volume for 18 anaerobic bottles with primary wastewater sludge for substrate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("sludgeTwoSetup")</code></pre>


<h3>Format</h3>

<p>A data frame with 18 observations on the following 5 variables:
</p>

<dl>
<dt><code>id</code></dt><dd><p>identification code, a unique value for each bottle in the dataset. Numeric with all values within a range of 1-21.</p>
</dd>
<dt><code>descrip</code></dt><dd><p>treatment of the substrate (primary wastewater sludge), a character.</p>
</dd>
<dt><code>vol.hs</code></dt><dd><p>bottle headspace volume, in mL. A numeric vector.</p>
</dd>
<dt><code>m.inoc</code></dt><dd><p>mass of inoculum added to the bottle at the start in g, a numeric vector.</p>
</dd>
<dt><code>m.sub.vs</code></dt><dd><p> mass of volatile solids (VS) of substrate added to the reactor at the start in g, a numeric vector.</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for <code><a href="#topic+summBg">summBg</a></code>.
Substrate was primary wastewater sludge.
</p>
<p>BMP test were carried out in 160 mL serum bottles sealed with a butyl rubber septum retained with an aluminum crimp seal at mesophilic conditions (37 degrees C). 
All bottles contained inoculum and the amount of primary sludge required to achieve an inoculum-to-substrate ratio (ISR) of 2 (VS basis). 
Bottles containing only inoculum (blanks) were used to correct for the background CH4 potential of the inoculum (endogenous CH4 production). 
</p>
<p>Data in <code>sludgeTwoBiogas</code> and <code>sludgeTwoSetup</code> are from the same batch bottles.
</p>


<h3>Source</h3>

<p>Data were originally collected by Sergi Astals at the University of Queensland and are described in the paper listed below.
Hafner, S.D., Astals, S. 2019.Systematic error in manometric measurement of biochemical methane potential: Sources and solutions. <em>Waste Management</em> <b>91</b>, 147-155.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sludgeTwoSetup)
</code></pre>

<hr>
<h2 id='stdVol'>
Correct Gas Volume to 'Standard' Conditions
</h2><span id='topic+stdVol'></span>

<h3>Description</h3>

<p><code>stdVol</code> corrects gas volumes to dry conditions at a specified temperature and pressure. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stdVol(vol, temp, pres, rh = 1, 
       temp.std = getOption('temp.std', as.numeric(NA)), 
       pres.std = getOption('pres.std', as.numeric(NA)), 
       unit.temp = getOption('unit.temp', 'C'), 
       unit.pres = getOption('unit.pres', 'atm'), 
       std.message = TRUE, warn = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stdVol_+3A_vol">vol</code></td>
<td>

<p>measured gas volume at <code>temp</code> temperature, <code>pres</code> pressure, and <code>rh</code> relative humidity.
A numeric vector.
</p>
</td></tr>
<tr><td><code id="stdVol_+3A_temp">temp</code></td>
<td>

<p>temperature of gas in degrees C by default (see <code>unit.temp</code>).
A numeric vector.
</p>
</td></tr>
<tr><td><code id="stdVol_+3A_pres">pres</code></td>
<td>

<p>pressure of gas in atm by default (see <code>unit.pres</code>).
A numeric vector.
</p>
</td></tr>
<tr><td><code id="stdVol_+3A_rh">rh</code></td>
<td>

<p>relative humidity of the gas (<code>0&lt;= rh &lt;= 1</code>).
Typically should be 1.0 (the default).
A numeric vector.
</p>
</td></tr>
<tr><td><code id="stdVol_+3A_temp.std">temp.std</code></td>
<td>

<p>&quot;standard&quot; temperature.
Default value is 0 degrees C.
</p>
</td></tr>
<tr><td><code id="stdVol_+3A_pres.std">pres.std</code></td>
<td>

<p>&quot;standard&quot; pressure.
Default value is 1.0 atm.
</p>
</td></tr>
<tr><td><code id="stdVol_+3A_unit.pres">unit.pres</code></td>
<td>

<p>pressure units for <code>pres</code> and <code>pres.std</code> arguments.
Options are <code>"atm"</code> (the default), <code>"Pa"</code>, <code>"kPa"</code>, <code>"hPa"</code>, and <code>"bar"</code>.
</p>
</td></tr>
<tr><td><code id="stdVol_+3A_unit.temp">unit.temp</code></td>
<td>

<p>temperature units for <code>temp</code> and <code>temp.std</code> arguments.
Options are <code>"C"</code> (degrees Celcius), <code>"F"</code> (degrees Fahrenheit), and <code>"K"</code> (Kelvin).
</p>
</td></tr>
<tr><td><code id="stdVol_+3A_std.message">std.message</code></td>
<td>

<p>should a message with the standard conditions be displayed? Default is TRUE.
</p>
</td></tr>
<tr><td><code id="stdVol_+3A_warn">warn</code></td>
<td>

<p>if <code>TRUE</code>, will return a warning if temperature is below 0 C  or above 100 C, or if pressure is below 50 kPa or above 150 kPa.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Standardisation is done in a two-step process following Hafner et al. (2015).
First, the contribution of water vapor is removed and volume is corrected to the standard pressure:
</p>
<p>vd = vm*(pm - rh*pw)/ps
</p>
<p>where vd = dry volume at standard pressure ps, vm = measured volume at pressure pm, pw = saturation vapor pressure of water (all pressures in Pa), and rh = relative humidity (<code>rh</code> above).
Water vapor pressure pw is calculated from the Magnus form equation given in Alduchov and Eskridge (1996) (Eqs. (21) and (22)).
In the second step, the volume is adjusted for temperature.
</p>
<p>vs = vd*Ts/T  
</p>
<p>where vs = standardised volume and Ts = standardisation temperature (K, converted from <code>temp.std</code> argument).
This approach is based on Charles's and Boyle's laws.
Comparison with calculations using the Peng-Robinson equation of state suggests that error in <code>stdVol</code> is around 0.1% for typical biogas with volume measured at 25 degrees C, and higher at higher temperatures (up to 0.3% at 55 degrees C).
</p>
<p>Standard temperature and pressure and their units can be defined by the user using the <code>temp.std</code>, <code>pres.std</code>, <code>temp.unit</code>, and <code>pres.unit</code> arguments.  
Alternatively,  standard values and units of temperature and pressure can be globally set using the function <code><a href="base.html#topic+options">options</a></code>.
Default values are 0 degrees C and 1.0 atm. 
<code>stdVol</code> is vectorized, and if one argument has a shorter length than the others, it will be recycled.
</p>


<h3>Value</h3>

<p>Standardised gas volume in the same units as <code>vol</code>.
A numeric vector.
</p>


<h3>Author(s)</h3>

<p>Sasha D. Hafner and Charlotte Rennuit
</p>


<h3>References</h3>

<p>Hafner, S.D., Rennuit, C., Triolo, J.M., Richards, B.K. 2015. Validation of a simple gravimetric method for measuring biogas production in laboratory experiments. <em>Biomass and Bioenergy</em> <b>83</b>, 297-301.
</p>
<p>Richards, B.K., Cummings, R.J., White, T.E., Jewell, W.J. 1991. Methods for kinetic analysis of methane fermentation in high solids biomass digesters. <em>Biomass and Bioenergy</em> <b>1</b>, 65-73.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cumBg">cumBg</a></code>,
<code><a href="#topic+summBg">summBg</a></code>,
<code><a href="#topic+stdVol">stdVol</a></code>,
<code><a href="base.html#topic+options">options</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # 100 mL, measured at 35 C
  stdVol(100, temp = 35, pres = 1)

  # Or, with different units
  stdVol(100, temp = 35, pres = 103, unit.pres = "kPa", pres.std = 101.325)
  
  # Vectorized
  data(vol)
  head(vol)
  vol$vol.std &lt;- stdVol(vol$vol, temp = 20, pres = 1.02)
  head(vol)
  
  #using options() (recommended!)
  oldoptions &lt;- options(temp.std = 273.15, pres.std = 101325, 
                        unit.temp = 'K', unit.pres = 'Pa')
  vol$vol.std &lt;- stdVol(vol$vol, temp = 293.15, pres = 101325)
  head(vol)
  options(oldoptions)
</code></pre>

<hr>
<h2 id='strawComp'>
Methane Content of Biogas
</h2><span id='topic+strawComp'></span>

<h3>Description</h3>

<p>Methane content (biogas composition) measurements from 12 anaerobic batch reactors with straw for substrate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("comp")</code></pre>


<h3>Format</h3>

<p>A data frame with 63 observations on the following 4 variables.
</p>

<dl>
<dt><code>bottle</code></dt><dd><p>identification code, a unique value for each reactor in the dataset. Integer with all values from 1 to 12.</p>
</dd>
<dt><code>date.time</code></dt><dd><p>date and time of mass measurement, a POSIXct object.</p>
</dd>
<dt><code>time</code></dt><dd><p>elapsed time of mass measurements (from reactor setup) in days, a numeric vector.</p>
</dd>
<dt><code>xCH4</code></dt><dd><p>biogas methane content as a mole fraction, excluding water and all other gases other than carbon dioxide, a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for <code><a href="#topic+cumBg">cumBg</a></code>.
Reactors were ca. 600 mL glass serum bottles with butyl rubber septa and screw caps. 
Pressure was measured using an electronic manometer.
Data in <code>strawMass</code>, <code>strawSetup</code>, and <code>strawPressure</code> are from the same reactors.
</p>


<h3>Source</h3>

<p>Measurements by Charlotte Rennuit.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(strawComp)
</code></pre>

<hr>
<h2 id='strawMass'>
Mass Change of Batch Reactors
</h2><span id='topic+strawMass'></span>

<h3>Description</h3>

<p>Mass measurements for 12 batch anaerobic reactors with ground straw as a substrate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("mass")</code></pre>


<h3>Format</h3>

<p>A data frame with 89 observations on the following 4 variables.
</p>

<dl>
<dt><code>bottle</code></dt><dd><p>identification code, a unique value for each reactor in the dataset. Integer with all values from 1 to 12.</p>
</dd>
<dt><code>date.time</code></dt><dd><p>date and time of mass measurement, a POSIXct object.</p>
</dd>
<dt><code>time</code></dt><dd><p>elapsed time of mass measurements (from reactor setup) in days, a numeric vector.</p>
</dd>
<dt><code>mass</code></dt><dd><p>total reactor mass in g, a numeric vector.</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for <code><a href="#topic+mass2vol">mass2vol</a></code> or  <code><a href="#topic+cumBg">cumBg</a></code>, for gravimetric determination of biogas production.
Reactors were ca. 600 mL glass serum bottles with butyl rubber septa and screw caps. 
Masses were measured with an electronic balance to 10 mg.
Data in <code>strawPressure</code>, <code>strawSetup</code>, and <code>strawComp</code> are from the same reactors.
</p>


<h3>Source</h3>

<p>Measurements by Charlotte Rennuit.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(strawMass)
</code></pre>

<hr>
<h2 id='strawPressure'>
Headspace Pressure in Batch Reactors
</h2><span id='topic+strawPressure'></span>

<h3>Description</h3>

<p>Interval-based measurements of headspace pressure in 12 anaerobic batch reactors with straw as the substrate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("strawPressure")</code></pre>


<h3>Format</h3>

<p>A data frame with 72 observations on the following 5 variables:
</p>

<dl>
<dt><code>bottle</code></dt><dd><p>identification code, a unique value for each reactor in the dataset. Integer with all values from 1 to 12.</p>
</dd>
<dt><code>date.time</code></dt><dd><p>date and time of mass measurement, a POSIXct object.</p>
</dd>
<dt><code>time</code></dt><dd><p>elapsed time of mass measurements (from reactor setup) in days, a numeric vector.</p>
</dd>
<dt><code>pres</code></dt><dd><p>absolute bottle headspace pressure at the stated time, in kPa. Biogas accumulated in bottles from the previous time.</p>
</dd>
<dt><code>pres.resid</code></dt><dd><p>absolute bottle headspace pressure after venting, in kPa.</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for <code><a href="#topic+cumBg">cumBg</a></code>.
Reactors were ca. 600 mL glass serum bottles with butyl rubber septa and screw caps. 
Pressure was measured using an electronic manometer.
Data in <code>strawMass</code>, <code>strawSetup</code>, and <code>strawComp</code> are from the same reactors.
</p>


<h3>Source</h3>

<p>Measurements by Charlotte Rennuit.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(vol)
</code></pre>

<hr>
<h2 id='strawSetup'>
Setup Details for Batch Reactors
</h2><span id='topic+strawSetup'></span>

<h3>Description</h3>

<p>Description of reactor substrates and information on reactor, substrates and, inoculum initial masses for 12 anaerobic reactors with straw for substrate. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("setup")</code></pre>


<h3>Format</h3>

<p>A data frame with 12 observations on the following 6 variables:
</p>

<dl>
<dt><code>bottle</code></dt><dd><p>identification code, a unique value for each reactor in the dataset. Integer with all values from 1 to 12.</p>
</dd>
<dt><code>treatment</code></dt><dd><p>treatment of the substrate (ground straw), a factor.</p>
</dd>
<dt><code>start</code></dt><dd><p>starting date and time, when the reactors were set up.</p>
</dd>
<dt><code>sub.mass</code></dt><dd><p> mass of substrate added to the reactor at the start in g, a numeric vector.</p>
</dd>
<dt><code>inoc.mass</code></dt><dd><p>mass of inoculum added to the reactor at the start in g, a numeric vector.</p>
</dd>
<dt><code>headspace</code></dt><dd><p>bottle headspace volume, in mL. A numeric vector.</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for <code><a href="#topic+summBg">summBg</a></code>.
Reactors were ca. 600 mL glass serum bottles with butyl rubber septa and screw caps. 
Masses were measured with an electronic balance to 10 mg.
Data in <code>strawPressure</code>, <code>strawMass</code>, and <code>strawComp</code> are from the same reactors.
</p>


<h3>Source</h3>

<p>Measurements by Charlotte Rennuit.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(setup)
</code></pre>

<hr>
<h2 id='summBg'>
Summarise and Normalise Cumulative Methane Production
</h2><span id='topic+summBg'></span>

<h3>Description</h3>

<p>From cumulative gas production, use <code>summBg</code> to standardise, interpolate, subtract innoculum contribution, normalise by substrate mass, and summarise the output calculating mean and standard devations for each type of sample (groups of replicates). 
The function is flexible: some, all, or none of these operations can be carried out in a call.
Typically <code>summBg</code> is used to calculate biochemical methane potential (BMP) from cumulative methane production.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summBg(vol, setup, id.name = "id", time.name = "time", 
       descrip.name = "descrip", inoc.name = NULL, inoc.m.name = NULL,
       norm.name = NULL, norm.se.name = NULL,  vol.name = "cvCH4", 
       imethod = "linear", extrap = FALSE, when = 30, 
       when.min = 0, rate.crit = 'net', 
       show.obs = FALSE, show.rates = FALSE, show.more = FALSE,
       sort = TRUE, set.name = 'set', quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summBg_+3A_vol">vol</code></td>
<td>

<p>a data frame with the columns bottle identification code; time of measurement (as <code>numeric</code>, or <code>POSIX</code>); and the response variable biogas volume or cumulative volume.
The names of these columns can be specified with <code>id.name</code>, <code>time.name</code>, and <code>vol.name</code>. Or, the default names can be used. 
Additional columns can be present&ndash; these will be returned in the output data frame.
Optional: as of version 1.11.5, <code>vol</code> can be a list of suitable data frames.
This is convenient for comparing different approaches for calculating methane production, for example.
</p>
</td></tr>
<tr><td><code id="summBg_+3A_setup">setup</code></td>
<td>
 
<p>a data frame containing information to summarise, substract inoculum effect or normalise the data. Should contain at least the column <code>id.name</code> (bottle identification code), and the additional columns depending on the operations desired. See &lsquo;Details&rsquo; for more information.
</p>
</td></tr>
<tr><td><code id="summBg_+3A_id.name">id.name</code></td>
<td>

<p>name of the bottle identification code column in <code>vol</code> and <code>setup</code>. Should be the same in all data frames used in the function. Default is <code>"id"</code>.
</p>
</td></tr>
<tr><td><code id="summBg_+3A_time.name">time.name</code></td>
<td>

<p>name of column containing time data in <code>vol</code>. Default is <code>"time"</code>.
</p>
</td></tr>
<tr><td><code id="summBg_+3A_descrip.name">descrip.name</code></td>
<td>

<p>(optional) name of column containing a description of bottle substrate (or a code for this) in <code>setup</code> data frame. The summary of the data will be made following this column. Default is <code>"descrip"</code>.
</p>
</td></tr>
<tr><td><code id="summBg_+3A_inoc.name">inoc.name</code></td>
<td>

<p>(optional) the value in the <code>descrip.name</code> (<code>setup</code> data frame) column that is used to describe the inoculum-only bottles. Length one character vector. Argument not used by default.  
</p>
</td></tr>
<tr><td><code id="summBg_+3A_norm.name">norm.name</code></td>
<td>

<p>(optional) the name of the column in <code>setup</code> that has the mass to perform the normalisation (typically substrate VS mass). Length one character vector. Argument not used by default.
</p>
</td></tr>
<tr><td><code id="summBg_+3A_norm.se.name">norm.se.name</code></td>
<td>

<p>(optional) the name of the column in <code>setup</code> that has the standard error of the data in the column <code>norm.name</code>. Length one character vector. If provided, this error in substrate mass will be included in the standard error and standard deviation given in the output. Argument not used by default.
</p>
</td></tr>
<tr><td><code id="summBg_+3A_inoc.m.name">inoc.m.name</code></td>
<td>

<p>(optional) the name of the column in <code>setup</code> that has inoculum mass.
If specified, these data are used to subtract the inoculum contribution to methane production.
Length one character vector. Default is <code>"minoc"</code>. 
</p>
</td></tr>
<tr><td><code id="summBg_+3A_vol.name">vol.name</code></td>
<td>

<p>the name of the column(s) in <code>vol</code> that contains the response variable used for the summary&ndash;typically cumulative methane volume. 
The default is <code>"cvCH4"</code> for <em>c</em>umulative <em>v</em>olume of methane (CH4).
Optional: as of version 1.12.0, <code>vol.name</code> may be a vector with length &gt; 1.
In this case each response variable will be used and results will be returned for all, together in a single data frame.
Character vector.
</p>
</td></tr>
<tr><td><code id="summBg_+3A_imethod">imethod</code></td>
<td>

<p>the interpolation method to be used. 
This is passed as the <code>method</code> argument to <code><a href="#topic+interp">interp</a></code>. Length one character vector. Default is <code>"linear"</code> for linear interpolation.
</p>
</td></tr>
<tr><td><code id="summBg_+3A_extrap">extrap</code></td>
<td>

<p>should extrapolation be carried out? Set to <code>TRUE</code> if extrapolation wanted.
Length one logical vector.
This is passed as the <code>extrap</code> argument to <code><a href="#topic+interp">interp</a></code>. Default is <code>FALSE</code>
</p>
</td></tr>
<tr><td><code id="summBg_+3A_when">when</code></td>
<td>

<p>value(s) of <code>time.name</code> in <code>vol</code> data frame at which the results should be evaluated.
Alternatively, set to <code>"end"</code> (to return the latest values for each bottle) or <code>"meas"</code> (to return a value for each measured time for each bottle).
To select a time for each bottle based on the methane production rate, use, e.g., <code>"1p3d"</code> for 1% per day for at least 3 d (any values can be used, even something impractical like <code>"0.1p10d"</code>).
In this case, the earliest time where production rate drops below 1% of cumulative production per day for at least 3 days will be used.
Where this time differs for multiple bottles with the same <code>descrip.name</code>, the latest one will be used.
Numeric or character vector or list (use a list for, e.g., <code>list("1p3d", "end", 30)</code>).
</p>
</td></tr>
<tr><td><code id="summBg_+3A_when.min">when.min</code></td>
<td>

<p>minimum duration (value of <code>when</code>) to be used with a relative duration criterion, e.g., if you want <code>"1p3d"</code> but no less than 15 days set <code>when.min = 15</code>. Ignored if <code>when</code> is numeric. Default is <code>Inf</code> (no limit).
</p>
</td></tr>
<tr><td><code id="summBg_+3A_rate.crit">rate.crit</code></td>
<td>

<p>type of rate criterion to be applied for relative <code>when</code>, e.g., <code>when = "1p3d"</code> and <code>rate.crit = "net"</code> is based on net gas production (after subtracting incoulum contribution). Options are <code>"net"</code> or <code>"gross"</code>.
</p>
</td></tr>
<tr><td><code id="summBg_+3A_show.obs">show.obs</code></td>
<td>

<p>set to <code>TRUE</code> to return all observations, otherwise means and standard deviations are returned. Default is <code>FALSE</code>. 
</p>
</td></tr>
<tr><td><code id="summBg_+3A_show.rates">show.rates</code></td>
<td>

<p>set to <code>TRUE</code> to return all observations with relative rates. Used to check rates for evaluation time. The <code>when</code> argument will be ignored if <code>show.rates = TRUE</code>. Default is <code>FALSE</code>. 
</p>
</td></tr>
<tr><td><code id="summBg_+3A_show.more">show.more</code></td>
<td>

<p>set to <code>TRUE</code> to return additional details, including fraction of total methane produced by inoculum. Default is <code>FALSE</code>. 
</p>
</td></tr>
<tr><td><code id="summBg_+3A_sort">sort</code></td>
<td>

<p>controls sorting of results, which is by <code>descrip.name</code> and then <code>time.name</code> by default. Set to <code>FALSE</code> to use order of <code>descrip.name</code> from the <code>setup</code> data frame. Default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="summBg_+3A_set.name">set.name</code></td>
<td>

<p>column name in result for set of observations, corresponding to elements in <code>vol</code> when it is a list.
</p>
</td></tr>
<tr><td><code id="summBg_+3A_quiet">quiet</code></td>
<td>

<p>use to suppress messages. Default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>summBg</code> was primarily designed to calculate the biochemical methane potential (BMP) from cumulative methane production of a set of batch bottles through these steps: interpolation of cumulative production to a specified time (if needed), subtratction of apparent innoculum contribution, normalisation of the results by substrate mass (typically volatile solids (VS) mass, but could be the mass of anything within the bottle) and calculation of mean and standard deviation for each sample type (set of replicates, identified by <code>descrip.name</code>). 
</p>
<p>If needed <code>summBg</code> can return values for all observations and be used for simpler operations e.g., determining cumulative biogas production at some specified time or normalising gas volume by different substrate characteristics.
</p>
<p>To summarise data, the <code>setup</code> data frame should have a column with a description of bottle substrate (or a code for this). 
The name of the column is set by the <code>descrip.name</code> argument.  
If the inoculum effect is to be subtracted out, a column named <code>descrip.name</code> (for identifying replicates) and a column with the mass of inoculum present (any units), with a name set by <code>inoc.m.name</code> are both required in <code>setup</code>. 
To normalise by substrate mass (or any mass to be used for normalisation), an additional column with the mass of substrate is needed in <code>setup</code> &ndash;its name is set by <code>norm.name</code>.
</p>
<p>This function is probably easier to understand by example.
See &lsquo;Examples&rsquo;.
</p>


<h3>Value</h3>

<p>a data frame, with the colums:
</p>
<table>
<tr><td><code>descrip</code></td>
<td>
<p>from the input data frame setup</p>
</td></tr>
<tr><td><code>mean</code></td>
<td>
<p>mean of the response variable <code>vol.name</code>, typically after subtraction of inoculum contribution and normalization by substrate mass</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p>standard deviation of the response variable <code>vol.name</code></p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>standard error of the response variable <code>vol.name</code></p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of bottles</p>
</td></tr>
</table>
<p>If <code>show.more = TRUE</code> additional columns are returned:
summ2 &lt;- summ2[ , c(descrip.name, time.name, 'mean', 'se', 'sd', 'n', 'rsd.inoc', 'fv.inoc', 'se1', 'se2', 'se3')]
</p>
<table>
<tr><td><code>rsd.inoc</code></td>
<td>
<p>relative standard deviation in specific <code>vol.name</code> (methane) production by inouclum among replicates</p>
</td></tr> 
<tr><td><code>fv.inoc</code></td>
<td>
<p>(mean) fraction of bottle <code>vol.name</code> (methane) estimated to have come from inoculum</p>
</td></tr> 
<tr><td><code>se1</code></td>
<td>
<p>standard error contribution from variation among replicate substrate bottles</p>
</td></tr> 
<tr><td><code>se2</code></td>
<td>
<p>standard error contribution from variation among inoculum-only bottles</p>
</td></tr> 
<tr><td><code>se2</code></td>
<td>
<p>standard error contribution from uncertainty in substrate mass addition</p>
</td></tr> 
</table>
<p>If <code>show.obs = TRUE</code> even more columns are returned:
</p>
<table>
<tr><td><code>cvCH4.tot</code></td>
<td>
<p>name based on <code>vol.name</code>, total <code>vol.name</code> produced by bottle, normalization applied as for <code>vol.name</code> (and may be nonsensical)</p>
</td></tr> 
<tr><td><code>cvCH4.inoc</code></td>
<td>
<p>name based on <code>vol.name</code>, <code>vol.name</code> produced by bottle estimated as coming from inoculum, normalization applied as for <code>vol.name</code> (and may be nonsensical)</p>
</td></tr> 
<tr><td><code>se.inoc</code></td>
<td>
<p>standard error from inoculum used to calculate <code>se2</code></p>
</td></tr> 
<tr><td><code>cvCH4.se</code></td>
<td>
<p>name based on <code>vol.name</code>, standard error from substrate mass used to calculate <code>se3</code></p>
</td></tr> 
</table>


<h3>Note</h3>

<p>Reported standard deviation and standard error includes an estimate of variability from subtracting the inoculum contribution when this is done.
</p>


<h3>Author(s)</h3>

<p>Sasha D. Hafner and Charlotte Rennuit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cumBg">cumBg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("vol")
data("comp") 
data("setup") 

# First need to calculate cumulative methane production data
cum.prod &lt;- cumBg(vol, comp = comp, temp = 20, pres = 1, 
                  time.name = "days", extrap = TRUE)

head(cum.prod)

# Cumulative methane production (default) at 30 d 
# Uses default names for some columns
summBg(vol = cum.prod, setup = setup, time.name = "days", when = 30)

# Or total cumulative biogas
summBg(vol = cum.prod, setup = setup, time.name = "days", 
       vol.name = "cvBg", when = 30)

# Cumulative CH4 only, subtract inoculum contribution
summBg(vol = cum.prod, setup = setup, time.name = "days", 
       inoc.name = "inoc", inoc.m.name = "minoc", when = 30)

# And normalise by mvs.sub column (mass of substrate VS here) (so the result is BMP)
summBg(vol = cum.prod, setup = setup, time.name = "days", 
       inoc.name = "inoc", inoc.m.name = "minoc", when = 30, 
       norm.name = "mvs.sub")

# Same example, but return results for three times
summBg(vol = cum.prod, setup = setup, time.name = "days", 
       inoc.name = "inoc", inoc.m.name = "minoc", when = c(10, 30, 60), 
       norm.name = "mvs.sub")

# Back to earlier example, but return all individual observations 
# (and total production and individual contributions of substrate 
# and inoculum) 
summBg(vol = cum.prod, setup = setup, time.name = "days", 
       inoc.name = "inoc", inoc.m.name = "minoc", when = 30, 
       norm.name = "mvs.sub", show.obs = TRUE)

# Something different: interpolated biogas production rates
summBg(vol = cum.prod, setup = setup, time.name = "days", 
       vol.name = "rvBg", when = 30, show.obs = TRUE)

# The when argument could also be 'meas', 'end', or '1p3d' (or related) for any of these examples 
summBg(vol = cum.prod, setup = setup, time.name = "days", 
       inoc.name = "inoc", inoc.m.name = "minoc", when = "end", 
       norm.name = "mvs.sub")

summBg(vol = cum.prod, setup = setup, time.name = "days", 
       inoc.name = "inoc", inoc.m.name = "minoc", when = "meas", 
       norm.name = "mvs.sub")

summBg(vol = cum.prod, setup = setup, time.name = "days", 
       inoc.name = "inoc", inoc.m.name = "minoc", when = "1p3d", 
       norm.name = "mvs.sub")

# Or combine multiple values of when in a list

summBg(vol = cum.prod, setup = setup, time.name = "days", 
       inoc.name = "inoc", inoc.m.name = "minoc", 
       when = list(30, "1p3d", "end"), 
       norm.name = "mvs.sub")

# If you want to apply the 1% criterion but also want a single fixed time for all bottles,
# you have to use two calls
summBg(vol = cum.prod, setup = setup, time.name = "days", 
       inoc.name = "inoc", inoc.m.name = "minoc", when = "1p3d", 
       norm.name = "mvs.sub")

# From the first call, the longest time is 42 days, so use when = 42
summBg(vol = cum.prod, setup = setup, time.name = "days", 
       inoc.name = "inoc", inoc.m.name = "minoc", when = 42, 
       norm.name = "mvs.sub")

# If an error is thrown because a bottle doesn't meet the 1% criterion, use 
# show.rates = TRUE to see rates
## Not run: 
# Will return error
cpshort &lt;- cum.prod[cum.prod$days &lt; 10, ]
summBg(vol = cpshort, setup = setup, time.name = "days", 
       inoc.name = "inoc", inoc.m.name = "minoc", when = "1p", 
       norm.name = "mvs.sub")

## End(Not run)

# So then use this to see which bottles are causing problems
cpshort &lt;- cum.prod[cum.prod$days &lt; 10, ]
summBg(vol = cpshort, setup = setup, time.name = "days", 
       inoc.name = "inoc", inoc.m.name = "minoc", when = "1p", 
       norm.name = "mvs.sub", show.rates = TRUE)


# Example with dataset with different column names
data("vol2")
data("comp2")
data("setup2")

# First need to calculate cumulative methane production data
cum.prod &lt;- cumBg(vol2, comp = comp2, temp = 20, pres = 1, 
                  id.name = "bottle", time.name = "days", 
		  dat.name = "meas.vol", comp.name = "CH4.conc", 
                  extrap = TRUE)

head(cum.prod)

# Cumulative CH4 production at 30 d, subtract inoculum contribution 
# and normalise by sub.vs column (mass of substrate VS here) (look at setup2).
summBg(vol = cum.prod, setup = setup2, id.name = "bottle", 
       time.name = "days", descrip.name = "description", 
       inoc.name = "Inoculum", inoc.m.name = "inoc.mass", 
       norm.name = "sub.vs", when = 30)

</code></pre>

<hr>
<h2 id='UQGDBiogas'>
Biogas Volume and Mass Loss from BMP bottles
</h2><span id='topic+UQGDBiogas'></span>

<h3>Description</h3>

<p>Gas density biochemical methane potential (GD-BMP) measurements for 9 batch anaerobic bottles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("UQGDBiogas")</code></pre>


<h3>Format</h3>

<p>A data frame with 135 observations on the following variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>identification code, a unique value for each bottle in the dataset. A factor.</p>
</dd>
<dt><code>time.d</code></dt><dd><p>elapsed time of measurements (from bottle setup) in days, a numeric vector.</p>
</dd>
<dt><code>vol</code></dt><dd><p>measured biogas volume at the end of a sampling interval, a numeric vector.</p>
</dd>
<dt><code>mass.init</code></dt><dd><p>total bottle mass prior to biogas venting in g, a numeric vector.</p>
</dd>
<dt><code>mass.final</code></dt><dd><p>total bottle mass after biogas venting in g, a numeric vector.</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for <code><a href="#topic+calcBgGD">calcBgGD</a></code>, for gas density-based determination of biogas production (GD-BMP).
Reactors were glass serum bottles with butyl rubber septa.
Masses were measured with an analytical balance.
Data in <code>UQGDSetup</code> are from the same bottles.
</p>


<h3>Source</h3>

<p>Measurements were made by Sergi Astals and are described in the following paper.
</p>
<p>Justesen, C.G., Astals, S., Mortensen, J.R., Thorsen, R., Koch, K., Weinrich, S., Triolo, J.M., Hafner, S.D. 2019. Development and validation of a low-cost gas density method for measuring biochemical potential (BMP) <em>Water (MDPI)</em> <b>11(12)</b>: 2431.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(UQGDBiogas)
</code></pre>

<hr>
<h2 id='UQGDSetup'>
BMP Bottle Setup Information
</h2><span id='topic+UQGDSetup'></span>

<h3>Description</h3>

<p>Details on bottle contents and more from GD-BMP experiment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("UQGDSetup")</code></pre>


<h3>Format</h3>

<p>A data frame with 135 observations on the following variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>identification code, a unique value for each bottle in the dataset. A factor.</p>
</dd>
<dt><code>descrip</code></dt><dd><p>description of substrate, a factor with levels <code>Inoculum</code>, <code>Cellulose</code>, <code>Substrate C</code>.</p>
</dd>
<dt><code>m.inoc</code></dt><dd><p>mass of inoculum added to the bottle at the start in g. Numeric.</p>
</dd>
<dt><code>m.sub</code></dt><dd><p>mass of substrate added to the bottle at the start in g. Numeric.</p>
</dd>
<dt><code>m.tot</code></dt><dd><p>total mass added to the bottle at the start in g. Numeric.</p>
</dd>
<dt><code>m.sub.vs</code></dt><dd><p>mass of volatile solids (VS) of substrate added to the bottle at the start in g. Numeric.</p>
</dd>
<dt><code>vol.hs</code></dt><dd><p>bottle headspace in mL. Numeric.</p>
</dd>
<dt><code>isr</code></dt><dd><p>VS-based inoculum-to-substrate ratio.</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for <code><a href="#topic+calcBgGD">calcBgGD</a></code>, for gas density-based determination of biogas production (GD-BMP).
Reactors were glass serum bottles with butyl rubber septa.
Data in <code>UQGDBiogas</code> are from the same bottles.
</p>


<h3>Source</h3>

<p>Measurements were made by Sergi Astals and are described in the following paper.
</p>
<p>Justesen, C.G., Astals, S., Mortensen, J.R., Thorsen, R., Koch, K., Weinrich, S., Triolo, J.M., Hafner, S.D. 2019. Development and validation of a low-cost gas density method for measuring biochemical potential (BMP) <em>Water (MDPI)</em> <b>11(12)</b>: 2431.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(UQGDSetup)
</code></pre>

<hr>
<h2 id='vol'>
Biogas Volume from Batch Reactors
</h2><span id='topic+vol'></span>

<h3>Description</h3>

<p>Biogas volume measurements from twelve batch reactors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("vol")</code></pre>


<h3>Format</h3>

<p>A data frame with 288 observations on the following 4 variables:
</p>

<dl>
<dt><code>id</code></dt><dd><p>identification code, a unique value for each reactor in the dataset. A factor with levels <code>2_1</code>, <code>2_2</code>, <code>2_3</code>, <code>2_4</code>, <code>2_5</code>, <code>2_6</code>, <code>2_7</code>, <code>2_8</code>, <code>2_9</code>, <code>2_10</code>, <code>2_11</code>, and <code>2_12</code> </p>
</dd>
<dt><code>date.time</code></dt><dd><p>date and time of mass measurement, a POSIXct object.</p>
</dd>
<dt><code>days</code></dt><dd><p>elapsed time of mass measurements (from reactor setup) in days, a numeric vector.</p>
</dd>
<dt><code>vol</code></dt><dd><p>volume of biogas removed at <code>date.time</code> in mL, a numeric vector.</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for multiple functions, e.g., <code><a href="#topic+stdVol">stdVol</a></code>, <code><a href="#topic+cumBg">cumBg</a></code>, or <code><a href="#topic+summBg">summBg</a></code>.
Reactors were 500 mL glass serum bottles with butyl rubber septa and screw caps. 
Volume was measured using syringes.
Data in <code>vol</code>, <code>mass</code>, <code>xCH4</code>, and <code>setup</code> are from the same reactors.
</p>


<h3>Source</h3>

<p>Measurements by Charlotte Rennuit and Ali Heidarzadeh Vazifehkhoran.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(vol)
</code></pre>

<hr>
<h2 id='vol2'>
Biogas Volume from Batch Reactors
</h2><span id='topic+vol2'></span>

<h3>Description</h3>

<p>Biogas volume measurements from 15 batch reactors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("vol2")</code></pre>


<h3>Format</h3>

<p>A data frame with 216 observations on the following 4 variables:
</p>

<dl>
<dt><code>bottle</code></dt><dd><p>identification code, a unique value for each reactor in the dataset. A factor with levels <code>1_1</code>, <code>1_2</code>, <code>1_3</code>, <code>2_1</code>, <code>2_2</code>, <code>2_2</code>, ... through <code>5_3</code>. The first number indicates the sample, the second the replicate.</p>
</dd>
<dt><code>days</code></dt><dd><p>elapsed time of mass measurements (from reactor setup) in days, a numeric vector.</p>
</dd>
<dt><code>meas.vol</code></dt><dd><p>volume of biogas removed at <code>days</code> in mL, a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data are meant to be example data for multiple functions, e.g., <code><a href="#topic+stdVol">stdVol</a></code>, <code><a href="#topic+cumBg">cumBg</a></code>, or <code><a href="#topic+summBg">summBg</a></code>.
Reactors were 500 mL or 1000 mL glass serum bottles with butyl rubber septa and screw caps. 
Volume was measured using syringes.
Data in <code>vol2</code>, <code>xCH42</code>, and <code>setup2</code> are from the same reactors.
</p>


<h3>Source</h3>

<p>Measurements by Ali Heidarzadeh Vazifehkhoran.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(vol2)
</code></pre>

<hr>
<h2 id='vol2mass'>
Calculate Mass of Biogas
</h2><span id='topic+vol2mass'></span>

<h3>Description</h3>

<p><code>vol2mass</code> calculates the mass of biogas removed from a reactor, based on its composition, temperature, and pressure.
This function is the inverse of <code>mass2vol</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vol2mass(volBg, xCH4, temp.hs, temp.vol, pres.hs, pres.vol, 
  unit.temp = getOption('unit.temp', 'C'), 
  unit.pres = getOption('unit.pres', 'atm'), 
  rh.hs = 1, rh.vol = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vol2mass_+3A_volbg">volBg</code></td>
<td>

<p>measured (not standardised) biogas volume in mL.
Numeric vector.
</p>
</td></tr>
<tr><td><code id="vol2mass_+3A_xch4">xCH4</code></td>
<td>

<p>mole fraction of methane within biogas (dry, methane and carbon dioxide only).
Numeric vector.
</p>
</td></tr>
<tr><td><code id="vol2mass_+3A_temp.hs">temp.hs</code></td>
<td>

<p>temperature of biogas just prior to removal, in the units specified in <code>unit.temp</code> (default of degrees C).
Numeric vector.
</p>
</td></tr>  
<tr><td><code id="vol2mass_+3A_temp.vol">temp.vol</code></td>
<td>

<p>temperature of biogas at the time of volume measurement, in the units specified in <code>unit.temp</code> (default of degrees C).
Numeric vector.
</p>
</td></tr>
<tr><td><code id="vol2mass_+3A_pres.hs">pres.hs</code></td>
<td>

<p>pressure of biogas just prior to removal, in the units specified in <code>unit.pres</code> (default of atm).
Identical to <code>pres</code> argument in <code><a href="#topic+mass2vol">mass2vol</a></code>.
Numeric vector.
</p>
</td></tr>
<tr><td><code id="vol2mass_+3A_pres.vol">pres.vol</code></td>
<td>

<p>pressure of gas at the time of measurement in atm by default (see <code>unit.pres</code>).
Identical to <code>pres</code> argument of <code><a href="#topic+stdVol">stdVol</a></code>.
Numeric vector.
</p>
</td></tr>
<tr><td><code id="vol2mass_+3A_unit.pres">unit.pres</code></td>
<td>

<p>pressure units.
Options are <code>"atm"</code> (the default), <code>"Pa"</code>, <code>"kPa"</code>, <code>"hPa"</code>, and <code>"bar"</code>.
Length-one character vector.
</p>
</td></tr>
<tr><td><code id="vol2mass_+3A_unit.temp">unit.temp</code></td>
<td>

<p>temperature units.
Options are <code>"C"</code> (degrees Celcius, the default), <code>"F"</code>, and <code>"K"</code>.
Length-one character vector.
</p>
</td></tr>
<tr><td><code id="vol2mass_+3A_rh.hs">rh.hs</code></td>
<td>

<p>relative humidity of the reactor headspace just prior to biogas removal.
Length one numeric vector between zero and 1.0.
</p>
</td></tr>
<tr><td><code id="vol2mass_+3A_rh.vol">rh.vol</code></td>
<td>

<p>relative humidity of the biogas at the time of volume measurement.
Length one numeric vector between zero and 1.0.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is vectorized. 
Argument elements will be recycled as needed.
Note that this function is conceptually but not numerically the inverse of <code>mass2vol</code>, because the <code>volBg</code> argument here is not standardised, and is assumed to be saturated with water vapor just prior to removal.
The mass that is calculated may not be equal to the mass of the biogas at the time of volume measurement&ndash;as long as <code>temp.vol</code> is less than <code>temp.hs</code>, some of the water lost from the reactor condenses and is not present in the biogas at the time of volume measurement.
</p>
<p>Standard values and units of temperature and pressure can be globally set using the function <code><a href="base.html#topic+options">options</a></code>.
</p>


<h3>Value</h3>

<p>biogas mass in g as a numeric vector.
</p>


<h3>Author(s)</h3>

<p>Sasha D. Hafner and Charlotte Rennuit
</p>


<h3>References</h3>

<p>Hafner, S.D., Rennuit, C., Triolo, J.M., Richards, B.K. In review. A gravimetric method for measuring biogas production. Biomass and Bioenergy.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mass2vol">mass2vol</a></code>,
<code><a href="base.html#topic+options">options</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Mass loss from reactor for 100 mL biogas measured at 20 degrees C 
# and 1.0 atm, with headspace at 1.5 atm and 35 degrees C at the 
# time of biogas exit
vol2mass(100, xCH4 = 0.65, temp.hs = 35, temp.vol = 20, 
         pres.hs = 1.5, pres.vol = 1)

# If the measured volume has already been standardised to dry 
# conditions at 0 C and 1 atm
vol2mass(100, xCH4 = 0.65, temp.hs = 35, temp.vol = 0, 
         pres.hs = 1.5, pres.vol = 1, rh.vol = 0)

# Here vol2mass *is* numerically the inverse of mass2vol
vol2mass(mass2vol(1.234, xCH4 = 0.65, temp = 35, pres = 1.5, 
                  value = "Bg"), 
         xCH4 = 0.65, temp.hs = 35, temp.vol = 0, pres.hs = 1.5, 
         pres.vol = 1, rh.vol = 0)

</code></pre>

<hr>
<h2 id='vol2mol'>
Calculate Moles of a Gas
</h2><span id='topic+vol2mol'></span>

<h3>Description</h3>

<p><code>vol2mol</code> calculates the moles of a gas for a measured volume, temperature, and pressure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vol2mol(vol, gas = "CH4", temp, pres, rh = 0, 
	unit.temp = getOption('unit.temp', 'C'), 
	unit.pres = getOption('unit.pres', 'atm'), 
	tp.message = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vol2mol_+3A_vol">vol</code></td>
<td>

<p>measured gas volume in mL.
Numeric vector.
</p>
</td></tr>
<tr><td><code id="vol2mol_+3A_gas">gas</code></td>
<td>

<p>chemical formula of gas.
Currently options are <code>c("CH4", "CO2", "N2", "H2")</code>.
Character vector.
</p>
</td></tr>
<tr><td><code id="vol2mol_+3A_temp">temp</code></td>
<td>

<p>temperature of gas at time of volume measurement.
Numeric vector.
</p>
</td></tr>  
<tr><td><code id="vol2mol_+3A_pres">pres</code></td>
<td>

<p>pressure of gas at time of volume measurement, in the units specified in <code>unit.pres</code> (default of atm).
Numeric vector.
</p>
</td></tr>
<tr><td><code id="vol2mol_+3A_rh">rh</code></td>
<td>

<p>relative humidity of the gas at time of measurement.
Length one numeric vector between zero and 1.0.
Default is zero (dry gas).
</p>
</td></tr>
<tr><td><code id="vol2mol_+3A_unit.temp">unit.temp</code></td>
<td>

<p>temperature units.
Options are <code>"C"</code> (degrees Celcius, the default), <code>"F"</code>, and <code>"K"</code>.
Length-one character vector.
</p>
</td></tr>
<tr><td><code id="vol2mol_+3A_unit.pres">unit.pres</code></td>
<td>

<p>pressure units.
Options are <code>"atm"</code> (the default), <code>"Pa"</code>, <code>"kPa"</code>, <code>"hPa"</code>, and <code>"bar"</code>.
Length-one character vector.
</p>
</td></tr>
<tr><td><code id="vol2mol_+3A_tp.message">tp.message</code></td>
<td>

<p>should a message display <code>temp</code> and <code>pres</code> to avoid unit mistakes?
Length one logical vector.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses a simple and approximate approach for the conversion, based on Charles's and Boyle's laws, with NIST values for 0 degrees C and 1.0 atm taken as the reference state (Lemmon et al. 2011).
Measured volume is normalized to 1.0 atm and 0 degrees C using <code><a href="#topic+stdVol">stdVol</a></code>, and the result is divided by the molar volume at the same conditions, as reported by NIST.
Resulting error should be within 0.5% for temperature and pressure close to ambient, and is usually below 0.2%.
</p>


<h3>Value</h3>

<p>gas amount in moles as a numeric vector.
</p>


<h3>Author(s)</h3>

<p>Sasha D. Hafner
</p>


<h3>References</h3>

<p>Lemmon EW, McLinden MO, Friend DG. Thermophysical Properties of Fluid Systems. In Linstrom PJ, Mallard WG, editors. <em>Chemistry WebBook</em>, NIST Standard Reference Database Number 69. Gaithersburg, MD: National Institute of Standards and Technology, 2011.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vol2mass">vol2mass</a></code>,
<code><a href="#topic+mass2vol">mass2vol</a></code>,
<code><a href="base.html#topic+options">options</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Assume we have measured 253 mL CH4 at 1.0 atm and 22 C, dry
vol2mol(253, "CH4", temp = 22, pres = 1)

# Compare to results to NIST values for the least ideal gas
# Results are within 0.5%
# Expect 0.04108 mol
vol2mol(1000, "CO2", temp = 25, pres = 1)

# Expect 0.08258 mol
vol2mol(1000, "CO2", temp = 25, pres = 2)

# Expect 0.07482 mol
vol2mol(1000, "CO2", temp = 55, pres = 2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
