<!DOCTYPE html><html><head><title>Help for package spectralR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {spectralR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#spectralR'><p>spectralR: A package for obtaining and visualizing spectral reflectance data for earth surface polygons</p></a></li>
<li><a href='#get.pixel.data'><p>Obtain Sentinel-2 spectral reflectance data for user-defined vector polygons</p></a></li>
<li><a href='#prepare.vector.data'><p>Prepare vector data for further reflectance data sampling</p></a></li>
<li><a href='#spectral.curves.plot'><p>Make spectral reflectance curves for defined classes of surface</p></a></li>
<li><a href='#stat.summary.plot'><p>Statistical summary plot of reflectance values</p></a></li>
<li><a href='#violin.plot'><p>Create violin plots of reflectance per band for each surface class</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Obtain and Visualize Spectral Reflectance Data for Earth Surface
Polygons</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for obtaining, processing, and visualizing spectral reflectance data for the user-defined land or water surface classes for visual exploring in which wavelength the classes differ. Input should be a shapefile with polygons of surface classes (it might be different habitat types, crops, vegetation, etc.). The Sentinel-2 L2A satellite mission optical bands pixel data are obtained through the Google Earth Engine service (<a href="https://earthengine.google.com/">https://earthengine.google.com/</a>) and used as a source of spectral data.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>rgee (&ge; 1.1.3), geojsonio (&ge; 0.9.4), sf (&ge; 1.0-7), dplyr
(&ge; 1.0.9), ggplot2 (&ge; 3.3.5), reshape2 (&ge; 1.4.0), rlang (&ge;
1.0.0), tibble (&ge; 3.1.0), tidyr (&ge; 1.2.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, tinytest (&ge; 1.3.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/olehprylutskyi/spectralR/">https://github.com/olehprylutskyi/spectralR/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/olehprylutskyi/spectralR/issues">https://github.com/olehprylutskyi/spectralR/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-24 08:18:59 UTC; mik</td>
</tr>
<tr>
<td>Author:</td>
<td>Oleh Prylutskyi [aut, cre],
  Dariia Shyriaieva [ctb],
  Vladimir Mikryukov [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Oleh Prylutskyi &lt;oleh.prylutskyi@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-24 09:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='spectralR'>spectralR: A package for obtaining and visualizing spectral reflectance data for earth surface polygons</h2><span id='topic+spectralR'></span><span id='topic+spectralR-package'></span>

<h3>Description</h3>

<p>This package aims to obtain, process, and visualize spectral reflectance data for the user-defined 
land or water surface classes for visual exploring in which wavelength the classes differ. 
Input should be a shapefile with polygons of surface classes (it might be different habitat types, 
crops, vegetation, etc.). The Sentinel-2 L2A satellite mission optical bands pixel data 
are obtained through the Google Earth Engine service and used as a source of spectral data.
</p>


<h3>Currently spectralR package provides several main functions</h3>

<p><code><a href="#topic+get.pixel.data">get.pixel.data</a></code>
<code><a href="#topic+prepare.vector.data">prepare.vector.data</a></code>
<code><a href="#topic+spectral.curves.plot">spectral.curves.plot</a></code>
<code><a href="#topic+stat.summary.plot">stat.summary.plot</a></code>
<code><a href="#topic+violin.plot">violin.plot</a></code>
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Oleh Prylutskyi <a href="mailto:oleh.prylutskyi@gmail.com">oleh.prylutskyi@gmail.com</a>
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Dariia Shyriaieva <a href="mailto:darshyr@gmail.com">darshyr@gmail.com</a> [contributor]
</p>
</li>
<li><p> Vladimir Mikryukov <a href="mailto:vladimir.mikryukov@ut.ee">vladimir.mikryukov@ut.ee</a> [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/olehprylutskyi/spectralR/">https://github.com/olehprylutskyi/spectralR/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/olehprylutskyi/spectralR/issues">https://github.com/olehprylutskyi/spectralR/issues</a>
</p>
</li></ul>


<hr>
<h2 id='get.pixel.data'>Obtain Sentinel-2 spectral reflectance data for user-defined vector polygons</h2><span id='topic+get.pixel.data'></span>

<h3>Description</h3>

<p>The function takes sf polygon object, created through prepare.vector.data function, and
retrieves data frame with brightness values for each pixel intersected with polygons,
for each optical band of Sentinel-2 sensor, marked according to the label of surface
class from the polygons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.pixel.data(sf_data, startday, endday, cloud_threshold, scale_value)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.pixel.data_+3A_sf_data">sf_data</code></td>
<td>
<p>polygons of surface classes as a sf object, created through prepare.vector.data</p>
</td></tr>
<tr><td><code id="get.pixel.data_+3A_startday">startday</code></td>
<td>
<p>starting day for Sentinel image collection, as &quot;YYYY-MM-DD&quot;. See Note 1 below</p>
</td></tr>
<tr><td><code id="get.pixel.data_+3A_endday">endday</code></td>
<td>
<p>final day for Sentinel image collection, as &quot;YYYY-MM-DD&quot;</p>
</td></tr>
<tr><td><code id="get.pixel.data_+3A_cloud_threshold">cloud_threshold</code></td>
<td>
<p>maximum percent of cloud-covered pixels per image by which individual</p>
</td></tr>
<tr><td><code id="get.pixel.data_+3A_scale_value">scale_value</code></td>
<td>
<p>the scale of resulting satellite images in meters (pixel size). See Note 2 below</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe (non-spatial) with unscaled reflectance data for each pixel of median satellite
image, for each optical band of Sentinel-2 sensor, marked according to the label of surface class from
the polygons.
</p>
<p>Note 1.
Particular satellite imagery is typically not ready for instant analysis - it contains clouds,
cloud shadows, athmospheric aerosols, and may cover not all the territory of your interest.
Another issue is that each particular pixel slightly differs in reflectance
between images taken on different days due to differences in atmospheric conditions and angle
of sunlight at the moments images were taken. Google Earth Engine has its own build-in
algorithms for image pre-processing, atmospheric corrections and mosaicing, which allows to
obtain a ready-to-use, rectified image. The approach used in this script is to find a median
value for each pixel between several images within each of 10 optical bands and thereby make a
composite image. To define a set of imageries between which we will calculate the median,
we should set a timespan defining starting and final days. Sentinel-2 apparatus takes a picture
once a 5 days, so if you set up a month-long timesnap, you can expect each pixel value to be
calculated based on 5 to 6 values.
</p>
<p>Note 2.
You may set up any image resolution (pixel size) for satellite imagery with GEE, but this is
hardly reasonable to set the finer resolution than the finest for satellite source.
The finest resolution for Sentinel data is 10 m, while using higher scale_value requires less
computational resources and returns a smaller resulting dataframe. Although sampling
satellite data performs in a cloud, there are some memory limitations placed
by GEE itself. If you are about to sample really large areas, consider setting a higher 'scale'
value (100, 1000).
More about GEE best practices: https://developers.google.com/earth-engine/guides/best_practices
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# Downlad spectral reflectance data
reflectance &lt;-  get.pixel.data(
  sf_data = sf_df,
  startday = "2019-05-15",
  endday = "2019-06-30",
  cloud_threshold = 10,
  scale_value = 100)

head(reflectance)

## End(Not run)
</code></pre>

<hr>
<h2 id='prepare.vector.data'>Prepare vector data for further reflectance data sampling</h2><span id='topic+prepare.vector.data'></span>

<h3>Description</h3>

<p>The function takes shapefile with polygons of different surface classes (habitats, crops,
vegetation, etc.), and retrieves ready-for-sampling sf object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare.vector.data(shapefile_name, label_field)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prepare.vector.data_+3A_shapefile_name">shapefile_name</code></td>
<td>
<p>shapefile name (should be within working directory, using absolute
paths were not tested)</p>
</td></tr>
<tr><td><code id="prepare.vector.data_+3A_label_field">label_field</code></td>
<td>
<p>name of the field which contains class labels</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sf object with label (characters) and class (integer) variables, as well as geometry of each polygon,
ready to further processing by rgee.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load example data
load(system.file("testdata/reflectance_test_data.RData", package = "spectralR"))

# Prepare vector data
sf_df &lt;- prepare.vector.data(
  shapefile_name = system.file("extdata/test_shapefile.shp", package = "spectralR"),
  label_field = "veget_type")

head(sf_df)

</code></pre>

<hr>
<h2 id='spectral.curves.plot'>Make spectral reflectance curves for defined classes of surface</h2><span id='topic+spectral.curves.plot'></span>

<h3>Description</h3>

<p>Make spectral reflectance curves for defined classes of surface
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spectral.curves.plot(data, target_classes = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spectral.curves.plot_+3A_data">data</code></td>
<td>
<p>reflectance data as dataframe with pixel values for Sentinel optical bands
B2, B3, B4, B5, B6, B7, B8, B8A, B11, B12</p>
</td></tr>
<tr><td><code id="spectral.curves.plot_+3A_target_classes">target_classes</code></td>
<td>
<p>list of the classes of surface which should be highlighted, others
will be turned in gray, as a background. Defaults is NULL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 object with basic visual aesthetics, represents smoother lines with confidence
intervals for each surface class. Default aesthetic is smoother curve (geom_smooth).
May be time-consuming depending on input dataframe size.
See https://ggplot2.tidyverse.org/reference/geom_smooth.html for more details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load example data
load(system.file("testdata/reflectance_test_data.RData", package = "spectralR"))

# Create a plot
p &lt;- spectral.curves.plot(data = reflectance)

# Customize a plot
p +
  ggplot2::labs(x = 'Wavelength, nm', y = 'Reflectance',
      colour = "Surface classes",
      fill = "Surface classes",
      title = "Spectral reflectance curves for different classes of surface",
      caption = 'Data: Sentinel-2 Level-2A')+
  ggplot2::theme_minimal()

# Highlight only specific target classes
spectral.curves.plot(
  data = reflectance,
  target_classes = list("meadow", "coniferous_forest")
  )

</code></pre>

<hr>
<h2 id='stat.summary.plot'>Statistical summary plot of reflectance values</h2><span id='topic+stat.summary.plot'></span>

<h3>Description</h3>

<p>Make a plot with statistical summary of reflectance values (mean, mean-standard deviation,
mean+standard deviation) for defined classes of surface.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat.summary.plot(
  data,
  target_classes = NULL,
  point_size = 0.6,
  fatten = 4,
  x_dodge = 0.2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat.summary.plot_+3A_data">data</code></td>
<td>
<p>reflectance data as dataframe with pixel values for Sentinel optical bands
B2, B3, B4, B5, B6, B7, B8, B8A, B11, B12</p>
</td></tr>
<tr><td><code id="stat.summary.plot_+3A_target_classes">target_classes</code></td>
<td>
<p>list of the classes of surface which should be highlighted, others
will be turned in gray, as a background. Defaults is NULL.</p>
</td></tr>
<tr><td><code id="stat.summary.plot_+3A_point_size">point_size</code></td>
<td>
<p>Size of points on a plot</p>
</td></tr>
<tr><td><code id="stat.summary.plot_+3A_fatten">fatten</code></td>
<td>
<p>A multiplicative factor used to increase the size of points in comparison with standard deviation lines</p>
</td></tr>
<tr><td><code id="stat.summary.plot_+3A_x_dodge">x_dodge</code></td>
<td>
<p>Position adjustment of points along the X-axis</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 object with basic visual aesthetics.
Default aesthetics are line with statistical summary for each satellite band
([geom_line()] + [geom_pointrange()]).
See [geom_linerange](https://ggplot2.tidyverse.org/reference/geom_linerange.html) and
[geom_path](https://ggplot2.tidyverse.org/reference/geom_path.html) documentation
for more details.
</p>
<p>Wavelengths values (nm) acquired from mean known value for each optical band of Sentinel 2 sensor
https://en.wikipedia.org/wiki/Sentinel-2
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load example data
load(system.file("testdata/reflectance_test_data.RData", package = "spectralR"))

# Create a summary plot
p &lt;- stat.summary.plot(data = reflectance)

# Customize a plot
p +
  ggplot2::labs(x = 'Sentinel-2 bands', y = 'Reflectance',
      colour = "Surface classes",
      title = "Reflectance for different surface classes",
      caption='Data: Sentinel-2 Level-2A\nmean ± standard deviation')+
  ggplot2::theme_minimal()

# Highlight only specific target classes
stat.summary.plot(
   data = reflectance,
   target_classes = list("meadow", "coniferous_forest")
  )

</code></pre>

<hr>
<h2 id='violin.plot'>Create violin plots of reflectance per band for each surface class</h2><span id='topic+violin.plot'></span>

<h3>Description</h3>

<p>Create violin plots of reflectance per band for each surface class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>violin.plot(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="violin.plot_+3A_data">data</code></td>
<td>
<p>reflectance data as dataframe with pixel values for Sentinel optical bands
B2, B3, B4, B5, B6, B7, B8, B8A, B11, B12</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 object with basic visual aesthetics. Default aesthetics is
violin plot for each satellite band (geom_violin).
See https://ggplot2.tidyverse.org/reference/geom_violin.html for more details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load example data
load(system.file("testdata/reflectance_test_data.RData", package = "spectralR"))

# Create a plot
p3 &lt;- violin.plot(data = reflectance)

# Customize a plot
p3 +
  ggplot2::labs(x='Surface class',y='Reflectance',
      fill="Surface classes",
      title = "Reflectance for different surface classes",
      caption='Data: Sentinel-2 Level-2A')+
  ggplot2::theme_minimal()

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
