<!DOCTYPE html><html lang="en"><head><title>Help for package ecolMod</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ecolMod}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ecolMod-package'>
<p>A practical guide to ecological modelling - using R as</p>
a simulation platform</a></li>
<li><a href='#deepCmin'><p>results of the calibration exercise from chapter 4.4.4</p></a></li>
<li><a href='#dilution'><p>Draws dilution culture setup</p></a></li>
<li><a href='#OMEXDIAsteady'><p>steady-state application of the OMEXDIA diagenetic model - fortran DLL</p></a></li>
<li><a href='#pricefit'><p>Pseudo-random search algorithm of Price (1997)</p></a></li>
<li><a href='#SCOC'><p>a Sediment Community Oxygen Consumption (SCOC) dataset</p></a></li>
<li><a href='#Zoogrowth'><p>a zooplankton growth dataset</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.2.6.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-11-13</td>
</tr>
<tr>
<td>Title:</td>
<td>"A Practical Guide to Ecological Modelling - Using R as a
Simulation Platform"</td>
</tr>
<tr>
<td>Author:</td>
<td>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;, Peter MJ Herman &lt;peter.herman@nioz.nl&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.01), rootSolve, shape, diagram, deSolve</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, grDevices</td>
</tr>
<tr>
<td>Suggests:</td>
<td>maps, seacarb, scatterplot3d, deldir</td>
</tr>
<tr>
<td>Description:</td>
<td>Figures, data sets and examples from the book "A practical guide to ecological modelling - using R as a simulation platform" by Karline Soetaert and Peter MJ Herman (2009). Springer.
  All figures from chapter x can be generated by "demo(chapx)", where x = 1 to 11. 
  The R-scripts of the model examples discussed in the book are in subdirectory "examples", ordered per chapter.
  Solutions to model projects are in the same subdirectories.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-13 16:27:33 UTC; karlines</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-15 19:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='ecolMod-package'>
A practical guide to ecological modelling - using R as
a simulation platform
</h2><span id='topic+ecolMod-package'></span><span id='topic+ecolMod'></span>

<h3>Description</h3>

<p>Figures, data sets and examples from the book &quot;A
practical guide to ecological modelling - using R as a
simulation platform&quot; by Karline Soetaert and Peter MJ
Herman (2009). Springer, 372 pp.
</p>
<p>http://www.springer.com/life+sciences/ecology/book/978-1-4020-8623-6
</p>
<p>All figures from chapter x can
be generated by <code>demo(chapx)</code>, where x = 1 to 11.
</p>
<p>The R-scripts of the model examples discussed in the book
are in subdirectory &quot;examples&quot;, ordered per chapter.
</p>
<p>Solutions to model projects are in the same subdirectories.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
    Package: </td><td style="text-align: left;"> ecolMod</td>
</tr>
<tr>
 <td style="text-align: left;">
    Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
    Version: </td><td style="text-align: left;"> 1.2.3</td>
</tr>
<tr>
 <td style="text-align: left;">
    Date: </td><td style="text-align: left;"> 2011-03-15</td>
</tr>
<tr>
 <td style="text-align: left;">
    License: </td><td style="text-align: left;"> GNU Public License 2 or above</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Karline Soetaert (Maintainer) and Peter M.J. Herman
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+OMEXDIAsteady">OMEXDIAsteady</a></code> steady-state application of the OMEXDIA
diagenetic model - a fortran DLL
</p>
</li>
<li> <p><code><a href="#topic+SCOC">SCOC</a></code> a Sediment Community Oxygen Consumption (SCOC) dataset
</p>
</li>
<li> <p><code><a href="#topic+Zoogrowth">Zoogrowth</a></code>a zooplankton growth dataset
</p>
</li>
<li> <p><code><a href="#topic+deepCmin">deepCmin</a></code>  results of the calibration exercise from chapter 4.4.4
</p>
</li>
<li> <p><code><a href="#topic+dilution">dilution</a></code>  Draws dilution culture setup
</p>
</li>
<li> <p><code><a href="#topic+pricefit">pricefit</a></code>  Pseudo-random search algorithm of Price (1997)
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## show examples (see respective help pages for details)
example(pricefit)
example(SCOC)

## run demos
demo("chap1") # chapter 1. Introduction
demo("chap2") # chapter 2. Model formulation
demo("chap3") # chapter 3. Spatial components and transport
demo("chap4") # chapter 4. Parameterisation
demo("chap5") # chapter 5. Model solution - analytical methods
demo("chap6") # chapter 6. Model solution - numerical methods
demo("chap7") # chapter 7. Stability and steady-state
demo("chap8") # chapter 8. Multiple time scales and equilibrium processes
demo("chap9") # chapter 9. Discrete time models
demo("chap10") # chapter 10. Dynamic programming
demo("chap11") # chapter 11. Testing and validating the model

## open the directory with source code of demos
browseURL(paste(system.file(package="ecolMod"), "/demo", sep=""))

## open the directory with book examples
browseURL(paste(system.file(package="ecolMod"), "/doc/examples", sep=""))

## ecolMod vignette:
vignette("ecolMod")

## End(Not run)
</code></pre>

<hr>
<h2 id='deepCmin'>results of the calibration exercise from chapter 4.4.4</h2><span id='topic+deepCmin'></span>

<h3>Description</h3>

<p>This datafile contains output from the calibration exercise from
chapter 4.4.4. They are:
<br /> vectors <code>kseries</code>, <code>multser</code>
<br /> vector <code>outcost</code>
<br /> matrices <code>optpar</code>, <code>optpar20</code>, <code>optpar25</code></p>


<h3>Usage</h3>

<pre><code class='language-R'>deepCmin</code></pre>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>pgr &lt;- gray.colors(n = 25, start = 0.95, end = 0.0)
with (deepCmin,
filled.contour(x = multser, y = kseries, z = outcost,
   ylab = "k (/day)", xlab = "multiplication factor (-)",
   main = "Model cost landscape", col = pgr, nlevels = 25,
   plot.axes = {
     axis(1); axis(2);
     points(optpar20$poppar[,2], optpar20$poppar[,1], pch = "o", cex = .5);
     points(optpar25$poppar[,2], optpar25$poppar[,1], pch = "+", cex = 1);
     points(optpar$par[2], optpar$par[1], pch = 16, cex = 2)
   }
)
)</code></pre>

<hr>
<h2 id='dilution'>Draws dilution culture setup</h2><span id='topic+dilution'></span>

<h3>Description</h3>

<p>Draws the framework of a dilution culture. Used as a template to plot the 
flow diagrams for dilution-type models, where there is a continuous inflow of medium from 
a vessel into a well-stirred tank (the culture vessel). The volume in the culture tank stays constant.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dilution(main = c("",""), int = "")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dilution_+3A_main">main</code></td>
<td>
<p>main text, consiting of two strings, positioned above medium vessel (1st string) and culture vessel (2nd string) of dilution diagram plot</p>
</td></tr>
<tr><td><code id="dilution_+3A_int">int</code></td>
<td>
<p>text above the dripping outlets</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing:
</p>
<table role = "presentation">
<tr><td><code>p1</code></td>
<td>
<p>two-valued vector with the x-y positions of the middle of the (large) culture vessel</p>
</td></tr>
<tr><td><code>p2</code></td>
<td>
<p>two-valued vector with the x-y positions of the middle of the (small) medium vessel</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>par(mar = c(0, 0, 0, 0))                         
dd &lt;- dilution(main = c("Stock", "Stirred tank"), int = "Flow,Q")
text(dd$p2[1], dd$p2[2], "Ain", font = 2)
text(dd$p1[1], dd$p1[2]+0.03, "Volume V", font = 2)
text(dd$p1[1], dd$p1[2]-0.03, "[A]", font = 2)</code></pre>

<hr>
<h2 id='OMEXDIAsteady'>steady-state application of the OMEXDIA diagenetic model - fortran DLL</h2><span id='topic+OMEXDIAsteady'></span>

<h3>Description</h3>

<p>A 1-D model of Carbon, nitrogen and oxygen diagenesis in a marine sediment.
<br /> The model describes six state variables, in <b>100</b> layers:
</p>

<ul>
<li><p> 2 fractions of organic carbon (FDET,SDET): fast and slow decaying, solid substance
</p>
</li>
<li><p> Oxygen (O2), dissolved substance
</p>
</li>
<li><p> Nitrate (NO3), dissolved substance
</p>
</li>
<li><p> Ammonium (NH3), dissolved substance
</p>
</li>
<li><p> Oxygen demand unit (ODU), dissolved substance, as lump sum of all reduced substances other than ammonium
</p>
</li></ul>

<p>See Soetaert et al., 1996 for further details of the model.
</p>
<p>This is a simplified version of the OMEXDIA model, added just to create a figure in the book.
<br /> A more complete version will be published in a separate R-package that will deal with reactive transport modelling in R.
<br /> The name of this package is not yet decided upon.</p>


<h3>Usage</h3>

<pre><code class='language-R'>OMEXDIAsteady()</code></pre>


<h3>Details</h3>

<p>The model application just estimates the steady-state condition of the OMEXDIA model, the parameter values are such that there
is almost no overlap between the oxic and anoxic zone of the sediment.
</p>
<p>For efficiency reasons, the OMEXDIA diagenetic model was written in Fortran, and this code linked to
the package.</p>


<h3>Value</h3>

<p>a list containing:
</p>
<table role = "presentation">
<tr><td><code>steady</code></td>
<td>
<p>The steady-state condition of the state variables, a vector containing steady-state concentrations of
FDET(0-100), SDET(101-200), O2 (201-300), NO3 (301-400), NH3 (401-500) and ODU (501-600)</p>
</td></tr>
<tr><td><code>precis</code></td>
<td>
<p>the precision of the steady-state solution</p>
</td></tr>
<tr><td><code>Solved</code></td>
<td>
<p>a logical, TRUE when steady-state has been reached </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Soetaert K, PMJ Herman and JJ Middelburg, 1996a.
A model of early diagenetic processes from the shelf to abyssal depths.
Geochimica Cosmochimica Acta, 60(6):1019-1040.
</p>
<p>Soetaert K, PMJ Herman and JJ Middelburg, 1996b.
Dynamic response of deep-sea sediments to seasonal variation: a model.
Limnol. Oceanogr. 41(8): 1651-1668.</p>


<h3>Examples</h3>

<pre><code class='language-R'>N      &lt;- 100
Depth  &lt;- seq(0.05, by = 0.1, len = 100)
out    &lt;- OMEXDIAsteady()

# Steady-state concentrations in sediment
CONC  &lt;- out$steady

FDET  &lt;- CONC[1:N]
SDET  &lt;- CONC[(N+1)  :(2*N)]
O2    &lt;- CONC[(2*N+1):(3*N)]
NO3   &lt;- CONC[(3*N+1):(4*N)]
NH3   &lt;- CONC[(4*N+1):(5*N)]
ODU   &lt;- CONC[(5*N+1):(6*N)]

TOC  &lt;- (FDET+SDET)*1200/10^9/2.5     # % organic carbon (excess)

par(mfrow=c(2, 2))
plot(TOC, Depth, ylim = c(10, 0), xlab = "procent", main = "TOC",
        type = "l", lwd=2)
plot(O2, Depth, ylim = c(10, 0), xlab = "mmol/m3", main = "O2",
        type = "l", lwd = 2)
plot(NO3, Depth, ylim = c(10, 0), xlab = "mmol/m3", main = "NO3",
        type = "l", lwd = 2)
plot(NH3, Depth, ylim = c(10, 0), xlab = "mmol/m3", main = "NH3",
        type = "l", lwd = 2)


mtext(outer=TRUE,side=3,line=-2,cex=1.5,"OMEXDIAmodel")</code></pre>

<hr>
<h2 id='pricefit'>Pseudo-random search algorithm of Price (1997)</h2><span id='topic+pricefit'></span>

<h3>Description</h3>

<p>Pseudo-random search algorithm of Price (1997). Used in the book as an example of
a random-based fitting technique, and as an example of how to create a function in R.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pricefit(par, minpar = rep(-1e8, length(par)),
         maxpar = rep(1e8, length(par)), func, 
         npop = max(5*length(par),50),
         numiter =10000, centroid = 3, varleft = 1e-8,...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pricefit_+3A_par">par</code></td>
<td>
<p>initial values of the parameters to be optimised</p>
</td></tr>
<tr><td><code id="pricefit_+3A_minpar">minpar</code></td>
<td>
<p>minimal values of the parameters to be optimised</p>
</td></tr>
<tr><td><code id="pricefit_+3A_maxpar">maxpar</code></td>
<td>
<p>maximal values of the parameters to be optimised</p>
</td></tr>
<tr><td><code id="pricefit_+3A_func">func</code></td>
<td>
<p>function to be minimised, its first argument should bw the vector of parameters
over which minimization is to take place. It should return a scalar result, the model cost, e.g the sum of squared residuals.</p>
</td></tr>
<tr><td><code id="pricefit_+3A_npop">npop</code></td>
<td>
<p>number of elements in population</p>
</td></tr>
<tr><td><code id="pricefit_+3A_numiter">numiter</code></td>
<td>
<p>number of iterations to be performed. Defaults to 10000. There is no other stopping criterion. </p>
</td></tr>
<tr><td><code id="pricefit_+3A_centroid">centroid</code></td>
<td>
<p>number of elements from which to estimate new parameter vector</p>
</td></tr>
<tr><td><code id="pricefit_+3A_varleft">varleft</code></td>
<td>
<p>relative variation remaining; if below this value algorithm stops</p>
</td></tr>
<tr><td><code id="pricefit_+3A_...">...</code></td>
<td>
<p>arguments passed to funtion func</p>
</td></tr>
</table>


<h3>Details</h3>

<p>see the book of Soetaert and Herman for a description of the algorithm AND for a line to line explanation of the function code.</p>


<h3>Value</h3>

<p>a list containing:
</p>
<table role = "presentation">
<tr><td><code>par</code></td>
<td>
<p>the optimised parameter values</p>
</td></tr>
<tr><td><code>cost</code></td>
<td>
<p>the model cost, or function evaluation associated to the optimised parameter values, i.e. the minimal cost</p>
</td></tr>
<tr><td><code>poppar</code></td>
<td>
<p>all parameter vectors remaining in the population, matrix of dimension (npop,length(par))</p>
</td></tr>
<tr><td><code>popcost</code></td>
<td>
<p>model costs associated with all population parameter vectors, vector of length npop</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Soetaert, K. and P.M.J. Herman, 2009.
A Practical Guide to Ecological Modelling. Using R as a Simulation Platform.
Springer, 372 pp.
</p>
<p>Price, W.L., 1977.  A controlled random search procedure for global optimisation.
The Computer Journal, 20: 367-370.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+optim">optim</a></code> the R default.</p>


<h3>Examples</h3>

<pre><code class='language-R'>pricefit  # will display the code 

amp    &lt;- 6
period &lt;- 5
phase  &lt;- 0.5

x &lt;- runif(20)*13 
y &lt;- amp*sin(2*pi*x/period+phase) + rnorm(20, mean = 0, sd = 0.05)
plot(x, y, pch = 16)


cost &lt;- function(par) sum((par[1]*sin(2*pi*x/par[2]+par[3])-y)^2)

p1 &lt;- optim(par = c(amplitude = 1, phase = 1, period = 1), cost)
p2 &lt;- optim(par = c(amplitude = 1, phase = 1, period = 1), cost,
            method = "SANN")
p3 &lt;- pricefit(par = c(amplitude = 1, phase = 1, period = 1),
            minpar = c(0, 1e-8,0), maxpar = c(100, 2*pi,100), 
            func = cost, numiter = 3000)

curve(p1$par[1]*sin(2*pi*x/p1$par[2] + p1$par[3]), lty = 2, add = TRUE)
curve(p2$par[1]*sin(2*pi*x/p2$par[2] + p2$par[3]), lty = 3, add = TRUE)
curve(p3$par[1]*sin(2*pi*x/p3$par[2] + p3$par[3]), lty = 1, add = TRUE)

legend ("bottomright", lty = c(1, 2, 3),
        c("Price", "Mathematical", "Simulated annealing"))</code></pre>

<hr>
<h2 id='SCOC'>a Sediment Community Oxygen Consumption (SCOC) dataset</h2><span id='topic+SCOC'></span>

<h3>Description</h3>

<p>This literature dataset, compiled by Andersson et al. (2004) contains 584 measurements
of sediment community oxygen consumption rates, as a function of water depth, and performed in deep-water sediments, either by in situ incubations or via modelling of oxygen microprofiles.
</p>
<p>It is used in the book to demonstrate how one can obtain order-of-magnitude estimates
of model parameters (i.c. sediment oxygen consumption rate, a measure of deposition flux) by
performing log-log regression with water depth.</p>


<h3>Usage</h3>

<pre><code class='language-R'>SCOC</code></pre>


<h3>Format</h3>

<p>a dataframe with 584 rows, and with following columns:
<br /> Depth.m, the water depth at which the measurement was performed.
<br /> SCOC.mmol/m2/d, the oxygen consumption rate of the sediment, [mmolO2/m2/d]</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Andersson, H., Wijsman, J., Herman, P., Middelburg, J., Soetaert, K., Heip, C., 2004. Respiration patterns in the deep ocean. Geophysical Research Letters 31, LO3304.</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zoogrowth">Zoogrowth</a></code>, a dataset containing zooplankton maximal growth rates
<br /> see the paper of Andersson et al. for a description of the original literature sources of this dataset</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(SCOC[,1], SCOC[,2], log = "xy", xlab = "water depth, m",
     ylab = "", main = "SCOC, mmol O2/m2/d", pch = 16,
     xaxt = "n", yaxt = "n", cex.main = 1)

axis(1, at = c(0.5, 5, 50, 500, 5000), 
     labels = c("0.5", "5", "50", "500", "5000"))
axis(2, at = c(0.1, 1, 10, 100), 
     labels = c("0.1", "1", "10", "100"))

ll &lt;- lm(log(SCOC[,2])~ log(SCOC[,1]))
rr &lt;- summary(ll)$r.squared
A  &lt;- exp(coef(ll)[1])
B  &lt;- (coef(ll)[2])
curve(A*x^B, add = TRUE, lwd = 2)
AA &lt;- round(A*100)/100
BB &lt;- round(B*100)/100
expr &lt;- substitute(y==A*x^B, list(A=AA,B=BB))
text(1, .1, expr, adj = 0)
expr2 &lt;- substitute(r^2==rr, list(rr=round(rr*100)/100))
text(1, 0.04, expr2, adj = 0)</code></pre>

<hr>
<h2 id='Zoogrowth'>a zooplankton growth dataset</h2><span id='topic+Zoogrowth'></span>

<h3>Description</h3>

<p>This literature dataset, compiled by Hansen et al. (1997) contains 84 measurements
of maximal growth rates as a function of organism volume and temperature for
various species of zooplankton. The maximal growth rates were obtained from laboratory experiments.
</p>
<p>It is used in the book to demonstrate how one can obtain order-of-magnitude estimates
of model parameters (i.c. maximal growth) via allometric relations, i.e. by
performing log-log regression of organism rates versus size.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Zoogrowth</code></pre>


<h3>Format</h3>

<p>a dataframe with 84 rows, and with following columns:
<br /> Volume.um3, the volume in [um 3].
<br /> Mumax.hr, the maximal growht rate, [/hour]
<br /> Species, the name of reared zooplankton species
<br /> Temp.dgC, the rearing temperature, [dg C]
<br /> Group, the systematic group to which the organism belongs, one of Nanoflagellate,
Dinoflagellate, Ciliate, Rotifer, Meroplankton, Copepod</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Hansen PJ, Bjornsen PK, Hansen BW, 1997. Zooplankton grazing and growth: Scaling within the 2-2,000-mu m body size range. Limnology and Oceanograpy 42: 687-704.</p>


<h3>See Also</h3>

<p><code><a href="#topic+SCOC">SCOC</a></code>, a dataset containing sediment community oxygen consumption rates
<br /> see the paper of Hansen et al. 1997 for a description of the original literature sources of this dataset</p>


<h3>Examples</h3>

<pre><code class='language-R'>ii &lt;- which(Zoogrowth[ ,2]&gt;0)
plot(Zoogrowth[ii, 1], Zoogrowth[ii, 2], log = "xy",
     xlab = "zooplankton volume, micrometer ^ 3", ylab = "" ,
     main = "maximal growth rate, /hr", pch = 16, cex.main = 1)

ll &lt;- lm(log(Zoogrowth[ii,2])~ log(Zoogrowth[ii,1]))
rr &lt;- summary(ll)$r.squared
A  &lt;- exp(coef(ll)[1])
B  &lt;- (coef(ll)[2])
curve(A*x^B, add = TRUE, lwd = 2)
AA &lt;- round(A*100)/100
BB &lt;- round(B*100)/100
expr &lt;- substitute(y==A*x^B, list(A=AA,B=BB))
text(100, .0035, expr, adj = 0)
expr2 &lt;- substitute(r^2==rr, list(rr=round(rr*100)/100))
text(100, 0.002, expr2, adj = 0)</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
