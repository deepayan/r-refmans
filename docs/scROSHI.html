<!DOCTYPE html><html lang="en"><head><title>Help for package scROSHI</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {scROSHI}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#config'><p>Test config file</p></a></li>
<li><a href='#f_annot_ctgenes'><p>Choose best matching cell type</p></a></li>
<li><a href='#f_my_correlation_test'><p>Spearman correlation test</p></a></li>
<li><a href='#f_my_wilcox_test'><p>Wilcox test</p></a></li>
<li><a href='#f_score_ctgenes_U'><p>Calculate cell type score</p></a></li>
<li><a href='#f_score_profile_cor'><p>Calculate cell type score: U-test</p></a></li>
<li><a href='#marker_list'><p>Marker gene list for the test SCE data Set</p></a></li>
<li><a href='#scROSHI'><p>Robust Supervised Hierarchical Identification of Single Cells</p></a></li>
<li><a href='#test_sce_data'><p>Test SCE Data Set</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Robust Supervised Hierarchical Identification of Single Cells</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lars Bosshard &lt;bosshard@nexus.ethz.ch&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Identifying cell types based on expression profiles is a pillar of single cell analysis. 'scROSHI' identifies cell types based on expression profiles of single cell analysis by utilizing previously obtained cell type specific gene sets. It takes into account the hierarchical nature of cell type relationship and does not require training or annotated data. A detailed description of the method can be found at: Prummer, Bertolini, Bosshard, Barkmann, Yates, Boeva, The Tumor Profiler Consortium, Stekhoven, and Singer (2022) &lt;<a href="https://doi.org/10.1101%2F2022.04.05.487176">doi:10.1101/2022.04.05.487176</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>limma, S4Vectors, SingleCellExperiment, stats,
SummarizedExperiment, utils, uwot</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.60)</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>xz</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-09 09:38:17 UTC; bolars</td>
</tr>
<tr>
<td>Author:</td>
<td>Lars Bosshard <a href="https://orcid.org/0000-0002-4550-4777"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Michael Prummer <a href="https://orcid.org/0000-0001-9896-3929"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-10 13:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='config'>Test config file</h2><span id='topic+config'></span>

<h3>Description</h3>

<p>Config file for the test_sce_data set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>config
</code></pre>


<h3>Format</h3>

<p>A data frame with 2 columns and 7 rows
</p>


<h3>Details</h3>

<p>Config file to define major cell types and hierarchical subtypes.
It should be provided as a two-column data.frame where the first column are
the major cell types and the second column are the subtypes. If several
subtypes exists, they should be separated by comma.
</p>


<h3>Source</h3>

<p>scROSHI - robust supervised hierarchical identification of single cells
<a href="https://www.biorxiv.org/content/10.1101/2022.04.05.487176v1">https://www.biorxiv.org/content/10.1101/2022.04.05.487176v1</a>
</p>

<hr>
<h2 id='f_annot_ctgenes'>Choose best matching cell type</h2><span id='topic+f_annot_ctgenes'></span>

<h3>Description</h3>

<p>Choose best matching cell type
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_annot_ctgenes(m.cts, unknown, uncertain)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f_annot_ctgenes_+3A_m.cts">m.cts</code></td>
<td>
<p>Matrix containing the cell type scores. The rows represent the cell types, whereas the columns represent the samples.</p>
</td></tr>
<tr><td><code id="f_annot_ctgenes_+3A_unknown">unknown</code></td>
<td>
<p>If none of the probabilities is above this threshold,
the cell type label is assigned to the class unknown.</p>
</td></tr>
<tr><td><code id="f_annot_ctgenes_+3A_uncertain">uncertain</code></td>
<td>
<p>If the ratio between the largest and the second largest
probability is below this threshold, the cell type label is assigned to the
class uncertain for the major cell types.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing the best matching cell type for each sample.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m.cts &lt;- matrix(c(0.2, 0.001, 0.002, 0.1), nrow=2)
colnames(m.cts) &lt;- c("sample1", "sample2")
rownames(m.cts) &lt;- c("cell_type1", "cell_type2")
f_annot_ctgenes(m.cts, 0.05, 0.1)
</code></pre>

<hr>
<h2 id='f_my_correlation_test'>Spearman correlation test</h2><span id='topic+f_my_correlation_test'></span>

<h3>Description</h3>

<p>Calculate spearman correlation p-value or return preset values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_my_correlation_test(x, y, min_genes = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f_my_correlation_test_+3A_x">x</code></td>
<td>
<p>A numeric vector of values.</p>
</td></tr>
<tr><td><code id="f_my_correlation_test_+3A_y">y</code></td>
<td>
<p>A numeric vector of values.</p>
</td></tr>
<tr><td><code id="f_my_correlation_test_+3A_min_genes">min_genes</code></td>
<td>
<p>A numeric value defining the threshold for the minimum number of genes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric value representing the p value of the Spearman correlation test.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f_my_correlation_test(rnorm(10,1,2),rnorm(10,5,2))
</code></pre>

<hr>
<h2 id='f_my_wilcox_test'>Wilcox test</h2><span id='topic+f_my_wilcox_test'></span>

<h3>Description</h3>

<p>Calculate Wilcox p-value or return preset values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_my_wilcox_test(x, y, min_genes = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f_my_wilcox_test_+3A_x">x</code></td>
<td>
<p>A numeric vector of values.</p>
</td></tr>
<tr><td><code id="f_my_wilcox_test_+3A_y">y</code></td>
<td>
<p>A numeric vector of values.</p>
</td></tr>
<tr><td><code id="f_my_wilcox_test_+3A_min_genes">min_genes</code></td>
<td>
<p>A numeric value defining the threshold for the minimum number of genes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric value representing the p value of the Wilcox test.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f_my_wilcox_test(rnorm(10, 1, 2), rnorm(10, 5, 2))
</code></pre>

<hr>
<h2 id='f_score_ctgenes_U'>Calculate cell type score</h2><span id='topic+f_score_ctgenes_U'></span>

<h3>Description</h3>

<p>Calculate cell type score
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_score_ctgenes_U(
  sce,
  gset,
  count_data = "normcounts",
  gene_symbol = "SYMBOL",
  min_genes = 5,
  verbose = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f_score_ctgenes_U_+3A_sce">sce</code></td>
<td>
<p>A SingleCellExperiment object containing the expression
profiles of the single cell analysis.</p>
</td></tr>
<tr><td><code id="f_score_ctgenes_U_+3A_gset">gset</code></td>
<td>
<p>Marker gene list for all cell types.</p>
</td></tr>
<tr><td><code id="f_score_ctgenes_U_+3A_count_data">count_data</code></td>
<td>
<p>Assay name in the SingleCellExperiment object containing the count data.</p>
</td></tr>
<tr><td><code id="f_score_ctgenes_U_+3A_gene_symbol">gene_symbol</code></td>
<td>
<p>Variable name in the row data of the SingleCellExperiment object containing the gene names.</p>
</td></tr>
<tr><td><code id="f_score_ctgenes_U_+3A_min_genes">min_genes</code></td>
<td>
<p>Minimum number of genes.</p>
</td></tr>
<tr><td><code id="f_score_ctgenes_U_+3A_verbose">verbose</code></td>
<td>
<p>Level of verbosity. Zero means silent, one makes a verbose output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix containing the cell type scores. The rows represent the cell types, whereas the columns represent the samples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("test_sce_data")
gset &lt;- list(cell_type1 = c("CD79A", "TCL1A", "VPREB3"),
cell_type2 = c("FCER1A", "CLEC10A", "ENHO"))
f_score_ctgenes_U(test_sce_data[,1:3], gset, count_data = "normcounts",
gene_symbol = "SYMBOL", min_genes = 3, verbose = 0)

</code></pre>

<hr>
<h2 id='f_score_profile_cor'>Calculate cell type score: U-test</h2><span id='topic+f_score_profile_cor'></span>

<h3>Description</h3>

<p>Calculate cell type score: U-test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_score_profile_cor(sce, lprof, min_genes = 5, verbose = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f_score_profile_cor_+3A_sce">sce</code></td>
<td>
<p>A SingleCellExperiment object containing the expression
profiles of the single cell analysis.</p>
</td></tr>
<tr><td><code id="f_score_profile_cor_+3A_lprof">lprof</code></td>
<td>
<p>List of profiles (named expression vectors).</p>
</td></tr>
<tr><td><code id="f_score_profile_cor_+3A_min_genes">min_genes</code></td>
<td>
<p>Minimum number of genes.</p>
</td></tr>
<tr><td><code id="f_score_profile_cor_+3A_verbose">verbose</code></td>
<td>
<p>Level of verbosity. Zero means silent, one makes a verbose output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix containing the cell type scores.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("test_sce_data")
set.seed(123)
prof1 &lt;- rpois(n = 20, lambda = 3)
names(prof1) &lt;- rownames(test_sce_data)[51:70]
prof2 &lt;- rpois(n = 20, lambda = 5)
names(prof2) &lt;-  rownames(test_sce_data)[71:90]
lprof &lt;- list(prof1 = prof1, prof2 = prof2)
f_score_profile_cor(test_sce_data[,1:3], lprof, min_genes = 5, verbose = 0)

</code></pre>

<hr>
<h2 id='marker_list'>Marker gene list for the test SCE data Set</h2><span id='topic+marker_list'></span>

<h3>Description</h3>

<p>Marker gene list for the test_sce_data set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marker_list
</code></pre>


<h3>Format</h3>

<p>Marker gene list for all cell types as a list of genes with cell types as names
</p>


<h3>Source</h3>

<p>scROSHI - robust supervised hierarchical identification of single cells
<a href="https://www.biorxiv.org/content/10.1101/2022.04.05.487176v1">https://www.biorxiv.org/content/10.1101/2022.04.05.487176v1</a>
</p>

<hr>
<h2 id='scROSHI'>Robust Supervised Hierarchical Identification of Single Cells</h2><span id='topic+scROSHI'></span>

<h3>Description</h3>

<p>Identifying cell types based on expression profiles is a pillar of single cell analysis.
</p>
<p>scROSHI identifies cell types based on expression profiles of single cell analysis by
utilizing previously obtained cell type specific gene sets. It takes into account the
hierarchical nature of cell type relationship and does not require training or
annotated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scROSHI(
  sce_data,
  celltype_lists,
  type_config,
  count_data = "normcounts",
  gene_symbol = "SYMBOL",
  cell_scores = FALSE,
  min_genes = 5,
  min_var = 1.5,
  n_top_genes = 2000,
  n_nn = 5,
  thresh_unknown = 0.05,
  thresh_uncert = 0.1,
  thresh_uncert_second = 0.8,
  verbose = 0,
  output = "sce"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scROSHI_+3A_sce_data">sce_data</code></td>
<td>
<p>A SingleCellExperiment object containing the expression
profiles of the single cell analysis.</p>
</td></tr>
<tr><td><code id="scROSHI_+3A_celltype_lists">celltype_lists</code></td>
<td>
<p>Marker gene list for all cell types. It can be provided
as a list of genes with cell types as names or as a path to a file containing the
marker genes. Supported file formats are .gmt or .gmx files.</p>
</td></tr>
<tr><td><code id="scROSHI_+3A_type_config">type_config</code></td>
<td>
<p>Config file to define major cell types and hierarchical subtypes.
It should be provided as a two-column data.frame where the first column are the
major cell types and the second column are the subtypes. If several subtypes exists,
they should be separated by comma.</p>
</td></tr>
<tr><td><code id="scROSHI_+3A_count_data">count_data</code></td>
<td>
<p>Assay name in the SingleCellExperiment object containing the count data.</p>
</td></tr>
<tr><td><code id="scROSHI_+3A_gene_symbol">gene_symbol</code></td>
<td>
<p>Variable name in the row data of the SingleCellExperiment object containing the gene names.</p>
</td></tr>
<tr><td><code id="scROSHI_+3A_cell_scores">cell_scores</code></td>
<td>
<p>Boolean value determining if the scores should be saved.</p>
</td></tr>
<tr><td><code id="scROSHI_+3A_min_genes">min_genes</code></td>
<td>
<p>scROSHI filters out non-unique genes as long as more than min_genes
are left. If there is a cell type that has less than min_genes genes, it will be
replaced with the cell type list BEFORE filtering for unique genes (default 5).</p>
</td></tr>
<tr><td><code id="scROSHI_+3A_min_var">min_var</code></td>
<td>
<p>Minimum variance for highly variable genes (default 1.5).</p>
</td></tr>
<tr><td><code id="scROSHI_+3A_n_top_genes">n_top_genes</code></td>
<td>
<p>Maximum number of highly variable genes (default 2000).</p>
</td></tr>
<tr><td><code id="scROSHI_+3A_n_nn">n_nn</code></td>
<td>
<p>Number of nearest neighbors for umap for assignment of cell types
(default 5).</p>
</td></tr>
<tr><td><code id="scROSHI_+3A_thresh_unknown">thresh_unknown</code></td>
<td>
<p>If none of the probabilities is above this threshold,
the cell type label is assigned to the class unknown (default 0.05).</p>
</td></tr>
<tr><td><code id="scROSHI_+3A_thresh_uncert">thresh_uncert</code></td>
<td>
<p>If the ratio between the largest and the second largest
probability is below this threshold, the cell type label is assigned to the
class uncertain for the major cell types (default 0.1).</p>
</td></tr>
<tr><td><code id="scROSHI_+3A_thresh_uncert_second">thresh_uncert_second</code></td>
<td>
<p>If the ratio between the largest and the second largest
probability is below this threshold, the cell type label is assigned to the
class uncertain for the subtypes (default 0.8).</p>
</td></tr>
<tr><td><code id="scROSHI_+3A_verbose">verbose</code></td>
<td>
<p>Level of verbosity. Zero means silent, one makes a verbose output.</p>
</td></tr>
<tr><td><code id="scROSHI_+3A_output">output</code></td>
<td>
<p>Defines the output. sce: The output is a SingleCellExperiment
object with the cell types appended to the meta data. df: The output id a
data.frame with two columns. The first column contains the barcode of the cell
and the second column contains the cell type labels.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
data("test_sce_data")
data("config")
data("marker_list")

results &lt;- scROSHI(sce_data = test_sce_data,
                   celltype_lists = marker_list,
                   type_config = config)
table(results$celltype_final)

</code></pre>

<hr>
<h2 id='test_sce_data'>Test SCE Data Set</h2><span id='topic+test_sce_data'></span>

<h3>Description</h3>

<p>Data from a peripheral blood mononuclear cell experiments from an adult human.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_sce_data
</code></pre>


<h3>Format</h3>

<p>A SingleCellExperiment object with 3368 genes and 1316 cells
</p>


<h3>Source</h3>

<p>scROSHI - robust supervised hierarchical identification of single cells
<a href="https://www.biorxiv.org/content/10.1101/2022.04.05.487176v1">https://www.biorxiv.org/content/10.1101/2022.04.05.487176v1</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
