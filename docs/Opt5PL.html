<!DOCTYPE html><html lang="en"><head><title>Help for package Opt5PL</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Opt5PL}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#c_weight'><p>One iteration to run Newton Raphson to get c-optimal weights</p>
</p></a></li>
<li><a href='#c_weight_1'><p>The first derivative of the c-optimality criterion w.r.t the model parameters</p></a></li>
<li><a href='#c_weight_2'><p>The second derivative of the c-optimality criterion with respect to the model parameters</p></a></li>
<li><a href='#D_weight'><p>One iteration to run Newton Raphson to get D-optimal weights</p>
</p></a></li>
<li><a href='#D_weight_1'><p>The first derivative of the D-optimality criterion w.r.t the model parameters</p></a></li>
<li><a href='#D_weight_2'><p>The second derivative of the D-optimality criterion w.r.t the model parameters</p></a></li>
<li><a href='#D1'><p>Computing each element of the function c_weight_1</p></a></li>
<li><a href='#d11'><p>Computing each element of the function DD_weight_1</p></a></li>
<li><a href='#DD_weight'><p>One iteration to run Newton Raphson to get Ds-optimal weights</p>
</p></a></li>
<li><a href='#DD_weight_1'><p>The first derivative of the Ds-optimality criterion with respect to the model parameters</p></a></li>
<li><a href='#DD_weight_2'><p>The second derivative of the Ds-optimality criterion with respect to the model parameters</p></a></li>
<li><a href='#DD1'><p>Computing each element of the function c_weight_2</p></a></li>
<li><a href='#dd11'><p>Computing each element of the function DD_weight_2</p></a></li>
<li><a href='#Deff'><p>Obtaining D-efficiency for estimating model parameters</p>
</p></a></li>
<li><a href='#Dp'><p>Target dose, EDp</p></a></li>
<li><a href='#DS1'><p>Sensitivity function of c-optimality criterion for the EDp</p></a></li>
<li><a href='#ds11'><p>Sensitivity function of Ds-optimality criterion</p></a></li>
<li><a href='#Dseff'><p>Obtaining Ds-efficiency for estimating the asymmetric factor under the 5-parameter logistic model.</p>
</p></a></li>
<li><a href='#DsOPT'><p>Search Ds-optimal design for estimating the asymmetric factor under the 5-parameter logistic model.</p>
</p></a></li>
<li><a href='#EDpeff'><p>Obtaining c-efficiency for estimating the EDp under the 5-parameter logistic model.</p>
</p></a></li>
<li><a href='#EDpOPT'><p>Search c-optimal designs for estimating the EDp under the 5-parameter logistic model</p>
</p></a></li>
<li><a href='#f'><p>Gradient of the mean function</p></a></li>
<li><a href='#g'><p>Partial derivative of the EDp with respect to the model parameters</p></a></li>
<li><a href='#ginv'><p>Generalized Inverse Matrix</p>
</p></a></li>
<li><a href='#infor'><p>Obtain a information matrix at a single design point</p></a></li>
<li><a href='#Inv'><p>Adjusting invere information matrix being not singular</p>
</p></a></li>
<li><a href='#Minus'><p>Matrix subtraction</p></a></li>
<li><a href='#Multiple'><p>Matrix multiplication</p></a></li>
<li><a href='#Plus'><p>Matrix addition</p></a></li>
<li><a href='#RDOPT'><p>Search the robust D-optimal designs for estimating model parameters</p>
</p></a></li>
<li><a href='#S_weight'><p>Newton Raphson method to get optimal weights</p>
</p></a></li>
<li><a href='#SDM'><p>Summation of diagonal elements in a matrix</p></a></li>
<li><a href='#smalld1'><p>Sub-function of the function D_weight_1</p></a></li>
<li><a href='#smalldd1'><p>Sub-function of the function D_weight_2</p></a></li>
<li><a href='#smallds1'><p>Sensitivity function of D-optimality criterion</p></a></li>
<li><a href='#sMultiple'><p>Multiply a constant to a matrix</p></a></li>
<li><a href='#Trans'><p>Transpose of a matrix</p></a></li>
<li><a href='#upinfor'><p>Obtain normalized Fisher information matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Optimal Designs for the 5-Parameter Logistic Model</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Seung Won Hyun, Weng Kee Wong, and Yarong Yang</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Seung Won Hyun &lt;yellowatom09@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Obtain and evaluate various optimal designs for the 3, 4, and 5-parameter logistic models. The optimal designs are obtained based on the numerical algorithm in Hyun, Wong, Yang (2018) &lt;<a href="https://doi.org/10.18637%2Fjss.v083.i05">doi:10.18637/jss.v083.i05</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.18), matrixcalc</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-10-06 19:54:40 UTC; raina</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-10-06 21:00:15 UTC</td>
</tr>
</table>
<hr>
<h2 id='c_weight'>One iteration to run Newton Raphson to get c-optimal weights
</h2><span id='topic+c_weight'></span>

<h3>Description</h3>

<p>This is a sub-part of running Newton Raphon method to search c-optimal weights for the given design points. This is function probvides the obtained c-optimal weights after one iteration of Newton Raphson method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>c_weight(W, T, X, d, p, order, UB, I)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="c_weight_+3A_w">W</code></td>
<td>
<p>A numeric vector. The first K-1 weights for a given design
</p>
</td></tr>
<tr><td><code id="c_weight_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values
</p>
</td></tr>
<tr><td><code id="c_weight_+3A_x">X</code></td>
<td>
<p>A numeric vector. K dose levels for a given design
</p>
</td></tr>
<tr><td><code id="c_weight_+3A_d">d</code></td>
<td>
<p>Numeric. Step adjustment
</p>
</td></tr>
<tr><td><code id="c_weight_+3A_p">p</code></td>
<td>
<p>Numeric. Define EDp
</p>
</td></tr>
<tr><td><code id="c_weight_+3A_order">order</code></td>
<td>
<p>Numeric. The number of model paraemters
</p>
</td></tr>
<tr><td><code id="c_weight_+3A_ub">UB</code></td>
<td>
<p>Numeric. The upper bound of the design points
</p>
</td></tr>
<tr><td><code id="c_weight_+3A_i">I</code></td>
<td>
<p>A numeric matrix. Identity matrix.
</p>
</td></tr>
</table>

<hr>
<h2 id='c_weight_1'>The first derivative of the c-optimality criterion w.r.t the model parameters </h2><span id='topic+c_weight_1'></span>

<h3>Description</h3>

<p>The first derivative of the c-optimality criterion with respect to the model parameters. This is a sub-function of c_weight to run one iteration of Newton-Raphson method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>c_weight_1(W, T, X, inv, p, order)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="c_weight_1_+3A_w">W</code></td>
<td>
<p>A numeric vector.  The first K-1 weights for a given design</p>
</td></tr>
<tr><td><code id="c_weight_1_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values</p>
</td></tr>
<tr><td><code id="c_weight_1_+3A_x">X</code></td>
<td>
<p>A numeric vector. K dose levels for a given design</p>
</td></tr>
<tr><td><code id="c_weight_1_+3A_inv">inv</code></td>
<td>
<p>A numeric matrix. Inverse of the information matrix.</p>
</td></tr>
<tr><td><code id="c_weight_1_+3A_p">p</code></td>
<td>
<p>A numeric. Define EDp</p>
</td></tr>
<tr><td><code id="c_weight_1_+3A_order">order</code></td>
<td>
<p>numeric. The number of model paraemters</p>
</td></tr>
</table>

<hr>
<h2 id='c_weight_2'>The second derivative of the c-optimality criterion with respect to the model parameters</h2><span id='topic+c_weight_2'></span>

<h3>Description</h3>

<p>The second derivative of the c-optimality criterion with respect to the model parameters. This is a sub-function of c_weight to run one iteration of Newton-Raphson method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>c_weight_2(W, T, X, inv, p, order)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="c_weight_2_+3A_w">W</code></td>
<td>
<p>A numeric vector.  The first K-1 weights for a given design</p>
</td></tr>
<tr><td><code id="c_weight_2_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values</p>
</td></tr>
<tr><td><code id="c_weight_2_+3A_x">X</code></td>
<td>
<p>A numeric vector. K dose levels for a given design</p>
</td></tr>
<tr><td><code id="c_weight_2_+3A_inv">inv</code></td>
<td>
<p>A numeric matrix. Inverse of the information matrix.</p>
</td></tr>
<tr><td><code id="c_weight_2_+3A_p">p</code></td>
<td>
<p>A numeric. Define EDp</p>
</td></tr>
<tr><td><code id="c_weight_2_+3A_order">order</code></td>
<td>
<p>numeric. The number of model paraemters</p>
</td></tr>
</table>

<hr>
<h2 id='D_weight'>One iteration to run Newton Raphson to get D-optimal weights
</h2><span id='topic+D_weight'></span>

<h3>Description</h3>

<p>This is a sub-part of running Newton Raphon method to search D-optimal weights for the given design points. This is function probvides the obtained D-optimal weights after one iteration of Newton Raphson method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>D_weight(W, T, X, d, q)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="D_weight_+3A_w">W</code></td>
<td>
<p>A numeric vector. The first K-1 weights for a given design
</p>
</td></tr>
<tr><td><code id="D_weight_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values
</p>
</td></tr>
<tr><td><code id="D_weight_+3A_x">X</code></td>
<td>
<p>A numeric vector. K dose levels for a given design
</p>
</td></tr>
<tr><td><code id="D_weight_+3A_d">d</code></td>
<td>
<p>Numeric. Step adjustment
</p>
</td></tr>
<tr><td><code id="D_weight_+3A_q">q</code></td>
<td>
<p>A numeric vector. User select weights defined in the function RDOPT
</p>
</td></tr>
</table>

<hr>
<h2 id='D_weight_1'>The first derivative of the D-optimality criterion w.r.t the model parameters</h2><span id='topic+D_weight_1'></span>

<h3>Description</h3>

<p>The first derivative of the D-optimality criterion with respect to the model parameters. This is a sub-function of D_weight to run one iteration of Newton-Raphson method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>D_weight_1(q, W, T1, T2, T3, X, inv1, inv2, inv3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="D_weight_1_+3A_q">q</code></td>
<td>
<p>A numeric vector. User select weights defined in the function RDOPT</p>
</td></tr>
<tr><td><code id="D_weight_1_+3A_w">W</code></td>
<td>
<p>A numeric vector. The first K-1 weights for a given design</p>
</td></tr>
<tr><td><code id="D_weight_1_+3A_t1">T1</code></td>
<td>
<p>A numeric vector. Model parameter values for the 3PL model</p>
</td></tr>
<tr><td><code id="D_weight_1_+3A_t2">T2</code></td>
<td>
<p>A numeric vector. Model parameter values for the 4PL model</p>
</td></tr>
<tr><td><code id="D_weight_1_+3A_t3">T3</code></td>
<td>
<p>A numeric vector. Model parameter values for the 5PL model</p>
</td></tr>
<tr><td><code id="D_weight_1_+3A_x">X</code></td>
<td>
<p>A numeric vector. K dose levels for a given design</p>
</td></tr>
<tr><td><code id="D_weight_1_+3A_inv1">inv1</code></td>
<td>
<p>A numeric matrix. Inverse information matrix for the 3PL model</p>
</td></tr>
<tr><td><code id="D_weight_1_+3A_inv2">inv2</code></td>
<td>
<p>A numeric matrix. Inverse information matrix for the 4PL model</p>
</td></tr>
<tr><td><code id="D_weight_1_+3A_inv3">inv3</code></td>
<td>
<p>A numeric matrix. Inverse information matrix for the 5PL model</p>
</td></tr>
</table>

<hr>
<h2 id='D_weight_2'>The second derivative of the D-optimality criterion w.r.t the model parameters</h2><span id='topic+D_weight_2'></span>

<h3>Description</h3>

<p>The second derivative of the D-optimality criterion with respect to the model parameters. This is a sub-function of D_weight to run one iteration of Newton-Raphson method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>D_weight_2(q, W, T1, T2, T3, X, inv1, inv2, inv3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="D_weight_2_+3A_q">q</code></td>
<td>
<p>A numeric vector. User select weights defined in the function RDOPT</p>
</td></tr>
<tr><td><code id="D_weight_2_+3A_w">W</code></td>
<td>
<p>A numeric vector. The first K-1 weights for a given design</p>
</td></tr>
<tr><td><code id="D_weight_2_+3A_t1">T1</code></td>
<td>
<p>A numeric vector. Model parameter values for the 3PL model</p>
</td></tr>
<tr><td><code id="D_weight_2_+3A_t2">T2</code></td>
<td>
<p>A numeric vector. Model parameter values for the 4PL model</p>
</td></tr>
<tr><td><code id="D_weight_2_+3A_t3">T3</code></td>
<td>
<p>A numeric vector. Model parameter values for the 5PL model</p>
</td></tr>
<tr><td><code id="D_weight_2_+3A_x">X</code></td>
<td>
<p>A numeric vector. K dose levels for a given design</p>
</td></tr>
<tr><td><code id="D_weight_2_+3A_inv1">inv1</code></td>
<td>
<p>A numeric matrix. Inverse information matrix for the 3PL model</p>
</td></tr>
<tr><td><code id="D_weight_2_+3A_inv2">inv2</code></td>
<td>
<p>A numeric matrix. Inverse information matrix for the 4PL model</p>
</td></tr>
<tr><td><code id="D_weight_2_+3A_inv3">inv3</code></td>
<td>
<p>A numeric matrix. Inverse information matrix for the 5PL model</p>
</td></tr>
</table>

<hr>
<h2 id='D1'>Computing each element of the function c_weight_1</h2><span id='topic+D1'></span>

<h3>Description</h3>

<p>This function computes each element of the vector function c_weight_1 which is the first derivative of the c-optimality criterion with respect to the model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>D1(T, x, xl, inv, p, order)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="D1_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values</p>
</td></tr>
<tr><td><code id="D1_+3A_x">x</code></td>
<td>
<p>A numeric. ith dose level for a given design</p>
</td></tr>
<tr><td><code id="D1_+3A_xl">xl</code></td>
<td>
<p>A numeric. last dose level for a given design</p>
</td></tr>
<tr><td><code id="D1_+3A_inv">inv</code></td>
<td>
<p>A numeric matrix. Inverse of the information matrix</p>
</td></tr>
<tr><td><code id="D1_+3A_p">p</code></td>
<td>
<p>A numeric. Define EDp</p>
</td></tr>
<tr><td><code id="D1_+3A_order">order</code></td>
<td>
<p>numeric. The number of model paraemters</p>
</td></tr>
</table>

<hr>
<h2 id='d11'>Computing each element of the function DD_weight_1</h2><span id='topic+d11'></span>

<h3>Description</h3>

<p>This function computes each element of the vector function DD_weight_1 which is the first derivative of the Ds-optimality criterion with respect to the model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d11(T, x, xl, inv, inv1, order)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="d11_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values</p>
</td></tr>
<tr><td><code id="d11_+3A_x">x</code></td>
<td>
<p>A numeric. ith dose level for a given design</p>
</td></tr>
<tr><td><code id="d11_+3A_xl">xl</code></td>
<td>
<p>A numeric. last dose level for a given design</p>
</td></tr>
<tr><td><code id="d11_+3A_inv">inv</code></td>
<td>
<p>A numeric matrix. Inverse of the information matrix for the 5PL model</p>
</td></tr>
<tr><td><code id="d11_+3A_inv1">inv1</code></td>
<td>
<p>A numeric matrix. Inverse of the information matrix for the 4PL model</p>
</td></tr>
<tr><td><code id="d11_+3A_order">order</code></td>
<td>
<p>numeric. The number of model paraemters</p>
</td></tr>
</table>

<hr>
<h2 id='DD_weight'>One iteration to run Newton Raphson to get Ds-optimal weights
</h2><span id='topic+DD_weight'></span>

<h3>Description</h3>

<p>This is a sub-part of running Newton Raphon method to search Ds-optimal weights for the given design points. This is function probvides the obtained Ds-optimal weights after one iteration of Newton Raphson method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DD_weight(W, T, X, d, I4, I5, order)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DD_weight_+3A_w">W</code></td>
<td>
<p>A numeric vector. The first K-1 weights for a given design
</p>
</td></tr>
<tr><td><code id="DD_weight_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values
</p>
</td></tr>
<tr><td><code id="DD_weight_+3A_x">X</code></td>
<td>
<p>A numeric vector. K dose levels for a given design
</p>
</td></tr>
<tr><td><code id="DD_weight_+3A_d">d</code></td>
<td>
<p>Numeric. Step adjustment
</p>
</td></tr>
<tr><td><code id="DD_weight_+3A_i4">I4</code></td>
<td>
<p>A numeric matrix. Information matrix for the 4PL model
</p>
</td></tr>
<tr><td><code id="DD_weight_+3A_i5">I5</code></td>
<td>
<p>A numeric matrix. Information matrix for the 5PL model
</p>
</td></tr>
<tr><td><code id="DD_weight_+3A_order">order</code></td>
<td>
<p>Numeric. The number of model paraemters
</p>
</td></tr>
</table>

<hr>
<h2 id='DD_weight_1'>The first derivative of the Ds-optimality criterion with respect to the model parameters</h2><span id='topic+DD_weight_1'></span>

<h3>Description</h3>

<p>The first derivative of the Ds-optimality criterion with respect to the model parameters. This is a sub-function of D_weight to run one iteration of Newton-Raphson method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DD_weight_1(W, T, X, inv, inv1, order)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DD_weight_1_+3A_w">W</code></td>
<td>
<p>A numeric vector. The first K-1 weights for a given design</p>
</td></tr>
<tr><td><code id="DD_weight_1_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values for the 5PL model</p>
</td></tr>
<tr><td><code id="DD_weight_1_+3A_x">X</code></td>
<td>
<p>A numeric vector.  K dose levels for a given design</p>
</td></tr>
<tr><td><code id="DD_weight_1_+3A_inv">inv</code></td>
<td>
<p>A numeric matrix. Inverse information matrix for the 5PL model</p>
</td></tr>
<tr><td><code id="DD_weight_1_+3A_inv1">inv1</code></td>
<td>
<p>A numeric matrix. Inverse information matrix for the 4PL model</p>
</td></tr>
<tr><td><code id="DD_weight_1_+3A_order">order</code></td>
<td>
<p>numeric. The number of model paraemters</p>
</td></tr>
</table>

<hr>
<h2 id='DD_weight_2'>The second derivative of the Ds-optimality criterion with respect to the model parameters</h2><span id='topic+DD_weight_2'></span>

<h3>Description</h3>

<p>The second derivative of the Ds-optimality criterion with respect to the model parameters. This is a sub-function of D_weight to run one iteration of Newton-Raphson method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DD_weight_2(W, T, X, inv, inv1, order)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DD_weight_2_+3A_w">W</code></td>
<td>
<p>A numeric vector. The first K-1 weights for a given design</p>
</td></tr>
<tr><td><code id="DD_weight_2_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values for the 5PL model</p>
</td></tr>
<tr><td><code id="DD_weight_2_+3A_x">X</code></td>
<td>
<p>A numeric vector.  K dose levels for a given design</p>
</td></tr>
<tr><td><code id="DD_weight_2_+3A_inv">inv</code></td>
<td>
<p>A numeric matrix. Inverse information matrix for the 5PL model</p>
</td></tr>
<tr><td><code id="DD_weight_2_+3A_inv1">inv1</code></td>
<td>
<p>A numeric matrix. Inverse information matrix for the 4PL model</p>
</td></tr>
<tr><td><code id="DD_weight_2_+3A_order">order</code></td>
<td>
<p>numeric. The number of model paraemters</p>
</td></tr>
</table>

<hr>
<h2 id='DD1'>Computing each element of the function c_weight_2</h2><span id='topic+DD1'></span>

<h3>Description</h3>

<p>This function computes each element of the matrix function c_weight_2 which is the second derivative of the c-optimality criterion with respect to the model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DD1(T, x1, x2, xl, inv, p, order)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DD1_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values</p>
</td></tr>
<tr><td><code id="DD1_+3A_x1">x1</code></td>
<td>
<p>A numeric. ith dose level for a given design</p>
</td></tr>
<tr><td><code id="DD1_+3A_x2">x2</code></td>
<td>
<p>A numeric. jth dose level for a given design</p>
</td></tr>
<tr><td><code id="DD1_+3A_xl">xl</code></td>
<td>
<p>A numeric. last dose level for a given design</p>
</td></tr>
<tr><td><code id="DD1_+3A_inv">inv</code></td>
<td>
<p>A numeric matrix. Inverse of the information matrix</p>
</td></tr>
<tr><td><code id="DD1_+3A_p">p</code></td>
<td>
<p>A numeric. Define EDp</p>
</td></tr>
<tr><td><code id="DD1_+3A_order">order</code></td>
<td>
<p>numeric. The number of model paraemters</p>
</td></tr>
</table>

<hr>
<h2 id='dd11'>Computing each element of the function DD_weight_2</h2><span id='topic+dd11'></span>

<h3>Description</h3>

<p>This function computes each element of the matrix function DD_weight_2 which is the second derivative of the Ds-optimality criterion with respect to the model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dd11(T, x1, x2, xl, inv, inv1, order)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dd11_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values</p>
</td></tr>
<tr><td><code id="dd11_+3A_x1">x1</code></td>
<td>
<p>A numeric. ith dose level for a given design</p>
</td></tr>
<tr><td><code id="dd11_+3A_x2">x2</code></td>
<td>
<p>A numeric. jth dose level for a given design</p>
</td></tr>
<tr><td><code id="dd11_+3A_xl">xl</code></td>
<td>
<p>A numeric. last dose level for a given design</p>
</td></tr>
<tr><td><code id="dd11_+3A_inv">inv</code></td>
<td>
<p>A numeric matrix. Inverse of the information matrix for the 5PL model</p>
</td></tr>
<tr><td><code id="dd11_+3A_inv1">inv1</code></td>
<td>
<p>A numeric matrix. Inverse of the information matrix for the 4PL model</p>
</td></tr>
<tr><td><code id="dd11_+3A_order">order</code></td>
<td>
<p>numeric. The number of model paraemters</p>
</td></tr>
</table>

<hr>
<h2 id='Deff'>Obtaining D-efficiency for estimating model parameters
</h2><span id='topic+Deff'></span>

<h3>Description</h3>

<p>Obtaining D-efficiency for estimating model parameters for a given design under the 3, 4, 5-parameter logistic models. For the output, the function shows three things: 1. the obtained D-optimal design for the given parameter values; 2. the D-efficiency of the given design; and 3. the number of subjects required for the given design in order to provide the same performance as the D-optimal design does.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Deff(weight,dose,model,P,LB,UB,grid,N_dose)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Deff_+3A_weight">weight</code></td>
<td>
<p>A numeric vector. The first K-1 weights for a given design with K design points(K dose levels). The weights represent the proportional allocations of subjects to the dose levels in a given design.
</p>
</td></tr>
<tr><td><code id="Deff_+3A_dose">dose</code></td>
<td>
<p>A numeric vector. K dose levels for a given design.
</p>
</td></tr>
<tr><td><code id="Deff_+3A_model">model</code></td>
<td>
<p>Numeric. The number of parameters in the model. This is used to specify the model to check the D-efficiency.
</p>
</td></tr>
<tr><td><code id="Deff_+3A_p">P</code></td>
<td>
<p>A numeric vector. Solicited information on nominal values for the vector for the 5PL model. P=( p1, p2, p3, p4, p5), where p1 is the upper limit of the response, p2 is the slope that control the stiffness of the response curve, p3 is the position of the transition region in dose(this is the ED50 under the 3PL and the 4PL model), p4 is the lower limit of the response, and p5 is the asymmetric factor. When a user computes the D-efficiency under the 3PL or 4PL model, P is the vector of model parameter values for each model with setting p4 and p5 differently. Details are given in the examples.
</p>
</td></tr>
<tr><td><code id="Deff_+3A_lb">LB</code></td>
<td>
<p>Numeric. Predetermined lower bound of the dose range for the original dose level.
</p>
</td></tr>
<tr><td><code id="Deff_+3A_ub">UB</code></td>
<td>
<p>Numeric. Predetermined lower bound of the dose range for the original dose level.
</p>
</td></tr>
<tr><td><code id="Deff_+3A_grid">grid</code></td>
<td>
<p>Numeric. The grid density to discretize the predetermined dose interval. Default is 0.01.
</p>
</td></tr>
<tr><td><code id="Deff_+3A_n_dose">N_dose</code></td>
<td>
<p>Set to TRUE if the original dose levels take negative values. Set to FALSE if the original dose levels take positive values. Default is FALSE
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Seung Won Hyun, Weng Kee Wong, and Yarong Yang
</p>


<h3>References</h3>

<p>Hyun, S. W., Wong, W.K., Yang, Y. Optimal designs for asymmetric sigmoidal response curves in bioassays and immunoassays. (submitted to Statistical Methods in Medical Research)
</p>
<p>Hyun, S.W., Wong, W.K, Yang, Y. VNM: An R Package for Finding Multiple-Objective Optimal
Designs for the 4-Parameter Logistic Model. (Journal of Statistical Software, 83, 1-19, 2018, doi:10.18637/jss.v083.i05.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##Under the 5PL model with the parameter values
##T5=(30000,0.5,800,0.5,2) and the dose range [1.95,32000],
##find the D-efficiency of the broad range design.

##The broad range design
dose=c(1.95,7.8,31.25,125,500,2000,8000,32000)
dlength=length(dose)
weight=rep(1/dlength,dlength-1)

##Parameter values
T5=c(30000,0.5,800,0.5,2)

##Compute D-efficiency of the broad range design
Deff(weight,dose,model=5,P=T5,LB=1.95,UB=32000,grid=.01)


</code></pre>

<hr>
<h2 id='Dp'>Target dose, EDp</h2><span id='topic+Dp'></span>

<h3>Description</h3>

<p>This finds the target dose level EDp which is the dose producing p percentage of the difference between the maximum and the minimum responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Dp(T, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Dp_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values</p>
</td></tr>
<tr><td><code id="Dp_+3A_p">p</code></td>
<td>
<p>A numeric. Define EDp</p>
</td></tr>
</table>

<hr>
<h2 id='DS1'>Sensitivity function of c-optimality criterion for the EDp</h2><span id='topic+DS1'></span>

<h3>Description</h3>

<p>This evaluates the sensitivity function of the c-optimality criterion for the EDp at the given value of x.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DS1(T, x, inv, p, order)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DS1_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values for the 5PL model</p>
</td></tr>
<tr><td><code id="DS1_+3A_x">x</code></td>
<td>
<p>A numeric. A given dose level</p>
</td></tr>
<tr><td><code id="DS1_+3A_inv">inv</code></td>
<td>
<p>A numeric matrix. Inverse infromation matrix for the 5PL model</p>
</td></tr>
<tr><td><code id="DS1_+3A_p">p</code></td>
<td>
<p>A numeric. Define EDp</p>
</td></tr>
<tr><td><code id="DS1_+3A_order">order</code></td>
<td>
<p>numeric. The number of model paraemters</p>
</td></tr>
</table>

<hr>
<h2 id='ds11'>Sensitivity function of Ds-optimality criterion</h2><span id='topic+ds11'></span>

<h3>Description</h3>

<p>This evaluates the sensitivity function of the Ds-optimality criterion at the given value of x.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ds11(T, x, inv, inv1, order)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ds11_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values for the 5PL model</p>
</td></tr>
<tr><td><code id="ds11_+3A_x">x</code></td>
<td>
<p>A numeric. A given dose level</p>
</td></tr>
<tr><td><code id="ds11_+3A_inv">inv</code></td>
<td>
<p>A numeric matrix. Inverse information matrix for the 5PL model</p>
</td></tr>
<tr><td><code id="ds11_+3A_inv1">inv1</code></td>
<td>
<p>A numeric matrix. Inverse information matrix for the 4PL model</p>
</td></tr>
<tr><td><code id="ds11_+3A_order">order</code></td>
<td>
<p>numeric. The number of model paraemters</p>
</td></tr>
</table>

<hr>
<h2 id='Dseff'>Obtaining Ds-efficiency for estimating the asymmetric factor under the 5-parameter logistic model.
</h2><span id='topic+Dseff'></span>

<h3>Description</h3>

<p>Obtaining Ds-efficiency for estimating the asymmetric factor for a given design under the 5-parameter logistic models. For the output, the function shows three things: 1. the obtained Ds-optimal design for the given parameter values; 2. the Ds-efficiency of the given design; and 3. the number of subjects required for the given design in order to provide the same performance as the Ds-optimal design does.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Dseff(weight,dose,P,LB,UB,r,epsilon,grid,N_dose)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Dseff_+3A_weight">weight</code></td>
<td>
<p>A numeric vector. The first K-1 weights for a given design with K design points(K dose levels). The weights represent the proportional allocations of subjects to the dose levels in a given design.
</p>
</td></tr>
<tr><td><code id="Dseff_+3A_dose">dose</code></td>
<td>
<p>A numeric vector. K dose levels for a given design.
</p>
</td></tr>
<tr><td><code id="Dseff_+3A_p">P</code></td>
<td>
<p>A numeric vector. Solicited information on nominal values for the vector for the 5PL model. P=(p1, p2, p3, p4, p5), where p1 is the upper limit of the response, p2 is the slope that control the stiffness of the response curve, p3 is the position of the transition region in dose, p4 is the lower limit of the response, and p5 is the asymmetric factor.
</p>
</td></tr>
<tr><td><code id="Dseff_+3A_lb">LB</code></td>
<td>
<p>Numeric. Predetermined lower bound of the dose range for the original dose level.
</p>
</td></tr>
<tr><td><code id="Dseff_+3A_ub">UB</code></td>
<td>
<p>Numeric. Predetermined lower bound of the dose range for the original dose level.
</p>
</td></tr>
<tr><td><code id="Dseff_+3A_r">r</code></td>
<td>
<p>Numeric. The number of iterations to set an initial design to search the Ds-optimal design to compute the efficiency. Default is 30 and needed to be increased (for example, r=50) if the searched the Ds-optimal design is not a true optimal. It can be verified by the verification plot.
</p>
</td></tr>
<tr><td><code id="Dseff_+3A_epsilon">epsilon</code></td>
<td>
<p>Numeric. Stopping criterion for the algorithm to search the Ds-optimal design. Default is 0.001.
</p>
</td></tr>
<tr><td><code id="Dseff_+3A_grid">grid</code></td>
<td>
<p>Numeric. The grid density to discretize the predetermined dose interval. Default is 0.01.
</p>
</td></tr>
<tr><td><code id="Dseff_+3A_n_dose">N_dose</code></td>
<td>
<p>Set to TRUE if the original dose levels take negative values. Set to FALSE if the original dose levels take positive values. Default is FALSE
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Seung Won Hyun, Weng Kee Wong, and Yarong Yang
</p>


<h3>References</h3>

<p>Hyun, S. W., Wong, W.K., Yang, Y. Optimal designs for asymmetric sigmoidal response curves in bioassays and immunoassays. (submitted to Statistical Methods in Medical Research)
</p>
<p>Hyun, S.W., Wong, W.K, Yang, Y. VNM: An R Package for Finding Multiple-Objective Optimal
Designs for the 4-Parameter Logistic Model. (Journal of Statistical Software, 83, 1-19, 2018, doi:10.18637/jss.v083.i05.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##Under the 5PL model with the parameter values
##T5=(30000,0.5,800,0.5,2) and the dose range [1.95,32000],
##find the Ds-efficiency of the broad range design.

##The broad range design
dose=c(1.95,7.8,31.25,125,500,2000,8000,32000)
dlength=length(dose)
weight=rep(1/dlength,dlength-1)

##Parameter values for the 5PL model
T5=c(30000,0.5,800,0.5,2)

##Ds efficiency of the broad range design
Dseff(weight,dose,P=T5,LB=1.95,UB=32000,grid=.01)

</code></pre>

<hr>
<h2 id='DsOPT'>Search Ds-optimal design for estimating the asymmetric factor under the 5-parameter logistic model.
</h2><span id='topic+DsOPT'></span>

<h3>Description</h3>

<p>Obtain Ds-optimal design (i.e., optimal dose levels and corresponding optimal weights) for estimating the asymmetric factor under the 5-parameter logistic model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DsOPT(LB,UB,P,grid,r,epsilon,N_dose,log_scale)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DsOPT_+3A_lb">LB</code></td>
<td>
<p>Numeric. Predetermined lower bound of the dose range for the original dose level.
</p>
</td></tr>
<tr><td><code id="DsOPT_+3A_ub">UB</code></td>
<td>
<p>Numeric. Predetermined lower bound of the dose range for the original dose level.
</p>
</td></tr>
<tr><td><code id="DsOPT_+3A_p">P</code></td>
<td>
<p>A numeric vector. Solicited information on nominal values for the vector for the 5PL model. P=(p1, p2, p3, p4, p5), where p1 is the upper limit of the response, p2 is the slope that control the stiffness of the response curve, p3 is the position of the transition region in dose, p4 is the lower limit of the response, and p5 is the asymmetric factor.
</p>
</td></tr>
<tr><td><code id="DsOPT_+3A_grid">grid</code></td>
<td>
<p>Numeric. The grid density to discretize the predetermined dose interval. Default is 0.01.
</p>
</td></tr>
<tr><td><code id="DsOPT_+3A_r">r</code></td>
<td>
<p>Numeric. The number of iterations to set an initial design to search the Ds-optimal design. Default is 30 and needed to be increased (for example, r=50) if the searched optimal design is not a true optimal. It can be verified by the verification plot.
</p>
</td></tr>
<tr><td><code id="DsOPT_+3A_epsilon">epsilon</code></td>
<td>
<p>Numeric. Stopping criterion for the algorithm to search the Ds-optimal design. Default is 0.001.
</p>
</td></tr>
<tr><td><code id="DsOPT_+3A_n_dose">N_dose</code></td>
<td>
<p>Set to TRUE if the original dose levels take negative values. Set to FALSE if the original dose levels take positive values. Default is FALSE
</p>
</td></tr>
<tr><td><code id="DsOPT_+3A_log_scale">log_scale</code></td>
<td>
<p>Set to TRUE if a user wants to set the X-axis(dose level) on log scale in the verification plot of the optimal design. Otherwise, set to FALSE. Default is TRUE. Note: this need to set FALSE when the original dose levels take negative values.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Seung Won Hyun, Weng Kee Wong, and Yarong Yang
</p>


<h3>References</h3>

<p>Hyun, S. W., Wong, W.K., Yang, Y. Optimal designs for asymmetric sigmoidal response curves in bioassays and immunoassays. (submitted to Statistical Methods in Medical Research)
</p>
<p>Hyun, S.W., Wong, W.K, Yang, Y. VNM: An R Package for Finding Multiple-Objective Optimal
Designs for the 4-Parameter Logistic Model. (Journal of Statistical Software, 83, 1-19, 2018, doi:10.18637/jss.v083.i05.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##Find the Ds-optimal design for estimating theta_5 under the 5PL model
##with the parameter values T5=(30000,0.5,800,0.5,2) and the dose range [1.95,32000].

##Parameter values for the 5PL model
T5=c(30000,0.5,800,0.5,2)

##Find the Ds-optimal design
DsOPT(LB=1.95, UB=32000, P=T5,grid=.01,epsilon=.001)

</code></pre>

<hr>
<h2 id='EDpeff'>Obtaining c-efficiency for estimating the EDp under the 5-parameter logistic model.
</h2><span id='topic+EDpeff'></span>

<h3>Description</h3>

<p>Obtaining c-efficiency for estimating the EDp for a given design under the 5-parameter logistic models. For the output, the function shows three things: 1. the obtained c-optimal design for the given parameter values; 2. the c-efficiency of the given design; and 3. the number of subjects required for the given design in order to provide the same performance as the c-optimal design does.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EDpeff(weight,dose,P,EDp,LB,UB,r,epsilon,grid,N_dose)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EDpeff_+3A_weight">weight</code></td>
<td>
<p>A numeric vector. The first K-1 weights for a given design with K design points(K dose levels). The weights represent the proportional allocations of subjects to the dose levels in a given design.
</p>
</td></tr>
<tr><td><code id="EDpeff_+3A_dose">dose</code></td>
<td>
<p>A numeric vector. K dose levels for a given design.
</p>
</td></tr>
<tr><td><code id="EDpeff_+3A_p">P</code></td>
<td>
<p>A numeric vector. Solicited information on nominal values for the vector for the 5PL model. P=(p1, p2, p3, p4, p5), where p1 is the upper limit of the response, p2 is the slope that control the stiffness of the response curve, p3 is the position of the transition region in dose, p4 is the lower limit of the response, and p5 is the asymmetric factor.
</p>
</td></tr>
<tr><td><code id="EDpeff_+3A_edp">EDp</code></td>
<td>
<p>Numeric. An user select value to define the EDp. For example, EDp=.05 to define the ED50.
</p>
</td></tr>
<tr><td><code id="EDpeff_+3A_lb">LB</code></td>
<td>
<p>Numeric. Predetermined lower bound of the dose range for the original dose level.
</p>
</td></tr>
<tr><td><code id="EDpeff_+3A_ub">UB</code></td>
<td>
<p>Numeric. Predetermined lower bound of the dose range for the original dose level.
</p>
</td></tr>
<tr><td><code id="EDpeff_+3A_r">r</code></td>
<td>
<p>Numeric. The number of iterations to set an initial design to search the c-optimal design for the EDp in order to compute the efficiency. Default is 30 and needed to be increased (for example, r=50) if the searched the c-optimal design is not a true optimal. It can be verified by the verification plot.
</p>
</td></tr>
<tr><td><code id="EDpeff_+3A_epsilon">epsilon</code></td>
<td>
<p>Numeric. Stopping criterion for the algorithm to search the c-optimal design. Default is 0.001.
</p>
</td></tr>
<tr><td><code id="EDpeff_+3A_grid">grid</code></td>
<td>
<p>Numeric. The grid density to discretize the predetermined dose interval. Default is 0.01.
</p>
</td></tr>
<tr><td><code id="EDpeff_+3A_n_dose">N_dose</code></td>
<td>
<p>Set to TRUE if the original dose levels take negative values. Set to FALSE if the original dose levels take positive values. Default is FALSE
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Seung Won Hyun, Weng Kee Wong, and Yarong Yang
</p>


<h3>References</h3>

<p>Hyun, S. W., Wong, W.K., Yang, Y. Optimal designs for asymmetric sigmoidal response curves in bioassays and immunoassays. (submitted to Statistical Methods in Medical Research)
</p>
<p>Hyun, S.W., Wong, W.K, Yang, Y. VNM: An R Package for Finding Multiple-Objective Optimal
Designs for the 4-Parameter Logistic Model. (Journal of Statistical Software, 83, 1-19, 2018, doi:10.18637/jss.v083.i05.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##Under the 5PL model with the parameter values
##T5=(30000,0.5,800,0.5,2) and the dose range [1.95,32000],
##find the c-efficiency of the broad range design.

##The broad range design
dose=c(1.95,7.8,31.25,125,500,2000,8000,32000)
dlength=length(dose)
weight=rep(1/dlength,dlength-1)

##Parameter values for the 5PL model
T5=c(30000,0.5,800,0.5,2)

##Compute the c-efficiency of the broad range design
EDpeff(weight,dose,P=T5,EDp=.5,LB=1.95,UB=32000,grid=.01)

</code></pre>

<hr>
<h2 id='EDpOPT'>Search c-optimal designs for estimating the EDp under the 5-parameter logistic model
</h2><span id='topic+EDpOPT'></span>

<h3>Description</h3>

<p>Obtain c-optimal design (i.e., optimal dose levels and corresponding optimal weights) for estimating the EDp under the 5-parameter logistic model. The EDp is the dose level that achieve the 100p% of the difference between the maximum and the minimum responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EDpOPT(LB,UB,P,EDp,grid,r,epsilon,N_dose,log_scale)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EDpOPT_+3A_lb">LB</code></td>
<td>
<p>Numeric. Predetermined lower bound of the dose range for the original dose level.
</p>
</td></tr>
<tr><td><code id="EDpOPT_+3A_ub">UB</code></td>
<td>
<p>Numeric. Predetermined lower bound of the dose range for the original dose level.
</p>
</td></tr>
<tr><td><code id="EDpOPT_+3A_p">P</code></td>
<td>
<p>A numeric vector. Solicited information on nominal values for the vector for the 5PL model. P=(p1, p2, p3, p4, p5), where p1 is the upper limit of the response, p2 is the slope that control the stiffness of the response curve, p3 is the position of the transition region in dose, p4 is the lower limit of the response, and p5 is the asymmetric factor.
</p>
</td></tr>
<tr><td><code id="EDpOPT_+3A_edp">EDp</code></td>
<td>
<p>Numeric. An user select value to define the EDp. For example, EDp=.05 to define the ED50.
</p>
</td></tr>
<tr><td><code id="EDpOPT_+3A_grid">grid</code></td>
<td>
<p>Numeric. The grid density to discretize the predetermined dose interval. Default is 0.01.
</p>
</td></tr>
<tr><td><code id="EDpOPT_+3A_r">r</code></td>
<td>
<p>Numeric. The number of iterations to set an initial design to search the c-optimal design. Default is 30 and needed to be increased (for example, r=50) if the searched optimal design is not a true optimal. It can be verified by the verification plot.
</p>
</td></tr>
<tr><td><code id="EDpOPT_+3A_epsilon">epsilon</code></td>
<td>
<p>Numeric. Stopping criterion for the algorithm to search the c-optimal design. Default is 0.001.
</p>
</td></tr>
<tr><td><code id="EDpOPT_+3A_n_dose">N_dose</code></td>
<td>
<p>Set to TRUE if the original dose levels take negative values. Set to FALSE if the original dose levels take positive values. Default is FALSE
</p>
</td></tr>
<tr><td><code id="EDpOPT_+3A_log_scale">log_scale</code></td>
<td>
<p>Set to TRUE if a user wants to set the X-axis(dose level) on log scale in the verification plot of the optimal design. Otherwise, set to FALSE. Default is TRUE. Note: this need to set FALSE when the original dose levels take negative values.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Seung Won Hyun, Weng Kee Wong, and Yarong Yang
</p>


<h3>References</h3>

<p>Hyun, S. W., Wong, W.K., Yang, Y. Optimal designs for asymmetric sigmoidal response curves in bioassays and immunoassays. (submitted to Statistical Methods in Medical Research)
</p>
<p>Hyun, S.W., Wong, W.K, Yang, Y. VNM: An R Package for Finding Multiple-Objective Optimal
Designs for the 4-Parameter Logistic Model. (Journal of Statistical Software, 83, 1-19, 2018, doi:10.18637/jss.v083.i05.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Search the c-optimal design for estimating the ED50 under the 5PL model

##Parameter values for the 5PL model
T5=c(30000,0.5,800,0.5,2)

##Dose range=[1.95,32000]

EDpOPT(LB=1.95,UB=32000, P=T5,EDp=.5,grid=.01, r =30,epsilon=.001)

</code></pre>

<hr>
<h2 id='f'>Gradient of the mean function</h2><span id='topic+f'></span>

<h3>Description</h3>

<p>This gives the first derivative of the mean response function (3, 4, or 5PL) with respect to the model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f(T, x, order)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values</p>
</td></tr>
<tr><td><code id="f_+3A_x">x</code></td>
<td>
<p>A numeric. A given dose level</p>
</td></tr>
<tr><td><code id="f_+3A_order">order</code></td>
<td>
<p>numeric. The number of model paraemters</p>
</td></tr>
</table>

<hr>
<h2 id='g'>Partial derivative of the EDp with respect to the model parameters</h2><span id='topic+g'></span>

<h3>Description</h3>

<p>Partial derivative of the EDp with respect to the model parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>g(T, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="g_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values</p>
</td></tr>
<tr><td><code id="g_+3A_p">p</code></td>
<td>
<p>A numeric. Define EDp</p>
</td></tr>
</table>

<hr>
<h2 id='ginv'>Generalized Inverse Matrix
</h2><span id='topic+ginv'></span>

<h3>Description</h3>

<p>Obtain generalized inverse of the given matrix X.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ginv(X, tol = sqrt(.Machine$double.eps))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ginv_+3A_x">X</code></td>
<td>
<p>A numeric matrix
</p>
</td></tr>
<tr><td><code id="ginv_+3A_tol">tol</code></td>
<td>
<p>Default
</p>
</td></tr>
</table>

<hr>
<h2 id='infor'>Obtain a information matrix at a single design point</h2><span id='topic+infor'></span>

<h3>Description</h3>

<p>Obtain a information matrix at a single given design point x.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>infor(T, x, order)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="infor_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values</p>
</td></tr>
<tr><td><code id="infor_+3A_x">x</code></td>
<td>
<p>numeric. A single design point(dose level)</p>
</td></tr>
<tr><td><code id="infor_+3A_order">order</code></td>
<td>
<p>numeric. The number of model paraemters</p>
</td></tr>
</table>

<hr>
<h2 id='Inv'>Adjusting invere information matrix being not singular
</h2><span id='topic+Inv'></span>

<h3>Description</h3>

<p>When the inverse matrix is a singular, it is adjusted to become nonsingular matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Inv(M, I)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Inv_+3A_m">M</code></td>
<td>
<p>A numeric matrix
</p>
</td></tr>
<tr><td><code id="Inv_+3A_i">I</code></td>
<td>
<p>Identity matrix
</p>
</td></tr>
</table>

<hr>
<h2 id='Minus'>Matrix subtraction</h2><span id='topic+Minus'></span>

<h3>Description</h3>

<p>Matrix subtraction: M1-M2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Minus(M1, M2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Minus_+3A_m1">M1</code></td>
<td>
<p>A numeric matrix</p>
</td></tr>
<tr><td><code id="Minus_+3A_m2">M2</code></td>
<td>
<p>A numeric matrix</p>
</td></tr>
</table>

<hr>
<h2 id='Multiple'>Matrix multiplication</h2><span id='topic+Multiple'></span>

<h3>Description</h3>

<p>Matrix multiplication: M1*M2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Multiple(M1, M2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Multiple_+3A_m1">M1</code></td>
<td>
<p>A numeric matrix</p>
</td></tr>
<tr><td><code id="Multiple_+3A_m2">M2</code></td>
<td>
<p>A numeric matrix</p>
</td></tr>
</table>

<hr>
<h2 id='Plus'>Matrix addition</h2><span id='topic+Plus'></span>

<h3>Description</h3>

<p>Matrix addition: M1+M2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Plus(M1, M2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Plus_+3A_m1">M1</code></td>
<td>
<p>A numeric matrix</p>
</td></tr>
<tr><td><code id="Plus_+3A_m2">M2</code></td>
<td>
<p>A numeric matrix</p>
</td></tr>
</table>

<hr>
<h2 id='RDOPT'>Search the robust D-optimal designs for estimating model parameters
</h2><span id='topic+RDOPT'></span>

<h3>Description</h3>

<p>Obtain robust D-optimal design (i.e., optimal dose levels and corresponding optimal weights) for estimating the model parameters that works well under the 3, 4, 5-parameter logistic models. In addition, the function can be used to obtain D-optimal design for each of the three models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RDOPT(LB,UB, P3,P4,P5,q,grid,r,epsilon,N_dose,log_scale)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RDOPT_+3A_lb">LB</code></td>
<td>
<p>Numeric. Predetermined lower bound of the dose range for the original dose level.
</p>
</td></tr>
<tr><td><code id="RDOPT_+3A_ub">UB</code></td>
<td>
<p>Numeric. Predetermined lower bound of the dose range for the original dose level.
</p>
</td></tr>
<tr><td><code id="RDOPT_+3A_p3">P3</code></td>
<td>
<p>A numeric vector. Solicited information on nominal values for the vectors for the 3PL model. P3=(p1, p2, p3), where p1 is the upper limit of the response, p2  is the slope that control the stiffness of the response curve, and p3 is the ED50.
</p>
</td></tr>
<tr><td><code id="RDOPT_+3A_p4">P4</code></td>
<td>
<p>A numeric vector. Solicited information on nominal values for the vectors for the 4PL model. P4=(p1, p2, p3, p4),  where p1 is the upper limit of the response, p2 is the slope that control the stiffness of the response curve, p3 is the ED50, and p4 is the lower limit of the response.
</p>
</td></tr>
<tr><td><code id="RDOPT_+3A_p5">P5</code></td>
<td>
<p>A numeric vector. Solicited information on nominal values for the vectors for the 5PL model. P5=(p1, p2, p3, p4, p5), where p1 is the upper limit of the response, p2 is the slope that control the stiffness of the response curve, p3 is the position of the transition region in dose, p4 is the lower limit of the response, and p5 is the asymmetric factor. For searching the robust D-optimal design, the nominal values for P3, P4, P5 need to be specified. However, when a user searches the D-optimal design for the 3PL, 4PL, or 5PL model, only P5 needs to be specified. Details are given in the examples.
</p>
</td></tr>
<tr><td><code id="RDOPT_+3A_q">q</code></td>
<td>
<p>A numeric vector. User select weights. q=c(q1, q2, q3), where q1, q2, q3 represent the relative importance of the 3, 4, 5PL models respectively. They are non-negative and q1+q2&lt;=1. For example, q=c(0,0,1) is used to find D-optimal design for the 5PL model only and q=c(1/3,1/3,1/3) is used to find robust D-optimal design for the three models under the assumption that the three models are equally important.
</p>
</td></tr>
<tr><td><code id="RDOPT_+3A_grid">grid</code></td>
<td>
<p>Numeric. The grid density to discretize the predetermined dose interval. Default is 0.01.
</p>
</td></tr>
<tr><td><code id="RDOPT_+3A_r">r</code></td>
<td>
<p>Numeric. The number of iterations to set an initial design to search the D-optimal design. Default is 30 and needed to be increased (for example, r=50) if the searched optimal design is not a true optimal. It can be verified by the verification plot.
</p>
</td></tr>
<tr><td><code id="RDOPT_+3A_epsilon">epsilon</code></td>
<td>
<p>Numeric. Stopping criterion for the algorithm to search the D-optimal design. Default is 0.001.
</p>
</td></tr>
<tr><td><code id="RDOPT_+3A_n_dose">N_dose</code></td>
<td>
<p>Set to TRUE if the original dose levels take negative values. Set to FALSE if the original dose levels take positive values. Default is FALSE
</p>
</td></tr>
<tr><td><code id="RDOPT_+3A_log_scale">log_scale</code></td>
<td>
<p>Set to TRUE if a user wants to set the X-axis(dose level) on log scale in the verification plot of the optimal design. Otherwise, set to FALSE. Default is TRUE. Note: this need to set FALSE when the original dose levels take negative values.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Seung Won Hyun, Weng Kee Wong, and Yarong Yang
</p>


<h3>References</h3>

<p>Hyun, S. W., Wong, W.K., Yang, Y. Optimal designs for asymmetric sigmoidal response curves in bioassays and immunoassays. (submitted to Statistical Methods in Medical Research)
</p>
<p>Hyun, S.W., Wong, W.K, Yang, Y. VNM: An R Package for Finding Multiple-Objective Optimal
Designs for the 4-Parameter Logistic Model. (Journal of Statistical Software, 83, 1-19, 2018, doi:10.18637/jss.v083.i05.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##1. Search the robust D-optimal design for estimating the model parameters
##under the 3,4,5PL models

##Parameter values for the 5PL model
T5=c(30000,0.5,800,0.5,2)
##Parameter values for the 4PL model
T4=c(27264.92,0.67,3340.95,-225.55)
##Parameter values for the 3PL model
T3=c(26715.52,0.70,3204.92)

##Dose range=[1.95,32000]
##Assuming the three models are equally important
RDOPT(LB=1.95,UB=32000,P3=T3,P4=T4,P5=T5,q=c(1/3,1/3,1/3))

##2. Search the D-optimal design for the 3PL model using
##the parameter values T3=(26715.52,0.70,3204.92)
##and the dose range [1.95,32000].

#Set the parameter values for the 3PL model in the form of P5
P5=c(26715.52,0.70,3204.92,0,1)
RDOPT(LB=1.95, UB=32000,P5=P5,q=c(1,0,0))

##3. Search the D-optimal design for the 4PL model using
##the parameter values T4=(27264.92,0.67,3340.95,-225.55)
##and the dose range [1.95,32000].

#Set the parameter values for the 4PL model in the form of P5.
P5=c(27264.92,0.67,3340.95,-225.55,1)
RDOPT(LB=1.95, UB=32000,P5=P5,q=c(0,1,0))

</code></pre>

<hr>
<h2 id='S_weight'>Newton Raphson method to get optimal weights
</h2><span id='topic+S_weight'></span>

<h3>Description</h3>

<p>Newton Raphson method to get optimal weights for given design points &quot;X&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>S_weight(X, T, e1, f, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="S_weight_+3A_x">X</code></td>
<td>
<p>A numeric vector. K dose levels for a given design
</p>
</td></tr>
<tr><td><code id="S_weight_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values
</p>
</td></tr>
<tr><td><code id="S_weight_+3A_e1">e1</code></td>
<td>
<p>Numeric. Threshold to stop the iteration.
</p>
</td></tr>
<tr><td><code id="S_weight_+3A_f">f</code></td>
<td>
<p>A character. D_weight for D-optimal weight; c_weight for c-optimal weight; DD_weight for Ds-optimal weight
</p>
</td></tr>
<tr><td><code id="S_weight_+3A_...">...</code></td>
<td>
<p>Default.
</p>
</td></tr>
</table>

<hr>
<h2 id='SDM'>Summation of diagonal elements in a matrix</h2><span id='topic+SDM'></span>

<h3>Description</h3>

<p>Summation of diagonal elements in a matrix M.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SDM(M)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SDM_+3A_m">M</code></td>
<td>
<p>A numeric matrix</p>
</td></tr>
</table>

<hr>
<h2 id='smalld1'>Sub-function of the function D_weight_1</h2><span id='topic+smalld1'></span>

<h3>Description</h3>

<p>This computes the first derivative of the D-optimality criterion with respect to the model parameters for a specified model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smalld1(T, x, xl, inv, order)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="smalld1_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values</p>
</td></tr>
<tr><td><code id="smalld1_+3A_x">x</code></td>
<td>
<p>A numeric. ith dose level</p>
</td></tr>
<tr><td><code id="smalld1_+3A_xl">xl</code></td>
<td>
<p>A numeric. last dose level</p>
</td></tr>
<tr><td><code id="smalld1_+3A_inv">inv</code></td>
<td>
<p>A numeric matrix. Inverse infromation matrix</p>
</td></tr>
<tr><td><code id="smalld1_+3A_order">order</code></td>
<td>
<p>numeric. The number of model paraemters: 3, 4, 5 for the 3, 4, 5PL models respectively</p>
</td></tr>
</table>

<hr>
<h2 id='smalldd1'>Sub-function of the function D_weight_2</h2><span id='topic+smalldd1'></span>

<h3>Description</h3>

<p>This computes the second derivative of the D-optimality criterion with respect to the model parameters for a specified model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smalldd1(T, x1, x2, xl, inv, order)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="smalldd1_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values</p>
</td></tr>
<tr><td><code id="smalldd1_+3A_x1">x1</code></td>
<td>
<p>A numeric. ith dose level</p>
</td></tr>
<tr><td><code id="smalldd1_+3A_x2">x2</code></td>
<td>
<p>A numeric. jth dose level</p>
</td></tr>
<tr><td><code id="smalldd1_+3A_xl">xl</code></td>
<td>
<p>A numeric. last dose level</p>
</td></tr>
<tr><td><code id="smalldd1_+3A_inv">inv</code></td>
<td>
<p>A numeric matrix. Inverse information matrix</p>
</td></tr>
<tr><td><code id="smalldd1_+3A_order">order</code></td>
<td>
<p>numeric. The number of model paraemters: 3, 4, 5 for the 3, 4, 5PL models respectively</p>
</td></tr>
</table>

<hr>
<h2 id='smallds1'>Sensitivity function of D-optimality criterion</h2><span id='topic+smallds1'></span>

<h3>Description</h3>

<p>This evaluates the sensitivity function of the D-optimality criterion at the given value of x
for a specified model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>smallds1(T, x, inv, order)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="smallds1_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values</p>
</td></tr>
<tr><td><code id="smallds1_+3A_x">x</code></td>
<td>
<p>A numeric. A given dose level</p>
</td></tr>
<tr><td><code id="smallds1_+3A_inv">inv</code></td>
<td>
<p>A numeric matrix. Inverse information matrix</p>
</td></tr>
<tr><td><code id="smallds1_+3A_order">order</code></td>
<td>
<p>numeric. The number of model paraemters: 3, 4, 5 for the 3, 4, 5PL models respectively</p>
</td></tr>
</table>

<hr>
<h2 id='sMultiple'>Multiply a constant to a matrix</h2><span id='topic+sMultiple'></span>

<h3>Description</h3>

<p>Multiply a constant to a matrix: s*M.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sMultiple(s, M)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sMultiple_+3A_s">s</code></td>
<td>
<p>Numeric</p>
</td></tr>
<tr><td><code id="sMultiple_+3A_m">M</code></td>
<td>
<p>A numeric matrix</p>
</td></tr>
</table>

<hr>
<h2 id='Trans'>Transpose of a matrix</h2><span id='topic+Trans'></span>

<h3>Description</h3>

<p>Transpose of a matrix M.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Trans(M)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Trans_+3A_m">M</code></td>
<td>
<p>A numeric matrix</p>
</td></tr>
</table>

<hr>
<h2 id='upinfor'>Obtain normalized Fisher information matrix</h2><span id='topic+upinfor'></span>

<h3>Description</h3>

<p>Obtain normalized Fisher information matrix for the 3, 4, 5PL models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>upinfor(W, T, X, order)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="upinfor_+3A_w">W</code></td>
<td>
<p>A numeric vector. The first K-1 weights for a given design</p>
</td></tr>
<tr><td><code id="upinfor_+3A_t">T</code></td>
<td>
<p>A numeric vector. Model parameter values</p>
</td></tr>
<tr><td><code id="upinfor_+3A_x">X</code></td>
<td>
<p>A numeric vector. K design points for a given design</p>
</td></tr>
<tr><td><code id="upinfor_+3A_order">order</code></td>
<td>
<p>numeric. The number of model paraemters</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
