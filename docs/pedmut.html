<!DOCTYPE html><html lang="en-GB"><head><title>Help for package pedmut</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pedmut}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pedmut-package'><p>pedmut: Mutation Models for Pedigree Likelihood Computations</p></a></li>
<li><a href='#findStationary'><p>Find the stationary frequency distribution</p></a></li>
<li><a href='#getParams'><p>Get model parameters</p></a></li>
<li><a href='#isMutationModel'><p>Test for mutation matrix/model</p></a></li>
<li><a href='#lumpedMatrix'><p>Combine alleles in a mutation matrix</p></a></li>
<li><a href='#maxRate'><p>Upper limits for overall mutation rate for the stepwise reversible model.</p></a></li>
<li><a href='#model_properties'><p>Mutation model properties</p></a></li>
<li><a href='#mutationMatrix'><p>Mutation matrix</p></a></li>
<li><a href='#mutationModel'><p>Mutation models</p></a></li>
<li><a href='#mutRate'><p>Overall mutation rate</p></a></li>
<li><a href='#stabilize'><p>Stabilization of mutation matrix</p></a></li>
<li><a href='#stepwiseReversible'><p>Reversible stepwise mutation model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Mutation Models for Pedigree Likelihood Computations</td>
</tr>
<tr>
<td>Version:</td>
<td>0.7.1</td>
</tr>
<tr>
<td>Description:</td>
<td>A collection of functions for modelling mutations in
    pedigrees with marker data, as used e.g. in likelihood computations
    with microsatellite data. Implemented models include equal,
    proportional and stepwise models, as well as random models for
    experimental work, and custom models allowing the user to apply any
    valid mutation matrix. Allele lumping is done following the
    lumpability criteria of Kemeny and Snell (1976), ISBN:0387901922.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/magnusdv/pedmut">https://github.com/magnusdv/pedmut</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-04 23:38:57 UTC; magnusdv</td>
</tr>
<tr>
<td>Author:</td>
<td>Magnus Dehli Vigeland
    <a href="https://orcid.org/0000-0002-9134-4962"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Thore Egeland <a href="https://orcid.org/0000-0002-3465-8885"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Magnus Dehli Vigeland &lt;m.d.vigeland@medisin.uio.no&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-05 00:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='pedmut-package'>pedmut: Mutation Models for Pedigree Likelihood Computations</h2><span id='topic+pedmut'></span><span id='topic+pedmut-package'></span>

<h3>Description</h3>

<p>A collection of functions for modelling mutations in pedigrees with marker data, as used e.g. in likelihood computations with microsatellite data. Implemented models include equal, proportional and stepwise models, as well as random models for experimental work, and custom models allowing the user to apply any valid mutation matrix. Allele lumping is done following the lumpability criteria of Kemeny and Snell (1976), ISBN:0387901922.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Magnus Dehli Vigeland <a href="mailto:m.d.vigeland@medisin.uio.no">m.d.vigeland@medisin.uio.no</a> (<a href="https://orcid.org/0000-0002-9134-4962">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Thore Egeland <a href="mailto:thore.egeland@nmbu.no">thore.egeland@nmbu.no</a> (<a href="https://orcid.org/0000-0002-3465-8885">ORCID</a>) [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/magnusdv/pedmut">https://github.com/magnusdv/pedmut</a>
</p>
</li></ul>


<hr>
<h2 id='findStationary'>Find the stationary frequency distribution</h2><span id='topic+findStationary'></span>

<h3>Description</h3>

<p>Finds the stationary distribution of allele frequencies, if it exists, w.r.t. a given mutation matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findStationary(mutmat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="findStationary_+3A_mutmat">mutmat</code></td>
<td>
<p>A mutation matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length <code>ncol(mutmat)</code>, or NULL.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
m1 = mutationMatrix("equal", alleles = 1:4, rate = 0.1)
findStationary(m1)

m2 = mutationMatrix("random", alleles = 1:3, seed = 123)
a = findStationary(m2)

a %*% m2 - a  # check

</code></pre>

<hr>
<h2 id='getParams'>Get model parameters</h2><span id='topic+getParams'></span>

<h3>Description</h3>

<p>Extract model parameters of a mutation matrix/model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getParams(mut, params = NULL, format = 1, sep = "/")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getParams_+3A_mut">mut</code></td>
<td>
<p>A <code><a href="#topic+mutationModel">mutationModel()</a></code> or <code><a href="#topic+mutationMatrix">mutationMatrix()</a></code>.</p>
</td></tr>
<tr><td><code id="getParams_+3A_params">params</code></td>
<td>
<p>A vector contain some or all of the words &quot;model&quot;, &quot;rate&quot;,
&quot;range&quot;, &quot;rate2&quot;, &quot;seed&quot;. If NULL (default), all present parameters are
included.</p>
</td></tr>
<tr><td><code id="getParams_+3A_format">format</code></td>
<td>
<p>A numeric code indicating the wanted output format. See Value.</p>
</td></tr>
<tr><td><code id="getParams_+3A_sep">sep</code></td>
<td>
<p>A separator character used to paste male and female values.
Ignored unless <code>format = 3</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When <code>mut</code> is a <code>mutationModel</code> with different male/female
parameters, the output format is dictated by the <code>format</code> option, with the
following possibilities:
</p>

<ol>
<li><p> A data frame with 2 rows labelled 'female' and 'male'.
</p>
</li>
<li><p> A data frame with 1 row and female/male columns suffixed by .F/.M
respectively.
</p>
</li>
<li><p> A data frame with 1 row, in which female/male values are pasted together
(separated with <code>sep</code>) if different.
</p>
</li></ol>

<p>If <code>mut</code> is a <code>mutationMatrix</code> the output always has 1 row.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>M = mutationModel("equal", 1:2, rate = list(female = 0.2, male = 0.1))
getParams(M)
getParams(M, format = 2)
getParams(M, format = 3)
getParams(M, format = 3, sep = "|")

</code></pre>

<hr>
<h2 id='isMutationModel'>Test for mutation matrix/model</h2><span id='topic+isMutationModel'></span><span id='topic+isMutationMatrix'></span>

<h3>Description</h3>

<p>Test for mutation matrix/model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isMutationModel(x)

isMutationMatrix(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isMutationModel_+3A_x">x</code></td>
<td>
<p>Any object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE or FALSE
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
mat = mutationMatrix("equal", alleles = 1:2, rate = 0.1)
isMutationMatrix(mat)

isMutationModel(mat) # FALSE (not a complete model)

mod = mutationModel(mat)
isMutationModel(mod)

</code></pre>

<hr>
<h2 id='lumpedMatrix'>Combine alleles in a mutation matrix</h2><span id='topic+lumpedMatrix'></span><span id='topic+lumpedModel'></span>

<h3>Description</h3>

<p>Reduce a mutation matrix by combining a set of alleles into one &quot;lump&quot;, if
this can be done without distorting the mutation process of the remaining
alleles. Such &quot;allele lumping&quot; can give dramatic efficiency improvements in
likelihood computations with multi-allelic markers, in cases where only some
of the alleles are observed in the pedigree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lumpedMatrix(mutmat, lump, afreq = NULL, check = TRUE, labelSep = NULL)

lumpedModel(mutmod, lump, afreq = NULL, check = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lumpedMatrix_+3A_mutmat">mutmat</code></td>
<td>
<p>A <code>mutationMatrix</code> object, typically made with
<code><a href="#topic+mutationMatrix">mutationMatrix()</a></code>.</p>
</td></tr>
<tr><td><code id="lumpedMatrix_+3A_lump">lump</code></td>
<td>
<p>A nonempty subset of the alleles (i.e., the column names of
<code>mutmat</code>), or a list of several such subsets.</p>
</td></tr>
<tr><td><code id="lumpedMatrix_+3A_afreq">afreq</code></td>
<td>
<p>A vector with frequency vector, of the same length as the size
of <code>mutmat</code>. If not given, the <code>afreq</code> attribute of the matrix is used.</p>
</td></tr>
<tr><td><code id="lumpedMatrix_+3A_check">check</code></td>
<td>
<p>A logical indicating if lumpability should be checked before
lumping. Default: TRUE.</p>
</td></tr>
<tr><td><code id="lumpedMatrix_+3A_labelsep">labelSep</code></td>
<td>
<p>((For debugging) A character used to name lumps by pasting
allele labels.</p>
</td></tr>
<tr><td><code id="lumpedMatrix_+3A_mutmod">mutmod</code></td>
<td>
<p>A <code>mutationModel</code> object, typically made with
<code><a href="#topic+mutationModel">mutationModel()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A reduced mutation model. If the original matrix has dimensions
<code class="reqn">n\times n</code>, the result will be <code class="reqn">k\times k</code>, where <code class="reqn">k
  = n - length(lump) + 1</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mutationModel">mutationModel()</a></code>, <code><a href="#topic+mutationMatrix">mutationMatrix()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

### Example 1: Lumping a mutation matrix
mat = mutationMatrix("eq", alleles = 1:5,
                     afreq = rep(0.2, 5), rate = 0.1)
mat

# Lump alleles 3, 4 and 5
mat2 = lumpedMatrix(mat, lump = 3:5)
mat2

# Example 2: Full model, proportional
mutrate = list(male = 0.1, female = 0.2)
mod = mutationModel("prop", alleles = 1:4,
                    rate = mutrate, afreq = c(.1,.2,.3,.4))
mod

# Lump alleles 3 and 4
mod2 = lumpedModel(mod, lump = 3:4)
mod2

</code></pre>

<hr>
<h2 id='maxRate'>Upper limits for overall mutation rate for the stepwise reversible model.</h2><span id='topic+maxRate'></span>

<h3>Description</h3>

<p>Upper limits for overall mutation rate for the stepwise reversible model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maxRate(alleles, afreq, range)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="maxRate_+3A_alleles">alleles</code></td>
<td>
<p>A character vector with allele labels.</p>
</td></tr>
<tr><td><code id="maxRate_+3A_afreq">afreq</code></td>
<td>
<p>A numeric vector of allele frequencies.</p>
</td></tr>
<tr><td><code id="maxRate_+3A_range">range</code></td>
<td>
<p>A positive number.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of two numbers named <code>UW</code> and <code>UB</code>. The first of these is
the maximum overall mutation rate for a well-defined stepwise reversible
mutation matrix with the given input. The latter (UB) is the upper limit of
the overall mutation rate under the additional restraint that the model is
bounded by <code>afreq</code>.
</p>


<h3>Author(s)</h3>

<p>Thore Egeland.
</p>

<hr>
<h2 id='model_properties'>Mutation model properties</h2><span id='topic+model_properties'></span><span id='topic+isStationary'></span><span id='topic+isReversible'></span><span id='topic+isBounded'></span><span id='topic+isLumpable'></span><span id='topic+alwaysLumpable'></span>

<h3>Description</h3>

<p>Functions for checking various properties of a mutation model, including
stationarity, reversibility and lumpability.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isStationary(mutmat, afreq = NULL)

isReversible(mutmat, afreq = NULL)

isBounded(mutmat, afreq = NULL)

isLumpable(mutmat, lump)

alwaysLumpable(mutmat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="model_properties_+3A_mutmat">mutmat</code></td>
<td>
<p>A <code><a href="#topic+mutationMatrix">mutationMatrix()</a></code> or a <code><a href="#topic+mutationModel">mutationModel()</a></code>.</p>
</td></tr>
<tr><td><code id="model_properties_+3A_afreq">afreq</code></td>
<td>
<p>A vector with allele frequencies, of the same length as the size
of <code>mutmat</code>.</p>
</td></tr>
<tr><td><code id="model_properties_+3A_lump">lump</code></td>
<td>
<p>A nonempty subset of the colnames of <code>mutmat</code> (i.e. the allele
labels).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>isBounded()</code> checks that a mutation model is <em>bounded</em> by the
allele frequencies, i.e., that <code>mutmat[i,j] &lt;= afreq[j]</code> whenever <code>i</code> is not
equal to <code>j</code>.
</p>
<p>For each of these functions, if <code>mutmat</code> is a <code>mutationModel</code> object, i.e.,
with male and female components, the output is TRUE if and only if both
components satisfy the property in question.
</p>


<h3>Value</h3>

<p>Each of these functions returns TRUE of FALSE.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# "proportional" models are stationary and reversible
afr = c(0.2, 0.3, 0.5)
m_prop = mutationMatrix(model = "prop", alleles = 1:3, afreq = afr, rate = 0.1)
stopifnot(isStationary(m_prop, afr), isReversible(m_prop, afr))

# "equal" model is stationary and reversible only when freqs are equal
m_eq = mutationMatrix(model = "eq", alleles = 1:3, rate = 0.1)
stopifnot(isStationary(m_eq, rep(1/3, 3)), isReversible(m_eq, rep(1/3, 3)))
stopifnot(!isStationary(m_eq, afr), !isReversible(m_eq, afr))

# "equal" and "proportional" models allow allele lumping
stopifnot(isLumpable(m_eq, lump = 1:2))
stopifnot(isLumpable(m_prop, lump = 1:2))

# In fact lumpable for any allele subset
stopifnot(alwaysLumpable(m_eq), alwaysLumpable(m_prop))

</code></pre>

<hr>
<h2 id='mutationMatrix'>Mutation matrix</h2><span id='topic+mutationMatrix'></span><span id='topic+validateMutationMatrix'></span>

<h3>Description</h3>

<p>Construct mutation matrices for pedigree likelihood computations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mutationMatrix(
  model = c("custom", "equal", "proportional", "random", "onestep", "stepwise",
    "trivial"),
  matrix = NULL,
  alleles = NULL,
  afreq = NULL,
  rate = NULL,
  seed = NULL,
  rate2 = NULL,
  range = NULL
)

validateMutationMatrix(mutmat, alleles = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mutationMatrix_+3A_model">model</code></td>
<td>
<p>A string: either &quot;custom&quot;, &quot;equal&quot;, &quot;proportional&quot;, &quot;random&quot;,
&quot;stepwise&quot; or &quot;onestep&quot;.</p>
</td></tr>
<tr><td><code id="mutationMatrix_+3A_matrix">matrix</code></td>
<td>
<p>When <code>model</code> is &quot;custom&quot;, this must be a square matrix with
nonnegative real entries and row sums equal to 1.</p>
</td></tr>
<tr><td><code id="mutationMatrix_+3A_alleles">alleles</code></td>
<td>
<p>A character vector (or coercible to character) with allele
labels. Required in all models, except &quot;custom&quot; if <code>matrix</code> has dimnames.</p>
</td></tr>
<tr><td><code id="mutationMatrix_+3A_afreq">afreq</code></td>
<td>
<p>A numeric vector of allele frequencies. Required in model
&quot;proportional&quot;.</p>
</td></tr>
<tr><td><code id="mutationMatrix_+3A_rate">rate</code></td>
<td>
<p>A number between 0 and 1. Required in models &quot;equal&quot;,
&quot;proportional&quot;, &quot;stepwise&quot; and &quot;onestep&quot;.</p>
</td></tr>
<tr><td><code id="mutationMatrix_+3A_seed">seed</code></td>
<td>
<p>A single number. Optional parameter in the &quot;random&quot; model, passed
on to <code>set.seed()</code>.</p>
</td></tr>
<tr><td><code id="mutationMatrix_+3A_rate2">rate2</code></td>
<td>
<p>A number between 0 and 1. The mutation rate between integer
alleles and microvariants. Required in the &quot;stepwise&quot; model.</p>
</td></tr>
<tr><td><code id="mutationMatrix_+3A_range">range</code></td>
<td>
<p>A positive number. The relative probability of mutating n+1
steps versus mutating n steps. Required  in the &quot;stepwise&quot; model.</p>
</td></tr>
<tr><td><code id="mutationMatrix_+3A_mutmat">mutmat</code></td>
<td>
<p>An object of class <code>mutationMatrix</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Descriptions of the models:
</p>

<ul>
<li> <p><code>custom</code> : Allows any mutation matrix to be provided by the user, in the
<code>matrix</code> parameter.
</p>
</li>
<li> <p><code>equal</code> :  All mutations equally likely; probability <code class="reqn">1-rate</code> of no
mutation.
</p>
</li>
<li> <p><code>proportional</code> : Mutation probabilities are proportional to the target
allele frequencies.
</p>
</li>
<li> <p><code>random</code> : This produces a matrix of random numbers, where each row is
normalised so that it sums to 1.
</p>
</li>
<li> <p><code>onestep</code>: A mutation model for microsatellite markers, allowing mutations
only to the nearest neighbours in the allelic ladder. For example, '10' may
mutate to either '9' or '11', unless '10' is the lowest allele, in which case
'11' is the only option. This model is not applicable to loci with
non-integral microvariants.
</p>
</li>
<li> <p><code>stepwise</code>: A common model in forensic genetics, allowing different
mutation rates between integer alleles (like '16') and non-integer
&quot;microvariants&quot; like '9.3'). Mutations also depend on the size of the
mutation if the parameter 'range' differs from 1.
</p>
</li>
<li> <p><code>trivial</code> : The identity matrix; i.e. no mutations are possible.
</p>
</li></ul>



<h3>Value</h3>

<p>A square matrix with entries in <code style="white-space: pre;">&#8288;[0, 1]&#8288;</code>, with the allele labels as
both colnames and rownames.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mutationMatrix(alleles = 1:3, model = "equal", rate = 0.05)

</code></pre>

<hr>
<h2 id='mutationModel'>Mutation models</h2><span id='topic+mutationModel'></span><span id='topic+validateMutationModel'></span><span id='topic+sexEqual'></span>

<h3>Description</h3>

<p>Constructor for the class <code>mutationModel</code>. An object of this class is
essentially a list of two mutation matrices, named &quot;female&quot; and &quot;male&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mutationModel(
  model,
  alleles = NULL,
  afreq = NULL,
  matrix = NULL,
  rate = NULL,
  rate2 = NULL,
  range = NULL,
  seed = NULL,
  validate = TRUE
)

validateMutationModel(mutmod, alleles = NULL)

sexEqual(mutmod)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mutationModel_+3A_model">model</code></td>
<td>
<p>Either:
</p>

<ul>
<li><p> a <code>mutationModel</code> object (returned unchanged after validation)
</p>
</li>
<li><p> a single <code>mutationMatrix</code> object (will be applied to both genders)
</p>
</li>
<li><p> a list of two <code>mutationMatrix</code> objects, named &quot;female&quot; and &quot;male&quot;
</p>
</li>
<li><p> a single model name (see <code><a href="#topic+mutationMatrix">mutationMatrix()</a></code> for valid options)
</p>
</li>
<li><p> a list of two model names, named &quot;female&quot; and &quot;male&quot;
</p>
</li></ul>
</td></tr>
<tr><td><code id="mutationModel_+3A_alleles">alleles</code></td>
<td>
<p>A character vector with allele labels; passed on to
<code><a href="#topic+mutationMatrix">mutationMatrix()</a></code>.</p>
</td></tr>
<tr><td><code id="mutationModel_+3A_afreq">afreq</code></td>
<td>
<p>A numeric vector of allele frequencies; passed on to
<code><a href="#topic+mutationMatrix">mutationMatrix()</a></code>.</p>
</td></tr>
<tr><td><code id="mutationModel_+3A_matrix">matrix</code></td>
<td>
<p>A matrix, or a list of two (named &quot;female&quot; and &quot;male&quot;)</p>
</td></tr>
<tr><td><code id="mutationModel_+3A_rate">rate</code></td>
<td>
<p>A numeric mutation rate, or a list of two (named &quot;female&quot; and
&quot;male&quot;)</p>
</td></tr>
<tr><td><code id="mutationModel_+3A_rate2">rate2</code></td>
<td>
<p>A numeric mutation rate, or a list of two (named &quot;female&quot; and
&quot;male&quot;). Required in the &quot;stepwise&quot; model; see <code><a href="#topic+mutationMatrix">mutationMatrix()</a></code> for
details.</p>
</td></tr>
<tr><td><code id="mutationModel_+3A_range">range</code></td>
<td>
<p>A positive number, or a list of two (named &quot;female&quot; and &quot;male&quot;).
Required in the &quot;stepwise&quot; model; see <code><a href="#topic+mutationMatrix">mutationMatrix()</a></code> for details.</p>
</td></tr>
<tr><td><code id="mutationModel_+3A_seed">seed</code></td>
<td>
<p>An integer, or a list of two (named &quot;female&quot; and &quot;male&quot;).</p>
</td></tr>
<tr><td><code id="mutationModel_+3A_validate">validate</code></td>
<td>
<p>A logical, by default TRUE.</p>
</td></tr>
<tr><td><code id="mutationModel_+3A_mutmod">mutmod</code></td>
<td>
<p>A <code>mutationModel</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>mutationModel</code>. This is a list of two
<code>mutationMatrix</code> objects, named &quot;female&quot; and &quot;male&quot;, and the following
attributes:
</p>

<ul>
<li> <p><code>sexEqual</code> : TRUE if both genders have identical models, otherwise FALSE
</p>
</li>
<li> <p><code>alwaysLumpable</code> : TRUE if both genders have models that are lumpable for
any allele subset, otherwise FALSE
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># "Equal" model, same parameters for both genders
M1 = mutationModel("eq", alleles = 1:2, rate = 0.1)
M1

# Different mutation rates
M2 = mutationModel("eq", alleles = 1:2, rate = list(male = 0.1, female = 0.01))
M2

stopifnot(identical(M1$male, M1$female), identical(M2$male, M1$male))

# A custom mutation matrix:
mat = matrix(c(0,0,1,1), ncol = 2, dimnames = list(1:2, 1:2))
M3 = mutationModel(model = "custom", matrix = mat)

# Under the hood arguments are passed to `mutationMatrix()`.
# Alternatively, this can be done explicitly in the `model` argument
M4 = mutationModel(model = mutationMatrix("custom", matrix = mat))

stopifnot(identical(M3, M4))

# The latter strategy is needed e.g. in pedtools::marker(), which gives the
# user access to `model`, but not `matrix`.

</code></pre>

<hr>
<h2 id='mutRate'>Overall mutation rate</h2><span id='topic+mutRate'></span>

<h3>Description</h3>

<p>Calculate the overall mutation rate at a locus, given a mutation model an a
set of allele frequencies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mutRate(mut, afreq = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mutRate_+3A_mut">mut</code></td>
<td>
<p>A <code><a href="#topic+mutationModel">mutationModel()</a></code> or <code><a href="#topic+mutationMatrix">mutationMatrix()</a></code>.</p>
</td></tr>
<tr><td><code id="mutRate_+3A_afreq">afreq</code></td>
<td>
<p>A vector of allele frequencies.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The mutation rate is found by the formula <code>1 - sum(diag(mut) * afreq)</code>.
</p>
<p>If <code>mut</code> is a <code><a href="#topic+mutationModel">mutationModel()</a></code>, the rate is calculated separately for the
male and female matrices.
</p>


<h3>Value</h3>

<p>A single number, or (if <code>mut</code> is a <code><a href="#topic+mutationModel">mutationModel()</a></code> and the female
and male rates differ) a list of two numbers, named &quot;female&quot; and &quot;male&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m = mutationMatrix("stepwise", alleles = 1:4, afreq = c(.1,.2,.3,.4),
                   rate = 0.01, rate2 = 1e-6, range = 0.1)
r = mutRate(m)

stopifnot(all.equal(r, 0.01))
</code></pre>

<hr>
<h2 id='stabilize'>Stabilization of mutation matrix</h2><span id='topic+stabilize'></span>

<h3>Description</h3>

<p>Produces a mutation matrix close to the input <code>mutmat</code>, for which the given
frequency vector is the stationary distribution. Several methods for doing
this are described by Simonsson and Mostad (2016); only the &quot;PM&quot; method is
included here.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stabilize(mutmat, afreq = NULL, method = "PM", details = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stabilize_+3A_mutmat">mutmat</code></td>
<td>
<p>A mutation matrix.</p>
</td></tr>
<tr><td><code id="stabilize_+3A_afreq">afreq</code></td>
<td>
<p>A vector of allele frequencies</p>
</td></tr>
<tr><td><code id="stabilize_+3A_method">method</code></td>
<td>
<p>Either &quot;DP&quot;, &quot;RM&quot; or &quot;PM&quot;. Currently only &quot;PM&quot; is implemented.</p>
</td></tr>
<tr><td><code id="stabilize_+3A_details">details</code></td>
<td>
<p>A logical. If TRUE, the complete Familias output is included.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is based on, and reuses code from, the <code>stabilize()</code> method of
the Familias R package.
</p>


<h3>Value</h3>

<p>An object of the same class the input <code>mutmat</code>; either a matrix, a
<code>mutationMatrix</code> or a <code>mutationModel</code>.
</p>


<h3>Author(s)</h3>

<p>Petter Mostad, Thore Egeland, Ivar Simonsson, Magnus D. Vigeland
</p>


<h3>References</h3>

<p>Simonsson, Mostad: Stationary Mutation models. (FSI: Genetics,
2016).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
afreq = c(.2, .3, .5)
m = mutationMatrix("stepwise", alleles = 1:3, afreq = afreq,
                   rate = 0.1, rate2 = 0.01, range = 0.1)
m
stabilize(m, afreq = c(.3,.3,.4))


### Example with full model (i.e., male and female)

M = mutationModel("stepwise", alleles = 1:3, afreq = afreq,
                   rate = list(male = 0.1, female = 0.2),
                   rate2 = 0.01, range = 0.1)
M
stabilize(M)

</code></pre>

<hr>
<h2 id='stepwiseReversible'>Reversible stepwise mutation model</h2><span id='topic+stepwiseReversible'></span>

<h3>Description</h3>

<p>A reversible stepwise mutation model is created following the approach of
Dawid et al. (2002).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stepwiseReversible(alleles, afreq, rate, range, maxRateOnly = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stepwiseReversible_+3A_alleles">alleles</code></td>
<td>
<p>A vector of integer integers.</p>
</td></tr>
<tr><td><code id="stepwiseReversible_+3A_afreq">afreq</code></td>
<td>
<p>A numeric vector of allele frequencies.</p>
</td></tr>
<tr><td><code id="stepwiseReversible_+3A_rate">rate</code></td>
<td>
<p>A numeric mutation rate.</p>
</td></tr>
<tr><td><code id="stepwiseReversible_+3A_range">range</code></td>
<td>
<p>A positive number.</p>
</td></tr>
<tr><td><code id="stepwiseReversible_+3A_maxrateonly">maxRateOnly</code></td>
<td>
<p>A logical, by default FALSE. See Value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the stepwise reversible model, the mutation rate <code class="reqn">r_{i,j},\,  i\neq
j</code> is proportional to the overall mutation rate <code class="reqn">\lambda</code> for given
values of the range, the allele frequency <code class="reqn">p_i</code> and n, the number of
alleles. Hence, one can determine bounds UW and UB so that the model is well
defined if <code class="reqn">\lambda \leq UW</code> and bounded, i.e., <code class="reqn">r_{i,j} \leq p_j,\,
i\neq j</code>, if <code class="reqn">\lambda \leq UB</code>, The bounds UW and UB are computed.
</p>


<h3>Value</h3>

<p>A reversible stepwise mutation model with overall mutation rate equal
to <code>rate</code>.
</p>
<p>If <code>maxRateOnly</code> is TRUE, the function returns a vector of two numbers
named <code>UW</code> and <code>UB</code>. The first of these is the maximum overall mutation
rate for a well-defined stepwise reversible mutation matrix with the given
input. The latter (UB) is the maximum rate under the additional restraint
that the model is bounded by <code>afreq</code>.
</p>


<h3>Author(s)</h3>

<p>Thore Egeland.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>stepwiseReversible(alleles = 1:3,
                   afreq = c(0.2, 0.3,  0.5),
                   rate = 0.001,
                   range = 0.1)

stepwiseReversible(alleles = 1:3,
                   afreq = c(0.2, 0.3,  0.5),
                   range = 0.1,
                   maxRateOnly = TRUE)

# Model not well defined:
## Not run: 
stepwiseReversible(alleles = 1:3,
                   afreq = c(0.2, 0.3,  0.5),
                   rate = 0.7,
                   range = 0.1)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
