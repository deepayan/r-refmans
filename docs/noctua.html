<!DOCTYPE html><html lang="en"><head><title>Help for package noctua</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {noctua}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#noctua-package'><p>noctua: a DBI interface into Athena using paws SDK</p></a></li>
<li><a href='#assume_role'><p>Assume AWS ARN Role</p></a></li>
<li><a href='#athena'><p>Athena Driver</p></a></li>
<li><a href='#AthenaConnection'><p>Athena Connection Methods</p></a></li>
<li><a href='#AthenaDriver'><p>Athena Driver Methods</p></a></li>
<li><a href='#AthenaWriteTables'><p>Convenience functions for reading/writing DBMS tables</p></a></li>
<li><a href='#backend_dbplyr_v1'><p>Athena S3 implementation of dbplyr backend functions (api version 1).</p></a></li>
<li><a href='#backend_dbplyr_v2'><p>Athena S3 implementation of dbplyr backend functions (api version 2).</p></a></li>
<li><a href='#db_compute'><p>S3 implementation of <code>db_compute</code> for Athena</p></a></li>
<li><a href='#db_connection_describe'><p>S3 implementation of <code>db_connection_describe</code> for Athena (api version 2).</p></a></li>
<li><a href='#db_copy_to'><p>S3 implementation of <code>db_copy_to</code> for Athena</p></a></li>
<li><a href='#db_desc'><p>S3 implementation of <code>db_desc</code> for Athena (api version 1).</p></a></li>
<li><a href='#dbClearResult'><p>Clear Results</p></a></li>
<li><a href='#dbColumnInfo'><p>Information about result types</p></a></li>
<li><a href='#dbConnect+2CAthenaDriver-method'><p>Connect to Athena using R's sdk paws</p></a></li>
<li><a href='#dbConvertTable'><p>Simple wrapper to convert Athena backend file types</p></a></li>
<li><a href='#dbDataType+2CAthenaDriver+2CANY-method'><p>Determine SQL data type of object</p></a></li>
<li><a href='#dbDisconnect'><p>Disconnect (close) an Athena connection</p></a></li>
<li><a href='#dbExistsTable'><p>Does Athena table exist?</p></a></li>
<li><a href='#dbFetch'><p>Fetch records from previously executed query</p></a></li>
<li><a href='#dbGetInfo'><p>Get DBMS metadata</p></a></li>
<li><a href='#dbGetPartition'><p>Athena table partitions</p></a></li>
<li><a href='#dbGetQuery'><p>Send query, retrieve results and then clear result set</p></a></li>
<li><a href='#dbGetStatement'><p>Get the statement associated with a result set</p></a></li>
<li><a href='#dbGetTables'><p>List Athena Schema, Tables and Table Types</p></a></li>
<li><a href='#dbHasCompleted'><p>Completion status</p></a></li>
<li><a href='#dbIsValid'><p>Is this DBMS object still valid?</p></a></li>
<li><a href='#dbListFields'><p>List Field names of Athena table</p></a></li>
<li><a href='#dbListTables'><p>List Athena Tables</p></a></li>
<li><a href='#dbplyr_edition'><p>Declare which version of dbplyr API is being called.</p></a></li>
<li><a href='#dbQuote'><p>Quote Identifiers</p></a></li>
<li><a href='#dbRemoveTable'><p>Remove table from Athena</p></a></li>
<li><a href='#dbShow'><p>Show Athena table's DDL</p></a></li>
<li><a href='#dbStatistics'><p>Show AWS Athena Statistics</p></a></li>
<li><a href='#noctua_options'><p>A method to configure noctua backend options.</p></a></li>
<li><a href='#Query'><p>Execute a query on Athena</p></a></li>
<li><a href='#session_token'><p>Get Session Tokens for PAWS Connection</p></a></li>
<li><a href='#sql_translate_env'><p>AWS Athena backend dbplyr version 1 and 2</p></a></li>
<li><a href='#sqlCreateTable'><p>Creates query to create a simple Athena table</p></a></li>
<li><a href='#sqlData'><p>Converts data frame into suitable format to be uploaded to Athena</p></a></li>
<li><a href='#work_group'><p>Athena Work Groups</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Connect to 'AWS Athena' using R 'AWS SDK' 'paws' ('DBI'
Interface)</td>
</tr>
<tr>
<td>Version:</td>
<td>2.6.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Designed to be compatible with the 'R' package 'DBI' (Database Interface)
    when connecting to Amazon Web Service ('AWS') Athena <a href="https://aws.amazon.com/athena/">https://aws.amazon.com/athena/</a>.
    To do this the 'R' 'AWS' Software Development Kit ('SDK') 'paws' 
    <a href="https://github.com/paws-r/paws">https://github.com/paws-r/paws</a> is used as a driver.</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table (&ge; 1.12.4), DBI (&ge; 0.7), methods, paws (&ge;
0.2.0), stats, utils, uuid (&ge; 0.1-4)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>arrow, bit64, dplyr (&ge; 0.8.0), dbplyr (&ge; 1.4.3), testthat,
tibble, vroom (&ge; 1.2.0), covr, knitr, rmarkdown, jsonify,
jsonlite</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/DyfanJones/noctua">https://github.com/DyfanJones/noctua</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/DyfanJones/noctua/issues">https://github.com/DyfanJones/noctua/issues</a></td>
</tr>
<tr>
<td>Collate:</td>
<td>'utils.R' 'dplyr_integration.R' 'noctua.R' 'Driver.R'
'Connection.R' 'DataTypes.R' 'File_Parser.R' 'Options.R'
'fetch_utils.R' 'Result.R' 'Table.R' 'View.R'
'athena_low_api.R' 'column_parser.R' 'sql_translate_utils.R'
'sql_translate_env.R' 'zzz.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-08 17:37:19 UTC; dyfanjones</td>
</tr>
<tr>
<td>Author:</td>
<td>Dyfan Jones [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dyfan Jones &lt;dyfan.r.jones@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-08 18:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='noctua-package'>noctua: a DBI interface into Athena using paws SDK</h2><span id='topic+noctua'></span><span id='topic+noctua-package'></span>

<h3>Description</h3>

<p>noctua provides a seamless DBI interface into Athena using the R package 
<a href="https://github.com/paws-r/paws">paws</a>.
</p>


<h3>Goal of Package</h3>

<p>The goal of the <code>noctua</code> package is to provide a DBI-compliant interface to <a href="https://aws.amazon.com/athena/">Amazonâ€™s Athena</a>
using <code>paws</code> software development kit (SDK). This allows for an efficient, easy setup connection to Athena using the <code>paws</code> SDK as a driver.
</p>


<h3>AWS Command Line Interface</h3>

<p>As noctua is using <code>paws</code> as it's backend, <a href="https://aws.amazon.com/cli/">AWS Command Line Interface (AWS CLI)</a> can be used
to remove user credentials when interacting with Athena.
</p>
<p>This allows AWS profile names to be set up so that noctua can connect to different accounts from the same machine,
without needing hard code any credentials.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Dyfan Jones <a href="mailto:dyfan.r.jones@gmail.com">dyfan.r.jones@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/DyfanJones/noctua">https://github.com/DyfanJones/noctua</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/DyfanJones/noctua/issues">https://github.com/DyfanJones/noctua/issues</a>
</p>
</li></ul>


<hr>
<h2 id='assume_role'>Assume AWS ARN Role</h2><span id='topic+assume_role'></span>

<h3>Description</h3>

<p>Returns a set of temporary security credentials that you can use to access AWS resources that you might not normally have access to (<a href="https://www.paws-r-sdk.com/docs/sts_assume_role/">link</a>).
These temporary credentials consist of an access key ID, a secret access key, and a security token. Typically, you use AssumeRole within
your account or for cross-account access.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assume_role(
  profile_name = NULL,
  region_name = NULL,
  role_arn = NULL,
  role_session_name = sprintf("noctua-session-%s", as.integer(Sys.time())),
  duration_seconds = 3600L,
  set_env = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="assume_role_+3A_profile_name">profile_name</code></td>
<td>
<p>The name of a profile to use. If not given, then the default profile is used.
To set profile name, the <a href="https://aws.amazon.com/cli/">AWS Command Line Interface</a> (AWS CLI) will need to be configured.
To configure AWS CLI please refer to: <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html">Configuring the AWS CLI</a>.</p>
</td></tr>
<tr><td><code id="assume_role_+3A_region_name">region_name</code></td>
<td>
<p>Default region when creating new connections. Please refer to <a href="https://docs.aws.amazon.com/general/latest/gr/rande.html">link</a> for
AWS region codes (region code example: Region = EU (Ireland)     <code> region_name = "eu-west-1"</code>)</p>
</td></tr>
<tr><td><code id="assume_role_+3A_role_arn">role_arn</code></td>
<td>
<p>The Amazon Resource Name (ARN) of the role to assume (such as <code>arn:aws:sts::123456789012:assumed-role/role_name/role_session_name</code>)</p>
</td></tr>
<tr><td><code id="assume_role_+3A_role_session_name">role_session_name</code></td>
<td>
<p>An identifier for the assumed role session. By default 'noctua' creates a session name <code>sprintf("noctua-session-%s", as.integer(Sys.time()))</code></p>
</td></tr>
<tr><td><code id="assume_role_+3A_duration_seconds">duration_seconds</code></td>
<td>
<p>The duration, in seconds, of the role session. The value can range from 900 seconds (15 minutes) up to the maximum session duration setting for the role.
This setting can have a value from 1 hour to 12 hours. By default duration is set to 3600 seconds (1 hour).</p>
</td></tr>
<tr><td><code id="assume_role_+3A_set_env">set_env</code></td>
<td>
<p>If set to <code>TRUE</code> environmental variables <code>AWS_ACCESS_KEY_ID</code>, <code>AWS_SECRET_ACCESS_KEY</code> and <code>AWS_SESSION_TOKEN</code> will be set.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>assume_role()</code> returns a list containing: <code>"AccessKeyId"</code>, <code>"SecretAccessKey"</code>, <code>"SessionToken"</code> and <code>"Expiration"</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dbConnect">dbConnect</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.

library(noctua)
library(DBI)

# Assuming demo ARN role
assume_role(
  profile_name = "YOUR_PROFILE_NAME",
  role_arn = "arn:aws:sts::123456789012:assumed-role/role_name/role_session_name",
  set_env = TRUE
)

# Connect to Athena using ARN Role
con &lt;- dbConnect(noctua::athena())

## End(Not run)
</code></pre>

<hr>
<h2 id='athena'>Athena Driver</h2><span id='topic+athena'></span>

<h3>Description</h3>

<p>Driver for an Athena paws connection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>athena()
</code></pre>


<h3>Value</h3>

<p><code>athena()</code> returns a s4 class. This class is used active Athena method for <code><a href="DBI.html#topic+dbConnect">dbConnect</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dbConnect">dbConnect</a></code>
</p>

<hr>
<h2 id='AthenaConnection'>Athena Connection Methods</h2><span id='topic+AthenaConnection'></span><span id='topic+AthenaConnection-class'></span><span id='topic+show+2CAthenaConnection-method'></span><span id='topic+dbBegin+2CAthenaConnection-method'></span><span id='topic+dbCommit+2CAthenaConnection-method'></span><span id='topic+dbRollback+2CAthenaConnection-method'></span><span id='topic+AthenaResult-class'></span>

<h3>Description</h3>

<p>Implementations of pure virtual functions defined in the 'DBI' package
for AthenaConnection objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaConnection'
show(object)

## S4 method for signature 'AthenaConnection'
dbBegin(conn, ...)

## S4 method for signature 'AthenaConnection'
dbCommit(conn, ...)

## S4 method for signature 'AthenaConnection'
dbRollback(conn, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AthenaConnection_+3A_object">object</code></td>
<td>
<p>Any R object</p>
</td></tr>
<tr><td><code id="AthenaConnection_+3A_conn">conn</code></td>
<td>
<p>A <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a> object, as returned by
<code><a href="DBI.html#topic+dbConnect">dbConnect()</a></code>.</p>
</td></tr>
<tr><td><code id="AthenaConnection_+3A_...">...</code></td>
<td>
<p>Other parameters passed on to methods.</p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>ptr</code></dt><dd><p>a list of connecting objects from the SDK paws package.</p>
</dd>
<dt><code>info</code></dt><dd><p>a list of metadata objects</p>
</dd>
<dt><code>quote</code></dt><dd><p>syntax to quote sql query when creating Athena ddl</p>
</dd>
</dl>

<hr>
<h2 id='AthenaDriver'>Athena Driver Methods</h2><span id='topic+AthenaDriver'></span><span id='topic+AthenaDriver-class'></span><span id='topic+show+2CAthenaDriver-method'></span>

<h3>Description</h3>

<p>Implementations of pure virtual functions defined in the 'DBI' package
for AthenaDriver objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaDriver'
show(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AthenaDriver_+3A_object">object</code></td>
<td>
<p>Any R object</p>
</td></tr>
</table>

<hr>
<h2 id='AthenaWriteTables'>Convenience functions for reading/writing DBMS tables</h2><span id='topic+AthenaWriteTables'></span><span id='topic+dbWriteTable+2CAthenaConnection+2Ccharacter+2Cdata.frame-method'></span><span id='topic+dbWriteTable+2CAthenaConnection+2CId+2Cdata.frame-method'></span><span id='topic+dbWriteTable+2CAthenaConnection+2CSQL+2Cdata.frame-method'></span>

<h3>Description</h3>

<p>Convenience functions for reading/writing DBMS tables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaConnection,character,data.frame'
dbWriteTable(
  conn,
  name,
  value,
  overwrite = FALSE,
  append = FALSE,
  row.names = NA,
  field.types = NULL,
  partition = NULL,
  s3.location = NULL,
  file.type = c("tsv", "csv", "parquet", "json"),
  compress = FALSE,
  max.batch = Inf,
  ...
)

## S4 method for signature 'AthenaConnection,Id,data.frame'
dbWriteTable(
  conn,
  name,
  value,
  overwrite = FALSE,
  append = FALSE,
  row.names = NA,
  field.types = NULL,
  partition = NULL,
  s3.location = NULL,
  file.type = c("tsv", "csv", "parquet", "json"),
  compress = FALSE,
  max.batch = Inf,
  ...
)

## S4 method for signature 'AthenaConnection,SQL,data.frame'
dbWriteTable(
  conn,
  name,
  value,
  overwrite = FALSE,
  append = FALSE,
  row.names = NA,
  field.types = NULL,
  partition = NULL,
  s3.location = NULL,
  file.type = c("tsv", "csv", "parquet", "json"),
  compress = FALSE,
  max.batch = Inf,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AthenaWriteTables_+3A_conn">conn</code></td>
<td>
<p>An <code><a href="#topic+AthenaConnection-class">AthenaConnection</a></code> object, produced by [DBI::dbConnect()]</p>
</td></tr>
<tr><td><code id="AthenaWriteTables_+3A_name">name</code></td>
<td>
<p>A character string specifying a table name. Names will be
automatically quoted so you can use any sequence of characters, not
just any valid bare table name.</p>
</td></tr>
<tr><td><code id="AthenaWriteTables_+3A_value">value</code></td>
<td>
<p>A data.frame to write to the database.</p>
</td></tr>
<tr><td><code id="AthenaWriteTables_+3A_overwrite">overwrite</code></td>
<td>
<p>Allows overwriting the destination table. Cannot be <code>TRUE</code> if <code>append</code> is also <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="AthenaWriteTables_+3A_append">append</code></td>
<td>
<p>Allow appending to the destination table. Cannot be <code>TRUE</code> if <code>overwrite</code> is also <code>TRUE</code>. Existing Athena DDL file type will be retained
and used when uploading data to AWS Athena. If parameter <code>file.type</code> doesn't match AWS Athena DDL file type a warning message will be created
notifying user and <code>noctua</code> will use the file type for the Athena DDL. When appending to an Athena DDL that has been created outside of <code>noctua</code>.
<code>noctua</code> can support the following SerDes and Data Formats.
</p>

<ul>
<li><p><strong>csv/tsv:</strong> <a href="https://docs.aws.amazon.com/athena/latest/ug/lazy-simple-serde.html">LazySimpleSerDe</a>
</p>
</li>
<li><p><strong>parquet:</strong> <a href="https://docs.aws.amazon.com/athena/latest/ug/parquet.html">Parquet SerDe</a>
</p>
</li>
<li><p><strong>json:</strong> <a href="https://docs.aws.amazon.com/athena/latest/ug/json.html">JSON SerDe Libraries</a>
</p>
</li></ul>
</td></tr>
<tr><td><code id="AthenaWriteTables_+3A_row.names">row.names</code></td>
<td>
<p>Either <code>TRUE</code>, <code>FALSE</code>, <code>NA</code> or a string.
</p>
<p>If <code>TRUE</code>, always translate row names to a column called &quot;row_names&quot;.
If <code>FALSE</code>, never translate row names. If <code>NA</code>, translate
rownames only if they're a character vector.
</p>
<p>A string is equivalent to <code>TRUE</code>, but allows you to override the
default name.
</p>
<p>For backward compatibility, <code>NULL</code> is equivalent to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="AthenaWriteTables_+3A_field.types">field.types</code></td>
<td>
<p>Additional field types used to override derived types.</p>
</td></tr>
<tr><td><code id="AthenaWriteTables_+3A_partition">partition</code></td>
<td>
<p>Partition Athena table (needs to be a named list or vector) for example: <code>c(var1 = "2019-20-13")</code></p>
</td></tr>
<tr><td><code id="AthenaWriteTables_+3A_s3.location">s3.location</code></td>
<td>
<p>s3 bucket to store Athena table, must be set as a s3 uri for example (&quot;s3://mybucket/data/&quot;).
By default, the s3.location is set to s3 staging directory from <code><a href="#topic+AthenaConnection-class">AthenaConnection</a></code> object. <strong>Note:</strong>
When creating a table for the first time <code>s3.location</code> will be formatted from <code>"s3://mybucket/data/"</code> to the following
syntax <code>"s3://{mybucket/data}/{schema}/{table}/{parition}/"</code> this is to support tables with the same name but existing in different
schemas. If schema isn't specified in <code>name</code> parameter then the schema from <code>dbConnect</code> is used instead.</p>
</td></tr>
<tr><td><code id="AthenaWriteTables_+3A_file.type">file.type</code></td>
<td>
<p>What file type to store data.frame on s3, noctua currently supports [&quot;tsv&quot;, &quot;csv&quot;, &quot;parquet&quot;, &quot;json&quot;]. Default delimited file type is &quot;tsv&quot;, in previous versions
of <code>noctua (=&lt; 1.4.0)</code> file type &quot;csv&quot; was used as default. The reason for the change is that columns containing <code>Array/JSON</code> format cannot be written to
Athena due to the separating value &quot;,&quot;. This would cause issues with AWS Athena.
<strong>Note:</strong> &quot;parquet&quot; format is supported by the <code>arrow</code> package and it will need to be installed to utilise the &quot;parquet&quot; format.
&quot;json&quot; format is supported by <code>jsonlite</code> package and it will need to be installed to utilise the &quot;json&quot; format.</p>
</td></tr>
<tr><td><code id="AthenaWriteTables_+3A_compress">compress</code></td>
<td>
<p><code>FALSE | TRUE</code> To determine if to compress file.type. If file type is [&quot;csv&quot;, &quot;tsv&quot;] then &quot;gzip&quot; compression is used, for file type &quot;parquet&quot;
&quot;snappy&quot; compression is used. Currently <code>noctua</code> doesn't support compression for &quot;json&quot; file type.</p>
</td></tr>
<tr><td><code id="AthenaWriteTables_+3A_max.batch">max.batch</code></td>
<td>
<p>Split the data frame by max number of rows i.e. 100,000 so that multiple files can be uploaded into AWS S3. By default when compression
is set to <code>TRUE</code> and file.type is &quot;csv&quot; or &quot;tsv&quot; max.batch will split data.frame into 20 batches. This is to help the
performance of AWS Athena when working with files compressed in &quot;gzip&quot; format. <code>max.batch</code> will not split the data.frame
when loading file in parquet format. For more information please go to <a href="https://github.com/DyfanJones/RAthena/issues/36">link</a></p>
</td></tr>
<tr><td><code id="AthenaWriteTables_+3A_...">...</code></td>
<td>
<p>Other arguments used by individual methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dbWriteTable()</code> returns <code>TRUE</code>, invisibly. If the table exists, and both append and overwrite
arguments are unset, or append = TRUE and the data frame with the new data has different column names,
an error is raised; the remote table remains unchanged.
</p>


<h3>See Also</h3>

<p><code><a href="DBI.html#topic+dbWriteTable">dbWriteTable</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documnentation

library(DBI)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

# List existing tables in Athena
dbListTables(con)

# Write data.frame to Athena table
dbWriteTable(con, "mtcars", mtcars,
  partition = c("TIMESTAMP" = format(Sys.Date(), "%Y%m%d")),
  s3.location = "s3://mybucket/data/"
)

# Read entire table from Athena
dbReadTable(con, "mtcars")

# List all tables in Athena after uploading new table to Athena
dbListTables(con)

# Checking if uploaded table exists in Athena
dbExistsTable(con, "mtcars")

# using default s3.location
dbWriteTable(con, "iris", iris)

# Read entire table from Athena
dbReadTable(con, "iris")

# List all tables in Athena after uploading new table to Athena
dbListTables(con)

# Checking if uploaded table exists in Athena
dbExistsTable(con, "iris")

# Disconnect from Athena
dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='backend_dbplyr_v1'>Athena S3 implementation of dbplyr backend functions (api version 1).</h2><span id='topic+backend_dbplyr_v1'></span><span id='topic+db_explain.AthenaConnection'></span><span id='topic+db_query_fields.AthenaConnection'></span>

<h3>Description</h3>

<p>These functions are used to build the different types of SQL queries.
The AWS Athena implementation give extra parameters to allow access the to standard DBI Athena methods. They also
utilise AWS Glue to speed up sql query execution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>db_explain.AthenaConnection(con, sql, ...)

db_query_fields.AthenaConnection(con, sql, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="backend_dbplyr_v1_+3A_con">con</code></td>
<td>
<p>A <code><a href="#topic+dbConnect">dbConnect</a></code> object, as returned by <code>dbConnect()</code></p>
</td></tr>
<tr><td><code id="backend_dbplyr_v1_+3A_sql">sql</code></td>
<td>
<p>SQL code to be sent to AWS Athena</p>
</td></tr>
<tr><td><code id="backend_dbplyr_v1_+3A_...">...</code></td>
<td>
<p>other parameters, currently not implemented</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt>db_explain</dt><dd><p>Returns <a href="https://docs.aws.amazon.com/athena/latest/ug/athena-explain-statement.html">AWS Athena explain statement</a></p>
</dd>
<dt>db_query_fields</dt><dd><p>Returns sql query column names</p>
</dd>
</dl>


<hr>
<h2 id='backend_dbplyr_v2'>Athena S3 implementation of dbplyr backend functions (api version 2).</h2><span id='topic+backend_dbplyr_v2'></span><span id='topic+sql_query_explain.AthenaConnection'></span><span id='topic+sql_query_fields.AthenaConnection'></span><span id='topic+sql_escape_date.AthenaConnection'></span><span id='topic+sql_escape_datetime.AthenaConnection'></span>

<h3>Description</h3>

<p>These functions are used to build the different types of SQL queries.
The AWS Athena implementation give extra parameters to allow access the to standard DBI Athena methods. They also
utilise AWS Glue to speed up sql query execution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sql_query_explain.AthenaConnection(con, sql, format = "text", type = NULL, ...)

sql_query_fields.AthenaConnection(con, sql, ...)

sql_escape_date.AthenaConnection(con, x)

sql_escape_datetime.AthenaConnection(con, x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="backend_dbplyr_v2_+3A_con">con</code></td>
<td>
<p>A <code><a href="#topic+dbConnect">dbConnect</a></code> object, as returned by <code>dbConnect()</code></p>
</td></tr>
<tr><td><code id="backend_dbplyr_v2_+3A_sql">sql</code></td>
<td>
<p>SQL code to be sent to AWS Athena</p>
</td></tr>
<tr><td><code id="backend_dbplyr_v2_+3A_format">format</code></td>
<td>
<p>returning format for explain queries, default set to '&quot;text&quot;'. Other formats can be found: <a href="https://docs.aws.amazon.com/athena/latest/ug/athena-explain-statement.html">https://docs.aws.amazon.com/athena/latest/ug/athena-explain-statement.html</a></p>
</td></tr>
<tr><td><code id="backend_dbplyr_v2_+3A_type">type</code></td>
<td>
<p>return plan for explain queries, default set to 'NULL'. Other type can be found: <a href="https://docs.aws.amazon.com/athena/latest/ug/athena-explain-statement.html">https://docs.aws.amazon.com/athena/latest/ug/athena-explain-statement.html</a></p>
</td></tr>
<tr><td><code id="backend_dbplyr_v2_+3A_...">...</code></td>
<td>
<p>other parameters, currently not implemented</p>
</td></tr>
<tr><td><code id="backend_dbplyr_v2_+3A_x">x</code></td>
<td>
<p>R object to be transformed into athena equivalent</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt>sql_query_explain</dt><dd><p>Returns sql query for <a href="https://docs.aws.amazon.com/athena/latest/ug/athena-explain-statement.html">AWS Athena explain statement</a></p>
</dd>
<dt>sql_query_fields</dt><dd><p>Returns sql query column names</p>
</dd>
<dt>sql_escape_date</dt><dd><p>Returns sql escaping from dates</p>
</dd>
<dt>sql_escape_datetime</dt><dd><p>Returns sql escaping from date times</p>
</dd>
</dl>


<hr>
<h2 id='db_compute'>S3 implementation of <code>db_compute</code> for Athena</h2><span id='topic+db_compute'></span><span id='topic+db_compute.AthenaConnection'></span><span id='topic+sql_query_save.AthenaConnection'></span>

<h3>Description</h3>

<p>This is a backend function for dplyr's <code>compute</code> function. Users won't be required to access and run this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>db_compute.AthenaConnection(
  con,
  table,
  sql,
  ...,
  overwrite = FALSE,
  temporary = FALSE,
  unique_indexes = list(),
  indexes = list(),
  analyze = TRUE,
  in_transaction = FALSE,
  partition = NULL,
  s3_location = NULL,
  file_type = c("csv", "tsv", "parquet"),
  compress = FALSE
)

sql_query_save.AthenaConnection(con, sql, name, temporary = TRUE, with, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="db_compute_+3A_con">con</code></td>
<td>
<p>A <code><a href="#topic+dbConnect">dbConnect</a></code> object, as returned by <code>dbConnect()</code></p>
</td></tr>
<tr><td><code id="db_compute_+3A_table">table</code></td>
<td>
<p>Table name, if left default noctua will use the default from <code>dplyr</code>'s <code>compute</code> function.</p>
</td></tr>
<tr><td><code id="db_compute_+3A_sql">sql</code></td>
<td>
<p>SQL code to be sent to the data</p>
</td></tr>
<tr><td><code id="db_compute_+3A_...">...</code></td>
<td>
<p>passes <code>noctua</code> table creation parameters: [<code>file_type</code>,<code>s3_location</code>,<code>partition</code>]</p>
</td></tr>
<tr><td><code id="db_compute_+3A_overwrite">overwrite</code></td>
<td>
<p>Allows overwriting the destination table. Cannot be <code>TRUE</code> if <code>append</code> is also <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="db_compute_+3A_temporary">temporary</code></td>
<td>
<p>if TRUE, will create a temporary table that is local to this connection and will be automatically deleted when the connection expires</p>
</td></tr>
<tr><td><code id="db_compute_+3A_unique_indexes">unique_indexes</code></td>
<td>
<p>a list of character vectors. Each element of the list will create a new unique index over the specified column(s). Duplicate rows will result in failure.</p>
</td></tr>
<tr><td><code id="db_compute_+3A_indexes">indexes</code></td>
<td>
<p>a list of character vectors. Each element of the list will create a new index.</p>
</td></tr>
<tr><td><code id="db_compute_+3A_analyze">analyze</code></td>
<td>
<p>if TRUE (the default), will automatically ANALYZE the new table so that the query optimiser has useful information.</p>
</td></tr>
<tr><td><code id="db_compute_+3A_in_transaction">in_transaction</code></td>
<td>
<p>Should the table creation be wrapped in a transaction? This typically makes things faster, but you may want to suppress if the database doesn't support transactions, or you're wrapping in a transaction higher up (and your database doesn't support nested transactions.)</p>
</td></tr>
<tr><td><code id="db_compute_+3A_partition">partition</code></td>
<td>
<p>Partition Athena table (needs to be a named list or vector) for example: <code>c(var1 = "2019-20-13")</code></p>
</td></tr>
<tr><td><code id="db_compute_+3A_s3_location">s3_location</code></td>
<td>
<p>s3 bucket to store Athena table, must be set as a s3 uri for example (&quot;s3://mybucket/data/&quot;)</p>
</td></tr>
<tr><td><code id="db_compute_+3A_file_type">file_type</code></td>
<td>
<p>What file type to store data.frame on s3, noctua currently supports [&quot;tsv&quot;, &quot;csv&quot;, &quot;parquet&quot;]. Default delimited file type is &quot;tsv&quot;, in previous versions
of <code>noctua (=&lt; 1.4.0)</code> file type &quot;csv&quot; was used as default. The reason for the change is that columns containing <code>Array/JSON</code> format cannot be written to
Athena due to the separating value &quot;,&quot;. This would cause issues with AWS Athena.
<strong>Note:</strong> &quot;parquet&quot; format is supported by the <code>arrow</code> package and it will need to be installed to utilise the &quot;parquet&quot; format.</p>
</td></tr>
<tr><td><code id="db_compute_+3A_compress">compress</code></td>
<td>
<p><code>FALSE | TRUE</code> To determine if to compress file.type. If file type is [&quot;csv&quot;, &quot;tsv&quot;] then &quot;gzip&quot; compression is used, for file type &quot;parquet&quot;
&quot;snappy&quot; compression is used.</p>
</td></tr>
<tr><td><code id="db_compute_+3A_name">name</code></td>
<td>
<p>Table name, if left default noctua will use the default from <code>dplyr</code>'s <code>compute</code> function.</p>
</td></tr>
<tr><td><code id="db_compute_+3A_with">with</code></td>
<td>
<p>An optional WITH clause for the CREATE TABLE statement.
</p>

<ul>
<li><p><code>file_type:</code> What file type to store data.frame on s3, noctua currently supports [&quot;NULL&quot;,&quot;csv&quot;, &quot;parquet&quot;, &quot;json&quot;].
<code>"NULL"</code> will let Athena set the file_type for you.
</p>
</li>
<li><p><code>s3_location:</code> s3 bucket to store Athena table, must be set as a s3 uri for example (&quot;s3://mybucket/data/&quot;)
</p>
</li>
<li><p><code>partition:</code> Partition Athena table, requires to be a partitioned variable from previous table.</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p><code>db_compute</code> returns table name
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AthenaWriteTables">AthenaWriteTables</a></code> <code><a href="#topic+backend_dbplyr_v2">backend_dbplyr_v2</a></code> <code><a href="#topic+backend_dbplyr_v1">backend_dbplyr_v1</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documentation

library(DBI)
library(dplyr)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

# Write data.frame to Athena table
copy_to(con, mtcars,
  s3_location = "s3://mybucket/data/"
)

# Write Athena table from tbl_sql
athena_mtcars &lt;- tbl(con, "mtcars")
mtcars_filter &lt;- athena_mtcars %&gt;% filter(gear &gt;= 4)

# create athena with unique table name
mtcars_filer %&gt;%
  compute()

# create athena with specified name and s3 location
mtcars_filer %&gt;%
  compute("mtcars_filer",
    s3_location = "s3://mybucket/mtcars_filer/"
  )

# Disconnect from Athena
dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='db_connection_describe'>S3 implementation of <code>db_connection_describe</code> for Athena (api version 2).</h2><span id='topic+db_connection_describe'></span><span id='topic+db_connection_describe.AthenaConnection'></span>

<h3>Description</h3>

<p>This is a backend function for dplyr to retrieve meta data about Athena queries. Users won't be required to access and run this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>db_connection_describe.AthenaConnection(con)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="db_connection_describe_+3A_con">con</code></td>
<td>
<p>A <code><a href="#topic+dbConnect">dbConnect</a></code> object, as returned by <code>dbConnect()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character variable containing Meta Data about query sent to Athena. The Meta Data is returned in the following format:
</p>
<p><code>"Athena &lt;paws version&gt; [&lt;profile_name&gt;@region/database]"</code>
</p>

<hr>
<h2 id='db_copy_to'>S3 implementation of <code>db_copy_to</code> for Athena</h2><span id='topic+db_copy_to'></span><span id='topic+db_copy_to.AthenaConnection'></span>

<h3>Description</h3>

<p>This is an Athena method for dbplyr function <code>db_copy_to</code> to create an Athena table from a <code>data.frame</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>db_copy_to.AthenaConnection(
  con,
  table,
  values,
  ...,
  partition = NULL,
  s3_location = NULL,
  file_type = c("csv", "tsv", "parquet"),
  compress = FALSE,
  max_batch = Inf,
  overwrite = FALSE,
  append = FALSE,
  types = NULL,
  temporary = TRUE,
  unique_indexes = NULL,
  indexes = NULL,
  analyze = TRUE,
  in_transaction = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="db_copy_to_+3A_con">con</code></td>
<td>
<p>A <code><a href="#topic+dbConnect">dbConnect</a></code> object, as returned by <code>dbConnect()</code></p>
</td></tr>
<tr><td><code id="db_copy_to_+3A_table">table</code></td>
<td>
<p>A character string specifying a table name. Names will be
automatically quoted so you can use any sequence of characters, not
just any valid bare table name.</p>
</td></tr>
<tr><td><code id="db_copy_to_+3A_values">values</code></td>
<td>
<p>A data.frame to write to the database.</p>
</td></tr>
<tr><td><code id="db_copy_to_+3A_...">...</code></td>
<td>
<p>other parameters currently not supported in noctua</p>
</td></tr>
<tr><td><code id="db_copy_to_+3A_partition">partition</code></td>
<td>
<p>Partition Athena table (needs to be a named list or vector) for example: <code>c(var1 = "2019-20-13")</code></p>
</td></tr>
<tr><td><code id="db_copy_to_+3A_s3_location">s3_location</code></td>
<td>
<p>s3 bucket to store Athena table, must be set as a s3 uri for example (&quot;s3://mybucket/data/&quot;)</p>
</td></tr>
<tr><td><code id="db_copy_to_+3A_file_type">file_type</code></td>
<td>
<p>What file type to store data.frame on s3, noctua currently supports [&quot;tsv&quot;, &quot;csv&quot;, &quot;parquet&quot;]. Default delimited file type is &quot;tsv&quot;, in previous versions
of <code>noctua (=&lt; 1.4.0)</code> file type &quot;csv&quot; was used as default. The reason for the change is that columns containing <code>Array/JSON</code> format cannot be written to
Athena due to the separating value &quot;,&quot;. This would cause issues with AWS Athena.
<strong>Note:</strong> &quot;parquet&quot; format is supported by the <code>arrow</code> package and it will need to be installed to utilise the &quot;parquet&quot; format.</p>
</td></tr>
<tr><td><code id="db_copy_to_+3A_compress">compress</code></td>
<td>
<p><code>FALSE | TRUE</code> To determine if to compress file.type. If file type is [&quot;csv&quot;, &quot;tsv&quot;] then &quot;gzip&quot; compression is used, for file type &quot;parquet&quot;
&quot;snappy&quot; compression is used.</p>
</td></tr>
<tr><td><code id="db_copy_to_+3A_max_batch">max_batch</code></td>
<td>
<p>Split the data frame by max number of rows i.e. 100,000 so that multiple files can be uploaded into AWS S3. By default when compression
is set to <code>TRUE</code> and file.type is &quot;csv&quot; or &quot;tsv&quot; max.batch will split data.frame into 20 batches. This is to help the
performance of AWS Athena when working with files compressed in &quot;gzip&quot; format. <code>max.batch</code> will not split the data.frame
when loading file in parquet format. For more information please go to <a href="https://github.com/DyfanJones/RAthena/issues/36">link</a></p>
</td></tr>
<tr><td><code id="db_copy_to_+3A_overwrite">overwrite</code></td>
<td>
<p>Allows overwriting the destination table. Cannot be <code>TRUE</code> if <code>append</code> is also <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="db_copy_to_+3A_append">append</code></td>
<td>
<p>Allow appending to the destination table. Cannot be <code>TRUE</code> if <code>overwrite</code> is also <code>TRUE</code>. Existing Athena DDL file type will be retained
and used when uploading data to AWS Athena. If parameter <code>file.type</code> doesn't match AWS Athena DDL file type a warning message will be created
notifying user and <code>noctua</code> will use the file type for the Athena DDL.</p>
</td></tr>
<tr><td><code id="db_copy_to_+3A_types">types</code></td>
<td>
<p>Additional field types used to override derived types.</p>
</td></tr>
<tr><td><code id="db_copy_to_+3A_temporary">temporary</code></td>
<td>
<p>if TRUE, will create a temporary table that is local to this connection and will be automatically deleted when the connection expires</p>
</td></tr>
<tr><td><code id="db_copy_to_+3A_unique_indexes">unique_indexes</code></td>
<td>
<p>a list of character vectors. Each element of the list will create a new unique index over the specified column(s). Duplicate rows will result in failure.</p>
</td></tr>
<tr><td><code id="db_copy_to_+3A_indexes">indexes</code></td>
<td>
<p>a list of character vectors. Each element of the list will create a new index.</p>
</td></tr>
<tr><td><code id="db_copy_to_+3A_analyze">analyze</code></td>
<td>
<p>if TRUE (the default), will automatically ANALYZE the new table so that the query optimiser has useful information.</p>
</td></tr>
<tr><td><code id="db_copy_to_+3A_in_transaction">in_transaction</code></td>
<td>
<p>Should the table creation be wrapped in a transaction? This typically makes things faster, but you may want to suppress if the database doesn't support transactions, or you're wrapping in a transaction higher up (and your database doesn't support nested transactions.)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>db_copy_to returns table name
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AthenaWriteTables">AthenaWriteTables</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documnentation

library(DBI)
library(dplyr)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

# List existing tables in Athena
dbListTables(con)

# Write data.frame to Athena table
copy_to(con, mtcars,
  s3_location = "s3://mybucket/data/"
)

# Checking if uploaded table exists in Athena
dbExistsTable(con, "mtcars")

# Write Athena table from tbl_sql
athena_mtcars &lt;- tbl(con, "mtcars")
mtcars_filter &lt;- athena_mtcars %&gt;% filter(gear &gt;= 4)

copy_to(con, mtcars_filter)

# Checking if uploaded table exists in Athena
dbExistsTable(con, "mtcars_filter")

# Disconnect from Athena
dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='db_desc'>S3 implementation of <code>db_desc</code> for Athena (api version 1).</h2><span id='topic+db_desc'></span><span id='topic+db_desc.AthenaConnection'></span>

<h3>Description</h3>

<p>This is a backend function for dplyr to retrieve meta data about Athena queries. Users won't be required to access and run this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>db_desc.AthenaConnection(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="db_desc_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+dbConnect">dbConnect</a></code> object, as returned by <code>dbConnect()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character variable containing Meta Data about query sent to Athena. The Meta Data is returned in the following format:
</p>
<p><code>"Athena &lt;paws version&gt; [&lt;profile_name&gt;@region/database]"</code>
</p>

<hr>
<h2 id='dbClearResult'>Clear Results</h2><span id='topic+dbClearResult'></span><span id='topic+dbClearResult+2CAthenaResult-method'></span>

<h3>Description</h3>

<p>Frees all resources (local and Athena) associated with result set. It does this by removing query output in AWS S3 Bucket,
stopping query execution if still running and removed the connection resource locally.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaResult'
dbClearResult(res, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbClearResult_+3A_res">res</code></td>
<td>
<p>An object inheriting from <a href="DBI.html#topic+DBIResult-class">DBIResult</a>.</p>
</td></tr>
<tr><td><code id="dbClearResult_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dbClearResult()</code> returns <code>TRUE</code>, invisibly.
</p>


<h3>Note</h3>

<p>If a user does not have permission to remove AWS S3 resource from AWS Athena output location, then an AWS warning will be returned.
For example <code>AccessDenied (HTTP 403). Access Denied</code>.
It is better use query caching or optionally prevent clear AWS S3 resource using <code><a href="#topic+noctua_options">noctua_options</a></code>
so that the warning doesn't repeatedly show.
</p>


<h3>See Also</h3>

<p><code><a href="DBI.html#topic+dbIsValid">dbIsValid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documnentation

library(DBI)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

res &lt;- dbSendQuery(con, "show databases")
dbClearResult(res)

# Check if connection if valid after closing connection
dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='dbColumnInfo'>Information about result types</h2><span id='topic+dbColumnInfo'></span><span id='topic+dbColumnInfo+2CAthenaResult-method'></span>

<h3>Description</h3>

<p>Produces a data.frame that describes the output of a query.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaResult'
dbColumnInfo(res, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbColumnInfo_+3A_res">res</code></td>
<td>
<p>An object inheriting from <a href="DBI.html#topic+DBIResult-class">DBIResult</a>.</p>
</td></tr>
<tr><td><code id="dbColumnInfo_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dbColumnInfo()</code> returns a data.frame with as many rows as there are output fields in the result.
The data.frame has two columns (field_name, type).
</p>


<h3>See Also</h3>

<p><code><a href="DBI.html#topic+dbHasCompleted">dbHasCompleted</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `RAthena::dbConnect` documnentation

library(DBI)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

# Get Column information from query
res &lt;- dbSendQuery(con, "select * from information_schema.tables")
dbColumnInfo(res)
dbClearResult(res)

# Disconnect from Athena
dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='dbConnect+2CAthenaDriver-method'>Connect to Athena using R's sdk paws</h2><span id='topic+dbConnect+2CAthenaDriver-method'></span><span id='topic+dbConnect'></span>

<h3>Description</h3>

<p>It is never advised to hard-code credentials when making a connection to Athena (even though the option is there). Instead it is advised to use
<code>profile_name</code> (set up by <a href="https://aws.amazon.com/cli/">AWS Command Line Interface</a>),
<a href="https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html">Amazon Resource Name roles</a> or environmental variables. Here is a list
of supported environment variables:
</p>

<ul>
<li><p><strong>AWS_ACCESS_KEY_ID:</strong> is equivalent to the <code>dbConnect</code> parameter - <code>aws_access_key_id</code>
</p>
</li>
<li><p><strong>AWS_SECRET_ACCESS_KEY:</strong> is equivalent to the <code>dbConnect</code> parameter - <code>aws_secret_access_key</code>
</p>
</li>
<li><p><strong>AWS_SESSION_TOKEN:</strong> is equivalent to the <code>dbConnect</code> parameter - <code>aws_session_token</code>
</p>
</li>
<li><p><strong>AWS_EXPIRATION:</strong> is equivalent to the <code>dbConnect</code> parameter - <code>duration_seconds</code>
</p>
</li>
<li><p><strong>AWS_ATHENA_S3_STAGING_DIR:</strong> is equivalent to the <code>dbConnect</code> parameter - <code>s3_staging_dir</code>
</p>
</li>
<li><p><strong>AWS_ATHENA_WORK_GROUP:</strong> is equivalent to <code>dbConnect</code> parameter - <code>work_group</code>
</p>
</li>
<li><p><strong>AWS_REGION:</strong> is equivalent to <code>dbConnect</code> parameter - <code>region_name</code>
</p>
</li></ul>

<p><strong>NOTE:</strong> If you have set any environmental variables in <code>.Renviron</code> please restart your R in order for the changes to take affect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaDriver'
dbConnect(
  drv,
  aws_access_key_id = NULL,
  aws_secret_access_key = NULL,
  aws_session_token = NULL,
  catalog_name = "AwsDataCatalog",
  schema_name = "default",
  work_group = NULL,
  poll_interval = NULL,
  encryption_option = c("NULL", "SSE_S3", "SSE_KMS", "CSE_KMS"),
  kms_key = NULL,
  profile_name = NULL,
  role_arn = NULL,
  role_session_name = sprintf("noctua-session-%s", as.integer(Sys.time())),
  duration_seconds = 3600L,
  s3_staging_dir = NULL,
  region_name = NULL,
  bigint = c("integer64", "integer", "numeric", "character"),
  binary = c("raw", "character"),
  json = c("auto", "character"),
  timezone = "UTC",
  keyboard_interrupt = TRUE,
  rstudio_conn_tab = TRUE,
  endpoint_override = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_drv">drv</code></td>
<td>
<p>an object that inherits from <a href="DBI.html#topic+DBIDriver-class">DBIDriver</a>,
or an existing <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a>
object (in order to clone an existing connection).</p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_aws_access_key_id">aws_access_key_id</code></td>
<td>
<p>AWS access key ID</p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_aws_secret_access_key">aws_secret_access_key</code></td>
<td>
<p>AWS secret access key</p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_aws_session_token">aws_session_token</code></td>
<td>
<p>AWS temporary session token</p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_catalog_name">catalog_name</code></td>
<td>
<p>The catalog_name to which the connection belongs</p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_schema_name">schema_name</code></td>
<td>
<p>The schema_name to which the connection belongs</p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_work_group">work_group</code></td>
<td>
<p>The name of the <a href="https://aws.amazon.com/about-aws/whats-new/2019/02/athena_workgroups/">work group</a> to run Athena queries , Currently defaulted to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_poll_interval">poll_interval</code></td>
<td>
<p>Amount of time took when checking query execution status. Default set to a random interval between 0.5 - 1 seconds.</p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_encryption_option">encryption_option</code></td>
<td>
<p>Athena encryption at rest <a href="https://docs.aws.amazon.com/athena/latest/ug/encryption.html">link</a>.
Supported Amazon S3 Encryption Options [&quot;NULL&quot;, &quot;SSE_S3&quot;, &quot;SSE_KMS&quot;, &quot;CSE_KMS&quot;]. Connection will default to NULL,
usually changing this option is not required.</p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_kms_key">kms_key</code></td>
<td>
<p><a href="https://docs.aws.amazon.com/kms/latest/developerguide/overview.html">AWS Key Management Service</a>,
please refer to <a href="https://docs.aws.amazon.com/kms/latest/developerguide/concepts.html">link</a> for more information around the concept.</p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_profile_name">profile_name</code></td>
<td>
<p>The name of a profile to use. If not given, then the default profile is used.
To set profile name, the <a href="https://aws.amazon.com/cli/">AWS Command Line Interface</a> (AWS CLI) will need to be configured.
To configure AWS CLI please refer to: <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html">Configuring the AWS CLI</a>.</p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_role_arn">role_arn</code></td>
<td>
<p>The Amazon Resource Name (ARN) of the role to assume (such as <code>arn:aws:sts::123456789012:assumed-role/role_name/role_session_name</code>)</p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_role_session_name">role_session_name</code></td>
<td>
<p>An identifier for the assumed role session. By default 'noctua' creates a session name <code>sprintf("noctua-session-%s", as.integer(Sys.time()))</code></p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_duration_seconds">duration_seconds</code></td>
<td>
<p>The duration, in seconds, of the role session. The value can range from 900 seconds (15 minutes) up to the maximum session duration setting for the role.
This setting can have a value from 1 hour to 12 hours. By default duration is set to 3600 seconds (1 hour).</p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_s3_staging_dir">s3_staging_dir</code></td>
<td>
<p>The location in Amazon S3 where your query results are stored, such as <code>s3://path/to/query/bucket/</code></p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_region_name">region_name</code></td>
<td>
<p>Default region when creating new connections. Please refer to <a href="https://docs.aws.amazon.com/general/latest/gr/rande.html">link</a> for
AWS region codes (region code example: Region = EU (Ireland)     <code> region_name = "eu-west-1"</code>)</p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_bigint">bigint</code></td>
<td>
<p>The R type that 64-bit integer types should be mapped to,
default is [bit64::integer64], which allows the full range of 64 bit
integers.</p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_binary">binary</code></td>
<td>
<p>The R type that [binary/varbinary] types should be mapped to,
default is [raw]. If the mapping fails R will resort to [character] type.
To ignore data type conversion set to [&quot;character&quot;].</p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_json">json</code></td>
<td>
<p>Attempt to converts AWS Athena data types [arrays, json] using <code>jsonlite:parse_json</code>. If the mapping fails R will resort to [character] type.
Custom Json parsers can be provide by using a function with data frame parameter.
To ignore data type conversion set to [&quot;character&quot;].</p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_timezone">timezone</code></td>
<td>
<p>Sets the timezone for the connection. The default is 'UTC'.
If &lsquo;NULL' then no timezone is set, which defaults to the server&rsquo;s time zone.
'AWS Athena' accepted time zones: <a href="https://docs.aws.amazon.com/athena/latest/ug/athena-supported-time-zones.html">https://docs.aws.amazon.com/athena/latest/ug/athena-supported-time-zones.html</a>.</p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_keyboard_interrupt">keyboard_interrupt</code></td>
<td>
<p>Stops AWS Athena process when R gets a keyboard interrupt, currently defaults to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_rstudio_conn_tab">rstudio_conn_tab</code></td>
<td>
<p>Optional to get AWS Athena Schema from AWS Glue Catalogue and display it in RStudio's Connections Tab.
Default set to <code>TRUE</code>. For large 'AWS Glue Catalogue' it is recommended to set 'rstudio_conn_tab=FALSE' to ensure a fast connection.</p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_endpoint_override">endpoint_override</code></td>
<td>
<p>(character/list) The complete URL to use for the constructed client.
Normally, paws will automatically construct the appropriate URL to use when
communicating with a service. You can specify a complete URL (including the &quot;http/https&quot; scheme)
to override this behaviour. If this value is provided, then <code>disable_ssl</code> is ignored.
If <code>endpoint_override</code> is a character then AWS Athena endpoint is overridden. To override
AWS S3 or AWS Glue endpoints a named list needs to be provided. The list can only have the following names ['athena', 's3', glue']
for example <code>list(glue = "https://glue.eu-west-1.amazonaws.com")</code></p>
</td></tr>
<tr><td><code id="dbConnect+2B2CAthenaDriver-method_+3A_...">...</code></td>
<td>
<p>other parameters for <code>paws</code> session.
</p>

<ul>
<li><p><strong>disable_ssl</strong> (boolean) Whether or not to use SSL. By default, SSL is used.
Note that not all services support non-ssl connections.

</p>
</li>
<li><p><strong>timeout</strong> (numeric) The time in seconds till a timeout exception is
thrown when attempting to make a connection. The default is 60 seconds.

</p>
</li>
<li><p><strong>disable_param_validation</strong> (bool) Whether parameter validation should occur
when serializing requests. The default is <code>FALSE</code> You can disable parameter
validation for performance reasons. Otherwise, it's recommended to leave parameter validation enabled.

</p>
</li>
<li><p><strong>s3_force_path_style</strong> Addressing style is always by path. Endpoints will be
addressed as such: s3.amazonaws.com/mybucket

</p>
</li>
<li><p><strong>s3_use_accelerate</strong> Refers to whether to use the S3 Accelerate endpoint.
The value must be a boolean. If True, the client will use the S3 Accelerate endpoint.
If the S3 Accelerate endpoint is being used then the addressing style will always be virtual.

</p>
</li>
<li><p><strong>use_dual_stack</strong> Setting to <code>TRUE</code> enables dual stack endpoint resolution.
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dbConnect()</code> returns a s4 class. This object is used to communicate with AWS Athena.
</p>


<h3>See Also</h3>

<p><code><a href="DBI.html#topic+dbConnect">dbConnect</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Connect to Athena using your aws access keys
library(DBI)
con &lt;- dbConnect(noctua::athena(),
  aws_access_key_id = "YOUR_ACCESS_KEY_ID", #
  aws_secret_access_key = "YOUR_SECRET_ACCESS_KEY",
  s3_staging_dir = "s3://path/to/query/bucket/",
  region_name = "us-west-2"
)
dbDisconnect(con)

# Connect to Athena using your profile name
# Profile name can be created by using AWS CLI
con &lt;- dbConnect(noctua::athena(),
  profile_name = "YOUR_PROFILE_NAME",
  s3_staging_dir = "s3://path/to/query/bucket/"
)
dbDisconnect(con)

# Connect to Athena using ARN role
con &lt;- dbConnect(noctua::athena(),
  profile_name = "YOUR_PROFILE_NAME",
  role_arn = "arn:aws:sts::123456789012:assumed-role/role_name/role_session_name",
  s3_staging_dir = "s3://path/to/query/bucket/"
)

dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='dbConvertTable'>Simple wrapper to convert Athena backend file types</h2><span id='topic+dbConvertTable'></span><span id='topic+dbConvertTable+2CAthenaConnection-method'></span>

<h3>Description</h3>

<p>Utilises AWS Athena to convert AWS S3 backend file types. It also also to create more efficient file types i.e. &quot;parquet&quot; and &quot;orc&quot; from SQL queries.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbConvertTable(conn, obj, name, ...)

## S4 method for signature 'AthenaConnection'
dbConvertTable(
  conn,
  obj,
  name,
  partition = NULL,
  s3.location = NULL,
  file.type = c("NULL", "csv", "tsv", "parquet", "json", "orc"),
  compress = TRUE,
  data = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbConvertTable_+3A_conn">conn</code></td>
<td>
<p>An <code><a href="#topic+AthenaConnection-class">AthenaConnection</a></code> object, produced by [DBI::dbConnect()]</p>
</td></tr>
<tr><td><code id="dbConvertTable_+3A_obj">obj</code></td>
<td>
<p>Athena table or <code>SQL</code> DML query to be converted. For <code>SQL</code>, the query need to be wrapped with <code>DBI::SQL()</code> and
follow AWS Athena DML format <a href="https://docs.aws.amazon.com/athena/latest/ug/select.html">link</a></p>
</td></tr>
<tr><td><code id="dbConvertTable_+3A_name">name</code></td>
<td>
<p>Name of destination table</p>
</td></tr>
<tr><td><code id="dbConvertTable_+3A_...">...</code></td>
<td>
<p>Extra parameters, currently not used</p>
</td></tr>
<tr><td><code id="dbConvertTable_+3A_partition">partition</code></td>
<td>
<p>Partition Athena table</p>
</td></tr>
<tr><td><code id="dbConvertTable_+3A_s3.location">s3.location</code></td>
<td>
<p>location to store output file, must be in s3 uri format for example (&quot;s3://mybucket/data/&quot;).</p>
</td></tr>
<tr><td><code id="dbConvertTable_+3A_file.type">file.type</code></td>
<td>
<p>File type for <code>name</code>, currently support [&quot;NULL&quot;,&quot;csv&quot;, &quot;tsv&quot;, &quot;parquet&quot;, &quot;json&quot;, &quot;orc&quot;].
<code>"NULL"</code> will let Athena set the file type for you.</p>
</td></tr>
<tr><td><code id="dbConvertTable_+3A_compress">compress</code></td>
<td>
<p>Compress <code>name</code>, currently can only compress [&quot;parquet&quot;, &quot;orc&quot;] (<a href="https://docs.aws.amazon.com/athena/latest/ug/create-table-as.html">AWS Athena CTAS</a>)</p>
</td></tr>
<tr><td><code id="dbConvertTable_+3A_data">data</code></td>
<td>
<p>If <code>name</code> should be created with data or not.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dbConvertTable()</code> returns <code>TRUE</code> but invisible.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `RAthena::dbConnect` documnentation

library(DBI)
library(noctua)

# Demo connection to Athena using profile name
con &lt;- dbConnect(athena())

# write iris table to Athena in defualt delimited format
dbWriteTable(con, "iris", iris)

# convert delimited table to parquet
dbConvertTable(con,
  obj = "iris",
  name = "iris_parquet",
  file.type = "parquet"
)

# Create partitioned table from non-partitioned
# iris table using SQL DML query
dbConvertTable(con,
  obj = SQL("select
                            iris.*,
                            date_format(current_date, '%Y%m%d') as time_stamp
                          from iris"),
  name = "iris_orc_partitioned",
  file.type = "orc",
  partition = "time_stamp"
)

# disconnect from Athena
dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='dbDataType+2CAthenaDriver+2CANY-method'>Determine SQL data type of object</h2><span id='topic+dbDataType+2CAthenaDriver+2CANY-method'></span><span id='topic+dbDataType+2CAthenaDriver+2Clist-method'></span><span id='topic+dbDataType'></span><span id='topic+dbDataType+2CAthenaConnection+2CANY-method'></span><span id='topic+dbDataType+2CAthenaConnection+2Cdata.frame-method'></span>

<h3>Description</h3>

<p>Returns a character string that describes the Athena SQL data type for the <code>obj</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaDriver,ANY'
dbDataType(dbObj, obj, ...)

## S4 method for signature 'AthenaDriver,list'
dbDataType(dbObj, obj, ...)

## S4 method for signature 'AthenaConnection,ANY'
dbDataType(dbObj, obj, ...)

## S4 method for signature 'AthenaConnection,data.frame'
dbDataType(dbObj, obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbDataType+2B2CAthenaDriver+2B2CANY-method_+3A_dbobj">dbObj</code></td>
<td>
<p>A object inheriting from <a href="DBI.html#topic+DBIDriver-class">DBIDriver</a>
or <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a></p>
</td></tr>
<tr><td><code id="dbDataType+2B2CAthenaDriver+2B2CANY-method_+3A_obj">obj</code></td>
<td>
<p>An R object whose SQL type we want to determine.</p>
</td></tr>
<tr><td><code id="dbDataType+2B2CAthenaDriver+2B2CANY-method_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dbDataType</code> returns the Athena type that correspond to the obj argument as an non-empty character string.
</p>


<h3>See Also</h3>

<p><code><a href="DBI.html#topic+dbDataType">dbDataType</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(noctua)
dbDataType(athena(), 1:5)
dbDataType(athena(), 1)
dbDataType(athena(), TRUE)
dbDataType(athena(), Sys.Date())
dbDataType(athena(), Sys.time())
dbDataType(athena(), c("x", "abc"))
dbDataType(athena(), list(raw(10), raw(20)))

vapply(iris, function(x) dbDataType(noctua::athena(), x),
  FUN.VALUE = character(1), USE.NAMES = TRUE
)

## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documnentation

library(DBI)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

# Sending Queries to Athena
dbDataType(con, iris)

# Disconnect conenction
dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='dbDisconnect'>Disconnect (close) an Athena connection</h2><span id='topic+dbDisconnect'></span><span id='topic+dbDisconnect+2CAthenaConnection-method'></span>

<h3>Description</h3>

<p>This closes the connection to Athena.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaConnection'
dbDisconnect(conn, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbDisconnect_+3A_conn">conn</code></td>
<td>
<p>A <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a> object, as returned by
<code><a href="DBI.html#topic+dbConnect">dbConnect()</a></code>.</p>
</td></tr>
<tr><td><code id="dbDisconnect_+3A_...">...</code></td>
<td>
<p>Other parameters passed on to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dbDisconnect()</code> returns <code>TRUE</code>, invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="DBI.html#topic+dbDisconnect">dbDisconnect</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documnentation

library(DBI)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

# Disconnect conenction
dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='dbExistsTable'>Does Athena table exist?</h2><span id='topic+dbExistsTable'></span><span id='topic+dbExistsTable+2CAthenaConnection+2Ccharacter-method'></span><span id='topic+dbExistsTable+2CAthenaConnection+2CId-method'></span>

<h3>Description</h3>

<p>Returns logical scalar if the table exists or not. <code>TRUE</code> if the table exists, <code>FALSE</code> otherwise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaConnection,character'
dbExistsTable(conn, name, ...)

## S4 method for signature 'AthenaConnection,Id'
dbExistsTable(conn, name, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbExistsTable_+3A_conn">conn</code></td>
<td>
<p>A <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a> object, as returned by
<code><a href="DBI.html#topic+dbConnect">dbConnect()</a></code>.</p>
</td></tr>
<tr><td><code id="dbExistsTable_+3A_name">name</code></td>
<td>
<p>The table name, passed on to <code><a href="DBI.html#topic+dbQuoteIdentifier">dbQuoteIdentifier()</a></code>. Options are:
</p>

<ul>
<li><p> a character string with the unquoted DBMS table name,
e.g. <code>"table_name"</code>,
</p>
</li>
<li><p> a call to <code><a href="DBI.html#topic+Id">Id()</a></code> with components to the fully qualified table name,
e.g. <code>Id(schema = "my_schema", table = "table_name")</code>
</p>
</li>
<li><p> a call to <code><a href="DBI.html#topic+SQL">SQL()</a></code> with the quoted and fully qualified table name
given verbatim, e.g. <code>SQL('"my_schema"."table_name"')</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="dbExistsTable_+3A_...">...</code></td>
<td>
<p>Other parameters passed on to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dbExistsTable()</code> returns logical scalar. <code>TRUE</code> if the table exists, <code>FALSE</code> otherwise.
</p>


<h3>See Also</h3>

<p><code><a href="DBI.html#topic+dbExistsTable">dbExistsTable</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documnentation

library(DBI)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

# Write data.frame to Athena table
dbWriteTable(con, "mtcars", mtcars,
  partition = c("TIMESTAMP" = format(Sys.Date(), "%Y%m%d")),
  s3.location = "s3://mybucket/data/"
)

# Check if table exists from Athena
dbExistsTable(con, "mtcars")

# Disconnect conenction
dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='dbFetch'>Fetch records from previously executed query</h2><span id='topic+dbFetch'></span><span id='topic+dbFetch+2CAthenaResult-method'></span>

<h3>Description</h3>

<p>Currently returns the top n elements (rows) from result set or returns entire table from Athena.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaResult'
dbFetch(res, n = -1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbFetch_+3A_res">res</code></td>
<td>
<p>An object inheriting from <a href="DBI.html#topic+DBIResult-class">DBIResult</a>, created by
<code><a href="DBI.html#topic+dbSendQuery">dbSendQuery()</a></code>.</p>
</td></tr>
<tr><td><code id="dbFetch_+3A_n">n</code></td>
<td>
<p>maximum number of records to retrieve per fetch. Use <code>n = -1</code> or <code>n = Inf</code> to retrieve all pending records.
Some implementations may recognize other special values. If entire dataframe is required use <code>n = -1</code> or <code>n = Inf</code>.</p>
</td></tr>
<tr><td><code id="dbFetch_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dbFetch()</code> returns a data frame.
</p>


<h3>See Also</h3>

<p><code><a href="DBI.html#topic+dbFetch">dbFetch</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documnentation

library(DBI)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

res &lt;- dbSendQuery(con, "show databases")
dbFetch(res)
dbClearResult(res)

# Disconnect from Athena
dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='dbGetInfo'>Get DBMS metadata</h2><span id='topic+dbGetInfo'></span><span id='topic+dbGetInfo+2CAthenaConnection-method'></span><span id='topic+dbGetInfo+2CAthenaResult-method'></span>

<h3>Description</h3>

<p>Get DBMS metadata
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaConnection'
dbGetInfo(dbObj, ...)

## S4 method for signature 'AthenaResult'
dbGetInfo(dbObj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbGetInfo_+3A_dbobj">dbObj</code></td>
<td>
<p>An object inheriting from <a href="DBI.html#topic+DBIObject-class">DBIObject</a>,
i.e. <a href="DBI.html#topic+DBIDriver-class">DBIDriver</a>, <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a>,
or a <a href="DBI.html#topic+DBIResult-class">DBIResult</a></p>
</td></tr>
<tr><td><code id="dbGetInfo_+3A_...">...</code></td>
<td>
<p>Other arguments to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a named list
</p>


<h3>See Also</h3>

<p><code><a href="DBI.html#topic+dbGetInfo">dbGetInfo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documnentation

library(DBI)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

# Returns metadata from connnection object
metadata &lt;- dbGetInfo(con)

# Return metadata from Athena query object
res &lt;- dbSendQuery(con, "show databases")
dbGetInfo(res)

# Clear result
dbClearResult(res)

# disconnect from Athena
dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='dbGetPartition'>Athena table partitions</h2><span id='topic+dbGetPartition'></span><span id='topic+dbGetPartition+2CAthenaConnection-method'></span>

<h3>Description</h3>

<p>This method returns all partitions from Athena table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbGetPartition(conn, name, ..., .format = FALSE)

## S4 method for signature 'AthenaConnection'
dbGetPartition(conn, name, ..., .format = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbGetPartition_+3A_conn">conn</code></td>
<td>
<p>A <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a> object, as returned by
<code><a href="DBI.html#topic+dbConnect">dbConnect()</a></code>.</p>
</td></tr>
<tr><td><code id="dbGetPartition_+3A_name">name</code></td>
<td>
<p>The table name, passed on to <code><a href="DBI.html#topic+dbQuoteIdentifier">dbQuoteIdentifier()</a></code>. Options are:
</p>

<ul>
<li><p> a character string with the unquoted DBMS table name,
e.g. <code>"table_name"</code>,
</p>
</li>
<li><p> a call to <code><a href="DBI.html#topic+Id">Id()</a></code> with components to the fully qualified table name,
e.g. <code>Id(schema = "my_schema", table = "table_name")</code>
</p>
</li>
<li><p> a call to <code><a href="DBI.html#topic+SQL">SQL()</a></code> with the quoted and fully qualified table name
given verbatim, e.g. <code>SQL('"my_schema"."table_name"')</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="dbGetPartition_+3A_...">...</code></td>
<td>
<p>Other parameters passed on to methods.</p>
</td></tr>
<tr><td><code id="dbGetPartition_+3A_.format">.format</code></td>
<td>
<p>re-formats AWS Athena partitions format. So that each column represents a partition
from the AWS Athena table. Default set to <code>FALSE</code> to prevent breaking previous package behaviour.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame that returns all partitions in table, if no partitions in Athena table then
function will return error from Athena.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documnentation

library(DBI)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

# write iris table to Athena
dbWriteTable(con, "iris",
  iris,
  partition = c("timestamp" = format(Sys.Date(), "%Y%m%d")),
  s3.location = "s3://path/to/store/athena/table/"
)

# return table partitions
noctua::dbGetPartition(con, "iris")

# disconnect from Athena
dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='dbGetQuery'>Send query, retrieve results and then clear result set</h2><span id='topic+dbGetQuery'></span><span id='topic+dbGetQuery+2CAthenaConnection+2Ccharacter-method'></span>

<h3>Description</h3>

<p>Send query, retrieve results and then clear result set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaConnection,character'
dbGetQuery(conn, statement, statistics = FALSE, unload = athena_unload(), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbGetQuery_+3A_conn">conn</code></td>
<td>
<p>A <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a> object, as returned by
<code><a href="DBI.html#topic+dbConnect">dbConnect()</a></code>.</p>
</td></tr>
<tr><td><code id="dbGetQuery_+3A_statement">statement</code></td>
<td>
<p>a character string containing SQL.</p>
</td></tr>
<tr><td><code id="dbGetQuery_+3A_statistics">statistics</code></td>
<td>
<p>If set to <code>TRUE</code> will print out AWS Athena statistics of query.</p>
</td></tr>
<tr><td><code id="dbGetQuery_+3A_unload">unload</code></td>
<td>
<p>boolean input to modify 'statement' to align with <a href="https://docs.aws.amazon.com/athena/latest/ug/unload.html">AWS Athena UNLOAD</a>,
default is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="dbGetQuery_+3A_...">...</code></td>
<td>
<p>Other parameters passed on to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dbGetQuery()</code> returns a dataframe.
</p>


<h3>Note</h3>

<p>If the user does not have permission to remove AWS S3 resource from AWS Athena output location, then an AWS warning will be returned.
For example <code>AccessDenied (HTTP 403). Access Denied</code>.
It is better use query caching or optionally prevent clear AWS S3 resource using <code><a href="#topic+noctua_options">noctua_options</a></code>
so that the warning doesn't repeatedly show.
</p>


<h3>See Also</h3>

<p><code><a href="DBI.html#topic+dbGetQuery">dbGetQuery</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documnentation

library(DBI)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

# Sending Queries to Athena
dbGetQuery(con, "show databases")

# Disconnect conenction
dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='dbGetStatement'>Get the statement associated with a result set</h2><span id='topic+dbGetStatement'></span><span id='topic+dbGetStatement+2CAthenaResult-method'></span>

<h3>Description</h3>

<p>Returns the statement that was passed to [dbSendQuery()]
or [dbSendStatement()].
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaResult'
dbGetStatement(res, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbGetStatement_+3A_res">res</code></td>
<td>
<p>An object inheriting from <a href="DBI.html#topic+DBIResult-class">DBIResult</a>.</p>
</td></tr>
<tr><td><code id="dbGetStatement_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dbGetStatement()</code> returns a character.
</p>


<h3>See Also</h3>

<p><code><a href="DBI.html#topic+dbGetStatement">dbGetStatement</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documnentation

library(DBI)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

rs &lt;- dbSendQuery(con, "SHOW TABLES in default")
dbGetStatement(rs)

## End(Not run)
</code></pre>

<hr>
<h2 id='dbGetTables'>List Athena Schema, Tables and Table Types</h2><span id='topic+dbGetTables'></span><span id='topic+dbGetTables+2CAthenaConnection-method'></span>

<h3>Description</h3>

<p>Method to get Athena schema, tables and table types return as a data.frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbGetTables(conn, ...)

## S4 method for signature 'AthenaConnection'
dbGetTables(conn, catalog = NULL, schema = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbGetTables_+3A_conn">conn</code></td>
<td>
<p>A <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a> object, as returned by
<code><a href="DBI.html#topic+dbConnect">dbConnect()</a></code>.</p>
</td></tr>
<tr><td><code id="dbGetTables_+3A_...">...</code></td>
<td>
<p>Other parameters passed on to methods.</p>
</td></tr>
<tr><td><code id="dbGetTables_+3A_catalog">catalog</code></td>
<td>
<p>Athena catalog, default set to NULL to return all tables from all Athena catalogs</p>
</td></tr>
<tr><td><code id="dbGetTables_+3A_schema">schema</code></td>
<td>
<p>Athena schema, default set to NULL to return all tables from all Athena schemas.
Note: The use of DATABASE and SCHEMA is interchangeable within Athena.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dbGetTables()</code> returns a data.frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documnentation

library(DBI)
library(noctua)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

# Return hierarchy of tables in Athena
dbGetTables(con)

# Disconnect conenction
dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='dbHasCompleted'>Completion status</h2><span id='topic+dbHasCompleted'></span><span id='topic+dbHasCompleted+2CAthenaResult-method'></span>

<h3>Description</h3>

<p>This method returns if the query has completed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaResult'
dbHasCompleted(res, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbHasCompleted_+3A_res">res</code></td>
<td>
<p>An object inheriting from <a href="DBI.html#topic+DBIResult-class">DBIResult</a>.</p>
</td></tr>
<tr><td><code id="dbHasCompleted_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dbHasCompleted()</code> returns a logical scalar. <code>TRUE</code> if the query has completed, <code>FALSE</code> otherwise.
</p>


<h3>See Also</h3>

<p><code><a href="DBI.html#topic+dbHasCompleted">dbHasCompleted</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documnentation

library(DBI)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

# Check if query has completed
res &lt;- dbSendQuery(con, "show databases")
dbHasCompleted(res)

dbClearResult(res)

# Disconnect from Athena
dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='dbIsValid'>Is this DBMS object still valid?</h2><span id='topic+dbIsValid'></span><span id='topic+dbIsValid+2CAthenaConnection-method'></span><span id='topic+dbIsValid+2CAthenaResult-method'></span>

<h3>Description</h3>

<p>This method tests whether the <code>dbObj</code> is still valid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaConnection'
dbIsValid(dbObj, ...)

## S4 method for signature 'AthenaResult'
dbIsValid(dbObj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbIsValid_+3A_dbobj">dbObj</code></td>
<td>
<p>An object inheriting from <a href="DBI.html#topic+DBIObject-class">DBIObject</a>,
i.e. <a href="DBI.html#topic+DBIDriver-class">DBIDriver</a>, <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a>,
or a <a href="DBI.html#topic+DBIResult-class">DBIResult</a></p>
</td></tr>
<tr><td><code id="dbIsValid_+3A_...">...</code></td>
<td>
<p>Other arguments to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dbIsValid()</code> returns logical scalar, <code>TRUE</code> if the object (<code>dbObj</code>) is valid, <code>FALSE</code> otherwise.
</p>


<h3>See Also</h3>

<p><code><a href="DBI.html#topic+dbIsValid">dbIsValid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documnentation

library(DBI)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

# Check is connection is valid
dbIsValid(con)

# Check is query is valid
res &lt;- dbSendQuery(con, "show databases")
dbIsValid(res)

# Check if query is valid after clearing result
dbClearResult(res)
dbIsValid(res)

# Check if connection if valid after closing connection
dbDisconnect(con)
dbIsValid(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='dbListFields'>List Field names of Athena table</h2><span id='topic+dbListFields'></span><span id='topic+dbListFields+2CAthenaConnection+2Ccharacter-method'></span>

<h3>Description</h3>

<p>List Field names of Athena table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaConnection,character'
dbListFields(conn, name, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbListFields_+3A_conn">conn</code></td>
<td>
<p>A <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a> object, as returned by
<code><a href="DBI.html#topic+dbConnect">dbConnect()</a></code>.</p>
</td></tr>
<tr><td><code id="dbListFields_+3A_name">name</code></td>
<td>
<p>The table name, passed on to <code><a href="DBI.html#topic+dbQuoteIdentifier">dbQuoteIdentifier()</a></code>. Options are:
</p>

<ul>
<li><p> a character string with the unquoted DBMS table name,
e.g. <code>"table_name"</code>,
</p>
</li>
<li><p> a call to <code><a href="DBI.html#topic+Id">Id()</a></code> with components to the fully qualified table name,
e.g. <code>Id(schema = "my_schema", table = "table_name")</code>
</p>
</li>
<li><p> a call to <code><a href="DBI.html#topic+SQL">SQL()</a></code> with the quoted and fully qualified table name
given verbatim, e.g. <code>SQL('"my_schema"."table_name"')</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="dbListFields_+3A_...">...</code></td>
<td>
<p>Other parameters passed on to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dbListFields()</code> returns a character vector with all the fields from an Athena table.
</p>


<h3>See Also</h3>

<p><code><a href="DBI.html#topic+dbListFields">dbListFields</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documnentation

library(DBI)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

# Write data.frame to Athena table
dbWriteTable(con, "mtcars", mtcars,
  partition = c("TIMESTAMP" = format(Sys.Date(), "%Y%m%d")),
  s3.location = "s3://mybucket/data/"
)

# Return list of fields in table
dbListFields(con, "mtcars")

# Disconnect conenction
dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='dbListTables'>List Athena Tables</h2><span id='topic+dbListTables'></span><span id='topic+dbListTables+2CAthenaConnection-method'></span>

<h3>Description</h3>

<p>Returns the unquoted names of Athena tables accessible through this connection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaConnection'
dbListTables(conn, catalog = NULL, schema = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbListTables_+3A_conn">conn</code></td>
<td>
<p>A <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a> object, as returned by
<code><a href="DBI.html#topic+dbConnect">dbConnect()</a></code>.</p>
</td></tr>
<tr><td><code id="dbListTables_+3A_catalog">catalog</code></td>
<td>
<p>Athena catalog, default set to NULL to return all tables from all Athena catalogs</p>
</td></tr>
<tr><td><code id="dbListTables_+3A_schema">schema</code></td>
<td>
<p>Athena schema, default set to NULL to return all tables from all Athena schemas.
Note: The use of DATABASE and SCHEMA is interchangeable within Athena.</p>
</td></tr>
<tr><td><code id="dbListTables_+3A_...">...</code></td>
<td>
<p>Other parameters passed on to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dbListTables()</code> returns a character vector with all the tables from Athena.
</p>


<h3>See Also</h3>

<p><code><a href="DBI.html#topic+dbListTables">dbListTables</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documnentation

library(DBI)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

# Return list of tables in Athena
dbListTables(con)

# Disconnect conenction
dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='dbplyr_edition'>Declare which version of dbplyr API is being called.</h2><span id='topic+dbplyr_edition'></span><span id='topic+dbplyr_edition.AthenaConnection'></span>

<h3>Description</h3>

<p>Declare which version of dbplyr API is being called.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbplyr_edition.AthenaConnection(con)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbplyr_edition_+3A_con">con</code></td>
<td>
<p>A <code><a href="#topic+dbConnect">dbConnect</a></code> object, as returned by <code>dbConnect()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Integer for which version of 'dbplyr' is going to be used.
</p>

<hr>
<h2 id='dbQuote'>Quote Identifiers</h2><span id='topic+dbQuote'></span><span id='topic+dbQuoteString+2CAthenaConnection+2Ccharacter-method'></span><span id='topic+dbQuoteString+2CAthenaConnection+2CPOSIXct-method'></span><span id='topic+dbQuoteString+2CAthenaConnection+2CDate-method'></span><span id='topic+dbQuoteIdentifier+2CAthenaConnection+2CSQL-method'></span>

<h3>Description</h3>

<p>Call this method to generate string that is suitable for use in a query as a column or table name.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaConnection,character'
dbQuoteString(conn, x, ...)

## S4 method for signature 'AthenaConnection,POSIXct'
dbQuoteString(conn, x, ...)

## S4 method for signature 'AthenaConnection,Date'
dbQuoteString(conn, x, ...)

## S4 method for signature 'AthenaConnection,SQL'
dbQuoteIdentifier(conn, x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbQuote_+3A_conn">conn</code></td>
<td>
<p>A <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a> object, as returned by
<code><a href="DBI.html#topic+dbConnect">dbConnect()</a></code>.</p>
</td></tr>
<tr><td><code id="dbQuote_+3A_x">x</code></td>
<td>
<p>A character vector to quote as string.</p>
</td></tr>
<tr><td><code id="dbQuote_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a character object, for more information please check out: <code><a href="DBI.html#topic+dbQuoteString">dbQuoteString</a></code>, <code><a href="DBI.html#topic+dbQuoteIdentifier">dbQuoteIdentifier</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="DBI.html#topic+dbQuoteString">dbQuoteString</a></code>, <code><a href="DBI.html#topic+dbQuoteIdentifier">dbQuoteIdentifier</a></code>
</p>

<hr>
<h2 id='dbRemoveTable'>Remove table from Athena</h2><span id='topic+dbRemoveTable'></span><span id='topic+dbRemoveTable+2CAthenaConnection+2Ccharacter-method'></span><span id='topic+dbRemoveTable+2CAthenaConnection+2CId-method'></span>

<h3>Description</h3>

<p>Removes Athena table but does not remove the data from Amazon S3 bucket.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaConnection,character'
dbRemoveTable(conn, name, delete_data = TRUE, confirm = FALSE, ...)

## S4 method for signature 'AthenaConnection,Id'
dbRemoveTable(conn, name, delete_data = TRUE, confirm = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbRemoveTable_+3A_conn">conn</code></td>
<td>
<p>A <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a> object, as returned by
<code><a href="DBI.html#topic+dbConnect">dbConnect()</a></code>.</p>
</td></tr>
<tr><td><code id="dbRemoveTable_+3A_name">name</code></td>
<td>
<p>The table name, passed on to <code><a href="DBI.html#topic+dbQuoteIdentifier">dbQuoteIdentifier()</a></code>. Options are:
</p>

<ul>
<li><p> a character string with the unquoted DBMS table name,
e.g. <code>"table_name"</code>,
</p>
</li>
<li><p> a call to <code><a href="DBI.html#topic+Id">Id()</a></code> with components to the fully qualified table name,
e.g. <code>Id(schema = "my_schema", table = "table_name")</code>
</p>
</li>
<li><p> a call to <code><a href="DBI.html#topic+SQL">SQL()</a></code> with the quoted and fully qualified table name
given verbatim, e.g. <code>SQL('"my_schema"."table_name"')</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="dbRemoveTable_+3A_delete_data">delete_data</code></td>
<td>
<p>Deletes S3 files linking to AWS Athena table</p>
</td></tr>
<tr><td><code id="dbRemoveTable_+3A_confirm">confirm</code></td>
<td>
<p>Allows for S3 files to be deleted without the prompt check. It is recommend to leave this set to <code>FALSE</code>
to avoid deleting other S3 files when the table's definition points to the root of S3 bucket.</p>
</td></tr>
<tr><td><code id="dbRemoveTable_+3A_...">...</code></td>
<td>
<p>Other parameters passed on to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dbRemoveTable()</code> returns <code>TRUE</code>, invisibly.
</p>


<h3>Note</h3>

<p>If you are having difficulty removing AWS S3 files please check if the
AWS S3 location following AWS best practises: <a href="https://docs.aws.amazon.com/athena/latest/ug/tables-location-format.html">Table Location in Amazon S3</a>
</p>


<h3>See Also</h3>

<p><code><a href="DBI.html#topic+dbRemoveTable">dbRemoveTable</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documnentation

library(DBI)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

# Write data.frame to Athena table
dbWriteTable(con, "mtcars", mtcars,
  partition = c("TIMESTAMP" = format(Sys.Date(), "%Y%m%d")),
  s3.location = "s3://mybucket/data/"
)

# Remove Table from Athena
dbRemoveTable(con, "mtcars")

# Disconnect conenction
dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='dbShow'>Show Athena table's DDL</h2><span id='topic+dbShow'></span><span id='topic+dbShow+2CAthenaConnection-method'></span>

<h3>Description</h3>

<p>Executes a statement to return the data description language (DDL) of the Athena table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbShow(conn, name, ...)

## S4 method for signature 'AthenaConnection'
dbShow(conn, name, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbShow_+3A_conn">conn</code></td>
<td>
<p>A <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a> object, as returned by
<code><a href="DBI.html#topic+dbConnect">dbConnect()</a></code>.</p>
</td></tr>
<tr><td><code id="dbShow_+3A_name">name</code></td>
<td>
<p>The table name, passed on to <code><a href="DBI.html#topic+dbQuoteIdentifier">dbQuoteIdentifier()</a></code>. Options are:
</p>

<ul>
<li><p> a character string with the unquoted DBMS table name,
e.g. <code>"table_name"</code>,
</p>
</li>
<li><p> a call to <code><a href="DBI.html#topic+Id">Id()</a></code> with components to the fully qualified table name,
e.g. <code>Id(schema = "my_schema", table = "table_name")</code>
</p>
</li>
<li><p> a call to <code><a href="DBI.html#topic+SQL">SQL()</a></code> with the quoted and fully qualified table name
given verbatim, e.g. <code>SQL('"my_schema"."table_name"')</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="dbShow_+3A_...">...</code></td>
<td>
<p>Other parameters passed on to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dbShow()</code> returns <code><a href="DBI.html#topic+SQL">SQL</a></code> characters of the Athena table DDL.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documnentation

library(DBI)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

# write iris table to Athena
dbWriteTable(con, "iris",
  iris,
  partition = c("timestamp" = format(Sys.Date(), "%Y%m%d")),
  s3.location = "s3://path/to/store/athena/table/"
)

# return table ddl
noctua::dbShow(con, "iris")

# disconnect from Athena
dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='dbStatistics'>Show AWS Athena Statistics</h2><span id='topic+dbStatistics'></span><span id='topic+dbStatistics+2CAthenaResult-method'></span>

<h3>Description</h3>

<p>Returns AWS Athena Statistics from execute queries <code><a href="DBI.html#topic+dbSendQuery">dbSendQuery</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbStatistics(res, ...)

## S4 method for signature 'AthenaResult'
dbStatistics(res, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbStatistics_+3A_res">res</code></td>
<td>
<p>An object inheriting from <a href="DBI.html#topic+DBIResult-class">DBIResult</a>.</p>
</td></tr>
<tr><td><code id="dbStatistics_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dbStatistics()</code> returns list containing Athena Statistics return from <code>paws</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `RAthena::dbConnect` documnentation

library(DBI)
library(noctua)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

res &lt;- dbSendQuery(con, "show databases")
dbStatistics(res)

# Clean up
dbClearResult(res)

## End(Not run)
</code></pre>

<hr>
<h2 id='noctua_options'>A method to configure noctua backend options.</h2><span id='topic+noctua_options'></span>

<h3>Description</h3>

<p><code>noctua_options()</code> provides a method to change the backend. This includes changing the file parser,
whether <code>noctua</code> should cache query ids locally and number of retries on a failed api call.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>noctua_options(
  file_parser,
  bigint,
  binary,
  json,
  cache_size,
  clear_cache,
  retry,
  retry_quiet,
  unload,
  clear_s3_resource,
  verbose
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="noctua_options_+3A_file_parser">file_parser</code></td>
<td>
<p>Method to read and write tables to Athena, currently default to <code>"data.table"</code>. The file_parser also
determines the data format returned for example <code>"data.table"</code> will return <code>data.table</code> and <code>"vroom"</code> will return <code>tibble</code>.</p>
</td></tr>
<tr><td><code id="noctua_options_+3A_bigint">bigint</code></td>
<td>
<p>The R type that 64-bit integer types should be mapped to (default: <code>"integer64"</code>).
Inbuilt <code>bigint</code> conversion types [&quot;integer64&quot;, &quot;integer&quot;, &quot;numeric&quot;, &quot;character&quot;].</p>
</td></tr>
<tr><td><code id="noctua_options_+3A_binary">binary</code></td>
<td>
<p>The R type that [binary/varbinary] types should be mapped to (default <code>"raw"</code>).
Inbuilt binary conversion types [&quot;raw&quot;, &quot;character&quot;].</p>
</td></tr>
<tr><td><code id="noctua_options_+3A_json">json</code></td>
<td>
<p>Attempt to converts AWS Athena data types [arrays, json] using <code>jsonlite:parse_json</code> (default: <code>"auto"</code>).
Inbuilt json conversion types [&quot;auto&quot;, &quot;character&quot;].
Custom Json parsers can be provide by using a function with data frame parameter.</p>
</td></tr>
<tr><td><code id="noctua_options_+3A_cache_size">cache_size</code></td>
<td>
<p>Number of queries to be cached. Currently only support caching up to 100 distinct queries (default: <code>0</code>).</p>
</td></tr>
<tr><td><code id="noctua_options_+3A_clear_cache">clear_cache</code></td>
<td>
<p>Clears all previous cached query metadata</p>
</td></tr>
<tr><td><code id="noctua_options_+3A_retry">retry</code></td>
<td>
<p>Maximum number of requests to attempt (default: <code>5</code>).</p>
</td></tr>
<tr><td><code id="noctua_options_+3A_retry_quiet">retry_quiet</code></td>
<td>
<p>This method is deprecated please use verbose instead.</p>
</td></tr>
<tr><td><code id="noctua_options_+3A_unload">unload</code></td>
<td>
<p>set AWS Athena unload functionality globally (default: <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="noctua_options_+3A_clear_s3_resource">clear_s3_resource</code></td>
<td>
<p>Clear down 'AWS Athena' 'AWS S3' resource (<code>s3_staging_dir</code> location).
This is useful for users that don't have the 'AWS IAM role' permissions delete
from 's3_staging_dir' (default: <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="noctua_options_+3A_verbose">verbose</code></td>
<td>
<p>print package info messages (default: <code>TRUE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>noctua_options()</code> returns <code>NULL</code>, invisibly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(noctua)

# change file parser from default data.table to vroom
noctua_options("vroom")

# cache queries locally
noctua_options(cache_size = 5)
</code></pre>

<hr>
<h2 id='Query'>Execute a query on Athena</h2><span id='topic+Query'></span><span id='topic+dbSendQuery+2CAthenaConnection+2Ccharacter-method'></span><span id='topic+dbSendStatement+2CAthenaConnection+2Ccharacter-method'></span><span id='topic+dbExecute+2CAthenaConnection+2Ccharacter-method'></span>

<h3>Description</h3>

<p>The <code>dbSendQuery()</code> and <code>dbSendStatement()</code> method submits a query to Athena but does not wait for query to execute.
<code><a href="#topic+dbHasCompleted">dbHasCompleted</a></code> method will need to ran to check if query has been completed or not.
The <code>dbExecute()</code> method submits a query to Athena and waits for the query to be executed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaConnection,character'
dbSendQuery(conn, statement, unload = athena_unload(), ...)

## S4 method for signature 'AthenaConnection,character'
dbSendStatement(conn, statement, unload = athena_unload(), ...)

## S4 method for signature 'AthenaConnection,character'
dbExecute(conn, statement, unload = athena_unload(), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Query_+3A_conn">conn</code></td>
<td>
<p>A <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a> object, as returned by
<code><a href="DBI.html#topic+dbConnect">dbConnect()</a></code>.</p>
</td></tr>
<tr><td><code id="Query_+3A_statement">statement</code></td>
<td>
<p>a character string containing SQL.</p>
</td></tr>
<tr><td><code id="Query_+3A_unload">unload</code></td>
<td>
<p>boolean input to modify 'statement' to align with <a href="https://docs.aws.amazon.com/athena/latest/ug/unload.html">AWS Athena UNLOAD</a>,
default is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="Query_+3A_...">...</code></td>
<td>
<p>Other parameters passed on to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns <code>AthenaResult</code> s4 class.
</p>


<h3>See Also</h3>

<p><code><a href="DBI.html#topic+dbSendQuery">dbSendQuery</a></code>, <code><a href="DBI.html#topic+dbSendStatement">dbSendStatement</a></code>, <code><a href="DBI.html#topic+dbExecute">dbExecute</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documnentation

library(DBI)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

# Sending Queries to Athena
res1 &lt;- dbSendQuery(con, "show databases")
res2 &lt;- dbSendStatement(con, "show databases")
res3 &lt;- dbExecute(con, "show databases")

# Disconnect conenction
dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='session_token'>Get Session Tokens for PAWS Connection</h2><span id='topic+session_token'></span><span id='topic+get_session_token'></span>

<h3>Description</h3>

<p>Returns a set of temporary credentials for an AWS account or IAM user (<a href="https://www.paws-r-sdk.com/docs/sts_get_session_token/">link</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_session_token(
  profile_name = NULL,
  region_name = NULL,
  serial_number = NULL,
  token_code = NULL,
  duration_seconds = 3600L,
  set_env = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="session_token_+3A_profile_name">profile_name</code></td>
<td>
<p>The name of a profile to use. If not given, then the default profile is used.
To set profile name, the <a href="https://aws.amazon.com/cli/">AWS Command Line Interface</a> (AWS CLI) will need to be configured.
To configure AWS CLI please refer to: <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html">Configuring the AWS CLI</a>.</p>
</td></tr>
<tr><td><code id="session_token_+3A_region_name">region_name</code></td>
<td>
<p>Default region when creating new connections. Please refer to <a href="https://docs.aws.amazon.com/general/latest/gr/rande.html">link</a> for
AWS region codes (region code example: Region = EU (Ireland)     <code> region_name = "eu-west-1"</code>)</p>
</td></tr>
<tr><td><code id="session_token_+3A_serial_number">serial_number</code></td>
<td>
<p>The identification number of the MFA device that is associated with the IAM user who is making the GetSessionToken call.
Specify this value if the IAM user has a policy that requires MFA authentication. The value is either the serial number for a hardware device
(such as 'GAHT12345678') or an Amazon Resource Name (ARN) for a virtual device (such as arn:aws:iam::123456789012:mfa/user).</p>
</td></tr>
<tr><td><code id="session_token_+3A_token_code">token_code</code></td>
<td>
<p>The value provided by the MFA device, if MFA is required. If any policy requires the IAM user to submit an MFA code,
specify this value. If MFA authentication is required, the user must provide a code when requesting a set of temporary
security credentials. A user who fails to provide the code receives an &quot;access denied&quot; response when requesting resources
that require MFA authentication.</p>
</td></tr>
<tr><td><code id="session_token_+3A_duration_seconds">duration_seconds</code></td>
<td>
<p>The duration, in seconds, that the credentials should remain valid. Acceptable duration for IAM user sessions range
from 900 seconds (15 minutes) to 129,600 seconds (36 hours), with 3,600 seconds (1 hour) as the default.</p>
</td></tr>
<tr><td><code id="session_token_+3A_set_env">set_env</code></td>
<td>
<p>If set to <code>TRUE</code> environmental variables <code>AWS_ACCESS_KEY_ID</code>, <code>AWS_SECRET_ACCESS_KEY</code> and <code>AWS_SESSION_TOKEN</code> will be set.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>get_session_token()</code> returns a list containing: <code>"AccessKeyId"</code>, <code>"SecretAccessKey"</code>, <code>"SessionToken"</code> and <code>"Expiration"</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.

library(noctua)
library(DBI)

# Create Temporary Credentials duration 1 hour
get_session_token("YOUR_PROFILE_NAME",
  serial_number = "arn:aws:iam::123456789012:mfa/user",
  token_code = "531602",
  set_env = TRUE
)

# Connect to Athena using temporary credentials
con &lt;- dbConnect(athena())

## End(Not run)
</code></pre>

<hr>
<h2 id='sql_translate_env'>AWS Athena backend dbplyr version 1 and 2</h2><span id='topic+sql_translate_env'></span><span id='topic+sql_translation.AthenaConnection'></span><span id='topic+sql_translate_env.AthenaConnection'></span><span id='topic+sql_escape_string.AthenaConnection'></span>

<h3>Description</h3>

<p>Create s3 implementation of <code>sql_translate_env</code> for AWS Athena sql translate environment based off
<a href="https://docs.aws.amazon.com/athena/latest/ug/data-types.html">Athena Data Types</a> and 
<a href="https://docs.aws.amazon.com/athena/latest/ug/functions-operators-reference-section.html">DML Queries, Functions, and Operators</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sql_translation.AthenaConnection(con)

sql_translate_env.AthenaConnection(con)

sql_escape_string.AthenaConnection(con, x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sql_translate_env_+3A_con">con</code></td>
<td>
<p>An <code><a href="#topic+AthenaConnection-class">AthenaConnection</a></code> object, produced by
[DBI::dbConnect()]</p>
</td></tr>
<tr><td><code id="sql_translate_env_+3A_x">x</code></td>
<td>
<p>An object to escape. Existing sql vectors will be left as is,
character vectors are escaped with single quotes, numeric vectors have
trailing &lsquo;.0' added if they&rsquo;re whole numbers, identifiers are
escaped with double quotes.</p>
</td></tr>
</table>

<hr>
<h2 id='sqlCreateTable'>Creates query to create a simple Athena table</h2><span id='topic+sqlCreateTable'></span><span id='topic+sqlCreateTable+2CAthenaConnection-method'></span>

<h3>Description</h3>

<p>Creates an interface to compose <code>CREATE EXTERNAL TABLE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaConnection'
sqlCreateTable(
  con,
  table,
  fields,
  field.types = NULL,
  partition = NULL,
  s3.location = NULL,
  file.type = c("tsv", "csv", "parquet", "json"),
  compress = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sqlCreateTable_+3A_con">con</code></td>
<td>
<p>A database connection.</p>
</td></tr>
<tr><td><code id="sqlCreateTable_+3A_table">table</code></td>
<td>
<p>The table name, passed on to <code><a href="DBI.html#topic+dbQuoteIdentifier">dbQuoteIdentifier()</a></code>. Options are:
</p>

<ul>
<li><p> a character string with the unquoted DBMS table name,
e.g. <code>"table_name"</code>,
</p>
</li>
<li><p> a call to <code><a href="DBI.html#topic+Id">Id()</a></code> with components to the fully qualified table name,
e.g. <code>Id(schema = "my_schema", table = "table_name")</code>
</p>
</li>
<li><p> a call to <code><a href="DBI.html#topic+SQL">SQL()</a></code> with the quoted and fully qualified table name
given verbatim, e.g. <code>SQL('"my_schema"."table_name"')</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="sqlCreateTable_+3A_fields">fields</code></td>
<td>
<p>Either a character vector or a data frame.
</p>
<p>A named character vector: Names are column names, values are types.
Names are escaped with <code><a href="DBI.html#topic+dbQuoteIdentifier">dbQuoteIdentifier()</a></code>.
Field types are unescaped.
</p>
<p>A data frame: field types are generated using
<code><a href="DBI.html#topic+dbDataType">dbDataType()</a></code>.</p>
</td></tr>
<tr><td><code id="sqlCreateTable_+3A_field.types">field.types</code></td>
<td>
<p>Additional field types used to override derived types.</p>
</td></tr>
<tr><td><code id="sqlCreateTable_+3A_partition">partition</code></td>
<td>
<p>Partition Athena table (needs to be a named list or vector) for example: <code>c(var1 = "2019-20-13")</code></p>
</td></tr>
<tr><td><code id="sqlCreateTable_+3A_s3.location">s3.location</code></td>
<td>
<p>s3 bucket to store Athena table, must be set as a s3 uri for example (&quot;s3://mybucket/data/&quot;).
By default s3.location is set s3 staging directory from <code><a href="#topic+AthenaConnection-class">AthenaConnection</a></code> object.</p>
</td></tr>
<tr><td><code id="sqlCreateTable_+3A_file.type">file.type</code></td>
<td>
<p>What file type to store data.frame on s3, noctua currently supports [&quot;tsv&quot;, &quot;csv&quot;, &quot;parquet&quot;, &quot;json&quot;]. Default delimited file type is &quot;tsv&quot;, in previous versions
of <code>noctua (=&lt; 1.4.0)</code> file type &quot;csv&quot; was used as default. The reason for the change is that columns containing <code>Array/JSON</code> format cannot be written to
Athena due to the separating value &quot;,&quot;. This would cause issues with AWS Athena.
<strong>Note:</strong> &quot;parquet&quot; format is supported by the <code>arrow</code> package and it will need to be installed to utilise the &quot;parquet&quot; format.
&quot;json&quot; format is supported by <code>jsonlite</code> package and it will need to be installed to utilise the &quot;json&quot; format.</p>
</td></tr>
<tr><td><code id="sqlCreateTable_+3A_compress">compress</code></td>
<td>
<p><code>FALSE | TRUE</code> To determine if to compress file.type. If file type is [&quot;csv&quot;, &quot;tsv&quot;] then &quot;gzip&quot; compression is used, for file type &quot;parquet&quot;
&quot;snappy&quot; compression is used. Currently <code>noctua</code> doesn't support compression for &quot;json&quot; file type.</p>
</td></tr>
<tr><td><code id="sqlCreateTable_+3A_...">...</code></td>
<td>
<p>Other arguments used by individual methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>sqlCreateTable</code> returns data.frame's <code>DDL</code> in the <code><a href="DBI.html#topic+SQL">SQL</a></code> format.
</p>


<h3>See Also</h3>

<p><code><a href="DBI.html#topic+sqlCreateTable">sqlCreateTable</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documnentation

library(DBI)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

# Create DDL for iris data.frame
sqlCreateTable(con, "iris", iris, s3.location = "s3://path/to/athena/table")

# Create DDL for iris data.frame with partition
sqlCreateTable(con, "iris", iris,
  partition = "timestamp",
  s3.location = "s3://path/to/athena/table"
)

# Create DDL for iris data.frame with partition and file.type parquet
sqlCreateTable(con, "iris", iris,
  partition = "timestamp",
  s3.location = "s3://path/to/athena/table",
  file.type = "parquet"
)

# Disconnect from Athena
dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='sqlData'>Converts data frame into suitable format to be uploaded to Athena</h2><span id='topic+sqlData'></span><span id='topic+sqlData+2CAthenaConnection-method'></span>

<h3>Description</h3>

<p>This method converts data.frame columns into the correct format so that it can be uploaded Athena.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'AthenaConnection'
sqlData(
  con,
  value,
  row.names = NA,
  file.type = c("tsv", "csv", "parquet", "json"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sqlData_+3A_con">con</code></td>
<td>
<p>A database connection.</p>
</td></tr>
<tr><td><code id="sqlData_+3A_value">value</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="sqlData_+3A_row.names">row.names</code></td>
<td>
<p>Either <code>TRUE</code>, <code>FALSE</code>, <code>NA</code> or a string.
</p>
<p>If <code>TRUE</code>, always translate row names to a column called &quot;row_names&quot;.
If <code>FALSE</code>, never translate row names. If <code>NA</code>, translate
rownames only if they're a character vector.
</p>
<p>A string is equivalent to <code>TRUE</code>, but allows you to override the
default name.
</p>
<p>For backward compatibility, <code>NULL</code> is equivalent to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="sqlData_+3A_file.type">file.type</code></td>
<td>
<p>What file type to store data.frame on s3, noctua currently supports [&quot;csv&quot;, &quot;tsv&quot;, &quot;parquet&quot;, &quot;json&quot;].
<strong>Note:</strong> This parameter is used for format any special characters that clash with file type separator.</p>
</td></tr>
<tr><td><code id="sqlData_+3A_...">...</code></td>
<td>
<p>Other arguments used by individual methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>sqlData</code> returns a dataframe formatted for Athena. Currently converts <code>list</code> variable types into <code>character</code>
split by <code>'|'</code>, similar to how <code>data.table</code> writes out to files.
</p>


<h3>See Also</h3>

<p><code><a href="DBI.html#topic+sqlData">sqlData</a></code>
</p>

<hr>
<h2 id='work_group'>Athena Work Groups</h2><span id='topic+work_group'></span><span id='topic+create_work_group'></span><span id='topic+tag_options'></span><span id='topic+delete_work_group'></span><span id='topic+list_work_groups'></span><span id='topic+get_work_group'></span><span id='topic+update_work_group'></span>

<h3>Description</h3>

<p>Lower level API access, allows user to create and delete Athena Work Groups.
</p>

<dl>
<dt>create_work_group</dt><dd><p>Creates a workgroup with the specified name (<a href="https://www.paws-r-sdk.com/docs/athena_create_work_group/">link</a>).
The work group utilises parameters from the <code>dbConnect</code> object, to determine the encryption and output location of the work group.
The s3_staging_dir, encryption_option and kms_key parameters are gotten from <code><a href="#topic+dbConnect">dbConnect</a></code></p>
</dd>
<dt>tag_options</dt><dd><p>Helper function to create tag options for function <code>create_work_group()</code></p>
</dd>
<dt>delete_work_group</dt><dd><p>Deletes the workgroup with the specified name (<a href="https://www.paws-r-sdk.com/docs/athena_delete_work_group/">link</a>).
The primary workgroup cannot be deleted.</p>
</dd>
<dt>list_work_groups</dt><dd><p>Lists available workgroups for the account (<a href="https://www.paws-r-sdk.com/docs/athena_list_work_groups/">link</a>).</p>
</dd>
<dt>get_work_group</dt><dd><p>Returns information about the workgroup with the specified name (<a href="https://www.paws-r-sdk.com/docs/athena_get_work_group/">link</a>).</p>
</dd>
<dt>update_work_group</dt><dd><p>Updates the workgroup with the specified name (<a href="https://www.paws-r-sdk.com/docs/athena_update_work_group/">link</a>).
The workgroup's name cannot be changed. The work group utilises parameters from the <code>dbConnect</code> object, to determine the encryption and output location of the work group.
The s3_staging_dir, encryption_option and kms_key parameters are gotten from <code><a href="#topic+dbConnect">dbConnect</a></code></p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>create_work_group(
  conn,
  work_group = NULL,
  enforce_work_group_config = FALSE,
  publish_cloud_watch_metrics = FALSE,
  bytes_scanned_cut_off = 10000000L,
  description = NULL,
  tags = tag_options(key = NULL, value = NULL)
)

tag_options(key = NULL, value = NULL)

delete_work_group(conn, work_group = NULL, recursive_delete_option = FALSE)

list_work_groups(conn)

get_work_group(conn, work_group = NULL)

update_work_group(
  conn,
  work_group = NULL,
  remove_output_location = FALSE,
  enforce_work_group_config = FALSE,
  publish_cloud_watch_metrics = FALSE,
  bytes_scanned_cut_off = 10000000L,
  description = NULL,
  state = c("ENABLED", "DISABLED")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="work_group_+3A_conn">conn</code></td>
<td>
<p>A <code><a href="#topic+dbConnect">dbConnect</a></code> object, as returned by <code>dbConnect()</code></p>
</td></tr>
<tr><td><code id="work_group_+3A_work_group">work_group</code></td>
<td>
<p>The Athena workgroup name.</p>
</td></tr>
<tr><td><code id="work_group_+3A_enforce_work_group_config">enforce_work_group_config</code></td>
<td>
<p>If set to <code>TRUE</code>, the settings for the workgroup override client-side settings.
If set to <code>FALSE</code>, client-side settings are used. For more information, see
<a href="https://docs.aws.amazon.com/athena/latest/ug/workgroups-settings-override.html">Workgroup Settings Override Client-Side Settings</a>.</p>
</td></tr>
<tr><td><code id="work_group_+3A_publish_cloud_watch_metrics">publish_cloud_watch_metrics</code></td>
<td>
<p>Indicates that the Amazon CloudWatch metrics are enabled for the workgroup.</p>
</td></tr>
<tr><td><code id="work_group_+3A_bytes_scanned_cut_off">bytes_scanned_cut_off</code></td>
<td>
<p>The upper data usage limit (cutoff) for the amount of bytes a single query in a workgroup is allowed to scan.</p>
</td></tr>
<tr><td><code id="work_group_+3A_description">description</code></td>
<td>
<p>The workgroup description.</p>
</td></tr>
<tr><td><code id="work_group_+3A_tags">tags</code></td>
<td>
<p>A tag that you can add to a resource. A tag is a label that you assign to an AWS Athena resource (a workgroup).
Each tag consists of a key and an optional value, both of which you define. Tags enable you to categorize workgroups in Athena, for example,
by purpose, owner, or environment. Use a consistent set of tag keys to make it easier to search and filter workgroups in your account.
The maximum tag key length is 128 Unicode characters in UTF-8. The maximum tag value length is 256 Unicode characters in UTF-8.
You can use letters and numbers representable in UTF-8, and the following characters: <code>"+ - = . _ : / @"</code>. Tag keys and values are case-sensitive.
Tag keys must be unique per resource. Please use the helper function <code>tag_options()</code> to create tags for work group, if no tags are required please put <code>NULL</code> for this parameter.</p>
</td></tr>
<tr><td><code id="work_group_+3A_key">key</code></td>
<td>
<p>A tag key. The tag key length is from 1 to 128 Unicode characters in UTF-8. You can use letters and numbers representable in UTF-8, and the following characters: <code>"+ - = . _ : / @"</code>.
Tag keys are case-sensitive and must be unique per resource.</p>
</td></tr>
<tr><td><code id="work_group_+3A_value">value</code></td>
<td>
<p>A tag value. The tag value length is from 0 to 256 Unicode characters in UTF-8. You can use letters and numbers representable in UTF-8, and the following characters: <code>"+ - = . _ : / @"</code>.
Tag values are case-sensitive.</p>
</td></tr>
<tr><td><code id="work_group_+3A_recursive_delete_option">recursive_delete_option</code></td>
<td>
<p>The option to delete the workgroup and its contents even if the workgroup contains any named queries</p>
</td></tr>
<tr><td><code id="work_group_+3A_remove_output_location">remove_output_location</code></td>
<td>
<p>If set to <code>TRUE</code>, indicates that the previously-specified query results location (also known as a client-side setting) for queries in this workgroup should be ignored and set to null.
If set to <code>FALSE</code> the out put location in the workgroup's result configuration will be updated with the new value.
For more information, see <a href="https://docs.aws.amazon.com/athena/latest/ug/workgroups-settings-override.html">Workgroup Settings Override Client-Side Settings</a>.</p>
</td></tr>
<tr><td><code id="work_group_+3A_state">state</code></td>
<td>
<p>The workgroup state that will be updated for the given workgroup.</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt>create_work_group</dt><dd><p>Returns <code>NULL</code> but invisible</p>
</dd>
<dt>tag_options</dt><dd><p>Returns <code>list</code> but invisible</p>
</dd>
<dt>delete_work_group</dt><dd><p>Returns <code>NULL</code> but invisible</p>
</dd>
<dt>list_work_groups</dt><dd><p>Returns list of available work groups</p>
</dd>
<dt>get_work_group</dt><dd><p>Returns list of work group meta data</p>
</dd>
<dt>update_work_group</dt><dd><p>Returns <code>NULL</code> but invisible</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Note:
# - Require AWS Account to run below example.
# - Different connection methods can be used please see `noctua::dbConnect` documnentation

library(noctua)

# Demo connection to Athena using profile name
con &lt;- dbConnect(noctua::athena())

# List current work group available
list_work_groups(con)

# Create a new work group
wg &lt;- create_work_group(con,
  "demo_work_group",
  description = "This is a demo work group",
  tags = tag_options(key = "demo_work_group", value = "demo_01")
)

# List work groups to see new work group
list_work_groups(con)

# get meta data from work group
wg &lt;- get_work_group(con, "demo_work_group")

# Update work group
wg &lt;- update_work_group(con, "demo_work_group",
  description = "This is a demo work group update"
)


# get updated meta data from work group
wg &lt;- get_work_group(con, "demo_work_group")

# Delete work group
delete_work_group(con, "demo_work_group")

# Disconect from Athena
dbDisconnect(con)

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
