<!DOCTYPE html><html lang="en-US"><head><title>Help for package inlamemi</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {inlamemi}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#coef.inlamemi'><p>Extract model coefficients</p></a></li>
<li><a href='#extract_random_effects'><p>Extract random effects from formula</p></a></li>
<li><a href='#extract_variables_from_formula'><p>Extract and group variables from formulas</p></a></li>
<li><a href='#fit_inlamemi'><p>Fit model for measurement error and missing data in INLA</p></a></li>
<li><a href='#framingham'><p>Framingham heart study data</p></a></li>
<li><a href='#get_coef_imp'><p>Extract coefficients for the imputation model (IMP)</p></a></li>
<li><a href='#get_coef_mis'><p>Extract coefficients for the missingness model (MIS)</p></a></li>
<li><a href='#get_coef_moi'><p>Extract coefficients for the model of interest (MOI)</p></a></li>
<li><a href='#get_imputed'><p>Extract imputed values</p></a></li>
<li><a href='#inla_survival_families'><p>List the survival likelihoods in INLA</p></a></li>
<li><a href='#make_inlamemi_control.family'><p>Make &quot;control.family&quot; argument for passing to the &quot;inla&quot; function</p></a></li>
<li><a href='#make_inlamemi_families'><p>Make vector of likelihood families</p></a></li>
<li><a href='#make_inlamemi_formula'><p>Make formula for measurement error and missing data model</p></a></li>
<li><a href='#make_inlamemi_scaling_vector'><p>Construct scaling vector to scale the precision of correctly observed observations</p></a></li>
<li><a href='#make_inlamemi_stacks'><p>Make data stacks for joint model specification in INLA</p></a></li>
<li><a href='#mar_data'><p>Simulated data with observation missing at random (MAR)</p></a></li>
<li><a href='#nhanes_survival'><p>Survival data with repeated systolic blood pressure measurements</p></a></li>
<li><a href='#plot.inlamemi'><p>Plot model summary</p></a></li>
<li><a href='#print.inlamemi'><p>Print method for inlamemi</p></a></li>
<li><a href='#show_data_structure'><p>Visualize the model data structure as matrices in LaTeX</p></a></li>
<li><a href='#simple_data'><p>Simple simulated data</p></a></li>
<li><a href='#simplify_inlamemi_model_summary'><p>Simplify the &quot;raw&quot; model summary for printing and plotting</p></a></li>
<li><a href='#summary.inlamemi'><p>Summary method for inlamemi</p></a></li>
<li><a href='#two_error_data'><p>Simulated data with two covariates with classical measurement error</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Missing Data and Measurement Error Modelling in INLA</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Facilitates fitting measurement error and missing data imputation models using integrated nested Laplace approximations, according to the method described in Skarstein, Martino and Muff (2023) &lt;<a href="https://doi.org/10.1002%2Fbimj.202300078">doi:10.1002/bimj.202300078</a>&gt;. See Skarstein and Muff (2024) &lt;<a href="https://doi.org/10.48550%2FarXiv.2406.08172">doi:10.48550/arXiv.2406.08172</a>&gt; for details on using the package.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>INLA, knitr, testthat (&ge; 3.0.0), tibble, rmarkdown, spelling</td>
</tr>
<tr>
<td>Additional_repositories:</td>
<td><a href="https://inla.r-inla-download.org/R/stable/">https://inla.r-inla-download.org/R/stable/</a></td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, rlang, stats, methods, scales</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://emmaskarstein.github.io/inlamemi/">https://emmaskarstein.github.io/inlamemi/</a>,
<a href="https://github.com/emmaSkarstein/inlamemi">https://github.com/emmaSkarstein/inlamemi</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-31 13:42:45 UTC; emmass</td>
</tr>
<tr>
<td>Author:</td>
<td>Emma Skarstein <a href="https://orcid.org/0000-0002-6347-855X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, aut, cph],
  Stefanie Muff <a href="https://orcid.org/0000-0002-8425-0757"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Emma Skarstein &lt;emma@skarstein.no&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-31 16:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='coef.inlamemi'>Extract model coefficients</h2><span id='topic+coef.inlamemi'></span>

<h3>Description</h3>

<p>Extract model coefficients
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'inlamemi'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.inlamemi_+3A_object">object</code></td>
<td>
<p>object of class 'inlamemi'</p>
</td></tr>
<tr><td><code id="coef.inlamemi_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='extract_random_effects'>Extract random effects from formula</h2><span id='topic+extract_random_effects'></span>

<h3>Description</h3>

<p>Extract random effects from formula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_random_effects(formula)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_random_effects_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot;, either the formula for the model of interest, the imputation model or the missingness model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing &quot;reff_vars&quot;, the random effect variables, and &quot;reff&quot;, the entire random effect term.
</p>

<hr>
<h2 id='extract_variables_from_formula'>Extract and group variables from formulas</h2><span id='topic+extract_variables_from_formula'></span>

<h3>Description</h3>

<p>Helper function that takes in the formulas for the model of interest and the
imputation model, and groups them into responses, covariates, covariate with
error and covariate(s) without error, for both sub-models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_variables_from_formula(
  formula_moi,
  formula_imp,
  formula_mis = NULL,
  error_variable = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_variables_from_formula_+3A_formula_moi">formula_moi</code></td>
<td>
<p>an object of class &quot;formula&quot;, describing the main model to be fitted.</p>
</td></tr>
<tr><td><code id="extract_variables_from_formula_+3A_formula_imp">formula_imp</code></td>
<td>
<p>an object of class &quot;formula&quot;, describing the imputation model for the mismeasured and/or missing observations.</p>
</td></tr>
<tr><td><code id="extract_variables_from_formula_+3A_formula_mis">formula_mis</code></td>
<td>
<p>an object of class &quot;formula&quot;, describing the missingness model. Does not need to have a response variable, since this will always be a binary missingness indicator.</p>
</td></tr>
<tr><td><code id="extract_variables_from_formula_+3A_error_variable">error_variable</code></td>
<td>
<p>character vector with the name(s) of the variable(s) with error.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the names of the different variables of the model. The names of the elements in the list are &quot;response_moi&quot; (the response for the moi), &quot;covariates_moi&quot; (all covariates in the moi), &quot;error_variable&quot; (the name of the variable with error or missing data), &quot;covariates_error_free&quot; (the moi covariates without error), &quot;response_imp&quot; (imputation model response), &quot;covariates_imp&quot; (imputation model covariates).
</p>

<hr>
<h2 id='fit_inlamemi'>Fit model for measurement error and missing data in INLA</h2><span id='topic+fit_inlamemi'></span>

<h3>Description</h3>

<p>A wrapper function around &quot;INLA::inla()&quot;, providing the necessary structure to fit the hierarchical measurement error model that adjusts coefficient estimates to account for biases due to measurement error and missing data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_inlamemi(
  formula_moi,
  formula_imp = NULL,
  formula_mis = NULL,
  family_moi,
  data,
  error_type = "classical",
  error_variable = NULL,
  repeated_observations = FALSE,
  classical_error_scaling = NULL,
  prior.prec.moi = NULL,
  prior.prec.berkson = NULL,
  prior.prec.classical = NULL,
  prior.prec.imp = NULL,
  prior.beta.error = NULL,
  prior.gamma.error = NULL,
  initial.prec.moi = NULL,
  initial.prec.berkson = NULL,
  initial.prec.classical = NULL,
  initial.prec.imp = NULL,
  control.family.moi = NULL,
  control.family.berkson = NULL,
  control.family.classical = NULL,
  control.family.imp = NULL,
  control.family = NULL,
  control.predictor = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_inlamemi_+3A_formula_moi">formula_moi</code></td>
<td>
<p>an object of class &quot;formula&quot;, describing the main model to be fitted.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_formula_imp">formula_imp</code></td>
<td>
<p>an object of class &quot;formula&quot;, describing the imputation model for the mismeasured and/or missing observations.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_formula_mis">formula_mis</code></td>
<td>
<p>an object of class &quot;formula&quot;, describing the missingness model. Does not need to have a response variable, since this will always be a binary missingness indicator.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_family_moi">family_moi</code></td>
<td>
<p>a string indicating the likelihood family for the model of interest (the main model).</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_data">data</code></td>
<td>
<p>an object of class data.frame or list containing the variables in the model.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_error_type">error_type</code></td>
<td>
<p>type of error (one or more of &quot;classical&quot;, &quot;berkson&quot;, &quot;missing&quot;)</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_error_variable">error_variable</code></td>
<td>
<p>character vector with the name(s) of the variable(s) with error.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_repeated_observations">repeated_observations</code></td>
<td>
<p>Does the variable with measurement error and/or missingness have repeated observations? If so, set this to &quot;TRUE&quot;. In that case, when specifying the formula, use the name of the variable without any numbers, but when specifying the data, make sure that the repeated measurements end in a number, i.e &quot;sbp1&quot; and &quot;sbp2&quot;.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_classical_error_scaling">classical_error_scaling</code></td>
<td>
<p>can be specified if the classical measurement error varies across observations. Must be a vector of the same length as the data.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_prior.prec.moi">prior.prec.moi</code></td>
<td>
<p>a string containing the parameters for the prior for the precision of the residual term for the model of interest.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_prior.prec.berkson">prior.prec.berkson</code></td>
<td>
<p>a string containing the parameters for the prior for the precision of the error term for the Berkson error model.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_prior.prec.classical">prior.prec.classical</code></td>
<td>
<p>a string containing the parameters for the prior for the precision of the error term for the classical error model.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_prior.prec.imp">prior.prec.imp</code></td>
<td>
<p>a string containing the parameters for the precision of the latent variable x, which is the variable being described in the imputation model.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_prior.beta.error">prior.beta.error</code></td>
<td>
<p>parameters for the Gaussian prior for the coefficient of the error prone variable.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_prior.gamma.error">prior.gamma.error</code></td>
<td>
<p>parameters for the Gaussian prior for the coefficient of the variable with missingness in the missingness model.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_initial.prec.moi">initial.prec.moi</code></td>
<td>
<p>the initial value for the precision of the residual term for the model of interest.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_initial.prec.berkson">initial.prec.berkson</code></td>
<td>
<p>the initial value for the precision of the residual term for the Berkson error term.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_initial.prec.classical">initial.prec.classical</code></td>
<td>
<p>the initial value for the precision of the residual term for the classical error term.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_initial.prec.imp">initial.prec.imp</code></td>
<td>
<p>the initial value for the precision of the residual term for the latent variable r.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_control.family.moi">control.family.moi</code></td>
<td>
<p>control.family component for model of interest. Can be specified here using the inla syntax instead of passing the &quot;prior.prec...&quot; and &quot;initial.prec...&quot; arguments, or in the cases when other hyperparameters are needed for the model of interest, see for instance survival models.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_control.family.berkson">control.family.berkson</code></td>
<td>
<p>control.family component Berkson model. Can be specified here using the inla syntax instead of passing the &quot;prior.prec...&quot; and &quot;initial.prec...&quot; arguments. Useful in the cases when more flexibility is needed, for instance if one wants to specify a different prior distribution than Gamma.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_control.family.classical">control.family.classical</code></td>
<td>
<p>control.family component for classical model. Can be specified here using the inla syntax instead of passing the &quot;prior.prec...&quot; and &quot;initial.prec...&quot; arguments. Useful in the cases when more flexibility is needed, for instance if one wants to specify a different prior distribution than Gamma.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_control.family.imp">control.family.imp</code></td>
<td>
<p>control.family component for imputation model. Can be specified here using the inla syntax instead of passing the &quot;prior.prec...&quot; and &quot;initial.prec...&quot; arguments. Useful in the cases when more flexibility is needed, for instance if one wants to specify a different prior distribution than Gamma.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_control.family">control.family</code></td>
<td>
<p>control.family for use in inla (can be provided directly instead of passing the &quot;prior.prec....&quot; and &quot;initial.prec...&quot; arguments. If this is specified, any other &quot;control.family...&quot; or &quot;prior.prec...&quot; arguments provided will be ignored.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_control.predictor">control.predictor</code></td>
<td>
<p>control.predictor for use in inla.</p>
</td></tr>
<tr><td><code id="fit_inlamemi_+3A_...">...</code></td>
<td>
<p>other arguments to pass to 'inla'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>inlamemi</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Fit the model
simple_model &lt;- fit_inlamemi(data = simple_data,
                           formula_moi = y ~ x + z,
                           formula_imp = x ~ z,
                           family_moi = "gaussian",
                           error_type = c("berkson", "classical"),
                           error_variable = "x",
                           prior.prec.moi = c(10, 9),
                           prior.prec.berkson = c(10, 9),
                           prior.prec.classical = c(10, 9),
                           prior.prec.imp = c(10, 9),
                           prior.beta.error = c(0, 1/1000),
                           initial.prec.moi = 1,
                           initial.prec.berkson = 1,
                           initial.prec.classical = 1,
                           initial.prec.imp = 1)

</code></pre>

<hr>
<h2 id='framingham'>Framingham heart study data</h2><span id='topic+framingham'></span>

<h3>Description</h3>

<p>A data set with observations of heart disease status systolic blood pressure (SBP) and smoking status.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>framingham
</code></pre>


<h3>Format</h3>

<p>## 'framingham'
A data frame with 641 rows and 4 columns:
</p>

<dl>
<dt>disease</dt><dd><p>A binary response, 1 if heart disease, 0 otherwise</p>
</dd>
<dt>sbp1</dt><dd><p>log(SBP - 50) at examination 1 (centered)</p>
</dd>
<dt>sbp2</dt><dd><p>log(SBP - 50) at examination 2 (centered)</p>
</dd>
<dt>smoking</dt><dd><p>Smoking status, 1 if smoking, 0 otherwise.</p>
</dd>
</dl>



<h3>Source</h3>

<p>MacMahon et al. (1990) &lt;https://doi.org/10.1016/0140-6736(90)90878-9&gt;
</p>

<hr>
<h2 id='get_coef_imp'>Extract coefficients for the imputation model (IMP)</h2><span id='topic+get_coef_imp'></span>

<h3>Description</h3>

<p>Extract coefficients for the imputation model (IMP)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_coef_imp(inlamemi_model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_coef_imp_+3A_inlamemi_model">inlamemi_model</code></td>
<td>
<p>object of class 'inlamemi'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with a summary of the posterior marginals for the coefficients in the imputation model.
</p>

<hr>
<h2 id='get_coef_mis'>Extract coefficients for the missingness model (MIS)</h2><span id='topic+get_coef_mis'></span>

<h3>Description</h3>

<p>Extract coefficients for the missingness model (MIS)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_coef_mis(inlamemi_model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_coef_mis_+3A_inlamemi_model">inlamemi_model</code></td>
<td>
<p>object of class 'inlamemi'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with a summary of the posterior marginals for the coefficients in the missingness model.
</p>

<hr>
<h2 id='get_coef_moi'>Extract coefficients for the model of interest (MOI)</h2><span id='topic+get_coef_moi'></span>

<h3>Description</h3>

<p>Extract coefficients for the model of interest (MOI)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_coef_moi(inlamemi_model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_coef_moi_+3A_inlamemi_model">inlamemi_model</code></td>
<td>
<p>object of class 'inlamemi'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with a summary of the posterior marginals for the coefficients in the model of interest.
</p>

<hr>
<h2 id='get_imputed'>Extract imputed values</h2><span id='topic+get_imputed'></span>

<h3>Description</h3>

<p>Extract imputed values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_imputed(inlamemi_model, error_variable)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_imputed_+3A_inlamemi_model">inlamemi_model</code></td>
<td>
<p>object of class 'inlamemi'</p>
</td></tr>
<tr><td><code id="get_imputed_+3A_error_variable">error_variable</code></td>
<td>
<p>character string indicating the name of the error variable for which to extract the imputed values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two objects: the posterior marginal distributions for each element of the imputed covariate, and a data frame giving a summary of these marginals.
</p>

<hr>
<h2 id='inla_survival_families'>List the survival likelihoods in INLA</h2><span id='topic+inla_survival_families'></span>

<h3>Description</h3>

<p>List the survival likelihoods in INLA
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inla_survival_families()
</code></pre>


<h3>Value</h3>

<p>List of survival models in INLA
</p>

<hr>
<h2 id='make_inlamemi_control.family'>Make &quot;control.family&quot; argument for passing to the &quot;inla&quot; function</h2><span id='topic+make_inlamemi_control.family'></span>

<h3>Description</h3>

<p>Make &quot;control.family&quot; argument for passing to the &quot;inla&quot; function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_inlamemi_control.family(
  formula_mis = NULL,
  family_moi,
  error_type = "classical",
  prior.prec.moi = NULL,
  prior.prec.berkson = NULL,
  prior.prec.classical = NULL,
  prior.prec.imp = NULL,
  initial.prec.moi = NULL,
  initial.prec.berkson = NULL,
  initial.prec.classical = NULL,
  initial.prec.imp = NULL,
  control.family.moi = NULL,
  control.family.berkson = NULL,
  control.family.classical = NULL,
  control.family.imp = NULL,
  control.family = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_inlamemi_control.family_+3A_formula_mis">formula_mis</code></td>
<td>
<p>an object of class &quot;formula&quot;, describing the missingness model. Does not need to have a response variable, since this will always be a binary missingness indicator.</p>
</td></tr>
<tr><td><code id="make_inlamemi_control.family_+3A_family_moi">family_moi</code></td>
<td>
<p>a string indicating the likelihood family for the model of interest (the main model).</p>
</td></tr>
<tr><td><code id="make_inlamemi_control.family_+3A_error_type">error_type</code></td>
<td>
<p>type of error (one or more of &quot;classical&quot;, &quot;berkson&quot;, &quot;missing&quot;)</p>
</td></tr>
<tr><td><code id="make_inlamemi_control.family_+3A_prior.prec.moi">prior.prec.moi</code></td>
<td>
<p>a string containing the parameters for the prior for the precision of the residual term for the model of interest.</p>
</td></tr>
<tr><td><code id="make_inlamemi_control.family_+3A_prior.prec.berkson">prior.prec.berkson</code></td>
<td>
<p>a string containing the parameters for the prior for the precision of the error term for the Berkson error model.</p>
</td></tr>
<tr><td><code id="make_inlamemi_control.family_+3A_prior.prec.classical">prior.prec.classical</code></td>
<td>
<p>a string containing the parameters for the prior for the precision of the error term for the classical error model.</p>
</td></tr>
<tr><td><code id="make_inlamemi_control.family_+3A_prior.prec.imp">prior.prec.imp</code></td>
<td>
<p>a string containing the parameters for the precision of the latent variable x, which is the variable being described in the imputation model.</p>
</td></tr>
<tr><td><code id="make_inlamemi_control.family_+3A_initial.prec.moi">initial.prec.moi</code></td>
<td>
<p>the initial value for the precision of the residual term for the model of interest.</p>
</td></tr>
<tr><td><code id="make_inlamemi_control.family_+3A_initial.prec.berkson">initial.prec.berkson</code></td>
<td>
<p>the initial value for the precision of the residual term for the Berkson error term.</p>
</td></tr>
<tr><td><code id="make_inlamemi_control.family_+3A_initial.prec.classical">initial.prec.classical</code></td>
<td>
<p>the initial value for the precision of the residual term for the classical error term.</p>
</td></tr>
<tr><td><code id="make_inlamemi_control.family_+3A_initial.prec.imp">initial.prec.imp</code></td>
<td>
<p>the initial value for the precision of the residual term for the latent variable r.</p>
</td></tr>
<tr><td><code id="make_inlamemi_control.family_+3A_control.family.moi">control.family.moi</code></td>
<td>
<p>control.family component for model of interest. Can be specified here using the inla syntax instead of passing the &quot;prior.prec...&quot; and &quot;initial.prec...&quot; arguments, or in the cases when other hyperparameters are needed for the model of interest, see for instance survival models.</p>
</td></tr>
<tr><td><code id="make_inlamemi_control.family_+3A_control.family.berkson">control.family.berkson</code></td>
<td>
<p>control.family component Berkson model. Can be specified here using the inla syntax instead of passing the &quot;prior.prec...&quot; and &quot;initial.prec...&quot; arguments. Useful in the cases when more flexibility is needed, for instance if one wants to specify a different prior distribution than Gamma.</p>
</td></tr>
<tr><td><code id="make_inlamemi_control.family_+3A_control.family.classical">control.family.classical</code></td>
<td>
<p>control.family component for classical model. Can be specified here using the inla syntax instead of passing the &quot;prior.prec...&quot; and &quot;initial.prec...&quot; arguments. Useful in the cases when more flexibility is needed, for instance if one wants to specify a different prior distribution than Gamma.</p>
</td></tr>
<tr><td><code id="make_inlamemi_control.family_+3A_control.family.imp">control.family.imp</code></td>
<td>
<p>control.family component for imputation model. Can be specified here using the inla syntax instead of passing the &quot;prior.prec...&quot; and &quot;initial.prec...&quot; arguments. Useful in the cases when more flexibility is needed, for instance if one wants to specify a different prior distribution than Gamma.</p>
</td></tr>
<tr><td><code id="make_inlamemi_control.family_+3A_control.family">control.family</code></td>
<td>
<p>control.family for use in inla (can be provided directly instead of passing the &quot;prior.prec....&quot; and &quot;initial.prec...&quot; arguments. If this is specified, any other &quot;control.family...&quot; or &quot;prior.prec...&quot; arguments provided will be ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the &quot;control.family&quot; argument to be passed to inla, a list of &quot;control.family&quot; arguments for each model in the hierarchical measurement error model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
make_inlamemi_control.family(
  family_moi = "gaussian",
  error_type = c("berkson", "classical"),
  prior.prec.moi = c(10, 9),
  prior.prec.berkson = c(10, 9),
  prior.prec.classical = c(10, 9),
  prior.prec.imp = c(10, 9),
  initial.prec.moi = 1,
  initial.prec.berkson = 1,
  initial.prec.classical = 1,
  initial.prec.imp = 1)

make_inlamemi_control.family(
  family_moi = "weibull.surv",
  error_type = c("classical", "missing"),
  control.family.moi =
    list(hyper = list(alpha = list(param = 0.01,
                                   initial = log(1.4),
                                   fixed = FALSE))),
  prior.prec.classical = c(0.5, 0.5),
  prior.prec.imp = c(0.5, 0.5),
  initial.prec.classical = 2.8,
  initial.prec.imp = 1)

</code></pre>

<hr>
<h2 id='make_inlamemi_families'>Make vector of likelihood families</h2><span id='topic+make_inlamemi_families'></span>

<h3>Description</h3>

<p>Make vector of likelihood families
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_inlamemi_families(family_moi, inlamemi_stack)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_inlamemi_families_+3A_family_moi">family_moi</code></td>
<td>
<p>a string indicating the likelihood family for the model of interest (the main model).</p>
</td></tr>
<tr><td><code id="make_inlamemi_families_+3A_inlamemi_stack">inlamemi_stack</code></td>
<td>
<p>object of type inla.stack</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector specifying the likelihood family for each model level.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
simple_stack &lt;- make_inlamemi_stacks(formula_moi = y ~ x + z,
                                     formula_imp = x ~ z,
                                     data = simple_data,
                                     error_type = c("classical"))
make_inlamemi_families(family_moi = "gaussian",
                       inlamemi_stack = simple_stack)

</code></pre>

<hr>
<h2 id='make_inlamemi_formula'>Make formula for measurement error and missing data model</h2><span id='topic+make_inlamemi_formula'></span>

<h3>Description</h3>

<p>Make formula for measurement error and missing data model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_inlamemi_formula(
  formula_moi,
  formula_imp,
  formula_mis = NULL,
  family_moi = "gaussian",
  error_type = "classical",
  error_variable = NULL,
  prior.beta.error,
  prior.gamma.error = NULL,
  vars = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_inlamemi_formula_+3A_formula_moi">formula_moi</code></td>
<td>
<p>an object of class &quot;formula&quot;, describing the main model to be fitted.</p>
</td></tr>
<tr><td><code id="make_inlamemi_formula_+3A_formula_imp">formula_imp</code></td>
<td>
<p>an object of class &quot;formula&quot;, describing the imputation model for the mismeasured and/or missing observations.</p>
</td></tr>
<tr><td><code id="make_inlamemi_formula_+3A_formula_mis">formula_mis</code></td>
<td>
<p>an object of class &quot;formula&quot;, describing the missingness model. Does not need to have a response variable, since this will always be a binary missingness indicator.</p>
</td></tr>
<tr><td><code id="make_inlamemi_formula_+3A_family_moi">family_moi</code></td>
<td>
<p>a string indicating the likelihood family for the model of interest (the main model).</p>
</td></tr>
<tr><td><code id="make_inlamemi_formula_+3A_error_type">error_type</code></td>
<td>
<p>type of error (one or more of &quot;classical&quot;, &quot;berkson&quot;, &quot;missing&quot;)</p>
</td></tr>
<tr><td><code id="make_inlamemi_formula_+3A_error_variable">error_variable</code></td>
<td>
<p>character vector with the name(s) of the variable(s) with error.</p>
</td></tr>
<tr><td><code id="make_inlamemi_formula_+3A_prior.beta.error">prior.beta.error</code></td>
<td>
<p>parameters for the Gaussian prior for the coefficient of the error prone variable.</p>
</td></tr>
<tr><td><code id="make_inlamemi_formula_+3A_prior.gamma.error">prior.gamma.error</code></td>
<td>
<p>parameters for the Gaussian prior for the coefficient of the variable with missingness in the missingness model.</p>
</td></tr>
<tr><td><code id="make_inlamemi_formula_+3A_vars">vars</code></td>
<td>
<p>Results from a call to &quot;extract_variables_from_formula&quot; function. If this is not passed as an argument, it is called inside the function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;formula&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
make_inlamemi_formula(formula_moi = y ~ x + z,
                      formula_imp = x ~ z,
                      error_type = "classical",
                      prior.beta.error = c(0, 1/1000)
                      )

</code></pre>

<hr>
<h2 id='make_inlamemi_scaling_vector'>Construct scaling vector to scale the precision of correctly observed observations</h2><span id='topic+make_inlamemi_scaling_vector'></span>

<h3>Description</h3>

<p>Construct scaling vector to scale the precision of correctly observed observations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_inlamemi_scaling_vector(
  inlamemi_stack,
  error_type,
  classical_error_scaling = NULL,
  vars
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_inlamemi_scaling_vector_+3A_inlamemi_stack">inlamemi_stack</code></td>
<td>
<p>an object of class inlamemi.data.stack containing data structured</p>
</td></tr>
<tr><td><code id="make_inlamemi_scaling_vector_+3A_error_type">error_type</code></td>
<td>
<p>type of error (one or more of &quot;classical&quot;, &quot;berkson&quot;, &quot;missing&quot;)</p>
</td></tr>
<tr><td><code id="make_inlamemi_scaling_vector_+3A_classical_error_scaling">classical_error_scaling</code></td>
<td>
<p>can be specified if the classical measurement error varies across observations. Must be a vector of the same length as the data.</p>
</td></tr>
<tr><td><code id="make_inlamemi_scaling_vector_+3A_vars">vars</code></td>
<td>
<p>Results from a call to &quot;extract_variables_from_formula&quot; function. If this is not passed as an argument, it is called inside the function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector reflecting the scaling factor for the residual terms in each model level.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
stacks &lt;- make_inlamemi_stacks(data = simple_data,
                             formula_moi = y ~ x + z,
                             formula_imp = x ~ z,
                             error_type = c("classical", "berkson"))
vars &lt;- extract_variables_from_formula(formula_moi = y ~ x + z,
                                       formula_imp = x ~ z)
make_inlamemi_scaling_vector(stacks,
                           error_type = c("classical", "berkson"),
                           vars = vars)

</code></pre>

<hr>
<h2 id='make_inlamemi_stacks'>Make data stacks for joint model specification in INLA</h2><span id='topic+make_inlamemi_stacks'></span>

<h3>Description</h3>

<p>Make data stacks for joint model specification in INLA
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_inlamemi_stacks(
  formula_moi,
  formula_imp,
  formula_mis = NULL,
  family_moi = "gaussian",
  data,
  error_type = "classical",
  error_variable = NULL,
  repeated_observations = FALSE,
  vars = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_inlamemi_stacks_+3A_formula_moi">formula_moi</code></td>
<td>
<p>an object of class &quot;formula&quot;, describing the main model to be fitted.</p>
</td></tr>
<tr><td><code id="make_inlamemi_stacks_+3A_formula_imp">formula_imp</code></td>
<td>
<p>an object of class &quot;formula&quot;, describing the imputation model for the mismeasured and/or missing observations.</p>
</td></tr>
<tr><td><code id="make_inlamemi_stacks_+3A_formula_mis">formula_mis</code></td>
<td>
<p>an object of class &quot;formula&quot;, describing the missingness model. Does not need to have a response variable, since this will always be a binary missingness indicator.</p>
</td></tr>
<tr><td><code id="make_inlamemi_stacks_+3A_family_moi">family_moi</code></td>
<td>
<p>a string indicating the likelihood family for the model of interest (the main model).</p>
</td></tr>
<tr><td><code id="make_inlamemi_stacks_+3A_data">data</code></td>
<td>
<p>an object of class data.frame or list containing the variables in the model.</p>
</td></tr>
<tr><td><code id="make_inlamemi_stacks_+3A_error_type">error_type</code></td>
<td>
<p>type of error (one or more of &quot;classical&quot;, &quot;berkson&quot;, &quot;missing&quot;)</p>
</td></tr>
<tr><td><code id="make_inlamemi_stacks_+3A_error_variable">error_variable</code></td>
<td>
<p>character vector with the name(s) of the variable(s) with error.</p>
</td></tr>
<tr><td><code id="make_inlamemi_stacks_+3A_repeated_observations">repeated_observations</code></td>
<td>
<p>Does the variable with measurement error and/or missingness have repeated observations? If so, set this to &quot;TRUE&quot;. In that case, when specifying the formula, use the name of the variable without any numbers, but when specifying the data, make sure that the repeated measurements end in a number, i.e &quot;sbp1&quot; and &quot;sbp2&quot;.</p>
</td></tr>
<tr><td><code id="make_inlamemi_stacks_+3A_vars">vars</code></td>
<td>
<p>Results from a call to &quot;extract_variables_from_formula&quot; function. If this is not passed as an argument, it is called inside the function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class inla.stack with data structured according to specified formulas and error models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
make_inlamemi_stacks(formula_moi = y ~ x + z,
                   formula_imp = x ~ z,
                   data = simple_data,
                   error_type = "classical")

</code></pre>

<hr>
<h2 id='mar_data'>Simulated data with observation missing at random (MAR)</h2><span id='topic+mar_data'></span>

<h3>Description</h3>

<p>A simulated dataset to demonstrate how to set up a model in the case where there are two variables with measurement error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mar_data
</code></pre>


<h3>Format</h3>

<p>## 'mar_data'
A data frame with 1000 rows and 5 columns:
</p>

<dl>
<dt>y</dt><dd><p>Response variable</p>
</dd>
<dt>x</dt><dd><p>Observed value of covariate, with almost 20 percent missing</p>
</dd>
<dt>x_true</dt><dd><p>Correct version of x, without missingness</p>
</dd>
<dt>z1</dt><dd><p>Covariate correlated with x</p>
</dd>
<dt>z2</dt><dd><p>Covariate correlated with the missingness of x</p>
</dd>
</dl>



<h3>Source</h3>

<p>The dataset is simulated.
</p>

<hr>
<h2 id='nhanes_survival'>Survival data with repeated systolic blood pressure measurements</h2><span id='topic+nhanes_survival'></span>

<h3>Description</h3>

<p>A dataset containing a repeated blood pressure measurement along with some other variables for participants in the Third National Health and Nutrition Survey (NHANES III), merged with data from the US National Death Index by Ruth H. Keogh and Jonathan Bartlett. For the illustration purposes in this package, we have left out observations where smoking status is missing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nhanes_survival
</code></pre>


<h3>Format</h3>

<p>## 'nhanes_survival'
A data frame with 3433 rows and 8 columns:
</p>

<dl>
<dt>sbp1</dt><dd><p>systolic blood pressure (standardized), first measurement</p>
</dd>
<dt>sbp2</dt><dd><p>systolic blood pressure (standardized), second measurement</p>
</dd>
<dt>sex</dt><dd><p>sex (0 = female, 1 = male)</p>
</dd>
<dt>age</dt><dd><p>age (standardized)</p>
</dd>
<dt>smoke</dt><dd><p>smoking status (0 = no, 1 = yes)</p>
</dd>
<dt>diabetes</dt><dd><p>diabetes status (0 = no, 1 = yes)</p>
</dd>
<dt>d</dt><dd><p>censoring status (0 = censored, 1 = observed death due to cardiovascular disease)</p>
</dd>
<dt>t</dt><dd><p>time until death due to cardiovascular disease occurs</p>
</dd>
</dl>



<h3>Source</h3>

<p>https://github.com/ruthkeogh/meas_error_handbook
</p>

<hr>
<h2 id='plot.inlamemi'>Plot model summary</h2><span id='topic+plot.inlamemi'></span>

<h3>Description</h3>

<p>Plot model summary
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'inlamemi'
plot(
  x,
  plot_moi = TRUE,
  plot_imp = TRUE,
  plot_mis = TRUE,
  plot_intercepts = TRUE,
  error_variable_highlight = FALSE,
  greek = FALSE,
  palette = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.inlamemi_+3A_x">x</code></td>
<td>
<p>the model returned from the fit_inlamemi function.</p>
</td></tr>
<tr><td><code id="plot.inlamemi_+3A_plot_moi">plot_moi</code></td>
<td>
<p>should the posterior mean for the coefficients of the model of interest be plotted? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="plot.inlamemi_+3A_plot_imp">plot_imp</code></td>
<td>
<p>should the posterior mean for the coefficients of the imputation model be plotted? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="plot.inlamemi_+3A_plot_mis">plot_mis</code></td>
<td>
<p>should the posterior mean for the coefficients of the missingness model be plotted? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="plot.inlamemi_+3A_plot_intercepts">plot_intercepts</code></td>
<td>
<p>should the posterior mean for the intercept(s) be plotted? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="plot.inlamemi_+3A_error_variable_highlight">error_variable_highlight</code></td>
<td>
<p>should the coefficient(s) of the variable(s) with error be highlighted? (circled in black) Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="plot.inlamemi_+3A_greek">greek</code></td>
<td>
<p>make the coefficient names into greek letters with the covariate name as subscript. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="plot.inlamemi_+3A_palette">palette</code></td>
<td>
<p>either a number (between 1 and 5), indicating the number of the color palette to be used, or a vector of the colors to be used.</p>
</td></tr>
<tr><td><code id="plot.inlamemi_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;ggplot2&quot; that plots the posterior mean and 95 % credible interval for each coefficient in the model. The coefficients are colored to indicate if they belong to the main or imputation model, and the variable with error is also highlighted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Fit the model
simple_model &lt;- fit_inlamemi(data = simple_data,
                           formula_moi = y ~ x + z,
                           formula_imp = x ~ z,
                           family_moi = "gaussian",
                           error_type = c("berkson", "classical"),
                           prior.prec.moi = c(10, 9),
                           prior.prec.berkson = c(10, 9),
                           prior.prec.classical = c(10, 9),
                           prior.prec.imp = c(10, 9),
                           prior.beta.error = c(0, 1/1000),
                           initial.prec.moi = 1,
                           initial.prec.berkson = 1,
                           initial.prec.classical = 1,
                           initial.prec.imp = 1)

plot(simple_model)

</code></pre>

<hr>
<h2 id='print.inlamemi'>Print method for inlamemi</h2><span id='topic+print.inlamemi'></span>

<h3>Description</h3>

<p>Print method for inlamemi
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'inlamemi'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.inlamemi_+3A_x">x</code></td>
<td>
<p>object of class 'inlamemi'.</p>
</td></tr>
<tr><td><code id="print.inlamemi_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='show_data_structure'>Visualize the model data structure as matrices in LaTeX</h2><span id='topic+show_data_structure'></span>

<h3>Description</h3>

<p>Visualize the model data structure as matrices in LaTeX
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_data_structure(stack)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="show_data_structure_+3A_stack">stack</code></td>
<td>
<p>an object of class inla.stack returned from the function make_inlamemi_stacks, which describes the structure of the data for the measurement error and imputation model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing data frames with the left hand side (response_df) and right hand side (effects_df), along with the latex code needed to visualize the matrices (matrix_string).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
stack &lt;- make_inlamemi_stacks(data = simple_data,
                   formula_moi = y ~ x + z,
                   formula_imp = x ~ z,
                   error_type = "classical")
show_data_structure(stack)

</code></pre>

<hr>
<h2 id='simple_data'>Simple simulated data</h2><span id='topic+simple_data'></span>

<h3>Description</h3>

<p>A simulated dataset to demonstrate how to model different types of measurement error and missing data using the 'inlamemi' package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simple_data
</code></pre>


<h3>Format</h3>

<p>## 'simple_data'
A data frame with 1000 rows and 4 columns:
</p>

<dl>
<dt>y</dt><dd><p>Response variable</p>
</dd>
<dt>x</dt><dd><p>Covariate measured with error, both Berkson and classical error and missing observations</p>
</dd>
<dt>x_true</dt><dd><p>Correct version of the covariate with error</p>
</dd>
<dt>z</dt><dd><p>Error free covariate, correlated with x</p>
</dd>
</dl>



<h3>Source</h3>

<p>The dataset is simulated.
</p>

<hr>
<h2 id='simplify_inlamemi_model_summary'>Simplify the &quot;raw&quot; model summary for printing and plotting</h2><span id='topic+simplify_inlamemi_model_summary'></span>

<h3>Description</h3>

<p>Simplify the &quot;raw&quot; model summary for printing and plotting
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simplify_inlamemi_model_summary(inlamemi_model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simplify_inlamemi_model_summary_+3A_inlamemi_model">inlamemi_model</code></td>
<td>
<p>the model returned from the fit_inlamemi function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of four data frames, containing the summaries for different components of the model. These are the coefficients of the model of interest, the coefficient of the variable with error, the coefficients of the imputation model, and the hyperparameters.
</p>

<hr>
<h2 id='summary.inlamemi'>Summary method for inlamemi</h2><span id='topic+summary.inlamemi'></span><span id='topic+print.summary.inlamemi'></span>

<h3>Description</h3>

<p>Takes a fitted 'inlamemi' object produced by
'fit_inlamemi' and produces a summary from it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'inlamemi'
summary(object, ...)

## S3 method for class 'summary.inlamemi'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.inlamemi_+3A_object">object</code></td>
<td>
<p>model of class 'inlamemi'.</p>
</td></tr>
<tr><td><code id="summary.inlamemi_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
<tr><td><code id="summary.inlamemi_+3A_x">x</code></td>
<td>
<p>object of class summary.inlamemi.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>'summary.inlamemi' returns an object of class 'summary.inlamemi', a list of components to print.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Fit the model
simple_model &lt;- fit_inlamemi(data = simple_data,
                           formula_moi = y ~ x + z,
                           formula_imp = x ~ z,
                           family_moi = "gaussian",
                           error_type = c("berkson", "classical"),
                           prior.prec.moi = c(10, 9),
                           prior.prec.berkson = c(10, 9),
                           prior.prec.classical = c(10, 9),
                           prior.prec.imp = c(10, 9),
                           prior.beta.error = c(0, 1/1000),
                           initial.prec.moi = 1,
                           initial.prec.berkson = 1,
                           initial.prec.classical = 1,
                           initial.prec.imp = 1)

summary(simple_model)

</code></pre>

<hr>
<h2 id='two_error_data'>Simulated data with two covariates with classical measurement error</h2><span id='topic+two_error_data'></span>

<h3>Description</h3>

<p>A simulated dataset to demonstrate how to set up a model in the case where there are two variables with measurement error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>two_error_data
</code></pre>


<h3>Format</h3>

<p>## 'two_error_data'
A data frame with 1000 rows and 5 columns:
</p>

<dl>
<dt>y</dt><dd><p>Response variable</p>
</dd>
<dt>x1</dt><dd><p>Covariate measured with classical error, correlated with z</p>
</dd>
<dt>x2</dt><dd><p>Covariate measured with classical error</p>
</dd>
<dt>x1_true</dt><dd><p>Correct version of x1</p>
</dd>
<dt>x2_true</dt><dd><p>Correct version of x2</p>
</dd>
<dt>z</dt><dd><p>Error free covariate, correlated with x1</p>
</dd>
</dl>



<h3>Source</h3>

<p>The dataset is simulated.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
