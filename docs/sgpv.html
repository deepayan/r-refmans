<!DOCTYPE html><html><head><title>Help for package sgpv</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sgpv}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fdrisk'><p>False Discovery Risk for Second-Generation p-Values</p></a></li>
<li><a href='#leukstats'><p>Test Statistics from Gloub (1999) Leukemia data set</p></a></li>
<li><a href='#plotman'><p>Second-Generation p-Value Plotting</p></a></li>
<li><a href='#plotsgpower'><p>Plot power curves for Second-Generation p-Values</p></a></li>
<li><a href='#plotsgpv'><p>Second-Generation p-Value Plotting</p></a></li>
<li><a href='#sgpower'><p>Power functions for Second-Generation p-Values</p></a></li>
<li><a href='#sgpvalue'><p>Second-Generation p-Values</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Calculate Second-Generation p-Values and Associated Measures</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-11-23</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Valerie Welty &lt;valerie.welty@vanderbilt.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.3)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Description:</td>
<td>Computation of second-generation p-values as described in Blume et al. (2018) &lt;<a href="https://doi.org/10.1371%2Fjournal.pone.0188299">doi:10.1371/journal.pone.0188299</a>&gt; and Blume et al. (2019) &lt;<a href="https://doi.org/10.1080%2F00031305.2018.1537893">doi:10.1080/00031305.2018.1537893</a>&gt;. There are additional functions which provide power and type I error calculations, create graphs (particularly suited for large-scale inference usage), and a function to estimate false discovery rates based on second-generation p-value inference. </td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>false</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-11-23 19:15:55 UTC; valeriewelty</td>
</tr>
<tr>
<td>Author:</td>
<td>Valerie Welty [aut, cre],
  Rebecca Irlmeier [aut],
  Thomas Stewart [aut],
  Robert Greevy, Jr. [aut],
  Lucy D'Agostino McGowan [aut],
  Jeffrey Blume [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-11-23 21:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='fdrisk'>False Discovery Risk for Second-Generation p-Values</h2><span id='topic+fdrisk'></span>

<h3>Description</h3>

<p>This function computes the false discovery risk (sometimes called the &quot;empirical bayes FDR&quot;) for a second-generation <em>p</em>-value of 0, or the false confirmation risk for a second-generation <em>p</em>-value of 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fdrisk(
  sgpval = 0,
  null.lo,
  null.hi,
  std.err,
  interval.type,
  interval.level,
  pi0 = 0.5,
  null.weights,
  null.space,
  alt.weights,
  alt.space
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fdrisk_+3A_sgpval">sgpval</code></td>
<td>
<p>The observed second-generation <em>p</em>-value. Default is <code class="reqn">0</code>, which gives the false discovery risk.</p>
</td></tr>
<tr><td><code id="fdrisk_+3A_null.lo">null.lo</code></td>
<td>
<p>The lower bound of the indifference zone (null interval) upon which the second-generation <em>p</em>-value was based</p>
</td></tr>
<tr><td><code id="fdrisk_+3A_null.hi">null.hi</code></td>
<td>
<p>The upper bound for the indifference zone (null interval) upon which the second-generation <em>p</em>-value was based</p>
</td></tr>
<tr><td><code id="fdrisk_+3A_std.err">std.err</code></td>
<td>
<p>Standard error of the point estimate</p>
</td></tr>
<tr><td><code id="fdrisk_+3A_interval.type">interval.type</code></td>
<td>
<p>Class of interval estimate used. This determines the functional form of the power function. Options are <code>confidence</code> for a <code class="reqn">(1-\alpha)100</code>% confidence interval and <code>likelihood</code> for a <code class="reqn">1/k</code> likelihood support interval (<code>credible</code> not yet supported).</p>
</td></tr>
<tr><td><code id="fdrisk_+3A_interval.level">interval.level</code></td>
<td>
<p>Level of interval estimate. If <code>interval.type</code> is <code>confidence</code>, the level is <code class="reqn">\alpha</code>. If <code>interval.type</code> is <code>likelihood</code>, the level is <code class="reqn">1/k</code> (not <code class="reqn">k</code>).</p>
</td></tr>
<tr><td><code id="fdrisk_+3A_pi0">pi0</code></td>
<td>
<p>Prior probability of the null hypothesis. Default is <code class="reqn">0.5</code>.</p>
</td></tr>
<tr><td><code id="fdrisk_+3A_null.weights">null.weights</code></td>
<td>
<p>Probability distribution for the null parameter space. Options are currently <code>Point</code>, <code>Uniform</code>, and <code>TruncNormal</code>.</p>
</td></tr>
<tr><td><code id="fdrisk_+3A_null.space">null.space</code></td>
<td>
<p>Support of the null probability distribution. If <code>null.weights</code> is <code>Point</code>, then <code>null.space</code> is a scalar. If <code>null.weights</code> is <code>Uniform</code>, then <code>null.space</code> is a vector of length two.</p>
</td></tr>
<tr><td><code id="fdrisk_+3A_alt.weights">alt.weights</code></td>
<td>
<p>Probability distribution for the alternative parameter space. Options are currently <code>Point</code>, <code>Uniform</code>, and <code>TruncNormal</code>.</p>
</td></tr>
<tr><td><code id="fdrisk_+3A_alt.space">alt.space</code></td>
<td>
<p>Support for the alternative probability distribution. If <code>alt.weights</code> is <code>Point</code>, then <code>alt.space</code> is a scalar. If <code>alt.weights</code> is <code>Uniform</code>, then <code>alt.space</code> is a vector of length two.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When possible, one should compute the second-generation <em>p</em>-value and FDR/FCR on a scale that is symmetric about the null hypothesis. For example, if the parameter of interest is an odds ratio, inputs <code>pt.est</code>, <code>std.err</code>, <code>null.lo</code>,  <code>null.hi</code>, <code>null.space</code>, and <code>alt.space</code> are typically on the log scale.
</p>
<p>If <code>TruncNormal</code> is used for <code>null.weights</code>, then the distribution used is a truncated Normal distribution with mean equal to the midpoint of <code>null.space</code>, and standard deviation equal to <code>std.err</code>, truncated to the support of <code>null.space</code>. If <code>TruncNormal</code> is used for <code>alt.weights</code>, then the distribution used is a truncated Normal distribution with mean equal to the midpoint of <code>alt.space</code>, and standard deviation equal to <code>std.err</code>, truncated to the support of <code>alt.space</code>. Further customization of these parameters for the truncated Normal are currently not possible, although they may be implemented in future versions.
</p>


<h3>Value</h3>

<p>Numeric scalar representing the False discovery risk (FDR) or false confirmation risk (FCR) for the observed second-generation <em>p</em>-value. If <code>sgpval</code> = <code class="reqn">0</code>, the function returns false discovery risk (FDR). If <code>sgpval</code> = <code class="reqn">1</code>, the function returns false confirmation risk (FCR).
</p>


<h3>References</h3>

<p>Blume JD, Greevy RA Jr., Welty VF, Smith JR, Dupont WD (2019). An Introduction to Second-generation <em>p</em>-values. <em>The American Statistician</em>. 73:sup1, 157-167, DOI: https://doi.org/10.1080/00031305.2018.1537893
</p>
<p>Blume JD, Dâ€™Agostino McGowan L, Dupont WD, Greevy RA Jr. (2018). Second-generation <em>p</em>-values: Improved rigor, reproducibility, &amp; transparency in statistical analyses. <em>PLoS ONE</em> 13(3): e0188299. https://doi.org/10.1371/journal.pone.0188299
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sgpvalue">sgpvalue</a>, <a href="#topic+sgpower">sgpower</a>, <a href="#topic+plotsgpv">plotsgpv</a>, FDRestimation::p.fdr</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# false discovery risk with 95% confidence level
fdrisk(sgpval = 0,  null.lo = log(1/1.1), null.hi = log(1.1),  std.err = 0.8,
  null.weights = 'Uniform', null.space = c(log(1/1.1), log(1.1)),
  alt.weights = 'Uniform',  alt.space = 2 + c(-1,1)*qnorm(1-0.05/2)*0.8,
  interval.type = 'confidence',  interval.level = 0.05)

# false discovery risk with 1/8 likelihood support level
fdrisk(sgpval = 0,  null.lo = log(1/1.1), null.hi = log(1.1),  std.err = 0.8,
  null.weights = 'Point', null.space = 0,  alt.weights = 'Uniform',
  alt.space = 2 + c(-1,1)*qnorm(1-0.041/2)*0.8,
  interval.type = 'likelihood',  interval.level = 1/8)

## with truncated normal weighting distribution
fdrisk(sgpval = 0,  null.lo = log(1/1.1), null.hi = log(1.1),  std.err = 0.8,
  null.weights = 'Point', null.space = 0,  alt.weights = 'TruncNormal',
  alt.space = 2 + c(-1,1)*qnorm(1-0.041/2)*0.8,
  interval.type = 'likelihood',  interval.level = 1/8)

# false discovery risk with LSI and wider null hypothesis
fdrisk(sgpval = 0,  null.lo = log(1/1.5), null.hi = log(1.5),  std.err = 0.8,
  null.weights = 'Point', null.space = 0,  alt.weights = 'Uniform',
  alt.space = 2.5 + c(-1,1)*qnorm(1-0.041/2)*0.8,
  interval.type = 'likelihood',  interval.level = 1/8)

# false confirmation risk example
fdrisk(sgpval = 1,  null.lo = log(1/1.5), null.hi = log(1.5),  std.err = 0.15,
  null.weights = 'Uniform', null.space = 0.01 + c(-1,1)*qnorm(1-0.041/2)*0.15,
  alt.weights = 'Uniform',  alt.space = c(log(1.5), 1.25*log(1.5)),
  interval.type = 'likelihood',  interval.level = 1/8)


</code></pre>

<hr>
<h2 id='leukstats'>Test Statistics from Gloub (1999) Leukemia data set</h2><span id='topic+leukstats'></span>

<h3>Description</h3>

<p>Data are from 7218 gene specific t-tests for a difference in mean expression (on the log scale; AML versus ALL) in the Gloub data set (1999). Data are from 72 patients using a pooled t-test (df=70). Included in the dataframe are the following: t-statistic (<code>t.stat</code>), p-value (<code>p.value</code>), CI lower limit (<code>ci.lo</code>), CI upper limit (<code>ci.hi</code>), estimate (<code>estimate</code>), standard error (<code>se</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(leukstats)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code>. Includes the following: t-statistic (<code>t.stat</code>), p-value (<code>p.value</code>), CI lower limit (<code>ci.lo</code>), CI upper limit (<code>ci.hi</code>), estimate (<code>estimate</code>), standard error (<code>se</code>).
</p>


<h3>Source</h3>

<p>https://github.com/ramhiser/datamicroarray/wiki/Golub-(1999)
</p>


<h3>References</h3>

<p>Gloub (1999) and used in Blume et. al. (2018) PlosONE.
</p>
<p>Blume JD, Dâ€™Agostino McGowan L, Dupont WD, Greevy RA Jr. (2018). Second-generation <em>p</em>-values: Improved rigor, reproducibility, &amp; transparency in statistical analyses. <em>PLoS ONE</em> 13(3): e0188299. https://doi.org/10.1371/journal.pone.0188299
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(leukstats)
order(leukstats$p.value)
</code></pre>

<hr>
<h2 id='plotman'>Second-Generation p-Value Plotting</h2><span id='topic+plotman'></span>

<h3>Description</h3>

<p>This function displays a modified Manhattan-style plot colored according to second-generation p-value status. There are several variations of this plot that can be made depending upon user input for <code>type</code> as well as the <code>set.order</code> and <code>x.show</code> options. These plots allow the user to visualize the overall result of a large-scale analysis succintly and to visually assess the differences in the results using second-generation p-value techniques as opposed to classical p-value techniques.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotman(
  est.lo,
  est.hi,
  null.lo,
  null.hi,
  set.order = NA,
  x.show = NA,
  type = "delta-gap",
  p.values = NA,
  ref.lines = NA,
  null.pt = NA,
  int.col = c("cornflowerblue", "firebrick3", "darkslateblue"),
  int.pch = 16,
  int.cex = 0.4,
  title.lab = NA,
  x.lab = "Position (by set.order)",
  y.lab = "Outcome label",
  legend.on = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotman_+3A_est.lo">est.lo</code></td>
<td>
<p>A numeric vector of lower bounds of interval estimates. Must be of same length as <code>est.hi</code>.</p>
</td></tr>
<tr><td><code id="plotman_+3A_est.hi">est.hi</code></td>
<td>
<p>A numeric vector of upper bounds of interval estimates.  Must be of same length as <code>est.lo</code>.</p>
</td></tr>
<tr><td><code id="plotman_+3A_null.lo">null.lo</code></td>
<td>
<p>A scalar representing the lower bound of the null interval hypothesis (indifference zone). Value must be finite.</p>
</td></tr>
<tr><td><code id="plotman_+3A_null.hi">null.hi</code></td>
<td>
<p>A scalar representing the upper bound of the null interval hypothesis (indifference zone). Value must be finite.</p>
</td></tr>
<tr><td><code id="plotman_+3A_set.order">set.order</code></td>
<td>
<p>A numeric vector giving the desired order along the x-axis. Alternatively, if <code>set.order</code> is set to <code>"sgpv"</code>, the second-generation <em>p</em>-value ranking is used. The default option is <code>NA</code>, which uses the original input ordering.</p>
</td></tr>
<tr><td><code id="plotman_+3A_x.show">x.show</code></td>
<td>
<p>A numeric scalar representing the maximum ranking on the x-axis that is displayed. Default is to display all rankings.</p>
</td></tr>
<tr><td><code id="plotman_+3A_type">type</code></td>
<td>
<p>A string specifying the desired Manhattan-style plot to be graphed. This argument specifies the variable on the y-axis. If <code>type = "delta-gap"</code>, the delta-gaps are ranked. If <code>type = "p-value"</code>, the classic p-values are ranked. If <code>type = "comparison"</code>, the classic p-values are ranked by SGPV. Default is <code>type = "delta-gap"</code>.</p>
</td></tr>
<tr><td><code id="plotman_+3A_p.values">p.values</code></td>
<td>
<p>A numeric vector giving the classic <em>p</em>-values. This is required when <code>type = "p-value"</code> or <code>type = "comparison"</code>, and is not required when <code>type = "delta-gap"</code>. The <code>p.values</code> input may be any desired transformation of the p-values. For example, if the desired transformation is <code class="reqn">-log10(p-value)</code> as in a traditional Manhattan plot, the <code class="reqn">-log10(p-values)</code> should be provided for <code>p.values</code>. The corresponding x or y axis label(s) should be updated to reflect any transformations.</p>
</td></tr>
<tr><td><code id="plotman_+3A_ref.lines">ref.lines</code></td>
<td>
<p>A numeric scalar or vector giving the points on the y-axis at which to add a horizontal reference line. For example, if <code>p.values</code> is set to <code class="reqn">-log10(p-values)</code> and the type of plot selected shows the (transformed) p-values on the y-axis, possible locations for the reference lines could be at the <code class="reqn">-log10(0.05)</code>, <code class="reqn">-log10(Bonferroni)</code> and <code class="reqn">-log10(FDR)</code> significance levels.</p>
</td></tr>
<tr><td><code id="plotman_+3A_null.pt">null.pt</code></td>
<td>
<p>An optional numeric scalar representing a point null hypothesis. Default is <code>NA</code>.</p>
</td></tr>
<tr><td><code id="plotman_+3A_int.col">int.col</code></td>
<td>
<p>Vector of length three specifing the colors of the points according to SGPV result. The first color option corresponds to the <code class="reqn">SGPV = 0</code> results, the second color option corresponds to the <code class="reqn">0 &lt; SGPV &lt; 1</code> results, and the third color option corresponds to the <code class="reqn">SGPV = 1</code> results. Default is <code>int.col = c("cornflowerblue","firebrick3","darkslateblue")</code>.</p>
</td></tr>
<tr><td><code id="plotman_+3A_int.pch">int.pch</code></td>
<td>
<p>Plotting symbol for points. Default is <code>16</code> for small points.</p>
</td></tr>
<tr><td><code id="plotman_+3A_int.cex">int.cex</code></td>
<td>
<p>Size of plotting symbol for points. Default is <code>0.4</code>.</p>
</td></tr>
<tr><td><code id="plotman_+3A_title.lab">title.lab</code></td>
<td>
<p>Title text.</p>
</td></tr>
<tr><td><code id="plotman_+3A_x.lab">x.lab</code></td>
<td>
<p>A title for the x-axis. Default is the generic <code>"Position (by set.order)"</code>.</p>
</td></tr>
<tr><td><code id="plotman_+3A_y.lab">y.lab</code></td>
<td>
<p>A title for the y-axis. Default is the generic <code>"Outcome label"</code>.</p>
</td></tr>
<tr><td><code id="plotman_+3A_legend.on">legend.on</code></td>
<td>
<p>Toggle for plotting the legend. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use <code>set.order</code> to provide the classical p-value ranking. For example, if <code>pvalue.vector</code> is a vector of classical p-values, then set <code>set.order=order(pvalue.vector)</code> to sort the x-axis according to p-value rank.
</p>
<p>Use <code>type</code> and <code>p.values</code> to provide the <code class="reqn">-log10(p-values)</code> for the y-axis. For example, if <code>pvalue.vector</code> is a vector of classical p-values, then set <code>type="p-value"</code> (or <code>type="comparison"</code>) and <code>p.values=-log10(pvalue.vector)</code> to set the y-axis. Then, set the y-axis title to something like <code>y.lab="-log10(p)"</code>.
</p>


<h3>References</h3>

<p>Blume JD, Greevy RA Jr., Welty VF, Smith JR, Dupont WD (2019). An Introduction to Second-generation <em>p</em>-values. <em>The American Statistician</em>. 73:sup1, 157-167, DOI: https://doi.org/10.1080/00031305.2018.1537893
</p>
<p>Blume JD, Dâ€™Agostino McGowan L, Dupont WD, Greevy RA Jr. (2018). Second-generation <em>p</em>-values: Improved rigor, reproducibility, &amp; transparency in statistical analyses. <em>PLoS ONE</em> 13(3): e0188299. https://doi.org/10.1371/journal.pone.0188299
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sgpvalue">sgpvalue</a>, <a href="#topic+plotsgpv">plotsgpv</a>, <a href="#topic+sgpower">sgpower</a>, <a href="#topic+plotsgpower">plotsgpower</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

#  Use leukstats data
data(leukstats)

# ID number on the x-axis, delta-gap on the y-axis, using an interval null hypothesis of
# (-0.3, 0.3) for the log mean difference in expression levels (fold change).
plotman(est.lo=leukstats$ci.lo, est.hi=leukstats$ci.hi,
       null.lo=-0.3, null.hi=0.3,
       set.order=NA,
       type="delta-gap",
       ref.lines=NA,
       int.pch=16, int.cex=0.4,
       title.lab="Leukemia Example",
       y.lab="Delta-gap",
       x.lab="Position (ID)",
       legend.on=TRUE)

# ID number on the x-axis, -log10(classical p-value) on the y-axis, using an interval
# null hypothesis of (-0.3, 0.3) for the log mean difference in expression levels
# (fold change).
plotman(est.lo=leukstats$ci.lo, est.hi=leukstats$ci.hi,
       null.lo=-0.3, null.hi=0.3,
       set.order=NA,
       type="p-value",
       p.values=-log10(leukstats$p.value),
       ref.lines=-log10(0.05),
       int.pch=16, int.cex=0.4,
       title.lab="Leukemia Example",
       y.lab=expression("-log"[10]*"(p-value)"),
       x.lab="Position (ID)",
       legend.on=TRUE)

# Second-generation p-value (SGPV) on the x-axis, -log10(classical p-value) on the
# y-axis, using an interval null hypothesis of (-0.3, 0.3) for the log mean difference
# in expression levels (fold change).
plotman(est.lo=leukstats$ci.lo, est.hi=leukstats$ci.hi,
       null.lo=-0.3, null.hi=0.3,
       set.order="sgpv",
       type="comparison",
       p.values=-log10(leukstats$p.value),
       ref.lines=c(-log10(0.05), -log10(0.001)),
       int.pch=16, int.cex=0.4,
       title.lab="Leukemia Example",
       y.lab=expression("-log"[10]*"(p-value)"),
       x.lab="Second-generation p-value ranking",
       legend.on=TRUE)

</code></pre>

<hr>
<h2 id='plotsgpower'>Plot power curves for Second-Generation p-Values</h2><span id='topic+plotsgpower'></span>

<h3>Description</h3>

<p>This function calculates power and type I error values from significance testing based on second-generation p-values as the inferential metric and plots the power curve to visualize the operating charateristics of the inferential procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotsgpower(
  null.lo,
  null.hi,
  std.err,
  alt = NA,
  x.lim = NA,
  interval.type,
  interval.level = 0.05,
  plot.option = 1,
  null.col = rgb(208, 216, 232, maxColorValue = 255),
  pow.col = c("cornflowerblue", "firebrick3", "green4"),
  pow.lty = c(1, 1, 1),
  title.lab = "",
  x.lab = "Parameter",
  y.lab = "Probability",
  legend.on = TRUE,
  null.pt = NA,
  acc = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotsgpower_+3A_null.lo">null.lo</code></td>
<td>
<p>A scalar representing the lower bound of the null interval hypothesis (indifference zone) upon which the second-generation <em>p</em>-value is based.</p>
</td></tr>
<tr><td><code id="plotsgpower_+3A_null.hi">null.hi</code></td>
<td>
<p>A scalar representing the upper bound of the null interval hypothesis (indifference zone) upon which the second-generation <em>p</em>-value is based.</p>
</td></tr>
<tr><td><code id="plotsgpower_+3A_std.err">std.err</code></td>
<td>
<p>Standard error for the distribution of the estimator for the parameter of interest. Note that this is the standard deviation for the estimator, not the standard deviation parameter for the data itself. This will be a function of the sample size(s).</p>
</td></tr>
<tr><td><code id="plotsgpower_+3A_alt">alt</code></td>
<td>
<p>Optional scalar or vector of alternative value(s) for the parameter of interest. Default is <code>NA</code>. If provided, a blue dotted line (or one at each point) will be plotted and the power will be printed.</p>
</td></tr>
<tr><td><code id="plotsgpower_+3A_x.lim">x.lim</code></td>
<td>
<p>Optional numeric vector of length two giving the lower and upper bounds of the x-axis for the power curve. Default is <code>NA</code>, where the x-axis range will be optimized to fit the entirety of the power curve (which is dependent upon the width of the null zone and the standard error of the estimator).</p>
</td></tr>
<tr><td><code id="plotsgpower_+3A_interval.type">interval.type</code></td>
<td>
<p>Class of interval estimate used for calculating the SGPV. Options are <code>"confidence"</code> for a <code class="reqn">(1-\alpha)100</code>% confidence interval and <code>"likelihood"</code> for a <code class="reqn">1/k</code> likelihood support interval (<code>credible</code> not yet supported).</p>
</td></tr>
<tr><td><code id="plotsgpower_+3A_interval.level">interval.level</code></td>
<td>
<p>Level of interval estimate. If <code>interval.type = "confidence"</code> is used, the level is <code class="reqn">\alpha</code>. If <code>interval.type = "likelihood"</code> is used, the level is <code class="reqn">1/k</code> (not <code class="reqn">k</code>).</p>
</td></tr>
<tr><td><code id="plotsgpower_+3A_plot.option">plot.option</code></td>
<td>
<p>Used to specify the type of plot desired. If <code>plot.option = 1</code>, the classical power curve and its corresponding SGPV power curve are shown. If <code>plot.option = 2</code>, the three power curves provided by <code>sgpower</code> are shown. Default is <code>plot.option = 1</code>.</p>
</td></tr>
<tr><td><code id="plotsgpower_+3A_null.col">null.col</code></td>
<td>
<p>Coloring of shading for the null interval hypothesis (indifference zone) region. Default is Hawkes Blue: <code>null.col = rgb(208, 216, 232, maxColorValue = 255)</code>.</p>
</td></tr>
<tr><td><code id="plotsgpower_+3A_pow.col">pow.col</code></td>
<td>
<p>Vector of length three specifying the colors for the the three power curves given when <code>plot.option = 2</code>. The first color option corresponds to the <code class="reqn">Pr(SGPV = 0 | \theta)</code> line, the second color option corresponds to the <code class="reqn">Pr(0 &lt; SGPV &lt; 1 | \theta)</code> line, and the third color option corresponds to the <code class="reqn">Pr(SGPV = 1 | \theta)</code> line. Default is <code>pow.col = c("cornflowerblue", "firebrick3", "green4")</code>.</p>
</td></tr>
<tr><td><code id="plotsgpower_+3A_pow.lty">pow.lty</code></td>
<td>
<p>Vector of length three specifying the line types (<code>lty</code>) for the three power curves given when <code>plot.option = 2</code>. The first line type option corresponds to the <code class="reqn">Pr(SGPV = 0 | \theta)</code> line, the second line type option corresponds to the <code class="reqn">Pr(0 &lt; SGPV &lt; 1 | \theta)</code> line, and the third line type option corresponds to the <code class="reqn">Pr(SGPV = 1 | \theta)</code> line. Default is <code>pow.lty = c(1,1,1)</code> for solid lines.</p>
</td></tr>
<tr><td><code id="plotsgpower_+3A_title.lab">title.lab</code></td>
<td>
<p>Title text.</p>
</td></tr>
<tr><td><code id="plotsgpower_+3A_x.lab">x.lab</code></td>
<td>
<p>x-axis label.</p>
</td></tr>
<tr><td><code id="plotsgpower_+3A_y.lab">y.lab</code></td>
<td>
<p>y-axis label.</p>
</td></tr>
<tr><td><code id="plotsgpower_+3A_legend.on">legend.on</code></td>
<td>
<p>Toggle for plotting the legend. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plotsgpower_+3A_null.pt">null.pt</code></td>
<td>
<p>Optional numeric scalar representing a point null hypothesis. Default is <code>NA</code>. If a value is given, it will be plotted as a black dashed line and the type I error at that point will be printed.</p>
</td></tr>
<tr><td><code id="plotsgpower_+3A_acc">acc</code></td>
<td>
<p>Optional parameter specifying the resolution of the x-axis. Default is <code>acc = 100</code> for plotting the power curve as a sequence of 100 (x, y) points.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Blume JD, Greevy RA Jr., Welty VF, Smith JR, Dupont WD (2019). An Introduction to Second-generation <em>p</em>-values. <em>The American Statistician</em>. 73:sup1, 157-167, DOI: https://doi.org/10.1080/00031305.2018.1537893
</p>
<p>Blume JD, Dâ€™Agostino McGowan L, Dupont WD, Greevy RA Jr. (2018). Second-generation <em>p</em>-values: Improved rigor, reproducibility, &amp; transparency in statistical analyses. <em>PLoS ONE</em> 13(3): e0188299. https://doi.org/10.1371/journal.pone.0188299
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fdrisk">fdrisk</a>, <a href="#topic+sgpvalue">sgpvalue</a>, <a href="#topic+plotsgpv">plotsgpv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sigma = 5
n = 20

plotsgpower(alt = NA, null.lo = -1, null.hi = 1,
            std.err = sigma/sqrt(n), x.lim = c(-8,8),
           interval.type = 'confidence', interval.level = 0.05,
           plot.option = 2, null.pt = 0)

plotsgpower(alt = c(-4,2),
            null.lo = -1, null.hi = 1, std.err = sigma/sqrt(n),
            x.lim = NA, interval.type = 'confidence',
            interval.level = 0.05, plot.option = 2)

plotsgpower(alt = NA, null.lo = -1, null.hi = 1,
            std.err = sigma/sqrt(n), x.lim = NA,
            interval.type = 'confidence', interval.level = 0.05,
            plot.option = 1, null.pt = NA)

plotsgpower(alt = c(-4,2), null.lo = -1, null.hi = 1,
            std.err = 1, x.lim = NA, interval.type = 'likelihood',
            interval.level = 0.05, plot.option = 1, null.pt = 0)


</code></pre>

<hr>
<h2 id='plotsgpv'>Second-Generation p-Value Plotting</h2><span id='topic+plotsgpv'></span>

<h3>Description</h3>

<p>This function displays user supplied interval estimates (support intervals, confidence intervals, credible intervals, etc.) according to its associated second-generation <em>p</em>-value ranking.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotsgpv(
  est.lo,
  est.hi,
  null.lo,
  null.hi,
  set.order = "sgpv",
  x.show = NA,
  null.col = rgb(208, 216, 232, maxColorValue = 255),
  int.col = c("cornflowerblue", "firebrick3", "darkslateblue"),
  int.pch = NA,
  int.cex = 0.4,
  plot.axis = c(TRUE, TRUE),
  null.pt = NA,
  outline.zone = TRUE,
  title.lab = "Title",
  x.lab = "Position (by set.order)",
  y.lab = "Outcome label",
  legend.on = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotsgpv_+3A_est.lo">est.lo</code></td>
<td>
<p>A numeric vector of lower bounds of interval estimates. Values must be finite for interval to be drawn. Must be of same length as <code>est.hi</code>.</p>
</td></tr>
<tr><td><code id="plotsgpv_+3A_est.hi">est.hi</code></td>
<td>
<p>A numeric vector of upper bounds of interval estimates. Values must be finite for interval to be drawn. Must be of same length as <code>est.lo</code>.</p>
</td></tr>
<tr><td><code id="plotsgpv_+3A_null.lo">null.lo</code></td>
<td>
<p>A scalar representing the lower bound of null interval (indifference zone). Value must be finite.</p>
</td></tr>
<tr><td><code id="plotsgpv_+3A_null.hi">null.hi</code></td>
<td>
<p>A scalar representing the upper bound of null interval (indifference zone). Value must be finite.</p>
</td></tr>
<tr><td><code id="plotsgpv_+3A_set.order">set.order</code></td>
<td>
<p>A numeric vector giving the desired order along the x-axis. If <code>set.order</code> is set to <code>sgpv</code>, the second-generation <em>p</em>-value ranking is used. If <code>set.order</code> is set to <code>NA</code>, the original input ordering is used.</p>
</td></tr>
<tr><td><code id="plotsgpv_+3A_x.show">x.show</code></td>
<td>
<p>A scalar representing the maximum ranking on the x-axis that is displayed. Default is to display all intervals.</p>
</td></tr>
<tr><td><code id="plotsgpv_+3A_null.col">null.col</code></td>
<td>
<p>Coloring of the null interval (indifference zone). Default is Hawkes Blue: <code>rgb(208,216,232,maxColorValue=255)</code>.</p>
</td></tr>
<tr><td><code id="plotsgpv_+3A_int.col">int.col</code></td>
<td>
<p>Coloring of the intervals according to SGPV ranking. Default is <code>c("cornflowerblue","firebrick3","darkslateblue")</code> for SGPVs of <code class="reqn">0</code>, in <code class="reqn">(0,1)</code>, and <code class="reqn">1</code> respectively.</p>
</td></tr>
<tr><td><code id="plotsgpv_+3A_int.pch">int.pch</code></td>
<td>
<p>Plotting symbol for interval endpoints. Default is <code>NA</code>, no symbol. Use <code>16</code> for small endpoints.</p>
</td></tr>
<tr><td><code id="plotsgpv_+3A_int.cex">int.cex</code></td>
<td>
<p>Size of plotting symbol for interval endpoints. Default is <code class="reqn">0.4</code>.</p>
</td></tr>
<tr><td><code id="plotsgpv_+3A_plot.axis">plot.axis</code></td>
<td>
<p>Toggle for default axis plotting. Default is <code>c(TRUE,TRUE)</code> for <code class="reqn">(x-axis,y-axis)</code> respectively.</p>
</td></tr>
<tr><td><code id="plotsgpv_+3A_null.pt">null.pt</code></td>
<td>
<p>A scalar representing a point null hypothesis. Default is <code>NA</code>. If set, the function will draw a horizontal dashed black line at this location.</p>
</td></tr>
<tr><td><code id="plotsgpv_+3A_outline.zone">outline.zone</code></td>
<td>
<p>Toggle for drawing a slim white outline around the null zone. Helpful visual aid when plotting many intervals. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plotsgpv_+3A_title.lab">title.lab</code></td>
<td>
<p>Title text.</p>
</td></tr>
<tr><td><code id="plotsgpv_+3A_x.lab">x.lab</code></td>
<td>
<p>x-axis label.</p>
</td></tr>
<tr><td><code id="plotsgpv_+3A_y.lab">y.lab</code></td>
<td>
<p>y-axis label.</p>
</td></tr>
<tr><td><code id="plotsgpv_+3A_legend.on">legend.on</code></td>
<td>
<p>Toggle for plotting the legend. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use <code>set.order</code> to provide the classical p-value ranking. For example, if <code>pvalue.vector</code> is a vector of classical p-values, then set <code>set.order=order(pvalue.vector)</code> to sort the x-axis according to p-value rank.
</p>
<p>Interval estimates with infinite or undefined limits should be manually truncated or avoided altogether. While the sgpvalue funciton will handle these cases, this function assumes they have been truncated or removed because there is no standard way to plot them.
</p>


<h3>References</h3>

<p>Blume JD, Greevy RA Jr., Welty VF, Smith JR, Dupont WD (2019). An Introduction to Second-generation <em>p</em>-values. <em>The American Statistician</em>. 73:sup1, 157-167, DOI: https://doi.org/10.1080/00031305.2018.1537893
</p>
<p>Blume JD, Dâ€™Agostino McGowan L, Dupont WD, Greevy RA Jr. (2018). Second-generation <em>p</em>-values: Improved rigor, reproducibility, &amp; transparency in statistical analyses. <em>PLoS ONE</em> 13(3): e0188299. https://doi.org/10.1371/journal.pone.0188299
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sgpvalue">sgpvalue</a>, <a href="#topic+sgpower">sgpower</a>, <a href="#topic+fdrisk">fdrisk</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Use leukstats data
data(leukstats)
plotsgpv(est.lo=leukstats$ci.lo, est.hi=leukstats$ci.hi,
		null.lo=-0.3, null.hi=0.3,
		set.order=order(leukstats$p.value),
		x.show=7000,
		plot.axis=c("TRUE","FALSE"),
		null.pt=0, outline.zone=TRUE,
		title.lab="Leukemia Example", y.lab="Fold Change (base 10)",
		x.lab="Classical p-value ranking",
		legend.on=TRUE)
axis(side=2,at=round(log(c(1/1000,1/100,1/10,1/2,1,2,10,100,1000),
	base=10),2),labels=c("1/1000","1/100","1/10","1/2",1,2,10,100,1000),
	las=2)


</code></pre>

<hr>
<h2 id='sgpower'>Power functions for Second-Generation p-Values</h2><span id='topic+sgpower'></span>

<h3>Description</h3>

<p>Calculate power and type I error values from significance testing based on second-generation p-values as the inferential metric.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sgpower(true, null.lo, null.hi, std.err = 1, interval.type, interval.level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sgpower_+3A_true">true</code></td>
<td>
<p>The true value for the parameter of interest at which to calculate power. Note that this is on the absolute scale of the parameter, and not the standard deviation or standard error scale.</p>
</td></tr>
<tr><td><code id="sgpower_+3A_null.lo">null.lo</code></td>
<td>
<p>The lower bound of the indifference zone (null interval) upon which the second-generation <em>p</em>-value is based</p>
</td></tr>
<tr><td><code id="sgpower_+3A_null.hi">null.hi</code></td>
<td>
<p>The upper bound for the indifference zone (null interval) upon which the second-generation <em>p</em>-value is based</p>
</td></tr>
<tr><td><code id="sgpower_+3A_std.err">std.err</code></td>
<td>
<p>Standard error for the distribution of the estimator for the parameter of interest. Note that this is the standard deviation for the estimator, not the standard deviation parameter for the data itself. This will be a function of the sample size(s).</p>
</td></tr>
<tr><td><code id="sgpower_+3A_interval.type">interval.type</code></td>
<td>
<p>Class of interval estimate used for calculating the SGPV. Options are <code>confidence</code> for a <code class="reqn">(1-\alpha)100</code>% confidence interval and <code>likelihood</code> for a <code class="reqn">1/k</code> likelihood support interval (<code>credible</code> not yet supported)</p>
</td></tr>
<tr><td><code id="sgpower_+3A_interval.level">interval.level</code></td>
<td>
<p>Level of interval estimate. If <code>interval.type</code> is <code>confidence</code>, the level is <code class="reqn">\alpha</code>. If <code>interval.type</code> is <code>likelihood</code>, the level is <code class="reqn">1/k</code> (not <code class="reqn">k</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>

<dl>
<dt><code>power.alt</code></dt><dd><p>Probability of SGPV = 0 calculated assuming the parameter is equal to <code>true</code>. That is, <code>power.alt</code><code class="reqn"> = P(SGPV = 0 | \theta = </code> <code>true</code>).</p>
</dd>
<dt><code>power.inc</code></dt><dd><p>Probability of 0 &lt; SGPV &lt; 1 calculated assuming the parameter is equal to <code>true</code>. That is, <code>power.inc</code><code class="reqn"> = P(0 &lt; SGPV &lt; 1 | \theta = </code> <code>true</code>).</p>
</dd>
<dt><code>power.null</code></dt><dd><p>Probability of SGPV = 1 calculated assuming the parameter is equal to <code>true</code>. That is, <code>power.null</code><code class="reqn"> = P(SGPV = 1 | \theta = </code> <code>true</code>).</p>
</dd>
<dt><code>`type I error summaries`</code></dt><dd><p>Named vector that includes different ways the type I error may be summarized for an interval null hypothesis. <code>min</code> is the minimum type I error over the range (<code>null.lo</code>, <code>null.hi</code>), which occurs at the midpoint of (<code>null.lo</code>, <code>null.hi</code>). <code>max</code> is the maximum type I error over the range (<code>null.lo</code>, <code>null.hi</code>), which occurs at the boundaries of the null hypothesis, <code>null.lo</code> and <code>null.hi</code>. <code>mean</code> is the average type I error (unweighted) over the range (<code>null.lo</code>, <code>null.hi</code>). If <code class="reqn">0</code> is included in the null hypothesis region, then <code>`type I error summaries`</code> also contains <code>at 0</code>, the type I error calculated assuming the true parameter value <code class="reqn">\theta</code> is equal to <code class="reqn">0</code>.</p>
</dd>
</dl>



<h3>References</h3>

<p>Blume JD, Greevy RA Jr., Welty VF, Smith JR, Dupont WD (2019). An Introduction to Second-generation <em>p</em>-values. <em>The American Statistician</em>. 73:sup1, 157-167, DOI: https://doi.org/10.1080/00031305.2018.1537893
</p>
<p>Blume JD, Dâ€™Agostino McGowan L, Dupont WD, Greevy RA Jr. (2018). Second-generation <em>p</em>-values: Improved rigor, reproducibility, &amp; transparency in statistical analyses. <em>PLoS ONE</em> 13(3): e0188299. https://doi.org/10.1371/journal.pone.0188299
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fdrisk">fdrisk</a>, <a href="#topic+sgpvalue">sgpvalue</a>, <a href="#topic+plotsgpv">plotsgpv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sgpower(true=2, null.lo=-1, null.hi=1, std.err=1, interval.type='confidence',
 'interval.level'=0.05)

sgpower(true=0, null.lo=-1, null.hi=1, std.err=1, interval.type='confidence',
 'interval.level'=0.05)

# plot the power curve
sigma = 5
n = 20
theta = seq(-10, 10, by=0.1)
power = sgpower(true=theta, null.lo=-1, null.hi=1, std.err=sigma/sqrt(n),
 interval.type='confidence', interval.level=0.05)$power.alt
plot(theta, power, type='l', ylab='power')

</code></pre>

<hr>
<h2 id='sgpvalue'>Second-Generation p-Values</h2><span id='topic+sgpvalue'></span>

<h3>Description</h3>

<p>This function computes the second-generation <em>p</em>-value (SGPV) and its associated delta gaps, as introduced in Blume et al. (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sgpvalue(
  est.lo,
  est.hi,
  null.lo,
  null.hi,
  inf.correction = 1e-05,
  warnings = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sgpvalue_+3A_est.lo">est.lo</code></td>
<td>
<p>A numeric vector of lower bounds of interval estimates. Values may be finite or <code>-Inf</code> or <code>Inf</code>. Must be of same length as <code>est.hi</code>.</p>
</td></tr>
<tr><td><code id="sgpvalue_+3A_est.hi">est.hi</code></td>
<td>
<p>A numeric vector of upper bounds of interval estimates. Values may be finite or <code>-Inf</code> or <code>Inf</code>. Must be of same length as <code>est.lo</code>.</p>
</td></tr>
<tr><td><code id="sgpvalue_+3A_null.lo">null.lo</code></td>
<td>
<p>A numeric vector of lower bounds of null intervals. Values may be finite or <code>-Inf</code> or <code>Inf</code>. Must be of same length as <code>null.hi</code>.</p>
</td></tr>
<tr><td><code id="sgpvalue_+3A_null.hi">null.hi</code></td>
<td>
<p>A numeric vector of upper bounds of null intervals. Values may be finite or <code>-Inf</code> or <code>Inf</code>. Must be of same length as <code>null.lo</code>.</p>
</td></tr>
<tr><td><code id="sgpvalue_+3A_inf.correction">inf.correction</code></td>
<td>
<p>A small scalar to denote a positive but infinitesimally small SGPV. Default is 1e-5. SGPVs that are infinitesimally close to 1 are assigned <code>1-inf.correction</code>. This option can only be invoked when one of the intervals has infinite length.</p>
</td></tr>
<tr><td><code id="sgpvalue_+3A_warnings">warnings</code></td>
<td>
<p>Warnings toggle. Warnings are on by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Values of <code>NA</code> or <code>NaN</code> for <code>est.lo</code>, <code>est.hi</code>, <code>null.lo</code>, or <code>null.lo</code> will yield a warning and result in a SGPV of <code>NA</code> or <code>NaN</code>.
</p>
<p>When <code>null.hi</code> and <code>null.lo</code> are of length 1, the same null interval is used for every interval estimate of [<code>est.lo</code>, <code>est.hi</code>]. If <code>null.hi</code> is not of length 1, its length must match that of <code>est.hi</code>.
</p>
<p>When possible, one should compute the second-generation <em>p</em>-value on a scale that is symmetric about the null hypothesis. For example, if the parameter of interest is an odds ratio, computations are typically done on the log scale. This keeps the magnitude of positive and negative delta-gaps comparable. Also, recall that the delta-gaps magnitude is not comparable across different null intervals.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>

<dl>
<dt><code>p.delta</code></dt><dd><p>Vector of second-generation p-values</p>
</dd>
<dt><code>delta.gap</code></dt><dd><p>Vector of delta-gaps. Reported as <code>NA</code> when the corresponding second-generation p-value is not zero.</p>
</dd>
</dl>



<h3>References</h3>

<p>Blume JD, Greevy RA Jr., Welty VF, Smith JR, Dupont WD (2019). An Introduction to Second-generation <em>p</em>-values. <em>The American Statistician</em>. 73:sup1, 157-167, DOI: https://doi.org/10.1080/00031305.2018.1537893
</p>
<p>Blume JD, Dâ€™Agostino McGowan L, Dupont WD, Greevy RA Jr. (2018). Second-generation <em>p</em>-values: Improved rigor, reproducibility, &amp; transparency in statistical analyses. <em>PLoS ONE</em> 13(3): e0188299. https://doi.org/10.1371/journal.pone.0188299
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fdrisk">fdrisk</a>, <a href="#topic+sgpower">sgpower</a>, <a href="#topic+plotsgpv">plotsgpv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Simple example for three estimated log odds ratios but the same null interval
lb &lt;- c(log(1.05), log(1.3), log(0.97))
ub &lt;- c(log(1.8), log(1.8), log(1.02))
sgpv &lt;- sgpvalue(est.lo = lb, est.hi = ub, null.lo = log(1/1.1), null.hi = log(1.1))
sgpv$p.delta

sgpv$delta.gap

## Works with infinte interval bounds
sgpvalue(est.lo = log(1.3), est.hi = Inf, null.lo = -Inf, null.hi = log(1.1))


sgpvalue(est.lo = log(1.05), est.hi = Inf, null.lo = -Inf, null.hi = log(1.1))



## Example t-test with simulated data
set.seed(1776)
x1 &lt;- rnorm(15,mean=0,sd=2) ; x2 &lt;- rnorm(15,mean=3,sd=2)
ci &lt;- t.test(x1,x2)$conf.int[1:2]
sgpvalue(est.lo = ci[1], est.hi = ci[2], null.lo = -1, null.hi = 1)

set.seed(2019)
x1 &lt;- rnorm(15,mean=0,sd=2) ; x2 &lt;- rnorm(15,mean=3,sd=2)
ci &lt;- t.test(x1,x2)$conf.int[1:2]
sgpvalue(est.lo = ci[1], est.hi = ci[2], null.lo = -1, null.hi = 1)

## Simulated two-group dichotomous data for different parameters
set.seed(1492)
n1 &lt;- n2 &lt;- 30
x1 &lt;- rbinom(1,size=n1,p=0.15) ; x2 &lt;- rbinom(1,size=n2,p=0.50)

# On the difference in proportions
ci.p  &lt;- prop.test(c(x1,x2),n=c(n1,n2))$conf.int[1:2]
sgpvalue(est.lo = ci.p[1], est.hi = ci.p[2], null.lo = -0.2, null.hi = 0.2)

# On the log odds ratio scale
a &lt;- x1 ; b &lt;- x2 ; c &lt;- n1-x1 ; d &lt;- n2-x2
ci.or &lt;- log(a*d/(b*c)) + c(-1,1)*1.96*sqrt(1/a+1/b+1/c+1/d)	# Delta-method SE for log odds ratio
sgpvalue(est.lo = ci.or[1], est.hi = ci.or[2], null.lo = log(1/1.5), null.hi = log(1.5))


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
