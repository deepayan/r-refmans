<!DOCTYPE html><html><head><title>Help for package eesim</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {eesim}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#beta_bias'><p>Percent Bias of Estimated Coefficient</p></a></li>
<li><a href='#beta_var'><p>Standard Deviation of Estimated Coefficients</p></a></li>
<li><a href='#bin_t'><p>Create a binary exposure trend vector</p></a></li>
<li><a href='#binary_exposure'><p>Simulate binary exposure data</p></a></li>
<li><a href='#calc_t'><p>Create a continuous exposure trend vector</p></a></li>
<li><a href='#calendar_plot'><p>Create calendar plot</p></a></li>
<li><a href='#check_sims'><p>Assess model performance</p></a></li>
<li><a href='#continuous_exposure'><p>Simulate continuous exposure data</p></a></li>
<li><a href='#coverage_beta'><p>Empirical coverage of confidence intervals</p></a></li>
<li><a href='#coverage_plot'><p>Plot coverage of empirical confidence intervals</p></a></li>
<li><a href='#create_baseline'><p>Create a series of baseline outcomes</p></a></li>
<li><a href='#create_lambda'><p>Create a series of mean outcome values</p></a></li>
<li><a href='#create_sims'><p>Create simulated data for many repetitions</p></a></li>
<li><a href='#custom_baseline'><p>Pull smoothed Chicago NMMAPS health outcome data</p></a></li>
<li><a href='#custom_exposure'><p>Pull exposure series from data set</p></a></li>
<li><a href='#eesim'><p>Simulate data, fit models, and assess models</p></a></li>
<li><a href='#fit_mods'><p>Fit a model to simulated datasets</p></a></li>
<li><a href='#format_out'><p>Format output for custom model to use in eesim</p></a></li>
<li><a href='#mean_beta'><p>Average Estimated Coefficient</p></a></li>
<li><a href='#power_beta'><p>Estimate power</p></a></li>
<li><a href='#power_calc'><p>Power Calculations</p></a></li>
<li><a href='#sim_baseline'><p>Expected baseline health outcomes</p></a></li>
<li><a href='#sim_exposure'><p>Simulate time series of exposure values</p></a></li>
<li><a href='#sim_outcome'><p>Simulate outcome</p></a></li>
<li><a href='#spline_mod'><p>Fit a generalized linear model</p></a></li>
<li><a href='#std_exposure'><p>Simulate exposure data using default methods</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Simulate and Evaluate Time Series for Environmental Epidemiology</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-06-02</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to create simulated time series of environmental
    exposures (e.g., temperature, air pollution) and health outcomes for use in
    power analysis and simulation studies in environmental epidemiology. This
    package also provides functions to evaluate the results of simulation studies
    based on these simulated time series. This work was supported by a grant
    from the National Institute of Environmental Health Sciences (R00ES022631) and
    a fellowship from the Colorado State University Programs for Research and
    Scholarly Excellence.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://github.com/sakoehler7/eesim">http://github.com/sakoehler7/eesim</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="http://github.com/sakoehler7/eesim/issues">http://github.com/sakoehler7/eesim/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr (&ge; 0.5.0), lubridate (&ge; 1.5.6), purrr (&ge; 0.2.2),
splines, viridis (&ge; 0.4.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>dlnm (&ge; 2.3.2), ggplot2 (&ge; 2.2.1), gridExtra (&ge; 2.2.1),
knitr (&ge; 1.15.1), rmarkdown (&ge; 1.5.0), tidyr (&ge; 0.6.2)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-06-02 20:45:29 UTC; _gbanders</td>
</tr>
<tr>
<td>Author:</td>
<td>Sarah Koehler [aut],
  Brooke Anderson [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Brooke Anderson &lt;brooke.anderson@colostate.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-06-03 17:55:52 UTC</td>
</tr>
</table>
<hr>
<h2 id='beta_bias'>Percent Bias of Estimated Coefficient</h2><span id='topic+beta_bias'></span>

<h3>Description</h3>

<p>This function returns the relative bias of the mean of the estimated coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beta_bias(df, true_rr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="beta_bias_+3A_df">df</code></td>
<td>
<p>A data frame of replicated simulations which must include a column
titled &quot;Estimate&quot; with the effect estimate from the fitted model.</p>
</td></tr>
<tr><td><code id="beta_bias_+3A_true_rr">true_rr</code></td>
<td>
<p>The true relative risk used to simulate the data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function estimates the percent bias in the estimated log relative risk
(<code class="reqn">b</code>) as:
</p>
<p style="text-align: center;"><code class="reqn">100 * \frac{\beta - \hat{\beta}}{\beta}</code>
</p>

<p>where <code class="reqn">\hat{\beta}</code> is the mean of the estimated log relative risk values from all
simulations and <code class="reqn">\beta</code> is the true log relative risk used to simulate the data.
</p>


<h3>Value</h3>

<p>A data frame with a single value: the percent bias of the mean of the estimated
coefficients over <code>n_reps</code> simulations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sims &lt;- create_sims(n_reps = 10, n = 600, central = 100,
                    sd = 10, exposure_type = "continuous",
                    exposure_trend = "cos1",
                    exposure_amp = 0.6,
                    average_outcome = 20,
                    outcome_trend = "no trend",
                    rr = 1.01)
fits &lt;- fit_mods(data = sims, custom_model = spline_mod,
                 custom_model_args = list(df_year = 1))
beta_bias(fits, true_rr = 1.02)

</code></pre>

<hr>
<h2 id='beta_var'>Standard Deviation of Estimated Coefficients</h2><span id='topic+beta_var'></span>

<h3>Description</h3>

<p>Measures the variance of the point estimates of the estimated log relative risk
(<code class="reqn">\hat{beta}</code>) over the <code>n_rep</code> simulations and the mean of
the variances of each <code class="reqn">\hat{\beta}</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beta_var(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="beta_var_+3A_df">df</code></td>
<td>
<p>A data frame of replicated simulations which must include columns
titled &quot;Estimate&quot; and &quot;Std.Error&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of the variance across all values of beta hat
and the mean variance of the beta hats
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sims &lt;- create_sims(n_reps = 10, n = 600, central = 100,
                    sd = 10, exposure_type = "continuous",
                    exposure_trend = "cos1",
                    exposure_amp = 0.6,
                    average_outcome = 20,
                    outcome_trend = "no trend",
                    rr = 1.01)
fits &lt;- fit_mods(data = sims, custom_model = spline_mod,
                 custom_model_args  = list(df_year = 1))
beta_var(fits)

</code></pre>

<hr>
<h2 id='bin_t'>Create a binary exposure trend vector</h2><span id='topic+bin_t'></span>

<h3>Description</h3>

<p>Creates a trend vector for binary exposure data, centered at a probability <code>p</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bin_t(n, p, trend = "no trend", slope = 1, amp = 0.01,
  start.date = "2000-01-01", custom_func = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bin_t_+3A_n">n</code></td>
<td>
<p>A non-negative integer specifying the number of days to simulate.</p>
</td></tr>
<tr><td><code id="bin_t_+3A_p">p</code></td>
<td>
<p>A numeric value between 0 and 1 giving the mean probability of exposure
across study days.</p>
</td></tr>
<tr><td><code id="bin_t_+3A_trend">trend</code></td>
<td>
<p>A character string that gives the trend function to use. Options
are:
</p>

<ul>
<li><p>&quot;no trend&quot;: No trend, either seasonal or long-term (default).
</p>
</li>
<li><p>&quot;cos1&quot;: A seasonal trend only.
</p>
</li>
<li><p>&quot;cos2&quot;: A seasonal trend with variable amplitude across years.
</p>
</li>
<li><p>&quot;cos3&quot;: A seasonal trend with steadily decreasing amplitude over time.
</p>
</li>
<li><p>&quot;linear&quot;: A linear long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;monthly&quot;: Uses a user-specified probability of exposure for each month.
</p>
</li></ul>
</td></tr>
<tr><td><code id="bin_t_+3A_slope">slope</code></td>
<td>
<p>A numeric value specifying the slope of the trend, to be used
with <code>trend = "linear"</code> or <code>trend = "cos1linear"</code>.</p>
</td></tr>
<tr><td><code id="bin_t_+3A_amp">amp</code></td>
<td>
<p>A numeric value specifying the amplitude of the seasonal trend.
Must be between -.5 and .5.</p>
</td></tr>
<tr><td><code id="bin_t_+3A_start.date">start.date</code></td>
<td>
<p>A date of the format &quot;yyyy-mm-dd&quot; from which to begin
simulating values.</p>
</td></tr>
<tr><td><code id="bin_t_+3A_custom_func">custom_func</code></td>
<td>
<p>An R object specifying a customized function from
which to create a trend variable. Must accept arguments <code>n</code> and
<code>p</code>.</p>
</td></tr>
<tr><td><code id="bin_t_+3A_...">...</code></td>
<td>
<p>Optional arguments to a custom trend function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of daily expected probability of exposure, to be used
to generate binary exposure data with seasonal trends.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bin_t(n = 5, p = .3, trend = "cos1", amp = .3)

</code></pre>

<hr>
<h2 id='binary_exposure'>Simulate binary exposure data</h2><span id='topic+binary_exposure'></span>

<h3>Description</h3>

<p>Simulates a time series of binary exposure values with or without seasonal
trends.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binary_exposure(n, p, trend = "no trend", slope, amp = 0.05,
  start.date = "2000-01-01", cust_expdraw = NULL,
  cust_expdraw_args = list(), custom_func = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binary_exposure_+3A_n">n</code></td>
<td>
<p>A non-negative integer specifying the number of days to simulate.</p>
</td></tr>
<tr><td><code id="binary_exposure_+3A_p">p</code></td>
<td>
<p>A numeric value between 0 and 1 giving the mean probability of exposure
across study days.</p>
</td></tr>
<tr><td><code id="binary_exposure_+3A_trend">trend</code></td>
<td>
<p>A character string that gives the trend function to use. Options
are:
</p>

<ul>
<li><p>&quot;no trend&quot;: No trend, either seasonal or long-term (default).
</p>
</li>
<li><p>&quot;cos1&quot;: A seasonal trend only.
</p>
</li>
<li><p>&quot;cos2&quot;: A seasonal trend with variable amplitude across years.
</p>
</li>
<li><p>&quot;cos3&quot;: A seasonal trend with steadily decreasing amplitude over time.
</p>
</li>
<li><p>&quot;linear&quot;: A linear long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;monthly&quot;: Uses a user-specified probability of exposure for each month.
</p>
</li></ul>
</td></tr>
<tr><td><code id="binary_exposure_+3A_slope">slope</code></td>
<td>
<p>A numeric value specifying the slope of the trend, to be used
with <code>trend = "linear"</code> or <code>trend = "cos1linear"</code>.</p>
</td></tr>
<tr><td><code id="binary_exposure_+3A_amp">amp</code></td>
<td>
<p>A numeric value specifying the amplitude of the seasonal trend.
Must be between -.5 and .5.</p>
</td></tr>
<tr><td><code id="binary_exposure_+3A_start.date">start.date</code></td>
<td>
<p>A date of the format &quot;yyyy-mm-dd&quot; from which to begin
simulating daily exposures</p>
</td></tr>
<tr><td><code id="binary_exposure_+3A_cust_expdraw">cust_expdraw</code></td>
<td>
<p>An R object name specifying a user-created function
which determines the distribution of random noise off of the trend line.
This function must have inputs &quot;n&quot; and &quot;prob&quot; and output a vector of simulated
exposure values.</p>
</td></tr>
<tr><td><code id="binary_exposure_+3A_cust_expdraw_args">cust_expdraw_args</code></td>
<td>
<p>A list of arguments other than <code>n</code> required
by the <code>cust_expdraw</code> function.</p>
</td></tr>
<tr><td><code id="binary_exposure_+3A_custom_func">custom_func</code></td>
<td>
<p>An R object specifying a customized function from
which to create a trend variable. Must accept arguments <code>n</code> and
<code>p</code>.</p>
</td></tr>
<tr><td><code id="binary_exposure_+3A_...">...</code></td>
<td>
<p>Optional arguments to a custom trend function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with columns for the dates and daily exposure values for
<code>n</code> days.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>binary_exposure(n = 5, p = 0.1, trend = "cos1", amp = .02,
                start.date = "2001-02-01")
binary_exposure(n=10, p=.1, cust_expdraw=rnbinom,
                cust_expdraw_args=list(size=10))

</code></pre>

<hr>
<h2 id='calc_t'>Create a continuous exposure trend vector</h2><span id='topic+calc_t'></span>

<h3>Description</h3>

<p>Creates a trend vector for a continuous exposure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_t(n, trend = "no trend", slope = 1, amp = 0.6, custom_func = NULL,
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_t_+3A_n">n</code></td>
<td>
<p>A non-negative integer specifying the number of days to simulate.</p>
</td></tr>
<tr><td><code id="calc_t_+3A_trend">trend</code></td>
<td>
<p>A character string that specifies the desired trend function.
Options are:
</p>

<ul>
<li><p>&quot;no trend&quot;: No trend, either seasonal or long-term (default).
</p>
</li>
<li><p>&quot;cos1&quot;: A seasonal trend only.
</p>
</li>
<li><p>&quot;cos2&quot;: A seasonal trend with variable amplitude across years.
</p>
</li>
<li><p>&quot;cos3&quot;: A seasonal trend with steadily decreasing amplitude over time.
</p>
</li>
<li><p>&quot;linear&quot;: A linear long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;curvilinear&quot;: A curved long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;cos1linear&quot;: A seasonal trend plus a linear long-term trend.
</p>
</li></ul>

<p>See the package vignette for examples of the shapes of these trends.</p>
</td></tr>
<tr><td><code id="calc_t_+3A_slope">slope</code></td>
<td>
<p>A numeric value specifying the slope of the trend, to be used
with <code>trend = "linear"</code> or <code>trend = "cos1linear"</code>.</p>
</td></tr>
<tr><td><code id="calc_t_+3A_amp">amp</code></td>
<td>
<p>A numeric value specifying the amplitude of the seasonal trend.
Must be between -1 and 1.</p>
</td></tr>
<tr><td><code id="calc_t_+3A_custom_func">custom_func</code></td>
<td>
<p>An R object specifying a customized function from
which to create a trend variable. Must accept the arguments <code>n</code>
and <code>mean</code>.</p>
</td></tr>
<tr><td><code id="calc_t_+3A_...">...</code></td>
<td>
<p>Optional arguments to a custom trend function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of simulated exposure values for each study day, to be
used to generate data with seasonal trends.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>calc_t(5, "cos3", amp = .5)

</code></pre>

<hr>
<h2 id='calendar_plot'>Create calendar plot</h2><span id='topic+calendar_plot'></span>

<h3>Description</h3>

<p>Creates a calendar plot of a time series of continuous or discrete data. The time series
data frame input to this function must have only two columns, one for the date and one with
the values to plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calendar_plot(df, type = "continuous", labels = NULL,
  legend_name = "Exposure")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calendar_plot_+3A_df">df</code></td>
<td>
<p>Data frame with one column named <code>date</code> for date with entries in the format
&quot;yyyy-mm-dd&quot; and one column for the daily values of the variable to plot.</p>
</td></tr>
<tr><td><code id="calendar_plot_+3A_type">type</code></td>
<td>
<p>Character string specifying whether the exposure is continuous or
discrete</p>
</td></tr>
<tr><td><code id="calendar_plot_+3A_labels">labels</code></td>
<td>
<p>Vector of character strings naming the levels of a discrete
variable to be used in the figure legend.</p>
</td></tr>
<tr><td><code id="calendar_plot_+3A_legend_name">legend_name</code></td>
<td>
<p>Character string specifying the title to be used in the figure
legend.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output of this function is a <code>ggplot</code> object, so you can customize
this output object as with any <code>ggplot</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>testdat &lt;- sim_exposure(n = 1000, central = 0.1,
           exposure_type = "binary")
testdat$x[c(89,101,367,500,502,598,678,700,895)] &lt;- 3
calendar_plot(testdat, type = "discrete", labels = c("no", "yes", "maybe"))

</code></pre>

<hr>
<h2 id='check_sims'>Assess model performance</h2><span id='topic+check_sims'></span>

<h3>Description</h3>

<p>Calculates several measures of model performance, based on results of fitting
a model to all simulated datasets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_sims(df, true_rr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_sims_+3A_df">df</code></td>
<td>
<p>A data frame of replicated simulations which must include a column
titled &quot;Estimate&quot; with the effect estimate from the fitted model.</p>
</td></tr>
<tr><td><code id="check_sims_+3A_true_rr">true_rr</code></td>
<td>
<p>The true relative risk used to simulate the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with one row with model assessment across all simulations.
Includes values for:
</p>

<ul>
<li><p><code>beta_hat</code>: Mean of the estimated log relative risk across all simulations.
</p>
</li>
<li><p><code>rr_hat</code>: Mean value of the estimated relative risk across all simulations.
</p>
</li>
<li><p><code>var_across_betas</code>: Variance of the estimated log relative risk across all
simulations
</p>
</li>
<li><p><code>mean_beta_var</code>: The mean of the estimated variances of the estimated log
relative risks across all simulations.
</p>
</li>
<li><p><code>percent_bias</code>: The relative bias of the estimated log relative risks compared
to the true log relative risk.
</p>
</li>
<li><p><code>coverage</code>: Percent of simulations for which the estimated 95% confidence
interval for log relative risk includes the true log relative risk.
</p>
</li>
<li><p><code>power</code>: Percent of simulations for which the null hypothesis that the log
relative risk equals zero is rejected based on a p-value of 0.05.
</p>
</li></ul>



<h3>See Also</h3>

<p>The following functions are used to calculate these measurements:
<code><a href="#topic+beta_bias">beta_bias</a></code>, <code><a href="#topic+beta_var">beta_var</a></code>, <code><a href="#topic+coverage_beta">coverage_beta</a></code>,
<code><a href="#topic+mean_beta">mean_beta</a></code>, <code><a href="#topic+power_beta">power_beta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sims &lt;- create_sims(n_reps = 100, n = 1000, central = 100,
                    sd = 10, exposure_type = "continuous",
                    exposure_trend = "cos1",
                    exposure_amp = 0.6,
                    average_outcome = 20,
                    outcome_trend = "no trend",
                    rr = 1.02)
fits &lt;- fit_mods(data = sims, custom_model = spline_mod,
                 custom_model_args = list(df_year = 1))
check_sims(df = fits, true_rr = 1.02)

</code></pre>

<hr>
<h2 id='continuous_exposure'>Simulate continuous exposure data</h2><span id='topic+continuous_exposure'></span>

<h3>Description</h3>

<p>Simulates a time series of continuous exposure values with or without a
seasonal and / or long-term trend.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>continuous_exposure(n, mu, sd = 1, trend = "no trend", slope, amp = 0.6,
  cust_expdraw = NULL, cust_expdraw_args = list(),
  start.date = "2000-01-01", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="continuous_exposure_+3A_n">n</code></td>
<td>
<p>A non-negative integer specifying the number of days to simulate.</p>
</td></tr>
<tr><td><code id="continuous_exposure_+3A_mu">mu</code></td>
<td>
<p>A numeric value giving the mean exposure across all study days.</p>
</td></tr>
<tr><td><code id="continuous_exposure_+3A_sd">sd</code></td>
<td>
<p>A numeric value giving the standard deviation of the exposure
values from the exposure trend line.</p>
</td></tr>
<tr><td><code id="continuous_exposure_+3A_trend">trend</code></td>
<td>
<p>A character string that specifies the desired trend function.
Options are:
</p>

<ul>
<li><p>&quot;no trend&quot;: No trend, either seasonal or long-term (default).
</p>
</li>
<li><p>&quot;cos1&quot;: A seasonal trend only.
</p>
</li>
<li><p>&quot;cos2&quot;: A seasonal trend with variable amplitude across years.
</p>
</li>
<li><p>&quot;cos3&quot;: A seasonal trend with steadily decreasing amplitude over time.
</p>
</li>
<li><p>&quot;linear&quot;: A linear long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;curvilinear&quot;: A curved long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;cos1linear&quot;: A seasonal trend plus a linear long-term trend.
</p>
</li></ul>

<p>See the package vignette for examples of the shapes of these trends.</p>
</td></tr>
<tr><td><code id="continuous_exposure_+3A_slope">slope</code></td>
<td>
<p>A numeric value specifying the slope of the trend, to be used
with <code>trend = "linear"</code> or <code>trend = "cos1linear"</code>.</p>
</td></tr>
<tr><td><code id="continuous_exposure_+3A_amp">amp</code></td>
<td>
<p>A numeric value specifying the amplitude of the seasonal trend.
Must be between -1 and 1.</p>
</td></tr>
<tr><td><code id="continuous_exposure_+3A_cust_expdraw">cust_expdraw</code></td>
<td>
<p>A character string specifying a user-created function
which determines the distribution of random noise off of the trend line.
This function must have inputs &quot;n&quot; and &quot;mean&quot; and output a vector of simulated
exposure values.</p>
</td></tr>
<tr><td><code id="continuous_exposure_+3A_cust_expdraw_args">cust_expdraw_args</code></td>
<td>
<p>A list of arguments other than &quot;n&quot; and &quot;mean&quot; required
by the cust_expdraw function.</p>
</td></tr>
<tr><td><code id="continuous_exposure_+3A_start.date">start.date</code></td>
<td>
<p>A date of the format &quot;yyyy-mm-dd&quot; from which to begin
simulating daily exposures</p>
</td></tr>
<tr><td><code id="continuous_exposure_+3A_...">...</code></td>
<td>
<p>Optional arguments to a custom trend function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the dates and simulated daily exposure values from <code>n</code> days.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>continuous_exposure(n = 5, mu = 100, sd = 10, trend = "cos1")
continuous_exposure(n=10, mu=3, trend="linear", slope = 2,
                    cust_expdraw=rnorm, cust_expdraw_args = list(sd=.5))

</code></pre>

<hr>
<h2 id='coverage_beta'>Empirical coverage of confidence intervals</h2><span id='topic+coverage_beta'></span>

<h3>Description</h3>

<p>Calculates the percent of simulations in which the estimated 95% confidence
interval for the log relative risk includes the true value of the log
relative risk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coverage_beta(df, true_rr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coverage_beta_+3A_df">df</code></td>
<td>
<p>A data frame of replicated simulations which must include columns
titled <code>lower_ci</code> and <code>upper_ci</code>.</p>
</td></tr>
<tr><td><code id="coverage_beta_+3A_true_rr">true_rr</code></td>
<td>
<p>The true relative risk used to simulate the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the percent of confidence intervals for the
estimated log relative risk over <code>n_reps</code> simulations which include
the true log relative risk.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sims &lt;- create_sims(n_reps = 10, n = 600, central = 100,
                    sd = 10, exposure_type = "continuous",
                    exposure_trend = "cos1", exposure_slope=1,
                    exposure_amp = 0.6,
                    average_outcome = 20,
                    outcome_trend = "no trend",
                    rr = 1.01)
fits &lt;- fit_mods(data = sims, custom_model = spline_mod,
                 custom_model_args = list(df_year = 1))
coverage_beta(df=fits, true_rr = 1.02)

</code></pre>

<hr>
<h2 id='coverage_plot'>Plot coverage of empirical confidence intervals</h2><span id='topic+coverage_plot'></span>

<h3>Description</h3>

<p>Plots the relative risk point estimates and their confidence
intervals for model fit results for each simulation, compared to the true
relative risk. This gives a visualization of the coverage of the specified
method for the relative risk. The confidence intervals which do not contain
the true relative risk appear in red. The input to this function should be
either the output of <code><a href="#topic+fit_mods">fit_mods</a></code> or the second element of the
output of <code><a href="#topic+eesim">eesim</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coverage_plot(summarystats, true_param)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coverage_plot_+3A_summarystats">summarystats</code></td>
<td>
<p>A list or data frame of summary statistics from many
repetitions of a simulation.  Must include columns titled <code>Estimate</code>,
<code>lower_ci</code>, and <code>upper_ci</code>. This could be the second object from the output of
<code><a href="#topic+eesim">eesim</a></code>, specified by using the format <code>eesim_output[[2]]</code>.</p>
</td></tr>
<tr><td><code id="coverage_plot_+3A_true_param">true_param</code></td>
<td>
<p>The true value of the relative risk used to simulate the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot displaying the coverage for the true value of the parameter by
the confidence intervals resulting from each repetition of the simulation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ex_sim &lt;- eesim(n_reps = 100, n = 1000, central = 100, sd = 10,
          exposure_type = "continuous", average_outcome = 20, rr = 1.02,
          custom_model = spline_mod, custom_model_args = list(df_year = 1))
coverage_plot(ex_sim[[2]], true_param = 1.02)

</code></pre>

<hr>
<h2 id='create_baseline'>Create a series of baseline outcomes</h2><span id='topic+create_baseline'></span>

<h3>Description</h3>

<p>Creates a time series of baseline outcome values. This function allows the
user to input a custom function if desired to specify outcome trend.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_baseline(n, average_baseline = NULL, trend = "no trend", slope = 1,
  amp = 0.6, cust_base_func = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_baseline_+3A_n">n</code></td>
<td>
<p>A numeric value specifying the number of days for which to simulate
data</p>
</td></tr>
<tr><td><code id="create_baseline_+3A_average_baseline">average_baseline</code></td>
<td>
<p>A non-negative numeric value specifying the average outcome
value over all simulated days.</p>
</td></tr>
<tr><td><code id="create_baseline_+3A_trend">trend</code></td>
<td>
<p>A character string that specifies the desired trend function.
Options are:
</p>

<ul>
<li><p>&quot;no trend&quot;: No trend, either seasonal or long-term (default).
</p>
</li>
<li><p>&quot;cos1&quot;: A seasonal trend only.
</p>
</li>
<li><p>&quot;cos2&quot;: A seasonal trend with variable amplitude across years.
</p>
</li>
<li><p>&quot;cos3&quot;: A seasonal trend with steadily decreasing amplitude over time.
</p>
</li>
<li><p>&quot;linear&quot;: A linear long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;curvilinear&quot;: A curved long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;cos1linear&quot;: A seasonal trend plus a linear long-term trend.
</p>
</li></ul>

<p>See the package vignette for examples of the shapes of these trends.</p>
</td></tr>
<tr><td><code id="create_baseline_+3A_slope">slope</code></td>
<td>
<p>A numeric value specifying the slope of the trend, to be used
with <code>trend = "linear"</code> or <code>trend = "cos1linear"</code>.</p>
</td></tr>
<tr><td><code id="create_baseline_+3A_amp">amp</code></td>
<td>
<p>A numeric value specifying the amplitude of the seasonal trend.
Must be between -1 and 1.</p>
</td></tr>
<tr><td><code id="create_baseline_+3A_cust_base_func">cust_base_func</code></td>
<td>
<p>A R object name specifying a user-made custom
function for baseline trend.</p>
</td></tr>
<tr><td><code id="create_baseline_+3A_...">...</code></td>
<td>
<p>Optional arguments to a custom baseline function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of baseline outcome values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>create_baseline(n = 5, average_baseline = 22, trend = "linear")

</code></pre>

<hr>
<h2 id='create_lambda'>Create a series of mean outcome values</h2><span id='topic+create_lambda'></span>

<h3>Description</h3>

<p>Creates a vector of expected daily outcome count by relating exposure to baseline
outcome values with the function:
</p>
<p style="text-align: center;"><code class="reqn">log(\lambda_t) = log(B_t) + log(RR)*X_t</code>
</p>

<p>where <code class="reqn">\lambda_t</code> is the expected outcome count on day <code class="reqn">t</code>,
<code class="reqn">B</code> is the expected base outcome count on day <code class="reqn">t</code> (incorporating long-term
and seasonal trends, but not the influence of the exposure), <code class="reqn">RR</code> is the relative
risk of the outcome for a one-unit increase in exposure, and <code class="reqn">X_t</code> is the
simulated exposure on day <code class="reqn">t</code>.
The user may input a custom function to relate exposure, relative risk, and
baseline.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_lambda(baseline, exposure, rr, cust_lambda_func = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_lambda_+3A_baseline">baseline</code></td>
<td>
<p>A non-negative numeric vector of baseline outcome values,
typically the output of <code><a href="#topic+create_baseline">create_baseline</a></code>.</p>
</td></tr>
<tr><td><code id="create_lambda_+3A_exposure">exposure</code></td>
<td>
<p>A numeric vector of exposure values, typically the output
of <code><a href="#topic+sim_exposure">sim_exposure</a></code>.</p>
</td></tr>
<tr><td><code id="create_lambda_+3A_rr">rr</code></td>
<td>
<p>A non-negative numeric value specifying the relative risk (i.e., the
relative risk per unit increase in the exposure).</p>
</td></tr>
<tr><td><code id="create_lambda_+3A_cust_lambda_func">cust_lambda_func</code></td>
<td>
<p>An R object name specifying a user-made custom
function for relating baseline, relative risk, and exposure</p>
</td></tr>
<tr><td><code id="create_lambda_+3A_...">...</code></td>
<td>
<p>Optional arguments for a custom lambda function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of mean outcome values for each day in the simulation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>base &lt;- create_baseline(n = 10, average_baseline = 22, trend = "linear",
                        slope = .4)
exp &lt;- sim_exposure(n = 5, central = 100, sd = 10, amp = .6,
                    exposure_type = "continuous")
create_lambda(baseline = base, exposure = exp$x, rr = 1.01)

</code></pre>

<hr>
<h2 id='create_sims'>Create simulated data for many repetitions</h2><span id='topic+create_sims'></span>

<h3>Description</h3>

<p>Creates a collection of synthetic datasets that follow a set of user-specified
conditions (e.g., exposure mean and variance, average daily outcome count,
long-term and seasonal trends in exposure and outcome, association between exposure
and outcome). These synthetic datasets can be used to investigate performance of a specific
model or to estimate power or required sample size for a hypothetical study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_sims(n_reps, n, rr, central, average_outcome, sd = NULL, exposure_type,
  exposure_trend, exposure_slope = 1, exposure_amp = NULL,
  outcome_trend = NULL, outcome_slope = 1, outcome_amp = NULL,
  start.date = "2000-01-01", cust_exp_func = NULL, cust_exp_args = NULL,
  cust_expdraw = NULL, cust_expdraw_args = NULL, cust_base_func = NULL,
  cust_lambda_func = NULL, cust_base_args = NULL, cust_lambda_args = NULL,
  cust_outdraw = NULL, cust_outdraw_args = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_sims_+3A_n_reps">n_reps</code></td>
<td>
<p>An integer specifying the number of datasets to simulate (e.g.,
<code>n_reps = 1000</code> would simulate one thousand time series datasets with the
specified characteristics, which can be used for a power analysis or to investigate
the performance of a proposed model).</p>
</td></tr>
<tr><td><code id="create_sims_+3A_n">n</code></td>
<td>
<p>An integer specifying the number of days to simulate (e.g., <code>n = 365</code>
would simulate a dataset with a year's worth of data).</p>
</td></tr>
<tr><td><code id="create_sims_+3A_rr">rr</code></td>
<td>
<p>A non-negative numeric value specifying the relative risk (i.e., the
relative risk per unit increase in the exposure).</p>
</td></tr>
<tr><td><code id="create_sims_+3A_central">central</code></td>
<td>
<p>A numeric value specifying the mean probability of exposure
(for binary data) or the mean exposure value (for continuous data).</p>
</td></tr>
<tr><td><code id="create_sims_+3A_average_outcome">average_outcome</code></td>
<td>
<p>A non-negative numeric value specifying the average
daily outcome count.</p>
</td></tr>
<tr><td><code id="create_sims_+3A_sd">sd</code></td>
<td>
<p>A non-negative numeric value giving the standard deviation of the exposure
values from the exposure trend line (not the total standard deviation of
the exposure values).</p>
</td></tr>
<tr><td><code id="create_sims_+3A_exposure_type">exposure_type</code></td>
<td>
<p>A character string specifying the type of exposure.
Choices are &quot;binary&quot; or &quot;continuous&quot;.</p>
</td></tr>
<tr><td><code id="create_sims_+3A_exposure_trend">exposure_trend</code></td>
<td>
<p>A character string specifying a seasonal and / or long-term trend for
expected mean exposure. See the vignette for <code>eesim</code> for examples of each option.
The shapes are based on those used in Bateson and Schwartz (1999).
For trends with a seasonal component, the amplitude of the seasonal trend can be
customized using the <code>exposure\_amp</code> argument. For trends with a long-term
pattern, the slope of the long-term trend can be set using the <code>exposure\_slope</code>
argument.
If using the &quot;monthly&quot; option for a binary exposure, you must input a numeric
vector of length 12 for the <code>central</code> argument that gives the probability of
exposure for each month, starting in January and ending in December.
Options for continuous exposure are:
</p>

<ul>
<li><p>&quot;no trend&quot;: No trend, either seasonal or long-term (default).
</p>
</li>
<li><p>&quot;cos1&quot;: A seasonal trend only.
</p>
</li>
<li><p>&quot;cos2&quot;: A seasonal trend with variable amplitude across years.
</p>
</li>
<li><p>&quot;cos3&quot;: A seasonal trend with steadily decreasing amplitude over time.
</p>
</li>
<li><p>&quot;linear&quot;: A linear long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;curvilinear&quot;: A curved long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;cos1linear&quot;: A seasonal trend plus a linear long-term trend.
</p>
</li></ul>

<p>Options for binary exposure are:
</p>

<ul>
<li><p>&quot;no trend&quot;: No trend, either seasonal or long-term (default).
</p>
</li>
<li><p>&quot;cos1&quot;: A seasonal trend only.
</p>
</li>
<li><p>&quot;cos2&quot;: A seasonal trend with variable amplitude across years.
</p>
</li>
<li><p>&quot;cos3&quot;: A seasonal trend with steadily decreasing amplitude over time.
</p>
</li>
<li><p>&quot;linear&quot;: A linear long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;monthly&quot;: Uses a user-specified probability of exposure for each month.
</p>
</li></ul>
</td></tr>
<tr><td><code id="create_sims_+3A_exposure_slope">exposure_slope</code></td>
<td>
<p>A numeric value specifying the linear slope of the
exposure, to be used with <code>exposure_trend = "linear"</code> or
<code>exposure_trend = "cos1linear"</code>.
The default value is 1. Positive values will generate data with an
increasing expected value over the years while negative values will
generate data with decreasing expected value over the years.</p>
</td></tr>
<tr><td><code id="create_sims_+3A_exposure_amp">exposure_amp</code></td>
<td>
<p>A numeric value specifying the amplitude of the exposure
trend. Must be between -1 and 1 for continuous exposure or between -0.5
and 0.5 for binary exposure. Positive values will simulate a pattern
with higher values at the time of the year of the start of the dataset
(typically January) and lowest values six months following that (typically
July). Negative values can be used to simulate a trend with lower values
at the time of year of the start of the dataset and higher values in the
opposite season.</p>
</td></tr>
<tr><td><code id="create_sims_+3A_outcome_trend">outcome_trend</code></td>
<td>
<p>A character string specifying the seasonal trend in
health outcomes.  Options are the same as for continuous exposure
data.</p>
</td></tr>
<tr><td><code id="create_sims_+3A_outcome_slope">outcome_slope</code></td>
<td>
<p>A numeric value specifying the linear slope of the
outcome trend, to be used with <code>outcome_trend = "linear"</code> or
<code>outcome_trend = "cos1linear"</code>. The default value is 1.
Positive values will generate data with an
increasing expected value over the years while negative values will
generate data with decreasing expected value over the years.</p>
</td></tr>
<tr><td><code id="create_sims_+3A_outcome_amp">outcome_amp</code></td>
<td>
<p>A numeric value specifying the amplitude of the outcome
trend.  Must be between -1 and 1.</p>
</td></tr>
<tr><td><code id="create_sims_+3A_start.date">start.date</code></td>
<td>
<p>A date of the format &quot;yyyy-mm-dd&quot; from which to begin
simulating daily exposures</p>
</td></tr>
<tr><td><code id="create_sims_+3A_cust_exp_func">cust_exp_func</code></td>
<td>
<p>An R object name specifying the name of a custom
trend function to generate exposure data</p>
</td></tr>
<tr><td><code id="create_sims_+3A_cust_exp_args">cust_exp_args</code></td>
<td>
<p>A list of arguments and their values for the
user-specified custom exposure function.</p>
</td></tr>
<tr><td><code id="create_sims_+3A_cust_expdraw">cust_expdraw</code></td>
<td>
<p>An R object specifying a user-created function
which determines the distribution of random noise off of the trend line.
This function must have inputs <code>n</code> and <code>prob</code> for a binary exposure
function and inputs <code>n</code> and <code>mean</code> for a continuous exposure function.
The custom function must output a vector of simulated exposure values.</p>
</td></tr>
<tr><td><code id="create_sims_+3A_cust_expdraw_args">cust_expdraw_args</code></td>
<td>
<p>A list of arguments other than <code>n</code> required by the
<code>cust_expdraw</code> function.</p>
</td></tr>
<tr><td><code id="create_sims_+3A_cust_base_func">cust_base_func</code></td>
<td>
<p>A R object name specifying a user-made custom
function for baseline trend.</p>
</td></tr>
<tr><td><code id="create_sims_+3A_cust_lambda_func">cust_lambda_func</code></td>
<td>
<p>An R object name specifying a user-made custom
function for relating baseline, relative risk, and exposure</p>
</td></tr>
<tr><td><code id="create_sims_+3A_cust_base_args">cust_base_args</code></td>
<td>
<p>A list of arguments and their values used in the
user-specified custom baseline function</p>
</td></tr>
<tr><td><code id="create_sims_+3A_cust_lambda_args">cust_lambda_args</code></td>
<td>
<p>A list of arguments and their values used in the
user-specified custom lambda function</p>
</td></tr>
<tr><td><code id="create_sims_+3A_cust_outdraw">cust_outdraw</code></td>
<td>
<p>An R object name specifying a user-created function to
randomize the outcome values off of the baseline for outcome values. This
function must take inputs <code>n</code> and <code>lambda</code> and output a vector of outcome
values.</p>
</td></tr>
<tr><td><code id="create_sims_+3A_cust_outdraw_args">cust_outdraw_args</code></td>
<td>
<p>A list of arguments besides <code>n</code> passed
to the user-created custom outcome draw function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object of length <code>n_rep</code>, in which each list element is one of the
synthetic datasets simulated under the input conditions. Each synthetic dataset includes
columns for for date (<code>date</code>), daily exposure (<code>x</code>), and daily outcome count
(<code>outcome</code>).
</p>


<h3>References</h3>

<p>Bateson TF, Schwartz J. 1999. Control for seasonal variation and time trend in
case-crossover studies of acute effects of environmental exposures. Epidemiology
10(4):539-544.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>create_sims(n_reps=3, n=100, central = 100, sd = 10,
            exposure_type="continuous", exposure_trend = "cos1",
            exposure_amp = .6, average_outcome = 22,
            outcome_trend = "no trend", outcome_amp = .6, rr = 1.01)

</code></pre>

<hr>
<h2 id='custom_baseline'>Pull smoothed Chicago NMMAPS health outcome data</h2><span id='topic+custom_baseline'></span>

<h3>Description</h3>

<p>Example of a custom baseline function that can be passed to <code><a href="#topic+eesim">eesim</a></code> or
<code><a href="#topic+power_calc">power_calc</a></code>.
By default, this function pulls smoothed data from the <code>chicagoNMMAPS</code> data set
in the <code>dlnm</code> package.  The user may also input a different data set from which
to pull data. The function uses a smoothed function of this observed data as the
underlying baseline outcome trend in simulating data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>custom_baseline(n, df = dlnm::chicagoNMMAPS, outcome_type = "cvd",
  start.date = "2000-01-01")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="custom_baseline_+3A_n">n</code></td>
<td>
<p>A numeric value specifying the number of days for which to obtain an
exposure value.</p>
</td></tr>
<tr><td><code id="custom_baseline_+3A_df">df</code></td>
<td>
<p>Data frame from which to pull exposure values.</p>
</td></tr>
<tr><td><code id="custom_baseline_+3A_outcome_type">outcome_type</code></td>
<td>
<p>A character string specifying the desired health outcome metric.
Options are:
</p>

<ul>
<li><p>&quot;death&quot;
</p>
</li>
<li><p>&quot;cvd&quot;
</p>
</li>
<li><p>&quot;resp&quot;</p>
</li></ul>

<p>(Note: These are the column names for outcome counts in the observed data.)</p>
</td></tr>
<tr><td><code id="custom_baseline_+3A_start.date">start.date</code></td>
<td>
<p>A date of the format &quot;yyyy-mm-dd&quot; from which to begin
pulling exposure values. Dates in the Chicago NMMAPS data set are from
1987-01-01 to 2000-12-31.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with one column for date and one column for baseline
outcome values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>custom_baseline(n = 5)
custom_baseline(n = 5, outcome_type = "death")

</code></pre>

<hr>
<h2 id='custom_exposure'>Pull exposure series from data set</h2><span id='topic+custom_exposure'></span>

<h3>Description</h3>

<p>Example of a custom exposure function that can be passed to <code><a href="#topic+eesim">eesim</a></code> or
<code><a href="#topic+power_calc">power_calc</a></code>.
By default, this function pulls exposure data from the Chicago NMMAPS data
set in the dlnm package.  The user may specify a different data set from
which to pull exposure values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>custom_exposure(n, df = dlnm::chicagoNMMAPS, metric = "temp",
  start.date = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="custom_exposure_+3A_n">n</code></td>
<td>
<p>A numeric value specifying the number of days for which to obtain an
exposure value.</p>
</td></tr>
<tr><td><code id="custom_exposure_+3A_df">df</code></td>
<td>
<p>Data frame from which to pull exposure values.</p>
</td></tr>
<tr><td><code id="custom_exposure_+3A_metric">metric</code></td>
<td>
<p>A character string specifying the desired exposure metric.
Options are:
</p>

<ul>
<li><p>&quot;temp&quot;
</p>
</li>
<li><p>&quot;dptp&quot;
</p>
</li>
<li><p>&quot;rhum&quot;
</p>
</li>
<li><p>&quot;pm10&quot;
</p>
</li>
<li><p>&quot;o3&quot;</p>
</li></ul>

<p>(Note: These are the column names for exposure measurements in the observed data.)</p>
</td></tr>
<tr><td><code id="custom_exposure_+3A_start.date">start.date</code></td>
<td>
<p>A date of the format &quot;yyyy-mm-dd&quot; from which to begin
pulling exposure values. Dates in the Chicago NMMAPS data set are from
1987-01-01 to 2000-12-31.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of length <code>n</code> giving exposure values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>custom_exposure(n = 5, metric = "temp", start.date = "2000-01-01")

</code></pre>

<hr>
<h2 id='eesim'>Simulate data, fit models, and assess models</h2><span id='topic+eesim'></span>

<h3>Description</h3>

<p>Generates synthetic time series datasets relevant for environmental epidemiology
studies and tests performance of a model on that simulated data.
Datasets can be generated with seasonal and long-term trends in either
exposure or outcome. Binary or continuous outcomes can be simulated or incorporated
from observed datasets. The function includes extensive options for customizing each
step of the simulation process; see the <code>eesim</code> vignette for more details and
examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eesim(n_reps, n, rr, exposure_type, custom_model, central = NULL, sd = NULL,
  exposure_trend = "no trend", exposure_slope = NULL, exposure_amp = NULL,
  average_outcome = NULL, outcome_trend = "no trend",
  outcome_slope = NULL, outcome_amp = NULL, start.date = "2000-01-01",
  cust_exp_func = NULL, cust_exp_args = NULL, cust_expdraw = NULL,
  cust_expdraw_args = NULL, cust_base_func = NULL,
  cust_lambda_func = NULL, cust_base_args = NULL, cust_lambda_args = NULL,
  cust_outdraw = NULL, cust_outdraw_args = NULL, custom_model_args = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eesim_+3A_n_reps">n_reps</code></td>
<td>
<p>An integer specifying the number of datasets to simulate (e.g.,
<code>n_reps = 1000</code> would simulate one thousand time series datasets with the
specified characteristics, which can be used for a power analysis or to investigate
the performance of a proposed model).</p>
</td></tr>
<tr><td><code id="eesim_+3A_n">n</code></td>
<td>
<p>An integer specifying the number of days to simulate (e.g., <code>n = 365</code>
would simulate a dataset with a year's worth of data).</p>
</td></tr>
<tr><td><code id="eesim_+3A_rr">rr</code></td>
<td>
<p>A non-negative numeric value specifying the relative risk (i.e., the
relative risk per unit increase in the exposure).</p>
</td></tr>
<tr><td><code id="eesim_+3A_exposure_type">exposure_type</code></td>
<td>
<p>A character string specifying the type of exposure.
Choices are &quot;binary&quot; or &quot;continuous&quot;.</p>
</td></tr>
<tr><td><code id="eesim_+3A_custom_model">custom_model</code></td>
<td>
<p>The object name of an R function that defines the code that will be used
to fit the model. This object name should not be in quotations. See Details for more.</p>
</td></tr>
<tr><td><code id="eesim_+3A_central">central</code></td>
<td>
<p>A numeric value specifying the mean probability of exposure
(for binary data) or the mean exposure value (for continuous data).</p>
</td></tr>
<tr><td><code id="eesim_+3A_sd">sd</code></td>
<td>
<p>A non-negative numeric value giving the standard deviation of the exposure
values from the exposure trend line (not the total standard deviation of
the exposure values).</p>
</td></tr>
<tr><td><code id="eesim_+3A_exposure_trend">exposure_trend</code></td>
<td>
<p>A character string specifying a seasonal and / or long-term trend for
expected mean exposure. See the vignette for <code>eesim</code> for examples of each option.
The shapes are based on those used in Bateson and Schwartz (1999).
For trends with a seasonal component, the amplitude of the seasonal trend can be
customized using the <code>exposure\_amp</code> argument. For trends with a long-term
pattern, the slope of the long-term trend can be set using the <code>exposure\_slope</code>
argument.
If using the &quot;monthly&quot; option for a binary exposure, you must input a numeric
vector of length 12 for the <code>central</code> argument that gives the probability of
exposure for each month, starting in January and ending in December.
Options for continuous exposure are:
</p>

<ul>
<li><p>&quot;no trend&quot;: No trend, either seasonal or long-term (default).
</p>
</li>
<li><p>&quot;cos1&quot;: A seasonal trend only.
</p>
</li>
<li><p>&quot;cos2&quot;: A seasonal trend with variable amplitude across years.
</p>
</li>
<li><p>&quot;cos3&quot;: A seasonal trend with steadily decreasing amplitude over time.
</p>
</li>
<li><p>&quot;linear&quot;: A linear long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;curvilinear&quot;: A curved long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;cos1linear&quot;: A seasonal trend plus a linear long-term trend.
</p>
</li></ul>

<p>Options for binary exposure are:
</p>

<ul>
<li><p>&quot;no trend&quot;: No trend, either seasonal or long-term (default).
</p>
</li>
<li><p>&quot;cos1&quot;: A seasonal trend only.
</p>
</li>
<li><p>&quot;cos2&quot;: A seasonal trend with variable amplitude across years.
</p>
</li>
<li><p>&quot;cos3&quot;: A seasonal trend with steadily decreasing amplitude over time.
</p>
</li>
<li><p>&quot;linear&quot;: A linear long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;monthly&quot;: Uses a user-specified probability of exposure for each month.
</p>
</li></ul>
</td></tr>
<tr><td><code id="eesim_+3A_exposure_slope">exposure_slope</code></td>
<td>
<p>A numeric value specifying the linear slope of the
exposure, to be used with <code>exposure_trend = "linear"</code> or
<code>exposure_trend = "cos1linear"</code>.
The default value is 1. Positive values will generate data with an
increasing expected value over the years while negative values will
generate data with decreasing expected value over the years.</p>
</td></tr>
<tr><td><code id="eesim_+3A_exposure_amp">exposure_amp</code></td>
<td>
<p>A numeric value specifying the amplitude of the exposure
trend. Must be between -1 and 1 for continuous exposure or between -0.5
and 0.5 for binary exposure. Positive values will simulate a pattern
with higher values at the time of the year of the start of the dataset
(typically January) and lowest values six months following that (typically
July). Negative values can be used to simulate a trend with lower values
at the time of year of the start of the dataset and higher values in the
opposite season.</p>
</td></tr>
<tr><td><code id="eesim_+3A_average_outcome">average_outcome</code></td>
<td>
<p>A non-negative numeric value specifying the average
daily outcome count.</p>
</td></tr>
<tr><td><code id="eesim_+3A_outcome_trend">outcome_trend</code></td>
<td>
<p>A character string specifying the seasonal trend in
health outcomes.  Options are the same as for continuous exposure
data.</p>
</td></tr>
<tr><td><code id="eesim_+3A_outcome_slope">outcome_slope</code></td>
<td>
<p>A numeric value specifying the linear slope of the
outcome trend, to be used with <code>outcome_trend = "linear"</code> or
<code>outcome_trend = "cos1linear"</code>. The default value is 1.
Positive values will generate data with an
increasing expected value over the years while negative values will
generate data with decreasing expected value over the years.</p>
</td></tr>
<tr><td><code id="eesim_+3A_outcome_amp">outcome_amp</code></td>
<td>
<p>A numeric value specifying the amplitude of the outcome
trend.  Must be between -1 and 1.</p>
</td></tr>
<tr><td><code id="eesim_+3A_start.date">start.date</code></td>
<td>
<p>A date of the format &quot;yyyy-mm-dd&quot; from which to begin
simulating daily exposures</p>
</td></tr>
<tr><td><code id="eesim_+3A_cust_exp_func">cust_exp_func</code></td>
<td>
<p>An R object name specifying the name of a custom
trend function to generate exposure data</p>
</td></tr>
<tr><td><code id="eesim_+3A_cust_exp_args">cust_exp_args</code></td>
<td>
<p>A list of arguments and their values for the
user-specified custom exposure function.</p>
</td></tr>
<tr><td><code id="eesim_+3A_cust_expdraw">cust_expdraw</code></td>
<td>
<p>An R object specifying a user-created function
which determines the distribution of random noise off of the trend line.
This function must have inputs <code>n</code> and <code>prob</code> for a binary exposure
function and inputs <code>n</code> and <code>mean</code> for a continuous exposure function.
The custom function must output a vector of simulated exposure values.</p>
</td></tr>
<tr><td><code id="eesim_+3A_cust_expdraw_args">cust_expdraw_args</code></td>
<td>
<p>A list of arguments other than <code>n</code> required by the
<code>cust_expdraw</code> function.</p>
</td></tr>
<tr><td><code id="eesim_+3A_cust_base_func">cust_base_func</code></td>
<td>
<p>A R object name specifying a user-made custom
function for baseline trend.</p>
</td></tr>
<tr><td><code id="eesim_+3A_cust_lambda_func">cust_lambda_func</code></td>
<td>
<p>An R object name specifying a user-made custom
function for relating baseline, relative risk, and exposure</p>
</td></tr>
<tr><td><code id="eesim_+3A_cust_base_args">cust_base_args</code></td>
<td>
<p>A list of arguments and their values used in the
user-specified custom baseline function</p>
</td></tr>
<tr><td><code id="eesim_+3A_cust_lambda_args">cust_lambda_args</code></td>
<td>
<p>A list of arguments and their values used in the
user-specified custom lambda function</p>
</td></tr>
<tr><td><code id="eesim_+3A_cust_outdraw">cust_outdraw</code></td>
<td>
<p>An R object name specifying a user-created function to
randomize the outcome values off of the baseline for outcome values. This
function must take inputs <code>n</code> and <code>lambda</code> and output a vector of outcome
values.</p>
</td></tr>
<tr><td><code id="eesim_+3A_cust_outdraw_args">cust_outdraw_args</code></td>
<td>
<p>A list of arguments besides <code>n</code> passed
to the user-created custom outcome draw function.</p>
</td></tr>
<tr><td><code id="eesim_+3A_custom_model_args">custom_model_args</code></td>
<td>
<p>A list of arguments and their values for a custom
model. These arguments are passed through to the function specified with <code>custom_model</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object with three elements:
</p>

<ul>
<li><p><code>simulated_datasets</code>: A list of length <code>n_reps</code>, in which each element is
a data frame with
one of the simulated time series datasets, created according to the specifications
set by the user.
</p>
</li>
<li><p><code>indiv_performance</code>: A dataframe with one row per simulated dataset (i.e.,
total number of rows equal to <code>n_reps</code>). Each row gives the results of fitting the
specified model to one of the simulated datasets. See <code><a href="#topic+fit_mods">fit_mods</a></code> for more on
this output.
</p>
</li>
<li><p><code>overall_performance</code>: A one-row dataframe with overall performance summaries
from fitting the specified model to the synthetic datasets. See <code><a href="#topic+check_sims">check_sims</a></code>
for more on this output.
</p>
</li></ul>



<h3>References</h3>

<p>Bateson TF, Schwartz J. 1999. Control for seasonal variation and time trend in
case-crossover studies of acute effects of environmental exposures. Epidemiology
10(4):539-544.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Run a simulation for a continuous exposure (mean = 100, standard
# deviation after long-term and seasonal trends = 10) that increases
# risk of a count outcome by 0.1% per unit increase, where the average
# daily outcome is 22 per day. The exposure outcome has a seasonal trend,
# with higher values in the winter, while the outcome has no seasonal
# or long-term trends beyond those introduced through effects from the
# exposure. The simulated data are fit with a model defined by the `spline_mod`
# function (also in the `eesim` package), with its `df_year` argument set to 7.

sims &lt;- eesim(n_reps = 3, n = 5 * 365, central = 100, sd = 10,
      exposure_type = "continuous", exposure_trend = "cos3",
      exposure_amp = .6, average_outcome = 22, rr = 1.001,
      custom_model = spline_mod, custom_model_args = list(df_year = 7))
names(sims)
sims[[2]]
sims[[3]]

</code></pre>

<hr>
<h2 id='fit_mods'>Fit a model to simulated datasets</h2><span id='topic+fit_mods'></span>

<h3>Description</h3>

<p>Fits a specified model to each of the simulated datasets and returns a dataframe
summarizing results from fitting the model to each dataset, including the estimated
effect and the estimated standard error for that estimated effect. The model is specified
through a user-created R function, which must take specific input and return
output in a specific format. For more details, see the parameter definitions,
the Details section, and the vignette for the <code>eesim</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_mods(data, custom_model = NULL, custom_model_args = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_mods_+3A_data">data</code></td>
<td>
<p>A list of simulated data sets. Each simulated dataset must include a
column called <code>x</code> with daily exposure values and a column called <code>outcome</code> with
daily outcome values. Typically, this will be the outcome from <code><a href="#topic+create_sims">create_sims</a></code>.</p>
</td></tr>
<tr><td><code id="fit_mods_+3A_custom_model">custom_model</code></td>
<td>
<p>The object name of an R function that defines the code that will be used
to fit the model. This object name should not be in quotations. See Details for more.</p>
</td></tr>
<tr><td><code id="fit_mods_+3A_custom_model_args">custom_model_args</code></td>
<td>
<p>A list of arguments and their values for a custom
model. These arguments are passed through to the function specified with <code>custom_model</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function specified by the <code>custom_model</code> argument should be
a user-created function that inputs a data frame with columns named &quot;x&quot; for
exposure values and &quot;outcome&quot; for outcome values. The function must output a data
frame with columns called <code>Estimate</code>, <code>Std. Error</code>, <code>t value</code>,
<code>Pr(&gt;|t|)</code>, <code>2.5%</code>, and <code>97.5%</code>. Note that these columns are the output
from <code>summary</code> and <code>confint</code> for models fit using a <code>glm</code> call. You may
use the function <code>format_out</code> from eesim within your function to produce output
with these columns if this model is fit using <code>glm</code> or something similar.
For more details and examples, see the vignette for <code>eesim</code>.
</p>


<h3>Value</h3>

<p>A data frame in which each row gives the results from the model-fitting function run
on one of the simulated datasets input to the function as the <code>data</code> object. The returned
data frame has one row per simulated dataset and the following columns:
</p>

<ul>
<li><p><code>Estimate</code>: The estimated <code class="reqn">\beta</code> (log relative risk) as estimated by
the model specified with <code>custom_model</code>.
</p>
</li>
<li><p><code>Std.Error</code>: The standard error for the estimated <code class="reqn">\beta</code>.
</p>
</li>
<li><p><code>t.value</code>: The test statistic for a test of the null hypothesis <code class="reqn">\beta = 0</code>.
</p>
</li>
<li><p><code>p.value</code>: The p-value for a test of the null hypothesis <code class="reqn">\beta = 0</code>.
</p>
</li>
<li><p><code>lower_ci</code>: The lower value in the 95% confidence interval estimated for
<code class="reqn">\beta</code>.
</p>
</li>
<li><p><code>upper_ci</code>: The upper value in the 95% confidence interval estimated for
<code class="reqn">\beta</code>.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Create a set of simulated datasets and then fit the model defined in `spline_mod` to
# all datasets, using the argument `df_year = 7` in the call to `spline_mod`. The `spline_mod`
# function is included in the `eesim` package and can be investigating by calling the function
# name without parentheses (i.e., `spline_mod`).
sims &lt;- create_sims(n_reps = 10, n = 5 * 365, central = 100, sd = 10,
            exposure_type = "continuous", exposure_trend = "cos1",
            exposure_amp = .6, average_outcome = 22,
            outcome_trend = "no trend", outcome_amp = .6, rr = 1.01)
fit_mods(data = sims, custom_model = spline_mod, custom_model_args = list(df_year = 7))

</code></pre>

<hr>
<h2 id='format_out'>Format output for custom model to use in eesim</h2><span id='topic+format_out'></span>

<h3>Description</h3>

<p>Formats the output within a modeling function to be used in a call to
<code><a href="#topic+eesim">eesim</a></code> when the model is fit using <code>glm</code> or something
similar.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_out(mod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="format_out_+3A_mod">mod</code></td>
<td>
<p>A model object from lm, glm, etc.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Output with the correct values and column names needed for a
modeling function to pass to <code><a href="#topic+eesim">eesim</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- data.frame(x=rnorm(1000, 0, 1), outcome = rnorm(1000, 5, 1))
lin_mod &lt;- lm(outcome~x, data=dat)
format_out(lin_mod)

</code></pre>

<hr>
<h2 id='mean_beta'>Average Estimated Coefficient</h2><span id='topic+mean_beta'></span>

<h3>Description</h3>

<p>This function gives the mean value of the estimated log relative risks (<code class="reqn">\hat{\beta}</code>s)
and the mean of the estimated relative risk values over the <code>n</code> simulations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mean_beta(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mean_beta_+3A_df">df</code></td>
<td>
<p>A data frame of replicated simulations which must include a column
titled &quot;Estimate&quot; with the effect estimate from the fitted model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the mean estimated log relative risk and mean estimated
relative risk. The mean estimated risk is based on first calculating the
mean log relative risk and then exponentiating this mean value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sims &lt;- create_sims(n_reps=10, n=50, central = 100, sd = 10,
            exposure_type="continuous", exposure_trend = "cos1",
            exposure_amp = .6, average_outcome = 22,
            outcome_trend = "no trend", outcome_amp = .6, rr = 1.01)
fits &lt;- fit_mods(data = sims, custom_model = spline_mod,
                 custom_model_args = list(df_year = 1))
mean_beta(df=fits)

</code></pre>

<hr>
<h2 id='power_beta'>Estimate power</h2><span id='topic+power_beta'></span>

<h3>Description</h3>

<p>Calculates the estimated power of a hypothesis test that the log relative risk
equals 0 at a 5% significance level across all simulated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_beta(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power_beta_+3A_df">df</code></td>
<td>
<p>A data frame of replicated simulations which must include columns
titled <code>lower_ci</code> and <code>upper_ci</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with one row with the estimated power of the analysis
at the 5% significance level.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sims &lt;- create_sims(n_reps = 10, n = 600, central = 100,
                    sd = 10, exposure_type = "continuous",
                    exposure_trend = "cos1",
                    exposure_amp = 0.6,
                    average_outcome = 20,
                    outcome_trend = "no trend",
                    rr = 1.01)
fits &lt;- fit_mods(data = sims, custom_model = spline_mod,
                 custom_model_args = list(df_year = 1))
power_beta(fits)

</code></pre>

<hr>
<h2 id='power_calc'>Power Calculations</h2><span id='topic+power_calc'></span>

<h3>Description</h3>

<p>Calculates the expected power of an environmental epidemiology time series analysis based
on simulated datasets. This function uses the simulation provided by <code>eesim</code> to
simulate multiple environmental epidemiology datasets under different scenarios (e.g.,
total days in study, size of association between exposure and outcome, or baseline
average daily count of the outcome in the study) and estimates the power of a specified
analysis to detect the hypothesized association.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_calc(varying, values, n_reps, custom_model, central, exposure_type,
  n = NULL, sd = NULL, exposure_trend = "no trend", exposure_amp = NULL,
  average_outcome = NULL, outcome_trend = "no trend", outcome_amp = NULL,
  rr = NULL, start.date = "2000-01-01", cust_exp_func = NULL,
  cust_exp_args = NULL, cust_base_func = NULL, cust_lambda_func = NULL,
  cust_base_args = NULL, cust_lambda_args = NULL,
  custom_model_args = NULL, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power_calc_+3A_varying">varying</code></td>
<td>
<p>A character string specifying the parameter to be varied.  Choices are
<code>'n'</code> (which varies the number of days in each dataset of simulated data),
<code>'rr'</code> (which varies the relative rate per unit increase in exposure that is used
to simulate the data), or <code>'average_outcome'</code> (which varies the average value
of the outcomes in each dataset). For whichever of these three values is not set to vary in this
argument, the user must specify a constant value to this function through the
<code>n</code>, <code>rr</code>, or <code>average_outcome</code> arguments.</p>
</td></tr>
<tr><td><code id="power_calc_+3A_values">values</code></td>
<td>
<p>A numeric vector with the values you would like to test for the varying
parameters. For example, <code>values = c(1.05, 1.10, 1.15)</code> would produce power
estimates for the four specified values of relative risk if the user has specified
<code>varying = 'rr'</code>.</p>
</td></tr>
<tr><td><code id="power_calc_+3A_n_reps">n_reps</code></td>
<td>
<p>An integer specifying the number of datasets to simulate (e.g.,
<code>n_reps = 1000</code> would simulate one thousand time series datasets with the
specified characteristics, which can be used for a power analysis or to investigate
the performance of a proposed model).</p>
</td></tr>
<tr><td><code id="power_calc_+3A_custom_model">custom_model</code></td>
<td>
<p>The object name of an R function that defines the code that will be used
to fit the model. This object name should not be in quotations. See Details for more.</p>
</td></tr>
<tr><td><code id="power_calc_+3A_central">central</code></td>
<td>
<p>A numeric value specifying the mean probability of exposure
(for binary data) or the mean exposure value (for continuous data).</p>
</td></tr>
<tr><td><code id="power_calc_+3A_exposure_type">exposure_type</code></td>
<td>
<p>A character string specifying the type of exposure.
Choices are &quot;binary&quot; or &quot;continuous&quot;.</p>
</td></tr>
<tr><td><code id="power_calc_+3A_n">n</code></td>
<td>
<p>An integer specifying the number of days to simulate (e.g., <code>n = 365</code>
would simulate a dataset with a year's worth of data).</p>
</td></tr>
<tr><td><code id="power_calc_+3A_sd">sd</code></td>
<td>
<p>A non-negative numeric value giving the standard deviation of the exposure
values from the exposure trend line (not the total standard deviation of
the exposure values).</p>
</td></tr>
<tr><td><code id="power_calc_+3A_exposure_trend">exposure_trend</code></td>
<td>
<p>A character string specifying a seasonal and / or long-term trend for
expected mean exposure. See the vignette for <code>eesim</code> for examples of each option.
The shapes are based on those used in Bateson and Schwartz (1999).
For trends with a seasonal component, the amplitude of the seasonal trend can be
customized using the <code>exposure\_amp</code> argument. For trends with a long-term
pattern, the slope of the long-term trend can be set using the <code>exposure\_slope</code>
argument.
If using the &quot;monthly&quot; option for a binary exposure, you must input a numeric
vector of length 12 for the <code>central</code> argument that gives the probability of
exposure for each month, starting in January and ending in December.
Options for continuous exposure are:
</p>

<ul>
<li><p>&quot;no trend&quot;: No trend, either seasonal or long-term (default).
</p>
</li>
<li><p>&quot;cos1&quot;: A seasonal trend only.
</p>
</li>
<li><p>&quot;cos2&quot;: A seasonal trend with variable amplitude across years.
</p>
</li>
<li><p>&quot;cos3&quot;: A seasonal trend with steadily decreasing amplitude over time.
</p>
</li>
<li><p>&quot;linear&quot;: A linear long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;curvilinear&quot;: A curved long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;cos1linear&quot;: A seasonal trend plus a linear long-term trend.
</p>
</li></ul>

<p>Options for binary exposure are:
</p>

<ul>
<li><p>&quot;no trend&quot;: No trend, either seasonal or long-term (default).
</p>
</li>
<li><p>&quot;cos1&quot;: A seasonal trend only.
</p>
</li>
<li><p>&quot;cos2&quot;: A seasonal trend with variable amplitude across years.
</p>
</li>
<li><p>&quot;cos3&quot;: A seasonal trend with steadily decreasing amplitude over time.
</p>
</li>
<li><p>&quot;linear&quot;: A linear long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;monthly&quot;: Uses a user-specified probability of exposure for each month.
</p>
</li></ul>
</td></tr>
<tr><td><code id="power_calc_+3A_exposure_amp">exposure_amp</code></td>
<td>
<p>A numeric value specifying the amplitude of the exposure
trend. Must be between -1 and 1 for continuous exposure or between -0.5
and 0.5 for binary exposure. Positive values will simulate a pattern
with higher values at the time of the year of the start of the dataset
(typically January) and lowest values six months following that (typically
July). Negative values can be used to simulate a trend with lower values
at the time of year of the start of the dataset and higher values in the
opposite season.</p>
</td></tr>
<tr><td><code id="power_calc_+3A_average_outcome">average_outcome</code></td>
<td>
<p>A non-negative numeric value specifying the average
daily outcome count.</p>
</td></tr>
<tr><td><code id="power_calc_+3A_outcome_trend">outcome_trend</code></td>
<td>
<p>A character string specifying the seasonal trend in
health outcomes.  Options are the same as for continuous exposure
data.</p>
</td></tr>
<tr><td><code id="power_calc_+3A_outcome_amp">outcome_amp</code></td>
<td>
<p>A numeric value specifying the amplitude of the outcome
trend.  Must be between -1 and 1.</p>
</td></tr>
<tr><td><code id="power_calc_+3A_rr">rr</code></td>
<td>
<p>A non-negative numeric value specifying the relative risk (i.e., the
relative risk per unit increase in the exposure).</p>
</td></tr>
<tr><td><code id="power_calc_+3A_start.date">start.date</code></td>
<td>
<p>A date of the format &quot;yyyy-mm-dd&quot; from which to begin
simulating daily exposures</p>
</td></tr>
<tr><td><code id="power_calc_+3A_cust_exp_func">cust_exp_func</code></td>
<td>
<p>An R object name specifying the name of a custom
trend function to generate exposure data</p>
</td></tr>
<tr><td><code id="power_calc_+3A_cust_exp_args">cust_exp_args</code></td>
<td>
<p>A list of arguments and their values for the
user-specified custom exposure function.</p>
</td></tr>
<tr><td><code id="power_calc_+3A_cust_base_func">cust_base_func</code></td>
<td>
<p>A R object name specifying a user-made custom
function for baseline trend.</p>
</td></tr>
<tr><td><code id="power_calc_+3A_cust_lambda_func">cust_lambda_func</code></td>
<td>
<p>An R object name specifying a user-made custom
function for relating baseline, relative risk, and exposure</p>
</td></tr>
<tr><td><code id="power_calc_+3A_cust_base_args">cust_base_args</code></td>
<td>
<p>A list of arguments and their values used in the
user-specified custom baseline function</p>
</td></tr>
<tr><td><code id="power_calc_+3A_cust_lambda_args">cust_lambda_args</code></td>
<td>
<p>A list of arguments and their values used in the
user-specified custom lambda function</p>
</td></tr>
<tr><td><code id="power_calc_+3A_custom_model_args">custom_model_args</code></td>
<td>
<p>A list of arguments and their values for a custom
model. These arguments are passed through to the function specified with <code>custom_model</code>.</p>
</td></tr>
<tr><td><code id="power_calc_+3A_plot">plot</code></td>
<td>
<p>&quot;TRUE&quot; or &quot;FALSE&quot; for whether to produce a plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with the values of the varying parameter and the estimated power
for each. If the <code>plot</code> argument is set to <code>TRUE</code>, it also returns a power
curve plot as a side effect. Because these estimates are based on simulations, there
will be some random variation in estimates of power. Estimates will be more stable
if a higher value is used for <code>n_reps</code>, although this will increase the time it
takes the function to run.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Calculate power for studies that vary in the total length of the study period
# (between one and twenty-one years of data) for the association between a continuous
# exposure with a seasonal trend (mean = 100, sd from seasonal baseline = 10) and a count
# outcome (e.g., daily number of deaths, mean daily value across the study period of 22).
# The alternative hypothesis is that there is a relative rate of the outcome of 1.001 for
# every one-unit increase in exposure. The null hypothesis is that there is no association
# between the exposure and the outcome. The model used to test for an association is a
# case-crossover model
## Not run: 
pow &lt;- power_calc(varying = "n", values = floor(365.25 * seq(1, 21, by = 5)), n_reps = 20,
           central = 100, sd = 10, rr = 1.001, exposure_type = "continuous",
           exposure_trend = "cos1", exposure_amp = .6, average_outcome = 22,
           outcome_trend = "no trend", outcome_amp = .6,
           custom_model = spline_mod, plot = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='sim_baseline'>Expected baseline health outcomes</h2><span id='topic+sim_baseline'></span>

<h3>Description</h3>

<p>Generates expected baseline health outcome counts based on average outcome and
desired seasonal and / or long-term trends.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_baseline(n, lambda, trend = "no trend", slope = 1, amp = 0.6,
  start.date = "2000-01-01")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_baseline_+3A_n">n</code></td>
<td>
<p>A numeric value specifying the number of days for which to simulate
data</p>
</td></tr>
<tr><td><code id="sim_baseline_+3A_lambda">lambda</code></td>
<td>
<p>A numeric value specifying the mean for the expected outcomes</p>
</td></tr>
<tr><td><code id="sim_baseline_+3A_trend">trend</code></td>
<td>
<p>A character string that specifies the desired trend function.
Options are:
</p>

<ul>
<li><p>&quot;no trend&quot;: No trend, either seasonal or long-term (default).
</p>
</li>
<li><p>&quot;cos1&quot;: A seasonal trend only.
</p>
</li>
<li><p>&quot;cos2&quot;: A seasonal trend with variable amplitude across years.
</p>
</li>
<li><p>&quot;cos3&quot;: A seasonal trend with steadily decreasing amplitude over time.
</p>
</li>
<li><p>&quot;linear&quot;: A linear long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;curvilinear&quot;: A curved long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;cos1linear&quot;: A seasonal trend plus a linear long-term trend.
</p>
</li></ul>

<p>See the package vignette for examples of the shapes of these trends.</p>
</td></tr>
<tr><td><code id="sim_baseline_+3A_slope">slope</code></td>
<td>
<p>A numeric value specifying the slope of the trend, to be used
with <code>trend = "linear"</code> or <code>trend = "cos1linear"</code>.</p>
</td></tr>
<tr><td><code id="sim_baseline_+3A_amp">amp</code></td>
<td>
<p>A numeric value specifying the amplitude of the seasonal trend.
Must be between -1 and 1.</p>
</td></tr>
<tr><td><code id="sim_baseline_+3A_start.date">start.date</code></td>
<td>
<p>A date in the format &quot;yyyy-mm-dd&quot; specifying the first day
for which to simulate data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the date and expected baseline outcome count for each
day of simulated data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim_baseline(n = 5, lambda = 100, trend = "cos1")

</code></pre>

<hr>
<h2 id='sim_exposure'>Simulate time series of exposure values</h2><span id='topic+sim_exposure'></span>

<h3>Description</h3>

<p>Simulates a time series of binary or continuous exposure values with or
without seasonal trends. It also allows the user to use a custom function for
the shape of the exposure trend.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_exposure(n, central = NULL, sd = NULL, trend = "no trend",
  slope = 1, amp = 0.6, exposure_type = NULL, start.date = "2001-01-01",
  cust_exp_func = NULL, cust_exp_args = NULL, cust_expdraw = NULL,
  cust_expdraw_args = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_exposure_+3A_n">n</code></td>
<td>
<p>A non-negative integer specifying the number of days to simulate.</p>
</td></tr>
<tr><td><code id="sim_exposure_+3A_central">central</code></td>
<td>
<p>A numeric value specifying the mean probability of exposure
(for binary data) or the mean exposure value (for continuous data).</p>
</td></tr>
<tr><td><code id="sim_exposure_+3A_sd">sd</code></td>
<td>
<p>A numeric value giving the standard deviation of the exposure
values from the exposure trend line.</p>
</td></tr>
<tr><td><code id="sim_exposure_+3A_trend">trend</code></td>
<td>
<p>A character string that specifies the desired trend function.
Options are:
</p>

<ul>
<li><p>&quot;no trend&quot;: No trend, either seasonal or long-term (default).
</p>
</li>
<li><p>&quot;cos1&quot;: A seasonal trend only.
</p>
</li>
<li><p>&quot;cos2&quot;: A seasonal trend with variable amplitude across years.
</p>
</li>
<li><p>&quot;cos3&quot;: A seasonal trend with steadily decreasing amplitude over time.
</p>
</li>
<li><p>&quot;linear&quot;: A linear long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;curvilinear&quot;: A curved long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;cos1linear&quot;: A seasonal trend plus a linear long-term trend.
</p>
</li></ul>

<p>See the package vignette for examples of the shapes of these trends.</p>
</td></tr>
<tr><td><code id="sim_exposure_+3A_slope">slope</code></td>
<td>
<p>A numeric value specifying the slope of the trend, to be used
with <code>trend = "linear"</code> or <code>trend = "cos1linear"</code>.</p>
</td></tr>
<tr><td><code id="sim_exposure_+3A_amp">amp</code></td>
<td>
<p>A numeric value specifying the amplitude of the seasonal trend.
Must be between -1 and 1.</p>
</td></tr>
<tr><td><code id="sim_exposure_+3A_exposure_type">exposure_type</code></td>
<td>
<p>A character string specifying the type of exposure.
Choices are &quot;binary&quot; or &quot;continuous&quot;.</p>
</td></tr>
<tr><td><code id="sim_exposure_+3A_start.date">start.date</code></td>
<td>
<p>A date of the format &quot;yyyy-mm-dd&quot; from which to begin
simulating daily exposures</p>
</td></tr>
<tr><td><code id="sim_exposure_+3A_cust_exp_func">cust_exp_func</code></td>
<td>
<p>An R object specifying the function to use to generate custom
exposure values.</p>
</td></tr>
<tr><td><code id="sim_exposure_+3A_cust_exp_args">cust_exp_args</code></td>
<td>
<p>A list of arguments used in the user-specified custom
function.</p>
</td></tr>
<tr><td><code id="sim_exposure_+3A_cust_expdraw">cust_expdraw</code></td>
<td>
<p>An R object specifying a user-created function
which determines the distribution of random noise off of the trend line.
This function must have inputs <code>n</code> and <code>prob</code> for a binary exposure
function and inputs <code>n</code> and <code>mean</code> for a continuous exposure function.
The custom function must output a vector of simulated exposure values.</p>
</td></tr>
<tr><td><code id="sim_exposure_+3A_cust_expdraw_args">cust_expdraw_args</code></td>
<td>
<p>A list of arguments other than <code>n</code> required by the
<code>cust_expdraw</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with two columns: date (<code>date</code>) and simulated
exposure values (<code>x</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim_exposure(n = 5, central = 0.25, exposure_type = "binary")
sim_exposure(n = 5, central = 100, sd = 10, exposure_type = "continuous")
library(ggplot2)
x_cont &lt;- sim_exposure(n = 1000, central = 100, sd = 10,
                       exposure_type = "continuous",
                       trend = "cos1linear", amp = 0.6)
ggplot(x_cont, aes(x = date, y = x)) + geom_point()
x_cust &lt;- sim_exposure(n = 1000, cust_exp_func = "custom_exposure",
                       cust_exp_args = list(metric = "temp"))
ggplot(x_cust, aes(x = date, y = x)) + geom_point()
</code></pre>

<hr>
<h2 id='sim_outcome'>Simulate outcome</h2><span id='topic+sim_outcome'></span>

<h3>Description</h3>

<p>Simulates daily outcome counts for each study day based on user specifications
for average outcome count, any underlying trends in expected outcome counts, and
the association between exposure and outcome. This function starts from a vector of
expected outcome count on each study day and simulates through a draw from a Poisson
distribution based on this expected daily value. If desired, a user can also use
a custom function to customize this stage of the simulation; see the vignette for
<code>eesim</code> for more details and examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_outcome(exposure, average_outcome = NULL, trend = "no trend",
  slope = 1, amp = 0.6, rr = 1.01, start.date = "2000-01-01",
  cust_base_func = NULL, cust_lambda_func = NULL, cust_base_args = list(),
  cust_lambda_args = list(), cust_outdraw = NULL,
  cust_outdraw_args = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_outcome_+3A_exposure">exposure</code></td>
<td>
<p>A numeric vector of exposure values, typically the output
of <code><a href="#topic+sim_exposure">sim_exposure</a></code>.</p>
</td></tr>
<tr><td><code id="sim_outcome_+3A_average_outcome">average_outcome</code></td>
<td>
<p>A non-negative numeric value specifying the average
daily outcome count.</p>
</td></tr>
<tr><td><code id="sim_outcome_+3A_trend">trend</code></td>
<td>
<p>A character string that specifies the desired trend function.
Options are:
</p>

<ul>
<li><p>&quot;no trend&quot;: No trend, either seasonal or long-term (default).
</p>
</li>
<li><p>&quot;cos1&quot;: A seasonal trend only.
</p>
</li>
<li><p>&quot;cos2&quot;: A seasonal trend with variable amplitude across years.
</p>
</li>
<li><p>&quot;cos3&quot;: A seasonal trend with steadily decreasing amplitude over time.
</p>
</li>
<li><p>&quot;linear&quot;: A linear long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;curvilinear&quot;: A curved long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;cos1linear&quot;: A seasonal trend plus a linear long-term trend.
</p>
</li></ul>

<p>See the package vignette for examples of the shapes of these trends.</p>
</td></tr>
<tr><td><code id="sim_outcome_+3A_slope">slope</code></td>
<td>
<p>A numeric value specifying the slope of the trend, to be used
with <code>trend = "linear"</code> or <code>trend = "cos1linear"</code>.</p>
</td></tr>
<tr><td><code id="sim_outcome_+3A_amp">amp</code></td>
<td>
<p>A numeric value specifying the amplitude of the seasonal trend.
Must be between -1 and 1.</p>
</td></tr>
<tr><td><code id="sim_outcome_+3A_rr">rr</code></td>
<td>
<p>A non-negative numeric value specifying the relative risk (i.e., the
relative risk per unit increase in the exposure).</p>
</td></tr>
<tr><td><code id="sim_outcome_+3A_start.date">start.date</code></td>
<td>
<p>A date of the format &quot;yyyy-mm-dd&quot; from which to begin
simulating values</p>
</td></tr>
<tr><td><code id="sim_outcome_+3A_cust_base_func">cust_base_func</code></td>
<td>
<p>A R object name specifying a user-made custom
function for baseline trend.</p>
</td></tr>
<tr><td><code id="sim_outcome_+3A_cust_lambda_func">cust_lambda_func</code></td>
<td>
<p>An R object name specifying a user-made custom
function for relating baseline, relative risk, and exposure</p>
</td></tr>
<tr><td><code id="sim_outcome_+3A_cust_base_args">cust_base_args</code></td>
<td>
<p>A list of arguments and their values used in the
user-specified custom baseline function</p>
</td></tr>
<tr><td><code id="sim_outcome_+3A_cust_lambda_args">cust_lambda_args</code></td>
<td>
<p>A list of arguments and their values used in the
user-specified custom lambda function</p>
</td></tr>
<tr><td><code id="sim_outcome_+3A_cust_outdraw">cust_outdraw</code></td>
<td>
<p>An R object name specifying a user-created function to
randomize the outcome values off of the baseline for outcome values. This
function must take inputs <code>n</code> and <code>lambda</code> and output a vector of outcome
values.</p>
</td></tr>
<tr><td><code id="sim_outcome_+3A_cust_outdraw_args">cust_outdraw_args</code></td>
<td>
<p>A list of arguments besides <code>n</code> passed
to the user-created custom outcome draw function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with a simulated time series, with columns for
<code>date</code>, <code>x</code> (exposure), and <code>outcome</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exp &lt;- sim_exposure(n = 5, central = 100, sd = 10, amp = .6,
                    exposure_type = "continuous")
sim_outcome(exposure = exp, average_outcome = 22, trend = "linear")

</code></pre>

<hr>
<h2 id='spline_mod'>Fit a generalized linear model</h2><span id='topic+spline_mod'></span>

<h3>Description</h3>

<p>Fits a model to estimate the log relative risk between an exposure and outcome
by using a natural cubic spline to control for long-term and seasonal trends and
assuming a quasi-Poisson distribution for the outcome. This function provides an
example of a function that can be input to <code><a href="#topic+eesim">eesim</a></code> or <code><a href="#topic+power_calc">power_calc</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spline_mod(df, df_year = 7)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spline_mod_+3A_df">df</code></td>
<td>
<p>A data frame with columns for daily exposure and outcome called &quot;x&quot; and &quot;outcome&quot;,
respectively</p>
</td></tr>
<tr><td><code id="spline_mod_+3A_df_year">df_year</code></td>
<td>
<p>A numeric value specifying the degrees of freedom per year to
use in the spline to control for long-term and seasonal trends in the outcome.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of length six with summary measures from fitting this model
to simulated data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exp &lt;- sim_exposure(n = 500, central = 100, sd = 10, trend = "cos1",
                    amp = .6, exposure_type = "continuous")
out &lt;- sim_outcome(exposure = exp, average_outcome = 22, rr = 1.01)
spline_mod(df = out)

</code></pre>

<hr>
<h2 id='std_exposure'>Simulate exposure data using default methods</h2><span id='topic+std_exposure'></span>

<h3>Description</h3>

<p>Simulates binary or continuous exposure data with or without seasonal trends
using default functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>std_exposure(n, central, sd = NULL, trend = "no trend",
  exposure_type = "binary", slope, amp, start.date = "2000-01-01", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="std_exposure_+3A_n">n</code></td>
<td>
<p>A non-negative integer specifying the number of days to simulate.</p>
</td></tr>
<tr><td><code id="std_exposure_+3A_central">central</code></td>
<td>
<p>A numeric value specifying the mean probability of exposure
(for binary data) or the mean exposure value (for continuous data).</p>
</td></tr>
<tr><td><code id="std_exposure_+3A_sd">sd</code></td>
<td>
<p>A numeric value giving the standard deviation of the exposure
values from the exposure trend line.</p>
</td></tr>
<tr><td><code id="std_exposure_+3A_trend">trend</code></td>
<td>
<p>A character string that specifies the desired trend function.
Options are:
</p>

<ul>
<li><p>&quot;no trend&quot;: No trend, either seasonal or long-term (default).
</p>
</li>
<li><p>&quot;cos1&quot;: A seasonal trend only.
</p>
</li>
<li><p>&quot;cos2&quot;: A seasonal trend with variable amplitude across years.
</p>
</li>
<li><p>&quot;cos3&quot;: A seasonal trend with steadily decreasing amplitude over time.
</p>
</li>
<li><p>&quot;linear&quot;: A linear long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;curvilinear&quot;: A curved long-term trend with no seasonal trend.
</p>
</li>
<li><p>&quot;cos1linear&quot;: A seasonal trend plus a linear long-term trend.
</p>
</li></ul>

<p>See the package vignette for examples of the shapes of these trends.</p>
</td></tr>
<tr><td><code id="std_exposure_+3A_exposure_type">exposure_type</code></td>
<td>
<p>A character string specifying the type of exposure.
Choices are &quot;binary&quot; or &quot;continuous&quot;.</p>
</td></tr>
<tr><td><code id="std_exposure_+3A_slope">slope</code></td>
<td>
<p>A numeric value specifying the slope of the trend, to be used
with <code>trend = "linear"</code> or <code>trend = "cos1linear"</code>.</p>
</td></tr>
<tr><td><code id="std_exposure_+3A_amp">amp</code></td>
<td>
<p>A numeric value specifying the amplitude of the seasonal trend.
Must be between -1 and 1.</p>
</td></tr>
<tr><td><code id="std_exposure_+3A_start.date">start.date</code></td>
<td>
<p>A date of the format &quot;yyyy-mm-dd&quot; from which to begin
simulating daily exposures</p>
</td></tr>
<tr><td><code id="std_exposure_+3A_...">...</code></td>
<td>
<p>Optional arguments to a custom trend function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with two columns: date (<code>date</code>) and simulated
exposure values (<code>x</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>std_exposure(n = 5, central = .1, trend = "cos1", amp = .02)
std_exposure(n = 5, central = 50, sd = 5, trend = "cos3", amp = .6,
             exposure_type = "continuous", start.date = "2001-04-01")
std_exposure(n=50, central=.1, amp=.05,cust_expdraw=rnbinom,
             cust_expdraw_args=list(size=10))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
