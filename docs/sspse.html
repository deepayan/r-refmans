<!DOCTYPE html><html><head><title>Help for package sspse</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sspse}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dsizeprior'><p>Prior distributions for the size of a hidden population</p></a></li>
<li><a href='#fauxmadrona2'><p>A Pair of Simulated RDS Data Sets with no seed dependency</p></a></li>
<li><a href='#impute.visibility'><p>Estimates each person's personal visibility based on their self-reported degree and the</p>
number of their (direct) recruits. It uses the time the person was recruited as a factor in
determining the number of recruits they produce.</a></li>
<li><a href='#plot.pospreddeg'><p>Plots the posterior predictive p-values for the reported network sizes</p></a></li>
<li><a href='#plot.sspse'><p>Plot Summary and Diagnostics for Population Size Estimation Model Fits</p></a></li>
<li><a href='#posize_warning'><p>Warning message for posteriorsize fit failure</p></a></li>
<li><a href='#pospreddeg'><p>Compute the posterior predictive p-values for the reported network sizes</p></a></li>
<li><a href='#posteriorsize'><p>Estimating hidden population size using RDS data</p></a></li>
<li><a href='#print.summary.sspse'><p>Summarizing Population Size Estimation Model Fits</p></a></li>
<li><a href='#sspse-package'><p>Estimating Hidden Population Size using Respondent Driven Sampling Data</p></a></li>
<li><a href='#summary.sspse'><p>Summarizing Population Size Estimation Model Fits</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-27</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimating Hidden Population Size using Respondent Driven
Sampling Data</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mark S. Handcock &lt;handcock@stat.ucla.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), methods, parallel, RDS, KernSmooth</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, densEstBayes</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimate the size of a networked population based on
    respondent-driven sampling data. The package is part of the "RDS Analyst"
    suite of packages for the analysis of respondent-driven sampling data.
    See Handcock, Gile and Mar (2014) &lt;<a href="https://doi.org/10.1214%2F14-EJS923">doi:10.1214/14-EJS923</a>&gt;,
    Handcock, Gile and Mar (2015) &lt;<a href="https://doi.org/10.1111%2Fbiom.12255">doi:10.1111/biom.12255</a>&gt;,
    Kim and Handcock (2021) &lt;<a href="https://doi.org/10.1093%2Fjssam%2Fsmz055">doi:10.1093/jssam/smz055</a>&gt;, and
    McLaughlin, et. al. (2023) &lt;<a href="https://doi.org/10.1214%2F23-AOAS1807">doi:10.1214/23-AOAS1807</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://hpmrg.org">https://hpmrg.org</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>scam, coda</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-28 17:00:47 UTC; handcock</td>
</tr>
<tr>
<td>Author:</td>
<td>Mark S. Handcock <a href="https://orcid.org/0000-0002-9985-2785"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Krista J. Gile [aut, cph],
  Brian Kim [ctb],
  Katherine R. McLaughlin [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-29 01:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='dsizeprior'>Prior distributions for the size of a hidden population</h2><span id='topic+dsizeprior'></span>

<h3>Description</h3>

<p><code><a href="#topic+dsizeprior">dsizeprior</a></code> computes the prior distribution of the population
size of a hidden population. The prior is intended to be used in Bayesian
inference for the population size based on data collected by Respondent
Driven Sampling, but can be used with any Bayesian method to estimate
population size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dsizeprior(
  n,
  type = c("beta", "nbinom", "pln", "flat", "continuous", "supplied"),
  mean.prior.size = NULL,
  sd.prior.size = NULL,
  mode.prior.sample.proportion = NULL,
  median.prior.sample.proportion = NULL,
  median.prior.size = NULL,
  mode.prior.size = NULL,
  quartiles.prior.size = NULL,
  effective.prior.df = 1,
  alpha = NULL,
  beta = NULL,
  maxN = NULL,
  log = FALSE,
  maxbeta = 120,
  maxNmax = 2e+05,
  supplied = list(maxN = maxN),
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dsizeprior_+3A_n">n</code></td>
<td>
<p>count; the sample size.</p>
</td></tr>
<tr><td><code id="dsizeprior_+3A_type">type</code></td>
<td>
<p>character; the type of parametric distribution to use for the
prior on population size. The options are <code>"beta"</code> (for a Beta-type
prior on the sample proportion (i.e. <code class="reqn">n/N</code>), <code>"nbinom"</code>
(Negative-Binomial), <code>"pln"</code> (Poisson-log-normal), <code>"flat"</code>
(uniform), <code>continuous</code> (the continuous version of the Beta-type prior
on the sample proportion). The last option is <code>"supplied"</code> which
enables a numeric prior to be specified. See the argument <code>supplied</code>
for the format of the information. The default <code>type</code> is <code>beta</code>.</p>
</td></tr>
<tr><td><code id="dsizeprior_+3A_mean.prior.size">mean.prior.size</code></td>
<td>
<p>scalar; A hyperparameter being the mean of the prior
distribution on the population size.</p>
</td></tr>
<tr><td><code id="dsizeprior_+3A_sd.prior.size">sd.prior.size</code></td>
<td>
<p>scalar; A hyperparameter being the standard deviation
of the prior distribution on the population size.</p>
</td></tr>
<tr><td><code id="dsizeprior_+3A_mode.prior.sample.proportion">mode.prior.sample.proportion</code></td>
<td>
<p>scalar; A hyperparameter being the mode
of the prior distribution on the sample proportion <code class="reqn">n/N</code>.</p>
</td></tr>
<tr><td><code id="dsizeprior_+3A_median.prior.sample.proportion">median.prior.sample.proportion</code></td>
<td>
<p>scalar; A hyperparameter being the
median of the prior distribution on the sample proportion <code class="reqn">n/N</code>.</p>
</td></tr>
<tr><td><code id="dsizeprior_+3A_median.prior.size">median.prior.size</code></td>
<td>
<p>scalar; A hyperparameter being the mode of the
prior distribution on the population size.</p>
</td></tr>
<tr><td><code id="dsizeprior_+3A_mode.prior.size">mode.prior.size</code></td>
<td>
<p>scalar; A hyperparameter being the mode of the prior
distribution on the population size.</p>
</td></tr>
<tr><td><code id="dsizeprior_+3A_quartiles.prior.size">quartiles.prior.size</code></td>
<td>
<p>vector of length 2; A pair of hyperparameters
being the lower and upper quartiles of the prior distribution on the
population size. For example, <br />
<code>quartiles.prior.size=c(1000,4000)</code>
corresponds to a prior where the lower quartile (25%) is 1000 and the upper
(75%) is 4000.</p>
</td></tr>
<tr><td><code id="dsizeprior_+3A_effective.prior.df">effective.prior.df</code></td>
<td>
<p>scalar; A hyperparameter being the effective
number of samples worth of information represented in the prior distribution
on the population size. By default this is 1, but it can be greater (or
less!) to allow for different levels of uncertainty.</p>
</td></tr>
<tr><td><code id="dsizeprior_+3A_alpha">alpha</code></td>
<td>
<p>scalar; A hyperparameter being the first parameter of the Beta
prior model for the sample proportion. By default this is NULL, meaning that
1 is chosen. it can be any value at least 1 to allow for different levels of
uncertainty.</p>
</td></tr>
<tr><td><code id="dsizeprior_+3A_beta">beta</code></td>
<td>
<p>scalar; A hyperparameter being the second parameter of the Beta
prior model for the sample proportion. By default this is NULL, meaning that
1 is chosen. it can be any value at least 1 to allow for different levels of
uncertainty.</p>
</td></tr>
<tr><td><code id="dsizeprior_+3A_maxn">maxN</code></td>
<td>
<p>integer; maximum possible population size. By default this is
determined from an upper quantile of the prior distribution.</p>
</td></tr>
<tr><td><code id="dsizeprior_+3A_log">log</code></td>
<td>
<p>logical; return the prior or the the logarithm of the prior.</p>
</td></tr>
<tr><td><code id="dsizeprior_+3A_maxbeta">maxbeta</code></td>
<td>
<p>integer; maximum beta in the prior for population size. By
default this is determined to ensure numerical stability.</p>
</td></tr>
<tr><td><code id="dsizeprior_+3A_maxnmax">maxNmax</code></td>
<td>
<p>integer; maximum possible population size. By default this is
determined to ensure numerical stability.</p>
</td></tr>
<tr><td><code id="dsizeprior_+3A_supplied">supplied</code></td>
<td>
<p>list; If the argument <code>type="supplied"</code> then this
should be a list object, typically of class <code>sspse</code>. It is primarily
used to pass the posterior sample from a separate <code>size</code> call for use
as the prior to this call. Essentially, it must have two components named
<code>maxN</code> and <code>sample</code>. <code>maxN</code> is the maximum population
envisaged and <code>sample</code> is random sample from the prior distribution.</p>
</td></tr>
<tr><td><code id="dsizeprior_+3A_verbose">verbose</code></td>
<td>
<p>logical; if this is <code>TRUE</code>, the program will print out
additional information, including goodness of fit statistics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+dsizeprior">dsizeprior</a></code> returns a list consisting of the following
elements: </p>
<table>
<tr><td><code>x</code></td>
<td>
<p>vector; vector of degrees <code>1:N</code> at which the prior
PMF is computed.</p>
</td></tr> <tr><td><code>lpriorm</code></td>
<td>
<p>vector; vector of probabilities
corresponding to the values in <code>x</code>.</p>
</td></tr> <tr><td><code>N</code></td>
<td>
<p>scalar; a starting value
for the population size computed from the prior.</p>
</td></tr> <tr><td><code>maxN</code></td>
<td>
<p>integer;
maximum possible population size. By default this is determined from an
upper quantile of the prior distribution.</p>
</td></tr> <tr><td><code>mean.prior.size</code></td>
<td>
<p>scalar; A
hyperparameter being the mean of the prior distribution on the population
size.</p>
</td></tr> 
<tr><td><code>mode.prior.size</code></td>
<td>
<p>scalar; A hyperparameter being the mode of the prior
distribution on the population size.</p>
</td></tr> <tr><td><code>effective.prior.df</code></td>
<td>
<p>scalar; A
hyperparameter being the effective number of samples worth of information
represented in the prior distribution on the population size. By default
this is 1, but it can be greater (or less!) to allow for different levels of
uncertainty.</p>
</td></tr> <tr><td><code>mode.prior.sample.proportion</code></td>
<td>
<p>scalar; A hyperparameter
being the mode of the prior distribution on the sample proportion
<code class="reqn">n/N</code>.</p>
</td></tr> <tr><td><code>median.prior.size</code></td>
<td>
<p>scalar; A hyperparameter being the mode
of the prior distribution on the population size.</p>
</td></tr> <tr><td><code>beta</code></td>
<td>
<p>scalar; A
hyperparameter being the second parameter of the Beta distribution that is a
component of the prior distribution on the sample proportion <code class="reqn">n/N</code>.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>character; the type of parametric distribution to use for the
prior on population size. The possible values are <code>beta</code> (for a Beta
prior on the sample proportion (i.e. <code class="reqn">n/N</code>), <code>nbinom</code>
(Negative-Binomial), <code>pln</code> (Poisson-log-normal), <code>flat</code> (uniform),
and <code>continuous</code> (the continuous version of the Beta prior on the
sample proportion. The default is <code>beta</code>.</p>
</td></tr>
</table>


<h3>Details on priors</h3>

<p>The best way to specify the prior is via the
hyperparameter <code>mode.prior.size</code> which specifies the mode of the prior
distribution on the population size. You can alternatively specify the
hyperparameter <code>median.prior.size</code> which specifies the median of the
prior distribution on the population size, or <code>mode.prior.sample
proportion</code> which specifies the mode of the prior distribution on the
proportion of the population size in the sample.
</p>


<h3>References</h3>

<p>Gile, Krista J. (2008) <em>Inference from Partially-Observed Network
Data</em>, Ph.D. Thesis, Department of Statistics, University of Washington.
</p>
<p>Gile, Krista J. and Handcock, Mark S. (2010) <em>Respondent-Driven
Sampling: An Assessment of Current Methodology</em>, Sociological Methodology
40, 285-327.
</p>
<p>Gile, Krista J. and Handcock, Mark S. (2014) <span class="pkg">sspse</span>: Estimating Hidden 
Population Size using Respondent Driven Sampling Data
R package, Los Angeles, CA.  Version 0.5, <a href="https://hpmrg.org/sspse/">https://hpmrg.org/sspse/</a>.
</p>
<p>Handcock MS (2003).  <span class="pkg">degreenet</span>: Models for Skewed Count Distributions
Relevant to Networks.  Statnet Project, Seattle, WA.  Version 1.2,
<a href="https://statnet.org/">https://statnet.org/</a>.
</p>
<p>Handcock, Mark S., Gile, Krista J. and Mar, Corinne M. (2014)
<em>Estimating Hidden Population Size using Respondent-Driven Sampling
Data</em>, Electronic Journal of Statistics, 8, 1, 1491-1521
</p>
<p>Handcock, Mark S., Gile, Krista J. and Mar, Corinne M. (2015)
<em>Estimating the Size of Populations at High Risk for HIV using Respondent-Driven 
Sampling Data</em>, Biometrics.
</p>


<h3>See Also</h3>

<p>network, statnet, degreenet
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
prior &lt;- dsizeprior(n=100,
                    type="beta",
                    mode.prior.size=1000)

</code></pre>

<hr>
<h2 id='fauxmadrona2'>A Pair of Simulated RDS Data Sets with no seed dependency</h2><span id='topic+fauxmadrona2'></span>

<h3>Description</h3>

<p>This is a faux set used to illustrate how the estimators for 
multiple Respondent-Driven sampling surveys perform under
different populations and RDS schemes.
</p>


<h3>Format</h3>

<p>A list with the first element being an <code>rds.data.frame</code> of the first survey and the
second element being an <code>rds.data.frame</code> of the second survey.
</p>


<h3>Details</h3>

<p>The population is based on <code>fauxmadrona</code> from the <code>RDS</code> package. 
It is a population with N=1000 nodes from which two successive respondent-driven samples are drawn.
For the first survey, the sample size is 200 so
that there is a relatively small sample fraction (20%). There is homophily
on disease status (R=5) and there is differential activity by disease status
whereby the infected nodes have mean degree twice that of the uninfected
(w=1.8).
</p>
<p>In the sampling, the seeds are chosen randomly from the full population, so
there is no dependency induced by seed selection.
</p>
<p>Each sample member is given 2 uniquely identified coupons to distribute to
other members of the target population in their acquaintance.  Further each
respondent distributes their coupons completely at random from among those
they are connected to.
</p>
<p>For the second sample the sample size is 250. The second survey has an additional variable <code>recapture</code> 
indicating if the respondent was also surveyed in the first survey.
</p>
<p>Each survey is represented as an <code>rds.data.frame</code> and they are stored in a list with two elements.
</p>


<h3>Source</h3>

<p>The original network is included in the <code>RDS</code> package as
<code>fauxmadrona.network</code>, a <code>network</code> object.  <br /> The <code>RDS</code> package
also includes a third respondent-driven sample  from the network and is referred to as 
<code>fauxmadrona</code>.  <br /> Use <code>data(package="sspse")</code> to get a full list
of datasets.
</p>


<h3>References</h3>

<p>Gile, Krista J., Handcock, Mark S., 2010 <em>Respondent-driven
Sampling: An Assessment of Current Methodology</em>, <em>Sociological
Methodology</em>, 40, 285-327. <a href="https://doi.org/10.1111/j.1467-9531.2010.01223.x">doi:10.1111/j.1467-9531.2010.01223.x</a>.
</p>
<p>Kim, Brian J. and Handcock, Mark S. 2021 <em>Population Size Estimation Using Multiple Respondent-Driven Sampling Surveys</em>,
<em>Journal of Survey Statistics and Methodology</em>, 9(1):94â€“120. <a href="https://doi.org/10.1093/jssam/smz055">doi:10.1093/jssam/smz055</a>.
</p>


<h3>See Also</h3>

<p><code><a href="RDS.html#topic+fauxsycamore">fauxsycamore</a></code>, <code><a href="RDS.html#topic+fauxmadrona">fauxmadrona</a></code>
</p>

<hr>
<h2 id='impute.visibility'>Estimates each person's personal visibility based on their self-reported degree and the 
number of their (direct) recruits. It uses the time the person was recruited as a factor in 
determining the number of recruits they produce.</h2><span id='topic+impute.visibility'></span>

<h3>Description</h3>

<p>Estimates each person's personal visibility based on their self-reported degree and the 
number of their (direct) recruits. It uses the time the person was recruited as a factor in 
determining the number of recruits they produce.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>impute.visibility(
  rds.data,
  max.coupons = NULL,
  type.impute = c("median", "distribution", "mode", "mean"),
  recruit.time = NULL,
  include.tree = FALSE,
  reflect.time = FALSE,
  parallel = 1,
  parallel.type = "PSOCK",
  interval = 10,
  burnin = 5000,
  mem.optimism.prior = NULL,
  df.mem.optimism.prior = 5,
  mem.scale.prior = 2,
  df.mem.scale.prior = 10,
  mem.overdispersion = 15,
  return.posterior.sample.visibilities = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="impute.visibility_+3A_rds.data">rds.data</code></td>
<td>
<p>An rds.data.frame</p>
</td></tr>
<tr><td><code id="impute.visibility_+3A_max.coupons">max.coupons</code></td>
<td>
<p>The number of recruitment coupons distributed to each 
enrolled subject (i.e. the maximum number of recruitees for any subject).
By default it is taken by the attribute or data, else the maximum recorded number of coupons.</p>
</td></tr>
<tr><td><code id="impute.visibility_+3A_type.impute">type.impute</code></td>
<td>
<p>The type of imputation based on the conditional distribution. 
It can be of type <code>distribution</code>,<code>mode</code>,<code>median</code>, or <code>mean</code> 
with the first , the default, being a random draw from the conditional distribution.</p>
</td></tr>
<tr><td><code id="impute.visibility_+3A_recruit.time">recruit.time</code></td>
<td>
<p>vector; An optional value for the data/time that the person was interviewed.
It needs to resolve as a numeric vector with number of elements the number
of rows of the data with non-missing values of the network variable. If it
is a character name of a variable in the data then that variable is used.
If it is NULL then the sequence number of the recruit in the data is used.
If it is NA then the recruitment is not used in the model.
Otherwise, the recruitment time is used in the model to better predict the visibility of the person.</p>
</td></tr>
<tr><td><code id="impute.visibility_+3A_include.tree">include.tree</code></td>
<td>
<p>logical; If <code>TRUE</code>, 
augment the reported network size by the number of recruits and one for the recruiter (if any).
This reflects a more accurate value for the visibility, but is not the self-reported degree.
In particular, it typically produces a positive visibility (compared to a possibility zero self-reported degree).</p>
</td></tr>
<tr><td><code id="impute.visibility_+3A_reflect.time">reflect.time</code></td>
<td>
<p>logical; If <code>FALSE</code> then the <code>recruit.time</code> is the time before the 
end of the study (instead of the time since the survey started or chronological time).</p>
</td></tr>
<tr><td><code id="impute.visibility_+3A_parallel">parallel</code></td>
<td>
<p>count; the number of parallel processes to run for the
Monte-Carlo sample.  This uses MPI or PSOCK. The default is 1, that is not to
use parallel processing.</p>
</td></tr>
<tr><td><code id="impute.visibility_+3A_parallel.type">parallel.type</code></td>
<td>
<p>The type of parallel processing to use. The options are
&quot;PSOCK&quot; or &quot;MPI&quot;. This requires the corresponding type to be installed.
The default is &quot;PSOCK&quot;.</p>
</td></tr>
<tr><td><code id="impute.visibility_+3A_interval">interval</code></td>
<td>
<p>count; the number of proposals between sampled statistics.</p>
</td></tr>
<tr><td><code id="impute.visibility_+3A_burnin">burnin</code></td>
<td>
<p>count; the number of proposals before any MCMC sampling is
done. It typically is set to a fairly large number.</p>
</td></tr>
<tr><td><code id="impute.visibility_+3A_mem.optimism.prior">mem.optimism.prior</code></td>
<td>
<p>scalar; A hyper parameter being the mean of the 
distribution of the optimism parameter.</p>
</td></tr>
<tr><td><code id="impute.visibility_+3A_df.mem.optimism.prior">df.mem.optimism.prior</code></td>
<td>
<p>scalar; A hyper parameter being the degrees-of-freedom
of the prior for the optimism parameter. This gives the equivalent sample size that would
contain the same amount of information inherent in the prior.</p>
</td></tr>
<tr><td><code id="impute.visibility_+3A_mem.scale.prior">mem.scale.prior</code></td>
<td>
<p>scalar; A hyper parameter being the scale of the concentration of
baseline negative binomial measurement error model.</p>
</td></tr>
<tr><td><code id="impute.visibility_+3A_df.mem.scale.prior">df.mem.scale.prior</code></td>
<td>
<p>scalar; A hyper parameter being the degrees-of-freedom of
the prior for the standard deviation of the dispersion parameter in the visibility model.
This gives the equivalent sample size
that would contain the same amount of information inherent in the prior for
the standard deviation.</p>
</td></tr>
<tr><td><code id="impute.visibility_+3A_mem.overdispersion">mem.overdispersion</code></td>
<td>
<p>scalar; A parameter being the overdispersion of the negative binomial
distribution that is the baseline for the measurement error model.</p>
</td></tr>
<tr><td><code id="impute.visibility_+3A_return.posterior.sample.visibilities">return.posterior.sample.visibilities</code></td>
<td>
<p>logical; If TRUE then return a
matrix of dimension <code>samplesize</code> by <code>n</code> of 
posterior draws from the visibility distribution for those in the survey.
The sample for the <code>i</code>th person is the <code>i</code>th column.
The default is FALSE so that the vector of imputes defined by <code>type.impute</code> is returned.</p>
</td></tr>
<tr><td><code id="impute.visibility_+3A_verbose">verbose</code></td>
<td>
<p>logical; if this is <code>TRUE</code>, the program will print out additional</p>
</td></tr>
</table>


<h3>References</h3>

<p>McLaughlin, Katherine R.; Johnston, Lisa G.; Jakupi, Xhevat; Gexha-Bunjaku, Dafina; Deva, Edona and Handcock, Mark S. (2023)
Modeling the Visibility Distribution for Respondent-Driven Sampling with Application to Population Size Estimation,
<em>Annals of Applied Statistics</em>, <a href="https://doi.org/10.1093/jrsssa/qnad031">doi:10.1093/jrsssa/qnad031</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(fauxmadrona)
# The next line fits the model for the self-reported personal
# network sizes and imputes the personal network sizes 
# It may take up to 60 seconds.
visibility &lt;- impute.visibility(fauxmadrona)
# frequency of estimated personal visibility
table(visibility)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.pospreddeg'>Plots the posterior predictive p-values for the reported network sizes</h2><span id='topic+plot.pospreddeg'></span>

<h3>Description</h3>

<p>This function extracts from an
estimate of the posterior distribution of the
population size based on data collected by Respondent Driven Sampling. The
approach approximates the RDS via the Sequential Sampling model of Gile
(2008).  As such, it is referred to as the Sequential Sampling - Population Size Estimate (SS-PSE).
It uses the order of selection of the sample to provide information
on the distribution of network sizes over the population members.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pospreddeg'
plot(
  x,
  main = "Posterior Predictive p-values for the self-reported network sizes",
  nclass = 20,
  hist = FALSE,
  ylim = c(0, 2),
  order.by.recruitment.time = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.pospreddeg_+3A_x">x</code></td>
<td>
<p>an object of class <code>"pospreddeg"</code>, usually, a result of a call
to <code>pospreddeg</code>.</p>
</td></tr>
<tr><td><code id="plot.pospreddeg_+3A_main">main</code></td>
<td>
<p>character; title for the plot</p>
</td></tr>
<tr><td><code id="plot.pospreddeg_+3A_nclass">nclass</code></td>
<td>
<p>count; The number of classes for the histogram plot</p>
</td></tr>
<tr><td><code id="plot.pospreddeg_+3A_hist">hist</code></td>
<td>
<p>logical; If <code>TRUE</code> plot a histogram of the p-values rather than
a density estimate.</p>
</td></tr>
<tr><td><code id="plot.pospreddeg_+3A_ylim">ylim</code></td>
<td>
<p>two-vector; lower and upper limits of vertical/density axis.</p>
</td></tr>
<tr><td><code id="plot.pospreddeg_+3A_order.by.recruitment.time">order.by.recruitment.time</code></td>
<td>
<p>logical; If <code>TRUE</code>, 
the reorder the input data by the recruitment time</p>
</td></tr>
<tr><td><code id="plot.pospreddeg_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It computes the posterior predictive distribution for each reported network size 
and computes the percentile rank of the reported network size within that posterior.
The percentile rank should be about 0.5 for a well specified model, but could be close to
uniform if there is little information about the reported network size.
The percentile ranks should not be extreme (e.g., close to zero or one) on a consistent basis
as this indicates a misspecified model.
</p>


<h3>References</h3>

<p>Gile, Krista J. (2008) <em>Inference from Partially-Observed Network
Data</em>, Ph.D. Thesis, Department of Statistics, University of Washington.
</p>
<p>Gile, Krista J. and Handcock, Mark S. (2010) <em>Respondent-Driven
Sampling: An Assessment of Current Methodology</em>, Sociological Methodology
40, 285-327.
</p>
<p>Gile, Krista J. and Handcock, Mark S. (2014) <span class="pkg">sspse</span>: Estimating Hidden 
Population Size using Respondent Driven Sampling Data
R package, Los Angeles, CA.  Version 0.5, <a href="https://hpmrg.org/sspse/">https://hpmrg.org/sspse/</a>.
</p>
<p>Handcock MS (2003).  <span class="pkg">degreenet</span>: Models for Skewed Count Distributions
Relevant to Networks.  Statnet Project, Seattle, WA.  Version 1.2,
<a href="https://statnet.org/">https://statnet.org/</a>.
</p>
<p>Handcock, Mark S., Gile, Krista J. and Mar, Corinne M. (2014)
<em>Estimating Hidden Population Size using Respondent-Driven Sampling
Data</em>, Electronic Journal of Statistics, 8, 1, 1491-1521
</p>
<p>Handcock, Mark S., Gile, Krista J. and Mar, Corinne M. (2015)
<em>Estimating the Size of Populations at High Risk for HIV using Respondent-Driven 
Sampling Data</em>, Biometrics.
</p>


<h3>See Also</h3>

<p>The model fitting function <code><a href="#topic+posteriorsize">posteriorsize</a></code>,
<code><a href="graphics.html#topic+plot">plot</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
data(fauxmadrona)
# Here interval=1 so that it will run faster. It should be higher in a 
# real application.
fit &lt;- posteriorsize(fauxmadrona, median.prior.size=1000,
                                 burnin=10, interval=1, samplesize=50)
summary(fit)
# Let's look at some MCMC diagnostics
plot(pospreddeg(fit))

## End(Not run)

</code></pre>

<hr>
<h2 id='plot.sspse'>Plot Summary and Diagnostics for Population Size Estimation Model Fits</h2><span id='topic+plot.sspse'></span>

<h3>Description</h3>

<p>This is the <code>plot</code> method for class <code>"sspse"</code>. Objects of
this class encapsulate the 
estimate of the posterior distribution of the
population size based on data collected by Respondent Driven Sampling. The
approach approximates the RDS via the Sequential Sampling model of Gile
(2008).  As such, it is referred to as the Sequential Sampling - Population Size Estimate (SS-PSE).
It uses the order of selection of the sample to provide information
on the distribution of network sizes over the population members.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sspse'
plot(
  x,
  xlim = NULL,
  support = 1000,
  HPD.level = 0.9,
  N = NULL,
  ylim = NULL,
  mcmc = FALSE,
  type = "all",
  main = "Posterior for population size",
  smooth = 4,
  include.tree = TRUE,
  cex.main = 1,
  log.degree = "",
  method = "bgk",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.sspse_+3A_x">x</code></td>
<td>
<p>an object of class <code>"plot.sspse"</code>, usually, a result of a call
to <code>plot.sspse</code>.</p>
</td></tr>
<tr><td><code id="plot.sspse_+3A_xlim">xlim</code></td>
<td>
<p>the (optional) x limits (x1, x2) of the plot of the posterior of
the population size.</p>
</td></tr>
<tr><td><code id="plot.sspse_+3A_support">support</code></td>
<td>
<p>the number of equally-spaced points to use for the support of
the estimated posterior density function.</p>
</td></tr>
<tr><td><code id="plot.sspse_+3A_hpd.level">HPD.level</code></td>
<td>
<p>numeric; probability level of the highest probability
density interval determined from the estimated posterior.</p>
</td></tr>
<tr><td><code id="plot.sspse_+3A_n">N</code></td>
<td>
<p>Optionally, an estimate of the population size to mark on the plots
as a reference point.</p>
</td></tr>
<tr><td><code id="plot.sspse_+3A_ylim">ylim</code></td>
<td>
<p>the (optional) vertical limits (y1, y2) of the plot of the
posterior of the population size. A vertical axis is the probability density
scale.</p>
</td></tr>
<tr><td><code id="plot.sspse_+3A_mcmc">mcmc</code></td>
<td>
<p>logical; If TRUE, additionally create simple diagnostic plots
for the MCMC sampled statistics produced from the fit.</p>
</td></tr>
<tr><td><code id="plot.sspse_+3A_type">type</code></td>
<td>
<p>character; This controls the types of plots produced.  If
<code>"N"</code>, a density plot of the posterior for population size is produced.
and the prior for population size is overlaid. If <code>"summary"</code>, a 
density plot of the posterior for mean visibility in the population and
a plot of the posterior for standard deviation of the visibility in the population.
If <code>"visibility"</code>, a density plot of
the visibility distribution (its posterior mean) and the same plot with the 
with visibilities of those in the sample overlaid.
If <code>"degree"</code>, a scatter plot of the visibilities verses the reported network sizes for 
those in the sample.
If <code>"prior"</code>, a density plot of the prior for population size is produced.
If <code>"all"</code>, then all plots for <code>"N"</code>, <code>"summary"</code>, <code>"visibility"</code> and
<code>"degree"</code> are produced.
In all cases the visibilities are estimated (by their posterior means).</p>
</td></tr>
<tr><td><code id="plot.sspse_+3A_main">main</code></td>
<td>
<p>an overall title for the posterior plot.</p>
</td></tr>
<tr><td><code id="plot.sspse_+3A_smooth">smooth</code></td>
<td>
<p>the (optional) smoothing parameter for the density estimate.</p>
</td></tr>
<tr><td><code id="plot.sspse_+3A_include.tree">include.tree</code></td>
<td>
<p>logical; If <code>TRUE</code>, 
augment the reported network size by the number of recruits and one for the recruiter (if any).
This reflects a more accurate value for the visibility, but is not the reported degree.
In particular, it typically produces a positive visibility (compared to a possibility zero reported degree).</p>
</td></tr>
<tr><td><code id="plot.sspse_+3A_cex.main">cex.main</code></td>
<td>
<p>an overall title for the posterior plot.</p>
</td></tr>
<tr><td><code id="plot.sspse_+3A_log.degree">log.degree</code></td>
<td>
<p>a character string which contains <code>"x"</code> if the (horizontal) degree axis in the plot
of the estimated visibilites for each respondent verses their reported network sizes be logarithmic. 
A value of <code>"y"</code> uses a logarithmic visibility axis and <code>"xy"</code> both. The default is <code>""</code>, no logarithmic axes.</p>
</td></tr>
<tr><td><code id="plot.sspse_+3A_method">method</code></td>
<td>
<p>character; The method to use for density estimation (default Gaussian Kernel; &quot;bgk&quot;).
&quot;Bayes&quot; uses a Bayesian density estimator which has good properties.</p>
</td></tr>
<tr><td><code id="plot.sspse_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default it produces a density plot of the posterior for population size
and the prior for population size is overlaid. It also produces a
density plot of the posterior for mean network size in the population, the
posterior for standard deviation of the network size, and a density plot of
the posterior mean network size distribution with sample histogram overlaid.
</p>


<h3>References</h3>

<p>Gile, Krista J. (2008) <em>Inference from Partially-Observed Network
Data</em>, Ph.D. Thesis, Department of Statistics, University of Washington.
</p>
<p>Gile, Krista J. and Handcock, Mark S. (2010) <em>Respondent-Driven
Sampling: An Assessment of Current Methodology</em>, Sociological Methodology
40, 285-327.
</p>
<p>Gile, Krista J. and Handcock, Mark S. (2014) <span class="pkg">sspse</span>: Estimating Hidden 
Population Size using Respondent Driven Sampling Data
R package, Los Angeles, CA.  Version 0.5, <a href="https://hpmrg.org">https://hpmrg.org</a>.
</p>
<p>Handcock MS (2003).  <span class="pkg">degreenet</span>: Models for Skewed Count Distributions
Relevant to Networks.  Statnet Project, Seattle, WA.  Version 1.2,
<a href="https://statnet.org">https://statnet.org</a>.
</p>
<p>Handcock, Mark S., Gile, Krista J. and Mar, Corinne M. (2014)
<em>Estimating Hidden Population Size using Respondent-Driven Sampling
Data</em>, Electronic Journal of Statistics, 8, 1, 1491-1521
</p>
<p>Handcock, Mark S., Gile, Krista J. and Mar, Corinne M. (2015)
<em>Estimating the Size of Populations at High Risk for HIV using Respondent-Driven 
Sampling Data</em>, Biometrics.
</p>


<h3>See Also</h3>

<p>The model fitting function <code><a href="#topic+posteriorsize">posteriorsize</a></code>,
<code><a href="graphics.html#topic+plot">plot</a></code>.
</p>
<p>Function <code><a href="stats.html#topic+coef">coef</a></code> will extract the matrix of coefficients with
standard errors, t-statistics and p-values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
data(fauxmadrona)
# Here interval=1 and samplesize=50 so that it will run faster. It should be much higher
# in a real application.
fit &lt;- posteriorsize(fauxmadrona, median.prior.size=1000,
                                  burnin=10, interval=1, samplesize=50)
summary(fit)
# Let's look at some MCMC diagnostics
plot(fit, mcmc=TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='posize_warning'>Warning message for posteriorsize fit failure</h2><span id='topic+posize_warning'></span>

<h3>Description</h3>

<p><code><a href="#topic+posteriorsize">posteriorsize</a></code> computes the posterior distribution of the
population size based on data collected by Respondent Driven Sampling.
This function returns the warning message if it fails. 
It enables packages that call <code><a href="#topic+posteriorsize">posteriorsize</a></code> to use
a consistent error message.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posize_warning()
</code></pre>


<h3>Value</h3>

<p><code><a href="#topic+posize_warning">posize_warning</a></code> returns a character string witn the warning message.
</p>


<h3>See Also</h3>

<p>posteriorsize
</p>

<hr>
<h2 id='pospreddeg'>Compute the posterior predictive p-values for the reported network sizes</h2><span id='topic+pospreddeg'></span>

<h3>Description</h3>

<p>This function extracts from an
estimate of the posterior distribution of the
population size based on data collected by Respondent Driven Sampling. The
approach approximates the RDS via the Sequential Sampling model of Gile
(2008).  As such, it is referred to as the Sequential Sampling - Population Size Estimate (SS-PSE).
It uses the order of selection of the sample to provide information
on the distribution of network sizes over the population members.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pospreddeg(x, order.by.recruitment.time = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pospreddeg_+3A_x">x</code></td>
<td>
<p>an object of class <code>"sspse"</code>, usually, a result of a call
to <code>oosteriorsize</code>.</p>
</td></tr>
<tr><td><code id="pospreddeg_+3A_order.by.recruitment.time">order.by.recruitment.time</code></td>
<td>
<p>logical; If <code>TRUE</code>, 
the reorder the input data by the recruitment time</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It computes the posterior predictive distribution for each reported network size 
and computes the percentile rank of the reported network size within that posterior.
The percentile rank should be about 0.5 for a well specified model, but could be close to
uniform if there is little information about the reported network size.
The percentile ranks should not be extreme (e.g., close to zero or one) on a consistent basis
as this indicates a misspecified model.
</p>


<h3>References</h3>

<p>Gile, Krista J. (2008) <em>Inference from Partially-Observed Network
Data</em>, Ph.D. Thesis, Department of Statistics, University of Washington.
</p>
<p>Gile, Krista J. and Handcock, Mark S. (2010) <em>Respondent-Driven
Sampling: An Assessment of Current Methodology</em>, Sociological Methodology
40, 285-327.
</p>
<p>Gile, Krista J. and Handcock, Mark S. (2014) <span class="pkg">sspse</span>: Estimating Hidden 
Population Size using Respondent Driven Sampling Data
R package, Los Angeles, CA.  Version 0.5, <a href="https://hpmrg.org/sspse/">https://hpmrg.org/sspse/</a>.
</p>
<p>Handcock MS (2003).  <span class="pkg">degreenet</span>: Models for Skewed Count Distributions
Relevant to Networks.  Statnet Project, Seattle, WA.  Version 1.2,
<a href="https://statnet.org/">https://statnet.org/</a>.
</p>
<p>Handcock, Mark S., Gile, Krista J. and Mar, Corinne M. (2014)
<em>Estimating Hidden Population Size using Respondent-Driven Sampling
Data</em>, Electronic Journal of Statistics, 8, 1, 1491-1521
</p>
<p>Handcock, Mark S., Gile, Krista J. and Mar, Corinne M. (2015)
<em>Estimating the Size of Populations at High Risk for HIV using Respondent-Driven 
Sampling Data</em>, Biometrics.
</p>


<h3>See Also</h3>

<p>The model fitting function <code><a href="#topic+posteriorsize">posteriorsize</a></code>,
<code><a href="graphics.html#topic+plot">plot</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
data(fauxmadrona)
# Here interval=1 so that it will run faster. It should be higher in a 
# real application.
fit &lt;- posteriorsize(fauxmadrona, median.prior.size=1000,
                                 burnin=20, interval=1, samplesize=100)
summary(fit)
# Let's look at some MCMC diagnostics
pospreddeg(fit)

## End(Not run)

</code></pre>

<hr>
<h2 id='posteriorsize'>Estimating hidden population size using RDS data</h2><span id='topic+posteriorsize'></span>

<h3>Description</h3>

<p><code><a href="#topic+posteriorsize">posteriorsize</a></code> computes the posterior distribution of the
population size based on data collected by Respondent Driven Sampling. The
approach approximates the RDS via the Sequential Sampling model of Gile
(2008). As such, it is referred to as the Sequential Sampling - Population Size Estimate (SS-PSE).
It uses the order of selection of the sample to provide information
on the distribution of network sizes over the population members.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posteriorsize(
  s,
  s2 = NULL,
  previous = NULL,
  median.prior.size = NULL,
  interval = 10,
  burnin = 5000,
  maxN = NULL,
  K = FALSE,
  samplesize = 1000,
  quartiles.prior.size = NULL,
  mean.prior.size = NULL,
  mode.prior.size = NULL,
  priorsizedistribution = c("beta", "flat", "nbinom", "pln", "supplied"),
  effective.prior.df = 1,
  sd.prior.size = NULL,
  mode.prior.sample.proportion = NULL,
  alpha = NULL,
  visibilitydistribution = c("cmp", "nbinom", "pln"),
  mean.prior.visibility = NULL,
  sd.prior.visibility = NULL,
  max.sd.prior.visibility = 4,
  df.mean.prior.visibility = 1,
  df.sd.prior.visibility = 3,
  beta_0.mean.prior = -3,
  beta_t.mean.prior = 0,
  beta_u.mean.prior = 0,
  beta_0.sd.prior = 10,
  beta_t.sd.prior = 10,
  beta_u.sd.prior = 10,
  mem.optimism.prior = NULL,
  df.mem.optimism.prior = 5,
  mem.scale.prior = 2,
  df.mem.scale.prior = 10,
  mem.overdispersion = 15,
  visibility = TRUE,
  type.impute = c("median", "distribution", "mode", "mean"),
  Np = 0,
  n = NULL,
  n2 = NULL,
  mu_proposal = 0.1,
  nu_proposal = 0.15,
  beta_0_proposal = 0.2,
  beta_t_proposal = 0.001,
  beta_u_proposal = 0.001,
  memmu_proposal = 0.1,
  memscale_proposal = 0.15,
  burnintheta = 500,
  burninbeta = 50,
  parallel = 1,
  parallel.type = "PSOCK",
  seed = NULL,
  maxbeta = 90,
  supplied = list(maxN = maxN),
  max.coupons = NULL,
  recruit.time = NULL,
  recruit.time2 = NULL,
  include.tree = TRUE,
  unit.scale = FALSE,
  optimism = TRUE,
  reflect.time = FALSE,
  equalize = TRUE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="posteriorsize_+3A_s">s</code></td>
<td>
<p>either a vector of integers or an <code>rds.data.frame</code> providing network 
size information.
If a <code>rds.data.frame</code> is passed and <code>visibility=TRUE</code>, the default, then
the measurement error model is to used, whereby latent visibilities are used in place 
of the reported network sizes as the size variable. If a vector of integers is passed these 
are the network sizes in sequential order of recording (and the measurement model is not used).</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_s2">s2</code></td>
<td>
<p>either a vector of integers or an <code>rds.data.frame</code> providing network 
size information for a second RDS sample subsequent to the first RDS recorded in <code class="reqn">s</code>.
If a <code>rds.data.frame</code> is passed and <code>visibility=TRUE</code>, the default, then
the measurement error model is to used, whereby latent visibilities are used in place 
of the reported network sizes as the size variable. If a vector of integers is passed these 
are the network sizes in sequential order of recording (and the measurement model is not used).</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_previous">previous</code></td>
<td>
<p>character; optionally, the name of the variable in <code class="reqn">s2</code>
indicating if the corresponding unit was sampled in the first RDS.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_median.prior.size">median.prior.size</code></td>
<td>
<p>scalar; A hyperparameter being the mode of the
prior distribution on the population size.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_interval">interval</code></td>
<td>
<p>count; the number of proposals between sampled statistics.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_burnin">burnin</code></td>
<td>
<p>count; the number of proposals before any MCMC sampling is
done. It typically is set to a fairly large number.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_maxn">maxN</code></td>
<td>
<p>integer; maximum possible population size. By default this is
determined from an upper quantile of the prior distribution.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_k">K</code></td>
<td>
<p>count; the maximum visibility for an individual. This is usually
calculated as <code>round(stats::quantile(s,0.80))</code>. It applies to network sizes and (latent) visibilities.
If logical and FALSE then the K is unbounded but set to compute the visibilities.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_samplesize">samplesize</code></td>
<td>
<p>count; the number of Monte-Carlo samples to draw to
compute the posterior. This is the number returned by the
Metropolis-Hastings algorithm.The default is 1000.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_quartiles.prior.size">quartiles.prior.size</code></td>
<td>
<p>vector of length 2; A pair of hyperparameters
being the lower and upper quartiles of the prior distribution on the
population size. For example, <br /> <code>quartiles.prior.size=c(1000,4000)</code>
corresponds to a prior where the lower quartile (25%) is 1000 and the upper
(75%) is 4000.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_mean.prior.size">mean.prior.size</code></td>
<td>
<p>scalar; A hyperparameter being the mean of the prior
distribution on the population size.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_mode.prior.size">mode.prior.size</code></td>
<td>
<p>scalar; A hyperparameter being the mode of the prior
distribution on the population size.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_priorsizedistribution">priorsizedistribution</code></td>
<td>
<p>character; the type of parametric distribution
to use for the prior on population size. The options are <code>beta</code> (for a
Beta prior on the sample proportion (i.e. <code class="reqn">n/N</code>)), <code>flat</code>
(uniform), <code>nbinom</code> (Negative-Binomial), and <code>pln</code>
(Poisson-log-normal). The default is <code>beta</code>.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_effective.prior.df">effective.prior.df</code></td>
<td>
<p>scalar; A hyperparameter being the effective
number of samples worth of information represented in the prior distribution
on the population size. By default this is 1, but it can be greater (or
less!) to allow for different levels of uncertainty.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_sd.prior.size">sd.prior.size</code></td>
<td>
<p>scalar; A hyperparameter being the standard deviation
of the prior distribution on the population size.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_mode.prior.sample.proportion">mode.prior.sample.proportion</code></td>
<td>
<p>scalar; A hyperparameter being the mode
of the prior distribution on the sample proportion <code class="reqn">n/N</code>.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_alpha">alpha</code></td>
<td>
<p>scalar; A hyperparameter being the first parameter of the beta
prior model for the sample proportion. By default this is NULL, meaning that
1 is chosen. it can be any value at least 1 to allow for different levels of
uncertainty.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_visibilitydistribution">visibilitydistribution</code></td>
<td>
<p>count; the parametric distribution to use for the
individual network sizes (i.e., degrees). The options are <code>cmp</code>,
<code>nbinom</code>, and <code>pln</code>.  These correspond to the
Conway-Maxwell-Poisson, Negative-Binomial, and Poisson-log-normal. The
default is <code>cmp</code>.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_mean.prior.visibility">mean.prior.visibility</code></td>
<td>
<p>scalar; A hyper parameter being the mean visibility for
the prior distribution for a randomly chosen person. The prior has this
mean.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_sd.prior.visibility">sd.prior.visibility</code></td>
<td>
<p>scalar; A hyper parameter being the standard deviation
of the visibility for a randomly chosen person.  The prior has this
standard deviation.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_max.sd.prior.visibility">max.sd.prior.visibility</code></td>
<td>
<p>scalar; The maximum allowed value of <code>sd.prior.visibility</code>.
If the passed or computed value is higher, it is reduced to this value.
This is done for numerical stability reasons.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_df.mean.prior.visibility">df.mean.prior.visibility</code></td>
<td>
<p>scalar; A hyper parameter being the degrees-of-freedom
of the prior for the mean. This gives the equivalent sample size that would
contain the same amount of information inherent in the prior.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_df.sd.prior.visibility">df.sd.prior.visibility</code></td>
<td>
<p>scalar; A hyper parameter being the degrees-of-freedom of
the prior for the standard deviation. This gives the equivalent sample size
that would contain the same amount of information inherent in the prior for
the standard deviation.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_beta_0.mean.prior">beta_0.mean.prior</code></td>
<td>
<p>scalar; A hyper parameter being the mean of the 
beta_0 parameter distribution in the model for the number of recruits.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_beta_t.mean.prior">beta_t.mean.prior</code></td>
<td>
<p>scalar; A hyper parameter being the mean of the 
beta_t parameter distribution in the model for the number of recruits. This corresponds to the time-to-recruit variable.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_beta_u.mean.prior">beta_u.mean.prior</code></td>
<td>
<p>scalar; A hyper parameter being the mean of the 
beta_u parameter distribution in the model for the number of recruits. This corresponds to the visibility variable.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_beta_0.sd.prior">beta_0.sd.prior</code></td>
<td>
<p>scalar; A hyper parameter being the standard deviation of the 
beta_0 parameter distribution in the model for the number of recruits.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_beta_t.sd.prior">beta_t.sd.prior</code></td>
<td>
<p>scalar; A hyper parameter being the standard deviation of the 
beta_t parameter distribution in the model for the number of recruits. This corresponds to the time-to-recruit variable.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_beta_u.sd.prior">beta_u.sd.prior</code></td>
<td>
<p>scalar; A hyper parameter being the standard deviation of the 
beta_u parameter distribution in the model for the number of recruits. This corresponds to the visibility variable.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_mem.optimism.prior">mem.optimism.prior</code></td>
<td>
<p>scalar; A hyper parameter being the mean of the 
distribution of the optimism parameter.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_df.mem.optimism.prior">df.mem.optimism.prior</code></td>
<td>
<p>scalar; A hyper parameter being the degrees-of-freedom
of the prior for the optimism parameter. This gives the equivalent sample size that would
contain the same amount of information inherent in the prior.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_mem.scale.prior">mem.scale.prior</code></td>
<td>
<p>scalar; A hyper parameter being the scale of the concentration of
baseline negative binomial measurement error model.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_df.mem.scale.prior">df.mem.scale.prior</code></td>
<td>
<p>scalar; A hyper parameter being the degrees-of-freedom of
the prior for the standard deviation of the dispersion parameter in the visibility model.
This gives the equivalent sample size
that would contain the same amount of information inherent in the prior for
the standard deviation.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_mem.overdispersion">mem.overdispersion</code></td>
<td>
<p>scalar; A parameter being the overdispersion of the negative binomial
distribution that is the baseline for the measurement error model.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_visibility">visibility</code></td>
<td>
<p>logical; Indicate if the measurement error model
is to be used, whereby latent visibilities are used in place of the reported 
network sizes as the unit size variable. If <code>TRUE</code> then a <code>rds.data.frame</code>
need to be passed to provide the RDS information needed for the measurement error model.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_type.impute">type.impute</code></td>
<td>
<p>The type of imputation to use for the summary visibilities 
(returned in the component <code>visibilities</code>. The imputes are based on the posterior 
draws of the visibilities. 
It can be of type <code>distribution</code>, <code>mode</code>,<code>median</code>, or <code>mean</code> 
with <code>median</code> the default, being the posterior median of the visibility for that person.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_np">Np</code></td>
<td>
<p>integer; The overall visibility distribution is a mixture of the
<code>Np</code> rates for <code>1:Np</code> and a parametric visibility distribution model
truncated below <code>Np</code>. Thus the model fits the proportions of the
population with visibility <code>1:Np</code> each with a separate parameter. This
should adjust for an lack-of-fit of the parametric visibility distribution model
at lower visibilities, although it also changes the model away from the
parametric visibility distribution model.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_n">n</code></td>
<td>
<p>integer; the number of people in the sample. This is usually computed from
<code class="reqn">s</code> automatically and not usually specified by the user.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_n2">n2</code></td>
<td>
<p>integer; If <code class="reqn">s2</code> is specified, this is the number of people in the second sample. 
This is usually computed from
<code class="reqn">s</code> automatically and not usually specified by the user.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_mu_proposal">mu_proposal</code></td>
<td>
<p>scalar; The standard deviation of the proposal
distribution for the mean visibility.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_nu_proposal">nu_proposal</code></td>
<td>
<p>scalar; The standard deviation of the proposal
distribution for the CMP scale parameter that determines the standard deviation of the visibility.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_beta_0_proposal">beta_0_proposal</code></td>
<td>
<p>scalar; The standard deviation of the proposal
distribution for the beta_0 parameter of the recruit model.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_beta_t_proposal">beta_t_proposal</code></td>
<td>
<p>scalar; The standard deviation of the proposal
distribution for the beta_t parameter of the recruit model. This corresponds to the visibility variable.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_beta_u_proposal">beta_u_proposal</code></td>
<td>
<p>scalar; The standard deviation of the proposal
distribution for the beta_u parameter of the recruit model. This corresponds to the time-to-recruit variable.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_memmu_proposal">memmu_proposal</code></td>
<td>
<p>scalar; The standard deviation of the proposal
distribution for the log of the optimism parameter (that is, gamma).</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_memscale_proposal">memscale_proposal</code></td>
<td>
<p>scalar; The standard deviation of the proposal
distribution for the log of the s.d. in the optimism model.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_burnintheta">burnintheta</code></td>
<td>
<p>count; the number of proposals in the Metropolis-Hastings
sub-step for the visibility distribution parameters (<code class="reqn">\theta</code>) before any
MCMC sampling is done. It typically is set to a modestly large number.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_burninbeta">burninbeta</code></td>
<td>
<p>count; the number of proposals in the Metropolis-Hastings
sub-step for the visibility distribution parameters (<code class="reqn">\beta</code>) before any
MCMC sampling is done. It typically is set to a modestly large number.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_parallel">parallel</code></td>
<td>
<p>count; the number of parallel processes to run for the
Monte-Carlo sample.  This uses MPI or PSOCK. The default is 1, that is not to
use parallel processing.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_parallel.type">parallel.type</code></td>
<td>
<p>The type of parallel processing to use. The options are
&quot;PSOCK&quot; or &quot;MPI&quot;. This requires the corresponding type to be installed.
The default is &quot;PSOCK&quot;.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_seed">seed</code></td>
<td>
<p>integer; random number integer seed.  Defaults to <code>NULL</code> to
use whatever the state of the random number generator is at the time of the
call.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_maxbeta">maxbeta</code></td>
<td>
<p>scalar; The maximum allowed value of the <code>beta</code> parameter.
If the implied or computed value is higher, it is reduced to this value.
This is done for numerical stability reasons.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_supplied">supplied</code></td>
<td>
<p>list; If supplied, is a list with components <code>maxN</code> and
<code>sample</code>. In this case <code>supplied</code> is a matrix with a column named
<code>N</code> being a sample from a prior distribution for the population size.
The value <code>maxN</code> specifies the maximum value of the population size, a
priori.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_max.coupons">max.coupons</code></td>
<td>
<p>The number of recruitment coupons distributed to each 
enrolled subject (i.e. the maximum number of recruitees for any subject).
By default it is taken by the attribute or data, else the maximum recorded number of coupons.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_recruit.time">recruit.time</code></td>
<td>
<p>vector; An optional value for the data/time that the person was interviewed.
It needs to resolve as a numeric vector with number of elements the number
of rows of the data with non-missing values of the network variable. If it
is a character name of a variable in the data then that variable is used.
If it is NULL then the sequence number of the recruit in the data is used.
If it is NA then the recruitment is not used in the model.
Otherwise, the recruitment time is used in the model to better predict
the visibility of the person.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_recruit.time2">recruit.time2</code></td>
<td>
<p>vector; An optional value for the data/time that the person in the second RDS survey was interviewed.
It needs to resolve as a numeric vector with number of elements the number
of rows of the data with non-missing values of the network variable. If it
is a character name of a variable in the data then that variable is used.
If it is NULL, the default, then the sequence number of the recruit in the data is used.
If it is NA then the recruitment is not used in the model.
Otherwise, the recruitment time is used in the model to better predict
the visibility of the person.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_include.tree">include.tree</code></td>
<td>
<p>logical; If <code>TRUE</code>, 
augment the reported network size by the number of recruits and one for the recruiter (if any).
This reflects a more accurate value for the visibility, but is not the self-reported degree.
In particular, it typically produces a positive visibility (compared to a
possibility zero self-reported degree).</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_unit.scale">unit.scale</code></td>
<td>
<p>numeric; If not <code>NULL</code> it sets the numeric value of the scale parameter
of the distribution of the unit sizes.
For the negative binomial, it is the multiplier on the variance of the negative binomial 
compared to a Poisson (via the Poisson-Gamma mixture representation). Sometimes the scale is 
unnaturally large (e.g. 40) so this give the option of fixing it (rather than using
the MLE of it). The model is fit with the parameter fixed at this passed value.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_optimism">optimism</code></td>
<td>
<p>logical; If <code>TRUE</code> then add a term to the model allowing
the (proportional) inflation of the self-reported degrees relative to the unit sizes.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_reflect.time">reflect.time</code></td>
<td>
<p>logical; If <code>TRUE</code> then the <code>recruit.time</code> is the time before the 
end of the study (instead of the time since the survey started or chronological time).</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_equalize">equalize</code></td>
<td>
<p>logical; If <code>TRUE</code> and the capture-recapture model is used, adjusts for gross differences in the 
reported network sizes between the two samples.</p>
</td></tr>
<tr><td><code id="posteriorsize_+3A_verbose">verbose</code></td>
<td>
<p>logical; if this is <code>TRUE</code>, the program will print out
additional information, including goodness of fit statistics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+posteriorsize">posteriorsize</a></code> returns a list consisting of the
following elements:
</p>
<table>
<tr><td><code>pop</code></td>
<td>
<p>vector; The final posterior draw for the
degrees of the population. The first <code class="reqn">n</code> are the sample in sequence and
the reminder are non-sequenced.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>count; the maximum visibility for an
individual. This is usually calculated as twice the maximum observed
degree.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>count; the sample size.</p>
</td></tr>
<tr><td><code>samplesize</code></td>
<td>
<p>count; the
number of Monte-Carlo samples to draw to compute the posterior. This is the
number returned by the Metropolis-Hastings algorithm.The default is 1000.</p>
</td></tr>
<tr><td><code>burnin</code></td>
<td>
<p>count; the number of proposals before any MCMC sampling is
done. It typically is set to a fairly large number.</p>
</td></tr>
<tr><td><code>interval</code></td>
<td>
<p>count; the number of proposals between sampled statistics.</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>scalar; The
hyper parameter <code>mean.prior.visibility</code> being the mean visibility for the prior
distribution for a randomly chosen person. The prior has this mean.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>scalar; The hyper parameter <code>sigma</code> being the
standard deviation of the visibility for a randomly chosen person. The prior has
this standard deviation.</p>
</td></tr>
<tr><td><code>df.mean.prior.visibility</code></td>
<td>
<p>scalar; A hyper parameter
being the degrees-of-freedom of the prior for the mean. This gives the
equivalent sample size that would contain the same amount of information
inherent in the prior.</p>
</td></tr>
<tr><td><code>df.sd.prior.visibility</code></td>
<td>
<p>scalar; A hyper parameter being
the degrees-of-freedom of the prior for the standard deviation. This gives
the equivalent sample size that would contain the same amount of information
inherent in the prior for the standard deviation.</p>
</td></tr>
<tr><td><code>Np</code></td>
<td>
<p>integer; The
overall visibility distribution is a mixture of the <code>1:Np</code> rates and a
parametric visibility distribution model truncated below Np. Thus the model fits
the proportions of the population with visibility <code>1:Np</code> each with a
separate parameter. This should adjust for an lack-of-fit of the parametric
visibility distribution model at lower visibilities, although it also changes the
model away from the parametric visibility distribution model.</p>
</td></tr>
<tr><td><code>mu_proposal</code></td>
<td>
<p>scalar; The standard deviation of the proposal
distribution for the mean visibility.</p>
</td></tr>
<tr><td><code>nu_proposal</code></td>
<td>
<p>scalar; The standard
deviation of the proposal distribution for the CMP scale parameter of the
visibility distribution.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>vector of length 5; summary statistics for the posterior
population size.
</p>

<dl>
<dt>MAP</dt><dd><p>maximum aposteriori value of N</p>
</dd>
<dt>Mean AP</dt><dd><p>mean aposteriori value of N</p>
</dd>
<dt>Median AP</dt><dd><p>median aposteriori value of N</p>
</dd>
<dt>P025</dt><dd><p>the 2.5th
percentile of the (posterior) distribution for the N. That is, the lower
point on a 95% probability interval.</p>
</dd>
<dt>P975</dt><dd><p>the 97.5th
percentile of the (posterior) distribution for the N. That is, the upper
point on a 95% probability interval.</p>
</dd> </dl>
 </td></tr>
<tr><td><code>maxN</code></td>
<td>
<p>integer; maximum
possible population size. By default this is determined from an upper
quantile of the prior distribution.</p>
</td></tr>
<tr><td><code>sample</code></td>
<td>
<p>matrix of dimension
<code>samplesize</code><code class="reqn">\times</code> <code>10</code> matrix of summary statistics from
the posterior. This is also an object of class <code>mcmc</code> so it can be
plotted and summarized via the <code>mcmc.diagnostics</code> function in the
<code>ergm</code> package (and also the <code>coda</code> package). The statistics are:
</p>

<dl>
<dt>N</dt><dd><p>population size.</p>
</dd>
<dt>mu</dt><dd><p>scalar; The mean
visibility for the prior distribution for a randomly chosen person. The prior
has this mean.</p>
</dd>
<dt>sigma</dt><dd><p>scalar; The standard deviation of the visibility
for a randomly chosen person. The prior has this standard deviation.</p>
</dd>
<dt>visibility1</dt><dd><p>scalar; the number of nodes of visibility 1 in the population (it
is assumed all nodes have visibility 1 or more).</p>
</dd>
<dt>lambda</dt><dd><p>scalar; This is
only present for the <code>cmp</code> model. It is the <code class="reqn">\lambda</code> parameter in
the standard parameterization of the Conway-Maxwell-Poisson model for the
visibility distribution.</p>
</dd>
<dt>nu</dt><dd><p>scalar; This is only present for the
<code>cmp</code> model. It is the <code class="reqn">\nu</code> parameter in the standard
parameterization of the Conway-Maxwell-Poisson model for the visibility
distribution.</p>
</dd> </dl>
 </td></tr>
<tr><td><code>vsample</code></td>
<td>
<p>matrix of dimension <code>samplesize</code><code class="reqn">\times</code> <code>n</code> matrix of 
posterior draws from the unit size distribution for those in the survey.
The sample for the <code>i</code>th person is the <code>i</code>th column.</p>
</td></tr>
<tr><td><code>lpriorm</code></td>
<td>
<p>vector; the vector of (log) prior
probabilities on each value of <code class="reqn">m=N-n</code> - that is, the number of
unobserved members of the population. The values are
<code>n:(length(lpriorm)-1+n)</code>.</p>
</td></tr>
<tr><td><code>burnintheta</code></td>
<td>
<p>count; the number of
proposals in the Metropolis-Hastings sub-step for the visibility distribution
parameters (<code class="reqn">\theta</code>) before any MCMC sampling is done. It typically is
set to a modestly large number.</p>
</td></tr>
<tr><td><code>verbose</code></td>
<td>
<p>logical; if this is
<code>TRUE</code>, the program printed out additional information, including
goodness of fit statistics.</p>
</td></tr>
<tr><td><code>predictive.visibility.count</code></td>
<td>
<p>vector; a vector
of length the maximum visibility (<code>K</code>) (by default <br /> <code>K=2*max(sample
visibility)</code>).  The <code>k</code>th entry is the posterior predictive number persons
with visibility <code>k</code>.  That is, it is the posterior predictive distribution
of the number of people with each visibility in the population.</p>
</td></tr>
<tr><td><code>predictive.visibility</code></td>
<td>
<p>vector; a vector of length the maximum visibility
(<code>K</code>) (by default <br /> <code>K=2*max(sample visibility)</code>).  The <code>k</code>th entry
is the posterior predictive proportion of persons with visibility <code>k</code>.
That is, it is the posterior predictive distribution of the proportion of
people with each visibility in the population.</p>
</td></tr>
<tr><td><code>MAP</code></td>
<td>
<p>vector of length 6
of MAP estimates corresponding to the output <code>sample</code>. These are:
</p>

<dl>
<dt>N</dt><dd><p>population size.</p>
</dd>
<dt>mu</dt><dd><p>scalar; The mean
visibility for the prior distribution for a randomly chosen person. The prior
has this mean.</p>
</dd>
<dt>sigma</dt><dd><p>scalar; The standard deviation of the visibility
for a randomly chosen person. The prior has this standard deviation.</p>
</dd>
<dt>visibility1</dt><dd><p>scalar; the number of nodes of visibility 1 in the population (it
is assumed all nodes have visibility 1 or more).</p>
</dd>
<dt>lambda</dt><dd><p>scalar; This is
only present for the <code>cmp</code> model. It is the <code class="reqn">\lambda</code> parameter in
the standard parameterization of the Conway-Maxwell-Poisson model for the
visibility distribution.</p>
</dd>
<dt>nu</dt><dd><p>scalar; This is only present for the
<code>cmp</code> model. It is the <code class="reqn">\nu</code> parameter in the standard
parameterization of the Conway-Maxwell-Poisson model for the visibility
distribution.</p>
</dd> </dl>
 </td></tr>
<tr><td><code>mode.prior.sample.proportion</code></td>
<td>
<p>scalar; A
hyperparameter being the mode of the prior distribution on the sample
proportion <code class="reqn">n/N</code>.</p>
</td></tr>
<tr><td><code>median.prior.size</code></td>
<td>
<p>scalar; A hyperparameter
being the mode of the prior distribution on the population size.</p>
</td></tr>
<tr><td><code>mode.prior.size</code></td>
<td>
<p>scalar; A hyperparameter being the mode of the prior
distribution on the population size.</p>
</td></tr>
<tr><td><code>mean.prior.size</code></td>
<td>
<p>scalar; A
hyperparameter being the mean of the prior distribution on the population
size.</p>
</td></tr>
<tr><td><code>quartiles.prior.size</code></td>
<td>
<p>vector of length 2; A pair of
hyperparameters being the lower and upper quartiles of the prior
distribution on the population size.</p>
</td></tr>
<tr><td><code>visibilitydistribution</code></td>
<td>
<p>count; the
parametric distribution to use for the individual network sizes (i.e.,
visibilities). The options are <code>cmp</code>, <code>nbinom</code>, and <code>pln</code>.  These
correspond to the Conway-Maxwell-Poisson, Negative-Binomial, and
Poisson-log-normal. The default is <code>cmp</code>.</p>
</td></tr>
<tr><td><code>priorsizedistribution</code></td>
<td>
<p>character; the type of parametric distribution
to use for the prior on population size. The options are <code>beta</code> (for a
Beta prior on the sample proportion (i.e. <code class="reqn">n/N</code>), <code>nbinom</code>
(Negative-Binomial), <code>pln</code> (Poisson-log-normal), <code>flat</code> (uniform),
and <code>continuous</code> (the continuous version of the Beta prior on the
sample proportion. The default is <code>beta</code>. </p>
</td></tr>
</table>


<h3>Details on priors</h3>

<p>The best way to specify the prior is via the
hyperparameter <code>mode.prior.size</code> which specifies the mode of the prior
distribution on the population size. You can alternatively specify the
hyperparameter <code>median.prior.size</code> which specifies the median of the
prior distribution on the population size, or <code>mean.prior.sample
proportion</code> which specifies the mean of the prior distribution on the
proportion of the population size in the sample or <code>mode.prior.sample
proportion</code> which specifies the mode of the prior distribution on the
proportion of the population size in the sample. Finally, you can specify
<code>quartiles.prior.size</code> as a vector of length 2 being the pair of lower
and upper quartiles of the prior distribution on the population size.
</p>


<h3>References</h3>

<p>Gile, Krista J. (2008) <em>Inference from Partially-Observed Network
Data</em>, Ph.D. Thesis, Department of Statistics, University of Washington.
</p>
<p>Gile, Krista J. and Handcock, Mark S. (2010) <em>Respondent-Driven
Sampling: An Assessment of Current Methodology</em>, Sociological Methodology
40, 285-327.
</p>
<p>Gile, Krista J. and Handcock, Mark S. (2014) <span class="pkg">sspse</span>: Estimating Hidden 
Population Size using Respondent Driven Sampling Data
R package, Los Angeles, CA.  Version 0.5, <a href="https://hpmrg.org/sspse/">https://hpmrg.org/sspse/</a>.
</p>
<p>Handcock MS (2003).  <span class="pkg">degreenet</span>: Models for Skewed Count Distributions
Relevant to Networks.  Statnet Project, Seattle, WA.  Version 1.2,
<a href="https://statnet.org/">https://statnet.org/</a>.
</p>
<p>Handcock, Mark S., Gile, Krista J. and Mar, Corinne M. (2014)
<em>Estimating Hidden Population Size using Respondent-Driven Sampling
Data</em>, Electronic Journal of Statistics, 8, 1, 1491-1521
</p>
<p>Handcock, Mark S., Gile, Krista J. and Mar, Corinne M. (2015)
<em>Estimating the Size of Populations at High Risk for HIV using Respondent-Driven 
Sampling Data</em>, Biometrics.
</p>


<h3>See Also</h3>

<p>network, statnet, degreenet
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(fauxmadrona)
# Here interval=1 so that it will run faster. It should be higher in a 
# real application.
fit &lt;- posteriorsize(fauxmadrona, median.prior.size=1000,
                                 burnin=20, interval=1, samplesize=100)
summary(fit)
</code></pre>

<hr>
<h2 id='print.summary.sspse'>Summarizing Population Size Estimation Model Fits</h2><span id='topic+print.summary.sspse'></span>

<h3>Description</h3>

<p>This is the <code>print</code> method for the <code>summary</code> class method for class <code>"sspse"</code> objects.
These objects encapsulate an estimate of the posterior distribution of
the population size based on data collected by Respondent Driven Sampling.
The approach approximates the RDS via the Sequential Sampling model of Gile
(2008).  As such, it is referred to as the Sequential Sampling - Population Size Estimate (SS-PSE).
It uses the order of selection of the sample to provide information
on the distribution of network sizes over the population members.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.sspse'
print(
  x,
  digits = max(3, getOption("digits") - 3),
  correlation = FALSE,
  covariance = FALSE,
  signif.stars = getOption("show.signif.stars"),
  eps.Pvalue = 1e-04,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.sspse_+3A_x">x</code></td>
<td>
<p>an object of class <code>"summary.sspse"</code>, usually, a result of a
call to <code>summary.sspse</code>.</p>
</td></tr>
<tr><td><code id="print.summary.sspse_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing.</p>
</td></tr>
<tr><td><code id="print.summary.sspse_+3A_correlation">correlation</code></td>
<td>
<p>logical; if <code>TRUE</code>, the correlation matrix of the
estimated parameters is returned and printed.</p>
</td></tr>
<tr><td><code id="print.summary.sspse_+3A_covariance">covariance</code></td>
<td>
<p>logical; if <code>TRUE</code>, the covariance matrix of the
estimated parameters is returned and printed.</p>
</td></tr>
<tr><td><code id="print.summary.sspse_+3A_signif.stars">signif.stars</code></td>
<td>
<p>logical. If <code>TRUE</code>, &lsquo;significance stars&rsquo; are
printed for each coefficient.</p>
</td></tr>
<tr><td><code id="print.summary.sspse_+3A_eps.pvalue">eps.Pvalue</code></td>
<td>
<p>number; indicates the smallest p-value. 
<code><a href="stats.html#topic+printCoefmat">printCoefmat</a></code>.</p>
</td></tr>
<tr><td><code id="print.summary.sspse_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>print.summary.sspse</code> tries to be smart about formatting the
coefficients, standard errors, etc. and additionally gives
&lsquo;significance stars&rsquo; if <code>signif.stars</code> is <code>TRUE</code>.
</p>
<p>Aliased coefficients are omitted in the returned object but restored by the
<code>print</code> method.
</p>
<p>Correlations are printed to two decimal places (or symbolically): to see the
actual correlations print <code>summary(object)$correlation</code> directly.
</p>


<h3>Value</h3>

<p>The function <code>summary.sspse</code> computes and returns a two row matrix of
summary statistics of the prior and estimated posterior distributions. 
The rows correspond to the <code>Prior</code> and the <code>Posterior</code>, respectively. 
The rows names are <code>Mean</code>, <code>Median</code>, <code>Mode</code>, 
<code>25%</code>, <code>75%</code>, and <code>90%</code>.
These correspond to the distributional mean, median, mode, lower quartile,
upper quartile and 90% quantile, respectively.
</p>


<h3>References</h3>

<p>Gile, Krista J. (2008) <em>Inference from Partially-Observed Network
Data</em>, Ph.D. Thesis, Department of Statistics, University of Washington.
</p>
<p>Gile, Krista J. and Handcock, Mark S. (2010) <em>Respondent-Driven
Sampling: An Assessment of Current Methodology</em>, Sociological Methodology
40, 285-327.
</p>
<p>Gile, Krista J. and Handcock, Mark S. (2014) <span class="pkg">sspse</span>: Estimating Hidden 
Population Size using Respondent Driven Sampling Data
R package, Los Angeles, CA.  Version 0.5, <a href="https://hpmrg.org/sspse/">https://hpmrg.org/sspse/</a>.
</p>
<p>Handcock MS (2003).  <span class="pkg">degreenet</span>: Models for Skewed Count Distributions
Relevant to Networks.  Statnet Project, Seattle, WA.  Version 1.2,
<a href="https://statnet.org/">https://statnet.org/</a>.
</p>
<p>Handcock, Mark S., Gile, Krista J. and Mar, Corinne M. (2014)
<em>Estimating Hidden Population Size using Respondent-Driven Sampling
Data</em>, Electronic Journal of Statistics, 8, 1, 1491-1521
</p>
<p>Handcock, Mark S., Gile, Krista J. and Mar, Corinne M. (2015)
<em>Estimating the Size of Populations at High Risk for HIV using Respondent-Driven 
Sampling Data</em>, Biometrics.
</p>


<h3>See Also</h3>

<p>The model fitting function <code><a href="#topic+posteriorsize">posteriorsize</a></code>,
<code><a href="base.html#topic+summary">summary</a></code>.
</p>
<p>Function <code><a href="stats.html#topic+coef">coef</a></code> will extract the matrix of coefficients with
standard errors, t-statistics and p-values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(fauxmadrona)
# Here interval=1 so that it will run faster. It should be higher in a 
# real application.
fit &lt;- posteriorsize(fauxmadrona, median.prior.size=1000,
                                 burnin=20, interval=1, samplesize=100)
fit

</code></pre>

<hr>
<h2 id='sspse-package'>Estimating Hidden Population Size using Respondent Driven Sampling Data</h2><span id='topic+sspse'></span><span id='topic+sspse-package'></span>

<h3>Description</h3>

<p>An integrated set of tools to estimate the size of a networked population
based on respondent-driven sampling data. The &quot;sspse&quot; packages is part of
the &quot;RDS Analyst&quot; suite of packages for the analysis of respondent-driven
sampling data.  For a list of functions type:
help(package='sspse')
</p>


<h3>Details</h3>

<p>For a complete list of the functions, use <code>library(help="sspse")</code> or
read the rest of the manual.
</p>
<p>When publishing results obtained using this package the original authors are
to be cited as:
</p>
<p>Gile, Krista J. and Handcock, Mark S. (2018) <span class="pkg">sspse</span>: Estimating Hidden 
Population Size using Respondent Driven Sampling Data
R package, Los Angeles, CA.  Version 0.8, <a href="https://hpmrg.org/sspse/">https://hpmrg.org/sspse/</a>.
</p>
<p>All programs derived from this package must cite it. For complete citation
information, use<br /> <code>citation(package="sspse")</code>.
</p>
<p>The package can also be accessed via graphical user interface
provided by the <code>RDS Analyst</code> software. 
<code>RDS Analyst</code> software was designed to help researchers
visualize and analyze data collected via respondent-driven sampling designs.
It has a broad range of estimation and visualization capabilities.
</p>
<p>For detailed information on how to download and install the software, go to
the Hard-to-Reach Population Methods Research Group website: <a href="https://hpmrg.org/">https://hpmrg.org/</a>.
A tutorial, support
newsgroup, references and links to further resources are provided there.
</p>


<h3>Author(s)</h3>

<p>Krista J. Gile <a href="mailto:gile@math.umass.edu">gile@math.umass.edu</a>,<br />
Mark S. Handcock <a href="mailto:handcock@stat.ucla.edu">handcock@stat.ucla.edu</a>
</p>
<p>Maintainer: Mark S. Handcock <a href="mailto:handcock@stat.ucla.edu">handcock@stat.ucla.edu</a>
</p>


<h3>References</h3>

<p>Gile, Krista J. (2008) <em>Inference from Partially-Observed Network
Data</em>, Ph.D. Thesis, Department of Statistics, University of Washington.
</p>
<p>Gile, Krista J. and Handcock, Mark S. (2010) <em>Respondent-Driven
Sampling: An Assessment of Current Methodology</em>, Sociological Methodology
40, 285-327.
</p>
<p>Gile, Krista J. and Handcock, Mark S. (2018) <span class="pkg">sspse</span>: Estimating Hidden 
Population Size using Respondent Driven Sampling Data
R package, Los Angeles, CA.  Version 0.8, <a href="https://hpmrg.org/sspse/">https://hpmrg.org/sspse/</a>.
</p>
<p>Handcock MS (2003).  <span class="pkg">degreenet</span>: Models for Skewed Count Distributions
Relevant to Networks.  Statnet Project, Seattle, WA.  Version 1.2,
<a href="https://statnet.org/">https://statnet.org/</a>.
</p>
<p>Handcock, Mark S., Gile, Krista J. and Mar, Corinne M. (2014)
<em>Estimating Hidden Population Size using Respondent-Driven Sampling
Data</em>, Electronic Journal of Statistics, 8, 1, 1491-1521
</p>
<p>Handcock, Mark S., Gile, Krista J. and Mar, Corinne M. (2015)
<em>Estimating the Size of Populations at High Risk for HIV using Respondent-Driven 
Sampling Data</em>, Biometrics.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://hpmrg.org">https://hpmrg.org</a>
</p>
</li></ul>


<hr>
<h2 id='summary.sspse'>Summarizing Population Size Estimation Model Fits</h2><span id='topic+summary.sspse'></span>

<h3>Description</h3>

<p>This is the <code>summary</code> method for class <code>"sspse"</code> objects.
These objects encapsulate an estimate of the posterior distribution of
the population size based on data collected by Respondent Driven Sampling.
The approach approximates the RDS via the Sequential Sampling model of Gile
(2008).  As such, it is referred to as the Sequential Sampling - Population Size Estimate (SS-PSE).
It uses the order of selection of the sample to provide information
on the distribution of network sizes over the population members.
<code>summary</code> method for class <code>"sspse"</code>. posterior distribution of
the population size based on data collected by Respondent Driven Sampling.
The approach approximates the RDS via the Sequential Sampling model of Gile
(2008). As such, it is referred to as the Sequential Sampling - Population Size Estimate (SS-PSE).
It uses the order of selection of the sample to provide information
on the distribution of network sizes over the population members.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sspse'
summary(object, support = 1000, HPD.level = 0.95, method = "bgk", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.sspse_+3A_object">object</code></td>
<td>
<p>an object of class <code>"sspse"</code>, usually, a result of a call
to <code><a href="#topic+posteriorsize">posteriorsize</a></code>.</p>
</td></tr>
<tr><td><code id="summary.sspse_+3A_support">support</code></td>
<td>
<p>the number of equally-spaced points to use for the support of
the estimated posterior density function.</p>
</td></tr>
<tr><td><code id="summary.sspse_+3A_hpd.level">HPD.level</code></td>
<td>
<p>numeric; probability level of the highest probability
density interval determined from the estimated posterior.</p>
</td></tr>
<tr><td><code id="summary.sspse_+3A_method">method</code></td>
<td>
<p>character; The method to use for density estimation (default Gaussian Kernel; &quot;bgk&quot;).
&quot;Bayes&quot; uses a Bayesian density estimator which has good properties.</p>
</td></tr>
<tr><td><code id="summary.sspse_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>print.summary.sspse</code> tries to be smart about formatting the
coefficients, standard errors, etc. and additionally gives
&lsquo;significance stars&rsquo; if <code>signif.stars</code> is <code>TRUE</code>.
</p>
<p>Aliased coefficients are omitted in the returned object but restored by the
<code>print</code> method.
</p>
<p>Correlations are printed to two decimal places (or symbolically): to see the
actual correlations print <code>summary(object)$correlation</code> directly.
</p>


<h3>Value</h3>

<p>The function <code>summary.sspse</code> computes and returns a two row matrix of
summary statistics of the prior and estimated posterior distributions. The rows correspond to the <code>Prior</code> and the
<code>Posterior</code>, respectively. 
The rows names are <code>Mean</code>, <code>Median</code>, <code>Mode</code>, <code>25%</code>, <code>75%</code>, and <code>90%</code>.
These correspond to the distributional mean, median, mode, lower quartile, upper quartile and 90% quantile, respectively.
</p>


<h3>See Also</h3>

<p>The model fitting function <code><a href="#topic+posteriorsize">posteriorsize</a></code>,
<code><a href="base.html#topic+summary">summary</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(fauxmadrona)
# Here interval=1 so that it will run faster. It should be higher in a 
# real application.
fit &lt;- posteriorsize(fauxmadrona, median.prior.size=1000,
                                 burnin=20, interval=1, samplesize=100)
summary(fit)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
