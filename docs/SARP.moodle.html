<!DOCTYPE html><html lang="fr"><head><title>Help for package SARP.moodle</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SARP.moodle}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SARP.moodle'>
<p>Création de questions Moodle au format XML avec R</p></a></li>
<li><a href='#affichage.moodle'>
<p>Aide aux affichages dans les textes des questions</p></a></li>
<li><a href='#categorie.moodle'>
<p>Créer une catégorie de questions</p></a></li>
<li><a href='#csv_glossaire.moodle'>
<p>Convertir un fichier CSV en glossaire Moodle</p></a></li>
<li><a href='#csv_optique.moodle'>
<p>Convertir un fichier CSV en questions Moodle</p></a></li>
<li><a href='#csv.moodle'>
<p>Convertir un fichier CSV, ODS ou XLSX en questions Moodle</p></a></li>
<li><a href='#debuter_xml.moodle'>
<p>Commencer et terminer un questionnaire Moodle</p></a></li>
<li><a href='#definir_dossier.image.moodle'>
<p>Insérer une image dans une question</p></a></li>
<li><a href='#description.moodle'>
<p>Créer une question Moodle contenant simplement du texte</p></a></li>
<li><a href='#df.moodle'>
<p>Convertir une data.frame en questions Moodle</p></a></li>
<li><a href='#glisser_deposer.moodle'>
<p>Créer une question demandant de placer des éléments à des positions</p>
précises d'une image</a></li>
<li><a href='#glisser_textes.moodle'>
<p>Créer une question demandant de replacer des mots dans un texte</p></a></li>
<li><a href='#glossaire.moodle'>
<p>Commencer et terminer la génération de glossaires Moodle</p></a></li>
<li><a href='#inserer_formule.moodle'>
<p>Insérer une formule mathématique, comme image, grâce à latex</p></a></li>
<li><a href='#inserer_SMILES.moodle'>
<p>Insérer une formule chimique, comme image, grâce à openbabel</p></a></li>
<li><a href='#legender_image.moodle'>
<p>Créer une question demandant de placer des éléments à des positions</p>
précises d'une image</a></li>
<li><a href='#libre.moodle'>
<p>Créer une question libre (« cloze », texte à compléter)</p></a></li>
<li><a href='#lier_fichier.moodle'>
<p>Insérer un lien vers un fichier dans une question</p></a></li>
<li><a href='#messages.moodle'>
<p>Aide aux affichages dans les textes des questions</p></a></li>
<li><a href='#numerique.moodle'>
<p>Créer une question à réponse numérique simple</p></a></li>
<li><a href='#ouverte.moodle'>
<p>Créer une question à réponse ouverte (rédactionnelle)</p></a></li>
<li><a href='#qcm.moodle'>
<p>Créer une question à choix (réponse unique ou réponses multiples)</p></a></li>
<li><a href='#qroc.moodle'>
<p>Créer une question à réponse ouverte, courte</p></a></li>
<li><a href='#question.moodle'>
<p>Créer une question Moodle au format XML</p></a></li>
<li><a href='#sortie_R.moodle'>
<p>Insérer une sortie de R dans une question</p></a></li>
<li><a href='#vf.moodle'>
<p>Créer une question à deux réponses possibles, dont une seule vraie</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>XML Output Functions for Easy Creation of Moodle Questions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-05-31</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Emmanuel Curis &lt;emmanuel.curis@parisdescartes.fr&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/Artistic-2.0">Artistic-2.0</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a set of basic functions for creating Moodle XML
 output files suited for importing questions in Moodle (a learning
 management system, see <a href="https://moodle.org/">https://moodle.org/</a> for more information).</td>
</tr>
<tr>
<td>Suggests:</td>
<td>readODS,openxlsx</td>
</tr>
<tr>
<td>Depends:</td>
<td>base64enc</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats,utils</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>fr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-07 18:00:13 UTC; curis</td>
</tr>
<tr>
<td>Author:</td>
<td>Emmanuel Curis <a href="https://orcid.org/0000-0001-8382-1493"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Virginie Lasserre [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-07 19:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='SARP.moodle'>
Création de questions Moodle au format XML avec R
</h2><span id='topic+SARP.moodle'></span><span id='topic+SARP.moodle-package'></span>

<h3>Description</h3>

<p>Cette bibliothèque permet de générer un fichier de questions pour
Moodle, au format XML, sans avoir à connaître ce format. Les questions
peuvent être construites à partir d'un fichier CSV ou directement à
partir de fonctions R.
</p>


<h3>Details</h3>

<p>Cette bibliothèque permet de faciliter la création de questions pour
les tests Moodle : elle génère un fichier XML qui peut être importé
dans la base de questions d'un cours Moodle. Il est ensuite possible
de piocher dans ces questions pour créer un test.  Afin d'éviter toute
confusion avec d'autres fonctions, toutes les fonctions de cette
bibliothèque se terminent par le suffixe <code>.moodle</code>.
</p>
<p>L'utilisation la plus simple est la conversion d'un fichier CSV (ou
tout autre format texte lisible par <code><a href="utils.html#topic+read.table">read.table</a></code>) avec une
ligne par question au format XML (<code><a href="#topic+csv.moodle">csv.moodle</a></code>). Mais il
est aussi possible de créer les questions directement dans R, en
créant le fichier XML (<code><a href="#topic+debuter_xml.moodle">debuter_xml.moodle</a></code>) puis en
appelant les fonctions appropriées. Dans ce cas, il ne faut pas
oublier de clore le fichier avant de l'importer
(<code><a href="#topic+finir_xml.moodle">finir_xml.moodle</a></code>).
</p>
<p>La plupart des types de questions de base de Moodle sont connus :
vrai-faux (<code><a href="#topic+vrai_faux.moodle">vrai_faux.moodle</a></code>), questions à choix parmi
des réponses prédéfinies (<code><a href="#topic+qcm.moodle">qcm.moodle</a></code>), questions à
réponse numérique (<code><a href="#topic+numerique.moodle">numerique.moodle</a></code>), questions à
réponse libre (<code><a href="#topic+qroc.moodle">qroc.moodle</a></code>,
<code><a href="#topic+question_ouverte.moodle">question_ouverte.moodle</a></code>) et le format libre permettant
de poser plusieurs questions en une
(<code><a href="#topic+question_libre.moodle">question_libre.moodle</a></code>).  Il est possible de générer un
type de question non explicitement supporté grâce à la fonction
générique <code><a href="#topic+question.moodle">question.moodle</a></code>, à condition que vous
connaissiez les noms des balises XML nécessaires.
</p>
<p>Il est possible de trier les questions en catégories afin de les
repérer plus facilement dans la base de question
(<code><a href="#topic+categorie.moodle">categorie.moodle</a></code> ; c'est indispensable si vous prévoyez
dans votre test le tirage au sort d'une question parmi une série de
questions similaires)
</p>
<p>Afin de faciliter la construction des énoncés des questions, quelques
fonctions sont proposées pour convertir des objets fréquemment
utilisés en code HTML tout en respectant les conventions
typographiques françaises : nombres
(<code><a href="#topic+afficher_nombre.moodle">afficher_nombre.moodle</a></code>), échantillons de valeurs
(vecteur de nombres, <code><a href="#topic+afficher_echantillon.moodle">afficher_echantillon.moodle</a></code>,
construisant un tableau).
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>

<hr>
<h2 id='affichage.moodle'>
Aide aux affichages dans les textes des questions
</h2><span id='topic+affichage.moodle'></span><span id='topic+afficher_poly.moodle'></span><span id='topic+afficher_nombre.moodle'></span><span id='topic+afficher_echantillon.moodle'></span><span id='topic+afficher_echantillons.moodle'></span>

<h3>Description</h3>

<p>Ces fonctions permettent de créer une chaîne de caractère au format
HTML, qui peut ensuite être intégrée au texte d'une question (énoncé,
réponse, commentaire...).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>afficher_echantillon.moodle( x, tableau = TRUE, trier = FALSE,
                             n.chiffres = get( "nombre.chiffres",
                                               envir = SARP.Moodle.env ),
                             marge = c( 10, 10, 1, 1 ), ... )

afficher_echantillons.moodle( x, trier = FALSE,
                              n.chiffres = get( "nombre.chiffres",
                                                envir = SARP.Moodle.env ),
                              marge = c( 10, 10, 1, 1 ),
                              pre.texte = paste0( "\u00c9chantillon\u00a0",
                                                  1:length( x ) ),
                              couleur.trait = "Black", lg.trait = "2",
                              ... )

afficher_nombre.moodle( x,
                        dec = get( "decimal", envir = SARP.Moodle.env ),
                        n.chiffres = get( "nombre.chiffres",
                                          envir = SARP.Moodle.env ),
                        unite = "" )

afficher_poly.moodle( degre, variable, a, ... )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="affichage.moodle_+3A_x">x</code></td>
<td>
<p>L'élément à convertir au format HTML. Voyez les détails pour
plus de précisions.</p>
</td></tr>
<tr><td><code id="affichage.moodle_+3A_n.chiffres">n.chiffres</code></td>
<td>
<p> Le nombre de chiffres à conserver pour l'affichage.
Si le nombre est plus petit, en valeur absolue, que 10^-n.chiffres,
il ne peut pas être affiché avec ce nombre de décimales : c'est
alors le nombre de chiffres significatifs. Sinon, c'est le nombre de
décimales. </p>
</td></tr>
<tr><td><code id="affichage.moodle_+3A_trier">trier</code></td>
<td>
<p>Si <code>TRUE</code>, les valeurs de l'échantillon sont triées
par ordre croissant avant d'être converties en code HTML.  S'il y a
plusieurs échantillons, chacun est trié séparément. </p>
</td></tr>
<tr><td><code id="affichage.moodle_+3A_marge">marge</code></td>
<td>
<p>Les marges à laisser au sein de chaque case du tableau
affichant les résultats. Ce doit être un vecteur de quatre valeurs
entières, correspondant dans l'ordre aux marges gauche, droite,
haute et basse, exprimées en pixels. </p>
</td></tr>
<tr><td><code id="affichage.moodle_+3A_...">...</code></td>
<td>
<p>Autres options pour
<code><a href="#topic+sortie_R.moodle.numeric">sortie_R.moodle.numeric</a></code>, qui est appelé pour
l'affichage sous forme de tableau.</p>
</td></tr>
</table>
<p>Options pour <code>afficher_echantillon.moodle</code>
</p>
<table role = "presentation">
<tr><td><code id="affichage.moodle_+3A_tableau">tableau</code></td>
<td>
<p>Si <code>TRUE</code>, un tableau HTML est construit. Sinon,
une simple énumération des valeurs est préparée. </p>
</td></tr>
</table>
<p>Options pour <code>afficher_echantillons.moodle</code>
</p>
<table role = "presentation">
<tr><td><code id="affichage.moodle_+3A_pre.texte">pre.texte</code></td>
<td>
<p>Les textes à afficher au début de chaque ligne,
permettant d'identifier les échantillons. </p>
</td></tr>
<tr><td><code id="affichage.moodle_+3A_couleur.trait">couleur.trait</code></td>
<td>
<p>La couleur des filets du tableau (ce doit être
une couleur valable en CSS)</p>
</td></tr>
<tr><td><code id="affichage.moodle_+3A_lg.trait">lg.trait</code></td>
<td>
<p>L'épaisseur des filets du tableau (exprimée en
pixels)</p>
</td></tr>
</table>
<p>Options pour <code>afficher_nombre.moodle</code>
</p>
<table role = "presentation">
<tr><td><code id="affichage.moodle_+3A_dec">dec</code></td>
<td>
<p> Le symbole à utiliser comme séparateur décimal. Par
défaut, celui indiqué à la création du questionnaire. </p>
</td></tr>
<tr><td><code id="affichage.moodle_+3A_unite">unite</code></td>
<td>
<p> L'unité à utiliser pour l'affichage de la valeur. </p>
</td></tr>
</table>
<p>Options pour <code>afficher_poly.moodle</code>
</p>
<table role = "presentation">
<tr><td><code id="affichage.moodle_+3A_degre">degre</code></td>
<td>
<p> Le degré du polynome. </p>
</td></tr>
<tr><td><code id="affichage.moodle_+3A_variable">variable</code></td>
<td>
<p> Le texte correspondant à la variable du polynome. Ce
texte peut être quelconque et inclure des balises HTML. S'il
correspond à une unique lettre minuscule (typiquement, x), les
balises de mise en italique sont automatiquement ajoutées, afin de
se conformer aux règles typographiques françaises. </p>
</td></tr>
<tr><td><code id="affichage.moodle_+3A_a">a</code></td>
<td>
<p> Vecteur de longueur <code>degre + 1</code> donnant les
coefficients du polynôme, par degré décroissant. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Pour <code>afficher_echantillon.moodle</code>, <code>x</code> peut être un
vecteur ou une liste; chaque élément est converti en texte avec
<code>afficher_nombre.moodle</code>. La liste des valeurs est alors créée,
soit sous la forme (x1 ; x2 ; ...), soit sous la forme d'un tableau
d'une ligne, avec un filet au-dessus et en-dessous.
</p>
<p>Pour <code>afficher_echantillon.moodle</code>, <code>x</code> doit être une liste,
dont chaque élément est un échantillon. Un tableau est alors créé,
avec une ligne par échantillon (la ligne commençant par le texte
fourni dans <code>pre.texte</code> et permettant d'identifier
l'échantillon). Chaque valeur de chaque échantillon est convertie en
texte avec <code>afficher_nombre.moodle</code>.
</p>
<p>Pour <code>afficher_nombre.moodle</code>, <code>x</code> doit être un vecteur
contenant au plus une seule valeur (dans le cas contraire, seule la
première est utilisée, les autres sont ignorées avec un
avertissement). S'il est de longueur nulle, le symbole de l'ensemble
vide (entité <code>&amp;empty;</code>) est renvoyé, mis en forme avec le style
utilisé pour les messages d'erreur. Les valeurs manquantes (<code>NA</code>)
ou non-numériques (<code>NaN</code>) sont affichées avec ces caractères, et
le style des messages d'erreur. Les valeurs infinies (<code>Inf</code> et
<code>-Inf</code>) sont affichées avec le symbole <code class="reqn">\infty</code>
(entité <code>&amp;infin;</code>). Les chaînes de caractère sont affichées
inchangées. Enfin, les nombres sont mis en forme avec le symbole
<code>dec</code> comme séparateur décimal, un signe moins correct (entité
<code>&amp;minus;</code>) et, si nécessaire, une puissance de 10 correcte (soit
<code>&amp;thinsp;&amp;times;&amp;thinsp;10&lt;sup&gt;n&lt;/sup&gt;</code>, où <code class="reqn">n</code> est la
puissance, pour avoir <code class="reqn">\times 10^n</code> avec des espacements
corrects).
</p>
<p>La fonction <code>afficher_poly.moodle</code> permet de créer le code HTML
d'affichage d'un polynome de degré quelconque ; l'affichage se fait
par puissances décroissantes (<code class="reqn">a\,x + b</code> pour un polynôme
de degré 1, par exemple).
</p>


<h3>Value</h3>

<p>Ces fonctions renvoient une unique chaîne de caractères, au
format HTML, qui peut être utilisée pour construire le texte d'un
énoncé, d'une réponse affichée, d'un commentaire...  </p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Commencer un nouveau questionnaire
q &lt;- debuter_xml.moodle( "exemple.affichages" )

# Catégorie : exemples
categorie.moodle( "Exemples SARP/Affichages" )

# Signe moins, décimale
vrai_faux.moodle( "Quelle est l'écriture correcte de l'opposé de cinq huitièmes&amp;thinsp;?",
                  afficher_nombre.moodle( -5/8 ), -5/8 )

# Affichage des puissances
vrai_faux.moodle( paste( "L'inverse de", afficher_nombre.moodle( 10^8 ),
                         "est", afficher_nombre.moodle( 10^-8 ) ) )

# Affichage d'un échantillon
e &lt;- rnorm( 10 ) * 2 + 20 
numerique.moodle( paste0( "Donnez la plus petite valeur de l'échantillon ci-dessous.",
                          afficher_echantillon.moodle( e ) ),
                  min( e ) )

# Affichage de deux échantillons
e1 &lt;- rnorm( 10 ) * 2 + 20
e2 &lt;- rnorm( 5 ) * 1 + 5
d &lt;- mean( e1 ) - mean( e2 )
numerique.moodle( paste0( "Donnez la différence des moyennes des deux échantillons ci-dessous.",
                          afficher_echantillons.moodle( list( e1, e2 ) ) ),
                  c( d, -d ), notes = c( 100, 100 ) )

# Affichage d'un polynôme
numerique.moodle( paste0( "Quelle est la solution de l'équation ",
                          afficher_poly.moodle( 1, 'x', c( 2, -3 ) ),
                          " = 0&amp;thinsp;?" ),
                  3/2 )

# On termine le questionnaire
finir_xml.moodle( )

# Importez le fichier exemple.affichages.xml dans Moodle pour voir le résultat...
print(
"Importez le fichier exemple.affichages.xml dans Moodle pour voir le résultat..." )

## End(Not run)
</code></pre>

<hr>
<h2 id='categorie.moodle'>
Créer une catégorie de questions
</h2><span id='topic+categorie.moodle'></span>

<h3>Description</h3>

<p>Cette fonction permet de créer une nouvelle catégorie de questions
dans le questionnaire XML.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>categorie.moodle( nom.categorie, autoriser.dollar = FALSE,
                  temps = NULL,
                  fichier.xml = get( "fichier.xml", envir = SARP.Moodle.env ) )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="categorie.moodle_+3A_nom.categorie">nom.categorie</code></td>
<td>
<p> Le nom de la catégorie. Il est possible de
donner une hiérarchie de catégories, en utilisant la barre oblique
(<code>/</code>) comme séparateur des différents niveaux &mdash; comme dans un
chemin incluant des dossiers.</p>
</td></tr>
<tr><td><code id="categorie.moodle_+3A_autoriser.dollar">autoriser.dollar</code></td>
<td>
<p>Le dollar (<code>$</code>) est un caractère réservé,
qui permet d'ancrer les catégories dans les divers cours. Pour
éviter des difficultés, les dollars sont donc remplacés par des
soulignés (<code>_</code>). Cette conversion peut être désactivée en
indiquant <code>TRUE</code> pour cette option.</p>
</td></tr>
<tr><td><code id="categorie.moodle_+3A_temps">temps</code></td>
<td>
<p>Le temps conseillé pour répondre aux questions de la
catégorie. Ce temps sera utilisé pour toutes les questions créées
jusqu'au prochain appel de cette fonction, si aucun temps conseillé
n'est indiqué lors de l'appel à la fonction créant la fonction.</p>
</td></tr>
<tr><td><code id="categorie.moodle_+3A_fichier.xml">fichier.xml</code></td>
<td>
<p> Le fichier correspondant au questionnaire qui
contiendra cette question (par défaut, le dernier créé).  </p>
</td></tr>
</table>


<h3>Details</h3>

<p>La catégorie proposée est toujours intégrée dans le cours actuel, en
ajoutant <code>$course$</code> en début de hiérarchie.
</p>
<p>Pour éviter des sous-catégories sans nom, les séparateurs multiples sont
simplifiés en un seul séparateur et ceux en fin de nom de catégorie
sont supprimés. Si vous voulez vraiment des sous-catégories sans nom
visible, utilisez des espaces entre les séparateurs ou après le dernier.
</p>


<h3>Value</h3>

<p>Aucune valeur n'est renvoyée par cette fonction.
</p>


<h3>Attention</h3>

<p>Les catégories ne seront prises en compte que si
l'option correspondante est cochée lors de l'import du fichier (case «
Obtenir la catégorie à partir du fichier »)
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Commencer un nouveau questionnaire
q &lt;- debuter_xml.moodle( "exemple.categorie" )

# Catégorie des questions numériques pour les exemples de cette documentation
categorie.moodle( "Exemples SARP/Numériques" )
numerique.moodle( "Combien vaut 1&amp;nbsp;+&amp;nbsp;1&amp;thinsp;?", 2 )
numerique.moodle( "Combien vaut 1&amp;nbsp;&amp;times&amp;nbsp;1&amp;thinsp;?", 1 )
numerique.moodle( "Combien vaut 1&amp;nbsp;+&amp;nbsp;1 en binaire&amp;thinsp;?", 10 )

# Catégorie des QROC pour les exemples de cette documentation
categorie.moodle( "Exemples SARP/QROC" )
qroc.moodle( "Comment s'appelle cette biblioth&amp;egrave;que&amp;thinsp;?", "SARP.Moodle" )

# On termine le questionnaire
finir_xml.moodle( )

# Importez le fichier exemple.categorie.xml dans Moodle pour voir le résultat...
print(
"Importez le fichier exemple.categorie.xml dans Moodle pour voir le résultat..." )

## End(Not run)
</code></pre>

<hr>
<h2 id='csv_glossaire.moodle'>
Convertir un fichier CSV en glossaire Moodle
</h2><span id='topic+csv_glossaire.moodle'></span>

<h3>Description</h3>

<p>Cette fonction permet de convertir un fichier CSV, convenablement
construit, en un fichier XML de glossaire pour Moodle
</p>


<h3>Usage</h3>

<pre><code class='language-R'>csv_glossaire.moodle( fichier.csv,
                      colonne.terme = "Mot",
                      colonne.definition = "D\u00e9finition",
                      fichier.xml = if ( TRUE == nv.fichier ) gsub(
                            "\\.[Cc][Ss][Vv]$",
                            ".xml", fichier.csv )
                                    else get( "fichier.xml",
                                              envir = SARP.Moodle.env ),
                      nv.fichier = TRUE,
                      embellir = TRUE, deja.HTML = FALSE,
                      sep = ";", header = TRUE, quote = "\"",
                      ... )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="csv_glossaire.moodle_+3A_fichier.csv">fichier.csv</code></td>
<td>

<p>Un vecteur de chaînes de caractères contenant les noms des fichiers
à convertir. Chacun des fichiers est traité indépendamment, mais
avec les mêmes valeurs des options qui suivent.
</p>
</td></tr>
<tr><td><code id="csv_glossaire.moodle_+3A_colonne.terme">colonne.terme</code></td>
<td>

<p>Le nom ou le numéro de la colonne qui contient les termes à définir
dans le glossaire.
</p>
</td></tr>
<tr><td><code id="csv_glossaire.moodle_+3A_colonne.definition">colonne.definition</code></td>
<td>

<p>Le nom ou le numéro de la colonne qui contient les définitions des
termes du glossaire.
</p>
</td></tr>
<tr><td><code id="csv_glossaire.moodle_+3A_fichier.xml">fichier.xml</code></td>
<td>

<p>Le nom du fichier XML à créer ou un fichier XML déjà créé avec
<code><a href="#topic+creer_glossaire.moodle">creer_glossaire.moodle</a></code>. Par
défaut, la fonction crée un fichier de même nom que le premier
fichier fourni, en remplaçant l'extension <code>.csv</code> par
<code>.xml</code>.
</p>
</td></tr>
<tr><td><code id="csv_glossaire.moodle_+3A_nv.fichier">nv.fichier</code></td>
<td>

<p>Une valeur logique indiquant si l'on veut créer un nouveau fichier
(<code>TRUE</code>) ou utiliser un fichier XML déjà ouvert avec
<code><a href="#topic+creer_glossaire.moodle">creer_glossaire.moodle</a></code> (<code>FALSE</code>)
</p>
</td></tr>
<tr><td><code id="csv_glossaire.moodle_+3A_embellir">embellir</code>, <code id="csv_glossaire.moodle_+3A_deja.html">deja.HTML</code></td>
<td>

<p>Actuellement inutilisés, prévus pour une version future
</p>
</td></tr>
<tr><td><code id="csv_glossaire.moodle_+3A_sep">sep</code>, <code id="csv_glossaire.moodle_+3A_header">header</code>, <code id="csv_glossaire.moodle_+3A_quote">quote</code></td>
<td>

<p>Options pour <code><a href="utils.html#topic+read.table">read.table</a></code>, correspondant au format d'un
fichier CSV par défaut lorsqu'il est créé par Libre office ou Excel.
</p>
</td></tr>
<tr><td><code id="csv_glossaire.moodle_+3A_...">...</code></td>
<td>

<p>Autres options pour <code><a href="utils.html#topic+read.table">read.table</a></code>, si nécessaire.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Cette fonction réalise la conversion d'un ou plusieurs fichiers CSV
de définitions d'un glossaire pour Moodle en un fichier XML.
</p>
<p>Ce fichier doit comporter au moins deux colonnes : l'une avec les
termes à définir et l'autre avec les définitions. Chaque ligne
correspond à une définition.
</p>


<h3>Value</h3>

<p>De façon invisible, une liste des data.frames des définitions après
traitement de chaque fichier.  Elle n'a guère d'autre intérêt que pour
détecter l'origine d'un problème de conversion.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>See Also</h3>

<p>Les fonctions de base de création de glossaire pour plus de souplesse.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Conversion du fichier d'exemple fourni
  #  (à placer dans le répertoire de travail)
## Not run: 
  csv_questionnaire.moodle( "exemple_glossaire.csv" )

## End(Not run)
</code></pre>

<hr>
<h2 id='csv_optique.moodle'>
Convertir un fichier CSV en questions Moodle
</h2><span id='topic+csv_optique'></span><span id='topic+csv_optique.moodle'></span>

<h3>Description</h3>

<p>Cette fonction permet de convertir un fichier CSV, au format « lecture
optique », en un fichier XML de questions pour Moodle
</p>


<h3>Usage</h3>

<pre><code class='language-R'>csv_optique.moodle( fichier.csv,
                    forcer.multiple = FALSE, melanger.reponses = TRUE, 
                    somme.nulle = FALSE,
                    fichier.xml = if ( TRUE == nv.fichier )
                                    gsub( "\\.[Cc][Ss][Vv]$",
                                          ".xml", fichier.csv )
                                  else get( "fichier.xml",
                                            envir = SARP.Moodle.env ),
                    nv.fichier = TRUE,
                    embellir = TRUE, deja.HTML = FALSE,
                    categorie.base = "",
                    dossier.images = ".",
                    sep.images = c( '@@', '@@' ), inserer.images = TRUE,
                    sep.formules = c( '@\\$', '\\$@' ),
                    sep.SMILES = c( '@\\{', '\\}@' ),
                    sep = ";", header = TRUE, quote = '\"', 
                    ... )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="csv_optique.moodle_+3A_fichier.csv">fichier.csv</code></td>
<td>

<p>Un vecteur de chaînes de caractères contenant les noms des fichiers
à convertir. Chacun des fichiers est traité indépendamment, mais
avec les mêmes valeurs des options qui suivent.
</p>
</td></tr>
<tr><td><code id="csv_optique.moodle_+3A_forcer.multiple">forcer.multiple</code></td>
<td>

<p>Si <code>TRUE</code>, les questions sont toujours
considérées comme des réponses à choix multiples (l'étudiant pourra
cocher plusieurs réponses). Sinon, si une seule bonne réponse est
proposée, la question est à choix unique (l'étudiant ne pourra
choisir qu'une seule réponse).
</p>
</td></tr>
<tr><td><code id="csv_optique.moodle_+3A_melanger.reponses">melanger.reponses</code></td>
<td>

<p>Si <code>TRUE</code>, autorise Moodle à permuter aléatoirement l'ordre des
réponses lorsqu'il pose la question. Sinon, l'ordre du fichier est
tout le temps utilisé.
</p>
</td></tr>
<tr><td><code id="csv_optique.moodle_+3A_somme.nulle">somme.nulle</code></td>
<td>

<p>Cette option précise comment gérer les réponses incorrectes du
QCM.  Si <code>FALSE</code>, les réponses incorrectes ont une note nulle.
Si <code>TRUE</code>, les réponses incorrectes se voient attribuer une
note négative telle que la somme de ces notes vaut -1, de sorte que
si l'étudiant coche toutes les cases du QCM, il a 0 (sauf bien sûr
si toutes les cases correspondent à des questions correctes...).
</p>
</td></tr>
<tr><td><code id="csv_optique.moodle_+3A_fichier.xml">fichier.xml</code></td>
<td>

<p>Le nom du fichier XML à créer ou un fichier XML déjà créé avec
<code><a href="#topic+debuter_xml.moodle">debuter_xml.moodle</a></code>. Par
défaut, la fonction crée un fichier de même nom que le premier
fichier fourni, en remplaçant l'extension <code>.csv</code> par
<code>.xml</code>.
</p>
</td></tr>
<tr><td><code id="csv_optique.moodle_+3A_nv.fichier">nv.fichier</code></td>
<td>

<p>Une valeur logique indiquant si l'on veut créer un nouveau fichier
(<code>TRUE</code>) ou utiliser un fichier XML déjà ouvert avec
<code><a href="#topic+debuter_xml.moodle">debuter_xml.moodle</a></code> (<code>FALSE</code>)
</p>
</td></tr>
<tr><td><code id="csv_optique.moodle_+3A_embellir">embellir</code>, <code id="csv_optique.moodle_+3A_deja.html">deja.HTML</code></td>
<td>

<p>Actuellement inutilisés, prévus pour une version future
</p>
</td></tr>
<tr><td><code id="csv_optique.moodle_+3A_categorie.base">categorie.base</code></td>
<td>

<p>La catégorie de base à utiliser pour créer les questions. Elle
contiendra toutes les questions du fichier.
</p>
</td></tr>
<tr><td><code id="csv_optique.moodle_+3A_dossier.images">dossier.images</code></td>
<td>
<p> Le dossier d'image où trouver les images à
intégrer au fichier XML, ou l'URL de base pour les trouver dans
Moodle (voir <code><a href="#topic+definir_dossier.image.moodle">definir_dossier.image.moodle</a></code>). </p>
</td></tr>
<tr><td><code id="csv_optique.moodle_+3A_sep.images">sep.images</code></td>
<td>
<p> Les codes servant à encadrer un nom d'image dans
les textes du fichier CSV. </p>
</td></tr>
<tr><td><code id="csv_optique.moodle_+3A_inserer.images">inserer.images</code></td>
<td>
<p> Si <code>TRUE</code>, les images sont incluses dans
le fichier XML. Sinon, seul le lien est construit. </p>
</td></tr>
<tr><td><code id="csv_optique.moodle_+3A_sep.formules">sep.formules</code></td>
<td>
<p> Les codes servant à encadrer une formule
mathématique à convertir grâce à latex dans les textes du fichier
CSV. </p>
</td></tr>
<tr><td><code id="csv_optique.moodle_+3A_sep.smiles">sep.SMILES</code></td>
<td>
<p> Les codes servant à encadrer un code SMILES à
convertir en formule chimique grâce à openbabel dans les textes du
fichier CSV. </p>
</td></tr>
<tr><td><code id="csv_optique.moodle_+3A_sep">sep</code>, <code id="csv_optique.moodle_+3A_header">header</code>, <code id="csv_optique.moodle_+3A_quote">quote</code></td>
<td>

<p>Options pour <code><a href="utils.html#topic+read.table">read.table</a></code>, correspondant au format d'un
fichier CSV par défaut lorsqu'il est créé par Libre office ou Excel.
</p>
</td></tr>
<tr><td><code id="csv_optique.moodle_+3A_...">...</code></td>
<td>

<p>Autres options pour <code><a href="utils.html#topic+read.table">read.table</a></code>, si nécessaire.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Ces fonctions réalisent la conversion d'un ou plusieurs fichiers CSV
de questions pour Moodle en un fichier XML. Les questions sont
nécessairement des QCM.
</p>
<p>Ce fichier doit être au format utilisé par les lecteurs optiques de
QCM. La première ligne, qui donne le numéro de question, est ignorée,
ainsi que la première colonne.  Chacune des autres colonnes correspond
à une question différente.
</p>
<p>Pour chaque question, la première ligne indique le titre, la suivante
l'énoncé.  Ensuite, les réponses possibles et leur justesse alternent.
</p>
<p><strong>Insérer des images</strong>
</p>
<p>Il est possible de faire référence à une image dans les textes
(énoncés, réponses, commentaires) en encadrant le nom de fichier de
l'image par les séparateurs choisis, par défaut <code>@@</code>. Il est
possible de redimensionner l'image en faisant suivre le nom de l'image
d'un point d'exclamation, puis de la largeur, du caractère x et de la
hauteur.  Attention, il semblerait que Moodle ne déforme pas les
images, quelles que soient les dimensions demandées.  Par défaut,
l'image sera incluse au fichier XML.
</p>
<p>Deux types d'image peuvent être créés au vol : les formules
mathématiques et les formules chimiques. Voir les fonctions
<code><a href="#topic+inserer_formule.moodle">inserer_formule.moodle</a></code> et
<code><a href="#topic+inserer_SMILES.moodle">inserer_SMILES.moodle</a></code> pour plus de détails.
</p>


<h3>Value</h3>

<p>De façon invisible, une liste des data.frames des questions après
traitement de chaque fichier.  Elle n'a guère d'autre intérêt que pour
détecter l'origine d'un problème de conversion.
</p>


<h3>Attention!</h3>

<p>Moodle est assez peu permissif pour les notes
exprimées en pourcentage; en particulier, lorsque ce pourcentage ne
tombe pas juste (33% pour trois bonnes réponses, par exemple), à
cause de l'arrondi il peut rejeter le fichier créé. Dans ce cas,
désactivez l'arrêt en cas d'erreur et demandez l'arrondi à la note la
plus proche pour pouvoir importer les questions.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a> (sur une idée
de Wilfrid Cariou)
</p>


<h3>See Also</h3>

<p>Les fonctions de base de création de questions pour plus de souplesse,
et en particulier pour créer des questions non gérées par le format de
fichier ci-dessus.
</p>
<p><code><a href="#topic+csv.moodle">csv.moodle</a></code> pour convertir un fichier CSV au format
proposé par SARP.moodle, permettant de gérer davantage de sortes de
question.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Conversion du fichier d'exemple fourni
  #  (à placer dans le répertoire de travail)
## Not run: 
  csv_optique.moodle( "exemple_optique.csv" )

## End(Not run)
</code></pre>

<hr>
<h2 id='csv.moodle'>
Convertir un fichier CSV, ODS ou XLSX en questions Moodle
</h2><span id='topic+conversion_csv.moodle'></span><span id='topic+csv.moodle'></span><span id='topic+ods.moodle'></span><span id='topic+xlsx.moodle'></span>

<h3>Description</h3>

<p>Cette fonction permet de convertir un fichier convenablement
construit, en un fichier XML de questions pour Moodle
</p>


<h3>Usage</h3>

<pre><code class='language-R'>csv.moodle(fichier.csv,
           colonne.texte = NA, colonne.reponse = NA,
           colonne.note = NA, colonne.note_question = NA,
           colonne.titre = NA,
           colonne.code = NA, colonne.type = NA,
           colonne.retour = NA, colonne.global = NA,
           colonne.penalite = NA,
           colonne.temps = NA, colonne.decimale = NA,
           fichier.xml = if ( TRUE == nv.fichier ) gsub(
                              "\\.[Cc][Ss][Vv]$",
                              ".xml", fichier.csv )
                         else get( "fichier.xml",
                                   envir = SARP.Moodle.env ),
           nv.fichier = TRUE,
           creer.titre = TRUE, lg.titre = 30,
           embellir = TRUE, deja.HTML = FALSE,
           forcer.multiple = TRUE, melanger.reponses = TRUE,
           somme.nulle = FALSE, precision = 3,
           categorie.base = "",
           dossier.images = dirname( fichier.csv ), 
           sep.images = c( '@@', '@@' ), inserer.images = TRUE,
           sep.formules = c( '@\\$', '\\$@' ),
           sep.SMILES = c( '@\\{', '\\}@' ),
           sep = if ( extension == "txt" ) "" else ";",
           header = TRUE, quote = '\"',
           ... )

ods.moodle( fichier.ods, onglet = NA,
            colonne.texte  = NA, colonne.reponse = NA,
            colonne.note   = NA, colonne.note_question = NA,
            colonne.titre  = NA, colonne.code = NA, colonne.type = NA,
            colonne.retour = NA, colonne.global = NA, colonne.penalite = NA,
            colonne.temps  = NA, colonne.decimale = NA,
            fichier.xml = if ( TRUE == nv.fichier ) gsub( "\\.[Oo][Dd][Ss]$",
                                                          ".xml",
                                                          fichier.ods )
                          else get( "fichier.xml", envir = SARP.Moodle.env ),
            nv.fichier = TRUE,
            creer.titre = TRUE, lg.titre = 30, embellir = TRUE, deja.HTML = FALSE,
            forcer.multiple = TRUE, melanger.reponses = TRUE, somme.nulle = FALSE,
            precision = 3,
            categorie.base = "",
            dossier.images = dirname( fichier.ods ),
            sep.images = c( '@@', '@@' ), inserer.images = TRUE,
            sep.formules = c( '@\\$', '\\$@' ),
            sep.SMILES = c( '@\\{', '\\}@' ),
            ... )

xlsx.moodle( fichier.xlsx, onglet = NA,
             colonne.texte  = NA, colonne.reponse = NA,
             colonne.note   = NA, colonne.note_question = NA,
             colonne.titre  = NA, colonne.code = NA, colonne.type = NA,
             colonne.retour = NA, colonne.global = NA, colonne.penalite = NA,
             colonne.temps  = NA, colonne.decimale = NA,
             fichier.xml = if ( TRUE == nv.fichier ) gsub( "\\.[Xx][Ll][Ss][Xx]$",
                                                           ".xml",
                                                           fichier.xlsx )
                           else get( "fichier.xml", envir = SARP.Moodle.env ),
             nv.fichier = TRUE,
             creer.titre = TRUE, lg.titre = 30, embellir = TRUE, deja.HTML = FALSE,
             forcer.multiple = TRUE, melanger.reponses = TRUE, somme.nulle = FALSE,
             precision = 3,
             categorie.base = "",
             dossier.images = dirname( fichier.xlsx ),
             sep.images = c( '@@', '@@' ), inserer.images = TRUE,
             sep.formules = c( '@\\$', '\\$@' ),
             sep.SMILES = c( '@\\{', '\\}@' ),
             ... )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="csv.moodle_+3A_fichier.csv">fichier.csv</code>, <code id="csv.moodle_+3A_fichier.ods">fichier.ods</code>, <code id="csv.moodle_+3A_fichier.xlsx">fichier.xlsx</code></td>
<td>

<p>Un vecteur de chaînes de caractères contenant les noms des fichiers
à convertir. Chacun des fichiers est traité indépendamment, mais
avec les mêmes valeurs des options qui suivent.
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_onglet">onglet</code></td>
<td>

<p>Le numéro, ou le nom, de la feuille (onglet) du classeur LibreOffice
ou Excel à convertir. S'il n'est pas indiqué, toutes les feuilles
seront converties.
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_colonne.texte">colonne.texte</code></td>
<td>

<p>Le nom ou le numéro de la colonne qui contient l'énoncé des
questions.
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_colonne.reponse">colonne.reponse</code></td>
<td>

<p>Le nom ou le numéro de la colonne qui contient la ou les réponses
aux questions.
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_colonne.note">colonne.note</code></td>
<td>

<p>Le nom ou le numéro de la colonne qui contient la note associée à
chaque réponse. Si elle n'est pas indiquée, une colonne intitulée «
Note » (insensible à la casse) est cherchée dans le fichier. Cette
colonne est obligatoire en cas de question à réponses
multiples. Elle peut alors contenir soit le pourcentage de la note
(voir les détails), soit « Vrai » ou « Faux » (insensible à la
casse) et les pourcentages sont calculés en conséquence (avec
toujours 0 pour « Faux »: indiquez explicitement un pourcentage
négatif si nécessaire). 
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_colonne.note_question">colonne.note_question</code></td>
<td>
<p> Le nom ou le numéro de la colonne qui
contient la note globale de la question. Si elle n'est pas indiquée,
une colonne intitulée « Note question » (insensible à la casse) est
cherchée dans le fichier. Cette colonne est facultative. Si elle
existe, elle doit contenir un entier strictement positif donnant la
note globale de la question, ou rester vide. Toute note non indiquée
sera supposée égale à 1 (valeur par défaut de Moodle).</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_colonne.titre">colonne.titre</code></td>
<td>

<p>Le nom ou le numéro de la colonne qui contient le titre à donner à
la question dans Moodle. Si elle est manquante, le titre est
construit, sous la forme <code>xx yy</code> où <code>yy</code> correspond aux
<code>lg.titre</code> premiers caractères de la question, et <code>xx</code> au
code de la question.
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_colonne.code">colonne.code</code></td>
<td>

<p>Le nom ou le numéro de la colonne qui contient le code de la
question. Cette colonne n'est obligatoire que pour créer des
questions « cloze ». Si elle est manquante, un code interne de la
forme <code>[Qnn]</code>, où <code>nn</code> est le numéro de la question, est
construit, chaque question correspondant à une ligne avec les deux
colonnes <code>colonne.texte</code> et <code>colonne.reponse</code>
renseignées. Voyez les détails pour davantage de précisions.
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_colonne.type">colonne.type</code></td>
<td>

<p>Le nom ou le numéro de la colonne qui contient le type de la
question. Cette colonne peut être utilisée pour indiquer qu'une
question avec plusieurs réponses proposées n'a qu'une seule réponse
possible, en indiquant QCU pour au moins une des réponses (question
à choix unique); QCM permet d'indiquer que l'on peut cocher
plusieurs réponses (question à choix multiples). Dans ce cas,
<code>forcer.multiple</code> est ignoré.
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_colonne.retour">colonne.retour</code></td>
<td>

<p>Le nom ou le numéro de la colonne qui contient le commentaire à
afficher pour chaque réponse. Cette colonne est facultative.
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_colonne.global">colonne.global</code></td>
<td>

<p>Le nom ou le numéro de la colonne qui contient le commentaire à
afficher globalement pour la question. Cette colonne est facultative.
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_colonne.penalite">colonne.penalite</code></td>
<td>
<p> Le nom ou le numéro de la colonne qui
contient la pénalité à mettre en cas de nouvelle tentative de la
question. Si elle n'est pas indiquée, une colonne intitulée «
Pénalité » (insensible à la casse) est cherchée dans le
fichier. Cette colonne est facultative. Si elle existe, elle doit
contenir la fraction de la note globale de la
question qui sera prise en compte pour noter la nouvelle tentative
(par exemple, si la question a une note globale de 2 et la pénalité
est de 0,5, à la seconde tentative la note maximale possible sera de
1) ou rester vide. Toute pénalité non indiquée sera supposée
égale à 1 (pas de pénalité en cas de nouvelle tentative).
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_colonne.temps">colonne.temps</code></td>
<td>
<p> Le nom ou le numéro de la colonne qui contient
le temps conseillé pour la question. Cette colonne est facultative.
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_colonne.decimale">colonne.decimale</code></td>
<td>
<p> Le nom ou le numéro de la colonne qui contient
le nombre de chiffres après la virgule attendu pour la réponse à la
question (pour les questions numériques uniquement). Cette colonne
est facultative.  </p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_fichier.xml">fichier.xml</code></td>
<td>

<p>Le nom du fichier XML à créer ou un fichier XML déjà créé avec
<code><a href="#topic+debuter_xml.moodle">debuter_xml.moodle</a></code>. Par
défaut, la fonction crée un fichier de même nom que le premier
fichier fourni, en remplaçant l'extension <code>.csv</code> par
<code>.xml</code>.
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_nv.fichier">nv.fichier</code></td>
<td>

<p>Une valeur logique indiquant si l'on veut créer un nouveau fichier
(<code>TRUE</code>) ou utiliser un fichier XML déjà ouvert avec
<code><a href="#topic+debuter_xml.moodle">debuter_xml.moodle</a></code> (<code>FALSE</code>)
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_creer.titre">creer.titre</code></td>
<td>

<p>Une valeur logique indiquant si l'on veut créer un titre pour chaque
question, à partir de son code et du début de son énoncé
(<code>TRUE</code>) ou non. Ignoré si une colonne de titres a été fournie.
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_lg.titre">lg.titre</code></td>
<td>

<p>Le nombre de caractères de l'énoncé d'une question à conserver pour
construire son titre. Ignoré si une colonne de titres a été fournie
ou si <code>creer.titre=FALSE</code>.
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_embellir">embellir</code>, <code id="csv.moodle_+3A_deja.html">deja.HTML</code></td>
<td>

<p>Actuellement inutilisés, prévus pour une version future
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_forcer.multiple">forcer.multiple</code></td>
<td>

<p>Si <code>TRUE</code>, les questions avec plusieurs réponses sont toujours
considérées comme des réponses à choix multiples (l'étudiant pourra
cocher plusieurs réponses). Sinon, si une seule bonne réponse est
proposée (plus exactement, s'il existe au moins une réponse donnant 100 % des
points), la question est à choix unique (l'étudiant ne pourra
choisir qu'une seule réponse).  Cette option est ignorée pour les
questions qui auraient une valeur indiquée dans la colonne précisée
dans <code>colonne.type</code>.
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_melanger.reponses">melanger.reponses</code></td>
<td>

<p>Si <code>TRUE</code>, autorise Moodle à permuter aléatoirement l'ordre des
réponses lorsqu'il pose la question. Sinon, l'ordre du fichier est
tout le temps utilisé.
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_somme.nulle">somme.nulle</code></td>
<td>

<p>Cette option précise comment gérer les réponses incorrectes dans un
QCM.  Si <code>FALSE</code>, la note de ces réponses est déterminée à
partir du fichier, le code FAUX étant associé à une note nulle.
Si <code>TRUE</code>, les réponses incorrectes se voient attribuer une
note négative telle que la somme de ces notes vaut -1, de sorte que
si l'étudiant coche toutes les cases du QCM, il a 0 (sauf bien sûr
si toutes les cases correspondent à des questions correctes...).
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_precision">precision</code></td>
<td>
<p>Le nombre de décimales à donner dans la réponse, pour
une réponse numérique (utilisez <code>NA</code> pour une valeur exacte et
ne pas avoir de message indiquant le nombre de décimales ajouté au
texte de la question).
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_categorie.base">categorie.base</code></td>
<td>

<p>La catégorie de base à utiliser pour créer les questions. Elle
contiendra toutes les sous-catégories du fichier, s'il y en a.
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_dossier.images">dossier.images</code></td>
<td>
<p> Le dossier d'image où trouver les images à
intégrer au fichier XML, ou l'URL de base pour les trouver dans
Moodle (voir <code><a href="#topic+definir_dossier.image.moodle">definir_dossier.image.moodle</a></code>). </p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_sep.images">sep.images</code></td>
<td>
<p> Les codes servant à encadrer un nom d'image dans
les textes du fichier CSV. </p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_inserer.images">inserer.images</code></td>
<td>
<p> Si <code>TRUE</code>, les images sont incluses dans
le fichier XML. Sinon, seul le lien est construit. </p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_sep.formules">sep.formules</code></td>
<td>
<p> Les codes servant à encadrer une formule
mathématique à convertir grâce à latex dans les textes du fichier
CSV. </p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_sep.smiles">sep.SMILES</code></td>
<td>
<p> Les codes servant à encadrer un code SMILES à
convertir en formule chimique grâce à openbabel dans les textes du
fichier CSV. </p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_sep">sep</code>, <code id="csv.moodle_+3A_header">header</code>, <code id="csv.moodle_+3A_quote">quote</code></td>
<td>

<p>Options pour <code><a href="utils.html#topic+read.table">read.table</a></code>, correspondant au format d'un
fichier CSV par défaut lorsqu'il est créé par Libre office ou Excel.
</p>
</td></tr>
<tr><td><code id="csv.moodle_+3A_...">...</code></td>
<td>

<p>Autres options pour <code><a href="utils.html#topic+read.table">read.table</a></code>, si nécessaire.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Ces fonctions réalisent la conversion d'un ou plusieurs fichiers
structurés de questions pour Moodle en un fichier XML. La nature des
questions est déduite de la structure du fichier.  Le fichier peut
être au format CSV (format recommandé), Libre Office Calc (ODS) ou
Excel (XLSX). Dans les deux derniers cas, il est possible de convertir
toutes les feuilles du classeur ou juste une partie. Chaque feuille à
convertir doir avoir la structure décrite ci-après, correspondant au
format du fichier CSV.
</p>
<p>Le fichier doit comporter au moins deux colonnes : l'une avec les
énoncés des questions et l'autre avec les réponses. Chaque ligne
correspond à une réponse possible.
</p>
<p>Pour les questions simples, la question tient sur une ligne. La nature
de la question est déduite de la réponse. Si la réponse peut être
convertie en nombre, la question est supposée être une réponse
numérique; elle sera créée avec un appel à
<code><a href="#topic+numerique.moodle">numerique.moodle</a></code>.  Si la réponse est identifiée comme
une valeur logique (un des textes « V », « F », « T », « Vrai », «
Faux », « True » ou « False », quelle que soit la casse), la question
est supposée être une question binaire avec les deux réponses « Vrai »
et « Faux »; elle sera créée avec un appel à
<code><a href="#topic+vrai_faux.moodle">vrai_faux.moodle</a></code>.  Dans tous les autres cas, la question
est supposée être à réponse ouverte et courte et sera créée par un
appel à <code><a href="#topic+qroc.moodle">qroc.moodle</a></code>. Par défaut, la réponse est sensible
à la casse; cela peut être modifié en indiquant « I » dans la colonne
précisant le type de question.
</p>
<p>S'il y a un énoncé, mais pas de réponse, cet énoncé est supposé être
une indication de catégorie (sauf si la question a le même code qu'une
question « cloze », voir plus loin, ou si la colonne précisant le type
de question indique un type particulier) qui sera créée comme une
sous-catégorie de la catégorie de base, par un appel à
<code><a href="#topic+categorie.moodle">categorie.moodle</a></code>.  Si une colonne précise le type, la
question peut être de type rédactionnel (réponse libre dans un éditeur
de texte, pas de correction automatique; type « R »,
<code><a href="#topic+question_ouverte.moodle">question_ouverte.moodle</a></code>), description (un texte
s'affiche, mais aucune réponse n'est attendue; type « D »,
<code><a href="#topic+description.moodle">description.moodle</a>)</code> ou texte à trou (il faudra replacer
les textes dans les trous de l'énoncé, les trous étant construits à
partir des termes encadrés par des [[doubles crochets]]); type « T »,
<code><a href="#topic+glisser_textes.moodle">glisser_textes.moodle</a></code>)
</p>
<p>S'il y a une réponse, mais pas d'énoncé, cette réponse est supposée
être une autre réponse possible à une question à choix multiple, dont
l'énoncé est dans la première ligne précédente qui en contient un.
Dans ce cas, le fichier doit contenir une colonne qui contient les
notes associées à chaque réponse. Cette note peut être précise,
exprimée en pourcentage suivant la convention Moodle, ou indicative,
avec la simple mention « Vrai » pour les bonnes réponses et « Faux »
pour les mauvaises. Dans le deuxième cas, les bonnes réponses sont
associées à l'inverse du nombre de bonnes réponses, de sorte que
cocher toutes les bonnes réponses donne la note totale; les mauvaises
réponses sont associées à la note 0 (si <code>somme.nulle=FALSE</code>:
cocher ou non ces réponses ne change rien à la note) ou à l'opposé de
l'inverse du nombre de mauvaises réponses (si <code>somme.nulle=TRUE</code>:
cocher ces réponses diminue la note et cocher toutes les réponses
donne une somme nulle).  Par défaut, la question construite est
toujours un QCM (plusieurs réponses peuvent être choisies), même s'il
y a une seule bonne réponse. Pour demander qu'une seule réponse puisse
être choisie (QCU), indiquez le type QCU dans la colonne indiquée par
<code>colonne.type</code> pour la question considérée. Si vous voulez que
toutes les questions avec une seule bonne réponse soient en QCU, vous
pouvez aussi utiliser l'option <code>forcer.multiple = FALSE</code>.
</p>
<p><strong>Construire des questions &ldquo;<em>cloze</em>&rdquo;</strong>
</p>
<p>Pour pouvoir construire des questions &ldquo;<em>cloze</em>&rdquo;, le
fichier doit obligatoirement contenir une colonne qui indique le code
de chaque question (y compris les catégories). Ce code doit être
unique pour une même question; toutes les lignes qui auront le même
code seront donc considérées comme faisant partie de la même question.
</p>
<p>De ce fait, si plusieurs lignes d'énoncé renseignées ont le même code,
elles sont considérées faisant partie de la même question et sont
utilisées pour construire une question &ldquo;<em>cloze</em>&rdquo;, selon le
même principe que la fonction <code><a href="#topic+question_libre.moodle">question_libre.moodle</a></code>:
après chaque partie d'énoncé, un champ de réponse est créé, dont la
bonne réponse est celle indiquée dans la colonne
<code>colonne.reponse</code> et sert à définir le type de champ de réponse
(selon la logique des questions en une ligne).  Pour avoir un texte
après le dernier champ de réponse, laissez la colonne
<code>colonne.reponse</code> vide tout en gardant le même code de question.
</p>
<p>Pour avoir des questions avec réponse à choisir dans une liste, mettez
une réponse par ligne sans mettre d'énoncé avant, comme pour un QCM.
La colonne <code>colonne.type</code> permet de préciser le type d'affichage,
avec les codes Moodle (<code>MULTICHOICE</code>, <code>MULTICHOICE_S</code>...).
Il est possible d'abréger le code: M correspond à un choix dans un
menu déroulant (une seule réponse possible ; <code>MULTICHOICE</code>) ; H,
à des réponses juxtaposés (<code>MULTICHOICE_H</code>) ; V, à des réponses
superposées (<code>MULTICHOICE_V</code>) ; SA, à un champ libre attendant
une réponse courte, de type Q. R. O. C. (<code>SHORTANSWER</code>).  Pour
les réponses superposées ou juxtaposés, par défaut, une seule réponse
peut être choisie et l'ordre est celui indiqué dans le fichier. Il est
possible d'indiquer que plusieurs réponses peuvent être choisies en
ajoutant le code M (VM, HM) ; il est possible de demander à Moodle de
tirer au sort l'ordre des réponses en ajoutant le code A (MA, VA,
VMA...) ou S (MS, VS...).  Pour le champ libre, par défaut la casse
est ignorée. Il est possible d'indiquer que la casse doit être
contrôlée grâce au code SAC (<code>SHORTANSWER_C</code>). L'ordre des codes
n'a pas d'importance (HM et MH donneront tous deux une question de
type <code>MULTICHOICE_H</code>).
</p>
<p><strong>Insérer des images</strong>
</p>
<p>Il est possible de faire référence à une image dans les textes
(énoncés, réponses, commentaires) en encadrant le nom de fichier de
l'image par les séparateurs choisis, par défaut <code>@@</code>. Il est
possible de redimensionner l'image en faisant suivre le nom de l'image
d'un point d'exclamation, puis de la largeur, du caractère x et de la
hauteur.  Attention, il semblerait que Moodle ne déforme pas les
images, quelles que soient les dimensions demandées.  Par défaut,
l'image sera incluse au fichier XML.
</p>
<p>Deux types d'image peuvent être créés au vol : les formules
mathématiques et les formules chimiques. Voir les fonctions
<code><a href="#topic+inserer_formule.moodle">inserer_formule.moodle</a></code> et
<code><a href="#topic+inserer_SMILES.moodle">inserer_SMILES.moodle</a></code> pour plus de détails.
</p>


<h3>Value</h3>

<p>De façon invisible, une liste des data.frames des questions après
traitement de chaque fichier.  Elle n'a guère d'autre intérêt que pour
détecter l'origine d'un problème de conversion.
</p>


<h3>Attention!</h3>

<p>Moodle est assez peu permissif pour les notes
exprimées en pourcentage; en particulier, lorsque ce pourcentage ne
tombe pas juste (33% pour trois bonnes réponses, par exemple), à
cause de l'arrondi il peut rejeter le fichier créé. Dans ce cas,
désactivez l'arrêt en cas d'erreur et demandez l'arrondi à la note la
plus proche pour pouvoir importer les questions.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>See Also</h3>

<p>Les fonctions de base de création de questions pour plus de souplesse,
et en particulier pour créer des questions non gérées par le format de
fichier ci-dessus.
</p>
<p><code><a href="#topic+csv_optique.moodle">csv_optique.moodle</a></code> pour convertir des fichiers CSV au
format utilisé par les lecteurs optiques.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Conversion du fichier d'exemple fourni
  #  (à placer dans le répertoire de travail)
## Not run: 
  csv.moodle( "exemple_Moodle.csv", colonne.code = "Code" )

## End(Not run)
</code></pre>

<hr>
<h2 id='debuter_xml.moodle'>
Commencer et terminer un questionnaire Moodle
</h2><span id='topic+debuter_xml.moodle'></span><span id='topic+finir_xml.moodle'></span>

<h3>Description</h3>

<p>Ces deux fonctions permettent de commencer et de terminer la
génération d'un questionnaire Moodle au format XML.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>debuter_xml.moodle( fichier.xml,
                    n.chiffres = 2, dec = ",",
                    racine = 2004197487,
                    glossaire = FALSE )

finir_xml.moodle(fichier.xml = get( "fichier.xml", envir = SARP.Moodle.env ))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="debuter_xml.moodle_+3A_fichier.xml">fichier.xml</code></td>
<td>

<p>Pour <code>debuter_xml.moodle</code>, le nom du fichier qui contiendra le
questionnaire moodle au format XML. L'extension .xml est
automatiquement rajoutée, sauf si elle est déjà présente dans ce
nom.
</p>
<p>Pour <code>finir_xml.moodle</code>, le fichier correspondant au
questionnaire à terminer (par défaut, le dernier créé).
</p>
</td></tr>
<tr><td><code id="debuter_xml.moodle_+3A_dec">dec</code></td>
<td>

<p>Le séparateur décimal à utiliser dans les textes. Par défaut, la
virgule (comme utilisé en français). Il est modifié par <code>options</code>.
</p>
</td></tr>
<tr><td><code id="debuter_xml.moodle_+3A_n.chiffres">n.chiffres</code></td>
<td>

<p>Le nombre de décimales à utiliser pour les sorties au format
XML.  Attention, cela n'affecte que les valeurs numériques
explicitement converties en texte par un appel à la fonction
<code>afficher_nombre.moodle</code>.
</p>
</td></tr>
<tr><td><code id="debuter_xml.moodle_+3A_racine">racine</code></td>
<td>

<p>La racine (graine) à utiliser pour le générateur de nombres
aléatoires, afin d'avoir une génération de questionnaires
reproductible. Utilisez <code>NA</code> pour ne pas définir la graine.
</p>
</td></tr>
<tr><td><code id="debuter_xml.moodle_+3A_glossaire">glossaire</code></td>
<td>

<p>Si <code>TRUE</code>, le fichier XML créé est au format permettant de
construire un glossaire. Sinon, c'est le format XML moodle
« classique » qui est utilisé.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p> Lorsque l'on débute un questionnaire avec
<code>debuter_xml.moodle</code>, le fichier XML est créé avec son
en-tête. Le descripteur de fichier est mémorisé dans l'environnement
de la bibliothèque : toutes les fonctions ultérieures utiliseront ce
fichier par défaut pour écrire les questions créées. Attention, en cas
d'appels multiples pour travailler sur plusieurs questionnaires en
parallèle, seul le dernier fichier créé est mémorisé.
</p>


<h3>Value</h3>

<p> La fonction <code>debuter_xml.moodle</code> renvoie un descripteur de
fichier correspondant au questionnaire nouvellement créé. Ce
descripteur peut être utilisé par toutes les fonctions de la
bibliothèque, mais aussi par la fonction <code><a href="base.html#topic+cat">cat</a></code> de R
directement, si nécessaire.
</p>
<p>La fonction <code>finir_xml.moodle</code> ne renvoie rien.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>See Also</h3>

 <p><code><a href="base.html#topic+options">options</a>( OutDec )</code> pour le choix du séparateur
décimal à l'affichage.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Commencer un nouveau questionnaire
q &lt;- debuter_xml.moodle( "exemple" )

# Une question Moodle basique
vrai_faux.moodle( "Cette question a deux réponses" )

# On termine le questionnaire
finir_xml.moodle( )

# Importez le fichier exemple.xml dans Moodle pour voir le résultat...
print(
"Importez le fichier exemple.xml dans Moodle pour voir le résultat..." )

## End(Not run)
</code></pre>

<hr>
<h2 id='definir_dossier.image.moodle'>
Insérer une image dans une question
</h2><span id='topic+definir_dossier.image.moodle'></span><span id='topic+lier_image.moodle'></span><span id='topic+inserer_image.moodle'></span><span id='topic+coder_image.moodle'></span>

<h3>Description</h3>

<p>Ces fonctions permettent de créer des liens vers des images dans les
questions Moodle (texte, mais aussi réponses).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>definir_dossier.image.moodle( URL, local = FALSE, ajouter = TRUE,
                              silencieux = FALSE )

lier_image.moodle( nom.image, largeur = -1, hauteur = -1,
                   description = NULL, interne = FALSE )

coder_image.moodle( nom.image,
                    dossier.image = get( "dossier.images",
                                         envir = SARP.Moodle.env ) )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="definir_dossier.image.moodle_+3A_url">URL</code></td>
<td>
<p> L'URL du dossier ou de l'activité Moodle contenant les
images à lier. Voyez les détails pour plus d'information. Ce doit
être un vecteur de type <code>character</code>, ne contenant qu'un seul
élément.</p>
</td></tr>
<tr><td><code id="definir_dossier.image.moodle_+3A_local">local</code></td>
<td>
<p> Précise si l'URL indiquée est locale (<code>TRUE</code>) ou
sur le serveur Moodle (<code>FALSE</code>). </p>
</td></tr>
<tr><td><code id="definir_dossier.image.moodle_+3A_ajouter">ajouter</code></td>
<td>
<p> Pour une URL locale, indique elle doit être ajoutée à
la liste des dossiers de recherche des fichiers (<code>TRUE</code>) ou
remplacer cette liste (<code>FALSE</code>). </p>
</td></tr>
<tr><td><code id="definir_dossier.image.moodle_+3A_silencieux">silencieux</code></td>
<td>
<p> Si <code>TRUE</code>, les messages indiquant les URL
enregistrées sont supprimés.</p>
</td></tr>
<tr><td><code id="definir_dossier.image.moodle_+3A_nom.image">nom.image</code></td>
<td>
<p>Le nom du fichier contenant l'image. Si l'image est
externe au fichier XML, ce doit être le nom tel qu'il apparaîtra
dans le dossier moodle : attention aux conversions de caractères que
peut faire Moodle lors de l'import d'un fichier... Ce doit être un
vecteur de type <code>character</code> contenant un seul élément. </p>
</td></tr>
<tr><td><code id="definir_dossier.image.moodle_+3A_dossier.image">dossier.image</code></td>
<td>
<p>Le nom du dossier contenant l'image, en local. </p>
</td></tr>
<tr><td><code id="definir_dossier.image.moodle_+3A_largeur">largeur</code>, <code id="definir_dossier.image.moodle_+3A_hauteur">hauteur</code></td>
<td>
<p> Les dimensions d'affichage de l'image dans la
question (équivalent des champs <code>height</code> et <code>width</code> de la
balise <code>&lt;img&gt;</code>). Seules les dimensions numériques, finies,
positives sont prises en compte. Toutes les autres valeurs sont
ignorées et le champ correspondant n'est pas créé dans le code
HTML. Ces deux valeurs doivent être des vecteurs numériques
contenant un seul élément.</p>
</td></tr>
<tr><td><code id="definir_dossier.image.moodle_+3A_description">description</code></td>
<td>
<p> Un vecteur de chaîne de caractère, ne contenant
qu'un seul élément. S'il existe, ce texte sera utilisé comme
description textuelle de l'image (champ <code>alt</code>, fortement
conseillé).  </p>
</td></tr>
<tr><td><code id="definir_dossier.image.moodle_+3A_interne">interne</code></td>
<td>
<p> Indique si l'image est déjà sur Moodle (<code>FALSE</code>)
ou si elle est incluse dans le fichier XML (<code>TRUE</code>). Dans le
premier cas, l'URL de base doit avoir été définie par
<code>definir_dossier.image.moodle</code> (voyez les détails, ci-après).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>La fonction <code>lier_image.moodle</code> crée une balise HTML <code>&lt;img&gt;</code>
avec une URL permettant de trouver l'image. Cette URL est obtenue en
concaténant une racine et le nom du fichier image indiqué.
</p>
<p>Pour une image extérieure au fichier XML, la racine, définie avec la
fonction <code>definir_dossier.image.moodle</code>, peut être n'importe quel
schéma d'URL valide. Le plus souvent, ce sera soit une URL vers un
site externe qui contient les images soit, encore plus fréquemment, une
URL référençant l'image dans Moodle.
</p>
<p>La méthode la plus simple pour obtenir cette racine de l'URL est la
suivante :
</p>

<ol>
<li><p> Créez une activité « Dossier » dans Moodle, cachée aux utilisateurs.
</p>
</li>
<li><p> Dans ce dossier, importez la ou les images, puis enregistrez.
</p>
</li>
<li><p> Affichez le contenu de ce dossier, comme un utilisateur.
</p>
</li>
<li><p> Affichez le code source de la page HTML correspondance (Ctrl-U
avec Firefox)
</p>
</li>
<li><p> Dans ce code source, repérez le nom d'une image, dans un
élément <code>&lt;img src=""&gt;</code>. Ce nom devrait ressembler à
https://votre.site.moodle/pluginfile.php/00000/mod_folder/content/0/votre_image.jpg?forcedownload=1,
où 0000 est un nombre quelconque qui identifie ce dossier dans la
base Moodle.
</p>
</li>
<li><p> Mémorisez cette URL et utilisez-la comme base:
</p>
<pre>definir_dossier.image.moodle("https://votre.site.moodle/pluginfile.php/0000/mod_folder/content/0/" ) </pre>
</li></ol>

<p>Toutes les images situées dans ce dossier (au moment de l'import du
fichier XML ou ajoutées ultérieurement) sont alors directement
utilisables dans la fonction <code>lier_image.moodle</code>, en indiquant
juste leur nom.
</p>
<p>Il est aussi possible d'inclure l'image dans le fichier XML. Pour
cela, précisez <code>interne = TRUE</code> lors de l'appel à
<code>lier_image.moodle</code>.  Lors de la création de la question, les
balises ainsi générées seront identifiées et les images encodées dans
le fichier XML, avec la fonction <code>coder_image.moodle</code>. Attention
cependant, les chemins d'accès locaux étant perdus, les fichiers
contenant les images doivent se trouver dans le répertoire de travail
au moment de la création de la question. Il est cependant possible
d'indiquer un ou plusieurs dossiers locaux d'images différents, avec
<code>definir_dossier.image.moodle</code>, en précisant <code>local = TRUE</code>.
Si un fichier correspondant à l'image est trouvé dans plusieurs de ces
dossiers, seule le premier est utilisé avec un avertissement.  Les
dossiers sont cherchés dans l'ordre d'ajout à la liste des dossiers de
recherche, le dernier ajouté étant exploré en premier; un appel à
<code>definir_dossier.image.moodle</code> pour un dossier déjà dans la liste
le replace en haut de la liste.  La liste des dossiers peut être
remplacée par un seul dossier avec l'option <code>ajouter = FALSE</code> de
<code>definir_dossier.image.moodle</code>.
</p>


<h3>Value</h3>

<p>La fonction <code>lier_image.moodle</code> renvoie une chaîne de caractère
qui contient le code HTML créé. Cette chaîne peut ensuite être
utilisée, directement ou après concaténation avec d'autres éléments,
dans la constitution des textes ou des réponses de n'importe quelle
question moodle.
</p>
<p>La fonction <code>coder_image.moodle</code> renvoie une chaîne de caractère
qui contient le code XML permettant d'intégrer l'image dans le fichier
XML, y compris son encodage en base 64. Cette chaîne peut ensuite être
utilisée dans la constitution des élements d'une question moodle.
Attention cependant, savoir où le mettre dans le fichier XML n'est pas
trivial: normalement, l'utilisation de cette fonction ne devrait pas
être nécessaire, si <code>lier_image.moodle</code> a été utilisée
correctement.  
</p>


<h3>Attention</h3>

<p>Vous devez appeler au moins une fois la fonction
<code>definir_dossier.image.moodle</code> pour pouvoir ensuite lier des
images externes au fichier XML.
</p>
<p>Au moment de la création du fichier XML, il n'y a aucun moyen de
vérifier que l'URL indiquée est correcte...
</p>


<h3>Astuce</h3>

<p>Pour importer plusieurs images en une fois, vous avez
tout intérêt à les regrouper dans une archive au format zip, que vous
décompresserez après l'avoir importée dans le dossier moodle ciblé.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+inserer_formule.moodle">inserer_formule.moodle</a></code> pour insérer une formule
mathématique à l'aide d'un code latex;
<code><a href="#topic+inserer_SMILES.moodle">inserer_SMILES.moodle</a></code> pour insérer une formule chimique
à l'aide d'un code SMILES.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Commencer un nouveau questionnaire
q &lt;- debuter_xml.moodle( "exemple.image" )

# On crée une image quelconque
png( "essai.png", width = 640, height = 400 )
qqnorm( rnorm( 20 ), pch = 19 )
dev.off()

# On pose une question là-dessus
vrai_faux.moodle( paste0( "Le graphe ci-dessous est un diagramme de Henry",
                          "&lt;br /&gt;\n",
                          lier_image.moodle( "essai.png", interne = TRUE ) ) )

# On termine le questionnaire
finir_xml.moodle( )

# Importez le fichier exemple.image.xml dans Moodle pour voir le résultat...
print( "Importez le fichier exemple.image.xml dans Moodle pour voir le résultat..." )

# Le code XML...
coder_image.moodle( "essai.png" )

## End(Not run)
</code></pre>

<hr>
<h2 id='description.moodle'>
Créer une question Moodle contenant simplement du texte
</h2><span id='topic+description.moodle'></span>

<h3>Description</h3>

<p>Cette fonction permet de créer une question de type description pour Moodle.</p>


<h3>Usage</h3>

<pre><code class='language-R'>description.moodle( texte,
                    titre = "Description",
                    commentaire.global = NA, 
                    idnum = NA, 
                    fichier.xml = get( "fichier.xml", envir = SARP.Moodle.env ) )

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="description.moodle_+3A_texte">texte</code></td>
<td>
<p> Le texte de la question (une chaîne de caractères). Cet
énoncé peut contenir n'importe quel caractère (codage en UTF-8) et
n'importe quelles balises HTML. </p>
</td></tr>
<tr><td><code id="description.moodle_+3A_titre">titre</code></td>
<td>
<p> L'intitulé de la question, en HTML. </p>
</td></tr>
<tr><td><code id="description.moodle_+3A_fichier.xml">fichier.xml</code></td>
<td>
<p> Le fichier correspondant au questionnaire qui
contiendra cette question (par défaut, le dernier créé).  </p>
</td></tr>
<tr><td><code id="description.moodle_+3A_commentaire.global">commentaire.global</code>, <code id="description.moodle_+3A_idnum">idnum</code></td>
<td>
<p>Option commune à toutes les questions
Moodle, voyez <code><a href="#topic+debut_question.moodle">debut_question.moodle</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='df.moodle'>
Convertir une data.frame en questions Moodle
</h2><span id='topic+df.moodle'></span>

<h3>Description</h3>

<p>Cette fonction permet de convertir une data.frame, convenablement
construit, en un fichier XML de questions pour Moodle
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df.moodle( d,
           colonne.texte = NA, colonne.reponse = NA,
           colonne.note = NA, colonne.note_question = NA,
           colonne.titre = NA,
           colonne.code = NA, colonne.type = NA,
           colonne.retour = NA, colonne.global = NA,
           colonne.penalite = NA,
           colonne.temps = NA, colonne.decimale = NA,
           fichier.xml,
           creer.titre = TRUE, lg.titre = 30,
           embellir = TRUE, deja.HTML = FALSE,
           forcer.multiple = TRUE, melanger.reponses = TRUE,
           somme.nulle = FALSE, precision = 3,
           categorie.base = "",
           dossier.images, 
           sep.images = c( '@@', '@@' ), inserer.images = TRUE,
           sep.formules = c( '@\\$', '\\$@' ),
           sep.SMILES = c( '@\\{', '\\}@' ),
           nom.fichier = deparse( substitute( d ) ) )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df.moodle_+3A_d">d</code></td>
<td>

<p>La data.frame à convertir.
</p>
</td></tr>
<tr><td><code id="df.moodle_+3A_colonne.texte">colonne.texte</code></td>
<td>
<p> Le nom ou le numéro de la colonne qui contient
l'énoncé des questions. Si elle n'est pas indiquée, une colonne
intitulée « Texte » est cherchée dans le fichier. Cette colonne est
obligatoire.  </p>
</td></tr>
<tr><td><code id="df.moodle_+3A_colonne.reponse">colonne.reponse</code></td>
<td>

<p>Le nom ou le numéro de la colonne qui contient la ou les réponses
aux questions. Si elle n'est pas indiquée, une colonne
intitulée « Réponse » est cherchée dans le fichier. Cette colonne est
obligatoire. 
</p>
</td></tr>
<tr><td><code id="df.moodle_+3A_colonne.note">colonne.note</code></td>
<td>
<p> Le nom ou le numéro de la colonne qui contient la
note associée à chaque réponse. Si elle n'est pas indiquée, une
colonne intitulée « Note » (insensible à la casse) est cherchée dans
le fichier. Cette colonne est obligatoire en cas de question à
réponses multiples. Elle peut alors contenir soit le pourcentage de
la note (voir les détails), soit « Vrai » ou « Faux » (insensible à
la casse) et les pourcentages sont calculés en conséquence (avec
toujours 0 pour « Faux » : indiquez explicitement un pourcentage
négatif si nécessaire).  </p>
</td></tr>
<tr><td><code id="df.moodle_+3A_colonne.note_question">colonne.note_question</code></td>
<td>
<p> Le nom ou le numéro de la colonne qui
contient la note globale de la question. Si elle n'est pas indiquée,
une colonne intitulée « Note question » (insensible à la casse) est
cherchée dans le fichier. Cette colonne est facultative. Si elle
existe, elle doit contenir un entier strictement positif donnant la
note globale de la question, ou rester vide. Toute note non indiquée
sera supposée égale à 1 (valeur par défaut de Moodle).</p>
</td></tr>
<tr><td><code id="df.moodle_+3A_colonne.titre">colonne.titre</code></td>
<td>

<p>Le nom ou le numéro de la colonne qui contient le titre à donner à
la question dans Moodle. Si elle est manquante, le titre est
construit, sous la forme <code>xx yy</code> où <code>yy</code> correspond aux
<code>lg.titre</code> premiers caractères de la question, et <code>xx</code> au
code de la question.
</p>
</td></tr>
<tr><td><code id="df.moodle_+3A_colonne.code">colonne.code</code></td>
<td>

<p>Le nom ou le numéro de la colonne qui contient le code de la
question. Cette colonne n'est obligatoire que pour créer des
questions « cloze ». Si elle est manquante, un code interne de la
forme <code>[Qnn]</code>, où <code>nn</code> est le numéro de la question, est
construit, chaque question correspondant à une ligne avec les deux
colonnes <code>colonne.texte</code> et <code>colonne.reponse</code>
renseignées. Voyez les détails pour davantage de précisions.
</p>
</td></tr>
<tr><td><code id="df.moodle_+3A_colonne.type">colonne.type</code></td>
<td>

<p>Le nom ou le numéro de la colonne qui contient le type de la
question. Cette colonne peut être utilisée pour indiquer qu'une
question avec plusieurs réponses proposées n'a qu'une seule réponse
possible, en indiquant QCU pour au moins une des réponses (question
à choix unique); QCM permet d'indiquer que l'on peut cocher
plusieurs réponses (question à choix multiples). Dans ce cas,
<code>forcer.multiple</code> est ignoré.
</p>
</td></tr>
<tr><td><code id="df.moodle_+3A_colonne.retour">colonne.retour</code></td>
<td>

<p>Le nom ou le numéro de la colonne qui contient le commentaire à
afficher pour chaque réponse. Cette colonne est facultative.
</p>
</td></tr>
<tr><td><code id="df.moodle_+3A_colonne.global">colonne.global</code></td>
<td>

<p>Le nom ou le numéro de la colonne qui contient le commentaire à
afficher globalement pour la question. Cette colonne est facultative.
</p>
</td></tr>
<tr><td><code id="df.moodle_+3A_colonne.penalite">colonne.penalite</code></td>
<td>
<p> Le nom ou le numéro de la colonne qui
contient la pénalité à mettre en cas de nouvelle tentative de la
question. Si elle n'est pas indiquée, une colonne intitulée «
Pénalité » (insensible à la casse) est cherchée dans le
fichier. Cette colonne est facultative. Si elle existe, elle doit
contenir la fraction de la note globale de la
question qui sera prise en compte pour noter la nouvelle tentative
(par exemple, si la question a une note globale de 2 et la pénalité
est de 0,5, à la seconde tentative la note maximale possible sera de
1) ou rester vide. Toute pénalité non indiquée sera supposée
égale à 1 (pas de pénalité en cas de nouvelle tentative).
</p>
</td></tr>
<tr><td><code id="df.moodle_+3A_colonne.temps">colonne.temps</code></td>
<td>
<p> Le nom ou le numéro de la colonne qui contient
le temps conseillé pour la question. Cette colonne est
facultative.  Lorsqu'elle est présente, et renseignée, un texte
indiquant le temps conseillé pour répondre est ajouté à l'énoncé de
la question.
</p>
</td></tr>
<tr><td><code id="df.moodle_+3A_colonne.decimale">colonne.decimale</code></td>
<td>
<p> Le nom ou le numéro de la colonne qui contient
le nombre de chiffres après la virgule attendu pour la réponse à la
question (pour les questions numériques uniquement). Cette colonne
est facultative.  </p>
</td></tr>
<tr><td><code id="df.moodle_+3A_fichier.xml">fichier.xml</code></td>
<td>
<p> Le nom du fichier XML, créé avec
<code><a href="#topic+debuter_xml.moodle">debuter_xml.moodle</a></code>, dans lequel créer les questions
que contient la data.frame.  </p>
</td></tr>
<tr><td><code id="df.moodle_+3A_creer.titre">creer.titre</code></td>
<td>

<p>Une valeur logique indiquant si l'on veut créer un titre pour chaque
question, à partir de son code et du début de son énoncé
(<code>TRUE</code>) ou non. Ignoré si une colonne de titres a été fournie.
</p>
</td></tr>
<tr><td><code id="df.moodle_+3A_lg.titre">lg.titre</code></td>
<td>

<p>Le nombre de caractères de l'énoncé d'une question à conserver pour
construire son titre. Ignoré si une colonne de titres a été fournie
ou si <code>creer.titre=FALSE</code>.
</p>
</td></tr>
<tr><td><code id="df.moodle_+3A_embellir">embellir</code>, <code id="df.moodle_+3A_deja.html">deja.HTML</code></td>
<td>

<p>Actuellement inutilisés, prévus pour une version future
</p>
</td></tr>
<tr><td><code id="df.moodle_+3A_forcer.multiple">forcer.multiple</code></td>
<td>

<p>Si <code>TRUE</code>, les questions avec plusieurs réponses sont toujours
considérées comme des réponses à choix multiples (l'étudiant pourra
cocher plusieurs réponses). Sinon, si une seule bonne réponse est
proposée (plus exactement, s'il existe au moins une réponse donnant 100 % des
points), la question est à choix unique (l'étudiant ne pourra
choisir qu'une seule réponse).  Cette option est ignorée pour les
questions qui auraient une valeur indiquée dans la colonne précisée
dans <code>colonne.type</code>.
</p>
</td></tr>
<tr><td><code id="df.moodle_+3A_melanger.reponses">melanger.reponses</code></td>
<td>

<p>Si <code>TRUE</code>, autorise Moodle à permuter aléatoirement l'ordre des
réponses lorsqu'il pose la question. Sinon, l'ordre du fichier est
tout le temps utilisé.
</p>
</td></tr>
<tr><td><code id="df.moodle_+3A_somme.nulle">somme.nulle</code></td>
<td>

<p>Cette option précise comment gérer les réponses incorrectes dans un
QCM.  Si <code>FALSE</code>, la note de ces réponses est déterminée à
partir du fichier, le code FAUX étant associé à une note nulle.
Si <code>TRUE</code>, les réponses incorrectes se voient attribuer une
note négative telle que la somme de ces notes vaut -1, de sorte que
si l'étudiant coche toutes les cases du QCM, il a 0 (sauf bien sûr
si toutes les cases correspondent à des questions correctes...).
</p>
</td></tr>
<tr><td><code id="df.moodle_+3A_precision">precision</code></td>
<td>
<p>Le nombre de décimales à donner dans la réponse, pour
une réponse numérique (utilisez <code>NA</code> pour une valeur exacte et
ne pas avoir de message indiquant le nombre de décimales ajouté au
texte de la question).
</p>
</td></tr>
<tr><td><code id="df.moodle_+3A_categorie.base">categorie.base</code></td>
<td>

<p>La catégorie de base à utiliser pour créer les questions. Elle
contiendra toutes les sous-catégories du fichier, s'il y en a.
</p>
</td></tr>
<tr><td><code id="df.moodle_+3A_dossier.images">dossier.images</code></td>
<td>
<p> Le dossier d'image où trouver les images à
intégrer au fichier XML, ou l'URL de base pour les trouver dans
Moodle (voir <code><a href="#topic+definir_dossier.image.moodle">definir_dossier.image.moodle</a></code>). </p>
</td></tr>
<tr><td><code id="df.moodle_+3A_sep.images">sep.images</code></td>
<td>
<p> Les codes servant à encadrer un nom d'image dans
les textes du fichier CSV. </p>
</td></tr>
<tr><td><code id="df.moodle_+3A_inserer.images">inserer.images</code></td>
<td>
<p> Si <code>TRUE</code>, les images sont incluses dans
le fichier XML. Sinon, seul le lien est construit. </p>
</td></tr>
<tr><td><code id="df.moodle_+3A_sep.formules">sep.formules</code></td>
<td>
<p> Les codes servant à encadrer une formule
mathématique à convertir grâce à latex dans les textes du fichier
CSV. </p>
</td></tr>
<tr><td><code id="df.moodle_+3A_sep.smiles">sep.SMILES</code></td>
<td>
<p> Les codes servant à encadrer un code SMILES à
convertir en formule chimique grâce à openbabel dans les textes du
fichier CSV. </p>
</td></tr>
<tr><td><code id="df.moodle_+3A_nom.fichier">nom.fichier</code></td>
<td>
<p> Le nom à utiliser pour créer les titres et la
catégorie de base des questions générées à partir de cette
data.frame. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Cette fonctions réalise la conversion d'une data.frame
de questions pour Moodle en un fichier XML. La nature des questions
est déduite de la structure de la data.frame.
</p>
<p>Cette data.frame doit comporter au moins deux colonnes : l'une avec
les énoncés des questions et l'autre avec les réponses. Chaque ligne
correspond à une réponse possible.
</p>
<p>S'il y a un énoncé, mais pas de réponse, cet énoncé est supposé être
une indication de catégorie (sauf si la question a le même code qu'une
question « cloze », voir plus loin, ou si la colonne précisant le type
de question indique un type particulier) qui sera créée comme une
sous-catégorie de la catégorie de base, par un appel à
<code><a href="#topic+categorie.moodle">categorie.moodle</a></code>.
</p>
<p>Pour les questions simples, la question tient sur une ligne. La nature
de la question est déduite de la réponse. Si la réponse peut être
convertie en nombre, la question est supposée être une réponse
numérique; elle sera créée avec un appel à
<code><a href="#topic+numerique.moodle">numerique.moodle</a></code>.  Si la réponse est identifiée comme
une valeur logique (un des textes « V », « F », « T », « Vrai », «
Faux », « True » ou « False », quelle que soit la casse), la question
est supposée être une question binaire avec les deux réponses « Vrai »
et « Faux »; elle sera créée avec un appel à
<code><a href="#topic+vrai_faux.moodle">vrai_faux.moodle</a></code>.  Dans tous les autres cas, la question
est supposée être à réponse ouverte et courte et sera créée par un
appel à <code><a href="#topic+qroc.moodle">qroc.moodle</a></code>.
</p>
<p>S'il y a une réponse, mais pas d'énoncé, cette réponse est supposée
être une autre réponse possible à une question à choix multiple, dont
l'énoncé est dans la première ligne précédente qui en contient un.
Dans ce cas, le fichier doit contenir une colonne qui contient les
notes associées à chaque réponse. Cette note peut être précise,
exprimée en pourcentage suivant la convention Moodle, ou indicative,
avec la simple mention « Vrai » pour les bonnes réponses et « Faux »
pour les mauvaises. Dans le deuxième cas, les bonnes réponses sont
associées à l'inverse du nombre de bonnes réponses, de sorte que
cocher toutes les bonnes réponses donne la note totale; les mauvaises
réponses sont associées à la note 0 (si <code>somme.nulle=FALSE</code>:
cocher ou non ces réponses ne change rien à la note) ou à l'opposé de
l'inverse du nombre de mauvaises réponses (si <code>somme.nulle=TRUE</code>:
cocher ces réponses diminue la note et cocher toutes les réponses
donne une somme nulle).  Par défaut, la question construite est
toujours un QCM (plusieurs réponses peuvent être choisies), même s'il
y a une seule bonne réponse. Pour demander qu'une seule réponse puisse
être choisie (QCU), indiquez le type QCU dans la colonne indiquée par
<code>colonne.type</code> pour la question considérée. Si vous voulez que
toutes les questions avec une seule bonne réponse soient en QCU, vous
pouvez aussi utiliser l'option <code>forcer.multiple = FALSE</code>.
</p>
<p><strong>Construire des questions &ldquo;<em>cloze</em>&rdquo;</strong>
</p>
<p>Pour pouvoir construire des questions &ldquo;<em>cloze</em>&rdquo;, le
fichier doit obligatoirement contenir une colonne qui indique le code
de chaque question (y compris les catégories). Ce code doit être
unique pour une même question; toutes les lignes qui auront le même
code seront donc considérées comme faisant partie de la même question.
</p>
<p>De ce fait, si plusieurs lignes d'énoncé renseignées ont le même code,
elles sont considérées faisant partie de la même question et sont
utilisées pour construire une question &ldquo;<em>cloze</em>&rdquo;, selon le
même principe que la fonction <code><a href="#topic+question_libre.moodle">question_libre.moodle</a></code>:
après chaque partie d'énoncé, un champ de réponse est créé, dont la
bonne réponse est celle indiquée dans la colonne
<code>colonne.reponse</code> et sert à définir le type de champ de réponse
(selon la logique des questions en une ligne).  Pour avoir un texte
après le dernier champ de réponse, laissez la colonne
<code>colonne.reponse</code> vide tout en gardant le même code de question.
</p>
<p>Pour avoir des questions avec réponse à choisir dans une liste, mettez
une réponse par ligne sans mettre d'énoncé avant, comme pour un QCM.
La colonne <code>colonne.type</code> permet de préciser le type d'affichage,
avec les codes Moodle (<code>MULTICHOICE</code>, <code>MULTICHOICE_S</code>...).
Il est possible d'abréger le code: M correspond à un choix dans un
menu déroulant (une seule réponse possible ; <code>MULTICHOICE</code>) ; H,
à des réponses juxtaposés (<code>MULTICHOICE_H</code>) ; V, à des réponses
superposées (<code>MULTICHOICE_V</code>) ; SA, à un champ libre attendant
une réponse courte, de type Q. R. O. C. (<code>SHORTANSWER</code>).  Pour
les réponses superposées ou juxtaposés, par défaut, une seule réponse
peut être choisie et l'ordre est celui indiqué dans le fichier. Il est
possible d'indiquer que plusieurs réponses peuvent être choisies en
ajoutant le code M (VM, HM) ; il est possible de demander à Moodle de
tirer au sort l'ordre des réponses en ajoutant le code A (MA, VA,
VMA...) ou S (MS, VS...).  Pour le champ libre, par défaut la casse
est ignorée. Il est possible d'indiquer que la casse doit être
contrôlée grâce au code SAC (<code>SHORTANSWER_C</code>). L'ordre des codes
n'a pas d'importance (HM et MH donneront tous deux une question de
type <code>MULTICHOICE_H</code>).
</p>
<p><strong>Insérer des images</strong>
</p>
<p>Il est possible de faire référence à une image dans les textes
(énoncés, réponses, commentaires) en encadrant le nom de fichier de
l'image par les séparateurs choisis, par défaut <code>@@</code>. Il est
possible de redimensionner l'image en faisant suivre le nom de l'image
d'un point d'exclamation, puis de la largeur, du caractère x et de la
hauteur.  Attention, il semblerait que Moodle ne déforme pas les
images, quelles que soient les dimensions demandées.  Par défaut,
l'image sera incluse au fichier XML.
</p>
<p>Deux types d'image peuvent être créés au vol : les formules
mathématiques et les formules chimiques. Voir les fonctions
<code><a href="#topic+inserer_formule.moodle">inserer_formule.moodle</a></code> et
<code><a href="#topic+inserer_SMILES.moodle">inserer_SMILES.moodle</a></code> pour plus de détails.
</p>


<h3>Value</h3>

<p>De façon invisible, une liste des data.frames des questions après
traitement de chaque fichier.  Elle n'a guère d'autre intérêt que pour
détecter l'origine d'un problème de conversion.
</p>


<h3>Attention!</h3>

<p>Moodle est assez peu permissif pour les notes
exprimées en pourcentage; en particulier, lorsque ce pourcentage ne
tombe pas juste (33% pour trois bonnes réponses, par exemple), à
cause de l'arrondi il peut rejeter le fichier créé. Dans ce cas,
désactivez l'arrêt en cas d'erreur et demandez l'arrondi à la note la
plus proche pour pouvoir importer les questions.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>See Also</h3>

<p>Les fonctions de base de création de questions pour plus de souplesse,
et en particulier pour créer des questions non gérées par le format de
fichier ci-dessus.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Conversion du fichier d'exemple fourni
  #  (à placer dans le répertoire de travail)
## Not run: 
  csv.moodle( "exemple_Moodle.csv", colonne.code = "Code" )

## End(Not run)
</code></pre>

<hr>
<h2 id='glisser_deposer.moodle'>
Créer une question demandant de placer des éléments à des positions
précises d'une image
</h2><span id='topic+glisser_deposer'></span><span id='topic+glisser_deposer.moodle'></span>

<h3>Description</h3>

<p> Cette fonction permet de créer une question dans laquelle
le but est de placer des éléments sur une image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glisser_deposer.moodle( texte, titre = "Glisser-d\u00e9poser...",
                        f.creer_figure,
                        fichier.image,
                        x.zones, y.zones, txt.zones,
                        indications = paste0( "Zone ", 1:n.zones ),
                        img.zones = NULL, zone.unique = TRUE,
                        grp.zones = rep( 1, n.zones ),
                        ordre.aleatoire = TRUE,
                        commentaire.global = NA,
                        penalite = NA, note.question = NA, idnum = NA,
                        temps,
                        fichier.xml = get( "fichier.xml",
                                           envir = SARP.Moodle.env ),
                        ... )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glisser_deposer.moodle_+3A_texte">texte</code></td>
<td>
<p> L'énoncé de la question (une chaîne de caractères). Cet
énoncé peut contenir n'importe quel caractère (codage en UTF-8) et
n'importe quelles balises HTML.  </p>
</td></tr>
<tr><td><code id="glisser_deposer.moodle_+3A_titre">titre</code></td>
<td>
<p> L'intitulé de la question, en HTML. </p>
</td></tr>
<tr><td><code id="glisser_deposer.moodle_+3A_f.creer_figure">f.creer_figure</code></td>
<td>
<p> La fonction qui va construire l'image et les
zones sur lesquelles déposer les éléments (voyez les détails,
ci-dessous). </p>
</td></tr>
<tr><td><code id="glisser_deposer.moodle_+3A_fichier.image">fichier.image</code></td>
<td>
<p> Le nom du fichier contenant l'image à
légender. Ignoré si <code>f.creer_figure</code> est fournie.</p>
</td></tr>
<tr><td><code id="glisser_deposer.moodle_+3A_x.zones">x.zones</code>, <code id="glisser_deposer.moodle_+3A_y.zones">y.zones</code></td>
<td>
<p> Les coordonnées des coins supérieurs, gauches
des zones à définir sur l'image. Ignoré si <code>f.creer_figure</code> est
fournie. </p>
</td></tr>
<tr><td><code id="glisser_deposer.moodle_+3A_txt.zones">txt.zones</code></td>
<td>
<p> Les textes à utiliser pour les marques à placer sur
les zones (dans le même ordre que les coordonnées). Ignoré si
<code>f.creer_figure</code> est fournie. </p>
</td></tr>
<tr><td><code id="glisser_deposer.moodle_+3A_indications">indications</code></td>
<td>
<p> Les textes à afficher sur les zones de l'image
pour les identifier. </p>
</td></tr>
<tr><td><code id="glisser_deposer.moodle_+3A_img.zones">img.zones</code></td>
<td>
<p> Les noms des fichiers contenant les images à
utiliser pour chaque marque.  Ignoré si <code>f.creer_figure</code> est
fournie. </p>
</td></tr>
<tr><td><code id="glisser_deposer.moodle_+3A_zone.unique">zone.unique</code></td>
<td>
<p> Un vecteur aussi long que le nombre de zones,
indiquant si l'étiquette associée peut être réutilisée après avoir
été placée dans une zone (<code>FALSE</code>) ou non (<code>TRUE</code>). Ignoré
si <code>f.creer_figure</code> est fournie.  </p>
</td></tr>
<tr><td><code id="glisser_deposer.moodle_+3A_grp.zones">grp.zones</code></td>
<td>
<p> Un vecteur d'entiers aussi long que le nombre de
zones, indiquant à quel groupe d'étiquette appartient chacune des
étiquettes. L'apparence de l'étiquette (forme, couleur) dépend de ce
groupe.  Ignoré si <code>f.creer_figure</code> est fournie.  </p>
</td></tr>
<tr><td><code id="glisser_deposer.moodle_+3A_ordre.aleatoire">ordre.aleatoire</code></td>
<td>
<p>Si <code>TRUE</code>, l'ordre des marques est permuté
aléatoirement dans le fichier</p>
</td></tr>
<tr><td><code id="glisser_deposer.moodle_+3A_commentaire.global">commentaire.global</code>, <code id="glisser_deposer.moodle_+3A_penalite">penalite</code>, <code id="glisser_deposer.moodle_+3A_note.question">note.question</code>, <code id="glisser_deposer.moodle_+3A_idnum">idnum</code></td>
<td>
<p>Options
communes à toutes les questions Moodle, voyez
<code><a href="#topic+debut_question.moodle">debut_question.moodle</a></code>.</p>
</td></tr>
<tr><td><code id="glisser_deposer.moodle_+3A_temps">temps</code></td>
<td>
<p> Le temps conseillé pour répondre à la question, en
minutes. </p>
</td></tr>
<tr><td><code id="glisser_deposer.moodle_+3A_fichier.xml">fichier.xml</code></td>
<td>
<p> Le fichier correspondant au questionnaire qui
contiendra cette question (par défaut, le dernier créé).  </p>
</td></tr>
<tr><td><code id="glisser_deposer.moodle_+3A_...">...</code></td>
<td>
<p> Arguments additionnels qui seront passés à
<code>f.creer_figure</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p> Ce type de question affiche une image et, en-dessous, des
étiquettes textuelles ou formées d'une image à placer sur l'image. Les
étiquettes ont toutes la même apparence (taille, forme, couleur). Les
zones où les placer sont indiquées sur l'image en surimpression et
font la même taille que les étiquettes.  Il est possible de créer des
groupes d'étiquettes (mais ce n'est intéressant que s'il y a au moins
deux étiquettes par groupe, sans quoi la taille de la zone affichée
sur l'image donne la réponse...); la forme et la couleur des
étiquettes varie d'un groupe à l'autre. Attention, les étiquettes d'un
groupe donné ne peuvent pas être placées sur les zones des étiquettes
des autres groupes.  Par défaut, toutes les étiquettes appartiennent
au premier groupe (étiquettes rectangulaires, blanches). La taille des
étiquettes est identique dans un même groupe, définie pour pouvoir
contenir le texte ou l'image le plus grand du groupe.
</p>
<p><b>Utilisation de la fonction <code>f.creer_figure</code></b>
</p>
<p>Avec cette méthode, la fonction se charge de créer le fichier d'image
(au format PNG, dans le dossier temporaire de R) avant d'appeler
<code>f.creer_figure</code>. La fonction <code>f.creer_figure</code> peut alors
utiliser tous les outils graphiques basiques de R pour créer une
figure et les zones à légender sur cette figure. Elle <em>ne</em> doit
<em>pas</em> clore la figure (pas d'appel à <code>dev.off()</code> ou à
<code>graphics.off</code>).
</p>
<p>La fonction <code>f.creer_figure</code> doit renvoyer une <code>data.frame</code>
dont chaque ligne correspond à une zone, et contenant au moins trois
colonnes:
</p>

<ul>
<li> <p>&lsquo;<code>X</code>&rsquo; et &lsquo;<code>Y</code>&rsquo;, indiquant les
coordonnées du coin supérieur, gauche de la zone, exprimées dans le
système d'unité natif du graphe créé avec R (elles seront ensuite
converties en pixels grâce aux fonctions <code><a href="graphics.html#topic+grconvertX">grconvertX</a></code> et
<code><a href="graphics.html#topic+grconvertY">grconvertY</a></code>).;
</p>
</li>
<li> <p>&lsquo;<code>Texte</code>&rsquo;, indiquant le texte de l'étiquette
associée à la zone.
</p>
</li></ul>

<p>La taille de la zone sera déterminée par Moodle en fonction de la
taille de l'étiquette associée à la zone.
</p>
<p>De façon optionnelle, il peut y avoir une colonne &lsquo;Indications&rsquo;
qui contient une indication textuelle sur la zone, une colonne
&lsquo;Images&rsquo; qui contient le nom du fichier contenant l'image à
associer à la zone, une colonne &lsquo;Groupes&rsquo; qui précise à quelle
groupe d'étiquette appartient l'étiquette associée à la zone et une
colonne &lsquo;Unique&rsquo; qui indique si l'étiquette disparaît des
propositions après avoir été placée (<code>TRUE</code>) ou si elle reste,
pouvant alors être placée sur plusieurs zones (<code>FALSE</code>).  Si ces
colonnes sont absentes, l'indication est &ldquo;Zone n°&rdquo; et le numéro
de la zone (de sa ligne dans la <code>data.frame</code>), toutes les
étiquettes ne contiennent que du texte, sont placées dans le même
groupe et ne sont utilisables qu'une seule fois.
</p>
<p>Il est possible de créer des étiquettes ne correspondant à aucune zone
(&ldquo;distracteurs&rdquo;) en indiquant <code>NA</code> pour leurs coordonnées.
</p>
<p><b>Utilisation directe</b>
</p>
<p>Il est aussi possible de préciser une image quelconque, grâce à
l'option <code>fichier.image</code>. Dans ce cas, les options
<code>x.zones</code>, <code>y.zones</code>, <code>txt.zones</code>, <code>indications</code>,
<code>img.zones</code>, <code>grp.zones</code> et <code>zone.unique</code> permettent de
préciser les caractéristiques de chaque zone à définir. Les
coordonnées doivent être indiquées en pixels.  </p>


<h3>Value</h3>

<p>Aucune valeur n'est renvoyée par cette fonction.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+legender_image.moodle">legender_image.moodle</a></code> pour une autre façon de
demander à placer des éléments sur une image;
<code><a href="#topic+glisser_textes.moodle">glisser_textes.moodle</a></code> pour faire glisser des textes dans
un texte à trou.  </p>

<hr>
<h2 id='glisser_textes.moodle'>
Créer une question demandant de replacer des mots dans un texte
</h2><span id='topic+glisser_texte'></span><span id='topic+glisser_textes'></span><span id='topic+glisser_textes.moodle'></span>

<h3>Description</h3>

<p>Cette fonction permet de créer une question dans laquelle il faut
faire glisser des mots pour les replacer dans un texte à trous.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glisser_textes.moodle( texte, titre = "Glisser les textes...",
                       groupe = rep( 1, n.zones ),
                       infini = FALSE,
                       ordre.aleatoire = TRUE, afficher.erreurs = TRUE,
                       commentaire.global = NA, 
                       penalite = NA, note.question = NA, idnum = NA,
                       temps,
                       fichier.xml = get( "fichier.xml",
                                          envir = SARP.Moodle.env ) )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glisser_textes.moodle_+3A_texte">texte</code></td>
<td>
<p> L'énoncé de la question (une chaîne de caractères). Cet
énoncé peut contenir n'importe quel caractère (codage en UTF-8) et
n'importe quelles balises HTML. Les trous à faire dans ce texte
doivent être identifiés par des doubles-crochets (voir les détails). </p>
</td></tr>
<tr><td><code id="glisser_textes.moodle_+3A_titre">titre</code></td>
<td>
<p> L'intitulé de la question, en HTML. </p>
</td></tr>
<tr><td><code id="glisser_textes.moodle_+3A_groupe">groupe</code></td>
<td>
<p> Pour chaque élément à replacer, le groupe auquel il
appartient (voir les détails). L'ordre est l'ordre d'apparition dans
le texte.</p>
</td></tr>
<tr><td><code id="glisser_textes.moodle_+3A_infini">infini</code></td>
<td>
<p> Pour chaque élément à replacer, indique s'il peut être
réutilisé (<code>TRUE</code>) ou s'il disparaît des éléments une fois
placé quelque part (<code>FALSE</code>). L'ordre est l'ordre d'apparition
dans le texte. Si une seule valeur est indiquée, elle sera utilisée
pour tous les éléments. Sinon, il faut indiquer autant de valeurs
que d'éléments. </p>
</td></tr>
<tr><td><code id="glisser_textes.moodle_+3A_ordre.aleatoire">ordre.aleatoire</code></td>
<td>
<p> Les éléments sont par défaut proposés dans
l'ordre de leur numéro. Ce numéro est ici imposé à l'ordre
d'apparition dans le texte. Cette option permet, si elle vaut
<code>TRUE</code> de permuter aléatoirement ces numéros.</p>
</td></tr>
<tr><td><code id="glisser_textes.moodle_+3A_afficher.erreurs">afficher.erreurs</code></td>
<td>
<p> Si <code>TRUE</code>, en cas de réponse incorrecte
à la question, les réponses erronées sont identifiées.</p>
</td></tr>
<tr><td><code id="glisser_textes.moodle_+3A_commentaire.global">commentaire.global</code>, <code id="glisser_textes.moodle_+3A_penalite">penalite</code>, <code id="glisser_textes.moodle_+3A_note.question">note.question</code>, <code id="glisser_textes.moodle_+3A_idnum">idnum</code></td>
<td>
<p>Options
communes à toutes les questions Moodle, voyez
<code><a href="#topic+debut_question.moodle">debut_question.moodle</a></code>.</p>
</td></tr>
<tr><td><code id="glisser_textes.moodle_+3A_temps">temps</code></td>
<td>
<p> Le temps conseillé pour répondre à la question, en
minutes. </p>
</td></tr>
<tr><td><code id="glisser_textes.moodle_+3A_fichier.xml">fichier.xml</code></td>
<td>
<p> Le fichier correspondant au questionnaire qui
contiendra cette question (par défaut, le dernier créé).  </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Cette question permet de proposer un texte dans lequel certains
éléments sont remplacés par un cadre vide, dans lequel doivent être
glissés des éléments.
</p>
<p>Dans l'énoncé fourni, les éléments qui devront être remplacés par des
cadres vides doivent être entourés par des doubles crochets — par
exemple, le texte &ldquo;Le roi [[Henri IV]] de France et de Navarre&rdquo;
apparaîtra dans Moodle avec un trou à la place de &ldquo;[[Henri
IV]]&rdquo; et, sous le texte, une étiquette intitulée &ldquo;Henri IV&rdquo;,
qu'il faudra replacer.
</p>
<p>Les différents éléments à replacer peuvent être organisés en groupes,
qui se distinguent par une couleur légèrement différente et une taille
des étiquettes différentes.
</p>
<p>Afin de ne pas donner d'indication, les trous (et leurs étiquettes)
auront tous la même taille au sein d'un groupe, choisie pour que le
plus long texte tienne dans l'étiquette.
</p>


<h3>Value</h3>

<p>Aucune valeur n'est renvoyée par cette fonction.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+glisser_deposer.moodle">glisser_deposer.moodle</a></code> et
<code><a href="#topic+legender_image.moodle">legender_image.moodle</a></code> pour faire glisser des étiquettes
sur une image.  </p>

<hr>
<h2 id='glossaire.moodle'>
Commencer et terminer la génération de glossaires Moodle
</h2><span id='topic+creer_glossaire.moodle'></span><span id='topic+entree_glossaire.moodle'></span>

<h3>Description</h3>

<p>Ces fonctions permettent de préparer et de remplir un glossaire Moodle au format XML.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>creer_glossaire.moodle( nom.fichier, nom.glossaire, texte.intro,
                        doublons = TRUE )

entree_glossaire.moodle( terme, definition,
                         fichier.xml = get( "fichier.xml", envir = SARP.Moodle.env ) )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glossaire.moodle_+3A_nom.fichier">nom.fichier</code></td>
<td>
<p>Une chaîne de caractères indiquant le
nom du fichier XML, contenant le glossaire, à créer.</p>
</td></tr>
<tr><td><code id="glossaire.moodle_+3A_nom.glossaire">nom.glossaire</code></td>
<td>
<p>Une chaîne de caractères indiquant le
nom du glossaire.</p>
</td></tr>
<tr><td><code id="glossaire.moodle_+3A_texte.intro">texte.intro</code></td>
<td>
<p>Une chaîne de caractères indiquant le
texte décrivant le glossaire.</p>
</td></tr>
<tr><td><code id="glossaire.moodle_+3A_doublons">doublons</code></td>
<td>
<p>Une valeur logique indiquant si les doublons sont
autorisés.</p>
</td></tr>
<tr><td><code id="glossaire.moodle_+3A_terme">terme</code></td>
<td>
<p>Une chaîne de caractères indiquant le
terme à insérer dans le glossaire.</p>
</td></tr>
<tr><td><code id="glossaire.moodle_+3A_definition">definition</code></td>
<td>
<p>Une chaîne de caractères indiquant la définition du
terme à insérer dans le glossaire.</p>
</td></tr>
<tr><td><code id="glossaire.moodle_+3A_fichier.xml">fichier.xml</code></td>
<td>
<p> Le fichier correspondant au glossaire qui
contiendra cette entrée (par défaut, le dernier créé).  </p>
</td></tr>
</table>


<h3>Details</h3>

<p> Ces fonctions permettent de préparer un glossaire Moodle au
format XML.
</p>


<h3>Value</h3>

<p>Aucune valeur n'est renvoyée par cette fonction.
</p>


<h3>Attention</h3>

<p>Le support des glossaires au format XML est
expérimental, en l'absence de documentation officielle.</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>

<hr>
<h2 id='inserer_formule.moodle'>
Insérer une formule mathématique, comme image, grâce à latex
</h2><span id='topic+inserer_formule.moodle'></span>

<h3>Description</h3>

<p>Cette fonction permet de convertir une formule mathématique au format
Latex en image prête à insérer dans un texte.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inserer_formule.moodle( formule, filtre.Moodle = FALSE,
                        displaystyle = TRUE, marge = 2, 
                        couleurs = TRUE, enjoliver = TRUE,
                        cmd.latex = "latex -shell-escape --interaction errorstopmode",
                        packages = c( "amsfonts", "amsmath",
                                      "amssymb" , "dsfont" ),
                        options.convert = list( 'density' = 150,
                                                'outext'  = ".png" ) )

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inserer_formule.moodle_+3A_formule">formule</code></td>
<td>
<p>Une chaîne de caractères contenant la formule
mathématique à convertir, au format latex (sans les délimiteurs).
</p>
</td></tr>
<tr><td><code id="inserer_formule.moodle_+3A_filtre.moodle">filtre.Moodle</code></td>
<td>
<p>Si <code>TRUE</code>, la formule est entourée des
marqueurs permettant à Moodle de faire la conversion, en utilisant
son filtre (qui va dépendre de la configuration faite sur le
serveur).  Cela a l'avantage de faire une base plus légère (pas
d'image...) et un affichage plus harmonieux, mais aussi plus lent et
avec moins de souplesse, puisque les bibliothèques disponibles sont
fonction de l'installation faite. Sinon, elle est convertie en image
localement avec latex et l'image est insérée dans le fichier XML.</p>
</td></tr>
<tr><td><code id="inserer_formule.moodle_+3A_displaystyle">displaystyle</code></td>
<td>
<p>Si <code>TRUE</code>, la commande latex
<code>\displaystyle</code> est ajoutée en début de formule.</p>
</td></tr>
<tr><td><code id="inserer_formule.moodle_+3A_marge">marge</code></td>
<td>
<p>La marge à laisser autour de la formule (en points).</p>
</td></tr>
<tr><td><code id="inserer_formule.moodle_+3A_couleurs">couleurs</code></td>
<td>
<p>Si <code>TRUE</code>, le package &ldquo;xcolor&rdquo; est inclus
et les noms de couleurs usuels sont utilisables.</p>
</td></tr>
<tr><td><code id="inserer_formule.moodle_+3A_enjoliver">enjoliver</code></td>
<td>
<p>Si <code>TRUE</code>, quelques adaptations de la formule
sont faites pour avoir un résultat plus esthétique. Actuellement,
cela correspond à protéger la virgule entre deux chiffres par des
accolades (évitant ainsi une espace après la virgule) et à remplacer
les symboles inégalité large par défaut (&ldquo;\leq&rdquo; et
&ldquo;\geq&rdquo;) par leur version avec l'égalité parallèle au signe
(&ldquo;\leqslant&rdquo; et &ldquo;\geqslant&rdquo;).</p>
</td></tr>
<tr><td><code id="inserer_formule.moodle_+3A_cmd.latex">cmd.latex</code></td>
<td>
<p>Une chaîne de caractères indiquant la commande à
utiliser pour lancer latex</p>
</td></tr>
<tr><td><code id="inserer_formule.moodle_+3A_packages">packages</code></td>
<td>
<p>Un vecteur de chaînes de caractères indiquant les noms
des packages latex à inclure</p>
</td></tr>
<tr><td><code id="inserer_formule.moodle_+3A_options.convert">options.convert</code></td>
<td>
<p>Une liste d'options à passer au package
&ldquo;standalone&rdquo;, utilisé pour créer l'image.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Cette fonction permet de créer une image d'une formule mathématique, à
partir du code latex correspondant.
</p>
<p>La taille de l'image dépend de la longueur de la formule, mais aussi
de la définition choisie pour créer l'image. Il n'est pas très facile
de prévoir la qualité du résultat, puisque la taille du texte dans
Moodle dépend, elle, de la feuille de style choisie et des réglages du
navigateur.  L'option &ldquo;density&rdquo; (par défaut à 150) permet de
modifier cette taille: plus elle est élevée, plus l'image sera grande.
</p>
<p>La conversion est faite avec latex et le package &ldquo;standalone&rdquo;:
les deux doivent être installés et latex exécutable par R pour que la
conversion puisse avoir lieu.
</p>
<p>Les commandes des formules latex commencent par le caractère \, qui
sert de code d'échappement dans R. Il faut donc les protéger en les
doublant (\\) dans les formules.
</p>


<h3>Value</h3>

<p>Une chaîne de caractère contenant le code XML nécessaire pour inclure
une image (contenant la formule créée), et qu'elle soit incluse au
fichier XML au moment de la création de la question.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+inserer_SMILES.moodle">inserer_SMILES.moodle</a></code> pour convertir un code SMILES en
une formule chimique et l'insérer dans une question Moodle.
</p>
<p><code><a href="#topic+lier_image.moodle">lier_image.moodle</a></code> pour insérer une image quelconque.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Création d'une question demandant la définition de la tangente
  #  (Non exécuté car latex non nécessairement installé)
## Not run: 
  # Commencer un nouveau questionnaire
  q &lt;- debuter_xml.moodle( "tangente" )

  # Catégorie : exemples
  categorie.moodle( "Exemples SARP/Latex" )

  # Le format par défaut, avec deux bonnes réponses et trois mauvaises,
  qcm.moodle( "Quelle est la définition de la tangente&amp;thinsp;?",
              inserer_formule.moodle( "\\frac{\\sin x}{\\cos x}" ),
              inserer_formule.moodle( "\\frac{\\cos x}{\\sin x}" ) )

  # On termine le questionnaire
  finir_xml.moodle( )

  # Importez le fichier tangente.xml dans Moodle pour voir le résultat...
  print( "Importez le fichier exemple.xml dans Moodle pour voir le résultat..." )

## End(Not run)
</code></pre>

<hr>
<h2 id='inserer_SMILES.moodle'>
Insérer une formule chimique, comme image, grâce à openbabel
</h2><span id='topic+inserer_SMILES.moodle'></span>

<h3>Description</h3>

<p>Cette fonction permet de convertir une formule chimique définie par un
code SMILES en une image prête à insérer dans un texte.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inserer_SMILES.moodle( code.SMILES, nom.molecule = code.SMILES,
                       largeur = 300, hauteur = 300,
                       couleur.atomes = TRUE,
                       couleur.fond = NA,
                       couleur.liaisons = NA,
                       double.liaisons.asymetrique = FALSE,
                       masquer.terminaux = TRUE,
                       dessiner.CH = FALSE,
                       marges = FALSE,
                       cmd.obabel = "obabel " )

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inserer_SMILES.moodle_+3A_code.smiles">code.SMILES</code></td>
<td>
<p>Une chaîne de caractères contenant le code SMILES à
convertir.  </p>
</td></tr>
<tr><td><code id="inserer_SMILES.moodle_+3A_nom.molecule">nom.molecule</code></td>
<td>
<p>Une chaîne de caractère qui sera utilisée comme
description de l'image, dans le code HTML produit pour Moodle.  </p>
</td></tr>
<tr><td><code id="inserer_SMILES.moodle_+3A_largeur">largeur</code>, <code id="inserer_SMILES.moodle_+3A_hauteur">hauteur</code></td>
<td>
<p>Les dimensions de l'image, en pixels</p>
</td></tr>
<tr><td><code id="inserer_SMILES.moodle_+3A_couleur.atomes">couleur.atomes</code></td>
<td>
<p>Faut-il utiliser le code couleur habituel pour
indiquer les atomes? (Option &ldquo;-xu&rdquo; d'open babel.)</p>
</td></tr>
<tr><td><code id="inserer_SMILES.moodle_+3A_couleur.fond">couleur.fond</code></td>
<td>
<p>Couleur à utiliser pour le fond de l'image
(Option &ldquo;-xb&rdquo; d'open babel; <code>NA</code>: fond par défaut.)</p>
</td></tr>
<tr><td><code id="inserer_SMILES.moodle_+3A_couleur.liaisons">couleur.liaisons</code></td>
<td>
<p>Couleur à utiliser pour les liaisons chimiques
(<code>NA</code>: fond par défaut d'open babel)</p>
</td></tr>
<tr><td><code id="inserer_SMILES.moodle_+3A_double.liaisons.asymetrique">double.liaisons.asymetrique</code></td>
<td>
<p>Option &ldquo;-xs&rdquo; d'open babel.</p>
</td></tr>
<tr><td><code id="inserer_SMILES.moodle_+3A_masquer.terminaux">masquer.terminaux</code></td>
<td>
<p>Faut-il afficher en toutes lettres les
méthyles terminaux? (Option &ldquo;-xC&rdquo; d'open babel.)</p>
</td></tr>
<tr><td><code id="inserer_SMILES.moodle_+3A_dessiner.ch">dessiner.CH</code></td>
<td>
<p>Faut-il afficher en toutes lettres les
atomes de carbone? (Option &ldquo;-xa&rdquo; d'open babel.)</p>
</td></tr>
<tr><td><code id="inserer_SMILES.moodle_+3A_marges">marges</code></td>
<td>
<p>Si <code>FALSE</code>, les marges autour de la formule sont
éliminées (option &ldquo;-xm&rdquo; d'open babel).  Comme les marges
dépendent aussi des dimensions d'image demandées et de la formule
créée, open babel peut laisser des marges assez grandes malgré tout,
aussi l'image est rognée grâce à l'utilitaire &ldquo;convert&rdquo;
(option &ldquo;-trim&rdquo;), qui doit donc aussi être installé et
exécutable par R.</p>
</td></tr>
<tr><td><code id="inserer_SMILES.moodle_+3A_cmd.obabel">cmd.obabel</code></td>
<td>
<p>Une chaîne de caractères indiquant la commande à
utiliser pour lancer open babel</p>
</td></tr>  
</table>


<h3>Details</h3>

<p> Cette fonction permet de créer une image d'une formule
chimique semi-développée, à partir du code SMILES correspondant.
</p>
<p>La conversion est faite avec open babel, qui doit être installé et
exécutable par R pour que la conversion puisse avoir lieu. Par défaut,
pour ne pas avoir de marges, l'utilitaire convert est aussi utilisé.
</p>


<h3>Value</h3>

<p>Une chaîne de caractère contenant le code XML nécessaire pour inclure
une image (contenant la formule créée), et qu'elle soit incluse au
fichier XML au moment de la création de la question.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+inserer_formule.moodle">inserer_formule.moodle</a></code> pour convertir un code latex en
une formule mathématique et l'insérer dans une question Moodle.
</p>
<p><code><a href="#topic+lier_image.moodle">lier_image.moodle</a></code> pour insérer une image quelconque.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Création d'une question demandant quelle est la formule du benzène.
  #  (Non exécuté car open babel et convert non nécessairement installés)
## Not run: 
  # Commencer un nouveau questionnaire
  q &lt;- debuter_xml.moodle( "benzene" )

  # Catégorie : exemples
  categorie.moodle( "Exemples SARP/SMILES" )

  # Le format par défaut, avec deux bonnes réponses et trois mauvaises,
  qcm.moodle( "Quelle est la formule du benzène&amp;thinsp;?",
              inserer_SMILES.moodle( "c1ccccc1" ),
              inserer_SMILES.moodle( "C1CCCCC1" ) )

  # On termine le questionnaire
  finir_xml.moodle( )

  # Importez le fichier benzene.xml dans Moodle pour voir le résultat...
  print( "Importez le fichier benzene.xml dans Moodle pour voir le résultat..." )

## End(Not run)
</code></pre>

<hr>
<h2 id='legender_image.moodle'>
Créer une question demandant de placer des éléments à des positions
précises d'une image
</h2><span id='topic+legender_image'></span><span id='topic+legender_image.moodle'></span>

<h3>Description</h3>

<p> Cette fonction permet de créer une question dans laquelle
le but est de placer des éléments sur une image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>legender_image.moodle( texte, titre = "L\u00e9gender...",
                       f.creer_figure,
                       fichier.image,
                       zones, marques,
                       ordre.aleatoire = TRUE, afficher.erreurs = TRUE,
                       commentaire.global = NA, penalite = NA,
                       note.question = NA, idnum = NA,
                       temps,
                       fichier.xml = get( "fichier.xml",
                                           envir = SARP.Moodle.env ),
                       ... )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="legender_image.moodle_+3A_texte">texte</code></td>
<td>
<p> L'énoncé de la question (une chaîne de caractères). Cet
énoncé peut contenir n'importe quel caractère (codage en UTF-8) et
n'importe quelles balises HTML.  </p>
</td></tr>
<tr><td><code id="legender_image.moodle_+3A_titre">titre</code></td>
<td>
<p> L'intitulé de la question, en HTML. </p>
</td></tr>
<tr><td><code id="legender_image.moodle_+3A_f.creer_figure">f.creer_figure</code></td>
<td>
<p> La fonction qui va construire l'image et les
zones sur lesquelles déposer les éléments (voyez les détails,
ci-dessous). </p>
</td></tr>
<tr><td><code id="legender_image.moodle_+3A_fichier.image">fichier.image</code></td>
<td>
<p> Le nom du fichier contenant l'image à
légender. Ignoré si <code>f.creer_figure</code> est fournie.</p>
</td></tr>
<tr><td><code id="legender_image.moodle_+3A_zones">zones</code></td>
<td>
<p> Une liste décrivant les zones de la figure. Le format
est celui utilisé par f.creer_figure, voyez les détails ci-dessous;
les coordonnées doivent cependant être données directement en
pixels. Ignoré si <code>f.creer_figure</code> est fournie.</p>
</td></tr>
<tr><td><code id="legender_image.moodle_+3A_marques">marques</code></td>
<td>
<p>Une <code>data.frame</code> décrivant les marques à placer
sur la figure. Le format est celui utilisé par f.creer_figure, voyez
les détails ci-dessous. Ignoré si <code>f.creer_figure</code> est fournie.</p>
</td></tr>
<tr><td><code id="legender_image.moodle_+3A_ordre.aleatoire">ordre.aleatoire</code></td>
<td>
<p>Si <code>TRUE</code>, l'ordre des marques est permuté
aléatoirement dans le fichier</p>
</td></tr>
<tr><td><code id="legender_image.moodle_+3A_afficher.erreurs">afficher.erreurs</code></td>
<td>
<p>Si <code>TRUE</code>, en cas de réponse incorrecte à
la question, les réponses erronées sont identifiées.</p>
</td></tr>
<tr><td><code id="legender_image.moodle_+3A_commentaire.global">commentaire.global</code>, <code id="legender_image.moodle_+3A_penalite">penalite</code>, <code id="legender_image.moodle_+3A_note.question">note.question</code>, <code id="legender_image.moodle_+3A_idnum">idnum</code></td>
<td>
<p>Options
communes à toutes les questions Moodle, voyez
<code><a href="#topic+debut_question.moodle">debut_question.moodle</a></code>.</p>
</td></tr>
<tr><td><code id="legender_image.moodle_+3A_temps">temps</code></td>
<td>
<p> Le temps conseillé pour répondre à la question, en
minutes. </p>
</td></tr>
<tr><td><code id="legender_image.moodle_+3A_fichier.xml">fichier.xml</code></td>
<td>
<p> Le fichier correspondant au questionnaire qui
contiendra cette question (par défaut, le dernier créé).  </p>
</td></tr>
<tr><td><code id="legender_image.moodle_+3A_...">...</code></td>
<td>
<p> Arguments additionnels qui seront passés à
<code>f.creer_figure</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p> Ce type de question affiche une image et, en-dessous, des
étiquettes textuelles (code HTML possible) à placer sur l'image. Le
placement de l'étiquette est défini par son coin supérieur gauche (qui
est affiché sous forme de cible quand on la déplace). Les zones où
placer les étiquettes sont invisibles et couvrent une surface libre de
l'image, qui peut être rectangulaire, circulaire ou définie à l'aide
d'un polygone.
</p>
<p><b>Utilisation de la fonction <code>f.creer_figure</code></b>
</p>
<p>Avec cette méthode, la fonction se charge de créer le fichier d'image
(au format PNG, dans le dossier temporaire de R) avant d'appeler
<code>f.creer_figure</code>. La fonction <code>f.creer_figure</code> peut alors
utiliser tous les outils graphiques basiques de R pour créer une
figure et les zones à légender sur cette figure. Elle <em>ne</em> doit
<em>pas</em> clore la figure (pas d'appel à <code>dev.off()</code> ou à
<code>graphics.off</code>.
</p>
<p>La fonction <code>f.creer_figure</code> doit renvoyer une liste de deux
éléments:
</p>

<ul>
<li><p> un élément nommé <code>Marques</code> qui définit les marques à
placer sur la figure;
</p>
</li>
<li><p> un élément nommé <code>Zones</code> qui définit les zones possibles
pour placer ces marques.
</p>
</li></ul>

<p>L'élément <code>Zones</code> doit être une liste qui contient autant
d'éléments que de zones à définir. Chaque élément est lui-même une
liste qui doit contenir
</p>
    
<ul>
<li><p> un élément nommé <code>Type</code> qui définit, sous forme d'une
chaîne de caractères, la forme géométrique de la zone. Moodle
connaît trois types de forme: rectangulaire (chaîne à utiliser:
&ldquo;Rectangle&rdquo;), circulaire (&ldquo;Cercle&rdquo;) et polygonale
(&ldquo;Polygone&rdquo;).
</p>
</li>
<li><p> un élément nommé <code>Coord</code>, qui doit être une data.frame
contenant au moins deux colonnes appelées <code>X</code> et <code>Y</code>, et
autant de lignes que de coordonnées nécessaires pour définir la
zone.  Pour une zone rectangulaire, la première ligne définit le
coin supérieur, gauche et la seconde ligne le coin inférieur
droit. Pour une zone polygonale, chaque ligne définit un sommet du
polygone (il n'est pas nécessaire de répéter les coordonnées du
premier sommet à la fin). Pour une zone circulaire, une seule ligne
est nécessaire, définissant le centre du cercle. Le rayon du cercle
doit être donné dans une troisième colonne, nommée <code>Rayon</code>. </p>
</li></ul>

<p>Les coordonnées doivent être données en unités &ldquo;utilisateur&rdquo;,
c'est-à-dire les coordonnées naturelles de l'image (celles des
échelles des axes). La conversion en pixels sera faite
automatiquement, à l'aide des fonctions <code><a href="graphics.html#topic+grconvertX">grconvertX</a></code> et
<code><a href="graphics.html#topic+grconvertY">grconvertY</a></code>.  En général, les échelles ne sont pas les
mêmes pour les deux axes, de ce fait la conversion du rayon d'un
cercle ne conduit pas à la même valeur suivant qu'il est considéré
parallèle à l'axe des abscisses ou à l'axe des ordonnées (ce qui
revient à dire qu'un cercle serait représenté par une ellipse sur la
figure).  La plus grande de ces deux valeurs est utilisée pour définir
le rayon, en pixels, de la zone à créer.  Si vous voulez contrôler
parfaitement la forme de la zone, vous devez forcer le graphe à avoir
les mêmes échelles dans les deux dimensions (option <code>asp = TRUE</code>
dans <code><a href="base.html#topic+plot">plot</a></code>).
</p>
<p>L'élément <code>Marques</code> doit être une <code>data.frame</code> qui contient
autant de lignes que de marques à placer. Cette <code>data.frame</code> doit
avoir au moins une colonne nommée &ldquo;<code>Marque</code>&rdquo;, qui contient
le texte de chaque marque (tout code HTML est possible et sera mis en
forme par Moodle). Par défaut, chaque marque ne peut être utilisée
qu'une fois.  Pour préciser un nombre d'utilisation plus important, la
colonne &ldquo;<code>Nombre</code>&rdquo; peut être utilisée (y compris avec la
valeur <code>+Inf</code>).
</p>
<p><b>Utilisation directe</b>
</p>
<p>Il est aussi possible de préciser une image quelconque, grâce à
l'option <code>fichier.image</code>. Dans ce cas, les options <code>zones</code>
et <code>marques</code> doivent contenir, respectivement, les zones à
définir et les marques à placer, en utilisant le format ci-dessus.
Seule différence, les coordonnées des points définissant les zones (et
le rayon, pour une zone circulaire) doivent être exprimés directement
en pixels.
</p>


<h3>Value</h3>

<p>Aucune valeur n'est renvoyée par cette fonction.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+glisser_deposer.moodle">glisser_deposer.moodle</a></code> pour une autre façon de
demander à placer des éléments sur une image;
<code><a href="#topic+glisser_textes.moodle">glisser_textes.moodle</a></code> pour faire glisser des textes dans un
texte à trou.  </p>

<hr>
<h2 id='libre.moodle'>
Créer une question libre (« cloze », texte à compléter)
</h2><span id='topic+libre.moodle'></span><span id='topic+question_libre.moodle'></span>

<h3>Description</h3>

<p>Cette fonction permet de créer une question dont le format est libre,
qui se présente sous forme d'un texte à trous — format dit « cloze ».
</p>


<h3>Usage</h3>

<pre><code class='language-R'>question_libre.moodle( texte.intro, textes.avant, texte.final,
                       reponses, notes = NULL, types = NULL,
                       commentaires = NULL,
                       titre = "Question libre",
                       commentaire.global = NA,
                       penalite = NA, note.question = NA, idnum = NA,
                       temps,
                       fichier.xml = get( "fichier.xml",
                                          envir = SARP.Moodle.env ) )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="libre.moodle_+3A_texte.intro">texte.intro</code></td>
<td>
<p> L'introduction de la question (une chaîne de caractères). Cet
énoncé peut contenir n'importe quel caractère (codage en UTF-8) et
n'importe quelles balises HTML. Il se trouvera au tout début de la question. </p>
</td></tr>
<tr><td><code id="libre.moodle_+3A_textes.avant">textes.avant</code></td>
<td>
<p> Un vecteur de chaîne de caractères. À chaque
élément de ce vecteur sera associé un champ de réponse, qui sera
<em>précédé</em> du texte contenu dans cette chaîne de caractères. Ces
textes peuvent contenir n'importe quel caractère (codage en UTF-8) et
n'importe quelles balises HTML. Le nombre d'éléments du vecteur
doit être égal au nombre d'éléments de <code>reponses</code>. </p>
</td></tr>
<tr><td><code id="libre.moodle_+3A_texte.final">texte.final</code></td>
<td>
<p> Le texte qui doit se placer après le dernier champ
de réponse de la question. Il peut contenir n'importe quel caractère (codage en UTF-8) et
n'importe quelles balises HTML. </p>
</td></tr>
<tr><td><code id="libre.moodle_+3A_reponses">reponses</code></td>
<td>
<p> Une liste dont chaque élément décrit la ou les
réponses attendues pour chaque « trou » du texte. Le nombre d'éléments
de cette liste définit le nombre de champs réponses dans la question
et doit être égal à la longueur du vecteur <code>textes.avant</code>.
Consultez les détails pour plus d'information. </p>
</td></tr>
<tr><td><code id="libre.moodle_+3A_notes">notes</code></td>
<td>
<p> Le vecteur des notes associées à chaque réponse. S'il
est fourni, il doit être de même longueur que <code>reponses</code>.</p>
</td></tr>
<tr><td><code id="libre.moodle_+3A_types">types</code></td>
<td>
<p> Le vecteur des types de champ réponse. S'il est fourni,
il doit être de même longueur que <code>reponses</code>. Les types possibles
sont les textes <code>NUMERICAL</code> (par défaut), <code>MULTICHOICE</code>,
<code>MULTICHOICE_V</code>, <code>MULTICHOICE_H</code>, <code>MULTICHOICE_S</code>,
<code>MULTICHOICE_VS</code>, <code>MULTICHOICE_HS</code>, <code>MULTIRESPONSE</code>,
<code>MULTIRESPONSE_S</code>, <code>MULTIRESPONSE_H</code>,
<code>MULTIRESPONSE_S</code>, <code>SHORTANSWER</code> et <code>SHORTANSWER_C</code>.
Consultez les détails pour plus d'information.</p>
</td></tr>
<tr><td><code id="libre.moodle_+3A_commentaires">commentaires</code></td>
<td>
<p> Une liste de commentaires associés aux réponses
de chaque champ réponse. Si elle est fournie, elle doit être de même
longueur que <code>reponses</code>. Consultez les détails pour plus
d'information.</p>
</td></tr>
<tr><td><code id="libre.moodle_+3A_titre">titre</code></td>
<td>
<p> L'intitulé de la question, en HTML. </p>
</td></tr>
<tr><td><code id="libre.moodle_+3A_commentaire.global">commentaire.global</code>, <code id="libre.moodle_+3A_penalite">penalite</code>, <code id="libre.moodle_+3A_note.question">note.question</code>, <code id="libre.moodle_+3A_idnum">idnum</code></td>
<td>
<p>Options
communes à toutes les questions Moodle, voyez
<code><a href="#topic+debut_question.moodle">debut_question.moodle</a></code>.</p>
</td></tr>
<tr><td><code id="libre.moodle_+3A_temps">temps</code></td>
<td>
<p> Le temps conseillé pour répondre à la question, en
minutes. </p>
</td></tr>
<tr><td><code id="libre.moodle_+3A_fichier.xml">fichier.xml</code></td>
<td>
<p> Le fichier correspondant au questionnaire qui
contiendra cette question (par défaut, le dernier créé).  </p>
</td></tr>
</table>


<h3>Details</h3>

<p> Cette fonction construit, à partir des éléments fournis, une
question de type « cloze » : un texte à trous, les réponses étant à
entrer dans les trous ou à choisir dans une liste. C'est donc une suite
de « champs réponses », séparés par des textes.
</p>
<p>Chaque champ réponse est défini par la ou les réponses possibles, son
type, sa note et éventuellement les commentaires renvoyés à l'étudiant
en fonction de ses réponses. Ces informations sont obtenues à partir
des paramètres ci-dessus, le <em>i</em>-ème élément étant utilisé pour
le <em>i</em>-ème champ réponse.
</p>
<p>Le type <code>NUMERICAL</code> correspond à un champ attendant une réponse
numérique — c'est l'équivalent d'une question numérique. Une ou
plusieurs réponses sont possibles, qui seront de bonnes réponses, mais
pas forcément donnant toute tous les points. Les réponses sont à
fournir sous la forme d'une liste comportant un vecteur des valeurs,
nommé <code>Valeur</code> et un vecteur des tolérances associées, nommé
<code>Tolerance</code>.
</p>
<p>Les types <code>MULTICHOICE</code>, <code>MULTICHOICE_V</code>,
<code>MULTICHOICE_H</code>, <code>MULTICHOICE_S</code>, <code>MULTICHOICE_VS</code>,
<code>MULTICHOICE_HS</code>, <code>MULTIRESPONSE</code>, <code>MULTIRESPONSE_S</code>,
<code>MULTIRESPONSE_S</code>, <code>MULTIRESPONSE_HS</code>, <code>SHORTANSWER</code> et
<code>SHORTANSWER_C</code> correspondent à un champ permettant de choisir
(cocher) une ou plusieurs réponses dans une liste prédéfinie — c'est
l'équivalent d'un QCM. Tous ces types fonctionnent de façon similaire,
seuls la façon d'afficher la question et le nombre de réponses
sélectionnables varient (voyez le tableau récapitulatif ci-dessous).
Dans tous les cas, <code>reponses</code> doit contenir pour ces champs une
liste de deux éléments, l'un contenant le vecteur des textes des
réponses (élément nommé <code>Textes</code>), le second indiquant pour chaque
texte s'il correspond à une réponse correcte (<code>TRUE</code>) ou non
(<code>FALSE</code>). S'il y a plusieurs réponses correctes, chacune donne
une fraction égale des points. Pour préciser la note de chaque réponse,
placez dans la liste un élément nommé <code>Notes</code>, contenant le
vecteur des notes de chaque réponse (ces notes doivent être exprimées
en pourcentage de la note, arrondi à l'entier le plus proche, parmi les
valeurs autorisées par Moodle) ; dans ce cas, l'élément <code>Correct</code>
est ignoré et peut être omis.  Les commentaires de chaque réponse sont
à donner dans un vecteur de même longueur que <code>reponses$Textes</code>;
utilisez <code>NA</code> pour une réponse sans commentaire.
</p>

<table>
<tr>
 <td style="text-align: right;">Code </td><td style="text-align: center;"> Disposition </td><td style="text-align: center;"> Remarque </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>MULTICHOICE</code> </td><td style="text-align: center;"> Menu déroulant </td><td style="text-align: center;"> Une seule réponse
   possible </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>MULTICHOICE_V</code> </td><td style="text-align: center;"> Série de boutons radio verticaux </td><td style="text-align: center;"> Une seule
   réponse </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>MULTICHOICE_H</code> </td><td style="text-align: center;"> Série de boutons radio horizontaux </td><td style="text-align: center;"> Une seule
   réponse </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>MULTIRESPONSE</code> </td><td style="text-align: center;"> Série de cases à cocher verticales </td><td style="text-align: center;"> Plusieurs
   réponse possibles </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>MULTICHOICE_H</code> </td><td style="text-align: center;"> Série de cases à cocher horizontales </td><td style="text-align: center;"> Plusieurs
   réponses possibles </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>SHORTANSWER</code> </td><td style="text-align: center;"> Champ de texte libre </td><td style="text-align: center;"> sensible à
 la casse </td>
</tr>
<tr>
 <td style="text-align: right;">
   <code>SHORTANSWER_C</code> </td><td style="text-align: center;"> Champ de texte libre </td><td style="text-align: center;"> insensible à
   la casse </td>
</tr>
<tr>
 <td style="text-align: right;">
 </td>
</tr>

</table>

<p>Les variantes avec le suffixe S conduisent à un ordre des réponses tiré
au sort par Moodle lors de l'affichage de la question.
</p>
<p>Une fois le texte complet de la question créé, au format « cloze », à
partir de ces éléments, la question est créée grâce à la fonction
<code><a href="#topic+question.moodle">question.moodle</a>.</code>
</p>


<h3>Value</h3>

<p>Aucune valeur n'est renvoyée par cette fonction.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+numerique.moodle">numerique.moodle</a></code>, <code><a href="#topic+qcm.moodle">qcm.moodle</a></code>,
<code><a href="#topic+qroc.moodle">qroc.moodle</a></code>, <code><a href="#topic+question_ouverte.moodle">question_ouverte.moodle</a></code>, <code><a href="#topic+vrai_faux.moodle">vrai_faux.moodle</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Commencer un nouveau questionnaire
q &lt;- debuter_xml.moodle( "exemple.libre" )

# Catégorie : exemples
categorie.moodle( "Exemples SARP/Question libre" )

# Une question Moodle libre avec champs numériques
question_libre.moodle( "Indiquez les chiffres du nombre 1974.",
                       list( "Unit&amp;eacute; : ", " &amp;mdash; dizaine : ",
                             " &amp;mdash; centaine : ", " &amp;mdash; milliers : " ), ".",
                       reponses = list( 4, 7, 9, 1 ) )

# Avec un champ numérique et des champs à choix multiples
question_libre.moodle( "&lt;cite&gt;Le Corbeau et le Renard&lt;/cite&gt;.",
                       list( "&lt;i&gt;Ma&amp;icirc;tre ",
                             " sur son arbre perch&amp;eacute;&lt;br /&gt;Tenait en son bec un ",
                             ".&lt;br /&gt;Ma&amp;icirc;tre ",
                             paste0( "&lt;/i&gt;par l'odeur all&amp;eacute;ch&amp;eacute;&lt;br /&gt;...",
                                     "&lt;br /&gt;est un po&amp;egrave;me compos&amp;eacute; en " ) ),
                       " par le po&amp;egrave;te Jean de la Fontaine.",
                       types = c( "MULTICHOICE", "MULTICHOICE_H",
                                  "SHORTANSWER", "NUMERICAL" ),
                       reponses = list( list( "Textes"  = c( "Renard", "Goupil",
                                                             "Corbeau", "Corneille" ),
                                              "Correct" = c( FALSE, FALSE, TRUE, FALSE ) ),
                                        list( "Textes"  = c( "Fromage", "Camembert",
                                                             "Bleu", "Livre" ), 
                                              "Correct" = c( TRUE, FALSE, FALSE, FALSE ) ),
                                        list( "Textes"  = c( "Renard", "Goupil",
                                                             "Corbeau", "Corneille" ),
                                              "Correct" = c( TRUE, FALSE, FALSE, FALSE ) ),
                                        1668 ) )

# On termine le questionnaire
finir_xml.moodle( )

# Importez le fichier exemple.libre.xml dans Moodle pour voir le résultat...
print(
"Importez le fichier exemple.libre.xml dans Moodle pour voir le r\u00e9sultat..." )

## End(Not run)
</code></pre>

<hr>
<h2 id='lier_fichier.moodle'>
Insérer un lien vers un fichier dans une question
</h2><span id='topic+lier_fichier.moodle'></span>

<h3>Description</h3>

<p>Cette fonction permet de créer un liens vers un fichier à télécharger dans les
questions Moodle (texte, mais aussi réponses).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lier_fichier.moodle( nom.fichier, texte.lien = NULL, interne = TRUE )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lier_fichier.moodle_+3A_nom.fichier">nom.fichier</code></td>
<td>
<p>Le nom du fichier vers lequel pointera le lien. Si
le fichier est externe au fichier XML, ce doit être le nom tel qu'il apparaîtra
dans le dossier moodle : attention aux conversions de caractères que
peut faire Moodle lors de l'import d'un fichier... Ce doit être un
vecteur de type <code>character</code> contenant un seul élément. </p>
</td></tr>
<tr><td><code id="lier_fichier.moodle_+3A_texte.lien">texte.lien</code></td>
<td>
<p> Un vecteur de chaîne de caractère, ne contenant
qu'un seul élément, indiquant le texte à afficher comme lien vers le
fichier. S'il est absent, le nom du fichier entre crochets est utilisé.</p>
</td></tr>
<tr><td><code id="lier_fichier.moodle_+3A_interne">interne</code></td>
<td>
<p> Indique si le fichier est déjà sur Moodle (<code>FALSE</code>)
ou si elle est incluse dans le fichier XML (<code>TRUE</code>). Dans le
premier cas, l'URL de base doit avoir été définie par
<code>definir_dossier.image.moodle</code> (voyez les détails, ci-après).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>La fonction <code>lier_fichier.moodle</code> crée une balise HTML <code>&lt;a href=&gt;</code>
avec une URL pointant vers le fichier. Cette URL est obtenue en
concaténant une racine et le nom du fichier indiqué.
</p>
<p>Pour un fichier extérieur au fichier XML, la racine, définie avec la
fonction <code><a href="#topic+definir_dossier.image.moodle">definir_dossier.image.moodle</a></code>, peut être
n'importe quel schéma d'URL valide. Le plus souvent, ce sera soit une
URL vers un site externe qui contient les fichiers soit, encore plus
fréquent, une URL référençant le fichier dans Moodle. Il faut alors
préciser <code>interne = FALSE</code> lors de l'appel à
<code>lier_fichier.moodle</code>
</p>
<p>Par défaut, le fichier est inclus dans le fichier XML. Lors de la
création de la question, les balises ainsi générées seront identifiées
et les fichiers encodés dans le fichier XML, avec la fonction
<code>coder_image.moodle</code>. Attention cependant, les chemins d'accès
locaux étant perdus, les fichiers  doivent se
trouver dans le répertoire de travail au moment de la création de la
question. Il est cependant possible d'indiquer un dossier local
différent, avec <code>definir_dossier.image.moodle</code>, en
précisant <code>local = TRUE</code>.
</p>


<h3>Value</h3>

<p> La fonction <code>lier_fichier.moodle</code> renvoie une chaîne de
caractère qui contient le code HTML créé. Cette chaîne peut ensuite
être utilisée, directement ou après concaténation avec d'autres
éléments, dans la constitution des textes ou des réponses de n'importe
quelle question moodle.
</p>


<h3>Attention</h3>

<p>Vous devez appeler au moins une fois la fonction
<code>definir_dossier.image.moodle</code> pour pouvoir ensuite lier des
fichiers externes au fichier XML. Au moment de la création du fichier
XML, il n'y a aucun moyen de vérifier que l'URL indiquée est
correcte...
</p>


<h3>Astuce</h3>

<p>Pour importer plusieurs fichiers en une fois, sans les
inclure au fichier XML, vous avez tout intérêt à les regrouper dans
une archive au format zip, que vous décompresserez après l'avoir
importée dans le dossier moodle ciblé.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+inserer_formule.moodle">inserer_formule.moodle</a></code> pour insérer une formule
mathématique à l'aide d'un code latex;
<code><a href="#topic+inserer_SMILES.moodle">inserer_SMILES.moodle</a></code> pour insérer une formule chimique
à l'aide d'un code SMILES ; <code><a href="#topic+lier_image.moodle">lier_image.moodle</a> pour
    insérer une image (balise img)</code>
</p>

<hr>
<h2 id='messages.moodle'>
Aide aux affichages dans les textes des questions
</h2><span id='topic+messages.moodle'></span><span id='topic+temps_necessaire.moodle'></span><span id='topic+arrondi.moodle'></span>

<h3>Description</h3>

<p>Ces fonctions permettent de créer une chaîne de caractère au format
HTML, pour des messages courant d'indication dans les questions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>temps_necessaire.moodle( temps, couleur = "Blue",
                         nv.ligne = TRUE )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="messages.moodle_+3A_temps">temps</code></td>
<td>
<p>Le temps conseillé pour la question. Ce peut être un
nombre, le temps est alors supposé exprimé en minutes, ou une chaîne
de caractères à un format de temps classique (par exemple 45s,
2'30...).</p>
</td></tr>
<tr><td><code id="messages.moodle_+3A_couleur">couleur</code></td>
<td>
<p>La couleur à utiliser pour le message. N'importe quelle
couleur reconnue en CSS peut être utilisée.</p>
</td></tr>
<tr><td><code id="messages.moodle_+3A_nv.ligne">nv.ligne</code></td>
<td>
<p>Si <code>TRUE</code>, le message est précédé d'un retour à
la ligne (balise HTML <code>&lt;br /&gt;</code>). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Ces fonctions sont utilisées par les fonctions générant les questions
classiques pour ajouter des consignes en fin d'énoncé. Elles peuvent
être utilisées directement pour davantage de souplesse.
</p>
<p>Le message créé par <code>temps_necessaire.moodle</code> est &ldquo;Temps
conseillé pour cette question : x min y s&rdquo;, où x et y sont
construits à partir du temps indiqué en minutes (par exemple, si
<code>temps=1.5</code>, x=1 et y=30). Pour les questions classiques, il
correspond à l'option <code>temps</code>.
</p>


<h3>Value</h3>

<p> Ces fonctions renvoient une unique chaîne de caractères, en
HTML, prête à être intégrée dans un énoncé.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Indication d'un temps conseillé de 2 min 30
  temps_necessaire.moodle( 2.5 )

  # Indication d'un temps conseillé de 10 secondes
  temps_necessaire.moodle( "10s" )
</code></pre>

<hr>
<h2 id='numerique.moodle'>
Créer une question à réponse numérique simple
</h2><span id='topic+numerique.moodle'></span>

<h3>Description</h3>

<p>Cette fonction permet de créer une question dont la réponse est une
valeur numérique unique.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>numerique.moodle( texte, bonne.reponse, notes = 100,
                  n.decimales = get( "nombre.chiffres", envir = SARP.Moodle.env ),
                  n.significatifs = NA,
                  titre = "Question num&amp;eacute;rique...",
                  commentaire.global = NA, penalite = NA, note.question = NA,
                  idnum = NA,
                  tolerance.type = 2, tolerance = "auto",
                  unites = NULL, unite.avant = FALSE,
                  unite.penalite = 0.1, unite.visible = FALSE,
                  commentaires = NULL, couleur.consigne = "Orange",
                  temps,
                  fichier.xml = get( "fichier.xml", envir = SARP.Moodle.env ) )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="numerique.moodle_+3A_texte">texte</code></td>
<td>
<p> L'énoncé de la question (une chaîne de caractères). Cet
énoncé peut contenir n'importe quel caractère (codage en UTF-8) et
n'importe quelles balises HTML.
</p>
</td></tr>
<tr><td><code id="numerique.moodle_+3A_bonne.reponse">bonne.reponse</code></td>
<td>
<p> La valeur numérique correspondant à la bonne
réponse. Depuis Moodle 3, plusieurs valeurs peuvent être
proposées. </p>
</td></tr>
<tr><td><code id="numerique.moodle_+3A_notes">notes</code></td>
<td>
<p>Lorsque plusieurs valeurs peuvent être acceptées comme
réponse, la note (en fraction de la note totale de la question)
associée à chaque réponse.</p>
</td></tr>
<tr><td><code id="numerique.moodle_+3A_n.decimales">n.decimales</code></td>
<td>
<p> Le nombre de décimales à conserver pour la bonne
réponse (utiliser <code>NA</code> pour ne pas arrondir); par défaut, la
valeur indiquée à la création du questionnaire est utilisée. </p>
</td></tr>
<tr><td><code id="numerique.moodle_+3A_n.significatifs">n.significatifs</code></td>
<td>
<p> Le nombre de chiffres significatifs à
conserver pour la bonne réponse (utiliser <code>NA</code> pour ne pas
arrondir); par défaut, la valeur indiquée à la création du
questionnaire est utilisée. </p>
</td></tr>
<tr><td><code id="numerique.moodle_+3A_titre">titre</code></td>
<td>
<p> L'intitulé de la question, en HTML. </p>
</td></tr>
<tr><td><code id="numerique.moodle_+3A_fichier.xml">fichier.xml</code></td>
<td>
<p> Le fichier correspondant au questionnaire qui
contiendra cette question (par défaut, le dernier créé).  </p>
</td></tr>
<tr><td><code id="numerique.moodle_+3A_commentaire.global">commentaire.global</code>, <code id="numerique.moodle_+3A_penalite">penalite</code>, <code id="numerique.moodle_+3A_note.question">note.question</code>, <code id="numerique.moodle_+3A_idnum">idnum</code></td>
<td>
<p>Options
communes à toutes les questions Moodle, voyez
<code><a href="#topic+debut_question.moodle">debut_question.moodle</a></code>.</p>
</td></tr>
<tr><td><code id="numerique.moodle_+3A_tolerance.type">tolerance.type</code></td>
<td>
<p>La façon dont est exprimée la tolérance. Les
valeurs possibles sont 1 (tolérance relative: la valeur de la
tolérance est un pourcentage de la réponse), 2 (tolérance absolue)
et 3 (tolérance « géométrique »).</p>
</td></tr>
<tr><td><code id="numerique.moodle_+3A_tolerance">tolerance</code></td>
<td>
<p>La tolérance associée à chaque réponse. Si une seule
valeur est fournie, elle sera utilisée pour toutes les réponses. La
valeur spéciale <code>"auto"</code> calcule une tolérance de
<code class="reqn">1{,}1\times10^{-n}</code>, où <code class="reqn">n</code> est le nombre de
décimales demandé pour l'arrondi si <code>n.decimales &gt; 0</code>, et 0
sinon.</p>
</td></tr>
<tr><td><code id="numerique.moodle_+3A_unites">unites</code></td>
<td>
<p>Un vecteur de multiplicateurs indiquant les conversions
possible d'unités pour la réponse. Les noms de ce vecteurs
définissent les unités. </p>
</td></tr>
<tr><td><code id="numerique.moodle_+3A_unite.avant">unite.avant</code></td>
<td>
<p>Si <code>TRUE</code>, l'unité sera affichée et attendue
avant la valeur numérique (pour les unités monétaires anglosaxonnes,
typiquement). Sinon, elle sera affichée et attendue après la valeur
numérique.</p>
</td></tr>
<tr><td><code id="numerique.moodle_+3A_unite.penalite">unite.penalite</code></td>
<td>
<p>La pénalité en cas d'erreur sur l'unité.</p>
</td></tr>
<tr><td><code id="numerique.moodle_+3A_unite.visible">unite.visible</code></td>
<td>
<p>Si <code>TRUE</code>, l'unité peut être choisie dans un
menu déroulant. Sinon, elle doit être entrée dans le champ de la
réponse, comme un texte.</p>
</td></tr>
<tr><td><code id="numerique.moodle_+3A_commentaires">commentaires</code></td>
<td>
<p>Le commentaire à affiche selon la réponse
proposée. Il doit y avoir autant de valeurs que de bonne réponses
(certaines pouvant être <code>NA</code>, pour ne pas avoir de commentaire
pour la réponse associée).</p>
</td></tr>
<tr><td><code id="numerique.moodle_+3A_couleur.consigne">couleur.consigne</code></td>
<td>
<p>La couleur à utiliser pour afficher le texte
de la consigne générée, lorsque l'on précise l'arrondi. Doit être une
chaîne de caractères décrivant une couleur reconnaissable en CSS.</p>
</td></tr>
<tr><td><code id="numerique.moodle_+3A_temps">temps</code></td>
<td>
<p> Le temps conseillé pour répondre à la question, en
minutes. </p>
</td></tr>
</table>


<h3>Details</h3>

<p> En l'absence de tolérance, la bonne réponse doit être donnée
exactement: n'oubliez pas d'arrondir la valeur au bon nombre de
décimales, soit en utilisant l'option <code>n.decimales</code> ou
<code>n.significatifs</code>, soit avant d'appeler la fonction.
</p>
<p>Si <code>n.decimales</code> est précisé et strictement positif, l'arrondi est
fait avec la fonction <code><a href="base.html#topic+round">round</a></code> de R. Dans ce cas, un message
est automatiquement ajouté à la fin du texte de la question, précisant
le nombre de décimales attendu. Ce texte est sur sa propre ligne
(précédé d'une balise HTML <code>&lt;br /&gt;</code>), en italique (balises HTML
<code>&lt;i&gt;</code> et <code>&lt;i/&gt;</code>) et avec la couleur indiquée par
<code>couleur.consigne</code>.
</p>
<p>Si <code>n.significatif</code> est précisé et strictement positif, l'arrondi
est fait avec la fonction <code><a href="base.html#topic+signif">signif</a></code> de R. Dans ce cas, un
message est automatiquement ajouté à la fin du texte de la question,
précisant le nombre de chiffres significatifs attendu. Ce texte est sur
sa propre ligne (précédé d'une balise HTML <code>&lt;br /&gt;</code>), en italique
(balises HTML <code>&lt;i&gt;</code> et <code>&lt;i/&gt;</code>) et avec la couleur indiquée par
<code>couleur.consigne</code>.
</p>
<p>Lorsque vous attendez une réponse entière, pour ne pas avoir d'arrondi,
de tolérance ni de consigne associée, forcez le type de
<code>bonne.reponse</code> à être un entier, et pas un double (fonction
<code><a href="base.html#topic+as.integer">as.integer</a></code> de R).
</p>
<p>La tolérance <code class="reqn">\tau</code> permet d'accepter toutes les valeurs dans un
intervalle <code class="reqn">[a,b]</code>, calculé à partir de la réponse <code class="reqn">r</code>. Le
calcul dépend du type de tolérance demandé: pour le type 1,
<code class="reqn">a=r-\delta</code> et <code class="reqn">b=r+\delta</code>, avec
<code class="reqn">\delta=\tau\,r</code>. Pour le type 2, <code class="reqn">\delta=\tau</code>.
Pour le type 3, <code class="reqn">a=r/(1+\tau)</code> et
<code class="reqn">b=r(1+\tau)</code>.
</p>


<h3>Value</h3>

<p>Aucune valeur n'est renvoyée par cette fonction.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+qcm.moodle">qcm.moodle</a></code>, <code><a href="#topic+qroc.moodle">qroc.moodle</a></code>,
<code><a href="#topic+question_ouverte.moodle">question_ouverte.moodle</a></code>, <code><a href="#topic+vrai_faux.moodle">vrai_faux.moodle</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Commencer un nouveau questionnaire
q &lt;- debuter_xml.moodle( "exemple.numerique" )

# Catégorie : exemples
categorie.moodle( "Exemples SARP/Numérique" )

# Une question Moodle numérique, avec 3 décimales
numerique.moodle( "Donnez la valeur de &amp;pi;", pi, n.decimales = 3 )

# On termine le questionnaire
finir_xml.moodle( )

# Importez le fichier exemple.numerique.xml dans Moodle pour voir le résultat...
print(
"Importez le fichier exemple.numerique.xml dans Moodle pour voir le résultat..." )

## End(Not run)
</code></pre>

<hr>
<h2 id='ouverte.moodle'>
Créer une question à réponse ouverte (rédactionnelle)
</h2><span id='topic+ouverte.moodle'></span><span id='topic+question_ouverte.moodle'></span>

<h3>Description</h3>

<p>Cette fonction permet de créer une question dont la réponse est libre (rédactionnelle).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>question_ouverte.moodle( texte, 
                         titre = "Question r&amp;eacute;dactionnelle ouverte",
                         editeur = c( 'WYSIWIG', 'WYSIWIG+',
                                      'Texte', 'Chasse fixe', 'Aucun' ),
                         avec.texte = TRUE, n.lignes = 15, 
                         n.annexes = 0, n.optionnelles = min( n.annexes, 3 ),
                         types = 'PDF',
                         modele = NULL, informations = NULL,
                         commentaire.global = NA, penalite = NA, note.question = NA,
                         idnum = NA,
                         temps,
                         fichier.xml = get( "fichier.xml", envir = SARP.Moodle.env ) )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ouverte.moodle_+3A_texte">texte</code></td>
<td>
<p> L'énoncé de la question (une chaîne de caractères). Cet
énoncé peut contenir n'importe quel caractère (codage en UTF-8) et
n'importe quelles balises HTML.  </p>
</td></tr>
<tr><td><code id="ouverte.moodle_+3A_titre">titre</code></td>
<td>
<p> L'intitulé de la question, en HTML. </p>
</td></tr>
<tr><td><code id="ouverte.moodle_+3A_editeur">editeur</code></td>
<td>
<p> Le type d'éditeur de texte à offrir à l'étudiant pour
qu'il puisse rédiger sa réponse. &ldquo;WYSIWIG+&rdquo; correspond à un
éditeur offrant la possibilité de choisir des fichiers. </p>
</td></tr>
<tr><td><code id="ouverte.moodle_+3A_avec.texte">avec.texte</code></td>
<td>
<p> Si <code>TRUE</code>, il est obligatoire de répondre à la
question en mettant au moins quelques mots. Sinon, il est possible
de répondre en ne remplissant rien. </p>
</td></tr>
<tr><td><code id="ouverte.moodle_+3A_n.lignes">n.lignes</code></td>
<td>
<p> Le nombre de lignes de texte que doit afficher
l'éditeur, par défaut. </p>
</td></tr>
<tr><td><code id="ouverte.moodle_+3A_n.annexes">n.annexes</code></td>
<td>
<p> Le nombre maximal de fichiers que l'étudiant peut
téléverser pour compléter sa réponse. </p>
</td></tr>
<tr><td><code id="ouverte.moodle_+3A_n.optionnelles">n.optionnelles</code></td>
<td>
<p> Parmi ces fichiers, combien sont-ils
obligatoires? </p>
</td></tr>
<tr><td><code id="ouverte.moodle_+3A_types">types</code></td>
<td>
<p> Les formats de fichiers autorisés, pour le dépôt. Pour
l'instant ignoré, car il semble que cette information ne soit pas
exportée dans le fichier XML... </p>
</td></tr>
<tr><td><code id="ouverte.moodle_+3A_modele">modele</code></td>
<td>
<p> Un modèle de réponse, à préafficher dans l'éditeur. </p>
</td></tr>
<tr><td><code id="ouverte.moodle_+3A_informations">informations</code></td>
<td>
<p> Des informations qui seront affichées pour le
relecteur, afin de le guider dans la correction par exemple. </p>
</td></tr>
<tr><td><code id="ouverte.moodle_+3A_commentaire.global">commentaire.global</code>, <code id="ouverte.moodle_+3A_penalite">penalite</code>, <code id="ouverte.moodle_+3A_note.question">note.question</code>, <code id="ouverte.moodle_+3A_idnum">idnum</code></td>
<td>
<p>Options
communes à toutes les questions Moodle, voyez
<code><a href="#topic+debut_question.moodle">debut_question.moodle</a></code>.</p>
</td></tr>
<tr><td><code id="ouverte.moodle_+3A_temps">temps</code></td>
<td>
<p> Le temps conseillé pour répondre à la question, en
minutes. </p>
</td></tr>
<tr><td><code id="ouverte.moodle_+3A_fichier.xml">fichier.xml</code></td>
<td>
<p> Le fichier correspondant au questionnaire qui
contiendra cette question (par défaut, le dernier créé).  </p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>Cette fonction est une interface simplifiée pour la
fonction <code><a href="#topic+question.moodle">question.moodle</a></code>.
</p>


<h3>Value</h3>

<p>Aucune valeur n'est renvoyée par cette fonction.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+numerique.moodle">numerique.moodle</a></code>, <code><a href="#topic+qcm.moodle">qcm.moodle</a></code>,
<code><a href="#topic+qroc.moodle">qroc.moodle</a></code>, <code><a href="#topic+vrai_faux.moodle">vrai_faux.moodle</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Commencer un nouveau questionnaire
q &lt;- debuter_xml.moodle( "exemple.ouverte" )

# Catégorie : exemples
categorie.moodle( "Exemples SARP/Question ouverte" )

# Une question Moodle ouverte
question_ouverte.moodle( "Racontez votre journ&amp;eacute;e." )

# On termine le questionnaire
finir_xml.moodle( )

# Importez le fichier exemple.ouverte.xml dans Moodle pour voir le résultat...
print(
"Importez le fichier exemple.ouverte.xml dans Moodle pour voir le résultat..." )

## End(Not run)
</code></pre>

<hr>
<h2 id='qcm.moodle'>
Créer une question à choix (réponse unique ou réponses multiples)
</h2><span id='topic+qcm'></span><span id='topic+qcm.moodle'></span>

<h3>Description</h3>

<p>Cette fonction permet de créer une question de type QCM ou QCU, dans
laquelle la ou les bonnes réponses sont à cocher dans une liste de
réponses prédéfinie.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qcm.moodle( texte, bonnes.reponses, mauvaises.reponses,
            commentaires = NULL, fractions = list( "Bonnes" = NULL, "Fausses" = NULL ),
            unique = ( length( bonnes.reponses ) == 1 ), melanger = TRUE,
            titre = "QCM...",
            numerotation = c( "none", "abc", "ABCD", "123" ),
            fichier.xml = get( "fichier.xml", envir = SARP.Moodle.env ),
            commentaire.global = NA, penalite = NA, note.question = NA,
            idnum = NA,
            temps, instructions = TRUE )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qcm.moodle_+3A_texte">texte</code></td>
<td>
<p> L'énoncé de la question (une chaîne de caractères). Cet
énoncé peut contenir n'importe quel caractère (codage en UTF-8) et
n'importe quelles balises HTML.  </p>
</td></tr>
<tr><td><code id="qcm.moodle_+3A_bonnes.reponses">bonnes.reponses</code></td>
<td>
<p> Un vecteur de chaînes de caractères
correspondant aux intitulés des bonnes réponses. Il doit y avoir au
moins une bonne réponse. </p>
</td></tr>
<tr><td><code id="qcm.moodle_+3A_mauvaises.reponses">mauvaises.reponses</code></td>
<td>
<p> Un vecteur de chaînes de caractères
correspondant aux intitulés des mauvaises réponses. </p>
</td></tr>
<tr><td><code id="qcm.moodle_+3A_commentaires">commentaires</code></td>
<td>
<p> Un vecteur de chaînes de caractère, correspondant
au retour à indiquer pour chacune des réponses, dans l'ordre dans
lequel elles sont passées, en commençant par les bonnes réponses.
Utilisez <code>NA</code> pour laisser un commentaire vide. </p>
</td></tr>
<tr><td><code id="qcm.moodle_+3A_fractions">fractions</code></td>
<td>
<p> Une liste de deux éléments, contenant les
pourcentage de note associés à chaque réponse. Ces deux éléments
doivent être intitulés <code>Bonnes</code> (pour les bonnes réponses) et
<code>Fausses</code> (pour les mauvaises réponses) ; s'ils sont indiqués, ce
doivent être des vecteurs numériques ayant le même nombre d'éléments
que la liste des réponses.  Par défaut (si l'élément vaut
<code>NULL</code>), chaque bonne réponse est affectée de la même fraction de
note, de sorte que l'on atteigne 100 % en cochant toutes les bonnes
réponses. De la même façon, les mauvaises réponses sont affectées
d'une fraction négative de sorte que cocher toutes les mauvaises
réponses annule le fait de cocher toutes les bonnes réponses, sans
donner une note négative.
</p>
<p>Les fractions doivent être comprises entre 0 (exclus) et 100 pour les
bonnes réponses ; elles doivent être négatives pour les mauvaises
réponses. Si ce n'est pas le cas, ou si la somme des fractions des
bonnes réponse ne vaut pas 100, un avertissement est donné, mais la
question est tout de même créée. Toutefois, si toutes les fractions
des mauvaises réponses sont positives, elles sont considérées
négatives sans avertissement.</p>
</td></tr>
<tr><td><code id="qcm.moodle_+3A_unique">unique</code></td>
<td>
<p> Si <code>TRUE</code>, indique que l'on ne peut cocher qu'une seule bonne réponse. </p>
</td></tr>
<tr><td><code id="qcm.moodle_+3A_melanger">melanger</code></td>
<td>
<p> Si <code>TRUE</code>, indique que l'ordre des réponses doit
être choisi aléatoirement à chaque affichage de la question. Sinon,
l'ordre est celui défini dans le fichier. Actuellement, cela
correspond à l'ensemble des bonnes réponses dans l'ordre indiqué,
suivi de l'ensemble des mauvaises réponses dans l'ordre indiqué.</p>
</td></tr>
<tr><td><code id="qcm.moodle_+3A_titre">titre</code></td>
<td>
<p> L'intitulé de la question, en HTML. </p>
</td></tr>
<tr><td><code id="qcm.moodle_+3A_numerotation">numerotation</code></td>
<td>
<p> Le type de numérotation à utiliser pour les
différentes réponses. Ces numéros sont ajoutés par Moodle lors de
l'affichage de la question. Seules les quatre valeurs indiquées sont
reconnues par Moodle. Vous pouvez abréger en n'utilisant que la
première lettre. </p>
</td></tr>
<tr><td><code id="qcm.moodle_+3A_fichier.xml">fichier.xml</code></td>
<td>
<p> Le fichier correspondant au questionnaire qui
contiendra cette question (par défaut, le dernier créé).  </p>
</td></tr>
<tr><td><code id="qcm.moodle_+3A_commentaire.global">commentaire.global</code>, <code id="qcm.moodle_+3A_penalite">penalite</code>, <code id="qcm.moodle_+3A_note.question">note.question</code>, <code id="qcm.moodle_+3A_idnum">idnum</code></td>
<td>
<p>Options
communes à toutes les questions Moodle, voyez
<code><a href="#topic+debut_question.moodle">debut_question.moodle</a></code>.</p>
</td></tr>
<tr><td><code id="qcm.moodle_+3A_temps">temps</code></td>
<td>
<p> Le temps conseillé pour répondre à la question, en
minutes. </p>
</td></tr>
<tr><td><code id="qcm.moodle_+3A_instructions">instructions</code></td>
<td>
<p> Faut-il afficher, avant les réponses possibles,
le texte générique de Moodle rappelant les instructions (typiquement,
&ldquo;Veuillez choisir au moins une réponse&rdquo;)? (Oui si
<code>TRUE</code>, non si <code>FALSE</code>). </p>
</td></tr>
</table>


<h3>Details</h3>

<p> La question générée avec cette fonction est une question de
type <code>multichoice</code>.
</p>
<p>Cette fonction est une interface simplifiée pour la
fonction <code><a href="#topic+question.moodle">question.moodle</a></code>.
</p>


<h3>Value</h3>

<p>Aucune valeur n'est renvoyée par cette fonction.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+numerique.moodle">numerique.moodle</a></code>,
<code><a href="#topic+qroc.moodle">qroc.moodle</a></code>, <code><a href="#topic+question_ouverte.moodle">question_ouverte.moodle</a></code>, <code><a href="#topic+vrai_faux.moodle">vrai_faux.moodle</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Commencer un nouveau questionnaire
q &lt;- debuter_xml.moodle( "exemple.QCM" )

# Catégorie : exemples
categorie.moodle( "Exemples SARP/QCM" )

# Le format par défaut, avec deux bonnes réponses et trois mauvaises,
qcm.moodle( "Quels sont les fruits de la liste ci-dessous&amp;thinsp;?",
            c( "Orange", "Tomate" ), c( "Pomme de terre", "Carotte", "Navet" ) )

# Deux bonnes réponses, deux mauvaises réponses, avec commentaires
#   et fractions inégales
qcm.moodle( "Indiquez les romanciers de la liste ci-dessous.",
            c( "Eugène&amp;nbsp;S&lt;small&gt;UE&lt;/small&gt;", "Alexandre&amp;nbsp;D&lt;small&gt;UMAS&lt;/small&gt;" ),
            c( "Labiche", "Ronsard" ),
            commentaires = c( "Bravo&amp;thinsp;!", NA,
                 "C'est un auteur de pièces de théâtre", "C'est un poète" ),
            fractions = list( "Bonnes"  = c( 75, 25 ),
                              "Fausses" = c( -50, -100 ) ) )

# On termine le questionnaire
finir_xml.moodle( )

# Importez le fichier exemple.QCM.xml dans Moodle pour voir le résultat...
print(
"Importez le fichier exemple.QCM.xml dans Moodle pour voir le résultat..." )

## End(Not run)
</code></pre>

<hr>
<h2 id='qroc.moodle'>
Créer une question à réponse ouverte, courte
</h2><span id='topic+qroc.moodle'></span><span id='topic+qroc'></span>

<h3>Description</h3>

<p>Cette fonction permet de créer une question dont la réponse est un
court texte (« QROC »)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qroc.moodle( texte, reponses, notes = rep( 100, length( reponses ) ),
             commentaires = NULL, casse = TRUE,
             titre = "QROC...",
             fichier.xml = get( "fichier.xml", envir = SARP.Moodle.env ),
             commentaire.global = NA, penalite = NA, note.question = NA,
             idnum = NA,
             temps )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qroc.moodle_+3A_texte">texte</code></td>
<td>
<p> L'énoncé de la question (une chaîne de caractères). Cet
énoncé peut contenir n'importe quel caractère (codage en UTF-8) et
n'importe quelles balises HTML.  </p>
</td></tr>
<tr><td><code id="qroc.moodle_+3A_reponses">reponses</code></td>
<td>
<p> Un vecteur de chaînes de caractères, dont chaque
élément correspond à une réponse correcte possible. </p>
</td></tr>
<tr><td><code id="qroc.moodle_+3A_notes">notes</code></td>
<td>
<p> Un vecteur de nombres, correspondant aux pourcentages de
la note totale associés à chaque réponse. Par défaut, toutes les
réponses sont supposées parfaitement correctes.</p>
</td></tr>
<tr><td><code id="qroc.moodle_+3A_commentaires">commentaires</code></td>
<td>
<p> Un vecteur de chaînes de caractères, correspondant
au retour à afficher pour chacune des réponses entrées (dans le même
ordre que les réponses). Le vecteur doit avoir la même longueur ; si
certaines réponses n'appellent pas de commentaire, utilisez <code>NA</code>.</p>
</td></tr>
<tr><td><code id="qroc.moodle_+3A_casse">casse</code></td>
<td>
<p>Si <code>TRUE</code>, on distingue entre majuscules et
minuscules pour savoir si la réponse est correcte. Sinon, cette
distinction n'est pas faite.</p>
</td></tr>
<tr><td><code id="qroc.moodle_+3A_titre">titre</code></td>
<td>
<p> L'intitulé de la question, en HTML. </p>
</td></tr>
<tr><td><code id="qroc.moodle_+3A_fichier.xml">fichier.xml</code></td>
<td>
<p> Le fichier correspondant au questionnaire qui
contiendra cette question (par défaut, le dernier créé).  </p>
</td></tr>
<tr><td><code id="qroc.moodle_+3A_commentaire.global">commentaire.global</code>, <code id="qroc.moodle_+3A_penalite">penalite</code>, <code id="qroc.moodle_+3A_note.question">note.question</code>, <code id="qroc.moodle_+3A_idnum">idnum</code></td>
<td>
<p>Options
communes à toutes les questions Moodle, voyez
<code><a href="#topic+debut_question.moodle">debut_question.moodle</a></code>.</p>
</td></tr>
<tr><td><code id="qroc.moodle_+3A_temps">temps</code></td>
<td>
<p> Le temps conseillé pour répondre à la question, en
minutes. </p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>Cette fonction est une interface simplifiée, et enrichie, pour la
fonction <code><a href="#topic+question.moodle">question.moodle</a></code>.
</p>


<h3>Value</h3>

<p>Aucune valeur n'est renvoyée par cette fonction.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+numerique.moodle">numerique.moodle</a></code>, <code><a href="#topic+qcm.moodle">qcm.moodle</a></code>,
<code><a href="#topic+question_ouverte.moodle">question_ouverte.moodle</a></code>, <code><a href="#topic+vrai_faux.moodle">vrai_faux.moodle</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Commencer un nouveau questionnaire
q &lt;- debuter_xml.moodle( "exemple.qroc" )

# Catégorie : exemples
categorie.moodle( "Exemples SARP/QROC" )

# Une question Moodle en QROC, avec une seule bonne réponse
qroc.moodle( "Quel est le prénom de Victor&amp;nbsp;H&lt;small&gt;UGO&lt;/small&gt;&amp;thinsp;?",
             "Victor" )

# La même, en indiquant que l'initiale doit être en majuscule
qroc.moodle( "Quel est le prénom de Victor&amp;nbsp;H&lt;small&gt;UGO&lt;/small&gt;&amp;thinsp;?",
             c( "Victor", "victor" ),
             notes = c( 100, 50 ),
             commentaires = c( NA, "N'oubliez pas la majuscule aux noms propres&amp;thinsp;!" ) )

# On termine le questionnaire
finir_xml.moodle( )

# Importez le fichier exemple.numerique.xml dans Moodle pour voir le résultat...
print(
"Importez le fichier exemple.numerique.xml dans Moodle pour voir le résultat..." )

## End(Not run)
</code></pre>

<hr>
<h2 id='question.moodle'>
Créer une question Moodle au format XML
</h2><span id='topic+question.moodle'></span><span id='topic+debut_question.moodle'></span><span id='topic+fin_question.moodle'></span>

<h3>Description</h3>

<p>Ces fonctions permettent de créer une question pour Moodle au format
XML.</p>


<h3>Usage</h3>

<pre><code class='language-R'>question.moodle( type = "cloze",
                 titre = "Question...", texte, reponses = NULL,
                 penalite = NA, note = NA, commentaire.global = NA,
                 idnum = NA,
                 autres.codes = NULL,
                 fichier.xml = get( "fichier.xml",
                                    envir = SARP.Moodle.env ) )

debut_question.moodle( type,
                       titre, texte, 
                       penalite = NA, note = NA, 
                       commentaire.global = NA, idnum = NA,
                       fichier.xml = get( "fichier.xml",
                                          envir = SARP.Moodle.env ) )

fin_question.moodle( fichier.xml = get( "fichier.xml",
                                        envir = SARP.Moodle.env ) )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="question.moodle_+3A_texte">texte</code></td>
<td>
<p> Le texte de la question (une chaîne de caractères). Cet
énoncé peut contenir n'importe quel caractère (codage en UTF-8) et
n'importe quelles balises HTML. Il correspond à l'élément entre les
balises <code>&lt;questiontext&gt;</code> et <code>&lt;/questiontext&gt;</code> de la
question. C'est le seul argument obligatoire. </p>
</td></tr>
<tr><td><code id="question.moodle_+3A_type">type</code></td>
<td>
<p> Le type de question à créer (élément <code>type</code> de la
balise <code>&lt;question&gt;</code>). Vecteur contenant une seule chaîne de
caractères.</p>
</td></tr>
<tr><td><code id="question.moodle_+3A_titre">titre</code></td>
<td>
<p> L'intitulé de la question, en HTML. Il correspond à
l'élément entre les balises <code>&lt;name&gt;</code> et <code>&lt;/name&gt;</code> de la
question. Indiquez <code>NULL</code> pour ne pas donner de titre. </p>
</td></tr>
<tr><td><code id="question.moodle_+3A_reponses">reponses</code></td>
<td>
<p> Un vecteur. Chaque élément correspond à une réponse
possible, c'est-à-dire à un champ délimité par les balises
<code>&lt;answer&gt;</code> et <code>&lt;/answer&gt;</code>. <em>Attention</em>, les valeurs
de de ce vecteur sont indiquées telles qu'elles dans le fichier XML,
sans être protégées : n'utilisez des formats particuliers qu'avec
précaution, ou en les protégeant manuellement par une balise
<code>&lt;![CDATA[...]]&gt;</code> &mdash; ce que font les fonctions de création de
question prédéfinies, si nécessaire.
</p>
<p>Pour indiquer des commentaires (champs <code>&lt;feedback&gt;</code>), créez un
vecteur de chaînes de caractères de même longueur que celui des
réponses et associez-le aux réponses comme attribut, de nom
<code>commentaire</code>.  Utilisez <code>NA</code> pour laisser un commentaire
vide.
</p>
<p>Par défaut, la première réponse est considérée comme parfaitement
correcte (100% de la note) et toutes les autres comme fausses (0%).
Pour indiquer des fractions pour chaque note, créez un vecteur
numérique de même longueur que le nombre de réponses et associez-le
aux réponses comme attribut, de nom <code>fractions</code>.  </p>
</td></tr>
<tr><td><code id="question.moodle_+3A_commentaire.global">commentaire.global</code></td>
<td>
<p> Un vecteur de chaînes de caractère, de
longueur 1, correspondant au retour à indiquer globalement (champ
délimité par les balises <code>&lt;generalfeedback&gt;</code> et
<code>&lt;/generalfeedback&gt;</code> ).  Utilisez <code>NA</code> ou <code>NULL</code> pour
ne pas indiquer de commentaire. </p>
</td></tr>
<tr><td><code id="question.moodle_+3A_note">note</code></td>
<td>
<p> La note associée à cette question (champ délimité par les
balises <code>&lt;defaultgrade&gt;</code> et <code>&lt;/defaultgrade&gt;</code> ). Doit être
un vecteur numérique avec un seul élément. Utilisez <code>NA</code> pour
ne pas indiquer de note. </p>
</td></tr>
<tr><td><code id="question.moodle_+3A_penalite">penalite</code></td>
<td>
<p> La pénalité à utiliser en cas de tentatives
multiples, si le premier essai est incorrect (champ délimité par les
balises <code>&lt;penalty&gt;</code> et <code>&lt;/penalty&gt;</code> ). Doit être un
vecteur numérique avec un seul élément. Utilisez <code>NA</code> pour ne
pas indiquer de pénalité. </p>
</td></tr>
<tr><td><code id="question.moodle_+3A_idnum">idnum</code></td>
<td>
<p> Un entier qui identifie de façon unique la question.
L'unicité s'entend au sein de la catégorie à laquelle appartient la
question.  SARP.moodle vérifie l'unicité pour la catégorie en cours,
mais ne peut évidemment pas vérifier qu'il n'y a pas déjà dans la
base des questions avec cet identifiant...  Attention, à chaque
appel à <code><a href="#topic+categorie.moodle">categorie.moodle</a></code>, la liste des identifiants
est remise à zéro. </p>
</td></tr>
<tr><td><code id="question.moodle_+3A_autres.codes">autres.codes</code></td>
<td>
<p> Un vecteur de chaînes de caractère, correspondant
aux valeurs à donner à des champs optionnels de la question. Ils sont
écrits dans l'ordre. Le nom des champs est déterminé à partir du nom
des éléments du vecteur. </p>
</td></tr>
<tr><td><code id="question.moodle_+3A_fichier.xml">fichier.xml</code></td>
<td>
<p> Le fichier correspondant au questionnaire qui
contiendra cette question (par défaut, le dernier créé).  </p>
</td></tr>
</table>


<h3>Details</h3>

<p> Cette fonction est la fonction principale, appelée par toutes
les autres fonctions de création d'une question Moodle. Les autres
fonctions étant d'usage plus simple, n'utilisez cette fonction que pour
des cas non-prévus par les fonctions spécialisées.
</p>


<h3>Value</h3>

<p> Aucune valeur n'est renvoyée par cette fonction.  </p>


<h3>Author(s)</h3>

<p> Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a> </p>


<h3>See Also</h3>

<p><code><a href="#topic+numerique.moodle">numerique.moodle</a></code>, <code><a href="#topic+qcm.moodle">qcm.moodle</a></code>
<code><a href="#topic+qroc.moodle">qroc.moodle</a></code>, <code><a href="#topic+question_libre.moodle">question_libre.moodle</a></code>,
<code><a href="#topic+question_ouverte.moodle">question_ouverte.moodle</a></code>, <code><a href="#topic+vrai_faux.moodle">vrai_faux.moodle</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Commencer un nouveau questionnaire
q &lt;- debuter_xml.moodle( "exemple.question" )

# Catégorie : exemples
categorie.moodle( "Exemples SARP/Question" )

# Une question vrai-faux (en utilisant le type binaire)
reponses &lt;- c( "Vrai", "Faux" )
attr( reponses, "commentaire" ) &lt;- c( "Bravo !", "Elle n'est pas plate" )
attr( reponses, "fractions" ) &lt;- c( 100, 0 )
question.moodle( type  = "truefalse", titre = "Question binaire",
                 texte = "La Terre est ronde", reponses = reponses )

# On termine le questionnaire
finir_xml.moodle( )

# Importez le fichier exemple.question.xml dans Moodle pour voir le résultat...
print(
"Importez le fichier exemple.question.xml dans Moodle pour voir le résultat..." )

## End(Not run)
</code></pre>

<hr>
<h2 id='sortie_R.moodle'>
Insérer une sortie de R dans une question
</h2><span id='topic+sortie_R.moodle'></span><span id='topic+sortie_R.moodle.call'></span><span id='topic+sortie_R.moodle.default'></span><span id='topic+sortie_R.moodle.htest'></span><span id='topic+sortie_R.moodle.numeric'></span>

<h3>Description</h3>

<p>Ces fonctions permettent de créer du code HTML à partir du résultat
d'une fonction R, avec une mise en forme spécifique, pour insertion
dans une question Moodle.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sortie_R.moodle( objet.R, ... )

## S3 method for class 'htest'
sortie_R.moodle( objet.R, precision = 4, ... )
## S3 method for class 'call'
sortie_R.moodle( objet.R, precision = 4, ... )
## S3 method for class 'numeric'
sortie_R.moodle( objet.R, precision = 4,
            enjoliver = !cadre, cadre = TRUE,
            couleur.trait = "Black", lg.trait = "2",
            marge = if ( enjoliver ) c( 10, 10, 1, 1 ) else c( 25, 25, 1, 1 ),
            pre.X = NA, pre.X.nom = NA, noms.gras = TRUE, ... )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sortie_R.moodle_+3A_objet.r">objet.R</code></td>
<td>
<p>L'objet R à convertir</p>
</td></tr>
<tr><td><code id="sortie_R.moodle_+3A_precision">precision</code></td>
<td>
<p>Nombre de décimales à conserver pour l'affichage des
nombres (arrondis avec <code>round</code>). </p>
</td></tr>
<tr><td><code id="sortie_R.moodle_+3A_enjoliver">enjoliver</code></td>
<td>
<p>Si <code>TRUE</code>, la sortie est mise en forme en
utilisant des balises HTML appropriées. Sinon, elle est faite pour
reproduire le plus possible l'affichage dans la console R. </p>
</td></tr>
<tr><td><code id="sortie_R.moodle_+3A_cadre">cadre</code></td>
<td>
<p>Si <code>TRUE</code>, un cadre est dessiné (via les styles CSS
appropriées) tout autour de la sortie. </p>
</td></tr>
</table>
<p>Options pour l'affichage des vecteurs numériques
</p>
<table role = "presentation">
<tr><td><code id="sortie_R.moodle_+3A_couleur.trait">couleur.trait</code>, <code id="sortie_R.moodle_+3A_lg.trait">lg.trait</code></td>
<td>
<p>Couleur et épaisseur des filets des
tableaux, pour la mise en forme enjolivée. La couleur peut être
n'importe quelle couleur autorisée en CSS ; l'épaisseur des filets
est exprimée en pixels. </p>
</td></tr>
<tr><td><code id="sortie_R.moodle_+3A_marge">marge</code></td>
<td>
<p>Les marges à laisser au sein de chaque case du tableau
affichant les résultats. Ce doit être un vecteur de quatre valeurs
entières, correspondant dans l'ordre aux marges gauche, droite,
haute et basse, exprimées en pixels. </p>
</td></tr>
<tr><td><code id="sortie_R.moodle_+3A_pre.x">pre.X</code>, <code id="sortie_R.moodle_+3A_pre.x.nom">pre.X.nom</code></td>
<td>
<p>Dans la version enjolivée, textes à afficher
en première colonne du tableau, avant les premières valeurs.</p>
</td></tr>
<tr><td><code id="sortie_R.moodle_+3A_noms.gras">noms.gras</code></td>
<td>
<p>Si <code>TRUE</code>, les noms des éléments du vecteur sont
affichés en gras dans la première ligne du tableau.</p>
</td></tr>
<tr><td><code id="sortie_R.moodle_+3A_...">...</code></td>
<td>
<p>Paramètres de mise en forme additionnels, en particulier
indiquant la commande à afficher (<code>commande</code>), sa couleur
(<code>couleur.commande</code>, nom de couleur HTML/CSS et non R, par
défaut du bleu), s'il faut un cadre (<code>cadre</code>, présent par
défaut) et dans ce cas son épaisseur (<code>largeur.cadre</code>, 2 pixels
par défaut) et sa couleur (<code>couleur.cadre</code>, noir par défaut).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Une chaîne de caractère contenant le code HTML approprié.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+afficher_echantillon.moodle">afficher_echantillon.moodle</a></code> pour afficher un
vecteur de valeurs sous forme d'un tableau.
</p>

<hr>
<h2 id='vf.moodle'>
Créer une question à deux réponses possibles, dont une seule vraie
</h2><span id='topic+vrai_faux.moodle'></span>

<h3>Description</h3>

<p>Cette fonction permet de créer une question de type vrai ou faux.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vrai_faux.moodle( texte,  texte.vrai = "Vrai", texte.faux = "Faux",
                  commentaires = NULL,
                  titre = "Question vrai-faux...",
                  ordre = c( "aleatoire", NA, "random", "vrai premier", "faux premier" ),
                  melanger = FALSE,
                  fichier.xml = get( "fichier.xml", envir = SARP.Moodle.env ),
                  commentaire.global = NA, penalite = NA,
                  note.question = NA, idnum = NA, temps )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vf.moodle_+3A_texte">texte</code></td>
<td>
<p> L'énoncé de la question (une chaîne de caractères). Cet
énoncé peut contenir n'importe quel caractère (codage en UTF-8) et
n'importe quelles balises HTML.  </p>
</td></tr>
<tr><td><code id="vf.moodle_+3A_texte.vrai">texte.vrai</code></td>
<td>
<p> Le texte à utiliser pour la bonne réponse. </p>
</td></tr>
<tr><td><code id="vf.moodle_+3A_texte.faux">texte.faux</code></td>
<td>
<p> Le texte à utiliser pour la mauvaise réponse. </p>
</td></tr>
<tr><td><code id="vf.moodle_+3A_commentaires">commentaires</code></td>
<td>
<p> Un vecteur de deux chaînes de caractère,
correspondant au retour à indiquer pour la bonne réponse (premier
élément) et pour la mauvaise réponse (second élément). Utilisez
<code>NA</code> pour laisser un commentaire vide. </p>
</td></tr>
<tr><td><code id="vf.moodle_+3A_titre">titre</code></td>
<td>
<p> L'intitulé de la question, en HTML. </p>
</td></tr>
<tr><td><code id="vf.moodle_+3A_ordre">ordre</code></td>
<td>
<p> L'ordre dans lequel les deux réponses possibles doivent
apparaître. Les trois premières possibilités décident d'un ordre
aléatoire (fixe). Cette option n'a d'intérêt que si
<code>melanger=FALSE</code>...</p>
</td></tr>
<tr><td><code id="vf.moodle_+3A_melanger">melanger</code></td>
<td>
<p> Si <code>TRUE</code>, indique que Moodle devra tirer au
sort l'ordre d'affichage des réponses (qui changera donc à chaque fois
que la question sera posée). Sinon, l'ordre sera toujours celui
indiqué lors de la création de la question.</p>
</td></tr>
<tr><td><code id="vf.moodle_+3A_fichier.xml">fichier.xml</code></td>
<td>
<p> Le fichier correspondant au questionnaire qui
contiendra cette question (par défaut, le dernier créé).  </p>
</td></tr>
<tr><td><code id="vf.moodle_+3A_commentaire.global">commentaire.global</code>, <code id="vf.moodle_+3A_penalite">penalite</code>, <code id="vf.moodle_+3A_note.question">note.question</code>, <code id="vf.moodle_+3A_idnum">idnum</code></td>
<td>
<p>Options
communes à toutes les questions Moodle, voyez
<code><a href="#topic+debut_question.moodle">debut_question.moodle</a></code>.</p>
</td></tr>
<tr><td><code id="vf.moodle_+3A_temps">temps</code></td>
<td>
<p> Le temps conseillé pour répondre à la question, en
minutes. </p>
</td></tr>
</table>


<h3>Details</h3>

<p> Bien qu'un type particulier de question existe dans Moodle
pour les questions « vrai ou faux » (type <code>truefalse</code>), la
question générée avec cette fonction est une question de type
<code>multichoice</code>, afin d'avoir la liberté des intitulés des bonnes
et mauvaises réponses.
</p>
<p>Cette fonction est une interface simplifiée pour la
fonction <code><a href="#topic+question.moodle">question.moodle</a></code>.
</p>


<h3>Value</h3>

<p>Aucune valeur n'est renvoyée par cette fonction.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+numerique.moodle">numerique.moodle</a></code>, <code><a href="#topic+qcm.moodle">qcm.moodle</a></code>,
<code><a href="#topic+qroc.moodle">qroc.moodle</a></code>, <code><a href="#topic+question_ouverte.moodle">question_ouverte.moodle</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Commencer un nouveau questionnaire
q &lt;- debuter_xml.moodle( "exemple.VF" )

# Catégorie : exemples
categorie.moodle( "Exemples SARP/Vrai ou Faux" )

# Le format par défaut
vrai_faux.moodle( "Une question « vrai ou faux » offre le choix entre deux réponses" )

# et si la bonne réponse est « faux »
vrai_faux.moodle( "Le Soleil tourne autour de la Terre", "Faux", "Vrai" )

# avec des intitulés libres
vrai_faux.moodle( "La bataille de Marignan a eu lieu en...", "1515", "1914" )

# On termine le questionnaire
finir_xml.moodle( )

# Importez le fichier exemple.VF.xml dans Moodle pour voir le résultat...
print(
"Importez le fichier exemple.VF.xml dans Moodle pour voir le résultat..." )

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
