<!DOCTYPE html><html><head><title>Help for package alqrfe</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {alqrfe}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#alqrfe-package'><p>Adaptive Lasso Quantile Regression with Fixed Effects</p></a></li>
<li><a href='#bic_hat'><p>Bayesian Information Criteria</p></a></li>
<li><a href='#clean_data'><p>Clean missings</p></a></li>
<li><a href='#df_hat'><p>degrees of fredom</p></a></li>
<li><a href='#f_den'><p>Kernel density</p></a></li>
<li><a href='#f_tab'><p>Tabular function</p></a></li>
<li><a href='#loss_alqr'><p>Loss adaptive lasso quantile regression with fixed effects</p></a></li>
<li><a href='#loss_lqr'><p>Loss lasso quantile regression with fixed effects</p></a></li>
<li><a href='#loss_qr'><p>Loss quantile regression</p></a></li>
<li><a href='#loss_qrfe'><p>Loss quantile regression with fixed effects</p></a></li>
<li><a href='#make_z'><p>Incident matrix Z</p></a></li>
<li><a href='#mqr'><p>multiple penalized quantile regression</p></a></li>
<li><a href='#mqr_alpha'><p>multiple penalized quantile regression - alpha</p></a></li>
<li><a href='#optim_alqr'><p>optim adaptive lasso quantile regression with fixed effects</p></a></li>
<li><a href='#optim_lqr'><p>optim lasso quantile regression with fixed effects</p></a></li>
<li><a href='#optim_qr'><p>optim quantile regression</p></a></li>
<li><a href='#optim_qrfe'><p>optim quantile regression with fixed effects</p></a></li>
<li><a href='#plot_alpha'><p>plot multiple penalized quantile regression - alpha</p></a></li>
<li><a href='#plot_taus'><p>plot multiple penalized quantile regression</p></a></li>
<li><a href='#print.ALQRFE'><p>Print an ALQRFE</p></a></li>
<li><a href='#q_cov'><p>Covariance</p></a></li>
<li><a href='#qr'><p>quantile regression</p></a></li>
<li><a href='#rho_koenker'><p>Rho Koenker</p></a></li>
<li><a href='#sgf'><p>Identify significance</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Adaptive Lasso Quantile Regression with Fixed Effects</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-11-30</td>
</tr>
<tr>
<td>Description:</td>
<td>Quantile regression with fixed effects solves longitudinal data, considering the individual intercepts as fixed effects. The parametric set of this type of problem used to be huge. Thus penalized methods such as Lasso are currently applied. Adaptive Lasso presents oracle proprieties, which include Gaussianity and correct model selection. Bayesian information criteria (BIC) estimates the optimal tuning parameter lambda. Plot tools are also available.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.5), MASS (&ge; 7.3-49)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-30 20:16:22 UTC; ian</td>
</tr>
<tr>
<td>Author:</td>
<td>Ian Meneghel Danilevicz
    <a href="https://orcid.org/0000-0003-4541-0524"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Pascal Bondon [aut],
  Valderio A. Reisen [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ian Meneghel Danilevicz &lt;iandanilevicz@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-30 21:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='alqrfe-package'>Adaptive Lasso Quantile Regression with Fixed Effects</h2><span id='topic+alqrfe-package'></span><span id='topic+alqrfe'></span>

<h3>Description</h3>

<p>Quantile regression with fixed effects solves longitudinal data, considering the individual intercepts as fixed effects. The parametric set of this type of problem used to be huge. Thus penalized methods such as Lasso are currently applied. Adaptive Lasso presents oracle proprieties, which include Gaussianity and correct model selection. Bayesian information criteria (BIC) estimates the optimal tuning parameter lambda. Plot tools are also available.</p>


<h3>Package Content</h3>


<p>Index of help topics:
</p>
<pre>
alqrfe-package          Adaptive Lasso Quantile Regression with Fixed
                        Effects
bic_hat                 Bayesian Information Criteria
clean_data              Clean missings
df_hat                  degrees of fredom
f_den                   Kernel density
f_tab                   Tabular function
loss_alqr               Loss adaptive lasso quantile regression with
                        fixed effects
loss_lqr                Loss lasso quantile regression with fixed
                        effects
loss_qr                 Loss quantile regression
loss_qrfe               Loss quantile regression with fixed effects
make_z                  Incident matrix Z
mqr                     multiple penalized quantile regression
mqr_alpha               multiple penalized quantile regression - alpha
optim_alqr              optim adaptive lasso quantile regression with
                        fixed effects
optim_lqr               optim lasso quantile regression with fixed
                        effects
optim_qr                optim quantile regression
optim_qrfe              optim quantile regression with fixed effects
plot_alpha              plot multiple penalized quantile regression -
                        alpha
plot_taus               plot multiple penalized quantile regression
print.ALQRFE            Print an ALQRFE
q_cov                   Covariance
qr                      quantile regression
rho_koenker             Rho Koenker
sgf                     Identify significance
</pre>

<h3>Maintainer</h3>

<p>NA</p>


<h3>Author(s)</h3>

<p>NA</p>

<hr>
<h2 id='bic_hat'>Bayesian Information Criteria</h2><span id='topic+bic_hat'></span>

<h3>Description</h3>

<p>Bayesian Information Criteria
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bic_hat(res, theta, tau, N, p, inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bic_hat_+3A_res">res</code></td>
<td>
<p>Numeric vector, residuals.</p>
</td></tr>
<tr><td><code id="bic_hat_+3A_theta">theta</code></td>
<td>
<p>Numeric vector, parameters.</p>
</td></tr>
<tr><td><code id="bic_hat_+3A_tau">tau</code></td>
<td>
<p>Numeric scalar, the percentile.</p>
</td></tr>
<tr><td><code id="bic_hat_+3A_n">N</code></td>
<td>
<p>Numeric integer, sample size.</p>
</td></tr>
<tr><td><code id="bic_hat_+3A_p">p</code></td>
<td>
<p>Numeric integer, parameter length.</p>
</td></tr>
<tr><td><code id="bic_hat_+3A_inf">inf</code></td>
<td>
<p>Numeric, internal small quantity.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>BIC value
</p>

<hr>
<h2 id='clean_data'>Clean missings</h2><span id='topic+clean_data'></span>

<h3>Description</h3>

<p>Clean missings
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_data(y, x, id)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clean_data_+3A_y">y</code></td>
<td>
<p>Numeric vector, outcome.</p>
</td></tr>
<tr><td><code id="clean_data_+3A_x">x</code></td>
<td>
<p>Numeric matrix, covariates</p>
</td></tr>
<tr><td><code id="clean_data_+3A_id">id</code></td>
<td>
<p>Numeric vector, identifies the unit to which the observation belongs.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with the same objects y, x, id, but without missings.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 10
m = 4
d = 3
N = n*m
L = N*d
x = matrix(rnorm(L), ncol=d, nrow=N)
subj = rep(1:n, each=m)
alpha = rnorm(n)
beta = rnorm(d)
eps = rnorm(N)
y = x %*% beta  + matrix(rep(alpha, each=m) + eps)
y = as.vector(y)
x[1,3] = NA
clean_data(y=y, x=x, id=subj)  
 
</code></pre>

<hr>
<h2 id='df_hat'>degrees of fredom</h2><span id='topic+df_hat'></span>

<h3>Description</h3>

<p>This function estimates the degrees of fredom
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_hat(theta, N, p, inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="df_hat_+3A_theta">theta</code></td>
<td>
<p>Numeric vector, parameters to be test</p>
</td></tr>
<tr><td><code id="df_hat_+3A_n">N</code></td>
<td>
<p>Numeric integer, sample size.</p>
</td></tr>
<tr><td><code id="df_hat_+3A_p">p</code></td>
<td>
<p>Numeric integer, length of theta.</p>
</td></tr>
<tr><td><code id="df_hat_+3A_inf">inf</code></td>
<td>
<p>Numeric, internal small quantity.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>degrees of fredom
</p>

<hr>
<h2 id='f_den'>Kernel density</h2><span id='topic+f_den'></span>

<h3>Description</h3>

<p>Kernel density
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_den(x, inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="f_den_+3A_x">x</code></td>
<td>
<p>Numeric vector.</p>
</td></tr>
<tr><td><code id="f_den_+3A_inf">inf</code></td>
<td>
<p>Numeric, internal small quantity.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>y vector, kernel density estimation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = rnorm(10)
f_den(x, 0.0001)

</code></pre>

<hr>
<h2 id='f_tab'>Tabular function</h2><span id='topic+f_tab'></span>

<h3>Description</h3>

<p>Tabular function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_tab(N, n, d, theta, sig2, kind, inf, digt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="f_tab_+3A_n">N</code></td>
<td>
<p>sample size.</p>
</td></tr>
<tr><td><code id="f_tab_+3A_n">n</code></td>
<td>
<p>length of alpha.</p>
</td></tr>
<tr><td><code id="f_tab_+3A_d">d</code></td>
<td>
<p>length of beta.</p>
</td></tr>
<tr><td><code id="f_tab_+3A_theta">theta</code></td>
<td>
<p>Numeric vector.</p>
</td></tr>
<tr><td><code id="f_tab_+3A_sig2">sig2</code></td>
<td>
<p>Numeric vector.</p>
</td></tr>
<tr><td><code id="f_tab_+3A_kind">kind</code></td>
<td>
<p>Numeric, 1 means alpha, 2 means beta</p>
</td></tr>
<tr><td><code id="f_tab_+3A_inf">inf</code></td>
<td>
<p>Numeric scalar, internal value, small value.</p>
</td></tr>
<tr><td><code id="f_tab_+3A_digt">digt</code></td>
<td>
<p>Numeric integer, round.</p>
</td></tr>
</table>

<hr>
<h2 id='loss_alqr'>Loss adaptive lasso quantile regression with fixed effects</h2><span id='topic+loss_alqr'></span>

<h3>Description</h3>

<p>Loss adaptive lasso quantile regression with fixed effects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loss_alqr(theta, x, y, z, tau, n, d, mm, lambda, w)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loss_alqr_+3A_theta">theta</code></td>
<td>
<p>initial values</p>
</td></tr>
<tr><td><code id="loss_alqr_+3A_x">x</code></td>
<td>
<p>design matrix</p>
</td></tr>
<tr><td><code id="loss_alqr_+3A_y">y</code></td>
<td>
<p>vector output</p>
</td></tr>
<tr><td><code id="loss_alqr_+3A_z">z</code></td>
<td>
<p>incident matrix</p>
</td></tr>
<tr><td><code id="loss_alqr_+3A_tau">tau</code></td>
<td>
<p>percentile</p>
</td></tr>
<tr><td><code id="loss_alqr_+3A_n">n</code></td>
<td>
<p>N sample size</p>
</td></tr>
<tr><td><code id="loss_alqr_+3A_d">d</code></td>
<td>
<p>columns of x</p>
</td></tr>
<tr><td><code id="loss_alqr_+3A_mm">mm</code></td>
<td>
<p>n columns of z</p>
</td></tr>
<tr><td><code id="loss_alqr_+3A_lambda">lambda</code></td>
<td>
<p>constriction parameter</p>
</td></tr>
<tr><td><code id="loss_alqr_+3A_w">w</code></td>
<td>
<p>weights</p>
</td></tr>
</table>

<hr>
<h2 id='loss_lqr'>Loss lasso quantile regression with fixed effects</h2><span id='topic+loss_lqr'></span>

<h3>Description</h3>

<p>Loss lasso quantile regression with fixed effects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loss_lqr(theta, x, y, z, tau, n, d, mm, lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loss_lqr_+3A_theta">theta</code></td>
<td>
<p>initial values</p>
</td></tr>
<tr><td><code id="loss_lqr_+3A_x">x</code></td>
<td>
<p>design matrix</p>
</td></tr>
<tr><td><code id="loss_lqr_+3A_y">y</code></td>
<td>
<p>vector output</p>
</td></tr>
<tr><td><code id="loss_lqr_+3A_z">z</code></td>
<td>
<p>incident matrix</p>
</td></tr>
<tr><td><code id="loss_lqr_+3A_tau">tau</code></td>
<td>
<p>percentile</p>
</td></tr>
<tr><td><code id="loss_lqr_+3A_n">n</code></td>
<td>
<p>N sample size</p>
</td></tr>
<tr><td><code id="loss_lqr_+3A_d">d</code></td>
<td>
<p>columns of x</p>
</td></tr>
<tr><td><code id="loss_lqr_+3A_mm">mm</code></td>
<td>
<p>n columns of z</p>
</td></tr>
<tr><td><code id="loss_lqr_+3A_lambda">lambda</code></td>
<td>
<p>constriction parameter</p>
</td></tr>
</table>

<hr>
<h2 id='loss_qr'>Loss quantile regression</h2><span id='topic+loss_qr'></span>

<h3>Description</h3>

<p>Loss quantile regression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loss_qr(beta, x, y, tau, N, d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loss_qr_+3A_beta">beta</code></td>
<td>
<p>initial values</p>
</td></tr>
<tr><td><code id="loss_qr_+3A_x">x</code></td>
<td>
<p>design matrix</p>
</td></tr>
<tr><td><code id="loss_qr_+3A_y">y</code></td>
<td>
<p>vector output</p>
</td></tr>
<tr><td><code id="loss_qr_+3A_tau">tau</code></td>
<td>
<p>percentile</p>
</td></tr>
<tr><td><code id="loss_qr_+3A_n">N</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="loss_qr_+3A_d">d</code></td>
<td>
<p>columns of x</p>
</td></tr>
</table>

<hr>
<h2 id='loss_qrfe'>Loss quantile regression with fixed effects</h2><span id='topic+loss_qrfe'></span>

<h3>Description</h3>

<p>Loss quantile regression with fixed effects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loss_qrfe(theta, x, y, z, tau, n, d, mm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loss_qrfe_+3A_theta">theta</code></td>
<td>
<p>initial values</p>
</td></tr>
<tr><td><code id="loss_qrfe_+3A_x">x</code></td>
<td>
<p>design matrix</p>
</td></tr>
<tr><td><code id="loss_qrfe_+3A_y">y</code></td>
<td>
<p>vector output</p>
</td></tr>
<tr><td><code id="loss_qrfe_+3A_z">z</code></td>
<td>
<p>incident matrix</p>
</td></tr>
<tr><td><code id="loss_qrfe_+3A_tau">tau</code></td>
<td>
<p>percentile</p>
</td></tr>
<tr><td><code id="loss_qrfe_+3A_n">n</code></td>
<td>
<p>N sample size</p>
</td></tr>
<tr><td><code id="loss_qrfe_+3A_d">d</code></td>
<td>
<p>columns of x</p>
</td></tr>
<tr><td><code id="loss_qrfe_+3A_mm">mm</code></td>
<td>
<p>n columns of z</p>
</td></tr>
</table>

<hr>
<h2 id='make_z'>Incident matrix Z</h2><span id='topic+make_z'></span>

<h3>Description</h3>

<p>Create an Incident matrix Z
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_z(n, N, id)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_z_+3A_n">n</code></td>
<td>
<p>Numeric integer, number of incidents (subjects, units or individuals).</p>
</td></tr>
<tr><td><code id="make_z_+3A_n">N</code></td>
<td>
<p>Numeric integer, sample size.</p>
</td></tr>
<tr><td><code id="make_z_+3A_id">id</code></td>
<td>
<p>Numeric vector of integer, incident identification.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Z matrix.
</p>

<hr>
<h2 id='mqr'>multiple penalized quantile regression</h2><span id='topic+mqr'></span>

<h3>Description</h3>

<p>Estimate QR for several taus
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mqr(x, y, subj, tau = 1:9/10, method = "qr", ngrid = 20, inf = 1e-08, digt = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mqr_+3A_x">x</code></td>
<td>
<p>Numeric matrix, covariates</p>
</td></tr>
<tr><td><code id="mqr_+3A_y">y</code></td>
<td>
<p>Numeric vector, outcome.</p>
</td></tr>
<tr><td><code id="mqr_+3A_subj">subj</code></td>
<td>
<p>Numeric vector, identifies the unit to which the observation belongs.</p>
</td></tr>
<tr><td><code id="mqr_+3A_tau">tau</code></td>
<td>
<p>Numeric vector, identifies the percentiles.</p>
</td></tr>
<tr><td><code id="mqr_+3A_method">method</code></td>
<td>
<p>Factor, &quot;qr&quot; quantile regression, &quot;qrfe&quot; quantile regression with fixed effects, &quot;lqrfe&quot; Lasso quantile regression with fixed effects, &quot;alqr&quot; adaptive Lasso quantile regression with fixed effects.</p>
</td></tr>
<tr><td><code id="mqr_+3A_ngrid">ngrid</code></td>
<td>
<p>Numeric scalar greater than one, number of BIC to test.</p>
</td></tr>
<tr><td><code id="mqr_+3A_inf">inf</code></td>
<td>
<p>Numeric scalar, internal value, small value.</p>
</td></tr>
<tr><td><code id="mqr_+3A_digt">digt</code></td>
<td>
<p>Numeric scalar, internal value greater than one, define &quot;zero&quot; coefficient.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Beta Numeric array, with three dimmensions: 1) tau, 2) coef., lower bound, upper bound, 3) exploratory variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 10
m = 5
d = 4
N = n*m
L = N*d
x = matrix(rnorm(L), ncol=d, nrow=N)
subj = rep(1:n, each=m)
alpha = rnorm(n)
beta = rnorm(d)
eps = rnorm(N)
y = x %*% beta  + matrix(rep(alpha, each=m) + eps)
y = as.vector(y)

Beta = mqr(x,y,subj,tau=1:9/10, method="qr", ngrid = 10)
Beta

</code></pre>

<hr>
<h2 id='mqr_alpha'>multiple penalized quantile regression - alpha</h2><span id='topic+mqr_alpha'></span>

<h3>Description</h3>

<p>Estimate QR intercepts for several taus
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mqr_alpha(
  x,
  y,
  subj,
  tau = 1:9/10,
  method = "qr",
  ngrid = 20,
  inf = 1e-08,
  digt = 4
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mqr_alpha_+3A_x">x</code></td>
<td>
<p>Numeric matrix, covariates</p>
</td></tr>
<tr><td><code id="mqr_alpha_+3A_y">y</code></td>
<td>
<p>Numeric vector, outcome.</p>
</td></tr>
<tr><td><code id="mqr_alpha_+3A_subj">subj</code></td>
<td>
<p>Numeric vector, identifies the unit to which the observation belongs.</p>
</td></tr>
<tr><td><code id="mqr_alpha_+3A_tau">tau</code></td>
<td>
<p>Numeric vector, identifies the percentiles.</p>
</td></tr>
<tr><td><code id="mqr_alpha_+3A_method">method</code></td>
<td>
<p>Factor, &quot;qr&quot; quantile regression, &quot;qrfe&quot; quantile regression with fixed effects, &quot;lqrfe&quot; Lasso quantile regression with fixed effects, &quot;alqr&quot; adaptive Lasso quantile regression with fixed effects.</p>
</td></tr>
<tr><td><code id="mqr_alpha_+3A_ngrid">ngrid</code></td>
<td>
<p>Numeric scalar greater than one, number of BIC to test.</p>
</td></tr>
<tr><td><code id="mqr_alpha_+3A_inf">inf</code></td>
<td>
<p>Numeric scalar, internal value, small value.</p>
</td></tr>
<tr><td><code id="mqr_alpha_+3A_digt">digt</code></td>
<td>
<p>Numeric scalar, internal value greater than one, define &quot;zero&quot; coefficient.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Alpha Numeric array, with three dimmensions: 1) tau, 2) coef., lower bound, upper bound, 3) exploratory variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 10
m = 5
d = 4
N = n*m
L = N*d
x = matrix(rnorm(L), ncol=d, nrow=N)
subj = rep(1:n, each=m)
alpha = rnorm(n)
beta = rnorm(d)
eps = rnorm(N)
y = x %*% beta  + matrix(rep(alpha, each=m) + eps)
y = as.vector(y)

Alpha = mqr(x,y,subj,tau=1:9/10, method="qr", ngrid = 10)
Alpha

</code></pre>

<hr>
<h2 id='optim_alqr'>optim adaptive lasso quantile regression with fixed effects</h2><span id='topic+optim_alqr'></span>

<h3>Description</h3>

<p>This function solves an adaptive lasso quantile regression with fixed effects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optim_alqr(beta, alpha, wbeta, walpha, x, y, z, tau, N, d, n, ngrid, inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optim_alqr_+3A_beta">beta</code></td>
<td>
<p>Numeric vector, initials values</p>
</td></tr>
<tr><td><code id="optim_alqr_+3A_alpha">alpha</code></td>
<td>
<p>Numeric vector, initials values</p>
</td></tr>
<tr><td><code id="optim_alqr_+3A_wbeta">wbeta</code></td>
<td>
<p>Numeric vector, beta weigths</p>
</td></tr>
<tr><td><code id="optim_alqr_+3A_walpha">walpha</code></td>
<td>
<p>Numeric vector, alpha weigths</p>
</td></tr>
<tr><td><code id="optim_alqr_+3A_x">x</code></td>
<td>
<p>Numeric matrix, covariates.</p>
</td></tr>
<tr><td><code id="optim_alqr_+3A_y">y</code></td>
<td>
<p>Numeric vector, output.</p>
</td></tr>
<tr><td><code id="optim_alqr_+3A_z">z</code></td>
<td>
<p>Numeric matrix, incidents.</p>
</td></tr>
<tr><td><code id="optim_alqr_+3A_tau">tau</code></td>
<td>
<p>Numeric scalar, the percentile.</p>
</td></tr>
<tr><td><code id="optim_alqr_+3A_n">N</code></td>
<td>
<p>Numeric integer, sample size.</p>
</td></tr>
<tr><td><code id="optim_alqr_+3A_d">d</code></td>
<td>
<p>Numeric integer, X number of columns.</p>
</td></tr>
<tr><td><code id="optim_alqr_+3A_n">n</code></td>
<td>
<p>Numeric integer, length of alpha.</p>
</td></tr>
<tr><td><code id="optim_alqr_+3A_ngrid">ngrid</code></td>
<td>
<p>Numeric integer, number of iteractions of BIC.</p>
</td></tr>
<tr><td><code id="optim_alqr_+3A_inf">inf</code></td>
<td>
<p>Numeric, internal small quantity.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>parametric vector and residuals
</p>

<hr>
<h2 id='optim_lqr'>optim lasso quantile regression with fixed effects</h2><span id='topic+optim_lqr'></span>

<h3>Description</h3>

<p>This function solves a lasso quantile regression with fixed effects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optim_lqr(beta, alpha, x, y, z, tau, N, d, n, ngrid, inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optim_lqr_+3A_beta">beta</code></td>
<td>
<p>Numeric vector, initials values</p>
</td></tr>
<tr><td><code id="optim_lqr_+3A_alpha">alpha</code></td>
<td>
<p>Numeric vector, initials values</p>
</td></tr>
<tr><td><code id="optim_lqr_+3A_x">x</code></td>
<td>
<p>Numeric matrix, covariates.</p>
</td></tr>
<tr><td><code id="optim_lqr_+3A_y">y</code></td>
<td>
<p>Numeric vector, output.</p>
</td></tr>
<tr><td><code id="optim_lqr_+3A_z">z</code></td>
<td>
<p>Numeric matrix, incidents.</p>
</td></tr>
<tr><td><code id="optim_lqr_+3A_tau">tau</code></td>
<td>
<p>Numeric scalar, the percentile.</p>
</td></tr>
<tr><td><code id="optim_lqr_+3A_n">N</code></td>
<td>
<p>Numeric integer, sample size.</p>
</td></tr>
<tr><td><code id="optim_lqr_+3A_d">d</code></td>
<td>
<p>Numeric integer, X number of columns.</p>
</td></tr>
<tr><td><code id="optim_lqr_+3A_n">n</code></td>
<td>
<p>Numeric integer, length of alpha.</p>
</td></tr>
<tr><td><code id="optim_lqr_+3A_ngrid">ngrid</code></td>
<td>
<p>Numeric integer, number of iteractions of BIC.</p>
</td></tr>
<tr><td><code id="optim_lqr_+3A_inf">inf</code></td>
<td>
<p>Numeric, internal small quantity.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>parametric vector and residuals
</p>

<hr>
<h2 id='optim_qr'>optim quantile regression</h2><span id='topic+optim_qr'></span>

<h3>Description</h3>

<p>This function solves a quantile regression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optim_qr(beta, x, y, tau, N, d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optim_qr_+3A_beta">beta</code></td>
<td>
<p>Numeric vector, initials values.</p>
</td></tr>
<tr><td><code id="optim_qr_+3A_x">x</code></td>
<td>
<p>Numeric matrix, covariates.</p>
</td></tr>
<tr><td><code id="optim_qr_+3A_y">y</code></td>
<td>
<p>Numeric vector, output.</p>
</td></tr>
<tr><td><code id="optim_qr_+3A_tau">tau</code></td>
<td>
<p>Numeric scalar, the percentile.</p>
</td></tr>
<tr><td><code id="optim_qr_+3A_n">N</code></td>
<td>
<p>Numeric integer, sample size.</p>
</td></tr>
<tr><td><code id="optim_qr_+3A_d">d</code></td>
<td>
<p>Numeric integer, X number of columns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>parametric vector and residuals.
</p>

<hr>
<h2 id='optim_qrfe'>optim quantile regression with fixed effects</h2><span id='topic+optim_qrfe'></span>

<h3>Description</h3>

<p>This function solves a quantile regression with fixed effects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optim_qrfe(beta, alpha, x, y, z, tau, N, d, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optim_qrfe_+3A_beta">beta</code></td>
<td>
<p>Numeric vector, initials values</p>
</td></tr>
<tr><td><code id="optim_qrfe_+3A_alpha">alpha</code></td>
<td>
<p>Numeric vector, initials values</p>
</td></tr>
<tr><td><code id="optim_qrfe_+3A_x">x</code></td>
<td>
<p>Numeric matrix, covariates.</p>
</td></tr>
<tr><td><code id="optim_qrfe_+3A_y">y</code></td>
<td>
<p>Numeric vector, output.</p>
</td></tr>
<tr><td><code id="optim_qrfe_+3A_z">z</code></td>
<td>
<p>Numeric matrix, incidents.</p>
</td></tr>
<tr><td><code id="optim_qrfe_+3A_tau">tau</code></td>
<td>
<p>Numeric scalar, the percentile.</p>
</td></tr>
<tr><td><code id="optim_qrfe_+3A_n">N</code></td>
<td>
<p>Numeric integer, sample size.</p>
</td></tr>
<tr><td><code id="optim_qrfe_+3A_d">d</code></td>
<td>
<p>Numeric integer, X number of columns.</p>
</td></tr>
<tr><td><code id="optim_qrfe_+3A_n">n</code></td>
<td>
<p>Numeric integer, length of alpha.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>parametric vector and residuals
</p>

<hr>
<h2 id='plot_alpha'>plot multiple penalized quantile regression - alpha</h2><span id='topic+plot_alpha'></span>

<h3>Description</h3>

<p>plot QR intercepts for several taus
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_alpha(
  Beta,
  tau = 1:9/10,
  D,
  ylab = expression(alpha[1]),
  col = 2,
  lwd = 1,
  lty = 2,
  pch = 1,
  cex.axis = 1,
  cex.lab = 1,
  main = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_alpha_+3A_beta">Beta</code></td>
<td>
<p>Numeric array, with three dimmensions: 1) tau, 2) coef., lower bound, upper bound, 3) exploratory variables.</p>
</td></tr>
<tr><td><code id="plot_alpha_+3A_tau">tau</code></td>
<td>
<p>Numeric vector, identifies the percentiles.</p>
</td></tr>
<tr><td><code id="plot_alpha_+3A_d">D</code></td>
<td>
<p>intercept's number.</p>
</td></tr>
<tr><td><code id="plot_alpha_+3A_ylab">ylab</code></td>
<td>
<p>y legend</p>
</td></tr>
<tr><td><code id="plot_alpha_+3A_col">col</code></td>
<td>
<p>color.</p>
</td></tr>
<tr><td><code id="plot_alpha_+3A_lwd">lwd</code></td>
<td>
<p>line width.</p>
</td></tr>
<tr><td><code id="plot_alpha_+3A_lty">lty</code></td>
<td>
<p>line type.</p>
</td></tr>
<tr><td><code id="plot_alpha_+3A_pch">pch</code></td>
<td>
<p>point character.</p>
</td></tr>
<tr><td><code id="plot_alpha_+3A_cex.axis">cex.axis</code></td>
<td>
<p>cex axis length.</p>
</td></tr>
<tr><td><code id="plot_alpha_+3A_cex.lab">cex.lab</code></td>
<td>
<p>cex axis length.</p>
</td></tr>
<tr><td><code id="plot_alpha_+3A_main">main</code></td>
<td>
<p>title.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>n = 10
m = 5
d = 4
N = n*m
L = N*d
x = matrix(rnorm(L), ncol=d, nrow=N)
subj = rep(1:n, each=m)
alpha = rnorm(n)
beta = rnorm(d)
eps = rnorm(N)
y = x %*% beta  + matrix(rep(alpha, each=m) + eps)
y = as.vector(y)

Beta = mqr_alpha(x,y,subj,tau=1:9/10, method="qr", ngrid = 10)
plot_alpha(Beta,tau=1:9/10,D=1)

</code></pre>

<hr>
<h2 id='plot_taus'>plot multiple penalized quantile regression</h2><span id='topic+plot_taus'></span>

<h3>Description</h3>

<p>plot QR for several taus
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_taus(
  Beta,
  tau = 1:9/10,
  D,
  col = 2,
  lwd = 1,
  lty = 2,
  pch = 1,
  cex.axis = 1,
  cex.lab = 1,
  main = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_taus_+3A_beta">Beta</code></td>
<td>
<p>Numeric array, with three dimmensions: 1) tau, 2) coef., lower bound, upper bound, 3) exploratory variables.</p>
</td></tr>
<tr><td><code id="plot_taus_+3A_tau">tau</code></td>
<td>
<p>Numeric vector, identifies the percentiles.</p>
</td></tr>
<tr><td><code id="plot_taus_+3A_d">D</code></td>
<td>
<p>covariate's number.</p>
</td></tr>
<tr><td><code id="plot_taus_+3A_col">col</code></td>
<td>
<p>color.</p>
</td></tr>
<tr><td><code id="plot_taus_+3A_lwd">lwd</code></td>
<td>
<p>line width.</p>
</td></tr>
<tr><td><code id="plot_taus_+3A_lty">lty</code></td>
<td>
<p>line type.</p>
</td></tr>
<tr><td><code id="plot_taus_+3A_pch">pch</code></td>
<td>
<p>point character.</p>
</td></tr>
<tr><td><code id="plot_taus_+3A_cex.axis">cex.axis</code></td>
<td>
<p>cex axis length.</p>
</td></tr>
<tr><td><code id="plot_taus_+3A_cex.lab">cex.lab</code></td>
<td>
<p>cex axis length.</p>
</td></tr>
<tr><td><code id="plot_taus_+3A_main">main</code></td>
<td>
<p>title.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>n = 10
m = 5
d = 4
N = n*m
L = N*d
x = matrix(rnorm(L), ncol=d, nrow=N)
subj = rep(1:n, each=m)
alpha = rnorm(n)
beta = rnorm(d)
eps = rnorm(N)
y = x %*% beta  + matrix(rep(alpha, each=m) + eps)
y = as.vector(y)

Beta = mqr(x,y,subj,tau=1:9/10, method="qr", ngrid = 10)
plot_taus(Beta,tau=1:9/10,D=1)

</code></pre>

<hr>
<h2 id='print.ALQRFE'>Print an ALQRFE</h2><span id='topic+print.ALQRFE'></span>

<h3>Description</h3>

<p>Define the visible part of the object class ALQRFE
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ALQRFE'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.ALQRFE_+3A_x">x</code></td>
<td>
<p>An object of class &quot;ALQRFE&quot;</p>
</td></tr>
<tr><td><code id="print.ALQRFE_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>

<hr>
<h2 id='q_cov'>Covariance</h2><span id='topic+q_cov'></span>

<h3>Description</h3>

<p>Estimate Covariance matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>q_cov(alpha, beta, d, inf, n, N, res, method, tau, X, Z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="q_cov_+3A_alpha">alpha</code></td>
<td>
<p>Numeric vector.</p>
</td></tr>
<tr><td><code id="q_cov_+3A_beta">beta</code></td>
<td>
<p>Numeric vector.</p>
</td></tr>
<tr><td><code id="q_cov_+3A_d">d</code></td>
<td>
<p>length of beta.</p>
</td></tr>
<tr><td><code id="q_cov_+3A_inf">inf</code></td>
<td>
<p>Numeric scalar, internal value, small value.</p>
</td></tr>
<tr><td><code id="q_cov_+3A_n">n</code></td>
<td>
<p>length of alpha.</p>
</td></tr>
<tr><td><code id="q_cov_+3A_n">N</code></td>
<td>
<p>sample size.</p>
</td></tr>
<tr><td><code id="q_cov_+3A_res">res</code></td>
<td>
<p>Numeric vector, residuals.</p>
</td></tr>
<tr><td><code id="q_cov_+3A_method">method</code></td>
<td>
<p>Factor, &quot;qr&quot; quantile regression, &quot;qrfe&quot; quantile regression with fixed effects, &quot;lqrfe&quot; Lasso quantile regression with fixed effects, &quot;alqr&quot; adaptive Lasso quantile regression with fixed effects.</p>
</td></tr>
<tr><td><code id="q_cov_+3A_tau">tau</code></td>
<td>
<p>Numeric, identifies the percentile.</p>
</td></tr>
<tr><td><code id="q_cov_+3A_x">X</code></td>
<td>
<p>Numeric matrix, covariates.</p>
</td></tr>
<tr><td><code id="q_cov_+3A_z">Z</code></td>
<td>
<p>Numeric matrix, incident matrix.</p>
</td></tr>
</table>

<hr>
<h2 id='qr'>quantile regression</h2><span id='topic+qr'></span>

<h3>Description</h3>

<p>Estimate quantile regression with fixed effects for one tau
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qr(x, y, subj, tau = 0.5, method = "qr", ngrid = 20, inf = 1e-08, digt = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qr_+3A_x">x</code></td>
<td>
<p>Numeric matrix, covariates</p>
</td></tr>
<tr><td><code id="qr_+3A_y">y</code></td>
<td>
<p>Numeric vector, outcome.</p>
</td></tr>
<tr><td><code id="qr_+3A_subj">subj</code></td>
<td>
<p>Numeric vector, identifies the unit to which the observation belongs.</p>
</td></tr>
<tr><td><code id="qr_+3A_tau">tau</code></td>
<td>
<p>Numeric, identifies the percentile.</p>
</td></tr>
<tr><td><code id="qr_+3A_method">method</code></td>
<td>
<p>Factor, &quot;qr&quot; quantile regression, &quot;qrfe&quot; quantile regression with fixed effects, &quot;lqrfe&quot; Lasso quantile regression with fixed effects, &quot;alqr&quot; adaptive Lasso quantile regression with fixed effects.</p>
</td></tr>
<tr><td><code id="qr_+3A_ngrid">ngrid</code></td>
<td>
<p>Numeric scalar greater than one, number of BIC to test.</p>
</td></tr>
<tr><td><code id="qr_+3A_inf">inf</code></td>
<td>
<p>Numeric scalar, internal value, small value.</p>
</td></tr>
<tr><td><code id="qr_+3A_digt">digt</code></td>
<td>
<p>Numeric scalar, internal value greater than one, define &quot;zero&quot; coefficient.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>alpha       Numeric vector, intercepts' coefficients.
</p>
<p>beta        Numeric vector, exploratory variables' coefficients.
</p>
<p>lambda      Numeric, estimated lambda.
</p>
<p>res         Numeric vector, percentile residuals.
</p>
<p>tau         Numeric scalar, the percentile.
</p>
<p>penalty     Numeric scalar, indicate the chosen effect.
</p>
<p>sig2_alpha  Numeric vector, intercepts' standard errors.
</p>
<p>sig2_beta   Numeric vector, exploratory variables' standard errors.
</p>
<p>Tab_alpha   Data.frame, intercepts' summary.
</p>
<p>Tab_beta    Data.frame, exploratory variables' summary.
</p>
<p>Mat_alpha   Numeric matrix, intercepts' summary.
</p>
<p>Mat_beta    Numeric matrix, exploratory variables' summary.
</p>
<p>method      Factor, method applied.
</p>


<h3>References</h3>

<p>Koenker, R. (2004) &quot;Quantile regression for longitudinal data&quot;, J. Multivar. Anal., 91(1): 74-89, &lt;doi:10.1016/j.jmva.2004.05.006&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1
n = 10
m = 5
d = 4
N = n*m
L = N*d
x = matrix(rnorm(L), ncol=d, nrow=N)
subj = rep(1:n, each=m)
alpha = rnorm(n)
beta = rnorm(d)
eps = rnorm(N)
y = x %*% beta  + matrix(rep(alpha, each=m) + eps)
y = as.vector(y)
m1 = qr(x,y,subj,tau=0.75, method="qrfe")
m1
m2 = qr(x,y,subj,tau=0.3, method="lqrfe", ngrid = 10)
m2

# Example 2, from MASS package
Rabbit = MASS::Rabbit
Rabbit$Treatment = ifelse(Rabbit$Treatment=="Control",0,1)
Rabbit$Animal = ifelse(Rabbit$Animal == "R1",1,ifelse(Rabbit$Animal == "R2",2,
ifelse(Rabbit$Animal == "R3",3,ifelse(Rabbit$Animal == "R4",4,5))))
X = matrix(cbind(Rabbit$Dose,Rabbit$Treatment), ncol=2)
m3 = qr(x=X, y=Rabbit$BPchange, subj=Rabbit$Animal,tau=0.5, method="alqrfe", ngrid = 10)
m3

</code></pre>

<hr>
<h2 id='rho_koenker'>Rho Koenker</h2><span id='topic+rho_koenker'></span>

<h3>Description</h3>

<p>Rho Koenker
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rho_koenker(x, tau)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rho_koenker_+3A_x">x</code></td>
<td>
<p>generic vector</p>
</td></tr>
<tr><td><code id="rho_koenker_+3A_tau">tau</code></td>
<td>
<p>percentile</p>
</td></tr>
</table>

<hr>
<h2 id='sgf'>Identify significance</h2><span id='topic+sgf'></span>

<h3>Description</h3>

<p>Identify significance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sgf(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sgf_+3A_x">x</code></td>
<td>
<p>Numeric vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>y vector Factor, symbol flag of significant p-values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 10
pvalue = rgamma(10,1,10)
sgf(pvalue) 
  
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
