<!DOCTYPE html><html lang="en"><head><title>Help for package FRB</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FRB}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#diagplot'><p> Plot Method for Objects of class 'FRBmultireg'</p></a></li>
<li><a href='#ForgedBankNotes'><p> Swiss (forged) bank notes data</p></a></li>
<li><a href='#FRBhotellingMM'><p> Robust Hotelling test using the MM-estimator</p></a></li>
<li><a href='#FRBhotellingS'><p> Robust Hotelling test using the S-estimator</p></a></li>
<li><a href='#FRBmultiregGS'><p> GS-Estimates for multivariate regression with bootstrap confidence</p>
intervals</a></li>
<li><a href='#FRBmultiregMM'><p>MM-Estimates for Multivariate Regression with Bootstrap Inference</p></a></li>
<li><a href='#FRBmultiregS'><p>S-Estimates for Multivariate Regression with Bootstrap Inference</p></a></li>
<li><a href='#FRBpcaMM'><p> PCA based on Multivariate MM-estimators with Fast and Robust Bootstrap</p></a></li>
<li><a href='#FRBpcaS'><p> PCA based on Multivariate S-estimators with Fast and Robust Bootstrap</p></a></li>
<li><a href='#GSboot_multireg'><p> Fast and Robust Bootstrap for GS-Estimates</p></a></li>
<li><a href='#GSest_multireg'><p>GS Estimates for Multivariate Regression</p></a></li>
<li><a href='#MMboot_loccov'><p>Fast and Robust Bootstrap for MM-estimates of Location and Covariance</p></a></li>
<li><a href='#MMboot_multireg'><p> Fast and Robust Bootstrap for MM-Estimates of Multivariate Regression</p></a></li>
<li><a href='#MMboot_twosample'><p> Fast and Robust Bootstrap for Two-Sample MM-estimates of Location and Covariance</p></a></li>
<li><a href='#MMest_loccov'><p>S- and MM-Estimates of multivariate location and covariance matrix</p></a></li>
<li><a href='#MMest_multireg'><p>MM-Estimates for Multivariate Regression</p></a></li>
<li><a href='#plot.FRBhot'><p> Plot Method for Objects of class 'FRBhot'</p></a></li>
<li><a href='#plot.FRBmultireg'><p> Plot Method for Objects of class 'FRBmultireg'</p></a></li>
<li><a href='#plot.FRBpca'><p> Plot Method for Objects of class 'FRBpca'</p></a></li>
<li><a href='#Sboot_loccov'><p>Fast and Robust Bootstrap for S-estimates of location/covariance</p></a></li>
<li><a href='#Sboot_multireg'><p> Fast and Robust Bootstrap for S-Estimates of Multivariate Regression</p></a></li>
<li><a href='#Sboot_twosample'><p> Fast and Robust Bootstrap for Two-Sample S-estimates of Location and Covariance</p></a></li>
<li><a href='#schooldata'><p> School Data</p></a></li>
<li><a href='#Scontrol'><p> Tuning parameters for multivariate S, MM and GS estimates</p></a></li>
<li><a href='#Sest_multireg'><p>S-Estimates for Multivariate Regression</p></a></li>
<li><a href='#summary.FRBhot'><p> Summary Method for Objects of Class 'FRBhot'</p></a></li>
<li><a href='#summary.FRBmultireg'><p> Summary Method for Objects of Class 'FRBmultireg'</p></a></li>
<li><a href='#summary.FRBpca'><p> Summary Method for Objects of Class 'FRBpca'</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>2.0-1</td>
</tr>
<tr>
<td>VersionNote:</td>
<td>Archived on CRAN 2013-04-16</td>
</tr>
<tr>
<td>Title:</td>
<td>Fast and Robust Bootstrap</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>rrcov, corpcor</td>
</tr>
<tr>
<td>Suggests:</td>
<td>robustbase</td>
</tr>
<tr>
<td>Description:</td>
<td>Perform robust inference based on applying Fast and Robust Bootstrap 
    on robust estimators (Van Aelst and Willems (2013) &lt;<a href="https://doi.org/10.18637%2Fjss.v053.i03">doi:10.18637/jss.v053.i03</a>&gt;). 
    This method constitutes an alternative to ordinary bootstrap or asymptotic inference. 
    procedures when using robust estimators such as S-, MM- or GS-estimators. 
    The available methods are multivariate regression, principal component analysis 
    and one-sample and two-sample Hotelling tests. It provides both the robust point 
    estimates and uncertainty measures based on the fast and robust bootstrap.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Valentin Todorov &lt;valentin.todorov@chello.at&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Author:</td>
<td>Ella Roelant [aut],
  Stefan Van Aelst [aut],
  Gert Willems [aut],
  Valentin Todorov <a href="https://orcid.org/0000-0003-4215-0245"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-05 20:01:31 UTC; valen</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-07 12:20:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='diagplot'> Plot Method for Objects of class 'FRBmultireg' </h2><span id='topic+diagplot'></span><span id='topic+diagplot.FRBmultireg'></span><span id='topic+diagplot.FRBpca'></span><span id='topic+diagplot.FRBhot'></span>

<h3>Description</h3>

<p>Diagnostic plots for objects of class <code>FRBmultireg</code>, <code>FRBpca</code> and <code>FRBhot</code>. It shows robust distances
and allows detection of multivariate outliers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FRBmultireg'
diagplot(x, Xdist = TRUE, ...)

## S3 method for class 'FRBpca'
diagplot(x, EIF = TRUE, ...)

## S3 method for class 'FRBhot'
diagplot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diagplot_+3A_x">x</code></td>
<td>
<p> an <span class="rlang"><b>R</b></span> object of class <code>FRBmultireg</code> (typically created by  <code><a href="#topic+FRBmultiregS">FRBmultiregS</a></code>, <code><a href="#topic+FRBmultiregMM">FRBmultiregMM</a></code> or <code><a href="#topic+FRBmultiregGS">FRBmultiregGS</a></code> or by <code><a href="#topic+Sest_multireg">Sest_multireg</a></code>, <code><a href="#topic+MMest_multireg">MMest_multireg</a></code> or <code><a href="#topic+GSest_multireg">GSest_multireg</a></code>)
or an <span class="rlang"><b>R</b></span> object of class <code>FRBpca</code> (typically created by  <code><a href="#topic+FRBpcaS">FRBpcaS</a></code> or <code><a href="#topic+FRBpcaMM">FRBpcaMM</a></code>)
or an <span class="rlang"><b>R</b></span> object of class <code>FRBhot</code> (typically created by  <code><a href="#topic+FRBhotellingS">FRBhotellingS</a></code> or <code><a href="#topic+FRBhotellingMM">FRBhotellingMM</a></code>) </p>
</td></tr>
<tr><td><code id="diagplot_+3A_xdist">Xdist</code></td>
<td>
<p> logical: if TRUE, the plot shows the robust distance versus the distance in the space of the explanatory variables;
if FALSE, it plots the robust distance versus the index of the observation</p>
</td></tr>
<tr><td><code id="diagplot_+3A_eif">EIF</code></td>
<td>
<p> logical: if TRUE, the plot shows the robust distance versus an influence measure for each point;
if FALSE, it plots the robust distance versus the index of the observation </p>
</td></tr>
<tr><td><code id="diagplot_+3A_...">...</code></td>
<td>
<p> potentially more arguments to be passed </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The diagnostic plots are based on the robust distances of the observations. In a multivariate sample <code class="reqn">X_n=\{\mathbf{x}_1,...,\mathbf{x}_n\}</code>,
the robust distance <code class="reqn">d_i</code> of observation <code class="reqn">i</code> is given by
<code class="reqn">d_i^2=(\mathbf{x}_i-\hat{\mu})'\hat{\Sigma}^{-1}(\mathbf{x}_i-\hat{\mu})</code>.
where <code class="reqn">\hat{\mu}</code> and <code class="reqn">\hat{\Sigma}</code> are robust estimates of location and covariance.
Observations with large robust distance are considered as outlying.
</p>
<p>The default diagnostic plot in the multivariate regresssion setting (i.e. for objects of type <code>FRBmultireg</code> and <code>Xdist=TRUE</code>),
shows the residual distances (i.e. the robust distances of the multivariate residuals) based on the estimates in <code>x</code>,
versus the distances within the space of the explanatory variables. The latter are based on robust estimates of location and scatter for the
data matrix <code>x$X</code> (without intercept). Computing these robust estimates may take an appreciable amount of time. The estimator used
corresponds to the one which was used in obtaining <code>Xmultireg</code> (with the same breakdown point, for example, and the same control parameters).
On the vertical axis a cutoff line is drawn at the square root of the .975 quantile of the chi-squared distribution with degrees of
freedom equal to the number of response variables. On the horizontal axis the same quantile is drawn but now with degrees of freedom
equal to the number of covariates (not including intercept).
Those points to the right of the cutoff can be viewed as high-leverage points. These can be classified into so-called
'bad' or 'good' leverage points depending on whether they are above or below the cutoff. Points above the cutoff but to the
left of the vertical cutoff are sometimes called vertical outliers.
See also Van Aelst and Willems (2005) for example.
</p>
<p>To avoid the additional computation time, one can choose <code>Xdist=FALSE</code>, in which case the residual distances are simply plotted
versus the index of the observation.
</p>
<p>The default plot in the context of PCA (i.e. for objects of type <code>FRBpca</code> and <code>EIF=FALSE</code>)
is a plot proposed by Pison and Van Aelst (2004). It shows the robust distance versus a measure of the overall empirical influence
of the observation on the (classical) principal components. The empirical influences are obtained by using the influence function of
the eigenvectors of the empirical or classical shape estimator at the normal model, and by
substituting therein the robust estimates for the population parameters.
The overall influence value is then defined by averaging the squared influence
over all coefficients in the eigenvectors.
The vertical line on the plot is an indicative cutoff value, obtained through simulation. This last part takes
a few moments of computation time.
</p>
<p>Again, to avoid the additional computation time, one can choose <code>EIF=FALSE</code>, in which case the robust distances are simply plotted
versus the index of the observation.
</p>
<p>For the result of the robust Hotelling test (i.e. for objects of type <code>FRBhot</code>), the method plots the robust
distance versus the index. In case of a two-sample test, the indices are within-sample and a vertical line separates
the two groups. In the two-sample case, each group has its own location estimate <code class="reqn">\hat{\mu}</code> and a common
covariance estimate <code class="reqn">\hat{\Sigma}</code>.
</p>


<h3>Value</h3>

<p>Returns invisibly the first argument.
</p>


<h3>Author(s)</h3>

<p> Gert Willems and Ella Roelant </p>


<h3>References</h3>


<ul>
<li><p> G. Pison and S. Van Aelst (2004). Diagnostic Plots for Robust Multivariate Methods. 
<em>Journal of Computational and Graphical Statistics</em>, <b>13</b>, 310&ndash;329.
</p>


</li>
<li><p> S. Van Aelst and G. Willems (2005). Multivariate Regression S-Estimators for Robust Estimation and Inference. 
<em>Statistica Sinica</em>, <b>15</b>, 981&ndash;1001.
</p>
</li>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

 <p><code><a href="#topic+FRBmultiregS">FRBmultiregS</a></code>, <code><a href="#topic+FRBmultiregMM">FRBmultiregMM</a></code>, <code><a href="#topic+FRBmultiregGS">FRBmultiregGS</a></code>, <code><a href="#topic+FRBpcaS">FRBpcaS</a></code>
, <code><a href="#topic+FRBpcaMM">FRBpcaMM</a></code>, <code><a href="#topic+FRBhotellingS">FRBhotellingS</a></code>, <code><a href="#topic+FRBhotellingMM">FRBhotellingMM</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
    ## for multivariate regression:
    
        data(schooldata)
        MMres &lt;- MMest_multireg(cbind(reading,mathematics,selfesteem)~., data=schooldata)
        diagplot(MMres)
        ## a large 'bad leverage' outlier should be noticeable (observation 59)
    
        
    ## for PCA:
    
        data(ForgedBankNotes)
        MMres &lt;- FRBpcaMM(ForgedBankNotes)
        diagplot(MMres)
    
    
    ## a group of 15 fairly strong outliers can be seen which apparently would have
    ## a large general influence on a classical PCA analysis
    
    ## for Hotelling tests (two-sample)
    
        data(hemophilia, package="rrcov")
        MMres &lt;- FRBhotellingMM(cbind(AHFactivity, AHFantigen) ~ gr, data=hemophilia)
        diagplot(MMres)
    
    
    ## the data seem practically outlier-free

</code></pre>

<hr>
<h2 id='ForgedBankNotes'> Swiss (forged) bank notes data</h2><span id='topic+ForgedBankNotes'></span>

<h3>Description</h3>

<p>Six measurements made on 100 forged Swiss bank notes. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ForgedBankNotes)</code></pre>


<h3>Format</h3>

<p>The data frame contains the following columns:
</p>

<dl>
<dt><code>Length</code></dt><dd><p>metric length of the bill</p>
</dd>
<dt><code>Left</code></dt><dd><p>height of the bill, measured on the left</p>
</dd>
<dt><code>Right</code></dt><dd><p>height of the bill, measured on the right</p>
</dd>
<dt><code>Bottom</code></dt><dd><p>distance of inner frame to the lower border</p>
</dd>
<dt><code>Top</code></dt><dd><p>distance of inner frame to the upper border</p>
</dd>
<dt><code>Diagonal</code></dt><dd><p>length of the diagonal</p>
</dd>
</dl>



<h3>Details</h3>

<p>The original data set in Flury and Riedwyl (1988) additionally contained 100 genuine bank notes, but these are not included here. 
</p>


<h3>Source</h3>

<p>B. Flury and H. Riedwyl (1988) <em>Multivariate Statistics: A practical approach</em>. London: Chapman &amp; Hall. 
</p>


<h3>References</h3>

<p>M. Salibian-Barrera, S. Van Aelst and G. Willems (2006) PCA based on multivariate MM-estimators
with fast and robust bootstrap. <em>Journal of the American Statistical Association</em>, <b>101</b>, 1198-1211.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ForgedBankNotes)
pairs(ForgedBankNotes)
</code></pre>

<hr>
<h2 id='FRBhotellingMM'> Robust Hotelling test using the MM-estimator  </h2><span id='topic+FRBhotellingMM'></span><span id='topic+FRBhotellingMM.default'></span><span id='topic+FRBhotellingMM.formula'></span>

<h3>Description</h3>

<p>Robust one-sample and two-sample Hotelling test using the MM-estimator and the Fast and Robust Bootstrap. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'formula'
FRBhotellingMM(formula, data=NULL, ...)

## Default S3 method:
FRBhotellingMM(X, Y=NULL, mu0 = 0, R = 999, conf = 0.95, 
                method = c("HeFung", "pool"),control=MMcontrol(...),
                na.action=na.omit, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FRBhotellingMM_+3A_formula">formula</code></td>
<td>
<p> an object of class <code><a href="stats.html#topic+formula">formula</a></code>; a symbolic description of the model to be fit.</p>
</td></tr>
<tr><td><code id="FRBhotellingMM_+3A_data">data</code></td>
<td>
<p> data frame from which variables specified in formula are to be taken.</p>
</td></tr>
<tr><td><code id="FRBhotellingMM_+3A_x">X</code></td>
<td>
<p> a matrix or data-frame</p>
</td></tr>
<tr><td><code id="FRBhotellingMM_+3A_y">Y</code></td>
<td>
<p> an optional matrix or data-frame in case of a two-sample test</p>
</td></tr>
<tr><td><code id="FRBhotellingMM_+3A_mu0">mu0</code></td>
<td>
<p> an optional vector of data values (or a single number which will be repeated <code class="reqn">p</code> times) indicating the
true value of the mean (does not apply in case of the two-sample test). Default is the null vector <code>mu0=0</code>.</p>
</td></tr>
<tr><td><code id="FRBhotellingMM_+3A_r">R</code></td>
<td>
<p> number of bootstrap samples. Default is <code>R=999</code>. </p>
</td></tr>
<tr><td><code id="FRBhotellingMM_+3A_conf">conf</code></td>
<td>
<p> confidence level for the simultaneous confidence intervals. Default is <code>conf=0.95</code>. </p>
</td></tr>
<tr><td><code id="FRBhotellingMM_+3A_method">method</code></td>
<td>
<p> for the two-sample Hotelling test, indicates the way the common covariance matrix is estimated:
<code>"pool"</code>= pooled covariance matrix, <code>"HeFung"</code>= using the multisample method of He and Fung.</p>
</td></tr>
<tr><td><code id="FRBhotellingMM_+3A_control">control</code></td>
<td>
<p>a list with control parameters for tuning the MM-estimate and its computing algorithm, 
see <code><a href="#topic+MMcontrol">MMcontrol</a></code>().</p>
</td></tr>
<tr><td><code id="FRBhotellingMM_+3A_na.action">na.action</code></td>
<td>
<p> a function which indicates what should happen when the data contain NAs. Defaults to <code><a href="stats.html#topic+na.omit">na.omit</a></code>.</p>
</td></tr>  
<tr><td><code id="FRBhotellingMM_+3A_...">...</code></td>
<td>
<p>allows for specifying control parameters directly instead of via <code>control</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The classical Hotelling test for testing if the mean equals a certain value or if two means 
are equal is modified into a robust one through substitution of the empirical estimates 
by the MM-estimates of location and scatter. The MM-estimator, using Tukey's biweight function, is tuned by default to have
a breakdown point of 50% and 95% location efficiency. This could be changed through the <code>control</code> argument if desired. 
The MM-estimates are obtained by first computing the S-estimates with the fast-S algorithm followed by the M-part through reweighted least squares (RWLS) iteration. See <code><a href="#topic+MMcontrol">MMcontrol</a></code> for some adjustable tuning parameters regarding the algorithm.
</p>
<p>The fast and robust bootstrap is used to mimic the distribution of the test statistic under the null 
hypothesis. For instance, the 5% critical value for the test is given by the 95% quantile of the recalculated statistics. 
</p>
<p>Robust simultaneous confidence intervals for linear combinations of the mean (or difference in means) are developed similarly to the classical case
(Johnson and Wichern, 1988, page 239). The value <code>CI</code> is a matrix with the confidence intervals for each element
of the mean (or difference in means), with level <code>conf</code>. It consists of two rows, the first being the lower bound and the second the upper bound.
Note that these intervals are rather conservative in the sense that the simultaneous confidence level holds for all linear combinations
and here only <code class="reqn">p</code> of these are considered (with <code class="reqn">p</code> the dimension of the data).
</p>
<p>For the two-sample Hotelling test we assume that the samples have an underlying distribution with the same covariance matrix.
This covariance matrix can be estimated in two different ways using the pooled covariance matrix or the two-sample 
estimator of He and Fung (He and Fung 2000), and argument <code>method</code> defaults to the second option. 
For more details see Roelant et al. (2008).
</p>
<p>In the two-sample version, the null hypothesis always states that the two means are equal. For the one-sample version, the default
null hypothesis is that the mean equals zero, but the hypothesized value can be changed and specified through argument <code>mu0</code>.
</p>
<p>Bootstrap samples are discarded if the fast and robust covariance estimate is not positive definite, such that the actual number 
of recalculations used can be lower than <code>R</code>. This number is returned as <code>ROK</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>FRBhot</code> which extends class <code>htest</code> and contains at least the following components:
</p>
<table role = "presentation">
<tr><td><code>statistic</code></td>
<td>
<p>the value of the robust test statistic.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>p-value of the robust one or two-sample Hotelling test, determined by the fast and robust bootstrap</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the estimated mean vector or vectors depending on whether it was a one-sample test or a two-sample test.</p>
</td></tr> 
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating what type of Hotelling test was performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data.</p>
</td></tr>
<tr><td><code>teststat.boot</code></td>
<td>
<p>the bootstrap recalculated values of the robust test statistic.</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>bootstrap simultaneous confidence intervals for each component of the center</p>
</td></tr>
<tr><td><code>conf</code></td>
<td>
<p>a copy of the <code>conf</code> argument</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p>covariance of one-sample or common covariance matrix in the case of two samples</p>
</td></tr>
<tr><td><code>w</code></td>
<td>
<p>implicit weights corresponding to the MM-estimates (i.e. final weights in the RWLS procedure)</p>
</td></tr>
<tr><td><code>outFlag</code></td>
<td>
<p>outlier flags: 1 if the robust distance of the observation exceeds the .975 quantile of (the square root of)
the chi-square distribution with degrees of freedom equal to the dimension of <code>X</code>; 0 otherwise</p>
</td></tr>
<tr><td><code>ROK</code></td>
<td>
<p>number of bootstrap samples actually used (i.e. not discarded due to non-positive definite covariance </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Ella Roelant, Stefan Van Aelst and Gert Willems </p>


<h3>References</h3>

 

<ul>
<li><p> X. He and W.K. Fung (2000) High breakdown estimation for multiple populations with applications to discriminant analysis. 
<em>Journal of Multivariate Analysis</em>, <b>72</b>, 151&ndash;162.
</p>
</li>
<li><p> R.A. Johnson, D.W. Wichern (1988) Applied Multivariate Statistical Analysis, 
2nd Edition, Prentice-Hall.
</p>
</li>
<li><p> E. Roelant, S. Van Aelst and G. Willems, (2008) Fast Bootstrap for Robust Hotelling Tests, COMPSTAT 2008: 
Proceedings in Computational Statistics (P. Brito, Ed.) Heidelberg: Physika-Verlag, 709&ndash;719.
</p>
</li>
<li><p> M. Salibian-Barrera, S. Van Aelst and G. Willems (2008) Fast and robust  bootstrap. 
<em>Statistical Methods and Applications</em>, <b>17</b>, 41&ndash;71. 
</p>
</li>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

 <p><code><a href="#topic+plot.FRBhot">plot.FRBhot</a></code>, <code><a href="#topic+summary.FRBhot">summary.FRBhot</a></code>, <code><a href="#topic+FRBhotellingS">FRBhotellingS</a></code>, <code><a href="#topic+MMcontrol">MMcontrol</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## One sample robust Hotelling test
data(delivery, package="robustbase")
delivery.x &lt;- delivery[, 1:2]
FRBhotellingMM(delivery.x, R=199)

## One sample robust Hotelling test
data(ForgedBankNotes)
samplemean &lt;- apply(ForgedBankNotes, 2, mean)
res = FRBhotellingMM(ForgedBankNotes, mu0=samplemean,R=199)
res
# Note that the test rejects the hypothesis that the true mean equals the
# sample mean; this is due to outliers in the data (i.e. the robustly estimated
# mean apparently significantly differs from the non-robust sample mean.

# Graphical display of the results:
plot(res)
# It is clear from the (scaled) simultaneous confidence limits that the rejection
# of the hypothesis is due to the differences in variables Bottom and Diagonal

## Two sample robust Hotelling test
data(hemophilia, package="rrcov")
grp &lt;-as.factor(hemophilia[,3])
x &lt;- hemophilia[which(grp==levels(grp)[1]),1:2]
y &lt;- hemophilia[which(grp==levels(grp)[2]),1:2]

#using the pooled covariance matrix to estimate the common covariance matrix

    res &lt;- FRBhotellingMM(x, y, method="pool")



#using the estimator of He and Fung to estimate the common covariance matrix
res &lt;- FRBhotellingMM(x,y,method="HeFung",R=199)

# or using the formula interface

res &lt;- FRBhotellingMM(as.matrix(hemophilia[,-3])~hemophilia[,3], method="HeFung")


# From the confidence limits it can be seen that the significant difference
# is mainly caused by the AHFactivity variable. The graphical display helps too:
plot(res)
# the red line on the histogram indicates the test statistic value in the original
# sample (it is omitted if the statistic exceeds 100)

</code></pre>

<hr>
<h2 id='FRBhotellingS'> Robust Hotelling test using the S-estimator </h2><span id='topic+FRBhotellingS'></span><span id='topic+FRBhotellingS.default'></span><span id='topic+FRBhotellingS.formula'></span>

<h3>Description</h3>

<p>Robust one-sample and two-sample Hotelling test using the S-estimator and the Fast and Robust Bootstrap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'formula'
FRBhotellingS(formula, data=NULL, ...)

## Default S3 method:
FRBhotellingS(X, Y=NULL, mu0 = 0, R = 999, bdp = 0.5, conf = 0.95,
method = c("HeFung", "pool"), control=Scontrol(...),
na.action=na.omit, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FRBhotellingS_+3A_formula">formula</code></td>
<td>
<p> an object of class <code><a href="stats.html#topic+formula">formula</a></code>; a symbolic description of the model to be fit.</p>
</td></tr>
<tr><td><code id="FRBhotellingS_+3A_data">data</code></td>
<td>
<p> data frame from which variables specified in formula are to be taken.</p>
</td></tr>
<tr><td><code id="FRBhotellingS_+3A_x">X</code></td>
<td>
<p> a matrix or data-frame</p>
</td></tr>
<tr><td><code id="FRBhotellingS_+3A_y">Y</code></td>
<td>
<p> an optional matrix or data-frame in case of a two-sample test</p>
</td></tr>
<tr><td><code id="FRBhotellingS_+3A_mu0">mu0</code></td>
<td>
<p> an optional vector of data values (or a single number which will be repeated p times) indicating the
true value of the mean (does not apply in case of the two-sample test). Default is the null vector <code>mu0=0</code></p>
</td></tr>
<tr><td><code id="FRBhotellingS_+3A_r">R</code></td>
<td>
<p> number of bootstrap samples. Default is <code>R=999</code>.  </p>
</td></tr>
<tr><td><code id="FRBhotellingS_+3A_bdp">bdp</code></td>
<td>
<p> required breakdown point. Should have <code class="reqn">0 &lt; </code> <code>bdp</code> <code class="reqn">\le 0.5</code>, the default is 0.5 </p>
</td></tr>
<tr><td><code id="FRBhotellingS_+3A_conf">conf</code></td>
<td>
<p> confidence level for the simultaneous confidence intervals. Default is <code>conf=0.95</code> </p>
</td></tr>
<tr><td><code id="FRBhotellingS_+3A_method">method</code></td>
<td>
<p> for the two-sample Hotelling test, indicates the way the common covariance matrix is estimated:
<code>"pool"</code>= pooled covariance matrix, <code>"HeFung"</code>= using the He and Fung method </p>
</td></tr>
<tr><td><code id="FRBhotellingS_+3A_control">control</code></td>
<td>
<p>a list with control parameters for tuning the computing algorithm, see <code><a href="#topic+Scontrol">Scontrol</a></code>().</p>
</td></tr>
<tr><td><code id="FRBhotellingS_+3A_na.action">na.action</code></td>
<td>
<p> a function which indicates what should happen when the data contain NAs. Defaults to <code><a href="stats.html#topic+na.omit">na.omit</a></code>.</p>
</td></tr>
<tr><td><code id="FRBhotellingS_+3A_...">...</code></td>
<td>
<p>allows for specifying control parameters directly instead of via <code>control</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>  The classical Hotelling test for testing if the mean equals a certain center or if two means 
are equal is modified into a robust one through substitution of the empirical estimates 
by the S-estimates of location and scatter. The S-estimator uses Tukey's biweight function where the constant is chosen
to obtain the desired breakdown point as specified by <code>bdp</code>. 
One-sample S-estimates are computed by a call to the implementation of the fast-S algorithm in the <span class="pkg">rrcov</span> package of Todorov and Filzmoser (2009). For two-sample S-estimates an adaptation of the fast-S algorithm is used. 
The tuning parameters of the algorithm can be changed via <code>control</code>.
</p>
<p>The fast and robust bootstrap is used to mimic the distribution of the test statistic under the null hypothesis. 
For instance, the 5% critical value for the test is given by the 95% quantile of the recalculated statistics. 
</p>
<p>Robust simultaneous confidence intervals for linear combinations of the mean (or difference in means) are developed similarly to the classical case
(Johnson and Wichern, 1988, page 239). The value <code>CI</code> is a matrix with the confidence intervals for each element
of the mean (or difference in means), with level <code>conf</code>. It consists of two rows, the first being the lower bound and the second the upper bound.
Note that these intervals are rather conservative in the sense that the simultaneous confidence level holds for all linear combinations
and here only <code class="reqn">p</code> of these are considered (with <code class="reqn">p</code> the dimension of the data).
</p>
<p>For the two-sample Hotelling test we assume that the samples have an underlying distribution with the same covariance matrix.
This covariance matrix can be estimated in two different ways using the pooled covariance matrix or the two-sample 
estimator of He and Fung (He and Fung 2000), and argument <code>method</code> defaults to the second option. 
For more details see Roelant et al. (2008).
</p>
<p>In the two-sample version, the null hypothesis always states that the two means are equal. For the one-sample version, the default
null hypothesis is that the mean equals zero, but the hypothesized value can be changed and specified through argument <code>mu0</code>.
</p>
<p>Bootstrap samples are discarded if the fast and robust covariance estimate is not positive definite, such that the actual number 
of recalculations used can be lower than <code>R</code>. This number is returned as <code>ROK</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>FRBhot</code> which extends class <code>htest</code> and contains at least the following components:
</p>
<table role = "presentation">
<tr><td><code>statistic</code></td>
<td>
<p>the value of the robust test statistic.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>p-value of the robust one or two-sample Hotelling test, determined by the fast and robust bootstrap</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the estimated mean vector or vectors depending on whether it was a one-sample test or a two-sample test.</p>
</td></tr> 
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating what type of Hotelling test was performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data.</p>
</td></tr>
<tr><td><code>teststat.boot</code></td>
<td>
<p>the bootstrap recalculated values of the robust test statistic.</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>bootstrap simultaneous confidence intervals for each component of the center</p>
</td></tr>
<tr><td><code>conf</code></td>
<td>
<p>a copy of the <code>conf</code> argument</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p>covariance of one-sample or common covariance matrix in the case of two samples</p>
</td></tr>
<tr><td><code>w</code></td>
<td>
<p>implicit weights corresponding to the S-estimates (i.e. final weights in the RWLS procedure at the end of the fast-S algorithm)</p>
</td></tr>
<tr><td><code>outFlag</code></td>
<td>
<p>outlier flags: 1 if the robust distance of the observation exceeds the .975 quantile of (the square root of)
the chi-square distribution with degrees of freedom equal to the dimension of <code>X</code>; 0 otherwise</p>
</td></tr>
<tr><td><code>ROK</code></td>
<td>
<p>number of bootstrap samples actually used (i.e. not discarded due to non-positive definite covariance </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Ella Roelant, Stefan Van Aelst and Gert Willems </p>


<h3>References</h3>

 

<ul>
<li><p> X. He and W.K. Fung (2000) High breakdown estimation for multiple populations with applications to discriminant analysis. 
<em>Journal of Multivariate Analysis</em>, <b>72</b>, 151&ndash;162.
</p>
</li>
<li><p> R.A. Johnson, D.W. Wichern (1988) Applied Multivariate Statistical Analysis, 2nd Edition, Prentice-Hall.
</p>
</li>
<li><p> E. Roelant, S. Van Aelst and G. Willems, (2008) Fast Bootstrap for Robust Hotelling Tests, COMPSTAT 2008: 
Proceedings in Computational Statistics (P. Brito, Ed.) Heidelberg: Physika-Verlag, 709&ndash;719.
</p>
</li>
<li><p> M. Salibian-Barrera, S. Van Aelst and G. Willems (2008) Fast and robust bootstrap. 
<em>Statistical Methods and Applications</em>, <b>17</b>, 41&ndash;71. 
</p>
</li>
<li><p> V. Todorov and P. Filzmoser (2009), An Object Oriented Framework for Robust Multivariate Analysis. 
<em>Journal of Statistical Software</em>, <b>32</b>(3), 1&ndash;47.
<a href="https://doi.org/10.18637/jss.v032.i03">doi:10.18637/jss.v032.i03</a>.
</p>
</li>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

 <p><code><a href="#topic+plot.FRBhot">plot.FRBhot</a></code>,<code><a href="#topic+summary.FRBhot">summary.FRBhot</a></code>, <code><a href="#topic+FRBhotellingMM">FRBhotellingMM</a></code>, <code><a href="#topic+Scontrol">Scontrol</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## One sample robust Hotelling test
data(delivery, package="robustbase")
delivery.x &lt;- delivery[,1:2]
FRBhotellingS(delivery.x,R=199)

## One sample robust Hotelling test
data(ForgedBankNotes)
samplemean &lt;- apply(ForgedBankNotes, 2, mean)
res = FRBhotellingS(ForgedBankNotes, mu0=samplemean,R=199)
res
# Note that the test rejects the hypothesis that the true mean equals the
# sample mean; this is due to outliers in the data (i.e. the robustly estimated
# mean apparently significantly differs from the non-robust sample mean.

# Graphical display of the results:
plot(res)
# It is clear from the (scaled) simultaneous confidence limits that the rejection
# of the hypothesis is due to the differences in variables Bottom and Diagonal

## Two sample robust Hotelling test
data(hemophilia, package="rrcov")
grp &lt;-as.factor(hemophilia[,3])
x &lt;- hemophilia[which(grp==levels(grp)[1]),1:2]
y &lt;- hemophilia[which(grp==levels(grp)[2]),1:2]

#using the pooled covariance matrix to estimate the common covariance matrix
res = FRBhotellingS(x,y,method="pool")

#using the estimator of He and Fung to estimate the common covariance matrix
res = FRBhotellingS(x,y,method="HeFung",R=199)

# or using the formula interface

res = FRBhotellingS(as.matrix(hemophilia[,-3])~hemophilia[,3],method="HeFung",R=99)


# From the confidence limits it can be seen that the significant difference
# is mainly caused by the AHFactivity variable. The graphical display helps too:
plot(res)
# the red line on the histogram indicates the test statistic value in the original
# sample (it is omitted if the statistic exceeds 100)

</code></pre>

<hr>
<h2 id='FRBmultiregGS'> GS-Estimates for multivariate regression with bootstrap confidence 
intervals </h2><span id='topic+FRBmultiregGS'></span><span id='topic+FRBmultiregGS.default'></span><span id='topic+FRBmultiregGS.formula'></span>

<h3>Description</h3>

<p>Computes GS-estimates for multivariate regression together with standard errors, confidence intervals
and p-values based on the Fast and Robust Bootstrap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'formula'
FRBmultiregGS(formula, data=NULL, ...)

## Default S3 method:
FRBmultiregGS(X, Y, int = TRUE, R = 999, bdp = 0.5, conf = 0.95,
control=GScontrol(...), na.action=na.omit, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FRBmultiregGS_+3A_formula">formula</code></td>
<td>
<p> an object of class <code><a href="stats.html#topic+formula">formula</a></code>; a symbolic description of the model to be fit.</p>
</td></tr>
<tr><td><code id="FRBmultiregGS_+3A_data">data</code></td>
<td>
<p> data frame from which variables specified in formula are to be taken.</p>
</td></tr>
<tr><td><code id="FRBmultiregGS_+3A_x">X</code></td>
<td>
<p> a matrix or data frame containing the explanatory variables. </p>
</td></tr>
<tr><td><code id="FRBmultiregGS_+3A_y">Y</code></td>
<td>
<p> a matrix or data frame containing the response variables. </p>
</td></tr>
<tr><td><code id="FRBmultiregGS_+3A_int">int</code></td>
<td>
<p> logical: if <code>TRUE</code> an intercept term is added to the model (unless it is already present in <code>X</code>)</p>
</td></tr>
<tr><td><code id="FRBmultiregGS_+3A_r">R</code></td>
<td>
<p> number of bootstrap samples. Default is <code>R=999</code>. </p>
</td></tr>
<tr><td><code id="FRBmultiregGS_+3A_bdp">bdp</code></td>
<td>
<p> required breakdown point. Should have <code class="reqn">0 &lt; </code> <code>bdp</code> <code class="reqn">\le 0.5</code>, the default is 0.5. </p>
</td></tr>
<tr><td><code id="FRBmultiregGS_+3A_conf">conf</code></td>
<td>
<p> confidence level of the bootstrap confidence intervals. Default is <code>conf=0.95</code>. </p>
</td></tr>
<tr><td><code id="FRBmultiregGS_+3A_control">control</code></td>
<td>
<p>a list with control parameters for tuning the computing algorithm, see <code><a href="#topic+GScontrol">GScontrol</a></code>().</p>
</td></tr>
<tr><td><code id="FRBmultiregGS_+3A_na.action">na.action</code></td>
<td>
<p> a function which indicates what should happen when the data contain NAs. Defaults to <code><a href="stats.html#topic+na.omit">na.omit</a></code>.</p>
</td></tr>
<tr><td><code id="FRBmultiregGS_+3A_...">...</code></td>
<td>
<p>allows for specifying control parameters directly instead of via <code>control</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>  Generalized S-estimators are defined by minimizing the determinant of a robust estimator of the scatter matrix of 
the differences of the residuals (Roelant et al. 2009). Hence, this procedure is intercept free and only gives an estimate for the slope matrix. To estimate 
the intercept, we use the M-type estimator of location of Lopuhaa (1992) on the residuals with the residual scatter matrix 
estimate of the residuals as a preliminary estimate. This computation is carried out by a call to <code><a href="#topic+GSest_multireg">GSest_multireg</a></code>(), 
which uses a fast-S-type algorithm (its tuning parameters can be changed via the <code>control</code> argument).  
The result of this call is also returned as the value <code>est</code>.
</p>
<p>The Fast and Robust Bootstrap (Salibian-Barrera and Zamar 2002) is used to calculate so-called
basic bootstrap confidence intervals and bias corrected and accelerated (BCa)
confidence intervals (Davison and Hinkley 1997, p.194 and p.204 respectively). 
Apart from the intervals with the requested confidence level, the function also returns p-values for each coefficient
corresponding to the hypothesis that the actual coefficient is zero. The p-values are computed as 
1 minus the smallest level for which the confidence intervals would include zero. Both BCa and basic bootstrap p-values in this sense are given.
The bootstrap calculation is carried out by a call to <code><a href="#topic+GSboot_multireg">GSboot_multireg</a></code>(), the result 
of which is returned as the value <code>bootest</code>. Bootstrap standard errors are returned as well.
</p>
<p>Note: Bootstrap samples which contain too few distinct observations with positive weights are discarded 
(a warning is given if this happens). The number of samples actually used is returned via <code>ROK</code>. 
</p>
<p>In the <code>formula</code>-interface, a multivariate response is produced via <code>cbind</code>. For example <code>cbind(x4,x5) ~ x1+x2+x3</code>.
All arguments from the default method can also be passed to the <code>formula</code> method.
</p>
<p>The returned object inherits from class <code>mlm</code> such that the standard <code><a href="stats.html#topic+coef">coef</a></code>, <code><a href="stats.html#topic+residuals">residuals</a></code>, <code><a href="stats.html#topic+fitted">fitted</a></code> and <code><a href="stats.html#topic+predict.lm">predict</a></code> functions can be used.
</p>


<h3>Value</h3>

<p>An object of class <code>FRBmultireg</code> which extends class <code>mlm</code> and contains at least the following components:
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p> GS-estimates of the regression coefficients</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p> the residuals, that is response minus fitted values</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p> the fitted values.</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p> GS-estimate of the error covariance matrix</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p> GS-estimate of the size of the multivariate errors</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>implicit weights corresponding to the GS-estimates (i.e. final weights in the RWLS procedure for the intercept estimate)</p>
</td></tr>
<tr><td><code>outFlag</code></td>
<td>
<p>outlier flags: 1 if the robust distance of the residual exceeds the .975 quantile of (the square root of)
the chi-square distribution with degrees of freedom equal to the dimension of the responses; 0 otherwise</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p> bootstrap standard errors corresponding to the regression coefficients</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p> bootstrap covariance matrix corresponding to the regression coefficients (in vectorized form)</p>
</td></tr>
<tr><td><code>CI.bca.lower</code></td>
<td>
<p> a matrix containing the lower bound of the bias corrected and accelerated confidence intervals for the regression coefficients</p>
</td></tr>
<tr><td><code>CI.bca.upper</code></td>
<td>
<p> a matrix containing the upper bound of the bias corrected and accelerated confidence intervals for the regression coefficients</p>
</td></tr>
<tr><td><code>CI.basic.lower</code></td>
<td>
<p> a matrix containing the lower bound of basic bootstrap intervals for the regression coefficients</p>
</td></tr>
<tr><td><code>CI.basic.upper</code></td>
<td>
<p> a matrix containing the upper bound of basic bootstrap intervals for the regression coefficients</p>
</td></tr>
<tr><td><code>p.bca</code></td>
<td>
<p> a matrix containing the p-values based on the BCa confidence intervals for the regression coefficients</p>
</td></tr>
<tr><td><code>p.basic</code></td>
<td>
<p> a matrix containing the p-values based on the basic bootstrap intervals for the regression coefficients</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>GS-estimates as returned by the call to <code><a href="#topic+GSest_multireg">GSest_multireg</a></code>()</p>
</td></tr>
<tr><td><code>bootest</code></td>
<td>
<p>bootstrap results for the GS-estimates as returned by the call to <code><a href="#topic+GSboot_multireg">GSboot_multireg</a></code>()</p>
</td></tr>
<tr><td><code>conf</code></td>
<td>
<p> a copy of the <code>conf</code> argument</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> a list with following components: <code>est</code> = character string indicating that GS-estimates were used, and
<code>bdp</code> = a copy of the <code>bdp</code> argument </p>
</td></tr>
<tr><td><code>control</code></td>
<td>
<p> a copy of the <code>control</code> argument </p>
</td></tr>
<tr><td><code>X</code>, <code>Y</code></td>
<td>
<p>either copies of the respective arguments or the corresponding matrices produced from <code>formula</code></p>
</td></tr> 
<tr><td><code>ROK</code></td>
<td>
<p>number of bootstrap samples actually used (i.e. not discarded due to too few distinct observations 
with positive weight)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Ella Roelant, Stefan Van Aelst and Gert Willems </p>


<h3>References</h3>

 

<ul>
<li><p> A.C. Davison and D.V. Hinkley (1997) <em>Bootstrap Methods and their Application</em>. 
Cambridge Series in Statistical and Probabilistic Mathematics. Cambridge: Cambridge University Press.
</p>
</li>
<li><p> H.P. Lopuhaa (1992) Highly efficient estimators of multivariate location with high breakdown point. 
<em>The Annals of Statistics</em>, <b>20</b>, 398-413. 
</p>
</li>
<li><p> E. Roelant, S. Van Aelst and  C. Croux (2009) Multivariate Generalized S-estimators. 
<em>Journal of Multivariate Analysis</em>, <b>100</b>, 876&ndash;887.
</p>
</li>
<li><p> M. Salibian-Barrera, S. Van Aelst and G. Willems (2008) Fast and robust bootstrap. 
<em>Statistical Methods and Applications</em>, <b>17</b>, 41-71. 
</p>
</li>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

 <p><code><a href="#topic+summary.FRBmultireg">summary.FRBmultireg</a></code>, <code><a href="#topic+plot.FRBmultireg">plot.FRBmultireg</a></code>, <code><a href="#topic+GSboot_multireg">GSboot_multireg</a></code>, <code><a href="#topic+GSest_multireg">GSest_multireg</a></code>,  
<code><a href="#topic+FRBmultiregMM">FRBmultiregMM</a></code>,  <code><a href="#topic+FRBmultiregS">FRBmultiregS</a></code>, <code><a href="#topic+GScontrol">GScontrol</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(schooldata)
school.x &lt;- data.matrix(schooldata[,1:5])
school.y &lt;- data.matrix(schooldata[,6:8])

#computes 25% breakdown point GS-estimate and 80% confidence intervals 
#based on 99 bootstrap samples:
GSres &lt;- FRBmultiregGS(school.x, school.y, R=99, bdp = 0.25, conf = 0.8,nsamp=50)
#or using the formula interface

GSres &lt;- FRBmultiregGS(cbind(reading,mathematics,selfesteem)~., data=schooldata, 
          bdp = 0.25, conf = 0.8,R=99)


#the print method just displays the coefficient estimates
GSres

#the summary function additionally displays the bootstrap standard errors and p-values 
#("BCA" method by default)
summary(GSres)

summary(GSres, confmethod="basic")

#ask explicitely for the coefficient matrix:
GSres$coefficients
# or equivalently,
coef(GSres)
#For the error covariance matrix:
GSres$Sigma
                                                              
#plot some bootstrap histograms for the coefficient estimates 
#(with "BCA" intervals by default) 
plot(GSres, expl=c("education", "occupation"), resp=c("selfesteem","reading"))

#plot bootstrap histograms for all coefficient estimates
plot(GSres)
#possibly the plot-function has made a selection of coefficients to plot here, 
#since 'all' may have been too many to fit on one page, see help(plot.FRBmultireg); 
#this is platform-dependent
</code></pre>

<hr>
<h2 id='FRBmultiregMM'>MM-Estimates for Multivariate Regression with Bootstrap Inference</h2><span id='topic+FRBmultiregMM'></span><span id='topic+FRBmultiregMM.default'></span><span id='topic+FRBmultiregMM.formula'></span><span id='topic+print.FRBmultireg'></span><span id='topic+predict.FRBmultireg'></span><span id='topic+vcov.FRBmultireg'></span>

<h3>Description</h3>

<p>Computes MM-estimates for multivariate regression together with standard errors, confidence intervals
and p-values based on the Fast and Robust Bootstrap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'formula'
FRBmultiregMM(formula, data=NULL, ...)

## Default S3 method:
FRBmultiregMM(X, Y, int = TRUE, R = 999, conf = 0.95, 
                control=MMcontrol(...), na.action=na.omit, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FRBmultiregMM_+3A_formula">formula</code></td>
<td>
<p> an object of class <code><a href="stats.html#topic+formula">formula</a></code>; a symbolic description of the model to be fit.</p>
</td></tr>
<tr><td><code id="FRBmultiregMM_+3A_data">data</code></td>
<td>
<p> data frame from which variables specified in formula are to be taken.</p>
</td></tr>
<tr><td><code id="FRBmultiregMM_+3A_x">X</code></td>
<td>
<p> a matrix or data frame containing the explanatory variables. </p>
</td></tr>
<tr><td><code id="FRBmultiregMM_+3A_y">Y</code></td>
<td>
<p> a matrix or data frame containing the response variables. </p>
</td></tr>
<tr><td><code id="FRBmultiregMM_+3A_int">int</code></td>
<td>
<p> logical: if <code>TRUE</code> an intercept term is added to the model (unless it is already present in <code>X</code>)</p>
</td></tr>
<tr><td><code id="FRBmultiregMM_+3A_r">R</code></td>
<td>
<p> number of bootstrap samples. Default is <code>R=999</code>. </p>
</td></tr>
<tr><td><code id="FRBmultiregMM_+3A_conf">conf</code></td>
<td>
<p> level of the bootstrap confidence intervals. Default is <code>conf=0.95</code> </p>
</td></tr>
<tr><td><code id="FRBmultiregMM_+3A_control">control</code></td>
<td>
<p>a list with control parameters for tuning the MM-estimate and its computing algorithm, 
see <code><a href="#topic+MMcontrol">MMcontrol</a></code>().</p>
</td></tr>
<tr><td><code id="FRBmultiregMM_+3A_na.action">na.action</code></td>
<td>
<p> a function which indicates what should happen when the data contain NAs. Defaults to <code><a href="stats.html#topic+na.omit">na.omit</a></code>.</p>
</td></tr>
<tr><td><code id="FRBmultiregMM_+3A_...">...</code></td>
<td>
<p>allows for specifying control parameters directly instead of via <code>control</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multivariate MM-estimates combine high breakdown point and high Gaussian efficiency. They are defined by first computing an S-estimate of regression, 
then fixing the scale component of the error covariance estimate, and finally re-estimating the regression coefficients 
and the shape part of the error covariance by a more efficient M-estimate (see Tatsuoka and Tyler (2000) for MM-estimates 
in the special case of location/scatter estimation, and Van Aelst and Willems (2005) for S-estimates of multivariate regression). 
</p>
<p>Tukey's biweight is used for the loss functions. By default, the first loss function (in the S-estimate) is tuned in order to obtain 50% breakdown point. 
The default tuning of the second loss function (M-estimate) ensures 95% efficiency at the normal model for the coefficient estimates. 
The desired efficiency can be changed through argument <code>control</code>. 
</p>
<p>The computation is carried out by a call to <code><a href="#topic+MMest_multireg">MMest_multireg</a></code>(), which first performs the fast-S algorithm 
(see <code><a href="#topic+Sest_multireg">Sest_multireg</a></code>) and does the M-part by reweighted least squares (RWLS) iteration. 
See <code><a href="#topic+MMcontrol">MMcontrol</a></code> for some adjustable tuning parameters regarding the algorithm.
The result of this call is also returned as the value <code>est</code>.
</p>
<p>The Fast and Robust Bootstrap (Salibian-Barrera and Zamar 2002) is used to calculate so-called
basic bootstrap confidence intervals and bias corrected and accelerated (BCa)
confidence intervals (Davison and Hinkley 1997, p.194 and p.204 respectively). 
Apart from the intervals with the requested confidence level, the function also returns p-values for each coefficient
corresponding to the hypothesis that the actual coefficient is zero. The p-values are computed as 
1 minus the smallest level for which the confidence intervals would include zero. Both BCa and basic bootstrap p-values in this sense are given.
The bootstrap calculation is carried out by a call to <code><a href="#topic+MMboot_multireg">MMboot_multireg</a></code>(), the result 
of which is returned as the value <code>bootest</code>. Bootstrap standard errors are returned as well.
</p>
<p>Note: Bootstrap samples which contain too few distinct observations with positive weights are discarded 
(a warning is given if this happens). The number of samples actually used is returned via <code>ROK</code>. 
</p>
<p>In the <code>formula</code>-interface, a multivariate response is produced via <code>cbind</code>. For example <code>cbind(x4,x5) ~ x1+x2+x3</code>.
All arguments from the default method can also be passed to the <code>formula</code> method except for <code>int</code> (passing <code>int</code> explicitely
will produce an error; the inclusion of an intercept term is determined by <code>formula</code>).
</p>
<p>The returned object inherits from class <code>mlm</code> such that the standard <code><a href="stats.html#topic+coef">coef</a></code>, <code><a href="stats.html#topic+residuals">residuals</a></code>, <code><a href="stats.html#topic+fitted">fitted</a></code> and <code><a href="stats.html#topic+predict.lm">predict</a></code> functions can be used.
</p>


<h3>Value</h3>

<p>An object of class <code>FRBmultireg</code> which extends class <code>mlm</code> and contains at least the following components:
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p> MM-estimates of the regression coefficients</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p> the residuals, that is response minus fitted values</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p> the fitted values.</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p> MM-estimate of the error covariance matrix</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p> MM-estimate of the size of the multivariate errors</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>implicit weights corresponding to the MM-estimates (i.e. final weights in the RWLS procedure)</p>
</td></tr>
<tr><td><code>outFlag</code></td>
<td>
<p>outlier flags: 1 if the robust distance of the residual exceeds the .975 quantile of (the square root of)
the chi-square distribution with degrees of freedom equal to the dimension of the responses; 0 otherwise</p>
</td></tr>  
<tr><td><code>SE</code></td>
<td>
<p> bootstrap standard errors corresponding the regression coefficients</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p> bootstrap covariance matrix corresponding to the regression coefficients (in vectorized form)</p>
</td></tr>
<tr><td><code>CI.bca.lower</code></td>
<td>
<p> a matrix containing the lower bounds of the bias corrected and accelerated confidence intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>CI.bca.upper</code></td>
<td>
<p> a matrix containing the upper bounds of the bias corrected and accelerated confidence intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>CI.basic.lower</code></td>
<td>
<p> a matrix containing the lower bounds of basic bootstrap intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>CI.basic.upper</code></td>
<td>
<p> a matrix containing the upper bounds of basic bootstrap intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>p.bca</code></td>
<td>
<p> a matrix containing the p-values based on the BCa confidence intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>p.basic</code></td>
<td>
<p> a matrix containing the p-values based on the basic bootstrap intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>MM-estimates as returned by the call to <code><a href="#topic+MMest_multireg">MMest_multireg</a></code>()</p>
</td></tr>
<tr><td><code>bootest</code></td>
<td>
<p>bootstrap results for the MM-estimates as returned by the call to <code><a href="#topic+MMboot_multireg">MMboot_multireg</a></code>()</p>
</td></tr>
<tr><td><code>conf</code></td>
<td>
<p> a copy of the <code>conf</code> argument</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> a list with following components: <code>est</code> = character string indicating that MM-estimates were used, 
<code>bdp</code> = a copy of <code>bdp</code> from the <code>control</code> argument, and <code>eff</code> = a copy of <code>eff</code> from the <code>control</code> argument</p>
</td></tr>
<tr><td><code>control</code></td>
<td>
<p> a copy of the <code>control</code> argument </p>
</td></tr>
<tr><td><code>X</code>, <code>Y</code></td>
<td>
<p>either copies of the respective arguments or the corresponding matrices produced from <code>formula</code></p>
</td></tr> 
<tr><td><code>ROK</code></td>
<td>
<p>number of bootstrap samples actually used (i.e. not discarded due to too few distinct observations 
with positive weight)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Gert Willems, stefan Van Aelst and Ella Roelant </p>


<h3>References</h3>

 

<ul>
<li><p> A.C. Davison and D.V. Hinkley (1997) <em>Bootstrap Methods and their Application</em>. 
Cambridge Series in Statistical and Probabilistic Mathematics. Cambridge: Cambridge University Press.
</p>
</li>
<li><p> M. Salibian-Barrera, S. Van Aelst and G. Willems (2008) Fast and robust bootstrap. 
<em>Statistical Methods and Applications</em>, <b>17</b>, 41-71. 
</p>
</li>
<li><p> M. Salibian-Barrera, R.H. Zamar (2002) Bootstrapping robust estimates of regression. 
<em>The Annals of Statistics</em>, <b>30</b>, 556-582.
</p>
</li>
<li><p> K.S. Tatsuoka and D.E. Tyler (2000) The uniqueness of S and M-functionals under non-elliptical distributions.
<em>The Annals of Statistics</em>, <b>28</b>, 1219-1243. 
</p>
</li>
<li><p>  S. Van Aelst and G. Willems (2005) Multivariate regression S-estimators for robust estimation and inference. 
<em>Statistica Sinica</em>, <b>15</b>, 981-1001.
</p>
</li>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

 <p><code><a href="#topic+summary.FRBmultireg">summary.FRBmultireg</a></code>, <code><a href="#topic+plot.FRBmultireg">plot.FRBmultireg</a></code>, <code><a href="#topic+MMboot_multireg">MMboot_multireg</a></code>, 
<code><a href="#topic+MMest_multireg">MMest_multireg</a></code>,  <code><a href="#topic+FRBmultiregS">FRBmultiregS</a></code>,  <code><a href="#topic+FRBmultiregGS">FRBmultiregGS</a></code>, <code><a href="#topic+MMcontrol">MMcontrol</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(schooldata)
school.x &lt;- data.matrix(schooldata[,1:5])
school.y &lt;- data.matrix(schooldata[,6:8])

#computes MM-estimate and 95% confidence intervals 
#based on 999 bootstrap samples:
MMres &lt;- FRBmultiregMM(school.x, school.y, R=999, conf = 0.95)
#or, equivalently using the formula interface

MMres &lt;- FRBmultiregMM(cbind(reading,mathematics,selfesteem)~., data=schooldata, 
             R=999, conf = 0.95)


#the print method displays the coefficient estimates 
MMres

#the summary function additionally displays the bootstrap standard errors and p-values
#("BCA" method by default)
summary(MMres)

summary(MMres, confmethod="basic")

#ask explicitely for the coefficient matrix:
MMres$coefficients
# or equivalently,
coef(MMres)
#For the error covariance matrix:
MMres$Sigma
                                                              
#plot some bootstrap histograms for the coefficient estimates 
#(with "BCA" intervals by default) 
plot(MMres, expl=c("education", "occupation"), resp=c("selfesteem","reading"))

#plot bootstrap histograms for all coefficient estimates
plot(MMres)
#probably the plot-function has made a selection of coefficients to plot here, 
#since 'all' was too many to  fit on one page, see help(plot.FRBmultireg); 
#this is platform-dependent
</code></pre>

<hr>
<h2 id='FRBmultiregS'>S-Estimates for Multivariate Regression with Bootstrap Inference</h2><span id='topic+FRBmultiregS'></span><span id='topic+FRBmultiregS.default'></span><span id='topic+FRBmultiregS.formula'></span>

<h3>Description</h3>

<p>Computes S-estimates for multivariate regression together with standard errors, confidence intervals
and p-values based on the Fast and Robust Bootstrap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'formula'
FRBmultiregS(formula, data=NULL, ...)

## Default S3 method:
FRBmultiregS(X, Y, int = TRUE, R = 999, bdp = 0.5, conf = 0.95, 
                control=Scontrol(...), na.action=na.omit, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FRBmultiregS_+3A_formula">formula</code></td>
<td>
<p> an object of class <code><a href="stats.html#topic+formula">formula</a></code>; a symbolic description of the model to be fit.</p>
</td></tr>
<tr><td><code id="FRBmultiregS_+3A_data">data</code></td>
<td>
<p> data frame from which variables specified in formula are to be taken.</p>
</td></tr>
<tr><td><code id="FRBmultiregS_+3A_x">X</code></td>
<td>
<p> a matrix or data frame containing the explanatory variables. </p>
</td></tr>
<tr><td><code id="FRBmultiregS_+3A_y">Y</code></td>
<td>
<p> a matrix or data frame containing the response variables. </p>
</td></tr>
<tr><td><code id="FRBmultiregS_+3A_int">int</code></td>
<td>
<p> logical: if <code>TRUE</code> an intercept term is added to the model (unless it is already present in <code>X</code>)</p>
</td></tr>
<tr><td><code id="FRBmultiregS_+3A_r">R</code></td>
<td>
<p> number of bootstrap samples. Default is <code>R=999</code>. </p>
</td></tr>
<tr><td><code id="FRBmultiregS_+3A_bdp">bdp</code></td>
<td>
<p> required breakdown point for the S-estimates. Should have <code class="reqn">0 &lt; </code> <code>bdp</code> <code class="reqn">\le 0.5</code>, the default is 0.5 </p>
</td></tr>
<tr><td><code id="FRBmultiregS_+3A_conf">conf</code></td>
<td>
<p> level of the bootstrap confidence intervals. Default is <code>conf=0.95</code> </p>
</td></tr>
<tr><td><code id="FRBmultiregS_+3A_control">control</code></td>
<td>
<p>a list with control parameters for tuning the computing algorithm, see <code><a href="#topic+Scontrol">Scontrol</a></code>().</p>
</td></tr>
<tr><td><code id="FRBmultiregS_+3A_na.action">na.action</code></td>
<td>
<p> a function which indicates what should happen when the data contain NAs. Defaults to <code><a href="stats.html#topic+na.omit">na.omit</a></code>.</p>
</td></tr>
<tr><td><code id="FRBmultiregS_+3A_...">...</code></td>
<td>
<p>allows for specifying control parameters directly instead of via <code>control</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multivariate S-estimates were introduced by Davies (1987) and can be highly robust while enjoying a reasonable Gaussian efficiency.
Their use in the multivariate regression setting was discussed in Van Aelst and Willems (2005).
The loss function used here is Tukey's biweight. It is tuned in order to achieve the required breakdown point <code>bdp</code> 
(any value between 0 and 0.5). 
</p>
<p>The computation is carried out by a call to <code><a href="#topic+Sest_multireg">Sest_multireg</a></code>(), which performs the fast-S algorithm 
(Salibian-Barrera and Yohai 2006), see <code><a href="#topic+Scontrol">Scontrol</a></code> for its tuning parameters. 
The result of this call is also returned as the value <code>est</code>.
</p>
<p>The Fast and Robust Bootstrap (Salibian-Barrera and Zamar 2002) is used to calculate so-called
basic bootstrap confidence intervals and bias corrected and accelerated (BCa)
confidence intervals (Davison and Hinkley 1997, p.194 and p.204 respectively). 
Apart from the intervals with the requested confidence level, the function also returns p-values for each coefficient
corresponding to the hypothesis that the actual coefficient is zero. The p-values are computed as 
1 minus the smallest level for which the confidence intervals would include zero. Both BCa and basic bootstrap p-values in this sense are given.
The bootstrap calculation is carried out by a call to <code><a href="#topic+Sboot_multireg">Sboot_multireg</a></code>(), the result 
of which is returned as the value <code>bootest</code>. Bootstrap standard errors are returned as well.
</p>
<p>Note: Bootstrap samples which contain too few distinct observations with positive weights are discarded 
(a warning is given if this happens). The number of samples actually used is returned via <code>ROK</code>. 
</p>
<p>In the <code>formula</code>-interface, a multivariate response is produced via <code>cbind</code>. For example <code>cbind(x4,x5) ~ x1+x2+x3</code>.
All arguments from the default method can also be passed to the <code>formula</code> method except for <code>int</code> (passing <code>int</code> explicitely
will produce an error; the inclusion of an intercept term is determined by <code>formula</code>).
</p>
<p>The returned object inherits from class <code>mlm</code> such that the standard <code><a href="stats.html#topic+coef">coef</a></code>, <code><a href="stats.html#topic+residuals">residuals</a></code>, <code><a href="stats.html#topic+fitted">fitted</a></code> and <code><a href="stats.html#topic+predict.lm">predict</a></code> functions can be used.
</p>


<h3>Value</h3>

<p>An object of class <code>FRBmultireg</code> which extends class <code>mlm</code> and contains at least the following components:
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p> MM-estimates of the regression coefficients</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p> the residuals, that is response minus fitted values</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p> the fitted values.</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p> S-estimate of the error covariance matrix</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p> MM-estimate of the size of the multivariate errors</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p> implicit weights corresponding to the S-estimates (i.e. final weights in the RWLS procedure at the end of the fast-S algorithm)</p>
</td></tr>
<tr><td><code>outFlag</code></td>
<td>
<p>outlier flags: 1 if the robust distance of the residual exceeds the .975 quantile of (the square root of)
the chi-square distribution with degrees of freedom equal to the dimension of the responses; 0 otherwise</p>
</td></tr>  
<tr><td><code>SE</code></td>
<td>
<p> bootstrap standard errors corresponding to the regression coefficients.</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p> bootstrap covariance matrix corresponding to the regression coefficients (in vectorized form)</p>
</td></tr>
<tr><td><code>CI.bca.lower</code></td>
<td>
<p> a matrix containing the lower bounds of the bias corrected and accelerated confidence intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>CI.bca.upper</code></td>
<td>
<p> a matrix containing the upper bounds of the bias corrected and accelerated confidence intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>CI.basic.lower</code></td>
<td>
<p> a matrix containing the lower bounds of basic bootstrap intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>CI.basic.upper</code></td>
<td>
<p> a matrix containing the upper bounds of basic bootstrap intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>p.bca</code></td>
<td>
<p> a matrix containing the p-values based on the BCa confidence intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>p.basic</code></td>
<td>
<p> a matrix containing the p-values based on the basic bootstrap intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>S-estimates as returned by the call to <code><a href="#topic+Sest_multireg">Sest_multireg</a></code>()</p>
</td></tr>
<tr><td><code>bootest</code></td>
<td>
<p>bootstrap results for the S-estimates as returned by the call to <code><a href="#topic+Sboot_multireg">Sboot_multireg</a></code>()</p>
</td></tr>
<tr><td><code>conf</code></td>
<td>
<p> a copy of the <code>conf</code> argument</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> a list with following components: <code>est</code> = character string indicating that S-estimates were used, and
<code>bdp</code> = a copy of the <code>bdp</code> argument </p>
</td></tr>
<tr><td><code>control</code></td>
<td>
<p> a copy of the <code>control</code> argument </p>
</td></tr>
<tr><td><code>X</code>, <code>Y</code></td>
<td>
<p>either copies of the respective arguments or the corresponding matrices produced from <code>formula</code></p>
</td></tr> 
<tr><td><code>ROK</code></td>
<td>
<p>number of bootstrap samples actually used (i.e. not discarded due to too few distinct observations 
with positive weight)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Gert Willems, Stefan Van Aelst and Ella Roelant </p>


<h3>References</h3>

 
<ul>
<li><p> P.L. Davies (1987) Asymptotic behavior of S-estimates of multivariate location parameters and dispersion matrices. 
<em>The Annals of Statistics</em>, <b>15</b>, 1269-1292.
</p>
</li>
<li><p> A.C. Davison and D.V. Hinkley (1997) <em>Bootstrap Methods and their Application</em>. 
Cambridge Series in Statistical and Probabilistic Mathematics. Cambridge: Cambridge University Press.
</p>
</li>
<li><p> M. Salibian-Barrera, S. Van Aelst and G. Willems (2008) Fast and robust bootstrap. 
<em>Statistical Methods and Applications</em>, <b>17</b>, 41-71. 
</p>
</li>
<li><p> M. Salibian-Barrera and V. Yohai (2006) A fast algorithm for S-regression estimates. 
<em>Journal of Computational and Graphical Statistics</em>, <b>15</b>, 414-427. 
</p>
</li>
<li><p> M. Salibian-Barrera, R.H. Zamar (2002) Bootstrapping robust estimates of regression. 
<em>The Annals of Statistics</em>, <b>30</b>, 556-582.
</p>
</li>
<li><p>  S. Van Aelst and G. Willems (2005) Multivariate regression S-estimators for robust estimation and inference. 
<em>Statistica Sinica</em>, <b>15</b>, 981-1001.
</p>
</li>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

 <p><code><a href="#topic+summary.FRBmultireg">summary.FRBmultireg</a></code>, <code><a href="#topic+plot.FRBmultireg">plot.FRBmultireg</a></code>, <code><a href="#topic+Sboot_multireg">Sboot_multireg</a></code>, 
<code><a href="#topic+Sest_multireg">Sest_multireg</a></code>,  <code><a href="#topic+FRBmultiregMM">FRBmultiregMM</a></code>,  <code><a href="#topic+FRBmultiregGS">FRBmultiregGS</a></code>, <code><a href="#topic+Scontrol">Scontrol</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(schooldata)
school.x &lt;- data.matrix(schooldata[,1:5])
school.y &lt;- data.matrix(schooldata[,6:8])

##  computes 25% breakdown point S-estimate and 99% confidence intervals 
##  based on 999 bootstrap samples:
Sres &lt;- FRBmultiregS(school.x, school.y, R=999, bdp = 0.25, conf = 0.99)

##  or, equivalently using the formula interface

    Sres &lt;- FRBmultiregS(cbind(reading,mathematics,selfesteem)~., data=schooldata, 
            R=999, bdp = 0.25, conf = 0.99)

          
##  the print method displays the coefficient estimates 
Sres

##  the summary function additionally displays the bootstrap standard errors and p-values
##  ("BCA" method by default)
summary(Sres)

summary(Sres, confmethod="basic")
                                                              
##  ask explicitely for the coefficient matrix:
Sres$coefficients

## or equivalently,
coef(Sres)

##  For the error covariance matrix:
Sres$Sigma
                                                              
##  plot some bootstrap histograms for the coefficient estimates 
##  (with "BCA" intervals by default) 
plot(Sres, expl=c("education", "occupation"), resp=c("selfesteem","reading"))

##  plot bootstrap histograms for all coefficient estimates
plot(Sres)

##  probably the plot-function has made a selection of coefficients to plot here, 
##  since 'all' was too many to  fit on one page, see help(plot.FRBmultireg); 
##  this is platform-dependent
</code></pre>

<hr>
<h2 id='FRBpcaMM'> PCA based on Multivariate MM-estimators with Fast and Robust Bootstrap </h2><span id='topic+FRBpcaMM'></span><span id='topic+FRBpcaMM.default'></span><span id='topic+FRBpcaMM.formula'></span><span id='topic+print.FRBpca'></span>

<h3>Description</h3>

<p>Performs principal components analysis based on the robust MM-estimate of the shape matrix. Additionally uses the Fast and Robust Bootstrap
method to compute inference measures such as standard errors and confidence intervals. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'formula'
FRBpcaMM(formula, data=NULL, ...)


## Default S3 method:
FRBpcaMM(Y, R = 999, conf = 0.95, control=MMcontrol(...),
na.action=na.omit, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FRBpcaMM_+3A_formula">formula</code></td>
<td>
<p> an object of class <code><a href="stats.html#topic+formula">formula</a></code>; a symbolic description of the model to be fit.</p>
</td></tr>
<tr><td><code id="FRBpcaMM_+3A_data">data</code></td>
<td>
<p> data frame from which variables specified in formula are to be taken.</p>
</td></tr>
<tr><td><code id="FRBpcaMM_+3A_y">Y</code></td>
<td>
<p> matrix or data frame. </p>
</td></tr>
<tr><td><code id="FRBpcaMM_+3A_r">R</code></td>
<td>
<p> number of bootstrap samples. Default is <code>R=999</code>. </p>
</td></tr>
<tr><td><code id="FRBpcaMM_+3A_conf">conf</code></td>
<td>
<p> level of the bootstrap confidence intervals. Default is <code>conf=0.95</code>. </p>
</td></tr>
<tr><td><code id="FRBpcaMM_+3A_control">control</code></td>
<td>
<p>a list with control parameters for tuning the MM-estimate and its computing algorithm, 
see <code><a href="#topic+MMcontrol">MMcontrol</a></code>().</p>
</td></tr>
<tr><td><code id="FRBpcaMM_+3A_na.action">na.action</code></td>
<td>
<p> a function which indicates what should happen when the data contain NAs. Defaults to <code><a href="stats.html#topic+na.omit">na.omit</a></code>.</p>
</td></tr>  
<tr><td><code id="FRBpcaMM_+3A_...">...</code></td>
<td>
<p>allows for specifying control parameters directly instead of via <code>control</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multivariate MM-estimates are defined by first computing an S-estimate of location and covariance, then fixing its scale component and 
re-estimating the location and the shape by a more efficient M-estimate, see Tatsuoka and Tyler (2000). Tukey's biweight is used for 
the loss functions. By default, the first loss function (in the S-estimate) is tuned in order to obtain 50% breakdown point. 
The default tuning of the second loss function (M-estimate) ensures 95% efficiency for the shape matrix estimate at the normal model.
The desired efficiency can be changed through argument <code>control</code>. (However, control parameter 
<code>shapeEff</code> will always be considered as <code>TRUE</code> by this function, whichever value is specified.) The MM-estimates are computed by a call to the implementation in the <span class="pkg">rrcov</span> package of Todorov and Filzmoser (2009). 
The result of this call is also returned as the value <code>est</code>.
</p>
<p>PCA is performed by computing the eigenvalues (<code>eigval</code>) and eigenvectors (<code>eigvec</code>) of the MM-estimate of shape, which is a rescaled version of the
MM-estimate of covariance (rescaled to have determinant equal to 1). With <code>pvar</code> the function also provides the estimates for the percentage of 
variance explained by the first <code class="reqn">k</code> principal components, which are simply the cumulative proportions of the eigenvalues sum. 
Here, <code class="reqn">k</code> ranges from 1 to <code class="reqn">p-1</code> (with <code class="reqn">p</code> the number of variables in <code>Y</code>). 
The eigenvectors are always given in the order of descending eigenvalues.
</p>
<p>The Fast and Robust Bootstrap (Salibian-Barrera and Zamar 2002) is used to calculate standard errors, and also so-called
basic bootstrap confidence intervals and bias corrected and accelerated (BCa) confidence intervals (Davison and Hinkley 1997, p.194 and p.204 respectively) corresponding
to the estimates <code>eigval</code>, <code>eigvec</code> and <code>pvar</code>. 
The bootstrap is also used to estimate the average angles between true and estimated eigenvectors, returned as <code>avgangle</code>.
See Salibian-Barrera, Van Aelst and Willems (2006).
The fast and robust bootstrap computations for the MM-estimates are performed by <code><a href="#topic+MMboot_loccov">MMboot_loccov</a></code>() and its raw result can be found in <code>bootest</code>.
The actual bootstrap recalculations for the PCA-related quantities can be found in <code>eigval.boot</code>, <code>eigvec.boot</code> and <code>pvar.boot</code>, where each column 
represents a bootstrap sample. For <code>eigvec.boot</code>, the eigenvectors are stacked on top of each other and the same goes for 
<code>eigvec.CI.bca</code> and <code>eigvec.CI.basic</code> which hold the confidence limits. 
</p>
<p>The two columns in the confidence limits always respectively represent the lower and upper limits.
For the percentage of variance the function also provides one-sided confidence intervals ([-infty upper]), which can be
used to test the hypothesis that the true percentage at least equals a certain value.  
</p>
<p>Bootstrap samples are discarded if the fast and robust shape estimate is not positive definite, such that the actual number 
of recalculations used can be lower than <code>R</code>. This actual number equals <code>R</code> - <code>failedsamples</code>.
However, if more than <code>0.75R</code> of the bootstrap shape estimates is non-positive definite, all bootstrap samples will be
used anyway, and the negative eigenvalues are simply set to zero (which may impact the confidence limits and standard errors
for the smallest eigenvalues in <code>eigval</code> and <code>pvar</code>).
</p>


<h3>Value</h3>

<p>An object of class <code>FRBpca</code>, which contains the following components:
</p>
<table role = "presentation">
<tr><td><code>shape</code></td>
<td>
<p>(p x p) MM-estimate of the shape matrix of <code>Y</code></p>
</td></tr>
<tr><td><code>eigval</code></td>
<td>
<p>(p x 1) eigenvalues of MM shape </p>
</td></tr>
<tr><td><code>eigvec</code></td>
<td>
<p>(p x p) eigenvectors of MM-shape </p>
</td></tr>
<tr><td><code>pvar</code></td>
<td>
<p>(p-1 x 1) percentages of variance for MM eigenvalues </p>
</td></tr>
<tr><td><code>eigval.boot</code></td>
<td>
<p>(p x R) eigenvalues of MM shape </p>
</td></tr>
<tr><td><code>eigvec.boot</code></td>
<td>
<p>(p*p x R) eigenvectors of MM-shape (vectorized) </p>
</td></tr>
<tr><td><code>pvar.boot</code></td>
<td>
<p>(p-1 x R) percentages of variance for MM eigenvalues </p>
</td></tr>
<tr><td><code>eigval.SE</code></td>
<td>
<p>(p x 1) bootstrap standard error for MM eigenvalues </p>
</td></tr>
<tr><td><code>eigvec.SE</code></td>
<td>
<p>(p x p) bootstrap standard error for MM eigenvectors </p>
</td></tr>
<tr><td><code>pvar.SE</code></td>
<td>
<p>(p-1 x 1) bootstrap standard error for percentage of variance for MM-eigenvalues </p>
</td></tr>
<tr><td><code>angles</code></td>
<td>
<p>(p x R) angles between bootstrap eigenvectors and original MM eigenvectors (in radians; in [0 pi/2])</p>
</td></tr>
<tr><td><code>avgangle</code></td>
<td>
<p>(p x 1) average angles between bootstrap eigenvectors and original MM eigenvectors (in radians; in [0 pi/2])</p>
</td></tr>
<tr><td><code>eigval.CI.bca</code></td>
<td>
<p>(p x 2) BCa intervals for MM eigenvalues </p>
</td></tr>
<tr><td><code>eigvec.CI.bca</code></td>
<td>
<p>(p*p x 2) BCa intervals for MM eigenvectors (vectorized)</p>
</td></tr>
<tr><td><code>pvar.CI.bca</code></td>
<td>
<p>(p-1 x 2) BCa intervals for percentage of variance for MM-eigenvalues</p>
</td></tr>
<tr><td><code>pvar.CIone.bca</code></td>
<td>
<p>(p-1 x 1) one-sided BCa intervals for percentage of variance for MM-eigenvalues ([-infty upper]) </p>
</td></tr> 
<tr><td><code>eigval.CI.basic</code></td>
<td>
<p>(p x 2) basic bootstrap intervals for MM eigenvalues </p>
</td></tr>
<tr><td><code>eigvec.CI.basic</code></td>
<td>
<p>(p*p x 2) basic bootstrap intervals for MM eigenvectors (vectorized)</p>
</td></tr>
<tr><td><code>pvar.CI.basic</code></td>
<td>
<p>(p-1 x 2) basic bootstrap intervals for percentage of variance for MM-eigenvalues </p>
</td></tr>
<tr><td><code>pvar.CIone.basic</code></td>
<td>
<p>(p-1 x 1) one-sided basic bootstrap intervals for percentage of variance for MM-eigenvalues ([-infty upper]) </p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>list containing the MM-estimates of location and scatter</p>
</td></tr>
<tr><td><code>bootest</code></td>
<td>
<p>(list) result of <code><a href="#topic+MMboot_loccov">MMboot_loccov</a></code>() </p>
</td></tr>
<tr><td><code>failedsamples</code></td>
<td>
<p>number of bootstrap samples with non-positive definiteness of shape </p>
</td></tr>
<tr><td><code>conf</code></td>
<td>
<p> a copy of the <code>conf</code> argument</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> a character string giving the robust PCA method that was used</p>
</td></tr>
<tr><td><code>w</code></td>
<td>
<p>implicit weights corresponding to the MM-estimates (i.e. final weights in the RWLS procedure)</p>
</td></tr>
<tr><td><code>outFlag</code></td>
<td>
<p>outlier flags: 1 if the robust distance of the observation exceeds the .975 quantile of (the square root of)
the chi-square distribution with degrees of freedom equal to the dimension of <code>Y</code>; 0 otherwise</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>copy of the data argument as a matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Gert Willems, Stefan Van Aelst and Ella Roelant </p>


<h3>References</h3>

 

<ul>
<li><p> A.C. Davison and D.V. Hinkley (1997) <em>Bootstrap Methods and their Application</em>. 
Cambridge Series in Statistical and Probabilistic Mathematics. Cambridge: Cambridge University Press.
</p>
</li>
<li><p> M. Salibian-Barrera, S. Van Aelst and G. Willems (2006) PCA based on multivariate MM-estimators with fast and robust bootstrap. 
<em>Journal of the American Statistical Association</em>, <b>101</b>, 1198-1211.
</p>
</li>
<li><p> M. Salibian-Barrera, S. Van Aelst and G. Willems (2008) Fast and robust bootstrap. 
<em>Statistical Methods and Applications</em>, <b>17</b>, 41-71.
</p>
</li>
<li><p> M. Salibian-Barrera, R.H. Zamar (2002) Bootstrapping robust estimates of regression. 
<em>The Annals of Statistics</em>, <b>30</b>, 556-582.
</p>
</li>
<li><p> K.S. Tatsuoka and D.E. Tyler (2000) The uniqueness of S and M-functionals under non-elliptical distributions.
<em>The Annals of Statistics</em>, <b>28</b>, 1219-1243
</p>
</li>
<li><p> V. Todorov and P. Filzmoser (2009), An Object Oriented Framework for Robust Multivariate Analysis. 
<em>Journal of Statistical Software</em>, <b>32</b>(3), 1&ndash;47.
<a href="https://doi.org/10.18637/jss.v032.i03">doi:10.18637/jss.v032.i03</a>.
</p>
</li>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+plot.FRBpca">plot.FRBpca</a></code>, <code><a href="#topic+summary.FRBpca">summary.FRBpca</a></code>, <code><a href="#topic+print.FRBpca">print.FRBpca</a></code>, <code><a href="#topic+FRBpcaS">FRBpcaS</a></code>, 
<code><a href="#topic+MMboot_loccov">MMboot_loccov</a></code>, <code><a href="#topic+MMcontrol">MMcontrol</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ForgedBankNotes)

MMpcares &lt;- FRBpcaMM(ForgedBankNotes, R=999, conf=0.95)
# or using the formula interface

MMpcares &lt;- FRBpcaMM(~.,data=ForgedBankNotes, R=999, conf=0.95)


# the simple print method shows the standard deviations with confidence limits:
MMpcares

# the summary functions shows a lot more (see help(summary.FRBpca)):
summary(MMpcares)

# ask for the eigenvalues:
MMpcares$eigval

# or, in more pretty format, with confidence limits:
summary(MMpcares)$eigvals

# note that the standard deviations of the print-output can also be asked for by:
sqrt( summary(MMpcares)$eigvals )

# the eigenvectors and their standard errors:
MMpcares$eigvec   # or prettier: summary(MMpcares)$eigvecs
MMpcares$eigvec.SE

 
    # take a look at the bootstrap distribution of the first eigenvalue
    hist(MMpcares$eigval.boot[1,])
    
    # that bootstrap distribution is used to compute confidence limits as depicted 
    # by the screeplot function:
    plotFRBvars(MMpcares, cumul=0)
    
    # all plots for the FRB-PCA result:
    plot(MMpcares)

</code></pre>

<hr>
<h2 id='FRBpcaS'> PCA based on Multivariate S-estimators with Fast and Robust Bootstrap </h2><span id='topic+FRBpcaS'></span><span id='topic+FRBpcaS.default'></span><span id='topic+FRBpcaS.formula'></span>

<h3>Description</h3>

<p>Performs principal components analysis based on the robust S-estimate of the shape matrix. Additionally uses the Fast and Robust Bootstrap
method to compute inference measures such as standard errors and confidence intervals. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'formula'
FRBpcaS(formula, data=NULL, ...)

## Default S3 method:
FRBpcaS(Y, R = 999, bdp = 0.5, conf = 0.95, control=Scontrol(...),
na.action=na.omit, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FRBpcaS_+3A_formula">formula</code></td>
<td>
<p> an object of class <code><a href="stats.html#topic+formula">formula</a></code>; a symbolic description of the model to be fit.</p>
</td></tr>
<tr><td><code id="FRBpcaS_+3A_data">data</code></td>
<td>
<p> data frame from which variables specified in formula are to be taken.</p>
</td></tr>
<tr><td><code id="FRBpcaS_+3A_y">Y</code></td>
<td>
<p> matrix or data frame. </p>
</td></tr>
<tr><td><code id="FRBpcaS_+3A_r">R</code></td>
<td>
<p> number of bootstrap samples. Default is <code>R=999</code>. </p>
</td></tr>
<tr><td><code id="FRBpcaS_+3A_bdp">bdp</code></td>
<td>
<p> required breakdown point for the S-estimates. Should have <code class="reqn">0 &lt; </code> <code>bdp</code> <code class="reqn">\le 0.5</code>, the default is 0.5. </p>
</td></tr>
<tr><td><code id="FRBpcaS_+3A_conf">conf</code></td>
<td>
<p>level of the bootstrap confidence intervals. Default is <code>conf=0.95</code>. </p>
</td></tr>
<tr><td><code id="FRBpcaS_+3A_control">control</code></td>
<td>
<p>a list with control parameters for tuning the computing algorithm, see <code><a href="#topic+Scontrol">Scontrol</a></code>().</p>
</td></tr>
<tr><td><code id="FRBpcaS_+3A_na.action">na.action</code></td>
<td>
<p> a function which indicates what should happen when the data contain NAs. Defaults to <code><a href="stats.html#topic+na.omit">na.omit</a></code>.</p>
</td></tr>
<tr><td><code id="FRBpcaS_+3A_...">...</code></td>
<td>
<p>allows for specifying control parameters directly instead of via <code>control</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

                                     
<p>Multivariate S-estimates were introduced by Davies (1987) and can be highly robust while enjoying a reasonable Gaussian efficiency.
The loss function used here is Tukey's biweight. It will be tuned in order to achieve the required breakdown point <code>bdp</code> 
(any value between 0 and 0.5). 
The MM-estimates are computed by a call to the implementation of the fast-S algorithm (Salibian-Barrera and Yohai 2006) in the <span class="pkg">rrcov</span> package of Todorov and Filzmoser (2009). <code><a href="#topic+Scontrol">Scontrol</a></code> provides some adjustable tuning parameters regarding the algorithm. The result of this call is also returned as the value <code>est</code>.
</p>
<p>PCA is performed by computing the eigenvalues (<code>eigval</code>) and eigenvectors (<code>eigvec</code>) of the S-estimate of shape, which is a rescaled version of the
S-estimate of covariance (rescaled to have determinant equal to 1). With <code>pvar</code> the function also provides the estimates for the percentage of 
variance explained by the first <code class="reqn">k</code> principal components, which are simply the cumulative proportions of the eigenvalues sum. 
Here, <code class="reqn">k</code> ranges from 1 to <code class="reqn">p-1</code> (with <code class="reqn">p</code> the number of variables in <code>Y</code>). 
The eigenvectors are always given in the order of descending eigenvalues.
</p>
<p>The Fast and Robust Bootstrap (Salibian-Barrera and Zamar 2002) is used to calculate standard errors, and also so-called
basic bootstrap confidence intervals and bias corrected and accelerated (BCa) confidence intervals (Davison and Hinkley 1997, p.194 and p.204 respectively) corresponding
to the estimates <code>eigval</code>, <code>eigvec</code> and <code>pvar</code>. 
The bootstrap is also used to estimate the average angles between true and estimated eigenvectors, returned as <code>avgangle</code>.
See Salibian-Barrera, Van Aelst and Willems (2006).
The fast and robust bootstrap computations for the S-estimates are performed by <code><a href="#topic+Sboot_loccov">Sboot_loccov</a></code>() and its raw result can be found in <code>bootest</code>.
The actual bootstrap values of the PCA-related quantities can be found in <code>eigval.boot</code>, <code>eigvec.boot</code> and <code>pvar.boot</code>, where each column 
represents a bootstrap sample. For <code>eigvec.boot</code>, the eigenvectors are stacked on top of each other and the same goes for 
<code>eigvec.CI.bca</code> and <code>eigvec.CI.basic</code> which hold the confidence limits. 
</p>
<p>The two columns in the confidence limits always respectively represent the lower and upper limits.
For the percentage of variance the function also provides one-sided confidence intervals ([-infty upper]), which can be
used to test the hypothesis that the true percentage at least equals a certain value.  
</p>
<p>Bootstrap samples are discarded if the fast and robust covariance estimate is not positive definite, such that the actual number 
of recalculations used can be lower than <code>R</code>. This actual number equals <code>R</code> - <code>failedsamples</code>. However, if 
more than <code>0.75R</code> of the bootstrap shape estimates is non-positive definite, the failed bootstrap samples are recovered 
by applying the <code>make.positive.definite</code> function (from package <code>corpcor</code>). If this also fails, the corresponding bootstrap sample
is discarded after all, but such situation should be rare.
This recovery may have an impact on the confidence limits and standard errors of especially the smallest eigenvalues in 
<code>eigval</code> and <code>pvar</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>FRBpca</code>, which contains the following components:
</p>
<table role = "presentation">
<tr><td><code>shape</code></td>
<td>
<p>(p x p) S-estimate of the shape matrix of <code>Y</code></p>
</td></tr>
<tr><td><code>eigval</code></td>
<td>
<p>(p x 1) eigenvalues of S shape </p>
</td></tr>
<tr><td><code>eigvec</code></td>
<td>
<p>(p x p) eigenvectors of S-shape </p>
</td></tr>
<tr><td><code>pvar</code></td>
<td>
<p>(p-1 x 1) percentages of variance for S eigenvalues </p>
</td></tr>
<tr><td><code>eigval.boot</code></td>
<td>
<p>(p x R) eigenvalues of S shape </p>
</td></tr>
<tr><td><code>eigvec.boot</code></td>
<td>
<p>(p*p x R) eigenvectors of S-shape (vectorized) </p>
</td></tr>
<tr><td><code>pvar.boot</code></td>
<td>
<p>(p-1 x R) percentages of variance for S eigenvalues </p>
</td></tr>
<tr><td><code>eigval.SE</code></td>
<td>
<p>(p x 1) bootstrap standard error for S eigenvalues </p>
</td></tr>
<tr><td><code>eigvec.SE</code></td>
<td>
<p>(p x p) bootstrap standard error for S eigenvectors </p>
</td></tr>
<tr><td><code>pvar.SE</code></td>
<td>
<p>(p-1 x 1) bootstrap standard error for percentage of variance for S eigenvalues </p>
</td></tr>
<tr><td><code>angles</code></td>
<td>
<p>(p x R) angles between bootstrap eigenvectors and original S eigenvectors (in radians; in [0 pi/2])</p>
</td></tr>
<tr><td><code>avgangle</code></td>
<td>
<p>(p x 1) average angles between bootstrap eigenvectors and original S eigenvectors (in radians; in [0 pi/2])</p>
</td></tr>
<tr><td><code>eigval.CI.bca</code></td>
<td>
<p>(p x 2) BCa intervals for S eigenvalues </p>
</td></tr>
<tr><td><code>eigvec.CI.bca</code></td>
<td>
<p>(p*p x 2) BCa intervals for S eigenvectors (vectorized)</p>
</td></tr>
<tr><td><code>pvar.CI.bca</code></td>
<td>
<p>(p-1 x 2) BCa intervals for percentage of variance for S-eigenvalues</p>
</td></tr>
<tr><td><code>pvar.CIone.bca</code></td>
<td>
<p>(p-1 x 1) one-sided BCa intervals for percentage of variance for S-eigenvalues ([-infty upper]) </p>
</td></tr> 
<tr><td><code>eigval.CI.basic</code></td>
<td>
<p>(p x 2) basic bootstrap intervals for S eigenvalues </p>
</td></tr>
<tr><td><code>eigvec.CI.basic</code></td>
<td>
<p>(p*p x 2) basic bootstrap intervals for S eigenvectors (vectorized)</p>
</td></tr>
<tr><td><code>pvar.CI.basic</code></td>
<td>
<p>(p-1 x 2) basic bootstrap intervals for percentage of variance for S-eigenvalues </p>
</td></tr>
<tr><td><code>pvar.CIone.basic</code></td>
<td>
<p>(p-1 x 1) one-sided basic bootstrap intervals for percentage of variance for S-eigenvalues ([-infty upper]) </p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>list containing the S-estimates of location and scatter </p>
</td></tr>
<tr><td><code>bootest</code></td>
<td>
<p>(list) result of <code><a href="#topic+Sboot_loccov">Sboot_loccov</a></code>() </p>
</td></tr>
<tr><td><code>failedsamples</code></td>
<td>
<p>number of bootstrap samples with non-positive definiteness of shape </p>
</td></tr>
<tr><td><code>conf</code></td>
<td>
<p> a copy of the <code>conf</code> argument</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> a character string giving the robust PCA method that was used</p>
</td></tr>
<tr><td><code>w</code></td>
<td>
<p>implicit weights corresponding to the S-estimates (i.e. final weights in the RWLS procedure at the end of the fast-S algorithm)</p>
</td></tr>
<tr><td><code>outFlag</code></td>
<td>
<p>outlier flags: 1 if the robust distance of the observation exceeds the .975 quantile of (the square root of)
the chi-square distribution with degrees of freedom equal to the dimension of <code>Y</code>; 0 otherwise</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>copy of the data argument as a matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Gert Willems, Stefan Van Aelst and Ella Roelant </p>


<h3>References</h3>


<ul>
<li><p> P.L. Davies (1987) Asymptotic behavior of S-estimates of multivariate location parameters and dispersion matrices. 
<em>The Annals of Statistics</em>, <b>15</b>, 1269-1292.
</p>
</li>
<li><p> A.C. Davison and D.V. Hinkley (1997) <em>Bootstrap Methods and their Application</em>. 
Cambridge Series in Statistical and Probabilistic Mathematics. Cambridge: Cambridge University Press.
</p>
</li>
<li><p> M. Salibian-Barrera, S. Van Aelst and G. Willems (2006) PCA based on multivariate MM-estimators with fast and robust bootstrap. 
<em>Journal of the American Statistical Association</em>, <b>101</b>, 1198-1211.
</p>
</li>
<li><p> M. Salibian-Barrera, S. Van Aelst and G. Willems (2008) Fast and robust bootstrap. 
<em>Statistical Methods and Applications</em>, <b>17</b>, 41-71. 
</p>
</li>
<li><p> M. Salibian-Barrera, R.H. Zamar (2002) Bootstrapping robust estimates of regression. 
<em>The Annals of Statistics</em>, <b>30</b>, 556-582. 
</p>
</li>
<li><p> V. Todorov and P. Filzmoser (2009), An Object Oriented Framework for Robust Multivariate Analysis. 
<em>Journal of Statistical Software</em>, <b>32</b>(3), 1&ndash;47.
<a href="https://doi.org/10.18637/jss.v032.i03">doi:10.18637/jss.v032.i03</a>.
</p>
</li>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

 <p><code><a href="#topic+plot.FRBpca">plot.FRBpca</a></code>, <code><a href="#topic+summary.FRBpca">summary.FRBpca</a></code>, <code><a href="#topic+print.FRBpca">print.FRBpca</a></code>, <code><a href="#topic+FRBpcaMM">FRBpcaMM</a></code>, 
<code><a href="#topic+Sboot_loccov">Sboot_loccov</a></code>, <code><a href="#topic+Scontrol">Scontrol</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'> 
data(ForgedBankNotes)

Spcares &lt;- FRBpcaS(ForgedBankNotes, R=999, bdp=0.25, conf=0.95)

## or using the formula interface

    Spcares &lt;- FRBpcaMM(~.,data=ForgedBankNotes, R=999, conf=0.95)


## the simple print method shows the standard deviations with confidence limits:
Spcares

## the summary functions shows a lot more (see help(summary.FRBpca)):
summary(Spcares)

## ask for the eigenvalues:
Spcares$eigval

## or, in more pretty format, with confidence limits:
summary(Spcares)$eigvals

## note that the standard deviations of the print-output can also be asked for by:
sqrt(summary(Spcares)$eigvals)

## the eigenvectors and their standard errors:
Spcares$eigvec   # or prettier: summary(MMpcares)$eigvecs
Spcares$eigvec.SE
 

    ## take a look at the bootstrap distribution of the first eigenvalue
    hist(Spcares$eigval.boot[1,])
    
    ## that bootstrap distribution is used to compute confidence limits as depicted 
    ## by the screeplot function:
    plotFRBvars(Spcares, cumul=0)
    
    ## all plots for the FRB-PCA result:
    plot(Spcares)

</code></pre>

<hr>
<h2 id='GSboot_multireg'> Fast and Robust Bootstrap for GS-Estimates  </h2><span id='topic+GSboot_multireg'></span>

<h3>Description</h3>

<p>Calculates bootstrapped GS-estimates and bootstrap confidence intervals using the Fast and Robust Bootstrap
method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GSboot_multireg(X, Y, R = 999, conf=0.95, ests = GSest_multireg(X, Y))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GSboot_multireg_+3A_x">X</code></td>
<td>
<p> a matrix or data frame containing the explanatory variables (possibly including intercept). </p>
</td></tr>
<tr><td><code id="GSboot_multireg_+3A_y">Y</code></td>
<td>
<p> a matrix or data frame containing the response variables. </p>
</td></tr>
<tr><td><code id="GSboot_multireg_+3A_r">R</code></td>
<td>
<p> number of bootstrap samples. Default is <code>R=999</code>. </p>
</td></tr>
<tr><td><code id="GSboot_multireg_+3A_conf">conf</code></td>
<td>
<p> confidence level of the bootstrap confidence intervals. Default is <code>conf=0.95</code>. </p>
</td></tr>
<tr><td><code id="GSboot_multireg_+3A_ests">ests</code></td>
<td>
<p> GS-estimates as returned by <code><a href="#topic+GSest_multireg">GSest_multireg</a></code>(). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Called by <code><a href="#topic+FRBmultiregGS">FRBmultiregGS</a></code> and typically not to
be used on its own. If no original GS-estimates are provided the function calls <code><a href="#topic+GSest_multireg">GSest_multireg</a></code> with its default settings. 
</p>
<p>The fast and robust bootstrap was first introduced by Salibian-Barrera and Zamar (2002) for univariate regression MM-estimators and developed for GS-estimates by Roelant et al. (2009). 
</p>
<p>The value <code>centered</code> gives a matrix with <code>R</code> columns and <code class="reqn">p*q+q*q</code> rows (<code class="reqn">p</code> is the number of explanatory variables 
and <code class="reqn">q</code> is the number of response variables), containing the recalculated GS-estimates. Each column represents a different bootstrap sample.
The first <code class="reqn">p*q</code> rows are the recalculated coefficient estimates and the next <code class="reqn">q*q</code> rows are the covariance estimates 
(the estimates are vectorized, i.e. columns stacked on top of each other). These bootstrap estimates are centered by the original
estimates, which are also returned through <code>vecest</code> in vectorized form.
</p>
<p>The output list further contains bootstrap standard errors, as well as so-called basic bootstrap confidence intervals and bias corrected and accelerated 
confidence intervals (Davison and Hinkley, 1997, p.194 and p.204 respectively). 
Also in the output are p-values defined as 1 minus the smallest confidence level for which the confidence intervals would include the 
(hypothesised) value of zero. Both BCa and basic bootstrap p-values are given. These are only useful for the
regression coefficient estimates (not really for the covariance estimates).
</p>
<p>Bootstrap samples which contain too few distinct observations with positive weights are discarded 
(a warning is given if this happens). The number of samples actually used is returned via <code>ROK</code>. 
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>centered</code></td>
<td>
<p>a matrix of all fast and robust bootstrap recalculations
where the recalculations are centered by the original estimates (see Details) </p>
</td></tr>
<tr><td><code>vecest</code></td>
<td>
<p>a vector containing the orginal estimates stacked on top of each other</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>bootstrap standard errors for the estimates in <code>vecest</code></p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p> bootstrap covariance matrix for the estimates in <code>vecest</code></p>
</td></tr> 
<tr><td><code>CI.bca</code></td>
<td>
<p>a matrix containing bias corrected and accelerated confidence intervals, corresponding to the 
estimates in <code>vecest</code> (first column are lower limits, second column are upper limits)</p>
</td></tr>
<tr><td><code>CI.basic</code></td>
<td>
<p> a matrix containing basic bootstrap intervals, corresponding to the 
estimates in <code>vecest</code> (first column are lower limits, second column are upper limits)</p>
</td></tr>
<tr><td><code>p.bca</code></td>
<td>
<p>a vector containing p-values based on the bias corrected and accelerated confidence intervals (corresponding to the 
estimates in <code>vecest</code>)</p>
</td></tr>
<tr><td><code>p.basic</code></td>
<td>
<p>a vector containing p-values based on the basic bootstrap intervals (corresponding to the 
estimates in <code>vecest</code>)</p>
</td></tr>
<tr><td><code>ROK</code></td>
<td>
<p>number of bootstrap samples actually used (i.e. not discarded due to too few distinct observations 
with positive weight)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Ella Roelant, Stefan Van Aelst and  Gert Willems</p>


<h3>References</h3>

 
<ul>
<li><p> A.C. Davison, D.V. Hinkley (1997) Bootstrap methods and their application. Cambridge University Press.  
</p>
</li>
<li><p> E. Roelant, S. Van Aelst and  C. Croux (2009) Multivariate Generalized S-estimators. 
<em>Journal of Multivariate Analysis</em>, <b>100</b>, 876&ndash;887.
</p>
</li>
<li><p> M. Salibian-Barrera, S. Van Aelst and G. Willems (2008) Fast and robust bootstrap. 
<em>Statistical Methods and Applications</em>, <b>17</b>, 41&ndash;71. 
</p>
</li>
<li><p> M. Salibian-Barrera, R.H. Zamar (2002) Bootstrapping robust estimates of regression. 
<em>The Annals of Statistics</em>, <b>30</b>, 556&ndash;582.
</p>
</li>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

  <p><code><a href="#topic+FRBmultiregGS">FRBmultiregGS</a></code>, <code><a href="#topic+GSest_multireg">GSest_multireg</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(schooldata)
school.x1 &lt;- data.matrix(schooldata[,1:2])
school.y &lt;- data.matrix(schooldata[,6:8])

## computes 10 bootstrap recalculations starting from the GS-estimator
## obtained from GSest_multireg

    bootres &lt;- GSboot_multireg(school.x1,school.y,R=5)

</code></pre>

<hr>
<h2 id='GSest_multireg'>GS Estimates for Multivariate Regression</h2><span id='topic+GSest_multireg'></span><span id='topic+GSest_multireg.default'></span><span id='topic+GSest_multireg.formula'></span>

<h3>Description</h3>

<p>Computes GS-Estimates of multivariate regression based on Tukey's biweight 
function. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'formula'
GSest_multireg(formula, data=NULL, ...)

## Default S3 method:
GSest_multireg(X, Y, int = TRUE, bdp = 0.5, control=GScontrol(...),
na.action=na.omit, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GSest_multireg_+3A_formula">formula</code></td>
<td>
<p> an object of class <code><a href="stats.html#topic+formula">formula</a></code>; a symbolic description of the model to be fit.</p>
</td></tr>
<tr><td><code id="GSest_multireg_+3A_data">data</code></td>
<td>
<p> data frame from which variables specified in formula are to be taken.</p>
</td></tr>
<tr><td><code id="GSest_multireg_+3A_x">X</code></td>
<td>
<p> a matrix or data frame containing the explanatory variables. </p>
</td></tr>
<tr><td><code id="GSest_multireg_+3A_y">Y</code></td>
<td>
<p> a matrix or data frame containing the response variables. </p>
</td></tr>
<tr><td><code id="GSest_multireg_+3A_int">int</code></td>
<td>
<p> logical: if <code>TRUE</code> an intercept term is added to the model (unless it is already present in <code>X</code>)</p>
</td></tr>
<tr><td><code id="GSest_multireg_+3A_bdp">bdp</code></td>
<td>
<p> required breakdown point. Should have <code class="reqn">0 &lt; </code> <code>bdp</code> <code class="reqn">\le 0.5</code>, the default is 0.5. </p>
</td></tr>
<tr><td><code id="GSest_multireg_+3A_control">control</code></td>
<td>
<p>a list with control parameters for tuning the computing algorithm, see <code><a href="#topic+GScontrol">GScontrol</a></code>().</p>
</td></tr>
<tr><td><code id="GSest_multireg_+3A_na.action">na.action</code></td>
<td>
<p> a function which indicates what should happen when the data contain NAs. Defaults to <code><a href="stats.html#topic+na.omit">na.omit</a></code>.</p>
</td></tr>
<tr><td><code id="GSest_multireg_+3A_...">...</code></td>
<td>
<p>allows for specifying control parameters directly instead of via <code>control</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generalized S-estimators are defined by minimizing the determinant of a robust estimator of the scatter matrix of 
the differences of the residuals. Hence, this procedure is intercept free and only gives an estimate for the slope matrix. To estimate 
the intercept, we use the M-type estimator of location of Lopuhaa (1992) on the residuals with the residual scatter matrix 
estimate of the residuals as a preliminary estimate.  We use a fast algorithm similar to the one proposed by Salibian-Barrera
and Yohai (2006) for the regression case. See <code><a href="#topic+GScontrol">GScontrol</a></code> for the adjustable tuning parameters of this algorithm.
</p>
<p>The returned object inherits from class <code>mlm</code> such that the standard <code><a href="stats.html#topic+coef">coef</a></code>, <code><a href="stats.html#topic+residuals">residuals</a></code>, <code><a href="stats.html#topic+fitted">fitted</a></code> and <code><a href="stats.html#topic+predict.lm">predict</a></code> functions can be used.
</p>


<h3>Value</h3>

<p>An object of class <code>FRBmultireg</code> which extends class <code>mlm</code> and contains at least the following components:
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p> GS-estimates of the regression coefficients</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p> the residuals, that is response minus fitted values</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p> the fitted values.</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p> GS-estimate of the error covariance matrix</p>
</td></tr>
<tr><td><code>Gamma</code></td>
<td>
<p>GS-estimate of the error shape matrix</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p> GS-estimate of the size of the multivariate errors</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>implicit weights corresponding to the GS-estimates (i.e. final weights in the RWLS procedure for the intercept estimate)</p>
</td></tr>
<tr><td><code>outFlag</code></td>
<td>
<p>outlier flags: 1 if the robust distance of the residual exceeds the .975 quantile of (the square root of)
the chi-square distribution with degrees of freedom equal to the dimension of the responses; 0 otherwise</p>
</td></tr>
<tr><td><code>b</code>, <code>c</code></td>
<td>
<p>tuning parameters used in Tukey biweight loss function, as determined by <code>bdp</code></p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> a list with following components: <code>est</code> = character string indicating that GS-estimates were used, and
<code>bdp</code> = a copy of the <code>bdp</code> argument </p>
</td></tr>
<tr><td><code>control</code></td>
<td>
<p> a copy of the <code>control</code> argument </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Ella Roelant, Gert Willems and Stefan Van Aelst</p>


<h3>References</h3>

 
<ul>
<li><p> H.P. Lopuhaa (1992) Highly efficient estimators of multivariate location with high breakdown point. 
<em>The Annals of Statistics</em>, <b>20</b>, 398-413. 
</p>
</li>
<li><p> E. Roelant, S. Van Aelst and  C. Croux (2009) Multivariate Generalized S-estimators. 
<em>Journal of Multivariate Analysis</em>, <b>100</b>, 876&ndash;887.
</p>
</li>
<li><p> M. Salibian-Barrera and V. Yohai (2006) A fast algorithm for S-regression estimates. 
<em>Journal of Computational and Graphical Statistics</em>, <b>15</b>, 414-427. 
</p>
</li>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+FRBmultiregGS">FRBmultiregGS</a></code>, <code><a href="#topic+GSboot_multireg">GSboot_multireg</a></code>,  <code><a href="#topic+Sest_multireg">Sest_multireg</a></code>, <code><a href="#topic+GScontrol">GScontrol</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
    data(schooldata)
    school.x &lt;- data.matrix(schooldata[,1:5])
    school.y &lt;- data.matrix(schooldata[,6:8])
    GSest &lt;- GSest_multireg(school.x,school.y,nsamp=50)
    
    ## or using the formula interface
    GSests &lt;- GSest_multireg(cbind(reading,mathematics,selfesteem)~., data=schooldata)

</code></pre>

<hr>
<h2 id='MMboot_loccov'>Fast and Robust Bootstrap for MM-estimates of Location and Covariance </h2><span id='topic+MMboot_loccov'></span>

<h3>Description</h3>

<p>Calculates bootstrapped MM-estimates of multivariate location and scatter using the Fast and Robust Bootstrap
method. </p>


<h3>Usage</h3>

<pre><code class='language-R'>MMboot_loccov(Y, R = 999, ests = MMest_loccov(Y))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MMboot_loccov_+3A_y">Y</code></td>
<td>
<p> matrix or data frame. </p>
</td></tr>
<tr><td><code id="MMboot_loccov_+3A_r">R</code></td>
<td>
<p> number of bootstrap samples. Default is <code>R=999</code>. </p>
</td></tr>
<tr><td><code id="MMboot_loccov_+3A_ests">ests</code></td>
<td>
<p> original MM-estimates as returned by <code><a href="#topic+MMest_loccov">MMest_loccov</a></code>(). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called by <code><a href="#topic+FRBpcaMM">FRBpcaMM</a></code> and <code><a href="#topic+FRBhotellingMM">FRBhotellingMM</a></code>, it is typically not to be used on its own. 
It requires the MM-estimates of multivariate location and scatter/shape
(the result of <code><a href="#topic+MMest_loccov">MMest_loccov</a></code> applied on <code>Y</code>), supplied through the argument <code>ests</code>. 
If <code>ests</code> is not provided, <code><a href="#topic+MMest_loccov">MMest_loccov</a></code> calls the implementation of the multivariate MM-estimates in package <span class="pkg">rrcov</span> of Todorov and Filzmoser (2009) with default arguments. 
</p>
<p>For multivariate data the fast and robust bootstrap was developed by Salibian-Barrera, Van Aelst and Willems (2006).
</p>
<p>The value <code>centered</code> gives a matrix with <code>R</code> columns and <code class="reqn">2*(p+p*p)</code> rows (<code class="reqn">p</code> is the number of variables in <code>Y</code>), 
containing the recalculated estimates of the MM-location, MM-shape, S-covariance and S-location. 
Each column represents a different bootstrap sample. 
The first <code class="reqn">p</code> rows are the MM-location estimates, the next <code class="reqn">p*p</code> rows are the MM-shape estimates (vectorized). Then the next 
<code class="reqn">p*p</code> rows are the S-covariance estimates (vectorized) and the final <code class="reqn">p</code> rows are the S-location estimates. 
The estimates are centered by the original estimates, which are also returned through <code>MMest</code> in vectorized form.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>centered</code></td>
<td>
<p>recalculated MM- and S-estimates of location and scatter (centered by original estimates), see Details</p>
</td></tr>
<tr><td><code>MMest</code></td>
<td>
<p>original MM- and S-estimates of location and scatter, see Details</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Gert Willems, Ella Roelant and Stefan Van Aelst</p>


<h3>References</h3>

 
<ul>
<li><p> M. Salibian-Barrera, S. Van Aelst and G. Willems (2006) PCA based on multivariate MM-estimators with fast and robust bootstrap. 
<em>Journal of the American Statistical Association</em>, <b>101</b>, 1198&ndash;1211.
</p>
</li>
<li><p> M. Salibian-Barrera, S. Van Aelst and G. Willems (2008) Fast and robust bootstrap. 
<em>Statistical Methods and Applications</em>, <b>17</b>, 41&ndash;71. 
</p>
</li>
<li><p> V. Todorov and P. Filzmoser (2009), An Object Oriented Framework for Robust Multivariate Analysis. 
<em>Journal of Statistical Software</em>, <b>32</b>(3), 1&ndash;47.
<a href="https://doi.org/10.18637/jss.v032.i03">doi:10.18637/jss.v032.i03</a>.
</p>
</li>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

 <p><code><a href="#topic+FRBpcaMM">FRBpcaMM</a></code>, <code><a href="#topic+FRBhotellingMM">FRBhotellingMM</a></code>,  <code><a href="#topic+Sboot_loccov">Sboot_loccov</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
Y &lt;- matrix(rnorm(50*5), ncol=5)
MMests &lt;- MMest_loccov(Y) 
bootresult &lt;- MMboot_loccov(Y, R = 1000, ests = MMests)

</code></pre>

<hr>
<h2 id='MMboot_multireg'> Fast and Robust Bootstrap for MM-Estimates of Multivariate Regression </h2><span id='topic+MMboot_multireg'></span>

<h3>Description</h3>

<p>Calculates bootstrapped MM-estimates of multivariate regression and corresponding bootstrap confidence intervals using the Fast and Robust Bootstrap
method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MMboot_multireg(X, Y, R = 999, conf=0.95, ests = MMest_multireg(X, Y))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MMboot_multireg_+3A_x">X</code></td>
<td>
<p> a matrix or data frame containing the explanatory variables (possibly including intercept). </p>
</td></tr>
<tr><td><code id="MMboot_multireg_+3A_y">Y</code></td>
<td>
<p> a matrix or data frame containing the response variables. </p>
</td></tr>
<tr><td><code id="MMboot_multireg_+3A_r">R</code></td>
<td>
<p> number of bootstrap samples. Default is <code>R=999</code>. </p>
</td></tr>
<tr><td><code id="MMboot_multireg_+3A_conf">conf</code></td>
<td>
<p> level of the bootstrap confidence intervals. Default is <code>conf=0.95</code>. </p>
</td></tr>
<tr><td><code id="MMboot_multireg_+3A_ests">ests</code></td>
<td>
<p> MM-estimates as returned by <code><a href="#topic+MMest_multireg">MMest_multireg</a></code>(). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Called by <code><a href="#topic+FRBmultiregMM">FRBmultiregMM</a></code> and typically not to
be used on its own. It requires the result of <code><a href="#topic+MMest_multireg">MMest_multireg</a></code> applied on <code>X</code> and <code>Y</code>, 
supplied through the argument <code>ests</code>. If <code>ests</code> is not provided, <code><a href="#topic+MMest_multireg">MMest_multireg</a></code> 
will be called with default arguments. 
</p>
<p>The fast and robust bootstrap was first developed by Salibian-Barrera and Zamar (2002) for univariate regression MM-estimators and extended to multivariate regression by Van Aelst and Willems (2005). 
</p>
<p>The value <code>centered</code> gives a matrix with <code>R</code> columns and <code class="reqn">2*(p*q+q*q)</code> rows (<code class="reqn">p</code> is the number of explanatory variables 
and <code class="reqn">q</code> the number of response variables), 
containing the recalculated MM-estimates and initial S-estimates. 
Each column represents a different bootstrap sample. 
</p>
<p>The first <code class="reqn">p*q</code> rows are the MM-coefficient estimates, the next <code class="reqn">q*q</code> rows represent the MM-estimate of the error shape matrix 
(having determinant 1). 
Then the next <code class="reqn">q*q</code> rows are the S-estimate of error covariance and the final <code class="reqn">p*q</code> rows are the S-estimates of the regression
coefficients (all estimates are vectorized, i.e. columns stacked on top of each other). 
These estimates are centered by the original estimates, which are also returned through <code>vecest</code> in vectorized form.
</p>
<p>The output list further contains bootstrap standard errors, as well as so-called basic bootstrap confidence intervals and bias corrected and accelerated 
confidence intervals (Davison and Hinkley, 1997, p.194 and p.204 respectively). 
Also in the output are p-values defined as 1 minus the smallest confidence level for which the confidence intervals would include the 
(hypothesised) value of zero. Both BCa and basic bootstrap p-values are given. These are only useful for the
regression coefficient estimates (not really for the covariance estimates).
</p>
<p>Bootstrap samples which contain less than <code class="reqn">p</code> distinct observations with positive weights are discarded 
(a warning is given if this happens). The number of samples actually used is returned via <code>ROK</code>. 
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>centered</code></td>
<td>
<p>a matrix of all fast/robust bootstrap recalculations
where the recalculations are centered by original estimates (see Details) </p>
</td></tr>
<tr><td><code>vecest</code></td>
<td>
<p>a vector containing the original estimates (see Details)</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>bootstrap standard errors for the estimates in <code>vecest</code></p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p> bootstrap covariance matrix for the estimates in <code>vecest</code></p>
</td></tr> 
<tr><td><code>CI.bca</code></td>
<td>
<p>a matrix containing 95% bias corrected and accelerated confidence intervals corresponding to the 
estimates in <code>vecest</code> (first column are lower limits, second column are upper limits)</p>
</td></tr>
<tr><td><code>CI.basic</code></td>
<td>
<p> a matrix containing 95% basic bootstrap intervals corresponding to the 
estimates in <code>vecest</code> (first column are lower limits, second column are upper limits)</p>
</td></tr>
<tr><td><code>p.bca</code></td>
<td>
<p>a vector containing p-values based on the bias corrected and accelerated confidence intervals (corresponding to the 
estimates in <code>vecest</code>)</p>
</td></tr>
<tr><td><code>p.basic</code></td>
<td>
<p>a vector containing p-values based on the basic bootstrap intervals (corresponding to the 
estimates in <code>vecest</code>)</p>
</td></tr>
<tr><td><code>ROK</code></td>
<td>
<p>number of bootstrap samples actually used (i.e. not discarded due to too few distinct observations 
with positive weight)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Gert Willems, Ella Roelant and Stefan Van Aelst</p>


<h3>References</h3>


<ul>
<li><p> A.C. Davison, D.V. Hinkley (1997) Bootstrap methods and their application. Cambridge University Press.  
</p>
</li>
<li><p> M. Salibian-Barrera, S. Van Aelst and G. Willems (2008) Fast and robust bootstrap. 
<em>Statistical Methods and Applications</em>, <b>17</b>, 41&ndash;71. 
</p>
</li>
<li><p> M. Salibian-Barrera, R.H. Zamar (2002) Bootstrapping robust estimates of regression. 
<em>The Annals of Statistics</em>, <b>30</b>, 556&ndash;582.
</p>
</li>
<li><p>  S. Van Aelst and G. Willems (2005) Multivariate regression S-estimators for robust estimation and inference. 
<em>Statistica Sinica</em>, <b>15</b>, 981&ndash;1001.
</p>
</li>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

  <p><code><a href="#topic+FRBmultiregMM">FRBmultiregMM</a></code>, <code><a href="#topic+MMest_multireg">MMest_multireg</a></code>, <code><a href="#topic+Sboot_multireg">Sboot_multireg</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
    data(schooldata)
    school.x &lt;- data.matrix(schooldata[,1:5])
    school.y &lt;- data.matrix(schooldata[,6:8])
    
    ## computes 1000 bootstrap recalculations starting from the MM-estimator
    ## obtained from MMest_multireg()
    bootres &lt;- MMboot_multireg(school.x,school.y,R=1000)

</code></pre>

<hr>
<h2 id='MMboot_twosample'> Fast and Robust Bootstrap for Two-Sample MM-estimates of Location and Covariance</h2><span id='topic+MMboot_twosample'></span>

<h3>Description</h3>

<p>Calculates bootstrapped two sample MM-estimates using the Fast and Robust Bootstrap
method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MMboot_twosample(X, groups, R = 999, ests = MMest_twosample(X, groups))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MMboot_twosample_+3A_x">X</code></td>
<td>
<p> matrix of data frame. </p>
</td></tr>
<tr><td><code id="MMboot_twosample_+3A_groups">groups</code></td>
<td>
<p> vector of 1's and 2's, indicating group numbers. </p>
</td></tr>
<tr><td><code id="MMboot_twosample_+3A_r">R</code></td>
<td>
<p> number of bootstrap samples. Default is <code>R=999</code>. </p>
</td></tr>
<tr><td><code id="MMboot_twosample_+3A_ests">ests</code></td>
<td>
<p> original MM-estimates as returned by <code><a href="#topic+MMest_twosample">MMest_twosample</a></code>(). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called by <code><a href="#topic+FRBhotellingMM">FRBhotellingMM</a></code>, it is typically not to be used on its own. 
It requires the result of <code><a href="#topic+MMest_twosample">MMest_twosample</a></code> applied on <code>X</code>, supplied through the argument <code>ests</code>. 
If <code>ests</code> is not provided, <code><a href="#topic+MMest_twosample">MMest_twosample</a></code> will be called with default arguments. 
</p>
<p>The fast and robust bootstrap was first developed by Salibian-Barrera and Zamar (2002) for univariate regression MM-estimators and extended to the two sample setting by Roelant et al. (2008).
</p>
<p>The value <code>centered</code> gives a matrix with <code>R</code> columns and <code class="reqn">2*(2*p+p*p)</code> rows (<code class="reqn">p</code> is the number of variables in <code>X</code>), 
containing the recalculated estimates of the MM-locations, MM-shape, S-covariance and S-locations. 
Each column represents a different bootstrap sample. 
The first <code class="reqn">p</code> rows are the MM-location estimates of the first sample, the next <code class="reqn">p</code> rows are the MM-location estimates of the second sample, 
the next <code class="reqn">p*p</code> rows are the common MM-shape estimates (vectorized). Then the next 
<code class="reqn">p*p</code> rows are the common S-covariance estimates (vectorized), the next <code class="reqn">p</code> are the S-location estimates of the first sample, 
the final <code class="reqn">p</code> rows are the S-location estimates of the second sample. 
The estimates are centered by the original estimates, which are also returned through <code>MMest</code> in vectorized form.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>centered</code></td>
<td>
<p>recalculated two sample MM- and S-estimates of location and scatter (centered by original estimates), see Details</p>
</td></tr>
<tr><td><code>MMest</code></td>
<td>
<p>original two sample MM- and S-estimates of location and scatter, see Details</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Ella Roelant, Gert Willems and Stefan Van Aelst</p>


<h3>References</h3>

 
<ul>
<li><p> E. Roelant, S. Van Aelst and G. Willems, (2008) Fast Bootstrap for Robust Hotelling Tests, COMPSTAT 2008: 
Proceedings in Computational Statistics (P. Brito, Ed.) Heidelberg: Physika-Verlag, 709&ndash;719.
</p>
</li>
<li><p> M. Salibian-Barrera, S. Van Aelst and G. Willems (2008) Fast and robust bootstrap. 
<em>Statistical Methods and Applications</em>, <b>17</b>, 41&ndash;71. 
</p>
</li>
<li><p> M. Salibian-Barrera, R.H. Zamar (2002) Bootstrapping robust estimates of regression. 
<em>The Annals of Statistics</em>, <b>30</b>, 556&ndash;582.
</p>
</li>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

<p> See Also <code><a href="#topic+FRBhotellingMM">FRBhotellingMM</a></code>, <code><a href="#topic+Sboot_twosample">Sboot_twosample</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
    Y1 &lt;- matrix(rnorm(50*5), ncol=5)
    Y2 &lt;- matrix(rnorm(50*5), ncol=5)
    Ybig &lt;- rbind(Y1,Y2)
    grp &lt;- c(rep(1,50),rep(2,50))
    MMests &lt;- MMest_twosample(Ybig, grp)
    bootresult &lt;- MMboot_twosample(Ybig, grp, R=500, ests=MMests)

</code></pre>

<hr>
<h2 id='MMest_loccov'>S- and MM-Estimates of multivariate location and covariance matrix</h2><span id='topic+MMest_loccov'></span><span id='topic+Sest_loccov'></span><span id='topic+MMest_twosample'></span><span id='topic+Sest_twosample'></span>

<h3>Description</h3>

<p>Compute S- and MM-Estimates of multivariate location and covariance matrix 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    MMest_loccov(Y, control=MMcontrol(...), ...)
    Sest_loccov(Y, bdp=.5, control=Scontrol(...), ...)
    MMest_twosample(X, groups, control=MMcontrol(...), ...)
    Sest_twosample(X, groups, bdp=0.5, control=Scontrol(...), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MMest_loccov_+3A_y">Y</code></td>
<td>
<p>input matrix or data frame</p>
</td></tr>
<tr><td><code id="MMest_loccov_+3A_x">X</code></td>
<td>
<p>input matrix or data frame</p>
</td></tr>
<tr><td><code id="MMest_loccov_+3A_bdp">bdp</code></td>
<td>
<p>breakdown point, defaults to 0.5</p>
</td></tr>
<tr><td><code id="MMest_loccov_+3A_groups">groups</code></td>
<td>
<p>grouping variable</p>
</td></tr>
<tr><td><code id="MMest_loccov_+3A_control">control</code></td>
<td>
<p>a list with control parameters for tuning the S- or MM-estimate 
and its computing algorithm, see<code><a href="#topic+Scontrol">Scontrol</a></code> and  
<code><a href="#topic+MMcontrol">MMcontrol</a></code>.</p>
</td></tr>
<tr><td><code id="MMest_loccov_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code>CovMMest()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This functions are internal, wrappers around the functions <code>Sest()</code> <code>CovMMest()</code>.
</p>


<h3>Value</h3>

<p>Return lists with the following components:
</p>
<table role = "presentation">
<tr><td><code>Mu</code></td>
<td>
<p>location</p>
</td></tr>
<tr><td><code>Gamma</code></td>
<td>
<p>shape</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p>scale=det^(1/(2*m))</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p>covariance matrix</p>
</td></tr>
<tr><td><code>c1</code></td>
<td>
<p>tuning parameter of the loss function for MM-estimation </p>
</td></tr>
<tr><td><code>SMu</code></td>
<td>
<p>location of the initial S-estimate</p>
</td></tr>
<tr><td><code>SGamma</code></td>
<td>
<p>shape of the initial S-estimate</p>
</td></tr>
<tr><td><code>SSigma</code></td>
<td>
<p>covariance matrix of the initial S-estimate</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>tuning parameters used in Tukey biweight loss function for S-estimation, as determined by bdp</p>
</td></tr>
<tr><td><code>w</code></td>
<td>
<p>scaled weights</p>
</td></tr>
<tr><td><code>outflag</code></td>
<td>
<p>outlier flags</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
    Y &lt;- matrix(rnorm(50*5), ncol=5)
    (MMests &lt;- MMest_loccov(Y)) 

    (Sests &lt;- Sest_loccov(Y, bdp = 0.25)) 

    Y1 &lt;- matrix(rnorm(50*5), ncol=5)
    Y2 &lt;- matrix(rnorm(50*5), ncol=5)
    Ybig &lt;- rbind(Y1,Y2)
    grp &lt;- c(rep(1,50),rep(2,50))
    (MMests &lt;- MMest_twosample(Ybig, grp))
    
</code></pre>

<hr>
<h2 id='MMest_multireg'>MM-Estimates for Multivariate Regression</h2><span id='topic+MMest_multireg'></span><span id='topic+MMest_multireg.default'></span><span id='topic+MMest_multireg.formula'></span>

<h3>Description</h3>

<p>Computes MM-Estimates of multivariate regression, using initial S-estimates 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'formula'
MMest_multireg(formula, data=NULL, ...)

## Default S3 method:
MMest_multireg(X, Y, int = TRUE, control=MMcontrol(...),
na.action=na.omit, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MMest_multireg_+3A_formula">formula</code></td>
<td>
<p> an object of class <code><a href="stats.html#topic+formula">formula</a></code>; a symbolic description of the model to be fit.</p>
</td></tr>
<tr><td><code id="MMest_multireg_+3A_data">data</code></td>
<td>
<p> data frame from which variables specified in formula are to be taken.</p>
</td></tr>
<tr><td><code id="MMest_multireg_+3A_x">X</code></td>
<td>
<p> a matrix or data frame containing the explanatory variables (possibly including intercept). </p>
</td></tr>
<tr><td><code id="MMest_multireg_+3A_y">Y</code></td>
<td>
<p> a matrix or data frame containing the response variables. </p>
</td></tr>
<tr><td><code id="MMest_multireg_+3A_int">int</code></td>
<td>
<p> logical: if <code>TRUE</code> an intercept term is added to the model (unless it is already present in <code>X</code>)</p>
</td></tr>  
<tr><td><code id="MMest_multireg_+3A_control">control</code></td>
<td>
<p>a list with control parameters for tuning the MM-estimate and its computing algorithm, 
see <code><a href="#topic+MMcontrol">MMcontrol</a></code>().</p>
</td></tr>
<tr><td><code id="MMest_multireg_+3A_na.action">na.action</code></td>
<td>
<p> a function which indicates what should happen when the data contain NAs. Defaults to <code><a href="stats.html#topic+na.omit">na.omit</a></code>.</p>
</td></tr>
<tr><td><code id="MMest_multireg_+3A_...">...</code></td>
<td>
<p>allows for specifying control parameters directly instead of via <code>control</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called by <code><a href="#topic+FRBmultiregMM">FRBmultiregMM</a></code>.
</p>
<p>The MM-estimates are defined by first computing S-estimates of regression, then fixing the scale component of the error covariance
estimate, and finally re-estimating the regression coefficients and the shape part of the error covariance by more efficient 
M-estimates (see Tatsuoka and Tyler (2000) for MM-estimates in the special case of location/scatter estimation, and Van Aelst and 
Willems (2005) for S-estimates of multivariate regression). Tukey's biweight is used for 
the loss functions. By default, the first loss function (in the S-estimates) is tuned in order to obtain 50% breakdown point. 
The default tuning of the second loss function (M-estimates) ensures 95% efficiency at the normal model for the coefficient estimates. 
The desired efficiency can be changed via argument <code>control</code>.
</p>
<p>The computation of the S-estimates is performed by a call to <code><a href="#topic+Sest_multireg">Sest_multireg</a></code>, which uses the fast-S algorithm. 
See <code><a href="#topic+MMcontrol">MMcontrol</a></code>() to see or change the tuning parameters for this algorithm. The M-estimate part is computed
through iteratively reweighted least squares (RWLS).
</p>
<p>Apart from the MM-estimate of the regression coefficients, the function returns both the MM-estimate of the error 
covariance <code>Sigma</code> and the corresponding shape estimate <code>Gamma</code> (which has determinant equal to 1). 
Additionally, the initial S-estimates are returned as well (their Gaussian efficiency is usually lower than the MM-estimates but they may 
have a lower bias). 
</p>
<p>The returned object inherits from class <code>mlm</code> such that the standard <code><a href="stats.html#topic+coef">coef</a></code>, <code><a href="stats.html#topic+residuals">residuals</a></code>, <code><a href="stats.html#topic+fitted">fitted</a></code> and <code><a href="stats.html#topic+predict.lm">predict</a></code> functions can be used.
</p>


<h3>Value</h3>

<p>An object of class <code>FRBmultireg</code> which extends class <code>mlm</code> and contains at least the following components:
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p> MM-estimates of the regression coefficients</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p> the residuals, that is response minus fitted values</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p> the fitted values.</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p>MM-estimate of the error covariance matrix</p>
</td></tr>
<tr><td><code>Gamma</code></td>
<td>
<p>MM-estimate of the error shape matrix</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p> S-estimate of the size of the multivariate errors</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>implicit weights corresponding to the MM-estimates (i.e. final weights in the RWLS procedure)</p>
</td></tr>
<tr><td><code>outFlag</code></td>
<td>
<p>outlier flags: 1 if the robust distance of the residual exceeds the .975 quantile of (the square root of)
the chi-square distribution with degrees of freedom equal to the dimension of the responses; 0 otherwise</p>
</td></tr>  
<tr><td><code>c0</code>, <code>b</code>, <code>c1</code></td>
<td>
<p>tuning parameters of the loss functions (depend on control parameters <code>bdp</code> and <code>eff</code>)</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> a list with following components: <code>est</code> = character string indicating that GS-estimates were used,<code>bdp</code> = a copy of the <code>bdp</code> argument, <code>eff</code> a copy of the <code>eff</code>  argument </p>
</td></tr>
<tr><td><code>control</code></td>
<td>
<p> a copy of the <code>control</code> argument </p>
</td></tr>
<tr><td><code>SBeta</code></td>
<td>
<p>S-estimate of the regression coefficient matrix</p>
</td></tr>
<tr><td><code>SSigma</code></td>
<td>
<p>S-estimate of the error covariance matrix</p>
</td></tr>
<tr><td><code>SGamma</code></td>
<td>
<p>S-estimate of the error shape matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Gert Willems, Stefan Van Aelst and Ella Roelant </p>


<h3>References</h3>

 
<ul>
<li><p> K.S. Tatsuoka and D.E. Tyler (2000), The uniqueness of S and M-functionals under non-elliptical distributions.
<em>The Annals of Statistics</em>, <b>28</b>, 1219&ndash;1243. 
</p>
</li>
<li><p> S. Van Aelst and G. Willems (2005), Multivariate regression S-estimators for robust estimation and inference. 
<em>Statistica Sinica</em>, <b>15</b>, 981&ndash;1001.
</p>
</li>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

  <p><code><a href="#topic+FRBmultiregMM">FRBmultiregMM</a></code>, <code><a href="#topic+MMboot_multireg">MMboot_multireg</a></code>,  <code><a href="#topic+Sest_multireg">Sest_multireg</a></code>, <code><a href="#topic+MMcontrol">MMcontrol</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(schooldata)
school.x &lt;- data.matrix(schooldata[,1:5])
school.y &lt;- data.matrix(schooldata[,6:8])

## compute 95% efficient MM-estimates
MMres &lt;- MMest_multireg(school.x,school.y)

## or using the formula interface

    MMres &lt;- MMest_multireg(cbind(reading,mathematics,selfesteem)~., data=schooldata)


## the MM-estimate of the regression coefficient matrix:
MMres$coefficients

## or alternatively 
coef(MMres)

## Do plots

    n &lt;- nrow(schooldata)
    oldpar &lt;- par(mfrow=c(2,1))
    
    ## the estimates can be considered as weighted least squares estimates with the 
    ## following implicit weights
    plot(1:n, MMres$weights)
    
    ## Sres$outFlag tells which points are outliers based on whether or not their 
    ## robust distance exceeds the .975 chi-square cut-off:
    plot(1:n, MMres$outFlag)
    
    ## (see also the diagnostic plot in plotDiag())
    
    par(oldpar)

</code></pre>

<hr>
<h2 id='plot.FRBhot'> Plot Method for Objects of class 'FRBhot' </h2><span id='topic+plot.FRBhot'></span>

<h3>Description</h3>

<p>Plot function for <code>FRBhot</code> objects: plots the bootstrap histogram of the null distribution, and
the simultaneous confidence limits (scaled)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FRBhot'
plot(x,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.FRBhot_+3A_x">x</code></td>
<td>
<p> an <span class="rlang"><b>R</b></span> object of class <code>FRBhot</code>, typically created by <code><a href="#topic+FRBhotellingS">FRBhotellingS</a></code> or <code><a href="#topic+FRBhotellingMM">FRBhotellingMM</a></code> </p>
</td></tr>
<tr><td><code id="plot.FRBhot_+3A_...">...</code></td>
<td>
<p> potentially more arguments </p>
</td></tr> 
</table>


<h3>Details</h3>

<p>This generic <code>plot</code> function presents two graphs. The first (top panel) is a histogram representing the test statistics
in the bootstrap samples, which estimate the null distribution.
A red line indicates the test statistic in the original sample (but is not shown when this value exceeds 100).
</p>
<p>The second (bottom panel) displays the simultaneous confidence intervals based on the same bootstrap result.
The intervals are scaled such that they all have the same length. Furthermore, in case of the one-sample test
the intervals are shown relative to the hypothesized value <code>mu0</code>. Such visualization is meant to easily
recognize the extent to which each variable is responsible for the overall deviation from the hypothesized value.
</p>


<h3>Value</h3>

<p>Returns invisibly the first argument.
</p>


<h3>Author(s)</h3>

<p> Gert Willems, Ella Roelant and Stefan Van Aelst </p>


<h3>References</h3>

 

<ul>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

 <p><code><a href="#topic+FRBhotellingS">FRBhotellingS</a></code>, <code><a href="#topic+FRBhotellingMM">FRBhotellingMM</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
    ## One sample robust Hotelling test
    data(ForgedBankNotes)
    samplemean &lt;- apply(ForgedBankNotes, 2, mean)
    res = FRBhotellingS(ForgedBankNotes, mu0=samplemean,R=99)
    
    plot(res)
    
    ## Note that the test rejects the hypothesis that the true mean equals the
    ## sample mean; this is due to outliers in the data (i.e. the robustly estimated
    ## center apparently significantly differs from the non-robust sample mean.
    
    ## It is clear from the scaled simultaneous confidence limits that the rejection
    ## of the hypothesis is due to the differences in variables Bottom and Diagonal
    
    ## For comparison, the hypothesis would be accepted if only the first three
    ## variables were considered:
    res = FRBhotellingS(ForgedBankNotes[,1:3], mu0=samplemean[1:3],R=99)
    plot(res)
    
    ## Two sample robust Hotelling test
    data(hemophilia, package="rrcov")
    res &lt;- FRBhotellingMM(cbind(AHFactivity, AHFantigen) ~ gr, data=hemophilia, R=99)
    plot(res)
    
    ## From the confidence limits it can be seen that the significant difference
    ## is mainly caused by the AHFactivity variable.
    ## the red line on the histogram indicates the test statistic value in the original
    ## sample (it is omitted if the statistic exceeds 100)

</code></pre>

<hr>
<h2 id='plot.FRBmultireg'> Plot Method for Objects of class 'FRBmultireg' </h2><span id='topic+plot.FRBmultireg'></span>

<h3>Description</h3>

<p>Plot function for objects of class <code>FRBmultireg</code>. It produces histograms for the bootstrap estimates for all 
(or a selection) of the regression coefficients, based on Fast and Robust Bootstrap and with visualization of bootstrap confidence limits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FRBmultireg'
plot(x, expl, resp, confmethod = c("BCA","basic"), onepage = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.FRBmultireg_+3A_x">x</code></td>
<td>
<p> an <span class="rlang"><b>R</b></span> object of class <code>FRBmultireg</code>, typically created by  <code><a href="#topic+FRBmultiregS">FRBmultiregS</a></code>, <code><a href="#topic+FRBmultiregMM">FRBmultiregMM</a></code> or <code><a href="#topic+FRBmultiregGS">FRBmultiregGS</a></code> </p>
</td></tr>
<tr><td><code id="plot.FRBmultireg_+3A_expl">expl</code></td>
<td>
<p> optional; vector specifying the explanatory variables to be shown (either by index or by variable name) </p>
</td></tr>
<tr><td><code id="plot.FRBmultireg_+3A_resp">resp</code></td>
<td>
<p> optional; vector specifying the response variables to be shown (either by index or by variable name) </p>
</td></tr>
<tr><td><code id="plot.FRBmultireg_+3A_confmethod">confmethod</code></td>
<td>
<p> which kind of bootstrap confidence intervals to be displayed: 'BCA'= bias corrected and accelerated method, 
'basic'= basic bootstrap method</p>
</td></tr>
<tr><td><code id="plot.FRBmultireg_+3A_onepage">onepage</code></td>
<td>
<p> logical: if TRUE, all requested histograms are plotted on one page; if FALSE, separate pages are used for
each response variable </p>
</td></tr> 
<tr><td><code id="plot.FRBmultireg_+3A_...">...</code></td>
<td>
<p> potentially more arguments to be passed </p>
</td></tr>
</table>


<h3>Details</h3>

<p>With <code class="reqn">p</code> and <code class="reqn">q</code> the number of explanatory resp. response variables specified, the function by default 
(i.e. if <code>onepage=TRUE</code>)
plots a <code class="reqn">p</code> by <code class="reqn">q</code> matrix of histograms, showing the bootstrap recalculations of the corresponding entry in the regression 
coefficient matrix as provided in <code>x</code>. The original estimates for the coefficients are indicated by dotted lines,
while the solid lines are the bootstrap confidence limits. In case the interval does not contain zero, the plot title is
printed in red and a star is added, indicating significance.
</p>
<p>However, if <code class="reqn">p</code> and/or <code class="reqn">q</code> are large, the histograms may not fit on the page and an attempt to do it may
result in an error. Therefore, the function first tries whether it fits (the outcome is platform-dependent), 
and if not it reduces <code class="reqn">p</code> and/or <code class="reqn">q</code> until all plots do fit on the page. Hence, only a selection may be shown and the
user is given a warning in that case.   
</p>
<p>If <code>onepage=FALSE</code>, separate pages are used for each response variable and the user is prompted for page change.
In case the number (<code class="reqn">p</code>) of explanatory variables is very large, the function again may show only a selection. 
</p>


<h3>Value</h3>

<p>Returns invisibly the first argument.
</p>


<h3>Author(s)</h3>

<p> Gert Willems and Ella Roelant </p>


<h3>References</h3>

 

<ul>
<li><p>  S. Van Aelst and G. Willems (2005). Multivariate regression S-estimators for robust estimation and inference. 
<em>Statistica Sinica</em>, <b>15</b>, 981-1001.
</p>
</li>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

 <p><code><a href="#topic+FRBmultiregS">FRBmultiregS</a></code>, <code><a href="#topic+FRBmultiregMM">FRBmultiregMM</a></code>, <code><a href="#topic+FRBmultiregGS">FRBmultiregGS</a></code>, <code><a href="#topic+summary.FRBmultireg">summary.FRBmultireg</a></code>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(schooldata)
school.x &lt;- data.matrix(schooldata[,1:5])
school.y &lt;- data.matrix(schooldata[,6:8])

Sres &lt;- FRBmultiregS(school.x, school.y, R=999, bdp = 0.25, conf = 0.99)


    plot(Sres)

    ##  the plot command above selected a subset, since otherwise an error may occur; 
    ##  as may happen when you explicitely ask for all coefficients to be plotted on one page:

    plot(Sres, expl=1:6, resp=1:3)

    ##  use separate pages for each response in case of many covariates: 
    plot(Sres, onepage=FALSE)

    ##  perhaps specify some specific variables of interest:
    plot(Sres, expl=c("education", "occupation"), resp=c("selfesteem","reading"))

    ##  or (the same):
    plot(Sres, expl=2:3, resp=c(3,1))

</code></pre>

<hr>
<h2 id='plot.FRBpca'> Plot Method for Objects of class 'FRBpca' </h2><span id='topic+plot.FRBpca'></span><span id='topic+plotFRBvars'></span><span id='topic+plotFRBangles'></span><span id='topic+plotFRBloadings'></span>

<h3>Description</h3>

<p>Plot functions for <code>FRBpca</code> objects: plots PC variances, PC angles and PC loadings, with bootstrap inference 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FRBpca'
plot(x, which = 1:3, pcs.loadings = 1:min(5, length(x$eigval)),
confmethod = c("BCA","basic"), ...)


plotFRBvars(x, cumul = 2, confmethod = c("BCA","basic"), 
            npcs = min(10, length(x$eigval)))
plotFRBangles(x, pcs = 1:min(12,length(x$eigval)))
plotFRBloadings(x, confmethod = c("BCA","basic"), 
            pcs = 1:min(5, length(x$eigval)), nvars=min(10, length(x$eigval)))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.FRBpca_+3A_x">x</code></td>
<td>
<p> an <span class="rlang"><b>R</b></span> object of class <code>FRBpca</code>, typically created by <code><a href="#topic+FRBpcaS">FRBpcaS</a></code> or <code><a href="#topic+FRBpcaMM">FRBpcaMM</a></code> </p>
</td></tr>
<tr><td><code id="plot.FRBpca_+3A_which">which</code></td>
<td>
<p> integer number(s) between 1 and 3 to specify which plot is desired (1 = variances; 2 = angles; 3 = loadings)</p>
</td></tr>
<tr><td><code id="plot.FRBpca_+3A_pcs.loadings">pcs.loadings</code></td>
<td>
<p> integer number(s) indicating for which of the PCs the loadings should be shown (in case the 
<code>which</code> argument contains 2)</p>
</td></tr>
<tr><td><code id="plot.FRBpca_+3A_cumul">cumul</code></td>
<td>
<p> integer between 0 and 2: 0 = screeplot, i.e. the variances of the PCs are shown; 1 = the cumulative variances (percentage) of the
PCs are shown; 2 = (default) both plots are shown on the same page</p>
</td></tr>
<tr><td><code id="plot.FRBpca_+3A_confmethod">confmethod</code></td>
<td>
<p> which kind of bootstrap confidence intervals to be displayed: 
'BCA'= bias corrected and accelerated method, 'basic'= basic bootstrap method</p>
</td></tr>
<tr><td><code id="plot.FRBpca_+3A_npcs">npcs</code></td>
<td>
<p> number of PCs to be included in screeplot/cumulative variances plot </p>
</td></tr>
<tr><td><code id="plot.FRBpca_+3A_pcs">pcs</code></td>
<td>
<p> PCs to consider in plot; defaults to first 12 (maximally) for <code>plotFRBangles</code>; defaults to first 5 for
<code>plotFRBloading</code> (each PC is on a separate page here) </p>
</td></tr>
<tr><td><code id="plot.FRBpca_+3A_nvars">nvars</code></td>
<td>
<p> number of variables for which loadings should be shown in each PC; the loadings are shown in decreasing order in each PC</p>
</td></tr>      
<tr><td><code id="plot.FRBpca_+3A_...">...</code></td>
<td>
<p> potentially more arguments </p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The generic <code>plot</code> function calls <code>plotFRBvars</code>, <code>plotFRBangles</code> and 
<code>plotFRBloadings</code>, according to which
of these are respectively specified in argument <code>which</code>, and 
displays the plots on separate pages (the user is prompted for each new page).  The PCs for which the loadings should be plotted 
can be specified through the <code>pcs.loadings</code> argument. The other arguments are set to their default values by <code>plot</code>.
</p>
<p>The solid curves displayed by <code>plotFRBvars</code> indicate the actual estimates of the variances (or percentages), while the dashed curves represent the confidence
limits as computed by <code><a href="#topic+FRBpcaS">FRBpcaS</a></code> or <code><a href="#topic+FRBpcaMM">FRBpcaMM</a></code>.
</p>
<p><code>plotFRBangles</code> plots, for each PC,  histograms of the angles between the bootstrapped PC and the original PC estimate.
The angles are in radians, between 0 and pi/2. These limits are indicated by the red vertical lines. Angles close to zero correspond
to bootstrapped PCs closely aligned with the original PC, while an angle close to pi/2 means the bootstrapped PC is roughly
perpendicular to the original estimate (hence a large number of angles close to pi/2 implies high variability). 
If the number of PCs specified in <code>pcs</code> is very large (usually larger than the default settings), the histograms may not fit
on one page and a selection will be made (the user will be given a warning in that case).
</p>
<p>In <code>plotFRBloadings</code>, the red dots represent the loadings, which are between -1 and 1. The square brackets indicate the confidence
limits as computed by <code><a href="#topic+FRBpcaS">FRBpcaS</a></code> or <code><a href="#topic+FRBpcaMM">FRBpcaMM</a></code>. Only the loadings of the first <code>nvars</code> variables
are shown, where the variables were ordered according to the absolute value of the loading (i.e. only the <code>nvars</code> most important
variables for that particular PC are shown).
</p>


<h3>Value</h3>

<p>Returns invisibly the first argument.
</p>


<h3>Author(s)</h3>

<p> Gert Willems and Ella Roelant </p>


<h3>References</h3>

 

<ul>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

 <p><code><a href="#topic+FRBpcaS">FRBpcaS</a></code>, <code><a href="#topic+FRBpcaMM">FRBpcaMM</a></code>,  <code><a href="#topic+summary.FRBpca">summary.FRBpca</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>

    data(ForgedBankNotes)
    
    MMpcares &lt;- FRBpcaMM(ForgedBankNotes, R=999, conf=0.95)
    plot(MMpcares) 
    
    ## a closer look at the screeplot, specifying basic bootstrap intervals
    plotFRBvars(MMpcares, cumul=0, confmethod="basic")
    
    ## plots the bootstrap angles for the first PC only
    plotFRBangles(MMpcares, pcs=1)
    
    ## plots the loadings, with basic bootstrap intervals, for *all* the PCs 
    plotFRBloadings(MMpcares, confmethod="basic", pcs=1:ncol(ForgedBankNotes))

</code></pre>

<hr>
<h2 id='Sboot_loccov'>Fast and Robust Bootstrap for S-estimates of location/covariance</h2><span id='topic+Sboot_loccov'></span>

<h3>Description</h3>

<p>Calculates bootstrapped S-estimates using the Fast and Robust Bootstrap
method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sboot_loccov(Y, R = 999, ests = Sest_loccov(Y))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Sboot_loccov_+3A_y">Y</code></td>
<td>
<p> matrix or data frame. </p>
</td></tr>
<tr><td><code id="Sboot_loccov_+3A_r">R</code></td>
<td>
<p> number of bootstrap samples. Default is <code>R=999</code>. </p>
</td></tr>
<tr><td><code id="Sboot_loccov_+3A_ests">ests</code></td>
<td>
<p> original S-estimates as returned by <code><a href="#topic+Sest_loccov">Sest_loccov</a></code>(). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called by <code><a href="#topic+FRBpcaS">FRBpcaS</a></code> and <code><a href="#topic+FRBhotellingS">FRBhotellingS</a></code>, it is typically not to be used on its own. 
It requires the S-estimates of multivariate location and scatter/shape
(the result of <code><a href="#topic+Sest_loccov">Sest_loccov</a></code> applied on <code>Y</code>), supplied through the argument <code>ests</code>. 
If <code>ests</code> is not provided, <code><a href="#topic+Sest_loccov">Sest_loccov</a></code> calls the implementation of the multivariate S-estimates in package <span class="pkg">rrcov</span> of Todorov and Filzmoser (2009) with default arguments.
</p>
<p>For multivariate data the fast and robust bootstrap was developed by Salibian-Barrera, Van Aelst and Willems (2006).
</p>
<p>The value <code>centered</code> gives a matrix with <code>R</code> columns and <code class="reqn">p+p*p</code> rows (<code class="reqn">p</code> is the number of variables in <code>Y</code>), 
containing the recalculated estimates of the S-location and -covariance. Each column represents a different bootstrap sample. 
The first <code class="reqn">p</code> rows are the location estimates and the next <code class="reqn">p*p</code> rows are the covariance estimates (vectorized). The estimates
are centered by the original estimates, which are also returned through <code>Sest</code>.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>centered</code></td>
<td>
<p>recalculated estimates of location and covariance (centered by original estimates)</p>
</td></tr>
<tr><td><code>Sest</code></td>
<td>
<p>original estimates of location and covariance</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Gert Willems, Ella Roelant and Stefan Van Aelst</p>


<h3>References</h3>

 

<ul>
<li><p> M. Salibian-Barrera, S. Van Aelst and G. Willems (2006) PCA based on multivariate MM-estimators with fast and robust bootstrap. 
<em>Journal of the American Statistical Association</em>, <b>101</b>, 1198&ndash;1211.
</p>
</li>
<li><p> M. Salibian-Barrera, S. Van Aelst and G. Willems (2008) Fast and robust bootstrap. 
<em>Statistical Methods and Applications</em>, <b>17</b>, 41&ndash;71. 
</p>
</li>
<li><p> V. Todorov and P. Filzmoser (2009), An Object Oriented Framework for Robust Multivariate Analysis. 
<em>Journal of Statistical Software</em>, <b>32</b>(3), 1&ndash;47.
<a href="https://doi.org/10.18637/jss.v032.i03">doi:10.18637/jss.v032.i03</a>.
</p>
</li>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

 <p><code><a href="#topic+FRBpcaS">FRBpcaS</a></code>, <code><a href="#topic+FRBhotellingS">FRBhotellingS</a></code>,    <code><a href="#topic+MMboot_loccov">MMboot_loccov</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>Y &lt;- matrix(rnorm(50*5), ncol=5)
Sests &lt;- Sest_loccov(Y, bdp = 0.25) 
bootresult &lt;- Sboot_loccov(Y, R = 1000, ests = Sests)

</code></pre>

<hr>
<h2 id='Sboot_multireg'> Fast and Robust Bootstrap for S-Estimates of Multivariate Regression </h2><span id='topic+Sboot_multireg'></span>

<h3>Description</h3>

<p>Calculates bootstrapped S-estimates of multivariate regression and corresponding bootstrap confidence intervals using the Fast and Robust Bootstrap
method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sboot_multireg(X, Y, R = 999, conf=0.95, ests = Sest_multireg(X, Y))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Sboot_multireg_+3A_x">X</code></td>
<td>
<p> a matrix or data frame containing the explanatory variables (possibly including intercept). </p>
</td></tr>
<tr><td><code id="Sboot_multireg_+3A_y">Y</code></td>
<td>
<p> a matrix or data frame containing the response variables. </p>
</td></tr>
<tr><td><code id="Sboot_multireg_+3A_r">R</code></td>
<td>
<p> number of bootstrap samples. Default is <code>R=999</code>. </p>
</td></tr>
<tr><td><code id="Sboot_multireg_+3A_conf">conf</code></td>
<td>
<p> level of the bootstrap confidence intervals. Default is <code>conf=0.95</code>. </p>
</td></tr>
<tr><td><code id="Sboot_multireg_+3A_ests">ests</code></td>
<td>
<p> S-estimates as returned by <code><a href="#topic+Sest_multireg">Sest_multireg</a></code>(). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Called by <code><a href="#topic+FRBmultiregS">FRBmultiregS</a></code> and typically not to
be used on its own. It requires the result of <code><a href="#topic+Sest_multireg">Sest_multireg</a></code> applied on <code>X</code> and <code>Y</code>, 
supplied through the argument <code>ests</code>. If <code>ests</code> is not provided, <code><a href="#topic+Sest_multireg">Sest_multireg</a></code> 
will be called with default arguments. 
</p>
<p>The fast and robust bootstrap was first developed by Salibian-Barrera and Zamar (2002) for univariate regression MM-estimators and extended to multivariate regression by Van Aelst and Willems (2005).
</p>
<p>The value <code>centered</code> gives a matrix with <code>R</code> columns and <code class="reqn">p*q+q*q</code> rows (<code class="reqn">p</code> is the number of explanatory variables 
and <code class="reqn">q</code> the number of response variables), 
containing the recalculated S-estimates of the regression coefficients and the error covariance matrix. 
Each column represents a different bootstrap sample. 
The first <code class="reqn">p*q</code> rows are the coefficient estimates, the next <code class="reqn">q*q</code> rows represent the covariance estimate 
(the estimates are vectorized, i.e. columns stacked on top of each other). 
The estimates are centered by the original estimates, which are also returned through <code>vecest</code> in vectorized form.
</p>
<p>The output list further contains bootstrap standard errors, as well as so-called basic bootstrap confidence intervals and bias corrected and accelerated (BCa)
confidence intervals (Davison and Hinkley, 1997, p.194 and p.204 respectively). 
Also in the output are p-values defined as 1 minus the smallest confidence level for which the confidence intervals would include the 
(hypothesised) value of zero. Both BCa and basic bootstrap p-values are given. These are only useful for the
regression coefficient estimates (not really for the covariance estimates).
</p>
<p>Bootstrap samples which contain less than <code class="reqn">p</code> distinct observations with positive weights are discarded 
(a warning is given if this happens). The number of samples actually used is returned via <code>ROK</code>. 
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>centered</code></td>
<td>
<p>a matrix of all fast/robust bootstrap recalculations
where the recalculations are centered by original estimates (see Details) </p>
</td></tr>
<tr><td><code>vecest</code></td>
<td>
<p>a vector containing the original estimates (see Details)</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>bootstrap standard errors for the estimates in <code>vecest</code></p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p> bootstrap covariance matrix for the estimates in <code>vecest</code></p>
</td></tr> 
<tr><td><code>CI.bca</code></td>
<td>
<p>a matrix containing bias corrected and accelerated confidence intervals corresponding to the 
estimates in <code>vecest</code> (first column are lower limits, second column are upper limits)</p>
</td></tr>
<tr><td><code>CI.basic</code></td>
<td>
<p> a matrix containing basic bootstrap intervals corresponding to the 
estimates in <code>vecest</code> (first column are lower limits, second column are upper limits)</p>
</td></tr>
<tr><td><code>p.bca</code></td>
<td>
<p>a vector containing p-values based on the bias corrected and accelerated confidence intervals (corresponding to the 
estimates in <code>vecest</code>)</p>
</td></tr>
<tr><td><code>p.basic</code></td>
<td>
<p>a vector containing p-values based on the basic bootstrap intervals (corresponding to the 
estimates in <code>vecest</code>)</p>
</td></tr>
<tr><td><code>ROK</code></td>
<td>
<p>number of bootstrap samples actually used (i.e. not discarded due to too few distinct observations 
with positive weight)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Gert Willems, Ella Roelant and Stefan Van Aelst</p>


<h3>References</h3>

 

<ul>
<li><p> A.C. Davison, D.V. Hinkley (1997) Bootstrap methods and their application. Cambridge University Press.  
</p>
</li>
<li><p> M. Salibian-Barrera, S. Van Aelst and G. Willems (2008) Fast and robust bootstrap. 
<em>Statistical Methods and Applications</em>, <b>17</b>, 41&ndash;71. 
</p>
</li>
<li><p> M. Salibian-Barrera, R.H. Zamar (2002) Bootstrapping robust estimates of regression. 
<em>The Annals of Statistics</em>, <b>30</b>, 556&ndash;582.
</p>
</li>
<li><p>  S. Van Aelst and G. Willems (2005) Multivariate regression S-estimators for robust estimation and inference. 
<em>Statistica Sinica</em>, <b>15</b>, 981&ndash;1001.
</p>
</li>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

 <p><code><a href="#topic+FRBmultiregS">FRBmultiregS</a></code>, <code><a href="#topic+Sest_multireg">Sest_multireg</a></code>, <code><a href="#topic+MMboot_multireg">MMboot_multireg</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(schooldata)
school.x &lt;- data.matrix(schooldata[,1:5])
school.y &lt;- data.matrix(schooldata[,6:8])

#computes 1000 bootstrap recalculations starting from the S-estimator
#obtained from Sest_multireg()
bootres &lt;- Sboot_multireg(school.x,school.y,R=1000)
</code></pre>

<hr>
<h2 id='Sboot_twosample'> Fast and Robust Bootstrap for Two-Sample S-estimates of Location and Covariance</h2><span id='topic+Sboot_twosample'></span>

<h3>Description</h3>

<p>Calculates bootstrapped two-sample S-estimates using the Fast and Robust Bootstrap
method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sboot_twosample(X, groups, R = 999, ests = Sest_twosample(X, groups))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Sboot_twosample_+3A_x">X</code></td>
<td>
<p> matrix or data frame. </p>
</td></tr>
<tr><td><code id="Sboot_twosample_+3A_groups">groups</code></td>
<td>
<p> vector of 1's and 2's, indicating group numbers. </p>
</td></tr>
<tr><td><code id="Sboot_twosample_+3A_r">R</code></td>
<td>
<p> number of bootstrap samples. Default is <code>R=999</code>. </p>
</td></tr>
<tr><td><code id="Sboot_twosample_+3A_ests">ests</code></td>
<td>
<p> original two-sample S-estimates as returned by <code><a href="#topic+Sest_twosample">Sest_twosample</a></code>(). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called by <code><a href="#topic+FRBhotellingS">FRBhotellingS</a></code>, it is typically not to be used on its own. 
It requires the result of <code><a href="#topic+Sest_twosample">Sest_twosample</a></code> applied on <code>X</code>, supplied through the argument <code>ests</code>. 
If <code>ests</code> is not provided, <code><a href="#topic+Sest_twosample">Sest_twosample</a></code> will be called with default arguments. 
</p>
<p>The fast and robust bootstrap was first developed by Salibian-Barrera and Zamar (2002) for univariate regression MM-estimators and extended to the two sample setting by Roelant et al. (2008).
</p>
<p>The value <code>centered</code> gives a matrix with <code>R</code> columns and <code class="reqn">2*p+p*p</code> rows (<code class="reqn">p</code> is the number of variables in <code>X</code>), 
containing the recalculated estimates of the S-location for the first and second center and common S-covariance. Each column represents 
a different bootstrap sample. 
The first <code class="reqn">p</code> rows are the location estimates of the first center, the next <code class="reqn">p</code> rows are the location
estimates of the second center and the last <code class="reqn">p*p</code> rows are the common covariance estimates (vectorized). The estimates
are centered by the original estimates, which are also returned through <code>Sest</code>.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>centered</code></td>
<td>
<p>recalculated estimates of location of first and second center
and covariance (centered by original estimates)</p>
</td></tr>
<tr><td><code>Sest</code></td>
<td>
<p>original estimates of first and second center and common covariance</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Ella Roelant, Gert Willems and Stefan Van Aelst</p>


<h3>References</h3>

 
<ul>
<li><p> E. Roelant, S. Van Aelst and G. Willems, (2008) Fast Bootstrap for Robust Hotelling Tests, COMPSTAT 2008: 
Proceedings in Computational Statistics (P. Brito, Ed.) Heidelberg: Physika-Verlag, 709&ndash;719.
</p>
</li>
<li><p> M. Salibian-Barrera, S. Van Aelst and G. Willems (2008) Fast and robust bootstrap. 
<em>Statistical Methods and Applications</em>, <b>17</b>, 41&ndash;71. 
</p>
</li>
<li><p> M. Salibian-Barrera, R.H. Zamar (2002) Bootstrapping robust estimates of regression. 
<em>The Annals of Statistics</em>, <b>30</b>, 556&ndash;582.
</p>
</li>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

 <p><code><a href="#topic+FRBhotellingS">FRBhotellingS</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
    Y1 &lt;- matrix(rnorm(50*5), ncol=5)
    Y2 &lt;- matrix(rnorm(50*5), ncol=5)
    Ybig &lt;- rbind(Y1,Y2)
    grp &lt;- c(rep(1,50),rep(2,50))
    Sests &lt;- Sest_twosample(Ybig, grp, bdp=0.25)
    bootresult &lt;- Sboot_twosample(Ybig,grp,R=1000,ests=Sests)

</code></pre>

<hr>
<h2 id='schooldata'> School Data</h2><span id='topic+schooldata'></span>

<h3>Description</h3>

<p>School Data, from Charnes et al. (1981). The aim is to explain scores on 3 
different tests from 70 school sites by means of 5 explanatory variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(schooldata)</code></pre>


<h3>Format</h3>

<p>A data frame with 70 observations on the following 8 variables.
</p>

<dl>
<dt><code>education</code></dt><dd><p> education level of mother as measured in terms of percentage of high school 
graduates among female parents</p>
</dd>
<dt><code>occupation</code></dt><dd><p> highest occupation of a family member according to a pre-arranged rating scale</p>
</dd>
<dt><code>visit</code></dt><dd><p> parental visits index representing the number of visits to the school site</p>
</dd>
<dt><code>counseling</code></dt><dd><p> parent counseling index calculated from data on time spent with child on 
school-related topics such as reading together, etc.</p>
</dd>
<dt><code>teacher</code></dt><dd><p> number of teachers at a given site</p>
</dd>
<dt><code>reading</code></dt><dd><p> total reading score as measured by the Metropolitan Achievement Test</p>
</dd>
<dt><code>mathematics</code></dt><dd><p> total mathematics score as measured by the Metropolitan Achievement Test</p>
</dd>
<dt><code>selfesteem</code></dt><dd><p> Coopersmith Self-Esteem Inventory, intended as a measure of self-esteem</p>
</dd>
</dl>
 


<h3>Source</h3>

<p>Charnes et al. (1981)
</p>


<h3>References</h3>


<ul>
<li><p> A. Charnes, W.W. Cooper and E. Rhodes (1981) Evaluating Program and Managerial Efficiency: An Application of Data
Envelopment Analysis to Program Follow Through. <em>Management Science</em>, <b>27</b>, 668-697.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(schooldata)
</code></pre>

<hr>
<h2 id='Scontrol'> Tuning parameters for multivariate S, MM and GS estimates </h2><span id='topic+Scontrol'></span><span id='topic+MMcontrol'></span><span id='topic+GScontrol'></span>

<h3>Description</h3>

<p>Tuning parameters for multivariate S, MM and GS estimates as used in FRB functions for multivariate regression, 
PCA and Hotelling tests. Mainly regarding the fast-(G)S algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Scontrol(nsamp = 500, k = 3, bestr = 5, convTol = 1e-10, maxIt = 50)

MMcontrol(bdp = 0.5, eff = 0.95, shapeEff = FALSE, convTol.MM = 1e-07, 
          maxIt.MM = 50, fastScontrols = Scontrol(...), ...)

GScontrol(nsamp = 100, k = 3, bestr = 5, convTol = 1e-10, maxIt = 50)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Scontrol_+3A_nsamp">nsamp</code></td>
<td>
<p> number of random subsamples to be used in the fast-(G)S algorithm </p>
</td></tr>
<tr><td><code id="Scontrol_+3A_k">k</code></td>
<td>
<p> number of initial concentration steps performed on each subsample candidate </p>
</td></tr>
<tr><td><code id="Scontrol_+3A_bestr">bestr</code></td>
<td>
<p> number of best candidates to keep for full iteration (i.e. concentration steps until convergence) </p>
</td></tr>
<tr><td><code id="Scontrol_+3A_convtol">convTol</code></td>
<td>
<p> relative convergence tolerance for estimates used in (G)S-concentration iteration</p>
</td></tr>
<tr><td><code id="Scontrol_+3A_maxit">maxIt</code></td>
<td>
<p> maximal number of steps in (G)S-concentration iteration </p>
</td></tr>
<tr><td><code id="Scontrol_+3A_bdp">bdp</code></td>
<td>
<p> breakdown point of the MM-estimates; usually equals 0.5 </p>
</td></tr>
<tr><td><code id="Scontrol_+3A_eff">eff</code></td>
<td>
<p> Gaussian efficiency of the MM-estimates; usually set at 0.95 </p>
</td></tr>
<tr><td><code id="Scontrol_+3A_shapeeff">shapeEff</code></td>
<td>
<p> logical; if <code>TRUE</code>, <code>eff</code> is with regard to shape-efficiency, 
otherwise location-efficiency  </p>
</td></tr>
<tr><td><code id="Scontrol_+3A_convtol.mm">convTol.MM</code></td>
<td>
<p> relative convergence tolerance for estimates used in MM-iteration </p>
</td></tr>
<tr><td><code id="Scontrol_+3A_maxit.mm">maxIt.MM</code></td>
<td>
<p> maximal number of steps in MM-iteration </p>
</td></tr>
<tr><td><code id="Scontrol_+3A_fastscontrols">fastScontrols</code></td>
<td>
<p> the tuning parameters of the initial S-estimate </p>
</td></tr>
<tr><td><code id="Scontrol_+3A_...">...</code></td>
<td>
<p> allows for any individual parameter from <code>Scontrol</code> to be set directly </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default number of random samples is lower for GS-estimates than for S-estimates, because computations regarding the former 
are more demanding.
</p>


<h3>Value</h3>

<p>A list with the tuning parameters as set by the arguments.
</p>


<h3>Author(s)</h3>

<p> Gert Willems and Ella Roelant </p>


<h3>References</h3>

 

<ul>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

 <p><code><a href="#topic+GSest_multireg">GSest_multireg</a></code>,  <code><a href="#topic+Sest_multireg">Sest_multireg</a></code>, 
<code><a href="#topic+MMest_multireg">MMest_multireg</a></code>,  <code><a href="#topic+Sest_twosample">Sest_twosample</a></code>,  <code><a href="#topic+MMest_twosample">MMest_twosample</a></code>, <code><a href="#topic+FRBpcaS">FRBpcaS</a></code>, ... </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Show the default settings:
str(Scontrol())
str(MMcontrol())
str(GScontrol())

</code></pre>

<hr>
<h2 id='Sest_multireg'>S-Estimates for Multivariate Regression</h2><span id='topic+Sest_multireg'></span><span id='topic+Sest_multireg.default'></span><span id='topic+Sest_multireg.formula'></span>

<h3>Description</h3>

<p>Computes S-Estimates of multivariate regression based on Tukey's biweight 
function using the fast-S algorithm. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'formula'
Sest_multireg(formula, data=NULL, ...)

## Default S3 method:
Sest_multireg(X, Y, int = TRUE, bdp = 0.5, control=Scontrol(...),
na.action=na.omit, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Sest_multireg_+3A_formula">formula</code></td>
<td>
<p> an object of class <code><a href="stats.html#topic+formula">formula</a></code>; a symbolic description of the model to be fit.</p>
</td></tr>
<tr><td><code id="Sest_multireg_+3A_data">data</code></td>
<td>
<p> data frame from which variables specified in formula are to be taken.</p>
</td></tr>
<tr><td><code id="Sest_multireg_+3A_x">X</code></td>
<td>
<p> a matrix or data frame containing the explanatory variables (possibly including intercept). </p>
</td></tr>
<tr><td><code id="Sest_multireg_+3A_y">Y</code></td>
<td>
<p> a matrix or data frame containing the response variables. </p>
</td></tr>
<tr><td><code id="Sest_multireg_+3A_int">int</code></td>
<td>
<p> logical: if <code>TRUE</code> an intercept term is added to the model (unless it is already present in <code>X</code>). </p>
</td></tr>
<tr><td><code id="Sest_multireg_+3A_bdp">bdp</code></td>
<td>
<p> required breakdown point. Should have <code class="reqn">0 &lt; </code> <code>bdp</code> <code class="reqn">\le 0.5</code>, the default is 0.5.</p>
</td></tr>
<tr><td><code id="Sest_multireg_+3A_control">control</code></td>
<td>
<p>a list with control parameters for tuning the computing algorithm, see <code><a href="#topic+Scontrol">Scontrol</a></code>().</p>
</td></tr>
<tr><td><code id="Sest_multireg_+3A_na.action">na.action</code></td>
<td>
<p> a function which indicates what should happen when the data contain NAs. Defaults to <code><a href="stats.html#topic+na.omit">na.omit</a></code>.</p>
</td></tr>  
<tr><td><code id="Sest_multireg_+3A_...">...</code></td>
<td>
<p>allows for specifying control parameters directly instead of via <code>control</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called by <code><a href="#topic+FRBmultiregS">FRBmultiregS</a></code>. 
</p>
<p>S-estimates for multivariate regression were discussed in Van Aelst and Willems (2005). The algorithm used here is a multivariate 
version of the fast-S algorithm introduced by Salibian-Barrera and Yohai (2006). 
See <code><a href="#topic+Scontrol">Scontrol</a></code> for the adjustable tuning parameters of this algorithm. 
</p>
<p>Apart from the regression coefficients, the function returns both the error covariance matrix estimate <code>Sigma</code> and 
the corresponding shape estimate <code>Gamma</code> (which has determinant equal to 1). 
The <code>scale</code> is determined by <code class="reqn">det(Sigma)^{1/2/q}</code>, with <code class="reqn">q</code> the number of response variables.
</p>
<p>The returned object inherits from class <code>mlm</code> such that the standard <code><a href="stats.html#topic+coef">coef</a></code>, <code><a href="stats.html#topic+residuals">residuals</a></code>, <code><a href="stats.html#topic+fitted">fitted</a></code> and <code><a href="stats.html#topic+predict.lm">predict</a></code> functions can be used.
</p>


<h3>Value</h3>

<p>An object of class <code>FRBmultireg</code> which extends class <code>mlm</code> and contains at least the following components:
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p> S-estimates of the regression coefficients</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p> the residuals, that is response minus fitted values</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p> the fitted values.</p>
</td></tr>
<tr><td><code>Gamma</code></td>
<td>
<p>S-estimate of the error shape matrix</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p>S-estimate of the error covariance matrix</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p> S-estimate of the size of the multivariate errors</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>implicit weights corresponding to the S-estimates (i.e. final weights in the RWLS procedure at the end of the fast-S algorithm)</p>
</td></tr>
<tr><td><code>outFlag</code></td>
<td>
<p>outlier flags: 1 if the robust distance of the residual exceeds the .975 quantile of (the square root of)
the chi-square distribution with degrees of freedom equal to the dimension of the responses; 0 otherwise</p>
</td></tr>
<tr><td><code>b</code>, <code>c</code></td>
<td>
<p>tuning parameters used in Tukey biweight loss function, as determined by <code>bdp</code></p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> a list with following components: <code>est</code> = character string indicating that GS-estimates were used and <code>bdp</code> = a copy of the <code>bdp</code> argument </p>
</td></tr>
<tr><td><code>control</code></td>
<td>
<p> a copy of the <code>control</code> argument </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Gert Willems, Stefan Van Aelst and Ella Roelant </p>


<h3>References</h3>

 

<ul>
<li><p> M. Salibian-Barrera and V. Yohai (2006) A fast algorithm for S-regression estimates. 
<em>Journal of Computational and Graphical Statistics</em>, <b>15</b>, 414&ndash;427. 
</p>
</li>
<li><p>  S. Van Aelst and G. Willems (2005) Multivariate regression S-estimators for robust estimation and inference. 
<em>Statistica Sinica</em>, <b>15</b>, 981&ndash;1001
</p>
</li>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

 
<p><code><a href="#topic+FRBmultiregS">FRBmultiregS</a></code>, <code><a href="#topic+Sboot_multireg">Sboot_multireg</a></code>,  <code><a href="#topic+MMest_multireg">MMest_multireg</a></code>, <code><a href="#topic+Scontrol">Scontrol</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(schooldata)
school.x &lt;- data.matrix(schooldata[,1:5])
school.y &lt;- data.matrix(schooldata[,6:8])

## compute 25% breakdown S-estimates
Sres &lt;- Sest_multireg(school.x,school.y, bdp=0.25)


    ## or using the formula interface
    Sres &lt;- Sest_multireg(cbind(reading,mathematics,selfesteem)~., data=schooldata, bdp=0.25)
    
    ## the regression coefficients:
    Sres$coefficients
    
    ## or alternatively 
    coef(Sres)
    
    n &lt;- nrow(schooldata)
    oldpar &lt;- par(mfrow=c(2,1))
    ## the estimates can be considered as weighted least squares estimates with the 
    ## following implicit weights
    plot(1:n, Sres$weights)
    
    ## Sres$outFlag tells which points are outliers based on whether or not their 
    ## robust distance exceeds the .975 chi-square cut-off:
    plot(1:n, Sres$outFlag)
    
    ## (see also the diagnostic plot in plotDiag())
    
    par(oldpar)

</code></pre>

<hr>
<h2 id='summary.FRBhot'> Summary Method for Objects of Class 'FRBhot'  </h2><span id='topic+summary.FRBhot'></span><span id='topic+print.summary.FRBhot'></span>

<h3>Description</h3>

<p>Summary method for objects of class <code>FRBhot</code>, and print method of the summary object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FRBhot'
summary(object, digits = 5, ...)
## S3 method for class 'summary.FRBhot'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.FRBhot_+3A_object">object</code></td>
<td>
<p> an <span class="rlang"><b>R</b></span> object of class <code>FRBhot</code>, typically created by <code><a href="#topic+FRBhotellingS">FRBhotellingS</a></code> or <code><a href="#topic+FRBhotellingMM">FRBhotellingMM</a></code> </p>
</td></tr>
<tr><td><code id="summary.FRBhot_+3A_digits">digits</code></td>
<td>
<p> number of digits for printing (default is 5) </p>
</td></tr>
<tr><td><code id="summary.FRBhot_+3A_x">x</code></td>
<td>
<p> an <span class="rlang"><b>R</b></span> object of class <code>summary.FRBhot</code>, resulting from <code>summary(<a href="#topic+FRBhotellingS">FRBhotellingS</a>(),...)</code> or <code>summary(<a href="#topic+FRBhotellingMM">FRBhotellingMM</a>(),...)</code> </p>
</td></tr>
<tr><td><code id="summary.FRBhot_+3A_...">...</code></td>
<td>
<p> potentially more arguments to be passed to methods </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>print</code> method here displays the value of the test statistic and the corresponding bootstrap p-value. It also presents the simultaneous confidence intervals for the components of the location vector (or difference
between the two location vectors), and the robust estimates for the location vector(s) and covariance matrix.
</p>


<h3>Value</h3>

<p><code>summary.FRBhot</code> simply returns its two arguments in a list.
</p>


<h3>Author(s)</h3>

<p> Gert Willems, Ella Roelant and Stefan Van Aelst</p>


<h3>References</h3>

 

<ul>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

 <p><code><a href="#topic+FRBhotellingS">FRBhotellingS</a></code>, <code><a href="#topic+FRBhotellingMM">FRBhotellingMM</a></code>,   <code><a href="#topic+plot.FRBhot">plot.FRBhot</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ForgedBankNotes)
samplemean &lt;- apply(ForgedBankNotes, 2, mean)
res = FRBhotellingS(ForgedBankNotes, mu0=samplemean)

summary(res) # -&gt; print.summary.FRBhot() method

</code></pre>

<hr>
<h2 id='summary.FRBmultireg'> Summary Method for Objects of Class 'FRBmultireg' </h2><span id='topic+summary.FRBmultireg'></span><span id='topic+print.summary.FRBmultireg'></span>

<h3>Description</h3>

<p>Summary method for objects of class <code>FRBmultireg</code>, and print method of the summary object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FRBmultireg'
summary(object, confmethod = c("BCA", "basic", "both"), digits = 3, 
print.CI=FALSE, sep="", ...)

## S3 method for class 'summary.FRBmultireg'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.FRBmultireg_+3A_object">object</code></td>
<td>
<p> an <span class="rlang"><b>R</b></span> object of class <code>FRBmultireg</code>, typically created by <code><a href="#topic+FRBmultiregS">FRBmultiregS</a></code>, <code><a href="#topic+FRBmultiregMM">FRBmultiregMM</a></code> or <code><a href="#topic+FRBmultiregGS">FRBmultiregGS</a></code> </p>
</td></tr>
<tr><td><code id="summary.FRBmultireg_+3A_confmethod">confmethod</code></td>
<td>
<p> which kind of bootstrap confidence intervals to be displayed: 
'BCA'= bias corrected and accelerated method, 'basic'= basic bootstrap method, 'both'=both kinds of confidence intervals </p>
</td></tr>
<tr><td><code id="summary.FRBmultireg_+3A_digits">digits</code></td>
<td>
<p> number of digits for printing (default is 3) </p>
</td></tr>
<tr><td><code id="summary.FRBmultireg_+3A_print.ci">print.CI</code></td>
<td>
<p> logical: Should Confidence intervals be printed?</p>
</td></tr>
<tr><td><code id="summary.FRBmultireg_+3A_sep">sep</code></td>
<td>
<p> Symmbol to separate columns in output. Default is <code>""</code> </p>
</td></tr>
<tr><td><code id="summary.FRBmultireg_+3A_x">x</code></td>
<td>
<p> an <span class="rlang"><b>R</b></span> object of class <code>summary.FRBmultireg</code>, resulting for example from <code>summary(<a href="#topic+FRBmultiregS">FRBmultiregS</a>(),...)</code> </p>
</td></tr>
<tr><td><code id="summary.FRBmultireg_+3A_...">...</code></td>
<td>
<p> potentially more arguments to be passed to methods </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>print</code> method displays in a &ldquo;familiar way&rdquo; the components of the <code>summary</code> object, which are listed in the Value section. 
</p>


<h3>Value</h3>

<p><code>summary</code> returns an object of class <code>summary.FRBmultireg</code>, which contains the following components:
</p>
<table role = "presentation">
<tr><td><code>responses</code></td>
<td>
<p>the names of the response variables in the fitted model</p>
</td></tr>
<tr><td><code>covariates</code></td>
<td>
<p>the names of the covariates (predictors) in the fitted model</p>
</td></tr>
<tr><td><code>Betawstd</code></td>
<td>
<p>a data frame containing the coefficient estimates and their bootstrap standard errors</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p>estimate for the error covariance matrix</p>
</td></tr>
<tr><td><code>table.bca</code></td>
<td>
<p>a list with for each response variable a matrix containing the estimates, standard errors, lower and upper limits of the 
BCa confidence intervals, p-values and a significance code (only present when <code>confmethod="BCA"</code> or <code>confmethod="both"</code>)</p>
</td></tr>
<tr><td><code>table.basic</code></td>
<td>
<p>a list with for each response variable a matrix containing the estimates, standard errors, lower and upper limits of the 
basic bootstrap confidence intervals, p-values and a significance code (only present when <code>confmethod="basic"</code> or <code>confmethod="both"</code>)</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>multivariate regression method that was used</p>
</td></tr>
<tr><td><code>conf</code></td>
<td>
<p>confidence level that was used</p>
</td></tr>
<tr><td><code>digits</code></td>
<td>
<p> number of digits for printing </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Gert Willems, Ella Roelant and Stefan Van Aelst </p>


<h3>References</h3>

 

<ul>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

 <p><code><a href="#topic+FRBmultiregS">FRBmultiregS</a></code>, <code><a href="#topic+FRBmultiregMM">FRBmultiregMM</a></code>, <code><a href="#topic+FRBmultiregGS">FRBmultiregGS</a></code>,  <code><a href="#topic+print.FRBmultireg">print.FRBmultireg</a></code>, <code><a href="#topic+plot.FRBmultireg">plot.FRBmultireg</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
    data(schooldata)
    
    MMres &lt;- FRBmultiregMM(cbind(reading,mathematics,selfesteem)~., data=schooldata,
    R=199, conf = 0.99,nsamp=200)
    summary(MMres)  # -&gt; print.summary.FRBmultireg() method
    
    GSres &lt;- FRBmultiregGS(cbind(reading,mathematics,selfesteem)~., data=schooldata, 
    bdp = 0.25,R=199,nsamp=50)
    summary(GSres, confmethod="both")  # -&gt; print.summary.FRBmultireg() method

</code></pre>

<hr>
<h2 id='summary.FRBpca'> Summary Method for Objects of Class 'FRBpca'  </h2><span id='topic+summary.FRBpca'></span><span id='topic+print.summary.FRBpca'></span>

<h3>Description</h3>

<p>Summary method for objects of class <code>FRBpca</code>, and print method of the summary object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FRBpca'
summary(object, confmethod = c("BCA", "basic", "both"), digits = 3, ...)
## S3 method for class 'summary.FRBpca'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.FRBpca_+3A_object">object</code></td>
<td>
<p> an <span class="rlang"><b>R</b></span> object of class <code>FRBpca</code>, typically created by <code><a href="#topic+FRBpcaS">FRBpcaS</a></code> or <code><a href="#topic+FRBpcaMM">FRBpcaMM</a></code> </p>
</td></tr>
<tr><td><code id="summary.FRBpca_+3A_confmethod">confmethod</code></td>
<td>
<p> which kind of bootstrap confidence intervals to be displayed: 
'BCA'= bias corrected and accelerated method, 'basic'= basic bootstrap method, 'both'= both kinds of confidence intervals </p>
</td></tr>
<tr><td><code id="summary.FRBpca_+3A_digits">digits</code></td>
<td>
<p> number of digits for printing (default is 3) </p>
</td></tr>
<tr><td><code id="summary.FRBpca_+3A_x">x</code></td>
<td>
<p> an <span class="rlang"><b>R</b></span> object of class <code>summary.FRBpca</code>, resulting from <code>summary(<a href="#topic+FRBpcaS">FRBpcaS</a>(),...)</code> or <code>summary(<a href="#topic+FRBpcaMM">FRBpcaMM</a>(),...)</code> </p>
</td></tr>
<tr><td><code id="summary.FRBpca_+3A_...">...</code></td>
<td>
<p> potentially more arguments to be passed to methods </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>print</code> method displays mostly the components of the <code>summary</code> object as listed in the Value section. 
</p>


<h3>Value</h3>

<p><code>summary</code> returns an object of class <code>summary.FRBpca</code>, which contains the following components:
</p>
<table role = "presentation">
<tr><td><code>eigvals</code></td>
<td>
<p>eigenvalues of the shape estimate (variances of the principal components) with confidence limits</p>
</td></tr>
<tr><td><code>eigvecs</code></td>
<td>
<p>eigenvectors of the shape estimate (loadings of the principal components)</p>
</td></tr>
<tr><td><code>avgangle</code></td>
<td>
<p>bootstrap estimates of average angles between true and estimated eigenvectors</p>
</td></tr>
<tr><td><code>pvars</code></td>
<td>
<p>cumulative percentage of variance explained by first principal components with confidence limits</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>PCA method that was used</p>
</td></tr>
<tr><td><code>digits</code></td>
<td>
<p> number of digits for printing </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Gert Willems, Ella Roelant and Stefan Van Aelst</p>


<h3>References</h3>

 
<ul>
<li><p> S. Van Aelst and G. Willems (2013), Fast and robust bootstrap for multivariate inference: The R package FRB. 
<em>Journal of Statistical Software</em>, <b>53</b>(3), 1&ndash;32.
<a href="https://doi.org/10.18637/jss.v053.i03">doi:10.18637/jss.v053.i03</a>.
</p>
</li></ul>


<h3>See Also</h3>

 <p><code><a href="#topic+FRBpcaS">FRBpcaS</a></code>, <code><a href="#topic+FRBpcaMM">FRBpcaMM</a></code>,  <code><a href="#topic+print.FRBpca">print.FRBpca</a></code>, <code><a href="#topic+plot.FRBpca">plot.FRBpca</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
    data(ForgedBankNotes)
    
    MMpcares &lt;- FRBpcaMM(ForgedBankNotes, R=999, conf=0.95)
    summary(MMpcares) # -&gt; print.summary.FRBpca() method

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
