<!DOCTYPE html><html><head><title>Help for package sanon</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sanon}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#sanon-package'><p>The Stratified Analysis with Nonparametric covariable adjustment Package</p></a></li>
<li><a href='#catecovar'><p>Identify Categorical Covariables</p></a></li>
<li><a href='#coef.sanon'><p>Extract Model Coefficients</p></a></li>
<li><a href='#confint.sanon'><p>Confidence Intervals for Model Parameters</p></a></li>
<li><a href='#contrast'><p>Contrast for Model Parameters</p></a></li>
<li><a href='#covar'><p>Identify Covariables</p></a></li>
<li><a href='#cpain'><p>Chronic Pain Data</p></a></li>
<li><a href='#grp'><p>Identify Group Variables</p></a></li>
<li><a href='#heartburn'><p>Relief of heartburn Data</p></a></li>
<li><a href='#resp'><p>Respiratory Disorder Data</p></a></li>
<li><a href='#sanon'><p>Non-Parametric Covariable Adjustment for Stratified Rank Measures of Association</p></a></li>
<li><a href='#sebor'><p>Seborrheic Dermatitis Data</p></a></li>
<li><a href='#skin'><p>Skin Condition Data</p></a></li>
<li><a href='#strt'><p>Identify Stratification Variables</p></a></li>
<li><a href='#summary.sanon'><p>Summarizing Weighted Least Squares Fits</p></a></li>
<li><a href='#vcov.sanon'><p>Calculate Variance-Covariance Matrix for a Fitted Model Object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Stratified Analysis with Nonparametric Covariable Adjustment</td>
</tr>
<tr>
<td>Version:</td>
<td>1.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-05-27</td>
</tr>
<tr>
<td>Author:</td>
<td>Atsushi Kawaguchi</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Atsushi Kawaguchi &lt;kawa_a24@yahoo.co.jp&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Description:</td>
<td>There are several functions to implement the method for analysis in a randomized clinical trial with strata with following key features. A stratified Mann-Whitney estimator addresses the comparison between two randomized groups for a strictly ordinal response variable. The multivariate vector of such stratified Mann-Whitney estimators for multivariate response variables can be considered for one or more response variables such as in repeated measurements and these can have missing completely at random (MCAR) data. Non-parametric covariance adjustment is also considered with the minimal assumption of randomization. The p-value for hypothesis test and confidence interval are provided.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-05-27 12:50:45 UTC; kawaguchi</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-05-27 14:20:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='sanon-package'>The Stratified Analysis with Nonparametric covariable adjustment Package</h2><span id='topic+sanon-package'></span>

<h3>Description</h3>

<p>A Package for Implementation of the method in Kawaguchi, Koch, and Wang (2011)
</p>


<h3>Author(s)</h3>

<p>Atsushi Kawaguchi. <a href="mailto:kawa_a24@yahoo.co.jp">kawa_a24@yahoo.co.jp</a>
</p>


<h3>References</h3>

<p>Kawaguchi A., Koch, G. G. (2015). sanon: An R Package for Stratified Analysis with Nonparametric Covariable Adjustment. Journal of Statistical Software, 67(9), 1-37. doi:10.18637/jss.v067.i09
</p>
<p>Kawaguchi A., Koch, G. G., Wang, X. (2011). Stratified Multivariate Mann-Whitney Estimators for the Comparison of Two Treatments with Randomization Based Covariance Adjustment. Statistics in Biopharmaceutical Research, Vol. 3, No. 2, 217-231.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sanon">sanon</a></code>
</p>

<hr>
<h2 id='catecovar'>Identify Categorical Covariables</h2><span id='topic+catecovar'></span>

<h3>Description</h3>

<p>This is a special function used in the context of <code><a href="#topic+sanon">sanon</a></code>. It identifies categorical covariables when they appear on the right hand side of a formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>catecovar(x, ref = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="catecovar_+3A_x">x</code></td>
<td>
<p>variable name</p>
</td></tr>
<tr><td><code id="catecovar_+3A_ref">ref</code></td>
<td>
<p>character for the reference group for the categorical covariable.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the <code>sanon</code>, the categorical covariable is converted into a dummy variable. The reference group is specified in the <code>ref</code> argument.
</p>

<hr>
<h2 id='coef.sanon'>Extract Model Coefficients</h2><span id='topic+coef.sanon'></span>

<h3>Description</h3>

<p>coef is a generic function which extracts model coefficients from objects returned by modeling functions. coefficients is an alias for it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sanon'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.sanon_+3A_object">object</code></td>
<td>
<p>an object of class &quot;<code>sanon</code>&quot;, usually, a result of a call to <code><a href="#topic+sanon">sanon</a></code></p>
</td></tr>
<tr><td><code id="coef.sanon_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All object classes which are returned by model fitting functions should provide a coef method or use the default one.
</p>


<h3>Value</h3>

<p>Coefficients extracted from the model object object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##### Example 3.1 Randomized Clinical Trial of Chronic Pain #####
data(cpain)
out1 = sanon(response ~ grp(treat, ref="placebo") + strt(center) + strt(diagnosis), data=cpain)
coef(out1)
coefficients(out1)

##### Example 3.2 Randomized Clinical Trial of Respiratory Disorder #####
data(resp)
P = rbind(rep(0, 4), diag(4), rep(0, 4))
out23 = sanon(cbind(baseline, visit1, visit2, visit3, visit4) ~ grp(treatment, ref="P")
 + strt(center) + strt(sex) + covar(age), data=resp, P=P)
# each four visits
coef(out23)
coefficients(out23)

</code></pre>

<hr>
<h2 id='confint.sanon'>Confidence Intervals for Model Parameters</h2><span id='topic+confint.sanon'></span><span id='topic+print.confint.sanon'></span>

<h3>Description</h3>

<p>Computes confidence intervals for one or more parameters in a fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sanon'
confint(object, parm = NULL, level = 0.95, ...)

## S3 method for class 'confint.sanon'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.sanon_+3A_object">object</code>, <code id="confint.sanon_+3A_x">x</code></td>
<td>
<p>an object of class &quot;<code>sanon</code>&quot;, usually, a result of a call to <code><a href="#topic+sanon">sanon</a></code></p>
</td></tr>
<tr><td><code id="confint.sanon_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given confidence intervals, either a vector of numbers or a vector of names. If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="confint.sanon_+3A_level">level</code></td>
<td>
<p>the confidence level required.</p>
</td></tr>
<tr><td><code id="confint.sanon_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Confidence intervals for adjusted parameters in the weighted least squares are computed based on an asymptotic normal.
</p>


<h3>Value</h3>

<table>
<tr><td><code>ci</code></td>
<td>
<p>A matrix (or vector) with columns giving Mann-Whiteney estimates and their lower and upper confidence limits for each parameter with estimates. The interval will be labelled as Lower for (1 - level)/2 limit and Upper for 1 - (1 - level)/2 limit (by default 0.025 and 0.975). </p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>Confidence level</p>
</td></tr>
<tr><td><code>advarnames</code></td>
<td>
<p>Adjust variable names in the weighted least squares method</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>##### Example 3.1 Randomized Clinical Trial of Chronic Pain #####
data(cpain)
out1 = sanon(response ~ grp(treat, ref="placebo") + strt(center) + strt(diagnosis), data=cpain)
confint(out1)

##### Example 3.2 Randomized Clinical Trial of Respiratory Disorder #####
data(resp)
P = rbind(rep(0, 4), diag(4), rep(0, 4))
out23 = sanon(cbind(baseline, visit1, visit2, visit3, visit4) ~ grp(treatment, ref="P")
 + strt(center) + strt(sex) + covar(age), data=resp, P=P)
# each four visits
confint(out23)

</code></pre>

<hr>
<h2 id='contrast'>Contrast for Model Parameters</h2><span id='topic+contrast'></span><span id='topic+print.contrast'></span>

<h3>Description</h3>

<p>Inference by contrast of parameters in a fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contrast(
  object,
  C = diag(length(object$b)),
  confint = FALSE,
  level = 0.95,
  ...
)

## S3 method for class 'contrast'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="contrast_+3A_object">object</code>, <code id="contrast_+3A_x">x</code></td>
<td>
<p>an object of class &quot;<code>sanon</code>&quot;, usually, a result of a call to <code><a href="#topic+sanon">sanon</a></code>.</p>
</td></tr>
<tr><td><code id="contrast_+3A_c">C</code></td>
<td>
<p>contrast matrix. The number of column should be same as the length of <code>b</code> in outputs of <code>sanon</code>.</p>
</td></tr>
<tr><td><code id="contrast_+3A_confint">confint</code></td>
<td>
<p>logical value for whether the confidence interval is computed (only if C has one row).</p>
</td></tr>
<tr><td><code id="contrast_+3A_level">level</code></td>
<td>
<p>the confidence level required (only if C has one row).</p>
</td></tr>
<tr><td><code id="contrast_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provide the inference based on contrast after applying the function <code><a href="#topic+sanon">sanon</a></code>.
The contrast matrix C should be defined by the user. If the the number of row of C = 1, the confidence interval for the estimator is produced.
</p>


<h3>Value</h3>

<table>
<tr><td><code>C</code></td>
<td>
<p>contrast matrix</p>
</td></tr>
<tr><td><code>Cb</code></td>
<td>
<p>contrast estimates</p>
</td></tr>
<tr><td><code>VCb</code></td>
<td>
<p>variance and covariance matrix of <code>Cb</code></p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>standard error of <code>Cb</code></p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code>UL</code></td>
<td>
<p>upper confidence limit (only if the number of row of C = 1, otherwise <code>NULL</code>)</p>
</td></tr>
<tr><td><code>LL</code></td>
<td>
<p>lower confidence limit (only if the number of row of C = 1, otherwise <code>NULL</code>)</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>test statistic</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degree of freedom</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>p-value</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>##### Example 3.2 Randomized Clinical Trial of Respiratory Disorder #####
data(resp)
P = rbind(rep(0, 4), diag(4), rep(0, 4))
out23 = sanon(cbind(baseline, visit1, visit2, visit3, visit4) ~ grp(treatment, ref="P")
 + strt(center) + strt(sex) + covar(age), data=resp, P=P)

# Homogeneity of the xi_k across the four visits
contrast(out23, C=cbind(diag(3), rep(-1, 3)))

# Comparison between treatments for the average of the xi_k across the 4 visits
contrast(out23, C=matrix(rep(1, 4)/4, ncol=4))

</code></pre>

<hr>
<h2 id='covar'>Identify Covariables</h2><span id='topic+covar'></span>

<h3>Description</h3>

<p>This is a special function used in the context of <code><a href="#topic+sanon">sanon</a></code>. It identifies covariables when they appear on the right hand side of a formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covar(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covar_+3A_x">x</code></td>
<td>
<p>variable name</p>
</td></tr>
</table>

<hr>
<h2 id='cpain'>Chronic Pain Data</h2><span id='topic+cpain'></span>

<h3>Description</h3>

<p>The data are from a multicenter randomized clinical trial to compare test and control treatments for the management of chronic pain, and they have had previous consideration in Stokes et al. (2000, chap. 13).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cpain)
</code></pre>


<h3>Format</h3>

<p>A data frame with 193 observations and 4 variables
</p>


<h3>Details</h3>


<dl>
<dt><code>treat</code></dt><dd><p>a factor with levels <code>active</code> and <code>placebo</code> for treatment</p>
</dd>
<dt><code>response</code></dt><dd><p>a factor with five levels <code>poor</code>, <code>fair</code>, <code>moderate</code>, <code>good</code> and <code>excel</code> for pain status after treatment for 4 weeks</p>
</dd>
<dt><code>center</code></dt><dd><p>a factor with two levels <code>I</code> and <code>II</code> for two centers</p>
</dd>
<dt><code>diagnosis</code></dt><dd><p>a factor with four levels <code>A</code>, <code>B</code>, <code>C</code>, and <code>D</code> for diagnoses</p>
</dd>
</dl>



<h3>References</h3>

<p>Stokes, M. E., Davis, C. S., and Koch, G. G. (2000), Categorical Data Analysis using the SAS System, Cary: SAS Publishing.
</p>

<hr>
<h2 id='grp'>Identify Group Variables</h2><span id='topic+grp'></span>

<h3>Description</h3>

<p>This is a special function used in the context of <code><a href="#topic+sanon">sanon</a></code>. It identifies group variables when they appear on the right hand side of a formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grp(x, ref = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grp_+3A_x">x</code></td>
<td>
<p>variable name</p>
</td></tr>
<tr><td><code id="grp_+3A_ref">ref</code></td>
<td>
<p>character for the reference group for treatment group.</p>
</td></tr>
</table>

<hr>
<h2 id='heartburn'>Relief of heartburn Data</h2><span id='topic+heartburn'></span>

<h3>Description</h3>

<p>The data are from two period cross-over design clinical trial for relief of heartburn, and listings of the data appear in Koch, Gitomer, Skalland, and Stokes (1983).
The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(heartburn)
</code></pre>


<h3>Format</h3>

<p>A data frame with 60 observations and 9 variables.
</p>


<h3>Details</h3>


<dl>
<dt><code>center</code></dt><dd><p>a factor vector for two centers</p>
</dd>
<dt><code>sequence</code></dt><dd><p>a factor with levels <code>AP</code> and <code>PA</code> for sequence groups</p>
</dd>
<dt><code>age</code></dt><dd><p>a numeric vector for age</p>
</dd>
<dt><code>sex</code></dt><dd><p>a factor for sex with levels <code>female</code> and <code>male</code></p>
</dd>
<dt><code>freq</code></dt><dd><p>a numeric vector for weekly frequency of condition from previous medical history</p>
</dd>
<dt><code>MD1</code></dt><dd><p>a numeric vector for time to relief from first dose during period 1</p>
</dd>
<dt><code>MD2</code></dt><dd><p>a numeric vector for time to relief from first dose during period 2</p>
</dd>
<dt><code>res1</code></dt><dd><p>a factor vector for relief status for period 1 (R = relief from first dose within 15 min, NF = no relief from first dose within 15 min)</p>
</dd>
<dt><code>ref2</code></dt><dd><p>a factor vector for relief status for period 2 with same categories as <code>res1</code></p>
</dd>
</dl>



<h3>References</h3>

<p>Koch G, Gitomer S, Skalland L, Stokes M (1983). &quot;Some non-parametric and categorical data analyses for a change-over design study and discussion of apparent carry-over effects.&quot; Statistics in Medicine, 2(3), 397&ndash;412.
</p>

<hr>
<h2 id='resp'>Respiratory Disorder Data</h2><span id='topic+resp'></span>

<h3>Description</h3>

<p>The data are from a randomized clinical trial to compare a test treatment to placebo for a respiratory disorder, and listings of the data appear in Stokes et al. (2000, chap. 15, pp. 495-496) and Koch et al. (1990).
The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(resp)
</code></pre>


<h3>Format</h3>

<p>A data frame with 111 observations and 9 variables.
</p>


<h3>Details</h3>


<dl>
<dt><code>center</code></dt><dd><p>a factor vector for two centers</p>
</dd>
<dt><code>treatment</code></dt><dd><p>a factor with levels <code>A</code> and <code>P</code> for active and placebo treatments, respectively</p>
</dd>
<dt><code>sex</code></dt><dd><p>a factor with levels <code>F</code> and <code>M</code> for female and male, respectively</p>
</dd>
<dt><code>age</code></dt><dd><p>a numeric vector for age</p>
</dd>
<dt><code>baseline</code></dt><dd><p>a numeric vector for patient global ratings of symptom control according to 5 categories (4 = excellent, 3 = good, 2 = fair, 1 = poor, 0 = terrible) at baseline measurement</p>
</dd>
<dt><code>visit1</code></dt><dd><p>a numeric vector for patient global ratings of symptom control at visit 1 with same categories as <code>baseline</code></p>
</dd>
<dt><code>visit2</code></dt><dd><p>a numeric vector for patient global ratings of symptom control at visit 2 with same categories as <code>baseline</code></p>
</dd>
<dt><code>visit3</code></dt><dd><p>a numeric vector for patient global ratings of symptom control at visit 3 with same categories as <code>baseline</code></p>
</dd>
<dt><code>visit4</code></dt><dd><p>a numeric vector for patient global ratings of symptom control at visit 4 with same categories as <code>baseline</code></p>
</dd>
</dl>



<h3>References</h3>

<p>Stokes, M. E., Davis, C. S., and Koch, G. G. (2000), Categorical Data Analysis using the SAS System, Cary: SAS Publishing.
</p>
<p>Koch, G. G., Carr, G. J., Amara, I. A., Stokes, M. E., and Uryniak, T. J. (1990), &quot;Categorical Data Analysis,&quot; in Statistical Methodology in Pharmaceutical Sciences, ed. D. A. Berry, New York: Marcel Dekker, pp. 291-475.
</p>

<hr>
<h2 id='sanon'>Non-Parametric Covariable Adjustment for Stratified Rank Measures of Association</h2><span id='topic+sanon'></span><span id='topic+sanon.formula'></span><span id='topic+sanon.default'></span><span id='topic+print.sanon'></span>

<h3>Description</h3>

<p>This is a function for computing a stratified multivariate Mann-Whitney estimator that addresses the comparison between two randomized groups for a strictly ordinal response variable.
Response variables may have some missing completely at random (MCAR) values for some patients. 
Non-parametric covariable adjustment is considered through the difference estimates between mean covariable and the weighted least squares method.
Although such estimators can be computed directly as weighted linear combinations of within-stratum Mann-Whitney estimators, consistent estimation of their covariance matrix is done using methods for multivariate U-statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sanon(outcome, ...)

## S3 method for class 'formula'
sanon(formula, data = list(), ...)

## Default S3 method:
sanon(
  outcome,
  group,
  strt = NULL,
  covar = NULL,
  catecovar = NULL,
  ref = NULL,
  covref = NULL,
  P = NULL,
  res.na.action = "default",
  ...
)

## S3 method for class 'sanon'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sanon_+3A_outcome">outcome</code></td>
<td>
<p>vector of observations of length n, or a matrix with n rows for the response (or outcome) variables</p>
</td></tr>
<tr><td><code id="sanon_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="sanon_+3A_formula">formula</code></td>
<td>
<p>a formula object, with the response on the left of a ~ operator, and the terms on the right.</p>
</td></tr>
<tr><td><code id="sanon_+3A_data">data</code></td>
<td>
<p>a data.frame in which to interpret the variables named in the formula.</p>
</td></tr>
<tr><td><code id="sanon_+3A_group">group</code></td>
<td>
<p>numeric vector of observations of length n for treatment group. The reference group can be specified in <code>ref</code>.</p>
</td></tr>
<tr><td><code id="sanon_+3A_strt">strt</code></td>
<td>
<p>numeric or factor vector of observations of length n, or a matrix with n rows for strata.</p>
</td></tr>
<tr><td><code id="sanon_+3A_covar">covar</code></td>
<td>
<p>numeric or factor vector of observations of length n, or a matrix with n rows for covariable.</p>
</td></tr>
<tr><td><code id="sanon_+3A_catecovar">catecovar</code></td>
<td>
<p>numeric or factor vector of observations of length n, or a matrix with n rows for categorical covariable.</p>
</td></tr>
<tr><td><code id="sanon_+3A_ref">ref</code></td>
<td>
<p>character for the reference group for treatment group in <code>group</code>.</p>
</td></tr>
<tr><td><code id="sanon_+3A_covref">covref</code></td>
<td>
<p>character vector for the reference group for categorical covariables in <code>catecovar</code>.</p>
</td></tr>
<tr><td><code id="sanon_+3A_p">P</code></td>
<td>
<p>a matrix for weighted least squares estimation.</p>
</td></tr>
<tr><td><code id="sanon_+3A_res.na.action">res.na.action</code></td>
<td>
<p>character for setting NA actions. &quot;default&quot;, &quot;LOCF1&quot;, &quot;LOCF2&quot;, &quot;replace&quot;, and &quot;remove&quot; are available. default is &quot;default&quot;. see the details.</p>
</td></tr>
<tr><td><code id="sanon_+3A_x">x</code></td>
<td>
<p>an object of class &quot;<code>sanon</code>&quot;, usually, a result of a call to <code><a href="#topic+sanon">sanon</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>sanon</code> has two specifications for the input, variable and formula based.
In the variable based input, one can specify R objects to outcome, group, and strata variables, and covariable.
In the formula based input, the formula consists of variable names in a data.frame. 
The strata and group variables, and covariable are recognized by functions <code><a href="#topic+strt">strt</a></code>, <code><a href="#topic+grp">grp</a></code>, <code><a href="#topic+covar">covar</a></code>, and <code><a href="#topic+catecovar">catecovar</a></code>.
<code>outcome</code> can be contained missing values, which should be coded by <code>NA</code>. 
Five options for the management of missing values can be specifed in the argument <code>res.na.action</code>; 
<code>"default"</code> = the method in Kawaguchi et al. (2011), <code>"LOCF1"</code> and <code>"LOCF2"</code> = last observation carried forward with respect to kernels of U-statistics and observed velues, repsectively, <code>"replace"</code> = missing values are managed as tied with all other values in the same stratum, and <code>"remove"</code> = the complete cases analaysis.
For <code>res.na.action = "LOCF1"</code> or <code>"LOCF2"</code>, the order in the outcome is considered as the time order in imputing.
if the baseline measurement is missing, then the corresponding subject is removed.
<code>outcome</code> can be also multiple (repeatly measured).
If more than two strata are specified, these are taking a cross-classification. 
The group variable can be specifies its reference group in the argument <code>ref</code> in the <code>sanon</code> or in the function <code>grp</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>N</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code>Nna</code></td>
<td>
<p>tne number of subjects with missing values</p>
</td></tr>
<tr><td><code>nhik</code></td>
<td>
<p>Sample size in each strata, group, and response</p>
</td></tr>
<tr><td><code>nik</code></td>
<td>
<p>Sample size in each group and response</p>
</td></tr>
<tr><td><code>xi</code></td>
<td>
<p>(multivariate) Mann-Whitney estimate(s) that addresses the comparison between two randomized groups</p>
</td></tr>
<tr><td><code>g</code></td>
<td>
<p>the difference estimates between mean covariable</p>
</td></tr>
<tr><td><code>f</code></td>
<td>
<p>a vector consisting of <code>xi</code> and <code>g</code></p>
</td></tr>
<tr><td><code>Vf</code></td>
<td>
<p>estimated covariance matrix of <code>f</code></p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>fully adjustmented estimators for all covariables and the strata</p>
</td></tr>
<tr><td><code>Vb</code></td>
<td>
<p>covariance matrix of <code>b</code></p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>standard error of <code>b</code></p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>test statistics for <code>b</code></p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>p-value for <code>b</code></p>
</td></tr>
<tr><td><code>outnames</code></td>
<td>
<p>outcome or response names</p>
</td></tr>
<tr><td><code>covarnames</code></td>
<td>
<p>covariable names</p>
</td></tr>
<tr><td><code>advarnames</code></td>
<td>
<p>variable names adjusting in the weighted least squares</p>
</td></tr>
<tr><td><code>bnames</code></td>
<td>
<p>variable names of adjusted in the weighted least squares</p>
</td></tr>
<tr><td><code>reslevels</code></td>
<td>
<p>levels for response variables</p>
</td></tr>
<tr><td><code>grouplevels</code></td>
<td>
<p>levels for the group variable</p>
</td></tr>
<tr><td><code>strtout</code></td>
<td>
<p>resulting (cross-classification) strata</p>
</td></tr>
<tr><td><code>strtlevels</code></td>
<td>
<p>resulting (cross-classification) strata levels</p>
</td></tr>
<tr><td><code>strtnames</code></td>
<td>
<p>resulting (cross-classification) strata names</p>
</td></tr>
<tr><td><code>matP</code></td>
<td>
<p>design matrix used in the weighted least squares</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kawaguchi A., Koch, G. G. (2015). sanon: An R Package for Stratified Analysis with Nonparametric Covariable Adjustment. Journal of Statistical Software, 67(9), 1-37. doi:10.18637/jss.v067.i09
</p>
<p>Kawaguchi, A., Koch, G. G., Wang, X. (2011): Stratified Multivariate Mann-Whitney Estimators for the Comparison of Two Treatments with Randomization Based Covariance Adjustment. Statistics in Biopharmaceutical Research, Vol. 3, No. 2, 217-231.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##### Example 3.1 Randomized Clinical Trial of Chronic Pain #####
data(cpain)
out11 = sanon(response ~ grp(treat, ref="placebo") + strt(center) + strt(diagnosis), data=cpain)
out11
summary(out11)

# R objects are also available
attach(cpain)
out12 = sanon(outcome=response, group=treat, 
strt=cbind(center, diagnosis), ref="placebo")
out12
summary(out12)

##### Example 3.2 Randomized Clinical Trial of Respiratory Disorder #####
data(resp)
out21 = sanon(cbind(baseline, visit1, visit2, visit3, visit4) 
~ grp(treatment, ref="P") + strt(center) + strt(sex) + covar(age), data=resp)
out21
summary(out21)

# the matrix P can be specified
P = rbind(rep(0, 4), diag(4), rep(0, 4))
out22 = sanon(cbind(baseline, visit1, visit2, visit3, visit4) 
~ grp(treatment, ref="P") + strt(center) + strt(sex) + covar(age), data=resp, P=P)
out22
summary(out22)

</code></pre>

<hr>
<h2 id='sebor'>Seborrheic Dermatitis Data</h2><span id='topic+sebor'></span>

<h3>Description</h3>

<p>The data are from a randomized clinical trial to compare a test treatment to placebo for a seborrheic dermatitis, and listings of the data appear in Ramaswamy, Koch, and Amara (1997).
The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sebor)
</code></pre>


<h3>Format</h3>

<p>A data frame with 167 observations and 8 variables.
</p>


<h3>Details</h3>


<dl>
<dt><code>center</code></dt><dd><p>a factor vector for eight centers</p>
</dd>
<dt><code>treat</code></dt><dd><p>a factor with levels <code>placebo</code> and <code>test</code> for placebo and test treatments, resectively</p>
</dd>
<dt><code>score1</code></dt><dd><p>a numeric vector for patient global scores for the face according to 6 categories (0 = cleared, 1 = excellent improvement, 2 = moderate improvement, 3 = slight improvement, 4 = no change, 5 = exacerbation)</p>
</dd>
<dt><code>score2</code></dt><dd><p>a numeric vector for patient global scores for the scalp with same categories as <code>score1</code></p>
</dd>
<dt><code>score3</code></dt><dd><p>a numeric vector for patient global scores for the chest with same categories as <code>score1</code></p>
</dd>
<dt><code>severity1</code></dt><dd><p>a numeric vector for the baseline desease severity for the face according to 3 categories (1 = mild, 2 = moderate, 3 = severe)</p>
</dd>
<dt><code>severity2</code></dt><dd><p>a numeric vector for the baseline desease severity for the scalp with same categories as <code>severity1</code></p>
</dd>
<dt><code>severity3</code></dt><dd><p>a numeric vector for the baseline desease severity for the chest with same categories as <code>severity1</code></p>
</dd>
</dl>



<h3>References</h3>

<p>Ramaswamy R, Koch G, Amara I (1997). &quot;Application of rank analysis of covariance methods to analysis of multiple anatomical regions with treatment for seborrheic dermatitis.&quot; Journal of Biopharmaceutical Statistics, 7(3), 403&ndash;416.
</p>

<hr>
<h2 id='skin'>Skin Condition Data</h2><span id='topic+skin'></span>

<h3>Description</h3>

<p>The data are from a randomized clinical trial to compare a test treatment to placebo for skin conditions, and listings of the data appear in Stanish, Gillings, Koch (1978a, b).
The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(skin)
</code></pre>


<h3>Format</h3>

<p>A data frame with 172 observations and 6 variables.
</p>


<h3>Details</h3>


<dl>
<dt><code>center</code></dt><dd><p>a factor vector for two centers</p>
</dd>
<dt><code>treat</code></dt><dd><p>a factor with levels <code>A</code> and <code>P</code> for active and placebo treatments, skinectively</p>
</dd>
<dt><code>stage</code></dt><dd><p>a numeric vector for initial severity of the skin condition according to 3 categories (3 = fair, 4 = poor, 5 = exacerbation) at baseline measurement</p>
</dd>
<dt><code>res1</code></dt><dd><p>a numeric vector for extent of improvement at visit 1 according to 5 categories (1 = rapidly improving, 2 = slowly improving, 3 = stable, 4 = slowly worsening, 5 = rapidly worsening)</p>
</dd>
<dt><code>res2</code></dt><dd><p>a numeric vector for extent of improvement at visit 2 with same categories as <code>res1</code></p>
</dd>
<dt><code>res3</code></dt><dd><p>a numeric vector for extent of improvement at visit 3 with same categories as <code>res1</code></p>
</dd>
</dl>



<h3>References</h3>

<p>Stanish W, Gillings D, Koch G (1978a). &quot;An application of multivariate ratio methods for the analysis of a longitudinal clinical trial with missing data.&quot; Biometrics, 34(2), pp. 305&ndash;317.
</p>
<p>Stanish WM, Koch GG, Landis JR (1978b). &quot;A computer program for multivariate ratio analysis (MISCAT).&quot; Computer Programs in Biomedicine, 8(3-4), 197&ndash;207.
</p>

<hr>
<h2 id='strt'>Identify Stratification Variables</h2><span id='topic+strt'></span>

<h3>Description</h3>

<p>This is a special function used in the context of <code><a href="#topic+sanon">sanon</a></code>. It identifies stratification variables when they appear on the right hand side of a formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strt(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="strt_+3A_x">x</code></td>
<td>
<p>variable name</p>
</td></tr>
</table>

<hr>
<h2 id='summary.sanon'>Summarizing Weighted Least Squares Fits</h2><span id='topic+summary.sanon'></span><span id='topic+print.summary.sanon'></span>

<h3>Description</h3>

<p>summary method for class &quot;sanon&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sanon'
summary(object, ...)

## S3 method for class 'summary.sanon'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.sanon_+3A_object">object</code>, <code id="summary.sanon_+3A_x">x</code></td>
<td>
<p>an object of class &quot;<code>sanon</code>&quot;, usually, a result of a call to <code><a href="#topic+sanon">sanon</a></code></p>
</td></tr>
<tr><td><code id="summary.sanon_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provide the p value for the hypothesis test of coefficient in the model of weighted least squares method.
Note that the estimates in the output are for the (xi_k - 0.5).
</p>


<h3>Value</h3>

<table>
<tr><td><code>coefficients</code></td>
<td>
<p>a p x 4 matrix with columns for the estimated coefficient, its standard error, chi-squared statistic and corresponding (two-sided) p-value.</p>
</td></tr>
<tr><td><code>advarnames</code></td>
<td>
<p>adjust variable names in weighted least squares method</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>##### Example 3.1 Randomized Clinical Trial of Chronic Pain #####
data(cpain)
sum1 = summary(sanon(response ~ grp(treat, ref="placebo") + strt(center) + strt(diagnosis)
, data=cpain))
sum1

##### Example 3.2 Randomized Clinical Trial of Respiratory Disorder #####
data(resp)
sum22 = summary(sanon(cbind(baseline, visit1, visit2, visit3, visit4) 
~ grp(treatment, ref="P") + strt(center) + strt(sex) + covar(age), data=resp))
sum22

</code></pre>

<hr>
<h2 id='vcov.sanon'>Calculate Variance-Covariance Matrix for a Fitted Model Object</h2><span id='topic+vcov.sanon'></span>

<h3>Description</h3>

<p>Returns the variance-covariance matrix of the main parameters of a fitted model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sanon'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.sanon_+3A_object">object</code></td>
<td>
<p>an object of class &quot;<code>sanon</code>&quot;, usually, a result of a call to <code><a href="#topic+sanon">sanon</a></code></p>
</td></tr>
<tr><td><code id="vcov.sanon_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a generic function.
</p>


<h3>Value</h3>

<p>Coefficients extracted from the model object object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##### Example 3.1 Randomized Clinical Trial of Chronic Pain #####
data(cpain)
out1 = sanon(response ~ grp(treat, ref="placebo") + strt(center) + strt(diagnosis), data=cpain)
vcov(out1)

##### Example 3.2 Randomized Clinical Trial of Respiratory Disorder #####
data(resp)
P = rbind(rep(0, 4), diag(4), rep(0, 4))
out23 = sanon(cbind(baseline, visit1, visit2, visit3, visit4) ~ grp(treatment, ref="P")
 + strt(center) + strt(sex) + covar(age), data=resp, P=P)
# each four visits
vcov(out23)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
