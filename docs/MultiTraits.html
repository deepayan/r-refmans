<!DOCTYPE html><html lang="en"><head><title>Help for package MultiTraits</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MultiTraits}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CSR'><p>Calculate CSR strategy for multiple plant species</p></a></li>
<li><a href='#CSR_plot'><p>Create a ternary plot of CSR strategies</p></a></li>
<li><a href='#LHS'><p>Calculate LHS (Leaf-Height-Seed) Strategy</p></a></li>
<li><a href='#LHS_plot'><p>Generate a 3D scatterplot of plant traits</p></a></li>
<li><a href='#LHS_strategy_scheme'><p>Create a table of Leaf-Height-Seed (LHS) strategy types</p></a></li>
<li><a href='#NPT'><p>Perform nested principal component analysis (PCA of PCAs) for ecological niche periodicity</p></a></li>
<li><a href='#NPT_plot'><p>Plot results from nested principal component analysis</p></a></li>
<li><a href='#PFF'><p>Plant Functional Traits Dataset from Ponderosa Pine Forests Flora (PFF)</p></a></li>
<li><a href='#Strate_CSR'><p>Calculate CSR (Competition-Stress-Ruderal) Strategy</p></a></li>
<li><a href='#TN'><p>Generate Plant Trait Network</p></a></li>
<li><a href='#TN_corr'><p>Calculate and Visualize Plant Trait Correlation Network</p></a></li>
<li><a href='#TN_metrics'><p>Calculate Node and Global Metrics for Trait Networks</p></a></li>
<li><a href='#TN_plot'><p>Plot Trait Network Graph</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analyzing and Visualizing Multidimensional Plant Traits</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-2-21</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yan He &lt;heyan@njfu.edu.cn&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements analytical methods for multidimensional plant traits, including Competitors-Stress tolerators-Ruderals strategy analysis using leaf traits, Leaf-Height-Seed strategy analysis, Niche Periodicity Table analysis, and Trait Network analysis. Provides functions for data analysis, visualization, and network metrics calculation. Methods are based on Grime (1974) &lt;<a href="https://doi.org/10.1038%2F250026a0">doi:10.1038/250026a0</a>&gt;, Pierce et al. (2017) &lt;<a href="https://doi.org/10.1111%2F1365-2435.12882">doi:10.1111/1365-2435.12882</a>&gt;, Westoby (1998) &lt;<a href="https://doi.org/10.1023%2FA%3A1004327224729">doi:10.1023/A:1004327224729</a>&gt;, Yang et al. (2022) &lt;<a href="https://doi.org/10.1016%2Fj.foreco.2022.120540">doi:10.1016/j.foreco.2022.120540</a>&gt;, Winemiller et al. (2015) &lt;<a href="https://doi.org/10.1111%2Fele.12462">doi:10.1111/ele.12462</a>&gt;, He et al. (2020) &lt;<a href="https://doi.org/10.1016%2Fj.tree.2020.06.003">doi:10.1016/j.tree.2020.06.003</a>&gt;.</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggtern,igraph,Hmisc,corrplot,scatterplot3d,vegan,ggrepel</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0), ggplot2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr,rmarkdown,testthat (&ge; 3.0.0),devtools</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-21 13:21:01 UTC; Administrator</td>
</tr>
<tr>
<td>Author:</td>
<td>Yan He [aut, cre],
  Zhaogang Liu [aut],
  Jiangshan Lai [aut],
  Lingfeng Mao [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-21 13:40:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='CSR'>Calculate CSR strategy for multiple plant species</h2><span id='topic+CSR'></span>

<h3>Description</h3>

<p>This function processes a dataframe containing leaf traits (LA, LDMC, SLA) and applies the Strate_CSR function to each row.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CSR(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CSR_+3A_data">data</code></td>
<td>
<p>A dataframe containing columns for LA (Leaf Area), LDMC (Leaf Dry Matter Content), and SLA (Specific Leaf Area).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with the original input data and additional columns:
</p>

<ul>
<li><p> C: Competitive strategy score
</p>
</li>
<li><p> S: Stress-tolerant strategy score
</p>
</li>
<li><p> R: Ruderal strategy score
</p>
</li>
<li><p> type: The dominant CSR strategy type
</p>
</li></ul>



<h3>References</h3>


<ol>
<li><p> Grime, J.P. (1974). Vegetation classification by reference to strategies. Nature, 250, 26–31.
</p>
</li>
<li><p> Pierce, S., Negreiros, D., Cerabolini, B.E.L., Kattge, J., Díaz, S., et al. (2017). A global method for calculating plant CSR ecological strategies applied across biomes world-wide. Funct Ecol, 31: 444-457.
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>LA &lt;- c(369615.7, 11.8, 55.7, 36061.2, 22391.8, 30068.1, 31059.5, 29895.1)
LDMC &lt;- c(25.2, 39.7, 13.3, 35.5, 33.2, 36.1, 35.2, 34.9)
SLA &lt;- c(17.4, 6.6, 34.1, 14.5, 8.1, 12.1, 9.4, 10.9)
traits &lt;- data.frame(LA, LDMC, SLA)
CSR(data = traits)

</code></pre>

<hr>
<h2 id='CSR_plot'>Create a ternary plot of CSR strategies</h2><span id='topic+CSR_plot'></span>

<h3>Description</h3>

<p>This function creates a ternary plot of Competition-Stress-Ruderal (CSR) strategies using the ggtern package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CSR_plot(
  data,
  point_size = 3,
  point_shape = 21,
  expand_margin = 1,
  custom_colors = c("#57C4AD", "#E6E1BC", "#EDA348", "#006165", "#F8E3EF", "#FFFF99",
    "#376CB1", "#B2589B", "#DC4325", "#F16C4E", "#85B97B", "#FCEB2D", "#04A89E",
    "#F49320", "#8F88C1", "#33B5D9", "#440153", "#B29BBD", "#28C865")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CSR_plot_+3A_data">data</code></td>
<td>
<p>A dataframe containing required columns: C, S, R (numeric values between 0-1)
and type (categorical classification)</p>
</td></tr>
<tr><td><code id="CSR_plot_+3A_point_size">point_size</code></td>
<td>
<p>Numeric, diameter of plot points (default = 3)</p>
</td></tr>
<tr><td><code id="CSR_plot_+3A_point_shape">point_shape</code></td>
<td>
<p>Numeric, symbol code for data points (default = 21, circle with border)</p>
</td></tr>
<tr><td><code id="CSR_plot_+3A_expand_margin">expand_margin</code></td>
<td>
<p>Numeric, coefficient for plot margin expansion (default = 1)</p>
</td></tr>
<tr><td><code id="CSR_plot_+3A_custom_colors">custom_colors</code></td>
<td>
<p>Character vector specifying hex color codes for categorical types</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements:
</p>

<ul>
<li><p> Configurable point attributes (size, shape)
</p>
</li>
<li><p> Adjustable plot boundaries
</p>
</li>
<li><p> User-defined color schemes for categories
</p>
</li>
<li><p> Automated legend column optimization
</p>
</li>
<li><p> Standardized legend positioning
</p>
</li>
<li><p> Reference grid and directional indicators
</p>
</li></ul>



<h3>Value</h3>

<p>A ggplot object representing the ternary plot of CSR strategies.
</p>


<h3>References</h3>


<ol>
<li><p> Grime, J.P. (1974). Vegetation classification by reference to strategies. Nature, 250, 26–31.
</p>
</li>
<li><p> Pierce, S., Negreiros, D., Cerabolini, B.E.L., Kattge, J., Díaz, S., et al. (2017). A global method for calculating plant CSR ecological strategies applied across biomes world-wide. Funct Ecol, 31: 444-457.
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>data(PFF)
head(PFF)
traits &lt;- data.frame(LA=PFF$Leaf_area, LDMC=PFF$LDMC, SLA=PFF$SLA)
head(traits)
result &lt;- CSR(data = traits)
head(result)
CSR_plot(data=result)

</code></pre>

<hr>
<h2 id='LHS'>Calculate LHS (Leaf-Height-Seed) Strategy</h2><span id='topic+LHS'></span>

<h3>Description</h3>

<p>This function calculates the LHS strategy for plant species based on their SLA (Specific Leaf Area),
Height, and Seed Mass values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LHS(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LHS_+3A_data">data</code></td>
<td>
<p>A data frame containing columns for SLA, Height, and SeedMass.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates median values for SLA, Height, and SeedMass from the input data.
It then determines the LHS strategy for each species based on whether its trait values are
less than or equal to (S) or greater than (L) the median values.
</p>
<p>The resulting strategy is a combination of three letters (S or L) representing Leaf (SLA),
Height, and Seed (SeedMass) respectively, separated by hyphens.
</p>


<h3>Value</h3>

<p>A data frame with an additional column 'LHS_strategy' containing the calculated LHS strategy.
</p>


<h3>References</h3>


<ol>
<li><p> Westoby, M. (1998). A leaf-height-seed (LHS) plant ecology strategy scheme. Plant and Soil, 199, 213–227. https://doi.org/10.1023/A:1004327224729
</p>
</li>
<li><p> Yang, J., Wang, Z., Zheng, Y., &amp; Pan, Y. (2022). Shifts in plant ecological strategies in remnant forest patches along urbanization gradients. Forest Ecology and Management, 524, 120540. https://doi.org/10.1016/j.foreco.2022.120540
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>data(PFF)
pff &lt;- PFF[, c("SLA", "Height", "SeedMass")]
result &lt;- LHS(pff)
head(result)

</code></pre>

<hr>
<h2 id='LHS_plot'>Generate a 3D scatterplot of plant traits</h2><span id='topic+LHS_plot'></span>

<h3>Description</h3>

<p>This function creates a three-dimensional scatterplot of plant traits (Specific Leaf Area, Height, and Seed Mass) based on the Leaf-Height-Seed (LHS) plant ecology strategy scheme.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LHS_plot(
  data,
  colors = c("#30123BFF", "#4777EFFF", "#1BD0D5FF", "#62FC6BFF", "#D2E935FF",
    "#FE9B2DFF", "#DB3A07FF", "#7A0403FF"),
  log_transform = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LHS_plot_+3A_data">data</code></td>
<td>
<p>A data frame containing columns: SLA, Height, SeedMass, and LHS_strategy.</p>
</td></tr>
<tr><td><code id="LHS_plot_+3A_colors">colors</code></td>
<td>
<p>A vector of colors for different LHS strategies. Default is a predefined color palette.</p>
</td></tr>
<tr><td><code id="LHS_plot_+3A_log_transform">log_transform</code></td>
<td>
<p>Logical, indicating whether to log-transform the data. Default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function performs the following steps:
Checks if the input data contains the required columns.
Converts LHS_strategy to a factor.
Optionally log-transforms the data based on the log_transform parameter.
Creates a 3D scatterplot using (potentially log-transformed) values of SLA, Height, and Seed Mass.
Colors points based on LHS strategy.
Adds a legend to identify different LHS strategies.
</p>


<h3>Value</h3>

<p>A 3D scatterplot of SLA, Height, and Seed Mass (optionally log-transformed), with points colored by LHS strategy.
</p>


<h3>References</h3>


<ol>
<li><p> Westoby, M. (1998). A leaf-height-seed (LHS) plant ecology strategy scheme. Plant and Soil, 199, 213–227. https://doi.org/10.1023/A:1004327224729
</p>
</li>
<li><p> Yang, J., Wang, Z., Zheng, Y., &amp; Pan, Y. (2022). Shifts in plant ecological strategies in remnant forest patches along urbanization gradients. Forest Ecology and Management, 524, 120540. https://doi.org/10.1016/j.foreco.2022.120540
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>data(PFF)
pff &lt;- PFF[, c("SLA", "Height", "SeedMass")]
result &lt;- LHS(pff)
LHS_plot(result)
LHS_plot(result, log_transform = FALSE)

</code></pre>

<hr>
<h2 id='LHS_strategy_scheme'>Create a table of Leaf-Height-Seed (LHS) strategy types</h2><span id='topic+LHS_strategy_scheme'></span>

<h3>Description</h3>

<p>This function generates a data frame containing different plant growth strategies
based on the Leaf-Height-Seed (LHS) scheme. Each strategy is described by a
combination of traits and their corresponding ecological interpretation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LHS_strategy_scheme()
</code></pre>


<h3>Value</h3>

<p>A data frame with two columns:
</p>

<dl>
<dt>type</dt><dd><p>Character vector of LHS strategy combinations (e.g., &quot;L-L-L&quot;, &quot;L-L-S&quot;, etc.)</p>
</dd>
<dt>strategy</dt><dd><p>Character vector describing the ecological strategy for each type</p>
</dd>
</dl>



<h3>References</h3>


<ol>
<li><p> Westoby, M. (1998). A leaf-height-seed (LHS) plant ecology strategy scheme. Plant and Soil, 199, 213–227. https://doi.org/10.1023/A:1004327224729
</p>
</li>
<li><p> Yang, J., Wang, Z., Zheng, Y., &amp; Pan, Y. (2022). Shifts in plant ecological strategies in remnant forest patches along urbanization gradients. Forest Ecology and Management, 524, 120540. https://doi.org/10.1016/j.foreco.2022.120540
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>LHS_strategy_scheme()

</code></pre>

<hr>
<h2 id='NPT'>Perform nested principal component analysis (PCA of PCAs) for ecological niche periodicity</h2><span id='topic+NPT'></span>

<h3>Description</h3>

<p>This function conducts a ‘PCA of PCAs’ to analyze
ecological niche periodicity based on multiple trait dimensions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NPT(data, dimension)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NPT_+3A_data">data</code></td>
<td>
<p>A data frame containing species trait data.</p>
</td></tr>
<tr><td><code id="NPT_+3A_dimension">dimension</code></td>
<td>
<p>A list of character vectors, each representing a trait dimension
with corresponding column names from the data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function performs the following steps:
</p>

<ol>
<li><p> Checks and cleans input data, removing rows with NA values
</p>
</li>
<li><p> Conducts first-level PCA for each trait dimension
</p>
</li>
<li><p> Extracts PC1 and PC2 scores from each first-level PCA
</p>
</li>
<li><p> Combines all PC scores and performs a second-level PCA
</p>
</li>
<li><p> Returns summary statistics and results from both levels of analysis
</p>
</li></ol>



<h3>Value</h3>

<p>A list containing three elements:
</p>
<table role = "presentation">
<tr><td><code>PCA_first</code></td>
<td>
<p>A data frame summarizing the first-level PCA results for each dimension</p>
</td></tr>
<tr><td><code>PCA_second</code></td>
<td>
<p>A matrix of species scores from the second-level PCA</p>
</td></tr>
<tr><td><code>result</code></td>
<td>
<p>The complete rda object from the second-level PCA</p>
</td></tr>
</table>


<h3>References</h3>


<ol>
<li><p> Winemiller, K. O., Fitzgerald, D. B., Bower, L. M., &amp; Pianka, E. R. (2015). Functional traits, convergent evolution, and periodic tables of niches. Ecology letters, 18(8), 737-751. https://doi.org/10.1111/ele.12462
</p>
</li>
<li><p> Yu, R., Huang, J., Xu, Y., Ding, Y., &amp; Zang, R. (2020). Plant functional niches in forests across four climatic zones: Exploring the periodic table of niches based on plant functional traits. Frontiers in Plant Science, 11, 841. https://doi.org/10.3389/fpls.2020.00841
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>data(PFF)
PFF[,3:20] &lt;- log(PFF[,3:20])
traits_dimension &lt;- list(
  grow = c("SLA","Leaf_area","LDMC","SRL","Leaf_Nmass","Leaf_Pmass","Root_Nmass"),
  survive = c("Height","Leaf_Cmass","Root_Cmass","Leaf_CN","Leaf_NP","Leaf_CP","Root_CN"),
  reproductive = c("SeedMass","FltDate","FltDur")
)
result &lt;- NPT(data = PFF, dimension = traits_dimension)
result

</code></pre>

<hr>
<h2 id='NPT_plot'>Plot results from nested principal component analysis</h2><span id='topic+NPT_plot'></span>

<h3>Description</h3>

<p>This function creates a visualization of the results from the nested principal
component analysis (NPT function) for ecological niche periodicity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NPT_plot(pca_obj, group = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NPT_plot_+3A_pca_obj">pca_obj</code></td>
<td>
<p>An rda object returned by the second-level PCA in the NPT function.</p>
</td></tr>
<tr><td><code id="NPT_plot_+3A_group">group</code></td>
<td>
<p>A vector or factor specifying the grouping of samples.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function creates a biplot that includes:
</p>

<ol>
<li><p> Sample points colored by group
</p>
</li>
<li><p> Species scores represented as arrows
</p>
</li>
<li><p> Species labels positioned using ggrepel to avoid overlapping
</p>
</li></ol>

<p>The plot also includes dashed lines at x=0 and y=0, and displays the percentage
of variance explained by each principal component on the axes.
</p>


<h3>Value</h3>

<p>A ggplot object representing a biplot of species scores and sample points.
</p>


<h3>References</h3>


<ol>
<li><p> Winemiller, K. O., Fitzgerald, D. B., Bower, L. M., &amp; Pianka, E. R. (2015). Functional traits, convergent evolution, and periodic tables of niches. Ecology letters, 18(8), 737-751. https://doi.org/10.1111/ele.12462
</p>
</li>
<li><p> Yu, R., Huang, J., Xu, Y., Ding, Y., &amp; Zang, R. (2020). Plant functional niches in forests across four climatic zones: Exploring the periodic table of niches based on plant functional traits. Frontiers in Plant Science, 11, 841. https://doi.org/10.3389/fpls.2020.00841
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>data(PFF)
PFF[,3:20] &lt;- log(PFF[,3:20])
PFF &lt;- na.omit(PFF)
traits_dimension &lt;- list(
  grow = c("SLA","Leaf_area","LDMC","SRL","Leaf_Nmass","Leaf_Pmass","Root_Nmass"),
  survive = c("Height","Leaf_Cmass","Root_Cmass","Leaf_CN","Leaf_NP","Leaf_CP","Root_CN"),
  reproductive = c("SeedMass","FltDate","FltDur")
)
npt_result &lt;- NPT(data = PFF, dimension = traits_dimension)
dev.new() # A window that is too small will interfere with the drawing.
          # Optionally, you can set the drawing window to pop up automatically.
NPT_plot(npt_result$result)
NPT_plot(npt_result$result, PFF$family)

</code></pre>

<hr>
<h2 id='PFF'>Plant Functional Traits Dataset from Ponderosa Pine Forests Flora (PFF)</h2><span id='topic+PFF'></span>

<h3>Description</h3>

<p>A dataset containing functional traits for 133 plant species commonly found in
southwestern USA Pinus ponderosa var. scopulorum P. &amp; C. Lawson (ponderosa pine) forests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PFF
</code></pre>


<h3>Format</h3>

<p>A data frame with 137 rows and 20 variables:
</p>

<dl>
<dt>family</dt><dd><p>Plant family</p>
</dd>
<dt>species</dt><dd><p>Plant species</p>
</dd>
<dt>Height</dt><dd><p>Canopy height (cm)</p>
</dd>
<dt>Leaf_area</dt><dd><p>Leaf area (mm^2)</p>
</dd>
<dt>LDMC</dt><dd><p>Leaf dry matter content (%)</p>
</dd>
<dt>SLA</dt><dd><p>Specific leaf area (mm^2/mg)</p>
</dd>
<dt>SRL</dt><dd><p>Specific root length (m/g)</p>
</dd>
<dt>SeedMass</dt><dd><p>Seed mass (mg)</p>
</dd>
<dt>FltDate</dt><dd><p>mean Flowering date (Julian day)</p>
</dd>
<dt>FltDur</dt><dd><p>mean Flowering duration (days)</p>
</dd>
<dt>k_value</dt><dd><p>decomposition decay constant, where proportion of original mass remaining = exp(- k-value*0.926)</p>
</dd>
<dt>Leaf_Cmass</dt><dd><p>Leaf carbon content (% dry mass)</p>
</dd>
<dt>Leaf_Nmass</dt><dd><p>Leaf nitrogen content (% dry mass)</p>
</dd>
<dt>Leaf_CN</dt><dd><p>Leaf carbon to nitrogen ratio</p>
</dd>
<dt>Leaf_Pmass</dt><dd><p>Leaf phosphorus content (% dry mass)</p>
</dd>
<dt>Leaf_NP</dt><dd><p>Leaf nitrogen to phosphorus ratio</p>
</dd>
<dt>Leaf_CP</dt><dd><p>Leaf carbon to phosphorus ratio</p>
</dd>
<dt>Root_Cmass</dt><dd><p>Root carbon content (% dry mass)</p>
</dd>
<dt>Root_Nmass</dt><dd><p>Root nitrogen content (% dry mass)</p>
</dd>
<dt>Root_CN</dt><dd><p>Root carbon to nitrogen ratio</p>
</dd>
</dl>



<h3>Details</h3>

<p>This dataset contains measurements of a core set of functional traits that reflect
aspects of each species' ability to disperse, establish, acquire water and nutrients,
and photosynthesize. Traits include specific leaf area (SLA), height, seed mass,
specific root length (SRL), leaf and fine root nitrogen concentration, leaf phosphorus
concentration, and leaf dry matter content (LDMC). Julian flowering date and flowering
duration were also obtained for each species. Leaf litter decomposition rates were
measured on 103 species.
</p>


<h3>Source</h3>

<p>Laughlin, D. C., Leppert, J. J., Moore, M. M., &amp; Sieg, C. H. (2010). A multi-trait test
of the leaf-height-seed plant strategy scheme with 133 species from a pine forest flora.
Functional Ecology, 24(3), 485-700.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PFF)
head(PFF)
</code></pre>

<hr>
<h2 id='Strate_CSR'>Calculate CSR (Competition-Stress-Ruderal) Strategy</h2><span id='topic+Strate_CSR'></span>

<h3>Description</h3>

<p>This function calculates the CSR strategy based on leaf traits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Strate_CSR(LA, LDMC, SLA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Strate_CSR_+3A_la">LA</code></td>
<td>
<p>Leaf area in mm^2</p>
</td></tr>
<tr><td><code id="Strate_CSR_+3A_ldmc">LDMC</code></td>
<td>
<p>Leaf dry matter content in %</p>
</td></tr>
<tr><td><code id="Strate_CSR_+3A_sla">SLA</code></td>
<td>
<p>Specific leaf area in mm^2/mg</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li> <p><code>C</code>: Proportion of competition strategy
</p>
</li>
<li> <p><code>S</code>: Proportion of stress-tolerance strategy
</p>
</li>
<li> <p><code>R</code>: Proportion of ruderal strategy
</p>
</li>
<li> <p><code>type</code>: Type of CSR strategy
</p>
</li></ul>



<h3>References</h3>


<ol>
<li><p> Grime, J.P. (1974). Vegetation classification by reference to strategies. Nature, 250, 26–31.
</p>
</li>
<li><p> Pierce, S., Negreiros, D., Cerabolini, B.E.L., Kattge, J., Díaz, S., et al. (2017). A global method for calculating plant CSR ecological strategies applied across biomes world-wide. Funct Ecol, 31: 444-457.
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>Strate_CSR(LA = 369615.7, LDMC = 25.2, SLA = 17.4)

</code></pre>

<hr>
<h2 id='TN'>Generate Plant Trait Network</h2><span id='topic+TN'></span>

<h3>Description</h3>

<p>This function creates a network graph from a plant trait correlation matrix, applying thresholds for correlation strength and significance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TN(traits_matrix, rThres = 0.2, pThres = 0.05, method = "pearson")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TN_+3A_traits_matrix">traits_matrix</code></td>
<td>
<p>A numeric matrix where each column represents a plant trait and each row represents a sample.</p>
</td></tr>
<tr><td><code id="TN_+3A_rthres">rThres</code></td>
<td>
<p>Numeric, threshold for correlation coefficient, default is 0.2. Correlations with absolute values below this threshold are set to zero.</p>
</td></tr>
<tr><td><code id="TN_+3A_pthres">pThres</code></td>
<td>
<p>Numeric, threshold for p-value, default is 0.05. Only correlations with p-values below this threshold are included in the network.</p>
</td></tr>
<tr><td><code id="TN_+3A_method">method</code></td>
<td>
<p>Character, specifies the correlation method to use: &quot;pearson&quot; (default) or &quot;spearman&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function performs the following steps:
</p>

<ol>
<li><p> Calculates Pearson correlation coefficients and p-values for the trait matrix.
</p>
</li>
<li><p> Applies correlation coefficient and p-value thresholds to filter relationships.
</p>
</li>
<li><p> Constructs a weighted undirected graph from the filtered correlation matrix.
</p>
</li>
<li><p> Removes self-loops and isolated nodes from the graph.
</p>
</li>
<li><p> Adds correlation coefficients as edge attributes.
</p>
</li></ol>



<h3>Value</h3>

<p>Returns an igraph object representing the trait network.
</p>


<h3>References</h3>


<ol>
<li><p> He, N., Li, Y., Liu, C., et al. (2020). Plant trait networks: improved resolution of the dimensionality of adaptation. Trends in Ecology &amp; Evolution, 35(10), 908-918. https://doi.org/10.1016/j.tree.2020.06.003
</p>
</li>
<li><p> Li, Y., Liu, C., Sack, L., Xu, L., Li, M., Zhang, J., &amp; He, N. (2022). Leaf trait network architecture shifts with species‐richness and climate across forests at continental scale. Ecology Letters, 25(6), 1442-1457. https://doi.org/10.1111/ele.14009
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>data(PFF)
PFF_traits &lt;- PFF[, c("Height", "Leaf_area","LDMC","SLA","SRL","SeedMass","FltDate",
                      "FltDur","Leaf_Cmass","Leaf_Nmass","Leaf_CN","Leaf_Pmass",
                      "Leaf_NP","Leaf_CP","Root_Cmass","Root_Nmass","Root_CN")]
PFF_traits &lt;- na.omit(PFF_traits)
head(PFF_traits)
Tn_result &lt;- TN(traits_matrix = PFF_traits, rThres = 0.2, pThres = 0.05, method = "pearson")
Tn_result

</code></pre>

<hr>
<h2 id='TN_corr'>Calculate and Visualize Plant Trait Correlation Network</h2><span id='topic+TN_corr'></span>

<h3>Description</h3>

<p>This function calculates correlation coefficients for given plant traits and generates a correlation network plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TN_corr(traits_matrix, rThres = 0.2, pThres = 0.05, method = "pearson")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TN_corr_+3A_traits_matrix">traits_matrix</code></td>
<td>
<p>A numeric matrix where each column represents a plant trait and each row represents a sample.</p>
</td></tr>
<tr><td><code id="TN_corr_+3A_rthres">rThres</code></td>
<td>
<p>Numeric, threshold for correlation coefficient, default is 0.2. Only correlations with absolute values above this threshold will be displayed in the plot.</p>
</td></tr>
<tr><td><code id="TN_corr_+3A_pthres">pThres</code></td>
<td>
<p>Numeric, threshold for p-value, default is 0.05. Only correlations with p-values below this threshold will be displayed in the plot.</p>
</td></tr>
<tr><td><code id="TN_corr_+3A_method">method</code></td>
<td>
<p>Character, specifies the correlation method to use: &quot;pearson&quot; (default) or &quot;spearman&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function first calculates Pearson correlation coefficients between traits, then adjusts p-values using the FDR method.
Finally, it plots the correlation network using the corrplot package. The plot displays only correlations that meet both the correlation coefficient and p-value thresholds.
</p>


<h3>Value</h3>

<p>Returns a correlation network plot object.
</p>


<h3>References</h3>


<ol>
<li><p> He, N., Li, Y., Liu, C., et al. (2020). Plant trait networks: improved resolution of the dimensionality of adaptation. Trends in Ecology &amp; Evolution, 35(10), 908-918. https://doi.org/10.1016/j.tree.2020.06.003
</p>
</li>
<li><p> Li, Y., Liu, C., Sack, L., Xu, L., Li, M., Zhang, J., &amp; He, N. (2022). Leaf trait network architecture shifts with species‐richness and climate across forests at continental scale. Ecology Letters, 25(6), 1442-1457. https://doi.org/10.1111/ele.14009
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>data(PFF)
PFF_traits &lt;- PFF[, c("Height", "Leaf_area","LDMC","SLA","SRL","SeedMass","FltDate",
                      "FltDur","Leaf_Cmass","Leaf_Nmass","Leaf_CN","Leaf_Pmass",
                      "Leaf_NP","Leaf_CP","Root_Cmass","Root_Nmass","Root_CN")]
PFF_traits &lt;- na.omit(PFF_traits)
head(PFF_traits)
TN_corr(traits_matrix = PFF_traits, rThres = 0.3, pThres = 0.01,method = "pearson")

</code></pre>

<hr>
<h2 id='TN_metrics'>Calculate Node and Global Metrics for Trait Networks</h2><span id='topic+TN_metrics'></span>

<h3>Description</h3>

<p>This function computes various node and global metrics for a trait network graph.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TN_metrics(graph)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TN_metrics_+3A_graph">graph</code></td>
<td>
<p>An igraph object representing the trait network, typically generated by the <code>TN</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing two data frames:
</p>
<table role = "presentation">
<tr><td><code>node</code></td>
<td>
<p>A data frame with node-level metrics including degree, closeness, betweenness, and local clustering coefficient.</p>
</td></tr>
<tr><td><code>global</code></td>
<td>
<p>A data frame with global metrics including edge density, diameter, average path length, average clustering coefficient, and modularity.</p>
</td></tr>
</table>


<h3>References</h3>


<ol>
<li><p> He, N., Li, Y., Liu, C., et al. (2020). Plant trait networks: improved resolution of the dimensionality of adaptation. Trends in Ecology &amp; Evolution, 35(10), 908-918. https://doi.org/10.1016/j.tree.2020.06.003
</p>
</li>
<li><p> Li, Y., Liu, C., Sack, L., Xu, L., Li, M., Zhang, J., &amp; He, N. (2022). Leaf trait network architecture shifts with species‐richness and climate across forests at continental scale. Ecology Letters, 25(6), 1442-1457. https://doi.org/10.1111/ele.14009
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>data(PFF)
PFF_traits &lt;- PFF[, c("Height", "Leaf_area","LDMC","SLA","SRL","SeedMass","FltDate",
                      "FltDur","Leaf_Cmass","Leaf_Nmass","Leaf_CN","Leaf_Pmass",
                      "Leaf_NP","Leaf_CP","Root_Cmass","Root_Nmass","Root_CN")]
PFF_traits &lt;- na.omit(PFF_traits)
head(PFF_traits)
Tn_result &lt;- TN(traits_matrix = PFF_traits, rThres = 0.2, pThres = 0.05)
TN_metrics(Tn_result)

</code></pre>

<hr>
<h2 id='TN_plot'>Plot Trait Network Graph</h2><span id='topic+TN_plot'></span>

<h3>Description</h3>

<p>This function visualizes the trait network graph generated by the <code>TN</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TN_plot(graph, style = 1, vertex.size = 20, vertex.label.cex = 0.6)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TN_plot_+3A_graph">graph</code></td>
<td>
<p>An igraph object representing the trait network.</p>
</td></tr>
<tr><td><code id="TN_plot_+3A_style">style</code></td>
<td>
<p>A numeric value that determines the plotting style (default is 1).</p>
</td></tr>
<tr><td><code id="TN_plot_+3A_vertex.size">vertex.size</code></td>
<td>
<p>Numeric value for the size of vertices in the plot (default is 20).</p>
</td></tr>
<tr><td><code id="TN_plot_+3A_vertex.label.cex">vertex.label.cex</code></td>
<td>
<p>Numeric value for the scaling factor of vertex labels (default is 0.6).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses the <code>cluster_fast_greedy</code> algorithm to identify communities
in the graph and assigns community membership to vertices. It offers two
plotting styles:
</p>

<ul>
<li><p> Style 1: Plots the community structure.
</p>
</li>
<li><p> Style 2: Plots the graph in a circular layout with vertex colors representing communities.
The vertex size and label size can be customized using vertex.size and vertex.label.cex parameters respectively.
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class <code>igraph</code>. This function generates a visualization of the trait network graph.
When style = 1, it displays a community structure plot.
When style = 2, it displays a circular layout plot where vertex colors represent community membership,
edge thickness represents correlation strength, and edge color represents the sign of the correlation (black for positive, red for negative).
</p>


<h3>References</h3>


<ol>
<li><p> He, N., Li, Y., Liu, C., et al. (2020). Plant trait networks: improved resolution of the dimensionality of adaptation. Trends in Ecology &amp; Evolution, 35(10), 908-918. https://doi.org/10.1016/j.tree.2020.06.003
</p>
</li>
<li><p> Li, Y., Liu, C., Sack, L., Xu, L., Li, M., Zhang, J., &amp; He, N. (2022). Leaf trait network architecture shifts with species‐richness and climate across forests at continental scale. Ecology Letters, 25(6), 1442-1457. https://doi.org/10.1111/ele.14009
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>data(PFF)
PFF_traits &lt;- PFF[, c("Height", "Leaf_area","LDMC","SLA","SRL","SeedMass","FltDate",
                      "FltDur","Leaf_Cmass","Leaf_Nmass","Leaf_CN","Leaf_Pmass",
                      "Leaf_NP","Leaf_CP","Root_Cmass","Root_Nmass","Root_CN")]
PFF_traits &lt;- na.omit(PFF_traits)
head(PFF_traits)
Tn_result &lt;- TN(traits_matrix = PFF_traits, rThres = 0.2, pThres = 0.05)
TN_plot(Tn_result, style = 1, vertex.size = 20, vertex.label.cex = 0.6)
TN_plot(Tn_result, style = 2, vertex.size = 20, vertex.label.cex = 0.6)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
