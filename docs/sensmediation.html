<!DOCTYPE html><html><head><title>Help for package sensmediation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sensmediation}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calc.effects'><p>Function for estimation of natural direct and indirect effects and sensitivity analysis for unobserved mediator-outcome confounding</p></a></li>
<li><a href='#coefs.sensmed'><p>ML estimation of regression parameters for calculation of direct and indirect effects under unobserved confounding</p></a></li>
<li><a href='#effects'><p>Functions to calculate natural direct and indirect effects.</p></a></li>
<li><a href='#grr'><p>Analytic gradients of the loglikelihood functions for ML estimation of regression parameters</p></a></li>
<li><a href='#hess'><p>Analytic Hessians of the loglikelihood functions for ML estimation of regression parameters</p></a></li>
<li><a href='#LogL'><p>Implementation of loglikelihood functions for ML estimation of regression parameters</p></a></li>
<li><a href='#ML'><p>Functions for ML estimation of regression parameters for sensitivity analysis</p></a></li>
<li><a href='#more.effects'><p>Estimate additional natural direct and indirect effects based on an <code>"effectsMed"</code> object</p></a></li>
<li><a href='#partdevs'><p>Implementations of the partial derivatives (gradients) of the expressions for the direct, indirect and total effects. Used to calculate standard errors (delta method).</p></a></li>
<li><a href='#plot.effectsMed'><p>Plot function for objects of class <code>"effectsMed"</code></p></a></li>
<li><a href='#RSdata'><p>Example data for the functions in sensmediation</p></a></li>
<li><a href='#sensmediation'><p>Estimate natural direct and indirect effects based on parametric regression models and perform sensitivity analysis</p></a></li>
<li><a href='#stderrs'><p>Functions to calculate standard errors of the direct, indirect and total effects using the delta method.</p></a></li>
<li><a href='#summary.effectsMed'><p>Summary function for objects of class <code>"effectsMed"</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Parametric Estimation and Sensitivity Analysis of Direct and
Indirect Effects</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-05-28</td>
</tr>
<tr>
<td>Author:</td>
<td>Anita Lindmark &lt;anita.lindmark@umu.se&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Anita Lindmark &lt;anita.lindmark@umu.se&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>We implement functions to estimate and perform sensitivity analysis to unobserved confounding of direct and indirect effects introduced in Lindmark, de Luna and Eriksson (2018) &lt;<a href="https://doi.org/10.1002%2Fsim.7620">doi:10.1002/sim.7620</a>&gt;. The estimation and sensitivity analysis are parametric, based on probit and/or linear regression models. Sensitivity analysis is implemented for unobserved confounding of the exposure-mediator, mediator-outcome and exposure-outcome relationships. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>maxLik (&ge; 1.3-4), mvtnorm (&ge; 1.0-8), stats</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Collate:</td>
<td>'calc.effects.R' 'coefs.sensmed.R' 'data.R'
'mediationmethods.R' 'sensmediation.R'</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 2.1.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-06-03 08:11:03 UTC; anli0053</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-06-03 08:40:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='calc.effects'>Function for estimation of natural direct and indirect effects and sensitivity analysis for unobserved mediator-outcome confounding</h2><span id='topic+calc.effects'></span>

<h3>Description</h3>

<p>Function to estimate natural direct and indirect effect estimates and standard errors (using the delta method) based on parametric regression models and perform sensitivity analysis for unobserved confounding.
Intended to be called through <code><a href="#topic+sensmediation">sensmediation</a></code> (or <code><a href="#topic+more.effects">more.effects</a></code>),  not on its own.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc.effects(ML.object, type = "my", exp.name, med.name,
  covariates = NULL, alt.decomposition = FALSE, exp.value = 1,
  control.value = 0, med.model = NULL, out.model = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc.effects_+3A_ml.object">ML.object</code></td>
<td>
<p>object from <code><a href="#topic+coefs.sensmed">coefs.sensmed</a></code></p>
</td></tr>
<tr><td><code id="calc.effects_+3A_type">type</code></td>
<td>
<p>the type of confounding for which the sensitivity analysis is to be performed. <code>type = "my"</code>,  the default, corresponds to unobserved mediator-outcome
confounding,  <code>type = "zm"</code> to exposure-mediator confounding and <code>type = "zy"</code> to exposure-outcome confounding.</p>
</td></tr>
<tr><td><code id="calc.effects_+3A_exp.name">exp.name</code></td>
<td>
<p>A character string indicating the name of the exposure variable used in the models.</p>
</td></tr>
<tr><td><code id="calc.effects_+3A_med.name">med.name</code></td>
<td>
<p>A character string indicating the name of the mediator used in the models.</p>
</td></tr>
<tr><td><code id="calc.effects_+3A_covariates">covariates</code></td>
<td>
<p>if conditional effects are to be estimated the list of covariate values. Covariates not specified are marginalized over. For more information, see <code><a href="#topic+sensmediation">sensmediation</a></code>.</p>
</td></tr>
<tr><td><code id="calc.effects_+3A_alt.decomposition">alt.decomposition</code></td>
<td>
<p>logical indicating whether alternative definitions of the direct and indirect effects should be used (for more information, see <code><a href="#topic+sensmediation">sensmediation</a></code>).</p>
</td></tr>
<tr><td><code id="calc.effects_+3A_exp.value">exp.value</code></td>
<td>
<p>value of the exposure variable used as the exposure condition, default is 1.</p>
</td></tr>
<tr><td><code id="calc.effects_+3A_control.value">control.value</code></td>
<td>
<p>value of the exposure variable used as the control (unexposed) condition, default is 0.</p>
</td></tr>
<tr><td><code id="calc.effects_+3A_med.model">med.model</code></td>
<td>
<p>If <code>type = "zy"</code>,  fitted <code><a href="stats.html#topic+glm">glm</a></code> model object representing the mediator model at the basis of the estimation.</p>
</td></tr>
<tr><td><code id="calc.effects_+3A_out.model">out.model</code></td>
<td>
<p>If <code>type = "zm"</code>,  fitted <code><a href="stats.html#topic+glm">glm</a></code> model object representing the outcome model at the basis of the estimation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements:
</p>
<table>
<tr><td><code>effects</code></td>
<td>
<p>A list with elements <code>NIE</code> and <code>NDE</code>,  row matrices with the estimated NIE and NDE (or NIE* and NDE* if <code>alt.decomposition = TRUE</code>) for each value of the sensitivity parameter <code>Rho</code>.</p>
</td></tr>
<tr><td><code>std.errs</code></td>
<td>
<p>A list with elements <code>se.nie</code> and <code>se.nde</code>,  row matrices with the estimated standard errors for the natural direct and indirect effects for the different values of the sensitivity parameter <code>Rho</code>.</p>
</td></tr>
<tr><td><code>betas</code></td>
<td>
<p>list of the estimated mediator model parameters over <code>Rho</code>, with
</p>

<ul>
<li> <p><code>beta0</code> Intercept
</p>
</li>
<li> <p><code>beta1</code> Exposure
</p>
</li>
<li> <p><code>beta2</code> Covariates
</p>
</li>
<li> <p><code>beta3</code> Exposure-covariate interactions
</p>
</li></ul>

<p>Components that are not included in the input mediator model are set to 0.</p>
</td></tr>
<tr><td><code>thetas</code></td>
<td>
<p>list of the estimated outcome model parameters over <code>Rho</code>, with
</p>

<ul>
<li> <p><code>theta0</code> Intercept
</p>
</li>
<li> <p><code>theta1</code> Exposure
</p>
</li>
<li> <p><code>theta2</code> Mediator
</p>
</li>
<li> <p><code>theta3</code> Exposure-mediator interaction
</p>
</li>
<li> <p><code>theta4</code> Covariates
</p>
</li>
<li> <p><code>theta5</code> Exposure-covariate interactions
</p>
</li>
<li> <p><code>theta6</code> Mediator-covariate interactions
</p>
</li>
<li> <p><code>theta7</code> Exposure-mediator-covariate interactions
</p>
</li></ul>

<p>Components that are not included in the input outcome model are set to 0.</p>
</td></tr>
<tr><td><code>part.deriv</code></td>
<td>
<p>List with the partial derivatives of the NDE (Lambda), NIE (Gamma) and TE (Eta) wrt the mediator and outcome model parameters for each value of <code>Rho</code></p>
</td></tr>
<tr><td><code>sigma.thetabeta</code></td>
<td>
<p>a list with the joint covariance matrix of the outcome and mediator model parameters for each value of <code>Rho</code>. Note that the covariance matrix is constructed for all estimated parameters listed in <code>betas</code> and <code>thetas</code> but that components not included in the input mediator and outcome models are set to 0.</p>
</td></tr>
<tr><td><code>covariates</code></td>
<td>
<p>list of the covariate values that the effects are conditioned on.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Anita Lindmark
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sensmediation">sensmediation</a></code>
</p>

<hr>
<h2 id='coefs.sensmed'>ML estimation of regression parameters for calculation of direct and indirect effects under unobserved confounding</h2><span id='topic+coefs.sensmed'></span>

<h3>Description</h3>

<p>This function gives ML estimates of the regression parameters used to calculate mediation effects and perform sensitivity analysis. The optimization is
performed using <code><a href="maxLik.html#topic+maxLik">maxLik</a></code>, see Details for more information. Called by <code><a href="#topic+sensmediation">sensmediation</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coefs.sensmed(model.expl, model.resp, Rho, progress = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coefs.sensmed_+3A_model.expl">model.expl</code></td>
<td>
<p>Fitted <code><a href="stats.html#topic+glm">glm</a></code> model object. If sensitivity analysis to mediator-outcome confounding the mediator model. Otherwise the exposure model.</p>
</td></tr>
<tr><td><code id="coefs.sensmed_+3A_model.resp">model.resp</code></td>
<td>
<p>Fitted <code><a href="stats.html#topic+glm">glm</a></code> model object. If sensitivity analysis to exposure-mediator confounding the mediator model. Otherwise the outcome model.</p>
</td></tr>
<tr><td><code id="coefs.sensmed_+3A_rho">Rho</code></td>
<td>
<p>The sensitivity parameter vector. If <code>type="my"</code> the correlation between the error terms in the mediator and outcome models. If <code>type="zm"</code> the correlation between the error terms in the exposure and mediator models. If <code>type="zy"</code> the correlation between the error terms in the exposure and outcome models.</p>
</td></tr>
<tr><td><code id="coefs.sensmed_+3A_progress">progress</code></td>
<td>
<p>Logical, indicating whether or not the progress (i.e. the <code><a href="base.html#topic+proc.time">proc.time</a></code> for each <code>Rho</code>) of the optimization will be output</p>
</td></tr>
<tr><td><code id="coefs.sensmed_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed on to the <code>maxLik</code> function. Can be used to set the <code>method</code> and <code>control</code> arguments of the <code>maxLik</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The maximization of the log-likelihood is performed using <code><a href="maxLik.html#topic+maxLik">maxLik</a></code>, the default is to use the Newton-Raphson method and an analytic gradient and Hessian.
</p>


<h3>Value</h3>

<p><code>coefs.sensmed</code> returns a list with elements:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The matched call</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A matrix with the estimated regression parameters for <code>model.resp</code> over the range of <code>Rho</code>. One column per value of <code>Rho</code>.</p>
</td></tr>
<tr><td><code>sigma.res.resp</code></td>
<td>
<p>If <code>model.resp</code> is a linear regression model, the estimated standard deviation of the error term for each <code>Rho</code>.</p>
</td></tr>
<tr><td><code>sigma.res.expl</code></td>
<td>
<p>If <code>model.expl</code> is a linear regression model, the estimated standard deviation of the error term for each <code>Rho</code>.</p>
</td></tr>
<tr><td><code>Rho</code></td>
<td>
<p>The sensitivity parameter vector.</p>
</td></tr>
<tr><td><code>expl.coef</code></td>
<td>
<p>A matrix with the estimated regression parameters for <code>model.expl</code> over the range of <code>Rho</code>. One column per value of <code>Rho</code>.</p>
</td></tr>
<tr><td><code>model.expl</code></td>
<td>
<p>the original fitted <code>glm</code> object of <code>model.expl</code>.</p>
</td></tr>
<tr><td><code>model.resp</code></td>
<td>
<p>the original fitted <code>glm</code> object of <code>model.resp</code>.</p>
</td></tr>
<tr><td><code>X.expl</code></td>
<td>
<p>The model matrix (see <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>) of <code>model.expl</code></p>
</td></tr>
<tr><td><code>X.resp</code></td>
<td>
<p>The model matrix (see <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>) of <code>model.resp</code></p>
</td></tr>
<tr><td><code>outc.resp</code></td>
<td>
<p>The outcome variable of <code>model.resp</code>.</p>
</td></tr>
<tr><td><code>outc.expl</code></td>
<td>
<p>The outcome variable of <code>model.expl</code>.</p>
</td></tr>
<tr><td><code>sigmas</code></td>
<td>
<p>A list with the estimated covariance matrices for the regression parameters of <code>model.resp</code> and <code>model.expl</code> over <code>Rho</code>.</p>
</td></tr>
<tr><td><code>max.info</code></td>
<td>
<p>Information about the maximization (whether or not the convergence was successful, <code>message</code>, <code>method</code> and number of iterations) for each <code>Rho</code>, see <code><a href="maxLik.html#topic+maxLik">maxLik</a></code> for more information.</p>
</td></tr>
<tr><td><code>value</code></td>
<td>
<p>The values of the loglikelihood function for the best set of regression parameters from the optimization for each <code>Rho</code>, see <code><a href="maxLik.html#topic+maxLik">maxLik</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Anita Lindmark
</p>


<h3>References</h3>

<p>Henningsen, A., Toomet, O. (2011). maxLik: A Package for Maximum Likelihood Estimation in R, <em>Computational Statistics</em>, <b>26(3)</b>, pp. 443&ndash;458.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sensmediation">sensmediation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# Example with data from Riksstroke (the Swedish stroke register)

data(RSdata)

# Probit mediator and outcome models:
m.model &lt;- glm(lowered.consc ~ AF + age.cat + sex, data = RSdata,
   family = binomial(link = 'probit'))
o.model &lt;- glm(cf.3mo ~ AF + lowered.consc + age.cat + sex, data = RSdata,
   family = binomial(link = 'probit'))

# Estimation of regression coefficients under different values of Rho
# Rho = correlation between error terms in mediator and outcome model:
coefs.MY &lt;- coefs.sensmed(model.expl = m.model, model.resp = o.model, Rho = seq(0, 0.5, 0.1))
# Outcome model regression coefficients:
coefs.MY$coef

## End(Not run)

</code></pre>

<hr>
<h2 id='effects'>Functions to calculate natural direct and indirect effects.</h2><span id='topic+effects'></span><span id='topic+eff.bb'></span><span id='topic+eff.bc'></span><span id='topic+eff.cb'></span><span id='topic+eff.cc'></span>

<h3>Description</h3>

<p>Functions used to calculate natural direct and indirect effects based on the estimated regression parameters. Called by <code><a href="#topic+calc.effects">calc.effects</a></code>.
The functions are named according to the convention <code>eff."mediator model type""outcome model type"</code> where <code>b</code>
stands for binary probit regression and <code>c</code> stands for linear regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eff.bb(Rho, betas, thetas, x.med, x.out, alt.decomposition, exp.value,
  control.value)

eff.bc(Rho, betas, thetas, x.med, x.out, alt.decomposition, exp.value,
  control.value)

eff.cb(Rho, betas, thetas, sigma.eta, x.med, x.out, alt.decomposition,
  exp.value, control.value)

eff.cc(Rho, betas, thetas, x.med, x.out, alt.decomposition, exp.value,
  control.value)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="effects_+3A_rho">Rho</code></td>
<td>
<p>The sensitivity parameter vector.</p>
</td></tr>
<tr><td><code id="effects_+3A_betas">betas</code></td>
<td>
<p>List of mediator regression parameters</p>
</td></tr>
<tr><td><code id="effects_+3A_thetas">thetas</code></td>
<td>
<p>List of outcome regression parameters</p>
</td></tr>
<tr><td><code id="effects_+3A_x.med">x.med</code></td>
<td>
<p>Mediator covariate matrix for which to calculate standard errors</p>
</td></tr>
<tr><td><code id="effects_+3A_x.out">x.out</code></td>
<td>
<p>Outcome covariate matrix for which to calculate standard errors</p>
</td></tr>
<tr><td><code id="effects_+3A_alt.decomposition">alt.decomposition</code></td>
<td>
<p>logical indicating whether or not alternative definitions of the direct and indirect effects should be used.</p>
</td></tr>
<tr><td><code id="effects_+3A_exp.value">exp.value</code></td>
<td>
<p>value of the exposure variable used as the exposure condition.</p>
</td></tr>
<tr><td><code id="effects_+3A_control.value">control.value</code></td>
<td>
<p>value of the exposure variable used as the control (unexposed) condition.</p>
</td></tr>
<tr><td><code id="effects_+3A_sigma.eta">sigma.eta</code></td>
<td>
<p>For a continuous mediator and binary outcome, matrix with the estimated residual standard deviation for the mediator model over the range of <code>Rho</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='grr'>Analytic gradients of the loglikelihood functions for ML estimation of regression parameters</h2><span id='topic+grr'></span><span id='topic+grr.bb'></span><span id='topic+grr.bc'></span><span id='topic+grr.cb'></span><span id='topic+grr.cc'></span>

<h3>Description</h3>

<p>Implementation of the analytic gradients of the loglikelihood functions for ML estimation of regression parameters for different combinations of
exposure, mediator and outcome models. The functions are named according to the convention <code>grr."model.expl type""model.resp type"</code> where <code>b</code>
stands for binary probit regression and <code>c</code> stands for linear regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grr.bb(par, Rho, X.expl = X.expl, X.resp = X.resp,
  outc.resp = outc.resp, outc.expl = outc.expl)

grr.bc(par, Rho, X.expl = X.expl, X.resp = X.resp,
  outc.resp = outc.resp, outc.expl = outc.expl)

grr.cb(par, Rho, X.expl = X.expl, X.resp = X.resp,
  outc.resp = outc.resp, outc.expl = outc.expl)

grr.cc(par, Rho, X.expl = X.expl, X.resp = X.resp,
  outc.resp = outc.resp, outc.expl = outc.expl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grr_+3A_par">par</code></td>
<td>
<p>Vector of parameter values.</p>
</td></tr>
<tr><td><code id="grr_+3A_rho">Rho</code></td>
<td>
<p>The value of the sensitivity parameter.</p>
</td></tr>
<tr><td><code id="grr_+3A_x.expl">X.expl</code></td>
<td>
<p>The model matrix (see <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>) of <code>model.expl</code></p>
</td></tr>
<tr><td><code id="grr_+3A_x.resp">X.resp</code></td>
<td>
<p>The model matrix (see <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>) of <code>model.resp</code></p>
</td></tr>
<tr><td><code id="grr_+3A_outc.resp">outc.resp</code></td>
<td>
<p>The outcome of <code>model.resp</code>, a vector.</p>
</td></tr>
<tr><td><code id="grr_+3A_outc.expl">outc.expl</code></td>
<td>
<p>The outcome of <code>model.expl</code>, a column matrix.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+coefs.sensmed">coefs.sensmed</a></code>, <code><a href="maxLik.html#topic+maxLik">maxLik</a></code>
</p>

<hr>
<h2 id='hess'>Analytic Hessians of the loglikelihood functions for ML estimation of regression parameters</h2><span id='topic+hess'></span><span id='topic+hess.bb'></span><span id='topic+hess.bc'></span><span id='topic+hess.cb'></span><span id='topic+hess.cc'></span>

<h3>Description</h3>

<p>Implementation of the analytic Hessians of the loglikelihood functions for ML estimation of regression parameters for different combinations of
exposure, mediator and outcome models. The functions are named according to the convention <code>hess."model.expl type""model.resp type"</code> where <code>b</code>
stands for binary probit regression and <code>c</code> stands for linear regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hess.bb(par, Rho, X.expl = X.expl, X.resp = X.resp,
  outc.resp = outc.resp, outc.expl = outc.expl)

hess.bc(par, Rho, X.expl = X.expl, X.resp = X.resp,
  outc.resp = outc.resp, outc.expl = outc.expl)

hess.cb(par, Rho, X.expl = X.expl, X.resp = X.resp,
  outc.resp = outc.resp, outc.expl = outc.expl)

hess.cc(par, Rho, X.expl = X.expl, X.resp = X.resp,
  outc.resp = outc.resp, outc.expl = outc.expl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hess_+3A_par">par</code></td>
<td>
<p>Vector of parameter values.</p>
</td></tr>
<tr><td><code id="hess_+3A_rho">Rho</code></td>
<td>
<p>The value of the sensitivity parameter.</p>
</td></tr>
<tr><td><code id="hess_+3A_x.expl">X.expl</code></td>
<td>
<p>The model matrix (see <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>) of <code>model.expl</code></p>
</td></tr>
<tr><td><code id="hess_+3A_x.resp">X.resp</code></td>
<td>
<p>The model matrix (see <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>) of <code>model.resp</code></p>
</td></tr>
<tr><td><code id="hess_+3A_outc.resp">outc.resp</code></td>
<td>
<p>The outcome of <code>model.resp</code>, a vector.</p>
</td></tr>
<tr><td><code id="hess_+3A_outc.expl">outc.expl</code></td>
<td>
<p>The outcome of <code>model.expl</code>, a column matrix.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+coefs.sensmed">coefs.sensmed</a></code>, <code><a href="maxLik.html#topic+maxLik">maxLik</a></code>
</p>

<hr>
<h2 id='LogL'>Implementation of loglikelihood functions for ML estimation of regression parameters</h2><span id='topic+LogL'></span><span id='topic+LogL.bb'></span><span id='topic+LogL.bc'></span><span id='topic+LogL.cb'></span><span id='topic+LogL.cc'></span>

<h3>Description</h3>

<p>Implementation of loglikelihood functions for ML estimation of regression parameters for different combinations of
exposure, mediator and outcome models. The functions are named according to the convention <code>LogL."model.expl type""model.resp type"</code> where <code>b</code>
stands for binary probit regression and <code>c</code> stands for linear regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LogL.bb(par, Rho, X.expl = X.expl, X.resp = X.resp,
  outc.resp = outc.resp, outc.expl = outc.expl)

LogL.bc(par, Rho, X.expl = X.expl, X.resp = X.resp,
  outc.resp = outc.resp, outc.expl = outc.expl)

LogL.cb(par, Rho, X.expl = X.expl, X.resp = X.resp,
  outc.resp = outc.resp, outc.expl = outc.expl)

LogL.cc(par, Rho, X.expl = X.expl, X.resp = X.resp,
  outc.resp = outc.resp, outc.expl = outc.expl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LogL_+3A_par">par</code></td>
<td>
<p>Vector of parameter values.</p>
</td></tr>
<tr><td><code id="LogL_+3A_rho">Rho</code></td>
<td>
<p>The value of the sensitivity parameter.</p>
</td></tr>
<tr><td><code id="LogL_+3A_x.expl">X.expl</code></td>
<td>
<p>The model matrix (see <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>) of <code>model.expl</code></p>
</td></tr>
<tr><td><code id="LogL_+3A_x.resp">X.resp</code></td>
<td>
<p>The model matrix (see <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>) of <code>model.resp</code></p>
</td></tr>
<tr><td><code id="LogL_+3A_outc.resp">outc.resp</code></td>
<td>
<p>The outcome of <code>model.resp</code>, a vector.</p>
</td></tr>
<tr><td><code id="LogL_+3A_outc.expl">outc.expl</code></td>
<td>
<p>The outcome of <code>model.expl</code>, a column matrix.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+coefs.sensmed">coefs.sensmed</a></code>, <code><a href="maxLik.html#topic+maxLik">maxLik</a></code>
</p>

<hr>
<h2 id='ML'>Functions for ML estimation of regression parameters for sensitivity analysis</h2><span id='topic+ML'></span><span id='topic+ML.bb'></span><span id='topic+ML.bc'></span><span id='topic+ML.cb'></span><span id='topic+ML.cc'></span>

<h3>Description</h3>

<p>Functions for ML estimation of regression parameters for sensitivity analysis for different combinations of exposure, mediator and outcome models. The functions are named according to the convention <code>ML."model.expl type""model.resp type"</code> where <code>b</code>
stands for binary probit regression and <code>c</code> stands for linear regression. The optimization is performed using
<code><a href="maxLik.html#topic+maxLik">maxLik</a></code>. The functions are intended to be called through <code><a href="#topic+coefs.sensmed">coefs.sensmed</a></code>, not on their own.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ML.bb(model.expl, model.resp, Rho, progress = TRUE, ...)

ML.bc(model.expl, model.resp, Rho, progress = TRUE, ...)

ML.cb(model.expl, model.resp, Rho, progress = TRUE, ...)

ML.cc(model.expl, model.resp, Rho, progress = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ML_+3A_model.expl">model.expl</code></td>
<td>
<p>Fitted <code><a href="stats.html#topic+glm">glm</a></code> model object (probit or linear). If sensitivity analysis to mediator-outcome confounding the mediator model. Otherwise the exposure model.</p>
</td></tr>
<tr><td><code id="ML_+3A_model.resp">model.resp</code></td>
<td>
<p>Fitted <code><a href="stats.html#topic+glm">glm</a></code> model object (probit or linear). If sensitivity analysis to exposure-mediator confounding the mediator model. Otherwise the outcome model.</p>
</td></tr>
<tr><td><code id="ML_+3A_rho">Rho</code></td>
<td>
<p>The sensitivity parameter vector. If <code>type="my"</code> the correlation between the error terms in the mediator and outcome models. If <code>type="zm"</code> the correlation between the error terms in the exposure and mediator models. If <code>type="zy"</code> the correlation between the error terms in the exposure and outcome models.</p>
</td></tr>
<tr><td><code id="ML_+3A_progress">progress</code></td>
<td>
<p>Logical, indicating whether or not the progress (i.e. the <code><a href="base.html#topic+proc.time">proc.time</a></code> for each <code>Rho</code>) of the optimization will be output</p>
</td></tr>
<tr><td><code id="ML_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed on to the <code>maxLik</code> function. Can be used to set the <code>method</code> and <code>control</code> arguments of the <code>maxLik</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements:
</p>
<table>
<tr><td><code>coef</code></td>
<td>
<p>A matrix with the estimated regression parameters for <code>model.resp</code> over the range of <code>Rho</code>. One column per value of <code>Rho</code>.</p>
</td></tr>
<tr><td><code>Rho</code></td>
<td>
<p>The sensitivity parameter vector.</p>
</td></tr>
<tr><td><code>expl.coef</code></td>
<td>
<p>A matrix with the estimated regression parameters for <code>model.expl</code> over the range of <code>Rho</code>. One column per value of <code>Rho</code>.</p>
</td></tr>
<tr><td><code>model.expl</code></td>
<td>
<p>the original fitted <code>glm</code> object of <code>model.expl</code>.</p>
</td></tr>
<tr><td><code>model.resp</code></td>
<td>
<p>the original fitted <code>glm</code> object of <code>model.resp</code>.</p>
</td></tr>
<tr><td><code>X.expl</code></td>
<td>
<p>The model matrix (see <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>) of <code>model.expl</code></p>
</td></tr>
<tr><td><code>X.resp</code></td>
<td>
<p>The model matrix (see <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>) of <code>model.resp</code></p>
</td></tr>
<tr><td><code>outc.resp</code></td>
<td>
<p>The outcome variable of <code>model.resp</code>.</p>
</td></tr>
<tr><td><code>outc.expl</code></td>
<td>
<p>The outcome variable of <code>model.expl</code>.</p>
</td></tr>
<tr><td><code>sigma.res.expl</code></td>
<td>
<p>If <code>model.expl</code> is linear, a column matrix with the estimated residual standard deviation for <code>model.expl</code> over the range of <code>Rho</code>.</p>
</td></tr>
<tr><td><code>sigma.res.resp</code></td>
<td>
<p>If <code>model.resp</code> is linear, a column matrix with the estimated residual standard deviation for <code>model.resp</code> over the range of <code>Rho</code>.</p>
</td></tr>
<tr><td><code>value</code></td>
<td>
<p>The values of the -loglikelihood function for the best set of regression parameters from the optimization for each <code>Rho</code>.</p>
</td></tr>
<tr><td><code>sigmas</code></td>
<td>
<p>A list with the covariance matrices for the model parameters in <code>model.expl</code> and <code>model.resp</code> for each <code>Rho</code>.</p>
</td></tr>
<tr><td><code>max.info</code></td>
<td>
<p>Information about the maximization (whether or not the convergence was successful, <code>message</code>, <code>method</code> and number of iterations) for each <code>Rho</code>, see <code><a href="maxLik.html#topic+maxLik">maxLik</a></code> for more information.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Anita Lindmark
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coefs.sensmed">coefs.sensmed</a></code>, <code><a href="maxLik.html#topic+maxLik">maxLik</a></code>
</p>

<hr>
<h2 id='more.effects'>Estimate additional natural direct and indirect effects based on an <code>"effectsMed"</code> object</h2><span id='topic+more.effects'></span>

<h3>Description</h3>

<p>Takes an <code>"effectsMed"</code> object and estimates additional natural direct and indirect effects, with a sensitivity analysis using
the same sensitivity parameter as in the original analysis, without having to redo the optimization to find the estimated regression coefficients.
The effects to be estimated are regulated through the arguments <code>covariates</code>, <code>alt.decomposition</code>, <code>exp.value</code> and <code>control.value</code>
as described in the documentation for <code><a href="#topic+sensmediation">sensmediation</a></code>. The confidence level used is regulated through the argument <code>conf.level</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>more.effects(sensmed.object, conf.level = 0.95, covariates = NULL,
  alt.decomposition = FALSE, exp.value = NULL, control.value = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="more.effects_+3A_sensmed.object">sensmed.object</code></td>
<td>
<p>an object of class &quot;effectsMed&quot; for which additional effects are to be calculated.</p>
</td></tr>
<tr><td><code id="more.effects_+3A_conf.level">conf.level</code></td>
<td>
<p>the confidence level to be used for confidence intervals and uncertainty intervals.</p>
</td></tr>
<tr><td><code id="more.effects_+3A_covariates">covariates</code></td>
<td>
<p>if conditional effects are to be estimated the list of covariate values (see <code><a href="#topic+sensmediation">sensmediation</a></code>). Covariates not specified are marginalized over.</p>
</td></tr>
<tr><td><code id="more.effects_+3A_alt.decomposition">alt.decomposition</code></td>
<td>
<p>logical indicating whether alternative definitions of the direct and indirect effects should be used (see <code><a href="#topic+sensmediation">sensmediation</a></code>).</p>
</td></tr>
<tr><td><code id="more.effects_+3A_exp.value">exp.value</code></td>
<td>
<p>value of the exposure variable used as the exposure condition, default is to take the value stored in <code>sensmed.object</code>.</p>
</td></tr>
<tr><td><code id="more.effects_+3A_control.value">control.value</code></td>
<td>
<p>value of the exposure variable used as the control (unexposed) condition, default is to take the value stored in <code>sensmed.object</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>more.effects</code> returns an object of class <code>"effectsMed"</code>, see the documentation for <code><a href="#topic+sensmediation">sensmediation</a></code>
for information.
</p>


<h3>Author(s)</h3>

<p>Anita Lindmark
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sensmediation">sensmediation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Example with data from Riksstroke (the Swedish stroke register)

data(RSdata)

# Probit mediator and outcome models:
med.model &lt;- glm(lowered.consc ~ AF + age.cat + sex, data = RSdata,
family = binomial(link = 'probit'))
out.model &lt;- glm(cf.3mo ~ AF + lowered.consc + age.cat + sex, data = RSdata,
family = binomial(link = 'probit'))

# First we estimate marginal NIE, NDE with sensitivity analyses to mediator-outcome
# confounding:
sensmed &lt;- sensmediation(med.model, out.model, exp.name = "AF1", med.name = "lowered.consc",
Rho = seq(0, 0.5, 0.1))

# Then we also estimate NIE, NDE conditional on male sex without reestimating the regression
# coefficients:
sensmed.cond &lt;- more.effects(sensmed.object = sensmed, covariates = list(sex = 1))
summary(sensmed.cond)
plot(sensmed.cond)

## End(Not run)

</code></pre>

<hr>
<h2 id='partdevs'>Implementations of the partial derivatives (gradients) of the expressions for the direct, indirect and total effects. Used to calculate standard errors (delta method).</h2><span id='topic+partdevs'></span><span id='topic+partdevs.bb'></span><span id='topic+partdevs.bc'></span><span id='topic+partdevs.cb'></span><span id='topic+partdevs.cc'></span>

<h3>Description</h3>

<p>Functions implementing the partial derivatives (gradients) of the expressions for the direct, indirect and total effects. These are then used
to calculate standard errors of the effects using the delta method. Called by the <code><a href="#topic+stderrs">stderrs</a></code> functions. The functions are named according to the convention
<code>partdevs."mediator model type""outcome model type"</code> where <code>b</code>stands for binary probit regression and
<code>c</code> stands for linear regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>partdevs.bb(beta0, beta1, beta2, beta3, theta0, theta1, theta2, theta3,
  theta4, theta5, theta6, theta7, x.med, x.out, t.de, t.ie, exp.value,
  control.value)

partdevs.bc(beta0, beta1, beta2, beta3, theta2, theta3, theta6, theta7,
  x.med, x.out, t.de, t.ie, exp.value, control.value)

partdevs.cb(beta0, beta1, beta2, beta3, theta0, theta1, theta2, theta3,
  theta4, theta5, theta6, theta7, sigma.eta, x.med, x.out, t.de, t.ie,
  exp.value, control.value)

partdevs.cc(beta0, beta1, beta2, beta3, theta2, theta3, theta6, theta7,
  exp.value, control.value, x.med, x.out, t.de, t.ie)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="partdevs_+3A_beta0">beta0</code>, <code id="partdevs_+3A_beta1">beta1</code></td>
<td>
<p>Vectors of mediator regression parameters (intercept and exposure) over <code>Rho</code></p>
</td></tr>
<tr><td><code id="partdevs_+3A_beta2">beta2</code>, <code id="partdevs_+3A_beta3">beta3</code></td>
<td>
<p>Matrices of mediator regression parameters (covariate main effects and exposure-covariate interactions) over <code>Rho</code></p>
</td></tr>
<tr><td><code id="partdevs_+3A_theta0">theta0</code>, <code id="partdevs_+3A_theta1">theta1</code>, <code id="partdevs_+3A_theta2">theta2</code>, <code id="partdevs_+3A_theta3">theta3</code></td>
<td>
<p>Vectors of outcome regression parameters (intercept, exposure, mediator, exposure-mediator interaction) over <code>Rho</code></p>
</td></tr>
<tr><td><code id="partdevs_+3A_theta4">theta4</code>, <code id="partdevs_+3A_theta5">theta5</code>, <code id="partdevs_+3A_theta6">theta6</code>, <code id="partdevs_+3A_theta7">theta7</code></td>
<td>
<p>Matrices of outcome regression parameters (covariate main effects, exposure-covariate, mediator-covariate and exposure-mediator-covariate interactions) over <code>Rho</code></p>
</td></tr>
<tr><td><code id="partdevs_+3A_x.med">x.med</code></td>
<td>
<p>Mediator covariate matrix for which to calculate standard errors</p>
</td></tr>
<tr><td><code id="partdevs_+3A_x.out">x.out</code></td>
<td>
<p>Outcome covariate matrix for which to calculate standard errors</p>
</td></tr>
<tr><td><code id="partdevs_+3A_t.de">t.de</code>, <code id="partdevs_+3A_t.ie">t.ie</code></td>
<td>
<p>exposure values used to calculate the direct and indirect effects depending on the desired decomposition (see the Details section of <code><a href="#topic+sensmediation">sensmediation</a></code> for more information). If <code>alt.decomposition = TRUE</code> then <code>t.de = exp.value</code> and <code>t.ie = control.value</code>, otherwise <code>t.de = control.value</code> and <code>t.ie = exp.value</code>.</p>
</td></tr>
<tr><td><code id="partdevs_+3A_exp.value">exp.value</code></td>
<td>
<p>value of the exposure variable used as the exposure condition.</p>
</td></tr>
<tr><td><code id="partdevs_+3A_control.value">control.value</code></td>
<td>
<p>value of the exposure variable used as the control (unexposed) condition.</p>
</td></tr>
<tr><td><code id="partdevs_+3A_sigma.eta">sigma.eta</code></td>
<td>
<p>For a continuous mediator and binary outcome, matrix with the estimated residual standard deviation for the mediator model over the range of <code>Rho</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.effectsMed'>Plot function for objects of class <code>"effectsMed"</code></h2><span id='topic+plot.effectsMed'></span>

<h3>Description</h3>

<p>Plots the estimated natural indirect or direct effects with confidence intervals over the range of the sensitivity parameter <code>Rho</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'effectsMed'
plot(x, effect = "indirect", xlab = NULL,
  ylab = NULL, xlim = NULL, ylim = NULL, main = NULL,
  lwd = graphics::par("lwd"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.effectsMed_+3A_x">x</code></td>
<td>
<p>object of class <code>"effectsMed"</code></p>
</td></tr>
<tr><td><code id="plot.effectsMed_+3A_effect">effect</code></td>
<td>
<p>which effect to plot results for (&quot;indirect&quot; or &quot;direct&quot;)</p>
</td></tr>
<tr><td><code id="plot.effectsMed_+3A_xlab">xlab</code></td>
<td>
<p>a title for the x axis, see <code><a href="graphics.html#topic+title">title</a></code>. Default is <code>expression(rho)</code>.</p>
</td></tr>
<tr><td><code id="plot.effectsMed_+3A_ylab">ylab</code></td>
<td>
<p>a title for the y axis, see <code><a href="graphics.html#topic+title">title</a></code>. Default is <code>NIE</code> (<code>NIE*</code> if <code>alt.decomposition = TRUE</code>) or <code>NDE</code> (<code>NDE*</code>)</p>
</td></tr>
<tr><td><code id="plot.effectsMed_+3A_xlim">xlim</code></td>
<td>
<p>the x limits (x1, x2) of the plot, see <code><a href="graphics.html#topic+plot.default">plot.default</a></code>. Default is <code>c(min(x$Rho),max(x$Rho))</code></p>
</td></tr>
<tr><td><code id="plot.effectsMed_+3A_ylim">ylim</code></td>
<td>
<p>the y limits of the plot. Default is <code>c(min(x$CI$CI.nie[,1]),max(x$CI$CI.nie[,2]))</code></p>
</td></tr>
<tr><td><code id="plot.effectsMed_+3A_main">main</code></td>
<td>
<p>a main title for the plot, see <code><a href="graphics.html#topic+title">title</a></code></p>
</td></tr>
<tr><td><code id="plot.effectsMed_+3A_lwd">lwd</code></td>
<td>
<p>line widths for the lines of the plot, see <code><a href="graphics.html#topic+par">par</a></code></p>
</td></tr>
<tr><td><code id="plot.effectsMed_+3A_...">...</code></td>
<td>
<p>additional graphical parameters to be passed to plotting functions, see <code><a href="graphics.html#topic+par">par</a></code></p>
</td></tr>
</table>

<hr>
<h2 id='RSdata'>Example data for the functions in sensmediation</h2><span id='topic+RSdata'></span>

<h3>Description</h3>

<p>The data are a subsample of 1000 observations from Riksstroke, the Swedish Stroke Register. The original data consisted
of over 50 000 patients with first time ischemic stroke during the years 2009-2012. The data are limited to patients over
the age of 44 and its purpose is to illustrate the functioning of the functions in the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(RSdata)
</code></pre>


<h3>Format</h3>

<p>A data frame with 1000 observations on the following 5 variables.
</p>

<dl>
<dt><code>cf.3mo</code></dt><dd><p>Outcome: case fatality within 3 months after stroke, 1 = deceased, 0 = not deceased.</p>
</dd>
<dt><code>lowered.consc</code></dt><dd><p>Mediator: level of consciousness upon arrival to hospital. 1 = lowered consciousness, 0 = fully alert.</p>
</dd>
<dt><code>AF</code></dt><dd><p>Exposure: atrial fibrillation. Factor with levels, &quot;1&quot; = atrial fibrillation, &quot;0&quot; = no atrial fibrillation.</p>
</dd>
<dt><code>age.cat</code></dt><dd><p>Age at time of stroke. Factor with levels, &quot;45-69&quot;, &quot;70-79&quot;, &quot;80-89&quot; and &quot;90-&quot;.</p>
</dd>
<dt><code>sex</code></dt><dd><p>Factor with levels, &quot;1&quot; = male, &quot;0&quot; = female</p>
</dd>
</dl>


<h3>Examples</h3>

<pre><code class='language-R'>data(RSdata)
</code></pre>

<hr>
<h2 id='sensmediation'>Estimate natural direct and indirect effects based on parametric regression models and perform sensitivity analysis</h2><span id='topic+sensmediation'></span>

<h3>Description</h3>

<p>Function to estimate the natural direct and indirect effects based on parametric regression models. Standard errors for the effects are calculated using the delta method.
The function also gives sensitivity analysis results for unobserved confounding. Implements methods introduced in Lindmark, de Luna and Eriksson (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sensmediation(med.model, out.model, exp.model = NULL, exp.name = NULL,
  med.name = NULL, type = "my", Rho = 0, progress = TRUE,
  conf.level = 0.95, covariates = NULL, alt.decomposition = FALSE,
  control.value = 0, exp.value = 1, covariance = NULL,
  med.full = NULL, out.full = NULL, all.interactions = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sensmediation_+3A_med.model">med.model</code></td>
<td>
<p>Fitted <code><a href="stats.html#topic+glm">glm</a></code> model object representing the mediator model at the basis of the estimation (see Details for more information).</p>
</td></tr>
<tr><td><code id="sensmediation_+3A_out.model">out.model</code></td>
<td>
<p>Fitted <code><a href="stats.html#topic+glm">glm</a></code> model object representing the outcome model at the basis of the estimation (see Details for more information).</p>
</td></tr>
<tr><td><code id="sensmediation_+3A_exp.model">exp.model</code></td>
<td>
<p>Fitted <code><a href="stats.html#topic+glm">glm</a></code> model object representing the exposure model. Should be provided if <code>type="zm"</code> or <code>type="zy"</code>.</p>
</td></tr>
<tr><td><code id="sensmediation_+3A_exp.name">exp.name</code></td>
<td>
<p>A character string indicating the name of the exposure variable used in the models. Needs to match the name of the exposure found in the output from the fitted glm-models (this is especially important to check for exposures of class <code>factor</code>).</p>
</td></tr>
<tr><td><code id="sensmediation_+3A_med.name">med.name</code></td>
<td>
<p>A character string indicating the name of the mediator used in the models. Needs to match the name of the mediator found in the output from the outcome glm-model (this is especially important to check for mediators of class <code>factor</code>).</p>
</td></tr>
<tr><td><code id="sensmediation_+3A_type">type</code></td>
<td>
<p>the type of confounding for which the sensitivity analysis is to be performed. <code>type="my"</code>, the default, corresponds to unobserved mediator-outcome confounding, <code>type="zm"</code> to exposure-mediator confounding and <code>type="zy"</code> to exposure-outcome confounding.</p>
</td></tr>
<tr><td><code id="sensmediation_+3A_rho">Rho</code></td>
<td>
<p>The sensitivity parameter vector. If <code>type="my"</code> the correlation between the error terms in the mediator and outcome models. If <code>type="zm"</code> the correlation between the error terms in the exposure and mediator models. If <code>type="zy"</code> the correlation between the error terms in the exposure and outcome models.</p>
</td></tr>
<tr><td><code id="sensmediation_+3A_progress">progress</code></td>
<td>
<p>Logical, indicating whether or not the progress (i.e. the <code><a href="base.html#topic+proc.time">proc.time</a></code> for each <code>Rho</code>) of the optimization will be output</p>
</td></tr>
<tr><td><code id="sensmediation_+3A_conf.level">conf.level</code></td>
<td>
<p>the confidence level to be used for confidence intervals and uncertainty intervals.</p>
</td></tr>
<tr><td><code id="sensmediation_+3A_covariates">covariates</code></td>
<td>
<p>if conditional effects are to be estimated the named list of covariate values (see Details). Covariates not specified are marginalized over.</p>
</td></tr>
<tr><td><code id="sensmediation_+3A_alt.decomposition">alt.decomposition</code></td>
<td>
<p>logical indicating whether or not alternative definitions of the direct and indirect effects should be used (see Details).</p>
</td></tr>
<tr><td><code id="sensmediation_+3A_control.value">control.value</code></td>
<td>
<p>value of the exposure variable used as the control (unexposed) condition, default is 0.</p>
</td></tr>
<tr><td><code id="sensmediation_+3A_exp.value">exp.value</code></td>
<td>
<p>value of the exposure variable used as the exposure condition, default is 1.</p>
</td></tr>
<tr><td><code id="sensmediation_+3A_covariance">covariance</code>, <code id="sensmediation_+3A_med.full">med.full</code>, <code id="sensmediation_+3A_out.full">out.full</code>, <code id="sensmediation_+3A_all.interactions">all.interactions</code></td>
<td>
<p>arguments used in previous versions of the package that are now deprecated.</p>
</td></tr>
<tr><td><code id="sensmediation_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed on to the <code>maxLik</code> function. Can be used to set the <code>method</code> and <code>control</code> arguments of the <code>maxLik</code> function (see <code><a href="#topic+coefs.sensmed">coefs.sensmed</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To obtain the ML estimates of the regression parameters used to calculate mediation effects and perform sensitivity analysis
<code>sensmediation</code> calls <code><a href="#topic+coefs.sensmed">coefs.sensmed</a></code>. The maximization of the log-likelihood is performed using
<code><a href="maxLik.html#topic+maxLik">maxLik</a></code>, the default is to use the Newton-Raphson method and an analytic gradient and Hessian.
</p>
<p>The mediator and outcome models (and exposure model for <code>type = "zm"</code> or <code>"zy"</code>) should be fitted using <code>glm</code> and can be of two types, probit models (<code>family = binomial(link = 'probit')</code>)
for binary mediators or outcomes (exposures) and linear regression models (<code>family = gaussian</code>) for
continuous mediators or outcomes (exposures). The outcome model may contain exposure-mediator, exposure-covariate,
mediator-covariate and exposure-mediator-covariate interactions. The mediator model may contain exposure-covariate interactions.
All models may also contain interactions between covariates. Note, however that interactions may not be included in a model without
also including the main effects of the interacting variables. That is, interactions should be specified either as <code>X1*X2</code> or
<code>X1 + X2 + X1:X2</code>, not as <code>X1:X2</code> alone.
</p>
<p>To obtain results conditional on specific covariate values, these values should be provided through the <code>covariates</code> argument as a named list (see Examples).
The effects will be averaged over covariates not specified in the list.
</p>
<p>The total effect can be decomposed into a direct and indirect effect in different ways. Let z be the exposure value and z* the control (unexposed) value.
The default is to give the decomposition into the &quot;pure direct effect&quot; <code>E(Y(z,M(z*)))-E(Y(z*,M(z*)))</code> (here denoted NDE) and the &quot;total indirect effect&quot;
<code>E(Y(z,M(z)))-E(Y(z,M(z*)))</code> (denoted NIE). Setting <code>alt.decomposition=TRUE</code>
instead gives the decomposition into the &quot;total direct effect&quot; <code>E(Y(z,M(z)))-E(Y(z*,M(z)))</code> (here denoted NDE*) and &quot;pure indirect effect&quot;
<code>E(Y(z*,M(z)))-E(Y(z*,M(z*)))</code> (denoted NIE*).
</p>
<p>Standard errors for the effects are calculated using the delta method. Confidence intervals (CI) for (and p-values for tests of) the natural direct and indirect effects for each value of the
sensitivity parameter are constructed based on a normal approximation. Uncertainty intervals (UI) are constructed as the union of all CIs over the sensitivity parameter
vector.
</p>


<h3>Value</h3>

<p><code>sensmediation</code> returns an object of class <code>"effectsMed"</code>.
</p>
<p>The function <code>summary</code> (<code><a href="#topic+summary.effectsMed">summary.effectsMed</a></code>) gives a summary of the results in the form of a table with the estimated
effects and results of the sensitivity analysis. The function <code>plot</code> (<code><a href="#topic+plot.effectsMed">plot.effectsMed</a></code>) plots the estimated natural
indirect or direct effects with confidence intervals over the range of the sensitivity parameter.
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The matched call</p>
</td></tr>
<tr><td><code>Rho</code></td>
<td>
<p>The sensitivity parameter vector.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>character, the type of confounding the sensitivity analysis is performed for.</p>
</td></tr>
<tr><td><code>coefs.sensmed</code></td>
<td>
<p>a list with the output from <code><a href="#topic+coefs.sensmed">coefs.sensmed</a></code></p>
</td></tr>
<tr><td><code>NIE</code></td>
<td>
<p>matrix with the estimated NIEs (or NIE*s if <code>alt.decomposition=TRUE</code>) over the range of the sensitivity parameter <code>Rho</code>.</p>
</td></tr>
<tr><td><code>NDE</code></td>
<td>
<p>matrix with the estimated NDEs (or NDE*s if <code>alt.decomposition=TRUE</code>) over the range of the sensitivity parameter <code>Rho</code>.</p>
</td></tr>
<tr><td><code>std.errs</code></td>
<td>
<p>list with the standard errors of the NIE (NIE*), NDE (NDE*) and total effect over the range of the sensitivity parameter <code>Rho</code>.</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>a list with the confidence intervals of the NIE (NIE*), NDE (NDE*) and total effect over the range of the sensitivity parameter <code>Rho</code>.</p>
</td></tr>
<tr><td><code>UI</code></td>
<td>
<p>matrix with the uncertainty intervals for the NIE (NIE*) and NDE (NDE*) over the range of the sensitivity parameter <code>Rho</code>.</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>numeric, the confidence level used for confidence intervals and uncertainty intervals.</p>
</td></tr>
<tr><td><code>covariates</code></td>
<td>
<p>list of the covariate values that the effects are conditioned on.</p>
</td></tr>
<tr><td><code>exp.name</code></td>
<td>
<p>character vector containing the name of the exposure variable.</p>
</td></tr>
<tr><td><code>med.name</code></td>
<td>
<p>character vector containing the name of the mediator variable.</p>
</td></tr>
<tr><td><code>exp.value</code></td>
<td>
<p>value of the exposure variable used as the exposure condition.</p>
</td></tr>
<tr><td><code>control.value</code></td>
<td>
<p>value of the exposure variable used as the control (unexposed) condition.</p>
</td></tr>
<tr><td><code>alt.decomposition</code></td>
<td>
<p>logical, indicating whether the alternative definitions of the direct and indirect effects have been used</p>
</td></tr>
<tr><td><code>med.model</code></td>
<td>
<p>the mediator model input.</p>
</td></tr>
<tr><td><code>out.model</code></td>
<td>
<p>the outcome model input.</p>
</td></tr>
<tr><td><code>betas</code></td>
<td>
<p>list of the estimated mediator model parameters over <code>Rho</code>, with
</p>

<ul>
<li> <p><code>beta0</code> Intercept
</p>
</li>
<li> <p><code>beta1</code> Exposure
</p>
</li>
<li> <p><code>beta2</code> Covariates
</p>
</li>
<li> <p><code>beta3</code> Exposure-covariate interactions
</p>
</li></ul>

<p>Components that are not included in the input mediator model are set to 0.</p>
</td></tr>
<tr><td><code>thetas</code></td>
<td>
<p>list of the estimated outcome model parameters over <code>Rho</code>, with
</p>

<ul>
<li> <p><code>theta0</code> Intercept
</p>
</li>
<li> <p><code>theta1</code> Exposure
</p>
</li>
<li> <p><code>theta2</code> Mediator
</p>
</li>
<li> <p><code>theta3</code> Exposure-mediator interaction
</p>
</li>
<li> <p><code>theta4</code> Covariates
</p>
</li>
<li> <p><code>theta5</code> Exposure-covariate interactions
</p>
</li>
<li> <p><code>theta6</code> Mediator-covariate interactions
</p>
</li>
<li> <p><code>theta7</code> Exposure-mediator-covariate interactions
</p>
</li></ul>

<p>Components that are not included in the input outcome model are set to 0.</p>
</td></tr>
<tr><td><code>part.deriv</code></td>
<td>
<p>List with the partial derivatives of the NDE (Lambda), NIE (Gamma) and TE (Eta) wrt the mediator and outcome model parameters for each value of <code>Rho</code>. See <code><a href="#topic+partdevs">partdevs</a></code>.</p>
</td></tr>
<tr><td><code>sigma.thetabeta</code></td>
<td>
<p>a list with the joint covariance matrix of the outcome and mediator model parameters for each value of <code>Rho</code>. Note that the covariance matrix is constructed for all estimated parameters listed in <code>betas</code> and <code>thetas</code> but that components not included in the input mediator and outcome models are set to 0.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Anita Lindmark
</p>


<h3>References</h3>

<p>Lindmark, A., de Luna, X., Eriksson, M. (2018) Sensitivity Analysis for Unobserved Confounding of Direct and Indirect Effects Using Uncertainty Intervals, <em>Statistics in Medicine</em>, <b>37(10)</b>, pp 1744&ndash;1762.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+more.effects">more.effects</a></code> which can be used to calculate additional direct and indirect effects with sensitivity analysis using the same sensitivity parameter without running the optimization again.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example with data from Riksstroke (the Swedish stroke register)

data(RSdata)

# Probit mediator and outcome models:
m.model &lt;- glm(lowered.consc ~ AF + age.cat + sex, data = RSdata,
   family = binomial(link = 'probit'))
o.model &lt;- glm(cf.3mo ~ AF + lowered.consc + age.cat + sex, data = RSdata,
   family = binomial(link = 'probit'))

# Estimation of NIE, NDE and sensitivity analyses to mediator-outcome confounding:
# (note that the name of the exposure is "AF1" to match the name in coef(out.model))
sensmed &lt;- sensmediation(m.model, o.model, exp.name = "AF1", med.name = "lowered.consc",
   Rho = c(0, 0.1))
summary(sensmed)
plot(sensmed)
plot(sensmed, effect = "direct")

## Not run: 
# Conditional effects and sensitivity analysis to mediator-outcome confounding using
# more.effects():
sensmed.cond &lt;- more.effects(sensmed.object = sensmed,
   covariates = list(sex = 1, age.cat = "70-79"))
summary(sensmed.cond)

## End(Not run)

## Not run: 
## Sensitivity analysis to exposure-mediator confounding:
  e.model &lt;- glm(AF ~ age.cat + sex, data = RSdata,
     family = binomial(link = 'probit'))

  sensmed.zm &lt;- sensmediation(med.model = m.model, out.model = o.model,
     exp.model = e.model, type = "zm", Rho = seq(0, 0.5, 0.1), exp.name = "AF1",
     med.name = "lowered.consc")

  summary(sensmed.zm)

## End(Not run)

## Not run: 
# Additional effects using more.effects:
# Results with conf.level = 0.99:
sensmed.zm.99 &lt;- more.effects(sensmed.object = sensmed.zm, conf.level = 0.99)
summary(sensmed.zm.99)

## End(Not run)

## Not run: 
# Examples with simulated data, continuous exposure:

require(mvtnorm)

n &lt;- 1000
set.seed(102677)

x &lt;- rnorm(n)
z &lt;- -0.5 + 0.1*x + rnorm(n)
R &lt;- 0.5
Sigma &lt;- cbind(c(1,R), c(R,1))
epsilon &lt;- rmvnorm(n, sigma = Sigma)
m &lt;- -1.2 + 0.8*z + 0.13*x + epsilon[,1]
y &lt;- -1 + 0.05*z + 3*m + 0.5*x + epsilon[,2]

# Models:
z.model &lt;- glm(z ~ x)
m.model2 &lt;- glm(m ~ z + x)
y.model &lt;- glm(y ~ z + m + x)

## Estimation of NIE, NDE. Note that the exposure condition is 2
## so effects are calculated for a 2 unit increase of the exposure:
eff.contz &lt;- sensmediation(med.model = m.model2, out.model = y.model,
           exp.name = "z", med.name = "m", control.value = 0, exp.value = 2)
summary(eff.contz)

## End(Not run)

</code></pre>

<hr>
<h2 id='stderrs'>Functions to calculate standard errors of the direct, indirect and total effects using the delta method.</h2><span id='topic+stderrs'></span><span id='topic+stderr.bb'></span><span id='topic+stderr.bc'></span><span id='topic+stderr.cb'></span><span id='topic+stderr.cc'></span>

<h3>Description</h3>

<p>Functions used to calculate standard errors of the direct, indirect and total effects using the delta method. Called by <code><a href="#topic+calc.effects">calc.effects</a></code>.
The functions are named according to the convention <code>stderr."mediator model type""outcome model type"</code> where <code>b</code>
stands for binary probit regression and <code>c</code> stands for linear regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stderr.bb(Rho, betas, thetas, sigma.pars, x.med, x.out, alt.decomposition,
  exp.value, control.value)

stderr.bc(Rho, betas, thetas, sigma.pars, x.med, x.out, alt.decomposition,
  exp.value, control.value)

stderr.cb(Rho, betas, thetas, sigma.eta, sigma.pars, x.med, x.out,
  alt.decomposition, exp.value, control.value)

stderr.cc(Rho, betas, thetas, sigma.pars, x.med, x.out, alt.decomposition,
  exp.value, control.value)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stderrs_+3A_rho">Rho</code></td>
<td>
<p>The sensitivity parameter vector.</p>
</td></tr>
<tr><td><code id="stderrs_+3A_betas">betas</code></td>
<td>
<p>List of mediator regression parameters</p>
</td></tr>
<tr><td><code id="stderrs_+3A_thetas">thetas</code></td>
<td>
<p>List of outcome regression parameters</p>
</td></tr>
<tr><td><code id="stderrs_+3A_sigma.pars">sigma.pars</code></td>
<td>
<p>List of covariance matrices for the mediator and outcome regression parameters</p>
</td></tr>
<tr><td><code id="stderrs_+3A_x.med">x.med</code></td>
<td>
<p>Mediator covariate matrix for which to calculate standard errors</p>
</td></tr>
<tr><td><code id="stderrs_+3A_x.out">x.out</code></td>
<td>
<p>Outcome covariate matrix for which to calculate standard errors</p>
</td></tr>
<tr><td><code id="stderrs_+3A_alt.decomposition">alt.decomposition</code></td>
<td>
<p>logical indicating whether or not alternative definitions of the direct and indirect effects should be used.</p>
</td></tr>
<tr><td><code id="stderrs_+3A_exp.value">exp.value</code></td>
<td>
<p>value of the exposure variable used as the exposure condition.</p>
</td></tr>
<tr><td><code id="stderrs_+3A_control.value">control.value</code></td>
<td>
<p>value of the exposure variable used as the control (unexposed) condition.</p>
</td></tr>
<tr><td><code id="stderrs_+3A_sigma.eta">sigma.eta</code></td>
<td>
<p>For a continuous mediator and binary outcome, matrix with the estimated residual standard deviation for the mediator model over the range of <code>Rho</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='summary.effectsMed'>Summary function for objects of class <code>"effectsMed"</code></h2><span id='topic+summary.effectsMed'></span><span id='topic+print.summaryeffectsMed'></span>

<h3>Description</h3>

<p>Summary function for objects of class <code>"effectsMed"</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'effectsMed'
summary(object, non.sign = FALSE, ...)

## S3 method for class 'summaryeffectsMed'
print(x, digits = max(3, getOption("digits")
  - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.effectsMed_+3A_object">object</code></td>
<td>
<p>object of class <code>"effectsMed"</code></p>
</td></tr>
<tr><td><code id="summary.effectsMed_+3A_non.sign">non.sign</code></td>
<td>
<p>logical indicating whether sensitivity analysis results should be printed for non-significant effects.</p>
</td></tr>
<tr><td><code id="summary.effectsMed_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
<tr><td><code id="summary.effectsMed_+3A_x">x</code></td>
<td>
<p>object of class <code>"summaryeffectsMed"</code></p>
</td></tr>
<tr><td><code id="summary.effectsMed_+3A_digits">digits</code></td>
<td>
<p>number of digits to be printed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with values:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The matched call</p>
</td></tr>
<tr><td><code>Rho</code></td>
<td>
<p>The sensitivity parameter vector.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>character, the type of confounding the sensitivity analysis is performed for.</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>numeric, the confidence level used for confidence intervals and uncertainty intervals.</p>
</td></tr>
<tr><td><code>UI</code></td>
<td>
<p>matrix with the uncertainty intervals for the NIE (NIE*) and NDE (NDE*) over the range of the sensitivity parameter <code>Rho</code>.</p>
</td></tr>
<tr><td><code>covariates</code></td>
<td>
<p>list of the covariate values that the effects are conditioned on.</p>
</td></tr>
<tr><td><code>exp.name</code></td>
<td>
<p>character vector containing the name of the exposure.</p>
</td></tr>
<tr><td><code>med.name</code></td>
<td>
<p>character vector containing the name of the mediator.</p>
</td></tr>
<tr><td><code>alt.decomposition</code></td>
<td>
<p>logical, indicating whether the alternative definitions of the direct and indirect effects have been used</p>
</td></tr>
<tr><td><code>non.sign</code></td>
<td>
<p>logical indicating whether sensitivity analysis results are printed for non-significant effects.</p>
</td></tr>
<tr><td><code>effects</code></td>
<td>
<p>Results of the mediation analysis. Estimated NIE and NDE with confidence intervals and p-values for <code>Rho = 0</code></p>
</td></tr>
<tr><td><code>ns.nie</code></td>
<td>
<p>values of <code>Rho</code> with estimated NIEs and confidence intervals where the NIE is not significant.</p>
</td></tr>
<tr><td><code>ns.nde</code></td>
<td>
<p>values of <code>Rho</code> with estimated NDEs and confidence intervals where the NDE is not significant.</p>
</td></tr>
<tr><td><code>rev.nie</code></td>
<td>
<p>values of <code>Rho</code> with estimated NIEs and confidence intervals where the NIE is reversed.</p>
</td></tr>
<tr><td><code>rev.nde</code></td>
<td>
<p>values of <code>Rho</code> with estimated NDEs and confidence intervals where the NDE is reversed.</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
