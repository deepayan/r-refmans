<!DOCTYPE html><html><head><title>Help for package siland</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {siland}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AIC.siland'>
<p>Akaike's An Information Criterion for siland package</p></a></li>
<li><a href='#BIC.siland'>
<p>Bayesian Information criterion</p></a></li>
<li><a href='#bufferforsiland'>
<p>Percentage of landscape variable in buffers.</p></a></li>
<li><a href='#dataSiland'>
<p>Simulated data</p></a></li>
<li><a href='#fitted.siland'>
<p>Extract siland model Fitted values</p></a></li>
<li><a href='#landSiland'>
<p>Simulated landscape.</p></a></li>
<li><a href='#landtoraster'>
<p>Transformation of an sf object into raster</p></a></li>
<li><a href='#plot.siland'>
<p>Plot an object of class siland</p></a></li>
<li><a href='#plotsiland'>
<p>Plot results from siland function</p></a></li>
<li><a href='#plotsiland.land'>
<p>Map of siland result</p></a></li>
<li><a href='#plotsiland.sif'>
<p>Plot the estimated spatial influence functions.</p></a></li>
<li><a href='#print.siland'>
<p>siland print</p></a></li>
<li><a href='#residuals.siland'>
<p>Extract siland Residuals</p></a></li>
<li><a href='#siland'>
<p>Estimation of landscape influence using siland method (Spatial Influence Function)</p></a></li>
<li><a href='#siland-package'>
<p>Spatial Influence of Landscape</p></a></li>
<li><a href='#siland.lik'>
<p>-(Loglikelihood) as a function of SIF parameters.</p></a></li>
<li><a href='#siland.quantile'>
<p>Quantile of  spatial influence function (SIF)</p></a></li>
<li><a href='#summary.siland'>
<p>The function gives a summary of an object of class siland</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Spatial Influence of Landscape</td>
</tr>
<tr>
<td>Version:</td>
<td>3.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-03-23</td>
</tr>
<tr>
<td>Author:</td>
<td>Carpentier F. and Martin O.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Martin Olivier &lt;olivier.martin@inrae.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Method to estimate the spatial influence scales of landscape variables on a response variable. The method is based on Chandler and Hepinstall-Cymerman (2016) Estimating the spatial scales of landscape effects on abundance, Landscape ecology, 31: 1383-1394, &lt;<a href="https://doi.org/10.1007%2Fs10980-016-0380-z">doi:10.1007/s10980-016-0380-z</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> | file LICENSE [expanded from: GPL (&ge; 2.0) | file LICENSE]</td>
</tr>
<tr>
<td>Depends:</td>
<td>base, graphics, stats, sf, R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>lme4, sp, raster, ggplot2, ggforce, fasterize, reshape2,
fields, methods</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-30 09:14:52 UTC; biosp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-30 14:20:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='AIC.siland'>
Akaike's An Information Criterion for siland package
</h2><span id='topic+AIC.siland'></span>

<h3>Description</h3>

<p>Function calculating thue usual Akaike's 'An Information Criterion' for an object of class siland, according to the formula -2*loglikelihood+k*npar, with npar the number of parameters of the model and k = 2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'siland'
AIC(object,...,k=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AIC.siland_+3A_object">object</code></td>
<td>
<p> an object of class siland</p>
</td></tr>
<tr><td><code id="AIC.siland_+3A_...">...</code></td>
<td>
<p>Dots are not take into account in this version</p>
</td></tr>
<tr><td><code id="AIC.siland_+3A_k">k</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p> AIC value
</p>


<h3>Author(s)</h3>

<p>O. Martin
</p>


<h3>References</h3>

<p>Sakamoto, Y., Ishiguro, M., and Kitagawa G. (1986). Akaike Information Criterion Statistics. D. Reidel Publishing Company.
</p>

<hr>
<h2 id='BIC.siland'>
Bayesian Information criterion
</h2><span id='topic+BIC.siland'></span>

<h3>Description</h3>

<p>Function computing the Bayesian Information Criterion for an object of class siland, according to the formula -2*loglikelihood+k*npar, with npar the number of parameters of the model and k = log(n) (n being the number of observations).</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'siland'
BIC(object,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BIC.siland_+3A_object">object</code></td>
<td>
<p> an object of class siland</p>
</td></tr>
<tr><td><code id="BIC.siland_+3A_...">...</code></td>
<td>
<p>Dots are not take into account in this version</p>
</td></tr>
</table>


<h3>Value</h3>

<p>BIC value
</p>


<h3>Author(s)</h3>

<p>O. Martin
</p>

<hr>
<h2 id='bufferforsiland'>
Percentage of landscape variable in buffers.
</h2><span id='topic+bufferforsiland'></span>

<h3>Description</h3>

<p>Function computing the percentages of landscape variables in buffers of given sizes (i.e. radii). </p>


<h3>Usage</h3>

<pre><code class='language-R'>bufferforsiland(d, sfGIS, loc.sf, landnames, border = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bufferforsiland_+3A_d">d</code></td>
<td>

<p>a vector of the distances of the buffer sizes. The length of <code>d</code> has to be equal to that of <code>landnames</code>.
</p>
</td></tr>
<tr><td><code id="bufferforsiland_+3A_sfgis">sfGIS</code></td>
<td>

<p>an object of class sf containing the landscape variables (land uses). Landscape variables are equal to 1 (presence) or 0 (absence).
</p>
</td></tr>
<tr><td><code id="bufferforsiland_+3A_loc.sf">loc.sf</code></td>
<td>

<p>an object of class sf or a dataframe containing locations of buffers centers. For dataframe, locations have to be given in columns &quot;X&quot; and &quot;Y&quot;.
</p>
</td></tr>
<tr><td><code id="bufferforsiland_+3A_landnames">landnames</code></td>
<td>

<p>a vector of characters of the names of the landscape variables
</p>
</td></tr>
<tr><td><code id="bufferforsiland_+3A_border">border</code></td>
<td>

<p>a logical (<code>FALSE</code> by default). If <code>border=FALSE</code>  buffers are computed from the locations points given in <code>loc.sf</code> If <code>border=TRUE</code> buffers  are computed from the border of the polygon that contain the points in <code>loc.sf</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe containing the percentages of the landscape variables named <code>landnames</code> (in columns) in buffers of sizes described in <code>d</code> and centered on locations described in <code>loc.sf</code> (in rows).
</p>


<h3>Author(s)</h3>

<p>Martin O.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(dataSiland)
data(landSiland)
dataSiland[1:10,c("X","Y")]
landSiland$L1
landSiland$L2

res=bufferforsiland(c(100,200),sfGIS=landSiland, loc.sf=dataSiland, landnames=c("L1","L2"))
res



</code></pre>

<hr>
<h2 id='dataSiland'>
Simulated data
</h2><span id='topic+dataSiland'></span>

<h3>Description</h3>

<p>Simulated data of response variable and local variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dataSiland")</code></pre>


<h3>Format</h3>

<p>A data frame with 100 observations on 5 variables.
</p>

<table>
<tr>
 <td style="text-align: right;">
    [,1] </td><td style="text-align: left;"> X   </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> location on X-axis </td>
</tr>
<tr>
 <td style="text-align: right;">
    [,2] </td><td style="text-align: left;"> Y </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> location on Y-axis</td>
</tr>
<tr>
 <td style="text-align: right;">
    [,3] </td><td style="text-align: left;"> x1    </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> a continous local variable</td>
</tr>
<tr>
 <td style="text-align: right;">
    [,4] </td><td style="text-align: left;"> Id   </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> identifier</td>
</tr>
<tr>
 <td style="text-align: right;">
    [,5] </td><td style="text-align: left;"> obs    </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> response variable
  </td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>
data(dataSiland)
plot(dataSiland[,c("X","Y")])

</code></pre>

<hr>
<h2 id='fitted.siland'>
Extract siland model Fitted values
</h2><span id='topic+fitted.siland'></span>

<h3>Description</h3>

<p>Function extracting fitted values of an object of class siland.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'siland'
fitted(object,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.siland_+3A_object">object</code></td>
<td>
<p>an object of class siland</p>
</td></tr>
<tr><td><code id="fitted.siland_+3A_...">...</code></td>
<td>
<p> Dots are not take into accounbt in this version</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Fitted values extracted from the object <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>O. Martin
</p>

<hr>
<h2 id='landSiland'>
Simulated landscape.
</h2><span id='topic+landSiland'></span>

<h3>Description</h3>

<p>Simulated landscape associated to dataSiland, containing two landscape variables, named L1 and L2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("landSiland")</code></pre>


<h3>Format</h3>

<p>A <code>sf</code> object with 4884 observations on 3 variables.
</p>

<table>
<tr>
 <td style="text-align: right;">
    [,1] </td><td style="text-align: left;">  L1     </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> presence/absence of L1 (0/1) </td>
</tr>
<tr>
 <td style="text-align: right;">
    [,2] </td><td style="text-align: left;"> L2  </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> presence/absence of L2 (0/1)</td>
</tr>
<tr>
 <td style="text-align: right;">
    [,3] </td><td style="text-align: left;"> geometry   </td><td style="text-align: left;"> sfc_MULTIPOLYGON </td><td style="text-align: left;"> polygon location</td>
</tr>
<tr>
 <td style="text-align: right;">

  </td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>
data(landSiland)
plot(landSiland$geometry)
plot(landSiland[landSiland$L1==1,]$geometry,col=2,add=TRUE)
plot(landSiland[landSiland$L2==1,]$geometry,col=3,add=TRUE)




</code></pre>

<hr>
<h2 id='landtoraster'>
Transformation of an sf object into raster
</h2><span id='topic+landtoraster'></span>

<h3>Description</h3>

<p>Function transforming an object of class sf into raster (points grid) with <code>wd</code>, the pixel size of the raster. <code>landname</code> gives the variable names for which raster points have to be computed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>landtoraster(landgis, landname, wd)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="landtoraster_+3A_landgis">landgis</code></td>
<td>

<p>an object of class sf
</p>
</td></tr>
<tr><td><code id="landtoraster_+3A_landname">landname</code></td>
<td>

<p>vector of names of landscape variable for which rasters are computed.
</p>
</td></tr>
<tr><td><code id="landtoraster_+3A_wd">wd</code></td>
<td>

<p>numeric, pixels size of raster
</p>
</td></tr>
</table>


<h3>Value</h3>






<p>a list of dataframes. The components of the list correspond to variables specifed in argument landname. Each dataframe gives the X and Y locations of pixels in raster.
</p>


<h3>Author(s)</h3>

<p>O. Martin
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##---- Should be DIRECTLY executable !! ----
##-- ==&gt;  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.

data(dataSiland)
data(landSiland)
head(dataSiland)
head(landSiland)
u=landtoraster(landSiland,c("L1","L2"),wd=20)
names(u)
du1=as.data.frame(raster::rasterToPoints(u[[1]]))
du2=as.data.frame(raster::rasterToPoints(u[[2]]))
plot(du1[,1:2],type="n")
sel1=du1[,3]==1
sel2=du2[,3]==1
points(du1[sel1,c(1,2)],pch=".",col=1)
points(du2[sel2,c(1,2)],pch=".",col=2)




</code></pre>

<hr>
<h2 id='plot.siland'>
Plot an object of class siland
</h2><span id='topic+plot.siland'></span>

<h3>Description</h3>

<p>This function calls the function plot.lm() and plot the object result stored in x
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'siland'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.siland_+3A_x">x</code></td>
<td>

<p>an object of class siland
</p>
</td></tr>
<tr><td><code id="plot.siland_+3A_...">...</code></td>
<td>

<p>the same options as for the function plot.lm()
</p>
</td></tr>
</table>

<hr>
<h2 id='plotsiland'>
Plot results from siland function
</h2><span id='topic+plotsiland'></span>

<h3>Description</h3>

<p>Plot locations of observed data and locations of landscape variables. The black points correspond to the locations of observed data, and the size is propotional to numeric values. The locations of different landscape variables are displayed with small points of different colours. Estimated mean distance of spatial influence for each landscape variable is indicated beside the graphic with a continuous line. Dashed line indicates the radius that gives 95 percent of the total influence of each landscape variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotsiland(res, land, data)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotsiland_+3A_res">res</code></td>
<td>
<p> an object obtained from the function siland

</p>
</td></tr>
<tr><td><code id="plotsiland_+3A_land">land</code></td>
<td>
<p>an object of class sf that gives the landscape variables

</p>
</td></tr>
<tr><td><code id="plotsiland_+3A_data">data</code></td>
<td>
<p> a dataframe with the response variable and the local variables

</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class ggplot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(dataSiland)
data(landSiland)
res=siland(obs~x1+L1+L2,land=landSiland,data=dataSiland,sif="exponential")
plotsiland(res,landSiland, dataSiland)

</code></pre>

<hr>
<h2 id='plotsiland.land'>
Map of siland result
</h2><span id='topic+plotsiland.land'></span>

<h3>Description</h3>

<p>Function creating a map of siland result, i.e. estimatied spatial influence of each landscape variable or for the cumulative effect of all variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotsiland.land(x, land, data, var = 0, lw = 100, xlim=NULL, ylim=NULL,plot=T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotsiland.land_+3A_x">x</code></td>
<td>

<p>an object resulting from  <code>siland</code>
</p>
</td></tr>
<tr><td><code id="plotsiland.land_+3A_land">land</code></td>
<td>

<p>the object of class sf describing the landscape variable, i.e. the <code>land</code> argument in the call to the <code>siland</code> function that computed <code>x</code>
</p>
</td></tr>
<tr><td><code id="plotsiland.land_+3A_data">data</code></td>
<td>

<p>the dataframe describing response variable and the local variables, i.e. the  <code>data</code> argument in the call to the siland function that computed <code>x</code>.
</p>
</td></tr>
<tr><td><code id="plotsiland.land_+3A_var">var</code></td>
<td>

<p>a vector containing the numbers (numeric) of the mapped landscape variables. If <code>var=0</code> (by default), the cumulative effect of all landscape variables is represented.
</p>
</td></tr>
<tr><td><code id="plotsiland.land_+3A_lw">lw</code></td>
<td>

<p>the number of pixels on x-axis and y-axis for the graphical representation. A too high value can lead to memory allocation problems. By default lw=100.
</p>
</td></tr>
<tr><td><code id="plotsiland.land_+3A_xlim">xlim</code></td>
<td>

<p>a length-2 numeric vector, lower and upper limits of x-axis.
</p>
</td></tr>
<tr><td><code id="plotsiland.land_+3A_ylim">ylim</code></td>
<td>

<p>a length-2 numeric vector, lower and upper limits of y-axis.
</p>
</td></tr>
<tr><td><code id="plotsiland.land_+3A_plot">plot</code></td>
<td>

<p>a logical (TRUE by default). If TRUE, the result is a graphic. If FALSE, the result is a dataframe of the	cumulative spatial influence of the landscape variable(s) var.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class ggplot
</p>


<h3>See Also</h3>

<p>siland
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(dataSiland)
data(landSiland)
res=siland(obs~x1+L1+L2,land=landSiland,data=dataSiland,sif="exponential")
plotsiland.land(x=res,land=landSiland,data=dataSiland)
#plotsiland.land(x=res,land=landSiland,data=dataSiland,var=1,lw=20)
#plotsiland.land(x=res,land=landSiland,data=dataSiland,var=2,lw=20)

</code></pre>

<hr>
<h2 id='plotsiland.sif'>
Plot the estimated spatial influence functions.
</h2><span id='topic+plotsiland.sif'></span>

<h3>Description</h3>

<p>Graphic representations for the different influence functions estimated with the function siland().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotsiland.sif(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotsiland.sif_+3A_x">x</code></td>
<td>

<p>an object obtained with function siland().
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no value is returned
</p>


<h3>See Also</h3>

<p>siland
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(dataSiland)
data(landSiland)
res=siland(obs~x1+L1+L2,land=landSiland,data=dataSiland,sif="exponential")
plotsiland.sif(x=res)


</code></pre>

<hr>
<h2 id='print.siland'>
siland print
</h2><span id='topic+print.siland'></span>

<h3>Description</h3>

<p>function printing an object of class siland. It returns the model used and the estimated parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'siland'
print(x,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.siland_+3A_x">x</code></td>
<td>
<p>an object of class siland</p>
</td></tr>
<tr><td><code id="print.siland_+3A_...">...</code></td>
<td>
<p>not take into account in this version</p>
</td></tr>
</table>

<hr>
<h2 id='residuals.siland'>
Extract siland Residuals
</h2><span id='topic+residuals.siland'></span>

<h3>Description</h3>

<p>Function extracting residuals for an estimated siland model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'siland'
residuals(object,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.siland_+3A_object">object</code></td>
<td>
<p>an object of class siland</p>
</td></tr>
<tr><td><code id="residuals.siland_+3A_...">...</code></td>
<td>
<p>Dots are not take into account in this version</p>
</td></tr>
</table>

<hr>
<h2 id='siland'>
Estimation of landscape influence using siland method (Spatial Influence Function)
</h2><span id='topic+siland'></span>

<h3>Description</h3>

<p>Function estimating landscape effect (and eventual local effects) using siland method, i.e. estimating simultaneously : the SIF parameter (i.e. mean distance of SIF) and the effect of each landscape variable (and the effect of each local variable).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>siland(formula,land,data,family ="gaussian",sif="exponential", init = 100,
 border=F,wd=50,maxD=3000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="siland_+3A_formula">formula</code></td>
<td>

<p>a symbolic description (see lm() or glm()) of the model to be fitted. The details of model specification are given under 'Details'.
</p>
</td></tr>
<tr><td><code id="siland_+3A_land">land</code></td>
<td>

<p>an object of class sf containing the landscape variables.
</p>
</td></tr>
<tr><td><code id="siland_+3A_data">data</code></td>
<td>

<p>a dataframe containing the response variable and the local variables.
</p>
</td></tr>
<tr><td><code id="siland_+3A_family">family</code></td>
<td>

<p>the distribution of response variable. <code>family</code> can be &quot;gaussian&quot;, &quot;poisson&quot; or &quot;binomial&quot; and the associated link function are identity, log and logit respectively.
</p>
</td></tr>
<tr><td><code id="siland_+3A_sif">sif</code></td>
<td>

<p>the family of the Spatial Influence Function. <code>sif</code> can be &quot;exponential&quot;, &quot;gaussian&quot; or &quot;uniform&quot;.
</p>
</td></tr>
<tr><td><code id="siland_+3A_init">init</code></td>
<td>

<p>a vector indicating the starting values for SIF parameters in the estimation procedure. By default, starting values of SIF parameters of all landscape variable are equal to 100.
</p>
</td></tr>
<tr><td><code id="siland_+3A_border">border</code></td>
<td>

<p>a logical indicating wether the spatial influence of the polygon where observations are located is taken into account.
If <code>border=FALSE</code>, all pixels of a landscape variable have a spatial influence whether or not they belong to the polygon where the observation is located. If <code>border=TRUE</code>, only pixels outside the polygon of the observation, i.e. from the border of the polygon have an influence on this observation.
</p>
</td></tr>
<tr><td><code id="siland_+3A_wd">wd</code></td>
<td>

<p>a numeric, the size of pixels.
</p>
</td></tr>
<tr><td><code id="siland_+3A_maxd">maxD</code></td>
<td>

<p>a numeric, give the maximum distance used to evaluate the influence of pixel on each observation. It is recommanded that maxD is greater than three times the greatest SIF value.
</p>
</td></tr>



</table>


<h3>Details</h3>

<p>The siland method is based on the model:
</p>
<p style="text-align: center;"><code class="reqn"> E(Y_i)= \mu + \sum_l \alpha_l x_{l,i}+ \sum_k \beta_k (\sum_r f_{\delta_k}(d_{r,i})z^k_r) </code>
</p>

<p>with
</p>

<ul>
<li><p> Y_i, response variable,
</p>
</li>
<li><p> x_l,i, local variable l,
</p>
</li>
<li><p> r, the discritzation of study site in pixels r
</p>
</li>
<li><p> z^k_r, the value of the landscape variable k at the pixel r. If the landscape variable k is a presence/absence variable, z^k_r is equal to one or zero.
</p>
</li>
<li> <p><code class="reqn">\mu</code>, the intercept
</p>
</li>
<li> <p><code class="reqn">\alpha_l</code> and <code class="reqn">\beta_k</code>, the effects of local and landscape variables, respectively.
</p>
</li>
<li> <p><code class="reqn">f_{\delta_k}</code>,the SIF associated with the landscape variable k with parameter <code class="reqn">\delta_k</code> (the mean distance of the SIF, see detail further)
</p>
</li>
<li><p> d_r,i the distance between the center of pixel r and the observation at site i.
</p>
</li></ul>

<p>All parameters, <code class="reqn">\mu</code>, <code class="reqn"> {\alpha_1,\dots,\alpha_L}</code>, <code class="reqn"> {\beta_1,\dots,\beta_K}</code>  but also <code class="reqn"> {\delta_1,\dots,\delta_K}</code> SIF parameters of the landscape variables are simultaneously estimated by likelihood maximization.
</p>
<p>Models for <var>siland</var> have the form <code>response ~ terms</code>  where <code>response</code> is the columns name of the response variable in <code>data</code> and <code>terms</code> is a series of terms which specifies the names of landscape and local explanatory variables. The explanatory variables described in <code>data</code> are considered as local in the model, those described in the sf object <code>land</code> are considered as landscape variables.
</p>
<p>For local variables, random effects can be considered using the syntax <code>(1|x)</code> similar to package lme4 (see lmer() function in package lme4). Interaction terms are not yet implemented in <code>siland</code> contrary to <code>Bsiland</code>.
</p>
<p>The explanatory variables are added using the symbol <code>"+"</code>. Interaction terms can be considered using the usual symbols  <code>"*"</code> or  <code>":"</code>. Notice that only interactions between local x local and local x landscape variables are considered.
</p>
<p>Two families of SIF are currently implemented in the siland package, exponential and Gaussian families defined as  <code class="reqn">f_\delta(d)=2/(\pi\delta^2)exp(-2d/\delta)</code> and  <code class="reqn">f\delta(d)=1/(2\delta \sqrt \pi)exp(-d\pi/(2\delta))^2</code>, respectively. By definition,  <code class="reqn">\delta</code> represents the mean distance of these SIF.
</p>
<p>The computation of the spatial influence of landscape variables is based on an approximation through the description of landscape variables distribution along a regular grid (modelisation of spatial influence of each pixel of landscape variable). The choice of <code>wd</code>, the size of pixels can have an impact on the estimation. The smaller the pixels, the more accurate the approximation, but also the longer the computation time. In our experience, we recommend using a pixel size at most three times smaller than the smallest estimated mean distance among the landscape variables SIF.
</p>


<h3>Value</h3>

<p>siland returns an object of type siland, a list :
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>a vector of the estimated coefficients</p>
</td></tr>
<tr><td><code>paramSIF</code></td>
<td>
<p>a vector of the estimated parameters of SIF</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>an object of class formula that indicates the model</p>
</td></tr>
<tr><td><code>landcontri</code></td>
<td>
<p>a dataframe of estimated cumulative influence of each landscape variable (in columns) on each observation (in rows).</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>the estimated maximum loglikelihood</p>
</td></tr>
<tr><td><code>loglik0</code></td>
<td>
<p>the estimated maximum loglikelihood of the local model (no landscape variable)</p>
</td></tr>
<tr><td><code>result</code></td>
<td>
<p>a lm/glm/lmer object that corresponds to the model estimate knowing the estimated SIF parameters of landscape variables. </p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>the fitted values</p>
</td></tr>
<tr><td><code>sif</code></td>
<td>
<p>the family of the SIF</p>
</td></tr>
<tr><td><code>resoptim</code></td>
<td>
<p>an object of class optim or optimize giving informations about the optimization procedure see optim() or optimize() for further details.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>the akaike information criterion of the model</p>
</td></tr>
<tr><td><code>AIC0</code></td>
<td>
<p>the akaike information criterion of the local model (no landscape variable)</p>
</td></tr>
<tr><td><code>nparam</code></td>
<td>
<p>the number of parameters </p>
</td></tr>
<tr><td><code>pval0</code></td>
<td>
<p>the p.value of the test of the landscape effect (the global effect of all spatial variables). Issued from the likelihood ratio test of the (complete) model vs the local model (complete model without landscape variables).</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>the family distribution for the model</p>
</td></tr>
<tr><td><code>sd.error</code></td>
<td>
<p>the estimated standard error for gaussian family, NA in other case</p>
</td></tr>
<tr><td><code>model.Type</code></td>
<td>
<p>the type of local model: GLM for generalised model, LMM for linear mixed model or GLMM for generalised linear mixed model</p>
</td></tr>
<tr><td><code>rand.StdDev</code></td>
<td>
<p>the estimated standard deviation of random effects for LMM or GLMM</p>
</td></tr>
<tr><td><code>err</code></td>
<td>
<p>the estimated residuals</p>
</td></tr>
<tr><td><code>border</code></td>
<td>
<p>a logical indicating the value used for estimation</p>
</td></tr>
<tr><td><code>wd</code></td>
<td>
<p>a number indicating the size of pixels</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Carpentier, F. and Martin, O.
</p>


<h3>References</h3>

<p>Carpentier, F., &amp; Martin, O. (2019). SILand: an R package for estimating the spatial influence of landscape. bioRxiv, 692566.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(dataSiland)
data(landSiland)
res=siland(obs~x1+L1+L2,land=landSiland,data=dataSiland,sif="exponential")
res
res$AIC


</code></pre>

<hr>
<h2 id='siland-package'>
Spatial Influence of Landscape
</h2><span id='topic+siland-package'></span>

<h3>Description</h3>

<p>Method to estimate the spatial influence scales of landscape variables on a response variable. The method is based on Chandler and Hepinstall-Cymerman (2016) Estimating the spatial scales of landscape effects on abundance, Landscape ecology, 31: 1383-1394, &lt;doi:10.1007/s10980-016-0380-z&gt;. This package allows for analyzing the effect of landscape features on georeferenced point observations (described in a Geographic Information System shapefile format). It simultaneously estimates the spatial scales and intensities of landscape variable effects. It does not require any information about the scale of effect. It allows for effects tests, effects maps and models comparison.
\
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> siland</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Spatial Influence of Landscape</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 3.0.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-03-23</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Carpentier F. and Martin O.</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Martin Olivier &lt;olivier.martin@inrae.fr&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Method to estimate the spatial influence scales of landscape variables on a response variable. The method is based on Chandler and Hepinstall-Cymerman (2016) Estimating the spatial scales of landscape effects on abundance, Landscape ecology, 31: 1383-1394, &lt;doi:10.1007/s10980-016-0380-z&gt;.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2.0) | file LICENSE</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> base, graphics, stats, sf, R (&gt;= 3.5.0)</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> lme4, sp, raster, ggplot2, ggforce, fasterize, reshape2, fields, methods</td>
</tr>
<tr>
 <td style="text-align: left;">
NeedsCompilation: </td><td style="text-align: left;"> no</td>
</tr>
<tr>
 <td style="text-align: left;">
Packaged: </td><td style="text-align: left;"> 2019-11-13 12:46:55 UTC; omartin</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> knitr,
rmarkdown</td>
</tr>
<tr>
 <td style="text-align: left;">
VignetteBuilder: </td><td style="text-align: left;"> knitr</td>
</tr>
<tr>
 <td style="text-align: left;">
RoxygenNote: </td><td style="text-align: left;"> 7.1.2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
AIC.siland              Akaike's An Information Criterion for siland
                        package
BIC.siland              Bayesian Information criterion
bufferforsiland         Percentage of landscape variable in buffers.
dataSiland              Simulated data
fitted.siland           Extract siland model Fitted values
landSiland              Simulated landscape.
landtoraster            Transformation of an sf object into raster
plot.siland             Plot an object of class siland
plotsiland              Plot results from siland function
plotsiland.land         Map of siland result
plotsiland.sif          Plot the estimated spatial influence functions.
print.siland            siland print
residuals.siland        Extract siland Residuals
siland                  Estimation of landscape influence using siland
                        method (Spatial Influence Function)
siland-package          Spatial Influence of Landscape
siland.lik              -(Loglikelihood) as a function of SIF
                        parameters.
siland.quantile         Quantile of spatial influence function (SIF)
summary.siland          The function gives a summary of an object of
                        class siland
</pre>


<h3>Author(s)</h3>

<p>Carpentier F. and Martin O.
Maintainer: Martin Olivier &lt;olivier.martin@inrae.fr&gt;
</p>

<hr>
<h2 id='siland.lik'>
-(Loglikelihood) as a function of SIF parameters.
</h2><span id='topic+siland.lik'></span>

<h3>Description</h3>

<p>Function investigating eventual optimization problems during numerical optimization of function siland by plotting the -(loglikelihhod) against parameters of Spatial Influence Functions (SIF) of each landscape variable. The parameter of a SIF is defined as the mean distance of SIF.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>siland.lik(res, land,data, varnames = NULL, seqd = seq(2, 2000, length = 10))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="siland.lik_+3A_res">res</code></td>
<td>

<p>an object resulting from siland
</p>
</td></tr>
<tr><td><code id="siland.lik_+3A_land">land</code></td>
<td>

<p>the object of class sf describing the landscape variable, i.e. the  <code>land</code>&quot; argument in the call to the siland function that computed <code>res</code>.
</p>
</td></tr>
<tr><td><code id="siland.lik_+3A_data">data</code></td>
<td>

<p>the dataframe describing response variable and the local variables, i.e. the  <code>data</code> argument in the call to the siland function that computed <code>res</code>.
</p>
</td></tr>
<tr><td><code id="siland.lik_+3A_varnames">varnames</code></td>
<td>

<p>a vector containing the names (characters) of studied landscape variables. If varnames is <code>NULL</code> (by default), all landscape variables of the <code>res</code> model are considered.
</p>
</td></tr>
<tr><td><code id="siland.lik_+3A_seqd">seqd</code></td>
<td>

<p>a vector of SIF parameters (positive values) for which the -loglikelihood is computed.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As with all numerical maximisation procedures, optimization problems may arise. The function <code>siland.lik</code> allows to point out possible problems of optimization.
</p>
<p><code>siland.lik</code> plots the -Loglikelihood against SIF parameters. During the siland procedure, the estimation of SIF parameters is made by maximazing the likelihood i.e. by minimizing the -Loglikelihood. The orange horizontal line indicates the minimal value of -Loglikelihood obtained during the estimation (<code>res</code> result).
The other continous curves represent the -loglikehood as a function of SIF parameters for each studied landscape variable (considering the other parameters of the model at their estimated value in <code>res</code>). The dotted lines indicate the values of SIF parameter estimated (<code>res</code> result).
</p>
<p>When the minization correctly occurs, the minimal values of the -loglikelihoods for each landscape variable are equal to the value of the estimated minimal -Loglikelihood. This means that the value of each continuous curves is minimal at its intersection with the orange horizontal line. This also means that dotted lines intersect their associated continuous lines at their minimum.
</p>
<p>If it is not the case, the minimizing procedure has failed and it is necessary to proceed again with an estimation with different initialisation values. This is possible with the argument <code>init</code> in function  <code>siland</code>.
</p>



<h3>Value</h3>






<p>a ggplot of the -(loglikelihhod) against SIF parameters of each landscape variables.
</p>


<h3>Author(s)</h3>


<p>O. Martin and F. Carpentier
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(dataSiland)
data(landSiland)
res=siland(obs~x1+L1+L2,data=dataSiland,land=landSiland)
siland.lik(res,dataSiland,land=landSiland,varnames=c("L1","L2"),seqd=seq(5,500,length=20))

# Illustration of failed estimation caused by wrong initial
# values (chosen initial values that are deliberately and obviously far too high)
# In a such case, the estimation should be done again ,
# by  calling siland with init=c(250,250) for instance.

res2=siland(obs~x1+L1+L2,data=dataSiland,land=landSiland,init=c(20000,20000))
siland.lik(res2,dataSiland,land=landSiland,varnames=c("L1","L2"),seqd=seq(1e9,1e10,length=20))


</code></pre>

<hr>
<h2 id='siland.quantile'>
Quantile of  spatial influence function (SIF)
</h2><span id='topic+siland.quantile'></span>

<h3>Description</h3>

<p>function computing quantiles of SIF, i.e. the radius of disk on which the integrated influence of the SIF is equal to given proportions, <code>p</code>. Calculations are performed for the estimated SIF of each landscape variable in <code>x</code>.The <b>area of medium influence and significant influence of a landscape variable</b>, that we defined as the disc containing 50% and 95% of the influence of the SIF (neglecting 50% and 5% of its broader effect) respectively can be computed using argument <code> p = 0.5</code> and <code> p = 0.95</code>, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>siland.quantile(x, p = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="siland.quantile_+3A_x">x</code></td>
<td>

<p>an object of class siland resulting from function <code>siland</code>
</p>
</td></tr>
<tr><td><code id="siland.quantile_+3A_p">p</code></td>
<td>

<p>a vector of probabilities
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of the radii of disks on wich the integrated influences of the SIF estimated for each landscape variable of <code>x</code> (in columns) are equal to each probability of the vector <code>p</code> (in rows).
</p>


<h3>Author(s)</h3>

<p>O. Martin and F. Carpentier
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(dataSiland)
data(landSiland)
res=siland(obs~x1+L1+L2,land=landSiland,data=dataSiland,sif="exponential")
#siland.quantile(x=res,p=c(0.5,0.95))


</code></pre>

<hr>
<h2 id='summary.siland'>
The function gives a summary of an object of class siland
</h2><span id='topic+summary.siland'></span>

<h3>Description</h3>


<p>The function gives a detailed summary of an object of class siland. It gives
results as the summary for an object of type glm or lm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'siland'
summary(object,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.siland_+3A_object">object</code></td>
<td>


<p>an object of type siland
</p>
</td></tr>
<tr><td><code id="summary.siland_+3A_...">...</code></td>
<td>


<p>Dots are not take into account in this version
</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
