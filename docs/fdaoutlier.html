<!DOCTYPE html><html><head><title>Help for package fdaoutlier</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fdaoutlier}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#band_depth'><p>Compute the band depth for a sample of curves/observations.</p></a></li>
<li><a href='#dir_out'><p>Dai &amp; Genton (2019) Directional outlyingness for univariate or multivariate functional data.</p></a></li>
<li><a href='#directional_quantile'><p>Compute directional quantile outlyingness for a sample of discretely observed curves</p></a></li>
<li><a href='#extremal_depth'><p>Compute extremal depth for functional data</p></a></li>
<li><a href='#extreme_rank_length'><p>Compute the Extreme Rank Length Depth.</p></a></li>
<li><a href='#functional_boxplot'><p>Functional Boxplot for a sample of functions.</p></a></li>
<li><a href='#hardin_factor_numeric'><p>Compute F distribution factors for approximating the tail of the distribution of robust MCD distance.</p></a></li>
<li><a href='#linfinity_depth'><p>Compute the L-infinity depth of a sample of curves/functions.</p></a></li>
<li><a href='#modified_band_depth'><p>Compute the modified band depth for a sample of curves/functions.</p></a></li>
<li><a href='#msplot'><p>Outlier Detection using Magnitude-Shape Plot (MS-Plot) based on the directional outlyingness for functional</p>
data.</a></li>
<li><a href='#muod'><p>Massive Unsupervised Outlier Detection (MUOD)</p></a></li>
<li><a href='#plot_dtt'><p>Plot Data from simulation models</p></a></li>
<li><a href='#projection_depth'><p>Random projection for multivariate data</p></a></li>
<li><a href='#seq_transform'><p>Find and classify outliers functional outliers using Sequential Transformation</p></a></li>
<li><a href='#simulation_model1'><p>Convenience function for generating functional data</p></a></li>
<li><a href='#simulation_model2'><p>Convenience function for generating functional data</p></a></li>
<li><a href='#simulation_model3'><p>Convenience function for generating functional data</p></a></li>
<li><a href='#simulation_model4'><p>Convenience function for generating functional data</p></a></li>
<li><a href='#simulation_model5'><p>Convenience function for generating functional data</p></a></li>
<li><a href='#simulation_model6'><p>Convenience function for generating functional data</p></a></li>
<li><a href='#simulation_model7'><p>Convenience function for generating functional data</p></a></li>
<li><a href='#simulation_model8'><p>Convenience function for generating functional data</p></a></li>
<li><a href='#simulation_model9'><p>Convenience function for generating functional data</p></a></li>
<li><a href='#spanish_weather'><p>Spanish Weather Data</p></a></li>
<li><a href='#total_variation_depth'><p>Total Variation Depth and Modified Shape Similarity Index</p></a></li>
<li><a href='#tvd_mss'><p>Outlier detection using the total variation depth and modified shape similarity index.</p></a></li>
<li><a href='#world_population'><p>World Population Data by Countries</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Outlier Detection Tools for Functional Data Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>A collection of functions for outlier detection in functional data analysis. 
  Methods implemented include directional outlyingness by 
  Dai and Genton (2019) &lt;<a href="https://doi.org/10.1016%2Fj.csda.2018.03.017">doi:10.1016/j.csda.2018.03.017</a>&gt;,
  MS-plot by Dai and Genton (2018) &lt;<a href="https://doi.org/10.1080%2F10618600.2018.1473781">doi:10.1080/10618600.2018.1473781</a>&gt;,
  total variation depth and modified shape similarity index by 
  Huang and Sun (2019) &lt;<a href="https://doi.org/10.1080%2F00401706.2019.1574241">doi:10.1080/00401706.2019.1574241</a>&gt;, and sequential transformations by
  Dai et al. (2020) &lt;doi:10.1016/j.csda.2020.106960 among others. Additional outlier detection
  tools and depths for functional data like functional boxplot, (modified) band depth etc.,
  are also available. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/otsegun/fdaoutlier">https://github.com/otsegun/fdaoutlier</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/otsegun/fdaoutlier/issues">https://github.com/otsegun/fdaoutlier/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 2.1.0), covr, spelling, knitr, rmarkdown</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-29 13:42:51 UTC; segun</td>
</tr>
<tr>
<td>Author:</td>
<td>Oluwasegun Taiwo Ojo
    <a href="https://orcid.org/0000-0001-9629-6990"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre,
    cph],
  Rosa Elvira Lillo [aut],
  Antonio Fernandez Anta [aut, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Oluwasegun Taiwo Ojo &lt;seguntaiwoojo@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-30 22:40:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='band_depth'>Compute the band depth for a sample of curves/observations.</h2><span id='topic+band_depth'></span>

<h3>Description</h3>

<p>This function computes the band depth of López-Pintado and Romo (2009)
<a href="https://doi.org/10.1198/jasa.2009.0108">doi:10.1198/jasa.2009.0108</a>. Bands
of 2 functions are always considered using  the fast algorithm of Sun et al. (2012)
<a href="https://doi.org/10.1002/sta4.8">doi:10.1002/sta4.8</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>band_depth(dt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="band_depth_+3A_dt">dt</code></td>
<td>
<p>A matrix or data frame of size <code class="reqn">n</code> observations/curves by <code class="reqn">p</code> domain/evaluation points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of size <code>nrow(dt)</code> containing the band depth values of each curve.
</p>


<h3>References</h3>

<p>López-Pintado, S., &amp; Romo, J. (2009). On the Concept of Depth for Functional Data.
<em>Journal of the American Statistical Association</em>, 104(486), 718-734.
</p>
<p>Sun, Y., Genton, M. G., &amp; Nychka, D. W. (2012). Exact fast computation of band depth for large functional datasets:
How quickly can one million curves be ranked?. <em>Stat</em>, 1(1), 68-74.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dt1 &lt;- simulation_model1()
bd2 &lt;- band_depth(dt = dt1$data)

</code></pre>

<hr>
<h2 id='dir_out'>Dai &amp; Genton (2019) Directional outlyingness for univariate or multivariate functional data.</h2><span id='topic+dir_out'></span>

<h3>Description</h3>

<p>Compute the directional outlyingness of a univariate or multivariate functional data
based on Dai and Genton (2019) <a href="https://doi.org/10.1016/j.csda.2018.03.017">doi:10.1016/j.csda.2018.03.017</a>
and Dai and Genton (2018) <a href="https://doi.org/10.1080/10618600.2018.1473781">doi:10.1080/10618600.2018.1473781</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dir_out(
  dts,
  data_depth = "random_projections",
  n_projections = 200L,
  seed = NULL,
  return_distance = TRUE,
  return_dir_matrix = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dir_out_+3A_dts">dts</code></td>
<td>
<p>A matrix (or data frame) for univariate functional data (of size <code>n</code> observations by <code>p</code> domain
points) or a 3-dimensional array for multivariate functional data (of size <code>n</code>
observations by <code>p</code> domain points by <code>d</code> dimension).</p>
</td></tr>
<tr><td><code id="dir_out_+3A_data_depth">data_depth</code></td>
<td>
<p>The method for computing the depth. The random projection depth is
always used as suggested in Dai and Genton (2018) <a href="https://doi.org/10.1080/10618600.2018.1473781">doi:10.1080/10618600.2018.1473781</a>.
Support for more depth methods will be added.</p>
</td></tr>
<tr><td><code id="dir_out_+3A_n_projections">n_projections</code></td>
<td>
<p>The number of directions for computing random projection depth. By default,
200 random directions are generated from a scaled uniform distribution between -1 and 1.</p>
</td></tr>
<tr><td><code id="dir_out_+3A_seed">seed</code></td>
<td>
<p>An integer indicating the seed to set when generating the random directions. Defaults to NULL
in which case a seed is not set.</p>
</td></tr>
<tr><td><code id="dir_out_+3A_return_distance">return_distance</code></td>
<td>
<p>A logical value. If TRUE, returns: a matrix whose columns are
the mean and variation of directional outlyingness, the mahalanobis distance of the
observations of this matrix, and the robust estimate of the mean and covariance of
this matrix (computed using the minimum covariance determinant method).</p>
</td></tr>
<tr><td><code id="dir_out_+3A_return_dir_matrix">return_dir_matrix</code></td>
<td>
<p>A logical value. If TRUE, returns the directional outlyingness
matrix (or array for multivariate functional data). Computed from the chosen <code>depth_depth</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The directional outlyingness, as defined in Dai and Genton (2019)
<a href="https://doi.org/10.1016/j.csda.2018.03.017">doi:10.1016/j.csda.2018.03.017</a> is
</p>
<p style="text-align: center;"><code class="reqn">O(Y, F_Y) = (1/d(Y, F_Y) - 1).v</code>
</p>
<p> where <code class="reqn">d</code> is a depth notion, and <code class="reqn">v</code> is
the unit vector pointing from the median of <code class="reqn">F_Y</code> to <code class="reqn">Y</code>. For univariate and
multivariate functional data, the projection depth is always used as suggested by
Dai and Genton (2019) <a href="https://doi.org/10.1016/j.csda.2018.03.017">doi:10.1016/j.csda.2018.03.017</a>.
</p>


<h3>Value</h3>

<p>Returns a list containing:
</p>
<table>
<tr><td><code>mean_outlyingness</code></td>
<td>
<p>an <code>n x d</code> matrix of the mean
of directional outlyingness.</p>
</td></tr> <tr><td><code>var_outlyingness</code></td>
<td>
<p> a vector of length n containing
the variation of directional outlyingness.</p>
</td></tr>
<tr><td><code>ms_matrix</code></td>
<td>
<p> if<code>return_distance</code> = T, an <code>n x (d+1)</code> matrix whose columns are the mean and
variation of directional outlyingness.</p>
</td></tr>
<tr><td><code>distance</code></td>
<td>
<p> if <code>return_distance</code> = T, a vector of distance computed from the
<code>ms_matrix</code> using a robust estimate of the mean and covariance matrix.</p>
</td></tr>
<tr><td><code>mcd_obj</code></td>
<td>
<p> if <code>return_distance</code> = T, a list containing the robust
(minimum covariance determinant) estimate of the mean and covariance of the <code>ms_matrix</code>.</p>
</td></tr>
<tr><td><code>dirout_matrix</code></td>
<td>
<p> if <code>return_dir_matrix</code> = T, an n x p (or n x p x d) matrix (or array)
containing the directional outlyingness values for the univariate (or multivariate) functional <code>dts</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Oluwasegun Taiwo Ojo.
</p>


<h3>References</h3>

<p>Dai, W., and Genton, M. G. (2018). Multivariate functional data
visualization and outlier detection. <em>Journal of Computational and Graphical
Statistics</em>, 27(4), 923-934.
</p>
<p>Dai, W., and Genton, M. G. (2019). Directional outlyingness for multivariate functional
data. <em>Computational Statistics &amp; Data Analysis</em>, 131, 50-65.
</p>
<p>Zuo, Y. (2003). Projection-based depth functions and associated medians. <em>The
Annals of Statistics</em>, 31(5), 1460-1490.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+msplot">msplot</a></code> for outlier detection using msplot and <code><a href="#topic+projection_depth">projection_depth</a></code>
for multivariate projection depth.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># univariate magnitude model in Dai and Genton (2018).
dt4 &lt;- simulation_model4()
dirout_object &lt;- dir_out(dts = dt4$data, return_distance = TRUE)
</code></pre>

<hr>
<h2 id='directional_quantile'>Compute directional quantile outlyingness for a sample of discretely observed curves</h2><span id='topic+directional_quantile'></span>

<h3>Description</h3>

<p>The directional quantile is a measure of outlyingness based on a scaled pointwise deviation from the mean.
These deviations are usually scaled by the deviation of the mean from the 2.5% upper and lower quantiles
depending on if the (pointwise) observed value of a function is above or below the (pointwise) mean.
Directional quantile was mentioned in Myllymäki et al. (2015) <a href="https://doi.org/10.1016/j.spasta.2014.11.004">doi:10.1016/j.spasta.2014.11.004</a>,
Myllymäki et al. (2017) <a href="https://doi.org/10.1111/rssb.12172">doi:10.1111/rssb.12172</a> and Dai et al. (2020)
<a href="https://doi.org/10.1016/j.csda.2020.106960">doi:10.1016/j.csda.2020.106960</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>directional_quantile(dt, quantiles = c(0.025, 0.975))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="directional_quantile_+3A_dt">dt</code></td>
<td>
<p>A matrix or dataframe of size <code class="reqn">n</code> observations/curves by <code class="reqn">p</code> domain/evaluation
points.</p>
</td></tr>
<tr><td><code id="directional_quantile_+3A_quantiles">quantiles</code></td>
<td>
<p>A numeric vector of length 2 specifying the probabilities of the lower and upper quantiles.
Values must be between 0 and 1. Defaults to <code>c(0.025, 0.975)</code> as specified in Dai et al. (2020)
<a href="https://doi.org/10.1016/j.csda.2020.106960">doi:10.1016/j.csda.2020.106960</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method computes the directional quantile of a sample of curves discretely observed on common points.
The directional quantile of a function/curve <code class="reqn">X_i(t)</code> is the maximum pointwise scaled outlyingness of
<code class="reqn">X_i(t)</code>. The scaling is done using the pointwise absolute difference between the 2.5% mean and the lower (and upper)
quantiles. See Dai et al. (2020) <a href="https://doi.org/10.1016/j.csda.2020.106960">doi:10.1016/j.csda.2020.106960</a> and
Myllymäki et al. (2017) <a href="https://doi.org/10.1111/rssb.12172">doi:10.1111/rssb.12172</a> for more details.
</p>


<h3>Value</h3>

<p>A numeric vector containing the the directional quantiles of each observation of <code>dt</code>.
</p>


<h3>Author(s)</h3>

<p>Oluwasegun Taiwo Ojo
</p>


<h3>References</h3>

<p>Dai, W., Mrkvička, T., Sun, Y., &amp; Genton, M. G. (2020). Functional outlier detection and taxonomy by sequential transformations.
<em>Computational Statistics &amp; Data Analysis</em>, 106960.
</p>
<p>Myllymäki, M., Mrkvička, T., Grabarnik, P., Seijo, H., &amp; Hahn, U. (2017).
Global envelope tests for spatial processes. <em>J. R. Stat. Soc. B</em>, 79:381-404.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dt1 &lt;- simulation_model1()
dq &lt;- directional_quantile(dt1$data)

</code></pre>

<hr>
<h2 id='extremal_depth'>Compute extremal depth for functional data</h2><span id='topic+extremal_depth'></span>

<h3>Description</h3>

<p>Compute extremal depth for functional data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extremal_depth(dts)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extremal_depth_+3A_dts">dts</code></td>
<td>
<p>A numeric matrix or dataframe of size <code class="reqn">n</code> observations/curves by <code class="reqn">p</code> domain/evaluation
points.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the extremal depth of a univariate functional data. The extremal depth of a function
<code class="reqn">g</code> with respect to a set of function <code class="reqn">S</code> denoted by <code class="reqn">ED(g, S)</code> is the proportion
of functions in <code class="reqn">S</code> that is more extreme than <code class="reqn">g</code>. The functions are ordered using depths cumulative
distribution functions (d-CDFs). Extremal depth like the name implies is based on extreme outlyingness and it
penalizes functions that are outliers even for a small part of the domain. Proposed/mentioned in
Narisetty and Nair (2016) <a href="https://doi.org/10.1080/01621459.2015.1110033">doi:10.1080/01621459.2015.1110033</a>.
</p>


<h3>Value</h3>

<p>A vector containing the extremal depths of the rows of <code>dts</code>.
</p>


<h3>Author(s)</h3>

<p>Oluwasegun Ojo
</p>


<h3>References</h3>

<p>Narisetty, N. N., &amp; Nair, V. N. (2016). Extremal depth for functional data and applications.
<em>Journal of the American Statistical Association</em>, 111(516), 1705-1714.
</p>
<p>@seealso <code><a href="#topic+total_variation_depth">total_variation_depth</a></code> for functional data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dt3 &lt;- simulation_model3()
ex_depths &lt;- extremal_depth(dts = dt3$data)
# order functions from deepest to most outlying
order(ex_depths, decreasing = TRUE)
</code></pre>

<hr>
<h2 id='extreme_rank_length'>Compute the Extreme Rank Length Depth.</h2><span id='topic+extreme_rank_length'></span>

<h3>Description</h3>

<p>This function computes the extreme rank length depth (ERLD) of a sample of curves or functions.
Functions have to be discretely observed on common domain points. In principle, the ERLD of a function <code class="reqn">X_i</code>
is the proportion of functions in the sample that is considered to be more extreme
than <code class="reqn">X_i</code>, an idea similar to <code><a href="#topic+extremal_depth">extremal_depth</a></code>.
To determine which functions are more extreme, pointwise ranks of the functions are computed and compared pairwise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extreme_rank_length(
  dts,
  type = c("two_sided", "one_sided_left", "one_sided_right")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extreme_rank_length_+3A_dts">dts</code></td>
<td>
<p>A matrix or data frame of size <code class="reqn">n</code> observations/curves by <code class="reqn">p</code> domain/evaluation points.</p>
</td></tr>
<tr><td><code id="extreme_rank_length_+3A_type">type</code></td>
<td>
<p>A character value. Can be one of <code>"two_sided"</code>, <code>"one_sided_left"</code> or <code>"one_sided_right"</code>.
If <code>"two_sided"</code> is specified, small and large values in <code>dts</code> will be considered extreme. If <code>"one_sided_left"</code> is specified,
then only small values in <code>dts</code> are considered to be extreme while for <code>"one_sided_right"</code>, only large values  in
<code>dts</code> are considered to be extreme. <code>"two_sided"</code> is the default. See <code>Details</code> for more details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are three possibilities in the (pairwise) comparison of the pointwise ranks of the functions.
First possibility is to consider only small values as extreme (when <code>type = "one_sided_left"</code>) in which case the raw pointwise ranks
<code class="reqn">r_{ij}</code> are used. The second possibility is to consider only large values as extreme (when <code>type = "one_sided_right"</code>) in which
case the pointwise ranks used are computed as <code class="reqn">R_{ij} = n + 1 - r_{ij} </code> where <code class="reqn">r_{ij}</code> is the raw pointwise rank of the function
<code class="reqn">i</code> at design point <code class="reqn">j</code> and <code class="reqn">n</code> is the number of functions in the sample. Third possibility is to consider both small and
large values as extreme (when <code>type = "two_sided"</code>) in which case the pointwise ranks used is computed as
<code class="reqn">R_{ij} = min(r_ij, n + 1 - r_{ij})</code>. In the computation of the raw pointwise ranks <code class="reqn">r_{ij}</code>, ties are broken using
an average. See Dai et al. (2020) <a href="https://doi.org/10.1016/j.csda.2020.106960">doi:10.1016/j.csda.2020.106960</a> and Myllymäki et al. (2017) <a href="https://doi.org/10.1111/rssb.12172">doi:10.1111/rssb.12172</a> for more details.
</p>


<h3>Value</h3>

<p>A numeric vector containing the depth of each curve
</p>


<h3>Author(s)</h3>

<p>Oluwasegun Ojo
</p>


<h3>References</h3>

<p>Dai, W., Mrkvička, T., Sun, Y., &amp; Genton, M. G. (2020). Functional outlier detection and taxonomy by sequential transformations.
<em>Computational Statistics &amp; Data Analysis</em>, 106960.
</p>
<p>Myllymäki, M., Mrkvička, T., Grabarnik, P., Seijo, H., &amp; Hahn, U. (2017).
Global envelope tests for spatial processes. <em>J. R. Stat. Soc. B</em>, 79:381-404.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dt3 &lt;- simulation_model3()
erld &lt;- extreme_rank_length(dt3$data)

</code></pre>

<hr>
<h2 id='functional_boxplot'>Functional Boxplot for a sample of functions.</h2><span id='topic+functional_boxplot'></span>

<h3>Description</h3>

<p>This function finds outliers in a sample of curves using the functional boxplot by Sun and Genton (2011)
<a href="https://doi.org/10.1198/jcgs.2011.09224">doi:10.1198/jcgs.2011.09224</a>.
Unlike the name suggests, the function does not actually produce a plot but is only used as support in
finding outliers in other functions. Different depth and outlyingness methods are supported for ordering
functions. Alternatively, the depth values of the functions can be supplied directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>functional_boxplot(
  dts,
  depth_method = c("mbd", "tvd", "extremal", "dirout", "linfinity", "bd", "erld", "dq"),
  depth_values = NULL,
  emp_factor = 1.5,
  central_region = 0.5,
  erld_type = NULL,
  dq_quantiles = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="functional_boxplot_+3A_dts">dts</code></td>
<td>
<p>A matrix or data frame of size <code class="reqn">n</code> observations/curves by <code class="reqn">p</code> domain/evaluation points for univariate functional data.</p>
</td></tr>
<tr><td><code id="functional_boxplot_+3A_depth_method">depth_method</code></td>
<td>
<p>A character value specifying the method to use for computing the depth values (if <code>depth_values</code> is not supplied)
used in ordering the functions. The following methods are are supported:
</p>

<dl>
<dt>&quot;mbd&quot;:</dt><dd><p>The modified band depth with bands defined by 2 functions.
Uses the algorithm of Sun et al. (2012)<a href="https://doi.org/10.1002/sta4.8">doi:10.1002/sta4.8</a>.</p>
</dd>
<dt>&quot;tvd&quot;</dt><dd><p>The total variation depth of Huang and Sun (2019) <a href="https://doi.org/10.1080/00401706.2019.1574241">doi:10.1080/00401706.2019.1574241</a>.</p>
</dd>
<dt>&quot;extremal&quot;</dt><dd><p>The extremal depth of Narisetty and Nair (2016) <a href="https://doi.org/10.1080/01621459.2015.1110033">doi:10.1080/01621459.2015.1110033</a>.</p>
</dd>
<dt>&quot;dirout&quot;</dt><dd><p>Uses the robust distance of the mean and variation of directional outlyingness (<code><a href="#topic+dir_out">dir_out</a></code>)
defined in Dai and Genton (2019) <a href="https://doi.org/10.1016/j.csda.2018.03.017">doi:10.1016/j.csda.2018.03.017</a>.
Since this method is a measure of outlyingness of a function the negative
of the computed robust distance is used in ordering the functions.</p>
</dd>
<dt>&quot;linfinity&quot;</dt><dd><p>The L-infinity depth defined in Long and Huang (2015)
<a href="https://arxiv.org/abs/1506.01332">&lt;arXiv:1506.01332</a> is used in ordering functions.</p>
</dd>
<dt>&quot;bd&quot;</dt><dd><p>Uses the band depth with bands defined by 2 functions
according to the algorithm of Sun et al. (2012) <a href="https://doi.org/10.1002/sta4.8">doi:10.1002/sta4.8</a>.</p>
</dd>
<dt>erld</dt><dd><p>Uses the extreme rank length depth used in Dai et al. (2020) <a href="https://doi.org/10.1016/j.csda.2020.106960">doi:10.1016/j.csda.2020.106960</a>.</p>
</dd>
<dt>&quot;dq&quot;</dt><dd><p>Uses the directional quantile (DQ) used in Dai et al. (2020) <a href="https://doi.org/10.1016/j.csda.2020.106960">doi:10.1016/j.csda.2020.106960</a>.
Since DQ is a measure of outlyingness, the negative of the DQ values is used in ordering the functions.</p>
</dd>
</dl>

<p>The default method is <code>"mbd"</code>. Alternatively, the <code>depth_values</code> of the functions can be supplied in which case
the depths are not computed and <code>depth_method</code> is ignored.</p>
</td></tr>
<tr><td><code id="functional_boxplot_+3A_depth_values">depth_values</code></td>
<td>
<p>A numeric vector containing the depth values of the functions in <code>dts</code> to use for ordering functions.
<code>length(depth_values)</code> must be equal to number of rows of <code>dts</code>. If <code>depth_values</code> is specified, the depth is not
computed and any method specified in <code>depth_method</code> is ignored.</p>
</td></tr>
<tr><td><code id="functional_boxplot_+3A_emp_factor">emp_factor</code></td>
<td>
<p>A numeric value specifying the empirical factor for the boxplot. Defaults to 1.5.</p>
</td></tr>
<tr><td><code id="functional_boxplot_+3A_central_region">central_region</code></td>
<td>
<p>A numeric value between 0 and 1 indicating the probability of central region. Defaults to 0.5.</p>
</td></tr>
<tr><td><code id="functional_boxplot_+3A_erld_type">erld_type</code></td>
<td>
<p>If <code>depth_method = "erld"</code>, the type of ordering to use in computing the extreme rank length depth.
Can be one of <code>"two_sided"</code>, <code>"one_sided_left"</code> or <code>"one_sided_right"</code>. A <code>"two_sided"</code> ordering is used by
default if <code>erld_type</code> is not specified.
See <a href="#topic+extreme_rank_length">extreme_rank_length</a> for more details.</p>
</td></tr>
<tr><td><code id="functional_boxplot_+3A_dq_quantiles">dq_quantiles</code></td>
<td>
<p>If <code>depth_method = "dq"</code>, a numeric vector of length 2 specifying the probabilities
of upper and lower quantiles. Defaults to <code>c(0.025, 0.975)</code> for the upper and lower 2.5% quantiles.
See <a href="#topic+directional_quantile">directional_quantile</a> for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing: </p>
<table>
<tr><td><code>outliers</code></td>
<td>
<p>The indices of the functions/curves flagged as outliers.</p>
</td></tr>
<tr><td><code>depth_values</code></td>
<td>
<p>The depths of the functions/curves in <code>dts</code>.</p>
</td></tr>
<tr><td><code>median_curve</code></td>
<td>
<p>The index of the median curve, which is the curve with the largest depth value (or smallest outlyingness value).</p>
</td></tr>
</table>


<h3>References</h3>

<p>Sun, Y., &amp; Genton, M. G. (2011). Functional boxplots. <em>Journal of Computational and Graphical
Statistics</em>, 20(2), 316-334.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+seq_transform">seq_transform</a></code> for functional outlier detection using  sequential transformation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dt1 &lt;- simulation_model1()
fbplot_obj &lt;- functional_boxplot(dt1$data, depth_method = "mbd")
fbplot_obj$outliers
</code></pre>

<hr>
<h2 id='hardin_factor_numeric'>Compute F distribution factors for approximating the tail of the distribution of robust MCD distance.</h2><span id='topic+hardin_factor_numeric'></span>

<h3>Description</h3>

<p>Computes asymptotically, the factors for F approximation cutoff for (MCD) robust
mahalanobis distances according to Hardin and Rocke (2005)
<a href="https://doi.org/10.1198/106186005X77685">doi:10.1198/106186005X77685</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hardin_factor_numeric(n, dimension)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hardin_factor_numeric_+3A_n">n</code></td>
<td>
<p>A numeric value indicating the number of observations of the data.</p>
</td></tr>
<tr><td><code id="hardin_factor_numeric_+3A_dimension">dimension</code></td>
<td>
<p>A numeric value indicating the number of variables of the data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the two factors needed for the determining an appropriate
cutoff for robust mahalanobis distances computed using the MCD method.
</p>
<p>The F approximation according to Hardin and Rocke (2005) <a href="https://doi.org/10.1198/106186005X77685">doi:10.1198/106186005X77685</a>
is given by: </p>
<p style="text-align: center;"><code class="reqn">c(m-p+1)/(pm) * RMD^2 ~ F_{p, m-p+1}</code>
</p>
<p> where <code class="reqn">m</code> is a parameter for finding the degree of freedom of the
<code class="reqn">F</code> distribution, <code class="reqn">c</code> is a scaling constant and <code class="reqn">p</code> is the dimension. The first factor
returned by this function (<code>factor1</code>) is <code class="reqn">c(m-p+1)/(pm)</code> and the second factor (<code>factor2</code>) is <code class="reqn">F_{p, m-p+1}</code>.
</p>


<h3>Value</h3>

<p>Returns a list containing: </p>
<table>
<tr><td><code>factor1</code></td>
<td>
<p> then estimated value of
<code class="reqn">c(m-p+1)/(pm)</code> based on <code>n</code> and <code>dimension</code>.</p>
</td></tr> <tr><td><code>factor2</code></td>
<td>
<p> the
value of <code class="reqn">F_{p, m-p+1}</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hardin, J., and Rocke, D. M. (2005). The distribution of robust distances.
<em>Journal of Computational and Graphical Statistics</em>, 14(4), 928-946.
</p>

<hr>
<h2 id='linfinity_depth'>Compute the L-infinity depth of a sample of curves/functions.</h2><span id='topic+linfinity_depth'></span>

<h3>Description</h3>

<p>The L-infinity depth is a simple generalization of the <code class="reqn">L^p</code> multivariate depth to
functional data proposed in Long and Huang (2015)
<a href="https://arxiv.org/abs/1506.01332">&lt;arXiv:1506.01332</a> and also
used in Dai et al. (2020) <a href="https://doi.org/10.1016/j.csda.2020.106960">doi:10.1016/j.csda.2020.106960</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linfinity_depth(dt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="linfinity_depth_+3A_dt">dt</code></td>
<td>
<p>A matrix or data frame of size <code class="reqn">n</code> functions/curves by <code class="reqn">p</code> domain/evaluation points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of size <code>nrow(dt)</code> containing the band depth values of each curve.
</p>


<h3>References</h3>

<p>Long, J. P., &amp; Huang, J. Z. (2015). A study of functional depths. <em>arXiv preprint arXiv</em>:1506.01332.
</p>
<p>Dai, W., Mrkvička, T., Sun, Y., &amp; Genton, M. G. (2020). Functional outlier detection and taxonomy by
sequential transformations. <em>Computational Statistics &amp; Data Analysis</em>, 106960.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dt1 &lt;- simulation_model1()
linf &lt;- linfinity_depth(dt1$data)

</code></pre>

<hr>
<h2 id='modified_band_depth'>Compute the modified band depth for a sample of curves/functions.</h2><span id='topic+modified_band_depth'></span>

<h3>Description</h3>

<p>This function computes the modified band depth of López-Pintado and Romo (2009)
<a href="https://doi.org/10.1198/jasa.2009.0108">doi:10.1198/jasa.2009.0108</a>. Bands of 2 functions are always used and the
fast algorithm of Sun et al. (2012) <a href="https://doi.org/10.1002/sta4.8">doi:10.1002/sta4.8</a> is used in computing
the depth values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modified_band_depth(dt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modified_band_depth_+3A_dt">dt</code></td>
<td>
<p>A matrix or data frame of size <code class="reqn">n</code> functions/curves by <code class="reqn">p</code> domain/evaluation points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of size <code>nrow(dt)</code> containing the band depth values of each curve.
</p>


<h3>References</h3>

<p>López-Pintado, S., &amp; Romo, J. (2009). On the Concept of Depth for Functional Data.
<em>Journal of the American Statistical Association</em>, 104(486), 718-734.
</p>
<p>Sun, Y., Genton, M. G., &amp; Nychka, D. W. (2012). Exact fast computation of band depth for large functional datasets:
How quickly can one million curves be ranked?. <em>Stat</em>, 1(1), 68-74.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dt1 &lt;- simulation_model1()
mbd2 &lt;- modified_band_depth(dt1$data)

</code></pre>

<hr>
<h2 id='msplot'>Outlier Detection using Magnitude-Shape Plot (MS-Plot) based on the directional outlyingness for functional
data.</h2><span id='topic+msplot'></span>

<h3>Description</h3>

<p>This function finds outliers in univariate and multivariate functional data using the MS-Plot
method described in Dai and Genton (2018) <a href="https://doi.org/10.1080/10618600.2018.1473781">doi:10.1080/10618600.2018.1473781</a>.
Indices of observations flagged as outliers are returned. In addition, the
scatter plot of <code class="reqn">VO</code> against <code class="reqn">MO</code> (||MO||) can be requested for univariate
(multivariate) functional data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>msplot(
  dts,
  data_depth = c("random_projections"),
  n_projections = 200,
  seed = NULL,
  return_mvdir = TRUE,
  plot = TRUE,
  plot_title = "Magnitude Shape Plot",
  title_cex = 1.5,
  show_legend = T,
  ylabel = "VO",
  xlabel
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="msplot_+3A_dts">dts</code></td>
<td>
<p>A matrix/data frame for univariate functional data (of size <code class="reqn">n</code>
observations by <code class="reqn">p</code> domain points) or a <code class="reqn">3-</code>dimensional array for
multivariate functional data (of size <code class="reqn">n</code> observations by <code class="reqn">p</code>
domain points by <code class="reqn">d</code> dimension).</p>
</td></tr>
<tr><td><code id="msplot_+3A_data_depth">data_depth</code></td>
<td>
<p>The depth used in the computation of the directional outlyingness of
<code>dts</code>. The projection depth is always used. Support for other depth methods will be added.</p>
</td></tr>
<tr><td><code id="msplot_+3A_n_projections">n_projections</code></td>
<td>
<p>The number of random directions to generate for computing the random projection
depth. By default 200 directions are generated.</p>
</td></tr>
<tr><td><code id="msplot_+3A_seed">seed</code></td>
<td>
<p>An integer indicating the seed to set when generating random directions for computing the random projection depth.
NULL by default in which case no seed is set.</p>
</td></tr>
<tr><td><code id="msplot_+3A_return_mvdir">return_mvdir</code></td>
<td>
<p>A logical value indicating whether to return the mean and variation of directional
outlyingness (<code class="reqn">MO</code> and <code class="reqn">VO</code>). For univariate functional data, <code class="reqn">MO</code> and <code class="reqn">VO</code> are vectors.
For multivariate functional data, <code class="reqn">VO</code> is a vector while <code class="reqn">MO</code> is a matrix of size
<code class="reqn">n x d</code>.</p>
</td></tr>
<tr><td><code id="msplot_+3A_plot">plot</code></td>
<td>
<p>A logical indicating whether to make the msplot of <code class="reqn">VO</code> against <code class="reqn">MO</code>. In the case
of multivariate functional data, a plot of  <code class="reqn">VO</code> against <code class="reqn">||MO||</code> is made.</p>
</td></tr>
<tr><td><code id="msplot_+3A_plot_title">plot_title</code></td>
<td>
<p>The title of the plot. Set to &quot;Magnitude Shape Plot&quot; by default. Ignored if
<code>plot = FALSE</code>.</p>
</td></tr>
<tr><td><code id="msplot_+3A_title_cex">title_cex</code></td>
<td>
<p>Numerical value indicating the size of the plot title relative to the device default.
Set to 1.5 by default. Ignored if <code>plot = FALSE</code>.</p>
</td></tr>
<tr><td><code id="msplot_+3A_show_legend">show_legend</code></td>
<td>
<p>A logical indicating whether to add legend to plot if <code>plot = TRUE</code>.</p>
</td></tr>
<tr><td><code id="msplot_+3A_ylabel">ylabel</code></td>
<td>
<p>The label of the y-axis. Set to &quot;VO&quot; by default.</p>
</td></tr>
<tr><td><code id="msplot_+3A_xlabel">xlabel</code></td>
<td>
<p>The label of the x-axis if <code>plot = TRUE</code>. If not specified (default), set to &quot;MO&quot;
for univariate functional data and &quot;||MO||&quot; for multivariate functional data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>MS-Plot finds outliers by computing
the mean and variation of directional outlyingness (<code class="reqn">MO</code> and <code class="reqn">VO</code>) described
in Dai and Genton (2019) <a href="https://doi.org/10.1016/j.csda.2018.03.017">doi:10.1016/j.csda.2018.03.017</a>.
A multivariate data whose columns are the computed <code class="reqn">MO</code> and <code class="reqn">VO</code> is then constructed and
the robust mahalanobis distance(s) of the rows of this matrix are computed
(using the minimum covariate determinant estimate of the location and scatter). The tail
of the distribution of these distances is approximated using the <code class="reqn">F</code> distribution
according to Hardin and Rocke (2005) <a href="https://doi.org/10.1198/106186005X77685">doi:10.1198/106186005X77685</a> to get the cutoff.
The projection depth is always used for computing the directional outlyingness
(as suggested by Dai and Genton (2019) <a href="https://doi.org/10.1016/j.csda.2018.03.017">doi:10.1016/j.csda.2018.03.017</a>).
</p>


<h3>Value</h3>

<p>Returns a list containing:
</p>
<table>
<tr><td><code>outliers_index</code></td>
<td>
<p>an integer vector containing the indices of the outliers.</p>
</td></tr>
<tr><td><code>median_curve</code></td>
<td>
<p>the index of the median function (which is the
function with the smallest robust mahalanobis distance computed from the matrix whose
columns are made up of <code class="reqn">MO</code> and <code class="reqn">VO</code>).</p>
</td></tr>
<tr><td><code>mean_outlyingness</code></td>
<td>
<p>if <code>return_mvdir</code> = TRUE, a numeric vector of the mean of directional
outlyingness for univariate functional data or an <code class="reqn">n x d</code> matrix of the mean of
directional outlyingness for multivariate functional data.</p>
</td></tr>
<tr><td><code>var_outlyingness</code></td>
<td>
<p>if <code>return_mvdir</code> = TRUE, a numeric vector of length <code class="reqn">n</code> observations
containing the variation of directional outlyingness.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Oluwasegun Taiwo Ojo.
</p>


<h3>References</h3>

<p>Dai, W., and Genton, M. G. (2018). Multivariate functional data
visualization and outlier detection. <em>Journal of Computational and Graphical
Statistics</em>, 27(4), 923-934.
</p>
<p>Dai, W., and Genton, M. G. (2019). Directional outlyingness for multivariate
functional data. <em>Computational Statistics &amp; Data Analysis</em>, 131, 50-65.
</p>
<p>Hardin, J., and Rocke, D. M. (2005). The distribution of robust distances.
<em>Journal of Computational and Graphical Statistics</em>, 14(4), 928-946.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dir_out">dir_out</a></code> for directional outlyingness and <code><a href="#topic+projection_depth">projection_depth</a></code>
for multivariate projection depth.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Univariate magnitude model in Dai and Genton (2018).
dt1 &lt;- simulation_model1()
msplot_object &lt;- msplot(dts = dt1$data)
msplot_object$outliers_index
msplot_object$mean_outlyingness
msplot_object$var_outlyingness

</code></pre>

<hr>
<h2 id='muod'>Massive Unsupervised Outlier Detection (MUOD)</h2><span id='topic+muod'></span>

<h3>Description</h3>

<p>MUOD finds outliers by computing for each functional data, a magnitude, amplitude
and shape index. Outliers are then detected in each set of index and outliers
found are classified as either a magnitude, shape or amplitude outlier.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>muod(dts, cut_method = c("boxplot", "tangent"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="muod_+3A_dts">dts</code></td>
<td>
<p>a matrix or dataframe of size <code>n</code> observation by <code>p</code> domain points.</p>
</td></tr>
<tr><td><code id="muod_+3A_cut_method">cut_method</code></td>
<td>
<p>a character value indicating method to use for finding indices cutoff.
Must be either <code>"boxplot"</code> or <code>"tangent"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>MUOD was proposed in Azcorra et al. (2020) <a href="https://doi.org/10.1038/s41598-018-24874-2">doi:10.1038/s41598-018-24874-2</a>
as a support method for finding influential users in a social network data.
It was also mentioned in Vinue and Epiphano (2020) <a href="https://doi.org/10.1007/s11634-020-00412-9">doi:10.1007/s11634-020-00412-9</a>
where it was compared with other functional outlier detection methods.
</p>
<p>MUOD computes for each curve three indices: amplitude, magnitude and shape indices.
Then a cutoff is determined for each set of indices and outliers are identified
in each set of index. Outliers identified in the magnitude indices are flagged
as magnitude outliers. The same holds true for the amplitude and shape indices.
Thus, the outliers are not only identified but also classified.
</p>


<h3>Value</h3>

<p>Returns a list containing the following
</p>
<table>
<tr><td><code>outliers</code></td>
<td>
<p>a vector containing the indices of outliers identified.</p>
</td></tr>
<tr><td><code>indices</code></td>
<td>
<p>a dataframe containing the shape, magnitude and amplitude indices</p>
</td></tr>
</table>


<h3>References</h3>

<p>Azcorra, A., Chiroque, L. F., Cuevas, R., Anta, A. F., Laniado, H., Lillo, R. E., Romo, J., &amp; Sguera, C. (2018).
Unsupervised scalable statistical method for identifying influential users in online social networks.
Scientific reports, 8(1), 1-7.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dt1 &lt;- simulation_model1()
md &lt;- muod(dts = dt1$data)
str(md$outliers)
dim(md$indices)
</code></pre>

<hr>
<h2 id='plot_dtt'>Plot Data from simulation models</h2><span id='topic+plot_dtt'></span>

<h3>Description</h3>

<p>Support function for plotting data generated by any of the simulation model
functions <code>simulation_model1() - simulation_model9()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_dtt(
  y,
  grid_points,
  p,
  true_outliers,
  show_legend,
  plot_title,
  title_cex,
  ylabel,
  xlabel,
  legend_pos = "bottomright"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_dtt_+3A_y">y</code></td>
<td>
<p>A matrix of <code class="reqn">n</code> observations by <code class="reqn">p</code> domain points</p>
</td></tr>
<tr><td><code id="plot_dtt_+3A_grid_points">grid_points</code></td>
<td>
<p>A vector of the evaluation/domain points of <code>y</code></p>
</td></tr>
<tr><td><code id="plot_dtt_+3A_p">p</code></td>
<td>
<p>A value indicating the number of evaluation/domain points</p>
</td></tr>
<tr><td><code id="plot_dtt_+3A_true_outliers">true_outliers</code></td>
<td>
<p>An integer vector indicating the indices of the
true outliers</p>
</td></tr>
<tr><td><code id="plot_dtt_+3A_show_legend">show_legend</code></td>
<td>
<p>A logical indicating whether to add legend to plot if <code>plot = TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_dtt_+3A_plot_title">plot_title</code></td>
<td>
<p>Title of plot if <code>plot</code> is <code>TRUE</code></p>
</td></tr>
<tr><td><code id="plot_dtt_+3A_title_cex">title_cex</code></td>
<td>
<p>Numerical value indicating the size of the plot title relative to the device default.
Set to 1.5 by default. Ignored if <code>plot = FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_dtt_+3A_ylabel">ylabel</code></td>
<td>
<p>The label of the y-axis. Set to <code>""</code> by default.</p>
</td></tr>
<tr><td><code id="plot_dtt_+3A_xlabel">xlabel</code></td>
<td>
<p>The label of the x-axis if <code>plot = TRUE</code>. Set to
<code>"gridpoints"</code> by default.</p>
</td></tr>
<tr><td><code id="plot_dtt_+3A_legend_pos">legend_pos</code></td>
<td>
<p>A character value indicating the position of the
legend. Can be one of <code>"bottomright"</code>, <code>"bottom"</code>,
<code>"bottomleft"</code>, <code>"left"</code> <code>"topleft"</code>, <code>"top"</code>,
<code>"topright"</code>, <code>"right"</code>, <code>""center</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='projection_depth'>Random projection for multivariate data</h2><span id='topic+projection_depth'></span>

<h3>Description</h3>

<p>Helper function to compute the random projection depth of multivariate point(s) with respect
to a multivariate data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>projection_depth(dts, dt = dts, n_projections = 500L, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="projection_depth_+3A_dts">dts</code></td>
<td>
<p>A matrix or data frame of size <code>m</code> observations by <code>d</code> dimension or vector of length <code>d</code>.
Contains the observation(s) whose depth is to be computed.</p>
</td></tr>
<tr><td><code id="projection_depth_+3A_dt">dt</code></td>
<td>
<p>A matrix or dataframe of size <code>n</code> observations by <code>d</code> dimension. Equals to
<code>dts</code> by default.</p>
</td></tr>
<tr><td><code id="projection_depth_+3A_n_projections">n_projections</code></td>
<td>
<p>The number of directions for random projections. By default,
500 random directions for projection are generated from a scaled uniform distribution between -1 and 1.</p>
</td></tr>
<tr><td><code id="projection_depth_+3A_seed">seed</code></td>
<td>
<p>The random seed to set when generating the random directions. Defaults to NULL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the depth values of <code>dts</code> with respect to <code>dt</code>.
</p>


<h3>Author(s)</h3>

<p>Oluwasegun Taiwo Ojo
</p>


<h3>See Also</h3>

<p><code><a href="#topic+msplot">msplot</a></code> for outlier detection using msplot and <code><a href="#topic+dir_out">dir_out</a></code>
for directional outlyingness.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>projection_depth(dts = iris[1:5, -5], dt = iris[1:10, -5], n_projection = 7, seed = 20)

</code></pre>

<hr>
<h2 id='seq_transform'>Find and classify outliers functional outliers using Sequential Transformation</h2><span id='topic+seq_transform'></span>

<h3>Description</h3>

<p>This method finds and classify outliers using sequential transformations
proposed in Algorithm 1 of Dai et al. (2020) <a href="https://doi.org/10.1016/j.csda.2020.106960">doi:10.1016/j.csda.2020.106960</a>.
A sequence of transformations are applied to the functional data and after each
transformation, a functional boxplot is applied on the transformed data and outliers
flagged by the functional data are noted. A number of transformations mentioned in
Dai et al. (2020) <a href="https://doi.org/10.1016/j.csda.2020.106960">doi:10.1016/j.csda.2020.106960</a> are supported including vertical
alignment (&quot;T1(X)(t)&quot;), normalization (&quot;T2(X)(t)&quot;), one order of differencing
(&quot;D1(X)(t)&quot; and &quot;D2(X)(t)&quot;) and point-wise outlyingness data (&quot;O(X)(t)&quot;).
The feature alignment transformation based on warping/curve registration is not yet
supported.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seq_transform(
  dts,
  sequence = c("T0", "T1", "T2"),
  depth_method = c("mbd", "tvd", "extremal", "dirout", "linfinity", "bd", "erld", "dq"),
  save_data = FALSE,
  emp_factor = 1.5,
  central_region = 0.5,
  erld_type = NULL,
  dq_quantiles = NULL,
  n_projections = 200L,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seq_transform_+3A_dts">dts</code></td>
<td>
<p>A matrix for univariate functional data (of size <code>n</code> observations by <code>p</code> domain
points) or a 3-dimensional array for multivariate functional data (of size <code>n</code>
observations by <code>p</code> domain points by <code>d</code> dimension). Only the outlyingness transformation (&quot;O(X)(t)&quot;)
supports multivariate functional data so the sequence of transformation must always start with outlyingness (&quot;O(X)(t)&quot;)
whenever a multivariate functional data is parsed to <code>dts</code>.</p>
</td></tr>
<tr><td><code id="seq_transform_+3A_sequence">sequence</code></td>
<td>
<p>A character vector usually of length between 1 and 6 containing any of the strings: <code>"T0", "D0", "T1", "T2",
"D1", "D2"</code> and <code>"O"</code> (in any order). These sequence of strings specifies the sequence of transformations to be applied
on the data and their meanings are described as follows:
</p>

<dl>
<dt><code>"T0"</code> and <code>"D0"</code></dt><dd><p>Functional boxplot applied on raw data (no transformation is applied).</p>
</dd>
<dt><code>"T1"</code></dt><dd><p>Apply vertical alignment on data, i.e. subtract from each curve its expectation over the domain of evaluation.</p>
</dd>
<dt><code>"T2"</code></dt><dd><p>Apply normalization on data, i.e. divide each curve by its L-2 norm.</p>
</dd>
<dt><code>"D1"</code> and <code>"D2" </code></dt><dd><p>Apply one order of differencing on data.</p>
</dd>
<dt><code>"O"</code></dt><dd><p>Find the pointwise outlyingness of data. For multivariate functional data, this transformation replaces the multivariate
functional data with a univariate functional data of pointwise outlyingness.</p>
</dd>
</dl>

<p>Examples of sequences of transformations include: <code>"T0"</code>,  <code>c("T0", "T1", "D1")</code>, <code>c("T0", "T1", "T2")</code>,
<code>c("T0", "D1", "D2")</code> and <code>c("T0", "T1", "T2", "D1", "D2")</code>. See Details for their meaning.</p>
</td></tr>
<tr><td><code id="seq_transform_+3A_depth_method">depth_method</code></td>
<td>
<p>A character value specifying depth/outlyingness method to use in the functional boxplot applied after each stage of transformation.
Note that the same depth/outlyingness method is used in the functional boxplot applied after each transformation in the sequence. The following methods
are currently supported:
</p>

<dl>
<dt>&quot;mbd&quot;:</dt><dd><p>The modified band depth with bands defined by 2 functions.
Uses the algorithm of Sun et al. (2012).</p>
</dd>
<dt>&quot;tvd&quot;</dt><dd><p>The total variation depth of Huang and Sun (2019).</p>
</dd>
<dt>&quot;extremal&quot;</dt><dd><p>The extremal depth of Narisetty and Nair (2016).</p>
</dd>
<dt>&quot;dirout&quot;</dt><dd><p>Uses the robust distance of the mean and variation of directional outlyingness (<code><a href="#topic+dir_out">dir_out</a></code>)
defined in Dai and Genton (2018). Since this method is a measure of outlyingness of a function the negative of the
computed robust distance is used in ordering the functions.</p>
</dd>
<dt>&quot;linfinity&quot;</dt><dd><p>The L-infinity depth defined in Long and Huang (2015) is used in ordering functions.</p>
</dd>
<dt>&quot;bd&quot;</dt><dd><p>Uses the band depth with bands defined by 2 functions according to the algorithm of Sun et al. (2012)</p>
</dd>
<dt>erld</dt><dd><p>Uses the extreme rank length depth defined in Myllymäki et al. (2017) and mentioned in Dai et al. (2020).</p>
</dd>
<dt>&quot;dq&quot;</dt><dd><p>Uses the directional quantile (DQ) defined in Myllymäki et al. (2017) and mentioned in Dai et al. (2020).
Since DQ is a measure of outlyingness, the negative of the DQ values is used in ordering the functions.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="seq_transform_+3A_save_data">save_data</code></td>
<td>
<p>A logical. If TRUE, the intermediate transformed data are returned in a list.</p>
</td></tr>
<tr><td><code id="seq_transform_+3A_emp_factor">emp_factor</code></td>
<td>
<p>The empirical factor for functional boxplot. Defaults to 1.5.</p>
</td></tr>
<tr><td><code id="seq_transform_+3A_central_region">central_region</code></td>
<td>
<p>A value between 0 and 1 indicating the central region probability for functional_boxplot. Defaults to 0.5.</p>
</td></tr>
<tr><td><code id="seq_transform_+3A_erld_type">erld_type</code></td>
<td>
<p>If <code>depth_method = "erld"</code>, the type of ordering to use in computing the extreme rank length depth (ERLD).
Can be one of <code>"two_sided"</code>, <code>"one_sided_left"</code> or <code>"one_sided_right"</code>. A <code>"two_sided"</code> ordering is used by
default if <code>erld_type</code> is not specified and <code>depth_method = "erld"</code>. The <code>"one_sided_right"</code> ERLD is especially useful for
ordering functions of outlyingness (the output of the <code>"O"</code> transformation) since it considers only large values as extreme.
See <a href="#topic+extreme_rank_length">extreme_rank_length</a> for details.</p>
</td></tr>
<tr><td><code id="seq_transform_+3A_dq_quantiles">dq_quantiles</code></td>
<td>
<p>If <code>depth_method = "dq"</code>, a numeric vector of length 2 specifying the probabilities
of upper and lower quantiles. Defaults to <code>c(0.025, 0.975)</code> for the upper and lower 2.5% quantiles.
See <a href="#topic+directional_quantile">directional_quantile</a> for details.</p>
</td></tr>
<tr><td><code id="seq_transform_+3A_n_projections">n_projections</code></td>
<td>
<p>An integer indicating the number of random projections to use in computing the point-wise outlyingness if a 3-d array
is specified in <code>dts</code> i.e. (multivariate functional data), and the transformation <code>"O"</code> is part of the sequence of transformations
parsed to <code>sequence</code>. Defaults to 200L.</p>
</td></tr>
<tr><td><code id="seq_transform_+3A_seed">seed</code></td>
<td>
<p>The random seed to set when generating the random directions in the computation of the point-wise outlyingness. Defaults to NULL.
in which case a seed is not set.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements outlier detection using sequential transformations
described in Algorithm 1 of Dai et al. (2020) <a href="https://doi.org/10.1016/j.csda.2020.106960">doi:10.1016/j.csda.2020.106960</a>.
A sequence of transformations are applied consecutively with the functional
boxplot applied on the transformed data after each transformation. The following
example sequences (and their meaning) suggested in Dai et al. (2020)
<a href="https://doi.org/10.1016/j.csda.2020.106960">doi:10.1016/j.csda.2020.106960</a> can be parsed to argument <code>sequence</code>.
</p>

<dl>
<dt><code>"T0"</code></dt><dd><p>Apply functional boxplot on raw data (no transformation is applied).</p>
</dd>
<dt><code>c("T0", "T1", "D1")</code></dt><dd><p>Apply functional boxplot on raw data, then apply vertical alignment on data followed by applying
functional boxplot again. Finally apply one order of differencing on the vertically aligned data and apply functional boxplot again.</p>
</dd>
<dt><code>c("T0", "T1", "T2")</code></dt><dd><p>Apply functional boxplot on raw data, then apply vertical alignment on data followed by applying
functional boxplot again. Finally apply normalization using L-2 norm on the vertically aligned data and apply functional boxplot again.</p>
</dd>
<dt><code>c("T0", "D1", "D2")</code></dt><dd><p>Apply functional boxplot on raw data, then apply one order of difference on data followed by applying
functional boxplot again. Finally apply another one order of differencing on the differenced data and apply functional boxplot again.
Note that this sequence of transformation can also be (alternatively) specified by <code>c("T0", "D1", "D1")</code>, <code>c("T0", "D2", "D2")</code>, and
<code>c("T0", "D2", "D1")</code> since <code>"D1"</code> and <code>"D2" </code> do the same thing which is to apply one order lag-1 difference on the data.</p>
</dd>
<dt><code>"O"</code></dt><dd><p>Find the pointwise outlyingness of the multivariate or univariate functional data and then apply functional boxplot
on the resulting univariate functional data of pointwise outlyingness. Care must be taken to specify a one sided ordering function (i.e.
&quot;one_sided_right&quot; extreme rank length depth) in the functional boxplot used on the data of point-wise outlyingness. This is because only
large values should be considered extreme in the data of the point-wise outlyingness.</p>
</dd>
</dl>

<p>For multivariate functional data (when a 3-d array is supplied to <code>dts</code>), the sequence of transformation must always begin with <code>"O"</code>
so that the multivariate data can be replaced with the univariate data of point-wise outlyingness which the functional boxplot can subsequently process
because the <code><a href="#topic+functional_boxplot">functional_boxplot</a></code> function only supports univariate functional data.
</p>
<p>If repeated transformations are used in the sequence (e.g. when <code>sequence = c("T0", "D1", "D1")</code>), a warning message is thrown
and the labels of the output list are changed (e.g. for <code>sequence = c("T0", "D1", "D1")</code>, the labels of the output lists
become <code>"T0", "D1_1", "D1_2"</code>, so that outliers are accessed with <code>output$outlier$D1_1</code> and <code>output$outlier$D1_2</code>).
See examples for more.
</p>


<h3>Value</h3>

<p>A list containing two lists are returned. The contents of the returned list are:
</p>
<table>
<tr><td><code>outliers:</code></td>
<td>
<p>A named list of length <code>length(sequence)</code> containing the index of outliers found after each
transformation. The names of the elements of this list are the sequence strings supplied to <code>sequence</code> and the
outliers found after each stage of transformation are not necessarily mutually exclusive. </p>
</td></tr>
<tr><td><code>transformed_data</code></td>
<td>
<p>If <code>save_data = TRUE</code> a named list of length <code>length(sequence)</code> containing the transformed matrix after each
transformation. The names of the elements of this list are the sequence strings supplied to <code>sequence</code>. <code>NULL</code> otherwise (if
<code>save_data = FALSE</code>).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># same as running a functional boxplot
dt1 &lt;- simulation_model1()
seqobj &lt;- seq_transform(dt1$data, sequence = "T0", depth_method = "mbd")
seqobj$outliers$T0
functional_boxplot(dt1$data, depth_method = "mbd")$outliers

# more sequences
dt4 &lt;- simulation_model4()
seqobj &lt;- seq_transform(dt4$data, sequence = c("T0", "D1", "D2"), depth_method = "mbd")
seqobj$outliers$T0 # outliers found in raw data
seqobj$outliers$D1 # outliers found after differencing data the first time
seqobj$outliers$D2 # outliers found after differencing the data the second time

# saving transformed data
seqobj &lt;- seq_transform(dt4$data, sequence = c("T0", "D1", "D2"),
 depth_method = "mbd", save_data = TRUE)
seqobj$outliers$T0 # outliers found in raw data
head(seqobj$transformed_data$T0)  # the raw data
head(seqobj$transformed_data$D1) # the first order differenced data
head(seqobj$transformed_data$D2) # the 2nd order differenced data

# double transforms e.g. c("T0", "D1", "D1")
seqobj &lt;- seq_transform(dt4$data, sequence = c("T0", "D1", "D1"),
 depth_method = "mbd", save_data = TRUE) # throws warning
seqobj$outliers$T0 # outliers found in raw data
seqobj$outliers$D1_1 #found after differencing data the first time
seqobj$outliers$D1_2 #found after differencing data the second time
head(seqobj$transformed_data$T0)  # the raw data
head(seqobj$transformed_data$D1_1) # the first order differenced data
head(seqobj$transformed_data$D1_2) # the 2nd order differenced data

# multivariate data
dtm &lt;- array(0, dim = c(dim(dt1$data), 2))
dtm[,,1] &lt;- dt1$data
dtm[,,2] &lt;- dt1$data
seqobj &lt;- seq_transform(dtm, sequence = "O", depth_method = "erld",
 erld_type = "one_sided_right", save_data = TRUE)
seqobj$outliers$O # multivariate outliers
head(seqobj$transformed_data$O) # univariate outlyingness data

</code></pre>

<hr>
<h2 id='simulation_model1'>Convenience function for generating functional data</h2><span id='topic+simulation_model1'></span>

<h3>Description</h3>

<p>This is a typical magnitude model in which outliers are shifted from the
normal' non-outlying observations. The main model is of the form:
</p>
<p style="text-align: center;"><code class="reqn">X_i(t) = \mu t + e_i(t),</code>
</p>
<p> and the contamination model model is of the
form: </p>
<p style="text-align: center;"><code class="reqn">X_i(t) = \mu t + qk_i + e_i(t)</code>
</p>

<p>where <code class="reqn">t\in [0,1]</code>, <code class="reqn">e_i(t)</code> is a Gaussian process with zero mean and
covariance function of the form:
</p>
<p style="text-align: center;"><code class="reqn">\gamma(s,t) = \alpha \exp(-\beta|t-s|^\nu),</code>
</p>
 <p><code class="reqn">k_i \in \{-1, 1\}</code>
(usually with <code class="reqn">P(k_i = -1) = P(k_i=1) = 0.5</code>),
and <code class="reqn">q</code> is a constant controlling how far the outliers are from the mean
function of the data, usually, <code class="reqn">q = 6</code> or <code class="reqn">q = 8</code>.
The domain of the generated functions is over the interval <code class="reqn">[0, 1]</code>.
Please see the simulation models vignette with
<code>vignette("simulation_models", package = "fdaoutlier")</code> for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation_model1(
  n = 100,
  p = 50,
  outlier_rate = 0.05,
  mu = 4,
  q = 8,
  kprob = 0.5,
  cov_alpha = 1,
  cov_beta = 1,
  cov_nu = 1,
  deterministic = TRUE,
  seed = NULL,
  plot = F,
  plot_title = "Simulation Model 1",
  title_cex = 1.5,
  show_legend = T,
  ylabel = "",
  xlabel = "gridpoints"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulation_model1_+3A_n">n</code></td>
<td>
<p>The number of curves to generate. Set to <code class="reqn">100</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model1_+3A_p">p</code></td>
<td>
<p>The number of evaluation points of the curves. Curves are usually generated
over the interval <code class="reqn">[0, 1]</code>. Set to <code class="reqn">50</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model1_+3A_outlier_rate">outlier_rate</code></td>
<td>
<p>A value between <code class="reqn">[0, 1]</code> indicating the percentage of outliers.
A value of <code class="reqn">0.06</code> indicates about <code class="reqn">6\%</code> of the observations will be outliers
depending on whether the parameter <code>deterministic</code> is <code>TRUE</code> or not.
Set to <code class="reqn">0.05</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model1_+3A_mu">mu</code></td>
<td>
<p>The mean value of the functions in the main and contamination model.
Set to <code>4</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model1_+3A_q">q</code></td>
<td>
<p>A value indicating the shift of the outliers from the mean function, i.e., the <code class="reqn">q</code>
in the contamination model. Used to control how far the outliers are from the mean function.
Set to <code>8</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model1_+3A_kprob">kprob</code></td>
<td>
<p>A value between <code class="reqn">0</code> and <code class="reqn">1</code> indicating the probability that an outlier will
be above or below the mean function, i.e., <code class="reqn">P(k_i = 1)</code> in the contamination model.
Can be used to control the amount of outliers above or below the mean. Set to <code class="reqn">0.5</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model1_+3A_cov_alpha">cov_alpha</code></td>
<td>
<p>A value indicating the coefficient of the exponential function
of the covariance matrix, i.e., the <code class="reqn">\alpha</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model1_+3A_cov_beta">cov_beta</code></td>
<td>
<p>A value indicating the coefficient of the terms inside the exponential
function of the covariance matrix, i.e., the <code class="reqn">\beta</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model1_+3A_cov_nu">cov_nu</code></td>
<td>
<p>A value indicating the power to which to raise the terms inside the exponential
function of the covariance matrix, i.e., the <code class="reqn">\nu</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model1_+3A_deterministic">deterministic</code></td>
<td>
<p>A logical value. If <code>TRUE</code>, the function will always return
<code>round(n*outlier_rate)</code> outliers and consequently the number of outliers is always constant.
If <code>FALSE</code>, the number of outliers are determined using <code>n</code> Bernoulli trials with
probability <code>outlier_rate</code>, and consequently the number of outliers returned is random.
<code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model1_+3A_seed">seed</code></td>
<td>
<p>A seed to set for reproducibility. <code>NULL</code> by default in which case a seed
is not set.</p>
</td></tr>
<tr><td><code id="simulation_model1_+3A_plot">plot</code></td>
<td>
<p>A logical value indicating whether to plot data.</p>
</td></tr>
<tr><td><code id="simulation_model1_+3A_plot_title">plot_title</code></td>
<td>
<p>Title of plot if <code>plot</code> is <code>TRUE</code></p>
</td></tr>
<tr><td><code id="simulation_model1_+3A_title_cex">title_cex</code></td>
<td>
<p>Numerical value indicating the size of the plot title relative to the device default.
Set to 1.5 by default. Ignored if <code>plot = FALSE</code>.</p>
</td></tr>
<tr><td><code id="simulation_model1_+3A_show_legend">show_legend</code></td>
<td>
<p>A logical indicating whether to add legend to plot if <code>plot = TRUE</code>.</p>
</td></tr>
<tr><td><code id="simulation_model1_+3A_ylabel">ylabel</code></td>
<td>
<p>The label of the y-axis. Set to <code>""</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model1_+3A_xlabel">xlabel</code></td>
<td>
<p>The label of the x-axis if <code>plot = TRUE</code>. Set to
<code>"gridpoints"</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>a matrix of size <code>n</code> by <code>p</code> containing the simulated data set</p>
</td></tr>
<tr><td><code>true_outliers</code></td>
<td>
<p>a vector of integers indicating the row index of the outliers in the
generated data.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>dt &lt;- simulation_model1(n = 50, plot = TRUE)
dim(dt$data)
dt$true_outliers
</code></pre>

<hr>
<h2 id='simulation_model2'>Convenience function for generating functional data</h2><span id='topic+simulation_model2'></span>

<h3>Description</h3>

<p>This model generates non-persistent magnitude outliers, i.e., the outliers are
magnitude outliers for only a portion of the domain of the functional data. The
main model is of the form: </p>
<p style="text-align: center;"><code class="reqn">X_i(t) = \mu t + e_i(t),</code>
</p>
<p> with
contamination model of the form:
</p>
<p style="text-align: center;"><code class="reqn">X_i(t) = \mu t + qk_iI_{T_i \le t\le T_i+l } + e_i(t)</code>
</p>

<p>where: <code class="reqn">t\in [0,1]</code>, <code class="reqn">e_i(t)</code> is a Gaussian process with zero mean and
covariance function of the form: </p>
<p style="text-align: center;"><code class="reqn">\gamma(s,t) = \alpha\exp(-\beta|t-s|^\nu),</code>
</p>

<p><code class="reqn">k_i \in \{-1, 1\}</code> with <code class="reqn">P(k_i = -1) = P(k_i=1) = 0.5</code>,
<code class="reqn">q</code> is a constant controlling how far the outliers are from the mass of the
data, <code class="reqn">I</code> is an indicator function, <code class="reqn">T_i</code> is a uniform random variable between
an interval <code class="reqn">[a, b] \subset [0,1]</code>, and <code class="reqn">l</code> is a constant specifying for how
much of the domain the outliers are away from the mean function.
Please see the simulation models vignette with
<code>vignette("simulation_models", package = "fdaoutlier")</code> for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation_model2(
  n = 100,
  p = 50,
  outlier_rate = 0.05,
  mu = 4,
  q = 8,
  kprob = 0.5,
  a = 0.1,
  b = 0.9,
  l = 0.05,
  cov_alpha = 1,
  cov_beta = 1,
  cov_nu = 1,
  deterministic = TRUE,
  seed = NULL,
  plot = F,
  plot_title = "Simulation Model 2",
  title_cex = 1.5,
  show_legend = T,
  ylabel = "",
  xlabel = "gridpoints"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulation_model2_+3A_n">n</code></td>
<td>
<p>The number of curves to generate. Set to <code class="reqn">100</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model2_+3A_p">p</code></td>
<td>
<p>The number of evaluation points of the curves. Curves are usually generated
over the interval <code class="reqn">[0, 1]</code>. Set to <code class="reqn">50</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model2_+3A_outlier_rate">outlier_rate</code></td>
<td>
<p>A value between <code class="reqn">[0, 1]</code> indicating the percentage of outliers.
A value of <code class="reqn">0.06</code> indicates about <code class="reqn">6\%</code> of the observations will be outliers
depending on whether the parameter <code>deterministic</code> is <code>TRUE</code> or not.
Set to <code class="reqn">0.05</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model2_+3A_mu">mu</code></td>
<td>
<p>The mean value of the functions. Set to <code>4</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model2_+3A_q">q</code></td>
<td>
<p>A value indicating the shift of the outliers from the mean function.
Used to control how far the outliers are from the mean function. Set to <code>8</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model2_+3A_kprob">kprob</code></td>
<td>
<p>A value between <code class="reqn">0</code> and <code class="reqn">1</code> indicating the probability that an outlier will
be above or below the mean function. Can be used to control the amount of outliers above
or below the mean. Set to <code class="reqn">0.5</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model2_+3A_a">a</code>, <code id="simulation_model2_+3A_b">b</code></td>
<td>
<p>values values specifying the interval <code class="reqn">[a,b]</code> for the uniform distribution
from which <code class="reqn">T_i</code> is drawn in the contamination model.</p>
</td></tr>
<tr><td><code id="simulation_model2_+3A_l">l</code></td>
<td>
<p>the value of <code class="reqn">l</code> in the contamination model</p>
</td></tr>
<tr><td><code id="simulation_model2_+3A_cov_alpha">cov_alpha</code></td>
<td>
<p>A value indicating the coefficient of the exponential function
of the covariance matrix, i.e., the <code class="reqn">\alpha</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model2_+3A_cov_beta">cov_beta</code></td>
<td>
<p>A value indicating the coefficient of the terms inside the exponential
function of the covariance matrix, i.e., the <code class="reqn">\beta</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model2_+3A_cov_nu">cov_nu</code></td>
<td>
<p>A value indicating the power to which to raise the terms inside the exponential
function of the covariance matrix, i.e., the <code class="reqn">\nu</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model2_+3A_deterministic">deterministic</code></td>
<td>
<p>A logical value. If <code>TRUE</code>, the function will always return
<code>round(n*outlier_rate)</code> outliers and consequently the number of outliers is always constant.
If <code>FALSE</code>, the number of outliers are determined using <code>n</code> Bernoulli trials with
probability <code>outlier_rate</code>, and consequently the number of outliers returned is random.
<code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model2_+3A_seed">seed</code></td>
<td>
<p>A seed to set for reproducibility. <code>NULL</code> by default in which case a seed
is not set.</p>
</td></tr>
<tr><td><code id="simulation_model2_+3A_plot">plot</code></td>
<td>
<p>A logical value indicating whether to plot data.</p>
</td></tr>
<tr><td><code id="simulation_model2_+3A_plot_title">plot_title</code></td>
<td>
<p>Title of plot if <code>plot</code> is <code>TRUE</code></p>
</td></tr>
<tr><td><code id="simulation_model2_+3A_title_cex">title_cex</code></td>
<td>
<p>Numerical value indicating the size of the plot title relative to the device default.
Set to 1.5 by default. Ignored if <code>plot = FALSE</code>.</p>
</td></tr>
<tr><td><code id="simulation_model2_+3A_show_legend">show_legend</code></td>
<td>
<p>A logical indicating whether to add legend to plot if <code>plot = TRUE</code>.</p>
</td></tr>
<tr><td><code id="simulation_model2_+3A_ylabel">ylabel</code></td>
<td>
<p>The label of the y-axis. Set to <code>""</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model2_+3A_xlabel">xlabel</code></td>
<td>
<p>The label of the x-axis if <code>plot = TRUE</code>. Set to
<code>"gridpoints"</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>a matrix of size <code>n</code> by <code>p</code> containing the simulated data set</p>
</td></tr>
<tr><td><code>true_outliers</code></td>
<td>
<p>a vector of integers indicating the row index of the outliers in the
generated data.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>dtt &lt;- simulation_model2(plot = TRUE)
dtt$true_outliers
dim(dtt$data)
</code></pre>

<hr>
<h2 id='simulation_model3'>Convenience function for generating functional data</h2><span id='topic+simulation_model3'></span>

<h3>Description</h3>

<p>This model generates outliers that are magnitude outliers for a part of the
domain. The main model is of the form: </p>
<p style="text-align: center;"><code class="reqn">X_i(t) = \mu t + e_i(t),</code>
</p>
<p> with
contamination model of the form:
</p>
<p style="text-align: center;"><code class="reqn">X_i(t) = \mu t + qk_iI_{T_i \le t} + e_i(t)</code>
</p>

<p>where: <code class="reqn">t\in [0,1]</code>, <code class="reqn">e_i(t)</code> is a Gaussian process with zero mean and
covariance function of the form: </p>
<p style="text-align: center;"><code class="reqn">\gamma(s,t) = \alpha\exp(-\beta|t-s|^\nu),</code>
</p>

<p><code class="reqn">k_i \in \{-1, 1\}</code> with <code class="reqn">P(k_i = -1) = P(k_i=1) = 0.5</code>,
<code class="reqn">q</code> is a constant controlling how far the outliers are from the mass of the
data, <code class="reqn">I</code> is an indicator function, and <code class="reqn">T_i</code> is a uniform random variable between
an interval <code class="reqn">[a, b] \subset [0,1]</code>.
Please see the simulation models vignette with
<code>vignette("simulation_models", package = "fdaoutlier")</code> for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation_model3(
  n = 100,
  p = 50,
  outlier_rate = 0.05,
  mu = 4,
  q = 6,
  a = 0.1,
  b = 0.9,
  kprob = 0.5,
  cov_alpha = 1,
  cov_beta = 1,
  cov_nu = 1,
  deterministic = TRUE,
  seed = NULL,
  plot = F,
  plot_title = "Simulation Model 3",
  title_cex = 1.5,
  show_legend = T,
  ylabel = "",
  xlabel = "gridpoints"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulation_model3_+3A_n">n</code></td>
<td>
<p>The number of curves to generate. Set to <code class="reqn">100</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model3_+3A_p">p</code></td>
<td>
<p>The number of evaluation points of the curves. Curves are usually generated
over the interval <code class="reqn">[0, 1]</code>. Set to <code class="reqn">50</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model3_+3A_outlier_rate">outlier_rate</code></td>
<td>
<p>A value between <code class="reqn">[0, 1]</code> indicating the percentage of outliers.
A value of <code class="reqn">0.06</code> indicates about <code class="reqn">6\%</code> of the observations will be outliers
depending on whether the parameter <code>deterministic</code> is <code>TRUE</code> or not.
Set to <code class="reqn">0.05</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model3_+3A_mu">mu</code></td>
<td>
<p>The mean value of the functions. Set to <code>4</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model3_+3A_q">q</code></td>
<td>
<p>A value indicating the shift of the outliers from the mean function.
Used to control how far the outliers are from the mean function. Set to <code>8</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model3_+3A_a">a</code>, <code id="simulation_model3_+3A_b">b</code></td>
<td>
<p>values values specifying the interval <code class="reqn">[a,b]</code> for the uniform distribution
from which <code class="reqn">T_i</code> is drawn in the contamination model.</p>
</td></tr>
<tr><td><code id="simulation_model3_+3A_kprob">kprob</code></td>
<td>
<p>A value between <code class="reqn">0</code> and <code class="reqn">1</code> indicating the probability that an outlier will
be above or below the mean function. Can be used to control the amount of outliers above
or below the mean. Set to <code class="reqn">0.5</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model3_+3A_cov_alpha">cov_alpha</code></td>
<td>
<p>A value indicating the coefficient of the exponential function
of the covariance matrix, i.e., the <code class="reqn">\alpha</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model3_+3A_cov_beta">cov_beta</code></td>
<td>
<p>A value indicating the coefficient of the terms inside the exponential
function of the covariance matrix, i.e., the <code class="reqn">\beta</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model3_+3A_cov_nu">cov_nu</code></td>
<td>
<p>A value indicating the power to which to raise the terms inside the exponential
function of the covariance matrix, i.e., the <code class="reqn">\nu</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model3_+3A_deterministic">deterministic</code></td>
<td>
<p>A logical value. If <code>TRUE</code>, the function will always return
<code>round(n*outlier_rate)</code> outliers and consequently the number of outliers is always constant.
If <code>FALSE</code>, the number of outliers are determined using <code>n</code> Bernoulli trials with
probability <code>outlier_rate</code>, and consequently the number of outliers returned is random.
<code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model3_+3A_seed">seed</code></td>
<td>
<p>A seed to set for reproducibility. <code>NULL</code> by default in which case a seed
is not set.</p>
</td></tr>
<tr><td><code id="simulation_model3_+3A_plot">plot</code></td>
<td>
<p>A logical value indicating whether to plot data.</p>
</td></tr>
<tr><td><code id="simulation_model3_+3A_plot_title">plot_title</code></td>
<td>
<p>Title of plot if <code>plot</code> is <code>TRUE</code></p>
</td></tr>
<tr><td><code id="simulation_model3_+3A_title_cex">title_cex</code></td>
<td>
<p>Numerical value indicating the size of the plot title relative to the device default.
Set to 1.5 by default. Ignored if <code>plot = FALSE</code>.</p>
</td></tr>
<tr><td><code id="simulation_model3_+3A_show_legend">show_legend</code></td>
<td>
<p>A logical indicating whether to add legend to plot if <code>plot = TRUE</code>.</p>
</td></tr>
<tr><td><code id="simulation_model3_+3A_ylabel">ylabel</code></td>
<td>
<p>The label of the y-axis. Set to <code>""</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model3_+3A_xlabel">xlabel</code></td>
<td>
<p>The label of the x-axis if <code>plot = TRUE</code>. Set to
<code>"gridpoints"</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>a matrix of size <code>n</code> by <code>p</code> containing the simulated data set</p>
</td></tr>
<tr><td><code>true_outliers</code></td>
<td>
<p>a vector of integers indicating the row index of the outliers in the
generated data.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>dt &lt;- simulation_model3(plot = TRUE)
dt$true_outliers
dim(dt$data)
</code></pre>

<hr>
<h2 id='simulation_model4'>Convenience function for generating functional data</h2><span id='topic+simulation_model4'></span>

<h3>Description</h3>

<p>This models generates outliers defined on the reversed time interval of the main model.
The main model is of the form: </p>
<p style="text-align: center;"><code class="reqn">X_i(t) = \mu t(1 - t)^m + e_i(t),</code>
</p>

<p>with contamination model of the form: </p>
<p style="text-align: center;"><code class="reqn">X_i(t) = \mu(1 - t)t^m + e_i(t)</code>
</p>

<p>Please see the simulation models vignette with
<code>vignette("simulation_models", package = "fdaoutlier")</code> for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation_model4(
  n = 100,
  p = 50,
  outlier_rate = 0.05,
  mu = 30,
  m = 3/2,
  cov_alpha = 0.3,
  cov_beta = (1/0.3),
  cov_nu = 1,
  deterministic = TRUE,
  seed = NULL,
  plot = F,
  plot_title = "Simulation Model 4",
  title_cex = 1.5,
  show_legend = T,
  ylabel = "",
  xlabel = "gridpoints"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulation_model4_+3A_n">n</code></td>
<td>
<p>The number of curves to generate. Set to <code class="reqn">100</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model4_+3A_p">p</code></td>
<td>
<p>The number of evaluation points of the curves. Curves are usually generated
over the interval <code class="reqn">[0, 1]</code>. Set to <code class="reqn">50</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model4_+3A_outlier_rate">outlier_rate</code></td>
<td>
<p>A value between <code class="reqn">[0, 1]</code> indicating the percentage of outliers.
A value of <code class="reqn">0.06</code> indicates about <code class="reqn">6\%</code> of the observations will be outliers
depending on whether the parameter <code>deterministic</code> is <code>TRUE</code> or not.
Set to <code class="reqn">0.05</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model4_+3A_mu">mu</code></td>
<td>
<p>The mean value of the functions. Set to <code>30</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model4_+3A_m">m</code></td>
<td>
<p>the constant <code class="reqn">m</code> in the main and contamination model. Set to <code class="reqn">3/2</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model4_+3A_cov_alpha">cov_alpha</code></td>
<td>
<p>A value indicating the coefficient of the exponential function
of the covariance matrix, i.e., the <code class="reqn">\alpha</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model4_+3A_cov_beta">cov_beta</code></td>
<td>
<p>A value indicating the coefficient of the terms inside the exponential
function of the covariance matrix, i.e., the <code class="reqn">\beta</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model4_+3A_cov_nu">cov_nu</code></td>
<td>
<p>A value indicating the power to which to raise the terms inside the exponential
function of the covariance matrix, i.e., the <code class="reqn">\nu</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model4_+3A_deterministic">deterministic</code></td>
<td>
<p>A logical value. If <code>TRUE</code>, the function will always return
<code>round(n*outlier_rate)</code> outliers and consequently the number of outliers is always constant.
If <code>FALSE</code>, the number of outliers are determined using <code>n</code> Bernoulli trials with
probability <code>outlier_rate</code>, and consequently the number of outliers returned is random.
<code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model4_+3A_seed">seed</code></td>
<td>
<p>A seed to set for reproducibility. <code>NULL</code> by default in which case a seed
is not set.</p>
</td></tr>
<tr><td><code id="simulation_model4_+3A_plot">plot</code></td>
<td>
<p>A logical value indicating whether to plot data.</p>
</td></tr>
<tr><td><code id="simulation_model4_+3A_plot_title">plot_title</code></td>
<td>
<p>Title of plot if <code>plot</code> is <code>TRUE</code></p>
</td></tr>
<tr><td><code id="simulation_model4_+3A_title_cex">title_cex</code></td>
<td>
<p>Numerical value indicating the size of the plot title relative to the device default.
Set to 1.5 by default. Ignored if <code>plot = FALSE</code>.</p>
</td></tr>
<tr><td><code id="simulation_model4_+3A_show_legend">show_legend</code></td>
<td>
<p>A logical indicating whether to add legend to plot if <code>plot = TRUE</code>.</p>
</td></tr>
<tr><td><code id="simulation_model4_+3A_ylabel">ylabel</code></td>
<td>
<p>The label of the y-axis. Set to <code>""</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model4_+3A_xlabel">xlabel</code></td>
<td>
<p>The label of the x-axis if <code>plot = TRUE</code>. Set to
<code>"gridpoints"</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>a matrix of size <code>n</code> by <code>p</code> containing the simulated data set</p>
</td></tr>
<tr><td><code>true_outliers</code></td>
<td>
<p>a vector of integers indicating the row index of the outliers in the
generated data.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>dt &lt;- simulation_model4(plot = TRUE)
dt$true_outliers
dim(dt$data)
</code></pre>

<hr>
<h2 id='simulation_model5'>Convenience function for generating functional data</h2><span id='topic+simulation_model5'></span>

<h3>Description</h3>

<p>This models generates shape outliers with a different covariance structure
from that of the main model. The main model is of the form:
</p>
<p style="text-align: center;"><code class="reqn">X_i(t) = \mu t + e_i(t),</code>
</p>
<p> contamination model of the form:
</p>
<p style="text-align: center;"><code class="reqn">X_i(t) = \mu t + \tilde{e}_i(t),</code>
</p>
<p> where <code class="reqn">t\in [0,1]</code>, and <code class="reqn">e_i(t)</code>
and <code class="reqn">\tilde{e}_i(t)</code> are Gaussian processes with zero mean and
covariance function of the form: </p>
<p style="text-align: center;"><code class="reqn">\gamma(s,t) = \alpha\exp(-\beta|t-s|^\nu)</code>
</p>

<p>Please see the simulation models vignette with
<code>vignette("simulation_models", package = "fdaoutlier")</code> for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation_model5(
  n = 100,
  p = 50,
  outlier_rate = 0.05,
  mu = 4,
  cov_alpha = 1,
  cov_beta = 1,
  cov_nu = 1,
  cov_alpha2 = 5,
  cov_beta2 = 2,
  cov_nu2 = 0.5,
  deterministic = TRUE,
  seed = NULL,
  plot = F,
  plot_title = "Simulation Model 5",
  title_cex = 1.5,
  show_legend = T,
  ylabel = "",
  xlabel = "gridpoints"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulation_model5_+3A_n">n</code></td>
<td>
<p>The number of curves to generate. Set to <code class="reqn">100</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model5_+3A_p">p</code></td>
<td>
<p>The number of evaluation points of the curves. Curves are usually generated
over the interval <code class="reqn">[0, 1]</code>. Set to <code class="reqn">50</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model5_+3A_outlier_rate">outlier_rate</code></td>
<td>
<p>A value between <code class="reqn">[0, 1]</code> indicating the percentage of outliers.
A value of <code class="reqn">0.06</code> indicates about <code class="reqn">6\%</code> of the observations will be outliers
depending on whether the parameter <code>deterministic</code> is <code>TRUE</code> or not.
Set to <code class="reqn">0.05</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model5_+3A_mu">mu</code></td>
<td>
<p>The mean value of the functions. Set to <code>4</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model5_+3A_cov_alpha">cov_alpha</code>, <code id="simulation_model5_+3A_cov_alpha2">cov_alpha2</code></td>
<td>
<p>A value indicating the coefficient of the exponential function
of the covariance matrix, i.e., the <code class="reqn">\alpha</code> in the covariance function. <code>cov_alpha</code> is
for the main model while <code>cov_alpha2</code> is for the covariance function of the contamination model.
<code>cov_alpha</code> is set to <code class="reqn">1</code> by default while <code>cov_alpha2</code> is set to <code class="reqn">5</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model5_+3A_cov_beta">cov_beta</code>, <code id="simulation_model5_+3A_cov_beta2">cov_beta2</code></td>
<td>
<p>A value indicating the coefficient of the terms inside the exponential
function of the covariance matrix, i.e., the <code class="reqn">\beta</code> in the covariance function. <code>cov_beta</code>
is for the main model while <code>cov_beta2</code> is for the covariance function of the contamination model.
<code>cov_beta</code> is set to <code class="reqn">1</code> by default while <code>cov_beta2</code> is set to <code class="reqn">2</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model5_+3A_cov_nu">cov_nu</code>, <code id="simulation_model5_+3A_cov_nu2">cov_nu2</code></td>
<td>
<p>A value indicating the power to which to raise the terms inside the exponential
function of the covariance matrix, i.e., the <code class="reqn">\nu</code> in the covariance function. <code>cov_nu</code> is
for the main  model while <code>cov_nu2</code> is for the covariance function of the contamination model.
<code>cov_nu</code> is set to <code class="reqn">1</code> by default while <code>cov_nu2</code> is set to <code class="reqn">0.5</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model5_+3A_deterministic">deterministic</code></td>
<td>
<p>A logical value. If <code>TRUE</code>, the function will always return
<code>round(n*outlier_rate)</code> outliers and consequently the number of outliers is always constant.
If <code>FALSE</code>, the number of outliers are determined using <code>n</code> Bernoulli trials with
probability <code>outlier_rate</code>, and consequently the number of outliers returned is random.
<code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model5_+3A_seed">seed</code></td>
<td>
<p>A seed to set for reproducibility. <code>NULL</code> by default in which case a seed
is not set.</p>
</td></tr>
<tr><td><code id="simulation_model5_+3A_plot">plot</code></td>
<td>
<p>A logical value indicating whether to plot data.</p>
</td></tr>
<tr><td><code id="simulation_model5_+3A_plot_title">plot_title</code></td>
<td>
<p>Title of plot if <code>plot</code> is <code>TRUE</code></p>
</td></tr>
<tr><td><code id="simulation_model5_+3A_title_cex">title_cex</code></td>
<td>
<p>Numerical value indicating the size of the plot title relative to the device default.
Set to 1.5 by default. Ignored if <code>plot = FALSE</code>.</p>
</td></tr>
<tr><td><code id="simulation_model5_+3A_show_legend">show_legend</code></td>
<td>
<p>A logical indicating whether to add legend to plot if <code>plot = TRUE</code>.</p>
</td></tr>
<tr><td><code id="simulation_model5_+3A_ylabel">ylabel</code></td>
<td>
<p>The label of the y-axis. Set to <code>""</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model5_+3A_xlabel">xlabel</code></td>
<td>
<p>The label of the x-axis if <code>plot = TRUE</code>. Set to
<code>"gridpoints"</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>a matrix of size <code>n</code> by <code>p</code> containing the simulated data set</p>
</td></tr>
<tr><td><code>true_outliers</code></td>
<td>
<p>a vector of integers indicating the row index of the outliers in the
generated data.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>dt &lt;- simulation_model5(plot = TRUE)
dt$true_outliers
dim(dt$data)
</code></pre>

<hr>
<h2 id='simulation_model6'>Convenience function for generating functional data</h2><span id='topic+simulation_model6'></span>

<h3>Description</h3>

<p>This models generates shape outliers that have a different shape for a portion of the domain.
The main model is of the form: </p>
<p style="text-align: center;"><code class="reqn">X_i(t) = \mu t + e_i(t),</code>
</p>
<p> with
contamination model of the form:
</p>
<p style="text-align: center;"><code class="reqn">X_i(t) = \mu t + (-1)^u q + (-1)^{(1-u)}(\frac{1}{\sqrt{r\pi}})\exp(-z(t-v)^w) + e_i(t)</code>
</p>

<p>where: <code class="reqn">t\in [0,1]</code>, <code class="reqn">e_i(t)</code> is a Gaussian process with zero mean
and covariance function of the form:  </p>
<p style="text-align: center;"><code class="reqn">\gamma(s,t) = \alpha\exp(-\beta|t-s|^\nu),</code>
</p>

<p><code class="reqn">u</code> follows Bernoulli distribution with probability <code class="reqn">P(u = 1) = 0.5</code>;
<code class="reqn">q</code>, <code class="reqn">r</code>, <code class="reqn">z</code> and <code class="reqn">w</code> are constants, and <code class="reqn">v</code> follows
a Uniform distribution between an interval <code class="reqn">[a, b]</code> and <code class="reqn">m</code> is a constant.
Please see the simulation models vignette with
<code>vignette("simulation_models", package = "fdaoutlier")</code> for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation_model6(
  n = 100,
  p = 50,
  outlier_rate = 0.1,
  mu = 4,
  q = 1.8,
  kprob = 0.5,
  a = 0.25,
  b = 0.75,
  cov_alpha = 1,
  cov_beta = 1,
  cov_nu = 1,
  pi_coeff = 0.02,
  exp_pow = 2,
  exp_coeff = 50,
  deterministic = TRUE,
  seed = NULL,
  plot = F,
  plot_title = "Simulation Model 6",
  title_cex = 1.5,
  show_legend = T,
  ylabel = "",
  xlabel = "gridpoints"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulation_model6_+3A_n">n</code></td>
<td>
<p>The number of curves to generate. Set to <code class="reqn">100</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model6_+3A_p">p</code></td>
<td>
<p>The number of evaluation points of the curves. Curves are usually generated
over the interval <code class="reqn">[0, 1]</code>. Set to <code class="reqn">50</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model6_+3A_outlier_rate">outlier_rate</code></td>
<td>
<p>A value between <code class="reqn">[0, 1]</code> indicating the percentage of outliers.
A value of <code class="reqn">0.06</code> indicates about <code class="reqn">6\%</code> of the observations will be outliers
depending on whether the parameter <code>deterministic</code> is <code>TRUE</code> or not.
Set to <code class="reqn">0.05</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model6_+3A_mu">mu</code></td>
<td>
<p>The mean value of the functions in the main and contamination model.
Set to <code>4</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model6_+3A_q">q</code></td>
<td>
<p>The constant term <code class="reqn">q</code> in the contamination model. Set to <code class="reqn">1.8</code>
by default.</p>
</td></tr>
<tr><td><code id="simulation_model6_+3A_kprob">kprob</code></td>
<td>
<p>The probability <code class="reqn">P(u = 1)</code>. Set to <code class="reqn">0.5</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model6_+3A_a">a</code>, <code id="simulation_model6_+3A_b">b</code></td>
<td>
<p>Values specifying the interval of from which <code class="reqn">v</code> in the
contamination model is drawn. Set to <code class="reqn">0.25</code> and <code class="reqn">0.75</code> respectively.</p>
</td></tr>
<tr><td><code id="simulation_model6_+3A_cov_alpha">cov_alpha</code></td>
<td>
<p>A value indicating the coefficient of the exponential function
of the covariance matrix, i.e., the <code class="reqn">\alpha</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model6_+3A_cov_beta">cov_beta</code></td>
<td>
<p>A value indicating the coefficient of the terms inside the exponential
function of the covariance matrix, i.e., the <code class="reqn">\beta</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model6_+3A_cov_nu">cov_nu</code></td>
<td>
<p>A value indicating the power to which to raise the terms inside the exponential
function of the covariance matrix, i.e., the <code class="reqn">\nu</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model6_+3A_pi_coeff">pi_coeff</code></td>
<td>
<p>The constant <code class="reqn">r</code> in the contamination model i.e., the coefficient of
of <code class="reqn">pi</code>. Set to <code class="reqn">0.02</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model6_+3A_exp_pow">exp_pow</code></td>
<td>
<p>The constant <code class="reqn">w</code> in the contamination model i.e., the power of the term in
the exponential function of the contamination model. Set to <code class="reqn">2</code>.</p>
</td></tr>
<tr><td><code id="simulation_model6_+3A_exp_coeff">exp_coeff</code></td>
<td>
<p>The constant <code class="reqn">z</code> in the contamination model i.e., the coefficient term in
the exponential function of the contamination model. Set to <code class="reqn">50</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model6_+3A_deterministic">deterministic</code></td>
<td>
<p>A logical value. If <code>TRUE</code>, the function will always return
<code>round(n*outlier_rate)</code> outliers and consequently the number of outliers is always constant.
If <code>FALSE</code>, the number of outliers are determined using <code>n</code> Bernoulli trials with
probability <code>outlier_rate</code>, and consequently the number of outliers returned is random.
<code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model6_+3A_seed">seed</code></td>
<td>
<p>A seed to set for reproducibility. <code>NULL</code> by default in which case a seed
is not set.</p>
</td></tr>
<tr><td><code id="simulation_model6_+3A_plot">plot</code></td>
<td>
<p>A logical value indicating whether to plot data.</p>
</td></tr>
<tr><td><code id="simulation_model6_+3A_plot_title">plot_title</code></td>
<td>
<p>Title of plot if <code>plot</code> is <code>TRUE</code></p>
</td></tr>
<tr><td><code id="simulation_model6_+3A_title_cex">title_cex</code></td>
<td>
<p>Numerical value indicating the size of the plot title relative to the device default.
Set to 1.5 by default. Ignored if <code>plot = FALSE</code>.</p>
</td></tr>
<tr><td><code id="simulation_model6_+3A_show_legend">show_legend</code></td>
<td>
<p>A logical indicating whether to add legend to plot if <code>plot = TRUE</code>.</p>
</td></tr>
<tr><td><code id="simulation_model6_+3A_ylabel">ylabel</code></td>
<td>
<p>The label of the y-axis. Set to <code>""</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model6_+3A_xlabel">xlabel</code></td>
<td>
<p>The label of the x-axis if <code>plot = TRUE</code>. Set to
<code>"gridpoints"</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>a matrix of size <code>n</code> by <code>p</code> containing the simulated data set</p>
</td></tr>
<tr><td><code>true_outliers</code></td>
<td>
<p>a vector of integers indicating the row index of the outliers in the
generated data.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>dt &lt;- simulation_model6(n = 50, plot = TRUE)
dim(dt$data)
dt$true_outliers
</code></pre>

<hr>
<h2 id='simulation_model7'>Convenience function for generating functional data</h2><span id='topic+simulation_model7'></span>

<h3>Description</h3>

<p>This model generates pure shape outliers that are periodic.
The main model is of the form: </p>
<p style="text-align: center;"><code class="reqn">X_i(t) = \mu t + e_i(t),</code>
</p>

<p>with contamination model of the form:
</p>
<p style="text-align: center;"><code class="reqn">X_i(t) = \mu t + k\sin(r\pi(t + \theta)) + e_i(t),</code>
</p>
<p> where:
<code class="reqn">t\in [0,1]</code>, and <code class="reqn">e_i(t)</code> is a Gaussian process with
zero mean and covariance function of the form:
</p>
<p style="text-align: center;"><code class="reqn">\gamma(s,t) = \alpha\exp{-\beta|t-s|^\nu},</code>
</p>

<p><code class="reqn">\theta</code> is uniformly distributed in an interval <code class="reqn">[a, b]</code> and
<code class="reqn">k</code>, <code class="reqn">r</code> are constants.
Please see the simulation models vignette with
<code>vignette("simulation_models", package = "fdaoutlier")</code> for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation_model7(
  n = 100,
  p = 50,
  outlier_rate = 0.05,
  mu = 4,
  sin_coeff = 2,
  pi_coeff = 4,
  a = 0.25,
  b = 0.75,
  cov_alpha = 1,
  cov_beta = 1,
  cov_nu = 1,
  deterministic = TRUE,
  seed = NULL,
  plot = F,
  plot_title = "Simulation Model 7",
  title_cex = 1.5,
  show_legend = T,
  ylabel = "",
  xlabel = "gridpoints"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulation_model7_+3A_n">n</code></td>
<td>
<p>The number of curves to generate. Set to <code class="reqn">100</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model7_+3A_p">p</code></td>
<td>
<p>The number of evaluation points of the curves. Curves are usually generated
over the interval <code class="reqn">[0, 1]</code>. Set to <code class="reqn">50</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model7_+3A_outlier_rate">outlier_rate</code></td>
<td>
<p>A value between <code class="reqn">[0, 1]</code> indicating the percentage of outliers.
A value of <code class="reqn">0.06</code> indicates about <code class="reqn">6\%</code> of the observations will be outliers
depending on whether the parameter <code>deterministic</code> is <code>TRUE</code> or not.
Set to <code class="reqn">0.05</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model7_+3A_mu">mu</code></td>
<td>
<p>The mean value of the functions in the main and contamination model.
Set to <code>4</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model7_+3A_sin_coeff">sin_coeff</code></td>
<td>
<p>The coefficient <code class="reqn">k</code> in the contamination model, i.e, the
coefficient of the sine term in the contamination model. Set to <code class="reqn">2</code>
by default.</p>
</td></tr>
<tr><td><code id="simulation_model7_+3A_pi_coeff">pi_coeff</code></td>
<td>
<p>The coefficient <code class="reqn">r</code> in the contamination model, i.e.,
the coefficient of <code class="reqn">pi</code> in the contamination model. Set to <code class="reqn">4</code>
by default.</p>
</td></tr>
<tr><td><code id="simulation_model7_+3A_a">a</code>, <code id="simulation_model7_+3A_b">b</code></td>
<td>
<p>Values indicating the interval of the uniform distribution from which
<code class="reqn">\theta</code> should be drawn. Set by default to <code class="reqn">0.25</code> and <code class="reqn">0.75</code>
respectively.</p>
</td></tr>
<tr><td><code id="simulation_model7_+3A_cov_alpha">cov_alpha</code></td>
<td>
<p>A value indicating the coefficient of the exponential function
of the covariance matrix, i.e., the <code class="reqn">\alpha</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model7_+3A_cov_beta">cov_beta</code></td>
<td>
<p>A value indicating the coefficient of the terms inside the exponential
function of the covariance matrix, i.e., the <code class="reqn">\beta</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model7_+3A_cov_nu">cov_nu</code></td>
<td>
<p>A value indicating the power to which to raise the terms inside the exponential
function of the covariance matrix, i.e., the <code class="reqn">\nu</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model7_+3A_deterministic">deterministic</code></td>
<td>
<p>A logical value. If <code>TRUE</code>, the function will always return
<code>round(n*outlier_rate)</code> outliers and consequently the number of outliers is always constant.
If <code>FALSE</code>, the number of outliers are determined using <code>n</code> Bernoulli trials with
probability <code>outlier_rate</code>, and consequently the number of outliers returned is random.
<code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model7_+3A_seed">seed</code></td>
<td>
<p>A seed to set for reproducibility. <code>NULL</code> by default in which case a seed
is not set.</p>
</td></tr>
<tr><td><code id="simulation_model7_+3A_plot">plot</code></td>
<td>
<p>A logical value indicating whether to plot data.</p>
</td></tr>
<tr><td><code id="simulation_model7_+3A_plot_title">plot_title</code></td>
<td>
<p>Title of plot if <code>plot</code> is <code>TRUE</code></p>
</td></tr>
<tr><td><code id="simulation_model7_+3A_title_cex">title_cex</code></td>
<td>
<p>Numerical value indicating the size of the plot title relative to the device default.
Set to 1.5 by default. Ignored if <code>plot = FALSE</code>.</p>
</td></tr>
<tr><td><code id="simulation_model7_+3A_show_legend">show_legend</code></td>
<td>
<p>A logical indicating whether to add legend to plot if <code>plot = TRUE</code>.</p>
</td></tr>
<tr><td><code id="simulation_model7_+3A_ylabel">ylabel</code></td>
<td>
<p>The label of the y-axis. Set to <code>""</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model7_+3A_xlabel">xlabel</code></td>
<td>
<p>The label of the x-axis if <code>plot = TRUE</code>. Set to
<code>"gridpoints"</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>a matrix of size <code>n</code> by <code>p</code> containing the simulated data set</p>
</td></tr>
<tr><td><code>true_outliers</code></td>
<td>
<p>a vector of integers indicating the row index of the outliers in the
generated data.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>dt &lt;- simulation_model7(n = 50, plot = TRUE)
dim(dt$data)
dt$true_outliers
</code></pre>

<hr>
<h2 id='simulation_model8'>Convenience function for generating functional data</h2><span id='topic+simulation_model8'></span>

<h3>Description</h3>

<p>This model generates pure shape outliers that are periodic. The
main model is of the form:
</p>
<p style="text-align: center;"><code class="reqn">X_i(t) = k\sin(r\pi t) + e_i(t),</code>
</p>

<p>with contamination model of the form:
</p>
<p style="text-align: center;"><code class="reqn">X_i(t) = k\sin(r\pi t + v) + e_i(t),</code>
</p>

<p>where <code class="reqn">t\in [0,1]</code>, and <code class="reqn">e_i(t)</code> is a Gaussian processes with
zero mean and covariance function of the form:
</p>
<p style="text-align: center;"><code class="reqn">\gamma(s,t) = \alpha\exp{-\beta|t-s|^\nu}</code>
</p>

<p>and <code class="reqn">k, r, v</code> are constants.
Please see the simulation models vignette with
<code>vignette("simulation_models", package = "fdaoutlier")</code> for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation_model8(
  n = 100,
  p = 50,
  outlier_rate = 0.05,
  pi_coeff = 15,
  sin_coeff = 2,
  constant = 2,
  cov_alpha = 1,
  cov_beta = 1,
  cov_nu = 1,
  deterministic = TRUE,
  seed = NULL,
  plot = F,
  plot_title = "Simulation Model 8",
  title_cex = 1.5,
  show_legend = T,
  ylabel = "",
  xlabel = "gridpoints"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulation_model8_+3A_n">n</code></td>
<td>
<p>The number of curves to generate. Set to <code class="reqn">100</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model8_+3A_p">p</code></td>
<td>
<p>The number of evaluation points of the curves. Curves are usually generated
over the interval <code class="reqn">[0, 1]</code>. Set to <code class="reqn">50</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model8_+3A_outlier_rate">outlier_rate</code></td>
<td>
<p>A value between <code class="reqn">[0, 1]</code> indicating the percentage of outliers.
A value of <code class="reqn">0.06</code> indicates about <code class="reqn">6\%</code> of the observations will be outliers
depending on whether the parameter <code>deterministic</code> is <code>TRUE</code> or not.
Set to <code class="reqn">0.05</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model8_+3A_pi_coeff">pi_coeff</code></td>
<td>
<p>The coefficient <code class="reqn">r</code> in the main and contamination model. Set to
<code class="reqn">15</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model8_+3A_sin_coeff">sin_coeff</code></td>
<td>
<p>The coefficient <code class="reqn">k</code> in the main and contamination model. Set to
<code class="reqn">2</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model8_+3A_constant">constant</code></td>
<td>
<p>The value of the constant <code class="reqn">v</code> in the contamination model. Set to
<code class="reqn">2</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model8_+3A_cov_alpha">cov_alpha</code></td>
<td>
<p>A value indicating the coefficient of the exponential function
of the covariance matrix, i.e., the <code class="reqn">\alpha</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model8_+3A_cov_beta">cov_beta</code></td>
<td>
<p>A value indicating the coefficient of the terms inside the exponential
function of the covariance matrix, i.e., the <code class="reqn">\beta</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model8_+3A_cov_nu">cov_nu</code></td>
<td>
<p>A value indicating the power to which to raise the terms inside the exponential
function of the covariance matrix, i.e., the <code class="reqn">\nu</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model8_+3A_deterministic">deterministic</code></td>
<td>
<p>A logical value. If <code>TRUE</code>, the function will always return
<code>round(n*outlier_rate)</code> outliers and consequently the number of outliers is always constant.
If <code>FALSE</code>, the number of outliers are determined using <code>n</code> Bernoulli trials with
probability <code>outlier_rate</code>, and consequently the number of outliers returned is random.
<code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model8_+3A_seed">seed</code></td>
<td>
<p>A seed to set for reproducibility. <code>NULL</code> by default in which case a seed
is not set.</p>
</td></tr>
<tr><td><code id="simulation_model8_+3A_plot">plot</code></td>
<td>
<p>A logical value indicating whether to plot data.</p>
</td></tr>
<tr><td><code id="simulation_model8_+3A_plot_title">plot_title</code></td>
<td>
<p>Title of plot if <code>plot</code> is <code>TRUE</code></p>
</td></tr>
<tr><td><code id="simulation_model8_+3A_title_cex">title_cex</code></td>
<td>
<p>Numerical value indicating the size of the plot title relative to the device default.
Set to 1.5 by default. Ignored if <code>plot = FALSE</code>.</p>
</td></tr>
<tr><td><code id="simulation_model8_+3A_show_legend">show_legend</code></td>
<td>
<p>A logical indicating whether to add legend to plot if <code>plot = TRUE</code>.</p>
</td></tr>
<tr><td><code id="simulation_model8_+3A_ylabel">ylabel</code></td>
<td>
<p>The label of the y-axis. Set to <code>""</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model8_+3A_xlabel">xlabel</code></td>
<td>
<p>The label of the x-axis if <code>plot = TRUE</code>. Set to
<code>"gridpoints"</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>a matrix of size <code>n</code> by <code>p</code> containing the simulated data set</p>
</td></tr>
<tr><td><code>true_outliers</code></td>
<td>
<p>a vector of integers indicating the row index of the outliers in the
generated data.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>dt &lt;- simulation_model8(plot = TRUE)
dim(dt$data)
dt$true_outliers
</code></pre>

<hr>
<h2 id='simulation_model9'>Convenience function for generating functional data</h2><span id='topic+simulation_model9'></span>

<h3>Description</h3>

<p>Periodic functions with outliers of different amplitude. The
main model is of the form
</p>
<p style="text-align: center;"><code class="reqn">X_i(t) = a_{1i}\sin \pi + a_{2i}\cos\pi + e_i(t),</code>
</p>

<p>with contamination model of the form
</p>
<p style="text-align: center;"><code class="reqn">X_i(t) = (b_{1i}\sin\pi + b_{2i}\cos\pi)(1-u_i) +
 (c_{1i}\sin\pi + c_{2i}\cos\pi)u_i + e_i(t),</code>
</p>

<p>where <code class="reqn">t\in [0,1]</code>, <code class="reqn">\pi \in [0, 2\pi]</code>, <code class="reqn">a_{1i}</code>,
<code class="reqn">a_{2i}</code>  follows uniform distribution in an interval <code class="reqn">[a_1, a_2]</code>
<code class="reqn">b_{1i}</code>, <code class="reqn">b_{i1}</code> follows uniform distribution in an interval
<code class="reqn">[b_1, b_2]</code>; <code class="reqn">c_{1i}</code>, <code class="reqn">c_{i1}</code> follows uniform distribution
in an interval <code class="reqn">[c_1, c_2]</code>; <code class="reqn">u_i</code> follows Bernoulli distribution
and <code class="reqn">e_i(t)</code> is a Gaussian processes with zero mean and covariance
function of the form </p>
<p style="text-align: center;"><code class="reqn">\gamma(s,t) = \alpha\exp{-\beta|t-s|^\nu}</code>
</p>

<p>Please see the simulation models vignette with
<code>vignette("simulation_models", package = "fdaoutlier")</code> for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation_model9(
  n = 100,
  p = 50,
  outlier_rate = 0.05,
  kprob = 0.5,
  ai = c(3, 8),
  bi = c(1.5, 2.5),
  ci = c(9, 10.5),
  cov_alpha = 1,
  cov_beta = 1,
  cov_nu = 1,
  deterministic = TRUE,
  seed = NULL,
  plot = F,
  plot_title = "Simulation Model 9",
  title_cex = 1.5,
  show_legend = T,
  ylabel = "",
  xlabel = "gridpoints"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulation_model9_+3A_n">n</code></td>
<td>
<p>The number of curves to generate. Set to <code class="reqn">100</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model9_+3A_p">p</code></td>
<td>
<p>The number of evaluation points of the curves. Curves are usually generated
over the interval <code class="reqn">[0, 1]</code>. Set to <code class="reqn">50</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model9_+3A_outlier_rate">outlier_rate</code></td>
<td>
<p>A value between <code class="reqn">[0, 1]</code> indicating the percentage of outliers.
A value of <code class="reqn">0.06</code> indicates about <code class="reqn">6\%</code> of the observations will be outliers
depending on whether the parameter <code>deterministic</code> is <code>TRUE</code> or not.
Set to <code class="reqn">0.05</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model9_+3A_kprob">kprob</code></td>
<td>
<p>The probability <code class="reqn">P(u_i = 1)</code>. Set to <code class="reqn">0.5</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model9_+3A_ai">ai</code></td>
<td>
<p>A vector of two values containing <code class="reqn">a_{1i}</code> and <code class="reqn">a_{2i}</code>
in the main model. Set to <code>c(3, 8)</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model9_+3A_bi">bi</code></td>
<td>
<p>A vector of 2 values containing <code class="reqn">b_{1i}</code> and <code class="reqn">b_{2i}</code> in the
contamination model. Set to <code>c(1.5, 2.5)</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model9_+3A_ci">ci</code></td>
<td>
<p>A vector of 2 values containing $c_1i$ and $c_2i$ in the contamination
model. Set to <code>c(9, 10.5)</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model9_+3A_cov_alpha">cov_alpha</code></td>
<td>
<p>A value indicating the coefficient of the exponential function
of the covariance matrix, i.e., the <code class="reqn">\alpha</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model9_+3A_cov_beta">cov_beta</code></td>
<td>
<p>A value indicating the coefficient of the terms inside the exponential
function of the covariance matrix, i.e., the <code class="reqn">\beta</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model9_+3A_cov_nu">cov_nu</code></td>
<td>
<p>A value indicating the power to which to raise the terms inside the exponential
function of the covariance matrix, i.e., the <code class="reqn">\nu</code> in the covariance function.
Set to <code class="reqn">1</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model9_+3A_deterministic">deterministic</code></td>
<td>
<p>A logical value. If <code>TRUE</code>, the function will always return
<code>round(n*outlier_rate)</code> outliers and consequently the number of outliers is always constant.
If <code>FALSE</code>, the number of outliers are determined using <code>n</code> Bernoulli trials with
probability <code>outlier_rate</code>, and consequently the number of outliers returned is random.
<code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model9_+3A_seed">seed</code></td>
<td>
<p>A seed to set for reproducibility. <code>NULL</code> by default in which case a seed
is not set.</p>
</td></tr>
<tr><td><code id="simulation_model9_+3A_plot">plot</code></td>
<td>
<p>A logical value indicating whether to plot data.</p>
</td></tr>
<tr><td><code id="simulation_model9_+3A_plot_title">plot_title</code></td>
<td>
<p>Title of plot if <code>plot</code> is <code>TRUE</code></p>
</td></tr>
<tr><td><code id="simulation_model9_+3A_title_cex">title_cex</code></td>
<td>
<p>Numerical value indicating the size of the plot title relative to the device default.
Set to 1.5 by default. Ignored if <code>plot = FALSE</code>.</p>
</td></tr>
<tr><td><code id="simulation_model9_+3A_show_legend">show_legend</code></td>
<td>
<p>A logical indicating whether to add legend to plot if <code>plot = TRUE</code>.</p>
</td></tr>
<tr><td><code id="simulation_model9_+3A_ylabel">ylabel</code></td>
<td>
<p>The label of the y-axis. Set to <code>""</code> by default.</p>
</td></tr>
<tr><td><code id="simulation_model9_+3A_xlabel">xlabel</code></td>
<td>
<p>The label of the x-axis if <code>plot = TRUE</code>. Set to
<code>"gridpoints"</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>a matrix of size <code>n</code> by <code>p</code> containing the simulated data set</p>
</td></tr>
<tr><td><code>true_outliers</code></td>
<td>
<p>a vector of integers indicating the row index of the outliers in the
generated data.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>dt &lt;- simulation_model9(plot = TRUE)
dim(dt$data)
dt$true_outliers
</code></pre>

<hr>
<h2 id='spanish_weather'>Spanish Weather Data</h2><span id='topic+spanish_weather'></span>

<h3>Description</h3>

<p>A dataset containing daily temperature, log precipitation and wind speed of 73 spanish weather stations
in Spain between 1980 - 2009.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spanish_weather
</code></pre>


<h3>Format</h3>

<p>A list containing :
</p>

<dl>
<dt><code>$station_info:</code></dt><dd><p>A dataframe containing geographic information from the 73 weather stations
with the following variables:
</p>

<dl>
<dt><code>ind:</code></dt><dd><p>id of weather station</p>
</dd>
<dt><code>name:</code></dt><dd><p>name of weather station</p>
</dd>
<dt><code>province:</code></dt><dd><p>province of weather station</p>
</dd>
<dt><code>altitude:</code></dt><dd><p>altitude in meters of the station</p>
</dd>
<dt><code>year.ini:</code></dt><dd><p>start year</p>
</dd>
<dt><code>year.end:</code></dt><dd><p>end year</p>
</dd>
<dt><code>longitude:</code></dt><dd><p>longitude of the coordinates of the weather station (in decimal degrees)</p>
</dd>
<dt><code>longitude:</code></dt><dd><p>latitude of the coordinates of the weather station (in decimal degrees)</p>
</dd>
</dl>

</dd>
<dt><code>$temperature:</code></dt><dd><p>A matrix of size 73 (stations) by 365 (days) containing
average daily temperature for the period 1980-2009 (in degrees Celsius, marked
with UTF-8 string). Leap years temperatures for February 28 and 29 were averaged.</p>
</dd>
<dt><code>$wind_speed:</code></dt><dd><p>A matrix of size 73 (stations) by 365 (days) containing
average daily wind speed for the period 1980-2009 (in m/s).</p>
</dd>
<dt><code>$logprec:</code></dt><dd><p>A matrix of size 73 (stations) by 365 (days) containing average daily log precipitation
for the period 1980-2009 (in log mm). Negligible precipitation (less than 1 tenth of mm)
is replaced by 0.05 and no precipitation (<code>0.0</code> mm) is replaced by <code>0.01</code> after which
the logarithm was applied.</p>
</dd>
</dl>



<h3>Details</h3>

<p>This is a stripped down version of the popular <code>aemet</code> spanish weather data available in
the <code>fda.usc</code> <a href="https://doi.org/10.18637/jss.v051.i04">doi:10.18637/jss.v051.i04</a> package.
See the documentation of <code>fda.usc</code> for more details about data.
</p>


<h3>Source</h3>

<p>Data obtained from the <code>fda.usc</code> <a href="https://doi.org/10.18637/jss.v051.i04">doi:10.18637/jss.v051.i04</a> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(spanish_weather)
names(spanish_weather)
names(spanish_weather$station_info)

</code></pre>

<hr>
<h2 id='total_variation_depth'>Total Variation Depth and Modified Shape Similarity Index</h2><span id='topic+total_variation_depth'></span>

<h3>Description</h3>

<p>This function computes the total variation depth (tvd) and the modified shape similarity index (mss)
proposed in Huang and Sun (2019) <a href="https://doi.org/10.1080/00401706.2019.1574241">doi:10.1080/00401706.2019.1574241</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>total_variation_depth(dts)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="total_variation_depth_+3A_dts">dts</code></td>
<td>
<p>A matrix or dataframe of size <code class="reqn">n</code> observations/curves by <code class="reqn">p</code> domain/evaluation
points.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the total variation depth (TVD) and modified shape
similarity (MSS) index of a univariate functional data. The definition of the
estimates of TVD and MSS can be found in Huang and Sun (2019)
<a href="https://doi.org/10.1080/00401706.2019.1574241">doi:10.1080/00401706.2019.1574241</a>.
</p>


<h3>Value</h3>

<p>Returns a list containing the following
</p>
<table>
<tr><td><code>tvd</code></td>
<td>
<p>the total variation depths of the observations of <code>dts</code></p>
</td></tr>
<tr><td><code>mss</code></td>
<td>
<p>the modified shape similarity index of the observations of <code>dts</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Oluwasegun Ojo
</p>


<h3>References</h3>

<p>Huang, H., &amp; Sun, Y. (2019). A decomposition of total variation depth for
understanding functional outliers. <em>Technometrics</em>, 61(4), 445-458.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tvd_mss">tvd_mss</a></code> for outlier detection using TVD and MSS.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dt6 &lt;- simulation_model6()
tvd_object &lt;- total_variation_depth(dt6$data)
</code></pre>

<hr>
<h2 id='tvd_mss'>Outlier detection using the total variation depth and modified shape similarity index.</h2><span id='topic+tvd_mss'></span><span id='topic+tvdmss'></span>

<h3>Description</h3>

<p>Find shape and magnitude outliers  using the Total Variation Depth and Modified
Shape Similarity Index proposed in Huang and Sun (2019) <a href="https://doi.org/10.1080/00401706.2019.1574241">doi:10.1080/00401706.2019.1574241</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tvd_mss(
  data,
  emp_factor_mss = 1.5,
  emp_factor_tvd = 1.5,
  central_region_tvd = 0.5
)

tvdmss(
  dts,
  emp_factor_mss = 1.5,
  emp_factor_tvd = 1.5,
  central_region_tvd = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tvd_mss_+3A_emp_factor_mss">emp_factor_mss</code></td>
<td>
<p>The empirical factor of the classical boxplot used on the modified shape
similarity index. Defaults to 1.5.</p>
</td></tr>
<tr><td><code id="tvd_mss_+3A_emp_factor_tvd">emp_factor_tvd</code></td>
<td>
<p>The empirical factor of the functional boxplot used on the TVD of observations.
Defaults to 1.5.</p>
</td></tr>
<tr><td><code id="tvd_mss_+3A_central_region_tvd">central_region_tvd</code></td>
<td>
<p>A number between 0 and 1 indicating the central region probability of
the functional boxplot used on the TVD of the observations. Defaults to 0.5. See also details.</p>
</td></tr>
<tr><td><code id="tvd_mss_+3A_dts">dts</code>, <code id="tvd_mss_+3A_data">data</code></td>
<td>
<p>A matrix or dataframe of size <code class="reqn">n</code> observations/curves by <code class="reqn">p</code> domain/evaluation
points.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method uses a combination of total variation depth (TVD) and modified shape similarity (MSS) index
defined in Huang and Sun (2019) <a href="https://doi.org/10.1080/00401706.2019.1574241">doi:10.1080/00401706.2019.1574241</a>
to find magnitude and shape outliers. The TVD and MSS of all the observations are
first computed and a classical boxplot is then applied on the MSS. Outliers detected
by the boxplot of MSS are flagged as shape outliers. The shape outliers are then removed
from the data and the TVD of the remaining observations are used in a functional boxplot
to detect magnitude outliers.  The central region
of this functional boxplot (<code>central_region_tvd</code>) is w.r.t. to the original number of curves. Thus if
8 shape outliers are found out of 100 curves, specifying <code>central_region_tvd</code> = 0.5 will ensure that
50 observations are used as the central region in the functional boxplot on the remaining 92 observations.
</p>


<h3>Value</h3>

<p>Returns a list containing the following
</p>
<table>
<tr><td><code>outliers</code></td>
<td>
<p>the indices of the (shape and magnitude) outliers</p>
</td></tr>
<tr><td><code>shape_outliers</code></td>
<td>
<p>the indices of the shape outliers</p>
</td></tr>
<tr><td><code>magnitude_outliers</code></td>
<td>
<p>the indices of the magnitude outliers</p>
</td></tr>
<tr><td><code>tvd</code></td>
<td>
<p>the total variation depths of the observations of <code>data</code></p>
</td></tr>
<tr><td><code>mss</code></td>
<td>
<p>the modified shape similarity index of the observations of <code>data</code></p>
</td></tr>
</table>


<h3>Functions</h3>


<ul>
<li> <p><code>tvd_mss()</code>: Deprecated function. Use <code>tvdmss</code> instead.
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Oluwasegun Ojo
</p>


<h3>References</h3>

<p>Huang, H., &amp; Sun, Y. (2019). A decomposition of total variation depth for
understanding functional outliers. <em>Technometrics</em>, 61(4), 445-458.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+msplot">msplot</a></code> for outlier detection using msplot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dt6 &lt;- simulation_model6()
res &lt;- tvdmss(dt6$data)
res$outliers

</code></pre>

<hr>
<h2 id='world_population'>World Population Data by Countries</h2><span id='topic+world_population'></span>

<h3>Description</h3>

<p>This is the world population data, revision 2010, by countries used in the paper
Nagy et al. (2016) <a href="https://doi.org/10.1080/10618600.2017.1336445">doi:10.1080/10618600.2017.1336445</a> and Dai et al. (2020)
<a href="https://doi.org/10.1016/j.csda.2020.106960">doi:10.1016/j.csda.2020.106960</a>. It contains population (both sexes) of countries
as of July 1 in the years 1950 - 2010. The data have been pre-processed as described
in Nagy et al. (2016) and hence contains only the 105 countries with population
in the range of one million and fifteen million on July 1, 1980.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>world_population
</code></pre>


<h3>Format</h3>

<p>A matrix of size 105 rows by 61 columns.
</p>


<h3>Details</h3>

<p>Data included for illustration and testing purposes.
</p>


<h3>Source</h3>

<p>Data originally available in the <code>depth.fd</code> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(world_population)
str(world_population)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
