<!DOCTYPE html><html><head><title>Help for package MetabolAnalyze</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MetabolAnalyze}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MetabolAnalyze-package'>
<p>Probabilistic latent variable models for metabolomic data.</p></a></li>
<li><a href='#Aitken'>
<p>Assess convergence of an EM algorithm.</p></a></li>
<li><a href='#BrainSpectra'>
<p>NMR spectral data from brain tissue samples.</p></a></li>
<li><a href='#estep1'>
<p>First E step of the AECM algorithm when fitting a mixture of PPCA models.</p></a></li>
<li><a href='#estep2'>
<p>Second E step of the AECM algorithm when fitting a mixture of PPCA models.</p></a></li>
<li><a href='#ht'>
<p>Function to plot a heatmap of BIC values.</p></a></li>
<li><a href='#loadings.jack.plot'>
<p>Plot loadings and their associated confidence intervals.</p></a></li>
<li><a href='#loadings.plot'>
<p>Plot loadings.</p></a></li>
<li><a href='#mppca.loadings.plot'>
<p>Plot loadings resulting from fitting a MPPCA model.</p></a></li>
<li><a href='#mppca.metabol'>
<p>Fit a mixture of probabilistic principal components analysis (MPPCA) model to a metabolomic data set via the EM algorithm to perform simultaneous dimension reduction and clustering.</p></a></li>
<li><a href='#mppca.scores.plot'>
<p>Plot scores from a fitted MPPCA model</p></a></li>
<li><a href='#mstep1'>
<p>First M-step of the AECM algorithm when fitting a mixture of PPCA models.</p></a></li>
<li><a href='#mstep2'>
<p>Second M-step of the AECM algorithm when fitting a mixture of PPCA models.</p></a></li>
<li><a href='#ppca.metabol'>
<p>Fit a probabilistic principal components analysis (PPCA) model to a metabolomic data set via the EM algorithm.</p></a></li>
<li><a href='#ppca.metabol.jack'>
<p>Fit a probabilistic principal components analysis model to a metabolomic data set, and assess uncertainty via the jackknife.</p></a></li>
<li><a href='#ppca.scores.plot'>
<p>Plot scores from a fitted PPCA model</p></a></li>
<li><a href='#ppcca.metabol'>
<p>Fit a probabilistic principal components and covariates analysis (PPCCA) model to a metabolomic data set via the EM algorithm.</p></a></li>
<li><a href='#ppcca.metabol.jack'>
<p>Fit a probabilistic principal components and covariates analysis model to a metabolomic data set, and assess uncertainty via the jackknife.</p></a></li>
<li><a href='#ppcca.scores.plot'>
<p>Plot scores from a fitted PPCCA model.</p></a></li>
<li><a href='#scaling'>
<p>Function to scale metabolomic spectral data.</p></a></li>
<li><a href='#standardize'>
<p>Function to scale covariates.</p></a></li>
<li><a href='#UrineSpectra'>
<p>NMR metabolomic spectra from urine samples of 18 mice.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Probabilistic Latent Variable Models for Metabolomic Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2010-05-12</td>
</tr>
<tr>
<td>Author:</td>
<td>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Claire Gormley &lt;claire.gormley@ucd.ie&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits probabilistic principal components analysis,
        probabilistic principal components and covariates analysis and
        mixtures of probabilistic principal components models to
        metabolomic spectral data.</td>
</tr>
<tr>
<td>Depends:</td>
<td>mclust, mvtnorm, ellipse, gtools, gplots</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-08-31 10:22:13 UTC; hornik</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-08-31 10:24:07 UTC</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
</table>
<hr>
<h2 id='MetabolAnalyze-package'>
Probabilistic latent variable models for metabolomic data.
</h2><span id='topic+MetabolAnalyze-package'></span><span id='topic+MetabolAnalyze'></span>

<h3>Description</h3>

<p>Fits probabilistic principal components analysis (PPCA), probabilistic principal components and covariates analysis (PPCCA) and mixtures of probabilistic principal component analysis (MPPCA) models to metabolomic spectral data. Estimates of the uncertainty associated with the model parameter estimates are provided.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> MetabolAnalyze</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2010-05-12</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan.
</p>
<p>Claire Gormley &lt;claire.gormley@ucd.ie&gt;
</p>


<h3>References</h3>

<p>Nyamundanda, G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical Report. University College Dublin.
</p>

<hr>
<h2 id='Aitken'>
Assess convergence of an EM algorithm.
</h2><span id='topic+Aitken'></span>

<h3>Description</h3>

<p>This function assesses convergence of the EM algorithm using Aitken's acceleration method, when fitting a PPCA based model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Aitken(ll, lla, v, q, epsilon)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Aitken_+3A_ll">ll</code></td>
<td>

<p>A vector of log likelihoods from the current and previous iterations.
</p>
</td></tr>
<tr><td><code id="Aitken_+3A_lla">lla</code></td>
<td>

<p>A vector containing the asympototic estimates of the maximized log likelihoods from the current and previous iterations.
</p>
</td></tr>
<tr><td><code id="Aitken_+3A_v">v</code></td>
<td>

<p>Iteration number.
</p>
</td></tr>
<tr><td><code id="Aitken_+3A_q">q</code></td>
<td>

<p>The dimension of the latent principal subspace for the PPCA based model currently being fitted.
</p>
</td></tr>
<tr><td><code id="Aitken_+3A_epsilon">epsilon</code></td>
<td>

<p>The value on which convergence of the EM algorithm is based. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function assesses convergence of the EM algorithm using Aitken's acceleration method in which an estimate of the maximized log likelihood at each iteration is evaluated. Convergence is achieved when the absolute difference between contiguous estimates, tol, is less than some user defined level, epsilon.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>tol</code></td>
<td>
<p>The absolute difference between contiguous estimates of the asymptotic maximized log likelihood.</p>
</td></tr>
<tr><td><code>la</code></td>
<td>
<p>The asymptotic estimate of the maximized log likelihood at the current iteration.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This is used internally in functions which fit PPCA based models via the EM algorithm within the package MetabolAnalyze.
</p>


<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan
</p>


<h3>References</h3>

<p>McLachlan, G.J. and Krishnan, T. (1997) The EM algorithm and Extensions. Wiley, New York.</p>


<h3>See Also</h3>

<p><code><a href="#topic+ppca.metabol">ppca.metabol</a></code>, <code><a href="#topic+ppcca.metabol">ppcca.metabol</a></code>, <code><a href="#topic+mppca.metabol">mppca.metabol</a></code>
</p>

<hr>
<h2 id='BrainSpectra'>
NMR spectral data from brain tissue samples.
</h2><span id='topic+BrainSpectra'></span>

<h3>Description</h3>

<p>NMR spectral data from brain tissue samples of 33 rats, where each tissue sample originates in one of four known brain regions. Each spectrum has 164 spectral bins, measured in parts per million (ppm).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(BrainSpectra)</code></pre>


<h3>Format</h3>

<p>A list containing
</p>

<ol>
<li><p> a matrix with 33 rows and 164 columns
</p>
</li>
<li><p> a vector indicating the brain region of origin of each sample where:
</p>

<ul>
<li><p> 1 = Brain stem
</p>
</li>
<li><p> 2 = Cerebellum
</p>
</li>
<li><p> 3 = Hippocampus
</p>
</li>
<li><p> 4 = Pre-frontal cortex
</p>
</li></ul>

</li></ol>


<h3>Details</h3>

<p>This is simulated data, based on parameter estimates from a mixture of PPCA models with 4 groups and 7 principal components fitted to a similar real data set.
</p>


<h3>Source</h3>

<p>Nyamundanda, G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report. University College Dublin, Ireland.
</p>

<hr>
<h2 id='estep1'>
First E step of the AECM algorithm when fitting a mixture of PPCA models.
</h2><span id='topic+estep1'></span>

<h3>Description</h3>

<p>Internal function required for fitting a mixture of PPCA models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estep1(Y, Tau, Pi, mu, W, Sig, g, p, reset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estep1_+3A_y">Y</code></td>
<td>

<p>A N x p data matrix.
</p>
</td></tr>
<tr><td><code id="estep1_+3A_tau">Tau</code></td>
<td>

<p>A N x G matrix of posterior group membership probabilities.
</p>
</td></tr>
<tr><td><code id="estep1_+3A_pi">Pi</code></td>
<td>

<p>A G vector of mixing proportions.
</p>
</td></tr>
<tr><td><code id="estep1_+3A_mu">mu</code></td>
<td>

<p>A p x G matrix containing the mean for each group.
</p>
</td></tr>
<tr><td><code id="estep1_+3A_w">W</code></td>
<td>

<p>An p x q x G array of loadings for each group.
</p>
</td></tr>
<tr><td><code id="estep1_+3A_sig">Sig</code></td>
<td>

<p>A scalar; the error covariance.
</p>
</td></tr>
<tr><td><code id="estep1_+3A_g">g</code></td>
<td>

<p>The number of groups currently being fitted.
</p>
</td></tr>
<tr><td><code id="estep1_+3A_p">p</code></td>
<td>

<p>Number of spectral bins in the NMR spectra.
</p>
</td></tr>
<tr><td><code id="estep1_+3A_reset">reset</code></td>
<td>

<p>Logical indicating computational instability.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>First E step of the AECM algorithm when fitting a mixture of PPCA models. An internal function.
</p>


<h3>Value</h3>

<p>A list containing
</p>
<table>
<tr><td><code>Tau</code></td>
<td>
<p>The N x G matrix of posterior group membership probablities.</p>
</td></tr>
<tr><td><code>logTau</code></td>
<td>
<p>An N x G matrix of the log of the numerator of posterior group membership probablities.</p>
</td></tr>
<tr><td><code>reset</code></td>
<td>
<p>Logical indicating computational instability.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>An internal function.
</p>


<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan
</p>


<h3>References</h3>

<p>Nyamundanda, G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report. University College Dublin, Ireland.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mppca.metabol">mppca.metabol</a></code>
</p>

<hr>
<h2 id='estep2'>
Second E step of the AECM algorithm when fitting a mixture of PPCA models.
</h2><span id='topic+estep2'></span>

<h3>Description</h3>

<p>Internal function required for fitting a mixture of PPCA models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estep2(Y, Tau, Pi, mu, W, Sig, g, p, reset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estep2_+3A_y">Y</code></td>
<td>

<p>A N x p data matrix.
</p>
</td></tr>
<tr><td><code id="estep2_+3A_tau">Tau</code></td>
<td>

<p>An N x g matrix of posterior group membership probabilities.
</p>
</td></tr>
<tr><td><code id="estep2_+3A_pi">Pi</code></td>
<td>

<p>A g vector of group probabilities.
</p>
</td></tr>
<tr><td><code id="estep2_+3A_mu">mu</code></td>
<td>

<p>A p x g matrix containing the mean for each group.
</p>
</td></tr>
<tr><td><code id="estep2_+3A_w">W</code></td>
<td>

<p>An p x q x g array of loadings for each group.
</p>
</td></tr>
<tr><td><code id="estep2_+3A_sig">Sig</code></td>
<td>

<p>A scalar; the error covariance.
</p>
</td></tr>
<tr><td><code id="estep2_+3A_g">g</code></td>
<td>

<p>The number of groups currently being fitted.
</p>
</td></tr>
<tr><td><code id="estep2_+3A_p">p</code></td>
<td>

<p>Number of spectral bins in the NMR spectra.
</p>
</td></tr>
<tr><td><code id="estep2_+3A_reset">reset</code></td>
<td>

<p>Logical indicating computational instability.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Second E step of the AECM algorithm when fitting a mixture of PPCA models. An internal function.</p>


<h3>Value</h3>

<p>A list containing
</p>
<table>
<tr><td><code>Tau</code></td>
<td>
<p>The N x G matrix of posterior group membership probablities.</p>
</td></tr>
<tr><td><code>logTau</code></td>
<td>
<p>An N x G matrix of the log of the numerator of posterior group membership probablities.</p>
</td></tr>
<tr><td><code>reset</code></td>
<td>
<p>Logical indicating computational instability.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>An internal function.
</p>


<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan
</p>


<h3>References</h3>

<p>Nyamundanda, G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report. University College Dublin, Ireland.</p>


<h3>See Also</h3>

<p><code><a href="#topic+mppca.metabol">mppca.metabol</a></code>
</p>

<hr>
<h2 id='ht'>
Function to plot a heatmap of BIC values.
</h2><span id='topic+ht'></span>

<h3>Description</h3>

<p>Function to plot a heat map of BIC values where lighter colours indicate larger values and optimal models. A black cross indicates the optimal model.
</p>
<p>The function is a modified version of <code><a href="stats.html#topic+heatmap">heatmap</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ht(x, Rowv = NULL, Colv = if (symm) "Rowv" else NULL, distfun = dist,
   hclustfun = hclust, reorderfun = function(d, w) reorder(d, w),
   add.expr, symm = FALSE, revC = identical(Colv, "Rowv"),
   scale = c("row", "column", "none"), na.rm = FALSE, margins = c(5, 5),
   ColSideColors, RowSideColors, cexRow = 1, cexCol = 1, labRow = NULL,
   labCol = NULL, main = NULL, xlab = NULL, ylab = NULL,
   keep.dendro = FALSE, verbose = getOption("verbose"), q, g)
</code></pre>


<h3>Arguments</h3>

<p>See the help file for <code><a href="stats.html#topic+heatmap">heatmap</a></code>.
</p>


<h3>Details</h3>

<p>This function is used internally in <code><a href="#topic+mppca.metabol">mppca.metabol</a></code>.
</p>


<h3>Value</h3>

<p>See the help file for <code><a href="stats.html#topic+heatmap">heatmap</a></code>.
</p>


<h3>Note</h3>

<p>An internal function.
</p>


<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan
</p>


<h3>References</h3>

<p>Nyamundanda, G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report. University College Dublin, Ireland.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mppca.metabol">mppca.metabol</a></code>
</p>

<hr>
<h2 id='loadings.jack.plot'>
Plot loadings and their associated confidence intervals.
</h2><span id='topic+loadings.jack.plot'></span>

<h3>Description</h3>

<p>A function to plot the loadings and confidence intervals resulting from fitting a PPCA model or a PPCCA model to metabolomic data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadings.jack.plot(output)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loadings.jack.plot_+3A_output">output</code></td>
<td>

<p>An object resulting from fitting a PPCA model or a PPCCA model.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function produces a plot of those loadings on the first principal component which are significantly different from zero, and higher than a user specified cutoff point. Error bars associated with the estimates, derived using the jackknife, are also plotted.
</p>


<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan
</p>


<h3>References</h3>

<p>Nyamundanda, G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report. University College Dublin, Ireland.</p>


<h3>See Also</h3>

<p><code><a href="#topic+ppca.metabol.jack">ppca.metabol.jack</a></code>, <code><a href="#topic+ppcca.metabol.jack">ppcca.metabol.jack</a></code>
</p>

<hr>
<h2 id='loadings.plot'>
Plot loadings.
</h2><span id='topic+loadings.plot'></span>

<h3>Description</h3>

<p>A function to plot the loadings resulting from fitting a PPCA model or a PPCCA model to metabolomic data. A barplot or a scatterplot can be produced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadings.plot(output, barplot = FALSE, labelsize = 0.3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loadings.plot_+3A_output">output</code></td>
<td>

<p>An object resulting from fitting a PPCA model or a PPCCA model.
</p>
</td></tr>
<tr><td><code id="loadings.plot_+3A_barplot">barplot</code></td>
<td>

<p>Logical indicating whether a barplot of the loadings is required rather than a scatter plot. By default a scatter plot is produced.
</p>
</td></tr>
<tr><td><code id="loadings.plot_+3A_labelsize">labelsize</code></td>
<td>

<p>Size of the text of the spectral bin labels on the resulting plot.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A function to plot the loadings resulting from fitting a PPCA model or a PPCCA model to metabolomic data. A barplot or a scatterplot can be produced. The size of the text of the spectral bin labels on the bar plot can also be adjusted if the number of bins plotted is large.
</p>


<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan
</p>


<h3>References</h3>

<p>Nyamundanda, G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report. University College Dublin, Ireland.</p>


<h3>See Also</h3>

<p><code><a href="#topic+ppca.metabol">ppca.metabol</a></code>, <code><a href="#topic+ppcca.metabol">ppcca.metabol</a></code>
</p>

<hr>
<h2 id='mppca.loadings.plot'>
Plot loadings resulting from fitting a MPPCA model.
</h2><span id='topic+mppca.loadings.plot'></span>

<h3>Description</h3>

<p>A function to plot the loadings resulting from fitting a MPPCA model to metabolomic data. A barplot or a scatterplot can be produced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mppca.loadings.plot(output, Y, barplot = FALSE, labelsize = 0.3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mppca.loadings.plot_+3A_output">output</code></td>
<td>

<p>An object resulting from fitting a MPPCA model.
</p>
</td></tr>
<tr><td><code id="mppca.loadings.plot_+3A_y">Y</code></td>
<td>

<p>The N x p matrix of observations to which the MPPCA model is fitted.
</p>
</td></tr>
<tr><td><code id="mppca.loadings.plot_+3A_barplot">barplot</code></td>
<td>

<p>Logical indicating whether a barplot of the loadings is required rather than a scatter plot. By default a scatter plot is produced.
</p>
</td></tr>
<tr><td><code id="mppca.loadings.plot_+3A_labelsize">labelsize</code></td>
<td>

<p>Size of the text of the spectral bin labels on the resulting plot.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A function which produces a series of plots illustrating the loadings resulting from fitting a MPPCA model to metabolomic data. A barplot or a scatterplot can be produced. The size of the text of the spectral bin labels on the bar plot can also be adjusted if the number of bins plotted is large.
</p>


<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan
</p>


<h3>References</h3>

<p>Nyamundanda, G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report. University College Dublin, Ireland.</p>


<h3>See Also</h3>

<p><code><a href="#topic+mppca.metabol">mppca.metabol</a></code>
</p>

<hr>
<h2 id='mppca.metabol'>
Fit a mixture of probabilistic principal components analysis (MPPCA) model to a metabolomic data set via the EM algorithm to perform simultaneous dimension reduction and clustering.
</h2><span id='topic+mppca.metabol'></span>

<h3>Description</h3>

<p>This function fits a mixture of probabilistic principal components analysis model to metabolomic spectral data via the EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mppca.metabol(Y, minq=1, maxq=2, ming, maxg, scale = "none", 
epsilon = 0.1, plot.BIC = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mppca.metabol_+3A_y">Y</code></td>
<td>

<p>An N x p data matrix where each row is a spectrum.
</p>
</td></tr>
<tr><td><code id="mppca.metabol_+3A_minq">minq</code></td>
<td>

<p>The minimum number of principal components to be fit. By default minq is 1.
</p>
</td></tr>
<tr><td><code id="mppca.metabol_+3A_maxq">maxq</code></td>
<td>

<p>The maximum number of principal components to be fit. By default maxq is 2.
</p>
</td></tr>
<tr><td><code id="mppca.metabol_+3A_ming">ming</code></td>
<td>

<p>The minimum number of groups to be fit.
</p>
</td></tr>
<tr><td><code id="mppca.metabol_+3A_maxg">maxg</code></td>
<td>

<p>The maximum number of groups to be fit.
</p>
</td></tr>
<tr><td><code id="mppca.metabol_+3A_scale">scale</code></td>
<td>

<p>Type of scaling of the data which is required. The default is &quot;none&quot;. Options include &quot;pareto' and &quot;unit&quot; scaling. See <code><a href="#topic+scaling">scaling</a></code> for further details.
</p>
</td></tr>
<tr><td><code id="mppca.metabol_+3A_epsilon">epsilon</code></td>
<td>

<p>Value on which the convergence assessment criterion is based. Set by default to 0.1.
</p>
</td></tr>
<tr><td><code id="mppca.metabol_+3A_plot.bic">plot.BIC</code></td>
<td>

<p>Logical indicating whether or not a plot of the BIC values for the different models fitted should be provided. By default, the plot is not produced.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits a mixture of probabilistic principal components analysis models to metabolomic spectral data via the EM algorithm. A range of models with different numbers of groups and different numbers of principal components can be fitted. The model performs simultaneous clustering of observations into unknown groups and dimension reduction simultaneously.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>q</code></td>
<td>
<p>The number of principal components in the optimal MPPCA model, selected by the BIC.</p>
</td></tr>
<tr><td><code>g</code></td>
<td>
<p>The number of groups in the optimal MPPCA model, selected by the BIC.</p>
</td></tr>
<tr><td><code>sig</code></td>
<td>
<p>The posterior mode estimate of the variance of the error terms.</p>
</td></tr>
<tr><td><code>scores</code></td>
<td>
<p>A list of length g, each entry of which is a n_g x q matrix of estimates of the latent locations of each observation in group g in the principal subspace.</p>
</td></tr>
<tr><td><code>loadings</code></td>
<td>
<p>An array of dimension p x q x g, each sheet of which contains the maximum likelihood estimate of the p x q loadings matrix for a group.</p>
</td></tr>
<tr><td><code>Pi</code></td>
<td>
<p>The vector indicating the probability of belonging to each group.</p>
</td></tr>
<tr><td><code>mean</code></td>
<td>
<p>A p x g matrix, each column of which contains a group mean.</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>An N x g matrix, each row of which contains the posterior group membership probabilities for an observation.</p>
</td></tr>
<tr><td><code>clustering</code></td>
<td>
<p>A vector of length N indicating the group to which each observation belongs.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>A matrix containing the BIC values for the fitted models.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>A matrix containing the AIC values for the fitted models.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan.
</p>


<h3>References</h3>

<p>Nyamundanda G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report, University College Dublin.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mppca.scores.plot">mppca.scores.plot</a></code>, <code><a href="#topic+mppca.loadings.plot">mppca.loadings.plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(BrainSpectra)
## Not run: 
mdlfit&lt;-mppca.metabol(BrainSpectra[[1]], minq=7, maxq=7, ming=4, maxg=4, 
plot.BIC = TRUE)
mppca.scores.plot(mdlfit)
mppca.loadings.plot(mdlfit, BrainSpectra[[1]])

## End(Not run)
</code></pre>

<hr>
<h2 id='mppca.scores.plot'>
Plot scores from a fitted MPPCA model
</h2><span id='topic+mppca.scores.plot'></span>

<h3>Description</h3>

<p>A function to plot the scores resulting from fitting a MPPCA model to metabolomic data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mppca.scores.plot(output, group = FALSE, gplegend = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mppca.scores.plot_+3A_output">output</code></td>
<td>

<p>An object resulting from fitting a MPPCA model.
</p>
</td></tr>
<tr><td><code id="mppca.scores.plot_+3A_group">group</code></td>
<td>

<p>Should it be relevant, a vector indicating the known treatment group membership of each observation prior to clustering.
</p>
</td></tr>
<tr><td><code id="mppca.scores.plot_+3A_gplegend">gplegend</code></td>
<td>

<p>Logical indicating whether a legend should be plotted.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces a series of scatterplots, for each group uncovered. For group g, each scatterplot illustrates the estimated score for each observation allocated to that group within the reduced q dimensional space. The uncertainty associated with the score estimate is also illustrated through its 95
</p>
<p>It is often the case that observations are known to belong to treatment groups, for example, and the MPPCA model is employed to uncover any underlying subgroups, possibly related to disease subtypes. The treatment group membership of each observation can be illustrated on the plots produced by utilizing the &lsquo;group&rsquo; argument.
</p>


<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan
</p>


<h3>References</h3>

<p>Nyamundanda, G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report. University College Dublin, Ireland.</p>


<h3>See Also</h3>

<p><code><a href="#topic+mppca.metabol">mppca.metabol</a></code>
</p>

<hr>
<h2 id='mstep1'>
First M-step of the AECM algorithm when fitting a mixture of PPCA models.
</h2><span id='topic+mstep1'></span>

<h3>Description</h3>

<p>Internal function required for fitting a mixture of PPCA models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mstep1(Y, Tau, Pi, mu, g)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mstep1_+3A_y">Y</code></td>
<td>

<p>A N x p data matrix.
</p>
</td></tr>
<tr><td><code id="mstep1_+3A_tau">Tau</code></td>
<td>

<p>An N x G matrix of posterior group membership probabilities.
</p>
</td></tr>
<tr><td><code id="mstep1_+3A_pi">Pi</code></td>
<td>

<p>A g vector of group probabilities.
</p>
</td></tr>
<tr><td><code id="mstep1_+3A_mu">mu</code></td>
<td>

<p>A p x g matrix containing the mean for each group.
</p>
</td></tr>
<tr><td><code id="mstep1_+3A_g">g</code></td>
<td>

<p>The number of groups currently being fitted.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>First M-step of the AECM algorithm when fitting a mixture of PPCA models. An internal function.</p>


<h3>Value</h3>

<p>A list containing
</p>
<table>
<tr><td><code>Pi</code></td>
<td>
<p>A g vector of group probabilities</p>
</td></tr>
<tr><td><code>Mu</code></td>
<td>
<p>A p x g matrix each column of which contains a group mean.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>An internal function.
</p>


<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan
</p>


<h3>References</h3>

<p>Nyamundanda, G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report. University College Dublin, Ireland.</p>


<h3>See Also</h3>

<p><code><a href="#topic+mppca.metabol">mppca.metabol</a></code>
</p>

<hr>
<h2 id='mstep2'>
Second M-step of the AECM algorithm when fitting a mixture of PPCA models.
</h2><span id='topic+mstep2'></span>

<h3>Description</h3>

<p>Internal function required for fitting a mixture of PPCA models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mstep2(Y, Tau, Pi, mu, W, Sig, g, p, q)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mstep2_+3A_y">Y</code></td>
<td>

<p>A N x p data matrix.
</p>
</td></tr>
<tr><td><code id="mstep2_+3A_tau">Tau</code></td>
<td>

<p>An N x G matrix of posterior group membership probabilities.
</p>
</td></tr>
<tr><td><code id="mstep2_+3A_pi">Pi</code></td>
<td>

<p>A g vector of group probabilities.
</p>
</td></tr>
<tr><td><code id="mstep2_+3A_mu">mu</code></td>
<td>

<p>A p x g matrix containing the mean for each group.
</p>
</td></tr>
<tr><td><code id="mstep2_+3A_w">W</code></td>
<td>

<p>A p x q x g array, each sheet of which contains a group specific loadings matrix.
</p>
</td></tr>
<tr><td><code id="mstep2_+3A_sig">Sig</code></td>
<td>

<p>The variance parmeter.
</p>
</td></tr>
<tr><td><code id="mstep2_+3A_g">g</code></td>
<td>

<p>The number of groups currently being fitted.
</p>
</td></tr>
<tr><td><code id="mstep2_+3A_p">p</code></td>
<td>

<p>The number of spectral bins in the NMR spectrum.
</p>
</td></tr>
<tr><td><code id="mstep2_+3A_q">q</code></td>
<td>

<p>The number of principal components in the model being fitted.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Second M-step of the AECM algorithm when fitting a mixture of PPCA models. An internal function.
</p>


<h3>Value</h3>

<p>A list containing
</p>
<table>
<tr><td><code>W</code></td>
<td>
<p>A p x q x g array, each sheet of which contains a group specific loadings matrix.</p>
</td></tr>
<tr><td><code>Sig</code></td>
<td>
<p>The variance parameter.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>An internal function.
</p>


<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan
</p>


<h3>References</h3>

<p>Nyamundanda, G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report. University College Dublin, Ireland.</p>


<h3>See Also</h3>

<p><code><a href="#topic+mppca.metabol">mppca.metabol</a></code>
</p>

<hr>
<h2 id='ppca.metabol'>
Fit a probabilistic principal components analysis (PPCA) model to a metabolomic data set via the EM algorithm.
</h2><span id='topic+ppca.metabol'></span>

<h3>Description</h3>

<p>This function fits a probabilistic principal components analysis model to metabolomic spectral data via the EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppca.metabol(Y, minq=1, maxq=2, scale = "none", epsilon = 0.1, 
plot.BIC = FALSE, printout=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppca.metabol_+3A_y">Y</code></td>
<td>

<p>An N x p data matrix where each row is a spectrum.
</p>
</td></tr>
<tr><td><code id="ppca.metabol_+3A_minq">minq</code></td>
<td>

<p>The minimum number of principal components to be fit. By default minq is 1.
</p>
</td></tr>
<tr><td><code id="ppca.metabol_+3A_maxq">maxq</code></td>
<td>

<p>The maximum number of principal components to be fit. By default maxq is 2.
</p>
</td></tr>
<tr><td><code id="ppca.metabol_+3A_scale">scale</code></td>
<td>

<p>Type of scaling of the data which is required. The default is &quot;none&quot;. Options include &quot;pareto' and &quot;unit&quot; scaling. See <code><a href="#topic+scaling">scaling</a></code> for further details.
</p>
</td></tr>
<tr><td><code id="ppca.metabol_+3A_epsilon">epsilon</code></td>
<td>

<p>Value on which the convergence assessment criterion is based. Set by default to 0.1.
</p>
</td></tr>
<tr><td><code id="ppca.metabol_+3A_plot.bic">plot.BIC</code></td>
<td>

<p>Logical indicating whether or not a plot of the BIC values for the different models fitted should be provided. By default, the plot is not produced.
</p>
</td></tr>
<tr><td><code id="ppca.metabol_+3A_printout">printout</code></td>
<td>

<p>Logical indicating whether or not a statement is printed on screen detailing the progress of the algorithm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits a probabilistic principal components analysis model to metabolomic spectral data via the EM algorithm. A range of models with different numbers of principal components can be fitted.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>q</code></td>
<td>
<p>The number of principal components in the optimal PPCA model, selected by the BIC.</p>
</td></tr>
<tr><td><code>sig</code></td>
<td>
<p>The posterior mode estimate of the variance of the error terms.</p>
</td></tr>
<tr><td><code>scores</code></td>
<td>
<p>An N x q matrix of estimates of the latent locations of each observation in the principal subspace.</p>
</td></tr>
<tr><td><code>loadings</code></td>
<td>
<p>The maximum likelihood estimate of the p x q loadings matrix.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>A vector containing the BIC values for the fitted models.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>A vector containing the AIC values for the fitted models.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan.
</p>


<h3>References</h3>

<p>Nyamundanda G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report, University College Dublin.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ppca.metabol.jack">ppca.metabol.jack</a></code>, <code><a href="#topic+loadings.plot">loadings.plot</a></code>, <code><a href="#topic+ppca.scores.plot">ppca.scores.plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(UrineSpectra)
## Not run: 
mdlfit&lt;-ppca.metabol(UrineSpectra[[1]], minq=2, maxq=2, scale="none")
loadings.plot(mdlfit)
ppca.scores.plot(mdlfit, group=UrineSpectra[[2]][,1])

## End(Not run)
</code></pre>

<hr>
<h2 id='ppca.metabol.jack'>
Fit a probabilistic principal components analysis model to a metabolomic data set, and assess uncertainty via the jackknife.
</h2><span id='topic+ppca.metabol.jack'></span>

<h3>Description</h3>

<p>Fit a probabilistic principal components analysis (PPCA) model to a metabolomic data set via the EM algorithm, and assess uncertainty in the obtained loadings estimates via the jackknife.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppca.metabol.jack(Y, minq=1, maxq=2, scale ="none", 
epsilon = 0.1, conflevel = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppca.metabol.jack_+3A_y">Y</code></td>
<td>

<p>An N x p data matrix where each row is a spectrum.
</p>
</td></tr>
<tr><td><code id="ppca.metabol.jack_+3A_minq">minq</code></td>
<td>

<p>The minimum number of principal components to be fit. By default minq is 1.
</p>
</td></tr>
<tr><td><code id="ppca.metabol.jack_+3A_maxq">maxq</code></td>
<td>

<p>The maximum number of principal components to be fit. By default maxq is 2.
</p>
</td></tr>
<tr><td><code id="ppca.metabol.jack_+3A_scale">scale</code></td>
<td>

<p>Type of scaling of the data which is required. The default is &quot;none&quot;. Options include &quot;pareto' and &quot;unit&quot; scaling. See <code><a href="#topic+scaling">scaling</a></code> for further details.
</p>
</td></tr>
<tr><td><code id="ppca.metabol.jack_+3A_epsilon">epsilon</code></td>
<td>

<p>Value on which the convergence assessment criterion is based. Set by default to 0.1.
</p>
</td></tr>
<tr><td><code id="ppca.metabol.jack_+3A_conflevel">conflevel</code></td>
<td>

<p>Level of confidence required for the loadings confidence intervals. By default 95<code class="reqn">\%</code> confidence intervals are computed.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A (range of) PPCA model(s) are fitted and an optimal model (i.e. number of principal components, q) is selected. Confidence intervals for the obtained loadings are then obtained via the jackknife i.e. a model with q principal components is fitted to the dataset <code class="reqn">N</code> times, where an observation is removed from the dataset each time. 
</p>
<p>On convergence of the algorithm, the number of loadings significantly different from zero is printed on screen. The user may then further examine the significant loadings when prompted by selecting a cutoff value from the table printed on screen. Bar plots detailing the resulting significantly high loadings are provided.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>q</code></td>
<td>
<p>The number of principal components in the optimal PPCA model, selected by the BIC.</p>
</td></tr>
<tr><td><code>sig</code></td>
<td>
<p>The posterior mode estimate of the variance of the error terms.</p>
</td></tr>
<tr><td><code>scores</code></td>
<td>
<p>An N x q matrix of estimates of the latent locations of each observation in the principal subspace.</p>
</td></tr>
<tr><td><code>loadings</code></td>
<td>
<p>The maximum likelihood estimate of the p x q loadings matrix.</p>
</td></tr>
<tr><td><code>SignifW</code></td>
<td>
<p>The maximum likelihood estimate of the loadings matrix for those loadings significantly different from zero.</p>
</td></tr>
<tr><td><code>SignifHighW</code></td>
<td>
<p>The maximum likelihood estimate of the loadings matrix for those loadings significantly different from zero and higher than a user selected cutoff point.</p>
</td></tr>
<tr><td><code>Lower</code></td>
<td>
<p>The lower limit of the confidence interval for those loadings significantly different from zero.</p>
</td></tr>
<tr><td><code>Upper</code></td>
<td>
<p>The upper limit of the confidence interval for those loadings significantly different from zero.</p>
</td></tr>
<tr><td><code>Cutoffs</code></td>
<td>
<p>A table detailing a range of cutoff points and the associated number of selected spectral bins.</p>
</td></tr>
<tr><td><code>number</code></td>
<td>
<p>The number of spectral bins selected by the user.</p>
</td></tr>
<tr><td><code>cutoff</code></td>
<td>
<p>The cutoff value selected by the user.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>A vector containing the BIC values for the fitted models.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>A vector containing the AIC values for the fitted models.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan.
</p>


<h3>References</h3>

<p>Nyamundanda G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report, University College Dublin.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ppca.metabol">ppca.metabol</a></code>, <code><a href="#topic+loadings.jack.plot">loadings.jack.plot</a></code>, <code><a href="#topic+ppca.scores.plot">ppca.scores.plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(UrineSpectra)
## Not run: 
mdlfit&lt;-ppca.metabol.jack(UrineSpectra[[1]], minq=2, maxq=2, scale="none")
loadings.jack.plot(mdlfit)
ppca.scores.plot(mdlfit, group=UrineSpectra[[2]][,1])
## End(Not run)
</code></pre>

<hr>
<h2 id='ppca.scores.plot'>
Plot scores from a fitted PPCA model
</h2><span id='topic+ppca.scores.plot'></span>

<h3>Description</h3>

<p>A function to plot the scores resulting from fitting a PPCA model to metabolomic data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppca.scores.plot(output, group = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppca.scores.plot_+3A_output">output</code></td>
<td>

<p>An object resulting from fitting a PPCA model.
</p>
</td></tr>
<tr><td><code id="ppca.scores.plot_+3A_group">group</code></td>
<td>

<p>Should it be relevant, a vector indicating the known treatment group membership of each observation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces a series of scatterplots each illustrating the estimated score for each observation within the reduced q dimensional space. The uncertainty associated with the score estimate is also illustrated through its 95
</p>
<p>It is often the case that observations are known to belong to treatment groups; the treatment group membership of each observation can be illustrated on the plots produced by utilizing the &lsquo;group&rsquo; argument.
</p>


<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan
</p>


<h3>References</h3>

<p>Nyamundanda, G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report. University College Dublin, Ireland.</p>


<h3>See Also</h3>

<p><code><a href="#topic+ppca.metabol">ppca.metabol</a></code>, <code><a href="#topic+ppca.metabol.jack">ppca.metabol.jack</a></code>
</p>

<hr>
<h2 id='ppcca.metabol'>
Fit a probabilistic principal components and covariates analysis (PPCCA) model to a metabolomic data set via the EM algorithm.
</h2><span id='topic+ppcca.metabol'></span>

<h3>Description</h3>

<p>This function fits a probabilistic principal components and covariates analysis model to metabolomic spectral data via the EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppcca.metabol(Y, Covars, minq=1, maxq=2, scale = "none", epsilon = 0.1, 
plot.BIC = FALSE, printout=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppcca.metabol_+3A_y">Y</code></td>
<td>

<p>An N x p data matrix in which each row is a spectrum.
</p>
</td></tr>
<tr><td><code id="ppcca.metabol_+3A_covars">Covars</code></td>
<td>

<p>An N x L covariate data matrix in which each row is a set of covariates.
</p>
</td></tr>
<tr><td><code id="ppcca.metabol_+3A_minq">minq</code></td>
<td>

<p>The minimum number of principal components to be fit.
</p>
</td></tr>
<tr><td><code id="ppcca.metabol_+3A_maxq">maxq</code></td>
<td>

<p>The maximum number of principal components to be fit.
</p>
</td></tr>
<tr><td><code id="ppcca.metabol_+3A_scale">scale</code></td>
<td>

<p>Type of scaling of the data which is required. The default is &quot;none&quot;. Options include &quot;pareto' and &quot;unit&quot; scaling. See <code><a href="#topic+scaling">scaling</a></code> for further details.
</p>
</td></tr>
<tr><td><code id="ppcca.metabol_+3A_epsilon">epsilon</code></td>
<td>

<p>Value on which the convergence assessment criterion is based. Set by default to 0.1.
</p>
</td></tr>
<tr><td><code id="ppcca.metabol_+3A_plot.bic">plot.BIC</code></td>
<td>

<p>Logical indicating whether or not a plot of the BIC values for the different models fitted should be provided. By default, the plot is not produced.
</p>
</td></tr>
<tr><td><code id="ppcca.metabol_+3A_printout">printout</code></td>
<td>

<p>Logical indicating whether or not a statement is printed on screen detailing the progress of the algorithm.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits a probabilistic principal components and covariates analysis model to metabolomic spectral data via the EM algorithm. A range of models with different numbers of principal components can be fitted.
</p>
<p>Care should be taken with the form of covariates supplied. All covariates are standardized (to lie in [0,1]) within the ppcca.metabol function for stability reasons. Hence continuous covariates and binary valued categorical covariates are easily handled. For a categorical covariate with V levels, the equivalent V-1 dummy variables representation should be passed as an argument to ppcca.metabol.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>q</code></td>
<td>
<p>The number of principal components in the optimal PPCCA model, selected by the BIC.</p>
</td></tr>
<tr><td><code>sig</code></td>
<td>
<p>The posterior mode estimate of the variance of the error terms.</p>
</td></tr>
<tr><td><code>scores</code></td>
<td>
<p>An N x q matrix of estimates of the latent locations of each observation in the principal subspace.</p>
</td></tr>
<tr><td><code>loadings</code></td>
<td>
<p>The maximum likelihood estimate of the p x q loadings matrix.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>The maximum likelihood estimates of the regression coefficients associated with the covariates in the PPCCA model.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>A vector containing the BIC values for the fitted models.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>A vector containing the AIC values for the fitted models.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan.
</p>


<h3>References</h3>

<p>Nyamundanda G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report, University College Dublin.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ppcca.metabol.jack">ppcca.metabol.jack</a></code>, <code><a href="#topic+ppcca.scores.plot">ppcca.scores.plot</a></code><code><a href="#topic+loadings.plot">loadings.plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(UrineSpectra)
## Not run: 
mdlfit&lt;-ppcca.metabol(UrineSpectra[[1]], UrineSpectra[[2]][,2], minq=2, maxq=2)
loadings.plot(mdlfit)
ppcca.scores.plot(mdlfit, UrineSpectra[[2]][,2], group=UrineSpectra[[2]][,1], covarnames="Weight")

## End(Not run)
</code></pre>

<hr>
<h2 id='ppcca.metabol.jack'>
Fit a probabilistic principal components and covariates analysis model to a metabolomic data set, and assess uncertainty via the jackknife.
</h2><span id='topic+ppcca.metabol.jack'></span>

<h3>Description</h3>

<p>Fit a probabilistic principal components and covariates analysis (PPCCA) model to a metabolomic data set via the EM algorithm, and assess uncertainty in the obtained loadings estimates and the regression coefficients via the jackknife.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppcca.metabol.jack(Y, Covars, minq=1, maxq=2, scale="none", epsilon=0.1, 
conflevel=0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppcca.metabol.jack_+3A_y">Y</code></td>
<td>

<p>An N x p data matrix in which each row is a spectrum.
</p>
</td></tr>
<tr><td><code id="ppcca.metabol.jack_+3A_covars">Covars</code></td>
<td>

<p>An N x L covariate data matrix where each row is a set of covariates.
</p>
</td></tr>
<tr><td><code id="ppcca.metabol.jack_+3A_minq">minq</code></td>
<td>

<p>The minimum number of principal components to be fit. By default minq is 1.
</p>
</td></tr>
<tr><td><code id="ppcca.metabol.jack_+3A_maxq">maxq</code></td>
<td>

<p>The maximum number of principal components to be fit. By default maxq is 2.
</p>
</td></tr>
<tr><td><code id="ppcca.metabol.jack_+3A_scale">scale</code></td>
<td>

<p>Type of scaling of the data which is required. The default is &quot;none&quot;. Options include &quot;pareto' and &quot;unit&quot; scaling. See <code><a href="#topic+scaling">scaling</a></code> for further details.
</p>
</td></tr>
<tr><td><code id="ppcca.metabol.jack_+3A_epsilon">epsilon</code></td>
<td>

<p>Value on which the convergence assessment criterion is based. Set by default to 0.1.
</p>
</td></tr>
<tr><td><code id="ppcca.metabol.jack_+3A_conflevel">conflevel</code></td>
<td>

<p>Level of confidence required for the loadings and regression coefficients confidence intervals. By default 95<code class="reqn">\%</code> confidence intervals are computed.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A (range of) PPCCA model(s) are fitted and an optimal model (i.e. number of principal components, q) is selected. Confidence intervals for the obtained loadings and regression coefficients are then obtained via the jackknife i.e. a model with q principal components is fitted to the data <code class="reqn">N</code> times, where an observation is removed from the dataset each time. 
</p>
<p>Care should be taken with the form of covariates supplied. All covariates are standardized (to lie in [0,1]) within the ppcca.metabol.jack function for stability reasons. Hence continuous covariates and binary valued categorical covariates are easily handled. For a categorical covariate with V levels, the equivalent V-1 dummy variables representation should be passed as an argument to ppcca.metabol.jack.
</p>
<p>On convergence of the algorithm, the number of loadings significantly different from zero is printed on screen. The user may then further examine the significant loadings when prompted by selecting a cutoff value from the table printed on screen. Bar plots detailing the resulting significantly high loadings are provided.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>q</code></td>
<td>
<p>The number of principal components in the optimal PPCCA model, selected by the BIC.</p>
</td></tr>
<tr><td><code>sig</code></td>
<td>
<p>The posterior mode estimate of the variance of the error terms.</p>
</td></tr>
<tr><td><code>scores</code></td>
<td>
<p>An N x q matrix of estimates of the latent locations of each observation in the principal subspace.</p>
</td></tr>
<tr><td><code>loadings</code></td>
<td>
<p>The maximum likelihood estimate of the p x q loadings matrix.</p>
</td></tr>
<tr><td><code>SignifW</code></td>
<td>
<p>The maximum likelihood estimate of the loadings matrix for those loadings significantly different from zero.</p>
</td></tr>
<tr><td><code>SignifHighW</code></td>
<td>
<p>The maximum likelihood estimate of the loadings matrix for those loadings significantly different from zero and above the user selected cutoff point.</p>
</td></tr>
<tr><td><code>LowerCI_W</code></td>
<td>
<p>The lower limit of the confidence interval for those loadings significantly different from zero.</p>
</td></tr>
<tr><td><code>UpperCI_W</code></td>
<td>
<p>The upper limit of the confidence interval for those loadings significantly different from zero.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>The maximum likelihood estimates of the regression coefficients.</p>
</td></tr>
<tr><td><code>coeffCI</code></td>
<td>
<p>A matrix detailing the upper and lower limits of the confidence intervals for the regression parameters.</p>
</td></tr>
<tr><td><code>Cutoffs</code></td>
<td>
<p>A table detailing a range of cutoff points and the associated number of selected spectral bins.</p>
</td></tr>
<tr><td><code>number</code></td>
<td>
<p>The number of spectral bins selected by the user.</p>
</td></tr>
<tr><td><code>cutoff</code></td>
<td>
<p>The cutoff value selected by the user.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>A vector containing the BIC values for the fitted models.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>A vector containing the AIC values for the fitted models.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan.
</p>


<h3>References</h3>

<p>Nyamundanda G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report, University College Dublin.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ppcca.metabol">ppcca.metabol</a></code>, <code><a href="#topic+ppcca.scores.plot">ppcca.scores.plot</a></code>,<code><a href="#topic+loadings.jack.plot">loadings.jack.plot</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(UrineSpectra)
## Not run: 
mdlfit&lt;-ppcca.metabol.jack(UrineSpectra[[1]], UrineSpectra[[2]][,2], minq=2, maxq=2)
loadings.jack.plot(mdlfit)
ppcca.scores.plot(mdlfit, UrineSpectra[[2]][,2], group=UrineSpectra[[2]][,1], covarnames="Weight")

## End(Not run)
</code></pre>

<hr>
<h2 id='ppcca.scores.plot'>
Plot scores from a fitted PPCCA model.
</h2><span id='topic+ppcca.scores.plot'></span>

<h3>Description</h3>

<p>A function to plot the scores resulting from fitting a PPCCA model to metabolomic data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppcca.scores.plot(output, Covars, group = FALSE, covarnames=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppcca.scores.plot_+3A_output">output</code></td>
<td>

<p>An object resulting from fitting a PPCCA model.
</p>
</td></tr>
<tr><td><code id="ppcca.scores.plot_+3A_covars">Covars</code></td>
<td>

<p>An N x L covariate data matrix where each row is a set of covariates.
</p>
</td></tr>
<tr><td><code id="ppcca.scores.plot_+3A_group">group</code></td>
<td>

<p>Should it be relevant, a vector indicating the known treatment group membership of each observation.
</p>
</td></tr>
<tr><td><code id="ppcca.scores.plot_+3A_covarnames">covarnames</code></td>
<td>

<p>Should it be relevant, a vector string indicating the names of the covariates.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces a series of scatterplots each illustrating the estimated score for each observation within the reduced q dimensional space. The uncertainty associated with the score estimate is also illustrated through its 95
</p>
<p>It is often the case that observations are known to belong to treatment groups; the treatment group membership of each observation can be illustrated on the plots produced by utilizing the &lsquo;group&rsquo; argument.
</p>


<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan
</p>


<h3>References</h3>

<p>Nyamundanda, G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report. University College Dublin, Ireland.</p>


<h3>See Also</h3>

<p><code><a href="#topic+ppcca.metabol">ppcca.metabol</a></code>, <code><a href="#topic+ppcca.metabol.jack">ppcca.metabol.jack</a></code>
</p>

<hr>
<h2 id='scaling'>
Function to scale metabolomic spectral data.
</h2><span id='topic+scaling'></span>

<h3>Description</h3>

<p>This function provides the options of Pareto scaling, unit scaling or no scaling of metabolomic data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scaling(Y, type = "none")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scaling_+3A_y">Y</code></td>
<td>

<p>An N x p matrix of metabolomic spectra. Each row of Y is an observation's spectrum.
</p>
</td></tr>
<tr><td><code id="scaling_+3A_type">type</code></td>
<td>

<p>Default is &quot;none&quot; meaning the data are not altered. If &quot;pareto&quot;, the data are Pareto scaled. If &quot;unit&quot;, the data are unit scaled.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Pareto scaling, frequently utilised in metabolomic analyses, scales data by dividing each variable by the square root of the standard deviation. Unit scaling divides each variable by the standard deviation so that each variable has variance equal to 1.
</p>


<h3>Value</h3>

<p>The function returns the requested scaled version of the input matrix <code class="reqn">Y</code>.
</p>


<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan.
</p>


<h3>References</h3>

<p>van den Berg, R.A., Hoefsloot, H.C.J, Westerhuis, J.A. and Smilde, A.K. and van der Werf, M.J. (2006) Centering, scaling, and transformations: improving the biological information content of metabolomics data. <em>BMC Genomics</em>, 7, 1, 142.
</p>
<p>Nyamundanda G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report, University College Dublin.
</p>

<hr>
<h2 id='standardize'>
Function to scale covariates.
</h2><span id='topic+standardize'></span>

<h3>Description</h3>

<p>A function to scale covariates so that they lie in [0,1] for reasons of stability and convergence of the EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>standardize(Covars)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="standardize_+3A_covars">Covars</code></td>
<td>

<p>An N x L matrix containing the L covariates of each of N observations.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A function to scale covariates so that they lie in [0,1] for reasons of stability and convergence of the EM algorithm. Care must be taken with categorical covariates: see <code><a href="#topic+ppcca.metabol">ppcca.metabol</a></code> for further information.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Covars</code></td>
<td>
<p>A standardized version of the input matrix of covariates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nyamundanda Gift, Isobel Claire Gormley and Lorraine Brennan
</p>

<hr>
<h2 id='UrineSpectra'>
NMR metabolomic spectra from urine samples of 18 mice.
</h2><span id='topic+UrineSpectra'></span>

<h3>Description</h3>

<p>NMR metabolomic spectra from urine samples of 18 mice, each belonging to one of two treatment groups. Each spectrum has 189 spectral bins, measured in parts per million (ppm).
</p>
<p>Covariates associated with the mice were also recorded: the weight of each mouse is provided. </p>


<h3>Usage</h3>

<pre><code class='language-R'>data(UrineSpectra)</code></pre>


<h3>Format</h3>

<p>A list containing
</p>

<ol>
<li><p> a matrix with 18 rows and 189 columns
</p>
</li>
<li><p> a data frame with 18 observations on 2 variables:
</p>

<ul>
<li><p> Treatment group membership of each animal.
</p>
</li>
<li><p> Weight (in grammes) of each animal.       
</p>
</li></ul>

</li></ol>



<h3>Details</h3>

<p>This is simulated data, based on parameter estimates from a PPCA model with two prinicipal components fitted to a similar real data set.
</p>


<h3>Source</h3>

<p>Nyamundanda, G., Gormley, I.C. and Brennan, L. (2010) Probabilistic principal components analysis for metabolomic data. Technical report. University College Dublin, Ireland.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
