<!DOCTYPE html><html><head><title>Help for package ssmrob</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ssmrob}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ssmrob-package'>
<p>Robust Estimation and Inference in Sample Selection Models</p></a></li>
<li><a href='#coef.etregrob'>
<p>Extract Coefficients from Robust Endogenous Treatment Model Fit</p></a></li>
<li><a href='#coef.heckit5rob'>
<p>Extract Coefficients from Robust Sample Selection Model Fit</p></a></li>
<li><a href='#coef.heckitrob'>
<p>Extract Coefficients from Robust Sample Selection Model Fit</p></a></li>
<li><a href='#dLambdadSM'>
<p>Inverse Mills Ratio Derivative</p></a></li>
<li><a href='#dLambdadSM5'>
<p>Inverse Mills Ratio Derivative</p></a></li>
<li><a href='#etreg2steprobVcov'>
<p>Variance Covariance Matrix</p></a></li>
<li><a href='#etregrob'>
<p>Robust Fit of Endogenous Treatment Model</p></a></li>
<li><a href='#fitted.etregrob'>
<p>Fitted values of endogenous treatment model</p></a></li>
<li><a href='#fitted.heckit5rob'>
<p>Fitted values of robust sample selection model</p></a></li>
<li><a href='#fitted.heckitrob'>
<p>Fitted values of robust sample selection model</p></a></li>
<li><a href='#heck2steprobVcov'>
<p>Variance Covariance Matrix</p></a></li>
<li><a href='#heck5twosteprobVcov'>
<p>Variance Covariance Matrix</p></a></li>
<li><a href='#heckit5rob'>
<p>Robust Heckit Fit: Switching Regressions</p></a></li>
<li><a href='#heckitrob'>
<p>Robust Heckit Fit</p></a></li>
<li><a href='#heckitrob.control'>
<p>Auxiliary for Controlling Robust Fitting</p></a></li>
<li><a href='#MEPS2001'>
<p>Ambulatory Expenditures Data</p></a></li>
<li><a href='#MmatrM'>
<p>M Matrix</p></a></li>
<li><a href='#model.matrix.etregrob'>
<p>Design Matrix of Endogenous Treatment Model</p></a></li>
<li><a href='#model.matrix.heckit5rob'>
<p>Design Matrix of Switching Regression Model</p></a></li>
<li><a href='#model.matrix.heckitrob'>
<p>Design Matrix of Sample Selection Model</p></a></li>
<li><a href='#MROZ.RAW'>
<p>Wage Offer Data</p></a></li>
<li><a href='#nobs.heckitrob'>
<p>Number of Observations</p></a></li>
<li><a href='#print.etregrob'>
<p>Print a <code>etregrob</code> Object</p></a></li>
<li><a href='#print.heckit5rob'>
<p>Print a <code>heckit5rob</code> Object</p></a></li>
<li><a href='#print.heckitrob'>
<p>Print a <code>heckitrob</code> Object</p></a></li>
<li><a href='#print.summary.etregrob'>
<p>Print Function for <code>summary.etregrob</code></p></a></li>
<li><a href='#print.summary.heckit5rob'>
<p>Print Function for <code>summary.heckit5rob</code></p></a></li>
<li><a href='#print.summary.heckitrob'>
<p>Print Function for <code>summary.heckitrob</code></p></a></li>
<li><a href='#PsiMest'>
<p>Score Function of the Mallows M-Estimator</p></a></li>
<li><a href='#residuals.etregrob'>
<p>Residuals of Robust Endogenous Treatment Model Fit</p></a></li>
<li><a href='#residuals.heckit5rob'>
<p>Residuals of Robust Sample Selection Model Fit</p></a></li>
<li><a href='#residuals.heckitrob'>
<p>Residuals of Robust Sample Selection Model Fit</p></a></li>
<li><a href='#ssmrob'>
<p>Robust Sample Selection Model</p></a></li>
<li><a href='#summary.etregrob'>
<p>Summarizing Robust Fits of Endogenous Treatment Models</p></a></li>
<li><a href='#summary.heckit5rob'>
<p>Summarizing Robust Fits of Sample Selection Models</p></a></li>
<li><a href='#summary.heckitrob'>
<p>Summarizing Robust Fits of Sample Selection Models</p></a></li>
<li><a href='#vcov.etregrob'>
<p>Extract Asymptotic Variance Covariance Matrix</p></a></li>
<li><a href='#vcov.heckit5rob'>
<p>Extract Asymptotic Variance Covariance Matrix</p></a></li>
<li><a href='#vcov.heckitrob'>
<p>Extract Asymptotic Variance Covariance Matrix</p></a></li>
<li><a href='#x2weight.covMcd'>
<p>Robustness Weights</p></a></li>
<li><a href='#x2weight.robCov'>
<p>Robustness Weights</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Estimation and Inference in Sample Selection Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-08-18</td>
</tr>
<tr>
<td>Author:</td>
<td>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mikhail Zhelonkin &lt;Mikhail.Zhelonkin@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Package provides a set of tools for robust estimation and inference for models with sample selectivity and endogenous treatment model. For details, see Zhelonkin and Ronchetti (2021) &lt;<a href="https://doi.org/10.18637%2Fjss.v099.i04">doi:10.18637/jss.v099.i04</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>sampleSelection, robustbase, MASS</td>
</tr>
<tr>
<td>Suggests:</td>
<td>mvtnorm</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-08-20 11:29:29 UTC; M.Zhelonkin</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-08-20 15:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='ssmrob-package'>
Robust Estimation and Inference in Sample Selection Models
</h2><span id='topic+ssmrob-package'></span>

<h3>Description</h3>

<p>Package provides a set of tools for robust estimation and inference for
models with sample selectivity and endogenous treatment model.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> ssmrob </td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package </td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0 </td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2021-08-18 </td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>
<p>Maintainer: Mikhail Zhelonkin &lt;Mikhail.Zhelonkin@gmail.com&gt;
</p>


<h3>References</h3>

<p>Heckman, J.J. (1979) Sample Selection Bias as a Specification Error. <em>Econometrica</em>, 47, p. 153-161.
</p>
<p>Zhelonkin, M., Genton M.G., and Ronchetti, E. (2016) Robust Inference in Sample Selection Models. <em>Journal of the Royal Statistical Society, Series B</em>, 78, p. 805-827. doi: <a href="https://doi.org/10.1111/rssb.12136">10.1111/rssb.12136</a>
</p>
<p>Zhelonkin, M., Ronchetti, E. (2021) Robust Analysis of Sample Selection Models through the R Package ssmrob. <em>Journal of Statistical Software</em>, 99, 4, p. 1-35. doi: <a href="https://doi.org/10.18637/jss.v099.i04">10.18637/jss.v099.i04</a> 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ssmrob">ssmrob</a></code>, <code><a href="#topic+etregrob">etregrob</a></code>, <code><a href="#topic+heckitrob">heckitrob</a></code>, <code><a href="#topic+heckit5rob">heckit5rob</a></code>, <code><a href="sampleSelection.html#topic+selection">selection</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Zhelonkin, Genton, Ronchetti (2016): page 823
data(MEPS2001)
selectEq &lt;- dambexp ~ age + female + educ + blhisp + totchr + ins
outcomeEq &lt;- lnambx ~ age + female + educ + blhisp + totchr + ins
meps.fit &lt;- ssmrob(selectEq, outcomeEq, data = MEPS2001, control = heckitrob.control(tcc = 3.2))
summary(meps.fit)
</code></pre>

<hr>
<h2 id='coef.etregrob'>
Extract Coefficients from Robust Endogenous Treatment Model Fit
</h2><span id='topic+coef.etregrob'></span>

<h3>Description</h3>

<p>Returns the coefficients of the robust two-stage estimator for endogentous treatment model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'etregrob'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.etregrob_+3A_object">object</code></td>
<td>

<p>object of class &quot;<code><a href="#topic+etregrob">etregrob</a></code>&quot;
</p>
</td></tr>
<tr><td><code id="coef.etregrob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of two vectors of parameters of two stages.
</p>
<table>
<tr><td><code>S</code></td>
<td>
<p>coefficients of the selection equation.</p>
</td></tr>
<tr><td><code>O</code></td>
<td>
<p>coefficients of the outcome equation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin
</p>

<hr>
<h2 id='coef.heckit5rob'>
Extract Coefficients from Robust Sample Selection Model Fit
</h2><span id='topic+coef.heckit5rob'></span>

<h3>Description</h3>

<p>Returns the coefficients of the robust two-stage estimator for simple Heckman's selection model or switching regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckit5rob'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.heckit5rob_+3A_object">object</code></td>
<td>

<p>object of class &quot;<code><a href="#topic+heckitrob">heckitrob</a></code>&quot; or &quot;<code><a href="#topic+heckit5rob">heckit5rob</a></code>&quot;
</p>
</td></tr>
<tr><td><code id="coef.heckit5rob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of two (censored) or three (switching) vectors of parameters of two stages.
</p>
<table>
<tr><td><code>S</code></td>
<td>
<p>coefficients of the selection equation.</p>
</td></tr>
<tr><td><code>O</code></td>
<td>
<p>coefficients of the outcome equation(s).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>

<hr>
<h2 id='coef.heckitrob'>
Extract Coefficients from Robust Sample Selection Model Fit
</h2><span id='topic+coef.heckitrob'></span>

<h3>Description</h3>

<p>Returns the coefficients of the robust two-stage estimator for simple Heckman's selection model or switching regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckitrob'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.heckitrob_+3A_object">object</code></td>
<td>

<p>object of class &quot;<code><a href="#topic+heckitrob">heckitrob</a></code>&quot; or &quot;<code><a href="#topic+heckit5rob">heckit5rob</a></code>&quot;
</p>
</td></tr>
<tr><td><code id="coef.heckitrob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of two (censored) or three (switching) vectors of parameters of two stages.
</p>
<table>
<tr><td><code>S</code></td>
<td>
<p>coefficients of the selection equation.</p>
</td></tr>
<tr><td><code>O</code></td>
<td>
<p>coefficients of the outcome equation(s).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>

<hr>
<h2 id='dLambdadSM'>
Inverse Mills Ratio Derivative
</h2><span id='topic+dLambdadSM'></span>

<h3>Description</h3>

<p>Computes a derivative of the inverse Mills ratio with respect to the parameter vector. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dLambdadSM(x, beta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dLambdadSM_+3A_x">x</code></td>
<td>

<p>vector of exogenous variables
</p>
</td></tr>
<tr><td><code id="dLambdadSM_+3A_beta">beta</code></td>
<td>

<p>vector of parameters
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is necessary for computation of the asymptotic variance. In case of switching regressions the inverse Mills ratio term is different, and its derivative is computed in function <code>dLambdadSM5</code>. It can be also used to compute the influence function of the two-stage estimator.
</p>


<h3>Value</h3>

<p>The gradient of the inverse Mills ratio is returned as a vector
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>


<h3>References</h3>

<p>Zhelonkin, M., Genton M.G., and Ronchetti, E. (2016) Robust Inference in Sample Selection Models. <em>Journal of the Royal Statistical Society, Series B</em>, 78, p. 805-827.
</p>

<hr>
<h2 id='dLambdadSM5'>
Inverse Mills Ratio Derivative
</h2><span id='topic+dLambdadSM5'></span>

<h3>Description</h3>

<p>Computes a derivative of the inverse Mills ratio with respect to the parameter vector. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dLambdadSM5(x, beta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dLambdadSM5_+3A_x">x</code></td>
<td>

<p>vector of exogenous variables
</p>
</td></tr>
<tr><td><code id="dLambdadSM5_+3A_beta">beta</code></td>
<td>

<p>vector of parameters
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is necessary for computation of the asymptotic variance. In case of switching regressions the inverse Mills ratio term is different, and its derivative is computed in function <code>dLambdadSM5</code>. It can also be used to compute the influence function of the two-stage estimator.
</p>


<h3>Value</h3>

<p>The gradient of the inverse Mills ratio is returned as a vector
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>


<h3>References</h3>

<p>Zhelonkin, M., Genton M.G., and Ronchetti, E. (2016) Robust Inference in Sample Selection Models. <em>Journal of the Royal Statistical Society, Series B</em>, 78, p. 805-827.
</p>

<hr>
<h2 id='etreg2steprobVcov'>
Variance Covariance Matrix
</h2><span id='topic+etreg2steprobVcov'></span>

<h3>Description</h3>

<p>Computation of the asymptotic variance matrix of the robust Heckman's two-stage estimator for endogenous treatment model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>etreg2steprobVcov(y1vec, y2vec, x1Matr, x2Matr, eststage1, eststage2, eststage2sigma, 
				  weights = rep(1, nrow(y1vec)), t.c = 1.345)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="etreg2steprobVcov_+3A_y1vec">y1vec</code></td>
<td>

<p>vector of endogenous variables of the selection stage
</p>
</td></tr>
<tr><td><code id="etreg2steprobVcov_+3A_y2vec">y2vec</code></td>
<td>

<p>vector of endogenous variables of the outcome stage
</p>
</td></tr>
<tr><td><code id="etreg2steprobVcov_+3A_x1matr">x1Matr</code></td>
<td>

<p>matrix of exogenous variables of the selection stage
</p>
</td></tr>
<tr><td><code id="etreg2steprobVcov_+3A_x2matr">x2Matr</code></td>
<td>

<p>matrix of exogenous variables of the outcome stage
</p>
</td></tr>
<tr><td><code id="etreg2steprobVcov_+3A_eststage1">eststage1</code></td>
<td>

<p>object of class &quot;<code>glmrob</code>&quot;, corresponding to the robust probit fit
</p>
</td></tr>
<tr><td><code id="etreg2steprobVcov_+3A_eststage2">eststage2</code></td>
<td>

<p>vector of the coefficients of the outcome stage
</p>
</td></tr>
<tr><td><code id="etreg2steprobVcov_+3A_eststage2sigma">eststage2sigma</code></td>
<td>

<p>the robust scale estimate of the second stage regression
</p>
</td></tr>
<tr><td><code id="etreg2steprobVcov_+3A_weights">weights</code></td>
<td>

<p>robustness weights 
</p>
</td></tr>
<tr><td><code id="etreg2steprobVcov_+3A_t.c">t.c</code></td>
<td>

<p>tuning constant of the second stage
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The computation is made using the Huber (1967) - White (1980) sandwich estimator.  In the computation of leverage weights the lambda's are assumed to be fixed.
</p>


<h3>Value</h3>

<p>Variance covariance matrix of the second stage estimator
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin
</p>


<h3>References</h3>

<p>Huber, P.J. (1967) The Behavior of Maximum Likelihood Estimates under Nonstandard Conditions. <em> Proceedings of the Fifth Berkeley Symposium on Mathematical Statistics and Probability; L.M. LeCam, J. Neyman (Eds.), Berkeley: University of California Press</em>, p. 221-233.
</p>
<p>White, H.J. (1980) A Heteroskedasticity-Consistent Covariance Matrix Estimator and a Direct Test for Heteroskedasticity. <em>Econometrica</em>, 48, p. 817-838.
</p>

<hr>
<h2 id='etregrob'>
Robust Fit of Endogenous Treatment Model
</h2><span id='topic+etregrob'></span>

<h3>Description</h3>

<p>Fits the endogenous treatment model using a robust two-stage estimator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>etregrob(selection, outcome, data, control = heckitrob.control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="etregrob_+3A_selection">selection</code></td>
<td>

<p>formula, the selection equation
</p>
</td></tr>
<tr><td><code id="etregrob_+3A_outcome">outcome</code></td>
<td>

<p>formula, the outcome equation
</p>
</td></tr>
<tr><td><code id="etregrob_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the variables in the model. If not found in data, the variables are taken from <code>environment(formula)</code>, typically the environment from which <code>etregrob</code> is called.
</p>
</td></tr>
<tr><td><code id="etregrob_+3A_control">control</code></td>
<td>

<p>a list of parameters for controlling the fitting process. The same list as for sample selection model
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Compute robust two-step estimates of the Endogenous Treatment Model. The robust probit is fitted in the first stage. In the second stage the Mallows type M-estimator is used instead of traditional OLS. The correction for endogeneity is made by means of control function, which is the inverse Mills ratio for a complete sample (see Maddala, 1983, p. 120-122).
The values of the tuning constants and the robustness weights can be modified in <code><a href="#topic+heckitrob.control">heckitrob.control</a></code>.
</p>


<h3>Value</h3>

<p>Object of class &quot;etregrob&quot;.
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients</p>
</td></tr>
<tr><td><code>stage1</code></td>
<td>
<p>object of class <code>glmrob</code> that contains robust probit fit</p>
</td></tr>
<tr><td><code>stage2</code></td>
<td>
<p>object of class <code>rlm</code> that contains second stage robust fit. Note that the standard errors in this object are biased, since they are not corrected for the uncertainty in the first estimation step. Use <code>vcov</code> below</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>variance matrix of the second stage</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>the standard error of the error term of the outcome equation</p>
</td></tr>
<tr><td><code>CIMR</code></td>
<td>
<p>inverse Mills ratio for the complete sample</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>method of estimation, currently only &quot;robust two-stage&quot; is implemented</p>
</td></tr>
<tr><td><code>converged</code></td>
<td>
<p>logical. Did all the estimators converge?</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>list containing the numbers of iterations</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The treatment variable is automatically included in the formula for the second estimation step, i.e. one should not add the dependent variable from the selection equation in the formula of the outcome equation.
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin
</p>


<h3>References</h3>

<p>Maddala G.S. (1983) Limited-Dependent and Qualitative Variables in Econometrics. Cambridge: Cambridge University Press.
</p>
<p>Zhelonkin, M., Ronchetti, E. (2021) Robust Analysis of Sample Selection Models through the R Package ssmrob. <em>Journal of Statistical Software</em>, 99, 4, p. 1-35. doi: <a href="https://doi.org/10.18637/jss.v099.i04">10.18637/jss.v099.i04</a>
</p>


<h3>See Also</h3>

<p><code><a href="robustbase.html#topic+glmrob">glmrob</a></code>, <code><a href="MASS.html#topic+rlm">rlm</a></code>, <code><a href="#topic+ssmrob">ssmrob</a></code>, <code><a href="#topic+heckitrob.control">heckitrob.control</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(mvtnorm)
set.seed(2)
N &lt;- 3000
beta1 &lt;- c(1.0, 1.0, 0.75)
beta2 &lt;- c(1.5, 1.0, 0.5)
alpha &lt;- 1.25
x1 &lt;- rmvnorm(N, mean = c(0, -1, 1), sigma = diag(c(1, 0.5, 1)))
x2 &lt;- x1 
x2[, 3] &lt;- rnorm(N, 1, 1)
eps &lt;- rmvnorm(N, mean = rep(0, 2), sigma = matrix(c(1, -0.7, -0.7, 1), 2, 2))
x1beta1 &lt;- x1[, 1]*beta1[1] + x1[, 2]*beta1[2] + x1[, 3]*beta1[3]
x2beta2 &lt;- x2[, 1]*beta2[1] + x2[, 2]*beta2[2] + x2[, 3]*beta2[3]
y1 &lt;- ifelse(x1beta1 + eps[, 1] &gt; 0, 1, 0)
y2 &lt;- x2beta2 + alpha*y1 + eps[,2]
etm.ctrl &lt;- heckitrob.control(weights.x1 = "hat", weights.x2 = "covMcd")
etmsim.fit &lt;- etregrob(y1 ~ x1, y2 ~ x2, control = etm.ctrl)
summary(etmsim.fit)
</code></pre>

<hr>
<h2 id='fitted.etregrob'>
Fitted values of endogenous treatment model
</h2><span id='topic+fitted.etregrob'></span>

<h3>Description</h3>

<p>Calculate the fitted values of the endogenous treatment model using robust fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'etregrob'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.etregrob_+3A_object">object</code></td>
<td>

<p>object of class &quot;<code><a href="#topic+etregrob">etregrob</a></code>&quot;
</p>
</td></tr>
<tr><td><code id="fitted.etregrob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of fitted values 
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin
</p>

<hr>
<h2 id='fitted.heckit5rob'>
Fitted values of robust sample selection model
</h2><span id='topic+fitted.heckit5rob'></span>

<h3>Description</h3>

<p>Calculate the fitted values of the sample selection model using robust fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckit5rob'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.heckit5rob_+3A_object">object</code></td>
<td>

<p>object of class &quot;<code><a href="#topic+heckitrob">heckitrob</a></code>&quot; or object of class &quot;<code><a href="#topic+heckit5rob">heckit5rob</a></code>&quot;
</p>
</td></tr>
<tr><td><code id="fitted.heckit5rob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In case of truncated selection model one vector of fitted values is returned. In case of switching regression model a list, that contains two vectors corresponding to two regimes, is returned.
</p>


<h3>Value</h3>

<p>vector of fitted values or a list that contains two vectors of fitted values
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>

<hr>
<h2 id='fitted.heckitrob'>
Fitted values of robust sample selection model
</h2><span id='topic+fitted.heckitrob'></span>

<h3>Description</h3>

<p>Calculate the fitted values of the sample selection model using robust fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckitrob'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.heckitrob_+3A_object">object</code></td>
<td>

<p>object of class &quot;<code><a href="#topic+heckitrob">heckitrob</a></code>&quot; or object of class &quot;<code><a href="#topic+heckit5rob">heckit5rob</a></code>&quot;
</p>
</td></tr>
<tr><td><code id="fitted.heckitrob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In case of truncated selection model one vector of fitted values is returned. In case of switching regression model a list, that contains two vectors corresponding to two regimes, is returned.
</p>


<h3>Value</h3>

<p>vector of fitted values or a list that contains two vectors of fitted values
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>

<hr>
<h2 id='heck2steprobVcov'>
Variance Covariance Matrix
</h2><span id='topic+heck2steprobVcov'></span>

<h3>Description</h3>

<p>Computation of the asymptotic variance matrix of the robust Heckman's two-stage estimator for truncated selection model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heck2steprobVcov(y1vec, y2vec, x1Matr, x2Matr, eststage1, eststage2, 
                 eststage2sigma, weights = rep(1,nrow(y1vec)), t.c = 1.345)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="heck2steprobVcov_+3A_y1vec">y1vec</code></td>
<td>

<p>vector of endogenous variables of the selection stage
</p>
</td></tr>
<tr><td><code id="heck2steprobVcov_+3A_y2vec">y2vec</code></td>
<td>

<p>vector of endogenous variables of the outcome stage
</p>
</td></tr>
<tr><td><code id="heck2steprobVcov_+3A_x1matr">x1Matr</code></td>
<td>

<p>matrix of exogenous variables of the selection stage
</p>
</td></tr>
<tr><td><code id="heck2steprobVcov_+3A_x2matr">x2Matr</code></td>
<td>

<p>matrix of exogenous variables of the outcome stage
</p>
</td></tr>
<tr><td><code id="heck2steprobVcov_+3A_eststage1">eststage1</code></td>
<td>

<p>object of class &quot;<code>glmrob</code>&quot;, corresponding to the robust probit fit
</p>
</td></tr>
<tr><td><code id="heck2steprobVcov_+3A_eststage2">eststage2</code></td>
<td>

<p>vector of the coefficients of the outcome stage
</p>
</td></tr>
<tr><td><code id="heck2steprobVcov_+3A_eststage2sigma">eststage2sigma</code></td>
<td>

<p>the robust scale estimate of the second stage regression
</p>
</td></tr>
<tr><td><code id="heck2steprobVcov_+3A_weights">weights</code></td>
<td>

<p>vector of robustness weights 
</p>
</td></tr>
<tr><td><code id="heck2steprobVcov_+3A_t.c">t.c</code></td>
<td>

<p>tuning constant of the second stage
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The computation is made using the Huber (1967) - White (1980) sandwich estimator with Heckman (1979) correction. In the computation of leverage weights the lambda's are assumed to be fixed.
</p>


<h3>Value</h3>

<p>Variance covariance matrix of the second stage estimator
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>


<h3>References</h3>

<p>Heckman, J.J. (1979) Sample Selection Bias as a Specification Error. <em>Econometrica</em>, 47, p. 153-161.
</p>
<p>Huber, P.J. (1967) The Behavior of Maximum Likelihood Estimates under Nonstandard Conditions. <em> Proceedings of the Fifth Berkeley Symposium on Mathematical Statistics and Probability; L.M. LeCam, J. Neyman (Eds.), Berkeley: University of California Press</em>, p. 221-233.
</p>
<p>White, H.J. (1980) A Heteroskedasticity-Consistent Covariance Matrix Estimator and a Direct Test for Heteroskedasticity. <em>Econometrica</em>, 48, p. 817-838.
</p>


<h3>See Also</h3>

<p><code><a href="robustbase.html#topic+glmrob">glmrob</a></code>
</p>

<hr>
<h2 id='heck5twosteprobVcov'>
Variance Covariance Matrix
</h2><span id='topic+heck5twosteprobVcov'></span>

<h3>Description</h3>

<p>Computation of the asymptotic variance matrix of the robust Heckman's two-stage estimator for the second regime of switching regression model, i.e. when <code class="reqn">y_1=0</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heck5twosteprobVcov(y1vec, y2vec, x1Matr, x2Matr, eststage1, eststage2, 
                    eststage2sigma, weights = rep(1,nrow(y1vec)), t.c = 1.345)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="heck5twosteprobVcov_+3A_y1vec">y1vec</code></td>
<td>

<p>vector of endogenous variables of the selection stage
</p>
</td></tr>
<tr><td><code id="heck5twosteprobVcov_+3A_y2vec">y2vec</code></td>
<td>

<p>vector of endogenous variables of the outcome stage
</p>
</td></tr>
<tr><td><code id="heck5twosteprobVcov_+3A_x1matr">x1Matr</code></td>
<td>

<p>matrix of exogenous variables of the selection stage
</p>
</td></tr>
<tr><td><code id="heck5twosteprobVcov_+3A_x2matr">x2Matr</code></td>
<td>

<p>matrix of exogenous variables of the outcome stage
</p>
</td></tr>
<tr><td><code id="heck5twosteprobVcov_+3A_eststage1">eststage1</code></td>
<td>

<p>object of class &quot;<code>glmrob</code>&quot;, corresponding to the robust probit fit
</p>
</td></tr>
<tr><td><code id="heck5twosteprobVcov_+3A_eststage2">eststage2</code></td>
<td>

<p>vector of the coefficients of the outcome stage
</p>
</td></tr>
<tr><td><code id="heck5twosteprobVcov_+3A_eststage2sigma">eststage2sigma</code></td>
<td>

<p>the robust scale estimate of the second stage regression
</p>
</td></tr>
<tr><td><code id="heck5twosteprobVcov_+3A_weights">weights</code></td>
<td>

<p>vector of robustness weights 
</p>
</td></tr>
<tr><td><code id="heck5twosteprobVcov_+3A_t.c">t.c</code></td>
<td>

<p>tuning constant of the second stage
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The computation is made using the Huber (1967) - White (1980) sandwich estimator with Heckman (1979) correction. In the computation of leverage weights the <code class="reqn">\lambda</code>'s are assumed to be fixed.
</p>


<h3>Value</h3>

<p>Variance covariance matrix of the second stage estimator
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>


<h3>References</h3>

<p>Amemiya, T. (1984) Tobit Models: a Survey. <em>Journal of Econometrics</em>, 24, p. 3-61.
</p>
<p>Heckman, J.J. (1979) Sample Selection Bias as a Specification Error. <em>Econometrica</em>, 47, p. 153-161.
</p>
<p>Huber, P.J. (1967) The Behavior of Maximum Likelihood Estimates under Nonstandard Conditions. <em> Proceedings of the Fifth Berkeley Symposium on Mathematical Statistics and Probability; L.M. LeCam, J. Neyman (Eds.), Berkeley: University of California Press</em>, p. 221-233.
</p>
<p>White, H.J. (1980) A Heteroskedasticity-Consistent Covariance Matrix Estimator and a Direct Test for Heteroskedasticity. <em>Econometrica</em>, 48, p. 817-838.
</p>

<hr>
<h2 id='heckit5rob'>
Robust Heckit Fit: Switching Regressions
</h2><span id='topic+heckit5rob'></span>

<h3>Description</h3>

<p>Fits the switching regression model with probit selection using a robust two-stage estimator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heckit5rob(selection, outcome1, outcome2, data, control = heckitrob.control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="heckit5rob_+3A_selection">selection</code></td>
<td>

<p>formula, the selection equation
</p>
</td></tr>
<tr><td><code id="heckit5rob_+3A_outcome1">outcome1</code></td>
<td>

<p>formula, first outcome equation
</p>
</td></tr>
<tr><td><code id="heckit5rob_+3A_outcome2">outcome2</code></td>
<td>

<p>formula, second outcome equation
</p>
</td></tr>
<tr><td><code id="heckit5rob_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the variables in the model. If not found in data, the variables are taken from <code>environment(formula)</code>, typically the environment from which <code>heckit5rob</code> is called.
</p>
</td></tr>
<tr><td><code id="heckit5rob_+3A_control">control</code></td>
<td>

<p>a list of parameters for controlling the fitting process
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Compute robust two-stage extimates of the switching regression model with probit selection. The robust probit is fitted in the first stage. In the second stage the Mallows type M-estimators are used.
The values of the tuning constants and the robustness weights can be modified in <code><a href="#topic+heckitrob.control">heckitrob.control</a></code>.
</p>


<h3>Value</h3>

<p>Object of class &quot;heckit5rob&quot;.
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients</p>
</td></tr>
<tr><td><code>stage1</code></td>
<td>
<p>object of class <code>glmrob</code> that contains (first stage) robust probit fit</p>
</td></tr>
<tr><td><code>stage21</code></td>
<td>
<p>object of class <code>rlm</code> that contains second stage first regime robust fit. Note that the standard errors in this object are biased, since they are not corrected for the uncertainty in the first estimation step. Use <code>vcov1</code> below</p>
</td></tr>
<tr><td><code>stage22</code></td>
<td>
<p>object of class <code>rlm</code> that contains second stage second regime robust fit. Note that the standard errors in this object are biased, since they are not corrected for the uncertainty in the first estimation step. Use <code>vcov2</code> below</p>
</td></tr>  
<tr><td><code>vcov1</code></td>
<td>
<p>variance matrix of the second stage first regime</p>
</td></tr>
<tr><td><code>vcov2</code></td>
<td>
<p>variance matrix of the second stage second regime</p>
</td></tr>
<tr><td><code>sigma1</code></td>
<td>
<p>the standard error of the error term of the outcome equation when y_1=1</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>the standard error of the error term of the outcome equation when y_1=0</p>
</td></tr>
<tr><td><code>IMR1</code></td>
<td>
<p>inverse Mills ratio for the case when y_1=1</p>
</td></tr>
<tr><td><code>IMR2</code></td>
<td>
<p>inverse Mills ratio for the case when y_1=0</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>method of estimation, currently only &quot;robust two-stage&quot; is implemented</p>
</td></tr>
<tr><td><code>converged</code></td>
<td>
<p>logical. Did all the estimators converge?</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>list containing the numbers of iterations</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>


<h3>References</h3>

<p>Heckman, J.J. (1979) Sample Selection Bias as a Specification Error. <em>Econometrica</em>, 47, p. 153-161.
</p>
<p>Zhelonkin, M., Genton M.G., and Ronchetti, E. (2016) Robust Inference in Sample Selection Models. <em>Journal of the Royal Statistical Society, Series B</em>, 78, p. 805-827. doi: <a href="https://doi.org/10.1111/rssb.12136">10.1111/rssb.12136</a>
</p>
<p>Zhelonkin, M., Ronchetti, E. (2021) Robust Analysis of Sample Selection Models through the R Package ssmrob. <em>Journal of Statistical Software</em>, 99, 4, p. 1-35. doi: <a href="https://doi.org/10.18637/jss.v099.i04">10.18637/jss.v099.i04</a>
</p>


<h3>See Also</h3>

<p><code><a href="robustbase.html#topic+glmrob">glmrob</a></code>, <code><a href="MASS.html#topic+rlm">rlm</a></code>, <code><a href="#topic+ssmrob">ssmrob</a></code>, <code><a href="#topic+heckitrob">heckitrob</a></code>, <code><a href="#topic+heckitrob.control">heckitrob.control</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(mvtnorm)
set.seed(2)
N &lt;- 5000
beta1 &lt;- c(0, 1.0, 1.0, 0.75)
beta21 &lt;- c(0, 1.5, 1.0, 0.5)
beta22 &lt;- c(1, -1.5, 1.0, 0.5)
covm &lt;- diag(3)
covm[lower.tri(covm)] &lt;- c(0.75, 0.5, 0.25)
covm[upper.tri(covm)] &lt;- covm[lower.tri(covm)]
eps &lt;- rmvnorm(N, rep(0, 3), covm)
x1 &lt;- rmvnorm(N, mean=c(0, -1, 1), sigma=diag(c(1, 0.5, 1)))
x21 &lt;- x1 
x22 &lt;- x1
x21[, 3] &lt;- rnorm(N, 1, 1)
x22[, 3] &lt;- rnorm(N, 1, 1)
x1beta1 &lt;- beta1[1] + x1[, 1]*beta1[2] + x1[, 2]*beta1[3] + x1[, 3]*beta1[4]
x21beta21 &lt;- beta21[1] + x21[, 1]*beta21[2] + x21[, 2]*beta21[3] + x21[, 3]*beta21[4]
x22beta22 &lt;- beta22[1] + x22[, 1]*beta22[2] + x22[, 2]*beta22[3] + x22[, 3]*beta22[4]
y1 &lt;- ifelse(x1beta1 + eps[, 1] &gt; 0, 1, 0)
y2 &lt;- ifelse(y1 &gt; 0.5, x21beta21 + eps[, 2],
x22beta22 + eps[, 3])
srsim.fit &lt;- ssmrob(y1 ~ x1, list(y2 ~ x21, y2 ~ x22), 
control = heckitrob.control(weights.x1 = "hat", weights.x2 = "covMcd"))
summary(srsim.fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='heckitrob'>
Robust Heckit Fit
</h2><span id='topic+heckitrob'></span>

<h3>Description</h3>

<p>Fits the sample selection model using a robust two-stage estimator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heckitrob(selection, outcome, data, control = heckitrob.control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="heckitrob_+3A_selection">selection</code></td>
<td>

<p>formula, the selection equation
</p>
</td></tr>
<tr><td><code id="heckitrob_+3A_outcome">outcome</code></td>
<td>

<p>formula, the outcome equation
</p>
</td></tr>
<tr><td><code id="heckitrob_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the variables in the model. If not found in data, the variables are taken from <code>environment(formula)</code>, typically the environment from which <code>heckitrob</code> is called.
</p>
</td></tr>
<tr><td><code id="heckitrob_+3A_control">control</code></td>
<td>

<p>a list of parameters for controlling the fitting process
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Compute robust two-stage estimates of the Heckman's selection model. The robust probit is fitted in the first stage. In the second stage the Mallows type M-estimator is used. 
The values of the tuning constants and the robustness weights can be modified in <code><a href="#topic+heckitrob.control">heckitrob.control</a></code>.
</p>


<h3>Value</h3>

<p>Object of class &quot;heckitrob&quot;.
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients</p>
</td></tr>
<tr><td><code>stage1</code></td>
<td>
<p>object of class <code>glmrob</code> that contains robust probit fit</p>
</td></tr>
<tr><td><code>stage2</code></td>
<td>
<p>object of class <code>rlm</code> that contains second stage robust fit. Note that the standard errors in this object are biased, since they are not corrected for the uncertainty in the first estimation step. Use <code>vcov</code> below</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>variance matrix of the second stage</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>the standard error of the error term of the outcome equation</p>
</td></tr>
<tr><td><code>IMR1</code></td>
<td>
<p>inverse Mills ratio for the case when y_1=1</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>method of estimation, currently only &quot;robust two-stage&quot; is implemented</p>
</td></tr>
<tr><td><code>converged</code></td>
<td>
<p>logical. Did all the estimators converge?</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>list containing the numbers of iterations</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>


<h3>References</h3>

<p>Cameron, C.A., Trivedi, P.K. (2009) Microeconometrics Using Stata. College Station, TX: Stata Press. 
</p>
<p>Heckman, J.J. (1979) Sample Selection Bias as a Specification Error. <em>Econometrica</em>, 47, p. 153-161.
</p>
<p>Zhelonkin, M., Genton M.G., and Ronchetti, E. (2016) Robust Inference in Sample Selection Models. <em>Journal of the Royal Statistical Society, Series B</em>, 78, p. 805-827. doi: <a href="https://doi.org/10.1111/rssb.12136">10.1111/rssb.12136</a>
</p>
<p>Zhelonkin, M., Ronchetti, E. (2021) Robust Analysis of Sample Selection Models through the R Package ssmrob. <em>Journal of Statistical Software</em>, 99, 4, p. 1-35. doi: <a href="https://doi.org/10.18637/jss.v099.i04">10.18637/jss.v099.i04</a>
</p>


<h3>See Also</h3>

<p><code><a href="robustbase.html#topic+glmrob">glmrob</a></code>, <code><a href="MASS.html#topic+rlm">rlm</a></code>, <code><a href="#topic+ssmrob">ssmrob</a></code>, <code><a href="#topic+heckitrob.control">heckitrob.control</a></code>, <code><a href="#topic+heckit5rob">heckit5rob</a></code>, <code><a href="#topic+etregrob">etregrob</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Zhelonkin, Genton, Ronchetti (2016): page 823
data(MEPS2001)
selectEq &lt;- dambexp ~ age + female + educ + blhisp + totchr + ins
outcomeEq &lt;- lnambx ~ age + female + educ + blhisp + totchr + ins
meps.fit &lt;- ssmrob(selectEq, outcomeEq, data = MEPS2001, control = heckitrob.control(tcc = 3.2))
summary(meps.fit)
</code></pre>

<hr>
<h2 id='heckitrob.control'>
Auxiliary for Controlling Robust Fitting
</h2><span id='topic+heckitrob.control'></span>

<h3>Description</h3>

<p>Auxiliary function used for fitting the sample selection models. Contains control sequences, tuning constants and robustness weight functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heckitrob.control(acc = 1e-04, test.acc = "coef", maxit = 50, maxitO = 50, 
                               weights.x1 = c("none", "hat", "robCov", "covMcd"), 
                               weights.x2 = c("none", "hat", "robCov", "covMcd"),
                               tcc = 1.345, t.c = 1.345)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="heckitrob.control_+3A_acc">acc</code></td>
<td>

<p>positive convergence level
</p>
</td></tr>
<tr><td><code id="heckitrob.control_+3A_test.acc">test.acc</code></td>
<td>

<p>only &quot;coef&quot; is currently implemented
</p>
</td></tr>
<tr><td><code id="heckitrob.control_+3A_maxit">maxit</code></td>
<td>

<p>integer giving the maximum number of iterations: selection equation
</p>
</td></tr>
<tr><td><code id="heckitrob.control_+3A_maxito">maxitO</code></td>
<td>

<p>integer giving the maximum number of iterations: outcome equation
</p>
</td></tr>
<tr><td><code id="heckitrob.control_+3A_weights.x1">weights.x1</code></td>
<td>

<p>vector of robustness weights controlling for the leverage effect in the selection equation
</p>
</td></tr>
<tr><td><code id="heckitrob.control_+3A_weights.x2">weights.x2</code></td>
<td>

<p>vector of robustness weights controlling for the leverage effect in the outcome equation
</p>
</td></tr>
<tr><td><code id="heckitrob.control_+3A_tcc">tcc</code></td>
<td>

<p>tuning constant c for Huber's psi-function for the selection stage
</p>
</td></tr>
<tr><td><code id="heckitrob.control_+3A_t.c">t.c</code></td>
<td>

<p>tuning constant c for Huber's psi-function for the outcome stage
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the arguments as components.
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>

<hr>
<h2 id='MEPS2001'>
Ambulatory Expenditures Data
</h2><span id='topic+MEPS2001'></span>

<h3>Description</h3>

<p>The dataset is an extract from the Medical Expenditures Panel Survey. Sample of 3328 observations, with 526 zero expenditures. It was used for illustrative examples by Cameron and Trivedi (2009, Chapter 16).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MEPS2001)</code></pre>


<h3>Format</h3>

<p>A data frame with 3328 observations on the following 12 variables.
</p>

<dl>
<dt><code>educ</code></dt><dd><p>Educational attainment, in years.</p>
</dd>
<dt><code>age</code></dt><dd><p>Age.</p>
</dd>
<dt><code>income</code></dt><dd><p>Income.</p>
</dd>
<dt><code>female</code></dt><dd><p>Logical, TRUE if female.</p>
</dd>
<dt><code>totchr</code></dt><dd><p>Number of chronic diseases.</p>
</dd>
<dt><code>age2</code></dt><dd><p>Age squared</p>
</dd>
<dt><code>ambexp</code></dt><dd><p>Ambulatory expenditures.</p>
</dd>
<dt><code>lambexp</code></dt><dd><p>Log ambulatory expenditures.</p>
</dd>
<dt><code>blhisp</code></dt><dd><p>Ethnicity. Logical, TRUE if black or hispanic.</p>
</dd>
<dt><code>dambexp</code></dt><dd><p>Logical, TRUE if the ambulatory expenditures are greater than zero.</p>
</dd>
<dt><code>lnambx</code></dt><dd><p>Log ambulatory expenditures, with zeros replacing NA's.</p>
</dd>
<dt><code>ins</code></dt><dd><p>Insurance status. Logical, TRUE if insured.</p>
</dd>
</dl>



<h3>Source</h3>

<p>2001 Medical Expenditure Panel Survey by the Agency for Healthcare Research and Quality.
</p>


<h3>References</h3>

<p>Cameron, C.A. and Trivedi, P.K. (2009) <em>Microeconometrics Using Stata</em>, College Station, TX: Stata Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MEPS2001)
summary(MEPS2001)
</code></pre>

<hr>
<h2 id='MmatrM'>
M Matrix
</h2><span id='topic+MmatrM'></span>

<h3>Description</h3>

<p>M matrix of a linear regression M-estimator of Mallows type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MmatrM(x, y, beta, sigma, t.c = 1.345, weights = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MmatrM_+3A_x">x</code></td>
<td>

<p>matrix of explanatory variables
</p>
</td></tr>
<tr><td><code id="MmatrM_+3A_y">y</code></td>
<td>

<p>vector of dependent variables
</p>
</td></tr>
<tr><td><code id="MmatrM_+3A_beta">beta</code></td>
<td>

<p>vector of parameters
</p>
</td></tr>
<tr><td><code id="MmatrM_+3A_sigma">sigma</code></td>
<td>

<p>robust scale estimate
</p>
</td></tr>
<tr><td><code id="MmatrM_+3A_t.c">t.c</code></td>
<td>

<p>tuning constant c for Huber's psi-function
</p>
</td></tr>
<tr><td><code id="MmatrM_+3A_weights">weights</code></td>
<td>

<p>vector of robustness weights controlling for the leverage effects
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes the M matrix of the M-estimator of Mallows type. In current implementation only the Huber score function is available.
</p>


<h3>Value</h3>

<p>M matrix for the sandwich formula.
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>

<hr>
<h2 id='model.matrix.etregrob'>
Design Matrix of Endogenous Treatment Model
</h2><span id='topic+model.matrix.etregrob'></span>

<h3>Description</h3>

<p>Create design matrix of endogenous treatment model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'etregrob'
model.matrix(object, part = "outcome", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model.matrix.etregrob_+3A_object">object</code></td>
<td>

<p>object of class <code>etregrob</code>
</p>
</td></tr>
<tr><td><code id="model.matrix.etregrob_+3A_part">part</code></td>
<td>

<p>character string indicating which matrix to extract: &quot;outcome&quot; for the outcome equation, &quot;selection&quot; for the selection equation.
</p>
</td></tr>
<tr><td><code id="model.matrix.etregrob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If argument <code>part</code> is <code>"outcome"</code>, the design matrix of the outcome equation is returned.
</p>
<p>If argument <code>part</code> is <code>"selection"</code>, the design matrix of the selection equation is returned.
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin
</p>

<hr>
<h2 id='model.matrix.heckit5rob'>
Design Matrix of Switching Regression Model
</h2><span id='topic+model.matrix.heckit5rob'></span>

<h3>Description</h3>

<p>Create design matrix of switching regression model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckit5rob'
model.matrix(object, part = "outcome", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model.matrix.heckit5rob_+3A_object">object</code></td>
<td>

<p>object of class <code>heckit5rob</code>
</p>
</td></tr>
<tr><td><code id="model.matrix.heckit5rob_+3A_part">part</code></td>
<td>

<p>character string indicating which matrix to extract: &quot;outcome&quot; for the outcome equations, &quot;selection&quot; for the selection equation.
</p>
</td></tr>
<tr><td><code id="model.matrix.heckit5rob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If argument <code>part</code> is <code>"outcome"</code>, the list containing design matrices of the outcome equations is returned.
</p>
<table>
<tr><td><code>stage21</code></td>
<td>
<p>design matrix for the first regime</p>
</td></tr>
<tr><td><code>stage22</code></td>
<td>
<p>design matrix for the second regime</p>
</td></tr>
</table>
<p>If argument <code>part</code> is <code>"selection"</code>, the design matrix of the selection equation is returned.
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin
</p>

<hr>
<h2 id='model.matrix.heckitrob'>
Design Matrix of Sample Selection Model
</h2><span id='topic+model.matrix.heckitrob'></span>

<h3>Description</h3>

<p>Create design matrix of sample selection model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckitrob'
model.matrix(object, part = "outcome", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model.matrix.heckitrob_+3A_object">object</code></td>
<td>

<p>object of class <code>heckitrob</code>
</p>
</td></tr>
<tr><td><code id="model.matrix.heckitrob_+3A_part">part</code></td>
<td>

<p>character string indicating which matrix to extract: &quot;outcome&quot; for the outcome equation, &quot;selection&quot; for the selection equation.
</p>
</td></tr>
<tr><td><code id="model.matrix.heckitrob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If argument <code>part</code> is <code>"outcome"</code>, the design matrix of the outcome equation is returned.
</p>
<p>If argument <code>part</code> is <code>"selection"</code>, the design matrix of the selection equation is returned.
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin
</p>

<hr>
<h2 id='MROZ.RAW'>
Wage Offer Data
</h2><span id='topic+MROZ.RAW'></span>

<h3>Description</h3>

<p>Sample of 753 observations, with 325 truncated observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MROZ.RAW)</code></pre>


<h3>Format</h3>

<p>A data frame with 753 observations on the following 22 variables.
</p>

<dl>
<dt><code>inlf</code></dt><dd><p>Logical, TRUE if in labor force.</p>
</dd>
<dt><code>hours</code></dt><dd><p>Hours worked by wife in 1975.</p>
</dd>
<dt><code>kidslt6</code></dt><dd><p>Number of young children, 5 year or younger.</p>
</dd>
<dt><code>kidsge6</code></dt><dd><p>Number of children greater than 6 years of age.</p>
</dd>
<dt><code>age</code></dt><dd><p>Wife's age.</p>
</dd>
<dt><code>educ</code></dt><dd><p>Education level in years.</p>
</dd>
<dt><code>wage</code></dt><dd><p>Average hourly earnings in 1975.</p>
</dd>
<dt><code>repwage</code></dt><dd><p>Wife's wage reported at the time of the 1976 interview.</p>
</dd>
<dt><code>hushrs</code></dt><dd><p>Husband's hours worked in 1975.</p>
</dd>
<dt><code>husage</code></dt><dd><p>Husband's age.</p>
</dd>
<dt><code>huseduc</code></dt><dd><p>Husband's education in years.</p>
</dd>
<dt><code>huswage</code></dt><dd><p>Husband's wage in 1975.</p>
</dd>
<dt><code>faminc</code></dt><dd><p>Family income in 1975.</p>
</dd>
<dt><code>mtr</code></dt><dd><p>Marginal tax rate facing the wife.</p>
</dd>
<dt><code>motheduc</code></dt><dd><p>Wife's mother's education in years.</p>
</dd>
<dt><code>fatheduc</code></dt><dd><p>Wife's father's education in years.</p>
</dd>
<dt><code>unem</code></dt><dd><p>Unemployment rate in county of residence.</p>
</dd>
<dt><code>city</code></dt><dd><p>Logical, TRUE if live in large city.</p>
</dd>
<dt><code>exper</code></dt><dd><p>Wife's labor market experience in years.</p>
</dd>
<dt><code>nwifeinc</code></dt><dd><p>Non-wife income, households's total money minus wife's labor income.</p>
</dd>
<dt><code>lwage</code></dt><dd><p>Wife's log-wage.</p>
</dd>
<dt><code>expersq</code></dt><dd><p>Wife's squared experience.</p>
</dd>
</dl>



<h3>References</h3>

<p>Mroz , T.A. (1987) The Sensitivity of an Empirical Model of Married Women's Hours of Work to Economic and Statistical Assumptions. <em>Econometrica</em>, 55, p. 765-799.
</p>
<p>Wooldridge, J.M. (2002) <em>Econometric Analysis of Cross Section and Panel Data</em>, Cambridge MA: MIT Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MROZ.RAW)
summary(MROZ.RAW)
</code></pre>

<hr>
<h2 id='nobs.heckitrob'>
Number of Observations
</h2><span id='topic+nobs.heckitrob'></span><span id='topic+nobs.heckit5rob'></span><span id='topic+nobs.etregrob'></span>

<h3>Description</h3>

<p>Number of observations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckitrob'
nobs(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nobs.heckitrob_+3A_object">object</code></td>
<td>

<p>object of class <code>heckitrob</code>, or <code>heckit5rob</code> or <code>etregrob</code>
</p>
</td></tr>
<tr><td><code id="nobs.heckitrob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin	
</p>

<hr>
<h2 id='print.etregrob'>
Print a <code>etregrob</code> Object
</h2><span id='topic+print.etregrob'></span>

<h3>Description</h3>

<p>Print an object generated by <code><a href="#topic+etregrob">etregrob</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'etregrob'
print(x, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.etregrob_+3A_x">x</code></td>
<td>

<p>object of <code>etregrob</code> class
</p>
</td></tr>
<tr><td><code id="print.etregrob_+3A_digits">digits</code></td>
<td>

<p>number of significant digits to be printed
</p>
</td></tr>
<tr><td><code id="print.etregrob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin
</p>


<h3>See Also</h3>

<p><code><a href="#topic+etregrob">etregrob</a></code>
</p>

<hr>
<h2 id='print.heckit5rob'>
Print a <code>heckit5rob</code> Object
</h2><span id='topic+print.heckit5rob'></span>

<h3>Description</h3>

<p>Print an object generated by <code><a href="#topic+ssmrob">ssmrob</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckit5rob'
print(x, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.heckit5rob_+3A_x">x</code></td>
<td>

<p>object returned from the <code><a href="#topic+heckit5rob">heckit5rob</a></code> representing the fit of the model
</p>
</td></tr>
<tr><td><code id="print.heckit5rob_+3A_digits">digits</code></td>
<td>

<p>number of significant digits to be printed
</p>
</td></tr>
<tr><td><code id="print.heckit5rob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ssmrob">ssmrob</a></code>
</p>

<hr>
<h2 id='print.heckitrob'>
Print a <code>heckitrob</code> Object
</h2><span id='topic+print.heckitrob'></span>

<h3>Description</h3>

<p>Print an object generated by <code><a href="#topic+ssmrob">ssmrob</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckitrob'
print(x, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.heckitrob_+3A_x">x</code></td>
<td>

<p>object returned from the <code><a href="#topic+heckitrob">heckitrob</a></code> representing the fit of the model
</p>
</td></tr>
<tr><td><code id="print.heckitrob_+3A_digits">digits</code></td>
<td>

<p>number of significant digits to be printed
</p>
</td></tr>
<tr><td><code id="print.heckitrob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ssmrob">ssmrob</a></code>
</p>

<hr>
<h2 id='print.summary.etregrob'>
Print Function for <code>summary.etregrob</code>
</h2><span id='topic+print.summary.etregrob'></span>

<h3>Description</h3>

<p>Print a <code><a href="#topic+summary.etregrob">summary.etregrob</a></code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.etregrob'
print(x, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.etregrob_+3A_x">x</code></td>
<td>

<p>Object of class <code>summary.etregrob</code> returned by a summary function
</p>
</td></tr>
<tr><td><code id="print.summary.etregrob_+3A_digits">digits</code></td>
<td>

<p>number of nonzero digits after comma
</p>
</td></tr>
<tr><td><code id="print.summary.etregrob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin
</p>

<hr>
<h2 id='print.summary.heckit5rob'>
Print Function for <code>summary.heckit5rob</code>
</h2><span id='topic+print.summary.heckit5rob'></span>

<h3>Description</h3>

<p>Print a <code><a href="#topic+summary.heckit5rob">summary.heckit5rob</a></code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.heckit5rob'
print(x, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.heckit5rob_+3A_x">x</code></td>
<td>

<p>Object of class <code>summary.heckit5rob</code> returned by a summary function
</p>
</td></tr>
<tr><td><code id="print.summary.heckit5rob_+3A_digits">digits</code></td>
<td>

<p>number of nonzero digits after comma
</p>
</td></tr>
<tr><td><code id="print.summary.heckit5rob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>

<hr>
<h2 id='print.summary.heckitrob'>
Print Function for <code>summary.heckitrob</code>
</h2><span id='topic+print.summary.heckitrob'></span>

<h3>Description</h3>

<p>Print a <code><a href="#topic+summary.heckitrob">summary.heckitrob</a></code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.heckitrob'
print(x, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.heckitrob_+3A_x">x</code></td>
<td>

<p>Object of class <code>summary.heckitrob</code> returned by a summary function
</p>
</td></tr>
<tr><td><code id="print.summary.heckitrob_+3A_digits">digits</code></td>
<td>

<p>number of nonzero digits after comma
</p>
</td></tr>
<tr><td><code id="print.summary.heckitrob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>

<hr>
<h2 id='PsiMest'>
Score Function of the Mallows M-Estimator
</h2><span id='topic+PsiMest'></span>

<h3>Description</h3>

<p>Score function of the Mallows-type M-estimator. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PsiMest(x, y, beta, sigma, t.c, weight)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PsiMest_+3A_x">x</code></td>
<td>

<p>vector of exogenous variables
</p>
</td></tr>
<tr><td><code id="PsiMest_+3A_y">y</code></td>
<td>

<p>scalar endogenous variable
</p>
</td></tr>
<tr><td><code id="PsiMest_+3A_beta">beta</code></td>
<td>

<p>parameter vector
</p>
</td></tr>
<tr><td><code id="PsiMest_+3A_sigma">sigma</code></td>
<td>

<p>std.error
</p>
</td></tr>
<tr><td><code id="PsiMest_+3A_t.c">t.c</code></td>
<td>

<p>tuning constant of Huber Psi-function
</p>
</td></tr>
<tr><td><code id="PsiMest_+3A_weight">weight</code></td>
<td>

<p>scalar weight on the exogenous variables
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Can be used to compute the influence function of the estimator. Also can be used to approximate the bias of the estimator.
</p>


<h3>Value</h3>

<p>score of the Psi-function
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>


<h3>References</h3>

<p>Hampel, Ronchetti, Rousseeuw, Stahel (1986). Robust Statistics: The Approach Based on Influence Functions. New York: Wiley.
</p>

<hr>
<h2 id='residuals.etregrob'>
Residuals of Robust Endogenous Treatment Model Fit
</h2><span id='topic+residuals.etregrob'></span>

<h3>Description</h3>

<p>Calculate the residuals of theendogenous treatment model using robust fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'etregrob'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.etregrob_+3A_object">object</code></td>
<td>

<p>object of class &quot;<code><a href="#topic+etregrob">etregrob</a></code>&quot;
</p>
</td></tr>
<tr><td><code id="residuals.etregrob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector of residuals.
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin
</p>


<h3>See Also</h3>

<p><code><a href="#topic+etregrob">etregrob</a></code>
</p>

<hr>
<h2 id='residuals.heckit5rob'>
Residuals of Robust Sample Selection Model Fit</h2><span id='topic+residuals.heckit5rob'></span>

<h3>Description</h3>

<p>Calculate the residuals of the sample selection model using robust fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckit5rob'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.heckit5rob_+3A_object">object</code></td>
<td>

<p>object of class &quot;<code><a href="#topic+heckitrob">heckitrob</a></code>&quot; or object of class &quot;<code><a href="#topic+heckit5rob">heckit5rob</a></code>&quot;
</p>
</td></tr>
<tr><td><code id="residuals.heckit5rob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In case of truncated selection model one vector of residuals is returned. In case of switching regression model a list containing two vectors corresponding to two regimes is returned.
</p>


<h3>Value</h3>

<p>The numeric vector(s) of the residuals.
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>


<h3>See Also</h3>

<p><code><a href="#topic+heckitrob">heckitrob</a></code>; <code><a href="#topic+heckit5rob">heckit5rob</a></code>
</p>

<hr>
<h2 id='residuals.heckitrob'>
Residuals of Robust Sample Selection Model Fit
</h2><span id='topic+residuals.heckitrob'></span>

<h3>Description</h3>

<p>Calculate the residuals of the sample selection model using robust fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckitrob'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.heckitrob_+3A_object">object</code></td>
<td>

<p>object of class &quot;<code><a href="#topic+heckitrob">heckitrob</a></code>&quot; or object of class &quot;<code><a href="#topic+heckit5rob">heckit5rob</a></code>&quot;
</p>
</td></tr>
<tr><td><code id="residuals.heckitrob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In case of truncated selection model one vector of residuals is returned. In case of switching regression model a list containing two vectors corresponding to two regimes is returned.
</p>


<h3>Value</h3>

<p>vector(s) of residuals.
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>


<h3>See Also</h3>

<p><code><a href="#topic+heckitrob">heckitrob</a></code>; <code><a href="#topic+heckit5rob">heckit5rob</a></code>
</p>

<hr>
<h2 id='ssmrob'>
Robust Sample Selection Model
</h2><span id='topic+ssmrob'></span>

<h3>Description</h3>

<p>Compute robust two-stage estimates of truncated selection model (Tobit-2) and switching regression model (Tobit-5).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssmrob(selection, outcome, data, control = heckitrob.control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssmrob_+3A_selection">selection</code></td>
<td>

<p>formula, the selection equation
</p>
</td></tr>
<tr><td><code id="ssmrob_+3A_outcome">outcome</code></td>
<td>

<p>formula(s), the outcome equation(s)
</p>
</td></tr>
<tr><td><code id="ssmrob_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the variables in the model. If not found in data, the variables are taken from <code>environment(formula)</code>, typically the environment from which <code>ssmrob</code> is called.
</p>
</td></tr>
<tr><td><code id="ssmrob_+3A_control">control</code></td>
<td>

<p>a list of parameters for controlling the fitting process
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Outcome equation may be a simple formula for the case of Heckman selection model, or a list of two formulas for the case of switching regressions.
</p>


<h3>Value</h3>

<p>Object of class &quot;heckitrob&quot; or object of class &quot;heckit5rob&quot;.
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>


<h3>References</h3>

<p>Amemiya, T. (1984) Tobit Models: a Survey. <em>Journal of Econometrics</em>, 24, p. 3-61.
</p>
<p>Heckman, J.J. (1979) Sample Selection Bias as a Specification Error. <em>Econometrica</em>, 47, p. 153-161.
</p>
<p>Zhelonkin, M., Genton M.G., and Ronchetti, E. (2016) Robust Inference in Sample Selection Models. <em>Journal of the Royal Statistical Society, Series B</em>, 78, p. 805-827. doi: <a href="https://doi.org/10.1111/rssb.12136">10.1111/rssb.12136</a>
</p>
<p>Zhelonkin, M., Ronchetti, E. (2021) Robust Analysis of Sample Selection Models through the R Package ssmrob. <em>Journal of Statistical Software</em>, 99, 4, p. 1-35. doi: <a href="https://doi.org/10.18637/jss.v099.i04">10.18637/jss.v099.i04</a> 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+heckitrob">heckitrob</a></code>, <code><a href="#topic+heckit5rob">heckit5rob</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># sample selection model (Tobit-2)
# Zhelonkin, Genton, Ronchetti (2016): page 823
data(MEPS2001)
selectEq &lt;- dambexp ~ age + female + educ + blhisp + totchr + ins
outcomeEq &lt;- lnambx ~ age + female + educ + blhisp + totchr + ins
meps.fit &lt;- ssmrob(selectEq, outcomeEq, data = MEPS2001, control = heckitrob.control(tcc = 3.2))
summary(meps.fit)

# switching regressions example (Tobit-5)
## Not run: 
library(mvtnorm)
set.seed(2)
N &lt;- 5000
beta1 &lt;- c(0, 1.0, 1.0, 0.75)
beta21 &lt;- c(0, 1.5, 1.0, 0.5)
beta22 &lt;- c(1, -1.5, 1.0, 0.5)
covm &lt;- diag(3)
covm[lower.tri(covm)] &lt;- c(0.75, 0.5, 0.25)
covm[upper.tri(covm)] &lt;- covm[lower.tri(covm)]
eps &lt;- rmvnorm(N, rep(0, 3), covm)
x1 &lt;- rmvnorm(N, mean=c(0, -1, 1), sigma=diag(c(1, 0.5, 1)))
x21 &lt;- x1 
x22 &lt;- x1
x21[, 3] &lt;- rnorm(N, 1, 1)
x22[, 3] &lt;- rnorm(N, 1, 1)
x1beta1 &lt;- beta1[1] + x1[, 1]*beta1[2] + x1[, 2]*beta1[3] + x1[, 3]*beta1[4]
x21beta21 &lt;- beta21[1] + x21[, 1]*beta21[2] + x21[, 2]*beta21[3] + x21[, 3]*beta21[4]
x22beta22 &lt;- beta22[1] + x22[, 1]*beta22[2] + x22[, 2]*beta22[3] + x22[, 3]*beta22[4]
y1 &lt;- ifelse(x1beta1 + eps[, 1] &gt; 0, 1, 0)
y2 &lt;- ifelse(y1 &gt; 0.5, x21beta21 + eps[, 2],
x22beta22 + eps[, 3])
srsim.fit &lt;- ssmrob(y1 ~ x1, list(y2 ~ x21, y2 ~ x22), 
control = heckitrob.control(weights.x1 = "hat", weights.x2 = "covMcd"))
summary(srsim.fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='summary.etregrob'>
Summarizing Robust Fits of Endogenous Treatment Models
</h2><span id='topic+summary.etregrob'></span>

<h3>Description</h3>

<p>Summarizes robust fit of endogenous treatment models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'etregrob'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.etregrob_+3A_object">object</code></td>
<td>

<p>object of class &quot;<code><a href="#topic+etregrob">etregrob</a></code>&quot;
</p>
</td></tr>
<tr><td><code id="summary.etregrob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class &quot;<code>summary.etregrob</code>&quot;
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin
</p>


<h3>See Also</h3>

<p><code><a href="#topic+etregrob">etregrob</a></code>
</p>

<hr>
<h2 id='summary.heckit5rob'>
Summarizing Robust Fits of Sample Selection Models
</h2><span id='topic+summary.heckit5rob'></span>

<h3>Description</h3>

<p>Summarize robust fit of Heckman selection model.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckit5rob'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.heckit5rob_+3A_object">object</code></td>
<td>

<p>object of class &quot;<code><a href="#topic+heckitrob">heckitrob</a></code>&quot; or &quot;<code><a href="#topic+heckit5rob">heckit5rob</a></code>&quot;
</p>
</td></tr>
<tr><td><code id="summary.heckit5rob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class &quot;<code>summary.heckitrob</code>&quot; or object of class &quot;<code>summary.heckit5rob</code>&quot;
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>


<h3>See Also</h3>

<p><code><a href="#topic+heckitrob">heckitrob</a></code>; <code><a href="#topic+heckit5rob">heckit5rob</a></code>; <code><a href="#topic+heck2steprobVcov">heck2steprobVcov</a></code>; <code><a href="#topic+heck5twosteprobVcov">heck5twosteprobVcov</a></code>
</p>

<hr>
<h2 id='summary.heckitrob'>
Summarizing Robust Fits of Sample Selection Models
</h2><span id='topic+summary.heckitrob'></span>

<h3>Description</h3>

<p>Summarize robust fit of Heckman selection model.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckitrob'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.heckitrob_+3A_object">object</code></td>
<td>

<p>object of class &quot;<code><a href="#topic+heckitrob">heckitrob</a></code>&quot; or &quot;<code><a href="#topic+heckit5rob">heckit5rob</a></code>&quot;
</p>
</td></tr>
<tr><td><code id="summary.heckitrob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class &quot;<code>summary.heckitrob</code>&quot; or object of class &quot;<code>summary.heckit5rob</code>&quot;
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>


<h3>See Also</h3>

<p><code><a href="#topic+heckitrob">heckitrob</a></code>; <code><a href="#topic+heckit5rob">heckit5rob</a></code>; <code><a href="#topic+heck2steprobVcov">heck2steprobVcov</a></code>; <code><a href="#topic+heck5twosteprobVcov">heck5twosteprobVcov</a></code>
</p>

<hr>
<h2 id='vcov.etregrob'>
Extract Asymptotic Variance Covariance Matrix
</h2><span id='topic+vcov.etregrob'></span>

<h3>Description</h3>

<p>Extracts the variance covariance matrix of the robust endogenous treatment model fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'etregrob'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.etregrob_+3A_object">object</code></td>
<td>

<p>object of class &quot;<code><a href="#topic+etregrob">etregrob</a></code>&quot;
</p>
</td></tr>
<tr><td><code id="vcov.etregrob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Variance covariance matrix of the second stage. Variance covariance matrix of the selection stage can be extracted using the <code>vcov</code> function for the probit estimator, e.g. <code>vcov(etregrob.object$stage1)</code>.
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin
</p>


<h3>See Also</h3>

<p><code><a href="#topic+etreg2steprobVcov">etreg2steprobVcov</a></code>
</p>

<hr>
<h2 id='vcov.heckit5rob'>
Extract Asymptotic Variance Covariance Matrix
</h2><span id='topic+vcov.heckit5rob'></span>

<h3>Description</h3>

<p>Extract the variance covariance matrix of the robust sample selection model fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckit5rob'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.heckit5rob_+3A_object">object</code></td>
<td>

<p>object of class &quot;<code><a href="#topic+heckitrob">heckitrob</a></code>&quot; or object of class &quot;<code><a href="#topic+heckit5rob">heckit5rob</a></code>&quot;
</p>
</td></tr>
<tr><td><code id="vcov.heckit5rob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Variance covariance matrix of the second stage. Variance covariance matrix of the selection stage can be extracted using the <code>vcov</code> function for the probit estimator, e.g. <code>vcov(heckitrob.object$stage1)</code>.
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>


<h3>See Also</h3>

<p><code><a href="#topic+heck2steprobVcov">heck2steprobVcov</a></code>
</p>

<hr>
<h2 id='vcov.heckitrob'>
Extract Asymptotic Variance Covariance Matrix
</h2><span id='topic+vcov.heckitrob'></span>

<h3>Description</h3>

<p>Extract the variance covariance matrix of the robust sample selection model fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'heckitrob'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.heckitrob_+3A_object">object</code></td>
<td>

<p>object of class &quot;<code><a href="#topic+heckitrob">heckitrob</a></code>&quot; or object of class &quot;<code><a href="#topic+heckit5rob">heckit5rob</a></code>&quot;
</p>
</td></tr>
<tr><td><code id="vcov.heckitrob_+3A_...">...</code></td>
<td>

<p>currently not used
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Variance covariance matrix of the second stage. Variance covariance matrix of the selection stage can be extracted using the <code>vcov</code> function for the probit estimator, e.g. <code>vcov(heckitrob.object$stage1)</code>.
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>


<h3>See Also</h3>

<p><code><a href="#topic+heck2steprobVcov">heck2steprobVcov</a></code>
</p>

<hr>
<h2 id='x2weight.covMcd'>
Robustness Weights
</h2><span id='topic+x2weight.covMcd'></span>

<h3>Description</h3>

<p>Auxiliary function. Computation of the leverage weights based on robust Mahalanobis distance. For computation of location and scatter the MCD method is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x2weight.covMcd(xMat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="x2weight.covMcd_+3A_xmat">xMat</code></td>
<td>

<p>matrix of explanatory variables
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of weights
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>


<h3>See Also</h3>

<p><code><a href="MASS.html#topic+cov.rob">cov.rob</a></code>
</p>

<hr>
<h2 id='x2weight.robCov'>
Robustness Weights
</h2><span id='topic+x2weight.robCov'></span>

<h3>Description</h3>

<p>Auxiliary function. Computation of the leverage weights based on robust Mahalanobis distance. For computation of location and scatter the MVE method is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x2weight.robCov(xMat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="x2weight.robCov_+3A_xmat">xMat</code></td>
<td>

<p>matrix of explanatory variables
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of weights
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>


<h3>See Also</h3>

<p><code><a href="MASS.html#topic+cov.rob">cov.rob</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
