<!DOCTYPE html><html><head><title>Help for package clinDR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {clinDR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#&quot;Extract.emaxsim&quot;'><p>Extract a simulation from the output of emaxsim</p></a></li>
<li><a href='#&quot;Extract.emaxsimB&quot;'><p>Extract a simulation from the output of emaxsimB</p></a></li>
<li><a href='#bpchkMonoEmax'><p>Bayes posterior predictive test for Emax (monotone) model fit</p></a></li>
<li><a href='#checkMonoEmax'><p>Bayes posterior predictive test for Emax (monotone) model fit</p></a></li>
<li><a href='#clinDR-package'>
<p>Bayesian and maximum likelihood Emax model fitting, graphics and</p>
simulation for clinical dose response.</a></li>
<li><a href='#coefEmax'><p>Extract Emax model parameter estimates</p></a></li>
<li><a href='#compileStanModels'><p> Compile <code>rstan</code> Emax models after package <code>clinDR</code> is installed</p>
</p></a></li>
<li><a href='#DRDensityPlot'><p>Plot Bayes or confidence interval density contours over a grid of points (usually dose or time)</p></a></li>
<li><a href='#emaxalt'><p> Fit 4- or 3-parameter Emax model substituting simpler curves</p>
if convergence not achieved.</a></li>
<li><a href='#emaxfun'><p> Vectorized versions of the hyperbolic and sigmoidal Emax models</p></a></li>
<li><a href='#emaxPrior.control'>
<p>Set the parameters of the prior distribution for the Emax model implemented in <code>fitEmaxB</code>.</p></a></li>
<li><a href='#emaxsim'><p>Simulate Emax maximum likelihood estimation</p></a></li>
<li><a href='#emaxsimB'>
<p>Simulate Emax Bayesian estimation</p></a></li>
<li><a href='#emaxsolve'><p>Solve Emax function for target value</p></a></li>
<li><a href='#fitEmax'><p>ML fit of hyperbolic or sigmoidal Emax models to continuous/binary dose</p>
response data.</a></li>
<li><a href='#fitEmaxB'>
<p>Bayesian fit of hyperbolic or sigmoidal Emax models to continuous/binary dose</p>
response data.</a></li>
<li><a href='#FixedMean'><p> Fixed means (proportions) random data constructor for emaxsim</p>
for continuous or binary data</a></li>
<li><a href='#mcmc.control'>
<p>Settings for <code>restan</code> execution in function <code>fitEmaxB</code></p></a></li>
<li><a href='#metaData'><p>Dose response data from several published meta-analyses</p></a></li>
<li><a href='#nllogis'><p>The negative log likelihood function for a 3- or 4-</p>
parameter Emax model on the logit scale for binary dose response.</a></li>
<li><a href='#plot.emaxsim'><p>  Plot the output of emaxsim</p></a></li>
<li><a href='#plot.emaxsimB'><p>  Plot the output of emaxsimB</p></a></li>
<li><a href='#plot.emaxsimBobj'><p> Plot dose response from a data set generated by emaxsimB</p></a></li>
<li><a href='#plot.emaxsimobj'><p> Plot dose response from a data set generated by emaxsim</p></a></li>
<li><a href='#plot.fitEmax'><p>Plot a Emax model and dose group means.</p></a></li>
<li><a href='#plot.fitEmaxB'><p>Plot a Emax model and dose group means.</p></a></li>
<li><a href='#plot.plotB'><p>Plot Bayes dose response curve and dose group means</p></a></li>
<li><a href='#plotB'><p>Plot Bayes  dose response curve and dose group means</p></a></li>
<li><a href='#plotBdensity'><p>Density plot displaying Bayes prior or posterior dose response</p></a></li>
<li><a href='#plotD'><p>Basic plot of dose group means</p></a></li>
<li><a href='#predict.emaxalt'><p>Mean response and SE for specified doses for a</p>
simulated object output by function emaxalt</a></li>
<li><a href='#predict.emaxsim'><p>Mean response and SE for specified doses for each replicate</p>
data set in an emaxsim object</a></li>
<li><a href='#predict.emaxsimB'><p>Mean response and SE for each replicate</p>
data set in an emaxsimB object</a></li>
<li><a href='#predict.emaxsimBobj'><p>Mean response estimates (posterior means) and SE (posterior SD)</p>
for specified doses for a simulated emaxsimBobj object</a></li>
<li><a href='#predict.emaxsimobj'><p>Mean response and SE for specified doses for a</p>
simulated emaxsimobj object</a></li>
<li><a href='#predict.fitEmax'><p>Estimated mean/proportion and confidence intervals</p>
derived from the maximum likelihood fit of a 3- or 4- parameter Emax model.</a></li>
<li><a href='#predict.fitEmaxB'>
<p>Estimated mean and posterior intervals</p>
derived from a Bayesian hyperbolic or sigmiodial Emax model.</a></li>
<li><a href='#print.emaxsim'><p>Print simulation output from emaxsim</p></a></li>
<li><a href='#print.emaxsimB'><p>Print simulation output from emaxsimB</p></a></li>
<li><a href='#print.emaxsimBobj'>
<p>Print a summary of the fitted Emax model</p></a></li>
<li><a href='#print.emaxsimobj'><p>Print a data set generated by emaxsim</p></a></li>
<li><a href='#print.fitEmax'>
<p>Print a summary of the fitted Emax model</p></a></li>
<li><a href='#print.fitEmaxB'>
<p>Print a summary of the fitted Bayesian Emax model</p></a></li>
<li><a href='#printemaxPrior'>
<p>Print protocol or sap text describing the prior distribution for</p>
the model parameters of the input emaxPrior object</a></li>
<li><a href='#prior.control'>
<p>Set the parameters of the prior distribution for the Emax model implemented in <code>fitEmaxB</code>.</p></a></li>
<li><a href='#RandEmax'><p>Random data constructor function for emaxsim creating random parameters</p>
for an Emax model for continuous or binary data.</a></li>
<li><a href='#randomEmax'><p>Random data constructor function for emaxsim(B)</p>
creating random parameters
for an Emax model for continuous or binary data.</a></li>
<li><a href='#runSimulations'>
<p>Shiny app for function <code>emaxsim(B)</code></p></a></li>
<li><a href='#SeEmax'><p> Asymptotic SE for dose response estimates from a</p>
3- or 4- parameter Emax model</a></li>
<li><a href='#selEstan'>
<p>Select a pre-compiled <code>rstan</code> Emax model</p></a></li>
<li><a href='#showStanModels'>
<p>Display <code>STAN</code> model code.</p></a></li>
<li><a href='#sigmaEmax'><p>Extract Emax model residual SD estimates</p></a></li>
<li><a href='#startEmax'><p>Compute starting parameter values for the 3- or 4- Emax model.</p></a></li>
<li><a href='#summary.emaxsim'><p> Summary of output of emaxsim</p></a></li>
<li><a href='#summary.emaxsimB'><p> Summary of output of emaxsimB</p></a></li>
<li><a href='#summary.emaxsimBobj'><p>Summarize Emax fit to a data set generated by emaxsimB</p></a></li>
<li><a href='#summary.emaxsimobj'><p>Summarize Emax fit to a data set generated by emaxsim</p></a></li>
<li><a href='#summary.fitEmax'>
<p>Print a summary of the fitted Emax model</p></a></li>
<li><a href='#summary.fitEmaxB'>
<p>Print a summary of the fitted Bayesian Emax model</p></a></li>
<li><a href='#targetBeta'><p>Find a scaled Beta distribution matching specified probabilities</p></a></li>
<li><a href='#targetCI'><p>Compute the dose with confidence interval exceeding a target</p>
change from placebo for each simulated example in an emaxsim object.</a></li>
<li><a href='#targetD'><p>Compute the MLE (and its SE) of the dose achieving a specified</p>
target improvement from placebo.</a></li>
<li><a href='#update.emaxsimobj'><p>Update estimation in a data set generated by emaxsim</p></a></li>
<li><a href='#vcovEmax'><p>Extract Emax model variance-covariance matrix for ML estimates</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>2.4.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-07-30</td>
</tr>
<tr>
<td>Title:</td>
<td>Simulation and Analysis Tools for Clinical Dose Response
Modeling</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Neal Thomas &lt;snthomas99@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Bayesian and ML Emax model fitting, graphics and simulation for clinical dose
    response.  The summary data from the dose response meta-analyses in  
    Thomas, Sweeney, and Somayaji (2014) &lt;<a href="https://doi.org/10.1080%2F19466315.2014.924876">doi:10.1080/19466315.2014.924876</a>&gt; and
    Thomas and Roy (2016) &lt;<a href="https://doi.org/10.1080%2F19466315.2016.1256229">doi:10.1080/19466315.2016.1256229</a>&gt; 
    Wu, Banerjee, Jin, Menon, Martin, and Heatherington(2017) &lt;<a href="https://doi.org/10.1177%2F0962280216684528">doi:10.1177/0962280216684528</a>&gt; 
    are included 
    in the package.  The prior distributions for the Bayesian analyses default to
    the posterior predictive distributions derived from these references.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), rstan (&ge; 2.17.3), shiny</td>
</tr>
<tr>
<td>Imports:</td>
<td>foreach,graphics,DoseFinding,stats,mvtnorm,utils,
parallel,doParallel, ggplot2, tidyr, purrr, tibble, dplyr,
glue, waiter</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Author:</td>
<td>Neal Thomas <a href="https://orcid.org/0000-0002-1915-8487"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Jing Wu [aut],
  Mike K. Smith [aut]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-09 01:51:18 UTC; snthomas99</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-09 04:20:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='+26quot+3BExtract.emaxsim+26quot+3B'>Extract a simulation from the output of emaxsim </h2><span id='topic++5B.emaxsim'></span>

<h3>Description</h3>

<p>Extract a simulated data set from the output of
emaxsim. Data are re-created using the stored random number seed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emaxsim'
x[i, ...]
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B26quot+2B3BExtract.emaxsim+2B26quot+2B3B_+3A_x">x</code></td>
<td>
<p>Output object from <code><a href="#topic+emaxsim">emaxsim</a></code> </p>
</td></tr>
<tr><td><code id="+2B26quot+2B3BExtract.emaxsim+2B26quot+2B3B_+3A_i">i</code></td>
<td>
<p>Simulation replication to extract </p>
</td></tr>
<tr><td><code id="+2B26quot+2B3BExtract.emaxsim+2B26quot+2B3B_+3A_...">...</code></td>
<td>
<p>Parameters passed to other functions (none currently) </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Re-creates the ith simulated data set for subsequent analyses.  Also returns all
analyses done for the ith data set in  <code><a href="#topic+emaxsim">emaxsim</a></code>
</p>


<h3>Value</h3>

<p>A list is returned with class(emaxsimobj) containing:
</p>
<table>
<tr><td><code>y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code>dose</code></td>
<td>
<p>Doses corresponding to <code>y</code></p>
</td></tr>
<tr><td><code>pop</code></td>
<td>
<p>Population parameters; type of parameter depends on
constructor function generating study data.</p>
</td></tr>
<tr><td><code>popSD</code></td>
<td>
<p>Vector containing the population SD used to generate
continuous data.  <code>NULL</code> for binary data.</p>
</td></tr>
<tr><td><code>init</code></td>
<td>
<p>Starting Emax parameters</p>
</td></tr>
<tr><td><code>est4</code></td>
<td>
<p> 4-parmameter Emax fit (ed50,lambda,emax,e0).  NA if
failed to converge or 3-parameter model requested.</p>
</td></tr>
<tr><td><code>est3</code></td>
<td>
<p> 3-parmameter Emax fit (ed50,emax,e0).  NA if
failed to converge or 4-parameter model successfully fit.</p>
</td></tr>
<tr><td><code>estA</code></td>
<td>
<p>Alternative parameter estimates.  NA if
Emax model fit successfully</p>
</td></tr>
<tr><td><code>vc</code></td>
<td>
<p>The variance-covariance matrix of the model parameters 
for the selected model. </p>
</td></tr>
<tr><td><code>residSD</code></td>
<td>
<p>The residual SD based on the selected model.</p>
</td></tr>
<tr><td><code>bigC</code></td>
<td>
<p>bigC= TRUE if the primary fit (from modType) yielded an 
ED50 &gt; ED50 upper limit.</p>
</td></tr>
<tr><td><code>negC</code></td>
<td>
<p>negC= TRUE if the primary fit (from modType) yielded a
negative ED50 estimate&lt; ED50 lower limit </p>
</td></tr>
<tr><td><code>modType</code></td>
<td>
<p>When modType=4, the fitting begins with the 4
parameter model.  If estimation fails or modType=3, the 3-parameter
estimation is applied.  If it fails, a best-fitting model linear in
its parameters is selected.</p>
</td></tr>
<tr><td><code>fit</code></td>
<td>
<p>Output of model determined by fitType</p>
</td></tr>
<tr><td><code>fitType</code></td>
<td>
<p>Character vector with &quot;4&quot;, &quot;3&quot;, &quot;L&quot;, &quot;LL&quot;, or &quot;E&quot; for
4-Emax, 3-Emax, linear,
log-linear, or exponential when an alternative model is selected.</p>
</td></tr>
<tr><td><code>ed50cutoff</code></td>
<td>
<p>Upper allowed limit for ED50 estimates.</p>
</td></tr>
<tr><td><code>ed50lowcutoff</code></td>
<td>
<p>Lower allowed limit for the ED50 estimates.</p>
</td></tr>
<tr><td><code>switchMod</code></td>
<td>
<p>If switchMod is TRUE, the algorithm substitutes a
simpler model if (1) convergence is not achieved, (2) the information
matrix is not positive definite at the converged values, (3) the ED50
estimates are outside the cutoff bounds.  If switchMod is F, only
conditions (1) or (2) cause a simpler model to be used.</p>
</td></tr>
<tr><td><code>PL</code></td>
<td>
<p>T if the 'plinear' algorithm in
nls converged</p>
</td></tr>
<tr><td><code>predpop</code></td>
<td>
<p>Population means for each dose group</p>
</td></tr>
<tr><td><code>dm</code></td>
<td>
<p>Vector containing dose group means</p>
</td></tr>
<tr><td><code>dsd</code></td>
<td>
<p>Vector containing dose group SDs</p>
</td></tr>
<tr><td><code>fitpred</code></td>
<td>
<p>Dose groups means
estimated from the model</p>
</td></tr>
<tr><td><code>sepred</code></td>
<td>
<p>SEs for estimates in
fitpred</p>
</td></tr>
<tr><td><code>sedif</code></td>
<td>
<p>SEs for model-based estimates of difference with placebo</p>
</td></tr>
<tr><td><code>pVal</code>, <code>selContrast</code></td>
<td>
<p>P-value and contrast selected from MCP-MOD test</p>
</td></tr>
<tr><td><code>idmax</code></td>
<td>
<p>Index of default dose group for comparison to placebo</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Extraction from a simulation object requires re-creation of the
simulated data set.  If the
extracted object is to be used more than once, it is more efficient to
save the extracted object than reuse [].
</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

<p><code><a href="#topic+emaxsim">emaxsim</a></code>, <code><a href="#topic+print.emaxsimobj">print.emaxsimobj</a></code>, 
<code><a href="#topic+plot.emaxsimobj">plot.emaxsimobj</a></code>, <code><a href="#topic+update.emaxsimobj">update.emaxsimobj</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
## code change random number seed

nsim&lt;-50
idmax&lt;-5
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop)  

###FixedMean is specialized constructor function for emaxsim
gen.parm&lt;-FixedMean(n,doselev,meanlev,sdy)  

D1 &lt;- emaxsim(nsim,gen.parm,modType=3)
e49&lt;-D1[49]                  #### extract 49th simulation


## End(Not run)

</code></pre>

<hr>
<h2 id='+26quot+3BExtract.emaxsimB+26quot+3B'>Extract a simulation from the output of emaxsimB </h2><span id='topic++5B.emaxsimB'></span>

<h3>Description</h3>

<p>Extract a simulated data set from the output of
emaxsimB. Data are re-created using the stored random number seed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emaxsimB'
x[i, ...]
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B26quot+2B3BExtract.emaxsimB+2B26quot+2B3B_+3A_x">x</code></td>
<td>
<p>Output object from <code><a href="#topic+emaxsimB">emaxsimB</a></code> </p>
</td></tr>
<tr><td><code id="+2B26quot+2B3BExtract.emaxsimB+2B26quot+2B3B_+3A_i">i</code></td>
<td>
<p>Simulation replication to extract </p>
</td></tr>
<tr><td><code id="+2B26quot+2B3BExtract.emaxsimB+2B26quot+2B3B_+3A_...">...</code></td>
<td>
<p>Parameters passed to other functions (none currently) </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Re-creates the ith simulated data set for subsequent analyses.  Also returns all
analyses done for the ith data set in  <code><a href="#topic+emaxsimB">emaxsimB</a></code>
</p>


<h3>Value</h3>

<p>A list is returned with class(emaxsimBobj) containing:
</p>
<table>
<tr><td><code>y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code>dose</code></td>
<td>
<p>Doses corresponding to <code>y</code></p>
</td></tr>
<tr><td><code>pop</code></td>
<td>
<p>Population parameters; type of parameter depends on
constructor function generating study data.</p>
</td></tr>
<tr><td><code>popSD</code></td>
<td>
<p>Vector containing the population SD used to generate
continuous data.  <code>NULL</code> for binary data.</p>
</td></tr>
<tr><td><code>binary</code></td>
<td>
<p>When <code>TRUE</code>, binary data modeled on the logit scale</p>
</td></tr>
<tr><td><code>modType</code></td>
<td>
<p><code>modType=3, 4</code>, for the hyperbolic and sigmoidal 
Emax models.</p>
</td></tr>
<tr><td><code>predpop</code></td>
<td>
<p>Population means for each dose group</p>
</td></tr>
<tr><td><code>dm</code></td>
<td>
<p>Vector containing dose group means</p>
</td></tr>
<tr><td><code>dsd</code></td>
<td>
<p>Vector containing dose group SDs</p>
</td></tr>
<tr><td><code>fitpred</code></td>
<td>
<p>Posterior means of the dose groups means</p>
</td></tr>
<tr><td><code>sepred</code></td>
<td>
<p>SE (posterior SD) corresponding to the estmates in
fitpred</p>
</td></tr>
<tr><td><code>sedif</code></td>
<td>
<p>SE (posterior SD) for the differences with placebo</p>
</td></tr>
<tr><td><code>bfit</code></td>
<td>
<p>Bayesian fitted model of class <code>fitEmaxB</code>.</p>
</td></tr>
<tr><td><code>prior</code>, <code>mcmc</code></td>
<td>
<p>See <code>fitEmax</code> for documentation.</p>
</td></tr>
<tr><td><code>pVal</code>, <code>selContrast</code></td>
<td>
<p>P-value and contrast selected from MCP-MOD test</p>
</td></tr>
<tr><td><code>idmax</code></td>
<td>
<p>Index of default dose group for comparison to placebo</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Extraction from a simulation object requires re-creation of the
simulated data set.  If the
extracted object is to be used more than once, it is more efficient to
save the extracted object than reuse [].
</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

<p><code><a href="#topic+emaxsimB">emaxsimB</a></code>, <code><a href="#topic+print.emaxsimBobj">print.emaxsimBobj</a></code>, 
<code><a href="#topic+plot.emaxsimBobj">plot.emaxsimBobj</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

save.seed&lt;-.Random.seed
set.seed(12357)

nsim&lt;-50
idmax&lt;-5
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)
Ndose&lt;-length(doselev)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-2.464592
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop)  

###FixedMean is specialized constructor function for emaxsim
gen&lt;-FixedMean(n,doselev,meanlev,sdy)  

prior&lt;-emaxPrior.control(epmu=0,epsca=30,difTargetmu=0,
		difTargetsca=30,dTarget=100,p50=50,sigmalow=0.1,
		sigmaup=30,parmDF=5)
mcmc&lt;-mcmc.control(chains=1,warmup=500,iter=5000,seed=53453,propInit=0.15,adapt_delta = 0.95)

D1 &lt;- emaxsimB(nsim,gen, prior, modType=3,mcmc=mcmc,check=FALSE)

out&lt;-D1[2]


.Random.seed&lt;-save.seed

## End(Not run)
</code></pre>

<hr>
<h2 id='bpchkMonoEmax'>Bayes posterior predictive test for Emax (monotone) model fit</h2><span id='topic+bpchkMonoEmax'></span>

<h3>Description</h3>

<p>Bayes posterior predictive test for an Emax (monotone) model  
fit comparing the best response from lower doses to
the response from the highest dose.  <code>checkMonoEmax</code> is deprecated.  
See <code>bpchkMonoEmax</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bpchkMonoEmax(x, trend='positive', protSel=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bpchkMonoEmax_+3A_x">x</code></td>
<td>
<p>Output object of class 'fitEmaxB'.</p>
</td></tr>
<tr><td><code id="bpchkMonoEmax_+3A_trend">trend</code></td>
<td>
<p>The default is 'positive', so high values for lower doses
yield small Bayesian predictive probabilities.  Set <code>trend</code> to 'negative'
for dose response curves with negative trends.</p>
</td></tr>
<tr><td><code id="bpchkMonoEmax_+3A_protsel">protSel</code></td>
<td>
<p>The test is applied to the data from a single protocol.  
The protocol can be selected if the model was fit to data from more 
than one protocol.  The <code>protSel</code> must match a 
protocol value input to <code>fitEmaxB</code> or it numerical index value, 1,2,...</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Bayesian predictive p-value 
is the posterior probability that a dose group
sample mean in a new study with the same sample sizes would yield a 
higher (or lower for negative trend) difference for one of the lower doses versus 
the highest dose than was actually obtained from the real sample.  There must
be at least two non-placebo dose groups (NA returned otherwise).  Placebo
response is excluded from the comparisons.
</p>
<p>The function generates random numbers, so the random number generator/seed must
be set before the function is called for exact reproducibility.
</p>
<p>When <code>fitEmaxB</code> is applied to first-stage fitted model output with a
non-diagonal variance-covariance matrix, the predictive draws are selected
from a multivariate model with means computed from the MCMC-generated
parameters and input asymptotic variance-covariance matrix <code>vcest</code>.  
If the fitted model was applied to binary data, the GOF statistic is 
computed based on the logit rather than observed dose group sample 
proportion scale.  This differs from the setting with patient-level
data input to <code>fitEmaxB</code>.
</p>


<h3>Value</h3>

<p>Returns a scalar Bayesian predictive p-value.
</p>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>References</h3>

<p>Thomas, N., Sweeney, K., and Somayaji, V. (2014).  Meta-analysis of clinical dose response in a large drug development portfolio, Statistics in Biopharmaceutical Research, Vol. 6, No.4, 302-317.
&lt;doi:10.1080/19466315.2014.924876&gt;
</p>
<p>Thomas, N., and Roy, D. (2016).  Analysis of clinical dose-response in small-molecule drug development:  2009-2014. Statistics in Biopharmaceutical Research, Vol. 6, No.4, 302-317
&lt;doi:10.1080/19466315.2016.1256229&gt;
</p>
<p>Wu, J., Banerjee, A., Jin, B. Menon, M. S., Martin, S. and Heatherington, A. (2017). Clinical dose response for a broad set of biological products: A model-based meta-analysis. Statistical Methods in Medical Research. &lt;doi:10.1177/0962280216684528&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.plotB">plot.plotB</a></code>, <code><a href="#topic+plotD">plotD</a></code>,  <code><a href="#topic+plot.fitEmax">plot.fitEmax</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

data("metaData")
exdat&lt;-metaData[metaData$taid==6 &amp; metaData$poptype==1,]

prior&lt;-emaxPrior.control(epmu=0,epsca=10,difTargetmu=0,difTargetsca=10,dTarget=80.0,
        p50=3.75,sigmalow=0.01,sigmaup=20)
mcmc&lt;-mcmc.control(chains=3)

msSat&lt;-sum((exdat$sampsize-1)*(exdat$sd)^2)/(sum(exdat$sampsize)-length(exdat$sampsize))
fitout&lt;-fitEmaxB(exdat$rslt,exdat$dose,prior,modType=4,
				count=exdat$sampsize,msSat=msSat,mcmc=mcmc)
parms&lt;-coef(fitout)[,1:4]  #use first intercept

checkMonoEmax(fitout, trend='negative')
      

## End(Not run)
</code></pre>

<hr>
<h2 id='checkMonoEmax'>Bayes posterior predictive test for Emax (monotone) model fit</h2><span id='topic+checkMonoEmax'></span>

<h3>Description</h3>

<p>Bayes posterior predictive test for an Emax (monotone) model  
fit comparing the best response from lower doses to
the response from the highest dose.  <code>checkMonoEmax</code> is deprecated.  
See <code>bpchkMonoEmax</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkMonoEmax(y, 
      dose, 
      parm, 
      sigma2,
      nvec=rep(1,length(dose)),
      xbase=NULL,
      modelFun=emaxfun,
      trend='positive',
      binary= FALSE,logit=binary)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkMonoEmax_+3A_y">y</code></td>
<td>
<p>Outcomes.  Continuous <code>y</code> can be individual data or group means.
Binary <code>y</code> can be individual data, group proportions, or 0/1 data with
correspondng counts, as is required by <code>fitEmaxB</code>.</p>
</td></tr>
<tr><td><code id="checkMonoEmax_+3A_dose">dose</code></td>
<td>
<p>Doses corresponding to outcomes </p>
</td></tr>
<tr><td><code id="checkMonoEmax_+3A_parm">parm</code></td>
<td>
<p>Matrix of simultated parameter values (each row is a
simulated parameter vector).  The <code>parm</code> values
must be constructed for use in the model function <code>modFun</code>.  The
default is a 4-parameter Emax model with parameters
(log(ED50),lambda,Emax,E0).  For a 3-parameter model, set lambda=1 for each
simulated parameter vector.</p>
</td></tr>
<tr><td><code id="checkMonoEmax_+3A_sigma2">sigma2</code></td>
<td>
<p>Simulated draws from the residual variance (assumed
additive, homogeneous).  The length of <code>sigma2</code> must be the same
as the number of rows of <code>parm</code>.  <code>sigma2</code> is ignored when
<code>binary=TRUE</code></p>
</td></tr>
<tr><td><code id="checkMonoEmax_+3A_nvec">nvec</code></td>
<td>
<p>The number of observations contributing to each <code>y</code>.  The default 
is <code>1</code> for patient-level data.</p>
</td></tr>
<tr><td><code id="checkMonoEmax_+3A_xbase">xbase</code></td>
<td>
<p>Optional covariates matching <code>y</code>.  <code>nvec</code> must be 1 (patient-level)
data.  The coeficients for <code>xbase</code> are the final columns of <code>parm</code>.</p>
</td></tr>
<tr><td><code id="checkMonoEmax_+3A_modelfun">modelFun</code></td>
<td>
<p>The mean model function.  The first argument is a
scalar dose, and the second argument is a matrix of parameter values.
The rows of the matrix are random draws of parameter vectors for the
model.  The default function is the 4-parameter Emax function <code>emaxfun</code>.</p>
</td></tr>
<tr><td><code id="checkMonoEmax_+3A_trend">trend</code></td>
<td>
<p>The default is 'positive', so high values for lower doses
yield small Bayesian predictive probabilities.  Set <code>trend</code> to 'negative'
for dose response curves with negative trends.</p>
</td></tr>
<tr><td><code id="checkMonoEmax_+3A_binary">binary</code></td>
<td>
<p>If TRUE, the inverse logit 
transform is applied to the
(Emax) function output for comparison to dose group sample proportions, and the
predictive data are sampled from a binomial distribution.</p>
</td></tr>
<tr><td><code id="checkMonoEmax_+3A_logit">logit</code></td>
<td>
<p><code>logit</code> is deprecated, use <code>binary</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>A sample of parameters from the joint posterior distribution must be 
supplied (typically produced by an MCMC program).  The Bayesian predictive p-value 
is the posterior probability that a dose group
sample mean in a new study with the same sample sizes would yield a 
higher (or lower for negative trend) difference for one of the lower doses versus 
the highest dose than was actually obtained from the real sample.  There must
be at least two non-placebo dose groups (NA returned otherwise).  Placebo
response is excluded from the comparisons.
</p>
<p>The function generates random numbers, so the random number generator/seed must
be set before the function is called for exact reproducibility.
</p>


<h3>Value</h3>

<p>Returns a scalar Bayesian predictive p-value.
</p>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.plotB">plot.plotB</a></code>, <code><a href="#topic+plotD">plotD</a></code>,  <code><a href="#topic+plot.fitEmax">plot.fitEmax</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

data("metaData")
exdat&lt;-metaData[metaData$taid==6 &amp; metaData$poptype==1,]

prior&lt;-emaxPrior.control(epmu=0,epsca=10,difTargetmu=0,difTargetsca=10,dTarget=80.0,
        p50=3.75,sigmalow=0.01,sigmaup=20)
mcmc&lt;-mcmc.control(chains=3)

msSat&lt;-sum((exdat$sampsize-1)*(exdat$sd)^2)/(sum(exdat$sampsize)-length(exdat$sampsize))
fitout&lt;-fitEmaxB(exdat$rslt,exdat$dose,prior,modType=4,
				count=exdat$sampsize,msSat=msSat,mcmc=mcmc)
parms&lt;-coef(fitout)[,1:4]  #use first intercept

checkMonoEmax(y=exdat$rslt, dose=exdat$dose, parm=parms, sigma2=(sigma(fitout))^2,
      nvec=exdat$sampsize, trend='negative')
      

## End(Not run)

</code></pre>

<hr>
<h2 id='clinDR-package'>
Bayesian and maximum likelihood Emax model fitting, graphics and 
simulation for clinical dose response.
</h2><span id='topic+clinDR-package'></span>

<h3>Description</h3>

<p>The functions <code><a href="#topic+fitEmax">fitEmax</a></code> and <code><a href="#topic+fitEmaxB">fitEmaxB</a></code> fit an Emax model
to binary or continuous data using maximum likelihood or Bayesian estimation. 
They have several generic supporting functions.
Functions to produce plots associated with dose response
analyses are (<code><a href="#topic+plotD">plotD</a></code>, <code><a href="#topic+plotB">plotB</a></code>,
<code><a href="#topic+plot.fitEmax">plot.fitEmax</a></code>,<code><a href="#topic+plot.fitEmaxB">plot.fitEmaxB</a></code>).   
The functions <code><a href="#topic+emaxsim">emaxsim</a></code> and <code><a href="#topic+emaxsimB">emaxsimB</a></code> perform
simulations of 4- and 3-parameter Emax ML or Bayesian estimation. 
The ML estimates are replaced with alternative
model fits when the primary estimation fails.  Several supporting
functions are supplied to analyze the output of <code><a href="#topic+emaxsim">emaxsim</a></code>
and <code><a href="#topic+emaxsimB">emaxsimB</a></code>,
including analyses for specific simulated data sets.  All of the data sets
from dose response meta analyses are included in 
<code><a href="#topic+metaData">metaData</a></code>.  
</p>


<h3>Details</h3>

<p>The function <code>compileStanModels</code> must be executed once after the package is
installed to create compiled <code>STAN</code> Emax models before the Bayes functions 
in the package can be executed.  This requires 3-10 minutes to complete on most
machines. The compiled code is 32-bit or 64-bit specific, and both must be created if
both versions of R are used.
</p>
<p>The Bayesian computations use the R package <code>rstan</code>.  It can be installed from CRAN. Windows users should check the instructions for <code>rstan</code> at the <a href="https://mc-stan.org">https://mc-stan.org</a> and <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started">https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started</a>. 
Note that <code>Rtools</code> must be installed, which is a simple, but often overlooked step. Instructions for its installation are given in the second URL.
</p>


<h3>Author(s)</h3>

<p>Neal Thomas [aut, cre], Jing Wu[aut]
</p>


<h3>See Also</h3>

<p><code><a href="DoseFinding.html#topic+DoseFinding">DoseFinding</a></code></p>

<hr>
<h2 id='coefEmax'>Extract Emax model parameter estimates</h2><span id='topic+coef.fitEmax'></span><span id='topic+coef.fitEmaxB'></span><span id='topic+coef.emaxsim'></span><span id='topic+coef.emaxsimB'></span>

<h3>Description</h3>

<p>Extract Emax model parameter estimates.  MLE for fitEmax. 
Matrix of MCMC generated parameters for fitEmaxB.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'fitEmax'
coef(object, ...)
	## S3 method for class 'fitEmaxB'
coef(object, local=FALSE, ...)
	## S3 method for class 'emaxsim'
coef(object, ...)
	## S3 method for class 'emaxsimB'
coef(object, local=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coefEmax_+3A_object">object</code></td>
<td>
<p> Output of Emax fitting function </p>
</td></tr>
<tr><td><code id="coefEmax_+3A_local">local</code></td>
<td>
<p>When a prior distribution of type 'emaxPrior' was used to
create the object, specifying <code>local=TRUE</code> will output the local
'difTarget' parameter estimates.</p>
</td></tr>
<tr><td><code id="coefEmax_+3A_...">...</code></td>
<td>
<p> No additional inputs supported </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of MLE estimates of model parameter from <code>fitEmax</code>.  
Matrix of MCMC generated parameters for <code>fitEmaxB</code>.
Matrix with posterior median parameter estimates for 
each <code>emaxsimB</code> simulation: (led50,lambda,emax,e0) or (led50,emax,e0).
For <code>emaxsim</code>, a list is returned with the model type fit for each
simulation, and a matrix with the corresponding model coefficients.  The 
order of the parameters is given in the <code>emaxsim</code> documentation.
</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+sigma">sigma</a></code>, <code><a href="#topic+fitEmax">fitEmax</a></code>, <code><a href="#topic+fitEmaxB">fitEmaxB</a></code>,
<code><a href="#topic+emaxsim">emaxsim</a></code>, <code><a href="#topic+emaxsimB">emaxsimB</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>doselev&lt;-c(0,5,25,50,100,350)
n&lt;-c(78,81,81,81,77,80)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-8.0
pop&lt;-c(log(ed50),emax,e0)    
dose&lt;-rep(doselev,n)
meanlev&lt;-emaxfun(dose,pop)  

y&lt;-rnorm(sum(n),meanlev,sdy)

testout&lt;-fitEmax(y,dose,modType=4)
coef(testout)
</code></pre>

<hr>
<h2 id='compileStanModels'> Compile <code>rstan</code> Emax models after package <code>clinDR</code> is installed
</h2><span id='topic+compileStanModels'></span>

<h3>Description</h3>

<p>Compile <code>rstan</code> code for Emax models used by <code>fitEmaxB</code>
and <code>emaxsimB</code>.  This function must be executed once after the 
<code>clinDR</code> package is installed.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compileStanModels()
</code></pre>


<h3>Details</h3>

<p>The compiled models are stored in the <code>models</code> sub-directory of the installed
<code>clinDR</code> package.  The user must have write-access to the package directory.
The package can be installed in a user-specified directory if the user
does not have write privileges for the default 
package directory. Execution requires several minutes. The compiled models are
32- or 64- bit specific. Both sets must be compiled if the compiled R type
is changed (they are stored in sub-directories comp32 or comp64).  It is recommended
to execute the function again if the package <code>rstan</code> is updated.
</p>
<p>Package <code>rstan</code> must be functional for <code>CompileStanModels</code> to be successful.  See <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started">https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started</a>.  Note especially the instructions for installing <code>Rtools</code>, which is required for execution on a Windows machine.
</p>


<h3>Value</h3>

<p>'basemodel.rds' and 'mrmodel.rds' should be created in the package directory
in the sub-directory 'models'.
</p>


<h3>Author(s)</h3>

<p>Neal Thomas
</p>

<hr>
<h2 id='DRDensityPlot'>Plot Bayes or confidence interval density contours over a grid of points (usually dose or time)</h2><span id='topic+DRDensityPlot'></span>

<h3>Description</h3>

<p>Density plot for distributions conditional on a variable. 
A grid of values are specified for the conditioning variable, which
is plotted on the horizontal axis.  The conditioning variable is 
typically dose or time</p>


<h3>Usage</h3>

<pre><code class='language-R'>DRDensityPlot(x,qL,qH,qlevL=c(0.025,0.05,0.10,0.25),
		xlim,ylim,xlab='x',ylab='y')
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DRDensityPlot_+3A_x">x</code></td>
<td>
<p>A grid of conditioning values to be plotted on the horizontal axis.  This grid typically
represents dose or time.</p>
</td></tr>
<tr><td><code id="DRDensityPlot_+3A_ql">qL</code></td>
<td>
<p>Lower percentiles, confidence or probabiity levels.  <code>qL</code> is a matrix with rows 
corresponding to <code>x</code>, and columns corresponding to <code>qlevL</code>.  The percentiles must be 
increasing in order and less that 0.50.</p>
</td></tr>
<tr><td><code id="DRDensityPlot_+3A_qh">qH</code></td>
<td>
<p>Upper percentiles, confidence or probabiity levels.  <code>qH</code> levels correspond to
the <code>qL</code> levels but are ordered from highest to lowest (1-<code>qlevL</code>), with the 
smallest greater than 0.50.</p>
</td></tr>
<tr><td><code id="DRDensityPlot_+3A_qlevl">qlevL</code></td>
<td>
<p>Density intervals are formed with percentile boundaries at (qlevL,1-qlevL).  
<code>qlevL</code> must be increasing between (0,0.5).</p>
</td></tr>
<tr><td><code id="DRDensityPlot_+3A_xlim">xlim</code></td>
<td>
<p>Plot limits for the x-axis</p>
</td></tr>
<tr><td><code id="DRDensityPlot_+3A_ylim">ylim</code></td>
<td>
<p>Plot limits for the y-axis</p>
</td></tr>
<tr><td><code id="DRDensityPlot_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label </p>
</td></tr>
<tr><td><code id="DRDensityPlot_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function takes as input percentiles defining confidence 
intervals or Bayesian probability 
intervals at different levels (e.g. 5,95, 25,75) for distributions conditional
on a variable that is typically dose or time.  Regions defined by different
confidence/probability levels are represented by different levels of shading.
The input parameter, <code>qlevL</code>, is used only to define the input in the
matrices <code>qL</code> and <code>qH</code>.  The <code>qlevL</code> is not used for any numerical 
calculations, which must be done before executing the function.
</p>


<h3>Value</h3>

<p>Plotted output only.
</p>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>See Also</h3>

<p><code><a href="#topic+plotBdensity">plotBdensity</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
data('metaData')
exdat&lt;-metaData[metaData$taid==32,]

msSat&lt;-sum((exdat$sampsize-1)*(exdat$sd)^2)/(sum(exdat$sampsize)-length(exdat$sampsize))
fitout&lt;-fitEmax(exdat$rslt,exdat$dose,modType=3,count=exdat$sampsize,
								msSat=msSat)

dgrid&lt;-seq(0,100,length=100)
seout95&lt;-predict(fitout,dgrid,clev=0.95)
seout90&lt;-predict(fitout,dgrid,clev=0.9)
seout80&lt;-predict(fitout,dgrid,clev=0.8)
seout50&lt;-predict(fitout,dgrid,clev=0.5)

qlev&lt;-c(0.025,0.05,0.10,0.25)

qL&lt;-cbind(seout95$ubdif,seout90$ubdif,seout80$ubdif,seout50$ubdif)
qH&lt;-cbind(seout95$lbdif,seout90$lbdif,seout80$lbdif,seout50$lbdif)

DRDensityPlot(dgrid,qL,qH,qlevL=qlev,xlab='Dose',ylab='Diff with PBO')


## End(Not run)

</code></pre>

<hr>
<h2 id='emaxalt'> Fit 4- or 3-parameter Emax model substituting simpler curves
if convergence not achieved.</h2><span id='topic+emaxalt'></span>

<h3>Description</h3>

<p>ML estimation for 4- and 3-parmeter Emax model.  If the 4-parameter
model is requested, it is estimated and the 3-parameter model is fit
only if  the
4-parameter estimation fails.  If 3-parameter estimation fails, the
linear, log-linear, or exponential model producing the smallest
residual SS is substituted. For binary data, the model 
is fit on the logit scale and then back-transformed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emaxalt(y, dose, modType=3,binary=FALSE, 
	iparm=NA,ed50cutoff=2.5*max(doselev), 
	ed50lowcutoff=doselev[2]/1000,switchMod= TRUE,
	truncLambda=6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emaxalt_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="emaxalt_+3A_dose">dose</code></td>
<td>
<p>Doses corresponding to <code>y</code></p>
</td></tr>
<tr><td><code id="emaxalt_+3A_modtype">modType</code></td>
<td>
<p>When modType=4, the fitting begins with the 4
parameter model.  If estimation fails or modType=3, the 3-parameter
estimation is applied.  If it fails, a best-fitting model linear in
its parameters is selected.</p>
</td></tr>
<tr><td><code id="emaxalt_+3A_binary">binary</code></td>
<td>
<p>When specified, the Emax model is fit on the logit scale, and then
the results are back-transformed to proportions.</p>
</td></tr>
<tr><td><code id="emaxalt_+3A_iparm">iparm</code></td>
<td>
<p> Vector of optional initial values for the Emax fit. Starting 
values are computed if not specified. </p>
</td></tr>
<tr><td><code id="emaxalt_+3A_ed50cutoff">ed50cutoff</code></td>
<td>
<p> Upper allowed limit for ED50 estimates. </p>
</td></tr>
<tr><td><code id="emaxalt_+3A_ed50lowcutoff">ed50lowcutoff</code></td>
<td>
<p>Lower allowed limit for the ED50 estimates.</p>
</td></tr>
<tr><td><code id="emaxalt_+3A_switchmod">switchMod</code></td>
<td>
<p>If switchMod is TRUE, the algorithm substitutes a
simpler model if (1) convergence is not achieved, (2) the information
matrix is not positive definite at the converged values, (3) the ED50
estimates are outside the cutoff bounds.  If switchMod is F, only
conditions (1) or (2) cause a simpler model to be used.</p>
</td></tr>
<tr><td><code id="emaxalt_+3A_trunclambda">truncLambda</code></td>
<td>
<p>When <code>modType=4</code> and the converged estimate of
the Hill parameter lambda exceeds <code>truncLambda</code>, the model fit
is judged unstable and discarded.  Set <code>truncLambda=Inf</code> for 
no truncation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The partial linear method is used in nls.  If it fails, gauss-newton
is attempted.  If both methods fail, the next simpler model is
attempted.  For the 4-parameter model, the next step is the
3-parameter model. For the 3-parameter model, a linear, log-linear
log(dose+1.0), and exp(dose/max(dose)) are fit using lm, and the
2-parm fit with the smallest residual SS is selected.  
</p>


<h3>Value</h3>

<p>A list assigned class &quot;emaxalt&quot; with the following elements:
</p>
<table>
<tr><td><code>dm</code></td>
<td>
<p>Vector containing dose group means</p>
</td></tr>
<tr><td><code>dsd</code></td>
<td>
<p>Vector containing dose group SDs</p>
</td></tr>
<tr><td><code>Sparm</code></td>
<td>
<p>Vector of starting values for 3-parameter Emax fit.</p>
</td></tr>
<tr><td><code>fitType</code></td>
<td>
<p>Character vector with &quot;4&quot;, &quot;3&quot;, &quot;L&quot;, &quot;LL&quot;, or &quot;E&quot; for
4-Emax, 3-Emax, linear,
log-linear, or exponential when an alternative model is selected.</p>
</td></tr>
<tr><td><code>vc</code></td>
<td>
<p>The variance-covariance matrix of the model parameters
stored as a vector.  The length is 16, 9, 4 depending on fitType.</p>
</td></tr>
<tr><td><code>fitpred</code></td>
<td>
<p>Dose groups means
estimated from the model</p>
</td></tr>
<tr><td><code>residSD</code></td>
<td>
<p>The residual SD based on the selected model.</p>
</td></tr>
<tr><td><code>sepred</code></td>
<td>
<p>SEs for estimates in
fitpred</p>
</td></tr>
<tr><td><code>sedif</code></td>
<td>
<p>SEs for model-based estimates of difference with
placebo</p>
</td></tr>
<tr><td><code>bigC</code></td>
<td>
<p>bigC= TRUE if the primary fit (from modType) yielded an 
ED50 &gt;ED50 upper limit.</p>
</td></tr>
<tr><td><code>negC</code></td>
<td>
<p>negC= TRUE if the primary fit (from modType) yielded a
ED50 estimate &lt; ED50 lower limit.</p>
</td></tr>
<tr><td><code>est4</code></td>
<td>
<p> 4-parmameter Emax fit (ed50,lambda,emax,e0).  NA if
failed to converge or 3-parameter model requested.</p>
</td></tr>
<tr><td><code>est3</code></td>
<td>
<p> 3-parmameter Emax fit (ed50,emax,e0).  NA if
failed to converge or 4-parameter model successfully fit.</p>
</td></tr>
<tr><td><code>estA</code></td>
<td>
<p>Alternative parameter estimates.  NA if
Emax model fit successfully</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

 <p><code><a href="#topic+emaxsim">emaxsim</a></code>, <code><a href="stats.html#topic+nls">nls</a> </code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
save.seed&lt;-.Random.seed
set.seed(12357)

doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)
dose&lt;-rep(doselev,n)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop&lt;-c(log(ed50),emax,e0)    
meanresp&lt;-emaxfun(dose,pop)  
y&lt;-rnorm(sum(n),meanresp,sdy)

simout&lt;-emaxalt(y,dose)

simout2&lt;-emaxalt(y,dose,modType=4)

.Random.seed&lt;-save.seed
</code></pre>

<hr>
<h2 id='emaxfun'> Vectorized versions of the hyperbolic and sigmoidal Emax models </h2><span id='topic+emaxfun'></span>

<h3>Description</h3>

<p>Evaluate Emax models for a vector of dose levels for multiple sets
of parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emaxfun(dose, parm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emaxfun_+3A_dose">dose</code></td>
<td>
<p> A vector (or scalar) of dose levels </p>
</td></tr>
<tr><td><code id="emaxfun_+3A_parm">parm</code></td>
<td>
<p>A vector or matrix with columns containing
<code>log(ed50)</code>, Hill parameter if sigmoid model,
<code>emax</code>,<code>e0</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Hill parameter is omitted from <code>parm</code> for the hyperbolic model
</p>


<h3>Value</h3>

<p>Returns a matrix of Emax function evaluations.  The rows correspond to the
parameter replications, and the columns correspond to the dose levels.</p>


<h3>Note</h3>

<p>The ordering of the parameters was selected to faciliate use of
the 'plinear' algorithm in function nls.
</p>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+dlogis">dlogis</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
doselev&lt;-c(0,5,25,50,100)
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
lambda=2
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),lambda,e0)

parm&lt;-c(log(ed50),lambda,emax,e0)
plot(doselev,emaxfun(doselev,parm))

</code></pre>

<hr>
<h2 id='emaxPrior.control'>
Set the parameters of the prior distribution for the Emax model implemented in <code>fitEmaxB</code>.
</h2><span id='topic+emaxPrior.control'></span>

<h3>Description</h3>

<p>Set the parameters of the prior distribution for the Emax model implemented in <code>fitEmaxB.</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emaxPrior.control(epmu=NULL,epsca=NULL,
	difTargetmu=NULL,difTargetsca=NULL,
	dTarget=NULL,p50=NULL,
	sigmalow=NULL,sigmaup=NULL,
	effDF=parmDF,parmDF=5,
	loged50mu=0.0,loged50sca=1.73,
	loglammu=0.0,loglamsca=0.425,parmCor=-0.45,
	lowled50=log(0.001),highled50=log(1000),
	lowllam=log(0.3),highllam=log(4.0),
	basemu=NULL,basevar=NULL,binary=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emaxPrior.control_+3A_epmu">epmu</code></td>
<td>

<p>Mean for <code>E0</code> in a t-prior distribution.  Logistic scale for binary data.
</p>
</td></tr>
<tr><td><code id="emaxPrior.control_+3A_epsca">epsca</code></td>
<td>

<p>The scale parameter for <code>E0</code> in a t-prior distribution.  Logistic scale for binary data.
</p>
</td></tr>
<tr><td><code id="emaxPrior.control_+3A_diftargetmu">difTargetmu</code></td>
<td>

<p>Mean for the prior distribution of the effect at dose <code>dTarget</code> versus placebo.
Logistic scale for binary data. 
</p>
</td></tr>
<tr><td><code id="emaxPrior.control_+3A_diftargetsca">difTargetsca</code></td>
<td>

<p>The scale parameter for the prior distribution of the effect at dose <code>dTarget</code> versus placebo.
Logistic scale for binary data.  
</p>
</td></tr>
<tr><td><code id="emaxPrior.control_+3A_dtarget">dTarget</code></td>
<td>
<p>Target dose for prior effect.  Typically the highest dose planned
and/or the proof-of-concept dose.</p>
</td></tr>
<tr><td><code id="emaxPrior.control_+3A_p50">p50</code></td>
<td>

<p>Projected <code>ED50</code>.  See references for its use in creating the prior distribution for the <code>ED50</code>.
</p>
</td></tr>
<tr><td><code id="emaxPrior.control_+3A_sigmalow">sigmalow</code></td>
<td>

<p>Lower bound for a uniform prior distribution for the residual SD (continuous data).
</p>
</td></tr>
<tr><td><code id="emaxPrior.control_+3A_sigmaup">sigmaup</code></td>
<td>

<p>Upper bound for a uniform prior distribution for the residual SD (continuous data).  
</p>
</td></tr>
<tr><td><code id="emaxPrior.control_+3A_effdf">effDF</code></td>
<td>
<p>The degrees of freedom for the prior distributions for the <code>placebo</code>
and <code>difTarget</code> parameters.  If a vector of length 2 is specified, the first value is the
degrees of freedom for <code>placebo</code> and the second for <code>difTarget</code>.</p>
</td></tr>
<tr><td><code id="emaxPrior.control_+3A_parmdf">parmDF</code></td>
<td>

<p>The degrees of freedom of the bivariate log-t prior distribution for the <code>ED50</code> and <code>lambda</code> parameters.  
</p>
</td></tr>
<tr><td><code id="emaxPrior.control_+3A_loged50mu">loged50mu</code></td>
<td>

<p>Mean of prior t-distribution for the <code>log(ED50/P50)</code>.  See references for 
its default value and interpretation.
</p>
</td></tr>
<tr><td><code id="emaxPrior.control_+3A_loged50sca">loged50sca</code></td>
<td>

<p>Scale (analogous to SD) of the prior t-distribution for the <code>log(ED50/P50)</code>.  
</p>
</td></tr>
<tr><td><code id="emaxPrior.control_+3A_loglammu">loglammu</code></td>
<td>

<p>Mean of prior t-distribution for the Hill parameter lambda.  See 
references for its default value and interpretation.
</p>
</td></tr>
<tr><td><code id="emaxPrior.control_+3A_loglamsca">loglamsca</code></td>
<td>

<p>Scale (analogous to SD) of the prior t-distribution for the Hill 
parameter lambda.  
</p>
</td></tr>
<tr><td><code id="emaxPrior.control_+3A_parmcor">parmCor</code></td>
<td>
<p>Correlation for the bivariate log-t prior distribution for the <code>ED50</code> and <code>lambda</code> parameters.</p>
</td></tr>
<tr><td><code id="emaxPrior.control_+3A_lowled50">lowled50</code>, <code id="emaxPrior.control_+3A_highled50">highled50</code>, <code id="emaxPrior.control_+3A_lowllam">lowllam</code>, <code id="emaxPrior.control_+3A_highllam">highllam</code></td>
<td>
<p>Bounds applied to the prior distributions for the
log(ED50/P50) and log(lambda).  The original (unbounded) priors are modified
to be conditional on being within the bounds.  This is done for numerical
stability and plausibility of the parameter values</p>
</td></tr>
<tr><td><code id="emaxPrior.control_+3A_basemu">basemu</code></td>
<td>

<p>A vector of prior means for the covariate regression parameters.
</p>
</td></tr>
<tr><td><code id="emaxPrior.control_+3A_basevar">basevar</code></td>
<td>

<p>The prior variance-covariance matrix for the covariate regression parameters.
The covariate regression parameters are a priori independent of the other dose 
response model parameters.
</p>
</td></tr>
<tr><td><code id="emaxPrior.control_+3A_binary">binary</code></td>
<td>

<p>Set to <code>TRUE</code> for binary data applications.  Used to check for consistency in usage.  The default is <code>FALSE</code></p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The prior distribution is based on meta-analyses of dose 
response described in the references.  
The E0 and difTarget parameters have independent t-distribution prior 
distributions.  For binary data, these
parameters are computed on the logistic scale.  The prior means and scales
of these parameters must be assigned compound-specific values.  
The predicted ED50 at the study design stage must must also be
specified as 'P50'.   For
continuous data, the prior distribution for the residual SD is uniform on a 
user-specifed scale.
</p>
<p>The prior distribution of the log(ED50) has a t-distribution
centered at log(P50), with scale, degrees of freedom (parmDF), 
and offset to the P50, 
defaulting to values given in the references (these can be changed, but they
are difficult to interpret outside the context of the meta-analyses).  
If <code>modType=4</code>, the prior distribution for the Hill parameter
is also t-distribution with parmDF degrees of freedom and corParm
correlation with the log(ED50). 
</p>


<h3>Value</h3>

<p>List of class <code>emaxPrior</code> of prior parameter values for use in
<code>fitEmaxB</code>.	<code>default</code> is a derived variable set to
<code>TRUE</code> when the default values are used for <code>loged50</code> 
and <code>loglambda</code>.
</p>


<h3>Author(s)</h3>

<p>Neal Thomas
</p>


<h3>References</h3>

<p>Thomas, N., Sweeney, K., and Somayaji, V. (2014).  Meta-analysis of clinical dose response in a large drug development portfolio, Statistics in Biopharmaceutical Research, Vol. 6, No.4, 302-317.
&lt;doi:10.1080/19466315.2014.924876&gt;
</p>
<p>Thomas, N., and Roy, D. (2016).  Analysis of clinical dose-response in small-molecule drug development:  2009-2014. Statistics in Biopharmaceutical Research, Vol. 6, No.4, 302-317
&lt;doi:10.1080/19466315.2016.1256229&gt;
</p>
<p>Wu, J., Banerjee, A., Jin, B., Menon, S., Martin, S., and 
Heatherington, A. (2017).  Clinical dose-response for a broad set of 
biological products: A model-based meta-analysis. Vol. 9, 2694-2721.   
&lt;doi:10.1177/0962280216684528?&gt;
</p>


<h3>See Also</h3>

<p><code>fitEmaxB</code>
</p>

<hr>
<h2 id='emaxsim'>Simulate Emax maximum likelihood estimation</h2><span id='topic+emaxsim'></span>

<h3>Description</h3>

<p>Simulate dose response data and apply 4- or 3- parameter Emax MLE
estimation.  For binary data, the model is fit on the logit scale
and then back-transformed.  When
MLE estimation fails, models with fewer parameters (including models
linear in their parameters) are substituted.  Summaries of estimation
performance are returned for further analyses.  An MCP-MOD test is
also performed for each simulated data set.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emaxsim(
	nsim, 
	genObj, 
	modType=3,
	binary=FALSE,
	seed=12357,
	nproc = parallel::detectCores(),
	negEmax=FALSE,
	ed50contr=NULL,
	lambdacontr=NULL,
	testMods=NULL,
	idmax=length(doselev), 
	iparm=NA,
	ed50cutoff=2.5*max(doselev), 
	ed50lowcutoff=doselev[2]/1000,
	switchMod= TRUE,
	truncLambda=6,
	description="")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emaxsim_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulation replications</p>
</td></tr>
<tr><td><code id="emaxsim_+3A_genobj">genObj</code></td>
<td>
<p> Object containing inputs and function to create simulated  
data sets.  These objects are created by special constructor
functions; the current choices are <code><a href="#topic+FixedMean">FixedMean</a></code> and <code><a href="#topic+RandEmax">RandEmax</a></code>.
</p>
</td></tr>
<tr><td><code id="emaxsim_+3A_modtype">modType</code></td>
<td>
<p>When modType=4, the fitting begins with the 4
parameter model.  If estimation fails or modType=3, the 3-parameter estimation
is applied.  If it fails, a best-fitting model linear in its parameters is
selected.</p>
</td></tr>
<tr><td><code id="emaxsim_+3A_binary">binary</code></td>
<td>
<p>When specified, the Emax model is fit on the logit scale, and then
the results are back-transformed to proportions.</p>
</td></tr>
<tr><td><code id="emaxsim_+3A_seed">seed</code></td>
<td>
<p>Seed for random number generator used to create data.</p>
</td></tr> 
<tr><td><code id="emaxsim_+3A_nproc">nproc</code></td>
<td>
<p>The number of processors to use in parallel computation of the
simulations, which are divided into equal-sized computational blocks.  When <code>nproc=1</code>
a single local processor.</p>
</td></tr>
<tr><td><code id="emaxsim_+3A_negemax">negEmax</code></td>
<td>
<p>When <code>TRUE</code>, the intended effect is assumed to be negative.</p>
</td></tr>
<tr><td><code id="emaxsim_+3A_ed50contr">ed50contr</code></td>
<td>
<p>A vector of ED50 values for creating a global null test using the
MCP-MOD package DoseFinding based on Emax model-based contrasts.
The default is 3 contrasts: the mid-point between pbo and the lowest
dose, the mid-point between the 2 highest doses, and the 
median of the dose levels.  When there are &lt;=4 doses including pbo,
the median-based contrast is excluded.</p>
</td></tr>
<tr><td><code id="emaxsim_+3A_lambdacontr">lambdacontr</code></td>
<td>
<p>Hill parameters matched to the ed50contr.  The default value is 1
for each contrast model.</p>
</td></tr>
<tr><td><code id="emaxsim_+3A_testmods">testMods</code></td>
<td>
<p>The model object for a MCP-MOD test
created by <code><a href="DoseFinding.html#topic+Mods">Mods</a></code> from package <code>DoseFinding</code>.  If 
specified, the other contrast inputs are ignored.  The  <code><a href="DoseFinding.html#topic+Mods">Mods</a></code> 
call should
use the unique sorted dose levels.  The direction of the trend should be specificed in the call to <code><a href="DoseFinding.html#topic+Mods">Mods</a></code>.  The <code>negEmax</code> is stored for use by support functions, but it does not determine the direction of the effect when <code>testMods</code> is specified.  The validity of
<code>testMods</code> is not checked.</p>
</td></tr>
<tr><td><code id="emaxsim_+3A_idmax">idmax</code></td>
<td>
<p>Index of the default dose group for comparison to placebo.  
Most analysis functions allow other dose groups to be
specified.  The default is the index of the highest dose.</p>
</td></tr>
<tr><td><code id="emaxsim_+3A_iparm">iparm</code></td>
<td>
<p>Starting values for the  Emax fit.  If
unspecified, starting values are computed.  The
order of the variables is (log(ED50),Emax,E0) or
(log(ED50),lambda,Emax,E0).  Note the transformation of ED50.</p>
</td></tr>
<tr><td><code id="emaxsim_+3A_ed50cutoff">ed50cutoff</code></td>
<td>
<p>The upper limit for the ED50 parameter estimates.The default is large
enough to ensure a near linear fit to the data from an 
Emax model.</p>
</td></tr>
<tr><td><code id="emaxsim_+3A_ed50lowcutoff">ed50lowcutoff</code></td>
<td>
<p>Lower allowed limit for the ED50 estimates.</p>
</td></tr>
<tr><td><code id="emaxsim_+3A_switchmod">switchMod</code></td>
<td>
<p>If switchMod is TRUE, the algorithm substitutes a
simpler model if (1) convergence is not achieved, (2) the information
matrix is not positive definite at the converged values, (3) the ED50
estimates are outside the cutoff bounds.  If switchMod is F, only
conditions (1) or (2) cause a simpler model to be used.</p>
</td></tr>
<tr><td><code id="emaxsim_+3A_trunclambda">truncLambda</code></td>
<td>
<p>When <code>modType=4</code> and the converged estimate of
the Hill parameter lambda exceeds <code>truncLambda</code>, the model fit
is judged unstable and discarded.  Set <code>truncLambda=Inf</code> for 
no truncation.  Four parameter model fits are also discarded
when lambda is less than 0.1.</p>
</td></tr>
<tr><td><code id="emaxsim_+3A_description">description</code></td>
<td>
<p>Optional text describing the simulation setting that
is stored with the simulation output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Continuous data can be simulated from any dose response curve with homogeneous
normally distributed residuals. The estimation procedure starts with
ML estimation of a 4- or 3- parameter Emax model depending on modType.
If modType=3 or 4-parameter estimation fails, a 3 parameter Emax model is fit by
maximum likelihood non-linear least squares.  If 1) nls fails to converge for a 3 parameter Emax model, 2) the
ED50 estimate is &lt;=0, or 3) the ED50 estimate exceeds ed50cutoff, a
linear, log-linear (offset of 1.0), or scaled exponental
(exp(dose/max(dose))), is fit using simple linear least squares
estimation.  The model selected has the smallest residual SS.    
</p>
<p>Binary data are handled similarly using maximum likelihood implemented
with the nlm function.  The models are fit on the logit scale and then 
back-transformed for estimation of dose response.  Reduced linear models are 
selected based on the corresponding likelihood deviance.  
</p>
<p>MCP-MOD tests are created from contrasts based on the Emax function using 
the <code>DoseFinding</code> package.  Different
ED50 and lambda (Hill) parameters can be specified to form the contrasts. A contrast
matrix output from the DoseFinding package can be specified instead, allowing for
other contrast choices.  
</p>


<h3>Value</h3>

<p>A list is returned with class(emaxsim) containing:
</p>
<table>
<tr><td><code>description</code></td>
<td>
<p>User description of simulation</p>
</td></tr>
<tr><td><code>binary</code></td>
<td>
<p>Binary response data.</p>
</td></tr>
<tr><td><code>modType</code></td>
<td>
<p>User supplied starting Emax model</p>
</td></tr>
<tr><td><code>genObj</code></td>
<td>
<p>List object with data and function used to generate study
data</p>
</td></tr>
<tr><td><code>pop</code></td>
<td>
<p>Matrix with rows containing population parameters
for each simulation.  Type of parameter depends on
constructor function generating study data.</p>
</td></tr>
<tr><td><code>popSD</code></td>
<td>
<p>Vector containing the population SD used to generate
continuous data.  <code>NULL</code> for binary data.</p>
</td></tr>
<tr><td><code>init</code></td>
<td>
<p>Matrix with rows containing the starting Emax parameters
for each simulation</p>
</td></tr>
<tr><td><code>est4</code></td>
<td>
<p>Matrix with 4 parmameter Emax fit.  NA if failed to
converge or modType=3</p>
</td></tr>
<tr><td><code>est3</code></td>
<td>
<p>Matrix with 3 parmameter Emax fit.  NA if failed to
converge or 4-parameter estimation was successful.</p>
</td></tr>
<tr><td><code>estA</code></td>
<td>
<p>Matrix with alternative parameter estimates.  NA if
Emax model fit successfully</p>
</td></tr>
<tr><td><code>vc</code></td>
<td>
<p>Variance-covariance matrix for the
estimated parameters stored as a
vector for each simulation.  The vc vector stored has 16,9, or 4
elements 
depending on fitType (with NA values on the end if elements are unused).</p>
</td></tr>
<tr><td><code>residSD</code></td>
<td>
<p>The residual SD based on the selected model.</p>
</td></tr>
<tr><td><code>fitType</code></td>
<td>
<p>Character vector with &quot;4&quot;, &quot;3&quot;, &quot;L&quot;, &quot;LL&quot;, or &quot;E&quot; for
4-Emax, 3-Emax, linear,
log-linear, or exponential when an alternative model is selected.</p>
</td></tr>
<tr><td><code>pVal</code></td>
<td>
<p>The <code>nsim</code> p-values from the global null test.  The p-values are 
1-sided computed using MCP-Mod.</p>
</td></tr>
<tr><td><code>selContrast</code></td>
<td>
<p>The index of the test contrast producing the smallest p-value.</p>
</td></tr>
<tr><td><code>testMods</code></td>
<td>
<p>Object of class Mods from R package <code>DoseFinding</code> that defines
the contrasts used in MCP-MOD testing.  The functions can be plotted with
<code>DoseFinding</code> loaded.</p>
</td></tr>
<tr><td><code>negEmax</code></td>
<td>
<p>User input stored for subsequent reference.</p>
</td></tr>
<tr><td><code>ed50cutoff</code></td>
<td>
<p>Upper allowed limit for ED50 estimates</p>
</td></tr>
<tr><td><code>ed50lowcutoff</code></td>
<td>
<p>Lower allowed limit for the ED50 estimates.</p>
</td></tr>
<tr><td><code>switchMod</code></td>
<td>
<p>If switchMod is TRUE, the algorithm substitutes a
simpler model if (1) convergence is not achieved, (2) the information
matrix is not positive definite at the converged values, (3) the ED50
estimates are outside the cutoff bounds.  If switchMod is F, only
conditions (1) or (2) cause a simpler model to be used.</p>
</td></tr>
<tr><td><code>negC</code></td>
<td>
<p>negC=TRUE if the primary fit (from modType) yielded a
ED50 estimate &lt; ED50 lower limit.</p>
</td></tr>
<tr><td><code>bigC</code></td>
<td>
<p>bigC=TRUE if the primary fit (from modType) yielded an 
ED50&gt; ED50 upper limit.</p>
</td></tr>
<tr><td><code>predpop</code></td>
<td>
<p>Matrix with population means for each dose group</p>
</td></tr>
<tr><td><code>mv</code></td>
<td>
<p>Matrix with rows containing dose group sample means</p>
</td></tr>
<tr><td><code>sdv</code></td>
<td>
<p>Matrix with rows containing dose group sample SD</p>
</td></tr>
<tr><td><code>fitpredv</code></td>
<td>
<p>Matrix with rows containing dose groups means
estimated from the model</p>
</td></tr>
<tr><td><code>sepredv</code></td>
<td>
<p>Matrix with rows containing SE for fitpredv</p>
</td></tr>
<tr><td><code>sedifv</code></td>
<td>
<p>Matrix with rows containing SE for model-based
differences with placebo</p>
</td></tr>
<tr><td><code>rseed</code></td>
<td>
<p>Starting random
number seed for each simulated data set set that can be assigned to <code>.Random.seed</code>.
To reproduce the data, the random number generator must also be changed to
<code>RNGkind("L'Ecuyer-CMRG")</code>.</p>
</td></tr>
<tr><td><code>idmax</code></td>
<td>
<p>Index of default dose group for comparison to placebo
(e.g., for plotting Z-statistics).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>See Also</h3>

  <p><code><a href="#topic+print.emaxsim">print.emaxsim</a></code>, 
<code><a href="#topic+summary.emaxsim">summary.emaxsim</a></code>, <code><a href="#topic+plot.emaxsim">plot.emaxsim</a></code>, 
<code><a href="#topic+coef.emaxsim">coef.emaxsim</a></code>, <code><a href="#topic+sigma.emaxsim">sigma.emaxsim</a></code>,
<code><a href="#topic+vcov.emaxsim">vcov.emaxsim</a></code>, <code><a href="#topic+predict.emaxsim">predict.emaxsim</a></code>,
<code><a href="#topic+emaxfun">emaxfun</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
## emaxsim changes the random number seed
nsim&lt;-50
idmax&lt;-5
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)
Ndose&lt;-length(doselev)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-2.464592
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop)  

###FixedMean is specialized constructor function for emaxsim
gen&lt;-FixedMean(n,doselev,meanlev,sdy)  

D1 &lt;- emaxsim(nsim,gen,modType=3)
summary(D1,testalph=0.05)

D4 &lt;- emaxsim(nsim,gen,modType=4)
summary(D4,testalph=0.05)

## End(Not run)

</code></pre>

<hr>
<h2 id='emaxsimB'>
Simulate Emax Bayesian estimation
</h2><span id='topic+emaxsimB'></span>

<h3>Description</h3>

<p>Simulate dose response data and apply 4- or 3- parameter
sigmoidal or hyperbolic Bayesian estimation.  The prior distribution
is input by the user with default values for some parameters based on the empirical distribution estimated
from dose response meta-analyses.  For binary response data, the Emax
model is fit on the logit scale, and then back-transformed</p>


<h3>Usage</h3>

<pre><code class='language-R'>emaxsimB(nsim, genObj, prior, modType = 4, 
	binary = FALSE, seed=12357,
	check = FALSE, nproc=parallel::detectCores(), 
	negEmax = FALSE, ed50contr = NULL, 
	lambdacontr = NULL, testMods = NULL, 
	idmax = length(doselev), 
	mcmc = mcmc.control(), 
	customCode=NULL, customParms=NULL,
	description = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emaxsimB_+3A_nsim">nsim</code></td>
<td>

<p>Number of simulation replications
</p>
</td></tr>
<tr><td><code id="emaxsimB_+3A_genobj">genObj</code></td>
<td>

<p>Object containing inputs and function to create simulated  
data sets.  These objects are created by special constructor
functions; the current choices are <code><a href="#topic+FixedMean">FixedMean</a></code> and <code><a href="#topic+RandEmax">RandEmax</a></code>.
</p>
</td></tr>
<tr><td><code id="emaxsimB_+3A_prior">prior</code></td>
<td>
<p>Prior specification through an object of type 'emaxPrior' or 'prior'.  
See <code><a href="#topic+emaxPrior.control">emaxPrior.control</a></code> and <code><a href="#topic+prior.control">prior.control</a></code> for details.  
The 'emaxPrior' specifies
the magnitude of the potential effect for a specified dose (typically the highest
anticipated dose and/or the dose in a POC study), while the 'prior' specifies the
theoretical maximum effect (the emax parameter).  The 'prior' specification is 
deprecated and will be removed.</p>
</td></tr>
<tr><td><code id="emaxsimB_+3A_modtype">modType</code></td>
<td>
<p>When <code>modType=3</code>, a hyperbolic Emax model is fit.  
When <code>modType=4</code>, a sigmoid Emax model is fit.</p>
</td></tr>
<tr><td><code id="emaxsimB_+3A_binary">binary</code></td>
<td>

<p>When specified, the Emax model is fit on the logit scale, and then
the results are back-transformed to proportions.
</p>
</td></tr>
<tr><td><code id="emaxsimB_+3A_seed">seed</code></td>
<td>
<p>Seed for random number generator used to create data.  A separate
seed can be passed to <code>rstan</code> through the <code>MCMC</code> object.</p>
</td></tr>
<tr><td><code id="emaxsimB_+3A_check">check</code></td>
<td>

<p>When <code>TRUE</code>, a single simulated data set is created and the data
and <code>rstan</code> object are returned for convergence checking.  The data
are in the form needed for developing <code>customCode</code>.  Note that
<code>customCode</code> is not called when <code>check=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="emaxsimB_+3A_nproc">nproc</code></td>
<td>
<p>The number of processors to use in parallel computation of the
simulations, which are divided into equal-sized computational blocks.  When <code>nproc=1</code>
a single local processor.</p>
</td></tr>
<tr><td><code id="emaxsimB_+3A_negemax">negEmax</code></td>
<td>

<p>When <code>TRUE</code>, the intended effect is assumed to be negative.
</p>
</td></tr>
<tr><td><code id="emaxsimB_+3A_ed50contr">ed50contr</code></td>
<td>
<p>A vector of ED50 values for creating a global null test using the
MCP-MOD package DoseFinding based on Emax model-based contrasts.
The default is 3 contrasts: the mid-point between pbo and the lowest
dose, the mid-point between the 2 highest doses, and the 
median of the dose levels.  When there are &lt;=4 doses including pbo,
the median-based contrast is excluded.</p>
</td></tr>
<tr><td><code id="emaxsimB_+3A_lambdacontr">lambdacontr</code></td>
<td>
<p>Hill parameters matched to the ed50contr.  The default value is 1
for each contrast model.</p>
</td></tr>
<tr><td><code id="emaxsimB_+3A_testmods">testMods</code></td>
<td>
<p>The model object for a MCP-MOD test
created by <code><a href="DoseFinding.html#topic+Mods">Mods</a></code> from package DoseFinding.  If 
specified, the other contrast inputs are ignored.  The  <code><a href="DoseFinding.html#topic+Mods">Mods</a></code> 
call should
use the unique sorted dose levels.  The direction of the trend should be specificed in the call to <code><a href="DoseFinding.html#topic+Mods">Mods</a></code>.  The <code>negEmax</code> is stored for use by support functions, but it does not determine the direction of the effect when <code>testMods</code> is specified.  The validity of
<code>testMods</code> is not checked.</p>
</td></tr>
<tr><td><code id="emaxsimB_+3A_idmax">idmax</code></td>
<td>
<p>Index of the default dose group for comparison to placebo.  
Most analysis functions allow other dose groups to be
specified.  The default is the index of the highest dose.</p>
</td></tr>
<tr><td><code id="emaxsimB_+3A_mcmc">mcmc</code></td>
<td>

<p>MCMC settings created using <code><a href="#topic+mcmc.control">mcmc.control</a></code>
</p>
</td></tr>
<tr><td><code id="emaxsimB_+3A_customcode">customCode</code></td>
<td>
<p>An optional user supplied function that computes custom
estimates/decision criteria from each simulated data set and its Bayesian
model fit.  The output are stored in a list, <code>customOut</code>, of length
<code>nsim</code>.  See the Details section below for a description of the
mandatory inputs to the <code>customCode</code> function.
</p>
</td></tr>
<tr><td><code id="emaxsimB_+3A_customparms">customParms</code></td>
<td>
<p>Optional parameters that can be passed to 
<code>customCode</code>.</p>
</td></tr>
<tr><td><code id="emaxsimB_+3A_description">description</code></td>
<td>

<p>Optional text describing the simulation setting that
is stored with the simulation output.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Bayesian model fits are implemented in <code>rstan</code> using function
<code><a href="#topic+fitEmaxB">fitEmaxB</a></code>.  The function <code>compileStanModels</code> must be 
executed once to create compiled STAN
code before <code>emaxsimB</code> can be used.
</p>
<p>Continuous data can be simulated from any dose response curve with homogeneous
normally distributed residuals.
</p>
<p>Binary data are handled similarly.  The models are fit on the logit scale and then 
back-transformed for estimation of dose response.  Reduced linear models are 
selected based on the corresponding likelihood deviance.  
</p>
<p>MCP-MOD tests are created from contrasts based on the Emax function using
the <code>DoseFinding</code> package.  Different
ED50 and lambda (Hill) parameters can be specified to form the contrasts. A contrast
matrix output from the DoseFinding package can be specified instead, allowing for
other contrast choices.  
</p>
<p>Customized code:
</p>
<p>For binary data, the inputs to the function customCode for each simulated data set
will be (parms,pVal,dose,y), where parms is the matrix of parameters
generated from the posterior distribution with columns in the order given in
function <code><a href="#topic+emaxfun">emaxfun</a></code>, pVal is the MCP-MOD p-value, dose and y are
the patient-level simulated data.  For continuous data, the inputs
are (parms,residSD,pVal,dose,y), where <code>residSD</code> are the variance
parameters generated from their posterior distribution.  The <code>customParms</code> supply other user-inputs 
such as a target efficacy level.  When it is not null, the <code>customCode</code>
inputs must be (parms,pVal,dose,y,customParms) or (parms,residSD,pVal,dose,y,customParms).
</p>


<h3>Value</h3>

<p>A list is returned with class(emaxsim) containing:
</p>
<table>
<tr><td><code>description</code></td>
<td>
<p>User description of simulation</p>
</td></tr>
<tr><td><code>localParm</code></td>
<td>
<p><code>localParm=TRUE</code> when the prior 
prior distribution is input using <code>emaxPrior</code>.</p>
</td></tr>
<tr><td><code>binary</code></td>
<td>
<p>Binary response data.</p>
</td></tr>
<tr><td><code>modType</code></td>
<td>
<p>Type of Emax model fit (3 or 4 parameters)</p>
</td></tr>
<tr><td><code>genObj</code></td>
<td>
<p>List object with data and function used to generate study
data</p>
</td></tr>
<tr><td><code>pop</code></td>
<td>
<p>Matrix with rows containing population parameters
for each simulation.  Type of parameter depends on
constructor function generating study data.</p>
</td></tr>
<tr><td><code>popSD</code></td>
<td>
<p>Vector containing the population SD used to generate
continuous data.  <code>NULL</code> for binary data.</p>
</td></tr>
<tr><td><code>mcmc</code></td>
<td>
<p>mcmc input settings</p>
</td></tr>
<tr><td><code>prior</code></td>
<td>
<p>Input prior distribution.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>Matrix with posterior median parameter estimates for each simulation:
(led50,lambda,emax,e0,difTarget) or (led50,emax,e0,difTarget).  The <code>difTarget</code> are
omitted for the deprecated distribution.</p>
</td></tr>
<tr><td><code>estlb</code>, <code>estub</code></td>
<td>
<p>Array with lower posterior (0.025,0.05,0.1) and upper posterior
(0.975,0.95,0.9) percentiles of the model parameters.  The array ordering is model parameters, simulation, and percentile.</p>
</td></tr>
<tr><td><code>residSD</code></td>
<td>
<p>The posterior median of the residual SD for each simulation.</p>
</td></tr>
<tr><td><code>pVal</code></td>
<td>
<p>The <code>nsim</code> p-values from the global null test.  The p-values are 
1-sided computed using MCP-Mod.</p>
</td></tr>
<tr><td><code>selContrast</code></td>
<td>
<p>The index of the test contrast producing the smallest p-value.</p>
</td></tr>
<tr><td><code>testMods</code></td>
<td>
<p>Object of class Mods from R package <code>DoseFinding</code> that defines
the contrasts used in MCP-MOD testing.  The functions can be plotted with
<code>DoseFinding</code> loaded.</p>
</td></tr>	
<tr><td><code>gofP</code></td>
<td>
<p>Goodness of fit test computed by <code>checkMonoEmax</code>.</p>
</td></tr>
<tr><td><code>negEmax</code></td>
<td>
<p>User input stored for subsequent reference.</p>
</td></tr>
<tr><td><code>predpop</code></td>
<td>
<p>Matrix with population means for each dose group</p>
</td></tr>
<tr><td><code>mv</code></td>
<td>
<p>Matrix with rows containing dose group sample means</p>
</td></tr>
<tr><td><code>sdv</code></td>
<td>
<p>Matrix with rows containing dose group sample SD</p>
</td></tr>
<tr><td><code>msSat</code></td>
<td>
<p>Pooled within-dose group sample variance</p>
</td></tr>
<tr><td><code>fitpredv</code></td>
<td>
<p>Matrix with rows containing dose groups means
estimated by the posterior medians of the MCMC generated values.</p>
</td></tr>
<tr><td><code>sepredv</code></td>
<td>
<p>Matrix with rows containing SE (posterior SD) associated with fitpredv</p>
</td></tr>
<tr><td><code>fitdifv</code></td>
<td>
<p>Matrix with rows containing dose groups mean
differences wih placebo
estimated by the posterior medians of the differences of the MCMC generated values.</p>
</td></tr>
<tr><td><code>sedifv</code></td>
<td>
<p>Matrix with rows containing SE (posterior SD) for the 
differences with placebo</p>
</td></tr>
<tr><td><code>lb</code>, <code>ub</code></td>
<td>
<p>Array with lower posterior (0.025,0.05,0.1) and upper posterior
(0.975,0.95,0.9) percentiles of differences between dose group means and 
placebo.  The array ordering is dose group minus placebo, simulation, and percentile.</p>
</td></tr>
<tr><td><code>divergence</code></td>
<td>
<p>The proportion of divergent MCMC iterations from each simulated analysis.</p>
</td></tr>
<tr><td><code>rseed</code></td>
<td>
<p>Starting random
number seed for each simulated data set set that can be assigned to <code>.Random.seed</code>.
To reproduce the data, the random number generator must also be changed to
<code>RNGkind("L'Ecuyer-CMRG")</code>.</p>
</td></tr>
<tr><td><code>idmax</code></td>
<td>
<p>Index of default dose group for comparison to placebo
(e.g., for plotting Z-statistics).</p>
</td></tr>
<tr><td><code>customOut</code></td>
<td>
<p>List with customized output. It will be <code>NULL</code> if <code>customCOde</code> is not specified.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The default modType was changed from 3 to 4 for clinDR version &gt;2.0</p>


<h3>Author(s)</h3>

<p>Neal Thomas
</p>


<h3>References</h3>

<p>Thomas, N., Sweeney, K., and Somayaji, V. (2014).  Meta-analysis of clinical dose response in a large drug development portfolio, Statistics in Biopharmaceutical Research, Vol. 6, No.4, 302-317.
&lt;doi:10.1080/19466315.2014.924876&gt;
</p>
<p>Thomas, N., and Roy, D. (2016).  Analysis of clinical dose-response in small-molecule drug development:  2009-2014. Statistics in Biopharmaceutical Research, Vol. 6, No.4, 302-317
&lt;doi:10.1080/19466315.2016.1256229&gt;
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+print.emaxsimB">print.emaxsimB</a></code>, 
<code><a href="#topic+summary.emaxsimB">summary.emaxsimB</a></code>, <code><a href="#topic+plot.emaxsimB">plot.emaxsimB</a></code>, 
<code><a href="#topic+coef.emaxsimB">coef.emaxsimB</a></code>, <code><a href="#topic+sigma.emaxsimB">sigma.emaxsimB</a></code>,
<code><a href="#topic+emaxfun">emaxfun</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

### emaxsimB changes the random number seed

nsim&lt;-50
idmax&lt;-5
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)
Ndose&lt;-length(doselev)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-2.464592
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop)  

###FixedMean is specialized constructor function for emaxsim
gen&lt;-FixedMean(n,doselev,meanlev,sdy)  

prior&lt;-emaxPrior.control(epmu=0,epsca=30,difTargetmu=0,
		difTargetsca=30,dTarget=100,p50=50,sigmalow=0.1,
		sigmaup=30,parmDF=5)
mcmc&lt;-mcmc.control(chains=1,warmup=500,iter=5000,seed=53453,
		propInit=0.15,adapt_delta = 0.95)

### custom code to compute the distribution of the dose yielding
### a target diff with pbo
customCode&lt;-function(parms,residSD,pVal,dose,y,customParms){
	target&lt;-customParms
	ed50&lt;-exp(parms[,1])
	emax&lt;-parms[,2]
	td&lt;-ifelse(emax-target&gt;0,ed50*(target/(emax-target)),Inf)
	tdest&lt;-median(td)
	lb&lt;-quantile(td,0.1)
	ub&lt;-quantile(td,0.9)
	return(c(td=tdest,lb=lb,ub=ub))
}

D1 &lt;- emaxsimB(nsim,gen, prior, modType=4,seed=12357,mcmc=mcmc,check=FALSE,
				customCode=customCode,customParms=1.0)
D1

## End(Not run)
</code></pre>

<hr>
<h2 id='emaxsolve'>Solve Emax function for target value</h2><span id='topic+solveEmax'></span><span id='topic+solveDose'></span>

<h3>Description</h3>

<p>Solve the Emax function for dose or Emax to yield a specified response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>solveEmax(target,dose,led50,lambda,e0,pboadj=TRUE)
solveDose(target,led50,lambda,emax,e0,pboadj=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emaxsolve_+3A_target">target</code></td>
<td>
<p> The targetted response.  If the Emax model is specified
on the logit scale for binary data, <code>target</code> and 
<code>e0</code> must be logit transformed also.</p>
</td></tr>
<tr><td><code id="emaxsolve_+3A_dose">dose</code></td>
<td>
<p>The dose yielding target.  It is specifed for <code>solveEmax</code>, and 
returned for <code>solveDose</code></p>
</td></tr>
<tr><td><code id="emaxsolve_+3A_led50">led50</code>, <code id="emaxsolve_+3A_lambda">lambda</code>, <code id="emaxsolve_+3A_e0">e0</code></td>
<td>
<p>Emax model parameters (ed50 log transformed)</p>
</td></tr>
<tr><td><code id="emaxsolve_+3A_emax">emax</code></td>
<td>
<p>The Emax model parameter for solveDose.  The value returned
for <code>solveEmax</code></p>
</td></tr>
<tr><td><code id="emaxsolve_+3A_pboadj">pboadj</code></td>
<td>
<p>When <code>TRUE</code>, target is placebo-adjusted.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Neal Thomas</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitEmax">fitEmax</a></code>, <code><a href="#topic+fitEmaxB">fitEmaxB</a></code>,
<code><a href="#topic+emaxsim">emaxsim</a></code>, <code><a href="#topic+emaxsimB">emaxsimB</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
e0&lt;-10
dose&lt;-1
led50&lt;-log(0.5)
lambda&lt;-2
target&lt;- -1.5
emax&lt;-solveEmax(target,dose,led50,lambda,e0)
emax

dose1&lt;-solveDose(target,led50,lambda,emax,e0)
dose1

emaxfun(dose=dose1,parm=c(led50,lambda,emax,e0)) - e0

</code></pre>

<hr>
<h2 id='fitEmax'>ML fit of hyperbolic or sigmoidal Emax models to continuous/binary dose
response data.
</h2><span id='topic+fitEmax'></span>

<h3>Description</h3>

<p>Calls Newton-Raphson optimizers, nls and nlm,
for a hyperbolic or sigmoidal 
Emax model.  Different intercepts for multiple protocol-data are supported.  For binary
data, the Emax model is on the logit scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitEmax(y,dose,iparm,xparm,modType=4,
	prot=rep(1,length(y)),count=rep(1,length(y)),xbase=NULL,
	binary=FALSE,diagnostics=TRUE,msSat=NULL,
	pboAdj=rep(FALSE,max(prot)),optObj=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitEmax_+3A_y">y</code></td>
<td>
<p>Outcome for each patient.  Missing <code>Y</code> values
are are not permitted.  Dose/protocol group means for grouped continuous data.  For binary
data, <code>y</code> must be 0/1 and counts must be supplied for each 0/1 value.</p>
</td></tr>
<tr><td><code id="fitEmax_+3A_dose">dose</code></td>
<td>
<p>Dose for each patient.</p>
</td></tr>
<tr><td><code id="fitEmax_+3A_iparm">iparm</code></td>
<td>
<p>Optional starting values for the Newton-Raphson algorithm.  The
order of the variables is (log(ED50),Emax,E0) or
(log(ED50),lambda,Emax,E0).  Note the transformation of ED50. If there is more
than one protocol, the E0 is automatically duplicated.</p>
</td></tr>
<tr><td><code id="fitEmax_+3A_xparm">xparm</code></td>
<td>
<p>Optional starting values for the baseline covariate slopes (if any).
<code>xparm</code> must be specified when <code>iparm</code> and <code>xbase</code> are specified.
<code>startEmax</code> is used to obtain starting values if no starting values are specified.</p>
</td></tr>
<tr><td><code id="fitEmax_+3A_modtype">modType</code></td>
<td>
<p>modType=3 (default) for the 3-parameter hyperbolic Emax model.
modType=4 for the 4-parameter sigmoidal Emax model.</p>
</td></tr> 
<tr><td><code id="fitEmax_+3A_prot">prot</code></td>
<td>
<p>Protocol (group) membership used to create multiple intercepts.  
The default is a single protocol.</p>
</td></tr>
<tr><td><code id="fitEmax_+3A_count">count</code></td>
<td>
<p>Counts for the number of patients when the <code>Y</code> are dose 
continuous group means or binary 0/1 values.  
Default is 1 (ungrouped data).</p>
</td></tr>
<tr><td><code id="fitEmax_+3A_xbase">xbase</code></td>
<td>
<p>A matrix of baseline covariates with rows corresponding to 
<code>y</code> that enter as linear additive predictors.  The baseline covariates must 
be centered about
their (protocol-specific) means.  <code>xbase</code> does not include an intercept or
protocol indicators.  Covariates cannnot be specified with PBO adjusted or 
aggregated input.</p>
</td></tr>
<tr><td><code id="fitEmax_+3A_diagnostics">diagnostics</code></td>
<td>
<p>Print trace information per iteration and any error messages from the optimizing
methods.  Printing can be suppressed for use in simulation studies.</p>
</td></tr>
<tr><td><code id="fitEmax_+3A_binary">binary</code></td>
<td>
<p>When <code>TRUE</code>, the <code>y</code> are assumed to be coded <code>0/1</code>, and 
the the means reported are proportions.  The Emax model is specified on the logit 
scale, and proportions are estimated from the model by back-transformation.</p>
</td></tr>
<tr><td><code id="fitEmax_+3A_mssat">msSat</code></td>
<td>
<p>If continuous <code>Y</code> are dose/protocol group means rather than
individual measurements, the within group variance, <code>msSat</code>, should be 
supplied.  This variance is the mean square from the model saturated in
dose and protocol.  It is used for goodness-of-fit (GOF) testing, and to 
improve the residual variance estimate for the Emax model.  If it is not
supplied, statistics needed for GOF will not be available, and the
residual SD (and associated SE) will have low degrees of freedom.</p>
</td></tr>
<tr><td><code id="fitEmax_+3A_pboadj">pboAdj</code></td>
<td>
<p>For published data with only pbo-adjusted dose group means and
SEs, the model is fit without an intercept(s).  If initial parameters
are supplied, the intercept (E0) should be assigned <code>0</code>.  
A zero for the placebo mean should not be included in <code>Y</code>.  
This option is not available for binary data.  Potential correlation between between
placebo-adjusted means is ignored.</p>
</td></tr> 
<tr><td><code id="fitEmax_+3A_optobj">optObj</code></td>
<td>
<p>Include the output object from the R optimization code in the <code>fitEmax</code>
output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fits the 3- or 4- Emax model  using
<code><a href="stats.html#topic+nls">nls</a></code>.  A newton-raphson algorithm is tried first 
followed by a partial linear optimatization if needed.  Binary
data are fit using <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>


<h3>Value</h3>

<p>A list assigned class &quot;fitEmax&quot; with:
</p>
<table>
<tr><td><code>fit</code></td>
<td>
<p>The parameter estimates and their variance-covariance matrix.</p>
</td></tr>
<tr><td><code>y</code>, <code>dose</code>, <code>modType</code>, <code>prot</code>, <code>count</code>, <code>binary</code>, <code>pboAdj</code></td>
<td>
<p>Input values.</p>
</td></tr>
<tr><td><code>gofTest</code></td>
<td>
<p>Goodness of fit p-value based on likelihood ratio comparison of
the model to a saturated fit.</p>
</td></tr>
<tr><td><code>nll</code></td>
<td>
<p><code>-2*loglikelihood</code> for the Emax model and the saturated model.  
Residual sums of squares are returned for continuous data models.  These
statistics can be used to construct other tests using multiple calls to
<code>fitEmax</code> (e.g., 3 vs 4 parameter Emax
models, or a common intercept model across protocols).</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>Residual degrees of freedom for the Emax model and the saturated model.</p>
</td></tr>
<tr><td><code>optobj</code></td>
<td>
<p>When requested, the fit object returned by the R optimation functions.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+nls">nls</a></code>, <code><a href="stats.html#topic+nlm">nlm</a></code>,  <code><a href="#topic+nllogis">nllogis</a></code>, 
<code><a href="#topic+predict.fitEmax">predict.fitEmax</a></code>, <code><a href="#topic+plot.fitEmax">plot.fitEmax</a></code>, <code><a href="#topic+coef.fitEmax">coef.fitEmax</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## the example changes the random number seed

doselev&lt;-c(0,5,25,50,100,350)
n&lt;-c(78,81,81,81,77,80)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)


sdy&lt;-8.0
pop&lt;-c(log(ed50),emax,e0)    
dose&lt;-rep(doselev,n)
meanlev&lt;-emaxfun(dose,pop)  

y&lt;-rnorm(sum(n),meanlev,sdy)

testout&lt;-fitEmax(y,dose,modType=4)
</code></pre>

<hr>
<h2 id='fitEmaxB'>
Bayesian fit of hyperbolic or sigmoidal Emax models to continuous/binary dose
response data.
</h2><span id='topic+fitEmaxB'></span>

<h3>Description</h3>

<p>Uses Rpackage <code><a href="rstan.html#topic+rstan">rstan</a></code> to fit a Bayesian hyperbolic or sigmoidal 
Emax model.  Different intercepts for multiple protocol-data are supported.  For binary
data, the Emax model is on the logit scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitEmaxB(y, dose, prior, modType = 4, prot = rep(1, length(y)), 
	count = rep(1, length(y)), xbase=NULL,
	binary = FALSE, msSat = NULL,vcest=NULL,
	pboAdj = FALSE, mcmc = mcmc.control(), estan = NULL, 
	diagnostics = TRUE, nproc = getOption("mc.cores", 1L))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitEmaxB_+3A_y">y</code></td>
<td>
<p>Outcome for each patient.  Missing <code>Y</code> values
are are not permitted.  Dose/protocol group means for grouped continuous data.  For binary
data, <code>y</code> must be 0/1 and counts must be supplied for each 0/1 value.</p>
</td></tr>
<tr><td><code id="fitEmaxB_+3A_dose">dose</code></td>
<td>
<p>Dose for each patient.</p>
</td></tr>
<tr><td><code id="fitEmaxB_+3A_prior">prior</code></td>
<td>
<p>Prior specification through an object of type 'emaxPrior' or 'prior'.  
See <code><a href="#topic+emaxPrior.control">emaxPrior.control</a></code> and <code><a href="#topic+prior.control">prior.control</a></code> for details.  
The 'emaxPrior' specifies
the magnitude of the potential effect for a specified dose (typically the highest
anticipated dose and/or the dose in a POC study), while the 'prior' specifies the
theoretical maximum effect (the emax parameter).  The 'prior' specification is 
deprecated and will be removed.</p>
</td></tr>
<tr><td><code id="fitEmaxB_+3A_modtype">modType</code></td>
<td>
<p>modType=3 (default) for the 3-parameter hyperbolic Emax model.
modType=4 for the 4-parameter sigmoidal Emax model.</p>
</td></tr> 
<tr><td><code id="fitEmaxB_+3A_prot">prot</code></td>
<td>
<p>Protocol (group) membership used to create multiple intercepts.  
The default is a single protocol.  The  prior disribution for the placebo
response is re-used independently for each intercept.</p>
</td></tr>
<tr><td><code id="fitEmaxB_+3A_count">count</code></td>
<td>
<p>Counts for the number of patients when the <code>Y</code> are dose 
continuous group means or binary 0/1 values.  
Default is 1 (ungrouped data).</p>
</td></tr>
<tr><td><code id="fitEmaxB_+3A_xbase">xbase</code></td>
<td>
<p>A matrix of baseline covariates with rows corresponding to 
<code>y</code> that enter as linear additive predictors.  The baseline covariates must 
be centered about
their (protocol-specific) means.  <code>xbase</code> does not include an intercept or
protocol indicators.  Covariates cannnot be specified with PBO adjusted or 
aggregated input.</p>
</td></tr>
<tr><td><code id="fitEmaxB_+3A_binary">binary</code></td>
<td>
<p>When <code>TRUE</code>, the <code>y</code> are assumed to be coded <code>0/1</code>, and 
the means reported are proportions.  The Emax model is specified on the logit 
scale, and proportions are estimated from the model by back-transformation.</p>
</td></tr>
<tr><td><code id="fitEmaxB_+3A_mssat">msSat</code></td>
<td>
<p>If continuous <code>Y</code> are dose/protocol group means rather than
individual measurements, the within group variance, <code>msSat</code>, should be 
supplied.  This variance is the mean square from the model saturated in
dose and protocol.  It is used to 
improve the residual variance estimate for the Emax model.  If it is not
supplied, the
residual SD (and associated SE) will have low degrees of freedom.</p>
</td></tr>
<tr><td><code id="fitEmaxB_+3A_vcest">vcest</code></td>
<td>
<p>The input, <code>Y</code>, can be estimates of dose group
responses from a first-stage
model.  The <code>vcest</code> is the variance-covariance matrix of the
model-based estimates.  The most common usage is when a saturated model
is fit using maximum likelihood estimation to longitudinal data 
to produce dose group estimates that are valid under the MAR assumption
for missing values.  Other applications are possible, see the Pinheiro, 
et al reference.  The <code>count</code> and <code>msSat</code> are ignored when
<code>vcest</code> is specified.  Covariates <code>xbase</code> cannot be specified
with <code>vcest</code>, but covariates can be included in the first stage 
modeling.
</p>
</td></tr>
<tr><td><code id="fitEmaxB_+3A_pboadj">pboAdj</code></td>
<td>
<p>For published data with only pbo-adjusted dose group means and
SEs, the model is fit without an intercept(s).  If initial parameters
are supplied, the intercept (E0) should be assigned <code>0</code>.  
A zero for the placebo mean should not be included in <code>Y</code>.  
This option is not available for binary data.  Potential correlation between between
placebo-adjusted means is ignored.</p>
</td></tr> 
<tr><td><code id="fitEmaxB_+3A_mcmc">mcmc</code></td>
<td>

<p>Inputs controlling <code>rstan</code> execution.  See <code><a href="#topic+mcmc.control">mcmc.control</a></code>
for details.</p>
</td></tr>
<tr><td><code id="fitEmaxB_+3A_estan">estan</code></td>
<td>
<p>The compiled <code>rstan</code> Emax model is usually loaded
automatically.  It can be load to an object using the function
<code>selEstan</code> and passed to <code>fitEmaxB</code> for repeated executions to
improve efficiency and stability.</p>
</td></tr>
<tr><td><code id="fitEmaxB_+3A_diagnostics">diagnostics</code></td>
<td>
<p>Printed output from rstan.  See <code>Details</code> for more information.</p>
</td></tr>
<tr><td><code id="fitEmaxB_+3A_nproc">nproc</code></td>
<td>
<p>The number of processor requested for <code>STAN</code> MCMC
computations.  Defaults to the value set by the 
<code>rstan</code> installation.   When set explicitly, <code>nproc</code> 
is usually 1 or the number of MCMC chains. If greater than the
number of chains, it is set to the number of chains.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>compileStanModels</code> must be executed once to create compiled STAN
code before <code>fitEmaxB</code> can be used.
</p>
<p>MCMC fit of a Bayesian hyperbolic or sigmoidal Emax model.  The prior
distributions available are based on the publication  
Thomas, Sweeney, and Somayaji (2014), 
Thomas and Roy (2016), and Wu, et al (2017).
</p>
<p>The posterior distributions are complex because the distributions of the <code>Emax</code> and <code>ED50</code> parameters 
change substantially as a function of the <code>lambda</code>, often
creating 'funnel' type conditions. Small numbers of 
divergences are common with the 4-parameter model and do not 
appear easily avoided.
Extensive simulation using evaluations with <code>emaxsimB</code>
support the utility of the resulting approximate 
posterior distributions. The number of divergences can be
viewed using <code>diagnostics=TRUE</code>. The usual convergence
diagnostics should always be checked.
</p>


<h3>Value</h3>

<p>A list assigned class &quot;fitEmaxB&quot; with:
</p>
<table>
<tr><td><code>estanfit</code></td>
<td>
<p>The <code>rstan</code> object with the model fit.</p>
</td></tr>
<tr><td><code>y</code>, <code>dose</code>, <code>prot</code>, <code>count</code>, <code>nbase[rows of xbase]</code>, <code>xbase</code>, <code>dimFit[rows of vcest]</code>, <code>vcest</code>, <code>modType</code>, <code>binary</code>, <code>pboAdj</code>, <code>msSat</code>, <code>prior</code>, <code>mcmc</code>, <code>localParm[TRUE when
emaxPrior specified]</code></td>
<td>
<p>Input values.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The default modType was changed from 3 to 4 for clinDR version &gt;2.0</p>


<h3>Author(s)</h3>

<p>Neal Thomas
</p>


<h3>References</h3>

<p>Thomas, N., Sweeney, K., and Somayaji, V. (2014).  Meta-analysis of clinical dose response in a large drug development portfolio, Statistics in Biopharmaceutical Research, Vol. 6, No.4, 302-317.
&lt;doi:10.1080/19466315.2014.924876&gt;
</p>
<p>Pinheiro, J., Bornkamp, B., Glimm, E., and Bretz, F. (2014).  
Model-based dose finding under model uncertainty using general 
parametric models, Vol. 33, No. 10, 1646-1661 &lt;doi:/10.1002/sim.6052&gt;
</p>
<p>Thomas, N., and Roy, D. (2016).  Analysis of clinical dose-response in small-molecule drug development:  2009-2014. Statistics in Biopharmaceutical Research, Vol. 6, No.4, 302-317
&lt;doi:10.1080/19466315.2016.1256229&gt;
</p>
<p>Wu, J., Banerjee, A., Jin, B. Menon, M. S., Martin, S. and Heatherington, A. (2017). Clinical dose response for a broad set of biological products: A model-based meta-analysis. Statistical Methods in Medical Research. &lt;doi:10.1177/0962280216684528&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitEmax">fitEmax</a></code>, <code><a href="#topic+predict.fitEmaxB">predict.fitEmaxB</a></code>, <code><a href="#topic+plot.fitEmaxB">plot.fitEmaxB</a></code>, <code><a href="#topic+coef.fitEmaxB">coef.fitEmaxB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

data("metaData")
exdat&lt;-metaData[metaData$taid==1,]

prior&lt;-emaxPrior.control(epmu=0,epsca=4,difTargetmu=0,difTargetsca=4,dTarget=20,
				p50=(2+5)/2,
				sigmalow=0.01,sigmaup=3)
										
mcmc&lt;-mcmc.control(chains=3)

msSat&lt;-sum((exdat$sampsize-1)*(exdat$sd)^2)/(sum(exdat$sampsize)-length(exdat$sampsize))
fitout&lt;-fitEmaxB(exdat$rslt,exdat$dose,prior,modType=4,prot=exdat$protid,
				count=exdat$sampsize,msSat=msSat,mcmc=mcmc)
plot(fitout)

## End(Not run)
</code></pre>

<hr>
<h2 id='FixedMean'> Fixed means (proportions) random data constructor for emaxsim
for continuous or binary data </h2><span id='topic+FixedMean'></span>

<h3>Description</h3>

<p>Creates a list object that contains inputs and  a function to create
simulated data sets with a common mean (proportion) for use in emaxsim
with normal or continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FixedMean(n, doselev, meanlev, resSD, parm = NULL, binary=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FixedMean_+3A_n">n</code></td>
<td>
<p> Sample size for each dose group </p>
</td></tr>
<tr><td><code id="FixedMean_+3A_doselev">doselev</code></td>
<td>
<p>Dose levels (including 0 for placebo) in the
study corresponding to <code>n</code>.  Must be in increasing order.</p>
</td></tr>
<tr><td><code id="FixedMean_+3A_meanlev">meanlev</code></td>
<td>
<p> Mean response at each doselev.  For binary data, these
are the proportion of responders (no logit transformation).</p>
</td></tr>
<tr><td><code id="FixedMean_+3A_ressd">resSD</code></td>
<td>
<p> Standard deviation for residuals within each dose
group (assumed common to all dose groups) </p>
</td></tr>
<tr><td><code id="FixedMean_+3A_parm">parm</code></td>
<td>
<p> Population parameters that are 
saved for later reference, but are not used when creating simulated
data.  <code>parm</code> can contain
parameters for a 3- or 4- parameter Emax model that generated
<code>meanlev</code>.  They should be stored in the order given in
<code><a href="#topic+emaxfun">emaxfun</a></code>.  Default is <code>NULL</code>. </p>
</td></tr>
<tr><td><code id="FixedMean_+3A_binary">binary</code></td>
<td>
<p>Normal data with homogeneous variance are generated unless
<code>binary</code> is <code>TRUE</code>, and then means are interpreted as
proportions and <code>0/1</code> data are generated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of length <code>2</code>.  
The first element is itself a list named <code>genP</code> that contains named elments
<code>n</code>, <code>resSD</code>, <code>doselev</code>, <code>dose</code>, <code>parm</code>, 
<code>binary</code>, and the
element <code>meanlev</code>, which is specific to <code>FixedMean</code>.  The second
element is a function named <code>genFun</code> that takes
<code>genP</code> as input and returns a list with named elements <code>meanlev</code>, 
<code>parm</code>, <code>resSD</code>, <code>y</code>.
</p>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>See Also</h3>

 <p><code><a href="#topic+emaxsim">emaxsim</a></code>, <code><a href="#topic+RandEmax">RandEmax</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
##  example changes the random number seed

doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop&lt;-c(log(ed50),emax,e0)  
  
meanlev&lt;-emaxfun(doselev,pop)  

###FixedMean is specialized constructor function for emaxsim
genp&lt;-FixedMean(n,doselev,meanlev,sdy,pop)  

### binary example
n&lt;-rep(500,5)
doselev&lt;-c(0,5,25,50,1000)
dose&lt;-rep(doselev,n)

e0&lt;- qlogis(0.2)
ed50&lt;-20
diftarget&lt;-qlogis(0.6)-qlogis(0.2)
lambda&lt;-2
dtarget&lt;-100
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),lambda,e0)

pop&lt;-c(log(ed50),lambda,emax,e0)
meanlev&lt;-plogis(emaxfun(doselev,pop))

genp&lt;-FixedMean(n,doselev,meanlev,sdy,pop,binary=TRUE)  

tapply(genp$genFun(genp$genP)$y,dose,mean)
meanlev


## End(Not run)

</code></pre>

<hr>
<h2 id='mcmc.control'>
Settings for <code>restan</code> execution in function <code>fitEmaxB</code>
</h2><span id='topic+mcmc.control'></span>

<h3>Description</h3>

<p>Set MCMC controls.  Also control spread of initial parameter values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcmc.control(chains = 1, thin = 1, 
	warmup = 1000, iter = 3333* thin+warmup, 
	propInit = 0.50, seed = 12357, adapt_delta = 0.9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcmc.control_+3A_chains">chains</code></td>
<td>

<p>Number of chains
</p>
</td></tr>
<tr><td><code id="mcmc.control_+3A_thin">thin</code></td>
<td>

<p>Number of discarded sampled parameter values.  <code>warmup</code> and <code>iter</code> include
<code>thin</code>, so for example, to output <code>1000</code> samples, <code>iter</code> must be 
<code>1000</code> times <code>thin</code>.
</p>
</td></tr>
<tr><td><code id="mcmc.control_+3A_warmup">warmup</code></td>
<td>

<p>See <code>rstan</code> documentation for function <code>sampling</code>.   
</p>
</td></tr>
<tr><td><code id="mcmc.control_+3A_iter">iter</code></td>
<td>

<p>See <code>rstan</code> documentation for function <code>sampling</code>.  
</p>
</td></tr>
<tr><td><code id="mcmc.control_+3A_propinit">propInit</code></td>
<td>

<p>Initial values for <code>E0</code> and <code>Emax</code> are derived from the prior mean plus/minus
<code>propInit</code> times the prior SD.  <code>propInit</code> can be set to a small proportion if
very diffuse prior distributions are specified.
</p>
</td></tr>
<tr><td><code id="mcmc.control_+3A_seed">seed</code></td>
<td>

<p>Seed passed to <code>rstan</code>.
</p>
</td></tr>
<tr><td><code id="mcmc.control_+3A_adapt_delta">adapt_delta</code></td>
<td>

<p>See <code>rstan</code> documentation for function <code>sampling</code>.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Some defaults were changed with version&gt;=2.0.  For earlier versions,
warmup = 500, iter = 5000* thin, and adapt_delta=0.8</p>

<hr>
<h2 id='metaData'>Dose response data from several published meta-analyses</h2><span id='topic+metaData'></span>

<h3>Description</h3>

<p>Dose response data from over 200 compounds included in published meta-analyses.  The data are aggregated in a single data frame in a common format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data('metaData')
</code></pre>


<h3>Format</h3>

<p>The data frame has one row for each compound, protocol within compound, and 
dose group within protocol.    
Compound and protocol level descriptors are repeated on each
row of the data frame.
</p>

<dl>
<dt><code>drugid</code></dt><dd><p>A numerical ID identifying each drug</p>
</dd>
<dt><code>taid</code></dt><dd><p>A drug can be studied in more than one therapeutic area.  
The <code>taid</code> ID identifies each TA/drug combination.</p>
</dd> 
<dt><code>protid</code></dt><dd><p>Numerical (1,2,3,...) ID for protocols specific to each TAID.</p>
</dd>
<dt><code>gname</code></dt><dd><p>Generic drug name</p>
</dd>
<dt><code>bname</code></dt><dd><p>Branded(USA) drug name</p>
</dd>
<dt><code>drugtype</code></dt><dd><p>Drug classified as SMALL MOLECULE, BIOLOGIC, OTHER</p>
</dd>
<dt><code>route</code></dt><dd><p>Route of administration, e.g., oral, subcutaneous,...</p>
</dd>
<dt><code>routeShort</code></dt><dd><p>Abbreviated format for <code>route</code></p>
</dd>
<dt><code>oralForm</code></dt><dd><p>Formulation (e.g., TABLET, POWDER,...) for drugs with oral administration.</p>
</dd>
<dt><code>fdaapproved</code></dt><dd><p>NA if status was not yet determined</p>
</dd>
<dt><code>metasource</code></dt><dd><p>Meta-analysis contributing compounds.  BIO14: biological compounds through 2014;
FDA914: FDA approved small molecules and 'other' 2009-2014;  FDA1417: FDA approved compounds 2014-2017;
Pfizer P2 compounds 1998-2009; PFIZERUPDATE18:  Pfizer compounds 2009-2018</p>
</dd>
<dt><code>protno</code></dt><dd><p>Sponsor assigned protocol name/number</p>
</dd>
<dt><code>nctno</code></dt><dd><p>Clintrial.gov protocol ID</p>
</dd>
<dt><code>protyear</code></dt><dd><p>When available, year of first patient/first visit.  In some cases, date of journal publication</p>
</dd>
<dt><code>design</code></dt><dd><p>PARELLEL, CROSSOVER,...</p>
</dd>
<dt><code>actcomp</code></dt><dd><p>Indicator if an active comparator was included in the protocol</p>
</dd>
<dt><code>etype</code></dt><dd><p><code>etype=1</code> for the designated primary endpoint.  For completeness, where
there was ambiguity in the selection of the endpoint, additional endpoint data was included on separate 
rows and indicated by etype=2,3,...  Most analyses subset on <code>etype=1</code></p>
</dd>
<dt><code>poptype</code></dt><dd><p>For a compound and TA, there can be distinctly different populations with 
anticipated response differences, e.g., treatment-naive and pre-treated patients.  The population with 
the most studied doses has <code>poptype=1</code>.  For completeness, additional populations are included 
and identified by <code>poptype=2,3,...</code>.  Most analyses subset on <code>poptype=1</code></p>
</dd>
<dt><code>primsource</code></dt><dd><p>IRO/PRO investigator/patient reported outcome; L lab, V vitals</p>
</dd>
<dt><code>primtype</code></dt><dd><p>Primary endpoint is BINARY, CONTINOUS, TIMETOEVEN</p>
</dd>
<dt><code>primtime</code></dt><dd><p>time units to primary endpoint from randomization</p>
</dd>
<dt><code>timeunit</code></dt><dd><p>DAY, HR, MIN, MONTH, WK for primary endpoint</p>
</dd>
<dt><code>indication</code></dt><dd><p>Disease description</p>
</dd>
<dt><code>broadta</code></dt><dd><p>Broad TA classification of the indication</p>
</dd>
<dt><code>endpointLong,endpointShort</code></dt><dd><p>Endpoint name and an abbreviated form using 
for example, cfb and pcfb for 
change from baseline and percent change from baseline</p>
</dd>
<dt><code>dose</code></dt><dd><p>Total daily dose for small molecules, total weekly dose for biologics in mg or mg/kg 
for weight-based dosing.</p>
</dd>
<dt><code>tload</code></dt><dd><p>Amount of any loading dose</p>
</dd>
<dt><code>nload</code></dt><dd><p>Number of visits with a loading dose</p>
</dd>
<dt><code>regimen</code></dt><dd><p>Dosing frequency</p>
</dd>
<dt><code>primregimen</code></dt><dd><p><code>primregimen=1</code> for most doses/regimens, but <code>primregimen=2</code> for a few
regimens that clearly differed from the most common regimen for the same total dose. Most analyses 
subset on <code>primregimen=1</code></p>
</dd>
<dt><code>rslt</code></dt><dd><p>The sample dose group mean (continuous) or proportion (binary) of the primary endpoint.
Analyses of the
time-to-event endpoints was compound specific (either a mean or a proportion was estimated). 
</p>
</dd>
<dt><code>se</code></dt><dd><p>Standard error of <code>rslt</code></p>
</dd>
<dt><code>sd</code></dt><dd><p>Dose group sample standard deviation for continuous data</p>
</dd>
<dt><code>lcl, ucl, alpha</code></dt><dd><p>alpha-level interval (lcl,ucl) when confidence intervals 
were extracted from the original data source because se were not reported</p>
</dd>
<dt><code>sampsize</code></dt><dd><p>Sample size reported for <code>rslt</code>.  The handling of missing data by
the protocol sponsors varied, but 'completers' was most common.</p>
</dd>
<dt><code>ittsize</code></dt><dd><p>The number randomized. The counts are usually available, except for 
internal data before 2009, where it was not collected.</p>
</dd>
<dt><code>pmiss</code></dt><dd><p>Percent of missing data.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Compound sampling plans and other details are given in the publications:
</p>
<p>Thomas, N., Sweeney, K., and Somayaji, V. (2014).  Meta-analysis of clinical dose response in a large drug development portfolio, Statistics in Biopharmaceutical Research, Vol. 6, No.4, 302-317.
&lt;doi:10.1080/19466315.2014.924876&gt;
</p>
<p>Thomas, N., and Roy, D. (2016). Analysis of clinical dose-response in small-molecule drug development: 2009-2014. Statistics in Biopharmaceutical Research, Vol. 6, No.4, 302-317 &lt;doi:10.1080/19466315.2016.1256229&gt;
</p>
<p>Wu, J., Banerjee, A., Jin, B. Menon, M. S., Martin, S. and Heatherington, A. (2017). Clinical dose response for a broad set of biological products: A model-based meta-analysis. Statistical Methods in Medical Research. &lt;doi:10.1177/0962280216684528&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('metaData')
names(metaData)
</code></pre>

<hr>
<h2 id='nllogis'>The negative log likelihood function for a 3- or 4-
parameter Emax model on the logit scale for binary dose response.
</h2><span id='topic+nllogis'></span>

<h3>Description</h3>

<p>The negative log likelihood function evaluated with a single input set of
parameters for the binary Emax model on the logistic scale.  For use
with function <code><a href="#topic+fitEmax">fitEmax</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nllogis(parms,y,dose,
          prot=rep(1,length(y)),
          count=rep(1,length(y)),
          xbase=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nllogis_+3A_parms">parms</code></td>
<td>
<p>Emax model parameter values.  The
order of the variables is (log(ED50),Emax,E0) or
(log(ED50),lambda,Emax,E0). There must be an E0 for each protocol.  
Note the transformation of ED50.</p>
</td></tr>
<tr><td><code id="nllogis_+3A_y">y</code></td>
<td>
<p>Binary outcome variable for each patient.  Missing values
are deleted. Must be coded 0/1.</p>
</td></tr>
<tr><td><code id="nllogis_+3A_dose">dose</code></td>
<td>
<p>Dose for each patient</p>
</td></tr>
<tr><td><code id="nllogis_+3A_prot">prot</code></td>
<td>
<p>Protocol (group) membership used to create multiple intercepts.  
The default is a single protocol.  The value of <code>prot</code> must be 1,2,3,..</p>
</td></tr>
<tr><td><code id="nllogis_+3A_count">count</code></td>
<td>
<p>Counts for the number of patients with each dose/y value.  
Default is 1 (ungrouped data).</p>
</td></tr>
<tr><td><code id="nllogis_+3A_xbase">xbase</code></td>
<td>
<p>Optional matrix of baseline covariates that enter the model
linearly.  If there is a single covariate, it should be converted
to a matrix with one column.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The negative log likelihood for the 3- or 4- Emax
model on the logit scale for binary data.  Note the ordering of the parameters
and their transformations.  A 3 vs 4 parameter model is deterimined by
the length of <code>parms</code>.</p>


<h3>Value</h3>

<p>Negative log likelihood value is returned.
</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+nlm">nlm</a></code>,  <code><a href="#topic+fitEmax">fitEmax</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data('metaData')
exdat&lt;-metaData[metaData$taid==8,]

cy&lt;-round(exdat$sampsize*exdat$rslt)
y&lt;-c(rep(1,length(cy)),rep(0,length(cy)))
cy&lt;-c(cy,exdat$sampsize-cy)
drep&lt;-c(exdat$dose,exdat$dose)
plotD(exdat$rslt,exdat$dose,se=FALSE)
nllogis(parms=c(log(2.5),-3.26,-0.15), y, drep,count=cy)

</code></pre>

<hr>
<h2 id='plot.emaxsim'>  Plot the output of emaxsim</h2><span id='topic+plot.emaxsim'></span>

<h3>Description</h3>

<p>A Q-Q plot of the dose response estimate of the mean at a specified dose minus
the population value divided by the standard error of the estimator
(computed using the delta method).  Estimates based on alternative
models when the Emax estimation fails are highlighted in red.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emaxsim'
plot(x, id = x$idmax, plotDif= TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.emaxsim_+3A_x">x</code></td>
<td>
<p> Output  of <code><a href="#topic+emaxsim">emaxsim</a></code> </p>
</td></tr>
<tr><td><code id="plot.emaxsim_+3A_id">id</code></td>
<td>
<p> Index of the dose to be assessed (placebo index=1). </p>
</td></tr>
<tr><td><code id="plot.emaxsim_+3A_plotdif">plotDif</code></td>
<td>
<p> If true (default), the estimates and population
values are differences with placebo.  IF false, absolute dose response
values are used.</p>
</td></tr>
<tr><td><code id="plot.emaxsim_+3A_...">...</code></td>
<td>
<p> Optional parameters passed to the plotting function </p>
</td></tr>
</table>


<h3>Value</h3>

<p>No output is returned.
</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

  <p><code><a href="#topic+emaxsim">emaxsim</a></code>, <code><a href="#topic+print.emaxsim">print.emaxsim</a></code>,
<code><a href="#topic+summary.emaxsim">summary.emaxsim</a></code>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
nsim&lt;-50
idmax&lt;-5
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop.parm&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop.parm)  

###FixedMean is specialized constructor function for emaxsim
gen.parm&lt;-FixedMean(n,doselev,meanlev,sdy)  
D1 &lt;- emaxsim(nsim,gen.parm)

plot(D1,id=3)

## End(Not run)

</code></pre>

<hr>
<h2 id='plot.emaxsimB'>  Plot the output of emaxsimB</h2><span id='topic+plot.emaxsimB'></span>

<h3>Description</h3>

<p>A Q-Q plot of the posterior mean of the mean dose response at a specified dose minus
the population value divided by the posterior SD of the mean difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emaxsimB'
plot(x, id = x$idmax, plotDif= TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.emaxsimB_+3A_x">x</code></td>
<td>
<p> Output  of <code><a href="#topic+emaxsimB">emaxsimB</a></code> </p>
</td></tr>
<tr><td><code id="plot.emaxsimB_+3A_id">id</code></td>
<td>
<p> Index of the dose to be assessed (placebo index=1). </p>
</td></tr>
<tr><td><code id="plot.emaxsimB_+3A_plotdif">plotDif</code></td>
<td>
<p> If true (default), the estimates and population
values are differences with placebo.  IF false, absolute dose response
values are used.</p>
</td></tr>
<tr><td><code id="plot.emaxsimB_+3A_...">...</code></td>
<td>
<p> Optional parameters passed to the plotting function </p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object is returned
</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

  <p><code><a href="#topic+emaxsimB">emaxsimB</a></code>, <code><a href="#topic+print.emaxsimB">print.emaxsimB</a></code>,
<code><a href="#topic+summary.emaxsimB">summary.emaxsimB</a></code>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## emaxsimB changes the random number seeds
nsim&lt;-50
idmax&lt;-5
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)
Ndose&lt;-length(doselev)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-2.464592
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop)  

###FixedMean is specialized constructor function for emaxsim
gen&lt;-FixedMean(n,doselev,meanlev,sdy)  

prior&lt;-emaxPrior.control(epmu=0,epsca=30,difTargetmu=0,
		difTargetsca=30,dTarget=100,p50=50,sigmalow=0.1,
		sigmaup=30,parmDF=5)
mcmc&lt;-mcmc.control(chains=1,warmup=500,iter=5000,seed=53453,propInit=0.15,adapt_delta = 0.95)

D1 &lt;- emaxsimB(nsim,gen, prior, modType=3,mcmc=mcmc,check=FALSE)

plot(D1,id=3)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.emaxsimBobj'> Plot dose response from a data set generated by emaxsimB </h2><span id='topic+plot.emaxsimBobj'></span>

<h3>Description</h3>

<p>Plot of population dose response curve, sample dose group means, 
posterior and posterior predictive intervals, and
the model-based estimated (posterior means) dose response curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emaxsimBobj'
plot(
	x, clev=0.9, plotDif=FALSE, 
	plotPop=c('m','3','4'), 
	logScale=FALSE, plotResid=FALSE, 
	plot=TRUE, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.emaxsimBobj_+3A_x">x</code></td>
<td>
<p>Extracted data object from <code><a href="#topic+emaxsimB">emaxsimB</a></code> </p>
</td></tr>
<tr><td><code id="plot.emaxsimBobj_+3A_clev">clev</code></td>
<td>
<p>Level for posterior intervals </p>
</td></tr>
<tr><td><code id="plot.emaxsimBobj_+3A_plotdif">plotDif</code></td>
<td>
<p>When <code>TRUE</code>, the difference with placebo is plotted.</p>
</td></tr>
<tr><td><code id="plot.emaxsimBobj_+3A_plotpop">plotPop</code></td>
<td>
<p>When plotPop='m', the mean values at each dose in the
designs are joined using linear interpolation.  Otherwise, the
the population Emax parameters must be supplied with the
data generator (see <a href="#topic+FixedMean">FixedMean</a> or <a href="#topic+RandEmax">RandEmax</a>).  If
the Emax parameters are not available, linear interpolation is used.</p>
</td></tr>
<tr><td><code id="plot.emaxsimBobj_+3A_logscale">logScale</code></td>
<td>
<p>Not implemented</p>
</td></tr>
<tr><td><code id="plot.emaxsimBobj_+3A_plotresid">plotResid</code></td>
<td>
<p>Not implemented</p>
</td></tr>
<tr><td><code id="plot.emaxsimBobj_+3A_plot">plot</code></td>
<td>
<p>Return plotting output without plotting.</p>
</td></tr>  
<tr><td><code id="plot.emaxsimBobj_+3A_...">...</code></td>
<td>
<p>Other plot parameters.  See <code>plot.fitEmaxB</code> for details  </p>
</td></tr>
</table>


<h3>Note</h3>

<p>The estimated curve is the posterior mean evaluated along a grid of
dose values.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

## emaxsimB changes the random number seed

nsim&lt;-50
idmax&lt;-5
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)
Ndose&lt;-length(doselev)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-2.464592
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop)  

###FixedMean is specialized constructor function for emaxsim
gen&lt;-FixedMean(n,doselev,meanlev,sdy)  

nsim&lt;-50
idmax&lt;-5
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)
Ndose&lt;-length(doselev)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 
dtarget&lt;-100
diftarget&lt;-2.464592
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop)  

###FixedMean is specialized constructor function for emaxsim
gen&lt;-FixedMean(n,doselev,meanlev,sdy)  

prior&lt;-emaxPrior.control(epmu=0,epsca=30,difTargetmu=0,
		difTargetsca=30,dTarget=100,p50=50,sigmalow=0.1,
		sigmaup=30,parmDF=5)
		
mcmc&lt;-mcmc.control(chains=1,warmup=500,iter=5000,seed=53453,propInit=0.15,adapt_delta = 0.95)

D1 &lt;- emaxsimB(nsim,gen, prior, modType=3,mcmc=mcmc,check=FALSE)

plot(D1,id=3)
mcmc&lt;-mcmc.control(chains=1,warmup=500,iter=5000,seed=53453,propInit=0.15,adapt_delta = 0.95)

D1 &lt;- emaxsimB(nsim,gen, prior, modType=3,mcmc=mcmc,check=FALSE)

plot(D1[2])

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.emaxsimobj'> Plot dose response from a data set generated by emaxsim </h2><span id='topic+plot.emaxsimobj'></span>

<h3>Description</h3>

<p>Plot of population dose response curve, dose group means with CIs, 
predictive intervals, and
the model-based estimated dose response curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emaxsimobj'
plot(
    x, xlim, xat=NULL, ylim, xlab, ylab,
    plotDif=FALSE,
    plotResid=FALSE,
    clev = 0.9, 
    plotPop=c('m','3','4'),     
    negC = FALSE, 
    logScale=FALSE,
    predict=TRUE, 
    plot=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.emaxsimobj_+3A_x">x</code></td>
<td>
<p>Extracted data object from <code><a href="#topic+emaxsim">emaxsim</a></code> </p>
</td></tr>
<tr><td><code id="plot.emaxsimobj_+3A_xlim">xlim</code></td>
<td>
<p>x-axis limits </p>
</td></tr>
<tr><td><code id="plot.emaxsimobj_+3A_xat">xat</code></td>
<td>
<p>The points at which tick-marks are to be drawn. Errors occur if the 
points are outside the range of xlim. By default (when NULL) tickmark locations are    computed.</p>
</td></tr>
<tr><td><code id="plot.emaxsimobj_+3A_ylim">ylim</code></td>
<td>
<p>y-axis limits </p>
</td></tr>
<tr><td><code id="plot.emaxsimobj_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label </p>
</td></tr>
<tr><td><code id="plot.emaxsimobj_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label </p>
</td></tr>
<tr><td><code id="plot.emaxsimobj_+3A_plotdif">plotDif</code></td>
<td>
<p>When <code>TRUE</code>, the difference with placebo is plotted.</p>
</td></tr>
<tr><td><code id="plot.emaxsimobj_+3A_plotresid">plotResid</code></td>
<td>
<p>When <code>TRUE</code>, residuals (dose group means) are plotted.</p>
</td></tr>
<tr><td><code id="plot.emaxsimobj_+3A_clev">clev</code></td>
<td>
<p>Level for confidence intervals </p>
</td></tr>
<tr><td><code id="plot.emaxsimobj_+3A_plotpop">plotPop</code></td>
<td>
<p>Plot population dose response curve when plotPop='m'
using linear interpolation between population means, when PlotPop='3'
or '4',
using the population Emax parameters that must be supplied with the
data generator (see <a href="#topic+FixedMean">FixedMean</a> or <a href="#topic+RandEmax">RandEmax</a>).  If
the Emax parameters are not available, linear interpolation is
used.</p>
</td></tr>
<tr><td><code id="plot.emaxsimobj_+3A_negc">negC</code></td>
<td>
<p>If the ED50&lt;lower ED50 limit, TRUE causes the Emax
model to be plotted in addition to the alternative
model selected.</p>
</td></tr>
<tr><td><code id="plot.emaxsimobj_+3A_logscale">logScale</code></td>
<td>
<p>If <code>TRUE</code>, log scale is used for dose.</p>
</td></tr>
<tr><td><code id="plot.emaxsimobj_+3A_predict">predict</code></td>
<td>
<p>When <code>TRUE</code>, predictive intervals are plotted
with grey errorbars in addition to the confidence intervals.</p>
</td></tr>
<tr><td><code id="plot.emaxsimobj_+3A_plot">plot</code></td>
<td>
<p>Return plotting output without plotting.</p>
</td></tr>  
<tr><td><code id="plot.emaxsimobj_+3A_...">...</code></td>
<td>
<p>Other plot parameters (not used). </p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object is returned
</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

<p><code><a href="#topic+emaxsim">emaxsim</a></code>, <code><a href="#topic+print.emaxsimobj">print.emaxsimobj</a></code>,
<code><a href="#topic+summary.emaxsimobj">summary.emaxsimobj</a></code>, <code><a href="#topic+update.emaxsimobj">update.emaxsimobj</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## emaxsim changes the random number seed

nsim&lt;-50
idmax&lt;-5
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop)  

###FixedMean is specialized constructor function for emaxsim
gen.parm&lt;-FixedMean(n,doselev,meanlev,sdy)  
D1 &lt;- emaxsim(nsim,gen.parm)
e49&lt;-D1[49]

plot(e49,clev=0.8)  

## End(Not run)

</code></pre>

<hr>
<h2 id='plot.fitEmax'>Plot a Emax model and dose group means.
</h2><span id='topic+plot.fitEmax'></span>

<h3>Description</h3>

<p>Plot an Emax model stored in an object
created by function <code>fitEmax</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitEmax'
plot(
          x,int=0,plotResid=FALSE,clev=0.9,
          predict=TRUE,plotci=TRUE,plotDif=FALSE,
          xlab='Dose',
          ylab=ifelse(plotResid,'Residuals',ifelse(plotDif,
                'Difference With Placebo','Response')),
          ncol=NULL,
          symbol=NULL,symbolLabel='Group',symbolShape=8,
          symbolColor='red',symbolSize=4,
          bwidth=NULL,
          xlim=NULL,
          xat=NULL,
          ylim=NULL,
          logScale=FALSE,       
          ngrid=200,
          plot=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.fitEmax_+3A_x">x</code></td>
<td>
<p>Output of <code><a href="#topic+fitEmax">fitEmax</a></code> with class
&quot;fitEmax&quot;.</p>
</td></tr>
<tr><td><code id="plot.fitEmax_+3A_int">int</code></td>
<td>
<p>The index for the protocol (intercept) to use for the predictions 
and computation of dose group means and standard errors.  The default
value is <code>0</code>, which displays all protocols in a grid layout.</p>
</td></tr>
<tr><td><code id="plot.fitEmax_+3A_plotresid">plotResid</code></td>
<td>
<p>If <code>TRUE</code>, a residual plot of the observed dose group means  
is produced instead of a dose response curve plot.</p>
</td></tr>
<tr><td><code id="plot.fitEmax_+3A_clev">clev</code></td>
<td>
<p>Confidence level for intervals about the estimated
mean for each dose.</p>
</td></tr>
<tr><td><code id="plot.fitEmax_+3A_predict">predict</code></td>
<td>
<p>When predict=TRUE, predictive intervals for sample dose group
means are plotted.  They are gray-shaded bars. If there is <code>&gt;1</code> symbol group
mean for a protocol/dose combination, then the smaller sample size is used when computing
the prediction interval.</p>
</td></tr>
<tr><td><code id="plot.fitEmax_+3A_plotci">plotci</code></td>
<td>
<p>When plotCI=TRUE, confidence intervals for the population dose group
means are plotted.  They are black bars.</p>
</td></tr>
<tr><td><code id="plot.fitEmax_+3A_plotdif">plotDif</code></td>
<td>
<p>Plot difference between doses and placebo.  It is assumed the lowest
dose in each protocol is placebo.</p>
</td></tr>
<tr><td><code id="plot.fitEmax_+3A_xlab">xlab</code></td>
<td>
<p>Label for the x-axis</p>
</td></tr>
<tr><td><code id="plot.fitEmax_+3A_ylab">ylab</code></td>
<td>
<p>Label for the y-axis</p>
</td></tr>
<tr><td><code id="plot.fitEmax_+3A_ncol">ncol</code></td>
<td>
<p>When more than one protocol is plotted, <code>ncol</code> specifies
the number of side by side plots in the plot grid.  The default is 3 or
5 depending on the plot type</p>
</td></tr>
<tr><td><code id="plot.fitEmax_+3A_symbol">symbol</code></td>
<td>
<p>An optional grouping variable.  
The values of symbol must correspond to the original data used in 
<code>fitEmax</code>.</p>
</td></tr>
<tr><td><code id="plot.fitEmax_+3A_symbollabel">symbolLabel</code></td>
<td>
<p>Label given to symbol in plot legend.</p>
</td></tr>
<tr><td><code id="plot.fitEmax_+3A_symbolshape">symbolShape</code></td>
<td>
<p>A character vector with named elements giving 
the shapes assigned
to different levels of variable <code>symbol</code>.  If a single shape is 
specified, it is replicated for all dose group means.  See package
<code>ggplot2</code> for symbol mappings.</p>
</td></tr>
<tr><td><code id="plot.fitEmax_+3A_symbolcolor">symbolColor</code></td>
<td>
<p>A character vector with named elements 
giving the colors assigned
to different levels of variable <code>symbol</code>.  If a single color is 
specified, it is replicated for all dose group means.  See package
<code>ggplot2</code> for color mappings.</p>
</td></tr>
<tr><td><code id="plot.fitEmax_+3A_symbolsize">symbolSize</code></td>
<td>
<p>The size of the symbol for the dose group sample means.   
Set <code>symbolSize=0</code> to supress plotting the means.</p>
</td></tr>
<tr><td><code id="plot.fitEmax_+3A_bwidth">bwidth</code></td>
<td>
<p>Width of the cap on the predictive interval bars.</p>
</td></tr>
<tr><td><code id="plot.fitEmax_+3A_xlim">xlim</code></td>
<td>
<p>Plot limits for the x-axis</p>
</td></tr>
<tr><td><code id="plot.fitEmax_+3A_xat">xat</code></td>
<td>
<p>The points at which tick-marks are to be drawn. Errors occur if the 
points are outside the range of xlim. By default (when NULL) tickmark locations are    computed.</p>
</td></tr>  
<tr><td><code id="plot.fitEmax_+3A_ylim">ylim</code></td>
<td>
<p>Plot limits for the y-axis</p>
</td></tr>
<tr><td><code id="plot.fitEmax_+3A_logscale">logScale</code></td>
<td>
<p>If <code>TRUE</code>, log scale is used for dose.</p>
</td></tr>
<tr><td><code id="plot.fitEmax_+3A_ngrid">ngrid</code></td>
<td>
<p>The number doses evaluated when plotting the curve.</p>
</td></tr>
<tr><td><code id="plot.fitEmax_+3A_plot">plot</code></td>
<td>
<p>Return plotting output without plotting.</p>
</td></tr>
<tr><td><code id="plot.fitEmax_+3A_...">...</code></td>
<td>
<p>No additional plotting options are currently used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Model estimates, standard errors, and confidence bounds are computed 
using function <code><a href="#topic+SeEmax">SeEmax</a></code>.   
</p>
<p>The function generates random numbers when <code>predict=TRUE</code>, so the random number generator/seed must
be set before the function is called for exact reproducibility.
</p>


<h3>Value</h3>

<p>A list with ggplot object, and a matrix with the confidence and prediction interval
limits.
</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+nls">nls</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>### example changes the random number seed

doselev&lt;-c(0,5,25,50,100,350)
n&lt;-c(78,81,81,81,77,80)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-8.0
pop.parm&lt;-c(log(ed50),emax,e0)    
dose&lt;-rep(doselev,n)
meanlev&lt;-emaxfun(dose,pop.parm)  

y&lt;-rnorm(sum(n),meanlev,sdy)

testout&lt;-fitEmax(y,dose,modType=4)

plot(testout)
</code></pre>

<hr>
<h2 id='plot.fitEmaxB'>Plot a Emax model and dose group means.
</h2><span id='topic+plot.fitEmaxB'></span>

<h3>Description</h3>

<p>Plot an Emax model stored in an object
created by function <code>fitEmaxB</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitEmaxB'
plot(
      x,int=0,plotResid=FALSE,clev=0.9,
      predict=TRUE,plotci=TRUE,plotDif=FALSE,
      xlab='Dose',
      ylab=ifelse(plotResid,'Residuals',ifelse(plotDif,
            'Difference With Placebo','Response')),
      ncol=NULL,
      symbol=NULL,symbolLabel='Group',symbolShape=8,
      symbolColor='red',symbolSize=4,
      bwidth=NULL,
      xlim=NULL,
      xat=NULL,
      ylim=NULL,
      logScale=FALSE,       
      ngrid=200,
      plot=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.fitEmaxB_+3A_x">x</code></td>
<td>
<p>Output of <code><a href="#topic+fitEmaxB">fitEmaxB</a></code> with class
&quot;fitEmaxB&quot;.</p>
</td></tr>
<tr><td><code id="plot.fitEmaxB_+3A_int">int</code></td>
<td>
<p>The index for the protocol (intercept) to use for the predictions 
and computation of dose group means/proportions.  The default
value is <code>0</code>, which displays all protocols in a grid layout.</p>
</td></tr>
<tr><td><code id="plot.fitEmaxB_+3A_plotresid">plotResid</code></td>
<td>
<p>If <code>TRUE</code>, a residual plot of the observed 
dose group means/proportions  
less the model-based MCMC median estimates of the means/proportions.</p>
</td></tr>
<tr><td><code id="plot.fitEmaxB_+3A_clev">clev</code></td>
<td>
<p>Level for posterior probability intervals about the 
mean/proportion for each dose.</p>
</td></tr>
<tr><td><code id="plot.fitEmaxB_+3A_predict">predict</code></td>
<td>
<p>When predict=TRUE, predictive intervals for sample dose group
means/proportions are plotted.  They are gray-shaded bars. If there is <code>&gt;1</code> symbol group
mean/proportion for a protocol/dose combination, then the smaller sample size is used when computing
the prediction interval.</p>
</td></tr>
<tr><td><code id="plot.fitEmaxB_+3A_plotci">plotci</code></td>
<td>
<p>When plotCI=TRUE, posterior intervals for the population dose group
means/proportions are plotted.  They are black bars.</p>
</td></tr>
<tr><td><code id="plot.fitEmaxB_+3A_plotdif">plotDif</code></td>
<td>
<p>Plot difference between doses and placebo.  It is assumed the lowest
dose in each protocol is placebo.</p>
</td></tr>
<tr><td><code id="plot.fitEmaxB_+3A_xlab">xlab</code></td>
<td>
<p>Label for the x-axis</p>
</td></tr>
<tr><td><code id="plot.fitEmaxB_+3A_ylab">ylab</code></td>
<td>
<p>Label for the y-axis</p>
</td></tr>
<tr><td><code id="plot.fitEmaxB_+3A_ncol">ncol</code></td>
<td>
<p>When more than one protocol is plotted, <code>ncol</code> specifies
the number of side by side plots in the plot grid.  The default is 3 or
5 depending on the plot type</p>
</td></tr> 
<tr><td><code id="plot.fitEmaxB_+3A_symbol">symbol</code></td>
<td>
<p>An optional grouping variable.  
The values of symbol must correspond to the original data used in 
<code>fitEmax</code>.</p>
</td></tr>
<tr><td><code id="plot.fitEmaxB_+3A_symbollabel">symbolLabel</code></td>
<td>
<p>Label given to symbol in plot legend.</p>
</td></tr>
<tr><td><code id="plot.fitEmaxB_+3A_symbolshape">symbolShape</code></td>
<td>
<p>A character vector with named elements giving 
the shapes assigned
to different levels of variable <code>symbol</code>.  If a single shape is 
specified, it is replicated for all dose group means/proportions.  See package
<code>ggplot2</code> for symbol mappings.</p>
</td></tr>
<tr><td><code id="plot.fitEmaxB_+3A_symbolcolor">symbolColor</code></td>
<td>
<p>A character vector with named elements 
giving the colors assigned
to different levels of variable <code>symbol</code>.  If a single color is 
specified, it is replicated for all dose group means/proportions.  See package
<code>ggplot2</code> for color mappings.</p>
</td></tr>
<tr><td><code id="plot.fitEmaxB_+3A_symbolsize">symbolSize</code></td>
<td>
<p>The size of the symbol for the dose group sample means.   
Set <code>symbolSize=0</code> to supress plotting the means.</p>
</td></tr>
<tr><td><code id="plot.fitEmaxB_+3A_bwidth">bwidth</code></td>
<td>
<p>Width of the cap on the predictive interval bars.</p>
</td></tr>
<tr><td><code id="plot.fitEmaxB_+3A_xlim">xlim</code></td>
<td>
<p>Plot limits for the x-axis</p>
</td></tr>
<tr><td><code id="plot.fitEmaxB_+3A_xat">xat</code></td>
<td>
<p>The points at which tick-marks are to be drawn. Errors occur if the 
points are outside the range of xlim. By default (when NULL) tickmark locations are computed.</p>
</td></tr>  
<tr><td><code id="plot.fitEmaxB_+3A_ylim">ylim</code></td>
<td>
<p>Plot limits for the y-axis</p>
</td></tr>
<tr><td><code id="plot.fitEmaxB_+3A_logscale">logScale</code></td>
<td>
<p>If <code>TRUE</code>, log scale is used for dose.</p>
</td></tr>
<tr><td><code id="plot.fitEmaxB_+3A_ngrid">ngrid</code></td>
<td>
<p>The number doses evaluated when plotting the curve.</p>
</td></tr>
<tr><td><code id="plot.fitEmaxB_+3A_plot">plot</code></td>
<td>
<p>Return plotting output without plotting.</p>
</td></tr>
<tr><td><code id="plot.fitEmaxB_+3A_...">...</code></td>
<td>
<p>No additional plotting options are currently used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Model-based medians, standard deviations, and interval bounds for the dose groups means/proportions based on the MCMC parameters evaluated in the Emax function.   
</p>
<p>The function generates random numbers when <code>predict=TRUE</code>, so the random number generator/seed must
be set before the function is called for exact reproducibility.
</p>
<p>If baseline covaraties were included in the fit, then the mean of the predictions for
the protocol given by <code>int</code> is plotted.  This can be computationally intensive
when the dosing grid is dense, the MCMC sample size is large, and the input sample
size is large.  Consider reducing <code>ngrid</code> in this situation.  
Note that the protocol must be specified, or the prediction defaults to patients
from the first protocol.
</p>


<h3>Value</h3>

<p>A list with ggplot object, and posterior and prediction interval
limits.
</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

<p><code><a href="#topic+fitEmaxB">fitEmaxB</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

data("metaData")
exdat&lt;-metaData[metaData$taid==1,]

prior&lt;-emaxPrior.control(epmu=0,epsca=4,difTargetmu=0,difTargetsca=4,dTarget=20,
				p50=(2+5)/2,
				sigmalow=0.01,sigmaup=3)
										
mcmc&lt;-mcmc.control(chains=3)

msSat&lt;-sum((exdat$sampsize-1)*(exdat$sd)^2)/(sum(exdat$sampsize)-length(exdat$sampsize))
fitout&lt;-fitEmaxB(exdat$rslt,exdat$dose,prior,modType=4,prot=exdat$protid,
				count=exdat$sampsize,msSat=msSat,mcmc=mcmc)
plot(fitout)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.plotB'>Plot Bayes dose response curve and dose group means  </h2><span id='topic+plot.plotB'></span>

<h3>Description</h3>

<p>Plot a dose response curve fit by Bayes MCMC methods
(with optional posterior interval bars).  Also plot dose
group means (with optional CI bars)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plotB'
plot( x,
	plotDif= FALSE, plotMed= FALSE, 
	plotResid=FALSE, predict= TRUE,
	logScale=FALSE,
	xlim,
	xat=NULL,
	ylim,  
	xlab, 
	ylab,labac='Act Comp',shapeac=8,colac='red',  
	symbolLabel='Group',symbolShape=8,
	symbolColor='red',symbolSize=4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.plotB_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+plotB">plotB</a></code> object output from function <code>plotB</code>.</p>
</td></tr>
<tr><td><code id="plot.plotB_+3A_plotdif">plotDif</code></td>
<td>
<p>Plot difference between doses and placebo. 
It is assumed the lowest dose is placebo. If <code>activeControl</code>, the
difference is with the active control mean, and the active 
controls are not plotted.</p>
</td></tr>
<tr><td><code id="plot.plotB_+3A_plotmed">plotMed</code></td>
<td>
<p>If TRUE, model-based curves are medians rather than means.</p>
</td></tr>
<tr><td><code id="plot.plotB_+3A_plotresid">plotResid</code></td>
<td>
<p>If TRUE, a plot of the residuals formed from the
dose group means minus the posterior dose group means.</p>
</td></tr>
<tr><td><code id="plot.plotB_+3A_predict">predict</code></td>
<td>
<p>When predict=TRUE, predictive intervals for sample dose group
proportions are plotted.  They are gray-shaded bars.</p>
</td></tr>
<tr><td><code id="plot.plotB_+3A_logscale">logScale</code></td>
<td>
<p>If <code>TRUE</code>, log scale is used for dose.</p>
</td></tr>
<tr><td><code id="plot.plotB_+3A_xlim">xlim</code></td>
<td>
<p>x-axis limits </p>
</td></tr>
<tr><td><code id="plot.plotB_+3A_xat">xat</code></td>
<td>
<p>The points at which tick-marks are to be drawn. Errors occur if the 
points are outside the range of xlim. By default (when NULL) tickmark locations are    computed.</p>
</td></tr>
<tr><td><code id="plot.plotB_+3A_ylim">ylim</code></td>
<td>
<p>y-axis limits </p>
</td></tr>
<tr><td><code id="plot.plotB_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label </p>
</td></tr>
<tr><td><code id="plot.plotB_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label </p>
</td></tr>
<tr><td><code id="plot.plotB_+3A_labac">labac</code></td>
<td>
<p>x-axis label for the active control group.</p>
</td></tr>
<tr><td><code id="plot.plotB_+3A_shapeac">shapeac</code></td>
<td>
<p>Shape of the symbol for the active control group.</p>
</td></tr>
<tr><td><code id="plot.plotB_+3A_colac">colac</code></td>
<td>
<p>Color of the symbol for the active control group.</p>
</td></tr>
<tr><td><code id="plot.plotB_+3A_symbollabel">symbolLabel</code></td>
<td>
<p>Label given to symbol in plot legend.</p>
</td></tr>
<tr><td><code id="plot.plotB_+3A_symbolshape">symbolShape</code></td>
<td>
<p>A character vector with names giving the shapes assigned
to different levels of variable <code>symbol</code>.  If a single shape is 
specified, it is replicated for all dose groups.  See package
<code>ggplot2</code> for symbol mappings.</p>
</td></tr>
<tr><td><code id="plot.plotB_+3A_symbolcolor">symbolColor</code></td>
<td>
<p>A character vector with names giving the colors assigned
to different levels of variable <code>symbol</code>.  If a single color is 
specified, it is replicated for all dose groups.  See package
<code>ggplot2</code> for color mappings.</p>
</td></tr>
<tr><td><code id="plot.plotB_+3A_symbolsize">symbolSize</code></td>
<td>
<p>The size of the symbol for the dose group sample means.   
Set <code>symbolSize=0</code> to supress plotting.</p>
</td></tr>
<tr><td><code id="plot.plotB_+3A_...">...</code></td>
<td>
<p>Additional parameters (not used)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Produce additional plots from output of <code><a href="#topic+plotB">plotB</a></code> without
any re-computing.  A plot is produced by default on return from the
function.  When active control is specified, the plot is 'printed'
within the function.  If there is a symbol group variable, it must be
specified when <code>plotB</code> is executed.  The symbol label, shape, color,
and size must be re-specified in subsequent plot requests.</p>


<h3>Value</h3>

<p>ggplot object of the dose response curve, which will be plotted by
default unless the output of the plot is assigned.  When an active
control group is present, the value returned is an invisible list with the
ggplot for the dosing data, and a second ggplot for the ac data.</p>


<h3>Note</h3>

<p>PlotB can also be used with draws from a prior distribution to
evaluate the prior dose response curve.
</p>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>See Also</h3>

<p><code><a href="#topic+plotB">plotB</a></code>, <code><a href="#topic+plotD">plotD</a></code>,  <code><a href="#topic+plot.fitEmax">plot.fitEmax</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("metaData")
exdat&lt;-metaData[metaData$taid==6 &amp; metaData$poptype==1,]

prior&lt;-emaxPrior.control(epmu=0,epsca=100,difTargetmu=0,difTargetsca=100,dTarget=80.0,
        p50=3.75,sigmalow=0.01,sigmaup=20)
mcmc&lt;-mcmc.control(chains=3)

msSat&lt;-sum((exdat$sampsize-1)*(exdat$sd)^2)/(sum(exdat$sampsize)-length(exdat$sampsize))
fitout&lt;-fitEmaxB(exdat$rslt,exdat$dose,prior,modType=4,
				count=exdat$sampsize,msSat=msSat,mcmc=mcmc)
parms&lt;-coef(fitout)[,1:4]  #use first intercept

outB&lt;-plotB(exdat$rslt,exdat$dose,parms, sigma2=(sigma(fitout))^2,
			ylab="Change in EDD")
			
plot(outB,plotDif=TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='plotB'>Plot Bayes  dose response curve and dose group means  </h2><span id='topic+plotB'></span>

<h3>Description</h3>

<p>Plot a dose response curve fit by Bayes MCMC methods
(with optional posterior interval bars).  Also plot dose
group means (with optional CI bars)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotB(y, 
	dose, 
	parm, 
	sigma2,
	count=rep(1,length(y)),
	dgrid=sort(unique(c(seq(0,max(dose),length=50), dose))),
	predict= TRUE,plotDif=FALSE,plotMed=FALSE,
	plotResid=FALSE,clev=0.9,
	binary=c('no','logit','probit','BinRes'),BinResLev,
	BinResDir=c('&gt;','&lt;'),
	activeControl=FALSE,ac,yac,
	countac=rep(1,length(yac)),
	labac='Act Comp',shapeac=8,colac='red',
	symbol,symbolLabel='Group',symbolShape=8,
	symbolColor='red',symbolSize=4,
	xlim,ylim,xat=NULL,xlab="Dose",
	ylab=ifelse(plotDif,"Diff with Comparator","Mean"),
	modelFun=emaxfun,makePlot=TRUE,
	...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotB_+3A_y">y</code></td>
<td>
<p>Outcomes, which may be sample means (see <code>counts</code>).  LSmeans from a saturated anacova 
model can be supplied, in 
which case it is assumed that the Bayesian dose response model also included the additive
baseline covariates.</p>
</td></tr>
<tr><td><code id="plotB_+3A_dose">dose</code></td>
<td>
<p>Doses corresponding to outcomes </p>
</td></tr>
<tr><td><code id="plotB_+3A_parm">parm</code></td>
<td>
<p>Matrix of simultated parameter values (each row is a
simulated parameter vector).  The <code>parm</code> values
must be constructed for use in the model function <code>modFun</code>.  The
default is a 4-parameter Emax model with parameters
(log(ED50),lambda,Emax,E0).  For a 3-parameter model, set lambda=1 for each
simulated parameter vector.</p>
</td></tr>
<tr><td><code id="plotB_+3A_sigma2">sigma2</code></td>
<td>
<p>Simulated draws from the residual variance (assumed
additive, homogeneous).  The length of <code>sigma2</code> must be the same
as the number of rows of <code>parm</code>.  Set <code>sigma2</code> to all ones
for binary data.</p>
</td></tr>
<tr><td><code id="plotB_+3A_count">count</code></td>
<td>
<p>Sample sizes for means-only summarized data.</p>
</td></tr>
<tr><td><code id="plotB_+3A_dgrid">dgrid</code></td>
<td>
<p>The Bayes posterior summaries are evaluated and plotted on
the <code>dgrid</code> dosing values </p>
</td></tr>
<tr><td><code id="plotB_+3A_predict">predict</code></td>
<td>
<p>If TRUE(default), the plotted intervals are
predictive intervals for the dose group sample means.</p>
</td></tr>
<tr><td><code id="plotB_+3A_plotdif">plotDif</code></td>
<td>
<p>Plot difference between doses and placebo. 
It is assumed the lowest dose is placebo. If <code>activeControl</code>, the
difference is with the active control mean, and the active 
controls are not plotted.</p>
</td></tr>
<tr><td><code id="plotB_+3A_plotmed">plotMed</code></td>
<td>
<p>If TRUE, model-based curves are medians rather than means.</p>
</td></tr>
<tr><td><code id="plotB_+3A_plotresid">plotResid</code></td>
<td>
<p>If TRUE, a plot of the residuals formed from the
dose group means minus the posterior dose group means.</p>
</td></tr>
<tr><td><code id="plotB_+3A_clev">clev</code></td>
<td>
<p>Level for confidence and Bayes intervals </p>
</td></tr>
<tr><td><code id="plotB_+3A_binary">binary</code></td>
<td>
<p>If <code>binary</code> is 'logit' or 'probit', <code>y</code> 
is assumed to be binary and the appropriate backtransformation is applied
to the Emax model output.  If <code>binary</code> is 'BinRes', the continuous
variable <code>y</code> is converted to a binary responder variable
using <code>BinResLev</code> and <code>BinResDir</code>.  The 
continuous Emax model output is converted to binary estimation and
prediction assuming normally distributed residuals.</p>
</td></tr>
<tr><td><code id="plotB_+3A_binreslev">BinResLev</code></td>
<td>
<p>A cut level for a responder variable formed from a 
continuous endpoint.  Rates are computed from the (continuous
outcome) model parameters assuming normally distributed residuals.  The
input <code>y</code> variable is converted to a responder variable.</p>
</td></tr>
<tr><td><code id="plotB_+3A_binresdir">BinResDir</code></td>
<td>
<p>If BinResDir='&gt;', the responder variable is 1 when
<code>y</code> is greater than the cut level, otherwise, it is 1 when <code>y</code> is less
than the cut level.</p>
</td></tr>
<tr><td><code id="plotB_+3A_activecontrol">activeControl</code></td>
<td>
<p>When TRUE, active comparator data must be supplied.  Each
dose group (including PBO) are compared to the active comparator rather than PBO.</p>
</td></tr>
<tr><td><code id="plotB_+3A_ac">ac</code></td>
<td>
<p>Simulations from the posterior distribution of the mean response on 
active comparator.  The number of simulations must match those for the dose
response model.  For binary data, the simulated values must be transformed to the
proportion scale.  This differs from the simulated model parameters.</p>
</td></tr>
<tr><td><code id="plotB_+3A_yac">yac</code></td>
<td>
<p>Outcomes for the active comparator group.  The coding conventions for 
<code>y</code> are used.</p>
</td></tr>
<tr><td><code id="plotB_+3A_countac">countac</code></td>
<td>
<p>Sample sizes for summarized data corresponding to <code>count</code>.</p>
</td></tr>
<tr><td><code id="plotB_+3A_labac">labac</code></td>
<td>
<p>x-axis label for the active control group.</p>
</td></tr>
<tr><td><code id="plotB_+3A_shapeac">shapeac</code></td>
<td>
<p>Shape of the symbol for the active control group.</p>
</td></tr>
<tr><td><code id="plotB_+3A_colac">colac</code></td>
<td>
<p>Color of the symbol for the active control group.</p>
</td></tr>
<tr><td><code id="plotB_+3A_symbol">symbol</code></td>
<td>
<p>An optional grouping variable for the dose group sample means.</p>
</td></tr>  
<tr><td><code id="plotB_+3A_symbollabel">symbolLabel</code></td>
<td>
<p>Label given to symbol in plot legend.</p>
</td></tr>
<tr><td><code id="plotB_+3A_symbolshape">symbolShape</code></td>
<td>
<p>A character vector with names giving the shapes assigned
to different levels of variable <code>symbol</code>.  If a single shape is 
specified, it is replicated for all dose groups.  See package
<code>ggplot2</code> for symbol mappings.</p>
</td></tr>
<tr><td><code id="plotB_+3A_symbolcolor">symbolColor</code></td>
<td>
<p>A character vector with names giving the colors assigned
to different levels of variable <code>symbol</code>.  If a single color is 
specified, it is replicated for all dose groups.  See package
<code>ggplot2</code> for color mappings.</p>
</td></tr>
<tr><td><code id="plotB_+3A_symbolsize">symbolSize</code></td>
<td>
<p>The size of the symbol for the dose group sample means.   
Set <code>symbolSize=0</code> to supress plotting.</p>
</td></tr>
<tr><td><code id="plotB_+3A_xlim">xlim</code></td>
<td>
<p>Plot limits for the x-axis</p>
</td></tr>
<tr><td><code id="plotB_+3A_ylim">ylim</code></td>
<td>
<p>Plot limits for the y-axis</p>
</td></tr>
<tr><td><code id="plotB_+3A_xat">xat</code></td>
<td>
<p>The points at which tick-marks are to be drawn. Errors occur if the 
points are outside the range of xlim. By default (when NULL) tickmark locations are    computed.</p>
</td></tr>
<tr><td><code id="plotB_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label </p>
</td></tr>
<tr><td><code id="plotB_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label </p>
</td></tr>
<tr><td><code id="plotB_+3A_modelfun">modelFun</code></td>
<td>
<p>The mean model function.  The first argument is a
scalar dose, and the second argument is a matrix of parameter values.
The rows of the matrix are random draws of parameter vectors for the
model.  The default function is the 4-parameter Emax function <code>emaxfun</code>.</p>
</td></tr>
<tr><td><code id="plotB_+3A_makeplot">makePlot</code></td>
<td>
<p>If FALSE, create numerical output but no plot.</p>
</td></tr>
<tr><td><code id="plotB_+3A_...">...</code></td>
<td>
<p> Parameters passed to generic plot function (not used) </p>
</td></tr>
</table>


<h3>Details</h3>

<p>A sample of parameters from the joint posterior distribution must be supplied (typically produced by BUGS).
The Bayesian dose response curve is the Bayes posterior mean (or median) at each
value on <code>dgrid</code>.  The bar (interval) is the (clev/2,1-clev/2)
Bayes posterior interval (which can differ from the Bayes HPD
interval).  The intervals are plotted only at the dose levels included
in the study.  Predictive intervals  are formed by
adding independent random draws from the sampling distributions of the dose group
sample means to the population means.
</p>
<p>The function generates random numbers when <code>predict=TRUE</code>, so the random number generator/seed must
be set before the function is called for exact reproducibility.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>plotB</code>.  Three  inputs are saved for
later plotting:  doses in the original design, dgrid, and clev.  
The following matrices are saved:
</p>
<table>
<tr><td><code>pairwise</code></td>
<td>
<p>The dose group means and their 
differences with placebo.  If a <code>baseline</code> is
supplied, the means are lsmeans adjusted to the mean baseline value.</p>
</td></tr>
<tr><td><code>modelABS</code></td>
<td>
<p>Model-based posterior mean, median, 
posterior (clev/2,1-clev/2) intervals for the population means and
sample means.  One row per dose group</p>
</td></tr>
<tr><td><code>modelABSG</code></td>
<td>
<p>Same as <code>modelABS</code> but computed on the input
grid of doses.</p>
</td></tr>
<tr><td><code>modelDIF</code></td>
<td>
<p>Same as modelABS but with differences from placebo.</p>
</td></tr>
<tr><td><code>modelDIFG</code></td>
<td>
<p>Same as modelDIF  but computed on the input
grid of doses.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>PlotB can also be used with draws from a prior distribution to
evaluate the prior dose response curve.
</p>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>References</h3>

<p> Spiegelhalter, D., Thomas, A., Best, N., and Lunn, D. (2003),<em> WinBUGS User Manual Version 1.4</em>, Electronic version www.mrc-bsu.cam.ac.uk/bugs </p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.plotB">plot.plotB</a></code>, <code><a href="#topic+plotD">plotD</a></code>,  <code><a href="#topic+plot.fitEmax">plot.fitEmax</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("metaData")
exdat&lt;-metaData[metaData$taid==6 &amp; metaData$poptype==1,]

prior&lt;-emaxPrior.control(epmu=0,epsca=100,difTargetmu=0,difTargetsca=100,dTarget=80.0,
        p50=3.75,sigmalow=0.01,sigmaup=20)
mcmc&lt;-mcmc.control(chains=3)

msSat&lt;-sum((exdat$sampsize-1)*(exdat$sd)^2)/(sum(exdat$sampsize)-length(exdat$sampsize))
fitout&lt;-fitEmaxB(exdat$rslt,exdat$dose,prior,modType=4,
				count=exdat$sampsize,msSat=msSat,mcmc=mcmc)
parms&lt;-coef(fitout)[,1:4]  #use first intercept

outB&lt;-plotB(exdat$rslt,exdat$dose,parms, sigma2=(sigma(fitout))^2,
			ylab="Change in EDD")
			
plot(outB,plotDif=TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='plotBdensity'>Density plot displaying Bayes prior or posterior dose response</h2><span id='topic+plotBdensity'></span>

<h3>Description</h3>

<p>Density plot over a grid of doses displaying the prior 
or posterior distribution for the mean dose response computed from 
simulated input model parameters.</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotBdensity(dgrid, 
      parm, 
      modelFun=emaxfun,
      qlevL=c(0.025,0.05,0.10,0.25),
      plotDif= FALSE,
      logit= FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotBdensity_+3A_dgrid">dgrid</code></td>
<td>
<p>The Bayes prior or posterior summaries are evaluated and plotted on
the <code>dgrid</code> dosing values </p>
</td></tr>
<tr><td><code id="plotBdensity_+3A_parm">parm</code></td>
<td>
<p>Matrix of simultated parameter values (each row is a
simulated parameter vector).  The <code>parm</code> values
must be constructed for use in the model function <code>modFun</code>.  The
default is a 4-parameter Emax model with parameters
(log(ED50),lambda,Emax,E0).  For a 3-parameter model, set lambda=1 for each
simulated parameter vector.</p>
</td></tr>
<tr><td><code id="plotBdensity_+3A_modelfun">modelFun</code></td>
<td>
<p>The mean model function.  The first argument is a
scalar dose, and the second argument is a matrix of parameter values.
The rows of the matrix are random draws of parameter vectors for the
model.  The default function is the 4-parameter Emax function <code>emaxfun</code>.</p>
</td></tr>
<tr><td><code id="plotBdensity_+3A_qlevl">qlevL</code></td>
<td>
<p>Intervals are formed with percentile boundaries at (qlevL,1-qlevL).  
<code>qlevL</code> must be increasing between (0,0.5).</p>
</td></tr>
<tr><td><code id="plotBdensity_+3A_plotdif">plotDif</code></td>
<td>
<p>If TRUE, plot difference between doses and placebo.</p>
</td></tr>
<tr><td><code id="plotBdensity_+3A_logit">logit</code></td>
<td>
<p>Default is F.  If T, inverse logit transform applied to
Emax function output for comparison to dose group sample proportions.</p>
</td></tr>
<tr><td><code id="plotBdensity_+3A_...">...</code></td>
<td>
<p> Parameters passed to generic plot function </p>
</td></tr>
</table>


<h3>Details</h3>

<p>A sample of parameters from the joint prior or posterior distribution 
must be supplied (typically produced by BUGS).  A density plot with
contours corresponding to the perentiles in qlevL created by function
<code><a href="#topic+DRDensityPlot">DRDensityPlot</a></code> . </p>


<h3>Value</h3>

<p>A list containing two matrices with the number of rows equal to the number dose grid points, and columns corresponding to percentiles in <code>qlevL</code>:
</p>
<table>
<tr><td><code>qL</code></td>
<td>
<p>Lower perentiles from <code>qlevL</code> </p>
</td></tr>
<tr><td><code>qH</code></td>
<td>
<p>Upper percentiles 1-<code>qlevL</code>. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>References</h3>

<p> Spiegelhalter, D., Thomas, A., Best, N., and Lunn, D. (2003),<em> WinBUGS User Manual Version 1.4</em>, Electronic version www.mrc-bsu.cam.ac.uk/bugs </p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.plotB">plot.plotB</a></code>, <code><a href="#topic+plotD">plotD</a></code>,  <code><a href="#topic+plot.fitEmax">plot.fitEmax</a></code>,
<code><a href="#topic+DRDensityPlot">DRDensityPlot</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
data("metaData")
exdat&lt;-metaData[metaData$taid==6 &amp; metaData$poptype==1,]

prior&lt;-emaxPrior.control(epmu=0,epsca=10,difTargetmu=0,difTargetsca=10,dTarget=80.0,
        p50=3.75,sigmalow=0.01,sigmaup=20)
mcmc&lt;-mcmc.control(chains=3)

msSat&lt;-sum((exdat$sampsize-1)*(exdat$sd)^2)/(sum(exdat$sampsize)-length(exdat$sampsize))
fitout&lt;-fitEmaxB(exdat$rslt,exdat$dose,prior,modType=4,
				count=exdat$sampsize,msSat=msSat,mcmc=mcmc)
parms&lt;-coef(fitout)[,1:4]  #use first intercept

dgrid&lt;-seq(0,1,length=100)

pout&lt;-plotBdensity(dgrid,parm=parms)

pout2&lt;-plotBdensity(dgrid,parm=parms,plotDif=TRUE,
       xlab='Dose',ylab='Dif with PBO')

## End(Not run)

</code></pre>

<hr>
<h2 id='plotD'>Basic plot of dose group means</h2><span id='topic+plotD'></span>

<h3>Description</h3>

<p>Plot dose group means vs dose with options to connect points by
lines, and include CI about each dose group mean based on within-group
SDs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotD(y, dose, baseline, se = TRUE, line = TRUE, 
    meansOnly=FALSE,sem=NULL,clev = 0.9, 
    xlab='Dose',ylab='Response', logScale=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotD_+3A_y">y</code></td>
<td>
<p>Outcomes </p>
</td></tr>
<tr><td><code id="plotD_+3A_dose">dose</code></td>
<td>
<p>Doses corresponding to outcomes </p>
</td></tr>
<tr><td><code id="plotD_+3A_baseline">baseline</code></td>
<td>
<p>If present, ANACOVA means are plotted, adjusted for
baseline.  Baseline is optional.</p>
</td></tr>
<tr><td><code id="plotD_+3A_se">se</code></td>
<td>
<p>If T, plot CI for each dose group.</p>
</td></tr>
<tr><td><code id="plotD_+3A_line">line</code></td>
<td>
<p>If T, dose group means are connected by a line</p>
</td></tr>
<tr><td><code id="plotD_+3A_meansonly">meansOnly</code></td>
<td>
<p>If T, y contains dose group means rather than
individual observations.  Baseline cannot be specified.</p>
</td></tr>
<tr><td><code id="plotD_+3A_sem">sem</code></td>
<td>
<p>If meansOnly and se=T, sem must contain the corresponding
standard errors</p>
</td></tr>
<tr><td><code id="plotD_+3A_clev">clev</code></td>
<td>
<p>Level of CI for dose group means</p>
</td></tr>
<tr><td><code id="plotD_+3A_xlab">xlab</code></td>
<td>
<p>Label for x-axis</p>
</td></tr>
<tr><td><code id="plotD_+3A_ylab">ylab</code></td>
<td>
<p>Label for y-axis</p>
</td></tr>
<tr><td><code id="plotD_+3A_logscale">logScale</code></td>
<td>
<p>If <code>TRUE</code>, log scale is used for dose.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with the ggplot object and two vectors with
the dose group means and their standard errors.</p>


<h3>Author(s)</h3>

<p>Neal Thomas</p>


<h3>See Also</h3>

 <p><code><a href="#topic+plot.fitEmax">plot.fitEmax</a></code>, <code><a href="#topic+plotB">plotB</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data("metaData")
exdat&lt;-metaData[metaData$taid==2 &amp; metaData$etype==1,]
with(exdat,plotD(rslt,dose,meansOnly=TRUE,se=TRUE,sem=se,ylab=
"Y",xlab="Dose(mg)"))
</code></pre>

<hr>
<h2 id='predict.emaxalt'>Mean response and SE for specified doses for a
simulated object output by function emaxalt</h2><span id='topic+predict.emaxalt'></span>

<h3>Description</h3>

<p>Estimated mean and standard error for specified doses computed from
the output of a model fit by function
emaxalt.  Also returns mean difference with placebo and their
standard errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emaxalt'
predict(object,dose, dref=0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.emaxalt_+3A_object">object</code></td>
<td>
<p>Output of <code><a href="#topic+emaxalt">emaxalt</a></code> </p>
</td></tr>
<tr><td><code id="predict.emaxalt_+3A_dose">dose</code></td>
<td>
<p> Vector (can be a single value) of doses where dose
response curve is to be evaluated. </p>
</td></tr>
<tr><td><code id="predict.emaxalt_+3A_dref">dref</code></td>
<td>
<p>A reference dose (0 by default) for contrasts, but other values 
can be specified.  If specified, a single reference value must be given.
</p>
</td></tr>
<tr><td><code id="predict.emaxalt_+3A_...">...</code></td>
<td>
<p>Optional arguments are not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>fitpred</code></td>
<td>
<p>Vector with mean dose response estimate for each
specified dose.</p>
</td></tr>
<tr><td><code>fitdif</code></td>
<td>
<p>Corresponding differences with placebo.</p>
</td></tr>
<tr><td><code>sepred</code></td>
<td>
<p> SEs for <code>fitpred</code>.</p>
</td></tr>
<tr><td><code>sedif</code></td>
<td>
<p>SEs for <code>fitdif</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>See Also</h3>

 <p><code><a href="#topic+emaxalt">emaxalt</a></code>, <code><a href="#topic+predict.emaxsimobj">predict.emaxsimobj</a></code>,
<code><a href="#topic+predict.emaxsim">predict.emaxsim</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
## random number seed changed by this example

doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)
dose&lt;-rep(doselev,n)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop.parm&lt;-c(log(ed50),e0,emax)    
meanresp&lt;-emaxfun(dose,pop.parm)  
y&lt;-rnorm(sum(n),meanresp,sdy)

simout&lt;-emaxalt(y,dose)
predict(simout,c(75,150))

simout2&lt;-emaxalt(y,dose,modType=4)
predict(simout2,c(75,150))

## End(Not run)

</code></pre>

<hr>
<h2 id='predict.emaxsim'>Mean response and SE for specified doses for each replicate
data set in an emaxsim object </h2><span id='topic+predict.emaxsim'></span>

<h3>Description</h3>

<p>Estimated mean/proportion and standard error for each simulated data set in an
emaxsim object.  Also returns mean difference with placebo and their
standard errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emaxsim'
predict(object, 
         dose, dref=0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.emaxsim_+3A_object">object</code></td>
<td>
<p>Output of <code><a href="#topic+emaxsim">emaxsim</a></code> </p>
</td></tr>
<tr><td><code id="predict.emaxsim_+3A_dose">dose</code></td>
<td>
<p> Vector (can be a single value) of doses where dose
response curve is to be evaluated. </p>
</td></tr>
<tr><td><code id="predict.emaxsim_+3A_dref">dref</code></td>
<td>
<p>A reference dose (0 by default) for contrasts, but other values 
can be specified.  If specified, a single reference value must be given.
</p>
</td></tr>
<tr><td><code id="predict.emaxsim_+3A_...">...</code></td>
<td>
<p>Optional arguments are not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>fitpredv</code></td>
<td>
<p>Matrix with mean dose response estimate for each
simulated data set.  Number of columns is the number of doses
specified.</p>
</td></tr>
<tr><td><code>fitdifv</code></td>
<td>
<p>Matrix with mean dose response estimate minus mean
placebo response for each
simulated data set.  Number of columns is the number of doses
specified.</p>
</td></tr>
<tr><td><code>sepredv</code></td>
<td>
<p>Matrix of SEs for <code>fitpredv</code>.</p>
</td></tr>
<tr><td><code>sedifv</code></td>
<td>
<p>Matrix of SEs for <code>fitdifv</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>See Also</h3>

 <p><code><a href="#topic+emaxsim">emaxsim</a></code>, <code><a href="#topic+summary.emaxsim">summary.emaxsim</a></code>,
<code><a href="#topic+plot.emaxsim">plot.emaxsim</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
## random number seed changed by this example
nsim&lt;-50
idmax&lt;-5
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop.parm&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop.parm)  

###FixedMean is specialized constructor function for emaxsim
gen.parm&lt;-FixedMean(n,doselev,meanlev,sdy)  
D1 &lt;- emaxsim(nsim,gen.parm)

predout&lt;-predict(D1,c(75,150))

## End(Not run)

</code></pre>

<hr>
<h2 id='predict.emaxsimB'>Mean response and SE for each replicate
data set in an emaxsimB object </h2><span id='topic+predict.emaxsimB'></span>

<h3>Description</h3>

<p>Return warning and explanation that only predicted values at doses
included in the study are available.   The code needed to obtain
predicted values at other doses is indicated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emaxsimB'
predict(object, 
          dose, dref=0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.emaxsimB_+3A_object">object</code></td>
<td>
<p>Output of <code><a href="#topic+emaxsim">emaxsim</a></code> </p>
</td></tr>
<tr><td><code id="predict.emaxsimB_+3A_dose">dose</code></td>
<td>
<p> Vector (can be a single value) of doses where dose
response curve is to be evaluated. </p>
</td></tr>
<tr><td><code id="predict.emaxsimB_+3A_dref">dref</code></td>
<td>
<p>A reference dose (0 by default) for contrasts, but other values 
can be specified.  If specified, a single reference value must be given.
</p>
</td></tr>
<tr><td><code id="predict.emaxsimB_+3A_...">...</code></td>
<td>
<p>Optional arguments are not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No output.  
</p>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>See Also</h3>

 <p><code><a href="#topic+emaxsimB">emaxsimB</a></code>, <code><a href="#topic+summary.emaxsimB">summary.emaxsimB</a></code>,
<code><a href="#topic+plot.emaxsimB">plot.emaxsimB</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
nsim&lt;-50
idmax&lt;-5
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)
Ndose&lt;-length(doselev)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-2.464592
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop)  

###FixedMean is specialized constructor function for emaxsim
gen&lt;-FixedMean(n,doselev,meanlev,sdy)  

prior&lt;-emaxPrior.control(epmu=0,epsca=30,difTargetmu=0,
		difTargetsca=30,dTarget=100,p50=50,sigmalow=0.1,
		sigmaup=30,parmDF=5)
mcmc&lt;-mcmc.control(chains=1,warmup=500,iter=5000,seed=53453,
		propInit=0.15,adapt_delta = 0.95)


D1 &lt;- emaxsimB(nsim,gen, prior, modType=3,seed=12357,mcmc=mcmc,check=FALSE)

predict(D1,dose=20)

## End(Not run)
</code></pre>

<hr>
<h2 id='predict.emaxsimBobj'>Mean response estimates (posterior means) and SE (posterior SD) 
for specified doses for a simulated emaxsimBobj object</h2><span id='topic+predict.emaxsimBobj'></span>

<h3>Description</h3>

<p>Estimated mean and standard error for specified doses (posterior means and SD) computed from
the output of a simulated data set created by function emaxsimB.  
Also returns mean difference with placebo and their
standard errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emaxsimBobj'
predict(object, 
                dose, dref=0, clev=0.9, 
                ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.emaxsimBobj_+3A_object">object</code></td>
<td>
<p>Output of the extract function [] applied to an object
createad by <code><a href="#topic+emaxsimB">emaxsimB</a></code>. </p>
</td></tr>
<tr><td><code id="predict.emaxsimBobj_+3A_dose">dose</code></td>
<td>
<p> Vector (can be a single value) of doses where dose
response curve is to be evaluated. </p>
</td></tr>
<tr><td><code id="predict.emaxsimBobj_+3A_dref">dref</code></td>
<td>
<p>A reference dose (0 by default) for contrasts, but other values 
can be specified.  If specified, a single reference value must be given.
</p>
</td></tr>
<tr><td><code id="predict.emaxsimBobj_+3A_clev">clev</code></td>
<td>
<p>Specified probablity of the posterior interval</p>
</td></tr>
<tr><td><code id="predict.emaxsimBobj_+3A_...">...</code></td>
<td>
<p>Optional arguments are not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>pred</code></td>
<td>
<p>Vector with mean dose response estimates for each
specified dose.</p>
</td></tr>
<tr><td><code>fitdif</code></td>
<td>
<p>Corresponding differences with placebo.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p> SEs (posterior SD) for <code>pred</code>.</p>
</td></tr>
<tr><td><code>sedif</code></td>
<td>
<p>SEs (posterior SD) for <code>fitdif</code>.</p>
</td></tr>
<tr><td><code>lb</code>, <code>ub</code>, <code>lbdif</code>, <code>ubdif</code></td>
<td>
<p>Bounds of <code>clev</code> posterior intervals.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>See Also</h3>

 <p><code><a href="#topic+emaxsim">emaxsim</a></code>, <code><a href="#topic+summary.emaxsim">summary.emaxsim</a></code>,
<code><a href="#topic+predict.emaxsim">predict.emaxsim</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
### emaxsimB changes the random number seed
nsim&lt;-50
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)
Ndose&lt;-length(doselev)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 
dtarget&lt;-100
diftarget&lt;-2.464592
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop)  

###FixedMean is specialized constructor function for emaxsim
gen&lt;-FixedMean(n,doselev,meanlev,sdy)  

prior&lt;-emaxPrior.control(epmu=0,epsca=30,difTargetmu=0,
		difTargetsca=30,dTarget=100,p50=50,sigmalow=0.1,
		sigmaup=30,parmDF=5)
mcmc&lt;-mcmc.control(chains=1,warmup=500,iter=5000,seed=53453,propInit=0.15,adapt_delta = 0.95)

D1 &lt;- emaxsimB(nsim,gen, prior, modType=3,mcmc=mcmc,check=FALSE)
predict(D1[1],dose=c(75,125))

## End(Not run)
</code></pre>

<hr>
<h2 id='predict.emaxsimobj'>Mean response and SE for specified doses for a
simulated emaxsimobj object</h2><span id='topic+predict.emaxsimobj'></span>

<h3>Description</h3>

<p>Estimated mean/proportion and standard error for specified doses computed from
the output of a simulated data set created by function emaxsim.  Also returns mean difference with placebo and their
standard errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emaxsimobj'
predict(object, 
          dose, dref=0,
          ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.emaxsimobj_+3A_object">object</code></td>
<td>
<p>Output of the extract function [] applied to an object
createad by <code><a href="#topic+emaxsim">emaxsim</a></code>. </p>
</td></tr>
<tr><td><code id="predict.emaxsimobj_+3A_dose">dose</code></td>
<td>
<p> Vector (can be a single value) of doses where dose
response curve is to be evaluated. </p>
</td></tr>
<tr><td><code id="predict.emaxsimobj_+3A_dref">dref</code></td>
<td>
<p>A reference dose (0 by default) for contrasts, but other values 
can be specified.  If specified, a single reference value must be given.
</p>
</td></tr>
<tr><td><code id="predict.emaxsimobj_+3A_...">...</code></td>
<td>
<p>Optional arguments are not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>fitpred</code></td>
<td>
<p>Vector with mean dose response estimate for each
specified dose.</p>
</td></tr>
<tr><td><code>fitdif</code></td>
<td>
<p>Corresponding differences with placebo.</p>
</td></tr>
<tr><td><code>sepred</code></td>
<td>
<p> SEs for <code>fitpred</code>.</p>
</td></tr>
<tr><td><code>sedif</code></td>
<td>
<p>SEs for <code>fitdif</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>See Also</h3>

 <p><code><a href="#topic+emaxsim">emaxsim</a></code>, <code><a href="#topic+summary.emaxsim">summary.emaxsim</a></code>,
<code><a href="#topic+predict.emaxsim">predict.emaxsim</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
## emaxsim changes the random number seed
nsim&lt;-50
idmax&lt;-5
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop.parm&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop.parm)  

###FixedMean is specialized constructor function for emaxsim
gen.parm&lt;-FixedMean(n,doselev,meanlev,sdy)  
D1 &lt;- emaxsim(nsim,gen.parm)
d10&lt;-D1[10]
predict(d10,c(75,150))

## End(Not run)

</code></pre>

<hr>
<h2 id='predict.fitEmax'>Estimated mean/proportion and confidence intervals
derived from the maximum likelihood fit of a 3- or 4- parameter Emax model.
</h2><span id='topic+predict.fitEmax'></span>

<h3>Description</h3>

<p>The estimated means from an Emax model is
computed along with confidence bounds.  The results are computed
for a vector of input dose levels.  For binary outcomes, the results are
computed on the logit scale and then back-transformed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitEmax'
predict(object,dosevec,clev=0.9, 
                  int=1,dref=0, xvec=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.fitEmax_+3A_object">object</code></td>
<td>
<p>Output of <code><a href="#topic+fitEmax">fitEmax</a></code> with class
&quot;fitEmax&quot;.</p>
</td></tr>
<tr><td><code id="predict.fitEmax_+3A_dosevec">dosevec</code></td>
<td>
<p>Vector of doses to be evaluated.</p>
</td></tr>
<tr><td><code id="predict.fitEmax_+3A_clev">clev</code></td>
<td>
<p>Confidence level for intervals about the estimated
mean/proportion at each dosevec.</p>
</td></tr>
<tr><td><code id="predict.fitEmax_+3A_int">int</code></td>
<td>
<p>The index for the protocol (intercept) to use for the predictions</p>
</td></tr>
<tr><td><code id="predict.fitEmax_+3A_dref">dref</code></td>
<td>
<p>Differences in response between <code>doselev</code>
and <code>dref</code> are computed.</p>
</td></tr>
<tr><td><code id="predict.fitEmax_+3A_xvec">xvec</code></td>
<td>
<p>The vector of centered baseline values for the prediction model when
<code>xbase</code> was specified in the model fit.  Centering must be done using the
protocol-specific means consistent with <code>int</code>.  See details for the default
calculations when <code>xvec</code> is not specified.</p>
</td></tr>  
<tr><td><code id="predict.fitEmax_+3A_...">...</code></td>
<td>
<p>No additonal parameters will be utilized.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Model estimates, standard errors, and confidence bounds are computed with the 
function <code><a href="#topic+SeEmax">SeEmax</a></code>. 
</p>
<p>If baseline covariates were included in the fit and <code>xvec</code> is not specified, 
then the predicted value is the mean of the predictions for all patients in the
specified protocol.   Note that the protocol must be specified, or the 
prediction defaults to patients from the first protocol.  Note that for binary
data, the distinction between the mean of the predicted values and the predicted
value as the mean of the covariates can be important.
</p>


<h3>Value</h3>

<p>A list with estimated dose group means/proportions, lower bound, upper
bound, SE, and corresponding values for differences
with the reference dose.  One value for each dose in dosevec.
</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+nls">nls</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
## this example changes the random number seed
doselev&lt;-c(0,5,25,50,100,350)
n&lt;-c(78,81,81,81,77,80)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-8.0
pop.parm&lt;-c(log(ed50),emax,e0)    
dose&lt;-rep(doselev,n)
meanlev&lt;-emaxfun(dose,pop.parm)  

y&lt;-rnorm(sum(n),meanlev,sdy)

testout&lt;-fitEmax(y,dose,modType=4)
predout&lt;-predict(testout,dosevec=c(20,80),int=1)

## End(Not run)

</code></pre>

<hr>
<h2 id='predict.fitEmaxB'>
Estimated mean and posterior intervals
derived from a Bayesian hyperbolic or sigmiodial Emax model.
</h2><span id='topic+predict.fitEmaxB'></span>

<h3>Description</h3>

<p>The mean/proportion response for different doses estimated from a Bayesian Emax model is
computed along with corresponding posterior intervals.  The results are computed
for a vector of input dose levels. The estimates are posterior means or medians of the
MCMC generated means/proportions.  
For binary outcomes, the estimated response rates are
computed on the logit scale and then back-transformed before forming the 
estimates and posterior intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitEmaxB'
predict(object, dosevec, clev = 0.9,
	int = 1, dref = 0, xvec=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.fitEmaxB_+3A_object">object</code></td>
<td>
<p>Output of <code><a href="#topic+fitEmax">fitEmax</a></code> with class
&quot;fitEmaxB&quot;.</p>
</td></tr>
<tr><td><code id="predict.fitEmaxB_+3A_dosevec">dosevec</code></td>
<td>
<p>Vector of doses to be evaluated.</p>
</td></tr>
<tr><td><code id="predict.fitEmaxB_+3A_clev">clev</code></td>
<td>
<p>Level for the posterior intervals about the 
mean/proportion at each dosevec.</p>
</td></tr>
<tr><td><code id="predict.fitEmaxB_+3A_int">int</code></td>
<td>
<p>The index for the protocol (intercept) to use for the predictions</p>
</td></tr>
<tr><td><code id="predict.fitEmaxB_+3A_dref">dref</code></td>
<td>
<p>Differences in response between <code>doselev</code>
and <code>dref</code> are computed.</p>
</td></tr>
<tr><td><code id="predict.fitEmaxB_+3A_xvec">xvec</code></td>
<td>
<p>The vector of centered baseline values for the prediction model when
<code>xbase</code> was specified in the model fit.  Centering must be done using the
protocol-specific means consistent with <code>int</code>.  See details for the default
calculations when <code>xvec</code> is not specified.</p>
</td></tr>
<tr><td><code id="predict.fitEmaxB_+3A_...">...</code></td>
<td>
<p>No additonal parameters will be utilized.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Results computed from simple tabulations of the MCMC parameters
evaluated in the Emax function.
</p>
<p>If baseline covariates were included in the fit and <code>xvec</code> is not specified, 
then the predicted value is the mean of the predictions for all patients in the
specified protocol.   Note that the protocol must be specified, or the 
prediction defaults to patients from the first protocol.  Note that for binary
data, the distinction between the mean of the predicted values and the predicted
value at the mean of the covariates can be important.
</p>


<h3>Value</h3>

<p>A list with estimated mean/proportion <code>(pred, predMed)</code>, lower bound, upper
bound, posterior SD, and corresponding values for differences
with the reference dose.  One value for each dose in dosevec.
The MCMC response means (proportions for binary data) are in
<code>simResp</code>, and the residual SD for continuous data are in
<code>sigsim</code>.</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

<p><code>fitEmaxB</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
data("metaData")
exdat&lt;-metaData[metaData$taid==6 &amp; metaData$poptype==1,]

prior&lt;-emaxPrior.control(epmu=0,epsca=10,difTargetmu=0,difTargetsca=10,dTarget=80.0,
        p50=3.75,sigmalow=0.01,sigmaup=20)
mcmc&lt;-mcmc.control(chains=3)

msSat&lt;-sum((exdat$sampsize-1)*(exdat$sd)^2)/(sum(exdat$sampsize)-length(exdat$sampsize))
fitout&lt;-fitEmaxB(exdat$rslt,exdat$dose,prior,modType=4,
				count=exdat$sampsize,msSat=msSat,mcmc=mcmc)

predout&lt;-predict(fitout,dosevec=sort(unique(exdat$dose)))

## End(Not run)
</code></pre>

<hr>
<h2 id='print.emaxsim'>Print simulation output from emaxsim </h2><span id='topic+print.emaxsim'></span>

<h3>Description</h3>

<p>Prints key summary variables of Emax estimation peformance for each
simulation.  Can be used to identify simulated data sets yielding
problems with common estimation methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emaxsim'
print(x, 
        nprint = min(length(x$fitType), 20), 
        id = x$idmax, 
        digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.emaxsim_+3A_x">x</code></td>
<td>
<p>Output of <code><a href="#topic+emaxsim">emaxsim</a></code> </p>
</td></tr>
<tr><td><code id="print.emaxsim_+3A_nprint">nprint</code></td>
<td>
<p> Number of simulations to print.  If a vector of
length 2, <code>nprint</code> is the range of simulations to print. </p>
</td></tr>
<tr><td><code id="print.emaxsim_+3A_id">id</code></td>
<td>
<p>Output includes the stdBias for the dose with index <code>id</code>  vs
placebo </p>
</td></tr>
<tr><td><code id="print.emaxsim_+3A_digits">digits</code></td>
<td>
<p> Number of decimal digits to print for Z and p-values </p>
</td></tr>
<tr><td><code id="print.emaxsim_+3A_...">...</code></td>
<td>
<p> Other print parameters (none currently implemented) </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Printed output returned as invisible matrix.
</p>


<h3>Note</h3>

 
<p>The stdBias printed is the difference between the estimated
dose response at the dose with index <code>id</code> and its population
value.  The difference is divided by the SE of the estimator computed
using the delta method.
</p>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>See Also</h3>

 <p><code><a href="#topic+emaxsim">emaxsim</a></code>, <code><a href="#topic+summary.emaxsim">summary.emaxsim</a></code>,
<code><a href="#topic+plot.emaxsim">plot.emaxsim</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
## emaxsim changes the random number seed
nsim&lt;-50
idmax&lt;-5
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop.parm&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop.parm)  

###FixedMean is specialized constructor function for emaxsim
gen.parm&lt;-FixedMean(n,doselev,meanlev,sdy)  
D1 &lt;- emaxsim(nsim,gen.parm)

print(D1,c(31,50),digits=2,id=4)

print(D1,c(1,20))

D1  ### implicitly calls print with default parameter settings

## End(Not run)

</code></pre>

<hr>
<h2 id='print.emaxsimB'>Print simulation output from emaxsimB</h2><span id='topic+print.emaxsimB'></span>

<h3>Description</h3>

<p>Prints key summary variables of Emax estimation peformance for each
simulation.  Can be used to identify simulated data sets yielding
unusual estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emaxsimB'
print(x, 
      nprint = min(nsim, 20), 
      id = x$idmax, 
      digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.emaxsimB_+3A_x">x</code></td>
<td>
<p>Output of <code><a href="#topic+emaxsimB">emaxsimB</a></code> </p>
</td></tr>
<tr><td><code id="print.emaxsimB_+3A_nprint">nprint</code></td>
<td>
<p> Number of simulations to print.  If a vector of
length 2, <code>nprint</code> is the range of simulations to print. </p>
</td></tr>
<tr><td><code id="print.emaxsimB_+3A_id">id</code></td>
<td>
<p>Output includes the stdBias for the dose with index <code>id</code>  vs
placebo </p>
</td></tr>
<tr><td><code id="print.emaxsimB_+3A_digits">digits</code></td>
<td>
<p> Number of decimal digits to print for Z and p-values </p>
</td></tr>
<tr><td><code id="print.emaxsimB_+3A_...">...</code></td>
<td>
<p> Other print parameters (none currently implemented) </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Printed output returned as invisible matrix.
</p>


<h3>Note</h3>

 
<p>The stdBias printed is the difference between the posterior mean of the 
dose response at the dose with index <code>id</code> and its population
value.  The difference is divided by the SE (posterior SD).
</p>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>See Also</h3>

 <p><code><a href="#topic+emaxsimB">emaxsimB</a></code>, <code><a href="#topic+summary.emaxsimB">summary.emaxsimB</a></code>,
<code><a href="#topic+plot.emaxsimB">plot.emaxsimB</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
## emaxsimB changes the random number seed
nsim&lt;-50
idmax&lt;-5
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)
Ndose&lt;-length(doselev)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 
dtarget&lt;-100
diftarget&lt;-2.464592
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop)  

###FixedMean is specialized constructor function for emaxsim
gen&lt;-FixedMean(n,doselev,meanlev,sdy)  

prior&lt;-emaxPrior.control(epmu=0,epsca=30,difTargetmu=0,
		difTargetsca=30,dTarget=100,p50=50,sigmalow=0.1,
		sigmaup=30,parmDF=5)
mcmc&lt;-mcmc.control(chains=1,warmup=500,iter=5000,seed=53453,propInit=0.15,adapt_delta = 0.95)

D1 &lt;- emaxsimB(nsim,gen, prior, modType=3,mcmc=mcmc,check=FALSE)

print(D1)

## End(Not run)
</code></pre>

<hr>
<h2 id='print.emaxsimBobj'>
Print a summary of the fitted Emax model
</h2><span id='topic+print.emaxsimBobj'></span>

<h3>Description</h3>

<p>Print a summary of the fitted Emax model.  
Printed output returned as invisible matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emaxsimBobj'
print(x, nprint=min(length(x$y),20), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.emaxsimBobj_+3A_x">x</code></td>
<td>

<p>Object output by the extractor function [] for <code><a href="#topic+emaxsimB">emaxsimB</a></code>
</p>
</td></tr>
<tr><td><code id="print.emaxsimBobj_+3A_nprint">nprint</code></td>
<td>
<p> Number of observations to print.  If a vector of
length 2, <code>nprint</code> is the range of data to print. </p>
</td></tr>
<tr><td><code id="print.emaxsimBobj_+3A_...">...</code></td>
<td>

<p>No options implemented.
</p>
</td></tr>
</table>

<hr>
<h2 id='print.emaxsimobj'>Print a data set generated by emaxsim </h2><span id='topic+print.emaxsimobj'></span>

<h3>Description</h3>

<p>Print a data set that has been extracted from emaxsim output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emaxsimobj'
print(x, nprint = min(length(x$y), 20), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.emaxsimobj_+3A_x">x</code></td>
<td>
<p> Extracted simulation object </p>
</td></tr>
<tr><td><code id="print.emaxsimobj_+3A_nprint">nprint</code></td>
<td>
<p> Number of observations to print.  If a vector of
length 2, <code>nprint</code> is the range of data to print. </p>
</td></tr>
<tr><td><code id="print.emaxsimobj_+3A_...">...</code></td>
<td>
<p>No other parameters currently implemented</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Printed output returned as invisible matrix.
</p>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>See Also</h3>

 <p><code><a href="#topic+emaxsim">emaxsim</a></code>, 
<code><a href="#topic+plot.emaxsimobj">plot.emaxsimobj</a></code>, <code><a href="#topic+summary.emaxsimobj">summary.emaxsimobj</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

save.seed&lt;-.Random.seed
set.seed(12357)

nsim&lt;-50
idmax&lt;-5
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop)  

###FixedMean is specialized constructor function for emaxsim
gen.parm&lt;-FixedMean(n,doselev,meanlev,sdy)  
D1 &lt;- emaxsim(nsim,gen.parm)
e49&lt;-D1[49]

e49

print(e49,c(101,200))  

.Random.seed&lt;-save.seed

## End(Not run)
</code></pre>

<hr>
<h2 id='print.fitEmax'>
Print a summary of the fitted Emax model
</h2><span id='topic+print.fitEmax'></span>

<h3>Description</h3>

<p>Print a summary of the fitted Emax model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitEmax'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.fitEmax_+3A_x">x</code></td>
<td>

<p>Object output by <code><a href="#topic+fitEmax">fitEmax</a></code>
</p>
</td></tr>
<tr><td><code id="print.fitEmax_+3A_...">...</code></td>
<td>

<p>No options implemented.
</p>
</td></tr>
</table>

<hr>
<h2 id='print.fitEmaxB'>
Print a summary of the fitted Bayesian Emax model
</h2><span id='topic+print.fitEmaxB'></span>

<h3>Description</h3>

<p>Print a summary of the fitted Bayesian Emax model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitEmaxB'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.fitEmaxB_+3A_x">x</code></td>
<td>

<p>Object output by <code><a href="#topic+fitEmaxB">fitEmaxB</a></code>
</p>
</td></tr>
<tr><td><code id="print.fitEmaxB_+3A_...">...</code></td>
<td>

<p>No options implemented.
</p>
</td></tr>
</table>

<hr>
<h2 id='printemaxPrior'>
Print protocol or sap text describing the prior distribution for
the model parameters of the input emaxPrior object
</h2><span id='topic+print.emaxPrior'></span>

<h3>Description</h3>

<p>Print templated description of the prior distribution for the 
Emax model parameters.  The level of detail is adjusted for protocol/sap. 
By default, the prior object is printed as a list without documentation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emaxPrior'
print(x, doc=FALSE, diffuse=NULL, file="", 
		modType=c('4','3'), docType=c('sap','protocol'), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="printemaxPrior_+3A_x">x</code></td>
<td>
<p>Object created by function <code>emaxPrior.control</code>
</p>
</td></tr>
<tr><td><code id="printemaxPrior_+3A_doc">doc</code></td>
<td>
<p>When <code>TRUE</code>, documentation for the prior distribution
is returned.  Default is <code>FALSE</code> and the prior input is returned
as a list for default printing</p>
</td></tr>
<tr><td><code id="printemaxPrior_+3A_diffuse">diffuse</code></td>
<td>
<p>When <code>TRUE</code>, the scale parameters are described
as creating diffuse prior distributions for the corresponding 
efficacy parameters.  When <code>FALSE</code>, sections are identified
where the user must add justification for the informative 
prior distributions.  An error message is printed if 
<code>doc=TRUE</code> and <code>diffuse</code> is not specified
</p>
</td></tr>
<tr><td><code id="printemaxPrior_+3A_file">file</code></td>
<td>
<p>File for ascii output</p>
</td></tr>
<tr><td><code id="printemaxPrior_+3A_modtype">modType</code></td>
<td>
<p>Character value ('4' or '3') that determines whether
the 4-parameter sigmoidal Emax paramter is included, or the 3-parameter
hyperbolic model is assumed with the Hill (slope) parameter set to 1
</p>
</td></tr>
<tr><td><code id="printemaxPrior_+3A_doctype">docType</code></td>
<td>
<p>When <code>'protocol'</code>, the prior description
is less detailed.
</p>
</td></tr>
<tr><td><code id="printemaxPrior_+3A_...">...</code></td>
<td>
<p>No other inputs are supported</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the object is entered at the command line, the implied print
function is called without the required <code>diffuse</code> flag.  The
object will be printed as a list.  The list output will be
followed by error/warning messages noting the absence of the
required input.
</p>


<h3>Value</h3>

<p>Ascii text or text file that can be edited for inclusion in
a protocol/sap
</p>


<h3>Author(s)</h3>

<p>Neal Thomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+emaxPrior.control">emaxPrior.control</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prior&lt;-emaxPrior.control(epmu=0,epsca=4,difTargetmu=0,
		difTargetsca=4,dTarget=20,
		p50=(2+5)/2,
		sigmalow=0.01,sigmaup=3)
				
print(prior,doc=TRUE,diffuse=TRUE)

</code></pre>

<hr>
<h2 id='prior.control'>
Set the parameters of the prior distribution for the Emax model implemented in <code>fitEmaxB</code>.
</h2><span id='topic+prior.control'></span>

<h3>Description</h3>

<p>Set the parameters of the prior distribution for the Emax model implemented in <code>fitEmaxB</code>.  <code>prior.control</code> is deprecated.  See <code>emaxPrior.control</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>prior.control(epmu = NULL, epsd = NULL, emaxmu = NULL, 
	emaxsd = NULL, p50 = NULL, 
	sigmalow = NULL, sigmaup = NULL, 
	led50mu = 0.79, led50sca = 0.6, edDF = 3, 
	lama = 3.03, lamb = 18.15, lamsca = 6, 
	basemu=NULL,basevar=NULL,
	binary = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prior.control_+3A_epmu">epmu</code></td>
<td>

<p>Mean for <code>E0</code> in a normal prior distribution.  Logistic scale for binary data.
</p>
</td></tr>
<tr><td><code id="prior.control_+3A_epsd">epsd</code></td>
<td>

<p>SD for <code>E0</code> in a normal prior distribution.  Logistic scale for binary data.
</p>
</td></tr>
<tr><td><code id="prior.control_+3A_emaxmu">emaxmu</code></td>
<td>

<p>Mean for <code>Emax</code> in a normal prior distribution.  Logistic scale for binary data. 
</p>
</td></tr>
<tr><td><code id="prior.control_+3A_emaxsd">emaxsd</code></td>
<td>

<p>SD for <code>Emax</code> in a normal prior distribution.  Logistic scale for binary data.  
</p>
</td></tr>
<tr><td><code id="prior.control_+3A_p50">p50</code></td>
<td>

<p>Projected <code>ED50</code>.  See reference for its use in creating the prior distribution for the <code>ED50</code>.
</p>
</td></tr>
<tr><td><code id="prior.control_+3A_sigmalow">sigmalow</code></td>
<td>

<p>Lower bound for a uniform prior distribution for the residual SD (continuous data).
</p>
</td></tr>
<tr><td><code id="prior.control_+3A_sigmaup">sigmaup</code></td>
<td>

<p>Upper bound for a uniform prior distribution for the residual SD (continuous data).  
</p>
</td></tr>
<tr><td><code id="prior.control_+3A_led50mu">led50mu</code></td>
<td>

<p>Mean of log-t prior distribution for the <code>ED50</code> before final scaling.  See reference for its interpretation in the prior distribution for the <code>ED50</code>.
</p>
</td></tr>
<tr><td><code id="prior.control_+3A_led50sca">led50sca</code></td>
<td>

<p>Scale (analogous to SD) of the log-t prior distribution for the <code>ED50</code>.  
</p>
</td></tr>
<tr><td><code id="prior.control_+3A_eddf">edDF</code></td>
<td>

<p>The degrees of freedom of the log-t prior distribution for the <code>ED50</code>.  
</p>
</td></tr>
<tr><td><code id="prior.control_+3A_lama">lama</code></td>
<td>

<p>Parameter in the re-scaled beta distribution for Hill slope parameter in the sigmoidal
Emax model.  See reference for it use and empirical basis.
</p>
</td></tr>
<tr><td><code id="prior.control_+3A_lamb">lamb</code></td>
<td>

<p>Parameter in the re-scaled beta distribution for Hill slope parameter in the sigmoidal
Emax model.
</p>
</td></tr>
<tr><td><code id="prior.control_+3A_lamsca">lamsca</code></td>
<td>

<p>The beta prior distribution for the Hill parameter is re-scaled to have support on (0,lamsca).
</p>
</td></tr>
<tr><td><code id="prior.control_+3A_basemu">basemu</code></td>
<td>

<p>A vector of prior means for the covariate regression parameters.
</p>
</td></tr>
<tr><td><code id="prior.control_+3A_basevar">basevar</code></td>
<td>

<p>The prior variance-covariance matrix for the covariate regression parameters.
The covariate regression parameters are apriori independent of the other dose 
response model parameters.
</p>
</td></tr>
<tr><td><code id="prior.control_+3A_binary">binary</code></td>
<td>

<p>Set to <code>TRUE</code> for binary data applications.  Used to check for consistency in usage.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The prior distributions are based two meta-analyses of dose response described 
in the references.  Each parameter is independent in the prior distribution.  The
E0 and Emax parameters have normal prior distributions.  For binary data, these
parameters are computed on the logistic scale.  The predicted ED50 must be
specified as 'P50'.  The prior distribution of the log(ED50) has a t-distribution
centered at log(P50), with scale, degrees of freedom, and offset to the P50, 
defaulting to values given in the references (these can be changed, but they
are difficult to interpret outside the context of the meta-analyses).  
If <code>modType=4</code>, the prior distribution for the Hill parameter
is a beta distribution scaled to
(0,lamsca).  The default degrees of freedom were obtained from the
meta-analyses.   For
continuous data, the prior distribution for the residual SD is uniform on a 
user-specifed scale.
</p>


<h3>Value</h3>

<p>List of prior parameter values for use in <code>fitEmaxB</code>.
</p>


<h3>Author(s)</h3>

<p>Neal Thomas
</p>


<h3>References</h3>

<p>Thomas, N., Sweeney, K., and Somayaji, V. (2014).  Meta-analysis of clinical dose response in a large drug development portfolio, Statistics in Biopharmaceutical Research, Vol. 6, No.4, 302-317.
&lt;doi:10.1080/19466315.2014.924876&gt;
</p>
<p>Thomas, N., and Roy, D. (2016).  Analysis of clinical dose-response in small-molecule drug development:  2009-2014. Statistics in Biopharmaceutical Research, Vol. 6, No.4, 302-317
&lt;doi:10.1080/19466315.2016.1256229&gt;
</p>


<h3>See Also</h3>

<p><code>fitEmaxB</code>
</p>

<hr>
<h2 id='RandEmax'>Random data constructor function for emaxsim creating random parameters
for an Emax model for continuous or binary data.</h2><span id='topic+RandEmax'></span>

<h3>Description</h3>

<p>Creates a list object that contains inputs and a function to create
simulated data sets for emaxsim.  Data sets are created by
generating random parameters from beta or log-normal distributions for 
a 3/4 parameter Emax model. For binary data, the Emax model is on the logit scale
and then back-transformed. <code>RandEmax</code> is deprecated.  
See <code>randomEmax</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RandEmax(n, doselev, 
	parmEmax,
	parmE0,
	p50,
	parmED50=c(3,0.79,0.6),
	parmLambda=c(3.03,18.15,0,6),
	resSD,
	dfSD=Inf,
	binary=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RandEmax_+3A_n">n</code></td>
<td>
<p>Sample size for each dose group. </p>
</td></tr>
<tr><td><code id="RandEmax_+3A_doselev">doselev</code></td>
<td>
<p>Dose levels (including 0 for placebo) included in the
study corresponding to <code>n</code>.  Must be in increasing order.</p>
</td></tr>
<tr><td><code id="RandEmax_+3A_parmemax">parmEmax</code></td>
<td>
<p>Vector with mean and standard deviation for a random
normal Emax</p>
</td></tr>  
<tr><td><code id="RandEmax_+3A_parme0">parmE0</code></td>
<td>
<p>Vector with mean and standard deviation for a random
normal intercept.</p>
</td></tr>
<tr><td><code id="RandEmax_+3A_p50">p50</code></td>
<td>
<p>The predicted ED50</p>
</td></tr>
<tr><td><code id="RandEmax_+3A_parmed50">parmED50</code></td>
<td>
<p>  The log(ED50) is generated from a t-distribution
with <code>df=parmED50[1]</code>, <code>mean=log(p50)+parmED50[2]</code>, 
and <code>scale=parmED50[3]</code>.
The default values are taken from the reference below.
</p>
</td></tr>
<tr><td><code id="RandEmax_+3A_parmlambda">parmLambda</code></td>
<td>
<p>For a beta distributed sigmoid lambda, a vector with
(df1,df2,lower bound, upper bound).  For a hyperbolic model, lambda=1.  </p>
</td></tr>
<tr><td><code id="RandEmax_+3A_ressd">resSD</code></td>
<td>
<p>Standard deviation for residuals within each dose (normal data only)</p>
</td></tr>
<tr><td><code id="RandEmax_+3A_dfsd">dfSD</code></td>
<td>
<p>If a finite value is specified, the within-dose group SD is randomly
generated from resSD times sqrt(dfSD/chisquare(dfSD))), which is the form of a posterior
distribution for a SD based on a existing sample.</p>
</td></tr>
<tr><td><code id="RandEmax_+3A_binary">binary</code></td>
<td>
<p>When <code>TRUE</code>, <code>0/1</code> data are generated from the
Emax model, which is computed on the logit scale and then 
backtransformed to yield proportions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All parameters are independent.  Normal data are
generated from the dose response curves with homogeneous-variance
normal residuals.  Binary data are 0/1 generated from Bernoulli 
distributions with proportions computed by transforming the Emax
model output from the logit to proportion scale.  
Default values are based on recommendations in
</p>
<p>Thomas, N., Sweeney, K., and Somayaji, V. (2014).  Meta-analysis 
of clinical dose response in a large drug development portfolio.  
&lt;doi:10.1080/19466315.2014.924876&gt;
</p>


<h3>Value</h3>

<p>A list of length <code>2</code>.  
The first element is itself a list named <code>genP</code> that contains named elments
<code>n</code>, <code>resSD</code>, <code>dfSD</code>, <code>doselev</code>, <code>dose</code>,  
<code>binary</code> and the
elements <code>parmE0</code>, <code>p50</code>, <code>parmED50</code>, <code>parmEmax</code>, 
and <code>parmLambda</code>. 
which are specific to <code>RandEmax</code>.  The second
element is a function named <code>genFun</code> that takes
<code>genP</code> as input and returns a list with named elements <code>meanlev</code>, 
<code>parm</code>, <code>resSD</code>, <code>y</code>.  
</p>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>See Also</h3>

 <p><code><a href="#topic+emaxsim">emaxsim</a></code>, <code><a href="#topic+FixedMean">FixedMean</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>simParm&lt;-RandEmax(n=c(99,95,98,94,98,98),doselev=c(0,5,10,25,50,150),
         parmE0=c(-2.6,2.5),p50=25,parmEmax=c(-1.25,2),resSD=3.88)
</code></pre>

<hr>
<h2 id='randomEmax'>Random data constructor function for emaxsim(B) 
creating random parameters
for an Emax model for continuous or binary data.</h2><span id='topic+randomEmax'></span>

<h3>Description</h3>

<p>Creates a list object that contains inputs and a function to create
simulated data sets for emaxsim(B).  Data sets are created by
generating random parameters from an <code>emaxPrior.control()</code> object for 
a 3/4 parameter Emax model. For binary data, the Emax model is 
on the logit scale and then back-transformed. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randomEmax(x,n,doselev,modType=c('4','3'))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="randomEmax_+3A_x">x</code></td>
<td>
<p>Object of type <code>emaxPrior</code> created by function
<code>emaxPrior.control</code>, that specifies a prior distribution
for the Emax model parameters.</p>
</td></tr>
<tr><td><code id="randomEmax_+3A_n">n</code></td>
<td>
<p>Sample size for each dose group. </p>
</td></tr>
<tr><td><code id="randomEmax_+3A_doselev">doselev</code></td>
<td>
<p>Dose levels (including 0 for placebo) included in the
study corresponding to <code>n</code>.  Must be in increasing order.</p>
</td></tr>
<tr><td><code id="randomEmax_+3A_modtype">modType</code></td>
<td>
<p>Specifies a 4-parameter sigmoidal Emax model, or
a 3-parameter hyperbolic Emax model</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Normal data are
generated from the dose response curves with homogeneous-variance
normal residuals.  Binary data are 0/1 generated from Bernoulli 
distributions with proportions computed by transforming the Emax
model output from the logit to proportion scale.  
Default values are based on recommendations in the references.
</p>


<h3>Value</h3>

<p>A list of length <code>2</code>.  
The first element is itself a list named <code>genP</code> that contains named elments
<code>n</code>, <code>doselev</code>, <code>dose</code>,  
<code>modType</code> and the <code>emaxPrior</code> object <code>x</code>.  
The second element is a function named <code>genFun</code> that takes
<code>genP</code> as input and returns a list with named elements <code>meanlev</code>, 
<code>parm</code>, <code>resSD</code>, <code>y</code>.  
</p>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>References</h3>

<p>Thomas, N., Sweeney, K., and Somayaji, V. (2014).  Meta-analysis of clinical dose response in a large drug development portfolio, Statistics in Biopharmaceutical Research, Vol. 6, No.4, 302-317.
&lt;doi:10.1080/19466315.2014.924876&gt;
</p>
<p>Thomas, N., and Roy, D. (2016).  Analysis of clinical dose-response in small-molecule drug development:  2009-2014. Statistics in Biopharmaceutical Research, Vol. 6, No.4, 302-317
&lt;doi:10.1080/19466315.2016.1256229&gt;
</p>
<p>Wu, J., Banerjee, A., Jin, B. Menon, M. S., Martin, S. and Heatherington, A. (2017). Clinical dose response for a broad set of biological products: A model-based meta-analysis. Statistical Methods in Medical Research. &lt;doi:10.1177/0962280216684528&gt;
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+emaxsimB">emaxsimB</a></code>, 
<code><a href="#topic+emaxsim">emaxsim</a></code>, <code><a href="#topic+FixedMean">FixedMean</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>prior&lt;-emaxPrior.control(epmu=0,epsca=4,
	difTargetmu=0,difTargetsca=4,dTarget=20,
	p50=(2+5)/2,
	sigmalow=0.01,sigmaup=3)
						
simParm&lt;-randomEmax(x=prior,n=c(99,95,98,94,98,98),
	doselev=c(0,5,10,25,50,150),modType="4")
		
# D1 &lt;- emaxsimB(nsim=10,simParm,prior,nproc=1)
</code></pre>

<hr>
<h2 id='runSimulations'>
Shiny app for function <code>emaxsim(B)</code> 
</h2><span id='topic+runSimulations'></span>

<h3>Description</h3>

<p>Shiny app for function <code>emaxsim(B)</code></p>


<h3>Usage</h3>

<pre><code class='language-R'>runSimulations()
</code></pre>


<h3>Note</h3>

<p>The code section of the shiny app provides the code required
for batch execution of the current shiny results.
</p>
<p>The 'Analysis' section of the shiny app must be visited before
an example can be run.  
</p>
<p>For Bayesian output, the <code>clinDR</code>
package function <code>compileStanModels()</code> must be executed
once before using the shiny app or any of the package functions
utilizing Bayes methods.
</p>


<h3>Author(s)</h3>

<p>Neal Thomas, Mike K. Smith
</p>


<h3>See Also</h3>

<p><code><a href="#topic+emaxsimB">emaxsimB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	if (interactive()) {
	  runSimulations ()
	}
</code></pre>

<hr>
<h2 id='SeEmax'> Asymptotic SE for dose response estimates from a
3- or 4- parameter Emax model </h2><span id='topic+SeEmax'></span>

<h3>Description</h3>

<p>Compute the asymptotic SE for dose response estimates based on the 
asymptotic variance-covariance matrix from the fit of a 3- or 4-parameter
Emax model</p>


<h3>Usage</h3>

<pre><code class='language-R'>SeEmax(fit, doselev, modType, dref=0, nbase=0, x=NULL, 
				binary=FALSE, clev=0.9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SeEmax_+3A_fit">fit</code></td>
<td>
<p>Output of <code><a href="stats.html#topic+nls">nls</a></code> fit to a 3- or 4-parameter Emax
model.  The order of the parameters in the fit must be (log(ed50),emax,e0) or
(log(ed50),lambda,emax,e0).
Alternatively, fit can be a list with the first element the coefficient
vector, and the second element the variance-covariance matrix.  List input
can be used with multiple protocols and baseline covariates (see details).</p>
</td></tr>
<tr><td><code id="SeEmax_+3A_doselev">doselev</code></td>
<td>
<p>SEs are evaluated at vector of doses </p>
</td></tr>
<tr><td><code id="SeEmax_+3A_modtype">modType</code></td>
<td>
<p>modType=3,4 for a 3 or 4 parameter model.</p>
</td></tr>
<tr><td><code id="SeEmax_+3A_dref">dref</code></td>
<td>
<p>A reference dose (0 by default) for contrasts, but other values 
can be specified.  If specified, a single reference value must be given.
</p>
</td></tr>
<tr><td><code id="SeEmax_+3A_nbase">nbase</code></td>
<td>
<p>The number of baseline predictors included in the model.</p>
</td></tr>
<tr><td><code id="SeEmax_+3A_x">x</code></td>
<td>
<p>The model is evaluated at baseline covariate values, <code>x</code>.
If <code>x</code> is a matrix, then each row is a vector of baseline 
predictors, and the results are for the dose response averaged over
all of the predictors in <code>x</code>.</p>
</td></tr>
<tr><td><code id="SeEmax_+3A_binary">binary</code></td>
<td>
<p>Emax model on logistic scale, then backtransformed.</p>
</td></tr>
<tr><td><code id="SeEmax_+3A_clev">clev</code></td>
<td>
<p>Confidence level for intervals.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Emax models supported by <code>SeEmax</code> should now be fit using 
<code>fitEmax</code> and <code>predict.fitEmax</code>.  <code>SeEmax</code> remains available
primarily for backward compatibility.
</p>
<p><code>SeEmax</code> can be used with models that allow different placebo response
for multiple protocols by selecting the intercept for a specific protocol.  
Coeficients for baseline covariates can also be included following the intercept.
The variance-covariance matrix from the full model must be subsetted to match
the included coeficients (i.e., the rows and columns corresponding to the
omitted intercepts must be removed).  List input must be used for the more
general models. 
</p>


<h3>Value</h3>

<p>Returns a list:
</p>
<table>
<tr><td><code>doselev</code></td>
<td>
<p>Doses to evaluate</p>
</td></tr>
<tr><td><code>dref</code></td>
<td>
<p>Differences in response between <code>doselev</code>
and <code>dref</code> are computed.</p>
</td></tr>
<tr><td><code>fitpred</code></td>
<td>
<p>Estimated dose response at doselev</p>
</td></tr>
<tr><td><code>sepred</code></td>
<td>
<p>SE for estimated dose responses</p>
</td></tr>
<tr><td><code>fitdif</code></td>
<td>
<p>Estimated response at doselev minus estimated
response at placebo</p>
</td></tr>
<tr><td><code>sedif</code></td>
<td>
<p>SE for fitdif estimated differences</p>
</td></tr>
<tr><td><code>fitref</code></td>
<td>
<p>Estimated dose response at the reference dose.</p>
</td></tr>
<tr><td><code>seref</code></td>
<td>
<p>SE for the estimated dose response at the reference
dose</p>
</td></tr>
<tr><td><code>covref</code></td>
<td>
<p>The covariance between each estimated response and
the estimated response at the reference dose.  These covariances can
be used to compute asymptotic variances of differences after 
back-transformation (e.g., for logistic regression with binary data).
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>References</h3>

<p>Bates, D. M. and Watts, D. G. (1988) Nonlinear Regression
Analysis and Its Applications, Wiley
</p>


<h3>See Also</h3>

<p><code>fitEmax</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

## this example changes the random number seed
doselev&lt;-c(0,5,25,50,100,250)
n&lt;-c(78,81,81,81,77,80)
dose&lt;-rep(doselev,n)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 
led50&lt;-log(ed50)
lambda=1.8

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),lambda,e0)

sdy&lt;-7.967897
pop&lt;-c(led50=led50,lambda=lambda,emax=emax,e0=e0)    
meanresp&lt;-emaxfun(dose,pop)  
y&lt;-rnorm(sum(n),meanresp,sdy)
nls.fit&lt;-nls(y ~ e0 + (emax * dose^lambda)/(dose^lambda + exp(led50*lambda)), 
                         start = pop, control = nls.control(
                         maxiter = 100),trace=TRUE,na.action=na.omit)


SeEmax(nls.fit,doselev=c(60,120),modType=4)
SeEmax(list(coef(nls.fit),vcov(nls.fit)),c(60,120),modType=4)

## End(Not run)

</code></pre>

<hr>
<h2 id='selEstan'>
Select a pre-compiled <code>rstan</code> Emax model
</h2><span id='topic+selEstan'></span>

<h3>Description</h3>

<p>Emax models for use in <code>fitEmaxB</code> and <code>emaxsimB</code> which have been pre-compiled
are loaded for use outside of the the fiting functions.  This is most useful for
repeated simulations in which the loading of the compiled models from
a disk file can be performed once.  <code>fitEmaxB</code> will load the model
automatically for  single execution, so the model does not
need to be pre-loaded.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
selEstan(emod=c('basemodel.rds','mrmodel.rds'))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="selEstan_+3A_emod">emod</code></td>
<td>
<p>Two parameterizations of the emax function are currently supported.  
'basemodel'  uses the maximal effect 'emax' parameter.  'mrmodel'  uses the effect
of the drug at a high dose specified by the user versus placebo.  The 'emax' effect model is
deprecated and will be eliminated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An Emax 'stanmodel'.
</p>


<h3>Author(s)</h3>

<p>Neal Thomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitEmaxB">fitEmaxB</a></code>, <code><a href="#topic+emaxsimB">emaxsimB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
	estan&lt;-selEstan()

## End(Not run)
</code></pre>

<hr>
<h2 id='showStanModels'>
Display <code>STAN</code> model code.
</h2><span id='topic+showStanModels'></span>

<h3>Description</h3>

<p>Display the <code>STAN</code> Bayesian model code for fitting Emax models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>showStanModels(emod=c('basemodel.stan','mrmodel.stan'))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="showStanModels_+3A_emod">emod</code></td>
<td>
<p>Two parameterizations of the emax function are currently supported.  
'basemodel'  uses the maximal effect 'emax' parameter.  'mrmodel'  uses the effect
of the drug at a high dose specified by the user versus placebo.  The 'emax' effect model is
deprecated and will be eliminated.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Neal Thomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitEmaxB">fitEmaxB</a></code>, <code><a href="#topic+emaxsimB">emaxsimB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
showStanModels()

## End(Not run)
</code></pre>

<hr>
<h2 id='sigmaEmax'>Extract Emax model residual SD estimates</h2><span id='topic+sigma.fitEmax'></span><span id='topic+sigma.fitEmaxB'></span><span id='topic+sigma.emaxsim'></span><span id='topic+sigma.emaxsimB'></span>

<h3>Description</h3>

<p>Extract Emax model residual SD estimates.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'fitEmax'
sigma(object, ...)
	## S3 method for class 'fitEmaxB'
sigma(object, ...)
	## S3 method for class 'emaxsim'
sigma(object, ...)
	## S3 method for class 'emaxsimB'
sigma(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sigmaEmax_+3A_object">object</code></td>
<td>
<p> Output of Emax fitting and simulation functions </p>
</td></tr>
<tr><td><code id="sigmaEmax_+3A_...">...</code></td>
<td>
<p> None additional inputs supported </p>
</td></tr>
</table>


<h3>Value</h3>

<p>MLE estimate of the residual SD from <code>fitEmax</code>.  
Vector of MLE estimates of the residual SD for each <code>emaxsim</code> simulation.	
Vector of MCMC generated residual SD for <code>fitEmaxB</code>.
Vector of posterior median estimates of the residual SD for 
each <code>emaxsimB</code> simulation. 
</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+coef">coef</a></code>, <code><a href="#topic+fitEmax">fitEmax</a></code>, <code><a href="#topic+fitEmaxB">fitEmaxB</a></code>,
<code><a href="#topic+emaxsim">emaxsim</a></code>, <code><a href="#topic+emaxsimB">emaxsimB</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>doselev&lt;-c(0,5,25,50,100,350)
n&lt;-c(78,81,81,81,77,80)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-8.0
pop&lt;-c(log(ed50),emax,e0)    
dose&lt;-rep(doselev,n)
meanlev&lt;-emaxfun(dose,pop)  

y&lt;-rnorm(sum(n),meanlev,sdy)

testout&lt;-fitEmax(y,dose,modType=4)
sigma(testout)
</code></pre>

<hr>
<h2 id='startEmax'>Compute starting parameter values for the 3- or 4- Emax model. </h2><span id='topic+startEmax'></span>

<h3>Description</h3>

<p>Compute starting parameter values for iterative procedures for
estimating parameters of the 3- or 4- parameter Emax model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>startEmax(y,
          dose,
          baseline,
          count=rep(1,length(y)),
          modType=3,
          binary=FALSE,
          lbED50=doselev[2]/10,
          ubED50=max(doselev),
          lbLambda=0.5,
          ubLambda=5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="startEmax_+3A_y">y</code></td>
<td>
<p>Outcome (response) variable for the Emax modeling.</p>
</td></tr>
<tr><td><code id="startEmax_+3A_binary">binary</code></td>
<td>
<p>The default is continuous (<code>binary=FALSE</code>).  When
(<code>binary=TRUE</code>), <code>y</code> must be 0/1 and starting values are returned 
for an Emax model on the logit scale.</p>
</td></tr>
<tr><td><code id="startEmax_+3A_dose">dose</code></td>
<td>
<p>Dose variable corresponding to each outcome value.</p>
</td></tr>
<tr><td><code id="startEmax_+3A_baseline">baseline</code></td>
<td>
<p>Optional baseline covariate(s) of same length as y.
When baseline is specified, starting values are created from anacova
adjusted dose group means.</p>
</td></tr>
<tr><td><code id="startEmax_+3A_count">count</code></td>
<td>
<p>Counts for the number of patients with each dose/y value.  
Default is 1 (ungrouped data).</p>
</td></tr>
<tr><td><code id="startEmax_+3A_modtype">modType</code></td>
<td>
<p>modType=3 (default) for the 3-parameter Emax model.
modType=4 for the 4-parameter Emax model.</p>
</td></tr> 
<tr><td><code id="startEmax_+3A_lbed50">lbED50</code></td>
<td>
<p>If the starting ED50 is below lbED50, it is set to
lbED50.</p>
</td></tr>
<tr><td><code id="startEmax_+3A_ubed50">ubED50</code></td>
<td>
<p>If the starting ED50 is above ubED50, it is set to
ubED50.</p>
</td></tr>
<tr><td><code id="startEmax_+3A_lblambda">lbLambda</code></td>
<td>
<p>If the starting lambda is below lbLambda, it is set to
lbLambda.</p>
</td></tr>
<tr><td><code id="startEmax_+3A_ublambda">ubLambda</code></td>
<td>
<p>If the starting lambda is above ubLambda, it is set to
ubLambda.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector with named elements for the starting values for a 3
or 4 parameter Emax model. The order is log(ED50), (lambda, 4 parm), 
emax, and e0. If baseline is specified, a 'beta'
starting parameter is also returned at the end of the vector.
</p>


<h3>Note</h3>

<p>The method is modified from functions created by J. Rogers and start
functions supplied with R (SSfp1).  The ED50 (and lambda) are computed using
the logit-linear relationship between the proportion of the mean
response out of the max response and the log(dose).  The method assumes
placebo data are present, but it will return a starting value even if it is
not present.  A miniumum of four dose levels is required for 4-parameter 
starting values.
</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+nls">nls</a></code>,  <code><a href="#topic+emaxalt">emaxalt</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data("metaData")
exdat&lt;-metaData[metaData$taid==6 &amp; metaData$poptype==1,]

startEmax(exdat$rslt,exdat$dose)
</code></pre>

<hr>
<h2 id='summary.emaxsim'> Summary of output of emaxsim </h2><span id='topic+summary.emaxsim'></span>

<h3>Description</h3>

<p>Detailed summary of repeated sampling properties of Emax estimation
and comparison with simple pairwise comparisons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emaxsim'
summary(object, testalpha = 0.05, clev = 0.9, 
                          seSim = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.emaxsim_+3A_object">object</code></td>
<td>
<p> Output  of <code><a href="#topic+emaxsim">emaxsim</a></code> </p>
</td></tr>
<tr><td><code id="summary.emaxsim_+3A_testalpha">testalpha</code></td>
<td>
<p>Alpha level for a one-sided MCP-MOD trend test</p>
</td></tr>
<tr><td><code id="summary.emaxsim_+3A_clev">clev</code></td>
<td>
<p> Nominal confidence level for reported CIs </p>
</td></tr>
<tr><td><code id="summary.emaxsim_+3A_sesim">seSim</code></td>
<td>
<p> If <code>TRUE</code>, then simulation standard errors are reported in
parentheses.  These should be distinguished from standard errors for
estimators in the simulation.</p>
</td></tr>
<tr><td><code id="summary.emaxsim_+3A_...">...</code></td>
<td>
<p>Other unspecified parameters (none currently utilized) </p>
</td></tr>
</table>


<h3>Details</h3>

<p>For pairwise comparisons, the 'most favorable pairwise comparison' means the dose with the best difference versus placebo is compared to the population
mean response for the selected dose, thus the target value for coverage,
bias, and RMSE changes depending on the selected dose.</p>


<h3>Value</h3>

<p>The function produces annotated output summarizing the
properties of the estimation procedures.  The summaries are also
returned as an invisible list for extracting results.
</p>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>See Also</h3>

  <p><code><a href="#topic+emaxsim">emaxsim</a></code>, <code><a href="#topic+print.emaxsim">print.emaxsim</a></code>,
<code><a href="#topic+plot.emaxsim">plot.emaxsim</a></code>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
## emaxsim changes the random number seed
nsim&lt;-50
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop.parm&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop.parm)  

###FixedMean is specialized constructor function for emaxsim
gen.parm&lt;-FixedMean(n,doselev,meanlev,sdy)  
D1 &lt;- emaxsim(nsim,gen.parm)
summary(D1,testalph=0.05,clev=0.95)

## End(Not run)

</code></pre>

<hr>
<h2 id='summary.emaxsimB'> Summary of output of emaxsimB </h2><span id='topic+summary.emaxsimB'></span>

<h3>Description</h3>

<p>Detailed summary of repeated sampling properties of Bayesian Emax estimation
and comparison with simple pairwise comparisons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emaxsimB'
summary(object, testalpha = 0.05, 
	clev = c('0.9','0.95','0.8'),
	seSim = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.emaxsimB_+3A_object">object</code></td>
<td>
<p> Output  of <code><a href="#topic+emaxsimB">emaxsimB</a></code> </p>
</td></tr>
<tr><td><code id="summary.emaxsimB_+3A_testalpha">testalpha</code></td>
<td>
<p> Alpha level for a one-sided MCP-MOD trend test.</p>
</td></tr>
<tr><td><code id="summary.emaxsimB_+3A_clev">clev</code></td>
<td>
<p> Posterior proabilities for reported intervals</p>
</td></tr>
<tr><td><code id="summary.emaxsimB_+3A_sesim">seSim</code></td>
<td>
<p> If <code>TRUE</code>, then simulation standard errors are reported in
parentheses.  These should be distinguished from posterior SD
in the simulations.</p>
</td></tr>
<tr><td><code id="summary.emaxsimB_+3A_...">...</code></td>
<td>
<p>Other unspecified parameters (none currently utilized) </p>
</td></tr>
</table>


<h3>Details</h3>

<p>For pairwise comparisons, the 'most favorable pairwise comparison' means the dose with the best difference versus placebo is compared to the population
mean response for the selected dose, thus the target value for coverage,
bias, and RMSE changes depending on the selected dose.</p>


<h3>Value</h3>

<p>The function produces annotated output summarizing the
properties of the estimation procedures.  The summaries are also
returned as an invisible list for extracting results.
</p>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>See Also</h3>

  <p><code><a href="#topic+emaxsim">emaxsim</a></code>, <code><a href="#topic+print.emaxsim">print.emaxsim</a></code>,
<code><a href="#topic+plot.emaxsim">plot.emaxsim</a></code>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

## emaxsimB changes the random number seed
nsim&lt;-50
idmax&lt;-5
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)
Ndose&lt;-length(doselev)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-2.464592
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop)  

###FixedMean is specialized constructor function for emaxsim
gen&lt;-FixedMean(n,doselev,meanlev,sdy)  

prior&lt;-emaxPrior.control(epmu=0,epsca=30,difTargetmu=0,
		difTargetsca=30,dTarget=100,p50=50,sigmalow=0.1,
		sigmaup=30,parmDF=5)
mcmc&lt;-mcmc.control(chains=1,warmup=500,iter=5000,seed=53453,propInit=0.15,adapt_delta = 0.95)

D1 &lt;- emaxsimB(nsim,gen, prior, modType=3,mcmc=mcmc,check=FALSE)


summary(D1,testalph=0.05,clev='0.95')

## End(Not run)
</code></pre>

<hr>
<h2 id='summary.emaxsimBobj'>Summarize Emax fit to a data set generated by emaxsimB </h2><span id='topic+summary.emaxsimBobj'></span>

<h3>Description</h3>

<p>Summary of the Bayesian Emax fit to a simulated data
set</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emaxsimBobj'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.emaxsimBobj_+3A_object">object</code></td>
<td>
<p>Extracted simulation object </p>
</td></tr>
<tr><td><code id="summary.emaxsimBobj_+3A_...">...</code></td>
<td>
<p>No other parameters are currently implemented </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Printed output only.  No values are returned.
</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

 <p><code><a href="#topic+emaxsimB">emaxsimB</a></code>, 
<code><a href="#topic+plot.emaxsimBobj">plot.emaxsimBobj</a></code>, <code><a href="#topic+print.emaxsimBobj">print.emaxsimBobj</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

## emaxsimB changes the random number seed
nsim&lt;-50
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)
Ndose&lt;-length(doselev)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-2.464592
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop)  

###FixedMean is specialized constructor function for emaxsim
gen&lt;-FixedMean(n,doselev,meanlev,sdy)  

prior&lt;-emaxPrior.control(epmu=0,epsca=30,difTargetmu=0,
		difTargetsca=30,dTarget=100,p50=50,sigmalow=0.1,
		sigmaup=30,parmDF=5)
mcmc&lt;-mcmc.control(chains=1,warmup=500,iter=5000,seed=53453,propInit=0.15,adapt_delta = 0.95)

D1 &lt;- emaxsimB(nsim,gen, prior, modType=3,mcmc=mcmc,check=FALSE)
summary(D1[1])

## End(Not run)
</code></pre>

<hr>
<h2 id='summary.emaxsimobj'>Summarize Emax fit to a data set generated by emaxsim </h2><span id='topic+summary.emaxsimobj'></span>

<h3>Description</h3>

<p>Summary of the Emax or alternative fit to a simulated data
set</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emaxsimobj'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.emaxsimobj_+3A_object">object</code></td>
<td>
<p>Extracted simulation object </p>
</td></tr>
<tr><td><code id="summary.emaxsimobj_+3A_...">...</code></td>
<td>
<p>No other parameters are currently implemented </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Printed output only.  No values are returned.
</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

 <p><code><a href="#topic+emaxsim">emaxsim</a></code>, 
<code><a href="#topic+plot.emaxsimobj">plot.emaxsimobj</a></code>, <code><a href="#topic+print.emaxsimobj">print.emaxsimobj</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## emaxsim changes the random number seed
nsim&lt;-3
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop)  

###FixedMean is specialized constructor function for emaxsim
gen.parm&lt;-FixedMean(n,doselev,meanlev,sdy)  
D1 &lt;- emaxsim(nsim,gen.parm,nproc=1)
e3&lt;-D1[3]

summary(e3)  
</code></pre>

<hr>
<h2 id='summary.fitEmax'>
Print a summary of the fitted Emax model
</h2><span id='topic+summary.fitEmax'></span>

<h3>Description</h3>

<p>Print a summary of the fitted Emax model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitEmax'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.fitEmax_+3A_object">object</code></td>
<td>

<p>Object output by <code><a href="#topic+fitEmax">fitEmax</a></code>
</p>
</td></tr>
<tr><td><code id="summary.fitEmax_+3A_...">...</code></td>
<td>

<p>No options implemented.
</p>
</td></tr>
</table>

<hr>
<h2 id='summary.fitEmaxB'>
Print a summary of the fitted Bayesian Emax model
</h2><span id='topic+summary.fitEmaxB'></span>

<h3>Description</h3>

<p>Print a summary of the fitted Bayesian Emax model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitEmaxB'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.fitEmaxB_+3A_object">object</code></td>
<td>

<p>Object output by <code><a href="#topic+fitEmaxB">fitEmaxB</a></code>
</p>
</td></tr>
<tr><td><code id="summary.fitEmaxB_+3A_...">...</code></td>
<td>

<p>No options implemented.
</p>
</td></tr>
</table>

<hr>
<h2 id='targetBeta'>Find a scaled Beta distribution matching specified probabilities</h2><span id='topic+targetBeta'></span>

<h3>Description</h3>

<p>Find the (a,b) parameters of a scaled Beta distribution with specified 
cummulative probabilities for two specified points from the distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>targetBeta(minval,pminV,pmaxV,maxval=1,aInit=1,bInit=1,upB=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="targetBeta_+3A_minval">minval</code></td>
<td>
<p>The minimum value with a targetted cummulative probability</p>
</td></tr> 
<tr><td><code id="targetBeta_+3A_pminv">pminV</code></td>
<td>
<p>The targetted cummulative probability less than <code>minval</code></p>
</td></tr>
<tr><td><code id="targetBeta_+3A_pmaxv">pmaxV</code></td>
<td>
<p>The targetted cummulative probability less than <code>maxval</code></p>
</td></tr>
<tr><td><code id="targetBeta_+3A_maxval">maxval</code></td>
<td>
<p>The maximum value with a targetted cummulative probability</p>
</td></tr> 
<tr><td><code id="targetBeta_+3A_ainit">aInit</code></td>
<td>
<p>An initial guess for the first parameter of the scaled Beta distribution with
the specified probabilities.</p>
</td></tr>
<tr><td><code id="targetBeta_+3A_binit">bInit</code></td>
<td>
<p>An initial guess for the second parameter of the scaled Beta distribution with
the specified probabilities.</p>
</td></tr>
<tr><td><code id="targetBeta_+3A_upb">upB</code></td>
<td>
<p>The upper limit of the scaled Beta distribution.  It is 
specified by the user.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Beta distribution with the targetted probabilities is found from
starting values using the <code>optim</code> function.
</p>


<h3>Value</h3>

<p>Returns the (a,b) parameters of the scaled beta distribution if one
with the specified probabilities can be found.  An error message is 
returned otherwise.
</p>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>Examples</h3>

<pre><code class='language-R'>### set quartiles at .15 and 1.0 for a beta distribution on (0,3)
targetBeta(minval=.15,pminV=0.25,pmaxV=0.75,maxval=1.0,upB=3)
</code></pre>

<hr>
<h2 id='targetCI'>Compute the dose with confidence interval exceeding a target
change from placebo for each simulated example in an emaxsim object. </h2><span id='topic+targetCI'></span>

<h3>Description</h3>

<p>Selects the lowest dose from a user-specified grid of doses with confidence interval exceeding a targetted
change from placebo for each simulated data set in an emaxsim object.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>targetCI (object,
	target,
	dgrid,
	clev=0.90,
	high= TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="targetCI_+3A_object">object</code></td>
<td>
<p> An emaxsim object </p>
</td></tr>
<tr><td><code id="targetCI_+3A_target">target</code></td>
<td>
<p>Target improvement from placebo</p>
</td></tr>
<tr><td><code id="targetCI_+3A_dgrid">dgrid</code></td>
<td>
<p>The lowest dose is found by a search over a
user-specified grid of doses.  If dgrid is a single value, it is
interpreted as the number of equally-spaced doses to select from 
zero to the highest dose in the simulated design.</p>
</td></tr>
<tr><td><code id="targetCI_+3A_clev">clev</code></td>
<td>
<p>One-sided confidence interval level.</p>
</td></tr>
<tr><td><code id="targetCI_+3A_high">high</code></td>
<td>
<p>When TRUE, lower bounds are computed and must be higher
than the target.  When FALSE, upper bounds must be less than the target.</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>Returns a vector with the lowest dose meeting the criteria.  If a
simulated example does not have a qualifying dose, Inf is returned.
</p>


<h3>Note</h3>

<p>If the grid is very large (&gt;200), execution will slow as a large 
number of estimates and SEs are computed.
</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

<p><code><a href="#topic+emaxsim">emaxsim</a>, <a href="#topic+predict.emaxsim">predict.emaxsim</a></code>, <a href="#topic+targetD">targetD</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>	## Not run: 

		# emaxsim changes the random number seed
		nsim&lt;-100
		doselev&lt;-c(0,5,25,50,100)
		n&lt;-c(78,81,81,81,77)

		### population parameters for simulation
		e0&lt;-2.465375 
		ed50&lt;-67.481113 
		
		dtarget&lt;-100
		diftarget&lt;-9.032497
		emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

		sdy&lt;-7.967897
		pop&lt;-c(log(ed50),emax,e0)    
		meanlev&lt;-emaxfun(doselev,pop)  

		###FixedMean is specialized constructor function for emaxsim
		gen.parm&lt;-FixedMean(n,doselev,meanlev,sdy)  

		D1 &lt;- emaxsim(nsim,gen.parm,modType=3)

		target&lt;-6
		tD&lt;- ( (target*ed50)/(emax-target) )
		selectedDose&lt;-targetCI(D1,target,dgrid=c(1:100)+0.5,clev=0.80,high=TRUE)
	
## End(Not run)
	
</code></pre>

<hr>
<h2 id='targetD'>Compute the MLE (and its SE) of the dose achieving a specified
target improvement from placebo. </h2><span id='topic+targetD'></span>

<h3>Description</h3>

<p>The MLE (se) of the dose required to achieve a targetted improvement
from placebo.
The fit can be from a 3- or 4- parameter Emax model or output from 
function emaxalt, or an object of class emaxsimobj.  The Emax model
is on the logit scale for binary data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>targetD (fit,
	target,
	modType=4,
	binary=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="targetD_+3A_fit">fit</code></td>
<td>
<p>Output of <code><a href="stats.html#topic+nls">nls</a></code> <code>fit</code> to a 3- or 4-parameter Emax
model.  The order of the parameters in the fit must be (log(ed50),emax,e0)
or (log(ed50),lambda,emax,e0).  
<code>fit</code> can also be a list with the first element the coefficient
vector, and the second element the variance-covariance matrix. 
Alternatively, <code>fit</code> may be of class <code>emaxalt</code> or 
<code>emaxsimobj</code>, and the target dose is based on the fitted model.</p>
</td></tr>
<tr><td><code id="targetD_+3A_target">target</code></td>
<td>
<p>Targetted change from placebo (positive or negative). </p>
</td></tr>
<tr><td><code id="targetD_+3A_modtype">modType</code></td>
<td>
<p>Value is 3 or 4 for the 3 or 4-parameter Emax model
output from nls with parameters in the
order (ed50,emax,e0) or (ed50,lambda,emax,e0).  
<code>modType</code> is ignored if fit is from <code>emaxalt</code> or <code>emaxsimobj</code>.</p>
</td></tr>
<tr><td><code id="targetD_+3A_binary">binary</code></td>
<td>
<p>When <code>TRUE</code>, the fit is assumed to be for binary data on 
the logistic scale.  <code>target</code> is input as a risk difference, and 
transformed internally.  When the <code>fit</code> is of class <code>emaxalt</code> or
<code>emaxsimobj</code>, the <code>binary</code> status is taken from the object and
<code>binary</code> is ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector with two elements:
</p>
<table>
<tr><td><code>targetDose</code></td>
<td>
<p>The MLE of the dose achieving the target.</p>
</td></tr>
<tr><td><code>seTD</code></td>
<td>
<p>SE for target.dose</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Asymptotic SE computed using the delta method
</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

<p><code><a href="#topic+SeEmax">SeEmax</a></code>, <code><a href="#topic+emaxalt">emaxalt</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>    ## Not run: 

		## emaxsim changes the random number seed
    doselev&lt;-c(0,5,25,50,100,250)
    n&lt;-c(78,81,81,81,77,80)
    dose&lt;-rep(doselev,n)

    ### population parameters for simulation
    e0&lt;-2.465375 
    ed50&lt;-67.481113 
    
   	dtarget&lt;-100
		diftarget&lt;-9.032497
		emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

    sdy&lt;-7.967897
    pop&lt;-c(led50=log(ed50),emax=emax,e0=e0)    
    meanresp&lt;-emaxfun(dose,pop)  
    y&lt;-rnorm(sum(n),meanresp,sdy)
    nls.fit&lt;-nls(y ~ e0 + (emax * dose)/(dose + exp(led50)), 
                              start = pop, control = nls.control(
                              maxiter = 100),trace=TRUE,na.action=na.omit)

    targetD(nls.fit,10,modType=3)

    ###
    ### apply targetD to an emaxsim object
    ###
    nsim&lt;-50
    sdy&lt;-25
    gen.parm&lt;-FixedMean(n,doselev,emaxfun(doselev,pop),sdy)  
    D4 &lt;- emaxsim(nsim,gen.parm,modType=4)
    summary(D4,testalph=0.05)

    out&lt;-NULL
    for(i in 1:nsim){
        out&lt;-rbind(out,targetD(D4[i],target=4))
    }

## End(Not run)
    
</code></pre>

<hr>
<h2 id='update.emaxsimobj'>Update estimation in a data set generated by emaxsim </h2><span id='topic+update.emaxsimobj'></span>

<h3>Description</h3>

<p>Allows re-estimation for a data set generated by emaxsim using a
different starting value.  Typically used to test different starting
values when nls has failed to converge.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emaxsimobj'
update(object, new.parm, modType=object$modType,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update.emaxsimobj_+3A_object">object</code></td>
<td>
<p> Extracted simulation object  </p>
</td></tr>
<tr><td><code id="update.emaxsimobj_+3A_new.parm">new.parm</code></td>
<td>
<p>New starting value for Emax estimation.  Must have
order (ed50,emax,e0) </p>
</td></tr>
<tr><td><code id="update.emaxsimobj_+3A_modtype">modType</code></td>
<td>
<p>When modType=4, the fitting begins with the 4
parameter model.  If estimation fails or modType=3, the 3-parameter estimation
is applied.  If it fails, a best-fitting model linear in its parameters is
selected.</p>
</td></tr>
<tr><td><code id="update.emaxsimobj_+3A_...">...</code></td>
<td>
<p> No other parameters currently used. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned with class(emaxsimobj).  It has the same format as
those 
extracted by object[ ] </p>


<h3>Author(s)</h3>

<p>Neal Thomas</p>


<h3>See Also</h3>

<p><code><a href="#topic+emaxsim">emaxsim</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

## emaxsim changes the random number seed
nsim&lt;-50
idmax&lt;-5
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop)  

###FixedMean is specialized constructor function for emaxsim
gen&lt;-FixedMean(n,doselev,meanlev,sdy)  
D1 &lt;- emaxsim(nsim,gen)
e49&lt;-D1[49]

#### re-try estimation starting at the population value
e49u&lt;- update(e49,pop)

## End(Not run)

</code></pre>

<hr>
<h2 id='vcovEmax'>Extract Emax model variance-covariance matrix for ML estimates</h2><span id='topic+vcov.fitEmax'></span><span id='topic+vcov.emaxsim'></span>

<h3>Description</h3>

<p>Extract Emax model variance-covariance matrix for ML estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'fitEmax'
vcov(object, ...)
	## S3 method for class 'emaxsim'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcovEmax_+3A_object">object</code></td>
<td>
<p> Output of Emax fitting and simulation functions </p>
</td></tr>
<tr><td><code id="vcovEmax_+3A_...">...</code></td>
<td>
<p> None additional inputs supported </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Variance-Covariance matrix for the MLE estimates of the parameters from <code>fitEmax</code>. 
The lower half of the variance-covariance matrix for the estimated 
parameters stored as a vector in column-major order for each 
<code>emaxsim</code> simulation. The vc matrix has 16,9, or 4 
elements depending on fitType. 
</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

 <p><code><a href="#topic+fitEmax">fitEmax</a></code>, 
<code><a href="#topic+emaxsim">emaxsim</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>doselev&lt;-c(0,5,25,50,100,350)
n&lt;-c(78,81,81,81,77,80)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-8.0
pop&lt;-c(log(ed50),emax,e0)    
dose&lt;-rep(doselev,n)
meanlev&lt;-emaxfun(dose,pop)  

y&lt;-rnorm(sum(n),meanlev,sdy)

testout&lt;-fitEmax(y,dose,modType=4)
vcov(testout)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
