<!DOCTYPE html><html lang="en"><head><title>Help for package gamlss.cens</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gamlss.cens}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gamlss.cens-package'>
<p>Fitting an Interval Response Variable Using &lsquo;gamlss.family&rsquo;</p>
Distributions</a></li>
<li><a href='#cens'><p>Function to Fit Censored Data Using a gamlss.family Distribution</p></a></li>
<li><a href='#cens.d'><p>Censored Probability Density Function of a gamlss.family Distribution</p></a></li>
<li><a href='#cens.p'><p>Censored Cumulative Probability Density Function of a gamlss.family Distribution</p></a></li>
<li><a href='#cens.q'>
<p>Censored Inverse Cumulative Probability Density Function of a gamlss.family</p>
Distribution</a></li>
<li><a href='#gen.cens'><p>A Function to Generate Appropriate Functions to Be Used to Fit a Censored Response variable in GAMLSS</p></a></li>
<li><a href='#lip'><p>Data for lip</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fitting an Interval Response Variable Using &lsquo;gamlss.family&rsquo;
Distributions</td>
</tr>
<tr>
<td>Version:</td>
<td>5.0-7</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-08</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.2.1), gamlss.dist, gamlss, survival, methods</td>
</tr>
<tr>
<td>Author:</td>
<td>Mikis Stasinopoulos &lt;d.stasinopoulos@gre.ac.uk&gt;, Bob
        Rigby, Nicoleta Mortan, Alexander Seipp</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mikis Stasinopoulos &lt;d.stasinopoulos@gre.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>This is an add-on package to GAMLSS. The purpose of this
        package is to allow users to fit interval response variables in
        GAMLSS models. The main function gen.cens() generates a
        censored version of an existing GAMLSS family distribution.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.gamlss.com/">https://www.gamlss.com/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-07 13:47:50 UTC; dimitriosstasinopoulos</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-07 14:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='gamlss.cens-package'>
Fitting an Interval Response Variable Using &lsquo;gamlss.family&rsquo;
Distributions
</h2><span id='topic+gamlss.cens-package'></span><span id='topic+gamlss.cens'></span>

<h3>Description</h3>

<p>This is an add-on package to GAMLSS. The purpose of this
        package is to allow users to fit interval response variables in
        GAMLSS models. The main function gen.cens() generates a
        censored version of an existing GAMLSS family distribution.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> gamlss.cens</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Fitting an Interval Response Variable Using `gamlss.family'
Distributions</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 5.0-7</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-10-08</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 2.2.1), gamlss.dist, gamlss,  survival, methods</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Mikis Stasinopoulos &lt;d.stasinopoulos@gre.ac.uk&gt;, Bob
        Rigby, Nicoleta Mortan, Alexander Seipp</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Mikis Stasinopoulos &lt;d.stasinopoulos@gre.ac.uk&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> This is an add-on package to GAMLSS. The purpose of this
        package is to allow users to fit interval response variables in
        GAMLSS models. The main function gen.cens() generates a
        censored version of an existing GAMLSS family distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2 | GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
URL: </td><td style="text-align: left;"> https://www.gamlss.com/</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
cens                    Function to Fit Censored Data Using a
                        gamlss.family Distribution
cens.d                  Censored Probability Density Function of a
                        gamlss.family Distribution
cens.p                  Censored Cumulative Probability Density
                        Function of a gamlss.family Distribution
cens.q                  Censored Inverse Cumulative Probability Density
                        Function of a gamlss.family Distribution
gamlss.cens-package     Fitting an Interval Response Variable Using
                        'gamlss.family' Distributions
gen.cens                A Function to Generate Appropriate Functions to
                        Be Used to Fit a Censored Response variable in
                        GAMLSS
lip                     Data for lip
</pre>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos &lt;d.stasinopoulos@gre.ac.uk&gt;, Bob
        Rigby, Nicoleta Mortan, Alexander Seipp
</p>
<p>Maintainer: Mikis Stasinopoulos &lt;d.stasinopoulos@gre.ac.uk&gt;
</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017) <em>Flexible Regression and Smoothing: Using GAMLSS in R</em>, Chapman and Hall/CRC. 
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code><a href="gamlss.html#topic+gamlss">gamlss</a></code>, <code><a href="gamlss.dist.html#topic+gamlss.family">gamlss.family</a></code>  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(survival)
library(gamlss)
library(gamlss.dist)
# comparing results with package survival
# fitting the exponential distribution
ms1&lt;-survreg(Surv(futime, fustat) ~ ecog.ps + rx, ovarian, 
             dist='exponential')
mg1&lt;-gamlss(Surv(futime, fustat) ~ ecog.ps + rx, data=ovarian, 
             family=cens(EXP),c.crit=0.00001)
if(abs(-2*ms1$loglik[2]-deviance(mg1))&gt;0.001) stop(paste("descrepancies in exp")) 
if(sum(coef(ms1)-coef(mg1))&gt;0.001) warning(paste("descrepancies in coef in exp")) 
summary(ms1)
summary(mg1)
# fitting the Weibull distribution
ms2 &lt;-survreg(Surv(futime, fustat) ~ ecog.ps + rx, ovarian, dist='weibull')
mg2 &lt;-gamlss(Surv(futime, fustat) ~ ecog.ps + rx, data=ovarian, 
           family=cens(WEI, delta=c(0.001,0.001)), c.crit=0.00001)
if(abs(-2*ms2$loglik[2]-deviance(mg2))&gt;0.005) 
     stop(paste("descrepancies in deviance in WEI")) 
summary(ms2);summary(mg2)
# compare the scale parameter
 1/exp(coef(mg2,"sigma"))
# now fit the Weibull in different parameterrazions  
mg21&lt;-gamlss(Surv(futime, fustat) ~ ecog.ps + rx, data=ovarian, 
             family=cens(WEI2), method=mixed(2,30)) 
mg21&lt;-gamlss(Surv(futime, fustat) ~ ecog.ps + rx, data=ovarian, 
             family=cens(WEI3)) 
</code></pre>

<hr>
<h2 id='cens'>Function to Fit Censored Data Using a gamlss.family Distribution</h2><span id='topic+cens'></span>

<h3>Description</h3>

<p> This function can be used to fit censored or interval response variables. 
It takes as an argument an existing <code><a href="gamlss.dist.html#topic+gamlss.family">gamlss.family</a></code> distribution  
and  generates 
a new <code><a href="gamlss.dist.html#topic+gamlss.family">gamlss.family</a></code> object which then can be used to fit 
right, left or interval censored data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cens(family = "NO", type = c("right", "left", "interval"), name = "cens", 
       local = TRUE, delta = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cens_+3A_family">family</code></td>
<td>
<p> a <code><a href="gamlss.dist.html#topic+gamlss.family">gamlss.family</a></code> object, which is used to 
define the distribution and the link functions of the various parameters. 
The distribution families supported by <code>gamlss()</code> 
can be found in <code><a href="gamlss.dist.html#topic+gamlss.family">gamlss.family</a></code> and in the package <code>gamlss.dist</code>.</p>
</td></tr>
<tr><td><code id="cens_+3A_name">name</code></td>
<td>
<p>the characters you want to add to the name of new functions, by default is <code>cens</code></p>
</td></tr>
<tr><td><code id="cens_+3A_type">type</code></td>
<td>
<p>what type of censoring is required, <code>right</code>, <code>left</code> or <code>interval</code>.</p>
</td></tr>
<tr><td><code id="cens_+3A_local">local</code></td>
<td>
<p>if TRUE the function will try to find the environment of <code>gamlss</code> to generate 
the <code>d</code> and <code>p</code> functions required for the fitting, 
if FALSE the functions will be generated in the global environment</p>
</td></tr>
<tr><td><code id="cens_+3A_delta">delta</code></td>
<td>
<p>the delta increment used in the numerical derivatives</p>
</td></tr> 
<tr><td><code id="cens_+3A_...">...</code></td>
<td>
<p>for extra arguments </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is created to help users to fit censored data using an existing 
<code>gamlss.family</code> distribution.
It does this by taking an existing <code><a href="gamlss.dist.html#topic+gamlss.family">gamlss.family</a></code> and changing 
some of the components of the distribution to help the fitting process. 
It particular it (i) creates a (<code>d</code>) function (for calculating the censored 
likelihood) and a (<code>p</code>) function (for generating the quantile residuals) 
within <code>gamlss</code>, 
(ii) changes  the global deviance function <code>G.dev.incr</code>, 
the first derivative functions (see note below) 
and other quantities from the original distribution.   
</p>


<h3>Value</h3>

<p>It returns a <code><a href="gamlss.dist.html#topic+gamlss.family">gamlss.family</a></code> object which has all the components needed for fitting a distribution in <code>gamlss</code>.
</p>


<h3>Note</h3>

<p>This function is experimental and could be changed in the future. 
The function <code>cens</code> changes the first derivatives of the original gamlss family 
<code>d</code> function to numerical derivatives for the new censored <code>d</code> function. 
The default increment <code>delta</code>, for this numerical derivatives function, 
is <code>eps * pmax(abs(x), 1)</code> where  <code>eps&lt;-sqrt(.Machine$double.eps)</code>. 
The default <code>delta</code> could be inappropriate for 
specific applications and can be overwritten by using the argument <code>delta</code>.
</p>
<p>Note that in order to get the correct standard errors you have to generate the &quot;d&quot; function by using
<code>gen.cens()</code>.
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos <a href="mailto:d.stasinopoulos@londonmet.ac.uk">d.stasinopoulos@londonmet.ac.uk</a> and Bob Rigby <a href="mailto:r.rigby@londonmet.ac.uk">r.rigby@londonmet.ac.uk</a></p>


<h3>References</h3>

<p> Rigby, R. A. and Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), Appl. Statist., 54, part 3, 1-38.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cens.d">cens.d</a></code>, <code><a href="#topic+cens.p">cens.p</a></code>,  <code><a href="#topic+gen.cens">gen.cens</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># comparing output with the survreg() of package survival
library(gamlss.dist)
library(survival)
#--------------------------------------------------------------------
# right censoring example 
# example from survreg() 
# fitting the exponential distribution
mexp&lt;-survreg(Surv(futime, fustat) ~ ecog.ps + rx, ovarian, dist='exponential')
gexp&lt;-gamlss(Surv(futime, fustat) ~ ecog.ps + rx, data=ovarian, 
             family=cens(EXP), c.crit=0.00001)
if(abs(-2*mexp$loglik[2]-deviance(gexp))&gt;0.001) 
         stop(paste("descrepancies in exponential models")) 
if(sum(coef(mexp)-coef(gexp))&gt;0.001) 
        warning(paste("descrepancies in coef in exponential models")) 
summary(mexp)
gen.cens(EXP)
summary(gexp)
# fitting different distributions
# weibull 
mwei &lt;-survreg(Surv(futime, fustat) ~ ecog.ps + rx, ovarian, dist='weibull')
gwei&lt;-gamlss(Surv(futime, fustat) ~ ecog.ps + rx, data=ovarian, 
             family=cens(WEI, delta=c(0.0001,0.0001)), c.crit=0.00001)
if(abs(-2*mwei$loglik[2]-deviance(gwei))&gt;0.005) 
        stop(paste("descrepancies in deviance in WEI")) 
scoef &lt;- sum(coef(mwei)-coef(gwei))
if(abs(scoef)&gt;0.005) 
         warning(cat("descrepancies in coef in WEI of ", scoef, "\n")) 
# WEI3 is weibull parametrised with mu as the mean
gwei3 &lt;- gamlss(Surv(futime, fustat) ~ ecog.ps + rx, data=ovarian, 
                 family=cens(WEI3)) 
# log normal
mlogno &lt;-survreg(Surv(futime, fustat) ~ ecog.ps + rx, ovarian, 
                  dist='lognormal')
glogno&lt;-gamlss(Surv(futime, fustat) ~ ecog.ps + rx, data=ovarian, 
                family=cens(LOGNO, delta=c(0.001,0.001)), c.cyc=0.00001)
if(abs(-2*mlogno$loglik[2]-deviance(glogno))&gt;0.005) 
          stop(paste("descrepancies in deviance in LOGNO")) 
coef(mlogno);coef(glogno) 
#-------------------------------------------------------------------- 
# now interval response variable 
data(lip)
with(lip, y)
mg1&lt;-survreg(y ~ poly(Tem,2)+poly(pH,2)+poly(aw,2), data=lip, dist="weibull")
gg1&lt;- gamlss(y ~ poly(Tem,2)+poly(pH,2)+poly(aw,2), data=lip, 
      family=cens(WEI,type="interval"), c.crit=0.00001, n.cyc=200, trace=FALSE)
summary(mg1)
gen.cens(WEI,type="interval")
summary(gg1)
#--------------------------------------------------------------------
# now fitting discretised continuous distribution to count data
# fitting discretised Gamma
data(species)
# first generate the distributions
gen.cens(GA, type="interval")
gen.cens(IG, type="interval")
 mGA&lt;-gamlss(Surv(fish,fish+1,type= "interval2")~log(lake)+I(log(lake)^2), 
       sigma.fo=~log(lake), data=species, family=GAic)
# fitting discretised inverse Gaussian
 mIG&lt;-gamlss(Surv(fish,fish+1,type= "interval2")~log(lake)+I(log(lake)^2), 
      sigma.fo=~log(lake), data=species, family=IGic)
AIC(mGA,mIG)
plot(fish~log(lake), data=species)
with(species, lines(log(lake)[order(lake)], fitted(mIG)[order(lake)]))             
#--------------------------------------------------------------------
</code></pre>

<hr>
<h2 id='cens.d'>Censored Probability Density Function of a gamlss.family Distribution</h2><span id='topic+cens.d'></span>

<h3>Description</h3>

<p>Creates a probability density function from a current <code><a href="gamlss.dist.html#topic+gamlss.family">gamlss.family</a></code>  
distribution to be used for fitting a censored or interval response variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cens.d(family = "NO", type = c("right", "left", "interval"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cens.d_+3A_family">family</code></td>
<td>
<p> a <code><a href="gamlss.dist.html#topic+gamlss.family">gamlss.family</a></code> object, which is used to 
define the distribution and the link functions of the various parameters. 
The distribution families supported by <code>gamlss()</code> 
can be found in <code><a href="gamlss.dist.html#topic+gamlss.family">gamlss.family</a></code> and in the package <code>gamlss.dist</code>.</p>
</td></tr>
<tr><td><code id="cens.d_+3A_type">type</code></td>
<td>
<p> whether <code>right</code>, <code>left</code>  or in <code>interval</code> censoring is required, (right is the default) </p>
</td></tr>
<tr><td><code id="cens.d_+3A_...">...</code></td>
<td>
<p>for extra arguments </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used to calculate the likelihood function for censored data. 
This function is not supposed to be used on its own but it is used in function <code>gen.cens</code>. 
</p>


<h3>Value</h3>

<p>Returns a modified d family function.  
The argument of the original function <code>d</code> function are the same.  
</p>


<h3>Note</h3>

<p>For an example see <code>gen.cens()</code>   
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos <a href="mailto:d.stasinopoulos@londonmet.ac.uk">d.stasinopoulos@londonmet.ac.uk</a> and Bob Rigby</p>


<h3>References</h3>

<p>Rigby, R. A. and Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), Appl. Statist., 54, part 3, 1-38.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+cens.p">cens.p</a></code>,  <code><a href="#topic+gen.cens">gen.cens</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>#see the help for function cens for an example</code></pre>

<hr>
<h2 id='cens.p'>Censored Cumulative Probability Density Function of a gamlss.family Distribution</h2><span id='topic+cens.p'></span>

<h3>Description</h3>

<p>Creates a cumulative density function from a current <code><a href="gamlss.dist.html#topic+gamlss.family">gamlss.family</a></code>  
distribution suitable for censored or interval response variable data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cens.p(family = "NO", type = c("right", "left", "interval"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cens.p_+3A_family">family</code></td>
<td>
<p> a <code><a href="gamlss.dist.html#topic+gamlss.family">gamlss.family</a></code> object, which is used to 
define the distribution and the link functions of the various parameters. 
The distribution families supported by <code>gamlss()</code> can be found in 
<code><a href="gamlss.dist.html#topic+gamlss.family">gamlss.family</a></code>.</p>
</td></tr>
<tr><td><code id="cens.p_+3A_type">type</code></td>
<td>
<p> whether <code>right</code>, <code>left</code>  or in <code>interval</code> censoring is required, (right is the default) </p>
</td></tr>
<tr><td><code id="cens.p_+3A_...">...</code></td>
<td>
<p>for extra arguments </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used to calculate the quantile residuals for censored data distributions.
This function is not supposed to be used on its own but it is used in the function <code>gen.cens</code>.  
</p>


<h3>Value</h3>

<p>Returns a modified p family function.  
The argument of the original function d function are the same.  
</p>


<h3>Note</h3>

<p>For an example see <code>gen.cens()</code></p>


<h3>Author(s)</h3>

<p> Mikis Stasinopoulos <a href="mailto:d.stasinopoulos@londonmet.ac.uk">d.stasinopoulos@londonmet.ac.uk</a> and Bob Rigby <a href="mailto:r.rigby@londonmet.ac.uk">r.rigby@londonmet.ac.uk</a> </p>


<h3>References</h3>

<p>Rigby, R. A. and Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), Appl. Statist., 54, part 3, 1-38.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+cens.d">cens.d</a></code>,  <code><a href="#topic+gen.cens">gen.cens</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>#see the help for function cens for an example</code></pre>

<hr>
<h2 id='cens.q'>
Censored Inverse Cumulative Probability Density Function of a gamlss.family  
Distribution</h2><span id='topic+cens.q'></span>

<h3>Description</h3>

<p>Creates the inverse cumulative density function from a current <code><a href="gamlss.dist.html#topic+gamlss.family">gamlss.family</a></code> 
distribution suitable for censored or interval response variable data.
This is a dummy function identical to the uncensored one but it is needed for 
consistency in centile estimation from censored data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cens.q(family = "NO", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cens.q_+3A_family">family</code></td>
<td>
<p> a <code><a href="gamlss.dist.html#topic+gamlss.family">gamlss.family</a></code> object, which is used to 
define the distribution and the link functions of the various parameters. 
The distribution families supported by <code>gamlss()</code> can be found in 
<code><a href="gamlss.dist.html#topic+gamlss.family">gamlss.family</a></code>.</p>
</td></tr>
<tr><td><code id="cens.q_+3A_...">...</code></td>
<td>
<p>for extra arguments </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is dummy function, used only to calculate centiles from censored response 
variable.
This function is not supposed to be used on its own but is used by the function 
<code>gen.cens</code>.
</p>


<h3>Value</h3>

<p>Returns a modified q family function.  
The argument of the original function q function are the same.  
</p>


<h3>Note</h3>

<p>For an example see <code>gen.cens()</code></p>


<h3>Author(s)</h3>

<p> Mikis Stasinopoulos <a href="mailto:d.stasinopoulos@londonmet.ac.uk">d.stasinopoulos@londonmet.ac.uk</a> and Bob Rigby <a href="mailto:r.rigby@londonmet.ac.uk">r.rigby@londonmet.ac.uk</a> </p>


<h3>References</h3>

<p>Rigby, R. A. and Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), Appl. Statist., 54, part 3, 1-38.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+cens.d">cens.d</a></code>, <code><a href="#topic+cens.p">cens.p</a></code>, <code><a href="#topic+gen.cens">gen.cens</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>#see the help for function cens for an example</code></pre>

<hr>
<h2 id='gen.cens'>A Function to Generate Appropriate Functions to Be Used to Fit a Censored Response variable in GAMLSS</h2><span id='topic+gen.cens'></span>

<h3>Description</h3>

<p>The <code>gen.cens()</code> function allows the user to generate a
<code>d</code>, <code>p</code>, (dummy) <code>q</code> and fitting  <code>gamlss</code> functions for  
censor and interval response variables.  The function can take any  <code><a href="gamlss.dist.html#topic+gamlss.family">gamlss.family</a></code> distribution. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen.cens(family = "NO", type = c("right", "left", "interval"), 
       name = "cens", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gen.cens_+3A_family">family</code></td>
<td>
<p>a <code><a href="gamlss.dist.html#topic+gamlss.family">gamlss.family</a></code> object, which is 
used to define the distribution and the link functions of the various parameters.
The distribution families supported by <code>gamlss()</code> 
can be found in <code><a href="gamlss.dist.html#topic+gamlss.family">gamlss.family</a></code> and in the package <code>gamlss.dist</code>.</p>
</td></tr>
<tr><td><code id="gen.cens_+3A_name">name</code></td>
<td>
<p>the characters you want to add to the name of new functions, by default is the first letter of <code>type</code> and <code>c</code>
i.e WEIic for WEI (weibull) interval response variable</p>
</td></tr>
<tr><td><code id="gen.cens_+3A_type">type</code></td>
<td>
<p>whether <code>right</code>, <code>left</code>  or in <code>interval</code> censoring is required, 
(right is the default) </p>
</td></tr>
<tr><td><code id="gen.cens_+3A_...">...</code></td>
<td>
<p>for extra arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns  the <code>d</code>, <code>p</code>,  (dummy) <code>q</code> and the fitting used in the fitting gamlss algorithm (The one 
used in the fitting gamlss algorithm)  of a <code>gamlss.family</code> distribution. 
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos <a href="mailto:d.stasinopoulos@londonmet.ac.uk">d.stasinopoulos@londonmet.ac.uk</a> and Bob Rigby</p>


<h3>References</h3>

<p>Rigby, R. A. and Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), Appl. Statist., 54, part 3, 1-38.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+cens.d">cens.d</a></code>, <code><a href="#topic+cens.p">cens.p</a></code>, <code><a href="#topic+cens">cens</a></code>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(gamlss.dist)
data(lip)
gen.cens(WEI,type="interval") 
WEIic
gg1&lt;- gamlss(y ~ poly(Tem,2)+poly(pH,2)+poly(aw,2), data=lip, 
     family=WEIic, c.crit=0.00001, n.cyc=200, trace=FALSE)
</code></pre>

<hr>
<h2 id='lip'>Data for lip</h2><span id='topic+lip'></span>

<h3>Description</h3>

<p>The data set used in this package are collected by Dr Peggy Braun (University of Leipzig) and 
passed on to use by professor Jane Sutherland of London Metropolitan University. 
</p>
<p>It consists of experimental  enzymology  results from a research project 
which attempted to develop a generic food spoilage model.
</p>
<p>The data set contains a column called NAMES, which shows the experiment name, 
three columns with values of the environmental conditions: temperature (<code>Tem</code>),
<code>pH</code> and water activity (<code>aw</code>),  and the rest of the columns 
contains the activity of the cocktails, observed at certain days. 
</p>
<p>The researchers recorded the activity of proteases and lipases in each cocktail and 
were interested in predicting the time when the activity started given the  
environmental conditions. 
The activity is a positive integer and enzymes are considered inactive 
when activity=0. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lip)</code></pre>


<h3>Format</h3>

<p>A data frame with 120 observations on the following 14 variables.
</p>

<dl>
<dt><code>name</code></dt><dd><p>a factor with levels the different experiment</p>
</dd> 
<dt><code>Tem</code></dt><dd><p>a numeric vector showing the temperature </p>
</dd>
<dt><code>pH</code></dt><dd><p>a numeric vector PH</p>
</dd>
<dt><code>aw</code></dt><dd><p>a numeric vector water activity</p>
</dd>
<dt><code>X0.d</code></dt><dd><p>a numeric vector if enzyme reacted at day 0</p>
</dd>
<dt><code>X1.d</code></dt><dd><p>a numeric vector if enzyme reacted at day 1</p>
</dd>
<dt><code>X2.d</code></dt><dd><p>a numeric vector if enzyme reacted at day 2</p>
</dd>
<dt><code>X4.d</code></dt><dd><p>a numeric vector if enzyme reacted at days 3 or 4</p>
</dd>
<dt><code>X11.d</code></dt><dd><p>a numeric vector if enzyme reacted at days 5 to 11</p>
</dd>
<dt><code>X18d.</code></dt><dd><p>a numeric vector if enzyme reacted at days 12 to q18</p>
</dd>
<dt><code>X25.d</code></dt><dd><p>a numeric vector if enzyme reacted at days 19 to 25</p>
</dd>
<dt><code>X32.d</code></dt><dd><p>a numeric vector if enzyme reacted at days 26 to 32</p>
</dd>
<dt><code>X39.d</code></dt><dd><p>a numeric vector if enzyme reacted at days 33 to 39</p>
</dd>
<dt><code>y</code></dt><dd><p>a matrix with 3 columns: this is a <code>Surv()</code> 
object indicating the start the finish and censored  indicator as defined in 
function <code>Surv()</code> of <span class="pkg">survival</span>.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Prof.  Jane Sutherland, London Metropolitan University  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(lip)
with(lip, y)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
