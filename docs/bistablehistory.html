<!DOCTYPE html><html><head><title>Help for package bistablehistory</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bistablehistory}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bayes_R2'><p>Computes R-squared using Bayesian R-squared approach.</p></a></li>
<li><a href='#bistablehistory-package'><p>Cumulative History Analysis for Bistable Perception Time Series</p></a></li>
<li><a href='#br'><p>Binocular rivalry data</p></a></li>
<li><a href='#br_contrast'><p>Binocular rivalry, variable contrast</p></a></li>
<li><a href='#br_single_subject'><p>Single experimental session for binocular rivalry stimulus</p></a></li>
<li><a href='#br_singleblock'><p>Single run for binocular rivalry stimulus</p></a></li>
<li><a href='#check_fixed_history_parameter'><p>Evaluates values for a fixed history parameter</p></a></li>
<li><a href='#check_normal_prior'><p>Checks for validity of values for use as normal distribution parameters.</p></a></li>
<li><a href='#coef.cumhist'><p>Extract Model Coefficients</p></a></li>
<li><a href='#compute_history'><p>Computes cumulative history for the time-series</p></a></li>
<li><a href='#cumhist-class'><p>Class <code>cumhist</code>.</p></a></li>
<li><a href='#evaluate_history_init'><p>Evaluates validity of initial history values.</p></a></li>
<li><a href='#evaluate_history_option'><p>Evaluates whether and how to fit a cumulative history parameter.</p></a></li>
<li><a href='#extract_history'><p>Computes history for a fitted model</p></a></li>
<li><a href='#extract_history_parameter'><p>Extracts a history parameter as a matrix</p></a></li>
<li><a href='#extract_replicate_term_to_matrix'><p>Extract a term and replicates it randomN times for each linear model</p></a></li>
<li><a href='#extract_term_to_matrix'><p>Extracts a term with one column per fixed or random-level into a matrix</p></a></li>
<li><a href='#fast_history_compute'><p>Computes cumulative history</p></a></li>
<li><a href='#fit_cumhist'><p>Fits cumulative history for bistable perceptual rivalry displays.</p></a></li>
<li><a href='#fixef'><p>Extract the fixed-effects estimates</p></a></li>
<li><a href='#history_mixed_state'><p>Extract values of used or fitted history parameter mixed_state</p></a></li>
<li><a href='#history_parameter'><p>Extract values of used or fitted history parameter</p></a></li>
<li><a href='#history_tau'><p>Extract values of used or fitted history parameter tau</p></a></li>
<li><a href='#historyef'><p>Extract the history-effects estimates</p></a></li>
<li><a href='#kde'><p>Kinetic-depth effect data</p></a></li>
<li><a href='#kde_two_observers'><p>Multirun data for two participants, kinetic-depth effect display</p></a></li>
<li><a href='#loo.cumhist'><p>Computes an efficient approximate leave-one-out</p>
cross-validation via loo library. It can be used
for a model comparison via loo::loo_compare() function.</a></li>
<li><a href='#nc'><p>Necker cube data</p></a></li>
<li><a href='#predict_history'><p>Computes predicted cumulative history using posterior predictive distribution.</p></a></li>
<li><a href='#predict_samples'><p>Computes prediction for a each sample.</p></a></li>
<li><a href='#predict.cumhist'><p>Computes predicted dominance phase durations using posterior predictive distribution.</p></a></li>
<li><a href='#preprocess_data'><p>Preprocesses time-series data for fitting</p></a></li>
<li><a href='#print.cumhist'><p>Prints out cumhist object</p></a></li>
<li><a href='#summary.cumhist'><p>Summary for a cumhist object</p></a></li>
<li><a href='#waic.cumhist'><p>Computes widely applicable information criterion</p>
(WAIC).</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Cumulative History Analysis for Bistable Perception Time Series</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates cumulative history for time-series for continuously
    viewed bistable perceptual rivalry displays. Computes cumulative history
    via a homogeneous first order differential process. I.e., it assumes
    exponential growth/decay of the history as a function time and perceptually
    dominant state, Pastukhov &amp; Braun (2011) &lt;<a href="https://doi.org/10.1167%2F11.10.12">doi:10.1167/11.10.12</a>&gt;.
    Supports Gamma, log normal, and normal distribution families.
    Provides a method to compute history directly and example of using the
    computation on a custom Stan code.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/alexander-pastukhov/bistablehistory/">https://github.com/alexander-pastukhov/bistablehistory/</a>,
<a href="https://alexander-pastukhov.github.io/bistablehistory/">https://alexander-pastukhov.github.io/bistablehistory/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/alexander-pastukhov/bistablehistory/issues/">https://github.com/alexander-pastukhov/bistablehistory/issues/</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.3.0), loo, rlang, rstantools (&ge; 2.1.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, Rcpp (&ge; 0.12.0), rstan (&ge; 2.26.0), dplyr, tibble,
glue, boot, future, purrr, tidyr</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH (&ge; 1.66.0), Rcpp (&ge; 0.12.0), RcppEigen (&ge; 0.3.3.3.0),
RcppParallel (&ge; 5.0.1), rstan (&ge; 2.26.0), StanHeaders (&ge;
2.26.0)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, ggplot2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-13 08:41:03 UTC; ba7dr4</td>
</tr>
<tr>
<td>Author:</td>
<td>Alexander Pastukhov
    <a href="https://orcid.org/0000-0002-8738-8591"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alexander Pastukhov &lt;pastukhov.alexander@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-13 13:20:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='bayes_R2'>Computes R-squared using Bayesian R-squared approach.</h2><span id='topic+bayes_R2'></span><span id='topic+bayes_R2.cumhist'></span>

<h3>Description</h3>

<p>For detail refer to:
Andrew Gelman, Ben Goodrich, Jonah Gabry, and Aki Vehtari (2018).
R-squared for Bayesian regression models. The American Statistician
<a href="https://doi.org/10.1080/00031305.2018.1549100">doi:10.1080/00031305.2018.1549100</a> and
<a href="https://avehtari.github.io/bayes_R2/bayes_R2.html">https://avehtari.github.io/bayes_R2/bayes_R2.html</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cumhist'
bayes_R2(object, summary = TRUE, probs = c(0.055, 0.945), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bayes_R2_+3A_object">object</code></td>
<td>
<p>An object of class <a href="#topic+cumhist-class">cumhist</a></p>
</td></tr>
<tr><td><code id="bayes_R2_+3A_summary">summary</code></td>
<td>
<p>Whether summary statistics should be returned instead of
raw sample values. Defaults to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="bayes_R2_+3A_probs">probs</code></td>
<td>
<p>The percentiles used to compute summary, defaults to 89% credible interval.</p>
</td></tr>
<tr><td><code id="bayes_R2_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of values or a data.frame with summary
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
br_fit &lt;- fit_cumhist(br_singleblock, state = "State", duration = "Duration")
bayes_R2(br_fit)

</code></pre>

<hr>
<h2 id='bistablehistory-package'>Cumulative History Analysis for Bistable Perception Time Series</h2><span id='topic+bistablehistory-package'></span><span id='topic+_PACKAGE'></span><span id='topic+bistablehistory'></span>

<h3>Description</h3>

<p>Estimates cumulative history for time-series for continuously
viewed bistable perceptual rivalry displays. Computes cumulative history
via a homogeneous first order differential process. I.e., it assumes
exponential growth/decay of the history as a function time and perceptually
dominant state, Pastukhov &amp; Braun (2011) <a href="https://doi.org/10.1167/11.10.12">doi:10.1167/11.10.12</a>.
Supports Gamma, log normal, and normal distribution families.
Provides a method to compute history directly and example of using the
computation on a custom Stan code.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Alexander Pastukhov <a href="mailto:pastukhov.alexander@gmail.com">pastukhov.alexander@gmail.com</a> (<a href="https://orcid.org/0000-0002-8738-8591">ORCID</a>)
</p>


<h3>References</h3>

<p>Stan Development Team (2020). RStan: the R interface to Stan. R package version 2.21.2. https://mc-stan.org
</p>


<h3>See Also</h3>

<p><code>vignette("cumulative-history", package = "bistablehistory")</code>
<code>vignette("usage-examples", package = "bistablehistory")</code>
<code>vignette("writing-stan-code", package = "bistablehistory")</code>
</p>

<hr>
<h2 id='br'>Binocular rivalry data</h2><span id='topic+br'></span>

<h3>Description</h3>

<p>Dataset on binocular rivalry for eight participants.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>br
</code></pre>


<h3>Format</h3>

<p>A data frame with 3769 rows and 6 variables:
</p>

<dl>
<dt>Observer</dt><dd><p>Participant ID.</p>
</dd>
<dt>Display</dt><dd><p>Display, all rows contain <code>"BR"</code></p>
</dd>
<dt>Block</dt><dd><p>Run / block index.</p>
</dd>
<dt>Time</dt><dd><p>Time relative to the run onset in <em>seconds</em></p>
</dd>
<dt>State</dt><dd><p>Factor with levels <code>"Left"</code>, <code>"Right"</code> (clear states), and <code>"Mixed"</code></p>
</dd></dl>
<p>.
</p>
<dl>
<dt>Duration</dt><dd><p>Duration of a dominance phase in <em>seconds</em>. Note that the duration for the last dominance phase is curtailed and, therefore, set to zero.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://doi.org/10.1167/11.10.12">doi:10.1167/11.10.12</a>
</p>

<hr>
<h2 id='br_contrast'>Binocular rivalry, variable contrast</h2><span id='topic+br_contrast'></span>

<h3>Description</h3>

<p>Dataset on binocular rivalry with variable but equal
contrast for six participants.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>br_contrast
</code></pre>


<h3>Format</h3>

<p>A data frame with 4616 rows and 6 variables:
</p>

<dl>
<dt>Observer</dt><dd><p>Participant ID.</p>
</dd>
<dt>Block</dt><dd><p>Run / block index.</p>
</dd>
<dt>Contrast</dt><dd><p>Contrast on scale from 0 to 1.</p>
</dd>
<dt>Time</dt><dd><p>Time relative to the run onset in <em>seconds</em></p>
</dd>
<dt>State</dt><dd><p>Factor with levels <code>"Left"</code>, <code>"Right"</code> (clear states), and <code>"Mixed"</code></p>
</dd></dl>
<p>.
</p>
<dl>
<dt>Duration</dt><dd><p>Duration of a dominance phase in <em>seconds</em>. Note that the duration for the last dominance phase is curtailed and, therefore, set to zero.</p>
</dd>
</dl>


<hr>
<h2 id='br_single_subject'>Single experimental session for binocular rivalry stimulus</h2><span id='topic+br_single_subject'></span>

<h3>Description</h3>

<p>A single subject / multiple runs dataset for binocular rivalry.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>br_single_subject
</code></pre>


<h3>Format</h3>

<p>A data frame with 76 rows and 6 variables:
</p>

<dl>
<dt>Observer</dt><dd><p>Participant ID, all rows contain <em>&quot;ap&quot;</em></p>
</dd>
<dt>Display</dt><dd><p>Display, all rows contain <em>&quot;BR&quot;</em></p>
</dd>
<dt>Block</dt><dd><p>Run / block index</p>
</dd>
<dt>Time</dt><dd><p>Time relative to the run onset in <em>seconds</em></p>
</dd>
<dt>State</dt><dd><p>Index of a perceptually dominant state, <em>1</em>, <em>2</em> - clear perceptual state, <em>3</em> mixed / transition phase</p>
</dd>
<dt>Duration</dt><dd><p>Duration of a dominance phase in <em>seconds</em>. Note that the duration for the last dominance phase is curtailed and, therefore, set to zero.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://doi.org/10.1167/11.10.12">doi:10.1167/11.10.12</a>
</p>

<hr>
<h2 id='br_singleblock'>Single run for binocular rivalry stimulus</h2><span id='topic+br_singleblock'></span>

<h3>Description</h3>

<p>A single subject / single run dataset for binocular rivalry.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>br_singleblock
</code></pre>


<h3>Format</h3>

<p>A data frame with 76 rows and 6 variables:
</p>

<dl>
<dt>Observer</dt><dd><p>Participant ID, all rows contain <em>&quot;ap&quot;</em></p>
</dd>
<dt>Group</dt><dd><p>Display, all rows contain <em>&quot;BR&quot;</em></p>
</dd>
<dt>Block</dt><dd><p>Run / block index, all rows contain <em>1</em></p>
</dd>
<dt>Time</dt><dd><p>Time relative to the run onset in <em>seconds</em></p>
</dd>
<dt>State</dt><dd><p>Index of a perceptually dominant state, <em>1</em>, <em>2</em> - clear perceptual state, <em>3</em> mixed / transition phase</p>
</dd>
<dt>Duration</dt><dd><p>Duration of a dominance phase in <em>seconds</em>. Note that the duration for the last dominance phase is curtailed and, therefore, set to zero.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://doi.org/10.1167/11.10.12">doi:10.1167/11.10.12</a>
</p>

<hr>
<h2 id='check_fixed_history_parameter'>Evaluates values for a fixed history parameter</h2><span id='topic+check_fixed_history_parameter'></span>

<h3>Description</h3>

<p>Expects either a single value within a valid range or
<code>randomN</code> values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_fixed_history_parameter(param_name, param_value, randomN, upperLimit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_fixed_history_parameter_+3A_param_name">param_name</code></td>
<td>
<p>Name of the parameter.</p>
</td></tr>
<tr><td><code id="check_fixed_history_parameter_+3A_param_value">param_value</code></td>
<td>
<p>A single value or <code>randomN</code> numeric values.</p>
</td></tr>
<tr><td><code id="check_fixed_history_parameter_+3A_randomn">randomN</code></td>
<td>
<p>Number of levels for the random variable.</p>
</td></tr>
<tr><td><code id="check_fixed_history_parameter_+3A_upperlimit">upperLimit</code></td>
<td>
<p>Upper limit for a valid <code>param_value</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector <code>randomN</code> long.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>check_fixed_history_parameter("tau", 1, 10, Inf)
</code></pre>

<hr>
<h2 id='check_normal_prior'>Checks for validity of values for use as normal distribution parameters.</h2><span id='topic+check_normal_prior'></span>

<h3>Description</h3>

<p>Should a pair of numeric values, second value should be non-zero.
Stops execution with an error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_normal_prior(values, parameter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_normal_prior_+3A_values">values</code></td>
<td>
<p>Parameters for normal distribution.</p>
</td></tr>
<tr><td><code id="check_normal_prior_+3A_parameter">parameter</code></td>
<td>
<p>Name of the parameter for which the prior is defined.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical TRUE, if none of the tests fail
</p>


<h3>Examples</h3>

<pre><code class='language-R'>check_normal_prior(c(0, 1), "tau")
</code></pre>

<hr>
<h2 id='coef.cumhist'>Extract Model Coefficients</h2><span id='topic+coef.cumhist'></span>

<h3>Description</h3>

<p>Extracts models population-level coefficients history-specific terms and
fixed-effect terms for every modeled distribution parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cumhist'
coef(object, summary = TRUE, probs = c(0.055, 0.945), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.cumhist_+3A_object">object</code></td>
<td>
<p>An object of class <a href="#topic+cumhist-class">cumhist</a></p>
</td></tr>
<tr><td><code id="coef.cumhist_+3A_summary">summary</code></td>
<td>
<p>Whether summary statistics should be returned instead of
raw sample values. Defaults to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="coef.cumhist_+3A_probs">probs</code></td>
<td>
<p>The percentiles used to compute summary, defaults to 89% credible interval.</p>
</td></tr>
<tr><td><code id="coef.cumhist_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with values or summary
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
br_fit &lt;- fit_cumhist(br_singleblock,
                      state = "State",
                      duration = "Duration",
                      fixed_effects = "Time")
coef(br_fit)

</code></pre>

<hr>
<h2 id='compute_history'>Computes cumulative history for the time-series</h2><span id='topic+compute_history'></span>

<h3>Description</h3>

<p>Computes cumulative history for each state in the time-series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_history(
  data,
  state,
  duration = NULL,
  onset = NULL,
  random_effect = NULL,
  session = NULL,
  run = NULL,
  tau = 1,
  mixed_state = 0.5,
  history_init = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_history_+3A_data">data</code></td>
<td>
<p>A table with time-series.</p>
</td></tr>
<tr><td><code id="compute_history_+3A_state">state</code></td>
<td>
<p>String, the name of the column that specifies
perceptual state. The column type should be a factor with
two or three levels (the third level is assumed to correspond to a
transition/mixed phase) or should be convertible to a two level
factor (as it would be impossible to infer the identity of transition/
mixed phase).</p>
</td></tr>
<tr><td><code id="compute_history_+3A_duration">duration</code></td>
<td>
<p>String, name of the column with duration of individual
perceptual dominance phases. Optional, you can specify <code>onset</code>
instead.</p>
</td></tr>
<tr><td><code id="compute_history_+3A_onset">onset</code></td>
<td>
<p>String, name of the column with onsets of the perceptual
dominance states. Optional, used to compute duration of the dominance
phases, if these are not provided explicitly via <code>duration</code>
parameter.</p>
</td></tr>
<tr><td><code id="compute_history_+3A_random_effect">random_effect</code></td>
<td>
<p>String, name of the column that identifies random effect,
e.g. individual participants, stimuli for a single participant, etc.
If omitted, no random effect is assumed. If specified and
there is more than one level (participant, stimulus, etc.), it is used
in a hierarchical model.</p>
</td></tr>
<tr><td><code id="compute_history_+3A_session">session</code></td>
<td>
<p>String, name of the column that identifies unique
experimental session for which a mean dominance phase duration will
be computed (see <code>norm_tau</code> parameter). Code assumes that session
IDs are different within a participant but can be the same between them.
If omitted, a single mean dominance duration based on the entire time series
is used.</p>
</td></tr>
<tr><td><code id="compute_history_+3A_run">run</code></td>
<td>
<p>String, name of the column that identifies unique runs/blocks.
If omitted, the data is assumed to belong to a single time series. Code
assumes that run IDs are different within an experimental session but
can be the same between the session. E.g. session A, runs 1, 2, 3.. and
session B, runs 1, 2, 3 but not session A, runs 1, 2, 1.</p>
</td></tr>
<tr><td><code id="compute_history_+3A_tau">tau</code></td>
<td>
<p>Time constant of exponential growth/decay
normalized to the mean duration of clear percepts within each <code>session</code>.
Can be 1) a single positive number (&gt;0) that is used for all participants and runs,
2) <code>NULL</code> (default) -  a <em>single</em> value will be fitted for all participants and runs,
3) <code>"random"</code> - an independent tau is fitted for each random cluster,
4) <code>"1|random"</code>- a tau for a random cluster
is sampled from a population distribution, i.e., pooled parameter values via
a multilevel model.</p>
</td></tr>
<tr><td><code id="compute_history_+3A_mixed_state">mixed_state</code></td>
<td>
<p>Specifies an activation level during
transition/mixed phases (state #3, see <code>state</code>). Either a single
number (range 0..1) that will be used as a fixed level or a vector
of two numbers <code>c(mu, kappa)</code> that specifies, correspondingly, mean
(range 0..1) and precision (&gt;0) of beta proportion distribution, it
should be sampled from. Defaults to a fixed value of <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="compute_history_+3A_history_init">history_init</code></td>
<td>
<p>Initial value for cumulative history computation. Either
a numeric scalar in 0..1 range or a vector of two numbers in 0..1 range.
In the latter case, two histories will start at different levels.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix <code>nrow(data)</code> × 2 with computed history values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- compute_history(br_singleblock, state = "State",
                      duration = "Duration", tau = 1,
                      mixed_state = 0.5, history_init = 0)
</code></pre>

<hr>
<h2 id='cumhist-class'>Class <code>cumhist</code>.</h2><span id='topic+cumhist-class'></span><span id='topic+cumhist'></span>

<h3>Description</h3>

<p>Cumulative history model fitted to time-series data.
</p>


<h3>Details</h3>

<p>See <code>methods(class = "cumhist")</code> for an overview of available methods.
</p>


<h3>Slots</h3>


<dl>
<dt><code>family</code></dt><dd><p>A <code>string</code> with distribution family.</p>
</dd>
<dt><code>data</code></dt><dd><p>A <code>list</code> with preprocessed data.</p>
</dd>
<dt><code>stanfit</code></dt><dd><p>a <code><a href="rstan.html#topic+stanfit-class">stanfit</a></code> object.</p>
</dd>
</dl>


<h3>See Also</h3>

<p><code><a href="#topic+fit_cumhist">fit_cumhist</a></code>
</p>

<hr>
<h2 id='evaluate_history_init'>Evaluates validity of initial history values.</h2><span id='topic+evaluate_history_init'></span>

<h3>Description</h3>

<p>Checks number and range of values. If a scalar is passed, uses same value
for both states.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate_history_init(history_init)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evaluate_history_init_+3A_history_init">history_init</code></td>
<td>
<p>Either a single value or a pair of values within 0..1 range.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of two values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>evaluate_history_init(0.5)
</code></pre>

<hr>
<h2 id='evaluate_history_option'>Evaluates whether and how to fit a cumulative history parameter.</h2><span id='topic+evaluate_history_option'></span>

<h3>Description</h3>

<p>Evaluation is based on the <code>param_value</code>.
</p>

<ol>
<li><p> A single positive number (&gt;0) that is used for all participants and runs.
</p>
</li>
<li> <p><code>NULL</code> (default) -  a <em>single</em> value will be fitted for all participants
and runs, also applied if <code>randomN == 1</code>.
</p>
</li>
<li> <p><code>"random"</code> - an independent value is fitted for each random cluster.
</p>
</li>
<li> <p><code>"1|random"</code>- a value for a random cluster is sampled from a population
distribution, i.e., pooled parameter values via a multilevel model.
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>evaluate_history_option(param_name, param_value, randomN, upperLimit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evaluate_history_option_+3A_param_name">param_name</code></td>
<td>
<p>Name of the parameter.</p>
</td></tr>
<tr><td><code id="evaluate_history_option_+3A_param_value">param_value</code></td>
<td>
<p>Value from the <code><a href="#topic+fit_cumhist">fit_cumhist</a></code> function call.</p>
</td></tr>
<tr><td><code id="evaluate_history_option_+3A_randomn">randomN</code></td>
<td>
<p>Number of levels for the random variable.</p>
</td></tr>
<tr><td><code id="evaluate_history_option_+3A_upperlimit">upperLimit</code></td>
<td>
<p>Upper limit for a valid <code>param_value</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with <code>&lt;param_name&gt;_option</code> and <code>fixed_&lt;param_name&gt;</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>evaluate_history_option("tau", 1, 1, Inf)
</code></pre>

<hr>
<h2 id='extract_history'>Computes history for a fitted model</h2><span id='topic+extract_history'></span>

<h3>Description</h3>

<p>Computes history for a fitted model, uses only mean values
for each history parameter. Uses values for each random cluster,
if <code>"random"</code> or <code>"1|random"</code> parametrisation was used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_history(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_history_+3A_object">object</code></td>
<td>
<p>An object of class <a href="#topic+cumhist-class">cumhist</a></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of cumulative history values for each state
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
br_fit &lt;- fit_cumhist(br_singleblock, state = "State", duration = "Duration")
extract_history(br_fit)

</code></pre>

<hr>
<h2 id='extract_history_parameter'>Extracts a history parameter as a matrix</h2><span id='topic+extract_history_parameter'></span>

<h3>Description</h3>

<p>Extracts a history parameter as a matrix with
<code>samplesN</code> rows and randomN (found in <code>object$data$randomN</code>)
columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_history_parameter(
  object,
  param_name,
  samplesN = NULL,
  link_function = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_history_parameter_+3A_object">object</code></td>
<td>
<p>A <a href="#topic+cumhist-class">cumhist</a> object</p>
</td></tr>
<tr><td><code id="extract_history_parameter_+3A_param_name">param_name</code></td>
<td>
<p>String, a name of the parameter</p>
</td></tr>
<tr><td><code id="extract_history_parameter_+3A_samplesn">samplesN</code></td>
<td>
<p>Number of samples, if NULL is computed from rstan (but it is cheaper to do this once).</p>
</td></tr>
<tr><td><code id="extract_history_parameter_+3A_link_function">link_function</code></td>
<td>
<p>A link function to use (exp or inv.logit) or <code>NULL</code> for identity.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix with <code>samplesN</code> rows and randomN
(found in <code>object$data$randomN</code>) columns
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
br_fit &lt;- fit_cumhist(br_singleblock, state="State", duration="Duration")
extract_history_parameter(br_fit, "tau", link_function = exp)

</code></pre>

<hr>
<h2 id='extract_replicate_term_to_matrix'>Extract a term and replicates it randomN times for each linear model</h2><span id='topic+extract_replicate_term_to_matrix'></span>

<h3>Description</h3>

<p>Extract a term and replicates it randomN times for each linear model.
Used for population mean or variance terms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_replicate_term_to_matrix(object, term)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_replicate_term_to_matrix_+3A_object">object</code></td>
<td>
<p>An object of class <a href="#topic+cumhist-class">cumhist</a></p>
</td></tr>
<tr><td><code id="extract_replicate_term_to_matrix_+3A_term">term</code></td>
<td>
<p>String, term name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
br_fit &lt;- fit_cumhist(br_singleblock, state = "State", duration = "Duration")
bH_mu &lt;- extract_replicate_term_to_matrix(br_fit, "bH_mu")

</code></pre>

<hr>
<h2 id='extract_term_to_matrix'>Extracts a term with one column per fixed or random-level into a matrix</h2><span id='topic+extract_term_to_matrix'></span>

<h3>Description</h3>

<p>Extracts a 3D array for a term with  sample, linear-model,
random/fixed-effect order and returns a matrix with samples as rows
and columns in order 1) all random/fixed effects for lm1, 2) all
random/fixed effects for lm2, etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_term_to_matrix(object, term)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_term_to_matrix_+3A_object">object</code></td>
<td>
<p>An object of class <a href="#topic+cumhist-class">cumhist</a></p>
</td></tr>
<tr><td><code id="extract_term_to_matrix_+3A_term">term</code></td>
<td>
<p>String, term name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
br_fit &lt;- fit_cumhist(br_singleblock, state = "State", duration = "Duration")
a &lt;- extract_term_to_matrix(br_fit, "a")

</code></pre>

<hr>
<h2 id='fast_history_compute'>Computes cumulative history</h2><span id='topic+fast_history_compute'></span>

<h3>Description</h3>

<p>Computes cumulative history based on common <code>history</code> values and
<code>normalized_tau</code> and <code>mixed_state</code> that are defined for each
random cluster / individual.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fast_history_compute(df, normalized_tau, mixed_state, history_init)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fast_history_compute_+3A_df">df</code></td>
<td>
<p>DataFrame with <code>"state"</code> (integer, 1 and 2 clear state, 3 - mixed state), <code>"duration"</code> (double),
<code>"irandom"</code> (integer, 1-based index of a random cluster), <code>"run_start"</code> (integer, 1 for the first entry of
the run, 0 otherwise), <code>"session_tmean"</code> (double)</p>
</td></tr>
<tr><td><code id="fast_history_compute_+3A_normalized_tau">normalized_tau</code></td>
<td>
<p>DoubleVector A normalized tau value for each random cluster / individual. Thus, its length must be
equal to the number of unique indexes in <code>df["irandom"]</code>.</p>
</td></tr>
<tr><td><code id="fast_history_compute_+3A_mixed_state">mixed_state</code></td>
<td>
<p>DoubleVector A values used for the mixed state for each random cluster / individual.
Thus, its length must be equal to the number of unique indexes in <code>df["irandom"]</code>.</p>
</td></tr>
<tr><td><code id="fast_history_compute_+3A_history_init">history_init</code></td>
<td>
<p>DoubleVector, size 2. Initial values of history for a run.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NumericMatrix, size <code>df.nrows()</code> × 2. Computed history values for each state.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- preprocess_data(br_singleblock, state="State", duration="Duration")
fast_history_compute(df, 1, 0.5, c(0, 0))
</code></pre>

<hr>
<h2 id='fit_cumhist'>Fits cumulative history for bistable perceptual rivalry displays.</h2><span id='topic+fit_cumhist'></span>

<h3>Description</h3>

<p>Fits a generalized linear model using cumulative history and
specified fixed effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_cumhist(
  data,
  state,
  duration = NULL,
  onset = NULL,
  random_effect = NULL,
  session = NULL,
  run = NULL,
  fixed_effects = NULL,
  tau = NULL,
  mixed_state = 0.5,
  history_init = 0,
  family = "gamma",
  history_priors = NULL,
  intercept_priors = NULL,
  history_effect_prior = NULL,
  fixed_effects_priors = NULL,
  chains = 1,
  cores = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_cumhist_+3A_data">data</code></td>
<td>
<p>A table with time-series.</p>
</td></tr>
<tr><td><code id="fit_cumhist_+3A_state">state</code></td>
<td>
<p>String, the name of the column that specifies
perceptual state. The column type should be a factor with
two or three levels (the third level is assumed to correspond to a
transition/mixed phase) or should be convertible to a two level
factor (as it would be impossible to infer the identity of transition/
mixed phase).</p>
</td></tr>
<tr><td><code id="fit_cumhist_+3A_duration">duration</code></td>
<td>
<p>String, name of the column with duration of individual
perceptual dominance phases. Optional, you can specify <code>onset</code>
instead.</p>
</td></tr>
<tr><td><code id="fit_cumhist_+3A_onset">onset</code></td>
<td>
<p>String, name of the column with onsets of the perceptual
dominance states. Optional, used to compute duration of the dominance
phases, if these are not provided explicitly via <code>duration</code>
parameter.</p>
</td></tr>
<tr><td><code id="fit_cumhist_+3A_random_effect">random_effect</code></td>
<td>
<p>String, name of the column that identifies random
effect, e.g. individual participants, stimuli for a single participant,
etc. If omitted, no random effect is assumed. If specified and
there is more than one level (participant, stimulus, etc.), it is used
in a hierarchical model.</p>
</td></tr>
<tr><td><code id="fit_cumhist_+3A_session">session</code></td>
<td>
<p>String, name of the column that identifies unique
experimental session for which a mean dominance phase duration will
be computed (see <code>norm_tau</code> parameter). Code assumes that session
IDs are different within a participant but can be the same between them.
If omitted, a single mean dominance duration based on the entire time series
is used.</p>
</td></tr>
<tr><td><code id="fit_cumhist_+3A_run">run</code></td>
<td>
<p>String, name of the column that identifies unique runs/blocks.
If omitted, the data is assumed to belong to a single time series. Code
assumes that run IDs are different within an experimental session but
can be the same between the session. E.g. session A, runs 1, 2, 3.. and
session B, runs 1, 2, 3 but not session A, runs 1, 2, 1.</p>
</td></tr>
<tr><td><code id="fit_cumhist_+3A_fixed_effects">fixed_effects</code></td>
<td>
<p>String or vector of strings. Name of column(s)
with values to be used for fitting an additional fixed effect(s). E.g.,
contrast in binocular rivalry, rotation speed for kinetic-depth effect,
etc.</p>
</td></tr>
<tr><td><code id="fit_cumhist_+3A_tau">tau</code></td>
<td>
<p>Time constant of exponential growth/decay
normalized to the mean duration of clear percepts within each <code>session</code>.
Can be 1) a single positive number (&gt;0) that is used for all participants and runs,
2) <code>NULL</code> (default) -  a <em>single</em> value will be fitted for all participants and runs,
3) <code>"random"</code> - an independent tau is fitted for each random cluster,
4) <code>"1|random"</code>- a tau for a random cluster
is sampled from a population distribution, i.e., pooled parameter values via
a multilevel model.</p>
</td></tr>
<tr><td><code id="fit_cumhist_+3A_mixed_state">mixed_state</code></td>
<td>
<p>Specifies an activation level during
transition/mixed phases (state #3, see <code>state</code>). Either a single
number (range 0..1) that will be used as a fixed level or a vector
of two numbers <code>c(mu, kappa)</code> that specifies, correspondingly, mean
(range 0..1) and precision (&gt;0) of beta proportion distribution, it
should be sampled from. Defaults to a fixed value of <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="fit_cumhist_+3A_history_init">history_init</code></td>
<td>
<p>Initial value for cumulative history computation. Either
a numeric scalar in 0..1 range or a vector of two numbers in 0..1 range.
In the latter case, two histories will start at different levels.</p>
</td></tr>
<tr><td><code id="fit_cumhist_+3A_family">family</code></td>
<td>
<p>String, distribution used to fit duration of perceptual dominance
phases. Options include <code>"gamma"</code> (default), <code>"lognormal"</code>, and <code>"normal"</code>.</p>
</td></tr>
<tr><td><code id="fit_cumhist_+3A_history_priors">history_priors</code></td>
<td>
<p>Named list of optional priors for population-level cumulative history
parameters. Must follow the format <code>list("tau"=c(1, 0.15))</code> with values coding mean
and standard deviation of the normal distribution.</p>
</td></tr>
<tr><td><code id="fit_cumhist_+3A_intercept_priors">intercept_priors</code></td>
<td>
<p>A vector of optional priors for population-level intercept
parameter. Should be <code>c(&lt;shape-mean&gt;, &lt;shape-sd&gt;, &lt;scale-mean&gt;, &lt;scale-sd&gt;)</code>
format for Gamma family, <code>c(&lt;mean&gt;, &lt;sd&gt;)</code> for normal and lognormal families.
The values code mean and standard deviation of the normal distribution.</p>
</td></tr>
<tr><td><code id="fit_cumhist_+3A_history_effect_prior">history_effect_prior</code></td>
<td>
<p>A vector of options priors for population-level slope
of history effect. The values code mean and standard deviation of the normal distribution.
Defaults to mu=0, sigma=1.</p>
</td></tr>
<tr><td><code id="fit_cumhist_+3A_fixed_effects_priors">fixed_effects_priors</code></td>
<td>
<p>A named list of optional priors for fixed effects. Must
follow the format <code>list("&lt;name-of-variable&gt;"=c(&lt;mu&gt;, &lt;sigma&gt;))</code>, where <code>&lt;mu&gt;</code> and
<code>&lt;sigma&gt;</code> are mean and standard deviation of a normal distribution. Defaults to mu=0,
sigma=1.</p>
</td></tr>
<tr><td><code id="fit_cumhist_+3A_chains">chains</code></td>
<td>
<p>Number of chains for sampling.</p>
</td></tr>
<tr><td><code id="fit_cumhist_+3A_cores">cores</code></td>
<td>
<p>Number of CPU cores to use for sampling. If omitted, All cores are used.</p>
</td></tr>
<tr><td><code id="fit_cumhist_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <a href="rstan.html#topic+stanmodel-method-sampling">rstan::sampling()</a> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <a href="#topic+cumhist-class">cumhist</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(br_singleblock)
gamma_fit &lt;- fit_cumhist(br_singleblock, state = "State", duration = "Duration")

</code></pre>

<hr>
<h2 id='fixef'>Extract the fixed-effects estimates</h2><span id='topic+fixef'></span>

<h3>Description</h3>

<p>Extracts models fixed-effect terms for every modeled distribution parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fixef(object, summary = TRUE, probs = c(0.055, 0.945))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fixef_+3A_object">object</code></td>
<td>
<p>An object of class <a href="#topic+cumhist-class">cumhist</a></p>
</td></tr>
<tr><td><code id="fixef_+3A_summary">summary</code></td>
<td>
<p>Whether summary statistics should be returned instead of
raw sample values. Defaults to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="fixef_+3A_probs">probs</code></td>
<td>
<p>The percentiles used to compute summary, defaults to 89% credible interval.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>tibble</code> with values or summary, <code>NULL</code> if not fixed effects were used.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
br_fit &lt;- fit_cumhist(br_singleblock,
                      state = "State",
                      duration = "Duration",
                      fixed_effects = "Time")
fixef(br_fit)

</code></pre>

<hr>
<h2 id='history_mixed_state'>Extract values of used or fitted history parameter mixed_state</h2><span id='topic+history_mixed_state'></span>

<h3>Description</h3>

<p>A short-cut for <code>history_parameter(object, "mixed_state", ...)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>history_mixed_state(
  object,
  summary = TRUE,
  probs = c(0.055, 0.945),
  includePopulationLevel = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="history_mixed_state_+3A_object">object</code></td>
<td>
<p>An object of class <a href="#topic+cumhist-class">cumhist</a></p>
</td></tr>
<tr><td><code id="history_mixed_state_+3A_summary">summary</code></td>
<td>
<p>Whether summary statistics should be returned instead of
raw sample values. Defaults to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="history_mixed_state_+3A_probs">probs</code></td>
<td>
<p>The percentiles used to compute summary, defaults to 89% credible interval.</p>
</td></tr>
<tr><td><code id="history_mixed_state_+3A_includepopulationlevel">includePopulationLevel</code></td>
<td>
<p>Logical, for pooled random effect only. Whether to include
population mean as a separate <code>"_population"</code> level, default to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single value, if fixed value was used. A vector or a tibble, depending on the
option used (single intercept, independent or random intercepts), and whether summary was
requested.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
br_fit &lt;- fit_cumhist(br_singleblock, state="State", duration="Duration")
history_tau(br_fit)

</code></pre>

<hr>
<h2 id='history_parameter'>Extract values of used or fitted history parameter</h2><span id='topic+history_parameter'></span>

<h3>Description</h3>

<p>Extract values of used or fitted history parameter
</p>


<h3>Usage</h3>

<pre><code class='language-R'>history_parameter(
  object,
  param,
  summary = TRUE,
  probs = c(0.055, 0.945),
  includePopulationLevel = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="history_parameter_+3A_object">object</code></td>
<td>
<p>An object of class <a href="#topic+cumhist-class">cumhist</a></p>
</td></tr>
<tr><td><code id="history_parameter_+3A_param">param</code></td>
<td>
<p>Parameter name: <code>"tau"</code> or <code>"mixed_state"</code></p>
</td></tr>
<tr><td><code id="history_parameter_+3A_summary">summary</code></td>
<td>
<p>Whether summary statistics should be returned instead of
raw sample values. Defaults to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="history_parameter_+3A_probs">probs</code></td>
<td>
<p>The percentiles used to compute summary, defaults to 89% credible interval.</p>
</td></tr>
<tr><td><code id="history_parameter_+3A_includepopulationlevel">includePopulationLevel</code></td>
<td>
<p>Logical, for pooled random effect only. Whether to include
population mean as a separate <code>"_population"</code> level, default to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector, if summary was not requested. Or a tibble with a summary or if a fixed value was used.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
br_fit &lt;- fit_cumhist(br_singleblock, state="State", duration="Duration")
history_parameter(br_fit, "tau")

</code></pre>

<hr>
<h2 id='history_tau'>Extract values of used or fitted history parameter tau</h2><span id='topic+history_tau'></span>

<h3>Description</h3>

<p>A short-cut for <code>history_parameter(object, "tau", ...)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>history_tau(
  object,
  summary = TRUE,
  probs = c(0.055, 0.945),
  includePopulationLevel = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="history_tau_+3A_object">object</code></td>
<td>
<p>An object of class <a href="#topic+cumhist-class">cumhist</a></p>
</td></tr>
<tr><td><code id="history_tau_+3A_summary">summary</code></td>
<td>
<p>Whether summary statistics should be returned instead of
raw sample values. Defaults to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="history_tau_+3A_probs">probs</code></td>
<td>
<p>The percentiles used to compute summary, defaults to 89% credible interval.</p>
</td></tr>
<tr><td><code id="history_tau_+3A_includepopulationlevel">includePopulationLevel</code></td>
<td>
<p>Logical, for pooled random effect only. Whether to include
population mean as a separate <code>"_population"</code> level, default to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single value, if fixed value was used. A vector or a tibble, depending on the
option used (single intercept, independent or random intercepts), and whether summary was
requested.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
br_fit &lt;- fit_cumhist(br_singleblock, state="State", duration="Duration")
history_tau(br_fit)

</code></pre>

<hr>
<h2 id='historyef'>Extract the history-effects estimates</h2><span id='topic+historyef'></span>

<h3>Description</h3>

<p>Extracts models population-level coefficients history-specific terms
for every modeled distribution parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>historyef(object, summary = TRUE, probs = c(0.055, 0.945))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="historyef_+3A_object">object</code></td>
<td>
<p>An object of class <a href="#topic+cumhist-class">cumhist</a></p>
</td></tr>
<tr><td><code id="historyef_+3A_summary">summary</code></td>
<td>
<p>Whether summary statistics should be returned instead of
raw sample values. Defaults to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="historyef_+3A_probs">probs</code></td>
<td>
<p>The percentiles used to compute summary, defaults to 89% credible interval.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with values or summary
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
br_fit &lt;- fit_cumhist(br_singleblock, state="State", duration="Duration")
historyef(br_fit)

</code></pre>

<hr>
<h2 id='kde'>Kinetic-depth effect data</h2><span id='topic+kde'></span>

<h3>Description</h3>

<p>Dataset on kinetic-depth effect for eleven participants.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kde
</code></pre>


<h3>Format</h3>

<p>A data frame with 38698 rows and 6 variables:
</p>

<dl>
<dt>Observer</dt><dd><p>Participant ID.</p>
</dd>
<dt>Display</dt><dd><p>Display, all rows contain <code>"KD"</code></p>
</dd>
<dt>Block</dt><dd><p>Run / block index.</p>
</dd>
<dt>Time</dt><dd><p>Time relative to the run onset in <em>seconds</em></p>
</dd>
<dt>State</dt><dd><p>Factor with levels <code>"Left"</code>, <code>"Right"</code> (clear states), and <code>"Mixed"</code></p>
</dd></dl>
<p>.
</p>
<dl>
<dt>Duration</dt><dd><p>Duration of a dominance phase in <em>seconds</em>. Note that the duration for the last dominance phase is curtailed and, therefore, set to zero.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://doi.org/10.1167/11.10.12">doi:10.1167/11.10.12</a>
</p>

<hr>
<h2 id='kde_two_observers'>Multirun data for two participants, kinetic-depth effect display</h2><span id='topic+kde_two_observers'></span>

<h3>Description</h3>

<p>Multirun data for two participants, kinetic-depth effect display
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kde_two_observers
</code></pre>


<h3>Format</h3>

<p>A data frame with 1186 rows and 5 variables:
</p>

<dl>
<dt>Observer</dt><dd><p>Participant ID</p>
</dd>
<dt>Block</dt><dd><p>Run / block index</p>
</dd>
<dt>State</dt><dd><p>Factor variable for state with levels <code>-1</code> and <code>1</code> coding two clear perceptual states and <code>-2</code> the mixed / transition phase</p>
</dd>
<dt>Time</dt><dd><p>Time relative to the run onset in <em>seconds</em></p>
</dd>
<dt>Duration</dt><dd><p>Duration of a dominance phase in <em>seconds</em>. Note that the duration for the last dominance phase is curtailed and, therefore, set to zero.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://doi.org/10.1167/11.10.12">doi:10.1167/11.10.12</a>
</p>

<hr>
<h2 id='loo.cumhist'>Computes an efficient approximate leave-one-out
cross-validation via loo library. It can be used
for a model comparison via loo::loo_compare() function.</h2><span id='topic+loo.cumhist'></span>

<h3>Description</h3>

<p>Computes an efficient approximate leave-one-out
cross-validation via loo library. It can be used
for a model comparison via loo::loo_compare() function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cumhist'
loo(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loo.cumhist_+3A_x">x</code></td>
<td>
<p>A <a href="#topic+cumhist-class">cumhist</a> object</p>
</td></tr>
<tr><td><code id="loo.cumhist_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list, see <code><a href="loo.html#topic+loo">loo::loo()</a></code> for details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(br_singleblock)

gamma_fit &lt;- fit_cumhist(br_singleblock, state="State", duration="Duration")
loo_gamma &lt;- loo(gamma_fit)

</code></pre>

<hr>
<h2 id='nc'>Necker cube data</h2><span id='topic+nc'></span>

<h3>Description</h3>

<p>Dataset on Necker cube for five participants.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nc
</code></pre>


<h3>Format</h3>

<p>A data frame with 3464 rows and 6 variables:
</p>

<dl>
<dt>Observer</dt><dd><p>Participant ID.</p>
</dd>
<dt>Display</dt><dd><p>Display, all rows contain <code>"NC"</code></p>
</dd>
<dt>Block</dt><dd><p>Run / block index.</p>
</dd>
<dt>Time</dt><dd><p>Time relative to the run onset in <em>seconds</em></p>
</dd>
<dt>State</dt><dd><p>Factor with levels <code>"Left"</code>, <code>"Right"</code> (clear states), and <code>"Mixed"</code></p>
</dd></dl>
<p>.
</p>
<dl>
<dt>Duration</dt><dd><p>Duration of a dominance phase in <em>seconds</em>. Note that the duration for the last dominance phase is curtailed and, therefore, set to zero.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://doi.org/10.1167/11.10.12">doi:10.1167/11.10.12</a>
</p>

<hr>
<h2 id='predict_history'>Computes predicted cumulative history using posterior predictive distribution.</h2><span id='topic+predict_history'></span>

<h3>Description</h3>

<p>Computes predicted cumulative history using fitted model. This is just a wrapper
for <code>predict(object, summary, probs, full_length, predict_history=history_type)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_history(
  object,
  history_type,
  summary = TRUE,
  probs = NULL,
  full_length = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_history_+3A_object">object</code></td>
<td>
<p>An object of class <a href="#topic+cumhist-class">cumhist</a></p>
</td></tr>
<tr><td><code id="predict_history_+3A_history_type">history_type</code></td>
<td>
<p><code>"1"</code> or <code>"2"</code> for cumulative history for the first or second perceptual
states (with indexes 1 and 2, respectively),
<code>"dominant"</code> or <code>"suppressed"</code> for cumulative history for states that either dominant
or suppressed during the following phase, <code>"difference"</code> for difference between suppressed
and dominant. See cumulative history vignette for details.</p>
</td></tr>
<tr><td><code id="predict_history_+3A_summary">summary</code></td>
<td>
<p>Whether summary statistics should be returned instead of
raw sample values. Defaults to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="predict_history_+3A_probs">probs</code></td>
<td>
<p>The percentiles used to compute summary, defaults to NULL (no CI).</p>
</td></tr>
<tr><td><code id="predict_history_+3A_full_length">full_length</code></td>
<td>
<p>Only for <code>summary = TRUE</code>, whether the summary table should
include rows with no predictions. I.e., rows with mixed phases, first/last dominance
phase in the run, etc. See <code><a href="#topic+preprocess_data">preprocess_data()</a></code>. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="predict_history_+3A_...">...</code></td>
<td>
<p>Unused</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>summary=FALSE</code>, a numeric matrix iterationsN x clearN.
If <code>summary=TRUE</code> but <code>probs=NULL</code> a vector of requested cumulative history values.
If <code>summary=TRUE</code> and <code>probs</code> is not <code>NULL</code>, a data.frame
with a column <em>&quot;Predicted&quot;</em> (mean) and a column for each specified quantile.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit_cumhist">fit_cumhist</a></code>, <code><a href="#topic+predict.cumhist">predict.cumhist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
br_fit &lt;- fit_cumhist(br_singleblock, state = "State", duration = "Duration")
history_difference_summary &lt;- predict_history(br_fit, "difference")

# full posterior prediction samples
history_difference &lt;- predict_history(br_fit,
                                      "difference",
                                      summary = FALSE,
                                      full_length = TRUE)

</code></pre>

<hr>
<h2 id='predict_samples'>Computes prediction for a each sample.</h2><span id='topic+predict_samples'></span>

<h3>Description</h3>

<p>Computing prediction for each sample,
recomputing cumulative history and uses
fitted parameter values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_samples(
  family,
  fixedN,
  randomN,
  lmN,
  istate,
  duration,
  is_used,
  run_start,
  session_tmean,
  irandom,
  fixed,
  tau_ind,
  mixed_state_ind,
  history_init,
  a,
  bH,
  bF,
  sigma
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_samples_+3A_family">family</code></td>
<td>
<p>int, distribution family: gamma (1), lognormal(2), or
normal (3).</p>
</td></tr>
<tr><td><code id="predict_samples_+3A_fixedn">fixedN</code></td>
<td>
<p>int, number of fixed parameters (&gt;= 0).</p>
</td></tr>
<tr><td><code id="predict_samples_+3A_randomn">randomN</code></td>
<td>
<p>int, number of random factors (&gt;= 1).</p>
</td></tr>
<tr><td><code id="predict_samples_+3A_lmn">lmN</code></td>
<td>
<p>int, number of linear models (&gt;= 1).</p>
</td></tr>
<tr><td><code id="predict_samples_+3A_istate">istate</code></td>
<td>
<p>IntegerVector, zero-based perceptual state 0 or 1,
2 is mixed state.</p>
</td></tr>
<tr><td><code id="predict_samples_+3A_duration">duration</code></td>
<td>
<p>DoubleVector, duration of a dominance phase.</p>
</td></tr>
<tr><td><code id="predict_samples_+3A_is_used">is_used</code></td>
<td>
<p>IntegerVector, whether dominance phase is used for
prediction (1) or not (0).</p>
</td></tr>
<tr><td><code id="predict_samples_+3A_run_start">run_start</code></td>
<td>
<p>IntegerVector, 1 whenever a new run starts.</p>
</td></tr>
<tr><td><code id="predict_samples_+3A_session_tmean">session_tmean</code></td>
<td>
<p>DoubleVector, average dominance phase duration.</p>
</td></tr>
<tr><td><code id="predict_samples_+3A_irandom">irandom</code></td>
<td>
<p>IntegerVector, zero-based index of a random effect.</p>
</td></tr>
<tr><td><code id="predict_samples_+3A_fixed">fixed</code></td>
<td>
<p>NumericMatrix, matrix with fixed effect values.</p>
</td></tr>
<tr><td><code id="predict_samples_+3A_tau_ind">tau_ind</code></td>
<td>
<p>NumericMatrix, matrix with samples of tau for each
random level.</p>
</td></tr>
<tr><td><code id="predict_samples_+3A_mixed_state_ind">mixed_state_ind</code></td>
<td>
<p>NumericMatrix, matrix with samples of
mixed_state for each random level.</p>
</td></tr>
<tr><td><code id="predict_samples_+3A_history_init">history_init</code></td>
<td>
<p>DoubleVector, Initial values of history for a run</p>
</td></tr>
<tr><td><code id="predict_samples_+3A_a">a</code></td>
<td>
<p>NumericMatrix, matrix with samples of
a (intercept) for each random level.</p>
</td></tr>
<tr><td><code id="predict_samples_+3A_bh">bH</code></td>
<td>
<p>NumericMatrix, matrix with sample of
bH for each linear model and random level.</p>
</td></tr>
<tr><td><code id="predict_samples_+3A_bf">bF</code></td>
<td>
<p>NumericMatrix, matrix with sample of
bF for each linear model and fixed factor.</p>
</td></tr>
<tr><td><code id="predict_samples_+3A_sigma">sigma</code></td>
<td>
<p>DoubleVector, samples of sigma.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NumericMatrix with predicted durations for each sample.
</p>

<hr>
<h2 id='predict.cumhist'>Computes predicted dominance phase durations using posterior predictive distribution.</h2><span id='topic+predict.cumhist'></span>

<h3>Description</h3>

<p>Computes predicted dominance phase durations using fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cumhist'
predict(
  object,
  summary = TRUE,
  probs = NULL,
  full_length = TRUE,
  predict_history = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.cumhist_+3A_object">object</code></td>
<td>
<p>An object of class <a href="#topic+cumhist-class">cumhist</a></p>
</td></tr>
<tr><td><code id="predict.cumhist_+3A_summary">summary</code></td>
<td>
<p>Whether summary statistics should be returned instead of
raw sample values. Defaults to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="predict.cumhist_+3A_probs">probs</code></td>
<td>
<p>The percentiles used to compute summary, defaults to NULL (no CI).</p>
</td></tr>
<tr><td><code id="predict.cumhist_+3A_full_length">full_length</code></td>
<td>
<p>Only for <code>summary = TRUE</code>, whether the summary table should
include rows with no predictions. I.e., rows with mixed phases, first/last dominance
phase in the run, etc. See <code><a href="#topic+preprocess_data">preprocess_data()</a></code>. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="predict.cumhist_+3A_predict_history">predict_history</code></td>
<td>
<p>Option to predict a cumulative history state (or their difference).
It is disabled by default by setting it to <code>NULL</code>. You can specify <code>"1"</code> or <code>"2"</code>
for cumulative history for the first or second perceptual states (with indexes 1 and 2, respectively),
<code>"dominant"</code> or <code>"suppressed"</code> for cumulative history for states that either dominant
or suppressed during the following phase, <code>"difference"</code> for difference between suppressed
and dominant. See cumulative history vignette for details.</p>
</td></tr>
<tr><td><code id="predict.cumhist_+3A_...">...</code></td>
<td>
<p>Unused</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>summary=FALSE</code>, a numeric matrix iterationsN x clearN.
If <code>summary=TRUE</code> but <code>probs=NULL</code> a vector of mean predicted durations
or requested cumulative history values.
If <code>summary=TRUE</code> and <code>probs</code> is not <code>NULL</code>, a data.frame
with a column <em>&quot;Predicted&quot;</em> (mean) and a column for each specified quantile.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit_cumhist">fit_cumhist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
br_fit &lt;- fit_cumhist(br_singleblock, state = "State", duration = "Duration")
predict(br_fit)

# full posterior prediction samples
predictions_samples &lt;- predict(br_fit, summary=FALSE)

</code></pre>

<hr>
<h2 id='preprocess_data'>Preprocesses time-series data for fitting</h2><span id='topic+preprocess_data'></span>

<h3>Description</h3>

<p>Performs sanity checks (e.g., whether <code>data</code> can be used as a data.frame),
computes duration of dominance phases (if necessary), assumes a single entry for
any missing <code>session</code>, <code>run</code>, <code>random_effect</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preprocess_data(
  data,
  state,
  duration = NULL,
  onset = NULL,
  random_effect = NULL,
  session = NULL,
  run = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="preprocess_data_+3A_data">data</code></td>
<td>
<p>A table with one or many time-series.</p>
</td></tr>
<tr><td><code id="preprocess_data_+3A_state">state</code></td>
<td>
<p>String, the name of the column that specifies
perceptual state. The column type should be a factor with
two or three levels (the third level is assumed to correspond to a
transition/mixed phase) or should be convertible to a two level
factor (as it would be impossible to infer the identity of transition/
mixed phase).</p>
</td></tr>
<tr><td><code id="preprocess_data_+3A_duration">duration</code></td>
<td>
<p>String, name of the column with duration of individual
perceptual dominance phases. Optional, you can specify <code>onset</code>
instead.</p>
</td></tr>
<tr><td><code id="preprocess_data_+3A_onset">onset</code></td>
<td>
<p>String, name of the column with onsets of the perceptual
dominance states. Optional, used to compute duration of the dominance
phases, if these are not provided explicitly via <code>duration</code>
parameter.</p>
</td></tr>
<tr><td><code id="preprocess_data_+3A_random_effect">random_effect</code></td>
<td>
<p>String, name of the column that identifies random effect,
e.g. individual participants, stimuli for a single participant, etc.
If omitted, no random effect is assumed. If specified and
there is more than one level (participant, stimulus, etc.), it is used
in a hierarchical model.</p>
</td></tr>
<tr><td><code id="preprocess_data_+3A_session">session</code></td>
<td>
<p>String, name of the column that identifies unique
experimental session for which a mean dominance phase duration will
be computed (see <code>norm_tau</code> parameter). Code assumes that session
IDs are different within a participant but can be the same between them.
If omitted, a single mean dominance duration based on the entire time series
is used.</p>
</td></tr>
<tr><td><code id="preprocess_data_+3A_run">run</code></td>
<td>
<p>String, name of the column that identifies unique runs/blocks.
If omitted, the data is assumed to belong to a single time series. Code
assumes that run IDs are different within an experimental session but
can be the same between the session. E.g. session A, runs 1, 2, 3.. and
session B, runs 1, 2, 3 but not session A, runs 1, 2, 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with columns
</p>

<ul>
<li> <p><code>state</code>
</p>
</li>
<li> <p><code>duration</code>
</p>
</li>
<li> <p><code>random</code>
</p>
</li>
<li> <p><code>irandom</code> - integer, index of <code>random</code> values,
</p>
</li>
<li> <p><code>session</code>
</p>
</li>
<li> <p><code>run</code>
</p>
</li>
<li> <p><code>session_tmean</code> - numeric, mean duration of clear percepts for every combination of <code>random</code> and <code>session</code>.
</p>
</li>
<li> <p><code>is_used</code> - integer, whether computed history value needs to be used for linear model fitting.
</p>
</li>
<li> <p><code>run_start</code> - integer, 1 for the first row of the run time-series.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- preprocess_data(br_singleblock, state="State", duration="Duration")
</code></pre>

<hr>
<h2 id='print.cumhist'>Prints out cumhist object</h2><span id='topic+print.cumhist'></span>

<h3>Description</h3>

<p>Prints out cumhist object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cumhist'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.cumhist_+3A_x">x</code></td>
<td>
<p>A <a href="#topic+cumhist-class">cumhist</a> object</p>
</td></tr>
<tr><td><code id="print.cumhist_+3A_...">...</code></td>
<td>
<p>Unused</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, console output only.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
br_fit &lt;- fit_cumhist(br_singleblock, state="State", duration="Duration", fixed_effects="Time")
br_fit

</code></pre>

<hr>
<h2 id='summary.cumhist'>Summary for a cumhist object</h2><span id='topic+summary.cumhist'></span>

<h3>Description</h3>

<p>Summary for a cumhist object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cumhist'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.cumhist_+3A_object">object</code></td>
<td>
<p>A <a href="#topic+cumhist-class">cumhist</a> object</p>
</td></tr>
<tr><td><code id="summary.cumhist_+3A_...">...</code></td>
<td>
<p>Unused</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, console output only.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
br_fit &lt;- fit_cumhist(br_singleblock, state="State", duration="Duration")
summary(br_fit)

</code></pre>

<hr>
<h2 id='waic.cumhist'>Computes widely applicable information criterion
(WAIC).</h2><span id='topic+waic.cumhist'></span>

<h3>Description</h3>

<p>Computes widely applicable information criterion
via <a href="loo.html#topic+loo-package">loo</a> library. It can be used for a model comparison via
<a href="loo.html#topic+loo_compare">loo::loo_compare()</a> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cumhist'
waic(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="waic.cumhist_+3A_x">x</code></td>
<td>
<p>A <a href="#topic+cumhist-class">cumhist</a> object.</p>
</td></tr>
<tr><td><code id="waic.cumhist_+3A_...">...</code></td>
<td>
<p>Additional arguments (unused)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list, see <code><a href="loo.html#topic+waic">loo::waic()</a></code> for details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
data(br_singleblock)
gamma_fit &lt;- fit_cumhist(br_singleblock, state="State", duration="Duration")
waic_gamma &lt;- waic(gamma_fit)
normal_fit &lt;- fit_cumhist(br_singleblock, state="State", duration="Duration", family="normal")
waic_normal &lt;- waic(normal_fit)
loo::loo_compare(waic_gamma, waic_normal)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
