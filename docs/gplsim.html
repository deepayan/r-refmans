<!DOCTYPE html><html><head><title>Help for package gplsim</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gplsim}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add_sim_bound'><p>function dedicated to add simulation standard error bound, in development</p>
draw the bound to current plot</a></li>
<li><a href='#air'>
<p>dataset from an environmental study.</p></a></li>
<li><a href='#generate_data'><p>Data generation function for simulation and demonstration</p>
A sine-bump setting has been employed.</a></li>
<li><a href='#gplsim'><p>Function to fit generalized partially linear single-index models via penalized splines</p></a></li>
<li><a href='#plot_si'><p>Function that plot fitted curve for the unknown univariate function for single index term</p></a></li>
<li><a href='#Predict.matrix.tr.smooth'><p>prediction method function for the tr smooth class</p></a></li>
<li><a href='#print.summary.gplsim'><p>Print Summary function of gplsim object</p></a></li>
<li><a href='#si'><p>An internal function to optimization and fitting.</p>
Don't use it solely.</a></li>
<li><a href='#smooth.construct.tr.smooth.spec'><p>supporting function to make tr smooth</p></a></li>
<li><a href='#summary.gplsim'><p>Summary function of gplsim object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Spline Estimation for GPLSIM</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-02-11</td>
</tr>
<tr>
<td>Description:</td>
<td>We provides functions that employ splines to estimate generalized 
             partially linear single index models (GPLSIM), which extend the generalized linear 
             models to include nonlinear effect for some predictors. Please see Y. (2017) at
             &lt;<a href="https://doi.org/10.1007%2Fs11222-016-9639-0">doi:10.1007/s11222-016-9639-0</a>&gt; and Y., and R. (2002) at &lt;<a href="https://doi.org/10.1198%2F016214502388618861">doi:10.1198/016214502388618861</a>&gt; for more details.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>mgcv, stats, minpack.lm</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-11 16:27:21 UTC; tianhaizu</td>
</tr>
<tr>
<td>Author:</td>
<td>Tianhai Zu [aut, trl, cre],
  Yan Yu [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tianhai Zu &lt;zuti@mail.uc.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-11 16:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='add_sim_bound'>function dedicated to add simulation standard error bound, in development
draw the bound to current plot</h2><span id='topic+add_sim_bound'></span>

<h3>Description</h3>

<p>function dedicated to add simulation standard error bound, in development
draw the bound to current plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_sim_bound(
  data,
  family = gaussian(),
  M = 200,
  n = 1000,
  true.theta = c(1, 1, 1)/sqrt(3)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_sim_bound_+3A_data">data</code></td>
<td>
<p>a list of simulated data</p>
</td></tr>
<tr><td><code id="add_sim_bound_+3A_family">family</code></td>
<td>
<p>default is gaussian()</p>
</td></tr>
<tr><td><code id="add_sim_bound_+3A_m">M</code></td>
<td>
<p>number of simulations</p>
</td></tr>
<tr><td><code id="add_sim_bound_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="add_sim_bound_+3A_true.theta">true.theta</code></td>
<td>
<p>the true coefficients</p>
</td></tr>
</table>

<hr>
<h2 id='air'>
dataset from an environmental study.
</h2><span id='topic+air'></span>

<h3>Description</h3>

<p>This dataset contains four variables: The concentration of the air pollutant ozone, wind speed, temperature and radiation. All of them are daily measurements for 111 days. Usually the concentration of the air pollutant ozone serves as the response variable while the other three are predictors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("air")</code></pre>


<h3>Format</h3>

<p>A data frame with 111 observations on the following 4 variables.
</p>

<dl>
<dt><code>ozone</code></dt><dd><p>a numeric vector in cube root ppb</p>
</dd>
<dt><code>radiation</code></dt><dd><p>a numeric vector in langley</p>
</dd>
<dt><code>temperature</code></dt><dd><p>a numeric vector in degrees F</p>
</dd>
<dt><code>wind_speed</code></dt><dd><p>a numeric vector in mph</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(air)
y=air$ozone               # response
X=as.matrix(air[,3:4])    # single index term ;
Z=air[,2]                 # partially linear term ;

result &lt;- gplsim(y,X,Z=Z,family = gaussian,k=10)
result$theta
result$coefficients
summary(result)

# Or you can try different spline basis
result &lt;- gplsim(y,X,Z=Z,family = gaussian,bs="tp",k=10)
result$theta
result$coefficients
summary(result)

</code></pre>

<hr>
<h2 id='generate_data'>Data generation function for simulation and demonstration
A sine-bump setting has been employed.</h2><span id='topic+generate_data'></span>

<h3>Description</h3>

<p>Data generation function for simulation and demonstration
A sine-bump setting has been employed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_data(
  n,
  true.theta = c(1, 1, 1)/sqrt(3),
  family = "gaussian",
  ncopy = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generate_data_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="generate_data_+3A_true.theta">true.theta</code></td>
<td>
<p>true single-index coefficients,
default is c(1,1,1)/sqrt(3) for setting 1 and c(1,2)/sqrt(5) for other settings</p>
</td></tr>
<tr><td><code id="generate_data_+3A_family">family</code></td>
<td>
<p>chose from &quot;gaussian&quot;, &quot;binomial&quot; or &quot;poisson&quot;.</p>
</td></tr>
<tr><td><code id="generate_data_+3A_ncopy">ncopy</code></td>
<td>
<p>generates multiple copies of data for Monte Carlo simulations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>X single index predictors
</p>
<p>Y response variables, a list
</p>
<p>Z partial linear predictor(s)
</p>
<p>single_index_values single index term
</p>

<hr>
<h2 id='gplsim'>Function to fit generalized partially linear single-index models via penalized splines</h2><span id='topic+gplsim'></span><span id='topic+gplsim.default'></span><span id='topic+gplsim.formula'></span>

<h3>Description</h3>

<p>This function employs penalized spline (P-spline) to estimate generalized
partially linear single index models, which extend the generalized linear
models to include nonlinear effect for some predictors.
</p>
<p>This function add formula interface to gplsim function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gplsim(...)

## Default S3 method:
gplsim(
  Y = Y,
  X = X,
  Z = Z,
  family = gaussian(),
  penalty = TRUE,
  profile = TRUE,
  user.init = NULL,
  bs = "ps",
  ...
)

## S3 method for class 'formula'
gplsim(
  formula,
  data,
  family = gaussian(),
  penalty = TRUE,
  profile = TRUE,
  user.init = NULL,
  bs = "ps",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gplsim_+3A_...">...</code></td>
<td>
<p>includes optional arguments user can pass to <code>mgcv::gam</code> or <code>glm</code>, such as <code>k</code>, which is the dimension of the basis of the smooth term and <code>m</code>, which is the order of the penalty for the smooth term. Others include:
<code>scale</code> The optional argument scale is a numeric indicator with a default value set to -1. Any negative value including -1 indicates that the scale of response distribution is unknown, thus need to be estimated. Another option is 0 signaling scale of 1 for Poisson and binomial distribution and unknown for others. Any positive value will be taken as the known scale parameter.
<code>smooth_selection</code> The optional argument smooth_selection is another character variable that specifies the criterion used in the selection of a smoothing parameter. The supported criteria include &quot;GCV.Cp&quot;,&quot;GACV.Cp&quot;, &quot;ML&quot;,&quot;P-ML&quot;, &quot;P-REML&quot; and &quot;REML&quot;, while the default criterion is &quot;GCV.Cp&quot;.</p>
</td></tr>
<tr><td><code id="gplsim_+3A_y">Y</code></td>
<td>
<p>Response variable, should be a vector.</p>
</td></tr>
<tr><td><code id="gplsim_+3A_x">X</code></td>
<td>
<p>Single index covariates.</p>
</td></tr>
<tr><td><code id="gplsim_+3A_z">Z</code></td>
<td>
<p>Partially linear covariates.</p>
</td></tr>
<tr><td><code id="gplsim_+3A_family">family</code></td>
<td>
<p>A <code>family</code> object: a list of functions and expressions
for defining <code>link</code> and <code>variance</code> functions.
Families supported are <code>binomial</code>, <code>gaussian</code>.
The default family is <code>gaussian</code>.</p>
</td></tr>
<tr><td><code id="gplsim_+3A_penalty">penalty</code></td>
<td>
<p>Whether use penalized splines or un-penalized splines to fit the model. The default is TRUE.</p>
</td></tr>
<tr><td><code id="gplsim_+3A_profile">profile</code></td>
<td>
<p>profile is a logical variable that indicates whether the algorithm with profile likelihood or algorithm with NLS procedure should be used. The default algorithm is set to algorithm with profile likelihood.</p>
</td></tr>
<tr><td><code id="gplsim_+3A_user.init">user.init</code></td>
<td>
<p>The user.init is a numeric vector of the same length as the dimensionality of single index predictors. The users can use this argument to pass in any appropriate user-defined initial single-index coefficients based on prior information or domain knowledge. The default value is NULL.</p>
</td></tr>
<tr><td><code id="gplsim_+3A_bs">bs</code></td>
<td>
<p>bs is a character variable that specifies the spline basis in the estimation of unknown univariate function of single index. Default is P-splines.</p>
</td></tr>
<tr><td><code id="gplsim_+3A_formula">formula</code></td>
<td>
<p>A model formula;</p>
</td></tr>
<tr><td><code id="gplsim_+3A_data">data</code></td>
<td>
<p>A data matrix containing the variables in the formula.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For formula method, see ?gplsim.formula
</p>


<h3>Value</h3>

<p>theta  Estimation of Theta
</p>
<p>coefficients  the coefficients of the fitted model. Parametric coefficients are first, followed by coefficients for each spline term in turn.
</p>
<p>... See GAM object
</p>
<p>theta  Estimation of Theta
</p>
<p>coefficients  the coefficients of the fitted model. Parametric coefficients are first, followed by coefficients for each spline term in turn.
</p>
<p>... See GAM object
</p>


<h3>Examples</h3>

<pre><code class='language-R'># parameter settings
n=200
true.theta = c(1, 1, 1)/sqrt(3)
# Gaussian case
# This function generate a plain sin bump model with gaussian response.
data &lt;- generate_data(n,true.theta=true.theta,family="gaussian")
y=data$Y       # continous response
X=data$X       # single index term ;
Z=data$Z       # partially linear term ;

result &lt;- gplsim(y,X,Z,family = gaussian)
result$theta
result$coefficients
summary(result)


#plot the estimated single index function curve
plot_si(result)
</code></pre>

<hr>
<h2 id='plot_si'>Function that plot fitted curve for the unknown univariate function for single index term</h2><span id='topic+plot_si'></span>

<h3>Description</h3>

<p>Function that plot fitted curve for the unknown univariate function for single index term
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_si(
  x,
  family = gaussian(),
  ylab = "mean",
  yscale = NULL,
  plot_data = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_si_+3A_x">x</code></td>
<td>
<p>the gam/gplism fitted object</p>
</td></tr>
<tr><td><code id="plot_si_+3A_family">family</code></td>
<td>
<p>default is gaussian()</p>
</td></tr>
<tr><td><code id="plot_si_+3A_ylab">ylab</code></td>
<td>
<p>y label</p>
</td></tr>
<tr><td><code id="plot_si_+3A_yscale">yscale</code></td>
<td>
<p>scale of y</p>
</td></tr>
<tr><td><code id="plot_si_+3A_plot_data">plot_data</code></td>
<td>
<p>controls whether to plot the data as points</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL single-index plot
</p>

<hr>
<h2 id='Predict.matrix.tr.smooth'>prediction method function for the tr smooth class</h2><span id='topic+Predict.matrix.tr.smooth'></span>

<h3>Description</h3>

<p>prediction method function for the tr smooth class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Predict.matrix.tr.smooth(object, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Predict.matrix.tr.smooth_+3A_object">object</code></td>
<td>
<p>smooth object for gam class</p>
</td></tr>
<tr><td><code id="Predict.matrix.tr.smooth_+3A_data">data</code></td>
<td>
<p>the new data to predict on
'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>X the prediction matrix
</p>

<hr>
<h2 id='print.summary.gplsim'>Print Summary function of gplsim object</h2><span id='topic+print.summary.gplsim'></span>

<h3>Description</h3>

<p>Print Summary function of gplsim object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.gplsim'
print(
  x,
  digits = max(5, getOption("digits") - 3),
  signif.stars = getOption("show.signif.stars"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.gplsim_+3A_x">x</code></td>
<td>
<p>the gam/gplism fitted object</p>
</td></tr>
<tr><td><code id="print.summary.gplsim_+3A_digits">digits</code></td>
<td>
<p>controls number of digits printed in output.</p>
</td></tr>
<tr><td><code id="print.summary.gplsim_+3A_signif.stars">signif.stars</code></td>
<td>
<p>should significance stars be printed alongside output.</p>
</td></tr>
<tr><td><code id="print.summary.gplsim_+3A_...">...</code></td>
<td>
<p>optional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>summarized object with nice format
</p>

<hr>
<h2 id='si'>An internal function to optimization and fitting.
Don't use it solely.</h2><span id='topic+si'></span>

<h3>Description</h3>

<p>An internal function to optimization and fitting.
Don't use it solely.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>si(
  alpha,
  y,
  x,
  z,
  opt = TRUE,
  smooth_selection,
  fam,
  bs = "ps",
  fx = FALSE,
  scale = scale,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="si_+3A_alpha">alpha</code></td>
<td>
<p>single-index coefficients</p>
</td></tr>
<tr><td><code id="si_+3A_y">y</code></td>
<td>
<p>Response variable, should be a vector.</p>
</td></tr>
<tr><td><code id="si_+3A_x">x</code></td>
<td>
<p>Single index covariates.</p>
</td></tr>
<tr><td><code id="si_+3A_z">z</code></td>
<td>
<p>Partially linear covariates.</p>
</td></tr>
<tr><td><code id="si_+3A_opt">opt</code></td>
<td>
<p>see ?gplsim</p>
</td></tr>
<tr><td><code id="si_+3A_smooth_selection">smooth_selection</code></td>
<td>
<p>see ?gplsim</p>
</td></tr>
<tr><td><code id="si_+3A_fam">fam</code></td>
<td>
<p>see ?gplsim</p>
</td></tr>
<tr><td><code id="si_+3A_bs">bs</code></td>
<td>
<p>see ?gplsim</p>
</td></tr>
<tr><td><code id="si_+3A_fx">fx</code></td>
<td>
<p>see ?gplsim</p>
</td></tr>
<tr><td><code id="si_+3A_scale">scale</code></td>
<td>
<p>see ?gplsim</p>
</td></tr>
<tr><td><code id="si_+3A_...">...</code></td>
<td>
<p>includes optional arguments user can pass to <code>mgcv::gam</code> or <code>glm</code>, such as <code>k</code>, which is the dimension of the basis of the smooth term and <code>m</code>, which is the order of the penalty for the smooth term</p>
</td></tr>
</table>


<h3>Value</h3>

<p>b fitted gam object
</p>

<hr>
<h2 id='smooth.construct.tr.smooth.spec'>supporting function to make tr smooth</h2><span id='topic+smooth.construct.tr.smooth.spec'></span>

<h3>Description</h3>

<p>supporting function to make tr smooth
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smooth.construct.tr.smooth.spec(object, data, knots)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smooth.construct.tr.smooth.spec_+3A_object">object</code></td>
<td>
<p>smooth object for gam class</p>
</td></tr>
<tr><td><code id="smooth.construct.tr.smooth.spec_+3A_data">data</code></td>
<td>
<p>the new data to predict on</p>
</td></tr>
<tr><td><code id="smooth.construct.tr.smooth.spec_+3A_knots">knots</code></td>
<td>
<p>knots</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tr smooth object
</p>

<hr>
<h2 id='summary.gplsim'>Summary function of gplsim object</h2><span id='topic+summary.gplsim'></span>

<h3>Description</h3>

<p>Summary function of gplsim object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gplsim'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.gplsim_+3A_object">object</code></td>
<td>
<p>the gam/gplism fitted object</p>
</td></tr>
<tr><td><code id="summary.gplsim_+3A_...">...</code></td>
<td>
<p>optional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>gplsim_obj a list of summary information for a fitted gplsim object, which extends on gam object.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
