<!DOCTYPE html><html><head><title>Help for package SCOPRO</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SCOPRO}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#filter_in_vitro'><p>filter_in_vitro</p></a></li>
<li><a href='#plot_score'><p>plot_score</p></a></li>
<li><a href='#plot_score_genes'><p>plot_score_genes</p></a></li>
<li><a href='#SCOPRO'><p>SCOPRO</p></a></li>
<li><a href='#select_common_genes'><p>select_common_genes</p></a></li>
<li><a href='#select_no_common_genes'><p>select_no_common_genes</p></a></li>
<li><a href='#select_top_markers'><p>select_top_markers</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Score Projection Between in 'Vivo' and in 'Vitro' Datasets</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Gabriele Lubatti</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gabriele Lubatti &lt;gabriele.lubatti@helmholtz-muenchen.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Assigns a score projection from 0 to 1 between a given in 'vivo' stage and each single cluster from an in 'vitro' dataset. The score is assigned based on the the fraction of specific markers of the in 'vivo' stage that are conserved in the in 'vitro' clusters <a href="https://github.com/ScialdoneLab">https://github.com/ScialdoneLab</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>CIARA, rmarkdown, testthat (&ge; 3.0.0), knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>biocViews:</td>
<td>software</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ScialdoneLab/SCOPRO/issues">https://github.com/ScialdoneLab/SCOPRO/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-22 12:38:41 UTC; gabriele.lubatti</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-23 08:10:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='filter_in_vitro'>filter_in_vitro</h2><span id='topic+filter_in_vitro'></span>

<h3>Description</h3>

<p>For a given gene in in <em>marker_all</em>, if the fraction of cells in one or more clusters with an expression above <em>threshold</em> is greater than <em>fraction</em>, then the gene
is kept
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_in_vitro(
  norm_vitro,
  cluster_vitro,
  marker_all,
  fraction = 0.1,
  threshold = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_in_vitro_+3A_norm_vitro">norm_vitro</code></td>
<td>
<p>Norm count matrix (n_genes X n_cells) for in vitro dataset</p>
</td></tr>
<tr><td><code id="filter_in_vitro_+3A_cluster_vitro">cluster_vitro</code></td>
<td>
<p>cluster for in vitro dataset</p>
</td></tr>
<tr><td><code id="filter_in_vitro_+3A_marker_all">marker_all</code></td>
<td>
<p>First element of the list given as output by the function <em>select_top_markers</em></p>
</td></tr>
<tr><td><code id="filter_in_vitro_+3A_fraction">fraction</code></td>
<td>
<p>Numeric value.</p>
</td></tr>
<tr><td><code id="filter_in_vitro_+3A_threshold">threshold</code></td>
<td>
<p>Numeric value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector with the names of kept genes
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>

<hr>
<h2 id='plot_score'>plot_score</h2><span id='topic+plot_score'></span>

<h3>Description</h3>

<p>plot_score
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_score(
  SCOPRO_output,
  marker_stages,
  marker_stages_filter,
  selected_stages,
  name_vivo,
  y_name,
  fill_name,
  title_name
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_score_+3A_scopro_output">SCOPRO_output</code></td>
<td>
<p>output given by function <em>SCOPRO</em></p>
</td></tr>
<tr><td><code id="plot_score_+3A_marker_stages">marker_stages</code></td>
<td>
<p>Second element of the list given as output by the function <em>select_top_markers</em></p>
</td></tr>
<tr><td><code id="plot_score_+3A_marker_stages_filter">marker_stages_filter</code></td>
<td>
<p>output from the function <em>filter_in_vitro</em></p>
</td></tr>
<tr><td><code id="plot_score_+3A_selected_stages">selected_stages</code></td>
<td>
<p>In vivo stages for which the markers where computed with the function <em>select_top_markers</em></p>
</td></tr>
<tr><td><code id="plot_score_+3A_name_vivo">name_vivo</code></td>
<td>
<p>name of the in vivo stage on which SCOPRO is run</p>
</td></tr>
<tr><td><code id="plot_score_+3A_y_name">y_name</code></td>
<td>
<p>Character value</p>
</td></tr>
<tr><td><code id="plot_score_+3A_fill_name">fill_name</code></td>
<td>
<p>Character value.</p>
</td></tr>
<tr><td><code id="plot_score_+3A_title_name">title_name</code></td>
<td>
<p>Character value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2::ggplot2 object.
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>

<hr>
<h2 id='plot_score_genes'>plot_score_genes</h2><span id='topic+plot_score_genes'></span>

<h3>Description</h3>

<p>plot_score_genes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_score_genes(
  markers_to_plot,
  label_1,
  label_2,
  norm_vitro,
  norm_vivo,
  cluster_vitro,
  cluster_vivo,
  final_name,
  max_size = 9,
  text_size = 9.5,
  title_name
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_score_genes_+3A_markers_to_plot">markers_to_plot</code></td>
<td>
<p>Character vector with the names of the genes to plot.</p>
</td></tr>
<tr><td><code id="plot_score_genes_+3A_label_1">label_1</code></td>
<td>
<p>Character value. Label for the in vitro dataset</p>
</td></tr>
<tr><td><code id="plot_score_genes_+3A_label_2">label_2</code></td>
<td>
<p>Character value. Label for the in vivo dataset</p>
</td></tr>
<tr><td><code id="plot_score_genes_+3A_norm_vitro">norm_vitro</code></td>
<td>
<p>Norm count matrix (n_genes X n_cells) for in vitro dataset</p>
</td></tr>
<tr><td><code id="plot_score_genes_+3A_norm_vivo">norm_vivo</code></td>
<td>
<p>Norm count matrix (n_genes X n_cells) for in vivo dataset</p>
</td></tr>
<tr><td><code id="plot_score_genes_+3A_cluster_vitro">cluster_vitro</code></td>
<td>
<p>cluster for in vitro dataset</p>
</td></tr>
<tr><td><code id="plot_score_genes_+3A_cluster_vivo">cluster_vivo</code></td>
<td>
<p>cluster for in vivo dataset</p>
</td></tr>
<tr><td><code id="plot_score_genes_+3A_final_name">final_name</code></td>
<td>
<p>Character vector with the names of the genes to show in the plot.</p>
</td></tr>
<tr><td><code id="plot_score_genes_+3A_max_size">max_size</code></td>
<td>
<p>Numeric value, specifying the size of the dot.</p>
</td></tr>
<tr><td><code id="plot_score_genes_+3A_text_size">text_size</code></td>
<td>
<p>Numeric value, specifying the size of the text in the plot.</p>
</td></tr>
<tr><td><code id="plot_score_genes_+3A_title_name">title_name</code></td>
<td>
<p>Character value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2::ggplot2 object showing balloon plot.
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>

<hr>
<h2 id='SCOPRO'>SCOPRO</h2><span id='topic+SCOPRO'></span>

<h3>Description</h3>

<p>The mean expression profile of <em>marker_stages_filter</em> genes is computed for each cluster in the in vivo and in vitro dataset.
For a given cluster, a connectivity matrix is computed with number of rows and number of columns equal to the length of <em>marker_stages_filter</em>. Each entry (i,j)  in the matrix can be 1 if the fold_change between gene i and gene j is above <em>fold_change</em>. Otherwise is 0.
Finally the connectivity matrix of a given <em>name_vivo</em> stage and all the clusters in the in vitro dataset are compared.
A gene i is considered to be conserved between <em>name_vivo</em> and an in vitro cluster if the jaccard index of the links of gene i is above <em>threshold</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SCOPRO(
  norm_vitro,
  norm_vivo,
  cluster_vitro,
  cluster_vivo,
  name_vivo,
  marker_stages_filter,
  threshold = 0.1,
  number_link = 1,
  fold_change = 3,
  threshold_fold_change = 0.1,
  marker_stages,
  selected_stages
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SCOPRO_+3A_norm_vitro">norm_vitro</code></td>
<td>
<p>Norm count matrix (n_genes X n_cells) for in vitro dataset</p>
</td></tr>
<tr><td><code id="SCOPRO_+3A_norm_vivo">norm_vivo</code></td>
<td>
<p>Norm count matrix (n_genes X n_cells) for in vivo dataset</p>
</td></tr>
<tr><td><code id="SCOPRO_+3A_cluster_vitro">cluster_vitro</code></td>
<td>
<p>cluster for in vitro dataset</p>
</td></tr>
<tr><td><code id="SCOPRO_+3A_cluster_vivo">cluster_vivo</code></td>
<td>
<p>cluster for in vivo dataset</p>
</td></tr>
<tr><td><code id="SCOPRO_+3A_name_vivo">name_vivo</code></td>
<td>
<p>name of the in vivo stage on which SCOPRO is run</p>
</td></tr>
<tr><td><code id="SCOPRO_+3A_marker_stages_filter">marker_stages_filter</code></td>
<td>
<p>output from the function <em>filter_in_vitro</em></p>
</td></tr>
<tr><td><code id="SCOPRO_+3A_threshold">threshold</code></td>
<td>
<p>Numeric value. For a given gene, the jaccard index between the links from the in vivo and in vitro datasets is computed. If the jaccard index is above <em>threshold</em>, then the gene is considered to be conserved between the two datasets.</p>
</td></tr>
<tr><td><code id="SCOPRO_+3A_number_link">number_link</code></td>
<td>
<p>Numeric value. For a given gene in the in vivo dataset with links above <em>number_link</em>, the jaccard index between the links from in vitro and in vivo dataset is computed.</p>
</td></tr>
<tr><td><code id="SCOPRO_+3A_fold_change">fold_change</code></td>
<td>
<p>Numeric value. For a given gene, the fold change between all the other genes is computed. If fold change is above <em>fold_change</em>, then there is a link with weight 1 between the two genes.</p>
</td></tr>
<tr><td><code id="SCOPRO_+3A_threshold_fold_change">threshold_fold_change</code></td>
<td>
<p>Numeric value. Above <em>threshold</em> the fold change between genes is computed. Below <em>threshold</em> the difference between genes is computed.</p>
</td></tr>
<tr><td><code id="SCOPRO_+3A_marker_stages">marker_stages</code></td>
<td>
<p>Second element of the list given as output by the function <em>select_top_markers</em></p>
</td></tr>
<tr><td><code id="SCOPRO_+3A_selected_stages">selected_stages</code></td>
<td>
<p>In vivo stages for which the markers where computed with the function <em>select_top_markers</em></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with five elements:
</p>
<table>
<tr><td><code>common_link</code></td>
<td>
<p>Vector with the names of the genes conserved between <em>name_vivo</em> and all the clusters in the vitro dataset</p>
</td></tr>
<tr><td><code>no_common_link</code></td>
<td>
<p>Vector with the names of the genes not conserved between <em>name_vivo</em> and  the clusters in the vitro dataset</p>
</td></tr>
<tr><td><code>link_kept</code></td>
<td>
<p>List with the names of the genes conserved between <em>name_vivo</em> and each single cluster in the vitro dataset</p>
</td></tr>
<tr><td><code>link_no_kept</code></td>
<td>
<p>List with the names of the genes not conserved between <em>name_vivo</em> and each single cluster in the vitro dataset</p>
</td></tr>
<tr><td><code>final_score</code></td>
<td>
<p>Numeric value, given by the fraction of conserved markers of <em>name_vivo</em> and each single cluster in the in vitro dataset</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>load(system.file("extdata", "norm_es_vitro_small.Rda", package = "SCOPRO"))
n_es= norm_es_vitro_small
load(system.file("extdata", "norm_vivo_small.Rda", package = "SCOPRO"))
n_v = norm_vivo_small
load(system.file("extdata", "cluster_es_vitro_small.Rda", package = "SCOPRO"))
c_es=cluster_es_vitro_small
load(system.file("extdata", "cluster_vivo_small.Rda", package = "SCOPRO"))
c_v=cluster_vivo_small
load(system.file("extdata", "marker_stages_filter.Rda", package = "SCOPRO"))
m_s_f = marker_stages_filter
load(system.file("extdata", "marker_stages.Rda", package = "SCOPRO"))
m_s = marker_stages
stages = c("Late_2_cell","epiblast_4.5","epiblast_5.5","epiblast_6.5")
output_SCOPRO = SCOPRO(n_es,n_v,c_es,c_v,"Late_2_cell",m_s_f,0.1,1,3,0.1,m_s,stages)
plot_score(output_SCOPRO,m_s,m_s_f,stages,"Late_2_cell","Score","Cluster","2-cells")


</code></pre>

<hr>
<h2 id='select_common_genes'>select_common_genes</h2><span id='topic+select_common_genes'></span>

<h3>Description</h3>

<p>select_common_genes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_common_genes(
  SCOPRO_output,
  marker_stages,
  selected_stages,
  name_vivo,
  cluster_vitro,
  name_vitro
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select_common_genes_+3A_scopro_output">SCOPRO_output</code></td>
<td>
<p>output given by function <em>SCOPRO</em></p>
</td></tr>
<tr><td><code id="select_common_genes_+3A_marker_stages">marker_stages</code></td>
<td>
<p>Second element of the list given as output by the function <em>select_top_markers</em></p>
</td></tr>
<tr><td><code id="select_common_genes_+3A_selected_stages">selected_stages</code></td>
<td>
<p>In vivo stages for which the markers where computed with the function <em>select_top_markers</em></p>
</td></tr>
<tr><td><code id="select_common_genes_+3A_name_vivo">name_vivo</code></td>
<td>
<p>name of the in vivo stage on which SCOPRO is run</p>
</td></tr>
<tr><td><code id="select_common_genes_+3A_cluster_vitro">cluster_vitro</code></td>
<td>
<p>cluster for in vitro dataset</p>
</td></tr>
<tr><td><code id="select_common_genes_+3A_name_vitro">name_vitro</code></td>
<td>
<p>name of the in vitro stage for which we want to know the conserved markers with the <em>name_vivo</em> stage</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector with the names of the conserved markers of <em>name_vivo</em> stage in the <em>name_vitro</em> stage
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>

<hr>
<h2 id='select_no_common_genes'>select_no_common_genes</h2><span id='topic+select_no_common_genes'></span>

<h3>Description</h3>

<p>select_no_common_genes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_no_common_genes(
  SCOPRO_output,
  marker_stages,
  selected_stages,
  name_vivo,
  cluster_vitro,
  name_vitro
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select_no_common_genes_+3A_scopro_output">SCOPRO_output</code></td>
<td>
<p>output given by function <em>SCOPRO</em></p>
</td></tr>
<tr><td><code id="select_no_common_genes_+3A_marker_stages">marker_stages</code></td>
<td>
<p>Second element of the list given as output by the function <em>select_top_markers</em></p>
</td></tr>
<tr><td><code id="select_no_common_genes_+3A_selected_stages">selected_stages</code></td>
<td>
<p>In vivo stages for which the markers where computed with the function <em>select_top_markers</em></p>
</td></tr>
<tr><td><code id="select_no_common_genes_+3A_name_vivo">name_vivo</code></td>
<td>
<p>name of the in vivo stage on which SCOPRO is run</p>
</td></tr>
<tr><td><code id="select_no_common_genes_+3A_cluster_vitro">cluster_vitro</code></td>
<td>
<p>cluster for in vitro dataset</p>
</td></tr>
<tr><td><code id="select_no_common_genes_+3A_name_vitro">name_vitro</code></td>
<td>
<p>name of the in vitro stage for which we want to know the non-conserved markers with the <em>name_vivo</em> stage</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector with the names of the non-conserved markers of <em>name_vivo</em> stage in the <em>name_vitro</em> stage
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>

<hr>
<h2 id='select_top_markers'>select_top_markers</h2><span id='topic+select_top_markers'></span>

<h3>Description</h3>

<p>For each stage in <em>selected_stages</em>, starting from the markers given by <em>markers_cluster_seurat</em> function of the package CIARA, only the markers
with a median above <em>threshold</em> in the stage and below <em>threshold</em> in all the other stages are kept.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_top_markers(
  selected_stages,
  cluster_vivo,
  norm_vivo,
  markers_small,
  max_number = 100,
  threshold = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select_top_markers_+3A_selected_stages">selected_stages</code></td>
<td>
<p>Character vector with the name of the selected in vivo stages</p>
</td></tr>
<tr><td><code id="select_top_markers_+3A_cluster_vivo">cluster_vivo</code></td>
<td>
<p>cluster for in vivo dataset</p>
</td></tr>
<tr><td><code id="select_top_markers_+3A_norm_vivo">norm_vivo</code></td>
<td>
<p>Norm count matrix (n_genes X n_cells) for in vivo dataset</p>
</td></tr>
<tr><td><code id="select_top_markers_+3A_markers_small">markers_small</code></td>
<td>
<p>Output given by the function <em>markers_cluster_seurat</em> of the package CIARA</p>
</td></tr>
<tr><td><code id="select_top_markers_+3A_max_number">max_number</code></td>
<td>
<p>Numeric value. Maximum number of top markers to consider for each stage in <em>selected_stages</em></p>
</td></tr>
<tr><td><code id="select_top_markers_+3A_threshold">threshold</code></td>
<td>
<p>Numeric value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two elements:
</p>
<table>
<tr><td><code>marker_all</code></td>
<td>
<p>Vector with the union of all the <em>top_number</em> markers for each stage in <em>selected_stages</em></p>
</td></tr>
<tr><td><code>marker_stages</code></td>
<td>
<p>List with length equal to number of stages in <em>selected_stages</em> . Each element contains the <em>top_number</em> markers for a given stage in <em>selected_stages</em>  </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>


<h3>See Also</h3>

<p><a href="https://CRAN.R-project.org/package=CIARA">https://CRAN.R-project.org/package=CIARA</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
