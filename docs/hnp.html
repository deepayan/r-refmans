<!DOCTYPE html><html><head><title>Help for package hnp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {hnp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#hnp-package'><p>Half-Normal Plots with Simulation Envelopes</p></a></li>
<li><a href='#cbb'><p>Coffee berry borer trapping data</p></a></li>
<li><a href='#chryso'><p><em>Chrysoperla externa</em> mortality data</p></a></li>
<li><a href='#corn'><p>Corn damage data</p></a></li>
<li><a href='#fungi'>
<p><em>Diaphorina citri</em> mortality data</p></a></li>
<li><a href='#hnp'><p>Half-Normal Plots with Simulation Envelopes</p></a></li>
<li><a href='#hnp-internal'><p>Internal function to prepare <code>hnp</code> objects</p></a></li>
<li><a href='#newhnp'><p>Method for non-implemented model classes</p></a></li>
<li><a href='#oil'>
<p><em>Diaphorina citri</em> oviposition data</p></a></li>
<li><a href='#orange'><p>Orange tissue-culture experiment data</p></a></li>
<li><a href='#plot.hnp'><p>Plot Method for hnp Objects</p></a></li>
<li><a href='#progeny'>
<p><em>Sitophilus zeamais</em> progeny</p></a></li>
<li><a href='#wolbachia'>
<p><em>Trichogramma galloi</em> parasitism data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Half-Normal Plots with Simulation Envelopes</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2-6</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-05-21</td>
</tr>
<tr>
<td>Author:</td>
<td>Rafael de Andrade Moral [aut, cre],
  John Hinde [aut],
  Clarice Garcia Borges Demetrio [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rafael de Andrade Moral &lt;rafael_moral@yahoo.com.br&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), MASS (&ge; 7.3-35), methods, graphics, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>lme4, gamlss, gamlss.dist, pscl, nnet, aods3, VGAM, glmmADMB,
latticeExtra</td>
</tr>
<tr>
<td>Additional_repositories:</td>
<td><a href="http://glmmadmb.r-forge.r-project.org/repos">http://glmmadmb.r-forge.r-project.org/repos</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Generates (half-)normal plots with simulation envelopes using different diagnostics from a range of different fitted models. A few example datasets are included.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-05-21 14:01:19 UTC; rafael</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-05-21 15:27:55 UTC</td>
</tr>
</table>
<hr>
<h2 id='hnp-package'>Half-Normal Plots with Simulation Envelopes</h2><span id='topic+hnp-package'></span>

<h3>Description</h3>

<p>Generates (half-)normal plots with simulation envelopes for common diagnostics from fitted models for a range of model classes. The function <code>hnp()</code> is written so that it is relatively easy to extend it to new model classes and different diagnostics that are not already implemented. A few example datasets are included. The main functions are <code>hnp</code> and <code>plot.hnp</code></p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> hnp</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.2-6</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2018-05-21</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL version 2 or newer</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Package includes two functions, <code>hnp</code> and <code>plot.hnp</code>, as well as seven data sets extracted from Demétrio et al (2014).
Explanation on how to produce the half-normal plots with simulation envelopes can be found in Demétrio and Hinde (1997) and on the <code>hnp</code> function documentation.
Data sets are based on entomology studies and the focus is on overdispersed data. Details on overdispersion models can be found in Hinde and Demétrio (1998).
Special thanks to FAPESP and CNPq for funding.
</p>


<h3>Author(s)</h3>

<p>Rafael A. Moral, John Hinde and Clarice G. B. Demétrio
</p>
<p>Maintainer: Rafael Moral &lt;rafael_moral@yahoo.com.br&gt;
</p>


<h3>References</h3>

<p>Moral, R. A., Hinde, J. and Demétrio, C. G. B. (2017) Half-normal plots and overdispersed models in R: the hnp package. Journal of Statistical Software 81(10):1-23.
</p>
<p>Demétrio, C. G. B. and Hinde, J. (1997) Half-normal plots and overdispersion. GLIM Newsletter 27:19-26.
</p>
<p>Hinde, J. and Demétrio, C. G. B. (1998) Overdispersion: models and estimation. Computational Statistics and Data Analysis 27:151-170.
</p>
<p>Demétrio, C. G. B., Hinde, J. and Moral, R. A. (2014) Models for overdispersed data in entomology. In Godoy, W. A. C. and Ferreira, C. P. (Eds.) Ecological modelling applied to entomology. Springer.
</p>

<hr>
<h2 id='cbb'>Coffee berry borer trapping data</h2><span id='topic+cbb'></span>

<h3>Description</h3>

<p>Data on counts of coffee berry borer obtained using different traps through time.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cbb)</code></pre>


<h3>Format</h3>

<p>A data frame with 288 observations on the following 4 variables.
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>week</code></td><td style="text-align: left;"> numeric</td><td style="text-align: left;"> week of observation (1 to 24)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>block</code></td><td style="text-align: left;"> factor</td><td style="text-align: left;">  levels <code>I</code> <code>II</code> <code>III</code> <code>IV</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>trap</code></td><td style="text-align: left;"> factor </td><td style="text-align: left;"> levels <code>CV</code> <code>F</code> <code>SF</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>count</code></td><td style="text-align: left;"> numeric</td><td style="text-align: left;"> number of observed insects	
 </td>
</tr>

</table>



<h3>Details</h3>

<p>The coffee berry borer is a major pest of commercial coffee. The insect directly attacks the coffee fruit in development causing severe losses in bean production and quality.
This data set was obtained in an experiment conducted by Mota (2013), where three types of traps (<code>SF</code>, <code>F</code>, <code>CV</code>) were randomized in each of four equidistant lines (blocks) of a coffee field. Each week, over a 24 week period, the insects were removed from the traps and counted.
</p>


<h3>Source</h3>

<p>Demétrio, C. G. B., Hinde, J. and Moral, R. A. (2014) Models for overdispersed data in entomology. In Godoy, W. A. C. and Ferreira, C. P. (Eds.) Ecological modelling applied to entomology. Springer.
</p>


<h3>References</h3>

<p>Mota, L. H. C. (2013) Desenvolvimento de armadilha de auto-inoculacao para o controlde de Hypothenemus hampei (Ferrari, 1867) (Coleoptera: Curculionidae) com Beauveria bassiana (Bals.) Vuil (Ascomycota: Hypocreales) em tecido sinetico. Master's dissertation, ESALQ-USP
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cbb)
# exploratory plot
require(latticeExtra)
trellis.par.set(strip.background=list(col="lightgrey"))
useOuterStrips(xyplot(count ~ week | block + trap, data=cbb,
  layout=c(3,1),type="l", col=1, xlab="Week", ylab="Insect counts"))

# Poisson fit
model1 &lt;- glm(count ~ block + trap*factor(week),
              data=cbb, family=poisson)
anova(model1, test="Chisq")
sum(resid(model1, ty="pearson")^2)
summary(model1)
hnp(model1, sim=19, conf=1)

## Not run: 
hnp(model1) # default call

## End(Not run)

# Quasi-Poisson fit
model2 &lt;- glm(count ~ block + trap*factor(week), data=cbb,
              family=quasipoisson)
anova(model2, test="F")
summary(model2)
hnp(model2, sim=19, conf=1)

## Not run: 
hnp(model2) # default call

## End(Not run)

## for discussion on the analysis of this data set,
## see Demetrio et al. (2014)
</code></pre>

<hr>
<h2 id='chryso'><em>Chrysoperla externa</em> mortality data</h2><span id='topic+chryso'></span>

<h3>Description</h3>

<p>Mortality of the predator <em>Chrysoperla externa</em> on different doses of lime sulphur, a substance used to control pests on trees.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(chryso)</code></pre>


<h3>Format</h3>

<p>A data frame with 24 observations on the following 4 variables.
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>dead</code></td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> count of dead C. externa specimens</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>alive</code></td><td style="text-align: left;"> numeric</td><td style="text-align: left;"> count of alive C. externa specimens</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>conc</code></td><td style="text-align: left;"> numeric</td><td style="text-align: left;"> lime sulphur concentration</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>log.conc</code></td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> natural logarithm of lime sulphur concentration
  </td>
</tr>

</table>



<h3>Details</h3>

<p>The neuropteran <em>Chrysoperla externa</em> is a predator that acts
as a natural enemy of the brown citrus aphid, <em>Toxoptera
citricida</em>, which is among the most important citrus pests
worldwide. A possible strategy to control <em>T. citricida</em>
populations would be to use a substance called lime sulphur and the <em>C. externa</em> predator
in combination, which may be beneficial as long as the lime sulphur has less
effect on the predator than the prey. To explore this, Battel (2012) conducted an
experiment with first-instar larvae of <em>Chrysoperla
externa</em> exposed to different levels of lime sulphur.
Specifically, twenty-four Orange Jessamine (<em>Murraya
paniculata</em>) plants were sprayed with different concentrations (<code>conc</code>) of
lime sulphur and up to seven first-instar larvae were placed on each
plant. The experiment was set up in a completely randomized design with four treatments:
lime sulphur concentrations at 0ppm (water control), 60ppm,  600ppm,
and 6000ppm. The plants were observed until the predators reached the second instar and
the number of larvae that died on each plant was recorded.
</p>


<h3>Source</h3>

<p>Demétrio, C. G. B., Hinde, J. and Moral, R. A. (2014) Models for overdispersed data in entomology. In Godoy, W. A. C. and Ferreira, C. P. (Eds.) Ecological modelling applied to entomology. Springer.
</p>


<h3>References</h3>

<p>Battel, A. P. M. B. (2012) Dinamica de predacao e resposta funcional em <em>Chrysoperla externa</em> (<em>Neuroptera: Chrysopidae</em>) sobre <em>Toxoptera citricida</em> (<em>Hemiptera: Aphididae</em>) aplicada a citricultura organica. Master's dissertation, ESALQ-USP
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chryso)

# fit model using conc levels both on log-scale and
# as a factor to produce simple analysis of deviance
model &lt;- glm(cbind(dead, alive) ~  log.conc + factor(conc),
             family=binomial, data=chryso)
anova(model, test="Chisq")
# test adequacy of factor model using deviance and X2
1-pchisq(deviance(model), df.residual(model))
(X2 &lt;- sum(residuals(model, type="pearson")^2))
1-pchisq(X2, df.residual(model))

model1 &lt;- glm(cbind(dead, alive) ~ log.conc,
              family=binomial, data=chryso)
par(mfrow=c(1,2), cex=1.4)
with(chryso, plot(jitter(log.conc), dead/(dead+alive),
                  ylab="Proportion dead", xlab="log(conc+1)"))
x &lt;- seq(0, 8.7, .1)
pr &lt;- predict(model1, data.frame(log.conc=x), ty="response")
lines(x, pr)
# half-normal plot
hnp(model1, xlab="Half-normal scores",
    ylab="Deviance residuals", pch=4)

require(MASS)
dose.p(model1, p=.10)

logLC10 &lt;- dose.p(model1, p=.10)
LC10 &lt;- exp(logLC10[[1]]) - 1

#95% CI on log-dose scale using transformation
c(logLC10[1]-2*attr(logLC10,'SE'),
  logLC10[1]+2*attr(logLC10,'SE'))

#95% CI on dose scale using transformation
c(exp(logLC10[1]-2*attr(logLC10,'SE'))-1,
  exp(logLC10[1]+2*attr(logLC10,'SE'))-1)

## for discussion on the analysis of this data set,
## see Demetrio et al. (2014)
</code></pre>

<hr>
<h2 id='corn'>Corn damage data</h2><span id='topic+corn'></span>

<h3>Description</h3>

<p>Corn grain damage by the maize weevil, a major pest of stored maize worldwide.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(corn)</code></pre>


<h3>Format</h3>

<p>A data frame with 40 observations on the following 3 variables.
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>extract</code></td><td style="text-align: left;"> factor</td><td style="text-align: left;"> with levels <code>leaf</code>, <code>branch</code>, <code>seed</code> and <code>control</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>m</code></td><td style="text-align: left;"> numeric</td><td style="text-align: left;"> total number of corn grains</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>y</code></td><td style="text-align: left;"> numeric</td><td style="text-align: left;"> number of damaged corn grains
  </td>
</tr>

</table>



<h3>Details</h3>

<p>A major pest of stored  maize in Brazil is <em>Sitophilus zeamais</em>.
In an experiment to assess the insecticide action of organic
extracts of <em>Annona mucosa</em> (<em>Annonaceae</em>), Petri dishes containing 10g of corn were treated with
extracts prepared with different parts of the plant
(seeds, leaves and branches) at a concentration of 1500mg/kg
or just water (control), using a completely randomized design with 10 replicates.
Then 20 Sitophilus zeamais adults were placed in each Petri dish
and, after 60 days, the numbers of damaged and undamaged corn grains were counted, see Ribeiro et al (2013).
</p>


<h3>Source</h3>

<p>Demétrio, C. G. B., Hinde, J. and Moral, R. A. (2014) Models for overdispersed data in entomology. In Godoy, W. A. C. and Ferreira, C. P. (Eds.) Ecological modelling applied to entomology. Springer.
</p>


<h3>References</h3>

<p>Moral, R. A., Hinde, J. and Demétrio, C. G. B. (2017) Half-normal plots and overdispersed models in R: the hnp package. Journal of Statistical Software 81(10):1-23.
</p>
<p>Ribeiro, L. P., Vendramin, J. D., Bicalho, K. U., Andrade, M. S., Fernandes, J. B., Moral, R. A., Demétrio, C. G. B. (2013) <em>Annona mucosa Jacq.</em> (<em>Annonaceae</em>): A promising source of bioactive compounds against <em>Sitophilus zeamais Mots.</em> (<em>Coleoptera: Curculionidae</em>). J Stored Prod Res 55:6-14
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(corn)

# Binomial fit
model1 &lt;- glm(cbind(y, m-y) ~ extract, family=binomial,
              data=corn)
anova(model1, test="Chisq")
hnp(model1, pch=4, main="Binomial: Logit",
    xlab="Half-normal scores", ylab="Deviance residuals")

# Quasi-binomial fit
model2 &lt;- glm(cbind(y, m-y) ~ extract, family=quasibinomial,
              data=corn)
anova(model2, test="F")
summary(model2)$dispersion # estimated phi

# half-normal plots
par(mfrow=c(1,2),cex=1.4, cex.main=0.9, pty='s')
hnp(model1, pch=4, main="(a) Binomial; Logit",
    xlab="Half-normal scores", ylab="Deviance residuals")
hnp(model2, pch=4, main="(b) Quasibinomial; Logit",
    xlab="Half-normal scores", ylab="Deviance residuals")

anova(model1, test="Chisq") # binomial model
anova(model2, test="F") # quasi-binomial model
summary(model1) # binomial model
summary(model2) # quasi-binomial model

# now with factor level parameterisation
summary(update(model1,.~.-1))
summary(update(model2,.~.-1))

## for discussion on the analysis of this data set,
## see Demetrio et al. (2014)
</code></pre>

<hr>
<h2 id='fungi'>
<em>Diaphorina citri</em> mortality data
</h2><span id='topic+fungi'></span>

<h3>Description</h3>

<p>Mortality of the Citrus psyllid, <em>Diaphorina citri</em>, a major pest of Citrus worldwide, when exposed to different concentrations of two fungi species, <em>Beauveria bassiana</em> and <em>Isaria fumosorosea</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fungi)</code></pre>


<h3>Format</h3>

<p>A data frame with 30 observations on the following 5 variables.
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>y</code></td><td style="text-align: left;"> numeric</td><td style="text-align: left;"> number of dead insects</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>m</code></td><td style="text-align: left;"> numeric</td><td style="text-align: left;"> total number of insects</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>conc</code></td><td style="text-align: left;"> numeric</td><td style="text-align: left;"> fungi concentration (in conidia/ml)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>lconc</code></td><td style="text-align: left;"> numeric</td><td style="text-align: left;"> natural logarithm of fungi concentration</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>species</code></td><td style="text-align: left;">  factor</td><td style="text-align: left;">  levels <code>isaria</code> and <code>beauveria</code>, fungi species
  </td>
</tr>

</table>



<h3>Details</h3>

<p>The Citrus psyllid <em>Diaphorina citri</em> is a vector of Huanglongbing, known as greening disease. An
alternative to chemical control is to use solutions of fungi
conidia as a biological control strategy. D'Alessandro (2014)
conducted a completely randomized experiment to assess how
different conidia concentrations ($10^4$, $10^5$, $10^6$, $10^7$
and $10^8$ conidia/ml) of two fungi species, <em>Beauveria
bassiana</em> and <em>Isaria fumosorosea</em>, infected <em>D. citri</em>
adults. Each experimental unit consisted of around 20 <em>D.
citri</em> adults, which were placed on <em>Citrus limonia</em> plants.
The insects were pulverized with the solutions and after 10 days
the number of dead insects and dead insects due to fungus
infection were observed. Note that in this case the conidia
concentrations are obtained in successive dilutions and therefore
small variations in the number of conidia per ml may contribute
additional variability to the data. Such additional variability
may be accounted for in the model by including an additive random
effect in the linear predictor.
</p>


<h3>Source</h3>

<p>Demétrio, C. G. B., Hinde, J. and Moral, R. A. (2014) Models for overdispersed data in entomology. In Godoy, W. A. C. and Ferreira, C. P. (Eds.) Ecological modelling applied to entomology. Springer.
</p>


<h3>References</h3>

<p>D'Alessandro (2014) Unpublished data, private communication.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(fungi)

# Binomial fit
model1 &lt;- glm(cbind(y, m-y) ~ lconc*species,
              family=binomial, data=fungi)
anova(model1, test="Chisq")
sum(resid(model1, ty="pearson")^2)
1 - pchisq(sum(resid(model1, ty="pearson")^2), 20)
hnp(model1)

# Quasi-binomial fit
model2 &lt;- glm(cbind(y, m-y) ~ lconc*species,
              family=quasibinomial, data=fungi)
anova(model2, test="F")
hnp(model2)

## Not run: 
# Logistic-normal fit
require(lme4)
fungi$ind &lt;- factor(1:nrow(fungi))
model3 &lt;- glmer(cbind(y, m-y) ~ lconc*species + (1|ind),
                family=binomial, data=fungi)
summary(model3)
hnp(model3)

## End(Not run)

## for discussion on the analysis of this data set,
## see Demetrio et al. (2014)
</code></pre>

<hr>
<h2 id='hnp'>Half-Normal Plots with Simulation Envelopes</h2><span id='topic+hnp'></span>

<h3>Description</h3>

<p>Produces a (half-)normal plot from a fitted model object for a range of different models. Extendable to non-implemented model classes.</p>


<h3>Usage</h3>

<pre><code class='language-R'>hnp(object, sim = 99, conf = 0.95, resid.type, maxit,
    halfnormal = T, scale = F, plot.sim = T, verb.sim = F,
    warn = F, how.many.out = F, print.on = F, paint.out = F,
    col.paint.out, newclass = F, diagfun, simfun, fitfun, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hnp_+3A_object">object</code></td>
<td>
<p>fitted model object or numeric vector.</p>
</td></tr>
<tr><td><code id="hnp_+3A_sim">sim</code></td>
<td>
<p>number of simulations used to compute envelope. Default is 99.</p>
</td></tr>
<tr><td><code id="hnp_+3A_conf">conf</code></td>
<td>
<p>confidence level of the simulated envelope. Default is 0.95.</p>
</td></tr>
<tr><td><code id="hnp_+3A_resid.type">resid.type</code></td>
<td>
<p>type of residuals to be used; must be one of &quot;deviance&quot;, &quot;pearson&quot;, &quot;response&quot;, &quot;working&quot;, &quot;simple&quot;, &quot;student&quot;, or &quot;standard&quot;. Not all model type and residual type combinations are allowed. Defaults are &quot;student&quot; for <code><a href="stats.html#topic+aov">aov</a></code> and <code><a href="stats.html#topic+lm">lm</a></code> objects, &quot;deviance&quot; for <code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="MASS.html#topic+glm.nb">glm.nb</a></code>, <code>lmer</code>, <code>glmer</code> and <code>aodml</code> objects, &quot;simple&quot; for <code>gamlss</code> objects, &quot;response&quot; for <code>glmmadmb</code> and <code>vglm</code> objects, &quot;pearson&quot; for <code>zeroinfl</code> and <code>hurdle</code> objects.</p>
</td></tr>
<tr><td><code id="hnp_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations of the estimation algorithm. Defaults are 25 for <code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="MASS.html#topic+glm.nb">glm.nb</a></code>, <code>gamlss</code> and <code>vglm</code> objects, 300 for <code>glmmadmb</code>, <code>lmer</code> and <code>glmer</code> objects, 3000 for <code>aodml</code> objects, 10000 for <code>zeroinfl</code> and <code>hurdle</code> objects.</p>
</td></tr>
<tr><td><code id="hnp_+3A_halfnormal">halfnormal</code></td>
<td>
<p>logical. If <code>TRUE</code>, a half-normal plot is produced. If <code>FALSE</code>, a normal plot is produced. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="hnp_+3A_scale">scale</code></td>
<td>
<p>logical. If <code>TRUE</code> and if <code>object</code> is a numeric vector, simulates from a normal distribution with mean and variance estimated from <code>object</code>. If <code>FALSE</code>, uses a standard normal distribution to simulate from. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="hnp_+3A_plot.sim">plot.sim</code></td>
<td>
<p>logical. Should the (half-)normal plot be plotted? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="hnp_+3A_verb.sim">verb.sim</code></td>
<td>
<p>logical. If <code>TRUE</code>, prints each step of the simulation procedure. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="hnp_+3A_warn">warn</code></td>
<td>
<p>logical. If <code>TRUE</code>, shows warning messages in the simulation process. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="hnp_+3A_how.many.out">how.many.out</code></td>
<td>
<p>logical. If <code>TRUE</code>, the number of points out of the envelope is printed. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="hnp_+3A_print.on">print.on</code></td>
<td>
<p>logical. If <code>TRUE</code>, the number of points out of the envelope is printed on the plot. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="hnp_+3A_paint.out">paint.out</code></td>
<td>
<p>logical. If <code>TRUE</code>, points out of the simulation envelope are plotted in a different color. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="hnp_+3A_col.paint.out">col.paint.out</code></td>
<td>
<p>If <code>paint.out=TRUE</code>, sets the color of points out of the envelope. Default is <code>"red"</code>.</p>
</td></tr>
<tr><td><code id="hnp_+3A_newclass">newclass</code></td>
<td>
<p>logical. If <code>TRUE</code>, use <code>diagfun</code>, <code>simfun</code>, and <code>fitfun</code> to extract diagnostics (typically residuals), generate simulated data using fitted model parameters, and fit the desired model. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="hnp_+3A_diagfun">diagfun</code></td>
<td>
<p>user-defined function used to obtain the diagnostic measures from the fitted model object (only used when <code>newclass=TRUE</code>). Default is <code><a href="stats.html#topic+resid">resid</a></code>.</p>
</td></tr>
<tr><td><code id="hnp_+3A_simfun">simfun</code></td>
<td>
<p>user-defined function used to simulate a random sample from the model estimated parameters (only used when <code>newclass=TRUE</code>).</p>
</td></tr>
<tr><td><code id="hnp_+3A_fitfun">fitfun</code></td>
<td>
<p>user-defined function used to re-fit the model to simulated data (only used when <code>newclass=TRUE</code>).</p>
</td></tr>
<tr><td><code id="hnp_+3A_...">...</code></td>
<td>
<p>extra graphical arguments passed to <code><a href="#topic+plot.hnp">plot.hnp</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A relatively easy way to assess goodness-of-fit of a fitted model is to use (half-)normal plots of a model diagnostic, e.g., different types of residuals, Cook's distance, leverage. These plots are obtained by plotting the ordered absolute values of a model diagnostic versus the expected order statistic of a half-normal distribution, </p>
<p style="text-align: center;"><code class="reqn">\Phi^{-1}(\frac{i+n-1/8}{2*n+1/2})</code>
</p>
<p> (for a half-normal plot) or the normal distribution, </p>
<p style="text-align: center;"><code class="reqn">\Phi^{-1}(\frac{i+3/8}{n+1/4})</code>
</p>
<p> (for a normal plot).
</p>
<p>Atkinson (1985) proposed the addition of a simulated envelope, which is such that under the correct model the plot for the observed data is likely to fall within the envelope. The objective is not to provide a region of acceptance, but some sort of guidance to what kind of shape to expect.
</p>
<p>Obtaining the simulated envelope is simple and consists of (1) fitting a model; (2) extracting model diagnostics and calculating sorted absolute values; (3) simulating 99 (or more) response variables using the same model matrix, error distribution and fitted parameters; (4) fitting the same model to each simulated response variable and obtaining the same model diagnostics, again sorted absolute values; (5) computing the desired percentiles (e.g., 2.5 and 97.5) at each value of the expected order statistic to form the envelope.
</p>
<p>This function handles different model classes and more will be implemented as time goes by. So far, the following models are included:
</p>

<table>
<tr>
 <td style="text-align: left;">
<strong>Continuous data</strong>:</td>
</tr>
<tr>
 <td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;">
Normal:</td><td style="text-align: left;"> functions <code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="stats.html#topic+aov">aov</a></code> and <code><a href="stats.html#topic+glm">glm</a></code> with <code>family=gaussian</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
Gamma:</td><td style="text-align: left;"> function <code><a href="stats.html#topic+glm">glm</a></code> with <code>family=Gamma</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
Inverse gaussian:</td><td style="text-align: left;"> function <code><a href="stats.html#topic+glm">glm</a></code> with <code>family=inverse.gaussian</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
<b>Proportion data</b>:</td>
</tr>
<tr>
 <td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;">
Binomial:</td><td style="text-align: left;"> function <code><a href="stats.html#topic+glm">glm</a></code> with <code>family=binomial</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
Quasi-binomial:</td><td style="text-align: left;"> function <code><a href="stats.html#topic+glm">glm</a></code> with <code>family=quasibinomial</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
Beta-binomial:</td><td style="text-align: left;"> package <code>VGAM</code> - function <code>vglm</code>, with <code>family=betabinomial</code>;</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> package <code>aods3</code> - function <code>aodml</code>, with <code>family="bb"</code>;</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> package <code>gamlss</code> - function <code>gamlss</code>, with <code>family=BB</code>;</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> package <code>glmmADMB</code> - function <code>glmmadmb</code>, with <code>family="betabinomial"</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
Zero-inflated binomial:</td><td style="text-align: left;"> package <code>VGAM</code> - function <code>vglm</code>, with <code>family=zibinomial</code>;</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> package <code>gamlss</code> - function <code>gamlss</code>, with <code>family=ZIBI</code>;</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> package <code>glmmADMB</code> - function <code>glmmadmb</code>, with <code>family="binomial"</code></td>
</tr>
<tr>
 <td style="text-align: left;"> </td><td style="text-align: left;"> and <code>zeroInfl=TRUE</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
Zero-inflated beta-binomial: </td><td style="text-align: left;"> package <code>gamlss</code> - function <code>gamlss</code>, with <code>family=ZIBB</code>;</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> package <code>glmmADMB</code> - function <code>glmmadmb</code>, with <code>family="betabinomial"</code></td>
</tr>
<tr>
 <td style="text-align: left;"> </td><td style="text-align: left;"> and <code>zeroInfl=TRUE</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
Multinomial: </td><td style="text-align: left;"> package <code>nnet</code> - function <code><a href="mgcv.html#topic+multinom">multinom</a></code></td>
</tr>
<tr>
 <td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;">

<strong>Count data</strong>:</td>
</tr>
<tr>
 <td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;">
Poisson: </td><td style="text-align: left;"> function <code><a href="stats.html#topic+glm">glm</a></code> with <code>family=poisson</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
Quasi-Poisson: </td><td style="text-align: left;"> function <code><a href="stats.html#topic+glm">glm</a></code> with <code>family=quasipoisson</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
Negative binomial: </td><td style="text-align: left;"> package <code>MASS</code> - function <code><a href="MASS.html#topic+glm.nb">glm.nb</a></code>;</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> package <code>aods3</code> - function <code>aodml</code>, with <code>family="nb"</code></td>
</tr>
<tr>
 <td style="text-align: left;"> </td><td style="text-align: left;"> and <code>phi.scale="inverse"</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
Zero-inflated Poisson:</td><td style="text-align: left;"> package <code>pscl</code> - function <code>zeroinfl</code>, with <code>dist="poisson"</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
Zero-inflated negative binomial: </td><td style="text-align: left;"> package <code>pscl</code> - function <code>zeroinfl</code>, with <code>dist="negbin"</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
Hurdle Poisson:</td><td style="text-align: left;"> package <code>pscl</code> - function <code>hurdle</code>, with <code>dist="poisson"</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
Hurdle negative binomial:</td><td style="text-align: left;"> package <code>pscl</code> - function <code>hurdle</code>, with <code>dist="negbin"</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
<strong>Mixed models</strong>:</td>
</tr>
<tr>
 <td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;">

Linear mixed models: </td><td style="text-align: left;"> package <code>lme4</code>, function <code>lmer</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
Generalized linear mixed models: </td><td style="text-align: left;"> package <code>lme4</code>, function <code>glmer</code> with <code>family=poisson</code> or <code>binomial</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Users can also use a numeric vector as <code>object</code> and <code>hnp</code> will generate the (half-)normal plot with a simulated envelope using the standard normal distribution (<code>scale=F</code>) or <code class="reqn">N(\mu, \sigma^2)</code> (<code>scale=T</code>).
</p>
<p>Implementing a new model class is done by providing three functions to <code>hnp</code>: <code>diagfun</code> - to obtain model diagnostics, <code>simfun</code> - to simulate random variables and <code>fitfun</code> - to refit the model to simulated variables. The way these functions must be written is shown in the Examples section.
</p>


<h3>Value</h3>

<p><code>hnp</code> returns an object of class <code>"hnp"</code>, which is a list containing the following components:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>quantiles of the (half-)normal distribution</p>
</td></tr>
<tr><td><code>lower</code></td>
<td>
<p>lower envelope band</p>
</td></tr>
<tr><td><code>median</code></td>
<td>
<p>median envelope band</p>
</td></tr>
<tr><td><code>upper</code></td>
<td>
<p>upper envelope band</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>diagnostic measures in absolute value and in order</p>
</td></tr>
<tr><td><code>out.index</code></td>
<td>
<p>vector indicating which points are out of the envelope</p>
</td></tr>
<tr><td><code>col.paint.out</code></td>
<td>
<p>color of points which are outside of the envelope (used if <code>paint.out=TRUE</code>)</p>
</td></tr>
<tr><td><code>how.many.out</code></td>
<td>
<p>logical. Equals <code>TRUE</code> if <code>how.many.out=TRUE</code> in the <code>hnp</code> call</p>
</td></tr>
<tr><td><code>total</code></td>
<td>
<p>length of the diagnostic measure vector</p>
</td></tr>
<tr><td><code>out</code></td>
<td>
<p>number of points out of the envelope</p>
</td></tr>
<tr><td><code>print.on</code></td>
<td>
<p>logical. Equals <code>TRUE</code> if <code>print.on=TRUE</code> in the <code>hnp</code> call</p>
</td></tr>
<tr><td><code>paint.out</code></td>
<td>
<p>logical. Equals <code>TRUE</code> if <code>paint.out=TRUE</code> in the <code>hnp</code> call</p>
</td></tr>
<tr><td><code>all.sim</code></td>
<td>
<p>matrix with all diagnostics obtained in the simulations. Each column represents one simulation</p>
</td></tr>
</table>


<h3>Note</h3>

<p>See documentation on example data sets for simple analyses and goodness-of-fit checking using <code>hnp</code>.</p>


<h3>Author(s)</h3>

<p>Rafael A. Moral &lt;rafael_moral@yahoo.com.br&gt;, John Hinde and Clarice G. B. Demétrio
</p>


<h3>References</h3>

<p>Moral, R. A., Hinde, J. and Demétrio, C. G. B. (2017) Half-normal plots and overdispersed models in R: the hnp package. Journal of Statistical Software 81(10):1-23.
</p>
<p>Atkinson, A. C. (1985) Plots, transformations and regression, Clarendon Press, Oxford.
</p>
<p>Demétrio, C. G. B. and Hinde, J. (1997) Half-normal plots and overdispersion. GLIM Newsletter 27:19-26.
</p>
<p>Hinde, J. and Demétrio, C. G. B. (1998) Overdispersion: models and estimation. Computational Statistics and Data Analysis 27:151-170.
</p>
<p>Demétrio, C. G. B., Hinde, J. and Moral, R. A. (2014) Models for overdispersed data in entomology. In Godoy, W. A. C. and Ferreira, C. P. (Eds.) Ecological modelling applied to entomology. Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.hnp">plot.hnp</a></code>, <code><a href="#topic+cbb">cbb</a></code>, <code><a href="#topic+chryso">chryso</a></code>, <code><a href="#topic+corn">corn</a></code>, <code><a href="#topic+fungi">fungi</a></code>, <code><a href="#topic+oil">oil</a></code>, <code><a href="#topic+progeny">progeny</a></code>, <code><a href="#topic+wolbachia">wolbachia</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Simple Poisson regression
set.seed(100)
counts &lt;- c(rpois(5, 2), rpois(5, 4), rpois(5, 6), rpois(5, 8))
treatment &lt;- gl(4, 5)
fit &lt;- glm(counts ~ treatment, family=poisson)
anova(fit, test="Chisq")

## half-normal plot
hnp(fit)

## or save it in an object and then use the plot method
my.hnp &lt;- hnp(fit, print.on=TRUE, plot=FALSE)
plot(my.hnp)

## changing graphical parameters
plot(my.hnp, lty=2, pch=4, cex=1.2)
plot(my.hnp, lty=c(2,3,2), pch=4, cex=1.2, col=c(2,2,2,1))
plot(my.hnp, main="Half-normal plot", xlab="Half-normal scores",
     ylab="Deviance residuals", legpos="bottomright")

## Using a numeric vector
my.vec &lt;- rnorm(20, 4, 4)
hnp(my.vec) # using N(0,1)
hnp(my.vec, scale=TRUE) # using N(mu, sigma^2)

## Implementing new classes
## Users provide three functions - diagfun, simfun and fitfun,
## in the following way:
##
## diagfun &lt;- function(obj) {
##   userfunction(obj, other_argumens)
##     # e.g., resid(obj, type="pearson")
##   }
##
## simfun &lt;- function(n, obj) {
##   userfunction(n, other_arguments) # e.g., rpois(n, fitted(obj))
##   }
##
## fitfun &lt;- function(y.) {
##  userfunction(y. ~ linear_predictor, other_arguments, data=data)
##    # e.g., glm(y. ~ block + factor1 * factor2, family=poisson,
##    #           data=mydata)
##  }
##
## when response is binary:
## fitfun &lt;- function(y.) {
##  userfunction(cbind(y., m-y.) ~ linear_predictor,
##               other_arguments, data=data)
##    #e.g., glm(cbind(y., m-y.) ~ treatment - 1,
##    #          family=binomial, data=data)
##  }

## Not run: 
## Example no. 1: Using Cook's distance as a diagnostic measure
y &lt;- rpois(30, lambda=rep(c(.5, 1.5, 5), each=10))
tr &lt;- gl(3, 10)
fit1 &lt;- glm(y ~ tr, family=poisson)

# diagfun
d.fun &lt;- function(obj) cooks.distance(obj)

# simfun
s.fun &lt;- function(n, obj) {
  lam &lt;- fitted(obj)
  rpois(n, lambda=lam)
}

# fitfun
my.data &lt;- data.frame(y, tr)
f.fun &lt;- function(y.) glm(y. ~ tr, family=poisson, data=my.data)

# hnp call
hnp(fit1, newclass=TRUE, diagfun=d.fun, simfun=s.fun, fitfun=f.fun)

## Example no. 2: Implementing gamma model using package gamlss
# load package
require(gamlss)

# model fitting
y &lt;- rGA(30, mu=rep(c(.5, 1.5, 5), each=10), sigma=.5)
tr &lt;- gl(3, 10)
fit2 &lt;- gamlss(y ~ tr, family=GA)

# diagfun
d.fun &lt;- function(obj) resid(obj) # this is the default if no
                                  # diagfun is provided

# simfun
s.fun &lt;- function(n, obj) {
  mu &lt;- obj$mu.fv
  sig &lt;- obj$sigma.fv
  rGA(n, mu=mu, sigma=sig)
}

# fitfun
my.data &lt;- data.frame(y, tr)
f.fun &lt;- function(y.) gamlss(y. ~ tr, family=GA, data=my.data)

# hnp call
hnp(fit2, newclass=TRUE, diagfun=d.fun, simfun=s.fun,
    fitfun=f.fun, data=data.frame(y, tr))

## Example no. 3: Implementing binomial model in gamlss
# model fitting
y &lt;- rBI(30, bd=50, mu=rep(c(.2, .5, .9), each=10))
m &lt;- 50
tr &lt;- gl(3, 10)
fit3 &lt;- gamlss(cbind(y, m-y) ~ tr, family=BI)

# diagfun
d.fun &lt;- function(obj) resid(obj)

# simfun
s.fun &lt;- function(n, obj) {
  mu &lt;- obj$mu.fv
  bd &lt;- obj$bd
  rBI(n, bd=bd, mu=mu)
}

# fitfun
my.data &lt;- data.frame(y, tr, m)
f.fun &lt;- function(y.) gamlss(cbind(y., m-y.) ~ tr,
                               family=BI, data=my.data)

# hnp call
hnp(fit3, newclass=TRUE, diagfun=d.fun, simfun=s.fun, fitfun=f.fun)

## End(Not run)
</code></pre>

<hr>
<h2 id='hnp-internal'>Internal function to prepare <code>hnp</code> objects</h2><span id='topic+.makehnp'></span>

<h3>Description</h3>

<p>This is an internally called function used to prepare <code>hnp</code> objects for plotting</p>


<h3>Author(s)</h3>

<p>Rafael A. Moral &lt;rafael_moral@yahoo.com.br&gt;, John Hinde and Clarice G. B. Demétrio
</p>

<hr>
<h2 id='newhnp'>Method for non-implemented model classes</h2><span id='topic+newhnp'></span>

<h3>Description</h3>

<p>Uses user defined functions to produce the (half-)normal plot with simulated envelope.</p>


<h3>Usage</h3>

<pre><code class='language-R'>newhnp(object, sim=99, conf=.95, halfnormal=T, plot.sim=T,
       verb.sim=F, how.many.out=F, print.on=F, paint.out=F,
       col.paint.out, diagfun, simfun, fitfun, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="newhnp_+3A_object">object</code></td>
<td>
<p>fitted model object or numeric vector.</p>
</td></tr>
<tr><td><code id="newhnp_+3A_sim">sim</code></td>
<td>
<p>number of simulations used to compute envelope. Default is 99.</p>
</td></tr>
<tr><td><code id="newhnp_+3A_conf">conf</code></td>
<td>
<p>confidence level of the simulated envelope. Default is 0.95.</p>
</td></tr>
<tr><td><code id="newhnp_+3A_halfnormal">halfnormal</code></td>
<td>
<p>logical. If <code>TRUE</code>, a half-normal plot is produced. If <code>FALSE</code>, a normal plot is produced. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="newhnp_+3A_plot.sim">plot.sim</code></td>
<td>
<p>logical. Should the (half-)normal plot be plotted? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="newhnp_+3A_verb.sim">verb.sim</code></td>
<td>
<p>logical. If <code>TRUE</code>, prints each step of the simulation procedure. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="newhnp_+3A_how.many.out">how.many.out</code></td>
<td>
<p>logical. If <code>TRUE</code>, the number of points out of the envelope is printed. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="newhnp_+3A_print.on">print.on</code></td>
<td>
<p>logical. If <code>TRUE</code>, the number of points out of the envelope is printed on the plot. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="newhnp_+3A_paint.out">paint.out</code></td>
<td>
<p>logical. If <code>TRUE</code>, points out of the simulation envelope are plotted in a different color. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="newhnp_+3A_col.paint.out">col.paint.out</code></td>
<td>
<p>If <code>paint.out=TRUE</code>, sets the color of points out of the envelope. Default is <code>"red"</code>.</p>
</td></tr>
<tr><td><code id="newhnp_+3A_diagfun">diagfun</code></td>
<td>
<p>user-defined function used to obtain the diagnostic measures from the fitted model object (only used when <code>newclass=TRUE</code>). Default is <code><a href="stats.html#topic+resid">resid</a></code>.</p>
</td></tr>
<tr><td><code id="newhnp_+3A_simfun">simfun</code></td>
<td>
<p>user-defined function used to simulate a random sample from the model estimated parameters (only used when <code>newclass=TRUE</code>).</p>
</td></tr>
<tr><td><code id="newhnp_+3A_fitfun">fitfun</code></td>
<td>
<p>user-defined function used to re-fit the model to simulated data (only used when <code>newclass=TRUE</code>).</p>
</td></tr>
<tr><td><code id="newhnp_+3A_...">...</code></td>
<td>
<p>extra graphical arguments passed to <code><a href="#topic+plot.hnp">plot.hnp</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By providing three user-defined functions, <code>newhnp</code> produces the half-normal plot with simulated envelope for a model whose class is not yet implemented in the package.
</p>
<p>The first function, <code>diagfun</code>, must extract the desired model diagnostics from a model fit object. The second function, <code>simfun</code>, must return the response variable (numeric vector or matrix), simulated using the same error distributions and estimated parameters from the fitted model. The third and final function, <code>fitfun</code>, must return a fitted model object. See the Examples section.
</p>


<h3>Author(s)</h3>

<p>Rafael A. Moral &lt;rafael_moral@yahoo.com.br&gt;, John Hinde and Clarice G. B. Demétrio
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Implementing new classes
## Users provide three functions - diagfun, simfun and fitfun,
## in the following way:
##
## diagfun &lt;- function(obj) {
##   userfunction(obj, other_argumens)
##     # e.g., resid(obj, type="pearson")
##   }
##
## simfun &lt;- function(n, obj) {
##   userfunction(n, other_arguments) # e.g., rpois(n, fitted(obj))
##   }
##
## fitfun &lt;- function(y.) {
##  userfunction(y. ~ linear_predictor, other_arguments, data=data)
##    # e.g., glm(y. ~ block + factor1 * factor2, family=poisson,
##    #           data=mydata)
##  }
##
## when response is binary:
## fitfun &lt;- function(y.) {
##  userfunction(cbind(y., m-y.) ~ linear_predictor,
##               other_arguments, data=data)
##    #e.g., glm(cbind(y., m-y.) ~ treatment - 1,
##    #          family=binomial, data=data)
##  }

## Not run: 
## Example no. 1: Using Cook's distance as a diagnostic measure
y &lt;- rpois(30, lambda=rep(c(.5, 1.5, 5), each=10))
tr &lt;- gl(3, 10)
fit1 &lt;- glm(y ~ tr, family=poisson)

# diagfun
d.fun &lt;- function(obj) cooks.distance(obj)

# simfun
s.fun &lt;- function(n, obj) {
  lam &lt;- fitted(obj)
  rpois(n, lambda=lam)
}

# fitfun
my.data &lt;- data.frame(y, tr)
f.fun &lt;- function(y.) glm(y. ~ tr, family=poisson, data=my.data)

# hnp call
hnp(fit1, newclass=TRUE, diagfun=d.fun, simfun=s.fun, fitfun=f.fun)

## Example no. 2: Implementing gamma model using package gamlss
# load package
require(gamlss)

# model fitting
y &lt;- rGA(30, mu=rep(c(.5, 1.5, 5), each=10), sigma=.5)
tr &lt;- gl(3, 10)
fit2 &lt;- gamlss(y ~ tr, family=GA)

# diagfun
d.fun &lt;- function(obj) resid(obj) # this is the default if no
                                  # diagfun is provided

# simfun
s.fun &lt;- function(n, obj) {
  mu &lt;- obj$mu.fv
  sig &lt;- obj$sigma.fv
  rGA(n, mu=mu, sigma=sig)
}

# fitfun
my.data &lt;- data.frame(y, tr)
f.fun &lt;- function(y.) gamlss(y. ~ tr, family=GA, data=my.data)

# hnp call
hnp(fit2, newclass=TRUE, diagfun=d.fun, simfun=s.fun,
    fitfun=f.fun, data=data.frame(y, tr))

## Example no. 3: Implementing binomial model in gamlss
# model fitting
y &lt;- rBI(30, bd=50, mu=rep(c(.2, .5, .9), each=10))
m &lt;- 50
tr &lt;- gl(3, 10)
fit3 &lt;- gamlss(cbind(y, m-y) ~ tr, family=BI)

# diagfun
d.fun &lt;- function(obj) resid(obj)

# simfun
s.fun &lt;- function(n, obj) {
  mu &lt;- obj$mu.fv
  bd &lt;- obj$bd
  rBI(n, bd=bd, mu=mu)
}

# fitfun
my.data &lt;- data.frame(y, tr, m)
f.fun &lt;- function(y.) gamlss(cbind(y., m-y.) ~ tr,
                               family=BI, data=my.data)

# hnp call
hnp(fit3, newclass=TRUE, diagfun=d.fun, simfun=s.fun, fitfun=f.fun)

## End(Not run)
</code></pre>

<hr>
<h2 id='oil'>
<em>Diaphorina citri</em> oviposition data
</h2><span id='topic+oil'></span>

<h3>Description</h3>

<p>Effects of three agricultural oils on <em>Diaphorina citri</em> oviposition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(oil)</code></pre>


<h3>Format</h3>

<p>A data frame with 70 observations on the following 2 variables.
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>y</code></td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> number of eggs laid</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>treat</code></td><td style="text-align: left;">  factor </td><td style="text-align: left;"> treatments applied in the experiment
  </td>
</tr>

</table>


<h3>Details</h3>

<p>In an experiment to assess the effect of three agricultural oils
on the oviposition of <em>Diaphorina citri</em>, seventy Orange
Jessamine (<em>Murraya paniculata</em>) plants were sprayed with
solutions of the mineral oils Oppa and Iharol, and the vegetable
oil Nortox. The experiment used the oils in concentrations of
0.5 and 1.0 percent and a control of plain water set out in a
completely randomized design with ten replicates. Following
treatment, when the plants were dry, ten pregnant females of
<em>D. citri</em> were released on each plant. After five days, the
insects were removed and the total number of eggs on each plant
was observed, see Amaral et al (2012). This is an example of aggregated data as
the number of eggs is the sum over the (unrecorded)
numbers of eggs deposited each day and the possibility of day to
day variation may contribute additional variability to the
recorded counts.
</p>


<h3>Source</h3>

<p>Demétrio, C. G. B., Hinde, J. and Moral, R. A. (2014) Models for overdispersed data in entomology. In Godoy, W. A. C. and Ferreira, C. P. (Eds.) Ecological modelling applied to entomology. Springer.
</p>


<h3>References</h3>

<p>Amaral, F. S. A., Poltronieri, A. S., Alves, E. B., Omoto, C. (2012) Efeito de oleos agricolas no comportamento de oviposicao e viabilidade de ovos de <em>Diaphorina citri Kuwayama</em> (<em>Hemiptera: Psyllidae</em>). In: XX Simposio Internacional de Iniciacao Cientifica da Universidade de Sao Paulo, 2012, Pirassununga
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oil)

# Poisson fit
model1 &lt;- glm(y ~ treat, family=poisson, data=oil)
anova(model1, test="Chisq")
sum(resid(model1, ty="pearson")^2)

# Quasi-Poisson fit
model2 &lt;- glm(y ~ treat, family=quasipoisson, data=oil)
summary(model2)
anova(model2,test="F")
summary(model2)$dispersion

# Negative binomial fit
require(MASS)
model3 &lt;- glm.nb(y ~ treat, data=oil)
thetahat &lt;- summary(model3)$theta
anova(model3, test="F")

# half-normal plots
par(mfrow=c(1,3),cex=1.4, cex.main=0.9)
hnp(model1,pch=4, main="(a) Poisson",
     xlab="Half-normal scores", ylab="Deviance residuals")
hnp(model2,pch=4, main="(b) Quasi-Poisson",
     xlab="Half-normal scores", ylab='')
hnp(model3,pch=4, main="(c) Negative binomial",
     xlab="Half-normal scores", ylab='')

## Not run: 
# using aods3
require(aods3)
model3b &lt;- aodml(y ~ treat, family="nb", phi.scale="inverse",
                 fixpar=list(8, 1.086148), data=oil)
hnp(model3b)

## End(Not run)

## for discussion on the analysis of this data set,
## see Demetrio et al. (2014)
</code></pre>

<hr>
<h2 id='orange'>Orange tissue-culture experiment data</h2><span id='topic+orange'></span>

<h3>Description</h3>

<p>Number of embryos of orange variety <em>Caipira</em> produced with different sugar types.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("orange")</code></pre>


<h3>Format</h3>

<p>A data frame with 150 observations on the following 4 variables.
</p>

<dl>
<dt><code>block</code></dt><dd><p>a factor with levels <code>1</code> <code>2</code> <code>3</code> <code>4</code> <code>5</code></p>
</dd>
<dt><code>sugar</code></dt><dd><p>a factor with levels <code>Maltose</code> <code>Glucose</code> <code>Lactose</code> <code>Galactose</code> <code>Sucrose</code> <code>Glycerol</code></p>
</dd>
<dt><code>dose</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>embryos</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>To study the effect of six sugars (maltose, glucose, galactose, lactose, sucrose and glycerol) on the stimulation of somatic embryos from callus cultures, the number of embryos after approximately four weeks was observed. The experiment was set up in a completely randomized block design with five blocks and the six sugars at dose levels of 18, 37, 75, 110 and 150 mM for the first five and 6, 12, 24, 36 and 50 mM for glycerol, see Tomaz (2001). The main interest was in the dose-response relationship.</p>


<h3>Source</h3>

<p>Tomaz ML, Mendes BMJ, Filho FAM, Demetrio CGB, Jansakul N, Rodriguez APM (1997). Somatic embryogenesis in <em>Citrus</em> spp.: Carbohydrate stimulation and histodifferentiation. In Vitro Cellular &amp; Developmental Biology - Plant, 37, 446–452.
</p>


<h3>References</h3>

<p>Moral, R. A., Hinde, J. and Demétrio, C. G. B. (2017) Half-normal plots and overdispersed models in R: the hnp package. Journal of Statistical Software 81(10):1-23.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(orange)

require(gamlss)
fit_nbI &lt;- gamlss(embryos ~ block + poly(dose, 2) * sugar, 
                  family=NBII(), data=orange)
                  
d.fun &lt;- function(obj) resid(obj)

s.fun &lt;- function(n, obj) {
  mu &lt;- obj$mu.fv
  sigma &lt;- obj$sigma.fv
  rNBII(n, mu, sigma)
}

f.fun &lt;- function(y.) {
  gamlss(y. ~ block + poly(dose, 2) * sugar, family=NBII(), data=orange)
}

## Not run: 
hnp(fit_nbI, newclass=TRUE, diagfun=d.fun, simfun=s.fun, fitfun=f.fun)

## End(Not run)

fit_pred &lt;- gamlss(embryos ~ poly(dose, 2) * sugar, family=NBII(), data=orange)
orange.pred &lt;- rbind(expand.grid(sugar=levels(orange$sugar)[-6], dose=18:150),
                     expand.grid(sugar="Glycerol", dose=6:50))
orange.pred$pred &lt;- predict(fit_pred, newdata=orange.pred, type="response")
require(latticeExtra)
trellis.par.set(strip.background=list(col="lightgrey"))
xyplot(embryos ~ dose | sugar, scales=list(relation="free"), layout=c(3,2),
       data=orange, col=1, xlab="Dose levels", ylab="Number of embryos") +
  as.layer(xyplot(pred ~ dose | sugar, type="l", col=1, data=orange.pred))
</code></pre>

<hr>
<h2 id='plot.hnp'>Plot Method for hnp Objects</h2><span id='topic+plot.hnp'></span>

<h3>Description</h3>

<p>The <code>plot</code> method for objects of class hnp.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hnp'
plot(x, cex, pch, colour, lty, lwd, type,
     xlab, ylab, main, legpos, legcex, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.hnp_+3A_x">x</code></td>
<td>
<p>object of class <code>"hnp"</code>.</p>
</td></tr>
<tr><td><code id="plot.hnp_+3A_cex">cex</code></td>
<td>
<p>character expansion size.</p>
</td></tr>
<tr><td><code id="plot.hnp_+3A_pch">pch</code></td>
<td>
<p>character string or vector of one character or integer for plotting characters, see <code><a href="graphics.html#topic+points">points</a></code>.</p>
</td></tr>
<tr><td><code id="plot.hnp_+3A_colour">colour</code></td>
<td>
<p>vector of colours.</p>
</td></tr>
<tr><td><code id="plot.hnp_+3A_lty">lty</code></td>
<td>
<p>vector of line types.</p>
</td></tr>
<tr><td><code id="plot.hnp_+3A_lwd">lwd</code></td>
<td>
<p>vector of line widths.</p>
</td></tr>
<tr><td><code id="plot.hnp_+3A_type">type</code></td>
<td>
<p>type of plot for each envelope band and points. Default is <code>c("l","l","l","p")</code>.</p>
</td></tr>
<tr><td><code id="plot.hnp_+3A_xlab">xlab</code></td>
<td>
<p>title for x axis, as in <code><a href="graphics.html#topic+plot">plot</a></code></p>
</td></tr>
<tr><td><code id="plot.hnp_+3A_ylab">ylab</code></td>
<td>
<p>title for y axis, as in <code><a href="graphics.html#topic+plot">plot</a></code></p>
</td></tr>
<tr><td><code id="plot.hnp_+3A_main">main</code></td>
<td>
<p>plot title.</p>
</td></tr>
<tr><td><code id="plot.hnp_+3A_legpos">legpos</code></td>
<td>
<p>if <code>print.on=TRUE</code>, represents the position where the information should be printed (<code>"topright"</code>, <code>"topleft"</code>, <code>"bottomright"</code>, <code>"bottomleft"</code>), as in <code><a href="graphics.html#topic+legend">legend</a></code>.</p>
</td></tr>
<tr><td><code id="plot.hnp_+3A_legcex">legcex</code></td>
<td>
<p>if <code>print.on=TRUE</code>, character expansion size of <code><a href="graphics.html#topic+legend">legend</a></code>.</p>
</td></tr>
<tr><td><code id="plot.hnp_+3A_...">...</code></td>
<td>
<p>extra graphical arguments passed to <code><a href="graphics.html#topic+matplot">matplot</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.</p>


<h3>Author(s)</h3>

<p>Rafael A. Moral &lt;rafael_moral@yahoo.com.br&gt;, John Hinde and Clarice G. B. Demétrio
</p>


<h3>References</h3>

<p>Moral, R. A., Hinde, J. and Demétrio, C. G. B. (2017) Half-normal plots and overdispersed models in R: the hnp package. Journal of Statistical Software 81(10):1-23.
</p>
<p>Demétrio, C. G. B. and Hinde, J. (1997) Half-normal plots and overdispersion. GLIM Newsletter 27:19-26.
</p>
<p>Hinde, J. and Demétrio, C. G. B. (1998) Overdispersion: models and estimation. Computational Statistics and Data Analysis 27:151-170.
</p>
<p>Demétrio, C. G. B., Hinde, J. and Moral, R. A. (2014) Models for overdispersed data in entomology. In Godoy, W. A. C. and Ferreira, C. P. (Eds.) Ecological modelling applied to entomology. Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hnp">hnp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Simple Poisson regression
set.seed(100)
counts &lt;- c(rpois(5, 2), rpois(5, 4), rpois(5, 6), rpois(5, 8))
treatment &lt;- gl(4, 5)
fit &lt;- glm(counts ~ treatment, family=poisson)
anova(fit, test="Chisq")

## half-normal plot
hnp(fit)

## or save it in an object and then use the plot method
my.hnp &lt;- hnp(fit, print.on=TRUE, plot=FALSE)
plot(my.hnp)

## changing graphical parameters
plot(my.hnp, lty=2, pch=4, cex=1.2)
plot(my.hnp, lty=c(2,3,2), pch=4, cex=1.2, col=c(2,2,2,1))
plot(my.hnp, main="Half-normal plot", xlab="Half-normal scores",
     ylab="Deviance residuals", legpos="bottomright")
</code></pre>

<hr>
<h2 id='progeny'>
<em>Sitophilus zeamais</em> progeny
</h2><span id='topic+progeny'></span>

<h3>Description</h3>

<p>Progeny of <em>Sitophilus zeamais</em>, the maize weevil, when treated with different organic extracts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(progeny)</code></pre>


<h3>Format</h3>

<p>A data frame with 40 observations on the following 2 variables.
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>extract</code></td><td style="text-align: left;"> factor</td><td style="text-align: left;">  levels <code>leaf</code>, <code>branch</code>, <code>seed</code> and <code>control</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>y</code></td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> number of emerged insects after 60 days
</td>
</tr>

</table>


<h3>Details</h3>

<p>Petri dishes containing 10g of corn were treated with
extracts prepared with different parts of the plant <em>Annona mucosa</em>
(seeds, leaves and branches) at a concentration of 1500 mg/kg
or just water (control), using a completely randomized design with 10 replicates.
Then 20 <em>S. zeamais</em> adults were placed in each Petri dish and
the focus is on the numbers of emerged insects (progeny) after 60 days, see Ribeiro et al (2013).
</p>


<h3>Source</h3>

<p>Demétrio, C. G. B., Hinde, J. and Moral, R. A. (2014) Models for overdispersed data in entomology. In Godoy, W. A. C. and Ferreira, C. P. (Eds.) Ecological modelling applied to entomology. Springer.
</p>


<h3>References</h3>

<p>Ribeiro, L. P., Vendramin, J. D., Bicalho, K. U., Andrade, M. S., Fernandes, J. B., Moral, R. A., Demétrio, C. G. B. (2013) Annona mucosa Jacq. (Annonaceae): A promising source of bioactive compounds against Sitophilus zeamais Mots. (Coleoptera: Curculionidae). J Stored Prod Res 55:6-14
</p>
<p>Moral, R. A., Hinde, J. and Demétrio, C. G. B. (2017) Half-normal plots and overdispersed models in R: the hnp package. Journal of Statistical Software 81(10):1-23.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(progeny)

# Poisson fit
model1 &lt;- glm(y ~ extract, family=poisson, data=progeny)
anova(model1, test="Chisq")                
                 
# Quasi-Poisson fit    
model2 &lt;- glm(y ~ extract, family=quasipoisson, data=progeny)
summary(model2)$dispersion
anova(model2, test="F")

# half-normal plots
par(mfrow=c(1,2),cex=1.4, cex.main=0.9, pty='s')
hnp(model1, pch=4, main="(a) Poisson; log-linear",
    xlab="Half-normal scores", ylab="Deviance residuals")
hnp(model2, pch=4, main="(b) Quasi-Poisson; log-linear",
    xlab="Half-normal scores", ylab="Deviance residuals")
    
anova(model1, test="Chisq") # Poisson model
anova(model2, test="F") # quasi-Poisson model
summary(model1) # Poisson model
summary(model2) # quasi-Poisson model

# now with factor level parameterisation
summary(update(model1,.~.-1))
summary(update(model2,.~.-1))

## for discussion on the analysis of this data set,
## see Demetrio et al. (2014)
</code></pre>

<hr>
<h2 id='wolbachia'>
<em>Trichogramma galloi</em> parasitism data
</h2><span id='topic+wolbachia'></span>

<h3>Description</h3>

<p>Viability of <em>Trichogramma galloi</em>, a parasitoid wasp, when infected with <em>Wolbachia</em>, a bacteria known to change its reproductive aspects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(wolbachia)</code></pre>


<h3>Format</h3>

<p>A data frame with 106 observations on the following 3 variables.
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>y</code></td><td style="text-align: left;"> numeric; number of eggs with an orifice</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>m</code></td><td style="text-align: left;"> numeric; total number of parasitised eggs</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>treat</code></td><td style="text-align: left;"> a factor with levels <code>m+f+</code>, <code>m+f-</code>, <code>f+</code>, <code>m-f-</code> and <code>f-</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> where <code>m</code> stands for male, <code>f</code> stands for female, <code>+</code> means infected and <code>-</code> means non-infected;</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> <code>f+</code> and <code>f-</code> represent virgin infected and non-infected females, respectively.
  </td>
</tr>

</table>



<h3>Details</h3>

<p>The bacteria <em>Wolbachia</em> is commonly found in various insect
species and has the ability to change reproductive aspects of its
host. When it infects the wasp <em>Trichogramma galloi</em> it is known to induce
thelythokous parthenogenesis, i.e., only females are produced from
unfertilized eggs. Souza (2011) conducted
an experiment to assess the effects of <em>Wolbachia</em> on the
viability of <em>T. galloi</em> eggs. Around 100 <em>Diatraea saccharalis</em>
eggs (the host) were offered to infected (+) or non-infected (-)
parasitoid couples or virgin females every day until the death of
the female. The parasitised eggs, easily identifiable
because they become dark, were then kept on moist filter paper for
twenty days when counts were then made of the number of
eggs that had an orifice, which meant that an adult parasitoid had
emerged and thus the parasitoid was viable.
</p>


<h3>Source</h3>

<p>Demétrio, C. G. B., Hinde, J. and Moral, R. A. (2014) Models for overdispersed data in entomology. In Godoy, W. A. C. and Ferreira, C. P. (Eds.) Ecological modelling applied to entomology. Springer.
</p>


<h3>References</h3>

<p>Souza, A. R. (2011) A interacao <em>Wolbachia</em> - <em>Trichogramma galloi Zucchi</em>, 1988 (<em>Hymenoptera: Trichogrammatidae</em>). Master's dissertation, ESALQ-USP
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(wolbachia)

# Binomial fit
model1 &lt;- glm(cbind(y, m-y) ~ treat, family=binomial, data=wolbachia)
anova(model1, test="Chisq")

# Quasi-binomial fit
model2 &lt;- glm(cbind(y, m-y) ~ treat, family=quasibinomial, data=wolbachia)
summary(model2)
anova(model2,test="F")

## half normal plots
par(mfrow=c(1,2),cex=1.2, cex.main=1.1)
hnp(model1, print=TRUE, pch=4, main="(a) Binomial",
    xlab="Half-normal scores", ylab="Deviance residuals")
hnp(model2, print=TRUE, pch=4, main="(b) Quasi-binomial",
    xlab="Half-normal scores", ylab='')

## Not run: 
# Beta-binomial fit                                                
### using package aods3
require(aods3)                                                     
                                                                   
model3 &lt;- aodml(cbind(y, m-y) ~ treat, family='bb', data=wolbachia)
hnp(model3, print=TRUE, pch=4,                                     
    xlab="Half-normal scores", ylab='Deviance residuals')          

### using package VGAM
require(VGAM)

model3a &lt;- vglm(cbind(y, m-y) ~ treat, family=betabinomial,
                data=wolbachia)
summary(model3a)
1/(1+exp(-coef(model3a)[2])) # phi estimate
hnp(model3a, data=wolbachia)

## End(Not run)

## for discussion on the analysis of this data set,
## see Demetrio et al. (2014)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
