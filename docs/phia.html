<!DOCTYPE html><html><head><title>Help for package phia</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {phia}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#phia-package'>
<p>Post-Hoc Interaction Analysis</p></a></li>
<li><a href='#Boik'><p>Contrived Data of Treatments for Hemophobia</p></a></li>
<li><a href='#contrastCoefficients'>
<p>Calculate Coefficient Matrices of Factor Contrasts</p></a></li>
<li><a href='#interactionMeans'>
<p>Calculate and Plot Adjusted Means for Interactions</p></a></li>
<li><a href='#Keselman'><p>Repeated-Measures Pyschopsychological Experiment</p></a></li>
<li><a href='#Rosnow'><p>Rosnow's and Rosenthal's Baseball Performance Data</p></a></li>
<li><a href='#testFactors'>
<p>Evaluate and Test Combinations of Factor Levels</p></a></li>
<li><a href='#testInteractions'>
<p>Test Contrasts of Factor Interactions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.3-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-03</td>
</tr>
<tr>
<td>Title:</td>
<td>Post-Hoc Interaction Analysis</td>
</tr>
<tr>
<td>Description:</td>
<td>Analysis of terms in linear, generalized and mixed linear models, 
	on the basis of multiple comparisons of factor contrasts.  Specially suited 
	for the analysis of interaction terms.</td>
</tr>
<tr>
<td>Depends:</td>
<td>car, graphics, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>nlme, lme4</td>
</tr>
<tr>
<td>Imports:</td>
<td>Matrix, grDevices, methods, utils</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/heliosdrm/phia">https://github.com/heliosdrm/phia</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-09 06:50:48 UTC; meliana</td>
</tr>
<tr>
<td>Author:</td>
<td>Helios De Rosario-Martinez [aut, cre],
  John Fox [ctb],
  R Core Team [ctb],
  Chalmers Phil [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Helios De Rosario-Martinez &lt;helios.derosario@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-09 11:50:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='phia-package'>
Post-Hoc Interaction Analysis</h2><span id='topic+phia-package'></span><span id='topic+phia'></span>

<h3>Description</h3>

<p>Analysis of the expected values and other terms of in linear, generalized, and
mixed linear models, on the basis of multiple comparisons of factor contrasts.
Specially suited for the analysis of interaction effects.</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> phia</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.3-1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-01-03</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 3)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>This package contains functions that may be used for the post-hoc analysis
of any term of linear models (univariate or multivariate), generalized and mixed
linear models.  The function <code>testFactors</code> provides a flexible user
interface for defining combinations of factor levels and covariates, to evaluate
and test the model, using the function <code>linearHypothesis</code> from package
<span class="pkg">car</span>.  <code>testInteractions</code> uses this function for multiple comparisons 
of simple effects, interaction residuals, interaction contrasts, or user-defined
contrasts. <code>interactionMeans</code> may be used to explore the &lsquo;cell 
means&rsquo; of factorial designs, and plot main effects or first-order interactions.
</p>


<h3>Author(s)</h3>

<p>Helios De Rosario-Martinez, with code contributions from John Fox (package
<span class="pkg">car</span>) and the R Core Team (<span class="pkg">stats</span> package).
</p>
<p>Maintainer: Helios De Rosario-Martinez &lt;helios.derosario@gmail.com&gt;
</p>

<hr>
<h2 id='Boik'>Contrived Data of Treatments for Hemophobia</h2><span id='topic+Boik'></span>

<h3>Description</h3>

<p>Data set based on the hypothetical example used by R.J. Boik (1979) to explain the analysis of interaction contrasts.  It represents the electrodermal response of 72 students complaining of hemophobia, treated with different fear reduction therapies and doses of antianxiety medication, in a balanced factorial design.  The observed values of the dependent variable (not given in the original article) are contrived so that the results of all the tests are coherent with the examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Boik</code></pre>


<h3>Format</h3>

<p>A data frame with 72 observations and three columns:
</p>

<dl>
<dt><code>therapy</code></dt><dd><p>Fear reduction therapy. Factor with levels <code>control</code>, <code>T1</code>, <code>T2</code>.</p>
</dd>
<dt><code>medication</code></dt><dd><p>Dose of antianxiety medication. Ordered factor with levels <code>placebo</code>, <code>D1</code>, <code>D2</code>, <code>D3</code>.</p>
</dd>
<dt><code>edr</code></dt><dd><p>Electrodermal response (in arbitrary units).</p>
</dd>
</dl>



<h3>Note</h3>

<p>The anova table in Boik's article (p. 1085) has a misprint in the MS value for &lsquo;Treatment B&rsquo; (medication): it should be 790.32, instead of 970.32.
</p>


<h3>Source</h3>

<p>Boik, R. J. (1979). &lsquo;Interactions, Partial Interactions, and Interaction Contrasts in the Analysis of Variance&rsquo;, <em>Psychological Bulletin</em>,
86(5), 1084-1089.
</p>

<hr>
<h2 id='contrastCoefficients'>
Calculate Coefficient Matrices of Factor Contrasts
</h2><span id='topic+contrastCoefficients'></span>

<h3>Description</h3>

<p>Take symbolic formulas of contrasts across the levels of one or more factors, and return a list of matrices with the corresponding linear combination coefficients, in a suitable form to use in <code>testFactors</code>, or as custom contrasts in <code>testInteractions</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contrastCoefficients(..., contrast.definitions,
	data=parent.frame(), normalize=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="contrastCoefficients_+3A_...">...</code>, <code id="contrastCoefficients_+3A_contrast.definitions">contrast.definitions</code></td>
<td>
<p>definitions of the contrasts.</p>
</td></tr>
<tr><td><code id="contrastCoefficients_+3A_data">data</code></td>
<td>
<p>list, data frame or environment that contains the factors symbolically represented in the contrast definitions.</p>
</td></tr>
<tr><td><code id="contrastCoefficients_+3A_normalize">normalize</code></td>
<td>
<p>logical value: should the coefficients be normalized to unit norm?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the context of this function, a &ldquo;contrast&rdquo; means a linear combination of factor levels (regardless of the dummy coefficients that are used to code those levels in fitted models).  For a factor <code>f</code> with three levels <code>f1</code>, <code>f2</code>, <code>f3</code>, this could be a single level (e.g. <code>f ~ f1</code>), a &ldquo;pairwise&rdquo; contrast (e.g. <code>f ~ f1 - f2</code>), an average (e.g. <code>f ~ (f1 + f2 + f3) / 3</code>), or any other linear combination.  Such arithmetic operations are usually applied to the values of a dependent variable, conditioned to the value of the represented factor, but those symbolic representations, as if the levels of the factors were themselves combined, are useful abstractions that may come in handy to define hypotheses about the effects of the factor.
</p>
<p>This function takes one or more formulas of that type, and returns matrices of the linear coefficients that define such contrasts. For the previous examples, it would return the column matrices <code>list(f=matrix(c(f1=1, f2=0, f3=0)))</code>, <code>list(f=matrix(c(f1=1, f2=-1, f3=0)))</code>, and <code>list(f=matrix(c(f1=0.333, f2=-0.333, f3=0.333)))</code>, respectively.  The factors must be defined in the data frame, list, or environment given in <code>data</code>, with the name provided in the right hand side of the formulas.  By default this is the <code>parent.frame</code>, which in normal interactive use is the global environment.
</p>
<p>The contrast matrices are returned in a named list, where the names are the represented factors, as required by the arguments <code>levels</code> and <code>custom</code> of the functions <code>testFactors</code> and <code>testInteractions</code>, respectively.  When more than one formula is given for the same factor, all the corresponding columns of coefficients are bound into a single matrix.
</p>
<p>Other ways of representing contrasts, allowed by <code>testFactors</code> and <code>testInteractions</code>, can also be mixed with the formulas as input arguments.  Such alternative contrast definitions are just appended without changes in the returned list, after the matrices created from the formulas.  (Notice that if other coefficient vectors or matrices are explicitly entered, these will not be combined with the ones calculated from formulas.)
</p>
<p>In case of having the contrast definitions stored in a list, that list can be entered as the argument <code>contrast.definitions</code>.  This option is recommended if the contrast definitions are mixed with named elements which could create a conflict with <code>data</code>, <code>normalize</code>, or <code>contrast.definitions</code> itself (although this is unlikely to happen specially if all the definitions are given as formulas).  In any event, only one alternative of entering the definitions is allowed. If <code>contrast.definitions</code> is given, all the other definitions are ignored with a warning.
</p>


<h3>Value</h3>

<p>A named list, where each element has the name of a factor, and contains a numeric matrix with the contrast coefficients. Each row of such matrices is associated to a level of the factor, in the order given by <code><a href="base.html#topic+levels">levels</a></code>.
</p>


<h3>Author(s)</h3>

<p>Helios De Rosario-Martinez, <a href="mailto:helios.derosario@gmail.com">helios.derosario@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+testFactors">testFactors</a></code>, <code><a href="#topic+interactionMeans">interactionMeans</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Calculate the coefficients of example(testInteractions)
# cntrl.vs.T1 &lt;- list(therapy = c(1, -1, 0))
contrastCoefficients(therapy ~ control - T1, data = Boik)
# cntrl.vs.T2 &lt;- list(therapy = c(1, 0, -1))
contrastCoefficients(therapy ~ control - T2, data = Boik)
# plcb.vs.doses &lt;- list(medication = c(1, -1/3, -1/3, -1/3))
contrastCoefficients(medication ~ placebo - (D1+D2+D3)/3, data = Boik)
# Combine cntrl.vs.T1 and plcb.vs.doses
contrastCoefficients(
  therapy ~ control - T1, medication ~ placebo - (D1+D2+D3)/3, data = Boik)

# Put various contrasts of the same factor in a matrix, and normalize them
contrastCoefficients(
	therapy ~ control - T1,
	therapy ~ control - T2,
	medication ~ placebo - (D1+D2+D3)/3,
	data = Boik,
	normalize=TRUE)
</code></pre>

<hr>
<h2 id='interactionMeans'>
Calculate and Plot Adjusted Means for Interactions
</h2><span id='topic+interactionMeans'></span><span id='topic+plot.interactionMeans'></span>

<h3>Description</h3>

<p>Creates a data frame with the adjusted means of a fitted model or the slopes associated to its covariates, plus the standard error of those values, for all the interactions of given factors, including intra-subjects factors in multivariate linear models with intra-subjects designs.  These interactions may be plotted by pairs of factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interactionMeans(model, factors=names(xlevels), slope=NULL, ...)
## S3 method for class 'interactionMeans'
plot(x, atx=attr(x,"factors"), traces=atx, xlab=atx,
  ylab="", main=NULL, multiple=TRUE, y.equal=FALSE, legend=TRUE, legend.margin=0.2,
  cex.legend=1, abbrev.levels=FALSE, type="b", pch=0:6, errorbar, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interactionMeans_+3A_model">model</code></td>
<td>
<p>fitted model. Currently supported classes include <code>"lm"</code>, <code>"glm"</code>, <code>"mlm"</code>, <code>"lme"</code>, and <code>"mer"</code> or <code>"merMod"</code> (excluding models fitted by <code>nlmer</code>).</p>
</td></tr>
<tr><td><code id="interactionMeans_+3A_factors">factors</code></td>
<td>
<p>character vector with the names of interacting factors.  All the factors of the model are used by default; use <code>NULL</code> for calculating the overall mean.</p>
</td></tr>
<tr><td><code id="interactionMeans_+3A_slope">slope</code></td>
<td>
<p>character vector with the names of the interacting covariates associated to the slope that will be represented; if it is <code>NULL</code> (the default value), the function will calculate adjusted mean values.</p>
</td></tr>
<tr><td><code id="interactionMeans_+3A_x">x</code></td>
<td>
<p>an object created by the function <code>interactionMeans</code>.</p>
</td></tr>
<tr><td><code id="interactionMeans_+3A_atx">atx</code></td>
<td>
<p>character vector with the names of factors that will be represented in the horizontal axis of the plots.  All the factors represented in <code>x</code> are used by default.</p>
</td></tr>
<tr><td><code id="interactionMeans_+3A_traces">traces</code></td>
<td>
<p>character vector with the names of the factors that will be represented as different traces in a plot (the same as <code>atx</code> by default).</p>
</td></tr>
<tr><td><code id="interactionMeans_+3A_xlab">xlab</code>, <code id="interactionMeans_+3A_ylab">ylab</code>, <code id="interactionMeans_+3A_main">main</code></td>
<td>
<p>values to override the default titles of plots and their axes (see <em>Details</em>).</p>
</td></tr>
<tr><td><code id="interactionMeans_+3A_multiple">multiple</code></td>
<td>
<p>logical indicating if the plots shall be combined in multi-panel figures.</p>
</td></tr>
<tr><td><code id="interactionMeans_+3A_y.equal">y.equal</code></td>
<td>
<p>logical indicating if all the plots should have the same range in the y-axis (all plots would be expanded to the maximum range).</p>
</td></tr>
<tr><td><code id="interactionMeans_+3A_legend">legend</code></td>
<td>
<p>logical indicating if legends should be drawn in case of plots with multiple traces.</p>
</td></tr>
<tr><td><code id="interactionMeans_+3A_legend.margin">legend.margin</code></td>
<td>
<p>fraction of the combined plotting area that shall be reserved for drawing the legends, if they are required.</p>
</td></tr>
<tr><td><code id="interactionMeans_+3A_cex.legend">cex.legend</code></td>
<td>
<p>character expansion for the legend, relative to the value of <code><a href="graphics.html#topic+par">par</a>("cex")</code>.</p>
</td></tr>
<tr><td><code id="interactionMeans_+3A_abbrev.levels">abbrev.levels</code></td>
<td>
<p>A logical indicating whether the factor levels are to be abbreviated in the plot, or an integer that specifies the minimum length of such abbreviations. See <code><a href="base.html#topic+abbreviate">abbreviate</a></code>.</p>
</td></tr>
<tr><td><code id="interactionMeans_+3A_type">type</code>, <code id="interactionMeans_+3A_pch">pch</code></td>
<td>
<p>type of plot and point characters, as used by <code><a href="graphics.html#topic+matplot">matplot</a></code>.</p>
</td></tr>
<tr><td><code id="interactionMeans_+3A_errorbar">errorbar</code></td>
<td>
<p>definition of the error bars in the plots (see <em>Details</em>).</p>
</td></tr>
<tr><td><code id="interactionMeans_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="#topic+testFactors">testFactors</a></code> or <code><a href="graphics.html#topic+matplot">matplot</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the adjusted values of the model and their standard errors for interactions between factors, at fixed values of covariates, if they exist.  The main or crossed effect of covariates is represented by their &ldquo;slope&rdquo;, i.e. the variation rate of the response with respect to the product of the specified covariates.  The default value of the covariates (and of the offset, if any) is their average in the model data frame, and it can be changed by the arguments <code>covariates</code> or <code>offset</code>, passed down to <code><a href="#topic+testFactors">testFactors</a></code>.  Note that in generalized linear models, standard errors and slopes are referred to the link function, not to the mean (see <code><a href="#topic+testFactors">testFactors</a></code> for details, and how to force the calculation of the link function instead of the response for adjusted means).
</p>
<p>In multivariate linear models, the adjusted means or slopes are calculated separately for each column by default, but it is possible to define an intra-subjects design of factors across columns, and put all columns in one.  This may be defined by the argument <code>idata</code> passed down to <code><a href="#topic+testFactors">testFactors</a></code> (see <code><a href="car.html#topic+Anova">Anova</a></code> or <code><a href="car.html#topic+linearHypothesis">linearHypothesis</a></code> in package <span class="pkg">car</span> for further details).  If such transformation is done, it is also possible to include the factors of the intra-subjects design in <code>factors</code>, for calculating their main effects or interactions. 
</p>
<p>The generic <code>plot</code> function creates matrices of interaction plots, with the main effects of each factor represented in the diagonal, and the interactions between each pair of factors in the rest of panels.  For multivariate models without intra-subjects design, a new device for each variable will be created. By default it also prints error bars around the means, plus/minus their standard errors.  The size of the error bars can be adjusted by the argument <code>errorbar</code>.  Currently supported definitions are strings with the pattern <code>ciXX</code>, where <code>XX</code> is a number between 01 and 99, standing for the $XX
</p>
<p>The adjusted means and error bars of generalized models (fitted with <code>glm</code> or <code>glmer</code>) are plotted on the scale of the link function, although the y-axis is labelled on the scale of the response (unless the link function had been forced in the calculation of the means).
</p>
<p>If the interactions involve many factors, it may be convenient to plot each panel in a different device (with <code>multiple=FALSE</code>), or select a subset of factors to be plotted with the arguments <code>atx</code> and <code>traces</code>.  A panel will be plotted for each pair of factors defined by crossing these arguments; if the crossed factors are the same one, that panel will show its main effect.
</p>
<p>By default, the interaction plots show the names of the factors on the labels of their x-axes (only for the bottom row of panels, if there is more than one). Those labels can be overriden by the argument <code>xlab</code>, which should be a character vector with as many strings as the number of factors of the model (or the number of factors indicated in <code>atx</code>). The string passed as <code>ylab</code> will be used as the label of the y-axes on the left column of panels (no label is printed by default). The default main titles of the plots are the names of the dependent variables (e.g. &quot;adjusted mean&quot;), but they can be also replaced by a string passed in the argument <code>main</code>, which will be used for all the variables if there is more than one.
</p>


<h3>Value</h3>

<p><code>interactionMeans</code> returns an object of class <code>"interactionMeans"</code>, that contains a data frame with the factor interactions and the means or slopes of the model adjusted to them, and some attributes used for plotting.
</p>


<h3>Note</h3>

<p>The purpose of the <code>plot</code> method is similar to the function <code><a href="stats.html#topic+interaction.plot">interaction.plot</a></code>, but it uses the lower-level function <code><a href="graphics.html#topic+matplot">matplot</a></code>, so the aspect of the plots is different.
</p>


<h3>Author(s)</h3>

<p>Helios De Rosario-Martinez, <a href="mailto:helios.derosario@gmail.com">helios.derosario@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+testFactors">testFactors</a></code>, <code><a href="#topic+interactionMeans">interactionMeans</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Interaction between two factors
# See ?Adler for a description of the data set

mod.adler &lt;- lm(rating ~ instruction * expectation, data=Adler)
(means.adler &lt;- interactionMeans(mod.adler))
plot(means.adler, abbrev.levels=TRUE)


# Effect of factors on the slopes of the model
# See ?SLID for a description of the data set

SLID$logwages &lt;- log2(SLID$wages)
mod.slid &lt;- lm(logwages ~ education + age * (sex  * language), data=SLID)
(slopes.slid &lt;- interactionMeans(mod.slid, slope="age"))
plot(slopes.slid)


# Include intra-subjects factors
# See ?OBrienKaiser for a description of the data set

mod.ok &lt;- lm(cbind(pre.1, pre.2, pre.3, pre.4, pre.5, 
                     post.1, post.2, post.3, post.4, post.5, 
                     fup.1, fup.2, fup.3, fup.4, fup.5) ~  treatment*gender, 
                data=OBrienKaiser)

# Intra-subjects data:
phase &lt;- factor(rep(c("pretest", "posttest", "followup"), each=5))
hour &lt;- ordered(rep(1:5, 3))
idata &lt;- data.frame(phase, hour)

# Calculate all interactions, but plot only the interactions between
# hour (represented in the x-axis) and the other factors (in traces)

means.ok &lt;- interactionMeans(mod.ok, idata=idata)
plot(means.ok, atx="hour", traces=c("gender","treatment","phase"))
</code></pre>

<hr>
<h2 id='Keselman'>Repeated-Measures Pyschopsychological Experiment</h2><span id='topic+Keselman'></span><span id='topic+Keselman1'></span><span id='topic+Keselman2'></span>

<h3>Description</h3>

<p>This data set represents the outcome of an hypothetical experiment, that recorded psychophysiological measures of subjects with different susceptibility
to stressors.  Each subject performed a task at four different levels of challenge.  Data artificially generated from a multivariate lognormal distribution, with unequal variances and covariance structure related to group sample sizes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Keselman1
Keselman2
</code></pre>


<h3>Format</h3>

<p><code>Keselman1</code> is a data frame of 156 rows and 4 columns, with the measures of 39 subjects in a balanced design.
</p>
<p><code>Keselman2</code> is an unbalanced subset of <code>Keselman1</code>, with 120 rows and 4 columns, corresponding to the measures of 30 subjects.
</p>
<p>Both data frames contain the following variables:
</p>

<dl>
<dt><code>subject</code></dt><dd><p>Integer identity of the subject.</p>
</dd>
<dt><code>group</code></dt><dd><p>Classification of the subjects according to their susceptbility to stressors. Factor with levels <code>G1</code>, <code>G2</code>, and <code>G3</code>.</p>
</dd>
<dt><code>challenge</code></dt><dd><p>Level of challenge of the task. Ordered factor with levels <code>M1</code>, <code>M2</code>, <code>M3</code>, <code>M4</code>.</p>
</dd>
<dt><code>measure</code></dt><dd><p>Psychophisiological measure.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Keselman, H. J. (1998) &lsquo;Testing treatment effects in repeated measures designs: an update for psychophysiological researchers&rsquo;. <em>Psychophysiology</em>, 35(4), 470-478.
</p>

<hr>
<h2 id='Rosnow'>Rosnow's and Rosenthal's Baseball Performance Data</h2><span id='topic+Rosnow'></span>

<h3>Description</h3>

<p>Contrived data set of an hypothetical study about the efficacy of a new training method for improving the performance of baseball players.  2x2 factorial design with two factors: training method and expertise of the player.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rosnow</code></pre>


<h3>Format</h3>

<p>A  data frame with 36 observations and three columns:
</p>

<dl>
<dt><code>method</code></dt><dd><p>Training method. Factor with levels <code>control</code> and <code>Ralphing</code>.</p>
</dd>
<dt><code>experience</code></dt><dd><p>Experience of the player in championship competition. Factor with levels <code>no</code>, <code>yes</code>.</p>
</dd>
<dt><code>hits</code></dt><dd><p>Performance scores, measured as total number of hits in an experimentally devised game.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Rosnow, R. L., &amp; Rosenthal, R. (1989). &lsquo;Definition and Interpretation of Interaction Effects&rsquo;, <em>Psychological Bulletin</em>, 105(1), 143-146.
</p>

<hr>
<h2 id='testFactors'>
Evaluate and Test Combinations of Factor Levels
</h2><span id='topic+testFactors'></span><span id='topic+testFactors.default'></span><span id='topic+testFactors.lm'></span><span id='topic+testFactors.glm'></span><span id='topic+testFactors.mlm'></span><span id='topic+testFactors.lme'></span><span id='topic+testFactors.mer'></span><span id='topic+testFactors.merMod'></span><span id='topic+summary.testFactors'></span>

<h3>Description</h3>

<p>Calculates and tests the adjusted mean value of the response and other terms of a fitted model, for specific linear combinations of factor levels and specific values of the covariates.  This function is specially indicated for post-hoc analyses of models with factors, to test pairwise comparisons of factor levels, simple main effects, and interaction contrasts.  In multivariate models, it is possible to define and test contrasts of intra-subjects factors, as in a repeated-measures analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
testFactors(model, levels, covariates, offset, terms.formula=~1,
  inherit.contrasts=FALSE,  default.contrasts=c("contr.sum","contr.poly"),
  lht=TRUE, ...)
## S3 method for class 'lm'
testFactors(model, ...)
## S3 method for class 'glm'
testFactors(model, ..., link=FALSE)
## S3 method for class 'mlm'
testFactors(model, levels, covariates, offset, terms.formula=~1,
  inherit.contrasts=FALSE, default.contrasts=c("contr.sum","contr.poly"),
  idata, icontrasts=default.contrasts, lht=TRUE, ...)
## S3 method for class 'lme'
testFactors(model, ...)
## S3 method for class 'mer'
testFactors(model, ..., link=FALSE)
## S3 method for class 'merMod'
testFactors(model, ..., link=FALSE)
## S3 method for class 'testFactors'
summary(object, predictors=TRUE, matrices=TRUE, covmat=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testFactors_+3A_model">model</code></td>
<td>
<p>fitted model. Currently supported classes include <code>"lm"</code>, <code>"glm"</code>, <code>"mlm"</code>, <code>"lme"</code>, and <code>"mer"</code> or <code>"merMod"</code> (excluding models fitted by <code>nlmer</code>).</p>
</td></tr>
<tr><td><code id="testFactors_+3A_levels">levels</code></td>
<td>
<p>list that defines the factor levels that will be contrasted; see the <em>Details</em> for more information.</p>
</td></tr>
<tr><td><code id="testFactors_+3A_covariates">covariates</code></td>
<td>
<p>optional numeric vector with specific values of the covariates (see <em>Details</em>).</p>
</td></tr>
<tr><td><code id="testFactors_+3A_offset">offset</code></td>
<td>
<p>optional numeric value with a specific value of the offset (if any).</p>
</td></tr>
<tr><td><code id="testFactors_+3A_terms.formula">terms.formula</code></td>
<td>
<p>formula that defines the terms of the model that will be calculated and tested.  The default value is ~1, and stands for the adjusted mean value.  See the <em>Details</em> for more information.</p>
</td></tr>
<tr><td><code id="testFactors_+3A_inherit.contrasts">inherit.contrasts</code></td>
<td>
<p>logical value:  should the default contrasts of model factors be inherited from the model data frame?</p>
</td></tr>
<tr><td><code id="testFactors_+3A_default.contrasts">default.contrasts</code></td>
<td>
<p>names of contrast-generating functions to be applied by default to factors and ordered factors, respectively, if <code>inherit.contrasts</code> is <code>FALSE</code> (the default); the contrasts must produce an intra-subjects model matrix in which different terms are orthogonal.  The default is <code>c("contr.sum", "contr.poly")</code>.</p>
</td></tr>
<tr><td><code id="testFactors_+3A_lht">lht</code></td>
<td>
<p>logical indicating if the adjusted values are tested (via <code><a href="car.html#topic+linearHypothesis">linearHypothesis</a>).</code></p>
</td></tr>
<tr><td><code id="testFactors_+3A_link">link</code></td>
<td>
<p>for models fitted with <code>glm</code> or <code>glmer</code>, logical indicating if the adjusted mean values should represent the link function (<code>FALSE</code> by default, i.e. represent the adjusted means of the response variable).</p>
</td></tr>
<tr><td><code id="testFactors_+3A_idata">idata</code></td>
<td>
<p>an optional data frame giving a factor or factors defining the intra-subjects model for multivariate repeated-measures data, as defined in <code><a href="car.html#topic+Anova">Anova</a></code> or <code><a href="car.html#topic+linearHypothesis">linearHypothesis</a></code>.</p>
</td></tr>
<tr><td><code id="testFactors_+3A_icontrasts">icontrasts</code></td>
<td>
<p>names of contrast-generating functions to be applied in the within-subject &ldquo;data&rdquo;.  The default is the same as <code>default.contrasts</code>.</p>
</td></tr>
<tr><td><code id="testFactors_+3A_object">object</code></td>
<td>
<p>object returned by <code><a href="#topic+testFactors">testFactors</a></code>.</p>
</td></tr>
<tr><td><code id="testFactors_+3A_predictors">predictors</code></td>
<td>
<p>logical value: should <code><a href="base.html#topic+summary">summary</a></code> return the values of the predictor values used in the calculations?</p>
</td></tr>
<tr><td><code id="testFactors_+3A_matrices">matrices</code></td>
<td>
<p>logical value: should <code><a href="base.html#topic+summary">summary</a></code> return the matrices used for testing by <code><a href="car.html#topic+linearHypothesis">linearHypothesis</a></code>?</p>
</td></tr>
<tr><td><code id="testFactors_+3A_covmat">covmat</code></td>
<td>
<p>logical value: should <code><a href="base.html#topic+summary">summary</a></code> return the covariance matrix of the adjusted values?</p>
</td></tr>
<tr><td><code id="testFactors_+3A_...">...</code></td>
<td>
<p>other arguments passed down to <code><a href="car.html#topic+linearHypothesis">linearHypothesis</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The only mandatory argument is <code>model</code>, which may include any number of factor or numeric predictors, and one offset.  The simplest usage of this method, where no other argument is defined, calculates the adjusted mean of the model response variable, pooling over all the levels of factor predictors, and setting the numeric predictors (covariates and offset, ifany) to their average values in the model data frame.
</p>
<p>The calculations will be done for the linear combinations of factor levels defined by <code>levels</code>.  This argument must be a list, with one element for each factor of the model that has to be manipulated (including factors of the intra-subjects design, if suitable).  The factors that are not represented in this list will be pooled over, and elements that do not correspond to any factor of the model will be ignored with a warning.  <code>levels</code> may be a named list, where the name of each element identifies the represented factor, and its contents may be one of the following:
</p>

<ol>
<li><p>A character string of length 1 or 2, with the name of one or two factor levels.  In the former case, the calculations will be restricted to this level of the factor, as in a simple main effects analysis; in the latter, a pairwise contrast will be calculated between both factor levels.
</p>
</li>
<li><p>A numeric vector without names, as long as the number of levels in the factor.  This will create a linear combination of factor levels, with the elements of the vector as coefficients.  For instance, if the factor <code>f</code> has three levels, an element <code>f=c(0.5, 0.5, 0)</code> will average the two first levels, and <code>f=c(0.5, 0.5, -1)</code> will contrast the average of the two first levels against the third one.
</p>
</li>
<li><p>A numeric vector with names equal to some or all the levels of the factor.  This is a simplification of the previous option, where some levels can be omitted, and the coefficient of each level is determined by the names of the vector, which do not have to follow a specific order.  Omitted levels will automatically be set to zero.
</p>
</li>
<li><p>A numeric matrix, as an extension of the two previous options for calculating several combinations at a time.  Combinations are defined in columns, so if the matrix does not have row names, the number of rows must be equal to the number of levels in the factor, or if the matrix does have row names, they must coincide with the levels of the factor.
</p>
</li></ol>

<p>Alternatively, <code>levels</code> may be a single formula or an unnamed list of formulas, of the type <code>factorname ~ K1*level1 + K2*level2 ...</code> (see <code><a href="#topic+contrastCoefficients">contrastCoefficients</a></code> for further details).  Both types of lists (named list of string or numeric vectors and matrices, and unnamed lists of formulas) may be mixed.
</p>
<p>The argument <code>covariates</code> may be used for setting specific values of the model numeric predictors (covariates).  It must be a vector of numeric values.  If the elements of this vector have names, their values will be assigned to the covariates that match them; covariates of the model with names not represented in this vector will be set to their default value (the average in the model data frame), and elements with names that do not match with covariates will be ignored.  On the other hand, if <code>covariates</code> has no names, and its length is equal to the number of covariates of the model, the values will be assigned to those covariates in the same order as they occur in the model.  If it has a different length, the vector will be trimmed or reclycled as needed to fit the number of covariates in the model; this feature may be used, for instance, to set all covariates to the same value, e.g. <code>covariates = 0</code>.  The argument <code>offset</code> can likewise be used to define a specific value for the offset of the model.
</p>
<p>To analyse terms other than the adjusted mean value of the response, use the argument <code>terms.formula</code>.  For instance, if the model has the covariates <code>var1</code>, <code>var2</code>, ..., the slopes of the response with respect to them may be added to the analysis by defining <code>terms.formula</code> as <code>~var1 + var2 ...</code>.  This formula may be used more generally, for analysing interactions, omitting the mean response, adding the main effects of factors, etc.  A different analysis is done for each term of this formula, that must also be contained in the formula of <code>model</code>.  For instance, if <code>terms.formula</code> is equal to <code>~ var1*var2</code>, the function will analyse the adjusted intercept, plus the terms <code>var1</code>, <code>var2</code>, and <code>var1:var2</code>.  The intercept stands for the mean value of the response, and terms formed by one or more covariates stand por the slope of the response with respect to the product of those covariates.
</p>
<p>If any of the variables in the term is a factor, the function analyses a full set of contrasts for that factor of the remaining part of the term; for instance if <code>var1</code> were a factor, the term <code>var1</code> would stand for the contrasts of the intercept, and <code>var1:var2</code> would stand for the contrasts of the slope <code>var2</code>, across the levels of <code>var1</code>.  The set of contrasts used in the analysis is normally defined by the argument <code>default.contrasts</code>: by default, if the factor is ordered it will be a set of &ldquo;polynomial contrasts&rdquo;, and otherwise &ldquo;sum contrasts&rdquo;; however, if <code>inherit.contrasts</code> is <code>TRUE</code> the contrasts will directly be copied from the ones used to define the model.  Factors that have explicit contrasts defined in the model data frame will use those contrasts, regardless of the values defined for <code>default.contrasts</code> and <code>inherit.contrasts</code>.  The analysis assumes that the contrasts are orthogonal to the intercept, which is the usual case if the default arguments are provided, and a warning will be issued if non-orthogonal contrasts are used; take special care of not using &ldquo;treatment contrats&rdquo; if <code>inherit.contrasts</code> is set to <code>TRUE</code> or <code>default.contrasts</code> is changed. 
</p>
<p>In generalized linear models, the adjusted means represent the expected values of the response by default, but the expected value of the link function may be shown by setting the argument <code>link=FALSE</code>.  On the other hand, slope values and standard errors always refer to the link function.
</p>
<p>For multivariate models, the arguments <code>idata</code>, and <code>icontrasts</code> may be used to define an intra-subjects model for multivariate repeated-measures data, as described for <code><a href="car.html#topic+Anova">Anova</a></code> or <code><a href="car.html#topic+linearHypothesis">linearHypothesis</a></code> in package <span class="pkg">car</span>.  Note, however, that the combinations of intra-subjects factor levels are defined in <code>levels</code>, and other arguments defined in those functions like <code>idesign</code>, <code>imatrix</code> or <code>iterms</code> will have no effect in <code>testFactors</code>.
</p>
<p>The significance of adjusted values is tested by a call to <code><a href="car.html#topic+linearHypothesis">linearHypothesis</a></code> for each term, unless <code>lht</code> is set to <code>FALSE</code>.  Extra arguments may be passed down to that function, for instance to specify the test statistic that will be evaluated.
</p>


<h3>Value</h3>

<p>An object of class <code>"testFactors"</code>, that contains the adjusted values and their standard errors for each term, and the otuput of the test, plus other variables used in the calculations.  The <code><a href="base.html#topic+summary">summary</a></code> method for this object will display those variables, unless they be omitted by setting the optional arguments <code>predictors</code>, <code>matrices</code> or <code>covmat</code> to <code>FALSE</code>.  The argument <code>predictors</code> refers to the coefficients of specified combinations of factor levels, the values of covariates, and the contrast matrices used for terms that include factors; <code>matrices</code> refers to the &ldquo;linear hypothesis matrix&rdquo; used by <code><a href="car.html#topic+linearHypothesis">linearHypothesis</a></code>, and in multivariate linear models, to the &ldquo;response transformation matrix&rdquo; as well &mdash; if it exists; <code>covmat</code> refers to the variance-covariance matrix of the adjusted values.
</p>
<p>Moreover, <code><a href="base.html#topic+summary">summary</a></code> groups the results of the tests for all terms in one table.  By default this table shows the test statistics, their degrees of freedom, and the <em>p</em>-values.  If the model is of class <code>"lm"</code>, it also shows the sums of squares; and if it is of class <code>"mlm"</code>, only the first type of test statistic returned by <code><a href="car.html#topic+linearHypothesis">linearHypothesis</a></code> (by default &ldquo;Pillai&rdquo;) is shown.  This variable shape of the ANOVA table is controlled by additional classes assigned to the object (either <code>"testFactors.lm"</code> or <code>"testFactors.mlm"</code>, as suitable).
</p>


<h3>Note</h3>

<p>The tests of mixed models are done under the assumption that the estimation of the random part of the model is exact.
</p>


<h3>Author(s)</h3>

<p>Helios De Rosario-Martinez, <a href="mailto:helios.derosario@gmail.com">helios.derosario@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="car.html#topic+linearHypothesis">linearHypothesis</a></code> in package <span class="pkg">car</span>.
<code><a href="#topic+interactionMeans">interactionMeans</a></code>, and <code><a href="#topic+testInteractions">testInteractions</a></code> as useful wrappers of <code>testFactors</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example with factors and covariates
# Analyse prestige of Canadian occupations depending on
# education, income and type of occupation
# See ?Prestige for a description of the data set

prestige.mod &lt;- lm(prestige ~ (education+log2(income))*type, data=Prestige)

# Pairwise comparisons for factor "type", to see how it influences
# the mean value of  prestige and interacts with log.income

# 1: "white collar" vs "blue collar"
wc.vs.bc &lt;- list(type=c("wc", "bc"))
testFactors(prestige.mod, wc.vs.bc, terms.formula=~log2(income))
# 2: "professional" vs. "blue collar"
prof.vs.bc &lt;- list(type=c("prof", "bc"))
testFactors(prestige.mod, prof.vs.bc, terms.formula=~log2(income))
# 3: "professional" vs. "white collar"
prof.vs.wc &lt;- list(type=c("prof", "wc"))
testFactors(prestige.mod, prof.vs.wc, terms.formula=~log2(income))


# Interaction contrasts in a repeated-measures experiment
# See ?OBrienKaiser for a description of the data set

mod.ok &lt;- lm(cbind(pre.1, pre.2, pre.3, pre.4, pre.5, 
  post.1, post.2, post.3, post.4, post.5, 
  fup.1, fup.2, fup.3, fup.4, fup.5) ~  treatment*gender, 
  data=OBrienKaiser)

# intra-subjects data:
phase &lt;- factor(rep(c("pretest", "posttest", "followup"), each=5))
hour &lt;- ordered(rep(1:5, 3))
idata &lt;- data.frame(phase, hour)
Anova(mod.ok, idata=idata, idesign=~phase*hour)

# Contrasts across "phase", for different contrasts of "treatment"
# Using different definitions of the argument "levels"

# 1: Treatment "A" vs. treatment "B".
A.vs.B &lt;- list(treatment=c("A", "B"))
# The following are equivalent:
# A.vs.B &lt;- list(treatment=c(A=1, B=-1, control=0))
# A.vs.B &lt;- list(treatment=c(A=1, B=-1))
# A.vs.B &lt;- list(treatment ~ A - B)
# A.vs.B &lt;- treatment ~ A - B
testFactors(mod.ok, A.vs.B, idata=idata, terms.formula=~0+phase)

# 2: Controls vs. treatments
control.vs.AB &lt;- list(treatment=c(A=0.5, B=0.5, control=-1))
# The following is equivalent:
# control.vs.AB &lt;- treatment ~ (A+B)/2 - control
testFactors(mod.ok, control.vs.AB, idata=idata, terms.formula=~0+phase)

# Shortcut to get only the adjusted values and simplified ANOVA tables
contr &lt;- list(A.vs.B=A.vs.B, control.vs.AB=control.vs.AB)
anovaTables &lt;- function(contrast) summary(testFactors(mod.ok, contrast,
  idata=idata, terms.formula=~0+phase),
  predictors=FALSE, matrices=FALSE)
  
lapply(contr,anovaTables)
</code></pre>

<hr>
<h2 id='testInteractions'>
Test Contrasts of Factor Interactions
</h2><span id='topic+testInteractions'></span>

<h3>Description</h3>

<p>Calculates and tests different types of contrasts for factor interactions, in linear, generalized and mixed linear models: simple main effects, interaction contrasts, residual effects, and others.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testInteractions(model, pairwise=NULL, fixed=NULL, residual=NULL, across=NULL,
  custom=NULL, slope=NULL, adjustment=NULL, label.factors=FALSE,
  abbrev.levels=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testInteractions_+3A_model">model</code></td>
<td>
<p>fitted model. Currently supported classes include <code>"lm"</code>, <code>"glm"</code>, <code>"mlm"</code>, <code>"lme"</code>, and <code>"mer"</code> or <code>"merMod"</code> (excluding models fitted by <code>nlmer</code>).</p>
</td></tr>
<tr><td><code id="testInteractions_+3A_pairwise">pairwise</code></td>
<td>
<p>character vector with the names of factors represented by pairwise contrasts.</p>
</td></tr>
<tr><td><code id="testInteractions_+3A_fixed">fixed</code></td>
<td>
<p>character vector with the names of factors represented by fixed levels.</p>
</td></tr>
<tr><td><code id="testInteractions_+3A_residual">residual</code></td>
<td>
<p>character vector with the names of factors represented by residuals effects.</p>
</td></tr>
<tr><td><code id="testInteractions_+3A_across">across</code></td>
<td>
<p>character vector with the names of factors represented by a full set of independent contrasts.</p>
</td></tr>
<tr><td><code id="testInteractions_+3A_custom">custom</code></td>
<td>
<p>list with custom contrasts for other factors. See the <code>Details</code> for more information.</p>
</td></tr>
<tr><td><code id="testInteractions_+3A_slope">slope</code></td>
<td>
<p>character vector with the names of the covariates associated to the slope that will tested; if it is <code>NULL</code> (the default value), the function will test the adjusted mean values.</p>
</td></tr>
<tr><td><code id="testInteractions_+3A_adjustment">adjustment</code></td>
<td>
<p>adjustment method for p-values, as defined in <code><a href="stats.html#topic+p.adjust">p.adjust</a></code>.</p>
</td></tr>
<tr><td><code id="testInteractions_+3A_label.factors">label.factors</code></td>
<td>
<p>If true, the rownames for each row in the resulting table include the name(s) of the factor(s) involved, followed by the level values. Otherwise, the rownames include only the levels of the factor(s), with multiple factors separated by &lsquo;:&rsquo;.</p>
</td></tr>
<tr><td><code id="testInteractions_+3A_abbrev.levels">abbrev.levels</code></td>
<td>
<p>Either a logical or an integer, specifying whether the levels values of the factors in the term are to be abbreviated in constructing the rownames. An integer specifies the minimum length of the abbreviation for each factor in the term.</p>
</td></tr>
<tr><td><code id="testInteractions_+3A_...">...</code></td>
<td>
<p>further arguments passed down to <code><a href="#topic+testFactors">testFactors</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each factor of the model can at most be contained in one of the arguments <code>pairwise</code>, <code>fixed</code>, <code>residual</code>, <code>across</code>, or <code>custom</code>; redundant assignment of factors is not allowed.  If none of these arguments is defined, the default behavior is as if <code>pairwise</code> contained all the factors of the model.  The result will show a set of tests on the model adjusted mean, at different combinations of factor levels.  If there are covariates defined in <code>slope</code>, the test will apply to the slope for the interaction of such covariates.  Each row will contain a different combination of factor levels or contrasts, depending on the argument wherein the factor has been defined:
</p>

<ul>
<li><p>The factors contained in <code>pairwise</code> will appear as pairwise contrasts between levels.
</p>
</li>
<li><p>The factors contained in <code>fixed</code> will appear as one of their possible levels.
</p>
</li>
<li><p>The factors contained in <code>residual</code> will appear as residual effects of their levels, after removing effects of higher order.
</p>
</li>
<li><p>The factors contained in <code>across</code> will appear as a full set of contrasts. By default they will be orthogonal contrasts, unless overriden by the contrasts of the model data frame or by the arguments passed down to <code><a href="#topic+testFactors">testFactors</a></code>.  See the documentation of that function for further details.
</p>
</li></ul>

<p>Ommitted factors will be averaged across all their levels. Thus, to test the overall adjusted means or slopes, use <code>pairwise=NULL</code> (or do the same with any of the arguments of the previous list).
</p>
<p>Other combinations of factor levels can be defined by <code>custom</code>.  This argument should be a list of numeric matrices or vectors, named as the model factors.  Each matrix must have as many rows as the number of levels of the corresponding factor, so that each column represents a linear combination of such levels that will be tested, crossed with the combinations of the other factors.  Vectors will be treated as column matrices.
</p>
<p>In multivariate linear models it is possible to define an intra-subjects design, with the argument <code>idata</code> passed down to <code><a href="#topic+testFactors">testFactors</a></code> (see <code><a href="car.html#topic+Anova">Anova</a></code> or <code><a href="car.html#topic+linearHypothesis">linearHypothesis</a></code> in package <span class="pkg">car</span> for further details).  The factors defined by that argument can be included as any other factor of the model.
</p>


<h3>Value</h3>

<p>An anova table with one row for each different combination of levels and contrasts defined in <code>pairwise</code>, <code>fixed</code>, <code>across</code>, and <code>custom</code>.  The rownames represent the specific levels or contrasts used for the different factors, separated by &lsquo;:&rsquo;. These names can be tweaked by the arguments <code>label.factors</code> and <code>abbrev.levels</code>, as done by <code>termMeans</code> in package <span class="pkg">heplots</span>.
</p>


<h3>Note</h3>

<p>The tests of mixed models are done under the assumption that the estimation of the random part of the model is exact.</p>


<h3>Author(s)</h3>

<p>Helios De Rosario-Martinez, <a href="mailto:helios.derosario@gmail.com">helios.derosario@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+testFactors">testFactors</a></code>, <code><a href="#topic+interactionMeans">interactionMeans</a></code>.
Use <code><a href="#topic+contrastCoefficients">contrastCoefficients</a></code> as a facility to create matrices of custom contrasts.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Tests of the interactions described in Boik (1979)
# See ?Boik for a description of the data set

mod.boik &lt;- lm(edr ~ therapy * medication, data=Boik)
Anova(mod.boik)
cntrl.vs.T1 &lt;- list(therapy = c(1, -1, 0))
cntrl.vs.T2 &lt;- list(therapy = c(1, 0, -1))
plcb.vs.doses &lt;- list(medication = c(1, -1/3, -1/3, -1/3))
testInteractions(mod.boik, pairwise="therapy", adjustment="none")
testInteractions(mod.boik, custom=plcb.vs.doses, adjustment="none")
testInteractions(mod.boik, custom=cntrl.vs.T1, across="medication", adjustment="none")
testInteractions(mod.boik, custom=c(cntrl.vs.T1, plcb.vs.doses), adjustment="none")
testInteractions(mod.boik, custom=cntrl.vs.T2, across="medication", adjustment="none")
testInteractions(mod.boik, custom=plcb.vs.doses, across="therapy", adjustment="none")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
