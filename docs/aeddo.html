<!DOCTYPE html><html><head><title>Help for package aeddo</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {aeddo}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#aeddo'><p>Automated and Early Detection of Disease Outbreaks</p></a></li>
<li><a href='#aeddo-package'><p>aeddo: Automated and Early Detection of Disease Outbreaks</p></a></li>
<li><a href='#autoplot'><p>Create a complete 'ggplot' appropriate to a particular data type</p></a></li>
<li><a href='#check_aeddo_inputs'><p>Check and assert the inputs for the aeddo function.</p></a></li>
<li><a href='#check_nll_poisson_gamma_inputs'><p>Check and assert the inputs for the nll_poisson_gamma function.</p></a></li>
<li><a href='#nll_poisson_gamma'><p>Negative Log-Likelihood for Poisson Gamma Model</p></a></li>
<li><a href='#plot.aeddo'><p>Create a complete 'ggplot' appropriate to a particular data type</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Automated and Early Detection of Disease Outbreaks</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>A powerful tool for automating the early detection of disease
             outbreaks in time series data. 'aeddo' employs advanced statistical 
             methods, including hierarchical models, in an innovative manner to 
             effectively characterize outbreak signals. It is particularly useful 
             for epidemiologists, public health professionals, and researchers 
             seeking to identify and respond to disease outbreaks in a timely 
             fashion. For a detailed reference on hierarchical models, consult 
             Henrik Madsen and Poul Thyregod's book (2011), ISBN: 9781420091557.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, MASS, rmarkdown, testthat (&ge; 3.0.0), zoo</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, checkmate, dplyr, lifecycle, magrittr, purrr, tibble,
tidyr, utils, rlang</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://ssi-dk.github.io/aeddo/">https://ssi-dk.github.io/aeddo/</a>, <a href="https://github.com/ssi-dk/aeddo">https://github.com/ssi-dk/aeddo</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ssi-dk/aeddo/issues">https://github.com/ssi-dk/aeddo/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-27 08:46:48 UTC; b280787</td>
</tr>
<tr>
<td>Author:</td>
<td>Kasper Schou Telkamp
    <a href="https://orcid.org/0009-0001-5126-0190"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Lasse Engbo Christiansen
    <a href="https://orcid.org/0000-0001-5019-1931"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Statens Serum Institut, SSI [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lasse Engbo Christiansen &lt;lsec@ssi.dk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-27 10:10:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='aeddo'>Automated and Early Detection of Disease Outbreaks</h2><span id='topic+aeddo'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>This function performs automated an early detection of disease outbreaks,
(aeddo), on a time series data set. It utilizes hierarchical models in an
innovative manner to infer one-step ahead random effects. In turn, these
random effects are used directly to characterize an outbreak.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aeddo(
  data = data.frame(),
  formula = formula(),
  k = integer(),
  sig_level = 0.95,
  exclude_past_outbreaks = TRUE,
  init_theta = numeric(),
  lower = numeric(),
  upper = numeric(),
  method = "BFGS"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aeddo_+3A_data">data</code></td>
<td>
<p>A tibble containing the time series data, including columns 'y'
for observed values,'n' for population size, and other covariates of
interest.</p>
</td></tr>
<tr><td><code id="aeddo_+3A_formula">formula</code></td>
<td>
<p>A model formula for the fixed effects in the  hierarchical
model to fit to the data.</p>
</td></tr>
<tr><td><code id="aeddo_+3A_k">k</code></td>
<td>
<p>An integer specifying the rolling window size employed for parameter
estimation.</p>
</td></tr>
<tr><td><code id="aeddo_+3A_sig_level">sig_level</code></td>
<td>
<p>The quantile from the random effects distribution used for
defining the for outbreak detection threshold, a numeric value between 0 and
1.</p>
</td></tr>
<tr><td><code id="aeddo_+3A_exclude_past_outbreaks">exclude_past_outbreaks</code></td>
<td>
<p>logical value indicating whether past outbreak
related observations should be excluded from future parameter estimation.</p>
</td></tr>
<tr><td><code id="aeddo_+3A_init_theta">init_theta</code></td>
<td>
<p>Initial values for model parameters in optimization.</p>
</td></tr>
<tr><td><code id="aeddo_+3A_lower">lower</code></td>
<td>
<p>Lower bounds for optimization parameters.</p>
</td></tr>
<tr><td><code id="aeddo_+3A_upper">upper</code></td>
<td>
<p>Upper bounds for optimization parameters.</p>
</td></tr>
<tr><td><code id="aeddo_+3A_method">method</code></td>
<td>
<p>The optimization method to use, either &quot;BFGS&quot;  (default) or
&quot;L-BFGS-B&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="tibble.html#topic+tibble-package">tibble</a>-like 'aedseo' object containing:
</p>

<ul>
<li><p> 'window_data': A list of <a href="tibble.html#topic+tibble-package">tibble</a>, each
representing the data for this windowed parameter estimation.
</p>
</li>
<li><p> 'reference_data': A list of <a href="tibble.html#topic+tibble-package">tibble</a>, each
representing the data for the reference time point.
</p>
</li>
<li><p> 'phi': The dispersion parameter.
</p>
</li>
<li><p> 'lambda': The estimated outbreak intensity.
</p>
</li>
<li><p> 'u': The one-step ahead random effect.
</p>
</li>
<li><p> 'u_probability': The probability of observing the one-step ahead
random effect.
</p>
</li>
<li><p> 'outbreak_alarm': Logical. Indicates if an outbreak is detected.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Create an example aedseo_tsd object
aeddo_data &lt;- data.frame(
  time = as.Date(c(
    "2023-01-01",
    "2023-01-02",
    "2023-01-03",
    "2023-01-04",
    "2023-01-05",
    "2023-01-06"
  )),
  y = c(100, 120, 180, 110, 130, 140),
  n = 1
)

# Supply a model formula
fixed_effects_formula &lt;- y ~ 1

# Choose a size for the rolling window
k &lt;- 2
# ... and quantile for the threshold
sig_level &lt;- 0.9

# Employ the algorithm
aeddo_results &lt;- aeddo(
  data = aeddo_data,
  formula = fixed_effects_formula,
  k = k,
  sig_level = sig_level,
  exclude_past_outbreaks = TRUE,
  init_theta = c(1, 0),
  lower = c(-Inf, 1e-6),
  upper = c(Inf, 1e2),
  method = "L-BFGS-B"
)
# Print the results
print(aeddo_results)
</code></pre>

<hr>
<h2 id='aeddo-package'>aeddo: Automated and Early Detection of Disease Outbreaks</h2><span id='topic+aeddo-package'></span><span id='topic+_PACKAGE'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>A powerful tool for automating the early detection of disease outbreaks in time series data. 'aeddo' employs advanced statistical methods, including hierarchical models, in an innovative manner to effectively characterize outbreak signals. It is particularly useful for epidemiologists, public health professionals, and researchers seeking to identify and respond to disease outbreaks in a timely fashion. For a detailed reference on hierarchical models, consult Henrik Madsen and Poul Thyregod's book (2011), ISBN: 9781420091557.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Lasse Engbo Christiansen <a href="mailto:lsec@ssi.dk">lsec@ssi.dk</a> (<a href="https://orcid.org/0000-0001-5019-1931">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Kasper Schou Telkamp <a href="mailto:kasper.telkamp@gmail.com">kasper.telkamp@gmail.com</a> (<a href="https://orcid.org/0009-0001-5126-0190">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Statens Serum Institut, SSI [copyright holder, funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://ssi-dk.github.io/aeddo/">https://ssi-dk.github.io/aeddo/</a>
</p>
</li>
<li> <p><a href="https://github.com/ssi-dk/aeddo">https://github.com/ssi-dk/aeddo</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ssi-dk/aeddo/issues">https://github.com/ssi-dk/aeddo/issues</a>
</p>
</li></ul>


<hr>
<h2 id='autoplot'>Create a complete 'ggplot' appropriate to a particular data type</h2><span id='topic+autoplot'></span><span id='topic+autoplot.aeddo'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>This function generates a complete 'ggplot' object suitable for
visualizing time series data in an <code>aeddo</code> object. It creates a line
plot connecting the observations and adds points at each data point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autoplot(object, ...)

## S3 method for class 'aeddo'
autoplot(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot_+3A_object">object</code></td>
<td>
<p>An <code>aeddo</code> object</p>
</td></tr>
<tr><td><code id="autoplot_+3A_...">...</code></td>
<td>
<p>Additional arguments (not used).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'ggplot' object for visualizing the time series data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create an example aeddo object
aeddo_data &lt;- data.frame(
  time = as.Date(c(
    "2023-01-01",
    "2023-01-02",
    "2023-01-03",
    "2023-01-04",
    "2023-01-05",
    "2023-01-06"
  )),
  y = c(100, 120, 180, 110, 130, 140),
  n = 1
)

# Supply a model formula
fixed_effects_formula &lt;- y ~ 1

# Choose a size for the rolling window
k &lt;- 2
# ... and quantile for the threshold
sig_level &lt;- 0.9

# Employ the algorithm
aeddo_results &lt;- aeddo(
  data = aeddo_data,
  formula = fixed_effects_formula,
  k = k,
  sig_level = sig_level,
  exclude_past_outbreaks = TRUE,
  init_theta = c(1, 0),
  lower = c(-Inf, 1e-6),
  upper = c(Inf, 1e2),
  method = "L-BFGS-B"
)

# Create a ggplot visualization for the aeddo object
autoplot(aeddo_results)
</code></pre>

<hr>
<h2 id='check_aeddo_inputs'>Check and assert the inputs for the aeddo function.</h2><span id='topic+check_aeddo_inputs'></span>

<h3>Description</h3>

<p>This function is for internal use and checks the validity of inputs to the
aeddo function. It performs various checks using the checkmate package to
ensure that the inputs conform to expected types and values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_aeddo_inputs(
  data,
  formula,
  k,
  sig_level,
  exclude_past_outbreaks,
  init_theta,
  lower,
  upper,
  method
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_aeddo_inputs_+3A_data">data</code></td>
<td>
<p>A data frame containing the time series data.</p>
</td></tr>
<tr><td><code id="check_aeddo_inputs_+3A_formula">formula</code></td>
<td>
<p>A model formula for the fixed effects in the hierarchical
model.</p>
</td></tr>
<tr><td><code id="check_aeddo_inputs_+3A_k">k</code></td>
<td>
<p>An integer specifying the rolling window size employed for
parameter estimation.</p>
</td></tr>
<tr><td><code id="check_aeddo_inputs_+3A_sig_level">sig_level</code></td>
<td>
<p>The quantile from the random effects distribution used for
defining the outbreak detection threshold.</p>
</td></tr>
<tr><td><code id="check_aeddo_inputs_+3A_exclude_past_outbreaks">exclude_past_outbreaks</code></td>
<td>
<p>Logical indicating whether past
outbreak-related observations should be excluded from future parameter
estimation.</p>
</td></tr>
<tr><td><code id="check_aeddo_inputs_+3A_init_theta">init_theta</code></td>
<td>
<p>Initial values for model parameters in optimization.</p>
</td></tr>
<tr><td><code id="check_aeddo_inputs_+3A_lower">lower</code></td>
<td>
<p>Lower bounds for optimization parameters.</p>
</td></tr>
<tr><td><code id="check_aeddo_inputs_+3A_upper">upper</code></td>
<td>
<p>Upper bounds for optimization parameters.</p>
</td></tr>
<tr><td><code id="check_aeddo_inputs_+3A_method">method</code></td>
<td>
<p>The optimization method to use, either &quot;BFGS&quot; or &quot;L-BFGS-B&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns nothing. Raises errors if the inputs do not meet the
specified criteria.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# This function is for internal use and is called within the aeddo function.
# It is not intended to be called directly by users.

## End(Not run)
</code></pre>

<hr>
<h2 id='check_nll_poisson_gamma_inputs'>Check and assert the inputs for the nll_poisson_gamma function.</h2><span id='topic+check_nll_poisson_gamma_inputs'></span>

<h3>Description</h3>

<p>This function is for internal use and checks the validity of inputs to the
nll_poisson_gamma function. It performs various checks using the checkmate
package to ensure that the inputs conform to expected types and values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_nll_poisson_gamma_inputs(theta, data, formula)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_nll_poisson_gamma_inputs_+3A_theta">theta</code></td>
<td>
<p>Numeric vector of parameters.</p>
</td></tr>
<tr><td><code id="check_nll_poisson_gamma_inputs_+3A_data">data</code></td>
<td>
<p>A data frame containing the time series data.</p>
</td></tr>
<tr><td><code id="check_nll_poisson_gamma_inputs_+3A_formula">formula</code></td>
<td>
<p>A model formula for the fixed effects in the hierarchical
model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns nothing. Raises errors if the inputs do not meet the
specified criteria.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# This function is for internal use and is called within the
# nll_poisson_gamma function. It is not intended to be called directly by
# users.

## End(Not run)
</code></pre>

<hr>
<h2 id='nll_poisson_gamma'>Negative Log-Likelihood for Poisson Gamma Model</h2><span id='topic+nll_poisson_gamma'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Calculate the negative log-likelihood for the Poisson Gamma modeling
framework.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nll_poisson_gamma(theta, data, formula)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nll_poisson_gamma_+3A_theta">theta</code></td>
<td>
<p>A numeric vector containing model parameters. The first part of
the vector represents fixed effects, and the remaining part represents model
parameters.</p>
</td></tr>
<tr><td><code id="nll_poisson_gamma_+3A_data">data</code></td>
<td>
<p>A tibble containing the time series data, including columns 'y'
for observed values,'n' for population size, and other covariates of
interest.</p>
</td></tr>
<tr><td><code id="nll_poisson_gamma_+3A_formula">formula</code></td>
<td>
<p>A formula specifying the model structure.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The negative log-likelihood value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Initial parameters
theta &lt;- c(0.5, 0.1)

# Sample data
data &lt;- data.frame(
  y = c(10, 15, 20, 30, 50, 100, 200, 40, 20, 10),
  n = c(100, 150, 200, 300, 500, 1000, 2000, 400, 200, 100)
)

# Fixed effects model formula
fixed_effects_formula &lt;- y ~ 1

# Calculate negative log likelihood
nll_poisson_gamma(
  theta = theta,
  data = data,
  formula = fixed_effects_formula
)
</code></pre>

<hr>
<h2 id='plot.aeddo'>Create a complete 'ggplot' appropriate to a particular data type</h2><span id='topic+plot.aeddo'></span><span id='topic+plot'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>This function generates a complete 'ggplot' object suitable for
visualizing time series data in an <code>aeddo</code> object. It creates a line
plot connecting the observations and adds points at each data point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aeddo'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.aeddo_+3A_x">x</code></td>
<td>
<p>An <code>aeddo</code> object</p>
</td></tr>
<tr><td><code id="plot.aeddo_+3A_...">...</code></td>
<td>
<p>Additional arguments (not used).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'ggplot' object for visualizing the time series data.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+autoplot">autoplot()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create an example aeddo object
aeddo_data &lt;- data.frame(
  time = as.Date(c(
    "2023-01-01",
    "2023-01-02",
    "2023-01-03",
    "2023-01-04",
    "2023-01-05",
    "2023-01-06"
  )),
  y = c(100, 120, 180, 110, 130, 140),
  n = 1
)

# Supply a model formula
fixed_effects_formula &lt;- y ~ 1

# Choose a size for the rolling window
k &lt;- 2
# ... and quantile for the threshold
sig_level &lt;- 0.9

# Employ the algorithm
aeddo_results &lt;- aeddo(
  data = aeddo_data,
  formula = fixed_effects_formula,
  k = k,
  sig_level = sig_level,
  exclude_past_outbreaks = TRUE,
  init_theta = c(1, 0),
  lower = c(-Inf, 1e-6),
  upper = c(Inf, 1e2),
  method = "L-BFGS-B"
)

# Create a ggplot visualization for the aeddo object
plot(aeddo_results)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
