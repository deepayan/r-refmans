<!DOCTYPE html><html><head><title>Help for package AIUQ</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AIUQ}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AIUQ-package'><p>AIUQ: Ab Initio Uncertainty Quantification</p></a></li>
<li><a href='#aniso_SAM'><p>Scattering analysis of microscopy for anisotropic processes</p></a></li>
<li><a href='#aniso_SAM-class'><p>Anisotropic SAM class</p></a></li>
<li><a href='#aniso_simulation'><p>Simulate anisotropic 2D particle movement</p></a></li>
<li><a href='#aniso_simulation-class'><p>Anisotropic simulation class</p></a></li>
<li><a href='#anisotropic_bm_particle_intensity'><p>Simulate 2D particle trajectory follows anisotropic Brownian Motion</p></a></li>
<li><a href='#anisotropic_fbm_ou_particle_intensity'><p>Simulate 2D particle trajectory follows anisotropic fBM plus OU</p></a></li>
<li><a href='#anisotropic_fbm_particle_intensity'><p>Simulate 2D particle trajectory follows anisotropic fBM</p></a></li>
<li><a href='#anisotropic_log_lik'><p>Log likelihood for anisotropic processes</p></a></li>
<li><a href='#anisotropic_log_lik_grad'><p>Gradient of log likelihood for anisotropic processes</p></a></li>
<li><a href='#anisotropic_numerical_msd'><p>Compute anisotropic numerical MSD</p></a></li>
<li><a href='#anisotropic_ou_particle_intensity'><p>Simulate 2D particle trajectory follows anisotropic OU process</p></a></li>
<li><a href='#bm_particle_intensity'><p>Simulate 2D particle trajectory follows Brownian Motion</p></a></li>
<li><a href='#cart2polar'><p>Transform Cartesian coordinates to polar coordinates</p></a></li>
<li><a href='#corr_fBM'><p>Construct correlation matrix for FBM</p></a></li>
<li><a href='#fbm_ou_particle_intensity'><p>Simulate 2D particle trajectory follows fBM plus OU</p></a></li>
<li><a href='#fbm_particle_intensity'><p>Simulate 2D particle trajectory follows fBM</p></a></li>
<li><a href='#FFT2D'><p>2D Fourier transformation and calculate wave number</p></a></li>
<li><a href='#fftshift'><p>fftshift</p></a></li>
<li><a href='#fill_intensity'><p>Construct intensity profile for a given particle trajectory</p></a></li>
<li><a href='#get_dqt'><p>Compute observed dynamic image structure function</p></a></li>
<li><a href='#get_est_param'><p>Transform parameters estimated in SAM class to parameters structure in MSD function</p></a></li>
<li><a href='#get_est_parameters_MSD_SAM_interval'><p>Construct 95% confidence interval</p></a></li>
<li><a href='#get_est_parameters_MSD_SAM_interval_anisotropic'><p>Construct 95% confidence interval for anisotropic processes</p></a></li>
<li><a href='#get_grad_trans'><p>Construct parameter transformation for optimization using exact gradient</p></a></li>
<li><a href='#get_initial_param'><p>Construct initial values for the parameters to be optimized over</p></a></li>
<li><a href='#get_isf'><p>Compute empirical intermediate scattering function</p></a></li>
<li><a href='#get_MSD'><p>Construct MSD</p></a></li>
<li><a href='#get_MSD_with_grad'><p>Construct MSD and MSD gradient with transformed parameters</p></a></li>
<li><a href='#get_true_param_aniso_sim'><p>Transform parameters in anisotropic simulation class to parameters structure in MSD function</p></a></li>
<li><a href='#get_true_param_sim'><p>Transform parameters in simulation class to parameters structure in MSD function</p></a></li>
<li><a href='#intensity_format_transform'><p>Transform intensity profile into SS_T matrix</p></a></li>
<li><a href='#l2_estAB'><p>Compute l2 loss for Dqt</p></a></li>
<li><a href='#l2_fixedAB'><p>Compute l2 loss for Dqt with fixed A(q) and B</p></a></li>
<li><a href='#log_lik'><p>Log likelihood of the model</p></a></li>
<li><a href='#log_lik_grad'><p>Gradient of log likelihood</p></a></li>
<li><a href='#modeled_dqt'><p>Compute modeled dynamic image structure function</p></a></li>
<li><a href='#modeled_isf'><p>Compute modeled intermediate scattering function</p></a></li>
<li><a href='#numerical_msd'><p>Compute numerical MSD</p></a></li>
<li><a href='#ou_particle_intensity'><p>Simulate 2D particle trajectory follows OU process</p></a></li>
<li><a href='#param_uncertainty'><p>Compute 95% confidence interval</p></a></li>
<li><a href='#param_uncertainty_anisotropic'><p>Compute 95% confidence interval for anisotropic processes</p></a></li>
<li><a href='#plot_intensity'><p>Plot 2D intensity</p></a></li>
<li><a href='#plot_MSD'><p>Plot estimated MSD with uncertainty from SAM class</p></a></li>
<li><a href='#plot_traj'><p>Plot 2D particle trajectory</p></a></li>
<li><a href='#SAM'><p>Scattering analysis of microscopy</p></a></li>
<li><a href='#SAM_Dqt'><p>Compute dynamic image structure function</p></a></li>
<li><a href='#SAM-class'><p>SAM class</p></a></li>
<li><a href='#show.aniso_sam'><p>Show scattering analysis of microscopy for anisotropic processes (aniso_SAM) object</p></a></li>
<li><a href='#show.aniso_simulation'><p>Show anisotropic simulation object</p></a></li>
<li><a href='#show.sam'><p>Show scattering analysis of microscopy (SAM) object</p></a></li>
<li><a href='#show.simulation'><p>Show simulation object</p></a></li>
<li><a href='#simulation'><p>Simulate 2D particle movement</p></a></li>
<li><a href='#simulation-class'><p>Simulation class</p></a></li>
<li><a href='#theta_est_l2_dqt_estAB'><p>Minimize l2 loss for Dqt</p></a></li>
<li><a href='#theta_est_l2_dqt_fixedAB'><p>Minimize l2 loss for Dqt with fixed A(q) and B</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Ab Initio Uncertainty Quantification</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.3</td>
</tr>
<tr>
<td>Author:</td>
<td>Yue He [aut],
  Xubo Liu [aut],
  Mengyang Gu [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mengyang Gu &lt;mengyang@pstat.ucsb.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Uncertainty quantification and inverse estimation by probabilistic generative models from the beginning of the data analysis. An example is a Fourier basis method for inverse estimation in scattering analysis of microscopy videos. It does not require specifying a certain range of Fourier bases and it substantially reduces computational cost via the generalized Schur algorithm. See the reference: Mengyang Gu, Yue He, Xubo Liu and Yimin Luo (2023), &lt;<a href="https://doi.org/10.48550%2FarXiv.2309.02468">doi:10.48550/arXiv.2309.02468</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>fftwtools (&ge; 0.9.11), SuperGauss (&ge; 2.0.3), methods, plot3D
(&ge; 1.4)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-07-02 02:33:29 UTC; mengyanggu</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-02 07:30:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='AIUQ-package'>AIUQ: Ab Initio Uncertainty Quantification</h2><span id='topic+AIUQ'></span><span id='topic+AIUQ-package'></span>

<h3>Description</h3>

<p>Uncertainty quantification and inverse estimation by probabilistic generative models from the beginning of the data analysis. An example is a Fourier basis method for inverse estimation in scattering analysis of microscopy videos. It does not require specifying a certain range of Fourier bases and it substantially reduces computational cost via the generalized Schur algorithm. See the reference: Mengyang Gu, Yue He, Xubo Liu and Yimin Luo (2023), <a href="https://doi.org/10.48550/arXiv.2309.02468">doi:10.48550/arXiv.2309.02468</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Mengyang Gu <a href="mailto:mengyang@pstat.ucsb.edu">mengyang@pstat.ucsb.edu</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Yue He
</p>
</li>
<li><p> Xubo Liu
</p>
</li></ul>


<hr>
<h2 id='aniso_SAM'>Scattering analysis of microscopy for anisotropic processes</h2><span id='topic+aniso_SAM'></span>

<h3>Description</h3>

<p>Fast parameter estimation in scattering analysis of microscopy for anisotropic
processes, using AIUQ method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aniso_SAM(
  intensity = NA,
  intensity_str = "T_SS_mat",
  pxsz = 1,
  sz = c(NA, NA),
  mindt = 1,
  AIUQ_thr = c(1, 1),
  model_name = "BM",
  sigma_0_2_ini = NaN,
  param_initial = NA,
  num_optim = 1,
  msd_fn = NA,
  msd_grad_fn = NA,
  num_param = NA,
  uncertainty = FALSE,
  M = 50,
  sim_object = NA,
  msd_truth = NA,
  method = "AIUQ",
  index_q_AIUQ = NA,
  message_out = TRUE,
  square = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aniso_SAM_+3A_intensity">intensity</code></td>
<td>
<p>intensity profile. See 'Details'.</p>
</td></tr>
<tr><td><code id="aniso_SAM_+3A_intensity_str">intensity_str</code></td>
<td>
<p>structure of the intensity profile, options from
('SST_array','S_ST_mat','T_SS_mat'). See 'Details'.</p>
</td></tr>
<tr><td><code id="aniso_SAM_+3A_pxsz">pxsz</code></td>
<td>
<p>size of one pixel in unit of micron, 1 for simulated data</p>
</td></tr>
<tr><td><code id="aniso_SAM_+3A_sz">sz</code></td>
<td>
<p>frame size of the intensity profile in x and y directions,
number of pixels contained in each frame equals sz_x by sz_y.</p>
</td></tr>
<tr><td><code id="aniso_SAM_+3A_mindt">mindt</code></td>
<td>
<p>minimum lag time, 1 for simulated data</p>
</td></tr>
<tr><td><code id="aniso_SAM_+3A_aiuq_thr">AIUQ_thr</code></td>
<td>
<p>threshold for wave number selection, numeric vector of two
elements with values between 0 and 1. See 'Details'.</p>
</td></tr>
<tr><td><code id="aniso_SAM_+3A_model_name">model_name</code></td>
<td>
<p>fitted model, options from  ('BM','OU','FBM','OU+FBM',
'user_defined'), with Brownian motion as the default model. See 'Details'.</p>
</td></tr>
<tr><td><code id="aniso_SAM_+3A_sigma_0_2_ini">sigma_0_2_ini</code></td>
<td>
<p>initial value for background noise. If NA, use minimum
value of absolute square of intensity profile in reciprocal space.</p>
</td></tr>
<tr><td><code id="aniso_SAM_+3A_param_initial">param_initial</code></td>
<td>
<p>initial values for param estimation.</p>
</td></tr>
<tr><td><code id="aniso_SAM_+3A_num_optim">num_optim</code></td>
<td>
<p>number of optimization.</p>
</td></tr>
<tr><td><code id="aniso_SAM_+3A_msd_fn">msd_fn</code></td>
<td>
<p>user defined mean squared displacement(MSD) structure, a
function of parameters and lag times. NA if <code>model_name</code> is not
'user_defined'.</p>
</td></tr>
<tr><td><code id="aniso_SAM_+3A_msd_grad_fn">msd_grad_fn</code></td>
<td>
<p>gradient for user defined mean squared displacement
structure. If <code>NA</code>, then numerical gradient will be used for parameter
estimation in <code>'user_defined'</code> model.</p>
</td></tr>
<tr><td><code id="aniso_SAM_+3A_num_param">num_param</code></td>
<td>
<p>number of parameters need to be estimated in the intermediate
scattering function, need to be non-NA value for user_defined' model.</p>
</td></tr>
<tr><td><code id="aniso_SAM_+3A_uncertainty">uncertainty</code></td>
<td>
<p>a logical evaluating to TRUE or FALSE indicating whether
parameter uncertainty should be computed.</p>
</td></tr>
<tr><td><code id="aniso_SAM_+3A_m">M</code></td>
<td>
<p>number of particles. See 'Details'.</p>
</td></tr>
<tr><td><code id="aniso_SAM_+3A_sim_object">sim_object</code></td>
<td>
<p>NA or an S4 object of class <code>simulation</code>.</p>
</td></tr>
<tr><td><code id="aniso_SAM_+3A_msd_truth">msd_truth</code></td>
<td>
<p>true MSD or reference MSD value.</p>
</td></tr>
<tr><td><code id="aniso_SAM_+3A_method">method</code></td>
<td>
<p>methods for parameter estimation, options from ('AIUQ', 'DDM').</p>
</td></tr>
<tr><td><code id="aniso_SAM_+3A_index_q_aiuq">index_q_AIUQ</code></td>
<td>
<p>index range for wave number when using AIUQ method. See 'Details'.</p>
</td></tr>
<tr><td><code id="aniso_SAM_+3A_message_out">message_out</code></td>
<td>
<p>a logical evaluating to TRUE or FALSE indicating whether
or not to output the message.</p>
</td></tr>
<tr><td><code id="aniso_SAM_+3A_square">square</code></td>
<td>
<p>a logical evaluating to TRUE or FALSE indicating whether or not
to crop the original intensity profile into square image.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For simulated data using <code>aniso_simulation</code> in AIUQ package, <code>intensity</code>
will be automatically extracted from <code>aniso_simulation</code> class.
</p>
<p>By default <code>intensity_str</code> is set to 'T_SS_mat', a time by space<code class="reqn">\times</code>space
matrix, which is the structure of intensity profile obtained from <code>aniso_simulation</code>
class. For <code>intensity_str='SST_array'</code> , input intensity profile should be a
space by space by time array, which is the structure from loading a tif file.
For <code>intensity_str='S_ST_mat'</code>, input intensity profile should be a
space by space<code class="reqn">\times</code>time matrix.
</p>
<p>By default <code>AIUQ_thr</code> is set to <code>c(1,1)</code>, uses information from all
complete q rings. The first element affects maximum wave number selected,
and second element controls minimum proportion of wave number selected. By
setting 1 for the second element, if maximum wave number selected is less
than the wave number length, then maximum wave number selected is coerced to
use all wave number unless user defined another index range through <code>index_q_AIUQ</code>.
</p>
<p>If <code>model_name</code> equals 'user_defined', or NA (will coerced to
'user_defined'), then <code>msd_fn</code> and <code>num_param</code> need to be provided
for parameter estimation.
</p>
<p>Number of particles <code>M</code> is set to 50 or automatically extracted from
<code>simulation</code> class for simulated data using <code>simulation</code> in AIUQ
package.
</p>
<p>By default, using all wave vectors from complete q ring for both <code>AIUQ</code>,
unless user defined index range through <code>index_q_AIUQ</code>.
</p>


<h3>Value</h3>

<p>Returns an S4 object of class <code>aniso_SAM</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
# Example 1: Estimation for simulated data
set.seed(1)
aniso_sim = aniso_simulation(sz=100,len_t=100, model_name="BM",M=100,sigma_bm=c(0.5,0.3))
show(aniso_sim)
plot_traj(object=aniso_sim)
aniso_sam = aniso_SAM(sim_object=aniso_sim, model_name="BM",AIUQ_thr = c(0.999,0))
show(aniso_sam)
plot_MSD(aniso_sam,msd_truth = aniso_sam@msd_truth)
</code></pre>

<hr>
<h2 id='aniso_SAM-class'>Anisotropic SAM class</h2><span id='topic+aniso_SAM-class'></span>

<h3>Description</h3>

<p>S4 class for fast parameter estimation in scattering analysis of microscopy
for anisotropic processes, using either <code>AIUQ</code> or <code>DDM</code> method.
</p>


<h3>Slots</h3>


<dl>
<dt><code>pxsz</code></dt><dd><p>numeric.  Size of one pixel in unit of micron with default value 1.</p>
</dd>
<dt><code>mindt</code></dt><dd><p>numeric. Minimum lag time with default value 1.</p>
</dd>
<dt><code>sz</code></dt><dd><p>vector. Frame size of the intensity profile in x and y directions,
number of pixels contained in each frame equals sz_x by sz_y.</p>
</dd>
<dt><code>len_t</code></dt><dd><p>integer. Number of time steps.</p>
</dd>
<dt><code>len_q</code></dt><dd><p>integer. Number of wave vector.</p>
</dd>
<dt><code>q</code></dt><dd><p>vector. Wave vector in unit of um^-1.</p>
</dd>
<dt><code>d_input</code></dt><dd><p>vector. Sequence of lag times.</p>
</dd>
<dt><code>B_est_ini</code></dt><dd><p>numeric. Estimation of B. This parameter is determined by the
noise in the system. See 'References'.</p>
</dd>
<dt><code>A_est_ini</code></dt><dd><p>vector. Estimation of A(q). Note this parameter is
determined by the properties of the imaged material and imaging optics.
See 'References'.</p>
</dd>
<dt><code>I_o_q_2_ori</code></dt><dd><p>vector. Absolute square of Fourier transformed intensity
profile, ensemble over time.</p>
</dd>
<dt><code>q_ori_ring_loc_unique_index</code></dt><dd><p>list. List of location index of non-duplicate
values for each q ring.</p>
</dd>
<dt><code>model_name</code></dt><dd><p>character. Fitted model, options from
('BM','OU','FBM','OU+FBM', 'user_defined').</p>
</dd>
<dt><code>param_est</code></dt><dd><p>matrix. Estimated parameters contained in MSD.</p>
</dd>
<dt><code>sigma_2_0_est</code></dt><dd><p>vector. Estimated variance of background noise.</p>
</dd>
<dt><code>msd_est</code></dt><dd><p>matrix. Estimated MSD.</p>
</dd>
<dt><code>uncertainty</code></dt><dd><p>logical. A logical evaluating to TRUE or FALSE indicating whether
parameter uncertainty should be computed.</p>
</dd>
<dt><code>msd_truth</code></dt><dd><p>matrix. True MSD or reference MSD value.</p>
</dd>
<dt><code>sigma_2_0_truth</code></dt><dd><p>vector.  True variance of background noise, non NA for
simulated data using <code>simulation</code>.</p>
</dd>
<dt><code>param_truth</code></dt><dd><p>matrix. True parameters used to construct MSD, non NA for
simulated data using <code>aniso_simulation</code>.</p>
</dd>
<dt><code>index_q</code></dt><dd><p>vector. Selected index of wave vector.</p>
</dd>
<dt><code>I_q</code></dt><dd><p>matrix. Fourier transformed intensity profile with structure 'SS_T_mat'.</p>
</dd>
<dt><code>AIC</code></dt><dd><p>numeric. Akaike information criterion score.</p>
</dd>
<dt><code>mle</code></dt><dd><p>numeric. Maximum log likelihood value.</p>
</dd>
<dt><code>msd_x_lower</code></dt><dd><p>vector. Lower bound of 95% confidence interval of MSD in x directions.</p>
</dd>
<dt><code>msd_x_upper</code></dt><dd><p>vector. Upper bound of 95% confidence interval of MSD in x directions.</p>
</dd>
<dt><code>msd_y_lower</code></dt><dd><p>vector. Lower bound of 95% confidence interval of MSD in y directions.</p>
</dd>
<dt><code>msd_y_upper</code></dt><dd><p>vector. Upper bound of 95% confidence interval of MSD in y directions.</p>
</dd>
<dt><code>param_uq_range</code></dt><dd><p>matrix. 95% confidence interval for estimated parameters.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>

<hr>
<h2 id='aniso_simulation'>Simulate anisotropic 2D particle movement</h2><span id='topic+aniso_simulation'></span>

<h3>Description</h3>

<p>Simulate anisotropic 2D particle movement from a user selected stochastic
process, and output intensity profiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aniso_simulation(
  sz = c(200, 200),
  len_t = 200,
  M = 50,
  model_name = "BM",
  noise = "gaussian",
  I0 = 20,
  Imax = 255,
  pos0 = matrix(NaN, nrow = M, ncol = 2),
  rho = c(0.95, 0.9),
  H = c(0.4, 0.3),
  sigma_p = 2,
  sigma_bm = c(1, 0.5),
  sigma_ou = c(2, 1.5),
  sigma_fbm = c(2, 1.5)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aniso_simulation_+3A_sz">sz</code></td>
<td>
<p>frame size of simulated image with default <code>c(200,200)</code>.</p>
</td></tr>
<tr><td><code id="aniso_simulation_+3A_len_t">len_t</code></td>
<td>
<p>number of time steps with default 200.</p>
</td></tr>
<tr><td><code id="aniso_simulation_+3A_m">M</code></td>
<td>
<p>number of particles with default 50.</p>
</td></tr>
<tr><td><code id="aniso_simulation_+3A_model_name">model_name</code></td>
<td>
<p>stochastic process simulated, options from
('BM','OU','FBM','OU+FBM'), with default 'BM'.</p>
</td></tr>
<tr><td><code id="aniso_simulation_+3A_noise">noise</code></td>
<td>
<p>background noise, options from ('uniform','gaussian'),
with default 'gaussian'.</p>
</td></tr>
<tr><td><code id="aniso_simulation_+3A_i0">I0</code></td>
<td>
<p>background intensity, value between 0 and 255, with default 20.</p>
</td></tr>
<tr><td><code id="aniso_simulation_+3A_imax">Imax</code></td>
<td>
<p>maximum intensity at the center of the particle, value between 0
and 255, with default 255.</p>
</td></tr>
<tr><td><code id="aniso_simulation_+3A_pos0">pos0</code></td>
<td>
<p>initial position for M particles, matrix with dimension M by 2.</p>
</td></tr>
<tr><td><code id="aniso_simulation_+3A_rho">rho</code></td>
<td>
<p>correlation between successive step and previous step in O-U
process, in x, y-directions. A vector of length 2 with values between 0 and 1,
default <code>c(0.95,0.9)</code>.</p>
</td></tr>
<tr><td><code id="aniso_simulation_+3A_h">H</code></td>
<td>
<p>Hurst parameter of fractional Brownian Motion, in x, y-directions.
A vector of length 2, value between 0 and 1, default <code>c(0.4,0.3)</code>.</p>
</td></tr>
<tr><td><code id="aniso_simulation_+3A_sigma_p">sigma_p</code></td>
<td>
<p>radius of the spherical particle (3sigma_p), with default 2.</p>
</td></tr>
<tr><td><code id="aniso_simulation_+3A_sigma_bm">sigma_bm</code></td>
<td>
<p>distance moved per time step of Brownian Motion,
in x,y-directions. A vector of length 2 with default <code>c(1,0.5)</code>.</p>
</td></tr>
<tr><td><code id="aniso_simulation_+3A_sigma_ou">sigma_ou</code></td>
<td>
<p>distance moved per time step of Ornstein–Uhlenbeck process,
in x, y-directions. A vector of length 2 with default <code>c(2,1.5)</code>.</p>
</td></tr>
<tr><td><code id="aniso_simulation_+3A_sigma_fbm">sigma_fbm</code></td>
<td>
<p>distance moved per time step of fractional Brownian Motion,
in x, y-directions. A vector of length 2 with default <code>c(2,1.5)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an S4 object of class <code>anisotropic_simulation</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
# -------------------------------------------------
# Example 1: Simple diffusion for 200 images with
#            200 by 200 pixels and 50 particles
# -------------------------------------------------
aniso_sim_bm = aniso_simulation()
show(aniso_sim_bm)

# -------------------------------------------------
# Example 2: Simple diffusion for 100 images with
#            100 by 100 pixels and slower speed
# -------------------------------------------------
aniso_sim_bm = aniso_simulation(sz=100,len_t=100,sigma_bm=c(0.5,0.1))
show(aniso_sim_bm)

# -------------------------------------------------
# Example 3: Ornstein-Uhlenbeck process
# -------------------------------------------------
aniso_sim_ou = aniso_simulation(model_name="OU")
show(aniso_sim_ou)
</code></pre>

<hr>
<h2 id='aniso_simulation-class'>Anisotropic simulation class</h2><span id='topic+aniso_simulation-class'></span>

<h3>Description</h3>

<p>S4 class for anisotropic 2D particle movement simulation.
</p>


<h3>Details</h3>

<p><code>intensity</code> should has structure 'T_SS_mat', matrix with dimension
<code>len_t</code> by <code>sz</code><code class="reqn">\times</code><code>sz</code>.
</p>
<p><code>pos</code> should be the position matrix with dimension
<code>M</code><code class="reqn">\times</code><code>len_t</code>. See <code><a href="#topic+bm_particle_intensity">bm_particle_intensity</a></code>,
<code><a href="#topic+ou_particle_intensity">ou_particle_intensity</a></code>, <code><a href="#topic+fbm_particle_intensity">fbm_particle_intensity</a></code>,
<code><a href="#topic+fbm_ou_particle_intensity">fbm_ou_particle_intensity</a></code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>sz</code></dt><dd><p>vector. Frame size of the intensity profile, number of pixels
contained in each frame equals <code>sz[1]</code> by <code>sz[2]</code>.</p>
</dd>
<dt><code>len_t</code></dt><dd><p>integer. Number of time steps.</p>
</dd>
<dt><code>noise</code></dt><dd><p>character. Background noise, options from ('uniform','gaussian').</p>
</dd>
<dt><code>model_name</code></dt><dd><p>character. Simulated stochastic process, options from ('BM','OU','FBM','OU+FBM').</p>
</dd>
<dt><code>M</code></dt><dd><p>integer. Number of particles.</p>
</dd>
<dt><code>pxsz</code></dt><dd><p>numeric.  Size of one pixel in unit of micron, 1 for simulated data.</p>
</dd>
<dt><code>mindt</code></dt><dd><p>numeric. Minimum lag time, 1 for simulated data.</p>
</dd>
<dt><code>pos</code></dt><dd><p>matrix. Position matrix for particle trajectory, see 'Details'.</p>
</dd>
<dt><code>intensity</code></dt><dd><p>matrix. Filled intensity profile, see 'Details'.</p>
</dd>
<dt><code>num_msd</code></dt><dd><p>matrix. Numerical mean squared displacement (MSD).</p>
</dd>
<dt><code>param</code></dt><dd><p>matrix. Parameters used to construct MSD.</p>
</dd>
<dt><code>theor_msd</code></dt><dd><p>matrix. Theoretical MSD.</p>
</dd>
<dt><code>sigma_2_0</code></dt><dd><p>vector. Variance of background noise.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>

<hr>
<h2 id='anisotropic_bm_particle_intensity'>Simulate 2D particle trajectory follows anisotropic Brownian Motion</h2><span id='topic+anisotropic_bm_particle_intensity'></span>

<h3>Description</h3>

<p>Simulate 2D particle trajectory follows anisotropic Brownian Motion (BM) for
<code>M</code> particles, with different step sizes in x, y-directions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anisotropic_bm_particle_intensity(pos0, M, len_t, sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anisotropic_bm_particle_intensity_+3A_pos0">pos0</code></td>
<td>
<p>initial position for <code>M</code> particles, matrix with dimension M by 2</p>
</td></tr>
<tr><td><code id="anisotropic_bm_particle_intensity_+3A_m">M</code></td>
<td>
<p>number of particles</p>
</td></tr>
<tr><td><code id="anisotropic_bm_particle_intensity_+3A_len_t">len_t</code></td>
<td>
<p>number of time steps</p>
</td></tr>
<tr><td><code id="anisotropic_bm_particle_intensity_+3A_sigma">sigma</code></td>
<td>
<p>distance moved per time step in x,y-directions, a vector of length 2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Position matrix with dimension <code>M</code><code class="reqn">\times</code><code>len_t</code>
by 2 for particle trajectory. The first <code>M</code> rows being the initial position
<code>pos0</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
M = 10
len_t = 50
sigma = c(0.5,0.1)
pos0 = matrix(100/8+0.75*100*runif(M*2),nrow=M,ncol=2)
pos = anisotropic_bm_particle_intensity(pos0=pos0,M=M,len_t=len_t,sigma=sigma)
</code></pre>

<hr>
<h2 id='anisotropic_fbm_ou_particle_intensity'>Simulate 2D particle trajectory follows anisotropic fBM plus OU</h2><span id='topic+anisotropic_fbm_ou_particle_intensity'></span>

<h3>Description</h3>

<p>Simulate 2D particle trajectory follows anisotropic fraction Brownian
Motion(fBM) plus a Ornstein–Uhlenbeck(OU) process for <code>M</code> particles,
with different step sizes in x, y-directions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anisotropic_fbm_ou_particle_intensity(
  pos0,
  M,
  len_t,
  sigma_fbm,
  sigma_ou,
  H,
  rho
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anisotropic_fbm_ou_particle_intensity_+3A_pos0">pos0</code></td>
<td>
<p>initial position for <code>M</code> particles, matrix with dimension M by 2</p>
</td></tr>
<tr><td><code id="anisotropic_fbm_ou_particle_intensity_+3A_m">M</code></td>
<td>
<p>number of particles</p>
</td></tr>
<tr><td><code id="anisotropic_fbm_ou_particle_intensity_+3A_len_t">len_t</code></td>
<td>
<p>number of time steps</p>
</td></tr>
<tr><td><code id="anisotropic_fbm_ou_particle_intensity_+3A_sigma_fbm">sigma_fbm</code></td>
<td>
<p>distance moved per time step in fractional Brownian Motion
in x, y-directions, a vector of length 2</p>
</td></tr>
<tr><td><code id="anisotropic_fbm_ou_particle_intensity_+3A_sigma_ou">sigma_ou</code></td>
<td>
<p>distance moved per time step in Ornstein–Uhlenbeck process
in x, y-directions, a vector of length 2</p>
</td></tr>
<tr><td><code id="anisotropic_fbm_ou_particle_intensity_+3A_h">H</code></td>
<td>
<p>Hurst parameter of fractional Brownian Motion in x, y-directions,
a vector of length 2 with values between 0 and 1</p>
</td></tr>
<tr><td><code id="anisotropic_fbm_ou_particle_intensity_+3A_rho">rho</code></td>
<td>
<p>correlation between successive step and previous step in OU process
in x, y-directions, a vector of length 2 with values between 0 and 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Position matrix with dimension <code>M</code><code class="reqn">\times</code><code>len_t</code>
by 2 for particle trajectory. The first <code>M</code> rows being the initial position
<code>pos0</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
M = 10
len_t = 50
sigma_fbm = c(2,1)
H = c(0.3,0.4)
sigma_ou = c(2,2.5)
rho = c(0.95,0.9)
pos0 = matrix(100/8+0.75*100*runif(M*2),nrow=M,ncol=2)

pos = anisotropic_fbm_ou_particle_intensity(pos0=pos0, M=M, len_t=len_t,
  sigma_fbm=sigma_fbm, sigma_ou=sigma_ou, H=H, rho=rho)
</code></pre>

<hr>
<h2 id='anisotropic_fbm_particle_intensity'>Simulate 2D particle trajectory follows anisotropic fBM</h2><span id='topic+anisotropic_fbm_particle_intensity'></span>

<h3>Description</h3>

<p>Simulate 2D particle trajectory follows anisotropic fraction Brownian Motion(fBM) for
<code>M</code> particles, with different step sizes in x, y-directions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anisotropic_fbm_particle_intensity(pos0, M, len_t, sigma, H)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anisotropic_fbm_particle_intensity_+3A_pos0">pos0</code></td>
<td>
<p>initial position for <code>M</code> particles, matrix with dimension M by 2</p>
</td></tr>
<tr><td><code id="anisotropic_fbm_particle_intensity_+3A_m">M</code></td>
<td>
<p>number of particles</p>
</td></tr>
<tr><td><code id="anisotropic_fbm_particle_intensity_+3A_len_t">len_t</code></td>
<td>
<p>number of time steps</p>
</td></tr>
<tr><td><code id="anisotropic_fbm_particle_intensity_+3A_sigma">sigma</code></td>
<td>
<p>distance moved per time step in x, y-directions, a vector of length 2</p>
</td></tr>
<tr><td><code id="anisotropic_fbm_particle_intensity_+3A_h">H</code></td>
<td>
<p>Hurst parameter in x, y-directions, a vector of length 2, value
between 0 and 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Position matrix with dimension <code>M</code><code class="reqn">\times</code><code>len_t</code>
by 2 for particle trajectory. The first <code>M</code> rows being the initial position
<code>pos0</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
M = 10
len_t = 50
sigma = c(2,1)
H = c(0.3,0.4)
pos0 = matrix(100/8+0.75*100*runif(M*2),nrow=M,ncol=2)
pos = anisotropic_fbm_particle_intensity(pos0=pos0,M=M,len_t=len_t,sigma=sigma,H=H)
</code></pre>

<hr>
<h2 id='anisotropic_log_lik'>Log likelihood for anisotropic processes</h2><span id='topic+anisotropic_log_lik'></span>

<h3>Description</h3>

<p>This function computes the natural logarithm of the likelihood of the
latent factor model for selected range of wave vectors of anisotropic
processes. See 'References'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anisotropic_log_lik(
  param,
  I_q_cur,
  B_cur,
  index_q,
  I_o_q_2_ori,
  d_input,
  q_ori_ring_loc_unique_index,
  sz,
  len_t,
  q1,
  q2,
  q1_unique_index,
  q2_unique_index,
  model_name,
  msd_fn = NA,
  msd_grad_fn = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anisotropic_log_lik_+3A_param">param</code></td>
<td>
<p>a vector of natural logarithm of parameters</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_+3A_i_q_cur">I_q_cur</code></td>
<td>
<p>Fourier transformed intensity profile</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_+3A_b_cur">B_cur</code></td>
<td>
<p>current value of B. This parameter is determined by the noise
in the system. See 'References'.</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_+3A_index_q">index_q</code></td>
<td>
<p>selected index of wave number</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_+3A_i_o_q_2_ori">I_o_q_2_ori</code></td>
<td>
<p>absolute square of Fourier transformed intensity profile,
ensemble over time</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_+3A_d_input">d_input</code></td>
<td>
<p>sequence of lag times</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_+3A_q_ori_ring_loc_unique_index">q_ori_ring_loc_unique_index</code></td>
<td>
<p>index for wave vector that give unique frequency</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_+3A_sz">sz</code></td>
<td>
<p>frame size of the intensity profile</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_+3A_len_t">len_t</code></td>
<td>
<p>number of time steps</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_+3A_q1">q1</code></td>
<td>
<p>wave vector in unit of um^-1 in x direction</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_+3A_q2">q2</code></td>
<td>
<p>wave vector in unit of um^-1 in y direction</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_+3A_q1_unique_index">q1_unique_index</code></td>
<td>
<p>index for wave vector that give unique frequency in x direction</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_+3A_q2_unique_index">q2_unique_index</code></td>
<td>
<p>index for wave vector that give unique frequency in y direction</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_+3A_model_name">model_name</code></td>
<td>
<p>model for constructing MSD, options from ('BM','OU',
'FBM','OU+FBM', 'user_defined')</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_+3A_msd_fn">msd_fn</code></td>
<td>
<p>user defined mean squared displacement structure (MSD), a
function of <code>param</code> parameters and <code>d_input</code> lag times</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_+3A_msd_grad_fn">msd_grad_fn</code></td>
<td>
<p>user defined MSD gradient structure,  a function of
<code>param</code> and <code>d_input</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The numerical value of natural logarithm of the likelihood.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>

<hr>
<h2 id='anisotropic_log_lik_grad'>Gradient of log likelihood for anisotropic processes</h2><span id='topic+anisotropic_log_lik_grad'></span>

<h3>Description</h3>

<p>This function computes the gradient for natural logarithm of the likelihood
for selected range of wave vectors of anisotropic processes. See 'References'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anisotropic_log_lik_grad(
  param,
  I_q_cur,
  B_cur,
  index_q,
  I_o_q_2_ori,
  d_input,
  q_ori_ring_loc_unique_index,
  sz,
  len_t,
  model_name,
  q1,
  q2,
  q1_unique_index,
  q2_unique_index,
  msd_fn = NA,
  msd_grad_fn = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anisotropic_log_lik_grad_+3A_param">param</code></td>
<td>
<p>a vector of natural logarithm of parameters</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_grad_+3A_i_q_cur">I_q_cur</code></td>
<td>
<p>Fourier transformed intensity profile</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_grad_+3A_b_cur">B_cur</code></td>
<td>
<p>current value of B. This parameter is determined by the noise
in the system. See 'References'.</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_grad_+3A_index_q">index_q</code></td>
<td>
<p>selected index of wave number</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_grad_+3A_i_o_q_2_ori">I_o_q_2_ori</code></td>
<td>
<p>absolute square of Fourier transformed intensity profile,
ensemble over time</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_grad_+3A_d_input">d_input</code></td>
<td>
<p>sequence of lag times</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_grad_+3A_q_ori_ring_loc_unique_index">q_ori_ring_loc_unique_index</code></td>
<td>
<p>index for wave vector that give unique frequency</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_grad_+3A_sz">sz</code></td>
<td>
<p>frame size of the intensity profile</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_grad_+3A_len_t">len_t</code></td>
<td>
<p>number of time steps</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_grad_+3A_model_name">model_name</code></td>
<td>
<p>stochastic process for constructing MSD, options from ('BM',
'OU','FBM','OU+FBM', 'user_defined')</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_grad_+3A_q1">q1</code></td>
<td>
<p>wave vector in unit of um^-1 in x direction</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_grad_+3A_q2">q2</code></td>
<td>
<p>wave vector in unit of um^-1 in y direction</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_grad_+3A_q1_unique_index">q1_unique_index</code></td>
<td>
<p>index for wave vector that give unique frequency in x direction</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_grad_+3A_q2_unique_index">q2_unique_index</code></td>
<td>
<p>index for wave vector that give unique frequency in y direction</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_grad_+3A_msd_fn">msd_fn</code></td>
<td>
<p>user defined mean squared displacement structure (MSD), a
function of <code>param</code> parameters and <code>d_input</code> lag times</p>
</td></tr>
<tr><td><code id="anisotropic_log_lik_grad_+3A_msd_grad_fn">msd_grad_fn</code></td>
<td>
<p>user defined MSD gradient structure,  a function of
<code>param</code> and <code>d_input</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The numerical value of gradient for natural logarithm of the likelihood.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>

<hr>
<h2 id='anisotropic_numerical_msd'>Compute anisotropic numerical MSD</h2><span id='topic+anisotropic_numerical_msd'></span>

<h3>Description</h3>

<p>Compute numerical mean squared displacement(MSD) based on particle trajectory
for anisotropic processes in x,y-directions separately.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anisotropic_numerical_msd(pos, M, len_t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anisotropic_numerical_msd_+3A_pos">pos</code></td>
<td>
<p>position matrix for particle trajectory. See 'Details'.</p>
</td></tr>
<tr><td><code id="anisotropic_numerical_msd_+3A_m">M</code></td>
<td>
<p>number of particles</p>
</td></tr>
<tr><td><code id="anisotropic_numerical_msd_+3A_len_t">len_t</code></td>
<td>
<p>number of time steps</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Input <code>pos</code> should be the position matrix with dimension
<code>M</code><code class="reqn">\times</code><code>len_t</code>. See <code><a href="#topic+bm_particle_intensity">bm_particle_intensity</a></code>,
<code><a href="#topic+ou_particle_intensity">ou_particle_intensity</a></code>, <code><a href="#topic+fbm_particle_intensity">fbm_particle_intensity</a></code>,
<code><a href="#topic+fbm_ou_particle_intensity">fbm_ou_particle_intensity</a></code>.
</p>


<h3>Value</h3>

<p>A matrix of numerical MSD for given lag times in x,y-directions,
dimension 2 by <code>len_t</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
# Simulate particle trajectory for BM
M = 10
len_t = 50
sigma = c(0.5,0.1)
pos0 = matrix(100/8+0.75*100*runif(M*2),nrow=M,ncol=2)
pos = anisotropic_bm_particle_intensity(pos0=pos0,M=M,len_t=len_t,sigma=sigma)

# Compute numerical MSD
(num_msd = anisotropic_numerical_msd(pos=pos, M=M, len_t=len_t))
</code></pre>

<hr>
<h2 id='anisotropic_ou_particle_intensity'>Simulate 2D particle trajectory follows anisotropic OU process</h2><span id='topic+anisotropic_ou_particle_intensity'></span>

<h3>Description</h3>

<p>Simulate 2D particle trajectory follows anisotropic Ornstein–Uhlenbeck
process(OU) for <code>M</code> particles, with different step sizes in x, y-directions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anisotropic_ou_particle_intensity(pos0, M, len_t, sigma, rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anisotropic_ou_particle_intensity_+3A_pos0">pos0</code></td>
<td>
<p>initial position for <code>M</code> particles, matrix with dimension M by 2</p>
</td></tr>
<tr><td><code id="anisotropic_ou_particle_intensity_+3A_m">M</code></td>
<td>
<p>number of particles</p>
</td></tr>
<tr><td><code id="anisotropic_ou_particle_intensity_+3A_len_t">len_t</code></td>
<td>
<p>number of time steps</p>
</td></tr>
<tr><td><code id="anisotropic_ou_particle_intensity_+3A_sigma">sigma</code></td>
<td>
<p>distance moved per time step in x, y-directions, a vector of length 2</p>
</td></tr>
<tr><td><code id="anisotropic_ou_particle_intensity_+3A_rho">rho</code></td>
<td>
<p>correlation between successive step and previous step in x, y-directions,
a vector of length 2 with values between 0 and 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Position matrix with dimension <code>M</code><code class="reqn">\times</code><code>len_t</code>
by 2 for particle trajectory. The first <code>M</code> rows being the initial position
<code>pos0</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
M = 10
len_t = 50
sigma = c(2,2.5)
rho = c(0.95,0.9)
pos0 = matrix(100/8+0.75*100*runif(M*2),nrow=M,ncol=2)
pos = anisotropic_ou_particle_intensity(pos0=pos0,M=M,len_t=len_t,sigma=sigma, rho=rho)
</code></pre>

<hr>
<h2 id='bm_particle_intensity'>Simulate 2D particle trajectory follows Brownian Motion</h2><span id='topic+bm_particle_intensity'></span>

<h3>Description</h3>

<p>Simulate 2D particle trajectory follows Brownian Motion (BM) for <code>M</code>
particles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bm_particle_intensity(pos0, M, len_t, sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bm_particle_intensity_+3A_pos0">pos0</code></td>
<td>
<p>initial position for <code>M</code> particles, matrix with dimension M by 2</p>
</td></tr>
<tr><td><code id="bm_particle_intensity_+3A_m">M</code></td>
<td>
<p>number of particles</p>
</td></tr>
<tr><td><code id="bm_particle_intensity_+3A_len_t">len_t</code></td>
<td>
<p>number of time steps</p>
</td></tr>
<tr><td><code id="bm_particle_intensity_+3A_sigma">sigma</code></td>
<td>
<p>distance moved per time step</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Position matrix with dimension <code>M</code><code class="reqn">\times</code><code>len_t</code>
by 2 for particle trajectory. The first <code>M</code> rows being the initial position
<code>pos0</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
M = 10
len_t = 50
sigma = 0.5
pos0 = matrix(100/8+0.75*100*runif(M*2),nrow=M,ncol=2)
pos = bm_particle_intensity(pos0=pos0,M=M,len_t=len_t,sigma=sigma)
</code></pre>

<hr>
<h2 id='cart2polar'>Transform Cartesian coordinates to polar coordinates</h2><span id='topic+cart2polar'></span>

<h3>Description</h3>

<p>Transform ordered pair (x,y), where x and y denotes the
directed distance between the point and each of two
perpendicular lines, the x-axis and the y-axis, to polar
coordinate. Input x and y must have the same length.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cart2polar(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cart2polar_+3A_x">x</code></td>
<td>
<p>a vector of x-coordinates</p>
</td></tr>
<tr><td><code id="cart2polar_+3A_y">y</code></td>
<td>
<p>a vector of y-coordinates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with 2 variables, where r is the
directed distance from a point designed as the pole, and
theta represents the angle, in radians, between the pole and the point.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)

# Input in Cartesian coordinates
(x &lt;- rep(1:3,each = 3))
(y &lt;- rep(1:3,3))

# Data frame with polar coordinates
(polar &lt;- cart2polar(x, y))

</code></pre>

<hr>
<h2 id='corr_fBM'>Construct correlation matrix for FBM</h2><span id='topic+corr_fBM'></span>

<h3>Description</h3>

<p>Construct correlation matrix for fractional Brownian motion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corr_fBM(len_t, H)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corr_fBM_+3A_len_t">len_t</code></td>
<td>
<p>number of time steps</p>
</td></tr>
<tr><td><code id="corr_fBM_+3A_h">H</code></td>
<td>
<p>Hurst parameter, value between 0 and 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Correlation matrix with dimension <code>len_t-1</code> by <code>len_t-1</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
len_t = 50
H = 0.3
m = corr_fBM(len_t=len_t,H=H)
</code></pre>

<hr>
<h2 id='fbm_ou_particle_intensity'>Simulate 2D particle trajectory follows fBM plus OU</h2><span id='topic+fbm_ou_particle_intensity'></span>

<h3>Description</h3>

<p>Simulate 2D particle trajectory follows fraction Brownian Motion(fBM) plus a
Ornstein–Uhlenbeck(OU) process for <code>M</code> particles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fbm_ou_particle_intensity(pos0, M, len_t, sigma_fbm, sigma_ou, H, rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fbm_ou_particle_intensity_+3A_pos0">pos0</code></td>
<td>
<p>initial position for <code>M</code> particles, matrix with dimension M by 2</p>
</td></tr>
<tr><td><code id="fbm_ou_particle_intensity_+3A_m">M</code></td>
<td>
<p>number of particles</p>
</td></tr>
<tr><td><code id="fbm_ou_particle_intensity_+3A_len_t">len_t</code></td>
<td>
<p>number of time steps</p>
</td></tr>
<tr><td><code id="fbm_ou_particle_intensity_+3A_sigma_fbm">sigma_fbm</code></td>
<td>
<p>distance moved per time step in fractional Brownian Motion</p>
</td></tr>
<tr><td><code id="fbm_ou_particle_intensity_+3A_sigma_ou">sigma_ou</code></td>
<td>
<p>distance moved per time step in Ornstein–Uhlenbeck process</p>
</td></tr>
<tr><td><code id="fbm_ou_particle_intensity_+3A_h">H</code></td>
<td>
<p>Hurst parameter of fractional Brownian Motion, value between 0 and 1</p>
</td></tr>
<tr><td><code id="fbm_ou_particle_intensity_+3A_rho">rho</code></td>
<td>
<p>correlation between successive step and previous step in OU process,
value between 0 and 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Position matrix with dimension <code>M</code><code class="reqn">\times</code><code>len_t</code>
by 2 for particle trajectory. The first <code>M</code> rows being the initial position
<code>pos0</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
M = 10
len_t = 50
sigma_fbm = 2
H = 0.3
sigma_ou = 2
rho = 0.95
pos0 = matrix(100/8+0.75*100*runif(M*2),nrow=M,ncol=2)

pos = fbm_ou_particle_intensity(pos0=pos0, M=M, len_t=len_t,
  sigma_fbm=sigma_fbm, sigma_ou=sigma_ou, H=H, rho=rho)
</code></pre>

<hr>
<h2 id='fbm_particle_intensity'>Simulate 2D particle trajectory follows fBM</h2><span id='topic+fbm_particle_intensity'></span>

<h3>Description</h3>

<p>Simulate 2D particle trajectory follows fraction Brownian Motion(fBM) for
<code>M</code> particles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fbm_particle_intensity(pos0, M, len_t, sigma, H)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fbm_particle_intensity_+3A_pos0">pos0</code></td>
<td>
<p>initial position for <code>M</code> particles, matrix with dimension M by 2</p>
</td></tr>
<tr><td><code id="fbm_particle_intensity_+3A_m">M</code></td>
<td>
<p>number of particles</p>
</td></tr>
<tr><td><code id="fbm_particle_intensity_+3A_len_t">len_t</code></td>
<td>
<p>number of time steps</p>
</td></tr>
<tr><td><code id="fbm_particle_intensity_+3A_sigma">sigma</code></td>
<td>
<p>distance moved per time step</p>
</td></tr>
<tr><td><code id="fbm_particle_intensity_+3A_h">H</code></td>
<td>
<p>Hurst parameter, value between 0 and 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Position matrix with dimension <code>M</code><code class="reqn">\times</code><code>len_t</code>
by 2 for particle trajectory. The first <code>M</code> rows being the initial position
<code>pos0</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
M = 10
len_t = 50
sigma = 2
H = 0.3
pos0 = matrix(100/8+0.75*100*runif(M*2),nrow=M,ncol=2)
pos = fbm_particle_intensity(pos0=pos0,M=M,len_t=len_t,sigma=sigma,H=H)
</code></pre>

<hr>
<h2 id='FFT2D'>2D Fourier transformation and calculate wave number</h2><span id='topic+FFT2D'></span>

<h3>Description</h3>

<p>Perform 2D fast Fourier transformation on SS_T matrix, record frame size for
each frame, total number of frames, and sequence of lag times. Calculate and
record circular wave number for complete q ring.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FFT2D(intensity_list, pxsz, mindt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FFT2D_+3A_intensity_list">intensity_list</code></td>
<td>
<p>intensity profile, SS_T matrix</p>
</td></tr>
<tr><td><code id="FFT2D_+3A_pxsz">pxsz</code></td>
<td>
<p>size of one pixel in unit of micron</p>
</td></tr>
<tr><td><code id="FFT2D_+3A_mindt">mindt</code></td>
<td>
<p>minimum lag time</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object containing transformed intensity profile in reciprocal
space and corresponding parameters.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>

<hr>
<h2 id='fftshift'>fftshift</h2><span id='topic+fftshift'></span>

<h3>Description</h3>

<p>Rearranges a 2D Fourier transform x by shifting the zero-frequency component
to the center of the matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fftshift(x, dim = -1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fftshift_+3A_x">x</code></td>
<td>
<p>square matrix input with odd number of rows and columns</p>
</td></tr>
<tr><td><code id="fftshift_+3A_dim">dim</code></td>
<td>
<p>shift method. See 'Details'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, <code>dim=-1</code>, swaps the first quadrant of x with the
third, and the second quadrant with the fourth. If <code>dim=1</code>, swaps rows 1
to middle with rows (middle+1) to end. If <code>dim=2</code>, swaps columns 1
to middle with columns (middle+1) to end. If <code>dim=3</code>, reverse fftshift.
</p>


<h3>Value</h3>

<p>Shifted matrix.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)

(m &lt;- matrix(0:8,3,3))
fftshift(m)

</code></pre>

<hr>
<h2 id='fill_intensity'>Construct intensity profile for a given particle trajectory</h2><span id='topic+fill_intensity'></span>

<h3>Description</h3>

<p>Construct intensity profile with structure 'T_SS_mat' for a given particle
trajectory, background intensity profile, and user defined radius of particle.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fill_intensity(len_t, M, I, pos, Ic, sz, sigma_p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fill_intensity_+3A_len_t">len_t</code></td>
<td>
<p>number of time steps</p>
</td></tr>
<tr><td><code id="fill_intensity_+3A_m">M</code></td>
<td>
<p>number of particles</p>
</td></tr>
<tr><td><code id="fill_intensity_+3A_i">I</code></td>
<td>
<p>background intensity profile. See 'Details'.</p>
</td></tr>
<tr><td><code id="fill_intensity_+3A_pos">pos</code></td>
<td>
<p>position matrix for particle trajectory</p>
</td></tr>
<tr><td><code id="fill_intensity_+3A_ic">Ic</code></td>
<td>
<p>vector of maximum intensity of each particle</p>
</td></tr>
<tr><td><code id="fill_intensity_+3A_sz">sz</code></td>
<td>
<p>frame size of simulated square image</p>
</td></tr>
<tr><td><code id="fill_intensity_+3A_sigma_p">sigma_p</code></td>
<td>
<p>radius of the spherical particle (3sigma_p)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Input <code>I</code> should has structure 'T_SS_mat', matrix with dimension
<code>len_t</code> by <code>sz</code><code class="reqn">\times</code><code>sz</code>.
</p>
<p>Input <code>pos</code> should be the position matrix with dimension
<code>M</code><code class="reqn">\times</code><code>len_t</code>. See <code><a href="#topic+bm_particle_intensity">bm_particle_intensity</a></code>,
<code><a href="#topic+ou_particle_intensity">ou_particle_intensity</a></code>, <code><a href="#topic+fbm_particle_intensity">fbm_particle_intensity</a></code>,
<code><a href="#topic+fbm_ou_particle_intensity">fbm_ou_particle_intensity</a></code>.
</p>


<h3>Value</h3>

<p>Intensity profile matrix with structure 'T_SS_mat' (matrix with
dimension <code>len_t</code> by <code>sz</code><code class="reqn">\times</code><code>sz</code>).
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>

<hr>
<h2 id='get_dqt'>Compute observed dynamic image structure function</h2><span id='topic+get_dqt'></span>

<h3>Description</h3>

<p>Compute observed dynamic image structure function (Dqt) using object of
<code>SAM</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_dqt(object, index_q = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_dqt_+3A_object">object</code></td>
<td>
<p>an S4 object of class <code>SAM</code></p>
</td></tr>
<tr><td><code id="get_dqt_+3A_index_q">index_q</code></td>
<td>
<p>wavevector range used for computing Dqt</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of observed dynamic image structure function with dimension
<code>len_q</code> by <code>len_t-1</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AIUQ)
sim_bm = simulation(len_t=100,sz=100,sigma_bm=0.5)
show(sim_bm)
sam = SAM(sim_object = sim_bm)
show(sam)
Dqt = get_dqt(object=sam)

## End(Not run)
</code></pre>

<hr>
<h2 id='get_est_param'>Transform parameters estimated in SAM class to parameters structure in MSD function</h2><span id='topic+get_est_param'></span>

<h3>Description</h3>

<p>Transform parameters estimated using Maximum Likelihood Estimation (MLE) in
<code>SAM</code> class, to parameters contained in MSD with structure <code>theta</code>
in <code><a href="#topic+get_MSD">get_MSD</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_est_param(theta, model_name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_est_param_+3A_theta">theta</code></td>
<td>
<p>estimated parameters through MLE</p>
</td></tr>
<tr><td><code id="get_est_param_+3A_model_name">model_name</code></td>
<td>
<p>fitted stochastic process, options from ('BM','OU','FBM','OU+FBM')</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of estimated parameters after transformation with structure
<code>theta</code> in <code><a href="#topic+get_MSD">get_MSD</a></code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>

<hr>
<h2 id='get_est_parameters_MSD_SAM_interval'>Construct 95% confidence interval</h2><span id='topic+get_est_parameters_MSD_SAM_interval'></span>

<h3>Description</h3>

<p>This function construct the lower and upper bound for 95% confidence interval
of estimated parameters and mean squared displacement(MSD) for a given model.
See 'References'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_est_parameters_MSD_SAM_interval(
  param_uq_range,
  model_name,
  d_input,
  msd_fn = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_est_parameters_MSD_SAM_interval_+3A_param_uq_range">param_uq_range</code></td>
<td>
<p>lower and upper bound for natural logorithm of
parameters in the fitted model using <code>AIUQ</code> method in <code>SAM</code> class</p>
</td></tr>
<tr><td><code id="get_est_parameters_MSD_SAM_interval_+3A_model_name">model_name</code></td>
<td>
<p>model for constructing MSD, options from ('BM','OU',
'FBM','OU+FBM', 'user_defined')</p>
</td></tr>
<tr><td><code id="get_est_parameters_MSD_SAM_interval_+3A_d_input">d_input</code></td>
<td>
<p>sequence of lag times</p>
</td></tr>
<tr><td><code id="get_est_parameters_MSD_SAM_interval_+3A_msd_fn">msd_fn</code></td>
<td>
<p>user defined mean squared displacement structure (MSD), a
function of <code>param</code> parameters and <code>d_input</code> lag times</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of lower and upper bound for 95% confidence interval
of estimated parameters and MSD for a given model.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>

<hr>
<h2 id='get_est_parameters_MSD_SAM_interval_anisotropic'>Construct 95% confidence interval for anisotropic processes</h2><span id='topic+get_est_parameters_MSD_SAM_interval_anisotropic'></span>

<h3>Description</h3>

<p>This function construct the lower and upper bound for 95% confidence interval
of estimated parameters and mean squared displacement(MSD) for a given
anisotropic model. See 'References'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_est_parameters_MSD_SAM_interval_anisotropic(
  param_uq_range,
  model_name,
  d_input,
  msd_fn = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_est_parameters_MSD_SAM_interval_anisotropic_+3A_param_uq_range">param_uq_range</code></td>
<td>
<p>lower and upper bound for natural logorithm of
parameters in the fitted model using <code>AIUQ</code> method in <code>aniso_SAM</code> class</p>
</td></tr>
<tr><td><code id="get_est_parameters_MSD_SAM_interval_anisotropic_+3A_model_name">model_name</code></td>
<td>
<p>model for constructing MSD, options from ('BM','OU',
'FBM','OU+FBM', 'user_defined')</p>
</td></tr>
<tr><td><code id="get_est_parameters_MSD_SAM_interval_anisotropic_+3A_d_input">d_input</code></td>
<td>
<p>sequence of lag times</p>
</td></tr>
<tr><td><code id="get_est_parameters_MSD_SAM_interval_anisotropic_+3A_msd_fn">msd_fn</code></td>
<td>
<p>user defined mean squared displacement structure (MSD), a
function of <code>param</code> parameters and <code>d_input</code> lag times</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of lower and upper bound for 95% confidence interval
of estimated parameters and MSD for a given model.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>

<hr>
<h2 id='get_grad_trans'>Construct parameter transformation for optimization using exact gradient</h2><span id='topic+get_grad_trans'></span>

<h3>Description</h3>

<p>Construct parameter transformation for parameters to be optimized over in <code>AIUQ</code>
method of <code>SAM</code> class. See 'References'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_grad_trans(theta, d_input, model_name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_grad_trans_+3A_theta">theta</code></td>
<td>
<p>parameters to be optimized over</p>
</td></tr>
<tr><td><code id="get_grad_trans_+3A_d_input">d_input</code></td>
<td>
<p>sequence of lag times</p>
</td></tr>
<tr><td><code id="get_grad_trans_+3A_model_name">model_name</code></td>
<td>
<p>model name for the fitted model, options from ('BM','OU',
'FBM',OU+FBM','user_defined')</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of transformed parameters to be optimized over in <code>AIUQ</code>
method of <code>SAM</code> class.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>

<hr>
<h2 id='get_initial_param'>Construct initial values for the parameters to be optimized over</h2><span id='topic+get_initial_param'></span>

<h3>Description</h3>

<p>Construct initial values for the parameters to be optimized over in <code>AIUQ</code>
method of <code>SAM</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_initial_param(model_name, sigma_0_2_ini = NA, num_param = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_initial_param_+3A_model_name">model_name</code></td>
<td>
<p>fitted model, options from  ('BM','OU','FBM','OU+FBM',
'user_defined'), with Brownian motion as the default model. See 'Details'.</p>
</td></tr>
<tr><td><code id="get_initial_param_+3A_sigma_0_2_ini">sigma_0_2_ini</code></td>
<td>
<p>initial value for background noise, default is <code>NA</code></p>
</td></tr>
<tr><td><code id="get_initial_param_+3A_num_param">num_param</code></td>
<td>
<p>number of parameters need to be estimated in the model,
need to be non-NA value for <code>'user_defined'</code> model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>model_name</code> equals 'user_defined', then <code>num_param</code> need to be
provided to determine the length of the initial values vector.
</p>


<h3>Value</h3>

<p>A matrix with one row of initial values for the parameters to be
optimized over in <code>AIUQ</code> method of <code>SAM</code> class.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
get_initial_param(model_name = "BM")
</code></pre>

<hr>
<h2 id='get_isf'>Compute empirical intermediate scattering function</h2><span id='topic+get_isf'></span>

<h3>Description</h3>

<p>Compute empirical intermediate scattering function (ISF) using object of
<code>SAM</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_isf(object, index_q = NA, msd_truth = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_isf_+3A_object">object</code></td>
<td>
<p>an S4 object of class <code>SAM</code></p>
</td></tr>
<tr><td><code id="get_isf_+3A_index_q">index_q</code></td>
<td>
<p>wavevector range used for computing ISF</p>
</td></tr>
<tr><td><code id="get_isf_+3A_msd_truth">msd_truth</code></td>
<td>
<p>true or reference MSD</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of empirical intermediate scattering function with dimension
<code>len_q</code> by <code>len_t-1</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(AIUQ)
sim_bm = simulation(len_t=100,sz=100,sigma_bm=0.5)
show(sim_bm)
sam = SAM(sim_object = sim_bm)
show(sam)
ISF = get_isf(object=sam)

## End(Not run)
</code></pre>

<hr>
<h2 id='get_MSD'>Construct MSD</h2><span id='topic+get_MSD'></span>

<h3>Description</h3>

<p>Construct estimated mean squared displacement (MSD) for a given stochastic process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_MSD(theta, d_input, model_name, msd_fn = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_MSD_+3A_theta">theta</code></td>
<td>
<p>parameters in MSD function</p>
</td></tr>
<tr><td><code id="get_MSD_+3A_d_input">d_input</code></td>
<td>
<p>sequence of lag times</p>
</td></tr>
<tr><td><code id="get_MSD_+3A_model_name">model_name</code></td>
<td>
<p>model name for the process, options from ('BM','OU','FBM',
'OU+FBM','user_defined')</p>
</td></tr>
<tr><td><code id="get_MSD_+3A_msd_fn">msd_fn</code></td>
<td>
<p>user defined mean squared displacement structure (MSD), a
function of <code>param</code> parameters and <code>d_input</code> lag times</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For Brownian Motion, the MSD follows
</p>
<p style="text-align: center;"><code class="reqn">MSD_{BM}(\Delta t) = \theta_1\Delta t= 4D\Delta t</code>
</p>

<p>where <code>D</code> is the diffusion coefficient.
</p>
<p>For Ornstein–Uhlenbeck process,  the MSD follows
</p>
<p style="text-align: center;"><code class="reqn">MSD_{OU}(\Delta t) = \theta_2(1-\theta_1^{\Delta t})</code>
</p>

<p>where <code class="reqn">\theta_1=\rho</code>
is the correlation with previous steps.
</p>
<p>For fractional Brownian Motion,  the MSD follows
</p>
<p style="text-align: center;"><code class="reqn">MSD_{FBM}(\Delta t) =\theta_1\Delta t^{\theta_2}</code>
</p>

<p>where <code class="reqn">\theta_2=2H</code> with <code>H</code> is the the Hurst parameter.
</p>
<p>For 'OU+FBM', the MSD follows
</p>
<p style="text-align: center;"><code class="reqn">MSD_{OU+FBM}(\Delta t) = \theta_2(1-\theta_1^{\Delta t})+\theta_3\Delta t^{\theta_4}</code>
</p>



<h3>Value</h3>

<p>A vector of MSD values for a given sequence of lag times.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
# Construct MSD for BM
get_MSD(theta=0.2,d_input=0:100,model_name='BM')

</code></pre>

<hr>
<h2 id='get_MSD_with_grad'>Construct MSD and MSD gradient with transformed parameters</h2><span id='topic+get_MSD_with_grad'></span>

<h3>Description</h3>

<p>Construct mean squared displacement (MSD) and its gradient for a given
stochastic process or a user defined MSD and gradient structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_MSD_with_grad(theta, d_input, model_name, msd_fn = NA, msd_grad_fn = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_MSD_with_grad_+3A_theta">theta</code></td>
<td>
<p>transformed parameters in MSD function for MLE estimation</p>
</td></tr>
<tr><td><code id="get_MSD_with_grad_+3A_d_input">d_input</code></td>
<td>
<p>sequence of lag times</p>
</td></tr>
<tr><td><code id="get_MSD_with_grad_+3A_model_name">model_name</code></td>
<td>
<p>model name for the process, options from  ('BM','OU','FBM',
'OU+FBM', 'user_defined').</p>
</td></tr>
<tr><td><code id="get_MSD_with_grad_+3A_msd_fn">msd_fn</code></td>
<td>
<p>user defined MSD structure, a function of <code>theta</code> and <code>d_input</code></p>
</td></tr>
<tr><td><code id="get_MSD_with_grad_+3A_msd_grad_fn">msd_grad_fn</code></td>
<td>
<p>user defined MSD gradient structure,  a function of
<code>theta</code> and <code>d_input</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note for non <code>user_defined</code> model, <code>msd_fn</code> and <code>msd_grad_fn</code>
are not needed. For Brownian Motion, the MSD follows
</p>
<p style="text-align: center;"><code class="reqn">MSD_{BM}(\Delta t) = \theta_1\Delta t= 4D\Delta t</code>
</p>

<p>where <code>D</code> is the diffusion coefficient.
</p>
<p>For Ornstein–Uhlenbeck process,  the MSD follows
</p>
<p style="text-align: center;"><code class="reqn">MSD_{OU}(\Delta t) = \theta_2(1-\frac{\theta_1}{1+\theta_1}^{\Delta t})</code>
</p>

<p>where <code class="reqn">\frac{\theta_1}{1+\theta_1}=\rho</code>
is the correlation with previous steps.
</p>
<p>For fractional Brownian Motion,  the MSD follows
</p>
<p style="text-align: center;"><code class="reqn">MSD_{FBM}(\Delta t) =\theta_1\Delta t^{\frac{2\theta_2}{1+\theta_2}}</code>
</p>

<p>where <code class="reqn">\frac{2\theta_2}{1+\theta_2}=2H</code>
with <code>H</code> is the the Hurst parameter.
</p>
<p>For 'OU+FBM', the MSD follows
</p>
<p style="text-align: center;"><code class="reqn">MSD_{OU+FBM}(\Delta t) = \theta_2(1-\frac{\theta_1}{1+\theta_1}^{\Delta t})+\theta_3\Delta t^{\frac{2\theta_4}{1+\theta_4}}</code>
</p>



<h3>Value</h3>

<p>A list of two variables, MSD and MSD gradient.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
msd_fn &lt;- function(param, d_input){
  beta = 2*param[1]^2
  MSD = beta*d_input
}
msd_grad_fn &lt;- function(param, d_input){
  MSD_grad = 4*param[1]*d_input
}

theta = 2
d_input = 0:10
model_name = "user_defined"

MSD_list = get_MSD_with_grad(theta=theta,d_input=d_input,
                             model_name=model_name,msd_fn=msd_fn,
                             msd_grad_fn=msd_grad_fn)
MSD_list$msd
MSD_list$msd_grad

</code></pre>

<hr>
<h2 id='get_true_param_aniso_sim'>Transform parameters in anisotropic simulation class to parameters structure in MSD function</h2><span id='topic+get_true_param_aniso_sim'></span>

<h3>Description</h3>

<p>Transform parameters in <code>aniso_simulation</code> class to parameters contained in MSD
function with structure <code>theta</code> in <code><a href="#topic+get_MSD">get_MSD</a></code>. Prepare for
truth MSD construction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_true_param_aniso_sim(param_truth, model_name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_true_param_aniso_sim_+3A_param_truth">param_truth</code></td>
<td>
<p>parameters used in <code>aniso_simulation</code> class</p>
</td></tr>
<tr><td><code id="get_true_param_aniso_sim_+3A_model_name">model_name</code></td>
<td>
<p>stochastic process used in <code>aniso_simulation</code>, options from
('BM','OU','FBM','OU+FBM')</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of parameters contained in MSD with structure <code>theta</code> in
<code><a href="#topic+get_MSD">get_MSD</a></code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
# Simulate simple diffusion for 100 images with 100 by 100 pixels and
# distance moved per time step is 0.5
aniso_sim_bm = aniso_simulation(sz=100,len_t=100,sigma_bm=c(0.5,0.1))
show(aniso_sim_bm)
get_true_param_aniso_sim(param_truth=aniso_sim_bm@param,model_name=aniso_sim_bm@model_name)

</code></pre>

<hr>
<h2 id='get_true_param_sim'>Transform parameters in simulation class to parameters structure in MSD function</h2><span id='topic+get_true_param_sim'></span>

<h3>Description</h3>

<p>Transform parameters in <code>simulation</code> class to parameters contained in MSD
function with structure <code>theta</code> in <code><a href="#topic+get_MSD">get_MSD</a></code>. Prepare for
truth MSD construction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_true_param_sim(param_truth, model_name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_true_param_sim_+3A_param_truth">param_truth</code></td>
<td>
<p>parameters used in <code>simulation</code> class</p>
</td></tr>
<tr><td><code id="get_true_param_sim_+3A_model_name">model_name</code></td>
<td>
<p>stochastic process used in <code>simulation</code>, options from
('BM','OU','FBM','OU+FBM')</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of parameters contained in MSD with structure <code>theta</code> in
<code><a href="#topic+get_MSD">get_MSD</a></code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
# Simulate simple diffusion for 100 images with 100 by 100 pixels and
# distance moved per time step is 0.5
sim_bm = simulation(sz=100,len_t=100,sigma_bm=0.5)
show(sim_bm)
get_true_param_sim(param_truth=sim_bm@param,model_name=sim_bm@model_name)

</code></pre>

<hr>
<h2 id='intensity_format_transform'>Transform intensity profile into SS_T matrix</h2><span id='topic+intensity_format_transform'></span>

<h3>Description</h3>

<p>Transform intensity profile with different formats, ('SST_array','T_SS_mat',
'SS_T_mat','S_ST_mat'), space by space by time array, time by (space by space) matrix,
(space by space) by time matrix, or space by (space by time) matrix, into
'SS_T_mat'. In addition, crop each frame with odd frame size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intensity_format_transform(intensity, intensity_str, square = FALSE, sz = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intensity_format_transform_+3A_intensity">intensity</code></td>
<td>
<p>intensity profile, array or matrix</p>
</td></tr>
<tr><td><code id="intensity_format_transform_+3A_intensity_str">intensity_str</code></td>
<td>
<p>structure of the original intensity
profile, options from ('SST_array','T_SS_mat','SS_T_mat','S_ST_mat')</p>
</td></tr>
<tr><td><code id="intensity_format_transform_+3A_square">square</code></td>
<td>
<p>a logical evaluating to TRUE or FALSE indicating whether or not
to crop each frame into a square such that frame size in x direction equals
frame size in y direction with <code>sz_x=sz_y</code></p>
</td></tr>
<tr><td><code id="intensity_format_transform_+3A_sz">sz</code></td>
<td>
<p>frame size of each frame. A vector of length 2 with frame size in
y/(row) direction, and frame size in x/(column) direction, with default <code>NA</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of transformed intensity profile.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
# -------------------------------------------------
# Example 1: Transform T_SS_mat into SS_T_mat, each
#             frame contains number 1-9
# -------------------------------------------------
(m &lt;- matrix(rep(1:9,4),4,9,byrow=TRUE))
intensity_format_transform(m,intensity_str="T_SS_mat",sz=c(4,9))

# -------------------------------------------------
# Example 2: Transform SST_array into SS_T_mat, each
#             frame contains number 1-9
# -------------------------------------------------
(m &lt;- array(rep(1:9,4),dim=c(3,3,4)))
intensity_format_transform(m,intensity_str="SST_array")

</code></pre>

<hr>
<h2 id='l2_estAB'>Compute l2 loss for Dqt</h2><span id='topic+l2_estAB'></span>

<h3>Description</h3>

<p>Compute l2 loss for dynamic image structure function(Dqt) using A(q) and B
are both estimated within the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>l2_estAB(
  param,
  Dqt_cur,
  q_cur,
  d_input,
  model_name,
  msd_fn = NA,
  msd_grad_fn = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="l2_estAB_+3A_param">param</code></td>
<td>
<p>a vector of natural logarithm of parameters</p>
</td></tr>
<tr><td><code id="l2_estAB_+3A_dqt_cur">Dqt_cur</code></td>
<td>
<p>observed dynamic image structure function. See 'Details'.</p>
</td></tr>
<tr><td><code id="l2_estAB_+3A_q_cur">q_cur</code></td>
<td>
<p>wave vector in unit of um^-1</p>
</td></tr>
<tr><td><code id="l2_estAB_+3A_d_input">d_input</code></td>
<td>
<p>sequence of lag times</p>
</td></tr>
<tr><td><code id="l2_estAB_+3A_model_name">model_name</code></td>
<td>
<p>model name for the fitted model, options from ('BM','OU',
'FBM',OU+FBM','user_defined')</p>
</td></tr>
<tr><td><code id="l2_estAB_+3A_msd_fn">msd_fn</code></td>
<td>
<p>msd_fn user defined mean squared displacement structure (MSD), a
function of <code>param</code> parameters and <code>d_input</code> lag times</p>
</td></tr>
<tr><td><code id="l2_estAB_+3A_msd_grad_fn">msd_grad_fn</code></td>
<td>
<p>user defined MSD gradient structure,  a function of
<code>param</code> and <code>d_input</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Dynamic image structure function(Dqt) can be obtained from ensemble average
of absolute values squared of Four transformed intensity difference:
</p>
<p style="text-align: center;"><code class="reqn">D(q,\Delta t) = \langle |\Delta \hat{I}(q,t,\Delta t)|^2\rangle</code>
</p>

<p>See 'References'.
</p>


<h3>Value</h3>

<p>Squared differences between the true Dqt and the predicted Dqt.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>

<hr>
<h2 id='l2_fixedAB'>Compute l2 loss for Dqt with fixed A(q) and B</h2><span id='topic+l2_fixedAB'></span>

<h3>Description</h3>

<p>Compute l2 loss for dynamic image structure function(Dqt) using fixed A(q)
and B parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>l2_fixedAB(
  param,
  Dqt_cur,
  q_cur,
  A_est_q_cur,
  B_est,
  d_input,
  model_name,
  msd_fn = NA,
  msd_grad_fn = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="l2_fixedAB_+3A_param">param</code></td>
<td>
<p>a vector of natural logarithm of parameters</p>
</td></tr>
<tr><td><code id="l2_fixedAB_+3A_dqt_cur">Dqt_cur</code></td>
<td>
<p>observed dynamic image structure function. See 'Details'.</p>
</td></tr>
<tr><td><code id="l2_fixedAB_+3A_q_cur">q_cur</code></td>
<td>
<p>wave vector in unit of um^-1</p>
</td></tr>
<tr><td><code id="l2_fixedAB_+3A_a_est_q_cur">A_est_q_cur</code></td>
<td>
<p>estimated value of A(q). This parameter is determined by
the properties of the imaged material and imaging optics. See 'References'.</p>
</td></tr>
<tr><td><code id="l2_fixedAB_+3A_b_est">B_est</code></td>
<td>
<p>estimated value of B. This parameter is determined by the noise
in the system. See 'References'.</p>
</td></tr>
<tr><td><code id="l2_fixedAB_+3A_d_input">d_input</code></td>
<td>
<p>sequence of lag times</p>
</td></tr>
<tr><td><code id="l2_fixedAB_+3A_model_name">model_name</code></td>
<td>
<p>model name for the fitted model, options from ('BM','OU',
'FBM',OU+FBM','user_defined')</p>
</td></tr>
<tr><td><code id="l2_fixedAB_+3A_msd_fn">msd_fn</code></td>
<td>
<p>msd_fn user defined mean squared displacement structure (MSD), a
function of <code>param</code> parameters and <code>d_input</code> lag times</p>
</td></tr>
<tr><td><code id="l2_fixedAB_+3A_msd_grad_fn">msd_grad_fn</code></td>
<td>
<p>user defined MSD gradient structure,  a function of
<code>param</code> and <code>d_input</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Dynamic image structure function(Dqt) can be obtained from ensemble average
of absolute values squared of Four transformed intensity difference:
</p>
<p style="text-align: center;"><code class="reqn">D(q,\Delta t) = \langle |\Delta \hat{I}(q,t,\Delta t)|^2\rangle</code>
</p>

<p>See 'References'.
</p>


<h3>Value</h3>

<p>Squared differences between the true Dqt and the predicted Dqt.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>

<hr>
<h2 id='log_lik'>Log likelihood of the model</h2><span id='topic+log_lik'></span>

<h3>Description</h3>

<p>This function computes the natural logarithm of the likelihood of the
latent factor model for selected range of wave vectors. See 'References'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_lik(
  param,
  I_q_cur,
  B_cur,
  index_q,
  I_o_q_2_ori,
  d_input,
  q_ori_ring_loc_unique_index,
  sz,
  len_t,
  q,
  model_name,
  A_neg,
  msd_fn = NA,
  msd_grad_fn = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="log_lik_+3A_param">param</code></td>
<td>
<p>a vector of natural logarithm of parameters</p>
</td></tr>
<tr><td><code id="log_lik_+3A_i_q_cur">I_q_cur</code></td>
<td>
<p>Fourier transformed intensity profile</p>
</td></tr>
<tr><td><code id="log_lik_+3A_b_cur">B_cur</code></td>
<td>
<p>current value of B. This parameter is determined by the noise
in the system. See 'References'.</p>
</td></tr>
<tr><td><code id="log_lik_+3A_index_q">index_q</code></td>
<td>
<p>selected index of wave number</p>
</td></tr>
<tr><td><code id="log_lik_+3A_i_o_q_2_ori">I_o_q_2_ori</code></td>
<td>
<p>absolute square of Fourier transformed intensity profile,
ensemble over time</p>
</td></tr>
<tr><td><code id="log_lik_+3A_d_input">d_input</code></td>
<td>
<p>sequence of lag times</p>
</td></tr>
<tr><td><code id="log_lik_+3A_q_ori_ring_loc_unique_index">q_ori_ring_loc_unique_index</code></td>
<td>
<p>index for wave vector that give unique frequency</p>
</td></tr>
<tr><td><code id="log_lik_+3A_sz">sz</code></td>
<td>
<p>frame size of the intensity profile</p>
</td></tr>
<tr><td><code id="log_lik_+3A_len_t">len_t</code></td>
<td>
<p>number of time steps</p>
</td></tr>
<tr><td><code id="log_lik_+3A_q">q</code></td>
<td>
<p>wave vector in unit of um^-1</p>
</td></tr>
<tr><td><code id="log_lik_+3A_model_name">model_name</code></td>
<td>
<p>model for constructing MSD, options from ('BM','OU',
'FBM','OU+FBM', 'user_defined')</p>
</td></tr>
<tr><td><code id="log_lik_+3A_msd_fn">msd_fn</code></td>
<td>
<p>user defined mean squared displacement structure (MSD), a
function of <code>param</code> parameters and <code>d_input</code> lag times</p>
</td></tr>
<tr><td><code id="log_lik_+3A_msd_grad_fn">msd_grad_fn</code></td>
<td>
<p>user defined MSD gradient structure,  a function of
<code>param</code> and <code>d_input</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The numerical value of natural logarithm of the likelihood.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>

<hr>
<h2 id='log_lik_grad'>Gradient of log likelihood</h2><span id='topic+log_lik_grad'></span>

<h3>Description</h3>

<p>This function computes the gradient for natural logarithm of the likelihood
for selected range of wave vectors. See 'References'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_lik_grad(
  param,
  I_q_cur,
  B_cur,
  A_neg,
  index_q,
  I_o_q_2_ori,
  d_input,
  q_ori_ring_loc_unique_index,
  sz,
  len_t,
  q,
  model_name,
  msd_fn = NA,
  msd_grad_fn = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="log_lik_grad_+3A_param">param</code></td>
<td>
<p>a vector of natural logarithm of parameters</p>
</td></tr>
<tr><td><code id="log_lik_grad_+3A_i_q_cur">I_q_cur</code></td>
<td>
<p>Fourier transformed intensity profile</p>
</td></tr>
<tr><td><code id="log_lik_grad_+3A_b_cur">B_cur</code></td>
<td>
<p>current value of B. This parameter is determined by the noise
in the system. See 'References'.</p>
</td></tr>
<tr><td><code id="log_lik_grad_+3A_index_q">index_q</code></td>
<td>
<p>selected index of wave number</p>
</td></tr>
<tr><td><code id="log_lik_grad_+3A_i_o_q_2_ori">I_o_q_2_ori</code></td>
<td>
<p>absolute square of Fourier transformed intensity profile,
ensemble over time</p>
</td></tr>
<tr><td><code id="log_lik_grad_+3A_d_input">d_input</code></td>
<td>
<p>sequence of lag times</p>
</td></tr>
<tr><td><code id="log_lik_grad_+3A_q_ori_ring_loc_unique_index">q_ori_ring_loc_unique_index</code></td>
<td>
<p>index for wave vector that give unique frequency</p>
</td></tr>
<tr><td><code id="log_lik_grad_+3A_sz">sz</code></td>
<td>
<p>frame size of the intensity profile</p>
</td></tr>
<tr><td><code id="log_lik_grad_+3A_len_t">len_t</code></td>
<td>
<p>number of time steps</p>
</td></tr>
<tr><td><code id="log_lik_grad_+3A_q">q</code></td>
<td>
<p>wave vector in unit of um^-1</p>
</td></tr>
<tr><td><code id="log_lik_grad_+3A_model_name">model_name</code></td>
<td>
<p>stochastic process for constructing MSD, options from ('BM',
'OU','FBM','OU+FBM', 'user_defined')</p>
</td></tr>
<tr><td><code id="log_lik_grad_+3A_msd_fn">msd_fn</code></td>
<td>
<p>user defined mean squared displacement structure (MSD), a
function of <code>param</code> parameters and <code>d_input</code> lag times</p>
</td></tr>
<tr><td><code id="log_lik_grad_+3A_msd_grad_fn">msd_grad_fn</code></td>
<td>
<p>user defined MSD gradient structure,  a function of
<code>param</code> and <code>d_input</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The numerical value of gradient for natural logarithm of the likelihood.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>

<hr>
<h2 id='modeled_dqt'>Compute modeled dynamic image structure function</h2><span id='topic+modeled_dqt'></span>

<h3>Description</h3>

<p>Compute modeled dynamic image structure function (Dqt) using object of
<code>SAM</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modeled_dqt(object, index_q = NA, uncertainty = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modeled_dqt_+3A_object">object</code></td>
<td>
<p>an S4 object of class <code>SAM</code></p>
</td></tr>
<tr><td><code id="modeled_dqt_+3A_index_q">index_q</code></td>
<td>
<p>wavevector range used for computing Dqt</p>
</td></tr>
<tr><td><code id="modeled_dqt_+3A_uncertainty">uncertainty</code></td>
<td>
<p>logic evalution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of modeled dynamic image structure function with dimension
<code>len_q</code> by <code>len_t-1</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
sim_bm = simulation(len_t=100,sz=100,sigma_bm=0.5)
show(sim_bm)
sam = SAM(sim_object = sim_bm)
show(sam)
modeled_Dqt = modeled_dqt(object=sam)
</code></pre>

<hr>
<h2 id='modeled_isf'>Compute modeled intermediate scattering function</h2><span id='topic+modeled_isf'></span>

<h3>Description</h3>

<p>Compute modeled intermediate scattering function (ISF) using object of
<code>SAM</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modeled_isf(object, index_q = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modeled_isf_+3A_object">object</code></td>
<td>
<p>an S4 object of class <code>SAM</code></p>
</td></tr>
<tr><td><code id="modeled_isf_+3A_index_q">index_q</code></td>
<td>
<p>wavevector range used for computing ISF</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of modeled intermediate scattering function with dimension
<code>len_q</code> by <code>len_t-1</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
sim_bm = simulation(len_t=100,sz=100,sigma_bm=0.5)
show(sim_bm)
sam = SAM(sim_object = sim_bm)
show(sam)
modeled_ISF = modeled_isf(object=sam)
</code></pre>

<hr>
<h2 id='numerical_msd'>Compute numerical MSD</h2><span id='topic+numerical_msd'></span>

<h3>Description</h3>

<p>Compute numerical mean squared displacement(MSD) based on particle trajectory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>numerical_msd(pos, M, len_t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="numerical_msd_+3A_pos">pos</code></td>
<td>
<p>position matrix for particle trajectory. See 'Details'.</p>
</td></tr>
<tr><td><code id="numerical_msd_+3A_m">M</code></td>
<td>
<p>number of particles</p>
</td></tr>
<tr><td><code id="numerical_msd_+3A_len_t">len_t</code></td>
<td>
<p>number of time steps</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Input <code>pos</code> should be the position matrix with dimension
<code>M</code><code class="reqn">\times</code><code>len_t</code>. See <code><a href="#topic+bm_particle_intensity">bm_particle_intensity</a></code>,
<code><a href="#topic+ou_particle_intensity">ou_particle_intensity</a></code>, <code><a href="#topic+fbm_particle_intensity">fbm_particle_intensity</a></code>,
<code><a href="#topic+fbm_ou_particle_intensity">fbm_ou_particle_intensity</a></code>.
</p>


<h3>Value</h3>

<p>A vector of numerical MSD for given lag times.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
# Simulate particle trajectory for BM
M = 10
len_t = 50
sigma = 0.5
pos0 = matrix(100/8+0.75*100*runif(M*2),nrow=M,ncol=2)
pos = bm_particle_intensity(pos0=pos0,M=M,len_t=len_t,sigma=sigma)

# Compute numerical MSD
(num_msd = numerical_msd(pos=pos, M=M, len_t = len_t))
</code></pre>

<hr>
<h2 id='ou_particle_intensity'>Simulate 2D particle trajectory follows OU process</h2><span id='topic+ou_particle_intensity'></span>

<h3>Description</h3>

<p>Simulate 2D particle trajectory follows Ornstein–Uhlenbeck process(OU) for
<code>M</code> particles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ou_particle_intensity(pos0, M, len_t, sigma, rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ou_particle_intensity_+3A_pos0">pos0</code></td>
<td>
<p>initial position for <code>M</code> particles, matrix with dimension M by 2</p>
</td></tr>
<tr><td><code id="ou_particle_intensity_+3A_m">M</code></td>
<td>
<p>number of particles</p>
</td></tr>
<tr><td><code id="ou_particle_intensity_+3A_len_t">len_t</code></td>
<td>
<p>number of time steps</p>
</td></tr>
<tr><td><code id="ou_particle_intensity_+3A_sigma">sigma</code></td>
<td>
<p>distance moved per time step</p>
</td></tr>
<tr><td><code id="ou_particle_intensity_+3A_rho">rho</code></td>
<td>
<p>correlation between successive step and previous step,
value between 0 and 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Position matrix with dimension <code>M</code><code class="reqn">\times</code><code>len_t</code>
by 2 for particle trajectory. The first <code>M</code> rows being the initial position
<code>pos0</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
M = 10
len_t = 50
sigma = 2
rho = 0.95
pos0 = matrix(100/8+0.75*100*runif(M*2),nrow=M,ncol=2)
pos = ou_particle_intensity(pos0=pos0,M=M,len_t=len_t,sigma=sigma, rho=rho)
</code></pre>

<hr>
<h2 id='param_uncertainty'>Compute 95% confidence interval</h2><span id='topic+param_uncertainty'></span>

<h3>Description</h3>

<p>This function construct the lower and upper bound for 95% confidence interval
of estimated parameters for the given model, including parameters contained
in the intermediate scattering function and background noise. See 'References'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>param_uncertainty(
  param_est,
  I_q_cur,
  B_cur = NA,
  A_neg,
  index_q,
  I_o_q_2_ori,
  q_ori_ring_loc_unique_index,
  sz,
  len_t,
  d_input,
  q,
  model_name,
  estimation_method = "asymptotic",
  M,
  num_iteration_max,
  lower_bound,
  msd_fn = NA,
  msd_grad_fn = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_uncertainty_+3A_param_est">param_est</code></td>
<td>
<p>a vector of natural logarithm of estimated parameters from
maximize the log likelihood. This vector will serve as initial values in the
<code>optim</code> function.</p>
</td></tr>
<tr><td><code id="param_uncertainty_+3A_i_q_cur">I_q_cur</code></td>
<td>
<p>Fourier transformed intensity profile</p>
</td></tr>
<tr><td><code id="param_uncertainty_+3A_b_cur">B_cur</code></td>
<td>
<p>current value of B. This parameter is determined by the noise
in the system. See 'References'.</p>
</td></tr>
<tr><td><code id="param_uncertainty_+3A_index_q">index_q</code></td>
<td>
<p>selected index of wave number</p>
</td></tr>
<tr><td><code id="param_uncertainty_+3A_i_o_q_2_ori">I_o_q_2_ori</code></td>
<td>
<p>absolute square of Fourier transformed intensity profile,
ensemble over time</p>
</td></tr>
<tr><td><code id="param_uncertainty_+3A_q_ori_ring_loc_unique_index">q_ori_ring_loc_unique_index</code></td>
<td>
<p>index for wave vector that give unique frequency</p>
</td></tr>
<tr><td><code id="param_uncertainty_+3A_sz">sz</code></td>
<td>
<p>frame size of the intensity profile</p>
</td></tr>
<tr><td><code id="param_uncertainty_+3A_len_t">len_t</code></td>
<td>
<p>number of time steps</p>
</td></tr>
<tr><td><code id="param_uncertainty_+3A_d_input">d_input</code></td>
<td>
<p>sequence of lag times</p>
</td></tr>
<tr><td><code id="param_uncertainty_+3A_q">q</code></td>
<td>
<p>wave vector in unit of um^-1</p>
</td></tr>
<tr><td><code id="param_uncertainty_+3A_model_name">model_name</code></td>
<td>
<p>model name for the fitted model, options from ('BM','OU',
'FBM',OU+FBM','user_defined')</p>
</td></tr>
<tr><td><code id="param_uncertainty_+3A_estimation_method">estimation_method</code></td>
<td>
<p>method for constructing 95% confidence interval,
default is asymptotic</p>
</td></tr>
<tr><td><code id="param_uncertainty_+3A_m">M</code></td>
<td>
<p>number of particles</p>
</td></tr>
<tr><td><code id="param_uncertainty_+3A_num_iteration_max">num_iteration_max</code></td>
<td>
<p>the maximum number of iterations in <code>optim</code></p>
</td></tr>
<tr><td><code id="param_uncertainty_+3A_lower_bound">lower_bound</code></td>
<td>
<p>lower bound for the &quot;L-BFGS-B&quot; method in <code>optim</code></p>
</td></tr>
<tr><td><code id="param_uncertainty_+3A_msd_grad_fn">msd_grad_fn</code></td>
<td>
<p>user defined MSD gradient structure,  a function of
<code>param</code> and <code>d_input</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of lower and upper bound for natural logarithm of
parameters in the fitted model using <code>AIUQ</code> method in <code>SAM</code> class
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>

<hr>
<h2 id='param_uncertainty_anisotropic'>Compute 95% confidence interval for anisotropic processes</h2><span id='topic+param_uncertainty_anisotropic'></span>

<h3>Description</h3>

<p>This function construct the lower and upper bound for 95% confidence interval
of estimated parameters for the given anisotropic model, including parameters
contained in the intermediate scattering function and background noise.
See 'References'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>param_uncertainty_anisotropic(
  param_est,
  I_q_cur,
  B_cur = NA,
  index_q,
  I_o_q_2_ori,
  q_ori_ring_loc_unique_index,
  sz,
  len_t,
  d_input,
  q1,
  q2,
  q1_unique_index,
  q2_unique_index,
  model_name,
  estimation_method = "asymptotic",
  M,
  num_iteration_max,
  lower_bound,
  msd_fn = NA,
  msd_grad_fn = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_uncertainty_anisotropic_+3A_param_est">param_est</code></td>
<td>
<p>a vector of natural logarithm of estimated parameters from
maximize the log likelihood. This vector will serve as initial values in the
<code>optim</code> function.</p>
</td></tr>
<tr><td><code id="param_uncertainty_anisotropic_+3A_i_q_cur">I_q_cur</code></td>
<td>
<p>Fourier transformed intensity profile</p>
</td></tr>
<tr><td><code id="param_uncertainty_anisotropic_+3A_b_cur">B_cur</code></td>
<td>
<p>current value of B. This parameter is determined by the noise
in the system. See 'References'.</p>
</td></tr>
<tr><td><code id="param_uncertainty_anisotropic_+3A_index_q">index_q</code></td>
<td>
<p>selected index of wave number</p>
</td></tr>
<tr><td><code id="param_uncertainty_anisotropic_+3A_i_o_q_2_ori">I_o_q_2_ori</code></td>
<td>
<p>absolute square of Fourier transformed intensity profile,
ensemble over time</p>
</td></tr>
<tr><td><code id="param_uncertainty_anisotropic_+3A_q_ori_ring_loc_unique_index">q_ori_ring_loc_unique_index</code></td>
<td>
<p>index for wave vector that give unique frequency</p>
</td></tr>
<tr><td><code id="param_uncertainty_anisotropic_+3A_sz">sz</code></td>
<td>
<p>frame size of the intensity profile</p>
</td></tr>
<tr><td><code id="param_uncertainty_anisotropic_+3A_len_t">len_t</code></td>
<td>
<p>number of time steps</p>
</td></tr>
<tr><td><code id="param_uncertainty_anisotropic_+3A_d_input">d_input</code></td>
<td>
<p>sequence of lag times</p>
</td></tr>
<tr><td><code id="param_uncertainty_anisotropic_+3A_q1">q1</code></td>
<td>
<p>wave vector in unit of um^-1 in x direction</p>
</td></tr>
<tr><td><code id="param_uncertainty_anisotropic_+3A_q2">q2</code></td>
<td>
<p>wave vector in unit of um^-1 in y direction</p>
</td></tr>
<tr><td><code id="param_uncertainty_anisotropic_+3A_q1_unique_index">q1_unique_index</code></td>
<td>
<p>index for wave vector that give unique frequency in x direction</p>
</td></tr>
<tr><td><code id="param_uncertainty_anisotropic_+3A_q2_unique_index">q2_unique_index</code></td>
<td>
<p>index for wave vector that give unique frequency in y direction</p>
</td></tr>
<tr><td><code id="param_uncertainty_anisotropic_+3A_model_name">model_name</code></td>
<td>
<p>model name for the fitted model, options from ('BM','OU',
'FBM',OU+FBM','user_defined')</p>
</td></tr>
<tr><td><code id="param_uncertainty_anisotropic_+3A_estimation_method">estimation_method</code></td>
<td>
<p>method for constructing 95% confidence interval,
default is asymptotic</p>
</td></tr>
<tr><td><code id="param_uncertainty_anisotropic_+3A_m">M</code></td>
<td>
<p>number of particles</p>
</td></tr>
<tr><td><code id="param_uncertainty_anisotropic_+3A_num_iteration_max">num_iteration_max</code></td>
<td>
<p>the maximum number of iterations in <code>optim</code></p>
</td></tr>
<tr><td><code id="param_uncertainty_anisotropic_+3A_lower_bound">lower_bound</code></td>
<td>
<p>lower bound for the &quot;L-BFGS-B&quot; method in <code>optim</code></p>
</td></tr>
<tr><td><code id="param_uncertainty_anisotropic_+3A_msd_grad_fn">msd_grad_fn</code></td>
<td>
<p>user defined MSD gradient structure,  a function of
<code>param</code> and <code>d_input</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of lower and upper bound for natural logarithm of
parameters in the fitted model using <code>AIUQ</code> method in <code>SAM</code> class
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>

<hr>
<h2 id='plot_intensity'>Plot 2D intensity</h2><span id='topic+plot_intensity'></span>

<h3>Description</h3>

<p>Function to plot 2D intensity profile for a certain frame, default is to plot
the first frame. Input can be a matrix (2D) or an array (3D).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_intensity(
  intensity,
  intensity_str = "T_SS_mat",
  frame = 1,
  sz = NA,
  title = NA,
  color = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_intensity_+3A_intensity">intensity</code></td>
<td>
<p>intensity profile</p>
</td></tr>
<tr><td><code id="plot_intensity_+3A_intensity_str">intensity_str</code></td>
<td>
<p>structure of the intensity profile, options from
('SST_array','S_ST_mat','T_SS_mat', 'SS_T_mat'). See 'Details'.</p>
</td></tr>
<tr><td><code id="plot_intensity_+3A_frame">frame</code></td>
<td>
<p>frame index</p>
</td></tr>
<tr><td><code id="plot_intensity_+3A_sz">sz</code></td>
<td>
<p>frame size of simulated image with default <code>c(200,200)</code>.</p>
</td></tr>
<tr><td><code id="plot_intensity_+3A_title">title</code></td>
<td>
<p>main title of the plot. If <code>NA</code>, title is &quot;intensity profile
for frame n&quot; with n being the frame index in <code>frame</code>.</p>
</td></tr>
<tr><td><code id="plot_intensity_+3A_color">color</code></td>
<td>
<p>a logical evaluating to TRUE or FALSE indicating whether a colorful
plot is generated</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default <code>intensity_str</code> is set to 'T_SS_mat', a time by space<code class="reqn">\times</code>space
matrix, which is the structure of intensity profile obtained from <code>simulation</code>
class. For <code>intensity_str='SST_array'</code> , input intensity profile should be a
space by space by time array, which is the structure from loading a tif file.
For <code>intensity_str='S_ST_mat'</code>, input intensity profile should be a
space by space<code class="reqn">\times</code>time matrix. For <code>intensity_str='SS_T_mat'</code>,
input intensity profile should be a space<code class="reqn">\times</code>space by time matrix.
</p>


<h3>Value</h3>

<p>2D plot in gray scale (or with color) of selected frame.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
sim_bm = simulation(sz=100,len_t=100,sigma_bm=0.5)
show(sim_bm)
plot_intensity(sim_bm@intensity, sz=sim_bm@sz)

</code></pre>

<hr>
<h2 id='plot_MSD'>Plot estimated MSD with uncertainty from SAM class</h2><span id='topic+plot_MSD'></span>

<h3>Description</h3>

<p>Function to plot estimated MSD with uncertainty from <code>SAM</code> class, versus
true mean squared displacement(MSD) or given reference values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_MSD(object, msd_truth = NA, title = NA, log10 = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_MSD_+3A_object">object</code></td>
<td>
<p>an S4 object of class <code>SAM</code></p>
</td></tr>
<tr><td><code id="plot_MSD_+3A_msd_truth">msd_truth</code></td>
<td>
<p>a vector/matrix of true MSD or reference MSD value,
default is <code>NA</code></p>
</td></tr>
<tr><td><code id="plot_MSD_+3A_title">title</code></td>
<td>
<p>main title of the plot. If <code>NA</code>, title is &quot;model_name&quot; with
<code>model_name</code> being a field in <code>SAM</code> class representing fitted model.</p>
</td></tr>
<tr><td><code id="plot_MSD_+3A_log10">log10</code></td>
<td>
<p>a logical evaluating to TRUE or FALSE indicating whether a plot
in log10 scale is generated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of estimated MSD with uncertainty versus truth/reference values.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)

## Simulate BM and get estimated parameters with uncertainty using BM model
# Simulation
set.seed(1)
sim_bm = simulation(sz=100,len_t=100,sigma_bm=0.5)
show(sim_bm)

# AIUQ method: fitting using BM model
sam = SAM(sim_object=sim_bm, uncertainty=TRUE,AIUQ_thr=c(0.999,0))
show(sam)

plot_MSD(object=sam, msd_truth=sam@msd_truth) #in log10 scale
plot_MSD(object=sam, msd_truth=sam@msd_truth,log10=FALSE) #in real scale

</code></pre>

<hr>
<h2 id='plot_traj'>Plot 2D particle trajectory</h2><span id='topic+plot_traj'></span>

<h3>Description</h3>

<p>Function to plot the particle trajectory after the <code>simulation</code> class
has been constructed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_traj(object, title = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_traj_+3A_object">object</code></td>
<td>
<p>an S4 object of class <code>simulation</code></p>
</td></tr>
<tr><td><code id="plot_traj_+3A_title">title</code></td>
<td>
<p>main title of the plot. If <code>NA</code>, title is &quot;model_name with
M particles&quot; with <code>model_name</code> and <code>M</code> being field in <code>simulation</code>
class.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>2D plot of particle trajectory for a given simulation from <code>simulation</code>
class.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
sim_bm = simulation(sz=100,len_t=100,sigma_bm=0.5)
show(sim_bm)
plot_traj(sim_bm)
</code></pre>

<hr>
<h2 id='SAM'>Scattering analysis of microscopy</h2><span id='topic+SAM'></span>

<h3>Description</h3>

<p>Fast parameter estimation in scattering analysis of microscopy, using either
AIUQ or DDM method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SAM(
  intensity = NA,
  intensity_str = "T_SS_mat",
  pxsz = 1,
  sz = c(NA, NA),
  mindt = 1,
  AIUQ_thr = c(1, 1),
  model_name = "BM",
  sigma_0_2_ini = NaN,
  param_initial = NA,
  num_optim = 1,
  msd_fn = NA,
  msd_grad_fn = NA,
  num_param = NA,
  uncertainty = FALSE,
  M = 50,
  sim_object = NA,
  msd_truth = NA,
  method = "AIUQ",
  index_q_AIUQ = NA,
  index_q_DDM = NA,
  message_out = TRUE,
  A_neg = "abs",
  square = FALSE,
  output_dqt = FALSE,
  output_isf = FALSE,
  output_modeled_isf = FALSE,
  output_modeled_dqt = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SAM_+3A_intensity">intensity</code></td>
<td>
<p>intensity profile. See 'Details'.</p>
</td></tr>
<tr><td><code id="SAM_+3A_intensity_str">intensity_str</code></td>
<td>
<p>structure of the intensity profile, options from
('SST_array','S_ST_mat','T_SS_mat'). See 'Details'.</p>
</td></tr>
<tr><td><code id="SAM_+3A_pxsz">pxsz</code></td>
<td>
<p>size of one pixel in unit of micron, 1 for simulated data</p>
</td></tr>
<tr><td><code id="SAM_+3A_sz">sz</code></td>
<td>
<p>frame size of the intensity profile in x and y directions,
number of pixels contained in each frame equals sz_x by sz_y.</p>
</td></tr>
<tr><td><code id="SAM_+3A_mindt">mindt</code></td>
<td>
<p>minimum lag time, 1 for simulated data</p>
</td></tr>
<tr><td><code id="SAM_+3A_aiuq_thr">AIUQ_thr</code></td>
<td>
<p>threshold for wave number selection, numeric vector of two
elements with values between 0 and 1. See 'Details'.</p>
</td></tr>
<tr><td><code id="SAM_+3A_model_name">model_name</code></td>
<td>
<p>fitted model, options from  ('BM','OU','FBM','OU+FBM',
'user_defined'), with Brownian motion as the default model. See 'Details'.</p>
</td></tr>
<tr><td><code id="SAM_+3A_sigma_0_2_ini">sigma_0_2_ini</code></td>
<td>
<p>initial value for background noise. If NA, use minimum
value of absolute square of intensity profile in reciprocal space.</p>
</td></tr>
<tr><td><code id="SAM_+3A_param_initial">param_initial</code></td>
<td>
<p>initial values for param estimation.</p>
</td></tr>
<tr><td><code id="SAM_+3A_num_optim">num_optim</code></td>
<td>
<p>number of optimization.</p>
</td></tr>
<tr><td><code id="SAM_+3A_msd_fn">msd_fn</code></td>
<td>
<p>user defined mean squared displacement(MSD) structure, a
function of parameters and lag times. NA if <code>model_name</code> is not
'user_defined'.</p>
</td></tr>
<tr><td><code id="SAM_+3A_msd_grad_fn">msd_grad_fn</code></td>
<td>
<p>gradient for user defined mean squared displacement
structure. If <code>NA</code>, then numerical gradient will be used for parameter
estimation in <code>'user_defined'</code> model.</p>
</td></tr>
<tr><td><code id="SAM_+3A_num_param">num_param</code></td>
<td>
<p>number of parameters need to be estimated in the intermediate
scattering function, need to be non-NA value for user_defined' model.</p>
</td></tr>
<tr><td><code id="SAM_+3A_uncertainty">uncertainty</code></td>
<td>
<p>a logical evaluating to TRUE or FALSE indicating whether
parameter uncertainty should be computed.</p>
</td></tr>
<tr><td><code id="SAM_+3A_m">M</code></td>
<td>
<p>number of particles. See 'Details'.</p>
</td></tr>
<tr><td><code id="SAM_+3A_sim_object">sim_object</code></td>
<td>
<p>NA or an S4 object of class <code>simulation</code>.</p>
</td></tr>
<tr><td><code id="SAM_+3A_msd_truth">msd_truth</code></td>
<td>
<p>true MSD or reference MSD value.</p>
</td></tr>
<tr><td><code id="SAM_+3A_method">method</code></td>
<td>
<p>methods for parameter estimation, options from ('AIUQ','DDM_fixedAB','DDM_estAB').</p>
</td></tr>
<tr><td><code id="SAM_+3A_index_q_aiuq">index_q_AIUQ</code></td>
<td>
<p>index range for wave number when using AIUQ method. See 'Details'.</p>
</td></tr>
<tr><td><code id="SAM_+3A_index_q_ddm">index_q_DDM</code></td>
<td>
<p>index range for wave number when using DDM method. See 'Details'.</p>
</td></tr>
<tr><td><code id="SAM_+3A_message_out">message_out</code></td>
<td>
<p>a logical evaluating to TRUE or FALSE indicating whether
or not to output the message.</p>
</td></tr>
<tr><td><code id="SAM_+3A_a_neg">A_neg</code></td>
<td>
<p>controls modification for negative A(q), options from  ('abs','zero'),
with setting negative A(q) to its absolute value as the default.</p>
</td></tr>
<tr><td><code id="SAM_+3A_square">square</code></td>
<td>
<p>a logical evaluating to TRUE or FALSE indicating whether or not
to crop the original intensity profile into square image.</p>
</td></tr>
<tr><td><code id="SAM_+3A_output_dqt">output_dqt</code></td>
<td>
<p>a logical evaluating to TRUE or FALSE indicating whether or
not to compute observed dynamic image structure function(Dqt).</p>
</td></tr>
<tr><td><code id="SAM_+3A_output_isf">output_isf</code></td>
<td>
<p>a logical evaluating to TRUE or FALSE indicating whether or
not to compute empirical intermediate scattering function(ISF).</p>
</td></tr>
<tr><td><code id="SAM_+3A_output_modeled_isf">output_modeled_isf</code></td>
<td>
<p>a logical evaluating to TRUE or FALSE indicating
whether or not to compute modeled intermediate scattering function(ISF).</p>
</td></tr>
<tr><td><code id="SAM_+3A_output_modeled_dqt">output_modeled_dqt</code></td>
<td>
<p>a logical evaluating to TRUE or FALSE indicating
whether or not to compute modeled dynamic image structure function(Dqt).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For simulated data using <code>simulation</code> in AIUQ package, <code>intensity</code>
will be automatically extracted from <code>simulation</code> class.
</p>
<p>By default <code>intensity_str</code> is set to 'T_SS_mat', a time by space<code class="reqn">\times</code>space
matrix, which is the structure of intensity profile obtained from <code>simulation</code>
class. For <code>intensity_str='SST_array'</code> , input intensity profile should be a
space by space by time array, which is the structure from loading a tif file.
For <code>intensity_str='S_ST_mat'</code>, input intensity profile should be a
space by space<code class="reqn">\times</code>time matrix.
</p>
<p>By default <code>AIUQ_thr</code> is set to <code>c(1,1)</code>, uses information from all
complete q rings. The first element affects maximum wave number selected,
and second element controls minimum proportion of wave number selected. By
setting 1 for the second element, if maximum wave number selected is less
than the wave number length, then maximum wave number selected is coerced to
use all wave number unless user defined another index range through <code>index_q_AIUQ</code>.
</p>
<p>If <code>model_name</code> equals 'user_defined', or NA (will coerced to
'user_defined'), then <code>msd_fn</code> and <code>num_param</code> need to be provided
for parameter estimation.
</p>
<p>Number of particles <code>M</code> is set to 50 or automatically extracted from
<code>simulation</code> class for simulated data using <code>simulation</code> in AIUQ
package.
</p>
<p>By default, using all wave vectors from complete q ring, unless user defined
index range through <code>index_q_AIUQ</code> or <code>index_q_DDM</code>.
</p>


<h3>Value</h3>

<p>Returns an S4 object of class <code>SAM</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
# Example 1: Estimation for simulated data
sim_bm = simulation(len_t=100,sz=100,sigma_bm=0.5)
show(sim_bm)
sam = SAM(sim_object = sim_bm)
show(sam)
</code></pre>

<hr>
<h2 id='SAM_Dqt'>Compute dynamic image structure function</h2><span id='topic+SAM_Dqt'></span>

<h3>Description</h3>

<p>Compute dynamic image structure function(Dqt) using Fourier transformed
intensity profile and a selection of wave number(q) range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SAM_Dqt(len_q, index_q, len_t, I_q_matrix, q_ori_ring_loc_unique_index, sz)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SAM_Dqt_+3A_len_q">len_q</code></td>
<td>
<p>number of wave number</p>
</td></tr>
<tr><td><code id="SAM_Dqt_+3A_index_q">index_q</code></td>
<td>
<p>a vector of selected wave number index</p>
</td></tr>
<tr><td><code id="SAM_Dqt_+3A_len_t">len_t</code></td>
<td>
<p>number of time steps</p>
</td></tr>
<tr><td><code id="SAM_Dqt_+3A_i_q_matrix">I_q_matrix</code></td>
<td>
<p>intensity profile in reciprocal space (after Fourier transformation)</p>
</td></tr>
<tr><td><code id="SAM_Dqt_+3A_q_ori_ring_loc_unique_index">q_ori_ring_loc_unique_index</code></td>
<td>
<p>index for wave vector that give unique frequency</p>
</td></tr>
<tr><td><code id="SAM_Dqt_+3A_sz">sz</code></td>
<td>
<p>frame size of intensity profile</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Dynamic image structure function(Dqt) can be obtained from ensemble average
of absolute values squared of Four transformed intensity difference:
</p>
<p style="text-align: center;"><code class="reqn">D(q,\Delta t) = \langle |\Delta \hat{I}(q,t,\Delta t)|^2\rangle</code>
</p>

<p>See 'References'.
</p>


<h3>Value</h3>

<p>Matrix of dynamic image structure with dimension <code>len_q</code> by <code>len_t-1</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>

<hr>
<h2 id='SAM-class'>SAM class</h2><span id='topic+SAM-class'></span>

<h3>Description</h3>

<p>S4 class for fast parameter estimation in scattering analysis of microscopy,
using either <code>AIUQ</code> or <code>DDM</code> method.
</p>


<h3>Slots</h3>


<dl>
<dt><code>pxsz</code></dt><dd><p>numeric.  Size of one pixel in unit of micron with default value 1.</p>
</dd>
<dt><code>mindt</code></dt><dd><p>numeric. Minimum lag time with default value 1.</p>
</dd>
<dt><code>sz</code></dt><dd><p>vector. Frame size of the intensity profile in x and y directions,
number of pixels contained in each frame equals sz_x by sz_y.</p>
</dd>
<dt><code>len_t</code></dt><dd><p>integer. Number of time steps.</p>
</dd>
<dt><code>len_q</code></dt><dd><p>integer. Number of wave vector.</p>
</dd>
<dt><code>q</code></dt><dd><p>vector. Wave vector in unit of um^-1.</p>
</dd>
<dt><code>d_input</code></dt><dd><p>vector. Sequence of lag times.</p>
</dd>
<dt><code>B_est_ini</code></dt><dd><p>numeric. Estimation of B. This parameter is determined by the
noise in the system. See 'References'.</p>
</dd>
<dt><code>A_est_ini</code></dt><dd><p>vector. Estimation of A(q). Note this parameter is
determined by the properties of the imaged material and imaging optics.
See 'References'.</p>
</dd>
<dt><code>I_o_q_2_ori</code></dt><dd><p>vector. Absolute square of Fourier transformed intensity
profile, ensemble over time.</p>
</dd>
<dt><code>q_ori_ring_loc_unique_index</code></dt><dd><p>list. List of location index of non-duplicate
values for each q ring.</p>
</dd>
<dt><code>model_name</code></dt><dd><p>character. Fitted model, options from
('BM','OU','FBM','OU+FBM', 'user_defined').</p>
</dd>
<dt><code>param_est</code></dt><dd><p>vector. Estimated parameters contained in MSD.</p>
</dd>
<dt><code>sigma_2_0_est</code></dt><dd><p>numeric. Estimated variance of background noise.</p>
</dd>
<dt><code>msd_est</code></dt><dd><p>vector. Estimated MSD.</p>
</dd>
<dt><code>uncertainty</code></dt><dd><p>logical. A logical evaluating to TRUE or FALSE indicating whether
parameter uncertainty should be computed.</p>
</dd>
<dt><code>msd_lower</code></dt><dd><p>vector. Lower bound of 95% confidence interval of MSD.</p>
</dd>
<dt><code>msd_upper</code></dt><dd><p>vector. Upper bound of 95% confidence interval of MSD.</p>
</dd>
<dt><code>msd_truth</code></dt><dd><p>vector. True MSD or reference MSD value.</p>
</dd>
<dt><code>sigma_2_0_truth</code></dt><dd><p>vector.  True variance of background noise, non NA for
simulated data using <code>simulation</code>.</p>
</dd>
<dt><code>param_truth</code></dt><dd><p>vector. True parameters used to construct MSD, non NA for
simulated data using <code>simulation</code>.</p>
</dd>
<dt><code>index_q</code></dt><dd><p>vector. Selected index of wave vector.</p>
</dd>
<dt><code>Dqt</code></dt><dd><p>matrix. Dynamic image structure function D(q,delta t).</p>
</dd>
<dt><code>ISF</code></dt><dd><p>matrix. Empirical intermediate scattering function f(q,delta t).</p>
</dd>
<dt><code>I_q</code></dt><dd><p>matrix. Fourier transformed intensity profile with structure 'SS_T_mat'.</p>
</dd>
<dt><code>AIC</code></dt><dd><p>numeric. Akaike information criterion score.</p>
</dd>
<dt><code>mle</code></dt><dd><p>numeric. Maximum log likelihood value.</p>
</dd>
<dt><code>param_uq_range</code></dt><dd><p>matrix. 95% confidence interval for estimated parameters.</p>
</dd>
<dt><code>modeled_Dqt</code></dt><dd><p>matrix. Modeled dynamic image structure function D(q,delta t).</p>
</dd>
<dt><code>modeled_ISF</code></dt><dd><p>matrix. Modeled intermediate scattering function f(q,delta t).</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>

<hr>
<h2 id='show.aniso_sam'>Show scattering analysis of microscopy for anisotropic processes (aniso_SAM) object</h2><span id='topic+show.aniso_sam'></span>

<h3>Description</h3>

<p>Function to print the <code>aniso_SAM</code> class object after the
<code>aniso_SAM</code> model has been constructed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show.aniso_sam(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show.aniso_sam_+3A_object">object</code></td>
<td>
<p>an S4 object of class <code>aniso_SAM</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Show a list of important parameters in class <code>aniso_SAM</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)

## Simulate BM and get estimated parameters using BM model
# Simulation
aniso_sim_bm = aniso_simulation(sz=100,len_t=100,sigma_bm=c(0.5,0.3))
show(aniso_sim_bm)

# AIUQ method: fitting using BM model
aniso_sam = aniso_SAM(sim_object=aniso_sim_bm, AIUQ_thr=c(0.99,0))
show(aniso_sam)

</code></pre>

<hr>
<h2 id='show.aniso_simulation'>Show anisotropic simulation object</h2><span id='topic+show.aniso_simulation'></span>

<h3>Description</h3>

<p>Function to print the <code>aniso_simulation</code> class object after the
<code>aniso_simulation</code> model has been constructed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show.aniso_simulation(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show.aniso_simulation_+3A_object">object</code></td>
<td>
<p>an S4 object of class <code>aniso_simulation</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Show a list of important parameters in class <code>aniso_simulation</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)

# Simulate simple diffusion for 100 images with 100 by 100 pixels
aniso_sim_bm = aniso_simulation(sz=100,len_t=100,sigma_bm=c(0.5,0.1))
show(aniso_sim_bm)
</code></pre>

<hr>
<h2 id='show.sam'>Show scattering analysis of microscopy (SAM) object</h2><span id='topic+show.sam'></span>

<h3>Description</h3>

<p>Function to print the <code>SAM</code> class object after the <code>SAM</code> model has
been constructed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show.sam(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show.sam_+3A_object">object</code></td>
<td>
<p>an S4 object of class <code>SAM</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Show a list of important parameters in class <code>SAM</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)

## Simulate BM and get estimated parameters using BM model
# Simulation
sim_bm = simulation(sz=100,len_t=100,sigma_bm=0.5)
show(sim_bm)

# AIUQ method: fitting using BM model
sam = SAM(sim_object=sim_bm)
show(sam)

</code></pre>

<hr>
<h2 id='show.simulation'>Show simulation object</h2><span id='topic+show.simulation'></span>

<h3>Description</h3>

<p>Function to print the <code>simulation</code> class object after the <code>simulation</code>
model has been constructed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show.simulation(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show.simulation_+3A_object">object</code></td>
<td>
<p>an S4 object of class <code>simulation</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Show a list of important parameters in class <code>simulation</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)

# Simulate simple diffusion for 100 images with 100 by 100 pixels
sim_bm = simulation(sz=100,len_t=100,sigma_bm=0.5)
show(sim_bm)
</code></pre>

<hr>
<h2 id='simulation'>Simulate 2D particle movement</h2><span id='topic+simulation'></span>

<h3>Description</h3>

<p>Simulate 2D particle movement from a user selected stochastic process, and
output intensity profiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation(
  sz = c(200, 200),
  len_t = 200,
  M = 50,
  model_name = "BM",
  noise = "gaussian",
  I0 = 20,
  Imax = 255,
  pos0 = matrix(NaN, nrow = M, ncol = 2),
  rho = 0.95,
  H = 0.3,
  sigma_p = 2,
  sigma_bm = 1,
  sigma_ou = 2,
  sigma_fbm = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulation_+3A_sz">sz</code></td>
<td>
<p>frame size of simulated image with default <code>c(200,200)</code>.</p>
</td></tr>
<tr><td><code id="simulation_+3A_len_t">len_t</code></td>
<td>
<p>number of time steps with default 200.</p>
</td></tr>
<tr><td><code id="simulation_+3A_m">M</code></td>
<td>
<p>number of particles with default 50.</p>
</td></tr>
<tr><td><code id="simulation_+3A_model_name">model_name</code></td>
<td>
<p>stochastic process simulated, options from
('BM','OU','FBM','OU+FBM'), with default 'BM'.</p>
</td></tr>
<tr><td><code id="simulation_+3A_noise">noise</code></td>
<td>
<p>background noise, options from ('uniform','gaussian'),
with default 'gaussian'.</p>
</td></tr>
<tr><td><code id="simulation_+3A_i0">I0</code></td>
<td>
<p>background intensity, value between 0 and 255, with default 20.</p>
</td></tr>
<tr><td><code id="simulation_+3A_imax">Imax</code></td>
<td>
<p>maximum intensity at the center of the particle, value between 0
and 255, with default 255.</p>
</td></tr>
<tr><td><code id="simulation_+3A_pos0">pos0</code></td>
<td>
<p>initial position for M particles, matrix with dimension M by 2.</p>
</td></tr>
<tr><td><code id="simulation_+3A_rho">rho</code></td>
<td>
<p>correlation between successive step and previous step in O-U
process, value between 0 and 1, with default 0.95.</p>
</td></tr>
<tr><td><code id="simulation_+3A_h">H</code></td>
<td>
<p>Hurst parameter of fractional Brownian Motion, value between 0 and 1,
with default 0.3.</p>
</td></tr>
<tr><td><code id="simulation_+3A_sigma_p">sigma_p</code></td>
<td>
<p>radius of the spherical particle (3sigma_p), with default 2.</p>
</td></tr>
<tr><td><code id="simulation_+3A_sigma_bm">sigma_bm</code></td>
<td>
<p>distance moved per time step in Brownian Motion, with default 1.</p>
</td></tr>
<tr><td><code id="simulation_+3A_sigma_ou">sigma_ou</code></td>
<td>
<p>distance moved per time step in Ornstein–Uhlenbeck process,
with default 2.</p>
</td></tr>
<tr><td><code id="simulation_+3A_sigma_fbm">sigma_fbm</code></td>
<td>
<p>distance moved per time step in fractional Brownian Motion,
with default 2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an S4 object of class <code>simulation</code>.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(AIUQ)
# -------------------------------------------------
# Example 1: Simple diffusion for 200 images with
#            200 by 200 pixels and 50 particles
# -------------------------------------------------
sim_bm = simulation()
show(sim_bm)

# -------------------------------------------------
# Example 2: Simple diffusion for 100 images with
#            100 by 100 pixels and slower speed
# -------------------------------------------------
sim_bm = simulation(sz=100,len_t=100,sigma_bm=0.5)
show(sim_bm)

# -------------------------------------------------
# Example 3: Ornstein-Uhlenbeck process
# -------------------------------------------------
sim_ou = simulation(model_name="OU")
show(sim_ou)
</code></pre>

<hr>
<h2 id='simulation-class'>Simulation class</h2><span id='topic+simulation-class'></span>

<h3>Description</h3>

<p>S4 class for 2D particle movement simulation.
</p>


<h3>Details</h3>

<p><code>intensity</code> should has structure 'T_SS_mat', matrix with dimension
<code>len_t</code> by <code>sz</code><code class="reqn">\times</code><code>sz</code>.
</p>
<p><code>pos</code> should be the position matrix with dimension
<code>M</code><code class="reqn">\times</code><code>len_t</code>. See <code><a href="#topic+bm_particle_intensity">bm_particle_intensity</a></code>,
<code><a href="#topic+ou_particle_intensity">ou_particle_intensity</a></code>, <code><a href="#topic+fbm_particle_intensity">fbm_particle_intensity</a></code>,
<code><a href="#topic+fbm_ou_particle_intensity">fbm_ou_particle_intensity</a></code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>sz</code></dt><dd><p>vector. Frame size of the intensity profile, number of pixels
contained in each frame equals <code>sz[1]</code> by <code>sz[2]</code>.</p>
</dd>
<dt><code>len_t</code></dt><dd><p>integer. Number of time steps.</p>
</dd>
<dt><code>noise</code></dt><dd><p>character. Background noise, options from ('uniform','gaussian').</p>
</dd>
<dt><code>model_name</code></dt><dd><p>character. Simulated stochastic process, options from ('BM','OU','FBM','OU+FBM').</p>
</dd>
<dt><code>M</code></dt><dd><p>integer. Number of particles.</p>
</dd>
<dt><code>pxsz</code></dt><dd><p>numeric.  Size of one pixel in unit of micron, 1 for simulated data.</p>
</dd>
<dt><code>mindt</code></dt><dd><p>numeric. Minimum lag time, 1 for simulated data.</p>
</dd>
<dt><code>pos</code></dt><dd><p>matrix. Position matrix for particle trajectory, see 'Details'.</p>
</dd>
<dt><code>intensity</code></dt><dd><p>matrix. Filled intensity profile, see 'Details'.</p>
</dd>
<dt><code>num_msd</code></dt><dd><p>vector. Numerical mean squared displacement (MSD).</p>
</dd>
<dt><code>param</code></dt><dd><p>vector. Parameters for simulated stochastic process.</p>
</dd>
<dt><code>theor_msd</code></dt><dd><p>vector. Theoretical MSD.</p>
</dd>
<dt><code>sigma_2_0</code></dt><dd><p>vector. Variance of background noise.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>

<hr>
<h2 id='theta_est_l2_dqt_estAB'>Minimize l2 loss for Dqt</h2><span id='topic+theta_est_l2_dqt_estAB'></span>

<h3>Description</h3>

<p>Minimize l2 loss function for dynamic image structure function(Dqt), and
return estimated parameters and mean squared displacement(MSD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theta_est_l2_dqt_estAB(
  param,
  A_ini,
  q,
  index_q,
  Dqt,
  d_input,
  model_name,
  msd_fn = NA,
  msd_grad_fn = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="theta_est_l2_dqt_estAB_+3A_param">param</code></td>
<td>
<p>a vector of natural logarithm of parameters</p>
</td></tr>
<tr><td><code id="theta_est_l2_dqt_estAB_+3A_a_ini">A_ini</code></td>
<td>
<p>initial value of A(q) to be optimized over. Note true A(q) is
determined by the properties of the imaged material and imaging optics.
See 'References'.</p>
</td></tr>
<tr><td><code id="theta_est_l2_dqt_estAB_+3A_q">q</code></td>
<td>
<p>wave vector in unit of um^-1</p>
</td></tr>
<tr><td><code id="theta_est_l2_dqt_estAB_+3A_index_q">index_q</code></td>
<td>
<p>selected index of wave number</p>
</td></tr>
<tr><td><code id="theta_est_l2_dqt_estAB_+3A_dqt">Dqt</code></td>
<td>
<p>observed dynamic image structure function. See 'Details'.</p>
</td></tr>
<tr><td><code id="theta_est_l2_dqt_estAB_+3A_d_input">d_input</code></td>
<td>
<p>sequence of lag times</p>
</td></tr>
<tr><td><code id="theta_est_l2_dqt_estAB_+3A_model_name">model_name</code></td>
<td>
<p>model name for the fitted model, options from ('BM','OU',
'FBM',OU+FBM','user_defined')</p>
</td></tr>
<tr><td><code id="theta_est_l2_dqt_estAB_+3A_msd_fn">msd_fn</code></td>
<td>
<p>msd_fn user defined mean squared displacement structure (MSD), a
function of <code>param</code> parameters and <code>d_input</code> lag times</p>
</td></tr>
<tr><td><code id="theta_est_l2_dqt_estAB_+3A_msd_grad_fn">msd_grad_fn</code></td>
<td>
<p>user defined MSD gradient structure,  a function of
<code>param</code> and <code>d_input</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Dynamic image structure function(Dqt) can be obtained from ensemble average
of absolute values squared of Four transformed intensity difference:
</p>
<p style="text-align: center;"><code class="reqn">D(q,\Delta t) = \langle |\Delta \hat{I}(q,t,\Delta t)|^2\rangle</code>
</p>

<p>See 'References'.
</p>


<h3>Value</h3>

<p>A list of estimated parameters and MSD from minimizing the l2 loss
function.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>

<hr>
<h2 id='theta_est_l2_dqt_fixedAB'>Minimize l2 loss for Dqt with fixed A(q) and B</h2><span id='topic+theta_est_l2_dqt_fixedAB'></span>

<h3>Description</h3>

<p>Minimize l2 loss function for dynamic image structure function(Dqt) with
fixed A(q) and B, and return estimated parameters and mean squared
displacement(MSD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theta_est_l2_dqt_fixedAB(
  param,
  q,
  index_q,
  Dqt,
  A_est_q,
  B_est,
  d_input,
  model_name,
  msd_fn = NA,
  msd_grad_fn = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="theta_est_l2_dqt_fixedAB_+3A_param">param</code></td>
<td>
<p>a vector of natural logarithm of parameters</p>
</td></tr>
<tr><td><code id="theta_est_l2_dqt_fixedAB_+3A_q">q</code></td>
<td>
<p>wave vector in unit of um^-1</p>
</td></tr>
<tr><td><code id="theta_est_l2_dqt_fixedAB_+3A_index_q">index_q</code></td>
<td>
<p>selected index of wave number</p>
</td></tr>
<tr><td><code id="theta_est_l2_dqt_fixedAB_+3A_dqt">Dqt</code></td>
<td>
<p>observed dynamic image structure function. See 'Details'.</p>
</td></tr>
<tr><td><code id="theta_est_l2_dqt_fixedAB_+3A_a_est_q">A_est_q</code></td>
<td>
<p>estimated value of A(q). This parameter is determined by
the properties of the imaged material and imaging optics. See 'References'.</p>
</td></tr>
<tr><td><code id="theta_est_l2_dqt_fixedAB_+3A_b_est">B_est</code></td>
<td>
<p>estimated value of B. This parameter is determined by the noise
in the system. See 'References'.</p>
</td></tr>
<tr><td><code id="theta_est_l2_dqt_fixedAB_+3A_d_input">d_input</code></td>
<td>
<p>sequence of lag times</p>
</td></tr>
<tr><td><code id="theta_est_l2_dqt_fixedAB_+3A_model_name">model_name</code></td>
<td>
<p>model name for the fitted model, options from ('BM','OU',
'FBM',OU+FBM','user_defined')</p>
</td></tr>
<tr><td><code id="theta_est_l2_dqt_fixedAB_+3A_msd_fn">msd_fn</code></td>
<td>
<p>msd_fn user defined mean squared displacement structure (MSD), a
function of <code>param</code> parameters and <code>d_input</code> lag times</p>
</td></tr>
<tr><td><code id="theta_est_l2_dqt_fixedAB_+3A_msd_grad_fn">msd_grad_fn</code></td>
<td>
<p>user defined MSD gradient structure,  a function of
<code>param</code> and <code>d_input</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Dynamic image structure function(Dqt) can be obtained from ensemble average
of absolute values squared of Four transformed intensity difference:
</p>
<p style="text-align: center;"><code class="reqn">D(q,\Delta t) = \langle |\Delta \hat{I}(q,t,\Delta t)|^2\rangle</code>
</p>

<p>See 'References'.
</p>


<h3>Value</h3>

<p>A list of estimated parameters and MSD from minimizing the l2 loss
function.
</p>


<h3>Author(s)</h3>

<p>Yue He [aut],
	      Xubo Liu [aut],
	      Mengyang Gu [aut, cre]
</p>


<h3>References</h3>

<p>Gu, M., He, Y., Liu, X., &amp; Luo, Y. (2023). Ab initio uncertainty
quantification in scattering analysis of microscopy.
arXiv preprint arXiv:2309.02468.
</p>
<p>Gu, M., Luo, Y., He, Y., Helgeson, M. E., &amp; Valentine, M. T. (2021).
Uncertainty quantification and estimation in differential dynamic microscopy.
Physical Review E, 104(3), 034610.
</p>
<p>Cerbino, R., &amp; Trappe, V. (2008). Differential dynamic microscopy: probing
wave vector dependent dynamics with a microscope. Physical review letters,
100(18), 188102.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
