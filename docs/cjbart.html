<!DOCTYPE html><html lang="en"><head><title>Help for package cjbart</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cjbart}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AMCE'><p>Average Marginal Component Effect Estimation with Credible Interval</p></a></li>
<li><a href='#cjbart'><p>Generate Conjoint Model Using BART</p></a></li>
<li><a href='#het_vimp'><p>Estimate Variable Importance Metrics for <code>cjbart</code> Object</p></a></li>
<li><a href='#IMCE'><p>Heterogeneous Effects Analysis of Conjoint Results</p></a></li>
<li><a href='#pIMCE'><p>Population-Weighted Heterogeneous Effects Analysis of Conjoint Results</p></a></li>
<li><a href='#plot.cjbart'><p>Plot Marginal Component Effects of a <code>cjbart</code> Object</p></a></li>
<li><a href='#plot.cjbart.vimp'><p>Plot Variable Importance Matrix for Heterogeneity Analysis</p></a></li>
<li><a href='#rf_vimp'><p>Estimate a Single Variable Importance Metric for <code>cjbart</code> Object</p></a></li>
<li><a href='#RMCE'><p>Inspect Round-Level Marginal Component Effect (RMCE)</p></a></li>
<li><a href='#summary.cjbart'><p>Summarizing <code>cjbart</code> Marginal Component Effect Estimates</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Heterogeneous Effects Analysis of Conjoint Experiments</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.2</td>
</tr>
<tr>
<td>Description:</td>
<td>A tool for analyzing conjoint experiments using Bayesian Additive Regression Trees ('BART'), a machine learning method developed by Chipman, George and McCulloch (2010) &lt;<a href="https://doi.org/10.1214%2F09-AOAS285">doi:10.1214/09-AOAS285</a>&gt;. This tool focuses specifically on estimating, identifying, and visualizing the heterogeneity within marginal component effects, at the observation- and individual-level. It uses a variable importance measure ('VIMP') with delete-d jackknife variance estimation, following Ishwaran and Lu (2019) &lt;<a href="https://doi.org/10.1002%2Fsim.7803">doi:10.1002/sim.7803</a>&gt;, to obtain bias-corrected estimates of which variables drive heterogeneity in the predicted individual-level effects.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License (&ge; 2.0)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0), BART</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, rlang, tidyr, ggplot2, randomForestSRC (&ge; 3.2.2),
Rdpack</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), knitr, parallel, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/tsrobinson/cjbart">https://github.com/tsrobinson/cjbart</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/tsrobinson/cjbart/issues">https://github.com/tsrobinson/cjbart/issues</a></td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-06 15:00:59 UTC; tsr</td>
</tr>
<tr>
<td>Author:</td>
<td>Thomas Robinson <a href="https://orcid.org/0000-0001-7097-1599"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Raymond Duch <a href="https://orcid.org/0000-0002-1166-7674"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thomas Robinson &lt;ts.robinson1994@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-06 16:10:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='AMCE'>Average Marginal Component Effect Estimation with Credible Interval</h2><span id='topic+AMCE'></span>

<h3>Description</h3>

<p><code>AMCE</code> calculates the average marginal component effects from a BART-estimated conjoint model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AMCE(
  data,
  model,
  attribs,
  ref_levels,
  method = "bayes",
  alpha = 0.05,
  cores = 1,
  skip_checks = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AMCE_+3A_data">data</code></td>
<td>
<p>A data.frame, containing all attributes, covariates, the outcome and id variables to analyze.</p>
</td></tr>
<tr><td><code id="AMCE_+3A_model">model</code></td>
<td>
<p>A model object, the result of running <code>cjbart()</code></p>
</td></tr>
<tr><td><code id="AMCE_+3A_attribs">attribs</code></td>
<td>
<p>Vector of attribute names for which IMCEs will be predicted</p>
</td></tr>
<tr><td><code id="AMCE_+3A_ref_levels">ref_levels</code></td>
<td>
<p>Vector of reference levels, used to calculate marginal effects</p>
</td></tr>
<tr><td><code id="AMCE_+3A_method">method</code></td>
<td>
<p>Character string, setting the variance estimation method to use. When method is &quot;parametric&quot;, a typical combined variance estimate is employed; when <code>method = "bayes"</code>, the 95% posterior interval is calculated; and when <code>method = "rubin"</code>, combination rules are used to combine the variance analogous to in multiple imputation analysis.</p>
</td></tr>
<tr><td><code id="AMCE_+3A_alpha">alpha</code></td>
<td>
<p>Number between 0 and 1 &ndash; the significance level used to compute confidence/posterior intervals. When <code>method = "bayes"</code>, the posterior interval is calculated by taking the alpha/2 and (1-alpha/2) quantiles of the posterior draws. When <code>method = "rubin"</code>, the confidence interval equals the IMCE +/- <code>qnorm(alpha/2)</code>. By default, alpha is 0.05 i.e. generating a 95% confidence/posterior interval.</p>
</td></tr>
<tr><td><code id="AMCE_+3A_cores">cores</code></td>
<td>
<p>Number of CPU cores used during prediction phase</p>
</td></tr>
<tr><td><code id="AMCE_+3A_skip_checks">skip_checks</code></td>
<td>
<p>Boolean, indicating whether to check the structure of the data (default = <code>FALSE</code>). Only set this to <code>TRUE</code> if you are confident that the data is structured appropriately</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The AMCE estimates are the average of all computed OMCEs.
</p>


<h3>Value</h3>

<p><code>AMCE</code> returns an object of type &quot;cjbart&quot;, a list object.
</p>
<table role = "presentation">
<tr><td><code>amces</code></td>
<td>
<p>A data.frame containing the average marginal component effects</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>The significance level used to compute the credible interval</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+cjbart">cjbart()</a></code>
</p>

<hr>
<h2 id='cjbart'>Generate Conjoint Model Using BART</h2><span id='topic+cjbart'></span>

<h3>Description</h3>

<p>A wrapper for the <code><a href="BART.html#topic+pbart">BART::pbart()</a></code> function used for estimating heterogeneity in conjoint models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cjbart(
  data,
  Y,
  type = NULL,
  id = NULL,
  round = NULL,
  use_round = TRUE,
  cores = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cjbart_+3A_data">data</code></td>
<td>
<p>A data.frame, containing all attributes, controls, the outcome and id variables to analyze.</p>
</td></tr>
<tr><td><code id="cjbart_+3A_y">Y</code></td>
<td>
<p>Character string &ndash; the outcome variable</p>
</td></tr>
<tr><td><code id="cjbart_+3A_type">type</code></td>
<td>
<p>Type of conjoint experiment &ndash; either &quot;choice&quot; (for forced-choice outcomes) or &quot;rating&quot; (for interval ratings). If NULL (default), the function will attempt to automatically detect the outcome type.</p>
</td></tr>
<tr><td><code id="cjbart_+3A_id">id</code></td>
<td>
<p>Character string &ndash; variable identifying individual respondents (optional)</p>
</td></tr>
<tr><td><code id="cjbart_+3A_round">round</code></td>
<td>
<p>Character string &ndash; variable identifying rounds of the conjoint experiment</p>
</td></tr>
<tr><td><code id="cjbart_+3A_use_round">use_round</code></td>
<td>
<p>Boolean &ndash; whether to include the round indicator column when training the BART model (default = <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="cjbart_+3A_cores">cores</code></td>
<td>
<p>Integer &ndash; number of CPU cores used in model training</p>
</td></tr>
<tr><td><code id="cjbart_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="BART.html#topic+mc.pbart">BART::mc.pbart()</a></code> if on a Unix-based system</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Please note, Windows users cannot use the parallelized <code><a href="BART.html#topic+mc.pbart">BART::mc.pbart()</a></code> function, and so setting an internal seed will not be used.
</p>


<h3>Value</h3>

<p>A trained <code><a href="BART.html#topic+pbart">BART::pbart()</a></code> model that can be passed to <code><a href="#topic+IMCE">IMCE()</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="BART.html#topic+pbart">BART::pbart()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>subjects &lt;- 5
rounds &lt;- 2
profiles &lt;- 2
obs &lt;- subjects*rounds*profiles

fake_data &lt;- data.frame(A = sample(c("a1","a2"), obs, replace = TRUE),
                        B = sample(c("b1","b2"), obs, replace = TRUE),
                        id1 = rep(1:subjects, each=rounds),
                        stringsAsFactors = TRUE)

fake_data$Y &lt;- sample(c(0,1), obs, replace = TRUE)

cj_model &lt;- cjbart(data = fake_data,
                   Y = "Y",
                   id = "id1")
</code></pre>

<hr>
<h2 id='het_vimp'>Estimate Variable Importance Metrics for <code>cjbart</code> Object</h2><span id='topic+het_vimp'></span>

<h3>Description</h3>

<p>Estimates random forest variable importance scores for multiple attribute-levels of a conjoint experiment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>het_vimp(imces, levels = NULL, covars = NULL, cores = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="het_vimp_+3A_imces">imces</code></td>
<td>
<p>Object of class <code>cjbart</code>, the result of running <code><a href="#topic+IMCE">IMCE()</a></code></p>
</td></tr>
<tr><td><code id="het_vimp_+3A_levels">levels</code></td>
<td>
<p>An optional vector of attribute-levels to generate importance metrics for. By default, all attribute-levels are analyzed.</p>
</td></tr>
<tr><td><code id="het_vimp_+3A_covars">covars</code></td>
<td>
<p>An optional vector of covariates to include in the importance metric check. By default, all covariates are included in each importance model.</p>
</td></tr>
<tr><td><code id="het_vimp_+3A_cores">cores</code></td>
<td>
<p>Number of CPU cores used during VIMP estimation. Each extra core will result in greater memory consumption. Assigning more cores than outcomes will not further boost performance.</p>
</td></tr>
<tr><td><code id="het_vimp_+3A_...">...</code></td>
<td>
<p>Extra arguments (used to check for deprecated argument names)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Having generated a schedule of individual-level marginal component effect estimates, this function fits a random forest model for each attribute-level using the supplied covariates as predictors. It then calculates a variable importance measure (VIMP) for each covariate. The VIMP method assesses how important each covariate is in terms of partitioning the predicted individual-level effects distribution, and can thus be used as an indicator of which variables drive heterogeneity in the IMCEs.
</p>
<p>To recover a VIMP measure, we used permutation-based importance metrics recovered from random forest models estimated using <code><a href="randomForestSRC.html#topic+rfsrc">randomForestSRC::rfsrc()</a></code>. To permute the data, this function uses random node assignment, whereby cases are randomly assigned to a daughter node whenever a tree splits on the target variable (see Ishwaran et al. 2008). Importance is defined in terms of how random node assignment degrades the performance of the forest. Higher degradation indicates a variable is more important to prediction.
</p>
<p>Variance estimates of each variable's importance are subsequently recovered using the delete-d jackknife estimator developed by Ishwaran and Lu (2019). The jackknife method has inherent bias correction properties, making it particularly effective for variable selection exercises such as identifying drivers of heterogeneity.
</p>


<h3>Value</h3>

<p>A &quot;long&quot; data.frame of variable importance scores for each combination of covariates and attribute-levels, as well as the estimated 95% confidence intervals for each metric.
</p>


<h3>References</h3>

<p>Ishwaran H, Kogalur UB, Blackstone EH, Lauer MS (2008).
&ldquo;Random survival forests.&rdquo;
<em>The annals of applied statistics</em>, <b>2</b>(3), 841&ndash;860.<br /><br /> Ishwaran H, Lu M (2019).
&ldquo;Standard errors and confidence intervals for variable importance in random forest regression, classification, and survival.&rdquo;
<em>Statistics in medicine</em>, <b>38</b>(4), 558&ndash;582.
</p>


<h3>See Also</h3>

<p><code><a href="randomForestSRC.html#topic+rfsrc">randomForestSRC::rfsrc()</a></code> and <code><a href="randomForestSRC.html#topic+subsample.rfsrc">randomForestSRC::subsample()</a></code>
</p>

<hr>
<h2 id='IMCE'>Heterogeneous Effects Analysis of Conjoint Results</h2><span id='topic+IMCE'></span>

<h3>Description</h3>

<p><code>IMCE</code> calculates the individual-level marginal component effects from a BART-estimated conjoint model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IMCE(
  data,
  model,
  attribs,
  ref_levels,
  method = "bayes",
  alpha = 0.05,
  keep_omce = FALSE,
  cores = 1,
  skip_checks = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IMCE_+3A_data">data</code></td>
<td>
<p>A data.frame, containing all attributes, covariates, the outcome and id variables to analyze.</p>
</td></tr>
<tr><td><code id="IMCE_+3A_model">model</code></td>
<td>
<p>A model object, the result of running <code>cjbart()</code></p>
</td></tr>
<tr><td><code id="IMCE_+3A_attribs">attribs</code></td>
<td>
<p>Vector of attribute names for which IMCEs will be predicted</p>
</td></tr>
<tr><td><code id="IMCE_+3A_ref_levels">ref_levels</code></td>
<td>
<p>Vector of reference levels, used to calculate marginal effects</p>
</td></tr>
<tr><td><code id="IMCE_+3A_method">method</code></td>
<td>
<p>Character string, setting the variance estimation method to use. When method is &quot;parametric&quot;, a typical combined variance estimate is employed; when <code>method = "bayes"</code>, the 95% posterior interval is calculated; and when <code>method = "rubin"</code>, combination rules are used to combine the variance analogous to in multiple imputation analysis.</p>
</td></tr>
<tr><td><code id="IMCE_+3A_alpha">alpha</code></td>
<td>
<p>Number between 0 and 1 &ndash; the significance level used to compute confidence/posterior intervals. When <code>method = "bayes"</code>, the posterior interval is calculated by taking the alpha/2 and (1-alpha/2) quantiles of the posterior draws. When <code>method = "rubin"</code>, the confidence interval equals the IMCE +/- <code>qnorm(alpha/2)</code>. By default, alpha is 0.05 i.e. generating a 95% confidence/posterior interval.</p>
</td></tr>
<tr><td><code id="IMCE_+3A_keep_omce">keep_omce</code></td>
<td>
<p>Boolean, indicating whether to keep the OMCE-level results (default = <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="IMCE_+3A_cores">cores</code></td>
<td>
<p>Number of CPU cores used during prediction phase</p>
</td></tr>
<tr><td><code id="IMCE_+3A_skip_checks">skip_checks</code></td>
<td>
<p>Boolean, indicating whether to check the structure of the data (default = <code>FALSE</code>). Only set this to <code>TRUE</code> if you are confident that the data is structured appropriately</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The OMCE estimates are the result of subtracting the predicted value of each observation under the reference-level category from the predicted value of each observation under the given attribute level.
If an attribute has <em>k</em> levels, then this will yield <em>k-1</em> estimates per observation.
The IMCE is the average of the OMCEs for each individual within the data.
</p>


<h3>Value</h3>

<p><code>IMCE</code> returns an object of type &quot;cjbart&quot;, a list object.
</p>
<table role = "presentation">
<tr><td><code>omce</code></td>
<td>
<p>A data.frame containing the observation-level marginal effects</p>
</td></tr>
<tr><td><code>imce</code></td>
<td>
<p>A data.frame containing the individual-level marginal effects</p>
</td></tr>
<tr><td><code>imce_upper</code></td>
<td>
<p>A data.frame containing the upper bound of the IMCE confidence/credible interval</p>
</td></tr>
<tr><td><code>imce_lower</code></td>
<td>
<p>A data.frame containing the lower bound of the IMCE confidence/credible interval</p>
</td></tr>
<tr><td><code>att_levels</code></td>
<td>
<p>A vector containing the attribute levels</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+cjbart">cjbart()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>subjects &lt;- 5
rounds &lt;- 2
profiles &lt;- 2
obs &lt;- subjects*rounds*profiles

fake_data &lt;- data.frame(A = sample(c("a1","a2"), obs, replace = TRUE),
                        B = sample(c("b1","b2"), obs, replace = TRUE),
                        id1 = rep(1:subjects, each=rounds),
                        stringsAsFactors = TRUE)

fake_data$Y &lt;- sample(c(0,1), obs, replace = TRUE)

cj_model &lt;- cjbart(data = fake_data,
                   Y = "Y",
                   id = "id1")

## Skip if not Unix due to longer CPU time
if (.Platform$OS.type=='unix') {

  het_effects &lt;- IMCE(data = fake_data,
                      model = cj_model,
                      attribs = c("A","B"),
                      ref_levels = c("a1","b1"),
                      cores = 1)

  summary(het_effects)
}


</code></pre>

<hr>
<h2 id='pIMCE'>Population-Weighted Heterogeneous Effects Analysis of Conjoint Results</h2><span id='topic+pIMCE'></span>

<h3>Description</h3>

<p><code>pIMCE</code> calculates the population individual-level marginal component effects from a BART-estimated conjoint model, using marginal attribute distributions specified by the researcher.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pIMCE(
  model,
  covar_data,
  attribs,
  l,
  l_1,
  l_0,
  marginals,
  method = "bayes",
  alpha = 0.05,
  cores = 1,
  skip_checks = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pIMCE_+3A_model">model</code></td>
<td>
<p>A model object, the result of running <code>cjbart()</code></p>
</td></tr>
<tr><td><code id="pIMCE_+3A_covar_data">covar_data</code></td>
<td>
<p>A data.frame of covariate information to predict pIMCEs over</p>
</td></tr>
<tr><td><code id="pIMCE_+3A_attribs">attribs</code></td>
<td>
<p>Vector of attribute names</p>
</td></tr>
<tr><td><code id="pIMCE_+3A_l">l</code></td>
<td>
<p>Name of the attribute of interest</p>
</td></tr>
<tr><td><code id="pIMCE_+3A_l_1">l_1</code></td>
<td>
<p>Attribute-level of interest for attribute <em>l</em></p>
</td></tr>
<tr><td><code id="pIMCE_+3A_l_0">l_0</code></td>
<td>
<p>Reference level for attribute <em>l</em></p>
</td></tr>
<tr><td><code id="pIMCE_+3A_marginals">marginals</code></td>
<td>
<p>A named list where every element is a named vector of marginal probabilities for each corresponding attribute-level.  For example, <code>marginals = list("A1" = c("q" = 0.4, "r" = 0.6), "A2" = c("x" = 0.7, "y" = 0.2, "z" = 0.1))</code></p>
</td></tr>
<tr><td><code id="pIMCE_+3A_method">method</code></td>
<td>
<p>Character string, setting the variance estimation method to use. When method is &quot;parametric&quot;, a typical combined variance estimate is employed; when <code>method = "bayes"</code>, the 95% posterior interval is calculated; and when <code>method = "rubin"</code>, combination rules are used to combine the variance analogous to in multiple imputation analysis.</p>
</td></tr>
<tr><td><code id="pIMCE_+3A_alpha">alpha</code></td>
<td>
<p>Number between 0 and 1 &ndash; the significance level used to compute confidence/posterior intervals. When <code>method = "bayes"</code>, the posterior interval is calculated by taking the alpha/2 and (1-alpha/2) quantiles of the posterior draws. When <code>method = "rubin"</code>, the confidence interval equals the IMCE +/- <code>qnorm(alpha/2)</code>. By default, alpha is 0.05 i.e. generating a 95% confidence/posterior interval.</p>
</td></tr>
<tr><td><code id="pIMCE_+3A_cores">cores</code></td>
<td>
<p>Number of CPU cores used during prediction phase</p>
</td></tr>
<tr><td><code id="pIMCE_+3A_skip_checks">skip_checks</code></td>
<td>
<p>Boolean, indicating whether to check the structure of the data (default = <code>FALSE</code>). Only set this to <code>TRUE</code> if you are confident that the data is structured appropriately</p>
</td></tr>
<tr><td><code id="pIMCE_+3A_verbose">verbose</code></td>
<td>
<p>Boolean, indicating whether to print progress (default = TRUE)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the population-weighted IMCE, which takes into account the population distribution of profiles. Rather than average over the multiple OMCE estimates, this function generates estimated treatment effects for <em>all</em> possible potential outcomes along all attributes except the attribute of interest, and then marginalizes these over the supplied marginal distributions. Uncertainty estimates are recovered using credible intervals.
</p>


<h3>Value</h3>

<p><code>pIMCE</code> returns a data.frame of population-weighted estimates, credible interval bounds, and the covariate information supplied
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cjbart">cjbart()</a></code>
</p>

<hr>
<h2 id='plot.cjbart'>Plot Marginal Component Effects of a <code>cjbart</code> Object</h2><span id='topic+plot.cjbart'></span>

<h3>Description</h3>

<p>Plots observation-level or individual-level marginal component effects (OMCE and IMCE respectively). By default, all attribute-levels in the model are plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cjbart'
plot(x, covar = NULL, plot_levels = NULL, se = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.cjbart_+3A_x">x</code></td>
<td>
<p>Object of class <code>cjbart</code>, the result of running <code><a href="#topic+IMCE">IMCE()</a></code></p>
</td></tr>
<tr><td><code id="plot.cjbart_+3A_covar">covar</code></td>
<td>
<p>Character string detailing the covariate over which to analyze heterogeneous effects</p>
</td></tr>
<tr><td><code id="plot.cjbart_+3A_plot_levels">plot_levels</code></td>
<td>
<p>Optional vector of conjoint attribute levels to plot. If not supplied, all attributes within the conjoint model will be plotted.</p>
</td></tr>
<tr><td><code id="plot.cjbart_+3A_se">se</code></td>
<td>
<p>Boolean determining whether to show an estimated 95% confidence interval</p>
</td></tr>
<tr><td><code id="plot.cjbart_+3A_...">...</code></td>
<td>
<p>Additional arguments for plotting the marginal component effects (see below).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of marginal component effects.
</p>

<hr>
<h2 id='plot.cjbart.vimp'>Plot Variable Importance Matrix for Heterogeneity Analysis</h2><span id='topic+plot.cjbart.vimp'></span>

<h3>Description</h3>

<p>Plots a heatmap of variable importance, across predicted IMCEs. By default, all attribute-levels and covariates in the model are plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cjbart.vimp'
plot(x, covars = NULL, att_levels = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.cjbart.vimp_+3A_x">x</code></td>
<td>
<p>Object of class <code>cjbart.vimp</code>, the result of running <code><a href="#topic+het_vimp">het_vimp()</a></code></p>
</td></tr>
<tr><td><code id="plot.cjbart.vimp_+3A_covars">covars</code></td>
<td>
<p>Optional vector of covariate names to plot. By default, all included covariates are shown.</p>
</td></tr>
<tr><td><code id="plot.cjbart.vimp_+3A_att_levels">att_levels</code></td>
<td>
<p>Optional vector of attribute-levels to plot. By default, all attribute-levels are shown.</p>
</td></tr>
<tr><td><code id="plot.cjbart.vimp_+3A_...">...</code></td>
<td>
<p>Additional arguments (not currently used)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of covariate importance scores
</p>

<hr>
<h2 id='rf_vimp'>Estimate a Single Variable Importance Metric for <code>cjbart</code> Object</h2><span id='topic+rf_vimp'></span>

<h3>Description</h3>

<p>Estimates random forest variable importance scores for a single attribute-level of a conjoint experiment. This function is for advanced use. Users should typically use the <code><a href="#topic+het_vimp">het_vimp()</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rf_vimp(model, outcome, covars = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rf_vimp_+3A_model">model</code></td>
<td>
<p>Object of class <code>cjbart</code>, the result of running <code><a href="#topic+IMCE">IMCE()</a></code></p>
</td></tr>
<tr><td><code id="rf_vimp_+3A_outcome">outcome</code></td>
<td>
<p>Character string detailing the covariate over which to analyze heterogeneous effects</p>
</td></tr>
<tr><td><code id="rf_vimp_+3A_covars">covars</code></td>
<td>
<p>An optional vector of covariates to include in the importance metric check. When <code>covars = NULL</code> (the default), all covariates are included in the importance model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data.frame of variable importance scores for each covariate in the model, as well as values for the estimated 95% confidence interval for each importance score.
</p>

<hr>
<h2 id='RMCE'>Inspect Round-Level Marginal Component Effect (RMCE)</h2><span id='topic+RMCE'></span>

<h3>Description</h3>

<p><code>RMCE</code> calculates the round-level marginal component effects from a cjbart model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RMCE(imces)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RMCE_+3A_imces">imces</code></td>
<td>
<p>An object of class &quot;cjbart&quot;, the result of calling the <code>cjbart::IMCE()</code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The RMCE estimates are the result of averaging the OMCEs within each round, for each subject in the experiment.
The RMCE is the intermediate causal quantity between OMCEs and IMCEs, and can be useful for inspecting whether there are any carryover or stability issues across rounds.
</p>


<h3>Value</h3>

<p><code>IMCE</code> returns a data frame of RMCEs.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cjbart">cjbart()</a></code> and <code><a href="#topic+IMCE">IMCE()</a></code>
</p>

<hr>
<h2 id='summary.cjbart'>Summarizing <code>cjbart</code> Marginal Component Effect Estimates</h2><span id='topic+summary.cjbart'></span>

<h3>Description</h3>

<p><code>summary</code> method for class &quot;cjbart&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cjbart'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.cjbart_+3A_object">object</code></td>
<td>
<p>Object of class <code>cjbart</code>, the result of running <code><a href="#topic+IMCE">IMCE()</a></code></p>
</td></tr>
<tr><td><code id="summary.cjbart_+3A_...">...</code></td>
<td>
<p>Further arguments (not currently used)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame summarizing the average marginal component effect (AMCE), the minimum and maximum values, and standard deviations for each attribute-level.
</p>


<h3>Note</h3>

<p>To calculate the AMCE with Bayesian credible intervals, please use the <code>AMCE()</code> function instead.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AMCE">AMCE()</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
