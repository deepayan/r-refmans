<!DOCTYPE html><html lang="en"><head><title>Help for package holobiont</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {holobiont}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#coreFaithsPD'>
<p>Faiths PD of the Core Microbiome</p></a></li>
<li><a href='#coreJaccard'>
<p>Jaccard Distance Between Core Microbiomes from Two Habitats</p></a></li>
<li><a href='#corePhyloVenn'>
<p>Phylogenetic Venn Diagram Comparing Core Microbiomes from Multiple Habitats</p></a></li>
<li><a href='#coreTree'>
<p>The Core Community Phylogeny</p></a></li>
<li><a href='#coreUniFrac'>
<p>UniFrac Distance Between Core Microbiomes from Two Habitats</p></a></li>
<li><a href='#coreVennTree'>
<p>Phylogeny with Branches Colored Based on Venn Diagram</p></a></li>
<li><a href='#ggvenn2'><p>A modified version of functions from the ggvenn package for plotting phylogenetic venn diagrams.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Microbiome Analysis Tools</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>We provide functions for identifying the core community phylogeny in any microbiome, drawing phylogenetic Venn diagrams, calculating the core Faith’s PD for a set of communities, and calculating the core UniFrac distance between two sets of communities. All functions rely on construction of a core community phylogeny, which is a phylogeny where branches are defined based on their presence in multiple samples from a single type of habitat. Our package provides two options for constructing the core community phylogeny, a tip-based approach, where the core community phylogeny is identified based on incidence of leaf nodes and a branch-based approach, where the core community phylogeny is identified based on incidence of individual branches. We suggest use of the microViz package, which can be downloaded from the website provided under Additional repositories.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>biocViews:</td>
<td>Software, phyloseq</td>
</tr>
<tr>
<td>Imports:</td>
<td>ape, phyloseq, phytools, ggplot2, dplyr, utils, tibble</td>
</tr>
<tr>
<td>Suggests:</td>
<td>microViz</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Additional_repositories:</td>
<td><a href="https://david-barnett.r-universe.dev/builds">https://david-barnett.r-universe.dev/builds</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-12 03:51:08 UTC; loaner</td>
</tr>
<tr>
<td>Author:</td>
<td>Sharon Bewick [aut, cre],
  Benjamin Camper [aut],
  National Science Foundation Division of Integrative Organismal Systems
    (award #2104605) [fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sharon Bewick &lt;sbewick@clemson.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-16 17:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='coreFaithsPD'>
Faiths PD of the Core Microbiome
</h2><span id='topic+coreFaithsPD'></span>

<h3>Description</h3>

<p>Calculates Faith's phylogenetic diversity (PD) of a core microbiome based on either the tip-based or the branch-based core community phylogeny.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coreFaithsPD(x, core_fraction, mode='branch', rooted=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coreFaithsPD_+3A_x">x</code></td>
<td>

<p>(Required) Microbial community data. This must be in the form of a phyloseq object and must contain, at a minimum, an OTU abundance table and a phylogeny.
</p>
</td></tr>
<tr><td><code id="coreFaithsPD_+3A_core_fraction">core_fraction</code></td>
<td>

<p>(Required) The fraction of samples that a microbial taxon must be found in to be considered part of the 'core' microbiome.
</p>
</td></tr>
<tr><td><code id="coreFaithsPD_+3A_mode">mode</code></td>
<td>

<p>Whether to build a tip-based ('tip') or a branch-based ('branch') phylogeny. The default is 'branch'.
</p>
</td></tr>
<tr><td><code id="coreFaithsPD_+3A_rooted">rooted</code></td>
<td>

<p>Whether to include the root of the phylogeny. The default is TRUE, meaning that the root is necessarily included in all phylogenies. This requires that the input tree be rooted.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>coreFaithsPD</code> calculates Faith's PD (Faith, 1992) based on either the tip-based or the branch-based core community phylogeny. In both cases, Faith's PD is calculated as the sum of the branch lengths in the core community phylogeny. For more details, see Bewick and Camper (2025).
</p>


<h3>Value</h3>

<p>This function returns the numeric value of Faith's PD for the core microbiome.
</p>


<h3>References</h3>

<p>Bewick, S.A. and Benjamin T. Camper. &quot;Phylogenetic Measures of the Core Microbiome&quot; &lt;doi:TBD&gt;
</p>
<p>Faith, Daniel P. &quot;Conservation evaluation and phylogenetic diversity.&quot; Biological conservation 61.1 (1992): 1-10.
</p>
<p>McMurdie, Paul J., and Susan Holmes. &quot;phyloseq: an R package for reproducible interactive analysis and graphics of microbiome census data.&quot; PloS one 8.4 (2013): e61217.
</p>
<p>McMurdie, Paul J., and Susan Holmes. &quot;Phyloseq: a bioconductor package for handling and analysis of high-throughput phylogenetic sequence data.&quot; Biocomputing 2012. 2012. 235-246.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Test with enterotype dataset
library(phyloseq)
library(ape)
library(phytools)
data(enterotype)

set.seed(1)

#Generate an example tree and label it with the names of the microbial taxa
enterotype_tree&lt;-rtree(length(taxa_names(enterotype)))
enterotype_tree$tip.label&lt;-taxa_names(enterotype)

#Create a phyloseq object with a tree
example_phyloseq&lt;-phyloseq(otu_table(enterotype),phy_tree(as.phylo(enterotype_tree)))

coreFaithsPD(example_phyloseq,0.5)

</code></pre>

<hr>
<h2 id='coreJaccard'>
Jaccard Distance Between Core Microbiomes from Two Habitats
</h2><span id='topic+coreJaccard'></span>

<h3>Description</h3>

<p>Calculates the Jaccard distance between the core microbiomes from two different types of habitats based on either the tip-based or the branch-based core community phylogeny.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coreJaccard(x, grouping, core_fraction)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coreJaccard_+3A_x">x</code></td>
<td>

<p>(Required) Microbial community data. This must be in the form of a phyloseq object and must contain, at a minimum, an OTU abundance table.
</p>
</td></tr>
<tr><td><code id="coreJaccard_+3A_grouping">grouping</code></td>
<td>

<p>(Required) A vector specifying which samples belong to which habitat type.
</p>
</td></tr>
<tr><td><code id="coreJaccard_+3A_core_fraction">core_fraction</code></td>
<td>

<p>(Required) The fraction of samples that a microbial taxon must be found in to be considered part of the 'core' microbiome.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>coreJaccard</code> calculates the Jaccard distance (Jaccard, 1901 A and B) between the core microbiomes from two different types of habitats. Briefly, the Jaccard distance is calculated as the number of unique taxa in the core communities from each of the two habitats, divided by the total number of taxa in the two habitats combined. For more details, see Bewick and Camper (2025).
</p>


<h3>Value</h3>

<p>This function returns the numeric value of the Jaccard distance between two core microbiomes.
</p>


<h3>References</h3>

<p>Bewick, S.A. and Benjamin T. Camper. &quot;Phylogenetic Measures of the Core Microbiome&quot; &lt;doi:TBD&gt;
</p>
<p>Jaccard, P. (1901A) Étude comparative de la distribution florale dans une portion des Alpes et des Jura. Bulletin de la Société Vaudoise des Sciences Naturelles 37, 547-579.
</p>
<p>Jaccard, P. (1901B) Distribution de la flore alpine dans le bassin des Dranses et dans quelques régions voisines. Bulletin de la Société Vaudoise des Sciences Naturelles 37, 241-272.
</p>
<p>McMurdie, Paul J., and Susan Holmes. &quot;phyloseq: an R package for reproducible interactive analysis and graphics of microbiome census data.&quot; PloS one 8.4 (2013): e61217.
</p>
<p>McMurdie, Paul J., and Susan Holmes. &quot;Phyloseq: a bioconductor package for handling and analysis of high-throughput phylogenetic sequence data.&quot; Biocomputing 2012. 2012. 235-246.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Test with enterotype dataset
library(phyloseq)
library(ape)
library(phytools)
data(enterotype)

set.seed(1)

#Generate an example tree and label it with the names of the microbial taxa
enterotype_tree&lt;-rtree(length(taxa_names(enterotype)))
enterotype_tree$tip.label&lt;-taxa_names(enterotype)

#keep only those samples with gender identified
gendered&lt;-which(!(is.na(sample_data(enterotype)$Gender)))
enterotypeMF&lt;-prune_samples(sample_names(enterotype)[gendered],enterotype)

#Create a phyloseq object with a tree
example_phyloseq&lt;-phyloseq(otu_table(enterotypeMF))

coreJaccard(example_phyloseq,grouping=sample_data(enterotypeMF)$Gender,0.5)

</code></pre>

<hr>
<h2 id='corePhyloVenn'>
Phylogenetic Venn Diagram Comparing Core Microbiomes from Multiple Habitats
</h2><span id='topic+corePhyloVenn'></span>

<h3>Description</h3>

<p>Generates a Venn diagram comparing and contrasting the shared and unique phylogenetic branch lengths of core microbiomes from two or more (up to seven) different types of habitats based on either the tip-based or the branch-based core community phylogeny.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corePhyloVenn(x, grouping, core_fraction,
mode = 'branch',rooted=TRUE, ordered_groups=NULL,show_percentage=TRUE,decimal=2,
fill_color=c('red','orange','yellow','green','blue','purple','black'),fill_alpha=0.5,
stroke_color='black',stroke_alpha = 1, stroke_size = 1,stroke_linetype = "solid",
set_name_color = "black", set_name_size = 6,text_color = "black",text_size = 4)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="corePhyloVenn_+3A_x">x</code></td>
<td>

<p>(Required) Microbial community data. This must be in the form of a phyloseq object and must contain, at a minimum, an OTU abundance table and a phylogeny.
</p>
</td></tr>
<tr><td><code id="corePhyloVenn_+3A_grouping">grouping</code></td>
<td>

<p>(Required) A vector specifying which samples belong to which habitat type.
</p>
</td></tr>
<tr><td><code id="corePhyloVenn_+3A_core_fraction">core_fraction</code></td>
<td>

<p>(Required) The fraction of samples that a microbial taxon must be found in to be considered part of the 'core' microbiome.
</p>
</td></tr>
<tr><td><code id="corePhyloVenn_+3A_mode">mode</code></td>
<td>

<p>Whether to build a tip-based ('tip') or a branch-based ('branch') phylogeny. The default is 'branch'.
</p>
</td></tr>
<tr><td><code id="corePhyloVenn_+3A_rooted">rooted</code></td>
<td>

<p>Whether to include the root of the phylogeny. The default is TRUE, meaning that the root is necessarily included in all phylogenies. This requires that the input tree be rooted.
</p>
</td></tr>
<tr><td><code id="corePhyloVenn_+3A_ordered_groups">ordered_groups</code></td>
<td>

<p>When provided, specifies the order in which different habitats should be plotted. This order is matched to the color order specified in <code>fill_color</code> (see below).
</p>
</td></tr>
<tr><td><code id="corePhyloVenn_+3A_show_percentage">show_percentage</code></td>
<td>

<p>If <code>TRUE</code> the Venn diagram is shown as percentages of the total branch length in each compartment. If <code>FALSE</code> the Venn diagram is shown as absolute branch lengths.
</p>
</td></tr>
<tr><td><code id="corePhyloVenn_+3A_decimal">decimal</code></td>
<td>

<p>The number of decimal points to report in the Venn diagram compartments (either for percentages or absolute branch lengths).
</p>
</td></tr>
<tr><td><code id="corePhyloVenn_+3A_fill_color">fill_color</code></td>
<td>

<p>A vector specifying the colors to use for each of the different habitats in the Venn diagram. The default is to use the six colors of the rainbow, followed by black.
</p>
</td></tr>
<tr><td><code id="corePhyloVenn_+3A_fill_alpha">fill_alpha</code></td>
<td>

<p>The transparency of the fill colors in the Venn diagram.
</p>
</td></tr>
<tr><td><code id="corePhyloVenn_+3A_stroke_color">stroke_color</code></td>
<td>

<p>The color of the outlines in the Venn diagram.
</p>
</td></tr>
<tr><td><code id="corePhyloVenn_+3A_stroke_alpha">stroke_alpha</code></td>
<td>

<p>The transparency of the outlines in the Venn diagram.
</p>
</td></tr>
<tr><td><code id="corePhyloVenn_+3A_stroke_size">stroke_size</code></td>
<td>

<p>The width of the outlines in the Venn diagram.
</p>
</td></tr>
<tr><td><code id="corePhyloVenn_+3A_stroke_linetype">stroke_linetype</code></td>
<td>

<p>The style of the outlines in the Venn diagram.
</p>
</td></tr>
<tr><td><code id="corePhyloVenn_+3A_set_name_color">set_name_color</code></td>
<td>

<p>The color of the font used to label each habitat.
</p>
</td></tr>
<tr><td><code id="corePhyloVenn_+3A_set_name_size">set_name_size</code></td>
<td>

<p>The size of the font used to label each habitat
</p>
</td></tr>
<tr><td><code id="corePhyloVenn_+3A_text_color">text_color</code></td>
<td>

<p>The color of the font used to report the value in each compartment of the Venn diagram
</p>
</td></tr>
<tr><td><code id="corePhyloVenn_+3A_text_size">text_size</code></td>
<td>

<p>The size of the font used to report the value in each compartment of the Venn diagram
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>corePhyloVenn</code> generates a Venn diagram showing either the percentage of the phylogenetic branch length or the absolute phylogenetic branch length shared between the core community phylogenies from all possible combinations of up to seven different habitat types. For more details, see Bewick and Camper (2025).
</p>


<h3>Value</h3>

<p>This function returns a plot of the phylogenetic Venn diagram.
</p>


<h3>References</h3>

<p>Bewick, S.A. and Benjamin T. Camper. &quot;Phylogenetic Measures of the Core Microbiome&quot; &lt;doi:TBD&gt;
</p>
<p>McMurdie, Paul J., and Susan Holmes. &quot;phyloseq: an R package for reproducible interactive analysis and graphics of microbiome census data.&quot; PloS one 8.4 (2013): e61217.
</p>
<p>McMurdie, Paul J., and Susan Holmes. &quot;Phyloseq: a bioconductor package for handling and analysis of high-throughput phylogenetic sequence data.&quot; Biocomputing 2012. 2012. 235-246.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Test with enterotype dataset
library(phyloseq)
library(ape)
library(phytools)
library(ggplot2)
data(enterotype)

set.seed(1)

#Generate an example tree and label it with the names of the microbial taxa
enterotype_tree&lt;-rtree(length(taxa_names(enterotype)))
enterotype_tree$tip.label&lt;-taxa_names(enterotype)

#keep only those samples with gender identified
gendered&lt;-which(!(is.na(sample_data(enterotype)$Gender)))
enterotypeMF&lt;-prune_samples(sample_names(enterotype)[gendered],enterotype)

#Create a phyloseq object with a tree
example_phyloseq&lt;-phyloseq(otu_table(enterotypeMF),phy_tree(as.phylo(enterotype_tree)))

corePhyloVenn(example_phyloseq,grouping=sample_data(enterotypeMF)$Gender,0.5)

</code></pre>

<hr>
<h2 id='coreTree'>
The Core Community Phylogeny
</h2><span id='topic+coreTree'></span>

<h3>Description</h3>

<p>Identifies and plots the tip-based or the branch-based core community phylogeny based on the occurrence of abundance of different microbial lineages in a set of samples from a common habitat (e.g., type of host or environment).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coreTree(x, core_fraction,
mode='branch', NCcol = 'black', Ccol='red',rooted=TRUE,
branch.width=4,label.tips=FALSE, remove_zeros=TRUE,
plot.chronogram=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coreTree_+3A_x">x</code></td>
<td>

<p>(Required) Microbial community data. This must be in the form of a phyloseq object and must contain, at a minimum, an OTU abundance table and a phylogeny.
</p>
</td></tr>
<tr><td><code id="coreTree_+3A_core_fraction">core_fraction</code></td>
<td>

<p>(Required) The fraction of samples that a microbial taxon must be found in to be considered part of the core microbiome.
</p>
</td></tr>
<tr><td><code id="coreTree_+3A_mode">mode</code></td>
<td>

<p>Whether to build a tip-based (<code>tip</code>) or a branch-based (<code>branch</code>) phylogeny. The default is <code>branch</code>.
</p>
</td></tr>
<tr><td><code id="coreTree_+3A_nccol">NCcol</code></td>
<td>

<p>The color to plot all branches of the phylogeny that are NOT part of the core community phylogeny. The default is black.
</p>
</td></tr>
<tr><td><code id="coreTree_+3A_ccol">Ccol</code></td>
<td>

<p>The color to plot all branches of the phylogeny that are ARE part of the core community phylogeny. The default is red.
</p>
</td></tr>
<tr><td><code id="coreTree_+3A_rooted">rooted</code></td>
<td>

<p>Whether to include the root of the phylogeny. The default is TRUE, meaning that the root is necessarily included in all phylogenies. This requires that the input tree be rooted.
</p>
</td></tr>
<tr><td><code id="coreTree_+3A_branch.width">branch.width</code></td>
<td>

<p>The width to use when plotting the branches of the phylogeny. The default is 4.
</p>
</td></tr>
<tr><td><code id="coreTree_+3A_label.tips">label.tips</code></td>
<td>

<p>Whether or not to label the tips of the phylogeny with the microbial taxon names. The default is FALSE.
</p>
</td></tr>
<tr><td><code id="coreTree_+3A_remove_zeros">remove_zeros</code></td>
<td>

<p>Whether or not to remove taxa that are missing from all samples prior to drawing the phylogeny. The default is TRUE.
</p>
</td></tr>
<tr><td><code id="coreTree_+3A_plot.chronogram">plot.chronogram</code></td>
<td>

<p>Whether to plot a phylogeny or a chronogram. The default is FALSE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>coreTree</code> identifies either the tip-based or the branch-based core community phylogeny. For the tip-based core community phylogeny, individual microbial taxa are retained based on being present in a threshold number of samples or at a threshold abundance. Once core microbial taxa have been identified, they are used to reconstruct the core community phylogeny. For the branch-based core community phylogeny, the phylogenetic tree for the entire dataset is examined, branch-by-branch, to determine which branches should be retained based on being present in a threshold number of samples or at a threshold abundance. If <code>rooted = TRUE</code>, branches are counted based on individual sample phylogenies that include the root node. Likewise, the tip-based tree is forced to include the root. If <code>rooted = FALSE</code>, branches are counted based on individual sample phylogenies that span all taxa present in the sample. Similarly, the tip-based phylogeny is the tree that spans all core taxa, and may not include the root.  For more details, see Bewick and Camper (2025).
</p>


<h3>Value</h3>

<p>This function plots the phylogeny for the entire dataset in black and colors the branches that are part of the core community phylogeny in red. These colors can be altered using the <code>NCcol</code> and <code>Ccol</code> variables.
</p>


<h3>References</h3>

<p>Bewick, S.A. and Benjamin T. Camper. &quot;Phylogenetic Measures of the Core Microbiome&quot; &lt;doi:TBD&gt;
</p>
<p>McMurdie, Paul J., and Susan Holmes. &quot;phyloseq: an R package for reproducible interactive analysis and graphics of microbiome census data.&quot; PloS one 8.4 (2013): e61217.
</p>
<p>McMurdie, Paul J., and Susan Holmes. &quot;Phyloseq: a bioconductor package for handling and analysis of high-throughput phylogenetic sequence data.&quot; Biocomputing 2012. 2012. 235-246.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Test with enterotype dataset
library(phyloseq)
library(ape)
library(phytools)
data(enterotype)

set.seed(1)

#Generate an example tree and label it with the names of the microbial taxa
enterotype_tree&lt;-rtree(length(taxa_names(enterotype)))
enterotype_tree$tip.label&lt;-taxa_names(enterotype)

#Create a phyloseq object with a tree
example_phyloseq&lt;-phyloseq(otu_table(enterotype),phy_tree(as.phylo(enterotype_tree)))

coreTree(example_phyloseq,0.5)

</code></pre>

<hr>
<h2 id='coreUniFrac'>
UniFrac Distance Between Core Microbiomes from Two Habitats
</h2><span id='topic+coreUniFrac'></span>

<h3>Description</h3>

<p>Calculates the UniFrac distance between the core microbiomes from two different types of habitats based on either the tip-based or the branch-based core community phylogeny.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coreUniFrac(x, grouping, core_fraction, mode='branch', rooted=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coreUniFrac_+3A_x">x</code></td>
<td>

<p>(Required) Microbial community data. This must be in the form of a phyloseq object and must contain, at a minimum, an OTU abundance table and a phylogeny.
</p>
</td></tr>
<tr><td><code id="coreUniFrac_+3A_grouping">grouping</code></td>
<td>

<p>(Required) A vector specifying which samples belong to which habitat type.
</p>
</td></tr>
<tr><td><code id="coreUniFrac_+3A_core_fraction">core_fraction</code></td>
<td>

<p>(Required) The fraction of samples that a microbial taxon must be found in to be considered part of the 'core' microbiome.
</p>
</td></tr>
<tr><td><code id="coreUniFrac_+3A_mode">mode</code></td>
<td>

<p>Whether to build a tip-based ('tip') or a branch-based ('branch') phylogeny. The default is 'branch'.
</p>
</td></tr>
<tr><td><code id="coreUniFrac_+3A_rooted">rooted</code></td>
<td>

<p>Whether to include the root of the phylogeny. The default is TRUE, meaning that the root is necessarily included in all phylogenies. This requires that the input tree be rooted.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>coreUniFrac</code> calculates the UniFrac distance (Lozupone and Knight, 2005) between the core microbiomes from two different types of habitats based on either their tip-based or their branch-based core community phylogenies. In both cases, the UniFrac distance is calculated as the sum of the unique branch lengths in the core community phylogenies from each of the two habitats, divided by the total branch length of all branches in the core community phylogenies from the two habitats combined. For more details, see Bewick and Camper (2025).
</p>


<h3>Value</h3>

<p>This function returns the numeric value of the UniFrac distance between two core microbiomes.
</p>


<h3>References</h3>

<p>Bewick, S.A. and Benjamin T. Camper. &quot;Phylogenetic Measures of the Core Microbiome&quot; &lt;doi:TBD&gt;
</p>
<p>Lozupone, Catherine, and Rob Knight. &quot;UniFrac: a new phylogenetic method for comparing microbial communities.&quot; Applied and environmental microbiology 71.12 (2005): 8228-8235.
</p>
<p>McMurdie, Paul J., and Susan Holmes. &quot;phyloseq: an R package for reproducible interactive analysis and graphics of microbiome census data.&quot; PloS one 8.4 (2013): e61217.
</p>
<p>McMurdie, Paul J., and Susan Holmes. &quot;Phyloseq: a bioconductor package for handling and analysis of high-throughput phylogenetic sequence data.&quot; Biocomputing 2012. 2012. 235-246.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Test with enterotype dataset
library(phyloseq)
library(ape)
library(phytools)
data(enterotype)

set.seed(1)

#Generate an example tree and label it with the names of the microbial taxa
enterotype_tree&lt;-rtree(length(taxa_names(enterotype)))
enterotype_tree$tip.label&lt;-taxa_names(enterotype)

#keep only those samples with gender identified
gendered&lt;-which(!(is.na(sample_data(enterotype)$Gender)))
enterotypeMF&lt;-prune_samples(sample_names(enterotype)[gendered],enterotype)

#Create a phyloseq object with a tree
example_phyloseq&lt;-phyloseq(otu_table(enterotypeMF),phy_tree(as.phylo(enterotype_tree)))

coreUniFrac(example_phyloseq,grouping=sample_data(enterotypeMF)$Gender,0.5)

</code></pre>

<hr>
<h2 id='coreVennTree'>
Phylogeny with Branches Colored Based on Venn Diagram
</h2><span id='topic+coreVennTree'></span>

<h3>Description</h3>

<p>Plots a phylogeny with branches colored based on the compartment that they are associated with in the Venn diagram generated by the <code>corePhyloVenn</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coreVennTree(x, grouping, core_fraction,
mode = 'branch',rooted=TRUE, ordered_groups=NULL,branch_color=NULL,
remove_zeros=TRUE,plot.chronogram=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coreVennTree_+3A_x">x</code></td>
<td>

<p>(Required) Microbial community data. This must be in the form of a phyloseq object and must contain, at a minimum, an OTU abundance table and a phylogeny.
</p>
</td></tr>
<tr><td><code id="coreVennTree_+3A_grouping">grouping</code></td>
<td>

<p>(Required) A vector specifying which samples belong to which habitat type.
</p>
</td></tr>
<tr><td><code id="coreVennTree_+3A_core_fraction">core_fraction</code></td>
<td>

<p>(Required) The fraction of samples that a microbial taxon must be found in to be considered part of the 'core' microbiome.
</p>
</td></tr>
<tr><td><code id="coreVennTree_+3A_mode">mode</code></td>
<td>

<p>Whether to build a tip-based ('tip') or a branch-based ('branch') phylogeny. The default is 'branch'.
</p>
</td></tr>
<tr><td><code id="coreVennTree_+3A_rooted">rooted</code></td>
<td>

<p>Whether to include the root of the phylogeny. The default is TRUE, meaning that the root is necessarily included in all phylogenies. This requires that the input tree be rooted.
</p>
</td></tr>
<tr><td><code id="coreVennTree_+3A_ordered_groups">ordered_groups</code></td>
<td>

<p>When provided, specifies the order in which different habitats should be plotted. This order is matched to the color order specified in <code>fill_color</code> (see below).
</p>
</td></tr>
<tr><td><code id="coreVennTree_+3A_branch_color">branch_color</code></td>
<td>

<p>A vector specifying what colors to use for branches associated with each of the different habitat combinations in the Venn diagram. This vector must be as long as the number of possible habitat combinations (number of compartments in the Venn diagram plus one for branches not included in the core of any habitats). When no colors are specified or a vector of the wrong length is specified, the default is to use a range of colors from blue to red.
</p>
</td></tr>
<tr><td><code id="coreVennTree_+3A_remove_zeros">remove_zeros</code></td>
<td>

<p>Whether or not to remove taxa that are missing from all samples prior to drawing the phylogeny. The default is TRUE.
</p>
</td></tr>
<tr><td><code id="coreVennTree_+3A_plot.chronogram">plot.chronogram</code></td>
<td>

<p>Whether to plot a phylogeny or a chronogram. The default is FALSE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>coreVennTree</code> generates a phylogeny with branches colored according to the compartments of an associated Venn diagram as generated using the <code>coreVenn</code> function. For more details, see Bewick and Camper (2025).
</p>


<h3>Value</h3>

<p>This function returns a color coded plot of the phylogeny. When a vector of colors is specified, the color key is printed out in the console.
</p>


<h3>References</h3>

<p>Bewick, S.A. and Benjamin T. Camper. &quot;Phylogenetic Measures of the Core Microbiome&quot; &lt;doi:TBD&gt;
</p>
<p>McMurdie, Paul J., and Susan Holmes. &quot;phyloseq: an R package for reproducible interactive analysis and graphics of microbiome census data.&quot; PloS one 8.4 (2013): e61217.
</p>
<p>McMurdie, Paul J., and Susan Holmes. &quot;Phyloseq: a bioconductor package for handling and analysis of high-throughput phylogenetic sequence data.&quot; Biocomputing 2012. 2012. 235-246.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Test with enterotype dataset
library(phyloseq)
library(ape)
library(phytools)
library(ggplot2)
data(enterotype)

set.seed(1)

#Generate an example tree and label it with the names of the microbial taxa
enterotype_tree&lt;-rtree(length(taxa_names(enterotype)))
enterotype_tree$tip.label&lt;-taxa_names(enterotype)

#keep only those samples with gender identified
gendered&lt;-which(!(is.na(sample_data(enterotype)$Gender)))
enterotypeMF&lt;-prune_samples(sample_names(enterotype)[gendered],enterotype)

#Create a phyloseq object with a tree
example_phyloseq&lt;-phyloseq(otu_table(enterotypeMF),phy_tree(as.phylo(enterotype_tree)))

#Define the groups
bygender&lt;-sample_data(enterotypeMF)$Gender

#Define the colors for group combinations
clist&lt;-c('black','red','orange','yellow')

#Plot the tree
coreVennTree(example_phyloseq,grouping=bygender,0.5,branch_color=clist)

</code></pre>

<hr>
<h2 id='ggvenn2'>A modified version of functions from the ggvenn package for plotting phylogenetic venn diagrams.</h2><span id='topic+ggvenn2'></span>

<h3>Description</h3>

<p>A modified version of functions from the ggvenn package for plotting phylogenetic venn diagrams.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggvenn2(
  data,
  columns = NULL,
  show_elements = FALSE,
  show_percentage = TRUE,
  digits = 1,
  fill_color = c("blue", "yellow", "green", "red"),
  fill_alpha = 0.5,
  stroke_color = "black",
  stroke_alpha = 1,
  stroke_size = 1,
  stroke_linetype = "solid",
  set_name_color = "black",
  set_name_size = 6,
  text_color = "black",
  text_size = 4,
  label_sep = ",",
  count_column = NULL,
  show_outside = c("auto", "none", "always"),
  auto_scale = FALSE,
  comma_sep = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggvenn2_+3A_data">data</code></td>
<td>
<p>A data.frame or a list as input data.</p>
</td></tr>
<tr><td><code id="ggvenn2_+3A_columns">columns</code></td>
<td>
<p>A character vector use as index to select columns/elements.</p>
</td></tr>
<tr><td><code id="ggvenn2_+3A_show_elements">show_elements</code></td>
<td>
<p>Show set elements instead of count/percentage.</p>
</td></tr>
<tr><td><code id="ggvenn2_+3A_show_percentage">show_percentage</code></td>
<td>
<p>Show percentage for each set.</p>
</td></tr>
<tr><td><code id="ggvenn2_+3A_digits">digits</code></td>
<td>
<p>The desired number of digits after the decimal point</p>
</td></tr>
<tr><td><code id="ggvenn2_+3A_fill_color">fill_color</code></td>
<td>
<p>Filling colors in circles.</p>
</td></tr>
<tr><td><code id="ggvenn2_+3A_fill_alpha">fill_alpha</code></td>
<td>
<p>Transparency for filling circles.</p>
</td></tr>
<tr><td><code id="ggvenn2_+3A_stroke_color">stroke_color</code></td>
<td>
<p>Stroke color for drawing circles.</p>
</td></tr>
<tr><td><code id="ggvenn2_+3A_stroke_alpha">stroke_alpha</code></td>
<td>
<p>Transparency for drawing circles.</p>
</td></tr>
<tr><td><code id="ggvenn2_+3A_stroke_size">stroke_size</code></td>
<td>
<p>Stroke size for drawing circles.</p>
</td></tr>
<tr><td><code id="ggvenn2_+3A_stroke_linetype">stroke_linetype</code></td>
<td>
<p>Line type for drawing circles.</p>
</td></tr>
<tr><td><code id="ggvenn2_+3A_set_name_color">set_name_color</code></td>
<td>
<p>Text color for set names.</p>
</td></tr>
<tr><td><code id="ggvenn2_+3A_set_name_size">set_name_size</code></td>
<td>
<p>Text size for set names.</p>
</td></tr>
<tr><td><code id="ggvenn2_+3A_text_color">text_color</code></td>
<td>
<p>Text color for intersect contents.</p>
</td></tr>
<tr><td><code id="ggvenn2_+3A_text_size">text_size</code></td>
<td>
<p>Text size for intersect contents.</p>
</td></tr>
<tr><td><code id="ggvenn2_+3A_label_sep">label_sep</code></td>
<td>
<p>Separator character for displaying elements.</p>
</td></tr>
<tr><td><code id="ggvenn2_+3A_count_column">count_column</code></td>
<td>
<p>Specify column for element repeat count.</p>
</td></tr>
<tr><td><code id="ggvenn2_+3A_show_outside">show_outside</code></td>
<td>
<p>Show outside elements (not belongs to any set).</p>
</td></tr>
<tr><td><code id="ggvenn2_+3A_auto_scale">auto_scale</code></td>
<td>
<p>Allow automatically resizing circles according to element counts.</p>
</td></tr>
<tr><td><code id="ggvenn2_+3A_comma_sep">comma_sep</code></td>
<td>
<p>Whether to use comma as separator for displaying numbers.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The ggplot object to print or save to file.
</p>


<h3>References</h3>

<p>Yan, Linlin, and Maintainer Linlin Yan. &quot;Package “ggvenn.”.&quot; (2021).
</p>


<h3>See Also</h3>

<p>geom_venn, ggvenn
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# use list as input
a &lt;- list(`Set 1` = c(1, 3, 5, 7),
          `Set 2` = c(1, 5, 9),
          `Set 3` = c(1, 2, 8),
          `Set 4` = c(6, 7))
ggvenn2(a, c("Set 1", "Set 2"))
ggvenn2(a, c("Set 1", "Set 2", "Set 3"))
ggvenn2(a)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
