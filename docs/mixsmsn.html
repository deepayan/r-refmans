<!DOCTYPE html><html><head><title>Help for package mixsmsn</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mixsmsn}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bmi'><p> Body Mass Index</p></a></li>
<li><a href='#faithful'><p> Old Faithful Geyser Data</p></a></li>
<li><a href='#im.smsn'><p> Information matrix</p></a></li>
<li><a href='#imm.smsn'><p> Information matrix</p></a></li>
<li><a href='#mix.contour'><p> Print the selected groups with contours</p></a></li>
<li><a href='#mix.dens'><p> Estimated densities</p></a></li>
<li><a href='#mix.hist'><p> Estimated densities</p></a></li>
<li><a href='#mix.lines'><p> Plot lines of smsn densities</p></a></li>
<li><a href='#mix.print'><p>Printing mix object</p></a></li>
<li><a href='#rmix'><p> Random univariate FM-SMSN generator</p></a></li>
<li><a href='#rmmix'><p> Random multivariate FM-SMSN generator</p></a></li>
<li><a href='#smsn.mix'><p> Fit univariate FM-SMSN distribution</p></a></li>
<li><a href='#smsn.mmix'><p> Fit multivariate FM-SMSN distributions.</p></a></li>
<li><a href='#smsn.search'><p> Find the best number of cluster for a determined data set.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Fitting Finite Mixture of Scale Mixture of Skew-Normal
Distributions</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-10-06</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1-10</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to fit finite mixture of scale mixture of skew-normal (FM-SMSN) distributions, details in Prates, Lachos and Cabral (2013) &lt;<a href="https://doi.org/10.18637%2Fjss.v054.i12">doi:10.18637/jss.v054.i12</a>&gt;, Cabral, Lachos and Prates (2012) &lt;<a href="https://doi.org/10.1016%2Fj.csda.2011.06.026">doi:10.1016/j.csda.2011.06.026</a>&gt; and Basso, Lachos, Cabral and Ghosh (2010) &lt;<a href="https://doi.org/10.1016%2Fj.csda.2009.09.031">doi:10.1016/j.csda.2009.09.031</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 1.9.0), mvtnorm (&ge; 0.9-9)</td>
</tr>
<tr>
<td>Author:</td>
<td>Marcos Prates [aut, cre, trl],
  Victor Lachos [aut],
  Celso Cabral [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marcos Prates &lt;marcosop@est.ufmg.br&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2.0)]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-10-06 12:26:40 UTC; marcos</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-10-06 12:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bmi'> Body Mass Index </h2><span id='topic+bmi'></span>

<h3>Description</h3>

<p>The data set has the measure of the Body Mass Index (bmi) for 2107 people.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bmi)</code></pre>


<h3>Format</h3>

<p>A data frame with 2107 observations of bmi
</p>


<h3>Source</h3>

<p>Rodrigo M. Basso, Victor H. Lachos, Celso R. B. Cabral, Pulak Ghosh (2009). &quot;Robust mixture modeling based on scale mixtures of skew-normal
distributions&quot;. <em>Computational Statistics and Data Analysis</em> (in press). doi: 10.1016/j.csda.2009.09.031
</p>


<h3>References</h3>

<p>Marcos Oliveira Prates, Celso Romulo Barbosa Cabral, Victor Hugo Lachos (2013).&quot;mixsmsn: Fitting Finite Mixture of Scale Mixture of Skew-Normal Distributions&quot;. Journal of Statistical Software, 54(12), 1-20., URL https://doi.org/10.18637/jss.v054.i12.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(bmi)
y &lt;-bmi$bmi

hist(y,breaks=40)

## Maximum likelihood estimaton (MLE) with generated values
bmi.analysis &lt;- smsn.mix(y, nu = 3, g = 2, get.init = TRUE, criteria = TRUE, 
                         group = TRUE, calc.im=TRUE)
mix.hist(y,bmi.analysis)

## Passing initial values to MLE
mu1 &lt;- 20; mu2 &lt;- 35
sigma2.1 &lt;- 9; sigma2.2 &lt;- 9;
lambda1 &lt;- 0; lambda2 &lt;- 0;
pii&lt;- c(0.5,0.5)

mu &lt;- c(mu1,mu2)
sigma2 &lt;- c(sigma2.1,sigma2.2)
shape &lt;- c(lambda1,lambda2)

bmi.analysis &lt;- smsn.mix(y, nu = 3, mu, sigma2 , shape, pii, get.init = FALSE,
                         criteria = TRUE, group = TRUE, calc.im=FALSE)
mix.hist(y,bmi.analysis)

## Calculate the information matrix (when the calc.im option in smsn.mix is set FALSE)
bmi.im &lt;-  im.smsn(y, bmi.analysis)

## Search for the best number of clusters from g=1 to g=5
bmi.analysis &lt;- smsn.search(y, nu = 3, g.min = 1, g.max=5)
mix.hist(y,bmi.analysis$best.model)

## End(Not run)
</code></pre>

<hr>
<h2 id='faithful'> Old Faithful Geyser Data </h2><span id='topic+faithful'></span>

<h3>Description</h3>

<p>Waiting time between eruptions and the duration of the eruption for the Old Faithful geyser in Yellowstone National Park, Wyoming, USA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(faithful)</code></pre>


<h3>Format</h3>

<p>A data frame with 272 observations on 2 variables (p=2)
</p>


<h3>Source</h3>

<p>H?rdle, W. (1991) &quot;Smoothing Techniques with Implementation in S&quot;. <em>New York: Springer</em>. 
</p>
<p>Azzalini, A. and Bowman, A. W. (1990). &quot;A look at some data on the Old Faithful geyser&quot;. <em>Applied Statistics</em> 39, 357&ndash;365. 
</p>


<h3>References</h3>

<p>Marcos Oliveira Prates, Celso Romulo Barbosa Cabral, Victor Hugo Lachos (2013).&quot;mixsmsn: Fitting Finite Mixture of Scale Mixture of Skew-Normal Distributions&quot;. Journal of Statistical Software, 54(12), 1-20., URL https://doi.org/10.18637/jss.v054.i12.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(faithful)

## Maximum likelihood estimaton (MLE) for the multivariate FM-SMSN distribution
## with generated values
## Normal
Norm.analysis &lt;- smsn.mmix(faithful, nu=3, g=2, get.init = TRUE, criteria = TRUE, 
                           group = TRUE, family = "Normal")
mix.contour(faithful,Norm.analysis,x.min=1,x.max=1,y.min=15,y.max=10,
            levels = c(0.1, 0.015, 0.005, 0.0009, 0.00015))

## Calculate the information matrix (when the calc.im option in smsn.mmix is set FALSE)
Norm.im &lt;-  imm.smsn(faithful, Norm.analysis)

## Skew-Normal
Snorm.analysis &lt;- smsn.mmix(faithful, nu=3, g=2, get.init = TRUE, criteria = TRUE, 
                           group = TRUE, family = "Skew.normal")
mix.contour(faithful,Snorm.analysis,x.min=1,x.max=1,y.min=15,y.max=10,
            levels = c(0.1, 0.015, 0.005, 0.0009, 0.00015))

## Calculate the information matrix (when the calc.im option in smsn.mmix is set FALSE)
Snorm.im &lt;-  imm.smsn(faithful, Snorm.analysis)

## Skew-t
St.analysis &lt;- smsn.mmix(faithful, nu=3, g=2, get.init = TRUE, criteria = TRUE, 
                           group = TRUE, family = "Skew.t")
mix.contour(faithful,St.analysis,x.min=1,x.max=1,y.min=15,y.max=10,
            levels = c(0.1, 0.015, 0.005, 0.0009, 0.00015))

## Calculate the information matrix (when the calc.im option in smsn.mmix is set FALSE)
St.im &lt;-  imm.smsn(faithful, St.analysis)

## Passing initial values to MLE and automaticaly calculate the information matrix
mu1 &lt;- c(5,77)
Sigma1 &lt;- matrix(c(0.18,0.60,0.60,41), 2,2)
shape1 &lt;- c(0.69,0.64)

mu2 &lt;- c(2,52)
Sigma2 &lt;- matrix(c(0.15,1.15,1.15,40), 2,2)
shape2 &lt;- c(4.3,2.7)

pii&lt;-c(0.65,0.35)

mu &lt;- list(mu1,mu2)
Sigma &lt;- list(Sigma1,Sigma2)
shape &lt;- list(shape1,shape2)

Snorm.analysis &lt;- smsn.mmix(faithful, nu=3, mu=mu, Sigma=Sigma, shape=shape, pii=pii,
                            g=2, get.init = FALSE, group = TRUE,
                            family = "Skew.normal", calc.im=TRUE)
                            
mix.contour(faithful,Snorm.analysis,x.min=1,x.max=1,y.min=15,y.max=10,
            levels = c(0.1, 0.015, 0.005, 0.0009, 0.00015))

## Search for the best number of clusters from g=1 to g=3
faithful.analysis &lt;- smsn.search(faithful, nu = 3, g.min = 1, g.max=3)
mix.contour(faithful,faithful.analysis$best.model,x.min=1,x.max=1,
            y.min=15,y.max=10,levels = c(0.1, 0.015, 0.005, 0.0009,
            0.00015)) 

## End(Not run)
</code></pre>

<hr>
<h2 id='im.smsn'> Information matrix </h2><span id='topic+im.smsn'></span>

<h3>Description</h3>

<p>Calculate the information matrix of returned analysis based on the 
model <code>family</code> choice (univariate case, p=1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>im.smsn(y, model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="im.smsn_+3A_y">y</code></td>
<td>
<p> the response vector </p>
</td></tr>
<tr><td><code id="im.smsn_+3A_model">model</code></td>
<td>
<p> a variable returned by <code><a href="#topic+smsn.mix">smsn.mix</a></code> </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimate the Information Matrix of the parameters.
</p>


<h3>Author(s)</h3>

<p>Marcos Prates <a href="mailto:marcosop@est.ufmg.br">marcosop@est.ufmg.br</a>, Victor Lachos <a href="mailto:hlachos@ime.unicamp.br">hlachos@ime.unicamp.br</a> and Celso Cabral <a href="mailto:celsoromulo@gmail.com">celsoromulo@gmail.com</a></p>


<h3>See Also</h3>

 <p><code><a href="#topic+smsn.mix">smsn.mix</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'> ## see \code{\link{bmi}}
</code></pre>

<hr>
<h2 id='imm.smsn'> Information matrix </h2><span id='topic+imm.smsn'></span>

<h3>Description</h3>

<p>Calculate the information matrix of returned analysis based on the 
model <code>family</code> choice (multivariate case, p&gt;=2).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>imm.smsn(y, model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="imm.smsn_+3A_y">y</code></td>
<td>
<p> the response vector (p&gt;2)</p>
</td></tr>
<tr><td><code id="imm.smsn_+3A_model">model</code></td>
<td>
<p> a variable returned by <code><a href="#topic+smsn.mmix">smsn.mmix</a></code> </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimate the Information Matrix of the parameters.
Note: In the Information Matrix the scale parameters 
estimates are relative to the entries of square 
root matrix of Sigma.
</p>


<h3>Author(s)</h3>

<p>Marcos Prates <a href="mailto:marcosop@est.ufmg.br">marcosop@est.ufmg.br</a>, Victor Lachos <a href="mailto:hlachos@ime.unicamp.br">hlachos@ime.unicamp.br</a> and Celso Cabral <a href="mailto:celsoromulo@gmail.com">celsoromulo@gmail.com</a></p>


<h3>See Also</h3>

 <p><code><a href="#topic+smsn.mmix">smsn.mmix</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'> ## see \code{\link{faithful}}
</code></pre>

<hr>
<h2 id='mix.contour'> Print the selected groups with contours </h2><span id='topic+mix.contour'></span>

<h3>Description</h3>

<p>Plot the contour of the observations with the group selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mix.contour(y, model,
            slice=100, ncontour=10,
            x.min=1, x.max=1,
            y.min=1,y.max=1,
            ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mix.contour_+3A_y">y</code></td>
<td>
<p> the response matrix (dimension nx2) </p>
</td></tr>
<tr><td><code id="mix.contour_+3A_model">model</code></td>
<td>
<p> a variable returned by <code><a href="#topic+smsn.mmix">smsn.mmix</a></code> </p>
</td></tr>
<tr><td><code id="mix.contour_+3A_slice">slice</code></td>
<td>
<p> number of slices in the sequenceo the contour </p>
</td></tr>
<tr><td><code id="mix.contour_+3A_ncontour">ncontour</code></td>
<td>
<p>number of contours to be ploted </p>
</td></tr>
<tr><td><code id="mix.contour_+3A_x.min">x.min</code></td>
<td>
<p> value to be subtracted of the smallest observation in the x-axis </p>
</td></tr>
<tr><td><code id="mix.contour_+3A_x.max">x.max</code></td>
<td>
<p> value to be added of the biggest observation in the x-axis </p>
</td></tr>
<tr><td><code id="mix.contour_+3A_y.min">y.min</code></td>
<td>
<p> value to be subtracted of the smallest observation in the y-axis </p>
</td></tr>
<tr><td><code id="mix.contour_+3A_y.max">y.max</code></td>
<td>
<p> value to be added of the biggest observation in the y-axis </p>
</td></tr>
<tr><td><code id="mix.contour_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="graphics.html#topic+contour">contour</a></code></p>
</td></tr>
</table>


<h3>See Also</h3>

 <p><code><a href="#topic+smsn.mmix">smsn.mmix</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'> ## see \code{\link{smsn.mmix}}
</code></pre>

<hr>
<h2 id='mix.dens'> Estimated densities </h2><span id='topic+mix.dens'></span>

<h3>Description</h3>

<p>Plot the estimated density or log-density (univariate case, p=1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mix.dens(y, model, log=FALSE, ylab=NULL, xlab = NULL, main = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mix.dens_+3A_y">y</code></td>
<td>
<p> the response vector </p>
</td></tr>
<tr><td><code id="mix.dens_+3A_model">model</code></td>
<td>
<p> a variable returned by <code><a href="#topic+smsn.mix">smsn.mix</a></code> </p>
</td></tr>
<tr><td><code id="mix.dens_+3A_log">log</code></td>
<td>
<p> Logical, plot log-density if TRUE (default = FALSE) </p>
</td></tr>
<tr><td><code id="mix.dens_+3A_ylab">ylab</code></td>
<td>
<p> Title of the ylab, if NULL default is selected </p>
</td></tr>
<tr><td><code id="mix.dens_+3A_xlab">xlab</code></td>
<td>
<p> Title of the xlab, if NULL default is selected </p>
</td></tr>
<tr><td><code id="mix.dens_+3A_main">main</code></td>
<td>
<p> Main Title, if NULL default is selected </p>
</td></tr>
<tr><td><code id="mix.dens_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="base.html#topic+plot">plot</a></code></p>
</td></tr>
</table>


<h3>See Also</h3>

 <p><code><a href="#topic+smsn.mix">smsn.mix</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'> ## see \code{\link{bmi}} and \code{\link{smsn.mix}}
</code></pre>

<hr>
<h2 id='mix.hist'> Estimated densities </h2><span id='topic+mix.hist'></span>

<h3>Description</h3>

<p>Plot the histogram along with the estimated density (univariate case, p=1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mix.hist(y, model, breaks, main, col.hist, col.dens, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mix.hist_+3A_y">y</code></td>
<td>
<p> the response vector </p>
</td></tr>
<tr><td><code id="mix.hist_+3A_model">model</code></td>
<td>
<p> a variable returned by <code><a href="#topic+smsn.mix">smsn.mix</a></code> </p>
</td></tr>
<tr><td><code id="mix.hist_+3A_breaks">breaks</code></td>
<td>
<p> the same option in <cite><a href="lattice.html#topic+histogram">histogram</a></cite> </p>
</td></tr>
<tr><td><code id="mix.hist_+3A_main">main</code></td>
<td>
<p> the same option in <cite><a href="lattice.html#topic+histogram">histogram</a></cite> </p>
</td></tr>
<tr><td><code id="mix.hist_+3A_col.hist">col.hist</code></td>
<td>
<p> change the color of the histogram bars </p>
</td></tr>
<tr><td><code id="mix.hist_+3A_col.dens">col.dens</code></td>
<td>
<p> change the color of the density curve </p>
</td></tr>
<tr><td><code id="mix.hist_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="graphics.html#topic+hist">hist</a></code></p>
</td></tr>
</table>


<h3>See Also</h3>

 <p><code><a href="#topic+smsn.mix">smsn.mix</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'> ## see \code{\link{bmi}} and \code{\link{smsn.mix}}
</code></pre>

<hr>
<h2 id='mix.lines'> Plot lines of smsn densities </h2><span id='topic+mix.lines'></span>

<h3>Description</h3>

<p>Add lines of smsn estimated denisty or log-density in mix.dens plots (univariate case, p=1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mix.lines(y, model, log=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mix.lines_+3A_y">y</code></td>
<td>
<p> the response vector </p>
</td></tr>
<tr><td><code id="mix.lines_+3A_model">model</code></td>
<td>
<p> a variable returned by <code><a href="#topic+smsn.mix">smsn.mix</a></code> </p>
</td></tr>
<tr><td><code id="mix.lines_+3A_log">log</code></td>
<td>
<p> Logical, plot log-density if TRUE (default = FALSE) </p>
</td></tr>
<tr><td><code id="mix.lines_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="graphics.html#topic+lines">lines</a></code></p>
</td></tr>
</table>


<h3>See Also</h3>

 <p><code><a href="#topic+smsn.mix">smsn.mix</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'> ## see \code{\link{bmi}} and \code{\link{smsn.mix}}
</code></pre>

<hr>
<h2 id='mix.print'>Printing mix object</h2><span id='topic+mix.print'></span>

<h3>Description</h3>

<p>Printing a <code>smsn.mix</code> object (univariate case, p=1)</p>


<h3>Usage</h3>

<pre><code class='language-R'>mix.print(model, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mix.print_+3A_model">model</code></td>
<td>
<p>an object of class <code>snsm.mix</code>, see <code><a href="#topic+smsn.mix">smsn.mix</a></code> for details</p>
</td></tr>
<tr><td><code id="mix.print_+3A_digits">digits</code></td>
<td>
<p>rounding for tabular output on the console
(default is to round to 3 decimal place)</p>
</td></tr>
<tr><td><code id="mix.print_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="base.html#topic+print">print</a></code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+smsn.mix">smsn.mix</a></code></p>

<hr>
<h2 id='rmix'> Random univariate FM-SMSN generator </h2><span id='topic+rmix'></span>

<h3>Description</h3>

<p>Random generator of univariate FM-SMSN distributions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmix(n, pii, family, arg, cluster=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmix_+3A_n">n</code></td>
<td>
<p> number of observations  </p>
</td></tr>
<tr><td><code id="rmix_+3A_pii">pii</code></td>
<td>
<p> a vector of weights for the mixture (dimension of the number <code>g</code> of clusters). Must sum to one!</p>
</td></tr>
<tr><td><code id="rmix_+3A_family">family</code></td>
<td>
<p> distribution family to be used in fitting (&quot;t&quot;, &quot;Skew.t&quot;, &quot;Skew.cn&quot;, &quot;Skew.slash&quot;, &quot;Skew.normal&quot;, &quot;Normal&quot;) </p>
</td></tr>
<tr><td><code id="rmix_+3A_arg">arg</code></td>
<td>
<p> a list with each entry containing a vector of size equal to the number of clusters of the necessary parameters from a <code>family</code> </p>
</td></tr>
<tr><td><code id="rmix_+3A_cluster">cluster</code></td>
<td>
<p>TRUE or FALSE if the true observations clusters must be returned. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marcos Prates <a href="mailto:marcosop@est.ufmg.br">marcosop@est.ufmg.br</a>, Victor Lachos <a href="mailto:hlachos@ime.unicamp.br">hlachos@ime.unicamp.br</a> and Celso Cabral <a href="mailto:celsoromulo@gmail.com">celsoromulo@gmail.com</a></p>


<h3>See Also</h3>

 <p><code><a href="#topic+smsn.mix">smsn.mix</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'> ## see \code{\link{smsn.mix}}
</code></pre>

<hr>
<h2 id='rmmix'> Random multivariate FM-SMSN generator </h2><span id='topic+rmmix'></span>

<h3>Description</h3>

<p>Random generator of multivariate FM-SMSN distributions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmmix(n, pii, family, arg, cluster=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmmix_+3A_n">n</code></td>
<td>
<p> number of observations  </p>
</td></tr>
<tr><td><code id="rmmix_+3A_pii">pii</code></td>
<td>
<p> a vector of weights for the mixture (dimension of the number <code>g</code> of clusters). Must sum to one!</p>
</td></tr>
<tr><td><code id="rmmix_+3A_family">family</code></td>
<td>
<p> distribution family to be used in fitting (&quot;t&quot;, &quot;Skew.t&quot;, &quot;Skew.cn&quot;, &quot;Skew.slash&quot;, &quot;Skew.normal&quot;, &quot;Normal&quot;) </p>
</td></tr>
<tr><td><code id="rmmix_+3A_arg">arg</code></td>
<td>
<p> a list of <code>g</code> lists with each list containing the necessary parameters of the selected <code>family</code> </p>
</td></tr>
<tr><td><code id="rmmix_+3A_cluster">cluster</code></td>
<td>
<p>TRUE or FALSE if the true observations clusters must be returned. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marcos Prates <a href="mailto:marcosop@est.ufmg.br">marcosop@est.ufmg.br</a>, Victor Lachos <a href="mailto:hlachos@ime.unicamp.br">hlachos@ime.unicamp.br</a> and Celso Cabral <a href="mailto:celsoromulo@gmail.com">celsoromulo@gmail.com</a></p>


<h3>See Also</h3>

 <p><code><a href="#topic+smsn.mmix">smsn.mmix</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'> ## see \code{\link{smsn.mmix}}
</code></pre>

<hr>
<h2 id='smsn.mix'> Fit univariate FM-SMSN distribution </h2><span id='topic+smsn.mix'></span>

<h3>Description</h3>

<p>Return EM algorithm output for FM-SMSN distributions (univaritate case, p=1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smsn.mix(y, 
         nu, mu = NULL, sigma2 = NULL, shape = NULL, pii = NULL,
         g = NULL, get.init = TRUE,
         criteria = TRUE, group = FALSE, family = "Skew.normal",
         error = 0.00001, iter.max = 100, calc.im = TRUE, obs.prob = FALSE,
         kmeans.param = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smsn.mix_+3A_y">y</code></td>
<td>
<p> the response vector </p>
</td></tr>
<tr><td><code id="smsn.mix_+3A_nu">nu</code></td>
<td>
<p> the parameter of the scale variable (vector or scalar) of the SMSN family (kurtosis parameter). It is necessary to all distributions. For the &quot;Skew.cn&quot; must be a vector of length 2 and values in (0,1) </p>
</td></tr>
<tr><td><code id="smsn.mix_+3A_mu">mu</code></td>
<td>
<p> the vector of initial values (dimension g) for the location parameters </p>
</td></tr>
<tr><td><code id="smsn.mix_+3A_sigma2">sigma2</code></td>
<td>
<p> the vector of initial values (dimension g) for the scale parameters </p>
</td></tr>
<tr><td><code id="smsn.mix_+3A_shape">shape</code></td>
<td>
<p> the vector of initial values (dimension g) for the skewness parameters </p>
</td></tr>
<tr><td><code id="smsn.mix_+3A_pii">pii</code></td>
<td>
<p> the vector of initial values (dimension g) for the weights for each cluster. Must sum one! </p>
</td></tr>
<tr><td><code id="smsn.mix_+3A_g">g</code></td>
<td>
<p> the number of cluster to be considered in fitting</p>
</td></tr>
<tr><td><code id="smsn.mix_+3A_get.init">get.init</code></td>
<td>
<p> if TRUE, the initial values are generated via k-means</p>
</td></tr>
<tr><td><code id="smsn.mix_+3A_criteria">criteria</code></td>
<td>
<p> if TRUE, AIC, DIC, EDC and ICL will be calculated </p>
</td></tr>
<tr><td><code id="smsn.mix_+3A_group">group</code></td>
<td>
<p> if TRUE, the vector with the classification of the response is returned </p>
</td></tr>
<tr><td><code id="smsn.mix_+3A_family">family</code></td>
<td>
<p> distribution family to be used in fitting (&quot;Skew.t&quot;, &quot;t&quot;, &quot;Skew.cn&quot;, &quot;Skew.slash&quot;, &quot;slash&quot;, &quot;Skew.normal&quot;, &quot;Normal&quot;) </p>
</td></tr>
<tr><td><code id="smsn.mix_+3A_error">error</code></td>
<td>
<p> the covergence maximum error </p>
</td></tr>
<tr><td><code id="smsn.mix_+3A_iter.max">iter.max</code></td>
<td>
<p> the maximum number of iterations of the EM algorithm. Default = 100 </p>
</td></tr>
<tr><td><code id="smsn.mix_+3A_calc.im">calc.im</code></td>
<td>
<p> if TRUE, the information matrix is calculated and the standard errors are reported</p>
</td></tr>
<tr><td><code id="smsn.mix_+3A_obs.prob">obs.prob</code></td>
<td>
<p> if TRUE, the posterior probability of each observation belonging to one of the g groups is reported</p>
</td></tr>
<tr><td><code id="smsn.mix_+3A_kmeans.param">kmeans.param</code></td>
<td>
<p> a list with alternative parameters for the kmeans function when generating initial values, 
list(iter.max = 10, n.start = 1, algorithm = &quot;Hartigan-Wong&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimated values of the location, scale, skewness and kurtosis parameter.
</p>


<h3>Author(s)</h3>

<p>Marcos Prates <a href="mailto:marcosop@est.ufmg.br">marcosop@est.ufmg.br</a>, Victor Lachos <a href="mailto:hlachos@ime.unicamp.br">hlachos@ime.unicamp.br</a> and Celso Cabral <a href="mailto:celsoromulo@gmail.com">celsoromulo@gmail.com</a></p>


<h3>References</h3>

<p>Rodrigo M. Basso, Victor H. Lachos, Celso R. B. Cabral, Pulak Ghosh (2010). &quot;Robust mixture modeling based on scale mixtures of skew-normal
distributions&quot;. Computational Statistics and Data Analysis, 54, 2926-2941. doi: 10.1016/j.csda.2009.09.031
</p>
<p>Marcos Oliveira Prates, Celso Romulo Barbosa Cabral, Victor Hugo Lachos (2013).&quot;mixsmsn: Fitting Finite Mixture of Scale Mixture of Skew-Normal Distributions&quot;. Journal of Statistical Software, 54(12), 1-20., URL https://doi.org/10.18637/jss.v054.i12.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mix.hist">mix.hist</a></code>, <code><a href="#topic+im.smsn">im.smsn</a></code> and <code><a href="#topic+smsn.search">smsn.search</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>mu1 &lt;- 5; mu2 &lt;- 20; mu3 &lt;- 35
sigma2.1 &lt;- 9; sigma2.2 &lt;- 16; sigma2.3 &lt;- 9
lambda1 &lt;- 5; lambda2 &lt;- -3; lambda3 &lt;- -6
nu = 5

mu &lt;- c(mu1,mu2,mu3)
sigma2 &lt;- c(sigma2.1,sigma2.2,sigma2.3)
shape &lt;- c(lambda1,lambda2,lambda3)
pii &lt;- c(0.5,0.2,0.3)

arg1 = c(mu1, sigma2.1, lambda1, nu)
arg2 = c(mu2, sigma2.2, lambda2, nu)
arg3 = c(mu3, sigma2.3, lambda3, nu)
y &lt;- rmix(n=1000, p=pii, family="Skew.t", arg=list(arg1,arg2,arg3))

## Not run: 
par(mfrow=c(1,2))
## Normal fit
Norm.analysis &lt;- smsn.mix(y, nu = 3, g = 3, get.init = TRUE, criteria = TRUE, 
                          group = TRUE, family = "Normal", calc.im=FALSE)
mix.hist(y,Norm.analysis)
mix.print(Norm.analysis)
mix.dens(y,Norm.analysis)

## Skew Normal fit
Snorm.analysis &lt;- smsn.mix(y, nu = 3, g = 3, get.init = TRUE, criteria = TRUE, 
                           group = TRUE, family = "Skew.normal", calc.im=FALSE)
mix.hist(y,Snorm.analysis)
mix.print(Snorm.analysis)
mix.dens(y,Snorm.analysis)

## t fit
t.analysis &lt;- smsn.mix(y, nu = 3, g = 3, get.init = TRUE, criteria = TRUE, 
                        group = TRUE, family = "t", calc.im=FALSE)
mix.hist(y,t.analysis)
mix.print(t.analysis)
mix.dens(y,t.analysis)

## Skew t fit
St.analysis &lt;- smsn.mix(y, nu = 3, g = 3, get.init = TRUE, criteria = TRUE, 
                        group = TRUE, family = "Skew.t", calc.im=FALSE)
mix.hist(y,St.analysis)
mix.print(St.analysis)
mix.dens(y,St.analysis)

## Skew Contaminated Normal fit
Scn.analysis &lt;- smsn.mix(y, nu = c(0.3,0.3), g = 3, get.init = TRUE, criteria = TRUE, 
                         group = TRUE, family = "Skew.cn", calc.im=FALSE)
mix.hist(y,Scn.analysis)
mix.print(Scn.analysis)
mix.dens(y,Scn.analysis)

par(mfrow=c(1,1))
mix.dens(y,Norm.analysis)
mix.lines(y,Snorm.analysis,col="green")
mix.lines(y,t.analysis,col="red")
mix.lines(y,St.analysis,col="blue")
mix.lines(y,Scn.analysis,col="grey")

## End(Not run)
</code></pre>

<hr>
<h2 id='smsn.mmix'> Fit multivariate FM-SMSN distributions.</h2><span id='topic+smsn.mmix'></span>

<h3>Description</h3>

<p>Return EM algorithm output for multivariate FM-SMSN distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smsn.mmix(y, nu=1,
          mu = NULL, Sigma = NULL, shape = NULL, pii = NULL,
          g = NULL, get.init = TRUE, criteria = TRUE,
          group = FALSE, family = "Skew.normal", 
          error = 0.0001, iter.max = 100, uni.Gama = FALSE,
          calc.im=FALSE, obs.prob = FALSE, kmeans.param = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smsn.mmix_+3A_y">y</code></td>
<td>
<p> the response matrix (dimension nxp) </p>
</td></tr>
<tr><td><code id="smsn.mmix_+3A_nu">nu</code></td>
<td>
<p> the parameter of the scale variable (vector or scalar) of the SMSN family (kurtosis parameter). It is necessary to all distributions. For the &quot;Skew.cn&quot; must be a vector of length 2 and values in (0,1) </p>
</td></tr>
<tr><td><code id="smsn.mmix_+3A_mu">mu</code></td>
<td>
<p> a list of <code>g</code> arguments of vectors of initial values (dimension p) for the location parameters </p>
</td></tr>
<tr><td><code id="smsn.mmix_+3A_sigma">Sigma</code></td>
<td>
<p> a list of <code>g</code> arguments of matrices of initial values (dimension pxp) for the scale parameters </p>
</td></tr>
<tr><td><code id="smsn.mmix_+3A_shape">shape</code></td>
<td>
<p> a list of <code>g</code> arguments of vectors of initial values (dimension p)for the skewness parameters </p>
</td></tr>
<tr><td><code id="smsn.mmix_+3A_pii">pii</code></td>
<td>
<p> the vector of initial values (dimension g) for the weights for each cluster. Must sum one! </p>
</td></tr>
<tr><td><code id="smsn.mmix_+3A_g">g</code></td>
<td>
<p> the number of cluster to be considered in fitting</p>
</td></tr>
<tr><td><code id="smsn.mmix_+3A_get.init">get.init</code></td>
<td>
<p> if TRUE, the initial values are generated via k-means</p>
</td></tr>
<tr><td><code id="smsn.mmix_+3A_criteria">criteria</code></td>
<td>
<p> if TRUE, log-likelihood (logLik), AIC, DIC, EDC and ICL will be calculated </p>
</td></tr>
<tr><td><code id="smsn.mmix_+3A_group">group</code></td>
<td>
<p> if TRUE, the vector with the classification of the response is returned </p>
</td></tr>
<tr><td><code id="smsn.mmix_+3A_family">family</code></td>
<td>
<p> distribution famility to be used in fitting (&quot;Skew.t&quot;, &quot;t&quot;, &quot;Skew.cn&quot;, &quot;Skew.slash&quot;, &quot;slash&quot;, &quot;Skew.normal&quot;, &quot;Normal&quot;) </p>
</td></tr>
<tr><td><code id="smsn.mmix_+3A_error">error</code></td>
<td>
<p> the covergence maximum error </p>
</td></tr>
<tr><td><code id="smsn.mmix_+3A_iter.max">iter.max</code></td>
<td>
<p> the maximum number of iterations of the EM algorithm. Default = 100 </p>
</td></tr>
<tr><td><code id="smsn.mmix_+3A_uni.gama">uni.Gama</code></td>
<td>
<p> if TRUE, the Gamma parameters are restricted to be the same for all clusters</p>
</td></tr>
<tr><td><code id="smsn.mmix_+3A_calc.im">calc.im</code></td>
<td>
<p> if TRUE, the information matrix is calculated and the starndard erros are reported </p>
</td></tr>
<tr><td><code id="smsn.mmix_+3A_obs.prob">obs.prob</code></td>
<td>
<p> if TRUE, the posterior probability of each observation belonging to one of the g groups is reported</p>
</td></tr>  
<tr><td><code id="smsn.mmix_+3A_kmeans.param">kmeans.param</code></td>
<td>
<p> a list with alternative parameters for the kmeans function when generating initial values, 
list(iter.max = 10, n.start = 1, algorithm = &quot;Hartigan-Wong&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimated values of the location, scale, skewness and kurtosis parameter.
Note: The scale parameters estimated are relative to the entries of 
the squae root matrix of Sigma.
</p>


<h3>Author(s)</h3>

<p>Marcos Prates <a href="mailto:marcosop@est.ufmg.br">marcosop@est.ufmg.br</a>, Victor Lachos <a href="mailto:hlachos@ime.unicamp.br">hlachos@ime.unicamp.br</a> and Celso Cabral <a href="mailto:celsoromulo@gmail.com">celsoromulo@gmail.com</a></p>


<h3>References</h3>

<p>Cabral, C. R. B., Lachos, V. H. and Prates, M. O. (2012). &quot;Multivariate Mixture Modeling Using Skew-Normal Independent Distributions&quot;. <em>Computational Statistics &amp; Data Analysis</em>, 56, 126-142, doi:10.1016/j.csda.2011.06.026.
</p>
<p>Marcos Oliveira Prates, Celso Romulo Barbosa Cabral, Victor Hugo Lachos (2013).&quot;mixsmsn: Fitting Finite Mixture of Scale Mixture of Skew-Normal Distributions&quot;. Journal of Statistical Software, 54(12), 1-20., URL https://doi.org/10.18637/jss.v054.i12.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mix.contour">mix.contour</a></code>,  <code><a href="#topic+rmmix">rmmix</a></code> and <code><a href="#topic+smsn.search">smsn.search</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>mu1 &lt;- c(0,0)
Sigma1 &lt;- matrix(c(3,1,1,3), 2,2)
shape1 &lt;-c(4,4)
nu1 &lt;- 4

mu2 &lt;- c(5,5)
Sigma2 &lt;- matrix(c(2,1,1,2), 2,2)
shape2 &lt;-c(2,2)
nu2 &lt;- 4

pii&lt;-c(0.6,0.4)

arg1 = list(mu=mu1, Sigma=Sigma1, shape=shape1, nu=nu1)
arg2 = list(mu=mu2, Sigma=Sigma2, shape=shape2, nu=nu2)
y &lt;- rmmix(n= 500, p = pii, "Skew.t", list(arg1,arg2))

## Not run: 

## Normal fit giving intial values
mu &lt;- list(mu1,mu2)
Sigma &lt;- list(Sigma1,Sigma2)
shape &lt;- list(shape1,shape2)
pii &lt;- c(0.6,0.4)

Norm.analysis &lt;- smsn.mmix(y, nu=3, mu=mu, Sigma=Sigma, shape=shape, pii = pii,
                           criteria = TRUE, g=2, get.init = FALSE, group = TRUE,
                           family = "Normal")
mix.contour(y,Norm.analysis)

## Normal fit 
Norm.analysis &lt;- smsn.mmix(y, nu=3, g=2, get.init = TRUE, criteria = TRUE, 
                           group = TRUE, family = "Normal")
mix.contour(y,Norm.analysis)

## Normal fit with a unique Gamma
Norm.analysis &lt;- smsn.mmix(y, nu=3, g=2, get.init = TRUE, criteria = TRUE, 
                           group = TRUE, family = "Normal", uni.Gama = TRUE)
mix.contour(y,Norm.analysis)


## Skew Normal fit
Snorm.analysis &lt;- smsn.mmix(y, nu=3, g=2, get.init = TRUE, criteria = TRUE, 
                            group = TRUE, family = "Skew.normal")
mix.contour(y,Snorm.analysis)

## t fit
t.analysis &lt;- smsn.mmix(y, nu=3, g=2, get.init = TRUE, criteria = TRUE, 
                         group = TRUE, family = "t")
mix.contour(y,t.analysis)

## Skew t fit
St.analysis &lt;- smsn.mmix(y, nu=3, g=2, get.init = TRUE, criteria = TRUE, 
                         group = TRUE, family = "Skew.t")
mix.contour(y,St.analysis)

## Skew Contaminated Normal fit
Scn.analysis &lt;- smsn.mmix(y, nu=c(0.1,0.1), g=2, get.init = TRUE, criteria = TRUE, 
                          group = TRUE, family = "Skew.cn",error=0.01)
mix.contour(y,Scn.analysis)

## Skew Contaminated Normal fit
Sslash.analysis &lt;- smsn.mmix(y, nu=3, g=2, get.init = TRUE, criteria = TRUE, 
                             group = TRUE, family = "Skew.slash", error=0.1)
mix.contour(y,Sslash.analysis)


## End(Not run)
</code></pre>

<hr>
<h2 id='smsn.search'> Find the best number of cluster for a determined data set. </h2><span id='topic+smsn.search'></span>

<h3>Description</h3>

<p>Search for the best fitting for number of cluster from <code>g.min</code> to <code>g.max</code>
for a selected <code>family</code> and <code>criteria</code> for both univariate and multivariate
distributions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>smsn.search(y, nu,
            g.min = 1, g.max = 3,
            family = "Skew.normal", criteria = "bic",
            error = 0.0001, iter.max = 100, 
            calc.im = FALSE, uni.Gama = FALSE, kmeans.param = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smsn.search_+3A_y">y</code></td>
<td>
<p> the response vector(matrix) </p>
</td></tr>
<tr><td><code id="smsn.search_+3A_nu">nu</code></td>
<td>
<p> the parameter of the scale variable (vector or scalar) of the SMSN family (kurtosis parameter). It is necessary to all distributions. For the &quot;Skew.cn&quot; must be a vector of length 2 and values in (0,1) </p>
</td></tr>
<tr><td><code id="smsn.search_+3A_g.min">g.min</code></td>
<td>
<p> the minimum number of cluster to be modeled </p>
</td></tr>
<tr><td><code id="smsn.search_+3A_g.max">g.max</code></td>
<td>
<p> the maximum number of cluster to be modeled </p>
</td></tr>
<tr><td><code id="smsn.search_+3A_family">family</code></td>
<td>
<p> distribution famility to be used in fitting (&quot;t&quot;, &quot;Skew.t&quot;, &quot;Skew.nc&quot;, &quot;Skew.slash&quot;, &quot;Skew.normal&quot;, &quot;Normal&quot;) </p>
</td></tr>
<tr><td><code id="smsn.search_+3A_criteria">criteria</code></td>
<td>
<p> the selection criteria method to be used (&quot;aic&quot;, &quot;bic&quot;, &quot;edc&quot;, &quot;icl&quot;) </p>
</td></tr> 
<tr><td><code id="smsn.search_+3A_error">error</code></td>
<td>
<p> the covergence maximum error </p>
</td></tr>
<tr><td><code id="smsn.search_+3A_iter.max">iter.max</code></td>
<td>
<p> the maximum number of iterations of the EM algorithm </p>
</td></tr>
<tr><td><code id="smsn.search_+3A_calc.im">calc.im</code></td>
<td>
<p> if TRUE, the infomation matrix is calculated and the starndard erros are reported </p>
</td></tr>
<tr><td><code id="smsn.search_+3A_uni.gama">uni.Gama</code></td>
<td>
<p> if TRUE, the Gamma parameters are restricted to be the same for all clusters (Only valid in the multivariate case, p&gt;1) </p>
</td></tr>
<tr><td><code id="smsn.search_+3A_kmeans.param">kmeans.param</code></td>
<td>
<p> a list with alternative parameters for the kmeans function when generating initial values, 
list(iter.max = 10, n.start = 1, algorithm = &quot;Hartigan-Wong&quot;)</p>
</td></tr>
<tr><td><code id="smsn.search_+3A_...">...</code></td>
<td>
<p> other parameters for the hist function </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimated values of the location, scale, skewness and kurtosis parameter from the optimum number of clusters.
</p>


<h3>Author(s)</h3>

<p>Marcos Prates <a href="mailto:marcosop@est.ufmg.br">marcosop@est.ufmg.br</a>, Victor Lachos <a href="mailto:hlachos@ime.unicamp.br">hlachos@ime.unicamp.br</a> and Celso Cabral <a href="mailto:celsoromulo@gmail.com">celsoromulo@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+smsn.mix">smsn.mix</a></code> and <code><a href="#topic+smsn.mmix">smsn.mmix</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'> ## see \code{\link{bmi}} and \code{\link{faithful}}
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
