<!DOCTYPE html><html><head><title>Help for package longCatEDA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {longCatEDA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#longCatEDA-package'>
<p>Plot Categorical Longitudinal and Time-Series Data</p></a></li>
<li><a href='#alignTime'><p>Align time data at a given state or event</p></a></li>
<li><a href='#clean.events'>
<p>clean.events</p></a></li>
<li><a href='#colChoose'>
<p>Internal Function for Selecting Color Schemes Used by longCatPlot</p></a></li>
<li><a href='#example2cat'><p>Example data for <code>longCatPlot</code>.</p></a></li>
<li><a href='#example2cont'><p>Simulated Data for Illustrating longContPlot</p></a></li>
<li><a href='#example3'><p>Simulated Data for Illustrating longCat and longCatPlot</p></a></li>
<li><a href='#levelCheck'>
<p>Function to Check Factor Levels</p></a></li>
<li><a href='#longCat'><p>Creation of Objects of Class longCat</p></a></li>
<li><a href='#longCat-class'><p>Class <code>"longCat"</code></p></a></li>
<li><a href='#longCatPlot'>
<p>Plotting of lc objects</p></a></li>
<li><a href='#longContPlot'>
<p>Plot Continuous Longitudinal Data</p></a></li>
<li><a href='#lunique'>
<p>Find the Unique Number of Factors</p></a></li>
<li><a href='#makePatterns'>
<p>Concatenate Multivariate Data into Numeric or Character Patterns</p></a></li>
<li><a href='#norpt'>
<p>A function to take out repeated observations in a vector of data for sorting purposes.</p></a></li>
<li><a href='#sort1'>
<p>sort1</p></a></li>
<li><a href='#sorter'>
<p>General Sorting Function</p></a></li>
<li><a href='#summary-methods'><p> ~~ Methods for Function <code>summary</code>  ~~</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Package for Plotting Categorical Longitudinal and Time-Series
Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.31</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-03-28</td>
</tr>
<tr>
<td>Author:</td>
<td>Stephen Tueller. Funded by the National Institute on Drug Abuse (NIDA) Award number 1R03DA030850, the National Institute on Alcohol Abuse and Alcoholism (NIAAA) Award Number R03 AA019775, and the National Institute of Justice Award Number 2011-RY-BX-0003.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Stephen Tueller &lt;stueller@rti.org&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Methods for plotting categorical longitudinal and time-series data by mapping individuals to the vertical space (each horizontal line represents a participant), time (or repeated measures) to the horizontal space, categorical (or discrete) states as facets using color or shade, and events to points using plotting characters. Sorting individuals in the vertical space and (or) stratifying them by groups can reveal patterns in the changes over time.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>methods, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>RColorBrewer, colorspace, MASS, ggplot2</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-04-18 12:15:28 UTC; stueller</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-04-18 12:49:57 UTC</td>
</tr>
</table>
<hr>
<h2 id='longCatEDA-package'>
Plot Categorical Longitudinal and Time-Series Data
</h2><span id='topic+longCatEDA-package'></span><span id='topic+longCatEDA'></span>

<h3>Description</h3>

<p>Package to implement horizontal line plots for categorical (ordinal or nominal) longitudinal or time-series data. This is done by mapping individuals to the vertical space (each horizontal line represents a participant), time (or repeated measures) to the horizontal space, categorical (or discrete) states as facets using color or shade, and events to points. Sorting individuals in the vertical space can reveal patterns in changes over time. 
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> longCatEDA</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.31</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 29Oct2016</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GNU GPL</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> methods</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Example usage is <code><a href="#topic+longCatPlot">longCatPlot</a></code>(<code><a href="#topic+longCat">longCat</a></code>(y)) where <code>y</code> is a matrix or data frame in wide format with participants in rows and repeated observations in columns. The function <code><a href="#topic+longCat">longCat</a></code> returns an object of class <code>longCat</code> which can be plotted using <code><a href="#topic+longCatPlot">longCatPlot</a></code>. Options for sorting and/or stratifying by groups are implemented using <code><a href="#topic+sorter">sorter</a></code> which returns a sorted and/or stratified object of class <code>longCat</code>. 
</p>


<h3>Author(s)</h3>

<p>Stephen Tueller
</p>
<p>Maintainer: Stephen Tueller &lt;stueller@rti.org&gt;
</p>


<h3>References</h3>

<p>Tueller, S. J., Van Dorn, R. A., &amp; Bobashev, G. V. (2016). Visualization of categorical longitudinal and times series data (Report No. MR-0033-1602). Research Triangle Park, NC: RTI Press. http://www.rti.org/publication/visualization-categorical-longitudinal-and-times-series-data</p>


<h3>Examples</h3>

<pre><code class='language-R'>par(bg='cornsilk3')
longCatPlot( longCat( example3 ) )
par(bg='transparent')
</code></pre>

<hr>
<h2 id='alignTime'>Align time data at a given state or event</h2><span id='topic+alignTime'></span>

<h3>Description</h3>

<p>Align <code>time</code> and <code>event.times</code> at a given state in <code>y</code> or <code>event</code>. All options can also be called via <code><a href="#topic+longCatPlot">longCatPlot</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>alignTime(y, times, 
  which.state=NULL, nth.state=NULL, not.state=FALSE,
  events=NULL, event.times=NULL, 
  which.event=NULL, nth.event=NULL, not.event=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alignTime_+3A_y">y</code></td>
<td>
<p>see <code>y</code> for <code><a href="#topic+longCat">longCat</a></code>.</p>
</td></tr>
<tr><td><code id="alignTime_+3A_times">times</code></td>
<td>
<p>see <code>times</code> for <code><a href="#topic+longCat">longCat</a></code>.</p>
</td></tr>
<tr><td><code id="alignTime_+3A_which.state">which.state</code></td>
<td>
<p>the state in <code>y</code> on which to align <code>times</code> (and if given, <code>event.times</code>). If <code>which.state</code> is given, <code>which.event</code> must be <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="alignTime_+3A_nth.state">nth.state</code></td>
<td>
<p>the nth occurrence of <code>which.state</code> on which to align <code>times</code> (and if given, <code>event.times</code>). If <code>nth.state</code> is given, <code>nth.event</code> must be <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="alignTime_+3A_not.state">not.state</code></td>
<td>
<p>instead of aligning at the nth state, align at the nth non-instance of <code>which.state</code>.</p>
</td></tr>
<tr><td><code id="alignTime_+3A_events">events</code></td>
<td>
<p>see <code>events</code> for <code><a href="#topic+longCat">longCat</a></code>.</p>
</td></tr>
<tr><td><code id="alignTime_+3A_event.times">event.times</code></td>
<td>
<p>see <code>events.times</code> for <code><a href="#topic+longCat">longCat</a></code>.</p>
</td></tr>
<tr><td><code id="alignTime_+3A_which.event">which.event</code></td>
<td>
<p>the event in <code>events</code> on which to align <code>times</code> and <code>event.times</code>. If <code>which.event</code> is given, <code>which.state</code> must be <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="alignTime_+3A_nth.event">nth.event</code></td>
<td>
<p>the nth occurrence of <code>which.event</code> on which to align <code>times</code> and <code>event.times</code>. If <code>nth.event</code> is given, <code>nth.state</code> must be <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="alignTime_+3A_not.event">not.event</code></td>
<td>
<p>instead of aligning at the nth event, align at the nth non-instance of <code>which.event</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>alignTime</code> returns a list with two objects:
</p>
<table>
<tr><td><code>aligned.times</code></td>
<td>
<p>The <code>times</code> matrix aligned at the <code>nth.state</code> of <code>which.state</code>.</p>
</td></tr>
<tr><td><code>aligned.event.times</code></td>
<td>
<p>The <code>event.times</code> matrix aligned at the <code>nth.event</code> of <code>which.event</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Stephen Tueller</p>


<h3>References</h3>

<p>Tueller, S. J., Van Dorn, R. A., &amp; Bobashev, G. V. (2016). Visualization of categorical longitudinal and times series data (Report No. MR-0033-1602). Research Triangle Park, NC: RTI Press. http://www.rti.org/publication/visualization-categorical-longitudinal-and-times-series-data</p>


<h3>See Also</h3>

<p><code><a href="#topic+longCatPlot">longCatPlot</a></code> to plot <code>longCat</code> objects created by the <code><a href="#topic+longCat">longCat</a></code> function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># illustrate individually varying times of observation 
set.seed(642531)
y &lt;- matrix(sample(1:5, 500, replace=TRUE), 100, 5)
set.seed(963854)
times &lt;- matrix(runif(600, 1, 3), 100, 6)
# times must be cumulative
times &lt;- t(apply(times, 1, cumsum))
# align at the 2nd instance of state 3
times23 &lt;- alignTime(y, times, which.state=3, nth.state=2)$aligned.times
# plotting
labels &lt;- c('Street', 'Drug Tx', 'Jail', 'Prison', 'Unknown')
lc   &lt;- longCat(y, times=times, Labels=labels)
lc23 &lt;- longCat(y, times=times23, Labels=labels)
par(mfrow=c(3,1), bg='cornsilk3')
longCatPlot(lc, main='Raw Times', legendBuffer=.5, ylab='')
longCatPlot(lc23, main='Aligned: 2nd Intsance of Jail',
            xlab='Days Since 2nd Instance of Jail (via alignTime)', 
            legendBuffer=.5, ylab='')
# repeat calling alignment from longCatPlot, not quite identical due to sorting
# on unaligned data
longCatPlot(lc, main='Aligned: 2nd Instance of Jail (via longCatPlot)', legendBuffer=.5, 
            which.state=3, nth.state=2, ylab='', xlab='Days Since 2nd Instance of Jail')
par(mfrow=c(1,1), bg='transparent')            

# illustrate the adding event indicators
set.seed(45962)
events &lt;- matrix(sample(1:3, 200, replace=TRUE), 100, 2)
set.seed(23498)
event.times &lt;- matrix(sample(c(times), 200, replace=FALSE), 100, 2)
# align at the 1st instance of event 2
alignedTimes &lt;- alignTime(y, times, events=events, event.times=event.times, 
                           which.event=2, nth.event=1)
times12       &lt;- alignedTimes$aligned.times
event.times12 &lt;- alignedTimes$aligned.event.times
# plotting
eventLabels=c('Arrest', 'Drug Test', 'Hearing')
lc &lt;- longCat(y, times=times, Labels=labels,  
              events=events, event.times=event.times, 
              eventLabels=eventLabels)
lc12 &lt;- longCat(y, times=times12, Labels=labels,  
                events=events, event.times=event.times12, 
                eventLabels=eventLabels)
par(mfrow=c(2,1), bg='cornsilk3', mar=c(5.1, 4.1, 4.1, 12.1), xpd=TRUE)
cols &lt;- longCatPlot(lc, legendBuffer=.5,
                    main='Superimpose Events', ylab='')
cols &lt;- longCatPlot(lc12, , legendBuffer=.5,
                    main='Aligned: 1st Drug Test',
                    xlab='Days Since 1st Drug Test', ylab='')
legend(15.5, 50, legend=lc$eventLabels, pch=1:length(lc$eventLabels))
par(mfrow=c(1,1), bg='transparent', mar = c(5, 4, 4, 2) + 0.1, xpd=FALSE)
</code></pre>

<hr>
<h2 id='clean.events'>
clean.events
</h2><span id='topic+clean.events'></span>

<h3>Description</h3>

<p>A helper function for <code><a href="#topic+longCatEDA">longCatEDA</a></code> which cleans out missing data from <code>events</code> and <code>event.times</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean.events(events, event.times)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clean.events_+3A_events">events</code></td>
<td>

<p>see <code><a href="#topic+longCatEDA">longCatEDA</a></code>
</p>
</td></tr>
<tr><td><code id="clean.events_+3A_event.times">event.times</code></td>
<td>

<p>see <code><a href="#topic+longCatEDA">longCatEDA</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Stephen Tueller
</p>

<hr>
<h2 id='colChoose'>
Internal Function for Selecting Color Schemes Used by longCatPlot 
</h2><span id='topic+colChoose'></span>

<h3>Description</h3>

<p>Internal function used by <code><a href="#topic+longCatPlot">longCatPlot</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colChoose(colScheme, nfactors, reverse = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="colChoose_+3A_colscheme">colScheme</code></td>
<td>

<p>can be one of
</p>

<ul>
<li><p> 'gray' = a grayscale spectrum
</p>
</li>
<li><p> 'rainbow' see <code><a href="grDevices.html#topic+rainbow">rainbow</a></code>
</p>
</li>
<li><p> 'heat' see <code><a href="grDevices.html#topic+heat.colors">heat.colors</a></code>
</p>
</li>
<li><p> 'terrain' see <code><a href="grDevices.html#topic+terrain.colors">terrain.colors</a></code>
</p>
</li>
<li><p> 'topo' see <code><a href="grDevices.html#topic+topo.colors">topo.colors</a></code>
</p>
</li>
<li><p> 'cm' see <code><a href="grDevices.html#topic+cm.colors">cm.colors</a></code>
</p>
</li></ul>

<p>No default is given in the function definition, but the default in <code><a href="#topic+longCatPlot">longCatPlot</a></code> passed to <code>colChoose</code> is <code>'heat'</code>.
</p>
</td></tr>
<tr><td><code id="colChoose_+3A_nfactors">nfactors</code></td>
<td>

<p>see <code>nfactors</code> in values returned by <code><a href="#topic+longCat">longCat</a></code>.
</p>
</td></tr>
<tr><td><code id="colChoose_+3A_reverse">reverse</code></td>
<td>

<p>logical - should color scheme be applied in reverse order to the levels of the categorical variable? Default is <code>FALSE</code>. See <code>reverse</code> input to <code><a href="#topic+longCatPlot">longCatPlot</a></code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Stephen Tueller</p>


<h3>References</h3>

<p>Tueller, S. J., Van Dorn, R. A., &amp; Bobashev, G. V. (2016). Visualization of categorical longitudinal and times series data (Report No. MR-0033-1602). Research Triangle Park, NC: RTI Press. http://www.rti.org/publication/visualization-categorical-longitudinal-and-times-series-data</p>


<h3>See Also</h3>

<p><code><a href="#topic+longCatPlot">longCatPlot</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># color examples
par(mfrow=c(2,3), bg='wheat')
times &lt;- c(1,100,200,300,400,500,600)
f3lc &lt;- longCat( example3, times, Labels=rep('',5) )
longCatPlot(f3lc, main='colScheme=gray', colScheme='gray', 
  lwd=.1, ylab='', legendBuffer = .25)
longCatPlot(f3lc, main='colScheme=rainbow', colScheme='rainbow', 
  lwd=.1, ylab='', legendBuffer = .25)
longCatPlot(f3lc, main='colScheme=heat', colScheme='heat', 
  lwd=.1, ylab='', legendBuffer = .25)
longCatPlot(f3lc, main='colScheme=terrain', colScheme='terrain', 
  lwd=.1, ylab='', legendBuffer = .25)
longCatPlot(f3lc, main='colScheme=topo', colScheme='topo', 
  lwd=.1, ylab='', legendBuffer = .25)
longCatPlot(f3lc, main='colScheme=cm', colScheme='cm', 
  lwd=.1, ylab='', legendBuffer = .25)
par(mfrow=c(1,1), bg='transparent')

## Not run: 
# illustrate the use of colors from the package RColorBrewer
library(RColorBrewer)
par(mfrow=c(2,3), bg='cornsilk3')
longCatPlot(f3lc, main='RColorBrewer: Blues', cols=brewer.pal(f3lc$nfactors, "Blues"), 
            lwd=.1, ylab='', legendBuffer = .25)
longCatPlot(f3lc, main='RColorBrewer: Greens', cols=brewer.pal(f3lc$nfactors, "Greens"), 
            lwd=.1, ylab='', legendBuffer = .25)
longCatPlot(f3lc, main='RColorBrewer: PuBuGn', cols=brewer.pal(f3lc$nfactors, "PuBuGn"), 
            lwd=.1, ylab='', legendBuffer = .25)
longCatPlot(f3lc, main='RColorBrewer: YlOrRd', cols=brewer.pal(f3lc$nfactors, "YlOrRd"), 
            lwd=.1, ylab='', legendBuffer = .25)
longCatPlot(f3lc, main='RColorBrewer: Spectral', cols=brewer.pal(f3lc$nfactors, "Spectral"), 
            lwd=.1, ylab='', legendBuffer = .25)
longCatPlot(f3lc, main='RColorBrewer: Accent', cols=brewer.pal(f3lc$nfactors, "Accent"), 
            lwd=.1, ylab='', legendBuffer = .25)
par(mfrow=c(1,1), bg='transparent')

# illustrate the use of colors from the package colorspace
library(colorspace)
par(mfrow=c(2,3), bg='cornsilk3')
longCatPlot(f3lc, main='colorspace: rainbow_hcl', cols=rainbow_hcl(f3lc$nfactors), 
            lwd=.1, ylab='', legendBuffer = .25)
longCatPlot(f3lc, main='colorspace: sequential_hcl', cols=sequential_hcl(f3lc$nfactors), 
            lwd=.1, ylab='', legendBuffer = .25)
longCatPlot(f3lc, main='colorspace: heat_hcl', cols=heat_hcl(f3lc$nfactors), 
            lwd=.1, ylab='', legendBuffer = .25)
longCatPlot(f3lc, main='colorspace: terrain_hcl', cols=terrain_hcl(f3lc$nfactors), 
            lwd=.1, ylab='', legendBuffer = .25)
longCatPlot(f3lc, main='colorspace: diverge_hcl', cols=diverge_hcl(f3lc$nfactors), 
            lwd=.1, ylab='', legendBuffer = .25)
longCatPlot(f3lc, main='colorspace: diverge_hsv', cols=diverge_hsv(f3lc$nfactors), 
            lwd=.1, ylab='', legendBuffer = .25)
par(mfrow=c(1,1), bg='transparent')

## End(Not run)
</code></pre>

<hr>
<h2 id='example2cat'>Example data for <code><a href="#topic+longCatPlot">longCatPlot</a></code>.</h2><span id='topic+example2cat'></span>

<h3>Description</h3>

<p>Simulated data for illustrating <code><a href="#topic+longCatPlot">longCatPlot</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example2cat</code></pre>


<h3>Format</h3>

<p>Data frame with 20 subjects and 6 time points</p>

<hr>
<h2 id='example2cont'>Simulated Data for Illustrating longContPlot</h2><span id='topic+example2cont'></span>

<h3>Description</h3>

<p>Simulated data for illustrating <code><a href="#topic+longContPlot">longContPlot</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>example2cont</code></pre>


<h3>Format</h3>

<p>Data frame with 20 subjects and 6 time points</p>

<hr>
<h2 id='example3'>Simulated Data for Illustrating longCat and longCatPlot</h2><span id='topic+example3'></span>

<h3>Description</h3>

<p>Simulated data for illustrating <code><a href="#topic+longCat">longCat</a></code> and <code><a href="#topic+longCatPlot">longCatPlot</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example3</code></pre>


<h3>Format</h3>

<p>Data frame with 100 subjects and 6 time points</p>


<h3>References</h3>

<p>Tueller, S. J., Van Dorn, R. A., &amp; Bobashev, G. V. (2016). Visualization of categorical longitudinal and times series data (Report No. MR-0033-1602). Research Triangle Park, NC: RTI Press.
</p>

<hr>
<h2 id='levelCheck'>
Function to Check Factor Levels
</h2><span id='topic+levelCheck'></span>

<h3>Description</h3>

<p>Internal function of checking the levels of <code>y</code> called by <code><a href="#topic+longCat">longCat</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>levelCheck(y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="levelCheck_+3A_y">y</code></td>
<td>
<p>a data matrix, see documentation for <code>y</code> in <code><a href="#topic+longCat">longCat</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Stephen Tueller</p>


<h3>References</h3>

<p>Tueller, S. J., Van Dorn, R. A., &amp; Bobashev, G. V. (2016). Visualization of categorical longitudinal and times series data (Report No. MR-0033-1602). Research Triangle Park, NC: RTI Press. http://www.rti.org/publication/visualization-categorical-longitudinal-and-times-series-data</p>


<h3>See Also</h3>

<p><code><a href="#topic+longCat">longCat</a></code>.
</p>

<hr>
<h2 id='longCat'>Creation of Objects of Class longCat</h2><span id='topic+longCat'></span>

<h3>Description</h3>

<p>Function to create objects of class <code>longCat</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>longCat(y, times = NULL, Labels = NULL, tLabels = NULL, id = NULL, 
        events = NULL, event.times = NULL, eventLabels = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="longCat_+3A_y">y</code></td>
<td>
<p>a data matrix or data frame of numeric states in wide (as opposed to long) format with cases in rows and repeated observations in columns. It is reccomended that <code>y</code> have 9 or fewer unique non-missing levels. Labels for the numeric states are given in <code>Labels</code>.</p>
</td></tr>
<tr><td><code id="longCat_+3A_times">times</code></td>
<td>
<p>The <code>times</code> object designates start and stop points for each plotted interval. It is either a vector with length being the number of columns in <code>y</code> plus one, <code>NULL</code>, or a matrix with the same number of rows as <code>y</code> and one more column than in <code>y</code>. Negative values are allowed such as would be the case if time is centered at an intervention point, negative values represent times prior to the intervention, and positive times represent times after the intervention. 
</p>
<p>If <code>times</code> is a vector, it is assumed that cases in each row in <code>y</code> is observed at the same time points for the same durations. For example, if <code>times=c(0,6,12,13)</code>, this indicates a design were cases were observed at 0, 6, and 12 time units. When applying <code>longCatPlot</code>, the first observation for each case with extend from 0 to 6, the second observation for each case will extend from 6 to 12, and the third observation will extend from 12 to 13. The value selected at the end may be arbitrary as cases may not have been followed for any additional time. A value may be selected to maintain consistent interval sizes. Continuing the example, one could use <code>times=c(0,6,12,18)</code> instead of <code>times=c(0,6,12,13)</code> even though cases weren't actually followed past month 12. Unequal spacing is allow, for example <code>times=c(0,3,12,18)</code>. In this case, participants are observed for at baseline, 3 time units, and 12 time units, where the final status is either intentionally or arbitrarily extended 18-12=6 time units at the right end of the plot. Missing values are not allowed. 
</p>
<p>If <code>times=NULL</code> (the default), <code>times=0:ncol(y)</code> will be assigned (i.e., starting at 0 times units and increase to 1 time unit, 2 time units, etc.). 
</p>
<p>When <code>times</code> is a matrix, each case has a unique set of observation times. In this case, missing values are allowed, but each case should have at least one observation and a start and stop point for that observation. If available timing data is a matrix of the same size as <code>y</code> and represents start points, the user must add a column at the end designating how far to the right time points should be extended. As noted above, this value may be arbitrary and should be large enough to show what state cases end in. If available timing data is a matrix of the same size as <code>y</code> and represents end points, the user must add a column at the beginning of the matrix designating designating start points. If available timing data represents duration instead of time points, the user must recode the data into cumulative time. For example, if a participant was in their first three states for 5, 7, and 11 time units, their row of <code>times</code> should be recoded to be <code>c(0,5,12,23)</code>. 
</p>
<p>The <code>times</code> and <code>event.times</code> matrices can be realigned using the <code><a href="#topic+alignTime">alignTime</a></code> function, or this can be done on the fly by accessing the <code>alginTime</code> options in the <code><a href="#topic+longCatPlot">longCatPlot</a></code> function.
</p>
</td></tr>  
<tr><td><code id="longCat_+3A_labels">Labels</code></td>
<td>
<p>a vector of numeric or character labels for the response options in <code>y</code>. Must be the same length as the number of unique non-missing values in <code>y</code>. Default is <code>NULL</code> and is assigned the values <code>1:max(unique(y))</code>.</p>
</td></tr>
<tr><td><code id="longCat_+3A_tlabels">tLabels</code></td>
<td>
<p>numeric or character labels for the time points in <code>times</code>. Default is <code>NULL</code> and is assigned the values <code>1:ncol(y)</code>.</p>
</td></tr>
<tr><td><code id="longCat_+3A_id">id</code></td>
<td>
<p>An optional variable identifying or naming the rows of <code>y</code>. Returned as the first column of the matrix <code>order.y</code> (see <code>order.y</code> in the value section below).</p>
</td></tr>
<tr><td><code id="longCat_+3A_events">events</code></td>
<td>
<p>An event <code>matrix</code> or <code>y.frame</code> which may be numeric or character (see <code>eventLabels</code>). Whereas the data in <code>y</code> are states in which each case resides for some period of time, <code>events</code> are instantaneous events (or very short lived states) that can be attached to a single point in time at <code>event.times</code>. The number of rows in <code>events</code> and <code>event.times</code> must equal the number of rows in <code>y</code>, but can have as many columns as needed to capture all events of interest. Large numbers of events may cloud the resulting figures created by <code><a href="#topic+longCatPlot">longCatPlot</a></code>.</p>
</td></tr>
<tr><td><code id="longCat_+3A_event.times">event.times</code></td>
<td>
<p>A <code>matrix</code> or <code>data.frame</code> of event times corresponding to each event in <code>events</code>. As opposed to the <code>times</code> matrix, which contains durations (except possibly the first column as described above), the <code>event.times</code> matrix is the time the event takes place (i.e., cumulative time).
</p>
<p>The <code>times</code> and <code>event.times</code> matrices can be realigned using the <code><a href="#topic+alignTime">alignTime</a></code> function, or this can be done on the fly by accessing the <code>alginTime</code> options in the <code><a href="#topic+longCatPlot">longCatPlot</a></code> function.</p>
</td></tr>
<tr><td><code id="longCat_+3A_eventlabels">eventLabels</code></td>
<td>
<p>If <code>events</code> is a character matrix, <code>eventLabels</code> should be left <code>NULL</code> and labels will be pulled from the data in <code>events</code>. If <code>events</code> is numeric, corresponding <code>eventLabels</code> can be supplied by the user as a character vector, for example, <code>c('event1', 'event2', 'etc.')</code>. The number of unique events (and correpsonding event labels) should be kept small if possible, otherwise the event legend on Figures produced by <code><a href="#topic+longCatPlot">longCatPlot</a></code> may be truncated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>longCat</code> returns an object of class <code>longCat</code> which is a list containing at least the following components:
</p>
<table>
<tr><td><code>y</code></td>
<td>
<p><code>y</code></p>
</td></tr>
<tr><td><code>y.sorted</code></td>
<td>
<p><code>y</code> sorted (default is <code>NULL</code> unless <code><a href="#topic+sorter">sorter</a></code> has been applied to the <code>longCat</code> object).</p>
</td></tr>
<tr><td><code>dim</code></td>
<td>
<p>the dimension of <code>y</code>.</p>
</td></tr>
<tr><td><code>times</code></td>
<td>
<p>the <code>times</code> object as described above.</p>
</td></tr>
<tr><td><code>endt</code></td>
<td>
<p>the <code>endt</code> object as described above.</p>
</td></tr>
<tr><td><code>times.sorted</code></td>
<td>
<p>if <code>times</code> is a matrix of the same dimension as <code>y</code>, <code>times.sorted</code> contains a matrix of individually varying times of observation with the same sorting as <code>y.sorted.</code></p>
</td></tr>
<tr><td><code>endt.sorted</code></td>
<td>
<p><code>endt</code> sorted after an <code>lc</code> object is passed to <code><a href="#topic+sorter">sorter</a></code></p>
</td></tr>
<tr><td><code>labels</code></td>
<td>
<p>the <code>labels</code> vector as described above</p>
</td></tr>
<tr><td><code>tLabels</code></td>
<td>
<p>the <code>tLabels</code> vector as described above</p>
</td></tr>
<tr><td><code>factors</code></td>
<td>
<p>a vector containing the unique values in <code>y</code>. Not that if the unique values in <code>y</code> were not sequential integers starting at 1, both <code>factors</code> and <code>y</code> are recoded such that they contain sequential integers starting at 1.</p>
</td></tr>
<tr><td><code>IndTime</code></td>
<td>
<p>a logical indicator of whether <code>times</code> is a matrix of the same dimension as <code>y</code>. If <code>TRUE</code>, <code><a href="#topic+longCatPlot">longCatPlot</a></code> treats these times as individually varying times of observation.</p>
</td></tr>
<tr><td><code>nfactors</code></td>
<td>
<p>the number of unique values in <code>y</code>, and is the same as the length of the <code>factors</code> vector. <code>nfactors</code> is determined by <code>longCat</code>. If users have data with more than 9 categories, continuous plotting methods are recommended via warning (e.g., try <code><a href="#topic+longContPlot">longContPlot</a></code>.)</p>
</td></tr>
<tr><td><code>sorted</code></td>
<td>
<p>a logical indicator of whether <code>y</code> has been sorted by the <code><a href="#topic+sorter">sorter</a></code> function. If <code>TRUE</code>, <code>y.sorted</code> (and <code>times.sorted</code> if <code>IndTime</code> is <code>TRUE</code>) will not be <code>NULL</code>. </p>
</td></tr>
<tr><td><code>ascending</code></td>
<td>
<p>logical indicator. If <code>sorted</code> is <code>TRUE</code>, this will indicate whether sorting was done ascending. (default is <code>NULL</code> unless <code><a href="#topic+sorter">sorter</a></code> has been applied to the <code>longCat</code> object).</p>
</td></tr>
<tr><td><code>group</code></td>
<td>
<p>a vector of the same length as the number of rows in <code>y</code> (default is <code>NULL</code> unless <code><a href="#topic+sorter">sorter</a></code> has been applied to the <code>longCat</code> object along with a grouping variable).</p>
</td></tr>
<tr><td><code>groupLabels</code></td>
<td>
<p>a optional vector of character or numeric labels for the <code>group</code> variable (see <code><a href="#topic+sorter">sorter</a></code>).</p>
</td></tr>
<tr><td><code>order.y</code></td>
<td>
<p>A matrix with identification (see input <code>id</code> above) and sorting information. Rows of the matrix correspond to rows of <code>y</code> and the columns are <code>id</code>, and order variable, and a variable representing the unique data patterns in <code>y</code>. The former is returned only if <code>id</code> is provided to <code>longCat</code>. The latter two are only returned by <a href="#topic+sorter">sorter</a>. If only unique data patterns are desired, use <code><a href="#topic+makePatterns">makePatterns</a></code>; see <code>example(makePatterns)</code>.</p>
</td></tr>
<tr><td><code>events</code></td>
<td>
<p>A matrix of events.</p>
</td></tr>
<tr><td><code>event.times</code></td>
<td>
<p>A matrix of event times.</p>
</td></tr>
<tr><td><code>eventLabels</code></td>
<td>
<p>A vector of event labels.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Stephen Tueller</p>


<h3>References</h3>

<p>Tueller, S. J., Van Dorn, R. A., &amp; Bobashev, G. V. (2016). Visualization of categorical longitudinal and times series data (Report No. MR-0033-1602). Research Triangle Park, NC: RTI Press. http://www.rti.org/publication/visualization-categorical-longitudinal-and-times-series-data</p>


<h3>See Also</h3>

<p><code><a href="#topic+longCatPlot">longCatPlot</a></code> to plot <code>longCat</code> objects created by the <code><a href="#topic+longCat">longCat</a></code> function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create the longcat object similar to Figure 2 in Tueller (2016)
times &lt;- c(1,100,200,300,400,500,600)
f2lc &lt;- longCat(example2cat, times)

# object summary
summary(f2lc)

# compare growth curves to longCat
par(mfrow=c(1,2), bg='cornsilk3')
longContPlot(example2cat, times, ylim=c(1,5), 
  main='Growth Curves', ylab='', xlab='Days')
longCatPlot(f2lc, lwd=4, main='Horizontal Line Plot', colScheme='heat', legendBuffer=.2)
par(mfrow=c(1,1), bg='transparent')

# illustrate individually varying times of observation 
set.seed(642531)
y &lt;- matrix(sample(1:5, 500, replace=TRUE), 100, 5)
set.seed(963854)
times &lt;- matrix(runif(600, 1, 3), 100, 6)
# times must be cumulative
times &lt;- t(apply(times, 1, cumsum))
lc &lt;- longCat(y, times=times)
par(mfrow=c(1,1), bg='cornsilk3', mar=c(5.1, 4.1, 4.1, 10.1), xpd=TRUE)
cols &lt;- longCatPlot(lc, legendBuffer=0, groupBuffer=0, 
	main='Individually Varying Times of Observation')
legend(15.5, 100, legend=lc$Labels, lty=1, col=cols, lwd=2)
par(bg='transparent', mar = c(5, 4, 4, 2) + 0.1, xpd=FALSE)

# illustrate the adding event indicators
set.seed(45962)
events &lt;- matrix(sample(1:3, 200, replace=TRUE), 100, 2)
set.seed(23498)
event.times &lt;- matrix(sample(c(times), 200, replace=FALSE), 100, 2)
labels &lt;- c('Street', 'Drug Tx', 'Jail', 'Prison', 'Unknown')
eventLabels=c('Arrest', 'Drug Test', 'Hearing')
lc &lt;- longCat(y, times=times, Labels=labels,  
              events=events, event.times=event.times, 
              eventLabels=eventLabels)
par(mfrow=c(1,1), bg='cornsilk3', mar=c(5.1, 4.1, 4.1, 12.1), xpd=TRUE)
cols &lt;- longCatPlot(lc, legendBuffer=0, groupBuffer=0, 
                    main='Superimpose Events Over States')
legend(15.5, 100, legend=lc$Labels, lty=1, col=cols, lwd=2)
legend(15.5, 40, legend=lc$eventLabels, pch=1:length(lc$eventLabels))
par(bg='transparent', mar = c(5, 4, 4, 2) + 0.1, xpd=FALSE)

## Not run: 
# illustrate handling non time-ordered input (e.g., factor analysis data)
y &lt;- matrix(sample(c('1', '2', '3', '4', '5'), 500, replace=TRUE), 100, 5)
lc &lt;- longCat(y)
par(mfrow=c(1,1), bg='cornsilk3', mar=c(5.1, 4.1, 4.1, 8.1), xpd=TRUE)
cols &lt;- longCatPlot(lc, legendBuffer=0)
legend(6, 100, legend=lc$factors, lty=1, col=cols, lwd=2)
par(bg='transparent', mar = c(5, 4, 4, 2) + 0.1, xpd=FALSE)

# illustrate plotting with more than 9 categories 
# (a warning is issued) 
y &lt;- matrix(sample(1:18, 500, replace=TRUE), 100, 5)
lc &lt;- longCat(y)
par(mfrow=c(1,1), bg='cornsilk3', mar=c(5.1, 4.1, 4.1, 8.1), xpd=TRUE)
cols &lt;- longCatPlot(lc, legendBuffer=0)
legend(6, 100, legend=lc$factors, lty=1, col=cols, lwd=2)
par(bg='transparent', mar = c(5, 4, 4, 2) + 0.1, xpd=FALSE)

## End(Not run)

</code></pre>

<hr>
<h2 id='longCat-class'>Class <code>"longCat"</code></h2><span id='topic+longCat-class'></span>

<h3>Description</h3>

<p>An object of class <code><a href="#topic+longCat">longCat</a>.</code> 
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("longCat", ...)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>y</code>:</dt><dd><p>Object of class <code>"matrix"</code> ~~ </p>
</dd>
<dt><code>y.sorted</code>:</dt><dd><p>Object of class <code>"matrix"</code> ~~ </p>
</dd>
<dt><code>dim</code>:</dt><dd><p>Object of class <code>"integer"</code> ~~ </p>
</dd>
<dt><code>times</code>:</dt><dd><p>Object of class <code>"matrix"</code> ~~ </p>
</dd>
<dt><code>times.sorted</code>:</dt><dd><p>Object of class <code>"matrix"</code> ~~ </p>
</dd>
<dt><code>Labels</code>:</dt><dd><p>Object of class <code>"character"</code> ~~ </p>
</dd>
<dt><code>factors</code>:</dt><dd><p>Object of class <code>"numeric"</code> ~~ </p>
</dd>
<dt><code>IndTime</code>:</dt><dd><p>Object of class <code>"logical"</code> ~~ </p>
</dd>
<dt><code>nfactors</code>:</dt><dd><p>Object of class <code>"integer"</code> ~~ </p>
</dd>
<dt><code>sorted</code>:</dt><dd><p>Object of class <code>"logical"</code> ~~ </p>
</dd>
<dt><code>ascending</code>:</dt><dd><p>Object of class <code>"logical"</code> ~~ </p>
</dd>
<dt><code>group</code>:</dt><dd><p>Object of class <code>"matrix"</code> ~~ </p>
</dd>
<dt><code>group.sorted</code>:</dt><dd><p>Object of class <code>"matrix"</code> ~~ </p>
</dd>
<dt><code>groupLabels</code>:</dt><dd><p>Object of class <code>"character"</code> ~~ </p>
</dd>
<dt><code>order.y</code>:</dt><dd><p>Object of class <code>"matrix"</code> ~~ </p>
</dd>
<dt><code>order.y.sorted</code>:</dt><dd><p>Object of class <code>"matrix"</code> ~~ </p>
</dd>
<dt><code>events</code>:</dt><dd><p>Object of class <code>"matrix"</code> ~~ </p>
</dd>
<dt><code>event.times</code>:</dt><dd><p>Object of class <code>"matrix"</code> ~~ </p>
</dd>
<dt><code>events.sorted</code>:</dt><dd><p>Object of class <code>"matrix"</code> ~~ </p>
</dd>
<dt><code>event.times.sorted</code>:</dt><dd><p>Object of class <code>"matrix"</code> ~~ </p>
</dd>
<dt><code>eventLables</code>:</dt><dd><p>Object of class <code>"character"</code> ~~ </p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>summary</dt><dd><p><code>signature(object = "longCat")</code>: ... </p>
</dd>
</dl>



<h3>References</h3>

<p>Tueller, S. J., Van Dorn, R. A., &amp; Bobashev, G. V. (2016). Visualization of categorical longitudinal and times series data (Report No. MR-0033-1602). Research Triangle Park, NC: RTI Press. http://www.rti.org/publication/visualization-categorical-longitudinal-and-times-series-data</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("longCat")
</code></pre>

<hr>
<h2 id='longCatPlot'>
Plotting of lc objects
</h2><span id='topic+longCatPlot'></span>

<h3>Description</h3>

<p>Function to plot <code>longCat</code> objects created by <code><a href="#topic+longCat">longCat</a></code>.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>longCatPlot(lc, xlab = "Days", 
  ylab = NULL, cols = NULL, 
  colScheme = "heat", reverse = FALSE, lwd = 0.5, lcex = 1, llwd = 3, 
  legendBuffer = 0.12, groupBuffer = 0, groupRotation = 90, gcex = 1, 
  seg.len = 1, xlas = 0, xcex = 1, ecex = .5, event.col=1, 
  plot.events=TRUE, which.events=NULL, 
  n.events=NULL, event.pch=NULL, 
  texclude=NULL, sort=TRUE,
  which.state=NULL, nth.state=NULL, not.state=FALSE,
  which.event=NULL, nth.event=NULL, not.event=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="longCatPlot_+3A_lc">lc</code></td>
<td>

<p>an object of class <code><a href="#topic+longCat">longCat</a></code> created by <code><a href="#topic+longCat">longCat</a></code>. See <code><a href="graphics.html#topic+par">par</a></code>.
</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_xlab">xlab</code></td>
<td>

<p>a label for the x-axis. Default is &quot;Days&quot;. See <code><a href="graphics.html#topic+par">par</a></code>.
</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_ylab">ylab</code></td>
<td>

<p>a label for the y-axis. Default is <code>NULL</code> which is changed to &quot;Each Line Represents a Participant&quot; with the sample size appended (<code>lc$dim[1]</code>, see <code><a href="#topic+longCat">longCat</a></code>). See <code><a href="graphics.html#topic+par">par</a></code>.
</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_cols">cols</code></td>
<td>

<p>a numeric or character list of colors. See <code><a href="graphics.html#topic+par">par</a></code>. Default is <code>NULL</code>. To use internal color schemes, use <code>colScheme</code>.
</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_colscheme">colScheme</code></td>
<td>

<p>select a color scheme. See <code><a href="#topic+colChoose">colChoose</a></code> for available options.
</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_reverse">reverse</code></td>
<td>

<p>color schemes are applied from the lowest to highest level of categorical data in <code>lc$y</code> or <code>lc$y.sorted</code>. Set <code>reverse=TRUE</code> to reverse this. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_lwd">lwd</code></td>
<td>

<p>set the width of horizontal lines. Default is .5. <code>lwd</code> should be reduced proportionally to the number of rows in <code>lc$y</code> to avoid overlap in plotting. 
</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_lcex">lcex</code></td>
<td>

<p>character expansion factor for the legend text. Default is 1. See <code><a href="graphics.html#topic+par">par</a></code>.
</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_llwd">llwd</code></td>
<td>

<p>set the width of lines in the legend. default is 3. See <code>lwd</code>.
</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_legendbuffer">legendBuffer</code></td>
<td>

<p>set proportion of the plot to retain for legends, must be in [0,1]. Note that the legend is very sensitive to the scaling of the graphics device. Users are advised to maximize their device and rerun, or call <code>dev.new()</code> and resize prior to running <code>longCatPlot</code>. Default is .12 (i.e., 12% of the vertical plot area is retained for the legend). Set to 0 if no legend is desired. See the examples for moving the legend outside of the plotting margins.
</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_groupbuffer">groupBuffer</code></td>
<td>

<p>similar to legendBuffer, but for group labels on the left side of the plot. Default is 0 (i.e., 0% of the horizontal plot area is retained for group labels). Can take on any value in [0,1]. 
</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_grouprotation">groupRotation</code></td>
<td>

<p>if <code>lc$groupLabels</code> are long (see <code><a href="#topic+longCat">longCat</a></code>), rotation of the labels can be used reduce the needed size of <code>groupBuffer</code>. The value is in degrees ranging from -360 to +360.
</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_gcex">gcex</code></td>
<td>
<p>character expansion factor for group labels. Default is 1. See <code><a href="graphics.html#topic+par">par</a></code>.
</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_seg.len">seg.len</code></td>
<td>
<p>Length of lines in the upper legend. Default is 1. See <code><a href="graphics.html#topic+legend">legend</a></code>.</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_xlas">xlas</code></td>
<td>
<p>see <code>las</code> in <code><a href="graphics.html#topic+par">par</a></code>. Applied to the x-axis when <code>tLabels</code> are provided to <code><a href="#topic+longCat">longCat</a></code>.</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_xcex">xcex</code></td>
<td>
<p>see <code>axis.cex</code> in <code><a href="graphics.html#topic+par">par</a></code> and  <code><a href="graphics.html#topic+axis">axis</a></code>. Applied to the x-axis when <code>tLabels</code> are provided to <code><a href="#topic+longCat">longCat</a></code>.</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_ecex">ecex</code></td>
<td>
<p>see <code>cex</code> in <code><a href="graphics.html#topic+points">points</a></code>. This is used to size the points used to plot event points if <code>events</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_event.col">event.col</code></td>
<td>
<p>color for ploting event indicators.</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_plot.events">plot.events</code></td>
<td>
<p>logical - should events be plotted?</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_which.events">which.events</code></td>
<td>
<p>numeric vector - which events should be plotted? For example, if the events have values <code>c(1,2,3,4,5)</code>, you can specify that only <code>which.events=c(2,5)</code> be plotted.</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_n.events">n.events</code></td>
<td>
<p>how many events should be plotted, e.g., <code>n.events=3</code> plots the first three events for each participant.</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_event.pch">event.pch</code></td>
<td>
<p>what plotting characters should be used. See <code><a href="graphics.html#topic+points">points</a></code>.</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_texclude">texclude</code></td>
<td>
<p>a vector of length 2 indicating the range of <code>times</code> and <code>event.times</code> to be plotted, e.g., <code>texclude=c(10,20)</code> will plot data for time points 10 and larger up to and including 20.</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_sort">sort</code></td>
<td>
<p>logical - should <code>longCatPlot</code> sort the data on the fly using intelligent defaults? If data are already sorted via <code>sorter</code>, this will be ignored.</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_which.state">which.state</code></td>
<td>
<p>see <code><a href="#topic+alignTime">alignTime</a></code>.</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_nth.state">nth.state</code></td>
<td>
<p>see <code><a href="#topic+alignTime">alignTime</a></code>.</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_not.state">not.state</code></td>
<td>
<p>see <code><a href="#topic+alignTime">alignTime</a></code>.</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_which.event">which.event</code></td>
<td>
<p>see <code><a href="#topic+alignTime">alignTime</a></code>.</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_nth.event">nth.event</code></td>
<td>
<p>see <code><a href="#topic+alignTime">alignTime</a></code>.</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_not.event">not.event</code></td>
<td>
<p>see <code><a href="#topic+alignTime">alignTime</a></code>.</p>
</td></tr>
<tr><td><code id="longCatPlot_+3A_...">...</code></td>
<td>

<p>Arguments to be passed to <code><a href="base.html#topic+plot">plot</a></code> (see <code><a href="graphics.html#topic+par">par</a></code>).
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Stephen Tueller</p>


<h3>References</h3>

<p>Tueller, S. J., Van Dorn, R. A., &amp; Bobashev, G. V. (2016). Visualization of categorical longitudinal and times series data (Report No. MR-0033-1602). Research Triangle Park, NC: RTI Press. http://www.rti.org/publication/visualization-categorical-longitudinal-and-times-series-data</p>


<h3>See Also</h3>

<p><code><a href="#topic+longCat">longCat</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Illustrate longCatPlot with the legend outside the plot
par(mfrow=c(1,1), bg='cornsilk3', mar=c(5.1, 4.1, 4.1, 8.1), xpd=TRUE)
cols &lt;- longCatPlot(
  longCat(example3),
  legendBuffer=0,
  main='Horizontal Line Plot')
legend(7.1, 100, legend=1:5, col=cols, lty=1, lwd=2)
par(bg='transparent', mar = c(5, 4, 4, 2) + 0.1, xpd=FALSE)

### visualizing multivariate data: 3 items at 4 time points
library(MASS)
Sigma &lt;- matrix(.25, 12, 12)
diag(Sigma) &lt;- 1
set.seed(9845)
mu &lt;- rep(c(-.5, 0, .5), 4) + rnorm(12, 0, .25)
set.seed(539)
ymv &lt;- apply(mvrnorm(n=100, mu=mu, Sigma = Sigma), 2, cut, breaks=c(-Inf, 0, Inf), labels=c(0,1))
apply(ymv, 2, table)
(items &lt;- rep(1:3, 4))
(times &lt;- sort(rep(1:4, 3)))
tLabels &lt;- paste('Time', 1:4)
 Labels &lt;- paste('Item', 1:3)
 
# plot time points within items
par(mfrow=c(2,2), bg='cornsilk3', mar=c(5.1, 4.1, 4.1, 8.1), xpd=TRUE)

item1  &lt;- longCat(y=ymv[,items==1], tLabels=tLabels)
cols &lt;- longCatPlot(item1, ylab='', main='Item 1', legendBuffer=0, xlab="", xlas=2)
legend(length(unique(times))+.1, nrow(ymv), legend=0:1, col=cols, lty=1, lwd=2, title='Response')

item2 &lt;- longCat(y=ymv[,items==2], tLabels=tLabels)
longCatPlot(item2, ylab='', main='Item 2', legendBuffer=0, xlab="", xlas=2)
legend(length(unique(times))+.1, nrow(ymv), legend=0:1, col=cols, lty=1, lwd=2, title='Response')

item3 &lt;- longCat(y=ymv[,items==3], tLabels=tLabels)
longCatPlot(item3, ylab='', main='Item 3', legendBuffer=0, xlab="", xlas=2)
legend(length(unique(times))+.1, nrow(ymv), legend=0:1, col=cols, lty=1, lwd=2, title='Response')

par(bg='transparent', mar = c(5, 4, 4, 2) + 0.1, xpd=FALSE)

# plot items within time points
par(mfrow=c(2,2), bg='cornsilk3', mar=c(5.1, 4.1, 4.1, 8.1), xpd=TRUE)

time1  &lt;- longCat(y=ymv[,times==1], tLabels=Labels)
cols &lt;- longCatPlot(time1, ylab='', main='Time 1', legendBuffer=0, xlab="")
legend(length(unique(times))+.1, nrow(ymv), legend=0:1, col=cols, lty=1, lwd=2, title='Response')

time2  &lt;- longCat(y=ymv[,times==2], tLabels=Labels)
cols &lt;- longCatPlot(time2, ylab='', main='Time 2', legendBuffer=0, xlab="")
legend(length(unique(times))+.1, nrow(ymv), legend=0:1, col=cols, lty=1, lwd=2, title='Response')

time3  &lt;- longCat(y=ymv[,times==3], tLabels=Labels)
cols &lt;- longCatPlot(time3, ylab='', main='Time 3', legendBuffer=0, xlab="")
legend(length(unique(times))+.1, nrow(ymv), legend=0:1, col=cols, lty=1, lwd=2, title='Response')

time4  &lt;- longCat(y=ymv[,times==4], tLabels=Labels)
cols &lt;- longCatPlot(time4, ylab='', main='Time 4', legendBuffer=0, xlab="")
legend(length(unique(times))+.1, nrow(ymv), legend=0:1, col=cols, lty=1, lwd=2, title='Response')

par(mfrow=c(1,1), bg='transparent', mar = c(5, 4, 4, 2) + 0.1, xpd=FALSE)

## Not run: 
# for data sets with many rows, writing directly to a file 
# is much faster and unaffected by device resizing, see ?pdf
pdf('C:/mydir/mysubdir/myfile.pdf')
par(bg='cornsilk3')
longCatPlot(f3lc, main='Sorted', colScheme='heat', lwd=2)
par(mfrow=c(1,1), bg='transparent')
dev.off()
# see ?jpeg for picture file options

## End(Not run)
</code></pre>

<hr>
<h2 id='longContPlot'>
Plot Continuous Longitudinal Data
</h2><span id='topic+longContPlot'></span>

<h3>Description</h3>

<p>Function to plot continuous longitudinal or time-series data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>longContPlot(y, times = NULL, jog=FALSE, ylim = NULL, xlim = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="longContPlot_+3A_y">y</code></td>
<td>
<p>a data matrix or data frame in wide (as opposed to long) format with cases in rows and repeated observations in columns.</p>
</td></tr>
<tr><td><code id="longContPlot_+3A_times">times</code></td>
<td>
<p>time points used for the x-axis in plotting. Either a vector of the same length as the number of columns in <code>y</code> (i.e., all cases have the same times of observation), or a matrix of the same dimension as <code>y</code> (i.e., individually varying times of observation). Default is <code>NULL</code> and is assigned the value 1:<code>ncol(y)</code>.</p>
</td></tr>  
<tr><td><code id="longContPlot_+3A_jog">jog</code></td>
<td>

<p>When <code>y</code> is integer data, it can be useful to jog all values by a small amount. When <code>jog=TRUE</code>, a random uniform variate in [-.25, .25] is added to each row in <code>y</code>.
</p>
</td></tr>
<tr><td><code id="longContPlot_+3A_ylim">ylim</code></td>
<td>

<p>see <code><a href="graphics.html#topic+par">par</a></code>. Default is <code>NULL</code> and calculated from <code>y</code>.
</p>
</td></tr>
<tr><td><code id="longContPlot_+3A_xlim">xlim</code></td>
<td>

<p>see <code><a href="graphics.html#topic+par">par</a></code>. Default is <code>NULL</code> and calculated from <code>y</code>.
</p>
</td></tr>
<tr><td><code id="longContPlot_+3A_...">...</code></td>
<td>

<p>Arguments to be passed to <code><a href="base.html#topic+plot">plot</a></code>. See <code><a href="graphics.html#topic+par">par</a></code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Stephen Tueller</p>


<h3>References</h3>

<p>Tueller, S. J., Van Dorn, R. A., &amp; Bobashev, G. V. (2016). Visualization of categorical longitudinal and times series data (Report No. MR-0033-1602). Research Triangle Park, NC: RTI Press. http://www.rti.org/publication/visualization-categorical-longitudinal-and-times-series-data</p>


<h3>See Also</h3>

<p><code><a href="#topic+longCatPlot">longCatPlot</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># longitudinal plot
times &lt;- c(1,100,200,300,400,500)
par(mfrow=c(1,1), bg='cornsilk3')
longContPlot(example2cont, times, ylim=c(-2,6), main='', ylab='', xlab='Day')
par(mfrow=c(1,1), bg='transparent')

# jogging example
times &lt;- c(1,100,200,300,400,500)
par(mfrow=c(1,2), bg='cornsilk3')
longContPlot(example2cat, times,           ylim=c(0,6), 
  main='Growth Curves', ylab='', xlab='Days')
longContPlot(example2cat, times, jog=TRUE, ylim=c(0,6), 
  main='Growth Curves + Jogging', 
	ylab='', xlab='Days')
par(mfrow=c(1,1), bg='transparent')# compare growth curves to longCat

</code></pre>

<hr>
<h2 id='lunique'>
Find the Unique Number of Factors
</h2><span id='topic+lunique'></span>

<h3>Description</h3>

<p>Function to find the unique number of factors in a matrix or data frame of categorical data. Used internally by <code><a href="#topic+longCat">longCat</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lunique(y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lunique_+3A_y">y</code></td>
<td>
<p>see <code>y</code> for <code><a href="#topic+longCat">longCat</a></code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Stephen Tueller</p>


<h3>References</h3>

<p>Tueller, S. J., Van Dorn, R. A., &amp; Bobashev, G. V. (2016). Visualization of categorical longitudinal and times series data (Report No. MR-0033-1602). Research Triangle Park, NC: RTI Press. http://www.rti.org/publication/visualization-categorical-longitudinal-and-times-series-data</p>

<hr>
<h2 id='makePatterns'>
Concatenate Multivariate Data into Numeric or Character Patterns
</h2><span id='topic+makePatterns'></span>

<h3>Description</h3>

<p>Function to concatenate the columns of a matrix or data frame for each row into a single character variable, which can optionally be reconverted to numeric. Called internally by <code><a href="#topic+sorter">sorter</a></code>. For example, a row of a matrix containing <code>c(1, 2, 3, 5)</code> will be concatenated to <code style="white-space: pre;">&#8288;"1235"&#8288;</code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makePatterns(dat, times, num = TRUE, mindur = NULL, igrpt = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="makePatterns_+3A_dat">dat</code></td>
<td>

<p>a matrix or data frame such as <code>lc$y</code> from an <code><a href="#topic+longCat">longCat</a></code> object created by <code><a href="#topic+longCat">longCat</a></code>.
</p>
</td></tr>
<tr><td><code id="makePatterns_+3A_times">times</code></td>
<td>

<p>see <code>times</code> in <code><a href="#topic+longCat">longCat</a></code>.
</p>
</td></tr>
<tr><td><code id="makePatterns_+3A_num">num</code></td>
<td>

<p>logical indicator, should a numeric version of the concatenate rows be return. Default is <code>TRUE</code>. When <code>num=TRUE</code>, the return is rescaled by moving a decimal point between the first and second digits. This ensures that, under different numbers of observations or missing data, ordering is not unduly impacted by patterns of missing data. Users are encouraged to try sorting with <code>num=TRUE</code> and <code>num=FALSE</code> when experimenting to find the sorting that leads to the clearest plot. When <code>lc$sorted=FALSE</code> and there is no missing data in <code>lc$y</code> and <code>lc$IntTime=FALSE</code>, <code><a href="#topic+longCatPlot">longCatPlot</a></code> will change <code>num</code> to <code>FALSE</code>. 
</p>
</td></tr>
<tr><td><code id="makePatterns_+3A_mindur">mindur</code></td>
<td>

<p>minimum duration. If <code>times</code> is a matrix or data frame of individually varying times of observation of the same dimension as <code>dat</code>, selecting <code>mindur &gt; 0</code> results in all cells in <code>y</code> corresponding to cells in <code>times - times[,1] &lt; mindur</code> being changed to <code>NA</code> (where <code>times - times[,1]</code> changes the <code>times</code> from a matrix of observed times to a matrix of durations for each state in <code>dat</code>). This minimizes the effect of short durations on the sorting algorithm in <code><a href="#topic+sorter">sorter</a></code>. Default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="makePatterns_+3A_igrpt">igrpt</code></td>
<td>
<p>Option to ignore repeated values when sorting, allowing the sorting algorithm in <code><a href="#topic+sorter">sorter</a></code> to smooth over regions of no change for each row in <code>lc$y</code>. Default is <code>FALSE</code>. See <code><a href="#topic+norpt">norpt</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>out</code></td>
<td>
<p>A vector of patterns of length <code>nrow(dat)</code></p>
</td></tr></table>
<p>.
</p>


<h3>Author(s)</h3>

<p>Stephen Tueller</p>


<h3>References</h3>

<p>Tueller, S. J., Van Dorn, R. A., &amp; Bobashev, G. V. (2016). Visualization of categorical longitudinal and times series data (Report No. MR-0033-1602). Research Triangle Park, NC: RTI Press. http://www.rti.org/publication/visualization-categorical-longitudinal-and-times-series-data</p>


<h3>See Also</h3>

<p><code><a href="#topic+sorter">sorter</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create an arbitrary matrix and demonstrate
temp &lt;- matrix( sample(1:9, 40, replace=TRUE), 10, 4)
print(temp)
makePatterns(temp, num=FALSE)

# examine the unique patterns of data
bindat &lt;- matrix( sample(0:1, 500, replace=TRUE), 100, 5)
uniquePatterns &lt;- makePatterns( bindat, num=FALSE)
as.matrix( table( uniquePatterns ) )

</code></pre>

<hr>
<h2 id='norpt'>
A function to take out repeated observations in a vector of data for sorting purposes.
</h2><span id='topic+norpt'></span>

<h3>Description</h3>

<p>See the example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>norpt(alist = c(1, 2, 2, 3, 3, 3, 4, 4, 4, 4, 5))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="norpt_+3A_alist">alist</code></td>
<td>

</td></tr>
</table>


<h3>Value</h3>

<p>A vector excluding repeated values with trailing <code>NA</code>'s to fill the vector to original length.
</p>


<h3>Author(s)</h3>

<p>Stephen Tueller
</p>


<h3>References</h3>

<p>Tueller, S. J., Van Dorn, R. A., &amp; Bobashev, G. V. (2016). Visualization of categorical longitudinal and times series data (Report No. MR-0033-1602). Research Triangle Park, NC: RTI Press. http://www.rti.org/publication/visualization-categorical-longitudinal-and-times-series-data</p>


<h3>See Also</h3>

<p><code>igrpt</code> input to <code><a href="#topic+makePatterns">makePatterns</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(alist = c(1,2,2,3,3,3,4,4,4,4,5))
norpt(alist)

</code></pre>

<hr>
<h2 id='sort1'>
sort1
</h2><span id='topic+sort1'></span>

<h3>Description</h3>

<p>Helper function for <code><a href="#topic+sorter">sorter</a></code>, doing within group sorting with <code><a href="#topic+sorter">sorter</a></code> looping through groups (even if there is only one group) using <code>sort1</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sort1(id1, y1, times1, events1, event.times1, group1, 
ascending = TRUE, whichColumns = NULL, initFirst = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sort1_+3A_id1">id1</code></td>
<td>

<p>The identification variable for one group. See also <code>id</code> for <code><a href="#topic+longCat">longCat</a></code>.
</p>
</td></tr>
<tr><td><code id="sort1_+3A_y1">y1</code></td>
<td>

<p>The longitudinal data for one group. See also <code>y</code> for <code><a href="#topic+longCat">longCat</a></code>.
</p>
</td></tr>
<tr><td><code id="sort1_+3A_times1">times1</code></td>
<td>

<p>The time data for one group. See also <code>times</code> for <code><a href="#topic+longCat">longCat</a></code>.
</p>
</td></tr>
<tr><td><code id="sort1_+3A_events1">events1</code></td>
<td>

<p>The events data for one group. See also <code>events</code> for <code><a href="#topic+longCat">longCat</a></code>.
</p>
</td></tr>
<tr><td><code id="sort1_+3A_event.times1">event.times1</code></td>
<td>

<p>The event times for one group. See also <code>event.times</code> for <code><a href="#topic+longCat">longCat</a></code>.
</p>
</td></tr>
<tr><td><code id="sort1_+3A_group1">group1</code></td>
<td>

<p>The group identification variable for one group. See also <code>group</code> for <code><a href="#topic+sorter">sorter</a></code>.
</p>
</td></tr>
<tr><td><code id="sort1_+3A_ascending">ascending</code></td>
<td>

<p>See <code>ascending</code> for <code><a href="#topic+sorter">sorter</a></code>.
</p>
</td></tr>
<tr><td><code id="sort1_+3A_whichcolumns">whichColumns</code></td>
<td>

<p>See <code>whichColumns</code> for <code><a href="#topic+sorter">sorter</a></code>.
</p>
</td></tr>
<tr><td><code id="sort1_+3A_initfirst">initFirst</code></td>
<td>

<p>See <code>initFirst</code> for <code><a href="#topic+sorter">sorter</a></code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Stephen Tueller
</p>

<hr>
<h2 id='sorter'>
General Sorting Function
</h2><span id='topic+sorter'></span>

<h3>Description</h3>

<p>A function to sort an <code><a href="#topic+longCat">longCat</a></code> object created by <code><a href="#topic+longCat">longCat</a></code>. <code>sorter</code> must be used directly when stratified plots of subgroups is desired, or when sorting other than the default sorting is desired. Otherwise, <code>sorter</code> is used internally with the defaults by <code><a href="#topic+longCatPlot">longCatPlot</a></code> if <code>lc$sorted=FALSE</code>. If an object has already been sorted (<code>lc$sort=TRUE</code>), <code>sorter</code> will not resort it, but will print a code example of how to use multiple sortings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sorter(lc, ascending = TRUE, whichColumns = NULL, num = TRUE,
                 mindur = NULL, igrpt = FALSE, customSort = NULL,
                 initFirst = FALSE, group = NULL, groupLabels = NULL,
                 ggap = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sorter_+3A_lc">lc</code></td>
<td>

<p>an object of class <code><a href="#topic+longCat">longCat</a></code> created by <code><a href="#topic+longCat">longCat</a></code>.
</p>
</td></tr>
<tr><td><code id="sorter_+3A_ascending">ascending</code></td>
<td>

<p>logical - should sorting be done ascending. Default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="sorter_+3A_whichcolumns">whichColumns</code></td>
<td>

<p>a numeric list indicating which columns in <code>lc$y</code> should be used for sorting (.e.g., <code>c(1, 5, 7)</code>). Useful if, for example, an intervention occurs after data collection has started, and the user is not interested in sorting on pre-intervention observations.
</p>
</td></tr>
<tr><td><code id="sorter_+3A_num">num</code></td>
<td>

<p>see <code><a href="#topic+makePatterns">makePatterns</a></code> for details.
</p>
</td></tr>
<tr><td><code id="sorter_+3A_mindur">mindur</code></td>
<td>

<p>see <code><a href="#topic+makePatterns">makePatterns</a></code>.
</p>
</td></tr>
<tr><td><code id="sorter_+3A_igrpt">igrpt</code></td>
<td>
<p>should <code>sorter</code> (ig)nore (r)e(p)ea(t)ed values for each row in <code>lc$y</code> for sorting purposes? See <code><a href="#topic+norpt">norpt</a></code>.</p>
</td></tr>
<tr><td><code id="sorter_+3A_customsort">customSort</code></td>
<td>

<p>a vector of the same length as the number of rows in <code>lc$y</code> providing a user defined variable on which to sort the data prior to secondarily applying the default sort. If <code>group</code> is not <code>NULL</code>, group will be sorted on prior to the <code>customSort</code> variable. Alternatively, <code>lc$y</code> can be sorted without calling <code>sorter</code> using <code>lc$y.sorted &lt;- lc$y[o, ]</code> where <code>o</code> is the <code><a href="base.html#topic+order">order</a></code> (e.g., use <code>o &lt;- <a href="base.html#topic+order">order</a>(customSort)</code>). The user must also set <code>lc$sorted &lt;- TRUE</code> to prevent on-the-fly default sorting from being carried out by <code><a href="#topic+longCatPlot">longCatPlot</a></code>. Users unfamiliar with sorting in <code>R</code> should take care not to confuse <code><a href="base.html#topic+order">order</a></code> with <code><a href="base.html#topic+sort">sort</a></code>. Default is <code>NULL</code>. If any values on <code>customSort</code> are missing, the function will return an error message.
</p>
</td></tr>
<tr><td><code id="sorter_+3A_initfirst">initFirst</code></td>
<td>
<p>if <code>customSort</code> is not <code>NULL</code>, setting <code>initFirst=TRUE</code> will sort on initial values prior to the custom sorting variable.</p>
</td></tr>
<tr><td><code id="sorter_+3A_group">group</code></td>
<td>

<p>a vector of the same length as the number of rows in <code>lc$y</code> indicating group membership. Default is <code>NULL</code>. If <code>group</code> is <code>NA</code>, corresponding rows in <code>lc$y</code> will be deleted prior to completing the sorting, and a warning indicating this has been done is printed to the console. If a large number of cases have missing data on the grouping variable, consider recoding the missings into their own group, e.g., <code>group[is.na(group)] &lt;- -999</code> and add a missing label to <code>groupLabels</code>, e.g. <code>groupLabels=c('Missing', 'Group1', 'Group2', 'Etc.')</code>.
</p>
</td></tr>
<tr><td><code id="sorter_+3A_grouplabels">groupLabels</code></td>
<td>

<p>a vector of numeric or character labels of the same length as the number of unique values in <code>group</code>. Default is <code>NULL</code>. If <code>group</code> is not <code>NULL</code> and <code>groupLabels</code> is not provided, then the numeric values in <code>group</code> are used as the labels.
</p>
</td></tr>
<tr><td><code id="sorter_+3A_ggap">ggap</code></td>
<td>

<p>a number zero to 1. The proportion of blank rows to be plotted between groups when <code>group</code> is specified. The default of <code>NULL</code> is set to 0.05 when groups are present, 0.0 when there are no groups.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class <code>longCat</code> where <code>lc$sorted=TRUE</code>. See <code><a href="#topic+longCat">longCat</a></code> for values.
</p>


<h3>Author(s)</h3>

<p>Stephen Tueller
</p>


<h3>References</h3>

<p>Tueller, S. J., Van Dorn, R. A., &amp; Bobashev, G. V. (2016). Visualization of categorical longitudinal and times series data (Report No. MR-0033-1602). Research Triangle Park, NC: RTI Press. http://www.rti.org/publication/visualization-categorical-longitudinal-and-times-series-data</p>


<h3>See Also</h3>

<p><code><a href="#topic+longCat">longCat</a></code> and <code><a href="#topic+longCatPlot">longCatPlot</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### create a plot like that in Figure 3 from Tueller, Van Dorn, &amp; Bobashev (2016)
par(mfrow=c(1,2), bg='cornsilk3')
times &lt;- c(1,100,200,300,400,500,600)
f3lc &lt;- longCat(example3, times); f3lc$sorted &lt;- TRUE; f3lc$y.sorted &lt;- f3lc$y
longCatPlot(f3lc, main='Unsorted', colScheme='heat', lwd=2, legendBuffer=.2)
f3lc &lt;- longCat(example3, times)
longCatPlot(f3lc, main='Sorted', colScheme='heat', lwd=2, legendBuffer=.2)

### sort with a grouping variable and plot
par(mfrow=c(1,1), bg='cornsilk3', mar=c(5.1, 4.1, 4.1, 9.1), xpd=TRUE)
times &lt;- c(1,100,200,300,400,500,600)
lc &lt;- longCat(example3, times)
group &lt;- sample(1:3, nrow(example3), replace=TRUE)
grouplc &lt;- sorter(lc, group=group, groupLabels=1:3)
cols &lt;- longCatPlot(grouplc, groupBuffer=.15, main='Grouped Data', colScheme='heat', 
                    lwd=2, legendBuffer=0)
legend(610, 130, legend=1:5, col=cols, lty=1, lwd=2)
par(bg='transparent', mar = c(5, 4, 4, 2) + 0.1, xpd=FALSE)

### using the sorted data from the previous plot, repeate using ggplot2 
#   following the example of Figure 4 of bdemarest's answer on 
#   https://stackoverflow.com/questions/11513149/
#   good-ways-to-visualize-longitudinal-categorical-data-in-r/
grouplc.df &lt;- data.frame(id=1:nrow(grouplc$group.sorted), 
                group=grouplc$group.sorted[,1], grouplc$y.sorted)
grouplc.long &lt;- reshape(grouplc.df,
                        varying = names(grouplc$y.sorted),
                        v.names = "score",
                        timevar = "time",
                        times = times[1:ncol(grouplc$y.sorted)],
                        direction = "long")
grouplc.long$score &lt;- factor(grouplc.long$score)
grouplc.long$group &lt;- factor(grouplc.long$group, level=3:1)
# remove NA's introduced using group option in sorter
grouplc.long &lt;- na.omit(grouplc.long) 
library(ggplot2)
ggplot(grouplc.long, aes(x=time, y=id, fill=score)) + 
  geom_tile(colour="transparent") +
  scale_fill_manual(values=cols) +
  facet_grid(group ~ ., space="free_y", scales="free_y")

### sort with a grouping variable and events and plot
times &lt;- c(1,100,200,300,400,500,600)
set.seed(45962)
events &lt;- matrix(sample(1:3, nrow(example3)*2, replace=TRUE), nrow(example3), 2)
set.seed(23498)
event.times &lt;- matrix(sample(min(times):max(times), nrow(example3)*2, replace=TRUE), 
nrow(example3), 2)
labels &lt;- c('Street', 'Drug Tx', 'Jail', 'Prison', 'Unknown')
eventLabels=c('Arrest', 'Drug Test', 'Hearing')
eventlc &lt;- longCat(example3, times=times, Labels=labels,  
              events=events, event.times=event.times, 
              eventLabels=eventLabels)
set.seed(4290)              
groupevent &lt;- sample(1:3, nrow(example3), replace=TRUE)
groupeventlc &lt;- sorter(eventlc, group=groupevent)            
par(mfrow=c(1,1), bg='cornsilk3', mar=c(5.1, 4.1, 4.1, 12.1), xpd=TRUE)
cols &lt;- longCatPlot(groupeventlc, legendBuffer=0, groupBuffer=0.15, 
                    main='Grouping and Events')
legend(610, 130, legend=groupeventlc$Labels, lty=1, col=cols, lwd=2)
legend(610, 60, legend=groupeventlc$eventLabels, 
       pch=1:length(groupeventlc$eventLabels))
par(bg='transparent', mar = c(5, 4, 4, 2) + 0.1, xpd=FALSE)

</code></pre>

<hr>
<h2 id='summary-methods'> ~~ Methods for Function <code>summary</code>  ~~</h2><span id='topic+summary-methods'></span><span id='topic+summary+2CANY-method'></span><span id='topic+summary+2ClongCat-method'></span>

<h3>Description</h3>

<p>~~ Methods for function <code>summary</code>  ~~
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(object = "ANY")</code></dt><dd>
</dd>
<dt><code>signature(object = "longCat")</code></dt><dd>
</dd>
</dl>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
