<!DOCTYPE html><html><head><title>Help for package bayfoxr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bayfoxr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bassriver'><p>Bass River planktic foraminiferal calcite d18O.</p></a></li>
<li><a href='#get_available_forams'><p>Parse trace dataframe column names to get vector of available forams.</p></a></li>
<li><a href='#get_draws'><p>Get MCMC trace draws.</p></a></li>
<li><a href='#plot.prediction'><p>Plot a <code>prediction</code> object.</p></a></li>
<li><a href='#predict_d18oc'><p>Predict d18O of foram calcite given seawater temperature and seawater d18O.</p></a></li>
<li><a href='#predict_seatemp'><p>Predict sea-surface temperature given d18O of foram calcite and seawater d18O.</p></a></li>
<li><a href='#prediction'><p>Constructor for S3 prediction class.</p></a></li>
<li><a href='#predictplot'><p>Simple plot of <code>prediction</code> with intervals.</p></a></li>
<li><a href='#quantile.prediction'><p>Quantiles for a <code>prediction</code>.</p></a></li>
<li><a href='#target_timeseries_pred'><p>Internal function for 'predict_seatemp()'.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Global Bayesian Foraminifera Core Top Calibration</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>A Bayesian, global planktic foraminifera core top calibration to 
    modern sea-surface temperatures. Includes four calibration models, 
    considering species-specific calibration parameters and seasonality.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/brews/bayfoxr/">https://github.com/brews/bayfoxr/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/brews/bayfoxr/issues">https://github.com/brews/bayfoxr/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-02-01 21:15:18 UTC; sbm</td>
</tr>
<tr>
<td>Author:</td>
<td>Steven Malevich [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Steven Malevich &lt;malevich@email.arizona.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-02-06 15:53:33 UTC</td>
</tr>
</table>
<hr>
<h2 id='bassriver'>Bass River planktic foraminiferal calcite d18O.</h2><span id='topic+bassriver'></span>

<h3>Description</h3>

<p>A data set containing marine sediment core samples from the Paleocene-Eocene 
Thermal Maximum (PETM) section with well preservedforaminifera calcite d18O.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bassriver
</code></pre>


<h3>Format</h3>

<p>A data frame with 62 rows and 2 column variables:
</p>

<dl>
<dt>depth</dt><dd><p>marine sediment down-core sample depth, in m</p>
</dd>
<dt>d18o</dt><dd><p><em>Morozovella spp.</em> shell calcite d18O, in ‰ VPDB</p>
</dd>
</dl>


<h3>Source</h3>

<p>John, C. M., S. M. Bohaty, J. C. Zachos, A. Sulijs, S. Gibbs, H. 
Brinkhuis, and T. J. Bralower (2008), North American continental margin 
records of the Paleocene-Eocene thermal maximum: Implications for global 
carbon and hydrological cycling, <em>Paleoceanography</em>, 23(2), 
doi:10.1029/2007PA001465.
</p>

<hr>
<h2 id='get_available_forams'>Parse trace dataframe column names to get vector of available forams.</h2><span id='topic+get_available_forams'></span>

<h3>Description</h3>

<p>Parse trace dataframe column names to get vector of available forams.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_available_forams(d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_available_forams_+3A_d">d</code></td>
<td>
<p>Data frame containing MCMC trace draws. Column names are model 
parameters with foram group name separated from model parameters name by &quot;__&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector of available foram names.
</p>

<hr>
<h2 id='get_draws'>Get MCMC trace draws.</h2><span id='topic+get_draws'></span>

<h3>Description</h3>

<p>Get MCMC trace draws.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_draws(foram = NULL, seasonal_seatemp = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_draws_+3A_foram">foram</code></td>
<td>
<p>Optional. String or <code>NULL</code>. String indicating the foram 
species/subspecies to infer for hierarchical models. String must be one of 
&quot;G. bulloides&quot;, &quot;G. ruber white&quot;, &quot;G. ruber pink&quot;, &quot;G. sacculifer&quot;, 
&quot;N. incompta&quot;, or &quot;N. pachyderma sinistral&quot;. <code>NULL</code> indicates that a 
pooled model is desired.</p>
</td></tr>
<tr><td><code id="get_draws_+3A_seasonal_seatemp">seasonal_seatemp</code></td>
<td>
<p>Optional boolean indicating whether to use the seasonal 
sea-surface temperature calibrations. Default is <code>FALSE</code>, i.e. using 
annual SST calibrations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Four calibration models are available: an &quot;annual pooled&quot; model, a 
&quot;seasonal pooled&quot; model, an &quot;annual hierarchical&quot; model, and a 
&quot;seasonal hierarchical&quot; model. This function uses magic to determine which 
&quot;pooled annual&quot; model is used. Which is the simplest case with potential use 
for Deep Time reconstructions of nonexant foram species. Giving a valid string 
for <code>foram</code> will use a hierarchical model, which has foram-specific 
variability in calibration model parameters. Passing <code>TRUE</code> for 
<code>seasonal_seatemp</code> will use a model trained on season sea-surface 
temperatures. See reference paper for further details.
</p>


<h3>Value</h3>

<p>Data frame with columns &quot;alpha&quot;, &quot;beta&quot;, &quot;tau&quot;. Which are equal-length 
vectors of model parameter draws.
</p>

<hr>
<h2 id='plot.prediction'>Plot a <code>prediction</code> object.</h2><span id='topic+plot.prediction'></span>

<h3>Description</h3>

<p>Plot a <code>prediction</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'prediction'
plot(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.prediction_+3A_...">...</code></td>
<td>
<p>Arguments passed on to <code>predictplot</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+predictplot">predictplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bassriver)

# Using the "pooled annual" calibration model:
sst &lt;- predict_seatemp(bassriver$d18o, d18osw=0.0, 
                       prior_mean=30.0, prior_std=20.0)

predictplot(x=bassriver$depth, y=sst, ylim=c(20, 40), 
            ylab="SST (°C)", xlab="Depth (m)")

</code></pre>

<hr>
<h2 id='predict_d18oc'>Predict d18O of foram calcite given seawater temperature and seawater d18O.</h2><span id='topic+predict_d18oc'></span>

<h3>Description</h3>

<p>Predict d18O of foram calcite given seawater temperature and seawater d18O.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_d18oc(seatemp, d18osw, foram = NULL, seasonal_seatemp = FALSE,
  drawsfun = get_draws)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_d18oc_+3A_seatemp">seatemp</code></td>
<td>
<p>Numeric or vector of observed sea-surface temperatures (°C).</p>
</td></tr>
<tr><td><code id="predict_d18oc_+3A_d18osw">d18osw</code></td>
<td>
<p>Numeric or vector of observed seawater d18O (‰ VSMOW).</p>
</td></tr>
<tr><td><code id="predict_d18oc_+3A_foram">foram</code></td>
<td>
<p>Optional. String or <code>NULL</code>. String indicating the foram 
species/subspecies to infer for hierarchical models. String must be one of 
&quot;G. bulloides&quot;, &quot;G. ruber&quot;, &quot;T. sacculifer&quot;, &quot;N. incompta&quot;, or 
&quot;N. pachyderma&quot;. <code>NULL</code> indicates that a pooled model is desired.</p>
</td></tr>
<tr><td><code id="predict_d18oc_+3A_seasonal_seatemp">seasonal_seatemp</code></td>
<td>
<p>Optional boolean indicating whether to use the seasonal 
sea-surface temperature calibrations. Default is <code>FALSE</code>, i.e. using 
annual SST calibrations.</p>
</td></tr>
<tr><td><code id="predict_d18oc_+3A_drawsfun">drawsfun</code></td>
<td>
<p>Optional function used to get get model parameter draws. Must 
take arguments for &quot;foram&quot; and &quot;seasonal_seatemp&quot; and return a list with 
members &quot;alpha&quot;, &quot;beta&quot;, &quot;tau&quot;. This is for debugging and testing. See 
<code><a href="#topic+get_draws">get_draws</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Four calibration models are available: an &quot;annual pooled&quot; model, a 
&quot;seasonal pooled&quot; model, an &quot;annual hierarchical&quot; model, and a 
&quot;seasonal hierarchical&quot; model. This function uses magic to determine which 
&quot;pooled annual&quot; model is used. Which is the simplest case with potential use 
for Deep Time reconstructions of nonexant foram species. Giving a valid string 
for <code>foram</code> will use a hierarchical model, which has foram-specific 
variability in calibration model parameters. Passing <code>TRUE</code> for 
<code>seasonal_seatemp</code> will use a model trained on season sea-surface 
temperatures. See reference paper for further details.
</p>


<h3>Value</h3>

<p>A <code>prediction</code> instance for inferred foraminiferal calcite 
d18O (‰ VPDB).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict_seatemp">predict_seatemp</a></code>, <code><a href="#topic+predictplot">predictplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Infer d18Oc for a G. bulloides core top sample using annual hierarchical model.
# The true, d18Oc for this sample is -2.16 (‰ VPDB).
delo_ann &lt;- predict_d18oc(seatemp=28.6, d18osw=0.48, foram="G. bulloides")
head(quantile(delo_ann, probs=c(0.159, 0.5, 0.841)))  # ± 1 standard deviation

# Now using seasonal hierarchical model:
delo_sea &lt;- predict_d18oc(seatemp=28.6, d18osw=0.48, foram="G. bulloides",
                          seasonal_seatemp = TRUE)
head(quantile(delo_sea, probs=c(0.159, 0.5, 0.841)))  # ± 1 standard deviation

</code></pre>

<hr>
<h2 id='predict_seatemp'>Predict sea-surface temperature given d18O of foram calcite and seawater d18O.</h2><span id='topic+predict_seatemp'></span>

<h3>Description</h3>

<p>Predict sea-surface temperature given d18O of foram calcite and seawater d18O.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_seatemp(d18oc, d18osw, prior_mean, prior_std, foram = NULL,
  seasonal_seatemp = FALSE, drawsfun = get_draws)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_seatemp_+3A_d18oc">d18oc</code></td>
<td>
<p>Numeric or vector of observed foram calcite d18O (‰ VPDB).</p>
</td></tr>
<tr><td><code id="predict_seatemp_+3A_d18osw">d18osw</code></td>
<td>
<p>Numeric or vector of observed seawater d18O (‰ VSMOW).</p>
</td></tr>
<tr><td><code id="predict_seatemp_+3A_prior_mean">prior_mean</code></td>
<td>
<p>Numeric indicating prior mean for sea-surface temperature (°C).</p>
</td></tr>
<tr><td><code id="predict_seatemp_+3A_prior_std">prior_std</code></td>
<td>
<p>Numeric indicating prior standard deviation for sea-surface 
temperature (°C).</p>
</td></tr>
<tr><td><code id="predict_seatemp_+3A_foram">foram</code></td>
<td>
<p>Optional. String or <code>NULL</code>. String indicating the foram 
species/subspecies to infer for hierarchical models. String must be one of 
&quot;G. bulloides&quot;, &quot;G. ruber&quot;, &quot;T. sacculifer&quot;, &quot;N. incompta&quot;, or 
&quot;N. pachyderma&quot;. <code>NULL</code> indicates that a pooled model is desired.</p>
</td></tr>
<tr><td><code id="predict_seatemp_+3A_seasonal_seatemp">seasonal_seatemp</code></td>
<td>
<p>Optional boolean indicating whether to use the seasonal 
sea-surface temperature calibrations. Default is <code>FALSE</code>, i.e. using 
annual SST calibrations.</p>
</td></tr>
<tr><td><code id="predict_seatemp_+3A_drawsfun">drawsfun</code></td>
<td>
<p>Optional function used to get get model parameter draws. Must 
take arguments for &quot;foram&quot; and &quot;seasonal_seatemp&quot; and return a list with 
members &quot;alpha&quot;, &quot;beta&quot;, &quot;tau&quot;. This is for debugging and testing.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Four calibration models are available: an &quot;annual pooled&quot; model, a 
&quot;seasonal pooled&quot; model, an &quot;annual hierarchical&quot; model, and a 
&quot;seasonal hierarchical&quot; model. This function uses magic to determine which 
&quot;pooled annual&quot; model is used. Which is the simplest case with potential use 
for Deep Time reconstructions of nonexant foram species. Giving a valid string 
for <code>foram</code> will use a hierarchical model, which has foram-specific 
variability in calibration model parameters. Passing <code>TRUE</code> for 
<code>seasonal_seatemp</code> will use a model trained on season sea-surface 
temperatures. See reference paper for further details.
</p>


<h3>Value</h3>

<p>A <code>prediction</code> instance for inferred sea-surface temperature (°C).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict_d18oc">predict_d18oc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bassriver)

# Using the "pooled annual" calibration model:
sst &lt;- predict_seatemp(bassriver$d18o, d18osw=0.0, 
                       prior_mean=30.0, prior_std=20.0)
head(quantile(sst))  # Show only the top few values

predictplot(x=bassriver$depth, y=sst, ylim=c(20, 40), 
            ylab="SST (°C)", xlab="Depth (m)")

</code></pre>

<hr>
<h2 id='prediction'>Constructor for S3 prediction class.</h2><span id='topic+prediction'></span>

<h3>Description</h3>

<p>Constructor for S3 prediction class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prediction(ensemble)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prediction_+3A_ensemble">ensemble</code></td>
<td>
<p>A matrix (m x n) of the prediciton posteriors. Where m is the 
number of values inferred and n is the number of trace draws.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>prediction</code> object.
</p>

<hr>
<h2 id='predictplot'>Simple plot of <code>prediction</code> with intervals.</h2><span id='topic+predictplot'></span>

<h3>Description</h3>

<p>Simple plot of <code>prediction</code> with intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predictplot(y, x = NULL, probs = c(0.05, 0.5, 0.95),
  poly_col = grDevices::rgb(0, 0, 0, 0.1), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predictplot_+3A_y">y</code></td>
<td>
<p>A <code>prediction</code> object to plot.</p>
</td></tr>
<tr><td><code id="predictplot_+3A_x">x</code></td>
<td>
<p>Optional vector or NULL, indicating were <code>prediction</code> 
inferences fall along x-axis. Must be the same length as the inferred values 
in <code>y</code>.</p>
</td></tr>
<tr><td><code id="predictplot_+3A_probs">probs</code></td>
<td>
<p>Optional 3-member Vector of numerics indicating low, middle, and 
high probability intervals to plot. All must be &lt;= 1.</p>
</td></tr>
<tr><td><code id="predictplot_+3A_poly_col">poly_col</code></td>
<td>
<p>Optional color for interval polygon.</p>
</td></tr>
<tr><td><code id="predictplot_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(bassriver)

# Using the "pooled annual" calibration model:
sst &lt;- predict_seatemp(bassriver$d18o, d18osw=0.0, 
                       prior_mean=30.0, prior_std=20.0)

predictplot(x=bassriver$depth, y=sst, ylim=c(20, 40), 
            ylab="SST (°C)", xlab="Depth (m)")

</code></pre>

<hr>
<h2 id='quantile.prediction'>Quantiles for a <code>prediction</code>.</h2><span id='topic+quantile.prediction'></span>

<h3>Description</h3>

<p>Quantiles for a <code>prediction</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'prediction'
quantile(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quantile.prediction_+3A_x">x</code></td>
<td>
<p>A <code>prediction</code> object.</p>
</td></tr>
<tr><td><code id="quantile.prediction_+3A_...">...</code></td>
<td>
<p>Arguments to be passed on to <code>quantile</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='target_timeseries_pred'>Internal function for 'predict_seatemp()'.</h2><span id='topic+target_timeseries_pred'></span>

<h3>Description</h3>

<p>Internal function for 'predict_seatemp()'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>target_timeseries_pred(d18osw_now, alpha_now, beta_now, tau_now, proxy_ts,
  prior_mu, prior_inv_cov)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="target_timeseries_pred_+3A_d18osw_now">d18osw_now</code></td>
<td>
<p>Numeric or vector giving seawater d18O. Note, should be in 
units (‰ VPDB).</p>
</td></tr>
<tr><td><code id="target_timeseries_pred_+3A_alpha_now">alpha_now</code></td>
<td>
<p>Numeric, alpha model parameter.</p>
</td></tr>
<tr><td><code id="target_timeseries_pred_+3A_beta_now">beta_now</code></td>
<td>
<p>Numeric, beta model parameter.</p>
</td></tr>
<tr><td><code id="target_timeseries_pred_+3A_tau_now">tau_now</code></td>
<td>
<p>Numeric, tau model parameter.</p>
</td></tr>
<tr><td><code id="target_timeseries_pred_+3A_proxy_ts">proxy_ts</code></td>
<td>
<p>Numeric or vector of proxy time series (foram d18O).</p>
</td></tr>
<tr><td><code id="target_timeseries_pred_+3A_prior_mu">prior_mu</code></td>
<td>
<p>Matrix (n X 1) giving prior mean.</p>
</td></tr>
<tr><td><code id="target_timeseries_pred_+3A_prior_inv_cov">prior_inv_cov</code></td>
<td>
<p>Matrix (n X x) giving prior inverse covariance matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Sample of time time series vector conditional on the other args
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
