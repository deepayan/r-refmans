<!DOCTYPE html><html lang="en"><head><title>Help for package digiRhythm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {digiRhythm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#actogram'><p>Plot a an single actogram over a period of time for a specific variable</p></a></li>
<li><a href='#daily_activity_wrap_plot'><p>Plot daily average over a period of time for a specific variable.</p></a></li>
<li><a href='#daily_average_activity'><p>Plot daily average over a period of time for a specific variable.</p></a></li>
<li><a href='#df_act_info'><p>Outputs some information about the activity dataframe</p></a></li>
<li><a href='#df516b_2'><p>df516b_2 Activity Data Sets</p></a></li>
<li><a href='#df603'><p>df603 Activity Data Sets</p></a></li>
<li><a href='#df625'><p>df625 Activity Data Sets</p></a></li>
<li><a href='#df678_2'><p>df678_2 Activity Data Sets</p></a></li>
<li><a href='#df689b_3'><p>df689b_3 Activity Data Sets</p></a></li>
<li><a href='#df691b_1'><p>df691b_1 Activity Data Sets</p></a></li>
<li><a href='#df759a_3'><p>df759a_3 Activity Data Sets</p></a></li>
<li><a href='#dfc'><p>Computes the Degree of Function coupling (DFC), Harmonic Part (HP) and Weekly</p>
Lomb-Scargle Spectrum (LSP Spec) for one variable in an activity dataset.
The dataset should be digiRhythm friendly.</a></li>
<li><a href='#dgm_periodicity'><p>Returns the periodicity of a digiRhythm dataframe</p></a></li>
<li><a href='#diurnality'><p>Computes the diurnality index based on an activity dataframe</p></a></li>
<li><a href='#diurnality_customTimes'><p>Computes the diurnality index, using different start and end definitions for</p>
each day and night, based on an activity dataframe</a></li>
<li><a href='#highest_possible_harm_cutoff'><p>Function to calculate the smallest possible harmonic to consider given</p>
a sampling frequency. The minimum possible harmonic = 2 x the period of the
maximum frequency according to the Shanon theorem. Example: if the sampling
period is 15 min, the minimum possible treatable period is 30 minutes and
that corresponds to the 48th harmonic (24 hours * 60 minutes / 48 =
30 minutes)</a></li>
<li><a href='#import_raw_activity_data'><p>Reads Raw Activity Data from csv files</p></a></li>
<li><a href='#is_dgm_friendly'><p>Informs if a dataset is digiRhythm Friendly</p></a></li>
<li><a href='#levopt'><p>Returns the level given the p-value computed with pbaluev (2008). Copied from</p>
the LOMB library.</a></li>
<li><a href='#lomb_scargle_periodogram'><p>Computes the Lomb Scargle Periodogram and returns the information needed for</p>
computing the DFC and HP. A plot visualizing the Harmonic Frequencies
presence in the spectrum is possible. The function is inspired from the Lomb
library in a great part, with modifications to fit the requirements of
harmonic powers and computation of the DFC. This function is inspired by the
lsp function from the lomb package and adapted to add different colors for
harmonic and non harmonic frequencies in the signal. For more information
about lomb::lsp, please refer
to: https://cran.r-project.org/web/packages/lomb/</a></li>
<li><a href='#pbaluev'><p>Returns p-value of a frequency peak according to pbaluev (2008) given Z,</p>
fmax and tm. Reused from the LOMB library (https://rdrr.io/cran/lomb/)</a></li>
<li><a href='#print_v'><p>Print if Verbose is true</p></a></li>
<li><a href='#remove_activity_outliers'><p>Remove outliers from the data</p></a></li>
<li><a href='#resample_dgm'><p>Change the sampling of a digiRhythm friendly dataset</p></a></li>
<li><a href='#timedata'><p>timedata Dataset of start and end of day and night</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analyzing Animal's Rhythmicity</td>
</tr>
<tr>
<td>Version:</td>
<td>2.4</td>
</tr>
<tr>
<td>Author:</td>
<td>Hassan-Roland Nasser [aut, cre],
  Marie Schneider [aut, ctb],
  Joanna Stachowicz [aut, rev],
  Christina Umstaetter [aut, ths]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hassan-Roland Nasser &lt;hassan.nasser@me.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Analyze and visualize the rhythmic behavior of animals using the 
  degree of functional coupling (See Scheibe (1999) &lt;<a href="https://doi.org/10.1076%2Fbrhm.30.2.216.1420">doi:10.1076/brhm.30.2.216.1420</a>&gt;),
  compute and visualize harmonic power, actograms, average activity and diurnality 
  index.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>tidyr, readr (&ge; 2.0.1), magrittr, dplyr, xts, pracma,
ggplot2, lubridate, stringr, zoo, crayon, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0), usethis</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://nasserdr.github.io/digiRhythm/">https://nasserdr.github.io/digiRhythm/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-19 07:15:03 UTC; f80859433</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-19 07:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='actogram'>Plot a an single actogram over a period of time for a specific variable</h2><span id='topic+actogram'></span>

<h3>Description</h3>

<p>Takes an activity dataset as input and plot and save an actogram of the
specified activity column
</p>


<h3>Usage</h3>

<pre><code class='language-R'>actogram(df, activity, activity_alias, start, end, save = "actogram")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="actogram_+3A_df">df</code></td>
<td>
<p>The dataframe containing the activity data</p>
</td></tr>
<tr><td><code id="actogram_+3A_activity">activity</code></td>
<td>
<p>the name of activity</p>
</td></tr>
<tr><td><code id="actogram_+3A_activity_alias">activity_alias</code></td>
<td>
<p>A string containing the name of the activity to be
shown on the graph.</p>
</td></tr>
<tr><td><code id="actogram_+3A_start">start</code></td>
<td>
<p>The start day (in &quot;%Y-%m-%d&quot; format).</p>
</td></tr>
<tr><td><code id="actogram_+3A_end">end</code></td>
<td>
<p>The end day (in &quot;%Y-%m-%d&quot; format).</p>
</td></tr>
<tr><td><code id="actogram_+3A_save">save</code></td>
<td>
<p>if NULL, the image is not saved. Otherwise, this parameter will
be the name of the saved image. it should contain the path and name without
the extension.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 object that contains the actogram plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("df516b_2")
df &lt;- df516b_2
activity &lt;- names(df)[2]
start &lt;- "2020-05-01" # year-month-day
end &lt;- "2020-08-13" # year-month-day
activity_alias &lt;- "Motion Index"
my_actogram &lt;- actogram(df, activity, activity_alias, start, end,
  save = NULL
)
print(my_actogram)
</code></pre>

<hr>
<h2 id='daily_activity_wrap_plot'>Plot daily average over a period of time for a specific variable.</h2><span id='topic+daily_activity_wrap_plot'></span>

<h3>Description</h3>

<p>Takes an activity dataset as input and plot and save the daily average of the
specified activity column
</p>


<h3>Usage</h3>

<pre><code class='language-R'>daily_activity_wrap_plot(
  df,
  activity,
  activity_alias,
  start,
  end,
  sampling_rate,
  ncols,
  save = "daily_wrap_plot"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="daily_activity_wrap_plot_+3A_df">df</code></td>
<td>
<p>The dataframe containing the activity data</p>
</td></tr>
<tr><td><code id="daily_activity_wrap_plot_+3A_activity">activity</code></td>
<td>
<p>the name of activity</p>
</td></tr>
<tr><td><code id="daily_activity_wrap_plot_+3A_activity_alias">activity_alias</code></td>
<td>
<p>A string containing the name of the activity to be
shown on the graph.</p>
</td></tr>
<tr><td><code id="daily_activity_wrap_plot_+3A_start">start</code></td>
<td>
<p>The start day (in &quot;%Y-%m-%d&quot; format).</p>
</td></tr>
<tr><td><code id="daily_activity_wrap_plot_+3A_end">end</code></td>
<td>
<p>The end day (in &quot;%Y-%m-%d&quot; format).</p>
</td></tr>
<tr><td><code id="daily_activity_wrap_plot_+3A_sampling_rate">sampling_rate</code></td>
<td>
<p>the sampling rate of the data.</p>
</td></tr>
<tr><td><code id="daily_activity_wrap_plot_+3A_ncols">ncols</code></td>
<td>
<p>the number of columns to spread the graphs on.
be the name of the saved image. it should contain the path and name without
the extension.</p>
</td></tr>
<tr><td><code id="daily_activity_wrap_plot_+3A_save">save</code></td>
<td>
<p>if NULL, the image is not saved. Otherwise, this parameter will</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 object that contains the daily average activity plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("df516b_2")
df &lt;- df516b_2
activity &lt;- names(df)[2]
activity_alias &lt;- "Motion Index"
start &lt;- "2020-05-01" # year-month-day
end &lt;- "2020-05-07" # year-month-day
ncols &lt;- 3
sampling_rate &lt;- 30
my_dwp &lt;- daily_activity_wrap_plot(
  df, activity, activity_alias, start, end, sampling_rate,
  ncols
)
</code></pre>

<hr>
<h2 id='daily_average_activity'>Plot daily average over a period of time for a specific variable.</h2><span id='topic+daily_average_activity'></span>

<h3>Description</h3>

<p>Takes an activity dataset as input and plot and save the daily average of the
specified activity column
</p>


<h3>Usage</h3>

<pre><code class='language-R'>daily_average_activity(df, activity, activity_alias, start, end, save)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="daily_average_activity_+3A_df">df</code></td>
<td>
<p>The dataframe containing the activity data</p>
</td></tr>
<tr><td><code id="daily_average_activity_+3A_activity">activity</code></td>
<td>
<p>the name of activity</p>
</td></tr>
<tr><td><code id="daily_average_activity_+3A_activity_alias">activity_alias</code></td>
<td>
<p>A string containing the name of the activity to be
shown on the graph.</p>
</td></tr>
<tr><td><code id="daily_average_activity_+3A_start">start</code></td>
<td>
<p>The start day (in &quot;%Y-%m-%d&quot; format).</p>
</td></tr>
<tr><td><code id="daily_average_activity_+3A_end">end</code></td>
<td>
<p>The end day (in &quot;%Y-%m-%d&quot; format).</p>
</td></tr>
<tr><td><code id="daily_average_activity_+3A_save">save</code></td>
<td>
<p>if NULL, the image is not saved. Otherwise, this parameter will
be the name of the saved image. it should contain the path and name without
the extension.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("df516b_2")
df &lt;- df516b_2
activity &lt;- names(df)[2]
start &lt;- "2020-05-01" # year-month-day
end &lt;- "2020-08-13" # year-month-day
activity_alias &lt;- "Motion Index"
my_daa &lt;- daily_average_activity(df, activity, activity_alias, start, end,
  save = NULL
)
print(my_daa)
</code></pre>

<hr>
<h2 id='df_act_info'>Outputs some information about the activity dataframe</h2><span id='topic+df_act_info'></span>

<h3>Description</h3>

<p>Outputs some information about the activity dataframe
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_act_info(df)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df_act_info_+3A_df">df</code></td>
<td>
<p>The dataframe containing the activity data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. Prints the head and tail as well as the starting and
end date of a digiRhythm friendly dataframe.
</p>

<hr>
<h2 id='df516b_2'>df516b_2 Activity Data Sets</h2><span id='topic+df516b_2'></span>

<h3>Description</h3>

<p>A dataset containing the Motion index and steps count of a cow.
The data set is sampled with 15 minutes samples. The data is as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df516b_2
</code></pre>


<h3>Format</h3>

<p>A data frame of 3 columns
</p>

<dl>
<dt>datetime</dt><dd><p>a POSIX formatted datetime</p>
</dd>
<dt>Motion.Index</dt><dd><p>The motion index of the cow during the time sample</p>
</dd>
<dt>Steps</dt><dd><p>The number of steps during the time sample</p>
</dd>
</dl>



<h3>Source</h3>

<p>Agroscope Tanikon
</p>

<hr>
<h2 id='df603'>df603 Activity Data Sets</h2><span id='topic+df603'></span>

<h3>Description</h3>

<p>A dataset containing the x and y acceleration from an accelerometer installed
on a cattle. There are missing days in this dataset.
The data set is sampled with 15 minutes samples. The data is as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df603
</code></pre>


<h3>Format</h3>

<p>A data frame of 3 columns
</p>

<dl>
<dt>datetime</dt><dd><p>a POSIX formatted datetime</p>
</dd>
<dt>move_x</dt><dd><p>The acceleration along the x axis</p>
</dd>
<dt>move_y</dt><dd><p>The acceleration along the y axis</p>
</dd>
</dl>



<h3>Source</h3>

<p>Agroscope Posieux
</p>

<hr>
<h2 id='df625'>df625 Activity Data Sets</h2><span id='topic+df625'></span>

<h3>Description</h3>

<p>A dataset containing the x and y acceleration from an accelerometer installed
on a cattle. There are missing days in this dataset.
The data set is sampled with 15 minutes samples. The data is as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df625
</code></pre>


<h3>Format</h3>

<p>A data frame of 3 columns
</p>

<dl>
<dt>datetime</dt><dd><p>a POSIX formatted datetime</p>
</dd>
<dt>move_x</dt><dd><p>The acceleration along the x axis</p>
</dd>
<dt>move_y</dt><dd><p>The acceleration along the y axis</p>
</dd>
</dl>



<h3>Source</h3>

<p>Agroscope Posieux
</p>

<hr>
<h2 id='df678_2'>df678_2 Activity Data Sets</h2><span id='topic+df678_2'></span>

<h3>Description</h3>

<p>A dataset containing the Motion index and steps count of a cow.
The data set is sampled with 15 minutes samples. The data is as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df678_2
</code></pre>


<h3>Format</h3>

<p>A data frame of 3 columns
</p>

<dl>
<dt>datetime</dt><dd><p>a POSIX formatted datetime</p>
</dd>
<dt>Motion.Index</dt><dd><p>The motion index of the cow during the time sample</p>
</dd>
<dt>Steps</dt><dd><p>The number of steps during the time sample</p>
</dd>
</dl>



<h3>Source</h3>

<p>Agroscope Tanikon
</p>

<hr>
<h2 id='df689b_3'>df689b_3 Activity Data Sets</h2><span id='topic+df689b_3'></span>

<h3>Description</h3>

<p>A dataset containing the Motion index and steps count of a cow.
The data set is sampled with 15 minutes samples. The data is as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df689b_3
</code></pre>


<h3>Format</h3>

<p>A data frame of 3 columns
</p>

<dl>
<dt>datetime</dt><dd><p>a POSIX formatted datetime</p>
</dd>
<dt>Motion.Index</dt><dd><p>The motion index of the cow during the time sample</p>
</dd>
<dt>Steps</dt><dd><p>The number of steps during the time sample</p>
</dd>
</dl>



<h3>Source</h3>

<p>Agroscope Tanikon
</p>

<hr>
<h2 id='df691b_1'>df691b_1 Activity Data Sets</h2><span id='topic+df691b_1'></span>

<h3>Description</h3>

<p>A dataset containing the Motion index and steps count of a cow.
The data set is sampled with 15 minutes samples. The data is as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df691b_1
</code></pre>


<h3>Format</h3>

<p>A data frame of 3 columns
</p>

<dl>
<dt>datetime</dt><dd><p>a POSIX formatted datetime</p>
</dd>
<dt>Motion.Index</dt><dd><p>The motion index of the cow during the time sample</p>
</dd>
<dt>Steps</dt><dd><p>The number of steps during the time sample</p>
</dd>
</dl>



<h3>Source</h3>

<p>Agroscope Tanikon
</p>

<hr>
<h2 id='df759a_3'>df759a_3 Activity Data Sets</h2><span id='topic+df759a_3'></span>

<h3>Description</h3>

<p>A dataset containing the Motion index and steps count of a cow.
The data set is sampled with 15 minutes samples. The data is as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df759a_3
</code></pre>


<h3>Format</h3>

<p>A data frame of 3 columns
</p>

<dl>
<dt>datetime</dt><dd><p>a POSIX formatted datetime</p>
</dd>
<dt>Motion.Index</dt><dd><p>The motion index of the cow during the time sample</p>
</dd>
<dt>Steps</dt><dd><p>The number of steps during the time sample</p>
</dd>
</dl>



<h3>Source</h3>

<p>Agroscope Tanikon
</p>

<hr>
<h2 id='dfc'>Computes the Degree of Function coupling (DFC), Harmonic Part (HP) and Weekly
Lomb-Scargle Spectrum (LSP Spec) for one variable in an activity dataset.
The dataset should be digiRhythm friendly.</h2><span id='topic+dfc'></span>

<h3>Description</h3>

<p>The computation of DFC/HP/LSP parameters is done using a rolling window. If
the rolling window is 7 days, first, we compute the parameters of Days 1-7
then, of days 2-8 and so on). For each window of the 7 days, the function
will compute the LSP spectrum to determine the power of each frequency. Using
Baluev (2008), we will compute the significance of the amplitude of each
frequency component and determine whether it is significant or not. Then, we
will have all the significant frequencies, whose amplitudes' summation will
be denominated as SUMSIG. Among all the available frequencies, some are
harmonic (those that correspond to waves of period 24h, 12h, 24h/3, 24h/4,
...). As a result, we will have frequency components that are significant and
harmonic, whose powers' summation is called SSH (sum significant and
harmonic). The summation of all frequency components up to a frequency
reflecting a 24h period is called SUMALL. Therefore, DFC and HP are computed
as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dfc(
  data,
  activity,
  sampling = 15,
  alpha = 0.05,
  harm_cutoff = 12,
  rolling_window = 7,
  plot = TRUE,
  plot_harmonic_part = TRUE,
  verbose = TRUE,
  plot_lsp = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dfc_+3A_data">data</code></td>
<td>
<p>The activity data set.</p>
</td></tr>
<tr><td><code id="dfc_+3A_activity">activity</code></td>
<td>
<p>The name of the activity.</p>
</td></tr>
<tr><td><code id="dfc_+3A_sampling">sampling</code></td>
<td>
<p>The sampling period of the data set in minutes.
the Lomb Scargle Periodogram is computed.</p>
</td></tr>
<tr><td><code id="dfc_+3A_alpha">alpha</code></td>
<td>
<p>The significance level that should be used to determine the
significant frequency component.</p>
</td></tr>
<tr><td><code id="dfc_+3A_harm_cutoff">harm_cutoff</code></td>
<td>
<p>the order of the highest harmonic needed to be considered.
An integer equal to 1, 2, 3, ... Default is 12.</p>
</td></tr>
<tr><td><code id="dfc_+3A_rolling_window">rolling_window</code></td>
<td>
<p>The rolling window used to compute the LSP. Default is
7 days.</p>
</td></tr>
<tr><td><code id="dfc_+3A_plot">plot</code></td>
<td>
<p>if TRUE, the DFC/HP plot will be shown.</p>
</td></tr>
<tr><td><code id="dfc_+3A_plot_harmonic_part">plot_harmonic_part</code></td>
<td>
<p>if TRUE, it shows the harmonic part in the DFC plot</p>
</td></tr>
<tr><td><code id="dfc_+3A_verbose">verbose</code></td>
<td>
<p>if TRUE, print weekly progress.</p>
</td></tr>
<tr><td><code id="dfc_+3A_plot_lsp">plot_lsp</code></td>
<td>
<p>if TRUE, the LSP of each sliding week will be plotted</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DFC &lt;- SSH / SUMSIG
HP &lt;- SSH / SUMALL
</p>


<h3>Value</h3>

<p>A list containing 2 dataframe. DFC dataframe that contain the
results of a DFC computation and SPEC Dataframe that contains the result of
spectrum computation.
The DFC contains 3 columns:
** The date in format YYYY-MM-DD.
** The DFC computed using a @rolling_window days.
** The Harmonic Part (ratio).
Data are supposed to sampled with a specific smpling rate. It should be the
same sampling rate
as in the given argument @sampling
Missing days are not permitted. If you have data with half day, it should be
removed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sampling_period &lt;- 15 * 60 # seconds
two_weeks &lt;- 2 * 7 * 24 * 60 * 60 # seconds
amplitude_24h &lt;- 5
amplitude_12h &lt;- 3
noise_sd &lt;- 2
time_seq &lt;- seq(0, two_weeks, by = sampling_period)
time_posix &lt;- as.POSIXct(time_seq, origin = "1970-01-01")
sine_24h &lt;- amplitude_24h * sin(2 * pi * time_seq / (24 * 60 * 60))
sine_12h &lt;- amplitude_12h * sin(2 * pi * time_seq / (12 * 60 * 60))
noise &lt;- rnorm(length(time_seq), mean = 0, sd = noise_sd)
data &lt;- sine_24h + sine_12h + noise
df &lt;- data.frame(time = time_posix, value = data)
names(df) &lt;- c("datetime", "activity")
print(str(df))
my_lsp &lt;- dfc(df, "activity", alpha = 0.05, harm_cutoff = 12, plot = TRUE)
</code></pre>

<hr>
<h2 id='dgm_periodicity'>Returns the periodicity of a digiRhythm dataframe</h2><span id='topic+dgm_periodicity'></span>

<h3>Description</h3>

<p>Returns the periodicity of a digiRhythm dataframe
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dgm_periodicity(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dgm_periodicity_+3A_data">data</code></td>
<td>
<p>a digiRhythm friendly dataframe</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns a periodicity object of type xts.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("df516b_2", package = "digiRhythm")
df &lt;- df516b_2
dgm_periodicity(df)

</code></pre>

<hr>
<h2 id='diurnality'>Computes the diurnality index based on an activity dataframe</h2><span id='topic+diurnality'></span>

<h3>Description</h3>

<p>Computes the diurnality index based on an activity dataframe
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diurnality(
  data,
  activity,
  day_time = c("06:30:00", "16:30:00"),
  night_time = c("18:00:00", "T05:00:00"),
  save = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diurnality_+3A_data">data</code></td>
<td>
<p>a digiRhythm-friendly dataset</p>
</td></tr>
<tr><td><code id="diurnality_+3A_activity">activity</code></td>
<td>
<p>The number of non-useful lines to skip (lines to header)</p>
</td></tr>
<tr><td><code id="diurnality_+3A_day_time">day_time</code></td>
<td>
<p>an array containing the start and end of the day period.
Default: c(&quot;06:30:00&quot;, &quot;16:30:00&quot;).</p>
</td></tr>
<tr><td><code id="diurnality_+3A_night_time">night_time</code></td>
<td>
<p>an array containing the start and end of the night period.
Default: c(&quot;18:00:00&quot;, &quot;T05:00:00&quot;).</p>
</td></tr>
<tr><td><code id="diurnality_+3A_save">save</code></td>
<td>
<p>if NULL, the image is not saved. Otherwise, this parameter will
be the name of the saved image. it should contain the path and name without
the extension.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 object that contains the diurnality plot in addition to a
dataframe with 2 col: date and diurnality index
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("df516b_2", package = "digiRhythm")
data &lt;- df516b_2
data &lt;- remove_activity_outliers(data)
activity &lt;- names(data)[2]
d_index &lt;- diurnality(data, activity)

</code></pre>

<hr>
<h2 id='diurnality_customTimes'>Computes the diurnality index, using different start and end definitions for
each day and night, based on an activity dataframe</h2><span id='topic+diurnality_customTimes'></span>

<h3>Description</h3>

<p>Computes the diurnality index, using different start and end definitions for
each day and night, based on an activity dataframe
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diurnality_customTimes(data, activity, timedata, save = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diurnality_customTimes_+3A_data">data</code></td>
<td>
<p>a digiRhythm-friendly dataset</p>
</td></tr>
<tr><td><code id="diurnality_customTimes_+3A_activity">activity</code></td>
<td>
<p>The number of non-useful lines to skip (lines to header)</p>
</td></tr>
<tr><td><code id="diurnality_customTimes_+3A_timedata">timedata</code></td>
<td>
<p>a dataset, including 4 columns of POSIXct format, including
date and time &quot;day_start&quot;, &quot;day_end&quot;, &quot;night_start&quot;, &quot;night_end&quot;</p>
</td></tr>
<tr><td><code id="diurnality_customTimes_+3A_save">save</code></td>
<td>
<p>if NULL, the image is not saved. Otherwise, this parameter will
be the name of the saved image. it should contain the path and name without
the extension.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 object that contains the Sliding diurnality plot in
addition to a dataframe with 2 col: date and sliding diurnality index
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("df516b_2", package = "digiRhythm")
data &lt;- df516b_2
data &lt;- remove_activity_outliers(data)
activity &lt;- names(data)[2]
data("timedata", package = "digiRhythm")
timedata &lt;- timedata
d_index &lt;- diurnality_customTimes(data, activity, timedata)

</code></pre>

<hr>
<h2 id='highest_possible_harm_cutoff'>Function to calculate the smallest possible harmonic to consider given
a sampling frequency. The minimum possible harmonic = 2 x the period of the
maximum frequency according to the Shanon theorem. Example: if the sampling
period is 15 min, the minimum possible treatable period is 30 minutes and
that corresponds to the 48th harmonic (24 hours * 60 minutes / 48 =
30 minutes)</h2><span id='topic+highest_possible_harm_cutoff'></span>

<h3>Description</h3>

<p>Function to calculate the smallest possible harmonic to consider given
a sampling frequency. The minimum possible harmonic = 2 x the period of the
maximum frequency according to the Shanon theorem. Example: if the sampling
period is 15 min, the minimum possible treatable period is 30 minutes and
that corresponds to the 48th harmonic (24 hours * 60 minutes / 48 =
30 minutes)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>highest_possible_harm_cutoff(sampling_period_in_minutes)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="highest_possible_harm_cutoff_+3A_sampling_period_in_minutes">sampling_period_in_minutes</code></td>
<td>
<p>The sampling period of the acquired
data in minutes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the smallest possible harmonic (of 24 hours) to consider
given a sampling frequency.
</p>

<hr>
<h2 id='import_raw_activity_data'>Reads Raw Activity Data from csv files</h2><span id='topic+import_raw_activity_data'></span>

<h3>Description</h3>

<p>Reads Activity Data (data, time, activity(ies)) from a CSV file where we can
skip some lines (usually representing the metadata) and select specific
activities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>import_raw_activity_data(
  filename,
  skipLines = 0,
  act.cols.names = c("Date", "Time", "Motion Index", "Steps"),
  date_format = "%d.%m.%Y",
  time_format = "%H:%M:%S",
  sep = ",",
  original_tz = "CET",
  target_tz = "CET",
  sampling = 15,
  trim_first_day = TRUE,
  trim_middle_days = TRUE,
  trim_last_day = TRUE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="import_raw_activity_data_+3A_filename">filename</code></td>
<td>
<p>The file name (full or relative path with extension)</p>
</td></tr>
<tr><td><code id="import_raw_activity_data_+3A_skiplines">skipLines</code></td>
<td>
<p>The number of non-useful lines to skip (lines to header)</p>
</td></tr>
<tr><td><code id="import_raw_activity_data_+3A_act.cols.names">act.cols.names</code></td>
<td>
<p>A vector containing the names of columns to read
(specific to the activity columns)</p>
</td></tr>
<tr><td><code id="import_raw_activity_data_+3A_date_format">date_format</code></td>
<td>
<p>The POSIX format of the Date column (or first column)</p>
</td></tr>
<tr><td><code id="import_raw_activity_data_+3A_time_format">time_format</code></td>
<td>
<p>The POSIX format of the Time column (or second column)</p>
</td></tr>
<tr><td><code id="import_raw_activity_data_+3A_sep">sep</code></td>
<td>
<p>The delimiter/separator between the columns</p>
</td></tr>
<tr><td><code id="import_raw_activity_data_+3A_original_tz">original_tz</code></td>
<td>
<p>The time zone with which the datetime are encoded</p>
</td></tr>
<tr><td><code id="import_raw_activity_data_+3A_target_tz">target_tz</code></td>
<td>
<p>The time zone with which you want to process the data.
Setting this argument to 'GMT' will help you coping with daylight saving time
where changes occur two time a year.</p>
</td></tr>
<tr><td><code id="import_raw_activity_data_+3A_sampling">sampling</code></td>
<td>
<p>The sampling frequency in minutes (default 15 min)</p>
</td></tr>
<tr><td><code id="import_raw_activity_data_+3A_trim_first_day">trim_first_day</code></td>
<td>
<p>if True, removes the data from the first day if it
contains less than 80% of the expected data points.</p>
</td></tr>
<tr><td><code id="import_raw_activity_data_+3A_trim_middle_days">trim_middle_days</code></td>
<td>
<p>if True, removes the data from the MIDDLE days if
they contain less than 80% of the expected data points.</p>
</td></tr>
<tr><td><code id="import_raw_activity_data_+3A_trim_last_day">trim_last_day</code></td>
<td>
<p>if True, removes the data from the last day if it
contains less than 80% of the expected data points.</p>
</td></tr>
<tr><td><code id="import_raw_activity_data_+3A_verbose">verbose</code></td>
<td>
<p>print out some useful information during the execution
of the function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function prepare the data stored in a csv to be compatible with the
digiRhythm package. You have the possibility to skip the first lines and
choose which columns to read. You also have the possibility to sample the
data.
You can also choose whether to remove partial days (where no data over a
full day is present) by trimming last, middle or last days.
This function expects that the first and second columns are respectively
date and time where the format should be mentioned.
</p>
<p>file &lt;- file.path('data', 'sample_data')
colstoread &lt;- c(&quot;Date&quot;, &quot;Time&quot;, &quot;Motion Index&quot;, 'Steps') #The colums that we
are interested in
data &lt;- improt_raw_icetag_data(filename = file,
skipLines = 7,
act.cols.names = colstoread,
sampling = 15,
verbose = TRUE)
</p>


<h3>Value</h3>

<p>A dataframe with datetime column and other activity columns, ready to
be used with other functions in digirhythm
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
filename &lt;- system.file("extdata", "sample_data.csv", package = "digiRhythm")
data &lt;- import_raw_activity_data(
  filename,
  skipLines = 7,
  act.cols.names = c("Date", "Time", "Motion Index", "Steps"),
  sep = ",",
  original_tz = "CET",
  target_tz = "CET",
  date_format = "%d.%m.%Y",
  time_format = "%H:%M:%S",
  sampling = 15,
  trim_first_day = TRUE,
  trim_middle_days = TRUE,
  trim_last_day = TRUE,
  verbose = TRUE
)
print(head(data))

</code></pre>

<hr>
<h2 id='is_dgm_friendly'>Informs if a dataset is digiRhythm Friendly</h2><span id='topic+is_dgm_friendly'></span>

<h3>Description</h3>

<p>Takes an activity dataset as input and gives information about 1) If a
dataset is digiRhythm friendly, i.e., the functions used can work with this
dataset and 2) Tells what's wrong, if any.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_dgm_friendly(data, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is_dgm_friendly_+3A_data">data</code></td>
<td>
<p>The dataframe containing the activity data</p>
</td></tr>
<tr><td><code id="is_dgm_friendly_+3A_verbose">verbose</code></td>
<td>
<p>if TRUE, prints info about the dataset</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Boolean. If True, the dataframe is digirhythm friendly. If False, the
dataframe is not digirhythm friendly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("df516b_2", package = "digiRhythm")
d &lt;- df516b_2
is_dgm_friendly(data = d, verbose = TRUE)
</code></pre>

<hr>
<h2 id='levopt'>Returns the level given the p-value computed with pbaluev (2008). Copied from
the LOMB library.</h2><span id='topic+levopt'></span>

<h3>Description</h3>

<p>Returns the level given the p-value computed with pbaluev (2008). Copied from
the LOMB library.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>levopt(Z, alpha, fmax, tm)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="levopt_+3A_z">Z</code></td>
<td>
<p>the power of the frequency</p>
</td></tr>
<tr><td><code id="levopt_+3A_alpha">alpha</code></td>
<td>
<p>the significance level</p>
</td></tr>
<tr><td><code id="levopt_+3A_fmax">fmax</code></td>
<td>
<p>the maximum frequency in the spectrum</p>
</td></tr>
<tr><td><code id="levopt_+3A_tm">tm</code></td>
<td>
<p>the time grid of the original time series</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the level given the p-value computed with pbaluev (2008).
</p>

<hr>
<h2 id='lomb_scargle_periodogram'>Computes the Lomb Scargle Periodogram and returns the information needed for
computing the DFC and HP. A plot visualizing the Harmonic Frequencies
presence in the spectrum is possible. The function is inspired from the Lomb
library in a great part, with modifications to fit the requirements of
harmonic powers and computation of the DFC. This function is inspired by the
lsp function from the lomb package and adapted to add different colors for
harmonic and non harmonic frequencies in the signal. For more information
about lomb::lsp, please refer
to: https://cran.r-project.org/web/packages/lomb/</h2><span id='topic+lomb_scargle_periodogram'></span>

<h3>Description</h3>

<p>Computes the Lomb Scargle Periodogram and returns the information needed for
computing the DFC and HP. A plot visualizing the Harmonic Frequencies
presence in the spectrum is possible. The function is inspired from the Lomb
library in a great part, with modifications to fit the requirements of
harmonic powers and computation of the DFC. This function is inspired by the
lsp function from the lomb package and adapted to add different colors for
harmonic and non harmonic frequencies in the signal. For more information
about lomb::lsp, please refer
to: https://cran.r-project.org/web/packages/lomb/
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lomb_scargle_periodogram(
  data,
  alpha = 0.01,
  harm_cutoff = 12,
  sampling = 15,
  plot = TRUE,
  extra_info_plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lomb_scargle_periodogram_+3A_data">data</code></td>
<td>
<p>a digiRhythm friendly dataframe of only two columns</p>
</td></tr>
<tr><td><code id="lomb_scargle_periodogram_+3A_alpha">alpha</code></td>
<td>
<p>the statistical significance for the false alarm</p>
</td></tr>
<tr><td><code id="lomb_scargle_periodogram_+3A_harm_cutoff">harm_cutoff</code></td>
<td>
<p>the order of the highest harmonic needed to be considered.
An integer equal to 1, 2, 3, ... Default is 12.</p>
</td></tr>
<tr><td><code id="lomb_scargle_periodogram_+3A_sampling">sampling</code></td>
<td>
<p>the sampling period in minutes. default = 15 min.</p>
</td></tr>
<tr><td><code id="lomb_scargle_periodogram_+3A_plot">plot</code></td>
<td>
<p>if TRUE, the LSP will be plotted</p>
</td></tr>
<tr><td><code id="lomb_scargle_periodogram_+3A_extra_info_plot">extra_info_plot</code></td>
<td>
<p>if True, extra information will be shown on the plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list that contains a dataframe (detailed below), the significance
level and significance (for the record). The dataframe contains the power the
frequency, the frequency in HZ, the p values according to Baluev 2008, the
period that corresponds to the frequency in seconds and in hours and finally,
a boolean to tell whether the frequency is harmonic or not.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("df516b_2", package = "digiRhythm")
data &lt;- df516b_2[1:672, c(1, 2)]
lomb_scargle_periodogram(data, alpha = 0.01, harm_cutof = 12, plot = TRUE)

</code></pre>

<hr>
<h2 id='pbaluev'>Returns p-value of a frequency peak according to pbaluev (2008) given Z,
fmax and tm. Reused from the LOMB library (https://rdrr.io/cran/lomb/)</h2><span id='topic+pbaluev'></span>

<h3>Description</h3>

<p>Returns p-value of a frequency peak according to pbaluev (2008) given Z,
fmax and tm. Reused from the LOMB library (https://rdrr.io/cran/lomb/)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pbaluev(Z, fmax, tm)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pbaluev_+3A_z">Z</code></td>
<td>
<p>the power of the frequency</p>
</td></tr>
<tr><td><code id="pbaluev_+3A_fmax">fmax</code></td>
<td>
<p>the maximum frequency in the spectrum</p>
</td></tr>
<tr><td><code id="pbaluev_+3A_tm">tm</code></td>
<td>
<p>the time grid of the original time series</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an intermediate calculation step needed to compute the p-value
according to
pbaluev (2008).
</p>

<hr>
<h2 id='print_v'>Print if Verbose is true</h2><span id='topic+print_v'></span>

<h3>Description</h3>

<p>Print if Verbose is true
</p>


<h3>Usage</h3>

<pre><code class='language-R'>print_v(string, verbose)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print_v_+3A_string">string</code></td>
<td>
<p>The string to print</p>
</td></tr>
<tr><td><code id="print_v_+3A_verbose">verbose</code></td>
<td>
<p>if TRUE, print the string</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. Prints the string concatenated with a verbose if the
latter is not NULL.
</p>

<hr>
<h2 id='remove_activity_outliers'>Remove outliers from the data</h2><span id='topic+remove_activity_outliers'></span>

<h3>Description</h3>

<p>Remove outliers from the data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_activity_outliers(df)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="remove_activity_outliers_+3A_df">df</code></td>
<td>
<p>The dataframe containing the activity data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return a dataframe where columns start the second one have undergone
an outlier removal.
</p>

<hr>
<h2 id='resample_dgm'>Change the sampling of a digiRhythm friendly dataset</h2><span id='topic+resample_dgm'></span>

<h3>Description</h3>

<p>This function upsamples the data but does not downsample them. The new
sampling should be a multiple of the current sampling period, and should be
given in minutes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resample_dgm(data, new_sampling)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="resample_dgm_+3A_data">data</code></td>
<td>
<p>The dataframe containing the activity data</p>
</td></tr>
<tr><td><code id="resample_dgm_+3A_new_sampling">new_sampling</code></td>
<td>
<p>The new sampling (multiple of current sampling) in
minutes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A digiRhythm friendly dataset with the new sampling
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("df516b_2", package = "digiRhythm")
df &lt;- df516b_2
df &lt;- remove_activity_outliers(df)
new_sampling &lt;- 30
new_dgm &lt;- resample_dgm(df, new_sampling)
</code></pre>

<hr>
<h2 id='timedata'>timedata Dataset of start and end of day and night</h2><span id='topic+timedata'></span>

<h3>Description</h3>

<p>A dataset of start and endtime of the morning milking and evening milking
on a dairy farm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>timedata
</code></pre>


<h3>Format</h3>

<p>A data frame of 4 columns
</p>

<dl>
<dt>day_start</dt><dd><p>a POSIX formatted datetime</p>
</dd>
<dt>day_end</dt><dd><p>a POSIX formatted datetime</p>
</dd>
<dt>night_start</dt><dd><p>a POSIX formatted datetime</p>
</dd>
<dt>night_end</dt><dd><p>a POSIX formatted datetime</p>
</dd>
</dl>



<h3>Source</h3>

<p>Johann Heinrich von Th√ºnen- Institute of Organic Farming
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
