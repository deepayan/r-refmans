<!DOCTYPE html><html><head><title>Help for package rankFD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rankFD}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Coal'><p>Coal Acidity</p></a></li>
<li><a href='#Muco'><p>Half-Time of Mucociliary Clearance</p></a></li>
<li><a href='#nms'><p>Irritation of Nasal Mucosa</p></a></li>
<li><a href='#noether'><p>Sample size calculation for the Wilcoxon-Mann-Whitney test using the Noether formula. The function estimates the sample size needed to detect the effect with</p>
pre-defined power at significance level alpha using Noether's formula'.</a></li>
<li><a href='#psr'><p>A function for computing pseudo-ranks of data</p></a></li>
<li><a href='#rank.two.samples'><p>A function for analyzing two-sample problems</p></a></li>
<li><a href='#rankFD'><p>Rank-based tests for general factorial designs</p></a></li>
<li><a href='#steel'><p>Steel-type multiple contrast tests</p></a></li>
<li><a href='#WMWSSP'><p>Sample size computation methods for the Wilcoxon-Mann-Whitney test based on pilot data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Rank-Based Tests for General Factorial Designs</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-03-23</td>
</tr>
<tr>
<td>Author:</td>
<td>Frank Konietschke, Sarah Friedrich, Edgar Brunner, Markus Pauly</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Frank Konietschke &lt;frank.konietschke@charite.de&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.2)</td>
</tr>
<tr>
<td>Description:</td>
<td>The rankFD() function calculates the Wald-type statistic (WTS) and the ANOVA-type
	     statistic (ATS) for nonparametric factorial designs, e.g., for count, ordinal or score data
	     in a crossed design with an arbitrary number of factors.
	     Brunner, E., Bathke, A. and Konietschke, F. (2018) &lt;<a href="https://doi.org/10.1007%2F978-3-030-02914-2">doi:10.1007/978-3-030-02914-2</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>lattice (&ge; 0.20-33), MASS (&ge; 7.3-43), coin (&ge; 1.1-2),
multcomp, mvtnorm</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-03-23 08:49:34 UTC; sfriedrich</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-03-23 10:10:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='Coal'>Coal Acidity</h2><span id='topic+Coal'></span>

<h3>Description</h3>

<p>Coal acidity values determined under each of three NaOH concentration levels for two different samples from each type of coal
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Coal)
</code></pre>


<h3>Format</h3>

<p>A data frame with 18 rows and 3 variables:
</p>

<dl>
<dt>Acidity</dt><dd><p>resulting acidity values</p>
</dd>
<dt>NaOH</dt><dd><p>the NaOH concentration</p>
</dd>
<dt>Type</dt><dd><p>three different types of coal: &quot;Morwell&quot;, &quot;Yallourn&quot; and &quot;Maddingley&quot;</p>
</dd>
</dl>



<h3>Source</h3>

<p>Hollander, M., Wolfe, D. A., Chicken, E. (2014) <em>Nonparametric Statistical Methods</em>. Wiley Series in Probability and Statistics.
</p>
<p>Sternhell, S. (1958) Chemistry of brown coals VI: Further aspects of the chemistry of hydroxyl groups in Victorian brown coals. Australian Journal of Applied Science <b>9</b>, 375&ndash;379.
</p>

<hr>
<h2 id='Muco'>Half-Time of Mucociliary Clearance</h2><span id='topic+Muco'></span>

<h3>Description</h3>

<p>Mucociliary efficiency was assessed from the rate of removal of dust in three different groups of subjects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Muco)
</code></pre>


<h3>Format</h3>

<p>A data frame with 14 rows and 2 variables:
</p>

<dl>
<dt>HalfTime</dt><dd><p>Half-Time of Mucociliary clearance, assessed from the rate of removal of dust</p>
</dd>
<dt>Disease</dt><dd><p>normal subjects, subjects with obstructive airways disease (OAD) and subjects with asbestosis</p>
</dd>
</dl>



<h3>Source</h3>

<p>Hollander, M., Wolfe, D. A., Chicken, E. (2014) Nonparametric Statistical Methods. Wiley Series in Probability and Statistics.
</p>
<p>Thomson, M. L. and Short, M. D.(1969) Mucociliary function in health, chronic obstructive airway disease, and asbestosis. Journal of Applied Physiology <b>26</b>, 535&ndash;539.
</p>

<hr>
<h2 id='nms'>Irritation of Nasal Mucosa</h2><span id='topic+nms'></span>

<h3>Description</h3>

<p>Damage of two gaseous substances on nasal mucosa membrane of mice
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(nms)
</code></pre>


<h3>Format</h3>

<p>A data frame with 150 rows and 3 variables:
</p>

<dl>
<dt>subst</dt><dd><p>The substance given, either 1 or 2</p>
</dd>
<dt>conc</dt><dd><p>the concentration in which the substance was given, 1, 2 or 5 ppm</p>
</dd>
<dt>score</dt><dd><p>degree of irritation assessed using an ordinal score ranging from 0 to 4 with 0 = “no irritation”,
1 = “mild irritation”, 2 = “strong irritation”, 3 = “severe irritation” and 4 = “irreversible damage”</p>
</dd>
</dl>



<h3>Source</h3>

<p>Brunner, E., Bathke, A.C., Konietschke, F. Rank and Pseudo-Rank Procedures 
for Independent Observations in Factorial Designs. Springer International Publishing, 2018.
</p>

<hr>
<h2 id='noether'>Sample size calculation for the Wilcoxon-Mann-Whitney test using the Noether formula. The function estimates the sample size needed to detect the effect with
pre-defined power at significance level alpha using Noether's formula'.</h2><span id='topic+noether'></span>

<h3>Description</h3>

<p>Sample size calculation for the Wilcoxon-Mann-Whitney test using the Noether formula. The function estimates the sample size needed to detect the effect with
pre-defined power at significance level alpha using Noether's formula'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>noether(alpha, power, t, p, x1 = c(0), ties = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="noether_+3A_alpha">alpha</code></td>
<td>
<p>two sided type I error rate</p>
</td></tr>
<tr><td><code id="noether_+3A_power">power</code></td>
<td>
<p>power: detect a relative effect p at least with probability power</p>
</td></tr>
<tr><td><code id="noether_+3A_t">t</code></td>
<td>
<p>proportion of subjects in the first group (between 0 and 1)</p>
</td></tr>
<tr><td><code id="noether_+3A_p">p</code></td>
<td>
<p>relative effect</p>
</td></tr>
<tr><td><code id="noether_+3A_x1">x1</code></td>
<td>
<p>advance information is only needed in case of ties</p>
</td></tr>
<tr><td><code id="noether_+3A_ties">ties</code></td>
<td>
<p>TRUE if ties are possible (non continuous distribution), otherwise FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame with the sample sizes for each group
</p>


<h3>References</h3>

<p>Noether, G. E. (1987). Sample Size Determination for Some Common Nonparametric Tests. Journal of the American Statistical Association 85, 645.647.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>noether(0.05,0.8,1/2, 0.75)
</code></pre>

<hr>
<h2 id='psr'>A function for computing pseudo-ranks of data</h2><span id='topic+psr'></span>

<h3>Description</h3>

<p>The <code>psr()</code> function calculates pseuo-ranks of data in general factorial designs. It returns the input data set complemented by an additional variable containing the pseudo-ranks. We note that more efficient algorithms for the computation of pseudo-ranks are implemented within the package pseudorank.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psr(formula, data, psranks = "pseudorank")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psr_+3A_formula">formula</code></td>
<td>
<p>A model <code><a href="stats.html#topic+formula">formula</a></code> object. The left hand side
contains the response variable and the right hand side contains the factor
variables of interest. Please use one-way layouts  for the computation of the pseudo-ranks only. In case of higher-way layouts, please use a 'help factor' that#' shrinks the layout to a one-way design.</p>
</td></tr>
<tr><td><code id="psr_+3A_data">data</code></td>
<td>
<p>A data.frame, list or environment containing the variables in 
</p>
<p><code>formula</code>. The default option is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="psr_+3A_psranks">psranks</code></td>
<td>
<p>A header specifying the name of the pseudo ranks in the output data set.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The pseudo-ranks are exported within a new column attached to the given data set.
</p>


<h3>References</h3>

<p>Konietschke, F., Hothorn, L. A., &amp; Brunner, E. (2012). 
Rank-based multiple test procedures and simultaneous confidence intervals. Electronic Journal of Statistics, 6, 738-759.
</p>
<p>Brunner, E., Bathke, A. C., Konietschke, F. (2018). Rank and pseudo-rank procedures for independent observations in factorial designs. Springer International
Publishing.
</p>
<p>Happ, M., Zimmermann, G., Brunner, E., Bathke, A. C. (2020). Pseudo-ranks: How to calculate them efficiently in R. Journal of Statistical Software, 95(1), 1-22.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rankFD">rankFD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Muco)
Muco2 &lt;- psr(HalfTime~Disease,data=Muco, psranks="Mypseudos")

</code></pre>

<hr>
<h2 id='rank.two.samples'>A function for analyzing two-sample problems</h2><span id='topic+rank.two.samples'></span>

<h3>Description</h3>

<p>The <code>rank.two.samples()</code> function calculates purely nonparametric rank-based 
methods for the analysis of two independent samples. Specifically, it
implements the Brunner-Munzel test and its generalizations for the Nonparametric Behrens-Fisher Problem,
that is, testing whether the relative effect p=P(X&lt;Y)+1/2*P(X=Y) of the two independent samples X and Y 
is equal to 1/2.  Range preserving confidence intervals (and corresponding test statistics)
are available using Logit or Probit transformations. The function also implements studentized permutation 
tests and permutation based confidence intervals for p using any of the method above (see the details below). 
Furthermore, the Wilcoxon-Mann-Whitney test (exact and asymptotic) can be used to test the equality of
the two distribution functions of the two samples. The user can specify whether confidence intervals for shift
effects shall be computed. The <code>rank.two.samples()</code> function implements one-sided and two-sided tests 
and confidence intervals. You can plot the confidence intervals (for the relative
effects) with the <code>plot()</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rank.two.samples(
  formula,
  data,
  conf.level = 0.95,
  alternative = c("two.sided", "less", "greater"),
  rounds = 4,
  method = c("t.app", "logit", "probit", "normal"),
  permu = TRUE,
  info = TRUE,
  wilcoxon = c("asymptotic", "exact"),
  shift.int = TRUE,
  nperm = 10000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rank.two.samples_+3A_formula">formula</code></td>
<td>
<p>A model <code><a href="stats.html#topic+formula">formula</a></code> object. The left hand side
contains the response variable and the right hand side contains the factor
variables of interest.</p>
</td></tr>
<tr><td><code id="rank.two.samples_+3A_data">data</code></td>
<td>
<p>A data.frame, list or environment containing the variables in 
<code>formula</code>. The default option is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="rank.two.samples_+3A_conf.level">conf.level</code></td>
<td>
<p>A number specifying the confidence level; the default is 0.95.</p>
</td></tr>
<tr><td><code id="rank.two.samples_+3A_alternative">alternative</code></td>
<td>
<p>A character string specifying the alternative hypothesis. One of &quot;two.sided&quot;, &quot;less&quot;, &quot;greater&quot;. You can specify just the initial letter.</p>
</td></tr>
<tr><td><code id="rank.two.samples_+3A_rounds">rounds</code></td>
<td>
<p>Value specifying the number of digits the results are rounded to. Default is 4 decimals.</p>
</td></tr>
<tr><td><code id="rank.two.samples_+3A_method">method</code></td>
<td>
<p>specifying the method used for calculation of the confidence intervals.
One of &quot;t.app&quot;, &quot;logit&quot;, &quot;probit&quot; or &quot;normal&quot;.</p>
</td></tr>
<tr><td><code id="rank.two.samples_+3A_permu">permu</code></td>
<td>
<p>A logical variable indicating whether you want to compute a studentized permutation test.</p>
</td></tr>
<tr><td><code id="rank.two.samples_+3A_info">info</code></td>
<td>
<p>A logical variable. Here, info = FALSE suppresses the output of additional information
concerning e.g. the interpretation of the test results.</p>
</td></tr>
<tr><td><code id="rank.two.samples_+3A_wilcoxon">wilcoxon</code></td>
<td>
<p>asymptotic or exact calculation of Wilcoxon test.</p>
</td></tr>
<tr><td><code id="rank.two.samples_+3A_shift.int">shift.int</code></td>
<td>
<p>Logical, indicating whether or not shift effects should be considered.</p>
</td></tr>
<tr><td><code id="rank.two.samples_+3A_nperm">nperm</code></td>
<td>
<p>Number of permutations used, default is 10000.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>rank.two.samples()</code> function calculates both transformed (logit or probit) and untransformed statistics 
(normal or t.app) for testing the null hypothesis p=1/2. If a studentized permutation test is performed, then the
permutation distribution of the respective statistics are computed, see Pauly et
al.(2016) for details. In any case, the function reports the point estimator and its estimated standard error, 
value of the test statistic, confidence interval and p-value. In case of separated samples, point estimator and standard error
would be 0 and thus, test statistics would not be defined. In such a case, point
estimator and its standard error are replaced by the numbers one would obtain if samples overlapped in a single point. 
A plot of the confidence interval can be obtained with the plot function.
</p>


<h3>Author(s)</h3>

<p>Frank Konietschke
Brunner, E., Bathke, A. C., Konietschke, F. (2018). Rank and Pseudo-Rank Procedures for Independent Observations in Factorial Designs. Springer International
Publishing.
</p>


<h3>References</h3>

<p>Brunner, E. and Munzel, U. (2000). The nonparametric Behrens-Fisher problem: Asymptotic
theory and a small-sample approximation. Biometrical Journal 1, 17 - 21.
</p>
<p>Kaufmann, J., Werner, C., and Brunner, E. (2005). Nonparametric methods for analysing the
accuracy of diagnostic tests with multiple readers. Statistical Methods in Medical Research 14, 129 - 146
</p>
<p>Pauly, M., Asendorf, T.,  Konietschke, F. (2016). Permutation-based inference for the AUC: a unified approach for continuous and discontinuous data.##' Biometrical Journal, 58(6), 1319 &ndash; 1337.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rankFD">rankFD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Muco)  
Muco2 &lt;- subset(Muco, Disease != "OAD")
Muco2$Disease &lt;- droplevels(Muco2$Disease)

twosample &lt;- rank.two.samples(HalfTime ~ Disease, data = Muco2, 
wilcoxon = "exact", permu = TRUE, shift.int = TRUE, nperm = 1000)
twosample &lt;- rank.two.samples(HalfTime ~ Disease, data = Muco2, 
   alternative = "greater", method = "probit", wilcoxon = "exact", permu = TRUE,
   shift.int = FALSE, nperm = 1000)
plot(twosample)

</code></pre>

<hr>
<h2 id='rankFD'>Rank-based tests for general factorial designs</h2><span id='topic+rankFD'></span>

<h3>Description</h3>

<p>The function implements purely nonparametric rank-based methods for the analysis 
of general factorial designs. You can chose to use either classical ranks (mid-ranks) 
(<code>effect="weighted"</code>) or pseudo-ranks (<code>effect="unweighted"</code>)
for making inference. Pseudo-ranks are used by default. 
The package implements point estimators of relative effects (weighted and unweighted) as
well as test procedures (Wald-Type and ANOVA-Type statistics) for testing global null hypotheses
formulated in either (i) distribution functions <code>hypothesis="H0F"</code> 
or (ii) relative effects <code>hypothesis="H0p"</code>. In case of one-way factorial 
designs, the function additionally computes 
the Kruskal-Wallis test either with ranks or pseudo-ranks. In addition, multiple 
contrast tests (and simultaneous confidence intervals)
for the main or interaction effects are implemented within the <code>contrast</code> 
statement. You can either choose from pre-defined contrasts (options see below) or
you can provide your own user-defined contrast matrix. Both the
Fisher-transformation (<code>sci.method="fisher"</code>) as well as a multivariate
t-approximation (<code>sci.method="multi.t"</code>) are implemented.
The Fisher approximation is used by default. To visualize the results, you can plot
the simultaneous confidence intervals using the <code>plot.sci</code> function.
Furthermore, confidence interval plots for the main or interaction relative effects
(not simultaneous) are available within the <code>plot</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rankFD(
  formula,
  data,
  alpha = 0.05,
  CI.method = c("logit", "normal"),
  effect = c("unweighted", "weighted"),
  hypothesis = c("H0F", "H0p"),
  Factor.Information = FALSE,
  contrast = NULL,
  sci.method = c("fisher", "multi.t"),
  info = TRUE,
  covariance = FALSE,
  rounds = 4
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rankFD_+3A_formula">formula</code></td>
<td>
<p>A model <code><a href="stats.html#topic+formula">formula</a></code> object. The left hand side
contains the response variable and the right hand side contains 
the factor variables of interest. An interaction term must be specified.</p>
</td></tr>
<tr><td><code id="rankFD_+3A_data">data</code></td>
<td>
<p>A data.frame, list or environment containing the variables in 
<code>formula</code>. The default option is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="rankFD_+3A_alpha">alpha</code></td>
<td>
<p>A number specifying the significance level; the default is 0.05.</p>
</td></tr>
<tr><td><code id="rankFD_+3A_ci.method">CI.method</code></td>
<td>
<p>Either &quot;logit&quot; or &quot;normal&quot;, specifying the method used for
calculation of the confidence intervals.</p>
</td></tr>
<tr><td><code id="rankFD_+3A_effect">effect</code></td>
<td>
<p>In case of weighted, then weighted (by sample sizes) relative 
effects are estimated using classical ranks (mid-ranks) of the data. 
Otherwise, in case of effect=&quot;unweighted&quot;, unweighted relative 
effects are estimated with pseudo-ranks. The default option is &quot;unweighted&quot; resulting in pseudo-rank statistics.</p>
</td></tr>
<tr><td><code id="rankFD_+3A_hypothesis">hypothesis</code></td>
<td>
<p>The null hypothesis to be tested, either &quot;H0F&quot; or &quot;H0p&quot;. The option &quot;H0F&quot; computes tests for testing hypotheses
formulated in terms of distribution functions. Otherwise, 
hypotheses in relative effects are tested. The latter allows for variance heteroscedasticity even
under the null hypothesis of no treatment effect and thus covers the Nonparametric Behrens-Fisher problem.</p>
</td></tr>
<tr><td><code id="rankFD_+3A_factor.information">Factor.Information</code></td>
<td>
<p>Logical. If TRUE, descriptive statistics with point estimators, standard error as well as confidence intervals for 
each main and interaction effect in the model are printed. The results can furthermore be plotted with the plot function.</p>
</td></tr>
<tr><td><code id="rankFD_+3A_contrast">contrast</code></td>
<td>
<p>a list containing the name of the main or interaction effect (written as group1:group2), 
a pre-defined contrast (&quot;Dunnett&quot;, &quot;Tukey&quot;, &quot;Sequen&quot;, &quot;AVE&quot;, &quot;Changepoint&quot;, 
&quot;Williams&quot;, &quot;Marcus&quot;, &quot;McDermott&quot;, &quot;UmbrellaWilliams&quot;, &quot;GrandMean&quot;) or a user-defined contrast matrix. If the contrast coefficients do not
sum up to 0, or if their sum of absolutes differs from 2, the coefficients are normalized.</p>
</td></tr>
<tr><td><code id="rankFD_+3A_sci.method">sci.method</code></td>
<td>
<p>Either &quot;fisher&quot; or &quot;multi.t&quot; as approximation method for the multiple contrast tests and simultaneous confidence intervals. 
The default option is &quot;fisher&quot;.</p>
</td></tr>
<tr><td><code id="rankFD_+3A_info">info</code></td>
<td>
<p>Logical. If TRUE, additional output information and explanation is printed to the console.</p>
</td></tr>
<tr><td><code id="rankFD_+3A_covariance">covariance</code></td>
<td>
<p>Logical. If TRUE, the estimated covariance matrix of the vector of relative effects is computed.</p>
</td></tr>
<tr><td><code id="rankFD_+3A_rounds">rounds</code></td>
<td>
<p>Number of  decimals of the output values. The default option is rounds=4 (4 decimals).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The rankFD() function calculates the Wald-type statistic (WTS), ANOVA-type 
statistic (ATS) as well as multiple contrast tests for general factorial designs 
for testing the null hypotheses <code class="reqn">H_0^F: CF = 0</code> or <code class="reqn">H_0^p: Cp = 0</code>. 
Almost every method explained in the comprehensive textbook from Brunner et al. (2019) 
is implemented in rankFD. The test procedures for testing null hypotheses in distribution 
functions have initially been proposed by Akritas et al. (1997), whereas methods for testing null 
hypotheses formulated in relative effects have been proposed by Brunner et al. (2017). 
We note that the multiple contrast test procedure using Fisher approximation computes critical and 
p-values from a multivariate t-distribution with respective degrees of freedom. Simulation studies by
Konietschke et al. (2012) demonstrated an accurate control of the type-1 error rate and
the procedure is therefore recommended.
</p>


<h3>Value</h3>

<p>A <code>rankFD</code> object containing the following components:
</p>
<table>
<tr><td><code>Call</code></td>
<td>
<p>Given response and factor names (formula)</p>
</td></tr>           
<tr><td><code>Descriptive</code></td>
<td>
<p>Descriptive statistics of the data for all factor
level combinations. Displayed are the number of individuals per factor
level combination (size), the relative effect (Rel.Effect), Standard Error and  100*(1-alpha)% confidence
intervals.</p>
</td></tr>
<tr><td><code>WTS</code></td>
<td>
<p>The value of the WTS along with degrees of freedom of the central chi-square distribution and p-value.</p>
</td></tr>
<tr><td><code>ATS</code></td>
<td>
<p>The value of the ATS, degrees of freedom of the central F distribution and the corresponding p-value.</p>
</td></tr>
<tr><td><code>Kruskal-Wallis-Test</code></td>
<td>
<p>The value of the Kruskal-Wallis test along with degrees of freedom and p-value. If effect=&quot;unweighted&quot;, the Kruskal-Wallis test
using pseudo-ranks is computed. Otherwise, if effect=&quot;unweighted&quot;, the &quot;established&quot; Kruskal-Wallis test based on ranks is returned.</p>
</td></tr> 
<tr><td><code>MCTP</code></td>
<td>
<p>Contrast matrix, local Results in terms of point estimates, standard error, value of the test statistic, (1-alpha)100
intervals as well as adjusted p-values. As a summary, the function also returns the global test decision by printing the maximum test
statistic (in absolute value) as well as the (1-alpha) critical value from the multivariate T-distribution.</p>
</td></tr>
<tr><td><code>Covariance.Matrix</code></td>
<td>
<p>The estimated covariance matrix of the vector of the estimated relative effects. Note that the vector is multiplied by root N.</p>
</td></tr>
<tr><td><code>Factor.Information</code></td>
<td>
<p>Descriptive tables containing the point estimators, standard errors as well as (1-alpha)100
and interaction effects in the model. The confidence intervals are not simultaneous and for data descriptive purpose only.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Brunner, E., Bathke, A.C., Konietschke, F. Rank and Pseudo-Rank Procedures 
for Independent Observations in Factorial Designs. Springer International Publishing, 2018.
</p>
<p>Brunner, E., Konietschke, F., Pauly, M., Puri, M. L. (2017). Rank-based procedures in factorial designs: 
Hypotheses about non-parametric treatment effects. Journal of the Royal Statistical Society: Series B 
(Statistical Methodology), 79(5), 1463-1485.
</p>
<p>Akritas, M. G., Arnold, S. F., and Brunner, E. (1997). Nonparametric hypotheses and rank statistics for unbalanced factorial designs.
Journal of the American Statistical Association 92, 258-265.
</p>
<p>Brunner, E., Dette, H., and Munk, A. (1997). Box-Type Approximations in Nonparametric Factorial Designs. Journal
of the American Statistical Association 92, 1494-1502.
</p>
<p>Konietschke, F., Hothorn, L. A., Brunner, E. (2012). Rank-based multiple test procedures and simultaneous confidence intervals. Electronic Journal of Statistics,
6, 738-759.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Coal)
model &lt;- rankFD(Acidity ~ NaOH * Type, data = Coal, CI.method = "normal",
effect = "unweighted", hypothesis = "H0F")

data(Muco)
model.oneway &lt;- rankFD(HalfTime ~ Disease, data = Muco, CI.method = "logit",
effect = "weighted", hypothesis = "H0p")
plot(model.oneway)


</code></pre>

<hr>
<h2 id='steel'>Steel-type multiple contrast tests</h2><span id='topic+steel'></span>

<h3>Description</h3>

<p>The function implements purely nonparametric Steel-type multiple contrast tests for either making
many-to-one (Dunnett-type) or all pairwise (Tukey-type) comparisons.
Null hypotheses are formulated in terms of the distribution functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>steel(
  formula,
  data,
  control = NULL,
  alternative = c("two.sided", "less", "greater"),
  info = TRUE,
  correlation = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="steel_+3A_formula">formula</code></td>
<td>
<p>A model <code><a href="stats.html#topic+formula">formula</a></code> object. The left hand side
contains the response variable and the right hand side contains 
the factor variable of interest.</p>
</td></tr>
<tr><td><code id="steel_+3A_data">data</code></td>
<td>
<p>A data.frame, list or environment containing the variables in 
<code>formula</code>. The default option is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="steel_+3A_control">control</code></td>
<td>
<p>Specification of the control group for making many-to-one-comparisons. If NULL, all-pairwise comparisons are performed.</p>
</td></tr>
<tr><td><code id="steel_+3A_alternative">alternative</code></td>
<td>
<p>Specification of the direction of the alternative. Default is two-sided.</p>
</td></tr>
<tr><td><code id="steel_+3A_info">info</code></td>
<td>
<p>Logical. If TRUE, additional output information and explanation is printed to the console.</p>
</td></tr>
<tr><td><code id="steel_+3A_correlation">correlation</code></td>
<td>
<p>Logical. If TRUE, the correlation matrix is printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The steel() function calculates the Steel-type tests as explained by Munzel, U., Hothorn, L. A. (2001). A unified approach to simultaneous rank test procedures
in the unbalanced one-way layout. Biometrical Journal: Journal of Mathematical Methods in Biosciences, 43(5), 553-569.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>Data.Info</code></td>
<td>
<p>Groups and sample sizes of the data</p>
</td></tr>           
<tr><td><code>Analysis</code></td>
<td>
<p>Data frame containing the test results (comparison, relative effect estimator, standard error, test statistic and p-value.)</p>
</td></tr>
<tr><td><code>Correlation</code></td>
<td>
<p>Estimated correlation matrix</p>
</td></tr>
</table>


<h3>References</h3>

<p>Brunner, E., Bathke, A.C., Konietschke, F. Rank and Pseudo-Rank Procedures 
for Independent Observations in Factorial Designs. Springer International Publishing, 2018.
</p>
<p>Munzel, U., Hothorn, L. A. (2001). A unified approach to simultaneous rank test procedures in the unbalanced one-way layout. Biometrical Journal: Journal of
Mathematical Methods in Biosciences, 43(5), 553-569.
</p>
<p>Konietschke, F., Hothorn, L. A., Brunner, E. (2012). Rank-based multiple test procedures and simultaneous confidence intervals. Electronic Journal of Statistics,
6, 738-759.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Muco)
model.oneway &lt;- steel(HalfTime ~ Disease, data = Muco,info=TRUE,correlation=TRUE)


</code></pre>

<hr>
<h2 id='WMWSSP'>Sample size computation methods for the Wilcoxon-Mann-Whitney test based on pilot data</h2><span id='topic+WMWSSP'></span>

<h3>Description</h3>

<p>The function implements the sample size formula proposed by Happ et al. (see reference below). It estimates the sample size needed to detect the effect with
pre-defined power at significance level alpha based on pilot data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WMWSSP(x1, x2, alpha = 0.05, power = 0.8, t = 1/2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WMWSSP_+3A_x1">x1</code></td>
<td>
<p>advance information for the first group</p>
</td></tr>
<tr><td><code id="WMWSSP_+3A_x2">x2</code></td>
<td>
<p>advance information for the second group</p>
</td></tr>
<tr><td><code id="WMWSSP_+3A_alpha">alpha</code></td>
<td>
<p>two sided type I error rate</p>
</td></tr>
<tr><td><code id="WMWSSP_+3A_power">power</code></td>
<td>
<p>power with the sample sizes of each group</p>
</td></tr>
<tr><td><code id="WMWSSP_+3A_t">t</code></td>
<td>
<p>proportion of subjects in the first group</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame
</p>


<h3>References</h3>

<p>Brunner, E., Bathke A. C. and Konietschke, F. Rank- and Pseudo-Rank Procedures in Factorial Designs - Using R and SAS. Springer Verlag. 
Happ, M., Bathke, A. C., &amp; Brunner, E. (2019). Optimal sample size planning for the Wilcoxon-Mann-Whitney test. Statistics in medicine, 38(3), 363-375.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x1 = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2)
x2 = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3)
WMWSSP(x1,x2,0.05,0.8,0.5)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
