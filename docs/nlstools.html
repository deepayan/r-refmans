<!DOCTYPE html><html><head><title>Help for package nlstools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nlstools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#confint2'><p>Confidence intervals in nonlinear regression</p></a></li>
<li><a href='#L.minor'><p>Enzyme kinetics</p></a></li>
<li><a href='#michaelisdata'><p>Michaelis Menten data sets</p></a></li>
<li><a href='#michaelismodels'><p> Michaelis-Menten model and derived equations to model competitive and non-competitive inhibition</p></a></li>
<li><a href='#nlsBoot'><p>Bootstrap resampling</p></a></li>
<li><a href='#nlsBootPredict'><p>Prediction from Bootstrap resampling</p></a></li>
<li><a href='#nlsConfRegions'><p>Confidence regions</p></a></li>
<li><a href='#nlsContourRSS'><p>Surface contour of RSS</p></a></li>
<li><a href='#nlsJack'><p>Jackknife resampling</p></a></li>
<li><a href='#nlsResiduals'><p>NLS residuals</p></a></li>
<li><a href='#nlstools'><p>Nonlinear least squares fit</p></a></li>
<li><a href='#nlstools-defunct'><p>Defunct Functions in Package <span class="pkg">nlstools</span></p></a></li>
<li><a href='#O2K'><p>Oxygen kinetics during 6-minute walk test data set</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>2.1-0</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools for Nonlinear Regression Analysis</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, rticles</td>
</tr>
<tr>
<td>Description:</td>
<td>Several tools for assessing the quality of fit of a gaussian nonlinear model are provided.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/lbbe-software/nlstools">https://github.com/lbbe-software/nlstools</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/lbbe-software/nlstools/issues">https://github.com/lbbe-software/nlstools/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-13 16:11:45 UTC; siberchicot</td>
</tr>
<tr>
<td>Author:</td>
<td>Florent Baty [aut],
  Marie-Laure Delignette-Muller [aut],
  Sandrine Charles [ctb],
  Jean-Pierre Flandrois [ctb],
  Christian Ritz [ctb],
  Aurelie Siberchicot [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aurelie Siberchicot &lt;aurelie.siberchicot@univ-lyon1.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-13 18:01:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='confint2'>Confidence intervals in nonlinear regression</h2><span id='topic+confint2'></span>

<h3>Description</h3>

<p>Produces confidence intervals for the parameters in nonlinear regression model fit. The intervals can either be based large sample results or on profiling.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  confint2(object, parm, level = 0.95, method = c("asymptotic", "profile"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint2_+3A_object">object</code></td>
<td>
<p>object of class <code><a href="stats.html#topic+nls">nls</a></code>.</p>
</td></tr>
<tr><td><code id="confint2_+3A_parm">parm</code></td>
<td>
<p>a vector character strings with names of the parameter for which to calculate 
confidence intervals (by default all parameters).</p>
</td></tr>
<tr><td><code id="confint2_+3A_level">level</code></td>
<td>
<p>the confidence level required.</p>
</td></tr>
<tr><td><code id="confint2_+3A_method">method</code></td>
<td>
<p>method to be used: &quot;asympotic&quot; for large sample and &quot;profile&quot; for profiling approach.</p>
</td></tr>
<tr><td><code id="confint2_+3A_...">...</code></td>
<td>
<p>additional argument(s) to pass on the method doing the profiling.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The profiling used is the method <code><a href="MASS.html#topic+confint.nls">confint.nls</a>.</code> 
</p>


<h3>Value</h3>

<p>A matrix with columns giving lower and upper confidence limits for each parameter.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>Examples</h3>

<pre><code class='language-R'>L.minor.m1 &lt;- nls(rate ~ Vm*conc/(K+conc), data = L.minor, start = list(K=20, Vm=120))
confint2(L.minor.m1)
confint2(L.minor.m1, "K")
</code></pre>

<hr>
<h2 id='L.minor'>Enzyme kinetics</h2><span id='topic+L.minor'></span>

<h3>Description</h3>

<p>Enzyme kinetics</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(L.minor)</code></pre>


<h3>Format</h3>

<p>A data frame with 8 observations on the following 2 variables.
</p>

<dl>
<dt><code>conc</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>rate</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Cedergreen, N. and Madsen, T. V. (2002) Nitrogen uptake by the floating macrophyte <em>Lemna minor</em>,
<em>New Phytologist</em>, <b>155</b>, 285&ndash;292. 
</p>

<hr>
<h2 id='michaelisdata'>Michaelis Menten data sets</h2><span id='topic+vmkm'></span><span id='topic+vmkmki'></span>

<h3>Description</h3>

<p>Michaelis Menten data sets</p>


<h3>Usage</h3>

<pre><code class='language-R'>  data(vmkm)
  data(vmkmki)
</code></pre>


<h3>Format</h3>

 
<p><code>vmkm</code> is a data frame with 2 columns (S: concentration of substrat, v: reaction rate)<br />
<code>vmkmki</code> is a data frame with 3 columns (S: concentration of substrat, I: concentration of inhibitor, v: reaction rate)
</p>


<h3>Source</h3>

<p>These datasets were provided by the French research unit INRA UMR1233.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(vmkm)
data(vmkmki)
plot(vmkm)
plot(vmkmki)
</code></pre>

<hr>
<h2 id='michaelismodels'> Michaelis-Menten model and derived equations to model competitive and non-competitive inhibition </h2><span id='topic+michaelismodels'></span><span id='topic+michaelis'></span><span id='topic+compet_mich'></span><span id='topic+non_compet_mich'></span>

<h3>Description</h3>

<p>Formula of Michaelis-Menten model commonly used to describe enzyme kinetics, and derived formulas taking into account the 
effect of a competitive or a non-competitive inhibitor
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  michaelis
  compet_mich
  non_compet_mich
</code></pre>


<h3>Details</h3>

<p>These models describe the evolution of the reaction rate (v) as a function
of the concentration of substrate (S) and the concentration of inhibitor (I) for <code>compet_mich</code> and <code>non_compet_mich</code>.
</p>
<p><code>michaelis</code> is the classical Michaelis-Menten model (Dixon, 1979)  with two parameters (Km, Vmax) :
</p>
<p style="text-align: center;"><code class="reqn">v = \frac{S}{S+K_m} V_{max}</code>
</p>
 <p><br /><br />
<code>compet_mich</code> is the Michaelis-Menten derived model with three parameters (Km, Vmax, Ki), describing
a competitive inhibition : </p>
<p style="text-align: center;"><code class="reqn">v = \frac{S}{S + K_m (1+\frac{I}{K_i})} V_{max}</code>
</p>
 <p><br /><br />
<code>non_compet_mich</code> is the Michaelis-Menten derived model with three parameters (Km, Vmax, Ki), describing
a non-competitive inhibition : </p>
<p style="text-align: center;"><code class="reqn">v = \frac{S}{(S+K_m)(1+\frac{I}{Ki})} V_{max}</code>
</p>
 <p><br /><br />
</p>


<h3>Value</h3>

<p>A formula</p>


<h3>Author(s)</h3>

<p>Florent Baty, Marie-Laure Delignette-Muller</p>


<h3>References</h3>

 
<p>Dixon M and Webb EC (1979) <em>Enzymes</em>, Academic Press, New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1

data(vmkm)
nls1 &lt;- nls(michaelis,vmkm,list(Km=1,Vmax=1))
plotfit(nls1, smooth = TRUE)

# Example 2

data(vmkmki)
def.par &lt;- par(no.readonly = TRUE)
par(mfrow = c(2,2))

nls2_c &lt;- nls(compet_mich, vmkmki, list(Km=1,Vmax=20,Ki=0.5))
plotfit(nls2_c, variable=1)
overview(nls2_c)
res2_c &lt;- nlsResiduals(nls2_c)
plot(res2_c, which=1)

nls2_nc &lt;- nls(non_compet_mich, vmkmki, list(Km=1, Vmax=20, Ki=0.5))
plotfit(nls2_nc, variable=1)
overview(nls2_nc)
res2_nc &lt;- nlsResiduals(nls2_nc)
plot(res2_nc, which=1)

par(def.par)
</code></pre>

<hr>
<h2 id='nlsBoot'>Bootstrap resampling</h2><span id='topic+nlsBoot'></span><span id='topic+plot.nlsBoot'></span><span id='topic+print.nlsBoot'></span><span id='topic+summary.nlsBoot'></span>

<h3>Description</h3>

<p>Bootstrap resampling</p>


<h3>Usage</h3>

<pre><code class='language-R'>  nlsBoot (nls, niter = 999)
  ## S3 method for class 'nlsBoot'
 plot(x, type = c("pairs", "boxplot"), 
      mfr = c(ceiling(sqrt(ncol(x$coefboot))), 
      ceiling(sqrt(ncol(x$coefboot)))), 
      ask = FALSE, ...)
  ## S3 method for class 'nlsBoot'
 print(x, ...)
  ## S3 method for class 'nlsBoot'
 summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlsBoot_+3A_nls">nls</code></td>
<td>
<p>an object of class 'nls'</p>
</td></tr>
<tr><td><code id="nlsBoot_+3A_niter">niter</code></td>
<td>
<p>number of iterations</p>
</td></tr>
<tr><td><code id="nlsBoot_+3A_x">x</code>, <code id="nlsBoot_+3A_object">object</code></td>
<td>
<p>an object of class 'nlsBoot'</p>
</td></tr>
<tr><td><code id="nlsBoot_+3A_type">type</code></td>
<td>
<p>type of representation (options are &quot;pairs&quot; or &quot;boxplot&quot;)</p>
</td></tr>
<tr><td><code id="nlsBoot_+3A_mfr">mfr</code></td>
<td>
<p>layout definition (number of rows and columns in the graphics device)</p>
</td></tr>
<tr><td><code id="nlsBoot_+3A_ask">ask</code></td>
<td>
<p>if TRUE, draw plot interactively</p>
</td></tr>
<tr><td><code id="nlsBoot_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Non-parametric bootstrapping is used. Mean centered residuals are bootstrapped. By default, 999 resampled data sets are created from which parameter estimates are obtained by fitting the model on each of these data sets. Whenever the fit fails to converge, a flag reports the number of non-convergences. If the fitting procedure fails to converge in more than 50% of the cases, the procedure is interrupted with a flag and no result is given. The function <code>summary</code> returns the bootstrap estimates (mean and std. dev. of the bootstrapped estimates) and the median and 95 percent confidence intervals (50, 2.5, and 97.5 percentiles of the bootstrapped estimates). The bootstrapped estimate distributions can be visualized using the function <code>plot.nlsBoot</code> either by plotting the bootstrapped sample for each pair of parameters or by displaying the boxplot representation of the bootstrapped sample for each parameter. Notice that <code>nlsBoot</code> does not currently handle transformed dependent variables specified in the left side of the <code>nls</code> formula.  
</p>


<h3>Value</h3>

 
<p><code>nlsBoot</code> returns a list of 5 objects:
</p>
<table>
<tr><td><code>coefboot</code></td>
<td>
<p>contains the bootstrap parameter estimates</p>
</td></tr>
<tr><td><code>bootCI</code></td>
<td>
<p>contains the bootstrap medians and the bootstrap 95% confidence intervals</p>
</td></tr>
<tr><td><code>estiboot</code></td>
<td>
<p>contains the means and std. errors of the bootstrap parameter estimates</p>
</td></tr>
<tr><td><code>rse</code></td>
<td>
<p>is the vector of bootstrap residual errors</p>
</td></tr>
<tr><td><code>nls</code></td>
<td>
<p>the object of class 'nls' given in input</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Florent Baty, Marie-Laure Delignette-Muller</p>


<h3>References</h3>

 
<p>Bates DM and Watts DG (1988) Nonlinear regression analysis and its applications. Wiley, Chichester, UK.<br /><br />
Huet S, Bouvier A, Poursat M-A, Jolivet E (2003) Statistical tools for nonlinear regression: a practical guide with S-PLUS and R examples. Springer, Berlin, Heidelberg, New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>formulaExp &lt;- as.formula(VO2 ~ (t &lt;= 5.883) * VO2res + (t &gt; 5.883) * 
                        (VO2res + (VO2peak - VO2res) * 
                        (1 - exp(-(t - 5.883) / mu))))
O2K.nls1 &lt;- nls(formulaExp, start = list(VO2res = 400, VO2peak = 1600, 
                mu = 1), data = O2K)
O2K.boot1 &lt;- nlsBoot(O2K.nls1, niter = 200)
plot(O2K.boot1)
plot(O2K.boot1, type = "boxplot", ask = FALSE)
summary(O2K.boot1)
  </code></pre>

<hr>
<h2 id='nlsBootPredict'>Prediction from Bootstrap resampling </h2><span id='topic+nlsBootPredict'></span>

<h3>Description</h3>

<p>Computation of confidence intervals on predictions from Bootstrap resampling</p>


<h3>Usage</h3>

<pre><code class='language-R'>  nlsBootPredict(nlsBoot, newdata, interval = c("confidence", "prediction")) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlsBootPredict_+3A_nlsboot">nlsBoot</code></td>
<td>
<p> An object of class 'nlsBoot'.</p>
</td></tr>
<tr><td><code id="nlsBootPredict_+3A_newdata">newdata</code></td>
<td>
<p> A data frame in which to look for values of independent variables 
for the predictions.If omitted, the data used for fitting are used.</p>
</td></tr>
<tr><td><code id="nlsBootPredict_+3A_interval">interval</code></td>
<td>
<p> Type of interval to compute, &quot;confidence&quot;, or &quot;prediction&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>nlsBootPredict</code> produces confidence intervals on predicted values 
that can be obtained using <code><a href="stats.html#topic+predict.nls">predict.nls</a></code> for values of the
independent variable(s) defined in the data frame newdata. 
Non-parametric bootstrapping is used (results of <code>nlsBoot</code>). 
For confidence intervals the bootstrap sample of predictions is simply computed
from the bootstrap sample of estimations of the model parameters, by evaluating
the mean value of the model on each new data. For prediction intervals, 
to take into account the residual errors, a residual error sampled
in the mean centered residuals is added to each mean predicted
value. In both cases, bootstrap predictions are summarized by the median and 95 
percent confidence intervals (50, 2.5, and 97.5 percentiles of the bootstrapped values).   
</p>


<h3>Value</h3>

 
<p><code><a href="#topic+nlsBoot">nlsBoot</a></code> returns a matrix of predictions with three columns 
respectively corresponding to the 50, 2.5 and 97.5 percentiles of bootstrap predictions.
</p>


<h3>Author(s)</h3>

<p>Florent Baty, Marie-Laure Delignette-Muller</p>


<h3>References</h3>

<p>Huet S, Bouvier A, Poursat M-A, Jolivet E (2003) Statistical tools for nonlinear regression: a practical guide with S-PLUS and R examples. Springer, Berlin, Heidelberg, New York.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+nlsBoot">nlsBoot</a></code> and <code><a href="stats.html#topic+predict.nls">predict.nls</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>formulaExp &lt;- as.formula(VO2 ~ (t &lt;= 5.883) * VO2res + (t &gt; 5.883) * 
                        (VO2res + (VO2peak - VO2res) * 
                        (1 - exp(-(t - 5.883) / mu))))
O2K.nls1 &lt;- nls(formulaExp, start = list(VO2res = 400, VO2peak = 1600, mu = 1), data = O2K)
niter &lt;- 200

### To reach stable prediction intervals use far greater niter (&gt;&gt; 1000)
O2K.boot1 &lt;- nlsBoot(O2K.nls1, niter = niter)
newdata &lt;- data.frame(t = seq(0, 12, length.out = 50))
(pred.clim &lt;- nlsBootPredict(O2K.boot1, newdata = newdata, interval = "confidence"))
(pred.plim &lt;- nlsBootPredict(O2K.boot1, newdata = newdata, interval = "prediction"))

plotfit(O2K.nls1, smooth = TRUE, ylim = c(200, 1800))
lines(newdata$t, pred.clim[, 2], col = "red")
lines(newdata$t, pred.clim[, 3], col = "red")
lines(newdata$t, pred.plim[, 2], col = "blue")
lines(newdata$t, pred.plim[, 3], col = "blue")

### An example without giving newdata

# plot of data
plot(O2K$t, O2K$VO2)

# add of predictions computed using predict.nls()
pred &lt;- predict(O2K.nls1)
points(O2K$t, pred, pch = 16)

# add of prediction intervals using nlsBootPredict()
(pred.plim &lt;- nlsBootPredict(O2K.boot1, interval = "prediction"))
segments(O2K$t, pred.plim[, 2], O2K$t, pred.plim[, 3], col = "blue")
</code></pre>

<hr>
<h2 id='nlsConfRegions'>Confidence regions</h2><span id='topic+nlsConfRegions'></span><span id='topic+plot.nlsConfRegions'></span><span id='topic+print.nlsConfRegions'></span>

<h3>Description</h3>

<p>Draws parameter values in the Beale's 95 percent unlinearized confidence region</p>


<h3>Usage</h3>

<pre><code class='language-R'>    nlsConfRegions (nls, length = 1000, exp = 1.5)
    ## S3 method for class 'nlsConfRegions'
 plot(x, bounds = FALSE, ask = FALSE, ...)
    ## S3 method for class 'nlsConfRegions'
 print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlsConfRegions_+3A_nls">nls</code></td>
<td>
<p>an object of class 'nls'</p>
</td></tr>
<tr><td><code id="nlsConfRegions_+3A_length">length</code></td>
<td>
<p>number of points to draw in the confidence region</p>
</td></tr>
<tr><td><code id="nlsConfRegions_+3A_exp">exp</code></td>
<td>
<p>expansion factor of the hypercube in which random values of parameters are drawn</p>
</td></tr>
<tr><td><code id="nlsConfRegions_+3A_x">x</code></td>
<td>
<p>an object of class 'nlsConfRegions'</p>
</td></tr>
<tr><td><code id="nlsConfRegions_+3A_bounds">bounds</code></td>
<td>
<p>logical defining whether bounds of the drawing hypercube are plotted</p>
</td></tr>
<tr><td><code id="nlsConfRegions_+3A_ask">ask</code></td>
<td>
<p>if TRUE, draw plot interactively</p>
</td></tr>
<tr><td><code id="nlsConfRegions_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A sample of points in the 95 percent confidence region is computed according to Beale's criterion (Beale, 1960). This region is also named the joint parameter likelihood region (Bates and Watts, 1988). The method used consists in a random sampling of parameters values in a hypercube centered on the least squares estimate and rejecting the parameters values whose residual sum of squares do not verify the Beale criterion. The confidence region is plotted by projection of the sampled points in each plane defined by a couple of parameters. Bounds of the hypercube in which random values of parameters are drawn may be plotted in order to check if the confidence region was totally included in the hypercube defined by default. If not the hypercube should be expanded in order to obtain the full confidence region
</p>


<h3>Value</h3>

 
<p><code>nlsConfRegions</code> returns a list of four objects:
</p>
<table>
<tr><td><code>cr</code></td>
<td>
<p>a data frame containing the sample drawn in the Beale's confidence region</p>
</td></tr>
<tr><td><code>rss</code></td>
<td>
<p>a vector containing the residual sums of squares corresponding to <code>cr</code></p>
</td></tr>
<tr><td><code>rss95</code></td>
<td>
<p>the 95 percent residual sum of squares threshold according to Beale (1960)</p>
</td></tr>
<tr><td><code>bounds</code></td>
<td>
<p>lower and upper bounds of the hypercube in which random values of parameters have been drawn</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Florent Baty, Marie-Laure Delignette-Muller</p>


<h3>References</h3>

 
<p>Beale EML (1960) Confidence regions in non-linear estimations. <em>Journal of the Royal Statistical Society</em>, <b>22B</b>, 41-88.<br /><br />
Bates DM and Watts DG (1988) Nonlinear regression analysis and its applications. Wiley, Chichester, UK.
</p>


<h3>See Also</h3>

<p><code>ellipse.nls</code> in the <code>ellipse</code> library
</p>


<h3>Examples</h3>

<pre><code class='language-R'>formulaExp &lt;- as.formula(VO2 ~ (t &lt;= 5.883) * VO2rest + (t &gt; 5.883) * 
                        (VO2rest + (VO2peak - VO2rest) * 
                        (1 - exp(-(t - 5.883) / mu))))
O2K.nls1 &lt;- nls(formulaExp, start = list(VO2rest = 400, VO2peak = 1600, 
                mu = 1), data = O2K)
O2K.conf1 &lt;- nlsConfRegions(O2K.nls1, exp = 2, length = 200)
plot(O2K.conf1, bounds = TRUE)
</code></pre>

<hr>
<h2 id='nlsContourRSS'>Surface contour of RSS</h2><span id='topic+nlsContourRSS'></span><span id='topic+plot.nlsContourRSS'></span><span id='topic+print.nlsContourRSS'></span>

<h3>Description</h3>

<p>Provides residual sum of squares (RSS) contours</p>


<h3>Usage</h3>

<pre><code class='language-R'>  nlsContourRSS (nls, lseq = 100, exp = 2)
  ## S3 method for class 'nlsContourRSS'
 plot(x, nlev = 0, col = TRUE, col.pal = terrain.colors(100), 
                                ask = FALSE, useRaster = TRUE, ...)
  ## S3 method for class 'nlsContourRSS'
 print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlsContourRSS_+3A_nls">nls</code></td>
<td>
<p>an object of class 'nls'</p>
</td></tr>
<tr><td><code id="nlsContourRSS_+3A_lseq">lseq</code></td>
<td>
<p>length of the sequences of parameters</p>
</td></tr>
<tr><td><code id="nlsContourRSS_+3A_exp">exp</code></td>
<td>
<p>expansion factor of the parameter intervals defining the grids</p>
</td></tr>
<tr><td><code id="nlsContourRSS_+3A_nlev">nlev</code></td>
<td>
<p>number of contour levels to add to the likelihood contour at level 95 percent</p>
</td></tr>
<tr><td><code id="nlsContourRSS_+3A_col">col</code></td>
<td>
<p>logical. Contours are plotted with colors if <code>TRUE</code></p>
</td></tr>
<tr><td><code id="nlsContourRSS_+3A_col.pal">col.pal</code></td>
<td>
<p>Palette of colors. Colors to be used as background (default is terrain.colors(100); unused if col is FALSE)</p>
</td></tr>
<tr><td><code id="nlsContourRSS_+3A_x">x</code></td>
<td>
<p>an object of class 'nlsContourRSS'</p>
</td></tr>
<tr><td><code id="nlsContourRSS_+3A_ask">ask</code></td>
<td>
<p>if TRUE, draw plot interactively (default is FALSE)</p>
</td></tr>
<tr><td><code id="nlsContourRSS_+3A_useraster">useRaster</code></td>
<td>
<p>a bitmap raster is used to plot the image instead of polygons (default is TRUE)</p>
</td></tr>
<tr><td><code id="nlsContourRSS_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The aim of these functions is to plot the residual sum of squares (RSS) contours which correspond to likelihood contours for a Gaussian model. For each pair of parameters the RSS is calculated on a grid centered on the least squares estimates of both parameters, the other parameters being fixed to their least square estimates. The contours of RSS values are then plotted for each pair of parameters. For each pair of parameters, one of this contour corresponds to a section of the 95 percent Beale's confidence region in the plane of these parameters. This contour is plotted in a different color.
</p>


<h3>Value</h3>

 
<p><code>nlsContourRSS</code> returns a list of three objects:
</p>
<table>
<tr><td><code>seqPara</code></td>
<td>
<p>a matrix with the sequence of grid values for each parameter</p>
</td></tr>
<tr><td><code>lrss</code></td>
<td>
<p>a list of matrices with logarithm values of RSS in the grid for each pair of parameters</p>
</td></tr>
<tr><td><code>lrss95</code></td>
<td>
<p>the logarithm of the 95 percent residual sum of squares threshold according to Beale (1960)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Florent Baty, Marie-Laure Delignette-Muller</p>


<h3>References</h3>

 
<p>Beale EML (1960) Confidence regions in non-linear estimations. <em>Journal of the Royal Statistical Society</em>, <b>22B</b>, 41-88.<br /><br />
Bates DM and Watts DG (1988) Nonlinear regression analysis and its applications. Wiley, Chichester, UK.<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>formulaExp &lt;- as.formula(VO2 ~ (t &lt;= 5.883) * VO2rest + (t &gt; 5.883) * 
                        (VO2rest + (VO2peak - VO2rest) * 
                        (1 - exp(-(t - 5.883) / mu))))
O2K.nls1 &lt;- nls(formulaExp, start = list(VO2rest = 400, VO2peak = 1600, 
                mu = 1), data = O2K)
O2K.cont1 &lt;- nlsContourRSS(O2K.nls1)
plot(O2K.cont1)
</code></pre>

<hr>
<h2 id='nlsJack'>Jackknife resampling</h2><span id='topic+nlsJack'></span><span id='topic+plot.nlsJack'></span><span id='topic+print.nlsJack'></span><span id='topic+summary.nlsJack'></span>

<h3>Description</h3>

<p>Jackknife resampling</p>


<h3>Usage</h3>

<pre><code class='language-R'>  nlsJack (nls)
  ## S3 method for class 'nlsJack'
 plot(x, mfr = c(nrow(x$reldif),1), ask = FALSE, ...)
  ## S3 method for class 'nlsJack'
 print(x, ...)
  ## S3 method for class 'nlsJack'
 summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlsJack_+3A_nls">nls</code></td>
<td>
<p>an object of class 'nls'</p>
</td></tr>
<tr><td><code id="nlsJack_+3A_x">x</code>, <code id="nlsJack_+3A_object">object</code></td>
<td>
<p>an object of class 'nlsJack'</p>
</td></tr>
<tr><td><code id="nlsJack_+3A_mfr">mfr</code></td>
<td>
<p>layout definition, default is k rows (k: number of parameters) and 1 column</p>
</td></tr>
<tr><td><code id="nlsJack_+3A_ask">ask</code></td>
<td>
<p>if TRUE, draw plot interactively</p>
</td></tr>
<tr><td><code id="nlsJack_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A jackknife resampling procedure is performed. Each observation is sequentially removed from the initial data set using a leave-one-out strategy. A data set with <em>n</em> observations provides thus <em>n</em> resampled data sets of <em>n-1</em> observations. The jackknife estimates with confidence intervals are calculated as described by Seber and Wild (1989) from the results of <em>n</em> new fits of the model on the <em>n</em> jackknife resampled data sets. The leave-one-out procedure is also employed to assess the influence of each observation on each parameter estimate. An observation is empirically defined as influential for one parameter if the difference between the estimate of this parameter with and without the observation exceeds twice the standard error of the estimate divided by <em>sqrt(n)</em>. This empirical method assumes a small curvature of the nonlinear model. For each parameter, the absolute relative difference (in percent of the estimate) of the estimates with and without each observation is plotted. An asterisk is plotted for each influential observation.
</p>


<h3>Value</h3>

 
<p><code>nlsJack</code> returns a list with 7 objects:
</p>
<table>
<tr><td><code>estijack</code></td>
<td>
<p>a data frame with jackknife estimates and bias</p>
</td></tr>
<tr><td><code>coefjack</code></td>
<td>
<p>a data frame with the parameter estimates for each jackknife sample</p>
</td></tr>
<tr><td><code>reldif</code></td>
<td>
<p>a data frame with the absolute relative difference (in percent of the estimate) of the estimates with and without each observation</p>
</td></tr>
<tr><td><code>dfb</code></td>
<td>
<p>a data frame with dfbetas for each parameter and each observation</p>
</td></tr>
<tr><td><code>jackCI</code></td>
<td>
<p>a data frame with jackknife confidence intervals</p>
</td></tr>
<tr><td><code>rse</code></td>
<td>
<p>a vector with residual standard error for each jackknife sample</p>
</td></tr>
<tr><td><code>rss</code></td>
<td>
<p>residual a vector with residual sum of squares for each jackknife sample</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Florent Baty, Marie-Laure Delignette-Muller</p>


<h3>References</h3>

 
<p>Seber GAF, Wild CJ (1989) Nonlinear regression. Wiley, New York.<br /><br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>formulaExp &lt;- as.formula(VO2 ~ (t &lt;= 5.883) * VO2rest + (t &gt; 5.883) * 
                        (VO2rest + (VO2peak - VO2rest) * 
                        (1 - exp(-(t - 5.883) / mu))))
O2K.nls1 &lt;- nls(formulaExp, start = list(VO2rest = 400, VO2peak = 1600, mu = 1), 
               data = O2K)
O2K.jack1 &lt;- nlsJack(O2K.nls1)
plot(O2K.jack1)
summary(O2K.jack1)
</code></pre>

<hr>
<h2 id='nlsResiduals'>NLS residuals</h2><span id='topic+nlsResiduals'></span><span id='topic+plot.nlsResiduals'></span><span id='topic+test.nlsResiduals'></span><span id='topic+print.nlsResiduals'></span>

<h3>Description</h3>

<p>Provides several plots and tests for the analysis of residuals</p>


<h3>Usage</h3>

<pre><code class='language-R'>  nlsResiduals (nls)
  ## S3 method for class 'nlsResiduals'
 plot(x, which = 0, ...)
  test.nlsResiduals (x)
  ## S3 method for class 'nlsResiduals'
 print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlsResiduals_+3A_nls">nls</code></td>
<td>
<p>an object of class 'nls'</p>
</td></tr>
<tr><td><code id="nlsResiduals_+3A_x">x</code></td>
<td>
<p>an object of class 'nlsResiduals'</p>
</td></tr>
<tr><td><code id="nlsResiduals_+3A_which">which</code></td>
<td>
<p>an integer: <br />
0 = 4 graphs of residuals (types 1, 2, 4 and 6) <br />
1 = non-transformed residuals against fitted values <br /> 
2 = standardized residuals against fitted values <br />
3 = sqrt of absolute value of standardized residuals against fitted values <br /> 
4 = auto-correlation residuals (i+1th residual against ith residual) <br /> 
5 = histogram of the residuals  <br />
6 = qq-plot of the residuals</p>
</td></tr>
<tr><td><code id="nlsResiduals_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Several plots and tests are proposed to check the validity of the assumptions of the error model based on the analysis of residuals.<br />
The function <code>plot.nlsResiduals</code> proposes several plots of residuals from the nonlinear fit: plot of non-transformed residuals against fitted values, plot of standardized residuals against fitted values, plot of square root of absolute value of standardized residuals against fitted values, auto-correlation plot of residuals (i+1th residual against ith residual), histogram of the non-transformed residuals and normal Q-Q plot of standardized residuals.<br />
<code>test.nlsResiduals</code> tests the normality of the residuals with the Shapiro-Wilk test (shapiro.test in package stats) and the randomness of residuals  with the runs test (Siegel and Castellan, 1988). The runs.test function used in <code>nlstools</code> is the one implemented in the package <code>tseries</code>.
</p>


<h3>Value</h3>

<p><code>nlsResiduals</code> returns a list of five objects:
</p>
<table>
<tr><td><code>std95</code></td>
<td>
<p>the Student value for alpha=0.05 (bilateral) and the degree of freedom of the model</p>
</td></tr>
<tr><td><code>resi1</code></td>
<td>
<p>a matrix with fitted values vs. non-transformed residuals</p>
</td></tr>
<tr><td><code>resi2</code></td>
<td>
<p>a matrix with fitted values vs. standardized residuals</p>
</td></tr>
<tr><td><code>resi3</code></td>
<td>
<p>a matrix with fitted values vs. sqrt(abs(standardized residuals))</p>
</td></tr>
<tr><td><code>resi4</code></td>
<td>
<p>a matrix with ith residuals vs. i+1th residuals</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Florent Baty, Marie-Laure Delignette-Muller</p>


<h3>References</h3>

 
<p>Bates DM and Watts DG (1988) Nonlinear regression analysis and its applications. Wiley, Chichester, UK.<br /><br />
Siegel S and Castellan NJ (1988) Non parametric statistics for behavioral sciences. McGraw-Hill international, New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plots of residuals
formulaExp &lt;- as.formula(VO2 ~ (t &lt;= 5.883) * VO2rest + (t &gt; 5.883) * 
                        (VO2rest + (VO2peak - VO2rest) * 
                        (1 - exp(-(t - 5.883) / mu))))
O2K.nls1 &lt;- nls(formulaExp, start = list(VO2rest = 400, VO2peak = 1600, mu = 1), 
               data = O2K)
O2K.res1 &lt;- nlsResiduals(O2K.nls1)
plot(O2K.res1, which = 0)

# Histogram and qq-plot
plot(O2K.res1, which = 5)
plot(O2K.res1, which = 6)
	
# Tests
test.nlsResiduals(O2K.res1)
</code></pre>

<hr>
<h2 id='nlstools'>Nonlinear least squares fit</h2><span id='topic+nlstools'></span><span id='topic+preview'></span><span id='topic+plotfit'></span><span id='topic+overview'></span>

<h3>Description</h3>

<p>Tools to help the fit of nonlinear models with nls</p>


<h3>Usage</h3>

<pre><code class='language-R'>  preview (formula, data, start, variable = 1)
  plotfit (x, smooth = FALSE, variable = 1, xlab = NULL, ylab = NULL, 
           pch.obs = 1, pch.fit = "+", lty = 1, lwd = 1, col.obs = "black", 
           col.fit = "red", ...)
  overview (x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlstools_+3A_formula">formula</code></td>
<td>
<p>formula of a non-linear model</p>
</td></tr>
<tr><td><code id="nlstools_+3A_data">data</code></td>
<td>
<p>a data frame with header matching the variables given in the formula</p>
</td></tr>
<tr><td><code id="nlstools_+3A_start">start</code></td>
<td>
<p>a list of parameter starting values which names match the parameters given in the formula</p>
</td></tr>
<tr><td><code id="nlstools_+3A_variable">variable</code></td>
<td>
<p>index of the variable to be plotted against the predicted values; default is the first independent variable as it appears in the orginal dataset</p>
</td></tr>
<tr><td><code id="nlstools_+3A_x">x</code></td>
<td>
<p>an object of class 'nls'</p>
</td></tr>
<tr><td><code id="nlstools_+3A_smooth">smooth</code></td>
<td>
<p>a logical value, default is FALSE. If smooth is TRUE, a plot of observed values is plotted as a function of 1000 values continuously taken in the range interval [min(variable),max(variable)]. This option can only be used if the number of controlled variables is 1.</p>
</td></tr>
<tr><td><code id="nlstools_+3A_xlab">xlab</code></td>
<td>
<p>X-label</p>
</td></tr>
<tr><td><code id="nlstools_+3A_ylab">ylab</code></td>
<td>
<p>Y-label</p>
</td></tr>
<tr><td><code id="nlstools_+3A_pch.obs">pch.obs</code></td>
<td>
<p>type of point of the observed values</p>
</td></tr>
<tr><td><code id="nlstools_+3A_pch.fit">pch.fit</code></td>
<td>
<p>type of point of the fitted values (not applicable if smooth=TRUE)</p>
</td></tr>
<tr><td><code id="nlstools_+3A_lty">lty</code></td>
<td>
<p>type of line of the smoothed fitted values (if smooth=TRUE)</p>
</td></tr>
<tr><td><code id="nlstools_+3A_lwd">lwd</code></td>
<td>
<p>thickness of line of the smoothed fitted values (if smooth=TRUE)</p>
</td></tr>
<tr><td><code id="nlstools_+3A_col.obs">col.obs</code></td>
<td>
<p>color of the observed points</p>
</td></tr>
<tr><td><code id="nlstools_+3A_col.fit">col.fit</code></td>
<td>
<p>color of the fitted values</p>
</td></tr>
<tr><td><code id="nlstools_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>preview</code> helps defining the parameter starting values prior fitting the model. It provides a superimposed plot of observed (circles) and predicted (crosses) values of the dependent variable versus one of the independent variables with the model evaluated at the starting values of the parameters. The function <code>overview</code> returns the parameters estimates, their standard errors as well as their asymptotic confidence intervals and the correlation matrix (alternately, the function <code>confint</code> provides better confidence interval estimates whenever it converges). <code>plotfit</code> displays a superimposed plot of the dependent variable versus one the independent variables together with the fitted model.
</p>


<h3>Author(s)</h3>

<p>Florent Baty, Marie-Laure Delignette-Muller</p>


<h3>References</h3>

 
<p>Baty F, Ritz C, Charles S, Brutsche M, Flandrois J-P, Delignette-Muller M-L (2015). A Toolbox for Nonlinear Regression in R: The Package nlstools. <em>Journal of Statistical Software</em>, <b>66</b>(5), 1-21.<br /><br />
Bates DM and Watts DG (1988) Nonlinear regression analysis and its applications. Wiley, Chichester, UK.
</p>


<h3>See Also</h3>

<p><code>nls</code> in the <code>stats</code> library and <code>confint.nls</code> in the package <code>MASS</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>formulaExp &lt;- as.formula(VO2 ~ (t &lt;= 5.883) * VO2rest + (t &gt; 5.883) * 
                        (VO2rest + (VO2peak - VO2rest) * 
                        (1 - exp(-(t - 5.883) / mu))))
preview(formulaExp, O2K, list(VO2rest = 400, VO2peak = 1600, mu = 1))
O2K.nls1 &lt;- nls(formulaExp, start = list(VO2rest = 400, VO2peak = 1600, 
                mu = 1), data = O2K)
overview(O2K.nls1)
plotfit(O2K.nls1, smooth = TRUE)
</code></pre>

<hr>
<h2 id='nlstools-defunct'>Defunct Functions in Package <span class="pkg">nlstools</span></h2><span id='topic+nlstools-defunct'></span>

<h3>Description</h3>

<p>The models or data sets listed here are no longer part of package <span class="pkg">nlstools</span>. In order to access these models and data set in the future, please load the additional package <span class="pkg">nlsMicrobio</span>.
</p>


<h3>Details</h3>

<p>Defunct functions are:<br />
<code>geeraerd</code><br />
<code>geeraerd_without_Nres</code><br />
<code>geeraerd_without_Sl</code><br />
<code>mafart</code><br />
<code>albert</code><br />
<code>trilinear</code><br />
<code>bilinear_without_Nres</code><br />
<code>bilinear_without_Sl</code><br />
<code>baranyi</code><br />
<code>baranyi_without_Nmax</code><br />
<code>baranyi_without_lag</code><br />
<code>buchanan</code><br />
<code>buchanan_without_Nmax</code><br />
<code>buchanan_without_lag</code><br />
<code>gompertzm</code><br />
<code>jameson_buchanan</code><br />
<code>jameson_baranyi</code><br />
<code>jameson_without_lag</code><br />
<code>cpm_T</code><br />
<code>cpm_pH_4p</code><br />
<code>cpm_pH_3p</code><br />
<code>cpm_aw_3p</code><br />
<code>cpm_aw_2p</code><br />
<code>cpm_T_pH_aw</code><br />
<code>competition1</code><br />
<code>competition2</code><br />
<code>growthcurve1</code><br />
<code>growthcurve2</code><br />
<code>growthcurve3</code><br />
<code>growthcurve4</code><br />
<code>ross</code><br />
<code>survivalcurve1</code><br />
<code>survivalcurve2</code><br />
<code>survivalcurve3</code><br />
</p>

<hr>
<h2 id='O2K'>Oxygen kinetics during 6-minute walk test data set</h2><span id='topic+O2K'></span>

<h3>Description</h3>

<p>Oxygen uptake kinetics during a 6-minute walking test in a patient with pulmonary disease. The first 5.83 minutes correspond to the resting phase prior to exercise.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  data(O2K)
</code></pre>


<h3>Format</h3>

 
<p><code>O2K</code> is a data frame with 2 columns (t: time, VO2: oxygen uptake)
</p>


<h3>Source</h3>

<p>This data set was provided by the Cantonal Hospital St. Gallen, Switzerland.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(O2K)
plot(O2K)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
