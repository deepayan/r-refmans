<!DOCTYPE html><html><head><title>Help for package slfm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {slfm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#plot_matrix'><p>plot_matrix</p></a></li>
<li><a href='#print.slfm'><p>Print method for an slfm object</p></a></li>
<li><a href='#process_matrix'><p>process_matrix</p></a></li>
<li><a href='#slfm'><p>slfm</p></a></li>
<li><a href='#slfm_list'><p>slfm_list</p></a></li>
<li><a href='#slfm_package'><p>slfm: Fitting a Bayesian Sparse Latent Factor Model in Gene Expression Analysis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fitting a Bayesian Sparse Latent Factor Model in Gene Expression
Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Vinicius Mayrink [aut, cre],
  Joao Duarte [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Vinicius Mayrink &lt;vdinizm@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Set of tools to find coherent patterns in gene expression (microarray) data using a Bayesian Sparse Latent Factor Model (SLFM) &lt;<a href="https://doi.org/10.1007%2F978-3-319-12454-4_15">doi:10.1007/978-3-319-12454-4_15</a>&gt;. Considerable effort has been put to build a fast and memory efficient package, which makes this proposal an interesting and computationally convenient alternative to study patterns of gene expressions exhibited in matrices. The package contains the implementation of two versions of the model based on different mixture priors for the loadings: one relies on a degenerate component at zero and the other uses a small variance normal distribution for the spike part of the mixture. </td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.11.0), coda, lattice</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-28 17:51:24 UTC; vinicius</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-28 18:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='plot_matrix'>plot_matrix</h2><span id='topic+plot_matrix'></span>

<h3>Description</h3>

<p>Function to build a heat map displaying the values of given data matrix. This graph is useful for a visual inspection of the 
spatial distribution of the observations within the target matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_matrix(
  y,
  standardize.rows = TRUE,
  reorder.rows = TRUE,
  reorder.cols = TRUE,
  high.contrast = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_matrix_+3A_y">y</code></td>
<td>
<p>data matrix to be evaluated.</p>
</td></tr>
<tr><td><code id="plot_matrix_+3A_standardize.rows">standardize.rows</code></td>
<td>
<p>logical argument (default = TRUE) indicating whether to standardize 
the rows of y to build the image.</p>
</td></tr>
<tr><td><code id="plot_matrix_+3A_reorder.rows">reorder.rows</code></td>
<td>
<p>logical argument (default = TRUE) indicating whether to reorder the rows 
of y to highlight a pattern.</p>
</td></tr>
<tr><td><code id="plot_matrix_+3A_reorder.cols">reorder.cols</code></td>
<td>
<p>logical argument (default = TRUE) indicating whether to reorder the columns 
of y to highlight a pattern.</p>
</td></tr>
<tr><td><code id="plot_matrix_+3A_high.contrast">high.contrast</code></td>
<td>
<p>logical argument (default = TRUE) indicating whether to apply a transformation 
to increase contrast in the image of y.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+slfm">slfm</a></code>, <code><a href="#topic+process_matrix">process_matrix</a></code>, <code><a href="#topic+slfm_list">slfm_list</a></code>
</p>

<hr>
<h2 id='print.slfm'>Print method for an slfm object</h2><span id='topic+print.slfm'></span>

<h3>Description</h3>

<p>Print method for an slfm object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slfm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.slfm_+3A_x">x</code></td>
<td>
<p>object of the class 'slfm'.</p>
</td></tr>
<tr><td><code id="print.slfm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>

<hr>
<h2 id='process_matrix'>process_matrix</h2><span id='topic+process_matrix'></span>

<h3>Description</h3>

<p>Function to apply a procedure to pre-process the gene expression data saved in matrices. This pre-processing step 
is required to allow a fair analysis of the results obtained from the SLFM model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_matrix(path, output_path, sample_size)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="process_matrix_+3A_path">path</code></td>
<td>
<p>path to the directory containing the set of matrices to be pre-processed.</p>
</td></tr>
<tr><td><code id="process_matrix_+3A_output_path">output_path</code></td>
<td>
<p>path to the directory intended to acommodate the saved pre-processed matrices.</p>
</td></tr>
<tr><td><code id="process_matrix_+3A_sample_size">sample_size</code></td>
<td>
<p>number of matrices to be used on the principal component analysis.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+slfm">slfm</a></code>, <code><a href="#topic+slfm_list">slfm_list</a></code>, <code><a href="#topic+plot_matrix">plot_matrix</a></code>
</p>

<hr>
<h2 id='slfm'>slfm</h2><span id='topic+slfm'></span>

<h3>Description</h3>

<p>Bayesian Sparse Latent Factor Model (SLFM) designed for the analysis of coherent patterns in gene expression data matrices. Details about the methodology
being applied here can be found in <em>Duarte and Mayrink (2015)</em> and <em>Duarte and Mayrink (2019)</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slfm(
  x,
  a = 2.1,
  b = 1.1,
  gamma_a = 1,
  gamma_b = 1,
  omega_0 = 0.01,
  omega_1 = 10,
  sample = 1000,
  burnin = round(0.25 * sample),
  lag = 1,
  degenerate = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slfm_+3A_x">x</code></td>
<td>
<p>matrix with the pre-processed data.</p>
</td></tr>
<tr><td><code id="slfm_+3A_a">a</code></td>
<td>
<p>positive shape parameter of the Inverse Gamma prior distribution (default = 2.1).</p>
</td></tr>
<tr><td><code id="slfm_+3A_b">b</code></td>
<td>
<p>positive scale parameter of the Inverse Gamma prior distribution (default = 1.1).</p>
</td></tr>
<tr><td><code id="slfm_+3A_gamma_a">gamma_a</code></td>
<td>
<p>positive 1st shape parameter of the Beta prior distribution (default = 1).</p>
</td></tr>
<tr><td><code id="slfm_+3A_gamma_b">gamma_b</code></td>
<td>
<p>positive 2nd shape parameter of the Beta prior distribution (default = 1).</p>
</td></tr>
<tr><td><code id="slfm_+3A_omega_0">omega_0</code></td>
<td>
<p>prior variance of the spike mixture component (default = 0.01).</p>
</td></tr>
<tr><td><code id="slfm_+3A_omega_1">omega_1</code></td>
<td>
<p>prior variance of the slab mixture component (default = 10).</p>
</td></tr>
<tr><td><code id="slfm_+3A_sample">sample</code></td>
<td>
<p>sample size to be considered for inference after the burn in period (default = 1000).</p>
</td></tr>
<tr><td><code id="slfm_+3A_burnin">burnin</code></td>
<td>
<p>size of the burn in period in the MCMC algorithm (default = sample/4).</p>
</td></tr>
<tr><td><code id="slfm_+3A_lag">lag</code></td>
<td>
<p>lag to build the chains based on spaced draws from the Gibbs sampler (defaul = 1).</p>
</td></tr>
<tr><td><code id="slfm_+3A_degenerate">degenerate</code></td>
<td>
<p>logical argument (default = FALSE) indicating whether to use the degenerate version of the mixture prior for the factor loadings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x: data matrix.
</p>
<p>q_star: matrix of MCMC chains for q_star parameter.
</p>
<p>alpha: summary table of MCMC chains for alpha parameter.
</p>
<p>lambda: summary table of MCMC chains for lambda parameter.
</p>
<p>sigma: summary table of MCMC chains for sigma parameter.
</p>
<p>classification: classification of each alpha ('present', 'marginal', 'absent')
</p>


<h3>References</h3>

<p>DOI:10.18637/jss.v090.i09 (<a href="https://www.jstatsoft.org/article/view/v090i09">Duarte and Mayrink; 2019</a>)
</p>
<p>DOI:10.1007/978-3-319-12454-4_15 (<a href="https://link.springer.com/chapter/10.1007/978-3-319-12454-4_15">Duarte and Mayrink; 2015</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+process_matrix">process_matrix</a></code>, <code><a href="#topic+plot_matrix">plot_matrix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mat &lt;- matrix(rnorm(2000), nrow = 20)
slfm(mat, sample = 1000)
</code></pre>

<hr>
<h2 id='slfm_list'>slfm_list</h2><span id='topic+slfm_list'></span>

<h3>Description</h3>

<p>Function to fit the Bayesian Sparse Latent Factor Model to a group of data matrices within a directory. All matrices are supposed to have values
representing the gene expression observed for different genes (rows) and different samples (columns).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slfm_list(
  path = ".",
  recursive = TRUE,
  a = 2.1,
  b = 1.1,
  gamma_a = 1,
  gamma_b = 1,
  omega_0 = 0.01,
  omega_1 = 10,
  sample = 1000,
  burnin = round(0.25 * sample),
  lag = 1,
  degenerate = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slfm_list_+3A_path">path</code></td>
<td>
<p>path to the directory where the target data matrices are located.</p>
</td></tr>
<tr><td><code id="slfm_list_+3A_recursive">recursive</code></td>
<td>
<p>logical argument (default = TRUE) indicating whether the function should look recursively 
inside folders.</p>
</td></tr>
<tr><td><code id="slfm_list_+3A_a">a</code></td>
<td>
<p>positive shape parameter of the Inverse Gamma prior distribution (default = 2.1).</p>
</td></tr>
<tr><td><code id="slfm_list_+3A_b">b</code></td>
<td>
<p>positive scale parameter of the Inverse Gamma prior distribution (default = 1.1).</p>
</td></tr>
<tr><td><code id="slfm_list_+3A_gamma_a">gamma_a</code></td>
<td>
<p>positive 1st shape parameter of the Beta prior distribution (default = 1).</p>
</td></tr>
<tr><td><code id="slfm_list_+3A_gamma_b">gamma_b</code></td>
<td>
<p>positive 2nd shape parameter of the Beta prior distribution (default = 1).</p>
</td></tr>
<tr><td><code id="slfm_list_+3A_omega_0">omega_0</code></td>
<td>
<p>prior variance of the spike mixture component (default = 0.01).</p>
</td></tr>
<tr><td><code id="slfm_list_+3A_omega_1">omega_1</code></td>
<td>
<p>prior variance of the slab mixture component (default = 10).</p>
</td></tr>
<tr><td><code id="slfm_list_+3A_sample">sample</code></td>
<td>
<p>sample size to be considered for inference after the burn in period (default = 1000).</p>
</td></tr>
<tr><td><code id="slfm_list_+3A_burnin">burnin</code></td>
<td>
<p>size of the burn in period in the MCMC algorithm (default = sample/4).</p>
</td></tr>
<tr><td><code id="slfm_list_+3A_lag">lag</code></td>
<td>
<p>lag to build the chains based on spaced draws from the Gibbs sampler (default = 1).</p>
</td></tr>
<tr><td><code id="slfm_list_+3A_degenerate">degenerate</code></td>
<td>
<p>logical argument (default = FALSE) indicating whether to use the degenerate version of 
the mixture prior for the factor loadings.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+slfm">slfm</a></code>, <code><a href="#topic+process_matrix">process_matrix</a></code>, <code><a href="#topic+plot_matrix">plot_matrix</a></code>
</p>

<hr>
<h2 id='slfm_package'>slfm: Fitting a Bayesian Sparse Latent Factor Model in Gene Expression Analysis</h2><span id='topic+slfm_package'></span><span id='topic+slfm-package'></span>

<h3>Description</h3>

<p>Set of tools to find coherent patterns in gene expression (possibly microarray) data
using a Bayesian Sparse Latent Factor Model (SLFM) &lt;DOI:10.1007/978-3-319-12454-4_15&gt; .
Considerable effort has been put to build <span class="pkg">slfm</span> fast and memory efficient, which makes 
this proposal an interesting and computationally convenient alternative to study patterns of gene expressions exhibited in matrices. 
The package contains the implementation of two versions of the model based on different mixture priors for the loadings: 
one relies on a degenerate component at zero and the other uses
a small variance normal distribution for the spike part of the mixture. 
Additional functions are also available to handle data pre-processing procedures 
and to fit the model for a large number of probesets or genes. It includes functions to:
</p>


<h3>Details</h3>

<p>* pre-process a set of matrices;
* fit the available models to a set of matrices;
* provide a detailed summarization of the model fit results.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
