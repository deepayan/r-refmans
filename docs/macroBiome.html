<!DOCTYPE html><html lang="en"><head><title>Help for package macroBiome</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {macroBiome}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#macroBiome-package'>
<p>A Tool for Mapping the Distribution of the Biomes and Bioclimate</p></a></li>
<li><a href='#cliAvgDlySolIrrPoints'><p>Estimator for Daily Solar Irradiance/Irradiation</p></a></li>
<li><a href='#cliBioCliIdxGrid'><p>Calculator for Bioclimatic Indices</p></a></li>
<li><a href='#cliBioCliIdxPoints'><p>Calculator for Bioclimatic Indices</p></a></li>
<li><a href='#cliBIOMEGrid'><p>Vegetation Classifier Using the BIOME Model</p></a></li>
<li><a href='#cliBIOMEPoints'><p>Vegetation Classifier Using the BIOME Model</p></a></li>
<li><a href='#cliBrtSunDurFrcGrid'><p>Estimator for Fraction of Bright Sunshine Duration</p></a></li>
<li><a href='#cliBrtSunDurFrcPoints'><p>Estimator for Fraction of Bright Sunshine Duration</p></a></li>
<li><a href='#cliForestSteppeGrid'><p>Forest-Steppe Models</p></a></li>
<li><a href='#cliForestSteppePoints'><p>Forest-Steppe Models</p></a></li>
<li><a href='#cliHoldridgeGrid'><p>Vegetation Classifier Using the HLZ System</p></a></li>
<li><a href='#cliHoldridgePoints'><p>Vegetation Classifier Using the HLZ System</p></a></li>
<li><a href='#cliKoppenGrid'><p>Vegetation Classifier Using the KGC System</p></a></li>
<li><a href='#cliKoppenPoints'><p>Vegetation Classifier Using the KGC System</p></a></li>
<li><a href='#dlyEngWtrFluxPoints'><p>Estimator for Daily Amounts of Energy and Water Fluxes</p></a></li>
<li><a href='#dlyWeaGenPoints'><p>Daily Weather Generator</p></a></li>
<li><a href='#inp_exClnrGrid'><p>Mandatory Data for the Example 'Climate Normal Grid'</p></a></li>
<li><a href='#inp_exPoints'><p>Mandatory Data for the Example 'Points'</p></a></li>
<li><a href='#inp_exSglyGrid'><p>Mandatory Data for the Example 'Single-Year Grid'</p></a></li>
<li><a href='#vegClsNumCodes'><p>Supplemental Data Frame for Decoding Outputs of Vegetation Classifiers</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Tool for Mapping the Distribution of the Biomes and Bioclimate</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zoltán Szelepcsényi &lt;szelepcsenyi.zoltan@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Procedures for simulating biomes by equilibrium vegetation 
  models, with a special focus on paleoenvironmental applications.
  Three widely used equilibrium biome models are currently implemented in 
  the package: the Holdridge Life Zone (HLZ) system (Holdridge 1947, 
  &lt;<a href="https://doi.org/10.1126%2Fscience.105.2727.367">doi:10.1126/science.105.2727.367</a>&gt;), the Köppen-Geiger classification 
  (KGC) system (Köppen 1936, 
  <a href="https://koeppen-geiger.vu-wien.ac.at/pdf/Koppen_1936.pdf">https://koeppen-geiger.vu-wien.ac.at/pdf/Koppen_1936.pdf</a>) and the 
  BIOME model (Prentice et al. 1992, &lt;<a href="https://doi.org/10.2307%2F2845499">doi:10.2307/2845499</a>&gt;). Three 
  climatic forest-steppe models are also implemented.
  An approach for estimating monthly time series of relative sunshine 
  duration from temperature and precipitation data (Yin 1999, 
  &lt;<a href="https://doi.org/10.1007%2Fs007040050111">doi:10.1007/s007040050111</a>&gt;) is also adapted, allowing 
  process-based biome models to be combined with high-resolution 
  paleoclimate simulation datasets (e.g., CHELSA-TraCE21k v1.0 dataset: 
  <a href="https://chelsa-climate.org/chelsa-trace21k/">https://chelsa-climate.org/chelsa-trace21k/</a>).</td>
</tr>
<tr>
<td>Additional_repositories:</td>
<td><a href="http://packages.ropensci.org">http://packages.ropensci.org</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>devtools, methods, palinsol, raster, rnaturalearthdata, sf,
strex, terra</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rnaturalearthhires</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>ropensci/rnaturalearthhires</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/szelepcsenyi/macroBiome">https://github.com/szelepcsenyi/macroBiome</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/szelepcsenyi/macroBiome/issues/">https://github.com/szelepcsenyi/macroBiome/issues/</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-15</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Author:</td>
<td>Zoltán Szelepcsényi
    <a href="https://orcid.org/0000-0002-9844-4958"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre,
    cph]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-15 18:56:50 UTC; szelepcsenyi.zoltan</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-16 14:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='macroBiome-package'>
A Tool for Mapping the Distribution of the Biomes and Bioclimate
</h2><span id='topic+macroBiome-package'></span>

<h3>Description</h3>

<p>Procedures for simulating biomes by equilibrium vegetation models, with a special focus on paleoenvironmental applications.
</p>
<p>Three widely used equilibrium biome models are currently implemented in the package: the Holdridge Life Zone (HLZ) system (Holdridge 1947, 1967), the Köppen-Geiger classification (KGC) system (Köppen 1936) and the BIOME model (Prentice et al. 1992). Three climatic forest-steppe models are also implemented.
</p>
<p>In the BIOME model, the water balance module used to calculate daily radiation, evapotranspiration and soil moisture was replaced by the SPLASH v.1.0 model (Davis et al. 2017). The methodology used in this model was modified in two aspects: the 'bucket size' was made freely adjustable, and variations of the Earth's orbital parameters were taken into account by implementing the procedure proposed by Berger and Loutre (1991).
</p>
<p>The application of process-based models, besides temperature and precipitation data, requires also a meteorological variable directly related to radiation. Sunshine duration or cloud cover can be such a variable. Unfortunately, paleoclimatic datasets developed to support paleoecological studies using correlative species distribution models do not include such variables. For example, see the CHELSA-TraCE21k v1.0 dataset (<a href="https://chelsa-climate.org/chelsa-trace21k/">https://chelsa-climate.org/chelsa-trace21k/</a>).
</p>
<p>However, estimating relative sunshine duration data from commonly available meteorological variables may be a solution to overcome the lack of data. To achieve this goal, here, the procedure described by Yin (1999) is recommended with some minor modifications. Evidences of validity of the procedures implemented in the package were shown by Szelepcsényi et al. (2022).
</p>
<p>The use of 'Grid' functions allows to generate distribution maps of biomes (and bioclimatic indices used in the given procedure) in a fast and controlled way given the appropriate raster datasets.
</p>


<h3>References</h3>

<p><cite>Berger A, Loutre MF (1991) Insolation values for the climate of the last 10 million years. Quat Sci Rev
10(4):297-317. <a href="https://doi.org/10.1016/0277-3791%2891%2990033-Q">doi:10.1016/0277-3791(91)90033-Q</a></cite>
</p>
<p><cite>Davis TW, Prentice IC, Stocker BD, Thomas RT, Whitley RJ, Wang H, Evans BJ, Gallego-Sala AV, Sykes MT,
Cramer W (2017) Simple process-led algorithms for simulating habitats (SPLASH v.1.0): robust indices of
radiation, evapotranspiration and plant-available moisture. Geosci Model Dev 10(2):689–708.
<a href="https://doi.org/10.5194/gmd-10-689-2017">doi:10.5194/gmd-10-689-2017</a></cite>
</p>
<p><cite>Holdridge LR (1947) Determination of World Plant Formations From Simple Climatic Data. Science
105(2727):367–368. <a href="https://doi.org/%2010.1126/science.105.2727.367">doi: 10.1126/science.105.2727.367</a></cite>
</p>
<p><cite>Holdridge LR (1967) Life zone ecology. Tropical Science Center, San Jose, Costa Rica</cite>
</p>
<p><cite>Köppen W (1936) Das geographische System der Klimate. In: Köppen W, Geiger R (eds) Handbuch der Klimatologie.        Verlag von Gebrüder Borntraeger, Berlin, Germany, pp 1–44</cite>
</p>
<p><cite>Prentice IC, Cramer W, Harrison SP, Leemans R, Monserud RA, Solomon AM (1992) A Global Biome Model Based on
Plant Physiology and Dominance, Soil Properties and Climate. J Biogeogr 19(2):117–134. <a href="https://doi.org/10.2307/2845499">doi:10.2307/2845499</a></cite>
</p>
<p><cite>Szelepcsényi Z, Breuer H, Fodor N (2022) Estimating relative sunshine duration from commonly available
meteorological variables for simulating biome distribution in the Carpathian Region. Hung Geogr Bull 71(1):3–19.
<a href="https://doi.org/10.15201/hungeobull.71.1.1">doi:10.15201/hungeobull.71.1.1</a></cite>
</p>
<p><cite>Yin X (1999) Bright Sunshine Duration in Relation to Precipitation, Air Temperature and Geographic Location.
Theor Appl Climatol 64(1–2):61–68. <a href="https://doi.org/10.1007/s007040050111">doi:10.1007/s007040050111</a></cite>
</p>

<hr>
<h2 id='cliAvgDlySolIrrPoints'>Estimator for Daily Solar Irradiance/Irradiation</h2><span id='topic+cliAvgDlySolIrrPoints'></span>

<h3>Description</h3>

<p>Calculates monthly averages of daily solar irradiance/irradiation under cloudless-sky conditions, for
a given latitude, elevation and year. In addition, it also optionally computes monthly means for daylength
(accumulated hours of daylight), for a given latitude, elevation and year. In addition to monthly averages,
daily values can also be directly access.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cliAvgDlySolIrrPoints(
  lat,
  elv = NULL,
  year = 2000,
  aprchSIM = c("Solar123", "SPLASH"),
  aprchTR = c("daily", "hourly"),
  daily = FALSE,
  mlyOpVar = c("R_E")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cliAvgDlySolIrrPoints_+3A_lat">lat</code></td>
<td>
<p>'numeric' vector with the latitude coordinates (in decimal degrees)</p>
</td></tr>
<tr><td><code id="cliAvgDlySolIrrPoints_+3A_elv">elv</code></td>
<td>
<p>'numeric' vector with the elevation values (in meters above sea level)</p>
</td></tr>
<tr><td><code id="cliAvgDlySolIrrPoints_+3A_year">year</code></td>
<td>
<p>'numeric' vector with values of the year (using astronomical year numbering)</p>
</td></tr>
<tr><td><code id="cliAvgDlySolIrrPoints_+3A_aprchsim">aprchSIM</code></td>
<td>
<p>'character' vector of length 1 that indicates the formula used to estimate the value of solar
irradiance/irradiation for a specific day. Valid values are as follows: <br />
(a) <code>'Solar123'</code> -
in this approach, first, the mean hourly solar irradiance under cloudless-sky conditions is calculated as
proposed by Yin (1997b), with a minor modification, using the daytime means of optical air mass and
cosine zenith; the former is computed as recommended by Yin (1997b), while the latter is estimated by using
Eq 5 of Yin (1997a); however, in contrast to the original approach, where the solar constant was fixed at
<code class="reqn">4.9212 MJ m^{-2} hr^{-1}</code>, according to Yin (1999), its value is corrected by
calendar day for the variable ellipticity of the Earth's orbit, by using the scheme of Brock (1981); in the
calculations, the values of solar declination and daylength are derived by using the approach of Brock (1981);
<br />
(b) <code>'SPLASH'</code> -
in this approach, first, under varying orbital parameters, the daily solar radiation at the top of the
atmosphere is calculated (<code class="reqn">H_{0}</code>, Eq 7 in Davis et al. (2017)), and then this value is
multiplied by the atmospheric transmittivity to obtain the value of daily surface radiation; in this case as
well, cloudless conditions are assumed, i.e., the transmission coefficient is taken into account with an
universal value of 0.75, however, its value is modified as a function of elevation, by using the scheme of
Allen (1996); the daylength is calculated via Eq 1.6.11 in Duffie and Beckman (1991), using the sunset hour
angle (<code class="reqn">h_{s}</code>, Eq 8. in Davis et al. (2017)); finally, the mean hourly surface radiation is
derived as the quotient of the daily surface radiation and the daylength.</p>
</td></tr>
<tr><td><code id="cliAvgDlySolIrrPoints_+3A_aprchtr">aprchTR</code></td>
<td>
<p>'character' vector of length 1 that indicates that the daily solar irradiance/irradiation is
estimated with a daily or hourly time resolution. Valid values are as follows: <br />
(a) <code>'daily'</code> - it is calculated as a daily amount (in <code class="reqn">MJ m^{-2} dy^{-1}</code>); <br />
(b) <code>'hourly'</code> - it is estimated as an hourly mean (in <code class="reqn">MJ m^{-2} hr^{-1}</code>).</p>
</td></tr>
<tr><td><code id="cliAvgDlySolIrrPoints_+3A_daily">daily</code></td>
<td>
<p>'logical' scalar that indicates whether or not daily values should also be computed.</p>
</td></tr>
<tr><td><code id="cliAvgDlySolIrrPoints_+3A_mlyopvar">mlyOpVar</code></td>
<td>
<p>'character' vector of at least one length that indicates the variable(s) for which
monthly time series are to be calculated. Valid values are as follows: <br />
(a) <code>'R_E'</code> - monthly averages of daily solar irradiance/irradiation under cloudless-sky conditions
(depending on the time resolution in <code class="reqn">MJ m^{-2} dy^{-1}</code> or
<code class="reqn">MJ m^{-2} hr^{-1}</code>); <br />
(b) <code>'DL'</code> - monthly means for daylength (accumulated hours of daylight) (in hours).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To estimate the monthly averages of relative sunshine duration, Yin (1999) uses estimated values of the
mean hourly solar irradiance under cloudless-sky conditions (<code>'R_E_MJ.m2.hr1'</code>), which is calculated via
the scheme of Yin (1997b), with some minor modifications. Furthermore, in the approach proposed by Yin (1999),
the monthly means of daylength (<code>'DL_moa_hr'</code>) is used to estimate monthly averages of daily potential
evapotranspiration. The solar irradiance model presented by Yin (1997b) and slightly modified by Yin (1999) is
labelled <code>'Solar123'</code> here. <br />
The approach <code>'SPLASH'</code> uses a different radiation model, which is based on the procedure described by
Davis et al. (2017). The approach used here differs from the base scheme only in that it takes into account
changes in orbital parameters of the Earth over time. Temporal variability of orbital parameters is considered
through the implementation of the procedure as proposed by Berger and Loutre (1991). In the SPLASH algorithm,
the daily top-of-the-atmosphere solar radiation is computed as twice the integral of the extraterrestrial
radiation flux realized from local solar noon to sunset (see Davis et al. 2017). Using this physical amount,
the daily solar radiation at the surface of the Earth under clear-sky conditions (<code>'R_E_MJ.m2.dy1'</code>)
can be easily estimated. The hourly mean surface radiation is finally obtained as the quotient of this
integrated value and the daylength. <br />
In the both approach, the daylength is computed by using the sunset hour angle, however, due to differences in
the calculation of the solar declination, the results obtained by the two procedures differ. The approach
<code>'Solar123'</code> gives time-independent results, while using the approach <code>'SPLASH'</code>, varying results
over time are obtained through the variable orbital parameters. <br />
The two radiation models therefore differ significantly both in terms of conceptual frameworks and
assumptions. The approach <code>'Solar123'</code> converts hourly mean values into daily amounts, while in the
approach <code>'SPLASH'</code>, the integrated daily values are transformed to hourly averages. However, in terms of
atmospheric transmittivity, both models consider the universal value of 0.75 as a basic value. To conclude,
depending on the scope of application, both methods can give valid results, but for paleo-climatological and
paleo-environmental studies, the approach <code>'SPLASH'</code> is clearly recommended.
</p>


<h3>Value</h3>

<p>If daily values are also requested (<code>daily = TRUE</code>), the function returns a list of lists with daily
and monthly data. If <code>daily = FALSE</code>, the return object is a list with the monthly means. The character
vector <code>'mlyOpVar'</code> determines for which variables the monthly averages are calculated. Daily values also
become available only for this/these variable(s). Each matrix in the list of daily data consists of 365 or 366
columns, while monthly data are available, of course, as 12-column matrices. The former are accessible in the
list <code>'dly'</code>, while the latter can be found in the list labelled as <code>'mly'</code>. Here, matrices with
monthly data contain averages of the daily values. See the argument <code>'mlyOpVar'</code> for the content of
matrices.
</p>


<h3>Note</h3>

<p>As with any function with a point mode, a set of basic input data is defined here. In this case, it is as
follow: <code>'lat'</code> (latitude coordinates in decimal degrees). The length of this vector determines the
number of rows in matrices of the return list. In the case of arguments that do not affect the course of the
calculation procedure or the structure of the return object, scalar values (i.e., 'numeric' vector of
length 1) may also be allowed. In this case, they are as follows: <code>'elv'</code> (elevation in meters above sea
level), and <code>'year'</code> (year using astronomical year numbering). These scalars are converted to vectors by
the function during the error handling, and these vectors are applied in the further calculations. If these
data are stored in vectors of length at least 2, their length must be the same size of first dimension of the
matrix containing the basic data.
</p>


<h3>References</h3>

<p><cite>Allen RG (1996) Assessing integrity of weather data for reference evapotranspiration estimation. J Irrig
Drain Eng 122(2):97–106. <a href="https://doi.org/10.1061/%28ASCE%290733-9437%281996%29122%3A2%2897%29">doi:10.1061/(ASCE)0733-9437(1996)122:2(97)</a></cite>
</p>
<p><cite>Berger A, Loutre MF (1991) Insolation values for the climate of the last 10 million years. Quat Sci Rev
10(4):297-317. <a href="https://doi.org/10.1016/0277-3791%2891%2990033-Q">doi:10.1016/0277-3791(91)90033-Q</a></cite>
</p>
<p><cite>Brock TD (1981) Calculating solar radiation for ecological studies. Ecol Model 14(1–2):1-19.
<a href="https://doi.org/10.1016/0304-3800%2881%2990011-9">doi:10.1016/0304-3800(81)90011-9</a></cite>
</p>
<p><cite>Davis TW, Prentice IC, Stocker BD, Thomas RT, Whitley RJ, Wang H, Evans BJ, Gallego-Sala AV, Sykes MT,
Cramer W (2017) Simple process-led algorithms for simulating habitats (SPLASH v.1.0): robust indices of
radiation, evapotranspiration and plant-available moisture. Geosci Model Dev 10(2):689–708.
<a href="https://doi.org/10.5194/gmd-10-689-2017">doi:10.5194/gmd-10-689-2017</a></cite>
</p>
<p><cite>Duffie JA, Beckman WA (1991) Solar Engineering of Thermal Processes. Second Edition. Wiley-Interscience,
New York, NY</cite>
</p>
<p><cite>Yin X (1997a) Calculating daytime mean relative air mass. Agric For Meteorol 87(2-3):85-90.
<a href="https://doi.org/10.1016/S0168-1923%2897%2900029-4">doi:10.1016/S0168-1923(97)00029-4</a></cite>
</p>
<p><cite>Yin X (1997b) Optical Air Mass: Daily Integration and its Applications. Meteorol Atmos Phys 63(3-4):227-233.
<a href="https://doi.org/10.1007/BF01027387">doi:10.1007/BF01027387</a></cite>
</p>
<p><cite>Yin X (1999) Bright Sunshine Duration in Relation to Precipitation, Air Temperature and Geographic Location.
Theor Appl Climatol 64(1–2):61–68. <a href="https://doi.org/10.1007/s007040050111">doi:10.1007/s007040050111</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(graphics)

# Monthly average of the mean hourly solar irradiance under cloudless-sky conditions at sea level,
# in June 2000 along a meridian, according to the two different radiation models
lats &lt;- seq(-90, 90, 10)
models &lt;- c("Solar123", "SPLASH")
R_E_moa_MJ.m2.hr1 &lt;- matrix(nrow = 2, ncol = length(lats), dimnames = list(models, lats))
R_E_moa_MJ.m2.hr1[1, ] &lt;- cliAvgDlySolIrrPoints(lats, elv = 0,
    aprchTR = "hourly")$R_E_moa_MJ.m2.hr1[, "Jun"]
R_E_moa_MJ.m2.hr1[2, ] &lt;- cliAvgDlySolIrrPoints(lats, elv = 0, aprchSIM = "SPLASH",
    aprchTR = "hourly")$R_E_moa_MJ.m2.hr1[, "Jun"]
cols &lt;- c("black", "green")
matplot(t(R_E_moa_MJ.m2.hr1), type = "l", lwd = 2, col = cols, xaxt = "n",
    xlab = "Geographical latitude (degrees)",
    ylab = "Mean hourly solar irradiance (MJ m-2 hr-1)")
axis(1, at = seq(1, ncol(R_E_moa_MJ.m2.hr1)), labels = colnames(R_E_moa_MJ.m2.hr1))
legend(1, 2, legend = rownames(R_E_moa_MJ.m2.hr1), col = cols, lty = 1 : 2, lwd = 2, xpd = TRUE)


# Daylength at latitude 75N in the year 2000, according to the two different radiation models
DL_hr &lt;- matrix(nrow = 2, ncol = 366, dimnames = list(c("Solar123", "SPLASH"), seq(1, 366)))
DL_hr[1, ] &lt;- cliAvgDlySolIrrPoints(75., 0., daily = TRUE, mlyOpVar = "DL")$dly$DL_hr
DL_hr[2, ] &lt;- cliAvgDlySolIrrPoints(75., 0., aprchSIM = "SPLASH", daily = TRUE,
    mlyOpVar = "DL")$dly$DL_hr
cols &lt;- c("black", "green")
matplot(t(DL_hr), type = "l", lwd = 2, col = cols, xaxt = "n", xlab = "Day number in the year",
    ylab = "Daylength (hr)")
axis(1, at = seq(1, ncol(DL_hr)), labels = colnames(DL_hr))
legend(1, 20, legend = rownames(DL_hr), col = cols, lty = 1 : 2, lwd = 2, xpd = TRUE)


</code></pre>

<hr>
<h2 id='cliBioCliIdxGrid'>Calculator for Bioclimatic Indices</h2><span id='topic+cliBioCliIdxGrid'></span>

<h3>Description</h3>

<p>Calculates the values of selected bioclimatic indices, for a given region and year/epoch, by using the
monthly time series of temperature, precipitation and relative sunshine duration, and the elevation data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cliBioCliIdxGrid(
  rs.temp,
  rs.prec,
  rs.bsdf = NULL,
  rl.elv = NULL,
  sc.year = 2000,
  rl.MSMC = 150,
  aprchTEMP = c("hip", "tsi", "const"),
  aprchPREC = c("tsi", "hip", "const"),
  aprchBSDF = c("hip", "const"),
  dvTEMP = rep(0.7, 12),
  dvPREC = rep(0.7, 12),
  bciOpVar = c("abt", "tap", "per", "fai"),
  filename = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cliBioCliIdxGrid_+3A_rs.temp">rs.temp</code></td>
<td>
<p>multi-layer Raster*/SpatRaster object with one-year time series of monthly mean air temperature
(in °C)</p>
</td></tr>
<tr><td><code id="cliBioCliIdxGrid_+3A_rs.prec">rs.prec</code></td>
<td>
<p>multi-layer Raster*/SpatRaster object with one-year time series of monthly precipitation sum
(in mm)</p>
</td></tr>
<tr><td><code id="cliBioCliIdxGrid_+3A_rs.bsdf">rs.bsdf</code></td>
<td>
<p>multi-layer Raster*/SpatRaster object with one-year time series of monthly mean relative sunshine
duration (dimensionless)</p>
</td></tr>
<tr><td><code id="cliBioCliIdxGrid_+3A_rl.elv">rl.elv</code></td>
<td>
<p>single-layer Raster*/SpatRaster object with the elevation values (in meters above sea level)</p>
</td></tr>
<tr><td><code id="cliBioCliIdxGrid_+3A_sc.year">sc.year</code></td>
<td>
<p>'numeric' scalar with the value of the year (using astronomical year numbering)</p>
</td></tr>
<tr><td><code id="cliBioCliIdxGrid_+3A_rl.msmc">rl.MSMC</code></td>
<td>
<p>'numeric' scalar or single-layer Raster*/SpatRaster object with the value/values of the maximum
soil moisture capacity (aka 'bucket size') (in mm)</p>
</td></tr>
<tr><td><code id="cliBioCliIdxGrid_+3A_aprchtemp">aprchTEMP</code></td>
<td>
<p>'character' vector of length 1 that indicates the scheme used to generate daily values of the
daily mean air temperature for a specific year. Valid values are as follows: <br />
(a) <code>'hip'</code> -
this scheme applies the mean-preserving 'harmonic' interpolation method of Epstein (1991) to the values of
monthly mean air temperature in order to generate daily values; <br />
(b) <code>'tsi'</code> -
this scheme uses an iterative interpolation technique (Lüdeke et al. 1994) to time series of the monthly mean
air temperature, in order to generate a synthetic time series of the selected meteorological variable at a
temporal resolution that is higher than the daily scale; finally, this synthetic time series is upscaled to a
daily resolution; <br />
(c) <code>'const'</code> -
this scheme is assumed that values of the daily mean air temperature are constant within each month.</p>
</td></tr>
<tr><td><code id="cliBioCliIdxGrid_+3A_aprchprec">aprchPREC</code></td>
<td>
<p>'character' vector of length 1 that indicates the scheme to generate daily values of the
daily precipitation sum. Valid values are as follows: <br />
(a) <code>'tsi'</code> -
this scheme uses an iterative interpolation technique (Lüdeke et al. 1994) to time series of the monthly mean
precipitation intensity, in order to generate a synthetic time series of the selected meteorological variable
at a temporal resolution that is higher than the daily scale; finally, this synthetic time series is upscaled
to a daily resolution; <br />
(b) <code>'hip'</code> -
this scheme applies the mean-preserving 'harmonic' interpolation method of Epstein (1991) to the values of
monthly mean precipitation intensity in order to generate daily values; <br />
(c) <code>'const'</code> -
this scheme is assumed that values of the daily precipitation sum are constant within each month (the monthly
precipitation sum is divided equally across each day of the month).</p>
</td></tr>
<tr><td><code id="cliBioCliIdxGrid_+3A_aprchbsdf">aprchBSDF</code></td>
<td>
<p>'character' vector of length 1 that indicates the scheme used to generate daily values of the
daily fractional sunshine duration for a specific year. Valid values are as follows: <br />
(a) <code>'hip'</code> -
this scheme applies the mean-preserving 'harmonic' interpolation method of Epstein (1991) to the values of
monthly mean relative sunshine duration in order to generate daily values; <br />
(b) <code>'const'</code> -
this scheme is assumed that values of the daily relative sunshine duration are constant within each month.</p>
</td></tr>
<tr><td><code id="cliBioCliIdxGrid_+3A_dvtemp">dvTEMP</code></td>
<td>
<p>'numeric' vector of length 12 with monthly values of the damping variable for the air temperature
data.</p>
</td></tr>
<tr><td><code id="cliBioCliIdxGrid_+3A_dvprec">dvPREC</code></td>
<td>
<p>'numeric' vector of length 12 with monthly values of the damping variable for the precipitation data.</p>
</td></tr>
<tr><td><code id="cliBioCliIdxGrid_+3A_bciopvar">bciOpVar</code></td>
<td>
<p>'character' vector of at least one length that indicates which of the bioclimatic indices is/are
to be computed. Valid values are as follows: <br />
(a) <code>'abt'</code> - Mean Annual Biotemperature (in °C); <br />
(b) <code>'tap'</code> - Total Annual Precipitation (in mm); <br />
(c) <code>'per'</code> - Potential Evapotranspiration Ratio (dimensionless); <br />
(d) <code>'fai'</code> - Forestry Aridity Index (dimensionless); <br />
(e) <code>'gdd0'</code> - Growing Degree-Days on 0°C base (in °C day); <br />
(f) <code>'gdd5'</code> - Growing Degree-Days on 5°C base (in °C day);  <br />
(g) <code>'bdi'</code> - Budyko's Dryness Index (dimensionless); <br />
(h) <code>'cci'</code> - Condrad's Continentality Index (in per cent);  <br />
(i) <code>'mat'</code> - Mean Annual Temperature (in °C); <br />
(j) <code>'tc'</code> - Mean Temperature of the Coldest Month (in °C); <br />
(k) <code>'tw'</code> - Mean Temperature of the Warmest Month (in °C);  <br />
(l) <code>'tm10'</code> - Number of Months with Mean Temperature above 10°C (dimensionless);  <br />
(m) <code>'pdry'</code> - Precipitation Sum of the Driest Month (in mm); <br />
(n) <code>'psdry'</code> - Precipitation Sum of the Driest Month in the Summer Half-Year (in mm); <br />
(o) <code>'pwdry'</code> - Precipitation Sum of the Driest Month in the Winter Half-Year (in mm); <br />
(p) <code>'pswet'</code> - Precipitation Sum of the Wettest Month in the Summer Half-Year (in mm); <br />
(q) <code>'pwwet'</code> - Precipitation Sum of the Wettest Month in the Winter Half-Year (in mm); <br />
(r) <code>'ps'</code> - Precipitation Sum of the Summer Half-Year (in mm); <br />
(s) <code>'pw'</code> - Precipitation Sum of the Winter Half-Year (in mm); <br />
(t) <code>'ptc'</code> - Priestley–Taylor Coefficient (dimensionless).</p>
</td></tr>
<tr><td><code id="cliBioCliIdxGrid_+3A_filename">filename</code></td>
<td>
<p>output filename</p>
</td></tr>
<tr><td><code id="cliBioCliIdxGrid_+3A_...">...</code></td>
<td>
<p>additional arguments passed on to <code><a href="terra.html#topic+writeRaster">writeRaster</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+cliBioCliIdxPoints">cliBioCliIdxPoints</a></code>.
</p>


<h3>Value</h3>

<p>A SpatRaster object with one or more layers where each layer contain the values of a given bioclimatic
index.
</p>


<h3>Note</h3>

<p>The objects <code>'rs.temp'</code>, <code>'rs.prec'</code> and <code>'rs.bsdf'</code> must be 12-layer Raster*/SpatRaster
objects, while the object <code>'rl.elv'</code> has to be a single-layer Raster*/SpatRaster object. The object
<code>'rl.MSMC'</code> must be either a single positive number (a universal bucket size) or a single-layer
Raster*/SpatRaster object (a regionally-specified bucket size). These Raster*/SpatRaster objects must have the
same bounding box, projection, and resolution. The object <code>'sc.year'</code> has to be a single integer number.
</p>


<h3>References</h3>

<p><cite>Epstein ES (1991) On Obtaining Daily Climatological Values from Monthly Means. J Clim 4(3):365–368.
<a href="https://doi.org/10.1175/1520-0442%281991%29004%3C0365%3AOODCVF%3E2.0.CO%3B2">doi:10.1175/1520-0442(1991)004&lt;0365:OODCVF&gt;2.0.CO;2</a></cite>
</p>
<p><cite>Lüdeke MKB, Badeck FW, Otto RD, Häger C, Dönges S, Kindermann J, Würth G, Lang T, Jäkel U, Klaudius A,
Ramge P, Habermehl S, Kohlmaier GH (1994) The Frankfurt Biosphere Model: A global process-oriented model of
seasonal and long-term CO2 exchange between terrestrial ecosystems and the atmosphere. I. Model description
and illustrative results for cold deciduous and boreal forests. Clim Res 4(2):143-166. <a href="https://doi.org/10.3354/cr004143">doi:10.3354/cr004143</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Loading mandatory data for the Example 'Climate Normal Grid'
data(inp_exClnrGrid)

# Calculate values of all default bioclimatic indices with default settings
# for Csongrad-Csanad County (for the normal period 1981-2010)
with(inp_exClnrGrid, {
rs.bci1 &lt;- cliBioCliIdxGrid(temp, prec)
rs.bci1
})


# Calculate values of all selected bioclimatic indices with default settings
# for Csongrad-Csanad County (for the normal period 1981-2010)
with(inp_exClnrGrid, {
year &lt;- trunc(mean(seq(1981, 2010)))
bciOpVar &lt;- c("gdd5", "bdi", "cci", "tc", "gdd0", "tw", "ptc")
rs.bci2 &lt;- cliBioCliIdxGrid(temp, prec, bsdf, elv, sc.year = year, bciOpVar = bciOpVar)
rs.bci2
})


</code></pre>

<hr>
<h2 id='cliBioCliIdxPoints'>Calculator for Bioclimatic Indices</h2><span id='topic+cliBioCliIdxPoints'></span>

<h3>Description</h3>

<p>Calculates the values of selected bioclimatic indices, for a given geographical location (latitude
and elevation) and year/epoch, by using the monthly time series of temperature, precipitation and relative
sunshine duration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cliBioCliIdxPoints(
  temp,
  prec,
  bsdf = NULL,
  lat = NULL,
  elv = NULL,
  year = 2000,
  MSMC = 150,
  aprchTEMP = c("hip", "tsi", "const"),
  aprchPREC = c("tsi", "hip", "const"),
  aprchBSDF = c("hip", "const"),
  dvTEMP = rep(0.7, 12),
  dvPREC = rep(0.7, 12),
  bciOpVar = c("abt", "tap", "per", "fai"),
  argCkd = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cliBioCliIdxPoints_+3A_temp">temp</code></td>
<td>
<p>'numeric' R object with one-year time series of monthly mean air temperature (in °C)</p>
</td></tr>
<tr><td><code id="cliBioCliIdxPoints_+3A_prec">prec</code></td>
<td>
<p>'numeric' R object with one-year time series of monthly precipitation sum (in mm)</p>
</td></tr>
<tr><td><code id="cliBioCliIdxPoints_+3A_bsdf">bsdf</code></td>
<td>
<p>'numeric' R object with one-year time series of monthly mean relative sunshine duration (dimensionless)</p>
</td></tr>
<tr><td><code id="cliBioCliIdxPoints_+3A_lat">lat</code></td>
<td>
<p>'numeric' vector with the latitude coordinates (in decimal degrees)</p>
</td></tr>
<tr><td><code id="cliBioCliIdxPoints_+3A_elv">elv</code></td>
<td>
<p>'numeric' vector with the elevation values (in meters above sea level)</p>
</td></tr>
<tr><td><code id="cliBioCliIdxPoints_+3A_year">year</code></td>
<td>
<p>'numeric' vector with values of the year (using astronomical year numbering)</p>
</td></tr>
<tr><td><code id="cliBioCliIdxPoints_+3A_msmc">MSMC</code></td>
<td>
<p>'numeric' vector with values of the maximum soil moisture capacity (aka 'bucket size') (in mm)</p>
</td></tr>
<tr><td><code id="cliBioCliIdxPoints_+3A_aprchtemp">aprchTEMP</code></td>
<td>
<p>'character' vector of length 1 that indicates the scheme used to generate daily values of the
daily mean air temperature for a specific year. Valid values are as follows: <br />
(a) <code>'hip'</code> -
this scheme applies the mean-preserving 'harmonic' interpolation method of Epstein (1991) to the values of
monthly mean air temperature in order to generate daily values; <br />
(b) <code>'tsi'</code> -
this scheme uses an iterative interpolation technique (Lüdeke et al. 1994) to time series of the monthly mean
air temperature, in order to generate a synthetic time series of the selected meteorological variable at a
temporal resolution that is higher than the daily scale; finally, this synthetic time series is upscaled to a
daily resolution; <br />
(c) <code>'const'</code> -
this scheme is assumed that values of the daily mean air temperature are constant within each month.</p>
</td></tr>
<tr><td><code id="cliBioCliIdxPoints_+3A_aprchprec">aprchPREC</code></td>
<td>
<p>'character' vector of length 1 that indicates the scheme to generate daily values of the
daily precipitation sum. Valid values are as follows: <br />
(a) <code>'tsi'</code> -
this scheme uses an iterative interpolation technique (Lüdeke et al. 1994) to time series of the monthly mean
precipitation intensity, in order to generate a synthetic time series of the selected meteorological variable
at a temporal resolution that is higher than the daily scale; finally, this synthetic time series is upscaled
to a daily resolution; <br />
(b) <code>'hip'</code> -
this scheme applies the mean-preserving 'harmonic' interpolation method of Epstein (1991) to the values of
monthly mean precipitation intensity in order to generate daily values; <br />
(c) <code>'const'</code> -
this scheme is assumed that values of the daily precipitation sum are constant within each month (the monthly
precipitation sum is divided equally across each day of the month).</p>
</td></tr>
<tr><td><code id="cliBioCliIdxPoints_+3A_aprchbsdf">aprchBSDF</code></td>
<td>
<p>'character' vector of length 1 that indicates the scheme used to generate daily values of the
daily fractional sunshine duration for a specific year. Valid values are as follows: <br />
(a) <code>'hip'</code> -
this scheme applies the mean-preserving 'harmonic' interpolation method of Epstein (1991) to the values of
monthly mean relative sunshine duration in order to generate daily values; <br />
(b) <code>'const'</code> -
this scheme is assumed that values of the daily relative sunshine duration are constant within each month.</p>
</td></tr>
<tr><td><code id="cliBioCliIdxPoints_+3A_dvtemp">dvTEMP</code></td>
<td>
<p>'numeric' vector of length 12 with monthly values of the damping variable for the air temperature
data.</p>
</td></tr>
<tr><td><code id="cliBioCliIdxPoints_+3A_dvprec">dvPREC</code></td>
<td>
<p>'numeric' vector of length 12 with monthly values of the damping variable for the precipitation data.</p>
</td></tr>
<tr><td><code id="cliBioCliIdxPoints_+3A_bciopvar">bciOpVar</code></td>
<td>
<p>'character' vector of at least one length that indicates which of the bioclimatic indices is/are
to be computed. Valid values are as follows: <br />
(a) <code>'abt'</code> - Mean Annual Biotemperature (in °C); <br />
(b) <code>'tap'</code> - Total Annual Precipitation (in mm); <br />
(c) <code>'per'</code> - Potential Evapotranspiration Ratio (dimensionless); <br />
(d) <code>'fai'</code> - Forestry Aridity Index (dimensionless); <br />
(e) <code>'gdd0'</code> - Growing Degree-Days on 0°C base (in °C day); <br />
(f) <code>'gdd5'</code> - Growing Degree-Days on 5°C base (in °C day);  <br />
(g) <code>'bdi'</code> - Budyko's Dryness Index (dimensionless); <br />
(h) <code>'cci'</code> - Condrad's Continentality Index (in per cent);  <br />
(i) <code>'mat'</code> - Mean Annual Temperature (in °C); <br />
(j) <code>'tc'</code> - Mean Temperature of the Coldest Month (in °C); <br />
(k) <code>'tw'</code> - Mean Temperature of the Warmest Month (in °C);  <br />
(l) <code>'tm10'</code> - Number of Months with Mean Temperature above 10°C (dimensionless);  <br />
(m) <code>'pdry'</code> - Precipitation Sum of the Driest Month (in mm); <br />
(n) <code>'psdry'</code> - Precipitation Sum of the Driest Month in the Summer Half-Year (in mm); <br />
(o) <code>'pwdry'</code> - Precipitation Sum of the Driest Month in the Winter Half-Year (in mm); <br />
(p) <code>'pswet'</code> - Precipitation Sum of the Wettest Month in the Summer Half-Year (in mm); <br />
(q) <code>'pwwet'</code> - Precipitation Sum of the Wettest Month in the Winter Half-Year (in mm); <br />
(r) <code>'ps'</code> - Precipitation Sum of the Summer Half-Year (in mm); <br />
(s) <code>'pw'</code> - Precipitation Sum of the Winter Half-Year (in mm); <br />
(t) <code>'ptc'</code> - Priestley–Taylor Coefficient (dimensionless).</p>
</td></tr>
<tr><td><code id="cliBioCliIdxPoints_+3A_argckd">argCkd</code></td>
<td>
<p>'logical' scalar that indicates whether or not the checking and correction of arguments can be
omitted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Taking into account all implemented bioclimatic indices, the following five require only temperature data:
</p>

<ul>
<li><p><code>abt</code>: Mean Annual Biotemperature (Eq 1 in Szelepcsényi et al. (2014); in °C)
</p>
</li>
<li><p><code>mat</code>: Mean Annual Temperature (in °C)
</p>
</li>
<li><p><code>tc</code>: Mean Temperature of the Coldest Month (in °C)
</p>
</li>
<li><p><code>tw</code>: Mean Temperature of the Warmest Month (in °C)
</p>
</li>
<li><p><code>tm10</code>: Number of Months with Mean Temperature above 10°C (dimensionless)
</p>
</li>
<li><p><code>gdd5</code>: Growing Degree-Days on 5°C base (in °C day)
</p>
</li>
<li><p><code>gdd0</code>: Growing Degree-Days on 0°C base (in °C day)
</p>
</li></ul>

<p>Monthly data are sufficient to calculate values of the mean temperatures of the coldest and warmest months,
the mean annual temperature/biotemperature and the number of months with temperature &gt; 10°C, while daily
values are needed to compute values of the growing degree-days. If only a set of these bioclimatic indices has
to be calculated, the setting <code>prec = NULL</code> must be used. <br />
An important bioclimatic index for both the Holdridge life zone system and Köppen-Geiger climate
classification system is the total annual precipitation, for the calculation of which requires only monthly
precipitation data. If only this bioclimatic index has to be computed, the setting <code>temp = NULL</code> must be
used. The same setting has to be used for calculation of the precipitation sum of the driest month. <br />
In addition to monthly temperature data, latitude coordinates are also required to calculate the Condrad's
Continentality Index (<code>cci</code>: Eq 4 in Conrad (1946); in per cent). <br />
For calculating values of the Potential Evapotranspiration Ratio used in the Holdridge life zone system
(<code>per</code>: Eq 4 in Szelepcsényi et al. (2014); dimensionless) and the Forestry Aridity Index introduced by
the forestry climate classification (<code>fai</code>: Eq 1 in Führer et al. (2011); dimensionless), both
temperature and precipitation data at a monthly timescale are also required. Same data are needed to calculate
most precipitation statistics used by the Köppen-Geiger climate classification system:
</p>

<ul>
<li><p><code>psdry</code>: Precipitation Sum of the Driest Month in the Summer Half-Year (in mm)
</p>
</li>
<li><p><code>pwdry</code>: Precipitation Sum of the Driest Month in the Winter Half-Year (in mm)
</p>
</li>
<li><p><code>pswet</code>: Precipitation Sum of the Wettest Month in the Summer Half-Year (in mm)
</p>
</li>
<li><p><code>pwwet</code>: Precipitation Sum of the Wettest Month in the Winter Half-Year (in mm)
</p>
</li>
<li><p><code>ps</code>: Precipitation Sum of the Summer Half-Year (in mm)
</p>
</li>
<li><p><code>pw</code>: Precipitation Sum of the Winter Half-Year (in mm)
</p>
</li></ul>

<p>For these bioclimatic indices, summer (winter) half-year is defined as the warmer (cooler) six month period of
AMJJAS (from April to September) and ONDJFM (from October to March). <br />
The computation of the Budyko's Dryness Index (<code>bdi</code>, dimensionless) and the Priestley–Taylor Coefficient
(<code>ptc</code>, dimensionless) requires a simulation of evapotranspiration at daily time step via the
implementation of the SPLASH algorithm (Davis et al. 2017) (see
<code><a href="#topic+dlyEngWtrFluxPoints">dlyEngWtrFluxPoints</a></code>). In addition to one-year time series of daily temperature and
precipitation data, the application of the SPLASH algorithm requires values of the relative sunshine duration
at a daily timescale, latitude coordinate, altitude, year/epoch, and the so-called 'bucket size'. The Dryness
Index is a ratio of annual potential evapotranspiration to precipitation (see Monserud et al. 1993). The value
of the Priestley–Taylor coefficient is calculated as the ratio of actual evapotranspiration to equilibrium
evapotranspiration, which represents the fraction of plant-available surface moisture (see Prentice et al.
1992, Davis et al. 2017). <br />
The function applies only monthly time series to compute values of each bioclimatic index, considering the
field of application of the package. However, as we can see, in some cases there is a need for daily time
series that are here generated by using the function <code><a href="#topic+dlyWeaGenPoints">dlyWeaGenPoints</a></code>.
</p>


<h3>Value</h3>

<p>A matrix with one or more columns where each column contain the values of a given bioclimatic index.
</p>


<h3>Note</h3>

<p>As with any function with a point mode, a set of basic input data is defined here. In this case, they are as
follows: <code>'temp'</code> (one-year time series of monthly mean air temperature), <code>'prec'</code> (one-year time
series of monthly precipitation sum), and <code>'bsdf'</code> (one-year time series of monthly mean relative sunshine
duration). The objects <code>'temp'</code>, <code>'prec'</code> and <code>'bsdf'</code> must be either vectors of length 12 or
12-column matrices. The first dimensions of these matrices have to be the same length. The function
automatically converts vectors into single-row matrices during the error handling, and then uses these
matrices. The first dimensions of these matrices determines the number of rows in the result matrix. In the
case of arguments that do not affect the course of the calculation procedure or the structure of the return
object, scalar values (i.e., 'numeric' vector of length 1) may also be allowed. In this case, they are as
follows: <code>'lat'</code> (latitude coordinates in decimal degrees), <code>'elv'</code> (elevation in meters above sea
level), <code>'year'</code> (year using astronomical year numbering), and <code>'MSMC'</code> ('bucket size' in mm). These
scalars are converted to vectors by the function during the error handling, and these vectors are applied in
the further calculations. If these data are stored in vectors of length at least 2, their length must be the
same size of first dimension of the matrices containing the basic data.
</p>


<h3>References</h3>

<p><cite>Conrad V (1964) Usual formulas of continentality and their limits of validity. EOS, Trans Am Geophys Union
27(5):663-664. <a href="https://doi.org/10.1029/TR027i005p00663">doi:10.1029/TR027i005p00663</a></cite>
</p>
<p><cite>Davis TW, Prentice IC, Stocker BD, Thomas RT, Whitley RJ, Wang H, Evans BJ, Gallego-Sala AV, Sykes MT,
Cramer W (2017) Simple process-led algorithms for simulating habitats (SPLASH v.1.0): robust indices of
radiation, evapotranspiration and plant-available moisture. Geosci Model Dev 10(2):689–708.
<a href="https://doi.org/10.5194/gmd-10-689-2017">doi:10.5194/gmd-10-689-2017</a></cite>
</p>
<p><cite>Epstein ES (1991) On Obtaining Daily Climatological Values from Monthly Means. J Clim 4(3):365–368.
<a href="https://doi.org/10.1175/1520-0442%281991%29004%3C0365%3AOODCVF%3E2.0.CO%3B2">doi:10.1175/1520-0442(1991)004&lt;0365:OODCVF&gt;2.0.CO;2</a></cite>
</p>
<p><cite>Führer E, Horváth L, Jagodics A, Machon A, Szabados I (2011) Application of a new aridity index in Hungarian
forestry practice. Időjárás 115(3):205–216</cite>
</p>
<p><cite>Lüdeke MKB, Badeck FW, Otto RD, Häger C, Dönges S, Kindermann J, Würth G, Lang T, Jäkel U, Klaudius A,
Ramge P, Habermehl S, Kohlmaier GH (1994) The Frankfurt Biosphere Model: A global process-oriented model of
seasonal and long-term CO2 exchange between terrestrial ecosystems and the atmosphere. I. Model description
and illustrative results for cold deciduous and boreal forests. Clim Res 4(2):143-166. <a href="https://doi.org/10.3354/cr004143">doi:10.3354/cr004143</a></cite>
</p>
<p><cite>Monserud RA, Denissenko OV, Tchebakova NM (1993) Comparison of Siberian paleovegetation to current and
future vegetation under climate change. Clim Res 3(3):143–159. <a href="https://doi.org/10.3354/cr003143">doi:10.3354/cr003143</a></cite>
</p>
<p><cite>Prentice IC, Cramer W, Harrison SP, Leemans R, Monserud RA, Solomon AM (1992) A Global Biome Model Based on
Plant Physiology and Dominance, Soil Properties and Climate. J Biogeogr 19(2):117–134. <a href="https://doi.org/10.2307/2845499">doi:10.2307/2845499</a></cite>
</p>
<p><cite>Szelepcsényi Z, Breuer H, Sümegi P (2014) The climate of Carpathian Region in the 20th century based on the
original and modified Holdridge life zone system. Cent Eur J Geosci 6(3):293–307.
<a href="https://doi.org/10.2478/s13533-012-0189-5">doi:10.2478/s13533-012-0189-5</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Loading mandatory data for the Example 'Points'
data(inp_exPoints)

# Calculate values of all default bioclimatic indices with default settings,
# at a grid cell near Szeged, Hungary (46.3N, 20.2E) (for the normal period 1981-2010)
with(inp_exPoints, {
bci1 &lt;- cliBioCliIdxPoints(colMeans(temp), colMeans(prec))
bci1
})


# Calculate values of all selected bioclimatic indices with default settings,
# at a grid cell near Szeged, Hungary (46.3N, 20.2E) (for the normal period 1981-2010)
with(inp_exPoints, {
year &lt;- trunc(mean(seq(1981, 2010)))
bciOpVar &lt;- c("gdd5", "bdi", "cci", "tc", "gdd0", "tw", "ptc")
bci2 &lt;- cliBioCliIdxPoints(colMeans(temp), colMeans(prec), colMeans(bsdf), lat, elv,
   year = year, bciOpVar = bciOpVar)
bci2
})


</code></pre>

<hr>
<h2 id='cliBIOMEGrid'>Vegetation Classifier Using the BIOME Model</h2><span id='topic+cliBIOMEGrid'></span>

<h3>Description</h3>

<p>Calculates the values of bioclimatic indices used in the BIOME model developed by Prentice et al.
(1992), and designates the biome type using these values, for a given region and year/epoch, by using the
monthly time series of temperature, precipitation and relative sunshine duration, and the elevation data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cliBIOMEGrid(
  rs.temp,
  rs.prec,
  rs.bsdf,
  rl.elv,
  sc.year = 2000,
  rl.MSMC = 150,
  aprchTEMP = c("hip", "tsi", "const"),
  aprchPREC = c("tsi", "hip", "const"),
  aprchBSDF = c("hip", "const"),
  dvTEMP = rep(0.7, 12),
  dvPREC = rep(0.7, 12),
  verbose = FALSE,
  filename = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cliBIOMEGrid_+3A_rs.temp">rs.temp</code></td>
<td>
<p>multi-layer Raster*/SpatRaster object with one-year time series of monthly mean air temperature
(in °C)</p>
</td></tr>
<tr><td><code id="cliBIOMEGrid_+3A_rs.prec">rs.prec</code></td>
<td>
<p>multi-layer Raster*/SpatRaster object with one-year time series of monthly precipitation sum
(in mm)</p>
</td></tr>
<tr><td><code id="cliBIOMEGrid_+3A_rs.bsdf">rs.bsdf</code></td>
<td>
<p>multi-layer Raster*/SpatRaster object with one-year time series of monthly mean relative sunshine
duration (dimensionless)</p>
</td></tr>
<tr><td><code id="cliBIOMEGrid_+3A_rl.elv">rl.elv</code></td>
<td>
<p>single-layer Raster*/SpatRaster object with the elevation values (in meters above sea level)</p>
</td></tr>
<tr><td><code id="cliBIOMEGrid_+3A_sc.year">sc.year</code></td>
<td>
<p>'numeric' scalar with the value of the year (using astronomical year numbering)</p>
</td></tr>
<tr><td><code id="cliBIOMEGrid_+3A_rl.msmc">rl.MSMC</code></td>
<td>
<p>'numeric' scalar or single-layer Raster*/SpatRaster object with the value/values of the maximum
soil moisture capacity (aka 'bucket size') (in mm)</p>
</td></tr>
<tr><td><code id="cliBIOMEGrid_+3A_aprchtemp">aprchTEMP</code></td>
<td>
<p>'character' vector of length 1 that indicates the scheme used to generate daily values of the
daily mean air temperature for a specific year. Valid values are as follows: <br />
(a) <code>'hip'</code> -
this scheme applies the mean-preserving 'harmonic' interpolation method of Epstein (1991) to the values of
monthly mean air temperature in order to generate daily values; <br />
(b) <code>'tsi'</code> -
this scheme uses an iterative interpolation technique (Lüdeke et al. 1994) to time series of the monthly mean
air temperature, in order to generate a synthetic time series of the selected meteorological variable at a
temporal resolution that is higher than the daily scale; finally, this synthetic time series is upscaled to a
daily resolution; <br />
(c) <code>'const'</code> -
this scheme is assumed that values of the daily mean air temperature are constant within each month.</p>
</td></tr>
<tr><td><code id="cliBIOMEGrid_+3A_aprchprec">aprchPREC</code></td>
<td>
<p>'character' vector of length 1 that indicates the scheme to generate daily values of the
daily precipitation sum. Valid values are as follows: <br />
(a) <code>'tsi'</code> -
this scheme uses an iterative interpolation technique (Lüdeke et al. 1994) to time series of the monthly mean
precipitation intensity, in order to generate a synthetic time series of the selected meteorological variable
at a temporal resolution that is higher than the daily scale; finally, this synthetic time series is upscaled
to a daily resolution; <br />
(b) <code>'hip'</code> -
this scheme applies the mean-preserving 'harmonic' interpolation method of Epstein (1991) to the values of
monthly mean precipitation intensity in order to generate daily values; <br />
(c) <code>'const'</code> -
this scheme is assumed that values of the daily precipitation sum are constant within each month (the monthly
precipitation sum is divided equally across each day of the month).</p>
</td></tr>
<tr><td><code id="cliBIOMEGrid_+3A_aprchbsdf">aprchBSDF</code></td>
<td>
<p>'character' vector of length 1 that indicates the scheme used to generate daily values of the
daily fractional sunshine duration for a specific year. Valid values are as follows: <br />
(a) <code>'hip'</code> -
this scheme applies the mean-preserving 'harmonic' interpolation method of Epstein (1991) to the values of
monthly mean relative sunshine duration in order to generate daily values; <br />
(b) <code>'const'</code> -
this scheme is assumed that values of the daily relative sunshine duration are constant within each month.</p>
</td></tr>
<tr><td><code id="cliBIOMEGrid_+3A_dvtemp">dvTEMP</code></td>
<td>
<p>'numeric' vector of length 12 with monthly values of the damping variable for the air temperature
data.</p>
</td></tr>
<tr><td><code id="cliBIOMEGrid_+3A_dvprec">dvPREC</code></td>
<td>
<p>'numeric' vector of length 12 with monthly values of the damping variable for the precipitation data.</p>
</td></tr>
<tr><td><code id="cliBIOMEGrid_+3A_verbose">verbose</code></td>
<td>
<p>'logical' scalar that indicates whether or not values of the bioclimatic indices used should be
added to the output.</p>
</td></tr>
<tr><td><code id="cliBIOMEGrid_+3A_filename">filename</code></td>
<td>
<p>output filename</p>
</td></tr>
<tr><td><code id="cliBIOMEGrid_+3A_...">...</code></td>
<td>
<p>additional arguments passed on to <code><a href="terra.html#topic+writeRaster">writeRaster</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+cliBIOMEPoints">cliBIOMEPoints</a></code>.
</p>


<h3>Value</h3>

<p>Depending on the setting, a SpatRaster object with one or more layers where the numeric integers encoding
the biome type are stored at the last layer, while the additional layers contain the values of bioclimatic
indices used. The meaning of integers is given in the data frame <code><a href="#topic+vegClsNumCodes">vegClsNumCodes</a></code>. If
<code>verbose = FALSE</code>, the return object is a single-layer SpatRaster object with numeric integers encoding
the biome type.
</p>


<h3>Note</h3>

<p>The objects <code>'rs.temp'</code>, <code>'rs.prec'</code> and <code>'rs.bsdf'</code> must be 12-layer Raster*/SpatRaster
objects, while the object <code>'rl.elv'</code> has to be a single-layer Raster*/SpatRaster object. The object
<code>'rl.MSMC'</code> must be either a single positive number (a universal bucket size) or a single-layer
Raster*/SpatRaster object (a regionally-specified bucket size). These Raster*/SpatRaster objects must have the
same bounding box, projection, and resolution. The object <code>'sc.year'</code> has to be a single integer number.
</p>


<h3>References</h3>

<p><cite>Epstein ES (1991) On Obtaining Daily Climatological Values from Monthly Means. J Clim 4(3):365–368.
<a href="https://doi.org/10.1175/1520-0442%281991%29004%3C0365%3AOODCVF%3E2.0.CO%3B2">doi:10.1175/1520-0442(1991)004&lt;0365:OODCVF&gt;2.0.CO;2</a></cite>
</p>
<p><cite>Lüdeke MKB, Badeck FW, Otto RD, Häger C, Dönges S, Kindermann J, Würth G, Lang T, Jäkel U, Klaudius A,
Ramge P, Habermehl S, Kohlmaier GH (1994) The Frankfurt Biosphere Model: A global process-oriented model of
seasonal and long-term CO2 exchange between terrestrial ecosystems and the atmosphere. I. Model description
and illustrative results for cold deciduous and boreal forests. Clim Res 4(2):143-166. <a href="https://doi.org/10.3354/cr004143">doi:10.3354/cr004143</a></cite>
</p>
<p><cite>Prentice IC, Cramer W, Harrison SP, Leemans R, Monserud RA, Solomon AM (1992) A Global Biome Model Based on
Plant Physiology and Dominance, Soil Properties and Climate. J Biogeogr 19(2):117–134. <a href="https://doi.org/10.2307/2845499">doi:10.2307/2845499</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(raster)

# Loading mandatory data for the Example 'Climate Normal Grid'
data(inp_exClnrGrid)
inp_exClnrGrid &lt;- lapply(inp_exClnrGrid, crop, extent(20.15, 20.25, 46.25, 46.35))

# Designate the biome type (using the related bioclimatic indices), with default settings,
# at a grid cell near Szeged, Hungary (46.3N, 20.2E) (for the normal period 1981-2010)
with(inp_exClnrGrid, {
year &lt;- trunc(mean(seq(1981, 2010)))
rs.BIOME &lt;- cliBIOMEGrid(temp, prec, bsdf, elv, sc.year = year, verbose = TRUE)
rs.BIOME
})


</code></pre>

<hr>
<h2 id='cliBIOMEPoints'>Vegetation Classifier Using the BIOME Model</h2><span id='topic+cliBIOMEPoints'></span>

<h3>Description</h3>

<p>Calculates the values of bioclimatic indices used in the BIOME model developed by Prentice et al.
(1992), and designates the biome type using these values, for a given geographical location (latitude and
elevation) and year/epoch, by using the monthly time series of temperature, precipitation and relative
sunshine duration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cliBIOMEPoints(
  temp,
  prec,
  bsdf,
  lat,
  elv,
  year = 2000,
  MSMC = 150,
  aprchTEMP = c("hip", "tsi", "const"),
  aprchPREC = c("tsi", "hip", "const"),
  aprchBSDF = c("hip", "const"),
  dvTEMP = rep(0.7, 12),
  dvPREC = rep(0.7, 12),
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cliBIOMEPoints_+3A_temp">temp</code></td>
<td>
<p>'numeric' R object with one-year time series of monthly mean air temperature (in °C)</p>
</td></tr>
<tr><td><code id="cliBIOMEPoints_+3A_prec">prec</code></td>
<td>
<p>'numeric' R object with one-year time series of monthly precipitation sum (in mm)</p>
</td></tr>
<tr><td><code id="cliBIOMEPoints_+3A_bsdf">bsdf</code></td>
<td>
<p>'numeric' R object with one-year time series of monthly mean relative sunshine duration (dimensionless)</p>
</td></tr>
<tr><td><code id="cliBIOMEPoints_+3A_lat">lat</code></td>
<td>
<p>'numeric' vector with the latitude coordinates (in decimal degrees)</p>
</td></tr>
<tr><td><code id="cliBIOMEPoints_+3A_elv">elv</code></td>
<td>
<p>'numeric' vector with the elevation values (in meters above sea level)</p>
</td></tr>
<tr><td><code id="cliBIOMEPoints_+3A_year">year</code></td>
<td>
<p>'numeric' vector with values of the year (using astronomical year numbering)</p>
</td></tr>
<tr><td><code id="cliBIOMEPoints_+3A_msmc">MSMC</code></td>
<td>
<p>'numeric' vector with values of the maximum soil moisture capacity (aka 'bucket size') (in mm)</p>
</td></tr>
<tr><td><code id="cliBIOMEPoints_+3A_aprchtemp">aprchTEMP</code></td>
<td>
<p>'character' vector of length 1 that indicates the scheme used to generate daily values of the
daily mean air temperature for a specific year. Valid values are as follows: <br />
(a) <code>'hip'</code> -
this scheme applies the mean-preserving 'harmonic' interpolation method of Epstein (1991) to the values of
monthly mean air temperature in order to generate daily values; <br />
(b) <code>'tsi'</code> -
this scheme uses an iterative interpolation technique (Lüdeke et al. 1994) to time series of the monthly mean
air temperature, in order to generate a synthetic time series of the selected meteorological variable at a
temporal resolution that is higher than the daily scale; finally, this synthetic time series is upscaled to a
daily resolution; <br />
(c) <code>'const'</code> -
this scheme is assumed that values of the daily mean air temperature are constant within each month.</p>
</td></tr>
<tr><td><code id="cliBIOMEPoints_+3A_aprchprec">aprchPREC</code></td>
<td>
<p>'character' vector of length 1 that indicates the scheme to generate daily values of the
daily precipitation sum. Valid values are as follows: <br />
(a) <code>'tsi'</code> -
this scheme uses an iterative interpolation technique (Lüdeke et al. 1994) to time series of the monthly mean
precipitation intensity, in order to generate a synthetic time series of the selected meteorological variable
at a temporal resolution that is higher than the daily scale; finally, this synthetic time series is upscaled
to a daily resolution; <br />
(b) <code>'hip'</code> -
this scheme applies the mean-preserving 'harmonic' interpolation method of Epstein (1991) to the values of
monthly mean precipitation intensity in order to generate daily values; <br />
(c) <code>'const'</code> -
this scheme is assumed that values of the daily precipitation sum are constant within each month (the monthly
precipitation sum is divided equally across each day of the month).</p>
</td></tr>
<tr><td><code id="cliBIOMEPoints_+3A_aprchbsdf">aprchBSDF</code></td>
<td>
<p>'character' vector of length 1 that indicates the scheme used to generate daily values of the
daily fractional sunshine duration for a specific year. Valid values are as follows: <br />
(a) <code>'hip'</code> -
this scheme applies the mean-preserving 'harmonic' interpolation method of Epstein (1991) to the values of
monthly mean relative sunshine duration in order to generate daily values; <br />
(b) <code>'const'</code> -
this scheme is assumed that values of the daily relative sunshine duration are constant within each month.</p>
</td></tr>
<tr><td><code id="cliBIOMEPoints_+3A_dvtemp">dvTEMP</code></td>
<td>
<p>'numeric' vector of length 12 with monthly values of the damping variable for the air temperature
data.</p>
</td></tr>
<tr><td><code id="cliBIOMEPoints_+3A_dvprec">dvPREC</code></td>
<td>
<p>'numeric' vector of length 12 with monthly values of the damping variable for the precipitation data.</p>
</td></tr>
<tr><td><code id="cliBIOMEPoints_+3A_verbose">verbose</code></td>
<td>
<p>'logical' scalar that indicates whether or not values of the bioclimatic indices used should be
added to the output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To classify vegetation, the BIOME model developed by Prentice et al. (1992) uses the values of the
following 5 bioclimatic indices:
</p>

<ul>
<li><p><code>tc</code>: Mean Temperature of the Coldest Month (in °C)
</p>
</li>
<li><p><code>tw</code>: Mean Temperature of the Warmest Month (in °C)
</p>
</li>
<li><p><code>gdd5</code>: Growing Degree-Days on 5°C base (in °C day)
</p>
</li>
<li><p><code>gdd0</code>: Growing Degree-Days on 0°C base (in °C day)
</p>
</li>
<li><p><code>ptc</code>: Priestley–Taylor Coefficient (dimensionless)
</p>
</li></ul>

<p>For details about calculating bioclimatic indices, see the function
<code><a href="#topic+cliBioCliIdxPoints">cliBioCliIdxPoints</a></code>. The Priestley–Taylor coefficient (<code>ptc</code>, dimensionless)
is exceptional because its computation requires a simulation of evapotranspiration at daily time step via the
implementation of the SPLASH algorithm (Davis et al. 2017) (see
<code><a href="#topic+dlyEngWtrFluxPoints">dlyEngWtrFluxPoints</a></code>). The application of the SPLASH algorithm requires, among other
things, one-year time series of the climate variables at daily scale, which are generated from average monthly
values using the function <code><a href="#topic+dlyWeaGenPoints">dlyWeaGenPoints</a></code>. <br />
The designation of the biome type is implemented as a two-step procedure. First, the presence of each plant
functional type (PFT) is estimated under the given climatic conditions. Subsequently, the biome type is
designated by combining PFTs occurring at the maximal dominance level with each other (see Table 5 in Prentice
et al. (1992)). Each PFT is described by constraints of bioclimatic variables associated with their climatic
tolerances and requirements (see Table 1 in Prentice et al. (1992)). In the initial version of the BIOME
model, a total of 17 biome types are distinguished (see <code><a href="#topic+vegClsNumCodes">vegClsNumCodes</a></code>).
</p>


<h3>Value</h3>

<p>Depending on the setting, a data frame with one or more columns where the biome types are stored in the
last (character) column, while the additional columns contain the values of bioclimatic indices used. The
abbreviations of biome types can be found in the data frame <code><a href="#topic+vegClsNumCodes">vegClsNumCodes</a></code>. If
<code>verbose = FALSE</code>, the return object is a one-column data frame with the biome types.
</p>


<h3>Note</h3>

<p>As with any function with a point mode, a set of basic input data is defined here. In this case, they are as
follows: <code>'temp'</code> (one-year time series of monthly mean air temperature), <code>'prec'</code> (one-year time
series of monthly precipitation sum), and <code>'bsdf'</code> (one-year time series of monthly mean relative
sunshine duration). The objects <code>'temp'</code>, <code>'prec'</code> and <code>'bsdf'</code> must be either vectors of
length 12 or 12-column matrices. The first dimensions of these matrices have to be the same length. The
function automatically converts vectors into single-row matrices during the error handling, and then uses these
matrices. The first dimensions of these matrices determines the number of rows in the result matrix. In the
case of arguments that do not affect the course of the calculation procedure or the structure of the return
object, scalar values (i.e., 'numeric' vector of length 1) may also be allowed. In this case, they are as
follows: <code>'lat'</code> (latitude coordinates in decimal degrees), <code>'elv'</code> (elevation in meters above sea
level), <code>'year'</code> (year using astronomical year numbering), and <code>'MSMC'</code> ('bucket size' in mm). These
scalars are converted to vectors by the function during the error handling, and these vectors are applied in
the further calculations. If these data are stored in vectors of length at least 2, their length must be the
same size of first dimension of the matrices containing the basic data.
</p>


<h3>References</h3>

<p><cite>Davis TW, Prentice IC, Stocker BD, Thomas RT, Whitley RJ, Wang H, Evans BJ, Gallego-Sala AV, Sykes MT,
Cramer W (2017) Simple process-led algorithms for simulating habitats (SPLASH v.1.0): robust indices of
radiation, evapotranspiration and plant-available moisture. Geosci Model Dev 10(2):689–708.
<a href="https://doi.org/10.5194/gmd-10-689-2017">doi:10.5194/gmd-10-689-2017</a></cite>
</p>
<p><cite>Epstein ES (1991) On Obtaining Daily Climatological Values from Monthly Means. J Clim 4(3):365–368.
<a href="https://doi.org/10.1175/1520-0442%281991%29004%3C0365%3AOODCVF%3E2.0.CO%3B2">doi:10.1175/1520-0442(1991)004&lt;0365:OODCVF&gt;2.0.CO;2</a></cite>
</p>
<p><cite>Lüdeke MKB, Badeck FW, Otto RD, Häger C, Dönges S, Kindermann J, Würth G, Lang T, Jäkel U, Klaudius A,
Ramge P, Habermehl S, Kohlmaier GH (1994) The Frankfurt Biosphere Model: A global process-oriented model of
seasonal and long-term CO2 exchange between terrestrial ecosystems and the atmosphere. I. Model description
and illustrative results for cold deciduous and boreal forests. Clim Res 4(2):143-166. <a href="https://doi.org/10.3354/cr004143">doi:10.3354/cr004143</a></cite>
</p>
<p><cite>Prentice IC, Cramer W, Harrison SP, Leemans R, Monserud RA, Solomon AM (1992) A Global Biome Model Based on
Plant Physiology and Dominance, Soil Properties and Climate. J Biogeogr 19(2):117–134. <a href="https://doi.org/10.2307/2845499">doi:10.2307/2845499</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Loading mandatory data for the Example 'Points'
data(inp_exPoints)
data(vegClsNumCodes)

# Designate the biome type (using the related biolcimatic indices), with default settings,
# at a grid cell near Szeged, Hungary (46.3N, 20.2E) (for the normal period 1981-2010)
with(inp_exPoints, {
year &lt;- trunc(mean(seq(1981, 2010)))
BIOME &lt;- cliBIOMEPoints(colMeans(temp), colMeans(prec), colMeans(bsdf), lat, elv,
    year = year, verbose = TRUE)
numCode &lt;- which(sapply(vegClsNumCodes$Code.BIOME, identical, BIOME[, "vegCls"]))
cbind(BIOME[,-c(6)], vegClsNumCodes[numCode, c("Name.BIOME", "Code.BIOME")])
})


</code></pre>

<hr>
<h2 id='cliBrtSunDurFrcGrid'>Estimator for Fraction of Bright Sunshine Duration</h2><span id='topic+cliBrtSunDurFrcGrid'></span>

<h3>Description</h3>

<p>Estimates monthly averages for daily fraction of bright sunshine duration, for a given region and
year, by using the monthly time series of temperature and precipitation, and the elevation data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cliBrtSunDurFrcGrid(
  rs.temp,
  rs.prec,
  rl.elv,
  sc.year = 2000,
  aprchSIM = c("Solar123", "SPLASH"),
  filename = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cliBrtSunDurFrcGrid_+3A_rs.temp">rs.temp</code></td>
<td>
<p>multi-layer Raster*/SpatRaster object with one-year time series of monthly mean air temperature
(in °C)</p>
</td></tr>
<tr><td><code id="cliBrtSunDurFrcGrid_+3A_rs.prec">rs.prec</code></td>
<td>
<p>multi-layer Raster*/SpatRaster object with one-year time series of monthly precipitation sum
(in mm)</p>
</td></tr>
<tr><td><code id="cliBrtSunDurFrcGrid_+3A_rl.elv">rl.elv</code></td>
<td>
<p>single-layer Raster*/SpatRaster object with the elevation values (in meters above sea level)</p>
</td></tr>
<tr><td><code id="cliBrtSunDurFrcGrid_+3A_sc.year">sc.year</code></td>
<td>
<p>'numeric' scalar with the value of the year (using astronomical year numbering)</p>
</td></tr>
<tr><td><code id="cliBrtSunDurFrcGrid_+3A_aprchsim">aprchSIM</code></td>
<td>
<p>'character' vector of length 1 that indicates the formula used to estimate the value of solar
irradiance/irradiation for a specific day. Valid values are as follows: <br />
(a) <code>'Solar123'</code> -
in this approach, first, the mean hourly solar irradiance under cloudless-sky conditions is calculated as
proposed by Yin (1997b), with a minor modification, using the daytime means of optical air mass and
cosine zenith; the former is computed as recommended by Yin (1997b), while the latter is estimated by using
Eq 5 of Yin (1997a); however, in contrast to the original approach, where the solar constant was fixed at
<code class="reqn">4.9212 MJ m^{-2} hr^{-1}</code>, according to Yin (1999), its value is corrected by
calendar day for the variable ellipticity of the Earth's orbit, by using the scheme of Brock (1981); in the
calculations, the values of solar declination and daylength are derived by using the approach of Brock (1981);
<br />
(b) <code>'SPLASH'</code> -
in this approach, first, under varying orbital parameters, the daily solar radiation at the top of the
atmosphere is calculated (<code class="reqn">H_{0}</code>, Eq 7 in Davis et al. (2017)), and then this value is
multiplied by the atmospheric transmittivity to obtain the value of daily surface radiation; in this case as
well, cloudless conditions are assumed, i.e., the transmission coefficient is taken into account with an
universal value of 0.75, however, its value is modified as a function of elevation, by using the scheme of
Allen (1996); the daylength is calculated via Eq 1.6.11 in Duffie and Beckman (1991), using the sunset hour
angle (<code class="reqn">h_{s}</code>, Eq 8. in Davis et al. (2017)); finally, the mean hourly surface radiation is
derived as the quotient of the daily surface radiation and the daylength.</p>
</td></tr>
<tr><td><code id="cliBrtSunDurFrcGrid_+3A_filename">filename</code></td>
<td>
<p>output filename</p>
</td></tr>
<tr><td><code id="cliBrtSunDurFrcGrid_+3A_...">...</code></td>
<td>
<p>additional arguments passed on to <code><a href="terra.html#topic+writeRaster">writeRaster</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+cliBrtSunDurFrcPoints">cliBrtSunDurFrcPoints</a></code>.
</p>


<h3>Value</h3>

<p>A 12-layer SpatRaster object with one-year time series of monthly mean relative sunshine duration.
</p>


<h3>Note</h3>

<p>The objects <code>'rs.temp'</code> and <code>'rs.prec'</code> must be 12-layer Raster*/SpatRaster objects, while the
object <code>'rl.elv'</code> has to be a single-layer Raster*/SpatRaster object. These Raster*/SpatRaster objects
must have the same bounding box, projection, and resolution. The object <code>'sc.year'</code> has to be a single
integer number.
</p>


<h3>References</h3>

<p><cite>Allen RG (1996) Assessing integrity of weather data for reference evapotranspiration estimation. J Irrig
Drain Eng 122(2):97–106. <a href="https://doi.org/10.1061/%28ASCE%290733-9437%281996%29122%3A2%2897%29">doi:10.1061/(ASCE)0733-9437(1996)122:2(97)</a></cite>
</p>
<p><cite>Berger A, Loutre MF (1991) Insolation values for the climate of the last 10 million years. Quat Sci Rev
10(4):297-317. <a href="https://doi.org/10.1016/0277-3791%2891%2990033-Q">doi:10.1016/0277-3791(91)90033-Q</a></cite>
</p>
<p><cite>Brock TD (1981) Calculating solar radiation for ecological studies. Ecol Model 14(1–2):1-19.
<a href="https://doi.org/10.1016/0304-3800%2881%2990011-9">doi:10.1016/0304-3800(81)90011-9</a></cite>
</p>
<p><cite>Davis TW, Prentice IC, Stocker BD, Thomas RT, Whitley RJ, Wang H, Evans BJ, Gallego-Sala AV, Sykes MT,
Cramer W (2017) Simple process-led algorithms for simulating habitats (SPLASH v.1.0): robust indices of
radiation, evapotranspiration and plant-available moisture. Geosci Model Dev 10(2):689–708.
<a href="https://doi.org/10.5194/gmd-10-689-2017">doi:10.5194/gmd-10-689-2017</a></cite>
</p>
<p><cite>Duffie JA, Beckman WA (1991) Solar Engineering of Thermal Processes. Second Edition. Wiley-Interscience,
New York, NY</cite>
</p>
<p><cite>Yin X (1997a) Calculating daytime mean relative air mass. Agric For Meteorol 87(2-3):85-90.
<a href="https://doi.org/10.1016/S0168-1923%2897%2900029-4">doi:10.1016/S0168-1923(97)00029-4</a></cite>
</p>
<p><cite>Yin X (1997b) Optical Air Mass: Daily Integration and its Applications. Meteorol Atmos Phys 63(3-4):227-233.
<a href="https://doi.org/10.1007/BF01027387">doi:10.1007/BF01027387</a></cite>
</p>
<p><cite>Yin X (1999) Bright Sunshine Duration in Relation to Precipitation, Air Temperature and Geographic Location.
Theor Appl Climatol 64(1–2):61–68. <a href="https://doi.org/10.1007/s007040050111">doi:10.1007/s007040050111</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(raster)

# Loading mandatory data for the Example 'Single-Year Grid'
data(inp_exSglyGrid)
inp_exSglyGrid &lt;- lapply(inp_exSglyGrid, crop, extent(20.15, 20.25, 46.25, 46.35))

# Estimate values of the monthly mean relative sunshine duration
# at a grid cell near Szeged, Hungary (46.3N, 20.2E), in the year 2010
with(inp_exSglyGrid, {
rs.bsdf &lt;- cliBrtSunDurFrcGrid(temp, prec, elv, sc.year = 2010)
rs.bsdf
})


</code></pre>

<hr>
<h2 id='cliBrtSunDurFrcPoints'>Estimator for Fraction of Bright Sunshine Duration</h2><span id='topic+cliBrtSunDurFrcPoints'></span>

<h3>Description</h3>

<p>Estimates monthly averages for daily fraction of bright sunshine duration, for a given geographical
location (latitude, longitude, and elevation) and year, by using the monthly time series of temperature and
precipitation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cliBrtSunDurFrcPoints(
  temp,
  prec,
  lat,
  lon,
  elv,
  year = 2000,
  aprchSIM = c("Solar123", "SPLASH")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cliBrtSunDurFrcPoints_+3A_temp">temp</code></td>
<td>
<p>'numeric' R object with one-year time series of monthly mean air temperature (in °C)</p>
</td></tr>
<tr><td><code id="cliBrtSunDurFrcPoints_+3A_prec">prec</code></td>
<td>
<p>'numeric' R object with one-year time series of monthly precipitation sum (in mm)</p>
</td></tr>
<tr><td><code id="cliBrtSunDurFrcPoints_+3A_lat">lat</code></td>
<td>
<p>'numeric' vector with the latitude coordinates (in decimal degrees)</p>
</td></tr>
<tr><td><code id="cliBrtSunDurFrcPoints_+3A_lon">lon</code></td>
<td>
<p>'numeric' vector with the longitude coordinates (in decimal degrees)</p>
</td></tr>
<tr><td><code id="cliBrtSunDurFrcPoints_+3A_elv">elv</code></td>
<td>
<p>'numeric' vector with the elevation values (in meters above sea level)</p>
</td></tr>
<tr><td><code id="cliBrtSunDurFrcPoints_+3A_year">year</code></td>
<td>
<p>'numeric' vector with values of the year (using astronomical year numbering)</p>
</td></tr>
<tr><td><code id="cliBrtSunDurFrcPoints_+3A_aprchsim">aprchSIM</code></td>
<td>
<p>'character' vector of length 1 that indicates the formula used to estimate the value of solar
irradiance/irradiation for a specific day. Valid values are as follows: <br />
(a) <code>'Solar123'</code> -
in this approach, first, the mean hourly solar irradiance under cloudless-sky conditions is calculated as
proposed by Yin (1997b), with a minor modification, using the daytime means of optical air mass and
cosine zenith; the former is computed as recommended by Yin (1997b), while the latter is estimated by using
Eq 5 of Yin (1997a); however, in contrast to the original approach, where the solar constant was fixed at
<code class="reqn">4.9212 MJ m^{-2} hr^{-1}</code>, according to Yin (1999), its value is corrected by
calendar day for the variable ellipticity of the Earth's orbit, by using the scheme of Brock (1981); in the
calculations, the values of solar declination and daylength are derived by using the approach of Brock (1981);
<br />
(b) <code>'SPLASH'</code> -
in this approach, first, under varying orbital parameters, the daily solar radiation at the top of the
atmosphere is calculated (<code class="reqn">H_{0}</code>, Eq 7 in Davis et al. (2017)), and then this value is
multiplied by the atmospheric transmittivity to obtain the value of daily surface radiation; in this case as
well, cloudless conditions are assumed, i.e., the transmission coefficient is taken into account with an
universal value of 0.75, however, its value is modified as a function of elevation, by using the scheme of
Allen (1996); the daylength is calculated via Eq 1.6.11 in Duffie and Beckman (1991), using the sunset hour
angle (<code class="reqn">h_{s}</code>, Eq 8. in Davis et al. (2017)); finally, the mean hourly surface radiation is
derived as the quotient of the daily surface radiation and the daylength.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To estimate the monthly averages of relative sunlight duration, the approach presented by Yin (1999) is
implemented here. Many variables in this estimation scheme can be easily and unambiguously determined, but the
approach uses two important quantities, the calculation method of which can be chosen here depending on the
purpose of the investigations. One of them is the estimated value of the mean hourly solar irradiance under
cloudless-sky conditions. This quantity can be estimated in this implementation of the approach with the
original method (<code>aprchSIM = 'Solar123'</code>) or with the solar radiation model used in the SPLASH algorithm,
considering the variability of orbital parameters of the Earth over time (<code>aprchSIM = 'SPLASH'</code>). The
latter is recommended for paleo-climatological and paleo-environmental studies. These solar radiation models
is also applied to calculate the daylength, whose monthly averages are used to estimate monthly averages of
daily potential evapotranspiration (Eqs. A10 and A11 in Yin (1998)). <br />
The procedure proposed by Yin (1999) requires the calculation of several regional factors (see Eq 3.3 in Yin
(1999)). Each regional factor is activated as a function of latitude and longitude. However, it is important
to note that in this implementation, these factors are activated with the current configuration of continents
and islands. Continents and regions are classified using the medium-resolution world map of the
<code><a href="rnaturalearthdata.html#topic+rnaturalearthdata">rnaturalearthdata</a></code>, if the high-resolution world map of the
<a href="https://github.com/ropensci/rnaturalearthhires">rnaturalearthhires</a> is not available. In checking whether
or not a given geographic location can be defined as an island, the high-resolution world maps (version 5.1.1)
of the <a href="https://www.naturalearthdata.com/">Natural Earth</a> are applied.
</p>


<h3>Value</h3>

<p>A 12-column matrix with monthly averages of relative sunshine duration.
</p>


<h3>Note</h3>

<p>As with any function with a point mode, a set of basic input data is defined here. In this case, they are as
follows: <code>'temp'</code> (one-year time series of monthly mean air temperature), and <code>'prec'</code> (one-year time
series of monthly precipitation sum). The objects <code>'temp'</code> and <code>'prec'</code> must be either 12-length
vectors or 12-column matrices. The first dimensions of these matrices have to be the same length. The function
automatically converts vectors into single-row matrices during the error handling, and then uses these
matrices. The first dimensions of these matrices determines the number of rows in the result matrix. In the
case of arguments that do not affect the course of the calculation procedure or the structure of the return
object, scalar values (i.e., 'numeric' vector of length 1) may also be allowed. In this case, they are as
follows: <code>'lat'</code> (latitude coordinates in decimal degrees), <code>'lon'</code> (longitude coordinates in decimal
degrees), <code>'elv'</code> (elevation in meters above sea level), and <code>'year'</code> (year using astronomical year
numbering). These scalars are converted to vectors by the function during the error handling, and these vectors
are applied in the further calculations. If these data are stored in vectors of length at least 2, their length
must be the same size of first dimension of the matrices containing the basic data.
</p>


<h3>References</h3>

<p><cite>Allen RG (1996) Assessing integrity of weather data for reference evapotranspiration estimation. J Irrig
Drain Eng 122(2):97–106. <a href="https://doi.org/10.1061/%28ASCE%290733-9437%281996%29122%3A2%2897%29">doi:10.1061/(ASCE)0733-9437(1996)122:2(97)</a></cite>
</p>
<p><cite>Berger A, Loutre MF (1991) Insolation values for the climate of the last 10 million years. Quat Sci Rev
10(4):297-317. <a href="https://doi.org/10.1016/0277-3791%2891%2990033-Q">doi:10.1016/0277-3791(91)90033-Q</a></cite>
</p>
<p><cite>Brock TD (1981) Calculating solar radiation for ecological studies. Ecol Model 14(1–2):1-19.
<a href="https://doi.org/10.1016/0304-3800%2881%2990011-9">doi:10.1016/0304-3800(81)90011-9</a></cite>
</p>
<p><cite>Davis TW, Prentice IC, Stocker BD, Thomas RT, Whitley RJ, Wang H, Evans BJ, Gallego-Sala AV, Sykes MT,
Cramer W (2017) Simple process-led algorithms for simulating habitats (SPLASH v.1.0): robust indices of
radiation, evapotranspiration and plant-available moisture. Geosci Model Dev 10(2):689–708.
<a href="https://doi.org/10.5194/gmd-10-689-2017">doi:10.5194/gmd-10-689-2017</a></cite>
</p>
<p><cite>Duffie JA, Beckman WA (1991) Solar Engineering of Thermal Processes. Second Edition. Wiley-Interscience,
New York, NY</cite>
</p>
<p><cite>Yin X (1997a) Calculating daytime mean relative air mass. Agric For Meteorol 87(2-3):85-90.
<a href="https://doi.org/10.1016/S0168-1923%2897%2900029-4">doi:10.1016/S0168-1923(97)00029-4</a></cite>
</p>
<p><cite>Yin X (1997b) Optical Air Mass: Daily Integration and its Applications. Meteorol Atmos Phys 63(3-4):227-233.
<a href="https://doi.org/10.1007/BF01027387">doi:10.1007/BF01027387</a></cite>
</p>
<p><cite>Yin X (1998) The Albedo of Vegetated Land Surfaces: Systems Analysis and Mathematical Modeling. Theor Appl
Climatol 60(1–4):121–140. <a href="https://doi.org/10.1007/s007040050038">doi:10.1007/s007040050038</a></cite>
</p>
<p><cite>Yin X (1999) Bright Sunshine Duration in Relation to Precipitation, Air Temperature and Geographic Location.
Theor Appl Climatol 64(1–2):61–68. <a href="https://doi.org/10.1007/s007040050111">doi:10.1007/s007040050111</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library (graphics)

# Loading mandatory data for the Example 'Points'
data(inp_exPoints)

# Measured and estimated one-year time series of the monthly mean relative sunshine duration,
# at a grid cell near Szeged, Hungary (46.3N, 20.2E), in the year 2010
with(inp_exPoints, {
bsdf01 &lt;- matrix(nrow = 0, ncol = 12, dimnames = list(NULL, month.abb))
bsdf01 &lt;- rbind(bsdf01, "Measured" = bsdf["2010", ])
bsdf01 &lt;- rbind(bsdf01, "Solar123" = cliBrtSunDurFrcPoints(temp["2010", ], prec["2010", ],
    lat, lon, elv, year = 2010))
bsdf01 &lt;- rbind(bsdf01, "SPLASH" = cliBrtSunDurFrcPoints(temp["2010", ], prec["2010", ],
    lat, lon, elv, year = 2010, aprchSIM = "SPLASH"))
cols &lt;- c("black", "green", "blue")
matplot(t(bsdf01), type = "l", lwd = 2, col = cols, xaxt = "n", xlab = "Month",
    ylab = "Average relative sunshine duration (unitless)")
axis(1, at = seq(1, ncol(bsdf01)), labels = colnames(bsdf01))
legend(1, 0.7, legend = rownames(bsdf01), col = cols, lty = 1 : 2, lwd = 2, xpd = TRUE)
})

# Relative root mean square error between measured and estimated values for the 'bsdf',
# at a grid cell near Szeged, Hungary (46.3N, 20.2E), in the period 1981-2010
with(inp_exPoints, {
years &lt;- seq(1981, 2010)
bsdf02 &lt;- cliBrtSunDurFrcPoints(temp, prec, lat, lon, elv, year = years)
rrmse &lt;- function(pre, obs) { (sqrt(mean((pre - obs) ^ 2.)) / mean(obs)) * 100. }
rrmse_bsdf &lt;- sapply(1 : 12, function(i) { rrmse(bsdf02[, i], bsdf[, i])  })
cols &lt;- c("black", "green")
plot(rrmse_bsdf, type = "l", lwd = 2, col = cols, xaxt = "n", xlab = "Month",
    ylab = "Relative root mean square error (%)")
axis(1, at = 1 : 12, labels = month.abb)
})


</code></pre>

<hr>
<h2 id='cliForestSteppeGrid'>Forest-Steppe Models</h2><span id='topic+cliForestSteppeGrid'></span>

<h3>Description</h3>

<p>Calculates the values of bioclimatic indices used in forest-steppe models with different theoretical
backgrounds, and estimates the presence/absence of 'forest-steppe' ecotone, for a given region and year/epoch,
by using the monthly time series of climate variables, and the elevation data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cliForestSteppeGrid(
  rs.temp,
  rs.prec,
  rs.bsdf = NULL,
  rl.elv = NULL,
  sc.year = 2000,
  aprchTEMP = c("hip", "tsi", "const"),
  aprchBSDF = c("hip", "const"),
  dvTEMP = rep(0.7, 12),
  verbose = FALSE,
  filename = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cliForestSteppeGrid_+3A_rs.temp">rs.temp</code></td>
<td>
<p>multi-layer Raster*/SpatRaster object with one-year time series of monthly mean air temperature
(in °C)</p>
</td></tr>
<tr><td><code id="cliForestSteppeGrid_+3A_rs.prec">rs.prec</code></td>
<td>
<p>multi-layer Raster*/SpatRaster object with one-year time series of monthly precipitation sum
(in mm)</p>
</td></tr>
<tr><td><code id="cliForestSteppeGrid_+3A_rs.bsdf">rs.bsdf</code></td>
<td>
<p>multi-layer Raster*/SpatRaster object with one-year time series of monthly mean relative sunshine
duration (dimensionless)</p>
</td></tr>
<tr><td><code id="cliForestSteppeGrid_+3A_rl.elv">rl.elv</code></td>
<td>
<p>single-layer Raster*/SpatRaster object with the elevation values (in meters above sea level)</p>
</td></tr>
<tr><td><code id="cliForestSteppeGrid_+3A_sc.year">sc.year</code></td>
<td>
<p>'numeric' scalar with the value of the year (using astronomical year numbering)</p>
</td></tr>
<tr><td><code id="cliForestSteppeGrid_+3A_aprchtemp">aprchTEMP</code></td>
<td>
<p>'character' vector of length 1 that indicates the scheme used to generate daily values of the
daily mean air temperature for a specific year. Valid values are as follows: <br />
(a) <code>'hip'</code> -
this scheme applies the mean-preserving 'harmonic' interpolation method of Epstein (1991) to the values of
monthly mean air temperature in order to generate daily values; <br />
(b) <code>'tsi'</code> -
this scheme uses an iterative interpolation technique (Lüdeke et al. 1994) to time series of the monthly mean
air temperature, in order to generate a synthetic time series of the selected meteorological variable at a
temporal resolution that is higher than the daily scale; finally, this synthetic time series is upscaled to a
daily resolution; <br />
(c) <code>'const'</code> -
this scheme is assumed that values of the daily mean air temperature are constant within each month.</p>
</td></tr>
<tr><td><code id="cliForestSteppeGrid_+3A_aprchbsdf">aprchBSDF</code></td>
<td>
<p>'character' vector of length 1 that indicates the scheme used to generate daily values of the
daily fractional sunshine duration for a specific year. Valid values are as follows: <br />
(a) <code>'hip'</code> -
this scheme applies the mean-preserving 'harmonic' interpolation method of Epstein (1991) to the values of
monthly mean relative sunshine duration in order to generate daily values; <br />
(b) <code>'const'</code> -
this scheme is assumed that values of the daily relative sunshine duration are constant within each month.</p>
</td></tr>
<tr><td><code id="cliForestSteppeGrid_+3A_dvtemp">dvTEMP</code></td>
<td>
<p>'numeric' vector of length 12 with monthly values of the damping variable for the air temperature
data.</p>
</td></tr>
<tr><td><code id="cliForestSteppeGrid_+3A_verbose">verbose</code></td>
<td>
<p>'logical' scalar that indicates whether or not values of the bioclimatic indices used should be
added to the output.</p>
</td></tr>
<tr><td><code id="cliForestSteppeGrid_+3A_filename">filename</code></td>
<td>
<p>output filename</p>
</td></tr>
<tr><td><code id="cliForestSteppeGrid_+3A_...">...</code></td>
<td>
<p>additional arguments passed on to <code><a href="terra.html#topic+writeRaster">writeRaster</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+cliForestSteppePoints">cliForestSteppePoints</a></code>.
</p>


<h3>Value</h3>

<p>Depending on the settings, a SpatRaster object with two or more layers where the presence/absence data are
stored in layers labelled <code>'fsp_hlz'</code>, <code>'fsp_fai'</code> and <code>'fsp_svm'</code>, while the additional layers
contain the values of bioclimatic indices used. If <code>verbose = FALSE</code>, the return object is a two- or
three-layer SpatRaster object with presence/absence data, depending on the available data.
</p>


<h3>Note</h3>

<p>The objects <code>'rs.temp'</code>, <code>'rs.prec'</code> and <code>'rs.bsdf'</code> must be 12-layer Raster*/SpatRaster
objects, while the object <code>'rl.elv'</code> has to be a single-layer Raster*/SpatRaster object. These
Raster*/SpatRaster objects must have the same bounding box, projection, and resolution. The object
<code>'sc.year'</code> has to be a single integer number.
</p>


<h3>References</h3>

<p><cite>Epstein ES (1991) On Obtaining Daily Climatological Values from Monthly Means. J Clim 4(3):365–368.
<a href="https://doi.org/10.1175/1520-0442%281991%29004%3C0365%3AOODCVF%3E2.0.CO%3B2">doi:10.1175/1520-0442(1991)004&lt;0365:OODCVF&gt;2.0.CO;2</a></cite>
</p>
<p><cite>Lüdeke MKB, Badeck FW, Otto RD, Häger C, Dönges S, Kindermann J, Würth G, Lang T, Jäkel U, Klaudius A,
Ramge P, Habermehl S, Kohlmaier GH (1994) The Frankfurt Biosphere Model: A global process-oriented model of
seasonal and long-term CO2 exchange between terrestrial ecosystems and the atmosphere. I. Model description
and illustrative results for cold deciduous and boreal forests. Clim Res 4(2):143-166. <a href="https://doi.org/10.3354/cr004143">doi:10.3354/cr004143</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Loading mandatory data for the Example 'Climate Normal Grid'
data(inp_exClnrGrid)

# Predict the 'forest-steppe' ecotone (using the related bioclimatic indices),
# with default settings, for Csongrad-Csanad County (for the normal period 1981-2010)
with(inp_exClnrGrid, {
year &lt;- trunc(mean(seq(1981, 2010)))
rs.fsp1 &lt;- cliForestSteppeGrid(temp, prec, verbose = TRUE)
rs.fsp1
})


# Predict the 'forest-steppe' ecotone (using the related bioclimatic indices),
# with default settings, for Csongrad-Csanad County (for the normal period 1981-2010)
with(inp_exClnrGrid, {
year &lt;- trunc(mean(seq(1981, 2010)))
rs.fsp2 &lt;- cliForestSteppeGrid(temp, prec, bsdf, elv, sc.year = year, verbose = TRUE)
rs.fsp2
})


</code></pre>

<hr>
<h2 id='cliForestSteppePoints'>Forest-Steppe Models</h2><span id='topic+cliForestSteppePoints'></span>

<h3>Description</h3>

<p>Calculates the values of bioclimatic indices used in forest-steppe models with different theoretical
backgrounds, and estimates the presence/absence of 'forest-steppe' ecotone, for a given geographical location
(latitude and elevation) and year/epoch, by using the monthly time series of climate variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cliForestSteppePoints(
  temp,
  prec,
  bsdf = NULL,
  lat = NULL,
  elv = NULL,
  year = 2000,
  aprchTEMP = c("hip", "tsi", "const"),
  aprchBSDF = c("hip", "const"),
  dvTEMP = rep(0.7, 12),
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cliForestSteppePoints_+3A_temp">temp</code></td>
<td>
<p>'numeric' R object with one-year time series of monthly mean air temperature (in °C)</p>
</td></tr>
<tr><td><code id="cliForestSteppePoints_+3A_prec">prec</code></td>
<td>
<p>'numeric' R object with one-year time series of monthly precipitation sum (in mm)</p>
</td></tr>
<tr><td><code id="cliForestSteppePoints_+3A_bsdf">bsdf</code></td>
<td>
<p>'numeric' R object with one-year time series of monthly mean relative sunshine duration (dimensionless)</p>
</td></tr>
<tr><td><code id="cliForestSteppePoints_+3A_lat">lat</code></td>
<td>
<p>'numeric' vector with the latitude coordinates (in decimal degrees)</p>
</td></tr>
<tr><td><code id="cliForestSteppePoints_+3A_elv">elv</code></td>
<td>
<p>'numeric' vector with the elevation values (in meters above sea level)</p>
</td></tr>
<tr><td><code id="cliForestSteppePoints_+3A_year">year</code></td>
<td>
<p>'numeric' vector with values of the year (using astronomical year numbering)</p>
</td></tr>
<tr><td><code id="cliForestSteppePoints_+3A_aprchtemp">aprchTEMP</code></td>
<td>
<p>'character' vector of length 1 that indicates the scheme used to generate daily values of the
daily mean air temperature for a specific year. Valid values are as follows: <br />
(a) <code>'hip'</code> -
this scheme applies the mean-preserving 'harmonic' interpolation method of Epstein (1991) to the values of
monthly mean air temperature in order to generate daily values; <br />
(b) <code>'tsi'</code> -
this scheme uses an iterative interpolation technique (Lüdeke et al. 1994) to time series of the monthly mean
air temperature, in order to generate a synthetic time series of the selected meteorological variable at a
temporal resolution that is higher than the daily scale; finally, this synthetic time series is upscaled to a
daily resolution; <br />
(c) <code>'const'</code> -
this scheme is assumed that values of the daily mean air temperature are constant within each month.</p>
</td></tr>
<tr><td><code id="cliForestSteppePoints_+3A_aprchbsdf">aprchBSDF</code></td>
<td>
<p>'character' vector of length 1 that indicates the scheme used to generate daily values of the
daily fractional sunshine duration for a specific year. Valid values are as follows: <br />
(a) <code>'hip'</code> -
this scheme applies the mean-preserving 'harmonic' interpolation method of Epstein (1991) to the values of
monthly mean relative sunshine duration in order to generate daily values; <br />
(b) <code>'const'</code> -
this scheme is assumed that values of the daily relative sunshine duration are constant within each month.</p>
</td></tr>
<tr><td><code id="cliForestSteppePoints_+3A_dvtemp">dvTEMP</code></td>
<td>
<p>'numeric' vector of length 12 with monthly values of the damping variable for the air temperature
data.</p>
</td></tr>
<tr><td><code id="cliForestSteppePoints_+3A_verbose">verbose</code></td>
<td>
<p>'logical' scalar that indicates whether or not values of the bioclimatic indices used should be
added to the output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Here, three forest-steppe models with different theoretical backgrounds are implemented:
</p>

<ul>
<li><p><code>fsp_hlz</code>: A modified variant of the widely used Holdridge life zone (HLZ) system (see for the
basic concept Holdridge 1947, 1967; for a proposed variant Szelepcsényi et al. 2014).
</p>
</li>
<li><p><code>fsp_fai</code>: A clarified version of the forestry climate classification (see for the basic concept
Führer et al. 2011; for a proposed variant Mátyás et al. 2018)
</p>
</li>
<li><p><code>fsp_svm</code>: An initial version of the Siberian Vegetation Model (see Monserud et al. 1993)
</p>
</li></ul>

<p>The HLZ system classifies the vegetation type based on the distance from the ideal (theoretical) point in the
3-dimensional space of the following bioclimatic indices:
</p>

<ul>
<li><p><code>abt</code>: Mean Annual Biotemperature (Eq 1 in Szelepcsényi et al. (2014); in °C)
</p>
</li>
<li><p><code>tap</code>: Total Annual Precipitation (in mm)
</p>
</li>
<li><p><code>per</code>: Potential Evapotranspiration Ratio (Eq 4 in Szelepcsényi et al. (2014); dimensionless)
</p>
</li></ul>

<p>The plotting of thresholds of the above-mentioned bioclimatic indices in the HLZ chart leads to emerge a set
of hexagons and triangles. The hexagons indicate the so-called core HLZ types, while the so-called
transitional HLZ types are circumscribed by equilateral triangles in the HLZ chart (see Szelepcsényi et al.
2014). However, in contrast to this study, here, the transitional types are defined as separate zones
designated by the centres of the triangles. As a result, hexagons appear around the triangles in the HLZ
chart, and in parallel, the size of the hexagons denoting the core types also decreases. Thus, the size of the
core and transitional types are the same in this approach. During the classification, all forest-steppe types
designated by Szelepcsényi et al. (2014) (and redefined by us) are aggregated into one class. <br />
The forestry climate classification developed by Führer et al. (2011) was reworked by Mátyás et al. (2018). In
the context of assessing the effects of future climate change, the 'forest-steppe' climate class was
introduced in the model. In the work of Mátyás et al. (2018), this type is characterized by the Forestry
Aridity Index (<code>fai</code>, dimensionless) values between 7.25 and 8. This definition is used here. <br />
The Siberian Vegetation Model (Monserud et al. 1993) defines numerous types of forest-steppe on the basis of
values of the Growing Degree-Days above 5°C (<code>gdd5</code>, in °C day), the Budyko's Dryness Index
(<code>bdi</code>, dimensionless), and the Condrad's Continentality Index (<code>cci</code>, in per cent). Here, all
such ecotone types are aggregated into one class, in order to estimate the presence/absence of the
‘forest-steppe’ ecotone.
</p>


<h3>Value</h3>

<p>Depending on the setting, a data frame with three or more columns where the presence/absence data are
stored in the last three columns labelled <code>'fsp_hlz'</code>, <code>'fsp_fai'</code> and <code>'fsp_svm'</code>, while the
additional columns contain the values of bioclimatic indices used. If <code>verbose = FALSE</code>, the return
object is a two- or three-column data frame with the presence/absence data, depending on the available data.
</p>


<h3>Note</h3>

<p>As with any function with a point mode, a set of basic input data is defined here. In this case, they are as
follows: <code>'temp'</code> (one-year time series of monthly mean air temperature), <code>'prec'</code> (one-year time
series of monthly precipitation sum), and <code>'bsdf'</code> (one-year time series of monthly mean relative
sunshine duration). The objects <code>'temp'</code>, <code>'prec'</code> and <code>'bsdf'</code> must be either vectors of
length 12 or 12-column matrices. The first dimensions of these matrices have to be the same length. The
function automatically converts vectors into single-row matrices during the error handling, and then uses these
matrices. The first dimensions of these matrices determines the number of rows in the result matrix. In the
case of arguments that do not affect the course of the calculation procedure or the structure of the return
object, scalar values (i.e., 'numeric' vector of length 1) may also be allowed. In this case, they are as
follows: <code>'lat'</code> (latitude coordinates in decimal degrees), <code>'elv'</code> (elevation in meters above sea
level), and <code>'year'</code> (year using astronomical year numbering). These scalars are converted to vectors by
the function during the error handling, and these vectors are applied in the further calculations. If these
data are stored in vectors of length at least 2, their length must be the same size of first dimension of the
matrices containing the basic data.
</p>


<h3>References</h3>

<p><cite>Epstein ES (1991) On Obtaining Daily Climatological Values from Monthly Means. J Clim 4(3):365–368.
<a href="https://doi.org/10.1175/1520-0442%281991%29004%3C0365%3AOODCVF%3E2.0.CO%3B2">doi:10.1175/1520-0442(1991)004&lt;0365:OODCVF&gt;2.0.CO;2</a></cite>
</p>
<p><cite>Führer E, Horváth L, Jagodics A, Machon A, Szabados I (2011) Application of a new aridity index in Hungarian
forestry practice. Időjárás 115(3):205–216</cite>
</p>
<p><cite>Holdridge LR (1947) Determination of World Plant Formations From Simple Climatic Data. Science
105(2727):367–368. <a href="https://doi.org/10.1126/science.105.2727.367">doi:10.1126/science.105.2727.367</a></cite>
</p>
<p><cite>Holdridge LR (1967) Life zone ecology. Tropical Science Center, San Jose, Costa Rica</cite>
</p>
<p><cite>Lüdeke MKB, Badeck FW, Otto RD, Häger C, Dönges S, Kindermann J, Würth G, Lang T, Jäkel U, Klaudius A,
Ramge P, Habermehl S, Kohlmaier GH (1994) The Frankfurt Biosphere Model: A global process-oriented model of
seasonal and long-term CO2 exchange between terrestrial ecosystems and the atmosphere. I. Model description
and illustrative results for cold deciduous and boreal forests. Clim Res 4(2):143-166. <a href="https://doi.org/10.3354/cr004143">doi:10.3354/cr004143</a></cite>
</p>
<p><cite>Mátyás Cs, Berki I, Bidló A, Csóka Gy, Czimber K, Führer E, Gálos B, Gribovszki Z, Illés G, Hirka A, Somogyi
Z (2018) Sustainability of Forest Cover under Climate Change on the Temperate-Continental Xeric Limits.
Forests 9(8):489. <a href="https://doi.org/10.3390/f9080489">doi:10.3390/f9080489</a></cite>
</p>
<p><cite>Monserud RA, Denissenko OV, Tchebakova NM (1993) Comparison of Siberian paleovegetation to current and
future vegetation under climate change. Clim Res 3(3):143–159. <a href="https://doi.org/10.3354/cr003143">doi:10.3354/cr003143</a></cite>
</p>
<p><cite>Szelepcsényi Z, Breuer H, Sümegi P (2014) The climate of Carpathian Region in the 20th century based on the
original and modified Holdridge life zone system. Cent Eur J Geosci 6(3):293–307.
<a href="https://doi.org/10.2478/s13533-012-0189-5">doi:10.2478/s13533-012-0189-5</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Loading mandatory data for the Example 'Points'
data(inp_exPoints)

# Predict the 'forest-steppe' ecotone (using the related bioclimatic indices),
# with default settings, at a grid cell near Szeged, Hungary (46.3N, 20.2E)
# (for the normal period 1981-2010)
with(inp_exPoints, {
year &lt;- trunc(mean(seq(1981, 2010)))
fsp &lt;- cliForestSteppePoints(colMeans(temp), colMeans(prec), colMeans(bsdf), lat, elv,
    year = year, verbose = TRUE)
fsp
})

</code></pre>

<hr>
<h2 id='cliHoldridgeGrid'>Vegetation Classifier Using the HLZ System</h2><span id='topic+cliHoldridgeGrid'></span>

<h3>Description</h3>

<p>Calculates the values of bioclimatic indices used in the Holdridge life zone (HLZ) system
(Holdridge 1947, 1967), and designates the HLZ type using these values, for a given region, by using the
monthly time series of temperature and precipitation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cliHoldridgeGrid(rs.temp, rs.prec, verbose = FALSE, filename = "", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cliHoldridgeGrid_+3A_rs.temp">rs.temp</code></td>
<td>
<p>multi-layer Raster*/SpatRaster object with one-year time series of monthly mean air temperature
(in °C)</p>
</td></tr>
<tr><td><code id="cliHoldridgeGrid_+3A_rs.prec">rs.prec</code></td>
<td>
<p>multi-layer Raster*/SpatRaster object with one-year time series of monthly precipitation sum
(in mm)</p>
</td></tr>
<tr><td><code id="cliHoldridgeGrid_+3A_verbose">verbose</code></td>
<td>
<p>'logical' scalar that indicates whether or not values of the bioclimatic indices used should be
added to the output.</p>
</td></tr>
<tr><td><code id="cliHoldridgeGrid_+3A_filename">filename</code></td>
<td>
<p>output filename</p>
</td></tr>
<tr><td><code id="cliHoldridgeGrid_+3A_...">...</code></td>
<td>
<p>additional arguments passed on to <code><a href="terra.html#topic+writeRaster">writeRaster</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+cliHoldridgePoints">cliHoldridgePoints</a></code>.
</p>


<h3>Value</h3>

<p>Depending on the setting, a SpatRaster object with one or more layers where the numeric integers encoding
the HLZ type are stored at the last layer, while the additional layers contain the values of bioclimatic
indices used. The meaning of integers is given in the data frame <code><a href="#topic+vegClsNumCodes">vegClsNumCodes</a></code>. If
<code>verbose = FALSE</code>, the return object is a single-layer SpatRaster obejct with numeric integers encoding
the HLZ type.
</p>


<h3>Note</h3>

<p>The objects <code>'rs.temp'</code> and <code>'rs.prec'</code> must be 12-layer Raster*/SpatRaster objects. These
Raster*/SpatRaster objects must have the same bounding box, projection, and resolution.
</p>


<h3>References</h3>

<p><cite>Holdridge LR (1947) Determination of World Plant Formations From Simple Climatic Data. Science
105(2727):367–368. <a href="https://doi.org/10.1126/science.105.2727.367">doi:10.1126/science.105.2727.367</a></cite>
</p>
<p><cite>Holdridge LR (1967) Life zone ecology. Tropical Science Center, San Jose, Costa Rica</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Loading mandatory data for the Example 'Climate Normal Grid'
data(inp_exClnrGrid)

# Designate the HLZ types (using the related bioclimatic indices)
# for Csongrad-Csanad County (for the normal period 1981-2010)
with(inp_exClnrGrid, {
rs.HLZ &lt;- cliHoldridgeGrid(temp, prec, verbose = TRUE)
rs.HLZ
})

</code></pre>

<hr>
<h2 id='cliHoldridgePoints'>Vegetation Classifier Using the HLZ System</h2><span id='topic+cliHoldridgePoints'></span>

<h3>Description</h3>

<p>Calculates the values of bioclimatic indices used in the Holdridge life zone (HLZ) system (Holdridge
1947, 1967), and designates the HLZ type using these values, by using the monthly time series of temperature
and precipitation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cliHoldridgePoints(temp, prec, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cliHoldridgePoints_+3A_temp">temp</code></td>
<td>
<p>'numeric' R object with one-year time series of monthly mean air temperature (in °C)</p>
</td></tr>
<tr><td><code id="cliHoldridgePoints_+3A_prec">prec</code></td>
<td>
<p>'numeric' R object with one-year time series of monthly precipitation sum (in mm)</p>
</td></tr>
<tr><td><code id="cliHoldridgePoints_+3A_verbose">verbose</code></td>
<td>
<p>'logical' scalar that indicates whether or not values of the bioclimatic indices used should be
added to the output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To classify vegetation, the HLZ system developed by Holdridge (1947, 1967) uses the values of the
following 3 bioclimatic indices:
</p>

<ul>
<li><p><code>abt</code>: Mean Annual Biotemperature (Eq 1 in Szelepcsényi et al. (2014); in °C)
</p>
</li>
<li><p><code>tap</code>: Total Annual Precipitation (in mm)
</p>
</li>
<li><p><code>per</code>: Potential Evapotranspiration Ratio (Eq 4 in Szelepcsényi et al. (2014); dimensionless)
</p>
</li></ul>

<p>For details about calculating bioclimatic indices, see the function
<code><a href="#topic+cliBioCliIdxPoints">cliBioCliIdxPoints</a></code>. <br />
The HLZ system classifies the vegetation type based on the distance from the ideal (theoretical) point in the
3-dimensional space of bioclimatic indices. Numerous variants of the HLZ system are known (e.g.,
Henderson-Sellers 1994; Yates et al. 2000). Here, one of its most widely used versions ('version with no
altitudinal belts') is implemented, in accordance with works of Szelepcsényi et al. (2014, 2018). In this
version, a total of 39 HLZ types are distinguished (see <code><a href="#topic+vegClsNumCodes">vegClsNumCodes</a></code>).
</p>


<h3>Value</h3>

<p>Depending on the setting, a data frame with one or more columns where the HLZ types are stored in the last
(character) column, while the additional columns contain the values of bioclimatic indices used. The
abbreviations of HLZ types can be found in the data frame <code><a href="#topic+vegClsNumCodes">vegClsNumCodes</a></code>. If
<code>verbose = FALSE</code>, the return object is a one-column data frame with the HLZ types.
</p>


<h3>Note</h3>

<p>As with any function with a point mode, a set of basic input data is defined here. In this case, they are as
follows: <code>'temp'</code> (one-year time series of monthly mean air temperature), and <code>'prec'</code> (one-year
time series of monthly precipitation sum). The objects <code>'temp'</code> and <code>'pre'</code> must be either vectors
of length 12 or 12-column matrices. The first dimensions of these matrices have to be the same length. The
function automatically converts vectors into single-row matrices during the error handling, and then uses
these matrices. The first dimensions of these matrices determines the number of rows in the result matrix.
</p>


<h3>References</h3>

<p><cite>Henderson-Sellers A (1994) Global terrestrial vegetation ‘prediction’: the use and abuse of climate and
application models. Prog Phys Geogr 18(2):209–246. <a href="https://doi.org/10.1177/030913339401800203">doi:10.1177/030913339401800203</a></cite>
</p>
<p><cite>Holdridge LR (1947) Determination of World Plant Formations From Simple Climatic Data. Science
105(2727):367–368. <a href="https://doi.org/10.1126/science.105.2727.367">doi:10.1126/science.105.2727.367</a></cite>
</p>
<p><cite>Holdridge LR (1967) Life zone ecology. Tropical Science Center, San Jose, Costa Rica</cite>
</p>
<p><cite>Szelepcsényi Z, Breuer H, Sümegi P (2014) The climate of Carpathian Region in the 20th century based on the
original and modified Holdridge life zone system. Cent Eur J Geosci 6(3):293–307.
<a href="https://doi.org/10.2478/s13533-012-0189-5">doi:10.2478/s13533-012-0189-5</a></cite>
</p>
<p><cite>Szelepcsényi Z, Breuer H, Kis A, Pongrácz R, Sümegi P (2018) Assessment of projected climate change in the
Carpathian Region using the Holdridge life zone system. Theor Appl Climatol 131(1–2):593–610.
<a href="https://doi.org/10.1007/s00704-016-1987-3">doi:10.1007/s00704-016-1987-3</a></cite>
</p>
<p><cite>Yates DN, Kittel TGF, Cannon RF (2000) Comparing the Correlative Holdridge Model to Mechanistic
Biogeographical Models for Assessing Vegetation Distribution Response to Climatic Change. Clim Chang
44(1–2):59–87. <a href="https://doi.org/10.1023/A%3A1005495908758">doi:10.1023/A:1005495908758</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Loading mandatory data for the Example 'Points'
data(inp_exPoints)
data(vegClsNumCodes)

# Designate the HLZ type (using the related bioclimatic indices),
# at a grid cell near Szeged, Hungary (46.3N, 20.2E) (for the normal period 1981-2010)
with(inp_exPoints, {
HLZ &lt;- cliHoldridgePoints(colMeans(temp), colMeans(prec), verbose = TRUE)
numCode &lt;- which(sapply(vegClsNumCodes$Code.HLZ, identical, HLZ[, "vegCls"]))
cbind(HLZ[,-c(4)], vegClsNumCodes[numCode, c("Name.HLZ", "Code.HLZ")])
})

</code></pre>

<hr>
<h2 id='cliKoppenGrid'>Vegetation Classifier Using the KGC System</h2><span id='topic+cliKoppenGrid'></span>

<h3>Description</h3>

<p>Calculates the values of bioclimatic indices used in the Köppen-Geiger classification (KGC) system
(Köppen 1936), and designates the KGC type using these values, by using the monthly time series of temperature
and precipitation. The classification scheme is based on the procedure described by Köppen (1936) and follows
the modifications described by Peel et al. (2007).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cliKoppenGrid(rs.temp, rs.prec, verbose = FALSE, filename = "", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cliKoppenGrid_+3A_rs.temp">rs.temp</code></td>
<td>
<p>multi-layer Raster*/SpatRaster object with one-year time series of monthly mean air temperature
(in °C)</p>
</td></tr>
<tr><td><code id="cliKoppenGrid_+3A_rs.prec">rs.prec</code></td>
<td>
<p>multi-layer Raster*/SpatRaster object with one-year time series of monthly precipitation sum
(in mm)</p>
</td></tr>
<tr><td><code id="cliKoppenGrid_+3A_verbose">verbose</code></td>
<td>
<p>'logical' scalar that indicates whether or not values of the bioclimatic indices used should be
added to the output.</p>
</td></tr>
<tr><td><code id="cliKoppenGrid_+3A_filename">filename</code></td>
<td>
<p>output filename</p>
</td></tr>
<tr><td><code id="cliKoppenGrid_+3A_...">...</code></td>
<td>
<p>additional arguments passed on to <code><a href="terra.html#topic+writeRaster">writeRaster</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+cliKoppenPoints">cliKoppenPoints</a></code>.
</p>


<h3>Value</h3>

<p>Depending on the setting, a SpatRaster object with one or more layers where the numeric integers encoding
the KGC type are stored at the last layer, while the additional layers contain the values of bioclimatic
indices used. The meaning of integers is given in the data frame <code><a href="#topic+vegClsNumCodes">vegClsNumCodes</a></code>. If
<code>verbose = FALSE</code>, the return object is a single-layer SpatRaster object with numeric integers encoding
the KGC type.
</p>


<h3>Note</h3>

<p>The objects <code>'rs.temp'</code> and <code>'rs.prec'</code> must be 12-layer Raster*/SpatRaster objects. These
Raster*/SpatRaster objects must have the same bounding box, projection, and resolution.
</p>


<h3>References</h3>

<p><cite>Köppen W (1936) Das geographische System der Klimate. In: Köppen W, Geiger R (eds) Handbuch der
Klimatologie. Verlag von Gebrüder Borntraeger, Berlin, Germany, pp 1–44</cite>
</p>
<p><cite>Peel MC, Finlayson BL, McMahon TA (2007) Updated world map of the Köppen-Geiger climate classification.
Hydrol Earth Syst Sci 11(5):1633–1644. <a href="https://doi.org/10.5194/hess-11-1633-2007">doi:10.5194/hess-11-1633-2007</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Loading mandatory data for the Example 'Climate Normal Grid'
data(inp_exClnrGrid)

# Designate the KGC types (using the related bioclimatic indices)
# for Csongrad-Csanad County (for the normal period 1981-2010)
with(inp_exClnrGrid, {
rs.KGC &lt;- cliKoppenGrid(temp, prec, verbose = TRUE)
rs.KGC
})

</code></pre>

<hr>
<h2 id='cliKoppenPoints'>Vegetation Classifier Using the KGC System</h2><span id='topic+cliKoppenPoints'></span>

<h3>Description</h3>

<p>Calculates the values of bioclimatic indices used in the Köppen-Geiger classification (KGC) system
(Köppen 1936), and designates the KGC type using these values, by using the monthly time series of temperature
and precipitation. The classification scheme is based on the procedure described by Köppen (1936) and follows
the modifications described by Peel et al. (2007).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cliKoppenPoints(temp, prec, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cliKoppenPoints_+3A_temp">temp</code></td>
<td>
<p>'numeric' R object with one-year time series of monthly mean air temperature (in °C)</p>
</td></tr>
<tr><td><code id="cliKoppenPoints_+3A_prec">prec</code></td>
<td>
<p>'numeric' R object with one-year time series of monthly precipitation sum (in mm)</p>
</td></tr>
<tr><td><code id="cliKoppenPoints_+3A_verbose">verbose</code></td>
<td>
<p>'logical' scalar that indicates whether or not values of the bioclimatic indices used should be
added to the output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To classify vegetation, the KGC system developed by Köppen (1936) and fine-tuned by Peel. et al. (2007)
uses the values of the following 13 bioclimatic indices:
</p>

<ul>
<li><p><code>tap</code>: Total Annual Precipitation (in mm)
</p>
</li>
<li><p><code>mat</code>: Mean Annual Temperature (in °C)
</p>
</li>
<li><p><code>tw</code>: Mean Temperature of the Warmest Month (in °C)
</p>
</li>
<li><p><code>tc</code>: Mean Temperature of the Coldest Month (in °C)
</p>
</li>
<li><p><code>tm10</code>: Number of Months with Mean Temperature above 10°C (dimensionless)
</p>
</li>
<li><p><code>pdry</code>: Precipitation Sum of the Driest Month (in mm)
</p>
</li>
<li><p><code>psdry</code>: Precipitation Sum of the Driest Month in the Summer Half-Year (in mm)
</p>
</li>
<li><p><code>pwdry</code>: Precipitation Sum of the Driest Month in the Winter Half-Year (in mm)
</p>
</li>
<li><p><code>pswet</code>: Precipitation Sum of the Wettest Month in the Summer Half-Year (in mm)
</p>
</li>
<li><p><code>pwwet</code>: Precipitation Sum of the Wettest Month in the Winter Half-Year (in mm)
</p>
</li>
<li><p><code>ps</code>: Precipitation Sum of the Summer Half-Year (in mm)
</p>
</li>
<li><p><code>pw</code>: Precipitation Sum of the Winter Half-Year (in mm)
</p>
</li>
<li><p><code>pth</code>: Dryness Threshold (in mm)
</p>
</li></ul>

<p>For details about calculating bioclimatic indices, see the function
<code><a href="#topic+cliBioCliIdxPoints">cliBioCliIdxPoints</a></code>. Since <code>pth</code> is more of a technical measure, it is not
calculated by the function <code><a href="#topic+cliBioCliIdxPoints">cliBioCliIdxPoints</a></code>. The value of <code>pth</code> depends on
mean annual temperature and annual cycle of precipitation: <code>pth = 2 * mat</code> if &gt;70 percentage of
precipitation falls in winter half-year, (b) <code>pth = 2 * mat + 28</code> if &gt;70 percentage of precipitation
falls in summer half-year, and otherwise <code>pth = 2 * mat + 14</code>. For this index, the same definitions are
used for seasons as in the function <code><a href="#topic+cliBioCliIdxPoints">cliBioCliIdxPoints</a></code>, i.e., summer (winter)
half-year is defined as the warmer (cooler) six month period of AMJJAS (from April to September) and ONDJFM
(from October to March). <br />
Numerous variants of the Köppen classification system are known (e.g., Köppen-Geiger classification: Köppen
1936; Köppen-Trewartha classification: Trewartha and Horn 1980). Here, one of the most widely used versions of
the Köppen-Geiger classification system is implemented, in accordance with works of Peel et al. (2007) and
Beck et al. (2018). This classification system is the same as that presented by Köppen (1936) with three
differences. First, classes <code>'C'</code> (temperate) and <code>'D'</code> (cold) are distinguished using a 0°C
threshold instead of a -3°C threshold, following Russell (1931). Second, the sub-classes of the class
<code>'B'</code> (arid) are identified depending on whether 70 percentage of precipitation falls in the summer or
winter half-year. Third, the sub-classes <code>'s'</code> (dry summer) and <code>'w'</code> (dry winter) within the classes
<code>'C'</code> and <code>'D'</code> are made mutually exclusive by assigning <code>'s'</code> when more precipitation falls in
winter than in summer and assigning <code>'w'</code> otherwise. In this version, a total of 30 KGC types are
distinguished (see <code><a href="#topic+vegClsNumCodes">vegClsNumCodes</a></code>).
</p>


<h3>Value</h3>

<p>Depending on the setting, a data frame with one or more columns where the KGC types are stored in the
last (character) column, while the additional columns contain the values of bioclimatic indices used. The
abbreviations of KGC types can be found in the data frame <code><a href="#topic+vegClsNumCodes">vegClsNumCodes</a></code>. If
<code>verbose = FALSE</code>, the return object is a one-column data frame with the KGC types.
</p>


<h3>Note</h3>

<p>As with any function with a point mode, a set of basic input data is defined here. In this case, they are as
follows: <code>'temp'</code> (one-year time series of monthly mean air temperature), and <code>'prec'</code> (one-year
time series of monthly precipitation sum). The objects <code>'temp'</code> and <code>'pre'</code> must be either vectors
of length 12 or 12-column matrices. The first dimensions of these matrices have to be the same length. The
function automatically converts vectors into single-row matrices during the error handling, and then uses
these matrices. The first dimensions of these matrices determines the number of rows in the result matrix.
</p>


<h3>References</h3>

<p><cite>Beck HE, Zimmermann NE, McVicar TR, Vergopolan N, Berg A, Wood EF (2018) Present and future Köppen-Geiger
climate classification maps at 1-km resolution. Sci Data 5:180214. <a href="https://doi.org/10.1038/sdata.2018.214">doi:10.1038/sdata.2018.214</a></cite>
</p>
<p><cite>Köppen W (1936) Das geographische System der Klimate. In: Köppen W, Geiger R (eds) Handbuch der
Klimatologie. Verlag von Gebrüder Borntraeger, Berlin, Germany, pp 1–44</cite>
</p>
<p><cite>Peel MC, Finlayson BL, McMahon TA (2007) Updated world map of the Köppen-Geiger climate classification.
Hydrol Earth Syst Sci 11(5):1633–1644. <a href="https://doi.org/10.5194/hess-11-1633-2007">doi:10.5194/hess-11-1633-2007</a></cite>
</p>
<p><cite>Russell RJ (1931) Dry Climates of the United States: I. Climatic Map. University of California, Publications
in Geography 5:1–41</cite>
</p>
<p><cite>Trewartha GT, Horn LH (1980) An Introduction to Climate. Fifth Edition. McGraw-Hill, New York, NY</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Loading mandatory data for the Example 'Points'
data(inp_exPoints)
data(vegClsNumCodes)

# Designate the KGC type (using the related bioclimatic indices),
# at a grid cell near Szeged, Hungary (46.3N, 20.2E) (for the normal period 1981-2010)
with(inp_exPoints, {
KGC &lt;- cliKoppenPoints(colMeans(temp), colMeans(prec), verbose = TRUE)
numCode &lt;- which(sapply(vegClsNumCodes$Code.KGC, identical, KGC[, "vegCls"]))
cbind(KGC[,-c(14)], vegClsNumCodes[numCode, c("Name.KGC", "Code.KGC")])
})

</code></pre>

<hr>
<h2 id='dlyEngWtrFluxPoints'>Estimator for Daily Amounts of Energy and Water Fluxes</h2><span id='topic+dlyEngWtrFluxPoints'></span>

<h3>Description</h3>

<p>Estimates the daily amounts of energy and water fluxes and the associated monthly bioclimatic
variables, by using the SPLASH algorithm described by Davis et al. (2017). This version of the algorithm is
directly suitable for paleoclimate applications because it takes into account the time variability of the
Earth's orbital elements, and thus changes in the seasonal cycle of insolation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlyEngWtrFluxPoints(
  TEMP,
  PREC,
  BSDF,
  lat,
  elv,
  year = 2000,
  MSMC = 150,
  daily = TRUE,
  mlyOpVar = c("EET", "PET", "AET")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dlyEngWtrFluxPoints_+3A_temp">TEMP</code></td>
<td>
<p>'numeric' R object with one-year time series of daily mean air temperature (in °C)</p>
</td></tr>
<tr><td><code id="dlyEngWtrFluxPoints_+3A_prec">PREC</code></td>
<td>
<p>'numeric' R object with one-year time series of daily precipitation sum (in mm)</p>
</td></tr>
<tr><td><code id="dlyEngWtrFluxPoints_+3A_bsdf">BSDF</code></td>
<td>
<p>'numeric' R object with one-year time series of daily fractional sunshine duration (dimensionless)</p>
</td></tr>
<tr><td><code id="dlyEngWtrFluxPoints_+3A_lat">lat</code></td>
<td>
<p>'numeric' vector with the latitude coordinates (in decimal degrees)</p>
</td></tr>
<tr><td><code id="dlyEngWtrFluxPoints_+3A_elv">elv</code></td>
<td>
<p>'numeric' vector with the elevation values (in meters above sea level)</p>
</td></tr>
<tr><td><code id="dlyEngWtrFluxPoints_+3A_year">year</code></td>
<td>
<p>'numeric' vector with values of the year (using astronomical year numbering)</p>
</td></tr>
<tr><td><code id="dlyEngWtrFluxPoints_+3A_msmc">MSMC</code></td>
<td>
<p>'numeric' vector with values of the maximum soil moisture capacity (aka 'bucket size') (in mm)</p>
</td></tr>
<tr><td><code id="dlyEngWtrFluxPoints_+3A_daily">daily</code></td>
<td>
<p>'logical' scalar that indicates whether or not daily values should also be computed.</p>
</td></tr>
<tr><td><code id="dlyEngWtrFluxPoints_+3A_mlyopvar">mlyOpVar</code></td>
<td>
<p>'character' vector of at least one length that indicates the bioclimatic variable(s) for which
monthly time series are to be calculated. Valid values are as follows: <br />
(a) <code>'EET'</code> - monthly amounts of the equilibrium evapotranspiration (in mm); <br />
(b) <code>'PET'</code> - monthly amounts of the potential evapotranspiration (in mm); <br />
(c) <code>'AET'</code> - monthly amounts of the actual evapotranspiration (in mm); <br />
(d) <code>'PTC'</code> - monthly values of the Priestley–Taylor coefficient (dimensionless); <br />
(e) <code>'CWD'</code> - monthly values of the climatic water deficit (in mm).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To estimate the daily radiation, evapotranspiration and soil moisture for an equilibrium year, the SPLASH
algorithm described by Davis et al. (2017) is implemented with two slight amendments. In accordance with Davis
et al. (2017), daily insolation (incoming solar radiation at the top of the atmosphere) is estimated by using
Eq 1.10.3 in Duffie and Beckman (1991), with the remark that orbital parameters of the Earth are not assumed
to be constant. Temporal variability of orbital parameters is considered through the implementation of the
procedure as proposed by Berger and Loutre (1991). To simulate seasonal changes in the climatic water balance,
the simple 'bucket model' proposed by Cramer and Prentice (1988) is applied in accordance with the SPLASH
v.1.0 model. In this model, the daily value of actual evapotranspiration is estimated as an the analytical
integral of the minimum of the instantaneous evaporative supply and demand rates over a single day (see Eq 27
in Davis et  al. (2017)). The SPLASH algorithm is modified in a further aspect: in the 'bucket model', the
'bucket size' is freely changeable, i.e., it can be specified regionally. Its value is set to 150 mm by
default, in accordance with Cramer and Prentice (1988). <br />
The function provides daily estimates for the following key quantities: daily insolation
(<code>'H_0_J.m2.dy1'</code>), daily net surface radiation (<code>'H_np_J.m2.dy1'</code>, and <code>'H_nn_J.m2.dy1'</code>);
photosynthetic photon flux density (<code>'PPFD_mol.m2.dy1'</code>); daily condensation, soil moisture and runoff
(<code>'CN_mm.dy1'</code>, <code>'SM_mm.dy1'</code>, and <code>'RO_mm.dy1'</code>, respectively); and daily equilibrium,
potential, and actual evapotranspiration (<code>'EET_mm.dy1'</code>, <code>'PET_mm.dy1'</code>, and <code>'AET_mm.dy1'</code>).
It also integrates daily data for bioclimatic variables relevant to ecoclimatological studies at a monthly
timescale: monthly equilibrium, potential and actual evapotranspiration (<code>'EET_mo_mm.mo1'</code>,
<code>'PET _mo_mm.mo1'</code>, and <code>'AET_mo_mm.mo1'</code>), monthly Priestley–Taylor coefficient (<code>'PTC_mo'</code>),
monthly climatic water deficit (<code>'CWD_mo_mm.mo1'</code>).
</p>


<h3>Value</h3>

<p>If daily values are also requested (<code>daily = TRUE</code>), the function returns a list of lists with daily
and monthly data. If <code>daily = FALSE</code>, the return object is a list with the monthly values. The character
vector <code>'mlyOpVar'</code> determines for which variables are integrated at monthly scale (for explanations see
'Details'). Daily data is available for the following quantities:
</p>

<ul>
<li><p><code>H_0_J.m2.dy1</code>: daily solar irradiation (in J m-2)
</p>
</li>
<li><p><code>H_np_J.m2.dy1</code>: daily positive (daytime) net surface radiation (in J m-2)
</p>
</li>
<li><p><code>H_nn_J.m2.dy1</code>: daily negative (nighttime) net surface radiation (in J m-2)
</p>
</li>
<li><p><code>PPFD_mol.m2.dy1</code>: daily photosynthetically active radiation (in mol m-2)
</p>
</li>
<li><p><code>CN_mm.dy1</code>: daily condensation (in mm)
</p>
</li>
<li><p><code>SM_mm.dy1</code>: daily soil moisture (in mm)
</p>
</li>
<li><p><code>RO_mm.dy1</code>: daily runoff (in mm)
</p>
</li>
<li><p><code>EET_mm.dy1</code>: daily equilibrium evapotranspiration (in mm)
</p>
</li>
<li><p><code>PET_mm.dy1</code>: daily potential evapotranspiration (in mm)
</p>
</li>
<li><p><code>AET_mm.dy1</code>: daily actual evapotranspiration (in mm)
</p>
</li></ul>

<p>Each matrix in the list of daily data consists of 365 or 366 columns, while monthly data are available, of
course, as 12-column matrices. The former are accessible in the list <code>'dly'</code>, while the latter can be
found in the list labelled as <code>'mly'</code>.
</p>


<h3>Note</h3>

<p>As with any function with a point mode, a set of basic input data is defined here. In this case, they are as
follows: <code>'TEMP'</code> (one-year time series of daily mean air temperature), <code>'PREC'</code> (one-year time series
of daily precipitation sum), and <code>'BSDF'</code> (one-year time series of daily mean relative sunshine
duration). The objects <code>'TEMP'</code>, <code>'PREC'</code> and <code>'BSDF'</code> must be either vectors of length 365 (or
366) or 365-column (or 366-column) matrices. The first dimensions of these matrices have to be the same length.
The function automatically converts vectors into single-row matrices during the error handling, and then uses
these matrices. The first dimensions of these matrices determines the number of rows in the result matrices. In
the case of arguments that do not affect the course of the calculation procedure or the structure of the
return object, scalar values (i.e., 'numeric' vector of length 1) may also be allowed. In this case, they are as
follows: <code>'lat'</code> (latitude coordinates in decimal degrees), <code>'elv'</code> (elevation in meters above sea
level), <code>'year'</code> (year using astronomical year numbering), and <code>'MSMC'</code> ('bucket size' in mm). These
scalars are converted to vectors by the function during the error handling, and these vectors are applied in
the further calculations. If these data are stored in vectors of length at least 2, their length must be the
same size of first dimension of the matrices containing the basic data.
</p>


<h3>References</h3>

<p><cite>Berger A, Loutre MF (1991) Insolation values for the climate of the last 10 million years. Quat Sci Rev
10(4):297-317. <a href="https://doi.org/10.1016/0277-3791%2891%2990033-Q">doi:10.1016/0277-3791(91)90033-Q</a></cite>
</p>
<p><cite>Cramer W, Prentice IC (1988) Simulation of regional soil moisture deficits on a European scale. Nor J Geogr
42(2-3):149–151. <a href="https://doi.org/10.1080/00291958808552193">doi:10.1080/00291958808552193</a></cite>
</p>
<p><cite>Davis TW, Prentice IC, Stocker BD, Thomas RT, Whitley RJ, Wang H, Evans BJ, Gallego-Sala AV, Sykes MT,
Cramer W (2017) Simple process-led algorithms for simulating habitats (SPLASH v.1.0): robust indices of
radiation, evapotranspiration and plant-available moisture. Geosci Model Dev 10(2):689–708.
<a href="https://doi.org/10.5194/gmd-10-689-2017">doi:10.5194/gmd-10-689-2017</a></cite>
</p>
<p><cite>Duffie JA, Beckman WA (1991) Solar Engineering of Thermal Processes. Second Edition. Wiley-Interscience,
New York, NY</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(graphics)

# Loading mandatory data for the Example 'Points'
data(inp_exPoints)

with(inp_exPoints, {
# Estimates the daily amounts of energy and water fluxes with default settings,
# at a grid cell near Szeged, Hungary (46.3N, 20.2E) (for the normal period 1981-2010)
year &lt;- trunc(mean(seq(1981, 2010)))
wea &lt;- dlyWeaGenPoints(colMeans(temp), colMeans(prec), colMeans(bsdf), year = year)
ewf &lt;- dlyEngWtrFluxPoints(wea$TEMP, wea$PREC, wea$BSDF, lat, lon, elv, year = year)

# Check daily energy and water fluxes
opar &lt;- par(no.readonly = TRUE)
par(mfrow = c(4, 1))
var &lt;- list(t(ewf$dly$H_np_J.m2.dy1) * 1e-6, t(ewf$dly$SM_mm.dy1), t(wea$PREC))
lbl &lt;- list(expression(italic(H[N])~(MJ~m^{-2})), expression(italic(SM[n])~(mm)),
    expression(italic(P[n])~(mm)))
at &lt;- list(seq(0, 16, 4), seq(0, 80, 20), seq(0, 4))
txt &lt;- list("(a)", "(b)", "(c)")
for (i in 1 : length(var)) {
  par(mar = c(1, 5, 1, 1))
  plot(var[[i]], type = "l", lwd = 2, xlab = NA, ylab = NA, axes = FALSE)
  axis(side = 1, las = 1, tck = -0.03, labels = NA, at = seq(-60, 720, 30))
  axis(side = 2, las = 1, tck = -0.03, labels = NA, at = at[[i]])
  axis(side = 2, las = 1, lwd = 0, line = -0.4, cex.axis = 1.6, at = at[[i]])
  mtext(side = 2, lbl[[i]], line = 3, cex = 1.1)
  text(-12, max(at[[i]]) / 4, txt[[i]], pos = 4, cex = 1.7)
}
par(mar = c(2, 5, 1, 1))
plot(t(ewf$dly$PET_mm.dy1), type = "l", lwd = 2, xlab = NA, ylab = NA, axes = FALSE,
  ylim = c(0, max(t(ewf$dly$PET_mm.dy1))))
lines(t(ewf$dly$AET_mm.dy1), lty = 2, lwd = 2, col = "green")
axis(side = 1, las = 1, tck = -0.03, labels = NA, at = seq(-60, 720, 30))
axis(side = 1, las = 1, lwd = 0, line = -0.4, at = seq(-60, 720, 30), cex.axis = 1.6)
axis(side = 2, las = 1, tck = -0.03, labels = NA, at = seq(-1, 6, 1))
axis(side = 2, las = 1, lwd = 0, line = -0.4, cex.axis = 1.6, at = seq(-1, 6, 1))
legend("topright", legend = c(expression(italic(E[n]^{q})), expression(italic(E[n]^{a}))),
    col = c("black", "green"), lty = c(1, 2), cex = 1.6, inset = 0.02,
    adj = c(0.5, 0.5), lwd = c(2, 2), horiz = TRUE, bty = "n", seg.len = 1)
mtext(side = 2, expression(italic(E[n])~(mm)), line = 3, cex = 1.1)
text(-12, 1.5, "(d)", pos = 4, cex = 1.7)
par(opar)

# Check monthly water balance quantities
plot(t(ewf$mly$PET_mo_mm.mo1), type = "l", lwd = 2, ylim = c(0, 1.1 * max(ewf$mly$PET_mo_mm.mo1)),
    xlab = NA, ylab = NA, axes = FALSE)
lines(t(ewf$mly$EET_mo_mm.mo1), lty = 1, lwd = 2, col = "green")
lines(t(ewf$mly$AET_mo_mm.mo1), lty = 2, lwd = 2, col = "blue")
box(lwd = 2)
axis(side = 1, las = 1, tck = -0.02, labels = NA, at = seq(1, 12))
axis(side = 1, las = 1, lwd = 0, line = -0.4, labels = month.abb, at = seq(1, 12), cex.axis = 1.2)
axis(side = 2, las = 1, tck = -0.02, labels = NA, at = seq(-20, 200, 20))
axis(side = 2, las = 1, lwd = 0, line = -0.4, at = seq(-20, 200, 20), cex.axis = 1.2)
mtext(side = 2, expression(list(Evapotranspiration, mm~month^{-1})), line = 2, cex = 1.2)
legend("top", legend = c("Potential", "Equilibrium", "Actual"), col = c("black", "green", "blue"),
    lty = c(1, 1, 2), lwd = c(2, 2, 2), inset = 0.01, x.intersp = 1.1, y.intersp = 2.0,
    horiz = TRUE, bty = "n", cex = 1.2)
})


</code></pre>

<hr>
<h2 id='dlyWeaGenPoints'>Daily Weather Generator</h2><span id='topic+dlyWeaGenPoints'></span>

<h3>Description</h3>

<p>Generates quasi-daily time series from the monthly mean values of temperature, precipitation and
sunshine data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlyWeaGenPoints(
  temp,
  prec,
  bsdf,
  year = 2000,
  aprchTEMP = c("hip", "tsi", "const"),
  aprchPREC = c("tsi", "hip", "const"),
  aprchBSDF = c("hip", "const"),
  dvTEMP = rep(0.7, 12),
  dvPREC = rep(0.7, 12),
  argCkd = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dlyWeaGenPoints_+3A_temp">temp</code></td>
<td>
<p>'numeric' R object with one-year time series of monthly mean air temperature (in °C)</p>
</td></tr>
<tr><td><code id="dlyWeaGenPoints_+3A_prec">prec</code></td>
<td>
<p>'numeric' R object with one-year time series of monthly precipitation sum (in mm)</p>
</td></tr>
<tr><td><code id="dlyWeaGenPoints_+3A_bsdf">bsdf</code></td>
<td>
<p>'numeric' R object with one-year time series of monthly mean relative sunshine duration (dimensionless)</p>
</td></tr>
<tr><td><code id="dlyWeaGenPoints_+3A_year">year</code></td>
<td>
<p>'numeric' vector with values of the year (using astronomical year numbering)</p>
</td></tr>
<tr><td><code id="dlyWeaGenPoints_+3A_aprchtemp">aprchTEMP</code></td>
<td>
<p>'character' vector of length 1 that indicates the scheme used to generate daily values of the
daily mean air temperature for a specific year. Valid values are as follows: <br />
(a) <code>'hip'</code> -
this scheme applies the mean-preserving 'harmonic' interpolation method of Epstein (1991) to the values of
monthly mean air temperature in order to generate daily values; <br />
(b) <code>'tsi'</code> -
this scheme uses an iterative interpolation technique (Lüdeke et al. 1994) to time series of the monthly mean
air temperature, in order to generate a synthetic time series of the selected meteorological variable at a
temporal resolution that is higher than the daily scale; finally, this synthetic time series is upscaled to a
daily resolution; <br />
(c) <code>'const'</code> -
this scheme is assumed that values of the daily mean air temperature are constant within each month.</p>
</td></tr>
<tr><td><code id="dlyWeaGenPoints_+3A_aprchprec">aprchPREC</code></td>
<td>
<p>'character' vector of length 1 that indicates the scheme to generate daily values of the
daily precipitation sum. Valid values are as follows: <br />
(a) <code>'tsi'</code> -
this scheme uses an iterative interpolation technique (Lüdeke et al. 1994) to time series of the monthly mean
precipitation intensity, in order to generate a synthetic time series of the selected meteorological variable
at a temporal resolution that is higher than the daily scale; finally, this synthetic time series is upscaled
to a daily resolution; <br />
(b) <code>'hip'</code> -
this scheme applies the mean-preserving 'harmonic' interpolation method of Epstein (1991) to the values of
monthly mean precipitation intensity in order to generate daily values; <br />
(c) <code>'const'</code> -
this scheme is assumed that values of the daily precipitation sum are constant within each month (the monthly
precipitation sum is divided equally across each day of the month).</p>
</td></tr>
<tr><td><code id="dlyWeaGenPoints_+3A_aprchbsdf">aprchBSDF</code></td>
<td>
<p>'character' vector of length 1 that indicates the scheme used to generate daily values of the
daily fractional sunshine duration for a specific year. Valid values are as follows: <br />
(a) <code>'hip'</code> -
this scheme applies the mean-preserving 'harmonic' interpolation method of Epstein (1991) to the values of
monthly mean relative sunshine duration in order to generate daily values; <br />
(b) <code>'const'</code> -
this scheme is assumed that values of the daily relative sunshine duration are constant within each month.</p>
</td></tr>
<tr><td><code id="dlyWeaGenPoints_+3A_dvtemp">dvTEMP</code></td>
<td>
<p>'numeric' vector of length 12 with monthly values of the damping variable for the air temperature
data.</p>
</td></tr>
<tr><td><code id="dlyWeaGenPoints_+3A_dvprec">dvPREC</code></td>
<td>
<p>'numeric' vector of length 12 with monthly values of the damping variable for the precipitation data.</p>
</td></tr>
<tr><td><code id="dlyWeaGenPoints_+3A_argckd">argCkd</code></td>
<td>
<p>'logical' scalar that indicates whether or not the checking and correction of arguments can be
omitted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For relative sunshine duration and air temperature, it is recommended the 'harmonic' interpolation
technique (<code>'hip'</code>) described by Epstein (1991), with a correction of physically impossible values. This
technique can also be used to values of the mean precipitation intensity, however, in the case of
precipitation, the temporal scaling (<code>'tsi'</code>) using an iterative interpolation technique described by
Lüdeke et al. (1994) is recommended, with a damping variable of 0.7 for each month. The damping variable can
be set separately for each month and must be between 0 and 1. This iterative scheme can also be applied to
monthly mean data of air temperature. Furthermore, for all three climate variables, it is possible to ignore
intra-month variability. For this, the setting <code>'const'</code> must be used.
</p>


<h3>Value</h3>

<p>A list with three 365- or 366-column matrices that contain quasi-daily time series for the three basic
climate variables:
</p>

<ul>
<li><p><code>TEMP</code>: daily mean air temperature (in °C)
</p>
</li>
<li><p><code>PREC</code>: daily precipitation sum (in mm)
</p>
</li>
<li><p><code>BSDF</code>: daily fractional sunshine duration (dimensionless)
</p>
</li></ul>



<h3>Note</h3>

<p>As with any point function, a set of basic input data is defined here. In this case, they are as follows:
<code>'temp'</code> (one-year time series of monthly mean air temperature), <code>'prec'</code> (one-year time series
of monthly precipitation sum), and <code>'bsdf'</code> (one-year time series of monthly mean relative sunshine
duration.) The objects <code>'temp'</code>, <code>'prec'</code> and <code>'bsdf'</code> must be either vectors of length 12 or
12-column matrices. The first dimensions of these matrices have to be the same length. The function
automatically converts vectors into single-row matrices during the error handling, and then uses these
matrices. The first dimensions of these matrices determines the number of rows in the result matrix. In the
case of arguments that do not affect the course of the calculation procedure or the structure of the return
object, scalar values (i.e., 'numeric' vector of length 1) may also be allowed. In this case, it is as
follow: <code>'year'</code> (year using astronomical year numbering). This scalar is converted to a vector by the
function during the error handling, and this vector is applied in the further calculations. If these data are
stored in vectors of length at least 2, their length must be the same size of first dimension of the matrices
containing the basic data.
</p>


<h3>References</h3>

<p><cite>Epstein ES (1991) On Obtaining Daily Climatological Values from Monthly Means. J Clim 4(3):365–368.
<a href="https://doi.org/10.1175/1520-0442%281991%29004%3C0365%3AOODCVF%3E2.0.CO%3B2">doi:10.1175/1520-0442(1991)004&lt;0365:OODCVF&gt;2.0.CO;2</a></cite>
</p>
<p><cite>Lüdeke MKB, Badeck FW, Otto RD, Häger C, Dönges S, Kindermann J, Würth G, Lang T, Jäkel U, Klaudius A,
Ramge P, Habermehl S, Kohlmaier GH (1994) The Frankfurt Biosphere Model: A global process-oriented model of
seasonal and long-term CO2 exchange between terrestrial ecosystems and the atmosphere. I. Model description
and illustrative results for cold deciduous and boreal forests. Clim Res 4(2):143-166. <a href="https://doi.org/10.3354/cr004143">doi:10.3354/cr004143</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(graphics)

# Loading mandatory data for the Example 'Points'
data(inp_exPoints)

with(inp_exPoints, {
# Generate quasi-daily time series for basic climate variables with default settings,
# at a grid cell near Szeged, Hungary (46.3N, 20.2E) (for the normal period 1981-2010)
year &lt;- trunc(mean(seq(1981, 2010)))
wea01 &lt;- dlyWeaGenPoints(colMeans(temp), colMeans(prec), colMeans(bsdf), year = year)

# Modify the daily weather data generation techniques
# To temperature data, apply the iterative interpolation technique with basic settings
# To precipitation data, change the value of the damping variable, over the whole year
# To sunshine data, assume that its values are constant within each month
wea02 &lt;- dlyWeaGenPoints(colMeans(temp), colMeans(prec), colMeans(bsdf), aprchTEMP = "tsi",
    aprchBSDF = "const", dvPREC = rep(0.6, 12), year = year)

# Check the differences
vars &lt;- c("TEMP", "PREC", "BSDF")
lbls &lt;- list(expression(italic(T[a])~(~degree*C)), expression(italic(P[n])~(mm)),
    expression(italic(S[f])~(unitless)))
ys &lt;- c(20, 2.5, 0.6)
ats &lt;- list(seq(-4, 24, 4), seq(0, 3, 0.5), seq(0., 0.8, 0.2))
cols &lt;- c("black", "green")
opar &lt;- par(no.readonly = TRUE)
par(mfrow = c(3, 1))
for (i in 1 : length(vars)) {
  par(mar = c(2, 5, 1, 1))
  matplot(t(rbind(wea01[[vars[i]]], wea02[[vars[i]]])), type = "l", lwd = 2, col = cols,
      xaxt = "n", xlab = NA, ylab = NA, axes = FALSE)
  axis(side = 1, las = 1, tck = -0.03, labels = NA, at = seq(-60, 720, 30))
  axis(side = 2, las = 1, tck = -0.03, labels = NA, at = ats[[i]])
  axis(side = 2, las = 1, lwd = 0, line = -0.4, cex.axis = 1.6, at = ats[[i]])
  if (i == length(vars)) {
    axis(side = 1, las = 1, lwd = 0, line = -0.4, at = seq(-60, 720, 30), cex.axis = 1.6)
  }
  mtext(side = 2, lbls[[i]], line = 3, cex = 1.1)
  legend(1, ys[i], legend = c("default", "modified"), col = cols, lty = 1 : 2, lwd = 2, xpd = TRUE)
}
par(opar)
})

</code></pre>

<hr>
<h2 id='inp_exClnrGrid'>Mandatory Data for the Example 'Climate Normal Grid'</h2><span id='topic+inp_exClnrGrid'></span>

<h3>Description</h3>

<p>Data needed to demonstrate the working of functions with a grid mode. Average monthly time series of
three measured basic climate variables for the normal period 1981-2010 retrieved from the the CarpatClim
database (Spinoni et al. 2015), for Csongrád-Csanád County; supplemented with a digital elevation model.
Monthly mean relative sunshine duration has been obtained as a ratio of monthly total of sunshine duration and
maximum potential number of sunshine hours under clear-sky conditions. Daylength (accumulated hours of
daylight) was calculated via Eq 1.6.11 in Duffie and Beckman (1991), according to the SPLASH radiation model
(see <code><a href="#topic+cliAvgDlySolIrrPoints">cliAvgDlySolIrrPoints</a></code>). For all grids, the WGS84 (EPSG:4326) coordinate system was used
with a horizontal resolution of 0.1°.
</p>


<h3>Format</h3>

<p>A list with three RasterBricks and one RasterLayer.
</p>
<p>Each of the RasterBricks contains a one-year average monthly time series for the normal period 1981-2010,
for the following climate variables:
</p>

<ul>
<li><p><code>temp</code>: mean air temperature (in °C)
</p>
</li>
<li><p><code>prec</code>: precipitation sum (in mm)
</p>
</li>
<li><p><code>bsdf</code>: mean relative sunshine duration (dimensionless)
</p>
</li></ul>

<p>Elevation data can be extracted from a single RasterLayer: <code>elv</code>.
</p>


<h3>References</h3>

<p><em>Duffie JA, Beckman WA (1991) Solar Engineering of Thermal Processes. Second Edition. Wiley-Interscience,
New York, NY</em>
</p>
<p><em>Spinoni J, Szalai S, Szentimrey T, Lakatos M, Bihari Z, Nagy A, Németh Á, Kovács T, Mihic D,
Dacic M, Petrovic P, Kržič A, Hiebl J, Auer I, Milkovic J, Štepánek P, Zahradnícek P, Kilar P, Limanowka D,
Pyrc R, Cheval S, Birsan M-V, Dumitrescu A, Deak G, Matei M, Antolovic I, Nejedlík P, Štastný P, Kajaba P,
Bochnícek O, Galo D,  Mikulová K, Nabyvanets Y, Skrynyk O, Krakovska S, Gnatiuk N, Tolasz R, Antofie T, Vogt J
(2015) Climate  of  the  Carpathian  Region  in  the  period  1961–2010:  climatologies  and  trends  of  10
variables. Int J Climatol 35(7):1322-1341. <a href="https://doi.org/10.1002/joc.4059">doi:10.1002/joc.4059</a></em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(inp_exClnrGrid)
str(inp_exClnrGrid)

</code></pre>

<hr>
<h2 id='inp_exPoints'>Mandatory Data for the Example 'Points'</h2><span id='topic+inp_exPoints'></span>

<h3>Description</h3>

<p>Data needed to demonstrate the working of functions with a point mode. Measured monthly time series
of three basic climate variables retrieved from the CarpatClim database (Spinoni et al. 2015), at a grid cell
near Szeged, Hungary (46.3° N, 20.2° E), for the period 1981-2010; supplemented with the associated
geographical data. Monthly mean relative sunshine duration has been obtained as a ratio of monthly total of
sunshine duration and maximum potential number of sunshine hours under clear-sky conditions. Daylength
(accumulated hours of daylight) was calculated via Eq 1.6.11 in Duffie and Beckman (1991), according to the
SPLASH radiation algorithm (see <code><a href="#topic+cliAvgDlySolIrrPoints">cliAvgDlySolIrrPoints</a></code>).
</p>


<h3>Format</h3>

<p>A list with three data frames and three numeric scalars.
</p>
<p>Data frames contain one-year monthly time series for the period 1981-2010, for the following climate variables:
</p>

<ul>
<li><p><code>temp</code>: mean air temperature (in °C)
</p>
</li>
<li><p><code>prec</code>: precipitation sum (in mm)
</p>
</li>
<li><p><code>bsdf</code>: mean relative sunshine duration (dimensionless)
</p>
</li></ul>

<p>The following geographical parameters can be extracted from the numeric scalars:
</p>

<ul>
<li><p><code>lat</code>: latitude coordinate (in decimal degrees)
</p>
</li>
<li><p><code>lon</code>: longitude coordinate (in decimal degrees)
</p>
</li>
<li><p><code>elv</code>: elevation (in meters above sea level)
</p>
</li></ul>



<h3>References</h3>

<p><em>Duffie JA, Beckman WA (1991) Solar Engineering of Thermal Processes. Second Edition. Wiley-Interscience,
New York, NY</em>
</p>
<p><em>Spinoni J, Szalai S, Szentimrey T, Lakatos M, Bihari Z, Nagy A, Németh Á, Kovács T, Mihic D,
Dacic M, Petrovic P, Kržič A, Hiebl J, Auer I, Milkovic J, Štepánek P, Zahradnícek P, Kilar P, Limanowka D,
Pyrc R, Cheval S, Birsan M-V, Dumitrescu A, Deak G, Matei M, Antolovic I, Nejedlík P, Štastný P, Kajaba P,
Bochnícek O, Galo D,  Mikulová K, Nabyvanets Y, Skrynyk O, Krakovska S, Gnatiuk N, Tolasz R, Antofie T, Vogt J
(2015) Climate  of  the  Carpathian  Region  in  the  period  1961–2010:  climatologies  and  trends  of  10
variables. Int J Climatol 35(7):1322-1341. <a href="https://doi.org/10.1002/joc.4059">doi:10.1002/joc.4059</a></em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(inp_exPoints)
str(inp_exPoints)

</code></pre>

<hr>
<h2 id='inp_exSglyGrid'>Mandatory Data for the Example 'Single-Year Grid'</h2><span id='topic+inp_exSglyGrid'></span>

<h3>Description</h3>

<p>Data needed to demonstrate the working of functions with a grid mode. Measured monthly time series of
the year 2010 for three basic climate variables retrieved from the the CarpatClim database
(Spinoni et al. 2015), for Csongrád-Csanád County; supplemented with a digital elevation model. Monthly mean
relative sunshine duration has been obtained as a ratio of monthly total of sunshine duration and maximum
potential number of sunshine hours under clear-sky conditions. Daylength (accumulated hours of daylight) was
calculated via Eq 1.6.11 in Duffie and Beckman (1991), according to the SPLASH radiation model
(see <code><a href="#topic+cliAvgDlySolIrrPoints">cliAvgDlySolIrrPoints</a></code>). For all grids, the WGS84 (EPSG:4326) coordinate system was used
with a horizontal resolution of 0.1°.
</p>


<h3>Format</h3>

<p>A list with three RasterBricks and one RasterLayer.
</p>
<p>Each of the RasterBricks contains a one-year monthly time series for the year 2010,
for the following climate variables:
</p>

<ul>
<li><p><code>temp</code>: mean air temperature (in °C)
</p>
</li>
<li><p><code>prec</code>: precipitation sum (in mm)
</p>
</li>
<li><p><code>bsdf</code>: mean relative sunshine duration (dimensionless)
</p>
</li></ul>

<p>Elevation data can be extracted from a single RasterLayer: <code>elv</code>.
</p>


<h3>References</h3>

<p><em>Duffie JA, Beckman WA (1991) Solar Engineering of Thermal Processes. Second Edition. Wiley-Interscience,
New York, NY</em>
</p>
<p><em>Spinoni J, Szalai S, Szentimrey T, Lakatos M, Bihari Z, Nagy A, Németh Á, Kovács T, Mihic D,
Dacic M, Petrovic P, Kržič A, Hiebl J, Auer I, Milkovic J, Štepánek P, Zahradnícek P, Kilar P, Limanowka D,
Pyrc R, Cheval S, Birsan M-V, Dumitrescu A, Deak G, Matei M, Antolovic I, Nejedlík P, Štastný P, Kajaba P,
Bochnícek O, Galo D,  Mikulová K, Nabyvanets Y, Skrynyk O, Krakovska S, Gnatiuk N, Tolasz R, Antofie T, Vogt J
(2015) Climate  of  the  Carpathian  Region  in  the  period  1961–2010:  climatologies  and  trends  of  10
variables. Int J Climatol 35(7):1322-1341. <a href="https://doi.org/10.1002/joc.4059">doi:10.1002/joc.4059</a></em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(inp_exSglyGrid)
str(inp_exSglyGrid)

</code></pre>

<hr>
<h2 id='vegClsNumCodes'>Supplemental Data Frame for Decoding Outputs of Vegetation Classifiers</h2><span id='topic+vegClsNumCodes'></span>

<h3>Description</h3>

<p>The key to the classes used by climate-based vegetation classifiers implemented here. Currently, three
bioclimatic vegetation classification approaches are implemented:
</p>

<ul>
<li><p><code>HLZ</code>: a version with no altitudinal belts of the Holdridge life zone (HLZ) system (Holdridge
1947, 1967), in accordance with works of Szelepcsényi et al. (2014, 2018)
</p>
</li>
<li><p><code>KGC</code>: the Köppen-Geiger classification (KGC) system (Köppen 1936) with some modifications
suggested by Peel et al. (2007)
</p>
</li>
<li><p><code>BIOME</code>: the initial version of the BIOME model developed by Prentice et al. (1992)
</p>
</li></ul>



<h3>Format</h3>

<p>A data frame that allows for interpreting the return objects provided by climate-based vegetation
classifiers implemented here. Two columns belong to each vegetation classification approach. Columns whose
names begin with the string <code>'Name.'</code> contain the full names of the vegetation classes. While columns
whose names begin with the string <code>'Code.'</code> summarize the abbreviations used by functions with a point
mode. Row numbers of the data frame have a special role because they are the same as the numbers returned by
the functions with a grid mode.
</p>


<h3>References</h3>

<p><em>Holdridge LR (1947) Determination of World Plant Formations From Simple Climatic Data. Science
105(2727):367–368. <a href="https://doi.org/10.1126/science.105.2727.367">doi:10.1126/science.105.2727.367</a></em>
</p>
<p><em>Holdridge LR (1967) Life zone ecology. Tropical Science Center, San Jose, Costa Rica</em>
</p>
<p><cite>Köppen W (1936) Das geographische System der Klimate. In: Köppen W, Geiger R (eds) Handbuch der
Klimatologie. Verlag von Gebrüder Borntraeger, Berlin, Germany, pp 1–44</cite>
</p>
<p><cite>Peel MC, Finlayson BL, McMahon TA (2007) Updated world map of the Köppen-Geiger climate classification.
Hydrol Earth Syst Sci 11(5):1633–1644. <a href="https://doi.org/10.5194/hess-11-1633-2007">doi:10.5194/hess-11-1633-2007</a></cite>
</p>
<p><em>Prentice IC, Cramer W, Harrison SP, Leemans R, Monserud RA, Solomon AM (1992) A global biome model based on
plant physiology and dominance, soil properties and climate. J Biogeogr 19(2):117–134. <a href="https://doi.org/10.2307/2845499">doi:10.2307/2845499</a></em>
</p>
<p><em>Szelepcsényi Z, Breuer H, Sümegi P (2014) The climate of Carpathian Region in the 20th century based on the
original and modified Holdridge life zone system. Cent Eur J Geosci 6(3):293–307.
<a href="https://doi.org/10.2478/s13533-012-0189-5">doi:10.2478/s13533-012-0189-5</a></em>
</p>
<p><em>Szelepcsényi Z, Breuer H, Kis A, Pongrácz R, Sümegi P (2018) Assessment of projected climate change in the
Carpathian Region using the Holdridge life zone system. Theor Appl Climatol 131(1–2):593–610.
<a href="https://doi.org/10.1007/s00704-016-1987-3">doi:10.1007/s00704-016-1987-3</a></em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(vegClsNumCodes)
str(vegClsNumCodes)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
