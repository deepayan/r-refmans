<!DOCTYPE html><html><head><title>Help for package SurrogateTest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SurrogateTest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#censor.weight'>

<p>Calculates censoring probability for weighting</p></a></li>
<li><a href='#cumsum2'>

<p>Helper function</p>
</p></a></li>
<li><a href='#dataA'>
<p>Hypothetical Study A data</p></a></li>
<li><a href='#dataB'>
<p>Hypothetical Study B data</p></a></li>
<li><a href='#delta.ea.single'>

<p>Calculates the early treatment effect estimate in Study A</p>
</p></a></li>
<li><a href='#delta.eb.single'>
<p>Calculates the early treatment effect estimate in Study B</p></a></li>
<li><a href='#delta.estimate'>

<p>Calculates the treatment effect, the difference in survival at time t</p></a></li>
<li><a href='#design.study'>
<p>Power and sample size calculation for designing a future study</p></a></li>
<li><a href='#early.delta.test'>
<p>Estimate and test the early treatment effect</p></a></li>
<li><a href='#helper.si'>

<p>Helper function</p></a></li>
<li><a href='#int.hazc'>

<p>Helper function</p></a></li>
<li><a href='#int.hazc.plan'>

<p>Helper function</p></a></li>
<li><a href='#Kern.FUN'>

<p>Calculates kernel matrix</p></a></li>
<li><a href='#pred.smooth.surv.new'>

<p>Calculates the conditional probability of survival to time t</p>
</p></a></li>
<li><a href='#recover.B'>
<p>Recover an estimate of the treatment effect at time t in Study B</p></a></li>
<li><a href='#var.delta.eb'>
<p>Variance estimation</p></a></li>
<li><a href='#VTM'>

<p>Repeats a row.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Early Testing for a Treatment Effect using Surrogate Marker
Information</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-11-15</td>
</tr>
<tr>
<td>Author:</td>
<td>Layla Parast</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Layla Parast &lt;parast@austin.utexas.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to test for a treatment effect in terms of the difference in survival between a treatment group and a control group using surrogate marker information obtained at some early time point in a time-to-event outcome setting. Nonparametric kernel estimation is used to estimate the test statistic and perturbation resampling is used for variance estimation. More details will be available in the future in: Parast L, Cai T, Tian L (2019) &ldquo;Using a Surrogate Marker for Early Testing of a Treatment Effect" Biometrics, 75(4):1253-1263. &lt;<a href="https://doi.org/10.1111%2Fbiom.13067">doi:10.1111/biom.13067</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, survival</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-11-15 12:37:35 UTC; parast</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-11-16 08:00:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='censor.weight'>

Calculates censoring probability for weighting
</h2><span id='topic+censor.weight'></span>

<h3>Description</h3>


<p>Helper function; calculates censoring probability needed for inverse probability of censoring weighting
</p>


<h3>Usage</h3>

<pre><code class='language-R'>censor.weight(data.x, data.delta, t, weight = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="censor.weight_+3A_data.x">data.x</code></td>
<td>


<p>numeric vector, the observed event time: X = min(T, C) where T is the time of the primary outcome, C is the censoring time.
</p>
</td></tr>
<tr><td><code id="censor.weight_+3A_data.delta">data.delta</code></td>
<td>


<p>numeric vector of 0/1, the censoring indicator: D = I(T&lt;C) where T is the time of the primary outcome, C is the censoring time.
</p>
</td></tr>
<tr><td><code id="censor.weight_+3A_t">t</code></td>
<td>


<p>number, the time of interest.
</p>
</td></tr>
<tr><td><code id="censor.weight_+3A_weight">weight</code></td>
<td>


<p>a numeric vector or matrix of weights used for perturbation-resampling, default is null.
</p>
</td></tr>
</table>


<h3>Details</h3>


<p>Computes the Kaplan Meier estimate of survival for the censoring random variable at the specified time
</p>


<h3>Value</h3>






<p>Kaplan Meier estimate of survival for censoring at time t
</p>


<h3>Author(s)</h3>


<p>Layla Parast
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dataA)
censor.weight(data.x = dataA$x1, data.delta = dataA$delta1, t=0.5)

</code></pre>

<hr>
<h2 id='cumsum2'>

Helper function
</h2><span id='topic+cumsum2'></span>

<h3>Description</h3>


<p>Helper function; should not be called directly by user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cumsum2(mydat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cumsum2_+3A_mydat">mydat</code></td>
<td>
<p> mydat

</p>
</td></tr>
</table>


<h3>Value</h3>






<table>
<tr><td><code>out</code></td>
<td>
<p>matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>


<p>Layla Parast
</p>

<hr>
<h2 id='dataA'>
Hypothetical Study A data
</h2><span id='topic+dataA'></span>

<h3>Description</h3>

<p>Hypothetical Study A data to be used in examples; t=1 and the landmark time = 0.50.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dataA)</code></pre>


<h3>Format</h3>

<p>A list with 6 elements representing 1000 observations from a control group and 1000 observations from a treatment group:
</p>

<dl>
<dt><code>s1</code></dt><dd><p>Surrogate marker measurement for treated observations; this marker is measured at time = 0.5. For observations that experience the primary outcome or are censored before 0.5, this value is NA.</p>
</dd>
<dt><code>x1</code></dt><dd><p>The observed event or censoring time for treated observations; X  = min(T, C) where T is the time of the primary outcome and C is the censoring time.</p>
</dd>
<dt><code>delta1</code></dt><dd><p>The indicator identifying whether the treated observation was observed to have the event or was censored; D =1*(T&lt;C) where T is the time of the primary outcome and C is the censoring time.</p>
</dd>
<dt><code>s0</code></dt><dd><p>Surrogate marker measurement for control observations; this marker is measured at time = 0.5. For observations that experience the primary outcome or are censored before 0.5, this value is NA.</p>
</dd>
<dt><code>x0</code></dt><dd><p>The observed event or censoring time for control observations; X  = min(T, C) where T is the time of the primary outcome and C is the censoring time.</p>
</dd>
<dt><code>delta0</code></dt><dd><p>The indicator identifying whether the control observation was observed to have the event or was censored; D =1*(T&lt;C) where T is the time of the primary outcome and C is the censoring time.</p>
</dd>
</dl>


<h3>Details</h3>

<p>Note that if the observation is censored or experienced the primary outcome before the landmark time of 0.50, the surrogate marker measurement is not observed and coded NA. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dataA)
names(dataA)
</code></pre>

<hr>
<h2 id='dataB'>
Hypothetical Study B data
</h2><span id='topic+dataB'></span>

<h3>Description</h3>

<p>Hypothetical Study B data to be used in examples; landmark time = 0.50.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dataB)</code></pre>


<h3>Format</h3>

<p>A list with 6 elements representing 800 observations from a control group and 800 observations from a treatment group:
</p>

<dl>
<dt><code>s1</code></dt><dd><p>Surrogate marker measurement for treated observations; this marker is measured at time = 0.5. For observations that experience the primary outcome or are censored before 0.5, this value is NA.</p>
</dd>
<dt><code>x1</code></dt><dd><p>The observed event or censoring time for treated observations; X  = min(T, C) where T is the time of the primary outcome and C is the censoring time. This time is administratively censored at 0.55 (see details).</p>
</dd>
<dt><code>delta1</code></dt><dd><p>The indicator identifying whether the treated observation was observed to have the event or was censored; D =1*(T&lt;C) where T is the time of the primary outcome and C is the censoring time.</p>
</dd>
<dt><code>s0</code></dt><dd><p>Surrogate marker measurement for control observations; this marker is measured at time = 0.5. For observations that experience the primary outcome or are censored before 0.5, this value is NA.</p>
</dd>
<dt><code>x0</code></dt><dd><p>The observed event or censoring time for control observations; X  = min(T, C) where T is the time of the primary outcome and C is the censoring time. This time is administratively censored at 0.55 (see details).</p>
</dd>
<dt><code>delta0</code></dt><dd><p>The indicator identifying whether the control observation was observed to have the event or was censored; D =1*(T&lt;C) where T is the time of the primary outcome and C is the censoring time.</p>
</dd>
</dl>


<h3>Details</h3>

<p>Note that if the observation is censored or experienced the primary outcome before the landmark time of 0.50, the surrogate marker measurement is not observed and coded NA. In addition, Study B data is only observed up to the landmark time plus some epsilon, here epsilon=0.05 such that all observations are essentially adminstratively censored at time=0.55. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dataB)
names(dataB)
</code></pre>

<hr>
<h2 id='delta.ea.single'>

Calculates the early treatment effect estimate in Study A
</h2><span id='topic+delta.ea.single'></span>

<h3>Description</h3>


<p>Calculates the early treatment effect estimate in Study B, generally not called directly by the user
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delta.ea.single(Axzero, Adeltazero, Aszero, Bxzero, Bdeltazero, 
Bszero, Bxone, Bdeltaone, Bsone, t, landmark, weightA = NULL, 
weightB = NULL, weight.both = NULL, extrapolate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="delta.ea.single_+3A_axzero">Axzero</code></td>
<td>


<p>observed event times in the control group in  Study A
</p>
</td></tr>
<tr><td><code id="delta.ea.single_+3A_adeltazero">Adeltazero</code></td>
<td>


<p>event/censoring indicators in the control group in Study A
</p>
</td></tr>
<tr><td><code id="delta.ea.single_+3A_aszero">Aszero</code></td>
<td>


<p>surrogate marker values in the control group in Study A, NA for individuals not observable at the time the surrogate marker was measured
</p>
</td></tr>
<tr><td><code id="delta.ea.single_+3A_bxzero">Bxzero</code></td>
<td>


<p>observed event times in the control group in  Study A
</p>
</td></tr>
<tr><td><code id="delta.ea.single_+3A_bdeltazero">Bdeltazero</code></td>
<td>


<p>event/censoring indicators in the control group in Study A
</p>
</td></tr>
<tr><td><code id="delta.ea.single_+3A_bszero">Bszero</code></td>
<td>


<p>surrogate marker values in the control group in Study A, NA for individuals not observable at the time the surrogate marker was measured
</p>
</td></tr>
<tr><td><code id="delta.ea.single_+3A_bxone">Bxone</code></td>
<td>


<p>observed event times in the treatment group in  Study A
</p>
</td></tr>
<tr><td><code id="delta.ea.single_+3A_bdeltaone">Bdeltaone</code></td>
<td>


<p>event/censoring indicators in the treatment group in Study A
</p>
</td></tr>
<tr><td><code id="delta.ea.single_+3A_bsone">Bsone</code></td>
<td>


<p>surrogate marker values in the treatment group in Study A, NA for individuals not observable at the time the surrogate marker was measured
</p>
</td></tr>
<tr><td><code id="delta.ea.single_+3A_t">t</code></td>
<td>


<p>time of interest
</p>
</td></tr>
<tr><td><code id="delta.ea.single_+3A_landmark">landmark</code></td>
<td>


<p>landmark time of interest, t0
</p>
</td></tr>
<tr><td><code id="delta.ea.single_+3A_weighta">weightA</code></td>
<td>


<p>Study A weights used for perturbation resampling
</p>
</td></tr>
<tr><td><code id="delta.ea.single_+3A_weightb">weightB</code></td>
<td>


<p>Study A weights used for perturbation resampling
</p>
</td></tr>
<tr><td><code id="delta.ea.single_+3A_weight.both">weight.both</code></td>
<td>


<p>Study A (replicated) weights used for perturbation resampling
</p>
</td></tr>
<tr><td><code id="delta.ea.single_+3A_extrapolate">extrapolate</code></td>
<td>


<p>TRUE or FALSE; indicates whether local constant extrapolation should be used
</p>
</td></tr>
</table>


<h3>Details</h3>


<p>Details are included in the documentation for design.study and recover.B
</p>


<h3>Value</h3>






<p>early treatment effect estimate
</p>


<h3>Author(s)</h3>


<p>Layla Parast
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dataA)

delta.ea.single(Axzero = dataA$x0, Adeltazero = dataA$delta0, 
Aszero = dataA$s0, Bxzero = dataA$x0, Bdeltazero = dataA$delta0, 
Bszero = dataA$s0, Bxone = dataA$x1, Bdeltaone = dataA$delta1, 
Bsone = dataA$s1, t=1, landmark=0.5,  extrapolate = TRUE)

</code></pre>

<hr>
<h2 id='delta.eb.single'>
Calculates the early treatment effect estimate in Study B
</h2><span id='topic+delta.eb.single'></span>

<h3>Description</h3>


<p>Calculates the early treatment effect estimate in Study B, generally not called directly by the user
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delta.eb.single(Axzero, Adeltazero, Aszero, Bxzero, Bdeltazero, 
Bszero, Bxone, Bdeltaone, Bsone, t, landmark, weightA = NULL, 
weightB = NULL, weight.both = NULL, extrapolate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="delta.eb.single_+3A_axzero">Axzero</code></td>
<td>


<p>observed event times in the control group in  Study A
</p>
</td></tr>
<tr><td><code id="delta.eb.single_+3A_adeltazero">Adeltazero</code></td>
<td>


<p>event/censoring indicators in the control group in Study A
</p>
</td></tr>
<tr><td><code id="delta.eb.single_+3A_aszero">Aszero</code></td>
<td>


<p>surrogate marker values in the control group in Study A, NA for individuals not observable at the time the surrogate marker was measured
</p>
</td></tr>
<tr><td><code id="delta.eb.single_+3A_bxzero">Bxzero</code></td>
<td>


<p>observed event times in the control group in  Study B
</p>
</td></tr>
<tr><td><code id="delta.eb.single_+3A_bdeltazero">Bdeltazero</code></td>
<td>


<p>event/censoring indicators in the control group in Study B
</p>
</td></tr>
<tr><td><code id="delta.eb.single_+3A_bszero">Bszero</code></td>
<td>


<p>surrogate marker values in the control group in Study B, NA for individuals not observable at the time the surrogate marker was measured
</p>
</td></tr>
<tr><td><code id="delta.eb.single_+3A_bxone">Bxone</code></td>
<td>


<p>observed event times in the treatment group in  Study B
</p>
</td></tr>
<tr><td><code id="delta.eb.single_+3A_bdeltaone">Bdeltaone</code></td>
<td>


<p>event/censoring indicators in the treatment group in  Study B
</p>
</td></tr>
<tr><td><code id="delta.eb.single_+3A_bsone">Bsone</code></td>
<td>


<p>surrogate marker values in the treatment group in Study B, NA for individuals not observable at the time the surrogate marker was measured
</p>
</td></tr>
<tr><td><code id="delta.eb.single_+3A_t">t</code></td>
<td>


<p>time of interest
</p>
</td></tr>
<tr><td><code id="delta.eb.single_+3A_landmark">landmark</code></td>
<td>


<p>landmark time of interest, t0
</p>
</td></tr>
<tr><td><code id="delta.eb.single_+3A_weighta">weightA</code></td>
<td>


<p>Study A weights used for perturbation resampling
</p>
</td></tr>
<tr><td><code id="delta.eb.single_+3A_weightb">weightB</code></td>
<td>


<p>Study B weights used for perturbation resampling
</p>
</td></tr>
<tr><td><code id="delta.eb.single_+3A_weight.both">weight.both</code></td>
<td>


<p>Study A and Study B weights used for perturbation resampling
</p>
</td></tr>
<tr><td><code id="delta.eb.single_+3A_extrapolate">extrapolate</code></td>
<td>


<p>TRUE or FALSE; indicates whether local constant extrapolation should be used
</p>
</td></tr>
</table>


<h3>Details</h3>


<p>Details are included in the documentation for early.delta.test
</p>


<h3>Value</h3>






<p>early treatment effect estimate
</p>


<h3>Author(s)</h3>


<p>Layla Parast
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dataA)
data(dataB)

delta.eb.single(Axzero = dataA$x0, Adeltazero = dataA$delta0, 
Aszero = dataA$s0, Bxzero = dataB$x0, Bdeltazero = dataB$delta0, 
Bszero = dataB$s0, Bxone = dataB$x1, Bdeltaone = dataB$delta1, 
Bsone = dataB$s1, t=1, landmark=0.5,  extrapolate = TRUE)

</code></pre>

<hr>
<h2 id='delta.estimate'>

Calculates the treatment effect, the difference in survival at time t
</h2><span id='topic+delta.estimate'></span>

<h3>Description</h3>


<p>This function calculates the treatment effect in the survival setting i.e. the difference in survival at time t between the treatment group and the control group. The inverse probability of censoring weighted estimate of survival within each treatment group is used; there is an option to use the Kaplan-Meier estimate instead. This function is generally not expected to be used directly by the user, it is called by the recover.B function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delta.estimate(xone, xzero, deltaone, deltazero, t, weight = NULL, KM = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="delta.estimate_+3A_xone">xone</code></td>
<td>


<p>numeric vector, the observed event times in the treatment group, X = min(T,C) where T is the time of the primary outcome and C is the censoring time.
</p>
</td></tr>
<tr><td><code id="delta.estimate_+3A_xzero">xzero</code></td>
<td>


<p>numeric vector, the observed event times in the control group, X = min(T,C) where T is the time of the primary outcome and C is the censoring time.
</p>
</td></tr>
<tr><td><code id="delta.estimate_+3A_deltaone">deltaone</code></td>
<td>


<p>numeric vector, the event indicators for the treatment group, D = I(T&lt;C) where T is the time of the primary outcome and C is the censoring time.
</p>
</td></tr>
<tr><td><code id="delta.estimate_+3A_deltazero">deltazero</code></td>
<td>


<p>numeric vector, the event indicators for the control group, D = I(T&lt;C) where T is the time of the primary outcome and C is the censoring time.
</p>
</td></tr>
<tr><td><code id="delta.estimate_+3A_t">t</code></td>
<td>


<p>the time of interest.
</p>
</td></tr>
<tr><td><code id="delta.estimate_+3A_weight">weight</code></td>
<td>


<p>a <code class="reqn">n_1+n_0</code> by <code class="reqn">x</code> matrix of weights where <code class="reqn">n_1 =</code> sample size in the treatment group and <code class="reqn">n_0 =</code> sample size in the control group, default is null; generally not supplied by user, only used by other functions.
</p>
</td></tr>
<tr><td><code id="delta.estimate_+3A_km">KM</code></td>
<td>


<p>true or false, indicating whether the Kaplan-Meier estimate of survival should be used instead of the inverse probability of censoring weighted estimate
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the difference in survival at time t (treatment group minus control group)





</p>


<h3>Author(s)</h3>


<p>Layla Parast
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dataA)
delta.estimate(xone = dataA$x1, xzero = dataA$x0, deltaone = dataA$delta1, deltazero = 
dataA$delta0, t=1)

delta.estimate(xone = dataA$x1, xzero = dataA$x0, deltaone = dataA$delta1, deltazero = 
dataA$delta0, t=0.5)

</code></pre>

<hr>
<h2 id='design.study'>
Power and sample size calculation for designing a future study
</h2><span id='topic+design.study'></span>

<h3>Description</h3>

<p>Power and sample size calculation for designing a future study
</p>


<h3>Usage</h3>

<pre><code class='language-R'>design.study(Axzero, Adeltazero, Aszero, Axone = NULL, Adeltaone = NULL, Asone = 
NULL, delta.ea = NULL, psi = NULL, R.A.given = NULL, t, landmark, extrapolate = T, 
adjustment = F, n = NULL, power = NULL, pi.1 = 0.5, pi.0 = 0.5, cens.rate, transform = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="design.study_+3A_axzero">Axzero</code></td>
<td>


<p>observed event times in the control group in  Study A
</p>
</td></tr>
<tr><td><code id="design.study_+3A_adeltazero">Adeltazero</code></td>
<td>


<p>event/censoring indicators in the control group in Study A
</p>
</td></tr>
<tr><td><code id="design.study_+3A_aszero">Aszero</code></td>
<td>


<p>surrogate marker values in the control group in Study A, NA for individuals not observable at the time the surrogate marker was measured
</p>
</td></tr>
<tr><td><code id="design.study_+3A_axone">Axone</code></td>
<td>


<p>observed event times in the treatment group in  Study A; optional (user must provide either (1) data from treatment arm in Study A or (2) hypothesized values for delta.ea (or R.A.given)and psi or (3) data from treatment arm in Study A and hypothesized psi (if different from observed treatment effect at t in Study A))
</p>
</td></tr>
<tr><td><code id="design.study_+3A_adeltaone">Adeltaone</code></td>
<td>


<p>event/censoring indicators in the treatment group in Study A; optional (user must provide either (1) data from treatment arm in Study A or (2) hypothesized values for delta.ea (or R.A.given)and psi or (3) data from treatment arm in Study A and hypothesized psi (if different from observed treatment effect at t in Study A))
</p>
</td></tr>
<tr><td><code id="design.study_+3A_asone">Asone</code></td>
<td>


<p>surrogate marker values in the treatment group in Study A, NA for individuals not observable at the time the surrogate marker was measured; optional (user must provide either (1) data from treatment arm in Study A or (2) hypothesized values for delta.ea (or R.A.given) and psi or (3) data from treatment arm in Study A and hypothesized psi (if different from observed treatment effect at t in Study A))
</p>
</td></tr>
<tr><td><code id="design.study_+3A_delta.ea">delta.ea</code></td>
<td>


<p>hypothesized value for the early treatment effect at time t0; optional (user must provide either (1) data from treatment arm in Study A or (2) hypothesized values for delta.ea (or R.A.given) and psi or (3) data from treatment arm in Study A and hypothesized psi (if different from observed treatment effect at t in Study A)), if not given then it is assumed that this quantity equals the osberved early treatment effect at time t0 in Study A
</p>
</td></tr>
<tr><td><code id="design.study_+3A_psi">psi</code></td>
<td>


<p>hypothesized value for the treatment effect at time t; optional (user must provide either (1) data from treatment arm in Study A or (2) hypothesized values for delta.ea (or R.A.given) and psi or (3) data from treatment arm in Study A and hypothesized psi (if different from observed treatment effect at t in Study A)), if not given then it is assumed that this quantity equals the osberved treatment effect at time t in Study A
</p>
</td></tr>
<tr><td><code id="design.study_+3A_r.a.given">R.A.given</code></td>
<td>


<p>hypothesized value for the proportion of treatment effect on the primary outcome explained by surrogate information at t0 in Study A; optional (user must provide either (1) data from treatment arm in Study A or (2) hypothesized values for delta.ea (or R.A.given) and psi or (3) data from treatment arm in Study A and hypothesized psi (if different from observed treatment effect at t in Study A))
</p>
</td></tr>
<tr><td><code id="design.study_+3A_t">t</code></td>
<td>


<p>time of interest
</p>
</td></tr>
<tr><td><code id="design.study_+3A_landmark">landmark</code></td>
<td>


<p>landmark time of interest, t0
</p>
</td></tr>
<tr><td><code id="design.study_+3A_extrapolate">extrapolate</code></td>
<td>


<p>TRUE or FALSE; indicates whether local constant extrapolation should be used, default is TRUE
</p>
</td></tr>
<tr><td><code id="design.study_+3A_adjustment">adjustment</code></td>
<td>


<p>TRUE or FALSE; indicates whether adjustment that is needed when survival past time t is high should be used, default is FALSE if survival past t0 is &lt; 0.90 in both arms arm of Study A, otherwise default is true if survival past t0 is &gt;= 0.90 in either arm of Study A
</p>
</td></tr>
<tr><td><code id="design.study_+3A_n">n</code></td>
<td>


<p>total sample size for future study (Study B); optional (user needs to provide either n or power)
</p>
</td></tr>
<tr><td><code id="design.study_+3A_power">power</code></td>
<td>


<p>desired power for testing at time t0 for future study (Study B); optional (user needs to provide either n or power)
</p>
</td></tr>
<tr><td><code id="design.study_+3A_pi.1">pi.1</code></td>
<td>


<p>proportion of total sample size in future study (Study B) that would be assigned to the treatment group, default is 0.5
</p>
</td></tr>
<tr><td><code id="design.study_+3A_pi.0">pi.0</code></td>
<td>


<p>proportion of total sample size in future study (Study B) that would be assigned to the treatment group, default is 0.5
</p>
</td></tr>
<tr><td><code id="design.study_+3A_cens.rate">cens.rate</code></td>
<td>


<p>censoring in the future study (Study B) is assumed to follow an exponential distribution with censoring rate equal to this specificed value
</p>
</td></tr>
<tr><td><code id="design.study_+3A_transform">transform</code></td>
<td>


<p>TRUE or FALSE; indicates whether a transformation should be used, default is FALSE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Assume information is available on a prior study, Study A, examining the effectiveness of a treatment up to some time of interest, t. The aim is to plan a future study, Study B, that would be conducted only up to time <code class="reqn">t_0&lt;t</code> and a test for a treatment effect would occur at <code class="reqn">t_0</code>. In both studies, we assume a surrogate marker is/will be measured at time <code class="reqn">t_0</code> for individuals still observable at <code class="reqn">t_0</code>. Let <code class="reqn">G</code> be the binary treatment indicator with <code class="reqn">G=1</code> for treatment and <code class="reqn">G=0</code> for control and we assume throughout that subjects are randomly assigned to a treatment group at baseline. Let <code class="reqn">T_K^{(1)}</code> and <code class="reqn">T_K^{(0)}</code> denote the time of the primary outcome of interest, death for example, under the treatment and under the control, respectively, in Study K. Let <code class="reqn">S_K^{(1)}</code> and <code class="reqn">S_K^{(0)}</code> denote the surrogate marker measured at time <code class="reqn">t_0</code> under the treatment and the control, respectively, in Study K.
</p>
<p>The null and alternative hypotheses of interest are:
</p>
<p style="text-align: center;"><code class="reqn">H_0: \Delta_B(t) \equiv P(T_B^{(1)}&gt;t) - P(T_B^{(0)}&gt;t) = 0</code>
</p>

<p style="text-align: center;"><code class="reqn">H_1: \Delta_B(t) = \psi &gt;0</code>
</p>

<p>Here, we plan to test <code class="reqn">H_0</code> in Study B using the test statistic </p>
<p style="text-align: center;"><code class="reqn">Z_{EB}(t,t_0) = \sqrt{n_B}\frac{\hat{\Delta}_{EB}(t,t_0)}{\hat{\sigma}_{EB}(t,t_0)}</code>
</p>
<p> (see early.delta.test documentation). The estimated power at a type I error rate of 0.05 is thus
</p>
<p style="text-align: center;"><code class="reqn"> 1 - \Phi \left\{1.96 - \frac{\sqrt{n_B}\hat{R}_{SA}(t, t_0)\psi  }{ \hat{\sigma}_{EB0}(t,t_0\mid \hat{r}_A^{(0)}, W_{B}^{C})} \right \}</code>
</p>

<p>where <code class="reqn">\hat{R}_{SA}(t,t_0) =\hat{\Delta}_{EA}(t,t_0)/\hat{\Delta}_A(t)</code>, and </p>
<p style="text-align: center;"><code class="reqn">\hat{\Delta}_A(t)=n_{A1}^{-1}\sum_{i=1}^{n_{A1}}\frac{I(X_{Ai}^{(1)}&gt;t)}{\hat{W}_{A1}^C(t)}-n_{A0}^{-1}\sum_{i=1}^{n_{A0}}\frac{I(X_{Ai}^{(0)}&gt;t)}{\hat{W}_{A0}^C(t)},</code>
</p>

<p>and <code class="reqn">\hat{\Delta}_{EA}(t,t_0)</code> is parallel to <code class="reqn">\hat{\Delta}_{EB}(t,t_0)</code> except replacing
<code class="reqn">n_{A0}^{-1} \sum_{i=1}^{n_{A0}} \hat{r}_A^{(0)}(t|S_{Ai}^{(0)}, t_0) \frac{I(X_{Ai}^{(0)} &gt; t_0)}{\hat{W}_{A0}^C(t_0)}</code>
by <code class="reqn">n_{A0}^{-1}\sum_{i=1}^{n_{A0}}\hat{W}_{A0}^C(t)^{-1}I(X_{Ai}^{(0)}&gt;t),</code> and <code class="reqn">\hat{W}^C_{Ag}(\cdot)</code> is the Kaplan-Meier estimator of the survival function for <code class="reqn">C_{A}^{(g)}</code> for <code class="reqn">g=0,1</code>.  In addition, <code class="reqn">\hat{\sigma}_{EB0}(t, t_0| \hat{r}_A^{(0)}, W_{B}^{C})^2 =</code> </p>
<p style="text-align: center;"><code class="reqn">\frac{1}{\pi_{B0}\pi_{B1}}\left[ \frac{\hat\mu_{AB2}^{(0)}(t, t_0, \mid \hat r_A^{(0)})}{W_{B}^{C}(t_0)}-\hat\mu_{AB1}^{(0)}(t, t_0, \mid \hat r_A^{(0)})^2\left\{1+\int_0^{t_0}\frac{\lambda_{B}^{C}(u)du}{\hat{W}_{A0}^{T}(u)W_{B}^{C}(u)}\right\}\right]</code>
</p>
<p> assuming that the survival function of the censoring distribution is <code class="reqn">W_{B}^{C}(t)</code> in both arms, where <code class="reqn">\pi_{Bg}=n_{Bg}/n_B</code> and <code class="reqn">\hat{W}_{A0}^{T}(\cdot)</code> is the Kaplan-Meier estimator of  the survival function of <code class="reqn">T_A^{(0)}</code> based on the observations from Study A, and </p>
<p style="text-align: center;"><code class="reqn">\hat\mu_{ABm}^{(0)}(t, t_0, \mid \hat r_A^{(0)})=n_{A0}^{-1}\sum_{i=1}^{n_{A0}}\frac{\hat{r}_A^{(0)}(t|S_{Ai}^{(0)}, t_0)^mI(X_{Ai}^{(0)}&gt;t_0)}{\hat{W}_{A0}^{C}(t_0)}</code>
</p>
<p> where <code class="reqn">\hat{r}_A^{(0)}(t|s, t_0)</code> is provided in the early.delta.test documentation.
</p>
<p>This can be re-arranged to calculate the sample size needed in Study B to achieve a power of <code class="reqn">100(1-\beta)\%</code>:
</p>
<p style="text-align: center;"><code class="reqn">n_B=\left \{ \hat{\sigma}_{EB0}(t,t_0\mid \hat{r}_A^{(0)},W_{B}^{C}) \left (\frac{1.96 - \Phi^{-1}(\beta)}{\hat{R}_{SA}(t,t_0)\psi } \right ) \right \}^2.</code>
</p>

<p>When the outcome rate is low (i.e., survival rate at t is high), an adjustment to the variance calculation is needed. This is automatically implemented if the survival rate at t in either arm is 0.90 or higher. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>n</code></td>
<td>
<p>Total sample size needed for Study B at the given power (if power is provided by user).</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>Estimated power for Study B at the given sample size (if sample size is provided by user).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast L, Cai T, Tian L (2019). Using a Surrogate Marker for Early Testing of a Treatment Effect. Biometrics, 75(4):1253-1263.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dataA)
design.study(Axzero = dataA$x0, Adeltazero = dataA$delta0, Aszero = dataA$s0, 
Axone = dataA$x1, Adeltaone = dataA$delta1, Asone = dataA$s1, t=1, landmark=0.5, 
power = 0.80, cens.rate=0.5)

design.study(Axzero = dataA$x0, Adeltazero = dataA$delta0, Aszero = dataA$s0, 
Axone = dataA$x1, Adeltaone = dataA$delta1, Asone = dataA$s1, t=1, landmark=0.5, 
n=2500, cens.rate=0.5)

design.study(Axzero = dataA$x0, Adeltazero = dataA$delta0, Aszero = dataA$s0, 
Axone = dataA$x1, Adeltaone = dataA$delta1, Asone = dataA$s1, t=1, landmark=0.5, 
power = 0.80, cens.rate=0.5, psi = 0.05)
</code></pre>

<hr>
<h2 id='early.delta.test'>
Estimate and test the early treatment effect
</h2><span id='topic+early.delta.test'></span>

<h3>Description</h3>

<p>Estimates the early treatment effect estimate and provides two versions of the standard error; tests the null hypothesis that this treatment effect is equal to 0 </p>


<h3>Usage</h3>

<pre><code class='language-R'>early.delta.test(Axzero, Adeltazero, Aszero, Bxzero, Bdeltazero, Bszero, Bxone, 
Bdeltaone, Bsone, t, landmark, perturb = T, extrapolate = T, transform = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="early.delta.test_+3A_axzero">Axzero</code></td>
<td>


<p>observed event times in the control group in  Study A
</p>
</td></tr>
<tr><td><code id="early.delta.test_+3A_adeltazero">Adeltazero</code></td>
<td>


<p>event/censoring indicators in the control group in Study A
</p>
</td></tr>
<tr><td><code id="early.delta.test_+3A_aszero">Aszero</code></td>
<td>


<p>surrogate marker values in the control group in Study A, NA for individuals not observable at the time the surrogate marker was measured
</p>
</td></tr>
<tr><td><code id="early.delta.test_+3A_bxzero">Bxzero</code></td>
<td>


<p>observed event times in the control group in  Study B
</p>
</td></tr>
<tr><td><code id="early.delta.test_+3A_bdeltazero">Bdeltazero</code></td>
<td>


<p>event/censoring indicators in the control group in Study B
</p>
</td></tr>
<tr><td><code id="early.delta.test_+3A_bszero">Bszero</code></td>
<td>


<p>surrogate marker values in the control group in Study B, NA for individuals not observable at the time the surrogate marker was measured
</p>
</td></tr>
<tr><td><code id="early.delta.test_+3A_bxone">Bxone</code></td>
<td>


<p>observed event times in the treatment group in  Study B
</p>
</td></tr>
<tr><td><code id="early.delta.test_+3A_bdeltaone">Bdeltaone</code></td>
<td>


<p>event/censoring indicators in the treatment group in  Study B
</p>
</td></tr>
<tr><td><code id="early.delta.test_+3A_bsone">Bsone</code></td>
<td>


<p>surrogate marker values in the treatment group in Study B, NA for individuals not observable at the time the surrogate marker was measured
</p>
</td></tr>
<tr><td><code id="early.delta.test_+3A_t">t</code></td>
<td>


<p>time of interest
</p>
</td></tr>
<tr><td><code id="early.delta.test_+3A_landmark">landmark</code></td>
<td>


<p>landmark time of interest, t0
</p>
</td></tr>
<tr><td><code id="early.delta.test_+3A_perturb">perturb</code></td>
<td>


<p>TRUE or FALSE; indicates whether the standard error estimate obtained using perturbation resampling should be calculated
</p>
</td></tr>
<tr><td><code id="early.delta.test_+3A_extrapolate">extrapolate</code></td>
<td>


<p>TRUE or FALSE; indicates whether local constant extrapolation should be used, default is TRUE
</p>
</td></tr>
<tr><td><code id="early.delta.test_+3A_transform">transform</code></td>
<td>


<p>TRUE or FALSE; indicates whether a transformation should be used, default is FALSE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Assume there are two randomized studies of a treatment effect, a prior study (Study A) and a current study (Study B). Study A was completed up to some time t, while Study B was stopped at time <code class="reqn">t_0&lt;t</code>. In both studies, a surrogate marker was measured at time <code class="reqn">t_0</code> for individuals still observable at <code class="reqn">t_0</code>. Let <code class="reqn">G</code> be the binary treatment indicator with <code class="reqn">G=1</code> for treatment and <code class="reqn">G=0</code> for control and we assume throughout that subjects are randomly assigned to a treatment group at baseline. Let <code class="reqn">T_K^{(1)}</code> and <code class="reqn">T_K^{(0)}</code> denote the time of the primary outcome of interest, death for example, under the treatment and under the control, respectively, in Study K. Let <code class="reqn">S_K^{(1)}</code> and <code class="reqn">S_K^{(0)}</code> denote the surrogate marker measured at time <code class="reqn">t_0</code> under the treatment and the control, respectively, in Study K.
</p>
<p>The treatment effect quantity of interest, <code class="reqn">\Delta_K(t)</code>, is the difference in survival rates by time <code class="reqn">t</code> under treatment versus control,
</p>
<p style="text-align: center;"><code class="reqn"> \Delta_K(t)=E\{ I(T_K^{(1)}&gt;t)\} - E\{I(T_K^{(0)}&gt;t)\} = P(T_K^{(1)}&gt;t) - P(T_K^{(0)}&gt;t)</code>
</p>

<p>where <code class="reqn">t&gt;t_0</code>. Here, we estimate an early treatment effect quantity using surrogate marker information defined as, 
</p>
<p style="text-align: center;"><code class="reqn">\Delta_{EB}(t,t_0) = P( T_B^{(1)} &gt; t_0) \int r(t|s,t_0) dF_B^{(1)} (s|t_0) - P( T_B^{(0)} &gt; t_0) \int r(t|s,t_0) dF_B^{(0)} (s|t_0)</code>
</p>

<p>where <code class="reqn">r(t|s,t_0) = P(T_{A}^{(0)} &gt; t | T_{A}^{(0)} &gt; t_0, S_{A}^{(0)}=s)</code> and <code class="reqn">F_B^{(g)}(s|t_0) = P(S_B^{(g)} \le s \mid T_B^{(g)} &gt; t_0)</code>.
</p>
<p>To test the null hypothesis that <code class="reqn">\Delta_B(t) = 0</code>, we test the null hypothesis <code class="reqn">\Delta_{EB}(t,t_0) = 0</code> using the test statistic </p>
<p style="text-align: center;"><code class="reqn">Z_{EB}(t,t_0) = \sqrt{n_B}\frac{\hat{\Delta}_{EB}(t,t_0)}{\hat{\sigma}_{EB}(t,t_0)}</code>
</p>

<p>where <code class="reqn">\hat{\Delta}_{EB}(t,t_0)</code> is a consistent estimate of <code class="reqn">\Delta_{EB}(t,t_0)</code> and <code class="reqn">\hat{\sigma}_{EB}(t,t_0)</code> is the estimated standard error of <code class="reqn">\sqrt{n_B}\{\hat{\Delta}_{EB}(t,t_0)-\Delta_{EB}(t, t_0)\}.</code>  We reject the null hypothesis when <code class="reqn">|Z_{EB}(t,t_0) | &gt; \Phi^{-1}(1-\alpha/2)</code> where <code class="reqn">\alpha</code> is the Type 1 error rate. 
</p>
<p>To obtain <code class="reqn">\hat{\Delta}_{EB}(t,t_0)</code>, we use 
</p>
<p style="text-align: center;"><code class="reqn">  \hat{\Delta}_{EB}(t,t_0) = n_{B1}^{-1} \sum_{i=1}^{n_{B1}} \hat{r}_A^{(0)}(t|S_{Bi}^{(1)}, t_0) \frac{I(X_{Bi}^{(1)} &gt; t_0)}{\hat{W}_{B1}^C(t_0)} -  n_{B0}^{-1} \sum_{i=1}^{n_{B0}} \hat{r}_A^{(0)}(t|S_{Bi}^{(0)}, t_0) \frac{I(X_{Bi}^{(0)} &gt; t_0)}{\hat{W}_{B0}^C(t_0)}</code>
</p>

<p>where <code class="reqn">\hat{W}^C_{k g}(u)</code> is the Kaplan-Meier estimator of <code class="reqn">W_{k g}^{C}(u)=P(C_{k}^{(g)} &gt; u)</code>  and 
<code class="reqn">\hat{r}_A^{(0)}(t|s,t_0) = \exp\{-\hat{\Lambda}_A^{(0)}(t\mid s,t_0) \}</code>, where
</p>
<p style="text-align: center;"><code class="reqn">\hat{\Lambda}_A^{(0)}(t \mid t_0,s) = \int_{t_0}^t \frac{\sum_{i=1}^{n_{A0}} I(X_{Ai}^{(0)}&gt;t_0) K_h\{\gamma(S_{Ai}^{(0)}) - \gamma(s)\}dN_{Ai}^{(0)} (z)}{\sum_{i=1}^{n_{A0}}  K_h\{\gamma(S_{Ai}^{(0)}) - \gamma(s)\} Y_{Ai}^{(0)}(z)}</code>
</p>

<p>is a consistent estimate of <code class="reqn">\Lambda_A^{(0)}(t\mid t_0,s ) =  -\log [r_A^{(0)}(t\mid t_0,s)],</code> <code class="reqn">Y_{Ai}^{(0)}(t) = I(X_{Ai}^{(0)} \geq t)</code>,  <code class="reqn">N_{Ai}^{(0)}(t) = I(X_{Ai}^{(0)} \leq t) \delta_{Ai}^{(0)},  K(\cdot)</code> is a smooth symmetric density function, <code class="reqn">K_h(x) = K(x/h)/h</code> and <code class="reqn">\gamma(\cdot)</code> is a given monotone transformation function.  For the bandwidth <code class="reqn">h</code>, we require the standard undersmoothing assumption of <code class="reqn">h=O(n_g^{-\gamma})</code> with <code class="reqn">\gamma \in (1/4,1/2)</code> in order to eliminate the impact of the bias of the conditional survival function on the resulting estimator.
</p>
<p>The quantity <code class="reqn">\hat{\sigma}_{EB}(t,t_0)</code> is obtained using either a closed form expression under the null or a perturbation resampling approach. If a confidence interval is desired, perturbation resampling is required.
</p>


<h3>Value</h3>

<table>
<tr><td><code>delta.eb</code></td>
<td>
<p>The estimate early treatment effect, <code class="reqn">\hat{\Delta}_{EB}(t,t_0)</code>.</p>
</td></tr>
<tr><td><code>se.closed</code></td>
<td>
<p>The standard error estimate of the early treatment effect using the closed form expression under the null.</p>
</td></tr>
<tr><td><code>Z.closed</code></td>
<td>
<p>The test statistic using the closed form standard error expression.</p>
</td></tr>
<tr><td><code>p.value.closed</code></td>
<td>
<p>The p-value using the closed form standard error expression.</p>
</td></tr>
<tr><td><code>conf.closed.norm</code></td>
<td>
<p>The confidence interval for the early treatment effect, using a normal approximation and using the closed form standard error expression.</p>
</td></tr>
<tr><td><code>se.perturb</code></td>
<td>
<p>The standard error estimate of the early treatment effect using perturbation resampling, if perturb = T.</p>
</td></tr> 
<tr><td><code>Z.perturb</code></td>
<td>
<p>The test statistic using the perturbed standard error estimate, if perturb = T.</p>
</td></tr>
<tr><td><code>p.value.perturb</code></td>
<td>
<p>The p-value using the perturbed standard error estimate, if perturb = T.</p>
</td></tr>
<tr><td><code>conf.perturb.norm</code></td>
<td>
<p>The confidence interval for the early treatment effect, using a normal approximation and using the perturbed standard error expression, if perturb = T.</p>
</td></tr>
<tr><td><code>delta.eb.CI</code></td>
<td>
<p>The confidence interval for the early treatment effect, using the quantiles of the perturbed estimates, if perturb = T.</p>
</td></tr>
</table>


<h3>Author(s)</h3>


<p>Layla Parast
</p>


<h3>References</h3>


<p>Parast L, Cai T, Tian L (2019). Using a Surrogate Marker for Early Testing of a Treatment Effect. Biometrics, 75(4):1253-1263.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dataA)
data(dataB)
early.delta.test(Axzero = dataA$x0, Adeltazero = dataA$delta0, Aszero = dataA$s0, 
Bxzero = dataB$x0, Bdeltazero = dataB$delta0, Bszero = dataB$s0, Bxone = dataB$x1, 
Bdeltaone = dataB$delta1, Bsone = dataB$s1, t=1, landmark=0.5, perturb = FALSE, 
extrapolate = TRUE)

early.delta.test(Axzero = dataA$x0, Adeltazero = dataA$delta0, Aszero = dataA$s0, 
Bxzero = dataB$x0, Bdeltazero = dataB$delta0, Bszero = dataB$s0, Bxone = dataB$x1, 
Bdeltaone = dataB$delta1, Bsone = dataB$s1, t=0.75, landmark=0.5, perturb = FALSE, 
extrapolate = TRUE)


early.delta.test(Axzero = dataA$x0, Adeltazero = dataA$delta0, Aszero = dataA$s0, 
Bxzero = dataB$x0, Bdeltazero = dataB$delta0, Bszero = dataB$s0, Bxone = dataB$x1, 
Bdeltaone = dataB$delta1, Bsone = dataB$s1, t=1, landmark=0.5, perturb = TRUE, 
extrapolate = TRUE)	


</code></pre>

<hr>
<h2 id='helper.si'>

Helper function
</h2><span id='topic+helper.si'></span>

<h3>Description</h3>


<p>Helper function; should not be called directly by user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>helper.si(yy,FUN,Yi,Vi=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="helper.si_+3A_yy">yy</code></td>
<td>

<p>yy
</p>
</td></tr>
<tr><td><code id="helper.si_+3A_fun">FUN</code></td>
<td>

<p>FUN</p>
</td></tr>
<tr><td><code id="helper.si_+3A_yi">Yi</code></td>
<td>

<p>Yi</p>
</td></tr>
<tr><td><code id="helper.si_+3A_vi">Vi</code></td>
<td>

<p>Vi</p>
</td></tr>
</table>


<h3>Value</h3>






<table>
<tr><td><code>out</code></td>
<td>
<p>matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>


<p>Layla Parast
</p>

<hr>
<h2 id='int.hazc'>

Helper function
</h2><span id='topic+int.hazc'></span>

<h3>Description</h3>


<p>Helper function; should not be called directly by user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>int.hazc(landmark, delta, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="int.hazc_+3A_landmark">landmark</code></td>
<td>


<p>landmark
</p>
</td></tr>
<tr><td><code id="int.hazc_+3A_delta">delta</code></td>
<td>


<p>delta
</p>
</td></tr>
<tr><td><code id="int.hazc_+3A_x">x</code></td>
<td>


<p>x
</p>
</td></tr>
</table>


<h3>Value</h3>






<p>value
</p>


<h3>Author(s)</h3>


<p>Layla Parast
</p>

<hr>
<h2 id='int.hazc.plan'>

Helper function
</h2><span id='topic+int.hazc.plan'></span>

<h3>Description</h3>


<p>Helper function; should not be called directly by user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>int.hazc.plan(landmark, delta, x, cens.rate, B = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="int.hazc.plan_+3A_landmark">landmark</code></td>
<td>


<p>landmark
</p>
</td></tr>
<tr><td><code id="int.hazc.plan_+3A_delta">delta</code></td>
<td>


<p>delta
</p>
</td></tr>
<tr><td><code id="int.hazc.plan_+3A_x">x</code></td>
<td>


<p>x
</p>
</td></tr>
<tr><td><code id="int.hazc.plan_+3A_cens.rate">cens.rate</code></td>
<td>


<p>cens.rate
</p>
</td></tr>
<tr><td><code id="int.hazc.plan_+3A_b">B</code></td>
<td>


<p>B
</p>
</td></tr>
</table>


<h3>Value</h3>






<p>value
</p>


<h3>Author(s)</h3>


<p>Layla Parast
</p>

<hr>
<h2 id='Kern.FUN'>

Calculates kernel matrix
</h2><span id='topic+Kern.FUN'></span>

<h3>Description</h3>


<p>Helper function; this calculates the kernel matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Kern.FUN(zz, zi, bw, kern0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Kern.FUN_+3A_zz">zz</code></td>
<td>


<p>zz
</p>
</td></tr>
<tr><td><code id="Kern.FUN_+3A_zi">zi</code></td>
<td>


<p>zi
</p>
</td></tr>
<tr><td><code id="Kern.FUN_+3A_bw">bw</code></td>
<td>


<p>bandwidth
</p>
</td></tr>
<tr><td><code id="Kern.FUN_+3A_kern0">kern0</code></td>
<td>


<p>kernel distribution
</p>
</td></tr>
</table>


<h3>Value</h3>






<p>the kernel matrix
</p>


<h3>Author(s)</h3>


<p>Layla Parast
</p>

<hr>
<h2 id='pred.smooth.surv.new'>

Calculates the conditional probability of survival to time t
</h2><span id='topic+pred.smooth.surv.new'></span>

<h3>Description</h3>


<p>Helper function; calculates the estimated conditional probability of survival to time t given survival to the landmark time and given surrogate marker information. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred.smooth.surv.new(Axzero.f, Adeltazero.f, Aszero.f, Bsnew.f, 
Bsnew2.f = NULL, myt, bw = NULL, weight.pred, extrapolate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pred.smooth.surv.new_+3A_axzero.f">Axzero.f</code></td>
<td>


<p>observed event times in the control group in  Study A
</p>
</td></tr>
<tr><td><code id="pred.smooth.surv.new_+3A_adeltazero.f">Adeltazero.f</code></td>
<td>


<p>event/censoring indicators in the control group in Study A
</p>
</td></tr>
<tr><td><code id="pred.smooth.surv.new_+3A_aszero.f">Aszero.f</code></td>
<td>


<p>surrogate marker values in the control group in Study A, NA for individuals not observable at the time the surrogate marker was measured
</p>
</td></tr>
<tr><td><code id="pred.smooth.surv.new_+3A_bsnew.f">Bsnew.f</code></td>
<td>


<p>surrogate marker values in one group (either treatment or control) in Study B
</p>
</td></tr>
<tr><td><code id="pred.smooth.surv.new_+3A_bsnew2.f">Bsnew2.f</code></td>
<td>


<p>surrogate marker values in one group (either treatment or control) in Study B, optional
</p>
</td></tr>
<tr><td><code id="pred.smooth.surv.new_+3A_myt">myt</code></td>
<td>


<p>time of interest
</p>
</td></tr>
<tr><td><code id="pred.smooth.surv.new_+3A_bw">bw</code></td>
<td>


<p>bandwidth, optional
</p>
</td></tr>
<tr><td><code id="pred.smooth.surv.new_+3A_weight.pred">weight.pred</code></td>
<td>


<p>weight used for perturbation resampling
</p>
</td></tr>
<tr><td><code id="pred.smooth.surv.new_+3A_extrapolate">extrapolate</code></td>
<td>


<p>TRUE or FALSE; indicates whether local constant extrapolation should be used
</p>
</td></tr>
</table>


<h3>Details</h3>


<p>Details are included in the documentation for early.delta.test
</p>


<h3>Value</h3>






<p>conditional probability of survival past t 
</p>


<h3>Author(s)</h3>


<p>Layla Parast
</p>

<hr>
<h2 id='recover.B'>
Recover an estimate of the treatment effect at time t in Study B
</h2><span id='topic+recover.B'></span>

<h3>Description</h3>

<p>Recover an estimate of the treatment effect at time t in Study B
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recover.B(Axzero, Adeltazero, Aszero, Axone, Adeltaone, Asone, Bxzero, Bdeltazero, 
Bszero, Bxone, Bdeltaone, Bsone, t, landmark, extrapolate = T, transform = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recover.B_+3A_axzero">Axzero</code></td>
<td>


<p>observed event times in the control group in  Study A
</p>
</td></tr>
<tr><td><code id="recover.B_+3A_adeltazero">Adeltazero</code></td>
<td>


<p>event/censoring indicators in the control group in Study A
</p>
</td></tr>
<tr><td><code id="recover.B_+3A_aszero">Aszero</code></td>
<td>


<p>surrogate marker values in the control group in Study A, NA for individuals not observable at the time the surrogate marker was measured
</p>
</td></tr>
<tr><td><code id="recover.B_+3A_axone">Axone</code></td>
<td>


<p>observed event times in the treatment group in  Study A
</p>
</td></tr>
<tr><td><code id="recover.B_+3A_adeltaone">Adeltaone</code></td>
<td>


<p>event/censoring indicators in the treatment group in Study A
</p>
</td></tr>
<tr><td><code id="recover.B_+3A_asone">Asone</code></td>
<td>


<p>surrogate marker values in the treatment group in Study A, NA for individuals not observable at the time the surrogate marker was measured
</p>
</td></tr>
<tr><td><code id="recover.B_+3A_bxzero">Bxzero</code></td>
<td>


<p>observed event times in the control group in  Study B
</p>
</td></tr>
<tr><td><code id="recover.B_+3A_bdeltazero">Bdeltazero</code></td>
<td>


<p>event/censoring indicators in the control group in Study B
</p>
</td></tr>
<tr><td><code id="recover.B_+3A_bszero">Bszero</code></td>
<td>


<p>surrogate marker values in the control group in Study B, NA for individuals not observable at the time the surrogate marker was measured
</p>
</td></tr>
<tr><td><code id="recover.B_+3A_bxone">Bxone</code></td>
<td>


<p>observed event times in the treatment group in  Study B
</p>
</td></tr>
<tr><td><code id="recover.B_+3A_bdeltaone">Bdeltaone</code></td>
<td>


<p>event/censoring indicators in the treatment group in  Study B
</p>
</td></tr>
<tr><td><code id="recover.B_+3A_bsone">Bsone</code></td>
<td>


<p>surrogate marker values in the treatment group in Study B, NA for individuals not observable at the time the surrogate marker was measured
</p>
</td></tr>
<tr><td><code id="recover.B_+3A_t">t</code></td>
<td>


<p>time of interest
</p>
</td></tr>
<tr><td><code id="recover.B_+3A_landmark">landmark</code></td>
<td>


<p>landmark time of interest, t0
</p>
</td></tr>
<tr><td><code id="recover.B_+3A_extrapolate">extrapolate</code></td>
<td>


<p>TRUE or FALSE; indicates whether local constant extrapolation should be used, default is TRUE
</p>
</td></tr>
<tr><td><code id="recover.B_+3A_transform">transform</code></td>
<td>


<p>TRUE or FALSE; indicates whether a transformation should be used, default is FALSE
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Assume there are two randomized studies of a treatment effect, a prior study (Study A) and a current study (Study B). Study A was completed up to some time t, while Study B was stopped at time <code class="reqn">t_0&lt;t</code>. In both studies, a surrogate marker was measured at time <code class="reqn">t_0</code> for individuals still observable at <code class="reqn">t_0</code>. Let <code class="reqn">G</code> be the binary treatment indicator with <code class="reqn">G=1</code> for treatment and <code class="reqn">G=0</code> for control and we assume throughout that subjects are randomly assigned to a treatment group at baseline. Let <code class="reqn">T_K^{(1)}</code> and <code class="reqn">T_K^{(0)}</code> denote the time of the primary outcome of interest, death for example, under the treatment and under the control, respectively, in Study K. Let <code class="reqn">S_K^{(1)}</code> and <code class="reqn">S_K^{(0)}</code> denote the surrogate marker measured at time <code class="reqn">t_0</code> under the treatment and the control, respectively, in Study K.
</p>
<p>The treatment effect quantity of interest, <code class="reqn">\Delta_K(t)</code>, is the difference in survival rates by time <code class="reqn">t</code> under treatment versus control,
</p>
<p style="text-align: center;"><code class="reqn"> \Delta_K(t)=E\{ I(T_K^{(1)}&gt;t)\} - E\{I(T_K^{(0)}&gt;t)\} = P(T_K^{(1)}&gt;t) - P(T_K^{(0)}&gt;t)</code>
</p>

<p>where <code class="reqn">t&gt;t_0</code>. Here, we recover an estimate of <code class="reqn">\Delta_B(t)</code> using Study B information (which stopped follow-up at time <code class="reqn">t_0&lt;t</code>) and Study A information (which has follow-up information through time t). The estimate is obtained as </p>
<p style="text-align: center;"><code class="reqn">\hat{\Delta}_{EB}(t,t_0)/ \hat{R}_{SA}(t,t_0)</code>
</p>

<p>where <code class="reqn">\hat{\Delta}_{EB}(t,t_0)</code> is the early treatment effect estimate in Study B, described in the early.delta.test documention, and <code class="reqn">\hat{R}_{SA}(t,t_0)</code> is the proportion of treatment effect explained by the surrogate marker information at <code class="reqn">t_0</code> in Study A. This proportion is calculated as <code class="reqn">\hat{R}_{SA}(t,t_0) =\hat{\Delta}_{EA}(t,t_0)/\hat{\Delta}_A(t)</code>
where </p>
<p style="text-align: center;"><code class="reqn">\hat{\Delta}_A(t)=n_{A1}^{-1}\sum_{i=1}^{n_{A1}}\frac{I(X_{Ai}^{(1)}&gt;t)}{\hat{W}_{A1}^C(t)}-n_{A0}^{-1}\sum_{i=1}^{n_{A0}}\frac{I(X_{Ai}^{(0)}&gt;t)}{\hat{W}_{A0}^C(t)},</code>
</p>

<p>and <code class="reqn">\hat{\Delta}_{EA}(t,t_0)</code> is parallel to <code class="reqn">\hat{\Delta}_{EB}(t,t_0)</code> except replacing
<code class="reqn">n_{A0}^{-1} \sum_{i=1}^{n_{A0}} \hat{r}_A^{(0)}(t|S_{Ai}^{(0)}, t_0) \frac{I(X_{Ai}^{(0)} &gt; t_0)}{\hat{W}_{A0}^C(t_0)}</code>
by <code class="reqn">n_{A0}^{-1}\sum_{i=1}^{n_{A0}}\hat{W}_{A0}^C(t)^{-1}I(X_{Ai}^{(0)}&gt;t),</code> and <code class="reqn">\hat{W}^C_{Ag}(\cdot)</code> is the Kaplan-Meier estimator of the survival function for <code class="reqn">C_{A}^{(g)}</code> for <code class="reqn">g=0,1</code>.  
</p>
<p>Perturbation resampling is used to provide a standard error estimate for the estimate of <code class="reqn">\Delta_B(t)</code> and a confidence interval.
</p>


<h3>Value</h3>

<table>
<tr><td><code>recovered.deltaB</code></td>
<td>
<p>The recovered estimate of <code class="reqn">\Delta_B(t)</code>.</p>
</td></tr>
<tr><td><code>sd.recovered.deltaB</code></td>
<td>
<p>The standard error estimate of the recovered estimate of <code class="reqn">\Delta_B(t)</code>.</p>
</td></tr>
<tr><td><code>conf.quantile.recovered.deltaB</code></td>
<td>
<p>A confidence interval for the recovered estimate of <code class="reqn">\Delta_B(t)</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>


<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast L, Cai T, Tian L (2019). Using a Surrogate Marker for Early Testing of a Treatment Effect. Biometrics, In press.
</p>
<p>Parast L, Cai T and Tian L (2017). Evaluating Surrogate Marker Information using Censored Data. Statistics in Medicine, 36(11): 1767-1782.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(dataA)
data(dataB)
recover.B(Axzero = dataA$x0, Adeltazero = dataA$delta0, Aszero = dataA$s0, Axone 
= dataA$x1, Adeltaone = dataA$delta1, Asone = dataA$s1, Bxzero = dataB$x0, Bdeltazero
= dataB$delta0, Bszero = dataB$s0, Bxone = dataB$x1, Bdeltaone = dataB$delta1, Bsone 
= dataB$s1, t=1, landmark=0.5,  extrapolate = TRUE)

recover.B(Axzero = dataA$x0, Adeltazero = dataA$delta0, Aszero = dataA$s0, Axone 
= dataA$x1, Adeltaone = dataA$delta1, Asone = dataA$s1, Bxzero = dataB$x0, Bdeltazero
= dataB$delta0, Bszero = dataB$s0, Bxone = dataB$x1, Bdeltaone = dataB$delta1, Bsone 
= dataB$s1, t=0.75, landmark=0.5,  extrapolate = TRUE)


</code></pre>

<hr>
<h2 id='var.delta.eb'>
Variance estimation
</h2><span id='topic+var.delta.eb'></span>

<h3>Description</h3>


<p>Variance estimation, generally not called directly by the user
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var.delta.eb(Axzero, Adeltazero, Aszero, Bxone, Bdeltaone, 
Bsone, Bxzero, Bdeltazero, Bszero, t, landmark = landmark, 
extrapolate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="var.delta.eb_+3A_axzero">Axzero</code></td>
<td>


<p>observed event times in the control group in  Study A
</p>
</td></tr>
<tr><td><code id="var.delta.eb_+3A_adeltazero">Adeltazero</code></td>
<td>


<p>event/censoring indicators in the control group in Study A
</p>
</td></tr>
<tr><td><code id="var.delta.eb_+3A_aszero">Aszero</code></td>
<td>


<p>surrogate marker values in the control group in Study A, NA for individuals not observable at the time the surrogate marker was measured
</p>
</td></tr>
<tr><td><code id="var.delta.eb_+3A_bxone">Bxone</code></td>
<td>


<p>observed event times in the treatment group in  Study B
</p>
</td></tr>
<tr><td><code id="var.delta.eb_+3A_bdeltaone">Bdeltaone</code></td>
<td>


<p>event/censoring indicators in the treatment group in  Study B
</p>
</td></tr>
<tr><td><code id="var.delta.eb_+3A_bsone">Bsone</code></td>
<td>


<p>surrogate marker values in the treatment group in Study B, NA for individuals not observable at the time the surrogate marker was measured
</p>
</td></tr>
<tr><td><code id="var.delta.eb_+3A_bxzero">Bxzero</code></td>
<td>


<p>observed event times in the control group in  Study B
</p>
</td></tr>
<tr><td><code id="var.delta.eb_+3A_bdeltazero">Bdeltazero</code></td>
<td>


<p>event/censoring indicators in the control group in Study B
</p>
</td></tr>
<tr><td><code id="var.delta.eb_+3A_bszero">Bszero</code></td>
<td>


<p>surrogate marker values in the control group in Study B, NA for individuals not observable at the time the surrogate marker was measured
</p>
</td></tr>
<tr><td><code id="var.delta.eb_+3A_t">t</code></td>
<td>


<p>time of interest
</p>
</td></tr>
<tr><td><code id="var.delta.eb_+3A_landmark">landmark</code></td>
<td>


<p>landmark time of interest, t0
</p>
</td></tr>
<tr><td><code id="var.delta.eb_+3A_extrapolate">extrapolate</code></td>
<td>


<p>TRUE or FALSE; indicates whether local constant extrapolation should be used, default is TRUE
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Variance estimation using the closed form expression under the null hypothesis of no treatment effect; more details are included in the documentation for early.delta.test.
</p>


<h3>Value</h3>

<p>Variance estimate for <code class="reqn">\sqrt{n_{B}}\hat{\Delta}_{EB}(t,t_0)</code>
</p>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast L, Cai T, Tian L (2019). Using a Surrogate Marker for Early Testing of a Treatment Effect. Biometrics, 75(4):1253-1263.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dataA)
data(dataB)

var.delta.eb(Axzero = dataA$x0, Adeltazero = dataA$delta0, 
Aszero = dataA$s0, Bxone = dataB$x1, Bdeltaone = dataB$delta1, 
Bsone = dataB$s1, Bxzero = dataB$x0, Bdeltazero = dataB$delta0, 
Bszero = dataB$s0, t=1, landmark=0.5,  extrapolate = TRUE)

</code></pre>

<hr>
<h2 id='VTM'>

Repeats a row.
</h2><span id='topic+VTM'></span>

<h3>Description</h3>


<p>Helper function; this function creates a matrix that repeats vc, dm times where each row is equal to the vc vector. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VTM(vc, dm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VTM_+3A_vc">vc</code></td>
<td>


<p>the vector to repeat.
</p>
</td></tr>
<tr><td><code id="VTM_+3A_dm">dm</code></td>
<td>


<p>number of rows.
</p>
</td></tr>
</table>


<h3>Value</h3>






<p>a matrix that repeats vc, dm times where each row is equal to the vc vector
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
