<!DOCTYPE html><html><head><title>Help for package MVT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MVT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#companies'><p>Financial data</p></a></li>
<li><a href='#cork'><p>Cork borings</p></a></li>
<li><a href='#envelope.student'><p>QQ-plot with simulated envelopes</p></a></li>
<li><a href='#equicorrelation.test'><p>Equicorrelation test</p></a></li>
<li><a href='#examScor'><p>Open/Closed book data</p></a></li>
<li><a href='#homogeneity.test'><p>Test of variance homogeneity of correlated variances</p></a></li>
<li><a href='#kurtosis.student'><p>Mardia's multivariate kurtosis coefficient</p></a></li>
<li><a href='#MVT.control'><p>Set control parameters</p></a></li>
<li><a href='#PSG'><p>Transient sleep disorder</p></a></li>
<li><a href='#rmt'><p>Multivariate-t random deviates</p></a></li>
<li><a href='#Student'><p>Family object for the multivariate t-distribution</p></a></li>
<li><a href='#studentFit'><p>Estimation of mean and covariance using the multivariate t-distribution</p></a></li>
<li><a href='#WH.student'><p>Wilson-Hilferty transformation</p></a></li>
<li><a href='#WindSpeed'><p>Wind speed data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3-8</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-01-26</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation and Testing for the Multivariate t-Distribution</td>
</tr>
<tr>
<td>Author:</td>
<td>Felipe Osorio (&lt;https://orcid.org/0000-0002-4675-5201&gt;)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Felipe Osorio &lt;felipe.osorios@usm.cl&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Routines to perform estimation and inference under the multivariate
  t-distribution &lt;<a href="https://doi.org/10.1007%2Fs10182-022-00468-2">doi:10.1007/s10182-022-00468-2</a>&gt;. Currently, the following methodologies 
  are implemented: multivariate mean and covariance estimation, hypothesis testing 
  about equicorrelation and homogeneity of variances, the Wilson-Hilferty transformation, 
  QQ-plots with envelopes and random variate generation.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.5.0), fastmatrix</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>fastmatrix</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, utils, graphics</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://mvt.mat.utfsm.cl/">http://mvt.mat.utfsm.cl/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-26 14:22:13 UTC; root</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-27 09:30:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='companies'>Financial data</h2><span id='topic+companies'></span>

<h3>Description</h3>

<p>Data extracted from Standard &amp; Poor's Compustat PC Plus. This dataset has been used to illustrate some influence diagnostic techniques.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(companies)</code></pre>


<h3>Format</h3>

<p>A data frame with 26 observations on the following 3 variables.
</p>

<dl>
<dt>book</dt><dd><p> book value in dollars per share at the end of 1992.</p>
</dd>
<dt>net</dt><dd><p> net sales in millions of dollars in 1992.</p>
</dd>
<dt>ratio</dt><dd><p> sales to assets ratio in 1992.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Hadi, A.S., and Nyquist, H. (1999).
Frechet distance as a tool for diagnosing multivariate data.
<em>Linear Algebra and Its Applications</em> <b>289</b>, 183-201.
</p>
<p>Hadi, A.S., and Son, M.S. (1997).
Detection of unusual observations in regression and multivariate data.
In: A. Ullah, D.E.A. Giles (Eds.) <em>Handbook of Applied Economic Statistics</em>.
Marcel Dekker, New York. pp. 441-463.
</p>

<hr>
<h2 id='cork'>Cork borings</h2><span id='topic+cork'></span>

<h3>Description</h3>

<p>Measurements of the weight of cork borings taken from the north (N), east (E), south (S), and west (W) directions of 28 trees.
It is of interest to compare the bark thickness (and hence weight) in the four directions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cork)</code></pre>


<h3>Format</h3>

<p>A data frame with 28 observations on the following 4 variables.
</p>

<dl>
<dt>N</dt><dd><p> north.</p>
</dd>
<dt>E</dt><dd><p> east.</p>
</dd>
<dt>S</dt><dd><p> south.</p>
</dd>
<dt>W</dt><dd><p> west.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Mardia, K.V., Kent, J.T., and Bibby, J.M. (1979).
<em>Multivariate Analysis</em>. Academic Press, London.
</p>

<hr>
<h2 id='envelope.student'>QQ-plot with simulated envelopes</h2><span id='topic+envelope.student'></span>

<h3>Description</h3>

<p>Constructs a normal QQ-plot using a Wilson-Hilferty transformation for the estimated Mahalanobis distances obtained from the fitting procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>envelope.student(object, reps = 50, conf = 0.95, plot.it = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="envelope.student_+3A_object">object</code></td>
<td>
<p> an object of class <code>'studentFit'</code> representing the fitted model.</p>
</td></tr>
<tr><td><code id="envelope.student_+3A_reps">reps</code></td>
<td>
<p> number of simulated point patterns to be generated when computing the envelopes. The default number is 50.</p>
</td></tr>
<tr><td><code id="envelope.student_+3A_conf">conf</code></td>
<td>
<p> the confidence level of the envelopes required. The default is to find 95% confidence envelopes.</p>
</td></tr>
<tr><td><code id="envelope.student_+3A_plot.it">plot.it</code></td>
<td>
<p> if TRUE it will draw the corresponding plot, if FALSE it will only return the computed values. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components :
</p>
<table>
<tr><td><code>transformed</code></td>
<td>
<p> a vector with the <code>z</code>-scores obtained from the Wilson-Hilferty transformation.</p>
</td></tr>
<tr><td><code>envelope</code></td>
<td>
<p> a matrix with two columns corresponding to the values of the lower and upper pointwise confidence
envelope.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Atkinson, A.C. (1985).
<em>Plots, Transformations and Regression</em>.
Oxford University Press, Oxford.
</p>
<p>Osorio, F., Galea, M., Henriquez, C., Arellano-Valle, R. (2023). 
Addressing non-normality in multivariate analysis using the t-distribution. 
<em>AStA Advances in Statistical Analysis</em>. doi: <a href="https://doi.org/10.1007/s10182-022-00468-2">10.1007/s10182-022-00468-2</a>
</p>


<h3>See Also</h3>

<p><code><a href="fastmatrix.html#topic+wilson.hilferty">wilson.hilferty</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PSG)
fit &lt;- studentFit(~ manual + automated, data = PSG, family = Student(eta = 0.25))
envelope.student(fit, reps = 500, conf = 0.95)
</code></pre>

<hr>
<h2 id='equicorrelation.test'>Equicorrelation test</h2><span id='topic+equicorrelation.test'></span>

<h3>Description</h3>

<p>Performs several test for testing that the covariance matrix follows an equicorrelation (or compound symmetry) structure.
Likelihood ratio test, score, Wald and gradient can be used as a test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>equicorrelation.test(object, test = "LRT")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="equicorrelation.test_+3A_object">object</code></td>
<td>
<p> object of class <code>'studentFit'</code> representing the fitted model.</p>
</td></tr>
<tr><td><code id="equicorrelation.test_+3A_test">test</code></td>
<td>
<p> test statistic to be used. One of &quot;LRT&quot; (default), &quot;Wald&quot;, &quot;score&quot; or &quot;gradient&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class 'equicorrelation.test' with the following elements:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p> value of the statistic, i.e. the value of either Likelihood ratio test, Wald, score or gradient test.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p> the degrees of freedom for the test statistic, which is chi-square distributed.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p> the p-value for the test.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p> the estimated covariance matrix.</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p> the hypothesized value for the covariance matrix.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> a character string indicating what type of test was performed.</p>
</td></tr>
<tr><td><code>null.fit</code></td>
<td>
<p> a list representing the fitted model under the null hypothesis.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p> name of the data used in the test.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Sutradhar, B.C. (1993).
Score test for the covariance matrix of the elliptical t-distribution.
<em>Journal of Multivariate Analysis</em> <b>46</b>, 1-12.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(examScor)
fit &lt;- studentFit(examScor, family = Student(eta = .25))
fit

z &lt;- equicorrelation.test(fit, test = "LRT")
z
</code></pre>

<hr>
<h2 id='examScor'>Open/Closed book data</h2><span id='topic+examScor'></span>

<h3>Description</h3>

<p>Dataset from Mardia, Kent and Bibby on 88 students who took examinations in five subjects. The first two subjects were tested
with closed book exams and the last three were tested with open book exams.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(examScor)</code></pre>


<h3>Format</h3>

<p>A data frame with 88 observations on the following 5 variables.
</p>

<dl>
<dt>mechanics</dt><dd><p> mechanics, closed book exam.</p>
</dd>
<dt>vectors</dt><dd><p> vectors, closed book exam.</p>
</dd>
<dt>algebra</dt><dd><p> algebra, open book exam.</p>
</dd>
<dt>analysis</dt><dd><p> analysis, open book exam.</p>
</dd>
<dt>statistics</dt><dd><p> statistics, open book exam.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Mardia, K.V., Kent, J.T., and Bibby, J.M. (1979).
<em>Multivariate Analysis</em>. Academic Press, London.
</p>

<hr>
<h2 id='homogeneity.test'>Test of variance homogeneity of correlated variances</h2><span id='topic+homogeneity.test'></span>

<h3>Description</h3>

<p>Performs several test for testing equality of <code class="reqn">p \ge 2</code> correlated variables. Likelihood ratio test,
score, Wald and gradient can be used as a test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>homogeneity.test(object, test = "LRT")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="homogeneity.test_+3A_object">object</code></td>
<td>
<p> object of class <code>'studentFit'</code> representing the fitted model.</p>
</td></tr>
<tr><td><code id="homogeneity.test_+3A_test">test</code></td>
<td>
<p> test statistic to be used. One of &quot;LRT&quot; (default), &quot;Wald&quot;, &quot;score&quot; or &quot;gradient&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class 'homogeneity.test' with the following elements:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p> value of the statistic, i.e. the value of either Likelihood ratio test, Wald, score or gradient test.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p> the degrees of freedom for the test statistic, which is chi-square distributed.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p> the p-value for the test.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p> the estimated covariance matrix.</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p> the hypothesized value for the covariance matrix.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> a character string indicating what type of test was performed.</p>
</td></tr>
<tr><td><code>null.fit</code></td>
<td>
<p> a list representing the fitted model under the null hypothesis.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p> name of the data used in the test.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Harris, P. (1985).
Testing the variance homogeneity of correlated variables.
<em>Biometrika</em> <b>72</b>, 103-107.
</p>
<p>Modarres, R. (1993).
Testing the equality of dependent variables.
<em>Biometrical Journal</em> <b>7</b>, 785-790.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(examScor)
fit &lt;- studentFit(examScor, family = Student(eta = .25))
fit

z &lt;- homogeneity.test(fit, test = "LRT")
z
</code></pre>

<hr>
<h2 id='kurtosis.student'>Mardia's multivariate kurtosis coefficient</h2><span id='topic+kurtosis.student'></span>

<h3>Description</h3>

<p>This function computes the kurtosis of a multivariate distribution and estimates the kurtosis parameter for the t-distribution using the method of moments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kurtosis.student(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kurtosis.student_+3A_x">x</code></td>
<td>
<p> vector or matrix of data with, say, p columns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components :
</p>
<table>
<tr><td><code>kurtosis</code></td>
<td>
<p> returns the value of Mardia's multivariate kurtosis.</p>
</td></tr>
<tr><td><code>kappa</code></td>
<td>
<p> returns the excess kurtosis related to a multivariate t-distribution.</p>
</td></tr>
<tr><td><code>eta</code></td>
<td>
<p> estimated shape (kurtosis) parameter using the methods of moments, only valid if <code class="reqn">0 \le \eta &lt; 1/4</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Mardia, K.V. (1970).
Measures of multivariate skewness and kurtosis with applications.
<em>Biometrika</em> <b>57</b>, 519-530.
</p>
<p>Osorio, F., Galea, M., Henriquez, C., Arellano-Valle, R. (2023). 
Addressing non-normality in multivariate analysis using the t-distribution. 
<em>AStA Advances in Statistical Analysis</em>. doi: <a href="https://doi.org/10.1007/s10182-022-00468-2">10.1007/s10182-022-00468-2</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(companies)
kurtosis.student(companies)
</code></pre>

<hr>
<h2 id='MVT.control'>Set control parameters</h2><span id='topic+MVT.control'></span>

<h3>Description</h3>

<p>Allows users to set control parameters for the estimation routine available in <code>MVT</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MVT.control(maxiter = 2000, tolerance = 1e-6, fix.shape = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MVT.control_+3A_maxiter">maxiter</code></td>
<td>
<p>  maximum number of iterations. The default is 2000.</p>
</td></tr>
<tr><td><code id="MVT.control_+3A_tolerance">tolerance</code></td>
<td>
<p>  the relative tolerance in the iterative algorithm.</p>
</td></tr>
<tr><td><code id="MVT.control_+3A_fix.shape">fix.shape</code></td>
<td>
<p>  whether the shape parameter should be kept fixed in
the fitting processes. The default is <code>fix.shape = FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of control arguments to be used in a call to <code><a href="#topic+studentFit">studentFit</a></code>.
</p>
<p>A call to <code>MVT.control</code> can be used directly in the <code>control</code> argument 
of the call to <code><a href="#topic+studentFit">studentFit</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ctrl &lt;- MVT.control(maxiter = 500, tol = 1e-04, fix.shape = TRUE)
data(PSG)
studentFit(~ manual + automated, data = PSG, family = Student(eta = 0.25), 
  control = ctrl)
</code></pre>

<hr>
<h2 id='PSG'>Transient sleep disorder</h2><span id='topic+PSG'></span>

<h3>Description</h3>

<p>Clinical study designed to compare the automated and semi-automated scoring of 
Polysomnographic (PSG) recordings used to diagnose transient sleep disorders. 
The study considered 82 patients who were given a sleep-inducing drug (Zolpidem 
10 mg). Measurements of latency to persistent sleep (LPS: lights out to the 
beginning of 10 consecutive minutes of uninterrupted sleep) were obtained using 
six different methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PSG)</code></pre>


<h3>Format</h3>

<p>A data frame with 82 observations on the following 3 variables.
</p>

<dl>
<dt>manual</dt><dd><p> fully manual scoring.</p>
</dd>
<dt>automated</dt><dd><p> automated scoring by the Morpheus software.</p>
</dd>
<dt>partial</dt><dd><p> Morpheus automated scoring with manual review.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Svetnik, V., Ma, J., Soper, K.A., Doran, S., Renger, J.J., Deacon, S., Koblan, K.S. (2007).
Evaluation of automated and semi-automated scoring of polysomnographic recordings from a clinical trial using zolpidem in the treatment of insomnia.
<em>SLEEP</em> <b>30</b>, 1562-1574.
</p>

<hr>
<h2 id='rmt'>Multivariate-t random deviates</h2><span id='topic+rmt'></span>

<h3>Description</h3>

<p>Random number generation from the multivariate-t distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmt(n = 1, mean = rep(0, nrow(Sigma)), Sigma = diag(length(mean)), eta = .25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmt_+3A_n">n</code></td>
<td>
<p> the number of samples requested</p>
</td></tr>
<tr><td><code id="rmt_+3A_mean">mean</code></td>
<td>
<p> a vector giving the means of each variable</p>
</td></tr>
<tr><td><code id="rmt_+3A_sigma">Sigma</code></td>
<td>
<p> a positive-definite covariance matrix</p>
</td></tr>
<tr><td><code id="rmt_+3A_eta">eta</code></td>
<td>
<p> shape parameter (must be in <code>[0,1/2)</code>). Default value is <code>0.25</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>rmt</code> is an interface to C routines, which make calls to
subroutines from LAPACK. The matrix decomposition is internally done using
the Cholesky decomposition. If <code>Sigma</code> is not non-negative definite then
there will be a warning message.
</p>
<p>This parameterization of the multivariate-t includes the normal distribution 
as a particular case when <code>eta = 0</code>.
</p>


<h3>Value</h3>

<p>If <code>n = 1</code> a vector of the same length as <code>mean</code>, otherwise a
matrix of <code>n</code> rows of random vectors.
</p>


<h3>References</h3>

<p>Devroye, L. (1986).
<em>Non-Uniform Random Variate Generation</em>.
Springer-Verlag, New York.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rt">rt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># covariance matrix
Sigma &lt;- matrix(c(10,3,3,2), ncol = 2)
Sigma

# generate the sample
y &lt;- rmt(n = 1000, Sigma = Sigma)

# scatterplot of a random bivariate t sample with mean vector
# zero and covariance matrix 'Sigma'
par(pty = "s")
plot(y, xlab = "", ylab = "")
title("bivariate t sample (eta = 0.25)", font.main = 1)
</code></pre>

<hr>
<h2 id='Student'>Family object for the multivariate t-distribution</h2><span id='topic+Student'></span><span id='topic+Student.family'></span>

<h3>Description</h3>

<p>Provide a convenient way to specify the details of the model used by function <code><a href="#topic+studentFit">studentFit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Student(eta = .25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Student_+3A_eta">eta</code></td>
<td>
<p> shape parameter for the multivariate t-distribution, must be confined to <code>[0,1/2)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Student</code> is a generic function to create info about the t-distribution which
is passed to the estimation algorithm.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>MyFmly &lt;- Student(eta = .4)
MyFmly
</code></pre>

<hr>
<h2 id='studentFit'>Estimation of mean and covariance using the multivariate t-distribution</h2><span id='topic+studentFit'></span>

<h3>Description</h3>

<p>Estimates the mean vector and covariance matrix assuming the data came from a multivariate
t-distribution: this provides some degree of robustness to outlier without giving a high
breakdown point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>studentFit(x, data, family = Student(eta = .25), covStruct = "UN", subset, na.action, 
control)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="studentFit_+3A_x">x</code></td>
<td>
<p>  a formula or a numeric matrix or an object that can be coerced to a numeric matrix.</p>
</td></tr>
<tr><td><code id="studentFit_+3A_data">data</code></td>
<td>
<p>  an optional data frame (or similar: see <code><a href="stats.html#topic+model.frame">model.frame</a></code>), used only if
<code>x</code> is a formula. By default the variables are taken from <code>environment(formula)</code>.</p>
</td></tr>
<tr><td><code id="studentFit_+3A_family">family</code></td>
<td>
<p> a description of the error distribution to be used in the model.
By default the multivariate t-distribution with 0.25 as shape parameter is considered
(using <code>eta = 0</code> allows to tackle the multivariate normal distribution).</p>
</td></tr>
<tr><td><code id="studentFit_+3A_covstruct">covStruct</code></td>
<td>
<p> a character string specifying the type of covariance structure. The options 
available are: <code>"UN"</code> (unstructured) general covariance matrix with no additional structure
(default), <code>"CS"</code> (compound symmetry) corresponding to a constant correlation or equicorrelation, 
<code>"DIAG"</code> (diagonal) representing a diagonal positive-definite matrix, <code>"HOMO"</code> (homogeneous) 
meaning a covariance matrix with homogeneous variances.</p>
</td></tr>
<tr><td><code id="studentFit_+3A_subset">subset</code></td>
<td>
<p> an optional expression indicating the subset of the rows of
data that should be used in the fitting process.</p>
</td></tr>
<tr><td><code id="studentFit_+3A_na.action">na.action</code></td>
<td>
<p> a function that indicates what should happen when the data contain NAs.</p>
</td></tr>
<tr><td><code id="studentFit_+3A_control">control</code></td>
<td>
<p> a list of control values for the estimation algorithm to replace
the default values returned by the function <code><a href="#topic+MVT.control">MVT.control</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with class <code>'studentFit'</code> containing the following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>  a list containing an image of the <code>studentFit</code> call that produced the object.</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>  the <code><a href="#topic+Student">Student</a></code> object used, with the estimated shape parameters (if requested).</p>
</td></tr>
<tr><td><code>center</code></td>
<td>
<p>  final estimate of the location vector.</p>
</td></tr>
<tr><td><code>Scatter</code></td>
<td>
<p>  final estimate of the scale matrix.</p>
</td></tr>
<tr><td><code>logLik</code></td>
<td>
<p>  the log-likelihood at convergence.</p>
</td></tr>
<tr><td><code>numIter</code></td>
<td>
<p>  the number of iterations used in the iterative algorithm.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>  estimated weights corresponding to the assumed heavy-tailed distribution.</p>
</td></tr>
<tr><td><code>distances</code></td>
<td>
<p>  estimated squared Mahalanobis distances.</p>
</td></tr>
<tr><td><code>eta</code></td>
<td>
<p>  final estimate of the shape parameter, if requested.</p>
</td></tr>
</table>
<p>Generic function <code>print</code> show the results of the fit.
</p>


<h3>References</h3>

<p>Kent, J.T., Tyler, D.E., Vardi, Y. (1994).
A curious likelihood identity for the multivariate t-distribution.
<em>Communications in Statistics: Simulation and Computation</em>
<b>23</b>, 441-453.
</p>
<p>Lange, K., Little, R.J.A., Taylor, J.M.G. (1989).
Robust statistical modeling using the t distribution.
<em>Journal of the American Statistical Association</em>
<b>84</b>, 881-896.
</p>
<p>Osorio, F., Galea, M., Henriquez, C., Arellano-Valle, R. (2023).
Addressing non-normality in multivariate analysis using the <em>t</em>-distribution. 
<em>AStA Advances in Statistical Analysis</em>. doi: <a href="https://doi.org/10.1007/s10182-022-00468-2">10.1007/s10182-022-00468-2</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+cov">cov</a></code>, <code><a href="MASS.html#topic+cov.rob">cov.rob</a></code>, <code><a href="MASS.html#topic+cov.trob">cov.trob</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PSG)
fit &lt;- studentFit(~ manual + automated, data = PSG, family = Student(eta = 0.25))
fit
</code></pre>

<hr>
<h2 id='WH.student'>Wilson-Hilferty transformation</h2><span id='topic+WH.student'></span>

<h3>Description</h3>

<p>Returns the Wilson-Hilferty transformation of random variables with <code class="reqn">F</code> distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WH.student(x, center, cov, eta = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WH.student_+3A_x">x</code></td>
<td>
<p> object of class <code>'studentFit'</code> from which is extracted the estimated Mahalanobis distances of the fitted model.
Also <code>x</code> can be a vector or matrix of data with, say, <code class="reqn">p</code> columns.</p>
</td></tr>
<tr><td><code id="WH.student_+3A_center">center</code></td>
<td>
<p> mean vector of the distribution or second data vector of length <code class="reqn">p</code>. Not required if <code>x</code> have class <code>'studentFit'</code>.</p>
</td></tr>
<tr><td><code id="WH.student_+3A_cov">cov</code></td>
<td>
<p> covariance matrix (<code class="reqn">p</code> by <code class="reqn">p</code>) of the distribution. Not required if <code>x</code> have class <code>'studentFit'</code>.</p>
</td></tr>
<tr><td><code id="WH.student_+3A_eta">eta</code></td>
<td>
<p> shape parameter of the multivariate t-distribution. By default the multivariate normal (<code>eta = 0</code>) is considered.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">F</code> the following random variable:
</p>
<p style="text-align: center;"><code class="reqn">F = \frac{D^2/p}{1-2\eta}</code>
</p>

<p>where <code class="reqn">D^2</code> denotes the squared Mahalanobis distance defined as
</p>
<p style="text-align: center;"><code class="reqn">D^2 = (x - \mu)^T \Sigma^{-1} (x - \mu)</code>
</p>

<p>Thus the Wilson-Hilferty transformation is given by
</p>
<p style="text-align: center;"><code class="reqn">z = \frac{(1 - \frac{2\eta}{9})F^{1/3} - (1 - \frac{2}{9p})}{(\frac{2\eta}{9}F^{2/3} + \frac{2}{9p})^{1/2}}%
  </code>
</p>

<p>and <code class="reqn">z</code> is approximately distributed as a standard normal distribution. This is useful, for instance, in the construction of
QQ-plots.
</p>
<p>For <code>eta = 0</code>, we obtain
</p>
<p style="text-align: center;"><code class="reqn">z = \frac{F^{1/3} - (1 - \frac{2}{9p})}{(\frac{2}{9p})^{1/2}}%
  </code>
</p>

<p>which is the Wilson-Hilferty transformation for chi-square variables.
</p>


<h3>References</h3>

<p>Osorio, F., Galea, M., Henriquez, C., Arellano-Valle, R. (2023).
Addressing non-normality in multivariate analysis using the <em>t</em>-distribution. 
<em>AStA Advances in Statistical Analysis</em>. doi: <a href="https://doi.org/10.1007/s10182-022-00468-2">10.1007/s10182-022-00468-2</a>
</p>
<p>Wilson, E.B., and Hilferty, M.M. (1931).
The distribution of chi-square.
<em>Proceedings of the National Academy of Sciences of the United States of America</em> <b>17</b>, 684-688.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+cov">cov</a></code>, <code><a href="stats.html#topic+mahalanobis">mahalanobis</a></code>, <code><a href="boot.html#topic+envelope">envelope</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(companies)
x &lt;- companies
z &lt;- WH.student(x, center = colMeans(x), cov = cov(x))
par(pty = "s")
qqnorm(z, main = "Transformed distances Q-Q plot")
abline(c(0,1), col = "red", lwd = 2)
</code></pre>

<hr>
<h2 id='WindSpeed'>Wind speed data</h2><span id='topic+WindSpeed'></span>

<h3>Description</h3>

<p>This dataset consists of 278 hourly average wind speed in the Pacific North-West of the 
United States collected at three meteorological towers approximately located on a line 
and ordered from west to east: Goodnoe Hills (gh), Kennewick (kw), and Vansycle (vs). 
The data were collected from 25 February to 30 November 2003 recorded at midnight, a 
time when wind speeds tend to peak.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(WindSpeed)</code></pre>


<h3>Format</h3>

<p>A data frame with 278 observations on the following 3 variables.
</p>

<dl>
<dt>gh</dt><dd><p> Goodnoe Hills.</p>
</dd>
<dt>kw</dt><dd><p> Kennewick.</p>
</dd>
<dt>vs</dt><dd><p> Vansycle.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Azzalini, A., Genton, M.G. (2008).
Robust likelihood methods based on the skew-t and related distributions.
<em>International Statistical Review</em> <b>76</b>, 106-129.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
