<!DOCTYPE html><html><head><title>Help for package MCMCvis</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MCMCvis}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MCMC_data'><p>Simulated MCMC output data</p></a></li>
<li><a href='#MCMC_data2'><p>Simulated MCMC output data - #2</p></a></li>
<li><a href='#MCMCchains'><p>Extract posterior chains from MCMC output</p></a></li>
<li><a href='#MCMCdiag'><p>Diagnostics summaries for models</p></a></li>
<li><a href='#MCMCplot'><p>Caterpillar plots of posterior distributions from MCMC output</p></a></li>
<li><a href='#MCMCpstr'><p>Summarize and extract posterior chains from MCMC output while preserving parameter structure</p></a></li>
<li><a href='#MCMCsummary'><p>Summarize MCMC output</p></a></li>
<li><a href='#MCMCtrace'><p>Trace and density plots from MCMC output</p></a></li>
<li><a href='#MCMCvis-package'><p>The 'MCMCvis' package</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools to Visualize, Manipulate, and Summarize MCMC Output</td>
</tr>
<tr>
<td>Version:</td>
<td>0.16.3</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Casey Youngflesh &lt;caseyyoungflesh@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs key functions for MCMC analysis using minimal code - visualizes, manipulates, and summarizes MCMC output. Functions support simple and straightforward subsetting of model parameters within the calls, and produce presentable and 'publication-ready' output. MCMC output may be derived from Bayesian model output fit with 'Stan', 'NIMBLE', 'JAGS', and other software.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/caseyyoungflesh/MCMCvis">https://github.com/caseyyoungflesh/MCMCvis</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/caseyyoungflesh/MCMCvis/issues">https://github.com/caseyyoungflesh/MCMCvis/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Imports:</td>
<td>coda, rstan, methods, overlapping, colorspace</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat, cmdstanr (&ge; 0.5.0), posterior</td>
</tr>
<tr>
<td>Additional_repositories:</td>
<td><a href="https://mc-stan.org/r-packages/">https://mc-stan.org/r-packages/</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-17 16:03:10 UTC; caseyyoungflesh</td>
</tr>
<tr>
<td>Author:</td>
<td>Casey Youngflesh <a href="https://orcid.org/0000-0001-6343-3311"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Christian Che-Castaldo
    <a href="https://orcid.org/0000-0002-7670-2178"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Tyler Hardy [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-17 22:40:24 UTC</td>
</tr>
</table>
<hr>
<h2 id='MCMC_data'>Simulated MCMC output data</h2><span id='topic+MCMC_data'></span>

<h3>Description</h3>

<p>Sample MCMC output containing 12 parameters - <code>alpha[1]</code>, ... , <code>alpha[6]</code>, <code>beta[1]</code>, ... , <code>beta[6]</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCMC_data
</code></pre>


<h3>Format</h3>

<p><code>mcmc.list</code> object with 3 chains for each parameter, 6000 iterations for each chain.
</p>

<hr>
<h2 id='MCMC_data2'>Simulated MCMC output data - #2</h2><span id='topic+MCMC_data2'></span>

<h3>Description</h3>

<p>Sample MCMC output containing 12 parameters - <code>alpha[1]</code>, ... , <code>alpha[6]</code>, <code>beta[1]</code>, ... , <code>beta[6]</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCMC_data2
</code></pre>


<h3>Format</h3>

<p><code>mcmc.list</code> object with 3 chains for each parameter, 6000 iterations for each chain.
</p>

<hr>
<h2 id='MCMCchains'>Extract posterior chains from MCMC output</h2><span id='topic+MCMCchains'></span>

<h3>Description</h3>

<p>Extract posterior chains from MCMC output for specific parameters of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCMCchains(
  object,
  params = "all",
  excl = NULL,
  ISB = TRUE,
  exact = TRUE,
  mcmc.list = FALSE,
  chain_num = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCMCchains_+3A_object">object</code></td>
<td>
<p>Object containing MCMC output. See DETAILS below.</p>
</td></tr>
<tr><td><code id="MCMCchains_+3A_params">params</code></td>
<td>
<p>Character string (or vector of character strings) denoting parameters of interest.
</p>
<p>Default <code>'all'</code> returns chains for all parameters.</p>
</td></tr>
<tr><td><code id="MCMCchains_+3A_excl">excl</code></td>
<td>
<p>Character string (or vector of character strings) denoting parameters to exclude. Used in conjunction with <code>params</code> argument to select parameters of interest.</p>
</td></tr>
<tr><td><code id="MCMCchains_+3A_isb">ISB</code></td>
<td>
<p>Ignore Square Brackets (ISB). Logical specifying whether square brackets should be ignored in the <code>params</code> and <code>excl</code> arguments. If <code>TRUE</code>, square brackets are ignored. If <code>FALSE</code>, square brackets are not ignored.  This allows partial names to be used when specifying parameters of interest. Use <code>exact</code> argument to specify whether input from <code>params</code> and <code>excl</code> arguments should be matched exactly.</p>
</td></tr>
<tr><td><code id="MCMCchains_+3A_exact">exact</code></td>
<td>
<p>Logical specifying whether input from <code>params</code> and <code>excl</code> arguments should be matched exactly (after ignoring square brackets if <code>ISB = FALSE</code>). If <code>TRUE</code>, input from <code>params</code> and <code>excl</code> are matched exactly (after taking <code>ISB</code> argument into account). If <code>FALSE</code>, input from <code>params</code> and <code>excl</code> are matched using regular expression format (after taking <code>ISB</code> argument into account).</p>
</td></tr>
<tr><td><code id="MCMCchains_+3A_mcmc.list">mcmc.list</code></td>
<td>
<p>Logical specifying whether to return an mcmc.list. If <code>TRUE</code>, an <code>mcmc.list</code> object is returned, rather than a matrix.</p>
</td></tr>
<tr><td><code id="MCMCchains_+3A_chain_num">chain_num</code></td>
<td>
<p>Numeric - specifies posterior chain number. When a value is specified, posterior for only that chain is output. Useful for determining the last iteration for each parameter, to be used as initial values in a subsequent model, to effectively 'continue' a model run.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function returns matrix with one parameter per column (for specified parameters). Each iteration is represented as a row. Multiple chains for each parameter are combined to one posterior chain (unless <code>chain_num</code> is specified, in which case only the specified chain will be returned). Parameters are arranged in columns alphabetically.
</p>
<p><code>object</code> argument can be a <code>stanfit</code> object (<code>rstan</code> package), a <code>CmdStanMCMC</code> object (<code>cmdstanr</code> package), a <code>stanreg</code> object (<code>rstanarm</code> package), a <code>brmsfit</code> object (<code>brms</code> package), an <code>mcmc.list</code> object (<code>coda</code> and <code>rjags</code> packages), <code>mcmc</code> object (<code>coda</code> and <code>nimble</code> packages), <code>list</code> object (<code>nimble</code> package), an <code>R2jags</code> model object (<code>R2jags</code> package), a <code>jagsUI</code> model object (<code>jagsUI</code> package), or a matrix containing MCMC chains (each column representing MCMC output for a single parameter, rows representing iterations in the chain). The function automatically detects the object type and proceeds accordingly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Load data
data(MCMC_data)

#Extract MCMC chains
ex &lt;- MCMCchains(MCMC_data)
apply(ex, 2, mean)

#Extract MCMC chains for just 'beta' parameters
ex2 &lt;- MCMCchains(MCMC_data, params = 'beta')
apply(ex2, 2, mean)

#Just 'beta[1]', 'beta[4]', and 'alpha[3]'
ex3 &lt;- MCMCchains(MCMC_data, params = c('beta[1]', 'beta[4]', 'alpha[3]'), 
                 ISB = FALSE, exact = TRUE)
apply(ex3, 2, sd)

</code></pre>

<hr>
<h2 id='MCMCdiag'>Diagnostics summaries for models</h2><span id='topic+MCMCdiag'></span>

<h3>Description</h3>

<p>Model diagnostics and summary. Function reads information embedded in model fit object. Output varies by model fit object type but includes model run inputs, diagnostic information, and parameter summary. See DETAILS below for more information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCMCdiag(
  object,
  file_name,
  dir = getwd(),
  mkdir,
  add_field,
  add_field_names,
  save_object = FALSE,
  obj_name,
  add_obj,
  add_obj_names,
  cp_file,
  cp_file_names,
  open_txt = TRUE,
  summary = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCMCdiag_+3A_object">object</code></td>
<td>
<p>Object containing MCMC output. See DETAILS below.</p>
</td></tr>
<tr><td><code id="MCMCdiag_+3A_file_name">file_name</code></td>
<td>
<p>Character string with name of .txt file to be saved to <code>dir</code> (or <code>mkdir</code> if specified). If not specified, 'MCMCdiag.txt' will be used.</p>
</td></tr>
<tr><td><code id="MCMCdiag_+3A_dir">dir</code></td>
<td>
<p>Character string with directory where file(s) (or directory is argument for <code>mkdir</code> is specified) will be created. Defaults to working directory. An absolute or relative (to the working directory) path can be used.</p>
</td></tr>
<tr><td><code id="MCMCdiag_+3A_mkdir">mkdir</code></td>
<td>
<p>Character string with name of directory to be created. If specified, a directory will be created within the directory specified by <code>dir</code>. If directory exists, '_1' will be appended to specified name.</p>
</td></tr>
<tr><td><code id="MCMCdiag_+3A_add_field">add_field</code></td>
<td>
<p>Object (or vector of objects) to be added to the .txt file.</p>
</td></tr>
<tr><td><code id="MCMCdiag_+3A_add_field_names">add_field_names</code></td>
<td>
<p>Character string (or vector of character strings) specifying the name(s) of the <code>add_field</code> object(s).</p>
</td></tr>
<tr><td><code id="MCMCdiag_+3A_save_object">save_object</code></td>
<td>
<p>Logical specifying whether the model output provided to the function (<code>object</code>) should be saved as a <code>.rds</code> file to <code>dir</code> (or <code>mkdir</code> if specified). Note that <code>.rds</code> files can be opened with <code>rdsRDS()</code>.</p>
</td></tr>
<tr><td><code id="MCMCdiag_+3A_obj_name">obj_name</code></td>
<td>
<p>Character string specifying the file name of the <code>.rds</code> file (created from <code>object</code>) if <code>save_object = TRUE</code>.</p>
</td></tr>
<tr><td><code id="MCMCdiag_+3A_add_obj">add_obj</code></td>
<td>
<p>List with additional object(s) to be saved as <code>.rds</code> files to <code>dir</code> (or <code>mkdir</code> if specified). Objects can be of any types. Multiple objects can be specified. Note that <code>.rds</code> files can be opened with <code>rdsRDS()</code>.</p>
</td></tr>
<tr><td><code id="MCMCdiag_+3A_add_obj_names">add_obj_names</code></td>
<td>
<p>Character string (or vector of character strings) specifying the name(s) of the objects to be saved as <code>.rds</code> files, specified with <code>add_obj</code>.</p>
</td></tr>
<tr><td><code id="MCMCdiag_+3A_cp_file">cp_file</code></td>
<td>
<p>Character string (or vector of character strings) specifying file(s) to be copied to <code>dir</code> (or <code>mkdir</code> if specified). Absolute or relative (to the working directory) paths can be used.</p>
</td></tr>
<tr><td><code id="MCMCdiag_+3A_cp_file_names">cp_file_names</code></td>
<td>
<p>Character string (or vector of character strings) specifying new names for files to be copied specified by <code>cp_file</code>. If no argument is provided, the copy names will be identical to the originals.</p>
</td></tr>
<tr><td><code id="MCMCdiag_+3A_open_txt">open_txt</code></td>
<td>
<p>Logical - if <code>open_txt = TRUE</code> .txt file will open in default .txt viewer after being generated.</p>
</td></tr>
<tr><td><code id="MCMCdiag_+3A_summary">summary</code></td>
<td>
<p>Logical specifying whether or not to output summary information from <a href="#topic+MCMCsummary">MCMCsummary</a> at the bottom of the .txt file.</p>
</td></tr>
<tr><td><code id="MCMCdiag_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to <a href="#topic+MCMCsummary">MCMCsummary</a> when generating summary if <code>summary = TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Some diagnostic information is only provided for models fit with particular pieces of software. For example, <code>rstan</code> output includes additional diagnostics related to the NUTS sampler. Output from <code>jagsUI</code> includes runtime information, but output from <code>rjags</code> does not. Note that this information could be fed manually to the function using the <code>add_field</code> argument.
</p>
<p><code>object</code> argument can be a <code>stanfit</code> object (<code>rstan</code> package), a <code>CmdStanMCMC</code> object (<code>cmdstanr</code> package), a <code>stanreg</code> object (<code>rstanarm</code> package), a <code>brmsfit</code> object (<code>brms</code> package), an <code>mcmc.list</code> object (<code>coda</code> and <code>rjags</code> packages), <code>mcmc</code> object (<code>coda</code> and <code>nimble</code> packages), <code>list</code> object (<code>nimble</code> package), an <code>R2jags</code> model object (<code>R2jags</code> package), a <code>jagsUI</code> model object (<code>jagsUI</code> package), or a matrix containing MCMC chains (each column representing MCMC output for a single parameter, rows representing iterations in the chain). The function automatically detects the object type and proceeds accordingly.
</p>
<p>Output presented in .txt file varies by model fit object type but includes: model run time, number of warmup/burn-in iterations, total iterations, thinning rate, number of chains, specified adapt delta, specified max tree depth, specific initial step size, mean accept stat, mean tree depth, mean step size, number of divergent transitions, number max tree depth exceeds, number of chains with BFMI warnings, max Rhat (maximum Rhat of any parameter printed), min n.eff (minimum n.eff of any parameter printed), parameter summary information (passed from <code>MCMCsummary</code>), and any additional information fed to the <code>add_field</code> argument. See documentation for specific software used to fit model for more information on particular diagnostics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Load data
data(MCMC_data)

# MCMCdiag(MCMC_data,
#          #name of .txt file to be saved
#          file_name = 'blog-model-summary-2021-01-15',
#          #directory within which to save .txt file
#          dir = '~/Desktop',
#          #round MCMCsummary output in .txt file to two digits
#          round = 2,
#          #add two fields to .txt file
#          add_field = c(50, '1.0'),
#          #names of two additional fields to add to .txt file
#          add_field_names = c('Time (min)', 'Data version'))

</code></pre>

<hr>
<h2 id='MCMCplot'>Caterpillar plots of posterior distributions from MCMC output</h2><span id='topic+MCMCplot'></span>

<h3>Description</h3>

<p>Visualize posterior distributions from MCMC output for specific parameters of interest using caterpillar plots. Color of median dot represents the overlap of the posterior distribution with 0 (or other specified value).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCMCplot(
  object,
  object2 = NULL,
  params = "all",
  HPD = FALSE,
  ci = c(50, 95),
  excl = NULL,
  ISB = TRUE,
  exact = TRUE,
  ref = 0,
  ref_ovl = FALSE,
  col = "black",
  col2 = "red",
  offset = 0.1,
  rank = FALSE,
  horiz = TRUE,
  xlim,
  ylim,
  xlab,
  ylab,
  main,
  labels,
  guide_lines = FALSE,
  guide_axis = TRUE,
  sz_labels = 1.2,
  sz_med = 1.5,
  sz_thick = 5,
  sz_thin = 2,
  sz_ax = 3,
  sz_ax_txt = 1.3,
  sz_tick_txt = 1.2,
  sz_main_txt = 1.2,
  pos_tick,
  mar = c(5.1, 4.1, 4.1, 2.1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCMCplot_+3A_object">object</code></td>
<td>
<p>Object containing MCMC output. See DETAILS below.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_object2">object2</code></td>
<td>
<p>Optional second object containing MCMC output. If specified, parameter estimates from each model will be displayed in a paired manner. Parameter names for <code>'object'</code> and <code>'object2'</code> must be identical. See DETAILS below.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_params">params</code></td>
<td>
<p>Character string (or vector of character strings) denoting parameters to be plotted.
</p>
<p>Default <code>'all'</code> plots posteriors for all parameters. See VALUE below.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_hpd">HPD</code></td>
<td>
<p>Logical specifying whether to calculate equal-tailed credible intervals (<code>HPD = FALSE</code>) or highest posterior density intervals (<code>HPD = TRUE</code>) for the selected parameters. Default is <code>HPD = FALSE</code>.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_ci">ci</code></td>
<td>
<p>Numeric vector of length 2, where each element is (0,100] and represents the width of an equal-tailed (<code>HPD = FALSE</code>) or highest posterior density (<code>HPD = TRUE</code>) credible interval. The first element of this vector corresponds to the thicker (narrower) credible interval displayed on the plot (default is 0.5) and the second element of this vector corresponds to the thinner (wider) credible interval (default is 0.95). The first credible interval width (<code>ci[1]</code>) must be less than or equal to the width of the second credible interval (<code>ci[2]</code>).</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_excl">excl</code></td>
<td>
<p>Character string (or vector of character strings) denoting parameters to exclude. Used in conjunction with <code>params</code> argument to select parameters of interest.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_isb">ISB</code></td>
<td>
<p>Ignore Square Brackets (ISB). Logical specifying whether square brackets should be ignored in the <code>params</code> and <code>excl</code> arguments. If <code>TRUE</code>, square brackets are ignored. If <code>FALSE</code>, square brackets are not ignored.  This allows partial names to be used when specifying parameters of interest. Use <code>exact</code> argument to specify whether input from <code>params</code> and <code>excl</code> arguments should be matched exactly.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_exact">exact</code></td>
<td>
<p>Logical specifying whether input from <code>params</code> and <code>excl</code> arguments should be matched exactly (after ignoring square brackets if <code>ISB = FALSE</code>). If <code>TRUE</code>, input from <code>params</code> and <code>excl</code> are matched exactly (after taking <code>ISB</code> argument into account). If <code>FALSE</code>, input from <code>params</code> and <code>excl</code> are matched using regular expression format (after taking <code>ISB</code> argument into account).</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_ref">ref</code></td>
<td>
<p>Value indicating where vertical reference line should be created and what value to use a reference for caterpillar median coloration.
</p>
<p>Default is <code>ref = 0</code>.
</p>
<p>Argument <code>NULL</code> will plot no reference line.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_ref_ovl">ref_ovl</code></td>
<td>
<p>Logical specifying whether the style/color of plotted median dots and CI should be changed based on whether the specified credible intervals (50 % and 95 % by default) overlap the reference line. See DETAILS for more information.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_col">col</code></td>
<td>
<p>Character string (or vector of character strings) specifying which color to render estimates on plot. When <code>ref_ovl = TRUE</code>, this argument has no effect and colors plotted will be based on the credible intervals and reference line. Number of specified colors must equal the number of specified parameters or one.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_col2">col2</code></td>
<td>
<p>Character string (or vector of character strings) specifying which color to render estimates on plot for <code>object2</code> (if specified). Number of specified colors must equal the number of specified parameters or one. Red by default.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_offset">offset</code></td>
<td>
<p>Value indicating how much to offset plotted posteriors when <code>object2</code> is specified (i.e., control the amount of space between the two  plotted posteriors for each parameter). The distance from one set of parameters to another corresponds to a value of 1.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_rank">rank</code></td>
<td>
<p>Logical specifying whether output should be ranked. If <code>TRUE</code> posteriors will be ranked in decreasing order (based on specified measure of centrality) from top down.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_horiz">horiz</code></td>
<td>
<p>Logical specifying orientation of plot. If <code>TRUE</code> posteriors will be plotted running horizontally (parallel to the x-axis). If <code>FALSE</code> posteriors will be plotted running vertically (perpendicular to the x-axis).</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_xlim">xlim</code></td>
<td>
<p>Numerical vector of length 2, indicating range of x-axis. Only applicable if <code>horiz = TRUE</code>.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_ylim">ylim</code></td>
<td>
<p>Numerical vector of length 2, indicating range of y-axis. Only applicable if <code>horiz = FALSE</code>.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_xlab">xlab</code></td>
<td>
<p>Character string labeling x-axis. Only applicable if <code>horiz = TRUE</code>.
</p>
<p>Default label is 'Parameter Estimate'. Option <code>NULL</code> will return plot with no label on x-axis.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_ylab">ylab</code></td>
<td>
<p>Character string labeling y-axis. Only applicable if <code>horiz = FALSE</code>.
</p>
<p>Default label is 'Parameter Estimate'. Option <code>NULL</code> will return plot with no label on y-axis.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_main">main</code></td>
<td>
<p>Character string indicating title of plot.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_labels">labels</code></td>
<td>
<p>Character string (or vector of character strings if plotting &gt; 1 parameter) labeling parameter estimates along y-axis (if <code>horiz = FALSE</code>) or x-axis (if <code>horiz = TRUE</code>).
</p>
<p>Default option will use parameter names from <code>object</code>.
</p>
<p>Option <code>NULL</code> will return plot with no labels on axis.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_guide_lines">guide_lines</code></td>
<td>
<p>Logical specifying whether to plot reference lines for each parameter in order to better visualize which parameter names correspond to each posterior.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_guide_axis">guide_axis</code></td>
<td>
<p>Logical specifying whether a second axis should be plotted (x-axis if <code>HORIZ = TRUE</code>, y-axis if <code>HORIZ = FALSE</code>) to help interpret values on plot.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_sz_labels">sz_labels</code></td>
<td>
<p>Number specifying size of text for parameter labels on axis.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_sz_med">sz_med</code></td>
<td>
<p>Number specifying size of points represents posterior medians.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_sz_thick">sz_thick</code></td>
<td>
<p>Number specifying thickness of 50 percent CI line (thicker line).</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_sz_thin">sz_thin</code></td>
<td>
<p>Number specifying thickness of 95 percent CI line (thinner line).</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_sz_ax">sz_ax</code></td>
<td>
<p>Number specifying thickness of axis and ticks.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_sz_ax_txt">sz_ax_txt</code></td>
<td>
<p>Number specifying size of text for axis label.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_sz_tick_txt">sz_tick_txt</code></td>
<td>
<p>Number specifying size of text for tick labels on axis.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_sz_main_txt">sz_main_txt</code></td>
<td>
<p>Number specifying size of text for main title.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_pos_tick">pos_tick</code></td>
<td>
<p>Numeric vector specifying where ticks on axis should be placed.</p>
</td></tr>
<tr><td><code id="MCMCplot_+3A_mar">mar</code></td>
<td>
<p>Numerical vector of length 4 specifying plot margins - (BOTTOM, LEFT, TOP, RIGHT). Changes to the margin should be made within the function rather than using the <code>par</code> call.
</p>
<p>Default is c(5.1, 4.1, 4.1, 2.1) - the R plot default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Points represent posterior medians. Parameters where the smaller specified credible intervals (first value in vector provided to <code>ci</code> argument; 50% by default) overlap 0 (or other value specified by the <code>ref</code> argument) are indicated by 'open' circles and a lighter color than that specified (e.g., gray will be displayed with the default black is specified for <code>col</code>). Parameters where the specific smaller credible intervals DO NOT overlap 0 (or other specified value) AND the larger specified credible intervals (second value in vector provided to <code>ci</code> argument; 95% by default) DO overlap 0 (or other specified value) are indicated by 'closed' circles and a lighter color that that specified. Parameters where the larger specified credible intervals DO NOT overlap 0 (or other specified value) are indicated by 'closed' circles and the color specified (black by default). Thick lines represent the smaller specified credible intervals percent credible intervals (50% by default) while thin lines represent the larger specified credible intervals (95 % by default). <code>ref_ovl = TRUE</code> can be used to enable this feature. When two model objects are supplied to the function (with <code>object</code> and <code>object2</code>) and no argument is supplied to <code>col</code> or <code>col2</code>, light red lines can be interpreted as analogous to gray lines. When <code>ref_ovl = TRUE</code> and a color (or colors) other than the default are specified (with the <code>col</code> and <code>col2</code> arguments) lighter versions of the color specified are used in black of the light gray and/or light red lines.
</p>
<p>When <code>object2</code> is specified, paired caterpillar plots of each parameter are produced. For this reason, parameter names of <code>object</code> and <code>object2</code> specified with the <code>params</code> argument must be identical (to be used for comparing posterior estimates of similar models). <code>col</code> and <code>col2</code> arguments can be specified to change the color of output from <code>object</code> and <code>object2</code>, respectively. By default, output from <code>object</code> is plotted in black and <code>object2</code> is plotted in red. The <code>ref_ovl</code> argument can also be specified.
</p>
<p><code>object</code> argument can be a <code>stanfit</code> object (<code>rstan</code> package), a <code>CmdStanMCMC</code> object (<code>cmdstanr</code> package), a <code>stanreg</code> object (<code>rstanarm</code> package), a <code>brmsfit</code> object (<code>brms</code> package), an <code>mcmc.list</code> object (<code>coda</code> and <code>rjags</code> packages), <code>mcmc</code> object (<code>coda</code> and <code>nimble</code> packages), <code>list</code> object (<code>nimble</code> package), an <code>R2jags</code> model object (<code>R2jags</code> package), a <code>jagsUI</code> model object (<code>jagsUI</code> package), or a matrix containing MCMC chains (each column representing MCMC output for a single parameter, rows representing iterations in the chain). The function automatically detects the object type and proceeds accordingly.
</p>


<h3>Notes</h3>

<p>When specifying <code>rank = TRUE</code> and specifying labels for <code>labels</code>, labels will be applied to parameters before they are ranked.
</p>
<p>Thanks to Cinner et al. 2016, whose Fig. 1 inspired this plot.
</p>


<h3>References</h3>

<p>Cinner, J. E., C. Huchery, M. A. MacNeil, N. A. J. Graham, T. R. McClanahan, J. Maina, E. Maire, J. N. Kittinger, C. C. Hicks, C. Mora, E. H. Allison, S. D'Agata, A. Hoey, D. A. Feary, L. Crowder, I. D. Williams, M. Kulbicki, L. Vigliola, L. Wantiez, G. Edgar, R. D. Stuart-Smith, S. A. Sandin, A. L. Green, M. J. Hardt, M. Beger, A. Friedlander, S. J. Campbell, K. E. Holmes, S. K. Wilson, E. Brokovich, A. J. Brooks, J. J. Cruz-Motta, D. J. Booth, P. Chabanet, C. Gough, M. Tupper, S. C. A. Ferse, U. R. Sumaila, and D. Mouillot. 2016. Bright spots among the world's coral reefs. Nature 535:416-419.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Load data
data(MCMC_data)

#Plot MCMC output
MCMCplot(MCMC_data, labels = NULL)

#Just 'beta' parameters
MCMCplot(MCMC_data, params = 'beta')

#Just 'beta' parameters using highest posterior density intervals
MCMCplot(MCMC_data, params = 'beta', HPD = TRUE)
#Just 'beta[1]', 'beta[4]', and 'alpha[3]'
MCMCplot(MCMC_data, params = c('beta[1]', 'beta[4]', 'alpha[3]'), ISB = FALSE, exact = TRUE)

#Just 'beta[1]', 'beta[4]', and 'alpha[3]' and change the credible interval widths
MCMCplot(MCMC_data, ci = c(50, 89), params = c('beta[1]', 'beta[4]', 'alpha[3]'), 
  ISB = FALSE, exact = TRUE)

#Rank parameters by posterior mean
MCMCplot(MCMC_data, params = 'beta', rank = TRUE)

#Create vertical plot
MCMCplot(MCMC_data, params = 'beta', horiz = FALSE)

</code></pre>

<hr>
<h2 id='MCMCpstr'>Summarize and extract posterior chains from MCMC output while preserving parameter structure</h2><span id='topic+MCMCpstr'></span>

<h3>Description</h3>

<p>Extract summary information and posterior chains from MCMC output (specific function specified) for specific parameters of interest while preserving original parameter structure (i.e., scalar, vector, matrix, array). Function outputs a <code>list</code> with calculated values or posterior chains for each specified parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCMCpstr(
  object,
  params = "all",
  excl = NULL,
  ISB = TRUE,
  exact = TRUE,
  func = mean,
  type = "summary"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCMCpstr_+3A_object">object</code></td>
<td>
<p>Object containing MCMC output. See DETAILS below.</p>
</td></tr>
<tr><td><code id="MCMCpstr_+3A_params">params</code></td>
<td>
<p>Character string (or vector of character strings) denoting parameters to be returned in output.
</p>
<p>Default <code>'all'</code> returns all parameters in output.</p>
</td></tr>
<tr><td><code id="MCMCpstr_+3A_excl">excl</code></td>
<td>
<p>Character string (or vector of character strings) denoting parameters to exclude. Used in conjunction with <code>params</code> argument to select parameters of interest.</p>
</td></tr>
<tr><td><code id="MCMCpstr_+3A_isb">ISB</code></td>
<td>
<p>Ignore Square Brackets (ISB). Logical specifying whether square brackets should be ignored in the <code>params</code> and <code>excl</code> arguments. If <code>TRUE</code>, square brackets are ignored. If <code>FALSE</code>, square brackets are not ignored.  This allows partial names to be used when specifying parameters of interest. Use <code>exact</code> argument to specify whether input from <code>params</code> and <code>excl</code> arguments should be matched exactly.</p>
</td></tr>
<tr><td><code id="MCMCpstr_+3A_exact">exact</code></td>
<td>
<p>Logical specifying whether input from <code>params</code> and <code>excl</code> arguments should be matched exactly (after ignoring square brackets if <code>ISB = FALSE</code>). If <code>TRUE</code>, input from <code>params</code> and <code>excl</code> are matched exactly (after taking <code>ISB</code> argument into account). If <code>FALSE</code>, input from <code>params</code> and <code>excl</code> are matched using regular expression format (after taking <code>ISB</code> argument into account).</p>
</td></tr>
<tr><td><code id="MCMCpstr_+3A_func">func</code></td>
<td>
<p>Function to be performed on MCMC output. When output of specified function is greater than length 1, an extra dimension is added. For instance, output of length 3 for a parameter with dimensions 2x2 results in a 2x2x3 output. Functions that produce output with dimensionality greater than 1 are not permitted. <code>func</code> is ignored when <code>type = 'chains'</code>.</p>
</td></tr>
<tr><td><code id="MCMCpstr_+3A_type">type</code></td>
<td>
<p>Character string specifying whether to return summary information (calculated based on <code>func</code> argument) or posterior chains. Valid options are <code>'summary'</code> and <code>'chains'</code>. When <code>type = 'chains'</code>, the <code>'func'</code> argument is ignored. When <code>type = 'chains'</code>, posterior chains are concatenated and stored in the last dimension in the array for each element (parameter) of the list.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>object</code> argument can be a <code>stanfit</code> object (<code>rstan</code> package), a <code>CmdStanMCMC</code> object (<code>cmdstanr</code> package), a <code>stanreg</code> object (<code>rstanarm</code> package), a <code>brmsfit</code> object (<code>brms</code> package), an <code>mcmc.list</code> object (<code>coda</code> and <code>rjags</code> packages), <code>mcmc</code> object (<code>coda</code> and <code>nimble</code> packages), <code>list</code> object (<code>nimble</code> package), an <code>R2jags</code> model object (<code>R2jags</code> package), a <code>jagsUI</code> model object (<code>jagsUI</code> package), or a matrix containing MCMC chains (each column representing MCMC output for a single parameter, rows representing iterations in the chain). The function automatically detects the object type and proceeds accordingly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Load data
data(MCMC_data)

MCMCpstr(MCMC_data, func = function(x) quantile(x, probs = c(0.01, 0.99)))

</code></pre>

<hr>
<h2 id='MCMCsummary'>Summarize MCMC output</h2><span id='topic+MCMCsummary'></span>

<h3>Description</h3>

<p>Extract summary information from MCMC output (mean, median, quantiles, Gelman-Rubin convergence statistic, number of effective samples, and specified custom metrics)
for specific parameters of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCMCsummary(
  object,
  params = "all",
  excl = NULL,
  ISB = TRUE,
  exact = TRUE,
  probs = c(0.025, 0.5, 0.975),
  hpd_prob = 0.95,
  HPD = FALSE,
  pg0 = FALSE,
  digits = NULL,
  round = NULL,
  Rhat = TRUE,
  n.eff = TRUE,
  func = NULL,
  func_name = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCMCsummary_+3A_object">object</code></td>
<td>
<p>Object containing MCMC output. See DETAILS below.</p>
</td></tr>
<tr><td><code id="MCMCsummary_+3A_params">params</code></td>
<td>
<p>Character string (or vector of character strings) denoting parameters to be returned in summary output.
</p>
<p>Default <code>'all'</code> returns all parameters in summary output.</p>
</td></tr>
<tr><td><code id="MCMCsummary_+3A_excl">excl</code></td>
<td>
<p>Character string (or vector of character strings) denoting parameters to exclude. Used in conjunction with <code>params</code> argument to select parameters of interest.</p>
</td></tr>
<tr><td><code id="MCMCsummary_+3A_isb">ISB</code></td>
<td>
<p>Ignore Square Brackets (ISB). Logical specifying whether square brackets should be ignored in the <code>params</code> and <code>excl</code> arguments. If <code>TRUE</code>, square brackets are ignored. If <code>FALSE</code>, square brackets are not ignored.  This allows partial names to be used when specifying parameters of interest. Use <code>exact</code> argument to specify whether input from <code>params</code> and <code>excl</code> arguments should be matched exactly.</p>
</td></tr>
<tr><td><code id="MCMCsummary_+3A_exact">exact</code></td>
<td>
<p>Logical specifying whether input from <code>params</code> and <code>excl</code> arguments should be matched exactly (after ignoring square brackets if <code>ISB = FALSE</code>). If <code>TRUE</code>, input from <code>params</code> and <code>excl</code> are matched exactly (after taking <code>ISB</code> argument into account). If <code>FALSE</code>, input from <code>params</code> and <code>excl</code> are matched using regular expression format (after taking <code>ISB</code> argument into account).</p>
</td></tr>
<tr><td><code id="MCMCsummary_+3A_probs">probs</code></td>
<td>
<p>Numeric vector where each element in (0,1) representing probabilities used to calculate posterior sample quantiles for the selected parameters. Default is c(0.025, 0.5, 0.975).</p>
</td></tr>
<tr><td><code id="MCMCsummary_+3A_hpd_prob">hpd_prob</code></td>
<td>
<p>Scalar in (0,1) representing probability used to calculate highest posterior density intervals for the selected parameters. Default is 0.95.</p>
</td></tr>
<tr><td><code id="MCMCsummary_+3A_hpd">HPD</code></td>
<td>
<p>Logical specifying whether to calculate equal-tailed credible intervals (<code>HPD = FALSE</code>) or highest posterior density intervals (<code>HPD = TRUE</code>) for the selected parameters. Default is <code>HPD = FALSE</code>.</p>
</td></tr>
<tr><td><code id="MCMCsummary_+3A_pg0">pg0</code></td>
<td>
<p>Logical specifying whether to calculate the proportion of the posterior that is greater than 0, rounded to 2 digits.</p>
</td></tr>
<tr><td><code id="MCMCsummary_+3A_digits">digits</code></td>
<td>
<p>Number of significant digits to include for posterior summary. All computed digits will be included by default. Note that Rhat is always rounded to 2 decimal places.</p>
</td></tr>
<tr><td><code id="MCMCsummary_+3A_round">round</code></td>
<td>
<p>Number of decimal places to round to for posterior summary. Cannot be used in conjunction with <code>digits</code> argument. Note that Rhat is always rounded to 2 decimal places.</p>
</td></tr>
<tr><td><code id="MCMCsummary_+3A_rhat">Rhat</code></td>
<td>
<p>Logical specifying whether to calculate and display the potential scale reduction statistic (Rhat). Values near 1 suggest convergence (Brooks and Gelman 1998). <code>Rhat = FALSE</code> will prevent display of this column in summary output. Specifying <code>Rhat = FALSE</code>, may increase function speed for very large <code>mcmc.list</code> objects.</p>
</td></tr>
<tr><td><code id="MCMCsummary_+3A_n.eff">n.eff</code></td>
<td>
<p>Logical specifying whether to calculate and display the number of effective samples for each parameter. <code>n.eff = FALSE</code> will prevent display of this column in summary output. Specifying <code>n.eff = FALSE</code>, may increase function speed for very large <code>mcmc.list</code> objects. Default is <code>n.eff = TRUE</code>.</p>
</td></tr>
<tr><td><code id="MCMCsummary_+3A_func">func</code></td>
<td>
<p>Function to be performed on MCMC output. If a function is specified, it will be evaluated on posteriors for each specified parameter and returned as a column in the summary output (or multiple columns if the function returns more than one value).</p>
</td></tr>
<tr><td><code id="MCMCsummary_+3A_func_name">func_name</code></td>
<td>
<p>Character string (or vector of character strings) specifying labels for output from <code>func</code> argument. If <code>func_name</code> is not specified, columns with <code>func</code> argument will be labeled 'func'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function returns summary information (including parameter posterior mean, posterior sd, quantiles, potential scale reduction statistic (Rhat), number of effective samples, and other specified metrics) for specified parameters.
</p>


<h3>Details</h3>

<p><code>object</code> argument can be a <code>stanfit</code> object (<code>rstan</code> package), a <code>CmdStanMCMC</code> object (<code>cmdstanr</code> package), a <code>stanreg</code> object (<code>rstanarm</code> package), a <code>brmsfit</code> object (<code>brms</code> package), an <code>mcmc.list</code> object (<code>coda</code> and <code>rjags</code> packages), <code>mcmc</code> object (<code>coda</code> and <code>nimble</code> packages), <code>list</code> object (<code>nimble</code> package), an <code>R2jags</code> model object (<code>R2jags</code> package), a <code>jagsUI</code> model object (<code>jagsUI</code> package), or a matrix containing MCMC chains (each column representing MCMC output for a single parameter, rows representing iterations in the chain). The function automatically detects the object type and proceeds accordingly.
</p>


<h3>Notes</h3>

<p>For <code>mcmc.list</code>, <code>mcmc</code>, and <code>list</code> objects, the potential scale reduction statistic statistic (Rhat) is calculated using the <code>gelman.diag</code> function in the <code>coda</code> package (what is typically displayed in the summary output from models fit with JAGS). For <code>stanfit</code> (as well as <code>CmdStanMCMC</code>, <code>stanreg</code>, and <code>brmsfit</code> objects) and <code>jagsUI</code> objects, Rhat is calculated using a 'split chain' Rhat (in their respective packages), which is thought to be a more conservative diagnostic (Stan Development Team 2018).
</p>
<p>For <code>mcmc.list</code>, <code>mcmc</code>, and <code>list</code> objects, the number of effective samples is calculated using the <code>effectiveSize</code> function in the <code>coda</code> package. For <code>stanfit</code> (as well as <code>CmdStanMCMC</code>, <code>stanreg</code>, and <code>brmsfit</code> objects) and <code>jagsUI</code> objects, n.eff is calculated using a slightly different method of computation for the number of effective samples (Stan Development Team 2018). For <code>CmdStanMCMC</code> objects, both bulk and tail n.eff is calculated.
</p>


<h3>References</h3>

<p>Brooks, S. P., and A. Gelman. 1998. General methods for monitoring convergence of iterative simulations. Journal of Computational and Graphical Statistics 7:434.
</p>
<p>Stan Development Team. 2018. Stan Modeling Language Users Guide and Reference Manual, Version 2.18.0.   https://mc-stan.org
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Load data
data(MCMC_data)

#Summary information for MCMC output - display 2 significant digits
MCMCsummary(MCMC_data, digits = 2)

#Just 'beta' parameters - round to 2 decimal places
MCMCsummary(MCMC_data, params = 'beta', round = 2)

#Just 'beta[1]', 'beta[4]', and 'alpha[3]'
MCMCsummary(MCMC_data, params = c('beta[1]', 'beta[4]', 'alpha[3]'), ISB = FALSE, exact = TRUE)

</code></pre>

<hr>
<h2 id='MCMCtrace'>Trace and density plots from MCMC output</h2><span id='topic+MCMCtrace'></span>

<h3>Description</h3>

<p>Trace and density plots of MCMC chains for specific parameters of interest. Print plots to pdf by default.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCMCtrace(
  object,
  params = "all",
  excl = NULL,
  ISB = TRUE,
  exact = TRUE,
  iter = 5000,
  gvals = NULL,
  priors = NULL,
  post_zm = TRUE,
  PPO_out = FALSE,
  Rhat = FALSE,
  n.eff = FALSE,
  ind = FALSE,
  pdf = TRUE,
  plot = TRUE,
  open_pdf = TRUE,
  filename,
  wd = getwd(),
  type = "both",
  ylim = NULL,
  xlim = NULL,
  xlab_tr,
  ylab_tr,
  xlab_den,
  ylab_den,
  main_den = NULL,
  main_tr = NULL,
  lwd_den = 1,
  lwd_pr = 1,
  lty_den = 1,
  lty_pr = 1,
  col_den,
  col_pr,
  col_txt,
  sz_txt = 1.2,
  sz_ax = 1,
  sz_ax_txt = 1,
  sz_tick_txt = 1,
  sz_main_txt = 1.2,
  pos_tick_x_tr = NULL,
  pos_tick_y_tr = NULL,
  pos_tick_x_den = NULL,
  pos_tick_y_den = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCMCtrace_+3A_object">object</code></td>
<td>
<p>Object containing MCMC output. See DETAILS below.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_params">params</code></td>
<td>
<p>Character string (or vector of character strings) denoting parameters of interest.
</p>
<p>Default <code>'all'</code> returns chains for all parameters.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_excl">excl</code></td>
<td>
<p>Character string (or vector of character strings) denoting parameters to exclude. Used in conjunction with <code>params</code> argument to select parameters of interest.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_isb">ISB</code></td>
<td>
<p>Ignore Square Brackets (ISB). Logical specifying whether square brackets should be ignored in the <code>params</code> and <code>excl</code> arguments. If <code>TRUE</code>, square brackets are ignored. If <code>FALSE</code>, square brackets are not ignored.  This allows partial names to be used when specifying parameters of interest. Use <code>exact</code> argument to specify whether input from <code>params</code> and <code>excl</code> arguments should be matched exactly.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_exact">exact</code></td>
<td>
<p>Logical specifying whether input from <code>params</code> and <code>excl</code> arguments should be matched exactly (after ignoring square brackets if <code>ISB = FALSE</code>). If <code>TRUE</code>, input from <code>params</code> and <code>excl</code> are matched exactly (after taking <code>ISB</code> argument into account). If <code>FALSE</code>, input from <code>params</code> and <code>excl</code> are matched using regular expression format (after taking <code>ISB</code> argument into account).</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_iter">iter</code></td>
<td>
<p>Number of iterations to plot for trace and density plots. The default value is 5000, meaning the last 5000 iterations of the chain will be plotted.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_gvals">gvals</code></td>
<td>
<p>Vector containing generating values if simulated data was used to fit model. These values will be plotted as vertical lines on the density plots to compare posterior distributions with the true parameter values used to generate the data. No line will be apparent if the generating value is outside the plotted range of the posterior distribution.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_priors">priors</code></td>
<td>
<p>Matrix containing random draws from prior distributions corresponding to parameters of interest. If specified, priors are plotted along with posterior density plots. Percent overlap between prior and posterior (PPO) is also calculated and displayed on each plot. Each column of the matrix represents a prior for a different parameter. Parameters are plotted alphabetically - priors should be sorted accordingly. If <code>priors</code> contains only one prior and more than one parameter is specified for the <code>params</code> argument, this prior will be used for all parameters. The number of draws for each prior should equal the number of iterations specified by <code>iter</code> (or total draws if less than <code>iter</code>) times the number of chains, though the function will automatically adjust if more or fewer iterations are specified. See DETAILS below.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_post_zm">post_zm</code></td>
<td>
<p>Logical - if <code>post_zm = FALSE</code> x- and y-limits of density plots are scaled so that both the prior and posterior can be visualized on a single density plot (rather than zoomed on the posterior).</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_ppo_out">PPO_out</code></td>
<td>
<p>Logical - if <code>PPO_out = TRUE</code> percent overlap between prior and posterior (PPO) will be output to a dataframe.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_rhat">Rhat</code></td>
<td>
<p>Logical - if <code>Rhat = TRUE</code> potential scale reduction factor (Rhat) for each parameter is plotted on the trace plots.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_n.eff">n.eff</code></td>
<td>
<p>Logical - if <code>n.eff = TRUE</code> number of effective samples for each parameter is plotted on the trace plots.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_ind">ind</code></td>
<td>
<p>Logical - if <code>ind = TRUE</code>, separate density lines will be plotted for each chain. If <code>ind= FALSE</code>, one density line will be plotted for all chains.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_pdf">pdf</code></td>
<td>
<p>Logical - if <code>pdf = TRUE</code> plots will be exported to a pdf.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_plot">plot</code></td>
<td>
<p>Logical - if <code>plot = FALSE</code> no plot will be output. Designed to be used in conjunction with <code>PPO_out = TRUE</code>, to calculate PPO without displaying plot output.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_open_pdf">open_pdf</code></td>
<td>
<p>Logical - if <code>open_pdf = TRUE</code> pdf will open in viewer after being generated.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_filename">filename</code></td>
<td>
<p>Name of pdf file to be printed. Default is 'MCMCtrace'.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_wd">wd</code></td>
<td>
<p>Working directory for pdf output. Default is current directory.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_type">type</code></td>
<td>
<p>Type of plot to be output. <code>'both'</code> outputs both trace and density plots, <code>'trace'</code>
outputs only trace plots, and <code>'density'</code> outputs only density plots.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_ylim">ylim</code></td>
<td>
<p>Vector of length two specifying limits for y-axis on density plots only. If specified, overrides argument <code>post_zm</code>.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_xlim">xlim</code></td>
<td>
<p>Vector of length two specifying limits for x-axis on density plots only. If specified, overrides argument <code>post_zm</code>.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_xlab_tr">xlab_tr</code></td>
<td>
<p>Character string specifying label for x-axis on trace plots.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_ylab_tr">ylab_tr</code></td>
<td>
<p>Character string specifying label for x-axis on trace plots.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_xlab_den">xlab_den</code></td>
<td>
<p>Character string specifying label for x-axis on density plots.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_ylab_den">ylab_den</code></td>
<td>
<p>Character string specifying label for x-axis on density plots.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_main_den">main_den</code></td>
<td>
<p>Character string (or vector of character strings if plotting &gt; 1 parameter) specifying title(s) of density plot(s).</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_main_tr">main_tr</code></td>
<td>
<p>Character string (or vector of character strings if plotting &gt; 1 parameter) specifying title(s) of trace plot(s).</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_lwd_den">lwd_den</code></td>
<td>
<p>Number specifying thickness of density line on density plots.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_lwd_pr">lwd_pr</code></td>
<td>
<p>Number specifying thickness of prior line on density plots.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_lty_den">lty_den</code></td>
<td>
<p>Number specifying the line type for the density line on density plots.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_lty_pr">lty_pr</code></td>
<td>
<p>Number specifying the line type for the prior line on density plots.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_col_den">col_den</code></td>
<td>
<p>Character string specifying color of density line on density plots. Does not specify color if <code>ind = TRUE</code>.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_col_pr">col_pr</code></td>
<td>
<p>Character string specifying color of prior line on density plots.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_col_txt">col_txt</code></td>
<td>
<p>Character string specifying color of text (denoting PPO) on plot when value specified for <code>priors</code>. If <code>NULL</code> is specified, no text will be plot.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_sz_txt">sz_txt</code></td>
<td>
<p>Number specifying size of text (denoting PPO) when value specified for <code>priors</code>. If <code>NULL</code> is specified, no text will be plot.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_sz_ax">sz_ax</code></td>
<td>
<p>Number specifying thickness of axes and ticks.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_sz_ax_txt">sz_ax_txt</code></td>
<td>
<p>Number specifying size of text for axes labels.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_sz_tick_txt">sz_tick_txt</code></td>
<td>
<p>Number specifying size of text for tick labels on axis.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_sz_main_txt">sz_main_txt</code></td>
<td>
<p>Number specifying size of text for main title.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_pos_tick_x_tr">pos_tick_x_tr</code></td>
<td>
<p>Numeric vector specifying where ticks on x-axis should be placed for trace plots.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_pos_tick_y_tr">pos_tick_y_tr</code></td>
<td>
<p>Numeric vector specifying where ticks on y-axis should be placed for trace plots.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_pos_tick_x_den">pos_tick_x_den</code></td>
<td>
<p>Numeric vector specifying where ticks on x-axis should be placed for density plots.</p>
</td></tr>
<tr><td><code id="MCMCtrace_+3A_pos_tick_y_den">pos_tick_y_den</code></td>
<td>
<p>Numeric vector specifying where ticks on y-axis should be placed for density plots.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>object</code> argument can be a <code>stanfit</code> object (<code>rstan</code> package), a <code>stanreg</code> object (<code>rstanarm</code> package), a <code>brmsfit</code> object (<code>brms</code> package), an <code>mcmc.list</code> object (<code>coda</code> and <code>rjags</code> packages), <code>mcmc</code> object (<code>coda</code> and <code>nimble</code> packages), <code>list</code> object (<code>nimble</code> package), an <code>R2jags</code> model object (<code>R2jags</code> package), a <code>jagsUI</code> model object (<code>jagsUI</code> package), or a matrix containing MCMC chains (each column representing MCMC output for a single parameter, rows representing iterations in the chain). The function automatically detects the object type and proceeds accordingly.
</p>
<p>Matrices for the <code>priors</code> argument can be generated using commands such as rnorm, rgamma, runif, etc. Distributions not supported by base R can be generated by using the appropriate packages. It is important to note that some discrepancies between MCMC samplers and R may exist regarding the parameterization of distributions - one example of this is the use of precision in JAGS but standard deviation in R for the 'second parameter' of the normal distribution. If the number of draws for each prior distribution is greater than the total number used for the density plot (<code>iter</code> times the number of chains), the function will use a subset of the prior draws. If the number of draws for each prior distribution is less than the total number used for the density plot, the function will resample (with replacement) from the prior to obtain the appropriate number of draws.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Load data
data(MCMC_data)

#Traceplots for all 'beta' parameters - pdf is generated by default
MCMCtrace(MCMC_data, params = 'beta', pdf = FALSE)

#Traceplots (individual density lines for each chain) just for 'beta[1]'
MCMCtrace(MCMC_data, params = 'beta[1]', 
          ISB = FALSE, exact = TRUE, ind = TRUE, pdf = FALSE)

#Plot prior on top of posterior, calculate prior/posterior overlap (PPO) 
#just for 'beta[1]'
#Add Rhat and n.eff values to density plots
PR &lt;- rnorm(15000, 0, 32)
MCMCtrace(MCMC_data, params = 'beta[1]', ISB = FALSE, exact = TRUE, 
          priors = PR, pdf = FALSE, Rhat = TRUE, n.eff = TRUE)

#Output PPO to R object without plotting trace plots
PR &lt;- rnorm(15000, 0, 32)
PPO &lt;- MCMCtrace(MCMC_data, params = 'beta[1]', ISB = FALSE, exact = TRUE,
                 priors = PR, plot = FALSE, PPO_out = TRUE)
</code></pre>

<hr>
<h2 id='MCMCvis-package'>The 'MCMCvis' package</h2><span id='topic+MCMCvis'></span><span id='topic+MCMCvis-package'></span>

<h3>Description</h3>

<p>'MCMCvis' is an R package used to visualize, manipulate, and summarize MCMC output. MCMC output may be derived from Bayesian model output fit with JAGS, Stan, or other MCMC samplers.
</p>


<h3>Details</h3>

<p>The following functions are currently available:
</p>
<p>-<code>MCMCsummary</code> - summarize MCMC output for particular parameters of interest
</p>
<p>-<code>MCMCpstr</code> - summarize MCMC output for particular parameters of interest while preserving original parameter structure
</p>
<p>-<code>MCMCtrace</code> - create trace and density plots of MCMC chains for particular parameters of interest
</p>
<p>-<code>MCMCchains</code> - easily extract posterior chains from MCMC output for particular parameters of interest
</p>
<p>-<code>MCMCplot</code> - create caterpillar plots from MCMC output for particular parameters of interest)
</p>
<p>-<code>MCMCdiag</code> - create a .txt file and save specified objects that summarize model inputs, outputs, and diagnostics
</p>
<p>Example data can be loaded using <code>data(MCMC_data)</code>.
</p>
<p>&lsquo;MCMCvis' was designed to perform key functions for MCMC analysis using minimal code, in order to free up time/brainpower for interpretation of analysis results. Functions support simple and straightforward subsetting of model parameters within the calls, and produce presentable, &rsquo;publication-ready' output.
</p>
<p>The vignette can be run using <code>vignette('MCMCvis')</code> if vignette is built when installing package.
</p>


<h3>Author(s)</h3>

<p>Casey Youngflesh &lt;caseyyoungflesh@gmail.com&gt;
Christian Che-Castaldo &lt;chrischecastaldo@protonmail.com&gt;
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Casey Youngflesh <a href="mailto:caseyyoungflesh@gmail.com">caseyyoungflesh@gmail.com</a> (<a href="https://orcid.org/0000-0001-6343-3311">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Christian Che-Castaldo <a href="mailto:christian.che-castaldo@stonybrook.edu">christian.che-castaldo@stonybrook.edu</a> (<a href="https://orcid.org/0000-0002-7670-2178">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Tyler Hardy [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/caseyyoungflesh/MCMCvis">https://github.com/caseyyoungflesh/MCMCvis</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/caseyyoungflesh/MCMCvis/issues">https://github.com/caseyyoungflesh/MCMCvis/issues</a>
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
