<!DOCTYPE html><html><head><title>Help for package cohorttools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cohorttools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#boxesLx'><p>Boxes plot summarizing Lexis object</p></a></li>
<li><a href='#estim.hazard'><p>Estimates hazard function using Poisson model</p></a></li>
<li><a href='#gv2image'><p>Function makes image from graphviz code</p></a></li>
<li><a href='#mkflowchart'><p>Function makes flowchart in graphviz</p></a></li>
<li><a href='#mkratetable'><p>Function makes rate table with confidence intervals for crude incidences (rates)</p></a></li>
<li><a href='#plotcuminc'><p>Plots cumulative incidence rates</p></a></li>
<li><a href='#plotratetable'><p>Function makes plot(s) from ratetable</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Cohort Data Analyses</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.6</td>
</tr>
<tr>
<td>Author:</td>
<td>Jari Haukka [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jari Haukka &lt;jari.haukka@helsinki.fi&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6), Epi, cmprsk, ggplot2</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, survival, DiagrammeR, DiagrammeRsvg, rsvg, mgcv</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, lattice, mstate, testthat</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to make lifetables and to calculate hazard function estimate using Poisson regression model with splines. Includes function to draw simple flowchart of cohort study. Function boxesLx() makes boxes of transition rates between states. It utilizes 'Epi' package 'Lexis' data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-22 13:00:23 UTC; jkhaukka</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-23 12:00:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='boxesLx'>Boxes plot summarizing Lexis object</h2><span id='topic+boxesLx'></span>

<h3>Description</h3>

<p>Creates boxes graph describing Lexis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boxesLx(
  x,
  layout = "circo",
  prop.penwidth = FALSE,
  scale.Y = 1,
  rankdir = "TB",
  node.attr = "shape=box",
  edge.attr = "minlen=1",
  show.loop = FALSE,
  show.persons = FALSE,
  fontsizeN = 14,
  fontsizeL = 8,
  show.gr = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boxesLx_+3A_x">x</code></td>
<td>
<p>Lexis object</p>
</td></tr>
<tr><td><code id="boxesLx_+3A_layout">layout</code></td>
<td>
<p>Graphviz layout &quot;circo&quot;, &quot;dot&quot;, &quot;twopi&quot; or, &quot;neato&quot;.
It determines general layout of graph.</p>
</td></tr>
<tr><td><code id="boxesLx_+3A_prop.penwidth">prop.penwidth</code></td>
<td>
<p>use line width relative to incidence. If TRUE linewidths of
showing transition rates beween states are relative to log of rate.</p>
</td></tr>
<tr><td><code id="boxesLx_+3A_scale.y">scale.Y</code></td>
<td>
<p>scale for incidence. Scale factor rates, default is 1.</p>
</td></tr>
<tr><td><code id="boxesLx_+3A_rankdir">rankdir</code></td>
<td>
<p>for graph, default is TB. NOTE! this works best with layout &quot;dot&quot;</p>
</td></tr>
<tr><td><code id="boxesLx_+3A_node.attr">node.attr</code></td>
<td>
<p>general node attributers.
Attributes like shape, color, fillcolor, etc. for nodes.
Consult Graphviz documentation for details
<a href="https://www.graphviz.org/doc/info/attrs.html">https://www.graphviz.org/doc/info/attrs.html</a>.</p>
</td></tr>
<tr><td><code id="boxesLx_+3A_edge.attr">edge.attr</code></td>
<td>
<p>general edge (line) attributers.
Attributes like  color, arrowhead, fontcolor  etc. for edges.
Consult Graphviz documentation for details
<a href="https://www.graphviz.org/doc/info/attrs.html">https://www.graphviz.org/doc/info/attrs.html</a></p>
</td></tr>
<tr><td><code id="boxesLx_+3A_show.loop">show.loop</code></td>
<td>
<p>,  should loop (staying in same state be shown), default FALSE</p>
</td></tr>
<tr><td><code id="boxesLx_+3A_show.persons">show.persons</code></td>
<td>
<p>, should number of persons be shown (entry-&gt;exit), default FALSE</p>
</td></tr>
<tr><td><code id="boxesLx_+3A_fontsizen">fontsizeN</code></td>
<td>
<p>font size for nodes</p>
</td></tr>
<tr><td><code id="boxesLx_+3A_fontsizel">fontsizeL</code></td>
<td>
<p>font size for edges</p>
</td></tr>
<tr><td><code id="boxesLx_+3A_show.gr">show.gr</code></td>
<td>
<p>should graph be shown. If TRUE,
function DiagrammeR::grViz is used to show graph.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector containing Graphviz script. This may used
to create graph by  DiagrammeR::grViz function.
</p>


<h3>Author(s)</h3>

<p>Jari Haukka <a href="mailto:jari.haukka@helsinki.fi">jari.haukka@helsinki.fi</a>
</p>


<h3>See Also</h3>

<p><code><a href="DiagrammeR.html#topic+grViz">grViz</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(DiagrammeR)
library(survival)
library(Epi)
library(mstate)
data(ebmt3)
bmt &lt;- Lexis(exit = list(tft = rfstime/365.25),
             exit.status = factor(rfsstat, labels = c("Tx", "RD")),
                          data = ebmt3)
bmtr &lt;- cutLexis(bmt, cut = bmt$prtime/365.25, precursor.states = "Tx",
                                           new.state = "PR")

summary(bmtr)
kk&lt;-boxesLx(bmtr)
## Not run: 
# Graph to file
gv2image(kk, file="k1", type="pdf")

## End(Not run)
boxesLx(bmtr,layout="dot",rankdir = "LR",show.loop = FALSE,show.persons = TRUE)
boxesLx(bmtr,node.attr='shape=hexagon color=navy style=filled fillcolor=lightblue',
edge.attr = ' color=steelblue arrowhead=vee fontcolor="#8801d7" ',
layout="circo",prop.penwidth=TRUE)
</code></pre>

<hr>
<h2 id='estim.hazard'>Estimates hazard function using Poisson model</h2><span id='topic+estim.hazard'></span>

<h3>Description</h3>

<p>Estimates hazard function using Poisson model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estim.hazard(
  formula,
  data,
  time,
  status,
  breaks,
  knots,
  time.eval = breaks,
  alpha = 0.05,
  use.GAM = FALSE,
  print.GAM.summary = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estim.hazard_+3A_formula">formula</code></td>
<td>
<p>formula with Surv in LHS, NOTE! only one variable in RHS</p>
</td></tr>
<tr><td><code id="estim.hazard_+3A_data">data</code></td>
<td>
<p>data used by formula</p>
</td></tr>
<tr><td><code id="estim.hazard_+3A_time">time</code></td>
<td>
<p>time variables</p>
</td></tr>
<tr><td><code id="estim.hazard_+3A_status">status</code></td>
<td>
<p>status indicator Lowest value used as sensoring.
If only one unique value detected, all are assumed events</p>
</td></tr>
<tr><td><code id="estim.hazard_+3A_breaks">breaks</code></td>
<td>
<p>time is splitted with these values</p>
</td></tr>
<tr><td><code id="estim.hazard_+3A_knots">knots</code></td>
<td>
<p>knots for natural splines used in estimation of hazard function</p>
</td></tr>
<tr><td><code id="estim.hazard_+3A_time.eval">time.eval</code></td>
<td>
<p>in which time points hazard function is evaluate.</p>
</td></tr>
<tr><td><code id="estim.hazard_+3A_alpha">alpha</code></td>
<td>
<p>significance level for confidence intervals</p>
</td></tr>
<tr><td><code id="estim.hazard_+3A_use.gam">use.GAM</code></td>
<td>
<p>logical determining if generalized additive model (GAM) is used</p>
</td></tr>
<tr><td><code id="estim.hazard_+3A_print.gam.summary">print.GAM.summary</code></td>
<td>
<p>logical determining if summary of GAM is printed</p>
</td></tr>
<tr><td><code id="estim.hazard_+3A_...">...</code></td>
<td>
<p>parameters for glm</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns data frame with time and hazard function values with attribute 'estim.hazard.param'
containing estimation parameters (breaks and knots)
</p>


<h3>Author(s)</h3>

<p>Jari Haukka <a href="mailto:jari.haukka@helsinki.fi">jari.haukka@helsinki.fi</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(survival)
tmp.hz&lt;-estim.hazard(time=lung$time,status=lung$status)
head(tmp.hz,2)
attributes(tmp.hz)$estim.hazard.param # estimation parameters
tmp.hz2&lt;-estim.hazard(formula=Surv(time,status)~sex,data=lung)
head(tmp.hz2,2)
</code></pre>

<hr>
<h2 id='gv2image'>Function makes image from graphviz code</h2><span id='topic+gv2image'></span>

<h3>Description</h3>

<p>Function makes image from graphviz code
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gv2image(gv, file = "gv", type = "png", engine = "dot", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gv2image_+3A_gv">gv</code></td>
<td>
<p>character string containing graphviz code</p>
</td></tr>
<tr><td><code id="gv2image_+3A_file">file</code></td>
<td>
<p>file name for image, character string</p>
</td></tr>
<tr><td><code id="gv2image_+3A_type">type</code></td>
<td>
<p>type of ('pdf', 'png', 'ps', 'raw','svg','webp') as character string</p>
</td></tr>
<tr><td><code id="gv2image_+3A_engine">engine</code></td>
<td>
<p>grViz engine, defaults is 'dot'</p>
</td></tr>
<tr><td><code id="gv2image_+3A_...">...</code></td>
<td>
<p>parameters for rsvg_</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisible name of file created.
</p>


<h3>Author(s)</h3>

<p>Jari Haukka <a href="mailto:jari.haukka@helsinki.fi">jari.haukka@helsinki.fi</a>
</p>

<hr>
<h2 id='mkflowchart'>Function makes flowchart in graphviz</h2><span id='topic+mkflowchart'></span>

<h3>Description</h3>

<p>Function makes flowchart in graphviz
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkflowchart(N, text.M, text.P, type = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mkflowchart_+3A_n">N</code></td>
<td>
<p>Population sizes</p>
</td></tr>
<tr><td><code id="mkflowchart_+3A_text.m">text.M</code></td>
<td>
<p>Text for exclusions, length one less than N</p>
</td></tr>
<tr><td><code id="mkflowchart_+3A_text.p">text.P</code></td>
<td>
<p>Text for main boxes, must be same length with N</p>
</td></tr>
<tr><td><code id="mkflowchart_+3A_type">type</code></td>
<td>
<p>flowchart type (1 or 2)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character string, graphviz language
</p>


<h3>Author(s)</h3>

<p>Jari Haukka <a href="mailto:jari.haukka@helsinki.fi">jari.haukka@helsinki.fi</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>DiagrammeR::grViz(mkflowchart(N=c(743,32,20),
text.M=c("Excluded","Excluded \n other with reasons"),
text.P=c("Studies","Relevant studies","Included in final review"),type=1))
</code></pre>

<hr>
<h2 id='mkratetable'>Function makes rate table with confidence intervals for crude incidences (rates)</h2><span id='topic+mkratetable'></span>

<h3>Description</h3>

<p>Function makes rate table with confidence intervals for crude incidences (rates)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkratetable(formula, data, alpha = 0.05, add.RR = FALSE, lowest.N = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mkratetable_+3A_formula">formula</code></td>
<td>
<p>where Surv object is on lhs and marginal variable(s)
on rhs. Marginal variables should usually be factors</p>
</td></tr>
<tr><td><code id="mkratetable_+3A_data">data</code></td>
<td>
<p>data.frame to be used</p>
</td></tr>
<tr><td><code id="mkratetable_+3A_alpha">alpha</code></td>
<td>
<p>confidence level, default is 0.05</p>
</td></tr>
<tr><td><code id="mkratetable_+3A_add.rr">add.RR</code></td>
<td>
<p>should rate ratio (RR) be added</p>
</td></tr>
<tr><td><code id="mkratetable_+3A_lowest.n">lowest.N</code></td>
<td>
<p>lowest frequency to be shown</p>
</td></tr>
<tr><td><code id="mkratetable_+3A_...">...</code></td>
<td>
<p>additional parameter for function survival::pyears</p>
</td></tr>
</table>


<h3>Value</h3>

<p>table with columns named after marginal variables and n, event, incidence, se, exact.lower95ci
and  exact.upper95ci variables
</p>


<h3>Note</h3>

<p>packages survival is utilized.
Frequencies lower than lowest.N replaced by 999999
Person-years scaled by default with 365.25
</p>


<h3>Author(s)</h3>

<p>Jari Haukka <a href="mailto:jari.haukka@helsinki.fi">jari.haukka@helsinki.fi</a>
</p>


<h3>See Also</h3>

<p><code>survival</code>  <code><a href="survival.html#topic+pyears">pyears</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(survival)
tmp.lt1&lt;-mkratetable(Surv(time,status)~ sex,data=lung)
tmp.lt2&lt;-mkratetable(Surv(time,status)~ sex+ph.ecog,data=lung,add.RR=TRUE,lowest.N=10)
</code></pre>

<hr>
<h2 id='plotcuminc'>Plots cumulative incidence rates</h2><span id='topic+plotcuminc'></span>

<h3>Description</h3>

<p>Plots cumulative incidence rates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotcuminc(ftime, fstatus, cencode, pop.length = 50, group, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotcuminc_+3A_ftime">ftime</code></td>
<td>
<p>failure time variable</p>
</td></tr>
<tr><td><code id="plotcuminc_+3A_fstatus">fstatus</code></td>
<td>
<p>variable with distinct codes for different causes of failure and also a distinct code for censored observations</p>
</td></tr>
<tr><td><code id="plotcuminc_+3A_cencode">cencode</code></td>
<td>
<p>value of fstatus variable which indicates the failure time is censored.</p>
</td></tr>
<tr><td><code id="plotcuminc_+3A_pop.length">pop.length</code></td>
<td>
<p>number of population sizes shown</p>
</td></tr>
<tr><td><code id="plotcuminc_+3A_group">group</code></td>
<td>
<p>plots will be made for each group. If missing then treated as all one group</p>
</td></tr>
<tr><td><code id="plotcuminc_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>if missing group ggplot2 object or if group given named list of ggplot2 objects
</p>


<h3>Note</h3>

<p>package cmprsk and ggplot2 are utilized
</p>


<h3>Author(s)</h3>

<p>Jari Haukka <a href="mailto:jari.haukka@helsinki.fi">jari.haukka@helsinki.fi</a>
</p>


<h3>See Also</h3>

<p><code>survival</code>  <code><a href="survival.html#topic+pyears">pyears</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(2)
ss &lt;- rexp(100)
gg &lt;- factor(sample(1:3,100,replace=TRUE),1:3,c('a','b','c'))
cc &lt;- sample(0:2,100,replace=TRUE)
print(plotcuminc(ftime=ss,fstatus=cc,cencode=0))
print(plotcuminc(ftime=ss,fstatus=cc,cencode=0,group=gg))
</code></pre>

<hr>
<h2 id='plotratetable'>Function makes plot(s) from ratetable</h2><span id='topic+plotratetable'></span>

<h3>Description</h3>

<p>Function makes plot(s) from ratetable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotratetable(rt, RR = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotratetable_+3A_rt">rt</code></td>
<td>
<p>Rate table produced by function mkratetable</p>
</td></tr>
<tr><td><code id="plotratetable_+3A_rr">RR</code></td>
<td>
<p>Boolean, if TRUE rate ratios plotted</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object, or list if multiple variables in rate table
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
library(survival)
tmp.lt1&lt;-mkratetable(Surv(time,status)~ ph.ecog,data=lung,add.RR = FALSE)
plotratetable(tmp.lt1)
tmp.lt2&lt;-mkratetable(Surv(time,status)~ sex+ph.ecog+cut(age,4),data=lung,add.RR=TRUE,lowest.N=1)
plotratetable(tmp.lt2,TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
