<!DOCTYPE html><html><head><title>Help for package ExactMultinom</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ExactMultinom}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#multinom_test_cpp'><p>C++ Function for Exact Multinomial Test</p></a></li>
<li><a href='#multinom.test'><p>Multinomial Goodness-of-Fit Tests</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multinomial Goodness-of-Fit Tests</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Johannes Resin</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Johannes Resin &lt;johannes.resin@h-its.org&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes exact p-values for multinomial goodness-of-fit tests based on multiple test statistics, namely, Pearson's chi-square, the log-likelihood ratio and the probability mass statistic. Implements the algorithm detailed in Resin (2020) &lt;<a href="https://arxiv.org/abs/2008.12682">arXiv:2008.12682</a>&gt;. Estimates based on the classical asymptotic chi-square approximation or Monte-Carlo simulation can also be computed.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.4), stats</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-09-04 14:16:29 UTC; resinjs</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-09-04 21:42:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='multinom_test_cpp'>C++ Function for Exact Multinomial Test</h2><span id='topic+multinom_test_cpp'></span>

<h3>Description</h3>

<p>C++ function computing exact multinomial p-values. Does not perform any safety checks. Incorrect input may result in unwanted behavior.
Use only through <code><a href="#topic+multinom.test">multinom.test</a></code> with method = &quot;exact&quot; is recommended.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multinom_test_cpp(x, p, theta = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multinom_test_cpp_+3A_x">x</code></td>
<td>
<p>Vector of non-negative integers - number of times each outcome was observed.</p>
</td></tr>
<tr><td><code id="multinom_test_cpp_+3A_p">p</code></td>
<td>
<p>A vector of positive numbers - the hypothesized probabilities for each outcome. Need to sum to 1!</p>
</td></tr>
<tr><td><code id="multinom_test_cpp_+3A_theta">theta</code></td>
<td>
<p>Parameter - p-values less than theta will not be determined precisely.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The outcomes should be ordered by the hypothesized probabilities from largest to smallest for optimal performance.
</p>


<h3>Value</h3>

<p>Returns a vector containing three values which are the p-values computed from the probability mass, Pearson's chi-square and the log-likelihood ratio statistic.
Values below the threshold theta are upper bounds only and not exact p-values!
</p>


<h3>See Also</h3>

<p><code><a href="#topic+multinom.test">multinom.test</a></code>
</p>

<hr>
<h2 id='multinom.test'>Multinomial Goodness-of-Fit Tests</h2><span id='topic+multinom.test'></span><span id='topic+ExactMultinom'></span>

<h3>Description</h3>

<p>Computes exact p-values for multinomial goodness-of-fit tests based on multiple test statistics, namely, 
Pearson's chi-square, the log-likelihood ratio and the probability mass statistic. 
Implements the algorithm detailed in Resin (2020). 
Estimates based on the classical asymptotic chi-square approximation or Monte-Carlo simulation can also be computed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multinom.test(
  x,
  p,
  stat = "Prob",
  method = "exact",
  theta = 1e-04,
  timelimit = 10,
  N = 10000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multinom.test_+3A_x">x</code></td>
<td>
<p>Vector of non-negative integers - number of times each outcome was observed.</p>
</td></tr>
<tr><td><code id="multinom.test_+3A_p">p</code></td>
<td>
<p>A vector of positive numbers - the hypothesized probabilities for each outcome. Need not sum to 1, but only encode hypothesized proportions correctly.</p>
</td></tr>
<tr><td><code id="multinom.test_+3A_stat">stat</code></td>
<td>
<p>Test statistic to be used. Can be &quot;Prob&quot; for the probability mass, &quot;Chisq&quot; for Pearson's chi-square and &quot;LLR&quot; for the log-likelihood ratio.</p>
</td></tr>
<tr><td><code id="multinom.test_+3A_method">method</code></td>
<td>
<p>Method used to compute the p-values. Can be &quot;exact&quot;, &quot;asymptotic&quot; and &quot;Monte-Carlo&quot;.</p>
</td></tr>
<tr><td><code id="multinom.test_+3A_theta">theta</code></td>
<td>
<p>Parameter used with the exact method. p-values less than theta will not be determined precisely. 
Values &gt;= 10^-8 are recommended. Very small p-values (&lt; 10^-8) may be falsified by rounding errors.</p>
</td></tr>
<tr><td><code id="multinom.test_+3A_timelimit">timelimit</code></td>
<td>
<p>Time limit in seconds, after which the exact method is interrupted to avoid long runtime.</p>
</td></tr>
<tr><td><code id="multinom.test_+3A_n">N</code></td>
<td>
<p>Number of samples generated by the Monte-Carlo approach.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The &quot;exact&quot; method implements the algorithm detailed in Resin (2020). The method improves on the full enumeration implemented in some other R packages.
It should work well if the number of categories is small. To avoid long runtimes the exact computation is interrupted after <code>timelimit</code> seconds. 
However, it may take longer than the specified time limit for the actual interrupt to occur. Only p-values greater <code>theta</code> are determined precisely. 
For p-values less than <code>theta</code>, the algorithm will only determine that the p-value is smaller than <code>theta</code>.
</p>
<p>The &quot;asymptotic&quot; method returns classical chi-square approximations. The asymptotic approximation to the probability mass statistic is detailed in Section 2 of Resin (2020).
</p>
<p>The &quot;Monte-Carlo&quot; method returns estimates based on <code>N</code> random draws from the hypothesized distribution.
</p>


<h3>Value</h3>

<p>A list with class &quot;mgof&quot; containing
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>As input by user.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>As input by user.</p>
</td></tr>
<tr><td><code>stat</code></td>
<td>
<p>As input by user or default.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>As input by user or default.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>As input by user or default.</p>
</td></tr>
<tr><td><code>pvals_ex</code></td>
<td>
<p>Exact p-values or NA. WARNING: Values less than theta are NOT exact p-values, but only imply that the actual p-value is less than that value.</p>
</td></tr>
<tr><td><code>pvals_as</code></td>
<td>
<p>Asymptotic approximation to p-values or NA.</p>
</td></tr>
<tr><td><code>pvals_mc</code></td>
<td>
<p>Monte-Carlo estimated p-values or NA.</p>
</td></tr>
</table>
<p>The first p-value (e.g., <code>pvals_ex[1]</code>) is obtained from the probability mass, the second from Pearson's chi-square and the third from the log-likelihood ratio.
</p>


<h3>Note</h3>

<p>Each method computes p-values for all three test statistics simultaneously.
</p>


<h3>References</h3>

<p>Resin, J. (2020), A Simple Algorithm for Exact Multinomial Tests, <em>Preprint</em> <a href="https://arxiv.org/abs/2008.12682">https://arxiv.org/abs/2008.12682</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Test fairness of a die (that is, whether each side has the same probability)
p_fair = rep(1/6,6) # Hypothesized probabilities for each side
x = c(16,17,12,15,15,25) # Observed number of times each side appeared on 100 throws
# Exact multinomial test (using probability ordering by default):
multinom.test(x,p_fair)
# Exact multinomial test using log-likelihood ratio:
multinom.test(x,p_fair,stat = "LLR")
# Classical chi-square test (using asymptotics to estimate p-value and Pearson's chi-square):
multinom.test(x,p_fair,stat = "Chisq",method = "asymptotic")
# Using Monte-Carlo approach and probability ordering 
multinom.test(x,p_fair,stat = "Prob",method = "Monte-Carlo")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
