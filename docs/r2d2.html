<!DOCTYPE html><html><head><title>Help for package r2d2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {r2d2}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#conf2d'><p>Bivariate (Two-Dimensional) Confidence Region</p></a></li>
<li><a href='#freq2d'><p>Bivariate (Two-Dimensional) Frequency Distribution</p></a></li>
<li><a href='#r2d2-package'>
<p>Bivariate (Two-Dimensional) Confidence Region and Frequency</p>
Distribution</a></li>
<li><a href='#saithe'><p>MCMC Results from Saithe Assessment</p></a></li>
<li><a href='#Ushape'><p>U-Shaped Cloud</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-11</td>
</tr>
<tr>
<td>Title:</td>
<td>Bivariate (Two-Dimensional) Confidence Region and Frequency
Distribution</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, KernSmooth, MASS, sp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>lattice</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Description:</td>
<td>Generic functions to analyze the distribution of two continuous
  variables: 'conf2d' to calculate a smooth empirical confidence region, and
  'freq2d' to calculate a frequency distribution.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-10 22:00:53 UTC; arnim</td>
</tr>
<tr>
<td>Author:</td>
<td>Arni Magnusson [aut, cre],
  Julian Burgos [aut],
  Gregory R. Warnes [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Arni Magnusson &lt;thisisarni@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-11 11:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='conf2d'>Bivariate (Two-Dimensional) Confidence Region</h2><span id='topic+conf2d'></span><span id='topic+conf2d.default'></span><span id='topic+conf2d.formula'></span><span id='topic+conf2d_int'></span>

<h3>Description</h3>

<p>Calculate an empirical confidence region for two variables, and
optionally overlay the smooth polygon on a scatterplot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conf2d(x, ...)

## S3 method for class 'formula'
conf2d(formula, data, subset, ...)

## Default S3 method:
conf2d(x, y, level=0.95, n=200, method="wand", shape=1, smooth=50,
       plot=TRUE, add=FALSE, xlab=NULL, ylab=NULL, col.points="gray",
       col="black", lwd=2, ...)

conf2d_int(x, y, surf, level, n)  # internal function
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="conf2d_+3A_x">x</code></td>
<td>
<p>a vector of x values, or a data frame whose first two columns
contain the x and y values.</p>
</td></tr>
<tr><td><code id="conf2d_+3A_y">y</code></td>
<td>
<p>a vector of y values.</p>
</td></tr>
<tr><td><code id="conf2d_+3A_formula">formula</code></td>
<td>
<p>a <code><a href="stats.html#topic+formula">formula</a></code>, such as <code>y~x</code>.</p>
</td></tr>
<tr><td><code id="conf2d_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code>, <code>matrix</code>, or <code>list</code> from
which the variables in <code>formula</code> should be taken.</p>
</td></tr>
<tr><td><code id="conf2d_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used.</p>
</td></tr>
<tr><td><code id="conf2d_+3A_level">level</code></td>
<td>
<p>the proportion of points that should be inside the
region.</p>
</td></tr>
<tr><td><code id="conf2d_+3A_n">n</code></td>
<td>
<p>the number of regions to evaluate, before choosing the region
that matches <code>level</code> best.</p>
</td></tr>
<tr><td><code id="conf2d_+3A_method">method</code></td>
<td>
<p>kernel smoothing function to use: <code>"wand"</code> or
<code>"mass"</code>.</p>
</td></tr>
<tr><td><code id="conf2d_+3A_shape">shape</code></td>
<td>
<p>a bandwidth scaling factor, affecting the polygon shape.</p>
</td></tr>
<tr><td><code id="conf2d_+3A_smooth">smooth</code></td>
<td>
<p>the number of bins (scalar or vector of length 2),
affecting the polygon smoothness.</p>
</td></tr>
<tr><td><code id="conf2d_+3A_plot">plot</code></td>
<td>
<p>whether to plot a scatterplot and overlay the region as a
polygon.</p>
</td></tr>
<tr><td><code id="conf2d_+3A_add">add</code></td>
<td>
<p>whether to add a polygon to an existing plot.</p>
</td></tr>
<tr><td><code id="conf2d_+3A_xlab">xlab</code></td>
<td>
<p>a label for the x axis.</p>
</td></tr>
<tr><td><code id="conf2d_+3A_ylab">ylab</code></td>
<td>
<p>a label for the y axis.</p>
</td></tr>
<tr><td><code id="conf2d_+3A_col.points">col.points</code></td>
<td>
<p>color of points.</p>
</td></tr>
<tr><td><code id="conf2d_+3A_col">col</code></td>
<td>
<p>color of polygon.</p>
</td></tr>
<tr><td><code id="conf2d_+3A_lwd">lwd</code></td>
<td>
<p>line width of polygon.</p>
</td></tr>
<tr><td><code id="conf2d_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code>plot</code> and
<code>polygon</code>.</p>
</td></tr>
<tr><td><code id="conf2d_+3A_surf">surf</code></td>
<td>
<p>a list whose first three elements are x coordinates, y
coordinates, and a surface matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function constructs a large number (<code>n</code>) of smooth polygons,
and then chooses the polygon that comes closest to containing a given
proportion (<code>level</code>) of the total points.
</p>
<p>The default <code>method="wand"</code> calls the
<code><a href="KernSmooth.html#topic+bkde2D">bkde2D</a></code> kernel smoother from the
<span class="pkg">KernSmooth</span> package, while <code>method="mass"</code> calls
<code><a href="MASS.html#topic+kde2d">kde2d</a></code> from the <span class="pkg">MASS</span> package.
</p>
<p>The <code>conf2d</code> function calls <code>bkde2D</code> or <code>kde2d</code> to
compute a smooth surface from <code>x</code> and y. If users already have
a smoothed surface to work from, the internal <code>conf2d_int</code> can be
used directly to find the empirical confidence region that matches
<code>level</code> best.
</p>


<h3>Value</h3>

<p>List containing five elements:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>x coordinates defining the region.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>y coordinates defining the region.</p>
</td></tr>
<tr><td><code>inside</code></td>
<td>
<p>logical vector indicating which of the original data
coordinates are inside the region.</p>
</td></tr>
<tr><td><code>area</code></td>
<td>
<p>area inside the region.</p>
</td></tr>
<tr><td><code>prop</code></td>
<td>
<p>actual proportion of points inside the region.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The <code>area</code> of a bivariate region is analogous to the range of a
univariate interval. This allows a quantitative comparison of
different confidence regions.
</p>
<p>Ellipses are a more restrictive approach to calculate an empirical
bivariate confidence region. Smooth polygons make fewer assumptions
about how x and y covary.
</p>
<p>The <code>conf2d</code> and <code>freq2d</code> functions are closely related. The
advantage of <code>conf2d</code> is that it returns a region as a smooth
polygon. The advantage of <code>freq2d</code> is that it returns a set that
is guaranteed to contain the correct proportion of points, even for
spatially complex datasets.
</p>


<h3>Author(s)</h3>

<p>Arni Magnusson and Julian Burgos, based on an earlier function by
Gregory R. Warnes.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+quantile">quantile</a></code> is the corresponding univariate equivalent.
</p>
<p>The <span class="pkg">distfree.cr</span> package uses a different smoothing algorithm to
calculate bivariate empirical confidence regions.
</p>
<p><code><a href="gplots.html#topic+ci2d">ci2d</a></code> in the <span class="pkg">gplots</span> package is a
predecessor of <code>conf2d</code>.
</p>
<p><code><a href="#topic+freq2d">freq2d</a></code> calculates a discrete frequency distribution for
two continuous variables.
</p>
<p><code><a href="#topic+r2d2-package">r2d2-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>conf2d(Ushape)$prop
conf2d(saithe, pch=16, cex=1.2, col.points=rgb(0,0,0,0.1), lwd=3)

# First surface, then region
plot(saithe, col="gray")
surf &lt;- MASS::kde2d(saithe$Bio, saithe$HR, h=0.25, n=100)
region &lt;- conf2d_int(saithe$Bio, saithe$HR, surf, level=0.95, n=200)
polygon(region, lwd=2)
</code></pre>

<hr>
<h2 id='freq2d'>Bivariate (Two-Dimensional) Frequency Distribution</h2><span id='topic+freq2d'></span><span id='topic+freq2d.default'></span><span id='topic+freq2d.formula'></span>

<h3>Description</h3>

<p>Calculate a frequency distribution for two continuous variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>freq2d(x, ...)

## S3 method for class 'formula'
freq2d(formula, data, subset, ...)

## Default S3 method:
freq2d(x, y, n=20, pad=0, layout=1, print=TRUE, dnn=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="freq2d_+3A_x">x</code></td>
<td>
<p>a vector of x values, or a data frame whose first two columns
contain the x and y values.</p>
</td></tr>
<tr><td><code id="freq2d_+3A_y">y</code></td>
<td>
<p>a vector of y values.</p>
</td></tr>
<tr><td><code id="freq2d_+3A_formula">formula</code></td>
<td>
<p>a <code><a href="stats.html#topic+formula">formula</a></code>, such as <code>y~x</code>.</p>
</td></tr>
<tr><td><code id="freq2d_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code>, <code>matrix</code>, or <code>list</code> from
which the variables in <code>formula</code> should be taken.</p>
</td></tr>
<tr><td><code id="freq2d_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used.</p>
</td></tr>
<tr><td><code id="freq2d_+3A_n">n</code></td>
<td>
<p>the desired number of bins for the output, a scalar or a
vector of length 2.</p>
</td></tr>
<tr><td><code id="freq2d_+3A_pad">pad</code></td>
<td>
<p>number of rows and columns to add to each margin,
containing only zeros.</p>
</td></tr>
<tr><td><code id="freq2d_+3A_layout">layout</code></td>
<td>
<p>one of three layouts for the output: <code>1</code>, <code>2</code>,
or <code>3</code>.</p>
</td></tr>
<tr><td><code id="freq2d_+3A_print">print</code></td>
<td>
<p>whether to display the resulting matrix on the screen
using dots for zeros.</p>
</td></tr>
<tr><td><code id="freq2d_+3A_dnn">dnn</code></td>
<td>
<p>the names to be given to the dimensions in the result.</p>
</td></tr>
<tr><td><code id="freq2d_+3A_...">...</code></td>
<td>
<p>named arguments to be passed to the default method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The exact number of bins is determined by the
<code><a href="base.html#topic+pretty">pretty</a></code> function, based on the value of <code>n</code>.
</p>
<p>Padding the margins with zeros can be helpful for subsequent analysis,
such as smoothing.
</p>
<p>The <code>print</code> logical flag only has an effect when <code>layout=1</code>.
</p>


<h3>Value</h3>

<p>The <code>layout</code> argument specifies one of the following formats for
the binned frequency output:
</p>

<ol>
<li><p><code>matrix</code> that is easy to read, aligned like a
scatterplot.
</p>
</li>
<li><p><code>list</code> with three elements (x, y, matrix) that can be
passed to various plotting functions.
</p>
</li>
<li><p><code>data.frame</code> with three columns (x, y, frequency) that
can be analyzed further.
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Arni Magnusson.</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+cut">cut</a></code>, <code><a href="base.html#topic+table">table</a></code>, and <code><a href="base.html#topic+print.table">print.table</a></code>
are the basic underlying functions.
</p>
<p><code><a href="gplots.html#topic+hist2d">hist2d</a></code> in the <span class="pkg">gplots</span> package is a related
function with graphical capabilities.
</p>
<p><code><a href="#topic+conf2d">conf2d</a></code> calculates a bivariate empirical confidence
region, a smooth polygon.
</p>
<p><code><a href="#topic+r2d2-package">r2d2-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>freq2d(Ushape)
freq2d(quakes$long, quakes$lat, dnn="")
freq2d(lat~long, quakes, n=c(10,20), pad=1)

# Supress display
freq2d(saithe)
range(freq2d(saithe, print=FALSE))

# Layout, plot
freq2d(saithe, layout=2)
freq2d(saithe, layout=3)
contour(freq2d(saithe, layout=2))
lattice::contourplot(Freq~Bio+HR, freq2d(saithe,layout=3))
</code></pre>

<hr>
<h2 id='r2d2-package'>
Bivariate (Two-Dimensional) Confidence Region and Frequency
Distribution
</h2><span id='topic+r2d2-package'></span><span id='topic+r2d2'></span>

<h3>Description</h3>

<p>This package provides generic functions to analyze the distribution
of two continuous variables.
</p>


<h3>Details</h3>

<p><em>Bivariate calculations:</em>
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+conf2d">conf2d</a></code> </td><td style="text-align: left;"> empirical confidence region, a smooth
    polygon</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+freq2d">freq2d</a></code> </td><td style="text-align: left;"> frequency distribution, a table
  </td>
</tr>

</table>

<p><em>Examples:</em>
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+saithe">saithe</a></code> </td><td style="text-align: left;"> MCMC results in two columns</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+Ushape">Ushape</a></code> </td><td style="text-align: left;"> U-shaped cloud in two columns
  </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Arni Magnusson and Julian Burgos, based on earlier functions by
Gregory R. Warnes.
</p>


<h3>References</h3>

<p>Bivand, R. S., Pebesma, E., and Gomez-Rubio, V. (2013).
<em>Applied Spatial Data Analysis with R</em>. Second edition.
New York: Springer.
</p>
<p>Venables, W. N. and Ripley, B. D. (2002).
<em>Modern Applied Statistics with S</em>. Fourth edition.
New York: Springer.
</p>
<p>Wand, M. P. and Jones, M. C. (1995).
<em>Kernel Smoothing</em>.
London: Chapman and Hall.
</p>


<h3>See Also</h3>

<p>Combines existing tools from the <span class="pkg">KernSmooth</span>, <span class="pkg">MASS</span>, and
<span class="pkg">sp</span> packages.
</p>

<hr>
<h2 id='saithe'>MCMC Results from Saithe Assessment</h2><span id='topic+saithe'></span>

<h3>Description</h3>

<p>Markov chain Monte Carlo results from the analysis of the saithe
(<em>Pollachius virens</em>) fishery in Icelandic waters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>saithe</code></pre>


<h3>Format</h3>

<p>Data frame containing 1000 rows and 2 columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>Bio</code></td><td style="text-align: left;"> population biomass in 2013, relative to the expected
    long-term biomass under optimal harvest rate.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>HR</code></td><td style="text-align: left;"> harvest rate in 2013, relative to the optimal harvest
    rate.
  </td>
</tr>

</table>



<h3>References</h3>

<p>Magnusson, A. (2013).
Icelandic saithe.
In: <em>Report of the North Western Working Group (NWWG)</em>.
ICES CM 2013/ACOM:07, pp. 231&ndash;252.
<a href="https://doi.org/10.17895/ices.pub.5284">doi:10.17895/ices.pub.5284</a>.
</p>
<p>Magnusson, A., Punt, A. E., and Hilborn, R. (2013).
Measuring uncertainty in fisheries stock assessment: the delta method,
bootstrap, and MCMC.
<em>Fish and Fisheries</em> <b>14</b>, 325&ndash;342.
<a href="https://doi.org/10.1111/j.1467-2979.2012.00473.x">doi:10.1111/j.1467-2979.2012.00473.x</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>conf2d(saithe, level=0.9)
freq2d(saithe)
</code></pre>

<hr>
<h2 id='Ushape'>U-Shaped Cloud</h2><span id='topic+Ushape'></span>

<h3>Description</h3>

<p>Bivariate scatter shaped like an open circle, for testing spatial
algorithms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ushape</code></pre>


<h3>Format</h3>

<p>Matrix containing 1000 rows and 2 columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>x</code></td><td style="text-align: left;"> x coordinates.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>y</code></td><td style="text-align: left;"> y coordinates.
  </td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>freq2d(Ushape)
conf2d(Ushape)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
