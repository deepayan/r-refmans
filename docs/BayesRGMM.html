<!DOCTYPE html><html><head><title>Help for package BayesRGMM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BayesRGMM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AR1.cor'><p>AR(1) correlation matrix</p></a></li>
<li><a href='#BayesCumulativeProbitHSD'><p>Perform MCMC algorithm to generate the posterior samples for longitudinal ordinal data</p></a></li>
<li><a href='#BayesRobustProbit'><p>Perform MCMC algorithm to generate the posterior samples</p></a></li>
<li><a href='#BayesRobustProbitSummary'><p>To summarizes model estimation outcomes</p></a></li>
<li><a href='#CorrMat.HSD'><p>To compute the correlation matrix in terms of hypersphere decomposition approach</p></a></li>
<li><a href='#GSPS'><p>The German socioeconomic panel study data</p></a></li>
<li><a href='#SimulatedDataGenerator'><p>Generate simulated data with either ARMA or MCD correlation structures.</p></a></li>
<li><a href='#SimulatedDataGenerator.CumulativeProbit'><p>Simulating a longitudinal ordinal data with HSD correlation structures.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Robust Generalized Mixed Models for Longitudinal Data</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-06</td>
</tr>
<tr>
<td>Description:</td>
<td>To perform model estimation using MCMC algorithms with Bayesian methods for incomplete longitudinal studies on binary and ordinal outcomes that are measured repeatedly on subjects over time with drop-outs. Details about the method can be found in the vignette or <a href="https://sites.google.com/view/kuojunglee/r-packages/bayesrgmm">https://sites.google.com/view/kuojunglee/r-packages/bayesrgmm</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://sites.google.com/view/kuojunglee/r-packages">https://sites.google.com/view/kuojunglee/r-packages</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.1), MASS, batchmeans, abind, reshape, msm,
mvtnorm, plyr, Rdpack</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo, RcppDist</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-09 15:03:10 UTC; kuojunglee</td>
</tr>
<tr>
<td>Author:</td>
<td>Kuo-Jung Lee <a href="https://orcid.org/0000-0002-7388-4738"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Hsing-Ming Chang [ctb],
  Ray-Bing Chen [ctb],
  Keunbaik Lee [ctb],
  Chanmin Kim [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kuo-Jung Lee &lt;kuojunglee@ncku.edu.tw&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-10 12:30:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='AR1.cor'>AR(1) correlation matrix</h2><span id='topic+AR1.cor'></span>

<h3>Description</h3>

<p>Generate a correlation matrix for AR(1) model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AR1.cor(n, rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AR1.cor_+3A_n">n</code></td>
<td>
<p>size of matrix</p>
</td></tr>
<tr><td><code id="AR1.cor_+3A_rho">rho</code></td>
<td>
<p>correlation between -1 to 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code class="reqn">n\times n</code> AR(1) correlation matrix
</p>


<h3>Details</h3>

<p>The correlation matrix is created as
</p>
<p style="text-align: center;"><code class="reqn"> \left(\begin{array}{ccccc}
1 &amp; \rho &amp; \rho^2 &amp; \cdots &amp; \rho^{n-1}\\
\rho &amp; 1 &amp; \rho &amp; \cdots &amp; \rho^{n-2}\\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\ 
\rho^2 &amp; \rho &amp; 1 &amp; \cdots &amp; \rho^{n-3}
\end{array}\right)</code>
</p>



<h3>Examples</h3>

<pre><code class='language-R'>AR1.cor(5, 0.5)
</code></pre>

<hr>
<h2 id='BayesCumulativeProbitHSD'>Perform MCMC algorithm to generate the posterior samples for longitudinal ordinal data</h2><span id='topic+BayesCumulativeProbitHSD'></span>

<h3>Description</h3>

<p>This function is used to generate the posterior samples using MCMC algorithm from the
cumulative probit model with the hypersphere decomposition applied to model the correlation structure
in the serial dependence of repeated responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BayesCumulativeProbitHSD(
  fixed,
  data,
  random,
  Robustness,
  subset,
  na.action,
  HS.model,
  hyper.params,
  num.of.iter,
  Interactive
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BayesCumulativeProbitHSD_+3A_fixed">fixed</code></td>
<td>
<p>a two-sided linear formula object to describe fixed-effects with the response on the left of
a &lsquo;<span class="samp">&#8288;~&#8288;</span>&rsquo; operator and the terms separated by &lsquo;<span class="samp">&#8288;+&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;*&#8288;</span>&rsquo; operators, on the right.
The specification <code>first*second</code> indicates the cross of <code>first</code> and <code>second</code>.
This is the same as <code>first + second + first:second</code>.</p>
</td></tr>
<tr><td><code id="BayesCumulativeProbitHSD_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables named in &lsquo;<span class="samp">&#8288;fixed&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;random&#8288;</span>&rsquo;.
It requires an &ldquo;integer&rdquo; variable named by &lsquo;<span class="samp">&#8288;id&#8288;</span>&rsquo; to denote the identifications of subjects.</p>
</td></tr>
<tr><td><code id="BayesCumulativeProbitHSD_+3A_random">random</code></td>
<td>
<p>a one-sided linear formula object to describe random-effects with the terms separated by
&lsquo;<span class="samp">&#8288;+&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;*&#8288;</span>&rsquo; operators on the right of a &lsquo;<span class="samp">&#8288;~&#8288;</span>&rsquo; operator.</p>
</td></tr>
<tr><td><code id="BayesCumulativeProbitHSD_+3A_robustness">Robustness</code></td>
<td>
<p>logical. If 'TRUE' the distribution of random effects is assumed to be <br />
t-distribution; otherwise normal distribution.</p>
</td></tr>
<tr><td><code id="BayesCumulativeProbitHSD_+3A_subset">subset</code></td>
<td>
<p>an optional expression indicating the subset of the rows of &lsquo;<span class="samp">&#8288;data&#8288;</span>&rsquo; that should be used in the fit.
This can be a logical vector, or a numeric vector indicating which observation numbers are to be included,
or a character vector of the row names to be included.  All observations are included by default.</p>
</td></tr>
<tr><td><code id="BayesCumulativeProbitHSD_+3A_na.action">na.action</code></td>
<td>
<p>a function that indicates what should happen when the data contain NA’s.
The default action (&lsquo;<span class="samp">&#8288;na.omit&#8288;</span>&rsquo;, inherited from the &lsquo;<span class="samp">&#8288;factory fresh&#8288;</span>&rsquo; value of <br />
&lsquo;<span class="samp">&#8288;getOption("na.action")&#8288;</span>&rsquo;) strips any observations with any missing values in any variables.</p>
</td></tr>
<tr><td><code id="BayesCumulativeProbitHSD_+3A_hs.model">HS.model</code></td>
<td>
<p>a specification of the correlation structure in HSD model:
</p>

<ul>
<li> <p><code>HS.model = ~0</code> denotes independence, that is, <code class="reqn">R_i</code> is an identity matrix,
</p>
</li>
<li> <p><code>HS.model = ~IndTime+</code><code class="reqn">\cdots</code><code>+IndTimer</code> denotes AR(r) correlation structure,
</p>
</li>
<li> <p><code>HS.model = ~DiffTime1+</code><code class="reqn">\cdots</code><code>+DiffTimer</code> denotes correlation structure related to <code class="reqn">r</code>th order
of time difference.
</p>
</li></ul>
</td></tr>
<tr><td><code id="BayesCumulativeProbitHSD_+3A_hyper.params">hyper.params</code></td>
<td>
<p>specify the values in hyperparameters in priors.</p>
</td></tr>
<tr><td><code id="BayesCumulativeProbitHSD_+3A_num.of.iter">num.of.iter</code></td>
<td>
<p>an integer to specify the total number of iterations; default is 20000.</p>
</td></tr>
<tr><td><code id="BayesCumulativeProbitHSD_+3A_interactive">Interactive</code></td>
<td>
<p>logical. If 'TRUE' when the program is being run interactively for progress bar and 'FALSE' otherwise.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of posterior samples, parameters estimates, AIC, BIC, CIC, DIC, MPL, RJR, predicted values,
and the acceptance rates in MH are returned.
</p>


<h3>Note</h3>

<p>Only a model either HSD (&lsquo;<span class="samp">&#8288;HS.model&#8288;</span>&rsquo;) or ARMA (&lsquo;<span class="samp">&#8288;arma.order&#8288;</span>&rsquo;) model should be specified in the function.
We'll provide the reference for details of the model and the algorithm for performing
model estimation whenever the manuscript is accepted.
</p>


<h3>Author(s)</h3>

<p>Kuo-Jung Lee <a href="mailto:kuojunglee@ncku.edu.tw">kuojunglee@ncku.edu.tw</a>
</p>


<h3>References</h3>


<p>Lee K, Chen R, Kwak M, Lee K (2021).
&ldquo;Determination of correlations in multivariate longitudinal data with modified Cholesky and hypersphere decomposition using Bayesian variable selection approach.&rdquo;
<em>Statistics in Medicine</em>, <b>40</b>(4), 978&ndash;997.
</p>
<p>Lee K, Cho H, Kwak M, Jang EJ (2020).
&ldquo;Estimation of covariance matrix of multivariate longitudinal data using modified Choleksky and hypersphere decompositions.&rdquo;
<em>Biometrics</em>, <b>76</b>(1), 75&ndash;86.
</p>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(BayesRGMM)
rm(list=ls(all=TRUE))

Fixed.Effs = c(-0.1, 0.1, -0.1) #c(-0.8, -0.3, 1.8, -0.4) 
P = length(Fixed.Effs) 
q = 1 #number of random effects
T = 7 #time points
N = 100 #number of subjects
Num.of.Cats = 3 #in KBLEE simulation studies, please fix it. 
num.of.iter = 1000 #number of iterations

HSD.para = c(-0.9, -0.6) #the parameters in HSD model
a = length(HSD.para)
w = array(runif(T*T*a), c(T, T, a)) #design matrix in HSD model
 
for(time.diff in 1:a)
w[, , time.diff] = 1*(as.matrix(dist(1:T, 1:T, method="manhattan")) ==time.diff)

x = array(0, c(T, P, N))
for(i in 1:N){
    #x[,, i] = t(rmvnorm(P, rep(0, T), AR1.cor(T, Cor.in.DesignMat)))
    x[, 1, i] = 1:T
    x[, 2, i] = rbinom(1, 1, 0.5)
    x[, 3, i] = x[, 1, i]*x[, 2, i]
}

DesignMat = x

#Generate a data with HSD model


#MAR
CPREM.sim.data = SimulatedDataGenerator.CumulativeProbit(
 Num.of.Obs = N, Num.of.TimePoints = T, Num.of.Cats = Num.of.Cats, 
 Fixed.Effs = Fixed.Effs, Random.Effs = list(Sigma = 0.5*diag(1), df=3), 
 DesignMat = DesignMat, Missing = list(Missing.Mechanism = 2, 
 MissingRegCoefs=c(-0.7, -0.2, -0.1)), 
 HSD.DesignMat.para = list(HSD.para = HSD.para, DesignMat = w))

print(table(CPREM.sim.data$sim.data$y))
print(CPREM.sim.data$classes)

BCP.output = BayesCumulativeProbitHSD(
    fixed = as.formula(paste("y~", paste0("x", 1:P, collapse="+"))), 
    data=CPREM.sim.data$sim.data, random = ~ 1, Robustness = TRUE, 
    subset = NULL, na.action='na.exclude', HS.model = ~IndTime1+IndTime2, 
    hyper.params=NULL, num.of.iter=num.of.iter, Interactive=0)

BCP.Est.output = BayesRobustProbitSummary(BCP.output)

## End(Not run)
</code></pre>

<hr>
<h2 id='BayesRobustProbit'>Perform MCMC algorithm to generate the posterior samples</h2><span id='topic+BayesRobustProbit'></span>

<h3>Description</h3>

<p>This function is used to generate the posterior samples using MCMC algorithm from the probit model
with either the hypersphere decomposition or ARMA models applied to model the correlation structure
in the serial dependence
of repeated responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BayesRobustProbit(
  fixed,
  data,
  random,
  Robustness = TRUE,
  subset = NULL,
  na.action = "na.exclude",
  arma.order = NULL,
  HS.model = NULL,
  hyper.params = NULL,
  num.of.iter = 20000,
  Interactive = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BayesRobustProbit_+3A_fixed">fixed</code></td>
<td>
<p>a two-sided linear formula object to describe fixed-effects with the response on the left of
a &lsquo;<span class="samp">&#8288;~&#8288;</span>&rsquo; operator and the terms separated by &lsquo;<span class="samp">&#8288;+&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;*&#8288;</span>&rsquo; operators, on the right.
The specification <code>first*second</code> indicates the cross of <code>first</code> and <code>second</code>.
This is the same as <code>first + second + first:second</code>.</p>
</td></tr>
<tr><td><code id="BayesRobustProbit_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables named in &lsquo;<span class="samp">&#8288;fixed&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;random&#8288;</span>&rsquo;.
It requires an &ldquo;integer&rdquo; variable named by &lsquo;<span class="samp">&#8288;id&#8288;</span>&rsquo; to denote the identifications of subjects.</p>
</td></tr>
<tr><td><code id="BayesRobustProbit_+3A_random">random</code></td>
<td>
<p>a one-sided linear formula object to describe random-effects with the terms separated by
&lsquo;<span class="samp">&#8288;+&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;*&#8288;</span>&rsquo; operators on the right of a &lsquo;<span class="samp">&#8288;~&#8288;</span>&rsquo; operator.</p>
</td></tr>
<tr><td><code id="BayesRobustProbit_+3A_robustness">Robustness</code></td>
<td>
<p>logical. If 'TRUE' the distribution of random effects is assumed to be <br />
t-distribution; otherwise normal distribution.</p>
</td></tr>
<tr><td><code id="BayesRobustProbit_+3A_subset">subset</code></td>
<td>
<p>an optional expression indicating the subset of the rows of &lsquo;<span class="samp">&#8288;data&#8288;</span>&rsquo; that should be used in the fit.
This can be a logical vector, or a numeric vector indicating which observation numbers are to be included,
or a character vector of the row names to be included.  All observations are included by default.</p>
</td></tr>
<tr><td><code id="BayesRobustProbit_+3A_na.action">na.action</code></td>
<td>
<p>a function that indicates what should happen when the data contain NA’s.
The default action (&lsquo;<span class="samp">&#8288;na.omit&#8288;</span>&rsquo;, inherited from the &lsquo;<span class="samp">&#8288;factory fresh&#8288;</span>&rsquo; value of <br />
&lsquo;<span class="samp">&#8288;getOption("na.action")&#8288;</span>&rsquo;) strips any observations with any missing values in any variables.</p>
</td></tr>
<tr><td><code id="BayesRobustProbit_+3A_arma.order">arma.order</code></td>
<td>
<p>a specification of the order in an ARMA model: the two integer components (p, q) are the AR order and the MA order.</p>
</td></tr>
<tr><td><code id="BayesRobustProbit_+3A_hs.model">HS.model</code></td>
<td>
<p>a specification of the correlation structure in HSD model:
</p>

<ul>
<li> <p><code>HS.model = ~0</code> denotes independence, that is, <code class="reqn">R_i</code> is an identity matrix,
</p>
</li>
<li> <p><code>HS.model = ~IndTime+</code><code class="reqn">\cdots</code><code>+IndTimer</code> denotes AR(r) correlation structure,
</p>
</li>
<li> <p><code>HS.model = ~DiffTime1+</code><code class="reqn">\cdots</code><code>+DiffTimer</code> denotes correlation structure related to <code class="reqn">r</code>th order
of time difference.
</p>
</li></ul>
</td></tr>
<tr><td><code id="BayesRobustProbit_+3A_hyper.params">hyper.params</code></td>
<td>
<p>specify the values in hyperparameters in priors.</p>
</td></tr>
<tr><td><code id="BayesRobustProbit_+3A_num.of.iter">num.of.iter</code></td>
<td>
<p>an integer to specify the total number of iterations; default is 20000.</p>
</td></tr>
<tr><td><code id="BayesRobustProbit_+3A_interactive">Interactive</code></td>
<td>
<p>logical. If 'TRUE' when the program is being run interactively for progress bar and 'FALSE' otherwise.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of posterior samples, parameters estimates, AIC, BIC, CIC, DIC, MPL, RJR, predicted values,
and the acceptance rates in MH are returned.
</p>


<h3>Note</h3>

<p>Only a model either HSD (&lsquo;<span class="samp">&#8288;HS.model&#8288;</span>&rsquo;) or ARMA (&lsquo;<span class="samp">&#8288;arma.order&#8288;</span>&rsquo;) model should be specified in the function.
We'll provide the reference for details of the model and the algorithm for performing
model estimation whenever the manuscript is accepted.
</p>


<h3>Author(s)</h3>

<p>Kuo-Jung Lee <a href="mailto:kuojunglee@ncku.edu.tw">kuojunglee@ncku.edu.tw</a>
</p>


<h3>References</h3>


<p>Lee K, Chen R, Kwak M, Lee K (2021).
&ldquo;Determination of correlations in multivariate longitudinal data with modified Cholesky and hypersphere decomposition using Bayesian variable selection approach.&rdquo;
<em>Statistics in Medicine</em>, <b>40</b>(4), 978&ndash;997.
</p>
<p>Lee K, Cho H, Kwak M, Jang EJ (2020).
&ldquo;Estimation of covariance matrix of multivariate longitudinal data using modified Choleksky and hypersphere decompositions.&rdquo;
<em>Biometrics</em>, <b>76</b>(1), 75&ndash;86.
</p>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(BayesRGMM)
rm(list=ls(all=TRUE))
Fixed.Effs = c(-0.2, -0.3, 0.8, -0.4) #c(-0.2,-0.8, 1.0, -1.2)
P = length(Fixed.Effs) 
q = 1 #number of random effects
T = 5 #time points
N = 100 #number of subjects
num.of.iter = 100 #number of iterations
HSD.para = c(-0.5,  -0.3) #the parameters in HSD model
a = length(HSD.para)
w = array(runif(T*T*a), c(T, T, a)) #design matrix in HSD model

for(time.diff in 1:a)
	w[, , time.diff] = 1*(as.matrix(dist(1:T, 1:T, method="manhattan")) 
 ==time.diff)

#Generate a data with HSD model
 HSD.sim.data = SimulatedDataGenerator(
 Num.of.Obs = N, Num.of.TimePoints = T, Fixed.Effs = Fixed.Effs, 
 Random.Effs = list(Sigma = 0.5*diag(1), df=3), 
Cor.in.DesignMat = 0., Missing = list(Missing.Mechanism = 2, 
 RegCoefs = c(-1.5, 1.2)), Cor.Str = "HSD", 
 HSD.DesignMat.para = list(HSD.para = HSD.para, DesignMat = w))

hyper.params = list(
        sigma2.beta = 1,
        sigma2.delta = 1,
        v.gamma = 5,
        InvWishart.df = 5,
        InvWishart.Lambda = diag(q) )

HSD.output = BayesRobustProbit(
fixed = as.formula(paste("y~-1+", paste0("x", 1:P, collapse="+"))), 
data=HSD.sim.data$sim.data, random = ~ 1, Robustness=TRUE, 
HS.model = ~IndTime1+IndTime2, subset = NULL, na.action='na.exclude', 
hyper.params = hyper.params, num.of.iter = num.of.iter, 
 Interactive=0)

## End(Not run) 
</code></pre>

<hr>
<h2 id='BayesRobustProbitSummary'>To summarizes model estimation outcomes</h2><span id='topic+BayesRobustProbitSummary'></span>

<h3>Description</h3>

<p>It provides basic posterior summary statistics such as the posterior point and
confidence interval estimates of parameters and the values of  information criterion statistics for model comparison.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BayesRobustProbitSummary(object, digits = max(1L, getOption("digits") - 4L))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BayesRobustProbitSummary_+3A_object">object</code></td>
<td>
<p>output from the function <code>BayesRobustProbit</code>.</p>
</td></tr>
<tr><td><code id="BayesRobustProbitSummary_+3A_digits">digits</code></td>
<td>
<p>rounds the values in its first argument to the specified
number of significant digits.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of posterior summary statistics and corresponding model information
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(BayesRGMM)
rm(list=ls(all=TRUE))
Fixed.Effs = c(-0.2, -0.3, 0.8, -0.4) #c(-0.2,-0.8, 1.0, -1.2)
P = length(Fixed.Effs) 
q = 1 #number of random effects
T = 5 #time points
N = 100 #number of subjects
num.of.iter = 100 #number of iterations
HSD.para = c(-0.5,  -0.3) #the parameters in HSD model
a = length(HSD.para)
w = array(runif(T*T*a), c(T, T, a)) #design matrix in HSD model

for(time.diff in 1:a)
	w[, , time.diff] = 1*(as.matrix(dist(1:T, 1:T, method="manhattan")) 
 == time.diff)

#Generate a data with HSD model
HSD.sim.data = SimulatedDataGenerator(Num.of.Obs = N, Num.of.TimePoints = T, 
Fixed.Effs = Fixed.Effs, Random.Effs = list(Sigma = 0.5*diag(1), df=3), 
Cor.in.DesignMat = 0., Missing = list(Missing.Mechanism = 2, 
 RegCoefs = c(-1.5, 1.2)), Cor.Str = "HSD", 
HSD.DesignMat.para = list(HSD.para = HSD.para, DesignMat = w))

hyper.params = list(
        sigma2.beta = 1,
        sigma2.delta = 1,
        v.gamma = 5,
        InvWishart.df = 5,
        InvWishart.Lambda = diag(q) )

HSD.output = BayesRobustProbit(
 fixed = as.formula(paste("y~-1+", paste0("x", 1:P, collapse="+"))), 
	data=HSD.sim.data$sim.data, random = ~ 1, Robustness=TRUE, 
 HS.model = ~IndTime1+IndTime2, subset = NULL, na.action='na.exclude', 
 hyper.params = hyper.params, num.of.iter = num.of.iter, Interactive =0)

BayesRobustProbitSummary(HSD.output)

## End(Not run)
</code></pre>

<hr>
<h2 id='CorrMat.HSD'>To compute the correlation matrix in terms of hypersphere decomposition approach</h2><span id='topic+CorrMat.HSD'></span>

<h3>Description</h3>

<p>The correlation matrix is reparameterized via hyperspherical coordinates angle parameters for <br />
trigonometric functions,
and the angle parameters are referred to hypersphere (HS) parameters. In order to obtain the unconstrained estimation
of angle parameters and to reduce the number of parameters for facilitating the computation,
we model the correlation structures of the responses in terms of the generalized linear models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CorrMat.HSD(w, delta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CorrMat.HSD_+3A_w">w</code></td>
<td>
<p>a design matrix is used to model the HS parameters as functions of subject-specific covariates.</p>
</td></tr>
<tr><td><code id="CorrMat.HSD_+3A_delta">delta</code></td>
<td>
<p>an <code class="reqn">a \times 1</code> vector of unknown parameters to model the HS parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a correlation matrix
</p>


<h3>Author(s)</h3>

<p>Kuo-Jung Lee <a href="mailto:kuojunglee@ncku.edu.tw">kuojunglee@ncku.edu.tw</a>
</p>


<h3>References</h3>


<p>Zhang W, Leng C, Tang CY (2015).
&ldquo;A joint modelling approach for longitudinal studies.&rdquo;
<em>Journal of Royal Statistical Society, Series B</em>, <b>77</b>, 219&ndash;238.

</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(BayesRGMM)
rm(list=ls(all=TRUE))
T = 5 #time points
HSD.para = c(-0.5,  -0.3) #the parameters in HSD model
a = length(HSD.para)
w = array(runif(T*T*a), c(T, T, a)) #design matrix in HSD model
signif(CorrMat.HSD(w, HSD.para), 4)

## End(Not run)
</code></pre>

<hr>
<h2 id='GSPS'>The German socioeconomic panel study data</h2><span id='topic+GSPS'></span>

<h3>Description</h3>

<p>The German socioeconomic panel study data was taken from the first twelve annual waves (1984 through 1995)
of the German Socioeconomic Panel (GSOEP) which surveys a representative sample of East and West German households.
The data provide detailed information on the utilization of health care facilities, characteristics of current
employment, and the insurance schemes under which individuals are covered. We consider the sample of individuals
aged 25 through 65 from the West German subsample and of German nationality.
The sample contained 3691 male and 3689 female individuals which make up a sample of 14,243 male and 13,794 female
person-year observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(GSPS)
</code></pre>


<h3>Format</h3>

<p>A data frame with 27326 rows and 25 variables
</p>

<dl>
<dt>id</dt><dd><p>	     person - identification number</p>
</dd>
<dt>female</dt><dd><p>	     female = 1; male = 0</p>
</dd>
<dt>year</dt><dd><p>	     calendar year of the observation</p>
</dd>
<dt>age</dt><dd><p>	     age in years</p>
</dd>
<dt>hsat</dt><dd><p>	     health satisfaction, coded 0 (low) - 10 (high)</p>
</dd>
<dt>handdum</dt><dd><p>	     handicapped = 1; otherwise = 0</p>
</dd>
<dt>handper</dt><dd><p>	     degree of handicap in percent (0 - 100)</p>
</dd>
<dt>hhninc</dt><dd><p>	     household nominal monthly net income in German marks / 1000</p>
</dd>
<dt>hhkids</dt><dd><p>	     children under age 16 in the household = 1; otherwise = 0</p>
</dd>
<dt>educ</dt><dd><p>	     years of schooling</p>
</dd>
<dt>married</dt><dd><p>	     married = 1; otherwise = 0</p>
</dd>
<dt>haupts</dt><dd><p>	     highest schooling degree is Hauptschul degree = 1; otherwise = 0</p>
</dd>
<dt>reals</dt><dd><p>	     highest schooling degree is Realschul degree = 1; otherwise = 0</p>
</dd>
<dt>fachhs</dt><dd><p>	     highest schooling degree is Polytechnical degree = 1; otherwise = 0</p>
</dd>
<dt>abitur</dt><dd><p>	     highest schooling degree is Abitur = 1; otherwise = 0</p>
</dd>
<dt>univ</dt><dd><p>	     highest schooling degree is university degree = 1; otherwise = 0</p>
</dd>
<dt>working</dt><dd><p>	     employed = 1; otherwise = 0</p>
</dd>
<dt>bluec</dt><dd><p>	     blue collar employee = 1; otherwise = 0</p>
</dd>
<dt>whitec</dt><dd><p>	     white collar employee = 1; otherwise = 0</p>
</dd>
<dt>self</dt><dd><p>	     self employed = 1; otherwise = 0</p>
</dd>
<dt>beamt</dt><dd><p>	     civil servant = 1; otherwise = 0</p>
</dd>
<dt>docvis</dt><dd><p>	     number of doctor visits in last three months</p>
</dd>
<dt>hospvis</dt><dd><p>	     number of hospital visits in last calendar year</p>
</dd>
<dt>public</dt><dd><p>	     insured in public health insurance = 1; otherwise = 0</p>
</dd>
<dt>addon</dt><dd><p>	     insured by add-on insurance = 1; otherswise = 0</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="http://qed.econ.queensu.ca/jae/2003-v18.4/riphahn-wambach-million/">JAE Archive</a>
</p>


<h3>References</h3>


<p>Riphahn RT, Wambach A, Million A (2003).
&ldquo;Incentive effects in the demand for health care: a bivariate panel count data estimation.&rdquo;
<em>Journal of Applied Econometrics</em>, <b>18</b>(4), 387&ndash;405.

</p>

<hr>
<h2 id='SimulatedDataGenerator'>Generate simulated data with either ARMA or MCD correlation structures.</h2><span id='topic+SimulatedDataGenerator'></span>

<h3>Description</h3>

<p>This function is used to generate simulated data for simulation studies with ARMA and MCD correlation structures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimulatedDataGenerator(
  Num.of.Obs,
  Num.of.TimePoints,
  Fixed.Effs,
  Random.Effs,
  Cor.in.DesignMat,
  Missing,
  Cor.Str,
  HSD.DesignMat.para,
  ARMA.para
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimulatedDataGenerator_+3A_num.of.obs">Num.of.Obs</code></td>
<td>
<p>the number of subjects will be simulated.</p>
</td></tr>
<tr><td><code id="SimulatedDataGenerator_+3A_num.of.timepoints">Num.of.TimePoints</code></td>
<td>
<p>the maximum number of time points among all subjects.</p>
</td></tr>
<tr><td><code id="SimulatedDataGenerator_+3A_fixed.effs">Fixed.Effs</code></td>
<td>
<p>a vector of regression coefficients.</p>
</td></tr>
<tr><td><code id="SimulatedDataGenerator_+3A_random.effs">Random.Effs</code></td>
<td>
<p>a list of covariance matrix and the degree of freedom, <br />
e.g., <code>list(Sigma = 0.5*diag(1), df=3)</code>.</p>
</td></tr>
<tr><td><code id="SimulatedDataGenerator_+3A_cor.in.designmat">Cor.in.DesignMat</code></td>
<td>
<p>the correlation of covariates in the design matrix.</p>
</td></tr>
<tr><td><code id="SimulatedDataGenerator_+3A_missing">Missing</code></td>
<td>
<p>a list of the missing mechanism of observations, 0: data is complete, 1: missing complete at random, 2: missing at random related to responses , and 3: 2: missing at random related to covariates and the corresponding regression coefficients (weights) on the previous observed values either responses or covariates, e.g.,  <code>Missing = list(Missing.Mechanism = 3, RegCoefs = c(0.4, 1.2, -2.1))</code>.</p>
</td></tr>
<tr><td><code id="SimulatedDataGenerator_+3A_cor.str">Cor.Str</code></td>
<td>
<p>the model for correlation structure, <code style="white-space: pre;">&#8288;ARMA'' or &#8288;</code>HSD&rdquo;.</p>
</td></tr>
<tr><td><code id="SimulatedDataGenerator_+3A_hsd.designmat.para">HSD.DesignMat.para</code></td>
<td>
<p>if <code>Cor.Str="HSD"</code>, you need to specify the list of parameters in HSD correlation structure, <br />
e.g., <code>HSD.DesignMat.para = list(HSD.para = HSD.para, DesignMat = w)</code>.</p>
</td></tr>
<tr><td><code id="SimulatedDataGenerator_+3A_arma.para">ARMA.para</code></td>
<td>
<p>if <code>Cor.Str="ARMA"</code>, you need to specify the list of parameters in AMRA correlation structure, e.g., <code>ARMA.para = list(AR.para=0.1, MA.para=0.2)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing the following components:
</p>

<dl>
<dt>sim.data</dt><dd><p>The simulated response variables <code class="reqn">y</code>, covariates <code class="reqn">x</code>'s, and subject identifcation &lsquo;<span class="samp">&#8288;id&#8288;</span>&rsquo;.</p>
</dd>
<dt>beta.true</dt><dd><p>The given values of fixed effects .</p>
</dd>
<dt>ARMA.para</dt><dd><p>The given values of parameters in ARMA model.</p>
</dd>
<dt>HSD.para</dt><dd><p>The given values of parameters in ARMA model.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(BayesRGMM)
rm(list=ls(all=TRUE))
Fixed.Effs = c(-0.2, -0.3, 0.8, -0.4) 
P = length(Fixed.Effs) 
q = 1 #number of random effects
T = 5 #time points
N = 100 #number of subjects
num.of.iter = 100 #number of iterations
HSD.para = c(-0.5,  -0.3) #the parameters in HSD model
a = length(HSD.para)
w = array(runif(T*T*a), c(T, T, a)) #design matrix in HSD model

for(time.diff in 1:a)
	w[, , time.diff] = 1*(as.matrix(dist(1:T, 1:T, method="manhattan")) 
 ==time.diff)

#Generate a data with HSD model
HSD.sim.data = SimulatedDataGenerator(Num.of.Obs = N, Num.of.TimePoints = T, 
Fixed.Effs = Fixed.Effs, Random.Effs = list(Sigma = 0.5*diag(1), df=3), 
Cor.in.DesignMat = 0., Missing = list(Missing.Mechanism = 2, 
 RegCoefs = c(-1.5, 1.2)), Cor.Str = "HSD", 
 HSD.DesignMat.para = list(HSD.para = HSD.para, DesignMat = w))

#the proportion of 1's
ones = sum(HSD.sim.data$sim.data$y==1, na.rm=T)
num.of.obs = sum(!is.na(HSD.sim.data$sim.data$y))
print(ones/num.of.obs) 

#the missing rate in the simulated data 
print(sum(is.na(HSD.sim.data$sim.data$y)))


#===========================================================================#
#Generate a data with ARMA model
ARMA.sim.data = SimulatedDataGenerator(Num.of.Obs = N, Num.of.TimePoints = T, 
	Fixed.Effs = Fixed.Effs, Random.Effs = list(Sigma = 0.5*diag(1), df=3), 
	Cor.in.DesignMat = 0., list(Missing.Mechanism = 2, RegCoefs = c(-1.5, 1.2)), 
	Cor.Str = "ARMA", ARMA.para=list(AR.para = 0.8))

## End(Not run)
</code></pre>

<hr>
<h2 id='SimulatedDataGenerator.CumulativeProbit'>Simulating a longitudinal ordinal data with HSD correlation structures.</h2><span id='topic+SimulatedDataGenerator.CumulativeProbit'></span>

<h3>Description</h3>

<p>This function is used to simulate data for the cumulative probit mixed-effects model with HSD correlation structures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimulatedDataGenerator.CumulativeProbit(
  Num.of.Obs,
  Num.of.TimePoints,
  Num.of.Cats,
  Fixed.Effs,
  Random.Effs,
  DesignMat,
  Missing,
  HSD.DesignMat.para
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimulatedDataGenerator.CumulativeProbit_+3A_num.of.obs">Num.of.Obs</code></td>
<td>
<p>the number of subjects will be simulated.</p>
</td></tr>
<tr><td><code id="SimulatedDataGenerator.CumulativeProbit_+3A_num.of.timepoints">Num.of.TimePoints</code></td>
<td>
<p>the maximum number of time points among all subjects.</p>
</td></tr>
<tr><td><code id="SimulatedDataGenerator.CumulativeProbit_+3A_num.of.cats">Num.of.Cats</code></td>
<td>
<p>the number of categories.</p>
</td></tr>
<tr><td><code id="SimulatedDataGenerator.CumulativeProbit_+3A_fixed.effs">Fixed.Effs</code></td>
<td>
<p>a vector of regression coefficients.</p>
</td></tr>
<tr><td><code id="SimulatedDataGenerator.CumulativeProbit_+3A_random.effs">Random.Effs</code></td>
<td>
<p>a list of covariance matrix and the degree of freedom, <br />
e.g., <code>list(Sigma = 0.5*diag(1), df=3)</code>.</p>
</td></tr>
<tr><td><code id="SimulatedDataGenerator.CumulativeProbit_+3A_designmat">DesignMat</code></td>
<td>
<p>a design matrix.</p>
</td></tr>
<tr><td><code id="SimulatedDataGenerator.CumulativeProbit_+3A_missing">Missing</code></td>
<td>
<p>a list of the missing mechanism of observations, 0: data is complete, 1: missing complete at random, 2: missing at random related to responses , and 3: 2: missing at random related to covariates and the corresponding regression coefficients (weights) on the previous observed values either responses or covariates, e.g.,  <code>Missing = list(Missing.Mechanism = 3, RegCoefs = c(0.4, 1.2, -2.1))</code>.</p>
</td></tr>
<tr><td><code id="SimulatedDataGenerator.CumulativeProbit_+3A_hsd.designmat.para">HSD.DesignMat.para</code></td>
<td>
<p>the list of parameters in HSD correlation structure, <br />
e.g., <code>HSD.DesignMat.para = list(HSD.para = HSD.para, DesignMat = w)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing the following components:
</p>

<dl>
<dt>sim.data</dt><dd><p>The simulated response variables <code class="reqn">y</code>, covariates <code class="reqn">x</code>'s, and subject identifcation &lsquo;<span class="samp">&#8288;id&#8288;</span>&rsquo;.</p>
</dd>
<dt>beta.true</dt><dd><p>The given values of fixed effects.</p>
</dd>
<dt>classes</dt><dd><p>The intervals of classes.</p>
</dd>
<dt>HSD.para</dt><dd><p>The given values of parameters in HSD model.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(BayesRGMM)
rm(list=ls(all=TRUE))

Fixed.Effs = c(-0.1, 0.1, -0.1)  
P = length(Fixed.Effs) 
q = 1 #number of random effects
T = 7 #time points
N = 100 #number of subjects
Num.of.Cats = 3 #number of categories 
num.of.iter = 1000 #number of iterations

HSD.para = c(-0.9, -0.6) #the parameters in HSD model
a = length(HSD.para)
w = array(runif(T*T*a), c(T, T, a)) #design matrix in HSD model
 
for(time.diff in 1:a)
w[, , time.diff] = 1*(as.matrix(dist(1:T, 1:T, method="manhattan")) 
==time.diff)


x = array(0, c(T, P, N))
for(i in 1:N){
    x[, 1, i] = 1:T
    x[, 2, i] = rbinom(1, 1, 0.5)
    x[, 3, i] = x[, 1, i]*x[, 2, i]
}

DesignMat = x

#MAR
CPREM.sim.data = SimulatedDataGenerator.CumulativeProbit(
 Num.of.Obs = N, Num.of.TimePoints = T, Num.of.Cats = Num.of.Cats, 
 Fixed.Effs = Fixed.Effs, Random.Effs = list(Sigma = 0.5*diag(1), df=3), 
 DesignMat = DesignMat, Missing = list(Missing.Mechanism = 2, 
 MissingRegCoefs=c(-0.7, -0.2, -0.1)), 
 HSD.DesignMat.para = list(HSD.para = HSD.para, DesignMat = w))


print(table(CPREM.sim.data$sim.data$y))
print(CPREM.sim.data$classes)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
