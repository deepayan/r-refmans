<!DOCTYPE html><html lang="en"><head><title>Help for package PLmixed</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PLmixed}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#PLmixed-package'><p>PLmixed: A package for estimating GLMMs with factor structures.</p></a></li>
<li><a href='#coef.PLmod'><p>coef.PLmod</p></a></li>
<li><a href='#fitted.PLmod'><p>fitted.PLmod</p></a></li>
<li><a href='#fixef.PLmod'><p>fixef.PLmod</p></a></li>
<li><a href='#IRTsim'><p>Simulated multilevel IRT dataset.</p></a></li>
<li><a href='#iterPlot'><p>iterPlot</p></a></li>
<li><a href='#JUDGEsim'><p>Simulated Multi-rater Multi-response dataset.</p></a></li>
<li><a href='#KYPSitemsim'><p>Simulated KYPS item-level dataset.</p></a></li>
<li><a href='#KYPSsim'><p>Simulated KYPS dataset.</p></a></li>
<li><a href='#PLmixed'><p>Fit GLMM with Factor Structure</p></a></li>
<li><a href='#plot.PLmod'><p>plot.PLmod</p></a></li>
<li><a href='#predict.PLmod'><p>predict.PLmod</p></a></li>
<li><a href='#print.PLmod'><p>print.PLmod</p></a></li>
<li><a href='#print.summary.PLmod'><p>print.summary.PLmod</p></a></li>
<li><a href='#ranef.PLmod'><p>ranef.PLmod</p></a></li>
<li><a href='#residuals.PLmod'><p>residuals.PLmod</p></a></li>
<li><a href='#simulate.PLmod'><p>simulate.PLmod</p></a></li>
<li><a href='#summary.PLmod'><p>summary.PLmod</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Estimate (Generalized) Linear Mixed Models with Factor
Structures</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.7</td>
</tr>
<tr>
<td>Description:</td>
<td>Utilizes the 'lme4' and 'optimx' packages (previously the optim()
    function from 'stats') to estimate (generalized) linear mixed models (GLMM)
    with factor structures using a profile likelihood approach, as outlined in
    Jeon and Rabe-Hesketh (2012) &lt;<a href="https://doi.org/10.3102%2F1076998611417628">doi:10.3102/1076998611417628</a>&gt; and
    Rockwood and Jeon (2019) &lt;<a href="https://doi.org/10.1080%2F00273171.2018.1516541">doi:10.1080/00273171.2018.1516541</a>&gt;.
    Factor analysis and item response models can be extended to allow
    for an arbitrary number of nested and crossed random effects,
    making it useful for multilevel and cross-classified models.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>lme4, Matrix (&ge; 1.1.1), numDeriv, stats, optimx</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, irtoys</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-23 21:51:41 UTC; nicholasrockwood</td>
</tr>
<tr>
<td>Author:</td>
<td>Minjeong Jeon [aut],
  Nicholas Rockwood [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nicholas Rockwood &lt;njrockwood@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-23 22:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='PLmixed-package'>PLmixed: A package for estimating GLMMs with factor structures.</h2><span id='topic+PLmixed-package'></span>

<h3>Description</h3>

<p>The <code>PLmixed</code> package's main function is <code><a href="#topic+PLmixed">PLmixed</a></code>, which estimates
the model through nested maximizations using the <span class="pkg"><a href="lme4.html#topic+lme4">lme4</a></span> and <span class="pkg"><a href="optimx.html#topic+optimx">optimx</a></span> packages
(previously the <code><a href="stats.html#topic+optim">optim</a></code> function). This extends the capabilities of <span class="pkg"><a href="lme4.html#topic+lme4">lme4</a></span>
to allow for estimated factor structures, making it useful for estimating multilevel
factor analysis and item response theory models with an arbitrary number of hierarchical
levels or crossed random effects.
</p>


<h3>References</h3>

<p>Rockwood, N. J., &amp; Jeon, M. (2019). Estimating complex measurement and growth models
using the R package PLmixed.<em>Multivariate Behavioral Research, 54</em>(2), 288-306.
</p>
<p>Jeon, M., &amp; Rabe-Hesketh, S. (2012). Profile-likelihood approach for estimating
generalized linear mixed models with factor structures. <em>Journal of Educational
and Behavioral Statistics, 37</em>(4), 518-542.
</p>

<hr>
<h2 id='coef.PLmod'>coef.PLmod</h2><span id='topic+coef.PLmod'></span>

<h3>Description</h3>

<p>Obtain coefficients for a model of class PLmod.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PLmod'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.PLmod_+3A_object">object</code></td>
<td>
<p>an object of class PLmod</p>
</td></tr>
<tr><td><code id="coef.PLmod_+3A_...">...</code></td>
<td>
<p>Additional arguments from <code><a href="lme4.html#topic+coef.merMod">coef.merMod</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sum of the random and fixed effects coefficients for each explanatory variable for
each level of the grouping factor.
</p>

<hr>
<h2 id='fitted.PLmod'>fitted.PLmod</h2><span id='topic+fitted.PLmod'></span>

<h3>Description</h3>

<p>Obtain fitted values for a model of class PLmod.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PLmod'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitted.PLmod_+3A_object">object</code></td>
<td>
<p>an object of class PLmod</p>
</td></tr>
<tr><td><code id="fitted.PLmod_+3A_...">...</code></td>
<td>
<p>Additional arguments from <code><a href="lme4.html#topic+fitted.merMod">fitted.merMod</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='fixef.PLmod'>fixef.PLmod</h2><span id='topic+fixef.PLmod'></span>

<h3>Description</h3>

<p>Obtain fixed effect estimates for a model of class PLmod.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PLmod'
fixef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fixef.PLmod_+3A_object">object</code></td>
<td>
<p>an object of class PLmod</p>
</td></tr>
<tr><td><code id="fixef.PLmod_+3A_...">...</code></td>
<td>
<p>Additional arguments from <code><a href="lme4.html#topic+fixef.merMod">fixef.merMod</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='IRTsim'>Simulated multilevel IRT dataset.</h2><span id='topic+IRTsim'></span>

<h3>Description</h3>

<p>A simulated dataset that replicates the dataset from CITO.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IRTsim
</code></pre>


<h3>Format</h3>

<p>A data frame with 2500 rows and 4 variables:
</p>

<dl>
<dt>sid</dt><dd><p>Student ID</p>
</dd>
<dt>school</dt><dd><p>School ID</p>
</dd>
<dt>item</dt><dd><p>Item ID</p>
</dd>
<dt>y</dt><dd><p>Response</p>
</dd>
</dl>


<hr>
<h2 id='iterPlot'>iterPlot</h2><span id='topic+iterPlot'></span>

<h3>Description</h3>

<p>Plot parameter estimates at each <code><a href="stats.html#topic+optim">optim</a></code> iteration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iterPlot(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="iterPlot_+3A_object">object</code></td>
<td>
<p>an object of class PLmod</p>
</td></tr>
</table>

<hr>
<h2 id='JUDGEsim'>Simulated Multi-rater Multi-response dataset.</h2><span id='topic+JUDGEsim'></span>

<h3>Description</h3>

<p>A simulated dataset that replicates the dataset from a multi-rater
mult-reponse study where teachers and students provided responses
about two student traits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JUDGEsim
</code></pre>


<h3>Format</h3>

<p>A data frame with 54462 rows and 7 variables:
</p>

<dl>
<dt>item</dt><dd><p>Item ID</p>
</dd>
<dt>method</dt><dd><p>1 = teacher response, 2 = student response</p>
</dd>
<dt>trait</dt><dd><p>1 = trait 1, 2 = trait 2</p>
</dd>
<dt>stu</dt><dd><p>Student ID</p>
</dd>
<dt>class</dt><dd><p>Classroom ID</p>
</dd>
<dt>tch</dt><dd><p>Teacher ID</p>
</dd>
<dt>response</dt><dd><p>Item response</p>
</dd>
</dl>


<hr>
<h2 id='KYPSitemsim'>Simulated KYPS item-level dataset.</h2><span id='topic+KYPSitemsim'></span>

<h3>Description</h3>

<p>A simulated dataset that replicates the dataset item-level
data from KYPS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KYPSitemsim
</code></pre>


<h3>Format</h3>

<p>A data frame with 66947 rows and 6 variables:
</p>

<dl>
<dt>id</dt><dd><p>Student ID</p>
</dd>
<dt>time</dt><dd><p>Time Identifier</p>
</dd>
<dt>item</dt><dd><p>Item ID</p>
</dd>
<dt>mid</dt><dd><p>Middle School ID</p>
</dd>
<dt>hid</dt><dd><p>High School ID</p>
</dd>
<dt>response</dt><dd><p>Item Response</p>
</dd>
</dl>


<hr>
<h2 id='KYPSsim'>Simulated KYPS dataset.</h2><span id='topic+KYPSsim'></span>

<h3>Description</h3>

<p>A simulated dataset that replicates the dataset from KYPS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KYPSsim
</code></pre>


<h3>Format</h3>

<p>A data frame with 11494 rows and 5 variables:
</p>

<dl>
<dt>mid</dt><dd><p>Middle School ID</p>
</dd>
<dt>hid</dt><dd><p>High School ID</p>
</dd>
<dt>sid</dt><dd><p>Student ID</p>
</dd>
<dt>time</dt><dd><p>Time Identifier</p>
</dd>
<dt>esteem</dt><dd><p>Self Esteem</p>
</dd>
</dl>


<hr>
<h2 id='PLmixed'>Fit GLMM with Factor Structure</h2><span id='topic+PLmixed'></span>

<h3>Description</h3>

<p>Fit a (generalized) linear mixed effects model (GLMM) with factor structures. Utilizes both the
<span class="pkg"><a href="lme4.html#topic+lme4">lme4</a></span> package and <code><a href="stats.html#topic+optim">optim</a></code> function for estimation using a profile-likelihood based
approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PLmixed(
  formula,
  data,
  family = gaussian,
  load.var = NULL,
  lambda = NULL,
  factor = NULL,
  init = 1,
  nlp = NULL,
  init.nlp = 1,
  nAGQ = 1,
  method = "L-BFGS-B",
  lower = -Inf,
  upper = Inf,
  lme4.optimizer = "bobyqa",
  lme4.start = NULL,
  lme4.optCtrl = list(),
  opt.control = NULL,
  REML = FALSE,
  SE = 1,
  ND.method = "simple",
  check = "stop",
  est = TRUE,
  iter.count = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PLmixed_+3A_formula">formula</code></td>
<td>
<p>A formula following that of <span class="pkg"><a href="lme4.html#topic+lme4">lme4</a></span>, with the addition that factors can be specified
as random effects. Factor names should not be names of variables in the data set, and are instead
defined with the <code>factor</code> argument.</p>
</td></tr>
<tr><td><code id="PLmixed_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables used in the model (but not factor names).</p>
</td></tr>
<tr><td><code id="PLmixed_+3A_family">family</code></td>
<td>
<p>A GLM family, see <code><a href="stats.html#topic+glm">glm</a></code> and <code><a href="stats.html#topic+family">family</a></code>.</p>
</td></tr>
<tr><td><code id="PLmixed_+3A_load.var">load.var</code></td>
<td>
<p>A variable in the dataframe identifying what the factors load onto. Each unique element in <code>load.var</code> will have
a unique factor loading. All rows in the dataset with the same value for <code>load.var</code> will have the same factor loading.</p>
</td></tr>
<tr><td><code id="PLmixed_+3A_lambda">lambda</code></td>
<td>
<p>A matrix or list of matrices corresponding to the loading matrices. A value of NA
indicates the loading is freely estimated, while a numeric entry indicates a constraint.</p>
</td></tr>
<tr><td><code id="PLmixed_+3A_factor">factor</code></td>
<td>
<p>A list of factors corresponding to the loading matrices and factors specified in model.</p>
</td></tr>
<tr><td><code id="PLmixed_+3A_init">init</code></td>
<td>
<p>A scalar (default = <code>1</code>) or vector of initial lambda values. If a scalar, the value is applied to all lambda parameters.
If a vector, the values apply in row by column by matrix order.</p>
</td></tr>
<tr><td><code id="PLmixed_+3A_nlp">nlp</code></td>
<td>
<p>A character vector containing the names of additional nonlinear parameters that are in the model formula.</p>
</td></tr>
<tr><td><code id="PLmixed_+3A_init.nlp">init.nlp</code></td>
<td>
<p>A scalar (default = <code>1</code>) or vector of initial nlp values. If a scalar, the value is applied to all nlp parameters.
If a vector, the values apply in the order listed.</p>
</td></tr>
<tr><td><code id="PLmixed_+3A_nagq">nAGQ</code></td>
<td>
<p>If family is non-gaussian, the number of points per axis for evaluating the adaptive
Gauss-Hermite approximation to the log-likelihood. Defaults to <code>1</code>, corresponding to the Laplace approximation.
See <code><a href="lme4.html#topic+glmer">glmer</a></code>.</p>
</td></tr>
<tr><td><code id="PLmixed_+3A_method">method</code></td>
<td>
<p>The <code><a href="optimx.html#topic+optimx">optimx</a></code> optimization method. Defaults to <code>L-BFGS-B</code>.</p>
</td></tr>
<tr><td><code id="PLmixed_+3A_lower">lower</code></td>
<td>
<p>Lower bound on lambda parameters if applicable.</p>
</td></tr>
<tr><td><code id="PLmixed_+3A_upper">upper</code></td>
<td>
<p>Upper bound on lambda parameters if applicable.</p>
</td></tr>
<tr><td><code id="PLmixed_+3A_lme4.optimizer">lme4.optimizer</code></td>
<td>
<p>The <span class="pkg"><a href="lme4.html#topic+lme4">lme4</a></span> optimization method.</p>
</td></tr>
<tr><td><code id="PLmixed_+3A_lme4.start">lme4.start</code></td>
<td>
<p>Start values used for <span class="pkg"><a href="lme4.html#topic+lme4">lme4</a></span>.</p>
</td></tr>
<tr><td><code id="PLmixed_+3A_lme4.optctrl">lme4.optCtrl</code></td>
<td>
<p>A list controlling the lme4 optimization. See <code><a href="lme4.html#topic+lmerControl">lmerControl</a></code>
or <code><a href="lme4.html#topic+glmerControl">glmerControl</a></code></p>
</td></tr>
<tr><td><code id="PLmixed_+3A_opt.control">opt.control</code></td>
<td>
<p>Controls for the <code><a href="optimx.html#topic+optimx">optimx</a></code> optimization.</p>
</td></tr>
<tr><td><code id="PLmixed_+3A_reml">REML</code></td>
<td>
<p>Use REML if model is linear? Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="PLmixed_+3A_se">SE</code></td>
<td>
<p>Method of calculating standard errors for fixed effects.</p>
</td></tr>
<tr><td><code id="PLmixed_+3A_nd.method">ND.method</code></td>
<td>
<p>Method of calculating numerical derivatives.</p>
</td></tr>
<tr><td><code id="PLmixed_+3A_check">check</code></td>
<td>
<p>Check number of observations vs. levels and number of observations vd. random effects.</p>
</td></tr>
<tr><td><code id="PLmixed_+3A_est">est</code></td>
<td>
<p>Return parameter estimates.</p>
</td></tr>
<tr><td><code id="PLmixed_+3A_iter.count">iter.count</code></td>
<td>
<p>Print the iteration counter during optimization.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Factors are listed within the <code>formula</code> in the same way that random effects are specified
in <span class="pkg"><a href="lme4.html#topic+lme4">lme4</a></span>. The grouping variable listed after <code>|</code> defines what the factor values randomly
vary over, just as <code>|</code> does for other random effects. The names of factors and other random
effect terms can be listed within the same set of parentheses, allowing the covariance between the
factor(s) and random effect(s) to be estimated. The same factor may be specified for multiple grouping
variables, allowing for multilevel or crossed effects.
</p>
<p>The <code>factor</code> argument must list any factor that appears in the <code>formula</code>. The ordering will
depend on the ordering of the matrices listed within <code>lambda</code>. The matrices in <code>lambda</code>
specify the factor loading matrices. The number of matrices in <code>lambda</code> should equal the number
of character vectors in <code>factor</code> and the number of elements in <code>load.var</code>. The number of
rows in the <em>k</em>th matrix listed in <code>lambda</code> should correspond to the number of unique elements
in the dataset for the <em>k</em>th variable listed in <code>load.var</code>, and the number of columns in the <em>k</em>th
matrix should correspond to the number of factors listed in the <em>k</em>th character vector of <code>factor</code>.
</p>
<p>Within the <em>k</em>th matrix, the <em>(i, j)</em> cell corresponds to the factor loading for the <em>i</em>th unique element
of the <em>k</em>th variable listed in <code>load.var</code> on the <em>j</em>th factor listed in the <em>k</em>th character vector
of <code>factor</code>. Each element of the matrix should be either a number or <code>NA</code>. If the element is a
number, the loading will be constrained to that value. If the element is an <code>NA</code>, the loading will
be freely estimated. For identification, it is necessary (but not sufficient) for at least one element in
each column to be constrained.
</p>
<p>The <code>nlp</code> argument can be viewed as a special case of the <code>factor</code> argument, where the character vector
listed in <code>nlp</code> is automatically linked to 1 x p lambda matrix, where p is the number of elements in <code>nlp</code>.
The <code>load.var</code> for these parameters is viewed as a constant, so that the <code>nlp</code> parameters are equivalent for
all rows in the dataset. Thus, <code>nlp</code> simplifies the process of adding additional nonlinear parameters to the model
without having to specify corresponding <code>lambda</code> and <code>load.var</code> values.
</p>


<h3>Value</h3>

<p>An object of class <code>PLmod</code>, which contains an object of class <code>merMod</code> as one of its elements.
Some functions for class <code>merMod</code> have been adapted to work with class <code>PLmod</code>. Others can be utilized
using <code>object$'lme4 Model'</code>, where <code>object</code> is an object of class <code>PLmod</code>.
</p>


<h3>References</h3>

<p>Rockwood, N. J., &amp; Jeon, M. (2019). Estimating complex measurement and growth models
using the R package PLmixed.<em>Multivariate Behavioral Research, 54</em>(2), 288-306.
</p>
<p>Jeon, M., &amp; Rabe-Hesketh, S. (2012). Profile-likelihood approach for estimating
generalized linear mixed models with factor structures. <em>Journal of Educational
and Behavioral Statistics, 37</em>(4), 518-542.
</p>


<h3>See Also</h3>

<p><span class="pkg"><a href="lme4.html#topic+lme4">lme4</a></span>
</p>
<p><code><a href="lme4.html#topic+glmer">glmer</a></code>
</p>
<p><code><a href="lme4.html#topic+lmer">lmer</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("IRTsim") # Load the IRTsim data

IRTsub &lt;- IRTsim[IRTsim$item &lt; 4, ] # Select items 1-3
set.seed(12345)
IRTsub &lt;- IRTsub[sample(nrow(IRTsub), 300), ] # Randomly sample 300 responses

IRTsub &lt;- IRTsub[order(IRTsub$item), ] # Order by item
irt.lam = c(1, NA, NA) # Specify the lambda matrix

# Below, the # in front of family = binomial can be removed to change the response distribution
# to binomial, where the default link function is logit.

irt.model &lt;- PLmixed(y ~ 0 + as.factor(item) + (0 + abil.sid |sid) +(0 + abil.sid |school),
                     data = IRTsub, load.var = c("item"), # family = binomial,
                     factor = list(c("abil.sid")), lambda = list(irt.lam))
summary(irt.model)

## Not run: 
# A more time-consuming example.
# ~ 5-10 minutes

data("KYPSsim") # Load the KYPSsim data

kyps.lam &lt;- rbind(c( 1,  0),  # Specify the lambda matrix
                  c(NA,  0),
                  c(NA,  1),
                  c(NA, NA))

kyps.model &lt;- PLmixed(esteem ~ as.factor(time) +  (0 + hs | hid)
                      + (0 + ms | mid) + (1 | sid), data = KYPSsim,
                      factor = list(c("ms", "hs")), load.var = c("time"),
                      lambda = list(kyps.lam))
summary(kyps.model)

data("JUDGEsim")
JUDGEsim &lt;- JUDGEsim[order(JUDGEsim$item), ] # Order by item
unique(JUDGEsim$item)

# Specify Lambda matrix
judge.lam &lt;- rbind(c( 1,  0,  1,  0,  0,  0),
                   c(NA,  0, NA,  0,  0,  0),
                   c(NA,  0, NA,  0,  0,  0),
                   c( 0,  1,  0,  1,  0,  0),
                   c( 0, NA,  0, NA,  0,  0),
                   c( 0, NA,  0, NA,  0,  0),
                   c( 0,  0,  0,  0,  1,  0),
                   c( 0,  0,  0,  0, NA,  0),
                   c( 0,  0,  0,  0, NA,  0),
                   c( 0,  0,  0,  0,  0,  1),
                   c( 0,  0,  0,  0,  0, NA),
                   c( 0,  0,  0,  0,  0, NA))

# Conduct analysis
judge.example &lt;- PLmixed(response ~ 0 + as.factor(item) + (1 | class)
                         + (0 + trait1.t + trait2.t + trait1.s + trait2.s | stu)
                         + (0 + teacher1 + teacher2 | tch), data = JUDGEsim,
                         lambda = list(judge.lam), load.var = "item",
                         factor = list(c("teacher1", "teacher2", "trait1.t",
                                         "trait2.t", "trait1.s", "trait2.s")))

summary(judge.example)

data("KYPSitemsim")

time.lam &lt;- rbind(c( 1,  0),  # Specify time lambda matrix
                  c(NA,  0),
                  c(NA,  1),
                  c(NA, NA))

item.lam &lt;- c(1, NA, NA, NA, NA, NA) # Specify item lambda matrix

KYPSitemsim$time2 &lt;- (KYPSitemsim$time == 2) * 1
KYPSitemsim$time3 &lt;- (KYPSitemsim$time == 3) * 1
KYPSitemsim$time4 &lt;- (KYPSitemsim$time == 4) * 1

kyps.item.model &lt;- PLmixed(response ~ 0 + as.factor(item) + lat.var:time2
                           + lat.var:time3 + lat.var:time4 + (0 + hs:lat.var | hid)
                           + (0 + ms:lat.var | mid) + (0 + lat.var:as.factor(time) | id),
                           data = KYPSitemsim, lambda = list(time.lam, item.lam),
                           factor = list(c("ms", "hs"), "lat.var"),
                           load.var = c("time", "item"))

summary(kyps.item.model)


## End(Not run)

</code></pre>

<hr>
<h2 id='plot.PLmod'>plot.PLmod</h2><span id='topic+plot.PLmod'></span>

<h3>Description</h3>

<p>Diagnostic plots for a model of class PLmod.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PLmod'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.PLmod_+3A_x">x</code></td>
<td>
<p>an object of class PLmod</p>
</td></tr>
<tr><td><code id="plot.PLmod_+3A_...">...</code></td>
<td>
<p>Additional arguments from <code><a href="lme4.html#topic+plot.merMod">plot.merMod</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='predict.PLmod'>predict.PLmod</h2><span id='topic+predict.PLmod'></span>

<h3>Description</h3>

<p>Predict response values from a model of class PLmod.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PLmod'
predict(object, newdata = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.PLmod_+3A_object">object</code></td>
<td>
<p>an object of class PLmod</p>
</td></tr>
<tr><td><code id="predict.PLmod_+3A_newdata">newdata</code></td>
<td>
<p>data frame to obtain predictions for</p>
</td></tr>
<tr><td><code id="predict.PLmod_+3A_...">...</code></td>
<td>
<p>Additional arguments from <code><a href="lme4.html#topic+predict.merMod">predict.merMod</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='print.PLmod'>print.PLmod</h2><span id='topic+print.PLmod'></span>

<h3>Description</h3>

<p>Print the fitted PLmixed model object of class PLmod.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PLmod'
print(x, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.PLmod_+3A_x">x</code></td>
<td>
<p>an object of class PLmod</p>
</td></tr>
<tr><td><code id="print.PLmod_+3A_digits">digits</code></td>
<td>
<p>minimal number of significant digits, see <code><a href="base.html#topic+print.default">print.default</a></code>.</p>
</td></tr>
<tr><td><code id="print.PLmod_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='print.summary.PLmod'>print.summary.PLmod</h2><span id='topic+print.summary.PLmod'></span>

<h3>Description</h3>

<p>Print the output for a PLmixed model object of class PLmod.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.PLmod'
print(x, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.PLmod_+3A_x">x</code></td>
<td>
<p>an object of class PLmod</p>
</td></tr>
<tr><td><code id="print.summary.PLmod_+3A_digits">digits</code></td>
<td>
<p>minimal number of significant digits, see <code><a href="base.html#topic+print.default">print.default</a></code>.</p>
</td></tr>
<tr><td><code id="print.summary.PLmod_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='ranef.PLmod'>ranef.PLmod</h2><span id='topic+ranef.PLmod'></span>

<h3>Description</h3>

<p>Obtain conditional modes of the random effects for a model of class PLmod.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PLmod'
ranef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ranef.PLmod_+3A_object">object</code></td>
<td>
<p>an object of class PLmod</p>
</td></tr>
<tr><td><code id="ranef.PLmod_+3A_...">...</code></td>
<td>
<p>Additional arguments from <code><a href="lme4.html#topic+ranef.merMod">ranef.merMod</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='residuals.PLmod'>residuals.PLmod</h2><span id='topic+residuals.PLmod'></span>

<h3>Description</h3>

<p>Obtain residuals for a model of class PLmod.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PLmod'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residuals.PLmod_+3A_object">object</code></td>
<td>
<p>an object of class PLmod</p>
</td></tr>
<tr><td><code id="residuals.PLmod_+3A_...">...</code></td>
<td>
<p>Additional arguments from <code><a href="lme4.html#topic+residuals.merMod">residuals.merMod</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='simulate.PLmod'>simulate.PLmod</h2><span id='topic+simulate.PLmod'></span>

<h3>Description</h3>

<p>Simulate responses from a model of class PLmod.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PLmod'
simulate(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate.PLmod_+3A_object">object</code></td>
<td>
<p>an object of class PLmod</p>
</td></tr>
<tr><td><code id="simulate.PLmod_+3A_...">...</code></td>
<td>
<p>Additional arguments from <code><a href="lme4.html#topic+simulate.merMod">simulate.merMod</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='summary.PLmod'>summary.PLmod</h2><span id='topic+summary.PLmod'></span>

<h3>Description</h3>

<p>Obtain key output for a fitted PLmixed model object of class PLmod.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PLmod'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.PLmod_+3A_object">object</code></td>
<td>
<p>an object of class PLmod</p>
</td></tr>
<tr><td><code id="summary.PLmod_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object containing all parameter estimates and model characteristics.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
