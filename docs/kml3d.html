<!DOCTYPE html><html><head><title>Help for package kml3d</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {kml3d}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#kml3d-package'><p>~ Overview: KmL3D, K-means for joint Longitudinal data ~</p></a></li>
<li><a href='#affectIndiv3d'>
<p>~ Function: affectIndiv3d ~</p></a></li>
<li><a href='#calculTrajMean3d'>
<p>~ Function: calculTrajMean3d ~</p></a></li>
<li><a href='#clusterLongData3d'><p> ~ Function: clusterLongData3d (or cld3d) ~</p></a></li>
<li><a href='#ClusterLongData3d-class'><p>~ Class: ClusterLongData3d ~</p></a></li>
<li><a href='#dist3d'>
<p>~ Function: dist3d ~</p></a></li>
<li><a href='#generateArtificialLongData3d'><p>~ Function: generateArtificialLongData3d (or gald3d) ~</p></a></li>
<li><a href='#kml3d'><p>~ Algorithm kml3d: K-means for Joint Longitidinal data ~</p></a></li>
<li><a href='#parKml3d'><p> ~ Function: parKml3d ~</p></a></li>
<li><a href='#plot+2CClusterLongData3d'><p> ~ Function: plot for ClusterLongData3d ~</p></a></li>
<li><a href='#plot3d+2CClusterLongData3d'><p> ~ Function: plot3d for ClusterLongData3d ~</p></a></li>
<li><a href='#plot3dPdf'>
<p>~ Function: plot3dPdf for ClusterLongData3d ~</p></a></li>
<li><a href='#plotMeans3d+2CClusterLongData3d'><p> ~ Function: plotMeans3d for ClusterLongData3d ~</p></a></li>
<li><a href='#plotTraj3d+2CClusterLongData3d'><p> ~ Function: plotTraj3d for ClusterLongData3d ~</p></a></li>
<li><a href='#pregnandiol'><p>~ Pregnandiol measure (from QUIDEL database, René Écochard) ~</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>K-Means for Joint Longitudinal Data</td>
</tr>
<tr>
<td>Version:</td>
<td>2.4.6.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-02-11</td>
</tr>
<tr>
<td>Description:</td>
<td>An implementation of k-means specifically design
        to cluster joint trajectories (longitudinal data on
        several variable-trajectories).
        Like 'kml', it provides facilities to deal with missing
        value, compute several quality criterion (Calinski and Harabatz,
        Ray and Turie, Davies and Bouldin, BIC,...) and propose a graphical
        interface for choosing the 'best' number of clusters. In addition, the 3D graph
        representing the mean joint-trajectories of each cluster can be exported through
        LaTeX in a 3D dynamic rotating PDF graph.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.r-project.org">https://www.r-project.org</a></td>
</tr>
<tr>
<td>Collate:</td>
<td>global.r distance3d.r clusterLongData3d.r kml3d.r</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), methods, clv, rgl, misc3d, longitudinalData (&ge;
2.4.2), kml (&ge; 2.4.1)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-11 19:18:55 UTC; hornik</td>
</tr>
<tr>
<td>Author:</td>
<td>Christophe Genolini [cre, aut],
  Bruno Falissard [ctb],
  Patrice Kiener [ctb],
  Jean-Baptiste Pingault [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Christophe Genolini &lt;christophe.genolini@u-paris10.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-13 17:27:48 UTC</td>
</tr>
</table>
<hr>
<h2 id='kml3d-package'>~ Overview: KmL3D, K-means for joint Longitudinal data ~</h2><span id='topic+kml3d-package'></span><span id='topic++5B+2CParChoice-method'></span><span id='topic++5B+3C-+2CParChoice-method'></span>

<h3>Description</h3>

<p><code>KmL3D</code> is a new implementation of k-means for longitudinal data (or trajectories).
Here is an overview of the package.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
    Package: </td><td style="text-align: left;"> KmL3D</td>
</tr>
<tr>
 <td style="text-align: left;">
    Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
    Version: </td><td style="text-align: left;"> 2.4.2</td>
</tr>
<tr>
 <td style="text-align: left;">
    Date: </td><td style="text-align: left;"> 2017-08-01</td>
</tr>
<tr>
 <td style="text-align: left;">
    License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
    LazyData: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
    Depends: </td><td style="text-align: left;"> methods,graphics,rgl,misc3d,longitudinalData(&gt;=2.2),KmL(&gt;=2.2)</td>
</tr>
<tr>
 <td style="text-align: left;">
    URL:</td><td style="text-align: left;"> http://www.r-project.org</td>
</tr>
<tr>
 <td style="text-align: left;">
    URL:</td><td style="text-align: left;"> http://christophe.genolini.free.fr/kml</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Overview</h3>

<p>To cluster data, <code>KmL3D</code> go through three steps, each of which
is associated to some functions:
</p>

<ol>
<li><p> Data preparation
</p>
</li>
<li><p> Building &quot;optimal&quot; clusterization.
</p>
</li>
<li><p> Exporting results
</p>
</li>
<li><p> Visualizing and exporting 3D object
</p>
</li></ol>



<h3>1. Data preparation</h3>

<p><code>kml3d</code> works on object of class <code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code>.
Data preparation therefore simply consists in transforming data into an object <code>ClusterLongData3d</code>.
This can be done via function
<code><a href="#topic+clusterLongData3d">clusterLongData3d</a></code>
(<code><a href="#topic+clusterLongData3d">cld3d</a></code> in short) that
converts a <code>data.frame</code> or an <code>array</code> into a <code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code>.
</p>
<p>Working on several variables mesured on different scales can give to
much weight to one of the dimension. So the function <code><a href="base.html#topic+scale">scale</a></code> normalizes data.
</p>
<p>Instead of working on real data, one can also work on artificial
data. Such data can be created with <code><a href="#topic+generateArtificialLongData3d">generateArtificialLongData3d</a></code>
(<code><a href="#topic+gald3d">gald3d</a></code> in short).
</p>


<h3>2. Building &quot;optimal&quot; clustering</h3>

<p>Once an object of class <code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code> has been created, the algorithm
<code><a href="#topic+kml3d">kml3d</a></code> can be run.
</p>
<p>Starting with a <code>ClusterLongData3d</code>, <code>kml3d</code> built several <code><a href="longitudinalData.html#topic+Partition-class">Partition</a></code>.
A object of class <code>Partition</code> is a partition of trajectories
into subgroups. It also contains some information like the
percentage of trajectories contained in each group or some quality critetion (like the Calinski &amp;
Harabasz).<br />
</p>
<p><code>k-means</code> is a &quot;hill-climbing&quot; algorithm. The specificity of this
kind of algorithm is that it always converges towards a maximum, but
one cannot know whether it is a local or a global maximum. It offers
no guarantee of optimality.
</p>
<p>To maximize one's chances of getting a quality <code>Partition</code>,
it is better to execute the hill climbing algorithm several times,
then to choose the best solution. By default, <code>kml3d</code> executes the hill climbing algorithm 20 times.
</p>
<p>To date, it is not possible to know the optimum number of clusters
even if the calculatous of some qualities criterion can gives some
clues. <code>kml3d</code> computes various of them.
</p>
<p>In the end, <code>kml3d</code> tests by default 2, 3, 4, 5 et 6 clusters, 20 times each.
</p>


<h3>3. Exporting results</h3>

<p>When <code><a href="#topic+kml3d">kml3d</a></code> has constructed some
<code>Partition</code>, the user can examine them one by one and choose
to export some. This can be done via function
<code><a href="kml.html#topic+choice">choice</a></code>. <code>choice</code> opens a graphic windows showing
various information including the trajectories cluterized by a specific
<code>Partition</code>.
</p>
<p>When some <code>Partition</code> has been selected (the user can select
more than 1), it is possible to
save them. The clusters are therefore exported towards the file
<code>name-cluster.csv</code>. Criteria are exported towards
<code>name-criteres.csv</code>. The graphs are exported according to their
extension.
</p>


<h3>4. Visualizing and exporting 3D object</h3>

<p><code>KmL3D</code> also propose tools to visualize the trajectories in
3D. <code><a href="#topic+plot3d">plot3d</a></code> using the library <code>rgl</code> to plot two
variables according to time (either the all set of joint-trajectories, or
just the mean joint-trajectories). Then the user can make the
graphical representation turn using the mouse. <code><a href="#topic+plot3dPdf">plot3dPdf</a></code> build an
<code><a href="misc3d.html#topic+makeTriangles">Triangles</a></code> object. These kind of
object can be include in a <code>pdf</code> file using
<code><a href="longitudinalData.html#topic+saveTrianglesAsASY">saveTrianglesAsASY</a></code> and the software
<code>asymptote</code>. Once again, it is possible to make the image in the
pdf file move using the mouse -so the reader gets real 3D-.
</p>


<h3>How to get help?</h3>

<p>For those who are not familiar with S4 programming:
In S4 programming, each function can be adapted for some specific
arguments.
</p>

<ul>
<li><p>To get help on a function (for example <code>plot</code>), use:
<code>?(plot)</code>.
</p>
</li>
<li><p>To get help on a function adapted to its argument (for example <code>plot</code>
on argument <code>ClusterLongData</code>), used: <code>?"plot,ClusterLongData"</code>.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
### Move to tempdir
wd &lt;- getwd()
setwd(tempdir()); getwd()

### 1. Data Preparation
data(pregnandiol)
names(pregnandiol)
cld3dPregTemp &lt;- cld3d(pregnandiol,timeInData=list(temp=1:30*2,preg=1:30*2+1))

### 2. Building "optimal" clusteration (with only 2 redrawings)
###    Real analysis needs at least 20 redrawings
kml3d(cld3dPregTemp,3:5,nbRedrawing=2,toPlot="both")

### 3. Exporting results
try(choice(cld3dPregTemp))

### 4. Visualizing in 3D
plotMeans3d(cld3dPregTemp,4)

### Go back to current dir
setwd(wd)

</code></pre>

<hr>
<h2 id='affectIndiv3d'>
~ Function: affectIndiv3d ~
</h2><span id='topic+affectIndiv3d'></span>

<h3>Description</h3>

<p>Given some longitudinal data (trajectories) and k clusters centers, <code>affectIndiv3d</code>
affects each individual to the cluster whose center is the closest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>affectIndiv3d(traj, clustersCenter, distance = dist3d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="affectIndiv3d_+3A_traj">traj</code></td>
<td>
<p><code>[array(numeric)]</code>: longitudinal data. Each line is an individual,
each column is a time measurement, each plan of the third dimension is
for one variable.</p>
</td></tr>
<tr><td><code id="affectIndiv3d_+3A_clusterscenter">clustersCenter</code></td>
<td>
<p><code>[array(numeric)]</code>: cluster center. Each line is a
cluster centers, each column is a time measurement, each plan of the third dimension is
for one variable. .</p>
</td></tr>
<tr><td><code id="affectIndiv3d_+3A_distance">distance</code></td>
<td>
<p><code>[numeric &lt;- function(joint-trajectory,joint-trajectory)]</code>: distance between an
individual and a clusters centre.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given an array of clusters center <code>clustersCenter</code> (each plan of
the first dimension is
a cluster center, that is clusterCenter[2,,] is the second cluster
center), the function <code>affectIndiv3d</code> affect each
individual of the array <code>traj</code> to the closest clusters,
according to <code>distance</code>.
</p>
<p><code>affectIndiv3d</code> used with <code><a href="#topic+calculTrajMean3d">calculTrajMean3d</a></code>
simulates one k-means 3D step.
</p>


<h3>Value</h3>

<p>Object of class<code><a href="longitudinalData.html#topic+Partition-class">Partition</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#######################
### affectIndiv

### Some trajectories
traj &lt;- gald3d()["traj"]

### 4 clusters centers
center &lt;- traj[runif(4,1,nrow(traj)),,]

### Affectation of each individual
part &lt;- affectIndiv3d(traj,center)


#################
### K-means simulation (3 steps)
plot(clusterLongData3d(traj),parTraj=parTRAJ(col=part+1))
for (i in 1:3){
    center &lt;- calculTrajMean3d(traj,part)
    part &lt;- affectIndiv3d(traj,center)
    plot(clusterLongData3d(traj),parTraj=parTRAJ(col=part+1))
}
</code></pre>

<hr>
<h2 id='calculTrajMean3d'>
~ Function: calculTrajMean3d ~
</h2><span id='topic+calculTrajMean3d'></span>

<h3>Description</h3>

<p>Given some joint longitudinal data and a cluster affectation,
<code>calculTrajMean3d</code> computes the mean joint-trajectories of each cluster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculTrajMean3d(traj, clust,centerMethod=function(x){mean(x,na.rm=TRUE)})
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculTrajMean3d_+3A_traj">traj</code></td>
<td>
<p><code>[array(numeric)]</code>: joint longitudinal data. Each line is an individual,
each column is a time measurement, the third dimension is for variables.</p>
</td></tr>
<tr><td><code id="calculTrajMean3d_+3A_clust">clust</code></td>
<td>
<p><code>[vector(numeric)]</code>: affectation of each individual.</p>
</td></tr>
<tr><td><code id="calculTrajMean3d_+3A_centermethod">centerMethod</code></td>
<td>
<p><code>[joint-trajectory &lt;- function(array(numeric))]</code>: function used
to compute the clusters' centers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a vector of affectation to a cluster, the function
<code>calculTrajMean3d</code> compute the &quot;central&quot; trajectory of each
clusters. The &quot;center&quot; can be define using the argument <code>centerMethod</code>.
</p>
<p><code>affectIndiv3d</code> used with <code><a href="#topic+calculTrajMean3d">calculTrajMean3d</a></code> simulates one k-means step.
</p>


<h3>Value</h3>

<p>An array of dimension <code>(k,t,v)</code> with <code>k</code> number of groups, <code>t</code> number of
time mesurement and <code>v</code> number of variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#######################
### calculTrajMean3d

### Some LongitudinalData3d
traj &lt;- gald3d()["traj"]

### A partition
part &lt;- floor(runif(150,1,5))
plot(clusterLongData3d(traj),parTraj=parTRAJ(col=part+1))

### Clusters center
(center &lt;- calculTrajMean3d(traj,part))


#################
### K-means simulation (4 steps)
plot(clusterLongData3d(traj),parTraj=parTRAJ(col=part+1))
for (i in 1:4){
    part &lt;- affectIndiv3d(traj,center)
    center &lt;- calculTrajMean3d(traj,part)
    plot(clusterLongData3d(traj),parTraj=parTRAJ(col=part+1))
}

</code></pre>

<hr>
<h2 id='clusterLongData3d'> ~ Function: clusterLongData3d (or cld3d) ~</h2><span id='topic+cld3d'></span><span id='topic+clusterLongData3d'></span><span id='topic+clusterLongData3d+2CANY+2CANY+2CANY+2CANY+2CANY+2CANY'></span><span id='topic+clusterLongData3d+2CANY+2CANY+2CANY+2CANY+2CANY+2CANY-method'></span><span id='topic+clusterLongData3d+2Cmissing+2Cmissing+2Cmissing+2Cmissing+2Cmissing+2Cmissing'></span><span id='topic+clusterLongData3d+2Cmissing+2Cmissing+2Cmissing+2Cmissing+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p><code>clusterLongData3d</code> (or <code>cld3d</code> in short) is the constructor
for <code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterLongData3d(traj, idAll, time, timeInData, varNames, maxNA)
cld3d(traj, idAll, time, timeInData, varNames, maxNA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clusterLongData3d_+3A_traj">traj</code></td>
<td>
<p><code>[array(numeric)]</code> or <code>[data.frame]</code>:
structure containning the joint-trajectories. Each line
(<code>traj[i,,]</code>) is a joint-trajectory
of an individual ; columns (<code>traj[,j,]</code>) refer to the time during which
measures were made ; the third dimensions (<code>traj[,,l]</code>) are for
variables.</p>
</td></tr>
<tr><td><code id="clusterLongData3d_+3A_idall">idAll</code></td>
<td>
<p><code>[vector(character)]</code>: single identifier for each
trajectory (ie each individual). Note that the identifiers are of type
<code>character</code> (that allow to deal identifiers like <code>XUK32-612</code>,
identifiers that our favorite epidemiologists are so good at
providing). If <code>idAll</code> are <code>numeric</code>, they are converted into <code>characters</code>.</p>
</td></tr>
<tr><td><code id="clusterLongData3d_+3A_time">time</code></td>
<td>
<p><code>[vector(numeric)]</code>: time at which measures were made.</p>
</td></tr>
<tr><td><code id="clusterLongData3d_+3A_timeindata">timeInData</code></td>
<td>
<p><code>[list(vector(numeric))]</code>: precise the column
containing the trajectories. The list labels are the names of the
variables (like <code>list(A=c(2,3,4),B=c(5,7,9))</code>).</p>
</td></tr>
<tr><td><code id="clusterLongData3d_+3A_varnames">varNames</code></td>
<td>
<p><code>[character]</code>: name of the variable being measured.</p>
</td></tr>
<tr><td><code id="clusterLongData3d_+3A_maxna">maxNA</code></td>
<td>
<p><code>[numeric]</code> or <code>[vector(numeric)]</code> : maximum number of NA that are tolerates
on a trajectory. If a trajectory has more
missing than <code>maxNA</code>, then it is remove from the analysis. Note
the <code>maxNA</code> can take diffents values for each
variable-trajectories.
The default value is <code>length(time)-2</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>clusterLongData3d</code> construct a object of class
<code><a href="kml.html#topic+ClusterLongData-class">ClusterLongData</a></code>. Two cases can be distinguised:
</p>

<dl>
<dt><code>traj</code> is an <code>array</code>:</dt><dd><p> the first dimension (line) are
individual. The second dimension (column) are time at which the
measurement are made. The third dimension are the differents
variable-trajectories. For example, <code>traj[,,2]</code> is the second variable-trajectory.
</p>
<p>If <code>idAll</code> is missing, the individuals are labelled <code>i1</code>,
<code>i2</code>, <code>i3</code>,...
</p>
<p>If <code>timeInData</code> is missing, all the column
are used (<code>1:ncol(traj)</code>).</p>
</dd>
<dt>If <code>traj</code> is a <code>data.frame</code>:</dt><dd><p> lines are individual. Time of
measurement and variables should be provide through
<code>timeInData</code>. <code>timeInData</code> is a list.
The label of the list are the
variable-trajectories names. Elements of the list are the column
containning the trajectories. For example, if
<code>timeInData=list(V=c(2,3,4),W=c(6,8,12))</code>, then the first
variable-trajectory is 'V', its mesearment are in column 2,3 and
4. The second variable-trajectory is 'W', its measurment are in column
6,8 and 12.
</p>
<p>If <code>idAll</code> is missing, the first column of the <code>data.frame</code>
is used.</p>
</dd>
</dl>



<h3>Value</h3>

<p>An object of class <code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###############
### Building an array
tr1n &lt;- array(c(1,2,NA, 1,4,NA, 6,1,8, 10,NA,2, 3,NA,NA,
                4,NA,5,  6,3,4, 3,4,4, 4,NA,NA, 5,5,4),
            dim=c(3,5,2))


###############
### clusterLongData

### With maxNA=3
clusterLongData3d(traj=tr1n,
    idAll=as.character(c(100,102,104)),
    time=c(1,2,4,8,16),
    varNames=c("P","A"),
    maxNA=3
)

### With maxNA=2
### Individual 104 is exclude
clusterLongData3d(traj=tr1n,
    idAll=as.character(c(100,102,104)),
    time=c(1,2,4,8,16),
    varNames=c("P","A"),
    maxNA=2
)

</code></pre>

<hr>
<h2 id='ClusterLongData3d-class'>~ Class: ClusterLongData3d ~</h2><span id='topic+ClusterLongData3d-class'></span><span id='topic++5B+2CClusterLongData3d-method'></span><span id='topic++5B+2CClusterLongData3d+2CANY+2Cmissing-method'></span><span id='topic++5B+3C-+2CClusterLongData3d-method'></span><span id='topic++5B+3C-+2CClusterLongData3d+2Ccharacter+2Cmissing+2Cmissing-method'></span><span id='topic+show+2CClusterLongData3d-method'></span>

<h3>Description</h3>

<p><code>ClusterLongData3d</code> is an object containing joint-trajectories and
associated <code><a href="longitudinalData.html#topic+Partition-class">Partition</a></code>.
</p>


<h3>Objects from the Class</h3>

<p><code><a href="#topic+kml3d">kml3d</a></code> is an algorithm that builds a set of <code><a href="longitudinalData.html#topic+Partition-class">Partition</a></code>
from joint longitudinal data. <code>ClusterLongData3d</code>
is the object containing the original joint longitudinal data and all the <code>Partition</code> that <code>kml3d</code> finds.<br />
</p>
<p>When created, an <code>ClusterLongData3d</code> object simply contains initial
data (the joint-trajectories).
After the execution of <code>kml3d</code>, it contains
the original data and the <code><a href="longitudinalData.html#topic+Partition-class">Partition</a></code> which has
just been find by <code>kml3d</code>.
</p>
<p>Note that if <code>kml3d</code> is executed several times, every new <code>Partition</code>
are added to the original ones, no pre-existing <code>Partition</code> is erased.
</p>


<h3>Slots</h3>


<dl>
<dt><code>idAll</code></dt><dd><p><code>[vector(character)]</code>: Single identifier
for each of the joint-trajectory (each individual). Usefull for exporting clusters.</p>
</dd>
<dt><code>idFewNA</code></dt><dd><p><code>[vector(character)]</code>: Restriction of
<code>idAll</code> to the trajectories that does not have 'too many' missing
value. See <code>maxNA</code> for details.</p>
</dd>
<dt><code>time</code></dt><dd><p><code>[numeric]</code>: Time at which measures are made.</p>
</dd>
<dt><code>varNames</code></dt><dd><p><code>[vector(character)]</code>: Names of the variable measured.</p>
</dd>
<dt><code>traj</code></dt><dd><p><code>[array(numeric)]</code>: Contains
the joint longitudianl data. Each horizontal plan (first dimension) corresponds to the trajectories of an
individual. Vertical plans (second dimension) refer to the time at which measures
are made. Transversal plans (the third dimension) are for variables.</p>
</dd>
<dt><code>dimTraj</code></dt><dd><p><code>[vector3(numeric)]</code>: size of the array
<code>traj</code> (ie <code>c(length(idFewNA),length(time),length(varNames))</code>).</p>
</dd>
<dt><code>maxNA</code></dt><dd><p><code>[numeric]</code> or <code>[vector(numeric)]</code>:
Individual whose trajectories contain more missing value than
<code>maxNA</code> are exclude from <code>traj</code> and will no be use in
the analysis. Their identifier is preserved in <code>idAll</code> but
not in <code>idFewNA</code>. When <code>maxNA</code> is a single number, it is
used for all the variables.</p>
</dd>
<dt><code>reverse</code></dt><dd><p><code>[matrix(numeric)]</code>: contain the
mean (first line) and the standard deviation (second line) used to
normalize the data. Usefull to restaure the original data after a
scaling operation.</p>
</dd>
<dt><code>criterionActif</code></dt><dd><p>[character]: Store the criterion name
that will be used by functions that need a single criterion
(like <a href="longitudinalData.html#topic+plotCriterion">plotCriterion</a> or <a href="base.html#topic+ordered">ordered</a>).</p>
</dd>
<dt><code>initializationMethod</code></dt><dd><p>[vector(chararcter)]: list all
the initialization method that has allready been used to find some
<code>Partition</code>
(usefull to not run several time a deterministic method).</p>
</dd>
<dt><code>sorted</code></dt><dd><p><code>[logical]</code>: are the <code>Partition</code>
curently hold in the object sorted in decreasing order ?</p>
</dd>
<dt><code>c1</code></dt><dd><p>[list(Partition)]: list of
<code>Partition</code> with 1 clusters.</p>
</dd>
<dt><code>c2</code></dt><dd><p>[list(Partition)]: list of
<code>Partition</code> with 2 clusters.</p>
</dd>
<dt><code>c3</code></dt><dd><p>[list(Partition)]: list of
<code>Partition</code> with 3 clusters.</p>
</dd>
<dt><code>...</code></dt><dd></dd>
<dt><code>c26</code></dt><dd><p>[list(Partition)]: list of
<code>Partition</code> with 26 clusters.</p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class <code><a href="longitudinalData.html#topic+LongData3d-class">LongData3d</a></code>, directly.
Class <code><a href="longitudinalData.html#topic+ListPartition-class">ListPartition</a></code>, directly.
</p>


<h3>Methods</h3>


<dl>
<dt><code>object['xxx']</code></dt><dd><p>Get the value of the field
<code>xxx</code>. Inherit from  <code><a href="longitudinalData.html#topic+LongData3d-class">LongData3d</a></code> and
<code><a href="longitudinalData.html#topic+ListPartition-class">ListPartition</a></code>.</p>
</dd>
<dt><code>object['xxx']&lt;-value</code></dt><dd><p>Set the field <code>xxx</code> to <code>value</code>.
<code>xxx</code>. Inherit from  <code><a href="longitudinalData.html#topic+ListPartition-class">ListPartition</a></code>.</p>
</dd>
<dt><code><a href="#topic+plot+2CClusterLongData3d">plot</a></code></dt><dd><p>Display the <code>ClusterLongData3d</code>, one
graph for each variable, according to a <code><a href="longitudinalData.html#topic+Partition-class">Partition</a></code>.</p>
</dd>
<dt><code><a href="#topic+plot3d">plot3d</a></code></dt><dd><p>Display two
variables of the <code>ClusterLongData3d</code> in 3D according to a
<code><a href="longitudinalData.html#topic+Partition-class">Partition</a></code>.</p>
</dd>
<dt><code><a href="#topic+plot3dPdf">plot3dPdf</a></code></dt><dd><p>Export the AZY code for displaying two
variables of the <code>ClusterLongData3d</code> in a 3D pdf graph.</p>
</dd>
</dl>



<h3>Special thanks</h3>

<p>Special thanks to Boris Hejblum for debugging the '[' and '[&lt;-' operators (the
previous version was not compatible with the matrix package, which is
used by lme4).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Move to tempdir
wd &lt;- getwd()
setwd(tempdir()); getwd()

### Building longData
traj &lt;- array(c(1,2,3,1,4, 3,6,1,8,10, 1,2,1,3,2, 4,2,5,6,3, 4,3,4,4,4, 7,6,5,5,4),
            dim=c(3,5,2))

myCld &lt;- clusterLongData3d(
    traj=traj,
    idAll=as.character(c(100,102,103)),
    time=c(1,2,4,8,15),
    varNames=c("P","A"),
    maxNA=3
)

### Show
myCld

### Get
myCld['varNames']

### Set
myCld['criterionActif']&lt;-"Davies.Bouldin"

### Plot
plot(myCld)

### Go back to current dir
setwd(wd)
</code></pre>

<hr>
<h2 id='dist3d'>
~ Function: dist3d ~
</h2><span id='topic+dist3d'></span>

<h3>Description</h3>

<p>Compute the distante between two joint trajectories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist3d(x, y, method = "euclidian", power = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dist3d_+3A_x">x</code></td>
<td>
<p><code>[matrix(numeric)]</code>: first trajectory. The colomn are
time, the line are variables.</p>
</td></tr>
<tr><td><code id="dist3d_+3A_y">y</code></td>
<td>
<p><code>[matrix(numeric)]</code>: second trajectory. The colomn are
time, the line are variables.</p>
</td></tr>
<tr><td><code id="dist3d_+3A_method">method</code></td>
<td>
<p><code>[character]</code>: method used. Should be one of the
method used by the function <code><a href="stats.html#topic+dist">dist</a></code>.</p>
</td></tr>
<tr><td><code id="dist3d_+3A_power">power</code></td>
<td>
<p><code>[numeric]</code>: if <code>method="minkowski"</code>,
<code>power</code>is the power used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Compute the distante between two joint trajectories, using one of the
distance define by <code><a href="stats.html#topic+dist">dist</a></code>.
</p>


<h3>Value</h3>

<p>A numeric
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ### Move to tempdir
  wd &lt;- getwd()
  setwd(tempdir()); getwd()

  ### Generate artificial data
  myCld &lt;- gald3d()

  ### Distance between individual 1 and 3 (there are in the same group)
  dist3d(myCld['traj'][1,,],myCld['traj'][3,,])

  ### Distance between individual 1 and 51 (there are in two different groups)
  dist3d(myCld['traj'][1,,],myCld['traj'][51,,])
  
  ### Go back to current dir
  setwd(wd)
</code></pre>

<hr>
<h2 id='generateArtificialLongData3d'>~ Function: generateArtificialLongData3d (or gald3d) ~</h2><span id='topic+gald3d'></span><span id='topic+generateArtificialLongData3d'></span>

<h3>Description</h3>

<p>This function builp up an artificial longitudinal data set (joint
trajectories) an turn them
into an object of class <code><a href="kml.html#topic+ClusterLongData-class">ClusterLongData</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gald3d(nbEachClusters=50,time=0:10,varNames=c("V","T"),
    meanTrajectories=list(function(t){c(0,0)},
       function(t){c(10,10)},function(t){c(10-t,10-t)}),
    personalVariation=function(t){c(rnorm(1,0,2),rnorm(1,0,2))},
    residualVariation=function(t){c(rnorm(1,0,2),rnorm(1,0,2))},
    decimal=2,percentOfMissing=0)

generateArtificialLongData3d(nbEachClusters=50,time=0:10,varNames=c("V","T"),
    meanTrajectories=list(function(t){c(0,0)},
       function(t){c(10,10)},function(t){c(10-t,10-t)}),
    personalVariation=function(t){c(rnorm(1,0,2),rnorm(1,0,2))},
    residualVariation=function(t){c(rnorm(1,0,2),rnorm(1,0,2))},
    decimal=2,percentOfMissing=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generateArtificialLongData3d_+3A_nbeachclusters">nbEachClusters</code></td>
<td>
<p><code>[vector(numeric)]</code>: number of trajectories that each
cluster must contain. If a single
number is given, it is duplicated for all groups.</p>
</td></tr>
<tr><td><code id="generateArtificialLongData3d_+3A_time">time</code></td>
<td>
<p><code>[vector(numeric)]</code>: time at which measures are made.</p>
</td></tr>
<tr><td><code id="generateArtificialLongData3d_+3A_varnames">varNames</code></td>
<td>
<p><code>[vector(character)]</code>: names of the variables.</p>
</td></tr>
<tr><td><code id="generateArtificialLongData3d_+3A_meantrajectories">meanTrajectories</code></td>
<td>
<p><code>[list(function)]</code>: lists the functions
that define the average trajectories of each cluster.
Each functions shall return a vector containing one value for each variable of <code>varNames</code>.</p>
</td></tr>
<tr><td><code id="generateArtificialLongData3d_+3A_personalvariation">personalVariation</code></td>
<td>
<p><code>[function]</code> or <code>[list(function)]</code>: lists the functions
defining the personnal variation between an individual and the mean
trajectories of its cluster. Note that these function should be
constant function (the personal variation can not evolve with time). If
a single function is given, it is duplicated for all groups (see detail).</p>
</td></tr>
<tr><td><code id="generateArtificialLongData3d_+3A_residualvariation">residualVariation</code></td>
<td>
<p><code>[function]</code> or
<code>[list(function)]</code>: lists the functions
generating the noise of each trajectory within its own cluster.
Each functions shall return a vector containing one value for each variable of <code>varNames</code>.
If a single function is given, it is duplicated for all groups.</p>
</td></tr>
<tr><td><code id="generateArtificialLongData3d_+3A_decimal">decimal</code></td>
<td>
<p><code>[numeric]</code>: number of decimals used to round up values.</p>
</td></tr>
<tr><td><code id="generateArtificialLongData3d_+3A_percentofmissing">percentOfMissing</code></td>
<td>
<p><code>[numeric]</code>: percentage (between 0 and 1)
of missing data generated in each cluster. If a single value is
given, it is duplicated for all groups. The missing values are
Missing Completly At Random (MCAR).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>generateArtificialLongData3d</code> (<code>gald3d</code> in short) is a
function that contruct a set of artificial joint longitudinal data.
Each individual is considered as belonging to a group. This group
follows a theoretical trajectory, function of time.
These functions (one per group) are given via the argument <code>meanTrajectories</code>.
</p>
<p>Within a group, the individual undergoes individal
variations. Individual variations are given via the argument <code>residualVariation</code>.
</p>
<p>The number of individuals in each group is given by <code>nbEachClusters</code>.
</p>
<p>Finally, it is possible to add missing values randomly (MCAR) striking the
data thanks to <code>percentOfMissing</code>.
</p>


<h3>Value</h3>

<p>Object of class <code><a href="kml.html#topic+ClusterLongData-class">ClusterLongData</a></code>.
</p>


<h3>Author</h3>

<p>Christophe Genolini<br />
1. UMR U1027, INSERM, Université Paul Sabatier / Toulouse III / France<br />
2. CeRSME, EA 2931, UFR STAPS, Université de Paris Ouest-Nanterre-La Défense / Nanterre / France
</p>


<h3>References</h3>

<p>[1] C. Genolini and B. Falissard<br />
&quot;KmL: k-means for longitudinal data&quot;<br />
Computational Statistics, vol 25(2), pp 317-328, 2010<br />
</p>
<p>[2] C. Genolini and B. Falissard<br />
&quot;KmL: A package to cluster longitudinal data&quot;<br />
Computer Methods and Programs in Biomedicine, 104, pp e112-121, 2011<br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code>, <code><a href="#topic+clusterLongData3d">clusterLongData3d</a></code>, <code><a href="kml.html#topic+generateArtificialLongData">generateArtificialLongData</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#####################
### Default example

ex1 &lt;- generateArtificialLongData3d()
plot3d(ex1,parTraj=parTRAJ(col=rep(2:4,each=50)))


#####################
### 4 lines with unbalanced groups

ex2 &lt;- generateArtificialLongData3d(
  nbEachClusters=c(5,10,20,40),
  meanTrajectories=list(
     function(t)c(t,t^3/100),
     function(t)c(0,t),
     function(t)c(t,t),
     function(t)c(0,t^3/100)
  ),
  residualVariation = function(t){c(rnorm(1,0,1),rnorm(1,0,1))}
)

plot3d(ex2,parTraj=parTRAJ(col=rep(1:4,time=c(5,10,20,40))))
</code></pre>

<hr>
<h2 id='kml3d'>~ Algorithm kml3d: K-means for Joint Longitidinal data ~</h2><span id='topic+kml3d'></span><span id='topic+kml3d-method'></span><span id='topic+kml3d+2CClusterLongData-method'></span>

<h3>Description</h3>

<p><code>kml3d</code> is a new implementation of k-means for joint longitudinal
data (or joint trajectories). This algorithm is able to deal with missing value and
provides an easy way to re roll the algorithm several times, varying the starting conditions and/or the number of clusters looked for.
</p>
<p>Here is the description of the algorithm. For an overview of the package, see <a href="#topic+kml3d-package">kml3d-package</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kml3d(object, nbClusters = 2:6, nbRedrawing = 20, toPlot = "none",
    parAlgo = parKml3d())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kml3d_+3A_object">object</code></td>
<td>
<p>[ClusterLongData3d]: contains trajectories to clusterize
and some <code><a href="longitudinalData.html#topic+Partition-class">Partition</a></code>.
</p>
</td></tr>
<tr><td><code id="kml3d_+3A_nbclusters">nbClusters</code></td>
<td>
<p>[vector(numeric)]: Vector containing the number of clusters
with which <code>kml3d</code> must work. By default,
<code>nbClusters</code> is <code>2:6</code> which indicates that <code>kml3d</code> must
search partitions with respectively 2, then 3, ... up to 6
clusters. Maximum number of cluster is 26.
</p>
</td></tr>
<tr><td><code id="kml3d_+3A_nbredrawing">nbRedrawing</code></td>
<td>
<p>[numeric]: Sets the number of time that k-means
must be re-run (with different starting conditions) for each number
of clusters.
</p>
</td></tr>
<tr><td><code id="kml3d_+3A_toplot">toPlot</code></td>
<td>
<p><code>[character]</code>: during computation, <code>kml3d</code> can
display some graphes. If <code>toPlot="traj"</code>,
then the trajectories are plot (like with function
<code><a href="kml.html#topic+plot+2CClusterLongData">plot,ClusterLongData</a></code>).
If <code>toPlot="criterion"</code>, the quality criterions are plot (like with function
<code><a href="longitudinalData.html#topic+plotCriterion">plotCriterion</a></code>). If <code>toPlot="both"</code>, the graphic
windows is split in two and both graphs are displayed. If &quot;none&quot;,
there is no graphical display.
</p>
</td></tr>
<tr><td><code id="kml3d_+3A_paralgo">parAlgo</code></td>
<td>
<p><code>[<a href="kml.html#topic+ParKml-class">ParKml</a>]</code>: set the option used
by <code>kml3d</code> (like the starting condition, the imputation methods,
the save frequency, the maximum number of iteration, , the distance
used...) See <a href="kml.html#topic+ParKml-class">ParKml</a> for details. The default values
are describe in <code><a href="#topic+parKml3d">parKml3d</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>kml3d</code> works on object of class <code>ClusterLongData</code>.
For each number <code>i</code> included in <code>nbClusters</code>, <code>kml3d</code> computes a
<code><a href="longitudinalData.html#topic+Partition-class">Partition</a></code> then stores it in the field
<code>cX</code> of the object <code>ClusterLongData</code> according to its number
of clusters 'X'.
The algorithm starts over as many times as it is told in <code>nbRedrawing</code>. By default, it is executed for 2,
3, 4, 5 and 6 clusters 20 times each, namely 100 times.
</p>
<p>When a <code>Partition</code> has been found, it is added to the slot
c1, c2, c3, ... or c26. <code>cX</code> stores the all <code>Partition</code> with
X clusters. Inside a sublist, the
<code>Partition</code> are sorted from the biggest quality criterion to
the smallest (the best are stored first, using
<code><a href="longitudinalData.html#topic+ordered+2CListPartition">ordered,ListPartition</a></code>), or not.
</p>
<p>Note that <code>Partition</code> are saved throughout the algorithm. If the user
interrupts the execution of <code>kml3d</code>, the result is not lost. If the
user run <code>kml3d</code> on an object, then running <code>kml3d</code> again on
the same object will add some new <code>Partition</code> to the one already
found.
</p>
<p>The possible starting conditions are defined in <code><a href="longitudinalData.html#topic+initializePartition">initializePartition</a></code>.
</p>


<h3>Value</h3>

<p>A <code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code> object, after having added
some <code><a href="longitudinalData.html#topic+Partition-class">Partition</a></code> to it.
</p>


<h3>Optimisation</h3>

<p>Behind <code>kml3d</code>, there are two different procedures :
</p>

<ol>
<li><p> Fast: when the parameter <code>distance</code> is set to &quot;euclidean3d&quot;
and <code>toPlot</code> is set to 'none' or
'criterion', <code>kml3d</code> call a C
compiled (optimized) procedure.
</p>
</li>
<li><p> Slow: when the user defines its own distance or if he wants
to see the construction of the clusters by setting <code>toPlot</code> to
'traj' or 'both', <code>kml3d</code> uses a R non compiled
programmes.
</p>
</li></ol>

<p>The C prodecure is 25 times faster than the R one.
</p>
<p>So we advice to use the R procedure 1/ for trying some new method
(like using a new distance) or 2/ to &quot;see&quot; the very first clusters
construction, in order to check that every thing goes right. Then it
is better to
switch to the C procedure (like we do in <code>Example</code> section).
</p>
<p>If for a specific use, you need a different distance, feel free to
contact the author.
</p>


<h3>See Also</h3>

<p>Overview: <code><a href="#topic+kml3d-package">kml3d-package</a></code> <br />
Classes : <code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code>, <code><a href="longitudinalData.html#topic+Partition-class">Partition</a></code> <br />
Methods : <code><a href="#topic+clusterLongData3d">clusterLongData3d</a></code>, <code><a href="kml.html#topic+choice">choice</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Move to tempdir
wd &lt;- getwd()
setwd(tempdir()); getwd()
  
### Generation of some data
cld1 &lt;- generateArtificialLongData3d(15)

### We suspect 2, 3, 4 or 5 clusters, we want 3 redrawing.
###   We want to "see" what happen (so toPlot="both")
kml3d(cld1,2:5,3,toPlot="both")

### 3 seems to be the best.
###   We don't want to see again, we want to get the result as fast as possible.
###   Just, to check the overall process, we plot the criterion evolution
kml3d(cld1,3,10,toPlot="criterion")

### Go back to current dir
setwd(wd)

</code></pre>

<hr>
<h2 id='parKml3d'> ~ Function: parKml3d ~</h2><span id='topic+parKml3d'></span>

<h3>Description</h3>

<p><code>parKml3d</code> is a constructor of object <code><a href="kml.html#topic+ParKml-class">ParKml</a></code>
that provide adequate default value for the use of function <code><a href="#topic+kml3d">kml3d</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parKml3d(saveFreq = 100, maxIt = 200, imputationMethod = "copyMean",
    distanceName = "euclidean3d", power = 2, distance = function() {
    }, centerMethod = meanNA, startingCond = "nearlyAll", nbCriterion =100,scale=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parKml3d_+3A_savefreq">saveFreq</code></td>
<td>
<p><code>[numeric]</code>: Long computations can take several
days. So it is possible to save the object <code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code>
on which works <code><a href="#topic+kml3d">kml3d</a></code> once in a while. <code>saveFreq</code>
defines the frequency of the saving
process. The <code>ClusterLongData3d</code> is saved every <code>saveFreq</code>
clustering calculations. The object is saved in the file
<code>objectName.Rdata</code> in the curent folder.
</p>
</td></tr>
<tr><td><code id="parKml3d_+3A_maxit">maxIt</code></td>
<td>
<p><code>[numeric]</code>: Set a limit to the number of iteration if
convergence is not reached.
</p>
</td></tr>
<tr><td><code id="parKml3d_+3A_imputationmethod">imputationMethod</code></td>
<td>
<p><code>[character]</code>: the calculation of quality
criterion can not be done if some value are
missing. <code>imputationMethod</code> define the method use to impute the
missing value. See <code><a href="longitudinalData.html#topic+imputation">imputation</a></code> for detail.
</p>
</td></tr>
<tr><td><code id="parKml3d_+3A_distancename">distanceName</code></td>
<td>
<p><code>[character]</code>: name of the
<code>distance</code> used by k-means. If the <code>distanceName</code> is &quot;euclidean3d&quot;, a compiled optimized version specificaly design for
joint-trajectories version is used. Otherwise, the function define in
the slot <code>distance</code> is used.
</p>
</td></tr>
<tr><td><code id="parKml3d_+3A_power">power</code></td>
<td>
<p><code>[numeric]</code>: If <code>distanceName="minkowski"</code>, this define
the power that will be used.
</p>
</td></tr>
<tr><td><code id="parKml3d_+3A_distance">distance</code></td>
<td>
<p><code>[numeric &lt;- function(trajA,trajB)]</code>: function that computes the
distance between two trajectories. If no function is specified, the Euclidian
distance with Gower adjustment (to deal with missing value) is
used.
</p>
</td></tr>
<tr><td><code id="parKml3d_+3A_centermethod">centerMethod</code></td>
<td>
<p><code>[numeric &lt;-
      function(vector(numeric))]</code>: k-means algorithm computes the centers of
each cluster. It is possible to personalize the definition of
&quot;center&quot; by defining a function &quot;centerMethod&quot;. This function should
take a vector of numeric as argument and return a single numeric -the
center of the vector-.
</p>
</td></tr>
<tr><td><code id="parKml3d_+3A_startingcond">startingCond</code></td>
<td>
<p><code>[character]</code>: specifies the starting
condition. Should be one of &quot;randomAll&quot;, &quot;randomK&quot;, &quot;maxDist&quot;,
&quot;kmeans++&quot;, &quot;kmeans+&quot;, &quot;kmeans-&quot; or &quot;kmeans&ndash;&quot; (see
<code><a href="longitudinalData.html#topic+initializePartition">initializePartition</a></code> for details). It
also could take two specifics values: &quot;all&quot; stands for
c(&quot;maxDist&quot;,&quot;kmeans-&quot;) then an alternance of &quot;kmeans&ndash;&quot; and
&quot;randomK&quot; while &quot;nearlyAll&quot; stands for
&quot;kmeans-&quot; then an alternance of &quot;kmeans&ndash;&quot; and &quot;randomK&quot;.
</p>
</td></tr>
<tr><td><code id="parKml3d_+3A_nbcriterion">nbCriterion</code></td>
<td>
<p><code>[numeric]</code>: set the maximum number of
quality criterion that are display on the graph (since displaying
a high criterion number an slow down the overall process, the
default value is 100).
</p>
</td></tr>
<tr><td><code id="parKml3d_+3A_scale">scale</code></td>
<td>
<p><code>[logical]</code>: if TRUE, then the data will be
automaticaly scaled (using the function <code><a href="base.html#topic+scale">scale</a></code> with
default values) before the execution of k-means on joint
trajectories. Then the data
will be restore (using the function <code><a href="longitudinalData.html#topic+restoreRealData">restoreRealData</a></code>)
just before the end of the function <code><a href="#topic+kml3d">kml3d</a></code>. This option
has no effect on <code><a href="kml.html#topic+kml">kml</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>parKml3d</code> is a constructor of object <code><a href="kml.html#topic+ParKml-class">ParKml</a></code>
that provide adequate default value for the use of function <code><a href="#topic+kml3d">kml3d</a></code>.
</p>


<h3>Value</h3>

<p>An object <code><a href="kml.html#topic+ParKml-class">ParKml</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Move to tempdir
wd &lt;- getwd()
setwd(tempdir()); getwd()

### Generation of some data
cld1 &lt;- generateArtificialLongData3d(c(15,15,15))

### Setting two different set of option :
(option1 &lt;- parKml3d())
(option2 &lt;- parKml3d(centerMethod=function(x)median(x,na.rm=TRUE)))

### Running kml. Formaly, the second exemple is 'k-median'
kml3d(cld1,4,1,toPlot="both",parAlgo=option1)
kml3d(cld1,4,1,toPlot="both",parAlgo=option2)

### Go back to current dir
setwd(wd)
</code></pre>

<hr>
<h2 id='plot+2CClusterLongData3d'> ~ Function: plot for ClusterLongData3d ~ </h2><span id='topic+plot'></span><span id='topic+plot+2CClusterLongData3d'></span><span id='topic+plot+2CClusterLongData3d+2CANY-method'></span><span id='topic+plot+2CClusterLongData3d+2Cmissing-method'></span><span id='topic+plot+2CClusterLongData3d+2Cnumeric-method'></span>

<h3>Description</h3>

<p><code>plot</code> the trajectories of an object
<code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code> relativly to a
<code><a href="longitudinalData.html#topic+Partition-class">Partition</a></code>. One graphe for each variable is displayed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ClusterLongData3d,ANY'
plot(x,y=NA,parTraj=parTRAJ(),parMean=parMEAN(),
   addLegend=TRUE,adjustLegend=-0.05,toPlot="both",nbCriterion=1000,...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2CClusterLongData3d_+3A_x">x</code></td>
<td>
<p><code>[ClusterLongData3d]</code>: Object containing the joint-trajectories to plot.</p>
</td></tr>
<tr><td><code id="plot+2B2CClusterLongData3d_+3A_y">y</code></td>
<td>
<p><code>[numeric]</code> or <code>[vector2(numeric)]</code>: Give the <code>Partition</code>
to represent. If <code>y</code> is missing, the <code>Partition</code> with
the highest quality criterion (the actif one) is selected. If <code>y</code> is a number,
the first <code>Partition</code> of the sublist <code>c-y</code> is
selected. If <code>y</code> is a couple of numeric, the <code>y[2]</code>th
<code>Partition</code> of the sublist <code>c-y[1]</code> is selected.</p>
</td></tr>
<tr><td><code id="plot+2B2CClusterLongData3d_+3A_partraj">parTraj</code></td>
<td>
<p><code>[ParLongData]</code>: Specification of the plotting
parameters of the individual trajectories. Fields that can be changes are
'type','col','pch','xlab' and 'ylab'. In addition to the standard
possible values, the option <code>col="clusters"</code> can be use to color the individual
trajectories according to their clusters (exemple:
<code>parTraj=parTRAJ(type="o",col="clusters")</code>). See
<code><a href="longitudinalData.html#topic+ParLongData-class">ParLongData</a></code> for details.</p>
</td></tr>
<tr><td><code id="plot+2B2CClusterLongData3d_+3A_parmean">parMean</code></td>
<td>
<p><code>[ParLongData]</code>: Specification of the plotting
parameters of the mean trajectories (only when y is non missing). Fields that can be changes are
'type','col','pch','pchPeriod' and 'cex'. See
<code><a href="longitudinalData.html#topic+ParLongData-class">ParLongData</a></code> for details.</p>
</td></tr>
<tr><td><code id="plot+2B2CClusterLongData3d_+3A_toplot">toPlot</code></td>
<td>
<p><code>[character]</code>: either 'traj' for plotting
trajectories alone, 'criterion' for plotting criterion alone,
'both' for plotting both or 'none' for not display anything.</p>
</td></tr>
<tr><td><code id="plot+2B2CClusterLongData3d_+3A_nbcriterion">nbCriterion</code></td>
<td>
<p><code>[numeric]</code>: if a single criterion is given to
<code>criterion</code> (and thus is displayed for 'all' the
<code>Partition</code>), this slot alows to fix a limit on the number of
points that will be display.</p>
</td></tr>
<tr><td><code id="plot+2B2CClusterLongData3d_+3A_addlegend">addLegend</code></td>
<td>
<p><code>[logical]</code>: should the legend be displayed?</p>
</td></tr>
<tr><td><code id="plot+2B2CClusterLongData3d_+3A_adjustlegend">adjustLegend</code></td>
<td>
<p><code>[numeric]</code>: fix the hight of the legend</p>
</td></tr>
<tr><td><code id="plot+2B2CClusterLongData3d_+3A_...">...</code></td>
<td>
<p>Some other parameters can be passed to the method (like
&quot;xlab&quot; or &quot;ylab&quot;.</p>
</td></tr>


</table>


<h3>Details</h3>

<p><code>plot</code> the trajectories of an object <code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code> relativly
to the 'best' <code><a href="longitudinalData.html#topic+Partition-class">Partition</a></code>, or to the
<code>Partition</code> define by <code>y</code>.
</p>
<p>Graphical option concerning the individual trajectory (col, type, pch
and xlab) can be change using <code>parTraj</code>.
Graphical option concerning the cluster mean trajectory (col, type, pch,
pchPeriod and cex) can be change using <code>parMean</code>. For more
detail on  <code>parTraj</code> and  <code>parMean</code>, see object of
class <code><a href="longitudinalData.html#topic+ParLongData-class">ParLongData</a></code>.
</p>


<h3>See Also</h3>

<p>Overview: <code><a href="#topic+kml3d-package">kml3d-package</a></code> <br />
Classes : <code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code> <br />
Plot : <code><a href="kml.html#topic+plotTraj">plotTraj</a></code>, <code><a href="longitudinalData.html#topic+plotCriterion">plotCriterion</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Move to tempdir
wd &lt;- getwd()
setwd(tempdir()); getwd()

##################
### Construction of the data

myCld &lt;- gald3d()

### Basic plotting
plot(myCld)

##################
### Changing graphical parameters 'par'

### No letters on the mean trajectories
kml3d(myCld,2:7,2)
plot(myCld,2,parMean=parMEAN(type="l"))

### Only one letter on the mean trajectories
plot(myCld,3,parMean=parMEAN(pchPeriod=Inf))

### Color individual according to its clusters (col="clusters")
plot(myCld,4,parTraj=parTRAJ(col="clusters"))

### Mean without individual
plot(myCld,5,parTraj=parTRAJ(type="n"))


### No mean trajectories (type="n")
### Color individual according to its clusters (col="clusters")
plot(myCld,6,parTraj=parTRAJ(col="clusters"),parMean=parMEAN(type="n"))

### Only few trajectories
plot(myCld,7,nbSample=10,parTraj=parTRAJ(col='clusters'),parMean=parMEAN(type="n"))

### Go back to current dir
setwd(wd)
</code></pre>

<hr>
<h2 id='plot3d+2CClusterLongData3d'> ~ Function: plot3d for ClusterLongData3d ~ </h2><span id='topic+plot3d'></span><span id='topic+plot3d+2CClusterLongData3d+2Cmissing-method'></span><span id='topic+plot3d+2CClusterLongData3d+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Plot two variables of a <code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code> object in 3D, optionnaly
relatively to a <code><a href="longitudinalData.html#topic+Partition-class">Partition</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ClusterLongData3d,numeric'
plot3d(x,y,varY=1,varZ=2,
   parTraj=parTRAJ(),parMean=parMEAN(),...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot3d+2B2CClusterLongData3d_+3A_x">x</code></td>
<td>
<p><code>[ClusterLongData3d]</code>: Object containing the trajectories to plot.</p>
</td></tr>
<tr><td><code id="plot3d+2B2CClusterLongData3d_+3A_y">y</code></td>
<td>
<p><code>[numeric]</code> or <code>[vector2(numeric)]</code>: Define the <code>Partition</code> P that will be use to plot
the object. <code>P</code> is a <code>Partition</code> hold in the field <code>c2</code>,
<code>c3</code>, ... <code>c26</code>. If <code>y=c(a,b)</code>, then <code>P</code> is
the <code>Partition</code> number <code>b</code> with <code>a</code> clusters. If <code>y=a</code>,
then <code>P</code> is the partition number <code>1</code> with <code>a</code>
clusters. If <code>y</code> is missing, <code>P</code> is the <code>Partition</code>
with the best
criterion.</p>
</td></tr>
<tr><td><code id="plot3d+2B2CClusterLongData3d_+3A_vary">varY</code></td>
<td>
<p><code>[numeric]</code> or <code>[character]</code>: either the
number or the name of the first variable to display. 1 by default.</p>
</td></tr>
<tr><td><code id="plot3d+2B2CClusterLongData3d_+3A_varz">varZ</code></td>
<td>
<p><code>[numeric]</code> or <code>[character]</code>: either the
number or the name of the second variable to display. 2 by default.</p>
</td></tr>
<tr><td><code id="plot3d+2B2CClusterLongData3d_+3A_partraj">parTraj</code></td>
<td>
<p><code>[ParLongData]</code>: Set the graphical parameters
used to plot the trajectories of the <code>ClusterLongData3d</code>. See <code><a href="longitudinalData.html#topic+ParLongData-class">ParLongData</a></code>
for details.</p>
</td></tr>
<tr><td><code id="plot3d+2B2CClusterLongData3d_+3A_parmean">parMean</code></td>
<td>
<p><code>[ParLongData]</code>:  Set the graphical parameters
used to plot the mean trajectories of each clusters <code>ClusterLongData3d</code>
(only when <code>y</code> is non missing). See <code><a href="longitudinalData.html#topic+ParLongData-class">ParLongData</a></code>
for details.</p>
</td></tr>
<tr><td><code id="plot3d+2B2CClusterLongData3d_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods, such as graphical parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plot two variables of a <code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code> object in 3D. It
use the <code><a href="rgl.html#topic+rgl">rgl</a></code> library. The user can make the
graphical representation turn using its mouse.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Move to tempdir
wd &lt;- getwd()
setwd(tempdir()); getwd()

##################
### Real example on array

time=c(1,2,3,4,8,12,16,20)
id2=1:120
f &lt;- function(id,t)((id-1)%%3-1) * t
g &lt;- function(id,t)(id%%2+1)*t
h &lt;- function(id,t)(id%%4-0.5)*(20-t)
myCld &lt;- clusterLongData3d(array(cbind(outer(id2,time,f),outer(id2,time,g),
   outer(id2,time,h))+rnorm(120*8*3,0,3),dim=c(120,8,3)))

### Basic plot
plot(myCld,parTraj=parTRAJ(col=rep(1:6,20)))

### plot3d, variable 1 and 2
plot3d(myCld,parTraj=parTRAJ(col=rep(1:6,20)))

### plot3d, variable 1 and 3
plot3d(myCld,parTraj=parTRAJ(col=rep(1:6,20)),varZ=3)
plot3d(myCld,parTraj=parTRAJ(col="red"))

### Go back to current dir
setwd(wd)

</code></pre>

<hr>
<h2 id='plot3dPdf'>
~ Function: plot3dPdf for ClusterLongData3d ~
</h2><span id='topic+plot3dPdf'></span><span id='topic+plot3dPdf+2CClusterLongData3d-method'></span><span id='topic+plot3dPdf+2CClusterLongData3d+2Cmissing-method'></span><span id='topic+plot3dPdf+2CClusterLongData3d+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Given a <code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code> and a <code><a href="longitudinalData.html#topic+Partition-class">Partition</a></code>, this
function create Triangle objects representing the 3D plot of two
variables of the main trajectories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ClusterLongData3d,missing'
plot3dPdf(x,y,varY=1,varZ=2)
## S4 method for signature 'ClusterLongData3d,numeric'
plot3dPdf(x,y,varY=1,varZ=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot3dPdf_+3A_x">x</code></td>
<td>
<p><code>[ClusterLongData]</code>: Object containing the trajectories to plot.</p>
</td></tr>
<tr><td><code id="plot3dPdf_+3A_y">y</code></td>
<td>
<p><code>[numeric]</code>: Define <code>Partition</code> P that will be use to plot
the object. <code>P</code> is a <code>Partition</code> hold in the field <code>c2</code>,
<code>c3</code>, ... <code>c26</code>. If <code>y=c(a,b)</code>, then <code>P</code> is
the <code>Partition</code> number <code>b</code> with <code>a</code> clusters. If <code>y=a</code>,
then <code>P</code> is the partition number <code>1</code> with <code>a</code>
clusters. If <code>y</code> is missing, <code>P</code> is the <code>Partition</code> with the best
criterion.</p>
</td></tr>
<tr><td><code id="plot3dPdf_+3A_vary">varY</code></td>
<td>
<p><code>[numeric]</code> or <code>[character]</code>: either the
number or the name of the first variable to display. 1 by default.</p>
</td></tr>
<tr><td><code id="plot3dPdf_+3A_varz">varZ</code></td>
<td>
<p><code>[numeric]</code> or <code>[character]</code>: either the
number or the name of the second variable to display. 2 by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Create Triangle objects representing the 3D plot of the main
trajectories of a <code><a href="kml.html#topic+ClusterLongData-class">ClusterLongData</a></code>.
</p>
<p>The three functions <code><a href="#topic+plot3dPdf">plot3dPdf</a></code>, <code><a href="longitudinalData.html#topic+saveTrianglesAsASY">saveTrianglesAsASY</a></code> and <code><a href="longitudinalData.html#topic+makeLatexFile">makeLatexFile</a></code>
are design to export a 3D graph to a Pdf file. The process is the following:
</p>

<ol>
<li> <p><code><a href="#topic+plot3dPdf">plot3dPdf</a></code>: Create a scene, that is a collection of Triangle object that
represent a 3D images.
</p>
</li>
<li> <p><code><a href="longitudinalData.html#topic+saveTrianglesAsASY">saveTrianglesAsASY</a></code>: Export the scene in an '.asy' file.
</p>
</li>
<li><p> '.azy' can not be include in LaTeX file. LaTeX can read only '.pre' file. So the next step is to use
<code>asymptote</code> to convert '.asy' tp '.pre'. This is done by the command <code>asy -inlineimage -tex pdflatex
      scene.azy</code>.
</p>
</li>
<li><p> The previous step did produce a file <code>scene+0.prc</code> that can be include in a LaTeX file.
<code><a href="longitudinalData.html#topic+makeLatexFile">makeLatexFile</a></code> create a LaTeX file that is directly compilable (using <code>pdfLatex</code>).
It produce a pdf file that contain the 3D object.
</p>
</li></ol>



<h3>Value</h3>

<p>A Triangle object.
</p>


<h3>Author(s)</h3>

<p>Christophe Genolini<br />
INSERM U669 / PSIGIAM: Paris Sud Innovation Group in Adolescent Mental Health<br />
Modal'X / Universite Paris Ouest-Nanterre- La Defense <br /><br />
</p>
<p>Contact author : <a href="mailto:genolini@u-paris10.fr">genolini@u-paris10.fr</a>
</p>


<h3>References</h3>

<p>Article &quot;KmL: K-means for Longitudinal Data&quot;, in
Computational Statistics, Volume 25, Issue 2 (2010), Page 317. <br />
Web site: <a href="http://christophe.genolini.free.fr/kml/">http://christophe.genolini.free.fr/kml/</a>
</p>


<h3>See Also</h3>

<p><a href="misc3d.html#topic+makeTriangles">makeTriangles</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ### Move to tempdir
  wd &lt;- getwd()
  setwd(tempdir()); getwd()
  
  ### Generating the data
  myCld3d &lt;- gald3d(c(5,5,5))
  kml3d(myCld3d,3:4,1)

  ### Creation of the scene
  scene &lt;- plot3dPdf(myCld3d,3)
  drawScene.rgl(scene)

  ### Export in '.azy' file
  saveTrianglesAsASY(scene)

  ### Creation of a '.prc' file
  # Open a console window, then run
  # asy -inlineimage -tex pdflatex scene.azy

  ### Creation of the LaTeX main document
  makeLatexFile()

  ### Creation of the '.pdf'
  # Open a console window, then run
  # pdfLatex main.tex
  
  ### Go back to current dir
  setwd(wd)
</code></pre>

<hr>
<h2 id='plotMeans3d+2CClusterLongData3d'> ~ Function: plotMeans3d for ClusterLongData3d ~ </h2><span id='topic+plotMeans3d'></span><span id='topic+plotMeans3d+2CClusterLongData3d+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Plot the means of two variables of a <code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code> object in 3D
relatively to a <code><a href="longitudinalData.html#topic+Partition-class">Partition</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ClusterLongData3d,numeric'
plotMeans3d(x,y,varY=1,varZ=2,
   parTraj=parTRAJ(type="n"),parMean=parMEAN(),...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotMeans3d+2B2CClusterLongData3d_+3A_x">x</code></td>
<td>
<p><code>[ClusterLongData3d]</code>: Object containing the trajectories to plot.</p>
</td></tr>
<tr><td><code id="plotMeans3d+2B2CClusterLongData3d_+3A_y">y</code></td>
<td>
<p><code>[numeric]</code> or <code>[vector2(numeric)]</code>: Define the <code>Partition</code> P that will be use to plot
the object. <code>P</code> is a <code>Partition</code> hold in the field <code>c2</code>,
<code>c3</code>, ... <code>c26</code>. If <code>y=c(a,b)</code>, then <code>P</code> is
the <code>Partition</code> number <code>b</code> with <code>a</code> clusters. If <code>y=a</code>,
then <code>P</code> is the partition number <code>1</code> with <code>a</code>
clusters.</p>
</td></tr>
<tr><td><code id="plotMeans3d+2B2CClusterLongData3d_+3A_vary">varY</code></td>
<td>
<p><code>[numeric]</code> or <code>[character]</code>: either the
number or the name of the first variable to display. 1 by default.</p>
</td></tr>
<tr><td><code id="plotMeans3d+2B2CClusterLongData3d_+3A_varz">varZ</code></td>
<td>
<p><code>[numeric]</code> or <code>[character]</code>: either the
number or the name of the second variable to display. 2 by default.</p>
</td></tr>
<tr><td><code id="plotMeans3d+2B2CClusterLongData3d_+3A_partraj">parTraj</code></td>
<td>
<p><code>[ParLongData]</code>: Set the graphical parameters
used to plot the trajectories of the <code>ClusterLongData3d</code>. See <code><a href="longitudinalData.html#topic+ParLongData-class">ParLongData</a></code>
for details.</p>
</td></tr>
<tr><td><code id="plotMeans3d+2B2CClusterLongData3d_+3A_parmean">parMean</code></td>
<td>
<p><code>[ParLongData]</code>:  Set the graphical parameters
used to plot the mean trajectories of each clusters <code>ClusterLongData3d</code>
(only when <code>y</code> is non missing). See <code><a href="longitudinalData.html#topic+ParLongData-class">ParLongData</a></code>
for details.</p>
</td></tr>
<tr><td><code id="plotMeans3d+2B2CClusterLongData3d_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods, such as graphical parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plot two variables of a <code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code> object in 3D. It
use the <code><a href="rgl.html#topic+rgl">rgl</a></code> library. The user can make the
graphical representation turn using its mouse.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>### Move to tempdir
wd &lt;- getwd()
setwd(tempdir()); getwd()

##################
### Real example on array

time=c(1,2,3,4,8,12,16,20)
id2=1:120
f &lt;- function(id,t)((id-1)%%3-1) * t
g &lt;- function(id,t)(id%%2+1)*t
h &lt;- function(id,t)(id%%4-0.5)*(20-t)
myCld &lt;- clusterLongData3d(array(cbind(outer(id2,time,f),outer(id2,time,g),
   outer(id2,time,h))+rnorm(120*8*3,0,3),dim=c(120,8,3)))
kml3d(myCld,3:4,2)

### Basic plot
plotMeans3d(myCld,3)

### plotMeans3d, variable 1 and 3
plotMeans3d(myCld,4,varZ=3)
plotMeans3d(myCld,3,parTraj=parTRAJ(col="red"))

### Go back to current dir
setwd(wd)
</code></pre>

<hr>
<h2 id='plotTraj3d+2CClusterLongData3d'> ~ Function: plotTraj3d for ClusterLongData3d ~ </h2><span id='topic+plotTraj3d'></span><span id='topic+plotTraj3d+2CClusterLongData3d+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Plot the trajectories of two variables of a <code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code> object in 3D
relatively to a <code><a href="longitudinalData.html#topic+Partition-class">Partition</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ClusterLongData3d,numeric'
plotTraj3d(x,y,varY=1,varZ=2,
   parTraj=parTRAJ(col="clusters"),parMean=parMEAN(type="n"),...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotTraj3d+2B2CClusterLongData3d_+3A_x">x</code></td>
<td>
<p><code>[ClusterLongData3d]</code>: Object containing the trajectories to plot.</p>
</td></tr>
<tr><td><code id="plotTraj3d+2B2CClusterLongData3d_+3A_y">y</code></td>
<td>
<p><code>[numeric]</code> or <code>[vector2(numeric)]</code>: Define the <code>Partition</code> P that will be use to plot
the object. <code>P</code> is a <code>Partition</code> hold in the field <code>c2</code>,
<code>c3</code>, ... <code>c26</code>. If <code>y=c(a,b)</code>, then <code>P</code> is
the <code>Partition</code> number <code>b</code> with <code>a</code> clusters. If <code>y=a</code>,
then <code>P</code> is the partition number <code>1</code> with <code>a</code>
clusters.</p>
</td></tr>
<tr><td><code id="plotTraj3d+2B2CClusterLongData3d_+3A_vary">varY</code></td>
<td>
<p><code>[numeric]</code> or <code>[character]</code>: either the
number or the name of the first variable to display. 1 by default.</p>
</td></tr>
<tr><td><code id="plotTraj3d+2B2CClusterLongData3d_+3A_varz">varZ</code></td>
<td>
<p><code>[numeric]</code> or <code>[character]</code>: either the
number or the name of the second variable to display. 2 by default.</p>
</td></tr>
<tr><td><code id="plotTraj3d+2B2CClusterLongData3d_+3A_partraj">parTraj</code></td>
<td>
<p><code>[ParLongData]</code>: Set the graphical parameters
used to plot the trajectories of the <code>ClusterLongData3d</code>. See <code><a href="longitudinalData.html#topic+ParLongData-class">ParLongData</a></code>
for details.</p>
</td></tr>
<tr><td><code id="plotTraj3d+2B2CClusterLongData3d_+3A_parmean">parMean</code></td>
<td>
<p><code>[ParLongData]</code>:  Set the graphical parameters
used to plot the mean trajectories of each clusters <code>ClusterLongData3d</code>
(only when <code>y</code> is non missing). See <code><a href="longitudinalData.html#topic+ParLongData-class">ParLongData</a></code>
for details.</p>
</td></tr>
<tr><td><code id="plotTraj3d+2B2CClusterLongData3d_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods, such as graphical parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plot the means trajectories of two variables of a <code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code> object in 3D. It
use the <code><a href="rgl.html#topic+rgl">rgl</a></code> library. The user can make the
graphical representation turn using its mouse.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ClusterLongData3d-class">ClusterLongData3d</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>### Move to tempdir
wd &lt;- getwd()
setwd(tempdir()); getwd()

##################
### Real example on array

time=c(1,2,3,4,8,12,16,20)
id2=1:120
f &lt;- function(id,t)((id-1)%%3-1) * t
g &lt;- function(id,t)(id%%2+1)*t
h &lt;- function(id,t)(id%%4-0.5)*(20-t)
myCld &lt;- clusterLongData3d(array(cbind(outer(id2,time,f),outer(id2,time,g),
   outer(id2,time,h))+rnorm(120*8*3,0,3),dim=c(120,8,3)))
kml3d(myCld,3:4,2)

### Basic plot
plotMeans3d(myCld,3)

### plotTraj3d, variable 1 and 3
plotMeans3d(myCld,4,varZ=3)
plotMeans3d(myCld,3,parMean=parMEAN(col="red"))

### Go back to current dir
setwd(wd)
</code></pre>

<hr>
<h2 id='pregnandiol'>~ Pregnandiol measure (from QUIDEL database, René Écochard) ~</h2><span id='topic+pregnandiol'></span>

<h3>Description</h3>

<p>These longitudinal data are extract form the QUIDEL database whose aims is to
studies hormone profiles among women who have no fertility problem.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pregnandiol)</code></pre>


<h3>Format</h3>

<p>Some longitudinal data in wide format. It includes 107 women who have been followed during up to 49
days. Each column correspond to a specific time meseaurement. The
outcome is the hormone &quot;pregnandiol&quot;.
</p>

<dl>
<dt><code>id</code></dt><dd><p>unique idenfier for each patient.</p>
</dd>
<dt><code>day1</code></dt><dd><p>Measurement of pregnandiol at day 1.</p>
</dd>
<dt><code>day2</code></dt><dd><p>Measurement of pregnandiol at day 2.</p>
</dd>
<dt><code>day3</code></dt><dd><p>Measurement of pregnandiol at day 3.</p>
</dd>
<dt><code>...</code></dt><dd><p>...</p>
</dd>
<dt><code>day 49</code></dt><dd><p>Measurement of pregnandiol at day 49.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The QUIDEL database aims to gain better knowledge of hormone profiles
among women who have no fertility problem. This database has been
described as the largest existing database on hormone profiles in the
normal human menstrual cycle, involving ultrasound scan of the day of
ovulation [eco06]. It involves 107 women and 283 cycles in all, with
identification of the day of ovulation and daily titration of the levels
of the four main hormones in the ovulation cycle. The database belongs
to the laboratory in charge of the analysis of hormone trajectories
(CNRS 5558, René Ecochard).
It has already been the subject of numerous
publications, including [eco00, eco01].</p>


<h3>Source</h3>

<p>QUIDEL cohort</p>


<h3>References</h3>

<p>[eco00]	Ecochard R, Gougeon A. Side of ovulation and cycle characteristics in normally fertile women. Human reproduction (Oxford, England). 2000;15(4):752-755.
</p>
<p>[eco01]	Ecochard R et al. Chronological aspects of ultrasonic, hormonal, and other indirect indices of ovulation. BJOG : an international journal of obstetrics and gynaecology. 2001;108(8):822-829.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
