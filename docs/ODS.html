<!DOCTYPE html><html><head><title>Help for package ODS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ODS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Bfct'><p>power basis functions of a spline of given degree</p></a></li>
<li><a href='#casecohort_data_secondary'><p>Data example for the secondary analysis in case-cohort design</p></a></li>
<li><a href='#Estimate_PLMODS'><p>Partial linear model for ODS data</p></a></li>
<li><a href='#gcv_ODS'><p>Generalized cross-validation for ODS data</p></a></li>
<li><a href='#logspace'><p>Generate logarithmically spaced vector</p></a></li>
<li><a href='#ods_data'><p>Data example for analyzing the primary response in ODS design</p></a></li>
<li><a href='#ods_data_secondary'><p>Data example for the secondary analysis in ODS design</p></a></li>
<li><a href='#odsmle'><p>MSELE estimator for analyzing the primary outcome in ODS design</p></a></li>
<li><a href='#quantileknots'><p>Create knots at sample quantiles</p></a></li>
<li><a href='#se.spmle'><p>standard error for MSELE estimator</p></a></li>
<li><a href='#secondary_casecohort'><p>Secondary analysis in case-cohort data</p></a></li>
<li><a href='#secondary_ODS'><p>Secondary analysis in ODS design</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Statistical Methods for Outcome-Dependent Sampling Designs</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Yinghao Pan [aut, cre],
  Haibo Zhou [aut],
  Mark Weaver [aut],
  Guoyou Qin [aut],
  Jianwen Cai [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yinghao Pan &lt;ypan8@uncc.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Outcome-dependent sampling (ODS) schemes are cost-effective ways to enhance study efficiency. 
    In ODS designs, one observes the exposure/covariates with a probability that depends on the outcome 
    variable. Popular ODS designs include case-control for binary outcome, case-cohort for time-to-event 
    outcome, and continuous outcome ODS design (Zhou et al. 2002) &lt;<a href="https://doi.org/10.1111%2Fj.0006-341X.2002.00413.x">doi:10.1111/j.0006-341X.2002.00413.x</a>&gt;. 
    Because ODS data has biased sampling nature, standard statistical analysis such as linear regression 
    will lead to biases estimates of the population parameters. This package implements four statistical 
    methods related to ODS designs: (1) An empirical likelihood method analyzing the primary continuous 
    outcome with respect to exposure variables in continuous ODS design (Zhou et al., 2002). (2) A partial 
    linear model analyzing the primary outcome in continuous ODS design (Zhou, Qin and Longnecker, 2011) 
    &lt;<a href="https://doi.org/10.1111%2Fj.1541-0420.2010.01500.x">doi:10.1111/j.1541-0420.2010.01500.x</a>&gt;. (3) Analyze a secondary outcome in continuous ODS design 
    (Pan et al. 2018) &lt;<a href="https://doi.org/10.1002%2Fsim.7672">doi:10.1002/sim.7672</a>&gt;. (4) An estimated likelihood method analyzing a secondary 
    outcome in case-cohort data (Pan et al. 2017) &lt;<a href="https://doi.org/10.1111%2Fbiom.12838">doi:10.1111/biom.12838</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.0</td>
</tr>
<tr>
<td>Imports:</td>
<td>cubature (&ge; 1.4-1), survival (&ge; 2.42-3), utils, stats</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Yinghao-Pan/ODS">https://github.com/Yinghao-Pan/ODS</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Yinghao-Pan/ODS/issues">https://github.com/Yinghao-Pan/ODS/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-11-18 23:43:39 UTC; yinghaopan</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-11-19 17:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='Bfct'>power basis functions of a spline of given degree</h2><span id='topic+Bfct'></span>

<h3>Description</h3>

<p><code>Bfct</code> returns the power basis functions of a spline of given degree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bfct(x, degree, knots, der)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Bfct_+3A_x">x</code></td>
<td>
<p>n by 1 matrix of the independent variable</p>
</td></tr>
<tr><td><code id="Bfct_+3A_degree">degree</code></td>
<td>
<p>the order of spline</p>
</td></tr>
<tr><td><code id="Bfct_+3A_knots">knots</code></td>
<td>
<p>the knots location</p>
</td></tr>
<tr><td><code id="Bfct_+3A_der">der</code></td>
<td>
<p>the der-order derivative. The default is 0</p>
</td></tr>
</table>


<h3>Value</h3>

<p>n by (1+degree+nknots) matrix corresponding to the truncated power
spline basis with knots and specified degree.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ODS)

x &lt;- matrix(c(1,2,3,4,5),ncol=1)
degree &lt;- 2
knots &lt;- c(1,3,4)

Bfct(x, degree, knots)
</code></pre>

<hr>
<h2 id='casecohort_data_secondary'>Data example for the secondary analysis in case-cohort design</h2><span id='topic+casecohort_data_secondary'></span>

<h3>Description</h3>

<p>Data example for the secondary analysis in case-cohort design
</p>


<h3>Usage</h3>

<pre><code class='language-R'>casecohort_data_secondary
</code></pre>


<h3>Format</h3>

<p>A data frame with 1000 rows and 15 columns: </p>

<dl>
<dt>subj_ind</dt><dd><p>An indicator variable for each subject: 1 = SRS, 2 =
supplemental cases, 0 = NVsample</p>
</dd> <dt>T</dt><dd><p>observation time for failure
outcome</p>
</dd> <dt>Delta</dt><dd><p>event indicator</p>
</dd> <dt>Y2</dt><dd><p>a continuous secondary
outcome</p>
</dd><dt>X</dt><dd><p>expensive exposure</p>
</dd> <dt>Z11</dt><dd><p>first covariate in the
linear regression model</p>
</dd> <dt>Z12</dt><dd><p>second covariate in the linear
regression model</p>
</dd><dt>Z13</dt><dd><p>third covariate in the linear regression model</p>
</dd>
<dt>Z14</dt><dd><p>fourth covariate in the linear regression model</p>
</dd><dt>Z21</dt><dd><p>first
covariate in the Cox model</p>
</dd> <dt>Z22</dt><dd><p>second covariate in the Cox
model</p>
</dd><dt>Z23</dt><dd><p>third covariate in the Cox model</p>
</dd> <dt>Z31</dt><dd><p>first
covariate that is related to the conditional distribution of X given other
covariates</p>
</dd><dt>Z32</dt><dd><p>second covariate that is related to the conditional
distribution</p>
</dd> <dt>Z33</dt><dd><p>thid covariate that is related to the conditional
distribution</p>
</dd> </dl>


<h3>Source</h3>

<p>A simulated data set
</p>

<hr>
<h2 id='Estimate_PLMODS'>Partial linear model for ODS data</h2><span id='topic+Estimate_PLMODS'></span>

<h3>Description</h3>

<p><code>Estimate_PLMODS</code> computes the estimate of parameters in a partial
linear model in the setting of outcome-dependent sampling. See details in
Zhou, Qin and Longnecker (2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Estimate_PLMODS(X, Y, Z, n_f, eta00, q_s, Cpt, mu_Y, sig_Y, degree, nknots,
  tol, iter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Estimate_PLMODS_+3A_x">X</code></td>
<td>
<p>n by 1 matrix of the observed exposure variable</p>
</td></tr>
<tr><td><code id="Estimate_PLMODS_+3A_y">Y</code></td>
<td>
<p>n by 1 matrix of the observed outcome variable</p>
</td></tr>
<tr><td><code id="Estimate_PLMODS_+3A_z">Z</code></td>
<td>
<p>n by p matrix of the other covariates</p>
</td></tr>
<tr><td><code id="Estimate_PLMODS_+3A_n_f">n_f</code></td>
<td>
<p>n_f = c(n0, n1, n2), where n0 is the SRS sample size, n1 is the
size of the supplemental sample chosen from (-infty, mu_Y-a*sig_Y), n2 is
the size of the supplemental sample chosen from (mu_Y+a*sig_Y, +infty).</p>
</td></tr>
<tr><td><code id="Estimate_PLMODS_+3A_eta00">eta00</code></td>
<td>
<p>a column matrix. eta00 = (theta^T pi^T v^T sig0_sq)^T where
theta=(alpha^T, gamma^T)^T. We refer to Zhou, Qin and Longnecker (2011) for
details of these notations.</p>
</td></tr>
<tr><td><code id="Estimate_PLMODS_+3A_q_s">q_s</code></td>
<td>
<p>smoothing parameter</p>
</td></tr>
<tr><td><code id="Estimate_PLMODS_+3A_cpt">Cpt</code></td>
<td>
<p>cut point a</p>
</td></tr>
<tr><td><code id="Estimate_PLMODS_+3A_mu_y">mu_Y</code></td>
<td>
<p>mean of Y in the population</p>
</td></tr>
<tr><td><code id="Estimate_PLMODS_+3A_sig_y">sig_Y</code></td>
<td>
<p>standard deviation of Y in the population</p>
</td></tr>
<tr><td><code id="Estimate_PLMODS_+3A_degree">degree</code></td>
<td>
<p>degree of the truncated power spline basis, default value is 2</p>
</td></tr>
<tr><td><code id="Estimate_PLMODS_+3A_nknots">nknots</code></td>
<td>
<p>number of knots of the truncated power spline basis, default
value is 10</p>
</td></tr>
<tr><td><code id="Estimate_PLMODS_+3A_tol">tol</code></td>
<td>
<p>convergence criteria, the default value is 1e-6</p>
</td></tr>
<tr><td><code id="Estimate_PLMODS_+3A_iter">iter</code></td>
<td>
<p>maximum iteration number, the default value is 30</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We assume that in the population, the primary outcome variable Y follows the
following partial linear model:
</p>
<p style="text-align: center;"><code class="reqn">E(Y|X,Z)=g(X)+Z^{T}\gamma</code>
</p>
<p> where X is the
expensive exposure, Z are other covariates. In ODS design, a simple random
sample is taken from the full cohort, then two supplemental samples are taken
from two tails of Y, i.e. (-Infty, mu_Y - a*sig_Y) and (mu_Y + a*sig_Y,
+Infty). Because ODS data has biased sampling nature, naive regression
analysis will yield biased estimates of the population parameters. Zhou, Qin
and Longnecker (2011) describes a semiparametric empirical likelihood
estimator for estimating the parameters in the partial linear model.
</p>


<h3>Value</h3>

<p>Parameter estimates and standard errors for the partial linear model:
</p>
<p style="text-align: center;"><code class="reqn">E(Y|X,Z)=g(X)+Z^{T}\gamma</code>
</p>
<p> where the
unknown smooth function g is approximated by a spline function with fixed
knots. The results contain the following components: </p>
<table>
<tr><td><code>alpha</code></td>
<td>
<p>spline
coefficient</p>
</td></tr> <tr><td><code>gam</code></td>
<td>
<p>other linear regression coefficients</p>
</td></tr>
<tr><td><code>std_gam</code></td>
<td>
<p>standard error of gam</p>
</td></tr> <tr><td><code>cov_mtxa</code></td>
<td>
<p>covariance matrix of
alpha</p>
</td></tr> <tr><td><code>step</code></td>
<td>
<p>numbers of iteration requied to acheive convergence</p>
</td></tr>
<tr><td><code>pi0</code></td>
<td>
<p>estimated notation pi</p>
</td></tr> <tr><td><code>v0</code></td>
<td>
<p>estimated notation vtheta</p>
</td></tr>
<tr><td><code>sig0_sq0</code></td>
<td>
<p>estimated variance of error</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
library(ODS)
# take the example data from the ODS package
# please see the documentation for details about the data set ods_data

nknots = 10
degree = 2

# get the initial value of the parameters from standard linear regression based on SRS data #
dataSRS = ods_data[1:200,]
YS = dataSRS[,1]
XS = dataSRS[,2]
ZS = dataSRS[,3:5]

knots = quantileknots(XS, nknots, 0)
# the power basis spline function
MS = Bfct(as.matrix(XS), degree, knots)
DS = cbind(MS, ZS)
theta00 = as.numeric(lm(YS ~ DS -1)$coefficients)
sig0_sq00 = var(YS - DS %*% theta00)
pi00 = c(0.15, 0.15)
v00 = c(0, 0)
eta00 = matrix(c(theta00, pi00, v00, sig0_sq00), ncol=1)
mu_Y = mean(YS)
sig_Y = sd(YS)

Y = matrix(ods_data[,1])
X = matrix(ods_data[,2])
Z = matrix(ods_data[,3:5], nrow=400)

# In this ODS data, the supplemental samples are taken from (-Infty, mu_Y-a*sig_Y) #
# and (mu_Y+a*sig_Y, +Infty), where a=1 #
n_f = c(200, 100, 100)
Cpt = 1

# GCV selection to find the optimal smoothing parameter #
q_s1 = logspace(-6, 7, 10)
gcv1 = rep(0, 10)

for (j in 1:10) {

  result = Estimate_PLMODS(X,Y,Z,n_f,eta00,q_s1[j],Cpt,mu_Y,sig_Y)
  etajj = matrix(c(result$alpha, result$gam, result$pi0, result$v0, result$sig0_sq0), ncol=1)
  gcv1[j] = gcv_ODS(X,Y,Z,n_f,etajj,q_s1[j],Cpt,mu_Y,sig_Y)
}

b = which(gcv1 == min(gcv1))
q_s = q_s1[b]
q_s

# Estimation of the partial linear model in the setting of outcome-dependent sampling #
result = Estimate_PLMODS(X, Y, Z, n_f, eta00, q_s, Cpt, mu_Y, sig_Y)
result

</code></pre>

<hr>
<h2 id='gcv_ODS'>Generalized cross-validation for ODS data</h2><span id='topic+gcv_ODS'></span>

<h3>Description</h3>

<p><code>gcv_ODS</code> calculates the generalized cross-validation (GCV) for
selecting the smoothing parameter in the setting of outcome-dependent
sampling. The details can be seen in Zhou, Qin and Longnecker (2011) and its
supplementary materials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gcv_ODS(X, Y, Z, n_f, eta, q_s, Cpt, mu_Y, sig_Y, degree, nknots)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gcv_ODS_+3A_x">X</code></td>
<td>
<p>n by 1 matrix of the observed exposure variable</p>
</td></tr>
<tr><td><code id="gcv_ODS_+3A_y">Y</code></td>
<td>
<p>n by 1 matrix of the observed outcome variable</p>
</td></tr>
<tr><td><code id="gcv_ODS_+3A_z">Z</code></td>
<td>
<p>n by p matrix of the other covariates</p>
</td></tr>
<tr><td><code id="gcv_ODS_+3A_n_f">n_f</code></td>
<td>
<p>n_f = c(n0, n1, n2), where n0 is the SRS sample size, n1 is the
size of the supplemental sample chosen from (-infty, mu_Y-a*sig_Y), n2 is
the size of the supplemental sample chosen from (mu_Y+a*sig_Y, +infty).</p>
</td></tr>
<tr><td><code id="gcv_ODS_+3A_eta">eta</code></td>
<td>
<p>a column matrix. eta = (theta^T pi^T v^T sig0_sq)^T where
theta=(alpha^T, gamma^T)^T. We refer to Zhou, Qin and Longnecker (2011) for
details of these notations.</p>
</td></tr>
<tr><td><code id="gcv_ODS_+3A_q_s">q_s</code></td>
<td>
<p>smoothing parameter</p>
</td></tr>
<tr><td><code id="gcv_ODS_+3A_cpt">Cpt</code></td>
<td>
<p>cut point a</p>
</td></tr>
<tr><td><code id="gcv_ODS_+3A_mu_y">mu_Y</code></td>
<td>
<p>mean of Y in the population</p>
</td></tr>
<tr><td><code id="gcv_ODS_+3A_sig_y">sig_Y</code></td>
<td>
<p>standard deviation of Y in the population</p>
</td></tr>
<tr><td><code id="gcv_ODS_+3A_degree">degree</code></td>
<td>
<p>degree of the truncated power spline basis, default value is 2</p>
</td></tr>
<tr><td><code id="gcv_ODS_+3A_nknots">nknots</code></td>
<td>
<p>number of knots of the truncated power spline basis, default
value is 10</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the value of generalized cross-validation score
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(ODS)
# take the example data from the ODS package
# please see the documentation for details about the data set ods_data

nknots = 10
degree = 2

# get the initial value of the parameters from standard linear regression based on SRS data #
dataSRS = ods_data[1:200,]
YS = dataSRS[,1]
XS = dataSRS[,2]
ZS = dataSRS[,3:5]

knots = quantileknots(XS, nknots, 0)
# the power basis spline function
MS = Bfct(as.matrix(XS), degree, knots)
DS = cbind(MS, ZS)
theta00 = as.numeric(lm(YS ~ DS -1)$coefficients)
sig0_sq00 = var(YS - DS %*% theta00)
pi00 = c(0.15, 0.15)
v00 = c(0, 0)
eta00 = matrix(c(theta00, pi00, v00, sig0_sq00), ncol=1)
mu_Y = mean(YS)
sig_Y = sd(YS)

Y = matrix(ods_data[,1])
X = matrix(ods_data[,2])
Z = matrix(ods_data[,3:5], nrow=400)

# In this ODS data, the supplemental samples are taken from (-Infty, mu_Y-a*sig_Y) #
# and (mu_Y+a*sig_Y, +Infty), where a=1 #
n_f = c(200, 100, 100)
Cpt = 1

# GCV selection to find the optimal smoothing parameter #
q_s1 = logspace(-6, 7, 10)
gcv1 = rep(0, 10)

for (j in 1:10) {

  result = Estimate_PLMODS(X,Y,Z,n_f,eta00,q_s1[j],Cpt,mu_Y,sig_Y)
  etajj = matrix(c(result$alpha, result$gam, result$pi0, result$v0, result$sig0_sq0), ncol=1)
  gcv1[j] = gcv_ODS(X,Y,Z,n_f,etajj,q_s1[j],Cpt,mu_Y,sig_Y)
}

b = which(gcv1 == min(gcv1))
q_s = q_s1[b]

q_s

# Estimation of the partial linear model in the setting of outcome-dependent sampling #
result = Estimate_PLMODS(X, Y, Z, n_f, eta00, q_s, Cpt, mu_Y, sig_Y)
result

</code></pre>

<hr>
<h2 id='logspace'>Generate logarithmically spaced vector</h2><span id='topic+logspace'></span>

<h3>Description</h3>

<p><code>logspace</code> generates n logarithmically spaced points between 10^d1 and
10^d2. The utility of this function is equivalent to logspace function in
matlab.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logspace(d1, d2, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logspace_+3A_d1">d1</code></td>
<td>
<p>first bound</p>
</td></tr>
<tr><td><code id="logspace_+3A_d2">d2</code></td>
<td>
<p>second bound</p>
</td></tr>
<tr><td><code id="logspace_+3A_n">n</code></td>
<td>
<p>number of points</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of n logarithmically spaced points between 10^d1 and 10^d2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logspace(-6,7,30)
</code></pre>

<hr>
<h2 id='ods_data'>Data example for analyzing the primary response in ODS design</h2><span id='topic+ods_data'></span>

<h3>Description</h3>

<p>Data example for analyzing the primary response in ODS design (zhou et al.
2002)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ods_data
</code></pre>


<h3>Format</h3>

<p>A matrix with 400 rows and 5 columns. The first 200 observations are
from the simple random sample, while 2 supplemental samples each with size
100 are taken from one standard deviation above the mean and below the
mean, i.e. (Y1 &lt; 0.162) and (Y1 &gt; 2.59). </p>
 <dl>
<dt>Y1</dt><dd><p>primary
outcome for which the ODS sampling scheme is based on</p>
</dd> <dt>X</dt><dd><p>expensive
exposure</p>
</dd> <dt>Z1</dt><dd><p>a simulated covariate</p>
</dd> <dt>Z2</dt><dd><p>a simulated covariate</p>
</dd>
<dt>Z3</dt><dd><p>a simulated covariate</p>
</dd> </dl>


<h3>Source</h3>

<p>A simulated data set
</p>

<hr>
<h2 id='ods_data_secondary'>Data example for the secondary analysis in ODS design</h2><span id='topic+ods_data_secondary'></span>

<h3>Description</h3>

<p>Data example for the secondary analysis in ODS design
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ods_data_secondary
</code></pre>


<h3>Format</h3>

<p>A matrix with 3000 rows and 7 columns: </p>
 <dl>
<dt>subj_ind</dt><dd><p>An
indicator variable for each subject: 1 = SRS, 2 = lowerODS, 3 = upperODS, 0
= NVsample</p>
</dd> <dt>Y1</dt><dd><p>primary outcome for which the ODS sampling scheme is
based on</p>
</dd> <dt>Y2</dt><dd><p>a secondary outcome</p>
</dd> <dt>X</dt><dd><p>expensive exposure</p>
</dd>
<dt>Z1</dt><dd><p>a simulated covariate</p>
</dd> <dt>Z2</dt><dd><p>a simulated covariate</p>
</dd>
<dt>Z3</dt><dd><p>a simulated covariate</p>
</dd> </dl>


<h3>Source</h3>

<p>A simulated data set
</p>

<hr>
<h2 id='odsmle'>MSELE estimator for analyzing the primary outcome in ODS design</h2><span id='topic+odsmle'></span>

<h3>Description</h3>

<p><code>odsmle</code> provides a maximum semiparametric empirical likelihood estimator
(MSELE) for analyzing the primary outcome Y with respect to expensive exposure
and other covariates in ODS design (Zhou et al. 2002).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odsmle(Y, X, beta, sig, pis, a, rs.size, size, strat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="odsmle_+3A_y">Y</code></td>
<td>
<p>vector for the primary response</p>
</td></tr>
<tr><td><code id="odsmle_+3A_x">X</code></td>
<td>
<p>the design matrix with a column of 1's for the intercept</p>
</td></tr>
<tr><td><code id="odsmle_+3A_beta">beta</code></td>
<td>
<p>starting parameter values for the regression coefficients that
relate Y to X.</p>
</td></tr>
<tr><td><code id="odsmle_+3A_sig">sig</code></td>
<td>
<p>starting parameter values for the error variance of the regression.</p>
</td></tr>
<tr><td><code id="odsmle_+3A_pis">pis</code></td>
<td>
<p>starting parameter values for the stratum probabilities (the
probability that Y belongs to certain stratum) e.g. pis = c(0.1, 0.8, 0.1).</p>
</td></tr>
<tr><td><code id="odsmle_+3A_a">a</code></td>
<td>
<p>vector of cutpoints for the primary response (e.g., a = c(-2.5,2))</p>
</td></tr>
<tr><td><code id="odsmle_+3A_rs.size">rs.size</code></td>
<td>
<p>size of the SRS (simple random sample)</p>
</td></tr>
<tr><td><code id="odsmle_+3A_size">size</code></td>
<td>
<p>vector of the stratum sizes of the supplemental samples (e.g. size
= c(50,0,50) represents that two supplemental samples each of size 50 are
taken from the upper and lower tail of Y.)</p>
</td></tr>
<tr><td><code id="odsmle_+3A_strat">strat</code></td>
<td>
<p>vector that indicates the stratum numbers (e.g. strat = c(1,2,3)
represents that there are three stratums).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We assume that in the population, the primary outcome variable Y follows the
following model: </p>
<p style="text-align: center;"><code class="reqn">Y=\beta_{0}+\beta_{1}X+\epsilon,</code>
</p>
<p> where X are the covariates, and epsilon has variance sig. In ODS
design, a simple random sample is taken from the full cohort, then two
supplemental samples are taken from two tails of Y, i.e. (-Infty, mu_Y -
a*sig_Y) and (mu_Y + a*sig_Y, +Infty). Because ODS data has biased sampling
nature, naive regression analysis will yield biased estimates of the
population parameters. Zhou et al. (2002) describes a semiparametric empirical
likelihood estimator for estimating the parameters in the primary outcome
model.
</p>


<h3>Value</h3>

<p>A list which contains the parameter estimates for the primary response
model: </p>
<p style="text-align: center;"><code class="reqn">Y=\beta_{0}+\beta_{1}X+\epsilon,</code>
</p>
<p> where epsilon has variance sig. The list contains the following
components: </p>
<table>
<tr><td><code>beta</code></td>
<td>
<p>parameter estimates for beta</p>
</td></tr> <tr><td><code>sig</code></td>
<td>
<p>estimates
for sig</p>
</td></tr> <tr><td><code>pis</code></td>
<td>
<p>estimates for the stratum probabilities</p>
</td></tr>
<tr><td><code>grad</code></td>
<td>
<p>gradient</p>
</td></tr> <tr><td><code>hess</code></td>
<td>
<p>hessian</p>
</td></tr> <tr><td><code>converge</code></td>
<td>
<p>whether the
algorithm converges: True or False</p>
</td></tr> <tr><td><code>i</code></td>
<td>
<p>Number of iterations</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(ODS)
# take the example data from the ODS package
# please see the documentation for details about the data set ods_data

Y &lt;- ods_data[,1]
X &lt;- cbind(rep(1,length(Y)), ods_data[,2:5])

# use the simple random sample to get an initial estimate of beta, sig #
# perform an ordinary least squares #
SRS &lt;- ods_data[1:200,]
OLS.srs &lt;- lm(SRS[,1] ~ SRS[,2:5])
OLS.srs.summary &lt;- summary(OLS.srs)

beta &lt;- coefficients(OLS.srs)
sig &lt;- OLS.srs.summary$sigma^2
pis &lt;- c(0.1,0.8,0.1)

# the cut points for this data is Y &lt; 0.162, Y &gt; 2.59.
a &lt;- c(0.162,2.59)
rs.size &lt;- 200
size &lt;- c(100,0,100)
strat &lt;- c(1,2,3)

odsmle(Y,X,beta,sig,pis,a,rs.size,size,strat)
</code></pre>

<hr>
<h2 id='quantileknots'>Create knots at sample quantiles</h2><span id='topic+quantileknots'></span>

<h3>Description</h3>

<p><code>quantileknots</code> creates knots at sample quantiles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantileknots(x, nknots, boundstab)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quantileknots_+3A_x">x</code></td>
<td>
<p>a vector. The knots are at sample quantiles of x.</p>
</td></tr>
<tr><td><code id="quantileknots_+3A_nknots">nknots</code></td>
<td>
<p>number of knots</p>
</td></tr>
<tr><td><code id="quantileknots_+3A_boundstab">boundstab</code></td>
<td>
<p>parameter for boundary stability. The default is 0. If
boundstab = 1, then nknots+2 knots are created and the first and last are
deleted. This mitigates the extra variability of regression spline
estimates near the boundaries.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of knots at sample quantiles of x.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ODS)

x &lt;- c(1, 2, 3, 4, 5)
quantileknots(x, 3, 0)
</code></pre>

<hr>
<h2 id='se.spmle'>standard error for MSELE estimator</h2><span id='topic+se.spmle'></span>

<h3>Description</h3>

<p><code>se.spmle</code> calculates the standard error for MSELE estimator in Zhou et
al. 2002
</p>


<h3>Usage</h3>

<pre><code class='language-R'>se.spmle(y, x, beta, sig, pis, a, N.edf, rhos, strat, size.nc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="se.spmle_+3A_y">y</code></td>
<td>
<p>vector of the primary response</p>
</td></tr>
<tr><td><code id="se.spmle_+3A_x">x</code></td>
<td>
<p>the design matrix with a column of 1's for the intercept</p>
</td></tr>
<tr><td><code id="se.spmle_+3A_beta">beta</code></td>
<td>
<p>final estimates of the regression coefficients obtained from
odsmle</p>
</td></tr>
<tr><td><code id="se.spmle_+3A_sig">sig</code></td>
<td>
<p>final estimate of the error variance obtained from odsmle</p>
</td></tr>
<tr><td><code id="se.spmle_+3A_pis">pis</code></td>
<td>
<p>final estimates of the stratum probabilities obtained from odsmle</p>
</td></tr>
<tr><td><code id="se.spmle_+3A_a">a</code></td>
<td>
<p>vector of cutpoints for the primary response (e.g., a = c(-2.5,2))</p>
</td></tr>
<tr><td><code id="se.spmle_+3A_n.edf">N.edf</code></td>
<td>
<p>should be the size of the SRS (simple random sample)</p>
</td></tr>
<tr><td><code id="se.spmle_+3A_rhos">rhos</code></td>
<td>
<p>which is size/pis, where size is a vector representing the
stratum sizes of supplemental samples. e.g. size = c(100, 0, 100), and pis
are the final estimates obtained from odsmle.</p>
</td></tr>
<tr><td><code id="se.spmle_+3A_strat">strat</code></td>
<td>
<p>vector that indicates the stratum numbers of supplemental
samples, except that you should only list stratum with size &gt; 0. (e.g. if
the supplemental size is c(100, 0, 100), then the strat vector should be
c(1,3))</p>
</td></tr>
<tr><td><code id="se.spmle_+3A_size.nc">size.nc</code></td>
<td>
<p>total size of the validation sample (SRS plus supplemental
samples)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list which contains the standard error estimates for betas in the
model : </p>
<p style="text-align: center;"><code class="reqn">Y=\beta_{0}+\beta_{1}X+\epsilon,</code>
</p>
<p> where epsilon has variance sig.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ODS)
# take the example data from the ODS package
# please see the documentation for details about the data set ods_data

Y &lt;- ods_data[,1]
X &lt;- cbind(rep(1,length(Y)), ods_data[,2:5])

# use the simple random sample to get an initial estimate of beta, sig #
# perform an ordinary least squares #
SRS &lt;- ods_data[1:200,]
OLS.srs &lt;- lm(SRS[,1] ~ SRS[,2:5])
OLS.srs.summary &lt;- summary(OLS.srs)

beta &lt;- coefficients(OLS.srs)
sig &lt;- OLS.srs.summary$sigma^2
pis &lt;- c(0.1,0.8,0.1)

# the cut points for this data is Y &lt; 0.162, Y &gt; 2.59.
a &lt;- c(0.162,2.59)
rs.size &lt;- 200
size &lt;- c(100,0,100)
strat &lt;- c(1,2,3)

# obtain the parameter estimates
ODS.model = odsmle(Y,X,beta,sig,pis,a,rs.size,size,strat)

# calculate the standard error estimate
y &lt;- Y
x &lt;- X
beta &lt;- ODS.model$beta
sig &lt;- ODS.model$sig
pis &lt;- ODS.model$pis
a &lt;- c(0.162,2.59)
N.edf &lt;- rs.size
rhos &lt;- size/pis
strat &lt;- c(1,3)
size.nc &lt;- length(y)

se = se.spmle(y, x, beta, sig, pis, a, N.edf, rhos, strat, size.nc)

# summarize the result
ODS.tvalue &lt;- ODS.model$beta / se
ODS.pvalue &lt;- 2 * pt( - abs(ODS.tvalue), sum(rs.size, size)-2)

ODS.results &lt;- cbind(ODS.model$beta, se, ODS.tvalue, ODS.pvalue)
dimnames(ODS.results)[[2]] &lt;- c("Beta","SEbeta","tvalue","Pr(&gt;|t|)")
row.names(ODS.results) &lt;- c("(Intercept)","X","Z1","Z2","Z3")

ODS.results
</code></pre>

<hr>
<h2 id='secondary_casecohort'>Secondary analysis in case-cohort data</h2><span id='topic+secondary_casecohort'></span>

<h3>Description</h3>

<p><code>secondary_casecohort</code> performs the secondary analysis which describes
the association between a continuous secondary outcome and the expensive
exposure for case-cohort data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>secondary_casecohort(SRS, CCH, NVsample, Z1.dim, Z2.dim, Z3.dim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="secondary_casecohort_+3A_srs">SRS</code></td>
<td>
<p>A data frame for subjects in the simple random sample. The first
column is T: observation time for time-to-event outcome. The second column
is Delta: the event indicator. The thid column is Y2: the continuous scale
secondary outcome. The fourth column is X: the expensive exposure. Starting
from the fifth column to the end are Z1, Z2 and Z3. Z1 is the set of
covariates that are included in the linear regression model of the
secondary outcome. Z2 is the set of covariates that are included in the Cox
model (the proportional hazards model which relates the primary failure
time to covariates). Z3 is the set of covariates that are related to the
conditional distribution of X given other covariates.</p>
</td></tr>
<tr><td><code id="secondary_casecohort_+3A_cch">CCH</code></td>
<td>
<p>A data frame for subjects in the case-cohort sample. The
case-cohort sample includes the simple random sample (SRS) and the
supplemental cases. The data structure is the same as SRS.</p>
</td></tr>
<tr><td><code id="secondary_casecohort_+3A_nvsample">NVsample</code></td>
<td>
<p>A data frame for subjects in the non-validation sample.
Subjects in the non-validation sample don't have the expensive exposure X
measured. The data structure is the following: The first column is T. The
second column is Delta. The thid column is Y2. Starting from the fourth
column to the end are Z1, Z2 and Z3.</p>
</td></tr>
<tr><td><code id="secondary_casecohort_+3A_z1.dim">Z1.dim</code></td>
<td>
<p>Dimension of Z1.</p>
</td></tr>
<tr><td><code id="secondary_casecohort_+3A_z2.dim">Z2.dim</code></td>
<td>
<p>Dimension of Z2.</p>
</td></tr>
<tr><td><code id="secondary_casecohort_+3A_z3.dim">Z3.dim</code></td>
<td>
<p>Dimension of Z3. Note here that the algorithm requires Z3 to be
discrete and not high-dimensional, because we use the SRS sample to
estimate the conditional distribution of X given other covariates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list which contains parameter estimates, estimated standard error
for the primary outcome model: </p>
<p style="text-align: center;"><code class="reqn">\lambda
  (t)=\lambda_{0}(t)\exp{\gamma_{1}Y_{2}+\gamma_{2}X+\gamma_{3}Z2},</code>
</p>

<p>and the secondary outcome model:
</p>
<p style="text-align: center;"><code class="reqn">Y_{2}=\beta_{0}+\beta_{1}X+\beta_{2}Z_{1}.</code>
</p>
<p> The list contains the following components:
</p>
<table>
<tr><td><code>gamma_paramEst</code></td>
<td>
<p>parameter estimates for gamma in the primary outcome
model</p>
</td></tr> <tr><td><code>gamma_stdErr</code></td>
<td>
<p>estimated standard error for gamma in the
primary outcome model</p>
</td></tr> <tr><td><code>beta_paramEst</code></td>
<td>
<p>parameter estimates for beta in
the secondary outcome model</p>
</td></tr> <tr><td><code>beta_stdErr</code></td>
<td>
<p>estimated standard error
for beta in the secondary outcome model</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
library(ODS)
# take the example data from the ODS package
# please see the documentation for details about the data set casecohort_data_secondary
data &lt;- casecohort_data_secondary

# obtain SRS, CCH and NVsample from the original cohort data based on subj_ind
SRS &lt;- data[data[,1]==1, 2:ncol(data)]
CCH &lt;- data[data[,1]==1 | data[,1]==2, 2:ncol(data)]
NVsample &lt;- data[data[,1]==0, 2:ncol(data)]

# delete the fourth column (columns for X) from the non-validation sample
NVsample &lt;- NVsample[,-4]

Z1.dim &lt;- 4
Z2.dim &lt;- 3
Z3.dim &lt;- 3
secondary_casecohort(SRS, CCH, NVsample, Z1.dim, Z2.dim, Z3.dim)

</code></pre>

<hr>
<h2 id='secondary_ODS'>Secondary analysis in ODS design</h2><span id='topic+secondary_ODS'></span>

<h3>Description</h3>

<p><code>secondary_ODS</code> performs the secondary analysis which describes the
association between a continuous scale secondary outcome and the expensive
exposure for data obtained with ODS (outcome dependent sampling) design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>secondary_ODS(SRS, lowerODS, upperODS, NVsample, cutpoint, Z.dim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="secondary_ODS_+3A_srs">SRS</code></td>
<td>
<p>A data matrix for subjects in the simple random sample. The first
column is Y1: the primary outcome for which the ODS scheme is based on. The
second column is Y2: a secondary outcome. The third column is X: the
expensive exposure. Starting from the fourth column to the end is Z: other
covariates.</p>
</td></tr>
<tr><td><code id="secondary_ODS_+3A_lowerods">lowerODS</code></td>
<td>
<p>A data matrix for supplemental samples taken from the lower
tail of Y1 (eg. Y1 &lt; a). The data structure is the same as SRS.</p>
</td></tr>
<tr><td><code id="secondary_ODS_+3A_upperods">upperODS</code></td>
<td>
<p>A data matrix for supplemental samples taken from the upper
tail of Y1 (eg. Y1 &gt; b). The data structure is the same as SRS.</p>
</td></tr>
<tr><td><code id="secondary_ODS_+3A_nvsample">NVsample</code></td>
<td>
<p>A data matrix for subjects in the non-validation sample.
Subjects in the non-validation sample don't have the expensive exposure X
measured. The data structure is the same as SRS, but the third column
(which represents X) has values NA.</p>
</td></tr>
<tr><td><code id="secondary_ODS_+3A_cutpoint">cutpoint</code></td>
<td>
<p>A vector of length two that represents the cut off points for
the ODS design. eg. cutpoint &lt;- c(a,b). In the ODS design, a simple random
sample is taken from the full cohort, then two supplemental samples are
taken from {Y1 &lt; a} and {Y1 &gt; b}, respectively.</p>
</td></tr>
<tr><td><code id="secondary_ODS_+3A_z.dim">Z.dim</code></td>
<td>
<p>Dimension of the covariates Z.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list which contains parameter estimates, estimated standard error
for the primary outcome model:
</p>
<p style="text-align: center;"><code class="reqn">Y_{1}=\beta_{0}+\beta_{1}X+\beta_{2}Z,</code>
</p>

<p>and the secondary outcome model:
</p>
<p style="text-align: center;"><code class="reqn">Y_{2}=\gamma_{0}+\gamma_{1}X+\gamma_{2}Z.</code>
</p>

<p>The list contains the following components: </p>
<table>
<tr><td><code>beta_paramEst</code></td>
<td>
<p>parameter estimates
for beta in the primary outcome model</p>
</td></tr> <tr><td><code>beta_stdErr</code></td>
<td>
<p>estimated
standard error for beta in the primary outcome model</p>
</td></tr>
<tr><td><code>gamma_paramEst</code></td>
<td>
<p>parameter estimates for gamma in the secondary
outcome model</p>
</td></tr> <tr><td><code>gamma_stdErr</code></td>
<td>
<p>estimated standard error for gamma in
the secondary outcome model</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(ODS)
# take the example data from the ODS package
# please see the documentation for details about the data set ods_data_secondary
data &lt;- ods_data_secondary

# divide the original cohort data into SRS, lowerODS, upperODS and NVsample
SRS &lt;- data[data[,1]==1,2:ncol(data)]
lowerODS &lt;- data[data[,1]==2,2:ncol(data)]
upperODS &lt;- data[data[,1]==3,2:ncol(data)]
NVsample &lt;- data[data[,1]==0,2:ncol(data)]

# obtain the cut off points for ODS design. For this data, the ODS design
# uses mean plus and minus one standard deviation of Y1 as cut off points.
meanY1 &lt;- mean(data[,2])
sdY1 &lt;- sd(data[,2])
cutpoint &lt;- c(meanY1-sdY1, meanY1+sdY1)

# the data matrix SRS has Y1, Y2, X and Z. Hence the dimension of Z is ncol(SRS)-3.
Z.dim &lt;- ncol(SRS)-3

secondary_ODS(SRS, lowerODS, upperODS, NVsample, cutpoint, Z.dim)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
