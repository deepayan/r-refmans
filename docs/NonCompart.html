<!DOCTYPE html><html><head><title>Help for package NonCompart</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NonCompart}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AUC'><p>Calculate Area Under the Curve (AUC) and Area Under the first Moment Curve (AUMC) in a table format</p></a></li>
<li><a href='#BestSlope'><p>Choose the best-fit slope for the log(y) and x regression by the criteria of adjusted R-square.</p></a></li>
<li><a href='#DetSlope'><p>Determine slope for the log(y) and x regression manually</p></a></li>
<li><a href='#gAUC'><p>General Area Under the Curve</p></a></li>
<li><a href='#gIntAUC'><p>Calculate interval AUC of general form</p></a></li>
<li><a href='#gInterpol'><p>Interpolate y value for general y value not for concentration</p></a></li>
<li><a href='#IntAUC'><p>Calculate interval AUC</p></a></li>
<li><a href='#Interpol'><p>Interpolate y value</p></a></li>
<li><a href='#LinAUC'><p>Area Under the Curve(AUC) and Area Under the first Moment Curve(AUMC) by linear trapezoidal method</p></a></li>
<li><a href='#LogAUC'><p>Area Under the Curve(AUC) and Area Under the first Moment Curve(AUMC) by linear-up log-down method</p></a></li>
<li><a href='#NonCompart-package'><p>Noncompartmental Analysis for Pharmacokinetic Data</p></a></li>
<li><a href='#Slope'><p>Get the Slope of regression log(y) ~ x</p></a></li>
<li><a href='#sNCA'><p>Simplest NCA</p></a></li>
<li><a href='#tblAUC'><p>Table output of gAUCs</p></a></li>
<li><a href='#tblNCA'><p>Table output NCA</p></a></li>
<li><a href='#Unit'>
<p>Display CDISC standard units and multiplied factor of NCA results</p></a></li>
<li><a href='#UnitUrine'>
<p>Retuns a conversion factor for the amount calculation from urine concentration and volume</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.7.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-15</td>
</tr>
<tr>
<td>Title:</td>
<td>Noncompartmental Analysis for Pharmacokinetic Data</td>
</tr>
<tr>
<td>Description:</td>
<td>Conduct a noncompartmental analysis with industrial strength.
             Some features are
             1) Use of CDISC SDTM terms
             2) Automatic or manual slope selection
             3) Supporting both 'linear-up linear-down' and 'linear-up log-down' method
             4) Interval(partial) AUCs with 'linear' or 'log' interpolation method
             * Reference: Gabrielsson J, Weiner D. Pharmacokinetic and Pharmacodynamic Data Analysis - Concepts and Applications. 5th ed. 2016. (ISBN:9198299107).</td>
</tr>
<tr>
<td>Author:</td>
<td>Kyun-Seop Bae [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kyun-Seop Bae &lt;k@acr.kr&gt;</td>
</tr>
<tr>
<td>Copyright:</td>
<td>2016-, Kyun-Seop Bae</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://cran.r-project.org/package=NonCompart">https://cran.r-project.org/package=NonCompart</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-15 02:44:47 UTC; Kyun-SeopBae</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-15 05:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AUC'>Calculate Area Under the Curve (AUC) and Area Under the first Moment Curve (AUMC) in a table format</h2><span id='topic+AUC'></span>

<h3>Description</h3>

<p>Calculate Area Under the Curve(AUC) and the first Moment Curve(AUMC) in two ways; 'linear trapezoidal method' or 'linear-up and log-down' method.
Return a table of cumulative values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AUC(x, y, down = "Linear")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AUC_+3A_x">x</code></td>
<td>
<p>vector values of independent variable, usually time</p>
</td></tr>
<tr><td><code id="AUC_+3A_y">y</code></td>
<td>
<p>vector values of dependent variable, usually concentration</p>
</td></tr>
<tr><td><code id="AUC_+3A_down">down</code></td>
<td>
<p>either of <code>"Linear"</code> or <code>"Log"</code> to indicate the way to calculate AUC and AUMC</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>down="Linear"</code> means linear trapezoidal rule with linear interpolation.
<code>down="Log"</code> means linear-up and log-down method.
</p>


<h3>Value</h3>

<p>Table with two columns, <code>AUC</code> and <code>AUMC</code>; the first column values are cumulative AUCs and the second column values cumulative AUMCs.
</p>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>References</h3>

<p>Rowland M, Tozer TN. Clinical Pharmacokinetics and Pharmacodynamics - Concepts and Applications. 4th ed. pp687-689. 2011.</p>


<h3>See Also</h3>

<p><code><a href="#topic+LinAUC">LinAUC</a></code>, <code><a href="#topic+LogAUC">LogAUC</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>AUC(Theoph[Theoph$Subject==1, "Time"], Theoph[Theoph$Subject==1, "conc"])
AUC(Theoph[Theoph$Subject==1, "Time"], Theoph[Theoph$Subject==1, "conc"], down="Log")
</code></pre>

<hr>
<h2 id='BestSlope'>Choose the best-fit slope for the log(y) and x regression by the criteria of adjusted R-square.</h2><span id='topic+BestSlope'></span>

<h3>Description</h3>

<p>It sequentially fits (log(y) ~ x) from the last point of x to the previous points with at least 3 points.
It chooses a slope the highest adjusted R-square.
If the difference is less then 1e-4, it pickes longer slope.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  BestSlope(x, y, adm = "Extravascular", TOL=1e-4, excludeDelta = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BestSlope_+3A_x">x</code></td>
<td>
<p>vector values of x-axis, usually time</p>
</td></tr>
<tr><td><code id="BestSlope_+3A_y">y</code></td>
<td>
<p>vector values of y-axis, usually concentration</p>
</td></tr>
<tr><td><code id="BestSlope_+3A_adm">adm</code></td>
<td>
<p>one of <code>"Bolus"</code> or <code>"Infusion"</code> or <code>"Extravascular"</code> to indicate drug administration mode</p>
</td></tr>
<tr><td><code id="BestSlope_+3A_tol">TOL</code></td>
<td>
<p>tolerance. See Phoneix WinNonlin 6.4 User's Guide p33 for the detail.</p>
</td></tr>
<tr><td><code id="BestSlope_+3A_excludedelta">excludeDelta</code></td>
<td>
<p>Improvement of R2ADJ larger than this value could exclude the last point. Default value 1 is for the compatibility with other software.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Choosing the best terminal slope (y in log scale) in pharmacokinetic analysis is somewhat challenging, and it could vary by analysis performer.
Pheonix WinNonlin chooses a slope with highest adjusted R-squared and the longest one. The difference of adjusted R-Squared less than TOL considered to be 0.  
This function uses ordinary least square method (OLS). Author recommends to use <code>excludeDelta</code> option with about 0.3.
</p>


<h3>Value</h3>

<table>
<tr><td><code>R2</code></td>
<td>
<p>R-squared</p>
</td></tr>
<tr><td><code>R2ADJ</code></td>
<td>
<p>adjusted R-squared</p>
</td></tr>
<tr><td><code>LAMZNPT</code></td>
<td>
<p>number of points used for slope</p>
</td></tr>
<tr><td><code>LAMZ</code></td>
<td>
<p>negative of the slope, lambda_z</p>
</td></tr>
<tr><td><code>b0</code></td>
<td>
<p>intercept of the regression line</p>
</td></tr>
<tr><td><code>CORRXY</code></td>
<td>
<p>correlation of log(y) and x</p>
</td></tr>
<tr><td><code>LAMZLL</code></td>
<td>
<p>earliest x for lambda_z</p>
</td></tr>
<tr><td><code>LAMZUL</code></td>
<td>
<p>last x for lambda_z</p>
</td></tr>
<tr><td><code>CLSTP</code></td>
<td>
<p>predicted y value at the last point, predicted concentration for the last time point</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+Slope">Slope</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>BestSlope(Theoph[Theoph$Subject==1, "Time"], Theoph[Theoph$Subject==1, "conc"])
BestSlope(Indometh[Indometh$Subject==1, "time"], Indometh[Indometh$Subject==1, "conc"],
          adm="Bolus")
</code></pre>

<hr>
<h2 id='DetSlope'>Determine slope for the log(y) and x regression manually</h2><span id='topic+DetSlope'></span>

<h3>Description</h3>

<p>You choose a slope for terminal half-life.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DetSlope(x, y, SubTitle="", sel.1=0, sel.2=0)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DetSlope_+3A_x">x</code></td>
<td>
<p>vector values of x-axis, usually time</p>
</td></tr>
<tr><td><code id="DetSlope_+3A_y">y</code></td>
<td>
<p>vector values of y-axis, usually concentration</p>
</td></tr>
<tr><td><code id="DetSlope_+3A_subtitle">SubTitle</code></td>
<td>
<p>subtitle to be shown on the plot</p>
</td></tr>
<tr><td><code id="DetSlope_+3A_sel.1">sel.1</code></td>
<td>
<p>default index of the first element to use</p>
</td></tr>
<tr><td><code id="DetSlope_+3A_sel.2">sel.2</code></td>
<td>
<p>default index of the last element to use</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sometimes <code>BestSlope</code> cannot find terminal slope satisfactorily. Then you can use this function to choose manually. It returns the same format result with <code>BestSlope</code> with an attribute indicating used points.
</p>


<h3>Value</h3>

<table>
<tr><td><code>R2</code></td>
<td>
<p>R-squared</p>
</td></tr>
<tr><td><code>R2ADJ</code></td>
<td>
<p>adjusted R-squared</p>
</td></tr>
<tr><td><code>LAMZNPT</code></td>
<td>
<p>number of points used for the slope</p>
</td></tr>
<tr><td><code>LAMZ</code></td>
<td>
<p>negative of the slope, lambda_z</p>
</td></tr>
<tr><td><code>b0</code></td>
<td>
<p>intercept of the regression line</p>
</td></tr>
<tr><td><code>CORRXY</code></td>
<td>
<p>correlation of log(y) and x</p>
</td></tr>
<tr><td><code>LAMZLL</code></td>
<td>
<p>earliest x for lambda_z</p>
</td></tr>
<tr><td><code>LAMZUL</code></td>
<td>
<p>last x for lambda_z</p>
</td></tr>
<tr><td><code>CLSTP</code></td>
<td>
<p>predicted y value at the last point, predicted concentration for the last time point</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+Slope">Slope</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>DetSlope(Theoph[Theoph$Subject==1, "Time"], Theoph[Theoph$Subject==1, "conc"])
DetSlope(Indometh[Indometh$Subject==2, "time"], Indometh[Indometh$Subject==2, "conc"])
</code></pre>

<hr>
<h2 id='gAUC'>General Area Under the Curve</h2><span id='topic+gAUC'></span>

<h3>Description</h3>

<p>General AUC function for Emax, TEmax and AUCs</p>


<h3>Usage</h3>

<pre><code class='language-R'>gAUC(x, y, Ymax = "Emax", XofYmax = "TEmax", AUCname = "AUEClast", iAUC = "", 
     Outer = "NEAREST")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gAUC_+3A_x">x</code></td>
<td>
<p>usually time</p>
</td></tr>
<tr><td><code id="gAUC_+3A_y">y</code></td>
<td>
<p>usually concentration or effect. This can be negative/</p>
</td></tr>
<tr><td><code id="gAUC_+3A_ymax">Ymax</code></td>
<td>
<p>usually Cmax or Emax</p>
</td></tr>
<tr><td><code id="gAUC_+3A_xofymax">XofYmax</code></td>
<td>
<p>usually Tmax or TEmax</p>
</td></tr>
<tr><td><code id="gAUC_+3A_aucname">AUCname</code></td>
<td>
<p>usually AUClast or AUEClast</p>
</td></tr>
<tr><td><code id="gAUC_+3A_iauc">iAUC</code></td>
<td>
<p>a data.frame to calculate interval AUCs</p>
</td></tr>
<tr><td><code id="gAUC_+3A_outer">Outer</code></td>
<td>
<p>indicates how to do the out of x range point</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a general purpose AUC function. It calculates only Cmax(Emax), Tmax(TEmax) and AUCs(AUECs). This can be used for effect(pharmacodynamic) data which has negative values. For concentration data, use <code>IntAUC</code>.
</p>


<h3>Value</h3>

<p>Column names can vary according to the options.  
</p>
<table>
<tr><td><code>Emax</code></td>
<td>
<p>maximum y value</p>
</td></tr>
<tr><td><code>TEmax</code></td>
<td>
<p>x value at the maximum y value</p>
</td></tr>
<tr><td><code>AUEClast</code></td>
<td>
<p>Area under the y versus x curve</p>
</td></tr>
<tr><td><code>iAUCs</code></td>
<td>
<p>Columns from iAUC input</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'># For one subject
x = Theoph[Theoph$Subject=="1", "Time"]
y = Theoph[Theoph$Subject=="1", "conc"]
gAUC(x, y)

iAUC = data.frame(Name=c("AUC[0-12h]","AUC[0-24h]"), Start=c(0,0), End=c(12,24))
gAUC(x, y, iAUC=iAUC)
</code></pre>

<hr>
<h2 id='gIntAUC'>Calculate interval AUC of general form</h2><span id='topic+gIntAUC'></span>

<h3>Description</h3>

<p>It calculates interval AUC of general form. This is useful for pharmacodynamic data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>gIntAUC(x, y, t1, t2, Outer = "NEAREST")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gIntAUC_+3A_x">x</code></td>
<td>
<p>vector values of independent variable, usually time</p>
</td></tr>
<tr><td><code id="gIntAUC_+3A_y">y</code></td>
<td>
<p>vector values of dependent variable, usually concentration</p>
</td></tr>
<tr><td><code id="gIntAUC_+3A_t1">t1</code></td>
<td>
<p>start time for AUC</p>
</td></tr>
<tr><td><code id="gIntAUC_+3A_t2">t2</code></td>
<td>
<p>end time for AUC</p>
</td></tr>
<tr><td><code id="gIntAUC_+3A_outer">Outer</code></td>
<td>
<p>indicates how to do the out of x range point</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This calculates an interval (partial) AUC (from t1 to t2) with the given series of x and y.
If t1 and/or t2 cannot be found within x vector, it interpolates.
If t1 and/or t2 are out of x range, it uses the nearest value.
For concentration data, use <code>IntAUC</code>.
</p>


<h3>Value</h3>

<p>return interval AUC value (scalar)</p>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+gAUC">gAUC</a></code>, <code><a href="#topic+gInterpol">gInterpol</a></code>, <code><a href="#topic+tblAUC">tblAUC</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>gIntAUC(Theoph[Theoph$Subject==1, "Time"], Theoph[Theoph$Subject==1, "conc"], t1=0.5, t2=11)
</code></pre>

<hr>
<h2 id='gInterpol'>Interpolate y value for general y value not for concentration</h2><span id='topic+gInterpol'></span>

<h3>Description</h3>

<p>It interpolates y value when a corresponding x value (xnew) does not exist within x vector</p>


<h3>Usage</h3>

<pre><code class='language-R'>gInterpol(x, y, xnew, Outer="NEAREST")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gInterpol_+3A_x">x</code></td>
<td>
<p>vector values of x-axis, usually time</p>
</td></tr>
<tr><td><code id="gInterpol_+3A_y">y</code></td>
<td>
<p>vector values of y-axis, usually concentration</p>
</td></tr>
<tr><td><code id="gInterpol_+3A_xnew">xnew</code></td>
<td>
<p>new x point to be interpolated, usually new time point</p>
</td></tr>
<tr><td><code id="gInterpol_+3A_outer">Outer</code></td>
<td>
<p>indicates how to do the out of x range point</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function interpolate y value, if xnew is not in x vector.
If xnew is in the x vector, it just returns the given x and y vector.
This function usually is called by <code>gIntAUC</code> function
Returned vector is sorted in the order of increasing x values.
</p>


<h3>Value</h3>

<p>new x and y vector containing xnew and ynew point</p>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+gIntAUC">gIntAUC</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>x = 1:10 + 0.1
y = -2*x + 40.2
gInterpol(x, y, 1.5)
gInterpol(x, y, 0.5) # Out of range, Left
gInterpol(x, y, 11) # Out of range, Left
</code></pre>

<hr>
<h2 id='IntAUC'>Calculate interval AUC</h2><span id='topic+IntAUC'></span>

<h3>Description</h3>

<p>It calculates interval AUC</p>


<h3>Usage</h3>

<pre><code class='language-R'>IntAUC(x, y, t1, t2, Res, down = "Linear")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IntAUC_+3A_x">x</code></td>
<td>
<p>vector values of independent variable, usually time</p>
</td></tr>
<tr><td><code id="IntAUC_+3A_y">y</code></td>
<td>
<p>vector values of dependent variable, usually concentration</p>
</td></tr>
<tr><td><code id="IntAUC_+3A_t1">t1</code></td>
<td>
<p>start time for AUC</p>
</td></tr>
<tr><td><code id="IntAUC_+3A_t2">t2</code></td>
<td>
<p>end time for AUC</p>
</td></tr>
<tr><td><code id="IntAUC_+3A_res">Res</code></td>
<td>
<p>result from <code>sNCA</code> function</p>
</td></tr>
<tr><td><code id="IntAUC_+3A_down">down</code></td>
<td>
<p>either of <code>"Linear"</code> or <code>"Log"</code> to indicate the way to calculate AUC</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This calculates an interval (partial) AUC (from t1 to t2) with the given series of x and y.
If t1 and/or t2 cannot be found within x vector, it interpolates according to the <code>down</code> option.
</p>


<h3>Value</h3>

<p>return interval AUC value (scalar)</p>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>References</h3>


<ol>
<li><p> Gabrielsson J, Weiner D. Pharmacokinetic and Pharmacodynamic Data Analysis - Concepts and Applications. 5th ed. 2016.
</p>
</li>
<li><p> Shargel L, Yu A. Applied Biopharmaceutics and Pharmacokinetics. 7th ed. 2015. 
</p>
</li>
<li><p> Rowland M, Tozer TN. Clinical Pharmacokinetics and Pharmacodynamics - Concepts and Applications. 4th ed. 2011.
</p>
</li>
<li><p> Gibaldi M, Perrier D. Pharmacokinetics. 2nd ed. revised and expanded. 1982.
</p>
</li></ol>



<h3>See Also</h3>

<p><code><a href="#topic+AUC">AUC</a></code>, <code><a href="#topic+Interpol">Interpol</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>Res = sNCA(Theoph[Theoph$Subject==1,"Time"], Theoph[Theoph$Subject==1, "conc"], 
           dose=320, concUnit="mg/L")
IntAUC(Theoph[Theoph$Subject==1, "Time"], Theoph[Theoph$Subject==1, "conc"], t1=0.5, t2=11, Res)
</code></pre>

<hr>
<h2 id='Interpol'>Interpolate y value</h2><span id='topic+Interpol'></span>

<h3>Description</h3>

<p>It interpolates y value when a corresponding x value (xnew) does not exist within x vector</p>


<h3>Usage</h3>

<pre><code class='language-R'>Interpol(x, y, xnew, Slope, b0, down = "Linear")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Interpol_+3A_x">x</code></td>
<td>
<p>vector values of x-axis, usually time</p>
</td></tr>
<tr><td><code id="Interpol_+3A_y">y</code></td>
<td>
<p>vector values of y-axis, usually concentration</p>
</td></tr>
<tr><td><code id="Interpol_+3A_xnew">xnew</code></td>
<td>
<p>new x point to be interpolated, usually new time point</p>
</td></tr>
<tr><td><code id="Interpol_+3A_slope">Slope</code></td>
<td>
<p>slope of regression log(y) ~ x</p>
</td></tr>
<tr><td><code id="Interpol_+3A_b0">b0</code></td>
<td>
<p>y value of just left point of xnew</p>
</td></tr>
<tr><td><code id="Interpol_+3A_down">down</code></td>
<td>
<p>either of <code>"Linear"</code> or <code>"Log"</code> to indicate the way to interpolate</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function interpolate y value, if xnew is not in x vector.
If xnew is in x vector, it just returns the given x and y vector.
This function usually is called by <code>IntAUC</code> function
Returned vector is sorted in the order of increasing x values.
</p>


<h3>Value</h3>

<p>new x and y vector containing xnew and ynew point</p>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+IntAUC">IntAUC</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>x = 10:1 + 0.1
y = -2*x + 40.2
Interpol(x, y, 1.5)
Interpol(x, y, 1.5, down="Log")
</code></pre>

<hr>
<h2 id='LinAUC'>Area Under the Curve(AUC) and Area Under the first Moment Curve(AUMC) by linear trapezoidal method</h2><span id='topic+LinAUC'></span>

<h3>Description</h3>

<p>It calculates AUC and AUMC using the linear trapezoidal method</p>


<h3>Usage</h3>

<pre><code class='language-R'>LinAUC(x, y)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LinAUC_+3A_x">x</code></td>
<td>
<p>vector values of the independent variable, usually time</p>
</td></tr>
<tr><td><code id="LinAUC_+3A_y">y</code></td>
<td>
<p>vector values of the dependent variable, usually concentration</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns AUC and AUMC by the linear trapezoidal method.
</p>


<h3>Value</h3>

<table>
<tr><td><code>AUC</code></td>
<td>
<p>area under the curve</p>
</td></tr>
<tr><td><code>AUMC</code></td>
<td>
<p>area under the first moment curve</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>References</h3>


<ol>
<li><p> Gabrielsson J, Weiner D. Pharmacokinetic and Pharmacodynamic Data Analysis - Concepts and Applications. 5th ed. 2016.
</p>
</li>
<li><p> Shargel L, Yu A. Applied Biopharmaceutics and Pharmacokinetics. 7th ed. 2015. 
</p>
</li>
<li><p> Rowland M, Tozer TN. Clinical Pharmacokinetics and Pharmacodynamics - Concepts and Applications. 4th ed. 2011.
</p>
</li>
<li><p> Gibaldi M, Perrier D. Pharmacokinetics. 2nd ed. revised and expanded. 1982.
</p>
</li></ol>



<h3>See Also</h3>

<p><code><a href="#topic+LogAUC">LogAUC</a></code>, <code><a href="#topic+AUC">AUC</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>LinAUC(Theoph[Theoph$Subject==1, "Time"], Theoph[Theoph$Subject==1, "conc"])
AUC(Theoph[Theoph$Subject==1, "Time"], Theoph[Theoph$Subject==1, "conc"]) # compare the last line
</code></pre>

<hr>
<h2 id='LogAUC'>Area Under the Curve(AUC) and Area Under the first Moment Curve(AUMC) by linear-up log-down method</h2><span id='topic+LogAUC'></span>

<h3>Description</h3>

<p>It calculates AUC and AUMC using the linear-up log-down method</p>


<h3>Usage</h3>

<pre><code class='language-R'>LogAUC(x, y)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LogAUC_+3A_x">x</code></td>
<td>
<p>vector values of the independent variable, usually time</p>
</td></tr>
<tr><td><code id="LogAUC_+3A_y">y</code></td>
<td>
<p>vector values of the dependent variable, usually concentration</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns AUC and AUMC by the linear-up log-down method.
</p>


<h3>Value</h3>

<table>
<tr><td><code>AUC</code></td>
<td>
<p>area under the curve</p>
</td></tr>
<tr><td><code>AUMC</code></td>
<td>
<p>area under the first moment curve</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>References</h3>


<ol>
<li><p> Gabrielsson J, Weiner D. Pharmacokinetic and Pharmacodynamic Data Analysis - Concepts and Applications. 5th ed. 2016.
</p>
</li>
<li><p> Shargel L, Yu A. Applied Biopharmaceutics and Pharmacokinetics. 7th ed. 2015. 
</p>
</li>
<li><p> Rowland M, Tozer TN. Clinical Pharmacokinetics and Pharmacodynamics - Concepts and Applications. 4th ed. 2011.
</p>
</li>
<li><p> Gibaldi M, Perrier D. Pharmacokinetics. 2nd ed. revised and expanded. 1982.
</p>
</li></ol>



<h3>See Also</h3>

<p><code><a href="#topic+LinAUC">LinAUC</a></code>,<code><a href="#topic+AUC">AUC</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>LogAUC(Theoph[Theoph$Subject==1, "Time"], Theoph[Theoph$Subject==1, "conc"])
# Compare the last line with the above
AUC(Theoph[Theoph$Subject==1, "Time"], Theoph[Theoph$Subject==1, "conc"], down="Log") 
</code></pre>

<hr>
<h2 id='NonCompart-package'>Noncompartmental Analysis for Pharmacokinetic Data</h2><span id='topic+NonCompart-package'></span><span id='topic+NonCompart'></span>

<h3>Description</h3>

<p>It conducts a noncompartmental analysis(NCA) with industrial strength.
</p>


<h3>Details</h3>

<p>The main functions are
</p>
<pre>
tblNCA   to perform NCA for many subjects.

sNCA     to perform NCA for one subject.
</pre>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>References</h3>


<ol>
<li><p> Gabrielsson J, Weiner D. Pharmacokinetic and Pharmacodynamic Data Analysis - Concepts and Applications. 5th ed. 2016.
</p>
</li>
<li><p> Shargel L, Yu A. Applied Biopharmaceutics and Pharmacokinetics. 7th ed. 2015. 
</p>
</li>
<li><p> Rowland M, Tozer TN. Clinical Pharmacokinetics and Pharmacodynamics - Concepts and Applications. 4th ed. 2011.
</p>
</li>
<li><p> Gibaldi M, Perrier D. Pharmacokinetics. 2nd ed. revised and expanded. 1982.
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'># Theoph and Indometh data: dose in mg, conc in mg/L, time in h
tblNCA(Theoph, key="Subject", colTime="Time", colConc="conc", dose=320,
       adm="Extravascular", doseUnit="mg", concUnit="mg/L")

tblNCA(Indometh, key="Subject", colTime="time", colConc="conc", dose=25, 
       adm="Infusion", dur=0.5, doseUnit="mg", concUnit="mg/L", R2ADJ=0.9)

# For individual NCA
iAUC = data.frame(Name=c("AUC[0-12h]","AUC[0-24h]"), Start=c(0,0), End=c(12,24)) ; iAUC

x = Theoph[Theoph$Subject=="1","Time"]
y = Theoph[Theoph$Subject=="1","conc"]

sNCA(x, y, dose=320, doseUnit="mg", concUnit="mg/L", timeUnit="h", iAUC=iAUC)
sNCA(x, y, dose=320, concUnit="mg/L", iAUC=iAUC)
</code></pre>

<hr>
<h2 id='Slope'>Get the Slope of regression log(y) ~ x</h2><span id='topic+Slope'></span>

<h3>Description</h3>

<p>It calculates the slope with linear regression of log(y) ~ x
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Slope(x, y)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Slope_+3A_x">x</code></td>
<td>
<p>vector values of the independent variable, usually time</p>
</td></tr>
<tr><td><code id="Slope_+3A_y">y</code></td>
<td>
<p>vector values of the dependent variable, usually concentration</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With time-concentration curve, you frequently need to estimate slope in log(concentration) ~ time.
This function is usually called by <code>BestSlope</code> function, and you seldom need to call this function directly.
</p>


<h3>Value</h3>

<table>
<tr><td><code>R2</code></td>
<td>
<p>R-squared</p>
</td></tr>
<tr><td><code>R2ADJ</code></td>
<td>
<p>adjusted R-squared</p>
</td></tr>
<tr><td><code>LAMZNPT</code></td>
<td>
<p>number of points used for slope</p>
</td></tr>
<tr><td><code>LAMZ</code></td>
<td>
<p>negative of the slope, lambda_z</p>
</td></tr>
<tr><td><code>b0</code></td>
<td>
<p>intercept of the regression line</p>
</td></tr>
<tr><td><code>CORRXY</code></td>
<td>
<p>correlation of log(y) and x</p>
</td></tr>
<tr><td><code>LAMZLL</code></td>
<td>
<p>earliest x for lambda_z</p>
</td></tr>
<tr><td><code>LAMZUL</code></td>
<td>
<p>last x for lambda_z</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+BestSlope">BestSlope</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>Slope(Indometh[Indometh$Subject==1, "time"], Indometh[Indometh$Subject==1, "conc"])
</code></pre>

<hr>
<h2 id='sNCA'>Simplest NCA</h2><span id='topic+sNCA'></span>

<h3>Description</h3>

<p>This is the work-horse function for NCA.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sNCA(x, y, dose = 0, adm = "Extravascular", dur = 0, doseUnit = "mg", timeUnit = "h", 
     concUnit = "ug/L", iAUC = "", down = "Linear", R2ADJ = 0.7, MW = 0, SS = FALSE, 
     Keystring="", excludeDelta = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sNCA_+3A_x">x</code></td>
<td>
<p>usually time</p>
</td></tr>
<tr><td><code id="sNCA_+3A_y">y</code></td>
<td>
<p>usually concentration</p>
</td></tr>
<tr><td><code id="sNCA_+3A_dose">dose</code></td>
<td>
<p>given amount, not amount per body weight</p>
</td></tr>
<tr><td><code id="sNCA_+3A_adm">adm</code></td>
<td>
<p>one of <code>"Bolus"</code> or <code>"Infusion"</code> or <code>"Extravascular"</code> to indicate drug administration mode</p>
</td></tr>
<tr><td><code id="sNCA_+3A_dur">dur</code></td>
<td>
<p>duration of infusion</p>
</td></tr>
<tr><td><code id="sNCA_+3A_doseunit">doseUnit</code></td>
<td>
<p>unit of dose</p>
</td></tr>
<tr><td><code id="sNCA_+3A_timeunit">timeUnit</code></td>
<td>
<p>unit of time</p>
</td></tr>
<tr><td><code id="sNCA_+3A_concunit">concUnit</code></td>
<td>
<p>unit of concentration</p>
</td></tr>
<tr><td><code id="sNCA_+3A_iauc">iAUC</code></td>
<td>
<p>interval AUCs to calculate</p>
</td></tr>
<tr><td><code id="sNCA_+3A_down">down</code></td>
<td>
<p>either of <code>"Linear"</code> or <code>"Log"</code> to indicate the way to calculate AUC and AUMC</p>
</td></tr>
<tr><td><code id="sNCA_+3A_r2adj">R2ADJ</code></td>
<td>
<p>Minimum adjusted R-square value to determine terminal slope automatically</p>
</td></tr>
<tr><td><code id="sNCA_+3A_mw">MW</code></td>
<td>
<p>molecular weight of the drug</p>
</td></tr>
<tr><td><code id="sNCA_+3A_ss">SS</code></td>
<td>
<p>if steady-state, this should be TRUE. AUCLST (AUClast) is used instead of AUCIFO (AUCinf) for the calculation of Vz (VZFO, VZO), CL (CLFO, CLO), and Vdss (VSSO).</p>
</td></tr>
<tr><td><code id="sNCA_+3A_keystring">Keystring</code></td>
<td>
<p>a text string to be shown at the plot in case of manual selection of terminal slope</p>
</td></tr>
<tr><td><code id="sNCA_+3A_excludedelta">excludeDelta</code></td>
<td>
<p>Improvement of R2ADJ larger than this value could exclude the last point. Default value 1 is for the compatibility with other software.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This replaced previous <code>IndiNCA</code>. Author recommends to use <code>excludeDelta</code> option with about 0.3.
</p>


<h3>Value</h3>

<table>
<tr><td><code>CMAX</code></td>
<td>
<p>maximum concentration, Cmax</p>
</td></tr>
<tr><td><code>CMAXD</code></td>
<td>
<p>dose normalized Cmax, CMAX / Dose, Cmax / Dose</p>
</td></tr>
<tr><td><code>TMAX</code></td>
<td>
<p>time of maximum concentration, Tmax</p>
</td></tr>
<tr><td><code>TLAG</code></td>
<td>
<p>time to observe the first non-zero concentration, for extravascular administration only</p>
</td></tr>
<tr><td><code>CLST</code></td>
<td>
<p>last positive concentration observed, Clast</p>
</td></tr>
<tr><td><code>CLSTP</code></td>
<td>
<p>last positive concentration predicted, Clast_pred</p>
</td></tr>
<tr><td><code>TLST</code></td>
<td>
<p>time of last positive concentration, Tlast</p>
</td></tr>
<tr><td><code>LAMZHL</code></td>
<td>
<p>half-life by lambda z, ln(2)/LAMZ</p>
</td></tr>
<tr><td><code>LAMZ</code></td>
<td>
<p>lambda_z negative of the best-fit terminal slope</p>
</td></tr>
<tr><td><code>LAMZLL</code></td>
<td>
<p>earliest time for LAMZ</p>
</td></tr>
<tr><td><code>LAMZUL</code></td>
<td>
<p>last time for LAMZ</p>
</td></tr>
<tr><td><code>LAMZNPT</code></td>
<td>
<p>number of points for LAMZ</p>
</td></tr>
<tr><td><code>CORRXY</code></td>
<td>
<p>correlation of log(concentration) and time</p>
</td></tr>
<tr><td><code>R2</code></td>
<td>
<p>R-squared</p>
</td></tr>
<tr><td><code>R2ADJ</code></td>
<td>
<p>R-squared adjusted</p>
</td></tr>
<tr><td><code>C0</code></td>
<td>
<p>back extrapolated concentration at time 0, for intravascular bolus administration only</p>
</td></tr>
<tr><td><code>AUCLST</code></td>
<td>
<p>AUC from 0 to TLST</p>
</td></tr>
<tr><td><code>AUCALL</code></td>
<td>
<p>AUC using all the given points, including trailing zero concentrations</p>
</td></tr>
<tr><td><code>AUCIFO</code></td>
<td>
<p>AUC infinity observed</p>
</td></tr>
<tr><td><code>AUCIFOD</code></td>
<td>
<p>AUCIFO / Dose</p>
</td></tr>
<tr><td><code>AUCIFP</code></td>
<td>
<p>AUC infinity predicted using CLSTP instead of CLST</p>
</td></tr>
<tr><td><code>AUCIFPD</code></td>
<td>
<p>AUCIFP / Dose</p>
</td></tr>
<tr><td><code>AUCPEO</code></td>
<td>
<p>AUC % extrapolation observed</p>
</td></tr>
<tr><td><code>AUCPEP</code></td>
<td>
<p>AUC % extrapolated for AUCIFP</p>
</td></tr>
<tr><td><code>AUCPBEO</code></td>
<td>
<p>AUC % back extrapolation observed, for bolus IV administration only</p>
</td></tr>
<tr><td><code>AUCPBEP</code></td>
<td>
<p>AUC % back extrapolation predicted with AUCIFP, for bolus IV administration only</p>
</td></tr>
<tr><td><code>AUMCLST</code></td>
<td>
<p>AUMC to the TLST</p>
</td></tr>
<tr><td><code>AUMCIFO</code></td>
<td>
<p>AUMC infinity observed using CLST</p>
</td></tr>
<tr><td><code>AUMCIFP</code></td>
<td>
<p>AUMC infinity determined by CLSTP</p>
</td></tr>
<tr><td><code>AUMCPEO</code></td>
<td>
<p>AUMC % extrapolated observed</p>
</td></tr>
<tr><td><code>AUMCPEP</code></td>
<td>
<p>AUMC % extrapolated predicted</p>
</td></tr>
<tr><td><code>MRTIVLST</code></td>
<td>
<p>mean residence time (MRT) to TLST, for intravascular administration</p>
</td></tr>
<tr><td><code>MRTIVIFO</code></td>
<td>
<p>mean residence time (MRT) infinity using CLST, for intravascular administration</p>
</td></tr>
<tr><td><code>MRTIVIFP</code></td>
<td>
<p>mean residence time (MRT) infinity using CLSTP, for intravascular administration</p>
</td></tr>
<tr><td><code>MRTEVLST</code></td>
<td>
<p>mean residence time (MRT) to TLST, for extravascular administration</p>
</td></tr>
<tr><td><code>MRTEVIFO</code></td>
<td>
<p>mean residence time (MRT) infinity using CLST, for extravascular administration</p>
</td></tr>
<tr><td><code>MRTEVIFP</code></td>
<td>
<p>mean residence time (MRT) infinity using CLSTP, for extravascular administration</p>
</td></tr>
<tr><td><code>VZO</code></td>
<td>
<p>volume of distribution determined by LAMZ and AUCIFO, for intravascular administration</p>
</td></tr>
<tr><td><code>VZP</code></td>
<td>
<p>volume of distribution determined by LAMZ and AUCIFP, for intravascular administration</p>
</td></tr>
<tr><td><code>VZFO</code></td>
<td>
<p>VZO for extravascular administration, VZO/F, F is bioavailability</p>
</td></tr>
<tr><td><code>VZFP</code></td>
<td>
<p>VZP for extravascular administration, VZP/F, F is bioavailability</p>
</td></tr>
<tr><td><code>CLO</code></td>
<td>
<p>clearance using AUCIFO, for intravascular administration</p>
</td></tr>
<tr><td><code>CLP</code></td>
<td>
<p>clearance using AUCIFP, for intravascular administration</p>
</td></tr>
<tr><td><code>CLFO</code></td>
<td>
<p>CLO for extravascular administration, CLO/F, F is bioavailability</p>
</td></tr>
<tr><td><code>CLFP</code></td>
<td>
<p>CLP for extravascular administration, CLP/F, F is bioavailability</p>
</td></tr>
<tr><td><code>VSSO</code></td>
<td>
<p>volume of distribution at steady state using CLST, for intravascular administration only</p>
</td></tr>
<tr><td><code>VSSP</code></td>
<td>
<p>volume of distribution at steady state using CLSTP, for intravascular administration only</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>References</h3>

<p>Gabrielsson J, Weiner D. Pharmacokinetic and Pharmacodynamic Data Analysis - Concepts and Applications. 5th ed. 2016.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+help">help</a></code>, <code><a href="#topic+tblNCA">tblNCA</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For one subject
x = Theoph[Theoph$Subject=="1","Time"]
y = Theoph[Theoph$Subject=="1","conc"]

sNCA(x, y, dose=320, doseUnit="mg", concUnit="mg/L", timeUnit="h")
sNCA(x, y, dose=320, concUnit="mg/L")

iAUC = data.frame(Name=c("AUC[0-12h]","AUC[0-24h]"), Start=c(0,0), End=c(12,24))
sNCA(x, y, dose=320, doseUnit="mg", concUnit="mg/L", timeUnit="h", iAUC=iAUC)

MW = 180.164 # Molecular weight of theophylline

sNCA(x, y/MW, dose=320, doseUnit="mg", concUnit="mmol/L", timeUnit="h")
sNCA(x, y/MW, dose=320, doseUnit="mg", concUnit="mmol/L", timeUnit="h", MW=MW)
sNCA(x, y, dose=320/MW, doseUnit="mmol", concUnit="mg/L", timeUnit="h", MW=MW)
sNCA(x, y/MW, dose=320/MW, doseUnit="mmol", concUnit="mmol/L", timeUnit="h", MW=MW)

sNCA(x, y/MW, dose=320/MW, doseUnit="mmol", concUnit="mmol/L", timeUnit="h", MW=MW)
sNCA(x, y/MW, doseUnit="mmol", concUnit="mmol/L", timeUnit="h", MW=MW)
sNCA(x, y/MW, dose=as.numeric(NA), doseUnit="mmol", concUnit="mmol/L", timeUnit="h", 
     MW=MW)

sNCA(x, y, dose=320, concUnit="mg/L", timeUnit="hr")
sNCA(x*60, y, dose=320, concUnit="mg/L", timeUnit="min")
</code></pre>

<hr>
<h2 id='tblAUC'>Table output of gAUCs</h2><span id='topic+tblAUC'></span>

<h3>Description</h3>

<p>Do multiple AUCs and returns a result table. See <code>gNCA</code> for more detail i.e. <code>iAUC</code></p>


<h3>Usage</h3>

<pre><code class='language-R'>tblAUC(Data, key = "Subject", colX = "Time", colY = "Y", iAUC = "",
       Ymax = "Emax", XofYmax = "TEmax", AUCname = "AUEClast", Outer = "NEAREST")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tblAUC_+3A_data">Data</code></td>
<td>
<p>data table name</p>
</td></tr>
<tr><td><code id="tblAUC_+3A_key">key</code></td>
<td>
<p>column names of Data to be shown in the output table</p>
</td></tr>
<tr><td><code id="tblAUC_+3A_colx">colX</code></td>
<td>
<p>column name for x axis</p>
</td></tr>
<tr><td><code id="tblAUC_+3A_coly">colY</code></td>
<td>
<p>column name for y axis</p>
</td></tr>
<tr><td><code id="tblAUC_+3A_iauc">iAUC</code></td>
<td>
<p>a data.frame to calculate interval AUCs</p>
</td></tr>
<tr><td><code id="tblAUC_+3A_ymax">Ymax</code></td>
<td>
<p>usually Cmax or Emax</p>
</td></tr>
<tr><td><code id="tblAUC_+3A_xofymax">XofYmax</code></td>
<td>
<p>usually Tmax or TEmax</p>
</td></tr>
<tr><td><code id="tblAUC_+3A_aucname">AUCname</code></td>
<td>
<p>usually AUClast or AUEClast</p>
</td></tr>
<tr><td><code id="tblAUC_+3A_outer">Outer</code></td>
<td>
<p>indicates how to do the out of x range point</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tabular output of AUC with many subjects. This calculates only Cmax(Emax), Tmax(TEmax), AUCs
</p>


<h3>Value</h3>

<p>Basically same with <code><a href="#topic+gAUC">gAUC</a></code></p>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+help">help</a></code>, <code><a href="#topic+gAUC">gAUC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tblAUC(Theoph, key="Subject", colX="Time", colY="conc")

iAUC = data.frame(Name=c("AUC[0-12h]","AUC[0-24h]"), Start=c(0,0), End=c(12,24))
tblAUC(Indometh, key="Subject", colX="time", colY="conc", iAUC=iAUC)
</code></pre>

<hr>
<h2 id='tblNCA'>Table output NCA</h2><span id='topic+tblNCA'></span>

<h3>Description</h3>

<p>Do multiple NCA and returns a result table. See <code>sNCA</code> for more detail i.e. <code>iAUC</code></p>


<h3>Usage</h3>

<pre><code class='language-R'>tblNCA(concData, key = "Subject", colTime = "Time", colConc = "conc", dose = 0, 
       adm = "Extravascular", dur = 0, doseUnit = "mg", timeUnit = "h", 
       concUnit = "ug/L", down = "Linear", R2ADJ = 0, MW = 0, SS = FALSE, 
       iAUC = "", excludeDelta = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tblNCA_+3A_concdata">concData</code></td>
<td>
<p>concentration data table</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_key">key</code></td>
<td>
<p>column names of concData to be shown in the output table</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_coltime">colTime</code></td>
<td>
<p>column name for time</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_colconc">colConc</code></td>
<td>
<p>column name for concentration</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_dose">dose</code></td>
<td>
<p>administered dose</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_adm">adm</code></td>
<td>
<p>one of <code>"Bolus"</code> or <code>"Infusion"</code> or <code>"Extravascular"</code> to indicate drug administration mode</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_dur">dur</code></td>
<td>
<p>duration of infusion</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_doseunit">doseUnit</code></td>
<td>
<p>unit of dose</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_timeunit">timeUnit</code></td>
<td>
<p>unit of time</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_concunit">concUnit</code></td>
<td>
<p>unit of concentration</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_down">down</code></td>
<td>
<p>method to calculate AUC, <code>"Linear"</code> or <code>"Log"</code></p>
</td></tr>
<tr><td><code id="tblNCA_+3A_r2adj">R2ADJ</code></td>
<td>
<p>Lowest threshold of adjusted R-square value to do manual slope determination</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_mw">MW</code></td>
<td>
<p>molecular weight of drug</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_ss">SS</code></td>
<td>
<p>if steady-state, this should be TRUE. AUCLST (AUClast) is used instead of AUCIFO (AUCinf) for the calculation of Vz (VZFO, VZO), CL (CLFO, CLO), and Vdss (VSSO).</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_iauc">iAUC</code></td>
<td>
<p>data.frame for interval AUC</p>
</td></tr>
<tr><td><code id="tblNCA_+3A_excludedelta">excludeDelta</code></td>
<td>
<p>Improvement of R2ADJ larger than this value could exclude the last point. Default value 1 is for the compatibility with other software.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tabular output of NCA with many subjects. Author recommends to use <code>excludeDelta</code> option with about 0.3.
</p>


<h3>Value</h3>

<p>Basically same with <code><a href="#topic+sNCA">sNCA</a></code></p>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+help">help</a></code>, <code><a href="#topic+sNCA">sNCA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tblNCA(Theoph, key="Subject", dose=320, concUnit="mg/L")
tblNCA(Indometh, key="Subject", colTime="time", colConc="conc", dose=25, 
       adm="Infusion", dur=0.5, concUnit="mg/L")
</code></pre>

<hr>
<h2 id='Unit'>
Display CDISC standard units and multiplied factor of NCA results  
</h2><span id='topic+Unit'></span>

<h3>Description</h3>

<p>It displays CDISC PP output units and multiplication factor for them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Unit(code = "", timeUnit = "h", concUnit = "ng/mL", doseUnit = "mg", MW = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Unit_+3A_code">code</code></td>
<td>
<p>vector of PPTESTCD</p>
</td></tr>
<tr><td><code id="Unit_+3A_timeunit">timeUnit</code></td>
<td>
<p>unit of time</p>
</td></tr>
<tr><td><code id="Unit_+3A_concunit">concUnit</code></td>
<td>
<p>unit of concentration</p>
</td></tr>
<tr><td><code id="Unit_+3A_doseunit">doseUnit</code></td>
<td>
<p>unit of dose</p>
</td></tr>
<tr><td><code id="Unit_+3A_mw">MW</code></td>
<td>
<p>molecular weight of drug</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>row names</code></td>
<td>
<p>PPTESTCD</p>
</td></tr>
<tr><td><code>Unit</code></td>
<td>
<p>unit</p>
</td></tr>
<tr><td><code>Factor</code></td>
<td>
<p>internal mulitplication factor</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>Unit(concUnit="ug/L", doseUnit="mg")
Unit(concUnit="ng/L", doseUnit="mg")

Unit(concUnit="umol/L", doseUnit="mmol")
Unit(concUnit="nmol/L", doseUnit="mmol")

Unit(concUnit="mmol/L", doseUnit="mg", MW=500)
Unit(concUnit="umol/L", doseUnit="mg", MW=500)
Unit(concUnit="nmol/L", doseUnit="mg", MW=500)
Unit(concUnit="nmol/mL", doseUnit="mg", MW=500)

Unit(concUnit="ug/L", doseUnit="mmol", MW=500)
Unit(concUnit="ug/L", doseUnit="mol", MW=500)
Unit(concUnit="ng/L", doseUnit="mmol", MW=500)
Unit(concUnit="ng/mL", doseUnit="mmol", MW=500)

Unit(concUnit="nmol/L", doseUnit="mg")
Unit(concUnit="ug/L", doseUnit="mmol")
</code></pre>

<hr>
<h2 id='UnitUrine'>
Retuns a conversion factor for the amount calculation from urine concentration and volume  
</h2><span id='topic+UnitUrine'></span>

<h3>Description</h3>

<p>You can get a conversion factor for the multiplication: conc * vol * factor = amount in the given unit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UnitUrine(conU = "ng/mL", volU = "mL", amtU = "mg", MW = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UnitUrine_+3A_conu">conU</code></td>
<td>
<p>concentration unit</p>
</td></tr>
<tr><td><code id="UnitUrine_+3A_volu">volU</code></td>
<td>
<p>volume unit</p>
</td></tr>
<tr><td><code id="UnitUrine_+3A_amtu">amtU</code></td>
<td>
<p>amount unit</p>
</td></tr>
<tr><td><code id="UnitUrine_+3A_mw">MW</code></td>
<td>
<p>molecular weight</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Factor</code></td>
<td>
<p>conversion factor for multiplication with the unit in name</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>UnitUrine()
UnitUrine("ng/mL", "mL", "mg")
UnitUrine("ug/L", "mL", "mg")
UnitUrine("ug/L", "L", "mg")

UnitUrine("ng/mL", "mL", "g")

UnitUrine("ng/mL", "mL", "mol", MW=500)
UnitUrine("ng/mL", "mL", "mmol", MW=500)
UnitUrine("ng/mL", "mL", "umol", MW=500)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
