<!DOCTYPE html><html><head><title>Help for package poissonMT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {poissonMT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#glmrobMT'>
<p>Robust Fitting of Poisson Generalized Linear Models</p>
using MT robust method</a></li>
<li><a href='#poissonL2T'>
<p>Fitting of Poisson Generalized Linear Models</p>
using MT method with L2 rho function</a></li>
<li><a href='#poissonMT'>
<p>Robust Fitting of Poisson Generalized Linear Models</p>
using MT robust method</a></li>
<li><a href='#poissonMTinitial'>
<p>Initial Robust Estimates based on MT robust method</p>
for fitting of Poisson Generalized Linear Models</a></li>
<li><a href='#poissonMTinitialParallel'>
<p>Initial Robust Estimates based on MT robust method</p>
for fitting of Poisson Generalized Linear Models</a></li>
<li><a href='#poissonMTwd'>
<p>Set and get working directory for the package.</p></a></li>
<li><a href='#poissonSSinitial'>
<p>Initial Robust Estimates based on SubSampling method</p>
for fitting of Poisson Generalized Linear Models</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust M-Estimators Based on Transformations for Poisson Model</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3-5</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-10-17</td>
</tr>
<tr>
<td>Author:</td>
<td>Claudio Agostinelli &lt;claudio.agostinelli@unitn.it&gt;, Marina Valdora &lt;mvaldora@gmail.com&gt; and Victor J. Yohai &lt;victoryohai@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Claudio Agostinelli &lt;claudio.agostinelli@unitn.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>R functions for the computation of Least Square based on transformation (L2T) and robust M-estimators based on transformations (MT-estimators) for Poisson regression models.</td>
</tr>
<tr>
<td>Depends:</td>
<td>MASS, robustbase, robcbi, checkmate</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-10-18 07:24:43 UTC; claudio</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-10-28 19:00:14 UTC</td>
</tr>
</table>
<hr>
<h2 id='glmrobMT'>
Robust Fitting of Poisson Generalized Linear Models
using MT robust method
</h2><span id='topic+glmrobMT'></span>

<h3>Description</h3>

<p><code>glmrobMT</code> is used to fit generalized linear models by robust MT
method. The model is specified by the <code>x</code> and <code>y</code>
components and a description of the error distribution. Currently,
only implemented for <code>family=poisson</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glmrobMT(x, y, weights=NULL, start=NULL, offset=NULL,
  family=poisson(), weights.on.x="none",
  control=glmrobMT.control(), intercept=TRUE, trace.lev=1,
  include.cubinf=TRUE, m.approx=NULL, mprime.approx=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glmrobMT_+3A_x">x</code></td>
<td>

<p>design matrix of dimension <code class="reqn">n \times p</code>.
</p>
</td></tr>
<tr><td><code id="glmrobMT_+3A_y">y</code></td>
<td>

<p>vector of observations of length <code>n</code>.
</p>
</td></tr>
<tr><td><code id="glmrobMT_+3A_weights">weights</code></td>
<td>

<p>an optional vector of weights to be used in the fitting
process (in addition to the robustness weights computed in
the fitting process).  
</p>
</td></tr>
<tr><td><code id="glmrobMT_+3A_start">start</code></td>
<td>

<p>starting values for the parameters in the linear predictor.
Note that specifying <code>start</code> skips the computation of
the initial estimates, but needs to be <em>robust</em> itself.  
</p>
</td></tr>
<tr><td><code id="glmrobMT_+3A_offset">offset</code></td>
<td>

<p>this can be used to specify an <em>a priori</em> known component
to be included in the linear predictor during fitting.
At the moment it is not used.
</p>
</td></tr>
<tr><td><code id="glmrobMT_+3A_family">family</code></td>
<td>

<p>a description of the error distribution and link function to
be used in the model. This can be a character string naming a
family function, a family <code><a href="base.html#topic+function">function</a></code> or the result of a
call to a family function. See <code><a href="stats.html#topic+family">family</a></code> for details of
family functions. At the moment only <code>poisson</code> is available.
</p>
</td></tr>
<tr><td><code id="glmrobMT_+3A_weights.on.x">weights.on.x</code></td>
<td>

<p>a character string (can be abbreviated), a <code><a href="base.html#topic+function">function</a></code> or
<code><a href="base.html#topic+list">list</a></code> (see below), or a numeric vector of length
<code>n</code>, specifying how points (potential outliers) in x-space are
downweighted. If <code>"hat"</code>, weights on the design of the form
<code class="reqn">\sqrt{1-h_{ii}}</code> are used, where <code class="reqn">h_{ii}</code> are the diagonal
elements of the hat matrix. If <code>"robCov"</code>, weights based on
the robust Mahalanobis distance of the design matrix (intercept
excluded) are used where the covariance matrix and the centre is
estimated by <code><a href="MASS.html#topic+cov.rob">cov.rob</a></code>
from the package <span class="pkg">MASS</span>.<br />
Similarly,  if <code>"covMcd"</code>, robust weights are computed using
<code><a href="robustbase.html#topic+covMcd">covMcd</a></code>.  The default is <code>"none"</code>.
</p>
<p>If <code>weights.on.x</code> is a <code><a href="base.html#topic+function">function</a></code>, it is called
with arguments <code>(X, intercept)</code> and must return an n-vector of
non-negative weights.
</p>
<p>If it is a <code><a href="base.html#topic+list">list</a></code>, it must be of length one, and as
element contain a function much like <code><a href="robustbase.html#topic+covMcd">covMcd</a>()</code> or
<code><a href="MASS.html#topic+cov.rob">cov.rob</a>()</code> (package <span class="pkg">MASS</span>), which computes
multivariate location and &ldquo;scatter&rdquo; of a data matrix <code>X</code>.
</p>
</td></tr>
<tr><td><code id="glmrobMT_+3A_control">control</code></td>
<td>

<p>a list of parameters for controlling the fitting process.
See the documentation for <code><a href="robustbase.html#topic+glmrobMT.control">glmrobMT.control</a></code> for
details.
</p>
</td></tr>
<tr><td><code id="glmrobMT_+3A_intercept">intercept</code></td>
<td>

<p>logical indicating if an intercept at the first column of <code>x</code>
is present. This information is only used when <code>weights.on.x</code>
is not set to <code>none</code>.
</p>
</td></tr>
<tr><td><code id="glmrobMT_+3A_trace.lev">trace.lev</code></td>
<td>

<p>logical (or integer) indicating if intermediate results
should be printed; defaults to <code>0</code> (the same as <code>FALSE</code>).
</p>
</td></tr>
<tr><td><code id="glmrobMT_+3A_include.cubinf">include.cubinf</code></td>
<td>

<p>logical, if <code>TRUE</code> the <code><a href="robcbi.html#topic+cubinf">cubinf</a></code>
is also used as possibile starting value.
</p>
</td></tr>
<tr><td><code id="glmrobMT_+3A_m.approx">m.approx</code></td>
<td>

<p>a function that return the value, for each linear predictor, that
makes the estimating equation Fisher consistent. If <code>NULL</code>
the default internal function is used.  
</p>
</td></tr>
<tr><td><code id="glmrobMT_+3A_mprime.approx">mprime.approx</code></td>
<td>

<p>a function that return the value, for each linear predictor,
corresponding to the first derivative of <code>m.approx</code>.
If <code>NULL</code> the default internal function is used. 
</p>
</td></tr>  
<tr><td><code id="glmrobMT_+3A_...">...</code></td>
<td>

<p>At the moment it is not used.  
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients.</p>
</td></tr>
<tr><td><code>initial</code></td>
<td>
<p>Initial vector of coefficients.</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>the <code><a href="stats.html#topic+family">family</a></code> object used.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>weighted Pearson residuals.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>the fitted mean values, obtained by transforming
the linear predictors by the inverse of the link function.</p>
</td></tr>
<tr><td><code>linear.predictors</code></td>
<td>
<p>the linear fit on link scale.</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p>the estimated asymptotic covariance matrix of the estimated
coefficients.</p>
</td></tr>
<tr><td><code>converged</code></td>
<td>
<p>logical. Was the IWLS algorithm judged to have converged?</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>the number of iterations used by the influence algorithm.</p>
</td></tr>
<tr><td><code>cw</code></td>
<td>
<p>the tuning constant c in Tukey's bisquare psi-function.</p>
</td></tr>
<tr><td><code>weights.on.x</code></td>
<td>
<p>how the weights on the design matrix <code>x</code> were evaluated.</p>
</td></tr>
<tr><td><code>w.x</code></td>
<td>
<p>weights used to down-weight observations based on the
position of the observation in the design space.</p>
</td></tr>
<tr><td><code>w.r</code></td>
<td>
<p>robustness weights for each observations.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Claudio Agostinelli, Marina Valdora and Victor J. Yohai  
</p>


<h3>References</h3>

<p>C. Agostinelli, M. Valdora and V.J Yohai (2018)
Initial Robust Estimation in Generalized Linear Models
with a Large Number of Covariates. Submitted.
</p>
<p>M. Valdora and V.J. Yohai (2014)
Robust estimators for generalized linear models.
Journal of Statistical Planning and Inference, 146, 31-48.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+poissonMT">poissonMT</a></code>, <code><a href="robustbase.html#topic+glmrob">glmrob</a></code> and <code>cubinf</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(epilepsy)  
  Efit1 &lt;- glm(Ysum ~ Age10 + Base4*Trt, family=poisson, data=epilepsy)

  x &lt;- model.matrix( ~ Age10 + Base4*Trt, data=epilepsy)
  poissonMTsetwd(tempdir())   
  Efit2 &lt;- glmrobMT(x=x, y=epilepsy$Ysum) 
</code></pre>

<hr>
<h2 id='poissonL2T'>
Fitting of Poisson Generalized Linear Models
using MT method with L2 rho function
</h2><span id='topic+poissonL2T'></span>

<h3>Description</h3>

<p><code>poissonL2T</code> is used to fit generalized linear models by MT
method with L2 rho function. The model is specified by the
<code>x</code> and <code>y</code> components. Since the L2 rho function is
used the method is not robust. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  poissonL2T(x, y, start = NULL, tol = 1e-08, maxit = 100,
  m.approx = NULL, mprime.approx = NULL, na.to.zero = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poissonL2T_+3A_x">x</code></td>
<td>

<p>design matrix of dimension <code class="reqn">n \times p</code>.
</p>
</td></tr>
<tr><td><code id="poissonL2T_+3A_y">y</code></td>
<td>

<p>vector of observations of length <code>n</code>.  
</p>
</td></tr>
<tr><td><code id="poissonL2T_+3A_start">start</code></td>
<td>

<p>starting values for the parameters in the linear predictor.
</p>
</td></tr>
<tr><td><code id="poissonL2T_+3A_tol">tol</code></td>
<td>

<p>convergence tolerance for the parameter vector.
</p>
</td></tr>
<tr><td><code id="poissonL2T_+3A_maxit">maxit</code></td>
<td>

<p>integer specifying the maximum number of IRWLS iterations.
</p>
</td></tr>
<tr><td><code id="poissonL2T_+3A_m.approx">m.approx</code></td>
<td>

<p>a function that return the value, for each linear predictor, that
makes the estimating equation Fisher consistent. If <code>NULL</code>
the default internal function is used.  
</p>
</td></tr>
<tr><td><code id="poissonL2T_+3A_mprime.approx">mprime.approx</code></td>
<td>

<p>a function that return the value, for each linear predictor,
corresponding to the first derivative of <code>m.approx</code>.
If <code>NULL</code> the default internal function is used. 
</p>
</td></tr>
<tr><td><code id="poissonL2T_+3A_na.to.zero">na.to.zero</code></td>
<td>

<p>logical, should the eventual <code>NA</code> in the coefficients
be replaced by <code>0</code>? 
</p>
</td></tr>  
</table>


<h3>Value</h3>

<p>A vector with the estimated coefficients.
</p>


<h3>Author(s)</h3>

<p>Claudio Agostinelli, Marina Valdora and Victor J. Yohai
</p>


<h3>References</h3>

<p>C. Agostinelli, M. Valdora and V.J Yohai (2018)
Initial Robust Estimation in Generalized Linear Models
with a Large Number of Covariates. Submitted.
</p>
<p>M. Valdora and V.J. Yohai (2014)
Robust estimators for generalized linear models.
Journal of Statistical Planning and Inference, 146, 31-48.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+poissonMT">poissonMT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(epilepsy)
  x &lt;- model.matrix( ~ Age10 + Base4*Trt, data=epilepsy)
  poissonMTsetwd(tempdir())
  Efit4 &lt;- poissonL2T(x=x, y=epilepsy$Ysum)
</code></pre>

<hr>
<h2 id='poissonMT'>
Robust Fitting of Poisson Generalized Linear Models
using MT robust method
</h2><span id='topic+poissonMT'></span>

<h3>Description</h3>

<p><code>poissonMT</code> is used to fit generalized linear models by robust MT
method. The model is specified by the <code>x</code> and <code>y</code>
components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  poissonMT(x, y, start, weights = NULL, tol = 1e-08, maxit = 100,
  m.approx = NULL, mprime.approx = NULL, psi = "bisquare",
  cc = 2.3, na.to.zero = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poissonMT_+3A_x">x</code></td>
<td>

<p>design matrix of dimension <code class="reqn">n \times p</code>.
</p>
</td></tr>
<tr><td><code id="poissonMT_+3A_y">y</code></td>
<td>

<p>vector of observations of length <code>n</code>.
</p>
</td></tr>
<tr><td><code id="poissonMT_+3A_start">start</code></td>
<td>

<p>starting values for the parameters in the linear predictor.
</p>
</td></tr>
<tr><td><code id="poissonMT_+3A_weights">weights</code></td>
<td>

<p>an optional vector of weights to be used in the fitting
process (in addition to the robustness weights computed in
the fitting process).
</p>
</td></tr>
<tr><td><code id="poissonMT_+3A_tol">tol</code></td>
<td>

<p>convergence tolerance for the parameter vector.
</p>
</td></tr>
<tr><td><code id="poissonMT_+3A_maxit">maxit</code></td>
<td>

<p>integer specifying the maximum number of IRWLS iterations.
</p>
</td></tr>
<tr><td><code id="poissonMT_+3A_m.approx">m.approx</code></td>
<td>

<p>a function that return the value, for each linear predictor, that
makes the estimating equation Fisher consistent. If <code>NULL</code>
the default internal function is used.  
</p>
</td></tr>
<tr><td><code id="poissonMT_+3A_mprime.approx">mprime.approx</code></td>
<td>

<p>a function that return the value, for each linear predictor,
corresponding to the first derivative of <code>m.approx</code>.
If <code>NULL</code> the default internal function is used. 
</p>
</td></tr>  
<tr><td><code id="poissonMT_+3A_psi">psi</code></td>
<td>

<p>the name of the <code>psi</code> function. At the moment only the
<code>bisquare</code> is available.
</p>
</td></tr>
<tr><td><code id="poissonMT_+3A_cc">cc</code></td>
<td>

<p>tuning constant c for Tukey's bisquare psi-function.
</p>
</td></tr>
<tr><td><code id="poissonMT_+3A_na.to.zero">na.to.zero</code></td>
<td>

<p>logical, should the eventual <code>NA</code> in the coefficients
be replaced by <code>0</code>? 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>a vector of coefficients.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>the fitted mean values, obtained by transforming
the linear predictors by the inverse of the link function.</p>
</td></tr>
<tr><td><code>linear.predictors</code></td>
<td>
<p>the linear fit on link scale.</p>
</td></tr>  
<tr><td><code>residuals</code></td>
<td>
<p>residuals on the transformed scale.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>the <em>working</em> weights, that is the weights in the
final iteration of the IWLS fit.</p>
</td></tr>
<tr><td><code>w.r</code></td>
<td>
<p>robustness weights for each observations.</p>
</td></tr>    
<tr><td><code>prior.weights</code></td>
<td>
<p>the weights initially supplied, a vector of
<code>1</code>s if none were.</p>
</td></tr>
<tr><td><code>converged</code></td>
<td>
<p>logical. Was the IWLS algorithm judged to have converged?</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>the number of iterations used by the influence algorithm.</p>
</td></tr>
<tr><td><code>obj</code></td>
<td>
<p>value of the MT objective function at <code>coefficients</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Claudio Agostinelli, Marina Valdora and Victor J. Yohai  
</p>


<h3>References</h3>

<p>C. Agostinelli, M. Valdora and V.J Yohai (2018)
Initial Robust Estimation in Generalized Linear Models
with a Large Number of Covariates. Submitted.
</p>
<p>M. Valdora and V.J. Yohai (2014)
Robust estimators for Generalized Linear Models.
Journal of Statistical Planning and Inference, 146, 31-48.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+glmrobMT">glmrobMT</a></code>, <code><a href="robustbase.html#topic+glmrob">glmrob</a></code> and <code>cubinf</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(epilepsy)
  x &lt;- model.matrix( ~ Age10 + Base4*Trt, data=epilepsy)
  poissonMTsetwd(tempdir())  
  start &lt;- poissonMTinitial(x=x, y=epilepsy$Ysum)$coefficients
  Efit3 &lt;- poissonMT(x=x, y=epilepsy$Ysum, start=start)
</code></pre>

<hr>
<h2 id='poissonMTinitial'>
Initial Robust Estimates based on MT robust method
for fitting of Poisson Generalized Linear Models
</h2><span id='topic+poissonMTinitial'></span>

<h3>Description</h3>

<p><code>poissonMTinitial</code> is used to provides a robust initial estimate
for fit generalized linear models.
The model is specified by the <code>x</code> and <code>y</code> components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poissonMTinitial(x, y, stage2 = TRUE, alpha = c(0.025, 0.025),
  tol = 1e-04, cc = 2.3, psi = "bisquare", maxit = 20,
  zero = sqrt(.Machine$double.eps), replace.small = 0.5, start = NULL,
  na.to.zero = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poissonMTinitial_+3A_x">x</code></td>
<td>

<p>design matrix of dimension <code class="reqn">n \times p</code>.
</p>
</td></tr>
<tr><td><code id="poissonMTinitial_+3A_y">y</code></td>
<td>

<p>vector of observations of length <code>n</code>.
</p>
</td></tr>
<tr><td><code id="poissonMTinitial_+3A_stage2">stage2</code></td>
<td>

<p>logical, the second stage should be performed?
</p>
</td></tr>
<tr><td><code id="poissonMTinitial_+3A_alpha">alpha</code></td>
<td>

<p>quantile orders used in the second stage.
</p>
</td></tr>
<tr><td><code id="poissonMTinitial_+3A_tol">tol</code></td>
<td>

<p>convergence tolerance for the parameter vector.
</p>
</td></tr>
<tr><td><code id="poissonMTinitial_+3A_cc">cc</code></td>
<td>

<p>tuning constant c for Tukey's bisquare psi-function.
</p>
</td></tr>
<tr><td><code id="poissonMTinitial_+3A_psi">psi</code></td>
<td>

<p>the name of the <code>psi</code> function. At the moment only the
<code>bisquare</code> is available.
</p>
</td></tr>
<tr><td><code id="poissonMTinitial_+3A_maxit">maxit</code></td>
<td>

<p>integer specifying the maximum number of IRWLS iterations.
</p>
</td></tr>
<tr><td><code id="poissonMTinitial_+3A_zero">zero</code></td>
<td>

<p>eigenvalues smaller than <code>zero</code> will be considered exactly equal to 0.
</p>
</td></tr>
<tr><td><code id="poissonMTinitial_+3A_replace.small">replace.small</code></td>
<td>

<p>all the observations <code>y</code> smaller than <code>replace.small</code>
are replaced by <code>replace.small</code> value.
</p>
</td></tr>
<tr><td><code id="poissonMTinitial_+3A_start">start</code></td>
<td>

<p>eventual starting values, as a reference, for the parameters
in the linear predictor.
</p>
</td></tr>
<tr><td><code id="poissonMTinitial_+3A_na.to.zero">na.to.zero</code></td>
<td>

<p>logical, should the eventual <code>NA</code> in the coefficients
be replaced by <code>0</code>?
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components
</p>
<table>
<tr><td><code>coefficients1</code></td>
<td>
<p>initial value proposed at the end of the first stage.</p>
</td></tr>
<tr><td><code>obj1</code></td>
<td>
<p>value of the MT objective function at <code>coefficients1</code>.</p>
</td></tr>
<tr><td><code>coefficients2a</code></td>
<td>
<p>initial value proposed at the end of the first part od the second stage.</p>
</td></tr>
<tr><td><code>obj2a</code></td>
<td>
<p>value of the MT objective function at <code>coefficients2a</code>.</p>
</td></tr>  
<tr><td><code>coefficients2b</code></td>
<td>
<p>initial value proposed at the end of the second part od the second stage.</p>
</td></tr>
<tr><td><code>obj2b</code></td>
<td>
<p>value of the MT objective function at <code>coefficients2b</code>.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>initial value proposed.</p>
</td></tr>
<tr><td><code>obj</code></td>
<td>
<p>value of the MT objective function at <code>coefficients</code>.</p>
</td></tr>    
</table>


<h3>Author(s)</h3>

<p>Claudio Agostinelli, Marina Valdora and Victor J. Yohai  
</p>


<h3>References</h3>

<p>C. Agostinelli, M. Valdora and V.J Yohai (2018)
Initial Robust Estimation in Generalized Linear Models
with a Large Number of Covariates. Submitted.
</p>
<p>M. Valdora and V.J. Yohai (2014)
Robust estimators for generalized linear models.
Journal of Statistical Planning and Inference, 146, 31-48.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+poissonMT">poissonMT</a></code> and <code><a href="#topic+poissonL2T">poissonL2T</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(epilepsy)
  x &lt;- model.matrix( ~ Age10 + Base4*Trt, data=epilepsy)
  poissonMTsetwd(tempdir())
  start &lt;- poissonMTinitial(x=x, y=epilepsy$Ysum)$coefficients
  start
</code></pre>

<hr>
<h2 id='poissonMTinitialParallel'>
Initial Robust Estimates based on MT robust method
for fitting of Poisson Generalized Linear Models
</h2><span id='topic+poissonMTinitialParallel'></span>

<h3>Description</h3>

<p><code>poissonMTinitialParallel</code> is used to provides a robust initial estimate
for fit generalized linear models. This is the parallel computing version.
The model is specified by the <code>x</code> and <code>y</code> components.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poissonMTinitialParallel(x, y, stage2 = TRUE, alpha = c(0.025, 0.025),
  tol = 1e-04, cc = 2.3, psi = "bisquare", maxit = 20,
  zero = sqrt(.Machine$double.eps), replace.small = 0.5, start = NULL,
  na.to.zero = TRUE, parallel = c("no", "multicore", "snow"),
  ncpus = 1, cl = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poissonMTinitialParallel_+3A_x">x</code></td>
<td>

<p>design matrix of dimension <code class="reqn">n \times p</code>.
</p>
</td></tr>
<tr><td><code id="poissonMTinitialParallel_+3A_y">y</code></td>
<td>

<p>vector of observations of length <code>n</code>.
</p>
</td></tr>
<tr><td><code id="poissonMTinitialParallel_+3A_stage2">stage2</code></td>
<td>

<p>logical, the second stage should be performed?
</p>
</td></tr>
<tr><td><code id="poissonMTinitialParallel_+3A_alpha">alpha</code></td>
<td>

<p>quantile orders used in the second stage.
</p>
</td></tr>
<tr><td><code id="poissonMTinitialParallel_+3A_tol">tol</code></td>
<td>

<p>convergence tolerance for the parameter vector.
</p>
</td></tr>
<tr><td><code id="poissonMTinitialParallel_+3A_cc">cc</code></td>
<td>

<p>tuning constant c for Tukey's bisquare psi-function.
</p>
</td></tr>
<tr><td><code id="poissonMTinitialParallel_+3A_psi">psi</code></td>
<td>

<p>the name of the <code>psi</code> function. At the moment only the
<code>bisquare</code> is available.
</p>
</td></tr>
<tr><td><code id="poissonMTinitialParallel_+3A_maxit">maxit</code></td>
<td>

<p>integer specifying the maximum number of IRWLS iterations.
</p>
</td></tr>
<tr><td><code id="poissonMTinitialParallel_+3A_zero">zero</code></td>
<td>

<p>eigenvalues smaller than <code>zero</code> will be considered exactly equal to 0.
</p>
</td></tr>
<tr><td><code id="poissonMTinitialParallel_+3A_replace.small">replace.small</code></td>
<td>

<p>all the observations <code>y</code> smaller than <code>replace.small</code>
are replaced by <code>replace.small</code> value.
</p>
</td></tr>
<tr><td><code id="poissonMTinitialParallel_+3A_start">start</code></td>
<td>

<p>eventual starting values, as a reference, for the parameters
in the linear predictor.
</p>
</td></tr>
<tr><td><code id="poissonMTinitialParallel_+3A_na.to.zero">na.to.zero</code></td>
<td>

<p>logical, should the eventual <code>NA</code> in the coefficients
be replaced by <code>0</code>?
</p>
</td></tr>  
<tr><td><code id="poissonMTinitialParallel_+3A_parallel">parallel</code></td>
<td>

<p>The type of parallel operation to be used. By default (<code>none</code>) no parallel is used.
</p>
</td></tr>
<tr><td><code id="poissonMTinitialParallel_+3A_ncpus">ncpus</code></td>
<td>

<p>integer: number of processes to be used in parallel operation.
Typically one would chose this to the number of available CPUs.
</p>
</td></tr>
<tr><td><code id="poissonMTinitialParallel_+3A_cl">cl</code></td>
<td>

<p>An optional <code>parallel</code> or <code>snow</code> cluster for use if
<code>parallel = "snow"</code>. If not supplied, a cluster on the local
machine is created for the duration of the <code>poissonMTinitialParallel</code>
call.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is the same as function <code><a href="#topic+poissonMTinitial">poissonMTinitial</a></code>, however it can takes advantage of parallel computing.
</p>


<h3>Value</h3>

<p>A list with the following components
</p>
<table>
<tr><td><code>coefficients1</code></td>
<td>
<p>initial value proposed at the end of the first stage.</p>
</td></tr>
<tr><td><code>obj1</code></td>
<td>
<p>value of the MT objective function at <code>coefficients1</code>.</p>
</td></tr>
<tr><td><code>coefficients2a</code></td>
<td>
<p>initial value proposed at the end of the first part od the second stage.</p>
</td></tr>
<tr><td><code>obj2a</code></td>
<td>
<p>value of the MT objective function at <code>coefficients2a</code>.</p>
</td></tr>  
<tr><td><code>coefficients2b</code></td>
<td>
<p>initial value proposed at the end of the second part od the second stage.</p>
</td></tr>
<tr><td><code>obj2b</code></td>
<td>
<p>value of the MT objective function at <code>coefficients2b</code>.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>initial value proposed.</p>
</td></tr>
<tr><td><code>obj</code></td>
<td>
<p>value of the MT objective function at <code>coefficients</code>.</p>
</td></tr>    
</table>


<h3>Author(s)</h3>

<p>Claudio Agostinelli, Marina Valdora and Victor J. Yohai  
</p>


<h3>References</h3>

<p>C. Agostinelli, M. Valdora and V.J Yohai (2018)
Initial Robust Estimation in Generalized Linear Models
with a Large Number of Covariates. Submitted.
</p>
<p>M. Valdora and V.J. Yohai (2014)
Robust estimators for generalized linear models.
Journal of Statistical Planning and Inference, 146, 31-48.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+poissonMTinitial">poissonMTinitial</a></code>, <code><a href="#topic+poissonMT">poissonMT</a></code> and <code><a href="#topic+poissonL2T">poissonL2T</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(epilepsy)
  x &lt;- model.matrix( ~ Age10 + Base4*Trt, data=epilepsy)
  poissonMTsetwd(tempdir())
  start &lt;- poissonMTinitialParallel(x=x, y=epilepsy$Ysum)$coefficients
  start
</code></pre>

<hr>
<h2 id='poissonMTwd'>
Set and get working directory for the package.
</h2><span id='topic+poissonMTsetwd'></span><span id='topic+poissonMTgetwd'></span>

<h3>Description</h3>

<p>Set and get working directory for the package. This working
directory is used to store some objects needed during the
estimation process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  poissonMTsetwd(path)

  poissonMTgetwd()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poissonMTwd_+3A_path">path</code></td>
<td>

<p>A valid path name for your OS where you have write/read permission.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>poissonMTsetwd</code> is just a wrapper for <code>options("poissonMT:wd" = path)</code> while <code>poissonMTsetwd</code> is just a wrapper for <code>getOption("poissonMT:wd", NULL)</code>.
</p>


<h3>Value</h3>

<p><code>poissonMTsetwd</code> does not return any object, <code>poissonMTsetwd</code> return a path or <code>NULL</code>.  
</p>


<h3>Author(s)</h3>

<p>Claudio Agostinelli, Marina Valdora and Victor J. Yohai  
</p>


<h3>See Also</h3>

<p><code><a href="#topic+glmrobMT">glmrobMT</a></code>, <code><a href="robustbase.html#topic+glmrob">glmrob</a></code> and <code>cubinf</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  poissonMTsetwd(tempdir())
  poissonMTgetwd()
</code></pre>

<hr>
<h2 id='poissonSSinitial'>
Initial Robust Estimates based on SubSampling method
for fitting of Poisson Generalized Linear Models
</h2><span id='topic+poissonSSinitial'></span>

<h3>Description</h3>

<p><code>poissonSSinitial</code> is used to provides a robust initial estimate
for fit generalized linear models.
The model is specified by the <code>x</code> and <code>y</code> components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poissonSSinitial(x, y, nsubm, size = ncol(x), cc = 2.3,
  psi = "bisquare", na.to.zero = TRUE, trace.lev = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poissonSSinitial_+3A_x">x</code></td>
<td>

<p>design matrix of dimension <code class="reqn">n \times p</code>.
</p>
</td></tr>
<tr><td><code id="poissonSSinitial_+3A_y">y</code></td>
<td>

<p>vector of observations of length <code>n</code>.
</p>
</td></tr>
<tr><td><code id="poissonSSinitial_+3A_nsubm">nsubm</code></td>
<td>

<p>the number of subsamples to take for finding an initial estimate.
</p>
</td></tr>
<tr><td><code id="poissonSSinitial_+3A_size">size</code></td>
<td>

<p>size of the subsamples.
</p>
</td></tr>  
<tr><td><code id="poissonSSinitial_+3A_cc">cc</code></td>
<td>

<p>tuning constant c for Tukey's bisquare psi-function.
</p>
</td></tr>
<tr><td><code id="poissonSSinitial_+3A_psi">psi</code></td>
<td>

<p>the name of the <code>psi</code> function. At the moment only the
<code>bisquare</code> is available.
</p>
</td></tr>
<tr><td><code id="poissonSSinitial_+3A_na.to.zero">na.to.zero</code></td>
<td>

<p>logical, should the eventual <code>NA</code> in the coefficients
be replaced by <code>0</code>?
</p>
</td></tr>
<tr><td><code id="poissonSSinitial_+3A_trace.lev">trace.lev</code></td>
<td>

<p>logical (or integer) indicating if intermediate results
should be printed; defaults to <code>0</code> (the same as <code>FALSE</code>).  
</p>
</td></tr>  
</table>


<h3>Value</h3>

<p>A list with the following components
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>initial value proposed.</p>
</td></tr>
<tr><td><code>obj</code></td>
<td>
<p>value of the MT objective function at <code>coefficients</code>.</p>
</td></tr>
<tr><td><code>nOksamples</code></td>
<td>
<p>number of subsamples without errors.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Claudio Agostinelli, Marina Valdora and Victor J. Yohai  
</p>


<h3>References</h3>

<p>C. Agostinelli, M. Valdora and V.J Yohai (2018)
Initial Robust Estimation in Generalized Linear Models
with a Large Number of Covariates. Submitted.
</p>
<p>M. Valdora and V.J. Yohai (2014)
Robust estimators for generalized linear models.
Journal of Statistical Planning and Inference, 146, 31-48.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+poissonMTinitial">poissonMTinitial</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(epilepsy)
  x &lt;- model.matrix( ~ Age10 + Base4*Trt, data=epilepsy)
  start &lt;- poissonSSinitial(x=x, y=epilepsy$Ysum, nsubm=100)$coefficients
  start
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
