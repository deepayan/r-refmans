<!DOCTYPE html><html><head><title>Help for package difNLR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {difNLR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#coef.ddfMLR'><p>Extract model coefficients from an object of <code>"ddfMLR"</code> class.</p></a></li>
<li><a href='#coef.difNLR'><p>Extract model coefficients from an object of <code>"difNLR"</code> class.</p></a></li>
<li><a href='#coef.difORD'><p>Extract model coefficients from an object of <code>"difORD"</code> class.</p></a></li>
<li><a href='#ddfMLR'><p>DDF detection for nominal data.</p></a></li>
<li><a href='#difNLR'><p>DIF detection using non-linear regression method.</p></a></li>
<li><a href='#difNLR-package'><p>DIF and DDF Detection by Non-Linear Regression Models.</p></a></li>
<li><a href='#difORD'><p>DIF detection among ordinal data.</p></a></li>
<li><a href='#estimNLR'><p>Non-Linear Regression DIF models estimation.</p></a></li>
<li><a href='#fitted.difNLR'><p>Fitted values and residuals for an object of <code>"difNLR"</code> class.</p></a></li>
<li><a href='#formulaNLR'><p>Formula for non-linear regression DIF model.</p></a></li>
<li><a href='#genNLR'><p>Generates data set based on generalized logistic regression DIF and DDF models.</p></a></li>
<li><a href='#GMAT'><p>Dichotomous dataset based on GMAT with the same total score distribution for groups.</p></a></li>
<li><a href='#GMAT2'><p>Dichotomous dataset based on GMAT.</p></a></li>
<li><a href='#GMAT2key'><p>Key of correct answers for <code>GMAT2test</code> dataset.</p></a></li>
<li><a href='#GMAT2test'><p>Dataset based on GMAT.</p></a></li>
<li><a href='#GMATkey'><p>Key of correct answers for <code>GMATtest</code> dataset.</p></a></li>
<li><a href='#GMATtest'><p>Dataset based on GMAT with the same total score distribution for groups.</p></a></li>
<li><a href='#logLik.ddfMLR'><p>Log-likelihood and information criteria for an object of <code>"ddfMLR"</code> class.</p></a></li>
<li><a href='#logLik.difNLR'><p>Log-likelihood and information criteria for an object of <code>"difNLR"</code> class.</p></a></li>
<li><a href='#logLik.difORD'><p>Log-likelihood and information criteria for an object of</p>
<code>"difORD"</code> class.</a></li>
<li><a href='#MLR'><p>DDF likelihood ratio statistics based on multinomial log-linear</p>
regression model.</a></li>
<li><a href='#MSATB'><p>Dichotomous dataset of Medical School Admission Test in Biology.</p></a></li>
<li><a href='#MSATBkey'><p>Key of correct answers for <code>MSATBtest</code> dataset.</p></a></li>
<li><a href='#MSATBtest'><p>Dataset of School Admission Test in Biology.</p></a></li>
<li><a href='#NLR'><p>DIF statistics based on non-linear regression model.</p></a></li>
<li><a href='#ORD'><p>DIF likelihood ratio statistics for ordinal data.</p></a></li>
<li><a href='#plot.ddfMLR'><p>ICC plots for an object of <code>"ddfMLR"</code> class.</p></a></li>
<li><a href='#plot.difNLR'><p>ICC and test statistics plots for an object of <code>"difNLR"</code> class.</p></a></li>
<li><a href='#plot.difORD'><p>ICC plots for an object of <code>"difORD"</code> class.</p></a></li>
<li><a href='#predict.ddfMLR'><p>Predicted values for an object of <code>"ddfMLR"</code> class.</p></a></li>
<li><a href='#predict.difNLR'><p>Predicted values for an object of <code>"difNLR"</code> class.</p></a></li>
<li><a href='#predict.difORD'><p>Predicted values for an object of <code>"difORD"</code> class.</p></a></li>
<li><a href='#startNLR'><p>Calculates starting values for non-linear regression DIF models.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>DIF and DDF Detection by Non-Linear Regression Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.2-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-05-02</td>
</tr>
<tr>
<td>Author:</td>
<td>Adela Hladka [aut, cre],
  Patricia Martinkova [aut],
  Karel Zvara [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Adela Hladka &lt;hladka@cs.cas.cz&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>calculus, ggplot2 (&ge; 3.4.0), msm, nnet, plyr, stats, VGAM</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ShinyItemAnalysis</td>
</tr>
<tr>
<td>Description:</td>
<td>Detection of differential item functioning (DIF) among dichotomously scored items and differential distractor functioning (DDF) among unscored items with non-linear regression  procedures based on generalized logistic regression models (Hladka &amp; Martinkova, 2020, &lt;<a href="https://doi.org/10.32614%2FRJ-2020-014">doi:10.32614/RJ-2020-014</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/adelahladka/difNLR/issues">https://github.com/adelahladka/difNLR/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-03 09:59:59 UTC; Adisa</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-03 10:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='coef.ddfMLR'>Extract model coefficients from an object of <code>"ddfMLR"</code> class.</h2><span id='topic+coef.ddfMLR'></span><span id='topic+coefficients.ddfMLR'></span>

<h3>Description</h3>

<p>S3 method for extracting estimated model coefficients
from an object of <code>"ddfMLR"</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ddfMLR'
coef(object, SE = FALSE, simplify = FALSE, IRTpars = TRUE, CI = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.ddfMLR_+3A_object">object</code></td>
<td>
<p>an object of <code>"ddfMLR"</code> class.</p>
</td></tr>
<tr><td><code id="coef.ddfMLR_+3A_se">SE</code></td>
<td>
<p>logical: should the standard errors of estimated
parameters be also returned? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="coef.ddfMLR_+3A_simplify">simplify</code></td>
<td>
<p>logical: should the estimated parameters be
simplified to a matrix? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="coef.ddfMLR_+3A_irtpars">IRTpars</code></td>
<td>
<p>logical: should the estimated parameters be returned
in IRT parameterization? (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="coef.ddfMLR_+3A_ci">CI</code></td>
<td>
<p>numeric: level of confidence interval for parameters,
default is <code>0.95</code> for 95% confidence interval.</p>
</td></tr>
<tr><td><code id="coef.ddfMLR_+3A_...">...</code></td>
<td>
<p>other generic parameters for <code>coef()</code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ddfMLR">ddfMLR</a></code> for DDF detection among nominal data. <br />
<code><a href="stats.html#topic+coef">coef</a></code> for generic function extracting model coefficients.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# loading data
data(GMATtest, GMATkey)
Data &lt;- GMATtest[, 1:20] # items
group &lt;- GMATtest[, "group"] # group membership variable
key &lt;- GMATkey # correct answers

# testing both DDF effects
(x &lt;- ddfMLR(Data, group, focal.name = 1, key))

# estimated parameters
coef(x)
# includes standard errors
coef(x, SE = TRUE)
# includes standard errors and simplifies to matrix
coef(x, SE = TRUE, simplify = TRUE)
# intercept-slope parameterization
coef(x, IRTpars = FALSE)
# intercept-slope parameterization, simplifies to matrix, turn off confidence intervals
coef(x, IRTpars = FALSE, simplify = TRUE, CI = 0)

## End(Not run)
</code></pre>

<hr>
<h2 id='coef.difNLR'>Extract model coefficients from an object of <code>"difNLR"</code> class.</h2><span id='topic+coef.difNLR'></span><span id='topic+coefficients.difNLR'></span>

<h3>Description</h3>

<p>S3 method for extracting model coefficients from an
object of <code>"difNLR"</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'difNLR'
coef(object, SE = FALSE, simplify = FALSE, IRTpars = TRUE, CI = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.difNLR_+3A_object">object</code></td>
<td>
<p>an object of <code>"difNLR"</code> class.</p>
</td></tr>
<tr><td><code id="coef.difNLR_+3A_se">SE</code></td>
<td>
<p>logical: should the standard errors of estimated
parameters be also returned? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="coef.difNLR_+3A_simplify">simplify</code></td>
<td>
<p>logical: should the estimated parameters be
simplified to a matrix? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="coef.difNLR_+3A_irtpars">IRTpars</code></td>
<td>
<p>logical: should the estimated parameters be returned
in IRT parameterization? (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="coef.difNLR_+3A_ci">CI</code></td>
<td>
<p>numeric: level of confidence interval for parameters,
default is <code>0.95</code> for 95% confidence interval.</p>
</td></tr>
<tr><td><code id="coef.difNLR_+3A_...">...</code></td>
<td>
<p>other generic parameters for <code>coef()</code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>
<p>Karel Zvara <br />
Faculty of Mathematics and Physics, Charles University <br />
</p>


<h3>References</h3>

<p>Drabinova, A. &amp; Martinkova, P. (2017). Detection of differential item functioning with nonlinear regression:
A non-IRT approach accounting for guessing. Journal of Educational Measurement, 54(4), 498&ndash;517,
<a href="https://doi.org/10.1111/jedm.12158">doi:10.1111/jedm.12158</a>.
</p>
<p>Hladka, A. &amp; Martinkova, P. (2020). difNLR: Generalized logistic regression models for DIF and DDF detection.
The R Journal, 12(1), 300&ndash;323, <a href="https://doi.org/10.32614/RJ-2020-014">doi:10.32614/RJ-2020-014</a>.
</p>
<p>Swaminathan, H. &amp; Rogers, H. J. (1990). Detecting differential item functioning using logistic regression procedures.
Journal of Educational Measurement, 27(4), 361&ndash;370, <a href="https://doi.org/10.1111/j.1745-3984.1990.tb00754.x">doi:10.1111/j.1745-3984.1990.tb00754.x</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difNLR">difNLR</a></code> for DIF detection among binary data using generalized logistic regression model. <br />
<code><a href="stats.html#topic+coef">coef</a></code> for generic function extracting model coefficients.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# loading data
data(GMAT)
Data &lt;- GMAT[, 1:20] # items
group &lt;- GMAT[, "group"] # group membership variable

# testing both DIF effects using likelihood-ratio test and
# 3PL model with fixed guessing for groups
(x &lt;- difNLR(Data, group, focal.name = 1, model = "3PLcg"))

# estimated parameters
coef(x)
# includes standard errors
coef(x, SE = TRUE)
# includes standard errors and simplifies to matrix
coef(x, SE = TRUE, simplify = TRUE)
# intercept-slope parameterization
coef(x, IRTpars = FALSE)
# intercept-slope parameterization, simplifies to matrix, turn off confidence intervals
coef(x, IRTpars = FALSE, simplify = TRUE, CI = 0)

## End(Not run)
</code></pre>

<hr>
<h2 id='coef.difORD'>Extract model coefficients from an object of <code>"difORD"</code> class.</h2><span id='topic+coef.difORD'></span><span id='topic+coefficients.difORD'></span>

<h3>Description</h3>

<p>S3 method for extracting estimated model coefficients
from an object of <code>"difORD"</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'difORD'
coef(object, SE = FALSE, simplify = FALSE, IRTpars = TRUE, CI = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.difORD_+3A_object">object</code></td>
<td>
<p>an object of <code>"difORD"</code> class.</p>
</td></tr>
<tr><td><code id="coef.difORD_+3A_se">SE</code></td>
<td>
<p>logical: should the standard errors of estimated
parameters be also returned? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="coef.difORD_+3A_simplify">simplify</code></td>
<td>
<p>logical: should the estimated parameters be
simplified to a matrix? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="coef.difORD_+3A_irtpars">IRTpars</code></td>
<td>
<p>logical: should the estimated parameters be returned
in IRT parameterization? (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="coef.difORD_+3A_ci">CI</code></td>
<td>
<p>numeric: level of confidence interval for parameters,
default is <code>0.95</code> for 95% confidence interval.</p>
</td></tr>
<tr><td><code id="coef.difORD_+3A_...">...</code></td>
<td>
<p>other generic parameters for <code>coef()</code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difORD">difORD</a></code> for DIF detection among ordinal data. <br />
<code><a href="stats.html#topic+coef">coef</a></code> for generic function extracting model coefficients.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# loading data
data(Anxiety, package = "ShinyItemAnalysis")
Data &lt;- Anxiety[, paste0("R", 1:29)] # items
group &lt;- Anxiety[, "gender"] # group membership variable

# testing both DIF effects with adjacent category logit model
(x &lt;- difORD(Data, group, focal.name = 1, model = "adjacent"))

# estimated parameters
coef(x)
# includes standard errors
coef(x, SE = TRUE)
# includes standard errors and simplifies to matrix
coef(x, SE = TRUE, simplify = TRUE)
# intercept-slope parameterization
coef(x, IRTpars = FALSE)
# intercept-slope parameterization, simplifies to matrix, turn off confidence intervals
coef(x, IRTpars = FALSE, simplify = TRUE, CI = 0)

## End(Not run)
</code></pre>

<hr>
<h2 id='ddfMLR'>DDF detection for nominal data.</h2><span id='topic+ddfMLR'></span>

<h3>Description</h3>

<p>Performs DDF detection procedure for nominal data
based on multinomial log-linear regression model and likelihood
ratio test of a submodel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ddfMLR(Data, group, focal.name, key, type = "both", match = "zscore", anchor = NULL,
       purify = FALSE, nrIter = 10, p.adjust.method = "none",
       alpha = 0.05, parametrization)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ddfMLR_+3A_data">Data</code></td>
<td>
<p>data.frame or matrix: dataset which rows represent
unscored examinee answers (nominal) and columns correspond to the
items. In addition, <code>Data</code> can hold the vector of group
membership.</p>
</td></tr>
<tr><td><code id="ddfMLR_+3A_group">group</code></td>
<td>
<p>numeric or character: a dichotomous vector of the same
length as <code>nrow(Data)</code> or a column identifier of
<code>Data</code>.</p>
</td></tr>
<tr><td><code id="ddfMLR_+3A_focal.name">focal.name</code></td>
<td>
<p>numeric or character: indicates the level of
<code>group</code> which corresponds to focal group.</p>
</td></tr>
<tr><td><code id="ddfMLR_+3A_key">key</code></td>
<td>
<p>character: the answer key. Each element corresponds to
the correct answer of one item.</p>
</td></tr>
<tr><td><code id="ddfMLR_+3A_type">type</code></td>
<td>
<p>character: type of DDF to be tested. Either
<code>"both"</code> for uniform and non-uniform DDF (i.e., difference
in parameters <code>"a"</code> and <code>"b"</code>) (default), or
<code>"udif"</code> for uniform DDF only (i.e., difference in
difficulty parameter <code>"b"</code>), or <code>"nudif"</code> for
non-uniform DDF only (i.e., difference in discrimination
parameter <code>"a"</code>). Can be specified as a single value (for
all items) or as an item-specific vector.</p>
</td></tr>
<tr><td><code id="ddfMLR_+3A_match">match</code></td>
<td>
<p>numeric or character: matching criterion to be used as
an estimate of trait. Can be either <code>"zscore"</code> (default,
standardized total score), <code>"score"</code> (total test score), or
vector of the same length as number of observations in
<code>Data</code>.</p>
</td></tr>
<tr><td><code id="ddfMLR_+3A_anchor">anchor</code></td>
<td>
<p>numeric or character: specification of DDF free
items. Either <code>NULL</code> (default), or a vector of item names
(column names of <code>Data</code>), or item identifiers (integers
specifying the column number) determining which items are
currently considered as anchor (DDF free) items. Argument is
ignored if <code>match</code> is not <code>"zscore"</code> or <code>"score"</code>.</p>
</td></tr>
<tr><td><code id="ddfMLR_+3A_purify">purify</code></td>
<td>
<p>logical: should the item purification be applied?
(default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="ddfMLR_+3A_nriter">nrIter</code></td>
<td>
<p>numeric: the maximal number of iterations in the item
purification (default is 10).</p>
</td></tr>
<tr><td><code id="ddfMLR_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>character: method for multiple comparison
correction. Possible values are <code>"holm"</code>, <code>"hochberg"</code>,
<code>"hommel"</code>, <code>"bonferroni"</code>, <code>"BH"</code>, <code>"BY"</code>,
<code>"fdr"</code>, and <code>"none"</code> (default). For more details see
<code><a href="stats.html#topic+p.adjust">p.adjust</a></code>.</p>
</td></tr>
<tr><td><code id="ddfMLR_+3A_alpha">alpha</code></td>
<td>
<p>numeric: significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="ddfMLR_+3A_parametrization">parametrization</code></td>
<td>
<p>deprecated. Use
<code><a href="#topic+coef.ddfMLR">coef.ddfMLR</a></code> for different
parameterizations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Performs DDF detection procedure for nominal data based on
multinomial log-linear regression model and likelihood ratio test
of submodel. Probability of selection the <code class="reqn">k</code>-th category
(distractor) is
</p>
<p style="text-align: center;"><code class="reqn">P(y = k) = exp((a_k + a_kDif * g) * (x - b_k - b_kDif * g))) / (1 + \sum exp((a_l + a_lDif * g) * (x - b_l - b_lDif * g))), </code>
</p>

<p>where <code class="reqn">x</code> is by default standardized total score (also called
Z-score) and <code class="reqn">g</code> is a group membership. Parameters <code class="reqn">a_k</code>
and <code class="reqn">b_k</code> are discrimination and difficulty for the <code class="reqn">k</code>-th
category. Terms <code class="reqn">a_kDif</code> and <code class="reqn">b_kDif</code> then represent
differences between two groups (reference and focal) in relevant
parameters. Probability of correct answer (specified in argument
<code>key</code>) is
</p>
<p style="text-align: center;"><code class="reqn">P(y = k) = 1/(1 + \sum exp((a_l + a_lDif * g)*(x - b_l - b_lDif * g))). </code>
</p>

<p>Parameters are estimated via neural networks. For more details see
<code><a href="nnet.html#topic+multinom">multinom</a></code>.
</p>
<p>Missing values are allowed but discarded for item estimation. They
must be coded as <code>NA</code> for both, <code>Data</code> and <code>group</code>
arguments.
</p>


<h3>Value</h3>

<p>The <code>ddfMLR()</code> function returns an object of class
<code>"ddfMLR"</code>. The output including values of the test
statistics, p-values, and items marked as DDF is displayed by the
<code>print()</code> method.
</p>
<p>A list of class <code>"ddfMLR"</code> with the following arguments:
</p>

<dl>
<dt><code>Sval</code></dt><dd><p>the values of likelihood ratio test statistics.</p>
</dd>
<dt><code>mlrPAR</code></dt><dd><p>the estimates of final model.</p>
</dd>
<dt><code>mlrSE</code></dt><dd><p>standard errors of the estimates of final model.</p>
</dd>
<dt><code>parM0</code></dt><dd><p>the estimates of null model.</p>
</dd>
<dt><code>parM1</code></dt><dd><p>the estimates of alternative model.</p>
</dd>
<dt><code>llM0</code></dt><dd><p>log-likelihood of null model.</p>
</dd>
<dt><code>llM1</code></dt><dd><p>log-likelihood of alternative model.</p>
</dd>
<dt><code>AIC0</code></dt><dd><p>AIC of null model.</p>
</dd>
<dt><code>AIC1</code></dt><dd><p>AIC of alternative model.</p>
</dd>
<dt><code>BIC0</code></dt><dd><p>BIC of null model.</p>
</dd>
<dt><code>BIC1</code></dt><dd><p>BIC of alternative model.</p>
</dd>
<dt><code>DDFitems</code></dt><dd><p>either the column identifiers of the items which were detected as DDF, or
<code>"No DDF item detected"</code> in case no item was detected as DDF.</p>
</dd>
<dt><code>type</code></dt><dd><p>character: type of DDF that was tested.</p>
</dd>
<dt><code>purification</code></dt><dd><p><code>purify</code> value.</p>
</dd>
<dt><code>nrPur</code></dt><dd><p>number of iterations in item purification process. Returned only if <code>purify</code>
is <code>TRUE</code>.</p>
</dd>
<dt><code>ddfPur</code></dt><dd><p>a binary matrix with one row per iteration of item purification and one column per item.
<code>"1"</code> in i-th row and j-th column means that j-th item was identified as DDF in i-th iteration. Returned only
if <code>purify</code> is <code>TRUE</code>.</p>
</dd>
<dt><code>conv.puri</code></dt><dd><p>logical indicating whether item purification process converged before the maximal number
<code>nrIter</code> of iterations. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</dd>
<dt><code>p.adjust.method</code></dt><dd><p>character: method for multiple comparison correction which was applied.</p>
</dd>
<dt><code>pval</code></dt><dd><p>the p-values by likelihood ratio test.</p>
</dd>
<dt><code>adj.pval</code></dt><dd><p>the adjusted p-values by likelihood ratio test using <code>p.adjust.method</code>.</p>
</dd>
<dt><code>df</code></dt><dd><p>the degress of freedom of likelihood ratio test.</p>
</dd>
<dt><code>alpha</code></dt><dd><p>numeric: significance level.</p>
</dd>
<dt><code>Data</code></dt><dd><p>the data matrix.</p>
</dd>
<dt><code>group</code></dt><dd><p>the vector of group membership.</p>
</dd>
<dt><code>group.names</code></dt><dd><p>levels of grouping variable.</p>
</dd>
<dt><code>key</code></dt><dd><p>key of correct answers.</p>
</dd>
<dt><code>match</code></dt><dd><p>matching criterion.</p>
</dd>
</dl>

<p>For an object of class <code>"ddfMLR"</code> several methods are available (e.g. <code>methods(class = "ddfMLR")</code>).
</p>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>References</h3>

<p>Agresti, A. (2010). Analysis of ordinal categorical data. Second edition. John Wiley &amp; Sons.
</p>
<p>Hladka, A. (2021). Statistical models for detection of differential item functioning. Dissertation thesis.
Faculty of Mathematics and Physics, Charles University.
</p>
<p>Hladka, A. &amp; Martinkova, P. (2020). difNLR: Generalized logistic regression models for DIF and DDF detection.
The R Journal, 12(1), 300&ndash;323, <a href="https://doi.org/10.32614/RJ-2020-014">doi:10.32614/RJ-2020-014</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.ddfMLR">plot.ddfMLR</a></code> for graphical representation of item characteristic curves. <br />
<code><a href="#topic+coef.ddfMLR">coef.ddfMLR</a></code> for extraction of item parameters with their standard errors. <br />
<code><a href="#topic+logLik.ddfMLR">logLik.ddfMLR</a></code>, <code><a href="#topic+AIC.ddfMLR">AIC.ddfMLR</a></code>, <code><a href="#topic+BIC.ddfMLR">BIC.ddfMLR</a></code>
for extraction of log-likelihood and information criteria. <br />
</p>
<p><code><a href="stats.html#topic+p.adjust">p.adjust</a></code> for multiple comparison corrections. <br />
<code><a href="nnet.html#topic+multinom">multinom</a></code> for estimation function using neural networks.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# loading data
data(GMATtest, GMATkey)
Data &lt;- GMATtest[, 1:20] # items
group &lt;- GMATtest[, "group"] # group membership variable
key &lt;- GMATkey # correct answers

# testing both DDF effects
(x &lt;- ddfMLR(Data, group, focal.name = 1, key))

# graphical devices
plot(x, item = "Item1", group.names = c("Group 1", "Group 2"))
plot(x, item = x$DDFitems)
plot(x, item = 1)

# AIC, BIC, log-likelihood
AIC(x)
BIC(x)
logLik(x)

# AIC, BIC, log-likelihood for the first item
AIC(x, item = 1)
BIC(x, item = 1)
logLik(x, item = 1)

# estimated parameters
coef(x)
coef(x, SE = TRUE)
coef(x, SE = TRUE, simplify = TRUE)

# testing both DDF effects with Benjamini-Hochberg adjustment method
ddfMLR(Data, group, focal.name = 1, key, p.adjust.method = "BH")

# testing both DDF effects with item purification
ddfMLR(Data, group, focal.name = 1, key, purify = TRUE)

# testing uniform DDF effects
ddfMLR(Data, group, focal.name = 1, key, type = "udif")
# testing non-uniform DDF effects
ddfMLR(Data, group, focal.name = 1, key, type = "nudif")

# testing both DDF effects with total score as matching criterion
ddfMLR(Data, group, focal.name = 1, key, match = "score")

## End(Not run)

</code></pre>

<hr>
<h2 id='difNLR'>DIF detection using non-linear regression method.</h2><span id='topic+difNLR'></span>

<h3>Description</h3>

<p>Performs DIF detection procedure for dichotomous data based on non-linear
regression model (generalized logistic regression) and either
likelihood-ratio test, F-test, or Wald's test of a submodel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>difNLR(
  Data, group, focal.name, model, constraints, type = "all", method = "nls",
  match = "zscore", anchor = NULL, purify = FALSE, nrIter = 10, test = "LR",
  alpha = 0.05, p.adjust.method = "none", start, initboot = TRUE, nrBo = 20,
  sandwich = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="difNLR_+3A_data">Data</code></td>
<td>
<p>data.frame or matrix: dataset which rows represent scored
examinee answers (<code>"1"</code> correct, <code>"0"</code> incorrect) and columns
correspond to the items. In addition, <code>Data</code> can hold the vector of
group membership.</p>
</td></tr>
<tr><td><code id="difNLR_+3A_group">group</code></td>
<td>
<p>numeric or character: a dichotomous vector of the same length as
<code>nrow(Data)</code> or a column identifier of <code>Data</code>.</p>
</td></tr>
<tr><td><code id="difNLR_+3A_focal.name">focal.name</code></td>
<td>
<p>numeric or character: indicates the level of <code>group</code>
which corresponds to focal group.</p>
</td></tr>
<tr><td><code id="difNLR_+3A_model">model</code></td>
<td>
<p>character: generalized logistic regression model to be fitted.
See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="difNLR_+3A_constraints">constraints</code></td>
<td>
<p>character: which parameters should be the same for both
groups. Possible values are any combinations of parameters <code>"a"</code>,
<code>"b"</code>, <code>"c"</code>, and <code>"d"</code>. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="difNLR_+3A_type">type</code></td>
<td>
<p>character: type of DIF to be tested. Possible values are
<code>"all"</code> for detecting difference in any parameter (default),
<code>"udif"</code> for uniform DIF only (i.e., difference in difficulty
parameter <code>"b"</code>), <code>"nudif"</code> for non-uniform DIF only (i.e.,
difference in discrimination parameter <code>"a"</code>), <code>"both"</code> for
uniform and non-uniform DIF (i.e., difference in parameters <code>"a"</code> and
<code>"b"</code>), or combination of parameters <code>"a"</code>, <code>"b"</code>,
<code>"c"</code>, and <code>"d"</code>. Can be specified as a single value (for all
items) or as an item-specific vector.</p>
</td></tr>
<tr><td><code id="difNLR_+3A_method">method</code></td>
<td>
<p>character: method used to estimate parameters. The options
are <code>"nls"</code> for non-linear least squares (default),
<code>"likelihood"</code> for maximum likelihood method with <code>"L-BFGS-B"</code>
algorithm, or <code>"irls"</code> for maximum likelihood method with iteratively
reweighted least squares (available only for <code>model = "2PL"</code>).</p>
</td></tr>
<tr><td><code id="difNLR_+3A_match">match</code></td>
<td>
<p>numeric or character: matching criterion to be used as an
estimate of trait. Can be either <code>"zscore"</code> (default, standardized
total score), <code>"score"</code> (total test score), or vector of the same
length as number of observations in <code>Data</code>.</p>
</td></tr>
<tr><td><code id="difNLR_+3A_anchor">anchor</code></td>
<td>
<p>numeric or character: specification of DIF free items. Either
<code>NULL</code> (default), or a vector of item names (column names of
<code>Data</code>), or item identifiers (integers specifying the column number)
determining which items are currently considered as anchor (DIF free)
items. Argument is ignored if <code>match</code> is not <code>"zscore"</code> or
<code>"score"</code>.</p>
</td></tr>
<tr><td><code id="difNLR_+3A_purify">purify</code></td>
<td>
<p>logical: should the item purification be applied? (default is
<code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difNLR_+3A_nriter">nrIter</code></td>
<td>
<p>numeric: the maximal number of iterations in the item
purification (default is 10).</p>
</td></tr>
<tr><td><code id="difNLR_+3A_test">test</code></td>
<td>
<p>character: test to be performed for DIF detection. Can be either
<code>"LR"</code> for likelihood ratio test of a submodel (default), <code>"W"</code>
for Wald test, or <code>"F"</code> for F-test of a submodel.</p>
</td></tr>
<tr><td><code id="difNLR_+3A_alpha">alpha</code></td>
<td>
<p>numeric: significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="difNLR_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>character: method for multiple comparison correction.
Possible values are <code>"holm"</code>, <code>"hochberg"</code>, <code>"hommel"</code>,
<code>"bonferroni"</code>, <code>"BH"</code>, <code>"BY"</code>, <code>"fdr"</code>, and
<code>"none"</code> (default). For more details see
<code><a href="stats.html#topic+p.adjust">p.adjust</a></code>.</p>
</td></tr>
<tr><td><code id="difNLR_+3A_start">start</code></td>
<td>
<p>numeric: initial values for estimation of parameters. If not
specified, starting values are calculated with
<code><a href="#topic+startNLR">startNLR</a></code> function. Otherwise, list with as many
elements as a number of items. Each element is a named numeric vector of
length 8 representing initial values for parameter estimation.
Specifically, parameters <code>"a"</code>, <code>"b"</code>, <code>"c"</code>, and <code>"d"</code>
are initial values for discrimination, difficulty, guessing, and
inattention for reference group. Parameters <code>"aDif"</code>, <code>"bDif"</code>,
<code>"cDif"</code>, and <code>"dDif"</code> are then differences in these parameters
between reference and focal group.</p>
</td></tr>
<tr><td><code id="difNLR_+3A_initboot">initboot</code></td>
<td>
<p>logical: in case of convergence issues, should be starting
values re-calculated based on bootstrapped samples? (default is
<code>TRUE</code>; newly calculated initial values are applied only to
items/models with convergence issues).</p>
</td></tr>
<tr><td><code id="difNLR_+3A_nrbo">nrBo</code></td>
<td>
<p>numeric: the maximal number of iterations for calculation of
starting values using bootstrapped samples (default is 20).</p>
</td></tr>
<tr><td><code id="difNLR_+3A_sandwich">sandwich</code></td>
<td>
<p>logical: should be sandwich estimator used for covariance
matrix of parameters when using <code>method = "nls"</code>? Default is
<code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DIF detection procedure based on non-linear regression is the extension of
the logistic regression procedure (Swaminathan &amp; Rogers, 1990) accounting for
possible guessing and/or inattention when responding (Drabinova &amp; Martinkova,
2017; Hladka &amp; Martinkova, 2020).
</p>
<p>The unconstrained form of 4PL generalized logistic regression model for
probability of correct answer (i.e., <code class="reqn">y = 1</code>) is </p>
<p style="text-align: center;"><code class="reqn">P(y = 1) = (c +
cDif * g) + (d + dDif * g - c - cDif * g) / (1 + exp(-(a + aDif * g) * (x - b
- bDif * g))), </code>
</p>
<p> where <code class="reqn">x</code> is by default standardized total score (also
called Z-score) and <code class="reqn">g</code> is a group membership. Parameters <code class="reqn">a</code>,
<code class="reqn">b</code>, <code class="reqn">c</code>, and <code class="reqn">d</code> are discrimination, difficulty, guessing, and
inattention. Terms <code class="reqn">aDif</code>, <code class="reqn">bDif</code>, <code class="reqn">cDif</code>, and <code class="reqn">dDif</code> then
represent differences between two groups (reference and focal) in relevant
parameters.
</p>
<p>This 4PL model can be further constrained by <code>model</code> and
<code>constraints</code> arguments. The arguments <code>model</code> and
<code>constraints</code> can be also combined. Both arguments can be specified as a
single value (for all items) or as an item-specific vector (where each
element correspond to one item).
</p>
<p>The <code>model</code> argument offers several predefined models. The options are as follows:
<code>Rasch</code> for 1PL model with discrimination parameter fixed on value 1 for both groups,
<code>1PL</code> for 1PL model with discrimination parameter fixed for both groups,
<code>2PL</code> for logistic regression model,
<code>3PLcg</code> for 3PL model with fixed guessing for both groups,
<code>3PLdg</code> for 3PL model with fixed inattention for both groups,
<code>3PLc</code> (alternatively also <code>3PL</code>) for 3PL regression model with guessing parameter,
<code>3PLd</code> for 3PL model with inattention parameter,
<code>4PLcgdg</code> for 4PL model with fixed guessing and inattention parameter for both groups,
<code>4PLcgd</code> (alternatively also <code>4PLd</code>) for 4PL model with fixed guessing for both groups,
<code>4PLcdg</code> (alternatively also <code>4PLc</code>) for 4PL model with fixed inattention for both groups,
or <code>4PL</code> for 4PL model.
</p>
<p>The <code>model</code> can be specified in more detail with <code>constraints</code>
argument which specifies what parameters should be fixed for both groups. For
example, choice <code>"ad"</code> means that discrimination (parameter <code>"a"</code>)
and inattention (parameter <code>"d"</code>) are fixed for both groups and other
parameters (<code>"b"</code> and <code>"c"</code>) are not. The <code>NA</code> value for
<code>constraints</code> means no constraints.
</p>
<p>Missing values are allowed but discarded for item estimation. They must be
coded as <code>NA</code> for both, <code>Data</code> and <code>group</code> arguments.
</p>
<p>In case that model considers difference in guessing or inattention parameter,
the different parameterization is used and parameters with standard errors
are re-calculated by delta method. However, covariance matrices stick with
alternative parameterization.
</p>


<h3>Value</h3>

<p>The <code>difNLR()</code> function returns an object of class <code>"difNLR"</code>. The
output including values of the test statistics, p-values, and items detected
as function differently is displayed by the <code>print()</code> method.
</p>
<p>Object of class <code>"difNLR"</code> is a list with the following components:
</p>

<dl>
<dt><code>Sval</code></dt><dd><p>the values of the test statistics.</p>
</dd>
<dt><code>nlrPAR</code></dt><dd><p>the estimates of final model.</p>
</dd>
<dt><code>nlrSE</code></dt><dd><p>the standard errors of estimates of final model.</p>
</dd>
<dt><code>parM0</code></dt><dd><p>the estimates of null model.</p>
</dd>
<dt><code>seM0</code></dt><dd><p>the standard errors of estimates of null model.</p>
</dd>
<dt><code>covM0</code></dt><dd><p>the covariance matrices of estimates of null model.</p>
</dd>
<dt><code>llM0</code></dt><dd><p>log-likelihood of null model.</p>
</dd>
<dt><code>parM1</code></dt><dd><p>the estimates of alternative model.</p>
</dd>
<dt><code>seM1</code></dt><dd><p>the standard errors of estimates of alternative model.</p>
</dd>
<dt><code>covM1</code></dt><dd><p>the covariance matrices of estimates of alternative model.</p>
</dd>
<dt><code>llM1</code></dt><dd><p>log-likelihood of alternative model.</p>
</dd>
<dt><code>DIFitems</code></dt><dd><p>either the column identifiers of the items which were detected as DIF, or
<code>"No DIF item detected"</code> in case no item was detected as function differently.</p>
</dd>
<dt><code>model</code></dt><dd><p>fitted model.</p>
</dd>
<dt><code>constraints</code></dt><dd><p>constraints for the <code>model</code>.</p>
</dd>
<dt><code>type</code></dt><dd><p>character: type of DIF that was tested. If parameters were specified, the value is <code>"other"</code>.</p>
</dd>
<dt><code>types</code></dt><dd><p>character: the parameters (specified by user, <code>type</code> has value <code>"other"</code>) which were
tested for difference.</p>
</dd>
<dt><code>p.adjust.method</code></dt><dd><p>character: method for multiple comparison correction which was applied.</p>
</dd>
<dt><code>pval</code></dt><dd><p>the p-values of the test.</p>
</dd>
<dt><code>adj.pval</code></dt><dd><p>the adjusted p-values of the test using <code>p.adjust.method</code>.</p>
</dd>
<dt><code>df</code></dt><dd><p>the degress of freedom of the test.</p>
</dd>
<dt><code>test</code></dt><dd><p>used test.</p>
</dd>
<dt><code>purification</code></dt><dd><p><code>purify</code> value.</p>
</dd>
<dt><code>nrPur</code></dt><dd><p>number of iterations in item purification process. Returned only if <code>purify</code>
is <code>TRUE</code>.</p>
</dd>
<dt><code>difPur</code></dt><dd><p>a binary matrix with one row per iteration of item purification and one column per item.
<code>"1"</code> in i-th row and j-th column means that j-th item was identified as DIF in i-th iteration. Returned only
if <code>purify</code> is <code>TRUE</code>.</p>
</dd>
<dt><code>conv.puri</code></dt><dd><p>logical: indicating whether item purification process converged before the maximal number
<code>nrIter</code> of iterations. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</dd>
<dt><code>method</code></dt><dd><p>used estimation method.</p>
</dd>
<dt><code>conv.fail</code></dt><dd><p>numeric: number of convergence issues.</p>
</dd>
<dt><code>conv.fail.which</code></dt><dd><p>the identifiers of the items which did not converge.</p>
</dd>
<dt><code>alpha</code></dt><dd><p>numeric: significance level.</p>
</dd>
<dt><code>Data</code></dt><dd><p>the data matrix.</p>
</dd>
<dt><code>group</code></dt><dd><p>the vector of group membership.</p>
</dd>
<dt><code>group.names</code></dt><dd><p>names of groups.</p>
</dd>
<dt><code>match</code></dt><dd><p>matching criterion.</p>
</dd>
</dl>

<p>For an object of class <code>"difNLR"</code> several methods are available (e.g.,
<code>methods(class = "difNLR")</code>).
</p>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>
<p>Karel Zvara <br />
Faculty of Mathematics and Physics, Charles University <br />
</p>


<h3>References</h3>

<p>Drabinova, A. &amp; Martinkova, P. (2017). Detection of differential item
functioning with nonlinear regression: A non-IRT approach accounting for
guessing. Journal of Educational Measurement, 54(4), 498&ndash;517,
<a href="https://doi.org/10.1111/jedm.12158">doi:10.1111/jedm.12158</a>.
</p>
<p>Hladka, A. (2021). Statistical models for detection of differential item functioning. Dissertation thesis.
Faculty of Mathematics and Physics, Charles University.
</p>
<p>Hladka, A. &amp; Martinkova, P. (2020). difNLR: Generalized logistic regression
models for DIF and DDF detection. The R Journal, 12(1), 300&ndash;323,
<a href="https://doi.org/10.32614/RJ-2020-014">doi:10.32614/RJ-2020-014</a>.
</p>
<p>Swaminathan, H. &amp; Rogers, H. J. (1990). Detecting differential item
functioning using logistic regression procedures. Journal of Educational
Measurement, 27(4), 361&ndash;370, <a href="https://doi.org/10.1111/j.1745-3984.1990.tb00754.x">doi:10.1111/j.1745-3984.1990.tb00754.x</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.difNLR">plot.difNLR</a></code> for graphical representation of item characteristic curves and DIF statistics. <br />
<code><a href="#topic+coef.difNLR">coef.difNLR</a></code> for extraction of item parameters with their standard errors. <br />
<code><a href="#topic+predict.difNLR">predict.difNLR</a></code> for prediction. <br />
<code><a href="#topic+fitted.difNLR">fitted.difNLR</a></code> and <code><a href="#topic+residuals.difNLR">residuals.difNLR</a></code> for extraction of fitted
values and residuals. <br />
<code><a href="#topic+logLik.difNLR">logLik.difNLR</a></code>, <code><a href="#topic+AIC.difNLR">AIC.difNLR</a></code>, <code><a href="#topic+BIC.difNLR">BIC.difNLR</a></code>
for extraction of log-likelihood and information criteria. <br />
</p>
<p><code><a href="stats.html#topic+p.adjust">p.adjust</a></code> for multiple comparison corrections. <br />
<code><a href="stats.html#topic+nls">nls</a></code> for nonlinear least squares estimation. <br />
<code><a href="#topic+startNLR">startNLR</a></code> for calculation of initial values of fitting algorithms in <code>difNLR()</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># loading data
data(GMAT)
Data &lt;- GMAT[, 1:20] # items
group &lt;- GMAT[, "group"] # group membership variable

# testing both DIF effects using likelihood-ratio test and
# 3PL model with fixed guessing for groups
(x &lt;- difNLR(Data, group, focal.name = 1, model = "3PLcg"))
## Not run: 
# graphical devices
plot(x, item = x$DIFitems)
plot(x, item = "Item1")
plot(x, item = 1, group.names = c("Group 1", "Group 2"))
plot(x, plot.type = "stat")

# coefficients
coef(x)
coef(x, SE = TRUE)
coef(x, SE = TRUE, simplify = TRUE)

# fitted values
fitted(x)
fitted(x, item = 1)

# residuals
residuals(x)
residuals(x, item = 1)

# predicted values
predict(x)
predict(x, item = 1)

# predicted values for new subjects
predict(x, item = 1, match = 0, group = 0)
predict(x, item = 1, match = 0, group = 1)

# AIC, BIC, log-likelihood
AIC(x)
BIC(x)
logLik(x)

# AIC, BIC, log-likelihood for the first item
AIC(x, item = 1)
BIC(x, item = 1)
logLik(x, item = 1)

# testing both DIF effects using Wald test and
# 3PL model with fixed guessing for groups
difNLR(Data, group, focal.name = 1, model = "3PLcg", test = "W")

# testing both DIF effects using F test and
# 3PL model with fixed guessing for groups
difNLR(Data, group, focal.name = 1, model = "3PLcg", test = "F")

# testing both DIF effects using
# 3PL model with fixed guessing for groups and sandwich estimator
# of the covariance matrices
difNLR(Data, group, focal.name = 1, model = "3PLcg", sandwich = TRUE)

# testing both DIF effects using LR test,
# 3PL model with fixed guessing for groups
# and Benjamini-Hochberg correction
difNLR(Data, group, focal.name = 1, model = "3PLcg", p.adjust.method = "BH")

# testing both DIF effects using LR test,
# 3PL model with fixed guessing for groups
# and item purification
difNLR(Data, group, focal.name = 1, model = "3PLcg", purify = TRUE)

# testing both DIF effects using 3PL model with fixed guessing for groups
# and total score as matching criterion
difNLR(Data, group, focal.name = 1, model = "3PLcg", match = "score")

# testing uniform DIF effects using 4PL model with the same
# guessing and inattention
difNLR(Data, group, focal.name = 1, model = "4PLcgdg", type = "udif")

# testing non-uniform DIF effects using 2PL model
difNLR(Data, group, focal.name = 1, model = "2PL", type = "nudif")

# testing difference in parameter b using 4PL model with fixed
# a and c parameters
difNLR(Data, group, focal.name = 1, model = "4PL", constraints = "ac", type = "b")

# testing both DIF effects using LR test,
# 3PL model with fixed guessing for groups
# using maximum likelihood estimation method with L-BFGS-B algorithm
difNLR(Data, group, focal.name = 1, model = "3PLcg", method = "likelihood")

# testing both DIF effects using LR test and 2PL model
# using maximum likelihood estimation method with iteratively reweighted least squares algorithm
difNLR(Data, group, focal.name = 1, model = "2PL", method = "irls")

## End(Not run)

</code></pre>

<hr>
<h2 id='difNLR-package'>DIF and DDF Detection by Non-Linear Regression Models.</h2><span id='topic+difNLR-package'></span><span id='topic+_PACKAGE'></span>

<h3>Description</h3>

<p>The difNLR package contains method for detection of differential
item functioning (DIF) based on non-linear regression. Both uniform and
non-uniform DIF effects can be detected when considering one focal group.
The method also allows to test the difference in guessing or inattention
parameters between reference and focal group. DIF detection method is based
either on likelihood-ratio test, F-test, or Wald's test of a submodel.
Package also offers methods for detection of differential distractor
functioning (DDF) based on multinomial log-linear regression model and
newly methods for DIF detection among ordinal data via adjacent category
logit and cumulative logit regression models.
</p>


<h3>Details</h3>

<p>Package: difNLR<br />
Type: Package<br />
Version: 1.4.2-1<br />
Date: 2023-05-03<br />
Depends: R (&gt;= 3.1)<br />
Imports: calculus, ggplot2 (&gt;= 3.4.0), msm, nnet, plyr, stats, VGAM<br />
Suggests: ShinyItemAnalysis<br />
License: GPL-3<br />
BugReports: <a href="https://github.com/adelahladka/difNLR/issues">https://github.com/adelahladka/difNLR/issues</a><br />
Encoding: UTF-8<br />
</p>


<h3>Functions</h3>


<ul>
<li> <p><code><a href="#topic+ddfMLR">ddfMLR</a></code>
</p>
</li>
<li> <p><code><a href="#topic+difNLR">difNLR</a></code>
</p>
</li>
<li> <p><code><a href="#topic+difORD">difORD</a></code>
</p>
</li>
<li> <p><code><a href="#topic+estimNLR">estimNLR</a></code>
</p>
</li>
<li> <p><code><a href="#topic+formulaNLR">formulaNLR</a></code>
</p>
</li>
<li> <p><code><a href="#topic+MLR">MLR</a></code>
</p>
</li>
<li> <p><code><a href="#topic+NLR">NLR</a></code>
</p>
</li>
<li> <p><code><a href="#topic+ORD">ORD</a></code>
</p>
</li>
<li> <p><code><a href="#topic+startNLR">startNLR</a></code>
</p>
</li></ul>



<h3>Datasets</h3>


<ul>
<li> <p><code><a href="#topic+GMAT">GMAT</a></code>
</p>
</li>
<li> <p><code><a href="#topic+GMAT2">GMAT2</a></code>
</p>
</li>
<li> <p><code><a href="#topic+MSATB">MSATB</a></code>
</p>
</li></ul>



<h3>Note</h3>

<p>This package was supported by grant funded by Czech Science foundation under number GJ15-15856Y.
</p>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>References</h3>

<p>Agresti, A. (2010). Analysis of ordinal categorical data. Second edition. John Wiley &amp; Sons.
</p>
<p>Drabinova, A. &amp; Martinkova, P. (2017). Detection of differential item functioning with nonlinear regression:
A non-IRT approach accounting for guessing. Journal of Educational Measurement, 54(4), 498&ndash;517,
<a href="https://doi.org/10.1111/jedm.12158">doi:10.1111/jedm.12158</a>.
</p>
<p>Hladka, A. (2021). Statistical models for detection of differential item functioning. Dissertation thesis.
Faculty of Mathematics and Physics, Charles University.
</p>
<p>Hladka, A. &amp; Martinkova, P. (2020). difNLR: Generalized logistic regression models for DIF and DDF detection.
The R Journal, 12(1), 300&ndash;323, <a href="https://doi.org/10.32614/RJ-2020-014">doi:10.32614/RJ-2020-014</a>.
</p>
<p>Kingston, N., Leary, L., &amp; Wightman, L. (1985). An exploratory study of the applicability of item response theory
methods to the Graduate Management Admission Test. ETS Research Report Series, 1985(2): 1&ndash;64.
</p>
<p>Martinkova, P., Drabinova, A., Liaw, Y. L., Sanders, E. A., McFarland, J. L., &amp; Price, R. M. (2017).
Checking equity: Why differential item functioning analysis should be a routine part of developing conceptual
assessments. CBE&ndash;Life Sciences Education, 16(2), rm2, <a href="https://doi.org/10.1187/cbe.16-10-0307">doi:10.1187/cbe.16-10-0307</a>.
</p>
<p>Swaminathan, H. &amp; Rogers, H. J. (1990). Detecting differential item functioning using logistic regression procedures.
Journal of Educational Measurement, 27(4), 361&ndash;370, <a href="https://doi.org/10.1111/j.1745-3984.1990.tb00754.x">doi:10.1111/j.1745-3984.1990.tb00754.x</a>
</p>
<p>Vlckova, K. (2014). Test and item fairness. Master's thesis. Faculty of Mathematics and Physics, Charles University.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li><p> Report bugs at <a href="https://github.com/adelahladka/difNLR/issues">https://github.com/adelahladka/difNLR/issues</a>
</p>
</li></ul>


<hr>
<h2 id='difORD'>DIF detection among ordinal data.</h2><span id='topic+difORD'></span>

<h3>Description</h3>

<p>Performs DIF detection procedure for ordinal data
based either on adjacent category logit model or on cumulative
logit model and likelihood ratio test of a submodel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>difORD(Data, group, focal.name, model = "adjacent", type = "both", match = "zscore",
       anchor = NULL, purify = FALSE, nrIter = 10, p.adjust.method = "none",
       alpha = 0.05, parametrization)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="difORD_+3A_data">Data</code></td>
<td>
<p>data.frame or matrix: dataset which rows represent
ordinaly scored examinee answers and columns correspond to the
items. In addition, <code>Data</code> can hold the vector of group
membership.</p>
</td></tr>
<tr><td><code id="difORD_+3A_group">group</code></td>
<td>
<p>numeric or character: a dichotomous vector of the same
length as <code>nrow(Data)</code> or a column identifier of
<code>Data</code>.</p>
</td></tr>
<tr><td><code id="difORD_+3A_focal.name">focal.name</code></td>
<td>
<p>numeric or character: indicates the level of
<code>group</code> which corresponds to focal group.</p>
</td></tr>
<tr><td><code id="difORD_+3A_model">model</code></td>
<td>
<p>character: logistic regression model for ordinal data
(either <code>"adjacent"</code> (default) or <code>"cumulative"</code>). See
<strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="difORD_+3A_type">type</code></td>
<td>
<p>character: type of DIF to be tested. Either
<code>"both"</code> for uniform and non-uniform DIF (default), or
<code>"udif"</code> for uniform DIF only, or <code>"nudif"</code> for
non-uniform DIF only. Can be specified as a single value (for all
items) or as an item-specific vector.</p>
</td></tr>
<tr><td><code id="difORD_+3A_match">match</code></td>
<td>
<p>numeric or character: matching criterion to be used as
an estimate of trait. Can be either <code>"zscore"</code> (default,
standardized total score), <code>"score"</code> (total test score), or
vector of the same length as number of observations in
<code>Data</code>.</p>
</td></tr>
<tr><td><code id="difORD_+3A_anchor">anchor</code></td>
<td>
<p>numeric or character: specification of DIF free
items. Either <code>NULL</code> (default), or a vector of item names
(column names of <code>Data</code>), or item identifiers (integers
specifying the column number) determining which items are
currently considered as anchor (DIF free) items. Argument is
ignored if <code>match</code> is not <code>"zscore"</code> or <code>"score"</code>.</p>
</td></tr>
<tr><td><code id="difORD_+3A_purify">purify</code></td>
<td>
<p>logical: should the item purification be applied?
(default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="difORD_+3A_nriter">nrIter</code></td>
<td>
<p>numeric: the maximal number of iterations in the item
purification (default is 10).</p>
</td></tr>
<tr><td><code id="difORD_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>character: method for multiple comparison
correction. Possible values are <code>"holm"</code>, <code>"hochberg"</code>,
<code>"hommel"</code>, <code>"bonferroni"</code>, <code>"BH"</code>, <code>"BY"</code>,
<code>"fdr"</code>, and <code>"none"</code> (default). For more details see
<code><a href="stats.html#topic+p.adjust">p.adjust</a></code>.</p>
</td></tr>
<tr><td><code id="difORD_+3A_alpha">alpha</code></td>
<td>
<p>numeric: significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="difORD_+3A_parametrization">parametrization</code></td>
<td>
<p>deprecated. Use
<code><a href="#topic+coef.difORD">coef.difORD</a></code> for different
parameterizations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates DIF likelihood ratio statistics based either on adjacent
category logit model or on cumulative logit model for ordinal data.
</p>
<p>Using adjacent category logit model, logarithm of ratio of
probabilities of two adjacent categories is
</p>
<p style="text-align: center;"><code class="reqn">log(P(y = k) / P(y = k - 1)) = b_0k + b_1 * x + b_2k * g + b_3 * x:g,</code>
</p>

<p>where <code class="reqn">x</code> is by default standardized total score (also called
Z-score) and <code class="reqn">g</code> is a group membership.
</p>
<p>Using cumulative logit model, probability of gaining at least
<code class="reqn">k</code> points is given by 2PL model, i.e.,
</p>
<p style="text-align: center;"><code class="reqn">P(y &gt;= k) = exp(b_0k + b_1 * x + b_2k * g + b_3 * x:g) / (1 + exp(b_0k + b_1 * x + b_2k * g + b_3 * x:g)).</code>
</p>

<p>The category probability (i.e., probability of gaining exactly
<code class="reqn">k</code> points) is then <code class="reqn">P(y = k) = P(y &gt;= k) - P(y &gt;= k + 1)</code>.
</p>
<p>Both models are estimated by iteratively reweighted least squares.
For more details see <code><a href="VGAM.html#topic+vglm">vglm</a></code>.
</p>
<p>Missing values are allowed but discarded for item estimation. They
must be coded as <code>NA</code> for both, <code>Data</code> and <code>group</code>
parameters.
</p>


<h3>Value</h3>

<p>The <code>difORD()</code> function returns an object of class
<code>"difORD"</code>. The output including values of the test
statistics, p-values, and items marked as DIF is displayed by the
<code>print()</code> method.
</p>
<p>A list of class <code>"difORD"</code> with the following arguments:
</p>

<dl>
<dt><code>Sval</code></dt><dd><p>the values of likelihood ratio test statistics.</p>
</dd>
<dt><code>ordPAR</code></dt><dd><p>the estimates of the final model.</p>
</dd>
<dt><code>ordSE</code></dt><dd><p>standard errors of the estimates of the final model.</p>
</dd>
<dt><code>parM0</code></dt><dd><p>the estimates of null model.</p>
</dd>
<dt><code>parM1</code></dt><dd><p>the estimates of alternative model.</p>
</dd>
<dt><code>llM0</code></dt><dd><p>log-likelihood of null model.</p>
</dd>
<dt><code>llM1</code></dt><dd><p>log-likelihood of alternative model.</p>
</dd>
<dt><code>AICM0</code></dt><dd><p>AIC of null model.</p>
</dd>
<dt><code>AICM1</code></dt><dd><p>AIC of alternative model.</p>
</dd>
<dt><code>BICM0</code></dt><dd><p>BIC of null model.</p>
</dd>
<dt><code>BICM1</code></dt><dd><p>BIC of alternative model.</p>
</dd>
<dt><code>DIFitems</code></dt><dd><p>either the column identifiers of the items which were detected as DIF, or
<code>"No DIF item detected"</code> in case no item was detected as DIF.</p>
</dd>
<dt><code>model</code></dt><dd><p>model used for DIF detection.</p>
</dd>
<dt><code>type</code></dt><dd><p>character: type of DIF that was tested.</p>
</dd>
<dt><code>purification</code></dt><dd><p><code>purify</code> value.</p>
</dd>
<dt><code>nrPur</code></dt><dd><p>number of iterations in item purification process. Returned only if <code>purify</code>
is <code>TRUE</code>.</p>
</dd>
<dt><code>difPur</code></dt><dd><p>a binary matrix with one row per iteration of item purification and one column per item.
<code>"1"</code> in i-th row and j-th column means that j-th item was identified as DIF in i-th iteration. Returned only
if <code>purify</code> is <code>TRUE</code>.</p>
</dd>
<dt><code>conv.puri</code></dt><dd><p>logical indicating whether item purification process converged before the maximal number
<code>nrIter</code> of iterations. Returned only if <code>purify</code> is <code>TRUE</code>.</p>
</dd>
<dt><code>p.adjust.method</code></dt><dd><p>character: method for multiple comparison correction which was applied.</p>
</dd>
<dt><code>pval</code></dt><dd><p>the p-values by likelihood ratio test.</p>
</dd>
<dt><code>adj.pval</code></dt><dd><p>the adjusted p-values by likelihood ratio test using <code>p.adjust.method</code>.</p>
</dd>
<dt><code>df</code></dt><dd><p>the degress of freedom of likelihood ratio test.</p>
</dd>
<dt><code>alpha</code></dt><dd><p>numeric: significance level.</p>
</dd>
<dt><code>Data</code></dt><dd><p>the data matrix.</p>
</dd>
<dt><code>group</code></dt><dd><p>the vector of group membership.</p>
</dd>
<dt><code>group.names</code></dt><dd><p>levels of grouping variable.</p>
</dd>
<dt><code>match</code></dt><dd><p>matching criterion.</p>
</dd>
</dl>

<p>For an object of class <code>"difORD"</code> several methods are available (e.g., <code>methods(class = "difORD")</code>).
</p>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>References</h3>

<p>Agresti, A. (2010). Analysis of ordinal categorical data. Second edition. John Wiley &amp; Sons.
</p>
<p>Hladka, A. (2021). Statistical models for detection of differential item functioning. Dissertation thesis.
Faculty of Mathematics and Physics, Charles University.
</p>
<p>Hladka, A. &amp; Martinkova, P. (2020). difNLR: Generalized logistic regression models for DIF and DDF detection.
The R Journal, 12(1), 300&ndash;323, <a href="https://doi.org/10.32614/RJ-2020-014">doi:10.32614/RJ-2020-014</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.difORD">plot.difORD</a></code> for graphical representation of item characteristic curves. <br />
<code><a href="#topic+coef.difORD">coef.difORD</a></code> for extraction of item parameters with their standard errors. <br />
<code><a href="#topic+predict.difORD">predict.difORD</a></code> for calculation of predicted values. <br />
<code><a href="#topic+logLik.difORD">logLik.difORD</a></code>, <code><a href="#topic+AIC.difORD">AIC.difORD</a></code>, <code><a href="#topic+BIC.difORD">BIC.difORD</a></code>
for extraction of log-likelihood and information criteria. <br />
</p>
<p><code><a href="stats.html#topic+p.adjust">p.adjust</a></code> for multiple comparison corrections. <br />
<code><a href="VGAM.html#topic+vglm">vglm</a></code> for estimation function using iteratively reweighted least squares.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># loading data
data(Anxiety, package = "ShinyItemAnalysis")
Data &lt;- Anxiety[, paste0("R", 1:29)] # items
group &lt;- Anxiety[, "gender"] # group membership variable

# testing both DIF effects with adjacent category logit model
(x &lt;- difORD(Data, group, focal.name = 1, model = "adjacent"))
## Not run: 
# graphical devices
plot(x, item = 6)
plot(x, item = "R6")
plot(x, item = "R6", group.names = c("Males", "Females"))

# estimated parameters
coef(x)
coef(x, SE = TRUE) # with SE
coef(x, SE = TRUE, simplify = TRUE) # with SE, simplified

# AIC, BIC, log-likelihood
AIC(x)
BIC(x)
logLik(x)

# AIC, BIC, log-likelihood for the first item
AIC(x, item = 1)
BIC(x, item = 1)
logLik(x, item = 1)

# testing both DIF effects with Benjamini-Hochberg adjustment method
difORD(Data, group, focal.name = 1, model = "adjacent", p.adjust.method = "BH")

# testing both DIF effects with item purification
difORD(Data, group, focal.name = 1, model = "adjacent", purify = TRUE)

# testing uniform DIF effects
difORD(Data, group, focal.name = 1, model = "adjacent", type = "udif")
# testing non-uniform DIF effects
difORD(Data, group, focal.name = 1, model = "adjacent", type = "nudif")

# testing both DIF effects with total score as matching criterion
difORD(Data, group, focal.name = 1, model = "adjacent", match = "score")

testing both DIF effects with cumulative logit model
(x &lt;- difORD(Data, group, focal.name = 1, model = "cumulative"))
# graphical devices
plot(x, item = 7, plot.type = "cumulative")
plot(x, item = 7, plot.type = "category")

# estimated parameters
coef(x, simplify = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='estimNLR'>Non-Linear Regression DIF models estimation.</h2><span id='topic+estimNLR'></span><span id='topic+print.estimNLR'></span><span id='topic+vcov.estimNLR'></span>

<h3>Description</h3>

<p>Estimates parameters of non-linear regression models
for DIF detection using either non-linear least squares or
maximum likelihood method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimNLR(y, match, group, formula, method, lower, upper, start)

## S3 method for class 'estimNLR'
print(x, ...)

## S3 method for class 'estimNLR'
vcov(object, sandwich = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimNLR_+3A_y">y</code></td>
<td>
<p>numeric: binary vector of responses.</p>
</td></tr>
<tr><td><code id="estimNLR_+3A_match">match</code></td>
<td>
<p>numeric: vector of matching criterion.</p>
</td></tr>
<tr><td><code id="estimNLR_+3A_group">group</code></td>
<td>
<p>numeric: binary vector of group membership. <code>"0"</code> for reference group, <code>"1"</code> for focal group.</p>
</td></tr>
<tr><td><code id="estimNLR_+3A_formula">formula</code></td>
<td>
<p>formula: specification of the model. Can be obtained by <code>formulaNLR()</code> function.</p>
</td></tr>
<tr><td><code id="estimNLR_+3A_method">method</code></td>
<td>
<p>character: method used to estimate parameters. The options are <code>"nls"</code> for non-linear least
squares (default), <code>"likelihood"</code> for maximum likelihood method, and <code>"irls"</code> for maximum likelihood
estimation with iteratively reweighted least squares. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="estimNLR_+3A_lower">lower</code></td>
<td>
<p>numeric: lower bounds for parameters of model specified in <code>formula</code>.</p>
</td></tr>
<tr><td><code id="estimNLR_+3A_upper">upper</code></td>
<td>
<p>numeric: upper bounds for parameters of model specified in <code>formula</code>.</p>
</td></tr>
<tr><td><code id="estimNLR_+3A_start">start</code></td>
<td>
<p>numeric: initial parameters. Can be obtained by <code>startNLR()</code> function.</p>
</td></tr>
<tr><td><code id="estimNLR_+3A_x">x</code></td>
<td>
<p>an object of <code>"estimNLR"</code> class.</p>
</td></tr>
<tr><td><code id="estimNLR_+3A_...">...</code></td>
<td>
<p>other generic parameters for S3 methods.</p>
</td></tr>
<tr><td><code id="estimNLR_+3A_object">object</code></td>
<td>
<p>an object of <code>"estimNLR"</code> class.</p>
</td></tr>
<tr><td><code id="estimNLR_+3A_sandwich">sandwich</code></td>
<td>
<p>logical: should be sandwich estimator used for covariance
matrix of parameters when using <code>method = "nls"</code>? Default is
<code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function offers either non-linear least squares estimation via
<code><a href="stats.html#topic+nls">nls</a></code> function, maximum likelihood method with
<code>"L-BFGS-B"</code> method via <code><a href="stats.html#topic+optim">optim</a></code> function,
or maximum likelihood method with iteratively reweighted least
squares via <code><a href="stats.html#topic+glm">glm</a></code> function.
</p>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>References</h3>

<p>Hladka, A. (2021). Statistical models for detection of differential
item functioning. Dissertation thesis. Faculty of Mathematics and
Physics, Charles University.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># loading data
data(GMAT)
y &lt;- GMAT[, 1] # item 1
match &lt;- scale(rowSums(GMAT[, 1:20])) # standardized total score
group &lt;- GMAT[, "group"] # group membership variable

# formula for 3PL model with the same guessing
M &lt;- formulaNLR(model = "3PLcg", type = "both")

# starting values for 3PL model with the same guessing for item 1
start &lt;- startNLR(GMAT[, 1:20], group, model = "3PLcg", parameterization = "classic")
start &lt;- start[[1]][M$M0$parameters]

# non-linear least squares
fitNLSM0 &lt;- estimNLR(
  y = y, match = match, group = group,
  formula = M$M0$formula, method = "nls",
  lower = M$M0$lower, upper = M$M0$upper, start = start
)
fitNLSM0

coef(fitNLSM0)
logLik(fitNLSM0)
vcov(fitNLSM0)
vcov(fitNLSM0, sandwich = TRUE)
fitted(fitNLSM0)
residuals(fitNLSM0)

# maximum likelihood method
fitLKLM0 &lt;- estimNLR(
  y = y, match = match, group = group,
  formula = M$M0$formula, method = "likelihood",
  lower = M$M0$lower, upper = M$M0$upper, start = start
)
fitLKLM0

coef(fitLKLM0)
logLik(fitLKLM0)
vcov(fitLKLM0)
fitted(fitLKLM0)
residuals(fitLKLM0)

# iteratively reweighted least squares for 2PL model
M &lt;- formulaNLR(model = "2PL", parameterization = "logistic")
fitIRLSM1 &lt;- estimNLR(
  y = y, match = match, group = group,
  formula = M$M1$formula, method = "irls"
)
fitIRLSM1

coef(fitIRLSM1)
logLik(fitIRLSM1)
vcov(fitIRLSM1)
fitted(fitIRLSM1)
residuals(fitIRLSM1)
</code></pre>

<hr>
<h2 id='fitted.difNLR'>Fitted values and residuals for an object of <code>"difNLR"</code> class.</h2><span id='topic+fitted.difNLR'></span><span id='topic+residuals.difNLR'></span><span id='topic+resid.difNLR'></span>

<h3>Description</h3>

<p>S3 methods for extracting fitted values and residuals for an object of <code>"difNLR"</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'difNLR'
fitted(object, item = "all", ...)

## S3 method for class 'difNLR'
residuals(object, item = "all", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.difNLR_+3A_object">object</code></td>
<td>
<p>an object of <code>"difNLR"</code> class.</p>
</td></tr>
<tr><td><code id="fitted.difNLR_+3A_item">item</code></td>
<td>
<p>numeric or character: either character <code>"all"</code> to apply for all converged items (default),
or a vector of item names (column names of <code>Data</code>), or item identifiers (integers specifying
the column number).</p>
</td></tr>
<tr><td><code id="fitted.difNLR_+3A_...">...</code></td>
<td>
<p>other generic parameters for S3 methods.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>
<p>Karel Zvara <br />
Faculty of Mathematics and Physics, Charles University <br />
</p>


<h3>References</h3>

<p>Drabinova, A. &amp; Martinkova, P. (2017). Detection of differential item functioning with nonlinear regression:
A non-IRT approach accounting for guessing. Journal of Educational Measurement, 54(4), 498&ndash;517,
<a href="https://doi.org/10.1111/jedm.12158">doi:10.1111/jedm.12158</a>.
</p>
<p>Hladka, A. &amp; Martinkova, P. (2020). difNLR: Generalized logistic regression models for DIF and DDF detection.
The R Journal, 12(1), 300&ndash;323, <a href="https://doi.org/10.32614/RJ-2020-014">doi:10.32614/RJ-2020-014</a>.
</p>
<p>Swaminathan, H. &amp; Rogers, H. J. (1990). Detecting differential item functioning using logistic regression procedures.
Journal of Educational Measurement, 27(4), 361&ndash;370, <a href="https://doi.org/10.1111/j.1745-3984.1990.tb00754.x">doi:10.1111/j.1745-3984.1990.tb00754.x</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difNLR">difNLR</a></code> for DIF detection among binary data using generalized logistic regression model. <br />
<code><a href="stats.html#topic+fitted">fitted</a></code> for generic function extracting fitted values. <br />
<code><a href="stats.html#topic+residuals">residuals</a></code> for generic function extracting residuals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# loading data
data(GMAT)
Data &lt;- GMAT[, 1:20] # items
group &lt;- GMAT[, "group"] # group membership variable

# testing both DIF effects using likelihood-ratio test and
# 3PL model with fixed guessing for groups
(x &lt;- difNLR(Data, group, focal.name = 1, model = "3PLcg"))

# fitted values
fitted(x)
fitted(x, item = 1)

# residuals
residuals(x)
residuals(x, item = 1)

## End(Not run)
</code></pre>

<hr>
<h2 id='formulaNLR'>Formula for non-linear regression DIF model.</h2><span id='topic+formulaNLR'></span>

<h3>Description</h3>

<p>Function returns the formula of the non-linear regression DIF model
based on model specification and DIF type to be tested.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formulaNLR(model, constraints = NULL, type = "all", parameterization = "classic", outcome)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formulaNLR_+3A_model">model</code></td>
<td>
<p>character: generalized logistic regression model for which starting values should be
estimated. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="formulaNLR_+3A_constraints">constraints</code></td>
<td>
<p>character: which parameters should be the same for both groups. Possible values
are any combinations of parameters <code>"a"</code>, <code>"b"</code>, <code>"c"</code>, and <code>"d"</code>. Default value
is <code>NULL</code>. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="formulaNLR_+3A_type">type</code></td>
<td>
<p>character: type of DIF to be tested. Possible values are <code>"all"</code> for detecting
difference in any parameter (default), <code>"udif"</code> for uniform DIF only (i.e., difference in
difficulty parameter <code>"b"</code>), <code>"nudif"</code> for non-uniform DIF only (i.e., difference in
discrimination parameter <code>"a"</code>), <code>"both"</code> for uniform and non-uniform DIF (i.e.,
difference in parameters <code>"a"</code> and <code>"b"</code>), or combination of parameters <code>"a"</code>,
<code>"b"</code>, <code>"c"</code>, and <code>"d"</code>. Can be specified as a single value (for all items) or as
an item-specific vector.</p>
</td></tr>
<tr><td><code id="formulaNLR_+3A_parameterization">parameterization</code></td>
<td>
<p>character: parameterization of regression
coefficients. Possible options are <code>"classic"</code> (IRT parameterization),
<code>"alternative"</code> (default) and <code>"logistic"</code> (logistic regression).
See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="formulaNLR_+3A_outcome">outcome</code></td>
<td>
<p>character: name of outcome to be printed in formula. If not specified <code>"y"</code> is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The unconstrained form of 4PL generalized logistic regression model for probability of correct
answer (i.e., <code class="reqn">y = 1</code>) is
</p>
<p style="text-align: center;"><code class="reqn">P(y = 1) = (c + cDif * g) + (d + dDif * g - c - cDif * g) / (1 + exp(-(a + aDif * g) * (x - b - bDif * g))), </code>
</p>

<p>where <code class="reqn">x</code> is by default standardized total score (also called Z-score) and <code class="reqn">g</code> is a group membership.
Parameters <code class="reqn">a</code>, <code class="reqn">b</code>, <code class="reqn">c</code>, and <code class="reqn">d</code> are discrimination, difficulty, guessing, and inattention.
Terms <code class="reqn">aDif</code>, <code class="reqn">bDif</code>, <code class="reqn">cDif</code>, and <code class="reqn">dDif</code> then represent differences between two groups
(reference and focal) in relevant parameters.
</p>
<p>The <code>model</code> argument offers several predefined models. The options are as follows:
<code>Rasch</code> for 1PL model with discrimination parameter fixed on value 1 for both groups,
<code>1PL</code> for 1PL model with discrimination parameter fixed for both groups,
<code>2PL</code> for logistic regression model,
<code>3PLcg</code> for 3PL model with fixed guessing for both groups,
<code>3PLdg</code> for 3PL model with fixed inattention for both groups,
<code>3PLc</code> (alternatively also <code>3PL</code>) for 3PL regression model with guessing parameter,
<code>3PLd</code> for 3PL model with inattention parameter,
<code>4PLcgdg</code> for 4PL model with fixed guessing and inattention parameter for both groups,
<code>4PLcgd</code> (alternatively also <code>4PLd</code>) for 4PL model with fixed guessing for both groups,
<code>4PLcdg</code> (alternatively also <code>4PLc</code>) for 4PL model with fixed inattention for both groups,
or <code>4PL</code> for 4PL model.
</p>
<p>Three possible parameterization can be specified in <code>"parameterization"</code> argument: <code>"classic"</code>
returns IRT parameters of reference group and differences in these parameters between reference and focal group.
<code>"alternative"</code> returns IRT parameters of reference group, the differences in parameters <code>"a"</code> and
<code>"b"</code> between two groups and parameters <code>"c"</code> and <code>"d"</code> for focal group.
<code>"logistic"</code> returns parameters in logistic regression parameterization and it is available only for 2PL model.
</p>


<h3>Value</h3>

<p>A list of two models. Both includes formula, parameters to be estimated and their lower and upper constraints.
</p>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difNLR">difNLR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 3PL model with the same guessing for both groups
# to test both types of DIF
formulaNLR(model = "3PLcg", type = "both")

# 4PL model with the same guessing and inattention
# to test uniform DIF
formulaNLR(model = "4PLcgdg", type = "udif")

# 2PL model to test non-uniform DIF
formulaNLR(model = "2PL", type = "nudif")

# 4PL model to test all possible DIF
# with alternative parameterization
formulaNLR(model = "4PL", type = "all", parameterization = "alternative")

# 4PL model with fixed a and c parameter
# to test difference in b with alternative parameterization
formulaNLR(model = "4PL", constraints = "ac", type = "b", parameterization = "alternative")

# 2PL model with logistic parameterization
formulaNLR(model = "2PL", parameterization = "logistic")
</code></pre>

<hr>
<h2 id='genNLR'>Generates data set based on generalized logistic regression DIF and DDF models.</h2><span id='topic+genNLR'></span>

<h3>Description</h3>

<p>Generates dichotomous, nominal, and ordinal data based on generalized logistic regression
models for DIF and DDF detection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genNLR(N = 1000, ratio = 1, itemtype = "dich", a, b, c, d, mu = 0, sigma = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genNLR_+3A_n">N</code></td>
<td>
<p>numeric: number of rows representing respondents. (default is 1000).</p>
</td></tr>
<tr><td><code id="genNLR_+3A_ratio">ratio</code></td>
<td>
<p>numeric: ratio of respondents number in reference and focal group.</p>
</td></tr>
<tr><td><code id="genNLR_+3A_itemtype">itemtype</code></td>
<td>
<p>character: type of items to be generated. Options are <code>"dich"</code> (default) for
dichotomous item based on non-linear regression model for DIF detection (see <code><a href="#topic+difNLR">difNLR</a></code>
for details), <code>"nominal"</code> for nominal items based on multinomial model for DDF detection (see
<code><a href="#topic+ddfMLR">ddfMLR</a></code> for detail), and <code>"ordinal"</code> for ordinal data based on adjacent
category logit model (for details see <code><a href="#topic+difORD">difORD</a></code>).</p>
</td></tr>
<tr><td><code id="genNLR_+3A_a">a</code></td>
<td>
<p>numeric: matrix representing discriminations with m rows
(where m is number of items). Needs to be provided. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="genNLR_+3A_b">b</code></td>
<td>
<p>numeric: numeric: matrix representing difficulties with m rows
(where m is number of items). Needs to be provided. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="genNLR_+3A_c">c</code></td>
<td>
<p>numeric: matrix representing guessings (lower asymptotes) with m rows
(where m is number of items). Default is <code>NULL</code>. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="genNLR_+3A_d">d</code></td>
<td>
<p>numeric: matrix representing inattentions (upper asymptotes) with m rows
(where m is number of items). Default is <code>NULL</code>. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="genNLR_+3A_mu">mu</code></td>
<td>
<p>numeric: a mean vector of the underlying distribution. The first value corresponds to
reference group, the second to focal group. Default is 0 value for both groups.</p>
</td></tr>
<tr><td><code id="genNLR_+3A_sigma">sigma</code></td>
<td>
<p>numeric: a standard deviation vector of the underlying distribution. The first value
corresponds to reference group, the second to focal group. Default is 1 value for both groups.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>a</code>, <code>b</code>, <code>c</code> and <code>d</code> are numeric matrices with m rows (where m is number of items)
representing parameters of regression models for DIF and DDF detection.
</p>
<p>For option <code>itemtype = "dich"</code>, matrices should have two columns. The first column represents
parameters of the reference group and the second of the focal group. In case that only one column is
provided, parameters are set to be the same for both groups.
</p>
<p>For options <code>itemtype = "nominal"</code> and <code>itemtype = "ordinal"</code>, matrices <code>c</code> and <code>d</code>
are ignored. Matrices <code>a</code> and <code>b</code> contain parameters for distractors. For example, when
item with 4 different choices is supposed to be generated, user provide matrices with 6 columns.
First 3 columns correspond to distractors parameters for reference group and last three columns
for focal group. The number of choices can differ for items. Matrices <code>a</code> and <code>b</code>
need to consist of as many columns as is the maximum number of distractors. Items with less
choices can containt NAs.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing <code>N</code> rows representing respondents and <code>m + 1</code> columns representing
<code>m</code> items. The last column is group membership variable with coding <code>"0"</code> for reference group and
<code>"1"</code> for focal group.
</p>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>References</h3>

<p>Drabinova, A. &amp; Martinkova, P. (2017). Detection of differential item functioning with nonlinear regression:
A non-IRT approach accounting for guessing. Journal of Educational Measurement, 54(4), 498&ndash;517,
<a href="https://doi.org/10.1111/jedm.12158">doi:10.1111/jedm.12158</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difNLR">difNLR</a></code>, <code><a href="#topic+difORD">difORD</a></code>, <code><a href="#topic+ddfMLR">ddfMLR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># seed
set.seed(123)
# generating parameters for dichotomous data with DIF, 5 items
a &lt;- matrix(runif(10, 0.8, 2), ncol = 2)
b &lt;- matrix(runif(10, -2, 2), ncol = 2)
c &lt;- matrix(runif(10, 0, 0.25), ncol = 2)
d &lt;- matrix(runif(10, 0.8, 1), ncol = 2)
# generating dichotomous data set with 300 observations (150 each group)
genNLR(N = 300, a = a, b = b, c = c, d = d)
# generating dichotomous data set with 300 observations (150 each group)
# and different mean and standard deviation for underlying distribution
genNLR(N = 300, a = a, b = b, c = c, d = d, mu = c(1, 0), sigma = c(1, 2))
# generating dichotomous data set with 300 observations (250 reference group, 50 focal)
genNLR(N = 300, ratio = 5, a = a, b = b, c = c, d = d)

# generating parameters for nominal data with DDF, 5 items,
# each item 3 choices
a &lt;- matrix(runif(20, 0.8, 2), ncol = 4)
b &lt;- matrix(runif(20, -2, 2), ncol = 4)
# generating nominal data set with 300 observations (150 each group)
genNLR(N = 300, itemtype = "nominal", a = a, b = b)
# generating nominal data set with 300 observations (250 reference group, 50 focal)
genNLR(N = 300, itemtype = "nominal", ratio = 5, a = a, b = b)

# generating parameters for nominal data with DDF, 5 items,
# items 1 and 2 have 2 choices, items 3, 4 and 5 have 3 choices
a &lt;- matrix(runif(20, 0.8, 2), ncol = 4)
a[1:2, c(2, 4)] &lt;- NA
b &lt;- matrix(runif(20, -2, 2), ncol = 4)
b[1:2, c(2, 4)] &lt;- NA
# generating nominal data set with 300 observations (150 each group)
genNLR(N = 300, itemtype = "nominal", a = a, b = b)
# generating nominal data set with 300 observations (250 reference group, 50 focal)
genNLR(N = 300, itemtype = "nominal", ratio = 5, a = a, b = b)
</code></pre>

<hr>
<h2 id='GMAT'>Dichotomous dataset based on GMAT with the same total score distribution for groups.</h2><span id='topic+GMAT'></span>

<h3>Description</h3>

<p>The <code>GMAT</code> is a generated dataset based on parameters from Graduate
Management Admission Test (GMAT, Kingston et al., 1985). First two items were
considered to function differently in uniform and non-uniform way respectively. The dataset
represents responses of 2,000 subjects to multiple-choice test of 20 items. A correct answer
is coded as 1 and incorrect answer as 0. The column <code>group</code> represents group membership,
where 0 indicates reference group and 1 indicates focal group. Groups are the same
size (i.e. 1,000 per group). The distributions of total scores (sum of correct answers) are the
same for both reference and focal group (Martinkova et al., 2017). The column <code>criterion</code>
represents generated continuous variable which is intended to be predicted by test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(GMAT)
</code></pre>


<h3>Format</h3>

<p>A <code>GMAT</code> data frame consists of 2,000 observations on the following 22 variables:
</p>

<dl>
<dt>Item1-Item20</dt><dd><p>dichotomously scored items of the test</p>
</dd>
<dt>group</dt><dd><p>group membership vector, <code>"0"</code> reference group, <code>"1"</code> focal group</p>
</dd>
<dt>criterion</dt><dd><p>continuous critetion intended to be predicted by test</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>References</h3>

<p>Kingston, N., Leary, L., &amp; Wightman, L. (1985). An exploratory study of the applicability of item response theory
methods to the Graduate Management Admission Test. ETS Research Report Series, 1985(2): 1&ndash;64.
</p>
<p>Martinkova, P., Drabinova, A., Liaw, Y. L., Sanders, E. A., McFarland, J. L., &amp; Price, R. M. (2017).
Checking equity: Why differential item functioning analysis should be a routine part of developing conceptual
assessments. CBE&ndash;Life Sciences Education, 16(2), rm2, <a href="https://doi.org/10.1187/cbe.16-10-0307">doi:10.1187/cbe.16-10-0307</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GMATtest">GMATtest</a></code>, <code><a href="#topic+GMATkey">GMATkey</a></code>
</p>

<hr>
<h2 id='GMAT2'>Dichotomous dataset based on GMAT.</h2><span id='topic+GMAT2'></span>

<h3>Description</h3>

<p>The <code>GMAT2</code> is a generated dataset based on parameters from
Graduate Management Admission Test (GMAT, Kingston et al., 1985). First two items
were considered to function differently in uniform and non-uniform way respectively.
The dataset represents responses of 1,000 subjects to multiple-choice test of 20 items.
A correct answer is coded as 1 and incorrect answer as 0. The column <code>group</code> represents
group membership, where 0 indicates reference group and 1 indicates focal group.
Groups are the same size (i.e. 500 per group).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(GMAT2)
</code></pre>


<h3>Format</h3>

<p>A <code>GMAT2</code> data frame consists of 1,000 observations on the following 21 variables:
</p>

<dl>
<dt>Item1-Item20</dt><dd><p>dichotomously scored items of the test</p>
</dd>
<dt>group</dt><dd><p>group membership vector, <code>"0"</code> reference group, <code>"1"</code> focal group</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>References</h3>

<p>Kingston, N., Leary, L., &amp; Wightman, L. (1985). An exploratory study of the applicability of item response theory
methods to the Graduate Management Admission Test. ETS Research Report Series, 1985(2): 1&ndash;64.
</p>
<p>Martinkova, P., Drabinova, A., Liaw, Y. L., Sanders, E. A., McFarland, J. L., &amp; Price, R. M. (2017).
Checking equity: Why differential item functioning analysis should be a routine part of developing conceptual
assessments. CBE&ndash;Life Sciences Education, 16(2), rm2, <a href="https://doi.org/10.1187/cbe.16-10-0307">doi:10.1187/cbe.16-10-0307</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GMAT2test">GMAT2test</a></code>, <code><a href="#topic+GMAT2key">GMAT2key</a></code>
</p>

<hr>
<h2 id='GMAT2key'>Key of correct answers for <code>GMAT2test</code> dataset.</h2><span id='topic+GMAT2key'></span>

<h3>Description</h3>

<p>The <code>GMAT2key</code> is a vector of factors representing correct answers of generated
<code>GMAT2test</code> data set based on Graduate Management Admission Test (GMAT) data set (Kingston et al., 1985).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(GMAT2key)
</code></pre>


<h3>Format</h3>

<p>A nominal vector with 20 values representing correct answers to items of <code>GMAT2test</code>
dataset. For more details see <code><a href="#topic+GMAT2test">GMAT2test</a></code>.
</p>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>References</h3>

<p>Kingston, N., Leary, L., &amp; Wightman, L. (1985). An exploratory study of the applicability of item response theory
methods to the Graduate Management Admission Test. ETS Research Report Series, 1985(2): 1&ndash;64.
</p>
<p>Martinkova, P., Drabinova, A., Liaw, Y. L., Sanders, E. A., McFarland, J. L., &amp; Price, R. M. (2017).
Checking equity: Why differential item functioning analysis should be a routine part of developing conceptual
assessments. CBE&ndash;Life Sciences Education, 16(2), rm2, <a href="https://doi.org/10.1187/cbe.16-10-0307">doi:10.1187/cbe.16-10-0307</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GMAT2">GMAT2</a></code>, <code><a href="#topic+GMAT2test">GMAT2test</a></code>
</p>

<hr>
<h2 id='GMAT2test'>Dataset based on GMAT.</h2><span id='topic+GMAT2test'></span>

<h3>Description</h3>

<p>The <code>GMAT2test</code> is a generated dataset based on parameters from Graduate Management
Admission Test (GMAT, Kingston et al., 1985). First two items were considered to function differently
in uniform and non-uniform way respectively. The data set represents responses of 1,000 subjects to
multiple-choice test of 20 items. Aditionally, 4 possible answers on all items were generated,
coded A, B, C, and D. The column <code>group</code> represents group membership, where 0 indicates reference group
and 1 indicates focal group. Groups are the same size (i.e. 500 per group).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(GMAT2test)
</code></pre>


<h3>Format</h3>

<p>A <code>GMAT2test</code> data frame consists of 1,000 observations on the following 21 variables:
</p>

<dl>
<dt>Item1-Item20</dt><dd><p>nominal items of the test coded A, B, C, and D</p>
</dd>
<dt>group</dt><dd><p>group membership vector, <code>"0"</code> reference group, <code>"1"</code> focal group</p>
</dd>
</dl>

<p>Correct answers are presented in <code><a href="#topic+GMAT2key">GMAT2key</a></code> data set.
</p>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>References</h3>

<p>Kingston, N., Leary, L., &amp; Wightman, L. (1985). An exploratory study of the applicability of item response theory
methods to the Graduate Management Admission Test. ETS Research Report Series, 1985(2): 1&ndash;64.
</p>
<p>Martinkova, P., Drabinova, A., Liaw, Y. L., Sanders, E. A., McFarland, J. L., &amp; Price, R. M. (2017).
Checking equity: Why differential item functioning analysis should be a routine part of developing conceptual
assessments. CBE&ndash;Life Sciences Education, 16(2), rm2, <a href="https://doi.org/10.1187/cbe.16-10-0307">doi:10.1187/cbe.16-10-0307</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GMAT2">GMAT2</a></code>, <code><a href="#topic+GMAT2key">GMAT2key</a></code>
</p>

<hr>
<h2 id='GMATkey'>Key of correct answers for <code>GMATtest</code> dataset.</h2><span id='topic+GMATkey'></span>

<h3>Description</h3>

<p>The <code>GMATkey</code> is a vector of factors representing correct answers of
generated <code>GMATtest</code> data set based on Graduate Management Admission Test (GMAT, Kingston et al., 1985).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(GMATkey)
</code></pre>


<h3>Format</h3>

<p>A nominal vector with 20 values representing correct answers to items of <code>GMATtest</code>
dataset. For more details see <code><a href="#topic+GMATtest">GMATtest</a></code>.
</p>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>References</h3>

<p>Kingston, N., Leary, L., &amp; Wightman, L. (1985). An exploratory study of the applicability of item response theory
methods to the Graduate Management Admission Test. ETS Research Report Series, 1985(2): 1&ndash;64.
</p>
<p>Martinkova, P., Drabinova, A., Liaw, Y. L., Sanders, E. A., McFarland, J. L., &amp; Price, R. M. (2017).
Checking equity: Why differential item functioning analysis should be a routine part of developing conceptual
assessments. CBE&ndash;Life Sciences Education, 16(2), rm2, <a href="https://doi.org/10.1187/cbe.16-10-0307">doi:10.1187/cbe.16-10-0307</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GMAT">GMAT</a></code>, <code><a href="#topic+GMATtest">GMATtest</a></code>
</p>

<hr>
<h2 id='GMATtest'>Dataset based on GMAT with the same total score distribution for groups.</h2><span id='topic+GMATtest'></span>

<h3>Description</h3>

<p>The <code>GMATtest</code> is a generated dataset based on parameters from
Graduate Management Admission Test (GMAT, Kingston et al., 1985). First two items
were considered to function differently in uniform and non-uniform way respectively.
The dataset represents responses of 2,000 subjects to multiple-choice test of 20 items.
Aditionally, 4 possible answers on all items were generated, coded A, B, C, and D. The column
<code>group</code> represents group membership, where 0 indicates reference group and 1 indicates
focal group. Groups are the same size (i.e. 1,000 per group). The distributions of total scores
(sum of correct answers) are the same for both reference and focal group (Martinkova et al., 2017).
The column <code>criterion</code> represents generated continuous variable which is intended to be predicted
by test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(GMATtest)
</code></pre>


<h3>Format</h3>

<p>A <code>GMATtest</code> data frame consists of 2,000 observations on the following 22 variables:
</p>

<dl>
<dt>Item1-Item20</dt><dd><p>nominal items of the test coded A, B, C, and D</p>
</dd>
<dt>group</dt><dd><p>group membership vector, <code>"0"</code> reference group, <code>"1"</code> focal group</p>
</dd>
<dt>criterion</dt><dd><p>continuous critetion intended to be predicted by test</p>
</dd>
</dl>

<p>Correct answers are presented in <code><a href="#topic+GMATkey">GMATkey</a></code> data set.
</p>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>References</h3>

<p>Kingston, N., Leary, L., &amp; Wightman, L. (1985). An exploratory study of the applicability of item response theory
methods to the Graduate Management Admission Test. ETS Research Report Series, 1985(2): 1&ndash;64.
</p>
<p>Martinkova, P., Drabinova, A., Liaw, Y. L., Sanders, E. A., McFarland, J. L., &amp; Price, R. M. (2017).
Checking equity: Why differential item functioning analysis should be a routine part of developing conceptual
assessments. CBE&ndash;Life Sciences Education, 16(2), rm2, <a href="https://doi.org/10.1187/cbe.16-10-0307">doi:10.1187/cbe.16-10-0307</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GMAT">GMAT</a></code>, <code><a href="#topic+GMATkey">GMATkey</a></code>
</p>

<hr>
<h2 id='logLik.ddfMLR'>Log-likelihood and information criteria for an object of <code>"ddfMLR"</code> class.</h2><span id='topic+logLik.ddfMLR'></span><span id='topic+AIC.ddfMLR'></span><span id='topic+BIC.ddfMLR'></span>

<h3>Description</h3>

<p>S3 methods for extracting log-likelihood, Akaike's
information criterion (AIC) and Schwarz's Bayesian criterion
(BIC) for an object of <code>"ddfMLR"</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ddfMLR'
logLik(object, item = "all", ...)

## S3 method for class 'ddfMLR'
AIC(object, item = "all", ...)

## S3 method for class 'ddfMLR'
BIC(object, item = "all", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.ddfMLR_+3A_object">object</code></td>
<td>
<p>an object of <code>"ddfMLR"</code> class.</p>
</td></tr>
<tr><td><code id="logLik.ddfMLR_+3A_item">item</code></td>
<td>
<p>numeric or character: either character <code>"all"</code> to
apply for all converged items (default), or a vector of item
names (column names of <code>Data</code>), or item identifiers
(integers specifying the column number).</p>
</td></tr>
<tr><td><code id="logLik.ddfMLR_+3A_...">...</code></td>
<td>
<p>other generic parameters for S3 methods.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ddfMLR">ddfMLR</a></code> for DDF detection among nominal data. <br />
<code><a href="stats.html#topic+logLik">logLik</a></code> for generic function extracting log-likelihood. <br />
<code><a href="stats.html#topic+AIC">AIC</a></code> for generic function calculating AIC and BIC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# loading data
data(GMATtest, GMATkey)
Data &lt;- GMATtest[, 1:20] # items
group &lt;- GMATtest[, "group"] # group membership variable
key &lt;- GMATkey # correct answers

# testing both DDF effects
(x &lt;- ddfMLR(Data, group, focal.name = 1, key))

# AIC, BIC, log-likelihood
AIC(x)
BIC(x)
logLik(x)

# AIC, BIC, log-likelihood for the first item
AIC(x, item = 1)
BIC(x, item = 1)
logLik(x, item = 1)

## End(Not run)
</code></pre>

<hr>
<h2 id='logLik.difNLR'>Log-likelihood and information criteria for an object of <code>"difNLR"</code> class.</h2><span id='topic+logLik.difNLR'></span><span id='topic+AIC.difNLR'></span><span id='topic+BIC.difNLR'></span>

<h3>Description</h3>

<p>S3 methods for extracting log-likelihood, Akaike's information criterion (AIC) and
Schwarz's Bayesian criterion (BIC) for an object of <code>"difNLR"</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'difNLR'
logLik(object, item = "all", ...)

## S3 method for class 'difNLR'
AIC(object, item = "all", ...)

## S3 method for class 'difNLR'
BIC(object, item = "all", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.difNLR_+3A_object">object</code></td>
<td>
<p>an object of <code>"difNLR"</code> class.</p>
</td></tr>
<tr><td><code id="logLik.difNLR_+3A_item">item</code></td>
<td>
<p>numeric or character: either character <code>"all"</code> to apply for all converged items (default),
or a vector of item names (column names of <code>Data</code>), or item identifiers (integers specifying
the column number).</p>
</td></tr>
<tr><td><code id="logLik.difNLR_+3A_...">...</code></td>
<td>
<p>other generic parameters for S3 methods.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>
<p>Karel Zvara <br />
Faculty of Mathematics and Physics, Charles University <br />
</p>


<h3>References</h3>

<p>Drabinova, A. &amp; Martinkova, P. (2017). Detection of differential item functioning with nonlinear regression:
A non-IRT approach accounting for guessing. Journal of Educational Measurement, 54(4), 498&ndash;517,
<a href="https://doi.org/10.1111/jedm.12158">doi:10.1111/jedm.12158</a>.
</p>
<p>Hladka, A. &amp; Martinkova, P. (2020). difNLR: Generalized logistic regression models for DIF and DDF detection.
The R Journal, 12(1), 300&ndash;323, <a href="https://doi.org/10.32614/RJ-2020-014">doi:10.32614/RJ-2020-014</a>.
</p>
<p>Swaminathan, H. &amp; Rogers, H. J. (1990). Detecting differential item functioning using logistic regression procedures.
Journal of Educational Measurement, 27(4), 361&ndash;370, <a href="https://doi.org/10.1111/j.1745-3984.1990.tb00754.x">doi:10.1111/j.1745-3984.1990.tb00754.x</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difNLR">difNLR</a></code> for DIF detection among binary data using generalized logistic regression model. <br />
<code><a href="stats.html#topic+logLik">logLik</a></code> for generic function extracting log-likelihood. <br />
<code><a href="stats.html#topic+AIC">AIC</a></code> for generic function calculating AIC and BIC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# loading data
data(GMAT)
Data &lt;- GMAT[, 1:20] # items
group &lt;- GMAT[, "group"] # group membership variable

# testing both DIF effects using likelihood-ratio test and
# 3PL model with fixed guessing for groups
(x &lt;- difNLR(Data, group, focal.name = 1, model = "3PLcg"))

# AIC, BIC, log-likelihood
AIC(x)
BIC(x)
logLik(x)

# AIC, BIC, log-likelihood for the first item
AIC(x, item = 1)
BIC(x, item = 1)
logLik(x, item = 1)

## End(Not run)
</code></pre>

<hr>
<h2 id='logLik.difORD'>Log-likelihood and information criteria for an object of
<code>"difORD"</code> class.</h2><span id='topic+logLik.difORD'></span><span id='topic+AIC.difORD'></span><span id='topic+BIC.difORD'></span>

<h3>Description</h3>

<p>S3 methods for extracting log-likelihood, Akaike's
information criterion (AIC) and Schwarz's Bayesian criterion
(BIC) for an object of <code>"difORD"</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'difORD'
logLik(object, item = "all", ...)

## S3 method for class 'difORD'
AIC(object, item = "all", ...)

## S3 method for class 'difORD'
BIC(object, item = "all", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.difORD_+3A_object">object</code></td>
<td>
<p>an object of <code>"difORD"</code> class.</p>
</td></tr>
<tr><td><code id="logLik.difORD_+3A_item">item</code></td>
<td>
<p>numeric or character: either character <code>"all"</code> to
apply for all converged items (default), or a vector of item
names (column names of <code>Data</code>), or item identifiers
(integers specifying the column number).</p>
</td></tr>
<tr><td><code id="logLik.difORD_+3A_...">...</code></td>
<td>
<p>other generic parameters for S3 methods.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difORD">difORD</a></code> for DIF detection among
ordinal data. <br /> <code><a href="stats.html#topic+logLik">logLik</a></code> for generic function
extracting log-likelihood. <br /> <code><a href="stats.html#topic+AIC">AIC</a></code> for generic
function calculating AIC and BIC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# loading data
data(Anxiety, package = "ShinyItemAnalysis")
Data &lt;- Anxiety[, paste0("R", 1:29)] # items
group &lt;- Anxiety[, "gender"] # group membership variable

# testing both DIF effects with adjacent category logit model
(x &lt;- difORD(Data, group, focal.name = 1, model = "adjacent"))

# AIC, BIC, log-likelihood
AIC(x)
BIC(x)
logLik(x)

# AIC, BIC, log-likelihood for the first item
AIC(x, item = 1)
BIC(x, item = 1)
logLik(x, item = 1)

## End(Not run)
</code></pre>

<hr>
<h2 id='MLR'>DDF likelihood ratio statistics based on multinomial log-linear
regression model.</h2><span id='topic+MLR'></span>

<h3>Description</h3>

<p>Calculates DDF likelihood ratio statistics for nominal
data based on multinomial log-linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLR(Data, group, key, type = "both", match = "zscore", anchor = 1:ncol(Data),
    p.adjust.method = "none", alpha = 0.05, parametrization)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MLR_+3A_data">Data</code></td>
<td>
<p>data.frame or matrix: dataset which rows represent
unscored examinee answers (nominal) and columns correspond to the
items.</p>
</td></tr>
<tr><td><code id="MLR_+3A_group">group</code></td>
<td>
<p>numeric: binary vector of group membership. <code>"0"</code>
for reference group, <code>"1"</code> for focal group.</p>
</td></tr>
<tr><td><code id="MLR_+3A_key">key</code></td>
<td>
<p>character: the answer key. Each element corresponds to
the correct answer of one item.</p>
</td></tr>
<tr><td><code id="MLR_+3A_type">type</code></td>
<td>
<p>character: type of DDF to be tested. Either
<code>"both"</code> for uniform and non-uniform DDF (i.e., difference
in parameters <code>"a"</code> and <code>"b"</code>) (default), or
<code>"udif"</code> for uniform DDF only (i.e., difference in
difficulty parameter <code>"b"</code>), or <code>"nudif"</code> for
non-uniform DDF only (i.e., difference in discrimination
parameter <code>"a"</code>). Can be specified as a single value (for
all items) or as an item-specific vector.</p>
</td></tr>
<tr><td><code id="MLR_+3A_match">match</code></td>
<td>
<p>numeric or character: matching criterion to be used as
an estimate of trait. Can be either <code>"zscore"</code> (default,
standardized total score), <code>"score"</code> (total test score), or
vector of the same length as number of observations in
<code>Data</code>.</p>
</td></tr>
<tr><td><code id="MLR_+3A_anchor">anchor</code></td>
<td>
<p>character or numeric: specification of DIF free
items. A vector of item identifiers (integers specifying the
column  number) specifying which items are currently considered
as anchor (DIF free) items. Argument is ignored if <code>match</code>
is not <code>"zscore"</code> or <code>"score"</code>.</p>
</td></tr>
<tr><td><code id="MLR_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>character: method for multiple comparison
correction. Possible values are <code>"holm"</code>, <code>"hochberg"</code>,
<code>"hommel"</code>, <code>"bonferroni"</code>, <code>"BH"</code>, <code>"BY"</code>,
<code>"fdr"</code>, and <code>"none"</code> (default). For more details see
<code><a href="stats.html#topic+p.adjust">p.adjust</a></code>.</p>
</td></tr>
<tr><td><code id="MLR_+3A_alpha">alpha</code></td>
<td>
<p>numeric: significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="MLR_+3A_parametrization">parametrization</code></td>
<td>
<p>deprecated. Use
<code><a href="#topic+coef.ddfMLR">coef.ddfMLR</a></code> for different
parameterizations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">P(y = k) = exp(b_0k + b_1k * x + b_2k * g + b_3k * x * g) / (1 + \sum exp(b_0l + b_1l * x + b_2l * g + b_3l * x * g)), </code>
</p>

<p>where <code class="reqn">x</code> is by default standardized total score (also called
Z-score) and <code class="reqn">g</code> is a group membership. Probability of correct
answer (specified in argument <code>key</code>) is
</p>
<p style="text-align: center;"><code class="reqn">P(y = k) = 1/(1 + \sum exp(b_0l + b_1l * x + b_2l * g + b_3l * x * g)). </code>
</p>

<p>Parameters are estimated via neural networks. For more details see
<code><a href="nnet.html#topic+multinom">multinom</a></code>.
</p>


<h3>Value</h3>

<p>A list with the following arguments:
</p>

<dl>
<dt><code>Sval</code></dt><dd><p>the values of likelihood ratio test statistics.</p>
</dd>
<dt><code>pval</code></dt><dd><p>the p-values by likelihood ratio test.</p>
</dd>
<dt><code>adj.pval</code></dt><dd><p>the adjusted p-values by likelihood ratio test using <code>p.adjust.method</code>.</p>
</dd>
<dt><code>df</code></dt><dd><p>the degress of freedom of likelihood ratio test.</p>
</dd>
<dt><code>par.m0</code></dt><dd><p>the estimates of null model.</p>
</dd>
<dt><code>par.m1</code></dt><dd><p>the estimates of alternative model.</p>
</dd>
<dt><code>se.m0</code></dt><dd><p>standard errors of parameters in null model.</p>
</dd>
<dt><code>se.m1</code></dt><dd><p>standard errors of parameters in alternative model.</p>
</dd>
<dt><code>cov.m0</code></dt><dd><p>list of covariance matrices of item parameters for null model.</p>
</dd>
<dt><code>cov.m1</code></dt><dd><p>list of covariance matrices of item parameters for alternative model.</p>
</dd>
<dt><code>ll.m0</code></dt><dd><p>log-likelihood of m0 model.</p>
</dd>
<dt><code>ll.m1</code></dt><dd><p>log-likelihood of m1 model.</p>
</dd>
<dt><code>AIC.m0</code></dt><dd><p>AIC of m0 model.</p>
</dd>
<dt><code>AIC.m1</code></dt><dd><p>AIC of m1 model.</p>
</dd>
<dt><code>BIC.m0</code></dt><dd><p>BIC of m0 model.</p>
</dd>
<dt><code>BIC.m1</code></dt><dd><p>BIC of m1 model.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>References</h3>

<p>Agresti, A. (2010). Analysis of ordinal categorical data. Second edition. John Wiley &amp; Sons.
</p>
<p>Hladka, A. (2021). Statistical models for detection of differential item functioning. Dissertation thesis.
Faculty of Mathematics and Physics, Charles University.
</p>
<p>Hladka, A. &amp; Martinkova, P. (2020). difNLR: Generalized logistic regression models for DIF and DDF detection.
The R Journal, 12(1), 300&ndash;323, <a href="https://doi.org/10.32614/RJ-2020-014">doi:10.32614/RJ-2020-014</a>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+p.adjust">p.adjust</a></code> <code><a href="nnet.html#topic+multinom">multinom</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# loading data
data(GMATtest, GMATkey)
Data &lt;- GMATtest[, 1:20] # items
group &lt;- GMATtest[, "group"] # group membership variable
key &lt;- GMATkey # correct answers

# testing both DDF effects
MLR(Data, group, key, type = "both")

# testing uniform DDF effects
MLR(Data, group, key, type = "udif")

# testing non-uniform DDF effects
MLR(Data, group, key, type = "nudif")

## End(Not run)

</code></pre>

<hr>
<h2 id='MSATB'>Dichotomous dataset of Medical School Admission Test in Biology.</h2><span id='topic+MSATB'></span>

<h3>Description</h3>

<p>The <code>MSATB</code> dataset consists of the responses of 1,407 subjects
(484 males, 923 females) to admission test to medical school in the Czech republic.
It contains 20 selected items from original test while first item was previously detected
as differently functioning (Vlckova, 2014). A correct answer is coded as 1 and incorrect
answer as 0. The column <code>gender</code> represents gender of students, where 0 indicates
males (reference group) and 1 indicates females (focal group).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MSATB)
</code></pre>


<h3>Format</h3>

<p>A <code>MSATB</code> data frame consists of 1,407 observations on the following 21 variables:
</p>

<dl>
<dt>Item</dt><dd><p>dichotomously scored items of the test</p>
</dd>
<dt>gender</dt><dd><p>gender of respondents, <code>"0"</code> males, <code>"1"</code> females</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>References</h3>

<p>Drabinova, A. &amp; Martinkova, P. (2017). Detection of differential item functioning with nonlinear regression:
A non-IRT approach accounting for guessing. Journal of Educational Measurement, 54(4), 498&ndash;517,
<a href="https://doi.org/10.1111/jedm.12158">doi:10.1111/jedm.12158</a>.
</p>
<p>Vlckova, K. (2014). Test and item fairness. Master's thesis. Faculty of Mathematics and Physics, Charles University.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MSATBtest">MSATBtest</a></code>, <code><a href="#topic+MSATBkey">MSATBkey</a></code>
</p>

<hr>
<h2 id='MSATBkey'>Key of correct answers for <code>MSATBtest</code> dataset.</h2><span id='topic+MSATBkey'></span>

<h3>Description</h3>

<p>The <code>MSATBkey</code> is a vector of factors representing correct answers of
<code>MSATBtest</code> dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MSATBkey)
</code></pre>


<h3>Format</h3>

<p>A nominal vector with 20 values representing correct answers to items of <code>MSATBtest</code>
dataset. For more details see <code><a href="#topic+MSATBtest">MSATBtest</a></code>.
</p>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>References</h3>

<p>Drabinova, A. &amp; Martinkova, P. (2017). Detection of differential item functioning with nonlinear regression:
A non-IRT approach accounting for guessing. Journal of Educational Measurement, 54(4), 498&ndash;517,
<a href="https://doi.org/10.1111/jedm.12158">doi:10.1111/jedm.12158</a>.
</p>
<p>Vlckova, K. (2014). Test and item fairness. Master's thesis. Faculty of Mathematics and Physics, Charles University.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MSATB">MSATB</a></code>, <code><a href="#topic+MSATBtest">MSATBtest</a></code>
</p>

<hr>
<h2 id='MSATBtest'>Dataset of School Admission Test in Biology.</h2><span id='topic+MSATBtest'></span>

<h3>Description</h3>

<p>The <code>MSATBtest</code> dataset consists of the responses of 1,407 subjects (484 males, 923 females)
to multiple-choice admission test to medical school in the Czech republic. It contains 20 selected items from original
test while first item was previously detected detected as differently functioning (Vlckova, 2014).
Possible answers were A, B, C, and D, while any combination of these can be correct. The column <code>gender</code> represents
gender of students, where 0 indicates males (reference group) and 1 indicates females (focal group).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MSATBtest)
</code></pre>


<h3>Format</h3>

<p>A <code>MSATBtest</code> data frame consists of 1,407 observations on the following 21 variables:
</p>

<dl>
<dt>Item</dt><dd><p>nominal items of the test</p>
</dd>
<dt>gender</dt><dd><p>gender of respondents, <code>"0"</code> males, <code>"1"</code> females</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>References</h3>

<p>Drabinova, A. &amp; Martinkova, P. (2017). Detection of differential item functioning with nonlinear regression:
A non-IRT approach accounting for guessing. Journal of Educational Measurement, 54(4), 498&ndash;517,
<a href="https://doi.org/10.1111/jedm.12158">doi:10.1111/jedm.12158</a>.
</p>
<p>Vlckova, K. (2014). Test and item fairness. Master's thesis. Faculty of Mathematics and Physics, Charles University.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MSATB">MSATB</a></code>, <code><a href="#topic+MSATBkey">MSATBkey</a></code>
</p>

<hr>
<h2 id='NLR'>DIF statistics based on non-linear regression model.</h2><span id='topic+NLR'></span>

<h3>Description</h3>

<p>Calculates either DIF likelihood ratio statistics or F statistics for dichotomous
data based on non-linear regression model (generalized logistic regression model).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NLR(Data, group, model, constraints = NULL, type = "all", method = "nls",
    match = "zscore", anchor = 1:ncol(Data), start, p.adjust.method = "none", test = "LR",
    alpha = 0.05, initboot = TRUE, nrBo = 20, sandwich = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NLR_+3A_data">Data</code></td>
<td>
<p>data.frame or matrix: dataset which rows represent scored examinee answers (<code>"1"</code>
correct, <code>"0"</code> incorrect) and columns correspond to the items.</p>
</td></tr>
<tr><td><code id="NLR_+3A_group">group</code></td>
<td>
<p>numeric: binary vector of group membership. <code>"0"</code> for reference group, <code>"1"</code> for
focal group.</p>
</td></tr>
<tr><td><code id="NLR_+3A_model">model</code></td>
<td>
<p>character: generalized logistic regression model to be fitted. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="NLR_+3A_constraints">constraints</code></td>
<td>
<p>character: which parameters should be the same for both groups. Possible values
are any combinations of parameters <code>"a"</code>, <code>"b"</code>, <code>"c"</code>, and <code>"d"</code>. Default value
is <code>NULL</code>. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="NLR_+3A_type">type</code></td>
<td>
<p>character: type of DIF to be tested. Possible values are <code>"all"</code> for detecting
difference in any parameter (default), <code>"udif"</code> for uniform DIF only (i.e., difference in
difficulty parameter <code>"b"</code>), <code>"nudif"</code> for non-uniform DIF only (i.e., difference in
discrimination parameter <code>"a"</code>), <code>"both"</code> for uniform and non-uniform DIF (i.e.,
difference in parameters <code>"a"</code> and <code>"b"</code>), or combination of parameters <code>"a"</code>,
<code>"b"</code>, <code>"c"</code>, and <code>"d"</code>. Can be specified as a single value (for all items) or as
an item-specific vector.</p>
</td></tr>
<tr><td><code id="NLR_+3A_method">method</code></td>
<td>
<p>character: method used to estimate parameters. The options are <code>"nls"</code> for
non-linear least squares (default), <code>"likelihood"</code> for maximum likelihood method with
<code>"L-BFGS-B"</code> algorithm, or <code>"irls"</code> for maximum likelihood method with iteratively
reweighted least squares (available only for <code>model = "2PL"</code>).</p>
</td></tr>
<tr><td><code id="NLR_+3A_match">match</code></td>
<td>
<p>character or numeric: matching criterion to be used as estimate of trait. Can be
either <code>"zscore"</code> (default, standardized total score), <code>"score"</code> (total test score),
or numeric vector of the same length as number of observations in <code>Data</code>.</p>
</td></tr>
<tr><td><code id="NLR_+3A_anchor">anchor</code></td>
<td>
<p>character or numeric: specification of DIF free items. A vector of item identifiers
(integers specifying the column  number) specifying which items are currently considered as anchor
(DIF free) items. Argument is ignored if <code>match</code> is not <code>"zscore"</code> or <code>"score"</code>.</p>
</td></tr>
<tr><td><code id="NLR_+3A_start">start</code></td>
<td>
<p>numeric: initial values for estimation of parameters. If not specified, starting
values are calculated with <code><a href="#topic+startNLR">startNLR</a></code> function. Otherwise, list with as many
elements as number of items. Each element is a named numeric vector of length 8 representing initial
values for parameter estimation. Specifically, parameters <code>"a"</code>, <code>"b"</code>, <code>"c"</code>, and
<code>"d"</code> are initial values for discrimination, difficulty, guessing, and inattention for reference
group. Parameters <code>"aDif"</code>, <code>"bDif"</code>, <code>"cDif"</code>, and <code>"dDif"</code> are then differences
in these parameters between reference and focal group.</p>
</td></tr>
<tr><td><code id="NLR_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>character: method for multiple comparison correction. Possible values are
<code>"holm"</code>, <code>"hochberg"</code>, <code>"hommel"</code>, <code>"bonferroni"</code>, <code>"BH"</code>, <code>"BY"</code>,
<code>"fdr"</code>, and <code>"none"</code> (default). For more details see <code><a href="stats.html#topic+p.adjust">p.adjust</a></code>.</p>
</td></tr>
<tr><td><code id="NLR_+3A_test">test</code></td>
<td>
<p>character: test to be performed for DIF detection. Can be either <code>"LR"</code> for
likelihood ratio test of a submodel (default), <code>"W"</code> for Wald test, or <code>"F"</code> for F-test
of a submodel.</p>
</td></tr>
<tr><td><code id="NLR_+3A_alpha">alpha</code></td>
<td>
<p>numeric: significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="NLR_+3A_initboot">initboot</code></td>
<td>
<p>logical: in case of convergence issues, should be starting values re-calculated based on
bootstraped samples? (default is <code>TRUE</code>; newly calculated initial values are applied only to
items/models with convergence issues).</p>
</td></tr>
<tr><td><code id="NLR_+3A_nrbo">nrBo</code></td>
<td>
<p>numeric: the maximal number of iterations for calculation of starting values using
bootstraped samples (default is 20).</p>
</td></tr>
<tr><td><code id="NLR_+3A_sandwich">sandwich</code></td>
<td>
<p>logical: should be sandwich estimator used for covariance matrix of parameters when using
<code>method = "nls"</code>? Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculation of the test statistics using DIF detection procedure based on non-linear regression
(extension of logistic regression procedure; Swaminathan and Rogers, 1990; Drabinova and Martinkova, 2017).
</p>
<p>The unconstrained form of 4PL generalized logistic regression model for probability of correct
answer (i.e., <code class="reqn">y = 1</code>) is
</p>
<p style="text-align: center;"><code class="reqn">P(y = 1) = (c + cDif * g) + (d + dDif * g - c - cDif * g) / (1 + exp(-(a + aDif * g) * (x - b - bDif * g))), </code>
</p>

<p>where <code class="reqn">x</code> is by default standardized total score (also called Z-score) and <code class="reqn">g</code> is a group membership.
Parameters <code class="reqn">a</code>, <code class="reqn">b</code>, <code class="reqn">c</code>, and <code class="reqn">d</code> are discrimination, difficulty, guessing, and inattention.
Terms <code class="reqn">aDif</code>, <code class="reqn">bDif</code>, <code class="reqn">cDif</code>, and <code class="reqn">dDif</code> then represent differences between two groups
(reference and focal) in relevant parameters.
</p>
<p>This 4PL model can be further constrained by <code>model</code> and <code>constraints</code> arguments.
The arguments <code>model</code> and <code>constraints</code> can be also combined. Both arguments can
be specified as a single value (for all items) or as an item-specific vector (where each
element correspond to one item).
</p>
<p>The <code>model</code> argument offers several predefined models. The options are as follows:
<code>Rasch</code> for 1PL model with discrimination parameter fixed on value 1 for both groups,
<code>1PL</code> for 1PL model with discrimination parameter fixed for both groups,
<code>2PL</code> for logistic regression model,
<code>3PLcg</code> for 3PL model with fixed guessing for both groups,
<code>3PLdg</code> for 3PL model with fixed inattention for both groups,
<code>3PLc</code> (alternatively also <code>3PL</code>) for 3PL regression model with guessing parameter,
<code>3PLd</code> for 3PL model with inattention parameter,
<code>4PLcgdg</code> for 4PL model with fixed guessing and inattention parameter for both groups,
<code>4PLcgd</code> (alternatively also <code>4PLd</code>) for 4PL model with fixed guessing for both groups,
<code>4PLcdg</code> (alternatively also <code>4PLc</code>) for 4PL model with fixed inattention for both groups,
or <code>4PL</code> for 4PL model.
</p>
<p>The <code>model</code> can be specified in more detail with <code>constraints</code> argument which specifies what
parameters should be fixed for both groups. For example, choice <code>"ad"</code> means that discrimination
(parameter <code>"a"</code>) and inattention (parameter <code>"d"</code>) are fixed for both groups and other parameters
(<code>"b"</code> and <code>"c"</code>) are not. The <code>NA</code> value for <code>constraints</code> means no constraints.
</p>
<p>In case that the model considers a difference in guessing or inattention parameter, different parameterization is
used and parameters with standard errors are re-calculated by delta method.
</p>


<h3>Value</h3>

<p>A list with the following arguments:
</p>

<dl>
<dt><code>Sval</code></dt><dd><p>the values of <code>test</code> statistics.</p>
</dd>
<dt><code>pval</code></dt><dd><p>the p-values by <code>test</code>.</p>
</dd>
<dt><code>adjusted.pval</code></dt><dd><p>adjusted p-values by <code>p.adjust.method</code>.</p>
</dd>
<dt><code>df</code></dt><dd><p>the degrees of freedom of <code>test</code>.</p>
</dd>
<dt><code>test</code></dt><dd><p>used test.</p>
</dd>
<dt><code>par.m0</code></dt><dd><p>the matrix of estimated item parameters for null model.</p>
</dd>
<dt><code>se.m0</code></dt><dd><p>the matrix of standard errors of item parameters for null model.</p>
</dd>
<dt><code>cov.m0</code></dt><dd><p>list of covariance matrices of item parameters for null model.</p>
</dd>
<dt><code>par.m1</code></dt><dd><p>the matrix of estimated item parameters for alternative model.</p>
</dd>
<dt><code>se.m1</code></dt><dd><p>the matrix of standard errors of item parameters for alternative model.</p>
</dd>
<dt><code>cov.m1</code></dt><dd><p>list of covariance matrices of item parameters for alternative model.</p>
</dd>
<dt><code>conv.fail</code></dt><dd><p>numeric: number of convergence issues.</p>
</dd>
<dt><code>conv.fail.which</code></dt><dd><p>the indicators of the items which did not converge.</p>
</dd>
<dt><code>ll.m0</code></dt><dd><p>log-likelihood of null model.</p>
</dd>
<dt><code>ll.m1</code></dt><dd><p>log-likelihood of alternative model.</p>
</dd>
<dt><code>startBo0</code></dt><dd><p>the binary matrix. Columns represents iterations of initial values
re-calculations, rows represents items. The value of 0 means no convergence issue in null model,
1 means convergence issue in null model.</p>
</dd>
<dt><code>startBo1</code></dt><dd><p>the binary matrix. Columns represents iterations of initial values
re-calculations, rows represents items. The value of 0 means no convergence issue in alternative model,
1 means convergence issue in alternative model.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>
<p>Karel Zvara <br />
Faculty of Mathematics and Physics, Charles University <br />
</p>


<h3>References</h3>

<p>Drabinova, A. &amp; Martinkova, P. (2017). Detection of differential item functioning with nonlinear regression:
A non-IRT approach accounting for guessing. Journal of Educational Measurement, 54(4), 498&ndash;517,
<a href="https://doi.org/10.1111/jedm.12158">doi:10.1111/jedm.12158</a>.
</p>
<p>Hladka, A. (2021). Statistical models for detection of differential item functioning. Dissertation thesis.
Faculty of Mathematics and Physics, Charles University.
</p>
<p>Hladka, A. &amp; Martinkova, P. (2020). difNLR: Generalized logistic regression models for DIF and DDF detection.
The R Journal, 12(1), 300&ndash;323, <a href="https://doi.org/10.32614/RJ-2020-014">doi:10.32614/RJ-2020-014</a>.
</p>
<p>Swaminathan, H. &amp; Rogers, H. J. (1990). Detecting differential item functioning using logistic regression procedures.
Journal of Educational Measurement, 27(4), 361&ndash;370, <a href="https://doi.org/10.1111/j.1745-3984.1990.tb00754.x">doi:10.1111/j.1745-3984.1990.tb00754.x</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+p.adjust">p.adjust</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# loading data
data(GMAT)
Data &lt;- GMAT[, 1:20] # items
group &lt;- GMAT[, "group"] # group membership variable

# testing both DIF effects using LR test (default)
# and model with fixed guessing for both groups
NLR(Data, group, model = "3PLcg")

# using F test
NLR(Data, group, model = "3PLcg", test = "F")

# testing both DIF effects with Benjamini-Hochberg correction
NLR(Data, group, model = "3PLcg", p.adjust.method = "BH")

# 4PL model with the same guessing and inattention
# to test uniform DIF
NLR(Data, group, model = "4PLcgdg", type = "udif")

# 2PL model to test non-uniform DIF
NLR(Data, group, model = "2PL", type = "nudif")

# 4PL model with fixed a and c parameter
# to test difference in b
NLR(Data, group, model = "4PL", constraints = "ac", type = "b")

# using maximum likelihood estimation method with L-BFGS-B algorithm
NLR(Data, group, model = "3PLcg", method = "likelihood")

# using maximum likelihood estimation method with iteratively reweighted least squares algorithm
NLR(Data, group, model = "2PL", method = "irls")

## End(Not run)

</code></pre>

<hr>
<h2 id='ORD'>DIF likelihood ratio statistics for ordinal data.</h2><span id='topic+ORD'></span>

<h3>Description</h3>

<p>Calculates DIF likelihood ratio statistics for ordinal
data based either on adjacent category logit regression model or
on cumulative logit regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ORD(Data, group, model = "adjacent", type = "both", match = "zscore",
    anchor = 1:ncol(Data), p.adjust.method = "none",
    alpha = 0.05, parametrization)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ORD_+3A_data">Data</code></td>
<td>
<p>data.frame or matrix: dataset which rows represent
ordinaly scored examinee answers and columns correspond to the
items.</p>
</td></tr>
<tr><td><code id="ORD_+3A_group">group</code></td>
<td>
<p>numeric: binary vector of group membership. <code>"0"</code>
for reference group, <code>"1"</code> for focal group.</p>
</td></tr>
<tr><td><code id="ORD_+3A_model">model</code></td>
<td>
<p>character: logistic regression model for ordinal data
(either <code>"adjacent"</code> (default) or <code>"cumulative"</code>). See
<strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="ORD_+3A_type">type</code></td>
<td>
<p>character: type of DIF to be tested. Either
<code>"both"</code> for uniform and non-uniform DIF (i.e., difference
in parameters <code>"a"</code> and <code>"b"</code>) (default), or
<code>"udif"</code> for uniform DIF only (i.e., difference in
difficulty parameter <code>"b"</code>), or <code>"nudif"</code> for
non-uniform DIF only (i.e., difference in discrimination
parameter <code>"a"</code>). Can be specified as a single value (for
all items) or as an item-specific vector.</p>
</td></tr>
<tr><td><code id="ORD_+3A_match">match</code></td>
<td>
<p>numeric or character: matching criterion to be used as
an estimate of trait. Can be either <code>"zscore"</code> (default,
standardized total score), <code>"score"</code> (total test score), or
vector of the same length as number of observations in
<code>Data</code>.</p>
</td></tr>
<tr><td><code id="ORD_+3A_anchor">anchor</code></td>
<td>
<p>character or numeric: specification of DIF free
items. A vector of item identifiers (integers specifying the
column  number) specifying which items are currently considered
as anchor (DIF free) items. Argument is ignored if <code>match</code>
is not <code>"zscore"</code> or <code>"score"</code>.</p>
</td></tr>
<tr><td><code id="ORD_+3A_p.adjust.method">p.adjust.method</code></td>
<td>
<p>character: method for multiple comparison
correction. Possible values are <code>"holm"</code>, <code>"hochberg"</code>,
<code>"hommel"</code>, <code>"bonferroni"</code>, <code>"BH"</code>, <code>"BY"</code>,
<code>"fdr"</code>, and <code>"none"</code> (default). For more details see
<code><a href="stats.html#topic+p.adjust">p.adjust</a></code>.</p>
</td></tr>
<tr><td><code id="ORD_+3A_alpha">alpha</code></td>
<td>
<p>numeric: significance level (default is 0.05).</p>
</td></tr>
<tr><td><code id="ORD_+3A_parametrization">parametrization</code></td>
<td>
<p>deprecated. Use
<code><a href="#topic+coef.difORD">coef.difORD</a></code> for different
parameterizations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates DIF likelihood ratio statistics based either on adjacent
category logit model or on cumulative logit model for ordinal data.
</p>
<p>Using adjacent category logit model, logarithm of ratio of
probabilities of two adjacent categories is
</p>
<p style="text-align: center;"><code class="reqn">log(P(y = k) / P(y = k - 1)) = b_0k + b_1 * x + b_2k * g + b_3 * x:g,</code>
</p>

<p>where <code class="reqn">x</code> is by default standardized total score (also called
Z-score) and <code class="reqn">g</code> is a group membership.
</p>
<p>Using cumulative logit model, probability of gaining at least
<code class="reqn">k</code> points is given by 2PL model, i.e.,
</p>
<p style="text-align: center;"><code class="reqn">P(y &gt;= k) = exp(b_0k + b_1 * x + b_2k * g + b_3 * x:g) / (1 + exp(b_0k + b_1 * x + b_2k * g + b_3 * x:g)).</code>
</p>

<p>The category probability (i.e., probability of gaining exactly
<code class="reqn">k</code> points) is then <code class="reqn">P(y = k) = P(y &gt;= k) - P(y &gt;= k + 1)</code>.
</p>
<p>Both models are estimated by iteratively reweighted least squares.
For more details see <code><a href="VGAM.html#topic+vglm">vglm</a></code>.
</p>


<h3>Value</h3>

<p>A list with the following arguments:
</p>

<dl>
<dt><code>Sval</code></dt><dd><p>the values of likelihood ratio test statistics.</p>
</dd>
<dt><code>pval</code></dt><dd><p>the p-values by likelihood ratio test.</p>
</dd>
<dt><code>adj.pval</code></dt><dd><p>the adjusted p-values by likelihood ratio test using <code>p.adjust.method</code>.</p>
</dd>
<dt><code>df</code></dt><dd><p>the degress of freedom of likelihood ratio test.</p>
</dd>
<dt><code>par.m0</code></dt><dd><p>the estimates of null model.</p>
</dd>
<dt><code>par.m1</code></dt><dd><p>the estimates of alternative model.</p>
</dd>
<dt><code>se.m0</code></dt><dd><p>standard errors of parameters in null model.</p>
</dd>
<dt><code>se.m1</code></dt><dd><p>standard errors of parameters in alternative model.</p>
</dd>
<dt><code>cov.m0</code></dt><dd><p>list of covariance matrices of item parameters for null model.</p>
</dd>
<dt><code>cov.m1</code></dt><dd><p>list of covariance matrices of item parameters for alternative model.</p>
</dd>
<dt><code>ll.m0</code></dt><dd><p>log-likelihood of null model.</p>
</dd>
<dt><code>ll.m1</code></dt><dd><p>log-likelihood of alternative model.</p>
</dd>
<dt><code>AIC.m0</code></dt><dd><p>AIC of null model.</p>
</dd>
<dt><code>AIC.m1</code></dt><dd><p>AIC of alternative model.</p>
</dd>
<dt><code>BIC.m0</code></dt><dd><p>BIC of null model.</p>
</dd>
<dt><code>BIC.m1</code></dt><dd><p>BIC of alternative model.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>References</h3>

<p>Agresti, A. (2010). Analysis of ordinal categorical data. Second edition. John Wiley &amp; Sons.
</p>
<p>Hladka, A. (2021). Statistical models for detection of differential item functioning. Dissertation thesis.
Faculty of Mathematics and Physics, Charles University.
</p>
<p>Hladka, A. &amp; Martinkova, P. (2020). difNLR: Generalized logistic regression models for DIF and DDF detection.
The R Journal, 12(1), 300&ndash;323, <a href="https://doi.org/10.32614/RJ-2020-014">doi:10.32614/RJ-2020-014</a>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+p.adjust">p.adjust</a></code> <code><a href="VGAM.html#topic+vglm">vglm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# loading data
data(Anxiety, package = "ShinyItemAnalysis")
Data &lt;- Anxiety[, paste0("R", 1:29)] # items
group &lt;- Anxiety[, "gender"] # group membership variable

# testing both DIF effects
ORD(Data, group, type = "both")

# testing uniform DIF effects
ORD(Data, group, type = "udif")

# testing non-uniform DIF effects
ORD(Data, group, type = "nudif")

# testing DIF using cumulative logit model
ORD(Data, group, model = "cumulative")

## End(Not run)

</code></pre>

<hr>
<h2 id='plot.ddfMLR'>ICC plots for an object of <code>"ddfMLR"</code> class.</h2><span id='topic+plot.ddfMLR'></span>

<h3>Description</h3>

<p>Plot method for an object of <code>"ddfMLR"</code> class
using <span class="pkg">ggplot2</span>.
</p>
<p>The characteristic curves for an item specified in <code>item</code>
argument are plotted. Plotted curves represent the best model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ddfMLR'
plot(x, item = "all", group.names, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.ddfMLR_+3A_x">x</code></td>
<td>
<p>an object of <code>"ddfMLR"</code> class.</p>
</td></tr>
<tr><td><code id="plot.ddfMLR_+3A_item">item</code></td>
<td>
<p>numeric or character: either character <code>"all"</code> to
apply for all items (default), or a vector of item names (column
names of <code>Data</code>), or item identifiers (integers specifying
the column number).</p>
</td></tr>
<tr><td><code id="plot.ddfMLR_+3A_group.names">group.names</code></td>
<td>
<p>character: names of reference and focal group.</p>
</td></tr>
<tr><td><code id="plot.ddfMLR_+3A_...">...</code></td>
<td>
<p>other generic parameters for <code>plot()</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns list of objects of class <code>"ggplot"</code>.
</p>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ddfMLR">ddfMLR</a></code> for DDF detection. <br />
<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> for general function to plot a <code>"ggplot"</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# loading data
data(GMATtest, GMATkey)
Data &lt;- GMATtest[, 1:20] # items
group &lt;- GMATtest[, "group"] # group membership variable
key &lt;- GMATkey # correct answers

# testing both DDF effects
(x &lt;- ddfMLR(Data, group, focal.name = 1, key))

# graphical devices
plot(x, item = "Item1", group.names = c("Group 1", "Group 2"))
plot(x, item = x$DDFitems)
plot(x, item = c(3, 1, 5))

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.difNLR'>ICC and test statistics plots for an object of <code>"difNLR"</code> class.</h2><span id='topic+plot.difNLR'></span>

<h3>Description</h3>

<p>Plot method for an object of <code>"difNLR"</code> class using <span class="pkg">ggplot2</span>.
</p>
<p>Two types of plots are available. The first one is obtained by setting <code>plot.type = "cc"</code>
(default). The characteristic curves for an item specified in <code>item</code> argument are plotted.
Plotted curves represent the best model.
</p>
<p>The second plot is obtained by setting <code>plot.type = "stat"</code>. The  test statistics
(either LR-test, or F-test, depends on argument <code>test</code>) are displayed on the Y axis,
for each converged item. The detection threshold is displayed by a horizontal line and items
detected as DIF are printed with the red color. Only parameters <code>size</code> and <code>title</code>
are used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'difNLR'
plot(
  x,
  plot.type = "cc",
  item = "all",
  group.names,
  draw.empirical = TRUE,
  draw.CI = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.difNLR_+3A_x">x</code></td>
<td>
<p>an object of <code>"difNLR"</code> class.</p>
</td></tr>
<tr><td><code id="plot.difNLR_+3A_plot.type">plot.type</code></td>
<td>
<p>character: type of plot to be plotted (either <code>"cc"</code> for characteristic curve
(default), or <code>"stat"</code> for test statistics).</p>
</td></tr>
<tr><td><code id="plot.difNLR_+3A_item">item</code></td>
<td>
<p>numeric or character: either character <code>"all"</code> to apply for all converged items (default),
or a vector of item names (column names of <code>Data</code>), or item identifiers (integers specifying
the column number).</p>
</td></tr>
<tr><td><code id="plot.difNLR_+3A_group.names">group.names</code></td>
<td>
<p>character: names of reference and focal group.</p>
</td></tr>
<tr><td><code id="plot.difNLR_+3A_draw.empirical">draw.empirical</code></td>
<td>
<p>logical: should empirical probabilities be plotted as points? Default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.difNLR_+3A_draw.ci">draw.CI</code></td>
<td>
<p>logical: should confidence intervals for predicted values be plotted? Default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.difNLR_+3A_...">...</code></td>
<td>
<p>other generic parameters for <code>plot()</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For an option <code>plot.type = "stat"</code>, returns object of class <code>"ggplot"</code>. In case of
<code>plot.type = "cc"</code>, returns list of objects of class <code>"ggplot"</code>.
</p>
<p>Outputs can be edited and modified as standard <code>"ggplot"</code> object including colours, titles, shapes or linetypes.
</p>
<p>Note that option <code>draw.CI = TRUE</code> returns confidence intervals for predicted values as calculated by
<code><a href="#topic+predict.difNLR">predict.difNLR</a></code>. Confidence intervals may overlap even in case that item functions differently.
</p>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>
<p>Karel Zvara <br />
Faculty of Mathematics and Physics, Charles University <br />
</p>


<h3>References</h3>

<p>Drabinova, A. &amp; Martinkova, P. (2017). Detection of differential item functioning with nonlinear regression:
A non-IRT approach accounting for guessing. Journal of Educational Measurement, 54(4), 498&ndash;517,
<a href="https://doi.org/10.1111/jedm.12158">doi:10.1111/jedm.12158</a>.
</p>
<p>Hladka, A. &amp; Martinkova, P. (2020). difNLR: Generalized logistic regression models for DIF and DDF detection.
The R Journal, 12(1), 300&ndash;323, <a href="https://doi.org/10.32614/RJ-2020-014">doi:10.32614/RJ-2020-014</a>.
</p>
<p>Swaminathan, H. &amp; Rogers, H. J. (1990). Detecting differential item functioning using logistic regression procedures.
Journal of Educational Measurement, 27(4), 361&ndash;370, <a href="https://doi.org/10.1111/j.1745-3984.1990.tb00754.x">doi:10.1111/j.1745-3984.1990.tb00754.x</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difNLR">difNLR</a></code> for DIF detection among binary data using generalized logistic regression model. <br />
<code><a href="#topic+predict.difNLR">predict.difNLR</a></code> for prediction.
<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> for general function to plot a <code>"ggplot"</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# loading data
data(GMAT)
Data &lt;- GMAT[, 1:20] # items
group &lt;- GMAT[, "group"] # group membership variable

# testing both DIF effects using likelihood-ratio test and
# 3PL model with fixed guessing for groups
(x &lt;- difNLR(Data, group, focal.name = 1, model = "3PLcg"))

# item characteristic curves
plot(x)
plot(x, item = x$DIFitems)
plot(x, item = 1)
plot(x, item = "Item1")

# item characteristic curves without empirical probabilities
plot(x, item = 1, draw.empirical = FALSE)

# item characteristic curves without empirical probabilities but with CI
plot(x, item = 1, draw.empirical = FALSE, draw.CI = TRUE)

# graphical devices - test statistics
plot(x, plot.type = "stat")

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.difORD'>ICC plots for an object of <code>"difORD"</code> class.</h2><span id='topic+plot.difORD'></span>

<h3>Description</h3>

<p>Plot method for an object of <code>"difORD"</code> class
using <span class="pkg">ggplot2</span>.
</p>
<p>The characteristic curves (category probabilities) for an item
specified in <code>item</code> argument are plotted. Plotted curves
represent the best model. For cumulative logit model, also
cumulative probabilities may be plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'difORD'
plot(x, item = "all", plot.type, group.names, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.difORD_+3A_x">x</code></td>
<td>
<p>an object of <code>"difORD"</code> class.</p>
</td></tr>
<tr><td><code id="plot.difORD_+3A_item">item</code></td>
<td>
<p>numeric or character: either character <code>"all"</code> to
apply for all converged items (default), or a vector of item
names (column names of <code>Data</code>), or item identifiers
(integers specifying the column number).</p>
</td></tr>
<tr><td><code id="plot.difORD_+3A_plot.type">plot.type</code></td>
<td>
<p>character: which plot should be displayed for
cumulative logit regression model. Either <code>"category"</code>
(default) for category probabilities or <code>"cumulative"</code> for
cumulative probabilities.</p>
</td></tr>
<tr><td><code id="plot.difORD_+3A_group.names">group.names</code></td>
<td>
<p>character: names of reference and focal group.</p>
</td></tr>
<tr><td><code id="plot.difORD_+3A_...">...</code></td>
<td>
<p>other generic parameters for <code>plot()</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns list of objects of class <code>"ggplot"</code>.
</p>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difORD">difORD</a></code> for DIF detection among ordinal data. <br />
<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> for general function to plot a <code>"ggplot"</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# loading data
data(Anxiety, package = "ShinyItemAnalysis")
Data &lt;- Anxiety[, paste0("R", 1:29)] # items
group &lt;- Anxiety[, "gender"] # group membership variable

# testing both DIF effects with adjacent category logit model
(x &lt;- difORD(Data, group, focal.name = 1, model = "adjacent"))

# graphical devices
plot(x, item = 6)
plot(x, item = "R6", group.names = c("Males", "Females"))

# testing both DIF effects with cumulative logit model
(x &lt;- difORD(Data, group, focal.name = 1, model = "cumulative"))
plot(x, item = 7, plot.type = "cumulative")
plot(x, item = 7, plot.type = "category")

## End(Not run)
</code></pre>

<hr>
<h2 id='predict.ddfMLR'>Predicted values for an object of <code>"ddfMLR"</code> class.</h2><span id='topic+predict.ddfMLR'></span>

<h3>Description</h3>

<p>S3 method for predictions from the model used in the
object of <code>"ddfMLR"</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ddfMLR'
predict(object, item = "all", match, group, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.ddfMLR_+3A_object">object</code></td>
<td>
<p>an object of <code>"ddfMLR"</code> class.</p>
</td></tr>
<tr><td><code id="predict.ddfMLR_+3A_item">item</code></td>
<td>
<p>numeric or character: either character <code>"all"</code> to
apply for all converged items (default), or a vector of item
names (column names of <code>Data</code>), or item identifiers
(integers specifying the column number).</p>
</td></tr>
<tr><td><code id="predict.ddfMLR_+3A_match">match</code></td>
<td>
<p>numeric: matching criterion for new observations.</p>
</td></tr>
<tr><td><code id="predict.ddfMLR_+3A_group">group</code></td>
<td>
<p>numeric: group membership for new observations.</p>
</td></tr>
<tr><td><code id="predict.ddfMLR_+3A_...">...</code></td>
<td>
<p>other generic parameters for <code>predict()</code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>References</h3>

<p>Hladka, A. &amp; Martinkova, P. (2020). difNLR: Generalized logistic regression models for DIF and DDF detection.
The R Journal, 12(1), 300&ndash;323, <a href="https://doi.org/10.32614/RJ-2020-014">doi:10.32614/RJ-2020-014</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ddfMLR">ddfMLR</a></code> for DDF detection among nominal data using multinomial log-linear regression model. <br />
<code><a href="stats.html#topic+predict">predict</a></code> for generic function for prediction.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# loading data
data(GMATtest, GMATkey)
Data &lt;- GMATtest[, 1:20] # items
group &lt;- GMATtest[, "group"] # group membership variable
key &lt;- GMATkey # correct answers

# testing both DDF effects
(x &lt;- ddfMLR(Data, group, focal.name = 1, key))

# fitted values
predict(x, item = 1)

# predicted values
predict(x, item = 1, match = 0, group = c(0, 1))
predict(x, item = x$DDFitems, match = 0, group = c(0, 1))

## End(Not run)

</code></pre>

<hr>
<h2 id='predict.difNLR'>Predicted values for an object of <code>"difNLR"</code> class.</h2><span id='topic+predict.difNLR'></span>

<h3>Description</h3>

<p>S3 method for predictions from the model used in the
object of <code>"difNLR"</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'difNLR'
predict(
  object,
  item = "all",
  match,
  group,
  interval = "none",
  level = 0.95,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.difNLR_+3A_object">object</code></td>
<td>
<p>an object of <code>"difNLR"</code> class.</p>
</td></tr>
<tr><td><code id="predict.difNLR_+3A_item">item</code></td>
<td>
<p>numeric or character: either character <code>"all"</code> to
apply for all converged items (default), or a vector of item
names (column names of <code>Data</code>), or item identifiers
(integers specifying the column number).</p>
</td></tr>
<tr><td><code id="predict.difNLR_+3A_match">match</code></td>
<td>
<p>numeric: matching criterion for new observations.</p>
</td></tr>
<tr><td><code id="predict.difNLR_+3A_group">group</code></td>
<td>
<p>numeric: group membership for new observations.</p>
</td></tr>
<tr><td><code id="predict.difNLR_+3A_interval">interval</code></td>
<td>
<p>character: type of interval calculation, either
<code>"none"</code> (default) or <code>"confidence"</code> for confidence
interval.</p>
</td></tr>
<tr><td><code id="predict.difNLR_+3A_level">level</code></td>
<td>
<p>numeric: confidence level.</p>
</td></tr>
<tr><td><code id="predict.difNLR_+3A_...">...</code></td>
<td>
<p>other generic parameters for <code>predict()</code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>
<p>Karel Zvara <br />
Faculty of Mathematics and Physics, Charles University <br />
</p>


<h3>References</h3>

<p>Drabinova, A. &amp; Martinkova, P. (2017). Detection of differential item functioning with nonlinear regression:
A non-IRT approach accounting for guessing. Journal of Educational Measurement, 54(4), 498&ndash;517,
<a href="https://doi.org/10.1111/jedm.12158">doi:10.1111/jedm.12158</a>.
</p>
<p>Hladka, A. &amp; Martinkova, P. (2020). difNLR: Generalized logistic regression models for DIF and DDF detection.
The R Journal, 12(1), 300&ndash;323, <a href="https://doi.org/10.32614/RJ-2020-014">doi:10.32614/RJ-2020-014</a>.
</p>
<p>Swaminathan, H. &amp; Rogers, H. J. (1990). Detecting differential item functioning using logistic regression procedures.
Journal of Educational Measurement, 27(4), 361&ndash;370, <a href="https://doi.org/10.1111/j.1745-3984.1990.tb00754.x">doi:10.1111/j.1745-3984.1990.tb00754.x</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difNLR">difNLR</a></code> for DIF detection among binary data using generalized logistic regression model. <br />
<code><a href="stats.html#topic+predict">predict</a></code> for generic function for prediction.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# loading data
data(GMAT)
Data &lt;- GMAT[, 1:20] # items
group &lt;- GMAT[, "group"] # group membership variable

# testing both DIF effects using likelihood-ratio test and
# 3PL model with fixed guessing for groups
(x &lt;- difNLR(Data, group, focal.name = 1, model = "3PLcg"))

# predicted values
summary(predict(x))
predict(x, item = 1)
predict(x, item = "Item1")

# predicted values for new observations - average score
predict(x, item = 1, match = 0, group = 0) # reference group
predict(x, item = 1, match = 0, group = 1) # focal group

# predicted values for new observations - various z-scores and groups
new.match &lt;- rep(c(-1, 0, 1), 2)
new.group &lt;- rep(c(0, 1), each = 3)
predict(x, item = 1, match = new.match, group = new.group)

# predicted values for new observations with confidence intervals
predict(x, item = 1, match = new.match, group = new.group, interval = "confidence")
predict(x, item = c(2, 4), match = new.match, group = new.group, interval = "confidence")

## End(Not run)

</code></pre>

<hr>
<h2 id='predict.difORD'>Predicted values for an object of <code>"difORD"</code> class.</h2><span id='topic+predict.difORD'></span>

<h3>Description</h3>

<p>S3 method for predictions from the model used in the
object of <code>"difORD"</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'difORD'
predict(object, item = "all", match, group, type = "category", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.difORD_+3A_object">object</code></td>
<td>
<p>an object of <code>"difORD"</code> class.</p>
</td></tr>
<tr><td><code id="predict.difORD_+3A_item">item</code></td>
<td>
<p>numeric or character: either character <code>"all"</code> to
apply for all converged items (default), or a vector of item
names (column names of <code>Data</code>), or item identifiers
(integers specifying the column number).</p>
</td></tr>
<tr><td><code id="predict.difORD_+3A_match">match</code></td>
<td>
<p>numeric: matching criterion for new observations.</p>
</td></tr>
<tr><td><code id="predict.difORD_+3A_group">group</code></td>
<td>
<p>numeric: group membership for new observations.</p>
</td></tr>
<tr><td><code id="predict.difORD_+3A_type">type</code></td>
<td>
<p>character: type of probability to be computed. Either
<code>"category"</code> for category probabilities or
<code>"cumulative"</code> for cumulative probabilities. Cumulative
probabilities are available only for cumulative logit model.</p>
</td></tr>
<tr><td><code id="predict.difORD_+3A_...">...</code></td>
<td>
<p>other generic parameters for <code>predict()</code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>References</h3>

<p>Hladka, A. &amp; Martinkova, P. (2020). difNLR: Generalized logistic regression models for DIF and DDF detection.
The R Journal, 12(1), 300&ndash;323, <a href="https://doi.org/10.32614/RJ-2020-014">doi:10.32614/RJ-2020-014</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difORD">difORD</a></code> for DIF detection among ordinal data using either cumulative logit or adjacent category logit model. <br />
<code><a href="stats.html#topic+predict">predict</a></code> for generic function for prediction.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# loading data
data(Anxiety, package = "ShinyItemAnalysis")
Data &lt;- Anxiety[, paste0("R", 1:29)] # items
group &lt;- Anxiety[, "gender"] # group membership variable

# testing both DIF effects with cumulative logit model
(x &lt;- difORD(Data, group, focal.name = 1, model = "cumulative"))

# fitted values
predict(x, item = "R6")

# predicted values
predict(x, item = "R6", match = 0, group = c(0, 1))
predict(x, item = "R6", match = 0, group = c(0, 1), type = "cumulative")
predict(x, item = c("R6", "R7"), match = 0, group = c(0, 1))

# testing both DIF effects with adjacent category logit model
(x &lt;- difORD(Data, group, focal.name = 1, model = "adjacent"))

# fitted values
predict(x, item = "R6")

# predicted values
predict(x, item = "R6", match = 0, group = c(0, 1))
predict(x, item = c("R6", "R7"), match = 0, group = c(0, 1))

## End(Not run)

</code></pre>

<hr>
<h2 id='startNLR'>Calculates starting values for non-linear regression DIF models.</h2><span id='topic+startNLR'></span>

<h3>Description</h3>

<p>Calculates starting values for <code>difNLR()</code> function based
on linear approximation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>startNLR(Data, group, model, match = "zscore", parameterization = "alternative",
         simplify = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="startNLR_+3A_data">Data</code></td>
<td>
<p>Data data.frame or matrix: dataset which rows represent
scored examinee answers (<code>"1"</code> correct, <code>"0"</code>
incorrect) and columns correspond to the items.</p>
</td></tr>
<tr><td><code id="startNLR_+3A_group">group</code></td>
<td>
<p>numeric: binary vector of group membership. <code>"0"</code>
for reference group, <code>"1"</code> for focal group.</p>
</td></tr>
<tr><td><code id="startNLR_+3A_model">model</code></td>
<td>
<p>character: generalized logistic regression model for
which starting values should be estimated. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="startNLR_+3A_match">match</code></td>
<td>
<p>character or numeric: matching criterion to be used as
estimate of trait. Can be either <code>"zscore"</code> (default,
standardized total score), <code>"score"</code> (total test score), or
numeric vector of the same length as number of observations in
<code>Data</code>.</p>
</td></tr>
<tr><td><code id="startNLR_+3A_parameterization">parameterization</code></td>
<td>
<p>character: parameterization of regression
coefficients. Possible options are <code>"classic"</code> (IRT
parameterization), <code>"alternative"</code> (default) and
<code>"logistic"</code> (logistic regression). See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="startNLR_+3A_simplify">simplify</code></td>
<td>
<p>logical: should initial values be simplified into
the matrix? This is only applicable when parameterization is the
same for all items.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The unconstrained form of 4PL generalized logistic regression model
for probability of correct answer (i.e., <code class="reqn">y = 1</code>) is
</p>
<p style="text-align: center;"><code class="reqn">P(y = 1) = (c + cDif * g) + (d + dDif * g - c - cDif * g) / (1 + exp(-(a + aDif * g) * (x - b - bDif * g))), </code>
</p>

<p>where <code class="reqn">x</code> is by default standardized total score (also called
Z-score) and <code class="reqn">g</code> is a group membership. Parameters <code class="reqn">a</code>,
<code class="reqn">b</code>, <code class="reqn">c</code>, and <code class="reqn">d</code> are discrimination, difficulty,
guessing, and inattention. Terms <code class="reqn">aDif</code>, <code class="reqn">bDif</code>,
<code class="reqn">cDif</code>, and <code class="reqn">dDif</code> then represent differences between two
groups (reference and focal) in relevant parameters.
</p>
<p>The <code>model</code> argument offers several predefined models. The options are as follows:
<code>Rasch</code> for 1PL model with discrimination parameter fixed on value 1 for both groups,
<code>1PL</code> for 1PL model with discrimination parameter fixed for both groups,
<code>2PL</code> for logistic regression model,
<code>3PLcg</code> for 3PL model with fixed guessing for both groups,
<code>3PLdg</code> for 3PL model with fixed inattention for both groups,
<code>3PLc</code> (alternatively also <code>3PL</code>) for 3PL regression model with guessing parameter,
<code>3PLd</code> for 3PL model with inattention parameter,
<code>4PLcgdg</code> for 4PL model with fixed guessing and inattention parameter for both groups,
<code>4PLcgd</code> (alternatively also <code>4PLd</code>) for 4PL model with fixed guessing for both groups,
<code>4PLcdg</code> (alternatively also <code>4PLc</code>) for 4PL model with fixed inattention for both groups,
or <code>4PL</code> for 4PL model.
</p>
<p>Three possible parameterization can be specified in
<code>"parameterization"</code> argument: <code>"classic"</code> returns IRT
parameters of reference group and differences in these parameters
between reference and focal group. <code>"alternative"</code> returns IRT
parameters of reference group, the differences in parameters
<code>"a"</code> and <code>"b"</code> between two groups and parameters
<code>"c"</code> and <code>"d"</code> for focal group. <code>"logistic"</code>
returns parameters in logistic regression parameterization.
</p>


<h3>Value</h3>

<p>A list containing elements representing items. Each element is a
named numeric vector of length 8 with initial values for
generalized logistic regression model.
</p>


<h3>Author(s)</h3>

<p>Adela Hladka (nee Drabinova) <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
Faculty of Mathematics and Physics, Charles University <br />
<a href="mailto:hladka@cs.cas.cz">hladka@cs.cas.cz</a> <br />
</p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a> <br />
</p>


<h3>References</h3>

<p>Drabinova, A. &amp; Martinkova, P. (2017). Detection of differential item functioning with nonlinear regression:
A non-IRT approach accounting for guessing. Journal of Educational Measurement, 54(4), 498&ndash;517,
<a href="https://doi.org/10.1111/jedm.12158">doi:10.1111/jedm.12158</a>.
</p>
<p>Hladka, A. (2021). Statistical models for detection of differential item functioning. Dissertation thesis.
Faculty of Mathematics and Physics, Charles University.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+difNLR">difNLR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># loading data
data(GMAT)
Data &lt;- GMAT[, 1:20] # items
group &lt;- GMAT[, "group"] # group membership variable

# starting values for 3PL model
startNLR(Data, group, model = "3PL")

# starting values for 3PL model
# simplified into single table
startNLR(Data, group, model = "3PL", simplify = TRUE)

# starting values for 3PL model
# with score as matching criterion
startNLR(Data, group, model = "3PL", match = "score")

# starting values for model specified for each item
startNLR(Data, group,
  model = c(
    rep("1PL", 5), rep("2PL", 5),
    rep("3PL", 5), rep("4PL", 5)
  )
)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
