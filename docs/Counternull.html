<!DOCTYPE html><html><head><title>Help for package Counternull</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Counternull}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adjust_pvalues'><p>Compute Fisher-Adjusted P-Values for Multiple Testing</p></a></li>
<li><a href='#create_fisher_interval'><p>Compute Fisher Interval</p></a></li>
<li><a href='#create_null_rand'><p>Create Null Randomization Distribution</p></a></li>
<li><a href='#create_randomization_matrix'><p>Create Randomization Matrix</p></a></li>
<li><a href='#find_counternull_values'><p>Find Counternull Values</p></a></li>
<li><a href='#find_test_stat'><p>Calculate Observed Test Statistic</p></a></li>
<li><a href='#sample_data'><p>Sample Data</p></a></li>
<li><a href='#sample_matrix'><p>Sample Randomization Matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Randomization-Based Inference</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.12</td>
</tr>
<tr>
<td>Description:</td>
<td>Randomization-Based Inference for customized experiments.
  Computes Fisher-Exact P-Values alongside null randomization 
  distributions. Retrieves counternull sets and generates counternull 
  distributions. Computes Fisher Intervals and Fisher-Adjusted P-Values. 
  Package includes visualization of randomization distributions and Fisher 
  Intervals. Users can input custom test statistics and their own methods for 
  randomization. 
  Rosenthal and Rubin (1994) &lt;<a href="https://doi.org/10.1111%2Fj.1467-9280.1994.tb00281.x">doi:10.1111/j.1467-9280.1994.tb00281.x</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, effsize, ggplot2, randomizr, dplyr, tidyr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ymabene/Counternull">https://github.com/ymabene/Counternull</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ymabene/Counternull/issues">https://github.com/ymabene/Counternull/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-23 23:20:38 UTC; yasmi</td>
</tr>
<tr>
<td>Author:</td>
<td>Mabene Yasmine [aut, cre],
  Bind Marie [aut],
  Harvard University [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mabene Yasmine &lt;ymabene@stanford.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-24 21:20:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='adjust_pvalues'>Compute Fisher-Adjusted P-Values for Multiple Testing</h2><span id='topic+adjust_pvalues'></span>

<h3>Description</h3>

<p>Adjusts p-values obtained from multiple comparisons. Computes Fisher-Adjusted
P-Values utilizing randomization-based method (Lee et al., 2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adjust_pvalues(ls, bw = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adjust_pvalues_+3A_ls">ls</code></td>
<td>
<p>List of &quot;null_rand&quot; objects</p>
</td></tr>
<tr><td><code id="adjust_pvalues_+3A_bw">bw</code></td>
<td>
<p>Histogram bin width (optional)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Argument &quot;ls&quot; must have a &quot;null_rand&quot; object for each p-value that needs to
be adjusted.
</p>
<p>Function plots joint p-value distribution.
</p>


<h3>Value</h3>

<p>Vector with adjusted p-values
</p>


<h3>References</h3>

<p><a href="https://doi.org/10.5705/ss.202016.0116">doi:10.5705/ss.202016.0116</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>y = sample_data$turn_angle
w = sample_data$w
n_one = create_null_rand(y, w, sample_matrix, test_stat = c("t"))
y = sample_data$turn_angle
w = sample_data$w
fun = function(x,y){
  return(invisible(ks.test(x,y)$statistic))
}
n_two = create_null_rand(y, w, sample_matrix, fun = fun,
alternative = c("greater"))
adjust_pvalues(list(n_one,n_two))
</code></pre>

<hr>
<h2 id='create_fisher_interval'>Compute Fisher Interval</h2><span id='topic+create_fisher_interval'></span>

<h3>Description</h3>

<p>Computes Fisher (Fidicual) Interval and returns object of
&quot;fisher_interval&quot; class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_fisher_interval(null_r, alpha = NULL, width = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_fisher_interval_+3A_null_r">null_r</code></td>
<td>
<p>&quot;null_rand&quot; object corresponding to data used for interval</p>
</td></tr>
<tr><td><code id="create_fisher_interval_+3A_alpha">alpha</code></td>
<td>
<p>Significance level for Fisher Interval (default = .05
for 95% confidence)</p>
</td></tr>
<tr><td><code id="create_fisher_interval_+3A_width">width</code></td>
<td>
<p>Integer indicating the number of values to search for to construct
Fisher Interval. Default value = 10000. (Increasing this argument may result
in increased accuracy of interval.) (Optional)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Call summary on &quot;fisher_interval&quot; class to retrieve information on the
Fisher Interval. Call plot on &quot;fisher_interval&quot; class for visualization
of Fisher Interval.
</p>
<p>Use &quot;create_null_rand&quot; function to produce &quot;null_rand&quot; object for first
argument.
</p>
<p>Note: The warning 'Fisher Interval coverage is smaller than specified'
indicates that there are no effect sizes found that match the p-value bounds
for the specified significance level (ie. .025 and .975 for alpha = .05).
In this case, the largest possible interval found under the significance
level alpha will be returned. Check &quot;pvalue_lower&quot; and &quot;pvalue_upper&quot;
parameters to see which p-value bounds are used.
</p>


<h3>Value</h3>

<p>Class &quot;fisher_interval&quot; with 4 entries:
</p>

<dl>
<dt>lower_bound</dt><dd><p>Lower bound of Fisher Interval</p>
</dd>
<dt>upper_bound</dt><dd><p>Upper bound of Fisher Interval</p>
</dd>
<dt>alpha</dt><dd><p>Specified significance value</p>
</dd>
<dt>pvalue_lower</dt><dd><p>P-value corresponding to lower bound of interval</p>
</dd>
<dt>pvalue_upper</dt><dd><p>P-value corresponding to upper bound of interval</p>
</dd>
<dt>range</dt><dd><p>Range of effect values tested</p>
</dd>
<dt>null_r</dt><dd><p>Specified &quot;null_rand&quot; object</p>
</dd>
</dl>



<h3>References</h3>

<p><a href="https://doi.org/10.48550/arXiv.2105.03996">doi:10.48550/arXiv.2105.03996</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
y = sample_data$turn_angle
w = sample_data$w
n_r = create_null_rand(y,w, sample_matrix, test_stat = c("diffmeans"))
f= create_fisher_interval(n_r)
summary(f)
plot(f)


</code></pre>

<hr>
<h2 id='create_null_rand'>Create Null Randomization Distribution</h2><span id='topic+create_null_rand'></span>

<h3>Description</h3>

<p>Generates null randomization distribution for a given test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_null_rand(
  y,
  w,
  rand_matrix,
  test_stat = NULL,
  fun = NULL,
  alternative = NULL,
  bw = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_null_rand_+3A_y">y</code></td>
<td>
<p>Vector of observed outcomes</p>
</td></tr>
<tr><td><code id="create_null_rand_+3A_w">w</code></td>
<td>
<p>Vector indicating treatment assignments</p>
</td></tr>
<tr><td><code id="create_null_rand_+3A_rand_matrix">rand_matrix</code></td>
<td>
<p>Matrix with permutations for experiment assignments</p>
</td></tr>
<tr><td><code id="create_null_rand_+3A_test_stat">test_stat</code></td>
<td>
<p>Name of built in test statistic function. Provide
&quot;diffmeans&quot; for difference of means, &quot;t&quot; for t test, &quot;paired-t&quot; for paired
t test, and &quot;cohens-d&quot; for cohen's d test (optional).</p>
</td></tr>
<tr><td><code id="create_null_rand_+3A_fun">fun</code></td>
<td>
<p>Test statistic function (optional).</p>
</td></tr>
<tr><td><code id="create_null_rand_+3A_alternative">alternative</code></td>
<td>
<p>Character string specifying alternative hypothesis.
Must be one of &quot;two-sided&quot; (default), &quot;greater&quot;, or &quot;less&quot;.</p>
</td></tr>
<tr><td><code id="create_null_rand_+3A_bw">bw</code></td>
<td>
<p>Bin width for histogram (optional)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Call summary on &quot;null_rand&quot; class to retrieve information on the null
randomization distribution. Call plot on &quot;null_rand&quot; class for visualization
of null randomization distribution.
</p>
<p>Assignments must be indicated in arguments &quot;w&quot; and &quot;rand_matrix&quot;
using numeric 1 or 0.
</p>
<p>Argument &quot;rand_matrix&quot; must have assignment permutations in each column
and must have the same number of rows as there are entries in &quot;w&quot;.
</p>
<p>One of either argument &quot;test_stat&quot; or &quot;fun&quot; must be specified.
</p>
<p>Argument &quot;fun&quot; must take in two parameters (treated outcomes and
control outcomes) and returns a numeric test statistic value (scalar).
</p>


<h3>Value</h3>

<p>Class &quot;null_rand&quot; with 11 entries:
</p>

<dl>
<dt>null_dist</dt><dd><p>Vector of permuted test statistics under the
null hypothesis</p>
</dd>
<dt>t_obs</dt><dd><p>Observed test statistic</p>
</dd>
<dt>counts</dt><dd><p>Number of test statistics more extreme than observed test
statistic</p>
</dd>
<dt>pvalue</dt><dd><p>Fisher-Exact P-value</p>
</dd>
<dt>alternative</dt><dd><p>Specified alternative</p>
</dd>
<dt>rand_matrix</dt><dd><p>Randomization matrix used to generate null distribution</p>
</dd>
<dt>bin_width</dt><dd><p>Specified bin width</p>
</dd>
<dt>y</dt><dd><p>Observed outcomes</p>
</dd>
<dt>w</dt><dd><p>Vector indicating treatment assignments</p>
</dd>
<dt>test_stat</dt><dd><p>Name of built in test statistic function</p>
</dd>
<dt>fun</dt><dd><p>Test statistic function</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>y = sample_data$turn_angle
w = sample_data$w
n_r = create_null_rand(y, w, sample_matrix, test_stat = c("t"))
summary(n_r)
plot(n_r)
</code></pre>

<hr>
<h2 id='create_randomization_matrix'>Create Randomization Matrix</h2><span id='topic+create_randomization_matrix'></span>

<h3>Description</h3>

<p>Creates randomization matrix of assignments for given number of units and
permutations.Returns matrix with unique randomized permutations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_randomization_matrix(units, n, block = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_randomization_matrix_+3A_units">units</code></td>
<td>
<p>Number of units in dataset</p>
</td></tr>
<tr><td><code id="create_randomization_matrix_+3A_n">n</code></td>
<td>
<p>Number of permutations</p>
</td></tr>
<tr><td><code id="create_randomization_matrix_+3A_block">block</code></td>
<td>
<p>Numeric vector with length equal to &quot;units&quot;
indicating block assignments for each unit (optional)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note, if the number of specified permutations exceeds the maximum number
of unique permutations, the matrix returned will contain the
maximum number of permutations.
</p>


<h3>Value</h3>

<p>Matrix with unique randomized permutations
</p>


<h3>Examples</h3>

<pre><code class='language-R'>create_randomization_matrix(14,128,rep(1:7, each = 2))
</code></pre>

<hr>
<h2 id='find_counternull_values'>Find Counternull Values</h2><span id='topic+find_counternull_values'></span>

<h3>Description</h3>

<p>Retrieves counternull value set and returns object of &quot;counternull&quot; class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_counternull_values(null_r, counts = NULL, width = NULL, bw = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find_counternull_values_+3A_null_r">null_r</code></td>
<td>
<p>&quot;null_rand&quot; object corresponding to data</p>
</td></tr>
<tr><td><code id="find_counternull_values_+3A_counts">counts</code></td>
<td>
<p>Vector containing lower and upper bounds for number of
test statistics more extreme than observed test statistic in
counternull randomization distribution (optional)</p>
</td></tr>
<tr><td><code id="find_counternull_values_+3A_width">width</code></td>
<td>
<p>Integer indicating the number of values to search for to retrieve
counternull set. Default value = 10000. (Increasing this argument may result
in additional counternull values being found.) (optional)</p>
</td></tr>
<tr><td><code id="find_counternull_values_+3A_bw">bw</code></td>
<td>
<p>Histogram bin width (optional)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Call summary on &quot;counternull&quot; class to retrieve range of counternull values.
Call plot on &quot;counternull&quot; class for visualization
of counternull distribution.
</p>
<p>Argument &quot;counts&quot; must contain whole numbers for bounds.Lower bound must be
smaller than upper bound. If argument is not specified, counternull values
will be obtained using the &quot;counts&quot; argument from the specified &quot;null_rand&quot;
argument.
</p>
<p>If no counternull values are found, all entries in class are set to null.
If only one set of counternull values are found, &quot;perm_two&quot;, low_two&quot;
and &quot;high_two&quot; are set to null.
</p>


<h3>Value</h3>

<p>Class &quot;counternull&quot; with 6 entries:
</p>

<dl>
<dt>counternull_perm</dt><dd><p>Counternull test statistics for first counternull set</p>
</dd>
<dt>low</dt><dd><p>Counternull test statistics for second counternull set</p>
</dd>
<dt>high</dt><dd><p>Lower bound of counternull set</p>
</dd>
<dt>counternull_perm_two</dt><dd><p>Upper bound of counternull set</p>
</dd>
<dt>low_two</dt><dd><p>Lower bound of second counternull set</p>
</dd>
<dt>high_two</dt><dd><p>Upper bound of second counternull set</p>
</dd>
<dt>null_rand</dt><dd><p>Specified &quot;null_rand&quot; object</p>
</dd>
<dt>bw</dt><dd><p>Specified bin width</p>
</dd>
</dl>



<h3>References</h3>

<p><a href="https://doi.org/10.1111/j.1467-9280.1994.tb00281.x">doi:10.1111/j.1467-9280.1994.tb00281.x</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n_r = create_null_rand(sample_data$turn_angle, sample_data$w,
sample_matrix, test_stat = c("diffmeans"))
c = find_counternull_values(n_r)
summary(c)
plot(c)
c = find_counternull_values(n_r, c(56,60))
summary(c)


</code></pre>

<hr>
<h2 id='find_test_stat'>Calculate Observed Test Statistic</h2><span id='topic+find_test_stat'></span>

<h3>Description</h3>

<p>Finds observed test statistic using treatment and control outcomes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_test_stat(y, w, test_stat = NULL, fun = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find_test_stat_+3A_y">y</code></td>
<td>
<p>Vector of observed outcomes</p>
</td></tr>
<tr><td><code id="find_test_stat_+3A_w">w</code></td>
<td>
<p>Vector indicating treatment assignments</p>
</td></tr>
<tr><td><code id="find_test_stat_+3A_test_stat">test_stat</code></td>
<td>
<p>Name of built in test statistic function. Provide
&quot;diffmeans&quot; for difference of means, &quot;t&quot; for t test, &quot;paired-t&quot; for paired
t test, and &quot;cohens-d&quot; for cohen's d test (optional)</p>
</td></tr>
<tr><td><code id="find_test_stat_+3A_fun">fun</code></td>
<td>
<p>Test statistic function (optional)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Assignments must be indicated in argument &quot;w&quot; using numeric 1 or 0.
</p>
<p>One of either argument &quot;test_stat&quot; or &quot;fun&quot; must be specified.
</p>
<p>Argument &quot;fun&quot; must take in two parameters (treated outcomes and
control outcomes) and returns a numeric test statistic value (scalar).
</p>


<h3>Value</h3>

<p>Observed test statistic (numeric)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>find_test_stat(sample_data$turn_angle, sample_data$w,
test_stat = c("diffmeans"))

find_test_stat(sample_data$turn_angle, sample_data$w,
 test_stat = c("t"))
</code></pre>

<hr>
<h2 id='sample_data'>Sample Data</h2><span id='topic+sample_data'></span>

<h3>Description</h3>

<p>This dataset is for an experiment measuring the effect
of flashing lights on the movement of fish. It includes the treatment
assignments of 156 fish and the turn angles of each fish when swimming.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_data
</code></pre>


<h3>Format</h3>

<p>A table with fish treatment assignments and turn angles:
</p>

<dl>
<dt>w</dt><dd><p>Treatment Assignment: 1 indicates exposure to flashing light
and 0 indicates no exposure</p>
</dd>
<dt>turn_angle</dt><dd><p>Angle at which the fish swim</p>
</dd>
</dl>


<hr>
<h2 id='sample_matrix'>Sample Randomization Matrix</h2><span id='topic+sample_matrix'></span>

<h3>Description</h3>

<p>This is a randomization matrix for an experiment conducted on
156 fish. This matrix contains 1,000 possible treatment assignments for
each fish.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_matrix
</code></pre>


<h3>Format</h3>

<p>A matrix with 1,000 columns:
</p>

<dl>
<dt>1</dt><dd><p>Fish is Exposed to Flashing Light</p>
</dd>
<dt>0</dt><dd><p>Fish is Not Exposed to Flashing Light</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
