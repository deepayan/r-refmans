<!DOCTYPE html><html><head><title>Help for package crrSC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {crrSC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bce'><p>Breast Cancer Data</p></a></li>
<li><a href='#cdata'><p>Clustered competing risks simulated  data</p></a></li>
<li><a href='#center'><p>Multicenter Bone  Marrow transplantation data</p></a></li>
<li><a href='#crrc'>
<p>Competing Risks Regression for Clustered Data</p></a></li>
<li><a href='#crrs'>
<p>Competing Risks Regression for Stratified Data</p></a></li>
<li><a href='#crrvvs'><p>For internal use</p></a></li>
<li><a href='#print.crrs'><p>Print method for crrs output</p></a></li>
<li><a href='#psh.test'><p>Goodness-of-fit test for proportional subdistribution hazards model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Competing Risks Regression for Stratified and Clustered Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Bingqing Zhou and Aurelien Latouche</td>
</tr>
<tr>
<td>Description:</td>
<td>Extension of 'cmprsk' to Stratified and Clustered data.    
      A goodness of fit test for Fine-Gray model is also provided.        
      Methods are detailed in the following articles: Zhou et al. (2011) &lt;<a href="https://doi.org/10.1111%2Fj.1541-0420.2010.01493.x">doi:10.1111/j.1541-0420.2010.01493.x</a>&gt;,
      Zhou et al. (2012) &lt;<a href="https://doi.org/10.1093%2Fbiostatistics%2Fkxr032">doi:10.1093/biostatistics/kxr032</a>&gt;, 
      Zhou et al. (2013) &lt;<a href="https://doi.org/10.1002%2Fsim.5815">doi:10.1002/sim.5815</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>survival</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aurelien Latouche &lt;aurelien.latouche@cnam.fr&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-10 15:45:02 UTC; al</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-10 21:20:20 UTC</td>
</tr>
</table>
<hr>
<h2 id='bce'>Breast Cancer Data</h2><span id='topic+bce'></span>

<h3>Description</h3>

<p>Data Randomly Generated According To El178 clinical trial</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bce)</code></pre>


<h3>Format</h3>

<p>A data frame with 200 observations and the following 6 variables.
</p>

<dl>
<dt><code>trt</code></dt><dd><p>Treatment: 0=Placebo, 1=Tamoxifen</p>
</dd>
<dt><code>time</code></dt><dd><p>Event time</p>
</dd>
<dt><code>type</code></dt><dd><p>Event type. 0=censored, 1=Breast Cancer recurrence , 2=Death without recurrence </p>
</dd>
<dt><code>nnodes</code></dt><dd><p>Number of positive nodes</p>
</dd>
<dt><code>tsize</code></dt><dd><p>Tumor size</p>
</dd>
<dt><code>age</code></dt><dd><p>Age</p>
</dd>   
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(bce)</code></pre>

<hr>
<h2 id='cdata'>Clustered competing risks simulated  data</h2><span id='topic+cdata'></span>

<h3>Description</h3>

<p>sample of 200 observations</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cdata)</code></pre>


<h3>Format</h3>

<p>A data frame with 200 observations and the following 4 variables. 
Simulation is detailed on the paper Competing Risk Regression for clustered data. 
Zhou, Fine, Latouche, Labopin. 2011. In Press. Biostatistics.
</p>

<dl>
<dt><code>ID</code></dt><dd><p>Id  of cluster, each cluster is of size 2</p>
</dd>
<dt><code>ftime</code></dt><dd><p>Event time</p>
</dd>
<dt><code>fstatus</code></dt><dd><p>Event type. 0=censored, 1 , 2</p>
</dd>
<dt><code>z</code></dt><dd><p>a binary covariate with P(z=1)=0.5</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(cdata)</code></pre>

<hr>
<h2 id='center'>Multicenter Bone  Marrow transplantation data</h2><span id='topic+center'></span>

<h3>Description</h3>

<p>Random sub sample of 400 patients</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(center)</code></pre>


<h3>Format</h3>

<p>A data frame with 400 observations and the following 5 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>Id of transplantation center</p>
</dd>
<dt><code>ftime</code></dt><dd><p>Event time</p>
</dd>
<dt><code>fstatus</code></dt><dd><p>Event type. 0=censored, 1=Acute or Chronic GvHD , 2=Death free of GvHD</p>
</dd>
<dt><code>cells</code></dt><dd><p>source of stem cells: peripheral blood vs bone marrow</p>
</dd>
<dt><code>fm</code></dt><dd><p>female donor to male recipient match</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(center)</code></pre>

<hr>
<h2 id='crrc'>
Competing Risks Regression for Clustered Data
</h2><span id='topic+crrc'></span>

<h3>Description</h3>

<p>Regression modeling of subdistribution hazards for clustered right censored data.
Failure times within the same cluster are dependent.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
crrc(ftime,fstatus,cov1,cov2,tf,cluster,
cengroup,failcode=1,
cencode=0, subset,
na.action=na.omit,
gtol=1e-6,maxiter=10,init)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crrc_+3A_cluster">cluster</code></td>
<td>
<p>Clustering covariate
</p>
</td></tr>
<tr><td><code id="crrc_+3A_ftime">ftime</code></td>
<td>

<p>vector of failure/censoring times
</p>
</td></tr>
<tr><td><code id="crrc_+3A_fstatus">fstatus</code></td>
<td>

<p>vector with a unique code for each failure type and a separate code for
censored observations 
</p>
</td></tr>
<tr><td><code id="crrc_+3A_cov1">cov1</code></td>
<td>

<p>matrix (nobs x ncovs) of fixed covariates (either cov1, cov2, or both
are required)
</p>
</td></tr>
<tr><td><code id="crrc_+3A_cov2">cov2</code></td>
<td>

<p>matrix of covariates that will be multiplied by functions of time; 
if used, often these covariates would also appear in cov1
to give a prop hazards effect plus a time interaction
</p>
</td></tr>
<tr><td><code id="crrc_+3A_tf">tf</code></td>
<td>

<p>functions of time.  A function that takes a vector of times as
an argument and returns a matrix whose jth column is the value of 
the time function corresponding to the jth column of cov2 evaluated
at the input time vector.  At time <code>tk</code>, the
model includes the term <code>cov2[,j]*tf(tk)[,j]</code> as a covariate.
</p>
</td></tr>
<tr><td><code id="crrc_+3A_cengroup">cengroup</code></td>
<td>

<p>vector with different values for each group with 
a distinct censoring distribution (the censoring distribution
is estimated separately within these groups).  All data in one group, if
missing. 
</p>
</td></tr>
<tr><td><code id="crrc_+3A_failcode">failcode</code></td>
<td>

<p>code of fstatus that denotes the failure type of interest
</p>
</td></tr>
<tr><td><code id="crrc_+3A_cencode">cencode</code></td>
<td>

<p>code of fstatus that denotes censored observations
</p>
</td></tr>
<tr><td><code id="crrc_+3A_subset">subset</code></td>
<td>

<p>a logical vector specifying a subset of cases to include in the
analysis
</p>
</td></tr>
<tr><td><code id="crrc_+3A_na.action">na.action</code></td>
<td>

<p>a function specifying the action to take for any cases missing any of
ftime, fstatus, cov1, cov2, cengroup, or subset.
</p>
</td></tr>
<tr><td><code id="crrc_+3A_gtol">gtol</code></td>
<td>

<p>iteration stops when a function of the gradient is <code>&lt; gtol</code>
</p>
</td></tr>
<tr><td><code id="crrc_+3A_maxiter">maxiter</code></td>
<td>

<p>maximum number of iterations in Newton algorithm (0 computes
scores and var at <code>init</code>, but performs no iterations)
</p>
</td></tr>
<tr><td><code id="crrc_+3A_init">init</code></td>
<td>

<p>initial values of regression parameters (default=all 0)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method extends Fine-Gray proportional hazards model for subdistribution (1999) to accommodate 
situations where the failure times within a cluster might be correlated since the study subjects from the same cluster share common factors
This model directly assesses the effect of covariates on the subdistribution of a particular type of
failure in a competing risks setting.  
</p>


<h3>Value</h3>

<p>Returns a list of class crr, with components
</p>
<table>
<tr><td><code>$coef</code></td>
<td>
<p>the estimated regression coefficients</p>
</td></tr>
<tr><td><code>$loglik</code></td>
<td>
<p>log pseudo-liklihood evaluated at <code>coef</code></p>
</td></tr>
<tr><td><code>$score</code></td>
<td>
<p>derivitives of the log pseudo-likelihood evaluated at <code>coef</code></p>
</td></tr>
<tr><td><code>$inf</code></td>
<td>
<p>-second derivatives of the log pseudo-likelihood</p>
</td></tr>
<tr><td><code>$var</code></td>
<td>
<p>estimated variance covariance matrix of coef</p>
</td></tr>
<tr><td><code>$res</code></td>
<td>
<p>matrix of residuals</p>
</td></tr>
<tr><td><code>$uftime</code></td>
<td>
<p>vector of unique failure times</p>
</td></tr>
<tr><td><code>$bfitj</code></td>
<td>
<p>jumps in the Breslow-type estimate of the underlying
sub-distribution cumulative hazard (used by predict.crr())</p>
</td></tr>
<tr><td><code>$tfs</code></td>
<td>
<p>the tfs matrix (output of tf(), if used)</p>
</td></tr>
<tr><td><code>$converged</code></td>
<td>
<p>TRUE if the iterative algorithm converged</p>
</td></tr>
<tr><td><code>$call</code></td>
<td>
<p>The call to crr</p>
</td></tr>
<tr><td><code>$n</code></td>
<td>
<p>The number of observations used in fitting the model</p>
</td></tr>
<tr><td><code>$n.missing</code></td>
<td>
<p>The number of observations removed from the input data
due to missing values</p>
</td></tr>
<tr><td><code>$loglik.null</code></td>
<td>
<p>The value of the log pseudo-likelihood when all the
coefficients are 0</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bingqing Zhou, <a href="mailto:bingqing.zhou@yale.edu">bingqing.zhou@yale.edu</a></p>


<h3>References</h3>

   
<p>Zhou B, Fine J, Latouche A, Labopin M.(2012). Competing Risks Regression for Clustered data. Biostatistics. 13 (3): 371-383.
</p>


<h3>See Also</h3>

<p>cmprsk
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#library(cmprsk)
#crr(ftime=cdata$ftime, fstatus=cdata$fstatus, cov1=cdata$z)
# Simulated clustered data set
data(cdata)
crrc(ftime=cdata[,1],fstatus=cdata[,2], 
cov1=cdata[,3], 
cluster=cdata[,4])
</code></pre>

<hr>
<h2 id='crrs'>
Competing Risks Regression for Stratified Data
</h2><span id='topic+crrs'></span>

<h3>Description</h3>

<p>Regression modeling of subdistribution hazards for stratified right censored data 
</p>
<p>Two types of stratification are addressed :
Regularly stratified: small number of large groups (strata) of subjects
Highly stratified: large number of small groups (strata) of subjects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
crrs(ftime, fstatus, cov1, cov2, strata, 
tf, failcode=1, cencode=0,
ctype=1, 
subsets, na.action=na.omit, 
gtol=1e-6, maxiter=10,init)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crrs_+3A_strata">strata</code></td>
<td>
<p>stratification covariate
</p>
</td></tr>
<tr><td><code id="crrs_+3A_ctype">ctype</code></td>
<td>
<p>1 if estimating censoring dist within strata (regular stratification), 
2 if estimating censoring dist across strata (highly stratification)
</p>
</td></tr>
<tr><td><code id="crrs_+3A_ftime">ftime</code></td>
<td>

<p>vector of failure/censoring times
</p>
</td></tr>
<tr><td><code id="crrs_+3A_fstatus">fstatus</code></td>
<td>

<p>vector with a unique code for each failure type and a separate code for
censored observations 
</p>
</td></tr>
<tr><td><code id="crrs_+3A_cov1">cov1</code></td>
<td>

<p>matrix (nobs x ncovs) of fixed covariates (either cov1, cov2, or both
are required)
</p>
</td></tr>
<tr><td><code id="crrs_+3A_cov2">cov2</code></td>
<td>

<p>matrix of covariates that will be multiplied by functions of time; 
if used, often these covariates would also appear in cov1
to give a prop hazards effect plus a time interaction
</p>
</td></tr>
<tr><td><code id="crrs_+3A_tf">tf</code></td>
<td>

<p>functions of time.  A function that takes a vector of times as
an argument and returns a matrix whose jth column is the value of 
the time function corresponding to the jth column of cov2 evaluated
at the input time vector.  
At time <code>tk</code>, the model includes the term <code>cov2[,j]*tf(tk)[,j]</code> as a covariate.
</p>
</td></tr>
<tr><td><code id="crrs_+3A_failcode">failcode</code></td>
<td>

<p>code of fstatus that denotes the failure type of interest
</p>
</td></tr>
<tr><td><code id="crrs_+3A_cencode">cencode</code></td>
<td>

<p>code of fstatus that denotes censored observations
</p>
</td></tr>
<tr><td><code id="crrs_+3A_subsets">subsets</code></td>
<td>

<p>a logical vector specifying a subset of cases to include in the
analysis
</p>
</td></tr>
<tr><td><code id="crrs_+3A_na.action">na.action</code></td>
<td>

<p>a function specifying the action to take for any cases missing any of
ftime, fstatus, cov1, cov2, cengroup, or subset.
</p>
</td></tr>
<tr><td><code id="crrs_+3A_gtol">gtol</code></td>
<td>

<p>iteration stops when a function of the gradient is <code>&lt; gtol</code>
</p>
</td></tr>
<tr><td><code id="crrs_+3A_maxiter">maxiter</code></td>
<td>

<p>maximum number of iterations in Newton algorithm (0 computes
scores and var at <code>init</code>, but performs no iterations)
</p>
</td></tr>
<tr><td><code id="crrs_+3A_init">init</code></td>
<td>

<p>initial values of regression parameters (default=all 0)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fits the stratified extension of the Fine and Gray model (2011).  
This model directly assesses the effect of covariates on the subdistribution 
of a particular type of failure in a competing risks setting.  
</p>


<h3>Value</h3>

<p>Returns a list of class crr, with components (see crr for details)
</p>
<table>
<tr><td><code>$coef</code></td>
<td>
<p>the estimated regression coefficients</p>
</td></tr>
<tr><td><code>$loglik</code></td>
<td>
<p>log pseudo-liklihood evaluated at <code>coef</code></p>
</td></tr>
<tr><td><code>$score</code></td>
<td>
<p>derivitives of the log pseudo-likelihood evaluated at <code>coef</code></p>
</td></tr>
<tr><td><code>$inf</code></td>
<td>
<p>-second derivatives of the log pseudo-likelihood</p>
</td></tr>
<tr><td><code>$var</code></td>
<td>
<p>estimated variance covariance matrix of coef</p>
</td></tr>
<tr><td><code>$res</code></td>
<td>
<p>matrix of residuals</p>
</td></tr>
<tr><td><code>$uftime</code></td>
<td>
<p>vector of unique failure times</p>
</td></tr>
<tr><td><code>$bfitj</code></td>
<td>
<p>jumps in the Breslow-type estimate of the underlying
sub-distribution cumulative hazard (used by predict.crr())</p>
</td></tr>
<tr><td><code>$tfs</code></td>
<td>
<p>the tfs matrix (output of tf(), if used)</p>
</td></tr>
<tr><td><code>$converged</code></td>
<td>
<p>TRUE if the iterative algorithm converged</p>
</td></tr>
<tr><td><code>$call</code></td>
<td>
<p>The call to crr</p>
</td></tr>
<tr><td><code>$n</code></td>
<td>
<p>The number of observations used in fitting the model</p>
</td></tr>
<tr><td><code>$n.missing</code></td>
<td>
<p>The number of observations removed from the input data
due to missing values</p>
</td></tr>
<tr><td><code>$loglik.null</code></td>
<td>
<p>The value of the log pseudo-likelihood when all the
coefficients are 0</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bingqing Zhou, <a href="mailto:bingqing.zhou@yale.edu">bingqing.zhou@yale.edu</a></p>


<h3>References</h3>

<p>Zhou B, Latouche A, Rocha V, Fine J. (2011). Competing Risks Regression for Stratified Data.
Biometrics. 67(2):661-70.
</p>


<h3>See Also</h3>

<p>cmprsk</p>


<h3>Examples</h3>

<pre><code class='language-R'>##
#using fine and gray model
#crr(ftime=center$ftime, fstatus=center$fstatus, 
#cov1=cbind(center$fm,center$cells))
#
# High Stratification: ctype=2
# Random sub-sample 
data(center)
cov.test&lt;-cbind(center$fm,center$cells)
crrs(ftime=center[,1],fstatus=center[,2],
cov1=cov.test,
strata=center$id,ctype=2)

</code></pre>

<hr>
<h2 id='crrvvs'>For internal use</h2><span id='topic+crrvvs'></span><span id='topic+crrfsvs'></span><span id='topic+crrfs'></span>

<h3>Description</h3>

<p>for internal use</p>


<h3>Author(s)</h3>

<p>Bingqing Zhou</p>

<hr>
<h2 id='print.crrs'>Print method for crrs output</h2><span id='topic+print.crrs'></span>

<h3>Description</h3>

<p>Prints call for crrs object</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'crrs'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.crrs_+3A_x">x</code></td>
<td>

<p>crr object (output from <code>crrs()</code>)
</p>
</td></tr>
<tr><td><code id="print.crrs_+3A_...">...</code></td>
<td>
<p>additional arguments to <code>print()</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>B. Zhou</p>

<hr>
<h2 id='psh.test'>Goodness-of-fit test for proportional subdistribution hazards model</h2><span id='topic+psh.test'></span>

<h3>Description</h3>

<p>This Goodness-of-fit test  proposed a modified weighted Schoenfeld residuals to test the proportionality of subdistribution hazards for the Fine and Gray model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psh.test(time, fstatus, z, D=c(1,1), tf=function(x) cbind(x,x^2), init)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psh.test_+3A_time">time</code></td>
<td>
<p>vector of failure times</p>
</td></tr>
<tr><td><code id="psh.test_+3A_fstatus">fstatus</code></td>
<td>
<p>  failure status =0 if censored</p>
</td></tr>
<tr><td><code id="psh.test_+3A_z">z</code></td>
<td>
<p>covariates</p>
</td></tr>
<tr><td><code id="psh.test_+3A_d">D</code></td>
<td>
<p>components of z that are tested for time-varying effect</p>
</td></tr>
<tr><td><code id="psh.test_+3A_tf">tf</code></td>
<td>
<p>functions of t for z being tested on the same location</p>
</td></tr>
<tr><td><code id="psh.test_+3A_init">init</code></td>
<td>
<p>initial values of regression parameters (default=all 0)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The proposed score test employs Schoenfeld residuals adapted to competing risks data. The form of the
test is established assuming that the non-proportionality arises via time-dependent coefficients in the
Fine-Gray model, similar to the test of Grambsch and Therneau.
</p>


<h3>Value</h3>

<p>Returns a data.frame with percentage of cens, cause 1, Test Statistic,  d.f. ,p-value
</p>


<h3>Author(s)</h3>

<p>Bingqing Zhou, <a href="mailto:bingqing.zhou@yale.edu">bingqing.zhou@yale.edu</a></p>


<h3>References</h3>

<p>Zhou B, Fine JP, Laird, G. (2013). Goodness-of-fit test for proportional subdistribution hazards mode.
Statistics in Medicine. In Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bce)
attach(bce)
lognodes &lt;- log(nnodes)
Z1 &lt;- cbind(lognodes, tsize/10, age, trt)  
# trt = 0 if placebo, = 0 treatment
# testing for linear time varying effect of trt
psh.test(time=time, fstatus=type, z=Z1, D=c(0,0,0,1), tf=function(x) x)
# testing for quadratic time varying effect of trt
psh.test(time=time, fstatus=type, z=Z1, D=c(0,0,0,1), tf=function(x) x^2)
# testing for log time varying effect of trt
psh.test(time=time, fstatus=type, z=Z1, D=c(0,0,0,1), 
tf=function(x) log(x))
# testing for both linear and quadratic time varying effect of trt
psh.test(time=time, fstatus=type, z=Z1, 
D=matrix(c(0,0,0,1,0,0,0,1), 4,2),  tf=function(x) cbind(x,x^2))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
