<!DOCTYPE html><html lang="en"><head><title>Help for package ggparallel</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ggparallel}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#genes'><p>Data linking genes and pathways.</p></a></li>
<li><a href='#ggparallel'><p>Variations of parallel coordinate plots</p></a></li>
<li><a href='#package-ggparallel'><p>A package for creating parallel coordinates for categorical data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.4.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-09</td>
</tr>
<tr>
<td>Title:</td>
<td>Variations of Parallel Coordinate Plots for Categorical Data</td>
</tr>
<tr>
<td>Description:</td>
<td>Create hammock plots, parallel sets, and common angle plots
    with 'ggplot2'.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), ggplot2 (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>reshape2 (&ge; 1.4.4), plyr (&ge; 1.8.9)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>RColorBrewer, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/heike/ggparallel/">https://github.com/heike/ggparallel/</a>,
<a href="https://heike.github.io/ggparallel/">https://heike.github.io/ggparallel/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/heike/ggparallel/issues/">https://github.com/heike/ggparallel/issues/</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-09 20:07:53 UTC; hofmann</td>
</tr>
<tr>
<td>Author:</td>
<td>Heike Hofmann <a href="https://orcid.org/0000-0001-6216-5183"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Marie Vendettuoli [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Heike Hofmann &lt;hofmann@mail.iastate.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-09 22:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='genes'>Data linking genes and pathways.</h2><span id='topic+genes'></span>

<h3>Description</h3>

<p>Table knownGene from track UCSC Genes was downloaded from the UCSC table
browser for the human genome assembly (hg18, May 2006) and filtered for a
selection of pathways associated with human metabolism was obtained from KEGG
PATHWAY database. Bioconductor package KEGG.db was used to provide mappings
between gene and pathway identifiers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genes
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 2768 rows and 14 columns.
</p>


<h3>References</h3>

<p>Fujita PA, Rhead B, Zweig AS, Hinrichs AS, Karolchik D, Cline MS,
Goldman M, Barber GP, Clawson H, Coelho A, Diekhans M, Dreszer TR, Giardine
BM, Harte RA, Hillman-Jackson J, Hsu F, Kirkup V, Kuhn RM, Learned K, Li CH,
Meyer LR, Pohl A, Raney BJ, Rosenbloom KR, Smith KE, Haussler D, Kent WJ. The
UCSC Genome Browser database: update 2011. Nucleic Acids Res. 2010 Oct 18.
<a href="http://genome.ucsc.edu/index.html?org=Human&amp;db=hg19&amp;hgsid=289810087">http://genome.ucsc.edu/index.html?org=Human&amp;db=hg19&amp;hgsid=289810087</a>
</p>
<p>Marc Carlson, Seth Falcon, Herve Pages and Nianhua Li (). KEGG.db: A set
of annotation maps for KEGG. R package version 2.6.1.
</p>
<p>Kanehisa, M., Goto, S., Sato, Y., Furumichi, M., and Tanabe, M.; KEGG for
integration and interpretation of large-scale molecular datasets. Nucleic
Acids Res. 40, D109-D114 (2012)
</p>
<p>Kanehisa, M. and Goto, S.; KEGG: Kyoto Encyclopedia of Genes and Genomes.
Nucleic Acids Res. 28, 27-30 (2000).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
library(RColorBrewer)
genes$chrom &lt;- factor(genes$chrom, levels=c(paste("chr", 1:22, sep=""),
  "chrX", "chrY"))
ggparallel(
  list("path", "chrom"),
  text.offset = c(0.03, 0,-0.03),
  data = genes,
  width = 0.1,
  order = c(1, 0),
  angle = 0,
  color = "white",
  factorlevels =  c(sapply(unique(genes$chrom), as.character),unique(genes$path))
) +
 scale_fill_manual(
   values = c(brewer.pal("YlOrRd", n = 9), rep("grey80", 24)),
   guide = "none"
 ) +
 scale_colour_manual(
   values = c(brewer.pal("YlOrRd", n = 9), rep("grey80", 24)),
   guide = "none"
 ) +
 coord_flip()
</code></pre>

<hr>
<h2 id='ggparallel'>Variations of parallel coordinate plots</h2><span id='topic+ggparallel'></span>

<h3>Description</h3>

<p><code><a href="#topic+ggparallel">ggparallel</a></code> implements and combines different types of parallel
coordinate plots for categorical data: hammock plots,  parallel sets plots,
common angle plots, and common angle plots with a hammock-like adjustment
for line widths.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggparallel(
  vars = list(),
  data,
  weight = NULL,
  method = "angle",
  alpha = 0.5,
  width = 0.25,
  order = 1,
  ratio = NULL,
  asp = NULL,
  label = TRUE,
  label.colour = "grey90",
  label.size = 4,
  text.angle = 90,
  text.offset = NULL,
  same.level = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggparallel_+3A_vars">vars</code></td>
<td>
<p>list of variable names to be included in the plotting. Order of
the variables is preserved in the display</p>
</td></tr>
<tr><td><code id="ggparallel_+3A_data">data</code></td>
<td>
<p>data frame</p>
</td></tr>
<tr><td><code id="ggparallel_+3A_weight">weight</code></td>
<td>
<p>weighting variable - use character string</p>
</td></tr>
<tr><td><code id="ggparallel_+3A_method">method</code></td>
<td>
<p>plotting method to use - one of <code>angle</code>,
<code>adj.angle</code>, <code>parset</code>,  or <code>hammock</code>, for a hammock plot
the aspect ratio needs to be fixed.</p>
</td></tr>
<tr><td><code id="ggparallel_+3A_alpha">alpha</code></td>
<td>
<p>level of alpha blending for the fill color in ribbons, value
has to be between 0 and 1, defaults to 0.5.</p>
</td></tr>
<tr><td><code id="ggparallel_+3A_width">width</code></td>
<td>
<p>width of variables</p>
</td></tr>
<tr><td><code id="ggparallel_+3A_order">order</code></td>
<td>
<p>flag variable with three levels -1, 0, 1 for levels in
decreasing order, levels in increasing order and levels unchanged. This
variable can be either a scalar or a vector</p>
</td></tr>
<tr><td><code id="ggparallel_+3A_ratio">ratio</code></td>
<td>
<p>used for methods with angle adjustments (method =
<code>'hammock', 'adj.angle'</code>): specifies the height (width for horizontal
displays) of the widest line as ratio of the overall display height (width
for horizontal displays).</p>
</td></tr>
<tr><td><code id="ggparallel_+3A_asp">asp</code></td>
<td>
<p>aspect ratio of the plot - it will be set to a default of 1 in
the case of hammock plots.</p>
</td></tr>
<tr><td><code id="ggparallel_+3A_label">label</code></td>
<td>
<p>binary variable (vector), whether labels should be shown.</p>
</td></tr>
<tr><td><code id="ggparallel_+3A_label.colour">label.colour</code></td>
<td>
<p>character of colour in which the label should be shown. Ignored, if 'label' is FALSE.</p>
</td></tr>
<tr><td><code id="ggparallel_+3A_label.size">label.size</code></td>
<td>
<p>numeric value to determine the size in which labels are shown, defaults to 4</p>
</td></tr>
<tr><td><code id="ggparallel_+3A_text.angle">text.angle</code></td>
<td>
<p>numeric value to determine the angle under which labels are shown.</p>
</td></tr>
<tr><td><code id="ggparallel_+3A_text.offset">text.offset</code></td>
<td>
<p>(vector) of values for offsetting the labels</p>
</td></tr>
<tr><td><code id="ggparallel_+3A_same.level">same.level</code></td>
<td>
<p>are all variables using the same levels? If yes, simplify the labelling</p>
</td></tr>
<tr><td><code id="ggparallel_+3A_...">...</code></td>
<td>
<p>passed on directly to all of the ggplot2 commands</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parallel sets have been suggested by <cite>kosara:2006</cite> as a visualization
technique to incorporate categorical variables into a parallel coordinate
plot introduced by <cite>wegman:1990</cite> and <cite>inselberg:1985</cite>. The parallel
sets implemented here are reduced to representations of neighboring
two-dimensional relationships only rather than the hierarchical version
originally suggested.
</p>
<p>Both versions, however, show perceptual problems with interpreting line
widths, leading to potentially wrong conclusions about the data. The hammock
display, introduced by <cite>schonlau:2003</cite>, and the common angle plots are
two approaches at fixing this problem: in Hammock plots the linewidth is
adjusted by a factor countering the strength of the illusion, in the common
angle plot all lines are adjusted to show the same angle - making line widths
again comparable across ribbons.
</p>
<p>Additionally, we can also adjust ribbons in the common angle display for the
angle, to make them appear having the same width (or height) across the
display. We refer to this method as <code>adj.angle</code>.
</p>


<h3>Value</h3>

<p>returns a  ggplot2 object that can be plotted directly or used as base
layer for additional modifications.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mtcars)

ggparallel(list("gear", "cyl"), data=mtcars)
ggparallel(list("gear", "cyl"), data=mtcars, method="hammock", ratio=0.25)

require(RColorBrewer)
require(ggplot2)
cols &lt;- c(brewer.pal(4, "Reds")[-1], brewer.pal(4, "Blues")[-1])
ggparallel(list("gear", "cyl"), ratio=0.2, data=mtcars,
           method="hammock", text.angle=0) +
  scale_fill_manual(values=cols) + scale_colour_manual(values=cols) +
  theme_bw()

## combination of common angle plot and hammock adjustment:
ggparallel(list("gear", "cyl"), data=mtcars, method="adj.angle",
           ratio=2)

## compare with method='parset'
ggparallel(list("gear", "cyl"), data=mtcars, method='parset')

## flip plot and rotate text
ggparallel(list("gear", "cyl"), data=mtcars, text.angle=0) +
  coord_flip()

## change colour scheme
ggparallel(list("gear", "cyl"), data=mtcars, text.angle=0) +
  coord_flip() +
  scale_fill_brewer(palette="Set1") +
  scale_colour_brewer(palette="Set1")

## example with more than two variables:
titanic &lt;- as.data.frame(Titanic)
ggparallel(names(titanic)[c(1,4,2,1)], order=0, titanic, weight="Freq") +
  scale_fill_brewer(palette="Paired", guide="none") +
  scale_colour_brewer(palette="Paired", guide="none")

## Not run: 
cols &lt;- c(brewer.pal(5,"Blues")[-1], brewer.pal(3, "Oranges")[-1],
          brewer.pal(3, "Greens")[-1])
ggparallel(names(titanic)[c(1,4,2,1)], order=0, titanic, weight="Freq") +
  scale_fill_manual(values=cols, guide="none") +
  scale_colour_manual(values=cols, guide="none") + theme_bw()

## hammock plot with same width lines
ggparallel(names(titanic)[c(1,4,2,3)], titanic, weight=1, asp=0.5,
           method="hammock", ratio=0.2, order=c(0,0)) +
theme( legend.position="none") +
scale_fill_brewer(palette="Paired") +
scale_colour_brewer(palette="Paired")

## hammock plot with line widths adjusted by frequency
ggparallel(names(titanic)[c(1,4,2,3)], titanic, weight="Freq",
           asp=0.5, method="hammock", order=c(0,0), text.angle=0,
           width=0.45) +
  theme( legend.position="none")


## biological examples: genes and pathways
data(genes)
cols &lt;- c(rep("grey80", 24), brewer.pal("YlOrRd", n = 9))
genes$chrom &lt;- factor(genes$chrom, levels=c(paste("chr", 1:22, sep=""), "chrX", "chrY"))
ggparallel(list("path", "chrom"), text.offset=c(0.03, 0,-0.03),
           data = genes,  width=0.1, order=c(1,0), text.angle=0,
           color="white",
   factorlevels =  c(sapply(unique(genes$chrom), as.character),
     unique(genes$path))) +
   scale_fill_manual(values = cols, guide="none") +
   scale_colour_manual(values = cols, guide="none") +
   coord_flip()

## End(Not run)

data(Titanic)
titanic &lt;- as.data.frame(Titanic)

titanic$SexSurvived &lt;- with(titanic, interaction(Sex, Survived))
titanic$SexClassSurvived &lt;- with(titanic, interaction(Sex,Class, Survived))

ggparallel(vars=list("Survived", "SexSurvived", "SexClassSurvived"), weight="Freq", data=titanic) +
  theme(legend.position="none") +
  scale_fill_manual(values = rep(c("Orange", "Steelblue"), 14)) +
  scale_colour_manual(values = rep(c("Orange", "Steelblue"), 14))

###########

p1 &lt;- ggparallel(vars=list("Survived", "SexSurvived", "SexClassSurvived"),
                 weight="Freq", data=titanic, label = FALSE) +
  theme(legend.position="none") +
  scale_fill_manual(values = rep(c("Orange", "Steelblue"), 14)) +
  scale_colour_manual(values = rep(c("Orange", "Steelblue"), 14))
p2 &lt;- ggparallel(vars=list("Survived", "SexSurvived", "SexClassSurvived"),
                 weight="Freq", data=titanic, label = TRUE) +
  theme(legend.position="none") +
  scale_fill_manual(values = rep(c("Orange", "Steelblue"), 14)) +
  scale_colour_manual(values = rep(c("Orange", "Steelblue"), 14))

ggplot_build(p2)$data[[4]]
p1 + geom_text(aes(x = x, y=y, label = label), data = ggplot_build(p2)$data[[4]])
</code></pre>

<hr>
<h2 id='package-ggparallel'>A package for creating parallel coordinates for categorical data</h2><span id='topic+package-ggparallel'></span>

<h3>Description</h3>

<p>The main function <code><a href="#topic+ggparallel">ggparallel</a></code> implements three types of
parallel coordinate plots for categorical data: hammock plots, parallel
sets plots, and common angle plots.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
