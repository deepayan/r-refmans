<!DOCTYPE html><html lang="en"><head><title>Help for package bgw</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bgw}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bgw_checkSetting'><p>bgw_checkSetting</p></a></li>
<li><a href='#bgw_drglg'><p>bgw_drglg</p></a></li>
<li><a href='#bgw_itsum'><p>bgw_itsum</p></a></li>
<li><a href='#bgw_mle'><p>bgw_mle</p></a></li>
<li><a href='#bgw_mle_setup'><p>bgw_mle_setup</p></a></li>
<li><a href='#bgw_writeIterations'><p>Writes the vector [beta,ll] to a file called <code>modelname_iterations.csv</code></p>
#
Was created using apollo_writeTheta as a starting point...
Because this is an internal function, the inputs will be assumed to be clean.</a></li>
<li><a href='#bgw-internal'><p>Internal BGW Functions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bunch-Gay-Welsch Statistical Estimation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David S. Bunch &lt;dsbunch@ucdavis.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs statistical estimation and inference-related computations
   by accessing and executing modified versions of 'Fortran' subroutines 
   originally published in the Association for Computing Machinery (ACM) 
   journal Transactions on Mathematical Software (TOMS) by Bunch, Gay and 
   Welsch (1993) &lt;<a href="https://doi.org/10.1145%2F151271.151279">doi:10.1145/151271.151279</a>&gt;. The acronym 'BGW' (from the 
   authors' last names) will be used when making reference to technical 
   content (e.g., algorithm, methodology) that originally appeared in ACM TOMS.
   A key feature of BGW is that it exploits the special structure of statistical 
   estimation problems within a trust-region-based optimization approach to 
   produce an estimation algorithm that is much more effective than the usual 
   practice of using optimization methods and codes originally developed for 
   general optimization. The 'bgw' package bundles 'R' wrapper (and related) 
   functions with modified 'Fortran' source code so that it can be compiled and 
   linked in the 'R' environment for fast execution. This version implements 
   a function ('bgw_mle.R') that performs maximum likelihood estimation (MLE) 
   for a user-provided model object that computes probabilities (a.k.a. 
   probability densities). The original motivation for producing this package 
   was to provide fast, efficient, and reliable MLE for discrete choice models 
   that can be called from the 'Apollo' choice modelling 'R' package ( 
   see <a href="http://www.apollochoicemodelling.com">http://www.apollochoicemodelling.com</a>). Starting with the release of 
   Apollo 3.0, BGW is the default estimation package. However, estimation can also 
   be performed using BGW in a stand-alone fashion without using 'Apollo' 
   (as shown in simple examples included in the package). Note also that BGW 
   capabilities are not limited to MLE, and future extension to other estimators 
   (e.g., nonlinear least squares, generalized method of moments, etc.) is possible. 
   The 'Fortran' code included in 'bgw' was modified by one of the 
   original BGW authors (Bunch) under his rights as confirmed by direct 
   consultation with the ACM Intellectual Property and Rights Manager.  See 
   <a href="https://authors.acm.org/author-resources/author-rights">https://authors.acm.org/author-resources/author-rights</a>. The main 
   requirement is clear citation of the original publication (see above). </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0),</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Author:</td>
<td>David S. Bunch <a href="https://orcid.org/0000-0001-8728-7072"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  David M. Gay [ctb],
  Roy E. Welsch [ctb],
  Stephane Hess [ctb],
  David Palma [ctb]</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-28 00:28:21 UTC; dsbunch</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-29 14:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bgw_checkSetting'>bgw_checkSetting</h2><span id='topic+bgw_checkSetting'></span>

<h3>Description</h3>

<p>Checks to see if user-provided value for a bgw_setting is valid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bgw_checkSetting(
  settingValue,
  bgw_setting_type,
  bgw_validDiscrete,
  bgw_contLB,
  bgw_contUB
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bgw_checkSetting_+3A_settingvalue">settingValue</code></td>
<td>
<p>Setting value (submitted by user).</p>
</td></tr>
<tr><td><code id="bgw_checkSetting_+3A_bgw_setting_type">bgw_setting_type</code></td>
<td>
<p>Type of setting being checked. Possible values are &quot;discrete&quot; and &quot;continuous&quot;.</p>
</td></tr>
<tr><td><code id="bgw_checkSetting_+3A_bgw_validdiscrete">bgw_validDiscrete</code></td>
<td>
<p>List. Contains valid values for a discrete setting.</p>
</td></tr>
<tr><td><code id="bgw_checkSetting_+3A_bgw_contlb">bgw_contLB</code></td>
<td>
<p>Numerical value. The lower bound for a valid continuous setting.</p>
</td></tr>
<tr><td><code id="bgw_checkSetting_+3A_bgw_contub">bgw_contUB</code></td>
<td>
<p>Numerical value. The upper bound for a valid continuous setting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical. Indicates if the setting is okay or not.
</p>

<hr>
<h2 id='bgw_drglg'>bgw_drglg</h2><span id='topic+bgw_drglg'></span>

<h3>Description</h3>

<p>An r wrapper to call drglg_c, which in turn is a wrapper
to call the Fortran subroutine drglg.
drglg is the BGW iteration driver for performing statistical parameter estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bgw_drglg(
  d,
  dr,
  iv,
  liv,
  lv,
  n,
  nd,
  nn,
  p,
  ps,
  r,
  rd,
  v,
  x,
  rhoi,
  rhor,
  i_itsum
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bgw_drglg_+3A_d">d</code></td>
<td>
<p>Scaling vector</p>
</td></tr>
<tr><td><code id="bgw_drglg_+3A_dr">dr</code></td>
<td>
<p>Derivative of the choice probability model wrt x</p>
</td></tr>
<tr><td><code id="bgw_drglg_+3A_iv">iv</code></td>
<td>
<p>BGW internal vector of integer values</p>
</td></tr>
<tr><td><code id="bgw_drglg_+3A_liv">liv</code></td>
<td>
<p>Length of iv.</p>
</td></tr>
<tr><td><code id="bgw_drglg_+3A_lv">lv</code></td>
<td>
<p>Length of v.</p>
</td></tr>
<tr><td><code id="bgw_drglg_+3A_n">n</code></td>
<td>
<p>Dimension of vector (r) of generalized residuals for the model</p>
</td></tr>
<tr><td><code id="bgw_drglg_+3A_nd">nd</code></td>
<td>
<p>Leading dimension dr. Must be at least ps.</p>
</td></tr>
<tr><td><code id="bgw_drglg_+3A_nn">nn</code></td>
<td>
<p>Leading dimension of r, rd</p>
</td></tr>
<tr><td><code id="bgw_drglg_+3A_p">p</code></td>
<td>
<p>Dimension of x (as well as d, g) = number of parameters being estimated</p>
</td></tr>
<tr><td><code id="bgw_drglg_+3A_ps">ps</code></td>
<td>
<p>Number of non-nuisance parameters (= p in this implementation)</p>
</td></tr>
<tr><td><code id="bgw_drglg_+3A_r">r</code></td>
<td>
<p>Vector of generalized residuals for the model</p>
</td></tr>
<tr><td><code id="bgw_drglg_+3A_rd">rd</code></td>
<td>
<p>Vector of storage space for regression diagonostics (not currently used)</p>
</td></tr>
<tr><td><code id="bgw_drglg_+3A_v">v</code></td>
<td>
<p>BGW internal vector of numeric values</p>
</td></tr>
<tr><td><code id="bgw_drglg_+3A_x">x</code></td>
<td>
<p>Parameter vector for which the objective function is being minimized</p>
</td></tr>
<tr><td><code id="bgw_drglg_+3A_rhoi">rhoi</code></td>
<td>
<p>Vector of integers for use by user (not currently used)</p>
</td></tr>
<tr><td><code id="bgw_drglg_+3A_rhor">rhor</code></td>
<td>
<p>Vector of numeric values for use by user (not currently used)</p>
</td></tr>
<tr><td><code id="bgw_drglg_+3A_i_itsum">i_itsum</code></td>
<td>
<p>Variable for passing itsum instruction back to bgw_mle</p>
</td></tr>
</table>


<h3>Value</h3>

<p>out List of return values.
</p>

<hr>
<h2 id='bgw_itsum'>bgw_itsum</h2><span id='topic+bgw_itsum'></span>

<h3>Description</h3>

<p>Prints iteration summary, info on initial and final x.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bgw_itsum(d, g, iv, v, x, p, betaIsNamed, betaNames = NULL, i_itsum)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bgw_itsum_+3A_d">d</code></td>
<td>
<p>Scaling vector</p>
</td></tr>
<tr><td><code id="bgw_itsum_+3A_g">g</code></td>
<td>
<p>Gradient of objective function (negative-log-likelihood) wrt x</p>
</td></tr>
<tr><td><code id="bgw_itsum_+3A_iv">iv</code></td>
<td>
<p>BGW internal vector of integer values</p>
</td></tr>
<tr><td><code id="bgw_itsum_+3A_v">v</code></td>
<td>
<p>BGW internal vector of numeric values</p>
</td></tr>
<tr><td><code id="bgw_itsum_+3A_x">x</code></td>
<td>
<p>Parameter vector for which the objective function is being minimized</p>
</td></tr>
<tr><td><code id="bgw_itsum_+3A_p">p</code></td>
<td>
<p>Dimension of x</p>
</td></tr>
<tr><td><code id="bgw_itsum_+3A_betaisnamed">betaIsNamed</code></td>
<td>
<p>Logical.</p>
</td></tr>
<tr><td><code id="bgw_itsum_+3A_betanames">betaNames</code></td>
<td>
<p>Character vector. If available, has beta parameter names.</p>
</td></tr>
<tr><td><code id="bgw_itsum_+3A_i_itsum">i_itsum</code></td>
<td>
<p>Code from caller to select specific options</p>
</td></tr>
</table>


<h3>Value</h3>

<p>iv There are iv values changed inside bgw_itsum. The iv vector is the integer workspace for Fortran BGW.
</p>

<hr>
<h2 id='bgw_mle'>bgw_mle</h2><span id='topic+bgw_mle'></span>

<h3>Description</h3>

<p>Performs maximum likelihood estimation (MLE) for the user-provided model
defined in <code>bgw_calcR</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bgw_mle(calcR, betaStart, calcJ = NULL, bgw_settings = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bgw_mle_+3A_calcr">calcR</code></td>
<td>
<p>Function that computes an n-vector (R) of model residuals for a p-vector of (numeric) parameters beta (the first argument). In this case the residuals are likelihoods (probabilities). (The beta vector can be named or unnamed.)</p>
</td></tr>
<tr><td><code id="bgw_mle_+3A_betastart">betaStart</code></td>
<td>
<p>Vector of initial starting values for beta. Can be either a named or unnamed vector.</p>
</td></tr>
<tr><td><code id="bgw_mle_+3A_calcj">calcJ</code></td>
<td>
<p>Function that computes the matrix of partial derivatives of R wrt beta (a.k.a. the Jacobian). If NULL, finite-difference derivatives are used. In matrix form, dim=c(p,n).  However, it could be stored as a vector in column-major order.</p>
</td></tr>
<tr><td><code id="bgw_mle_+3A_bgw_settings">bgw_settings</code></td>
<td>
<p>List. Contains control parameters for BGW estimation code. All parameters have default values, so user input is entirely optional.
</p>

<ul>
<li> <p><strong><code>printLevel</code></strong>: Integer (0-3). Controls the level of detail for iteration information written to the console during estimation.  0 = silent, 1 = print starting values and final solution only, 2 = short line summary, 3 = long line summary (see documentation). Default = 3.
</p>
</li>
<li> <p><strong><code>silent</code></strong>: Logical. Suppresses all output. Default = FALSE. (Currently redundant with printLevel = 0.)
</p>
</li>
<li> <p><strong><code>printNonDefaultSettings</code></strong>: Logical. Echos any user-provided bgw_settings. Default = TRUE.
</p>
</li>
<li> <p><strong><code>printStartingValues</code></strong>: Logical. Default = TRUE. Print starting values for beta.
</p>
</li>
<li> <p><strong><code>printFinalResults</code></strong>:  Logical. Default = TRUE. Print final status of estimation (convergence/error message), summary statistics (negative log-likelihood, iterations, function evals, etc.), beta, gradient, and (if available) estimated standard errors and t-ratios. (See vcHessianMethod for variance-covariance specification.)
</p>
</li>
<li> <p><strong><code>maxIterations</code></strong>: Numeric. Maximum number of iterations for the estimation. BGW default is 150.
</p>
</li>
<li> <p><strong><code>maxFunctionEvals</code></strong>: Numeric. Maximum number of objective function evaluations. BGW default is 200.
</p>
</li>
<li> <p><strong><code>modelName</code></strong>: Character. Used to create names for requested output files. Default is &quot;bgw_mle_model.&quot;
</p>
</li>
<li> <p><strong><code>outputDirectory</code></strong>: Character. Name of sub-directory (~/outputDirectory) to write output files. Default is NULL (current directory).
</p>
</li>
<li> <p><strong><code>writeItSummary</code></strong>: Logical. If TRUE, iteration information is echoed in the output file &quot;modelName_itSummary.csv&quot;. Default is FALSE. [Not currently implemented.]
</p>
</li>
<li> <p><strong><code>writeIter</code></strong>: Logical. If TRUE, parameters and log-likelihood for each iteration are written to &quot;modelName_iterations.csv&quot;. Default is FALSE.
</p>
</li>
<li> <p><strong><code>vcHessianMethod</code></strong>: Character. Method for computing the Hessian approximation used for the variance-covariance matrix (VC = H^(-1)). Options are: &quot;none&quot;,&quot;bhhh&quot;,&quot;finiteDifferences&quot;, or &quot;fdFunction&quot; (&quot;finiteDifferences&quot; automatically uses gradient differences if a gradient is available, otherwise it uses objective function differences. &quot;fdFunction&quot; allows the user to use objective function differences even if a gradient is available). Default is &quot;bhhh.&quot;
</p>
</li>
<li> <p><strong><code>scalingMethod</code></strong>: Character. Method used to compute a scaling vector (scaleVec_i, i=1,..,p). Define a matrix D = diag(scaleVec_1,..., scaleVec_p). When using scaling, values in scaleVec should be chosen so that the elements of D*beta are roughly comparable in size. The re-scaled beta is used when computing trial steps using trust regions, and when computing stopping criteria. Options are: &quot;adaptive,&quot; &quot;none,&quot; and &quot;userScaling&quot;: the default is &quot;adaptive.&quot;  For a description of the &quot;adaptive&quot; method, which updates scaleVec at each iteration using information from the model Jacobian, see Bunch, Gay, and Welsch (1993). For &quot;none,&quot; scaleVec is set to a p-vector of ones for the entire search. The &quot;userScaling&quot; option indicates that the user is supplying their own (fixed) scaleVec in bgw_settings[[&quot;userScaleVector&quot;]] (see next item). Both items must be properly set or an error occurs.
</p>
</li>
<li> <p><strong><code>userScaleVector</code></strong>: Numeric, with dimension p = number of free parameters. Can be either a named or unnamed vector. This is a user-provided scaling vector that is used ONLY in conjunction with the non-default option &quot;userScaling&quot; for bgw_settings[[&quot;scalingMethod&quot;]] (see previous item).
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>This function has been written to provide an R-based interface to Fortran estimation software published in
Bunch, Gay and Welsch (1993), &quot;Algorithm 717-Subroutines for Maximum Likelihood and Quasi-Likelihood
Estimation of Parameters in Nonlinear Regression Models,&quot; ACM Transactions on Mathematical Software, 19 (1),
March 1993, 109-130. The letters BGW will be used in various ways to denote the source of the
estimation functionality.
</p>
<p>A primary motivation was to develop a more efficient maximum likelihood estimation function for use in
the Apollo choice modelling package: see <a href="http://www.apollochoicemodelling.com/">http://www.apollochoicemodelling.com/</a>. However, we
have adopted a design whereby the BGW package is wholly independent of Apollo, and can be
used in a stand-alone fashion. Note also that the BGW Fortran subroutines are written to support
general statistical estimation for an arbitrary objective/criterion function. So, although this
version of the package is specifically written for MLE, the package may see future updates that
expand the number of estimation options (for, e.g., nonlinear least squares, generalized method of
moments, etc.).
</p>
<p>Remark: Following the convention in the numerical optimization literature, BGW minimizes the
objective function. That is, bgw_mle minimizes the negative-log-likelihood for the model calcR.
</p>


<h3>Value</h3>

<p>model object of class 'bgw_mle'. Output of a bgw maximum likelihood estimation procedure. A list with the following attributes:
</p>

<ul>
<li> <p><strong><code>betaStart</code></strong>: Vector of initial starting values.
</p>
</li>
<li> <p><strong><code>bgw_settings</code></strong>: List. The same as the input argument.
</p>
</li>
<li> <p><strong><code>hasAnalyticGrad</code></strong>: Logical. Indicates in an analytical gradient calculation was used. If the user has not provided a calcJ function (see input parameter), it is set to FALSE.
</p>
</li>
<li> <p><strong><code>numParams</code></strong>: Numeric. Number of model parameters used in calcR.
</p>
</li>
<li> <p><strong><code>numResids</code></strong>: Numeric. Number of independent observations (model residuals) in data set = dimension of calcR output.
</p>
</li>
<li> <p><strong><code>code</code></strong>: Numeric. Numeric return code from BGW.
</p>
</li>
<li> <p><strong><code>message</code></strong>: Character. Message statement characterizing termination of MLE search.
</p>
</li>
<li> <p><strong><code>betaStop</code></strong>: Vector. Value of parameter vector at conclusion of MLE search. See message to determine if beta is a valid estimate.
</p>
</li>
<li> <p><strong><code>finalLL</code></strong>: Numeric. Value of log-likelihood at betaStop.
</p>
</li>
<li> <p><strong><code>iterations</code></strong>: Numeric. Number of iterations used in MLE search. In BGW, this is the same as the number of gradient evaluations.
</p>
</li>
<li> <p><strong><code>functionEvals</code></strong>: Numeric. Number of function evaluations used in MLE search. (This excludes function evaluations used by any finite-difference calculations for the gradient and/or the vcHessian.
</p>
</li>
<li> <p><strong><code>gradient</code></strong>: Vector. The gradient evaluated at betaStop.
</p>
</li>
<li> <p><strong><code>scaleVec</code></strong>: Vector. The scaling vector at the conclusion of the MLE search. Note: In the current version, this will be a p-vector of 1's (used throughout the search). In future versions, additional scaling options may be implemented.
</p>
</li>
<li> <p><strong><code>estimate</code></strong>: Vector. MLE parameter vector obtained by BGW. The same as betaStop if a valid convergence condition is achieved. Null otherwise.
</p>
</li>
<li> <p><strong><code>maximum</code></strong>: Numeric. Final log-likelihood value for a (successful) MLE search.
</p>
</li>
<li> <p><strong><code>hessianMethodAttempted</code></strong>: String. Requested method for computing vcHessian (from bgw_settings).
</p>
</li>
<li> <p><strong><code>hessianMethodUsed</code></strong>: String. Method actually used for computing vcHessian (if vcHessian was requested, and if the computation was successful. If not, a message indicating 'no request' or 'singular vcHessian' is provided.)
</p>
</li>
<li> <p><strong><code>vcHessianConditionNumber</code></strong>: Numeric. Estimated upper bound on reciprocal of Euclidean condition number of vcHessian (if available). Set to -1 if unavailable.
</p>
</li>
<li> <p><strong><code>varcovBGW</code></strong>: Matrix. p-by-p matrix containing estimate of the variance-covariance matrix (if requested and available).
</p>
</li>
<li> <p><strong><code>vcVec</code></strong>: Vector. Lower triangle of variance-covariance matrix stored in vector form (row-major order, if requested and available).
</p>
</li>
<li> <p><strong><code>seBGW</code></strong>: Vector. Estimated standard errors for parameter estimates (if requested and available).
</p>
</li>
<li> <p><strong><code>tstatBGW</code></strong>: Vector. Estimated t-statistics (versus 0, if requested and available).
</p>
</li></ul>


<hr>
<h2 id='bgw_mle_setup'>bgw_mle_setup</h2><span id='topic+bgw_mle_setup'></span>

<h3>Description</h3>

<p>Sets up R-level storage for bgw_mle.
</p>
<p>This function replaces multiple Fortran subroutines from the BGW
Fortran code due at least in part to the prohibition against using
Fortran write statements in R packages. The current design produces
two vectors (iv_r and v_r) that mirror the main vectors required by the
Fortran code. For the moment, the idea is to create named vectors to
facilitate coding in bgw_mle. It may be that these could be deleted
(or overwritten by an as.numeric() conversion) prior to the main Fortran
calls.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bgw_mle_setup(p, n, hasAnalyticModelDeriv, control = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bgw_mle_setup_+3A_p">p</code></td>
<td>
<p>Number of parameters (components of x) being estimated. (Determined in bgw_mle from size of 'start' vector.</p>
</td></tr>
<tr><td><code id="bgw_mle_setup_+3A_n">n</code></td>
<td>
<p>Number of model residuals (in vector r). (Determined in bgw_mle by the size of the output vector from CalcR.)</p>
</td></tr>
<tr><td><code id="bgw_mle_setup_+3A_hasanalyticmodelderiv">hasAnalyticModelDeriv</code></td>
<td>
<p>Logical. TRUE if CalcRJ has been provided. FALSE means that bgw_mle must employ finite-difference gradients (which has implications for storage allocation).</p>
</td></tr>
<tr><td><code id="bgw_mle_setup_+3A_control">control</code></td>
<td>
<p>List of bgw_mle control parameters (optional). If not provided, BGW default parameters will be used. If provided, default parameters will be overwritten by those corresponding parameters provided by the caller (but these must also be checked).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>iv and v vectors used by BGW Fortran.
</p>

<hr>
<h2 id='bgw_writeIterations'>Writes the vector [beta,ll] to a file called <code>modelname_iterations.csv</code>
#
Was created using apollo_writeTheta as a starting point...
Because this is an internal function, the inputs will be assumed to be clean.</h2><span id='topic+bgw_writeIterations'></span>

<h3>Description</h3>

<p>Writes the vector [beta,ll] to a file called <code>modelname_iterations.csv</code>
#
Was created using apollo_writeTheta as a starting point...
Because this is an internal function, the inputs will be assumed to be clean.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bgw_writeIterations(beta, ll, outputFile)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bgw_writeIterations_+3A_beta">beta</code></td>
<td>
<p>vector of parameters to be written (for now, no fixed betas).</p>
</td></tr>
<tr><td><code id="bgw_writeIterations_+3A_ll">ll</code></td>
<td>
<p>scalar representing the log-likelihood of the whole model.</p>
</td></tr>
<tr><td><code id="bgw_writeIterations_+3A_outputfile">outputFile</code></td>
<td>
<p>Character. Name of the output file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing.
</p>

<hr>
<h2 id='bgw-internal'>Internal BGW Functions</h2><span id='topic+divset_c'></span><span id='topic+drglg_c'></span>

<h3>Description</h3>

<p>Internal BGW functions
</p>


<h3>Details</h3>

<p>These are not to be called by the user.
</p>


<h3>Value</h3>

<p>These functions are wrappers for 'Fortran' routines, and are not meant to be called by the user.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
