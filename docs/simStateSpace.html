<!DOCTYPE html><html><head><title>Help for package simStateSpace</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {simStateSpace}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as.data.frame.simstatespace'><p>Coerce an Object of Class <code>simstatespace</code> to a Data Frame</p></a></li>
<li><a href='#as.matrix.simstatespace'><p>Coerce an Object of Class <code>simstatespace</code> to a Matrix</p></a></li>
<li><a href='#LinSDE2SSM'><p>Convert Parameters from the Linear Stochastic Differential Equation Model</p>
to State Space Model Parameterization</a></li>
<li><a href='#plot.simstatespace'><p>Plot Method for an Object of Class <code>simstatespace</code></p></a></li>
<li><a href='#print.simstatespace'><p>Print Method for an Object of Class <code>simstatespace</code></p></a></li>
<li><a href='#SimSSMFixed'><p>Simulate Data from a State Space Model</p>
(Fixed Parameters)</a></li>
<li><a href='#SimSSMIVary'><p>Simulate Data from a State Space Model</p>
(Individual-Varying Parameters)</a></li>
<li><a href='#SimSSMLinGrowth'><p>Simulate Data from the</p>
Linear Growth Curve Model</a></li>
<li><a href='#SimSSMLinGrowthIVary'><p>Simulate Data from the</p>
Linear Growth Curve Model
(Individual-Varying Parameters)</a></li>
<li><a href='#SimSSMLinSDEFixed'><p>Simulate Data from the</p>
Linear Stochastic Differential Equation Model
using a State Space Model Parameterization
(Fixed Parameters)</a></li>
<li><a href='#SimSSMLinSDEIVary'><p>Simulate Data from the</p>
Linear Stochastic Differential Equation Model
using a State Space Model Parameterization
(Individual-Varying Parameters)</a></li>
<li><a href='#SimSSMOUFixed'><p>Simulate Data from the</p>
Ornstein–Uhlenbeck Model
using a State Space Model Parameterization
(Fixed Parameters)</a></li>
<li><a href='#SimSSMOUIVary'><p>Simulate Data from the</p>
Ornstein–Uhlenbeck Model
using a State Space Model Parameterization
(Individual-Varying Parameters)</a></li>
<li><a href='#SimSSMVARFixed'><p>Simulate Data from the Vector Autoregressive Model</p>
(Fixed Parameters)</a></li>
<li><a href='#SimSSMVARIVary'><p>Simulate Data from the Vector Autoregressive Model</p>
(Individual-Varying Parameters)</a></li>
<li><a href='#simStateSpace-package'><p>simStateSpace: Simulate Data from State Space Models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Simulate Data from State Space Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a streamlined and user-friendly framework
    for simulating data in state space models,
    particularly when the number of subjects/units (n) exceeds one,
    a scenario commonly encountered in social and behavioral sciences.
    For an introduction to state space models in social and behavioral sciences,
    refer to Chow, Ho, Hamaker, and Dolan (2010) &lt;<a href="https://doi.org/10.1080%2F10705511003661553">doi:10.1080/10705511003661553</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jeksterslab/simStateSpace">https://github.com/jeksterslab/simStateSpace</a>,
<a href="https://jeksterslab.github.io/simStateSpace/">https://jeksterslab.github.io/simStateSpace/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jeksterslab/simStateSpace/issues">https://github.com/jeksterslab/simStateSpace/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat, expm</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-15 18:17:44 UTC; root</td>
</tr>
<tr>
<td>Author:</td>
<td>Ivan Jacob Agaloos Pesigan
    <a href="https://orcid.org/0000-0003-4818-8420"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre,
    cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ivan Jacob Agaloos Pesigan &lt;r.jeksterslab@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-16 04:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='as.data.frame.simstatespace'>Coerce an Object of Class <code>simstatespace</code> to a Data Frame</h2><span id='topic+as.data.frame.simstatespace'></span>

<h3>Description</h3>

<p>Coerce an Object of Class <code>simstatespace</code> to a Data Frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simstatespace'
as.data.frame(
  x,
  row.names = NULL,
  optional = FALSE,
  eta = FALSE,
  long = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.data.frame.simstatespace_+3A_x">x</code></td>
<td>
<p>Object of class <code>simstatespace</code>.</p>
</td></tr>
<tr><td><code id="as.data.frame.simstatespace_+3A_row.names">row.names</code></td>
<td>
<p><code>NULL</code> or character vector giving the row names
for the data frame.
Missing values are not allowed.</p>
</td></tr>
<tr><td><code id="as.data.frame.simstatespace_+3A_optional">optional</code></td>
<td>
<p>Logical.
If <code>TRUE</code>, setting row names and converting column names is optional.</p>
</td></tr>
<tr><td><code id="as.data.frame.simstatespace_+3A_eta">eta</code></td>
<td>
<p>Logical.
If <code>eta = TRUE</code>, include <code>eta</code>.
If <code>eta = FALSE</code>, exclude <code>eta</code>.</p>
</td></tr>
<tr><td><code id="as.data.frame.simstatespace_+3A_long">long</code></td>
<td>
<p>Logical.
If <code>long = TRUE</code>, use long format.
If <code>long = FALSE</code>, use wide format.</p>
</td></tr>
<tr><td><code id="as.data.frame.simstatespace_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ivan Jacob Agaloos Pesigan
</p>


<h3>Examples</h3>

<pre><code class='language-R'># prepare parameters
set.seed(42)
## number of individuals
n &lt;- 5
## time points
time &lt;- 50
## dynamic structure
p &lt;- 3
mu0 &lt;- rep(x = 0, times = p)
sigma0 &lt;- diag(p)
sigma0_l &lt;- t(chol(sigma0))
alpha &lt;- rep(x = 0, times = p)
beta &lt;- 0.50 * diag(p)
psi &lt;- diag(p)
psi_l &lt;- t(chol(psi))
## measurement model
k &lt;- 3
nu &lt;- rep(x = 0, times = k)
lambda &lt;- diag(k)
theta &lt;- 0.50 * diag(k)
theta_l &lt;- t(chol(theta))
## covariates
j &lt;- 2
x &lt;- lapply(
  X = seq_len(n),
  FUN = function(i) {
    matrix(
      data = stats::rnorm(n = time * j),
      nrow = j,
      ncol = time
    )
  }
)
gamma &lt;- diag(x = 0.10, nrow = p, ncol = j)
kappa &lt;- diag(x = 0.10, nrow = k, ncol = j)

# Type 0
ssm &lt;- SimSSMFixed(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 0
)

head(as.data.frame(ssm))
head(as.data.frame(ssm, long = FALSE))

# Type 1
ssm &lt;- SimSSMFixed(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 1,
  x = x,
  gamma = gamma
)

head(as.data.frame(ssm))
head(as.data.frame(ssm, long = FALSE))

# Type 2
ssm &lt;- SimSSMFixed(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 2,
  x = x,
  gamma = gamma,
  kappa = kappa
)

head(as.data.frame(ssm))
head(as.data.frame(ssm, long = FALSE))

</code></pre>

<hr>
<h2 id='as.matrix.simstatespace'>Coerce an Object of Class <code>simstatespace</code> to a Matrix</h2><span id='topic+as.matrix.simstatespace'></span>

<h3>Description</h3>

<p>Coerce an Object of Class <code>simstatespace</code> to a Matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simstatespace'
as.matrix(x, eta = FALSE, long = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.matrix.simstatespace_+3A_x">x</code></td>
<td>
<p>Object of class <code>simstatespace</code>.</p>
</td></tr>
<tr><td><code id="as.matrix.simstatespace_+3A_eta">eta</code></td>
<td>
<p>Logical.
If <code>eta = TRUE</code>, include <code>eta</code>.
If <code>eta = FALSE</code>, exclude <code>eta</code>.</p>
</td></tr>
<tr><td><code id="as.matrix.simstatespace_+3A_long">long</code></td>
<td>
<p>Logical.
If <code>long = TRUE</code>, use long format.
If <code>long = FALSE</code>, use wide format.</p>
</td></tr>
<tr><td><code id="as.matrix.simstatespace_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ivan Jacob Agaloos Pesigan
</p>


<h3>Examples</h3>

<pre><code class='language-R'># prepare parameters
set.seed(42)
## number of individuals
n &lt;- 5
## time points
time &lt;- 50
## dynamic structure
p &lt;- 3
mu0 &lt;- rep(x = 0, times = p)
sigma0 &lt;- diag(p)
sigma0_l &lt;- t(chol(sigma0))
alpha &lt;- rep(x = 0, times = p)
beta &lt;- 0.50 * diag(p)
psi &lt;- diag(p)
psi_l &lt;- t(chol(psi))
## measurement model
k &lt;- 3
nu &lt;- rep(x = 0, times = k)
lambda &lt;- diag(k)
theta &lt;- 0.50 * diag(k)
theta_l &lt;- t(chol(theta))
## covariates
j &lt;- 2
x &lt;- lapply(
  X = seq_len(n),
  FUN = function(i) {
    matrix(
      data = stats::rnorm(n = time * j),
      nrow = j,
      ncol = time
    )
  }
)
gamma &lt;- diag(x = 0.10, nrow = p, ncol = j)
kappa &lt;- diag(x = 0.10, nrow = k, ncol = j)

# Type 0
ssm &lt;- SimSSMFixed(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 0
)

head(as.matrix(ssm))
head(as.matrix(ssm, long = FALSE))

# Type 1
ssm &lt;- SimSSMFixed(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 1,
  x = x,
  gamma = gamma
)

head(as.matrix(ssm))
head(as.matrix(ssm, long = FALSE))

# Type 2
ssm &lt;- SimSSMFixed(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 2,
  x = x,
  gamma = gamma,
  kappa = kappa
)

head(as.matrix(ssm))
head(as.matrix(ssm, long = FALSE))

</code></pre>

<hr>
<h2 id='LinSDE2SSM'>Convert Parameters from the Linear Stochastic Differential Equation Model
to State Space Model Parameterization</h2><span id='topic+LinSDE2SSM'></span>

<h3>Description</h3>

<p>This function converts parameters from
the linear stochastic differential equation model
to state space model parameterization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LinSDE2SSM(iota, phi, sigma_l, delta_t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LinSDE2SSM_+3A_iota">iota</code></td>
<td>
<p>Numeric vector.
An unobserved term that is constant over time
(<code class="reqn">\boldsymbol{\iota}</code>).</p>
</td></tr>
<tr><td><code id="LinSDE2SSM_+3A_phi">phi</code></td>
<td>
<p>Numeric matrix.
The drift matrix
which represents the rate of change of the solution
in the absence of any random fluctuations
(<code class="reqn">\boldsymbol{\Phi}</code>).</p>
</td></tr>
<tr><td><code id="LinSDE2SSM_+3A_sigma_l">sigma_l</code></td>
<td>
<p>Numeric matrix.
Cholesky factorization (<code>t(chol(sigma))</code>)
of the covariance matrix of volatility
or randomness in the process
<code class="reqn">\boldsymbol{\Sigma}</code>.</p>
</td></tr>
<tr><td><code id="LinSDE2SSM_+3A_delta_t">delta_t</code></td>
<td>
<p>Numeric.
Time interval
(<code class="reqn">\Delta_t</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let the linear stochastic equation model be given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathrm{d}
    \boldsymbol{\eta}_{i, t}
    =
    \left(
      \boldsymbol{\iota}
      +
      \boldsymbol{\Phi}
      \boldsymbol{\eta}_{i, t}
    \right)
    \mathrm{d} t
    +
    \boldsymbol{\Sigma}^{\frac{1}{2}}
    \mathrm{d}
    \mathbf{W}_{i, t}
  </code>
</p>

<p>for individual <code class="reqn">i</code> and time <code class="reqn">t</code>.
The discrete-time state space model
given below
represents the discrete-time solution
for the linear stochastic differential equation.
</p>
<p style="text-align: center;"><code class="reqn">
    \boldsymbol{\eta}_{i, t_{{l_{i}}}}
    =
    \boldsymbol{\alpha}_{\Delta t_{{l_{i}}}}
    +
    \boldsymbol{\beta}_{\Delta t_{{l_{i}}}}
    \boldsymbol{\eta}_{i, t_{l_{i} - 1}}
    +
    \boldsymbol{\zeta}_{i, t_{{l_{i}}}},
    \quad
    \mathrm{with}
    \quad
    \boldsymbol{\zeta}_{i, t_{{l_{i}}}}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \boldsymbol{\Psi}_{\Delta t_{{l_{i}}}}
    \right)
  </code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">
      \boldsymbol{\beta}_{\Delta t_{{l_{i}}}}
      =
      \exp{
        \left(
          \Delta t
          \boldsymbol{\Phi}
        \right)
      },
  </code>
</p>

<p style="text-align: center;"><code class="reqn">
      \boldsymbol{\alpha}_{\Delta t_{{l_{i}}}}
      =
      \boldsymbol{\Phi}^{-1}
      \left(
        \boldsymbol{\beta} - \mathbf{I}_{p}
      \right)
      \boldsymbol{\iota}, \quad \mathrm{and}
  </code>
</p>

<p style="text-align: center;"><code class="reqn">
      \mathrm{vec}
      \left(
        \boldsymbol{\Psi}_{\Delta t_{{l_{i}}}}
      \right)
      =
      \left[
        \left(
          \boldsymbol{\Phi} \otimes \mathbf{I}_{p}
        \right)
        +
        \left(
          \mathbf{I}_{p} \otimes \boldsymbol{\Phi}
        \right)
      \right]
      \left[
        \exp
        \left(
          \left[
            \left(
              \boldsymbol{\Phi} \otimes \mathbf{I}_{p}
            \right)
            +
            \left(
              \mathbf{I}_{p} \otimes \boldsymbol{\Phi}
            \right)
          \right]
          \Delta t
        \right)
        -
        \mathbf{I}_{p \times p}
      \right]
      \mathrm{vec}
      \left(
        \boldsymbol{\Sigma}
      \right)
  </code>
</p>

<p>where <code class="reqn">t</code> denotes continuous-time processes
that can be defined by any arbitrary time point,
<code class="reqn">t_{l_{i}}</code> the <code class="reqn">l^\mathrm{th}</code>
observed measurement occassion for individual <code class="reqn">i</code>,
<code class="reqn">p</code> the number of latent variables and
<code class="reqn">\Delta t</code> the time interval.
</p>


<h3>Value</h3>

<p>Returns a list of state space parameters:
</p>

<ul>
<li> <p><code>alpha</code>: Numeric vector.
Vector of constant values for the dynamic model
(<code class="reqn">\boldsymbol{\alpha}</code>).
</p>
</li>
<li> <p><code>beta</code>: Numeric matrix.
Transition matrix relating the values of the latent variables
from the previous time point to the current time point.
(<code class="reqn">\boldsymbol{\beta}</code>).
</p>
</li>
<li> <p><code>psi_l</code>: Numeric matrix.
Cholesky factorization (<code>t(chol(psi))</code>)
of the process noise covariance matrix
<code class="reqn">\boldsymbol{\Psi}</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Ivan Jacob Agaloos Pesigan
</p>


<h3>References</h3>

<p>Harvey, A. C. (1990).
Forecasting, structural time series models and the Kalman filter.
Cambridge University Press.
<a href="https://doi.org/10.1017/cbo9781107049994">doi:10.1017/cbo9781107049994</a>
</p>


<h3>See Also</h3>

<p>Other Simulation of State Space Models Data Functions: 
<code><a href="#topic+SimSSMFixed">SimSSMFixed</a>()</code>,
<code><a href="#topic+SimSSMIVary">SimSSMIVary</a>()</code>,
<code><a href="#topic+SimSSMLinGrowth">SimSSMLinGrowth</a>()</code>,
<code><a href="#topic+SimSSMLinGrowthIVary">SimSSMLinGrowthIVary</a>()</code>,
<code><a href="#topic+SimSSMLinSDEFixed">SimSSMLinSDEFixed</a>()</code>,
<code><a href="#topic+SimSSMLinSDEIVary">SimSSMLinSDEIVary</a>()</code>,
<code><a href="#topic+SimSSMOUFixed">SimSSMOUFixed</a>()</code>,
<code><a href="#topic+SimSSMOUIVary">SimSSMOUIVary</a>()</code>,
<code><a href="#topic+SimSSMVARFixed">SimSSMVARFixed</a>()</code>,
<code><a href="#topic+SimSSMVARIVary">SimSSMVARIVary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p &lt;- 2
iota &lt;- c(0.317, 0.230)
phi &lt;- matrix(
  data = c(
   -0.10,
   0.05,
   0.05,
   -0.10
 ),
 nrow = p
)
sigma &lt;- matrix(
  data = c(
    2.79,
    0.06,
    0.06,
    3.27
  ),
  nrow = p
)
sigma_l &lt;- t(chol(sigma))
delta_t &lt;- 0.10

LinSDE2SSM(
  iota = iota,
  phi = phi,
  sigma_l = sigma_l,
  delta_t = delta_t
)

</code></pre>

<hr>
<h2 id='plot.simstatespace'>Plot Method for an Object of Class <code>simstatespace</code></h2><span id='topic+plot.simstatespace'></span>

<h3>Description</h3>

<p>Plot Method for an Object of Class <code>simstatespace</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simstatespace'
plot(x, id = NULL, time = NULL, eta = FALSE, type = "b", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.simstatespace_+3A_x">x</code></td>
<td>
<p>Object of class <code>simstatespace</code>.</p>
</td></tr>
<tr><td><code id="plot.simstatespace_+3A_id">id</code></td>
<td>
<p>Numeric vector.
Optional <code>id</code> numbers to plot.
If <code>id = NULL</code>, plot all available data.</p>
</td></tr>
<tr><td><code id="plot.simstatespace_+3A_time">time</code></td>
<td>
<p>Numeric vector.
Optional <code>time</code> points to plot.
If <code>time = NULL</code>, plot all available data.</p>
</td></tr>
<tr><td><code id="plot.simstatespace_+3A_eta">eta</code></td>
<td>
<p>Logical.
If <code>eta = TRUE</code>, plot the latent variables.
If <code>eta = FALSE</code>, plot the observed variables.</p>
</td></tr>
<tr><td><code id="plot.simstatespace_+3A_type">type</code></td>
<td>
<p>Character indicating the type of plotting;
actually any of the types as in <code><a href="graphics.html#topic+plot.default">plot.default()</a></code>.</p>
</td></tr>
<tr><td><code id="plot.simstatespace_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ivan Jacob Agaloos Pesigan
</p>


<h3>Examples</h3>

<pre><code class='language-R'># prepare parameters
set.seed(42)
## number of individuals
n &lt;- 5
## time points
time &lt;- 50
## dynamic structure
p &lt;- 3
mu0 &lt;- rep(x = 0, times = p)
sigma0 &lt;- diag(p)
sigma0_l &lt;- t(chol(sigma0))
alpha &lt;- rep(x = 0, times = p)
beta &lt;- 0.50 * diag(p)
psi &lt;- diag(p)
psi_l &lt;- t(chol(psi))
## measurement model
k &lt;- 3
nu &lt;- rep(x = 0, times = k)
lambda &lt;- diag(k)
theta &lt;- 0.50 * diag(k)
theta_l &lt;- t(chol(theta))
## covariates
j &lt;- 2
x &lt;- lapply(
  X = seq_len(n),
  FUN = function(i) {
    matrix(
      data = stats::rnorm(n = time * j),
      nrow = j,
      ncol = time
    )
  }
)
gamma &lt;- diag(x = 0.10, nrow = p, ncol = j)
kappa &lt;- diag(x = 0.10, nrow = k, ncol = j)

# Type 0
ssm &lt;- SimSSMFixed(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 0
)

plot(ssm)
plot(ssm, id = 1:3, time = 0:9)

# Type 1
ssm &lt;- SimSSMFixed(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 1,
  x = x,
  gamma = gamma
)

plot(ssm)
plot(ssm, id = 1:3, time = 0:9)

# Type 2
ssm &lt;- SimSSMFixed(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 2,
  x = x,
  gamma = gamma,
  kappa = kappa
)

plot(ssm)
plot(ssm, id = 1:3, time = 0:9)

</code></pre>

<hr>
<h2 id='print.simstatespace'>Print Method for an Object of Class <code>simstatespace</code></h2><span id='topic+print.simstatespace'></span>

<h3>Description</h3>

<p>Print Method for an Object of Class <code>simstatespace</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simstatespace'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.simstatespace_+3A_x">x</code></td>
<td>
<p>Object of Class <code>simstatespace</code>.</p>
</td></tr>
<tr><td><code id="print.simstatespace_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints simulated data in long format.
</p>


<h3>Author(s)</h3>

<p>Ivan Jacob Agaloos Pesigan
</p>


<h3>Examples</h3>

<pre><code class='language-R'># prepare parameters
set.seed(42)
## number of individuals
n &lt;- 5
## time points
time &lt;- 50
## dynamic structure
p &lt;- 3
mu0 &lt;- rep(x = 0, times = p)
sigma0 &lt;- diag(p)
sigma0_l &lt;- t(chol(sigma0))
alpha &lt;- rep(x = 0, times = p)
beta &lt;- 0.50 * diag(p)
psi &lt;- diag(p)
psi_l &lt;- t(chol(psi))
## measurement model
k &lt;- 3
nu &lt;- rep(x = 0, times = k)
lambda &lt;- diag(k)
theta &lt;- 0.50 * diag(k)
theta_l &lt;- t(chol(theta))
## covariates
j &lt;- 2
x &lt;- lapply(
  X = seq_len(n),
  FUN = function(i) {
    matrix(
      data = stats::rnorm(n = time * j),
      nrow = j,
      ncol = time
    )
  }
)
gamma &lt;- diag(x = 0.10, nrow = p, ncol = j)
kappa &lt;- diag(x = 0.10, nrow = k, ncol = j)

# Type 0
ssm &lt;- SimSSMFixed(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 0
)

print(ssm)

# Type 1
ssm &lt;- SimSSMFixed(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 1,
  x = x,
  gamma = gamma
)

print(ssm)

# Type 2
ssm &lt;- SimSSMFixed(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 2,
  x = x,
  gamma = gamma,
  kappa = kappa
)

print(ssm)

</code></pre>

<hr>
<h2 id='SimSSMFixed'>Simulate Data from a State Space Model
(Fixed Parameters)</h2><span id='topic+SimSSMFixed'></span>

<h3>Description</h3>

<p>This function simulates data using a state space model.
It assumes that the parameters remain constant
across individuals and over time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimSSMFixed(
  n,
  time,
  delta_t = 1,
  mu0,
  sigma0_l,
  alpha,
  beta,
  psi_l,
  nu,
  lambda,
  theta_l,
  type = 0,
  x = NULL,
  gamma = NULL,
  kappa = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimSSMFixed_+3A_n">n</code></td>
<td>
<p>Positive integer.
Number of individuals.</p>
</td></tr>
<tr><td><code id="SimSSMFixed_+3A_time">time</code></td>
<td>
<p>Positive integer.
Number of time points.</p>
</td></tr>
<tr><td><code id="SimSSMFixed_+3A_delta_t">delta_t</code></td>
<td>
<p>Numeric.
Time interval.
The default value is <code>1.0</code>
with an option to use a numeric value
for the discretized state space model
parameterization of the
linear stochastic differential equation model.</p>
</td></tr>
<tr><td><code id="SimSSMFixed_+3A_mu0">mu0</code></td>
<td>
<p>Numeric vector.
Mean of initial latent variable values
(<code class="reqn">\boldsymbol{\mu}_{\boldsymbol{\eta} \mid 0}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMFixed_+3A_sigma0_l">sigma0_l</code></td>
<td>
<p>Numeric matrix.
Cholesky factorization (<code>t(chol(sigma0))</code>)
of the covariance matrix
of initial latent variable values
(<code class="reqn">\boldsymbol{\Sigma}_{\boldsymbol{\eta} \mid 0}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMFixed_+3A_alpha">alpha</code></td>
<td>
<p>Numeric vector.
Vector of constant values for the dynamic model
(<code class="reqn">\boldsymbol{\alpha}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMFixed_+3A_beta">beta</code></td>
<td>
<p>Numeric matrix.
Transition matrix relating the values of the latent variables
at the previous to the current time point
(<code class="reqn">\boldsymbol{\beta}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMFixed_+3A_psi_l">psi_l</code></td>
<td>
<p>Numeric matrix.
Cholesky factorization (<code>t(chol(psi))</code>)
of the covariance matrix
of the process noise
(<code class="reqn">\boldsymbol{\Psi}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMFixed_+3A_nu">nu</code></td>
<td>
<p>Numeric vector.
Vector of intercept values for the measurement model
(<code class="reqn">\boldsymbol{\nu}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMFixed_+3A_lambda">lambda</code></td>
<td>
<p>Numeric matrix.
Factor loading matrix linking the latent variables
to the observed variables
(<code class="reqn">\boldsymbol{\Lambda}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMFixed_+3A_theta_l">theta_l</code></td>
<td>
<p>Numeric matrix.
Cholesky factorization (<code>t(chol(theta))</code>)
of the covariance matrix
of the measurement error
(<code class="reqn">\boldsymbol{\Theta}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMFixed_+3A_type">type</code></td>
<td>
<p>Integer.
State space model type.
See Details for more information.</p>
</td></tr>
<tr><td><code id="SimSSMFixed_+3A_x">x</code></td>
<td>
<p>List.
Each element of the list is a matrix of covariates
for each individual <code>i</code> in <code>n</code>.
The number of columns in each matrix
should be equal to <code>time</code>.</p>
</td></tr>
<tr><td><code id="SimSSMFixed_+3A_gamma">gamma</code></td>
<td>
<p>Numeric matrix.
Matrix linking the covariates to the latent variables
at current time point
(<code class="reqn">\boldsymbol{\Gamma}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMFixed_+3A_kappa">kappa</code></td>
<td>
<p>Numeric matrix.
Matrix linking the covariates to the observed variables
at current time point
(<code class="reqn">\boldsymbol{\kappa}</code>).</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>Type 0</h4>

<p>The measurement model is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathbf{y}_{i, t}
    =
    \boldsymbol{\nu}
    +
    \boldsymbol{\Lambda}
    \boldsymbol{\eta}_{i, t}
    +
    \boldsymbol{\varepsilon}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \boldsymbol{\varepsilon}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \boldsymbol{\Theta}
    \right)
  </code>
</p>

<p>where
<code class="reqn">\mathbf{y}_{i, t}</code>,
<code class="reqn">\boldsymbol{\eta}_{i, t}</code>,
and
<code class="reqn">\boldsymbol{\varepsilon}_{i, t}</code>
are random variables
and
<code class="reqn">\boldsymbol{\nu}</code>,
<code class="reqn">\boldsymbol{\Lambda}</code>,
and
<code class="reqn">\boldsymbol{\Theta}</code>
are model parameters.
<code class="reqn">\mathbf{y}_{i, t}</code>
represents a vector of observed random variables,
<code class="reqn">\boldsymbol{\eta}_{i, t}</code>
a vector of latent random variables,
and
<code class="reqn">\boldsymbol{\varepsilon}_{i, t}</code>
a vector of random measurement errors,
at time <code class="reqn">t</code> and individual <code class="reqn">i</code>.
<code class="reqn">\boldsymbol{\nu}</code>
denotes a vector of intercepts,
<code class="reqn">\boldsymbol{\Lambda}</code>
a matrix of factor loadings,
and
<code class="reqn">\boldsymbol{\Theta}</code>
the covariance matrix of
<code class="reqn">\boldsymbol{\varepsilon}</code>.
</p>
<p>An alternative representation of the measurement error
is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \boldsymbol{\varepsilon}_{i, t}
    =
    \boldsymbol{\Theta}^{\frac{1}{2}}
    \mathbf{z}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \mathbf{z}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \mathbf{I}
    \right)
  </code>
</p>

<p>where
<code class="reqn">\mathbf{z}_{i, t}</code> is a vector of
independent standard normal random variables and
<code class="reqn">
    \left( \boldsymbol{\Theta}^{\frac{1}{2}} \right)
    \left( \boldsymbol{\Theta}^{\frac{1}{2}} \right)^{\prime}
    =
    \boldsymbol{\Theta} .
  </code>
</p>
<p>The dynamic structure is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \boldsymbol{\eta}_{i, t}
    =
    \boldsymbol{\alpha}
    +
    \boldsymbol{\beta}
    \boldsymbol{\eta}_{i, t - 1}
    +
    \boldsymbol{\zeta}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \boldsymbol{\zeta}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \boldsymbol{\Psi}
    \right)
  </code>
</p>

<p>where
<code class="reqn">\boldsymbol{\eta}_{i, t}</code>,
<code class="reqn">\boldsymbol{\eta}_{i, t - 1}</code>,
and
<code class="reqn">\boldsymbol{\zeta}_{i, t}</code>
are random variables,
and
<code class="reqn">\boldsymbol{\alpha}</code>,
<code class="reqn">\boldsymbol{\beta}</code>,
and
<code class="reqn">\boldsymbol{\Psi}</code>
are model parameters.
Here,
<code class="reqn">\boldsymbol{\eta}_{i, t}</code>
is a vector of latent variables
at time <code class="reqn">t</code> and individual <code class="reqn">i</code>,
<code class="reqn">\boldsymbol{\eta}_{i, t - 1}</code>
represents a vector of latent variables
at time <code class="reqn">t - 1</code> and individual <code class="reqn">i</code>,
and
<code class="reqn">\boldsymbol{\zeta}_{i, t}</code>
represents a vector of dynamic noise
at time <code class="reqn">t</code> and individual <code class="reqn">i</code>.
<code class="reqn">\boldsymbol{\alpha}</code>
denotes a vector of intercepts,
<code class="reqn">\boldsymbol{\beta}</code>
a matrix of autoregression
and cross regression coefficients,
and
<code class="reqn">\boldsymbol{\Psi}</code>
the covariance matrix of
<code class="reqn">\boldsymbol{\zeta}_{i, t}</code>.
</p>
<p>An alternative representation of the dynamic noise
is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \boldsymbol{\zeta}_{i, t}
    =
    \boldsymbol{\Psi}^{\frac{1}{2}}
    \mathbf{z}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \mathbf{z}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \mathbf{I}
    \right)
  </code>
</p>

<p>where
<code class="reqn">
    \left( \boldsymbol{\Psi}^{\frac{1}{2}} \right)
    \left( \boldsymbol{\Psi}^{\frac{1}{2}} \right)^{\prime}
    =
    \boldsymbol{\Psi} .
  </code>
</p>



<h4>Type 1</h4>

<p>The measurement model is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathbf{y}_{i, t}
    =
    \boldsymbol{\nu}
    +
    \boldsymbol{\Lambda}
    \boldsymbol{\eta}_{i, t}
    +
    \boldsymbol{\varepsilon}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \boldsymbol{\varepsilon}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \boldsymbol{\Theta}
    \right) .
  </code>
</p>

<p>The dynamic structure is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \boldsymbol{\eta}_{i, t}
    =
    \boldsymbol{\alpha}
    +
    \boldsymbol{\beta}
    \boldsymbol{\eta}_{i, t - 1}
    +
    \boldsymbol{\Gamma}
    \mathbf{x}_{i, t}
    +
    \boldsymbol{\zeta}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \boldsymbol{\zeta}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \boldsymbol{\Psi}
    \right)
  </code>
</p>

<p>where
<code class="reqn">\mathbf{x}_{i, t}</code> represents a vector of covariates
at time <code class="reqn">t</code> and individual <code class="reqn">i</code>,
and <code class="reqn">\boldsymbol{\Gamma}</code> the coefficient matrix
linking the covariates to the latent variables.
</p>



<h4>Type 2</h4>

<p>The measurement model is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathbf{y}_{i, t}
    =
    \boldsymbol{\nu}
    +
    \boldsymbol{\Lambda}
    \boldsymbol{\eta}_{i, t}
    +
    \boldsymbol{\kappa}
    \mathbf{x}_{i, t}
    +
    \boldsymbol{\varepsilon}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \boldsymbol{\varepsilon}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \boldsymbol{\Theta}
    \right)
  </code>
</p>

<p>where
<code class="reqn">\boldsymbol{\kappa}</code> represents the coefficient matrix
linking the covariates to the observed variables.
</p>
<p>The dynamic structure is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \boldsymbol{\eta}_{i, t}
    =
    \boldsymbol{\alpha}
    +
    \boldsymbol{\beta}
    \boldsymbol{\eta}_{i, t - 1}
    +
    \boldsymbol{\Gamma}
    \mathbf{x}_{i, t}
    +
    \boldsymbol{\zeta}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \boldsymbol{\zeta}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \boldsymbol{\Psi}
    \right) .
  </code>
</p>




<h3>Value</h3>

<p>Returns an object of class <code>simstatespace</code>
which is a list with the following elements:
</p>

<ul>
<li> <p><code>call</code>: Function call.
</p>
</li>
<li> <p><code>args</code>: Function arguments.
</p>
</li>
<li> <p><code>data</code>: Generated data which is a list of length <code>n</code>.
Each element of <code>data</code> is a list with the following elements:
</p>

<ul>
<li> <p><code>id</code>: A vector of ID numbers with length <code>l</code>,
where <code>l</code> is the value of the function argument <code>time</code>.
</p>
</li>
<li> <p><code>time</code>: A vector time points of length <code>l</code>.
</p>
</li>
<li> <p><code>y</code>: A <code>l</code> by <code>k</code> matrix of values for the manifest variables.
</p>
</li>
<li> <p><code>eta</code>: A <code>l</code> by <code>p</code> matrix of values for the latent variables.
</p>
</li>
<li> <p><code>x</code>: A <code>l</code> by <code>j</code> matrix of values for the covariates
(when covariates are included).
</p>
</li></ul>

</li>
<li> <p><code>fun</code>: Function used.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Ivan Jacob Agaloos Pesigan
</p>


<h3>References</h3>

<p>Chow, S.-M., Ho, M. R., Hamaker, E. L., &amp; Dolan, C. V. (2010).
Equivalence and differences between structural equation modeling
and state-space modeling techniques.
<em>Structural Equation Modeling: A Multidisciplinary Journal</em>,
17(2), 303–332.
<a href="https://doi.org/10.1080/10705511003661553">doi:10.1080/10705511003661553</a>
</p>


<h3>See Also</h3>

<p>Other Simulation of State Space Models Data Functions: 
<code><a href="#topic+LinSDE2SSM">LinSDE2SSM</a>()</code>,
<code><a href="#topic+SimSSMIVary">SimSSMIVary</a>()</code>,
<code><a href="#topic+SimSSMLinGrowth">SimSSMLinGrowth</a>()</code>,
<code><a href="#topic+SimSSMLinGrowthIVary">SimSSMLinGrowthIVary</a>()</code>,
<code><a href="#topic+SimSSMLinSDEFixed">SimSSMLinSDEFixed</a>()</code>,
<code><a href="#topic+SimSSMLinSDEIVary">SimSSMLinSDEIVary</a>()</code>,
<code><a href="#topic+SimSSMOUFixed">SimSSMOUFixed</a>()</code>,
<code><a href="#topic+SimSSMOUIVary">SimSSMOUIVary</a>()</code>,
<code><a href="#topic+SimSSMVARFixed">SimSSMVARFixed</a>()</code>,
<code><a href="#topic+SimSSMVARIVary">SimSSMVARIVary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># prepare parameters
set.seed(42)
## number of individuals
n &lt;- 5
## time points
time &lt;- 50
## dynamic structure
p &lt;- 3
mu0 &lt;- rep(x = 0, times = p)
sigma0 &lt;- 0.001 * diag(p)
sigma0_l &lt;- t(chol(sigma0))
alpha &lt;- rep(x = 0, times = p)
beta &lt;- 0.50 * diag(p)
psi &lt;- 0.001 * diag(p)
psi_l &lt;- t(chol(psi))
## measurement model
k &lt;- 3
nu &lt;- rep(x = 0, times = k)
lambda &lt;- diag(k)
theta &lt;- 0.001 * diag(k)
theta_l &lt;- t(chol(theta))
## covariates
j &lt;- 2
x &lt;- lapply(
  X = seq_len(n),
  FUN = function(i) {
    matrix(
      data = stats::rnorm(n = time * j),
      nrow = j,
      ncol = time
    )
  }
)
gamma &lt;- diag(x = 0.10, nrow = p, ncol = j)
kappa &lt;- diag(x = 0.10, nrow = k, ncol = j)

# Type 0
ssm &lt;- SimSSMFixed(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 0
)

plot(ssm)

# Type 1
ssm &lt;- SimSSMFixed(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 1,
  x = x,
  gamma = gamma
)

plot(ssm)

# Type 2
ssm &lt;- SimSSMFixed(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 2,
  x = x,
  gamma = gamma,
  kappa = kappa
)

plot(ssm)

</code></pre>

<hr>
<h2 id='SimSSMIVary'>Simulate Data from a State Space Model
(Individual-Varying Parameters)</h2><span id='topic+SimSSMIVary'></span>

<h3>Description</h3>

<p>This function simulates data using a state space model.
It assumes that the parameters can vary
across individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimSSMIVary(
  n,
  time,
  delta_t = 1,
  mu0,
  sigma0_l,
  alpha,
  beta,
  psi_l,
  nu,
  lambda,
  theta_l,
  type = 0,
  x = NULL,
  gamma = NULL,
  kappa = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimSSMIVary_+3A_n">n</code></td>
<td>
<p>Positive integer.
Number of individuals.</p>
</td></tr>
<tr><td><code id="SimSSMIVary_+3A_time">time</code></td>
<td>
<p>Positive integer.
Number of time points.</p>
</td></tr>
<tr><td><code id="SimSSMIVary_+3A_delta_t">delta_t</code></td>
<td>
<p>Numeric.
Time interval.
The default value is <code>1.0</code>
with an option to use a numeric value
for the discretized state space model
parameterization of the
linear stochastic differential equation model.</p>
</td></tr>
<tr><td><code id="SimSSMIVary_+3A_mu0">mu0</code></td>
<td>
<p>List of numeric vectors.
Each element of the list
is the mean of initial latent variable values
(<code class="reqn">\boldsymbol{\mu}_{\boldsymbol{\eta} \mid 0}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMIVary_+3A_sigma0_l">sigma0_l</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the Cholesky factorization (<code>t(chol(sigma0))</code>)
of the covariance matrix
of initial latent variable values
(<code class="reqn">\boldsymbol{\Sigma}_{\boldsymbol{\eta} \mid 0}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMIVary_+3A_alpha">alpha</code></td>
<td>
<p>List of numeric vectors.
Each element of the list
is the vector of constant values for the dynamic model
(<code class="reqn">\boldsymbol{\alpha}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMIVary_+3A_beta">beta</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the transition matrix relating the values of the latent variables
at the previous to the current time point
(<code class="reqn">\boldsymbol{\beta}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMIVary_+3A_psi_l">psi_l</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the Cholesky factorization (<code>t(chol(psi))</code>)
of the covariance matrix
of the process noise
(<code class="reqn">\boldsymbol{\Psi}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMIVary_+3A_nu">nu</code></td>
<td>
<p>List of numeric vectors.
Each element of the list
is the vector of intercept values for the measurement model
(<code class="reqn">\boldsymbol{\nu}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMIVary_+3A_lambda">lambda</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the factor loading matrix linking the latent variables
to the observed variables
(<code class="reqn">\boldsymbol{\Lambda}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMIVary_+3A_theta_l">theta_l</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the Cholesky factorization (<code>t(chol(theta))</code>)
of the covariance matrix
of the measurement error
(<code class="reqn">\boldsymbol{\Theta}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMIVary_+3A_type">type</code></td>
<td>
<p>Integer.
State space model type.
See Details in <code><a href="#topic+SimSSMFixed">SimSSMFixed()</a></code> for more information.</p>
</td></tr>
<tr><td><code id="SimSSMIVary_+3A_x">x</code></td>
<td>
<p>List.
Each element of the list is a matrix of covariates
for each individual <code>i</code> in <code>n</code>.
The number of columns in each matrix
should be equal to <code>time</code>.</p>
</td></tr>
<tr><td><code id="SimSSMIVary_+3A_gamma">gamma</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the matrix linking the covariates to the latent variables
at current time point
(<code class="reqn">\boldsymbol{\Gamma}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMIVary_+3A_kappa">kappa</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the matrix linking the covariates to the observed variables
at current time point
(<code class="reqn">\boldsymbol{\kappa}</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parameters can vary across individuals
by providing a list of parameter values.
If the length of any of the parameters
(<code>mu0</code>,
<code>sigma0_l</code>,
<code>alpha</code>,
<code>beta</code>,
<code>psi_l</code>,
<code>nu</code>,
<code>lambda</code>,
<code>theta_l</code>,
<code>gamma</code>, or
<code>kappa</code>)
is less the <code>n</code>,
the function will cycle through the available values.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>simstatespace</code>
which is a list with the following elements:
</p>

<ul>
<li> <p><code>call</code>: Function call.
</p>
</li>
<li> <p><code>args</code>: Function arguments.
</p>
</li>
<li> <p><code>data</code>: Generated data which is a list of length <code>n</code>.
Each element of <code>data</code> is a list with the following elements:
</p>

<ul>
<li> <p><code>id</code>: A vector of ID numbers with length <code>l</code>,
where <code>l</code> is the value of the function argument <code>time</code>.
</p>
</li>
<li> <p><code>time</code>: A vector time points of length <code>l</code>.
</p>
</li>
<li> <p><code>y</code>: A <code>l</code> by <code>k</code> matrix of values for the manifest variables.
</p>
</li>
<li> <p><code>eta</code>: A <code>l</code> by <code>p</code> matrix of values for the latent variables.
</p>
</li>
<li> <p><code>x</code>: A <code>l</code> by <code>j</code> matrix of values for the covariates
(when covariates are included).
</p>
</li></ul>

</li>
<li> <p><code>fun</code>: Function used.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Ivan Jacob Agaloos Pesigan
</p>


<h3>References</h3>

<p>Chow, S.-M., Ho, M. R., Hamaker, E. L., &amp; Dolan, C. V. (2010).
Equivalence and differences between structural equation modeling
and state-space modeling techniques.
<em>Structural Equation Modeling: A Multidisciplinary Journal</em>,
17(2), 303–332.
<a href="https://doi.org/10.1080/10705511003661553">doi:10.1080/10705511003661553</a>
</p>


<h3>See Also</h3>

<p>Other Simulation of State Space Models Data Functions: 
<code><a href="#topic+LinSDE2SSM">LinSDE2SSM</a>()</code>,
<code><a href="#topic+SimSSMFixed">SimSSMFixed</a>()</code>,
<code><a href="#topic+SimSSMLinGrowth">SimSSMLinGrowth</a>()</code>,
<code><a href="#topic+SimSSMLinGrowthIVary">SimSSMLinGrowthIVary</a>()</code>,
<code><a href="#topic+SimSSMLinSDEFixed">SimSSMLinSDEFixed</a>()</code>,
<code><a href="#topic+SimSSMLinSDEIVary">SimSSMLinSDEIVary</a>()</code>,
<code><a href="#topic+SimSSMOUFixed">SimSSMOUFixed</a>()</code>,
<code><a href="#topic+SimSSMOUIVary">SimSSMOUIVary</a>()</code>,
<code><a href="#topic+SimSSMVARFixed">SimSSMVARFixed</a>()</code>,
<code><a href="#topic+SimSSMVARIVary">SimSSMVARIVary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># prepare parameters
# In this example, beta varies across individuals.
set.seed(42)
## number of individuals
n &lt;- 5
## time points
time &lt;- 50
## dynamic structure
p &lt;- 3
mu0 &lt;- list(
  rep(x = 0, times = p)
)
sigma0 &lt;- 0.001 * diag(p)
sigma0_l &lt;- list(
  t(chol(sigma0))
)
alpha &lt;- list(
  rep(x = 0, times = p)
)
beta &lt;- list(
  0.1 * diag(p),
  0.2 * diag(p),
  0.3 * diag(p),
  0.4 * diag(p),
  0.5 * diag(p)
)
psi &lt;- 0.001 * diag(p)
psi_l &lt;- list(
  t(chol(psi))
)
## measurement model
k &lt;- 3
nu &lt;- list(
  rep(x = 0, times = k)
)
lambda &lt;- list(
  diag(k)
)
theta &lt;- 0.001 * diag(k)
theta_l &lt;- list(
  t(chol(theta))
)
## covariates
j &lt;- 2
x &lt;- lapply(
  X = seq_len(n),
  FUN = function(i) {
    matrix(
      data = stats::rnorm(n = time * j),
      nrow = j,
      ncol = time
    )
  }
)
gamma &lt;- list(
  diag(x = 0.10, nrow = p, ncol = j)
)
kappa &lt;- list(
  diag(x = 0.10, nrow = k, ncol = j)
)

# Type 0
ssm &lt;- SimSSMIVary(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 0
)

plot(ssm)

# Type 1
ssm &lt;- SimSSMIVary(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 1,
  x = x,
  gamma = gamma
)

plot(ssm)

# Type 2
ssm &lt;- SimSSMIVary(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 2,
  x = x,
  gamma = gamma,
  kappa = kappa
)

plot(ssm)

</code></pre>

<hr>
<h2 id='SimSSMLinGrowth'>Simulate Data from the
Linear Growth Curve Model</h2><span id='topic+SimSSMLinGrowth'></span>

<h3>Description</h3>

<p>This function simulates data from the
linear growth curve model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimSSMLinGrowth(
  n,
  time,
  mu0,
  sigma0_l,
  theta_l,
  type = 0,
  x = NULL,
  gamma = NULL,
  kappa = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimSSMLinGrowth_+3A_n">n</code></td>
<td>
<p>Positive integer.
Number of individuals.</p>
</td></tr>
<tr><td><code id="SimSSMLinGrowth_+3A_time">time</code></td>
<td>
<p>Positive integer.
Number of time points.</p>
</td></tr>
<tr><td><code id="SimSSMLinGrowth_+3A_mu0">mu0</code></td>
<td>
<p>Numeric vector.
A vector of length two.
The first element is the mean of the intercept,
and the second element is the mean of the slope.</p>
</td></tr>
<tr><td><code id="SimSSMLinGrowth_+3A_sigma0_l">sigma0_l</code></td>
<td>
<p>Numeric matrix.
Cholesky factorization (<code>t(chol(sigma0))</code>)
of the covariance matrix
of the intercept and the slope.</p>
</td></tr>
<tr><td><code id="SimSSMLinGrowth_+3A_theta_l">theta_l</code></td>
<td>
<p>Numeric.
Square root of the common measurement error variance.</p>
</td></tr>
<tr><td><code id="SimSSMLinGrowth_+3A_type">type</code></td>
<td>
<p>Integer.
State space model type.
See Details for more information.</p>
</td></tr>
<tr><td><code id="SimSSMLinGrowth_+3A_x">x</code></td>
<td>
<p>List.
Each element of the list is a matrix of covariates
for each individual <code>i</code> in <code>n</code>.
The number of columns in each matrix
should be equal to <code>time</code>.</p>
</td></tr>
<tr><td><code id="SimSSMLinGrowth_+3A_gamma">gamma</code></td>
<td>
<p>Numeric matrix.
Matrix linking the covariates to the latent variables
at current time point
(<code class="reqn">\boldsymbol{\Gamma}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMLinGrowth_+3A_kappa">kappa</code></td>
<td>
<p>Numeric matrix.
Matrix linking the covariates to the observed variables
at current time point
(<code class="reqn">\boldsymbol{\kappa}</code>).</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>Type 0</h4>

<p>The measurement model is given by
</p>
<p style="text-align: center;"><code class="reqn">
    Y_{i, t}
    =
    \left(
    \begin{array}{cc}
      1 &amp; 0 \\
    \end{array}
    \right)
    \left(
    \begin{array}{c}
      \eta_{0_{i, t}} \\
      \eta_{1_{i, t}} \\
    \end{array}
    \right)
    +
    \boldsymbol{\varepsilon}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \boldsymbol{\varepsilon}_{i, t}
    \sim
    \mathcal{N}
    \left(
    0,
    \theta
    \right)
  </code>
</p>

<p>where <code class="reqn">Y_{i, t}</code>, <code class="reqn">\eta_{0_{i, t}}</code>,
<code class="reqn">\eta_{1_{i, t}}</code>,
and <code class="reqn">\boldsymbol{\varepsilon}_{i, t}</code>
are random variables and
<code class="reqn">\theta</code> is a model parameter.
<code class="reqn">Y_{i, t}</code> is the observed random variable
at time <code class="reqn">t</code> and individual <code class="reqn">i</code>,
<code class="reqn">\eta_{0_{i, t}}</code> (intercept)
and
<code class="reqn">\eta_{1_{i, t}}</code> (slope)
form a vector of latent random variables
at time <code class="reqn">t</code> and individual <code class="reqn">i</code>,
and <code class="reqn">\boldsymbol{\varepsilon}_{i, t}</code>
a vector of random measurement errors
at time <code class="reqn">t</code> and individual <code class="reqn">i</code>.
<code class="reqn">\theta</code> is the variance of
<code class="reqn">\boldsymbol{\varepsilon}</code>.
</p>
<p>The dynamic structure is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \left(
    \begin{array}{c}
    \eta_{0_{i, t}} \\
    \eta_{1_{i, t}} \\
    \end{array}
    \right)
    =
    \left(
    \begin{array}{cc}
      1 &amp; 1 \\
      0 &amp; 1 \\
    \end{array}
    \right)
    \left(
    \begin{array}{c}
    \eta_{0_{i, t - 1}} \\
    \eta_{1_{i, t - 1}} \\
    \end{array}
    \right) .
  </code>
</p>

<p>The mean vector and covariance matrix of the intercept and slope
are captured in the mean vector and covariance matrix
of the initial condition given by
</p>
<p style="text-align: center;"><code class="reqn">
    \boldsymbol{\mu}_{\boldsymbol{\eta} \mid 0}
    =
    \left(
    \begin{array}{c}
      \mu_{\eta_{0}} \\
      \mu_{\eta_{1}} \\
    \end{array}
    \right) \quad \mathrm{and,}
  </code>
</p>

<p style="text-align: center;"><code class="reqn">
    \boldsymbol{\Sigma}_{\boldsymbol{\eta} \mid 0}
    =
    \left(
    \begin{array}{cc}
      \sigma^{2}_{\eta_{0}} &amp;
      \sigma_{\eta_{0}, \eta_{1}} \\
      \sigma_{\eta_{1}, \eta_{0}} &amp;
      \sigma^{2}_{\eta_{1}} \\
    \end{array}
    \right) .
  </code>
</p>




<h4>Type 1</h4>

<p>The measurement model is given by
</p>
<p style="text-align: center;"><code class="reqn">
    Y_{i, t}
    =
    \left(
    \begin{array}{cc}
      1 &amp; 0 \\
    \end{array}
    \right)
    \left(
    \begin{array}{c}
      \eta_{0_{i, t}} \\
      \eta_{1_{i, t}} \\
    \end{array}
    \right)
    +
    \boldsymbol{\varepsilon}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \boldsymbol{\varepsilon}_{i, t}
    \sim
    \mathcal{N}
    \left(
    0,
    \theta
    \right) .
  </code>
</p>

<p>The dynamic structure is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \left(
    \begin{array}{c}
    \eta_{0_{i, t}} \\
    \eta_{1_{i, t}} \\
    \end{array}
    \right)
    =
    \left(
    \begin{array}{cc}
      1 &amp; 1 \\
      0 &amp; 1 \\
    \end{array}
    \right)
    \left(
    \begin{array}{c}
    \eta_{0_{i, t - 1}} \\
    \eta_{1_{i, t - 1}} \\
    \end{array}
    \right)
    +
    \boldsymbol{\Gamma}
    \mathbf{x}_{i, t}
  </code>
</p>

<p>where
<code class="reqn">\mathbf{x}_{i, t}</code> represents a vector of covariates
at time <code class="reqn">t</code> and individual <code class="reqn">i</code>,
and <code class="reqn">\boldsymbol{\Gamma}</code> the coefficient matrix
linking the covariates to the latent variables.
</p>



<h4>Type 2</h4>

<p>The measurement model is given by
</p>
<p style="text-align: center;"><code class="reqn">
    Y_{i, t}
    =
    \left(
    \begin{array}{cc}
      1 &amp; 0 \\
    \end{array}
    \right)
    \left(
    \begin{array}{c}
      \eta_{0_{i, t}} \\
      \eta_{1_{i, t}} \\
    \end{array}
    \right)
    +
    \boldsymbol{\kappa}
    \mathbf{x}_{i, t}
    +
    \boldsymbol{\varepsilon}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \boldsymbol{\varepsilon}_{i, t}
    \sim
    \mathcal{N}
    \left(
    0,
    \theta
    \right)
  </code>
</p>

<p>where
<code class="reqn">\boldsymbol{\kappa}</code> represents the coefficient matrix
linking the covariates to the observed variables.
</p>
<p>The dynamic structure is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \left(
    \begin{array}{c}
    \eta_{0_{i, t}} \\
    \eta_{1_{i, t}} \\
    \end{array}
    \right)
    =
    \left(
    \begin{array}{cc}
      1 &amp; 1 \\
      0 &amp; 1 \\
    \end{array}
    \right)
    \left(
    \begin{array}{c}
    \eta_{0_{i, t - 1}} \\
    \eta_{1_{i, t - 1}} \\
    \end{array}
    \right)
    +
    \boldsymbol{\Gamma}
    \mathbf{x}_{i, t} .
  </code>
</p>




<h3>Value</h3>

<p>Returns an object of class <code>simstatespace</code>
which is a list with the following elements:
</p>

<ul>
<li> <p><code>call</code>: Function call.
</p>
</li>
<li> <p><code>args</code>: Function arguments.
</p>
</li>
<li> <p><code>data</code>: Generated data which is a list of length <code>n</code>.
Each element of <code>data</code> is a list with the following elements:
</p>

<ul>
<li> <p><code>id</code>: A vector of ID numbers with length <code>l</code>,
where <code>l</code> is the value of the function argument <code>time</code>.
</p>
</li>
<li> <p><code>time</code>: A vector time points of length <code>l</code>.
</p>
</li>
<li> <p><code>y</code>: A <code>l</code> by <code>k</code> matrix of values for the manifest variables.
</p>
</li>
<li> <p><code>eta</code>: A <code>l</code> by <code>p</code> matrix of values for the latent variables.
</p>
</li>
<li> <p><code>x</code>: A <code>l</code> by <code>j</code> matrix of values for the covariates
(when covariates are included).
</p>
</li></ul>

</li>
<li> <p><code>fun</code>: Function used.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Ivan Jacob Agaloos Pesigan
</p>


<h3>References</h3>

<p>Chow, S.-M., Ho, M. R., Hamaker, E. L., &amp; Dolan, C. V. (2010).
Equivalence and differences between structural equation modeling
and state-space modeling techniques.
<em>Structural Equation Modeling: A Multidisciplinary Journal</em>,
17(2), 303–332.
<a href="https://doi.org/10.1080/10705511003661553">doi:10.1080/10705511003661553</a>
</p>


<h3>See Also</h3>

<p>Other Simulation of State Space Models Data Functions: 
<code><a href="#topic+LinSDE2SSM">LinSDE2SSM</a>()</code>,
<code><a href="#topic+SimSSMFixed">SimSSMFixed</a>()</code>,
<code><a href="#topic+SimSSMIVary">SimSSMIVary</a>()</code>,
<code><a href="#topic+SimSSMLinGrowthIVary">SimSSMLinGrowthIVary</a>()</code>,
<code><a href="#topic+SimSSMLinSDEFixed">SimSSMLinSDEFixed</a>()</code>,
<code><a href="#topic+SimSSMLinSDEIVary">SimSSMLinSDEIVary</a>()</code>,
<code><a href="#topic+SimSSMOUFixed">SimSSMOUFixed</a>()</code>,
<code><a href="#topic+SimSSMOUIVary">SimSSMOUIVary</a>()</code>,
<code><a href="#topic+SimSSMVARFixed">SimSSMVARFixed</a>()</code>,
<code><a href="#topic+SimSSMVARIVary">SimSSMVARIVary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># prepare parameters
set.seed(42)
## number of individuals
n &lt;- 5
## time points
time &lt;- 5
## dynamic structure
p &lt;- 2
mu0 &lt;- c(0.615, 1.006)
sigma0 &lt;- matrix(
  data = c(
    1.932,
    0.618,
    0.618,
    0.587
  ),
  nrow = p
)
sigma0_l &lt;- t(chol(sigma0))
## measurement model
k &lt;- 1
theta &lt;- 0.50
theta_l &lt;- sqrt(theta)
## covariates
j &lt;- 2
x &lt;- lapply(
  X = seq_len(n),
  FUN = function(i) {
    return(
      matrix(
        data = rnorm(n = j * time),
        nrow = j
      )
    )
  }
)
gamma &lt;- diag(x = 0.10, nrow = p, ncol = j)
kappa &lt;- diag(x = 0.10, nrow = k, ncol = j)

# Type 0
ssm &lt;- SimSSMLinGrowth(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  theta_l = theta_l,
  type = 0
)

plot(ssm)

# Type 1
ssm &lt;- SimSSMLinGrowth(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  theta_l = theta_l,
  type = 1,
  x = x,
  gamma = gamma
)

plot(ssm)

# Type 2
ssm &lt;- SimSSMLinGrowth(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  theta_l = theta_l,
  type = 2,
  x = x,
  gamma = gamma,
  kappa = kappa
)

plot(ssm)

</code></pre>

<hr>
<h2 id='SimSSMLinGrowthIVary'>Simulate Data from the
Linear Growth Curve Model
(Individual-Varying Parameters)</h2><span id='topic+SimSSMLinGrowthIVary'></span>

<h3>Description</h3>

<p>This function simulates data from the
linear growth curve model.
It assumes that the parameters can vary
across individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimSSMLinGrowthIVary(
  n,
  time,
  mu0,
  sigma0_l,
  theta_l,
  type = 0,
  x = NULL,
  gamma = NULL,
  kappa = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimSSMLinGrowthIVary_+3A_n">n</code></td>
<td>
<p>Positive integer.
Number of individuals.</p>
</td></tr>
<tr><td><code id="SimSSMLinGrowthIVary_+3A_time">time</code></td>
<td>
<p>Positive integer.
Number of time points.</p>
</td></tr>
<tr><td><code id="SimSSMLinGrowthIVary_+3A_mu0">mu0</code></td>
<td>
<p>A list of numeric vectors.
Each element of the list
is a vector of length two.
The first element is the mean of the intercept,
and the second element is the mean of the slope.</p>
</td></tr>
<tr><td><code id="SimSSMLinGrowthIVary_+3A_sigma0_l">sigma0_l</code></td>
<td>
<p>A list of numeric matrices.
Each element of the list is the
Cholesky factorization (<code>t(chol(sigma0))</code>)
of the covariance matrix
of the intercept and the slope.</p>
</td></tr>
<tr><td><code id="SimSSMLinGrowthIVary_+3A_theta_l">theta_l</code></td>
<td>
<p>A list numeric values.
Each element of the list
is the square root of the common measurement error variance.</p>
</td></tr>
<tr><td><code id="SimSSMLinGrowthIVary_+3A_type">type</code></td>
<td>
<p>Integer.
State space model type.
See Details in <code><a href="#topic+SimSSMLinGrowth">SimSSMLinGrowth()</a></code> for more information.</p>
</td></tr>
<tr><td><code id="SimSSMLinGrowthIVary_+3A_x">x</code></td>
<td>
<p>List.
Each element of the list is a matrix of covariates
for each individual <code>i</code> in <code>n</code>.
The number of columns in each matrix
should be equal to <code>time</code>.</p>
</td></tr>
<tr><td><code id="SimSSMLinGrowthIVary_+3A_gamma">gamma</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the matrix linking the covariates to the latent variables
at current time point
(<code class="reqn">\boldsymbol{\Gamma}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMLinGrowthIVary_+3A_kappa">kappa</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the matrix linking the covariates to the observed variables
at current time point
(<code class="reqn">\boldsymbol{\kappa}</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parameters can vary across individuals
by providing a list of parameter values.
If the length of any of the parameters
(<code>mu0</code>,
<code>sigma0</code>,
<code>mu</code>,
<code>theta_l</code>,
<code>gamma</code>, or
<code>kappa</code>)
is less the <code>n</code>,
the function will cycle through the available values.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>simstatespace</code>
which is a list with the following elements:
</p>

<ul>
<li> <p><code>call</code>: Function call.
</p>
</li>
<li> <p><code>args</code>: Function arguments.
</p>
</li>
<li> <p><code>data</code>: Generated data which is a list of length <code>n</code>.
Each element of <code>data</code> is a list with the following elements:
</p>

<ul>
<li> <p><code>id</code>: A vector of ID numbers with length <code>l</code>,
where <code>l</code> is the value of the function argument <code>time</code>.
</p>
</li>
<li> <p><code>time</code>: A vector time points of length <code>l</code>.
</p>
</li>
<li> <p><code>y</code>: A <code>l</code> by <code>k</code> matrix of values for the manifest variables.
</p>
</li>
<li> <p><code>eta</code>: A <code>l</code> by <code>p</code> matrix of values for the latent variables.
</p>
</li>
<li> <p><code>x</code>: A <code>l</code> by <code>j</code> matrix of values for the covariates
(when covariates are included).
</p>
</li></ul>

</li>
<li> <p><code>fun</code>: Function used.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Ivan Jacob Agaloos Pesigan
</p>


<h3>References</h3>

<p>Chow, S.-M., Ho, M. R., Hamaker, E. L., &amp; Dolan, C. V. (2010).
Equivalence and differences between structural equation modeling
and state-space modeling techniques.
<em>Structural Equation Modeling: A Multidisciplinary Journal</em>,
17(2), 303–332.
<a href="https://doi.org/10.1080/10705511003661553">doi:10.1080/10705511003661553</a>
</p>


<h3>See Also</h3>

<p>Other Simulation of State Space Models Data Functions: 
<code><a href="#topic+LinSDE2SSM">LinSDE2SSM</a>()</code>,
<code><a href="#topic+SimSSMFixed">SimSSMFixed</a>()</code>,
<code><a href="#topic+SimSSMIVary">SimSSMIVary</a>()</code>,
<code><a href="#topic+SimSSMLinGrowth">SimSSMLinGrowth</a>()</code>,
<code><a href="#topic+SimSSMLinSDEFixed">SimSSMLinSDEFixed</a>()</code>,
<code><a href="#topic+SimSSMLinSDEIVary">SimSSMLinSDEIVary</a>()</code>,
<code><a href="#topic+SimSSMOUFixed">SimSSMOUFixed</a>()</code>,
<code><a href="#topic+SimSSMOUIVary">SimSSMOUIVary</a>()</code>,
<code><a href="#topic+SimSSMVARFixed">SimSSMVARFixed</a>()</code>,
<code><a href="#topic+SimSSMVARIVary">SimSSMVARIVary</a>()</code>
</p>
<p>Other Simulation of State Space Models Data Functions: 
<code><a href="#topic+LinSDE2SSM">LinSDE2SSM</a>()</code>,
<code><a href="#topic+SimSSMFixed">SimSSMFixed</a>()</code>,
<code><a href="#topic+SimSSMIVary">SimSSMIVary</a>()</code>,
<code><a href="#topic+SimSSMLinGrowth">SimSSMLinGrowth</a>()</code>,
<code><a href="#topic+SimSSMLinSDEFixed">SimSSMLinSDEFixed</a>()</code>,
<code><a href="#topic+SimSSMLinSDEIVary">SimSSMLinSDEIVary</a>()</code>,
<code><a href="#topic+SimSSMOUFixed">SimSSMOUFixed</a>()</code>,
<code><a href="#topic+SimSSMOUIVary">SimSSMOUIVary</a>()</code>,
<code><a href="#topic+SimSSMVARFixed">SimSSMVARFixed</a>()</code>,
<code><a href="#topic+SimSSMVARIVary">SimSSMVARIVary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># prepare parameters
# In this example, the mean vector of the intercept and slope vary.
# Specifically,
# there are two sets of values representing two latent classes.
set.seed(42)
## number of individuals
n &lt;- 10
## time points
time &lt;- 5
## dynamic structure
p &lt;- 2
mu0_1 &lt;- c(0.615, 1.006) # lower starting point, higher growth
mu0_2 &lt;- c(1.000, 0.500) # higher starting point, lower growth
mu0 &lt;- list(mu0_1, mu0_2)
sigma0 &lt;- matrix(
  data = c(
    1.932,
    0.618,
    0.618,
    0.587
  ),
  nrow = p
)
sigma0_l &lt;- list(t(chol(sigma0)))
## measurement model
k &lt;- 1
theta &lt;- 0.50
theta_l &lt;- list(sqrt(theta))
## covariates
j &lt;- 2
x &lt;- lapply(
  X = seq_len(n),
  FUN = function(i) {
    matrix(
      data = stats::rnorm(n = time * j),
      nrow = j,
      ncol = time
    )
  }
)
gamma &lt;- list(
  diag(x = 0.10, nrow = p, ncol = j)
)
kappa &lt;- list(
  diag(x = 0.10, nrow = k, ncol = j)
)

# Type 0
ssm &lt;- SimSSMLinGrowthIVary(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  theta_l = theta_l,
  type = 0
)

plot(ssm)

# Type 1
ssm &lt;- SimSSMLinGrowthIVary(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  theta_l = theta_l,
  type = 1,
  x = x,
  gamma = gamma
)

plot(ssm)

# Type 2
ssm &lt;- SimSSMLinGrowthIVary(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  theta_l = theta_l,
  type = 2,
  x = x,
  gamma = gamma,
  kappa = kappa
)

plot(ssm)

</code></pre>

<hr>
<h2 id='SimSSMLinSDEFixed'>Simulate Data from the
Linear Stochastic Differential Equation Model
using a State Space Model Parameterization
(Fixed Parameters)</h2><span id='topic+SimSSMLinSDEFixed'></span>

<h3>Description</h3>

<p>This function simulates data from the
linear stochastic differential equation model
using a state space model parameterization.
It assumes that the parameters remain constant
across individuals and over time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimSSMLinSDEFixed(
  n,
  time,
  delta_t = 1,
  mu0,
  sigma0_l,
  iota,
  phi,
  sigma_l,
  nu,
  lambda,
  theta_l,
  type = 0,
  x = NULL,
  gamma = NULL,
  kappa = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimSSMLinSDEFixed_+3A_n">n</code></td>
<td>
<p>Positive integer.
Number of individuals.</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEFixed_+3A_time">time</code></td>
<td>
<p>Positive integer.
Number of time points.</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEFixed_+3A_delta_t">delta_t</code></td>
<td>
<p>Numeric.
Time interval
(<code class="reqn">\Delta_t</code>).</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEFixed_+3A_mu0">mu0</code></td>
<td>
<p>Numeric vector.
Mean of initial latent variable values
(<code class="reqn">\boldsymbol{\mu}_{\boldsymbol{\eta} \mid 0}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEFixed_+3A_sigma0_l">sigma0_l</code></td>
<td>
<p>Numeric matrix.
Cholesky factorization (<code>t(chol(sigma0))</code>)
of the covariance matrix
of initial latent variable values
(<code class="reqn">\boldsymbol{\Sigma}_{\boldsymbol{\eta} \mid 0}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEFixed_+3A_iota">iota</code></td>
<td>
<p>Numeric vector.
An unobserved term that is constant over time
(<code class="reqn">\boldsymbol{\iota}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEFixed_+3A_phi">phi</code></td>
<td>
<p>Numeric matrix.
The drift matrix
which represents the rate of change of the solution
in the absence of any random fluctuations
(<code class="reqn">\boldsymbol{\Phi}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEFixed_+3A_sigma_l">sigma_l</code></td>
<td>
<p>Numeric matrix.
Cholesky factorization (<code>t(chol(sigma))</code>)
of the covariance matrix of volatility
or randomness in the process
<code class="reqn">\boldsymbol{\Sigma}</code>.</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEFixed_+3A_nu">nu</code></td>
<td>
<p>Numeric vector.
Vector of intercept values for the measurement model
(<code class="reqn">\boldsymbol{\nu}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEFixed_+3A_lambda">lambda</code></td>
<td>
<p>Numeric matrix.
Factor loading matrix linking the latent variables
to the observed variables
(<code class="reqn">\boldsymbol{\Lambda}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEFixed_+3A_theta_l">theta_l</code></td>
<td>
<p>Numeric matrix.
Cholesky factorization (<code>t(chol(theta))</code>)
of the covariance matrix
of the measurement error
(<code class="reqn">\boldsymbol{\Theta}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEFixed_+3A_type">type</code></td>
<td>
<p>Integer.
State space model type.
See Details for more information.</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEFixed_+3A_x">x</code></td>
<td>
<p>List.
Each element of the list is a matrix of covariates
for each individual <code>i</code> in <code>n</code>.
The number of columns in each matrix
should be equal to <code>time</code>.</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEFixed_+3A_gamma">gamma</code></td>
<td>
<p>Numeric matrix.
Matrix linking the covariates to the latent variables
at current time point
(<code class="reqn">\boldsymbol{\Gamma}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEFixed_+3A_kappa">kappa</code></td>
<td>
<p>Numeric matrix.
Matrix linking the covariates to the observed variables
at current time point
(<code class="reqn">\boldsymbol{\kappa}</code>).</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>Type 0</h4>

<p>The measurement model is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathbf{y}_{i, t}
    =
    \boldsymbol{\nu}
    +
    \boldsymbol{\Lambda}
    \boldsymbol{\eta}_{i, t}
    +
    \boldsymbol{\varepsilon}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \boldsymbol{\varepsilon}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \boldsymbol{\Theta}
    \right)
  </code>
</p>

<p>where
<code class="reqn">\mathbf{y}_{i, t}</code>,
<code class="reqn">\boldsymbol{\eta}_{i, t}</code>,
and
<code class="reqn">\boldsymbol{\varepsilon}_{i, t}</code>
are random variables
and
<code class="reqn">\boldsymbol{\nu}</code>,
<code class="reqn">\boldsymbol{\Lambda}</code>,
and
<code class="reqn">\boldsymbol{\Theta}</code>
are model parameters.
<code class="reqn">\mathbf{y}_{i, t}</code>
represents a vector of observed random variables,
<code class="reqn">\boldsymbol{\eta}_{i, t}</code>
a vector of latent random variables,
and
<code class="reqn">\boldsymbol{\varepsilon}_{i, t}</code>
a vector of random measurement errors,
at time <code class="reqn">t</code> and individual <code class="reqn">i</code>.
<code class="reqn">\boldsymbol{\nu}</code>
denotes a vector of intercepts,
<code class="reqn">\boldsymbol{\Lambda}</code>
a matrix of factor loadings,
and
<code class="reqn">\boldsymbol{\Theta}</code>
the covariance matrix of
<code class="reqn">\boldsymbol{\varepsilon}</code>.
</p>
<p>An alternative representation of the measurement error
is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \boldsymbol{\varepsilon}_{i, t}
    =
    \boldsymbol{\Theta}^{\frac{1}{2}}
    \mathbf{z}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \mathbf{z}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \mathbf{I}
    \right)
  </code>
</p>

<p>where
<code class="reqn">\mathbf{z}_{i, t}</code> is a vector of
independent standard normal random variables and
<code class="reqn">
    \left( \boldsymbol{\Theta}^{\frac{1}{2}} \right)
    \left( \boldsymbol{\Theta}^{\frac{1}{2}} \right)^{\prime}
    =
    \boldsymbol{\Theta} .
  </code>
</p>
<p>The dynamic structure is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathrm{d} \boldsymbol{\eta}_{i, t}
    =
    \left(
    \boldsymbol{\iota}
    +
    \boldsymbol{\Phi}
    \boldsymbol{\eta}_{i, t}
    \right)
    \mathrm{d}t
    +
    \boldsymbol{\Sigma}^{\frac{1}{2}}
    \mathrm{d}
    \mathbf{W}_{i, t}
  </code>
</p>

<p>where
<code class="reqn">\boldsymbol{\iota}</code>
is a term which is unobserved and constant over time,
<code class="reqn">\boldsymbol{\Phi}</code>
is the drift matrix
which represents the rate of change of the solution
in the absence of any random fluctuations,
<code class="reqn">\boldsymbol{\Sigma}</code>
is the matrix of volatility
or randomness in the process, and
<code class="reqn">\mathrm{d}\boldsymbol{W}</code>
is a Wiener process or Brownian motion,
which represents random fluctuations.
</p>



<h4>Type 1</h4>

<p>The measurement model is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathbf{y}_{i, t}
    =
    \boldsymbol{\nu}
    +
    \boldsymbol{\Lambda}
    \boldsymbol{\eta}_{i, t}
    +
    \boldsymbol{\varepsilon}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \boldsymbol{\varepsilon}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \boldsymbol{\Theta}
    \right) .
  </code>
</p>

<p>The dynamic structure is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathrm{d} \boldsymbol{\eta}_{i, t}
    =
    \left(
    \boldsymbol{\iota}
    +
    \boldsymbol{\Phi}
    \boldsymbol{\eta}_{i, t}
    \right)
    \mathrm{d}t
    +
    \boldsymbol{\Gamma}
    \mathbf{x}_{i, t}
    +
    \boldsymbol{\Sigma}^{\frac{1}{2}}
    \mathrm{d}
    \mathbf{W}_{i, t}
  </code>
</p>

<p>where
<code class="reqn">\mathbf{x}_{i, t}</code> represents a vector of covariates
at time <code class="reqn">t</code> and individual <code class="reqn">i</code>,
and <code class="reqn">\boldsymbol{\Gamma}</code> the coefficient matrix
linking the covariates to the latent variables.
</p>



<h4>Type 2</h4>

<p>The measurement model is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathbf{y}_{i, t}
    =
    \boldsymbol{\nu}
    +
    \boldsymbol{\Lambda}
    \boldsymbol{\eta}_{i, t}
    +
    \boldsymbol{\kappa}
    \mathbf{x}_{i, t}
    +
    \boldsymbol{\varepsilon}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \boldsymbol{\varepsilon}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \boldsymbol{\Theta}
    \right)
  </code>
</p>

<p>where
<code class="reqn">\boldsymbol{\kappa}</code> represents the coefficient matrix
linking the covariates to the observed variables.
</p>
<p>The dynamic structure is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathrm{d} \boldsymbol{\eta}_{i, t}
    =
    \left(
    \boldsymbol{\iota}
    +
    \boldsymbol{\Phi}
    \boldsymbol{\eta}_{i, t}
    \right)
    \mathrm{d}t
    +
    \boldsymbol{\Gamma}
    \mathbf{x}_{i, t}
    +
    \boldsymbol{\Sigma}^{\frac{1}{2}}
    \mathrm{d}
    \mathbf{W}_{i, t} .
  </code>
</p>




<h4>State Space Parameterization</h4>

<p>The state space parameters
as a function of the linear stochastic differential equation model
parameters
are given by
</p>
<p style="text-align: center;"><code class="reqn">
      \boldsymbol{\beta}_{\Delta t_{{l_{i}}}}
      =
      \exp{
        \left(
          \Delta t
          \boldsymbol{\Phi}
        \right)
      }
  </code>
</p>

<p style="text-align: center;"><code class="reqn">
      \boldsymbol{\alpha}_{\Delta t_{{l_{i}}}}
      =
      \boldsymbol{\Phi}^{-1}
      \left(
        \boldsymbol{\beta} - \mathbf{I}_{p}
      \right)
      \boldsymbol{\iota}
  </code>
</p>

<p style="text-align: center;"><code class="reqn">
      \mathrm{vec}
      \left(
        \boldsymbol{\Psi}_{\Delta t_{{l_{i}}}}
      \right)
      =
      \left[
        \left(
          \boldsymbol{\Phi} \otimes \mathbf{I}_{p}
        \right)
        +
        \left(
          \mathbf{I}_{p} \otimes \boldsymbol{\Phi}
        \right)
      \right]
      \left[
        \exp
        \left(
          \left[
            \left(
              \boldsymbol{\Phi} \otimes \mathbf{I}_{p}
            \right)
            +
            \left(
              \mathbf{I}_{p} \otimes \boldsymbol{\Phi}
            \right)
          \right]
          \Delta t
        \right)
        -
        \mathbf{I}_{p \times p}
      \right]
      \mathrm{vec}
      \left(
        \boldsymbol{\Sigma}
      \right)
  </code>
</p>

<p>where <code class="reqn">p</code> is the number of latent variables and
<code class="reqn">\Delta t</code> is the time interval.
</p>



<h3>Value</h3>

<p>Returns an object of class <code>simstatespace</code>
which is a list with the following elements:
</p>

<ul>
<li> <p><code>call</code>: Function call.
</p>
</li>
<li> <p><code>args</code>: Function arguments.
</p>
</li>
<li> <p><code>data</code>: Generated data which is a list of length <code>n</code>.
Each element of <code>data</code> is a list with the following elements:
</p>

<ul>
<li> <p><code>id</code>: A vector of ID numbers with length <code>l</code>,
where <code>l</code> is the value of the function argument <code>time</code>.
</p>
</li>
<li> <p><code>time</code>: A vector time points of length <code>l</code>.
</p>
</li>
<li> <p><code>y</code>: A <code>l</code> by <code>k</code> matrix of values for the manifest variables.
</p>
</li>
<li> <p><code>eta</code>: A <code>l</code> by <code>p</code> matrix of values for the latent variables.
</p>
</li>
<li> <p><code>x</code>: A <code>l</code> by <code>j</code> matrix of values for the covariates
(when covariates are included).
</p>
</li></ul>

</li>
<li> <p><code>fun</code>: Function used.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Ivan Jacob Agaloos Pesigan
</p>


<h3>References</h3>

<p>Chow, S.-M., Ho, M. R., Hamaker, E. L., &amp; Dolan, C. V. (2010).
Equivalence and differences between structural equation modeling
and state-space modeling techniques.
<em>Structural Equation Modeling: A Multidisciplinary Journal</em>,
17(2), 303–332.
<a href="https://doi.org/10.1080/10705511003661553">doi:10.1080/10705511003661553</a>
</p>
<p>Chow, S.-M., Losardo, D., Park, J., &amp; Molenaar, P. C. M. (2023).
Continuous-time dynamic models:
Connections to structural equation models and other discrete-time models.
In R. H. Hoyle (Ed.),
Handbook of structural equation modeling (2nd ed.).
The Guilford Press.
</p>
<p>Harvey, A. C. (1990).
Forecasting, structural time series models and the Kalman filter.
Cambridge University Press.
<a href="https://doi.org/10.1017/cbo9781107049994">doi:10.1017/cbo9781107049994</a>
</p>


<h3>See Also</h3>

<p>Other Simulation of State Space Models Data Functions: 
<code><a href="#topic+LinSDE2SSM">LinSDE2SSM</a>()</code>,
<code><a href="#topic+SimSSMFixed">SimSSMFixed</a>()</code>,
<code><a href="#topic+SimSSMIVary">SimSSMIVary</a>()</code>,
<code><a href="#topic+SimSSMLinGrowth">SimSSMLinGrowth</a>()</code>,
<code><a href="#topic+SimSSMLinGrowthIVary">SimSSMLinGrowthIVary</a>()</code>,
<code><a href="#topic+SimSSMLinSDEIVary">SimSSMLinSDEIVary</a>()</code>,
<code><a href="#topic+SimSSMOUFixed">SimSSMOUFixed</a>()</code>,
<code><a href="#topic+SimSSMOUIVary">SimSSMOUIVary</a>()</code>,
<code><a href="#topic+SimSSMVARFixed">SimSSMVARFixed</a>()</code>,
<code><a href="#topic+SimSSMVARIVary">SimSSMVARIVary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># prepare parameters
set.seed(42)
## number of individuals
n &lt;- 5
## time points
time &lt;- 50
delta_t &lt;- 0.10
## dynamic structure
p &lt;- 2
mu0 &lt;- c(-3.0, 1.5)
sigma0 &lt;- 0.001 * diag(p)
sigma0_l &lt;- t(chol(sigma0))
iota &lt;- c(0.317, 0.230)
phi &lt;- matrix(
  data = c(
    -0.10,
    0.05,
    0.05,
    -0.10
  ),
  nrow = p
)
sigma &lt;- matrix(
  data = c(
    2.79,
    0.06,
    0.06,
    3.27
  ),
  nrow = p
)
sigma_l &lt;- t(chol(sigma))
## measurement model
k &lt;- 2
nu &lt;- rep(x = 0, times = k)
lambda &lt;- diag(k)
theta &lt;- 0.001 * diag(k)
theta_l &lt;- t(chol(theta))
## covariates
j &lt;- 2
x &lt;- lapply(
  X = seq_len(n),
  FUN = function(i) {
    matrix(
      data = stats::rnorm(n = time * j),
      nrow = j,
      ncol = time
    )
  }
)
gamma &lt;- diag(x = 0.10, nrow = p, ncol = j)
kappa &lt;- diag(x = 0.10, nrow = k, ncol = j)

# Type 0
ssm &lt;- SimSSMLinSDEFixed(
  n = n,
  time = time,
  delta_t = delta_t,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  iota = iota,
  phi = phi,
  sigma_l = sigma_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 0
)

plot(ssm)

# Type 1
ssm &lt;- SimSSMLinSDEFixed(
  n = n,
  time = time,
  delta_t = delta_t,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  iota = iota,
  phi = phi,
  sigma_l = sigma_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 1,
  x = x,
  gamma = gamma
)

plot(ssm)

# Type 2
ssm &lt;- SimSSMLinSDEFixed(
  n = n,
  time = time,
  delta_t = delta_t,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  iota = iota,
  phi = phi,
  sigma_l = sigma_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 2,
  x = x,
  gamma = gamma,
  kappa = kappa
)

plot(ssm)

</code></pre>

<hr>
<h2 id='SimSSMLinSDEIVary'>Simulate Data from the
Linear Stochastic Differential Equation Model
using a State Space Model Parameterization
(Individual-Varying Parameters)</h2><span id='topic+SimSSMLinSDEIVary'></span>

<h3>Description</h3>

<p>This function simulates data from the
linear stochastic differential equation model
using a state space model parameterization.
It assumes that the parameters can vary
across individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimSSMLinSDEIVary(
  n,
  time,
  delta_t = 1,
  mu0,
  sigma0_l,
  iota,
  phi,
  sigma_l,
  nu,
  lambda,
  theta_l,
  type = 0,
  x = NULL,
  gamma = NULL,
  kappa = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimSSMLinSDEIVary_+3A_n">n</code></td>
<td>
<p>Positive integer.
Number of individuals.</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEIVary_+3A_time">time</code></td>
<td>
<p>Positive integer.
Number of time points.</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEIVary_+3A_delta_t">delta_t</code></td>
<td>
<p>Numeric.
Time interval.
The default value is <code>1.0</code>
with an option to use a numeric value
for the discretized state space model
parameterization of the
linear stochastic differential equation model.</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEIVary_+3A_mu0">mu0</code></td>
<td>
<p>List of numeric vectors.
Each element of the list
is the mean of initial latent variable values
(<code class="reqn">\boldsymbol{\mu}_{\boldsymbol{\eta} \mid 0}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEIVary_+3A_sigma0_l">sigma0_l</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the Cholesky factorization (<code>t(chol(sigma0))</code>)
of the covariance matrix
of initial latent variable values
(<code class="reqn">\boldsymbol{\Sigma}_{\boldsymbol{\eta} \mid 0}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEIVary_+3A_iota">iota</code></td>
<td>
<p>List of numeric vectors.
Each element of the list
is an unobserved term that is constant over time
(<code class="reqn">\boldsymbol{\iota}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEIVary_+3A_phi">phi</code></td>
<td>
<p>List of numeric matrix.
Each element of the list
is the drift matrix
which represents the rate of change of the solution
in the absence of any random fluctuations
(<code class="reqn">\boldsymbol{\Phi}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEIVary_+3A_sigma_l">sigma_l</code></td>
<td>
<p>List of numeric matrix.
Each element of the list
is the Cholesky factorization (<code>t(chol(sigma))</code>)
of the covariance matrix of volatility
or randomness in the process
<code class="reqn">\boldsymbol{\Sigma}</code>.</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEIVary_+3A_nu">nu</code></td>
<td>
<p>List of numeric vectors.
Each element of the list
is the vector of intercept values for the measurement model
(<code class="reqn">\boldsymbol{\nu}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEIVary_+3A_lambda">lambda</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the factor loading matrix linking the latent variables
to the observed variables
(<code class="reqn">\boldsymbol{\Lambda}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEIVary_+3A_theta_l">theta_l</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the Cholesky factorization (<code>t(chol(theta))</code>)
of the covariance matrix
of the measurement error
(<code class="reqn">\boldsymbol{\Theta}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEIVary_+3A_type">type</code></td>
<td>
<p>Integer.
State space model type.
See Details in <code><a href="#topic+SimSSMLinSDEFixed">SimSSMLinSDEFixed()</a></code> for more information.</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEIVary_+3A_x">x</code></td>
<td>
<p>List.
Each element of the list is a matrix of covariates
for each individual <code>i</code> in <code>n</code>.
The number of columns in each matrix
should be equal to <code>time</code>.</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEIVary_+3A_gamma">gamma</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the matrix linking the covariates to the latent variables
at current time point
(<code class="reqn">\boldsymbol{\Gamma}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMLinSDEIVary_+3A_kappa">kappa</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the matrix linking the covariates to the observed variables
at current time point
(<code class="reqn">\boldsymbol{\kappa}</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parameters can vary across individuals
by providing a list of parameter values.
If the length of any of the parameters
(<code>mu0</code>,
<code>sigma0_l</code>,
<code>iota</code>,
<code>phi</code>,
<code>sigma_l</code>,
<code>nu</code>,
<code>lambda</code>,
<code>theta_l</code>,
<code>gamma</code>, or
<code>kappa</code>)
is less the <code>n</code>,
the function will cycle through the available values.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>simstatespace</code>
which is a list with the following elements:
</p>

<ul>
<li> <p><code>call</code>: Function call.
</p>
</li>
<li> <p><code>args</code>: Function arguments.
</p>
</li>
<li> <p><code>data</code>: Generated data which is a list of length <code>n</code>.
Each element of <code>data</code> is a list with the following elements:
</p>

<ul>
<li> <p><code>id</code>: A vector of ID numbers with length <code>l</code>,
where <code>l</code> is the value of the function argument <code>time</code>.
</p>
</li>
<li> <p><code>time</code>: A vector time points of length <code>l</code>.
</p>
</li>
<li> <p><code>y</code>: A <code>l</code> by <code>k</code> matrix of values for the manifest variables.
</p>
</li>
<li> <p><code>eta</code>: A <code>l</code> by <code>p</code> matrix of values for the latent variables.
</p>
</li>
<li> <p><code>x</code>: A <code>l</code> by <code>j</code> matrix of values for the covariates
(when covariates are included).
</p>
</li></ul>

</li>
<li> <p><code>fun</code>: Function used.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Ivan Jacob Agaloos Pesigan
</p>


<h3>References</h3>

<p>Chow, S.-M., Ho, M. R., Hamaker, E. L., &amp; Dolan, C. V. (2010).
Equivalence and differences between structural equation modeling
and state-space modeling techniques.
<em>Structural Equation Modeling: A Multidisciplinary Journal</em>,
17(2), 303–332.
<a href="https://doi.org/10.1080/10705511003661553">doi:10.1080/10705511003661553</a>
</p>
<p>Chow, S.-M., Losardo, D., Park, J., &amp; Molenaar, P. C. M. (2023).
Continuous-time dynamic models:
Connections to structural equation models and other discrete-time models.
In R. H. Hoyle (Ed.),
Handbook of structural equation modeling (2nd ed.).
The Guilford Press.
</p>
<p>Harvey, A. C. (1990).
Forecasting, structural time series models and the Kalman filter.
Cambridge University Press.
<a href="https://doi.org/10.1017/cbo9781107049994">doi:10.1017/cbo9781107049994</a>
</p>


<h3>See Also</h3>

<p>Other Simulation of State Space Models Data Functions: 
<code><a href="#topic+LinSDE2SSM">LinSDE2SSM</a>()</code>,
<code><a href="#topic+SimSSMFixed">SimSSMFixed</a>()</code>,
<code><a href="#topic+SimSSMIVary">SimSSMIVary</a>()</code>,
<code><a href="#topic+SimSSMLinGrowth">SimSSMLinGrowth</a>()</code>,
<code><a href="#topic+SimSSMLinGrowthIVary">SimSSMLinGrowthIVary</a>()</code>,
<code><a href="#topic+SimSSMLinSDEFixed">SimSSMLinSDEFixed</a>()</code>,
<code><a href="#topic+SimSSMOUFixed">SimSSMOUFixed</a>()</code>,
<code><a href="#topic+SimSSMOUIVary">SimSSMOUIVary</a>()</code>,
<code><a href="#topic+SimSSMVARFixed">SimSSMVARFixed</a>()</code>,
<code><a href="#topic+SimSSMVARIVary">SimSSMVARIVary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># prepare parameters
# In this example, phi varies across individuals.
set.seed(42)
## number of individuals
n &lt;- 5
## time points
time &lt;- 50
delta_t &lt;- 0.10
## dynamic structure
p &lt;- 2
mu0 &lt;- list(
  c(-3.0, 1.5)
)
sigma0 &lt;- 0.001 * diag(p)
sigma0_l &lt;- list(
  t(chol(sigma0))
)
iota &lt;- list(
  c(0.317, 0.230)
)
phi &lt;- list(
  -0.1 * diag(p),
  -0.2 * diag(p),
  -0.3 * diag(p),
  -0.4 * diag(p),
  -0.5 * diag(p)
)
sigma &lt;- matrix(
  data = c(
    2.79,
    0.06,
    0.06,
    3.27
  ),
  nrow = p
)
sigma_l &lt;- list(
  t(chol(sigma))
)
## measurement model
k &lt;- 2
nu &lt;- list(
  rep(x = 0, times = k)
)
lambda &lt;- list(
  diag(k)
)
theta &lt;- 0.001 * diag(k)
theta_l &lt;- list(
  t(chol(theta))
)
## covariates
j &lt;- 2
x &lt;- lapply(
  X = seq_len(n),
  FUN = function(i) {
    matrix(
      data = stats::rnorm(n = time * j),
      nrow = j,
      ncol = time
    )
  }
)
gamma &lt;- list(
  diag(x = 0.10, nrow = p, ncol = j)
)
kappa &lt;- list(
  diag(x = 0.10, nrow = k, ncol = j)
)

# Type 0
ssm &lt;- SimSSMLinSDEIVary(
  n = n,
  time = time,
  delta_t = delta_t,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  iota = iota,
  phi = phi,
  sigma_l = sigma_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 0
)

plot(ssm)

# Type 1
ssm &lt;- SimSSMLinSDEIVary(
  n = n,
  time = time,
  delta_t = delta_t,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  iota = iota,
  phi = phi,
  sigma_l = sigma_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 1,
  x = x,
  gamma = gamma
)

plot(ssm)

# Type 2
ssm &lt;- SimSSMLinSDEIVary(
  n = n,
  time = time,
  delta_t = delta_t,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  iota = iota,
  phi = phi,
  sigma_l = sigma_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 2,
  x = x,
  gamma = gamma,
  kappa = kappa
)

plot(ssm)

</code></pre>

<hr>
<h2 id='SimSSMOUFixed'>Simulate Data from the
Ornstein–Uhlenbeck Model
using a State Space Model Parameterization
(Fixed Parameters)</h2><span id='topic+SimSSMOUFixed'></span>

<h3>Description</h3>

<p>This function simulates data from the
Ornstein–Uhlenbeck (OU) model
using a state space model parameterization.
It assumes that the parameters remain constant
across individuals and over time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimSSMOUFixed(
  n,
  time,
  delta_t = 1,
  mu0,
  sigma0_l,
  mu,
  phi,
  sigma_l,
  nu,
  lambda,
  theta_l,
  type = 0,
  x = NULL,
  gamma = NULL,
  kappa = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimSSMOUFixed_+3A_n">n</code></td>
<td>
<p>Positive integer.
Number of individuals.</p>
</td></tr>
<tr><td><code id="SimSSMOUFixed_+3A_time">time</code></td>
<td>
<p>Positive integer.
Number of time points.</p>
</td></tr>
<tr><td><code id="SimSSMOUFixed_+3A_delta_t">delta_t</code></td>
<td>
<p>Numeric.
Time interval
(<code class="reqn">\Delta_t</code>).</p>
</td></tr>
<tr><td><code id="SimSSMOUFixed_+3A_mu0">mu0</code></td>
<td>
<p>Numeric vector.
Mean of initial latent variable values
(<code class="reqn">\boldsymbol{\mu}_{\boldsymbol{\eta} \mid 0}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMOUFixed_+3A_sigma0_l">sigma0_l</code></td>
<td>
<p>Numeric matrix.
Cholesky factorization (<code>t(chol(sigma0))</code>)
of the covariance matrix
of initial latent variable values
(<code class="reqn">\boldsymbol{\Sigma}_{\boldsymbol{\eta} \mid 0}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMOUFixed_+3A_mu">mu</code></td>
<td>
<p>Numeric vector.
The long-term mean or equilibrium level
(<code class="reqn">\boldsymbol{\mu}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMOUFixed_+3A_phi">phi</code></td>
<td>
<p>Numeric matrix.
The drift matrix
which represents the rate of change of the solution
in the absence of any random fluctuations
(<code class="reqn">\boldsymbol{\Phi}</code>).
The negative value of <code>phi</code> is the rate of mean reversion,
determining how quickly the variable returns to its mean
(<code class="reqn">- \boldsymbol{\Phi}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMOUFixed_+3A_sigma_l">sigma_l</code></td>
<td>
<p>Numeric matrix.
Cholesky factorization (<code>t(chol(sigma))</code>)
of the covariance matrix of volatility
or randomness in the process
<code class="reqn">\boldsymbol{\Sigma}</code>.</p>
</td></tr>
<tr><td><code id="SimSSMOUFixed_+3A_nu">nu</code></td>
<td>
<p>Numeric vector.
Vector of intercept values for the measurement model
(<code class="reqn">\boldsymbol{\nu}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMOUFixed_+3A_lambda">lambda</code></td>
<td>
<p>Numeric matrix.
Factor loading matrix linking the latent variables
to the observed variables
(<code class="reqn">\boldsymbol{\Lambda}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMOUFixed_+3A_theta_l">theta_l</code></td>
<td>
<p>Numeric matrix.
Cholesky factorization (<code>t(chol(theta))</code>)
of the covariance matrix
of the measurement error
(<code class="reqn">\boldsymbol{\Theta}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMOUFixed_+3A_type">type</code></td>
<td>
<p>Integer.
State space model type.
See Details for more information.</p>
</td></tr>
<tr><td><code id="SimSSMOUFixed_+3A_x">x</code></td>
<td>
<p>List.
Each element of the list is a matrix of covariates
for each individual <code>i</code> in <code>n</code>.
The number of columns in each matrix
should be equal to <code>time</code>.</p>
</td></tr>
<tr><td><code id="SimSSMOUFixed_+3A_gamma">gamma</code></td>
<td>
<p>Numeric matrix.
Matrix linking the covariates to the latent variables
at current time point
(<code class="reqn">\boldsymbol{\Gamma}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMOUFixed_+3A_kappa">kappa</code></td>
<td>
<p>Numeric matrix.
Matrix linking the covariates to the observed variables
at current time point
(<code class="reqn">\boldsymbol{\kappa}</code>).</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>Type 0</h4>

<p>The measurement model is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathbf{y}_{i, t}
    =
    \boldsymbol{\nu}
    +
    \boldsymbol{\Lambda}
    \boldsymbol{\eta}_{i, t}
    +
    \boldsymbol{\varepsilon}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \boldsymbol{\varepsilon}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \boldsymbol{\Theta}
    \right)
  </code>
</p>

<p>where
<code class="reqn">\mathbf{y}_{i, t}</code>,
<code class="reqn">\boldsymbol{\eta}_{i, t}</code>,
and
<code class="reqn">\boldsymbol{\varepsilon}_{i, t}</code>
are random variables
and
<code class="reqn">\boldsymbol{\nu}</code>,
<code class="reqn">\boldsymbol{\Lambda}</code>,
and
<code class="reqn">\boldsymbol{\Theta}</code>
are model parameters.
<code class="reqn">\mathbf{y}_{i, t}</code>
represents a vector of observed random variables,
<code class="reqn">\boldsymbol{\eta}_{i, t}</code>
a vector of latent random variables,
and
<code class="reqn">\boldsymbol{\varepsilon}_{i, t}</code>
a vector of random measurement errors,
at time <code class="reqn">t</code> and individual <code class="reqn">i</code>.
<code class="reqn">\boldsymbol{\nu}</code>
denotes a vector of intercepts,
<code class="reqn">\boldsymbol{\Lambda}</code>
a matrix of factor loadings,
and
<code class="reqn">\boldsymbol{\Theta}</code>
the covariance matrix of
<code class="reqn">\boldsymbol{\varepsilon}</code>.
</p>
<p>An alternative representation of the measurement error
is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \boldsymbol{\varepsilon}_{i, t}
    =
    \boldsymbol{\Theta}^{\frac{1}{2}}
    \mathbf{z}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \mathbf{z}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \mathbf{I}
    \right)
  </code>
</p>

<p>where
<code class="reqn">\mathbf{z}_{i, t}</code> is a vector of
independent standard normal random variables and
<code class="reqn">
    \left( \boldsymbol{\Theta}^{\frac{1}{2}} \right)
    \left( \boldsymbol{\Theta}^{\frac{1}{2}} \right)^{\prime}
    =
    \boldsymbol{\Theta} .
  </code>
</p>
<p>The dynamic structure is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathrm{d} \boldsymbol{\eta}_{i, t}
    =
    - \boldsymbol{\Phi}
    \left(
    \boldsymbol{\mu}
    -
    \boldsymbol{\eta}_{i, t}
    \right)
    \mathrm{d}t
    +
    \boldsymbol{\Sigma}^{\frac{1}{2}}
    \mathrm{d}
    \mathbf{W}_{i, t}
  </code>
</p>

<p>where
<code class="reqn">\boldsymbol{\mu}</code>
is the long-term mean or equilibrium level,
<code class="reqn">- \boldsymbol{\Phi}</code>
is the rate of mean reversion,
determining how quickly the variable returns to its mean,
<code class="reqn">\boldsymbol{\Sigma}</code>
is the matrix of volatility
or randomness in the process, and
<code class="reqn">\mathrm{d}\boldsymbol{W}</code>
is a Wiener process or Brownian motion,
which represents random fluctuations.
</p>



<h4>Type 1</h4>

<p>The measurement model is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathbf{y}_{i, t}
    =
    \boldsymbol{\nu}
    +
    \boldsymbol{\Lambda}
    \boldsymbol{\eta}_{i, t}
    +
    \boldsymbol{\varepsilon}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \boldsymbol{\varepsilon}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \boldsymbol{\Theta}
    \right) .
  </code>
</p>

<p>The dynamic structure is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathrm{d} \boldsymbol{\eta}_{i, t}
    =
    - \boldsymbol{\Phi}
    \left(
    \boldsymbol{\mu}
    -
    \boldsymbol{\eta}_{i, t}
    \right)
    \mathrm{d}t
    +
    \boldsymbol{\Gamma}
    \mathbf{x}_{i, t}
    +
    \boldsymbol{\Sigma}^{\frac{1}{2}}
    \mathrm{d}
    \mathbf{W}_{i, t}
  </code>
</p>

<p>where
<code class="reqn">\mathbf{x}_{i, t}</code> represents a vector of covariates
at time <code class="reqn">t</code> and individual <code class="reqn">i</code>,
and <code class="reqn">\boldsymbol{\Gamma}</code> the coefficient matrix
linking the covariates to the latent variables.
</p>



<h4>Type 2</h4>

<p>The measurement model is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathbf{y}_{i, t}
    =
    \boldsymbol{\nu}
    +
    \boldsymbol{\Lambda}
    \boldsymbol{\eta}_{i, t}
    +
    \boldsymbol{\kappa}
    \mathbf{x}_{i, t}
    +
    \boldsymbol{\varepsilon}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \boldsymbol{\varepsilon}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \boldsymbol{\Theta}
    \right)
  </code>
</p>

<p>where
<code class="reqn">\boldsymbol{\kappa}</code> represents the coefficient matrix
linking the covariates to the observed variables.
</p>
<p>The dynamic structure is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathrm{d} \boldsymbol{\eta}_{i, t}
    =
    - \boldsymbol{\Phi}
    \left(
    \boldsymbol{\mu}
    -
    \boldsymbol{\eta}_{i, t}
    \right)
    \mathrm{d}t
    +
    \boldsymbol{\Gamma}
    \mathbf{x}_{i, t}
    +
    \boldsymbol{\Sigma}^{\frac{1}{2}}
    \mathrm{d}
    \mathbf{W}_{i, t} .
  </code>
</p>




<h4>The OU model as a linear stochastic differential equation model</h4>

<p>The OU model is a first-order
linear stochastic differential equation model
in the form of
</p>
<p style="text-align: center;"><code class="reqn">
    \mathrm{d} \boldsymbol{\eta}_{i, t}
    =
    \left(
    \boldsymbol{\iota}
    +
    \boldsymbol{\Phi}
    \boldsymbol{\eta}_{i, t}
    \right)
    \mathrm{d}t
    +
    \boldsymbol{\Sigma}^{\frac{1}{2}}
    \mathrm{d}
    \mathbf{W}_{i, t}
  </code>
</p>

<p>where
<code class="reqn">\boldsymbol{\mu} = - \boldsymbol{\Phi}^{-1} \boldsymbol{\iota}</code>
and, equivalently
<code class="reqn">\boldsymbol{\iota} = - \boldsymbol{\Phi} \boldsymbol{\mu}</code>.
</p>



<h3>Value</h3>

<p>Returns an object of class <code>simstatespace</code>
which is a list with the following elements:
</p>

<ul>
<li> <p><code>call</code>: Function call.
</p>
</li>
<li> <p><code>args</code>: Function arguments.
</p>
</li>
<li> <p><code>data</code>: Generated data which is a list of length <code>n</code>.
Each element of <code>data</code> is a list with the following elements:
</p>

<ul>
<li> <p><code>id</code>: A vector of ID numbers with length <code>l</code>,
where <code>l</code> is the value of the function argument <code>time</code>.
</p>
</li>
<li> <p><code>time</code>: A vector time points of length <code>l</code>.
</p>
</li>
<li> <p><code>y</code>: A <code>l</code> by <code>k</code> matrix of values for the manifest variables.
</p>
</li>
<li> <p><code>eta</code>: A <code>l</code> by <code>p</code> matrix of values for the latent variables.
</p>
</li>
<li> <p><code>x</code>: A <code>l</code> by <code>j</code> matrix of values for the covariates
(when covariates are included).
</p>
</li></ul>

</li>
<li> <p><code>fun</code>: Function used.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Ivan Jacob Agaloos Pesigan
</p>


<h3>References</h3>

<p>Chow, S.-M., Ho, M. R., Hamaker, E. L., &amp; Dolan, C. V. (2010).
Equivalence and differences between structural equation modeling
and state-space modeling techniques.
<em>Structural Equation Modeling: A Multidisciplinary Journal</em>,
17(2), 303–332.
<a href="https://doi.org/10.1080/10705511003661553">doi:10.1080/10705511003661553</a>
</p>
<p>Chow, S.-M., Losardo, D., Park, J., &amp; Molenaar, P. C. M. (2023).
Continuous-time dynamic models:
Connections to structural equation models and other discrete-time models.
In R. H. Hoyle (Ed.),
Handbook of structural equation modeling (2nd ed.).
The Guilford Press.
</p>
<p>Harvey, A. C. (1990).
Forecasting, structural time series models and the Kalman filter.
Cambridge University Press.
<a href="https://doi.org/10.1017/cbo9781107049994">doi:10.1017/cbo9781107049994</a>
</p>
<p>Oravecz, Z., Tuerlinckx, F., &amp; Vandekerckhove, J. (2011).
A hierarchical latent stochastic differential equation model
for affective dynamics.
Psychological Methods,
16 (4), 468–490.
<a href="https://doi.org/10.1037/a0024375">doi:10.1037/a0024375</a>
</p>
<p>Uhlenbeck, G. E., &amp; Ornstein, L. S. (1930).
On the theory of the brownian motion.
Physical Review,
36 (5), 823–841.
<a href="https://doi.org/10.1103/physrev.36.823">doi:10.1103/physrev.36.823</a>
</p>


<h3>See Also</h3>

<p>Other Simulation of State Space Models Data Functions: 
<code><a href="#topic+LinSDE2SSM">LinSDE2SSM</a>()</code>,
<code><a href="#topic+SimSSMFixed">SimSSMFixed</a>()</code>,
<code><a href="#topic+SimSSMIVary">SimSSMIVary</a>()</code>,
<code><a href="#topic+SimSSMLinGrowth">SimSSMLinGrowth</a>()</code>,
<code><a href="#topic+SimSSMLinGrowthIVary">SimSSMLinGrowthIVary</a>()</code>,
<code><a href="#topic+SimSSMLinSDEFixed">SimSSMLinSDEFixed</a>()</code>,
<code><a href="#topic+SimSSMLinSDEIVary">SimSSMLinSDEIVary</a>()</code>,
<code><a href="#topic+SimSSMOUIVary">SimSSMOUIVary</a>()</code>,
<code><a href="#topic+SimSSMVARFixed">SimSSMVARFixed</a>()</code>,
<code><a href="#topic+SimSSMVARIVary">SimSSMVARIVary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># prepare parameters
set.seed(42)
## number of individuals
n &lt;- 5
## time points
time &lt;- 50
delta_t &lt;- 0.10
## dynamic structure
p &lt;- 2
mu0 &lt;- c(-3.0, 1.5)
sigma0 &lt;- 0.001 * diag(p)
sigma0_l &lt;- t(chol(sigma0))
mu &lt;- c(5.76, 5.18)
phi &lt;- matrix(
  data = c(
    -0.10,
    0.05,
    0.05,
    -0.10
  ),
  nrow = p
)
sigma &lt;- matrix(
  data = c(
    2.79,
    0.06,
    0.06,
    3.27
  ),
  nrow = p
)
sigma_l &lt;- t(chol(sigma))
## measurement model
k &lt;- 2
nu &lt;- rep(x = 0, times = k)
lambda &lt;- diag(k)
theta &lt;- 0.001 * diag(k)
theta_l &lt;- t(chol(theta))
## covariates
j &lt;- 2
x &lt;- lapply(
  X = seq_len(n),
  FUN = function(i) {
    matrix(
      data = stats::rnorm(n = time * j),
      nrow = j,
      ncol = time
    )
  }
)
gamma &lt;- diag(x = 0.10, nrow = p, ncol = j)
kappa &lt;- diag(x = 0.10, nrow = k, ncol = j)

# Type 0
ssm &lt;- SimSSMOUFixed(
  n = n,
  time = time,
  delta_t = delta_t,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  mu = mu,
  phi = phi,
  sigma_l = sigma_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 0
)

plot(ssm)

# Type 1
ssm &lt;- SimSSMOUFixed(
  n = n,
  time = time,
  delta_t = delta_t,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  mu = mu,
  phi = phi,
  sigma_l = sigma_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 1,
  x = x,
  gamma = gamma
)

plot(ssm)

# Type 2
ssm &lt;- SimSSMOUFixed(
  n = n,
  time = time,
  delta_t = delta_t,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  mu = mu,
  phi = phi,
  sigma_l = sigma_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 2,
  x = x,
  gamma = gamma,
  kappa = kappa
)

plot(ssm)

</code></pre>

<hr>
<h2 id='SimSSMOUIVary'>Simulate Data from the
Ornstein–Uhlenbeck Model
using a State Space Model Parameterization
(Individual-Varying Parameters)</h2><span id='topic+SimSSMOUIVary'></span>

<h3>Description</h3>

<p>This function simulates data from the
Ornstein–Uhlenbeck model
using a state space model parameterization.
It assumes that the parameters can vary
across individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimSSMOUIVary(
  n,
  time,
  delta_t = 1,
  mu0,
  sigma0_l,
  mu,
  phi,
  sigma_l,
  nu,
  lambda,
  theta_l,
  type = 0,
  x = NULL,
  gamma = NULL,
  kappa = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimSSMOUIVary_+3A_n">n</code></td>
<td>
<p>Positive integer.
Number of individuals.</p>
</td></tr>
<tr><td><code id="SimSSMOUIVary_+3A_time">time</code></td>
<td>
<p>Positive integer.
Number of time points.</p>
</td></tr>
<tr><td><code id="SimSSMOUIVary_+3A_delta_t">delta_t</code></td>
<td>
<p>Numeric.
Time interval.
The default value is <code>1.0</code>
with an option to use a numeric value
for the discretized state space model
parameterization of the
linear stochastic differential equation model.</p>
</td></tr>
<tr><td><code id="SimSSMOUIVary_+3A_mu0">mu0</code></td>
<td>
<p>List of numeric vectors.
Each element of the list
is the mean of initial latent variable values
(<code class="reqn">\boldsymbol{\mu}_{\boldsymbol{\eta} \mid 0}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMOUIVary_+3A_sigma0_l">sigma0_l</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the Cholesky factorization (<code>t(chol(sigma0))</code>)
of the covariance matrix
of initial latent variable values
(<code class="reqn">\boldsymbol{\Sigma}_{\boldsymbol{\eta} \mid 0}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMOUIVary_+3A_mu">mu</code></td>
<td>
<p>List of numeric vectors.
Each element of the list
is the long-term mean or equilibrium level
(<code class="reqn">\boldsymbol{\mu}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMOUIVary_+3A_phi">phi</code></td>
<td>
<p>List of numeric matrix.
Each element of the list
is the drift matrix
which represents the rate of change of the solution
in the absence of any random fluctuations
(<code class="reqn">\boldsymbol{\Phi}</code>).
The negative value of <code>phi</code> is the rate of mean reversion,
determining how quickly the variable returns to its mean
(<code class="reqn">- \boldsymbol{\Phi}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMOUIVary_+3A_sigma_l">sigma_l</code></td>
<td>
<p>List of numeric matrix.
Each element of the list
is the Cholesky factorization (<code>t(chol(sigma))</code>)
of the covariance matrix of volatility
or randomness in the process
<code class="reqn">\boldsymbol{\Sigma}</code>.</p>
</td></tr>
<tr><td><code id="SimSSMOUIVary_+3A_nu">nu</code></td>
<td>
<p>List of numeric vectors.
Each element of the list
is the vector of intercept values for the measurement model
(<code class="reqn">\boldsymbol{\nu}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMOUIVary_+3A_lambda">lambda</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the factor loading matrix linking the latent variables
to the observed variables
(<code class="reqn">\boldsymbol{\Lambda}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMOUIVary_+3A_theta_l">theta_l</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the Cholesky factorization (<code>t(chol(theta))</code>)
of the covariance matrix
of the measurement error
(<code class="reqn">\boldsymbol{\Theta}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMOUIVary_+3A_type">type</code></td>
<td>
<p>Integer.
State space model type.
See Details in <code><a href="#topic+SimSSMOUFixed">SimSSMOUFixed()</a></code> for more information.</p>
</td></tr>
<tr><td><code id="SimSSMOUIVary_+3A_x">x</code></td>
<td>
<p>List.
Each element of the list is a matrix of covariates
for each individual <code>i</code> in <code>n</code>.
The number of columns in each matrix
should be equal to <code>time</code>.</p>
</td></tr>
<tr><td><code id="SimSSMOUIVary_+3A_gamma">gamma</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the matrix linking the covariates to the latent variables
at current time point
(<code class="reqn">\boldsymbol{\Gamma}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMOUIVary_+3A_kappa">kappa</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the matrix linking the covariates to the observed variables
at current time point
(<code class="reqn">\boldsymbol{\kappa}</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parameters can vary across individuals
by providing a list of parameter values.
If the length of any of the parameters
(<code>mu0</code>,
<code>sigma0_l</code>,
<code>mu</code>,
<code>phi</code>,
<code>sigma_l</code>,
<code>nu</code>,
<code>lambda</code>,
<code>theta_l</code>,
<code>gamma</code>, or
<code>kappa</code>)
is less the <code>n</code>,
the function will cycle through the available values.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>simstatespace</code>
which is a list with the following elements:
</p>

<ul>
<li> <p><code>call</code>: Function call.
</p>
</li>
<li> <p><code>args</code>: Function arguments.
</p>
</li>
<li> <p><code>data</code>: Generated data which is a list of length <code>n</code>.
Each element of <code>data</code> is a list with the following elements:
</p>

<ul>
<li> <p><code>id</code>: A vector of ID numbers with length <code>l</code>,
where <code>l</code> is the value of the function argument <code>time</code>.
</p>
</li>
<li> <p><code>time</code>: A vector time points of length <code>l</code>.
</p>
</li>
<li> <p><code>y</code>: A <code>l</code> by <code>k</code> matrix of values for the manifest variables.
</p>
</li>
<li> <p><code>eta</code>: A <code>l</code> by <code>p</code> matrix of values for the latent variables.
</p>
</li>
<li> <p><code>x</code>: A <code>l</code> by <code>j</code> matrix of values for the covariates
(when covariates are included).
</p>
</li></ul>

</li>
<li> <p><code>fun</code>: Function used.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Ivan Jacob Agaloos Pesigan
</p>


<h3>References</h3>

<p>Chow, S.-M., Ho, M. R., Hamaker, E. L., &amp; Dolan, C. V. (2010).
Equivalence and differences between structural equation modeling
and state-space modeling techniques.
<em>Structural Equation Modeling: A Multidisciplinary Journal</em>,
17(2), 303–332.
<a href="https://doi.org/10.1080/10705511003661553">doi:10.1080/10705511003661553</a>
</p>
<p>Chow, S.-M., Losardo, D., Park, J., &amp; Molenaar, P. C. M. (2023).
Continuous-time dynamic models:
Connections to structural equation models and other discrete-time models.
In R. H. Hoyle (Ed.),
Handbook of structural equation modeling (2nd ed.).
The Guilford Press.
</p>
<p>Harvey, A. C. (1990).
Forecasting, structural time series models and the Kalman filter.
Cambridge University Press.
<a href="https://doi.org/10.1017/cbo9781107049994">doi:10.1017/cbo9781107049994</a>
</p>
<p>Oravecz, Z., Tuerlinckx, F., &amp; Vandekerckhove, J. (2011).
A hierarchical latent stochastic differential equation model
for affective dynamics.
Psychological Methods,
16 (4), 468–490.
<a href="https://doi.org/10.1037/a0024375">doi:10.1037/a0024375</a>
</p>
<p>Uhlenbeck, G. E., &amp; Ornstein, L. S. (1930).
On the theory of the brownian motion.
Physical Review,
36 (5), 823–841.
<a href="https://doi.org/10.1103/physrev.36.823">doi:10.1103/physrev.36.823</a>
</p>


<h3>See Also</h3>

<p>Other Simulation of State Space Models Data Functions: 
<code><a href="#topic+LinSDE2SSM">LinSDE2SSM</a>()</code>,
<code><a href="#topic+SimSSMFixed">SimSSMFixed</a>()</code>,
<code><a href="#topic+SimSSMIVary">SimSSMIVary</a>()</code>,
<code><a href="#topic+SimSSMLinGrowth">SimSSMLinGrowth</a>()</code>,
<code><a href="#topic+SimSSMLinGrowthIVary">SimSSMLinGrowthIVary</a>()</code>,
<code><a href="#topic+SimSSMLinSDEFixed">SimSSMLinSDEFixed</a>()</code>,
<code><a href="#topic+SimSSMLinSDEIVary">SimSSMLinSDEIVary</a>()</code>,
<code><a href="#topic+SimSSMOUFixed">SimSSMOUFixed</a>()</code>,
<code><a href="#topic+SimSSMVARFixed">SimSSMVARFixed</a>()</code>,
<code><a href="#topic+SimSSMVARIVary">SimSSMVARIVary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># prepare parameters
# In this example, phi varies across individuals.
set.seed(42)
## number of individuals
n &lt;- 5
## time points
time &lt;- 50
delta_t &lt;- 0.10
## dynamic structure
p &lt;- 2
mu0 &lt;- list(
  c(-3.0, 1.5)
)
sigma0 &lt;- 0.001 * diag(p)
sigma0_l &lt;- list(
  t(chol(sigma0))
)
mu &lt;- list(
  c(5.76, 5.18)
)
phi &lt;- list(
  -0.1 * diag(p),
  -0.2 * diag(p),
  -0.3 * diag(p),
  -0.4 * diag(p),
  -0.5 * diag(p)
)
sigma &lt;- matrix(
  data = c(
    2.79,
    0.06,
    0.06,
    3.27
  ),
  nrow = p
)
sigma_l &lt;- list(
  t(chol(sigma))
)
## measurement model
k &lt;- 2
nu &lt;- list(
  rep(x = 0, times = k)
)
lambda &lt;- list(
  diag(k)
)
theta &lt;- 0.001 * diag(k)
theta_l &lt;- list(
  t(chol(theta))
)
## covariates
j &lt;- 2
x &lt;- lapply(
  X = seq_len(n),
  FUN = function(i) {
    matrix(
      data = stats::rnorm(n = time * j),
      nrow = j,
      ncol = time
    )
  }
)
gamma &lt;- list(
  diag(x = 0.10, nrow = p, ncol = j)
)
kappa &lt;- list(
  diag(x = 0.10, nrow = k, ncol = j)
)

# Type 0
ssm &lt;- SimSSMOUIVary(
  n = n,
  time = time,
  delta_t = delta_t,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  mu = mu,
  phi = phi,
  sigma_l = sigma_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 0
)

plot(ssm)

# Type 1
ssm &lt;- SimSSMOUIVary(
  n = n,
  time = time,
  delta_t = delta_t,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  mu = mu,
  phi = phi,
  sigma_l = sigma_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 1,
  x = x,
  gamma = gamma
)

plot(ssm)

# Type 2
ssm &lt;- SimSSMOUIVary(
  n = n,
  time = time,
  delta_t = delta_t,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  mu = mu,
  phi = phi,
  sigma_l = sigma_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 2,
  x = x,
  gamma = gamma,
  kappa = kappa
)

plot(ssm)

</code></pre>

<hr>
<h2 id='SimSSMVARFixed'>Simulate Data from the Vector Autoregressive Model
(Fixed Parameters)</h2><span id='topic+SimSSMVARFixed'></span>

<h3>Description</h3>

<p>This function simulates data from the
vector autoregressive model
using a state space model parameterization.
It assumes that the parameters remain constant
across individuals and over time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimSSMVARFixed(
  n,
  time,
  mu0,
  sigma0_l,
  alpha,
  beta,
  psi_l,
  type = 0,
  x = NULL,
  gamma = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimSSMVARFixed_+3A_n">n</code></td>
<td>
<p>Positive integer.
Number of individuals.</p>
</td></tr>
<tr><td><code id="SimSSMVARFixed_+3A_time">time</code></td>
<td>
<p>Positive integer.
Number of time points.</p>
</td></tr>
<tr><td><code id="SimSSMVARFixed_+3A_mu0">mu0</code></td>
<td>
<p>Numeric vector.
Mean of initial latent variable values
(<code class="reqn">\boldsymbol{\mu}_{\boldsymbol{\eta} \mid 0}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMVARFixed_+3A_sigma0_l">sigma0_l</code></td>
<td>
<p>Numeric matrix.
Cholesky factorization (<code>t(chol(sigma0))</code>)
of the covariance matrix
of initial latent variable values
(<code class="reqn">\boldsymbol{\Sigma}_{\boldsymbol{\eta} \mid 0}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMVARFixed_+3A_alpha">alpha</code></td>
<td>
<p>Numeric vector.
Vector of constant values for the dynamic model
(<code class="reqn">\boldsymbol{\alpha}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMVARFixed_+3A_beta">beta</code></td>
<td>
<p>Numeric matrix.
Transition matrix relating the values of the latent variables
at the previous to the current time point
(<code class="reqn">\boldsymbol{\beta}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMVARFixed_+3A_psi_l">psi_l</code></td>
<td>
<p>Numeric matrix.
Cholesky factorization (<code>t(chol(psi))</code>)
of the covariance matrix
of the process noise
(<code class="reqn">\boldsymbol{\Psi}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMVARFixed_+3A_type">type</code></td>
<td>
<p>Integer.
State space model type.
See Details for more information.</p>
</td></tr>
<tr><td><code id="SimSSMVARFixed_+3A_x">x</code></td>
<td>
<p>List.
Each element of the list is a matrix of covariates
for each individual <code>i</code> in <code>n</code>.
The number of columns in each matrix
should be equal to <code>time</code>.</p>
</td></tr>
<tr><td><code id="SimSSMVARFixed_+3A_gamma">gamma</code></td>
<td>
<p>Numeric matrix.
Matrix linking the covariates to the latent variables
at current time point
(<code class="reqn">\boldsymbol{\Gamma}</code>).</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>Type 0</h4>

<p>The measurement model is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathbf{y}_{i, t}
    =
    \boldsymbol{\eta}_{i, t}
  </code>
</p>

<p>where <code class="reqn">\mathbf{y}_{i, t}</code>
represents a vector of observed variables
and <code class="reqn">\boldsymbol{\eta}_{i, t}</code>
a vector of latent variables
for individual <code class="reqn">i</code> and time <code class="reqn">t</code>.
Since the observed and latent variables are equal,
we only generate data
from the dynamic structure.
</p>
<p>The dynamic structure is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \boldsymbol{\eta}_{i, t}
    =
    \boldsymbol{\alpha}
    +
    \boldsymbol{\beta}
    \boldsymbol{\eta}_{i, t - 1}
    +
    \boldsymbol{\zeta}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \boldsymbol{\zeta}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \boldsymbol{\Psi}
    \right)
  </code>
</p>

<p>where
<code class="reqn">\boldsymbol{\eta}_{i, t}</code>,
<code class="reqn">\boldsymbol{\eta}_{i, t - 1}</code>,
and
<code class="reqn">\boldsymbol{\zeta}_{i, t}</code>
are random variables,
and
<code class="reqn">\boldsymbol{\alpha}</code>,
<code class="reqn">\boldsymbol{\beta}</code>,
and
<code class="reqn">\boldsymbol{\Psi}</code>
are model parameters.
Here,
<code class="reqn">\boldsymbol{\eta}_{i, t}</code>
is a vector of latent variables
at time <code class="reqn">t</code> and individual <code class="reqn">i</code>,
<code class="reqn">\boldsymbol{\eta}_{i, t - 1}</code>
represents a vector of latent variables
at time <code class="reqn">t - 1</code> and individual <code class="reqn">i</code>,
and
<code class="reqn">\boldsymbol{\zeta}_{i, t}</code>
represents a vector of dynamic noise
at time <code class="reqn">t</code> and individual <code class="reqn">i</code>.
<code class="reqn">\boldsymbol{\alpha}</code>
denotes a vector of intercepts,
<code class="reqn">\boldsymbol{\beta}</code>
a matrix of autoregression
and cross regression coefficients,
and
<code class="reqn">\boldsymbol{\Psi}</code>
the covariance matrix of
<code class="reqn">\boldsymbol{\zeta}_{i, t}</code>.
</p>
<p>An alternative representation of the dynamic noise
is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \boldsymbol{\zeta}_{i, t}
    =
    \boldsymbol{\Psi}^{\frac{1}{2}}
    \mathbf{z}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \mathbf{z}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \mathbf{I}
    \right)
  </code>
</p>

<p>where
<code class="reqn">
    \left( \boldsymbol{\Psi}^{\frac{1}{2}} \right)
    \left( \boldsymbol{\Psi}^{\frac{1}{2}} \right)^{\prime}
    =
    \boldsymbol{\Psi} .
  </code>
</p>



<h4>Type 1</h4>

<p>The measurement model is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathbf{y}_{i, t}
    =
    \boldsymbol{\eta}_{i, t} .
  </code>
</p>

<p>The dynamic structure is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \boldsymbol{\eta}_{i, t}
    =
    \boldsymbol{\alpha}
    +
    \boldsymbol{\beta}
    \boldsymbol{\eta}_{i, t - 1}
    +
    \boldsymbol{\Gamma}
    \mathbf{x}_{i, t}
    +
    \boldsymbol{\zeta}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \boldsymbol{\zeta}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \boldsymbol{\Psi}
    \right)
  </code>
</p>

<p>where
<code class="reqn">\mathbf{x}_{i, t}</code> represents a vector of covariates
at time <code class="reqn">t</code> and individual <code class="reqn">i</code>,
and <code class="reqn">\boldsymbol{\Gamma}</code> the coefficient matrix
linking the covariates to the latent variables.
</p>



<h3>Value</h3>

<p>Returns an object of class <code>simstatespace</code>
which is a list with the following elements:
</p>

<ul>
<li> <p><code>call</code>: Function call.
</p>
</li>
<li> <p><code>args</code>: Function arguments.
</p>
</li>
<li> <p><code>data</code>: Generated data which is a list of length <code>n</code>.
Each element of <code>data</code> is a list with the following elements:
</p>

<ul>
<li> <p><code>id</code>: A vector of ID numbers with length <code>l</code>,
where <code>l</code> is the value of the function argument <code>time</code>.
</p>
</li>
<li> <p><code>time</code>: A vector time points of length <code>l</code>.
</p>
</li>
<li> <p><code>y</code>: A <code>l</code> by <code>k</code> matrix of values for the manifest variables.
</p>
</li>
<li> <p><code>eta</code>: A <code>l</code> by <code>p</code> matrix of values for the latent variables.
</p>
</li>
<li> <p><code>x</code>: A <code>l</code> by <code>j</code> matrix of values for the covariates
(when covariates are included).
</p>
</li></ul>

</li>
<li> <p><code>fun</code>: Function used.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Ivan Jacob Agaloos Pesigan
</p>


<h3>References</h3>

<p>Chow, S.-M., Ho, M. R., Hamaker, E. L., &amp; Dolan, C. V. (2010).
Equivalence and differences between structural equation modeling
and state-space modeling techniques.
<em>Structural Equation Modeling: A Multidisciplinary Journal</em>,
17(2), 303–332.
<a href="https://doi.org/10.1080/10705511003661553">doi:10.1080/10705511003661553</a>
</p>


<h3>See Also</h3>

<p>Other Simulation of State Space Models Data Functions: 
<code><a href="#topic+LinSDE2SSM">LinSDE2SSM</a>()</code>,
<code><a href="#topic+SimSSMFixed">SimSSMFixed</a>()</code>,
<code><a href="#topic+SimSSMIVary">SimSSMIVary</a>()</code>,
<code><a href="#topic+SimSSMLinGrowth">SimSSMLinGrowth</a>()</code>,
<code><a href="#topic+SimSSMLinGrowthIVary">SimSSMLinGrowthIVary</a>()</code>,
<code><a href="#topic+SimSSMLinSDEFixed">SimSSMLinSDEFixed</a>()</code>,
<code><a href="#topic+SimSSMLinSDEIVary">SimSSMLinSDEIVary</a>()</code>,
<code><a href="#topic+SimSSMOUFixed">SimSSMOUFixed</a>()</code>,
<code><a href="#topic+SimSSMOUIVary">SimSSMOUIVary</a>()</code>,
<code><a href="#topic+SimSSMVARIVary">SimSSMVARIVary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># prepare parameters
set.seed(42)
## number of individuals
n &lt;- 5
## time points
time &lt;- 50
## dynamic structure
p &lt;- 3
mu0 &lt;- rep(x = 0, times = p)
sigma0 &lt;- 0.001 * diag(p)
sigma0_l &lt;- t(chol(sigma0))
alpha &lt;- rep(x = 0, times = p)
beta &lt;- 0.50 * diag(p)
psi &lt;- 0.001 * diag(p)
psi_l &lt;- t(chol(psi))
## covariates
j &lt;- 2
x &lt;- lapply(
  X = seq_len(n),
  FUN = function(i) {
    matrix(
      data = stats::rnorm(n = time * j),
      nrow = j,
      ncol = time
    )
  }
)
gamma &lt;- diag(x = 0.10, nrow = p, ncol = j)

# Type 0
ssm &lt;- SimSSMVARFixed(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  type = 0
)

plot(ssm)

# Type 1
ssm &lt;- SimSSMVARFixed(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  type = 1,
  x = x,
  gamma = gamma
)

plot(ssm)

</code></pre>

<hr>
<h2 id='SimSSMVARIVary'>Simulate Data from the Vector Autoregressive Model
(Individual-Varying Parameters)</h2><span id='topic+SimSSMVARIVary'></span>

<h3>Description</h3>

<p>This function simulates data from the
vector autoregressive model
using a state space model parameterization.
It assumes that the parameters can vary
across individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimSSMVARIVary(
  n,
  time,
  mu0,
  sigma0_l,
  alpha,
  beta,
  psi_l,
  type = 0,
  x = NULL,
  gamma = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimSSMVARIVary_+3A_n">n</code></td>
<td>
<p>Positive integer.
Number of individuals.</p>
</td></tr>
<tr><td><code id="SimSSMVARIVary_+3A_time">time</code></td>
<td>
<p>Positive integer.
Number of time points.</p>
</td></tr>
<tr><td><code id="SimSSMVARIVary_+3A_mu0">mu0</code></td>
<td>
<p>List of numeric vectors.
Each element of the list
is the mean of initial latent variable values
(<code class="reqn">\boldsymbol{\mu}_{\boldsymbol{\eta} \mid 0}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMVARIVary_+3A_sigma0_l">sigma0_l</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the Cholesky factorization (<code>t(chol(sigma0))</code>)
of the covariance matrix
of initial latent variable values
(<code class="reqn">\boldsymbol{\Sigma}_{\boldsymbol{\eta} \mid 0}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMVARIVary_+3A_alpha">alpha</code></td>
<td>
<p>List of numeric vectors.
Each element of the list
is the vector of constant values for the dynamic model
(<code class="reqn">\boldsymbol{\alpha}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMVARIVary_+3A_beta">beta</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the transition matrix relating the values of the latent variables
at the previous to the current time point
(<code class="reqn">\boldsymbol{\beta}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMVARIVary_+3A_psi_l">psi_l</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the Cholesky factorization (<code>t(chol(psi))</code>)
of the covariance matrix
of the process noise
(<code class="reqn">\boldsymbol{\Psi}</code>).</p>
</td></tr>
<tr><td><code id="SimSSMVARIVary_+3A_type">type</code></td>
<td>
<p>Integer.
State space model type.
See Details in <code><a href="#topic+SimSSMVARFixed">SimSSMVARFixed()</a></code> for more information.</p>
</td></tr>
<tr><td><code id="SimSSMVARIVary_+3A_x">x</code></td>
<td>
<p>List.
Each element of the list is a matrix of covariates
for each individual <code>i</code> in <code>n</code>.
The number of columns in each matrix
should be equal to <code>time</code>.</p>
</td></tr>
<tr><td><code id="SimSSMVARIVary_+3A_gamma">gamma</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the matrix linking the covariates to the latent variables
at current time point
(<code class="reqn">\boldsymbol{\Gamma}</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parameters can vary across individuals
by providing a list of parameter values.
If the length of any of the parameters
(<code>mu0</code>,
<code>sigma0_l</code>,
<code>alpha</code>,
<code>beta</code>,
<code>psi_l</code>,
<code>gamma</code>, or
<code>kappa</code>)
is less the <code>n</code>,
the function will cycle through the available values.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>simstatespace</code>
which is a list with the following elements:
</p>

<ul>
<li> <p><code>call</code>: Function call.
</p>
</li>
<li> <p><code>args</code>: Function arguments.
</p>
</li>
<li> <p><code>data</code>: Generated data which is a list of length <code>n</code>.
Each element of <code>data</code> is a list with the following elements:
</p>

<ul>
<li> <p><code>id</code>: A vector of ID numbers with length <code>l</code>,
where <code>l</code> is the value of the function argument <code>time</code>.
</p>
</li>
<li> <p><code>time</code>: A vector time points of length <code>l</code>.
</p>
</li>
<li> <p><code>y</code>: A <code>l</code> by <code>k</code> matrix of values for the manifest variables.
</p>
</li>
<li> <p><code>eta</code>: A <code>l</code> by <code>p</code> matrix of values for the latent variables.
</p>
</li>
<li> <p><code>x</code>: A <code>l</code> by <code>j</code> matrix of values for the covariates
(when covariates are included).
</p>
</li></ul>

</li>
<li> <p><code>fun</code>: Function used.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Ivan Jacob Agaloos Pesigan
</p>


<h3>References</h3>

<p>Chow, S.-M., Ho, M. R., Hamaker, E. L., &amp; Dolan, C. V. (2010).
Equivalence and differences between structural equation modeling
and state-space modeling techniques.
<em>Structural Equation Modeling: A Multidisciplinary Journal</em>,
17(2), 303–332.
<a href="https://doi.org/10.1080/10705511003661553">doi:10.1080/10705511003661553</a>
</p>


<h3>See Also</h3>

<p>Other Simulation of State Space Models Data Functions: 
<code><a href="#topic+LinSDE2SSM">LinSDE2SSM</a>()</code>,
<code><a href="#topic+SimSSMFixed">SimSSMFixed</a>()</code>,
<code><a href="#topic+SimSSMIVary">SimSSMIVary</a>()</code>,
<code><a href="#topic+SimSSMLinGrowth">SimSSMLinGrowth</a>()</code>,
<code><a href="#topic+SimSSMLinGrowthIVary">SimSSMLinGrowthIVary</a>()</code>,
<code><a href="#topic+SimSSMLinSDEFixed">SimSSMLinSDEFixed</a>()</code>,
<code><a href="#topic+SimSSMLinSDEIVary">SimSSMLinSDEIVary</a>()</code>,
<code><a href="#topic+SimSSMOUFixed">SimSSMOUFixed</a>()</code>,
<code><a href="#topic+SimSSMOUIVary">SimSSMOUIVary</a>()</code>,
<code><a href="#topic+SimSSMVARFixed">SimSSMVARFixed</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># prepare parameters
# In this example, beta varies across individuals.
set.seed(42)
## number of individuals
n &lt;- 5
## time points
time &lt;- 50
## dynamic structure
p &lt;- 3
mu0 &lt;- list(
  rep(x = 0, times = p)
)
sigma0 &lt;- 0.001 * diag(p)
sigma0_l &lt;- list(
  t(chol(sigma0))
)
alpha &lt;- list(
  rep(x = 0, times = p)
)
beta &lt;- list(
  0.1 * diag(p),
  0.2 * diag(p),
  0.3 * diag(p),
  0.4 * diag(p),
  0.5 * diag(p)
)
psi &lt;- 0.001 * diag(p)
psi_l &lt;- list(
  t(chol(psi))
)
## covariates
j &lt;- 2
x &lt;- lapply(
  X = seq_len(n),
  FUN = function(i) {
    matrix(
      data = stats::rnorm(n = time * j),
      nrow = j,
      ncol = time
    )
  }
)
gamma &lt;- list(
  diag(x = 0.10, nrow = p, ncol = j)
)

# Type 0
ssm &lt;- SimSSMVARIVary(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  type = 0
)

plot(ssm)

# Type 1
ssm &lt;- SimSSMVARIVary(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  type = 1,
  x = x,
  gamma = gamma
)

plot(ssm)

</code></pre>

<hr>
<h2 id='simStateSpace-package'>simStateSpace: Simulate Data from State Space Models</h2><span id='topic+simStateSpace'></span><span id='topic+simStateSpace-package'></span>

<h3>Description</h3>

<p>Provides a streamlined and user-friendly framework for simulating data in state space models, particularly when the number of subjects/units (n) exceeds one, a scenario commonly encountered in social and behavioral sciences. For an introduction to state space models in social and behavioral sciences, refer to Chow, Ho, Hamaker, and Dolan (2010) <a href="https://doi.org/10.1080/10705511003661553">doi:10.1080/10705511003661553</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Ivan Jacob Agaloos Pesigan <a href="mailto:r.jeksterslab@gmail.com">r.jeksterslab@gmail.com</a> (<a href="https://orcid.org/0000-0003-4818-8420">ORCID</a>) [copyright holder]
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/jeksterslab/simStateSpace">https://github.com/jeksterslab/simStateSpace</a>
</p>
</li>
<li> <p><a href="https://jeksterslab.github.io/simStateSpace/">https://jeksterslab.github.io/simStateSpace/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/jeksterslab/simStateSpace/issues">https://github.com/jeksterslab/simStateSpace/issues</a>
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
