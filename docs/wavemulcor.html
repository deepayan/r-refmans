<!DOCTYPE html><html><head><title>Help for package wavemulcor</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {wavemulcor}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#heatmap_wave.local.multiple.correlation'>
<p>Auxiliary routine for heatmaping wave local multiple correlations</p></a></li>
<li><a href='#heatmap_wave.local.multiple.cross.correlation'>
<p>Auxiliary routine for heatmaping wave local multiple cross-correlations</p></a></li>
<li><a href='#heatmap_wave.multiple.cross.correlation'>
<p>Auxiliary routine for heatmaping wave multiple cross-correlations</p></a></li>
<li><a href='#local.multiple.correlation'>
<p>Routine for local multiple correlation</p></a></li>
<li><a href='#local.multiple.cross.correlation'>
<p>Routine for local multiple cross-correlation</p></a></li>
<li><a href='#local.multiple.cross.regression'>
<p>Routine for local multiple cross-regression</p></a></li>
<li><a href='#local.multiple.regression'>
<p>Routine for local multiple regression</p></a></li>
<li><a href='#plot_local.multiple.correlation'>
<p>Auxiliary routine for plotting local multiple correlations</p></a></li>
<li><a href='#plot_local.multiple.cross.correlation'>
<p>Auxiliary routine for plotting local multiple cross-correlations</p></a></li>
<li><a href='#plot_local.multiple.cross.regression'>
<p>Auxiliary routine for plotting local multiple cross-regressions</p></a></li>
<li><a href='#plot_local.multiple.regression'>
<p>Auxiliary routine for plotting local multiple regressions</p></a></li>
<li><a href='#plot_wave.local.multiple.correlation'>
<p>Auxiliary routine for plotting wave local multiple correlations</p></a></li>
<li><a href='#plot_wave.local.multiple.cross.correlation'>
<p>Auxiliary routine for plotting wave local multiple cross-correlations</p></a></li>
<li><a href='#plot_wave.local.multiple.cross.regression'>
<p>Auxiliary routine for plotting wave local multiple cross-regressions</p></a></li>
<li><a href='#plot_wave.local.multiple.regression'>
<p>Auxiliary routine for plotting wave local multiple regressions</p></a></li>
<li><a href='#plot_wave.multiple.correlation'>
<p>Auxiliary routine for plotting wave multiple correlations</p></a></li>
<li><a href='#plot_wave.multiple.cross.correlation'>
<p>Auxiliary routine for plotting wave multiple cross-correlations</p></a></li>
<li><a href='#plot_wave.multiple.cross.regression'>
<p>Auxiliary routine for plotting wave multiple cross-regressions</p></a></li>
<li><a href='#plot_wave.multiple.regression'>
<p>Auxiliary routine for plotting wave multiple regressions</p></a></li>
<li><a href='#wave.local.multiple.correlation'>
<p>Wavelet routine for local multiple correlation</p></a></li>
<li><a href='#wave.local.multiple.cross.correlation'>
<p>Wavelet routine for local multiple cross-correlation</p></a></li>
<li><a href='#wave.local.multiple.cross.regression'>
<p>Wavelet routine for local multiple cross-regression</p></a></li>
<li><a href='#wave.local.multiple.regression'>
<p>Wavelet routine for local multiple regression</p></a></li>
<li><a href='#wave.multiple.correlation'>
<p>Wavelet routine for multiple correlation</p></a></li>
<li><a href='#wave.multiple.cross.correlation'>
<p>Wavelet routine for multiple cross-correlation</p></a></li>
<li><a href='#wave.multiple.cross.regression'>
<p>Wavelet routine for multiple cross-regression</p></a></li>
<li><a href='#wave.multiple.regression'>
<p>Wavelet routine for multiple regression</p></a></li>
<li><a href='#wavemulcor-package'>
<p>Wavelet Routines for Global and Local Multiple Regression and</p>
Correlation</a></li>
<li><a href='#xrand'>
<p>Correlation structural breaks data</p></a></li>
<li><a href='#xrand1'>
<p>Correlation structural breaks variable 1</p></a></li>
<li><a href='#xrand2'>
<p>Correlation structural breaks variable 2</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Wavelet Routines for Global and Local Multiple Regression and
Correlation</td>
</tr>
<tr>
<td>Version:</td>
<td>3.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Wavelet routines that calculate single sets of wavelet
    multiple regressions and correlations, and cross-regressions and
    cross-correlations from a multivariate time series.  Dynamic versions
    of the routines allow the wavelet local multiple (cross-)regressions
    and (cross-)correlations to evolve over time.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0), waveslim (&ge; 1.7.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>plot3D, RColorBrewer</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, knitr, markdown, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-09-02 23:07:09 UTC; Javier</td>
</tr>
<tr>
<td>Author:</td>
<td>Javier Fernandez-Macho
    <a href="https://orcid.org/0000-0002-5970-4382"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Javier Fernandez-Macho &lt;javier.fernandezmacho@ehu.es&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-09-03 12:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='heatmap_wave.local.multiple.correlation'>
Auxiliary routine for heatmaping wave local multiple correlations
</h2><span id='topic+heatmap_wave.local.multiple.correlation'></span><span id='topic+heatmap_wlmc'></span>

<h3>Description</h3>

<p>Produces a heatmap of wave local multiple correlations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heatmap_wave.local.multiple.correlation(Lst, xaxt="s", ci=NULL, pdf.write=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="heatmap_wave.local.multiple.correlation_+3A_lst">Lst</code></td>
<td>
<p>A list from wave.local.multiple.regression.</p>
</td></tr>
<tr><td><code id="heatmap_wave.local.multiple.correlation_+3A_xaxt">xaxt</code></td>
<td>
<p>An optional vector of labels for the &quot;x&quot; axis. Default is 1:n.</p>
</td></tr>
<tr><td><code id="heatmap_wave.local.multiple.correlation_+3A_ci">ci</code></td>
<td>
<p> value to plot: &quot;center&quot; value of confidence interval (<em>i.e.</em> the estimated correlation),
the  &quot;lower&quot; bound, or the &quot;upper&quot; bound. Default is &quot;center&quot;.</p>
</td></tr>
<tr><td><code id="heatmap_wave.local.multiple.correlation_+3A_pdf.write">pdf.write</code></td>
<td>
<p> Optional name leader to save files to pdf format.
The actual name of the file is &quot;heat_&lt;pdf.write&gt;_WLMC.pdf&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine produces a time series vs. wavelet periods heatmap of wave local multiple correlations.</p>


<h3>Value</h3>

<p>Heat map.</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>

<hr>
<h2 id='heatmap_wave.local.multiple.cross.correlation'>
Auxiliary routine for heatmaping wave local multiple cross-correlations
</h2><span id='topic+heatmap_wave.local.multiple.cross.correlation'></span><span id='topic+heatmap_wlmcc'></span>

<h3>Description</h3>

<p>Produces heatmaps of wave local multiple cross-correlations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heatmap_wave.local.multiple.cross.correlation(Lst, lmax,
     lag.first=FALSE, xaxt="s", ci=NULL, pdf.write=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="heatmap_wave.local.multiple.cross.correlation_+3A_lst">Lst</code></td>
<td>
<p>A list from wave.local.multiple.cross.regression.</p>
</td></tr>
<tr><td><code id="heatmap_wave.local.multiple.cross.correlation_+3A_lmax">lmax</code></td>
<td>
<p> maximum lag (and lead). </p>
</td></tr>
<tr><td><code id="heatmap_wave.local.multiple.cross.correlation_+3A_lag.first">lag.first</code></td>
<td>
<p> if TRUE, it produces lag-lead pages with <code class="reqn">J+1</code> wavelet heatmaps each.
Otherwise (default) it gives wavelet pages with <code class="reqn">2*lmax+1</code> lag-lead heatmaps each. </p>
</td></tr>
<tr><td><code id="heatmap_wave.local.multiple.cross.correlation_+3A_xaxt">xaxt</code></td>
<td>
<p>An optional vector of labels for the &quot;x&quot; axis. Default is 1:n.</p>
</td></tr>
<tr><td><code id="heatmap_wave.local.multiple.cross.correlation_+3A_ci">ci</code></td>
<td>
<p> value to plot: &quot;center&quot; value of confidence interval (<em>i.e.</em> the estimated cross-correlation),
the  &quot;lower&quot; bound, or the &quot;upper&quot; bound. Default is &quot;center&quot;.</p>
</td></tr>
<tr><td><code id="heatmap_wave.local.multiple.cross.correlation_+3A_pdf.write">pdf.write</code></td>
<td>
<p> Optional name leader to save files to pdf format.
The actual name of the file is either
&quot;heat_&lt;pdf.write&gt;_WLMCC_lags.pdf&quot; or, &quot;heat_&lt;pdf.write&gt;_WLMCC_levels.pdf&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine produces a set of time series vs. wavelet periods heatmaps of wave local multiple
cross-correlations at different lags and leads.</p>


<h3>Value</h3>

<p>Heat map.</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>

<hr>
<h2 id='heatmap_wave.multiple.cross.correlation'>
Auxiliary routine for heatmaping wave multiple cross-correlations
</h2><span id='topic+heatmap_wave.multiple.cross.correlation'></span><span id='topic+heatmap_wmcc'></span>

<h3>Description</h3>

<p>Produces heatmaps of wave multiple cross-correlations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heatmap_wave.multiple.cross.correlation(Lst, lmax, by=3, ci=NULL, pdf.write=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="heatmap_wave.multiple.cross.correlation_+3A_lst">Lst</code></td>
<td>
<p>A list from wave.multiple.cross.regression or wave.multiple.cross.correlation.</p>
</td></tr>
<tr><td><code id="heatmap_wave.multiple.cross.correlation_+3A_lmax">lmax</code></td>
<td>
<p> maximum lag (and lead). </p>
</td></tr>
<tr><td><code id="heatmap_wave.multiple.cross.correlation_+3A_by">by</code></td>
<td>
<p> labels are printed every lmax/by. Default is 3. </p>
</td></tr>
<tr><td><code id="heatmap_wave.multiple.cross.correlation_+3A_ci">ci</code></td>
<td>
<p> value to plot: &quot;center&quot; value of confidence interval (<em>i.e.</em> the estimated cross-correlation),
the  &quot;lower&quot; bound, or the &quot;upper&quot; bound. Default is &quot;center&quot;.</p>
</td></tr>
<tr><td><code id="heatmap_wave.multiple.cross.correlation_+3A_pdf.write">pdf.write</code></td>
<td>
<p> Optional name leader to save files to pdf format.
The actual name of the file is either
&quot;heat_&lt;pdf.write&gt;_WLMCC_lags.pdf&quot; or, &quot;heat_&lt;pdf.write&gt;_WLMCC_levels.pdf&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine produces a set of time series vs. wavelet periods heatmaps of wave local multiple
cross-correlations at different lags and leads.</p>


<h3>Value</h3>

<p>Heat map.</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2012. Wavelet multiple correlation and cross-correlation: A multiscale analysis of Eurozone stock markets. Physica A: Statistical Mechanics and its Applications 391, 1097&ndash;1104. &lt;DOI:10.1016/j.physa.2011.11.002&gt;
</p>

<hr>
<h2 id='local.multiple.correlation'>
Routine for local multiple correlation
</h2><span id='topic+local.multiple.correlation'></span><span id='topic+lmc'></span>

<h3>Description</h3>

<p>Produces an estimate of local multiple correlations
(as defined below) along with approximate confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>local.multiple.correlation(xx, M, window="gauss", p = .975, ymaxr=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="local.multiple.correlation_+3A_xx">xx</code></td>
<td>
<p>A list of <code class="reqn">n</code> time series, <em>e.g.</em>
xx &lt;- list(v1, v2, v3)</p>
</td></tr>
<tr><td><code id="local.multiple.correlation_+3A_m">M</code></td>
<td>
<p>length of the weight function or rolling window.</p>
</td></tr>
<tr><td><code id="local.multiple.correlation_+3A_window">window</code></td>
<td>
<p>type of weight function or rolling window.
Six types are allowed, namely
the uniform window,
Cleveland or tricube window,
Epanechnikov or parabolic window,
Bartlett or triangular window,
Wendland window and
the gaussian window.
The letter case and length of the argument are not relevant
as long as at least the first four characters are entered.</p>
</td></tr>
<tr><td><code id="local.multiple.correlation_+3A_p">p</code></td>
<td>
<p>one minus the two-sided p-value for the confidence interval, <em>i.e.</em> the cdf value.</p>
</td></tr>
<tr><td><code id="local.multiple.correlation_+3A_ymaxr">ymaxr</code></td>
<td>
<p>index number of the variable whose correlation is calculated against a linear combination
of the rest, otherwise at each wavelet level lmc chooses the one maximizing the multiple correlation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine calculates a time series of  multiple correlations out of <code class="reqn">n</code> variables.
The code is based on the calculation of the square root of the coefficient of
determination in that linear combination of locally weighted values for which such coefficient of determination is a maximum.
</p>


<h3>Value</h3>

<p>List of four elements:
</p>
<table>
<tr><td><code>val:</code></td>
<td>
<p> numeric vector (rows = #observations) providing the point estimates for the local multiple correlation.</p>
</td></tr>
<tr><td><code>lo:</code></td>
<td>
<p> numeric vector (rows = #observations) providing the lower bounds of the confidence interval.</p>
</td></tr>
<tr><td><code>up:</code></td>
<td>
<p> numeric vector (rows = #observations) providing the upper bounds of the confidence interval.</p>
</td></tr>
<tr><td><code>YmaxR:</code></td>
<td>
<p> numeric vector (rows = #observations) giving, at each value in time, the index number of the variable 
whose correlation is calculated against a linear combination of the rest.
By default, <em>lmc</em> chooses at each value in time the variable maximizing the multiple correlation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Based on  Figure 4 showing correlation structural breaks in Fernandez-Macho (2018).

library(wavemulcor)
options(warn = -1)

xrand1 &lt;- wavemulcor::xrand1
xrand2 &lt;- wavemulcor::xrand2
N &lt;- length(xrand1)
b &lt;- trunc(N/3)
t1 &lt;- 1:b
t2 &lt;- (b+1):(2*b)
t3 &lt;- (2*b+1):N

wf &lt;- "d4"
M &lt;- N/2^3 #sharper with N/2^4
window &lt;- "gaussian"

J &lt;- trunc(log2(N))-3

# ---------------------------

cor1 &lt;- cor(xrand1[t1],xrand2[t1])
cor2 &lt;- cor(xrand1[t2],xrand2[t2])
cor3 &lt;- cor(xrand1[t3],xrand2[t3])
cortext &lt;- paste0(round(100*cor1,0),"-",round(100*cor2,0),"-",round(100*cor3,0))

ts.plot(cbind(xrand1,xrand2),col=c("red","blue"),xlab="time")

xx &lt;- data.frame(xrand1,xrand2)

# ---------------------------

xy.mulcor &lt;- local.multiple.correlation(xx, M, window=window)

val &lt;- as.matrix(xy.mulcor$val)
lo  &lt;- as.matrix(xy.mulcor$lo)
up  &lt;- as.matrix(xy.mulcor$up)
YmaxR &lt;- as.matrix(xy.mulcor$YmaxR)

# ---------------------------

old.par &lt;- par()

# ##Producing line plots with CI

title &lt;- paste("Local Multiple Correlation")
sub &lt;- paste("first",b,"obs:",round(100*cor1,1),"% correlation;","middle",b,"obs:",
             round(100*cor2,1),"%","rest:",round(100*cor3,1),"%")
xlab &lt;- "time"
ylab &lt;- "correlation"

matplot(1:N,cbind(val,lo,up),
        main=title, sub=sub,
        xlab=xlab, ylab=ylab, type="l", lty=1, col= c(1,2,2), cex.axis=0.75)
abline(h=0) ##Add Straight horiz and vert Lines to a Plot

#reset graphics parameters
par(old.par)

</code></pre>

<hr>
<h2 id='local.multiple.cross.correlation'>
Routine for local multiple cross-correlation
</h2><span id='topic+local.multiple.cross.correlation'></span><span id='topic+lmcc'></span>

<h3>Description</h3>

<p>Produces an estimate of local multiple cross-correlations
(as defined below) along with approximate confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> local.multiple.cross.correlation(xx, M, window="gauss", lag.max=NULL, p=.975, ymaxr=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="local.multiple.cross.correlation_+3A_xx">xx</code></td>
<td>
<p>A list of <code class="reqn">n</code> time series, <em>e.g.</em>
xx &lt;- list(v1, v2, v3)</p>
</td></tr>
<tr><td><code id="local.multiple.cross.correlation_+3A_m">M</code></td>
<td>
<p>length of the weight function or rolling window.</p>
</td></tr>
<tr><td><code id="local.multiple.cross.correlation_+3A_window">window</code></td>
<td>
<p>type of weight function or rolling window.
Six types are allowed, namely
the uniform window,
Cleveland or tricube window,
Epanechnikov or parabolic window,
Bartlett or triangular window,
Wendland window and
the gaussian window.
The letter case and length of the argument are not relevant
as long as at least the first four characters are entered.</p>
</td></tr>
<tr><td><code id="local.multiple.cross.correlation_+3A_lag.max">lag.max</code></td>
<td>
<p> maximum lag (and lead). If not set, it defaults to half the square root of the length of the original series.</p>
</td></tr>
<tr><td><code id="local.multiple.cross.correlation_+3A_p">p</code></td>
<td>
<p>one minus the two-sided p-value for the confidence interval, <em>i.e.</em> the cdf value.</p>
</td></tr>
<tr><td><code id="local.multiple.cross.correlation_+3A_ymaxr">ymaxr</code></td>
<td>
<p>index number of the variable whose correlation is calculated against a linear combination of the rest, otherwise at each wavelet level lmc chooses the one maximizing the multiple correlation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine calculates a set of  time series of  multiple cross-correlations, one per lag and lead) out of <code class="reqn">n</code> variables.
</p>


<h3>Value</h3>

<p>List of four elements:
</p>
<table>
<tr><td><code>vals:</code></td>
<td>
<p> numeric matrix (rows = #observations, cols = #lags and leads) providing the point estimates for the local multiple cross-correlation.</p>
</td></tr>
<tr><td><code>lower:</code></td>
<td>
<p> numeric vmatrix (rows = #observations, cols = #lags and leads) providing the lower bounds from the confidence interval.</p>
</td></tr>
<tr><td><code>upper:</code></td>
<td>
<p> numeric matrix (rows = #observations, cols = #lags and leads) providing the upper bounds from the confidence interval.</p>
</td></tr>
<tr><td><code>YmaxR:</code></td>
<td>
<p> numeric matrix (rows = #observations, cols = #lags and leads) giving, at each value in time, the index number of the variable
whose correlation is calculated against a linear combination of the rest.
By default, <em>lmcc</em> chooses at each value in time the variable maximizing the multiple correlation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Based on  Figure 4 showing correlation structural breaks in Fernandez-Macho (2018).

library(wavemulcor)

data(exchange)
returns &lt;- diff(log(as.matrix(exchange)))
returns &lt;- ts(returns, start=1970, freq=12)
N &lt;- dim(returns)[1]

M &lt;- 30
window &lt;- "gauss"
lmax &lt;- 1

demusd &lt;- returns[,"DEM.USD"]
jpyusd &lt;- returns[,"JPY.USD"]

set.seed(140859)

xrand &lt;- rnorm(N)

xx &lt;- data.frame(demusd, jpyusd, xrand)
##exchange.names &lt;- c(colnames(returns), "RAND")

Lst &lt;- local.multiple.cross.correlation(xx, M, window=window, lag.max=lmax)
val &lt;- Lst$vals
low.ci &lt;- Lst$lower
upp.ci &lt;- Lst$upper
YmaxR &lt;- Lst$YmaxR

# ---------------------------

##Producing correlation plot

colnames(val) &lt;- paste("Lag",-lmax:lmax)
xvar &lt;- seq(1,N,M)
par(mfcol=c(lmax+1,2), las=1, pty="m", mar=c(2,3,1,0)+.1, oma=c(1.2,1.2,0,0))
ymin &lt;- -0.1
if (length(xx)&lt;3) ymin &lt;- -1
for(i in c(-lmax:0,lmax:1)+lmax+1) {
  matplot(1:N,val[,i], type="l", lty=1, ylim=c(ymin,1), #xaxt="n",
          xlab="", ylab="", main=colnames(val)[i])
  # if(i==lmax+1) {axis(side=1, at=seq(0,N+50,50))}
  #axis(side=2, at=c(-.2, 0, .5, 1))
  abline(h=0)              ##Add Straight horiz
  lines(low.ci[,i], lty=1, col=2) ##Add Connected Line Segments to a Plot
  lines(upp.ci[,i], lty=1, col=2)
  text(xvar,1, labels=names(xx)[YmaxR][xvar], adj=0.25, cex=.8)
}
par(las=0)
mtext('time', side=1, outer=TRUE, adj=0.5)
mtext('Local Multiple Cross-Correlation', side=2, outer=TRUE, adj=0.5)

</code></pre>

<hr>
<h2 id='local.multiple.cross.regression'>
Routine for local multiple cross-regression
</h2><span id='topic+local.multiple.cross.regression'></span><span id='topic+lmcr'></span>

<h3>Description</h3>

<p>Produces an estimate of local multiple cross-regressions
(as defined below) along with approximate confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>local.multiple.cross.regression(xx, M, window="gauss", lag.max=NULL, p=.975, ymaxr=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="local.multiple.cross.regression_+3A_xx">xx</code></td>
<td>
<p>A list of <code class="reqn">n</code> time series, <em>e.g.</em>
xx &lt;- list(v1, v2, v3)</p>
</td></tr>
<tr><td><code id="local.multiple.cross.regression_+3A_m">M</code></td>
<td>
<p>length of the weight function or rolling window.</p>
</td></tr>
<tr><td><code id="local.multiple.cross.regression_+3A_window">window</code></td>
<td>
<p>type of weight function or rolling window.
Six types are allowed, namely
the uniform window,
Cleveland or tricube window,
Epanechnikov or parabolic window,
Bartlett or triangular window,
Wendland window and
the gaussian window.
The letter case and length of the argument are not relevant
as long as at least the first four characters are entered.</p>
</td></tr>
<tr><td><code id="local.multiple.cross.regression_+3A_lag.max">lag.max</code></td>
<td>
<p> maximum lag (and lead). If not set, it defaults to half the square root of the length of the original series.</p>
</td></tr>
<tr><td><code id="local.multiple.cross.regression_+3A_p">p</code></td>
<td>
<p>one minus the two-sided p-value for the confidence interval, <em>i.e.</em> the cdf value.</p>
</td></tr>
<tr><td><code id="local.multiple.cross.regression_+3A_ymaxr">ymaxr</code></td>
<td>
<p>index number of the variable whose correlation is calculated against a linear combination of the rest, otherwise at each wavelet level lmc chooses the one maximizing the multiple correlation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine calculates a set of  time series of  multiple cross-regressions, one per lag and lead) out of <code class="reqn">n</code> variables.
</p>


<h3>Value</h3>

<p>List of four elements:
</p>
<table>
<tr><td><code>cor:</code></td>
<td>
<p> List of three elements:</p>
</td></tr>
</table>

<ul>
<li><p>vals:  numeric matrix (rows = #observations, cols = #lags and leads) providing the point estimates for the local multiple cross-correlation.
</p>
</li>
<li><p>lower:  numeric vmatrix (rows = #observations, cols = #lags and leads) providing the lower bounds from the confidence interval.
</p>
</li>
<li><p>upper:  numeric matrix (rows = #observations, cols = #lags and leads) providing the upper bounds from the confidence interval.
</p>
</li></ul>

<table>
<tr><td><code>reg:</code></td>
<td>
<p> List of seven elements:</p>
</td></tr>
</table>

<ul>
<li><p>rval:  numeric array (1st_dim = #observations, 2nd_dim = #lags and leads, 3rd_dim = #regressors+1) of local regression estimates.
</p>
</li>
<li><p>rstd:  numeric array (1st_dim = #observations, 2nd_dim = #lags and leads, 3rd_dim = #regressors+1) of their standard deviations.
</p>
</li>
<li><p>rlow:  numeric array (1st_dim = #observations, 2nd_dim = #lags and leads, 3rd_dim = #regressors+1) of their lower bounds.
</p>
</li>
<li><p>rupp:  numeric array (1st_dim = #observations, 2nd_dim = #lags and leads, 3rd_dim = #regressors+1) of their upper bounds.
</p>
</li>
<li><p>rtst:  numeric array (1st_dim = #observations, 2nd_dim = #lags and leads, 3rd_dim = #regressors+1) of their t statistic values.
</p>
</li>
<li><p>rord:  numeric array (1st_dim = #observations, 2nd_dim = #lags and leads, 3rd_dim = #regressors+1) of their index order when sorted by significance.
</p>
</li>
<li><p>rpva:  numeric array (1st_dim = #observations, 2nd_dim = #lags and leads, 3rd_dim = #regressors+1) of their p values.
</p>
</li></ul>

<table>
<tr><td><code>YmaxR:</code></td>
<td>
<p> numeric matrix (rows = #observations, cols = #lags and leads) giving, at each value in time, the index number of the variable
whose correlation is calculated against a linear combination of the rest.
By default, <em>lmcr</em> chooses at each value in time the variable maximizing the multiple correlation.</p>
</td></tr>
<tr><td><code>data:</code></td>
<td>
<p> dataframe (rows = #observations, cols = #regressors) of original data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Based on Figure 4 showing correlation structural breaks in Fernandez-Macho (2018).

library(wavemulcor)
data(exchange)
returns &lt;- diff(log(as.matrix(exchange)))
returns &lt;- ts(returns, start=1970, freq=12)
N &lt;- dim(returns)[1]

M &lt;- 30
window &lt;- "gauss"
lmax &lt;- 1

demusd &lt;- returns[,"DEM.USD"]
jpyusd &lt;- returns[,"JPY.USD"]

set.seed(140859)

xrand &lt;- rnorm(N)

# ---------------------------

xx &lt;- data.frame(demusd, jpyusd, xrand)
##exchange.names &lt;- c(colnames(returns), "RAND")

Lst &lt;- local.multiple.cross.regression(xx, M, window=window, lag.max=lmax)

# ---------------------------

##Producing correlation plot

plot_local.multiple.cross.correlation(Lst, lmax) #, xaxt="s")

##Producing regression plot

plot_local.multiple.cross.regression(Lst, lmax) #, nsig=2, xaxt="s")

</code></pre>

<hr>
<h2 id='local.multiple.regression'>
Routine for local multiple regression
</h2><span id='topic+local.multiple.regression'></span><span id='topic+lmr'></span>

<h3>Description</h3>

<p>Produces an estimate of local multiple regressions
(as defined below) along with approximate confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>local.multiple.regression(xx, M, window="gauss", p=.975, ymaxr=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="local.multiple.regression_+3A_xx">xx</code></td>
<td>
<p>A list of <code class="reqn">n</code> time series, <em>e.g.</em>
xx &lt;- list(v1, v2, v3)</p>
</td></tr>
<tr><td><code id="local.multiple.regression_+3A_m">M</code></td>
<td>
<p>length of the weight function or rolling window.</p>
</td></tr>
<tr><td><code id="local.multiple.regression_+3A_window">window</code></td>
<td>
<p>type of weight function or rolling window.
Six types are allowed, namely
the uniform window,
Cleveland or tricube window,
Epanechnikov or parabolic window,
Bartlett or triangular window,
Wendland window and
the gaussian window.
The letter case and length of the argument are not relevant
as long as at least the first four characters are entered.</p>
</td></tr>
<tr><td><code id="local.multiple.regression_+3A_p">p</code></td>
<td>
<p>one minus the two-sided p-value for the confidence interval, <em>i.e.</em> the cdf value.</p>
</td></tr>
<tr><td><code id="local.multiple.regression_+3A_ymaxr">ymaxr</code></td>
<td>
<p>index number of the variable whose correlation is calculated against a linear combination
of the rest, otherwise at each wavelet level lmc chooses the one maximizing the multiple correlation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine calculates a set of time series of multiple regression coefficients out of <code class="reqn">n</code> variables.
</p>


<h3>Value</h3>

<p>List of four elements:
</p>
<table>
<tr><td><code>cor:</code></td>
<td>
<p> List of three elements:</p>
</td></tr>
</table>

<ul>
<li><p>val:  numeric vector (rows = #observations) of point estimates for the local multiple correlation.
</p>
</li>
<li><p>lo:  numeric vector (rows = #observations) of lower bounds of the confidence interval.
</p>
</li>
<li><p>up:  numeric vector (rows = #observations) of upper bounds of the confidence interval.
</p>
</li></ul>

<table>
<tr><td><code>reg:</code></td>
<td>
<p> List of seven elements:</p>
</td></tr>
</table>

<ul>
<li><p>rval:  numeric matrix (rows = #observations, cols = #regressors+1) of local regression estimates.
</p>
</li>
<li><p>rstd:  numeric matrix (rows = #observations, cols = #regressors+1) of their standard deviations.
</p>
</li>
<li><p>rlow:  numeric matrix (rows = #observations, cols = #regressors+1) of their lower bounds.
</p>
</li>
<li><p>rupp:  numeric matrix (rows = #observations, cols = #regressors+1) of their upper bounds.
</p>
</li>
<li><p>rtst:  numeric matrix (rows = #observations, cols = #regressors+1) of their t statistic values.
</p>
</li>
<li><p>rord:  numeric matrix (rows = #observations, cols = #regressors+1) of their index order when sorted by significance.
</p>
</li>
<li><p>rpva:  numeric matrix (rows = #observations, cols = #regressors+1) of their p values.
</p>
</li></ul>

<table>
<tr><td><code>YmaxR:</code></td>
<td>
<p> numeric vector (rows = #observations) giving, at each value in time, the index number of the variable
whose correlation is calculated against a linear combination of the rest.
By default, <em>lmr</em> chooses at each value in time the variable maximizing the multiple correlation.</p>
</td></tr>
<tr><td><code>data:</code></td>
<td>
<p> dataframe (rows = #observations, cols = #regressors) of original data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Based on  Figure 4 showing correlation structural breaks in Fernandez-Macho (2018).

library(wavemulcor)
options(warn = -1)

xrand1 &lt;- wavemulcor::xrand1
xrand2 &lt;- wavemulcor::xrand2
N &lt;- length(xrand1)
b &lt;- trunc(N/3)
t1 &lt;- 1:b
t2 &lt;- (b+1):(2*b)
t3 &lt;- (2*b+1):N

wf &lt;- "d4"
M &lt;- N/2^3 #sharper with N/2^4
window &lt;- "gaussian"

J &lt;- trunc(log2(N))-3

# ---------------------------

cor1 &lt;- cor(xrand1[t1],xrand2[t1])
cor2 &lt;- cor(xrand1[t2],xrand2[t2])
cor3 &lt;- cor(xrand1[t3],xrand2[t3])
cortext &lt;- paste0(round(100*cor1,0),"-",round(100*cor2,0),"-",round(100*cor3,0))

ts.plot(cbind(xrand1,xrand2),col=c("red","blue"),xlab="time")

xx &lt;- data.frame(xrand1,xrand2)

# ---------------------------

Lst &lt;- local.multiple.regression(xx, M, window=window) #, ymax=1)

# ---------------------------

##Producing correlation plot
plot_local.multiple.correlation(Lst)

##Producing regression plot
plot_local.multiple.regression(Lst)

</code></pre>

<hr>
<h2 id='plot_local.multiple.correlation'>
Auxiliary routine for plotting local multiple correlations
</h2><span id='topic+plot_local.multiple.correlation'></span><span id='topic+plot_lmc'></span>

<h3>Description</h3>

<p>Produces a plot of local multiple correlations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_local.multiple.correlation(Lst, xaxt="s")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_local.multiple.correlation_+3A_lst">Lst</code></td>
<td>
<p>A list from local.multiple.regression or local.multiple.correlation.</p>
</td></tr>
<tr><td><code id="plot_local.multiple.correlation_+3A_xaxt">xaxt</code></td>
<td>
<p>An optional vector of labels for the &quot;x&quot; axis. Default is 1:n.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine produces a time series plot of local multiple correlations with its confidence interval.
Also, at every upturn and downturn, the name of the variable that maximizes its multiple correlation against the rest is shown.
Note that the routine is optimize for <em>local.multiple.regression</em>.
If you want to use output from the legacy <em>local.multiple.correlation</em> function then you must create an empty list and put that output into a list element named <em>cor</em> like this:
Lst &lt;- list();
Lst$cor &lt;- local.multiple.cross.correlation(xx, M, window=window, lag.max=lmax);
Lst$YmaxR &lt;- Lst2$cor$YmaxR;
Lst$cor$YmaxR &lt;- NULL.
</p>


<h3>Value</h3>

<p>Plot.</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>

<hr>
<h2 id='plot_local.multiple.cross.correlation'>
Auxiliary routine for plotting local multiple cross-correlations
</h2><span id='topic+plot_local.multiple.cross.correlation'></span><span id='topic+plot_lmcc'></span>

<h3>Description</h3>

<p>Produces a plot of local multiple cross-correlations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_local.multiple.cross.correlation(Lst, lmax, xaxt="s")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_local.multiple.cross.correlation_+3A_lst">Lst</code></td>
<td>
<p>A list from local.multiple.cross.regression or local.multiple.cross.correlation.</p>
</td></tr>
<tr><td><code id="plot_local.multiple.cross.correlation_+3A_lmax">lmax</code></td>
<td>
<p> maximum lag (and lead). </p>
</td></tr>
<tr><td><code id="plot_local.multiple.cross.correlation_+3A_xaxt">xaxt</code></td>
<td>
<p>An optional vector of labels for the &quot;x&quot; axis. Default is 1:n.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine produces a set of time series plots of local multiple cross-correlations, one per lag and lead, each with its confidence interval.
Also, at every upturn and downturn, the name of the variable that maximizes its multiple correlation against the rest is shown.
Note that the routine is optimize for <em>local.multiple.cross.regression</em>.
If you want to use output from <em>local.multiple.cross.correlation</em> function then you must create an empty list and put that output into a list element named <em>cor</em> like this:
Lst &lt;- list();
Lst$cor &lt;- local.multiple.cross.correlation(xx, M, window=window, lag.max=lmax);
Lst$YmaxR &lt;- Lst2$cor$YmaxR;
Lst$cor$YmaxR &lt;- NULL.
</p>


<h3>Value</h3>

<p>Plot.</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>

<hr>
<h2 id='plot_local.multiple.cross.regression'>
Auxiliary routine for plotting local multiple cross-regressions
</h2><span id='topic+plot_local.multiple.cross.regression'></span><span id='topic+plot_lmcr'></span>

<h3>Description</h3>

<p>Produces a plot of local multiple cross-regressions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_local.multiple.cross.regression(Lst, lmax, nsig=2, xaxt="s")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_local.multiple.cross.regression_+3A_lst">Lst</code></td>
<td>
<p>A list from local.multiple.cross.regression.</p>
</td></tr>
<tr><td><code id="plot_local.multiple.cross.regression_+3A_lmax">lmax</code></td>
<td>
<p> maximum lag (and lead). </p>
</td></tr>
<tr><td><code id="plot_local.multiple.cross.regression_+3A_nsig">nsig</code></td>
<td>
<p>An optional value for the number of significant variables to plot_ Default is 2.</p>
</td></tr>
<tr><td><code id="plot_local.multiple.cross.regression_+3A_xaxt">xaxt</code></td>
<td>
<p>An optional vector of labels for the &quot;x&quot; axis. Default is 1:n.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine produces time series plots of local multiple cross-regressions
with their confidence interval for every lag and lead.
Also, at every upturn and downturn of the corresponding local multiple cross-correlation,
the name of the variable that maximizes that multiple correlation against the rest is shown on top.
The others are named ordered by significance when they are relevant.</p>


<h3>Value</h3>

<p>Plot.</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>

<hr>
<h2 id='plot_local.multiple.regression'>
Auxiliary routine for plotting local multiple regressions
</h2><span id='topic+plot_local.multiple.regression'></span><span id='topic+plot_lmr'></span>

<h3>Description</h3>

<p>Produces a plot of local multiple regressions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_local.multiple.regression(Lst, nsig=2, xaxt="s")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_local.multiple.regression_+3A_lst">Lst</code></td>
<td>
<p>A list from local.multiple.regression.</p>
</td></tr>
<tr><td><code id="plot_local.multiple.regression_+3A_nsig">nsig</code></td>
<td>
<p>An optional value for the number of significant variables to plot_ Default is 2.</p>
</td></tr>
<tr><td><code id="plot_local.multiple.regression_+3A_xaxt">xaxt</code></td>
<td>
<p>An optional vector of labels for the &quot;x&quot; axis. Default is 1:n.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine produces a time series plot of local multiple regressions
with its confidence interval.
Also, at every upturn and downturn of the corresponding local multiple correlation,
the name of the variable that maximizes that multiple correlation against the rest is shown on top.
The others are named ordered by significance when they are relevant.</p>


<h3>Value</h3>

<p>Plot.</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>

<hr>
<h2 id='plot_wave.local.multiple.correlation'>
Auxiliary routine for plotting wave local multiple correlations
</h2><span id='topic+plot_wave.local.multiple.correlation'></span><span id='topic+plot_wlmc'></span>

<h3>Description</h3>

<p>Produces a plot of wave local multiple correlations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_wave.local.multiple.correlation(Lst, xaxt="s")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_wave.local.multiple.correlation_+3A_lst">Lst</code></td>
<td>
<p>A list from local.multiple.regression.</p>
</td></tr>
<tr><td><code id="plot_wave.local.multiple.correlation_+3A_xaxt">xaxt</code></td>
<td>
<p>An optional vector of labels for the &quot;x&quot; axis. Default is 1:n.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine produces time series plots of wave local multiple correlations with their confidence intervals.
Also, at every upturn and downturn, the name of the variable that maximizes its multiple correlation against the rest is shown.</p>


<h3>Value</h3>

<p>Plot.</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>

<hr>
<h2 id='plot_wave.local.multiple.cross.correlation'>
Auxiliary routine for plotting wave local multiple cross-correlations
</h2><span id='topic+plot_wave.local.multiple.cross.correlation'></span><span id='topic+plot_wlmcc'></span>

<h3>Description</h3>

<p>Produces a plot of wave local multiple cross-correlations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_wave.local.multiple.cross.correlation(Lst, lmax,
     lag.first=FALSE, xaxt="s", pdf.write=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_wave.local.multiple.cross.correlation_+3A_lst">Lst</code></td>
<td>
<p>A list from local.multiple.cross.regression.</p>
</td></tr>
<tr><td><code id="plot_wave.local.multiple.cross.correlation_+3A_lmax">lmax</code></td>
<td>
<p> maximum lag (and lead). </p>
</td></tr>
<tr><td><code id="plot_wave.local.multiple.cross.correlation_+3A_lag.first">lag.first</code></td>
<td>
<p> if TRUE, it produces lag-lead pages with <code class="reqn">J+1</code> wavelet plots each.
Otherwise (default) it gives wavelet pages with <code class="reqn">2*lmax+1</code> lag-lead plots each. </p>
</td></tr>
<tr><td><code id="plot_wave.local.multiple.cross.correlation_+3A_xaxt">xaxt</code></td>
<td>
<p>An optional vector of labels for the &quot;x&quot; axis. Default is 1:n.</p>
</td></tr>
<tr><td><code id="plot_wave.local.multiple.cross.correlation_+3A_pdf.write">pdf.write</code></td>
<td>
<p> Optional name leader to save files to pdf format.
The actual filename of each page is either
&quot;plot_&lt;pdf.write&gt;_WLMCC_&lt;i&gt;.pdf&quot;,  where &quot;i&quot; is the lag/lead <code class="reqn">i=-lmax...+lmax</code>, or,
&quot;plot_&lt;pdf.write&gt;_WLMCC_&lt;j&gt;.pdf&quot;, where &quot;j&quot; is the wavelet level <code class="reqn">j=1...(J+1)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine produces time series plots of wave local multiple cross-correlations with
their confidence intervals.
Also, at every upturn and downturn, the name of the variable that maximizes its
multiple cross-correlation against the rest is shown.</p>


<h3>Value</h3>

<p>Plot.</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>

<hr>
<h2 id='plot_wave.local.multiple.cross.regression'>
Auxiliary routine for plotting wave local multiple cross-regressions
</h2><span id='topic+plot_wave.local.multiple.cross.regression'></span><span id='topic+plot_wlmcr'></span>

<h3>Description</h3>

<p>Produces a set of plots of wave local multiple cross-regressions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_wave.local.multiple.cross.regression(Lst, lmax, nsig=2, 
     xaxt="s", pdf.write=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_wave.local.multiple.cross.regression_+3A_lst">Lst</code></td>
<td>
<p>A list from wave.multiplecross.regression.</p>
</td></tr>
<tr><td><code id="plot_wave.local.multiple.cross.regression_+3A_lmax">lmax</code></td>
<td>
<p> maximum lag (and lead). </p>
</td></tr>
<tr><td><code id="plot_wave.local.multiple.cross.regression_+3A_nsig">nsig</code></td>
<td>
<p> An optional value for the number of significant variables to plot_ Default is 2.</p>
</td></tr>
<tr><td><code id="plot_wave.local.multiple.cross.regression_+3A_xaxt">xaxt</code></td>
<td>
<p> An optional vector of labels for the &quot;x&quot; axis. Default is 1:n.</p>
</td></tr>
<tr><td><code id="plot_wave.local.multiple.cross.regression_+3A_pdf.write">pdf.write</code></td>
<td>
<p> Optional name leader to save files to pdf format.
The actual filename of each page  
&quot;plot_&lt;pdf.write&gt;_WLMCC_&lt;j&gt;.pdf&quot;, where &quot;j&quot; is the wavelet level <code class="reqn">j=1...(J+1)</code>.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The routine produces <code class="reqn">J+1</code> pages, one per wavelet level, each with time series plots of wave multiple cross-regressions at different lags and leads, each with their confidence interval.
Also, the name of the variable that maximizes that multiple correlation against the rest is shown on top. 
The others are named with their order of significance when they are relevant.</p>


<h3>Value</h3>

<p>Plot.</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>

<hr>
<h2 id='plot_wave.local.multiple.regression'>
Auxiliary routine for plotting wave local multiple regressions
</h2><span id='topic+plot_wave.local.multiple.regression'></span><span id='topic+plot_wlmr'></span>

<h3>Description</h3>

<p>Produces a set of plots of wave local multiple regressions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_wave.local.multiple.regression(Lst,nsig=2, xaxt="s")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_wave.local.multiple.regression_+3A_lst">Lst</code></td>
<td>
<p>A list from wave.multiple.regression.</p>
</td></tr>
<tr><td><code id="plot_wave.local.multiple.regression_+3A_nsig">nsig</code></td>
<td>
<p>An optional value for the number of significant variables to plot_ Default is 2.</p>
</td></tr>
<tr><td><code id="plot_wave.local.multiple.regression_+3A_xaxt">xaxt</code></td>
<td>
<p>An optional vector of labels for the &quot;x&quot; axis. Default is 1:n.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine produces <code class="reqn">J+1</code> time series plots of wave multiple regressions, each with their confidence interval.
Also, the name of the variable that maximizes that multiple correlation against the rest is shown on top. 
The others are named with their order of significance when they are relevant.</p>


<h3>Value</h3>

<p>Plot.</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>

<hr>
<h2 id='plot_wave.multiple.correlation'>
Auxiliary routine for plotting wave multiple correlations
</h2><span id='topic+plot_wave.multiple.correlation'></span><span id='topic+plot_wmc'></span>

<h3>Description</h3>

<p>Produces a plot of wave multiple correlations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_wave.multiple.correlation(Lst)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_wave.multiple.correlation_+3A_lst">Lst</code></td>
<td>
<p>A list from wave.multiple.regression or wave.multiple.correlation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine produces a plot of wave multiple correlations, at each wavelet level, with its confidence interval.
Also, at each wavelet level, the name of the variable that maximizes its multiple correlation against the rest is shown.</p>


<h3>Value</h3>

<p>Plot.</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2012. Wavelet multiple correlation and cross-correlation: A multiscale analysis of Eurozone stock markets. Physica A: Statistical Mechanics and its Applications 391, 1097&ndash;1104. &lt;DOI:10.1016/j.physa.2011.11.002&gt;
</p>

<hr>
<h2 id='plot_wave.multiple.cross.correlation'>
Auxiliary routine for plotting wave multiple cross-correlations
</h2><span id='topic+plot_wave.multiple.cross.correlation'></span><span id='topic+plot_wmcc'></span>

<h3>Description</h3>

<p>Produces a plot of wave multiple cross-correlations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_wave.multiple.cross.correlation(Lst, lmax, by=3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_wave.multiple.cross.correlation_+3A_lst">Lst</code></td>
<td>
<p>A list from wave.multiple.cross.regression or wave.multiple.cross.correlation.</p>
</td></tr>
<tr><td><code id="plot_wave.multiple.cross.correlation_+3A_lmax">lmax</code></td>
<td>
<p> maximum lag (and lead). </p>
</td></tr>
<tr><td><code id="plot_wave.multiple.cross.correlation_+3A_by">by</code></td>
<td>
<p> labels are printed every lmax/by. Default is 3. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine produces a set of plots of wave multiple cross-correlations, one per wavelet level, 
with their confidence intervals.
Also, at each wavelet level, the name of the variable that maximizes its multiple 
cross-correlation against the rest is shown.</p>


<h3>Value</h3>

<p>Plot.</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2012. Wavelet multiple correlation and cross-correlation: A multiscale analysis of Eurozone stock markets. Physica A: Statistical Mechanics and its Applications 391, 1097&ndash;1104. &lt;DOI:10.1016/j.physa.2011.11.002&gt;
</p>

<hr>
<h2 id='plot_wave.multiple.cross.regression'>
Auxiliary routine for plotting wave multiple cross-regressions
</h2><span id='topic+plot_wave.multiple.cross.regression'></span><span id='topic+plot_wmcr'></span>

<h3>Description</h3>

<p>Produces a plot of wave multiple cross.regressions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_wave.multiple.cross.regression(Lst, lmax, nsig=2, by=3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_wave.multiple.cross.regression_+3A_lst">Lst</code></td>
<td>
<p>A list from wave.multiple.cross.regression.</p>
</td></tr>
<tr><td><code id="plot_wave.multiple.cross.regression_+3A_lmax">lmax</code></td>
<td>
<p> maximum lag (and lead). </p>
</td></tr>
<tr><td><code id="plot_wave.multiple.cross.regression_+3A_nsig">nsig</code></td>
<td>
<p>An optional value for the number of significant variables to plot_ Default is 2.</p>
</td></tr>
<tr><td><code id="plot_wave.multiple.cross.regression_+3A_by">by</code></td>
<td>
<p> labels are printed every lmax/by. Default is 3. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine produces a plot of wave multiple regressions, one per wavelet level, 
with their confidence intervals.
Also, the name of the variable that maximizes that multiple correlation against the rest is shown on top. 
The others are named with their order of significance when they are relevant.</p>


<h3>Value</h3>

<p>Plot.</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>

<hr>
<h2 id='plot_wave.multiple.regression'>
Auxiliary routine for plotting wave multiple regressions
</h2><span id='topic+plot_wave.multiple.regression'></span><span id='topic+plot_wmr'></span>

<h3>Description</h3>

<p>Produces a plot of wave multiple regressions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_wave.multiple.regression(Lst, nsig=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_wave.multiple.regression_+3A_lst">Lst</code></td>
<td>
<p>A list from wave.multiple.regression.</p>
</td></tr>
<tr><td><code id="plot_wave.multiple.regression_+3A_nsig">nsig</code></td>
<td>
<p>An optional value for the number of significant variables to plot_ Default is 2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine produces a plot of wave multiple regressions with their confidence interval.
Also, the name of the variable that maximizes that multiple correlation against the rest is shown on top. 
The others are named with their order of significance when they are relevant.</p>


<h3>Value</h3>

<p>Plot.</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>

<hr>
<h2 id='wave.local.multiple.correlation'>
Wavelet routine for local multiple correlation
</h2><span id='topic+wave.local.multiple.correlation'></span><span id='topic+wlmc'></span>

<h3>Description</h3>

<p>Produces an estimate of the multiscale local multiple correlation
(as defined below) along with approximate confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wave.local.multiple.correlation(xx, M, window="gauss", p = .975, ymaxr=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wave.local.multiple.correlation_+3A_xx">xx</code></td>
<td>
<p>A list of <code class="reqn">n</code> (multiscaled) time series, usually the outcomes of dwt or modwt, <em>i.e.</em>
xx &lt;- list(v1.modwt.bw, v2.modwt.bw, v3.modwt.bw)</p>
</td></tr>
<tr><td><code id="wave.local.multiple.correlation_+3A_m">M</code></td>
<td>
<p>length of the weight function or rolling window.</p>
</td></tr>
<tr><td><code id="wave.local.multiple.correlation_+3A_window">window</code></td>
<td>
<p>type of weight function or rolling window.
Six types are allowed, namely
the uniform window,
Cleveland or tricube window,
Epanechnikov or parabolic window,
Bartlett or triangular window,
Wendland window and
the gaussian window.
The letter case and length of the argument are not relevant
as long as at least the first four characters are entered.</p>
</td></tr>
<tr><td><code id="wave.local.multiple.correlation_+3A_p">p</code></td>
<td>
<p>one minus the two-sided p-value for the confidence interval, <em>i.e.</em> the cdf value.</p>
</td></tr>
<tr><td><code id="wave.local.multiple.correlation_+3A_ymaxr">ymaxr</code></td>
<td>
<p>index number of the variable whose correlation is calculated against a linear combination
of the rest, otherwise at each wavelet level wlmc chooses the one maximizing the multiple correlation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine calculates one single set of wavelet multiple correlations out of <code class="reqn">n</code> variables
that can be plotted in in either single heatmap or <code class="reqn">J</code> line graphs (the former is usually the best graphic option but the latter is useful if confidence intervals are explicitly needed),
as an alternative to trying to make sense out of <code class="reqn">n(n-1)/2</code>  <code class="reqn">[J \times T]</code> sets of local wavelet correlations.
The code is based on the calculation, at each wavelet scale, of the square root of the coefficient of
determination in that linear combination of locally weighted wavelet coefficients for which such coefficient of determination is a maximum.
The code provided here is based on the wave.multiple.correlation routine in this package
which in turn is based on the wave.correlation routine in Brandon Whitcher's <em>waveslim</em> <span class="rlang"><b>R</b></span> package Version: 1.6.4, which in turn is based on wavelet methodology
developed in Percival and Walden (2000); Gençay, Selçuk and Whitcher (2001) and others.
</p>


<h3>Value</h3>

<p>List of four elements:
</p>
<table>
<tr><td><code>val:</code></td>
<td>
<p> numeric matrix (rows = #observations, columns = #levels in the wavelet transform object)
providing the point estimates for the wavelet local multiple correlation.</p>
</td></tr>
<tr><td><code>lo:</code></td>
<td>
<p> numeric matrix (rows = #observations, columns = #levels in the wavelet transform object)
providing the lower bounds from the confidence interval.</p>
</td></tr>
<tr><td><code>up:</code></td>
<td>
<p> numeric matrix (rows = #observations, columns = #levels in the wavelet transform object)
providing the upper bounds from the confidence interval.</p>
</td></tr>
<tr><td><code>YmaxR:</code></td>
<td>
<p> numeric matrix (rows = #observations, columns = #levels in the wavelet transform object)
giving, at each wavelet level and time, the index number of the variable whose correlation is calculated against
a linear combination of the rest.
By default, <em>wlmc</em> chooses at each wavelet level and value in time the variable maximizing the multiple correlation.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Needs <em>waveslim</em> package to calculate <em>dwt</em> or <em>modwt</em> coefficients as inputs to the routine (also for data in the example).
</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Based on  Figure 4 showing correlation structural breaks in Fernandez-Macho (2018).

library(wavemulcor)
options(warn = -1)

data(xrand)
N &lt;- length(xrand1)
b &lt;- trunc(N/3)
t1 &lt;- 1:b
t2 &lt;- (b+1):(2*b)
t3 &lt;- (2*b+1):N

wf &lt;- "d4"
M &lt;- N/2^3 #sharper with N/2^4
window &lt;- "gauss"
J &lt;- 3 #trunc(log2(N))-3

# ---------------------------

cor1 &lt;- cor(xrand1[t1],xrand2[t1])
cor2 &lt;- cor(xrand1[t2],xrand2[t2])
cor3 &lt;- cor(xrand1[t3],xrand2[t3])
cortext &lt;- paste0(round(100*cor1,0),"-",round(100*cor2,0),"-",round(100*cor3,0))

ts.plot(cbind(xrand1,xrand2),col=c("red","blue"),xlab="time")

xrand1.modwt &lt;- modwt(xrand1, wf, J)
xrand1.modwt.bw &lt;- brick.wall(xrand1.modwt, wf)

xrand2.modwt &lt;- modwt(xrand2, wf, J)
xrand2.modwt.bw &lt;- brick.wall(xrand2.modwt, wf)

xx &lt;- list(xrand1.modwt.bw,xrand2.modwt.bw)

# ---------------------------

xy.mulcor &lt;- wave.local.multiple.correlation(xx, M, window=window)

val &lt;- as.matrix(xy.mulcor$val)
lo  &lt;- as.matrix(xy.mulcor$lo)
up  &lt;- as.matrix(xy.mulcor$up)
YmaxR &lt;- as.matrix(xy.mulcor$YmaxR)

# ---------------------------

old.par &lt;- par()

# ##Producing heat plot

scale.names &lt;- paste0("(",c("2-4","4-8","8-16","16-32","32-64","64-128","128-256","256-512",
                            "512-1024","1024-2048"),"]")
scale.names &lt;- c(scale.names[1:J],"smooth")

title &lt;- paste("Wavelet Local Multiple Correlation")
sub &lt;- paste("first",b,"obs:",round(100*cor1,1),"% correlation;","middle",b,"obs:",
             round(100*cor2,1),"%","rest:",round(100*cor3,1),"%")
xlab &lt;- "time"
ylab &lt;- "periods"

plot3D::image2D(z=val, x=1:nrow(val), y=1:ncol(val),
        main=title, #sub=sub,
        xlab=xlab, ylab=ylab, axes=FALSE, clab = expression(varphi),
        rasterImage = TRUE, contour = list(lwd = 2, col = plot3D::jet.col(11)))
axis(side=1, at=seq(10,nrow(val),by=10), cex.axis=0.75)
axis(side=2, at=1:ncol(val),labels=scale.names, las=1,cex.axis=0.75)

# ---------------------------

##Producing line plots with confidence intervals

colnames(val)[1:J] &lt;- paste0("level",1:J)
par(mfrow=c(3,2), las=1, pty="m", mar=c(2,3,1,0)+.1, oma=c(1.2,1.2,0,0))
for(i in J:1) {
  matplot(1:N,val[,i], type="l", lty=1, ylim=c(-1,1), xaxt="n",
          xlab="", ylab="", main=colnames(val)[i])
  if(i&lt;3) {axis(side=1, at=seq(10,N,by=10))}
  #axis(side=2, at=c(-.2, 0, .5, 1))
  lines(lo[,i], lty=1, col=2) ##Add Connected Line Segments to a Plot
  lines(up[,i], lty=1, col=2)
  abline(h=0)              ##Add Straight horiz and vert Lines to a Plot
}
par(las=0)
mtext('time', side=1, outer=TRUE, adj=0.5)
mtext('Wavelet Local Multiple Correlation', side=2, outer=TRUE, adj=0.5)

#reset graphics parameters
par(old.par)

</code></pre>

<hr>
<h2 id='wave.local.multiple.cross.correlation'>
Wavelet routine for local multiple cross-correlation
</h2><span id='topic+wave.local.multiple.cross.correlation'></span><span id='topic+wlmcc'></span>

<h3>Description</h3>

<p>Produces an estimate of the multiscale local multiple cross-correlation
(as defined below) along with approximate confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wave.local.multiple.cross.correlation(xx, M,
     window="gauss", lag.max=NULL, p=.975, ymaxr=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wave.local.multiple.cross.correlation_+3A_xx">xx</code></td>
<td>
<p>A list of <code class="reqn">n</code> (multiscaled) time series, usually the outcomes of dwt or modwt, <em>i.e.</em>
xx &lt;- list(v1.modwt.bw, v2.modwt.bw, v3.modwt.bw)</p>
</td></tr>
<tr><td><code id="wave.local.multiple.cross.correlation_+3A_m">M</code></td>
<td>
<p>length of the weight function or rolling window.</p>
</td></tr>
<tr><td><code id="wave.local.multiple.cross.correlation_+3A_window">window</code></td>
<td>
<p>type of weight function or rolling window.
Six types are allowed, namely
the uniform window,
Cleveland or tricube window,
Epanechnikov or parabolic window,
Bartlett or triangular window,
Wendland window and
the gaussian window.
The letter case and length of the argument are not relevant
as long as at least the first four characters are entered.</p>
</td></tr>
<tr><td><code id="wave.local.multiple.cross.correlation_+3A_lag.max">lag.max</code></td>
<td>

<p>maximum lag (and lead). If not set, it defaults to half the square root of the length of the
original series.</p>
</td></tr>
<tr><td><code id="wave.local.multiple.cross.correlation_+3A_p">p</code></td>
<td>
<p>one minus the two-sided p-value for the confidence interval, <em>i.e.</em> the cdf value.</p>
</td></tr>
<tr><td><code id="wave.local.multiple.cross.correlation_+3A_ymaxr">ymaxr</code></td>
<td>
<p>index number of the variable whose correlation is calculated against a linear combination
of the rest, otherwise at each wavelet level wlmc chooses the one maximizing the multiple correlation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine calculates <code class="reqn">J+1</code> sets of wavelet multiple cross-correlations,one per wavelet level, out of <code class="reqn">n</code> variables, that can be plotted each as lags and leads time series plots.</p>


<h3>Value</h3>

<p>List of four elements:
</p>
<table>
<tr><td><code>val:</code></td>
<td>
<p> list of <code class="reqn">J+1</code> dataframes, each (rows = #observations, columns = #levels)
providing the point estimates for the wavelet local multiple correlation.</p>
</td></tr>
<tr><td><code>lo:</code></td>
<td>
<p> list of <code class="reqn">J+1</code> dataframes, each (rows = #observations, columns = #lags and leads) providing the lower bounds from the confidence interval.</p>
</td></tr>
<tr><td><code>up:</code></td>
<td>
<p> list of <code class="reqn">J+1</code> dataframes, each (rows = #observations, columns = #lags and leads) providing the upper bounds from the confidence interval.</p>
</td></tr>
<tr><td><code>YmaxR:</code></td>
<td>
<p> numeric matrix (rows = #observations, columns = #levels) giving, at each wavelet level and time, the index number of the variable whose correlation is calculated against
a linear combination of the rest.
By default, <em>wlmc</em> chooses at each wavelet level and value in time the variable maximizing the multiple correlation.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Needs <em>waveslim</em> package to calculate <em>dwt</em> or <em>modwt</em> coefficients as inputs to the routine (also for data in the example).
</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Based on data from Figure 7.9 in Gencay, Selcuk and Whitcher (2001)
## plus one random series.


library(wavemulcor)

data(exchange)
returns &lt;- diff(log(exchange))
returns &lt;- ts(returns, start=1970, freq=12)
N &lt;- dim(returns)[1]
wf &lt;- "d4"
M &lt;- 30
window &lt;- "gauss"
J &lt;- 3 #trunc(log2(N))-3
lmax &lt;- 2

set.seed(140859)

demusd.modwt &lt;- brick.wall(modwt(returns[,"DEM.USD"], wf, J), wf)
jpyusd.modwt &lt;- brick.wall(modwt(returns[,"JPY.USD"], wf, J), wf)
rand.modwt   &lt;- brick.wall(modwt(rnorm(length(returns[,"DEM.USD"])), wf, J), wf)

##xx &lt;- list(demusd.modwt.bw, jpyusd.modwt.bw)
xx &lt;- list(demusd.modwt, jpyusd.modwt, rand.modwt)
names(xx) &lt;- c("DEM.USD","JPY.USD","rand")

## Not run: 
# Note: WLMCC may take more than 10 seconds of CPU time on some systems

Lst &lt;- wave.local.multiple.cross.correlation(xx, M, window=window, lag.max=lmax)
val &lt;- Lst$val
low.ci &lt;- Lst$lo
upp.ci &lt;- Lst$up
YmaxR &lt;- Lst$YmaxR

# ---------------------------

##Producing cross-correlation plot

xvar &lt;- seq(1,N,M)
level.lab &lt;- c(paste("Level",1:J),paste("Smooth",J))
ymin &lt;- -0.1
if (length(xx)&lt;3) ymin &lt;- -1
for(j in 1:(J+1)) {
  par(mfcol=c(lmax+1,2), las=1, pty="m", mar=c(2,3,1,0)+.1, oma=c(1.2,1.2,1.2,0))
  # xaxt &lt;- c(rep("n",lmax),"s",rep("n",lmax))
  for(i in c(-lmax:0,lmax:1)+lmax+1) {
    matplot(1:N,val[[j]][,i], type="l", lty=1, ylim=c(ymin,1), #xaxt=xaxt[i],
            xlab="", ylab="", main=paste("Lag",i-lmax-1))
    abline(h=0)              ##Add Straight horiz
    lines(low.ci[[j]][,i], lty=1, col=2) ##Add Connected Line Segments to a Plot
    lines(upp.ci[[j]][,i], lty=1, col=2)
    text(xvar,1, labels=names(xx)[YmaxR[[j]]][xvar], adj=0.25, cex=.8)
  }
  par(las=0)
  mtext('time', side=1, outer=TRUE, adj=0.5)
  mtext('Local Multiple Cross-Correlation', side=2, outer=TRUE, adj=0.5)
  mtext(level.lab[j], side=3, outer=TRUE, adj=0.5)
}


## End(Not run)
</code></pre>

<hr>
<h2 id='wave.local.multiple.cross.regression'>
Wavelet routine for local multiple cross-regression
</h2><span id='topic+wave.local.multiple.cross.regression'></span><span id='topic+wlmcr'></span>

<h3>Description</h3>

<p>Produces an estimate of the multiscale local multiple cross-regression
(as defined below) along with approximate confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wave.local.multiple.cross.regression(xx, M,
     window="gauss", lag.max=NULL, p=.975, ymaxr=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wave.local.multiple.cross.regression_+3A_xx">xx</code></td>
<td>
<p>A list of <code class="reqn">n</code> (multiscaled) time series, usually the outcomes of dwt or modwt, <em>i.e.</em>
xx &lt;- list(v1.modwt.bw, v2.modwt.bw, v3.modwt.bw)</p>
</td></tr>
<tr><td><code id="wave.local.multiple.cross.regression_+3A_m">M</code></td>
<td>
<p>length of the weight function or rolling window.</p>
</td></tr>
<tr><td><code id="wave.local.multiple.cross.regression_+3A_window">window</code></td>
<td>
<p>type of weight function or rolling window.
Six types are allowed, namely
the uniform window,
Cleveland or tricube window,
Epanechnikov or parabolic window,
Bartlett or triangular window,
Wendland window and
the gaussian window.
The letter case and length of the argument are not relevant
as long as at least the first four characters are entered.</p>
</td></tr>
<tr><td><code id="wave.local.multiple.cross.regression_+3A_lag.max">lag.max</code></td>
<td>

<p>maximum lag (and lead). If not set, it defaults to half the square root of the length of the
original series.</p>
</td></tr>
<tr><td><code id="wave.local.multiple.cross.regression_+3A_p">p</code></td>
<td>
<p>one minus the two-sided p-value for the confidence interval, <em>i.e.</em> the cdf value.</p>
</td></tr>
<tr><td><code id="wave.local.multiple.cross.regression_+3A_ymaxr">ymaxr</code></td>
<td>
<p>index number of the variable whose correlation is calculated against a linear combination
of the rest, otherwise at each wavelet level wlmc chooses the one maximizing the multiple correlation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine calculates <code class="reqn">J+1</code> sets of wavelet multiple cross-regressions, one per wavelet level, out of <code class="reqn">n</code> variables, that can be plotted each as lags and leads time series plots.</p>


<h3>Value</h3>

<p>List of four elements:
</p>
<table>
<tr><td><code>cor:</code></td>
<td>
<p> List of three elements:</p>
</td></tr>
</table>

<ul>
<li><p>val:  list of <code class="reqn">J+1</code> dataframes, each (rows = #observations, columns = #levels)
providing the point estimates for the wavelet local multiple correlation.
</p>
</li>
<li><p>lo:  list of <code class="reqn">J+1</code> dataframes, each (rows = #observations, columns = #lags and leads) providing the lower bounds from the confidence interval.
</p>
</li>
<li><p>up:  list of <code class="reqn">J+1</code> dataframes, each (rows = #observations, columns = #lags and leads) providing the upper bounds from the confidence interval.
</p>
</li></ul>

<table>
<tr><td><code>reg:</code></td>
<td>
<p> List of <code class="reqn">J+1</code> elements, one per wavelet level, each with:</p>
</td></tr>
</table>

<ul>
<li><p>rval:  numeric array (1st_dim = #observations, 2nd-dim = #lags and leads, 3rd_dim = #regressors+1) of local regression estimates.
</p>
</li>
<li><p>rstd:  numeric array (1st_dim = #observations, 2nd-dim = #lags and leads, 3rd_dim = #regressors+1) of their standard deviations.
</p>
</li>
<li><p>rlow:  numeric array (1st_dim = #observations, 2nd-dim = #lags and leads, 3rd_dim = #regressors+1) of their lower bounds.
</p>
</li>
<li><p>rupp:  numeric array (1st_dim = #observations, 2nd-dim = #lags and leads, 3rd_dim = #regressors+1) of their upper bounds.
</p>
</li>
<li><p>rtst:  numeric array (1st_dim = #observations, 2nd-dim = #lags and leads, 3rd_dim = #regressors+1) of their t statistic values.
</p>
</li>
<li><p>rord:  numeric array (1st_dim = #observations, 2nd-dim = #lags and leads, 3rd_dim = #regressors+1) of their index order when sorted by significance.
</p>
</li>
<li><p>rpva:  numeric array (1st_dim = #observations, 2nd-dim = #lags and leads, 3rd_dim = #regressors+1) of their p values.
</p>
</li></ul>

<table>
<tr><td><code>YmaxR:</code></td>
<td>
<p> dataframe (rows = #observations, columns = #levels) giving, at each wavelet level and time, the index number of the variable whose correlation is calculated against
a linear combination of the rest.
By default, <em>wlmcr</em> chooses at each wavelet level and value in time the variable maximizing the multiple correlation.</p>
</td></tr>
<tr><td><code>data:</code></td>
<td>
<p> dataframe (rows = #observations, cols = #regressors) of original data.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Needs <em>waveslim</em> package to calculate <em>dwt</em> or <em>modwt</em> coefficients as inputs to the routine (also for data in the example).
</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Based on data from Figure 7.9 in Gencay, Selcuk and Whitcher (2001)
## plus one random series.

library(wavemulcor)

data(exchange)
returns &lt;- diff(log(exchange))
returns &lt;- ts(returns, start=1970, freq=12)
N &lt;- dim(returns)[1]
wf &lt;- "d4"
M &lt;- 30
window &lt;- "gauss"
J &lt;- 3 #trunc(log2(N))-3
lmax &lt;- 2

set.seed(140859)

demusd.modwt &lt;- brick.wall(modwt(returns[,"DEM.USD"], wf, J), wf)
jpyusd.modwt &lt;- brick.wall(modwt(returns[,"JPY.USD"], wf, J), wf)
rand.modwt   &lt;- brick.wall(modwt(rnorm(length(returns[,"DEM.USD"])), wf, J), wf)

xx &lt;- list(demusd.modwt, jpyusd.modwt, rand.modwt)
names(xx) &lt;- c("DEM.USD","JPY.USD","rand")

## Not run: 
# Note: WLMCR may take more than 10 seconds of CPU time on some systems

Lst &lt;- wave.local.multiple.cross.regression(xx, M, window=window, lag.max=lmax) #, ymaxr=1)

# ---------------------------

##Producing cross-correlation plot

plot_wave.local.multiple.cross.correlation(Lst, lmax, lag.first=FALSE) #, xaxt="s")

##Producing cross-regression plot

plot_wave.local.multiple.cross.regression(Lst, lmax, nsig=2) #, xaxt="s")

## End(Not run)
</code></pre>

<hr>
<h2 id='wave.local.multiple.regression'>
Wavelet routine for local multiple regression
</h2><span id='topic+wave.local.multiple.regression'></span><span id='topic+wlmr'></span>

<h3>Description</h3>

<p>Produces an estimate of the multiscale local multiple regression
(as defined below) along with approximate confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wave.local.multiple.regression(xx, M, window="gauss", p = .975, ymaxr=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wave.local.multiple.regression_+3A_xx">xx</code></td>
<td>
<p>A list of <code class="reqn">n</code> (multiscaled) time series, usually the outcomes of dwt or modwt, <em>i.e.</em>
xx &lt;- list(v1.modwt.bw, v2.modwt.bw, v3.modwt.bw)</p>
</td></tr>
<tr><td><code id="wave.local.multiple.regression_+3A_m">M</code></td>
<td>
<p>length of the weight function or rolling window.</p>
</td></tr>
<tr><td><code id="wave.local.multiple.regression_+3A_window">window</code></td>
<td>
<p>type of weight function or rolling window.
Six types are allowed, namely
the uniform window,
Cleveland or tricube window,
Epanechnikov or parabolic window,
Bartlett or triangular window,
Wendland window and
the gaussian window.
The letter case and length of the argument are not relevant
as long as at least the first four characters are entered.</p>
</td></tr>
<tr><td><code id="wave.local.multiple.regression_+3A_p">p</code></td>
<td>
<p>one minus the two-sided p-value for the confidence interval, <em>i.e.</em> the cdf value.</p>
</td></tr>
<tr><td><code id="wave.local.multiple.regression_+3A_ymaxr">ymaxr</code></td>
<td>
<p>index number of the variable whose correlation is calculated against a linear combination
of the rest, otherwise at each wavelet level wlmc chooses the one maximizing the multiple correlation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine calculates one single set of wavelet multiple regressions out of <code class="reqn">n</code> variables
that can be plotted in in <code class="reqn">J</code> line graphs with explicit confidence intervals.
</p>


<h3>Value</h3>

<p>List of four elements:
</p>
<table>
<tr><td><code>cor:</code></td>
<td>
<p> List of <code class="reqn">J+1</code> elements, one per wavelet level, each with:</p>
</td></tr>
</table>

<ul>
<li><p>val:  numeric matrix (rows = #observations, columns = #levels in the wavelet transform object)
providing the point estimates for the wavelet local multiple correlation.
</p>
</li>
<li><p>lo:  numeric matrix (rows = #observations, columns = #levels in the wavelet transform object)
providing the lower bounds from the confidence interval.
</p>
</li>
<li><p>up:  numeric matrix (rows = #observations, columns = #levels in the wavelet transform object)
providing the upper bounds from the confidence interval.
</p>
</li></ul>

<table>
<tr><td><code>reg:</code></td>
<td>
<p> List of <code class="reqn">J+1</code> elements, one per wavelet level, each with:</p>
</td></tr>
</table>

<ul>
<li><p>rval:  numeric matrix (rows = #observations, cols = #regressors+1) of local regression estimates.
</p>
</li>
<li><p>rstd:  numeric matrix (rows = #observations, cols = #regressors+1) of their standard deviations.
</p>
</li>
<li><p>rlow:  numeric matrix (rows = #observations, cols = #regressors+1) of their lower bounds.
</p>
</li>
<li><p>rupp:  numeric matrix (rows = #observations, cols = #regressors+1) of their upper bounds.
</p>
</li>
<li><p>rtst:  numeric matrix (rows = #observations, cols = #regressors+1) of their t statistic values.
</p>
</li>
<li><p>rord:  numeric matrix (rows = #observations, cols = #regressors+1) of their index order when sorted by significance.
</p>
</li>
<li><p>rpva:  numeric matrix (rows = #observations, cols = #regressors+1) of their p values.
</p>
</li></ul>

<table>
<tr><td><code>YmaxR:</code></td>
<td>
<p> dataframe (rows = #observations, columns = #levels in the wavelet transform object)
giving, at each wavelet level and time, the index number of the variable whose correlation is calculated against
a linear combination of the rest.
By default, <em>wlmr</em> chooses at each wavelet level and value in time the variable maximizing the multiple correlation.</p>
</td></tr>
<tr><td><code>data:</code></td>
<td>
<p> dataframe (rows = #observations, cols = #regressors) of original data.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Needs <em>waveslim</em> package to calculate <em>dwt</em> or <em>modwt</em> coefficients as inputs to the routine (also for data in the example).
</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Based on data from Figure 7.8 in Gencay, Selcuk and Whitcher (2001)
## plus two random series.

library(wavemulcor)

data(exchange)
returns &lt;- diff(log(as.matrix(exchange)))
returns &lt;- ts(returns, start=1970, freq=12)
N &lt;- dim(returns)[1]

wf &lt;- "d4"
M &lt;- 30
window &lt;- "gauss"
J &lt;- 3 #trunc(log2(N))-3

set.seed(140859)

demusd.modwt &lt;- brick.wall(modwt(returns[,"DEM.USD"], wf, J), wf)
jpyusd.modwt &lt;- brick.wall(modwt(returns[,"JPY.USD"], wf, J), wf)
xrand.modwt &lt;- brick.wall(modwt(rnorm(length(returns[,"DEM.USD"])), wf, J), wf)

# ---------------------------

xx &lt;- list(demusd.modwt, jpyusd.modwt, xrand.modwt)
names(xx) &lt;- c("DEM.USD","JPY.USD","rand")

Lst &lt;- wave.local.multiple.regression(xx, M, window=window) #, ymaxr=1)

# ---------------------------

##Producing line plots with CI

plot_wave.local.multiple.correlation(Lst) #, xaxt="s")

##Producing regression plots

plot_wave.local.multiple.regression(Lst) #, xaxt="s")

</code></pre>

<hr>
<h2 id='wave.multiple.correlation'>
Wavelet routine for multiple correlation
</h2><span id='topic+wave.multiple.correlation'></span><span id='topic+wmc'></span>

<h3>Description</h3>

<p>Produces an estimate of the multiscale multiple correlation
(as defined below) along with approximate confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wave.multiple.correlation(xx, N, p = 0.975, ymaxr=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wave.multiple.correlation_+3A_xx">xx</code></td>
<td>

<p>A list of <code class="reqn">n</code> (multiscaled) time series, usually the outcomes of dwt or modwt, <em>i.e.</em>
xx &lt;- list(v1.modwt.bw, v2.modwt.bw, v3.modwt.bw)</p>
</td></tr>
<tr><td><code id="wave.multiple.correlation_+3A_n">N</code></td>
<td>

<p>length of the time series
</p>
</td></tr>
<tr><td><code id="wave.multiple.correlation_+3A_p">p</code></td>
<td>

<p>one minus the two-sided p-value for the confidence interval, <em>i.e.</em> the cdf value.
</p>
</td></tr>
<tr><td><code id="wave.multiple.correlation_+3A_ymaxr">ymaxr</code></td>
<td>

<p>index number of the variable whose correlation is calculated against a linear combination
of the rest, otherwise at each wavelet level wmc chooses the one maximizing the multiple correlation.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine calculates one single set of wavelet multiple correlations out of <code class="reqn">n</code> variables
that can be plotted in a single graph, as an
alternative to trying to make sense out of <code class="reqn">n(n-1)/2</code> sets of wavelet correlations. The code is
based on the calculation, at each wavelet scale, of the square root of the coefficient of
determination in the linear combination of variables for which such coefficient of determination
is a maximum. The code provided here is based on the <em>wave.correlation</em> routine in Brandon
Whitcher's <em>waveslim</em> <span class="rlang"><b>R</b></span> package Version: 1.6.4, which in turn is based on wavelet methodology
developed in Percival and Walden (2000); Gençay, Selçuk and Whitcher (2001) and others.
</p>


<h3>Value</h3>

<p>List of two elements:
</p>
<table>
<tr><td><code>xy.mulcor:</code></td>
<td>
<p> numeric matrix with as many rows as levels in the wavelet transform object.
The first column provides the point estimate for the wavelet multiple correlation,
followed by the lower and upper bounds from the confidence interval.</p>
</td></tr>
<tr><td><code>YmaxR:</code></td>
<td>
<p> numeric vector giving, at each wavelet level, the index number of the variable whose correlation is calculated against a linear combination of the rest. By default, <em>wmc</em> chooses at each wavelet level the variable maximizing the multiple correlation.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Needs <em>waveslim</em> package to calculate <em>dwt</em> or <em>modwt</em> coefficients as inputs to the routine (also for data in the example).
</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2012. Wavelet multiple correlation and cross-correlation: A multiscale analysis of Eurozone stock markets. Physica A: Statistical Mechanics and its Applications 391, 1097&ndash;1104. &lt;DOI:10.1016/j.physa.2011.11.002&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Based on data from Figure 7.8 in Gencay, Selcuk and Whitcher (2001)
## plus one random series.

library(wavemulcor)
data(exchange)
returns &lt;- diff(log(as.matrix(exchange)))
returns &lt;- ts(returns, start=1970, freq=12)
N &lt;- dim(returns)[1]

wf &lt;- "d4"
J &lt;- trunc(log2(N))-3

demusd.modwt &lt;- brick.wall(modwt(returns[,"DEM.USD"], wf, J), wf)
jpyusd.modwt &lt;- brick.wall(modwt(returns[,"JPY.USD"], wf, J), wf)
rand.modwt   &lt;- brick.wall(modwt(rnorm(length(returns[,"DEM.USD"])), wf, J), wf)

xx &lt;- list(demusd.modwt, jpyusd.modwt, rand.modwt)

Lst &lt;- wave.multiple.correlation(xx, N = length(xx[[1]][[1]]))
returns.modwt.cor &lt;- Lst$xy.mulcor[1:J,]
YmaxR &lt;- Lst$YmaxR

exchange.names &lt;- c("DEM.USD", "JPY.USD", "RAND")

##Producing plot

par(mfrow=c(1,1), las=0, mar=c(5,4,4,2)+.1)
matplot(2^(0:(J-1)), returns.modwt.cor[-(J+1),], type="b",
  log="x", pch="*LU", xaxt="n", lty=1, col=c(1,4,4),
  xlab="Wavelet Scale", ylab="Wavelet Multiple Correlation")
axis(side=1, at=2^(0:7))
abline(h=0)
text(2^(0:7), min(returns.modwt.cor[-(J+1),])-0.03,
  labels=exchange.names[YmaxR], adj=0.5, cex=.5)
</code></pre>

<hr>
<h2 id='wave.multiple.cross.correlation'>
Wavelet routine for multiple cross-correlation
</h2><span id='topic+wave.multiple.cross.correlation'></span><span id='topic+wmcc'></span>

<h3>Description</h3>

<p>Produces an estimate of the multiscale multiple cross-correlation
(as defined below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'> wave.multiple.cross.correlation(xx, lag.max=NULL, p=.975, ymaxr=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wave.multiple.cross.correlation_+3A_xx">xx</code></td>
<td>
<p> A list of <code class="reqn">n</code> (multiscaled) time series, usually the outcomes of dwt or modwt, <em>i.e.</em> xx &lt;- list(v1.modwt.bw, v2.modwt.bw, v3.modwt.bw)</p>
</td></tr>
<tr><td><code id="wave.multiple.cross.correlation_+3A_lag.max">lag.max</code></td>
<td>
<p> maximum lag (and lead). If not set, it defaults to half the square root of the length of the original series.</p>
</td></tr>
<tr><td><code id="wave.multiple.cross.correlation_+3A_p">p</code></td>
<td>
<p>one minus the two-sided p-value for the confidence interval, <em>i.e.</em> the cdf value.</p>
</td></tr>
<tr><td><code id="wave.multiple.cross.correlation_+3A_ymaxr">ymaxr</code></td>
<td>
<p> index number of the variable whose correlation is calculated against a linear combination of the rest, otherwise at each wavelet level wmc chooses the one maximizing the multiple correlation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine calculates one single set of wavelet multiple cross-correlations out of <code class="reqn">n</code> variables
that can be plotted as one single set of graphs (one per wavelet level), as an
alternative to trying to make sense out of <code class="reqn">n(n-1)/2 . J</code> sets of wavelet cross-correlations.
The code is based on the calculation, at each wavelet scale, of the square root of the coefficient of
determination in a linear combination of variables that includes a lagged variable for which such coefficient of determination
is a maximum.
</p>


<h3>Value</h3>

<p>List of two elements:
</p>

<ul>
<li><p>xy.mulcor: numeric matrix with as many rows as levels in the wavelet transform object.
The columns provide the point estimates for the wavelet multiple cross-correlations at different lags (and leads).
The central column (<em>lag=0</em>) replicates the wavelet multiple correlations.
Columns to the right (<em>lag&gt;0</em>) give wavelet multiple cross-correlations with positive lag,
<em>i.e.</em> with y=var[Pimax] lagging behind a linear combination of the rest: x[t]hat &ndash;&gt; y[t+j].
Columns to the left (<em>lag&lt;0</em>) give wavelet multiple cross-correlations with negative lag,
<em>i.e.</em> with y=var[Pimax] leading a linear combination of the rest: y[t-j] &ndash;&gt; x[t]hat.
</p>
</li>
<li><p>ci.mulcor: list of two elements:
</p>

<ul>
<li><p>lower: numeric matrix of the same dimensions as <em>xy.mulcor</em> giving the lower bounds of the corresponding <code class="reqn">100(1-2(1-p))\%</code> confidence interval.
</p>
</li>
<li><p>upper: <em>idem</em> for the upper bounds.
</p>
</li></ul>

</li>
<li><p>YmaxR: numeric vector giving, at each wavelet level, the index number of the variable
whose correlation is calculated against a linear combination of the rest. By default,
<em>wmcc</em> chooses at each wavelet level the variable maximizing the multiple correlation.
</p>
</li></ul>



<h3>Note</h3>

<p>Needs <em>waveslim</em> package to calculate <em>dwt</em> or <em>modwt</em> coefficients as inputs to the routine (also for data in the example).
</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country,
Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain. (email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2012. Wavelet multiple correlation and cross-correlation: A multiscale analysis of Eurozone stock markets. Physica A: Statistical Mechanics and its Applications 391, 1097&ndash;1104. &lt;DOI:10.1016/j.physa.2011.11.002&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Based on data from Figure 7.9 in Gencay, Selcuk and Whitcher (2001)
## plus one random series.

library(wavemulcor)
data(exchange)
returns &lt;- diff(log(exchange))
returns &lt;- ts(returns, start=1970, freq=12)
N &lt;- dim(returns)[1]

wf &lt;- "d4"
J &lt;- trunc(log2(N))-3
lmax &lt;- 36
n &lt;- dim(returns)[1]

demusd.modwt &lt;- brick.wall(modwt(returns[,"DEM.USD"], wf, J), wf)
jpyusd.modwt &lt;- brick.wall(modwt(returns[,"JPY.USD"], wf, J), wf)
rand.modwt   &lt;- brick.wall(modwt(rnorm(length(returns[,"DEM.USD"])), wf, J), wf)

##xx &lt;- list(demusd.modwt.bw, jpyusd.modwt.bw)
xx &lt;- list(demusd.modwt, jpyusd.modwt, rand.modwt)

Lst &lt;- wave.multiple.cross.correlation(xx, lmax)
returns.cross.cor &lt;- Lst$xy.mulcor[1:J,]
returns.lower.ci &lt;- Lst$ci.mulcor$lower[1:J,]
returns.upper.ci &lt;- Lst$ci.mulcor$upper[1:J,]
YmaxR &lt;- Lst$YmaxR

# ---------------------------

##Producing correlation plot

rownames(returns.cross.cor) &lt;- rownames(returns.cross.cor, do.NULL = FALSE, prefix = "Level ")
par(mfrow=c(3,2), las=1, pty="m", mar=c(2,3,1,0)+.1, oma=c(1.2,1.2,0,0))
ymin &lt;- -0.1
if (length(xx)&lt;3) ymin &lt;- -1
for(i in J:1) {
  matplot((1:(2*lmax+1)),returns.cross.cor[i,], type="l", lty=1, ylim=c(ymin,1), xaxt="n",
          xlab="", ylab="", main=rownames(returns.cross.cor)[[i]][1])
  if(i&lt;3) {axis(side=1, at=seq(1, 2*lmax+1, by=12), labels=seq(-lmax, lmax, by=12))}
  #axis(side=2, at=c(-.2, 0, .5, 1))
  abline(h=0,v=lmax+1)              ##Add Straight horiz and vert Lines to a Plot
  lines(returns.lower.ci[i,], lty=1, col=2) ##Add Connected Line Segments to a Plot
  lines(returns.upper.ci[i,], lty=1, col=2)
  text(1,1, labels=names(xx)[YmaxR[i]], adj=0.25, cex=.8)
}
par(las=0)
mtext('Lag (months)', side=1, outer=TRUE, adj=0.5)
mtext('Wavelet Multiple Cross-Correlation', side=2, outer=TRUE, adj=0.5)

</code></pre>

<hr>
<h2 id='wave.multiple.cross.regression'>
Wavelet routine for multiple cross-regression
</h2><span id='topic+wave.multiple.cross.regression'></span><span id='topic+wmcr'></span>

<h3>Description</h3>

<p>Produces an estimate of the multiscale multiple cross-regression
(as defined below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'> wave.multiple.cross.regression(xx, lag.max=NULL, p = .975, ymaxr=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wave.multiple.cross.regression_+3A_xx">xx</code></td>
<td>
<p> A list of <code class="reqn">n</code> (multiscaled) time series, usually the outcomes of dwt or modwt, <em>i.e.</em> xx &lt;- list(v1.modwt.bw, v2.modwt.bw, v3.modwt.bw)</p>
</td></tr>
<tr><td><code id="wave.multiple.cross.regression_+3A_lag.max">lag.max</code></td>
<td>
<p> maximum lag (and lead). If not set, it defaults to half the square root of the length of the original series.</p>
</td></tr>
<tr><td><code id="wave.multiple.cross.regression_+3A_p">p</code></td>
<td>
<p>one minus the two-sided p-value for the confidence interval, <em>i.e.</em> the cdf value.</p>
</td></tr>
<tr><td><code id="wave.multiple.cross.regression_+3A_ymaxr">ymaxr</code></td>
<td>
<p> index number of the variable whose correlation is calculated against a linear combination of the rest, otherwise at each wavelet level wmc chooses the one maximizing the multiple correlation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine calculates one single set of wavelet multiple cross-regressions out of <code class="reqn">n</code> variables that can be plotted as one single set of graphs (one per wavelet level).
</p>


<h3>Value</h3>

<p>List of four elements:
</p>
<table>
<tr><td><code>xy.mulcor</code></td>
<td>
<p> List of three elements:</p>
</td></tr>
</table>

<ul>
<li><p>wavemulcor: numeric matrix (rows = #levels, #cols = #lags and leads) with as many rows as levels in the wavelet transform object.
The columns provide the point estimates for the wavelet multiple cross-correlations at different lags (and leads).
The central column (lag=0) replicates the wavelet multiple correlations.
Columns to the right (lag&gt;0) give wavelet multiple cross-correlations with positive lag,
<em>i.e.</em> with y=var[Pimax] lagging behind a linear combination of the rest: x[t]hat &ndash;&gt; y[t+j].
Columns to the left (lag&lt;0) give wavelet multiple cross-correlations with negative lag,
<em>i.e.</em> with y=var[Pimax] leading a linear combination of the rest: y[t-j] &ndash;&gt; x[t]hat.
</p>
</li>
<li><p>lower:  numeric matrix (rows = #levels, #cols = #lags and leads) of lower bounds of the confidence interval.
</p>
</li>
<li><p>upper:  numeric matrix (rows = #levels, #cols = #lags and leads) of upper bounds of the confidence interval.
</p>
</li></ul>

<table>
<tr><td><code>xy.mulreg:</code></td>
<td>
<p> List of seven elements:</p>
</td></tr>
</table>

<ul>
<li><p>rval:  numeric array (1stdim = #levels, 2nddim = #lags and leads, 3rddim = #regressors+1) of regression estimates.
</p>
</li>
<li><p>rstd:  numeric array (1stdim = #levels, 2nddim = #lags and leads, 3rddim = #regressors+1) of their standard deviations.
</p>
</li>
<li><p>rlow:  numeric array (1stdim = #levels, 2nddim = #lags and leads, 3rddim = #regressors+1) of their lower bounds.
</p>
</li>
<li><p>rupp:  numeric array (1stdim = #levels, 2nddim = #lags and leads, 3rddim = #regressors+1) of their upper bounds.
</p>
</li>
<li><p>rtst:  numeric array (1stdim = #levels, 2nddim = #lags and leads, 3rddim = #regressors+1) of their t statistic values.
</p>
</li>
<li><p>rord:  numeric array (1stdim = #levels, 2nddim = #lags and leads, 3rddim = #regressors+1) of their index order when sorted by significance.
</p>
</li>
<li><p>rpva:  numeric array (1stdim = #levels, 2nddim = #lags and leads, 3rddim = #regressors+1) of their p values.
</p>
</li></ul>

<table>
<tr><td><code>YmaxR:</code></td>
<td>
<p> numeric vector giving, at each wavelet level, the index number of the variable
whose correlation is calculated against a linear combination of the rest. By default,
<em>wmcr</em> chooses at each wavelet level the variable maximizing the multiple correlation.</p>
</td></tr>
<tr><td><code>data:</code></td>
<td>
<p> dataframe (rows = #levels, cols = #regressors) of original data.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Needs <em>waveslim</em> package to calculate <em>dwt</em> or <em>modwt</em> coefficients as inputs to the routine (also for data in the example).
</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country,
Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain. (email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Based on data from Figure 7.9 in Gencay, Selcuk and Whitcher (2001)
## plus one random series.

library(wavemulcor)

data(exchange)
returns &lt;- diff(log(exchange))
returns &lt;- ts(returns, start=1970, freq=12)
N &lt;- dim(returns)[1]

wf &lt;- "d4"
J &lt;- trunc(log2(N))-3
lmax &lt;- 36

set.seed(140859)

demusd.modwt &lt;- brick.wall(modwt(returns[,"DEM.USD"], wf, J), wf)
jpyusd.modwt &lt;- brick.wall(modwt(returns[,"JPY.USD"], wf, J), wf)
rand.modwt   &lt;- brick.wall(modwt(rnorm(length(returns[,"DEM.USD"])), wf, J), wf)

# ---------------------------

xx &lt;- list(demusd.modwt, jpyusd.modwt, rand.modwt)
names(xx) &lt;- c("DEM.USD","JPY.USD","rand")

Lst &lt;- wave.multiple.cross.regression(xx, lmax)

# ---------------------------

##Producing correlation plot

plot_wave.multiple.cross.correlation(Lst, lmax) #, by=2)

##Producing regression plot

plot_wave.multiple.cross.regression(Lst, lmax) #, by=2)

</code></pre>

<hr>
<h2 id='wave.multiple.regression'>
Wavelet routine for multiple regression
</h2><span id='topic+wave.multiple.regression'></span><span id='topic+wmr'></span>

<h3>Description</h3>

<p>Produces an estimate of the multiscale multiple regression
(as defined below) along with approximate confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wave.multiple.regression(xx, N, p = 0.975, ymaxr=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wave.multiple.regression_+3A_xx">xx</code></td>
<td>

<p>A list of <code class="reqn">n</code> (multiscaled) time series, usually the outcomes of dwt or modwt, <em>i.e.</em>
xx &lt;- list(v1.modwt.bw, v2.modwt.bw, v3.modwt.bw)</p>
</td></tr>
<tr><td><code id="wave.multiple.regression_+3A_n">N</code></td>
<td>

<p>length of the time series
</p>
</td></tr>
<tr><td><code id="wave.multiple.regression_+3A_p">p</code></td>
<td>

<p>one minus the two-sided p-value for the confidence interval, <em>i.e.</em> the cdf value.
</p>
</td></tr>
<tr><td><code id="wave.multiple.regression_+3A_ymaxr">ymaxr</code></td>
<td>

<p>index number of the variable whose correlation is calculated against a linear combination
of the rest, otherwise at each wavelet level wmc chooses the one maximizing the multiple correlation.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine calculates one single set of wavelet multiple regressions out of <code class="reqn">n</code> variables
that can be plotted in a single graph.
</p>


<h3>Value</h3>

<p>List of four elements:
</p>
<table>
<tr><td><code>xy.mulcor:</code></td>
<td>
<p> numeric matrix with as many rows as levels in the wavelet transform object.
The first column provides the point estimate for the wavelet multiple correlation,
followed by the lower and upper bounds from the confidence interval.</p>
</td></tr>
<tr><td><code>xy.mulreg:</code></td>
<td>
<p> List of seven elements:</p>
</td></tr>
</table>

<ul>
<li><p>rval:  numeric matrix (rows = #levels, cols = #regressors+1) of regression estimates.
</p>
</li>
<li><p>rstd:  numeric matrix (rows = #levels, cols = #regressors+1) of their standard deviations.
</p>
</li>
<li><p>rlow:  numeric matrix (rows = #levels, cols = #regressors+1) of their lower bounds.
</p>
</li>
<li><p>rupp:  numeric matrix (rows = #levels, cols = #regressors+1) of their upper bounds.
</p>
</li>
<li><p>rtst:  numeric matrix (rows = #levels, cols = #regressors+1) of their t statistic values.
</p>
</li>
<li><p>rord:  numeric matrix (rows = #levels, cols = #regressors+1) of their index order when sorted by significance.
</p>
</li>
<li><p>rpva:  numeric matrix (rows = #levels, cols = #regressors+1) of their p values.
</p>
</li></ul>

<table>
<tr><td><code>YmaxR:</code></td>
<td>
<p> numeric vector giving, at each wavelet level, the index number of the variable whose
correlation is calculated against a linear combination of the rest. By default,
<em>wmc</em> chooses at each wavelet level the variable maximizing the multiple correlation.</p>
</td></tr>
<tr><td><code>data:</code></td>
<td>
<p> dataframe (rows = #levels, cols = #regressors) of original data.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Needs <em>waveslim</em> package to calculate <em>dwt</em> or <em>modwt</em> coefficients as inputs to the routine (also for data in the example).
</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Based on data from Figure 7.8 in Gencay, Selcuk and Whitcher (2001)
## plus one random series.

library(wavemulcor)

data(exchange)
returns &lt;- diff(log(as.matrix(exchange)))
returns &lt;- ts(returns, start=1970, freq=12)
N &lt;- dim(returns)[1]

wf &lt;- "d4"
J &lt;- trunc(log2(N))-3

set.seed(140859)

demusd.modwt &lt;- brick.wall(modwt(returns[,"DEM.USD"], wf, J), wf)
jpyusd.modwt &lt;- brick.wall(modwt(returns[,"JPY.USD"], wf, J), wf)
xrand.modwt &lt;- brick.wall(modwt(rnorm(length(returns[,"DEM.USD"])), wf, J), wf)

# ---------------------------

xx &lt;- list(demusd.modwt, jpyusd.modwt, xrand.modwt)
names(xx) &lt;- c("DEM.USD","JPY.USD","rand")

Lst &lt;- wave.multiple.regression(xx)

# ---------------------------

##Producing correlation plot
plot_wave.multiple.correlation(Lst)

##Producing regression plot
plot_wave.multiple.regression(Lst)

</code></pre>

<hr>
<h2 id='wavemulcor-package'>
Wavelet Routines for Global and Local Multiple Regression and
Correlation
</h2><span id='topic+wavemulcor-package'></span><span id='topic+wavemulcor'></span>

<h3>Description</h3>

<p>Wavelet routines that calculate single sets of wavelet
    multiple regressions and correlations, and cross-regressions and
    cross-correlations from a multivariate time series.  Dynamic versions
    of the routines allow the wavelet local multiple (cross-)regressions
    and (cross-)correlations to evolve over time.
</p>


<h3>Details</h3>

<p>Wavelet routines that calculate single sets of wavelet multiple
regressions and correlations (WMR and WMC), and cross-regressions
and cross-correlations (WMCR and WMCC) from a multivariate time series.
Dynamic versions of the routines allow the wavelet local multiple
(cross-)regressions (WLMR and WLMCR) and (cross-)correlations
(WLMC and WLMCC) to evolve over time.
The output from these Wavelet statistics can later be plotted in single graphs,
as an alternative to trying to make sense out of several sets of wavelet
correlations or wavelet cross-correlations.
The code is based on the calculation, at each wavelet scale,
of the square root of the coefficient of determination in a
linear combination of variables for which such coefficient of
determination is a maximum. The code provided here is based on
the wave.correlation routine in Brandon Whitcher's waveslim R
package Version: 1.6.4, which in turn is based on wavelet
methodology developed in Percival and Walden (2000),
Gençay, Selçuk and Whitcher (2002) and others.
Version 2 incorporates wavelet local multiple correlations
(WLMC). These are like the previous global WMC but consisting
in one single set of multiscale correlations along time. That
is, at each time t, they are calculated by letting a window of
weighted wavelet coefficients around t move along time. Six
weight functions are provided. Namely, the uniform window,
Cleveland's tricube window, Epanechnikov's parabolic window,
Bartlett's triangular window and Wendland's truncated power
window and the Gaussian window. Version 2.2 incorporates
auxiliary functions that calculate local multiple correlations
and cross-correlations (LMC, LMCC). They are calculated by
letting move along time a window of weighted time series values
around t. Any of the six weight functions mentioned above can
be used. They also feed a new routine to compute wavelet local
multiple cross-correlation (WLMCC).
Version 3 extends all the previous correlation routines
(WMC, WMCC, LMC, WLMC, WLMCC) to handle wavelet regressions
(WMR, WMCR, LMR, WLMR, WLMCR) that provide regression coefficients
and statistics across wavelet scales.
Auxiliary plot_ and heatmap_ routines are also provided
to visualize the wavmulcor statistics.
</p>


<h3>Author(s)</h3>

<p>Javier Fernández-Macho,
Dpt. of Quantitative Methods,
University of the Basque Country, Agirre Lehendakari etorb. 83, E48015 BILBAO, Spain.
(email: javier.fernandezmacho at ehu.eus).
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2012. Wavelet multiple correlation and cross-correlation: A multiscale analysis of Eurozone stock markets. Physica A: Statistical Mechanics and its Applications 391, 1097&ndash;1104. &lt;DOI:10.1016/j.physa.2011.11.002&gt;
</p>
<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226&ndash;1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;
</p>

<hr>
<h2 id='xrand'>
Correlation structural breaks data
</h2><span id='topic+xrand'></span>

<h3>Description</h3>

<p>Simulated data showing correlation structural breaks in Figure 4  of Fernández-Macho (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("xrand")</code></pre>


<h3>Format</h3>

<p>A data frame with 512 observations on the following 2 variables.
</p>

<dl>
<dt><code>xrand1</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>xrand2</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p><code class="reqn">xrand1[t]</code> and <code class="reqn">xrand2[t]</code>
are highly correlated at low frequencies (long timescales) but uncorrelated at high frequencies (short timescales).
However, during a period of time spanning the second third of the sample (<code class="reqn">T/3&lt;t&lt;2T/3</code>) that behavior is reversed so that data become highly correlated at short timescales but uncorrelated at low frequencies.
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A, 492, https://doi.org/10.1016/j.physa.2017.11.050
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(xrand)
## maybe str(xrand) ; plot(xrand) ...
</code></pre>

<hr>
<h2 id='xrand1'>
Correlation structural breaks variable 1
</h2><span id='topic+xrand1'></span>

<h3>Description</h3>

<p>Simulated data showing correlation structural breaks in Figure 4  of Fernández-Macho (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("xrand")</code></pre>


<h3>Format</h3>

<p>A data frame with 512 observations on 1 variables.
</p>

<dl>
<dt><code>xrand1</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p><code class="reqn">xrand1[t]</code> and <code class="reqn">xrand2[t]</code>
are highly correlated at low frequencies (long timescales) but uncorrelated at high frequencies (short timescales).
However, during a period of time spanning the second third of the sample (<code class="reqn">T/3&lt;t&lt;2T/3</code>) that behavior is reversed so that data become highly correlated at short timescales but uncorrelated at low frequencies.
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A, 492, https://doi.org/10.1016/j.physa.2017.11.050
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(xrand)
## maybe str(xrand) ; plot(xrand) ...
</code></pre>

<hr>
<h2 id='xrand2'>
Correlation structural breaks variable 2
</h2><span id='topic+xrand2'></span>

<h3>Description</h3>

<p>Simulated data showing correlation structural breaks in Figure 4  of Fernández-Macho (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("xrand")</code></pre>


<h3>Format</h3>

<p>A data frame with 512 observations on 1 variables.
</p>

<dl>
<dt><code>xrand2</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p><code class="reqn">xrand1[t]</code> and <code class="reqn">xrand2[t]</code>
are highly correlated at low frequencies (long timescales) but uncorrelated at high frequencies (short timescales).
However, during a period of time spanning the second third of the sample (<code class="reqn">T/3&lt;t&lt;2T/3</code>) that behavior is reversed so that data become highly correlated at short timescales but uncorrelated at low frequencies.
</p>


<h3>References</h3>

<p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A, 492, https://doi.org/10.1016/j.physa.2017.11.050
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(xrand)
## maybe str(xrand) ; plot(xrand) ...
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
