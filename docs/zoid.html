<!DOCTYPE html><html><head><title>Help for package zoid</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {zoid}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#zoid-package'><p>The 'zoid' package.</p></a></li>
<li><a href='#broken_stick'><p>Random generation of datasets using the dirichlet broken stick method</p></a></li>
<li><a href='#chinook'><p>Data from Satterthwaite, W.H., Ciancio, J., Crandall, E., Palmer-Zwahlen,</p>
M.L., Grover, A.M., O’Farrell, M.R., Anson, E.C., Mohr, M.S. &amp; Garza,
J.C. (2015). Stock composition and ocean spatial distribution from
California recreational chinook salmon fisheries using genetic stock
identification. Fisheries Research, 170, 166–178. The data
genetic data collected from port-based sampling of recreationally-landed
Chinook salmon in California from 1998-2002.</a></li>
<li><a href='#coddiet'><p>Data from Magnussen, E. 2011. Food and feeding habits of cod (Gadus morhua)</p>
on the Faroe Bank. – ICES Journal of Marine Science, 68: 1909–1917. The data
here are Table 3 from the paper, with sample proportions (columns w) multiplied
by total weight to yield total grams (g) for each sample-diet item combination. Dashes
have been replaced with 0s.</a></li>
<li><a href='#fit_dirichlet'><p>Extract point estimates of compositions from fitted model.</p></a></li>
<li><a href='#fit_prior'><p>Find appropriate standard deviations for prior</p></a></li>
<li><a href='#fit_zoid'><p>Fit a trinomial mixture model with Stan</p></a></li>
<li><a href='#get_fitted'><p>Extract estimates of predicted latent proportions.</p></a></li>
<li><a href='#get_pars'><p>Extract parameters from fitted model.</p></a></li>
<li><a href='#parse_re_formula'><p>Fit a trinomial mixture model that optionally includes covariates to estimate</p>
effects of factor or continuous variables on proportions.</a></li>
<li><a href='#rmspe_calc'><p>Find appropriate prior for a given target distribution.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Bayesian Zero-and-One Inflated Dirichlet Regression Modelling</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits Dirichlet regression and zero-and-one inflated Dirichlet regression with Bayesian methods implemented in Stan. These models are sometimes referred to as trinomial mixture models; covariates and overdispersion can optionally be included.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://noaa-nwfsc.github.io/zoid/">https://noaa-nwfsc.github.io/zoid/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/noaa-nwfsc/zoid/issues">https://github.com/noaa-nwfsc/zoid/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>gtools, methods, Rcpp (&ge; 0.12.0), RcppParallel (&ge; 5.0.1),
rstan (&ge; 2.26.0), rstantools (&ge; 2.1.1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH (&ge; 1.66.0), Rcpp (&ge; 0.12.0), RcppEigen (&ge; 0.3.3.3.0),
RcppParallel (&ge; 5.0.1), rstan (&ge; 2.26.0), StanHeaders (&ge;
2.26.0)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-24 17:46:08 UTC; ericward</td>
</tr>
<tr>
<td>Author:</td>
<td>Eric J. Ward <a href="https://orcid.org/0000-0002-4359-0296"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Alexander J. Jensen
    <a href="https://orcid.org/0000-0002-2911-8884"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Ryan P. Kelly <a href="https://orcid.org/0000-0001-5037-2441"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Andrew O. Shelton <a href="https://orcid.org/0000-0002-8045-6141"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  William H. Satterthwaite
    <a href="https://orcid.org/0000-0002-0436-7390"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Eric C. Anderson <a href="https://orcid.org/0000-0003-1326-0840"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Eric J. Ward &lt;eric.ward@noaa.gov&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-24 18:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='zoid-package'>The 'zoid' package.</h2><span id='topic+zoid-package'></span><span id='topic+trinomix'></span>

<h3>Description</h3>

<p>A DESCRIPTION OF THE PACKAGE
</p>


<h3>References</h3>

<p>Stan Development Team (2020). RStan: the R interface to Stan. R package version 2.21.2. https://mc-stan.org
</p>

<hr>
<h2 id='broken_stick'>Random generation of datasets using the dirichlet broken stick method</h2><span id='topic+broken_stick'></span>

<h3>Description</h3>

<p>Random generation of datasets using the dirichlet broken stick method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>broken_stick(
  n_obs = 1000,
  n_groups = 10,
  ess_fraction = 1,
  tot_n = 100,
  p = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="broken_stick_+3A_n_obs">n_obs</code></td>
<td>
<p>Number of observations (rows of data matrix to simulate). Defaults to 10</p>
</td></tr>
<tr><td><code id="broken_stick_+3A_n_groups">n_groups</code></td>
<td>
<p>Number of categories for each observation (columns of data matrix). Defaults to 10</p>
</td></tr>
<tr><td><code id="broken_stick_+3A_ess_fraction">ess_fraction</code></td>
<td>
<p>The effective sample size fraction, defaults to 1</p>
</td></tr>
<tr><td><code id="broken_stick_+3A_tot_n">tot_n</code></td>
<td>
<p>The total sample size to simulate for each observation. This is approximate and the actual
simulated sample size will be slightly smaller. Defaults to 100</p>
</td></tr>
<tr><td><code id="broken_stick_+3A_p">p</code></td>
<td>
<p>The stock proportions to simulate from, as a vector. Optional, and when not included,
random draws from the dirichlet are used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 2-element list, whose 1st element <code>X_obs</code> is the simulated dataset, and whose
2nd element is the underlying vector of proportions <code>p</code> used to generate the data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
y &lt;- broken_stick(n_obs = 3, n_groups = 5, tot_n = 100)

# add custom proportions
y &lt;- broken_stick(
  n_obs = 3, n_groups = 5, tot_n = 100,
  p = c(0.1, 0.2, 0.3, 0.2, 0.2)
)

</code></pre>

<hr>
<h2 id='chinook'>Data from Satterthwaite, W.H., Ciancio, J., Crandall, E., Palmer-Zwahlen,
M.L., Grover, A.M., O’Farrell, M.R., Anson, E.C., Mohr, M.S. &amp; Garza,
J.C. (2015). Stock composition and ocean spatial distribution from
California recreational chinook salmon fisheries using genetic stock
identification. Fisheries Research, 170, 166–178. The data
genetic data collected from port-based sampling of recreationally-landed
Chinook salmon in California from 1998-2002.</h2><span id='topic+chinook'></span>

<h3>Description</h3>

<p>Data from Satterthwaite, W.H., Ciancio, J., Crandall, E., Palmer-Zwahlen,
M.L., Grover, A.M., O’Farrell, M.R., Anson, E.C., Mohr, M.S. &amp; Garza,
J.C. (2015). Stock composition and ocean spatial distribution from
California recreational chinook salmon fisheries using genetic stock
identification. Fisheries Research, 170, 166–178. The data
genetic data collected from port-based sampling of recreationally-landed
Chinook salmon in California from 1998-2002.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chinook
</code></pre>


<h3>Format</h3>

<p>A data frame.
</p>

<hr>
<h2 id='coddiet'>Data from Magnussen, E. 2011. Food and feeding habits of cod (Gadus morhua)
on the Faroe Bank. – ICES Journal of Marine Science, 68: 1909–1917. The data
here are Table 3 from the paper, with sample proportions (columns w) multiplied
by total weight to yield total grams (g) for each sample-diet item combination. Dashes
have been replaced with 0s.</h2><span id='topic+coddiet'></span>

<h3>Description</h3>

<p>Data from Magnussen, E. 2011. Food and feeding habits of cod (Gadus morhua)
on the Faroe Bank. – ICES Journal of Marine Science, 68: 1909–1917. The data
here are Table 3 from the paper, with sample proportions (columns w) multiplied
by total weight to yield total grams (g) for each sample-diet item combination. Dashes
have been replaced with 0s.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coddiet
</code></pre>


<h3>Format</h3>

<p>A data frame.
</p>

<hr>
<h2 id='fit_dirichlet'>Extract point estimates of compositions from fitted model.</h2><span id='topic+fit_dirichlet'></span>

<h3>Description</h3>

<p>Extract point estimates of compositions from fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_dirichlet(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_dirichlet_+3A_data">data</code></td>
<td>
<p>The data to fit the dirichlet distribution to</p>
</td></tr>
</table>

<hr>
<h2 id='fit_prior'>Find appropriate standard deviations for prior</h2><span id='topic+fit_prior'></span>

<h3>Description</h3>

<p>Find appropriate standard deviations for prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_prior(n_bins, n_draws = 10000, target = 1/n_bins, iterations = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_prior_+3A_n_bins">n_bins</code></td>
<td>
<p>Bins for the Dirichlet distribution</p>
</td></tr>
<tr><td><code id="fit_prior_+3A_n_draws">n_draws</code></td>
<td>
<p>Numbers of samples to use for doing calculation</p>
</td></tr>
<tr><td><code id="fit_prior_+3A_target">target</code></td>
<td>
<p>The goal of the specified prior, e.g. 1 or 1/n_bins</p>
</td></tr>
<tr><td><code id="fit_prior_+3A_iterations">iterations</code></td>
<td>
<p>to try, to ensure robust solution. Defaults to 5</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 3-element list consisting of <code>sd</code> (the approximate standard deviation
in transformed space that gives a similar prior to that specified), <code>value</code> (the
value of the root mean squared percent error function being minimized),
and <code>convergence</code> (0 if convergence occurred, error code from
<code><a href="stats.html#topic+optim">optim()</a></code> otherwise)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# fit model with 3 components / alpha = 1
set.seed(123)
f &lt;- fit_prior(n_bins = 3, n_draws = 1000, target = 1)
# fit model with 20 components / alpha = 1/20
f &lt;- fit_prior(n_bins = 20, n_draws = 1000, target = 1 / 20)


</code></pre>

<hr>
<h2 id='fit_zoid'>Fit a trinomial mixture model with Stan</h2><span id='topic+fit_zoid'></span>

<h3>Description</h3>

<p>Fit a trinomial mixture model that optionally includes covariates to estimate
effects of factor or continuous variables on proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_zoid(
  formula = NULL,
  design_matrix,
  data_matrix,
  chains = 3,
  iter = 2000,
  warmup = floor(iter/2),
  overdispersion = FALSE,
  overdispersion_sd = 5,
  posterior_predict = FALSE,
  moment_match = FALSE,
  prior_sd = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_zoid_+3A_formula">formula</code></td>
<td>
<p>The model formula for the design matrix. Does not need to have a response specified. If =NULL, then
the design matrix is ignored and all rows are treated as replicates</p>
</td></tr>
<tr><td><code id="fit_zoid_+3A_design_matrix">design_matrix</code></td>
<td>
<p>A data frame, dimensioned as number of observations, and covariates in columns</p>
</td></tr>
<tr><td><code id="fit_zoid_+3A_data_matrix">data_matrix</code></td>
<td>
<p>A matrix, with observations on rows and number of groups across columns</p>
</td></tr>
<tr><td><code id="fit_zoid_+3A_chains">chains</code></td>
<td>
<p>Number of mcmc chains, defaults to 3</p>
</td></tr>
<tr><td><code id="fit_zoid_+3A_iter">iter</code></td>
<td>
<p>Number of mcmc iterations, defaults to 2000</p>
</td></tr>
<tr><td><code id="fit_zoid_+3A_warmup">warmup</code></td>
<td>
<p>Number iterations for mcmc warmup, defaults to 1/2 of the iterations</p>
</td></tr>
<tr><td><code id="fit_zoid_+3A_overdispersion">overdispersion</code></td>
<td>
<p>Whether or not to include overdispersion parameter, defaults to FALSE</p>
</td></tr>
<tr><td><code id="fit_zoid_+3A_overdispersion_sd">overdispersion_sd</code></td>
<td>
<p>Prior standard deviation on 1/overdispersion parameter, Defaults to inv-Cauchy(0,5)</p>
</td></tr>
<tr><td><code id="fit_zoid_+3A_posterior_predict">posterior_predict</code></td>
<td>
<p>Whether or not to return draws from posterior predictive distribution (requires more memory)</p>
</td></tr>
<tr><td><code id="fit_zoid_+3A_moment_match">moment_match</code></td>
<td>
<p>Whether to do moment matching via <code><a href="loo.html#topic+loo_moment_match">loo::loo_moment_match()</a></code>. This increases memory by adding all temporary
parmaeters to be saved and returned</p>
</td></tr>
<tr><td><code id="fit_zoid_+3A_prior_sd">prior_sd</code></td>
<td>
<p>Parameter to be passed in to use as standard deviation of the normal distribution in transformed space. If
covariates are included this defaults to 1, but for models with single replicate, defaults to 1/n_bins.</p>
</td></tr>
<tr><td><code id="fit_zoid_+3A_...">...</code></td>
<td>
<p>Any other arguments to pass to <code><a href="rstan.html#topic+stanmodel-method-sampling">rstan::sampling()</a></code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
y &lt;- matrix(c(3.77, 6.63, 2.60, 0.9, 1.44, 0.66, 2.10, 3.57, 1.33),
  nrow = 3, byrow = TRUE
)
# fit a model with no covariates
fit &lt;- fit_zoid(data_matrix = y, chains = 1, iter = 100)

# fit a model with 1 factor
design &lt;- data.frame("fac" = c("spring", "spring", "fall"))
fit &lt;- fit_zoid(formula = ~fac, design_matrix = design, data_matrix = y, chains = 1, iter = 100)

# try a model with random effects
set.seed(123)
y &lt;- matrix(runif(99,1,4), ncol=3)
design &lt;- data.frame("fac" = sample(letters[1:5], size=nrow(y), replace=TRUE))
design$fac &lt;- as.factor(design$fac)
fit &lt;- fit_zoid(formula = ~(1|fac), design_matrix = design, data_matrix = y, chains = 1, iter = 100)

</code></pre>

<hr>
<h2 id='get_fitted'>Extract estimates of predicted latent proportions.</h2><span id='topic+get_fitted'></span>

<h3>Description</h3>

<p>Extract point estimates of compositions from fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_fitted(fitted_model, conf_int = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_fitted_+3A_fitted_model">fitted_model</code></td>
<td>
<p>The fitted model returned as an rstan object from the call to zoid</p>
</td></tr>
<tr><td><code id="get_fitted_+3A_conf_int">conf_int</code></td>
<td>
<p>Parameter controlling confidence intervals calculated, defaults to 0.05
for 95% intervals</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the posterior summaries of estimated parameters, with
element <code>mu</code> (the predicted values in normal space). For predictions
in transformed space, or overdispersion, see <code><a href="#topic+get_pars">get_pars()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
y &lt;- matrix(c(3.77, 6.63, 2.60, 0.9, 1.44, 0.66, 2.10, 3.57, 1.33),
  nrow = 3, byrow = TRUE
)
# fit a model with no covariates
fit &lt;- fit_zoid(data_matrix = y)
p_hat &lt;- get_fitted(fit)


</code></pre>

<hr>
<h2 id='get_pars'>Extract parameters from fitted model.</h2><span id='topic+get_pars'></span>

<h3>Description</h3>

<p>Extract estimated parameters from fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_pars(fitted_model, conf_int = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_pars_+3A_fitted_model">fitted_model</code></td>
<td>
<p>The fitted model returned as an rstan object from the call to zoid</p>
</td></tr>
<tr><td><code id="get_pars_+3A_conf_int">conf_int</code></td>
<td>
<p>Parameter controlling confidence intervals calculated, defaults to 0.05
for 95% intervals</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the posterior summaries of estimated parameters. At minimum,
this will include <code>p</code> (the estimated proportions) and <code>betas</code> (the predicted values in
transformed space). For models with overdispersion, an extra
element <code>phi</code> will also be returned, summarizing overdispersion. For models with random
intercepts, estimates of the group level effects will also be returned as <code>zetas</code> (again,
in transformed space). For predictions
in normal space, see <code><a href="#topic+get_fitted">get_fitted()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
y &lt;- matrix(c(3.77, 6.63, 2.60, 0.9, 1.44, 0.66, 2.10, 3.57, 1.33),
  nrow = 3, byrow = TRUE
)
# fit a model with no covariates
fit &lt;- fit_zoid(data_matrix = y)
p_hat &lt;- get_pars(fit)


</code></pre>

<hr>
<h2 id='parse_re_formula'>Fit a trinomial mixture model that optionally includes covariates to estimate
effects of factor or continuous variables on proportions.</h2><span id='topic+parse_re_formula'></span>

<h3>Description</h3>

<p>Fit a trinomial mixture model that optionally includes covariates to estimate
effects of factor or continuous variables on proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_re_formula(formula, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse_re_formula_+3A_formula">formula</code></td>
<td>
<p>The model formula for the design matrix.</p>
</td></tr>
<tr><td><code id="parse_re_formula_+3A_data">data</code></td>
<td>
<p>The data matrix used to construct RE design matrix</p>
</td></tr>
</table>

<hr>
<h2 id='rmspe_calc'>Find appropriate prior for a given target distribution.</h2><span id='topic+rmspe_calc'></span>

<h3>Description</h3>

<p>Extract point estimates of compositions from fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmspe_calc(par, n_bins, n_draws, target)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmspe_calc_+3A_par">par</code></td>
<td>
<p>The parameter (standard deviation) to be searched over to find a Dirichlet equivalent</p>
</td></tr>
<tr><td><code id="rmspe_calc_+3A_n_bins">n_bins</code></td>
<td>
<p>Bins for the Dirichlet distribution</p>
</td></tr>
<tr><td><code id="rmspe_calc_+3A_n_draws">n_draws</code></td>
<td>
<p>Numbers of samples to use for doing calculation</p>
</td></tr>
<tr><td><code id="rmspe_calc_+3A_target">target</code></td>
<td>
<p>The goal of the specified prior, e.g. 1 or 1/n_bins</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
