<!DOCTYPE html><html><head><title>Help for package bigparallelr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bigparallelr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bigparallelr-package'><p>bigparallelr: Easy Parallel Tools</p></a></li>
<li><a href='#assert_cores'><p>Check number of cores</p></a></li>
<li><a href='#get_blas_ncores'><p>Number of cores used by BLAS (matrix computations)</p></a></li>
<li><a href='#nb_cores'><p>Recommended number of cores to use</p></a></li>
<li><a href='#plus'><p>Add</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#register_parallel'><p>Register parallel</p></a></li>
<li><a href='#rows_along'><p>Sequence generation</p></a></li>
<li><a href='#split_costs'><p>Split costs in blocks</p></a></li>
<li><a href='#split_len'><p>Split length in blocks</p></a></li>
<li><a href='#split_parapply'><p>Split-parApply-Combine</p></a></li>
<li><a href='#split_vec'><p>Split object in blocks</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Easy Parallel Tools</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Utility functions for easy parallelism in R. Include some reexports
    from other packages, utility functions for splitting and parallelizing over
    blocks, and choosing and setting the number of cores used.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>bigassertr (&ge; 0.1.1), doParallel, flock, parallel,
parallelly, RhpcBLASctl</td>
</tr>
<tr>
<td>Depends:</td>
<td>foreach</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, covr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/privefl/bigparallelr">https://github.com/privefl/bigparallelr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/privefl/bigparallelr/issues">https://github.com/privefl/bigparallelr/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-10-02 15:48:23 UTC; au639593</td>
</tr>
<tr>
<td>Author:</td>
<td>Florian Privé [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Florian Privé &lt;florian.prive.21@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-10-02 16:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bigparallelr-package'>bigparallelr: Easy Parallel Tools</h2><span id='topic+bigparallelr'></span><span id='topic+bigparallelr-package'></span>

<h3>Description</h3>

<p>Utility functions for easy parallelism in R. Include some reexports
from other packages, utility functions for splitting and parallelizing over
blocks, and choosing and setting the number of cores used.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Florian Privé <a href="mailto:florian.prive.21@gmail.com">florian.prive.21@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/privefl/bigparallelr">https://github.com/privefl/bigparallelr</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/privefl/bigparallelr/issues">https://github.com/privefl/bigparallelr/issues</a>
</p>
</li></ul>


<hr>
<h2 id='assert_cores'>Check number of cores</h2><span id='topic+assert_cores'></span>

<h3>Description</h3>

<p>Check that you are not trying to use too many cores.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assert_cores(ncores)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="assert_cores_+3A_ncores">ncores</code></td>
<td>
<p>Number of cores to check. Make sure is not larger than
<code>getOption("bigstatsr.ncores.max")</code> (number of logical cores by default).
We advise you to use <code>nb_cores()</code>. If you really know what you are doing,
you can change this default value with <code>options(bigstatsr.ncores.max = Inf)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It also checks if two levels of parallelism are used, i.e. having <code>ncores</code>
larger than 1, and having a parallel BLAS enabled by default.
You could remove this check by setting
<code>options(bigstatsr.check.parallel.blas = FALSE)</code>.
</p>
<p>We instead recommend that you disable parallel BLAS by default by adding
<code>try(bigparallelr::set_blas_ncores(1), silent = TRUE)</code> to your .Rprofile
(<strong>with an empty line at the end of this file</strong>) so that this is set whenever
you start a new R session. You can use <code>usethis::edit_r_profile()</code> to open
your .Rprofile. For this to be effective, you should restart the R session or
run <code>options(default.nproc.blas = NULL)</code> once in the current session.
</p>
<p>Then, in a specific R session, you can set a different number of cores to use
for matrix computations using <code>bigparallelr::set_blas_ncores()</code>, if you know
there is no other level of parallelism involved in your code.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

assert_cores(2)

## End(Not run)

</code></pre>

<hr>
<h2 id='get_blas_ncores'>Number of cores used by BLAS (matrix computations)</h2><span id='topic+get_blas_ncores'></span><span id='topic+set_blas_ncores'></span>

<h3>Description</h3>

<p>Number of cores used by BLAS (matrix computations)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_blas_ncores()

set_blas_ncores(ncores)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_blas_ncores_+3A_ncores">ncores</code></td>
<td>
<p>Number of cores to set for BLAS.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>get_blas_ncores()
</code></pre>

<hr>
<h2 id='nb_cores'>Recommended number of cores to use</h2><span id='topic+nb_cores'></span>

<h3>Description</h3>

<p>This is base on the following rule: use only physical cores and if you have
only physical cores, leave one core for the OS/UI.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nb_cores()
</code></pre>


<h3>Value</h3>

<p>The recommended number of cores to use.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nb_cores()
</code></pre>

<hr>
<h2 id='plus'>Add</h2><span id='topic+plus'></span>

<h3>Description</h3>

<p>Wrapper around <code>Reduce</code> to add multiple arguments. Useful
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plus(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plus_+3A_...">...</code></td>
<td>
<p>Multiple arguments to be added together.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>Reduce('+', list(...))</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plus(1:3, 4:6, 1:3)
</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+makeCluster'></span><span id='topic+stopCluster'></span><span id='topic+registerDoParallel'></span><span id='topic+lock'></span><span id='topic+unlock'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>doParallel</dt><dd><p><code><a href="doParallel.html#topic+registerDoParallel">registerDoParallel</a></code></p>
</dd>
<dt>flock</dt><dd><p><code><a href="flock.html#topic+lock">lock</a></code>, <code><a href="flock.html#topic+unlock">unlock</a></code></p>
</dd>
<dt>parallel</dt><dd><p><code><a href="parallel.html#topic+makeCluster">makeCluster</a></code>, <code><a href="parallel.html#topic+makeCluster">stopCluster</a></code></p>
</dd>
</dl>

<hr>
<h2 id='register_parallel'>Register parallel</h2><span id='topic+register_parallel'></span>

<h3>Description</h3>

<p>Register parallel in functions. Do <code><a href="#topic+makeCluster">makeCluster()</a></code>, <code><a href="#topic+registerDoParallel">registerDoParallel()</a></code>
and <code><a href="#topic+stopCluster">stopCluster()</a></code> when the function returns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>register_parallel(ncores, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="register_parallel_+3A_ncores">ncores</code></td>
<td>
<p>Number of cores to use. If using only one, then this function
uses <code><a href="foreach.html#topic+registerDoSEQ">foreach::registerDoSEQ()</a></code>.</p>
</td></tr>
<tr><td><code id="register_parallel_+3A_...">...</code></td>
<td>
<p>Arguments passed on to <code><a href="#topic+makeCluster">makeCluster()</a></code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

test &lt;- function(ncores) {
  register_parallel(ncores)
  foreach(i = 1:2) %dopar% i
}

test(2)  # only inside the function
foreach(i = 1:2) %dopar% i

## End(Not run)

</code></pre>

<hr>
<h2 id='rows_along'>Sequence generation</h2><span id='topic+rows_along'></span><span id='topic+cols_along'></span><span id='topic+seq_range'></span>

<h3>Description</h3>


<ul>
<li> <p><code>rows_along(x)</code>: <code>seq_len(nrow(x))</code>
</p>
</li>
<li> <p><code>cols_along(x)</code>: <code>seq_len(ncol(x))</code>
</p>
</li>
<li> <p><code>seq_range(lims)</code>: <code>seq(lims[1], lims[2])</code>
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>rows_along(x)

cols_along(x)

seq_range(lims)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rows_along_+3A_x">x</code></td>
<td>
<p>Any object on which you can call <code>nrow()</code> and <code>ncol()</code>.</p>
</td></tr>
<tr><td><code id="rows_along_+3A_lims">lims</code></td>
<td>
<p>Vector of size 2 (or more, but only first 2 values will be used).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- matrix(1:6, 2, 3)
dim(X)
rows_along(X)
cols_along(X)

seq_range(c(3, 10))

</code></pre>

<hr>
<h2 id='split_costs'>Split costs in blocks</h2><span id='topic+split_costs'></span>

<h3>Description</h3>

<p>Split costs in consecutive blocks using a greedy algorithm that tries to
find blocks of even total cost.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>split_costs(costs, nb_split)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="split_costs_+3A_costs">costs</code></td>
<td>
<p>Vector of costs (e.g. proportional to computation time).</p>
</td></tr>
<tr><td><code id="split_costs_+3A_nb_split">nb_split</code></td>
<td>
<p>Number of blocks.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with 4 columns <code>lower</code>, <code>upper</code>, <code>size</code> and <code>cost</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>split_costs(costs = 150:1, nb_split = 3)
split_costs(costs = rep(1, 151), nb_split = 3)
split_costs(costs = 150:1, nb_split = 30)

</code></pre>

<hr>
<h2 id='split_len'>Split length in blocks</h2><span id='topic+split_len'></span>

<h3>Description</h3>

<p>Split length in blocks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>split_len(total_len, block_len, nb_split = ceiling(total_len/block_len))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="split_len_+3A_total_len">total_len</code></td>
<td>
<p>Length to split.</p>
</td></tr>
<tr><td><code id="split_len_+3A_block_len">block_len</code></td>
<td>
<p>Maximum length of each block.</p>
</td></tr>
<tr><td><code id="split_len_+3A_nb_split">nb_split</code></td>
<td>
<p>Number of blocks. Default uses the other 2 parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with 3 columns <code>lower</code>, <code>upper</code> and <code>size</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>split_len(10, block_len = 3)
split_len(10, nb_split = 3)

</code></pre>

<hr>
<h2 id='split_parapply'>Split-parApply-Combine</h2><span id='topic+split_parapply'></span>

<h3>Description</h3>

<p>A Split-Apply-Combine strategy to parallelize the evaluation of a function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>split_parapply(
  FUN,
  ind,
  ...,
  .combine = NULL,
  ncores = nb_cores(),
  nb_split = ncores,
  opts_cluster = list(),
  .costs = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="split_parapply_+3A_fun">FUN</code></td>
<td>
<p>The function to be applied to each subset matrix.</p>
</td></tr>
<tr><td><code id="split_parapply_+3A_ind">ind</code></td>
<td>
<p>Initial vector of indices that will be splitted in <code>nb_split</code>.</p>
</td></tr>
<tr><td><code id="split_parapply_+3A_...">...</code></td>
<td>
<p>Extra arguments to be passed to <code>FUN</code>.</p>
</td></tr>
<tr><td><code id="split_parapply_+3A_.combine">.combine</code></td>
<td>
<p>Function to combine the results with <code>do.call</code>.
This function should accept multiple arguments (using <code>...</code>). For example,
you can use <code>c</code>, <code>cbind</code> and <code>rbind</code>. This package also provides function
<code>plus</code> to add multiple arguments together. The default is <code>NULL</code>, in which
case the results are not combined and are returned as a list, each element
being the result of a block.</p>
</td></tr>
<tr><td><code id="split_parapply_+3A_ncores">ncores</code></td>
<td>
<p>Number of cores to use. Default uses <code>nb_cores()</code>.</p>
</td></tr>
<tr><td><code id="split_parapply_+3A_nb_split">nb_split</code></td>
<td>
<p>Number of blocks. Default uses <code>ncores</code>.</p>
</td></tr>
<tr><td><code id="split_parapply_+3A_opts_cluster">opts_cluster</code></td>
<td>
<p>Optional parameters for clusters passed as a named list.
E.g., you can use <code>type = "FORK"</code> to use forks instead of clusters.
You can also use <code>outfile = ""</code> to redirect printing to the console.</p>
</td></tr>
<tr><td><code id="split_parapply_+3A_.costs">.costs</code></td>
<td>
<p>Vector of costs (e.g. proportional to computation time)
associated with each element of <code>ind</code>. Default is <code>NULL</code> (same cost).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function splits indices in parts, then apply a given function to each
part and finally combine the results.
</p>


<h3>Value</h3>

<p>Return a list of <code>ncores</code> elements, each element being the result of
one of the cores, computed on a block. The elements of this list are then
combined with <code>do.call(.combine, .)</code> if <code>.combined</code> is not <code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

str(
  split_parapply(function(ind) {
    sqrt(ind)
  }, ind = 1:10000, ncores = 2)
)

## End(Not run)

</code></pre>

<hr>
<h2 id='split_vec'>Split object in blocks</h2><span id='topic+split_vec'></span><span id='topic+split_df'></span>

<h3>Description</h3>

<p>Split object in blocks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>split_vec(x, block_len, nb_split = ceiling(length(x)/block_len))

split_df(df, block_len, nb_split = ceiling(nrow(df)/block_len))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="split_vec_+3A_x">x</code></td>
<td>
<p>Vector to be divided into groups.</p>
</td></tr>
<tr><td><code id="split_vec_+3A_block_len">block_len</code></td>
<td>
<p>Maximum length (or number of rows) of each block.</p>
</td></tr>
<tr><td><code id="split_vec_+3A_nb_split">nb_split</code></td>
<td>
<p>Number of blocks. Default uses the other 2 parameters.</p>
</td></tr>
<tr><td><code id="split_vec_+3A_df">df</code></td>
<td>
<p>Data frame to be divided into groups.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the splitted objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>split_vec(1:10, block_len = 3)
str(split_df(iris, nb_split = 3))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
