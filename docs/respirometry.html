<!DOCTYPE html><html lang="en"><head><title>Help for package respirometry</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {respirometry}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#respirometry'><p>Tools for Conducting Respirometry Experiments</p></a></li>
<li><a href='#adj_by_temp'><p>Predict biological parameters at a new temperature</p></a></li>
<li><a href='#calc_alpha'><p>Calculate the oxygen supply capacity (alpha)</p></a></li>
<li><a href='#calc_b'><p>Calculate the metabolic scaling coefficient, b</p></a></li>
<li><a href='#calc_E'><p>Calculate E temperature coefficient</p></a></li>
<li><a href='#calc_MO2'><p>Calculate metabolic rate</p></a></li>
<li><a href='#calc_pcrit'><p>Calculate Pcrit</p></a></li>
<li><a href='#closed'><p>Closed respirometry</p></a></li>
<li><a href='#co2_add'><p>Calculate CO2 to add to water</p></a></li>
<li><a href='#co2_flush'><p>Calculate CO2 to add to flush reservoir</p></a></li>
<li><a href='#co2_rate'><p>Calculate CO2 to add to a respirometer intake flow</p></a></li>
<li><a href='#conv_nh4'><p>Convert between units of ammonia (NH3) / ammonium (NH4+)</p></a></li>
<li><a href='#conv_o2'><p>Convert between units of oxygen partial pressure and concentration</p></a></li>
<li><a href='#conv_resp_unit'><p>Convert units related to respirometry</p></a></li>
<li><a href='#correct_bubble'><p>Adjust respirometer volume for bubbles</p></a></li>
<li><a href='#flush_carb'><p>Estimate carbonate chemistry after a flush</p></a></li>
<li><a href='#flush_o2'><p>Estimate dissolved O2 after a flush</p></a></li>
<li><a href='#flush_water'><p>Find percent of water exchanged after a flush</p></a></li>
<li><a href='#goal_flush_pH'><p>Calculate goal pH of a flush reservoir to achieve the post-flush goal pCO2</p></a></li>
<li><a href='#guess_TA'><p>Estimate total alkalinity from salinity</p></a></li>
<li><a href='#guess_when'><p>Estimate when the O2 level will reach a defined level</p></a></li>
<li><a href='#import_firesting'><p>Import data from Pyro Oxygen Logger</p></a></li>
<li><a href='#import_presens'><p>Import data from a PreSens O2 transmitter</p></a></li>
<li><a href='#import_pyroscience_workbench'><p>Import data from Pyroscience Workbench</p></a></li>
<li><a href='#import_witrox'><p>Import data from a Loligo Systems Witrox O2 transmitter</p></a></li>
<li><a href='#make_bins'><p>Make time binning thresholds for MO2 calculations</p></a></li>
<li><a href='#max_MO2'><p>Maximum MO2 supported by flow rate</p></a></li>
<li><a href='#mean_pH'><p>Mean pH by [H+]</p></a></li>
<li><a href='#min_flow'><p>Minimum flow rate to support MO2</p></a></li>
<li><a href='#peri_pump'><p>Calculate peristaltic pump gaseous flow rate</p></a></li>
<li><a href='#plot_pcrit'><p>Plot Pcrit</p></a></li>
<li><a href='#predict_nh3'><p>Predict NH3 / NH4+ concentration post-respiration</p></a></li>
<li><a href='#predict_pH'><p>Predict pH post-respiration</p></a></li>
<li><a href='#Q10'><p>Parameters of Q10 Temperature Coefficient</p></a></li>
<li><a href='#RQ'><p>Calculate respiratory quotient</p></a></li>
<li><a href='#scale_MO2'><p>Mass-correct metabolic rate</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools for Conducting and Analyzing Respirometry Experiments</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-11-22</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides tools to enable the researcher to more precisely conduct
    respirometry experiments. Strong emphasis is on aquatic respirometry. Tools
    focus on helping the researcher setup and conduct experiments. Functions for
    analysis of resulting respirometry data are also provided. This package
    provides tools for intermittent, flow-through, and closed respirometry
    techniques.</td>
</tr>
<tr>
<td>Imports:</td>
<td>birk, dplyr, graphics, lubridate, marelac, measurements (&ge;
1.1.0), methods, minpack.lm, plyr, rlang, seacarb (&ge; 3.1),
segmented (&ge; 1.0-0), stats, utils</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-11-22 19:34:48 UTC; matthewbirk</td>
</tr>
<tr>
<td>Author:</td>
<td>Matthew A. Birk <a href="https://orcid.org/0000-0003-0407-4077"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matthew A. Birk &lt;matthewabirk@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-11-22 20:30:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='respirometry'>Tools for Conducting Respirometry Experiments</h2><span id='topic+respirometry-package'></span><span id='topic+respirometry'></span>

<h3>Description</h3>

<p>Provides tools to enable the researcher to more precisely conduct respirometry experiments. Strong emphasis is on aquatic respirometry. Tools focus on helping the researcher setup and conduct experiments. Analysis of the resulting data is not a focus since analyses are often specific to a particular setup, and thus are better created by the researcher individually. This package provides tools for intermittent, flow-through, and closed respirometry techniques.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>

<hr>
<h2 id='adj_by_temp'>Predict biological parameters at a new temperature</h2><span id='topic+adj_by_temp'></span>

<h3>Description</h3>

<p>Predicts the values of any inputted biological parameter (e.g. MO2, Pcrit) at a new temperature based on empirical measurements at a range of temperatures. Data can be fit to a temperature-dependence curve using either <code><a href="#topic+Q10">Q10</a></code> or <code><a href="#topic+calc_E">calc_E</a></code>. By default, the predicted values are also plotted alongside the inputted data to allow the user to assess the quality of the fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adj_by_temp(
  meas_temp,
  meas_x,
  temp_new,
  method = "Q10",
  Q10,
  E,
  show_coef = FALSE,
  plot_fit = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="adj_by_temp_+3A_meas_temp">meas_temp</code></td>
<td>
<p>a vector of temperature values (°C) corresponding to <code>meas_x</code>.</p>
</td></tr>
<tr><td><code id="adj_by_temp_+3A_meas_x">meas_x</code></td>
<td>
<p>a vector of biological values (e.g. MO2, Pcrit) corresponding to <code>meas_temp</code>. These are typically empirically derived.</p>
</td></tr>
<tr><td><code id="adj_by_temp_+3A_temp_new">temp_new</code></td>
<td>
<p>a vector of temperature values (°C) at which new values of &quot;x&quot; should be predicted.</p>
</td></tr>
<tr><td><code id="adj_by_temp_+3A_method">method</code></td>
<td>
<p>which method for calculcating temperature-dependency should be used? Options are &quot;Q10&quot; (default) and &quot;E&quot;. If either <code>Q10</code> or <code>E</code> parameters have values, then this parameter is ignored.</p>
</td></tr>
<tr><td><code id="adj_by_temp_+3A_q10">Q10</code></td>
<td>
<p>(optional). A Q10 value to be used for predicting new values of &quot;x&quot;. If <code>method = "Q10"</code> and Q10 is not defined here, then an appropriate Q10 value will be calculated internally using <code><a href="#topic+Q10">Q10</a></code>.</p>
</td></tr>
<tr><td><code id="adj_by_temp_+3A_e">E</code></td>
<td>
<p>(optional). An E value to be used for predicting new values of &quot;x&quot;. If <code>method = "E"</code> and E is not defined here, then an appropriate E value will be calculated internally using <code><a href="#topic+calc_E">calc_E</a></code>.</p>
</td></tr>
<tr><td><code id="adj_by_temp_+3A_show_coef">show_coef</code></td>
<td>
<p>logical. Should the temperature-dependency coefficient (i.e. the numeric value of either Q10 or E) be returned alongside the new values of &quot;x&quot;? Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="adj_by_temp_+3A_plot_fit">plot_fit</code></td>
<td>
<p>logical. Should a plot be displayed showing how well the new &quot;x&quot; values fit with the inputted data? Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>show_coef = FALSE</code> (default), then a numeric vector of new values of &quot;x&quot; are returned.
If <code>show_coef = TRUE</code>, then a list of new values and the temperature-dependency coefficient are returned.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Q10">Q10</a></code>, <code><a href="#topic+calc_E">calc_E</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># I measured Pcrit at four different temperatures. What is the Pcrit at an
# intermediate temperature?
adj_by_temp(meas_temp = c(5, 10, 15, 20), meas_x = c(3.1, 6.3, 7, 8.4), temp_new = 18)

# If requested values exceed the inputted temperature range, a message is reported.
# Biology cannot go on forever like the math can.
adj_by_temp(meas_temp = c(10, 15, 20, 25), meas_x = c(4.8, 6, 12.3, 13.6), temp_new = 0:30)

</code></pre>

<hr>
<h2 id='calc_alpha'>Calculate the oxygen supply capacity (alpha)</h2><span id='topic+calc_alpha'></span>

<h3>Description</h3>

<p>The oxygen supply capacity (<code class="reqn">\alpha</code>) is a species- and temperature-specific value quantifying an animal's ability to extract oxygen from the ambient medium to support its metabolism (e.g. umol O2 / g / hr / kPa). This function calculates <code class="reqn">\alpha</code> based on the single highest <code class="reqn">\alpha0</code> (MO2/PO2) value in the dataset. If there are outliers that make this prohibitive, consider setting a threshold MO2 value with <code>mo2_threshold</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_alpha(po2, mo2, avg_top_n = 1, MR = NULL, mo2_threshold = Inf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_alpha_+3A_po2">po2</code></td>
<td>
<p>a vector of PO2 values.</p>
</td></tr>
<tr><td><code id="calc_alpha_+3A_mo2">mo2</code></td>
<td>
<p>a vector of metabolic rate values. Must be the same length and corresponding to <code>po2</code>.</p>
</td></tr>
<tr><td><code id="calc_alpha_+3A_avg_top_n">avg_top_n</code></td>
<td>
<p>a numeric value representing the number of top <code class="reqn">\alpha0</code> (MO2/PO2) values to average together to estimate <code class="reqn">\alpha</code>. Default is 1. When analyzing a trial where the animal was not at MMR the whole time, we recommend no more than 3 to avoid diminishing the <code class="reqn">\alpha</code> value with sub-maximal observations. If all observations are believed to be at maximal O2 supply capacity, <code>Inf</code> can be used to average all observations.</p>
</td></tr>
<tr><td><code id="calc_alpha_+3A_mr">MR</code></td>
<td>
<p>a vector of values for the metabolic rate at which <code>pcrit_alpha</code> should be returned. Default is <code>NULL</code>. If not specified, then <code>pcrit_alpha</code> is not returned and a message is added to the top of the return.</p>
</td></tr>
<tr><td><code id="calc_alpha_+3A_mo2_threshold">mo2_threshold</code></td>
<td>
<p>a single numeric value above which <code>mo2</code> values are ignored. Useful to removing obviously erroneous values. Default is <code>Inf</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of 1) alpha, 2) a list of the PO2, MO2, and alpha0 value(s) where alpha was reached (the number of observations averaged is set by <code>avg_top_n</code>), and 3) the Pcrit at a metabolic rate of <code>MR</code>.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>References</h3>

<p>Seibel, B. A., A. Andres, M. A. Birk, A. L. Burns, C. T. Shaw, A. W. Timpe, C. J. Welsh. 2021. “Oxygen supply capacity breathes new life into the critical oxygen partial pressure (Pcrit).” Journal of Experimental Biology.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_pcrit">calc_pcrit</a></code>, <code><a href="#topic+plot_pcrit">plot_pcrit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mo2_data &lt;- read.csv(system.file('extdata', 'mo2_v_po2.csv', package = 'respirometry'))
calc_alpha(po2 = mo2_data$po2, mo2 = mo2_data$mo2, MR = 1.5) # MR set to 1.5 to capture the 
# Pcrit corresponding to some of the lowest MO2 values recorded (something close to SMR).

# extract the alpha0 values that were averaged together
sapply(calc_alpha(po2 = mo2_data$po2, mo2 = mo2_data$mo2, 
  MR = 1.5, avg_top_n = 3)$alpha_obs, function(i) i[3])

</code></pre>

<hr>
<h2 id='calc_b'>Calculate the metabolic scaling coefficient, b</h2><span id='topic+calc_b'></span>

<h3>Description</h3>

<p>For most organisms, metabolic rate does not scale linearly, but rather according to a power function: <code class="reqn">MO2 = b0 * M^b</code>. This function estimates the scaling coefficient, <code>b</code>, and normalization constant, <code>b0</code>, given MO2s from different sized individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_b(mass, MO2, method = "nls", plot = "linear", b0_start = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_b_+3A_mass">mass</code></td>
<td>
<p>a vector of animal masses.</p>
</td></tr>
<tr><td><code id="calc_b_+3A_mo2">MO2</code></td>
<td>
<p>a vector of metabolic rates.</p>
</td></tr>
<tr><td><code id="calc_b_+3A_method">method</code></td>
<td>
<p>a string defining which method of calculating scaling coefficients to use. Default is &quot;nls&quot;, which utilizes a nonlinear least squares regression. If this does not fit your data well, &quot;lm&quot; may also be used, which calculates a linear regression of log10(<code>MO2</code>) ~ log10(<code>mass</code>) with slope and intercept equivalent to <code>b</code> and 10^<code>b0</code>, respectively.</p>
</td></tr>
<tr><td><code id="calc_b_+3A_plot">plot</code></td>
<td>
<p>a string defining what kind of plot to display. &quot;linear&quot; for linear axes, &quot;log&quot; for log10-scale axes, and &quot;none&quot; for no plot. Default is &quot;linear&quot;.</p>
</td></tr>
<tr><td><code id="calc_b_+3A_b0_start">b0_start</code></td>
<td>
<p>a single numeric value as the starting point for <code>b0</code> value determination using the &quot;nls&quot; method. The default is <code>1</code> and should work for most situations, but if the &quot;nls&quot; method is not working and you don't want to use the &quot;lm&quot; method, changing the starting <code>b0</code> value may help. Ignored when method = &quot;lm&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">MO2 = b0 * M^b</code>
</p>

<p>where <code>b0</code> is species-specific normalization constant, <code>M</code> is mass and <code>b</code> is the scaling coefficient.
</p>


<h3>Value</h3>

<p>Returns a list of 1) the <code>b</code> value, 2) a vector of <code>b0</code> values corresponding to the input <code>MO2</code> values, and 3) an average <code>b0</code> that can be used for summarizing the relationship with an equation.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scale_MO2">scale_MO2</a></code>, <code><a href="#topic+calc_MO2">calc_MO2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simple example
mass &lt;- c(1, 10, 100, 1000, 40, 4, 400, 60, 2, 742, 266, 983) # made up values
MO2 &lt;- mass ^ 0.65 + rnorm(n = length(mass)) # make up some data
calc_b(mass = mass, MO2 = MO2)

# How about some mass-specific MO2s?
msMO2 &lt;- mass ^ -0.25 + rnorm(n = length(mass), sd = 0.05)
calc_b(mass = mass, MO2 = msMO2)
calc_b(mass = mass, MO2 = msMO2, plot = "log")

</code></pre>

<hr>
<h2 id='calc_E'>Calculate E temperature coefficient</h2><span id='topic+calc_E'></span>

<h3>Description</h3>

<p>An E value is a relatively recent metric to parameterize the temperature-sensitivity of a biological rate (MO2). It is similar conceptually (but not numerically) to Q10.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_E(x, temp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_E_+3A_x">x</code></td>
<td>
<p>a numeric vector of rate values (e.g. MO2) or any other values (e.g. Pcrit).</p>
</td></tr>
<tr><td><code id="calc_E_+3A_temp">temp</code></td>
<td>
<p>a numeric vector of temperature values (in Celsius).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>E is the slope of the relationship between <code>-ln(x)</code> and <code>1/(kB T)</code>, where <code>kB</code> is the Boltzmann constant expressed in eV/K.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>References</h3>

<p>Deutsch, Curtis et al. 2015. “Climate Change Tightens a Metabolic Constraint on Marine Habitats.” Science 348(6239): 1132–35.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Q10">Q10</a></code>, <code><a href="#topic+adj_by_temp">adj_by_temp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>calc_E(x = c(1, 2, 3), temp = c(10, 20, 30))

</code></pre>

<hr>
<h2 id='calc_MO2'>Calculate metabolic rate</h2><span id='topic+calc_MO2'></span><span id='topic+calc_mo2'></span>

<h3>Description</h3>

<p>Calculates metabolic rate (MO2) given O2 measurements over time. Oxygen measurements are split into bins and MO2s are calculated from each bin (unless <code>bin_width</code> is set to <code>0</code>). The <code>bin_width</code> parameter defines the width of the bins in timed intervals (e.g. 15 minutes). Linear regressions are fit through each bin and the calculated MO2 is returned as the slope of the change in O2 over time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_MO2(
  duration,
  o2,
  o2_unit = "percent_a.s.",
  bin_width,
  vol,
  temp = 25,
  sal = 35,
  atm_pres = 1013.25,
  time,
  pH,
  good_data = TRUE
)

calc_mo2(
  duration,
  o2,
  o2_unit = "percent_a.s.",
  bin_width,
  vol,
  temp = 25,
  sal = 35,
  atm_pres = 1013.25,
  time,
  pH,
  good_data = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_MO2_+3A_duration">duration</code></td>
<td>
<p>numeric vector of the timepoint for each observation (minutes).</p>
</td></tr>
<tr><td><code id="calc_MO2_+3A_o2">o2</code></td>
<td>
<p>numeric vector of O2 observations.</p>
</td></tr>
<tr><td><code id="calc_MO2_+3A_o2_unit">o2_unit</code></td>
<td>
<p>a string describing the unit used to measure <code>o2</code>. Default is &quot;percent_a.s.&quot; Options are from <code><a href="#topic+conv_o2">conv_o2</a></code>.</p>
</td></tr>
<tr><td><code id="calc_MO2_+3A_bin_width">bin_width</code></td>
<td>
<p>numeric or data frame. </p>

<dl>
<dt>OPTION 1: </dt><dd><p>A single number defining how long of a period should be binned for each MO2 determination (minutes). If MO2 is to be calculated from one observation to the next (rather than binned observations), set <code>bin_width</code> to 0. To calculate a single MO2 value from all observations, set <code>bin_width</code> to <code>Inf</code>.</p>
</dd>
<dt>OPTION 2: </dt><dd><p>A data frame with two numeric columns: &quot;o2&quot; and &quot;width&quot;. Useful for Pcrit calculations or another application where bins of different widths are desired at different PO2s. The data frame can be generated automatically by <code><a href="#topic+make_bins">make_bins</a></code> or manually by the user. For each row, set the &quot;width&quot; value to the bin duration (minutes) desired for observations &gt;= the value in the &quot;o2&quot; column but &lt; the next greater O2 value in another row.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="calc_MO2_+3A_vol">vol</code></td>
<td>
<p>volume of the respirometer (liter).</p>
</td></tr>
<tr><td><code id="calc_MO2_+3A_temp">temp</code></td>
<td>
<p>temperature (°C). Default is 25 °C.</p>
</td></tr>
<tr><td><code id="calc_MO2_+3A_sal">sal</code></td>
<td>
<p>salinity (psu). Default is 35 psu.</p>
</td></tr>
<tr><td><code id="calc_MO2_+3A_atm_pres">atm_pres</code></td>
<td>
<p>atmospheric pressure (mbar). Default is 1013.25 mbar.</p>
</td></tr>
<tr><td><code id="calc_MO2_+3A_time">time</code></td>
<td>
<p>(optional). Numeric vector of timestamp observations.</p>
</td></tr>
<tr><td><code id="calc_MO2_+3A_ph">pH</code></td>
<td>
<p>(optional). Numeric vector of pH observations.</p>
</td></tr>
<tr><td><code id="calc_MO2_+3A_good_data">good_data</code></td>
<td>
<p>logical vector of whether O2 observations are &quot;good&quot; measurements and should be included in analysis. Linear regressions will not be fit over bins that include &quot;bad&quot; data. Bins will be split at bad data points. Default is that all observations are <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame is returned:
</p>

<dl>
<dt>DUR_MEAN</dt><dd><p>Mean duration of the bin (minutes).</p>
</dd>
<dt>DUR_RANGE</dt><dd><p>Range of duration timepoints in the bin.</p>
</dd>
<dt>TIME_MEAN</dt><dd><p>Exists only if the parameter <code>time</code> has values. Mean timestamp of the bin.</p>
</dd>
<dt>TIME_RANGE</dt><dd><p>Exists only if the parameter <code>time</code> has values. Range of timestamps in the bin.</p>
</dd>
<dt>TEMP_MEAN</dt><dd><p>Mean temperature of the bin.</p>
</dd>
<dt>PH_MEAN</dt><dd><p>Exists only if the parameter <code>pH</code> has values. Mean pH of the bin. Averaged using <code>mean_pH()</code>.</p>
</dd>
<dt>O2_MEAN</dt><dd><p>Mean O2 value of the bin in the unit chosen by <code>o2_unit</code>).</p>
</dd>
<dt>O2_RANGE</dt><dd><p>Range of O2 values in the bin.</p>
</dd>
<dt>MO2</dt><dd><p>Metabolic rate (umol O2 / hour).</p>
</dd>
<dt>R2</dt><dd><p>Coefficient of determination for the linear regression fit to calculate MO2.</p>
</dd>
<dt>N</dt><dd><p>Number of observations in the bin.</p>
</dd>
</dl>



<h3>Note</h3>

<p>Whole-animal MO2 is returned. If mass-specific MO2 is desired, the output from <code>calc_MO2</code> can be divided by the animal's mass.
No matter what unit of oxygen partial pressure or concentration measurement you put into the function as <code>o2_unit</code>, the output in the MO2 column is always expressed in umol O2 / hour. This is because there is a vast variety of units for which people prefer to report dissolved oxygen levels, but most physiologists are at least unified in reporting metabolic rate as umol O2 per hour. If you prefer to report MO2 as mg O2 per hour, for example, you can always do something like:
<code>conv_resp_unit(df$MO2, from = 'umol_O2 / hr', 'mg_O2 / hr')</code>
If only beginning and ending O2 observations are known, consider using <code><a href="#topic+closed">closed</a></code>. Both functions will work fine, but <code><a href="#topic+closed">closed</a></code> is simpler.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+make_bins">make_bins</a></code>, <code><a href="#topic+calc_b">calc_b</a></code>, <code><a href="#topic+closed">closed</a></code>, <code><a href="#topic+scale_MO2">scale_MO2</a></code>, <code><a href="#topic+conv_resp_unit">conv_resp_unit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get O2 data
file &lt;- system.file('extdata', 'witrox_file.txt', package = 'respirometry')
o2_data &lt;- na.omit(import_witrox(file, split_channels = TRUE)$CH_4)

# calculate MO2
(mo2_5_min &lt;- calc_MO2(duration = o2_data$DURATION, o2 = o2_data$O2,
bin_width = 5, vol = 10, temp = o2_data$TEMP, sal = o2_data$SAL))

# what if measurements from the 10 to 12 minute marks can't be trusted?
bad_data = o2_data$DURATION &gt;= 10 &amp; o2_data$DURATION &lt;= 12
(mo2_5_min &lt;- calc_MO2(duration = o2_data$DURATION, o2 = o2_data$O2,
bin_width = 5, vol = 10, temp = o2_data$TEMP, sal = o2_data$SAL, good_data = !bad_data))

# easily make a Pcrit plot
plot(mo2_5_min$O2_MEAN, mo2_5_min$MO2)

# I want to express MO2 in mg per min instead.
(mo2_5_min$MO2 &lt;- conv_resp_unit(value = mo2_5_min$MO2, from = 'umol_O2 / hr', to = 'mg_O2 / min'))

# just endpoint measurement:
calc_MO2(duration = o2_data$DURATION, o2 = o2_data$O2,
bin_width = Inf, vol = 10, temp = o2_data$TEMP, sal = o2_data$SAL)

# In my trial, observations above 77% air saturation were really noisy, but much less noisy at
# lower O2 values. I want to adjust my bin width based on the PO2 to obtain the best balance of
# resolution and precision throughout the whole trial. Below 77% a.s., use 4 minute bins. Above
# 77% a.s. use 10 minute bins.
bins = data.frame(o2 = c(77, 100), width = c(4, 10))
calc_MO2(duration = o2_data$DURATION, o2 = o2_data$O2,
bin_width = bins, vol = 10, temp = o2_data$TEMP, sal = o2_data$SAL)

</code></pre>

<hr>
<h2 id='calc_pcrit'>Calculate Pcrit</h2><span id='topic+calc_pcrit'></span>

<h3>Description</h3>

<p>Calculates Pcrit (commonly understood as the threshold below which oxygen consumption rate can no longer be sustained) based on paired PO2 and MO2 values. Five Pcrit metrics are returned using many of the popular techniques for Pcrit calculation: the traditional breakpoint metric (broken stick regression), the nonlinear regression metric (Marshall et al. 2013), the sub-prediction interval metric (Birk et al. 2019), the alpha-based Pcrit method (Seibel et al. 2021), and the linear low O2 (LLO) method (Reemeyer &amp; Rees 2019). To see the Pcrit values plotted, see <code><a href="#topic+plot_pcrit">plot_pcrit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_pcrit(
  po2,
  mo2,
  mo2_data,
  method = "Breakpoint",
  avg_top_n = 1,
  level = 0.95,
  iqr = 1.5,
  NLR_m = 0.065,
  MR = NULL,
  mo2_threshold = Inf,
  return_models = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_pcrit_+3A_po2">po2</code></td>
<td>
<p>a vector of PO2 values. Any unit of measurement should work, but the NLR calculation was optimized using kPa. If the NLR metric is giving you trouble, try converting to kPa using <code><a href="#topic+conv_o2">conv_o2</a></code>.</p>
</td></tr>
<tr><td><code id="calc_pcrit_+3A_mo2">mo2</code></td>
<td>
<p>a vector of metabolic rate values. Must be the same length and corresponding to <code>po2</code>.</p>
</td></tr>
<tr><td><code id="calc_pcrit_+3A_mo2_data">mo2_data</code></td>
<td>
<p>for convenience, the output of <code><a href="#topic+calc_MO2">calc_MO2</a></code> can be entered here, as an alternative to specifying the <code>po2</code> and <code>mo2</code> parameters (optional).</p>
</td></tr>
<tr><td><code id="calc_pcrit_+3A_method">method</code></td>
<td>
<p>Over the years, many different methods of analysis have been proposed to quantify Pcrit. You must choose one of the following: Alpha, Breakpoint (default), LLO, NLR, Sub_PI, All. If in doubt, try &quot;All&quot;.</p>
</td></tr>
<tr><td><code id="calc_pcrit_+3A_avg_top_n">avg_top_n</code></td>
<td>
<p>applies to the <code>alpha</code> metric only (only when <code>method == "Alpha"</code> or <code>"All"</code>). A numeric value representing the number of top <code class="reqn">\alpha0</code> (MO2/PO2) values to average together to estimate <code class="reqn">\alpha</code>. Default is 1. We recommend no more than 3 to avoid diminishing the <code class="reqn">\alpha</code> value with sub-maximal observations.</p>
</td></tr>
<tr><td><code id="calc_pcrit_+3A_level">level</code></td>
<td>
<p>applies to the <code>Sub_PI</code> metric only (only when <code>method == "Sub_PI"</code> or <code>"All"</code>). Percentage at which the prediction interval should be constructed. Default is 0.95.</p>
</td></tr>
<tr><td><code id="calc_pcrit_+3A_iqr">iqr</code></td>
<td>
<p>applies to the <code>Sub_PI</code> metric only (only when <code>method == "Sub_PI"</code> or <code>"All"</code>). Removes <code>mo2</code> observations that are this many interquartile ranges away from the mean value for the oxyregulating portion of the trial. If this filtering is not desired, set to infinity. To visualize which observations will be removed by this parameter, use <code><a href="#topic+plot_pcrit">plot_pcrit</a></code>. Default is 1.5.</p>
</td></tr>
<tr><td><code id="calc_pcrit_+3A_nlr_m">NLR_m</code></td>
<td>
<p>applies to the <code>NLR</code> metric only (only when <code>method == "NLR"</code> or <code>"All"</code>). Pcrit is defined as the PO2 at which the slope of the best fitting function equals <code>NLR_m</code> (after the MO2 data are normalized to the 90% quantile). Default is 0.065.</p>
</td></tr>
<tr><td><code id="calc_pcrit_+3A_mr">MR</code></td>
<td>
<p>applies to the <code>alpha</code> and <code>LLO</code> metrics only (only when <code>method == "Alpha", "LLO"</code> or <code>"All"</code>). A numeric value for the metabolic rate at which <code>pcrit_alpha</code> and <code>pcrit_LLO</code> should be returned. If not supplied by the user, then the mean MO2 of the &quot;oxyregulating&quot; portion of the curve is applied for <code>pcrit_alpha</code> and <code>NA</code> is returned for <code>pcrit_LLO</code>.</p>
</td></tr>
<tr><td><code id="calc_pcrit_+3A_mo2_threshold">mo2_threshold</code></td>
<td>
<p>applies to the <code>alpha</code> metric only (only when <code>method == "Alpha"</code> or <code>"All"</code>). A single numeric value above which <code>mo2</code> values are ignored for <code>alpha</code> Pcrit estimation. Useful to removing obviously erroneous values. Default is <code>Inf</code>.</p>
</td></tr>
<tr><td><code id="calc_pcrit_+3A_return_models">return_models</code></td>
<td>
<p>logical. Should a list of model parameters be returned along with the converged Pcrit values? Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<dl>
<dt>Alpha Pcrit</dt><dd><p>Alpha is calculated from <code><a href="#topic+calc_alpha">calc_alpha</a></code> and the Pcrit corresponding to <code>MR</code> is returned. This determine's the animal's oxygen supply capacity and calculates the Pcrit at any given metabolic rate of interest. If no <code>MR</code> is provided, then it defaults to the mean MO2 value from the oxyregulating portion of the curve (as defined by the broken-stick regression).</p>
</dd>
<dt>Breakpoint Pcrit</dt><dd><p>Data are fit to a broken-stick regression using <code><a href="segmented.html#topic+segmented">segmented</a></code>.</p>
</dd>
<dt>LLO Pcrit</dt><dd><p>A subset of observations are chosen only from those with an MO2 &lt; <code>MR</code>. Then, a linear model is fit through the observations and Pcrit is calculated as the PO2 at which the line reaches <code>MR</code>.</p>
</dd>
<dt>NLR Pcrit</dt><dd><p>Data are fit to the following functions: Michaelis-Menten, Power, Hyperbola, Pareto, and Weibull with intercept. Following the method developed by Marshall et al. 2013, the function that best fits the data (smallest AIC) is chosen and the Pcrit is determined as the PO2 at which the slope of the function is <code>NLR_m</code> (by default = 0.065 following the authors' suggestion).</p>
</dd>
<dt>Sub_PI Pcrit</dt><dd><p>This metric builds off the <code>Breakpoint</code> metric and results in a systematically lower Pcrit value. This is useful for applications where it is important to ensure that Pcrit is not being overestimated. It represents a reasonable lower bounded estimate of the Pcrit value for a given trial. Once the <code>Breakpoint</code> Pcrit is calculated, a 95% prediction interval (can be changed with the <code>level</code> argument) is calculated around the oxyregulating region (i.e. using PO2 values &gt; breakpoint Pcrit). By default, <code>iqr</code> provides some filtering of abberant observations to prevent their influence on the calculated prediction interval. Finally, the Sub_PI Pcrit value is returned at the intersection of the oxyconforming line and the lower limit of the oxyregulating prediction interval.</p>
</dd>
</dl>



<h3>Value</h3>

<p>If <code>return_models</code> is <code>FALSE</code> (default), a numeric Pcrit value is returned based on <code>method</code>. If <code>method == "All"</code>, a named numeric vector of Pcrit values calculated using the <code>Alpha</code>, <code>Breakpoint</code>, <code>LLO</code>, <code>NLR</code>, and <code>Sub_PI</code> metrics is returned. If <code>return_models</code> is <code>TRUE</code>, then a list of converged Pcrit values, along with breakpoint function parameters, the <code>MR</code> value used for calculating Pcrit-alpha, a data frame of the &quot;oxyregulating&quot; portion of the curve, and NLR parameters are returned.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>References</h3>

<p>Birk, Matthew A., K.A.S. Mislan, Karen F. Wishner, and Brad A. Seibel. 2019. “Metabolic Adaptations of the Pelagic Octopod Japetella Diaphana to Oxygen Minimum Zones.” Deep-Sea Research Part I 148: 123–31.
</p>
<p>Marshall, Dustin J., Michael Bode, and Craig R. White. 2013. “Estimating Physiological Tolerances - a Comparison of Traditional Approaches to Nonlinear Regression Techniques.” Journal of Experimental Biology 216(12): 2176–82.
</p>
<p>Reemeyer, Jessica E., and Bernard B. Rees. 2019. “Standardizing the Determination and Interpretation of Pcrit in Fishes.” Journal of Experimental Biology 222(18): jeb210633.
</p>
<p>Seibel, B. A., A. Andres, M. A. Birk, A. L. Burns, C. T. Shaw, A. W. Timpe, C. J. Welsh. 2021. “Oxygen supply capacity breathes new life into the critical oxygen partial pressure (Pcrit).” Journal of Experimental Biology.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_pcrit">plot_pcrit</a></code>, <code><a href="#topic+calc_MO2">calc_MO2</a></code>, <code><a href="#topic+conv_o2">conv_o2</a></code>, <code><a href="#topic+calc_alpha">calc_alpha</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>raw_data &lt;- system.file('extdata/pcrit_run/', package = 'respirometry')
o2_data &lt;- import_pyroscience_workbench(folder = raw_data)
mo2_data &lt;- calc_MO2(duration = o2_data$DURATION, o2 = o2_data$CH_1_O2, bin_width = 10, vol = 3)
calc_pcrit(mo2_data = mo2_data)
calc_pcrit(po2 = mo2_data$O2_MEAN, mo2 = mo2_data$MO2, method = 'All', MR = 100)
</code></pre>

<hr>
<h2 id='closed'>Closed respirometry</h2><span id='topic+closed'></span>

<h3>Description</h3>

<p>Returns the unknown parameter given 3 of 4 parameters to calculate respiration rate in a closed respirometer. This is useful both for basic closed respirometry setups, and also for the closed measurement phase of intermittent respirometry. Note that this is mainly useful for designing respirometry experiments. If you already have a timeseries dataset of oxygen measurements you want to analyze, use <code><a href="#topic+calc_MO2">calc_MO2</a></code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>closed(MO2, delta_pO2, duration, vol, temp = 25, sal = 35, atm_pres = 1013.25)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="closed_+3A_mo2">MO2</code></td>
<td>
<p>whole-animal oxygen consumption rate (umol O2 / hour).</p>
</td></tr>
<tr><td><code id="closed_+3A_delta_po2">delta_pO2</code></td>
<td>
<p>desired change in pO2 (% air saturation).</p>
</td></tr>
<tr><td><code id="closed_+3A_duration">duration</code></td>
<td>
<p>desired duration to reach <code>delta_pO2</code> (minutes).</p>
</td></tr>
<tr><td><code id="closed_+3A_vol">vol</code></td>
<td>
<p>volume of the respirometer (liter).</p>
</td></tr>
<tr><td><code id="closed_+3A_temp">temp</code></td>
<td>
<p>temperature (°C). Default is 25 °C.</p>
</td></tr>
<tr><td><code id="closed_+3A_sal">sal</code></td>
<td>
<p>salinity (psu). Default is 35 psu.</p>
</td></tr>
<tr><td><code id="closed_+3A_atm_pres">atm_pres</code></td>
<td>
<p>atmospheric pressure (mbar). Default is 1013.25 mbar.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If there are more than two O2 observations, consider using <code><a href="#topic+calc_MO2">calc_MO2</a></code>.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+flush_water">flush_water</a></code>, <code><a href="#topic+calc_MO2">calc_MO2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># I've read in the literature that my animal has an SMR of 200 umol/h. How large of a
# respirometer do I want if I want it to breathe down to 80% air saturation in 30 minutes?
closed(MO2 = 200, delta_pO2 = 100 - 80, duration = 30) # returns respirometer volume

# I've read in the literature that my animal has an SMR of 1000 umol/h. How long will it take to
# breathe down a 50 L respirometer by 10% air saturation?
closed(MO2 = 1000, delta_pO2 = 10, vol = 50) # returns the duration to breathe down the O2

# How does animal size affect how long my measurement periods last?
mass_range &lt;- seq(100, 400, 50)
dur_range &lt;- (closed(MO2 = scale_MO2(mass_1 = 100, MO2_1 = 400, mass_2 = mass_range),
 delta_pO2 = 20, vol = 10))
plot(mass_range, dur_range, type = 'b')

# What is the MO2 if O2 drops 0.44 mg/l in 33 minutes when the respirometer volume is 30 L?
closed(delta_pO2 = conv_o2(o2 = 0.44, from = 'mg_per_l', to = 'percent_a.s.'), duration = 33,
 vol = 30)

</code></pre>

<hr>
<h2 id='co2_add'>Calculate CO2 to add to water</h2><span id='topic+co2_add'></span>

<h3>Description</h3>

<p>Calculates the moles of CO2 gas to be added to a volume of seawater to achieve the desired pCO2. Useful for ocean acidification experiments where CO2 treatments are desired.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>co2_add(
  goal_pco2,
  start_pH,
  vol,
  temp = 25,
  sal = 35,
  TA = NULL,
  atm_pres = 1013.25
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="co2_add_+3A_goal_pco2">goal_pco2</code></td>
<td>
<p>the desired pCO2 in the water (uatm).</p>
</td></tr>
<tr><td><code id="co2_add_+3A_start_ph">start_pH</code></td>
<td>
<p>pH of the water before CO2 is added (total scale).</p>
</td></tr>
<tr><td><code id="co2_add_+3A_vol">vol</code></td>
<td>
<p>volume of the water (liter).</p>
</td></tr>
<tr><td><code id="co2_add_+3A_temp">temp</code></td>
<td>
<p>temperature (°C). Default is 25 °C.</p>
</td></tr>
<tr><td><code id="co2_add_+3A_sal">sal</code></td>
<td>
<p>salinity (psu). Default is 35 psu. If <code>sal</code> &lt; 26 psu, then <code>TA</code> must be provided.</p>
</td></tr>
<tr><td><code id="co2_add_+3A_ta">TA</code></td>
<td>
<p>(optional) total alkalinity (umol / kg). If undefined TA is estimated from salinity using <code><a href="#topic+guess_TA">guess_TA</a></code>.</p>
</td></tr>
<tr><td><code id="co2_add_+3A_atm_pres">atm_pres</code></td>
<td>
<p>atmospheric pressure (mbar). Default is 1013.25 mbar.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>moles of CO2 gas to be added to the seawater.
</p>


<h3>Note</h3>

<p>It is assumed that all of the CO2 added dissolves and remains in solution. This can be achieved (almost completely) by bubbling CO2 according to Jokiel et al. 2014.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>References</h3>

<p>Jokiel PL, Bahr KD, Rodgers KS. 2014. Low-cost, high-flow mesocosm system for simulating ocean acidification with CO2 gas. Limnol Oceanogr Methods. 12:313–322.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+co2_rate">co2_rate</a></code>, <code><a href="#topic+flush_carb">flush_carb</a></code>, <code><a href="seacarb.html#topic+carb">carb</a></code>, <code><a href="#topic+peri_pump">peri_pump</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># I want the 50 L reservoir to have a pCO2 = 1000 uatm. It currently has a pH of 7.88.
# How many moles of CO2 gas should be added to the water to reach my desired pCO2?
co2_add(goal_pco2 = 1000, start_pH = 7.88, vol = 50)

</code></pre>

<hr>
<h2 id='co2_flush'>Calculate CO2 to add to flush reservoir</h2><span id='topic+co2_flush'></span>

<h3>Description</h3>

<p>Calculates the moles of CO2 gas to be added to a seawater reservoir before flushing a respirometer to achieve the desired pCO2 in the respirometer after the flush. Useful for ocean acidification experiments where CO2 treatments are desired.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>co2_flush(
  goal_pco2,
  resp_pH,
  resp_vol,
  flush_pH,
  flush_vol,
  flush_remain = 0,
  temp = 25,
  sal = 35,
  TA = NULL,
  atm_pres = 1013.25
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="co2_flush_+3A_goal_pco2">goal_pco2</code></td>
<td>
<p>the desired pCO2 in the respirometer after the flush (uatm).</p>
</td></tr>
<tr><td><code id="co2_flush_+3A_resp_ph">resp_pH</code></td>
<td>
<p>pH inside the respirometer before the flush (total scale).</p>
</td></tr>
<tr><td><code id="co2_flush_+3A_resp_vol">resp_vol</code></td>
<td>
<p>volume of the respirometer (liter).</p>
</td></tr>
<tr><td><code id="co2_flush_+3A_flush_ph">flush_pH</code></td>
<td>
<p>pH of the reservoir water used for flushing before CO2 is added (total scale).</p>
</td></tr>
<tr><td><code id="co2_flush_+3A_flush_vol">flush_vol</code></td>
<td>
<p>volume of the flush reservoir (liter).</p>
</td></tr>
<tr><td><code id="co2_flush_+3A_flush_remain">flush_remain</code></td>
<td>
<p>volume of the flush reservoir that will remain after the flush (liter).</p>
</td></tr>
<tr><td><code id="co2_flush_+3A_temp">temp</code></td>
<td>
<p>temperature (°C). Default is 25 °C.</p>
</td></tr>
<tr><td><code id="co2_flush_+3A_sal">sal</code></td>
<td>
<p>salinity (psu). Default is 35 psu. If <code>sal</code> &lt; 26 psu, then <code>TA</code> must be provided.</p>
</td></tr>
<tr><td><code id="co2_flush_+3A_ta">TA</code></td>
<td>
<p>(optional) total alkalinity (umol / kg). If undefined TA is estimated from salinity using <code><a href="#topic+guess_TA">guess_TA</a></code>.</p>
</td></tr>
<tr><td><code id="co2_flush_+3A_atm_pres">atm_pres</code></td>
<td>
<p>atmospheric pressure (mbar). Default is 1013.25 mbar.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>moles of CO2 gas to be added to the flush reservoir.
</p>


<h3>Note</h3>

<p>It is assummed that the entire reservoir is drained into the respirometer during the flush. It is also assumed that all of the CO2 added dissolves and remains in solution. This can be achieved (almost completely) by bubbling CO2 according to Jokiel et al. 2014.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>References</h3>

<p>Jokiel PL, Bahr KD, Rodgers KS. 2014. Low-cost, high-flow mesocosm system for simulating ocean acidification with CO2 gas. Limnol Oceanogr Methods. 12:313–322.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+co2_add">co2_add</a></code>, <code><a href="#topic+co2_rate">co2_rate</a></code>, <code><a href="#topic+flush_carb">flush_carb</a></code>, <code><a href="seacarb.html#topic+carb">carb</a></code>, <code><a href="#topic+peri_pump">peri_pump</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># I want the respirometer to have a pCO2 = 1000 uatm. It currently has a pH of 7.6 and is 90 L.
# If I have a 200 L reservoir with pH = 7.9 seawater, how much CO2 do I need
# to add to the flush reservoir?
co2_flush(goal_pco2 = 1000, resp_pH = 7.6, resp_vol = 90, flush_pH = 7.9, flush_vol = 200)

</code></pre>

<hr>
<h2 id='co2_rate'>Calculate CO2 to add to a respirometer intake flow</h2><span id='topic+co2_rate'></span>

<h3>Description</h3>

<p>Calculates the moles of CO2 gas to be added to a respirometer intake seawater flow to achieve the desired pCO2 in the respirometer. Useful for ocean acidification experiments where CO2 treatments are desired. Can be used for acclimation before a trial begins or for use with flow-through respirometry.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>co2_rate(
  goal_pco2,
  init_pH,
  flow_rate,
  temp = 25,
  sal = 35,
  TA = NULL,
  atm_pres = 1013.25,
  MO2 = NULL,
  RQ = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="co2_rate_+3A_goal_pco2">goal_pco2</code></td>
<td>
<p>the desired pCO2 in the respirometer (uatm).</p>
</td></tr>
<tr><td><code id="co2_rate_+3A_init_ph">init_pH</code></td>
<td>
<p>ambient pH of the intake flow (total scale).</p>
</td></tr>
<tr><td><code id="co2_rate_+3A_flow_rate">flow_rate</code></td>
<td>
<p>rate of water flow into the respirometer (liters / minute).</p>
</td></tr>
<tr><td><code id="co2_rate_+3A_temp">temp</code></td>
<td>
<p>temperature (°C). Default is 25 °C.</p>
</td></tr>
<tr><td><code id="co2_rate_+3A_sal">sal</code></td>
<td>
<p>salinity (psu). Default is 35 psu. If <code>sal</code> &lt; 26 psu, then <code>TA</code> must be provided.</p>
</td></tr>
<tr><td><code id="co2_rate_+3A_ta">TA</code></td>
<td>
<p>(optional) total alkalinity (umol / kg). If undefined TA is estimated from salinity using <code><a href="#topic+guess_TA">guess_TA</a></code>.</p>
</td></tr>
<tr><td><code id="co2_rate_+3A_atm_pres">atm_pres</code></td>
<td>
<p>atmospheric pressure (mbar). Default is 1013.25 mbar.</p>
</td></tr>
<tr><td><code id="co2_rate_+3A_mo2">MO2</code></td>
<td>
<p>(optional) oxygen consumption rate (umol / hr). If defined, the CO2 to be added is reduced to compensate for the CO2 produced by the organism.</p>
</td></tr>
<tr><td><code id="co2_rate_+3A_rq">RQ</code></td>
<td>
<p>(optional) respiratory quotient: ratio of CO2 produced / O2 consumed. Only used if <code>MO2</code> is defined. Default is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>moles of CO2 gas to be added to the intake flow per minute.
</p>


<h3>Note</h3>

<p>It is assumed that all of the CO2 added dissolves and remains in solution. This can be achieved (almost completely) by bubbling CO2 according to Jokiel et al. 2014.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>References</h3>

<p>Jokiel PL, Bahr KD, Rodgers KS. 2014. Low-cost, high-flow mesocosm system for simulating ocean acidification with CO2 gas. Limnol Oceanogr Methods. 12:313–322.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+co2_add">co2_add</a></code>, <code><a href="#topic+flush_carb">flush_carb</a></code>, <code><a href="seacarb.html#topic+carb">carb</a></code>, <code><a href="#topic+peri_pump">peri_pump</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># I want the respirometer to have a pCO2 = 1000 uatm. How much CO2 per minute do I need
# to add to the intake flow if the ambient pH is 8.1 and it is flowing at 3 LPM?
co2_rate(goal_pco2 = 1000, init_pH = 8.1, flow_rate = 3)

</code></pre>

<hr>
<h2 id='conv_nh4'>Convert between units of ammonia (NH3) / ammonium (NH4+)</h2><span id='topic+conv_nh4'></span>

<h3>Description</h3>

<p>Ammonia or nitrogen excretion can be measured in a variety of ways. Convert between different measurements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conv_nh4(n_waste, from = "umol_NH4", to = "all")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="conv_nh4_+3A_n_waste">n_waste</code></td>
<td>
<p>a numeric vector of the ammonia or nitrogen value(s).</p>
</td></tr>
<tr><td><code id="conv_nh4_+3A_from">from</code></td>
<td>
<p>a string describing the unit used to measure <code>n_waste</code>. Default is &quot;umol_NH4&quot; Options are:</p>

<ul>
<li><p>umol_NH3
</p>
</li>
<li><p>umol_NH4
</p>
</li>
<li><p>mg_NH3
</p>
</li>
<li><p>mg_NH4
</p>
</li>
<li><p>mg_N
</p>
</li></ul>
</td></tr>
<tr><td><code id="conv_nh4_+3A_to">to</code></td>
<td>
<p>a single string either describing the unit to which the conversion should be conducted (options are the same as in <code>from</code>), or the string &quot;all&quot; to return all units.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sum of NH4+ and NH3 species are considered (i.e. TAN). Conversions are based on relationships and values from the package <code><a href="marelac.html#topic+marelac">marelac</a></code>.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict_nh3">predict_nh3</a></code>, <code><a href="#topic+conv_o2">conv_o2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>conv_nh4(n_waste = 100)
conv_nh4(n_waste = 100, from = 'mg_N')
conv_nh4(n_waste = 100, from = 'mg_N', to = 'umol_NH4')

</code></pre>

<hr>
<h2 id='conv_o2'>Convert between units of oxygen partial pressure and concentration</h2><span id='topic+conv_o2'></span>

<h3>Description</h3>

<p>Unfortunately, a consensus on the best way to express how much oxygen is in water has not been formed to date. Until then, this function converts between all commonly used forms of dissolved O2 measurements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conv_o2(
  o2 = 100,
  from = "percent_a.s.",
  to = "all",
  temp = 25,
  sal = 35,
  atm_pres = 1013.25
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="conv_o2_+3A_o2">o2</code></td>
<td>
<p>a numeric vector of the O2 value(s). Default is 100.</p>
</td></tr>
<tr><td><code id="conv_o2_+3A_from">from</code></td>
<td>
<p>a string describing the unit used to measure <code>o2</code>. Default is &quot;percent_a.s.&quot; Options are:</p>

<ul>
<li><p>percent_a.s. (percent air saturation)
</p>
</li>
<li><p>percent_o2
</p>
</li>
<li><p>hPa
</p>
</li>
<li><p>kPa
</p>
</li>
<li><p>torr
</p>
</li>
<li><p>mmHg
</p>
</li>
<li><p>inHg
</p>
</li>
<li><p>mg_per_l
</p>
</li>
<li><p>ug_per_l
</p>
</li>
<li><p>umol_per_l
</p>
</li>
<li><p>mmol_per_l
</p>
</li>
<li><p>nmol_per_ml
</p>
</li>
<li><p>ml_per_l
</p>
</li>
<li><p>mg_per_kg
</p>
</li>
<li><p>ug_per_kg
</p>
</li>
<li><p>umol_per_kg
</p>
</li>
<li><p>mmol_per_kg
</p>
</li>
<li><p>ml_per_kg
</p>
</li>
<li><p>volumes_percent
</p>
</li></ul>
</td></tr>
<tr><td><code id="conv_o2_+3A_to">to</code></td>
<td>
<p>a single string either describing the unit to which the conversion should be conducted (options are the same as in <code>from</code>), or the string &quot;all&quot; to return all units.</p>
</td></tr>
<tr><td><code id="conv_o2_+3A_temp">temp</code></td>
<td>
<p>temperature (°C). Default is 25 °C.</p>
</td></tr>
<tr><td><code id="conv_o2_+3A_sal">sal</code></td>
<td>
<p>salinity (psu). Default is 35 psu.</p>
</td></tr>
<tr><td><code id="conv_o2_+3A_atm_pres">atm_pres</code></td>
<td>
<p>atmospheric pressure (mbar). Default is 1013.25 mbar.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Conversions are based on relationships and values from the package <code><a href="marelac.html#topic+marelac">marelac</a></code> which utilizes saturation values from Weiss 1970.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>References</h3>

<p>Weiss R. 1970. The solubility of nitrogen, oxygen, and argon in water and seawater. Deep-Sea Research. 17:721-735.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>conv_o2(o2 = 50)
conv_o2(o2 = 1:50, from = "umol_per_l", to = "ml_per_l", temp = 10, sal = 0,
	atm_pres = 1100)
conv_o2()[c('mmHg','kPa')]

</code></pre>

<hr>
<h2 id='conv_resp_unit'>Convert units related to respirometry</h2><span id='topic+conv_resp_unit'></span>

<h3>Description</h3>

<p>Converts units of measurement that are joined by &quot; / &quot; or &quot; * &quot;. This function expands upon <code><a href="measurements.html#topic+conv_multiunit">conv_multiunit</a></code> to incorporate O2 unit conversion and seawater volume-mass conversions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conv_resp_unit(
  value,
  from,
  to,
  temp = 25,
  sal = 35,
  atm_pres = 1013.25,
  o2_conc_base = "per_l"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="conv_resp_unit_+3A_value">value</code></td>
<td>
<p>a numeric vector giving the measurement value in its original units.</p>
</td></tr>
<tr><td><code id="conv_resp_unit_+3A_from">from</code>, <code id="conv_resp_unit_+3A_to">to</code></td>
<td>
<p>a string defining the unit with subunits separated by &quot; / &quot; or &quot; * &quot;. See Details for proper notation regarding O2 and seawater mass/volume.</p>
</td></tr>
<tr><td><code id="conv_resp_unit_+3A_temp">temp</code></td>
<td>
<p>temperature (°C). Default is 25 °C.</p>
</td></tr>
<tr><td><code id="conv_resp_unit_+3A_sal">sal</code></td>
<td>
<p>salinity (psu). Default is 35 psu.</p>
</td></tr>
<tr><td><code id="conv_resp_unit_+3A_atm_pres">atm_pres</code></td>
<td>
<p>atmospheric pressure (mbar). Default is 1013.25 mbar.</p>
</td></tr>
<tr><td><code id="conv_resp_unit_+3A_o2_conc_base">o2_conc_base</code></td>
<td>
<p>(optional) if converting between pO2 and [O2], should concentrations be &quot;per_l&quot; or &quot;per_kg&quot;? Default is &quot;per_l&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The O2 units supported by <code><a href="#topic+conv_o2">conv_o2</a></code> should be appended with &quot;_O2&quot; (e.g. &quot;kPa_O2&quot;; even &quot;percent_o2_O2&quot;) and O2 unit concentrations should drop &quot;per_l&quot; or &quot;per_kg&quot; (e.g. &quot;umol_O2&quot;). To designate seawater mass-volume conversion, append the unit with &quot;_seawater&quot; (e.g. &quot;kg_seawater&quot;).
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="measurements.html#topic+conv_multiunit">conv_multiunit</a></code>, <code><a href="#topic+conv_o2">conv_o2</a></code>, <code><a href="seacarb.html#topic+rho">rho</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># I read that an animal's MO2 is 1.92 ml O2/kg/min. What is this MO2 in umol O2/g/h?
conv_resp_unit(value = 1.92, from = "ml_O2 / kg / min", to = "umol_O2 / g / hr")

# Krogh's diffusion coefficient for oxygen through gills can be expressed as ml O2 / mm2 (gill
# surface area) / um (gill thickness) / torr (seawater pO2 - blood pO2) / minute at a given
# temperature.
# To convert to another unit:
conv_resp_unit(value = 1e-6, from = "ml_O2 / mm2 / um / torr / min",
to = "umol_O2 / cm2 / um / kPa / hr", temp = 20)

# Now, with a knowledge of gill morphometrics, seawater pO2, and blood pO2, I can compare
# gill diffusion with whole animal MO2.

</code></pre>

<hr>
<h2 id='correct_bubble'>Adjust respirometer volume for bubbles</h2><span id='topic+correct_bubble'></span>

<h3>Description</h3>

<p>Given the volume of the respirometer and the volume of bubbles or air space, the moles of O2 in the system are calculated, and the volume of a respirometer holding the same quantity of O2 with only water is returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correct_bubble(resp_vol, bubble_vol, temp = 25, sal = 35, atm_pres = 1013.25)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="correct_bubble_+3A_resp_vol">resp_vol</code></td>
<td>
<p>volume of the respirometer (liter).</p>
</td></tr>
<tr><td><code id="correct_bubble_+3A_bubble_vol">bubble_vol</code></td>
<td>
<p>volume of the gas bubbles or headspace (mL).</p>
</td></tr>
<tr><td><code id="correct_bubble_+3A_temp">temp</code></td>
<td>
<p>temperature (°C). Default is 25 °C.</p>
</td></tr>
<tr><td><code id="correct_bubble_+3A_sal">sal</code></td>
<td>
<p>salinity (psu). Default is 35 psu.</p>
</td></tr>
<tr><td><code id="correct_bubble_+3A_atm_pres">atm_pres</code></td>
<td>
<p>atmospheric pressure (mbar). Default is 1013.25 mbar.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Depending on temperature and salinity, air holds 20,000x as much O2 as water per unit volume, thus small air bubbles in a respirometer can dramatically increase the amount of O2 an organism has to consume to lower the pO2 or aqueous [O2]. Thus air bubbles lead to underestimations of MO[2]. To correct for this in MO2 calculations after measurement, the volume of the respirometer can be increased. This function calculates the volume needed for MO2 calculations as a function of the volume of air space. Caution: allowing air bubbles into a respirometer is not recommended, even with this post-measurement adjustment. A small error in bubble volume estimation can lead to a large error in calculated metabolic rate.
</p>


<h3>Value</h3>

<p>The volume of a respirometer holding an equivalent quantity of O2 filled only with water.
</p>


<h3>Note</h3>

<p>Due to the high concentration of O2 in air, very small errors in bubble volume estimates can lead to very large differences in the volume returned. Only trust the returned value if you are very confident of the accuracy of your bubble volume estimate.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="marelac.html#topic+molvol">molvol</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>correct_bubble(resp_vol = 50, bubble_vol = 10) # a 10 mL bubble makes a huge difference!

correct_bubble(resp_vol = 50, bubble_vol = 1, temp = 10, sal = 0) 
# in calculating MO2, a volume of 63.8 L should be used rather than the true 50 L.

</code></pre>

<hr>
<h2 id='flush_carb'>Estimate carbonate chemistry after a flush</h2><span id='topic+flush_carb'></span>

<h3>Description</h3>

<p>Given the seawater pH inside the respirometer and in the flush reservoir, the new carbonate parameters (including pH) in the respirometer after the flush are estimated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flush_carb(
  resp_vol,
  flow_rate,
  duration,
  resp_pH,
  flush_pH,
  temp = 25,
  sal = 35,
  TA = NULL,
  atm_pres = 1013.25
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flush_carb_+3A_resp_vol">resp_vol</code></td>
<td>
<p>volume of the respirometer (liter).</p>
</td></tr>
<tr><td><code id="flush_carb_+3A_flow_rate">flow_rate</code></td>
<td>
<p>rate of water flow into the respirometer (liters / minute).</p>
</td></tr>
<tr><td><code id="flush_carb_+3A_duration">duration</code></td>
<td>
<p>duration of the flush (minutes).</p>
</td></tr>
<tr><td><code id="flush_carb_+3A_resp_ph">resp_pH</code></td>
<td>
<p>pH inside the respirometer before the flush (total scale).</p>
</td></tr>
<tr><td><code id="flush_carb_+3A_flush_ph">flush_pH</code></td>
<td>
<p>pH of the water used for flushing the respirometer (total scale).</p>
</td></tr>
<tr><td><code id="flush_carb_+3A_temp">temp</code></td>
<td>
<p>temperature (°C). Default is 25 °C.</p>
</td></tr>
<tr><td><code id="flush_carb_+3A_sal">sal</code></td>
<td>
<p>salinity (psu). Default is 35 psu. If <code>sal</code> &lt; 26 psu, then <code>TA</code> must be provided.</p>
</td></tr>
<tr><td><code id="flush_carb_+3A_ta">TA</code></td>
<td>
<p>(optional) total alkalinity (umol / kg). If undefined TA is estimated from salinity using <code><a href="#topic+guess_TA">guess_TA</a></code>.</p>
</td></tr>
<tr><td><code id="flush_carb_+3A_atm_pres">atm_pres</code></td>
<td>
<p>atmospheric pressure (mbar). Default is 1013.25 mbar.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame returned by <code><a href="seacarb.html#topic+carb">carb</a></code>.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="seacarb.html#topic+carb">carb</a></code>, <code><a href="#topic+flush_water">flush_water</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>flush_carb(resp_vol = 90, flow_rate = 10, duration = 3, resp_pH = 7.8, flush_pH = 8.1)

# What will be the pH in the respirometer after this flush?
flush_carb(resp_vol = 90, flow_rate = 10, duration = 3, resp_pH = 7.8, flush_pH = 8.1)$pH

</code></pre>

<hr>
<h2 id='flush_o2'>Estimate dissolved O2 after a flush</h2><span id='topic+flush_o2'></span>

<h3>Description</h3>

<p>Calculate the pO2 or [O2] in a respirometer after a flush. Given 5 of the 6 parameters, the 6th parameter is calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flush_o2(resp_vol, flow_rate, duration, resp_o2, flush_o2, final_o2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flush_o2_+3A_resp_vol">resp_vol</code></td>
<td>
<p>volume of the respirometer (liter).</p>
</td></tr>
<tr><td><code id="flush_o2_+3A_flow_rate">flow_rate</code></td>
<td>
<p>rate of water flow into the respirometer (liters / minute).</p>
</td></tr>
<tr><td><code id="flush_o2_+3A_duration">duration</code></td>
<td>
<p>duration of the flush (minutes).</p>
</td></tr>
<tr><td><code id="flush_o2_+3A_resp_o2">resp_o2</code></td>
<td>
<p>O2 inside the respirometer before the flush (units do not matter as long as it is consistant with <code>flush_o2</code> and <code>final_o2</code>).</p>
</td></tr>
<tr><td><code id="flush_o2_+3A_flush_o2">flush_o2</code></td>
<td>
<p>O2 of the water used for flushing the respirometer (units do not matter as long as it is consistant with <code>resp_o2</code> and <code>final_o2</code>).</p>
</td></tr>
<tr><td><code id="flush_o2_+3A_final_o2">final_o2</code></td>
<td>
<p>O2 of the water in the respirometer at the end of the flush (units do not matter as long as it is consistant with <code>resp_o2</code> and <code>flush_o2</code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+flush_water">flush_water</a></code>, <code><a href="#topic+flush_carb">flush_carb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># What will be the pO2 in the respirometer after this flush?
flush_o2(resp_vol = 90, flow_rate = 10, duration = 3, resp_o2 = 15, flush_o2 = 21)

# I want to bring the pO2 back up to 95% air saturation. How long do I need to flush?
flush_o2(resp_vol = 20, flow_rate = 2, resp_o2 = 75, flush_o2 = 99, final_o2 = 95)

</code></pre>

<hr>
<h2 id='flush_water'>Find percent of water exchanged after a flush</h2><span id='topic+flush_water'></span>

<h3>Description</h3>

<p>Calculate the proportion of water in a respirometer that is new after a flush. Useful for intermittent respirometry. Given 3 of the first 4 parameters, the 4th parameter is calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flush_water(vol, flow_rate, duration, perc_fresh, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flush_water_+3A_vol">vol</code></td>
<td>
<p>volume of the respirometer (liter).</p>
</td></tr>
<tr><td><code id="flush_water_+3A_flow_rate">flow_rate</code></td>
<td>
<p>rate of water flow into the respirometer (liters / minute).</p>
</td></tr>
<tr><td><code id="flush_water_+3A_duration">duration</code></td>
<td>
<p>duration of the flush (minutes).</p>
</td></tr>
<tr><td><code id="flush_water_+3A_perc_fresh">perc_fresh</code></td>
<td>
<p>percent of the respirometer volume that is new flushed water.</p>
</td></tr>
<tr><td><code id="flush_water_+3A_plot">plot</code></td>
<td>
<p>logical. Plot the percent exchanged as a function of flow rate and duration to see what effect would result if the rate or duration are changed. All parameters must only have a single value.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>References</h3>

<p>Steffensen JF. 1989. Some errors in respirometry of aquatic breathers: How to avoid and correct for them. Fish Physiol Biochem. 6:49–59. Equation 5.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+flush_carb">flush_carb</a></code>, <code><a href="#topic+min_flow">min_flow</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># What proportion of a 90 L respirometer is exchanged after 20 minutes of flow at 2 LPM?
flush_water(vol = 90, flow_rate = 2, duration = 20)

# Would it be worth it to extend the flush another five minutes? How much would that
# improve the exchange?
flush_water(vol = 90, flow_rate = 2, duration = 20, plot = TRUE)
# Another five minutes would increase exchange by nearly 10%.
# Perhaps that's worth the extra time...

# Visualize flushing
vol = 150
flow_rate = seq(0, 10, by = 0.5)
duration = 0:60
perc_fresh = outer(flow_rate, duration, function(flow_rate, duration){
	flush_water(vol = vol, flow_rate = flow_rate, duration = duration)
})
persp(flow_rate, duration, perc_fresh, xlab = 'Flow rate (LPM)', ylab = 'Duration (min)',
zlab = '% exchange', theta = 45, phi = 15, expand = 0.5, ticktype = 'detailed', nticks = 10)

</code></pre>

<hr>
<h2 id='goal_flush_pH'>Calculate goal pH of a flush reservoir to achieve the post-flush goal pCO2</h2><span id='topic+goal_flush_pH'></span>

<h3>Description</h3>

<p>Calculates the pH of a flush reservoir that is needed to achieve the goal pCO2 after the flush reservoir has been drained into the respirometer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>goal_flush_pH(
  goal_pco2,
  resp_pH,
  resp_vol,
  flush_vol,
  flush_remain = 0,
  temp = 25,
  sal = 35,
  TA = NULL,
  atm_pres = 1013.25
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="goal_flush_pH_+3A_goal_pco2">goal_pco2</code></td>
<td>
<p>the desired pCO2 in the respirometer after the flush (uatm).</p>
</td></tr>
<tr><td><code id="goal_flush_pH_+3A_resp_ph">resp_pH</code></td>
<td>
<p>pH inside the respirometer before the flush (total scale).</p>
</td></tr>
<tr><td><code id="goal_flush_pH_+3A_resp_vol">resp_vol</code></td>
<td>
<p>volume of the respirometer (liter).</p>
</td></tr>
<tr><td><code id="goal_flush_pH_+3A_flush_vol">flush_vol</code></td>
<td>
<p>volume of the flush reservoir (liter).</p>
</td></tr>
<tr><td><code id="goal_flush_pH_+3A_flush_remain">flush_remain</code></td>
<td>
<p>volume of the flush reservoir that will remain after the flush (liter).</p>
</td></tr>
<tr><td><code id="goal_flush_pH_+3A_temp">temp</code></td>
<td>
<p>temperature (°C). Default is 25 °C.</p>
</td></tr>
<tr><td><code id="goal_flush_pH_+3A_sal">sal</code></td>
<td>
<p>salinity (psu). Default is 35 psu. If <code>sal</code> &lt; 26 psu, then <code>TA</code> must be provided.</p>
</td></tr>
<tr><td><code id="goal_flush_pH_+3A_ta">TA</code></td>
<td>
<p>(optional) total alkalinity (umol / kg). If undefined TA is estimated from salinity using <code><a href="#topic+guess_TA">guess_TA</a></code>.</p>
</td></tr>
<tr><td><code id="goal_flush_pH_+3A_atm_pres">atm_pres</code></td>
<td>
<p>atmospheric pressure (mbar). Default is 1013.25 mbar.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>pH needed in the flush reservoir to achieve the goal pCO2 post-flush (total scale).
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+co2_rate">co2_rate</a></code>, <code><a href="#topic+flush_carb">flush_carb</a></code>, <code><a href="seacarb.html#topic+carb">carb</a></code>, <code><a href="#topic+peri_pump">peri_pump</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># I want the respirometer to have a pCO2 = 1000 uatm. It currently has a pH of 7.6 and is 90 L.
# If I have a 200 L reservoir which will be drained completely, what do I want
# the pH of the reservoir to be?
goal_flush_pH(goal_pco2 = 1000, resp_pH = 7.6, resp_vol = 90, flush_vol = 200)

</code></pre>

<hr>
<h2 id='guess_TA'>Estimate total alkalinity from salinity</h2><span id='topic+guess_TA'></span>

<h3>Description</h3>

<p>Estimate total alkalinity from salinity and temperature of surface seawater according to Lee et al. 2006. Useful when a rough guess of TA is needed because measuring TA is not possible or practical.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>guess_TA(temp = 25, sal = 35, region = NULL, extend = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="guess_TA_+3A_temp">temp</code></td>
<td>
<p>temperature (°C). Default is 25 °C.</p>
</td></tr>
<tr><td><code id="guess_TA_+3A_sal">sal</code></td>
<td>
<p>salinity (psu). Default is 35 psu. 31 <code class="reqn">\le</code> <code>sal</code> <code class="reqn">\le</code> 38; may be narrower for some regions.</p>
</td></tr>
<tr><td><code id="guess_TA_+3A_region">region</code></td>
<td>
<p>(optional) geographic region. Options are &quot;(Sub)tropics&quot;, &quot;Equatorial Upwelling Pacific&quot;, &quot;North Atlantic&quot;, &quot;North Pacific&quot;, and &quot;Southern Ocean&quot;. Default is <code>NULL</code>. If undefined, the average from all these regions is used.</p>
</td></tr>
<tr><td><code id="guess_TA_+3A_extend">extend</code></td>
<td>
<p>logical. If salinity is <code class="reqn">\le</code> 5 psu outside of the bounds defined by Lee et al. 2006 (see Details), should a guess be extrapolated? Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<dl>
<dt>(Sub)tropics</dt><dd><p><code>temp</code> <code class="reqn">\ge</code> 20 and 31 <code class="reqn">\le</code> <code>sal</code> <code class="reqn">\le</code> 38</p>
</dd>
<dt>Equatorial Upwelling Pacific</dt><dd><p><code>temp</code> <code class="reqn">\ge</code> 18 and 31 <code class="reqn">\le</code> <code>sal</code> <code class="reqn">\le</code> 36.5</p>
</dd>
<dt>North Atlantic</dt><dd><p>0 <code class="reqn">\le</code> <code>temp</code> <code class="reqn">\le</code> 20 and 31 <code class="reqn">\le</code> <code>sal</code> <code class="reqn">\le</code> 37</p>
</dd>
<dt>North Pacific</dt><dd><p><code>temp</code> <code class="reqn">\le</code> 20 and 31 <code class="reqn">\le</code> <code>sal</code> <code class="reqn">\le</code> 35</p>
</dd>
<dt>Southern Ocean</dt><dd><p><code>temp</code> <code class="reqn">\le</code> 20 and 33 <code class="reqn">\le</code> <code>sal</code> <code class="reqn">\le</code> 36</p>
</dd>
</dl>

<p>Estimates total alkalinity using the equations provided by Lee et al. 2006 (Geophysical Research Letters). While these equations are designed for open ocean environments, they can provide a rough estimate even for coastal environments. For improved estimate accuracy, the geographic region can be provided. The North Pacific region is longitude-dependent so a longitude of 150 °W is assumed which provides a typical value within the range. Only applicable for surface waters, not very accurate for the ocean interior.
</p>


<h3>Value</h3>

<p>An estimate of the total alkalinity (umol / kg). If <code>NA</code> or <code>NaN</code> are returned, confirm the <code>temp</code> and <code>sal</code> values are within acceptable ranges for the region of interest.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>References</h3>

<p>Lee K, Tong LT, Millero FJ, Sabine CL, Dickson AG, Goyet C, Park G-H, Wanninkhof R, Feely RA, Key RM. 2006. Global relationships of total alkalinity with salinity and temperature in surface waters of the world’s oceans. Geophys Res Lett. 33:L19605.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict_pH">predict_pH</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>guess_TA(temp = 22, sal = 33)
guess_TA(temp = 12, sal = 33, region = "North Atlantic")
guess_TA(temp = 20, sal = 31:35)

guess_TA(sal = 31) # salinity is within bounds
guess_TA(sal = 30) # salinity is outside the bounds and TA is extrapolated
guess_TA(sal = 30, extend = FALSE) # do not extrapolate TA
guess_TA(sal = 25, extend = TRUE) # will not extrapolate with sal &gt; 5 psu out of bounds

</code></pre>

<hr>
<h2 id='guess_when'>Estimate when the O2 level will reach a defined level</h2><span id='topic+guess_when'></span>

<h3>Description</h3>

<p>Estimates the time at which O2 will reach a defined level assuming a linear change in O2 over time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>guess_when(past_o2, past_time, goal_o2, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="guess_when_+3A_past_o2">past_o2</code></td>
<td>
<p>a numeric vector of at least two oxygen measurements previously during the trial.</p>
</td></tr>
<tr><td><code id="guess_when_+3A_past_time">past_time</code></td>
<td>
<p>a vector of timepoints corresponding to when <code>past_o2</code> values were recorded. Can be a numeric vector for duration since trial began or a POSIX vector of time values.</p>
</td></tr>
<tr><td><code id="guess_when_+3A_goal_o2">goal_o2</code></td>
<td>
<p>a numeric vector or single value describing the O2 level of interest.</p>
</td></tr>
<tr><td><code id="guess_when_+3A_plot">plot</code></td>
<td>
<p>logical. Do you want to see a plot to visualize this prediction?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A prediction of the time when O2 will reach <code>goal_o2</code>. If <code>past_time</code> is numeric, then a numeric value(s) will be returned. If POSIX, then POSIX will be returned.
</p>


<h3>Note</h3>

<p>Viewing the plot can be valuable if the O2 consumption or production is not linear.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict_pH">predict_pH</a></code>, <code><a href="#topic+predict_nh3">predict_nh3</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>guess_when(past_o2 = rnorm(n = 10, mean = 100:91), past_time = 1:10, goal_o2 = 75, plot = FALSE)
guess_when(past_o2 = rnorm(n = 10, mean = 100:91, sd = 5), past_time = 1:10, goal_o2 = 75)
# Viewing the plot can be helpful to see how trustworthy the prediction is
# when signal:noise is low.

</code></pre>

<hr>
<h2 id='import_firesting'>Import data from Pyro Oxygen Logger</h2><span id='topic+import_firesting'></span>

<h3>Description</h3>

<p>Imports the standard txt file output from Pyroscience's deprecated Pyro Oxygen Logger software and converts the data into one or more data frames. If using the newer Pyroscience Workbench software, use <code><a href="#topic+import_pyroscience_workbench">import_pyroscience_workbench</a></code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>import_firesting(
  file,
  o2_unit = "percent_a.s.",
  date = "%m/%d/%Y %X",
  overwrite_sal = NULL,
  keep_metadata = FALSE,
  drop_channels = TRUE,
  split_channels = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="import_firesting_+3A_file">file</code></td>
<td>
<p>a character string. The filepath for the file to be read.</p>
</td></tr>
<tr><td><code id="import_firesting_+3A_o2_unit">o2_unit</code></td>
<td>
<p>a character string. The unit of O2 measurement to be output in the data frame. Options are described in <code><a href="#topic+conv_o2">conv_o2</a></code>.</p>
</td></tr>
<tr><td><code id="import_firesting_+3A_date">date</code></td>
<td>
<p>a character string. The date format to be passed to <code><a href="base.html#topic+strptime">strptime</a></code>.</p>
</td></tr>
<tr><td><code id="import_firesting_+3A_overwrite_sal">overwrite_sal</code></td>
<td>
<p>Default <code>NULL</code>. To overwrite the salinity value(s) from calibration, enter a single numeric value for all channels or a numeric vector with values for each channel. Salinity of water sample (psu).</p>
</td></tr>
<tr><td><code id="import_firesting_+3A_keep_metadata">keep_metadata</code></td>
<td>
<p>logical. Should metadata from the file be returned as extra columns in the returned data frame? Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="import_firesting_+3A_drop_channels">drop_channels</code></td>
<td>
<p>logical. Should channels without any O2 data be dropped? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="import_firesting_+3A_split_channels">split_channels</code></td>
<td>
<p>logical. Should a list of data frames be returned with a separate data frame for each channel? Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following FireSting fiber optic O2 transmitters are supported:
</p>

<ul>
<li><p>FireStingO2
</p>
</li>
<li><p>FireStingO2 (1st generation)
</p>
</li></ul>

<p>If you would like support for the Piccolo2, FireStingO2-Mini, TeX4, or any OEM instruments, email me a data file from the device.
</p>


<h3>Value</h3>

<p>A data frame (or list of data frames) is returned.
</p>

<dl>
<dt>TIME</dt><dd><p>Date and time, POSIXlt format.</p>
</dd>
<dt>DURATION</dt><dd><p>Duration of measurement trial (minutes).</p>
</dd>
<dt>CH_X_O2</dt><dd><p>Oxygen measurement in desired unit as determined by <code>o2_unit</code>.</p>
</dd>
<dt>CH_X_TEMP</dt><dd><p>Temperature recorded or defined at beginning of measurement trial.</p>
</dd>
<dt>CH_X_SAL</dt><dd><p>Salinity (psu).</p>
</dd>
<dt>...</dt><dd><p>Channel columns (CH_...) are repeated for each channel.</p>
</dd>
<dt>COMMENT</dt><dd><p>Comments from FireSting file.</p>
</dd>
</dl>

<p>If <code>keep_metadata = TRUE</code>, then the following columns are appended to the returned data frame:
</p>

<dl>
<dt>ATM_PRES</dt><dd><p>Atmospheric pressure (mbar).</p>
</dd>
<dt>HUMIDITY</dt><dd><p>Relative humidity (% RH).</p>
</dd>
<dt>PROBE_TEMP</dt><dd><p>Probe temperature.</p>
</dd>
<dt>INTERNAL_TEMP</dt><dd><p>Transmitter internal temperature.</p>
</dd>
<dt>ANALOG_IN</dt><dd><p>Voltage input from the extension port (mV).</p>
</dd>
<dt>CH_X_PHASE</dt><dd><p>Phase recorded. Phase is inversely related to O2.</p>
</dd>
<dt>CH_X_INTENSITY</dt><dd><p>Intensity is an indicator of the quality of the signal. A low intensity warning is produced by the transmitter below 10 mV.</p>
</dd>
<dt>CH_X_AMB_LIGHT</dt><dd><p>Ambient light on the sensor. Expressed in mV.</p>
</dd>
</dl>

<p>If <code>split_channels = TRUE</code>, then &quot;<code>CH_X_</code>&quot; is removed from the column names and multiple data frames are returned in a named list.
</p>


<h3>Note</h3>

<p>Oxygen conversions are estimates based on the <code><a href="marelac.html#topic+marelac">marelac</a></code> package.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+import_pyroscience_workbench">import_pyroscience_workbench</a></code>, <code><a href="#topic+import_presens">import_presens</a></code>, <code><a href="#topic+import_witrox">import_witrox</a></code>, <code><a href="#topic+conv_o2">conv_o2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file('extdata', 'pyro_oxygen_logger_file.txt', package = 'respirometry')
import_firesting(file, o2_unit = 'umol_per_l')

# I want each channel as a separate data frame.
data_list &lt;- import_firesting(file, split_channels = TRUE)
data_list$CH_3 # here's the channel 3 data frame.

## End(Not run)

</code></pre>

<hr>
<h2 id='import_presens'>Import data from a PreSens O2 transmitter</h2><span id='topic+import_presens'></span>

<h3>Description</h3>

<p>Imports the standard text file output from most single channel PreSens fiber optic O2 transmitters and converts the data into a data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>import_presens(
  file,
  o2_unit = "percent_a.s.",
  date = "%d/%m/%y",
  sal = 35,
  all_cols = FALSE,
  split_channels = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="import_presens_+3A_file">file</code></td>
<td>
<p>a character string. The filepath for the file to be read.</p>
</td></tr>
<tr><td><code id="import_presens_+3A_o2_unit">o2_unit</code></td>
<td>
<p>a character string. The unit of O2 measurement to be output in the data frame. Options are described in <code><a href="#topic+conv_o2">conv_o2</a></code>.</p>
</td></tr>
<tr><td><code id="import_presens_+3A_date">date</code></td>
<td>
<p>a character string. The date format to be passed to <code><a href="base.html#topic+strptime">strptime</a></code>.</p>
</td></tr>
<tr><td><code id="import_presens_+3A_sal">sal</code></td>
<td>
<p>salinity of water sample (psu). Default is 35 psu. Ignored for Fibox 4 files since salinity is provided by the file.</p>
</td></tr>
<tr><td><code id="import_presens_+3A_all_cols">all_cols</code></td>
<td>
<p>logical. For Fibox 4 files only. Should all columns (including calibration data and serial numbers) be output?</p>
</td></tr>
<tr><td><code id="import_presens_+3A_split_channels">split_channels</code></td>
<td>
<p>logical. For SDR SensorDish only. Should a list of data frames be returned with a separate data frame for each channel? Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following PreSens fiber optic O2 transmitters are supported:
</p>

<ul>
<li><p>Fibox 4
</p>
</li>
<li><p>Fibox 3
</p>
</li>
<li><p>Fibox 3 trace
</p>
</li>
<li><p>Fibox 3 LCD trace
</p>
</li>
<li><p>Microx TX3
</p>
</li>
<li><p>Microx TX3 trace
</p>
</li>
<li><p>SDR SensorDish Reader
</p>
</li></ul>

<p>If you would like support for another PreSens O2 meter, email the package maintainer a data file from the device you would like supported.
It is very important to note that the PreSens fiber optics O2 transmitters that are supported with this function (except the Fibox 4) DO NOT account for salinity (i.e. they assume salinity = 0 ppt). If the water sample measured was not fresh water, the oxygen concentrations (e.g. mg per liter or umol per liter) are incorrect in the PreSens txt file. This function corrects these O2 concentrations based on the salinity value defined by the <code>sal</code> argument. Absolute partial pressures (i.e. hPa and torr) will also be slightly different due to the slight influence of salinity on water's vapor pressure. This difference is typically ~0.05% of the recorded value.
</p>


<h3>Value</h3>

<p>A data frame is returned.
</p>

<dl>
<dt>TIME</dt><dd><p>Date and time, POSIXct format.</p>
</dd>
<dt>DURATION</dt><dd><p>Duration of measurement trial (minutes).</p>
</dd>
<dt>O2</dt><dd><p>Oxygen measurement in desired unit as determined by <code>o2_unit</code>.</p>
</dd>
<dt>PHASE</dt><dd><p>Phase recorded. Phase is inversely related to O2. Not included in SDR SensorDish Reader files.</p>
</dd>
<dt>AMPLITUDE</dt><dd><p>Amplitude recorded. Amplitude is an indicator of the quality of the signal. A low amplitude warning is produced by the transmitter below 2500. Not included in SDR SensorDish Reader files.</p>
</dd>
<dt>TEMP</dt><dd><p>Temperature recorded or defined at beginning of measurement trial.</p>
</dd>
<dt>ATM_PRES</dt><dd><p>Atmospheric pressure (mbar).</p>
</dd>
<dt>SAL</dt><dd><p>Salinity (psu).</p>
</dd>
<dt>ERROR_CODE</dt><dd><p>Error code from transmitter. See PreSens user manual for translation of error code. Not included in SDR SensorDish Reader files.</p>
</dd>
</dl>



<h3>Note</h3>

<p>Oxygen conversions are based on <code><a href="#topic+conv_o2">conv_o2</a></code> and therefore differ slightly from the conversions provided by PreSens.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+import_pyroscience_workbench">import_pyroscience_workbench</a></code>, <code><a href="#topic+import_firesting">import_firesting</a></code>, <code><a href="#topic+import_witrox">import_witrox</a></code>, <code><a href="#topic+conv_o2">conv_o2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Import a Fibox 3 file.
file &lt;- system.file('extdata', 'fibox_3_file.txt', package = 'respirometry')
import_presens(file, o2_unit = 'umol_per_l', sal = 25)

# Import a Fibox 4 file.
file &lt;- system.file('extdata', 'fibox_4_file.csv', package = 'respirometry')
import_presens(file = file, date = '%d-%b-%Y')

# Import an SDR SensorDish Reader file.
file &lt;- system.file('extdata', 'sdr_file.txt', package = 'respirometry')
import_presens(file = file, date = '%d.%m.%y%X')


## End(Not run)
</code></pre>

<hr>
<h2 id='import_pyroscience_workbench'>Import data from Pyroscience Workbench</h2><span id='topic+import_pyroscience_workbench'></span>

<h3>Description</h3>

<p>Imports the raw channel data from Pyroscience Workbench output files. This allows &quot;live&quot; analyses while the trial is still running. This does not utilize the &quot;.pyr&quot; file, nor the text file that is created once the trial is finished. This utilizes the raw channel data found within the &quot;ChannelData&quot; folder that the software makes when the trial starts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>import_pyroscience_workbench(
  folder,
  o2_unit = "percent_a.s.",
  sal = NULL,
  keep_metadata = FALSE,
  split_channels = FALSE,
  merge_close_measurements = "min"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="import_pyroscience_workbench_+3A_folder">folder</code></td>
<td>
<p>a character string. The filepath to the parent folder (directory) which contains ChannelData.</p>
</td></tr>
<tr><td><code id="import_pyroscience_workbench_+3A_o2_unit">o2_unit</code></td>
<td>
<p>a character string. The unit of O2 measurement to be output in the data frame. Options are described in <code><a href="#topic+conv_o2">conv_o2</a></code>.</p>
</td></tr>
<tr><td><code id="import_pyroscience_workbench_+3A_sal">sal</code></td>
<td>
<p>numeric. If <code>o2_unit</code> is a concentration rather than partial pressure, the salinity of the chamber in which measurements were made must be entered here.</p>
</td></tr>
<tr><td><code id="import_pyroscience_workbench_+3A_keep_metadata">keep_metadata</code></td>
<td>
<p>logical. Should metadata from the file be returned as extra columns in the returned data frame? Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="import_pyroscience_workbench_+3A_split_channels">split_channels</code></td>
<td>
<p>logical. Should a list of data frames be returned with a separate data frame for each channel? Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="import_pyroscience_workbench_+3A_merge_close_measurements">merge_close_measurements</code></td>
<td>
<p>used only when <code>split_channels = FALSE</code> (the default). The frequency during which measurements are taken can be set uniquely for each channel in the Pyroscience Workbench software. When this happens, measurements may, at times, be nearly synchronized. When measurements are close together in time (even if not exactly at the same moment), it may be desirable to merge them together in the same row of the output dataframe and consider them to be the same timepoint. This parameter allows you to control whether that happens, and if so, how close is &quot;close enough&quot;. Options are:
</p>

<dl>
<dt><code>0</code>: </dt><dd><p>Do not merge close measurements no matter how close in time (even if 1 msec apart).</p>
</dd>
<dt>&quot;min&quot; (default): </dt><dd><p>Merge measurements as close as the most frequently sampled channel (e.g. if channel 1 sampled every 5 seconds, channel 2 every 2 seconds, and channel 3 every 10 seconds, then any measurements within 2 seconds of each other will be merged on the same row in the output dataframe.)</p>
</dd>
<dt>&quot;max&quot;: </dt><dd><p>Merge measurements as close as the least frequently sampled channel (e.g. if channel 1 sampled every 5 seconds, channel 2 every 2 seconds, and channel 3 every 10 seconds, then any measurements within 10 seconds of each other will be merged on the same row in the output dataframe. Warning: this will duplicate more frequent channels. Do not let your downstream statistics be altered by artificially raising the number of observations.)</p>
</dd>
<dt>custom-set numeric value: </dt><dd><p>A numeric value specifying how many seconds apart is &quot;close enough&quot; to merge measurements to the same timepoint. This may result in duplications of the same observations across multiple rows or not merging multiple observations as expected. Examine the output carefully.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame (or list of data frames) is returned.
</p>

<dl>
<dt>TIME</dt><dd><p>Date and time, POSIXct format. If <code>split_channels = FALSE</code> (default), then the timestamp is the average of all the measurements that were merged. For details, see <code>merge_close_measurements</code>.</p>
</dd>
<dt>DURATION</dt><dd><p>Duration of measurement trial (minutes).</p>
</dd>
<dt>CH_X_O2</dt><dd><p>Oxygen measurement in desired unit as determined by <code>o2_unit</code>.</p>
</dd>
<dt>CH_X_TEMP</dt><dd><p>Temperature recorded or defined at beginning of measurement trial.</p>
</dd>
<dt>CH_X_SAL</dt><dd><p>Salinity (psu). Only displayed if <code>sal != NULL</code>.</p>
</dd>
<dt>CH_X_STATUS</dt><dd><p>Warning or error messages from Pyroscience Workbench file.</p>
</dd>
<dt>...</dt><dd><p>Channel columns (CH_...) are repeated for each channel.</p>
</dd>
</dl>

<p>If <code>keep_metadata = TRUE</code>, then the following columns are appended to the returned data frame:
</p>

<dl>
<dt>CH_X_PHASE</dt><dd><p>Phase recorded. Phase is inversely related to O2.</p>
</dd>
<dt>CH_X_INTENSITY</dt><dd><p>Intensity is an indicator of the quality of the signal.</p>
</dd>
<dt>CH_X_AMB_LIGHT</dt><dd><p>Ambient light on the sensor. Expressed in mV.</p>
</dd>
<dt>CH_X_T_STATUS</dt><dd><p>Warning or error messages from Pyroscience Workbench file's temperature measurement.</p>
</dd>
<dt>CH_X_ATM_PRES</dt><dd><p>Atmospheric pressure (mbar).</p>
</dd>
<dt>CH_X_P_STATUS</dt><dd><p>Warning or error messages from Pyroscience Workbench file's atmospheric pressure measurement.</p>
</dd>
</dl>

<p>If <code>split_channels = TRUE</code>, then &quot;<code>CH_X_</code>&quot; is removed from the column names and multiple data frames are returned in a named list.
</p>


<h3>Note</h3>

<p>Oxygen conversions are estimates based on the <code><a href="marelac.html#topic+marelac">marelac</a></code> package.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+import_presens">import_presens</a></code>, <code><a href="#topic+import_witrox">import_witrox</a></code>, <code><a href="#topic+conv_o2">conv_o2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
folder &lt;- system.file('extdata/pyro_wb/', package = 'respirometry')
import_pyroscience_workbench(folder = folder, o2_unit = 'umol_per_l', sal = c(0, 35))

# I want each channel as a separate data frame.
data_list &lt;- import_pyroscience_workbench(folder = folder, split_channels = TRUE)
data_list$CH_2 # here's the channel 2 data frame.

## End(Not run)

</code></pre>

<hr>
<h2 id='import_witrox'>Import data from a Loligo Systems Witrox O2 transmitter</h2><span id='topic+import_witrox'></span>

<h3>Description</h3>

<p>Imports the standard txt file output from Loligo Systems Witrox fiber optic O2 transmitters and converts the data into one or more data frames.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>import_witrox(
  file,
  o2_unit = "percent_a.s.",
  date = "%m/%d/%Y %I:%M:%S %p",
  overwrite_sal = NULL,
  drop_channels = TRUE,
  split_channels = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="import_witrox_+3A_file">file</code></td>
<td>
<p>a character string. The filepath for the file to be read.</p>
</td></tr>
<tr><td><code id="import_witrox_+3A_o2_unit">o2_unit</code></td>
<td>
<p>a character string. The unit of O2 measurement to be output in the data frame. Options are described in <code><a href="#topic+conv_o2">conv_o2</a></code>.</p>
</td></tr>
<tr><td><code id="import_witrox_+3A_date">date</code></td>
<td>
<p>a character string. The date format to be passed to <code><a href="base.html#topic+strptime">strptime</a></code>.</p>
</td></tr>
<tr><td><code id="import_witrox_+3A_overwrite_sal">overwrite_sal</code></td>
<td>
<p>Default <code>NULL</code>. To overwrite the salinity value(s) from calibration, enter a single numeric value for all channels or a numeric vector with values for each channel. Salinity of water sample (psu).</p>
</td></tr>
<tr><td><code id="import_witrox_+3A_drop_channels">drop_channels</code></td>
<td>
<p>logical. Should channels without any O2 data be dropped? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="import_witrox_+3A_split_channels">split_channels</code></td>
<td>
<p>logical. Should a list of data frames be returned with a separate data frame for each channel? Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following Loligo Systems fiber optic O2 transmitters are supported:
</p>

<ul>
<li><p>Witrox 4
</p>
</li></ul>

<p>If you would like support for the Witrox 1, email me a data file from this device.
</p>


<h3>Value</h3>

<p>A data frame (or list of data frames) is returned.
</p>

<dl>
<dt>TIME</dt><dd><p>Date and time, POSIXlt format.</p>
</dd>
<dt>DURATION</dt><dd><p>Duration of measurement trial (minutes).</p>
</dd>
<dt>ATM_PRES</dt><dd><p>Atmospheric pressure (mbar).</p>
</dd>
<dt>CH_X_PHASE</dt><dd><p>Phase recorded. Phase is inversely related to O2.</p>
</dd>
<dt>CH_X_TEMP</dt><dd><p>Temperature recorded or defined at beginning of measurement trial.</p>
</dd>
<dt>CH_X_SAL</dt><dd><p>Salinity (psu).</p>
</dd>
<dt>CH_X_O2</dt><dd><p>Oxygen measurement in desired unit as determined by <code>o2_unit</code>.</p>
</dd>
<dt>...</dt><dd><p>Channel columns (CH_...) are repeated for each channel.</p>
</dd>
</dl>

<p>If <code>split_channels = TRUE</code>, then &quot;<code>CH_X_</code>&quot; is removed from the column names and multiple data frames are returned in a list.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+import_pyroscience_workbench">import_pyroscience_workbench</a></code>, <code><a href="#topic+import_firesting">import_firesting</a></code>, <code><a href="#topic+import_presens">import_presens</a></code>, <code><a href="#topic+conv_o2">conv_o2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file('extdata', 'witrox_file.txt', package = 'respirometry')
import_witrox(file, o2_unit = 'umol_per_l')

# Oops. I forgot to change the salinity value when I calibrated
# the instrument. Override the values in the file for 35 psu.
import_witrox(file, o2_unit = 'umol_per_kg', overwrite_sal = 35)

# I want each channel as a separate data frame.
data_list &lt;- import_witrox(file, split_channels = TRUE)
data_list$CH_3 # here's the channel 3 data frame.

## End(Not run)

</code></pre>

<hr>
<h2 id='make_bins'>Make time binning thresholds for MO2 calculations</h2><span id='topic+make_bins'></span>

<h3>Description</h3>

<p>The width of time bins seems to be an under-appreciated consideration when calculating metabolic rates if PO2 or time are interesting covariates. The wider the bins, the higher the precision of your calculated MO2 value (more observations to average over), but at a loss of resolution of an interesting covariate. The narrower the bins, the higher the resolution of the PO2 or time covariate, but at a cost of lower precision. For Pcrit trials, I have found good success using bins of 1/10th the trial duration at the highest PO2s (where good precision is important) and 1/100th the trial duration at the lowest PO2s (where good resolution is important). Thus, these are the defaults, but can be changed as desired.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_bins(
  o2,
  duration,
  good_data = TRUE,
  min_o2_width = 1/100,
  max_o2_width = 1/10,
  n_thresholds = 10
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_bins_+3A_o2">o2</code></td>
<td>
<p>numeric vector of O2 observations.</p>
</td></tr>
<tr><td><code id="make_bins_+3A_duration">duration</code></td>
<td>
<p>numeric vector of the timepoints for each observation (minutes).</p>
</td></tr>
<tr><td><code id="make_bins_+3A_good_data">good_data</code></td>
<td>
<p>logical vector of whether O2 observations are &quot;good&quot; measurements and should be included in analysis. Default is that all observations are <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="make_bins_+3A_min_o2_width">min_o2_width</code></td>
<td>
<p>The duration of the bins at the lowest O2 value, expressed as a proportion of the total &quot;good&quot; trial duration. Default is 1/100th of the total &quot;good&quot; trial duration.</p>
</td></tr>
<tr><td><code id="make_bins_+3A_max_o2_width">max_o2_width</code></td>
<td>
<p>The duration of the bins at the highest O2 value, expressed as a proportion of the total &quot;good&quot; trial duration. Default is 1/10th of the total &quot;good&quot; trial duration.</p>
</td></tr>
<tr><td><code id="make_bins_+3A_n_thresholds">n_thresholds</code></td>
<td>
<p>Default is 10.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with <code>n_thresholds</code> rows and two columns is returned. Each row describes the threshold and the duration of observations that will be binned together at or above the corresponding O2 value.
</p>

<dl>
<dt>o2</dt><dd><p>The various O2 thresholds at which bin widths change.</p>
</dd>
<dt>width</dt><dd><p>The bin width applied to values greater than the corresponding row's O2 value but less than the next greater O2 value.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_MO2">calc_MO2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get O2 data
file &lt;- system.file('extdata', 'witrox_file.txt', package = 'respirometry')
o2_data &lt;- na.omit(import_witrox(file, split_channels = TRUE)$CH_4)

# Total trial duration is 21.783 minutes

make_bins(o2 = o2_data$O2, duration = o2_data$DURATION) # creates the default 10 bins. At the
# highest O2 levels, bin widths are 21.783/10 = 2.1783 mins and at the lowest O2 levels, bin
# widths are 21.783/100 = 0.21783 mins.

bins &lt;- make_bins(o2 = o2_data$O2, duration = o2_data$DURATION, min_o2_width = 1/20,
max_o2_width = 1/3, n_thresholds = 5) # creates 5 bins. At the highest O2 levels, bin widths are
# 21.783/3 = 7.261 mins and at the lowest O2 levels, bin widths are 21.783/20 = 1.089 mins.

(mo2 &lt;- calc_MO2(duration = o2_data$DURATION, o2 = o2_data$O2,
bin_width = bins, vol = 10, temp = o2_data$TEMP, sal = o2_data$SAL))

</code></pre>

<hr>
<h2 id='max_MO2'>Maximum MO2 supported by flow rate</h2><span id='topic+max_MO2'></span><span id='topic+max_mo2'></span>

<h3>Description</h3>

<p>Calculates the maximum oxygen consumption rate (MO2) supported by a respirometer with a given flow rate. Useful for ensuring an acclimating animal maintains a normoxic environment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>max_MO2(
  flow_rate,
  min_pO2 = 90,
  pO2_in = 100,
  temp = 25,
  sal = 35,
  atm_pres = 1013.25
)

max_mo2(
  flow_rate,
  min_pO2 = 90,
  pO2_in = 100,
  temp = 25,
  sal = 35,
  atm_pres = 1013.25
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="max_MO2_+3A_flow_rate">flow_rate</code></td>
<td>
<p>water flow rate into respirometer (liters / min).</p>
</td></tr>
<tr><td><code id="max_MO2_+3A_min_po2">min_pO2</code></td>
<td>
<p>minimum pO2 acceptable in respirometer (% air saturation). Default is 90% air saturation.</p>
</td></tr>
<tr><td><code id="max_MO2_+3A_po2_in">pO2_in</code></td>
<td>
<p>pO2 of water entering respirometer (% air saturation). Default is 100% air saturation.</p>
</td></tr>
<tr><td><code id="max_MO2_+3A_temp">temp</code></td>
<td>
<p>temperature (°C). Default is 25 °C.</p>
</td></tr>
<tr><td><code id="max_MO2_+3A_sal">sal</code></td>
<td>
<p>salinity (psu). Default is 35 psu.</p>
</td></tr>
<tr><td><code id="max_MO2_+3A_atm_pres">atm_pres</code></td>
<td>
<p>atmospheric pressure (mbar). Default is 1013.25 mbar.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The maximum whole-animal oxygen consumption rate (umol / hr) that can be sustained.
</p>


<h3>Note</h3>

<p>Keep in mind that most organisms are very stressed upon being placed in a respirometer and their MO2 may be much higher than basal MO2.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>References</h3>

<p>Steffensen JF. 1989. Some errors in respirometry of aquatic breathers: How to avoid and correct for them. Fish Physiol Biochem. 6:49–59. Equation 8.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+min_flow">min_flow</a></code>, <code><a href="#topic+flush_water">flush_water</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>max_MO2(flow_rate = 1)

# What is the maximum MO2 organism I can place in my respirometer and still maintain at
# least 75% air saturation when the intake fresh water is 1.5 LPM, 10 °C and 90% air saturated?
(max_mo2 &lt;- max_MO2(flow_rate = 1.5, min_pO2 = 75, pO2_in = 90, temp = 10, sal = 0))

# If a 300 g individual has an MO2 of 2000 umol/hr, how big of an animal can I use?
scale_MO2(mass_1 = 300, MO2_1 = 2000, MO2_2 = max_mo2) # I can almost support a 1 kg individual!

</code></pre>

<hr>
<h2 id='mean_pH'>Mean pH by [H+]</h2><span id='topic+mean_pH'></span>

<h3>Description</h3>

<p>Calculates mean pH from a vector of pH values by averaging [H+] rather than numerical pH values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mean_pH(pH, na.rm = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mean_pH_+3A_ph">pH</code></td>
<td>
<p>a numeric vector of pH values.</p>
</td></tr>
<tr><td><code id="mean_pH_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be stripped before the computation proceeds.</p>
</td></tr>
<tr><td><code id="mean_pH_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Since pH is on a logarithmic scale, averaging pH values directly does not provide the true arithmetic mean of what is likely truly important to the organism, [H+] (however, see Boutilier and Shelton 1980). Thus, the pH values are converted to [H+] then averaged and converted back to a mean pH value.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>References</h3>

<p>Boutilier RG, Shelton G. 1980. The statistical treatment of hydrogen ion concentration and pH. J Exp Biol. 84:335–339.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mean_pH(c(7, 8)) # 7.26 rather than 7.5!

</code></pre>

<hr>
<h2 id='min_flow'>Minimum flow rate to support MO2</h2><span id='topic+min_flow'></span>

<h3>Description</h3>

<p>Calculates the minimum flow rate into a respirometer required to maintain a high pO2. Useful for ensuring an acclimating animal maintains a normoxic environment. It can also be used to estimate the flow rate needed for a given pO2 decrease desired for flow-through respirometry.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>min_flow(
  MO2,
  min_pO2 = 90,
  pO2_in = 100,
  temp = 25,
  sal = 35,
  atm_pres = 1013.25
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="min_flow_+3A_mo2">MO2</code></td>
<td>
<p>whole-animal oxygen consumption rate (umol / hour).</p>
</td></tr>
<tr><td><code id="min_flow_+3A_min_po2">min_pO2</code></td>
<td>
<p>minimum pO2 acceptable in respirometer (% air saturation). Default is 90% air saturation.</p>
</td></tr>
<tr><td><code id="min_flow_+3A_po2_in">pO2_in</code></td>
<td>
<p>pO2 of water entering respirometer (% air saturation). Default is 100% air saturation.</p>
</td></tr>
<tr><td><code id="min_flow_+3A_temp">temp</code></td>
<td>
<p>temperature (°C). Default is 25 °C.</p>
</td></tr>
<tr><td><code id="min_flow_+3A_sal">sal</code></td>
<td>
<p>salinity (psu). Default is 35 psu.</p>
</td></tr>
<tr><td><code id="min_flow_+3A_atm_pres">atm_pres</code></td>
<td>
<p>atmospheric pressure (mbar). Default is 1013.25 mbar.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The flow rate (liters / min) into the respirometer required for the steady state pO2 to be <code>min_pO2</code>.
</p>


<h3>Note</h3>

<p>Keep in mind that most organisms are very stressed upon being placed in a respirometer and their MO2 may be much higher than basal MO2.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>References</h3>

<p>Steffensen JF. 1989. Some errors in respirometry of aquatic breathers: How to avoid and correct for them. Fish Physiol Biochem. 6:49–59. Equation 8.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+max_MO2">max_MO2</a></code>, <code><a href="#topic+flush_water">flush_water</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>min_flow(MO2 = 1000)

# What is the minimum flow rate required to maintain at least 75% air saturation in a
# respirometer with an organism(s) with an oxygen consumption rate of 1000 umol/h
# when the intake fresh water is 10 °C and 90% air saturated?
min_flow(MO2 = 1000, min_pO2 = 75, pO2_in = 90, temp = 10, sal = 0)

</code></pre>

<hr>
<h2 id='peri_pump'>Calculate peristaltic pump gaseous flow rate</h2><span id='topic+peri_pump'></span>

<h3>Description</h3>

<p>Given the number of moles of a gas, calculates the liters to run through a peristaltic pump.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>peri_pump(
  mol,
  species = "O2",
  temp = 25,
  reg_pres,
  reg_unit = "psi",
  atm_pres = 1013.25
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="peri_pump_+3A_mol">mol</code></td>
<td>
<p>number of moles to go through a peristaltic pump.</p>
</td></tr>
<tr><td><code id="peri_pump_+3A_species">species</code></td>
<td>
<p>character string describing the gas species. Options are available from <code><a href="marelac.html#topic+molvol">molvol</a></code>. Default is &quot;O2&quot;.</p>
</td></tr>
<tr><td><code id="peri_pump_+3A_temp">temp</code></td>
<td>
<p>temperature (°C). Default is 25 °C.</p>
</td></tr>
<tr><td><code id="peri_pump_+3A_reg_pres">reg_pres</code></td>
<td>
<p>gauge pressure from the gas regulator into the peristaltic pump.</p>
</td></tr>
<tr><td><code id="peri_pump_+3A_reg_unit">reg_unit</code></td>
<td>
<p>unit used in <code>reg_pres</code>. Default is &quot;psi&quot;.</p>
</td></tr>
<tr><td><code id="peri_pump_+3A_atm_pres">atm_pres</code></td>
<td>
<p>atmospheric pressure (mbar). Default is 1013.25 mbar.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Most mass flow controllers are programmed with a &quot;standard condition&quot; something like 0 *C and 1013 mbar for which they account for the pressure and temperature of an incoming gas source. For setups without expensive mass flow controllers, a more affordable alternative is to use a peristaltic pump. These do not account for variations in incoming gas pressure and temperature and thus, it must be calculated to set the peristaltic pump to the correct RPM.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+co2_rate">co2_rate</a></code>, <code><a href="#topic+co2_add">co2_add</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>peri_pump(mol = 0.5, species = 'O2', temp = 10, reg_pres = 5, reg_unit = "kPa")
# To flow 0.5 moles of O2, then flow 11.1 L.

</code></pre>

<hr>
<h2 id='plot_pcrit'>Plot Pcrit</h2><span id='topic+plot_pcrit'></span>

<h3>Description</h3>

<p>Creates a Pcrit plot (the threshold below which oxygen consumption rate can no longer be sustained) based on paired PO2 and MO2 values. Five Pcrit metrics are plotted: the traditional breakpoint metric (broken stick regression, black), the nonlinear regression metric (Marshall et al. 2013, green), the sub-prediction interval metric (Birk et al. 2019, red), the alpha-based Pcrit method (Seibel et al., 2021, blue), and the linear low O2 (LLO) method (Reemeyer &amp; Rees 2019, purple). For details on how the Pcrit values are calculated, see <code><a href="#topic+calc_pcrit">calc_pcrit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_pcrit(
  po2,
  mo2,
  mo2_data,
  method = "Breakpoint",
  avg_top_n = 1,
  level = 0.95,
  iqr = 1.5,
  NLR_m = 0.065,
  MR = NULL,
  mo2_threshold = Inf,
  showNLRs = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_pcrit_+3A_po2">po2</code></td>
<td>
<p>a vector of PO2 values. Any unit of measurement should work, but the NLR calculation was optimized using kPa. If the NLR metric is giving you trouble, try converting to kPa using <code><a href="#topic+conv_o2">conv_o2</a></code>.</p>
</td></tr>
<tr><td><code id="plot_pcrit_+3A_mo2">mo2</code></td>
<td>
<p>a vector of metabolic rate values. Must be the same length and corresponding to <code>po2</code>.</p>
</td></tr>
<tr><td><code id="plot_pcrit_+3A_mo2_data">mo2_data</code></td>
<td>
<p>for convenience, the output of <code><a href="#topic+calc_MO2">calc_MO2</a></code> can be entered here, as an alternative to specifying the <code>po2</code> and <code>mo2</code> parameters (optional).</p>
</td></tr>
<tr><td><code id="plot_pcrit_+3A_method">method</code></td>
<td>
<p>Over the years, many different methods of analysis have been proposed to quantify Pcrit. You must choose one of the following: Alpha, Breakpoint (default), LLO, NLR, Sub_PI, All. If in doubt, try &quot;All&quot;.</p>
</td></tr>
<tr><td><code id="plot_pcrit_+3A_avg_top_n">avg_top_n</code></td>
<td>
<p>applies to the <code>alpha</code> metric only (only when <code>method == "Alpha"</code> or <code>"All"</code>). A numeric value representing the number of top <code class="reqn">\alpha0</code> (MO2/PO2) values to average together to estimate <code class="reqn">\alpha</code>. Default is 1. We recommend no more than 3 to avoid diminishing the <code class="reqn">\alpha</code> value with sub-maximal observations.</p>
</td></tr>
<tr><td><code id="plot_pcrit_+3A_level">level</code></td>
<td>
<p>applies to the <code>Sub_PI</code> metric only (only when <code>method == "Sub_PI"</code> or <code>"All"</code>). Percentage at which the prediction interval should be constructed. Default is 0.95.</p>
</td></tr>
<tr><td><code id="plot_pcrit_+3A_iqr">iqr</code></td>
<td>
<p>applies to the <code>Sub_PI</code> metric only (only when <code>method == "Sub_PI"</code> or <code>"All"</code>). Removes <code>mo2</code> observations that are this many interquartile ranges away from the mean value for the oxyregulating portion of the trial. If this filtering is not desired, set to infinity. To visualize which observations will be removed by this parameter, use <code><a href="#topic+plot_pcrit">plot_pcrit</a></code>. Default is 1.5.</p>
</td></tr>
<tr><td><code id="plot_pcrit_+3A_nlr_m">NLR_m</code></td>
<td>
<p>applies to the <code>NLR</code> metric only (only when <code>method == "NLR"</code> or <code>"All"</code>). Pcrit is defined as the PO2 at which the slope of the best fitting function equals <code>NLR_m</code> (after the MO2 data are normalized to the 90% quantile). Default is 0.065.</p>
</td></tr>
<tr><td><code id="plot_pcrit_+3A_mr">MR</code></td>
<td>
<p>applies to the <code>alpha</code> and <code>LLO</code> metrics only (only when <code>method == "Alpha", "LLO"</code> or <code>"All"</code>). A numeric value for the metabolic rate at which <code>pcrit_alpha</code> and <code>pcrit_LLO</code> should be returned. If not supplied by the user, then the mean MO2 of the &quot;oxyregulating&quot; portion of the curve is applied for <code>pcrit_alpha</code> and <code>NA</code> is returned for <code>pcrit_LLO</code>.</p>
</td></tr>
<tr><td><code id="plot_pcrit_+3A_mo2_threshold">mo2_threshold</code></td>
<td>
<p>applies to the <code>alpha</code> metric only (only when <code>method == "Alpha"</code> or <code>"All"</code>). A single numeric value above which <code>mo2</code> values are ignored for <code>alpha</code> Pcrit estimation. Useful to removing obviously erroneous values. Default is <code>Inf</code>.</p>
</td></tr>
<tr><td><code id="plot_pcrit_+3A_shownlrs">showNLRs</code></td>
<td>
<p>logical. Should all the NLR functions be plotted in a second plot? If <code>FALSE</code> then only the best fit NLR function will be plotted.</p>
</td></tr>
<tr><td><code id="plot_pcrit_+3A_...">...</code></td>
<td>
<p>arguments to be passed to <code><a href="segmented.html#topic+plot.segmented">plot.segmented</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<dl>
<dt>Alpha Pcrit</dt><dd><p>Alpha is calculated from <code><a href="#topic+calc_alpha">calc_alpha</a></code> and the Pcrit corresponding to <code>MR</code> is returned. This determine's the animal's oxygen supply capacity and calculates the Pcrit at any given metabolic rate of interest. If no <code>MR</code> is provided, then it defaults to the mean MO2 value from the oxyregulating portion of the curve (as defined by the broken-stick regression).</p>
</dd>
<dt>Breakpoint Pcrit</dt><dd><p>Data are fit to a broken-stick regression using <code><a href="segmented.html#topic+segmented">segmented</a></code>.</p>
</dd>
<dt>LLO Pcrit</dt><dd><p>A subset of observations are chosen only from those with an MO2 &lt; <code>MR</code>. Then, a linear model is fit through the observations and Pcrit is calculated as the PO2 at which the line reaches <code>MR</code>.</p>
</dd>
<dt>NLR Pcrit</dt><dd><p>Data are fit to the following functions: Michaelis-Menten, Power, Hyperbola, Pareto, and Weibull with intercept. Following the method developed by Marshall et al. 2013, the function that best fits the data (smallest AIC) is chosen and the Pcrit is determined as the PO2 at which the slope of the function is <code>NLR_m</code> (by default = 0.065 following the authors' suggestion).</p>
</dd>
<dt>Sub_PI Pcrit</dt><dd><p>This metric builds off the <code>Breakpoint</code> metric and results in a systematically lower Pcrit value. This is useful for applications where it is important to ensure that Pcrit is not being overestimated. It represents a reasonable lower bounded estimate of the Pcrit value for a given trial. Once the <code>Breakpoint</code> Pcrit is calculated, a 95% prediction interval (can be changed with the <code>level</code> argument) is calculated around the oxyregulating region (i.e. using PO2 values &gt; breakpoint Pcrit). By default, <code>iqr</code> provides some filtering of abberant observations to prevent their influence on the calculated prediction interval. Finally, the Sub_PI Pcrit value is returned at the intersection of the oxyconforming line and the lower limit of the oxyregulating prediction interval.</p>
</dd>
</dl>



<h3>Value</h3>

<p>A plot is created showing the relationship between PO2 and MO2. Based on the <code>method</code> used, the alpha, breakpoint, LLO, NLR, and/or sub-PI Pcrit values are shown in the title and on the plot by inverted triangles.
</p>
<p>For breakpoint and sub-PI methods, the broken-stick regression is shown by black lines. The gray bands represent the confidence interval (defaults to 95% but will change with <code>level</code>). 
</p>
<p>For the sub-PI method, the dashed red curves signify the prediction interval used. Black circles represent oxyregulating observations used in the generation of the prediction interval, while grey circles represent both the oxyconforming observations and those observations outside the IQR threshold (defined by <code>iqr</code>). 
</p>
<p>For the NLR method, the green curve represents the best fitting NLR function and the green inverted triangle represents the NLR Pcrit (modified by <code>NLR_m</code>) 
</p>
<p>For the Alpha method, the blue line represents alpha, which was fit based on the blue circle observation(s). If <code>MR</code> is not defined by the user, then the black points are those that were averaged to choose <code>MR</code>. These are the &quot;oxyregulating&quot; observations based on the breakpoint method.
</p>
<p>If <code>showNLRs = TRUE</code>, then a second plot is generated which shows all the NLR functions that converged. Vertical lines represent the Pcrit values corresponding to each curve.
</p>
<p>Black = Michaelis-Menten
</p>
<p>Red = Power
</p>
<p>Green = Hyperbola
</p>
<p>Blue = Pareto
</p>
<p>Cyan = Weibull with intercept.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>References</h3>

<p>Birk, Matthew A., K.A.S. Mislan, Karen F. Wishner, and Brad A. Seibel. 2019. “Metabolic Adaptations of the Pelagic Octopod Japetella Diaphana to Oxygen Minimum Zones.” Deep-Sea Research Part I 148: 123–31.
</p>
<p>Marshall, Dustin J., Michael Bode, and Craig R. White. 2013. “Estimating Physiological Tolerances - a Comparison of Traditional Approaches to Nonlinear Regression Techniques.” Journal of Experimental Biology 216(12): 2176–82.
</p>
<p>Reemeyer, Jessica E., and Bernard B. Rees. 2019. “Standardizing the Determination and Interpretation of Pcrit in Fishes.” Journal of Experimental Biology 222(18): jeb210633.
</p>
<p>Seibel, B. A., A. Andres, M. A. Birk, A. L. Burns, C. T. Shaw, A. W. Timpe, C. J. Welsh. 2021. “Oxygen supply capacity breathes new life into the critical oxygen partial pressure (Pcrit).” Journal of Experimental Biology.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_pcrit">calc_pcrit</a></code>, <code><a href="#topic+calc_alpha">calc_alpha</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>raw_data &lt;- system.file('extdata/pcrit_run/', package = 'respirometry')
o2_data &lt;- import_pyroscience_workbench(folder = raw_data)
mo2_data &lt;- calc_MO2(duration = o2_data$DURATION, o2 = o2_data$CH_1_O2, bin_width = 10, vol = 3)
plot_pcrit(mo2_data = mo2_data)

par(mfrow = c(2, 1))
plot_pcrit(po2 = mo2_data$O2_MEAN, mo2 = mo2_data$MO2, method = 'All', MR = 100, showNLRs = TRUE)

</code></pre>

<hr>
<h2 id='predict_nh3'>Predict NH3 / NH4+ concentration post-respiration</h2><span id='topic+predict_nh3'></span>

<h3>Description</h3>

<p>Predicts the [NH3] and [NH4+] of seawater after a defined amount of oxygen consumption. Ammonotelic animals excrete the ionized form NH4+ (ammonium) but some of these ions dissociate into unionized NH3 (ammonia) which is toxic for most fishes and crustaceans around 0.4-2.0 mg/L (Boyd 2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_nh3(
  o2_drop = 10,
  o2_unit = "percent_a.s.",
  o2_nh4_ratio,
  temp = 25,
  sal = 35,
  pH = 8.1,
  atm_pres = 1013.25
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict_nh3_+3A_o2_drop">o2_drop</code></td>
<td>
<p>a numeric value or vector describing the change in O2. Default is 10.</p>
</td></tr>
<tr><td><code id="predict_nh3_+3A_o2_unit">o2_unit</code></td>
<td>
<p>a string describing the unit used to measure <code>o2_drop</code>. Default is &quot;percent_a.s.&quot; Options are from <code><a href="#topic+conv_o2">conv_o2</a></code>.</p>
</td></tr>
<tr><td><code id="predict_nh3_+3A_o2_nh4_ratio">o2_nh4_ratio</code></td>
<td>
<p>molar ratio of O2 consumed to NH4+ produced.</p>
</td></tr>
<tr><td><code id="predict_nh3_+3A_temp">temp</code></td>
<td>
<p>temperature (°C). Default is 25 °C.</p>
</td></tr>
<tr><td><code id="predict_nh3_+3A_sal">sal</code></td>
<td>
<p>salinity (psu). Default is 35 psu.</p>
</td></tr>
<tr><td><code id="predict_nh3_+3A_ph">pH</code></td>
<td>
<p>seawater pH (total scale). Default is 8.1.</p>
</td></tr>
<tr><td><code id="predict_nh3_+3A_atm_pres">atm_pres</code></td>
<td>
<p>atmospheric pressure (mbar). Default is 1013.25 mbar.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a known amount of oxygen consumed and an estimated O2:N ratio, the amount of NH4 produced can be estimated. Production or consumption of ammonium by &quot;background&quot; microbes or conversion of ammonium to nitrite and nitrate is ignored since bacteria in the respirometer are typically sought to be in low levels. The amount of dissociation to produce ammonia is calculated by <code><a href="seacarb.html#topic+Kn">Kn</a></code>.
</p>


<h3>Value</h3>

<p>A list containing the predicted NH3, NH4+, and TAN produced in mg/l.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>References</h3>

<p>Boyd C. 2012. Water Quality. In &quot;Aquaculture: Farming Aquatic Animals and Plants&quot;. Blackwell Publishing, Ltd.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+conv_o2">conv_o2</a></code>, <code><a href="#topic+conv_nh4">conv_nh4</a></code>, <code><a href="seacarb.html#topic+Kn">Kn</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>predict_nh3(o2_drop = 25, o2_nh4_ratio = 10)

</code></pre>

<hr>
<h2 id='predict_pH'>Predict pH post-respiration</h2><span id='topic+predict_pH'></span>

<h3>Description</h3>

<p>Predicts the pH of seawater after a defined amount of oxygen consumption.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_pH(
  start_o2 = 100,
  end_o2,
  start_pH,
  temp = 25,
  sal = 35,
  RQ = 1,
  TA = NULL,
  all_carb = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict_pH_+3A_start_o2">start_o2</code></td>
<td>
<p>pO2 at the start of the measurement (% air saturation). Default is 100% air saturation.</p>
</td></tr>
<tr><td><code id="predict_pH_+3A_end_o2">end_o2</code></td>
<td>
<p>pO2 at the end of the measurment (% air saturation).</p>
</td></tr>
<tr><td><code id="predict_pH_+3A_start_ph">start_pH</code></td>
<td>
<p>seawater pH (total scale) at the start of the measurement.</p>
</td></tr>
<tr><td><code id="predict_pH_+3A_temp">temp</code></td>
<td>
<p>temperature (°C). Default is 25 °C.</p>
</td></tr>
<tr><td><code id="predict_pH_+3A_sal">sal</code></td>
<td>
<p>salinity (psu). Default is 35 psu. If <code>sal</code> &lt; 26 psu, then <code>TA</code> must be provided.</p>
</td></tr>
<tr><td><code id="predict_pH_+3A_rq">RQ</code></td>
<td>
<p>respiratory quotient: ratio of CO2 produced / O2 consumed. Default is 1.</p>
</td></tr>
<tr><td><code id="predict_pH_+3A_ta">TA</code></td>
<td>
<p>(optional) total alkalinity (umol / kg). If undefined TA is estimated from salinity using <code><a href="#topic+guess_TA">guess_TA</a></code>.</p>
</td></tr>
<tr><td><code id="predict_pH_+3A_all_carb">all_carb</code></td>
<td>
<p>logical. Should all carbonate chemistry parameters be returned? Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a known amount of oxygen consumed and an estimated respiratory quotient (see <code><a href="#topic+Q10">Q10</a></code>), the amount of CO2 produced can be estimated. From this CO2 production estimate, the carbonate chemistry of the seawater can be estimated. Atmospheric pressure is assumed.
</p>


<h3>Value</h3>

<p>If <code>all_carb</code> is <code>FALSE</code>, then a list of the predicted pH (total scale) at the end of the measurement and the predicted pCO2 (uatm) are returned. If <code>all_carb</code> is <code>TRUE</code>, then the predicted carbonate chemistry parameters are returned from <code><a href="seacarb.html#topic+carb">carb</a></code>.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="seacarb.html#topic+carb">carb</a></code>, <code><a href="#topic+guess_TA">guess_TA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>predict_pH(end_o2 = 75, start_pH = 8.1)
predict_pH(start_o2 = 75, end_o2 = 50, start_pH = 7.96, temp = 15, sal = 33, RQ = 0.88)

# I know pH at the end was 7.8, but what was pH at the beginning?
predict_pH(start_o2 = 75, end_o2 = 100, start_pH = 8.013536) # reverse the order

</code></pre>

<hr>
<h2 id='Q10'>Parameters of Q10 Temperature Coefficient</h2><span id='topic+Q10'></span><span id='topic+q10'></span><span id='topic+calc_q10'></span>

<h3>Description</h3>

<p>Calculates parameters from Q10 temperature coefficient for chemical or biological systems. This function can be used in two ways. 1. if four of the first five parameters are given (<code>Q10</code>, <code>R1</code>, <code>R2</code>, <code>T1</code>, <code>T2</code>) then the fifth parameter is returned, or 2. if <code>R_vec</code> and <code>T_vec</code> are given, then the best Q10 for those data is returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Q10(Q10, R1, R2, T1, T2, R_vec, T_vec, model = FALSE)

q10(Q10, R1, R2, T1, T2, R_vec, T_vec, model = FALSE)

calc_q10(Q10, R1, R2, T1, T2, R_vec, T_vec, model = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Q10_+3A_q10">Q10</code></td>
<td>
<p>factor by which rate changes due to 10 °C increase in temperature.</p>
</td></tr>
<tr><td><code id="Q10_+3A_r1">R1</code></td>
<td>
<p>rate 1. Could also be Pcrit or any other temperature-dependent biological parameters.</p>
</td></tr>
<tr><td><code id="Q10_+3A_r2">R2</code></td>
<td>
<p>rate 2. Could also be Pcrit or any other temperature-dependent biological parameters.</p>
</td></tr>
<tr><td><code id="Q10_+3A_t1">T1</code></td>
<td>
<p>temperature 1 (in °C).</p>
</td></tr>
<tr><td><code id="Q10_+3A_t2">T2</code></td>
<td>
<p>temperature 2 (in °C).</p>
</td></tr>
<tr><td><code id="Q10_+3A_r_vec">R_vec</code></td>
<td>
<p>a vector of temperature-dependent values, such as rates (e.g. MO2), Pcrit or other biological parameters.</p>
</td></tr>
<tr><td><code id="Q10_+3A_t_vec">T_vec</code></td>
<td>
<p>a vector of temperature values (in °C).</p>
</td></tr>
<tr><td><code id="Q10_+3A_model">model</code></td>
<td>
<p>logical. If <code>TRUE</code>, then a list is returned which includes an linear model of <code>log10(R_vec)</code> and <code>T_vec</code> fit by <code>stats::lm()</code>. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">Q_{10} = (R_2 / R_1) ^ {\frac{10}{T_2 - T_1}}</code>
</p>



<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scale_MO2">scale_MO2</a></code>, <code><a href="#topic+calc_E">calc_E</a></code>, <code><a href="#topic+adj_by_temp">adj_by_temp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Q10(R1 = 5, R2 = 10, T1 = 10, T2 = 20) # Returns Q10; = 2
Q10(Q10 = 2.66, R1 = 5, T1 = 10, T2 = 20) # Returns R2; = 13.3

# My species has an MO2 of 9.5 umol/g/h at 10 *C. What MO2 should I expect at 13 *C?
Q10(Q10 = 2, R1 = 9.5, T1 = 10, T2 = 13) # expect ~11.7 umol/g/h at 13 *C.

# I measured MO2 at a spectrum of temperatures. What Q10 value best fits my data?
Q10(R_vec = c(1, 2, 5, NA, 18, 33), T_vec = c(0, 10, 20, 30, 40, 50))

# A 100 g individual at 10 *C has an MO2 of 1270 umol/h. How much
# would a 250 g individual likely consume at 14 *C?
Q10(Q10 = 2, R1 = scale_MO2(mass_1 = 100, MO2_1 = 1270, mass_2 = 250), T1 = 10, T2 = 14)

# Visualize MO2 scaling by mass and temperature:
mass &lt;- seq(10, 200, 10)
temp &lt;- 10:25
base_mass &lt;- 50
base_temp &lt;- 20
base_MO2 &lt;- 750
mo2 &lt;- outer(mass, temp, function(mass, temp){
	scale_MO2(mass_1 = base_mass, mass_2 = mass, MO2_1 = Q10(Q10 = 2, R1 = base_MO2,
	 T1 = base_temp, T2 = temp))
})
persp(mass, temp, mo2, xlab = 'Mass (g)', ylab = 'Temperature (*C)', zlab = 'MO2 (umol / hr)',
 theta = 35, phi = 15, expand = 0.5, ticktype = 'detailed', nticks = 10)

</code></pre>

<hr>
<h2 id='RQ'>Calculate respiratory quotient</h2><span id='topic+RQ'></span>

<h3>Description</h3>

<p>Calculates the respiratory quotient (RQ), or ratio of CO2 produced to O2 consumed between observations. To calculate CO2 produced, either DIC or both pH and TA must be provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RQ(
  o2,
  o2_unit = "percent_a.s.",
  pH = NULL,
  TA = NULL,
  DIC = NULL,
  temp = 25,
  sal = 35,
  atm_pres = 1013.25
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RQ_+3A_o2">o2</code></td>
<td>
<p>a numeric vector of O2 values with a length of at least 2.</p>
</td></tr>
<tr><td><code id="RQ_+3A_o2_unit">o2_unit</code></td>
<td>
<p>a string describing the unit used to measure <code>o2</code>. Default is &quot;percent_a.s.&quot; Options are from <code><a href="#topic+conv_o2">conv_o2</a></code>.</p>
</td></tr>
<tr><td><code id="RQ_+3A_ph">pH</code></td>
<td>
<p>pH (total scale). Elements must align with <code>o2</code> vector.</p>
</td></tr>
<tr><td><code id="RQ_+3A_ta">TA</code></td>
<td>
<p>total alkalinity (umol / kg). May be either a vector with length equal to <code>o2</code> or a single numeric value.</p>
</td></tr>
<tr><td><code id="RQ_+3A_dic">DIC</code></td>
<td>
<p>dissolved inorganic carbon (umol / kg). Elements must align with <code>o2</code> vector.</p>
</td></tr>
<tr><td><code id="RQ_+3A_temp">temp</code></td>
<td>
<p>temperature (°C). Default is 25 °C.</p>
</td></tr>
<tr><td><code id="RQ_+3A_sal">sal</code></td>
<td>
<p>salinity (psu). Default is 35 psu.</p>
</td></tr>
<tr><td><code id="RQ_+3A_atm_pres">atm_pres</code></td>
<td>
<p>atmospheric pressure (mbar). Default is 1013.25 mbar.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ratio of CO2 produced to O2 consumed.
</p>


<h3>Note</h3>

<p>If you want a rough estimate of RQ, but only have pH measurements, TA can be estimated from salinity using <code><a href="#topic+guess_TA">guess_TA</a></code>.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+conv_o2">conv_o2</a></code>, <code><a href="#topic+guess_TA">guess_TA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>o2_observations &lt;- c(21, 18, 14.5, 7)
pH_observations &lt;- c(8.05, 7.98, 7.86, 7.65)
TA_observations &lt;- c(2222, 2219, 2208, 2214)

RQ(o2 = o2_observations, o2_unit = 'kPa', pH = pH_observations,
TA = TA_observations, temp = 20, sal = 33)

DIC_observations &lt;- c(2222, 2250, 2284, 2355)
RQ(o2 = o2_observations, o2_unit = 'kPa', DIC = DIC_observations)

RQ(o2 = o2_observations, o2_unit = 'kPa', pH = pH_observations, TA = 2032)
</code></pre>

<hr>
<h2 id='scale_MO2'>Mass-correct metabolic rate</h2><span id='topic+scale_MO2'></span><span id='topic+scale_mo2'></span>

<h3>Description</h3>

<p>For most organisms, metabolic rate does not scale linearly, but rather according to a power curve. This function estimates MO2 or size of an individual organism given the MO2 and size of another individual of a different size. To mass-correct your MO2 data, plug in your desired mass in <code>mass_2</code> and the output from <code><a href="#topic+calc_b">calc_b</a></code> to the <code>b</code> parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_MO2(mass_1, MO2_1, mass_2, MO2_2, b = 0.75)

scale_mo2(mass_1, MO2_1, mass_2, MO2_2, b = 0.75)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scale_MO2_+3A_mass_1">mass_1</code></td>
<td>
<p>animal mass for <code>MO2_1</code>.</p>
</td></tr>
<tr><td><code id="scale_MO2_+3A_mo2_1">MO2_1</code></td>
<td>
<p>metabolic rate for <code>mass_1</code>.</p>
</td></tr>
<tr><td><code id="scale_MO2_+3A_mass_2">mass_2</code></td>
<td>
<p>animal mass for <code>MO2_2</code>.</p>
</td></tr>
<tr><td><code id="scale_MO2_+3A_mo2_2">MO2_2</code></td>
<td>
<p>metabolic rate for <code>mass_2</code>.</p>
</td></tr>
<tr><td><code id="scale_MO2_+3A_b">b</code></td>
<td>
<p>scaling coefficient for MO2. Default is 0.75.</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">(MO2 = b0 * M^b)</code>
</p>

<p>where <code>b0</code> is species-specific normalization constant, <code>M</code> is mass and <code>b</code> is the scaling coefficient which is around 0.75 for many organisms.
</p>
<p>For scaling of <strong>mass-specific</strong> metabolic rates, use something closer to <code>b = -0.25</code> rather than <code>b = 0.75</code>.
</p>


<h3>Author(s)</h3>

<p>Matthew A. Birk, <a href="mailto:matthewabirk@gmail.com">matthewabirk@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Q10">Q10</a></code>, <code><a href="#topic+calc_b">calc_b</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># I know a species has an SMR of 800 umol O2/h at 200 g.
# What would be a likely SMR for a 300 g individual?
scale_MO2(mass_1 = 200, MO2_1 = 800, mass_2 = 300)

# Some squids have a much higher scaling coefficient:
scale_MO2(mass_1 = 200, MO2_1 = 800, mass_2 = 300, b = 0.92)

# A 100 g individual at 10 *C has an MO2 of 1270 umol/h. How much
# would a 250 g individual likely consume at 14 *C?
Q10(Q10 = 2, R1 = scale_MO2(mass_1 = 100, MO2_1 = 1270, mass_2 = 250), T1 = 10, T2 = 14)

# Now I have data from real animals and I want to mass-correct them all to a 10 g animal.
mass = 2:20 # obviously not real but you get the point
mo2 = c(44.8, 41, 36, 35, 35, 33.5, 34.5, 40, 30, 23, 27, 30, 25.6, 27.8, 28, 24, 27, 28, 20)
desired_mass = 10

b = calc_b(mass = mass, MO2 = mo2)
scale_MO2(mass_1 = mass, MO2_1 = mo2, mass_2 = desired_mass, b = b$b)

plot(mass, mo2, ylab = 'Raw MO2') # before
plot(mass, scale_MO2(mass_1 = mass, MO2_1 = mo2, mass_2 = 10, b = b$b),
ylab = 'Mass-corrected MO2') # after


# Visualize MO2 scaling by mass and temperature:
mass &lt;- seq(10, 200, 10)
temp &lt;- 10:25
base_mass &lt;- 50
base_temp &lt;- 20
base_MO2 &lt;- 750
mo2 &lt;- outer(mass, temp, function(mass, temp){
	scale_MO2(mass_1 = base_mass, mass_2 = mass, MO2_1 = Q10(Q10 = 2, R1 = base_MO2,
	 T1 = base_temp, T2 = temp))
})
persp(mass, temp, mo2, xlab = 'Mass (g)', ylab = 'Temperature (*C)', zlab = 'MO2 (umol / hr)',
 theta = 35, phi = 15, expand = 0.5, ticktype = 'detailed', nticks = 10)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
