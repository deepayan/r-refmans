<!DOCTYPE html><html lang="en"><head><title>Help for package rasterVis</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rasterVis}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rasterVis-package'>
<p>Visualization Methods for Raster Data</p></a></li>
<li><a href='#bwplot-methods'><p>Box and whisker plots of Raster objects.</p></a></li>
<li><a href='#densityplot-methods'><p>Density plots for Raster objects.</p></a></li>
<li><a href='#Formula+20methods'><p>Formula methods</p></a></li>
<li><a href='#gplot-methods'><p>Use ggplot to plot a Raster* or a SpatRaster object.</p></a></li>
<li><a href='#histogram-methods'>
<p>Histogram of Raster objects.</p></a></li>
<li><a href='#horizonplot-methods'><p>Horizon plots of Raster objects.</p></a></li>
<li><a href='#hovmoller-methods'><p>Hovmoller plots</p></a></li>
<li><a href='#Interaction'>
<p>Interaction with trellis objects.</p></a></li>
<li><a href='#lattice'><p>Lines, points and polygons</p></a></li>
<li><a href='#levelplot-methods'><p>Level and contour plots of Raster objects.</p></a></li>
<li><a href='#plot3D'><p>Interactive 3D plot of a RasterLayer</p></a></li>
<li><a href='#rasterTheme'>
<p>Themes for <code>raster</code> with <code>lattice</code>.</p></a></li>
<li><a href='#splom-methods'><p>Scatter plot matrices of Raster objects.</p></a></li>
<li><a href='#vectorplot-methods'><p>Vector plots of Raster objects.</p></a></li>
<li><a href='#xyLayer'><p>xyLayer</p></a></li>
<li><a href='#xyplot-methods'><p>xyplot for Raster objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Visualization Methods for Raster Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.51.6</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Description:</td>
<td>Methods for enhanced visualization and interaction with raster data. It implements visualization methods for quantitative data and categorical data, both for univariate and multivariate rasters. It also provides methods to display spatiotemporal rasters, and vector fields. See the website for examples.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://oscarperpinan.github.io/rastervis/">https://oscarperpinan.github.io/rastervis/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/oscarperpinan/rastervis/issues">https://github.com/oscarperpinan/rastervis/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0), methods, lattice (&ge; 0.22-5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>raster (&ge; 3.4-13), terra (&ge; 1.7-17), latticeExtra, stats,
utils, parallel, grid, grDevices, RColorBrewer, hexbin, sp (&ge;
1.0-6), zoo, viridisLite</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rgl, ggplot2, colorspace, dichromat, sf</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-01 11:19:26 UTC; oscar</td>
</tr>
<tr>
<td>Author:</td>
<td>Oscar Perpinan Lamigueiro
    <a href="https://orcid.org/0000-0002-4134-7196"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [cre, aut],
  Robert Hijmans [aut],
  Alexandre Courtiol [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Oscar Perpinan Lamigueiro &lt;oscar.perpinan@upm.es&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-01 12:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='rasterVis-package'>
Visualization Methods for Raster Data
</h2><span id='topic+rasterVis-package'></span><span id='topic+rasterVis'></span>

<h3>Description</h3>

<p>Methods for enhanced visualization and interaction with raster data. It implements visualization methods for quantitative data and categorical data, both for univariate and multivariate rasters. It also provides methods to display spatiotemporal rasters, and vector fields. See the website for examples.
</p>


<h3>Details</h3>

<p>The <code>rasterVis</code> package complements the <code>raster</code> and
<code>terra</code> packages, providing a set of methods for enhanced
visualization and interaction. This package defines visualization
methods with <code>levelplot</code> for quantitative data and categorical
data, both for univariate and multivariate rasters.
</p>
<p>It also includes several methods in the frame of the Exploratory Data
Analysis approach: scatterplots with <code>xyplot</code>, histograms and
density plots with <code>histogram</code> and <code>densityplot</code>, violin and
boxplots with <code>bwplot</code>, and a matrix of scatterplots with
<code>splom</code>.
</p>
<p>On the other hand, this package is able to display vector fields using
arrows, <code>vectorplot</code>, or with streamlines, <code>streamplot</code>.
</p>

<p>Index of help topics:
</p>
<pre>
bwplot                  Box and whisker plots of Raster objects.
densityplot             Density plots for Raster objects.
gplot                   Use ggplot to plot a Raster* or a SpatRaster
                        object.
hexbinplot              Formula methods
histogram               Histogram of Raster objects.
horizonplot             Horizon plots of Raster objects.
hovmoller               Hovmoller plots
identifyRaster          Interaction with trellis objects.
levelplot               Level and contour plots of Raster objects.
llines.SpatVector       Lines, points and polygons
plot3D                  Interactive 3D plot of a RasterLayer
rasterTheme             Themes for 'raster' with 'lattice'.
rasterVis-package       Visualization Methods for Raster Data
splom                   Scatter plot matrices of Raster objects.
vectorplot              Vector plots of Raster objects.
xyLayer                 xyLayer
xyplot                  xyplot for Raster objects
</pre>

<hr>
<h2 id='bwplot-methods'>Box and whisker plots of Raster objects.</h2><span id='topic+bwplot'></span><span id='topic+bwplot+2CRasterStackBrick+2Cmissing-method'></span><span id='topic+bwplot+2Cformula+2CRaster-method'></span><span id='topic+bwplot+2CSpatRaster+2Cmissing-method'></span><span id='topic+bwplot+2Cformula+2CSpatRaster-method'></span>

<h3>Description</h3>

<p>Methods for <code>bwplot</code> and <code>RasterStackBrick</code> objects using
a combination of <code><a href="lattice.html#topic+panel.violin">panel.violin</a></code> and
<code><a href="lattice.html#topic+panel.bwplot">panel.bwplot</a></code> to compose the graphic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RasterStackBrick,missing'
bwplot(x, data=NULL, layers, FUN,
            maxpixels = 1e+05,
            xlab='', ylab='', main='',
            violin = TRUE, draw.points = FALSE, do.out = FALSE,
            par.settings = bwTheme(),
            violin.ratio = 1, box.ratio = 0.5,
            scales=list(x=list(rot=45, cex=0.8)),
            ...)
## S4 method for signature 'formula,Raster'
bwplot(x, data, dirXY, 
            maxpixels = 1e+05,
            xscale.components=xscale.raster,
            yscale.components=yscale.raster,
            horizontal=FALSE,
            violin = TRUE, draw.points = FALSE, do.out = FALSE,
            violin.ratio = 1, box.ratio = 0.5,
            par.settings = bwTheme(),
            ...)
## S4 method for signature 'SpatRaster,missing'
bwplot(x, data=NULL, layers, FUN,
            maxpixels = 1e+05,
            xlab='', ylab='', main='',
            violin = TRUE, draw.points = FALSE, do.out = FALSE,
            par.settings = bwTheme(),
            violin.ratio = 1, box.ratio = 0.5,
            scales=list(x=list(rot=45, cex=0.8)),
            ...)
## S4 method for signature 'formula,SpatRaster'
bwplot(x, data, dirXY, 
            maxpixels = 1e+05,
            xscale.components=xscale.raster,
            yscale.components=yscale.raster,
            horizontal=FALSE,
            violin = TRUE, draw.points = FALSE, do.out = FALSE,
            violin.ratio = 1, box.ratio = 0.5,
            par.settings = bwTheme(),
            ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bwplot-methods_+3A_x">x</code></td>
<td>
<p>A <code>RasterStackBrick</code> object, a <code>SpatRaster</code> object, or a <code>formula</code>.</p>
</td></tr>
<tr><td><code id="bwplot-methods_+3A_data">data</code></td>
<td>
<p><code>NULL</code>, a <code>Raster</code> object, or a <code>SpatRaster</code> object.</p>
</td></tr>
<tr><td><code id="bwplot-methods_+3A_layers">layers</code></td>
<td>
<p>A numeric or character which should indicate the layers
to be displayed.</p>
</td></tr>
<tr><td><code id="bwplot-methods_+3A_dirxy">dirXY</code></td>
<td>
<p>A direction as a function of the coordinates (see
<code><a href="#topic+xyLayer">xyLayer</a></code>).</p>
</td></tr>
<tr><td><code id="bwplot-methods_+3A_fun">FUN</code></td>
<td>
<p>A function to applied to the <code>z</code> slot of a
<code>RasterStackBrick</code> object, or the time index of a
<code>SpatRaster</code> object. The result of this function
is used as the grouping variable of the plot.</p>
</td></tr>
<tr><td><code id="bwplot-methods_+3A_maxpixels">maxpixels</code></td>
<td>
<p>A numeric, for <code><a href="raster.html#topic+sampleRandom">sampleRandom</a></code> or <code>spatSample</code>.</p>
</td></tr>
<tr><td><code id="bwplot-methods_+3A_xscale.components">xscale.components</code>, <code id="bwplot-methods_+3A_yscale.components">yscale.components</code></td>
<td>
<p>Graphical
parameters of <code>lattice</code>. See <code><a href="#topic+xyplot">xyplot</a></code> for
details.</p>
</td></tr>
<tr><td><code id="bwplot-methods_+3A_horizontal">horizontal</code></td>
<td>
<p>Defaults to <code>FALSE</code>, meaning that the right hand
of the formula is a factor or shingle.</p>
</td></tr>
<tr><td><code id="bwplot-methods_+3A_xlab">xlab</code>, <code id="bwplot-methods_+3A_ylab">ylab</code>, <code id="bwplot-methods_+3A_main">main</code></td>
<td>
<p>Labels for axis and title</p>
</td></tr></table>
<p>.
</p>
<table role = "presentation">
<tr><td><code id="bwplot-methods_+3A_violin">violin</code></td>
<td>
<p>Logical, if <code>TRUE</code> the panel is built with
<code>panel.violin</code> and <code>panel.bwplot</code>.</p>
</td></tr>
<tr><td><code id="bwplot-methods_+3A_draw.points">draw.points</code></td>
<td>
<p>Logical, if <code>TRUE</code> raw points are displayed in
the background with <code><a href="lattice.html#topic+panel.stripplot">panel.stripplot</a></code></p>
</td></tr>
<tr><td><code id="bwplot-methods_+3A_do.out">do.out</code></td>
<td>
<p>Logical, if <code>TRUE</code> outliers are drawn.</p>
</td></tr>
<tr><td><code id="bwplot-methods_+3A_box.ratio">box.ratio</code></td>
<td>
<p>ratio of box thickness to inter box space</p>
</td></tr>
<tr><td><code id="bwplot-methods_+3A_violin.ratio">violin.ratio</code></td>
<td>
<p>ratio of the thickness of each violin and inter violin space</p>
</td></tr>
<tr><td><code id="bwplot-methods_+3A_par.settings">par.settings</code>, <code id="bwplot-methods_+3A_scales">scales</code></td>
<td>
<p>See <code><a href="#topic+xyplot">xyplot</a></code> for details.</p>
</td></tr>
<tr><td><code id="bwplot-methods_+3A_...">...</code></td>
<td>
<p>Additional arguments for <code><a href="#topic+bwplot">bwplot</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Oscar Perpiñán Lamigueiro</p>


<h3>See Also</h3>

<p><code><a href="#topic+bwplot">bwplot</a></code>,
<code><a href="lattice.html#topic+panel.violin">panel.violin</a></code>,
<code><a href="raster.html#topic+subset">subset</a></code>,
<code><a href="#topic+bwTheme">bwTheme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
library(terra)

f &lt;- system.file("external/test.grd", package="raster")
r &lt;- raster(f)
s &lt;- stack(r, r-500, r+500)
bwplot(s)

bwplot(s, violin = FALSE, box.ratio = 1)

## Modify colours
myTheme &lt;- bwTheme(
    box.rectangle = list(col = 'green', fill = 'lightgreen'),
    plot.polygon = list(col = 'blue'),
    plot.symbol = list(col = 'gray', cex = 0.8, alpha = 0.1)
)
## Display raw points
bwplot(s, draw.points = TRUE,
       par.settings = myTheme)

## Not run: 

dataURL &lt;- "https://raw.github.com/oscarperpinan/bookvis/master/data/"

##Solar irradiation data from CMSAF http://dx.doi.org/10.5676/EUM_SAF_CM/RAD_MVIRI/V001
old &lt;- setwd(tempdir())
download.file(paste0(dataURL, "SISmm2008_CMSAF.zip"),
   "SISmm2008_CMSAF.zip", method='wget')
unzip("SISmm2008_CMSAF.zip")

listFich &lt;- dir(pattern='\\.nc')
stackSIS &lt;- stack(listFich)
stackSIS &lt;- stackSIS*24 ##from irradiance (W/m2) to irradiation Wh/m2
setwd(old)

idx &lt;- seq(as.Date('2008-01-15'), as.Date('2008-12-15'), 'month')

SISmm &lt;- setZ(stackSIS, idx)
names(SISmm) &lt;- month.abb

bwplot(SISmm)

##FUN applies to z if not NULL
library(zoo)

bwplot(SISmm, FUN=as.yearqtr)

## End(Not run)
## Not run: 
##http://neo.sci.gsfc.nasa.gov/Search.html?group=64
old &lt;- setwd(tempdir())
download.file(paste0(dataURL, "875430rgb-167772161.0.FLOAT.TIFF"),
   "875430rgb-167772161.0.FLOAT.TIFF", method='wget')

pop &lt;- raster("875430rgb-167772161.0.FLOAT.TIFF")
pop[pop==99999] &lt;- NA
levelplot(pop, zscaleLog=10, par.settings=BTCTheme,
          panel=panel.levelplot.raster, interpolate=TRUE)

##http://neo.sci.gsfc.nasa.gov/Search.html?group=20
download.file(paste0(dataURL, "241243rgb-167772161.0.TIFF"),
   "241243rgb-167772161.0.TIFF", method='wget')
landClass &lt;- raster("241243rgb-167772161.0.TIFF")
landClass[landClass==254] &lt;- NA


s &lt;- stack(pop, landClass)
names(s) &lt;- c('pop', 'landClass')

bwplot(asinh(pop) ~ landClass|cut(y, 3), data = s,
       layout = c(3, 1))

bwplot(asinh(pop) ~ cut(y, 5)|landClass, data = s,
       scales = list(x=list(rot=45)), layout = c(4, 5),
       strip = strip.custom(strip.levels = TRUE))

## Modify colours
bwplot(asinh(pop) ~ cut(y, 5)|landClass, data = s,
       scales = list(x=list(rot=45)), layout = c(4, 5),
       strip = strip.custom(strip.levels = TRUE),
       par.settings = bwTheme(plot.polygon = list(col = 'lightgray'),
                              box.rectangle = list(fill = 'lightgreen')))

## End(Not run)
</code></pre>

<hr>
<h2 id='densityplot-methods'>Density plots for Raster objects.</h2><span id='topic+densityplot'></span><span id='topic+densityplot+2CRaster+2Cmissing-method'></span><span id='topic+densityplot+2CSpatRaster+2Cmissing-method'></span><span id='topic+densityplot+2Cformula+2CRaster-method'></span><span id='topic+densityplot+2Cformula+2CSpatRaster-method'></span>

<h3>Description</h3>

<p>Draw kernel density plots (with <code>lattice</code>) of Raster objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Raster,missing'
densityplot(x, data=NULL, layers, FUN,
            maxpixels = 1e+05,
            xlab='', ylab='', main='',
            par.settings=rasterTheme(),
            draw.labels = TRUE,
            auto.key = list(space = "right"),
            att = 1,
            ...)

## S4 method for signature 'formula,Raster'
densityplot(x, data, dirXY,
            maxpixels = 1e+05,
            xscale.components=xscale.raster,
            yscale.components=yscale.raster,
            auto.key = list(space = 'right'), 
            par.settings=rasterTheme(),...)


## S4 method for signature 'SpatRaster,missing'
densityplot(x, data=NULL, layers, FUN,
            maxpixels = 1e+05,
            xlab='', ylab='', main='',
            par.settings=rasterTheme(),
            draw.labels = TRUE,
            auto.key = list(space = "right"),
            att = 1,
            ...)

## S4 method for signature 'formula,SpatRaster'
densityplot(x, data, dirXY,
            maxpixels = 1e+05,
            xscale.components=xscale.raster,
            yscale.components=yscale.raster,
            auto.key = list(space = 'right'), 
            par.settings=rasterTheme(),...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="densityplot-methods_+3A_x">x</code></td>
<td>
<p>A <code>Raster*</code> object, a <code>SpatRaster</code> object, or a <code>formula</code>.</p>
</td></tr>
<tr><td><code id="densityplot-methods_+3A_data">data</code></td>
<td>
<p><code>NULL</code>, a <code>Raster</code> object, or a
<code>SpatRaster</code> object.</p>
</td></tr>
<tr><td><code id="densityplot-methods_+3A_layers">layers</code></td>
<td>
<p>A numeric or character which should indicate the layers
to be displayed.</p>
</td></tr>
<tr><td><code id="densityplot-methods_+3A_dirxy">dirXY</code></td>
<td>
<p>A direction as a function of the coordinates (see
<code><a href="#topic+xyLayer">xyLayer</a></code>).</p>
</td></tr>
<tr><td><code id="densityplot-methods_+3A_fun">FUN</code></td>
<td>
<p>A function to applied to the <code>z</code> slot of a
<code>RasterStackBrick</code> object or to the time index of a
<code>SpatRaster</code> object. The result of this function
is used as the grouping variable of the plot.</p>
</td></tr>
<tr><td><code id="densityplot-methods_+3A_maxpixels">maxpixels</code></td>
<td>
<p>A numeric, for <code><a href="raster.html#topic+sampleRandom">sampleRandom</a></code> or <code>spatSample</code>.</p>
</td></tr>
<tr><td><code id="densityplot-methods_+3A_draw.labels">draw.labels</code></td>
<td>
<p>Logical. If TRUE (default), labels are displayed
over the maximum value of each layer. If FALSE, a key is displayed
according to the <code>auto.key</code> argument.</p>
</td></tr>
<tr><td><code id="densityplot-methods_+3A_xlab">xlab</code>, <code id="densityplot-methods_+3A_ylab">ylab</code>, <code id="densityplot-methods_+3A_main">main</code>, <code id="densityplot-methods_+3A_xscale.components">xscale.components</code>, <code id="densityplot-methods_+3A_yscale.components">yscale.components</code>, <code id="densityplot-methods_+3A_par.settings">par.settings</code>, <code id="densityplot-methods_+3A_auto.key">auto.key</code></td>
<td>
<p>Arguments for <code><a href="#topic+densityplot">densityplot</a></code>.</p>
</td></tr>
<tr><td><code id="densityplot-methods_+3A_att">att</code></td>
<td>
<p>Integer or character to choose which variable (column) in
the RAT table should be used.</p>
</td></tr>
<tr><td><code id="densityplot-methods_+3A_...">...</code></td>
<td>
<p>Additional arguments for <code><a href="#topic+densityplot">densityplot</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Oscar Perpiñán Lamigueiro</p>


<h3>See Also</h3>

<p><code><a href="lattice.html#topic+histogram">lattice:densityplot()</a></code>,<code><a href="#topic+xscale.raster">xscale.raster</a></code>,
<code><a href="#topic+yscale.raster">yscale.raster</a></code>, <code><a href="#topic+rasterTheme">rasterTheme</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
library(terra)

f &lt;- system.file("external/test.grd", package="raster")
r &lt;- raster(f)
densityplot(r)
s &lt;- stack(r, r+500, r-500)
## With labels
densityplot(s)
## With a key
densityplot(s, draw.labels = FALSE)

## Not run: 
library(zoo)

dataURL &lt;- "https://raw.github.com/oscarperpinan/bookvis/master/data/"

##Solar irradiation data from CMSAF http://dx.doi.org/10.5676/EUM_SAF_CM/RAD_MVIRI/V001
old &lt;- setwd(tempdir())
download.file(paste0(dataURL, "SISmm2008_CMSAF.zip"),
   "SISmm2008_CMSAF.zip", method='wget')
unzip("SISmm2008_CMSAF.zip")

listFich &lt;- dir(pattern='\\.nc')
stackSIS &lt;- stack(listFich)
stackSIS &lt;- stackSIS*24 ##from irradiance (W/m2) to irradiation Wh/m2
setwd(old)

idx &lt;- seq(as.Date('2008-01-15'), as.Date('2008-12-15'), 'month')

SISmm &lt;- setZ(stackSIS, idx)
names(SISmm) &lt;- month.abb

densityplot(SISmm)
##FUN applies to z if not NULL
densityplot(SISmm, FUN=as.yearqtr)

## End(Not run)
## Not run: 
##http://neo.sci.gsfc.nasa.gov/Search.html?group=64
pop &lt;- raster('875430rgb-167772161.0.FLOAT.TIFF')
pop[pop==99999] &lt;- NA
levelplot(pop, zscaleLog=10, par.settings=BTCTheme,
          panel=panel.levelplot.raster, interpolate=TRUE)

##http://neo.sci.gsfc.nasa.gov/Search.html?group=20
landClass &lt;- raster('241243rgb-167772161.0.TIFF')
landClass[landClass==254] &lt;- NA


s &lt;- stack(pop, landClass)
names(s) &lt;- c('pop', 'landClass')

densityplot(~asinh(pop)|landClass, data=s,
            scales=list(relation='free'),
            strip=strip.custom(strip.levels=TRUE))

## End(Not run)
</code></pre>

<hr>
<h2 id='Formula+20methods'>Formula methods</h2><span id='topic+hexbinplot'></span><span id='topic+hexbinplot+2Cformula+2CRaster-method'></span><span id='topic+xyplot+2Cformula+2CRaster-method'></span><span id='topic+hexbinplot+2Cformula+2CSpatRaster-method'></span><span id='topic+xyplot+2Cformula+2CSpatRaster-method'></span>

<h3>Description</h3>

<p>Formula methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'formula,Raster'
xyplot(x, data, dirXY, maxpixels=1e5,
            alpha=0.05,
            xscale.components=xscale.raster, yscale.components=yscale.raster,
            par.settings=rasterTheme(),...)
## S4 method for signature 'formula,Raster'
hexbinplot(x, data, dirXY, maxpixels=1e6,
            xscale.components=xscale.raster, yscale.components=yscale.raster,
            par.settings=rasterTheme(),...)
## S4 method for signature 'formula,SpatRaster'
xyplot(x, data, dirXY, maxpixels=1e5,
            alpha=0.05,
            xscale.components=xscale.raster, yscale.components=yscale.raster,
            par.settings=rasterTheme(),...)
## S4 method for signature 'formula,SpatRaster'
hexbinplot(x, data, dirXY, maxpixels=1e6,
            xscale.components=xscale.raster, yscale.components=yscale.raster,
            par.settings=rasterTheme(),...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Formula+2B20methods_+3A_x">x</code></td>
<td>
<p>A <code>formula</code> describing the variables to be related. It may
include the layer names (which are internally converted to valid ones
with <code><a href="base.html#topic+make.names">make.names</a></code>) and the <code>x</code>, <code>y</code> variables
representing the coordinates of the Raster object. Besides, if dirXY
is not missing, the variable <code>dirXY</code> can also be included in the
<code>formula</code>.
</p>
</td></tr>
<tr><td><code id="Formula+2B20methods_+3A_data">data</code></td>
<td>
<p>A <code>Raster</code> object or a <code>SpatRaster</code> object.</p>
</td></tr>
<tr><td><code id="Formula+2B20methods_+3A_dirxy">dirXY</code></td>
<td>
<p>A direction as a function of the coordinates (see
<code><a href="#topic+xyLayer">xyLayer</a></code>).</p>
</td></tr>
<tr><td><code id="Formula+2B20methods_+3A_maxpixels">maxpixels</code></td>
<td>
<p>A numeric, for <code><a href="raster.html#topic+sampleRegular">sampleRegular</a></code> or <code>spatSample</code>.</p>
</td></tr>
<tr><td><code id="Formula+2B20methods_+3A_alpha">alpha</code></td>
<td>
<p>A numeric, transparency of the points.</p>
</td></tr>
<tr><td><code id="Formula+2B20methods_+3A_xscale.components">xscale.components</code>, <code id="Formula+2B20methods_+3A_yscale.components">yscale.components</code>, <code id="Formula+2B20methods_+3A_par.settings">par.settings</code></td>
<td>
<p>Customization of <code>lattice</code>. See <code>xyplot</code>
for details.</p>
</td></tr>
<tr><td><code id="Formula+2B20methods_+3A_...">...</code></td>
<td>
<p>Additional arguments for the <code>xyplot</code> and
<code><a href="#topic+hexbinplot">hexbinplot</a></code> functions.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Oscar Perpiñán Lamigueiro</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
library(terra)

f &lt;- system.file("external/test.grd", package="raster")
r &lt;- raster(f)
names(r)

xyplot(test~y, data=r, alpha=0.5)

## Not run: 
dataURL &lt;- "https://raw.github.com/oscarperpinan/bookvis/master/data/"

##Solar irradiation data from CMSAF http://dx.doi.org/10.5676/EUM_SAF_CM/RAD_MVIRI/V001
old &lt;- setwd(tempdir())
download.file(paste0(dataURL, "SISmm2008_CMSAF.zip"),
   "SISmm2008_CMSAF.zip", method='wget')
unzip("SISmm2008_CMSAF.zip")

listFich &lt;- dir(pattern='\\.nc')
stackSIS &lt;- stack(listFich)
SISmm &lt;- stackSIS*24 ##from irradiance (W/m2) to irradiation Wh/m2
setwd(old)

names(SISmm) &lt;- month.abb

##Relation between the January &amp; February versus July radiation for four
##differents longitude regions.
xyplot(Jan+Feb~Jul|cut(x, 4), data=SISmm, auto.key=list(space='right'))
##Faster with hexbinplot
hexbinplot(Jan~Jul|cut(x, 6), data=SISmm)

## End(Not run)
</code></pre>

<hr>
<h2 id='gplot-methods'>Use ggplot to plot a Raster* or a SpatRaster object.</h2><span id='topic+gplot'></span><span id='topic+gplot+2CRaster-method'></span><span id='topic+gplot+2CSpatRaster-method'></span>

<h3>Description</h3>

<p> A wrapper function around <a href="ggplot2.html#topic+ggplot">ggplot</a> (ggplot2
package). Note that the function in the raster package is called gplot
with a single 'g'.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Raster'
gplot(x, maxpixels=50000,...) 
## S4 method for signature 'SpatRaster'
gplot(x, maxpixels=50000,...) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gplot-methods_+3A_x">x</code></td>
<td>
<p>A Raster* or SpatRaster object</p>
</td></tr>
<tr><td><code id="gplot-methods_+3A_maxpixels">maxpixels</code></td>
<td>
<p>Maximum number of pixels to use</p>
</td></tr>
<tr><td><code id="gplot-methods_+3A_...">...</code></td>
<td>
<p>Additional arguments for ggplot</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Robert J. Hijmans and Oscar Perpiñán; based on an example by Paul Hiemstra </p>


<h3>See Also</h3>

<p><code> <a href="raster.html#topic+plot">plot</a>, <a href="raster.html#topic+spplot">spplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
## Not run: 
library(raster)
library(terra)

r &lt;- raster(system.file("external/test.grd", package="raster"))

s1 &lt;- stack(r, r*2)
names(s1) &lt;- c('meuse', 'meuse x 2')

library(ggplot2)

theme_set(theme_bw())

## With raster
gplot(s1) + geom_tile(aes(fill = value)) +
          facet_wrap(~ variable) +
          scale_fill_gradient(low = 'white', high = 'blue') +
          coord_equal()

## With terra
s2 &lt;- rast(s1)
gplot(s2) + geom_tile(aes(fill = value)) +
          facet_wrap(~ variable) +
          scale_fill_gradient(low = 'white', high = 'blue') +
          coord_equal()

## End(Not run)
</code></pre>

<hr>
<h2 id='histogram-methods'>
Histogram of Raster objects.
</h2><span id='topic+histogram'></span><span id='topic+histogram+2CRaster+2Cmissing-method'></span><span id='topic+histogram+2CSpatRaster+2Cmissing-method'></span><span id='topic+histogram+2Cformula+2CRaster-method'></span><span id='topic+histogram+2Cformula+2CSpatRaster-method'></span>

<h3>Description</h3>

<p>Draw histograms (with <code>lattice</code>) of Raster objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Raster,missing'
histogram(x, data=NULL, layers, FUN,
            maxpixels = 1e+05, nint=100,
            xlab='', ylab='', main='', col='gray',
            between=list(x=0.5, y=0.2),
            as.table=TRUE,
            scales=list(x=list(relation='free'),
              y=list(relation='free',
                draw=FALSE)),
            names.attr,
            par.settings=rasterTheme(),
            att = 1,
            ...)

## S4 method for signature 'SpatRaster,missing'
histogram(x, data=NULL, layers, FUN,
            maxpixels = 1e+05, nint=100,
            xlab='', ylab='', main='', col='gray',
            between=list(x=0.5, y=0.2),
            as.table=TRUE,
            scales=list(x=list(relation='free'),
              y=list(relation='free',
                draw=FALSE)),
            names.attr,
            par.settings=rasterTheme(),
            att = 1,
            ...)

## S4 method for signature 'formula,Raster'
histogram(x, data, dirXY,
            maxpixels = 1e+05,
            strip=TRUE,
            par.settings=rasterTheme(),
            att = 1,
            ...)

## S4 method for signature 'formula,SpatRaster'
histogram(x, data, dirXY,
            maxpixels = 1e+05,
            strip=TRUE,
            par.settings=rasterTheme(),
            att = 1,
            ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="histogram-methods_+3A_x">x</code></td>
<td>
<p>A <code>Raster*</code> object, a <code>SpatRaster</code> object or a <code>formula</code>.</p>
</td></tr>
<tr><td><code id="histogram-methods_+3A_data">data</code></td>
<td>
<p><code>NULL</code>, a <code>Raster</code> object, or <code>SpatRaster</code> object.</p>
</td></tr>
<tr><td><code id="histogram-methods_+3A_layers">layers</code></td>
<td>
<p>A numeric or character which should indicate the layers
to be displayed.</p>
</td></tr>
<tr><td><code id="histogram-methods_+3A_dirxy">dirXY</code></td>
<td>
<p>A direction as a function of the coordinates (see
<code><a href="#topic+xyLayer">xyLayer</a></code>).</p>
</td></tr>
<tr><td><code id="histogram-methods_+3A_fun">FUN</code></td>
<td>
<p>A function to applied to the <code>z</code> slot of a
<code>RasterStackBrick</code> object or to the time index of the
<code>SpatRaster</code> object. The result of this function
is used as the grouping variable of the plot.</p>
</td></tr>
<tr><td><code id="histogram-methods_+3A_nint">nint</code></td>
<td>
<p>Number of breaks for the histogram. See the documentation of
<code>lattice::<a href="lattice.html#topic+histogram">histogram</a></code> at lattice for details.</p>
</td></tr>
<tr><td><code id="histogram-methods_+3A_maxpixels">maxpixels</code></td>
<td>
<p>A numeric, for <code><a href="raster.html#topic+sampleRandom">sampleRandom</a></code> or <code>spatSample</code>.</p>
</td></tr>
<tr><td><code id="histogram-methods_+3A_att">att</code></td>
<td>
<p>If <code>x</code> is a factor, integer or character to choose
which variable (column) in the RAT table should be used.</p>
</td></tr>
<tr><td><code id="histogram-methods_+3A_xlab">xlab</code>, <code id="histogram-methods_+3A_ylab">ylab</code>, <code id="histogram-methods_+3A_main">main</code>, <code id="histogram-methods_+3A_col">col</code></td>
<td>
<p>Arguments for <code><a href="#topic+histogram">histogram</a></code>.</p>
</td></tr>
<tr><td><code id="histogram-methods_+3A_names.attr">names.attr</code></td>
<td>
<p>Character or expression, names to use in each
panel. If missing its default value is the result of <code>names(x)</code>
(after subsetting the layers to be displayed).</p>
</td></tr>
<tr><td><code id="histogram-methods_+3A_between">between</code>, <code id="histogram-methods_+3A_as.table">as.table</code>, <code id="histogram-methods_+3A_scales">scales</code>, <code id="histogram-methods_+3A_strip">strip</code>, <code id="histogram-methods_+3A_par.settings">par.settings</code></td>
<td>
<p>Graphical parameters of <code>lattice</code>. See <code>lattice::<a href="lattice.html#topic+xyplot">xyplot</a></code> for details.</p>
</td></tr>
<tr><td><code id="histogram-methods_+3A_...">...</code></td>
<td>
<p>Additional arguments for <code>lattice::<a href="lattice.html#topic+histogram">histogram</a></code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>If you need different breakpoints in each panel, set <code>breaks</code>
explicitely with <code>NULL</code>, a numeric or a character (for example,
'Sturges'; see <code><a href="graphics.html#topic+hist">hist</a></code> for details)</p>


<h3>Author(s)</h3>

<p>Oscar Perpiñán Lamigueiro</p>


<h3>See Also</h3>

<p><code><a href="lattice.html#topic+histogram">histogram</a></code>,<code><a href="#topic+xscale.raster">xscale.raster</a></code>,
<code><a href="#topic+yscale.raster">yscale.raster</a></code>, <code><a href="#topic+rasterTheme">rasterTheme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
library(terra)

f &lt;- system.file("external/test.grd", package="raster")
r &lt;- raster(f)
histogram(r)
s &lt;- stack(r, r+500, r-500)
## Same breakpoints across panels
histogram(s)
## Each panel with different breakpoints
histogram(s, breaks=NULL)
histogram(s, breaks='Sturges')
histogram(s, breaks=30)

## Categorical data
r &lt;- raster(nrow=10, ncol=10)
r[] = 1
r[51:100] = 3
r[3:6, 1:5] = 5
r &lt;- ratify(r)
     
rat &lt;- levels(r)[[1]]
rat$landcover &lt;- c('Pine', 'Oak', 'Meadow')
rat$class &lt;- c('A1', 'B2', 'C3')
levels(r) &lt;- rat

histogram(r)
histogram(r, att = "class")

## Not run: 
library(zoo)

dataURL &lt;- "https://raw.github.com/oscarperpinan/bookvis/master/data/"

##Solar irradiation data from CMSAF http://dx.doi.org/10.5676/EUM_SAF_CM/RAD_MVIRI/V001
old &lt;- setwd(tempdir())
download.file(paste0(dataURL, "SISmm2008_CMSAF.zip"),
   "SISmm2008_CMSAF.zip", method='wget')
unzip("SISmm2008_CMSAF.zip")

listFich &lt;- dir(pattern='\\.nc')
stackSIS &lt;- stack(listFich)
stackSIS &lt;- stackSIS*24 ##from irradiance (W/m2) to irradiation Wh/m2

idx &lt;- seq(as.Date('2008-01-15'), as.Date('2008-12-15'), 'month')

SISmm &lt;- setZ(stackSIS, idx)
names(SISmm) &lt;- month.abb

histogram(SISmm)
histogram(SISmm, FUN=as.yearqtr)

## With the formula interface you can create histograms for a set of variables
histogram(~ Jan + Dec, data=SISmm)
## Or use the coordinates for generating zonal histograms.
## For example, five histograms for each latitude zone  
histogram(~ Jan | cut(y, 5), data=SISmm)
## More sophisticated bands can be defined using the dirXY argument 
histogram(~ Jan | cut(dirXY, 5), dirXY = x^2 + y^2, data=SISmm)
 
setwd(old)

## End(Not run)

## Not run: 
##http://neo.sci.gsfc.nasa.gov/Search.html?group=64
pop &lt;- raster('875430rgb-167772161.0.FLOAT.TIFF')
pop[pop==99999] &lt;- NA
levelplot(pop, zscaleLog=10, par.settings=BTCTheme,
          panel=panel.levelplot.raster, interpolate=TRUE)

##http://neo.sci.gsfc.nasa.gov/Search.html?group=20
landClass &lt;- raster('241243rgb-167772161.0.TIFF')
landClass[landClass==254] &lt;- NA


s &lt;- stack(pop, landClass)
names(s) &lt;- c('pop', 'landClass')

histogram(~asinh(pop)|landClass, data=s,
            scales=list(relation='free'),
            strip=strip.custom(strip.levels=TRUE))

## End(Not run)

</code></pre>

<hr>
<h2 id='horizonplot-methods'>Horizon plots of Raster objects.</h2><span id='topic+horizonplot'></span><span id='topic+horizonplot+2CRasterStackBrick-method'></span><span id='topic+horizonplot+2CRasterStackBrick+2Cmissing-method'></span><span id='topic+horizonplot+2CSpatRaster-method'></span><span id='topic+horizonplot+2CSpatRaster+2Cmissing-method'></span>

<h3>Description</h3>

<p>This method draws horizon graphs for each zone as
calculated with <code>zonal</code> from the directions defined by
<code>xyLayer</code></p>


<h3>Usage</h3>

<pre><code class='language-R'>
## S4 method for signature 'RasterStackBrick,missing'
horizonplot(x, data = NULL,
    dirXY = y, stat = 'mean', digits = 0,
    origin = mean, 
    xlab = 'Time', ylab = 'direction',
    colorkey = TRUE, colorkey.digits = 1,
    scales=list(y = list(relation = "same")),
    ...)

## S4 method for signature 'SpatRaster,missing'
horizonplot(x, data = NULL,
    dirXY = y, stat = 'mean', digits = 0,
    origin = mean, 
    xlab = 'Time', ylab = 'direction',
    colorkey = TRUE, colorkey.digits = 1,
    scales=list(y = list(relation = "same")),
    ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="horizonplot-methods_+3A_x">x</code></td>
<td>
<p>A <code>RasterStackBrick</code> object or a <code>SpatRaster</code> object.</p>
</td></tr>
<tr><td><code id="horizonplot-methods_+3A_data">data</code></td>
<td>
<p>Not used.</p>
</td></tr>
<tr><td><code id="horizonplot-methods_+3A_dirxy">dirXY</code></td>
<td>
<p>A direction as a function of the coordinates (see
<code><a href="#topic+xyLayer">xyLayer</a></code>).</p>
</td></tr>
<tr><td><code id="horizonplot-methods_+3A_stat">stat</code></td>
<td>
<p>a function to be applied to summarize the values by
zone. See <code><a href="raster.html#topic+zonal">zonal</a></code> for details.</p>
</td></tr>
<tr><td><code id="horizonplot-methods_+3A_digits">digits</code></td>
<td>
<p>An integer, number of digits for <code><a href="raster.html#topic+zonal">zonal</a></code>.</p>
</td></tr>
<tr><td><code id="horizonplot-methods_+3A_origin">origin</code></td>
<td>
<p>From the <code>latticeExtra</code> help page: &quot;the baseline y
value for the first (positive) segment (i.e. the value at
which red changes to blue).&quot; It can be: a number, used acrros
all panels, or a function (or a character defining a
function), evaluated with the values in each panel. The
default is the <code>mean</code> function.</p>
</td></tr>
<tr><td><code id="horizonplot-methods_+3A_xlab">xlab</code>, <code id="horizonplot-methods_+3A_ylab">ylab</code></td>
<td>
<p>Labels of the axis.</p>
</td></tr>
<tr><td><code id="horizonplot-methods_+3A_colorkey">colorkey</code></td>
<td>
<p>If <code>colorkey = TRUE</code> a suitable color scale bar is
constructed using the values of <code>origin</code> and
<code>horizonscale</code> (see below). For additional information
see <code><a href="#topic+levelplot">levelplot</a></code>.</p>
</td></tr>
<tr><td><code id="horizonplot-methods_+3A_colorkey.digits">colorkey.digits</code></td>
<td>
<p>Digits for rounding values in <code>colorkey</code>
labels</p>
</td></tr> 
<tr><td><code id="horizonplot-methods_+3A_scales">scales</code></td>
<td>
<p>From the <code>lattice::xyplot</code> help page: &quot;A list
determining how the x- and y-axes (tick marks and labels) are
drawn.  The list contains parameters in <code>name=value</code>
form, and may also contain two other lists called <code>x</code> and
<code>y</code> of the same form.  Components of <code>x</code> and
<code>y</code> affect the respective axes only, while those in
<code>scales</code> affect both.  When parameters are specified in
both lists, the values in <code>x</code> or <code>y</code> are used.&quot; In
<code>horizonplot</code> the most interesting component is
<code>relation</code>, a character string that determines how axis
limits are calculated for each panel.  Possible values are
<code>"same"</code> (default), <code>"free"</code> and <code>"sliced"</code>.
&quot;For ‘relation=&quot;same&quot;’, the same limits,
usually large enough to encompass all the data, are used for
all the panels.  For ‘relation=&quot;free&quot;’, limits for each panel
is determined by just the points in that panel.  Behavior for
‘relation=&quot;sliced&quot;’ is similar, except that the length (max -
min) of the scales are constrained to remain the same across
panels.&quot;</p>
</td></tr>
<tr><td><code id="horizonplot-methods_+3A_...">...</code></td>
<td>
<p>Additional arguments for the <code>horizonplot</code>
function. <code>horizonscale</code> is the most interesting, being (from
the <code>latticeExtra</code> help page) &quot;the scale of each color
segment. There are 3 positive segments and 3 negative segments. If
this is a given as a number then all panels will have comparable
distances, though not necessarily the same actual values (similar in
concept to ‘scales$relation = &quot;sliced&quot;’)&quot;. On the other hand,
<code>col.regions</code> is used to choose the color scale.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>(Extracted from the reference): &quot;The horizon graph allows to
examine how a large number of items changed through time, to spot
extraordinary behaviors and predominant patterns, view each of the
items independently from the others when they wish, make comparisons
between the items, and view changes that occurred with enough
precision to determine if further examination is required.&quot;</p>


<h3>References</h3>

<p><a href="http://vis.berkeley.edu/papers/horizon/2009-TimeSeries-CHI.pdf">http://vis.berkeley.edu/papers/horizon/2009-TimeSeries-CHI.pdf</a>
</p>


<h3>See Also</h3>

 <p><code><a href="latticeExtra.html#topic+horizonplot">horizonplot</a></code>,
<code><a href="lattice.html#topic+xyplot">xyplot</a></code>, <code><a href="#topic+levelplot">levelplot</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(raster)
library(terra)
library(zoo)

url &lt;- "ftp://ftp.wiley.com/public/sci_tech_med/spatio_temporal_data/"
sst.dat = read.table(paste(url, "SST011970_032003.dat", sep=''), header = FALSE) 
sst.ll = read.table(paste(url, "SSTlonlat.dat", sep=''), header = FALSE)

spSST &lt;- SpatialPointsDataFrame(sst.ll, sst.dat)
gridded(spSST) &lt;- TRUE
proj4string(spSST) = "+proj=longlat +datum=WGS84"
SST &lt;- brick(spSST)

idx &lt;- seq(as.Date('1970-01-01'), as.Date('2003-03-01'), by='month')
idx &lt;- as.yearmon(idx)
SST &lt;- setZ(SST, idx)
names(SST) &lt;- as.character(idx)

horizonplot(SST)

horizonplot(SST, stat='sd')

## Different scales for each panel, with colors representing deviations
## from the origin in *that* panel
horizonplot(SST, scales=list('free'))

## origin may be a function...
horizonplot(SST, origin=mean)
## ...or a number
horizonplot(SST, origin=0)

## A different color palette
pal &lt;- RColorBrewer::brewer.pal(n=6, 'PuOr')
horizonplot(SST, origin = 0, col.regions = pal)

## The width of each color segment can be defined with horizonscale
horizonplot(SST, horizonscale=1, origin=0)

## End(Not run)

## Not run: 

dataURL &lt;- "https://raw.github.com/oscarperpinan/bookvis/master/data/"

##Solar irradiation data from CMSAF http://dx.doi.org/10.5676/EUM_SAF_CM/RAD_MVIRI/V001
old &lt;- setwd(tempdir())
download.file(paste0(dataURL, "SISmm2008_CMSAF.zip"),
   "SISmm2008_CMSAF.zip", method='wget')
unzip("SISmm2008_CMSAF.zip")

listFich &lt;- dir(pattern='\\.nc')
stackSIS &lt;- stack(listFich)
stackSIS &lt;- stackSIS*24 ##from irradiance (W/m2) to irradiation Wh/m2
setwd(old)

idx &lt;- seq(as.Date('2008-01-15'), as.Date('2008-12-15'), 'month')

SISmm &lt;- setZ(stackSIS, idx)
names(SISmm) &lt;- month.abb

horizonplot(SISmm)

## End(Not run)


</code></pre>

<hr>
<h2 id='hovmoller-methods'>Hovmoller plots</h2><span id='topic+hovmoller'></span><span id='topic+hovmoller+2CRasterStackBrick-method'></span><span id='topic+hovmoller+2CSpatRaster-method'></span>

<h3>Description</h3>

<p>Hovmoller plots of Raster objects.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RasterStackBrick'
hovmoller(object, dirXY=y, FUN=mean, 
digits=2, xlab='Direction', ylab='Time',
par.settings=rasterTheme(), xscale.components=xscale.raster,
add.contour=FALSE, labels=FALSE, region=TRUE, ...)

## S4 method for signature 'SpatRaster'
hovmoller(object, dirXY=y, FUN=mean, 
digits=2, xlab='Direction', ylab='Time',
par.settings=rasterTheme(), xscale.components=xscale.raster,
add.contour=FALSE, labels=FALSE, region=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hovmoller-methods_+3A_object">object</code></td>
<td>
<p>A RasterStackBrick with a non-empty <code>z</code> slot, or a
SpatRaster with a time index.</p>
</td></tr>
<tr><td><code id="hovmoller-methods_+3A_dirxy">dirXY</code></td>
<td>
<p>A direction as a function of the coordinates (see
<code><a href="#topic+xyLayer">xyLayer</a></code>).</p>
</td></tr>
<tr><td><code id="hovmoller-methods_+3A_fun">FUN</code></td>
<td>
<p>A function to be applied to the zones calculated with
<code>dirXY</code> and <code>zonal</code>.</p>
</td></tr>
<tr><td><code id="hovmoller-methods_+3A_digits">digits</code></td>
<td>
<p>An integer, number of digits for <code><a href="raster.html#topic+zonal">zonal</a></code>.</p>
</td></tr>
<tr><td><code id="hovmoller-methods_+3A_xlab">xlab</code>, <code id="hovmoller-methods_+3A_ylab">ylab</code></td>
<td>
<p>Labels of the axis.</p>
</td></tr>
<tr><td><code id="hovmoller-methods_+3A_par.settings">par.settings</code></td>
<td>
<p>Customization of lattice. See
<code><a href="#topic+levelplot">levelplot</a></code> and <code><a href="#topic+rasterTheme">rasterTheme</a></code> for details.</p>
</td></tr>
<tr><td><code id="hovmoller-methods_+3A_xscale.components">xscale.components</code></td>
<td>
<p>See <code><a href="#topic+xscale.raster">xscale.raster</a></code>.</p>
</td></tr>
<tr><td><code id="hovmoller-methods_+3A_labels">labels</code>, <code id="hovmoller-methods_+3A_region">region</code></td>
<td>
<p>Customization of <code>contourplot</code> when <code>add.contour</code> is
TRUE.</p>
</td></tr>
<tr><td><code id="hovmoller-methods_+3A_add.contour">add.contour</code></td>
<td>
<p>Logical, if TRUE a contourplot with filled regions
is drawn.</p>
</td></tr>
<tr><td><code id="hovmoller-methods_+3A_...">...</code></td>
<td>
<p>Additional arguments for the <code><a href="#topic+contourplot">contourplot</a></code>
and <code><a href="#topic+levelplot">levelplot</a></code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracted from wikipedia: &quot;A Hovmöller diagram is a
commonly used way of plotting meteorological data to highlight the role
of waves. The axes of a Hovmöller diagram are typically longitude or
latitude (abscissa or x-axis) and time (ordinate or y-axis) with the
value of some field represented through color or shading.&quot;
The direction defined by <code>dirXY</code> and the function <code>FUN</code> allows
for a variety of diagrams with this method.
</p>


<h3>Author(s)</h3>

<p>Oscar Perpiñán Lamigueiro</p>


<h3>References</h3>


<ul>
<li><p> Hovmoller, E. 1949. The trough and ridge diagram. Tellus 1, 62–66.
</p>
</li>
<li> <p><a href="https://www2.mmm.ucar.edu/episodes/Hovmoller/noJS/hovm200707.htm">https://www2.mmm.ucar.edu/episodes/Hovmoller/noJS/hovm200707.htm</a>
</p>
</li>
<li> <p><a href="https://psl.noaa.gov/map/clim/sst.shtml">https://psl.noaa.gov/map/clim/sst.shtml</a>
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="lattice.html#topic+levelplot">levelplot</a></code>,
<code><a href="raster.html#topic+zonal">zonal</a></code>, <code><a href="latticeExtra.html#topic+panel.2dsmoother">panel.2dsmoother</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(raster)
library(terra)

dataURL &lt;- "https://raw.github.com/oscarperpinan/bookvis/master/data/"

##Solar irradiation data from CMSAF http://dx.doi.org/10.5676/EUM_SAF_CM/RAD_MVIRI/V001
old &lt;- setwd(tempdir())
download.file(paste0(dataURL, "SISmm2008_CMSAF.zip"),
   "SISmm2008_CMSAF.zip", method='wget')
unzip("SISmm2008_CMSAF.zip")

listFich &lt;- dir(pattern='\\.nc')
stackSIS &lt;- stack(listFich)
stackSIS &lt;- stackSIS*24 ##from irradiance (W/m2) to irradiation Wh/m2

idx &lt;- seq(as.Date('2008-01-15'), as.Date('2008-12-15'), 'month')

SISmm &lt;- setZ(stackSIS, idx)
names(SISmm) &lt;- month.abb

SISmmt &lt;- rast(SISmm)
time(SISmmt) &lt;- getZ(SISmm)

## Latitude as default
hovmoller(SISmm, xlab='Latitude')
hovmoller(SISmmt, xlab = 'Latitude')

## With contour lines and labels
hovmoller(SISmm, labels=TRUE, add.contour=TRUE,
          xlab='Latitude')

## Smooth color regions with latticeExtra::panel.2dsmoother
library(latticeExtra)

hovmoller(SISmm, panel=panel.2dsmoother, n=1000,
          labels=FALSE, add.contour=TRUE,
          xlab='Latitude')

## Using a function of coordinates
hovmoller(SISmm, dirXY=sqrt(x^2+y^2))

## End(Not run)

## Not run: 
library(zoo)

## DESCRIPTION: http://iridl.ldeo.columbia.edu/SOURCES/.CAC/.sst/
setwd(tempdir())
download.file('http://iridl.ldeo.columbia.edu/SOURCES/.CAC/.sst/data.nc', destfile = 'SST.nc')
SST &lt;- stack('SST.nc')
idx &lt;- seq(as.Date('1970-01-01'), as.Date('2003-03-01'), by='month')
tt &lt;- as.yearmon(idx)
SST &lt;- setZ(SST, tt)
names(SST) &lt;- as.character(tt)

## Extract month value from a Date or yearmon object
month &lt;- function(x)format(x, '%m')
## Compute anomaly using monthly grouping with ave  
anomaly &lt;- function(x){
    ## Monthly means
    mm &lt;- ave(x, month(tt), FUN = mean)
    ## Monthly standard deviation
    msd &lt;- ave(x, month(tt), FUN = sd)
    ## anomaly
    (x - mm)/msd
}
## Use anomaly with calc
SSTanom &lt;- calc(SST, anomaly)
SSTanom &lt;- setZ(SSTanom, tt)

## Ok, let's see the result
hovmoller(SSTanom,
          at = seq(-3, 3, .25),
          panel = panel.levelplot.raster,
          interpolate = TRUE,
          yscale.components = yscale.raster.subticks,
          par.settings = BuRdTheme)

## End(Not run)
</code></pre>

<hr>
<h2 id='Interaction'>
Interaction with trellis objects.
</h2><span id='topic+identifyRaster'></span><span id='topic+chooseRegion'></span><span id='topic+identifyRaster+2CRaster-method'></span>

<h3>Description</h3>

<p><code>chooseRegion</code> provides a set of points (in the form of a
<code>SpatialPoints</code>) inside a region defined by several mouse clicks.
<code>identifyRaster</code> labels and returns points of a <code>trellis</code>
graphic according to mouse clicks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chooseRegion(sp = TRUE, proj = as.character(NA))
## S4 method for signature 'Raster'
identifyRaster(object, layer=1, values=FALSE, pch=13, cex=0.6, col='black',...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Interaction_+3A_sp">sp</code></td>
<td>
<p>logical, if TRUE the result is a <code>SpatialPoints</code>
object, otherwise it is a logical vector as returned by <code>in.out</code></p>
</td></tr>
<tr><td><code id="Interaction_+3A_proj">proj</code></td>
<td>
<p>A character string for the <code>proj4string</code> of
<code>SpatialPoints</code>.</p>
</td></tr>
<tr><td><code id="Interaction_+3A_object">object</code></td>
<td>
<p>A Raster object.</p>
</td></tr>
<tr><td><code id="Interaction_+3A_layer">layer</code></td>
<td>
<p>A numeric or character which should indicate the layer
to be chosen.</p>
</td></tr>
<tr><td><code id="Interaction_+3A_values">values</code></td>
<td>
<p>logical, if TRUE the values are returned.</p>
</td></tr>
<tr><td><code id="Interaction_+3A_pch">pch</code>, <code id="Interaction_+3A_cex">cex</code>, <code id="Interaction_+3A_col">col</code></td>
<td>
<p>Graphical parameters for <code>panel.identify</code>
and <code>panel.link.splom</code>.</p>
</td></tr>
<tr><td><code id="Interaction_+3A_...">...</code></td>
<td>
<p>Additional arguments for
<code>trellis.focus</code>,<code>panel.link.splom</code> and
<code>panel.identify</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When called, these functions wait for the user to identify points (in the panel being drawn) via
mouse clicks.  Clicks other than left-clicks close the region
(for <code>chooseRegion</code>) and the procedure (for
<code>identifyRaster</code>).
</p>


<h3>Note</h3>

<p><code>chooseRegion</code> needs the package <code>mgcv</code> to be installed.
</p>


<h3>Author(s)</h3>

<p>Oscar Perpiñán Lamigueiro
</p>


<h3>See Also</h3>

<p><code>panel.identify</code>,<code>panel.link.splom</code>, <code>trellis.focus</code>, <code>grid.locator</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)

f &lt;- system.file("external/test.grd", package="raster")
r &lt;- raster(f)
levelplot(r)
##Do not close the last graphical window
##Use the left button of the mouse to identify points and the right button to finish
chosen_r &lt;- identifyRaster(r, values=TRUE)
chosen_r
s &lt;- stack(r, r-500, r+500)
levelplot(s)
chosen_s &lt;- identifyRaster(s, values=TRUE)
chosen_s

## Not run: 
##The package mgcv is needed for the next example
##Use the left button of the mouse to build a border with points, and the right button to finish.
##The points enclosed by the border will be highlighted and returned as a SpatialPoints object.
levelplot(s)
reg &lt;- chooseRegion()
summary(reg)

## End(Not run)

## Not run: 
##Solar irradiation data from CMSAF http://dx.doi.org/10.5676/EUM_SAF_CM/RAD_MVIRI/V001

dataURL &lt;- "https://raw.github.com/oscarperpinan/bookvis/master/data/"

old &lt;- setwd(tempdir())
download.file(paste0(dataURL, "SISmm2008_CMSAF.zip"),
   "SISmm2008_CMSAF.zip", method='wget')
unzip("SISmm2008_CMSAF.zip")

listFich &lt;- dir(pattern='\\.nc')
stackSIS &lt;- stack(listFich)
stackSIS &lt;- stackSIS*24 ##from irradiance (W/m2) to irradiation Wh/m2
setwd(old)

idx &lt;- seq(as.Date('2008-01-15'), as.Date('2008-12-15'), 'month')

SISmm &lt;- setZ(stackSIS, idx)
names(SISmm) &lt;- month.abb

levelplot(SISmm)

##Do not close the last graphical window
##Interaction
##Use the left button of the mouse to identify points and the right button to finish
chosen &lt;- identifyRaster(SISmm, layer=3, values=TRUE)
chosen
##Use the left button of the mouse to build a border with points, and the right button to finish.
##The points enclosed by the border will be highlighted and returned as a SpatialPoints object.
reg &lt;- chooseRegion()
summary(reg)

## End(Not run)
</code></pre>

<hr>
<h2 id='lattice'>Lines, points and polygons</h2><span id='topic+llines.SpatVector'></span><span id='topic+lpoints.SpatVector'></span><span id='topic+lpolygon.SpatVector'></span>

<h3>Description</h3>

<p>Represent lines, points and polygons
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SpatVector'
llines(x, ...)
## S3 method for class 'SpatVector'
lpoints(x, ...)
## S3 method for class 'SpatVector'
lpolygon(x, rule = "evenodd", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lattice_+3A_x">x</code></td>
<td>
<p>a SpatVector object</p>
</td></tr>
<tr><td><code id="lattice_+3A_rule">rule</code></td>
<td>
<p>character string specifying how ‘NA’ values are interpreted
for polygons. The default rule (‘&quot;evenodd&quot;’) interprets
‘NA’-separated segments as subpaths, possibly representing
holes, of a single path, and are rendered using
<code>grid.path</code>. Note that this default value is different
from the default value defined in
<code><a href="lattice.html#topic+lpolygon.default">lpolygon.default</a></code>.</p>
</td></tr>
<tr><td><code id="lattice_+3A_...">...</code></td>
<td>
<p>Any argument that can be passed to
<code><a href="lattice.html#topic+llines">llines</a></code>, <code><a href="lattice.html#topic+lpoints">lpoints</a></code>, or
<code><a href="lattice.html#topic+lpolygon">lpolygon</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Alexandre Courtiol and Oscar Perpiñán</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lattice)
library(latticeExtra)
library(terra)
library(rasterVis)

f &lt;- system.file("ex/lux.shp", package="terra")
v &lt;- vect(f)

r &lt;- rast(v)
values(r) &lt;- 1:ncell(r)

pts &lt;- terra::as.points(v)
levelplot(r, margin = FALSE) +
    layer(lpoints(pts, col = "white"))

lns &lt;- terra::as.lines(v)
levelplot(r, margin = FALSE) +
    layer(llines(lns, col = "white", lty = 3))

pols &lt;- terra::as.polygons(v)
levelplot(r, margin = FALSE) +
    layer(lpolygon(pols, border = "black", col = "white"))

## Example adapted from the help page of terra::vect

x &lt;- rbind(c(-10,0), c(140,60), c(160,0), c(140,-55))
hole &lt;- rbind(c(50,0), c(105,30), c(120,2), c(105,-30))
     
z &lt;- rbind(cbind(object=1, part=1, x, hole=0), 
           cbind(object=1, part=1, hole, hole=1))
colnames(z)[3:4] &lt;- c('x', 'y')

p &lt;- vect(z, "polygons", atts=data.frame(id=1))
crs(p) &lt;- "+proj=longlat"

r &lt;- rast(p)
values(r) &lt;- runif(ncell(r))
     
levelplot(r, margin = FALSE) + 
    layer(lpolygon(p, border = "black", col = "white"))
</code></pre>

<hr>
<h2 id='levelplot-methods'>Level and contour plots of Raster objects.</h2><span id='topic+levelplot'></span><span id='topic+contourplot'></span><span id='topic+levelplot+2CRaster+2Cmissing-method'></span><span id='topic+levelplot+2CSpatRaster+2Cmissing-method'></span><span id='topic+contourplot+2CRaster+2Cmissing-method'></span><span id='topic+contourplot+2CSpatRaster+2Cmissing-method'></span>

<h3>Description</h3>

<p>Level and contour plots of Raster objects with <code>lattice</code> methods
and marginal plots with <code>grid</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Raster,missing'
levelplot(x, data = NULL, layers,
            margin = list(), 
            maxpixels = 1e5, 
            par.settings = rasterTheme(),
            between = list(x=0.5, y=0.2),
            as.table = TRUE,
            xlab=if(isLonLat(x)) 'Longitude' else NULL,
            ylab=if(isLonLat(x)) 'Latitude' else NULL,
            main=NULL,
            names.attr,
            scales  =list(),
            xscale.components = xscale.raster,
            yscale.components = yscale.raster,
            zscaleLog = NULL,
            colorkey = list(space='right'),
            panel = panel.levelplot,
            pretty = FALSE, 
            contour = FALSE, region = TRUE, labels = FALSE,
            FUN.margin = NULL, 
            scales.margin = NULL, axis.margin = NULL,
            ..., att=1L)

## S4 method for signature 'SpatRaster,missing'
levelplot(x, data = NULL, layers,
            margin = list(), 
            maxpixels = 1e5, 
            par.settings = rasterTheme(),
            between = list(x=0.5, y=0.2),
            as.table = TRUE,
            xlab=if(is.lonlat(x)) 'Longitude' else NULL,
            ylab=if(is.lonlat(x)) 'Latitude' else NULL,
            main=NULL,
            names.attr,
            scales  =list(),
            xscale.components = xscale.raster,
            yscale.components = yscale.raster,
            zscaleLog = NULL,
            colorkey = list(space='right'),
            panel = panel.levelplot,
            pretty = FALSE, 
            contour = FALSE, region = TRUE, labels = FALSE,
            FUN.margin = NULL, 
            scales.margin = NULL, axis.margin = NULL,
            ..., att=1L)

## S4 method for signature 'Raster,missing'
contourplot(x, data=NULL, layers, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="levelplot-methods_+3A_x">x</code></td>
<td>
<p>A Raster or SpatRaster object.</p>
</td></tr>
<tr><td><code id="levelplot-methods_+3A_data">data</code></td>
<td>
<p>Not used.</p>
</td></tr>
<tr><td><code id="levelplot-methods_+3A_layers">layers</code></td>
<td>
<p>A numeric or character which should indicate the layers
to be displayed.</p>
</td></tr>
<tr><td><code id="levelplot-methods_+3A_maxpixels">maxpixels</code></td>
<td>
<p>A positive integer giving the number of cells to
display, for <code><a href="raster.html#topic+sampleRegular">sampleRegular</a></code>.
</p>
</td></tr>
<tr><td><code id="levelplot-methods_+3A_margin">margin</code></td>
<td>
<p>A list or a logical. If it is TRUE, two marginal
graphics show the column (x) and row (y) summaries of the
<code>Raster*</code> object. The summary is computed with the function
<code>mean</code>. If it is a list, it contains parameters in <code>name=value</code>
form that define both margins, and may contain two other lists
called <code>x</code> and <code>y</code> whose components affect the respective margins
only: </p>

<ul>
<li><p> draw: A logical. If TRUE (default) the marginal graphics are
drawn.
</p>
</li>
<li><p> FUN: A function to summarise the <code>Raster*</code> or
<code>SpatRaster</code> by rows and columns (default: <code>mean</code>).
</p>
</li>
<li><p> scales: A list with components <code>x</code> (columns) and
<code>y</code> (rows). Each of these components must be a numeric
vector of length 2 defining the range for each marginal plot.
If <code>scales = NULL</code> (default) the range is internally
computed.  If any of the elements of the vectors is <code>NA</code>,
the corresponding limit of the range will be calculated
internally.  If any of the vectors is of length 1, it is assumed
that it defines the lower limit of the range, and the upper
limit is calculated internally. 
</p>
</li>
<li><p> axis: Logical or a list. Its default value is
<code>FALSE</code>. If it is <code>TRUE</code> or a list, a simple axis is
drawn with the marginal graphic.  If it is a list, its
components define the graphical parameters of the axis using
<code>grid::<a href="grid.html#topic+gpar">gpar</a></code>.  The default value is <code>gpar(col =
	  'darkgrey', fontsize = 7)</code>
</p>
</li></ul>

</td></tr>
<tr><td><code id="levelplot-methods_+3A_fun.margin">FUN.margin</code>, <code id="levelplot-methods_+3A_scales.margin">scales.margin</code>, <code id="levelplot-methods_+3A_axis.margin">axis.margin</code></td>
<td>
<p>Deprecated
arguments. Use <code>margin</code> as a list instead</p>
</td></tr>
<tr><td><code id="levelplot-methods_+3A_att">att</code></td>
<td>
<p>Integer or character to choose which variable (column) in
the RAT table should be used.</p>
</td></tr>
<tr><td><code id="levelplot-methods_+3A_xlab">xlab</code>, <code id="levelplot-methods_+3A_ylab">ylab</code>, <code id="levelplot-methods_+3A_main">main</code></td>
<td>
<p>A character string or expression describing
the axis and title labels. These arguments are used by the
underlying <code>lattice::<a href="lattice.html#topic+xyplot">xyplot</a></code> function, which
provides this information in its help page:
</p>
<p>&ldquo;<code>main</code>, <code>xlab</code> and <code>ylab</code> are usually a
character string or an expression that gets used as the label, but
can also be a list that controls further details.  Expressions are
treated as specification of LaTeX-like markup as described in
<code><a href="grDevices.html#topic+plotmath">plotmath</a></code>.  The label can be a vector, in which case
the components will be spaced out horizontally (or vertically for
<code>ylab</code>).  This feature can be used to provide column or row
labels rather than a single axis label.
</p>
<p>When <code>main</code> (etc.) is a list, the actual label should
be specified as the <code>xlab</code> component (which may be
unnamed if it is the first component).  The label can be
missing, in which case the default will be used.  Further
named arguments are passed on to <code><a href="grid.html#topic+textGrob">textGrob</a></code>; this can
include arguments controlling positioning like <code>just</code> and
<code>rot</code> as well as graphical parameters such as <code>col</code> and
<code>font</code> (see <code><a href="grid.html#topic+gpar">gpar</a></code> for a full list).
</p>
<p><code>main</code>, <code>xlab</code> and <code>ylab</code> can also be
arbitrary &quot;grobs&quot; (grid graphical objects).&rdquo;
</p>
</td></tr>
<tr><td><code id="levelplot-methods_+3A_names.attr">names.attr</code></td>
<td>
<p>Character or expression, names to use in each
panel. If missing its default value is the result of <code>names(x)</code>
(after subsetting the layers to be displayed).</p>
</td></tr>
<tr><td><code id="levelplot-methods_+3A_xscale.components">xscale.components</code>, <code id="levelplot-methods_+3A_yscale.components">yscale.components</code></td>
<td>
<p>See
<code><a href="#topic+xscale.raster">xscale.raster</a></code> and <code><a href="#topic+yscale.raster">yscale.raster</a></code>.</p>
</td></tr>
<tr><td><code id="levelplot-methods_+3A_colorkey">colorkey</code></td>
<td>
<p>logical specifying whether a color key is to be drawn
alongside the plot (default is <code>TRUE</code>), or a list describing
the color key (see the <code>colorkey</code> section of the help page of
<code>lattice::levelplot</code> for details).
</p>
<p>It accepts a <code>title</code> argument to include the title of the color
key. It can be a <code>character</code> vector or expression providing the
text, or a list with the text and graphical parameters. In this
case, the text must be the <code>label</code> component of the list (or
unnamed if it is the first component). The other components of the
list are the graphical parameters and are passed to the
<code>grid::<a href="grid.html#topic+gpar">gpar</a></code> function (for example, <code>col</code>,
<code>fontfamily</code>, <code>fontface</code>, etc.). Besides, it may include a
component named <code>title.control</code>: (extracted from
<code>lattice::<a href="lattice.html#topic+levelplot">levelplot</a></code>): A list providing control
over the placement of a title, if specified. Currently two
components are honoured: <code>side</code> can take values &quot;top&quot;,
&quot;bottom&quot;, &quot;left&quot;, and &quot;right&quot;, and specifies the side of the
colorkey on which the title is to be placed. Defaults to the value
of the &quot;space&quot; component; <code>padding</code> is a multiplier for the
default amount of padding between the title and the colorkey.
</p>
<p>The color key will always be drawn at the bottom if the marginal
graphics are also displayed. If you need to change the location of
the color key, disable the marginal graphics with <code>margin =
    FALSE</code>.</p>
</td></tr>
<tr><td><code id="levelplot-methods_+3A_between">between</code>, <code id="levelplot-methods_+3A_as.table">as.table</code>, <code id="levelplot-methods_+3A_par.settings">par.settings</code>, <code id="levelplot-methods_+3A_scales">scales</code>, <code id="levelplot-methods_+3A_panel">panel</code></td>
<td>
<p>Graphical
parameters used by <code>lattice::<a href="lattice.html#topic+xyplot">xyplot</a></code>. Adapted
from the help page of this function: </p>

<ul>
<li><p> between: A list with components <code>x</code> and
<code>y</code> (both usually 0 by default), numeric vectors
specifying the space between the panels (units are character
heights). <code>x</code> and <code>y</code> are repeated to account for all
panels in a page and any extra components are ignored.
</p>
</li>
<li><p> as.table: A logical flag that controls the order in which
panels should be displayed: if <code>TRUE</code> (the default), left
to right, top to bottom (as in a table).  If <code>FALSE</code>
panels are drawn left to right, bottom to top.
</p>
</li>
<li><p> par.settings: A list to choose some display settings
temporarily. This list is supplied to
<code><a href="lattice.html#topic+trellis.par.set">trellis.par.set</a></code>. When the resulting object
is plotted, these options are applied temporarily for the
duration of the plotting, after which the settings revert
back to what they were before.  This enables the user to
attach some display settings to the trellis object itself
rather than change the settings globally.
</p>
<p><code>rasterVis</code> includes some functions with predefined
themes that can be directly supplied to <code>par.settings</code>:
<code><a href="#topic+rasterTheme">rasterTheme</a></code> (default), <code><a href="#topic+RdBuTheme">RdBuTheme</a></code> and
<code><a href="#topic+BuRdTheme">BuRdTheme</a></code>, <code><a href="#topic+GrTheme">GrTheme</a></code>,
<code><a href="#topic+BTCTheme">BTCTheme</a></code>, <code><a href="#topic+PuOrTheme">PuOrTheme</a></code> and
<code><a href="#topic+streamTheme">streamTheme</a></code> (for <code><a href="#topic+streamplot">streamplot</a></code>).  These
themes are defined using <code><a href="latticeExtra.html#topic+custom.theme">custom.theme</a></code>. You can use
<code><a href="#topic+rasterTheme">rasterTheme</a></code> or <code><a href="latticeExtra.html#topic+custom.theme">custom.theme</a></code> to
define your own theme (see examples for details).
</p>
</li>
<li><p> scales: A list determining how the x- and y-axes (tick
marks and labels) are drawn.  The list contains parameters in
<code>name=value</code> form, and may also contain two other lists
called <code>x</code> and <code>y</code> of the same form. Components of
<code>x</code> and <code>y</code> affect the respective axes only, while
those in <code>scales</code> affect both.  When parameters are
specified in both lists, the values in <code>x</code> or <code>y</code>
are used. For example, use <code>scales=list(draw=FALSE)</code> to
suppress ticks and labels in both axis. Read the help page of
<code>lattice::<a href="lattice.html#topic+xyplot">xyplot</a></code> to know about the
possible components of <code>scales</code>.
</p>
</li>
<li><p> panel: A function object or a character string giving the
name of a predefined function. The default is
<code><a href="lattice.html#topic+panel.levelplot">panel.levelplot</a></code>. Another useful option is
<code><a href="lattice.html#topic+panel.levelplot.raster">panel.levelplot.raster</a></code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="levelplot-methods_+3A_pretty">pretty</code>, <code id="levelplot-methods_+3A_contour">contour</code>, <code id="levelplot-methods_+3A_region">region</code>, <code id="levelplot-methods_+3A_labels">labels</code></td>
<td>
<p>Graphical parameters
supplied to <code>lattice::<a href="lattice.html#topic+levelplot">levelplot</a></code>.  Adapted
from its help page: </p>

<ul>
<li><p> pretty: A logical flag, indicating whether to use pretty
cut locations and labels. It is <code>FALSE</code> for
<code>levelplot</code> and <code>TRUE</code> for <code>contourplot</code>.
</p>
</li>
<li><p> contour: A logical flag, indicating whether to draw
contour lines. It is <code>TRUE</code> for <code>contourplot</code> and
<code>FALSE</code> for <code>levelplot</code>.
</p>
</li>
<li><p> region: A logical flag, indicating whether regions
between contour lines should be filled as in a level plot. It
is <code>FALSE</code> for <code>contourplot</code> and <code>TRUE</code> for
<code>levelplot</code>.
</p>
</li>
<li><p> labels: Typically a logical indicating whether the
labels are to be drawn (default is <code>TRUE</code> for
<code>contourplot</code>), a character or expression vector giving
the labels associated with the <code>at</code> values, or a list
whose components define the labels and their graphical
parameters. Read the help page of
<code><a href="lattice.html#topic+panel.levelplot">panel.levelplot</a></code> for details.</p>
</li></ul>

</td></tr>
<tr><td><code id="levelplot-methods_+3A_zscalelog">zscaleLog</code></td>
<td>
<p>Controls whether the Raster* will be log transformed
before being passed to the panel function.  Defaults to <code>NULL</code>,
in which case the <code>Raster*</code> is not transformed.  Other possible
values are any number that works as a base for taking logarithm,
<code>TRUE</code> (which is equivalent to 10), <code>"e"</code> (for the natural
logarithm), and <code>FALSE</code> (that is equivalent to <code>NULL</code>).
As a side effect, the colorkey is labeled differently.  </p>
</td></tr>
<tr><td><code id="levelplot-methods_+3A_...">...</code></td>
<td>
<p>Additional arguments for
<code>lattice::<a href="lattice.html#topic+levelplot">levelplot</a></code>,
<code>lattice::<a href="lattice.html#topic+xyplot">xyplot</a></code>,
<code><a href="lattice.html#topic+panel.levelplot">panel.levelplot</a></code> and
<code><a href="lattice.html#topic+panel.levelplot.raster">panel.levelplot.raster</a></code>. The most important ones are:
</p>

<ul>
<li><p> layout: From the help page of
<code>lattice::<a href="lattice.html#topic+xyplot">xyplot</a></code>: <code>layout</code> is a
numeric vector of length 2 or 3 giving the number of
columns, rows, and pages (optional) in a multipanel
display.  The number of pages is by default set to as many
as is required to plot all the panels, and so rarely needs
to be specified.
</p>
<p>For example, with <code>layout=c(1, 1)</code> each panel
(corresponding to a layer of a <code>RasterStackBrick</code>)
object will be printed in a separate page (which could be
useful to generate a series of output files to build an
animation.)
</p>
</li>
<li><p> xlim, ylim: From the help page of
<code>lattice::<a href="lattice.html#topic+xyplot">xyplot</a></code>: A numeric vector
of length 2 giving left and right limits for x-axis, and
lower and upper limits for the y-axis.
</p>
</li>
<li><p> shrink: From the help page of
<code><a href="lattice.html#topic+panel.levelplot">panel.levelplot</a></code>: Either a numeric vector of
length 2 (meant to work as both x and y components), or a list
with components x and y which are numeric vectors of length 2.
This allows the rectangles to be scaled proportional to the
z-value. The specification can be made separately for widths
(x) and heights (y).  The elements of the length 2 numeric
vector gives the minimum and maximum proportion of shrinkage
(corresponding to min and max of z).
</p>
</li>
<li><p> border, border.lty, border.lwd: Graphical parameters
(color, type of line, width of line, respectively) of each
rectangle borders. See the help page of
<code><a href="lattice.html#topic+panel.levelplot">panel.levelplot</a></code> for details.
</p>
</li></ul>

</td></tr>
</table>


<h3>Details</h3>

<p>The result of the <code>levelplot</code> method is similar to the
<code>spplot</code> method for <code>Raster</code> objects defined in the
<code>raster</code> package. However, this method does not use the
<code>spplot</code> of the <code>sp</code> package and, therefore, no conversion
between classes is needed.
</p>
<p>The <code>contourplot</code> method is a wrapper for <code>levelplot</code> with
the next additional default settings: <code>cuts=7</code>,
<code>labels=TRUE</code>, <code>contour</code>=TRUE, <code>pretty</code>=TRUE,
<code>region=TRUE</code> and <code>colorkey=TRUE</code> (see the help of
<code><a href="#topic+contourplot">contourplot</a></code> for details.)
</p>
<p><code>levelplot</code> displays categorical data with a convenient
legend. You should use <code><a href="raster.html#topic+ratify">ratify</a></code> to define a layer as a
categorical variable. It is able to display multilayer categorical
rasters <b>only if</b> they share the same RAT (Raster Attribute
Table). <code>levelplot</code> is not able to display multilayer rasters
with factor <b>and</b> numeric layers. See <code><a href="raster.html#topic+ratify">ratify</a></code> and the
examples below for details.
</p>


<h3>Author(s)</h3>

<p>Oscar Perpiñán Lamigueiro</p>


<h3>See Also</h3>

<p><code><a href="sp.html#topic+spplot">spplot</a></code>,
<code>lattice::<a href="lattice.html#topic+levelplot">levelplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
library(terra)

f &lt;- system.file("external/test.grd", package="raster")

## raster
r &lt;- raster(f)
levelplot(r)
## terra
rt &lt;- rast(f)
levelplot(rt)

## Change the color theme
levelplot(r, par.settings=GrTheme())

## Not run: 
myPal &lt;- RColorBrewer::brewer.pal('Blues', n=9)
myTheme &lt;- rasterTheme(region = myPal)
levelplot(r, par.settings = myTheme)

## End(Not run)
## Define the legend breaks
my.at &lt;- seq(100, 1850, 500)
levelplot(rt, at=my.at)

myColorkey &lt;- list(at=my.at, ## where the colors change
                   labels=list(
                     at=my.at ## where to print labels
                     ))
levelplot(r, at=my.at, colorkey=myColorkey)

## Define the units of the color key
levelplot(r, margin = FALSE,
             colorkey = list(title = list("[m]",
                                          cex = 1,
                                          fontface = "bold",
                                          col = "red")
                             ))


levelplot(r, margin = FALSE,
          colorkey = list(title = "[m]",
                          space = "left",
                          title.control = list(side = "bottom")))

## shrink and border color
## raster
rCenter &lt;- (maxValue(r) + minValue(r)) / 2
levelplot(r - rCenter, par.settings=RdBuTheme(), shrink=c(.8, 15), border='black')
## Not run: 
## terra
tCenter &lt;- mean(minmax(rt))
levelplot(rt - tCenter, par.settings=RdBuTheme(), shrink=c(.8, 15), border='black')

## End(Not run)

## With subticks
levelplot(r, xscale.components=xscale.raster.subticks,
             yscale.components=yscale.raster.subticks)

## Not run: 
levelplot(rt, xscale.components=xscale.raster.subticks,
             yscale.components=yscale.raster.subticks,
             scales=list(x=list(rot=30, cex=0.8)))

## End(Not run)
## log-scale
levelplot(r^2, zscaleLog=TRUE, contour=TRUE)

## Customizing axis and title labels
levelplot(rt, margin=FALSE,
          main=list('My plot', col='red'),
          xlab=c('This is the', 'X-Axis'),
          ylab=list('Y-Axis', rot=30, fontface='bold')
          )

## xlim and ylim to display a smaller region
levelplot(r, xlim=c(179000, 181000), ylim=c(329500, 334000))

## RasterStacks
s &lt;- stack(r, r+500, r-500)
levelplot(s, contour=TRUE)
contourplot(s, labels=list(cex=0.4), cuts=12)

## Not run: 
## Use of layout
levelplot(s, layout=c(1, 3))

## SpatRaster with several layers
st &lt;- c(rt, rt + 500, rt - 500)

## c() assign the same name for all the layers,
## but each layer needs a unique name for levelplot
set.names(st, c("r0", "rp500", "rm500"))

levelplot(st, contour=TRUE)
contourplot(st, labels=list(cex=0.4), cuts=12)

levelplot(st, layout=c(1, 1)) # useful for animations

## End(Not run)

## names.attr to change the labels of each panel
levelplot(s, names.attr=c('R', 'R + 500', 'R - 500'))

## Defining the scales for the marginal plot
levelplot(r, margin = list(axis = TRUE,
                           scales = list(x=c(100, 600),
                                         y=c(100, 1000))))
## if a component of the list is null, it is internally calculated
levelplot(rt, margin=list(axis = TRUE, scales = list(x=c(100, 1000))))

## Add a layer of sampling points
## and change the theme
pts &lt;- sampleRandom(r, size=20, sp=TRUE)



## Using +.trellis and layer from latticeExtra
library(latticeExtra)

levelplot(r, par.settings = BTCTheme) +
   layer(sp.points(pts, col = 'red'))
contourplot(r, labels = FALSE) +
   layer(sp.points(pts, col = 'red'))

## or with a custom panel function
levelplot(r, par.settings=BTCTheme,
          panel=function(...){
            panel.levelplot(...)
            sp.points(pts, col='red')
            })


## Categorical data
r &lt;- raster(nrow=10, ncol=10)
r[] = 1
r[51:100] = 3
r[3:6, 1:5] = 5
r &lt;- ratify(r)
     
rat &lt;- levels(r)[[1]]
rat$landcover &lt;- c('Pine', 'Oak', 'Meadow')
rat$class &lt;- c('A1', 'B2', 'C3')
levels(r) &lt;- rat
r

levelplot(r, col.regions=c('palegreen', 'midnightblue', 'indianred1'))

## with 'att' you can choose another variable from the RAT
levelplot(r, att=2, col.regions=c('palegreen', 'midnightblue', 'indianred1'))
levelplot(r, att='class', col.regions=c('palegreen', 'midnightblue', 'indianred1'))

r2 &lt;- raster(r)
r2[] = 3
r2[51:100] = 1
r2[3:6, 1:5] = 5

r3 &lt;- raster::init(r, function(n)sample(c(1, 3, 5), n, replace=TRUE))

## Multilayer categorical Raster* are displayed only if their RATs are the same
levels(r2) &lt;- levels(r3) &lt;- levels(r)

s &lt;- stack(r, r2, r3)
names(s) &lt;- c('A', 'B', 'C')

levelplot(s)
levelplot(s, att=2)

## Not run: 
dataURL &lt;- "https://raw.github.com/oscarperpinan/bookvis/master/data/"

##Solar irradiation data from CMSAF http://dx.doi.org/10.5676/EUM_SAF_CM/RAD_MVIRI/V001
old &lt;- setwd(tempdir())
download.file(paste0(dataURL, "SISmm2008_CMSAF.zip"),
   "SISmm2008_CMSAF.zip", method='wget')
unzip("SISmm2008_CMSAF.zip")

listFich &lt;- dir(pattern='\\.nc')
stackSIS &lt;- stack(listFich)
stackSIS &lt;- stackSIS*24 ##from irradiance (W/m2) to irradiation Wh/m2

idx &lt;- seq(as.Date('2008-01-15'), as.Date('2008-12-15'), 'month')

SISmm &lt;- setZ(stackSIS, idx)
names(SISmm) &lt;- month.abb

levelplot(SISmm)

levelplot(SISmm, layers=1, margin = list(FUN = 'median'), contour=TRUE)

setwd(old)

## End(Not run)</code></pre>

<hr>
<h2 id='plot3D'>Interactive 3D plot of a RasterLayer</h2><span id='topic+plot3D'></span><span id='topic+plot3D+2CRasterLayer-method'></span>

<h3>Description</h3>

<p>Make an interactive 3D plot (map) of a RasterLayer. This is a wrapper around <code>surface3d</code> in the rgl package. You can use <code>decorate3d</code> to add axes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RasterLayer'
plot3D(x, maxpixels=1e5, 
   zfac=1, drape=NULL, col=terrain.colors,
   at=100, rev=FALSE,
   useLegend=TRUE, adjust=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot3D_+3A_x">x</code></td>
<td>
<p>a RasterLayer object</p>
</td></tr>
<tr><td><code id="plot3D_+3A_maxpixels">maxpixels</code></td>
<td>
<p>Maximum number of pixels to use</p>
</td></tr>
<tr><td><code id="plot3D_+3A_zfac">zfac</code></td>
<td>
<p>Numeric, to set the elevation scale relative to x and y</p>
</td></tr>
<tr><td><code id="plot3D_+3A_drape">drape</code></td>
<td>
<p>RasterLayer, to 'drape' colors representing the values of
this layer on the 3D representation of layer <code>x</code>. In this
case<code>x</code> typically has elevation data</p>
</td></tr>
<tr><td><code id="plot3D_+3A_col">col</code></td>
<td>
<p>A color palette generating function such as <code>rainbow</code>,
<code>heat.colors</code>, and <code>topo.colors</code>, or one or your own making</p>
</td></tr>
<tr><td><code id="plot3D_+3A_at">at</code></td>
<td>
<p>A numeric variable of breakpoints defining intervals along
the range of <code>x</code> or a number definining the number of
intervals the range of <code>x</code> will be divided into.</p>
</td></tr>
<tr><td><code id="plot3D_+3A_rev">rev</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the color palette values are
reversed in order</p>
</td></tr>
<tr><td><code id="plot3D_+3A_uselegend">useLegend</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default) the content of the
slot <code>x@legend@colortable</code> is used instead of <code>col</code> and
<code>at</code>.</p>
</td></tr>
<tr><td><code id="plot3D_+3A_adjust">adjust</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the x and y axes are scaled
relative to the cell (z) values</p>
</td></tr>
<tr><td><code id="plot3D_+3A_...">...</code></td>
<td>
<p>Any argument that can be passed to
<code><a href="rgl.html#topic+surface3d">surface3d</a></code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>Previous versions opened a new device with each call of
<code>plot3D</code>. This behaviour has been modified, and now a new device is
opened only if none is active. Thus, you should use <code>rgl::open3d()</code>
if you need to display a new scene without modifying the current one.</p>


<h3>Author(s)</h3>

<p> Robert J. Hijmans and Oscar Perpiñán</p>


<h3>Examples</h3>

<pre><code class='language-R'> ## Not run: 
library(raster)

## rgl is needed to use plot3D
library(rgl)

data(volcano)
r &lt;- raster(volcano)
extent(r) &lt;- c(0, 610, 0, 870)

## level plot as reference
levelplot(r, col.regions=terrain.colors)

plot3D(r)
## Use different colors with a predefined function
plot3D(r, col = rainbow)
## or with a custom function using colorRampPalette
myPal &lt;- colorRampPalette(RColorBrewer::brewer.pal(11, 'PuOr'))
plot3D(r, col = myPal)

## With at you can define an homogeneus color table for different Rasters

r2 &lt;- r + 100
r3 &lt;- r + 200
s &lt;- stack(r, r2, r3)

maxVal &lt;- max(maxValue(s))
minVal &lt;- min(minValue(s))
N &lt;- 40
breaks &lt;- seq(minVal, maxVal, length=N)

plot3D(r, at=breaks)
plot3D(r2, at=breaks)
plot3D(r3, at=breaks)

## Default: x-axis and y-axis are adjusted with z-values. Therefore,
## labels with decorate3d() are useless
plot3D(r, adjust=TRUE)
decorate3d()
## Compare the graphic limits
par3d('bbox')
## with the extent of the Raster
extent(r)

## Set adjust=FALSE to fix it
plot3D(r, adjust=FALSE)
decorate3d()
## Once again, compare the graphic limits
par3d('bbox')
## with the extent of the Raster
extent(r)

## zfac controls the z values so z-axis will be distorted
plot3D(r, adjust=FALSE, zfac=2)
decorate3d()
par3d('bbox')


## With drape you can disconnect the z-axis from the colors
drape &lt;- cut(r^4, 4)
plot3D(r, drape=drape)
## Compare with:
plot3D(r, at=4)

## End(Not run)
</code></pre>

<hr>
<h2 id='rasterTheme'>
Themes for <code>raster</code> with <code>lattice</code>.
</h2><span id='topic+rasterTheme'></span><span id='topic+BTCTheme'></span><span id='topic+YlOrRdTheme'></span><span id='topic+plasmaTheme'></span><span id='topic+infernoTheme'></span><span id='topic+viridisTheme'></span><span id='topic+magmaTheme'></span><span id='topic+RdBuTheme'></span><span id='topic+BuRdTheme'></span><span id='topic+PuOrTheme'></span><span id='topic+GrTheme'></span><span id='topic+streamTheme'></span><span id='topic+bwTheme'></span><span id='topic+xscale.raster'></span><span id='topic+yscale.raster'></span><span id='topic+xscale.raster.subticks'></span><span id='topic+yscale.raster.subticks'></span>

<h3>Description</h3>

<p>Auxiliary functions for the customization of trellis graphics with
<code>lattice</code>.
</p>
<p><code>xscale.raster</code> and <code>yscale.raster</code> suppress the right and top
axis, respectively. <code>xscale.raster.subticks</code> and
<code>yscale.raster.subticks</code> also suppress those axis and draw subticks.
</p>
<p><code>rasterTheme</code> is a customization of the <code>custom.theme.2</code> function of
<code>latticeExtra</code> using the magma palette of the <code>viridis</code>
package. The other palettes provided by this package are available
through the <code>viridisTheme</code>, <code>infernoTheme</code>, and <code>plasmaTheme</code>.
</p>
<p><code>YlOrRdTheme</code>, <code>BuRdTheme</code>, <code>RdBuTheme</code>, <code>GrTheme</code>
and <code>BTCTheme</code> are variations of <code>rasterTheme</code> using palettes
of the <code>RColorBrewer</code> and <code>hexbin</code> packages.
</p>
<p><code>streamTheme</code> is a variation of <code>rasterTheme</code> using black for
the region, gray for the panel background and a sequential palette for points.
</p>
<p><code>bwTheme</code> is a variation of <code>rasterTheme</code> for the
<code>bwplot</code> methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yscale.raster(lim, ...)
xscale.raster(lim, ...)
yscale.raster.subticks(lim, ...)
xscale.raster.subticks(lim, ...)

rasterTheme(region = magma(10),
            pch=19, cex=0.7, 
            strip.background = list(col = 'transparent'),
            strip.shingle = list(col = 'transparent'),
            strip.border = list(col = 'transparent'),
            add.lines = list(lwd = .4),
            ...)

magmaTheme(region = magma(10), ...)
infernoTheme(region = inferno(10), ...)
plasmaTheme(region = plasma(10), ...)
viridisTheme(region = viridis(10), ...)
 
YlOrRdTheme(region = brewer.pal(9, 'YlOrRd'), ...)
RdBuTheme(region = brewer.pal(9, 'RdBu'), ...)
BuRdTheme(region = rev(brewer.pal(9, 'RdBu')), ...)
PuOrTheme(region = brewer.pal(9, 'PuOr'), ...)
GrTheme(region = rev(brewer.pal(9, 'Greys')), ...) 
BTCTheme(region = BTC(n=9), ...)

streamTheme(region = 'black',
            symbol = brewer.pal(n=5, name='Blues'),
            alpha = 0.6,
            panel.background = list(col='gray20'),
            ...)

bwTheme(box.rectangle = list(col='black', fill = 'gray'),
        box.umbrella = list(col = 'black', lty = 1),
        plot.polygon = list(col = 'lightblue', alpha = 0.5),
        plot.symbol = list(cex = 0.5, alpha = 0.2),
        ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rasterTheme_+3A_lim">lim</code></td>
<td>
<p>Range of data.</p>
</td></tr>
<tr><td><code id="rasterTheme_+3A_pch">pch</code></td>
<td>
<p>Symbol used for points.</p>
</td></tr>
<tr><td><code id="rasterTheme_+3A_cex">cex</code></td>
<td>
<p>A numeric multiplier to control the size of the points.</p>
</td></tr>
<tr><td><code id="rasterTheme_+3A_region">region</code></td>
<td>
<p>A vector of colors that is used to define a continuous
color gradient using <code>colorRampPalette</code> to fill in
regions. Note that the length of this gradient is set by
<code><a href="latticeExtra.html#topic+custom.theme">custom.theme</a></code> to exactly 100 colors.</p>
</td></tr>
<tr><td><code id="rasterTheme_+3A_symbol">symbol</code></td>
<td>
<p>A palette to display symbols.</p>
</td></tr>
<tr><td><code id="rasterTheme_+3A_panel.background">panel.background</code></td>
<td>
<p>Parameters of the panel background.</p>
</td></tr>
<tr><td><code id="rasterTheme_+3A_alpha">alpha</code>, <code id="rasterTheme_+3A_...">...</code></td>
<td>
<p>Additional arguments for <code><a href="latticeExtra.html#topic+custom.theme.2">custom.theme.2</a></code>,
<code><a href="lattice.html#topic+yscale.components.default">yscale.components.default</a></code> and
<code><a href="lattice.html#topic+xscale.components.default">xscale.components.default</a></code>
</p>
</td></tr>
<tr><td><code id="rasterTheme_+3A_strip.background">strip.background</code>, <code id="rasterTheme_+3A_strip.shingle">strip.shingle</code>, <code id="rasterTheme_+3A_strip.border">strip.border</code></td>
<td>
<p>List whose
components define the configuration of the strip areas. Read the help page of <code><a href="lattice.html#topic+trellis.par.get">trellis.par.get</a></code> for details.</p>
</td></tr>
<tr><td><code id="rasterTheme_+3A_add.lines">add.lines</code></td>
<td>
<p>List whose components define the lines superposed on
the graphic. Read the help page of <code><a href="lattice.html#topic+trellis.par.get">trellis.par.get</a></code> for
details.</p>
</td></tr>
<tr><td><code id="rasterTheme_+3A_box.rectangle">box.rectangle</code></td>
<td>
<p>List whose components define the box of the
boxplot.</p>
</td></tr>
<tr><td><code id="rasterTheme_+3A_box.umbrella">box.umbrella</code></td>
<td>
<p>List whose components define the whiskers of the
boxplot.</p>
</td></tr>
<tr><td><code id="rasterTheme_+3A_plot.polygon">plot.polygon</code></td>
<td>
<p>List whose components define the violin plot.</p>
</td></tr>
<tr><td><code id="rasterTheme_+3A_plot.symbol">plot.symbol</code></td>
<td>
<p>List whose components define the raw points when
<code>draw.points = TRUE</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Oscar Perpiñán Lamigueiro</p>


<h3>See Also</h3>

<p><code>custom.theme</code>, <code>custom.theme.2</code>, <code>BTC</code>,
<code>xscale.components.default</code>, <code>xscale.components.subticks</code></p>

<hr>
<h2 id='splom-methods'>Scatter plot matrices of Raster objects.</h2><span id='topic+splom'></span><span id='topic+splom+2CRaster+2Cmissing-method'></span><span id='topic+splom+2CSpatRaster+2Cmissing-method'></span>

<h3>Description</h3>

<p>Draw conditional scatter plot matrices with hexagonally binning.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Raster,missing'
splom(x, data=NULL,maxpixels=1e5,
plot.loess=FALSE, colramp=BTC, varname.cex=0.6,...)
## S4 method for signature 'SpatRaster,missing'
splom(x, data=NULL,maxpixels=1e5, plot.loess=FALSE, colramp=BTC, varname.cex=0.6,...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="splom-methods_+3A_x">x</code></td>
<td>
<p>A <code>Raster</code> or a <code>SpatRaster</code> object.</p>
</td></tr>
<tr><td><code id="splom-methods_+3A_data">data</code></td>
<td>
<p>Not used.</p>
</td></tr>
<tr><td><code id="splom-methods_+3A_maxpixels">maxpixels</code></td>
<td>
<p>A numeric, for <code><a href="raster.html#topic+sampleRandom">sampleRandom</a></code> or <code>spatSample</code>.</p>
</td></tr>
<tr><td><code id="splom-methods_+3A_plot.loess">plot.loess</code></td>
<td>
<p>Logical, should a loess fit be drawn?.</p>
</td></tr>
<tr><td><code id="splom-methods_+3A_colramp">colramp</code></td>
<td>
<p>A function accepting an integer <code>n</code> as argument
and returning <code>n</code> colors (for <code><a href="#topic+hexbinplot">hexbinplot</a></code>).</p>
</td></tr>
<tr><td><code id="splom-methods_+3A_varname.cex">varname.cex</code></td>
<td>
<p>A numerical multiplier to control the size of the
variables names.</p>
</td></tr>
<tr><td><code id="splom-methods_+3A_...">...</code></td>
<td>
<p>Additional arguments for splom.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>While the hexagonal binning is quite fast for large datasets, the
use of the <code>loess</code> fit will slow this function.</p>


<h3>Author(s)</h3>

<p>Oscar Perpiñán Lamigueiro</p>


<h3>See Also</h3>

<p><code><a href="#topic+hexbinplot">hexbinplot</a></code>, <code><a href="lattice.html#topic+splom">splom</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(raster)
library(terra)

dataURL &lt;- "https://raw.github.com/oscarperpinan/bookvis/master/data/"

##Solar irradiation data from CMSAF http://dx.doi.org/10.5676/EUM_SAF_CM/RAD_MVIRI/V001
old &lt;- setwd(tempdir())
download.file(paste0(dataURL, "SISmm2008_CMSAF.zip"),
   "SISmm2008_CMSAF.zip", method='wget')
unzip("SISmm2008_CMSAF.zip")

listFich &lt;- dir(pattern='\\.nc')
stackSIS &lt;- stack(listFich)
stackSIS &lt;- stackSIS*24 ##from irradiance (W/m2) to irradiation Wh/m2
setwd(old)

idx &lt;- seq(as.Date('2008-01-15'), as.Date('2008-12-15'), 'month')

SISmm &lt;- setZ(stackSIS, idx)
names(SISmm) &lt;- month.abb

splom(SISmm)

## End(Not run)</code></pre>

<hr>
<h2 id='vectorplot-methods'>Vector plots of Raster objects.</h2><span id='topic+vectorplot'></span><span id='topic+vectorplot+2CRaster-method'></span><span id='topic+vectorplot+2CRasterStack-method'></span><span id='topic+streamplot'></span><span id='topic+streamplot+2CRaster-method'></span><span id='topic+streamplot+2CRasterStack-method'></span>

<h3>Description</h3>

<p><code>vectorplot</code> displays vector fields from Raster
objects using arrows.
</p>
<p><code>streamplot</code> displays streamlines with a procedure inspired by
the FROLIC algorithm (see references): for each point (<em>droplet</em>)
of a jittered regular grid, a short streamline portion
(<em>streamlet</em>) is calculated by integrating the underlying vector
field at that point. The main color of each streamlet indicates local
vector magnitude (<em>slope</em>). Streamlets are composed of points
whose sizes, positions and color degradation encode the local vector
direction (<em>aspect</em>).  </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Raster'
vectorplot(object, layers,
            narrows=2e3, lwd.arrows=0.6, col.arrows='black',
            length=unit(1e-2, 'npc'),
            maxpixels=1e5, region=TRUE, margin=FALSE,  
            isField=FALSE, reverse=FALSE,
            unit='radians', scaleSlope=TRUE,
            aspX=0.08, aspY=aspX,
            key.arrow = NULL,
            ...)

## S4 method for signature 'RasterStack'
vectorplot(object, layers,
            narrows=2e3, lwd.arrows=0.6, col.arrows='black',
            length=unit(1e-2, 'npc'),
            maxpixels=1e5, region=TRUE, margin=FALSE,
            isField=FALSE, reverse=FALSE,
            unit='radians', scaleSlope=TRUE,
            aspX=0.08, aspY=aspX,
            key.arrow = NULL,
            uLayers, vLayers, ...)

## S4 method for signature 'Raster'
streamplot(object, layers,
            droplet = list(), streamlet = list(),
            par.settings = streamTheme(),
            colorkey = FALSE,
            isField = FALSE, reverse = FALSE, 
            parallel = TRUE, mc.cores = detectCores(), cl = NULL,
            ...)

## S4 method for signature 'RasterStack'
streamplot(object, layers,
            droplet = list(), streamlet = list(),
            par.settings=streamTheme(),
            colorkey = FALSE,
            isField = FALSE, reverse = FALSE, 
            parallel = TRUE, mc.cores = detectCores(), cl = NULL,
            ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vectorplot-methods_+3A_object">object</code></td>
<td>
<p>A Raster object. If <code>isField=FALSE</code> the vector
field is calculated internally from the result of
<code><a href="raster.html#topic+terrain">terrain</a></code>. </p>
</td></tr>
<tr><td><code id="vectorplot-methods_+3A_layers">layers</code></td>
<td>
<p>A numeric or character which should indicate the layers
to be displayed.</p>
</td></tr>
<tr><td><code id="vectorplot-methods_+3A_maxpixels">maxpixels</code></td>
<td>
<p>A numeric, number of cells to be shown if
<code>region=TRUE</code> or if <code>region</code> is a <code>Raster*</code> object.</p>
</td></tr>
<tr><td><code id="vectorplot-methods_+3A_narrows">narrows</code></td>
<td>
<p>A numeric, number of arrows.</p>
</td></tr>
<tr><td><code id="vectorplot-methods_+3A_lwd.arrows">lwd.arrows</code></td>
<td>
<p>Numeric, width of the lines of the arrows</p>
</td></tr>
<tr><td><code id="vectorplot-methods_+3A_col.arrows">col.arrows</code></td>
<td>
<p>character, color of the arrows</p>
</td></tr>
<tr><td><code id="vectorplot-methods_+3A_length">length</code></td>
<td>
<p>Unit, extent of the arrow head.</p>
</td></tr>
<tr><td><code id="vectorplot-methods_+3A_margin">margin</code></td>
<td>
<p>Logical, if TRUE two marginal graphics show the summaries
of the object.</p>
</td></tr>
<tr><td><code id="vectorplot-methods_+3A_scaleslope">scaleSlope</code></td>
<td>
<p>Logical or numeric. If TRUE the slope (vector
magnitude) is scaled (but not centered) with its standard
deviation. If it is a numeric, the slope is scaled with this value.
It is not used if <code>isField='dXY'</code>.</p>
</td></tr>
<tr><td><code id="vectorplot-methods_+3A_aspx">aspX</code>, <code id="vectorplot-methods_+3A_aspy">aspY</code></td>
<td>
<p>Numeric. Multipliers to convert the slope values into
horizontal (<code>aspX</code>) and vertical (<code>aspY</code>) displacements.</p>
</td></tr>
<tr><td><code id="vectorplot-methods_+3A_key.arrow">key.arrow</code></td>
<td>
<p>A reference (or legend) vector. If is not NULL, it is a list with two named
components, <code>size</code>, a numeric to define the length of the arrow
(default 1), and <code>label</code>, a character to define the label
(default <code>''</code>).</p>
</td></tr> 
<tr><td><code id="vectorplot-methods_+3A_ulayers">uLayers</code>, <code id="vectorplot-methods_+3A_vlayers">vLayers</code></td>
<td>
<p>Numeric, indexes of layers with horizontal and
vertical components, respectively, when <code>isField='dXY'</code> and the
<code>RasterStack</code> has more than 2 layers.  If missing, the horizontal
components are the layers of the first half of the object, and the
vertical components are the layers of the second half.</p>
</td></tr>
<tr><td><code id="vectorplot-methods_+3A_droplet">droplet</code></td>
<td>
<p>A list whose elements define the droplet
configuration:</p>

<ul>
<li><p> cropExtent: Percentage of the object
extent to be cropped (default .97) to avoid droplets at boundaries
</p>
</li>
<li><p> pc: A numeric. It is the percentage of cells used to compute
droplets. Its default value is 0.5. Therefore, only the 0.5% of the
cells are used. For example, if you use a Raster with 180 rows and 360
columns (64800 cells), with this default value <code>streamplot</code> will
produce 324 droplets.</p>
</li></ul>

</td></tr>
<tr><td><code id="vectorplot-methods_+3A_streamlet">streamlet</code></td>
<td>
<p>A list whose elements define the streamlet
configuration:</p>

<ul>
<li><p> L: length of the streamlet (number of
points, default 10)
</p>
</li>
<li><p> h: streamlet calculation step (default
<code>mean(res(object))</code>).
</p>
</li></ul>

</td></tr>
<tr><td><code id="vectorplot-methods_+3A_par.settings">par.settings</code></td>
<td>
<p>A list to define the graphical parameters. For
<code>streamplot</code> there is an specific theme, <code>streamTheme</code>.</p>
</td></tr>
<tr><td><code id="vectorplot-methods_+3A_colorkey">colorkey</code></td>
<td>
<p>A logical specifying whether a color key is to be drawn
alongside the plot (default is <code>FALSE</code>), or a list describing
the color key (see the <code>colorkey</code> section of the help page of
<code>levelplot</code> for details).</p>
</td></tr>
<tr><td><code id="vectorplot-methods_+3A_parallel">parallel</code></td>
<td>
<p>Logical, TRUE (default) to use <code><a href="parallel.html#topic+parallel">parallel</a></code>
package.</p>
</td></tr>
<tr><td><code id="vectorplot-methods_+3A_cl">cl</code></td>
<td>
<p>a cluster object. Read the help page of
<code><a href="parallel.html#topic+parLapply">parLapply</a></code> for details.</p>
</td></tr>
<tr><td><code id="vectorplot-methods_+3A_mc.cores">mc.cores</code></td>
<td>
<p>The number of cores to use if <code>parallel=TRUE</code> and
no <code>cl</code> is provided. Read the help page of <code><a href="parallel.html#topic+mclapply">mclapply</a></code>
for details.</p>
</td></tr>
<tr><td><code id="vectorplot-methods_+3A_region">region</code></td>
<td>
<p>Logical, if <code>TRUE</code> the region is displayed as the
background  using <code>levelplot</code>. It can be a <code>Raster*</code> with
the same extent and resolution as <code>object</code>.</p>
</td></tr>
<tr><td><code id="vectorplot-methods_+3A_isfield">isField</code></td>
<td>
<p>If <code>TRUE</code> the object is a vector field. Thus,
<code>object</code> must be a Raster* with two layers, slope (local vector
magnitude) and aspect (local vector direction), in this order. The
aspect angle, following the conventions of
<code>raster::<a href="raster.html#topic+terrain">terrain</a></code>, must be computed clockwise from 0 (due
north). The slope layer will be used as the background if <code>region</code>
is <code>TRUE</code>.
</p>
<p>If <code>isField='dXY'</code> <code>object</code> must be a Raster* with two
layers representing the horizontal and the vertical components,
respectively. The slope is computed and used as the background if
<code>region</code> is TRUE.
</p>
</td></tr>
<tr><td><code id="vectorplot-methods_+3A_unit">unit</code></td>
<td>
<p>Character, angle units of the <code>aspect</code> layer if
<code>isField=TRUE</code>: 'radians' or 'degrees'.</p>
</td></tr>
<tr><td><code id="vectorplot-methods_+3A_reverse">reverse</code></td>
<td>
<p>Logical, if <code>isField=TRUE</code> and <code>reverse=TRUE</code>,
arrows or streamlets go against the direction of the gradient.</p>
</td></tr>
<tr><td><code id="vectorplot-methods_+3A_...">...</code></td>
<td>
<p>Additional arguments for <code><a href="#topic+levelplot">levelplot</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Oscar Perpiñán Lamigueiro</p>


<h3>References</h3>

<p>R. Wegenkittl and E. Gröller, Fast Oriented Line Integral Convolution for Vector Field
Visualization via the Internet, Proceedings IEEE Visualization ’97, 1997, <a href="http://www.cg.tuwien.ac.at/research/vis-dyn-syst/frolic/frolic_crc.pdf">http://www.cg.tuwien.ac.at/research/vis-dyn-syst/frolic/frolic_crc.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="lattice.html#topic+panel.arrows">panel.arrows</a></code>,
<code><a href="#topic+levelplot">levelplot</a></code>,
<code><a href="raster.html#topic+terrain">terrain</a></code>,
<code><a href="parallel.html#topic+mclapply">mclapply</a></code>,
<code><a href="parallel.html#topic+parLapply">parLapply</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(raster)

proj &lt;- CRS('+proj=longlat +datum=WGS84')

df &lt;- expand.grid(x=seq(-2, 2, .01), y=seq(-2, 2, .01))
df$z &lt;- with(df, (3*x^2 + y)*exp(-x^2-y^2))
r1 &lt;- rasterFromXYZ(df, crs=proj)
df$z &lt;- with(df, x*exp(-x^2-y^2))
r2 &lt;- rasterFromXYZ(df, crs=proj)
df$z &lt;- with(df, y*exp(-x^2-y^2))
r3 &lt;- rasterFromXYZ(df, crs=proj)
s &lt;- stack(r1, r2, r3)
names(s) &lt;- c('R1', 'R2', 'R3')

vectorplot(r1)
vectorplot(r2, par.settings=RdBuTheme())
vectorplot(r3, par.settings=PuOrTheme())

## scaleSlope, aspX and aspY
vectorplot(r1, scaleSlope=FALSE)
vectorplot(r1, scaleSlope=1e-5)
vectorplot(r1, scaleSlope=5e-6, alpha=0.6)
vectorplot(r1, scaleSlope=TRUE, aspX=0.1, alpha=0.6)
vectorplot(r1, scaleSlope=TRUE, aspX=0.3, alpha=0.3)


## Reference vector
# Default size (1)
vectorplot(r1, region = FALSE,
           key.arrow = list(label = 'm/s'))
vectorplot(r1, region = FALSE,
           key.arrow = list(size = 2, label = 'm/s'))

## A vector field defined with horizontal and vertical components
u &lt;- v &lt;- raster(xmn=0, xmx=2, ymn=0, ymx=2, ncol=1e3, nrow=1e3)
x &lt;- raster::init(u, fun='x')
y &lt;- raster::init(u, fun='y')
u &lt;- y * cos(x)
v &lt;- y * sin(x) 
field &lt;- stack(u, v)
names(field) &lt;- c('u', 'v')

vectorplot(field, isField='dXY', narrows=5e2)

## We can display both components as the background
vectorplot(field, isField='dXY', narrows=5e2, region=field)

## It is also possible to use a RasterStack
## with more than 2 layers when isField='dXY'
u1 &lt;- cos(y) * cos(x)
v1 &lt;- cos(y) * sin(x)
u2 &lt;- sin(y) * sin(x)
v2 &lt;- sin(y) * cos(x)
field &lt;- stack(u, u1, u2, v, v1, v2)
names(field) &lt;- c('u', 'u1', 'u2', 'v', 'v1', 'v2')

vectorplot(field, isField='dXY',
           narrows=300, lwd.arrows=.4,
           par.settings=BTCTheme(),
           layout=c(3, 1))

## uLayer and vLayer define which layers contain
## horizontal and vertical components, respectively
vectorplot(field, isField='dXY',
           narrows=300,
           uLayer=1:3,
           vLayer=6:4)

##################################################################
## Streamplot
##################################################################
## If no cluster is provided, streamplot uses parallel::mclapply except
## with Windows. Therefore, next code could spend a long time under
## Windows.
streamplot(r1)

## With a cluster
hosts &lt;- rep('localhost', 4)
cl &lt;- parallel::makeCluster(hosts)
palRed &lt;- RColorBrewer::brewer.pal(n = 5, name = 'Reds')
streamplot(r2, cl=cl,
           par.settings=streamTheme(symbol= palRed))
parallel::stopCluster(cl)

## Without parallel
palGreen &lt;- RColorBrewer::brewer.pal(n = 5, name = 'Greens')
streamplot(r3, parallel=FALSE,
           par.settings=streamTheme(symbol = palGreen))

## Configuration of droplets and streamlets
streamplot(s, layout=c(1, 3), droplet=list(pc=.2), streamlet=list(L=20),
           par.settings=streamTheme(cex=.6))

## End(Not run)

</code></pre>

<hr>
<h2 id='xyLayer'>xyLayer
</h2><span id='topic+xyLayer'></span>

<h3>Description</h3>

<p>Create a numeric vector from a function of the coordinates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xyLayer(object, dirXY = y, vector = TRUE, maxpixels)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xyLayer_+3A_object">object</code></td>
<td>
<p>A <code>Raster</code> or a <code>SpatRaster</code> object.
</p>
</td></tr>
<tr><td><code id="xyLayer_+3A_dirxy">dirXY</code></td>
<td>
<p>A expression indicating the function of <code>x</code> and
<code>y</code> (coordinates of the <code>Raster</code> object) to be evaluated.
</p>
</td></tr>
<tr><td><code id="xyLayer_+3A_vector">vector</code></td>
<td>
<p>Logical. If TRUE (default) a numeric vector is returned,
else a <code>Raster</code> or a <code>SpatRaster</code> object is returned.
</p>
</td></tr>
<tr><td><code id="xyLayer_+3A_maxpixels">maxpixels</code></td>
<td>
<p>A positive integer giving the number of cells to
display, for <code><a href="raster.html#topic+sampleRegular">sampleRegular</a></code> or
<code><a href="terra.html#topic+spatSample">spatSample</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector or a <code>Raster</code>/<code>SpatRaster</code> object.
</p>


<h3>Author(s)</h3>

<p>Oscar Perpiñán Lamigueiro.
</p>


<h3>See Also</h3>

<p><code>init</code>, <code>substitute</code>, <code>eval</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)

f &lt;- system.file("external/test.grd", package="raster")
r &lt;- raster(f)
dirX &lt;- xyLayer(r, x)
dirXY &lt;- xyLayer(r, sqrt(x^2 + y^2))
</code></pre>

<hr>
<h2 id='xyplot-methods'>xyplot for Raster objects</h2><span id='topic+xyplot'></span><span id='topic+xyplot+2CRasterStackBrick+2Cmissing-method'></span><span id='topic+xyplot+2CSpatRaster+2Cmissing-method'></span>

<h3>Description</h3>

<p>Scatter plots of space-time Raster objects for directions defined by <code>xyLayer</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RasterStackBrick,missing'
xyplot(x, data=NULL, dirXY=y,
       stat='mean', xlab='Time', ylab='',
       digits=0, par.settings=rasterTheme(),
       auto.key = FALSE, ...)
## S4 method for signature 'SpatRaster,missing'
xyplot(x, data=NULL, dirXY=y,
       stat='mean', xlab='Time', ylab='',
       digits=0, par.settings=rasterTheme(),
       auto.key = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xyplot-methods_+3A_x">x</code></td>
<td>
<p>A <code>RasterStackBrick</code> object or a <code>SpatRaster</code> object
whose <code>z</code> slot or time index are not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="xyplot-methods_+3A_data">data</code></td>
<td>
<p>Not used.</p>
</td></tr>
<tr><td><code id="xyplot-methods_+3A_dirxy">dirXY</code></td>
<td>
<p>A direction as a function of the coordinates (see
<code><a href="#topic+xyLayer">xyLayer</a></code>).</p>
</td></tr>
<tr><td><code id="xyplot-methods_+3A_stat">stat</code></td>
<td>
<p>a function to be applied to summarize the values by
zone. See <code><a href="raster.html#topic+zonal">zonal</a></code> for details.</p>
</td></tr>
<tr><td><code id="xyplot-methods_+3A_xlab">xlab</code>, <code id="xyplot-methods_+3A_ylab">ylab</code></td>
<td>
<p>Labels of the axis.</p>
</td></tr>
<tr><td><code id="xyplot-methods_+3A_par.settings">par.settings</code></td>
<td>
<p>Customization of <code>lattice</code>. See <code>xyplot</code>
for details.</p>
</td></tr>
<tr><td><code id="xyplot-methods_+3A_digits">digits</code></td>
<td>
<p>An integer, number of digits for <code><a href="raster.html#topic+zonal">zonal</a></code>.</p>
</td></tr>
<tr><td><code id="xyplot-methods_+3A_auto.key">auto.key</code></td>
<td>
<p>A logical or a list. If it is FALSE (default) a label
with the value of the direction (as defined by <code>dirXY</code>)will be
printed next to each line. You should read the help page of
<code>xyplot</code> for details about the usage of <code>auto.key</code> as a list.</p>
</td></tr>
<tr><td><code id="xyplot-methods_+3A_...">...</code></td>
<td>
<p>Additional arguments for the <code>xyplot</code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Oscar Perpiñán Lamigueiro</p>


<h3>See Also</h3>

<p>zonal</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(raster)
library(terra)

dataURL &lt;- "https://raw.github.com/oscarperpinan/bookvis/master/data/"

##Solar irradiation data from CMSAF http://dx.doi.org/10.5676/EUM_SAF_CM/RAD_MVIRI/V001
old &lt;- setwd(tempdir())
download.file(paste0(dataURL, "SISmm2008_CMSAF.zip"),
   "SISmm2008_CMSAF.zip", method='wget')
unzip("SISmm2008_CMSAF.zip")

listFich &lt;- dir(pattern='\\.nc')
stackSIS &lt;- stack(listFich)
stackSIS &lt;- stackSIS*24 ##from irradiance (W/m2) to irradiation Wh/m2

idx &lt;- seq(as.Date('2008-01-15'), as.Date('2008-12-15'), 'month')

SISmm &lt;- setZ(stackSIS, idx)
names(SISmm) &lt;- month.abb

xyplot(SISmm)

## End(Not run)

## Not run: 
library(zoo)

url &lt;- "ftp://ftp.wiley.com/public/sci_tech_med/spatio_temporal_data/"
sst.dat = read.table(paste(url, "SST011970_032003.dat", sep=''), header = FALSE) 
sst.ll = read.table(paste(url, "SSTlonlat.dat", sep=''), header = FALSE)

spSST &lt;- SpatialPointsDataFrame(sst.ll, sst.dat)
gridded(spSST) &lt;- TRUE
proj4string(spSST) = "+proj=longlat +datum=WGS84"
SST &lt;- brick(spSST)

idx &lt;- seq(as.Date('1970-01-01'), as.Date('2003-03-01'), by='month')
idx &lt;- as.yearmon(idx)
SST &lt;- setZ(SST, idx)
names(SST) &lt;- as.character(idx)

xyplot(SST)

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
