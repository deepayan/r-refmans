<!DOCTYPE html><html lang="en"><head><title>Help for package profvis</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {profvis}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#profvis-package'><p>profvis: Interactive Visualizations for Profiling R Code</p></a></li>
<li><a href='#parse_rprof'><p>Parse Rprof output file for use with profvis</p></a></li>
<li><a href='#pause'><p>Pause an R process</p></a></li>
<li><a href='#print.profvis'><p>Print a profvis object</p></a></li>
<li><a href='#profvis'><p>Profile an R expression and visualize profiling data</p></a></li>
<li><a href='#profvis_ui'><p>profvis UI for Shiny Apps</p></a></li>
<li><a href='#profvisOutput'><p>Widget output and renders functions for use in Shiny</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Interactive Visualizations for Profiling R Code</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Interactive visualizations for profiling R code.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://profvis.r-lib.org">https://profvis.r-lib.org</a>, <a href="https://github.com/r-lib/profvis">https://github.com/r-lib/profvis</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/r-lib/profvis/issues">https://github.com/r-lib/profvis/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>htmlwidgets (&ge; 0.3.2), rlang (&ge; 1.1.0), vctrs</td>
</tr>
<tr>
<td>Suggests:</td>
<td>htmltools, knitr, rmarkdown, shiny, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>tidyverse/tidytemplate, rmarkdown</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-19 19:26:06 UTC; hadleywickham</td>
</tr>
<tr>
<td>Author:</td>
<td>Hadley Wickham [aut, cre],
  Winston Chang [aut],
  Javier Luraschi [aut],
  Timothy Mastny [aut],
  Posit Software, PBC [cph, fnd],
  jQuery Foundation [cph] (jQuery library),
  jQuery contributors [ctb, cph] (jQuery library; authors listed in
    inst/htmlwidgets/lib/jquery/AUTHORS.txt),
  Mike Bostock [ctb, cph] (D3 library),
  D3 contributors [ctb] (D3 library),
  Ivan Sagalaev [ctb, cph] (highlight.js library)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hadley Wickham &lt;hadley@posit.co&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-20 11:50:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='profvis-package'>profvis: Interactive Visualizations for Profiling R Code</h2><span id='topic+profvis-package'></span>

<h3>Description</h3>

<p>Interactive visualizations for profiling R code.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Hadley Wickham <a href="mailto:hadley@posit.co">hadley@posit.co</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Winston Chang
</p>
</li>
<li><p> Javier Luraschi
</p>
</li>
<li><p> Timothy Mastny
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Posit Software, PBC [copyright holder, funder]
</p>
</li>
<li><p>  jQuery Foundation (jQuery library) [copyright holder]
</p>
</li>
<li><p>  jQuery contributors (jQuery library; authors listed in inst/htmlwidgets/lib/jquery/AUTHORS.txt) [contributor, copyright holder]
</p>
</li>
<li><p> Mike Bostock (D3 library) [contributor, copyright holder]
</p>
</li>
<li><p>  D3 contributors (D3 library) [contributor]
</p>
</li>
<li><p> Ivan Sagalaev (highlight.js library) [contributor, copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://profvis.r-lib.org">https://profvis.r-lib.org</a>
</p>
</li>
<li> <p><a href="https://github.com/r-lib/profvis">https://github.com/r-lib/profvis</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/r-lib/profvis/issues">https://github.com/r-lib/profvis/issues</a>
</p>
</li></ul>


<hr>
<h2 id='parse_rprof'>Parse Rprof output file for use with profvis</h2><span id='topic+parse_rprof'></span>

<h3>Description</h3>

<p>Parse Rprof output file for use with profvis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_rprof(path = "Rprof.out", expr_source = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="parse_rprof_+3A_path">path</code></td>
<td>
<p>Path to the <code><a href="utils.html#topic+Rprof">Rprof()</a></code> output file.</p>
</td></tr>
<tr><td><code id="parse_rprof_+3A_expr_source">expr_source</code></td>
<td>
<p>If any source refs in the profiling output have an empty
filename, that means they refer to code executed at the R console. This
code can be captured and passed (as a string) as the <code>expr_source</code>
argument.</p>
</td></tr>
</table>

<hr>
<h2 id='pause'>Pause an R process</h2><span id='topic+pause'></span>

<h3>Description</h3>

<p>This function pauses an R process for some amount of time. It differs from
<code><a href="base.html#topic+Sys.sleep">Sys.sleep()</a></code> in that time spent in <code>pause</code> will show up in
profiler data. Another difference is that <code>pause</code> uses up 100\
whereas <code>Sys.sleep</code> does not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pause(seconds)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pause_+3A_seconds">seconds</code></td>
<td>
<p>Number of seconds to pause.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Wait for 0.5 seconds
pause(0.5)

</code></pre>

<hr>
<h2 id='print.profvis'>Print a profvis object</h2><span id='topic+print.profvis'></span>

<h3>Description</h3>

<p>Print a profvis object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'profvis'
print(x, ..., width = NULL, height = NULL, split = NULL, aggregate = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.profvis_+3A_x">x</code></td>
<td>
<p>The object to print.</p>
</td></tr>
<tr><td><code id="print.profvis_+3A_...">...</code></td>
<td>
<p>Further arguments to passed on to other print methods.</p>
</td></tr>
<tr><td><code id="print.profvis_+3A_width">width</code></td>
<td>
<p>Width of the htmlwidget.</p>
</td></tr>
<tr><td><code id="print.profvis_+3A_height">height</code></td>
<td>
<p>Height of the htmlwidget</p>
</td></tr>
<tr><td><code id="print.profvis_+3A_split">split</code></td>
<td>
<p>Orientation of the split bar: either <code>"h"</code> (the default) for
horizontal or <code>"v"</code> for vertical.</p>
</td></tr>
<tr><td><code id="print.profvis_+3A_aggregate">aggregate</code></td>
<td>
<p>If <code>TRUE</code>, the profiled stacks are aggregated by
name. This makes it easier to see the big picture. Set your own
global default for this argument with <code>options(profvis.aggregate = )</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='profvis'>Profile an R expression and visualize profiling data</h2><span id='topic+profvis'></span>

<h3>Description</h3>

<p>This function will run an R expression with profiling, and then return an
htmlwidget for interactively exploring the profiling data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>profvis(
  expr = NULL,
  interval = 0.01,
  prof_output = NULL,
  prof_input = NULL,
  timing = NULL,
  width = NULL,
  height = NULL,
  split = c("h", "v"),
  torture = 0,
  simplify = TRUE,
  rerun = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="profvis_+3A_expr">expr</code></td>
<td>
<p>Expression to profile. The expression will be turned into the
body of a zero-argument anonymous function which is then called repeatedly
as needed. This means that if you create variables inside of <code>expr</code> they
will not be available outside of it.
</p>
<p>The expression is repeatedly evaluated until <code>Rprof()</code> produces
an output. It can <em>be</em> a quosure injected with <code><a href="rlang.html#topic+inject">rlang::inject()</a></code> but
it cannot <em>contain</em> injected quosures.
</p>
<p>Not compatible with <code>prof_input</code>.</p>
</td></tr>
<tr><td><code id="profvis_+3A_interval">interval</code></td>
<td>
<p>Interval for profiling samples, in seconds. Values less than
0.005 (5 ms) will probably not result in accurate timings</p>
</td></tr>
<tr><td><code id="profvis_+3A_prof_output">prof_output</code></td>
<td>
<p>Name of an Rprof output file or directory in which to save
profiling data. If <code>NULL</code> (the default), a temporary file will be used
and automatically removed when the function exits. For a directory, a
random filename is used.</p>
</td></tr>
<tr><td><code id="profvis_+3A_prof_input">prof_input</code></td>
<td>
<p>The path to an <code><a href="utils.html#topic+Rprof">Rprof()</a></code> data file.  Not
compatible with <code>expr</code> or <code>prof_output</code>.</p>
</td></tr>
<tr><td><code id="profvis_+3A_timing">timing</code></td>
<td>
<p>The type of timing to use. Either <code>"elapsed"</code> (the
default) for wall clock time, or <code>"cpu"</code> for CPU time. Wall clock time
includes time spent waiting for other processes (e.g. waiting for a
web page to download) so is generally more useful.
</p>
<p>If <code>NULL</code>, the default, will use elapsed time where possible, i.e.
on Windows or on R 4.4.0 or greater.</p>
</td></tr>
<tr><td><code id="profvis_+3A_width">width</code></td>
<td>
<p>Width of the htmlwidget.</p>
</td></tr>
<tr><td><code id="profvis_+3A_height">height</code></td>
<td>
<p>Height of the htmlwidget</p>
</td></tr>
<tr><td><code id="profvis_+3A_split">split</code></td>
<td>
<p>Orientation of the split bar: either <code>"h"</code> (the default) for
horizontal or <code>"v"</code> for vertical.</p>
</td></tr>
<tr><td><code id="profvis_+3A_torture">torture</code></td>
<td>
<p>Triggers garbage collection after every <code>torture</code> memory
allocation call.
</p>
<p>Note that memory allocation is only approximate due to the nature of the
sampling profiler and garbage collection: when garbage collection triggers,
memory allocations will be attributed to different lines of code. Using
<code>torture = steps</code> helps prevent this, by making R trigger garbage
collection after every <code>torture</code> memory allocation step.</p>
</td></tr>
<tr><td><code id="profvis_+3A_simplify">simplify</code></td>
<td>
<p>Whether to simplify the profiles by removing
intervening frames caused by lazy evaluation. Equivalent to the
<code>filter.callframes</code> argument to <code><a href="utils.html#topic+Rprof">Rprof()</a></code>.</p>
</td></tr>
<tr><td><code id="profvis_+3A_rerun">rerun</code></td>
<td>
<p>If <code>TRUE</code>, <code>Rprof()</code> is run again with <code>expr</code> until a
profile is actually produced. This is useful for the cases where
<code>expr</code> returns too quickly, before R had time to sample a
profile. Can also be a string containing a regexp to match
profiles. In this case, <code>profvis()</code> reruns <code>expr</code> until the
regexp matches the modal value of the profile stacks.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An alternate way to use <code>profvis</code> is to separately capture the profiling
data to a file using <code><a href="utils.html#topic+Rprof">Rprof()</a></code>, and then pass the path to the
corresponding data file as the <code>prof_input</code> argument to
<code>profvis()</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.profvis">print.profvis()</a></code> for printing options.
</p>
<p><code><a href="utils.html#topic+Rprof">Rprof()</a></code> for more information about how the profiling
data is collected.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Only run these examples in interactive R sessions
if (interactive()) {

# Profile some code
profvis({
  dat &lt;- data.frame(
    x = rnorm(5e4),
    y = rnorm(5e4)
  )

  plot(x ~ y, data = dat)
  m &lt;- lm(x ~ y, data = dat)
  abline(m, col = "red")
})


# Save a profile to an HTML file
p &lt;- profvis({
  dat &lt;- data.frame(
    x = rnorm(5e4),
    y = rnorm(5e4)
  )

  plot(x ~ y, data = dat)
  m &lt;- lm(x ~ y, data = dat)
  abline(m, col = "red")
})
htmlwidgets::saveWidget(p, "profile.html")

# Can open in browser from R
browseURL("profile.html")

}
</code></pre>

<hr>
<h2 id='profvis_ui'>profvis UI for Shiny Apps</h2><span id='topic+profvis_ui'></span><span id='topic+profvis_server'></span>

<h3>Description</h3>

<p>Use this Shiny module to inject profvis controls into your Shiny app. The
profvis Shiny module injects UI that can be used to start and stop profiling,
and either view the results in the profvis UI or download the raw .Rprof
data. It is highly recommended that this be used for testing and debugging
only, and not included in production apps!
</p>


<h3>Usage</h3>

<pre><code class='language-R'>profvis_ui(id)

profvis_server(input, output, session, dir = ".")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="profvis_ui_+3A_id">id</code></td>
<td>
<p>Output id from <code>profvis_server</code>.</p>
</td></tr>
<tr><td><code id="profvis_ui_+3A_input">input</code>, <code id="profvis_ui_+3A_output">output</code>, <code id="profvis_ui_+3A_session">session</code></td>
<td>
<p>Arguments provided by
<code><a href="shiny.html#topic+callModule">shiny::callModule()</a></code>.</p>
</td></tr>
<tr><td><code id="profvis_ui_+3A_dir">dir</code></td>
<td>
<p>Output directory to save Rprof files.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The usual way to use profvis with Shiny is to simply call
<code>profvis(shiny::runApp())</code>, but this may not always be possible or desirable:
first, if you only want to profile a particular interaction in the Shiny app
and not capture all the calculations involved in starting up the app and
getting it into the correct state; and second, if you're trying to profile an
application that's been deployed to a server.
</p>
<p>For more details on how to invoke Shiny modules, see <a href="https://shiny.rstudio.com/articles/modules.html">this article</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># In order to avoid "Hit &lt;Return&gt; to see next plot" prompts,
# run this example with `example(profvis_ui, ask=FALSE)`

if(interactive()) {
  library(shiny)
  shinyApp(
    fluidPage(
      plotOutput("plot"),
      actionButton("new", "New plot"),
      profvis_ui("profiler")
    ),
    function(input, output, session) {
      callModule(profvis_server, "profiler")

      output$plot &lt;- renderPlot({
        input$new
        boxplot(mpg ~ cyl, data = mtcars)
      })
    }
  )
}

</code></pre>

<hr>
<h2 id='profvisOutput'>Widget output and renders functions for use in Shiny</h2><span id='topic+profvisOutput'></span><span id='topic+renderProfvis'></span>

<h3>Description</h3>

<p>Widget output and renders functions for use in Shiny
</p>


<h3>Usage</h3>

<pre><code class='language-R'>profvisOutput(outputId, width = "100%", height = "600px")

renderProfvis(expr, env = parent.frame(), quoted = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="profvisOutput_+3A_outputid">outputId</code></td>
<td>
<p>Output variable for profile visualization.</p>
</td></tr>
<tr><td><code id="profvisOutput_+3A_width">width</code></td>
<td>
<p>Width of the htmlwidget.</p>
</td></tr>
<tr><td><code id="profvisOutput_+3A_height">height</code></td>
<td>
<p>Height of the htmlwidget</p>
</td></tr>
<tr><td><code id="profvisOutput_+3A_expr">expr</code></td>
<td>
<p>An expression that returns a profvis object.</p>
</td></tr>
<tr><td><code id="profvisOutput_+3A_env">env</code></td>
<td>
<p>The environment in which to evaluate <code>expr</code>.</p>
</td></tr>
<tr><td><code id="profvisOutput_+3A_quoted">quoted</code></td>
<td>
<p>Is <code>expr</code> a quoted expression (with <code><a href="base.html#topic+quote">quote()</a></code>)?</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
