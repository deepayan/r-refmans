<!DOCTYPE html><html><head><title>Help for package asm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {asm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#asm'><p>Linear regression via antitonic score matching</p></a></li>
<li><a href='#asm.fit'><p>Fit a linear regression model via antitonic score matching</p></a></li>
<li><a href='#coef.asm'><p>Coefficients of an <code>asm</code> regression model</p></a></li>
<li><a href='#confint.asm'><p>Confidence intervals for coefficients</p>
in an <code>asm</code> regression model</a></li>
<li><a href='#plot.asm'><p>Generate diagnostic plots for an <code>asm</code> regression model</p></a></li>
<li><a href='#predict.asm'><p>Predict new responses using an <code>asm</code> regression model.</p></a></li>
<li><a href='#print.asm'><p>Short description of a fitted <code>asm</code> regression model</p></a></li>
<li><a href='#print.summary.asm'><p>Print summary of the <code>asm</code> regression model</p></a></li>
<li><a href='#residuals.asm'><p>Residuals from an <code>asm</code> regression model</p></a></li>
<li><a href='#summary.asm'><p>Summary of an <code>asm</code> regression model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Optimal Convex M-Estimation for Linear Regression via Antitonic
Score Matching</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Performs linear regression with respect to a data-driven convex loss function that is chosen to minimize the asymptotic covariance of the resulting M-estimator. The convex loss function is estimated in 5 steps: (1) form an initial OLS (ordinary least squares) or LAD (least absolute deviation) estimate of the regression coefficients; (2) use the resulting residuals to obtain a kernel estimator of the error density; (3) estimate the score function of the errors by differentiating the logarithm of the kernel density estimate; (4) compute the L2 projection of the estimated score function onto the set of decreasing functions; (5) take a negative antiderivative of the projected score function estimate. Newton's method (with Hessian modification) is then used to minimize the convex empirical risk function. Further details of the method are given in Feng et al. (2024) &lt;<a href="https://doi.org/10.48550%2FarXiv.2403.16688">doi:10.48550/arXiv.2403.16688</a>&gt;.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>fdrtool, pracma, Iso, MASS, quantreg</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-11 01:30:02 UTC; minx</td>
</tr>
<tr>
<td>Author:</td>
<td>Yu-Chun Kao [aut],
  Min Xu [aut, cre],
  Oliver Y. Feng [aut],
  Richard J. Samworth [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Min Xu &lt;min.cut@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-11 02:23:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='asm'>Linear regression via antitonic score matching</h2><span id='topic+asm'></span>

<h3>Description</h3>

<p>Performs linear regression with a data-driven convex loss function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>asm(formula, data = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="asm_+3A_formula">formula</code></td>
<td>
<p>regression formula</p>
</td></tr>
<tr><td><code id="asm_+3A_data">data</code></td>
<td>
<p>input data frame</p>
</td></tr>
<tr><td><code id="asm_+3A_...">...</code></td>
<td>
<p>additional arguments for asm.fit</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>asm</code> class object containing the following components:
</p>

<dl>
<dt><code>betahat</code>:</dt><dd><p>vector of estimated coefficients</p>
</dd>
<dt><code>std_errs</code>:</dt><dd><p>vector of standard errors of the estimated coefficients</p>
</dd>
<dt><code>fitted.values</code>:</dt><dd><p>fitted values</p>
</dd>
<dt><code>residuals</code>:</dt><dd><p>residuals</p>
</dd>
<dt><code>zvals</code>:</dt><dd><p>z-values</p>
</dd>
<dt><code>sig_vals</code>:</dt><dd><p>p-values</p>
</dd>
<dt><code>info_asm</code>:</dt><dd><p>antitonic information</p>
</dd>
<dt><code>I_mat</code>:</dt><dd><p>estimated antitonic information matrix</p>
</dd>
<dt><code>Cov_mat</code>:</dt><dd><p>covariance matrix of the estimated coefficients</p>
</dd>
<dt><code>psi</code>:</dt><dd><p>estimated antitonic score function</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>asm(mpg ~ cyl + hp + disp, data=mtcars)
</code></pre>

<hr>
<h2 id='asm.fit'>Fit a linear regression model via antitonic score matching</h2><span id='topic+asm.fit'></span>

<h3>Description</h3>

<p>Performs linear regression via M-estimation with respect to a data-driven convex loss function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>asm.fit(
  X,
  Y,
  betapilot = "OLS",
  alt_iter = 1,
  intercept.selection = "mean",
  k = 3000,
  max_iter = 65,
  kernel_pts = 2^15,
  bw = "nrd0",
  kernel = "gaussian",
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="asm.fit_+3A_x">X</code></td>
<td>
<p>design matrix</p>
</td></tr>
<tr><td><code id="asm.fit_+3A_y">Y</code></td>
<td>
<p>response vector</p>
</td></tr>
<tr><td><code id="asm.fit_+3A_betapilot">betapilot</code></td>
<td>
<p>initial estimate of the regression coefficients:
can be &quot;LAD&quot;, &quot;OLS&quot; or a vector of coefficients</p>
</td></tr>
<tr><td><code id="asm.fit_+3A_alt_iter">alt_iter</code></td>
<td>
<p>number of iterations of the alternating procedure:
when alt_iter == 1, this function is equivalent to asm_regression</p>
</td></tr>
<tr><td><code id="asm.fit_+3A_intercept.selection">intercept.selection</code></td>
<td>
<p>mean or median of the residuals
if intercept.selection == &quot;median&quot;,
then the standard error of the intercept estimate is set to NA</p>
</td></tr>
<tr><td><code id="asm.fit_+3A_k">k</code></td>
<td>
<p>the density quantile function is evaluated at (0, 1/<code>k</code>, 2/<code>k</code>, ..., 1)</p>
</td></tr>
<tr><td><code id="asm.fit_+3A_max_iter">max_iter</code></td>
<td>
<p>maximum number of iterations for the damped Newtonâ€“Raphson algorithm
when minimizing the convex loss function</p>
</td></tr>
<tr><td><code id="asm.fit_+3A_kernel_pts">kernel_pts</code></td>
<td>
<p>number of points at which the kernel density estimate is evaluated,
i.e. the parameter &quot;n&quot; in density()</p>
</td></tr>
<tr><td><code id="asm.fit_+3A_bw">bw</code></td>
<td>
<p>bandwidth for kernel density estimation
i.e. the parameter &quot;bw&quot; in density()</p>
</td></tr>
<tr><td><code id="asm.fit_+3A_kernel">kernel</code></td>
<td>
<p>kernel for kernel density estimation
i.e. the parameter &quot;kernel&quot; in density()</p>
</td></tr>
<tr><td><code id="asm.fit_+3A_verbose">verbose</code></td>
<td>
<p>logical; if TRUE, print optimization progress</p>
</td></tr>
<tr><td><code id="asm.fit_+3A_...">...</code></td>
<td>
<p>additional arguments to ensure compatibility with generic functions</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>asm</code> class object containing the following components:
</p>

<dl>
<dt><code>betahat</code>:</dt><dd><p>vector of estimated coefficients</p>
</dd>
<dt><code>std_errs</code>:</dt><dd><p>vector of standard errors of the estimated coefficients</p>
</dd>
<dt><code>fitted.values</code>:</dt><dd><p>fitted values</p>
</dd>
<dt><code>residuals</code>:</dt><dd><p>residuals</p>
</dd>
<dt><code>zvals</code>:</dt><dd><p>z-values</p>
</dd>
<dt><code>sig_vals</code>:</dt><dd><p>p-values</p>
</dd>
<dt><code>info_asm</code>:</dt><dd><p>antitonic information</p>
</dd>
<dt><code>I_mat</code>:</dt><dd><p>estimated antitonic information matrix</p>
</dd>
<dt><code>Cov_mat</code>:</dt><dd><p>asymptotic covariance matrix of the estimated coefficients</p>
</dd>
<dt><code>psi</code>:</dt><dd><p>estimated antitonic score function</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 1000 ; d &lt;- 2
X &lt;- matrix(rnorm(n * d), n, d)
Y &lt;- X %*% c(2, 3) + rnorm(n) # no intercept!
asm.fit(X,Y)
</code></pre>

<hr>
<h2 id='coef.asm'>Coefficients of an <code>asm</code> regression model</h2><span id='topic+coef.asm'></span>

<h3>Description</h3>

<p>Outputs the coefficients of a fitted <code>asm</code> regression model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'asm'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.asm_+3A_object">object</code></td>
<td>
<p>asm object</p>
</td></tr>
<tr><td><code id="coef.asm_+3A_...">...</code></td>
<td>
<p>additional arguments to ensure compatibility with the generic function coef()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of coefficients of the <code>asm</code> regression model
</p>


<h3>Examples</h3>

<pre><code class='language-R'>model = asm(mpg ~ cyl + hp + disp, data=mtcars)
coef(model)

</code></pre>

<hr>
<h2 id='confint.asm'>Confidence intervals for coefficients
in an <code>asm</code> regression model</h2><span id='topic+confint.asm'></span>

<h3>Description</h3>

<p>Computes confidence intervals for individual regression coefficients based on a fitted <code>asm</code> regression model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'asm'
confint(object, parm, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.asm_+3A_object">object</code></td>
<td>
<p>asm object</p>
</td></tr>
<tr><td><code id="confint.asm_+3A_parm">parm</code></td>
<td>
<p>parameters to calculate confidence intervals</p>
</td></tr>
<tr><td><code id="confint.asm_+3A_level">level</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="confint.asm_+3A_...">...</code></td>
<td>
<p>additional arguments to ensure compatibility with the generic function confint()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of confidence intervals for the regression coefficients
</p>


<h3>Examples</h3>

<pre><code class='language-R'>model = asm(mpg ~ cyl + hp + disp, data=mtcars)
confint(model)

</code></pre>

<hr>
<h2 id='plot.asm'>Generate diagnostic plots for an <code>asm</code> regression model</h2><span id='topic+plot.asm'></span>

<h3>Description</h3>

<p>Generates plots of residuals vs fitted values, and the estimated convex loss
and antitonic score functions based on a fitted <code>asm</code> regression model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'asm'
plot(
  x,
  which = c(1, 2, 3),
  caption = list("Residuals vs fitted", "Convex loss function",
    "Antitonic score function"),
  extend.ylim.f = 0.08,
  id.n = 3,
  labels.id = rownames(x$residuals),
  label.pos = c(4, 2),
  ext.xlim.f = 0.08,
  grid.length.f = 10,
  ask = prod(par("mfcol")) &lt; length(which) &amp;&amp; dev.interactive(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.asm_+3A_x">x</code></td>
<td>
<p>asm object</p>
</td></tr>
<tr><td><code id="plot.asm_+3A_which">which</code></td>
<td>
<p>a subset of the plots to be displayed</p>
</td></tr>
<tr><td><code id="plot.asm_+3A_caption">caption</code></td>
<td>
<p>a list of captions for the plots</p>
</td></tr>
<tr><td><code id="plot.asm_+3A_extend.ylim.f">extend.ylim.f</code></td>
<td>
<p>factor to extend the y-axis limits
for the residuals vs fitted plot</p>
</td></tr>
<tr><td><code id="plot.asm_+3A_id.n">id.n</code></td>
<td>
<p>number of residuals to label in the residuals vs fitted plot</p>
</td></tr>
<tr><td><code id="plot.asm_+3A_labels.id">labels.id</code></td>
<td>
<p>labels for the residuals in the residuals vs fitted plot</p>
</td></tr>
<tr><td><code id="plot.asm_+3A_label.pos">label.pos</code></td>
<td>
<p>position of the labels in the residuals vs fitted plot</p>
</td></tr>
<tr><td><code id="plot.asm_+3A_ext.xlim.f">ext.xlim.f</code></td>
<td>
<p>factor to extend the x-axis limits for the convex loss
and antitonic score function plots</p>
</td></tr>
<tr><td><code id="plot.asm_+3A_grid.length.f">grid.length.f</code></td>
<td>
<p>the number of grid points for the convex loss plot
is defined as grid.length.f * length(x$residuals)</p>
</td></tr>
<tr><td><code id="plot.asm_+3A_ask">ask</code></td>
<td>
<p>logical; if TRUE, the user is asked before each plot</p>
</td></tr>
<tr><td><code id="plot.asm_+3A_...">...</code></td>
<td>
<p>additional arguments to ensure compatibility with the generic function plot()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>model = asm(mpg ~ cyl + hp + disp, data=mtcars)
plot(model)

</code></pre>

<hr>
<h2 id='predict.asm'>Predict new responses using an <code>asm</code> regression model.</h2><span id='topic+predict.asm'></span>

<h3>Description</h3>

<p>Outputs predictions on new test data based on a fitted <code>asm</code> regression model. Also returns a confidence interval around
the conditional mean (if interval = &quot;confidence&quot;) or predicted response (if interval = &quot;prediction&quot;).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'asm'
predict(object, newdata = NULL, interval = "none", level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.asm_+3A_object">object</code></td>
<td>
<p>asm object</p>
</td></tr>
<tr><td><code id="predict.asm_+3A_newdata">newdata</code></td>
<td>
<p>new data frame</p>
</td></tr>
<tr><td><code id="predict.asm_+3A_interval">interval</code></td>
<td>
<p>type of interval calculation,
either &quot;none&quot;, &quot;confidence&quot; or &quot;prediction&quot;. Default is &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="predict.asm_+3A_level">level</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="predict.asm_+3A_...">...</code></td>
<td>
<p>additional arguments to ensure compatibility with the generic function predict()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of predicted values
* if interval = &quot;none&quot;, the matrix has one column of predicted values
* if interval = &quot;confidence&quot; or &quot;prediction&quot;, the matrix has three columns: predicted value, lower bound, and upper bound
</p>


<h3>Examples</h3>

<pre><code class='language-R'>model = asm(mpg ~ cyl + hp + disp, data=mtcars)
predict(model, newdata = data.frame(cyl = 4, hp = 121, disp = 80), interval = "prediction")

n &lt;- 1000
X &lt;- rnorm(n)
beta &lt;- 2
Y &lt;- beta*X + rt(n,df=3)
Mod &lt;- asm(Y ~ X)
predict(Mod, newdata = data.frame(X = 1), interval = "prediction")

</code></pre>

<hr>
<h2 id='print.asm'>Short description of a fitted <code>asm</code> regression model</h2><span id='topic+print.asm'></span>

<h3>Description</h3>

<p>Outputs estimated coefficients and standard errors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'asm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.asm_+3A_x">x</code></td>
<td>
<p>asm object</p>
</td></tr>
<tr><td><code id="print.asm_+3A_...">...</code></td>
<td>
<p>additional arguments to ensure compatibility with the generic function print()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for its side effect
</p>


<h3>Examples</h3>

<pre><code class='language-R'>model = asm(mpg ~ cyl + hp + disp, data=mtcars)
print(model)
</code></pre>

<hr>
<h2 id='print.summary.asm'>Print summary of the <code>asm</code> regression model</h2><span id='topic+print.summary.asm'></span>

<h3>Description</h3>

<p>Prints the summary of a fitted <code>asm</code> regression model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.asm'
print(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  concise = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.asm_+3A_x">x</code></td>
<td>
<p>summary.asm object</p>
</td></tr>
<tr><td><code id="print.summary.asm_+3A_digits">digits</code></td>
<td>
<p>number of digits to print</p>
</td></tr>
<tr><td><code id="print.summary.asm_+3A_signif.stars">signif.stars</code></td>
<td>
<p>logical; if TRUE, 'significance stars' are printed</p>
</td></tr>
<tr><td><code id="print.summary.asm_+3A_concise">concise</code></td>
<td>
<p>logical; if TRUE, the output is concise</p>
</td></tr>
<tr><td><code id="print.summary.asm_+3A_...">...</code></td>
<td>
<p>additional arguments to ensure compatibility with the generic function print()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>model = asm(mpg ~ cyl + hp + disp, data=mtcars)
print(summary(model))

</code></pre>

<hr>
<h2 id='residuals.asm'>Residuals from an <code>asm</code> regression model</h2><span id='topic+residuals.asm'></span>

<h3>Description</h3>

<p>Outputs the residuals (on the training data) from a fitted <code>asm</code> regression
model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'asm'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.asm_+3A_object">object</code></td>
<td>
<p>asm object</p>
</td></tr>
<tr><td><code id="residuals.asm_+3A_...">...</code></td>
<td>
<p>additional arguments to ensure compatibility with the generic function residuals()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of residuals from the <code>asm</code> regression model
</p>


<h3>Examples</h3>

<pre><code class='language-R'>model = asm(mpg ~ cyl + hp + disp, data=mtcars)
residuals(model)

</code></pre>

<hr>
<h2 id='summary.asm'>Summary of an <code>asm</code> regression model</h2><span id='topic+summary.asm'></span>

<h3>Description</h3>

<p>Outputs estimated coefficients, standard errors and p-values based on a fitted <code>asm</code> regression model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'asm'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.asm_+3A_object">object</code></td>
<td>
<p>asm object</p>
</td></tr>
<tr><td><code id="summary.asm_+3A_...">...</code></td>
<td>
<p>additional arguments to ensure compatibility with the generic function summary()</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.asm</code> class object containing the following components:
</p>

<dl>
<dt><code>coefficients</code>:</dt><dd><p>estimated coefficients, standard errors, z-values and p-values</p>
</dd>
<dt><code>residuals</code>:</dt><dd><p>residuals of the fitted model</p>
</dd>
<dt><code>call</code>:</dt><dd><p>call to the <code>asm</code> function</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>model = asm(mpg ~ cyl + hp + disp, data=mtcars)
summary(model)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
