<!DOCTYPE html><html><head><title>Help for package aweek</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {aweek}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as.aweek'><p>Convert characters or dates to aweek objects</p></a></li>
<li><a href='#as.data.frame.aweek'><p>Convert aweek objects to a data frame</p></a></li>
<li><a href='#as.Date.aweek'><p>Convert aweek objects to characters or dates</p></a></li>
<li><a href='#aweek-package'><p>Convert dates to weeks and back again</p></a></li>
<li><a href='#change_week_start'><p>Change the week start of an aweek object</p></a></li>
<li><a href='#date2week'><p>Convert date to a an arbitrary week definition</p></a></li>
<li><a href='#factor_aweek'><p>Coerce an aweek object to factor to include missing weeks</p></a></li>
<li><a href='#get_aweek'><p>Convert week numbers to dates or aweek objects</p></a></li>
<li><a href='#print.aweek'><p>The aweek class</p></a></li>
<li><a href='#set_week_start'><p>Get and set the global week_start variable</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Convert Dates to Arbitrary Week Definitions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Which day a week starts depends heavily on the either the local or
  professional context. This package is designed to be a lightweight solution
  to easily switching between week-based date definitions. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, stats, roxygen2, knitr, rmarkdown, covr, spelling</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.repidemicsconsortium.org/aweek/">https://www.repidemicsconsortium.org/aweek/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/reconhub/aweek/issues/">https://github.com/reconhub/aweek/issues/</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-06 02:40:19 UTC; zhian</td>
</tr>
<tr>
<td>Author:</td>
<td>Zhian N. Kamvar [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zhian N. Kamvar &lt;zkamvar@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-06 03:20:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='as.aweek'>Convert characters or dates to aweek objects</h2><span id='topic+as.aweek'></span><span id='topic+as.aweek.default'></span><span id='topic+as.aweek.NULL'></span><span id='topic+as.aweek.character'></span><span id='topic+as.aweek.factor'></span><span id='topic+as.aweek.Date'></span><span id='topic+as.aweek.POSIXt'></span><span id='topic+as.aweek.aweek'></span>

<h3>Description</h3>

<p>Convert characters or dates to aweek objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.aweek(x, week_start = get_week_start(), ...)

## Default S3 method:
as.aweek(x, week_start = NULL, ...)

## S3 method for class ''NULL''
as.aweek(x, week_start = NULL, ...)

## S3 method for class 'character'
as.aweek(x, week_start = get_week_start(), start = week_start, ...)

## S3 method for class 'factor'
as.aweek(x, week_start = get_week_start(), ...)

## S3 method for class 'Date'
as.aweek(x, week_start = get_week_start(), ...)

## S3 method for class 'POSIXt'
as.aweek(x, week_start = get_week_start(), ...)

## S3 method for class 'aweek'
as.aweek(x, week_start = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.aweek_+3A_x">x</code></td>
<td>
<p>a <a href="base.html#topic+Date">Date</a>, <a href="base.html#topic+POSIXct">POSIXct</a>, <a href="base.html#topic+POSIXlt">POSIXlt</a>, or a
correctly formatted (YYYY-Www-d) character string that represents the year,
week, and weekday.</p>
</td></tr>
<tr><td><code id="as.aweek_+3A_week_start">week_start</code></td>
<td>
<p>a number indicating the start of the week based on the ISO
8601 standard from 1 to 7 where 1 = Monday OR an abbreviation of the
weekdate in an English or current locale. <em>Note: using a non-English locale
may render your code non-portable.</em> Defaults to the value of
<code><a href="#topic+get_week_start">get_week_start()</a></code></p>
</td></tr>
<tr><td><code id="as.aweek_+3A_...">...</code></td>
<td>
<p>arguments passed on to <code><a href="#topic+date2week">date2week()</a></code> and <code><a href="base.html#topic+as.POSIXlt">as.POSIXlt()</a></code></p>
</td></tr>
<tr><td><code id="as.aweek_+3A_start">start</code></td>
<td>
<p>an integer (or character) vector of days that the weeks
start on for each corresponding week. Defaults to the value of
<code><a href="#topic+get_week_start">get_week_start()</a></code>. Note that these will not determine the final week.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>as.aweek()</code> will coerce character, dates, and datetime objects
to aweek objects. Dates are trivial to convert to weeks because there is
only one correct way to convert them with any given <code>week_start</code>.
</p>
<p>There is a bit of nuance to be aware of when converting
characters to aweek objects:
</p>

<ul>
<li><p> The characters must be correctly formatted as <code>YYYY-Www-d</code>, where YYYY
is the year relative to the week, Www is the week number (ww) prepended
by a W, and d (optional) is the day of the week from 1 to 7 where 1
represents the week_start. This means that characters formatted as
dates will be rejected.
</p>
</li>
<li><p> By default, the <code>week_start</code> and <code>start</code> parameters are identical. If
your data contains heterogeneous weeks (e.g. some dates will have the
week start on Monday and some will have the week start on Sunday), then
you should use the <code>start</code> parameter to reflect this. Internally, the
weeks will first be converted to dates with their respective starts and
then converted back to weeks, unified under the <code>week_start</code> parameter.
</p>
</li></ul>



<h3>Value</h3>

<p>an <a href="#topic+aweek-class">aweek</a> object
</p>


<h3>Note</h3>

<p>factors are first converted to characters before they are converted to
aweek objects.
</p>


<h3>See Also</h3>

<p><a href="#topic+aweek-class">&quot;aweek-class&quot;</a> for details on the aweek object,
<code><a href="#topic+get_aweek">get_aweek()</a></code> for converting numeric weeks to weeks or dates,
<code><a href="#topic+date2week">date2week()</a></code> for converting dates to weeks, <code><a href="#topic+week2date">week2date()</a></code> for converting
weeks to dates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# aweek objects can only be created from valid weeks:

as.aweek("2018-W10-5", week_start = 7) # works!
try(as.aweek("2018-10-5", week_start = 7)) # doesn't work :(

# you can also convert dates or datetimes
as.aweek(Sys.Date())
as.aweek(Sys.time())

# all functions get passed to date2week, so you can use any of its arguments:
as.aweek("2018-W10-5", week_start = 7, floor_day = TRUE, factor = TRUE) 
as.aweek(as.Date("2018-03-09"), floor_day = TRUE, factor = TRUE)

# If you have a character vector where different elements begin on different
# days of the week, you can use the "start" argument to ensure they are
# correctly converted.
as.aweek(c(mon = "2018-W10-1", tue = "2018-W10-1"), 
         week_start = "Monday", 
         start = c("Monday", "Tuesday"))

# you can convert aweek objects to aweek objects:
x &lt;- get_aweek()
as.aweek(x)
as.aweek(x, week_start = 7)
</code></pre>

<hr>
<h2 id='as.data.frame.aweek'>Convert aweek objects to a data frame</h2><span id='topic+as.data.frame.aweek'></span>

<h3>Description</h3>

<p>Convert aweek objects to a data frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aweek'
as.data.frame(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.data.frame.aweek_+3A_x">x</code></td>
<td>
<p>an aweek object</p>
</td></tr>
<tr><td><code id="as.data.frame.aweek_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame with an aweek column
</p>


<h3>See Also</h3>

<p><code><a href="#topic+date2week">date2week()</a></code> <code><a href="#topic+print.aweek">print.aweek()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
d  &lt;- as.Date("2019-03-25") + 0:6
w  &lt;- date2week(d, "Sunday")
dw &lt;- data.frame(date = d, week = w)
dw
dw$week
</code></pre>

<hr>
<h2 id='as.Date.aweek'>Convert aweek objects to characters or dates</h2><span id='topic+as.Date.aweek'></span><span id='topic+as.POSIXlt.aweek'></span><span id='topic+as.character.aweek'></span>

<h3>Description</h3>

<p>Convert aweek objects to characters or dates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aweek'
as.Date(x, floor_day = FALSE, ...)

## S3 method for class 'aweek'
as.POSIXlt(x, tz = "", floor_day = FALSE, ...)

## S3 method for class 'aweek'
as.character(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.Date.aweek_+3A_x">x</code></td>
<td>
<p>an object of class <a href="#topic+print.aweek">aweek</a>.</p>
</td></tr>
<tr><td><code id="as.Date.aweek_+3A_floor_day">floor_day</code></td>
<td>
<p>when <code>TRUE</code>, the days will be set to the start of the week.</p>
</td></tr>
<tr><td><code id="as.Date.aweek_+3A_...">...</code></td>
<td>
<p>parameters passed to <code>as.POSIXlt()</code>.</p>
</td></tr>
<tr><td><code id="as.Date.aweek_+3A_tz">tz</code></td>
<td>
<p>passed on to <code><a href="base.html#topic+as.POSIXlt">as.POSIXlt()</a></code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+date2week">date2week()</a></code> <code><a href="#topic+print.aweek">print.aweek()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>w &lt;- date2week(Sys.Date(), week_start = "Sunday")
w
# convert to POSIX
as.POSIXlt(w)
as.POSIXlt(w, floor_day = TRUE)
as.POSIXlt(w, floor_day = TRUE, tz = "KST")

# convert to date
as.Date(w)
as.Date(w, floor_day = TRUE)

# convert to character (strip attributes)
as.character(w)
</code></pre>

<hr>
<h2 id='aweek-package'>Convert dates to weeks and back again</h2><span id='topic+aweek'></span><span id='topic+aweek-package'></span>

<h3>Description</h3>

<p>The aweek package is a lightweight solution for converting dates to weeks
that can start on any weekday. It implements the <a href="#topic+aweek-class">aweek class</a>,
which can easily be converted to date and weeks that start on different days.
</p>


<h3>Before you begin</h3>

<p>When you work with aweek, you will want to make sure that you set the default
<code>week_start</code> variable to indicate which day of the week your weeks should
begin. This can be done with <code><a href="#topic+set_week_start">set_week_start()</a></code>. It will ensure that all of
your weeks will begin on the same day.
</p>

<ul>
<li> <p><code><a href="#topic+get_week_start">get_week_start()</a></code> returns the global week_start option
</p>
</li>
<li> <p><code><a href="#topic+set_week_start">set_week_start()</a></code> sets the global week_start option
</p>
</li></ul>



<h3>Conversions</h3>



<h4>Dates to weeks</h4>

<p>This conversion is the simplest because dates are unambiguous.
</p>

<ul>
<li> <p><code><a href="#topic+date2week">date2week()</a></code> converts dates, datetimes, and characters that look like dates to weeks
</p>
</li>
<li> <p><code><a href="#topic+as.aweek">as.aweek()</a></code> is a wrapper around <code><a href="#topic+date2week">date2week()</a></code> that converts dates and datetimes
</p>
</li></ul>




<h4>Week numbers to weeks or dates</h4>

<p>If you have separate columns for week numbers and years, then this is the
option for you. This allows you to specify a different start for each week
element using the <code>start</code> argument.
</p>

<ul>
<li> <p><code><a href="#topic+get_aweek">get_aweek()</a></code> converts week numbers (with years and days) to <a href="#topic+aweek-class">aweek objects</a>.
</p>
</li>
<li> <p><code><a href="#topic+get_date">get_date()</a></code> converts week numbers (with years and days) to <a href="base.html#topic+Date">Dates</a>.
</p>
</li></ul>




<h4>ISO week strings (YYYY-Www-d or YYYY-Www) to weeks or dates</h4>


<ul>
<li> <p><code><a href="#topic+as.aweek">as.aweek()</a></code> converts ISO-week formatted strings to <a href="#topic+aweek-class">aweek objects</a>.
</p>
</li>
<li> <p><code><a href="#topic+week2date">week2date()</a></code> converts ISO-week formatted strings to <a href="base.html#topic+Date">Date</a>.
</p>
</li></ul>




<h4>aweek objects to dates or datetimes</h4>

<p>This conversion is simple for <a href="#topic+aweek-class">aweek</a> objects since their
week_start is unambiguous
</p>

<ul>
<li> <p><a href="#topic+as.Date.aweek">as.Date()</a> converts to <a href="base.html#topic+Date">Date</a>.
</p>
</li>
<li> <p><a href="#topic+as.POSIXlt.aweek">as.POSIXlt()</a> converts to <a href="base.html#topic+POSIXlt">POSIXlt</a>.
</p>
</li></ul>




<h4>aweek objects to characters</h4>

<p>You can strip the week_start attribute of the aweek object by converting to
a character with <code><a href="base.html#topic+as.character">as.character()</a></code>
</p>



<h3>Manipulating aweek objects</h3>


<ul>
<li> <p><code><a href="base.html#topic+trunc">trunc()</a></code> removes the weekday element of the ISO week string.
</p>
</li>
<li> <p><code><a href="#topic+factor_aweek">factor_aweek()</a></code> does the same thing as trunc(), but will create a factor
with levels spanning all the weeks from the first week to the last week.
Useful for creating tables with zero counts for unobserved weeks.
</p>
</li>
<li> <p><code><a href="#topic+change_week_start">change_week_start()</a></code> will change the week_start attribute and adjust the
weeks accordingly so that the dates will always be consistent.
</p>
</li></ul>

<p>When you combine aweek objects, they must have the same week_start attribute.
Characters can be added to aweek objects as long as they are in ISO week
format and you can safely assume that they start on the same weekday. Dates
are trivial to add to aweek objects. See the <a href="#topic+aweek-class">aweek</a>
documentation for details.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Zhian N. Kamvar <a href="mailto:zkamvar@gmail.com">zkamvar@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://www.repidemicsconsortium.org/aweek/">https://www.repidemicsconsortium.org/aweek/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/reconhub/aweek/issues/">https://github.com/reconhub/aweek/issues/</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># At the beginning of your analysis, set the week start to the weeks you want
# to use for reporting
ow &lt;- set_week_start("Sunday")

# convert dates to weeks
d &lt;- as.Date(c("2014-02-11", "2014-03-04"))
w &lt;- as.aweek(d) 
w

# get the week numbers
date2week(d, numeric = TRUE)

# convert back to date
as.Date(w)

# convert to factor
factor_aweek(w)

# append a week
w[3] &lt;- as.Date("2014-10-31")
w 

# change week start variable (if needed)
change_week_start(w, "Monday")

# note that the date remains the same
as.Date(change_week_start(w, "Monday"))

# Don't forget to reset the week_start at the end
set_week_start(ow)
</code></pre>

<hr>
<h2 id='change_week_start'>Change the week start of an aweek object</h2><span id='topic+change_week_start'></span>

<h3>Description</h3>

<p>This will change the week_start attribute of an aweek object and adjust the
observations accordingly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>change_week_start(x, week_start = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="change_week_start_+3A_x">x</code></td>
<td>
<p>a <a href="base.html#topic+Date">Date</a>, <a href="base.html#topic+POSIXt">POSIXt</a>, <a href="base.html#topic+character">character</a>, or any data that can be easily
converted to a date with <code><a href="base.html#topic+as.POSIXlt">as.POSIXlt()</a></code>.</p>
</td></tr>
<tr><td><code id="change_week_start_+3A_week_start">week_start</code></td>
<td>
<p>a number indicating the start of the week based on the ISO
8601 standard from 1 to 7 where 1 = Monday OR an abbreviation of the
weekdate in an English or current locale. <em>Note: using a non-English locale
may render your code non-portable.</em> Unlike <code><a href="#topic+date2week">date2week()</a></code>, this defaults to
NULL, which will throw an error unless you supply a value.</p>
</td></tr>
<tr><td><code id="change_week_start_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="base.html#topic+as.POSIXlt">as.POSIXlt()</a></code>, unused in all other cases.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+get_week_start">get_week_start()</a></code> for accessing the global and local <code>week_start</code>
attribute, <code><a href="#topic+as.aweek">as.aweek()</a></code>, which wraps this function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># New Year's 2019 is the third day of the week starting on a Sunday
s &lt;- date2week(as.Date("2019-01-01"), week_start = "Sunday")
s 

# It's the second day of the week starting on a Monday
m &lt;- change_week_start(s, "Monday") 
m

# When you compare the underlying dates, they are exactly the same
identical(as.Date(s), as.Date(m))

# Since this will pass arguments to `date2week()`, you can modify other
# aspects of the aweek object this way, but this is not advised.

change_week_start(s, "Monday", floor_day = TRUE)
</code></pre>

<hr>
<h2 id='date2week'>Convert date to a an arbitrary week definition</h2><span id='topic+date2week'></span><span id='topic+week2date'></span>

<h3>Description</h3>

<p>Convert date to a an arbitrary week definition
</p>


<h3>Usage</h3>

<pre><code class='language-R'>date2week(
  x,
  week_start = get_week_start(),
  floor_day = factor,
  numeric = FALSE,
  factor = FALSE,
  ...
)

week2date(x, week_start = get_week_start(), floor_day = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="date2week_+3A_x">x</code></td>
<td>
<p>a <a href="base.html#topic+Date">Date</a>, <a href="base.html#topic+POSIXt">POSIXt</a>, <a href="base.html#topic+character">character</a>, or any data that can be easily
converted to a date with <code><a href="base.html#topic+as.POSIXlt">as.POSIXlt()</a></code>.</p>
</td></tr>
<tr><td><code id="date2week_+3A_week_start">week_start</code></td>
<td>
<p>a number indicating the start of the week based on the ISO
8601 standard from 1 to 7 where 1 = Monday OR an abbreviation of the
weekdate in an English or current locale. <em>Note: using a non-English locale
may render your code non-portable.</em> Defaults to the value of
<code><a href="#topic+get_week_start">get_week_start()</a></code></p>
</td></tr>
<tr><td><code id="date2week_+3A_floor_day">floor_day</code></td>
<td>
<p>when <code>TRUE</code>, the days will be set to the start of the week.</p>
</td></tr>
<tr><td><code id="date2week_+3A_numeric">numeric</code></td>
<td>
<p>if <code>TRUE</code>, only the numeric week be returned. If <code>FALSE</code>
(default), the date in the format &quot;YYYY-Www-d&quot; will be returned.</p>
</td></tr>
<tr><td><code id="date2week_+3A_factor">factor</code></td>
<td>
<p>if <code>TRUE</code>, a factor will be returned with levels spanning the
range of dates. This should only be used with <code>floor_day = TRUE</code> to
produce the sequence of weeks between the first and last date as the
factor levels.  Currently, <code>floor_date = FALSE</code> will still work, but will
produce a message indicating that it is deprecated. <em>Take caution when
using this with a large date range as the resulting factor can contain all
days between dates</em>.</p>
</td></tr>
<tr><td><code id="date2week_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="base.html#topic+as.POSIXlt">as.POSIXlt()</a></code>, unused in all other cases.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Weeks differ in their start dates depending on context. The ISO
8601 standard specifies that Monday starts the week
(<a href="https://en.wikipedia.org/wiki/ISO_week_date">https://en.wikipedia.org/wiki/ISO_week_date</a>) while the US CDC uses
Sunday as the start of the week
(<a href="https://stacks.cdc.gov/view/cdc/22305">https://stacks.cdc.gov/view/cdc/22305</a>). For
example, MSF has varying start dates depending on country in order to
better coordinate response.
</p>
<p>While there are packages that provide conversion for ISOweeks and epiweeks,
these do not provide seamless conversion from dates to epiweeks with
non-standard start dates. This package provides a lightweight utility to
be able to convert each day.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>date2week()</code> an <a href="#topic+aweek-class">aweek</a> object which represents dates in
<code>YYYY-Www-d</code> format where <code>YYYY</code> is the year (associated with the week,
not necessarily the day), <code>Www</code> is the week number prepended by a &quot;W&quot; that
ranges from 01-53 and <code>d</code> is the day of the week from 1 to 7 where 1
represents the first day of the week (as defined by the <code>week_start</code>
attribute).
</p>
</li>
<li> <p><code>week2date()</code> a <a href="base.html#topic+Date">Date</a> object.
</p>
</li></ul>



<h3>Note</h3>

<p><code>date2week()</code> will initially convert the input with <code><a href="base.html#topic+as.POSIXlt">as.POSIXlt()</a></code> and
use that to calculate the week. If the user supplies character input, it
is expected that the input will be of the format yyyy-mm-dd <em>unless</em> the
user explicitly passes the &quot;format&quot; parameter to <code><a href="base.html#topic+as.POSIXlt">as.POSIXlt()</a></code>. If the
input is not in yyyy-mm-dd and the format parameter is not passed,
<code>date2week()</code> will result in an error.
</p>


<h3>Author(s)</h3>

<p>Zhian N. Kamvar
</p>


<h3>See Also</h3>

<p><code><a href="#topic+set_week_start">set_week_start()</a></code>, <code><a href="#topic+as.Date.aweek">as.Date.aweek()</a></code>, <code><a href="#topic+print.aweek">print.aweek()</a></code>, <code><a href="#topic+as.aweek">as.aweek()</a></code>,
<code><a href="#topic+get_aweek">get_aweek()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dates to weeks -----------------------------------------------------------

# The same set of days will occur in different weeks depending on the start
# date. Here we can define a week before and after today

print(dat &lt;- as.Date("2018-12-31") + -6:7)

# By default, the weeks are defined as ISO weeks, which start on Monday
print(iso_dat &lt;- date2week(dat))

# This can be changed by setting the global default with set_week_start()

set_week_start("Sunday")

date2week(dat)

# If you want lubridate-style numeric-only weeks, you need look no further
# than the "numeric" argument
date2week(dat, numeric = TRUE)

# To aggregate weeks, you can use `floor_day = TRUE`
date2week(dat, floor_day = TRUE)

# If you want aggregations into factors that include missing weeks, use
# `floor_day = TRUE, factor = TRUE`:
date2week(dat[c(1, 14)], floor_day = TRUE, factor = TRUE)


## Weeks to dates -----------------------------------------------------------

# The aweek class can be converted back to a date with `as.Date()`
as.Date(iso_dat)

# If you don't have an aweek class, you can use week2date(). Note that the
# week_start variable is set by the "aweek.week_start" option, which we will
# set to Monday:

set_week_start("Monday")
week2date("2019-W01-1") # 2018-12-31

# This can be overidden by the week_start argument;
week2date("2019-W01-1", week_start = "Sunday") # 2018-12-30

# If you want to convert to the first day of the week, you can use the 
# `floor_day` argument
as.Date(iso_dat, floor_day = TRUE)

## The same two week timespan starting on different days --------------------
# ISO week definition: Monday -- 1
date2week(dat, 1)
date2week(dat, "Monday")

# Tuesday -- 2
date2week(dat, 2)
date2week(dat, "Tuesday")

# Wednesday -- 3
date2week(dat, 3)
date2week(dat, "W") # you can use valid abbreviations

# Thursday -- 4
date2week(dat, 4)
date2week(dat, "Thursday")

# Friday -- 5
date2week(dat, 5)
date2week(dat, "Friday")

# Saturday -- 6
date2week(dat, 6)
date2week(dat, "Saturday")

# Epiweek definition: Sunday -- 7 
date2week(dat, 7)
date2week(dat, "Sunday")
</code></pre>

<hr>
<h2 id='factor_aweek'>Coerce an aweek object to factor to include missing weeks</h2><span id='topic+factor_aweek'></span>

<h3>Description</h3>

<p>Coerce an aweek object to factor to include missing weeks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>factor_aweek(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="factor_aweek_+3A_x">x</code></td>
<td>
<p>an aweek object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an aweek object that inherits from <code><a href="base.html#topic+factor">factor()</a></code> with levels that span
the range of the weeks in the object.
</p>


<h3>Note</h3>

<p>when factored aweek objects are combined with other aweek objects, they
are converted back to characters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>w &lt;- get_aweek(week = (1:2) * 5, year = 2019, day = c(7, 1))
w
wf &lt;- factor_aweek(w)
wf

# factors are destroyed if combined with aweek objects
c(w, wf)
</code></pre>

<hr>
<h2 id='get_aweek'>Convert week numbers to dates or aweek objects</h2><span id='topic+get_aweek'></span><span id='topic+get_date'></span>

<h3>Description</h3>

<p>These are vectorized functions that take integer vectors and return Date or
an aweek objects, making it easier to convert bare weeks to dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_aweek(
  week = 1L,
  year = format(Sys.Date(), "%Y"),
  day = 1L,
  start = week_start,
  week_start = get_week_start(),
  ...
)

get_date(
  week = 1L,
  year = format(Sys.Date(), "%Y"),
  day = 1L,
  start = get_week_start()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_aweek_+3A_week">week</code></td>
<td>
<p>an integer vector, defaults to 1, representing the first week of the year.</p>
</td></tr>
<tr><td><code id="get_aweek_+3A_year">year</code></td>
<td>
<p>an integer vector, defaults to the current year</p>
</td></tr>
<tr><td><code id="get_aweek_+3A_day">day</code></td>
<td>
<p>an integer vector, defaults to 1, representing the first day of
the first week of the year.</p>
</td></tr>
<tr><td><code id="get_aweek_+3A_start">start</code></td>
<td>
<p>an integer (or character) vector of days that the weeks
start on for each corresponding week. Defaults to the value of
<code><a href="#topic+get_week_start">get_week_start()</a></code>. Note that these will not determine the final week.</p>
</td></tr>
<tr><td><code id="get_aweek_+3A_week_start">week_start</code></td>
<td>
<p>a number indicating the start of the week based on the ISO
8601 standard from 1 to 7 where 1 = Monday OR an abbreviation of the
weekdate in an English or current locale. <em>Note: using a non-English locale
may render your code non-portable.</em> Defaults to the value of
<code><a href="#topic+get_week_start">get_week_start()</a></code></p>
</td></tr>
<tr><td><code id="get_aweek_+3A_...">...</code></td>
<td>
<p>parameters passed on to <code><a href="#topic+date2week">date2week()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> get_aweek(): an aweek object
</p>
</li>
<li><p> get_date(): a Date object
</p>
</li></ul>



<h3>Note</h3>

<p>Any missing weeks, years, or start elements will result in a
missing element in the resulting vector. Any missing days will
revert to the first day of the week.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as.aweek">as.aweek()</a></code> <code><a href="#topic+date2week">date2week()</a></code> <code><a href="#topic+week2date">week2date()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# The default results in the first week of the year using the default
# default week_start (from get_week_start())

get_aweek()
get_date() # this is equivalent to as.Date(get_week()), but faster 

# Some years, like 2015, have 53 weeks

get_aweek(53, 2015)

# If you specify 53 weeks for a year that doesn't have 53 weeks, aweek will
# happily correct it for you

get_aweek(53, 2014) # this will be 2015-W01-1

# you can use this to quickly make a week without worrying about formatting
# here, you can define an observation interval of 20 weeks

obs_start &lt;- get_date(week = 10, year = 2018)
obs_end   &lt;- get_date(week = 29, year = 2018, day = 7)
c(obs_start, obs_end)

# If you have a data frame of weeks, you can use it to convert easily

mat &lt;- matrix(c(
  2019, 11, 1, 7, # 2019-03-10
  2019, 11, 2, 7,
  2019, 11, 3, 7,
  2019, 11, 4, 7,
  2019, 11, 5, 7,
  2019, 11, 6, 7,
  2019, 11, 7, 7
), ncol = 4, byrow = TRUE)

colnames(mat) &lt;- c("year", "week", "day", "start")
m &lt;- as.data.frame(mat)
m
sun &lt;- with(m, get_date(week, year, day, start))
sun
as.aweek(sun) # convert to aweek starting on the global week_start 
as.aweek(sun, week_start = "Sunday") # convert to aweek starting on Sunday

# You can also change starts
mon &lt;- with(m, get_aweek(week, year, day, "Monday", week_start = "Monday"))
mon
as.Date(mon)

# If you use multiple week starts, it will convert to date and then to
# the correct week, so it won't appear to match up with the original
# data frame.

sft &lt;- with(m, get_aweek(week, year, day, 7:1, week_start = "Sunday"))
sft
as.Date(sft)
</code></pre>

<hr>
<h2 id='print.aweek'>The aweek class</h2><span id='topic+print.aweek'></span><span id='topic+aweek-class'></span><span id='topic++5B.aweek'></span><span id='topic++5B+5B.aweek'></span><span id='topic++5B+3C-.aweek'></span><span id='topic+as.list.aweek'></span><span id='topic+trunc.aweek'></span><span id='topic+rep.aweek'></span><span id='topic+c.aweek'></span>

<h3>Description</h3>

<p>The aweek class is a character or factor in the format YYYY-Www(-d) with a
&quot;week_start&quot; attribute containing an integer specifying which day of the ISO
8601 week each week should begin.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aweek'
print(x, ...)

## S3 method for class 'aweek'
x[i]

## S3 method for class 'aweek'
x[[i]]

## S3 replacement method for class 'aweek'
x[i] &lt;- value

## S3 method for class 'aweek'
as.list(x, ...)

## S3 method for class 'aweek'
trunc(x, ...)

## S3 method for class 'aweek'
rep(x, ...)

## S3 method for class 'aweek'
c(..., recursive = FALSE, use.names = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.aweek_+3A_x">x</code></td>
<td>
<p>an object of class <code>aweek</code></p>
</td></tr>
<tr><td><code id="print.aweek_+3A_...">...</code></td>
<td>
<p>a series of <code>aweek</code> objects, characters, or Dates, (unused in <code>print.aweek()</code>)</p>
</td></tr>
<tr><td><code id="print.aweek_+3A_i">i</code></td>
<td>
<p>index for subsetting an aweek object.</p>
</td></tr>
<tr><td><code id="print.aweek_+3A_value">value</code></td>
<td>
<p>a value to add or replace in an aweek object</p>
</td></tr>
<tr><td><code id="print.aweek_+3A_recursive">recursive</code>, <code id="print.aweek_+3A_use.names">use.names</code></td>
<td>
<p>parameters passed on to <code><a href="base.html#topic+unlist">unlist()</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Weeks differ in their start dates depending on context. The ISO
8601 standard specifies that Monday starts the week
(<a href="https://en.wikipedia.org/wiki/ISO_week_date">https://en.wikipedia.org/wiki/ISO_week_date</a>) while the US CDC uses
Sunday as the start of the week
(<a href="https://stacks.cdc.gov/view/cdc/22305">https://stacks.cdc.gov/view/cdc/22305</a>). For
example, MSF has varying start dates depending on country in order to
better coordinate response.
</p>
<p>While there are packages that provide conversion for ISOweeks and epiweeks,
these do not provide seamless conversion from dates to epiweeks with
non-standard start dates. This package provides a lightweight utility to
be able to convert each day.
</p>


<h4>Calculation of week numbers</h4>

<p>Week numbers are calculated in three steps:
</p>

<ol>
<li><p> Find the day of the week, relative to the week_start (d). The day of the
week (d) relative to the week start (s) is calculated using the ISO week
day (i) via <code>d = 1L + ((i + (7L - s)) %% 7L)</code>.
</p>
</li>
<li><p> Find the date that represents midweek (m). The date that represents
midweek is found by subtracting the day of the week (d) from 4 and
adding that number of days to the current date: <code>m = date + (4 - d)</code>.
</p>
</li>
<li><p> Find the week number (w) by counting the number of days since 1 January
to (m), and use integer division by 7: <code>w = 1L + ((m - yyyy-01-01) %/% 7)</code>
</p>
</li></ol>

<p>For the weeks around 1 January, the year is determined by the week number.
If the month is January, but the week number is 52 or 53, then the year for
the week (YYYY) is the calendar year (yyyy) minus 1. However, if the month
is December, but the week number is 1, then the year for the week (YYYY) is
the calendar year (yyyy) plus 1.
</p>



<h4>Structure of the aweek object</h4>

<p>The aweek object is a character vector in either the precise ISO week
format (YYYY-Www-d) or imprecise ISO week format (YYYY-Www) with
a <code>week_start</code> attribute indicating which ISO week day the week begins.
The precise ISO week format can be broken down like this:
</p>

<ul>
<li> <p><strong>YYYY</strong> is an ISO week-numbering year, which is the year relative to
the week, not the day. For example, the date 2016-01-01 would be
represented as 2015-W53-5 (ISO week), because while the date is in the
year 2016, the week is still part of the final week of 2015.
</p>
</li>
<li><p> W<strong>ww</strong> is the week number, prefixed by the character &quot;W&quot;. This ranges
from 01 to 52 or 53, depending on whether or not the year has 52 or 53
weeks.
</p>
</li>
<li> <p><strong>d</strong> is a digit representing the weekday where 1 represents the first
day of the week and 7 represents the last day of the week. #'
The attribute <code>week_start</code> represents the first day of the week as an ISO
week day. This defaults to 1, which is Monday. If, for example, an aweek
object represented weeks starting on Friday, then the <code>week_start</code>
attribute would be 5, which is Friday of the ISO week.
</p>
</li></ul>

<p>Imprecise formats (YYYY-Www) are equivalent to the first day of the week.
For example, 2015-W53 and 2015-W53-1 will be identical when converted to
date.
</p>



<h3>Value</h3>

<p>an object of class <code>aweek</code>
</p>


<h3>Note</h3>

<p>when combining aweek objects together, you must ensure that they have
the same week_start attribute. You can use <code><a href="#topic+change_week_start">change_week_start()</a></code> to adjust
it.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+date2week">date2week()</a></code>, <code><a href="#topic+get_aweek">get_aweek()</a></code>, <code><a href="#topic+as.Date.aweek">as.Date.aweek()</a></code>, <code><a href="#topic+change_week_start">change_week_start()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- as.Date("2018-12-20") + 1:40
w &lt;- date2week(d, week_start = "Sunday")
print(w)

# subsetting acts as normal
w[1:10]

# Combining multiple aweek objects will only work if they have the same
# week_start day
c(w[1], w[3], w[5], as.aweek(as.Date("2018-12-01"), week_start = "Sunday"))

# differing week_start days will throw an error
mon &lt;- date2week(as.Date("2018-12-01"), week_start = "Monday")
mon
try(c(w, mon))

# combining Dates will be coerced to aweek objects under the same rules
c(w, Sys.Date())

# truncated aweek objects will be un-truncated
w2 &lt;- date2week(d[1:5], week_start = "Sunday", floor_day = TRUE)
w2
c(w[1:5], w2)
</code></pre>

<hr>
<h2 id='set_week_start'>Get and set the global week_start variable</h2><span id='topic+set_week_start'></span><span id='topic+get_week_start'></span>

<h3>Description</h3>

<p>This is a convenience wrapper around <code><a href="base.html#topic+options">options()</a></code> and <code><a href="base.html#topic+getOption">getOption()</a></code>, which
allows users to input both numeric and character week start values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_week_start(x = 1L)

get_week_start(w = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_week_start_+3A_x">x</code></td>
<td>
<p>a character or integer specifying the day of the week for conversion
between dates and weeks.</p>
</td></tr>
<tr><td><code id="set_week_start_+3A_w">w</code></td>
<td>
<p>if <code>NULL</code>, the global option &quot;aweek.week_start&quot; is returned. If <code>w</code>
is an aweek object, then the &quot;week_start&quot; attribute is returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>for <code>set_week_start</code>, the old value of <code>week_start</code> is returned,
invisibly. For <code>get_week_start</code>, the current value of <code>week_start</code> is
returned.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+change_week_start">change_week_start()</a></code> for changing the week_start attribute of an
aweek object, <code><a href="#topic+date2week">date2week()</a></code>, <code><a href="#topic+week2date">week2date()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# get the current definition of the week start
get_week_start() # defaults to Monday (1)
getOption("aweek.week_start", 1L) # identical to above

# set the week start
mon &lt;- set_week_start("Sunday") # set week start to Sunday (7)
get_week_start()
print(set_week_start(mon)) # reset the default
get_week_start()

# Get the week_start of a specific aweek object.
w &lt;- date2week("2019-05-04", week_start = "Sunday")
get_week_start(w)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
