<!DOCTYPE html><html><head><title>Help for package relliptical</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {relliptical}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mvtelliptical'><p>Mean and Variance for Truncated Multivariate Elliptical Distributions</p></a></li>
<li><a href='#rtelliptical'><p>Sampling Random Numbers from Truncated Multivariate Elliptical Distributions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>The Truncated Elliptical Family of Distributions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>It offers random numbers generation from members of the truncated multivariate elliptical family of distribution such as the truncated versions of the Normal, Student-t, Laplace, Pearson VII, Slash, Logistic, among others. Particular distributions can be provided by specifying the density generating function. It also computes the first two moments (covariance matrix as well) for some particular distributions.
  References used for this package: Galarza, C. E., Matos, L. A., Castro, L. M., and Lachos, V. H. (2022). Moments of the doubly truncated selection elliptical distributions with emphasis on the unified multivariate skew-t distribution. Journal of Multivariate Analysis, 189, 104944 &lt;<a href="https://doi.org/10.1016%2Fj.jmva.2021.104944">doi:10.1016/j.jmva.2021.104944</a>&gt;; Ho, H. J., Lin, T. I., Chen, H. Y., and Wang, W. L. (2012). Some results on the truncated multivariate t distribution. Journal of Statistical Planning and Inference, 142(1), 25-40 &lt;<a href="https://doi.org/10.1016%2Fj.jspi.2011.06.006">doi:10.1016/j.jspi.2011.06.006</a>&gt;; Valeriano, K. A., Galarza, C. E., and Matos, L. A. (2021). Moments and random number generation for the truncated elliptical family of distributions. Statistics and Computing, 33(1), 32 &lt;<a href="https://doi.org/10.1007%2Fs11222-022-10200-4">doi:10.1007/s11222-022-10200-4</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>FuzzyNumbers.Ext.2, matrixcalc, methods, Rcpp, Rdpack,
Ryacas0, stats</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>RcppArmadillo, Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggExtra, ggplot2, gridExtra</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-07 01:25:36 UTC; 55199</td>
</tr>
<tr>
<td>Author:</td>
<td>Katherine A. L. Valeriano
    <a href="https://orcid.org/0000-0001-6388-4753"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Larissa Avila Matos
    <a href="https://orcid.org/0000-0002-2635-0901"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Christian Galarza Morales
    <a href="https://orcid.org/0000-0002-4818-6006"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Katherine A. L. Valeriano &lt;katandreina@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-07 12:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='mvtelliptical'>Mean and Variance for Truncated Multivariate Elliptical Distributions</h2><span id='topic+mvtelliptical'></span>

<h3>Description</h3>

<p>This function approximates the mean vector and variance-covariance matrix for some specific truncated elliptical distributions.
The argument <code>dist</code> sets the distribution to be used and accepts the values <code>Normal</code>,
<code>t</code>, <code>Laplace</code>, <code>PE</code>, <code>PVII</code>, <code>Slash</code>, and <code>CN</code>, for the truncated Normal, Student-t, Power Exponential,
Pearson VII, Slash, and Contaminated Normal distribution, respectively. Moments are computed through Monte Carlo method for
the truncated variables and using properties of the conditional expectation for the non-truncated variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvtelliptical(lower, upper = rep(Inf, length(lower)), mu = rep(0,
  length(lower)), Sigma = diag(length(lower)), dist = "Normal",
  nu = NULL, n = 10000, burn.in = 0, thinning = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mvtelliptical_+3A_lower">lower</code></td>
<td>
<p>vector of lower truncation points of length <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code id="mvtelliptical_+3A_upper">upper</code></td>
<td>
<p>vector of upper truncation points of length <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code id="mvtelliptical_+3A_mu">mu</code></td>
<td>
<p>numeric vector of length <code class="reqn">p</code> representing the location parameter.</p>
</td></tr>
<tr><td><code id="mvtelliptical_+3A_sigma">Sigma</code></td>
<td>
<p>numeric positive definite matrix with dimension <code class="reqn">p</code>x<code class="reqn">p</code> representing the
scale parameter.</p>
</td></tr>
<tr><td><code id="mvtelliptical_+3A_dist">dist</code></td>
<td>
<p>represents the truncated distribution to be used. The values are <code>'Normal'</code>,
<code>'t'</code>, <code>'Laplace'</code>, <code>'PE'</code>, <code>'PVII'</code>, <code>'Slash'</code>, and <code>'CN'</code> for the truncated Normal, Student-t,
Laplace, Power Exponential, Pearson VII, Slash, and Contaminated Normal distributions, respectively.</p>
</td></tr>
<tr><td><code id="mvtelliptical_+3A_nu">nu</code></td>
<td>
<p>additional parameter or vector of parameters depending on the
density generating function. See Details.</p>
</td></tr>
<tr><td><code id="mvtelliptical_+3A_n">n</code></td>
<td>
<p>number of Monte Carlo samples to be generated.</p>
</td></tr>
<tr><td><code id="mvtelliptical_+3A_burn.in">burn.in</code></td>
<td>
<p>number of samples to be discarded as a burn-in phase.</p>
</td></tr>
<tr><td><code id="mvtelliptical_+3A_thinning">thinning</code></td>
<td>
<p>factor for reducing the autocorrelation of random points.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function also considers the univariate case. The argument <code>nu</code> is a parameter
or vector of parameters depending on the density generating function (DGF). For the truncated
Student-t, Power Exponential, and Slash distribution, <code>nu</code> is a positive number.
For the truncated Pearson VII, <code>nu</code> is a vector with the first element greater than <code class="reqn">p/2</code>
and the second element a positive number. For the truncated Contaminated Normal distribution, <code>nu</code>
is a vector of length 2 assuming values between 0 and 1.
</p>


<h3>Value</h3>

<p>It returns a list with three elements:
</p>
<table>
<tr><td><code>EY</code></td>
<td>
<p>the mean vector of length <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code>EYY</code></td>
<td>
<p>the second moment matrix of dimensions <code class="reqn">p</code>x<code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code>VarY</code></td>
<td>
<p>the variance-covariance matrix of dimensions <code class="reqn">p</code>x<code class="reqn">p</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The Normal distribution is a particular case of the Power Exponential distribution when <code>nu = 1</code>.
The Student-t distribution with <code class="reqn">\nu</code> degrees of freedom results from the Pearson VII
distribution when <code>nu = </code> ((<code class="reqn">\nu</code>+p)/2, <code class="reqn">\nu</code>).
</p>
<p>In the Student-t distribution, if <code>nu &gt;= 300</code>, the Normal case is considered.
For Student-t distribution, the algorithm also supports degrees of freedom <code>nu &lt;= 2</code>.
For Pearson VII distribution, the algorithm supports values of <code>m &lt;= (p+2)/2</code> (first element of <code>nu</code>).
</p>


<h3>Author(s)</h3>

<p>Katherine L. Valeriano, Christian E. Galarza and Larissa A. Matos
</p>


<h3>References</h3>


<p>Fang KT, Kotz S, Ng KW (2018).
<em>Symmetric multivariate and related distributions</em>.
Chapman and Hall/CRC.
</p>
<p>Galarza CE, Matos LA, Castro LM, Lachos VH (2022).
&ldquo;Moments of the doubly truncated selection elliptical distributions with emphasis on the unified multivariate skew-t distribution.&rdquo;
<em>Journal of Multivariate Analysis</em>, <b>189</b>, 104944.
<a href="https://doi.org/10.1016/j.jmva.2021.104944">doi:10.1016/j.jmva.2021.104944</a>.
</p>
<p>Valeriano KA, Galarza CE, Matos LA (2023).
&ldquo;Moments and random number generation for the truncated elliptical family of distributions.&rdquo;
<em>Statistics and Computing</em>, <b>33</b>(1), 32.

</p>


<h3>See Also</h3>

<p><code><a href="#topic+rtelliptical">rtelliptical</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Truncated Student-t distribution
set.seed(5678)
mu = c(0.1, 0.2, 0.3)
Sigma = matrix(data = c(1,0.2,0.3,0.2,1,0.4,0.3,0.4,1), nrow=length(mu),
               ncol=length(mu), byrow=TRUE)

# Example 1: one doubly truncated student-t (nu = 0.80) and Laplace
a = c(-0.8, -Inf, -Inf)
b = c(0.5, 0.6, Inf)
MC11 = mvtelliptical(a, b, mu, Sigma, "t", 0.80) # Student-t
MC12 = mvtelliptical(a, b, mu, Sigma, "Laplace") # Laplace

# Example 2: two doubly truncated student-t (nu = 0.80)
MC12 = mvtelliptical(a, b, mu, Sigma, "t", 0.80) # By default n=1e4

# Truncated Pearson VII distribution
set.seed(9876)
MC21 = mvtelliptical(a, b, mu, Sigma, "PVII", c(1.90,0.80), n=1e6) # More precision
c(MC12$EY); c(MC21$EY)
MC12$VarY;  MC21$VarY

# Truncated Normal distribution
set.seed(1234)
MC31 = mvtelliptical(a, b, mu, Sigma, "Normal", n=1e4)
MC32 = mvtelliptical(a, b, mu, Sigma, "Normal", n=1e6) # More precision
</code></pre>

<hr>
<h2 id='rtelliptical'>Sampling Random Numbers from Truncated Multivariate Elliptical Distributions</h2><span id='topic+rtelliptical'></span>

<h3>Description</h3>

<p>This function generates observations from a truncated multivariate elliptical distribution
with location parameter <code>mu</code>, scale matrix <code>Sigma</code>, lower and upper
truncation points <code>lower</code> and <code>upper</code> via Slice Sampling algorithm with Gibbs sampler steps.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtelliptical(n = 10000, mu = rep(0, length(lower)),
  Sigma = diag(length(lower)), lower, upper = rep(Inf, length(lower)),
  dist = "Normal", nu = NULL, expr = NULL, gFun = NULL,
  ginvFun = NULL, burn.in = 0, thinning = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtelliptical_+3A_n">n</code></td>
<td>
<p>number of observations to generate. Must be an integer &gt;= 1.</p>
</td></tr>
<tr><td><code id="rtelliptical_+3A_mu">mu</code></td>
<td>
<p>numeric vector of length <code class="reqn">p</code> representing the location parameter.</p>
</td></tr>
<tr><td><code id="rtelliptical_+3A_sigma">Sigma</code></td>
<td>
<p>numeric positive definite matrix with dimension <code class="reqn">p</code>x<code class="reqn">p</code> representing the
scale parameter.</p>
</td></tr>
<tr><td><code id="rtelliptical_+3A_lower">lower</code></td>
<td>
<p>vector of lower truncation points of length <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code id="rtelliptical_+3A_upper">upper</code></td>
<td>
<p>vector of upper truncation points of length <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code id="rtelliptical_+3A_dist">dist</code></td>
<td>
<p>represents the truncated distribution to be used. The values are <code>'Normal'</code>,
<code>'t'</code>, <code>'Laplace'</code>, <code>'PE'</code>, <code>'PVII'</code>, <code>'Slash'</code>, and <code>'CN'</code> for the truncated Normal, Student-t,
Laplace, Power Exponential, Pearson VII, Slash, and Contaminated Normal distribution, respectively.</p>
</td></tr>
<tr><td><code id="rtelliptical_+3A_nu">nu</code></td>
<td>
<p>additional parameter or vector of parameters depending on the
density generating function. See Details.</p>
</td></tr>
<tr><td><code id="rtelliptical_+3A_expr">expr</code></td>
<td>
<p>a character with the density generating function. See Details.</p>
</td></tr>
<tr><td><code id="rtelliptical_+3A_gfun">gFun</code></td>
<td>
<p>an R function with the density generating function. See Details.</p>
</td></tr>
<tr><td><code id="rtelliptical_+3A_ginvfun">ginvFun</code></td>
<td>
<p>an R function with the inverse of the density generating function defined in
<code>gFun</code>. See Details.</p>
</td></tr>
<tr><td><code id="rtelliptical_+3A_burn.in">burn.in</code></td>
<td>
<p>number of samples to be discarded as a burn-in phase.</p>
</td></tr>
<tr><td><code id="rtelliptical_+3A_thinning">thinning</code></td>
<td>
<p>factor for reducing the autocorrelation of random points.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>dist</code> argument represents the truncated distribution to be used. The values are
<code>Normal</code>, <code>t</code>, <code>'t'</code>, <code>PE</code>, <code>PVII</code>, <code>Slash</code>, and <code>CN</code>, for the
truncated Normal, Student-t, Laplace, Power Exponential, Pearson VII, Slash, and Contaminated Normal distribution,
respectively.
</p>
<p>The argument <code>nu</code> is a parameter or vector of parameters depending on the density generating
function (DGF). For the truncated Student-t, Power Exponential, and Slash distribution, <code>nu</code> is a
positive number. For the truncated Pearson VII, <code>nu</code> is a vector with the first element greater than
<code class="reqn">p/2</code> and the second element a positive number. For the truncated Contaminated Normal distribution,
<code>nu</code> is a vector of length 2 assuming values between 0 and 1.
</p>
<p>This function also allows generating random numbers from other truncated elliptical distributions not specified
in the <code>dist</code> argument, by supplying the density generating function (DGF) through arguments either
<code>expr</code> or <code>gFun</code>. The DGF must be a non-negative and strictly decreasing function on <code>(0, Inf)</code>.
The easiest way is to provide the DGF expression to argument <code>expr</code> as a character. The notation used in
<code>expr</code> needs to be understood by package <code>Ryacas0</code>, and the environment of <code>R</code>. For instance,
for the DGF <code class="reqn">g(t)=e^{-t}</code>, the user must provide <code>expr = "exp(1)^(-t)"</code>. See that the function must depend
only on variable <code class="reqn">t</code>, and any additional parameter must be passed as a fixed value. For this case, when a character
expression is provided to <code>expr</code>, the algorithm tries to compute a closed-form expression for the inverse function
of <code class="reqn">g(t)</code>, however, this is not always possible (a warning message is returned). See example 2.
</p>
<p>If it was no possible to generate random samples by passing a character expression to <code>expr</code>, the user may provide
a custom <code>R</code> function to the <code>gFun</code> argument. By default, its inverse function is approximated numerically,
however, the user may also provide its inverse to the <code>ginvFun</code> argument to gain some computational time.
When <code>gFun</code> is provided, arguments <code>dist</code> and <code>expr</code> are ignored.
</p>


<h3>Value</h3>

<p>It returns a matrix of dimensions <code class="reqn">n</code>x<code class="reqn">p</code> with the random points sampled.
</p>


<h3>Note</h3>

<p>The Normal distribution is a particular case of the Power Exponential distribution when <code>nu = 1</code>.
The Student-t distribution with <code class="reqn">\nu</code> degrees of freedom results from the Pearson VII
distribution when <code>nu = </code> ((<code class="reqn">\nu</code>+p)/2, <code class="reqn">\nu</code>).
</p>


<h3>Author(s)</h3>

<p>Katherine L. Valeriano, Christian E. Galarza and Larissa A. Matos
</p>


<h3>References</h3>


<p>Fang KT, Kotz S, Ng KW (2018).
<em>Symmetric multivariate and related distributions</em>.
Chapman and Hall/CRC.
</p>
<p>Ho HJ, Lin TI, Chen HY, Wang WL (2012).
&ldquo;Some results on the truncated multivariate t distribution.&rdquo;
<em>Journal of Statistical Planning and Inference</em>, <b>142</b>(1), 25&ndash;40.
<a href="https://doi.org/10.1016/j.jspi.2011.06.006">doi:10.1016/j.jspi.2011.06.006</a>.
</p>
<p>Neal RM (2003).
&ldquo;Slice sampling.&rdquo;
<em>Annals of statistics</em>, 705&ndash;741.
</p>
<p>Robert CP, Casella G (2010).
<em>Introducing Monte Carlo Methods with R</em>, volume 18.
New York: Springer.
</p>
<p>Valeriano KA, Galarza CE, Matos LA (2023).
&ldquo;Moments and random number generation for the truncated elliptical family of distributions.&rdquo;
<em>Statistics and Computing</em>, <b>33</b>(1), 32.

</p>


<h3>See Also</h3>

<p><code><a href="#topic+mvtelliptical">mvtelliptical</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
library(ggExtra)
library(gridExtra)

# Example 1: Sampling from the Truncated Normal distribution
set.seed(1234)
mu  = c(0, 1)
Sigma = matrix(c(1,0.70,0.70,3), 2, 2)
lower = c(-2, -3)
upper = c(3, 3)
sample1 = rtelliptical(5e4, mu, Sigma, lower, upper, dist="Normal")

# Histogram and density for variable 1
ggplot(data.frame(sample1), aes(x=X1)) +
   geom_histogram(aes(y=after_stat(density)), colour="black", fill="grey", bins=15) +
   geom_density(color="red") + labs(x=bquote(X[1]), y="Density") + theme_bw()

# Histogram and density for variable 2
ggplot(data.frame(sample1), aes(x=X2)) +
   geom_histogram(aes(y=after_stat(density)), colour="black", fill="grey", bins=15) +
   geom_density(color="red") + labs(x=bquote(X[2]), y="Density") + theme_bw()


# Example 2: Sampling from the Truncated Logistic distribution

# Function for plotting the sample autocorrelation using ggplot2
acf.plot = function(samples){
 p = ncol(samples); n = nrow(samples); q1 = qnorm(0.975)/sqrt(n); acf1 = list(p)
 for (i in 1:p){
   bacfdf = with(acf(samples[,i], plot=FALSE), data.frame(lag, acf))
   acf1[[i]] = ggplot(data=bacfdf, aes(x=lag,y=acf)) + geom_hline(aes(yintercept=0)) +
     geom_segment(aes(xend=lag, yend=0)) + labs(x="Lag", y="ACF", subtitle=bquote(X[.(i)])) +
     geom_hline(yintercept=c(q1,-q1), color="red", linetype="twodash") + theme_bw()
 }
 return (acf1)
}

set.seed(5678)
mu  = c(0, 0)
Sigma = matrix(c(1,0.70,0.70,1), 2, 2)
lower = c(-2, -2)
upper = c(3, 2)
# Sample autocorrelation with no thinning
sample2 = rtelliptical(10000, mu, Sigma, lower, upper, expr="exp(1)^(-t)/(1+exp(1)^(-t))^2")
grid.arrange(grobs=acf.plot(sample2), top="Logistic distribution with no thinning", nrow=1)

# Sample autocorrelation with thinning = 3
sample3 = rtelliptical(10000, mu, Sigma, lower, upper, expr="exp(1)^(-t)/(1+exp(1)^(-t))^2",
                       thinning=3)
grid.arrange(grobs=acf.plot(sample3), top="Logistic distribution with thinning = 3", nrow=1)


# Example 3: Sampling from the Truncated Kotz-type distribution
set.seed(5678)
mu  = c(0, 0)
Sigma = matrix(c(1,-0.5,-0.5,1), 2, 2)
lower = c(-2, -2)
upper = c(3, 2)
sample4 = rtelliptical(2000, mu, Sigma, lower, upper, gFun=function(t){t^(-1/2)*exp(-2*t^(1/4))})
f1 = ggplot(data.frame(sample4), aes(x=X1,y=X2)) + geom_point(size=0.50) +
     labs(x=expression(X[1]), y=expression(X[2]), subtitle="Kotz(2,1/4,1/2)") + theme_bw()
ggMarginal(f1, type="histogram", fill="grey")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
