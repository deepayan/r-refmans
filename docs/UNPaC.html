<!DOCTYPE html><html><head><title>Help for package UNPaC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {UNPaC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#UNPaC_Copula'><p>Unimodal Non-Parametric Cluster (UNPaC) Significance Test</p></a></li>
<li><a href='#UNPaC_num_clust'><p>Unimodal Non-Parametric Cluster (UNPaC) Test for Estimating Number of Clusters</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Non-Parametric Cluster Significance Testing with Reference to a
Unimodal Null Distribution</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-09</td>
</tr>
<tr>
<td>Author:</td>
<td>Erika S. Helgeson, David Vock, and Eric Bair</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Erika S. Helgeson &lt;helge@umn.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Assess the significance of identified clusters and estimates the true number of clusters by comparing the explained variation due to the clustering from the original data to that produced by clustering a unimodal reference distribution which preserves the covariance structure in the data. The reference distribution is generated using kernel density estimation and a Gaussian copula framework. A dimension reduction strategy and sparse covariance estimation optimize this method for the high-dimensional, low-sample size setting. This method is described in Helgeson, Vock, and Bair (2021) &lt;<a href="https://doi.org/10.1111%2Fbiom.13376">doi:10.1111/biom.13376</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>huge, PDSCE</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-09 22:42:41 UTC; eshel</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-09 23:00:15 UTC</td>
</tr>
</table>
<hr>
<h2 id='UNPaC_Copula'>Unimodal Non-Parametric Cluster (UNPaC) Significance Test</h2><span id='topic+UNPaC_Copula'></span>

<h3>Description</h3>

<p>The UnPAC test assesses the significance of clusters by comparing the cluster index (CI) from the data to the CI from a ortho-unimodal reference data generated using a Gaussian copula.
This method is described in Helgeson, Vock, and Bair (2021).
The CI is defined to be the sum of the
within-cluster sum of squares about the cluster means divided by the total sum of squares. Smaller values of the
CI indicate a stronger clustering.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UNPaC_Copula(
  x,
  cluster,
  cluster.fun,
  nsim = 100,
  var_selection = FALSE,
  gamma = 0.1,
  p.adjust = "fdr",
  k = 2,
  rho = 0.02,
  cov = "glasso",
  center = TRUE,
  scale = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UNPaC_Copula_+3A_x">x</code></td>
<td>
<p>a dataset with n observations (rows) and p features (columns)</p>
</td></tr>
<tr><td><code id="UNPaC_Copula_+3A_cluster">cluster</code></td>
<td>
<p>labels generated by clustering method</p>
</td></tr>
<tr><td><code id="UNPaC_Copula_+3A_cluster.fun">cluster.fun</code></td>
<td>
<p>function used to cluster data. Function should return list containing a component &quot;cluster.&quot;
Examples include <code><a href="stats.html#topic+kmeans">kmeans</a></code> and  <code><a href="cluster.html#topic+pam">pam</a></code>.</p>
</td></tr>
<tr><td><code id="UNPaC_Copula_+3A_nsim">nsim</code></td>
<td>
<p>a numeric value specifying the number of unimodal reference distributions used for testing
(default=100)</p>
</td></tr>
<tr><td><code id="UNPaC_Copula_+3A_var_selection">var_selection</code></td>
<td>
<p>should dimension be reduced using feature filtering procedure? See description below. (default=FALSE)</p>
</td></tr>
<tr><td><code id="UNPaC_Copula_+3A_gamma">gamma</code></td>
<td>
<p>threshold for feature filtering procedure. See description below. Not used if var_selection=FALSE (default=0.10)</p>
</td></tr>
<tr><td><code id="UNPaC_Copula_+3A_p.adjust">p.adjust</code></td>
<td>
<p>p-value adjustment method for additional feature filtering. See <code><a href="stats.html#topic+p.adjust">p.adjust</a></code>
for options. (default=&quot;fdr&quot;). Not used if p.adjust=&quot;none.&quot;</p>
</td></tr>
<tr><td><code id="UNPaC_Copula_+3A_k">k</code></td>
<td>
<p>integer value specifying the number of clusters to test (default=2)</p>
</td></tr>
<tr><td><code id="UNPaC_Copula_+3A_rho">rho</code></td>
<td>
<p>a regularization parameter used in implementation of the graphical lasso. See documentation for lambda in
<code><a href="huge.html#topic+huge">huge</a></code>.
Not used if <code>cov="est"</code> or <code>cov="banded"</code></p>
</td></tr>
<tr><td><code id="UNPaC_Copula_+3A_cov">cov</code></td>
<td>
<p>method used for approximating the covariance structure.  options include: &quot;glasso&quot;
(See <code><a href="huge.html#topic+huge">huge</a></code>), &quot;banded&quot;  (See <code><a href="PDSCE.html#topic+band.chol.cv">band.chol.cv</a></code>) and
&quot;est&quot; (default = &quot;glasso&quot;)</p>
</td></tr>
<tr><td><code id="UNPaC_Copula_+3A_center">center</code></td>
<td>
<p>should data be centered such that each feature has mean equal to zero prior to clustering
(default=TRUE)</p>
</td></tr>
<tr><td><code id="UNPaC_Copula_+3A_scale">scale</code></td>
<td>
<p>should data be scaled such that each feature has variance equal to one prior to clustering
(default=FALSE)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are three options for the covariance matrix used in generating the Gaussian
copula: sample covariance estimation, <code>cov="est"</code>, which should be used if n&gt;p; the graphical lasso,
<code>cov="glasso"</code>, which should be used if n&lt;p; and  k-banded covariance, <code>cov="banded"</code>, which can be used if n&lt;p and it can be assumed that
features farther away in the ordering have weaker covariance. The graphical lasso is implemented using the <code><a href="huge.html#topic+huge">huge</a></code> function.
When <code>cov="banded"</code> is selected the k-banded covariance Cholesky factor of Rothman, Levina, and Zhu (2010) is used to estimate the covariance matrix.
Cross-validation is used for selecting the banding parameter. See documentation in <code><a href="PDSCE.html#topic+band.chol.cv">band.chol.cv</a></code>.
</p>
<p>In high dimensional (n&lt;p) settings a dimension reduction step can be implemented which selects features
based on an F-test for difference in means across clusters. Features having a p-value less than a threshold
<code>gamma</code> are retained. For additional feature filtering a p-value adjustment procedure (such as p.adjust=&quot;fdr&quot;)
can be used. If no features are retained the resulting p-value for the cluster significance test is given as 1.
</p>


<h3>Value</h3>

<p>The function returns a list with the following components:
</p>

<ul>
<li><p><code>selected_features</code>: A vector of integers indicating the features retained by the feature filtering process.
</p>
</li>
<li><p><code>sim_CI</code>: vector containing the cluster indices for each generated unimodal reference distribution
</p>
</li>
<li><p><code>pvalue_emp</code>: the empirical p-value:  the proportion of times the cluster index from the reference
data is smaller the cluster index from the observed data
</p>
</li>
<li><p><code>pvalue_norm</code>: the normalized p-value: the simulated p-value based on comparison to a standard normal distribution 
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Erika S. Helgeson, David Vock, Eric Bair
</p>


<h3>References</h3>


<ul>
<li><p> Helgeson, ES, Vock, DM, and Bair, E. (2021) &ldquo;Nonparametric cluster significance testing with reference to a unimodal null distribution.&quot;
Biometrics 77: 1215– 1226. &lt; https://doi.org/10.1111/biom.13376 &gt;
</p>
</li>
<li><p> Rothman, A. J., Levina, E., and Zhu, J. (2010). &ldquo;A new approach to Cholesky-based covariance regularization in
high dimensions.&quot; Biometrika 97(3): 539-550.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># K-means example
test1 &lt;- matrix(rnorm(100*50), nrow=100, ncol=50)
test1[1:30,1:50] &lt;- rnorm(30*50, 2)
test.data&lt;-scale(test1,scale=FALSE,center=TRUE)
cluster&lt;-kmeans(test.data,2)$cluster
UNPaCResults &lt;- UNPaC_Copula(test.data,cluster,kmeans, nsim=100,cov="est")

# Hierarchical clustering example
 
test &lt;- matrix(nrow=1200, ncol=75)
theta &lt;- rep(NA, 1200)
theta[1:500] &lt;- runif(500, 0, pi)
theta[501:1200] &lt;- runif(700, pi, 2*pi)
test[1:500,seq(from=2,to=50,by=2)] &lt;- -2+5*sin(theta[1:500])
test[501:1200,seq(from=2,to=50,by=2)] &lt;- 5*sin(theta[501:1200])
test[1:500,seq(from=1,to=49,by=2)] &lt;- 5+5*cos(theta[1:500])
test[501:1200,seq(from=1,to=49,by=2)] &lt;- 5*cos(theta[501:1200])
test[,1:50] &lt;- test[,1:50] + rnorm(50*1200, 0, 0.2)
test[,51:75] &lt;- rnorm(25*1200, 0, 1)
test.data&lt;-scale(test,center=TRUE,scale=FALSE)
# Defining clustering function
hclustFunction&lt;-function(x,k){
 D&lt;-stats::dist(x)
 xn.hc &lt;- hclust(D, method="single")
 list(cluster=cutree(xn.hc, k))}

cluster=hclustFunction(test.data,2)$cluster
UNPaCResults &lt;- UNPaC_Copula(test.data,cluster,hclustFunction, nsim=100,cov="est")

</code></pre>

<hr>
<h2 id='UNPaC_num_clust'>Unimodal Non-Parametric Cluster (UNPaC) Test for Estimating Number of Clusters</h2><span id='topic+UNPaC_num_clust'></span>

<h3>Description</h3>

<p>UNPaC for estimating the number of clusters Compares the cluster index (CI) from the original data to that
produced by clustering a simulated ortho-unimodal reference distribution generated using a Gaussian copula.
The CI is defined to be the sum of the within-cluster sum of squares about the cluster means divided by the total sum of squares.
The number of clusters is chosen to maximize the difference between the data cluster index and the
reference cluster indices, but additional rules are also implemented (See below).  This method is described in Helgeson, Vock, and Bair (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UNPaC_num_clust(
  x,
  k = 10,
  cluster.fun,
  nsim = 1000,
  cov = "glasso",
  rho = 0.02,
  scale = FALSE,
  center = FALSE,
  var_selection = FALSE,
  p.adjust = "none",
  gamma = 0.1,
  d.power = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UNPaC_num_clust_+3A_x">x</code></td>
<td>
<p>a dataset with n observations (rows) and p features (columns)</p>
</td></tr>
<tr><td><code id="UNPaC_num_clust_+3A_k">k</code></td>
<td>
<p>maximum number of clusters considered. (default=10)</p>
</td></tr>
<tr><td><code id="UNPaC_num_clust_+3A_cluster.fun">cluster.fun</code></td>
<td>
<p>function used to cluster data. Function should return list containing a component &quot;cluster.&quot;
Examples include <code><a href="stats.html#topic+kmeans">kmeans</a></code> and  <code><a href="cluster.html#topic+pam">pam</a></code>.</p>
</td></tr>
<tr><td><code id="UNPaC_num_clust_+3A_nsim">nsim</code></td>
<td>
<p>a numeric value specifying the number of unimodal reference distributions used for testing (default=1000)</p>
</td></tr>
<tr><td><code id="UNPaC_num_clust_+3A_cov">cov</code></td>
<td>
<p>method used for approximating the covariance structure.  options include: &quot;glasso&quot;
(See <code><a href="huge.html#topic+huge">huge</a></code>), &quot;banded&quot;  (See <code><a href="PDSCE.html#topic+band.chol.cv">band.chol.cv</a></code>) and
&quot;est&quot; (default = &quot;glasso&quot;)</p>
</td></tr>
<tr><td><code id="UNPaC_num_clust_+3A_rho">rho</code></td>
<td>
<p>a regularization parameter used in implementation of the graphical lasso. See documentation for lambda in
<code><a href="huge.html#topic+huge">huge</a></code>.
Not used if <code>cov="est"</code> or <code>cov="banded"</code></p>
</td></tr>
<tr><td><code id="UNPaC_num_clust_+3A_scale">scale</code></td>
<td>
<p>should data be scaled such that each feature has variance equal to one prior to clustering
(default=FALSE)</p>
</td></tr>
<tr><td><code id="UNPaC_num_clust_+3A_center">center</code></td>
<td>
<p>should data be centered such that each feature has mean equal to zero prior to clustering
(default=TRUE)</p>
</td></tr>
<tr><td><code id="UNPaC_num_clust_+3A_var_selection">var_selection</code></td>
<td>
<p>should dimension be reduced using feature filtering procedure? See description below. (default=FALSE)</p>
</td></tr>
<tr><td><code id="UNPaC_num_clust_+3A_p.adjust">p.adjust</code></td>
<td>
<p>p-value adjustment method for additional feature filtering. See <code><a href="stats.html#topic+p.adjust">p.adjust</a></code>
for options. (default=&quot;fdr&quot;). Not used if p.adjust=&quot;none.&quot;</p>
</td></tr>
<tr><td><code id="UNPaC_num_clust_+3A_gamma">gamma</code></td>
<td>
<p>threshold for feature filtering procedure. See description below. Not used if var_selection=FALSE (default=0.10)</p>
</td></tr>
<tr><td><code id="UNPaC_num_clust_+3A_d.power">d.power</code></td>
<td>
<p>Power in estimating the low of the within cluster dispersion for comparison to the Gap statistic. See  <code><a href="cluster.html#topic+clusGap">clusGap</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are three options for the covariance matrix used in generating the Gaussian
copula: sample covariance estimation, <code>cov="est"</code>, which should be used if n&gt;p; the graphical lasso,
<code>cov="glasso"</code>, which should be used if n&lt;p; and  k-banded covariance, <code>cov="banded"</code>, which can be used if n&lt;p and it can be assumed that
features farther away in the ordering have weaker covariance. The graphical lasso is implemented using the <code><a href="huge.html#topic+huge">huge</a></code> function.
When <code>cov="banded"</code> is selected the k-banded covariance Cholesky factor of Rothman, Levina, and Zhu (2010) is used to estimate the covariance matrix.
Cross-validation is used for selecting the banding parameter. See documentation in <code><a href="PDSCE.html#topic+band.chol.cv">band.chol.cv</a></code>.
</p>
<p>In high dimensional (n&lt;p) settings a dimension reduction step can be implemented which selects features
based on an F-test for difference in means across clusters. Features having a p-value less than a threshold
<code>gamma</code> are retained. For additional feature filtering a p-value adjustment procedure (such as p.adjust=&quot;fdr&quot;)
can be used. If no features are retained the resulting p-value for the cluster significance test is given as 1.
</p>


<h3>Value</h3>

<p>The function returns a list with the following components:
</p>

<ul>
<li><p><code>BestK</code>: A matrix with 1 row and 4 columns named: &quot;Max_CI&quot;,&quot;Max_CI_wi_1SE&quot;,&quot;Max_scaled_CI&quot; and &quot;Max_logWCSS_wi_1SE&quot;.
These correspond to the number of clusters, K, chosen by four different rules. &quot;Max_CI choses K to maximize the difference in CI's between the true data and the
reference data. &quot;Max_CI_wi_1SE&quot; uses the &quot;1-SE&quot; criterion as in Tibshirani et al (2001), except for the CI.
&quot;Max_scaled_CI&quot; chooses K to maximize the difference in CIs from the observed and reference data scaled by the standard error of the reference data CIs.
&quot;Max_logWCSS_wi_1SE&quot; uses the Gap statistic and the &quot;1-SE&quot; criterion (Tibshirani et al, 2001) for choosing K.
</p>
</li>
<li><p><code>full_process</code>: A matrix containing the number of clusters, K, evaluated, the CI from the data, the average CI from the null
distribution, the difference between the data CI and average null CI, the standard error for the difference in CIs, the log of the within cluster dispersion from the data,
the average log of within cluster dispersion from the null data, The difference in within cluster dispersion (the Gap statistic), and the standard error for the Gap statistic.
</p>
</li>
<li><p><code>selected_features</code>: A vector of integers indicating the features retained by the feature filtering process.</p>
</li></ul>



<h3>Author(s)</h3>

<p>Erika S. Helgeson, David Vock, Eric Bair
</p>


<h3>References</h3>


<ul>
<li><p> Helgeson, ES, Vock, DM, and Bair, E. (2021) &ldquo;Nonparametric cluster significance testing with reference to a unimodal null distribution.&quot;
Biometrics 77: 1215– 1226. &lt; https://doi.org/10.1111/biom.13376 &gt;
</p>
</li>
<li><p> Tibshirani, R., Walther, G. and Hastie, T. (2001). Estimating the number of data clusters via the Gap statistic. Journal of the Royal Statistical Society B, 63, 411-423.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>	 test1 &lt;- matrix(rnorm(100*50), nrow=100, ncol=50)
  test1[1:30,1:50] &lt;- rnorm(30*50, 2)
  test.edit&lt;-scale(test1,center=TRUE,scale=FALSE)
  UNPaC_k&lt;-UNPaC_num_clust(test.edit,k=5,kmeans,nsim=100,cov="est")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
