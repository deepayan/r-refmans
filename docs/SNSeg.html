<!DOCTYPE html><html><head><title>Help for package SNSeg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SNSeg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#critical_values_HD'><p>Critical Values of Self-Normalization (SN) based test statistic for changes</p>
in high-dimensional means (SNHD)</a></li>
<li><a href='#critical_values_multi'><p>Critical Values of Self-Normalization (SN) based test statistic for changes</p>
in multiple parameters (SNCP)</a></li>
<li><a href='#critical_values_single'><p>Critical Values of Self-Normalization (SN) based test statistic for the</p>
change in a single parameter (SNCP)</a></li>
<li><a href='#MAR'><p>A funtion to generate a multivariate autoregressive process (MAR) in time</p>
series</a></li>
<li><a href='#MAR_MTS_Covariance'><p>A Funtion to generate a multivariate autoregressive process (MAR) model in</p>
time series. It is used for testing change-points based on the change in multivariate
means or multivariate covariance for multivariate time series. It also works
for the change in correlations between two univariate time series.</a></li>
<li><a href='#MAR_Variance'><p>A funtion to generate a multivariate autoregressive process (MAR) model in</p>
time series for testing change points based on variance and
autocovariance</a></li>
<li><a href='#max_SNsweep'><p>SN-based test statistic segmentation plot for univariate, mulitivariate</p>
and high-dimensional time series</a></li>
<li><a href='#plot.SNSeg_HD'><p>Plotting the output for high-dimensional time series with dimension greater</p>
than 10</a></li>
<li><a href='#plot.SNSeg_Multi'><p>Plotting the output for multivariate time series with dimension no greater</p>
than 10</a></li>
<li><a href='#plot.SNSeg_Uni'><p>Plotting the output for univariate or bivariate time series (testing</p>
the change in correlation between bivariate time series)</a></li>
<li><a href='#print.SNSeg_HD'><p>Print SN-based change-point estimates for high-dimensional time series with</p>
dimension greater than 10</a></li>
<li><a href='#print.SNSeg_Multi'><p>Print SN-based change-point estimates for multivariate time series with</p>
dimension no greater than 10</a></li>
<li><a href='#print.SNSeg_Uni'><p>Print SN-based change-point estimates for univariate or bivariate time</p>
series (testing the change in correlation between bivariate time series)</a></li>
<li><a href='#SNSeg'><p>SNSeg: An R Package for Time Series Segmentation via Self-Normalization (SN)</p></a></li>
<li><a href='#SNSeg_estimate'><p>Parameter estimates of each segment separated by Self-Normalization (SN) based</p>
change-point estimates</a></li>
<li><a href='#SNSeg_HD'><p>Self-normalization (SN) based change points estimation for high dimensional</p>
time series for changes in high-dimensional means (SNHD).</a></li>
<li><a href='#SNSeg_Multi'><p>Self-normalization (SN) based change points estimation for multivariate time</p>
series</a></li>
<li><a href='#SNSeg_Uni'><p>Self-normalization (SN) based change point estimates for univariate time</p>
series</a></li>
<li><a href='#summary.SNSeg_HD'><p>Summary of SN-based change-point estimates for high-dimensional time series</p>
with dimension greater than 10</a></li>
<li><a href='#summary.SNSeg_Multi'><p>Summary of SN-based change-point estimates for multivariate time series with</p>
dimension no greater than 10</a></li>
<li><a href='#summary.SNSeg_Uni'><p>Summary of SN-based change-point estimates for univariate or bivariate time</p>
series (testing the change in correlation between bivariate time series)</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Self-Normalization(SN) Based Change-Point Estimation for Time
Series</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementations self-normalization (SN) based algorithms for 
    change-points estimation in time series data. This comprises nested 
    local-window algorithms for detecting changes in both univariate and 
    multivariate time series developed in Zhao, Jiang and Shao (2022) 
    &lt;<a href="https://doi.org/10.1111%2Frssb.12552">doi:10.1111/rssb.12552</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), stats, utils, graphics</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, mvtnorm</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-02 14:42:16 UTC; sxs3935</td>
</tr>
<tr>
<td>Author:</td>
<td>Shubo Sun [aut],
  Zifeng Zhao [aut, cre],
  Feiyu Jiang [aut],
  Xiaofeng Shao [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zifeng Zhao &lt;zzhao2@nd.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-02 20:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='critical_values_HD'>Critical Values of Self-Normalization (SN) based test statistic for changes
in high-dimensional means (SNHD)</h2><span id='topic+critical_values_HD'></span>

<h3>Description</h3>

<p>A dataset containing the critical value of SN-based change point estimates
based on changes in high-dimensional means.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>critical_values_HD
</code></pre>


<h3>Format</h3>

<p>A data frame with 6 variables:
</p>

<dl>
<dt><code>epsilon</code></dt><dd><p>value used to compute grid_size_scale and SN-based
test statistic</p>
</dd>
<dt><code>0.9</code></dt><dd><p>critical value at confidence level <code>0.9</code></p>
</dd>
<dt><code>0.95</code></dt><dd><p>critical value at confidence level <code>0.95</code></p>
</dd>
<dt><code>0.99</code></dt><dd><p>critical value at confidence level <code>0.99</code></p>
</dd>
<dt><code>0.995</code></dt><dd><p>critical value at confidence level <code>0.995</code></p>
</dd>
<dt><code>0.999</code></dt><dd><p>critical value at confidence level <code>0.999</code></p>
</dd>
</dl>


<hr>
<h2 id='critical_values_multi'>Critical Values of Self-Normalization (SN) based test statistic for changes
in multiple parameters (SNCP)</h2><span id='topic+critical_values_multi'></span>

<h3>Description</h3>

<p>A dataset containing the critical value of SN-based change point estimates
based on simultaneous changes in multiple parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>critical_values_multi
</code></pre>


<h3>Format</h3>

<p>A data frame with 7 variables:
</p>

<dl>
<dt><code>epsilon</code></dt><dd><p>value used to compute grid_size_scale and SN-based
test statistic</p>
</dd>
<dt><code>p</code></dt><dd><p>dimension of the multi-parameters</p>
</dd>
<dt><code>0.9</code></dt><dd><p>critical value at confidence level <code>0.9</code></p>
</dd>
<dt><code>0.95</code></dt><dd><p>critical value at confidence level <code>0.95</code></p>
</dd>
<dt><code>0.99</code></dt><dd><p>critical value at confidence level <code>0.99</code></p>
</dd>
<dt><code>0.995</code></dt><dd><p>critical value at confidence level <code>0.995</code></p>
</dd>
<dt><code>0.999</code></dt><dd><p>critical value at confidence level <code>0.999</code></p>
</dd>
</dl>


<hr>
<h2 id='critical_values_single'>Critical Values of Self-Normalization (SN) based test statistic for the
change in a single parameter (SNCP)</h2><span id='topic+critical_values_single'></span>

<h3>Description</h3>

<p>A dataset containing the critical value for SN-based change point estimates
based on the change in a single parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>critical_values_single
</code></pre>


<h3>Format</h3>

<p>A data frame with 6 variables:
</p>

<dl>
<dt><code>epsilon</code></dt><dd><p>value used to compute grid_size_scale and SN-based
test statistic</p>
</dd>
<dt><code>0.9</code></dt><dd><p>critical value at confidence level <code>0.9</code></p>
</dd>
<dt><code>0.95</code></dt><dd><p>critical value at confidence level <code>0.95</code></p>
</dd>
<dt><code>0.99</code></dt><dd><p>critical value at confidence level <code>0.99</code></p>
</dd>
<dt><code>0.995</code></dt><dd><p>critical value at confidence level <code>0.995</code></p>
</dd>
<dt><code>0.999</code></dt><dd><p>critical value at confidence level <code>0.999</code></p>
</dd>
</dl>


<hr>
<h2 id='MAR'>A funtion to generate a multivariate autoregressive process (MAR) in time
series</h2><span id='topic+MAR'></span>

<h3>Description</h3>

<p>The function <code>MAR</code> is used for generating MAR model(s) for examples
of the functions <code>SNSeg_Uni</code>, <code>SNSeg_Multi</code>, and <code>SNSeg_HD</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MAR(n, reptime, rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MAR_+3A_n">n</code></td>
<td>
<p>the size (length) of time series to be generated</p>
</td></tr>
<tr><td><code id="MAR_+3A_reptime">reptime</code></td>
<td>
<p>the number of time series to be generated</p>
</td></tr>
<tr><td><code id="MAR_+3A_rho">rho</code></td>
<td>
<p>value of autocorrelation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a matrix of the simulated MAR processes. The number of columns
of this matrix is equivalent to the value of input argument <code>reptime</code>, and
the number of rows is the value of input argument <code>n</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>MAR(n = 1000, reptime = 2, rho = -0.7)

</code></pre>

<hr>
<h2 id='MAR_MTS_Covariance'>A Funtion to generate a multivariate autoregressive process (MAR) model in
time series. It is used for testing change-points based on the change in multivariate
means or multivariate covariance for multivariate time series. It also works
for the change in correlations between two univariate time series.</h2><span id='topic+MAR_MTS_Covariance'></span>

<h3>Description</h3>

<p>The function <code>MAR_MTS_Covariance</code> is used to generate MAR model(s) for
examples of the functions <code>SNSeg_Uni</code>, <code>SNSeg_Multi</code>, and <code>SNSeg_HD</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MAR_MTS_Covariance(n, reptime, rho_sets, cp_sets, sigma_cross)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MAR_MTS_Covariance_+3A_n">n</code></td>
<td>
<p>the size of time series to be generated.</p>
</td></tr>
<tr><td><code id="MAR_MTS_Covariance_+3A_reptime">reptime</code></td>
<td>
<p>the number of time series to be generated.</p>
</td></tr>
<tr><td><code id="MAR_MTS_Covariance_+3A_rho_sets">rho_sets</code></td>
<td>
<p>autocorrelations for each univariate time series.</p>
</td></tr>
<tr><td><code id="MAR_MTS_Covariance_+3A_cp_sets">cp_sets</code></td>
<td>
<p>numeric values of the true change-point locations (0, change-point
locations and the end point).</p>
</td></tr>
<tr><td><code id="MAR_MTS_Covariance_+3A_sigma_cross">sigma_cross</code></td>
<td>
<p>a list of matrices to generate the multivariate covariance
matrices.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of matrices where each matrix is a MAR process. The
number of columns for each sub-matrix is equivalent to the value of input
argument <code>reptime</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 1000
reptime &lt;- 2
sigma_cross &lt;- list(4*matrix(c(1,0.8,0.8,1), nrow=2),
                      matrix(c(1,0.2,0.2,1), nrow=2),
                      matrix(c(1,0.8,0.8,1), nrow=2))
cp_sets &lt;- round(c(0,n/3,2*n/3,n))
noCP &lt;- length(cp_sets)-2
rho_sets &lt;- rep(0.5, noCP+1)
MAR_MTS_Covariance(n, reptime, rho_sets, cp_sets, sigma_cross)

</code></pre>

<hr>
<h2 id='MAR_Variance'>A funtion to generate a multivariate autoregressive process (MAR) model in
time series for testing change points based on variance and
autocovariance</h2><span id='topic+MAR_Variance'></span>

<h3>Description</h3>

<p>The function <code>MAR_Variance</code> is used for generating MAR model(s) for
examples  of the functions <code>SNSeg_Uni</code>, <code>SNSeg_Multi</code>, and <code>SNSeg_HD</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MAR_Variance(reptime, type = "V3")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MAR_Variance_+3A_reptime">reptime</code></td>
<td>
<p>The number of time series to be generated</p>
</td></tr>
<tr><td><code id="MAR_Variance_+3A_type">type</code></td>
<td>
<p>The type of time series for simulation, which includes V1, V2, V3
, A1, A2 and A3. The V-beginnings are for testing the variance, and the
A-beginnings are for testing the autocorrelation. The simulated time series
come from supplement of Zhao et al. (2022) <a href="doi:10.1111/rssb.12552">doi:10.1111/rssb.12552</a>.
Default <code>type</code> is <code>V3</code>.
</p>
<p>The time length and &quot;true change-points locations&quot; (cps) for each <code>type</code> are as follows:
<code>V1</code>: cps at 400 and 750 with a time length of 1024.
<code>V2</code>: cps at 125, 532 and 704 with a time length of 1024.
<code>V3</code>: cps at 512 and 768 with a time length of 1024.
<code>A1</code>: cps at 400 and 750 with a time length of 1024.
<code>A2</code>: cps at 50 with a time length of 1024.
<code>A3</code>: cps at 512 and 768 with a time length of 1024.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a matrix of the simulated MAR processes. The number of columns
of this matrix is equivalent to the value of input argument <code>reptime</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>MAR_Variance(reptime = 2, type = "V1")

</code></pre>

<hr>
<h2 id='max_SNsweep'>SN-based test statistic segmentation plot for univariate, mulitivariate
and high-dimensional time series</h2><span id='topic+max_SNsweep'></span>

<h3>Description</h3>

<p>The function <code>max_SNsweep</code> allows users to compute and plot the SN-based
test statistics along with the identified change-points from functions
SNSeg_Uni, SNSeg_Multi, or SNSeg_HD.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>max_SNsweep(SN_result, plot_SN = TRUE, est_cp_loc = TRUE, critical_loc = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="max_SNsweep_+3A_sn_result">SN_result</code></td>
<td>
<p>The output of functions SNSeg_Uni, SNSeg_Multi or SNSeg_HD.</p>
</td></tr>
<tr><td><code id="max_SNsweep_+3A_plot_sn">plot_SN</code></td>
<td>
<p>A boolean value to return an SN-based segmentation plot if
plot_SN = TRUE.</p>
</td></tr>
<tr><td><code id="max_SNsweep_+3A_est_cp_loc">est_cp_loc</code></td>
<td>
<p>A boolean value to plot a red solid vertical line for
estimated change-point locations if est_cp_loc = TRUE.</p>
</td></tr>
<tr><td><code id="max_SNsweep_+3A_critical_loc">critical_loc</code></td>
<td>
<p>A boolean value to plot a blue dashed horizontal line for
the critical value if critical_loc = TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector of numeric values of calculated SN-based statistics
for each time point. It also generates a SN-based test statistics segmentation
plot with the estimated change-points.
</p>
<p>For more examples of <code>max_SNsweep</code> please see the SNSeg vignette:
<code>vignette("SNSeg", package = "SNSeg")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(7)
n &lt;- 2000
reptime &lt;- 2
cp_sets &lt;- round(n*c(0,cumsum(c(0.5,0.25)),1))
mean_shift &lt;- c(0.4,0,0.4)
rho &lt;- -0.7
ts &lt;- MAR(n, reptime, rho)
no_seg &lt;- length(cp_sets)-1
for(index in 1:no_seg){
  tau1 &lt;- cp_sets[index]+1
  tau2 &lt;- cp_sets[index+1]
  ts[tau1:tau2,] &lt;- ts[tau1:tau2,] + mean_shift[index]
}
ts &lt;- ts[,2]
result &lt;- SNSeg_Uni(ts, paras_to_test = "mean", confidence = 0.9,
                    grid_size_scale = 0.05, grid_size = 116,
                    plot_SN = FALSE, est_cp_loc = FALSE)

# Generate SN-based test statistic segmentation plot
# To get the computed SN-based statistics, please run the command "test_stat"
test_stat &lt;- max_SNsweep(result, plot_SN = TRUE, est_cp_loc = TRUE,
                         critical_loc = TRUE)

# For more examples of \code{max_SNsweep} see the help vignette:
# \code{vignette("SNSeg", package = "SNSeg")}


</code></pre>

<hr>
<h2 id='plot.SNSeg_HD'>Plotting the output for high-dimensional time series with dimension greater
than 10</h2><span id='topic+plot.SNSeg_HD'></span>

<h3>Description</h3>

<p>Plotting method for S3 objects of class <code>SNSeg_HD</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SNSeg_HD'
plot(x, cpts.col = "red", ts_index = c(1:5), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.SNSeg_HD_+3A_x">x</code></td>
<td>
<p>a <code>SNSeg_HD</code> object</p>
</td></tr>
<tr><td><code id="plot.SNSeg_HD_+3A_cpts.col">cpts.col</code></td>
<td>
<p>a specification for the color of the vertical lines at
the change point estimators, see <a href="graphics.html#topic+par">par</a></p>
</td></tr>
<tr><td><code id="plot.SNSeg_HD_+3A_ts_index">ts_index</code></td>
<td>
<p>The index number(s) of the univariate time series to be plotted.
Users should enter a positive integer or a vector of positive integers that are
no greater than the dimension of the input time series. The default is the
first 5 time series, i.e., <code>ts_index = c(1:5)</code>.</p>
</td></tr>
<tr><td><code id="plot.SNSeg_HD_+3A_...">...</code></td>
<td>
<p>additional graphical arguments, see <a href="graphics.html#topic+plot">plot</a>
and <a href="graphics.html#topic+abline">abline</a></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The location of each change point estimator is plotted as a vertical line
against the input time series.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n &lt;- 500
p &lt;- 50
nocp &lt;- 5
cp_sets &lt;- round(seq(0,nocp+1,1)/(nocp+1)*n)
num_entry &lt;- 5
kappa &lt;- sqrt(4/5)
mean_shift &lt;- rep(c(0,kappa),100)[1:(length(cp_sets)-1)]
set.seed(1)
ts &lt;- matrix(rnorm(n*p,0,1),n,p)
no_seg &lt;- length(cp_sets)-1
for(index in 1:no_seg){
  tau1 &lt;- cp_sets[index]+1
  tau2 &lt;- cp_sets[index+1]
  ts[tau1:tau2,1:num_entry] &lt;- ts[tau1:tau2,1:num_entry] +
    mean_shift[index]
}

# grid_size defined
result &lt;- SNSeg_HD(ts, confidence = 0.9, grid_size_scale  = 0.05,
                   grid_size = 40)
# plot the 1st, 3rd and 5th time series
plot(result, cpts.col = 'red', ts_index = c(1,3,5))


</code></pre>

<hr>
<h2 id='plot.SNSeg_Multi'>Plotting the output for multivariate time series with dimension no greater
than 10</h2><span id='topic+plot.SNSeg_Multi'></span>

<h3>Description</h3>

<p>Plotting method for S3 objects of class <code>SNSeg_Multi</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SNSeg_Multi'
plot(x, cpts.col = "red", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.SNSeg_Multi_+3A_x">x</code></td>
<td>
<p>a <code>SNSeg_Multi</code> object</p>
</td></tr>
<tr><td><code id="plot.SNSeg_Multi_+3A_cpts.col">cpts.col</code></td>
<td>
<p>a specification for the color of the vertical lines at
the change point estimators, see <a href="graphics.html#topic+par">par</a></p>
</td></tr>
<tr><td><code id="plot.SNSeg_Multi_+3A_...">...</code></td>
<td>
<p>additional graphical arguments, see <a href="graphics.html#topic+plot">plot</a>
and <a href="graphics.html#topic+abline">abline</a></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The location of each change point estimator is plotted as a vertical line
against the input time series.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Please run this function before simulation
exchange_cor_matrix &lt;- function(d, rho){
  tmp &lt;- matrix(rho, d, d)
  diag(tmp) &lt;- 1
  return(tmp)
}

# simulation of multivariate time series
library(mvtnorm)
set.seed(10)
d &lt;- 5
n &lt;- 600
nocp &lt;- 5
cp_sets &lt;- round(seq(0, nocp+1 ,1)/(nocp+1)*n)
mean_shift &lt;- rep(c(0,2),100)[1:(length(cp_sets)-1)]/sqrt(d)
rho_sets &lt;- 0.2
sigma_cross &lt;- list(exchange_cor_matrix(d,0))
ts &lt;- MAR_MTS_Covariance(n, 2, rho_sets, cp_sets = c(0,n), sigma_cross)
ts &lt;- ts[1][[1]]

# Test for the change in multivariate means
# grid_size defined
result &lt;- SNSeg_Multi(ts, paras_to_test = "mean", confidence = 0.99,
                      grid_size_scale = 0.05, grid_size = 45)
# plot method
plot(result)



</code></pre>

<hr>
<h2 id='plot.SNSeg_Uni'>Plotting the output for univariate or bivariate time series (testing
the change in correlation between bivariate time series)</h2><span id='topic+plot.SNSeg_Uni'></span>

<h3>Description</h3>

<p>Plotting method for S3 objects of class <code>SNSeg_Uni</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SNSeg_Uni'
plot(x, cpts.col = "red", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.SNSeg_Uni_+3A_x">x</code></td>
<td>
<p>a <code>SNSeg_Uni</code> object</p>
</td></tr>
<tr><td><code id="plot.SNSeg_Uni_+3A_cpts.col">cpts.col</code></td>
<td>
<p>a specification for the color of the vertical lines at
the change point estimators, see <a href="graphics.html#topic+par">par</a></p>
</td></tr>
<tr><td><code id="plot.SNSeg_Uni_+3A_...">...</code></td>
<td>
<p>additional graphical arguments, see <a href="graphics.html#topic+plot">plot</a>
and <a href="graphics.html#topic+abline">abline</a>. Users are allowed to enter their own title for
the univariate time series plot. The bivariate time series does not contain
this option.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The location of each change point estimator is plotted as a vertical line
against the input time series.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(7)
ts &lt;- MAR_Variance(2, "V1")
ts &lt;- ts[,2]
# test the change in a single parameter (variance)
# grid_size defined
result &lt;- SNSeg_Uni(ts, paras_to_test = "variance", confidence = 0.9,
                    grid_size_scale = 0.05, grid_size = 67,
                    plot_SN = FALSE, est_cp_loc = TRUE)
plot(result, cpts.col='red')


</code></pre>

<hr>
<h2 id='print.SNSeg_HD'>Print SN-based change-point estimates for high-dimensional time series with
dimension greater than 10</h2><span id='topic+print.SNSeg_HD'></span>

<h3>Description</h3>

<p>Print method for objects of class <code>SNSeg_HD</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SNSeg_HD'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.SNSeg_HD_+3A_x">x</code></td>
<td>
<p>a <code>SNSeg_HD</code> object</p>
</td></tr>
<tr><td><code id="print.SNSeg_HD_+3A_...">...</code></td>
<td>
<p>not in use</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
n &lt;- 500
p &lt;- 50
nocp &lt;- 5
cp_sets &lt;- round(seq(0,nocp+1,1)/(nocp+1)*n)
num_entry &lt;- 5
kappa &lt;- sqrt(4/5)
mean_shift &lt;- rep(c(0,kappa),100)[1:(length(cp_sets)-1)]
set.seed(1)
ts &lt;- matrix(rnorm(n*p,0,1),n,p)
no_seg &lt;- length(cp_sets)-1
for(index in 1:no_seg){
  tau1 &lt;- cp_sets[index]+1
  tau2 &lt;- cp_sets[index+1]
  ts[tau1:tau2,1:num_entry] &lt;- ts[tau1:tau2,1:num_entry] +
    mean_shift[index]
}

# grid_size defined
result &lt;- SNSeg_HD(ts, confidence = 0.9, grid_size_scale  = 0.05,
                   grid_size = 40)
# print method
print(result)


</code></pre>

<hr>
<h2 id='print.SNSeg_Multi'>Print SN-based change-point estimates for multivariate time series with
dimension no greater than 10</h2><span id='topic+print.SNSeg_Multi'></span>

<h3>Description</h3>

<p>Print method for objects of class <code>SNSeg_Multi</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SNSeg_Multi'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.SNSeg_Multi_+3A_x">x</code></td>
<td>
<p>a <code>SNSeg_Multi</code> object</p>
</td></tr>
<tr><td><code id="print.SNSeg_Multi_+3A_...">...</code></td>
<td>
<p>not in use</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# Please run this function before simulation
exchange_cor_matrix &lt;- function(d, rho){
  tmp &lt;- matrix(rho, d, d)
  diag(tmp) &lt;- 1
  return(tmp)
}

# simulation of multivariate time series
library(mvtnorm)
set.seed(10)
d &lt;- 5
n &lt;- 600
nocp &lt;- 5
cp_sets &lt;- round(seq(0, nocp+1 ,1)/(nocp+1)*n)
mean_shift &lt;- rep(c(0,2),100)[1:(length(cp_sets)-1)]/sqrt(d)
rho_sets &lt;- 0.2
sigma_cross &lt;- list(exchange_cor_matrix(d,0))
ts &lt;- MAR_MTS_Covariance(n, 2, rho_sets, cp_sets = c(0,n), sigma_cross)
ts &lt;- ts[1][[1]]

# Test for the change in multivariate means
# grid_size defined
result &lt;- SNSeg_Multi(ts, paras_to_test = "mean", confidence = 0.99,
                      grid_size_scale = 0.05, grid_size = 45)
# print method
print(result)


</code></pre>

<hr>
<h2 id='print.SNSeg_Uni'>Print SN-based change-point estimates for univariate or bivariate time
series (testing the change in correlation between bivariate time series)</h2><span id='topic+print.SNSeg_Uni'></span>

<h3>Description</h3>

<p>Print method for objects of class <code>SNSeg_Uni</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SNSeg_Uni'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.SNSeg_Uni_+3A_x">x</code></td>
<td>
<p>a <code>SNSeg_Uni</code> object</p>
</td></tr>
<tr><td><code id="print.SNSeg_Uni_+3A_...">...</code></td>
<td>
<p>not in use</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(7)
ts &lt;- MAR_Variance(2, "V1")
ts &lt;- ts[,2]
# test the change in a single parameter (variance)
# grid_size defined
result &lt;- SNSeg_Uni(ts, paras_to_test = "variance", confidence = 0.9,
                    grid_size_scale = 0.05, grid_size = 67,
                    plot_SN = FALSE, est_cp_loc = TRUE)
print(result)


</code></pre>

<hr>
<h2 id='SNSeg'>SNSeg: An R Package for Time Series Segmentation via Self-Normalization (SN)</h2><span id='topic+SNSeg'></span>

<h3>Description</h3>

<p>The SNSeg package provides three functions for multiple change point
estimation using SN-based algorithms: <code>SNSeg_Uni</code>, <code>SNSeg_Multi</code> and <code>SNSeg_HD</code>.
Three critical value tables (<code>critical_values_single</code>,
<code>critical_values_multi</code> and <code>critical_values_HD</code>) were attached.
Functions <code>MAR</code>, <code>MAR_Variance</code> and <code>MAR_MTS_Covariance</code> can be utilized
to generate time series data that are used for the functions <code>SNSeg_Uni</code>, <code>SNSeg_Multi</code> and <code>SNSeg_HD</code>.
S3 methods plot(), print() and summary() are available for class &quot;SNSeg_Uni&quot;,
&quot;SNSeg_Multi&quot; and &quot;SNSeh_HD&quot; objects. The function <code>max_SNsweep</code> enables users
to compute the SN test statistic and make the segmentation plot for these
statistics. The function <code>SNSeh_estimate</code> allows users to compute parameter
estimates of each segment that is separated by estimated change-points.
</p>


<h3>SNSeg_Uni</h3>

<p><code>SNSeg_Uni</code> provides SN-based change point estimates for a univariate
time series based on changes in a single parameter or multiple parameters.
</p>
<p>For the parameters of the SN test, the function
<code>SNSeg_Uni</code> offers mean, variance, acf, bivariate
correlation and numeric quantiles as available options. It also allows users
to enter their own defined function as the input parameter. Besides, users can
use a composite set of parameters including one or more from the mean, variance,
acf or numeric quantiles quantile. To visualize the estimated change points,
users can set &quot;plot_SN = TRUE&quot; and &quot;est_cp_loc = TRUE&quot;
to generate the time series segmentation plot. The output comprises of the
parameter(s), the window size, and the estimated change point locations. The
function returns an S3 object of class &quot;SNSeg_Uni&quot;, which can be applied to
S3 methods plot(), print() and summary().
</p>


<h3>SNSeg_Multi</h3>

<p><code>SNSeg_Multi</code> provides SN-based change point estimates for multivariate
time series based on changes in multivariate means or covariance matrix. The
&quot;plot_SN = TRUE&quot; option allows users to plot each individual time series and
the estimated change=points. The  function returns an S3 object of class
&quot;SNSeg_Multi&quot;, which can be applied to S3 methods plot(), print() and summary().
</p>


<h3>SNSeg_HD</h3>

<p><code>SNSeg_HD</code> provides SN-based change point estimates for a
high-dimensional time series based on changes in high-dimensional means. The
&quot;plot_SN = TRUE&quot; option allows users to plot each individual time series and
the estimated change=points. The input argument &quot;n_plot&quot; enables users to plot
the first &quot;n_plot&quot; number of time series. The function returns an S3 object of
class &quot;SNSeg_HD&quot;, which can be applied to S3 methods plot(), print() and
summary().
</p>


<h3>max_SNsweep</h3>

<p><code>max_SNsweep</code> provides SN based test statistic of each time point and
generates a plot for these statistics and the estimated change-points.
</p>


<h3>SNSeg_estimate</h3>

<p><code>SNSeg_estimate</code> computes the parameter estimates of each segment separated
by the estimated change-points.
</p>


<h3>critical values table</h3>

<p>The package <code>SNSeg</code> provides three critical values table.
</p>
<p>Table <code>critical_values_single</code> tabulates critical values of SN-based
change point estimates based on the change in a single parameter.
</p>
<p>Table <code>critical_values_multi</code> tabulates critical values of SN-based
change point estimates based on changes in multiple parameters.
</p>
<p>Table <code>critical_values_HD</code> tabulates critical values of of SN-based
change point estimates based on changes in high-dimensional means.
</p>

<hr>
<h2 id='SNSeg_estimate'>Parameter estimates of each segment separated by Self-Normalization (SN) based
change-point estimates</h2><span id='topic+SNSeg_estimate'></span>

<h3>Description</h3>

<p>The function <code>SNSeg_estimate</code> computes parameter estimates of each segment
that are separated by the SN-based change-point estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SNSeg_estimate(SN_result)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SNSeg_estimate_+3A_sn_result">SN_result</code></td>
<td>
<p>An S3 object served as the output of the functions <code>SNSeg_Uni</code>,
<code>SNSeg_Multi</code>, or <code>SNSeg_HD</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>SNSeg_estimate</code> returns an S3 object of class &quot;SNSeg_estimate&quot; including
the parameter estimates of each segment separated by the SN-based change-point
estimates.
</p>

<ol>
<li><p> If the time series is univariate, for a single parameter change, the output
contains parameter estimates for one of the followings: <code>mean</code>, <code>variance</code>,
<code>acf</code>, <code>quantile</code>, or <code>general</code>, which can be referred to the change
in a single mean, variance, autocorrelation, a given quantile level, or a general
functional. For multi-parameter changes, the output can be a combination of
<code>mean</code>, <code>variance</code>, <code>acf</code>, and a dataframe with each quantile level
depending on the type of parameters (argument <code>paras_to_test</code> of <code>SNSeg_Uni</code>,
<code>SNSeg_Multi</code>, or <code>SNSeg_HD</code>) that users select.
</p>
</li>
<li><p> If the time series is multivariate with a dimension no greater than 10, the output
contains parameter estimates for one of the followings: <code>bivcor</code>, <code>multi_mean</code>,
or <code>covariance</code>, which can be referred to the change in correlation between
bivariate time series and the change in multivariate means or covariance between
multivariate time series.
</p>
</li>
<li><p> If the time series is high-dimensional with a dimension greater than 10, the output
contains the parameter estimate <code>HD_mean</code> to represent the change in high-dimensional
means.
</p>
</li></ol>

<p>For more examples of <code>SNSeg_estimate</code> see the help vignette:
<code>vignette("SNSeg", package = "SNSeg")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# code to simulate a univariate time series
set.seed(7)
ts &lt;- MAR_Variance(2, "V1")
ts &lt;- ts[,2]
# test the change in a single parameter (variance)
# grid_size defined
result &lt;- SNSeg_Uni(ts, paras_to_test = "variance", confidence = 0.9,
                    grid_size_scale = 0.05, grid_size = 67,
                    plot_SN = TRUE, est_cp_loc = TRUE)
# estimated change-point locations
result$est_cp
# variance estimates of the separated segments
SNSeg_estimate(SN_result = result)

# For more examples of SNSeg_estimate, please run
# the command: vignette("SNSeg", package = "SNSeg")


</code></pre>

<hr>
<h2 id='SNSeg_HD'>Self-normalization (SN) based change points estimation for high dimensional
time series for changes in high-dimensional means (SNHD).</h2><span id='topic+SNSeg_HD'></span>

<h3>Description</h3>

<p>The function <code>SNSeg_HD</code> is a SNHD change point
estimation procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SNSeg_HD(
  ts,
  confidence = 0.9,
  grid_size_scale = 0.05,
  grid_size = NULL,
  plot_SN = FALSE,
  est_cp_loc = TRUE,
  ts_index = c(1:5)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SNSeg_HD_+3A_ts">ts</code></td>
<td>
<p>A high-dimensional time series represented as a matrix with p
columns, where each column is a univariate time series. The dimension p for
ts should be at least 10.</p>
</td></tr>
<tr><td><code id="SNSeg_HD_+3A_confidence">confidence</code></td>
<td>
<p>Confidence level of SN tests as a numeric value. Available
choices of confidence levels contain 0.9, 0.95, 0.99, 0.995 and 0.999. The
default is set to 0.9.</p>
</td></tr>
<tr><td><code id="SNSeg_HD_+3A_grid_size_scale">grid_size_scale</code></td>
<td>
<p>numeric value of the trimming parameter and only in
use if grid_size = NULL. Users are allowed to choose any grid_size_scale
between 0.05 and 0.5. A warning will be given if it is outside the
range.</p>
</td></tr>
<tr><td><code id="SNSeg_HD_+3A_grid_size">grid_size</code></td>
<td>
<p>Local window size h to compute the critical value for SN
test. Since grid_size = n*grid_size_scale, where n is the length of time
series, this function will compute the grid_size_scale by diving n from
grid_size when it is not NULL.</p>
</td></tr>
<tr><td><code id="SNSeg_HD_+3A_plot_sn">plot_SN</code></td>
<td>
<p>Boolean value to plot the time series or not.
The default setting is FALSE.</p>
</td></tr>
<tr><td><code id="SNSeg_HD_+3A_est_cp_loc">est_cp_loc</code></td>
<td>
<p>Boolean value to plot a red solid vertical line for
estimated change-point locations if est_cp_loc = TRUE.</p>
</td></tr>
<tr><td><code id="SNSeg_HD_+3A_ts_index">ts_index</code></td>
<td>
<p>The index number(s) of the univariate time series to be plotted.
Users should enter a positive integer or a vector of positive integers that are
no greater than the dimension of the input time series. The default is the
first 5 time series, i.e., <code>ts_index = c(1:5)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>SNSeg_HD returns an S3 object of class &quot;SNSeg_HD&quot; including the time
series, the local window size to cover a change point, the estimated change-point
locations, the confidence level and the critical value of the SN test. It also
generates time series segmentation plot when <code>plot_SN = TRUE</code>.
</p>

<dl>
<dt><code>ts</code></dt><dd><p>A numeric matrix of the input time series.</p>
</dd>
<dt><code>grid_size</code></dt><dd><p>A numeric value of the window size.</p>
</dd>
<dt><code>SN_sweep_result</code></dt><dd><p>A list of n matrices where each matrix
consists of four columns: (1) SN-based test statistic for each change-point
location (2) Change-point location  (3) Lower bound of the window h and
(4) Upper bound of the window h.</p>
</dd>
<dt><code>est_cp</code></dt><dd><p>A vector containing the locations of the estimated
change-points.</p>
</dd>
<dt><code>confidence</code></dt><dd><p>Confidence level of SN test as a numeric value.</p>
</dd>
<dt><code>critical_value</code></dt><dd><p>Critical value of the SN-based test statistic.</p>
</dd>
</dl>

<p>Users can apply the functions <code>summary.SN</code> to compute the parameter estimate
of each segment separated by the detected change-points. An additional function
<code>plot.SN</code> can be used to plot the time series with estimated change-points.
Users can set the option <code>plot_SN = TRUE</code> or use the function <code>plot.SN</code>
to plot the time series.
</p>
<p>It deserves to note that some change-points could be missing due to the constraint
on <code>grid_size_scale</code> or related <code>grid_size</code> that <code>grid_size_scale</code>
has a minimum value of 0.05. Therefore, SNCP claims no change-points within the
first n<em><code>grid_size_scale</code> or the last n</em><code>grid_size_scale</code> time points.
This is a limitation of the function <code>SNSeg_HD</code>.
</p>
<p>For more examples of <code>SNSeg_HD</code> see the help vignette:
<code>vignette("SNSeg", package = "SNSeg")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n &lt;- 500
p &lt;- 50
nocp &lt;- 5
cp_sets &lt;- round(seq(0,nocp+1,1)/(nocp+1)*n)
num_entry &lt;- 5
kappa &lt;- sqrt(4/5)
mean_shift &lt;- rep(c(0,kappa),100)[1:(length(cp_sets)-1)]
set.seed(1)
ts &lt;- matrix(rnorm(n*p,0,1),n,p)
no_seg &lt;- length(cp_sets)-1
for(index in 1:no_seg){
  tau1 &lt;- cp_sets[index]+1
  tau2 &lt;- cp_sets[index+1]
  ts[tau1:tau2,1:num_entry] &lt;- ts[tau1:tau2,1:num_entry] +
    mean_shift[index]
}

# grid_size defined
result &lt;- SNSeg_HD(ts, confidence = 0.9, grid_size_scale  = 0.05,
                   grid_size = 40)
# Estimated change-point locations
result$est_cp

# For more examples, please run the following command:
# vignette("SNSeg", package = "SNSeg")


</code></pre>

<hr>
<h2 id='SNSeg_Multi'>Self-normalization (SN) based change points estimation for multivariate time
series</h2><span id='topic+SNSeg_Multi'></span>

<h3>Description</h3>

<p>The function <code>SNSeg_Multi</code> is a SN-based change-points estimation
procedure for a multivariate time series based on changes in the multivariate
means or covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SNSeg_Multi(
  ts,
  paras_to_test = "mean",
  confidence = 0.9,
  grid_size_scale = 0.05,
  grid_size = NULL,
  plot_SN = FALSE,
  est_cp_loc = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SNSeg_Multi_+3A_ts">ts</code></td>
<td>
<p>A multivariate time series represented as a matrix with p columns,
where each column is a univariate time series. The dimension p for ts should
be at least 2.</p>
</td></tr>
<tr><td><code id="SNSeg_Multi_+3A_paras_to_test">paras_to_test</code></td>
<td>
<p>Type of the parameter as a string for which SN
algorithms test. Available choices include <code>mean</code> and <code>covariance</code>.</p>
</td></tr>
<tr><td><code id="SNSeg_Multi_+3A_confidence">confidence</code></td>
<td>
<p>Confidence level of SN tests as a numeric value. Available
choices of confidence levels contain 0.9, 0.95, 0.99, 0.995 and 0.999. The
default is set to 0.9.</p>
</td></tr>
<tr><td><code id="SNSeg_Multi_+3A_grid_size_scale">grid_size_scale</code></td>
<td>
<p>numeric value of the trimming parameter and only in
use if grid_size = NULL. Users are allowed to choose any grid_size_scale
between 0.05 and 0.5. A warning will be given if it is outside the
range.</p>
</td></tr>
<tr><td><code id="SNSeg_Multi_+3A_grid_size">grid_size</code></td>
<td>
<p>Local window size h to compute the critical value for SN
test. Since grid_size = n*grid_size_scale, where n is the length of time
series, this function will compute the grid_size_scale by diving n from
grid_size when it is not NULL.</p>
</td></tr>
<tr><td><code id="SNSeg_Multi_+3A_plot_sn">plot_SN</code></td>
<td>
<p>Boolean value to plot the time series or not.
The default setting is FALSE.</p>
</td></tr>
<tr><td><code id="SNSeg_Multi_+3A_est_cp_loc">est_cp_loc</code></td>
<td>
<p>Boolean value to plot a red solid vertical line for
estimated change-point locations if est_cp_loc = TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>SNSeg_Multi</code> returns an S3 object of class &quot;SNSeg_Multi&quot; including
the time series, the type of parameter to be tested, the local window size to
cover a change point, the estimated change-point locations, the confidence level
and the critical value of the SN test. It also generates time series segmentation
plot when <code>plot_SN = TRUE</code>.
</p>

<dl>
<dt><code>ts</code></dt><dd><p>A numeric matrix of the input time series.</p>
</dd>
<dt><code>paras_to_test</code></dt><dd><p>the parameter used for the SN test as character.</p>
</dd>
<dt><code>grid_size</code></dt><dd><p>A numeric value of the window size.</p>
</dd>
<dt><code>SN_sweep_result</code></dt><dd><p>A list of n matrices where each matrix
consists of four columns: (1) SN-based test statistic for each change-point
location (2) Change-point location  (3) Lower bound of the window h and
(4) Upper bound of the window h.</p>
</dd>
<dt><code>est_cp</code></dt><dd><p>A vector containing the locations of the estimated
change-points.</p>
</dd>
<dt><code>confidence</code></dt><dd><p>Confidence level of SN test as a numeric value.</p>
</dd>
<dt><code>critical_value</code></dt><dd><p>Critical value of the SN-based test statistic.</p>
</dd>
</dl>

<p>Users can apply the functions <code>summary.SN</code> to compute the parameter estimate
of each segment separated by the detected change-points. An additional function
<code>plot.SN</code> can be used to plot the time series with estimated change-points.
Users can set the option <code>plot_SN = TRUE</code> or use the function <code>plot.SN</code>
to plot the time series.
</p>
<p>It deserves to note that some change-points could be missing due to the constraint
on <code>grid_size_scale</code> or related <code>grid_size</code> that <code>grid_size_scale</code>
has a minimum value of 0.05. Therefore, SNCP claims no change-points within the
first n<em><code>grid_size_scale</code> or the last n</em><code>grid_size_scale</code> time points.
This is a limitation of the function <code>SNSeg_Multi</code>.
</p>
<p>For more examples of <code>SNSeg_Multi</code> see the help vignette:
<code>vignette("SNSeg", package = "SNSeg")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Please run this function before simulation
exchange_cor_matrix &lt;- function(d, rho){
  tmp &lt;- matrix(rho, d, d)
  diag(tmp) &lt;- 1
  return(tmp)
}

# simulation of multivariate time series
library(mvtnorm)
set.seed(10)
d &lt;- 5
n &lt;- 600
nocp &lt;- 5
cp_sets &lt;- round(seq(0, nocp+1 ,1)/(nocp+1)*n)
mean_shift &lt;- rep(c(0,2),100)[1:(length(cp_sets)-1)]/sqrt(d)
rho_sets &lt;- 0.2
sigma_cross &lt;- list(exchange_cor_matrix(d,0))
ts &lt;- MAR_MTS_Covariance(n, 2, rho_sets, cp_sets = c(0,n), sigma_cross)
ts &lt;- ts[1][[1]]

# Test for the change in multivariate means
# grid_size defined
result &lt;- SNSeg_Multi(ts, paras_to_test = "mean", confidence = 0.99,
                      grid_size_scale = 0.05, grid_size = 45)
# Estimated change-point locations
result$est_cp

# For more examples, please run the following command:
# vignette("SNSeg", package = "SNSeg")


</code></pre>

<hr>
<h2 id='SNSeg_Uni'>Self-normalization (SN) based change point estimates for univariate time
series</h2><span id='topic+SNSeg_Uni'></span>

<h3>Description</h3>

<p>The function <code>SNSeg_Uni</code> is a SN change point estimation procedure for a
univariate time series based on the change in a single or multiple parameters
. It also detect changes in correlation between two univariate time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SNSeg_Uni(
  ts,
  paras_to_test,
  confidence = 0.9,
  grid_size_scale = 0.05,
  grid_size = NULL,
  plot_SN = TRUE,
  est_cp_loc = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SNSeg_Uni_+3A_ts">ts</code></td>
<td>
<p>A univariate time series expressed as a numeric vector. when the
argument paras_to_test is specified as &quot;bivcor&quot;, the correlation between
bivariate time series, the input ts must be an n by 2 matrix</p>
</td></tr>
<tr><td><code id="SNSeg_Uni_+3A_paras_to_test">paras_to_test</code></td>
<td>
<p>The parameters that SN algorithm aim to examine, which
are presented as a string, a number, or a combination of both. Available
choices of paras_to_test include &quot;mean&quot;, &quot;variance&quot;, &quot;acf&quot;, &quot;bivcor&quot;
and a numeric value of quantile between 0 and 1. In the scenario where the
input ts is a univariate time series, users are allowed to enter a
combination of parameters for paras_to_test except &quot;bivcor&quot;.
</p>
<p>Users can also set up their own function as the input of &quot;paras_to_test&quot;. If so,
the user-fined function should use the univariate time series as the input and
return a numeric value as the output. Please see the help vignette for more details
by running <code>vignette("SNSeg", package = "SNSeg")</code>.</p>
</td></tr>
<tr><td><code id="SNSeg_Uni_+3A_confidence">confidence</code></td>
<td>
<p>Confidence level of SN tests as a numeric value. Available
choices of confidence levels contain 0.9, 0.95, 0.99, 0.995 and 0.999. The
default is set to 0.9.</p>
</td></tr>
<tr><td><code id="SNSeg_Uni_+3A_grid_size_scale">grid_size_scale</code></td>
<td>
<p>A numeric value of the trimming parameter and only in
use if grid_size = NULL. Users are allowed to choose any grid_size_scale
between 0.05 and 0.5. A warning will be given if it is outside the
range.</p>
</td></tr>
<tr><td><code id="SNSeg_Uni_+3A_grid_size">grid_size</code></td>
<td>
<p>Local window size h to compute the critical value for SN
test. Since grid_size = n*grid_size_scale, where n is the length of time
series, this function will compute the grid_size_scale by dividing n from
grid_size when it is not NULL.</p>
</td></tr>
<tr><td><code id="SNSeg_Uni_+3A_plot_sn">plot_SN</code></td>
<td>
<p>Boolean value to plot the time series or not.
The default setting is FALSE.</p>
</td></tr>
<tr><td><code id="SNSeg_Uni_+3A_est_cp_loc">est_cp_loc</code></td>
<td>
<p>Boolean value to plot a red solid vertical line for
estimated change-point locations if est_cp_loc = TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>SNSeg_Uni</code> returns an S3 object of class &quot;SNSeg_Uni&quot; including
the time series, the type of parameter to be tested, the local window size to
cover a change point, the estimated change-point locations, the confidence level
and the critical value of the SN test. It also generates a time series segmentation
plot when <code>plot_SN = TRUE</code>.
</p>

<dl>
<dt><code>ts</code></dt><dd><p>A numeric vector or two-dimensional matrix of the input
time series.</p>
</dd>
<dt><code>paras_to_test</code></dt><dd><p>A character, numeric value, a function or vector of the
parameter(s) used for the SN test. If it is a function defined by the user, please refer to
the section &quot;test in a general functional&quot; in the help vignette for more details on
how to write the function correctly.</p>
</dd>
<dt><code>grid_size</code></dt><dd><p>A numeric value of the window size.</p>
</dd>
<dt><code>SN_sweep_result</code></dt><dd><p>A list of matrices where each matrix
consists of four columns: (1) SN-based test statistic for each change-point
location (2) Change-point location  (3) Lower bound of the local window and
(4) Upper bound of the local window.</p>
</dd>
<dt><code>est_cp</code></dt><dd><p>A vector containing the locations of the estimated
change-points.</p>
</dd>
<dt><code>confidence</code></dt><dd><p>Confidence level of SN test as a numeric value.</p>
</dd>
<dt><code>critical_value</code></dt><dd><p>Critical value of the SN-based test statistic.</p>
</dd>
</dl>

<p>Users can apply the functions <code>summary.SN</code> to compute the parameter estimate
of each segment separated by the detected change-points. An additional function
<code>plot.SN</code> can be used to plot the time series with estimated change-points.
Users can set the option <code>plot_SN = TRUE</code> or use the function <code>plot.SN</code>
to plot the time series.
</p>
<p>It deserves to note that some change-points could be missing due to the constraint
on <code>grid_size_scale</code> or related <code>grid_size</code> that <code>grid_size_scale</code>
has a minimum value of 0.05. Therefore, SNCP claims no change-points within the
first n<em><code>grid_size_scale</code> or the last n</em><code>grid_size_scale</code> time points.
This is a limitation of the function <code>SNSeg_Uni</code>.
</p>
<p>For more examples of <code>SNSeg_Uni</code> see the help vignette:
<code>vignette("SNSeg", package = "SNSeg")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# code to simulate a univariate time series
set.seed(7)
ts &lt;- MAR_Variance(2, "V1")
ts &lt;- ts[,2]
# test the change in a single parameter (variance)
# grid_size defined
result &lt;- SNSeg_Uni(ts, paras_to_test = "variance", confidence = 0.9,
                    grid_size_scale = 0.05, grid_size = 67,
                    plot_SN = TRUE, est_cp_loc = TRUE)
# estimated change-point locations
result$est_cp
# For more examples of change in a single or multiple parameters, please run
# the command: vignette("SNSeg", package = "SNSeg")


</code></pre>

<hr>
<h2 id='summary.SNSeg_HD'>Summary of SN-based change-point estimates for high-dimensional time series
with dimension greater than 10</h2><span id='topic+summary.SNSeg_HD'></span>

<h3>Description</h3>

<p>Summary method for objects of class <code>SNSeg_HD</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SNSeg_HD'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.SNSeg_HD_+3A_object">object</code></td>
<td>
<p>a <code>SNSeg_HD</code> object</p>
</td></tr>
<tr><td><code id="summary.SNSeg_HD_+3A_...">...</code></td>
<td>
<p>not in use</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Provide information about estimated change-point locations, the
parameter tested by SN-based procedures, the confidence level, the <code>grid_size</code>,
and the critical value of the SN-based test.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n &lt;- 500
p &lt;- 50
nocp &lt;- 5
cp_sets &lt;- round(seq(0,nocp+1,1)/(nocp+1)*n)
num_entry &lt;- 5
kappa &lt;- sqrt(4/5)
mean_shift &lt;- rep(c(0,kappa),100)[1:(length(cp_sets)-1)]
set.seed(1)
ts &lt;- matrix(rnorm(n*p,0,1),n,p)
no_seg &lt;- length(cp_sets)-1
for(index in 1:no_seg){
  tau1 &lt;- cp_sets[index]+1
  tau2 &lt;- cp_sets[index+1]
  ts[tau1:tau2,1:num_entry] &lt;- ts[tau1:tau2,1:num_entry] +
    mean_shift[index]
}

# grid_size defined
result &lt;- SNSeg_HD(ts, confidence = 0.9, grid_size_scale  = 0.05,
                   grid_size = 40)
# summary method
summary(result)


</code></pre>

<hr>
<h2 id='summary.SNSeg_Multi'>Summary of SN-based change-point estimates for multivariate time series with
dimension no greater than 10</h2><span id='topic+summary.SNSeg_Multi'></span>

<h3>Description</h3>

<p>Summary method for objects of class <code>SNSeg_Multi</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SNSeg_Multi'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.SNSeg_Multi_+3A_object">object</code></td>
<td>
<p>a <code>SNSeg_Multi</code> object</p>
</td></tr>
<tr><td><code id="summary.SNSeg_Multi_+3A_...">...</code></td>
<td>
<p>not in use</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Provide information about estimated change-point locations, the
parameter tested by SN-based procedures, the confidence level, the <code>grid_size</code>,
and the critical value of the SN-based test.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Please run this function before simulation
exchange_cor_matrix &lt;- function(d, rho){
  tmp &lt;- matrix(rho, d, d)
  diag(tmp) &lt;- 1
  return(tmp)
}

# simulation of multivariate time series
library(mvtnorm)
set.seed(10)
d &lt;- 5
n &lt;- 600
nocp &lt;- 5
cp_sets &lt;- round(seq(0, nocp+1 ,1)/(nocp+1)*n)
mean_shift &lt;- rep(c(0,2),100)[1:(length(cp_sets)-1)]/sqrt(d)
rho_sets &lt;- 0.2
sigma_cross &lt;- list(exchange_cor_matrix(d,0))
ts &lt;- MAR_MTS_Covariance(n, 2, rho_sets, cp_sets = c(0,n), sigma_cross)
ts &lt;- ts[1][[1]]

# Test for the change in multivariate means
# grid_size defined
result &lt;- SNSeg_Multi(ts, paras_to_test = "mean", confidence = 0.99,
                      grid_size_scale = 0.05, grid_size = 45)
# summary method
summary(result)


</code></pre>

<hr>
<h2 id='summary.SNSeg_Uni'>Summary of SN-based change-point estimates for univariate or bivariate time
series (testing the change in correlation between bivariate time series)</h2><span id='topic+summary.SNSeg_Uni'></span>

<h3>Description</h3>

<p>Summary method for objects of class <code>SNSeg_Uni</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SNSeg_Uni'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.SNSeg_Uni_+3A_object">object</code></td>
<td>
<p>a <code>SNSeg_Uni</code> object</p>
</td></tr>
<tr><td><code id="summary.SNSeg_Uni_+3A_...">...</code></td>
<td>
<p>not in use</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Provide information about estimated change-point locations, the
parameter tested by SN-based procedures, the confidence level, the <code>grid_size</code>,
and the critical value of the SN-based test.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(7)
ts &lt;- MAR_Variance(2, "V1")
ts &lt;- ts[,2]
# test the change in a single parameter (variance)
# grid_size defined
result &lt;- SNSeg_Uni(ts, paras_to_test = "variance", confidence = 0.9,
                    grid_size_scale = 0.05, grid_size = 67,
                    plot_SN = FALSE, est_cp_loc = TRUE)
summary(result)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
