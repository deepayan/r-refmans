<!DOCTYPE html><html><head><title>Help for package combinIT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {combinIT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Boik_test'><p>Boik's (1993) Locally Best Invariant (LBI) Test</p></a></li>
<li><a href='#CI_test'><p>Combined Interaction Test</p></a></li>
<li><a href='#CNV'><p>Copy number variation (CNV).</p></a></li>
<li><a href='#Franck_test'><p>Franck's (2013) et al. test for Interaction</p></a></li>
<li><a href='#IDCP'><p>Impurity data in a chemical product (IDCP).</p></a></li>
<li><a href='#interaction_plot'><p>Interaction Plot</p></a></li>
<li><a href='#KKM_test'><p>Kharrati-Kopaei and Miller's (2016) Test for Interaction</p></a></li>
<li><a href='#KKSA_test'><p>Kharrati-Kopaei and Sadooghi-Alvandi's (2007) test for interaction</p></a></li>
<li><a href='#Malik_test'><p>Malik's (2016) et al. Test for Interaction</p></a></li>
<li><a href='#MVGH'><p>The mean values of growth hormone (MVGH).</p></a></li>
<li><a href='#Piepho_test'><p>Piepho's (1994) Test for Interaction</p></a></li>
<li><a href='#RDWW'><p>Ratio of dry to wet wheat (RDWW).</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Combined Interaction Test for Unreplicated Two-Way Tables</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hossein Haghbin &lt;haghbin@pgu.ac.ir&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>There are several non-functional-form-based interaction tests for testing interaction in unreplicated two-way layouts. However, no single test can detect all patterns of possible interaction and the tests are sensitive to a particular pattern of interaction. This package combines six non-functional-form-based interaction tests for testing additivity. These six tests were proposed by Boik (1993) &lt;<a href="https://doi.org/10.1080%2F02664769300000004">doi:10.1080/02664769300000004</a>&gt;, Piepho (1994), Kharrati-Kopaei and Sadooghi-Alvandi (2007) &lt;<a href="https://doi.org/10.1080%2F03610920701386851">doi:10.1080/03610920701386851</a>&gt;, Franck et al. (2013) &lt;<a href="https://doi.org/10.1016%2Fj.csda.2013.05.002">doi:10.1016/j.csda.2013.05.002</a>&gt;, Malik et al. (2016) &lt;<a href="https://doi.org/10.1080%2F03610918.2013.870196">doi:10.1080/03610918.2013.870196</a>&gt; and Kharrati-Kopaei and Miller (2016) &lt;<a href="https://doi.org/10.1080%2F00949655.2015.1057821">doi:10.1080/00949655.2015.1057821</a>&gt;. The p-values of these six tests are combined by Bonferroni, Sidak, Jacobi polynomial expansion, and the Gaussian copula methods to provide researchers with a testing approach which leverages many existing methods to detect disparate forms of non-additivity. This package is based on the following published paper: Shenavari and Kharrati-Kopaei (2018) "A Method for Testing Additivity in Unreplicated Two-Way Layouts Based on Combining Multiple Interaction Tests". In addition, several sentences in help files or descriptions were copied from that paper.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/haghbinh/combinIT">https://github.com/haghbinh/combinIT</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/haghbinh/combinIT/issues">https://github.com/haghbinh/combinIT/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp,mvtnorm</td>
</tr>
<tr>
<td>Suggests:</td>
<td>MASS, Matrix, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0),</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-21 04:37:25 UTC; Hossein</td>
</tr>
<tr>
<td>Author:</td>
<td>Zahra Shenavari [aut],
  Hossein Haghbin <a href="https://orcid.org/0000-0001-8416-2354"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Mahmood Kharrati-Kopaei
    <a href="https://orcid.org/0000-0001-5555-253X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Seyed Morteza Najibi [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-21 07:35:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='Boik_test'>Boik's (1993) Locally Best Invariant (LBI) Test</h2><span id='topic+Boik_test'></span>

<h3>Description</h3>

<p>This function calculates the LBI test statistic for testing the null hypothesis <code class="reqn">H_0:</code> There is no interaction.
It returns an exact p-value when <code class="reqn">p=2</code> where <code class="reqn">p=min\{a-1,b-1\}</code>. It returns an exact Monte Carlo p-value when <code class="reqn">p&gt;2</code>. It also provides an asymptotic chi-squared p-value. Note that the p-value of the Boik.test is always one when <code class="reqn">p=1</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Boik_test(x, nsim = 10000, alpha = 0.05, report = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Boik_test_+3A_x">x</code></td>
<td>
<p>a numeric matrix, <code class="reqn">a \times b</code> data matrix where the number of row and column is corresponding to the number of factor levels.</p>
</td></tr>
<tr><td><code id="Boik_test_+3A_nsim">nsim</code></td>
<td>
<p>a numeric value, the number of Monte Carlo samples for calculating an exact Monte Carlo p-value. The default value is 10000.</p>
</td></tr>
<tr><td><code id="Boik_test_+3A_alpha">alpha</code></td>
<td>
<p>a numeric value, the level of the test. The default value is 0.05.</p>
</td></tr>
<tr><td><code id="Boik_test_+3A_report">report</code></td>
<td>
<p>logical: if <code>TRUE</code> the result of the test is reported at the <code>alpha</code> level.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The LBI test statistic is <code class="reqn">T_{B93}=(tr(R'R))^2/(p tr((R'R)^2))</code> where <code class="reqn">p=min\{a-1,b-1\}</code> and <code class="reqn">R</code> is the residual
matrix of the input data matrix, <code class="reqn">x</code>, under the null hypothesis <code class="reqn">H_0:</code> There is no interaction. This test rejects the null hypothesis of no interaction when <code class="reqn">T_{B93}</code> is small.
Boik (1993) provided the exact distribution of <code class="reqn">T_{B93}</code> when <code class="reqn">p=2</code> under <code class="reqn">H_0</code>. In addition, he provided an asymptotic distribution of <code class="reqn">T_{B93}</code> under <code class="reqn">H_0</code> when <code class="reqn">q</code> tends to infinity where <code class="reqn">q=max\{a-1,b-1\}</code>.
Note that the LBI test is powerful when the <code class="reqn">a \times b</code> matrix of interaction terms has small rank and one singular value dominates the remaining singular values or
in practice, if the largest eigenvalue of <code class="reqn">RR'</code> is expected to dominate the remaining eigenvalues.
</p>


<h3>Value</h3>

<p>An object of the class <code>ITtest</code>, which is a list inducing following components:
</p>
<table>
<tr><td><code>pvalue_exact</code></td>
<td>
<p>An exact Monte Carlo p-value when <code class="reqn">p&gt;2</code>. For <code class="reqn">p=2</code>, an exact p-value is calculated.</p>
</td></tr>
<tr><td><code>pvalue_appro</code></td>
<td>
<p>An chi-squared asymptotic p-value.</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>The value of test statistic.</p>
</td></tr>
<tr><td><code>Nsim</code></td>
<td>
<p>The number of Monte Carlo samples that are used to estimate p-value.</p>
</td></tr>
<tr><td><code>data_name</code></td>
<td>
<p>The name of the input dataset.</p>
</td></tr>
<tr><td><code>test</code></td>
<td>
<p>The name of the test.</p>
</td></tr>
<tr><td><code>Level</code></td>
<td>
<p>The level of test.</p>
</td></tr>
<tr><td><code>Result</code></td>
<td>
<p>The result of the test at the alpha level with some descriptions on the type of significant interaction.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Boik, R.J. (1993). Testing additivity in two-way classifications
with no replications: the locally best invariant test. Journal of Applied
Statistics 20(1): 41-55.
</p>
<p>Shenavari, Z., Kharrati-Kopaei, M. (2018). A Method for Testing Additivity in
Unreplicated Two-Way Layouts Based on Combining Multiple Interaction Tests. International Statistical Review
86(3): 469-487.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MVGH)
Boik_test(MVGH, nsim = 1000)
</code></pre>

<hr>
<h2 id='CI_test'>Combined Interaction Test</h2><span id='topic+CI_test'></span>

<h3>Description</h3>

<p>This function reports the p-values of the tests for non-additivity developed by Boik (1993), Piepho (1994),
Kharrati-Kopaei and Sadooghi-Alvandi (2007), Franck et al. (2013), Malik et al. (2016)
and Kharrati-Kopaei and Miller (2016). In addition, it combines the p-values of these six tests (and some other available p-values) into a single p-value as a test statistic for testing interaction.
There are four combination methods:
Bonferroni, Sidak, Jacobi expansion, and Gaussian Copula. The results of these four combined tests are also reported. If there is a significant interaction, the type of interaction is also provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CI_test(
  x,
  nsim = 10000,
  nc0 = 10000,
  opvalue = NULL,
  alpha = 0.05,
  report = TRUE,
  Elapsed_time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CI_test_+3A_x">x</code></td>
<td>
<p>numeric matrix, <code class="reqn">a \times b</code> data matrix where the number of row and column is corresponding to the number of factor levels.</p>
</td></tr>
<tr><td><code id="CI_test_+3A_nsim">nsim</code></td>
<td>
<p>a numeric value, the number of Monte Carlo samples for computing an exact Monte Carlo p-value. The default value is 10000.</p>
</td></tr>
<tr><td><code id="CI_test_+3A_nc0">nc0</code></td>
<td>
<p>a numeric value, the number of Monte Carlo samples for computing the unbiasing constant <code class="reqn">c_0</code> in <code>KKM.test</code>. The default value is 10000.</p>
</td></tr>
<tr><td><code id="CI_test_+3A_opvalue">opvalue</code></td>
<td>
<p>a numeric vector, other p-values (in addition to the six considered p-values) that are going to be combined.</p>
</td></tr>
<tr><td><code id="CI_test_+3A_alpha">alpha</code></td>
<td>
<p>a numeric value, the level of the test. The default value is 0.05.</p>
</td></tr>
<tr><td><code id="CI_test_+3A_report">report</code></td>
<td>
<p>logical: if <code>TRUE</code> the result of the test is reported at the <code>alpha</code> level.</p>
</td></tr>
<tr><td><code id="CI_test_+3A_elapsed_time">Elapsed_time</code></td>
<td>
<p>logical: if <code>TRUE</code> the progress will be printed in the console.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data matrix is divided based on the row of the data matrix for <code>KKSA_test</code> and <code>Franck_test</code>. Note that <code>KKSA_test</code> is not applicable when <code class="reqn">a</code> is less than four. <code>Franck_test</code> and <code>Piepho_test</code> are not applicable when <code class="reqn">a</code> is less than three. This function needs <code>mvtnorm</code> package.
</p>


<h3>Value</h3>

<p>An object of the class <code>combtest</code>, which is a list inducing following components:
</p>
<table>
<tr><td><code>nsim</code></td>
<td>
<p>The number of Monte Carlo samples that are used to estimate p-value.</p>
</td></tr>
<tr><td><code>Piepho_pvalue</code></td>
<td>
<p>The p-value of Piepho's (1994) test.</p>
</td></tr>
<tr><td><code>Piepho_Stat</code></td>
<td>
<p>The value of Piepho's (1994) test statistic.</p>
</td></tr>
<tr><td><code>Boik_pvalue</code></td>
<td>
<p>The p-value of Boik's (1993) test.</p>
</td></tr>
<tr><td><code>Boik_Stat</code></td>
<td>
<p>The value of Boik's (1993) test statistic.</p>
</td></tr>
<tr><td><code>Malik_pvalue</code></td>
<td>
<p>The p-value of Malik's (2016) et al. test.</p>
</td></tr>
<tr><td><code>Malik_Stat</code></td>
<td>
<p>The value of Malik's (2016) et al. test statistic.</p>
</td></tr>
<tr><td><code>KKM_pvalue</code></td>
<td>
<p>The p-value of Kharrati-Kopaei and Miller's (2016) test.</p>
</td></tr>
<tr><td><code>KKM_Stat</code></td>
<td>
<p>The value of Kharrati-Kopaei and Miller's (2016) test statistic.</p>
</td></tr>
<tr><td><code>KKSA_pvalue</code></td>
<td>
<p>The p-value of Kharrati-Kopaei and Sadooghi-Alvandi's (2007) test.</p>
</td></tr>
<tr><td><code>KKSA_Stat</code></td>
<td>
<p>The value of Kharrati-Kopaei and Sadooghi-Alvandi's (2007) test statistic.</p>
</td></tr>
<tr><td><code>Franck_pvalue</code></td>
<td>
<p>The p-value of Franck's (2013) et al. test.</p>
</td></tr>
<tr><td><code>Franck_Stat</code></td>
<td>
<p>The value of Franck's (2013) et al. test statistic.</p>
</td></tr>
<tr><td><code>Bonferroni</code></td>
<td>
<p>The combined p-value by using the Bonferroni method.</p>
</td></tr>
<tr><td><code>Sidak</code></td>
<td>
<p>The combined p-value by using the Sidak method.</p>
</td></tr>
<tr><td><code>Jacobi</code></td>
<td>
<p>The combined p-value by using the Jacobi method.</p>
</td></tr>
<tr><td><code>GC</code></td>
<td>
<p>The combined p-value by using the Gaussian copula.</p>
</td></tr>
<tr><td><code>data_name</code></td>
<td>
<p>The name of the input dataset.</p>
</td></tr>
<tr><td><code>test</code></td>
<td>
<p>The name of the test.</p>
</td></tr>
<tr><td><code>Level</code></td>
<td>
<p>The level of test.</p>
</td></tr>
<tr><td><code>Result</code></td>
<td>
<p>The result of the combined test at the alpha level with some descriptions on the type of significant interaction.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Shenavari, Z., Kharrati-Kopaei, M. (2018). A Method for Testing Additivity in
Unreplicated Two-Way Layouts Based on Combining Multiple Interaction Tests. International Statistical Review
86(3): 469-487.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CNV)
CI_test(CNV, nsim = 1000, Elapsed_time = FALSE)

</code></pre>

<hr>
<h2 id='CNV'>Copy number variation (CNV).</h2><span id='topic+CNV'></span>

<h3>Description</h3>

<p>This data set are about copy number variation (CNV) between normal and tumor tissue samples among six dogs.
In this data set, the value of CNV was measured as a signal intensity obtained from a comparative genomic hybridization (CGH) array,
with higher signals corresponding to higher copy numbers; see Franck et al. (2013) and Franck and Osborne (2016).
The data set was selected from 5899 sets (the full data have been made available as the supplementary material of the paper published by Franck et al. (2013)).
The test of interaction between the dogs and tisuues is of interest.
</p>


<h3>Format</h3>

<p>A matrix with six rows (Dogs) and two columns (Tissues):
</p>

<dl>
<dt>Row1</dt><dd><p>Dog1</p>
</dd>
<dt>Row2</dt><dd><p>Dog2</p>
</dd>
<dt>Row3</dt><dd><p>Dog3</p>
</dd>
<dt>Row4</dt><dd><p>Dog4</p>
</dd>
<dt>Row5</dt><dd><p>Dog5</p>
</dd>
<dt>Row6</dt><dd><p>Dog6</p>
</dd>
<dt>Column1</dt><dd><p>Normal tissue</p>
</dd>
<dt>Column2</dt><dd><p>Tumor</p>
</dd>
</dl>



<h3>References</h3>


<ol>
<li>
<p>Franck, C., Nielsen, D., Osborne, J.A. (2013). A method for detecting hidden additivity in two-factor unreplicated experiments.
Computational Statistics and Data Analysis 67:95-104.
</p>
</li>
<li>
<p>Franck, C., Osborne, J.A. (2016).  Exploring Interaction Effects in Two-Factor Studies using the hidden Package in R.
R Journal 8 (1):159-172.
</p>
</li></ol>


<hr>
<h2 id='Franck_test'>Franck's (2013) et al. test for Interaction</h2><span id='topic+Franck_test'></span>

<h3>Description</h3>

<p>This function calculates Franck's (2013) et al. test statistic, ACMIF, and corresponding p-value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Franck_test(
  x,
  nsim = 10000,
  alpha = 0.05,
  report = TRUE,
  plot = FALSE,
  vecolor = c("blue", "red"),
  linetype = c(1, 2),
  Elapsed_time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Franck_test_+3A_x">x</code></td>
<td>
<p>numeric matrix, <code class="reqn">a \times b</code> data matrix where the number of row and column is corresponding to the number of factor levels.</p>
</td></tr>
<tr><td><code id="Franck_test_+3A_nsim">nsim</code></td>
<td>
<p>a numeric value, the number of Monte Carlo samples for computing an exact Monte Carlo p-value. The default value is 10000.</p>
</td></tr>
<tr><td><code id="Franck_test_+3A_alpha">alpha</code></td>
<td>
<p>a numeric value, the level of the test. The default value is 0.05.</p>
</td></tr>
<tr><td><code id="Franck_test_+3A_report">report</code></td>
<td>
<p>logical: if <code>TRUE</code> the result of the test is reported at the <code>alpha</code> level.</p>
</td></tr>
<tr><td><code id="Franck_test_+3A_plot">plot</code></td>
<td>
<p>logical: if <code>TRUE</code> an interaction plot will be plotted.</p>
</td></tr>
<tr><td><code id="Franck_test_+3A_vecolor">vecolor</code></td>
<td>
<p>character vector of length two, for visualizing the colors of lines in interaction plot. The default colors are blue and red.</p>
</td></tr>
<tr><td><code id="Franck_test_+3A_linetype">linetype</code></td>
<td>
<p>numeric vector of length two, for visualizing the line types in interaction plot. The default line types are 1 and 2.</p>
</td></tr>
<tr><td><code id="Franck_test_+3A_elapsed_time">Elapsed_time</code></td>
<td>
<p>logical: if <code>TRUE</code> the progress will be printed in the console.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Franck et al. (2013) derived a test statistic based on the “hidden additivity” structure.
They defined this structure as “the levels of one factor belong in two or more groups such that within each group the effects of the two factors are additive but the groups may interact with the ungrouped factor”.
To detect hidden additivity, Franck et al. (2013) divided the table of data into two sub-tables (based on the rows of the data matrix) and an interaction F-test was developed.
Then, they performed a search over all possible configures of data and used the maximum of the interaction F-test as a test statistic. The hypothesis of no interaction is rejected when the maximum interaction F-test is large.
If <code>plot</code> is <code>TRUE</code> an interaction plot will be plotted by displaying levels of column factor on the horizontal axis,
levels of row factor using lines that are visually distinguished by line type and color, and the
observed values on the vertical axis. Color and line type are used to display which levels of row factor are assigned to which
groups based on the maximum F-values among all possible configurations. Note
that the grouping colors and line types appear whether or not the Franck.test detects
a significant non-additivity. The default colors are blue and red, and the default line types are one and two for the two groups. They can be customized by supplying arguments called <code>vecolor</code> and <code>linetype</code>.
Note that the number of rows should be greater than two to perform the Franck.test. This test is powerful when there is a hidden additivity structure in the data set.
</p>


<h3>Value</h3>

<p>An object of the class <code>ITtest</code>, which is a list inducing following components:
</p>
<table>
<tr><td><code>pvalue_exact</code></td>
<td>
<p>The calculated exact Monte Carlo p-value.</p>
</td></tr>
<tr><td><code>pvalue_appro</code></td>
<td>
<p>The Bonferroni-adjusted p-value is calculated.</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>The value of the test statistic.</p>
</td></tr>
<tr><td><code>Nsim</code></td>
<td>
<p>The number of Monte Carlo samples that are used to estimate p-value.</p>
</td></tr>
<tr><td><code>data_name</code></td>
<td>
<p>The name of the input dataset.</p>
</td></tr>
<tr><td><code>test</code></td>
<td>
<p>The name of the test.</p>
</td></tr>
<tr><td><code>Level</code></td>
<td>
<p>The level of test.</p>
</td></tr>
<tr><td><code>Result</code></td>
<td>
<p>The result of the test at the alpha level with some descriptions on the type of significant interaction.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Franck, C., Nielsen, D., Osborne, J.A. (2013). A method for detecting hidden additivity in two-factor unreplicated experiments.
Computational Statistics and Data Analysis 67:95-104.
</p>
<p>Franck, C., Osborne, J.A. (2016).  Exploring Interaction Effects in Two-Factor Studies using the hidden Package in R.
R Journal 8 (1):159-172.
</p>
<p>Shenavari, Z., Kharrati-Kopaei, M. (2018). A Method for Testing Additivity in
Unreplicated Two-Way Layouts Based on Combining Multiple Interaction Tests. International Statistical Review
86(3): 469-487.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CNV)
Franck_test(CNV, nsim = 1000, Elapsed_time = FALSE)

</code></pre>

<hr>
<h2 id='IDCP'>Impurity data in a chemical product (IDCP).</h2><span id='topic+IDCP'></span>

<h3>Description</h3>

<p>This data were collected in an experiment to assess the impurity present in a chemical product.
The impurity is affected by two factors: pressure and temperature. Montgomery (2001, p. 193)
analyzed the data by using the Tukey single-degree-of-freedom test
and concluded that there is no evidence of interaction.
</p>


<h3>Format</h3>

<p>A matrix with five rows (Pressures) and three columns (Temperatures):
</p>

<dl>
<dt>Row1</dt><dd><p>Pressure 25</p>
</dd>
<dt>Row2</dt><dd><p>Pressure 30</p>
</dd>
<dt>Row3</dt><dd><p>Pressure 35</p>
</dd>
<dt>Row4</dt><dd><p>Pressure 40</p>
</dd>
<dt>Row5</dt><dd><p>Pressure45</p>
</dd>
<dt>Column1</dt><dd><p>Temperature 100</p>
</dd>
<dt>Column2</dt><dd><p>Temperature 125</p>
</dd>
<dt>Column3</dt><dd><p>Temperature 150</p>
</dd>
</dl>



<h3>References</h3>


<ol>
<li>
<p>Montgomery, D. C. (2001). Design and analysis of experiments, 5th Edition, p 193.
John Wiley &amp; Sons.
</p>
</li></ol>


<hr>
<h2 id='interaction_plot'>Interaction Plot</h2><span id='topic+interaction_plot'></span>

<h3>Description</h3>

<p>Interaction Plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interaction_plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interaction_plot_+3A_x">x</code></td>
<td>
<p>numeric matrix, <code class="reqn">a \times b</code> data matrix where the number of row and column is corresponding to the number of factor levels.</p>
</td></tr>
<tr><td><code id="interaction_plot_+3A_...">...</code></td>
<td>
<p>plot parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plots an interaction plot for input.
</p>


<h3>Author(s)</h3>

<p>Shenavari, Z.; Haghbin, H.; Kharrati-Kopaei, M.; Najibi, S.M.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: this is an example
data(CNV)
interaction_plot(CNV)
</code></pre>

<hr>
<h2 id='KKM_test'>Kharrati-Kopaei and Miller's (2016) Test for Interaction</h2><span id='topic+KKM_test'></span>

<h3>Description</h3>

<p>This function calculates the test statistic for testing <code class="reqn">H_0:</code> There is no interaction, and corresponding Monte Carlo p-value
proposed by Kharrati-Kopaei and Miller (2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KKM_test(x, nsim = 1000, alpha = 0.05, report = TRUE, nc0 = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KKM_test_+3A_x">x</code></td>
<td>
<p>a numeric matrix, <code class="reqn">a \times b</code> data matrix where the number of row and column is corresponding to the number of factor levels.</p>
</td></tr>
<tr><td><code id="KKM_test_+3A_nsim">nsim</code></td>
<td>
<p>a numeric value, the number of Monte Carlo samples for computing an exact Monte Carlo p-value. The default value is 10000.</p>
</td></tr>
<tr><td><code id="KKM_test_+3A_alpha">alpha</code></td>
<td>
<p>a numeric value, the level of the test. The default value is 0.05.</p>
</td></tr>
<tr><td><code id="KKM_test_+3A_report">report</code></td>
<td>
<p>logical: if <code>TRUE</code> the result of the test is reported at the <code>alpha</code> level.</p>
</td></tr>
<tr><td><code id="KKM_test_+3A_nc0">nc0</code></td>
<td>
<p>a numeric value, the number of Monte Carlo samples for computing the unbiasing constant <code class="reqn">c_0</code>. The default value is 10000.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Kharrati-Kopaei and Miller (2016) proposed a test statistic for testing interaction
based on inspecting all pairwise interaction contrasts (PIC).
This test depends on an unbiasing constant <code class="reqn">c_0</code> that is calculated by a Monte Carlo simulation.
In addition, the null distribution of the test statistic is calculated by a Monte Carlo simulation. This test is not applicable when both <code class="reqn">a</code> and <code class="reqn">b</code> are less than three.
Note that this test procedure is powerful when significant interactions are caused by some data cells.
</p>


<h3>Value</h3>

<p>An object of the class <code>ITtest</code>, which is a list inducing following components:
</p>
<table>
<tr><td><code>pvalue_exact</code></td>
<td>
<p>The calculated exact Monte Carlo p-value.</p>
</td></tr>
<tr><td><code>pvalue_appro</code></td>
<td>
<p>is not available for <code>KKM_test</code>.</p>
</td></tr>
<tr><td><code>Nsim</code></td>
<td>
<p>The number of Monte Carlo samples that are used to estimate p-value.</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>The value of the test statistic.</p>
</td></tr>
<tr><td><code>data_name</code></td>
<td>
<p>The name of the input dataset.</p>
</td></tr>
<tr><td><code>test</code></td>
<td>
<p>The name of the test.</p>
</td></tr>
<tr><td><code>Level</code></td>
<td>
<p>The level of test.</p>
</td></tr>
<tr><td><code>Result</code></td>
<td>
<p>The result of the test at the alpha level with some descriptions on the type of significant interaction.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kharrati-Kopaei, M., Miller, A. (2016). A method for testing interaction in
unreplicated two-way tables: using all pairwise interaction contrasts. Statistical
Computation and Simulation 86(6):1203-1215.
</p>
<p>Shenavari, Z., Kharrati-Kopaei, M. (2018). A Method for Testing Additivity in
Unreplicated Two-Way Layouts Based on Combining Multiple Interaction Tests. International Statistical Review
86(3): 469-487.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RDWW)
KKM_test(RDWW, nsim = 1000, nc0 = 1000)

</code></pre>

<hr>
<h2 id='KKSA_test'>Kharrati-Kopaei and Sadooghi-Alvandi's (2007) test for interaction</h2><span id='topic+KKSA_test'></span>

<h3>Description</h3>

<p>This function calculates Kharrati-Kopaei and Sadooghi-Alvandi's test statistic and corresponding p-value for testing interaction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KKSA_test(
  x,
  nsim = 10000,
  alpha = 0.05,
  report = TRUE,
  plot = FALSE,
  vecolor = c("blue", "red"),
  linetype = c(1, 2),
  Elapsed_time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KKSA_test_+3A_x">x</code></td>
<td>
<p>numeric matrix, <code class="reqn">a \times b</code> data matrix where the number of row and column is corresponding to the number of factor levels.</p>
</td></tr>
<tr><td><code id="KKSA_test_+3A_nsim">nsim</code></td>
<td>
<p>a numeric value, the number of Monte Carlo samples for computing an exact Monte Carlo p-value. The default value is 10000.</p>
</td></tr>
<tr><td><code id="KKSA_test_+3A_alpha">alpha</code></td>
<td>
<p>a numeric value, the level of the test. The default value is 0.05.</p>
</td></tr>
<tr><td><code id="KKSA_test_+3A_report">report</code></td>
<td>
<p>logical: if <code>TRUE</code> the result of the test is reported at the <code>alpha</code> level.</p>
</td></tr>
<tr><td><code id="KKSA_test_+3A_plot">plot</code></td>
<td>
<p>logical: if <code>TRUE</code> an interaction plot will be plotted.</p>
</td></tr>
<tr><td><code id="KKSA_test_+3A_vecolor">vecolor</code></td>
<td>
<p>character vector with length two, for visualizing the colors of lines in interaction plot. The default colors are blue and red.</p>
</td></tr>
<tr><td><code id="KKSA_test_+3A_linetype">linetype</code></td>
<td>
<p>numeric vector with length two, for visualizing the line types in interaction plot. The default line types are 1 and 2.</p>
</td></tr>
<tr><td><code id="KKSA_test_+3A_elapsed_time">Elapsed_time</code></td>
<td>
<p>logical: if <code>TRUE</code> the progress will be printed in the console.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that <code class="reqn">a \ge b</code> and <code class="reqn">b \ge 4</code>. Consider the <code class="reqn">l</code>-th division of the data table into two sub-tables,
obtained by putting <code class="reqn">a_1</code> (<code class="reqn">2 \le a_1 \le a-2</code>) rows in the first sub-table and the remaining <code class="reqn">a_2</code> rows in the second sub-table (<code class="reqn">a_1+a_2=a</code>).
Let RSS1 and RSS2 denote the residual sum of squares for these two sub-tables, respectively. For a particular division <code class="reqn">l</code>, let <code class="reqn">F_l=max\{F_l,1/F_l\}</code>
where <code class="reqn">F_l=(a_2-1)RSS1/((a_1-1)RSS2)</code> and let <code class="reqn">P_l</code> denote the corresponding p-value.
Kharrati-Kopaei and Sadooghi-Alvandi (2007) proposed their test statistic as the minimum value of <code class="reqn">P_l</code> over <code class="reqn">l=1,…,2^{(a-1)}-a-1</code> all possible divisions of the table.
If <code>plot</code> is <code>TRUE</code> an interaction plot will be plotted by displaying levels of column factor on the horizontal axis,
levels of row factor using lines that are visually distinguished by line type and color, and the
observed values on the vertical axis. Color and line type are used to display which levels of row factor are assigned to which
sub-tables based on the minimum p-values among all possible configurations. Note
that the grouping colors and line types appear whether or not the KKSA.test detects
a significant non-additivity. The default colors are blue and red, and the default line types are one and two for the two sub-tables. They can be customized by supplying arguments called <code>vecolor</code> and <code>linetype</code>.
Note that this method of testing requires that the data matrix has more than three
rows. This test procedure is powerful for detecting interaction when the magnitude of interaction effects is heteroscedastic across the sub-tables of observations.
</p>


<h3>Value</h3>

<p>An object of the class <code>ITtest</code>, which is a list inducing following components:
</p>
<table>
<tr><td><code>pvalue_exact</code></td>
<td>
<p>The calculated exact Monte Carlo p-value.</p>
</td></tr>
<tr><td><code>pvalue_appro</code></td>
<td>
<p>The Bonferroni-adjusted p-value is calculated.</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>The value of the test statistic.</p>
</td></tr>
<tr><td><code>Nsim</code></td>
<td>
<p>The number of Monte Carlo samples that are used to estimate p-value.</p>
</td></tr>
<tr><td><code>data_name</code></td>
<td>
<p>The name of the input dataset.</p>
</td></tr>
<tr><td><code>test</code></td>
<td>
<p>The name of the test.</p>
</td></tr>
<tr><td><code>Level</code></td>
<td>
<p>The level of test.</p>
</td></tr>
<tr><td><code>Result</code></td>
<td>
<p>The result of the test at the alpha level with some descriptions on the type of significant interaction.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kharrati-Kopaei, M., Sadooghi-Alvandi, S.M. (2007). A New Method for
Testing Interaction in Unreplicated Two-Way Analysis of Variance. Communications
in Statistics-Theory and Methods 36:2787–2803.
</p>
<p>Shenavari, Z., Kharrati-Kopaei, M. (2018). A Method for Testing Additivity in
Unreplicated Two-Way Layouts Based on Combining Multiple Interaction Tests. International Statistical Review
86(3): 469-487.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(IDCP)
KKSA_test(IDCP, nsim = 1000, Elapsed_time = FALSE)

</code></pre>

<hr>
<h2 id='Malik_test'>Malik's (2016) et al. Test for Interaction</h2><span id='topic+Malik_test'></span>

<h3>Description</h3>

<p>The Malik's (2016) et al. test statistic is calculated and the corresponding exact p-value is calculated by a Monte Carlo simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Malik_test(x, nsim = 10000, alpha = 0.05, report = TRUE, Elapsed_time = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Malik_test_+3A_x">x</code></td>
<td>
<p>numeric matrix, <code class="reqn">a \times b</code> data matrix where the number of row and column is corresponding to the number of factor levels.</p>
</td></tr>
<tr><td><code id="Malik_test_+3A_nsim">nsim</code></td>
<td>
<p>a numeric value, the number of Monte Carlo samples for computing an exact Monte Carlo p-value. The default value is 10000.</p>
</td></tr>
<tr><td><code id="Malik_test_+3A_alpha">alpha</code></td>
<td>
<p>a numeric value, the level of the test. The default value is 0.05.</p>
</td></tr>
<tr><td><code id="Malik_test_+3A_report">report</code></td>
<td>
<p>logical: if <code>TRUE</code> the result of the test is reported at the <code>alpha</code> level.</p>
</td></tr>
<tr><td><code id="Malik_test_+3A_elapsed_time">Elapsed_time</code></td>
<td>
<p>logical: if <code>TRUE</code> the progress will be printed in the console.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Malik (2016) et al. proposed to partition
the residuals into three clusters using a suitable clustering method like “k-means clustering”.
The hypothesis of no interaction can be interpreted as the effect of the three
clusters are equal. Therefore, the result of the test may depend on the method of clustering. In this package, clustering is done by <code>kmeans</code> function in <code>RcppArmadillo</code>. The <code>speed_mode</code> parameter on the kmeans clustering was set as <code>static_subset</code>.
Note that the Malik's et al. test performs well when there are some outliers in the residuals; i.e. some cells produce large negative or positive residuals due to the significant interaction.
Further, the distribution of the Malik's et al. test statistic is not known under additivity and the corresponding p-value is calculated by a Monte Carlo simulation.
</p>


<h3>Value</h3>

<p>An object of the class <code>ITtest</code>, which is a list inducing following components:
</p>
<table>
<tr><td><code>pvalue_exact</code></td>
<td>
<p>The calculated exact Monte Carlo p-value.</p>
</td></tr>
<tr><td><code>pvalue_appro</code></td>
<td>
<p>is not available for <code>Malik_test</code>.</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>The value of the test statistic.</p>
</td></tr>
<tr><td><code>Nsim</code></td>
<td>
<p>The number of Monte Carlo samples that are used to estimate p-value.</p>
</td></tr>
<tr><td><code>data_name</code></td>
<td>
<p>The name of the input dataset.</p>
</td></tr>
<tr><td><code>test</code></td>
<td>
<p>The name of the test.</p>
</td></tr>
<tr><td><code>Level</code></td>
<td>
<p>The level of test.</p>
</td></tr>
<tr><td><code>Result</code></td>
<td>
<p>The result of the test at the alpha level with some descriptions on the type of significant interaction.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Malik, W.A., Mohring, J., Piepho, H.P. (2016). A
clustering-based test for non-additivity in an unreplicated two-way layout.
Communications in Statistics-Simulation and Computation 45(2):660-670.
</p>
<p>Shenavari, Z., Kharrati-Kopaei, M. (2018). A Method for Testing Additivity in
Unreplicated Two-Way Layouts Based on Combining Multiple Interaction Tests. International Statistical Review
86(3): 469-487.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(IDCP)
Malik_test(IDCP, nsim = 1000, Elapsed_time = FALSE)

</code></pre>

<hr>
<h2 id='MVGH'>The mean values of growth hormone (MVGH).</h2><span id='topic+MVGH'></span>

<h3>Description</h3>

<p>This data set are about the mean values of growth hormone for the levels of zinc and thyroid hormone obtained by Freake et al. (2001).
This data set has been previously analyzed by Alin and Kurt (2006). There three levels of zinc:
Zinc deficient, Pair-fed, and Control. There are also  three levels of thyroid hormone: Hypothyroid, Euthyroid, and Hyperthyroid.
The test of interaction between the zinc and thyroid hormone is of interest.
</p>


<h3>Format</h3>

<p>A matrix with three rows (Thyroid levels) and three columns (Zinc levels):
</p>

<dl>
<dt>Row1</dt><dd><p>Hypothyroid</p>
</dd>
<dt>Row2</dt><dd><p>Euthyroid</p>
</dd>
<dt>Row3</dt><dd><p>Hyperthyroid</p>
</dd></dl>
<p>.
</p>
<dl>
<dt>Column1</dt><dd><p>Zinc deficient</p>
</dd>
<dt>Column2</dt><dd><p>Pair-fed</p>
</dd>
<dt>Column3</dt><dd><p>Control</p>
</dd>
</dl>



<h3>References</h3>


<ol>
<li>
<p>Alin, A., Kurt, S. (2006). Testing non-additivity (interaction) in two-way ANOVA tables with no replication,
<em>Statistical Methods in Medical Research</em> <strong>15</strong>: 63–85.
</p>
</li>
<li>
<p>Freake,  H. C., Govoni,  K. E., Guda, K., Huang, C, Zinn, S. A. (2001).
Actions and interactions of thyroid hormone and zinc status in growing rats.
Journal of Nutrition 131:1135–41.
</p>
</li></ol>


<hr>
<h2 id='Piepho_test'>Piepho's (1994) Test for Interaction</h2><span id='topic+Piepho_test'></span>

<h3>Description</h3>

<p>This function tests the interaction based on a statistic proposed by Piepho (1994).
This function reports Piepho's test statistic, an asymptotic p-value, and a Monte Carlo p-value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Piepho_test(x, nsim = 10000, alpha = 0.05, report = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Piepho_test_+3A_x">x</code></td>
<td>
<p>numeric matrix, <code class="reqn">a \times b</code> data matrix where the number of row and column is corresponding to the number of factor levels.</p>
</td></tr>
<tr><td><code id="Piepho_test_+3A_nsim">nsim</code></td>
<td>
<p>a numeric value, the number of Monte Carlo samples for computing an exact Monte Carlo p-value. The default value is 10000.</p>
</td></tr>
<tr><td><code id="Piepho_test_+3A_alpha">alpha</code></td>
<td>
<p>a numeric value, the level of the test. The default value is 0.05.</p>
</td></tr>
<tr><td><code id="Piepho_test_+3A_report">report</code></td>
<td>
<p>logical: if <code>TRUE</code> the result of the test is reported at the <code>alpha</code> level.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Piepho (1994) proposed three test statistics. The third one is
based on Grubbs’ (1948) type estimator of variance for the level of the row factor.
This type of estimator is used in this function. Piepho (1994) proposed an asymptotic distribution of test statistic; however, a Monte Carlo method is used to calculate the p-value.
The Piepho test is not applicable when the row number of the data matrix is less than three. Note that Piepho’s test is powerful for detecting interactions when the Grubbs’ type estimators of variances are heterogeneous across the levels of one factor.
</p>


<h3>Value</h3>

<p>An object of the class <code>ITtest</code>, which is a list inducing following components:
</p>
<table>
<tr><td><code>pvalue_exact</code></td>
<td>
<p>The calculated exact Monte Carlo p-value.</p>
</td></tr>
<tr><td><code>pvalue_appro</code></td>
<td>
<p>The asymptotic p-value.</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>The value of the test statistic.</p>
</td></tr>
<tr><td><code>Nsim</code></td>
<td>
<p>The number of Monte Carlo samples that are used to estimate p-value.</p>
</td></tr>
<tr><td><code>data_name</code></td>
<td>
<p>The name of the input dataset.</p>
</td></tr>
<tr><td><code>test</code></td>
<td>
<p>The name of the test.</p>
</td></tr>
<tr><td><code>Level</code></td>
<td>
<p>The level of test.</p>
</td></tr>
<tr><td><code>Result</code></td>
<td>
<p>The result of the test at the alpha level with some descriptions on the type of significant interaction.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Piepho, H. P. (1994). On Tests for Interaction in a Nonreplicated Two-Way Layout. Australian
Journal of Statistics 36:363-369.
</p>
<p>Shenavari, Z., Kharrati-Kopaei, M. (2018). A Method for Testing Additivity in
Unreplicated Two-Way Layouts Based on Combining Multiple Interaction Tests. International Statistical Review
86(3): 469-487.
</p>
<p>Grubbs, F.E. (1948). On Estimating Precision of Measuring Instruments and Product Variability. Journal of the American Statistical Association 43(242): 243-264.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MVGH)
Piepho_test(MVGH, nsim = 1000)

</code></pre>

<hr>
<h2 id='RDWW'>Ratio of dry to wet wheat (RDWW).</h2><span id='topic+RDWW'></span>

<h3>Description</h3>

<p>This data set are about the ratio of dry to wet wheat of four different blocks and four times of nitrogen applied: None, Early, Middle, and Late.
The test of interaction between the blocks and the level of nitrogen applied is of interest.
</p>


<h3>Format</h3>

<p>A matrix with four rows (Blocks) and four columns (Nitrogen Applied):
</p>

<dl>
<dt>Row1</dt><dd><p>Block1</p>
</dd>
<dt>Row2</dt><dd><p>Block2</p>
</dd>
<dt>Row3</dt><dd><p>Block3</p>
</dd>
<dt>Row4</dt><dd><p>Block4</p>
</dd>
<dt>Column1</dt><dd><p>None</p>
</dd>
<dt>Column2</dt><dd><p>Early</p>
</dd>
<dt>Column3</dt><dd><p>Middle</p>
</dd>
<dt>Column4</dt><dd><p>Late</p>
</dd>
</dl>



<h3>References</h3>


<ol>
<li>
<p>Ostle, B. (1963). Statistics in Research, Basic Concepts and Techniques for Research Works.
2nd ed, p. 396. The Iowa State University Press.
</p>
</li></ol>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
