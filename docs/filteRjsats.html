<!DOCTYPE html><html><head><title>Help for package filteRjsats</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {filteRjsats}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add_fish'><p>Add Fish Data from ERDAPP to a Detection Dataframe</p></a></li>
<li><a href='#cft_fish'><p>Example fish data from CalFishTrack</p></a></li>
<li><a href='#cft_rcvrs'><p>Example receiver data from CalFishTrack</p></a></li>
<li><a href='#compare_detects'><p>Compare two Detection Dataframes</p></a></li>
<li><a href='#filter_fish_detects'><p>Example fish detection data which has been prefiltered and has fish data</p></a></li>
<li><a href='#filtered_detections'><p>Previously filtered detection data</p></a></li>
<li><a href='#fish'><p>Fish Data</p></a></li>
<li><a href='#fish_detects'><p>Example fish detection data</p></a></li>
<li><a href='#format_detects'><p>Format Detections for filteRjsats</p></a></li>
<li><a href='#format_fish'><p>Format Fish Data for add_fish()</p></a></li>
<li><a href='#format_receivers'><p>Format for Receiver data for filteRjsats</p></a></li>
<li><a href='#get_fish_fields'><p>Get A List of Fish Related Fields from ERDAPP</p></a></li>
<li><a href='#get_rcvr_data'><p>Get A Dataframe of All Receiver Data from CalFishTrack</p></a></li>
<li><a href='#get_rcvr_fields'><p>Get A List of Receiver Related Fields from ERDAPP</p></a></li>
<li><a href='#get_receiver_type'><p>Get Receiver Type</p></a></li>
<li><a href='#get_reference_tags'><p>Get A List of Reference (Beacon) Tags from ERDAPP</p></a></li>
<li><a href='#get_tagged_fish'><p>Get A Dataframe of All Tagged fish from CalFishTrack</p></a></li>
<li><a href='#join_rcvr_data'><p>Add Receiver Data to a Completely Filtered Detection File</p></a></li>
<li><a href='#prefilter'><p>Apply the &quot;prefilter&quot; to a Detection Dataframe</p></a></li>
<li><a href='#prefiltered_detects'><p>Example Prefiltered Detection Dataframe</p></a></li>
<li><a href='#raw_ats'><p>Example raw data from ats receiver after being read in by read_jsats</p></a></li>
<li><a href='#rcvr_fields'><p>A List of Important Receiver Related Fields from ERDAPP</p></a></li>
<li><a href='#read_ats'><p>Read an ATS Acoustic Receiver File</p></a></li>
<li><a href='#read_jsats'><p>Read an Acoustic Receiver File</p></a></li>
<li><a href='#read_lotek'><p>Read a Lotek Acoustic Receiver File</p></a></li>
<li><a href='#read_tekno'><p>Read a Teknologic Acoustic Receiver File</p></a></li>
<li><a href='#receivers'><p>Receiver Data</p></a></li>
<li><a href='#reftags'><p>Example reference tags</p></a></li>
<li><a href='#rolling_sd_3'><p>Calculate Standard Deviation Over a Rolling Window of 3</p></a></li>
<li><a href='#second_filter_2h4h'><p>Two or Four Hit Filter for Any Detection File</p></a></li>
<li><a href='#second_filter_4h'><p>Four Hit Filter for Any Detection File</p></a></li>
<li><a href='#second_filter_ats'><p>Two Hit Filter for ATS Detections</p></a></li>
<li><a href='#second_filter_ats_4h'><p>Four Hit Filter for ATS Detections</p></a></li>
<li><a href='#second_filter_lotek'><p>Four Hit Filter for Lotek Detections</p></a></li>
<li><a href='#second_filter_tekno'><p>Two Hit Filter for Teknologic Detections</p></a></li>
<li><a href='#second_filter_tekno_4h'><p>Four Hit Filter for Tekno Detections</p></a></li>
<li><a href='#Set_GVs'><p>Add in Global Variables</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Filter Raw JSATS Acoustic Telemetry Files from Lotek, ATS,
Teknologic</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Filtering of raw acoustic telemetry transmissions
    from three acoustic telemetry companies (ATS, Lotek, Teknologic). The 
    filtering steps check for false positives caused by reflected transmissions 
    from surfaces and false pings from other noise generating equipment. The 
    filter is unique for each technology type. The package was written in 
    concert with the Interagency Telemetry Advisory Group (iTAG) and makes use 
    of the JSATS California Fish Tracking Database:
    <a href="https://oceanview.pfeg.noaa.gov/CalFishTrack/">https://oceanview.pfeg.noaa.gov/CalFishTrack/</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>broman, dplyr, lubridate, stringr, tidyr, rerddap</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>xz</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-07 17:52:33 UTC; TSpaulding</td>
</tr>
<tr>
<td>Author:</td>
<td>Taylor Spaulding <a href="https://orcid.org/0000-0003-4381-5296"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Arnold Ammann [aut],
  Travis Hinkelman [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Taylor Spaulding &lt;tspaulding@esassoc.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-10 14:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='add_fish'>Add Fish Data from ERDAPP to a Detection Dataframe</h2><span id='topic+add_fish'></span>

<h3>Description</h3>

<p>This function takes a prefiltered detection dataframe from prefilter() and
joins it to fish data downloaded from ERDAPP using the get_fish_data()
function or formatted using the format_fish() function. Detections are then
filtered further based on the date and time of tag release and expected
battery life. Detections occurring before release of the tag or after 2x the
expected battery life are removed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_fish(prefilter_file, fish)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_fish_+3A_prefilter_file">prefilter_file</code></td>
<td>
<p>a prefiltered detection dataframe from prefilter()</p>
</td></tr>
<tr><td><code id="add_fish_+3A_fish">fish</code></td>
<td>
<p>a dataframe of fish data rectrieved from get_fish_data()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A filtered dataframe converting the raw detection data into rows of detections
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Add fish data to a detection dataframe and filter for only detections
# associated with tagged fish

add_fish(prefiltered_detects, cft_fish)
</code></pre>

<hr>
<h2 id='cft_fish'>Example fish data from CalFishTrack</h2><span id='topic+cft_fish'></span>

<h3>Description</h3>

<p>A dataframe of acoustically tagged fish downloaded from ERDDAP representing
fish released in 2021 and 2022.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cft_fish
</code></pre>


<h3>Format</h3>



<h4><code>cft_fish</code></h4>

<p>A dataframe with 17,227 rows and 25 columns
</p>

<dl>
<dt>fish_id</dt><dd><p>Identifies the fish that was tagged. It is unique in that no
two fish have the same FishID. Format is 2 or more letters that describe
the type of the fish (e.g. WR for WinterRun), followed by the year (YYYY),
followed by a dash, then a sequential three digit number (e.g. 001 to 999)</p>
</dd>
<dt>study_id</dt><dd><p>Identifies a group of tagged fish that belong to a study.
Format is text description of place followed by year (YYYY). A single
StudyID can have fish release on multiple days within a year and/or at
multiple locations within a year.</p>
</dd>
<dt>fish_type</dt><dd><p>Describes the fish tagged. Generally a part that describes
where it came from and a part that refers to the common name.</p>
</dd>
<dt>fish_origin</dt><dd><p>Describes where the fish is from or where it was
collected. Example: Hatchery, Natural, Sacramento River.</p>
</dd>
<dt>fish_date_tagged</dt><dd><p>The date and time that indicates the time the tag
was activated and implanted into the fish. Tags are usually activated
several minutes before implanting into fish in PST.</p>
</dd>
<dt>fish_release_date</dt><dd><p>The date and time of release in PST.</p>
</dd>
<dt>tag_id_hex</dt><dd><p>The hexadecimal form for the tags code. This is not
unique in that two fish can have the same Hex Tag Code. This is usually
from the same tag code being used in different years. This is why all
queries must be based on Fish ID.</p>
</dd>
<dt>tag_id_decimal</dt><dd><p>The decimal form for the tags code. This is not
unique in that two fish can have the same Decimal Tag Code. This is
usually from the same tag code being used in different years. This is why
all queries must be based on Fish ID.</p>
</dd>
<dt>tag_weight</dt><dd><p>weight of tag in air</p>
</dd>
<dt>tag_model</dt><dd><p>The model of the tag.</p>
</dd>
<dt>tag_pulse_rate_interval_nominal</dt><dd><p>The nominal (aka approximate) pulse
rate interval. This is how often the tag transmits its code signal.</p>
</dd>
<dt>tag_warranty_life</dt><dd><p>The minimum number of days a tag is expected to
transmit its code. Generally tags transmit for at least 1.5x the warranty
life.</p>
</dd>
<dt>fish_length_type</dt><dd><p>The way the fish was measured. Fork length = FL,
total length = TL, standard length = SL. If unknown = NA.</p>
</dd>
<dt>fish_length</dt><dd><p>Measured fish length in millimeters</p>
</dd>
<dt>fish_weight</dt><dd><p>Measured fish weight in grams (in air)</p>
</dd>
<dt>release_location</dt><dd><p>The name of the place that the fish was released.</p>
</dd>
<dt>release_latitude</dt><dd><p>The latitude of the release location.</p>
</dd>
<dt>release_longitude</dt><dd><p>The longitude of the release location.</p>
</dd>
<dt>release_river_km</dt><dd><p>The river km of the release location.
The Golden Gate Bridge = rkm 0.0. Values increase the further upstream.</p>
</dd>
<dt>email</dt><dd><p>the email address of the point of contact that grants approval
for using the data from each fish.</p>
</dd>
</dl>



<hr>
<h2 id='cft_rcvrs'>Example receiver data from CalFishTrack</h2><span id='topic+cft_rcvrs'></span>

<h3>Description</h3>

<p>A dataframe of acoustic receiver metadata downloaded from ERDDAP representing
receivers deployed from 2021-2022.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cft_rcvrs
</code></pre>


<h3>Format</h3>



<h4><code>cft_rcvrs</code></h4>

<p>A dataframe of 1,130 rows and 12 columns:
</p>

<dl>
<dt>dep_id</dt><dd><p>a unique number that identifies a single deployment</p>
</dd>
<dt>receiver_serial_number</dt><dd><p>the serial number of the acoustic receiver
that recorded the detection. If this value is 1, then the record is not a
receiver detection but is the release date-time and location. Every
tagged fish has at least one record in the table</p>
</dd>
<dt>receiver_general_location</dt><dd><p>A name for the geographic location of one
or more receivers.</p>
</dd>
<dt>receiver_region</dt><dd><p>A name for a larger geographic region that defines a
subarea of the Central Valley watershed. Some regions are Upper Sac R,
Lower Sac R, Feather R, East Delta, West Delta, SF Bay.</p>
</dd>
<dt>receiver_location</dt><dd><p>The name for the location of a single receiver</p>
</dd>
<dt>latitude</dt><dd><p>Latitude for the exact location of a single receiver.
If unknown = cell is blank</p>
</dd>
<dt>longitude</dt><dd><p>Longitude for the exact location of a single receiver. If
unknown = cell is blank</p>
</dd>
<dt>receiver_river_km</dt><dd><p>River kilometer for the location of a single
receiver. Must be unique for each GPSname. The Golden Gate Bridge is rkm 0.
Values increase the further upstream</p>
</dd>
<dt>receiver_make</dt><dd><p>Describes the manufacturer and type of JSATS receiver.</p>
</dd>
<dt>receiver_depth</dt><dd><p>the estimated depth of the receiver hydrophone. If
unknown = blank</p>
</dd>
<dt>receiver_start</dt><dd><p>	The date and time in Pacific Standard Time when the
receiver was deployed (put at the site in the water). Format: date time
M/DD/YYYY HH:MM</p>
</dd>
<dt>receiver_end</dt><dd><p>The date and time in Pacific Standard Time when the
receiver was recovered (removed from the water). Format: date time
M/DD/YYYY HH:MM</p>
</dd>
<dt>receiver_last_valid</dt><dd><p>	Taken from the detection data file for this
deployment, the date and time in Pacific Standard Time of the last valid
detection or sensor data entry. This time cannot be greater than the
EndTime, but can be less that the EndTime if receiver quit recording data
or was pulled out of the water. Format: date time M/DD/YYYY HH:MM</p>
</dd>
<dt>receiver_data_coverage</dt><dd><p>	describes how extensive the data is for this
receiver deployment. If the receiver failed to work or was lost and not
recovered = none. If it worked for part of the deployment = partial. If
the receiver worked the entire deployment = full. Can be blank.</p>
</dd>
<dt>receiver_coverage_problem</dt><dd><p>If the receiver did not work until EndTime
then an entry here describes the reason why the receiver may have failed.</p>
</dd>
<dt>receiver_agency</dt><dd><p>The agency (abbreviated) managing the receiver
deployment.</p>
</dd>
<dt>receiver_beacon_id_hex</dt><dd><p>The hex code of the beacon tag associated
with this receiver deployment</p>
</dd>
<dt>	receiver_beacon_id_dec</dt><dd><p>The decimal code of the beacon tag
associated with this receiver deployment</p>
</dd>
<dt>receiver_beacon_pri</dt><dd><p>The pulse rate interval of the beacon tag in
secs, usually 60 or 30 secs</p>
</dd>
</dl>



<hr>
<h2 id='compare_detects'>Compare two Detection Dataframes</h2><span id='topic+compare_detects'></span>

<h3>Description</h3>

<p>This function compares two detection dataframes from filtered acoustic
telemetry detections and identifies the filtered out detections. The first
input is the original dataframe, the second is the filtered dataframe. Then
it creates a dataframe of detections which are missing from the filtered
dataframe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_detects(a1, a2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_detects_+3A_a1">a1</code></td>
<td>
<p>unfiltered detection dataframe</p>
</td></tr>
<tr><td><code id="compare_detects_+3A_a2">a2</code></td>
<td>
<p>filtered detection dataframe</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe of detections from the original dataframe missing from
the filtered dataframe. Spurious detections.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Compare detections before and after filtering
compare_detects(raw_ats[1:1000,], filter_fish_detects[1:1000,])
</code></pre>

<hr>
<h2 id='filter_fish_detects'>Example fish detection data which has been prefiltered and has fish data</h2><span id='topic+filter_fish_detects'></span>

<h3>Description</h3>

<p>Example tag detection data representing a single file which has been
processed using the <code>prefilter()</code> and <code>add_fish()</code> functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_fish_detects
</code></pre>


<h3>Format</h3>



<h4><code>filter_fish_detects</code></h4>

<p>A dataframe with 5,000 rows and 39 columns
</p>

<dl>
<dt>ReceiverSN</dt><dd><p>the serial number of the acoustic receiver which heard the
detection</p>
</dd>
<dt>Make</dt><dd><p>The Manufacturer of the acoustic reciever</p>
</dd>
<dt>DateTime_Local</dt><dd><p>The local date and time of the detection
tz = &quot;America/Los_Angeles&quot;</p>
</dd>
<dt>Tag_Decimal</dt><dd><p>The decimal value of the tag ID code</p>
</dd>
<dt>Tag_Hex</dt><dd><p>The hexadecimal value of the tag ID code</p>
</dd>
<dt>Tilt</dt><dd><p>The tilt of the acoustic receiver from a vertical axis</p>
</dd>
<dt>Volt</dt><dd><p>The voltage of the on-board battery of the receiver</p>
</dd>
<dt>Temp</dt><dd><p>The water temperature outside of the receiver</p>
</dd>
<dt>SigStr</dt><dd><p>The strength of the acoustic signal in dB</p>
</dd>
<dt>Freq</dt><dd><p>The frequency of the acoustic signal in kHz</p>
</dd>
<dt>Thres</dt><dd><p>The relative amount of external background noise,
signal threshold</p>
</dd>
<dt>CheckMBP</dt><dd><p>A calculated field from the first filter checking the
time between acoustic transmissions from the same tag was &gt;0.3secs</p>
</dd>
<dt>TagInFile</dt><dd><p>A calculated field from the add_fish filter which
queries whether the tag code of the detection is associated with a fish.</p>
</dd>
<dt>fish_id</dt><dd><p>Identifies the fish that was tagged. It is unique in that no
two fish have the same FishID. Format is 2 or more letters that describe
the type of the fish (e.g. WR for WinterRun), followed by the year (YYYY),
followed by a dash, then a sequential three digit number (e.g. 001 to 999)</p>
</dd>
<dt>study_id</dt><dd><p>Identifies a group of tagged fish that belong to a study.
Format is text description of place followed by year (YYYY). A single
StudyID can have fish release on multiple days within a year and/or at
multiple locations within a year.</p>
</dd>
<dt>fish_type</dt><dd><p>Describes the fish tagged. Generally a part that describes
where it came from and a part that refers to the common name.</p>
</dd>
<dt>fish_origin</dt><dd><p>Describes where the fish is from or where it was
collected. Example: Hatchery, Natural, Sacramento River.</p>
</dd>
<dt>fish_date_tagged</dt><dd><p>The date and time that indicates the time the tag
was activated and implanted into the fish. Tags are usually activated
several minutes before implanting into fish in PST.</p>
</dd>
<dt>fish_release_date</dt><dd><p>The date and time of release in PST.</p>
</dd>
<dt>tag_id_hex</dt><dd><p>The hexadecimal form for the tags code. This is not
unique in that two fish can have the same Hex Tag Code. This is usually
from the same tag code being used in different years. This is why all
queries must be based on Fish ID.</p>
</dd>
<dt>tag_id_decimal</dt><dd><p>The decimal form for the tags code. This is not
unique in that two fish can have the same Decimal Tag Code. This is
usually from the same tag code being used in different years. This is why
all queries must be based on Fish ID.</p>
</dd>
<dt>tag_weight</dt><dd><p>weight of tag in air</p>
</dd>
<dt>tag_model</dt><dd><p>The model of the tag.</p>
</dd>
<dt>tag_pulse_rate_interval_nominal</dt><dd><p>The nominal (aka approximate) pulse
rate interval. This is how often the tag transmits its code signal.</p>
</dd>
<dt>tag_warranty_life</dt><dd><p>The minimum number of days a tag is expected to
transmit its code. Generally tags transmit for at least 1.5x the warranty
life.</p>
</dd>
<dt>fish_length_type</dt><dd><p>The way the fish was measured. Fork length = FL,
total length = TL, standard length = SL. If unknown = NA.</p>
</dd>
<dt>fish_length</dt><dd><p>Measured fish length in millimeters</p>
</dd>
<dt>fish_weight</dt><dd><p>Measured fish weight in grams (in air)</p>
</dd>
<dt>release_location</dt><dd><p>The name of the place that the fish was released.</p>
</dd>
<dt>release_latitude</dt><dd><p>The latitude of the release location.</p>
</dd>
<dt>release_longitude</dt><dd><p>The longitude of the release location.</p>
</dd>
<dt>release_river_km</dt><dd><p>The river km of the release location.
The Golden Gate Bridge = rkm 0.0. Values increase the further upstream.</p>
</dd>
<dt>email</dt><dd><p>the email address of the point of contact that grants approval
for using the data from each fish.</p>
</dd>
<dt>release_rkm</dt><dd><p>The river km of the release location.
The Golden Gate Bridge = rkm 0.0. Values increase the further upstream.</p>
</dd>
<dt>tag_life</dt><dd><p>The minimum number of days a tag is expected to
transmit its code. Generally tags transmit for at least 1.5x the warranty
life.</p>
</dd>
<dt>length</dt><dd><p>Measured fish length in millimeters</p>
</dd>
<dt>weight</dt><dd><p>Measured fish weight in grams (in air)</p>
</dd>
<dt>CheckDT</dt><dd><p>A calculated field which checks whether the detection
occurred after the release of the fish</p>
</dd>
<dt>CheckBattLife</dt><dd><p>A calculated field which checks whether the detection
occurred before the tag battery is expected to expire (2x tag life)</p>
</dd>
</dl>



<hr>
<h2 id='filtered_detections'>Previously filtered detection data</h2><span id='topic+filtered_detections'></span>

<h3>Description</h3>

<p>An example dataset of real acoustic telemetry detections of fish at several
receivers within the California Central Valley from 2021. These detections
have already been been processed to remove false positives using the various
filtering functions in this package and in companion package <code>filteRjsats</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filtered_detections
</code></pre>


<h3>Format</h3>



<h4><code>filtered_detections</code></h4>

<p>A data frame with 100,000 rows and 3 columns:
</p>

<dl>
<dt>serial</dt><dd><p>The serial number of the detecting receiver</p>
</dd>
<dt>local_time</dt><dd><p>the local time of the detection (tz = America/Los_Angeles)</p>
</dd>
<dt>tag_id</dt><dd><p>The hexadecimal acoustic tag ID code</p>
</dd>
</dl>




<h3>Source</h3>

<p>Data collected by the California Department of Water Resources 2021
</p>

<hr>
<h2 id='fish'>Fish Data</h2><span id='topic+fish'></span>

<h3>Description</h3>

<p>An example dataset of real fish tagged with acoustic telemetry tags and
released within the California Central Valley in 2021 and 2022.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fish
</code></pre>


<h3>Format</h3>



<h4><code>fish</code></h4>

<p>A data frame with 17,227 rows and 10 columns:
</p>

<dl>
<dt>fish_type</dt><dd><p>Generally a strain, run, and species of fish (e.g.
Nimbus Fall Chinook = Fall-run Chinook Salmon from Nimbus Hatchery)</p>
</dd>
<dt>TagCode</dt><dd><p>The hexadecimal code of the implanted acoustic tag</p>
</dd>
<dt>Release_Date</dt><dd><p>The release date and time of the fish</p>
</dd>
<dt>release_location</dt><dd><p>The coded name of the release site</p>
</dd>
<dt>length</dt><dd><p>The length of the fish in millimeters</p>
</dd>
<dt>weight</dt><dd><p>The weight of the fish in grams</p>
</dd>
<dt>tag_weight</dt><dd><p>The weight of the implanted acoustic tag</p>
</dd>
<dt>tag_model</dt><dd><p>The model number of the implanted acoustic tag</p>
</dd>
<dt>PRI</dt><dd><p>The pulse rate interval (time between transmissions) of the
implanted tag, as reported by the manufacturer</p>
</dd>
<dt>TagLife</dt><dd><p>The expected number of days the tag should continue to
transmit, as reported by the manufacturer</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="https://oceanview.pfeg.noaa.gov/CalFishTrack/pageRealtime_download.html">https://oceanview.pfeg.noaa.gov/CalFishTrack/pageRealtime_download.html</a>
</p>

<hr>
<h2 id='fish_detects'>Example fish detection data</h2><span id='topic+fish_detects'></span>

<h3>Description</h3>

<p>Example tag detection data from CalFishTrack representing fish released in
2021.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fish_detects
</code></pre>


<h3>Format</h3>



<h4><code>fish_detects</code></h4>

<p>A dataframe with 10,000 rows and 3 columns
</p>

<dl>
<dt>ReceiverSN</dt><dd><p>the serial number of the acoustic receiver which heard
the detection</p>
</dd>
<dt>DateTime_Local</dt><dd><p>The local date and time of the detection
tz = &quot;America/Los_Angeles&quot;</p>
</dd>
<dt>Tag_Code</dt><dd><p>The hexadecimal value of the acoustic tag ID code</p>
</dd>
</dl>



<hr>
<h2 id='format_detects'>Format Detections for filteRjsats</h2><span id='topic+format_detects'></span>

<h3>Description</h3>

<p>This function takes a detection dataframe from a single receiver and
reformats specific columns so that they can be read by the filtering
functions in filteRjsats package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_detects(
  data,
  var_Id,
  var_datetime_local,
  var_frequency = NULL,
  var_receiver_serial,
  var_receiver_make = NULL,
  local_time_zone,
  time_format
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="format_detects_+3A_data">data</code></td>
<td>
<p>the detection dataframe with columns for individual receivers,
tag IDs,datetime, and the expected ping rate.</p>
</td></tr>
<tr><td><code id="format_detects_+3A_var_id">var_Id</code></td>
<td>
<p>the column name, in quotes, which identifies the individual
transmitter/tag/organism identifier.</p>
</td></tr>
<tr><td><code id="format_detects_+3A_var_datetime_local">var_datetime_local</code></td>
<td>
<p>the column name, in quotes, which identifies the
date and time of the detection event. This column should already have been converted
to POSIXct format and should be converted to the local timezone.</p>
</td></tr>
<tr><td><code id="format_detects_+3A_var_frequency">var_frequency</code></td>
<td>
<p>the column name, in quotes, which identifies the maximum
temporal frequency at which transmitters in organisms emit a detectable
signal, only for use before JSATS filtering.</p>
</td></tr>
<tr><td><code id="format_detects_+3A_var_receiver_serial">var_receiver_serial</code></td>
<td>
<p>the column name, in quotes, which identifies the
serial number of the detection receiver</p>
</td></tr>
<tr><td><code id="format_detects_+3A_var_receiver_make">var_receiver_make</code></td>
<td>
<p>the column name, in quotes, which identifies the
make or brand of the detection receiver. Must be one of &quot;ATS&quot;, &quot;Lotek&quot;, or
&quot;Tekno&quot;, only for use before JSATS filtering.</p>
</td></tr>
<tr><td><code id="format_detects_+3A_local_time_zone">local_time_zone</code></td>
<td>
<p>the local timezone used for analyses. Uses tz database
names (e.g. &quot;America/Los_Angeles&quot; for Pacific Time)</p>
</td></tr>
<tr><td><code id="format_detects_+3A_time_format">time_format</code></td>
<td>
<p>a string value indicating the datetime format of all time
fields</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A standardized detection dataframe which can be read by filteRjsats
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Rename columns to work with functions
format_detects(data = filtered_detections,
               var_Id = "tag_id",
               var_datetime_local = "local_time",
               var_receiver_serial = "serial",
               local_time_zone = "America/Los_Angeles",
               time_format = "%Y-%m-%d %H:%M:%S")
</code></pre>

<hr>
<h2 id='format_fish'>Format Fish Data for add_fish()</h2><span id='topic+format_fish'></span>

<h3>Description</h3>

<p>This function takes a dataframe of fish and tag data and renames the
columns to those expected by the add_fish() function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_fish(
  data,
  var_Id,
  var_release,
  var_tag_life,
  var_ping_rate,
  local_time_zone,
  time_format
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="format_fish_+3A_data">data</code></td>
<td>
<p>a dataframe of fish and tag data</p>
</td></tr>
<tr><td><code id="format_fish_+3A_var_id">var_Id</code></td>
<td>
<p>the column name, in quotes, which identifies the individual
transmitter/tag/organism identifier.</p>
</td></tr>
<tr><td><code id="format_fish_+3A_var_release">var_release</code></td>
<td>
<p>the column name, in quotes, which identifies the release
date and time in POSIX format and appropriate timezone</p>
</td></tr>
<tr><td><code id="format_fish_+3A_var_tag_life">var_tag_life</code></td>
<td>
<p>the column name, in quotes, which identified the expected
tag life in days</p>
</td></tr>
<tr><td><code id="format_fish_+3A_var_ping_rate">var_ping_rate</code></td>
<td>
<p>the column name, in quotes which identifies the expected
ping rate of the tag/transmitter</p>
</td></tr>
<tr><td><code id="format_fish_+3A_local_time_zone">local_time_zone</code></td>
<td>
<p>the local timezone used for analyses. Uses tz database
names (e.g. &quot;America/Los_Angeles&quot; for Pacific Time)</p>
</td></tr>
<tr><td><code id="format_fish_+3A_time_format">time_format</code></td>
<td>
<p>a string value indicating the datetime format of all time
fields</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe which contains fields renamed to match those required by
add_org() function
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Rename columns to work with functions
format_fish(data = fish,
            var_Id = "TagCode",
            var_release = "Release_Date",
            var_tag_life = "TagLife",
            var_ping_rate = "PRI",
            local_time_zone = "America/Los_Angeles",
            time_format = "%Y-%m-%d %H:%M:%S")
</code></pre>

<hr>
<h2 id='format_receivers'>Format for Receiver data for filteRjsats</h2><span id='topic+format_receivers'></span>

<h3>Description</h3>

<p>This function takes a dataframe of receiver metadata and reformats specific
columns so that they can be read by the filtering functions in filteRjsats
package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_receivers(
  data,
  var_receiver_serial,
  var_receiver_make,
  var_receiver_deploy,
  var_receiver_retrieve,
  local_time_zone,
  time_format
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="format_receivers_+3A_data">data</code></td>
<td>
<p>the detection dataframe with columns for individual receivers,
tag IDs,datetime, and the expected ping rate.</p>
</td></tr>
<tr><td><code id="format_receivers_+3A_var_receiver_serial">var_receiver_serial</code></td>
<td>
<p>the column name, in quotes, which identifies the
serial number of the detection receiver</p>
</td></tr>
<tr><td><code id="format_receivers_+3A_var_receiver_make">var_receiver_make</code></td>
<td>
<p>the column name, in quotes, which identifies the
make or brand of the detection receiver. Must be one of &quot;ATS&quot;, &quot;Lotek&quot;, or
&quot;Tekno&quot;</p>
</td></tr>
<tr><td><code id="format_receivers_+3A_var_receiver_deploy">var_receiver_deploy</code></td>
<td>
<p>the column name, in quotes, which identifies the
date and time the receiver was deployed</p>
</td></tr>
<tr><td><code id="format_receivers_+3A_var_receiver_retrieve">var_receiver_retrieve</code></td>
<td>
<p>the column name, in quotes, which identifies the
date and time the receiver was retrieved</p>
</td></tr>
<tr><td><code id="format_receivers_+3A_local_time_zone">local_time_zone</code></td>
<td>
<p>the local timezone used for analyses. Uses tz database
names (e.g. &quot;America/Los_Angeles&quot; for Pacific Time)</p>
</td></tr>
<tr><td><code id="format_receivers_+3A_time_format">time_format</code></td>
<td>
<p>a string value indicating the datetime format of all time
fields</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe which contains fields renamed to match those required by
add_receivers() function
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Rename columns to work with functions
format_receivers(data = receivers,
                 var_receiver_serial = "receiver_serial_number",
                 var_receiver_make = "receiver_make",
                 var_receiver_deploy = "receiver_start",
                 var_receiver_retrieve = "receiver_end",
                 local_time_zone = "America/Los_Angeles",
                 time_format = "%m-%d-%Y %H:%M:%S")
</code></pre>

<hr>
<h2 id='get_fish_fields'>Get A List of Fish Related Fields from ERDAPP</h2><span id='topic+get_fish_fields'></span>

<h3>Description</h3>

<p>This function searches the California Fish Tracking ERDAPP Database to create
a list of all potential fields related to fish metrics. Used to identify
important fish data fields to add to detection data in the add_fish function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_fish_fields()
</code></pre>


<h3>Value</h3>

<p>A vector of potential fish fields which the user may review to
retrieve specific field indices
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fish_fields &lt;- get_fish_fields
</code></pre>

<hr>
<h2 id='get_rcvr_data'>Get A Dataframe of All Receiver Data from CalFishTrack</h2><span id='topic+get_rcvr_data'></span>

<h3>Description</h3>

<p>This function searches the California Fish Tracking ERDAPP Database to create
a dataframe ofacoustic receiver metadata. Desired fields can be set to select
only certain fields, object rcvr_fields is the default. This data is used to add
receiver metadata to detection data in the add_fish function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_rcvr_data(fields = rcvr_fields)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_rcvr_data_+3A_fields">fields</code></td>
<td>
<p>a vector of important field names to be imported from the
ERDDAP dataset</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe of receiver metadata which can be joined to detection data
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Retrieve the default set of fields from Cal Fish Track needed for package
tout &lt;- getOption("timeout")
options(timeout = 4)
try(get_rcvr_data())
options(timeout = tout)
</code></pre>

<hr>
<h2 id='get_rcvr_fields'>Get A List of Receiver Related Fields from ERDAPP</h2><span id='topic+get_rcvr_fields'></span>

<h3>Description</h3>

<p>This function searches the California Fish Tracking ERDAPP Database to create
a list of all potential fields related to acoustic receiver metadata.
Used to identify important metadata fields to include when adding receiver
data in the join_rcvr_data function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_rcvr_fields()
</code></pre>


<h3>Value</h3>

<p>A vector of potential receiver metadata fields which the user may review
</p>


<h3>Examples</h3>

<pre><code class='language-R'># View a list of available receiver fields
get_rcvr_fields()
</code></pre>

<hr>
<h2 id='get_receiver_type'>Get Receiver Type</h2><span id='topic+get_receiver_type'></span>

<h3>Description</h3>

<p>This function takes a list of file paths to raw acoustic receiver detection
files supplied by the user and identifies the type of acoustic receiver
technology (Lotek, ATS, Teknologic) used to generate the file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_receiver_type(file_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_receiver_type_+3A_file_list">file_list</code></td>
<td>
<p>A vector of raw acoustic detection file paths</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe containing the file path, file name, and technology type
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get a list of files
files &lt;- system.file("extdata", package = "filteRjsats")|&gt; list.files()

# get the receiver type
get_receiver_type(files)
</code></pre>

<hr>
<h2 id='get_reference_tags'>Get A List of Reference (Beacon) Tags from ERDAPP</h2><span id='topic+get_reference_tags'></span>

<h3>Description</h3>

<p>This function searches the California Fish Tracking ERDAPP Database to create
a list of beacon tag hexadecimal IDs. Used in the prefilter to separate
beacon tags from tagged fish.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_reference_tags()
</code></pre>


<h3>Value</h3>

<p>A vector of beacon tags hexadecimal IDs
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Download reference tags from CalFishTrack
tout &lt;- getOption("timeout")
options(timeout = 4)
try(ref_tags &lt;- get_reference_tags())
options(timeout = tout)
</code></pre>

<hr>
<h2 id='get_tagged_fish'>Get A Dataframe of All Tagged fish from CalFishTrack</h2><span id='topic+get_tagged_fish'></span>

<h3>Description</h3>

<p>This function searches the California Fish Tracking ERDAPP Database to create
a dataframe of tagged fish data. Desired fields can be set to select only
certain fields. This data is used to add fish data to detection data in the
add_fish function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_tagged_fish(important_fields = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_tagged_fish_+3A_important_fields">important_fields</code></td>
<td>
<p>a vector of important field indexes to be imported
from the ERDDAP dataset</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe of fish data which can be joined to detection data
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Retrieve only a few important fields (fish type, tag code, release date)
tout &lt;- getOption("timeout")
options(timeout = 4)
fields &lt;- c(7,8,16)
try(cal_fish_lite &lt;- get_tagged_fish(important_fields = fields))
options(timeout = tout)
</code></pre>

<hr>
<h2 id='join_rcvr_data'>Add Receiver Data to a Completely Filtered Detection File</h2><span id='topic+join_rcvr_data'></span>

<h3>Description</h3>

<p>This function takes any acoustic receiver detection dataframe which contains
receiver serial numbers in a <code>ReceiverSN</code> field, such as that produced by
<code style="white-space: pre;">&#8288;second_filter_*()&#8288;</code>, and joins it with receiver metadata generated by
the <code>get_rcvr_data()</code> or <code>format_receiver()</code> functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>join_rcvr_data(final_file, rcvr_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="join_rcvr_data_+3A_final_file">final_file</code></td>
<td>
<p>a dataframe of detections retrieved from second_filter</p>
</td></tr>
<tr><td><code id="join_rcvr_data_+3A_rcvr_data">rcvr_data</code></td>
<td>
<p>a dataframe of receiver metadata retrieved from get_rcvr_data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe to which receiver metadata has been added.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Join receiver metadata to detection data
join_rcvr_data(fish_detects, cft_rcvrs)
</code></pre>

<hr>
<h2 id='prefilter'>Apply the &quot;prefilter&quot; to a Detection Dataframe</h2><span id='topic+prefilter'></span>

<h3>Description</h3>

<p>This function takes a detection dataframe output from read_jsats or from
format_detects and filters out multipath signals (time between detections
&lt; 0.3 seconds) and spurious signals which do not occur within a specified
time frame of the last detection. For beacon tags, this time frame is 192
seconds, and for fish, this time is 120 seconds. Following this, the
dataframes are standardized so that all detection dataframes from any
technology type are identical and superfluous fields are removed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prefilter(jsats_file, reference_tags)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prefilter_+3A_jsats_file">jsats_file</code></td>
<td>
<p>A dataframe which is the output from read_jstats() or
format_detects()</p>
</td></tr>
<tr><td><code id="prefilter_+3A_reference_tags">reference_tags</code></td>
<td>
<p>A vector of potential reference (beacon) tag IDs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A standardized detection dataframe with multipath detects removed
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Filter a raw detection dataset
prefilter(raw_ats, reftags)
</code></pre>

<hr>
<h2 id='prefiltered_detects'>Example Prefiltered Detection Dataframe</h2><span id='topic+prefiltered_detects'></span>

<h3>Description</h3>

<p>A dataframe of detections which has gone through the <code>prefilter()</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prefiltered_detects
</code></pre>


<h3>Format</h3>



<h4><code>prefiltered_detects</code></h4>

<p>A dataframe with 209,149 rows and 12 columns
</p>

<dl>
<dt>ReceiverSN</dt><dd><p>the serial number of the acoustic receiver which heard the
detection</p>
</dd>
<dt>Make</dt><dd><p>The Manufacturer of the acoustic reciever</p>
</dd>
<dt>DateTime_Local</dt><dd><p>The local date and time of the detection
tz = &quot;America/Los_Angeles&quot;</p>
</dd>
<dt>Tag_Decimal</dt><dd><p>The decimal value of the tag ID code</p>
</dd>
<dt>Tag_Hex</dt><dd><p>The hexadecimal value of the tag ID code</p>
</dd>
<dt>Tilt</dt><dd><p>The tilt of the acoustic receiver from a vertical axis</p>
</dd>
<dt>Volt</dt><dd><p>The voltage of the on-board battery of the receiver</p>
</dd>
<dt>Temp</dt><dd><p>The water temperature outside of the receiver</p>
</dd>
<dt>SigStr</dt><dd><p>The strength of the acoustic signal in dB</p>
</dd>
<dt>Freq</dt><dd><p>The frequency of the acoustic signal in kHz</p>
</dd>
<dt>Thres</dt><dd><p>The relative amount of external background noise,
signal threshold</p>
</dd>
<dt>CheckMBP</dt><dd><p>A calculated field from the first filter checking the
time between acoustic transmissions from the same tag was &gt;0.3secs</p>
</dd>
</dl>



<hr>
<h2 id='raw_ats'>Example raw data from ats receiver after being read in by read_jsats</h2><span id='topic+raw_ats'></span>

<h3>Description</h3>

<p>A dataframe of ATS acoustic receiver data processed by <code>read_jsats()</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raw_ats
</code></pre>


<h3>Format</h3>



<h4><code>raw_ats</code></h4>

<p>a dataframe with 261,648 rows and 11 columns:
</p>

<dl>
<dt>ReceiverSN</dt><dd><p>the serial number of the acoustic receiver which heard the
detection</p>
</dd>
<dt>Make</dt><dd><p>The Manufacturer of the acoustic reciever</p>
</dd>
<dt>DateTime_Local</dt><dd><p>The local date and time of the detection
tz = &quot;America/Los_Angeles&quot;</p>
</dd>
<dt>Tag_Decimal</dt><dd><p>The decimal value of the tag ID code</p>
</dd>
<dt>Tag_Hex</dt><dd><p>The hexadecimal value of the tag ID code</p>
</dd>
<dt>Tilt</dt><dd><p>The tilt of the acoustic receiver from a vertical axis</p>
</dd>
<dt>Volt</dt><dd><p>The voltage of the on-board battery of the receiver</p>
</dd>
<dt>Temp</dt><dd><p>The water temperature outside of the receiver</p>
</dd>
<dt>SigStr</dt><dd><p>The strength of the acoustic signal in dB</p>
</dd>
<dt>Freq</dt><dd><p>The frequency of the acoustic signal in kHz</p>
</dd>
<dt>Thres</dt><dd><p>The relative amount of external background noise,
signal threshold</p>
</dd>
</dl>



<hr>
<h2 id='rcvr_fields'>A List of Important Receiver Related Fields from ERDAPP</h2><span id='topic+rcvr_fields'></span>

<h3>Description</h3>

<p>A vector of acoustic receiver metadata fields which are needed, at a minimum,
to run the join_rcvr_data function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rcvr_fields
</code></pre>


<h3>Format</h3>

<p>A vector of potential receiver metadata fields which the user may review
</p>

<hr>
<h2 id='read_ats'>Read an ATS Acoustic Receiver File</h2><span id='topic+read_ats'></span>

<h3>Description</h3>

<p>This function takes a raw acoustic detection file generated by an ATS JSATS
receiver and processes it into a dataframe which can be used by the filtering
functions in this package.This is called within read_jsats().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_ats(path, file, timezone = "America/Los_Angeles")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_ats_+3A_path">path</code></td>
<td>
<p>the path to the folder containing the desired file</p>
</td></tr>
<tr><td><code id="read_ats_+3A_file">file</code></td>
<td>
<p>the path of the desired file</p>
</td></tr>
<tr><td><code id="read_ats_+3A_timezone">timezone</code></td>
<td>
<p>the Olsen Named time zone, default is &quot;America/Los_Angeles&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe converting the raw detection data into rows of detections
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Read in an ATS file
path = system.file("extdata/", package = "filteRjsats")
read_ats(path = path, file = "17111___210531_115356.csv",
timezone = "America/Los_Angeles")
# Warnings are expected due to the formatting of ATS files
</code></pre>

<hr>
<h2 id='read_jsats'>Read an Acoustic Receiver File</h2><span id='topic+read_jsats'></span>

<h3>Description</h3>

<p>This function takes a raw acoustic detection file generated by a Lotek,
Teknologic, or ATS JSATS receiver and determines which reader function to use
to process it into a dataframe which can be used by the filtering functions
in this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_jsats(path, file, timezone = "America/Los_Angeles")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_jsats_+3A_path">path</code></td>
<td>
<p>the path to the folder containing the desired file</p>
</td></tr>
<tr><td><code id="read_jsats_+3A_file">file</code></td>
<td>
<p>the path of the desired file</p>
</td></tr>
<tr><td><code id="read_jsats_+3A_timezone">timezone</code></td>
<td>
<p>the Olsen Named time zone, default is &quot;America/Los_Angeles&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe converting the raw detection data into rows of detections
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Read in any ATS, LOTEK, TEKNO file

# list of files
path = system.file("extdata", package = "filteRjsats")
files &lt;- list.files(path)

# Read the files
raw_data &lt;- list()
for(i in 1:length(files)){
raw_data[[i]] &lt;- read_jsats(path = path, file = files[i],
timezone = "America/Los_Angeles")
}
# Warnings are expected due to the formatting of ATS files
</code></pre>

<hr>
<h2 id='read_lotek'>Read a Lotek Acoustic Receiver File</h2><span id='topic+read_lotek'></span>

<h3>Description</h3>

<p>This function takes a raw acoustic detection file generated by a Lotek
JSATS receiver and processes it into a dataframe which can be used by
the filtering functions in this package.This is called within read_jsats().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_lotek(path, file, timezone = "America/Los_Angeles")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_lotek_+3A_path">path</code></td>
<td>
<p>the path to the folder containing the desired file</p>
</td></tr>
<tr><td><code id="read_lotek_+3A_file">file</code></td>
<td>
<p>the path of the desired file</p>
</td></tr>
<tr><td><code id="read_lotek_+3A_timezone">timezone</code></td>
<td>
<p>the Olsen Named time zone, default is &quot;America/Los_Angeles&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe converting the raw detection data into rows of detections
</p>


<h3>Examples</h3>

<pre><code class='language-R'># see read_ats or read_tekno for example usage

</code></pre>

<hr>
<h2 id='read_tekno'>Read a Teknologic Acoustic Receiver File</h2><span id='topic+read_tekno'></span>

<h3>Description</h3>

<p>This function takes a raw acoustic detection file generated by a Teknologic
JSATS receiver and processes it into a dataframe which can be used by
the filtering functions in this package. This is called within read_jsats().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_tekno(path, file, timezone = "America/Los_Angeles")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_tekno_+3A_path">path</code></td>
<td>
<p>the path to the folder containing the desired file</p>
</td></tr>
<tr><td><code id="read_tekno_+3A_file">file</code></td>
<td>
<p>the path of the desired file</p>
</td></tr>
<tr><td><code id="read_tekno_+3A_timezone">timezone</code></td>
<td>
<p>the Olsen Named time zone, default is &quot;America/Los_Angeles&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe converting the raw detection data into rows of detections
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Read in a Teknologic file
path = system.file("extdata/", package = "filteRjsats")
read_tekno(path = path, file = "2015-6007211361217.SUM",
timezone = "America/Los_Angeles")
</code></pre>

<hr>
<h2 id='receivers'>Receiver Data</h2><span id='topic+receivers'></span>

<h3>Description</h3>

<p>An example dataset of real acoustic telemetry receivers within the California
Central Valley in 2021. These receivers are only those which match the
serial numbers in companion dataset <code>filtered_detections</code>. This data is
formatted to match the California Fish Tracking receiver metadata found here:
https://oceanview.pfeg.noaa.gov/CalFishTrack/.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>receivers
</code></pre>


<h3>Format</h3>



<h4><code>receivers</code></h4>

<p>A data frame with 52 rows and 10 columns:
</p>

<dl>
<dt>dep_id</dt><dd><p>A unique id is created for each receiver deployment</p>
</dd>
<dt>receiver_make</dt><dd><p>The brand of the acoustic receiver</p>
</dd>
<dt>receiver_serial_number</dt><dd><p>The serial number of the acoustic receiver</p>
</dd>
<dt>latitude</dt><dd><p>The decimal degree latitude (WGS1984) of the acoustic
receiver at deployment</p>
</dd>
<dt>longitude</dt><dd><p>The decimal degree longitude (WGS1984) of the acoustic
receiver at deployment</p>
</dd>
<dt>receiver_location</dt><dd><p>The site name of an individual receiver, often
more than one <code>receiver_location</code> is found at a <code>receiver_general_location</code></p>
</dd>
<dt>receiver_general_location</dt><dd><p>The more general geographic name of the
location of the receiver</p>
</dd>
<dt>receiver_river_km</dt><dd><p>The number of river kilometers the receiver is
from the Golden Gate Bridge</p>
</dd>
<dt>receiver_start</dt><dd><p>The start time of the reciever (generally when it
was deployed)</p>
</dd>
<dt>receiver_end</dt><dd><p>The end time of the receiver (generally when it was
retrieved)</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="https://oceanview.pfeg.noaa.gov/CalFishTrack/pageRealtime_download.html">https://oceanview.pfeg.noaa.gov/CalFishTrack/pageRealtime_download.html</a>
</p>

<hr>
<h2 id='reftags'>Example reference tags</h2><span id='topic+reftags'></span>

<h3>Description</h3>

<p>A vector of example reference tag codes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reftags
</code></pre>


<h3>Format</h3>

<p>A vector of example reference tag codes
</p>

<hr>
<h2 id='rolling_sd_3'>Calculate Standard Deviation Over a Rolling Window of 3</h2><span id='topic+rolling_sd_3'></span>

<h3>Description</h3>

<p>This function is called within the third filter, and used to calculate a
rolling standard deviation with a window including the 2 leading values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rolling_sd_3(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rolling_sd_3_+3A_x">x</code></td>
<td>
<p>an indexed position of a value in a vector for which the rolling standard deviation is needed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the standard deviation of x, and the two leading values
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Calculate rolling Standard Deviation
set.seed(1234)
x &lt;- rnorm(n = 100, mean = 10, sd = 1)
rolling_sd_3(x)
</code></pre>

<hr>
<h2 id='second_filter_2h4h'>Two or Four Hit Filter for Any Detection File</h2><span id='topic+second_filter_2h4h'></span>

<h3>Description</h3>

<p>This function takes any acoustic receiver detection dataframe generated from
the add_fish() function and filters it a second time to remove any remaining
multipath detections. Then depending on the type of receiver file applies an
algorithm to assess and filter all remaining detections based on 2 or 4 hits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>second_filter_2h4h(fish_file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="second_filter_2h4h_+3A_fish_file">fish_file</code></td>
<td>
<p>a dataframe of detections retrieved from add_fish()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe which has been filtered to remove false positives
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Apply a 2 or 4 hit filter based on the technology
second_filter_2h4h(filter_fish_detects)
</code></pre>

<hr>
<h2 id='second_filter_4h'>Four Hit Filter for Any Detection File</h2><span id='topic+second_filter_4h'></span>

<h3>Description</h3>

<p>This function takes any acoustic receiver detection dataframe generated from
the add_fish() function and filters it a second time to remove any remaining
multipath detections. Then applies an algorithm to assess and filter all
remaining detections based on a four hit filter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>second_filter_4h(fish_file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="second_filter_4h_+3A_fish_file">fish_file</code></td>
<td>
<p>a dataframe of detections retrieved from add_fish()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe which has been filtered to remove false positives
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Apply a 4 hit filter based on the technology
second_filter_4h(filter_fish_detects)
</code></pre>

<hr>
<h2 id='second_filter_ats'>Two Hit Filter for ATS Detections</h2><span id='topic+second_filter_ats'></span>

<h3>Description</h3>

<p>This function takes an ATS detection dataframe generated from the
add_fish() function and filters it a second time to remove any remaining
multipath detections, and then check the remaining detections by comparing
the time between each detection to ensure it is less 4x the stated pulse rate
interval. It additionally checks that all detections have a frequency
between 416.3 and 418.75 kHz and that the frequency of all detections are within
0.505kHz of each other. Called by second_filter_2h4h().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>second_filter_ats(fish_file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="second_filter_ats_+3A_fish_file">fish_file</code></td>
<td>
<p>a dataframe of detections retrieved from add_fish()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe which has been filtered to remove false positives
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Apply the ATS filter to a prefiltered dataset with fish and tag
# attributes
second_filter_ats(filter_fish_detects)
</code></pre>

<hr>
<h2 id='second_filter_ats_4h'>Four Hit Filter for ATS Detections</h2><span id='topic+second_filter_ats_4h'></span>

<h3>Description</h3>

<p>This function takes an ATS detection dataframe generated from the
add_fish() function and filters it a second time to remove any remaining
multipath detections, and then check the remaining detections by comparing the time
between detections, for a rolling window of 4 detections to ensure it is less
16.6x the stated pulse rate interval. It additionally checks that all
detections within the window occur within 20% of the pulse rate interval of
the other detections and that the standard deviation of pulse rate intervals
is less than 0.025. It additionally checks that all detections have a frequency
between 416.3 and 418.75 kHz and that the frequency of all detections are within
0.505kHz of each other. Called by second_filter().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>second_filter_ats_4h(fish_file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="second_filter_ats_4h_+3A_fish_file">fish_file</code></td>
<td>
<p>a dataframe of detections retrieved from add_fish()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe which has been filtered to remove false positives
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Apply a four-hit ATS filter to a prefiltered dataset with fish and tag
# attributes
second_filter_ats_4h(filter_fish_detects)
# No detections are valid
</code></pre>

<hr>
<h2 id='second_filter_lotek'>Four Hit Filter for Lotek Detections</h2><span id='topic+second_filter_lotek'></span>

<h3>Description</h3>

<p>This function takes a Lotek detection dataframe generated from the add_fish()
function and filters it a second time to remove any remaining multipath
detections, and then check the remaining detections by comparing the time
between detections, for a rolling window of 4 detections to ensure it is less
16.6x the stated pulse rate interval. It additionally checks that all
detections within the window occur within 20% of the pulse rate interval of
the other detections and that the standard deviation of pulse rate intervals
is less than 0.025. Called by second_filter().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>second_filter_lotek(fish_file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="second_filter_lotek_+3A_fish_file">fish_file</code></td>
<td>
<p>a dataframe of detections retrieved from add_fish()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe which has been filtered to remove false positives
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Apply the Lotek filter to a prefiltered dataset with fish and tag
# attributes
second_filter_lotek(filter_fish_detects)
</code></pre>

<hr>
<h2 id='second_filter_tekno'>Two Hit Filter for Teknologic Detections</h2><span id='topic+second_filter_tekno'></span>

<h3>Description</h3>

<p>This function takes a Teknologic detection dataframe generated from the
add_fish() function and filters it a second time to remove any remaining
multipath detections, and then check the remaining detections by comparing
the time between each detection to ensure it is less 4x the stated pulse rate
interval. It additionally checks that all detections have a frequency
between 390 and 445 kHz and that the frequency of all detections are within
55kHz of each other. Called by second_filter_2h4h().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>second_filter_tekno(fish_file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="second_filter_tekno_+3A_fish_file">fish_file</code></td>
<td>
<p>a dataframe of detections retrieved from add_fish()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe which has been filtered to remove false positives
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Apply the Teknologics filter to a prefiltered dataset with fish and tag
# attributes
second_filter_tekno(filter_fish_detects)
</code></pre>

<hr>
<h2 id='second_filter_tekno_4h'>Four Hit Filter for Tekno Detections</h2><span id='topic+second_filter_tekno_4h'></span>

<h3>Description</h3>

<p>This function takes an Tekno detection dataframe generated from the
add_fish() function and filters it a second time to remove any remaining
multipath detections, and then check the remaining detections by comparing the time
between detections, for a rolling window of 4 detections to ensure it is less
16.6x the stated pulse rate interval. It additionally checks that all detections have a frequency
between 390 and 445 kHz and that the frequency of all detections are within
55kHz of each other. Called by second_filter_4h().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>second_filter_tekno_4h(fish_file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="second_filter_tekno_4h_+3A_fish_file">fish_file</code></td>
<td>
<p>a dataframe of detections retrieved from add_fish()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe which has been filtered to remove false positives
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Apply a four-hit Teknologics filter to a prefiltered dataset with fish and tag
# attributes
second_filter_tekno_4h(filter_fish_detects)
# No detections are valid
</code></pre>

<hr>
<h2 id='Set_GVs'>Add in Global Variables</h2><span id='topic+Set_GVs'></span>

<h3>Description</h3>

<p>Sets all global variables to remove warnings in package build
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
