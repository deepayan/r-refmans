<!DOCTYPE html><html><head><title>Help for package OpenSpecy</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {OpenSpecy}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#OpenSpecy-package'><p>OpenSpecy: Analyze, Process, Identify, and Share Raman and (FT)IR Spectra</p></a></li>
<li><a href='#adj_intens'><p>Adjust spectral intensities to absorbance units.</p></a></li>
<li><a href='#adj_res'><p>Normalization and conversion of spectral data</p></a></li>
<li><a href='#adj_wave'><p>Adjust wavelength to wavenumbers for Raman</p></a></li>
<li><a href='#as_OpenSpecy'><p>Create <code>OpenSpecy</code> objects</p></a></li>
<li><a href='#c_spec'><p>Manage spectral objects</p></a></li>
<li><a href='#check_lib'><p>Manage spectral libraries</p></a></li>
<li><a href='#collapse_spec'><p>Define features</p></a></li>
<li><a href='#conform_spec'><p>Conform spectra to a standard wavenumber series</p></a></li>
<li><a href='#cor_spec'><p>Identify and filter spectra</p></a></li>
<li><a href='#head.OpenSpecy'><p>Generic Open Specy Methods</p></a></li>
<li><a href='#human_ts'><p>Create human readable timestamps</p></a></li>
<li><a href='#make_rel'><p>Make spectral intensities relative</p></a></li>
<li><a href='#manage_na'><p>Ignore or remove NA intensities</p></a></li>
<li><a href='#plotly_spec'><p>Interactive plots for OpenSpecy objects</p></a></li>
<li><a href='#process_spec'><p>Process Spectra</p></a></li>
<li><a href='#raman_hdpe'><p>Sample Raman spectrum</p></a></li>
<li><a href='#read_any'><p>Read spectral data from multiple files</p></a></li>
<li><a href='#read_envi'><p>Read ENVI data</p></a></li>
<li><a href='#read_opus'><p>Read spectral data from Bruker OPUS binary files</p></a></li>
<li><a href='#read_opus_raw'><p>Read a Bruker OPUS spectrum binary raw string</p></a></li>
<li><a href='#read_text'><p>Read spectral data</p></a></li>
<li><a href='#restrict_range'><p>Range restriction and flattening for spectra</p></a></li>
<li><a href='#run_app'><p>Run Open Specy app</p></a></li>
<li><a href='#share_spec'><p>Share data with the Open Specy community</p></a></li>
<li><a href='#sig_noise'><p>Calculate signal and noise metrics for OpenSpecy objects</p></a></li>
<li><a href='#smooth_intens'><p>Smooth spectral intensities</p></a></li>
<li><a href='#spec_res'><p>Spectral resolution</p></a></li>
<li><a href='#split_spec'><p>Split Open Specy objects</p></a></li>
<li><a href='#subtr_baseline'><p>Automated background subtraction for spectral data</p></a></li>
<li><a href='#test_lib'><p>Test reference library</p></a></li>
<li><a href='#write_spec'><p>Read and write spectral data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analyze, Process, Identify, and Share Raman and (FT)IR Spectra</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-06-13</td>
</tr>
<tr>
<td>Description:</td>
<td>Raman and (FT)IR spectral analysis tool for plastic particles and
    other environmental samples (Cowger et al. 2021,
    &lt;<a href="https://doi.org/10.1021%2Facs.analchem.1c00123">doi:10.1021/acs.analchem.1c00123</a>&gt;). With read_any(), Open Specy provides a
    single function for reading individual, batch, or map spectral data files
    like .asp, .csv, .jdx, .spc, .spa, .0, and .zip. process_spec() simplifies
    processing spectra, including smoothing, baseline correction,
    range restriction and flattening, intensity conversions, wavenumber
    alignment, and min-max normalization. Spectra can be identified in batch
    using an onboard reference library (Cowger et al. 2020,
    &lt;<a href="https://doi.org/10.1177%2F0003702820929064">doi:10.1177/0003702820929064</a>&gt;) using match_spec(). A Shiny app is available
    via run_app() or online at <a href="https://openanalysis.org/openspecy/">https://openanalysis.org/openspecy/</a>.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/wincowgerDEV/OpenSpecy-package/">https://github.com/wincowgerDEV/OpenSpecy-package/</a>,
<a href="https://wincowger.com/OpenSpecy-package/">https://wincowger.com/OpenSpecy-package/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/wincowgerDEV/OpenSpecy-package/issues/">https://github.com/wincowgerDEV/OpenSpecy-package/issues/</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/licenses/by/4.0">CC BY 4.0</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>true</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, data.table, jsonlite, yaml, osfr, caTools, hyperSpec,
mmand, plotly, digest, signal, glmnet, jpeg, shiny</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.1.9), aws.s3, loggit,
config, shinyjs, shinyWidgets, bs4Dash, dplyr, DT, mongolite,
ggplot2</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-13 22:34:11 UTC; hannahsherrod</td>
</tr>
<tr>
<td>Author:</td>
<td>Win Cowger <a href="https://orcid.org/0000-0001-9226-3104"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [cre,
    aut, dtc],
  Zacharias Steinmetz
    <a href="https://orcid.org/0000-0001-6675-5033"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Nick Leong <a href="https://orcid.org/0009-0008-3313-4132"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Andrea Faltynkova <a href="https://orcid.org/0000-0003-2523-3137"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, dtc],
  Hannah Sherrod <a href="https://orcid.org/0009-0001-0497-8693"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Andrew B Gray <a href="https://orcid.org/0000-0003-2252-7367"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Hannah Hapich <a href="https://orcid.org/0000-0003-0000-6632"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Jennifer Lynch <a href="https://orcid.org/0000-0003-3572-8782"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb, dtc],
  Hannah De Frond <a href="https://orcid.org/0000-0003-1199-0727"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb, dtc],
  Keenan Munno <a href="https://orcid.org/0000-0003-2916-5944"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb, dtc],
  Chelsea Rochman <a href="https://orcid.org/0000-0002-7624-711X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb, dtc],
  Sebastian Primpke <a href="https://orcid.org/0000-0001-7633-8524"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb, dtc],
  Orestis Herodotou [ctb],
  Mary C Norris [ctb],
  Christine M Knauss
    <a href="https://orcid.org/0000-0003-4404-8922"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Aleksandra Karapetrova
    <a href="https://orcid.org/0000-0002-9856-1644"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb, dtc,
    rev],
  Vesna Teofilovic <a href="https://orcid.org/0000-0002-3557-1482"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Laura A. T. Markley
    <a href="https://orcid.org/0000-0003-0620-8366"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Shreyas Patankar [ctb, dtc],
  Rachel Kozloski <a href="https://orcid.org/0000-0003-1211-9351"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb, dtc],
  Samiksha Singh [ctb],
  Katherine Lasdin [ctb],
  Cristiane Vidal <a href="https://orcid.org/0000-0001-6363-9475"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Clare Murphy-Hagan
    <a href="https://orcid.org/0009-0009-9629-2856"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Philipp Baumann <a href="https://orcid.org/0000-0002-3194-8975"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Pierre Roudier [ctb],
  National Renewable Energy Laboratory [fnd],
  Possibility Lab [fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Win Cowger &lt;wincowger@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-13 23:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='OpenSpecy-package'>OpenSpecy: Analyze, Process, Identify, and Share Raman and (FT)IR Spectra</h2><span id='topic+OpenSpecy-package'></span><span id='topic+openspecy'></span>

<h3>Description</h3>

<p>Raman and (FT)IR spectral analysis tool for plastic particles and other environmental samples (Cowger et al. 2021, <a href="https://doi.org/10.1021/acs.analchem.1c00123">doi:10.1021/acs.analchem.1c00123</a>). With read_any(), Open Specy provides a single function for reading individual, batch, or map spectral data files like .asp, .csv, .jdx, .spc, .spa, .0, and .zip. process_spec() simplifies processing spectra, including smoothing, baseline correction, range restriction and flattening, intensity conversions, wavenumber alignment, and min-max normalization. Spectra can be identified in batch using an onboard reference library (Cowger et al. 2020, <a href="https://doi.org/10.1177/0003702820929064">doi:10.1177/0003702820929064</a>) using match_spec(). A Shiny app is available via run_app() or online at <a href="https://openanalysis.org/openspecy/">https://openanalysis.org/openspecy/</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Win Cowger <a href="mailto:wincowger@gmail.com">wincowger@gmail.com</a> (<a href="https://orcid.org/0000-0001-9226-3104">ORCID</a>) [data contributor]
</p>
<p>Authors:
</p>

<ul>
<li><p> Zacharias Steinmetz <a href="mailto:z.steinmetz@rptu.de">z.steinmetz@rptu.de</a> (<a href="https://orcid.org/0000-0001-6675-5033">ORCID</a>)
</p>
</li>
<li><p> Nick Leong (<a href="https://orcid.org/0009-0008-3313-4132">ORCID</a>)
</p>
</li>
<li><p> Andrea Faltynkova (<a href="https://orcid.org/0000-0003-2523-3137">ORCID</a>) [data contributor]
</p>
</li>
<li><p> Hannah Sherrod (<a href="https://orcid.org/0009-0001-0497-8693">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Andrew B Gray (<a href="https://orcid.org/0000-0003-2252-7367">ORCID</a>) [contributor]
</p>
</li>
<li><p> Hannah Hapich (<a href="https://orcid.org/0000-0003-0000-6632">ORCID</a>) [contributor]
</p>
</li>
<li><p> Jennifer Lynch (<a href="https://orcid.org/0000-0003-3572-8782">ORCID</a>) [contributor, data contributor]
</p>
</li>
<li><p> Hannah De Frond (<a href="https://orcid.org/0000-0003-1199-0727">ORCID</a>) [contributor, data contributor]
</p>
</li>
<li><p> Keenan Munno (<a href="https://orcid.org/0000-0003-2916-5944">ORCID</a>) [contributor, data contributor]
</p>
</li>
<li><p> Chelsea Rochman (<a href="https://orcid.org/0000-0002-7624-711X">ORCID</a>) [contributor, data contributor]
</p>
</li>
<li><p> Sebastian Primpke (<a href="https://orcid.org/0000-0001-7633-8524">ORCID</a>) [contributor, data contributor]
</p>
</li>
<li><p> Orestis Herodotou [contributor]
</p>
</li>
<li><p> Mary C Norris [contributor]
</p>
</li>
<li><p> Christine M Knauss (<a href="https://orcid.org/0000-0003-4404-8922">ORCID</a>) [contributor]
</p>
</li>
<li><p> Aleksandra Karapetrova (<a href="https://orcid.org/0000-0002-9856-1644">ORCID</a>) [contributor, data contributor, reviewer]
</p>
</li>
<li><p> Vesna Teofilovic (<a href="https://orcid.org/0000-0002-3557-1482">ORCID</a>) [contributor]
</p>
</li>
<li><p> Laura A. T. Markley (<a href="https://orcid.org/0000-0003-0620-8366">ORCID</a>) [contributor]
</p>
</li>
<li><p> Shreyas Patankar [contributor, data contributor]
</p>
</li>
<li><p> Rachel Kozloski (<a href="https://orcid.org/0000-0003-1211-9351">ORCID</a>) [contributor, data contributor]
</p>
</li>
<li><p> Samiksha Singh [contributor]
</p>
</li>
<li><p> Katherine Lasdin [contributor]
</p>
</li>
<li><p> Cristiane Vidal (<a href="https://orcid.org/0000-0001-6363-9475">ORCID</a>) [contributor]
</p>
</li>
<li><p> Clare Murphy-Hagan (<a href="https://orcid.org/0009-0009-9629-2856">ORCID</a>) [contributor]
</p>
</li>
<li><p> Philipp Baumann <a href="mailto:info@spectral-cockpit.space">info@spectral-cockpit.space</a> (<a href="https://orcid.org/0000-0002-3194-8975">ORCID</a>) [contributor]
</p>
</li>
<li><p> Pierre Roudier [contributor]
</p>
</li>
<li><p> National Renewable Energy Laboratory [funder]
</p>
</li>
<li><p> Possibility Lab [funder]
</p>
</li></ul>



<h3>References</h3>

<p>Chabuka BK, Kalivas JH (2020). “Application of a Hybrid Fusion Classification
Process for Identification of Microplastics Based on Fourier Transform
Infrared Spectroscopy.” <em>Applied Spectroscopy</em>, <strong>74</strong>(9),
1167–1183. <a href="https://doi.org/10.1177/0003702820923993">doi:10.1177/0003702820923993</a>.
</p>
<p>Cowger W, Gray A, Christiansen SH, De Frond H, Deshpande AD, Hemabessiere L,
Lee E, Mill L, et al. (2020). “Critical Review of Processing and
Classification Techniques for Images and Spectra in Microplastic Research.”
<em>Applied Spectroscopy</em>, <strong>74</strong>(9), 989–1010.
<a href="https://doi.org/10.1177/0003702820929064">doi:10.1177/0003702820929064</a>.
</p>
<p>Cowger, W (2023). “Library data.” <em>OSF</em>. <a href="https://doi.org/10.17605/OSF.IO/X7DPZ">doi:10.17605/OSF.IO/X7DPZ</a>.
</p>
<p>Cowger W, Steinmetz Z, Gray A, Munno K, Lynch J, Hapich H, Primpke S,
De Frond H, Rochman C, Herodotou O (2021). “Microplastic Spectral
Classification Needs an Open Source Community: Open Specy to the Rescue!”
<em>Analytical Chemistry</em>, <strong>93</strong>(21), 7543–7548.
<a href="https://doi.org/10.1021/acs.analchem.1c00123">doi:10.1021/acs.analchem.1c00123</a>.
</p>
<p>Primpke S, Wirth M, Lorenz C, Gerdts G (2018). “Reference Database Design
for the Automated Analysis of Microplastic Samples Based on Fourier
Transform Infrared (FTIR) Spectroscopy.” <em>Analytical and Bioanalytical
Chemistry</em>, <strong>410</strong>(21), 5131–5141. <a href="https://doi.org/10.1007/s00216-018-1156-x">doi:10.1007/s00216-018-1156-x</a>.
</p>
<p>Savitzky A, Golay MJ (1964). “Smoothing and Differentiation of Data by
Simplified Least Squares Procedures.” <em>Analytical Chemistry</em>,
<strong>36</strong>(8), 1627&ndash;1639.
</p>
<p>Zhao J, Lui H, McLean DI, Zeng H (2007). “Automated Autofluorescence
Background Subtraction Algorithm for Biomedical Raman Spectroscopy.”
<em>Applied Spectroscopy</em>, <strong>61</strong>(11), 1225–1232.
<a href="https://doi.org/10.1366/000370207782597003">doi:10.1366/000370207782597003</a>.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/wincowgerDEV/OpenSpecy-package/">https://github.com/wincowgerDEV/OpenSpecy-package/</a>
</p>
</li>
<li> <p><a href="https://wincowger.com/OpenSpecy-package/">https://wincowger.com/OpenSpecy-package/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/wincowgerDEV/OpenSpecy-package/issues/">https://github.com/wincowgerDEV/OpenSpecy-package/issues/</a>
</p>
</li></ul>


<hr>
<h2 id='adj_intens'>Adjust spectral intensities to absorbance units.</h2><span id='topic+adj_intens'></span><span id='topic+adj_intens.default'></span><span id='topic+adj_intens.OpenSpecy'></span>

<h3>Description</h3>

<p>Converts reflectance or transmittance intensity units to absorbance units.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adj_intens(x, ...)

## Default S3 method:
adj_intens(x, ...)

## S3 method for class 'OpenSpecy'
adj_intens(x, type = "none", make_rel = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adj_intens_+3A_x">x</code></td>
<td>
<p>a list object of class <code>OpenSpecy</code>.</p>
</td></tr>
<tr><td><code id="adj_intens_+3A_type">type</code></td>
<td>
<p>a character string specifying whether the input spectrum is
in absorbance units (<code>"none"</code>, default) or needs additional conversion
from <code>"reflectance"</code> or <code>"transmittance"</code> data.</p>
</td></tr>
<tr><td><code id="adj_intens_+3A_make_rel">make_rel</code></td>
<td>
<p>logical; if <code>TRUE</code> spectra are automatically normalized
with <code><a href="#topic+make_rel">make_rel</a>()</code>.</p>
</td></tr>
<tr><td><code id="adj_intens_+3A_...">...</code></td>
<td>
<p>further arguments passed to submethods; this is
to <code><a href="#topic+adj_neg">adj_neg</a>()</code> for <code>adj_intens()</code> and
to <code><a href="#topic+conform_res">conform_res</a>()</code> for <code>conform_intens()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Many of the Open Specy functions will assume that the spectrum is in
absorbance units. For example, see <code><a href="#topic+subtr_baseline">subtr_baseline</a>()</code>.
To run those functions properly, you will need to first convert any spectra
from transmittance or reflectance to absorbance using this function.
The transmittance adjustment uses the <code class="reqn">log(1 / T)</code>
calculation which does not correct for system and particle characteristics.
The reflectance adjustment uses the Kubelka-Munk equation
<code class="reqn">(1 - R)^2 / 2R</code>. We assume that the reflectance intensity
is a percent from 1-100 and first correct the intensity by dividing by 100
so that it fits the form expected by the equation.
</p>


<h3>Value</h3>

<p><code>adj_intens()</code> returns a data frame containing two columns
named <code>"wavenumber"</code> and <code>"intensity"</code>.
</p>


<h3>Author(s)</h3>

<p>Win Cowger, Zacharias Steinmetz
</p>


<h3>See Also</h3>

<p><code><a href="#topic+subtr_baseline">subtr_baseline</a>()</code> for spectral background correction.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("raman_hdpe")

adj_intens(raman_hdpe)

</code></pre>

<hr>
<h2 id='adj_res'>Normalization and conversion of spectral data</h2><span id='topic+adj_res'></span><span id='topic+conform_res'></span><span id='topic+adj_neg'></span><span id='topic+mean_replace'></span><span id='topic+is_empty_vector'></span>

<h3>Description</h3>

<p><code>adj_res()</code> and <code>conform_res()</code> are helper functions to align
wavenumbers in terms of their spectral resolution.
<code>adj_neg()</code> converts numeric intensities <code>y</code> &lt; 1 into values &gt;= 1,
keeping absolute differences between intensity values by shifting each value
by the minimum intensity.
<code>make_rel()</code> converts intensities <code>y</code> into relative values between
0 and 1 using the standard normalization equation.
If <code>na.rm</code> is <code>TRUE</code>, missing values are removed before the
computation proceeds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adj_res(x, res = 1, fun = round)

conform_res(x, res = 5)

adj_neg(y, na.rm = FALSE)

mean_replace(y, na.rm = TRUE)

is_empty_vector(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adj_res_+3A_x">x</code></td>
<td>
<p>a numeric vector or an <span class="rlang"><b>R</b></span> object which is coercible to one by
<code>as.vector(x, "numeric")</code>; <code>x</code> should contain the spectral
wavenumbers.</p>
</td></tr>
<tr><td><code id="adj_res_+3A_res">res</code></td>
<td>
<p>spectral resolution supplied to <code>fun</code>.</p>
</td></tr>
<tr><td><code id="adj_res_+3A_fun">fun</code></td>
<td>
<p>the function to be applied to each element of <code>x</code>; defaults
to <code><a href="base.html#topic+round">round</a>()</code> to round to a specific resolution <code>res</code>.</p>
</td></tr>
<tr><td><code id="adj_res_+3A_y">y</code></td>
<td>
<p>a numeric vector containing the spectral intensities.</p>
</td></tr>
<tr><td><code id="adj_res_+3A_na.rm">na.rm</code></td>
<td>
<p>logical. Should missing values be removed?</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>adj_res()</code> and <code>conform_res()</code> are used in Open Specy to
facilitate comparisons of spectra with different resolutions.
<code>adj_neg()</code> is used to avoid errors that could arise from log
transforming spectra when using <code><a href="#topic+adj_intens">adj_intens</a>()</code> and other
functions.
<code>make_rel()</code> is used to retain the relative height proportions between
spectra while avoiding the large numbers that can result from some spectral
instruments.
</p>


<h3>Value</h3>

<p><code>adj_res()</code> and <code>conform_res()</code> return a numeric vector with
resolution-conformed wavenumbers.
<code>adj_neg()</code> and <code>make_rel()</code> return numeric vectors
with the normalized intensity data.
</p>


<h3>Author(s)</h3>

<p>Win Cowger, Zacharias Steinmetz
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+min">min</a>()</code> and <code><a href="base.html#topic+round">round</a>()</code>;
<code><a href="#topic+adj_intens">adj_intens</a>()</code> for log transformation functions;
<code><a href="#topic+conform_spec">conform_spec</a>()</code> for conforming wavenumbers of an
<code>OpenSpecy</code> object to be matched with a reference library
</p>


<h3>Examples</h3>

<pre><code class='language-R'>adj_res(seq(500, 4000, 4), 5)
conform_res(seq(500, 4000, 4))
adj_neg(c(-1000, -1, 0, 1, 10))
make_rel(c(-1000, -1, 0, 1, 10))

</code></pre>

<hr>
<h2 id='adj_wave'>Adjust wavelength to wavenumbers for Raman</h2><span id='topic+adj_wave'></span><span id='topic+adj_wave.default'></span><span id='topic+adj_wave.OpenSpecy'></span>

<h3>Description</h3>

<p>Functions for converting between wave* units.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adj_wave(x, ...)

## Default S3 method:
adj_wave(x, laser, ...)

## S3 method for class 'OpenSpecy'
adj_wave(x, laser, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adj_wave_+3A_x">x</code></td>
<td>
<p>an <code>OpenSpecy</code> object with wavenumber units specified as
wavelength in nm or a wavelength vector.</p>
</td></tr>
<tr><td><code id="adj_wave_+3A_laser">laser</code></td>
<td>
<p>the wavelength in nm of the Raman laser.</p>
</td></tr>
<tr><td><code id="adj_wave_+3A_...">...</code></td>
<td>
<p>additional arguments passed to submethods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>OpenSpecy</code> object with new units converted from wavelength
to wavenumbers or a vector with the same conversion.
</p>


<h3>Author(s)</h3>

<p>Win Cowger, Zacharias Steinmetz
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("raman_hdpe")
raman_wavelength &lt;- raman_hdpe
raman_wavelength$wavenumber &lt;- (-1*(raman_wavelength$wavenumber/10^7-1/530))^(-1)
adj_wave(raman_wavelength, laser = 530)
adj_wave(raman_wavelength$wavenumber, laser = 530)

</code></pre>

<hr>
<h2 id='as_OpenSpecy'>Create <code>OpenSpecy</code> objects</h2><span id='topic+as_OpenSpecy'></span><span id='topic+as_OpenSpecy.OpenSpecy'></span><span id='topic+as_OpenSpecy.list'></span><span id='topic+as_OpenSpecy.hyperSpec'></span><span id='topic+as_OpenSpecy.data.frame'></span><span id='topic+as_OpenSpecy.default'></span><span id='topic+is_OpenSpecy'></span><span id='topic+check_OpenSpecy'></span><span id='topic+OpenSpecy'></span><span id='topic+gen_grid'></span>

<h3>Description</h3>

<p>Functions to check if an object is an OpenSpecy, or coerce it if
possible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_OpenSpecy(x, ...)

## S3 method for class 'OpenSpecy'
as_OpenSpecy(x, session_id = FALSE, ...)

## S3 method for class 'list'
as_OpenSpecy(x, ...)

## S3 method for class 'hyperSpec'
as_OpenSpecy(x, ...)

## S3 method for class 'data.frame'
as_OpenSpecy(x, colnames = list(wavenumber = NULL, spectra = NULL), ...)

## Default S3 method:
as_OpenSpecy(
  x,
  spectra,
  metadata = list(file_name = NULL, user_name = NULL, contact_info = NULL, organization =
    NULL, citation = NULL, spectrum_type = NULL, spectrum_identity = NULL, material_form
    = NULL, material_phase = NULL, material_producer = NULL, material_purity = NULL,
    material_quality = NULL, material_color = NULL, material_other = NULL, cas_number =
    NULL, instrument_used = NULL, instrument_accessories = NULL, instrument_mode = NULL,
    intensity_units = NULL, spectral_resolution = NULL, laser_light_used = NULL,
    number_of_accumulations = NULL, 
     total_acquisition_time_s = NULL,
    data_processing_procedure = NULL, level_of_confidence_in_identification = NULL,
    other_info = NULL, license = "CC BY-NC"),
  attributes = list(intensity_unit = NULL, derivative_order = NULL, baseline = NULL,
    spectra_type = NULL),
  coords = "gen_grid",
  session_id = FALSE,
  ...
)

is_OpenSpecy(x)

check_OpenSpecy(x)

OpenSpecy(x, ...)

gen_grid(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_OpenSpecy_+3A_x">x</code></td>
<td>
<p>depending on the method, a list with all OpenSpecy parameters,
a vector with the wavenumbers for all spectra, or a data.frame with a full
spectrum in the classic Open Specy format.</p>
</td></tr>
<tr><td><code id="as_OpenSpecy_+3A_session_id">session_id</code></td>
<td>
<p>logical. Whether to add a session ID to the metadata.
The session ID is based on current session info so metadata of the same
spectra will not return equal if session info changes. Sometimes that is
desirable.</p>
</td></tr>
<tr><td><code id="as_OpenSpecy_+3A_colnames">colnames</code></td>
<td>
<p>names of the wavenumber column and spectra column, makes
assumptions based on column names or placement if <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="as_OpenSpecy_+3A_spectra">spectra</code></td>
<td>
<p>spectral intensities formatted as a data.table with one column
per spectrum.</p>
</td></tr>
<tr><td><code id="as_OpenSpecy_+3A_metadata">metadata</code></td>
<td>
<p>metadata for each spectrum with one row per spectrum,
see details.</p>
</td></tr>
<tr><td><code id="as_OpenSpecy_+3A_attributes">attributes</code></td>
<td>
<p>a list of attributes describing critical aspects for interpreting the spectra.
see details.</p>
</td></tr>
<tr><td><code id="as_OpenSpecy_+3A_coords">coords</code></td>
<td>
<p>spatial coordinates for the spectra.</p>
</td></tr>
<tr><td><code id="as_OpenSpecy_+3A_n">n</code></td>
<td>
<p>number of spectra to generate the spatial coordinate grid with.</p>
</td></tr>
<tr><td><code id="as_OpenSpecy_+3A_...">...</code></td>
<td>
<p>additional arguments passed to submethods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>as_OpenSpecy()</code> converts spectral datasets to a three part list;
the first with a vector of the wavenumbers of the spectra,
the second with a <code>data.table</code> of all spectral intensities ordered as
columns,
the third item is another <code>data.table</code> with any metadata the user
provides or is harvested from the files themselves.
</p>
<p>The <code>metadata</code> argument may contain a named list with the following
details (<code>*</code> = minimum recommended).
</p>

<dl>
<dt><code style="white-space: pre;">&#8288;file_name*&#8288;</code></dt><dd><p>The file name, defaults to
<code><a href="base.html#topic+basename">basename</a>()</code> if not specified</p>
</dd>
<dt><code style="white-space: pre;">&#8288;user_name*&#8288;</code></dt><dd><p>User name, e.g. &quot;Win Cowger&quot;</p>
</dd>
<dt><code>contact_info</code></dt><dd><p>Contact information, e.g. &quot;1-513-673-8956,
wincowger@gmail.com&quot;</p>
</dd>
<dt><code>organization</code></dt><dd><p>Affiliation, e.g. &quot;University of California,
Riverside&quot;</p>
</dd>
<dt><code>citation</code></dt><dd><p>Data citation, e.g. &quot;Primpke, S., Wirth, M., Lorenz, C.,
&amp; Gerdts, G. (2018). Reference database design for the automated analysis
of microplastic samples based on Fourier transform infrared (FTIR)
spectroscopy. <em>Analytical and Bioanalytical Chemistry</em>.
<a href="https://doi.org/10.1007/s00216-018-1156-x">doi:10.1007/s00216-018-1156-x</a>&quot;</p>
</dd>
<dt><code style="white-space: pre;">&#8288;spectrum_type*&#8288;</code></dt><dd><p>Raman or FTIR</p>
</dd>
<dt><code style="white-space: pre;">&#8288;spectrum_identity*&#8288;</code></dt><dd><p>Material/polymer analyzed, e.g.
&quot;Polystyrene&quot;</p>
</dd>
<dt><code>material_form</code></dt><dd><p>Form of the material analyzed, e.g. textile fiber,
rubber band, sphere, granule </p>
</dd>
<dt><code>material_phase</code></dt><dd><p>Phase of the material analyzed (liquid, gas, solid) </p>
</dd>
<dt><code>material_producer</code></dt><dd><p>Producer of the material analyzed, e.g. Dow </p>
</dd>
<dt><code>material_purity</code></dt><dd><p>Purity of the material analyzed, e.g. 99.98%</p>
</dd>
<dt><code>material_quality</code></dt><dd><p>Quality of the material analyzed, e.g.
consumer product, manufacturer material, analytical standard,
environmental sample </p>
</dd>
<dt><code>material_color</code></dt><dd><p>Color of the material analyzed,
e.g. blue, #0000ff, (0, 0, 255) </p>
</dd>
<dt>material_other</dt><dd><p>Other material description, e.g. 5 µm diameter
fibers, 1 mm spherical particles </p>
</dd>
<dt><code>cas_number</code></dt><dd><p>CAS number, e.g. 9003-53-6 </p>
</dd>
<dt><code>instrument_used</code></dt><dd><p>Instrument used, e.g. Horiba LabRam </p>
</dd>
<dt>instrument_accessories</dt><dd><p>Instrument accessories, e.g.
Focal Plane Array, CCD</p>
</dd>
<dt><code>instrument_mode</code></dt><dd><p>Instrument modes/settings, e.g.
transmission, reflectance </p>
</dd>
<dt><code style="white-space: pre;">&#8288;intensity_units*&#8288;</code></dt><dd><p>Units of the intensity values for the spectrum,
options transmittance, reflectance, absorbance </p>
</dd>
<dt><code>spectral_resolution</code></dt><dd><p>Spectral resolution, e.g. 4/cm </p>
</dd>
<dt><code>laser_light_used</code></dt><dd><p>Wavelength of the laser/light used, e.g.
785 nm </p>
</dd>
<dt><code>number_of_accumulations</code></dt><dd><p>Number of accumulations, e.g 5 </p>
</dd>
<dt><code>total_acquisition_time_s</code></dt><dd><p>Total acquisition time (s), e.g. 10 s</p>
</dd>
<dt><code>data_processing_procedure</code></dt><dd><p>Data processing procedure,
e.g. spikefilter, baseline correction, none </p>
</dd>
<dt><code>level_of_confidence_in_identification</code></dt><dd><p>Level of confidence in
identification, e.g. 99% </p>
</dd>
<dt><code>other_info</code></dt><dd><p>Other information </p>
</dd>
<dt><code>license</code></dt><dd><p>The license of the shared spectrum; defaults to
<code>"CC BY-NC"</code> (see <a href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</a>
for details). Any other creative commons license is allowed, for example,
CC0 or CC BY</p>
</dd>
<dt><code>session_id</code></dt><dd><p>A unique user and session identifier; populated
automatically with <code>paste(digest(Sys.info()), digest(sessionInfo()),
  sep = "/")</code></p>
</dd>
<dt><code>file_id</code></dt><dd><p>A unique file identifier; populated automatically
with <code>digest(object[c("wavenumber", "spectra")])</code></p>
</dd>
</dl>

<p>The <code>attributes</code> argument may contain a named list with the following
details, when set, they will be used to automate transformations and warning messages:
</p>

<dl>
<dt><code>intensity_units</code></dt><dd><p>supported options include <code>"absorbance"</code>,
<code>"transmittance"</code>, or <code>"reflectance"</code></p>
</dd>
<dt><code>derivative_order</code></dt><dd><p>supported options include <code>"0"</code>, <code>"1"</code>, or
<code>"2"</code></p>
</dd>
<dt><code>baseline</code></dt><dd><p>supported options include <code>"raw"</code> or <code>"nobaseline"</code></p>
</dd>
<dt><code>spectra_type</code></dt><dd><p>supported options include <code>"ftir"</code> or <code>"raman"</code></p>
</dd>
</dl>



<h3>Value</h3>

<p><code>as_OpenSpecy()</code> and <code>OpenSpecy()</code> returns three part lists
described in details.
<code>is_OpenSpecy()</code> returns <code>TRUE</code> if the object is an OpenSpecy and
<code>FALSE</code> if not.
<code>gen_grid()</code> returns a <code>data.table</code> with <code>x</code> and <code>y</code>
coordinates to use for generating a spatial grid for the spectra if one is
not specified in the data.
</p>


<h3>Author(s)</h3>

<p>Zacharias Steinmetz, Win Cowger
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read_spec">read_spec</a>()</code> for reading <code>OpenSpecy</code> objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("raman_hdpe")

# Inspect the spectra
raman_hdpe # see how OpenSpecy objects print.
raman_hdpe$wavenumber # look at just the wavenumbers of the spectra.
raman_hdpe$spectra # look at just the spectral intensities data.table.
raman_hdpe$metadata # look at just the metadata of the spectra.

# Creating a list and transforming to OpenSpecy
as_OpenSpecy(list(wavenumber = raman_hdpe$wavenumber,
                  spectra = raman_hdpe$spectra,
                  metadata = raman_hdpe$metadata[,-c("x", "y")]))

# If you try to produce an OpenSpecy using an OpenSpecy it will just return
# the same object.
as_OpenSpecy(raman_hdpe)

# Creating an OpenSpecy from a data.frame
as_OpenSpecy(x = data.frame(wavenumber = raman_hdpe$wavenumber,
                            spectra = raman_hdpe$spectra$intensity))

# Test that the spectrum is formatted as an OpenSpecy object.
is_OpenSpecy(raman_hdpe)
is_OpenSpecy(raman_hdpe$spectra)

</code></pre>

<hr>
<h2 id='c_spec'>Manage spectral objects</h2><span id='topic+c_spec'></span><span id='topic+c_spec.default'></span><span id='topic+c_spec.OpenSpecy'></span><span id='topic+c_spec.list'></span><span id='topic+sample_spec'></span><span id='topic+sample_spec.default'></span><span id='topic+sample_spec.OpenSpecy'></span><span id='topic+merge_map'></span><span id='topic+merge_map.default'></span><span id='topic+merge_map.OpenSpecy'></span><span id='topic+merge_map.list'></span>

<h3>Description</h3>

<p><code>c_spec()</code> concatenates <code>OpenSpecy</code> objects.
<code>sample_spec()</code> samples spectra from an <code>OpenSpecy</code> object.
<code>merge_map()</code> merge two <code>OpenSpecy</code> objects from spectral maps.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>c_spec(x, ...)

## Default S3 method:
c_spec(x, ...)

## S3 method for class 'OpenSpecy'
c_spec(x, ...)

## S3 method for class 'list'
c_spec(x, range = NULL, res = 5, ...)

sample_spec(x, ...)

## Default S3 method:
sample_spec(x, ...)

## S3 method for class 'OpenSpecy'
sample_spec(x, size = 1, prob = NULL, ...)

merge_map(x, ...)

## Default S3 method:
merge_map(x, ...)

## S3 method for class 'OpenSpecy'
merge_map(x, ...)

## S3 method for class 'list'
merge_map(x, origins = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="c_spec_+3A_x">x</code></td>
<td>
<p>a list of <code>OpenSpecy</code> objects or of file paths.</p>
</td></tr>
<tr><td><code id="c_spec_+3A_range">range</code></td>
<td>
<p>a numeric providing your own wavenumber ranges or character
argument called <code>"common"</code> to let <code>c_spec()</code> find the common
wavenumber range of the supplied spectra. <code>NULL</code> will interpret the
spectra having all the same wavenumber range.</p>
</td></tr>
<tr><td><code id="c_spec_+3A_res">res</code></td>
<td>
<p>defaults to <code>NULL</code>, the resolution you want the output
wavenumbers to be.</p>
</td></tr>
<tr><td><code id="c_spec_+3A_size">size</code></td>
<td>
<p>the number of spectra to sample.</p>
</td></tr>
<tr><td><code id="c_spec_+3A_prob">prob</code></td>
<td>
<p>probabilities to use for the sampling.</p>
</td></tr>
<tr><td><code id="c_spec_+3A_origins">origins</code></td>
<td>
<p>a list with 2 value vectors of x y coordinates for the offsets of each image.</p>
</td></tr>
<tr><td><code id="c_spec_+3A_...">...</code></td>
<td>
<p>further arguments passed to submethods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>c_spec()</code> and <code>sample_spec()</code> return <code>OpenSpecy</code> objects.
</p>


<h3>Author(s)</h3>

<p>Zacharias Steinmetz, Win Cowger
</p>


<h3>See Also</h3>

<p><code><a href="#topic+conform_spec">conform_spec</a>()</code> for conforming wavenumbers
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Concatenating spectra
spectra &lt;- lapply(c(read_extdata("raman_hdpe.csv"),
                    read_extdata("ftir_ldpe_soil.asp")), read_any)
common &lt;- c_spec(spectra, range = "common", res = 5)
range &lt;- c_spec(spectra, range = c(1000, 2000), res = 5)

# Sampling spectra
tiny_map &lt;- read_any(read_extdata("CA_tiny_map.zip"))
sampled &lt;- sample_spec(tiny_map, size = 3)

</code></pre>

<hr>
<h2 id='check_lib'>Manage spectral libraries</h2><span id='topic+check_lib'></span><span id='topic+get_lib'></span><span id='topic+load_lib'></span><span id='topic+rm_lib'></span>

<h3>Description</h3>

<p>These functions will import the spectral libraries from Open Specy if they
were not already downloaded. The CRAN does not allow for deployment of large
datasets so this was a workaround that we are using to make sure everyone can
easily get Open Specy functionality running on their desktop. Please see the
references when using these libraries. These libraries are the accumulation
of a massive amount of effort from independant groups and each should be
attributed when you are using their data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_lib(
  type = c("derivative", "nobaseline", "raw", "mediod", "model"),
  path = "system",
  condition = "warning"
)

get_lib(
  type = c("derivative", "nobaseline", "raw", "mediod", "model"),
  path = "system",
  node = "x7dpz",
  conflicts = "overwrite",
  ...
)

load_lib(type, path = "system")

rm_lib(
  type = c("derivative", "nobaseline", "raw", "mediod", "model"),
  path = "system"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_lib_+3A_type">type</code></td>
<td>
<p>library type to check/retrieve; defaults to
<code>c("derivative", "nobaseline", "raw", "mediod", "model")</code> which reads
everything.</p>
</td></tr>
<tr><td><code id="check_lib_+3A_path">path</code></td>
<td>
<p>where to save or look for local library files; defaults to
<code>"system"</code> pointing to
<code>system.file("extdata", package = "OpenSpecy")</code>.</p>
</td></tr>
<tr><td><code id="check_lib_+3A_condition">condition</code></td>
<td>
<p>determines if <code>check_lib()</code> should warn
(<code>"warning"</code>, the default) or throw and error (<code>"error"</code>).</p>
</td></tr>
<tr><td><code id="check_lib_+3A_node">node</code></td>
<td>
<p>the OSF node to be retrieved; should be <code>"x7dpz"</code> unless you
maintain your own OSF node with spectral libraries.</p>
</td></tr>
<tr><td><code id="check_lib_+3A_conflicts">conflicts</code></td>
<td>
<p>determines what happens when a file with the same name
exists at the specified destination. Can be one of the following (see
<code><a href="osfr.html#topic+osf_download">osf_download</a>()</code> for details):
</p>

<dl>
<dt>&quot;error&quot;</dt><dd><p>throw an error and abort the file transfer operation.</p>
</dd>
<dt>&quot;skip&quot;</dt><dd><p>skip the conflicting file(s) and continue transferring the
remaining files.</p>
</dd>
<dt>&quot;overwrite&quot; (default)</dt><dd><p> replace the existing file with the
transferred copy.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="check_lib_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="osfr.html#topic+osf_download">osf_download</a>()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>check_lib()</code> checks to see if the Open Specy reference library
already exists on the users computer.
<code>get_lib()</code> downloads the Open Specy library from OSF
(<a href="https://doi.org/10.17605/OSF.IO/X7DPZ">doi:10.17605/OSF.IO/X7DPZ</a>).
<code>load_lib()</code> will load the library into the global environment for use
with the Open Specy functions.
<code>rm_lib()</code> removes the libraries from your computer.
</p>


<h3>Value</h3>

<p><code>check_lib()</code> and <code>get_lib()</code> return messages only;
<code>load_lib()</code> returns an <code>OpenSpecy</code> object containing the
respective spectral reference library.
</p>


<h3>Author(s)</h3>

<p>Zacharias Steinmetz, Win Cowger
</p>


<h3>References</h3>

<p>Bell IB, Clark RJH, Gibbs PJ (2010). “Raman Spectroscopic Library.”
<em>Christopher Ingold Laboratories, University College London, UK</em>.
<a href="https://www.chem.ucl.ac.uk/resources/raman/">https://www.chem.ucl.ac.uk/resources/raman/</a>.
</p>
<p>Berzinš K, Sales RE, Barnsley JE, Walker G, Fraser-Miller SJ, Gordon KC
(2020). “Low-Wavenumber Raman Spectral Database of Pharmaceutical
Excipients.” <em>Vibrational Spectroscopy</em> <strong>107</strong>, 103021.
<a href="https://doi.org/10.5281/zenodo.3614035">doi:10.5281/zenodo.3614035</a>.
</p>
<p>Cabernard L, Roscher L, Lorenz C, Gerdts G, Primpke S (2018). “Comparison of
Raman and Fourier Transform Infrared Spectroscopy for the Quantification of
Microplastics in the Aquatic Environment.” <em>Environmental Science &amp;
Technology</em> <strong>52</strong>(22), 13279&ndash;13288. <a href="https://doi.org/10.1021/acs.est.8b03438">doi:10.1021/acs.est.8b03438</a>.
</p>
<p>Caggiani MC, Cosentino A, Mangone A (2016). “Pigments Checker version 3.0, a
handy set for conservation scientists: A free online Raman spectra database.”
<em>Microchemical Journal</em> <strong>129</strong>, 123&ndash;132.
<a href="https://doi.org/10.1016/j.microc.2016.06.020">doi:10.1016/j.microc.2016.06.020</a>.
</p>
<p>Chabuka BK, Kalivas JH (2020). “Application of a Hybrid Fusion Classification
Process for Identification of Microplastics Based on Fourier Transform
Infrared Spectroscopy. Applied Spectroscopy.” <em>Applied Spectroscopy</em>
<strong>74</strong>(9), 1167&ndash;1183. <a href="https://doi.org/10.1177/0003702820923993">doi:10.1177/0003702820923993</a>.
</p>
<p>Cowger, W (2023). “Library data.” <em>OSF</em>. <a href="https://doi.org/10.17605/OSF.IO/X7DPZ">doi:10.17605/OSF.IO/X7DPZ</a>.
</p>
<p>Cowger W, Gray A, Christiansen SH, De Frond H, Deshpande AD, Hemabessiere L,
Lee E, Mill L, et al. (2020). “Critical Review of Processing and
Classification Techniques for Images and Spectra in Microplastic Research.”
<em>Applied Spectroscopy</em>, <strong>74</strong>(9), 989&ndash;1010.
<a href="https://doi.org/10.1177/0003702820929064">doi:10.1177/0003702820929064</a>.
</p>
<p>Cowger W, Roscher L, Chamas A, Maurer B, Gehrke L, Jebens H, Gerdts G,
Primpke S (2023). “High Throughput FTIR Analysis of Macro and Microplastics
with Plate Readers.” <em>ChemRxiv Preprint</em>. <a href="https://doi.org/10.26434/chemrxiv-2023-x88ss">doi:10.26434/chemrxiv-2023-x88ss</a>.
</p>
<p>De Frond H, Rubinovitz R, Rochman CM (2021). “µATR-FTIR Spectral Libraries of
Plastic Particles (FLOPP and FLOPP-e) for the Analysis of Microplastics.”
<em>Analytical Chemistry</em> <strong>93</strong>(48), 15878&ndash;15885.
<a href="https://doi.org/10.1021/acs.analchem.1c02549">doi:10.1021/acs.analchem.1c02549</a>.
</p>
<p>El Mendili Y, Vaitkus A, Merkys A, Gražulis S, Chateigner D, Mathevet F,
Gascoin S, Petit S, Bardeau JF, Zanatta M, Secchi M, Mariotto G, Kumar A,
Cassetta M, Lutterotti L, Borovin E, Orberger B, Simon P, Hehlen B,
Le Guen M (2019). “Raman Open Database: first interconnected Raman–X-ray
diffraction open-access resource for material identification.” <em>Journal of
Applied Crystallography</em>, <strong>52</strong>(3), 618&ndash;625.
<a href="https://doi.org/10.1107/s1600576719004229">doi:10.1107/s1600576719004229</a>.
</p>
<p>Johnson TJ, Blake TA, Brauer CS, Su YF, Bernacki BE, Myers TL, Tonkyn RG,
Kunkel BM, Ertel AB (2015). “Reflectance Spectroscopy for Sample
Identification: Considerations for Quantitative Library
Results at Infrared Wavelengths.” <em>International Conference on Advanced
Vibrational Spectroscopy (ICAVS 8)</em>.
<a href="https://www.osti.gov/biblio/1452877">https://www.osti.gov/biblio/1452877</a>.
</p>
<p>Lafuente R, Downs RT, Yang H, Stone N (2016). “The power of databases: The
RRUFF project.” <em>Highlights in Mineralogical Crystallography</em>.
<a href="https://doi.org/10.1515/9783110417104-003">doi:10.1515/9783110417104-003</a>.
</p>
<p>Munno K, De Frond H, O’Donnell B, Rochman CM (2020). “Increasing the
Accessibility for Characterizing Microplastics: Introducing New
Application-Based and Spectral Libraries of Plastic Particles (SLoPP and
SLoPP-E).” <em>Analytical Chemistry</em> <strong>92</strong>(3), 2443&ndash;2451.
<a href="https://doi.org/10.1021/acs.analchem.9b03626">doi:10.1021/acs.analchem.9b03626</a>.
</p>
<p>Myers TL, Brauer CS, Su YF, Blake TA, Johnson TJ, Richardson RL (2014).
“The influence of particle size on infrared reflectance spectra.”
<em>Proceedings Volume 9088, Algorithms and Technologies for Multispectral,
Hyperspectral, and Ultraspectral Imagery XX</em>, 908809.
<a href="https://doi.org/10.1117/12.2053350">doi:10.1117/12.2053350</a>.
</p>
<p>Myers TL, Brauer CS, Su YF, Blake TA, Tonkyn RG, Ertel AB, Johnson TJ,
Richardson RL (2015). “Quantitative reflectance spectra of solid powders
as a function of particle size.” <em>Applied Optics</em> <strong>54</strong>(15), 4863&ndash;4875.
<a href="https://doi.org/10.1364/ao.54.004863">doi:10.1364/ao.54.004863</a>.
</p>
<p>Primpke S, Wirth M, Lorenz C, Gerdts G (2018). “Reference database design
for the automated analysis of microplastic samples based on Fourier
transform infrared (FTIR) spectroscopy.”
<em>Analytical and Bioanalytical Chemistry</em> <strong>410</strong>, 5131–-5141.
<a href="https://doi.org/10.1007/s00216-018-1156-x">doi:10.1007/s00216-018-1156-x</a>.
</p>
<p>Roscher L, Fehres A, Reisel L, Halbach M, Scholz-Böttcher B, Gerriets M,
Badewien TH, Shiravani G, Wurpts A, Primpke S, Gerdts G (2021). “Abundances
of large microplastics (L-MP, 500-5000 µm) in surface waters of the Weser
estuary and the German North Sea.” <em>PANGAEA</em>. <a href="https://doi.org/10.1594/PANGAEA.938143">doi:10.1594/PANGAEA.938143</a>.
</p>
<p>“Handbook of Raman Spectra for geology” (2023).
<a href="http://www.geologie-lyon.fr/Raman/">http://www.geologie-lyon.fr/Raman/</a>.
</p>
<p>“Scientific Workgroup for the Analysis of Seized Drugs.” (2023).
https://swgdrug.org/ir.htm.
</p>
<p><strong>Further contribution of spectra:</strong>
Suja Sukumaran (Thermo Fisher Scientific),
Aline Carvalho,
Jennifer Lynch (NIST),
Claudia Cella and Dora Mehn (JRC),
Horiba Scientific,
USDA Soil Characterization Data
(<a href="https://ncsslabdatamart.sc.egov.usda.gov">https://ncsslabdatamart.sc.egov.usda.gov</a>),
Archaeometrielabor,
and S.B. Engelsen (Royal Vet. and Agricultural University, Denmark).
Kimmel Center data was collected and provided by Prof. Steven Weiner
(Kimmel Center for Archaeological Science, Weizmann Institute of Science,
Israel).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
check_lib("derivative")
get_lib("derivative")

spec_lib &lt;- load_lib("derivative")

## End(Not run)

</code></pre>

<hr>
<h2 id='collapse_spec'>Define features</h2><span id='topic+collapse_spec'></span><span id='topic+collapse_spec.default'></span><span id='topic+collapse_spec.OpenSpecy'></span><span id='topic+def_features'></span><span id='topic+def_features.default'></span><span id='topic+def_features.OpenSpecy'></span>

<h3>Description</h3>

<p>Functions for analyzing features, like particles, fragments, or fibers, in
spectral map oriented <code>OpenSpecy</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>collapse_spec(x, ...)

## Default S3 method:
collapse_spec(x, ...)

## S3 method for class 'OpenSpecy'
collapse_spec(x, ...)

def_features(x, ...)

## Default S3 method:
def_features(x, ...)

## S3 method for class 'OpenSpecy'
def_features(
  x,
  features,
  shape_kernel = c(3, 3),
  shape_type = "box",
  close = F,
  close_kernel = c(4, 4),
  close_type = "box",
  img = NULL,
  bottom_left = NULL,
  top_right = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="collapse_spec_+3A_x">x</code></td>
<td>
<p>an <code>OpenSpecy</code> object</p>
</td></tr>
<tr><td><code id="collapse_spec_+3A_features">features</code></td>
<td>
<p>a logical vector or character vector describing which of the
spectra are of features (<code>TRUE</code>) and which are not (<code>FALSE</code>).
If a character vector is provided, it should represent the different feature
types present in the spectra.</p>
</td></tr>
<tr><td><code id="collapse_spec_+3A_shape_kernel">shape_kernel</code></td>
<td>
<p>the width and height of the area in pixels to search for
connecting features, c(3,3) is typically used but larger numbers will smooth
connections between particles more.</p>
</td></tr>
<tr><td><code id="collapse_spec_+3A_shape_type">shape_type</code></td>
<td>
<p>character, options are for the shape used to find connections c(&quot;box&quot;, &quot;disc&quot;, &quot;diamond&quot;)</p>
</td></tr>
<tr><td><code id="collapse_spec_+3A_close">close</code></td>
<td>
<p>logical, whether a closing should be performed using the shape kernel before
estimating components.</p>
</td></tr>
<tr><td><code id="collapse_spec_+3A_close_kernel">close_kernel</code></td>
<td>
<p>width and height of the area to close if using the close option.</p>
</td></tr>
<tr><td><code id="collapse_spec_+3A_close_type">close_type</code></td>
<td>
<p>character, options are for the shape used to find connections c(&quot;box&quot;, &quot;disc&quot;, &quot;diamond&quot;)</p>
</td></tr>
<tr><td><code id="collapse_spec_+3A_img">img</code></td>
<td>
<p>a file location where a visual image is that corresponds to the spectral image.</p>
</td></tr>
<tr><td><code id="collapse_spec_+3A_bottom_left">bottom_left</code></td>
<td>
<p>a two value vector specifying the x,y location in image pixels where
the bottom left of the spectral map begins. y values are from the top down while
x values are left to right.</p>
</td></tr>
<tr><td><code id="collapse_spec_+3A_top_right">top_right</code></td>
<td>
<p>a two value vector specifying the x,y location in the visual image
pixels where the top right of the spectral map extent is. y values are from
the top down while x values are left to right.</p>
</td></tr>
<tr><td><code id="collapse_spec_+3A_...">...</code></td>
<td>
<p>additional arguments passed to subfunctions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>def_features()</code> accepts an <code>OpenSpecy</code> object and a logical or
character vector describing which pixels correspond to particles.
<code>collapse_spec()</code> takes an <code>OpenSpecy</code> object with particle-specific
metadata (from <code>def_features()</code>) and collapses the spectra to median
intensities for each unique particle.
It also updates the metadata with centroid coordinates, while preserving the
feature information on area and Feret max.
</p>


<h3>Value</h3>

<p>An <code>OpenSpecy</code> object appended with metadata about the features or
collapsed for the features. All units are in pixels. Metadata described below.
</p>

<dl>
<dt><code>x</code></dt><dd><p>x coordinate of the pixel or centroid if collapsed</p>
</dd>
<dt><code>y</code></dt><dd><p>y coordinate of the pixel or centroid if collapsed</p>
</dd>
<dt><code>feature_id</code></dt><dd><p>unique identifier of each feature</p>
</dd>
<dt><code>area</code></dt><dd><p>area in pixels of the feature</p>
</dd>
<dt><code>perimeter</code></dt><dd><p>perimeter of the convex hull of the feature</p>
</dd>
<dt><code>feret_min</code></dt><dd><p>feret_max divided by the area</p>
</dd>
<dt><code>feret_max</code></dt><dd><p>largest dimension of the convex hull of the feature</p>
</dd>
<dt><code>convex_hull_area</code></dt><dd><p>area of the convex hull</p>
</dd>
<dt><code>centroid_x</code></dt><dd><p>mean x coordinate of the feature</p>
</dd>
<dt><code>centroid_y</code></dt><dd><p>mean y coordinate of the feature</p>
</dd>
<dt><code>first_x</code></dt><dd><p>first x coordinate of the feature</p>
</dd>
<dt><code>first_y</code></dt><dd><p>first y coordinate of the feature</p>
</dd>
<dt><code>rand_x</code></dt><dd><p>random x coordinate from the feature</p>
</dd>
<dt><code>rand_y</code></dt><dd><p>random y coordinate from the feature</p>
</dd>
<dt><code>r</code></dt><dd><p>if using visual imagery overlay, the red band value at that location</p>
</dd>
<dt><code>g</code></dt><dd><p>if using visual imagery overlay, the green band value at that location</p>
</dd>
<dt><code>b</code></dt><dd><p>if using visual imagery overlay, the blue band value at that location</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Win Cowger, Zacharias Steinmetz
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
tiny_map &lt;- read_extdata("CA_tiny_map.zip") |&gt; read_any()
identified_map &lt;- def_features(tiny_map, tiny_map$metadata$x == 0)
collapse_spec(identified_map)

</code></pre>

<hr>
<h2 id='conform_spec'>Conform spectra to a standard wavenumber series</h2><span id='topic+conform_spec'></span><span id='topic+conform_spec.default'></span><span id='topic+conform_spec.OpenSpecy'></span>

<h3>Description</h3>

<p>Spectra can be conformed to a standard suite of wavenumbers to be compared
with a reference library or to be merged to other spectra.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conform_spec(x, ...)

## Default S3 method:
conform_spec(x, ...)

## S3 method for class 'OpenSpecy'
conform_spec(x, range = NULL, res = 5, allow_na = F, type = "interp", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="conform_spec_+3A_x">x</code></td>
<td>
<p>a list object of class <code>OpenSpecy</code>.</p>
</td></tr>
<tr><td><code id="conform_spec_+3A_range">range</code></td>
<td>
<p>a vector of new wavenumber values, can be just supplied as a
min and max value.</p>
</td></tr>
<tr><td><code id="conform_spec_+3A_res">res</code></td>
<td>
<p>spectral resolution adjusted to or <code>NULL</code> if the raw range
should be used.</p>
</td></tr>
<tr><td><code id="conform_spec_+3A_allow_na">allow_na</code></td>
<td>
<p>logical; should NA values in places beyond the wavenumbers
of the dataset be allowed?</p>
</td></tr>
<tr><td><code id="conform_spec_+3A_type">type</code></td>
<td>
<p>the type of wavenumber adjustment to make. <code>"interp"</code>
results in linear interpolation while <code>"roll"</code> conducts a nearest
rolling join of the wavenumbers. <code>"mean_up"</code> only works when
Spectra are being aggregated, we take the mean of the intensities within the
wavenumber specified. This can maintain smaller peaks and make spectra more
similar to it's less resolved relatives. mean_up option is still experimental.</p>
</td></tr>
<tr><td><code id="conform_spec_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="stats.html#topic+approx">approx</a>()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>adj_intens()</code> returns a data frame containing two columns
named <code>"wavenumber"</code> and <code>"intensity"</code>
</p>


<h3>Author(s)</h3>

<p>Win Cowger, Zacharias Steinmetz
</p>


<h3>See Also</h3>

<p><code><a href="#topic+restrict_range">restrict_range</a>()</code> and  <code><a href="#topic+flatten_range">flatten_range</a>()</code> for
adjusting wavenumber ranges;
<code><a href="#topic+subtr_baseline">subtr_baseline</a>()</code> for spectral background correction
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("raman_hdpe")
conform_spec(raman_hdpe, c(1000, 2000))

</code></pre>

<hr>
<h2 id='cor_spec'>Identify and filter spectra</h2><span id='topic+cor_spec'></span><span id='topic+cor_spec.default'></span><span id='topic+cor_spec.OpenSpecy'></span><span id='topic+match_spec'></span><span id='topic+match_spec.default'></span><span id='topic+match_spec.OpenSpecy'></span><span id='topic+ident_spec'></span><span id='topic+get_metadata'></span><span id='topic+get_metadata.default'></span><span id='topic+get_metadata.OpenSpecy'></span><span id='topic+max_cor_named'></span><span id='topic+filter_spec'></span><span id='topic+filter_spec.default'></span><span id='topic+filter_spec.OpenSpecy'></span><span id='topic+ai_classify'></span><span id='topic+ai_classify.default'></span><span id='topic+ai_classify.OpenSpecy'></span><span id='topic+fill_spec'></span><span id='topic+fill_spec.default'></span><span id='topic+fill_spec.OpenSpecy'></span><span id='topic+os_similarity'></span><span id='topic+os_similarity.default'></span><span id='topic+os_similarity.OpenSpecy'></span>

<h3>Description</h3>

<p><code>match_spec()</code> joins two <code>OpenSpecy</code> objects and their metadata
based on similarity.
<code>cor_spec()</code> correlates two <code>OpenSpecy</code> objects, typically one with
knowns and one with unknowns.
<code>ident_spec()</code> retrieves the top match values from a correlation matrix
and formats them with metadata.
<code>get_metadata()</code> retrieves metadata from OpenSpecy objects.
<code>max_cor_named()</code> formats the top correlation values from a correlation
matrix as a named vector.
<code>filter_spec()</code> filters an Open Specy object.
<code>fill_spec()</code> adds filler values to an <code>OpenSpecy</code> object where it doesn't have intensities.
<code>os_similarity()</code> EXPERIMENTAL, returns a single similarity metric between two OpenSpecy objects based on the method used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cor_spec(x, ...)

## Default S3 method:
cor_spec(x, ...)

## S3 method for class 'OpenSpecy'
cor_spec(x, library, na.rm = T, conform = F, type = "roll", ...)

match_spec(x, ...)

## Default S3 method:
match_spec(x, ...)

## S3 method for class 'OpenSpecy'
match_spec(
  x,
  library,
  na.rm = T,
  conform = F,
  type = "roll",
  top_n = NULL,
  order = NULL,
  add_library_metadata = NULL,
  add_object_metadata = NULL,
  fill = NULL,
  ...
)

ident_spec(
  cor_matrix,
  x,
  library,
  top_n = NULL,
  add_library_metadata = NULL,
  add_object_metadata = NULL,
  ...
)

get_metadata(x, ...)

## Default S3 method:
get_metadata(x, ...)

## S3 method for class 'OpenSpecy'
get_metadata(x, logic, rm_empty = TRUE, ...)

max_cor_named(cor_matrix, na.rm = T)

filter_spec(x, ...)

## Default S3 method:
filter_spec(x, ...)

## S3 method for class 'OpenSpecy'
filter_spec(x, logic, ...)

ai_classify(x, ...)

## Default S3 method:
ai_classify(x, ...)

## S3 method for class 'OpenSpecy'
ai_classify(x, library, fill = NULL, ...)

fill_spec(x, ...)

## Default S3 method:
fill_spec(x, ...)

## S3 method for class 'OpenSpecy'
fill_spec(x, fill, ...)

os_similarity(x, ...)

## Default S3 method:
os_similarity(x, ...)

## S3 method for class 'OpenSpecy'
os_similarity(x, y, method = "hamming", na.rm = T, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cor_spec_+3A_x">x</code></td>
<td>
<p>an <code>OpenSpecy</code> object, typically with unknowns.</p>
</td></tr>
<tr><td><code id="cor_spec_+3A_library">library</code></td>
<td>
<p>an <code>OpenSpecy</code> or <code>glmnet</code> object representing the
reference library of spectra or model to use in identification.</p>
</td></tr>
<tr><td><code id="cor_spec_+3A_na.rm">na.rm</code></td>
<td>
<p>logical; indicating whether missing values should be removed
when calculating correlations. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="cor_spec_+3A_conform">conform</code></td>
<td>
<p>Whether to conform the spectra to the library wavenumbers or not.</p>
</td></tr>
<tr><td><code id="cor_spec_+3A_type">type</code></td>
<td>
<p>the type of conformation to make returned by <code>conform_spec()</code></p>
</td></tr>
<tr><td><code id="cor_spec_+3A_top_n">top_n</code></td>
<td>
<p>integer; specifying the number of top matches to return.
If <code>NULL</code> (default), all matches will be returned.</p>
</td></tr>
<tr><td><code id="cor_spec_+3A_order">order</code></td>
<td>
<p>an <code>OpenSpecy</code> used for sorting, ideally the unprocessed
one; <code>NULL</code> skips sorting.</p>
</td></tr>
<tr><td><code id="cor_spec_+3A_add_library_metadata">add_library_metadata</code></td>
<td>
<p>name of a column in the library metadata to be
joined; <code>NULL</code> if you don't want to join.</p>
</td></tr>
<tr><td><code id="cor_spec_+3A_add_object_metadata">add_object_metadata</code></td>
<td>
<p>name of a column in the object metadata to be
joined; <code>NULL</code> if you don't want to join.</p>
</td></tr>
<tr><td><code id="cor_spec_+3A_fill">fill</code></td>
<td>
<p>an <code>OpenSpecy</code> object with a single spectrum to be used to
fill missing values for alignment with the AI classification.</p>
</td></tr>
<tr><td><code id="cor_spec_+3A_cor_matrix">cor_matrix</code></td>
<td>
<p>a correlation matrix for object and library,
can be returned by <code>cor_spec()</code></p>
</td></tr>
<tr><td><code id="cor_spec_+3A_logic">logic</code></td>
<td>
<p>a logical or numeric vector describing which spectra to keep.</p>
</td></tr>
<tr><td><code id="cor_spec_+3A_rm_empty">rm_empty</code></td>
<td>
<p>logical; whether to remove empty columns in the metadata.</p>
</td></tr>
<tr><td><code id="cor_spec_+3A_y">y</code></td>
<td>
<p>an <code>OpenSpecy</code> object to perform similarity search against x.</p>
</td></tr>
<tr><td><code id="cor_spec_+3A_method">method</code></td>
<td>
<p>the type of similarity metric to return.</p>
</td></tr>
<tr><td><code id="cor_spec_+3A_...">...</code></td>
<td>
<p>additional arguments passed <code><a href="stats.html#topic+cor">cor</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>match_spec()</code> and <code>ident_spec()</code> will return
a <code><a href="data.table.html#topic+data.table-class">data.table-class</a>()</code> containing correlations
between spectra and the library.
The table has three columns: <code>object_id</code>, <code>library_id</code>, and
<code>match_val</code>.
Each row represents a unique pairwise correlation between a spectrum in the
object and a spectrum in the library.
If <code>top_n</code> is specified, only the top <code>top_n</code> matches for each
object spectrum will be returned.
If <code>add_library_metadata</code> is <code>is.character</code>, the library metadata
will be added to the output.
If <code>add_object_metadata</code> is <code>is.character</code>, the object metadata
will be added to the output.
<code>filter_spec()</code> returns an <code>OpenSpecy</code> object.
<code>fill_spec()</code> returns an <code>OpenSpecy</code> object.
<code>cor_spec()</code> returns a correlation matrix.
<code>get_metadata()</code> returns a <code><a href="data.table.html#topic+data.table-class">data.table-class</a>()</code>
with the metadata for columns which have information.
<code>os_similarity()</code> returns a single numeric value representing the type
of similarity metric requested. 'wavenumber' similarity is based on the
proportion of wavenumber values that overlap between the two objects,
'metadata' is the proportion of metadata column names,
'hamming' is something similar to the hamming distance where we discretize
all spectra in the OpenSpecy object by wavenumber intensity values and then
relate the wavenumber intensity value distributions by mean difference in
min-max normalized space. 'pca' tests the distance between the OpenSpecy
objects in PCA space using the first 4 component values and calculating the
max-range normalized distance between the mean components. The first two
metrics are pretty straightforward and definitely ready to go, the 'hamming'
and 'pca' metrics are pretty experimental but appear to be working under our
current test cases.
</p>


<h3>Author(s)</h3>

<p>Win Cowger, Zacharias Steinmetz
</p>


<h3>See Also</h3>

<p><code><a href="#topic+adj_intens">adj_intens</a>()</code> converts spectra;
<code><a href="#topic+get_lib">get_lib</a>()</code> retrieves the Open Specy reference library;
<code><a href="#topic+load_lib">load_lib</a>()</code> loads the Open Specy reference library into an <span class="rlang"><b>R</b></span>
object of choice
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("test_lib")

unknown &lt;- read_extdata("ftir_ldpe_soil.asp") |&gt;
  read_any() |&gt;
  conform_spec(range = test_lib$wavenumber,
               res = spec_res(test_lib)) |&gt;
  process_spec()
cor_spec(unknown, test_lib)

match_spec(unknown, test_lib, add_library_metadata = "sample_name",
           top_n = 1)

</code></pre>

<hr>
<h2 id='head.OpenSpecy'>Generic Open Specy Methods</h2><span id='topic+head.OpenSpecy'></span><span id='topic+print.OpenSpecy'></span><span id='topic+plot.OpenSpecy'></span><span id='topic+lines.OpenSpecy'></span><span id='topic+summary.OpenSpecy'></span><span id='topic+as.data.frame.OpenSpecy'></span><span id='topic+as.data.table.OpenSpecy'></span>

<h3>Description</h3>

<p>Methods to visualize and convert <code>OpenSpecy</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'OpenSpecy'
head(x, ...)

## S3 method for class 'OpenSpecy'
print(x, ...)

## S3 method for class 'OpenSpecy'
plot(x, ...)

## S3 method for class 'OpenSpecy'
lines(x, ...)

## S3 method for class 'OpenSpecy'
summary(object, ...)

## S3 method for class 'OpenSpecy'
as.data.frame(x, ...)

## S3 method for class 'OpenSpecy'
as.data.table(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="head.OpenSpecy_+3A_x">x</code></td>
<td>
<p>an <code>OpenSpecy</code> object.</p>
</td></tr>
<tr><td><code id="head.OpenSpecy_+3A_object">object</code></td>
<td>
<p>an <code>OpenSpecy</code> object.</p>
</td></tr>
<tr><td><code id="head.OpenSpecy_+3A_...">...</code></td>
<td>
<p>further arguments passed to the respective default method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>head()</code> shows the first few lines of an <code>OpenSpecy</code> object.
<code>print()</code> prints the contents of an <code>OpenSpecy</code> object.
<code>summary()</code> produces a result summary of an <code>OpenSpecy</code> object.
<code>plot()</code> produces a <code><a href="graphics.html#topic+matplot">matplot</a>()</code> of an OpenSpecy
object; <code>lines()</code> adds new spectra to it.
</p>


<h3>Value</h3>

<p><code>head()</code>, <code>print()</code>, and <code>summary()</code> return a textual
representation of an <code>OpenSpecy</code> object.
<code>plot()</code> and <code>lines()</code> return a plot.
<code>as.data.frame()</code> and <code>as.data.table()</code> convert <code>OpenSpecy</code>
objects into tabular data.
</p>


<h3>Author(s)</h3>

<p>Zacharias Steinmetz, Win Cowger
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+head">head</a>()</code>, <code><a href="base.html#topic+print">print</a>()</code>,
<code><a href="base.html#topic+summary">summary</a>()</code>, <code><a href="graphics.html#topic+matplot">matplot</a>()</code>, and
<code><a href="graphics.html#topic+matlines">matlines</a>()</code>,
<code><a href="base.html#topic+as.data.frame">as.data.frame</a>()</code>,
<code><a href="data.table.html#topic+as.data.table">as.data.table</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("raman_hdpe")

# Printing the OpenSpecy object
print(raman_hdpe)

# Displaying the first few lines of the OpenSpecy object
head(raman_hdpe)

# Plotting the spectra
plot(raman_hdpe)

</code></pre>

<hr>
<h2 id='human_ts'>Create human readable timestamps</h2><span id='topic+human_ts'></span>

<h3>Description</h3>

<p>This helper function creates human readable timestamps in the form of
<code>%Y%m%d-%H%M%OS</code> at the current time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>human_ts()
</code></pre>


<h3>Details</h3>

<p>Human readable timestamps are appended to file names and fields when metadata
are shared with the Open Specy community.
</p>


<h3>Value</h3>

<p><code>human_ts()</code> returns a character value with the respective
timestamp.
</p>


<h3>Author(s)</h3>

<p>Win Cowger, Zacharias Steinmetz
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+format.Date">format.Date</a></code> for date conversion functions
</p>


<h3>Examples</h3>

<pre><code class='language-R'>human_ts()

</code></pre>

<hr>
<h2 id='make_rel'>Make spectral intensities relative</h2><span id='topic+make_rel'></span><span id='topic+make_rel.default'></span><span id='topic+make_rel.OpenSpecy'></span>

<h3>Description</h3>

<p><code>make_rel()</code> converts intensities <code>x</code> into relative values between
0 and 1 using the standard normalization equation.
If <code>na.rm</code> is <code>TRUE</code>, missing values are removed before the
computation proceeds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_rel(x, ...)

## Default S3 method:
make_rel(x, na.rm = FALSE, ...)

## S3 method for class 'OpenSpecy'
make_rel(x, na.rm = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_rel_+3A_x">x</code></td>
<td>
<p>a numeric vector or an <span class="rlang"><b>R</b></span> OpenSpecy object</p>
</td></tr>
<tr><td><code id="make_rel_+3A_na.rm">na.rm</code></td>
<td>
<p>logical. Should missing values be removed?</p>
</td></tr>
<tr><td><code id="make_rel_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code>make_rel()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>make_rel()</code> is used to retain the relative height proportions between
spectra while avoiding the large numbers that can result from some spectral
instruments.
</p>


<h3>Value</h3>

<p><code>make_rel()</code> return numeric vectors (if vector provided) or an
<code>OpenSpecy</code> object with the normalized intensity data.
</p>


<h3>Author(s)</h3>

<p>Win Cowger, Zacharias Steinmetz
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+min">min</a>()</code> and <code><a href="base.html#topic+round">round</a>()</code>;
<code><a href="#topic+adj_intens">adj_intens</a>()</code> for log transformation functions;
<code><a href="#topic+conform_spec">conform_spec</a>()</code> for conforming wavenumbers of an
<code>OpenSpecy</code> object to be matched with a reference library
</p>


<h3>Examples</h3>

<pre><code class='language-R'>make_rel(c(-1000, -1, 0, 1, 10))

</code></pre>

<hr>
<h2 id='manage_na'>Ignore or remove NA intensities</h2><span id='topic+manage_na'></span><span id='topic+manage_na.default'></span><span id='topic+manage_na.OpenSpecy'></span>

<h3>Description</h3>

<p>Sometimes you want to keep or remove NA values in intensities to allow for
spectra with varying shapes to be analyzed together or maintained in a single
Open Specy object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>manage_na(x, ...)

## Default S3 method:
manage_na(x, lead_tail_only = TRUE, ig = c(NA), ...)

## S3 method for class 'OpenSpecy'
manage_na(x, lead_tail_only = TRUE, ig = c(NA), fun, type = "ignore", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="manage_na_+3A_x">x</code></td>
<td>
<p>a numeric vector or an <span class="rlang"><b>R</b></span> OpenSpecy object.</p>
</td></tr>
<tr><td><code id="manage_na_+3A_lead_tail_only">lead_tail_only</code></td>
<td>
<p>logical whether to only look at leading adn tailing values.</p>
</td></tr>
<tr><td><code id="manage_na_+3A_ig">ig</code></td>
<td>
<p>character vector, values to ignore.</p>
</td></tr>
<tr><td><code id="manage_na_+3A_fun">fun</code></td>
<td>
<p>the name of the function you want run, this is only used if the &quot;ignore&quot; type is chosen.</p>
</td></tr>
<tr><td><code id="manage_na_+3A_type">type</code></td>
<td>
<p>character of either &quot;ignore&quot; or &quot;remove&quot;.</p>
</td></tr>
<tr><td><code id="manage_na_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code>fun</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>manage_na()</code> return logical vectors of NA locations (if vector provided) or an
<code>OpenSpecy</code> object with ignored or removed NA values.
</p>


<h3>Author(s)</h3>

<p>Win Cowger, Zacharias Steinmetz
</p>


<h3>See Also</h3>

<p><code>OpenSpecy</code> object to be matched with a reference library
<code>fill_spec()</code> can be used to fill NA values in Open Specy objects.
<code>restrict_range()</code> can be used to restrict spectral ranges in other ways than removing NAs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>manage_na(c(NA, -1, NA, 1, 10))
manage_na(c(NA, -1, NA, 1, 10), lead_tail_only = FALSE)
manage_na(c(NA, 0, NA, 1, 10), lead_tail_only = FALSE, ig = c(NA,0))
data(raman_hdpe)
raman_hdpe$spectra[[1]][1:10] &lt;- NA

#would normally return all NA without na.rm = TRUE but doesn't here.
manage_na(raman_hdpe, fun = make_rel)

#will remove the first 10 values we set to NA
manage_na(raman_hdpe, type = "remove")

</code></pre>

<hr>
<h2 id='plotly_spec'>Interactive plots for OpenSpecy objects</h2><span id='topic+plotly_spec'></span><span id='topic+plotly_spec.default'></span><span id='topic+plotly_spec.OpenSpecy'></span><span id='topic+heatmap_spec'></span><span id='topic+heatmap_spec.default'></span><span id='topic+heatmap_spec.OpenSpecy'></span><span id='topic+interactive_plot'></span><span id='topic+interactive_plot.default'></span><span id='topic+interactive_plot.OpenSpecy'></span>

<h3>Description</h3>

<p>These functions generate heatmaps, spectral plots, and interactive plots for
OpenSpecy data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotly_spec(x, ...)

## Default S3 method:
plotly_spec(x, ...)

## S3 method for class 'OpenSpecy'
plotly_spec(
  x,
  x2 = NULL,
  line = list(color = "rgb(255, 255, 255)"),
  line2 = list(dash = "dot", color = "rgb(255,0,0)"),
  font = list(color = "#FFFFFF"),
  plot_bgcolor = "rgba(17, 0, 73, 0)",
  paper_bgcolor = "rgb(0, 0, 0)",
  showlegend = FALSE,
  ...
)

heatmap_spec(x, ...)

## Default S3 method:
heatmap_spec(x, ...)

## S3 method for class 'OpenSpecy'
heatmap_spec(
  x,
  z = NULL,
  sn = NULL,
  cor = NULL,
  min_sn = NULL,
  min_cor = NULL,
  select = NULL,
  font = list(color = "#FFFFFF"),
  plot_bgcolor = "rgba(17, 0, 73, 0)",
  paper_bgcolor = "rgb(0, 0, 0)",
  colorscale = "Viridis",
  showlegend = FALSE,
  ...
)

interactive_plot(x, ...)

## Default S3 method:
interactive_plot(x, ...)

## S3 method for class 'OpenSpecy'
interactive_plot(
  x,
  x2 = NULL,
  select = NULL,
  line = list(color = "rgb(255, 255, 255)"),
  line2 = list(dash = "dot", color = "rgb(255,0,0)"),
  font = list(color = "#FFFFFF"),
  plot_bgcolor = "rgba(17, 0, 73, 0)",
  paper_bgcolor = "rgb(0, 0, 0)",
  colorscale = "Viridis",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotly_spec_+3A_x">x</code></td>
<td>
<p>an <code>OpenSpecy</code> object containing metadata and spectral data for
the first group.</p>
</td></tr>
<tr><td><code id="plotly_spec_+3A_x2">x2</code></td>
<td>
<p>an optional second <code>OpenSpecy</code> object containing metadata and
spectral data for the second group.</p>
</td></tr>
<tr><td><code id="plotly_spec_+3A_line">line</code></td>
<td>
<p>list; <code>line</code> parameter for <code>x</code>; passed to
<code><a href="plotly.html#topic+add_trace">add_trace</a>()</code>.</p>
</td></tr>
<tr><td><code id="plotly_spec_+3A_line2">line2</code></td>
<td>
<p>list; <code>line</code> parameter for <code>x2</code>; passed to</p>
</td></tr>
<tr><td><code id="plotly_spec_+3A_font">font</code></td>
<td>
<p>list; passed to <code><a href="plotly.html#topic+layout">layout</a>()</code>.</p>
</td></tr>
<tr><td><code id="plotly_spec_+3A_plot_bgcolor">plot_bgcolor</code></td>
<td>
<p>color value; passed to <code><a href="plotly.html#topic+layout">layout</a>()</code>.</p>
</td></tr>
<tr><td><code id="plotly_spec_+3A_paper_bgcolor">paper_bgcolor</code></td>
<td>
<p>color value; passed to <code><a href="plotly.html#topic+layout">layout</a>()</code>.</p>
</td></tr>
<tr><td><code id="plotly_spec_+3A_showlegend">showlegend</code></td>
<td>
<p>whether to show the legend passed to
<code><a href="plotly.html#topic+plot_ly">plot_ly</a>()</code>.</p>
</td></tr>
<tr><td><code id="plotly_spec_+3A_z">z</code></td>
<td>
<p>optional numeric vector specifying the intensity values for the
heatmap. If not provided, the function will use the intensity values from the
<code>OpenSpecy</code> object.</p>
</td></tr>
<tr><td><code id="plotly_spec_+3A_sn">sn</code></td>
<td>
<p>optional numeric value specifying the signal-to-noise ratio
threshold. If provided along with <code>min_sn</code>, regions with SNR below the
threshold will be excluded from the heatmap.</p>
</td></tr>
<tr><td><code id="plotly_spec_+3A_cor">cor</code></td>
<td>
<p>optional numeric value specifying the correlation threshold. If
provided along with <code>min_cor</code>, regions with correlation below the
threshold will be excluded from the heatmap.</p>
</td></tr>
<tr><td><code id="plotly_spec_+3A_min_sn">min_sn</code></td>
<td>
<p>optional numeric value specifying the minimum signal-to-noise
ratio for inclusion in the heatmap. Regions with SNR below this threshold
will be excluded.</p>
</td></tr>
<tr><td><code id="plotly_spec_+3A_min_cor">min_cor</code></td>
<td>
<p>optional numeric value specifying the minimum correlation for
inclusion in the heatmap. Regions with correlation below this threshold
will be excluded.</p>
</td></tr>
<tr><td><code id="plotly_spec_+3A_select">select</code></td>
<td>
<p>optional index of the selected spectrum to highlight on the
heatmap.</p>
</td></tr>
<tr><td><code id="plotly_spec_+3A_colorscale">colorscale</code></td>
<td>
<p>colorscale passed to <code><a href="plotly.html#topic+add_trace">add_trace</a>()</code> can
be an array or one of <code>"Blackbody"</code>, <code>"Bluered"</code>, <code>"Blues"</code>, <code>"Cividis"</code>,
<code>"Earth"</code>, <code>"Electric"</code>, <code>"Greens"</code>, <code>"Greys"</code>, <code>"Hot"</code>, <code>"Jet"</code>, <code>"Picnic"</code>,
<code>"Portland"</code>, <code>"Rainbow"</code>, <code>"RdBu"</code>, <code>"Reds"</code>, <code>"Viridis"</code>, <code>"YlGnBu"</code>,
<code>"YlOrRd"</code>.</p>
</td></tr>
<tr><td><code id="plotly_spec_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="plotly.html#topic+plot_ly">plot_ly</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plotly heatmap object displaying the OpenSpecy data. A subplot
containing the heatmap and spectra plot. A plotly object displaying the
spectra from the <code>OpenSpecy</code> object(s).
</p>


<h3>Author(s)</h3>

<p>Win Cowger, Zacharias Steinmetz
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("raman_hdpe")
tiny_map &lt;- read_extdata("CA_tiny_map.zip") |&gt; read_zip()
plotly_spec(raman_hdpe)

heatmap_spec(tiny_map, z = tiny_map$metadata$y, showlegend = TRUE)

sample_spec(tiny_map, size = 12) |&gt;
  interactive_plot(select = 2, x2 = raman_hdpe)

</code></pre>

<hr>
<h2 id='process_spec'>Process Spectra</h2><span id='topic+process_spec'></span><span id='topic+process_spec.default'></span><span id='topic+process_spec.OpenSpecy'></span>

<h3>Description</h3>

<p><code>process_spec()</code> is a monolithic wrapper function for all spectral
processing steps.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_spec(x, ...)

## Default S3 method:
process_spec(x, ...)

## S3 method for class 'OpenSpecy'
process_spec(
  x,
  active = TRUE,
  adj_intens = FALSE,
  adj_intens_args = list(type = "none"),
  conform_spec = TRUE,
  conform_spec_args = list(range = NULL, res = 5, type = "interp"),
  restrict_range = FALSE,
  restrict_range_args = list(min = 0, max = 6000),
  flatten_range = FALSE,
  flatten_range_args = list(min = 2200, max = 2420),
  subtr_baseline = FALSE,
  subtr_baseline_args = list(type = "polynomial", degree = 8, raw = FALSE, baseline =
    NULL),
  smooth_intens = TRUE,
  smooth_intens_args = list(polynomial = 3, window = 11, derivative = 1, abs = TRUE),
  make_rel = TRUE,
  make_rel_args = list(na.rm = TRUE),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="process_spec_+3A_x">x</code></td>
<td>
<p>an <code>OpenSpecy</code> object.</p>
</td></tr>
<tr><td><code id="process_spec_+3A_active">active</code></td>
<td>
<p>logical; indicating whether to perform processing.
If <code>TRUE</code>, the processing steps will be applied.
If <code>FALSE</code>, the original data will be returned.</p>
</td></tr>
<tr><td><code id="process_spec_+3A_adj_intens">adj_intens</code></td>
<td>
<p>logical; describing whether to adjust the intensity units.</p>
</td></tr>
<tr><td><code id="process_spec_+3A_adj_intens_args">adj_intens_args</code></td>
<td>
<p>named list of arguments passed to
<code><a href="#topic+smooth_intens">smooth_intens</a>()</code>.</p>
</td></tr>
<tr><td><code id="process_spec_+3A_conform_spec">conform_spec</code></td>
<td>
<p>logical; whether to conform the spectra to a new
wavenumber range and resolution.</p>
</td></tr>
<tr><td><code id="process_spec_+3A_conform_spec_args">conform_spec_args</code></td>
<td>
<p>named list of arguments passed to
<code><a href="#topic+conform_spec">conform_spec</a>()</code>.</p>
</td></tr>
<tr><td><code id="process_spec_+3A_restrict_range">restrict_range</code></td>
<td>
<p>logical; indicating whether to restrict the wavenumber
range of the spectra.</p>
</td></tr>
<tr><td><code id="process_spec_+3A_restrict_range_args">restrict_range_args</code></td>
<td>
<p>named list of arguments passed to
<code><a href="#topic+restrict_range">restrict_range</a>()</code>.</p>
</td></tr>
<tr><td><code id="process_spec_+3A_flatten_range">flatten_range</code></td>
<td>
<p>logical; indicating whether to flatten the range around
the carbon dioxide region.</p>
</td></tr>
<tr><td><code id="process_spec_+3A_flatten_range_args">flatten_range_args</code></td>
<td>
<p>named list of arguments passed to
<code><a href="#topic+flatten_range">flatten_range</a>()</code>.</p>
</td></tr>
<tr><td><code id="process_spec_+3A_subtr_baseline">subtr_baseline</code></td>
<td>
<p>logical; indicating whether to subtract the baseline
from the spectra.</p>
</td></tr>
<tr><td><code id="process_spec_+3A_subtr_baseline_args">subtr_baseline_args</code></td>
<td>
<p>named list of arguments passed to
<code><a href="#topic+subtr_baseline">subtr_baseline</a>()</code>.</p>
</td></tr>
<tr><td><code id="process_spec_+3A_smooth_intens">smooth_intens</code></td>
<td>
<p>logical; indicating whether to apply a smoothing filter
to the spectra.</p>
</td></tr>
<tr><td><code id="process_spec_+3A_smooth_intens_args">smooth_intens_args</code></td>
<td>
<p>named list of arguments passed to
<code><a href="#topic+smooth_intens">smooth_intens</a>()</code>.</p>
</td></tr>
<tr><td><code id="process_spec_+3A_make_rel">make_rel</code></td>
<td>
<p>logical; if <code>TRUE</code> spectra are automatically normalized
with <code><a href="#topic+make_rel">make_rel</a>()</code>.</p>
</td></tr>
<tr><td><code id="process_spec_+3A_make_rel_args">make_rel_args</code></td>
<td>
<p>named list of arguments passed to
<code><a href="#topic+make_rel">make_rel</a>()</code>.</p>
</td></tr>
<tr><td><code id="process_spec_+3A_na.rm">na.rm</code></td>
<td>
<p>Whether to allow NA or set all NA values to</p>
</td></tr>
<tr><td><code id="process_spec_+3A_...">...</code></td>
<td>
<p>further arguments passed to subfunctions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>process_spec()</code> returns an <code>OpenSpecy</code> object with processed
spectra based on the specified parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("raman_hdpe")
plot(raman_hdpe)

# Process spectra with range restriction and baseline subtraction
process_spec(raman_hdpe,
             restrict_range = TRUE,
             restrict_range_args = list(min = 500, max = 3000),
             subtr_baseline = TRUE,
             subtr_baseline_args = list(type = "polynomial",
                                        polynomial = 8)) |&gt;
  lines(col = "darkred")

# Process spectra with smoothing and derivative
process_spec(raman_hdpe,
             smooth_intens = TRUE,
             smooth_intens_args = list(
               polynomial = 3,
               window = 11,
               derivative = 1
               )
             ) |&gt;
  lines(col = "darkgreen")

</code></pre>

<hr>
<h2 id='raman_hdpe'>Sample Raman spectrum</h2><span id='topic+raman_hdpe'></span>

<h3>Description</h3>

<p>Raman spectrum of high-density polyethylene (HDPE) provided by
Horiba Scientific.
</p>


<h3>Format</h3>

<p>An threepart list of class <code><a href="#topic+OpenSpecy">OpenSpecy</a></code> containing:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>wavenumber</code>: </td><td style="text-align: left;"> spectral wavenumbers [1/cm] (vector of 964 rows) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>spectra</code>: </td><td style="text-align: left;"> absorbance values <a href="base.html#topic+-">-</a>
(a <code><a href="data.table.html#topic+data.table">data.table</a></code> with 964 rows and 1 column) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>metadata</code>: </td><td style="text-align: left;"> spectral metadata </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Zacharias Steinmetz, Win Cowger
</p>


<h3>References</h3>

<p>Cowger W, Gray A, Christiansen SH, De Frond H, Deshpande AD, Hemabessiere L,
Lee E, Mill L, et al. (2020). “Critical Review of Processing and
Classification Techniques for Images and Spectra in Microplastic Research.”
<em>Applied Spectroscopy</em>, <strong>74</strong>(9), 989–1010.
<a href="https://doi.org/10.1177/0003702820929064">doi:10.1177/0003702820929064</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(raman_hdpe)
print(raman_hdpe)

</code></pre>

<hr>
<h2 id='read_any'>Read spectral data from multiple files</h2><span id='topic+read_any'></span><span id='topic+read_many'></span><span id='topic+read_zip'></span>

<h3>Description</h3>

<p>Wrapper functions for reading files in batch.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_any(file, ...)

read_many(file, ...)

read_zip(file, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_any_+3A_file">file</code></td>
<td>
<p>file to be read from or written to.</p>
</td></tr>
<tr><td><code id="read_any_+3A_...">...</code></td>
<td>
<p>further arguments passed to the submethods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>read_any()</code> provides a single function to quickly read in any of the
supported formats, it assumes that the file extension will tell it how to
process the spectra.
<code>read_zip()</code> provides functionality for reading in spectral map files
with ENVI file format or as individual files in a zip folder. If individual
files, spectra are concatenated.
<code>read_many()</code> provides functionality for reading multiple files
in a character vector and will return a list.
</p>


<h3>Value</h3>

<p>All <code>read_*()</code> functions return <code>OpenSpecy</code> objects if a single
spectrum or map is provided, otherwise the provide a list of <code>OpenSpecy</code> objects.
</p>


<h3>Author(s)</h3>

<p>Zacharias Steinmetz, Win Cowger
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read_spec">read_spec</a>()</code> for submethods.
<code><a href="#topic+c_spec">c_spec</a>()</code> for combining lists of Open Specys.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
read_extdata("raman_hdpe.csv") |&gt; read_any()
read_extdata("ftir_ldpe_soil.asp") |&gt; read_any()
read_extdata("testdata_zipped.zip") |&gt; read_many()
read_extdata("CA_tiny_map.zip") |&gt; read_many()

</code></pre>

<hr>
<h2 id='read_envi'>Read ENVI data</h2><span id='topic+read_envi'></span>

<h3>Description</h3>

<p>This function allows ENVI data import.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_envi(
  file,
  header = NULL,
  spectral_smooth = F,
  sigma = c(1, 1, 1),
  share = NULL,
  metadata = list(file_name = basename(file), user_name = NULL, contact_info = NULL,
    organization = NULL, citation = NULL, spectrum_type = NULL, spectrum_identity = NULL,
    material_form = NULL, material_phase = NULL, material_producer = NULL,
    material_purity = NULL, material_quality = NULL, material_color = NULL,
    material_other = NULL, cas_number = NULL, instrument_used = NULL,
    instrument_accessories = NULL, instrument_mode = NULL, spectral_resolution = NULL,
    laser_light_used = NULL, number_of_accumulations = NULL, 
    
    total_acquisition_time_s = NULL, data_processing_procedure = NULL,
    level_of_confidence_in_identification = NULL, other_info = NULL, license =
    "CC BY-NC"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_envi_+3A_file">file</code></td>
<td>
<p>name of the binary file.</p>
</td></tr>
<tr><td><code id="read_envi_+3A_header">header</code></td>
<td>
<p>name of the ASCII header file. If <code>NULL</code>, the name of the
header file is guessed by looking for a second file with the same basename as
<code>file</code> but with .hdr extension.</p>
</td></tr>
<tr><td><code id="read_envi_+3A_spectral_smooth">spectral_smooth</code></td>
<td>
<p>logical value determines whether spectral smoothing
will be performed.</p>
</td></tr>
<tr><td><code id="read_envi_+3A_sigma">sigma</code></td>
<td>
<p>if <code>spectral_smooth</code> then this option applies the 3d
standard deviations for the <code>gaussianSmooth</code> function from the
<code>mmand</code> package to describe how spectral smoothing occurs on each dimension.
The first two dimensions are x and y, the third is the wavenumbers.</p>
</td></tr>
<tr><td><code id="read_envi_+3A_share">share</code></td>
<td>
<p>defaults to <code>NULL</code>; needed to share spectra with the
Open Specy community; see <code><a href="#topic+share_spec">share_spec</a>()</code> for details.</p>
</td></tr>
<tr><td><code id="read_envi_+3A_metadata">metadata</code></td>
<td>
<p>a named list of the metadata; see
<code><a href="#topic+as_OpenSpecy">as_OpenSpecy</a>()</code> for details.</p>
</td></tr>
<tr><td><code id="read_envi_+3A_...">...</code></td>
<td>
<p>further arguments passed to the submethods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>ENVI data usually consists of two files, an ASCII header and a binary data
file. The header contains all information necessary for correctly reading
the binary file via <code><a href="caTools.html#topic+read.ENVI">read.ENVI</a>()</code>.
</p>


<h3>Value</h3>

<p>An <code>OpenSpecy</code> object.
</p>


<h3>Author(s)</h3>

<p>Zacharias Steinmetz, Claudia Beleites
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read_spec">read_spec</a>()</code> for reading .y(a)ml, .json, or .rds (OpenSpecy)
files;
<code><a href="#topic+read_text">read_text</a>()</code>, <code><a href="#topic+read_asp">read_asp</a>()</code>, <code><a href="#topic+read_spa">read_spa</a>()</code>,
<code><a href="#topic+read_spc">read_spc</a>()</code>, and <code><a href="#topic+read_jdx">read_jdx</a>()</code> for text files, .asp,
.spa, .spa, .spc, and .jdx formats, respectively;
<code><a href="#topic+read_opus">read_opus</a>()</code> for reading .0 (OPUS) files;
<code><a href="#topic+read_zip">read_zip</a>()</code> and <code><a href="#topic+read_any">read_any</a>()</code> for wrapper functions;
<code><a href="caTools.html#topic+read.ENVI">read.ENVI</a>()</code>
<code><a href="mmand.html#topic+gaussianSmooth">gaussianSmooth</a>()</code>
</p>

<hr>
<h2 id='read_opus'>Read spectral data from Bruker OPUS binary files</h2><span id='topic+read_opus'></span>

<h3>Description</h3>

<p>Read file(s) acquired with a Bruker Vertex FTIR Instrument. This function
is basically a fork of <code>opus_read()</code> from
<a href="https://github.com/pierreroudier/opusreader">https://github.com/pierreroudier/opusreader</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_opus(
  file,
  share = NULL,
  metadata = list(file_name = basename(file), user_name = NULL, contact_info = NULL,
    organization = NULL, citation = NULL, spectrum_type = NULL, spectrum_identity = NULL,
    material_form = NULL, material_phase = NULL, material_producer = NULL,
    material_purity = NULL, material_quality = NULL, material_color = NULL,
    material_other = NULL, cas_number = NULL, instrument_used = NULL,
    instrument_accessories = NULL, instrument_mode = NULL, spectral_resolution = NULL,
    laser_light_used = NULL, number_of_accumulations = NULL, 
    
    total_acquisition_time_s = NULL, data_processing_procedure = NULL,
    level_of_confidence_in_identification = NULL, other_info = NULL, license =
    "CC BY-NC"),
  type = "spec",
  digits = 1L,
  atm_comp_minus4offset = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_opus_+3A_file">file</code></td>
<td>
<p>character vector with path to file(s).</p>
</td></tr>
<tr><td><code id="read_opus_+3A_share">share</code></td>
<td>
<p>defaults to <code>NULL</code>; needed to share spectra with the
Open Specy community; see <code><a href="#topic+share_spec">share_spec</a>()</code> for details.</p>
</td></tr>
<tr><td><code id="read_opus_+3A_metadata">metadata</code></td>
<td>
<p>a named list of the metadata; see
<code><a href="#topic+as_OpenSpecy">as_OpenSpecy</a>()</code> for details.</p>
</td></tr>
<tr><td><code id="read_opus_+3A_type">type</code></td>
<td>
<p>character vector of spectra types to extract from OPUS binary
file. Default is <code>"spec"</code>, which will extract the final spectra, e.g.
expressed in absorbance (named <code>AB</code> in Bruker OPUS programs). Possible
additional values for the character vector supplied to <code>type</code> are
<code>"spec_no_atm_comp"</code> (spectrum of the sample without compensation for
atmospheric gases, water vapor and/or carbon dioxide),
<code>"sc_sample"</code> (single channel spectrum of the sample measurement), <code>"sc_ref"</code>
(single channel spectrum of the reference measurement),
<code>"ig_sample"</code> (interferogram of the sample measurement) and <code>"ig_ref"</code>
(interferogram of the reference measurement).</p>
</td></tr>
<tr><td><code id="read_opus_+3A_digits">digits</code></td>
<td>
<p>Integer that specifies the number of decimal places used to
round the wavenumbers (values of x-variables).</p>
</td></tr>
<tr><td><code id="read_opus_+3A_atm_comp_minus4offset">atm_comp_minus4offset</code></td>
<td>
<p>Logical whether spectra after atmospheric
compensation are read with an offset of -4 bytes from Bruker OPUS files;
default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The type of spectra returned by the function when using
<code>type = "spec"</code> depends on the setting of the Bruker instrument: typically,
it can be either absorbance or reflectance.
</p>
<p>The type of spectra to extract from the file can also use Bruker's OPUS
software naming conventions, as follows:
</p>

<ul>
<li> <p><code>ScSm</code> corresponds to <code>sc_sample</code>
</p>
</li>
<li> <p><code>ScRf</code> corresponds to <code>sc_ref</code>
</p>
</li>
<li> <p><code>IgSm</code> corresponds to <code>ig_sample</code>
</p>
</li>
<li> <p><code>IgRf</code> corresponds to <code>ig_ref</code>
</p>
</li></ul>



<h3>Value</h3>

<p>An <code>OpenSpecy</code> object.
</p>


<h3>Author(s)</h3>

<p>Philipp Baumann, Zacharias Steinmetz, Win Cowger
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read_spec">read_spec</a>()</code> for reading .y(a)ml, .json, or .rds (OpenSpecy)
files;
<code><a href="#topic+read_text">read_text</a>()</code>, <code><a href="#topic+read_asp">read_asp</a>()</code>, <code><a href="#topic+read_spa">read_spa</a>()</code>,
<code><a href="#topic+read_spc">read_spc</a>()</code>, and <code><a href="#topic+read_jdx">read_jdx</a>()</code> for text files, .asp,
.spa, .spa, .spc, and .jdx formats, respectively;
<code><a href="#topic+read_text">read_text</a>()</code> for reading .dat (ENVI) files;
<code><a href="#topic+read_zip">read_zip</a>()</code> and <code><a href="#topic+read_any">read_any</a>()</code> for wrapper functions;
<code><a href="#topic+read_opus_raw">read_opus_raw</a>()</code>;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>read_extdata("ftir_ps.0") |&gt; read_opus()

</code></pre>

<hr>
<h2 id='read_opus_raw'>Read a Bruker OPUS spectrum binary raw string</h2><span id='topic+read_opus_raw'></span>

<h3>Description</h3>

<p>Read single binary acquired with an Bruker Vertex FTIR Instrument
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_opus_raw(rw, type = "spec", atm_comp_minus4offset = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_opus_raw_+3A_rw">rw</code></td>
<td>
<p>a raw vector</p>
</td></tr>
<tr><td><code id="read_opus_raw_+3A_type">type</code></td>
<td>
<p>character vector of spectra types to extract from OPUS binary
file. Default is <code>"spec"</code>, which will extract the final spectra, e.g.
expressed in absorbance (named <code>AB</code> in Bruker OPUS programs). Possible
additional values for the character vector supplied to <code>type</code> are
<code>"spec_no_atm_comp"</code> (spectrum of the sample without compensation for
atmospheric gases, water vapor and/or carbon dioxide),
<code>"sc_sample"</code> (single channel spectrum of the sample measurement),
<code>"sc_ref"</code> (single channel spectrum of the reference measurement),
<code>"ig_sample"</code> (interferogram of the sample measurement) and <code>"ig_ref"</code>
(interferogram of the reference measurement).</p>
</td></tr>
<tr><td><code id="read_opus_raw_+3A_atm_comp_minus4offset">atm_comp_minus4offset</code></td>
<td>
<p>logical; whether spectra after atmospheric
compensation are read with an offset of -4 bytes from Bruker OPUS
files. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The type of spectra returned by the function when using
<code>type = "spec"</code> depends on the setting of the Bruker instrument: typically,
it can be either absorbance or reflectance.
</p>
<p>The type of spectra to extract from the file can also use Bruker's OPUS
software naming conventions, as follows:
</p>

<ul>
<li> <p><code>ScSm</code> corresponds to <code>sc_sample</code>
</p>
</li>
<li> <p><code>ScRf</code> corresponds to <code>sc_ref</code>
</p>
</li>
<li> <p><code>IgSm</code> corresponds to <code>ig_sample</code>
</p>
</li>
<li> <p><code>IgRf</code> corresponds to <code>ig_ref</code>
</p>
</li></ul>



<h3>Value</h3>

<p>A list of 10 elements:
</p>

<dl>
<dt><code>metadata</code></dt><dd><p>a <code>data.frame</code> containing metadata from the OPUS file.</p>
</dd>
<dt><code>spec</code></dt><dd><p>if <code>"spec"</code> was requested in the <code>type</code> option, a matrix of
the spectrum of the sample (otherwise set to <code>NULL</code>).</p>
</dd>
<dt><code>spec_no_atm_comp</code></dt><dd><p>if <code>"spec_no_atm_comp"</code> was requested in the
<code>type</code> option, a matrix of the spectrum of the sample without atmospheric
compensation (otherwise set to <code>NULL</code>).</p>
</dd>
<dt><code>sc_sample</code></dt><dd><p>if <code>"sc_sample"</code> was requested in the <code>type</code> option, a
matrix of the single channel spectrum of the sample (otherwise set to
<code>NULL</code>).</p>
</dd>
<dt><code>sc_ref</code></dt><dd><p>if <code>"sc_ref"</code> was requested in the <code>type</code> option, a matrix
of the single channel spectrum of the reference (otherwise set to <code>NULL</code>).</p>
</dd>
<dt><code>ig_sample</code></dt><dd><p>if <code>"ig_sample"</code> was requested in the <code>type</code> option, a
matrix of the interferogram of the sample (otherwise set to <code>NULL</code>).</p>
</dd>
<dt><code>ig_ref</code></dt><dd><p>if <code>"ig_ref"</code> was requested in the <code>type</code> option, a matrix
of the interferogram of the reference (otherwise set to <code>NULL</code>).</p>
</dd>
<dt><code>wavenumbers</code></dt><dd><p>if <code>"spec"</code> or <code>"spec_no_atm_comp"</code> was requested in
the <code>type</code> option, a numeric vector of the wavenumbers of the spectrum of
the sample (otherwise set to <code>NULL</code>).</p>
</dd>
<dt><code>wavenumbers_sc_sample</code></dt><dd><p>if <code>"sc_sample"</code> was requested in the <code>type</code>
option, a numeric vector of the wavenumbers of the single channel spectrum
of the sample (otherwise set to <code>NULL</code>).</p>
</dd>
<dt><code>wavenumbers_sc_ref</code></dt><dd><p>if <code>"sc_ref"</code> was requested in the <code>type</code>
option, a numeric vector of the wavenumbers of the single channel spectrum
of the reference (otherwise set to <code>NULL</code>).</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Philipp Baumann and Pierre Roudier
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read_opus">read_opus</a>()</code>
</p>

<hr>
<h2 id='read_text'>Read spectral data</h2><span id='topic+read_text'></span><span id='topic+read_asp'></span><span id='topic+read_spa'></span><span id='topic+read_spc'></span><span id='topic+read_jdx'></span><span id='topic+read_extdata'></span>

<h3>Description</h3>

<p>Functions for reading spectral data from external file types.
Currently supported reading formats are .csv and other text files, .asp,
.spa, .spc, and .jdx.
Additionally, .0 (OPUS) and .dat (ENVI) files are supported via
<code><a href="#topic+read_opus">read_opus</a>()</code> and <code><a href="#topic+read_envi">read_envi</a>()</code>, respectively.
<code><a href="#topic+read_zip">read_zip</a>()</code> takes any of the files listed above.
Note that proprietary file formats like .0, .asp, and .spa are poorly
supported but will likely still work in most cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_text(
  file,
  colnames = NULL,
  method = "fread",
  share = NULL,
  metadata = list(file_name = basename(file), user_name = NULL, contact_info = NULL,
    organization = NULL, citation = NULL, spectrum_type = NULL, spectrum_identity = NULL,
    material_form = NULL, material_phase = NULL, material_producer = NULL,
    material_purity = NULL, material_quality = NULL, material_color = NULL,
    material_other = NULL, cas_number = NULL, instrument_used = NULL,
    instrument_accessories = NULL, instrument_mode = NULL, spectral_resolution = NULL,
    laser_light_used = NULL, number_of_accumulations = NULL, 
    
    total_acquisition_time_s = NULL, data_processing_procedure = NULL,
    level_of_confidence_in_identification = NULL, other_info = NULL, license =
    "CC BY-NC"),
  ...
)

read_asp(
  file,
  share = NULL,
  metadata = list(file_name = basename(file), user_name = NULL, contact_info = NULL,
    organization = NULL, citation = NULL, spectrum_type = NULL, spectrum_identity = NULL,
    material_form = NULL, material_phase = NULL, material_producer = NULL,
    material_purity = NULL, material_quality = NULL, material_color = NULL,
    material_other = NULL, cas_number = NULL, instrument_used = NULL,
    instrument_accessories = NULL, instrument_mode = NULL, spectral_resolution = NULL,
    laser_light_used = NULL, number_of_accumulations = NULL, 
    
    total_acquisition_time_s = NULL, data_processing_procedure = NULL,
    level_of_confidence_in_identification = NULL, other_info = NULL, license =
    "CC BY-NC"),
  ...
)

read_spa(
  file,
  share = NULL,
  metadata = list(file_name = basename(file), user_name = NULL, contact_info = NULL,
    organization = NULL, citation = NULL, spectrum_type = NULL, spectrum_identity = NULL,
    material_form = NULL, material_phase = NULL, material_producer = NULL,
    material_purity = NULL, material_quality = NULL, material_color = NULL,
    material_other = NULL, cas_number = NULL, instrument_used = NULL,
    instrument_accessories = NULL, instrument_mode = NULL, spectral_resolution = NULL,
    laser_light_used = NULL, number_of_accumulations = NULL, 
    
    total_acquisition_time_s = NULL, data_processing_procedure = NULL,
    level_of_confidence_in_identification = NULL, other_info = NULL, license =
    "CC BY-NC"),
  ...
)

read_spc(
  file,
  share = NULL,
  metadata = list(file_name = basename(file), user_name = NULL, contact_info = NULL,
    organization = NULL, citation = NULL, spectrum_type = NULL, spectrum_identity = NULL,
    material_form = NULL, material_phase = NULL, material_producer = NULL,
    material_purity = NULL, material_quality = NULL, material_color = NULL,
    material_other = NULL, cas_number = NULL, instrument_used = NULL,
    instrument_accessories = NULL, instrument_mode = NULL, spectral_resolution = NULL,
    laser_light_used = NULL, number_of_accumulations = NULL, 
    
    total_acquisition_time_s = NULL, data_processing_procedure = NULL,
    level_of_confidence_in_identification = NULL, other_info = NULL, license =
    "CC BY-NC"),
  ...
)

read_jdx(
  file,
  share = NULL,
  metadata = list(file_name = basename(file), user_name = NULL, contact_info = NULL,
    organization = NULL, citation = NULL, spectrum_type = NULL, spectrum_identity = NULL,
    material_form = NULL, material_phase = NULL, material_producer = NULL,
    material_purity = NULL, material_quality = NULL, material_color = NULL,
    material_other = NULL, cas_number = NULL, instrument_used = NULL,
    instrument_accessories = NULL, instrument_mode = NULL, spectral_resolution = NULL,
    laser_light_used = NULL, number_of_accumulations = NULL, 
    
    total_acquisition_time_s = NULL, data_processing_procedure = NULL,
    level_of_confidence_in_identification = NULL, other_info = NULL, license =
    "CC BY-NC"),
  ...
)

read_extdata(file = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_text_+3A_file">file</code></td>
<td>
<p>file to be read from or written to.</p>
</td></tr>
<tr><td><code id="read_text_+3A_colnames">colnames</code></td>
<td>
<p>character vector of <code>length = 2</code> indicating the column
names for the wavenumber and intensity; if <code>NULL</code> columns are guessed.</p>
</td></tr>
<tr><td><code id="read_text_+3A_method">method</code></td>
<td>
<p>submethod to be used for reading text files; defaults to
<code><a href="data.table.html#topic+fread">fread</a>()</code> but <code><a href="utils.html#topic+read.csv">read.csv</a>()</code> works
as well.</p>
</td></tr>
<tr><td><code id="read_text_+3A_share">share</code></td>
<td>
<p>defaults to <code>NULL</code>; needed to share spectra with the
Open Specy community; see <code><a href="#topic+share_spec">share_spec</a>()</code> for details.</p>
</td></tr>
<tr><td><code id="read_text_+3A_metadata">metadata</code></td>
<td>
<p>a named list of the metadata; see
<code><a href="#topic+as_OpenSpecy">as_OpenSpecy</a>()</code> for details.</p>
</td></tr>
<tr><td><code id="read_text_+3A_...">...</code></td>
<td>
<p>further arguments passed to the submethods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>read_spc()</code> and <code>read_jdx()</code> are wrappers around the
functions provided by the <a href="hyperSpec.html#topic+hyperSpec-package">hyperSpec</a>.
Other functions have been adapted various online sources.
Metadata is harvested if possible.
There are many unique iterations of spectral file formats so there may be
bugs in the file conversion. Please contact us if you identify any.
</p>


<h3>Value</h3>

<p>All <code>read_*()</code> functions return data frames containing two columns
named <code>"wavenumber"</code> and <code>"intensity"</code>.
</p>


<h3>Author(s)</h3>

<p>Zacharias Steinmetz, Win Cowger
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read_spec">read_spec</a>()</code> for reading .y(a)ml, .json, or .rds (OpenSpecy)
files;
<code><a href="#topic+read_opus">read_opus</a>()</code> for reading .0 (OPUS) files;
<code><a href="#topic+read_envi">read_envi</a>()</code> for reading .dat (ENVI) files;
<code><a href="#topic+read_zip">read_zip</a>()</code> and <code><a href="#topic+read_any">read_any</a>()</code> for wrapper functions;
<code><a href="hyperSpec.html#topic+read.jdx">read.jdx</a>()</code>; <code><a href="hyperSpec.html#topic+read.spc">read.spc</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>read_extdata("raman_hdpe.csv") |&gt; read_text()
read_extdata("raman_atacamit.spc") |&gt; read_spc()
read_extdata("ftir_ldpe_soil.asp") |&gt; read_asp()
read_extdata("testdata_zipped.zip") |&gt; read_zip()

</code></pre>

<hr>
<h2 id='restrict_range'>Range restriction and flattening for spectra</h2><span id='topic+restrict_range'></span><span id='topic+restrict_range.default'></span><span id='topic+restrict_range.OpenSpecy'></span><span id='topic+flatten_range'></span><span id='topic+flatten_range.default'></span><span id='topic+flatten_range.OpenSpecy'></span>

<h3>Description</h3>

<p><code>restrict_range()</code> restricts wavenumber ranges to user specified values.
Multiple ranges can be specified by inputting a series of max and min
values in order.
<code>flatten_range()</code> will flatten ranges of the spectra that should have no
peaks.
Multiple ranges can be specified by inputting the series of max and min
values in order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>restrict_range(x, ...)

## Default S3 method:
restrict_range(x, ...)

## S3 method for class 'OpenSpecy'
restrict_range(x, min, max, make_rel = TRUE, ...)

flatten_range(x, ...)

## Default S3 method:
flatten_range(x, ...)

## S3 method for class 'OpenSpecy'
flatten_range(x, min = 2200, max = 2400, make_rel = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="restrict_range_+3A_x">x</code></td>
<td>
<p>an <code>OpenSpecy</code> object.</p>
</td></tr>
<tr><td><code id="restrict_range_+3A_min">min</code></td>
<td>
<p>a vector of minimum values for the range to be flattened.</p>
</td></tr>
<tr><td><code id="restrict_range_+3A_max">max</code></td>
<td>
<p>a vector of maximum values for the range to be flattened.</p>
</td></tr>
<tr><td><code id="restrict_range_+3A_make_rel">make_rel</code></td>
<td>
<p>logical; should the output intensities be normalized to the
range [0, 1] using <code>make_rel()</code> function?</p>
</td></tr>
<tr><td><code id="restrict_range_+3A_...">...</code></td>
<td>
<p>additional arguments passed to subfunctions; currently not
in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>OpenSpecy</code> object with the spectral intensities within specified
ranges restricted or flattened.
</p>


<h3>Author(s)</h3>

<p>Win Cowger, Zacharias Steinmetz
</p>


<h3>See Also</h3>

<p><code><a href="#topic+conform_spec">conform_spec</a>()</code> for conforming wavenumbers to be matched with
a reference library;
<code><a href="#topic+adj_intens">adj_intens</a>()</code> for log transformation functions;
<code><a href="base.html#topic+min">min</a>()</code> and <code><a href="base.html#topic+round">round</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>test_noise &lt;- as_OpenSpecy(x = seq(400,4000, by = 10),
                           spectra = data.frame(intensity = rnorm(361)))
plot(test_noise)

restrict_range(test_noise, min = 1000, max = 2000)

flattened_intensities &lt;- flatten_range(test_noise, min = c(1000, 2000),
                                       max = c(1500, 2500))
plot(flattened_intensities)

</code></pre>

<hr>
<h2 id='run_app'>Run Open Specy app</h2><span id='topic+run_app'></span>

<h3>Description</h3>

<p>This wrapper function starts the graphical user interface of Open Specy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_app(path = "system", log = TRUE, ref = "main", test_mode = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="run_app_+3A_path">path</code></td>
<td>
<p>to store the downloaded app files; defaults to <code>"system"</code>
pointing to <code>system.file(package = "OpenSpecy")</code>.</p>
</td></tr>
<tr><td><code id="run_app_+3A_log">log</code></td>
<td>
<p>logical; enables/disables logging to <code><a href="base.html#topic+tempdir">tempdir</a>()</code></p>
</td></tr>
<tr><td><code id="run_app_+3A_ref">ref</code></td>
<td>
<p>git reference; could be a commit, tag, or branch name. Defaults to
&quot;main&quot;. Only change this in case of errors.</p>
</td></tr>
<tr><td><code id="run_app_+3A_test_mode">test_mode</code></td>
<td>
<p>logical; for internal testing only.</p>
</td></tr>
<tr><td><code id="run_app_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="shiny.html#topic+runApp">runApp</a>()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>After running this function the Open Specy GUI should open in a separate
window or in your computer browser.
</p>


<h3>Value</h3>

<p>This function normally does not return any value, see
<code><a href="shiny.html#topic+runGitHub">runGitHub</a>()</code>.
</p>


<h3>Author(s)</h3>

<p>Zacharias Steinmetz
</p>


<h3>See Also</h3>

<p><code><a href="shiny.html#topic+runGitHub">runGitHub</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
run_app()

## End(Not run)

</code></pre>

<hr>
<h2 id='share_spec'>Share data with the Open Specy community</h2><span id='topic+share_spec'></span><span id='topic+share_spec.default'></span><span id='topic+share_spec.OpenSpecy'></span>

<h3>Description</h3>

<p>This helper function shares spectral data and metadata with the Open Specy
community.
</p>
<p><strong>Please note:</strong> that <code>share_spec()</code> only provides basic sharing
functionality if used interactively. This means that files are only formatted
and saved for sharing but are not sent automatically. This only works with
hosted instances of Open Specy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>share_spec(x, ...)

## Default S3 method:
share_spec(x, ...)

## S3 method for class 'OpenSpecy'
share_spec(x, file = NULL, share = "system", credentials = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="share_spec_+3A_x">x</code></td>
<td>
<p>a list object of class <code>OpenSpecy</code>.</p>
</td></tr>
<tr><td><code id="share_spec_+3A_file">file</code></td>
<td>
<p>file to share (optional).</p>
</td></tr>
<tr><td><code id="share_spec_+3A_share">share</code></td>
<td>
<p>accepts any local directory to save the spectrum for later
sharing via email to <a href="mailto:wincowger@gmail.com">wincowger@gmail.com</a>; <code>"system"</code> (default)
uses the Open Specy package directory at <code>system.file("extdata",
package = "OpenSpecy")</code>; if a correct API token exists, <code>"cloud"</code>
shares the spectrum with the cloud.</p>
</td></tr>
<tr><td><code id="share_spec_+3A_credentials">credentials</code></td>
<td>
<p>a named list of credentials for cloud sharing; required if
<code>share = "cloud"</code>).</p>
</td></tr>
<tr><td><code id="share_spec_+3A_...">...</code></td>
<td>
<p>further arguments passed to the submethods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>share_spec()</code> returns only messages/warnings.
</p>


<h3>Author(s)</h3>

<p>Zacharias Steinmetz, Win Cowger
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read_text">read_text</a>()</code>;
<code><a href="digest.html#topic+digest">digest</a>()</code>; <code><a href="utils.html#topic+sessionInfo">sessionInfo</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("raman_hdpe")
share_spec(raman_hdpe,
           metadata = list(
             user_name = "Win Cowger",
             spectrum_type = "FTIR",
             spectrum_identity = "PE",
             license = "CC BY-NC"
           ))

## End(Not run)

</code></pre>

<hr>
<h2 id='sig_noise'>Calculate signal and noise metrics for OpenSpecy objects</h2><span id='topic+sig_noise'></span><span id='topic+sig_noise.default'></span><span id='topic+sig_noise.OpenSpecy'></span>

<h3>Description</h3>

<p>This function calculates common signal and noise metrics for <code>OpenSpecy</code>
objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sig_noise(x, ...)

## Default S3 method:
sig_noise(x, ...)

## S3 method for class 'OpenSpecy'
sig_noise(
  x,
  metric = "run_sig_over_noise",
  na.rm = TRUE,
  prob = 0.5,
  step = 20,
  breaks = seq(min(unlist(x$spectra)), max(unlist(x$spectra)), length =
    ((nrow(x$spectra)^(1/3)) * (max(unlist(x$spectra)) - min(unlist(x$spectra))))/(2 *
    IQR(unlist(x$spectra)))),
  sig_min = NULL,
  sig_max = NULL,
  noise_min = NULL,
  noise_max = NULL,
  abs = T,
  spatial_smooth = F,
  sigma = c(1, 1),
  threshold = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sig_noise_+3A_x">x</code></td>
<td>
<p>an <code>OpenSpecy</code> object.</p>
</td></tr>
<tr><td><code id="sig_noise_+3A_metric">metric</code></td>
<td>
<p>character; specifying the desired metric to calculate.
Options include <code>"sig"</code> (mean intensity), <code>"noise"</code> (standard
deviation of intensity), <code>"sig_times_noise"</code> (absolute value of
signal times noise), <code>"sig_over_noise"</code> (absolute value of signal /
noise), <code>"run_sig_over_noise"</code> (absolute value of signal /
noise where signal is estimated as the max intensity and noise is
estimated as the height of a low intensity region.),
<code>"log_tot_sig"</code> (sum of the inverse log intensities, useful for spectra  in log units),
<code>"tot_sig"</code> (sum of intensities), or <code>"entropy"</code> (Shannon entropy of intensities)..</p>
</td></tr>
<tr><td><code id="sig_noise_+3A_na.rm">na.rm</code></td>
<td>
<p>logical; indicating whether missing values should be removed
when calculating signal and noise. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="sig_noise_+3A_prob">prob</code></td>
<td>
<p>numeric single value; the probability to retrieve for the quantile where
the noise will be interpreted with the run_sig_over_noise option.</p>
</td></tr>
<tr><td><code id="sig_noise_+3A_step">step</code></td>
<td>
<p>numeric; the step size of the region to look for the run_sig_over_noise option.</p>
</td></tr>
<tr><td><code id="sig_noise_+3A_breaks">breaks</code></td>
<td>
<p>numeric; the number or positions of the breaks for entropy calculation.
Defaults to infer a decent value from the data.</p>
</td></tr>
<tr><td><code id="sig_noise_+3A_sig_min">sig_min</code></td>
<td>
<p>numeric; the minimum wavenumber value for the signal region.</p>
</td></tr>
<tr><td><code id="sig_noise_+3A_sig_max">sig_max</code></td>
<td>
<p>numeric; the maximum wavenumber value for the signal region.</p>
</td></tr>
<tr><td><code id="sig_noise_+3A_noise_min">noise_min</code></td>
<td>
<p>numeric; the minimum wavenumber value for the noise region.</p>
</td></tr>
<tr><td><code id="sig_noise_+3A_noise_max">noise_max</code></td>
<td>
<p>numeric; the maximum wavenumber value for the noise region.</p>
</td></tr>
<tr><td><code id="sig_noise_+3A_abs">abs</code></td>
<td>
<p>logical; whether to return the absolute value of the result</p>
</td></tr>
<tr><td><code id="sig_noise_+3A_spatial_smooth">spatial_smooth</code></td>
<td>
<p>logical; whether to spatially smooth the sig/noise using the xy
coordinates and a gaussian smoother.</p>
</td></tr>
<tr><td><code id="sig_noise_+3A_sigma">sigma</code></td>
<td>
<p>numeric; two value vector describing standard deviation for smoother in
each dimension, y is specified first followed by x, should be the same for each in most cases.</p>
</td></tr>
<tr><td><code id="sig_noise_+3A_threshold">threshold</code></td>
<td>
<p>numeric; if NULL, no threshold is set, otherwise use a numeric value
to set the target threshold which true signal or noise should be above. The
function will return a logical value instead of numeric if a threshold is set.</p>
</td></tr>
<tr><td><code id="sig_noise_+3A_...">...</code></td>
<td>
<p>further arguments passed to subfunctions; currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector containing the calculated metric for each spectrum in the
<code>OpenSpecy</code> object or logical value if threshold is set describing if
the numbers where above or equal to (TRUE) the threshold.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+restrict_range">restrict_range()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("raman_hdpe")

sig_noise(raman_hdpe, metric = "sig")
sig_noise(raman_hdpe, metric = "noise")
sig_noise(raman_hdpe, metric = "sig_times_noise")

</code></pre>

<hr>
<h2 id='smooth_intens'>Smooth spectral intensities</h2><span id='topic+smooth_intens'></span><span id='topic+smooth_intens.default'></span><span id='topic+smooth_intens.OpenSpecy'></span><span id='topic+calc_window_points'></span><span id='topic+calc_window_points.default'></span><span id='topic+calc_window_points.OpenSpecy'></span>

<h3>Description</h3>

<p>This smoother can enhance the signal to noise ratio of the data useing a
Savitzky-Golay or Whittaker-Henderson filter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smooth_intens(x, ...)

## Default S3 method:
smooth_intens(x, ...)

## S3 method for class 'OpenSpecy'
smooth_intens(
  x,
  polynomial = 3,
  window = 11,
  derivative = 1,
  abs = TRUE,
  lambda = 1600,
  d = 2,
  type = "sg",
  lag = 2,
  make_rel = TRUE,
  ...
)

calc_window_points(x, ...)

## Default S3 method:
calc_window_points(x, wavenum_width = 70, ...)

## S3 method for class 'OpenSpecy'
calc_window_points(x, wavenum_width = 70, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smooth_intens_+3A_x">x</code></td>
<td>
<p>an object of class <code>OpenSpecy</code> or vector for <code>calc_window_points()</code>.</p>
</td></tr>
<tr><td><code id="smooth_intens_+3A_polynomial">polynomial</code></td>
<td>
<p>polynomial order for the filter</p>
</td></tr>
<tr><td><code id="smooth_intens_+3A_window">window</code></td>
<td>
<p>number of data points in the window, filter length (must be
odd).</p>
</td></tr>
<tr><td><code id="smooth_intens_+3A_derivative">derivative</code></td>
<td>
<p>the derivative order if you want to calculate the
derivative. Zero (default) is no derivative.</p>
</td></tr>
<tr><td><code id="smooth_intens_+3A_abs">abs</code></td>
<td>
<p>logical; whether you want to calculate the absolute value of the
resulting output.</p>
</td></tr>
<tr><td><code id="smooth_intens_+3A_lambda">lambda</code></td>
<td>
<p>smoothing parameter for Whittaker-Henderson smoothing, 50 results in rough smoothing and 10^4 results in a high level of smoothing.</p>
</td></tr>
<tr><td><code id="smooth_intens_+3A_d">d</code></td>
<td>
<p>order of differences to use for Whittaker-Henderson smoothing, typically set to 2.</p>
</td></tr>
<tr><td><code id="smooth_intens_+3A_type">type</code></td>
<td>
<p>the type of smoothing to use &quot;wh&quot; for Whittaker-Henerson or &quot;sg&quot; for Savitzky-Golay.</p>
</td></tr>
<tr><td><code id="smooth_intens_+3A_lag">lag</code></td>
<td>
<p>the lag to use for the numeric derivative calculation if using Whittaker-Henderson. Greater values lead to smoother derivatives, 1 or 2 is common.</p>
</td></tr>
<tr><td><code id="smooth_intens_+3A_make_rel">make_rel</code></td>
<td>
<p>logical; if <code>TRUE</code> spectra are automatically normalized
with <code><a href="#topic+make_rel">make_rel</a>()</code>.</p>
</td></tr>
<tr><td><code id="smooth_intens_+3A_wavenum_width">wavenum_width</code></td>
<td>
<p>the width of the window you want in wavenumbers.</p>
</td></tr>
<tr><td><code id="smooth_intens_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="signal.html#topic+sgolay">sgolay</a>()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For Savitzky-Golay this is a wrapper around the filter function in the signal package to improve
integration with other Open Specy functions.
A typical good smooth can be achieved with 11 data point window and a 3rd or
4th order polynomial.
For Whittaker-Henderson, the code is largely based off of the whittaker() function in the pracma package.
In general Whittaker-Henderson is expected to be slower but more robust than Savitzky-Golay.
</p>


<h3>Value</h3>

<p><code>smooth_intens()</code> returns an <code>OpenSpecy</code> object.
</p>
<p><code>calc_window_points()</code> returns a single numberic vector object of the
number of points needed to fill the window and can be passed to <code>smooth_intens()</code>.
For many applications, this is more reusable than specifying a static number of points.
</p>


<h3>Author(s)</h3>

<p>Win Cowger, Zacharias Steinmetz
</p>


<h3>References</h3>

<p>Savitzky A, Golay MJ (1964). “Smoothing and Differentiation of Data by
Simplified Least Squares Procedures.” <em>Analytical Chemistry</em>,
<strong>36</strong>(8), 1627&ndash;1639.
</p>


<h3>See Also</h3>

<p><code><a href="signal.html#topic+sgolay">sgolay</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("raman_hdpe")

smooth_intens(raman_hdpe)

smooth_intens(raman_hdpe, window = calc_window_points(x = raman_hdpe, wavenum_width = 70))

smooth_intens(raman_hdpe, lambda = 1600, d = 2, lag = 2, type = "wh")

</code></pre>

<hr>
<h2 id='spec_res'>Spectral resolution</h2><span id='topic+spec_res'></span><span id='topic+spec_res.default'></span><span id='topic+spec_res.OpenSpecy'></span>

<h3>Description</h3>

<p>Helper function for calculating the spectral resolution from
<code>wavenumber</code> data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spec_res(x, ...)

## Default S3 method:
spec_res(x, ...)

## S3 method for class 'OpenSpecy'
spec_res(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spec_res_+3A_x">x</code></td>
<td>
<p>a numeric vector with <code>wavenumber</code> data or an <code>OpenSpecy</code>
object.</p>
</td></tr>
<tr><td><code id="spec_res_+3A_...">...</code></td>
<td>
<p>further arguments passed to subfunctions; currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The spectral resolution is the the minimum wavenumber, wavelength, or
frequency difference between two lines in a spectrum that can still be
distinguished.
</p>


<h3>Value</h3>

<p><code>spec_res()</code> returns a single numeric value.
</p>


<h3>Author(s)</h3>

<p>Win Cowger, Zacharias Steinmetz
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("raman_hdpe")

spec_res(raman_hdpe)

</code></pre>

<hr>
<h2 id='split_spec'>Split Open Specy objects</h2><span id='topic+split_spec'></span>

<h3>Description</h3>

<p>Convert a list of Open Specy objects with any number of spectra into
a list of Open Specy objects with one spectrum each.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>split_spec(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="split_spec_+3A_x">x</code></td>
<td>
<p>a list of OpenSpecy objects</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function will accept a list of Open Specy objects of any length and will split
them to their individual components. For example a list of two objects,
an Open Specy with only one spectrum and an Open Specy with 50 spectra
will return a list of length 51 each with Open Specy objects that only have
one spectrum.
</p>


<h3>Value</h3>

<p>A list of Open Specy objects each with 1 spectrum.
</p>


<h3>Author(s)</h3>

<p>Zacharias Steinmetz, Win Cowger
</p>


<h3>See Also</h3>

<p><code><a href="#topic+c_spec">c_spec</a>()</code> for combining <code>OpenSpecy</code> objects.
<code><a href="#topic+collapse_spec">collapse_spec</a>()</code> for summarizing <code>OpenSpecy</code> objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("test_lib")
data("raman_hdpe")
listed &lt;- list(test_lib, raman_hdpe)
test &lt;- split_spec(listed)
test2 &lt;- split_spec(list(test_lib))

</code></pre>

<hr>
<h2 id='subtr_baseline'>Automated background subtraction for spectral data</h2><span id='topic+subtr_baseline'></span><span id='topic+subtr_baseline.default'></span><span id='topic+subtr_baseline.OpenSpecy'></span>

<h3>Description</h3>

<p>This baseline correction routine iteratively finds the baseline of a spectrum
using a polynomial fitting or accepts a manual baseline.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subtr_baseline(x, ...)

## Default S3 method:
subtr_baseline(x, ...)

## S3 method for class 'OpenSpecy'
subtr_baseline(
  x,
  type = "polynomial",
  degree = 8,
  raw = FALSE,
  baseline,
  make_rel = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subtr_baseline_+3A_x">x</code></td>
<td>
<p>a list object of class <code>OpenSpecy</code>.</p>
</td></tr>
<tr><td><code id="subtr_baseline_+3A_type">type</code></td>
<td>
<p>one of <code>"polynomial"</code> or <code>"manual"</code> depending on
whether you want spectra to be corrected with a manual baseline or with
polynomial baseline fitting.</p>
</td></tr>
<tr><td><code id="subtr_baseline_+3A_degree">degree</code></td>
<td>
<p>the degree of the polynomial. Must be less than the number of
unique points when raw is <code>FALSE</code>. Typically a good fit can be
found with a 8th order polynomial.</p>
</td></tr>
<tr><td><code id="subtr_baseline_+3A_raw">raw</code></td>
<td>
<p>if <code>TRUE</code>, use raw and not orthogonal polynomials.</p>
</td></tr>
<tr><td><code id="subtr_baseline_+3A_baseline">baseline</code></td>
<td>
<p>an <code>OpenSpecy</code> object containing the baseline data to be
subtracted.</p>
</td></tr>
<tr><td><code id="subtr_baseline_+3A_make_rel">make_rel</code></td>
<td>
<p>logical; if <code>TRUE</code> spectra are automatically normalized
with <code><a href="#topic+make_rel">make_rel</a>()</code>.</p>
</td></tr>
<tr><td><code id="subtr_baseline_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="stats.html#topic+poly">poly</a>()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a translation of Michael Stephen Chen's MATLAB code written for the
<code>imodpolyfit</code> routine from Zhao et al. 2007.
</p>


<h3>Value</h3>

<p><code>subtr_baseline()</code> returns a data frame containing two columns named
<code>"wavenumber"</code> and <code>"intensity"</code>.
</p>


<h3>Author(s)</h3>

<p>Win Cowger, Zacharias Steinmetz
</p>


<h3>References</h3>

<p>Chen MS (2020). Michaelstchen/ModPolyFit. <em>MATLAB</em>.
Retrieved from <a href="https://github.com/michaelstchen/modPolyFit">https://github.com/michaelstchen/modPolyFit</a>
(Original work published July 28, 2015)
</p>
<p>Zhao J, Lui H, McLean DI, Zeng H (2007). “Automated Autofluorescence
Background Subtraction Algorithm for Biomedical Raman Spectroscopy.”
<em>Applied Spectroscopy</em>, <strong>61</strong>(11), 1225–1232.
<a href="https://doi.org/10.1366/000370207782597003">doi:10.1366/000370207782597003</a>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+poly">poly</a>()</code>;
<code><a href="#topic+smooth_intens">smooth_intens</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("raman_hdpe")

subtr_baseline(raman_hdpe)

</code></pre>

<hr>
<h2 id='test_lib'>Test reference library</h2><span id='topic+test_lib'></span>

<h3>Description</h3>

<p>Reference library with 29 FTIR and 28 Raman spectra used for examples and
internal testing.
</p>


<h3>Format</h3>

<p>An <code>OpenSpecy</code> object; <code>sample_name</code> is the class of the spectra.
</p>


<h3>Author(s)</h3>

<p>Win Cowger
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("test_lib")

</code></pre>

<hr>
<h2 id='write_spec'>Read and write spectral data</h2><span id='topic+write_spec'></span><span id='topic+write_spec.default'></span><span id='topic+write_spec.OpenSpecy'></span><span id='topic+read_spec'></span><span id='topic+as_hyperSpec'></span>

<h3>Description</h3>

<p>Functions for reading and writing spectral data to and from OpenSpecy format.
<code>OpenSpecy</code> objects are lists with components <code>wavenumber</code>, <code>spectra</code>,
and <code>metadata</code>. Currently supported formats are .y(a)ml, .json, .csv, or .rds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_spec(x, ...)

## Default S3 method:
write_spec(x, ...)

## S3 method for class 'OpenSpecy'
write_spec(x, file, method = NULL, digits = getOption("digits"), ...)

read_spec(file, share = NULL, method = NULL, ...)

as_hyperSpec(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_spec_+3A_x">x</code></td>
<td>
<p>an object of class <code><a href="#topic+OpenSpecy">OpenSpecy</a></code>.</p>
</td></tr>
<tr><td><code id="write_spec_+3A_file">file</code></td>
<td>
<p>file path to be read from or written to.</p>
</td></tr>
<tr><td><code id="write_spec_+3A_method">method</code></td>
<td>
<p>optional; function to be used as a custom reader or writer.
Defaults to the appropriate function based on the file extension.</p>
</td></tr>
<tr><td><code id="write_spec_+3A_digits">digits</code></td>
<td>
<p>number of significant digits to use when formatting numeric
values; defaults to <code><a href="base.html#topic+getOption">getOption</a>("digits")</code>.</p>
</td></tr>
<tr><td><code id="write_spec_+3A_share">share</code></td>
<td>
<p>defaults to <code>NULL</code>; needed to share spectra with the
Open Specy community; see <code><a href="#topic+share_spec">share_spec</a>()</code> for details.</p>
</td></tr>
<tr><td><code id="write_spec_+3A_...">...</code></td>
<td>
<p>further arguments passed to the submethods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Due to floating point number errors there may be some differences in the
precision of the numbers returned if using multiple devices for .json and
.yaml files but the numbers should be nearly identical.
<code><a href="base.html#topic+readRDS">readRDS</a>()</code> should return the exact same object every time.
</p>


<h3>Value</h3>

<p><code>read_spec()</code> reads data formatted as an <code>OpenSpecy</code> object and
returns a list object of class <code><a href="#topic+OpenSpecy">OpenSpecy</a></code> containing spectral
data.
<code>write_spec()</code> writes a file for an object of class
<code><a href="#topic+OpenSpecy">OpenSpecy</a></code> containing spectral data.
<code>as_hyperspec()</code> converts an <code>OpenSpecy</code> object to a
<code><a href="hyperSpec.html#topic+hyperSpec-class">hyperSpec-class</a></code> object.
</p>


<h3>Author(s)</h3>

<p>Zacharias Steinmetz, Win Cowger
</p>


<h3>See Also</h3>

<p><code><a href="#topic+OpenSpecy">OpenSpecy</a>()</code>;
<code><a href="#topic+read_text">read_text</a>()</code>, <code><a href="#topic+read_asp">read_asp</a>()</code>, <code><a href="#topic+read_spa">read_spa</a>()</code>,
<code><a href="#topic+read_spc">read_spc</a>()</code>, and <code><a href="#topic+read_jdx">read_jdx</a>()</code> for text files, .asp,
.spa, .spa, .spc, and .jdx formats, respectively;
<code><a href="#topic+read_zip">read_zip</a>()</code> and <code><a href="#topic+read_any">read_any</a>()</code> for wrapper functions;
<code><a href="base.html#topic+saveRDS">saveRDS</a>()</code>; <code><a href="base.html#topic+readRDS">readRDS</a>()</code>;
<code><a href="yaml.html#topic+write_yaml">write_yaml</a>()</code>; <code><a href="yaml.html#topic+read_yaml">read_yaml</a>()</code>;
<code><a href="jsonlite.html#topic+write_json">write_json</a>()</code>; <code><a href="jsonlite.html#topic+read_json">read_json</a>()</code>;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>read_extdata("raman_hdpe.yml") |&gt; read_spec()
read_extdata("raman_hdpe.json") |&gt; read_spec()
read_extdata("raman_hdpe.rds") |&gt; read_spec()
read_extdata("raman_hdpe.csv") |&gt; read_spec()

## Not run: 
data(raman_hdpe)
write_spec(raman_hdpe, "raman_hdpe.yml")
write_spec(raman_hdpe, "raman_hdpe.json")
write_spec(raman_hdpe, "raman_hdpe.rds")
write_spec(raman_hdpe, "raman_hdpe.csv")

# Convert an OpenSpecy object to a hyperSpec object
hyper &lt;- as_hyperSpec(raman_hdpe)

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
