<!DOCTYPE html><html lang="en"><head><title>Help for package MUS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MUS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MUS-package'>
<p>Monetary Unit Sampling and Estimation Methods, Widely Used in</p>
Auditing</a></li>
<li><a href='#MUS.binomial.bound'><p>Calculate a binomial bound for a Monetary Unit Sampling evaluation.</p></a></li>
<li><a href='#MUS.calc.n.conservative'><p>Calculate a conservative sample size.</p></a></li>
<li><a href='#MUS.combine'><p>Combine MUS objects (joining strata into a full set).</p></a></li>
<li><a href='#MUS.combined.high.error.rate'><p>Calculate a high error rate bound for a combined Monetary Unit Sampling evaluation.</p></a></li>
<li><a href='#MUS.evaluation'><p>Evaluate a sample using Monetary Unit Sampling.</p></a></li>
<li><a href='#MUS.extend'><p>Extend a MUS sample.</p></a></li>
<li><a href='#MUS.extraction'><p>Extract a sample using Monetary Unit Sampling.</p></a></li>
<li><a href='#MUS.factor'><p>Calculate MUS Factor.</p></a></li>
<li><a href='#MUS.moment.bound'><p>Calculate the moment bound for a Monetary Unit Sampling evaluation.</p></a></li>
<li><a href='#MUS.multinomial.bound'><p>Calculate a multinomial bound for a Monetary Unit Sampling evaluation.</p></a></li>
<li><a href='#MUS.planning'><p>Plan a sample using Monetary Unit Sampling.</p></a></li>
<li><a href='#print.MUS.evaluation.result'><p>Pretty and comprehensive printing of MUS evaluation results</p></a></li>
<li><a href='#print.MUS.extraction.result'><p>Pretty and comprehensive printing of MUS extraction results</p></a></li>
<li><a href='#print.MUS.planning.result'><p>Pretty and comprehensive printing of MUS planning results</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Monetary Unit Sampling and Estimation Methods, Widely Used in
Auditing</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-09-15</td>
</tr>
<tr>
<td>Author:</td>
<td>Henning Prömpers, André Guimarães</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Henning Prömpers &lt;henning@proempers.net&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Sampling and evaluation methods to apply Monetary Unit Sampling (or in older literature Dollar Unit Sampling) during an audit of financial statements.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0), stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>DescTools, pander</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/alsguimaraes/MUS">https://github.com/alsguimaraes/MUS</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-03-20 19:03:04 UTC; alsou</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-03-20 21:34:48 UTC</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
</table>
<hr>
<h2 id='MUS-package'>
Monetary Unit Sampling and Estimation Methods, Widely Used in
Auditing
</h2><span id='topic+MUS-package'></span><span id='topic+MUS'></span>

<h3>Description</h3>

<p>Sampling and evaluation methods to apply Monetary Unit Sampling (or in older literature Dollar Unit Sampling) during an audit of financial statements.
</p>


<h3>Details</h3>

<p>Monetary Unit Sampling (MUS), also known as Dollar
Unit Sampling (DUS) or Probability-Proportional-to-Size Sampling (PPS),
is a sampling approach that is widely used in auditing.
</p>
<p>This package was written mainly for a research project. However, it should be
possible to use the methods for practical auditing, too. Furthermore, the package comes
with ABSOLUTELY NO WARRANTY. Use it at your own risk!
</p>
<p>You have to walk through four steps:
1. Plan a sample and determine the sample size, use function: MUS.planning
2. Extract the sample, use function: MUS.extract
3. Audit the extracted sample (e.g. by asking for debtor confirmations).
4. Evaluate the audited sample, use function: MUS.evaluation
</p>


<h3>Author(s)</h3>

<p>Henning PrÃ¶mpers, AndrÃ© GuimarÃ£es
Maintainer: Henning PrÃ¶mpers &lt;henning@proempers.net&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MUS.planning">MUS.planning</a></code> for planning a sample,
<code><a href="#topic+MUS.extraction">MUS.extraction</a></code> for extraction of the planned sample and 
<code><a href="#topic+MUS.evaluation">MUS.evaluation</a></code> for evaluation of the extracted and
audited sample.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Simple Example
library(MUS)
# Assume 500 invoices, each between 1 and 1000 monetary units
example.data.1 &lt;- data.frame(book.value=round(runif(n=500, min=1,
max=1000)))
# Plan a sample and cache it
plan.results.simple &lt;- MUS.planning(data=example.data.1,
tolerable.error=100000, expected.error=20000)
# Extract a sample and cache it (no high values exist in this example)
extract.results.simple &lt;- MUS.extraction(plan.results.simple)
# Copy book values into a new column audit values
audited.sample.simple &lt;- extract.results.simple$sample
audited.sample.simple &lt;- cbind(audited.sample.simple,
audit.value=audited.sample.simple$book.value)
# Edit manually (if any audit difference occur)
#audited.sample.simple &lt;- edit(audited.sample.simple)
# Evaluate the sample, cache and print it
evaluation.results.simple &lt;- MUS.evaluation(extract.results.simple,
audited.sample.simple)
print(evaluation.results.simple)
</code></pre>

<hr>
<h2 id='MUS.binomial.bound'>Calculate a binomial bound for a Monetary Unit Sampling evaluation.</h2><span id='topic+MUS.binomial.bound'></span>

<h3>Description</h3>

<p>Calculates a binomial bound for a Monetary Unit Sampling evaluation.
</p>
<p>Please treat as experimental.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    MUS.binomial.bound(x, scope, as.pct, include.high.values, confidence.level)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MUS.binomial.bound_+3A_x">x</code></td>
<td>
<p>A MUS.evaluation.result object (or a tainting vector) used to calculate the binomial bound.</p>
</td></tr>
<tr><td><code id="MUS.binomial.bound_+3A_scope">scope</code></td>
<td>
<p>The required scope for the bound (&quot;qty&quot; or &quot;value&quot;). Default is &quot;value&quot;.</p>
</td></tr>
<tr><td><code id="MUS.binomial.bound_+3A_as.pct">as.pct</code></td>
<td>
<p>Boolean. Express results as percentage. Default is False.</p>
</td></tr>
<tr><td><code id="MUS.binomial.bound_+3A_include.high.values">include.high.values</code></td>
<td>
<p>Boolean. Whether the bound should include high values. Default is &quot;TRUE&quot;.</p>
</td></tr>
<tr><td><code id="MUS.binomial.bound_+3A_confidence.level">confidence.level</code></td>
<td>
<p>The required confidence level. Default is 95%.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Upper Error Limit calculed using the binomial bound.
</p>


<h3>Author(s)</h3>

<p>Andre Guimaraes &lt;alsguimaraes@gmail.com&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+MUS.evaluation">MUS.evaluation</a></code> for evaluation of the audited sample.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Assume 500 invoices, each between 1 and 1000 monetary units
data &lt;- data.frame(book.value=round(runif(n=500, min=1, max=1000)))
# Plan a sample and cache it
plan &lt;- MUS.planning(data=data, tolerable.error=10000, expected.error=2000)
# Extract a sample and cache it (no high values exist in this example)
extract &lt;- MUS.extraction(plan)
# Copy book value into a new column audit values, and inject some error
audited &lt;- extract$sample$book.value*(1-rbinom(nrow(extract$sample), 1, 0.05))
audited &lt;- cbind(extract$sample, audit.value=audited)
# Evaluate the sample, cache and print it
evaluation &lt;- MUS.evaluation(extract, audited)
MUS.binomial.bound(evaluation)

</code></pre>

<hr>
<h2 id='MUS.calc.n.conservative'>Calculate a conservative sample size.</h2><span id='topic+MUS.calc.n.conservative'></span>

<h3>Description</h3>

<p>Calculate a conservative sample size (AICPA, 2012).
Based on Technical Notes on the AICPA Audit Guide Audit Sampling, Trevor Stewart, AICPA, 2012.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  MUS.calc.n.conservative(confidence.level, tolerable.error, expected.error, book.value)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MUS.calc.n.conservative_+3A_confidence.level">confidence.level</code></td>
<td>
<p>dito.</p>
</td></tr>
<tr><td><code id="MUS.calc.n.conservative_+3A_tolerable.error">tolerable.error</code></td>
<td>
<p>Tolerable error in monetary units.</p>
</td></tr>
<tr><td><code id="MUS.calc.n.conservative_+3A_expected.error">expected.error</code></td>
<td>
<p>Expected error in monetary units.</p>
</td></tr>
<tr><td><code id="MUS.calc.n.conservative_+3A_book.value">book.value</code></td>
<td>
<p>Book value in monetary units.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the (conservative) sample size.
</p>


<h3>Author(s)</h3>

<p>Andre Guimaraes &lt;alsguimaraes@gmail.com&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>
MUS.calc.n.conservative(0.95, 100000, 50000, 10000000)

</code></pre>

<hr>
<h2 id='MUS.combine'>Combine MUS objects (joining strata into a full set).</h2><span id='topic+MUS.combine'></span>

<h3>Description</h3>

<p>Combine a list of MUS objects into a single object.
Typical use case is to group multiple strata into a single object.
Works with MUS.planning.result, MUS.extraction.result and MUS.evaluation.result objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  MUS.combine(object.list)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MUS.combine_+3A_object.list">object.list</code></td>
<td>
<p>A list of MUS.planning.result, MUS.extraction.result and MUS.evaluation.result objects.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the same type of the first item in the list is returned containing an aggregation of the objects in the list.
</p>


<h3>Author(s)</h3>

<p>Andre Guimaraes &lt;alsguimaraes@gmail.com&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Simple Example
# Assume 500 invoices, each between 1 and 1000 monetary units
stratum.1 &lt;- data.frame(book.value=round(runif(n=500, min=1, max=1000)))
plan.1 &lt;- MUS.planning(data=stratum.1, tolerable.error=100000, expected.error=20000)

stratum.2 &lt;- data.frame(book.value=round(runif(n=500, min=1, max=1000)))
plan.2 &lt;- MUS.planning(data=stratum.2, tolerable.error=100000, expected.error=20000)

plan.combined &lt;- MUS.combine(list(plan.1, plan.2))

print(plan.combined)
</code></pre>

<hr>
<h2 id='MUS.combined.high.error.rate'>Calculate a high error rate bound for a combined Monetary Unit Sampling evaluation.</h2><span id='topic+MUS.combined.high.error.rate'></span>

<h3>Description</h3>

<p>Calculate a high error rate bound for a combined Monetary Unit Sampling evaluation.
</p>
<p>Please treat as experimental.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    MUS.combined.high.error.rate(evaluation, interval.type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MUS.combined.high.error.rate_+3A_evaluation">evaluation</code></td>
<td>
<p>A MUS.evaluation.result object used to calculate the combined bound.</p>
</td></tr>
<tr><td><code id="MUS.combined.high.error.rate_+3A_interval.type">interval.type</code></td>
<td>
<p>Optional. Interval type for high error rate evaluation. Default is &quot;one-sided&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Upper Error Limit calculed using high error rate evaluation for a combined sample.
</p>


<h3>Author(s)</h3>

<p>Andre Guimaraes &lt;alsguimaraes@gmail.com&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+MUS.evaluation">MUS.evaluation</a></code> for evaluation of the audited sample.
<code><a href="#topic+MUS.combine">MUS.combine</a></code> for combining multiple evaluations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Assume 500 invoices, each between 1 and 1000 monetary units
data1 &lt;- data.frame(book.value=round(runif(n=500, min=1, max=1000)))
# Plan a sample and cache it
plan1 &lt;- MUS.planning(data=data1, tolerable.error=10000, expected.error=2000)
# Extract a sample and cache it (no high values exist in this example)
extract1 &lt;- MUS.extraction(plan1)
# Copy book value into a new column audit values, and inject some error
audited1 &lt;- extract1$sample$book.value*(1-rbinom(nrow(extract1$sample), 1, 0.05))
audited1 &lt;- cbind(extract1$sample, audit.value=audited1)
# Evaluate the sample, cache and print it
evaluation1 &lt;- MUS.evaluation(extract1, audited1)

# Assume 500 invoices, each between 1 and 1000 monetary units
data2 &lt;- data.frame(book.value=round(runif(n=500, min=1, max=1000)))
# Plan a sample and cache it
plan2 &lt;- MUS.planning(data=data2, tolerable.error=10000, expected.error=2000)
# Extract a sample and cache it (no high values exist in this example)
extract2 &lt;- MUS.extraction(plan2)
# Copy book value into a new column audit values, and inject some error
audited2 &lt;- extract2$sample$book.value*(1-rbinom(nrow(extract2$sample), 1, 0.05))
audited2 &lt;- cbind(extract2$sample, audit.value=audited2)
# Evaluate the sample, cache and print it
evaluation2 &lt;- MUS.evaluation(extract2, audited2)

combined &lt;- MUS.combine(list(evaluation1, evaluation2))
MUS.combined.high.error.rate(combined)

</code></pre>

<hr>
<h2 id='MUS.evaluation'>Evaluate a sample using Monetary Unit Sampling.</h2><span id='topic+MUS.evaluation'></span>

<h3>Description</h3>

<p>Evaluate a sample using Monetary Unit Sampling. At the end of the
evaluation step, you get to know the audit conclusion for the population. To
conduct the evaluation step it is required that you audited the sample
and high values before.
You can use print() for a comprehensive output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MUS.evaluation(extract, filled.sample, filled.high.values,
col.name.audit.values, col.name.riskweights,
interval.type, print.advice, tainting.order,
experimental, combined)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MUS.evaluation_+3A_extract">extract</code></td>
<td>
<p>A MUS.extraction.result object that you got by executing the
function MUS.extraction.</p>
</td></tr>
<tr><td><code id="MUS.evaluation_+3A_filled.sample">filled.sample</code></td>
<td>
<p>A data frame or matrix with the sample from the
extraction routine that have an additional column with the audit
values.</p>
</td></tr>
<tr><td><code id="MUS.evaluation_+3A_filled.high.values">filled.high.values</code></td>
<td>
<p>A data frame or matrix with the high value
items from the extraction routine that have an additional column
with the audit values.</p>
</td></tr>
<tr><td><code id="MUS.evaluation_+3A_col.name.audit.values">col.name.audit.values</code></td>
<td>
<p>Single character with the name of the
column containing the audit value in filled.sample respectively
filled.high.values. Default is &quot;audit.value&quot;.</p>
</td></tr>
<tr><td><code id="MUS.evaluation_+3A_col.name.riskweights">col.name.riskweights</code></td>
<td>
<p>Single character with the name of the
column containing the risk weights in filled.sample respectively
filled.high.values. Default is NULL, then no risk weights are
included in the calcualations (the ordinary MUS case).</p>
</td></tr>
<tr><td><code id="MUS.evaluation_+3A_interval.type">interval.type</code></td>
<td>
<p>Interval type for high error rate evaluation. Default is &quot;one-sided&quot;.</p>
</td></tr>
<tr><td><code id="MUS.evaluation_+3A_print.advice">print.advice</code></td>
<td>
<p>Boolean. Prints recommendations only if TRUE. Default is &quot;TRUE&quot;.</p>
</td></tr>
<tr><td><code id="MUS.evaluation_+3A_tainting.order">tainting.order</code></td>
<td>
<p>Calculates UEL with different tainting orders (increasing, absolute, random). Default is &quot;decreasing&quot;.</p>
</td></tr>
<tr><td><code id="MUS.evaluation_+3A_experimental">experimental</code></td>
<td>
<p>Boolean. Calculates other bounds, such as momentum, binomial, multinomial. Not ready for production. Default is &quot;FALSE&quot;.</p>
</td></tr>
<tr><td><code id="MUS.evaluation_+3A_combined">combined</code></td>
<td>
<p>Boolean. Marks the dataset as a combination of multiple strata. Default is &quot;FALSE&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object MUS.evaluation.result is returned which is a list containing
the following elements:
</p>
<table role = "presentation">
<tr><td><code>MUS.extraction.result elements</code></td>
<td>
<p>All elements that are contained
in MUS.extraction.result object. For auditing acceptability and for further steps all inputs are
also returned.</p>
</td></tr>
<tr><td><code>filled.sample</code></td>
<td>
<p>dito.</p>
</td></tr>
<tr><td><code>filled.high.values</code></td>
<td>
<p>dito.</p>
</td></tr>
<tr><td><code>col.name.audit.values</code></td>
<td>
<p>dito.</p>
</td></tr>
<tr><td><code>Overstatements.Result.Details</code></td>
<td>
<p>Detail table for overstatements
found in the sample.</p>
</td></tr>
<tr><td><code>Understatements.Result.Details</code></td>
<td>
<p>Detail table for understatements
found in the sample.</p>
</td></tr>
<tr><td><code>Results.Sample</code></td>
<td>
<p>Comprehensive results of sample evaluation.</p>
</td></tr>
<tr><td><code>Results.High.values</code></td>
<td>
<p>Comprehensive results of individually
significant item evaluation.</p>
</td></tr>
<tr><td><code>Results.Total</code></td>
<td>
<p>Comprehensive results of both evaluations (sample
and individual significant items).</p>
</td></tr>
<tr><td><code>acceptable</code></td>
<td>
<p>Boolean, if population is acceptable given results,
confidence level and materiality.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Henning Prömpers &lt;henning@proempers.net&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Simple Example
# Assume 500 invoices, each between 1 and 1000 monetary units
example.data.1 &lt;- data.frame(book.value=round(runif(n=500, min=1,
max=1000)))
# Plan a sample and cache it
plan.results.simple &lt;- MUS.planning(data=example.data.1,
tolerable.error=100000, expected.error=20000)
# Extract a sample and cache it (no high values exist in this example)
extract.results.simple &lt;- MUS.extraction(plan.results.simple)
# Copy book value into a new column audit values
audited.sample.simple &lt;- extract.results.simple$sample
audited.sample.simple &lt;- cbind(audited.sample.simple,
audit.value=audited.sample.simple$book.value)
# Edit manually (if any audit difference occur)
#audited.sample.simple &lt;- edit(audited.sample.simple)
# Evaluate the sample, cache and print it
evaluation.results.simple &lt;- MUS.evaluation(extract.results.simple,
audited.sample.simple)
print(evaluation.results.simple)

## Advanced Example
example.data.2 &lt;- data.frame(own.name.of.book.values=round(runif(n=500,
min=1, max=1000)))
plan.results.advanced &lt;- MUS.planning(data=example.data.2,
col.name.book.values="own.name.of.book.values", confidence.level=.70,
tolerable.error=100000, expected.error=20000, n.min=3)
extract.results.advanced &lt;- MUS.extraction(plan.results.advanced,
start.point=5, seed=1, obey.n.as.min=TRUE)
extract.results.advanced &lt;- MUS.extraction(plan.results.advanced)
audited.sample.advanced &lt;- extract.results.advanced$sample
audited.sample.advanced &lt;- cbind(audited.sample.advanced,
own.name.of.audit.values=audited.sample.advanced$own.name.of.book.values)
#audited.sample.advanced &lt;- edit(audited.sample.advanced)
evaluation.results.advanced &lt;- MUS.evaluation(extract.results.advanced,
audited.sample.advanced,
col.name.audit.values="own.name.of.audit.values")
print(evaluation.results.advanced)
</code></pre>

<hr>
<h2 id='MUS.extend'>Extend a MUS sample.</h2><span id='topic+MUS.extend'></span>

<h3>Description</h3>

<p>Extends a sample that requires further evidence.
Works with MUS.extraction.result.
</p>
<p>Please treat as experimental.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  MUS.extend(extract, new_plan=NULL, additional.n=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MUS.extend_+3A_extract">extract</code></td>
<td>
<p>An object of the type MUS.extraction.result to be extended.</p>
</td></tr>
<tr><td><code id="MUS.extend_+3A_new_plan">new_plan</code></td>
<td>
<p>Provide a new MUS plan. If null, you must provide the qty of items to extend the sample.</p>
</td></tr>
<tr><td><code id="MUS.extend_+3A_additional.n">additional.n</code></td>
<td>
<p>Ignored if new_plan is provided, otherwise sample will be extended by additional.n items</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an extended MUS.extraction.result object.
</p>


<h3>Author(s)</h3>

<p>Andre Guimaraes &lt;alsguimaraes@gmail.com&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Simple Example
# Assume 500 invoices
mydata &lt;- data.frame(book.value=
  round(c(runif(n=480, min=10,max=20000),
  runif(n=20, min=15000,max=50000)))
)

# Plan a sample and cache it
plan &lt;- MUS.planning(data=mydata,
tolerable.error=50000, expected.error=3000)

# Extract a sample and cache it
extract &lt;- MUS.extraction(plan, obey.n.as.min=TRUE)

# Create a new plan
new_plan &lt;- MUS.planning(data=mydata,
tolerable.error=50000, expected.error=5000)

# extends the sample using the new plan
extended &lt;- MUS.extend(extract, new_plan)

# extends the sample by 20 itens using the original plan
extended20 &lt;- MUS.extend(extract, additional.n=20)

</code></pre>

<hr>
<h2 id='MUS.extraction'>Extract a sample using Monetary Unit Sampling.</h2><span id='topic+MUS.extraction'></span>

<h3>Description</h3>

<p>Extract a sample using Monetary Unit Sampling. At the end of the
extraction step, you get to know the items that you have to audit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MUS.extraction(plan, start.point, seed, obey.n.as.min, combined)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MUS.extraction_+3A_plan">plan</code></td>
<td>
<p>A MUS.planning.result object that you got by executing the
function MUS.planning.</p>
</td></tr>
<tr><td><code id="MUS.extraction_+3A_start.point">start.point</code></td>
<td>
<p>The extraction method uses fixed interval
sampling. The monetary unit specified by start.point will be
drawn in each interval. Default is NULL, in this case a random
number is drawn.</p>
</td></tr>
<tr><td><code id="MUS.extraction_+3A_seed">seed</code></td>
<td>
<p>A seed number which will be used to initialise the random
number generator. Default is NULL which means that no new random
number generator is initialised. This argument is mainly used for
simulations or if you want to be able to regenerate the sample on
another computer.</p>
</td></tr>
<tr><td><code id="MUS.extraction_+3A_obey.n.as.min">obey.n.as.min</code></td>
<td>
<p>Boolean. If set to TRUE, the sample interval will be
exactly recalculated and thus the sample size will be exactly the
planned sample size. Default is FALSE which is what most commercial
statistical software do. In this case the drawn sample size might be
slightly smaller than specified.</p>
</td></tr>
<tr><td><code id="MUS.extraction_+3A_combined">combined</code></td>
<td>
<p>Boolean. Marks the dataset as a combination of multiple strata. Default is &quot;FALSE&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object MUS.extraction.result is returned which is a list containing
the following elements:
</p>
<table role = "presentation">
<tr><td><code>MUS.planning.result elements</code></td>
<td>
<p>All elements that are contained in
MUS.planning.result object. For auditing acceptability and for further steps all inputs are
also returned.</p>
</td></tr>
<tr><td><code>start.point</code></td>
<td>
<p>dito.</p>
</td></tr>
<tr><td><code>seed</code></td>
<td>
<p>dito.</p>
</td></tr>
<tr><td><code>obey.n.as.min</code></td>
<td>
<p>dito.</p>
</td></tr>
<tr><td><code>high.values</code></td>
<td>
<p>The part of the population that is classified as
individually significant items. All of them have to be audited.</p>
</td></tr>
<tr><td><code>sample.population</code></td>
<td>
<p>The part of the population that is not in the
high-values-subpopulation.</p>
</td></tr>
<tr><td><code>sampling.interval</code></td>
<td>
<p>The reassessed sampling interval that have to
be used for evaluation.</p>
</td></tr>
<tr><td><code>sample</code></td>
<td>
<p>The extracted sample. All elements have to be audited.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Henning Prömpers &lt;henning@proempers.net&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+MUS.planning">MUS.planning</a></code> for planning a sample and
<code><a href="#topic+MUS.evaluation">MUS.evaluation</a></code> for evaluation of the extracted and
audited sample.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Simple Example
# Assume 500 invoices, each between 1 and 1000 monetary units
example.data.1 &lt;- data.frame(book.value=round(runif(n=500, min=1,
max=1000)))
# Plan a sample and cache it
plan.results.simple &lt;- MUS.planning(data=example.data.1,
tolerable.error=100000, expected.error=20000)
# Extract a sample and cache it
extract.results.simple &lt;- MUS.extraction(plan.results.simple)

## Advanced Example
example.data.2 &lt;- data.frame(own.name.of.book.values=round(runif(n=500,
min=1, max=1000)))
plan.results.advanced &lt;- MUS.planning(data=example.data.2,
col.name.book.values="own.name.of.book.values", confidence.level=.70,
tolerable.error=100000, expected.error=20000, n.min=3)
extract.results.advanced &lt;- MUS.extraction(plan.results.advanced,
start.point=5, seed=0, obey.n.as.min=TRUE)
</code></pre>

<hr>
<h2 id='MUS.factor'>Calculate MUS Factor.</h2><span id='topic+MUS.factor'></span>

<h3>Description</h3>

<p>Calculate MUS Factor (AICPA, 2012).
Based on Technical Notes on the AICPA Audit Guide Audit Sampling, Trevor Stewart, AICPA, 2012.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  MUS.factor(confidence.level, pct.ratio)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MUS.factor_+3A_confidence.level">confidence.level</code></td>
<td>
<p>dito.</p>
</td></tr>
<tr><td><code id="MUS.factor_+3A_pct.ratio">pct.ratio</code></td>
<td>
<p>Expected.error by tolerable.error.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the MUS factor.
</p>


<h3>Author(s)</h3>

<p>Andre Guimaraes &lt;alsguimaraes@gmail.com&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>
MUS.factor(0.95, 0.5)

</code></pre>

<hr>
<h2 id='MUS.moment.bound'>Calculate the moment bound for a Monetary Unit Sampling evaluation.</h2><span id='topic+MUS.moment.bound'></span>

<h3>Description</h3>

<p>Calculates the moment bound (Dworkin &amp; Grimlund, 1984) for a Monetary Unit Sampling evaluation.
</p>
<p>Please treat as experimental.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    MUS.moment.bound(x, confidence.level, as.pct, include.high.values)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MUS.moment.bound_+3A_x">x</code></td>
<td>
<p>A MUS.evaluation.result object (or a tainting vector) used to calculate the moment bound.</p>
</td></tr>
<tr><td><code id="MUS.moment.bound_+3A_confidence.level">confidence.level</code></td>
<td>
<p>The required confidence level. Default is 95%.</p>
</td></tr>
<tr><td><code id="MUS.moment.bound_+3A_as.pct">as.pct</code></td>
<td>
<p>Boolean. Express results as percentage. Default is False.</p>
</td></tr>
<tr><td><code id="MUS.moment.bound_+3A_include.high.values">include.high.values</code></td>
<td>
<p>Boolean. Whether the bound should include high values. Default is &quot;TRUE&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Upper Error Limit calculed using the moment bound.
</p>


<h3>Author(s)</h3>

<p>Andre Guimaraes &lt;alsguimaraes@gmail.com&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+MUS.evaluation">MUS.evaluation</a></code> for evaluation of the audited sample.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sample = c(rep(0, 96), -.16, .04, .18, .47)
MUS.moment.bound(sample)

# Assume 500 invoices, each between 1 and 1000 monetary units
data &lt;- data.frame(book.value=round(runif(n=500, min=1, max=1000)))
# Plan a sample and cache it
plan &lt;- MUS.planning(data=data, tolerable.error=10000, expected.error=2000)
# Extract a sample and cache it (no high values exist in this example)
extract &lt;- MUS.extraction(plan)
# Copy book value into a new column audit values, and inject some error
audited &lt;- extract$sample$book.value*(1-rbinom(nrow(extract$sample), 1, 0.05))
audited &lt;- cbind(extract$sample, audit.value=audited)
# Evaluate the sample, cache and print it
evaluation &lt;- MUS.evaluation(extract, audited)
MUS.moment.bound(evaluation)

</code></pre>

<hr>
<h2 id='MUS.multinomial.bound'>Calculate a multinomial bound for a Monetary Unit Sampling evaluation.</h2><span id='topic+MUS.multinomial.bound'></span>

<h3>Description</h3>

<p>Calculates a multinomial bound for a Monetary Unit Sampling evaluation.
</p>
<p>Please treat as experimental.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    MUS.multinomial.bound(x, as.pct, include.high.values)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MUS.multinomial.bound_+3A_x">x</code></td>
<td>
<p>A MUS.evaluation.result object used to calculate the multinomial bound.</p>
</td></tr>
<tr><td><code id="MUS.multinomial.bound_+3A_as.pct">as.pct</code></td>
<td>
<p>Boolean. Express results as percentage. Default is False.</p>
</td></tr>
<tr><td><code id="MUS.multinomial.bound_+3A_include.high.values">include.high.values</code></td>
<td>
<p>Boolean. Whether the bound should include high values. Default is &quot;TRUE&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Upper Error Limit calculed using the multinomial bound.
</p>


<h3>Author(s)</h3>

<p>Andre Guimaraes &lt;alsguimaraes@gmail.com&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+MUS.evaluation">MUS.evaluation</a></code> for evaluation of the audited sample.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Assume 500 invoices, each between 1 and 1000 monetary units
data &lt;- data.frame(book.value=round(runif(n=500, min=1, max=1000)))
# Plan a sample and cache it
plan &lt;- MUS.planning(data=data, tolerable.error=10000, expected.error=2000)
# Extract a sample and cache it (no high values exist in this example)
extract &lt;- MUS.extraction(plan)
# Copy book value into a new column audit values, and inject some error
audited &lt;- extract$sample$book.value*(1-rbinom(nrow(extract$sample), 1, 0.05))
audited &lt;- cbind(extract$sample, audit.value=audited)
# Evaluate the sample, cache and print it
evaluation &lt;- MUS.evaluation(extract, audited)
MUS.multinomial.bound(evaluation)

</code></pre>

<hr>
<h2 id='MUS.planning'>Plan a sample using Monetary Unit Sampling.</h2><span id='topic+MUS.planning'></span>

<h3>Description</h3>

<p>Plan a sample for Monetary Unit Sampling. At the end of this planning step,
you get to know the sample size.
</p>
<p>Be aware that this MUS routines cannot calculate with
decimals. Furthermore, you must provide book values etc. as Euro-Cent so that no decimals occur.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MUS.planning(data, col.name.book.values, confidence.level,
tolerable.error, expected.error, n.min, errors.as.pct, conservative, combined)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MUS.planning_+3A_data">data</code></td>
<td>
<p>A data frame or matrix which contains at least one column
with the book values.</p>
</td></tr>
<tr><td><code id="MUS.planning_+3A_col.name.book.values">col.name.book.values</code></td>
<td>
<p>The name of the column that
contains the book values. Default is &quot;book.value&quot;.</p>
</td></tr>
<tr><td><code id="MUS.planning_+3A_confidence.level">confidence.level</code></td>
<td>
<p>The required confidence level. Default is
95%.</p>
</td></tr>
<tr><td><code id="MUS.planning_+3A_tolerable.error">tolerable.error</code></td>
<td>
<p>The tolerable error (materiality) in Monetary
Units.</p>
</td></tr>
<tr><td><code id="MUS.planning_+3A_expected.error">expected.error</code></td>
<td>
<p>The expected error which is contained in the
population in Monetary Units.</p>
</td></tr>
<tr><td><code id="MUS.planning_+3A_n.min">n.min</code></td>
<td>
<p>Minimum sample size that should be used. Default is 0.</p>
</td></tr>
<tr><td><code id="MUS.planning_+3A_errors.as.pct">errors.as.pct</code></td>
<td>
<p>Boolean. Tolerable and Expected error informed as percentages. Default is False.</p>
</td></tr>
<tr><td><code id="MUS.planning_+3A_conservative">conservative</code></td>
<td>
<p>Boolean. If true, use greater sample size between normal calculation and
conservative algorithm (i.e., gamma-based, AICPA compatible).</p>
</td></tr>
<tr><td><code id="MUS.planning_+3A_combined">combined</code></td>
<td>
<p>Boolean. Marks the dataset as a combination of multiple strata. Default is &quot;FALSE&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object MUS.planning.result is returned which is a list containing
the following elements:
</p>
<table role = "presentation">
<tr><td><code>data</code></td>
<td>
<p>For auditing acceptability and for further steps all inputs are
also returned.</p>
</td></tr>
<tr><td><code>col.name.book.values</code></td>
<td>
<p>dito.</p>
</td></tr>
<tr><td><code>confidence.level</code></td>
<td>
<p>dito.</p>
</td></tr>
<tr><td><code>tolerable.error</code></td>
<td>
<p>dito.</p>
</td></tr>
<tr><td><code>expected.error</code></td>
<td>
<p>dito.</p>
</td></tr>
<tr><td><code>book.value</code></td>
<td>
<p>The calculated gross book value of the
population. Negative values are ignored.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>The calculated sample size based on the input parameters
which is greater or egal than the provided minimum sample size.</p>
</td></tr>
<tr><td><code>High.value.threshold</code></td>
<td>
<p>Whenever a book value of an element is above the
threshold, the element will be considered individually
significant. Individual significant items will be audited completely,
no sample extrapolation will be necessary.</p>
</td></tr>
<tr><td><code>tolerable.taintings</code></td>
<td>
<p>The number of taintings in the sample that will be
acceptable at maximum.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Henning Prömpers &lt;henning@proempers.net&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+MUS.extraction">MUS.extraction</a></code> for extraction of the planned sample and
<code><a href="#topic+MUS.evaluation">MUS.evaluation</a></code> for evaluation of the extracted and
audited sample.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Simple Example
# Assume 500 invoices, each between 1 and 1000 monetary units
example.data.1 &lt;- data.frame(book.value=round(runif(n=500, min=1,
max=1000)))
# Plan a sample and cache it
plan.results.simple &lt;- MUS.planning(data=example.data.1,
tolerable.error=100000, expected.error=20000)

## Advanced Example
example.data.2 &lt;- data.frame(own.name.of.book.values=round(runif(n=500,
min=1, max=1000)))
plan.results.advanced &lt;- MUS.planning(data=example.data.2,
col.name.book.values="own.name.of.book.values", confidence.level=.70,
tolerable.error=100000, expected.error=20000, n.min=3)
</code></pre>

<hr>
<h2 id='print.MUS.evaluation.result'>Pretty and comprehensive printing of MUS evaluation results</h2><span id='topic+print.MUS.evaluation.result'></span>

<h3>Description</h3>

<p>Pretty and comprehensive printing of MUS evaluation results that can
be used for working papers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MUS.evaluation.result'
print(x, error.rate, print.misstatements,
  print.planning, print.extraction, print.error.as.pct, print.advice,
	style, use.pander, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.MUS.evaluation.result_+3A_x">x</code></td>
<td>
<p>A MUS.evaluation.result object that you got by executing the
function MUS.evaluation.</p>
</td></tr>
<tr><td><code id="print.MUS.evaluation.result_+3A_error.rate">error.rate</code></td>
<td>
<p>Selects type of error rate calculation (i.e., &quot;high&quot;, &quot;low&quot;, &quot;both&quot; or &quot;auto&quot;). Defaults to &quot;auto&quot;.</p>
</td></tr>
<tr><td><code id="print.MUS.evaluation.result_+3A_print.misstatements">print.misstatements</code></td>
<td>
<p>Boolean. Should misstatements table be printed? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="print.MUS.evaluation.result_+3A_print.planning">print.planning</code></td>
<td>
<p>Boolean. Should planning parameters be printed? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="print.MUS.evaluation.result_+3A_print.extraction">print.extraction</code></td>
<td>
<p>Boolean. Should extraction parameters be printed? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="print.MUS.evaluation.result_+3A_print.error.as.pct">print.error.as.pct</code></td>
<td>
<p>Boolean. Should errors as percentage be printed? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="print.MUS.evaluation.result_+3A_print.advice">print.advice</code></td>
<td>
<p>Boolean. Should recommendations be printed? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="print.MUS.evaluation.result_+3A_style">style</code></td>
<td>
<p>Two options: &quot;report&quot; or &quot;default&quot;. Report uses an alternative layout. Defaults to &quot;default&quot;.</p>
</td></tr>
<tr><td><code id="print.MUS.evaluation.result_+3A_use.pander">use.pander</code></td>
<td>
<p>Boolean. Uses pander to generate rmarkdown report. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="print.MUS.evaluation.result_+3A_...">...</code></td>
<td>
<p>Further arguments, currently ignored.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Henning Prömpers &lt;henning@proempers.net&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+MUS.evaluation">MUS.evaluation</a></code> for evaluation of the extracted and
audited sample.
</p>

<hr>
<h2 id='print.MUS.extraction.result'>Pretty and comprehensive printing of MUS extraction results</h2><span id='topic+print.MUS.extraction.result'></span>

<h3>Description</h3>

<p>Pretty and comprehensive printing of MUS extraction results that can
be used for working papers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MUS.extraction.result'
print(x, print.title,
  print.planning, style, use.pander, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.MUS.extraction.result_+3A_x">x</code></td>
<td>
<p>A MUS.evaluation.result object that you got by executing the
function MUS.evaluation.</p>
</td></tr>
<tr><td><code id="print.MUS.extraction.result_+3A_print.title">print.title</code></td>
<td>
<p>Boolean. Should title be printed? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="print.MUS.extraction.result_+3A_print.planning">print.planning</code></td>
<td>
<p>Boolean. Should planning parameters be printed? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="print.MUS.extraction.result_+3A_style">style</code></td>
<td>
<p>Two options: &quot;report&quot; or &quot;default&quot;. Report uses an alternative layout. Defaults to &quot;default&quot;.</p>
</td></tr>
<tr><td><code id="print.MUS.extraction.result_+3A_use.pander">use.pander</code></td>
<td>
<p>Boolean. Uses pander to generate rmarkdown report. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="print.MUS.extraction.result_+3A_...">...</code></td>
<td>
<p>Further arguments, currently ignored.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Henning Prömpers &lt;henning@proempers.net&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+MUS.extraction">MUS.extraction</a></code> for extraction of the audit sample.
</p>

<hr>
<h2 id='print.MUS.planning.result'>Pretty and comprehensive printing of MUS planning results</h2><span id='topic+print.MUS.planning.result'></span>

<h3>Description</h3>

<p>Pretty and comprehensive printing of MUS planning results that can
be used for working papers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MUS.planning.result'
print(x, print.title,
  style, use.pander, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.MUS.planning.result_+3A_x">x</code></td>
<td>
<p>A MUS.evaluation.result object that you got by executing the
function MUS.evaluation.</p>
</td></tr>
<tr><td><code id="print.MUS.planning.result_+3A_print.title">print.title</code></td>
<td>
<p>Boolean. Should title be printed? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="print.MUS.planning.result_+3A_style">style</code></td>
<td>
<p>Two options: &quot;report&quot; or &quot;default&quot;. Report uses an alternative layout. Defaults to &quot;default&quot;.</p>
</td></tr>
<tr><td><code id="print.MUS.planning.result_+3A_use.pander">use.pander</code></td>
<td>
<p>Boolean. Uses pander to generate rmarkdown report. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="print.MUS.planning.result_+3A_...">...</code></td>
<td>
<p>Further arguments, currently ignored.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Henning Prömpers &lt;henning@proempers.net&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+MUS.planning">MUS.planning</a></code> for planning of the audit sample.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
