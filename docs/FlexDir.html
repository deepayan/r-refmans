<!DOCTYPE html><html lang="en"><head><title>Help for package FlexDir</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FlexDir}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#FD.aicbic'><p>Information Criterions of a Flexible Dirichlet Model</p></a></li>
<li><a href='#FD.amalgamation'><p>Amalgamation</p></a></li>
<li><a href='#FD.barycenters'><p>Cluster Barycenters of a Flexible Dirichlet model</p></a></li>
<li><a href='#FD.clusterdistances'><p>Flexible Dirichlet Cluster Distances</p></a></li>
<li><a href='#FD.density'><p>The Flexible Dirichlet Density Function</p></a></li>
<li><a href='#FD.estimation'><p>Flexible Dirichlet Estimation</p></a></li>
<li><a href='#FD.generate'><p>The Flexible Dirichlet Random Generation</p></a></li>
<li><a href='#FD.marginalplot'><p>Marginal Plot of a Flexible Dirichlet</p></a></li>
<li><a href='#FD.moments'><p>Flexible Dirichlet Moments</p></a></li>
<li><a href='#FD.normalization'><p>Normalization</p></a></li>
<li><a href='#FD.rightplot'><p>Right Triangle Plot of a Flexible Dirichlet</p></a></li>
<li><a href='#FD.stddev'><p>Standard Deviation of the ML estimators of a Flexible Dirichlet</p></a></li>
<li><a href='#FD.subcomposition'><p>Subcomposition</p></a></li>
<li><a href='#FD.ternaryplot'><p>Ternary Plot of a Flexible Dirichlet</p></a></li>
<li><a href='#FD.theorcontours'><p>Contour Lines of a Flexible Dirichlet</p></a></li>
<li><a href='#oliveoil'><p>Olive oil data</p></a></li>
<li><a href='#plot.FDfitted'><p>Plot Method for FDfitted Objects</p></a></li>
<li><a href='#print.FDfitted'><p>Print Method for FDfitted Objects</p></a></li>
<li><a href='#summary.FDfitted'><p>Summary Method for FDfitted Objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools to Work with the Flexible Dirichlet Distribution</td>
</tr>
<tr>
<td>Author:</td>
<td>Sonia Migliorati [aut],
  Agnese Maria Di Brisco [aut, cre],
  Matteo Vestrucci [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Agnese Maria Di Brisco &lt;agnese.dibrisco@unimib.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides tools to work with the Flexible Dirichlet
    distribution. The main features are an E-M algorithm for computing the maximum
    likelihood estimate of the parameter vector and a function based on conditional
    bootstrap to estimate its asymptotic variance-covariance matrix. It contains
    also functions to plot graphs, to generate random observations and to handle
    compositional data.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, utils, grDevices</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-08-07 08:47:02 UTC; everett</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.0</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-03-16 13:35:03</td>
</tr>
</table>
<hr>
<h2 id='FD.aicbic'>Information Criterions of a Flexible Dirichlet Model</h2><span id='topic+FD.aicbic'></span>

<h3>Description</h3>

<p>Akaike Information Criterion (AIC) and Bayesian Information Criterion (BIC) of a fitted Flexible Dirichlet model.
An Information Criterion for one fitted model object for which a log-likelihood value can be obtained is defined as
<code class="reqn"> -2*log-likelihood + k*npar</code>, where <code class="reqn"> npar</code> represents the number of parameters in the fitted model, and <code class="reqn"> k = 2</code> for AIC, or <code class="reqn"> k = log(n)</code> for BIC (<code class="reqn"> n</code> being the number of observations).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FD.aicbic(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FD.aicbic_+3A_x">x</code></td>
<td>
<p>an object of class FDfitted, usually the result of <code><a href="#topic+FD.estimation">FD.estimation</a></code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+FD.estimation">FD.estimation</a></code>, <code><a href="#topic+FD.stddev">FD.stddev</a></code>, <code><a href="#topic+FD.barycenters">FD.barycenters</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- FD.generate(n=20,a=c(12,7,15),p=c(0.3,0.4,0.3),t=8)
data
results &lt;- FD.estimation(data, normalize=TRUE,iter.initial.SEM = 5,iter.final.EM = 10)
results
FD.aicbic(results)

</code></pre>

<hr>
<h2 id='FD.amalgamation'>Amalgamation</h2><span id='topic+FD.amalgamation'></span>

<h3>Description</h3>

<p>Given a matrix or a numeric dataframe, this function returns a composition where a set of specified columns is amalgamated together.
The compositional operation of amalgamation  provides sums of composition elements aimed at grouping homogeneous parts of the whole.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FD.amalgamation(data, columns, name = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FD.amalgamation_+3A_data">data</code></td>
<td>
<p>a matrix or a dataframe containing only variables to be transformed into compositional variables, after amalgamation.</p>
</td></tr>
<tr><td><code id="FD.amalgamation_+3A_columns">columns</code></td>
<td>
<p>numeric vector containing the position of the columns to be amalgamated together.</p>
</td></tr>
<tr><td><code id="FD.amalgamation_+3A_name">name</code></td>
<td>
<p>string containing the name of the new column resulted from the amalgamation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Values must be positive. In case one row-entry (or more) is NA, the whole row will be returned as NA.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+FD.generate">FD.generate</a></code>, <code><a href="#topic+FD.subcomposition">FD.subcomposition</a></code>, <code><a href="#topic+FD.normalization">FD.normalization</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oliveoil)
dataoil &lt;- oliveoil
head(dataoil)
data &lt;- FD.normalization(dataoil[,3:10])
head(data)
data.sub &lt;- FD.subcomposition(data,c(1,3,4,5))
head(data.sub)
data.amalg &lt;- FD.amalgamation(data,c(2,6,7,8),name='others')
head(data.amalg)

</code></pre>

<hr>
<h2 id='FD.barycenters'>Cluster Barycenters of a Flexible Dirichlet model</h2><span id='topic+FD.barycenters'></span>

<h3>Description</h3>

<p>Cluster barycenters of a fitted Flexible Dirichlet distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FD.barycenters(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FD.barycenters_+3A_x">x</code></td>
<td>
<p>an object of class FDfitted, usually the result of <code><a href="#topic+FD.estimation">FD.estimation</a></code>.</p>
</td></tr>
</table>


<h3>References</h3>


<p>Ongaro, A. and Migliorati, S. (2013) A generalization of the Dirichlet distribution. Journal of Multivariate Analysis, <b>114</b>, 412&ndash;426.<br />
<br />
Migliorati, S., Ongaro, A. and Monti, G. S. (2016) A structured Dirichlet mixture model for compositional data: inferential and applicative issues. Statistics and Computing, doi:10.1007/s11222-016-9665-y.

</p>


<h3>See Also</h3>

<p><code><a href="#topic+FD.estimation">FD.estimation</a></code>, <code><a href="#topic+FD.clusterdistances">FD.clusterdistances</a></code>, <code><a href="#topic+FD.moments">FD.moments</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- FD.generate(n=20,a=c(12,7,15),p=c(0.3,0.4,0.3),t=8)
data
results &lt;- FD.estimation(data, normalize=TRUE,iter.initial.SEM = 5,iter.final.EM = 10)
results
FD.barycenters(results)


</code></pre>

<hr>
<h2 id='FD.clusterdistances'>Flexible Dirichlet Cluster Distances</h2><span id='topic+FD.clusterdistances'></span>

<h3>Description</h3>

<p>Returns a measure of symmetrized Kullback-Leibler distance between mixture component densities of a fitted Flexible Dirichlet distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FD.clusterdistances(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FD.clusterdistances_+3A_x">x</code></td>
<td>
<p>an object of class FDfitted, usually the result of <code><a href="#topic+FD.estimation">FD.estimation</a></code>.</p>
</td></tr>
</table>


<h3>References</h3>


<p>Ongaro, A. and Migliorati, S. (2013) A generalization of the Dirichlet distribution. Journal of Multivariate Analysis, <b>114</b>, 412&ndash;426.<br />
<br />
Migliorati, S., Ongaro, A. and Monti, G. S. (2016) A structured Dirichlet mixture model for compositional data: inferential and applicative issues. Statistics and Computing, doi:10.1007/s11222-016-9665-y.

</p>


<h3>See Also</h3>

<p><code><a href="#topic+FD.estimation">FD.estimation</a></code>, <code><a href="#topic+FD.barycenters">FD.barycenters</a></code>, <code><a href="#topic+FD.moments">FD.moments</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- FD.generate(n=20,a=c(12,7,15),p=c(0.3,0.4,0.3),t=8)
data
results &lt;- FD.estimation(data, normalize=TRUE,iter.initial.SEM = 5,iter.final.EM = 10)
results
FD.clusterdistances(results)


</code></pre>

<hr>
<h2 id='FD.density'>The Flexible Dirichlet Density Function</h2><span id='topic+FD.density'></span>

<h3>Description</h3>

<p>Density function on the simplex for the Flexible Dirichlet distribution with parameters <code>a</code>, <code>p</code> and <code>t</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FD.density(x, a, p, t)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FD.density_+3A_x">x</code></td>
<td>
<p>vector of a point on the simplex. It must sum to one.</p>
</td></tr>
<tr><td><code id="FD.density_+3A_a">a</code></td>
<td>
<p>vector of the non-negative alpha parameters.</p>
</td></tr>
<tr><td><code id="FD.density_+3A_p">p</code></td>
<td>
<p>vector of the clusters' probabilities. It must sum to one.</p>
</td></tr>
<tr><td><code id="FD.density_+3A_t">t</code></td>
<td>
<p>non-negative scalar tau parameter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Vectors <code>x</code>, <code>a</code> and <code>p</code> must be of the same length.
</p>


<h3>References</h3>


<p>Ongaro, A. and Migliorati, S. (2013) A generalization of the Dirichlet distribution. Journal of Multivariate Analysis, <b>114</b>, 412&ndash;426.<br />
<br />
Migliorati, S., Ongaro, A. and Monti, G. S. (2016) A structured Dirichlet mixture model for compositional data: inferential and applicative issues. Statistics and Computing, doi:10.1007/s11222-016-9665-y.

</p>


<h3>See Also</h3>

<p><code><a href="#topic+FD.theorcontours">FD.theorcontours</a></code>, <code><a href="#topic+FD.generate">FD.generate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(0.1,0.25,0.65)
alpha &lt;- c(12,7,15)
prob &lt;- c(0.3,0.4,0.3)
tau &lt;- 8
FD.density(x,alpha,prob,tau)

</code></pre>

<hr>
<h2 id='FD.estimation'>Flexible Dirichlet Estimation</h2><span id='topic+FD.estimation'></span>

<h3>Description</h3>

<p>Estimates the vector of parameters of a Flexible Dirichlet distribution through an EM-based maximum likelihood approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FD.estimation(data, normalize = F, iter.initial.SEM = 50,
  iter.final.EM = 100, verbose = T)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FD.estimation_+3A_data">data</code></td>
<td>
<p>a matrix or a dataframe containing only the variables in the model. Rows must sum to one, or <code>normalize</code> must be set <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="FD.estimation_+3A_normalize">normalize</code></td>
<td>
<p>if <code>TRUE</code>, each row of <code>data</code> will be divided by its own total to become a point of the simplex. Values in <code>data</code> must be positive.</p>
</td></tr>
<tr><td><code id="FD.estimation_+3A_iter.initial.sem">iter.initial.SEM</code></td>
<td>
<p>number of iterations for the initial SEM step. Default to 50.</p>
</td></tr>
<tr><td><code id="FD.estimation_+3A_iter.final.em">iter.final.EM</code></td>
<td>
<p>number of iterations for the final EM step. Default to 100.</p>
</td></tr>
<tr><td><code id="FD.estimation_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code>, the progression of the elaboration and the results will be printed on screen.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The procedure is made up of four stages:
</p>

<ol>
<li><p> Clustering: The algorithm applies many different clustering rules to the dataset, in order to exploit the specific cluster patterns that the parameter structure of the model involves.
</p>
</li>
<li><p> Labelling: Once the initial partitions are obtained, group labeling needs to be established because any clustering algorithm assigns the group labels randomly, but the FD cluster structure entails a precise labelling scheme.
</p>
</li>
<li><p> Initial SEM: A Stochastic E-M algorithm is applied at every initial partition and every possible label permutation identified.
</p>
</li>
<li><p> Final E-M: The previous step must be seen as a multiple initialization strategy. At this point only the best one is selected and a final E-M algorithm is used to find the point that maximizes the likelihood of the parameter vector.
</p>
</li></ol>



<h3>Value</h3>

<p>an object of class FDfitted. It's a list composed by:
</p>

<dl>
<dt><code>alpha</code></dt><dd><p>Estimated values of the parameter vector Alpha</p>
</dd>
<dt><code>p</code></dt><dd><p>Estimated values of the parameter vector P</p>
</dd>
<dt><code>tau</code></dt><dd><p>Estimated value of the parameter Tau</p>
</dd>
<dt><code>logL</code></dt><dd><p>LogLikelihood</p>
</dd>
<dt><code>data</code></dt><dd><p>Normalized dataset</p>
</dd>
</dl>



<h3>References</h3>


<p>Ongaro, A. and Migliorati, S. (2013) A generalization of the Dirichlet distribution. Journal of Multivariate Analysis, <b>114</b>, 412&ndash;426.<br />
<br />
Migliorati, S., Ongaro, A. and Monti, G. S. (2016) A structured Dirichlet mixture model for compositional data: inferential and applicative issues. Statistics and Computing, doi:10.1007/s11222-016-9665-y.

</p>


<h3>See Also</h3>

<p><code><a href="#topic+FD.generate">FD.generate</a></code>, <code><a href="#topic+FD.stddev">FD.stddev</a></code>, <code><a href="#topic+FD.aicbic">FD.aicbic</a></code>, <code><a href="#topic+FD.barycenters">FD.barycenters</a></code>, <code><a href="#topic+FD.ternaryplot">FD.ternaryplot</a></code>, <code><a href="#topic+FD.rightplot">FD.rightplot</a></code>, <code><a href="#topic+FD.marginalplot">FD.marginalplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- FD.generate(n=20,a=c(12,7,15),p=c(0.3,0.4,0.3),t=8)
data
results &lt;- FD.estimation(data, normalize=TRUE,iter.initial.SEM = 5,iter.final.EM = 10)
results
summary(results)

</code></pre>

<hr>
<h2 id='FD.generate'>The Flexible Dirichlet Random Generation</h2><span id='topic+FD.generate'></span>

<h3>Description</h3>

<p>Random generation from the Flexible Dirichlet distribution with parameters <code>a</code>, <code>p</code> and <code>t</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FD.generate(n, a, p, t)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FD.generate_+3A_n">n</code></td>
<td>
<p>number of points on the simplex to be generated.</p>
</td></tr>
<tr><td><code id="FD.generate_+3A_a">a</code></td>
<td>
<p>vector of the non-negative alpha parameters.</p>
</td></tr>
<tr><td><code id="FD.generate_+3A_p">p</code></td>
<td>
<p>vector of the clusters' probabilities. It must sum to one.</p>
</td></tr>
<tr><td><code id="FD.generate_+3A_t">t</code></td>
<td>
<p>non-negative scalar tau parameter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Vectors <code>a</code> and <code>p</code> must be of the same length.
The Flexible Dirichlet distribution derives from the normalization of a basis of positive dependent random variables obtained by starting from a basis of independent equally scaled gamma random variables, and randomly allocating to the <code>i</code>-th element a further independent gamma random variable.
</p>


<h3>References</h3>


<p>Ongaro, A. and Migliorati, S. (2013) A generalization of the Dirichlet distribution. Journal of Multivariate Analysis, <b>114</b>, 412&ndash;426.<br />
<br />
Migliorati, S., Ongaro, A. and Monti, G. S. (2016) A structured Dirichlet mixture model for compositional data: inferential and applicative issues. Statistics and Computing, 1&ndash;21.

</p>


<h3>See Also</h3>

<p><code><a href="#topic+FD.estimation">FD.estimation</a></code>, <code><a href="#topic+FD.density">FD.density</a></code>, <code><a href="#topic+FD.theorcontours">FD.theorcontours</a></code>, <code><a href="#topic+FD.subcomposition">FD.subcomposition</a></code>, <code><a href="#topic+FD.amalgamation">FD.amalgamation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 100
alpha &lt;- c(12,7,15)
prob &lt;- c(0.3,0.4,0.3)
tau &lt;- 8
data &lt;- FD.generate(n,alpha,prob,tau)
data

</code></pre>

<hr>
<h2 id='FD.marginalplot'>Marginal Plot of a Flexible Dirichlet</h2><span id='topic+FD.marginalplot'></span>

<h3>Description</h3>

<p>Histogram of the observed marginal variable and estimated density function of the marginal variable of a fitted Flexible Dirichlet distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FD.marginalplot(x, var, zoomed = T, showgrid = T, showdata = T)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FD.marginalplot_+3A_x">x</code></td>
<td>
<p>an object of class FDfitted, usually the result of <code><a href="#topic+FD.estimation">FD.estimation</a></code>.</p>
</td></tr>
<tr><td><code id="FD.marginalplot_+3A_var">var</code></td>
<td>
<p>position of the variable to be plotted.</p>
</td></tr>
<tr><td><code id="FD.marginalplot_+3A_zoomed">zoomed</code></td>
<td>
<p>if <code>TRUE</code>, shows only the area where most of the density is concentrated. If <code>FALSE</code>, shows the whole range <code>[0;1]</code>.</p>
</td></tr>
<tr><td><code id="FD.marginalplot_+3A_showgrid">showgrid</code></td>
<td>
<p>if <code>TRUE</code>, shows the axis and the labels. If <code>FALSE</code>, only the graph is printed.</p>
</td></tr>
<tr><td><code id="FD.marginalplot_+3A_showdata">showdata</code></td>
<td>
<p>if <code>TRUE</code>, prints the histogram of the data. If <code>FALSE</code>, shows only the density function.</p>
</td></tr>
</table>


<h3>References</h3>


<p>Ongaro, A. and Migliorati, S. (2013) A generalization of the Dirichlet distribution. Journal of Multivariate Analysis, <b>114</b>, 412&ndash;426.<br />
<br />
Migliorati, S., Ongaro, A. and Monti, G. S. (2016) A structured Dirichlet mixture model for compositional data: inferential and applicative issues. Statistics and Computing, doi:10.1007/s11222-016-9665-y.

</p>


<h3>See Also</h3>

<p><code><a href="#topic+FD.estimation">FD.estimation</a></code>, <code><a href="#topic+FD.ternaryplot">FD.ternaryplot</a></code>, <code><a href="#topic+FD.rightplot">FD.rightplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- FD.generate(n=20,a=c(12,7,15),p=c(0.3,0.4,0.3),t=8)
data
results &lt;- FD.estimation(data, normalize=TRUE,iter.initial.SEM = 5,iter.final.EM = 10)
results
FD.marginalplot(results, var=2)
FD.marginalplot(results, var=2, zoomed=FALSE, showgrid=TRUE, showdata=FALSE)


</code></pre>

<hr>
<h2 id='FD.moments'>Flexible Dirichlet Moments</h2><span id='topic+FD.moments'></span>

<h3>Description</h3>

<p>Moments of a fitted Flexible Dirichlet distribution. The function returns the mean and variance vectors and the covariance and correlation matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FD.moments(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FD.moments_+3A_x">x</code></td>
<td>
<p>an object of class FDfitted, usually the result of <code><a href="#topic+FD.estimation">FD.estimation</a></code>.</p>
</td></tr>
</table>


<h3>References</h3>


<p>Ongaro, A. and Migliorati, S. (2013) A generalization of the Dirichlet distribution. Journal of Multivariate Analysis, <b>114</b>, 412&ndash;426.<br />
<br />
Migliorati, S., Ongaro, A. and Monti, G. S. (2016) A structured Dirichlet mixture model for compositional data: inferential and applicative issues. Statistics and Computing, doi:10.1007/s11222-016-9665-y.

</p>


<h3>See Also</h3>

<p><code><a href="#topic+FD.estimation">FD.estimation</a></code>, <code><a href="#topic+FD.barycenters">FD.barycenters</a></code>, <code><a href="#topic+FD.clusterdistances">FD.clusterdistances</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- FD.generate(n=20,a=c(12,7,15),p=c(0.3,0.4,0.3),t=8)
data
results &lt;- FD.estimation(data, normalize=TRUE,iter.initial.SEM = 5,iter.final.EM = 10)
results
FD.moments(results)


</code></pre>

<hr>
<h2 id='FD.normalization'>Normalization</h2><span id='topic+FD.normalization'></span>

<h3>Description</h3>

<p>Given a matrix or a numeric dataframe, this function returns a composition (i.e. data summing up to 1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FD.normalization(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FD.normalization_+3A_data">data</code></td>
<td>
<p>a matrix or a dataframe containing only variables to be transformed into compositional variables.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Values must be positive. In case one row-entry (or more) is NA, the whole row will be returned as NA.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+FD.generate">FD.generate</a></code>, <code><a href="#topic+FD.subcomposition">FD.subcomposition</a></code>, <code><a href="#topic+FD.amalgamation">FD.amalgamation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oliveoil)
dataoil &lt;- oliveoil
head(dataoil)
data &lt;- FD.normalization(dataoil[,3:10])
head(data)
data.sub &lt;- FD.subcomposition(data,c(1,3,4,5))
head(data.sub)
data.amalg &lt;- FD.amalgamation(data,c(2,6,7,8),name='others')
head(data.amalg)

</code></pre>

<hr>
<h2 id='FD.rightplot'>Right Triangle Plot of a Flexible Dirichlet</h2><span id='topic+FD.rightplot'></span>

<h3>Description</h3>

<p>Right triangle plot and contour lines of the density function of a fitted Flexible Dirichlet distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FD.rightplot(x, var = c(1, 2), zoomed = T, showgrid = T, showdata = T,
  nlevels = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FD.rightplot_+3A_x">x</code></td>
<td>
<p>an object of class FDfitted, usually the result of <code><a href="#topic+FD.estimation">FD.estimation</a></code>.</p>
</td></tr>
<tr><td><code id="FD.rightplot_+3A_var">var</code></td>
<td>
<p>numeric vector containing the two variables to be plotted on the axis.</p>
</td></tr>
<tr><td><code id="FD.rightplot_+3A_zoomed">zoomed</code></td>
<td>
<p>if <code>TRUE</code>, shows only the area where most of the density is concentrated. If <code>FALSE</code>, shows the whole area of the right triangle.</p>
</td></tr>
<tr><td><code id="FD.rightplot_+3A_showgrid">showgrid</code></td>
<td>
<p>if <code>TRUE</code>, shows the axis and the labels. If <code>FALSE</code>, only the graph is printed.</p>
</td></tr>
<tr><td><code id="FD.rightplot_+3A_showdata">showdata</code></td>
<td>
<p>if <code>TRUE</code>, prints the data points. If <code>FALSE</code>, shows only the contour lines.</p>
</td></tr>
<tr><td><code id="FD.rightplot_+3A_nlevels">nlevels</code></td>
<td>
<p>approximate number of contour lines to be drawn.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The number of variables in the fitted model must be 3 to draw a plot on the right triangle.
</p>


<h3>References</h3>


<p>Ongaro, A. and Migliorati, S. (2013) A generalization of the Dirichlet distribution. Journal of Multivariate Analysis, <b>114</b>, 412&ndash;426.<br />
<br />
Migliorati, S., Ongaro, A. and Monti, G. S. (2016) A structured Dirichlet mixture model for compositional data: inferential and applicative issues. Statistics and Computing, doi:10.1007/s11222-016-9665-y.

</p>


<h3>See Also</h3>

<p><code><a href="#topic+FD.estimation">FD.estimation</a></code>, <code><a href="#topic+FD.ternaryplot">FD.ternaryplot</a></code>, <code><a href="#topic+FD.marginalplot">FD.marginalplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- FD.generate(n=20,a=c(12,7,15),p=c(0.3,0.4,0.3),t=8)
data
results &lt;- FD.estimation(data, normalize=TRUE,iter.initial.SEM = 5,iter.final.EM = 10)
results
FD.rightplot(results)
FD.rightplot(results, var=c(3,2), zoomed=FALSE, showgrid=TRUE, showdata=FALSE, nlevels=3)

</code></pre>

<hr>
<h2 id='FD.stddev'>Standard Deviation of the ML estimators of a Flexible Dirichlet</h2><span id='topic+FD.stddev'></span>

<h3>Description</h3>

<p>Conditional Bootstrap evaluation of the standard errors of the maximum likelihood parameter estimates of a Flexible Dirichlet distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FD.stddev(x, iter.bootstrap = 500)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FD.stddev_+3A_x">x</code></td>
<td>
<p>an object of class FDfitted, usually the result of <code><a href="#topic+FD.estimation">FD.estimation</a></code>.</p>
</td></tr>
<tr><td><code id="FD.stddev_+3A_iter.bootstrap">iter.bootstrap</code></td>
<td>
<p>number of iterations of the Bootstrap.</p>
</td></tr>
</table>


<h3>References</h3>


<p>Ongaro, A. and Migliorati, S. (2013) A generalization of the Dirichlet distribution. Journal of Multivariate Analysis, <b>114</b>, 412&ndash;426.<br />
<br />
Migliorati, S., Ongaro, A. and Monti, G. S. (2016) A structured Dirichlet mixture model for compositional data: inferential and applicative issues. Statistics and Computing, doi:10.1007/s11222-016-9665-y.

</p>


<h3>See Also</h3>

<p><code><a href="#topic+FD.estimation">FD.estimation</a></code>, <code><a href="#topic+FD.aicbic">FD.aicbic</a></code>, <code><a href="#topic+FD.barycenters">FD.barycenters</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- FD.generate(n=20,a=c(12,7,15),p=c(0.3,0.4,0.3),t=8)
data
results &lt;- FD.estimation(data, normalize=TRUE,iter.initial.SEM = 5,iter.final.EM = 10)
results
FD.stddev(results)

</code></pre>

<hr>
<h2 id='FD.subcomposition'>Subcomposition</h2><span id='topic+FD.subcomposition'></span>

<h3>Description</h3>

<p>Given a matrix or a numeric dataframe, this function returns a subcomposition made up of the specified columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FD.subcomposition(data, columns)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FD.subcomposition_+3A_data">data</code></td>
<td>
<p>a matrix or a dataframe containing only variables in the model.</p>
</td></tr>
<tr><td><code id="FD.subcomposition_+3A_columns">columns</code></td>
<td>
<p>numeric vector containing the position of the columns to keep in the new composition.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Values must be positive. In case one row-entry (or more) is NA, the whole row will be returned as NA.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+FD.generate">FD.generate</a></code>, <code><a href="#topic+FD.amalgamation">FD.amalgamation</a></code>, <code><a href="#topic+FD.normalization">FD.normalization</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oliveoil)
dataoil &lt;- oliveoil
head(dataoil)
data &lt;- FD.normalization(dataoil[,3:10])
head(data)
data.sub &lt;- FD.subcomposition(data,c(1,3,4,5))
head(data.sub)
data.amalg &lt;- FD.amalgamation(data,c(2,6,7,8),name='others')
head(data.amalg)

</code></pre>

<hr>
<h2 id='FD.ternaryplot'>Ternary Plot of a Flexible Dirichlet</h2><span id='topic+FD.ternaryplot'></span>

<h3>Description</h3>

<p>Ternary plot and contour lines of the density function of a fitted Flexible Dirichlet distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FD.ternaryplot(x, zoomed = T, showgrid = T, showdata = T, nlevels = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FD.ternaryplot_+3A_x">x</code></td>
<td>
<p>an object of class FDfitted, usually the result of <code><a href="#topic+FD.estimation">FD.estimation</a></code>.</p>
</td></tr>
<tr><td><code id="FD.ternaryplot_+3A_zoomed">zoomed</code></td>
<td>
<p>if <code>TRUE</code>, shows only the area where most of the density is concentrated. If <code>FALSE</code>, shows the whole area of the ternary diagram.</p>
</td></tr>
<tr><td><code id="FD.ternaryplot_+3A_showgrid">showgrid</code></td>
<td>
<p>if <code>TRUE</code>, shows the axis and the labels. If <code>FALSE</code>, only the graph is printed.</p>
</td></tr>
<tr><td><code id="FD.ternaryplot_+3A_showdata">showdata</code></td>
<td>
<p>if <code>TRUE</code>, prints the data points. If <code>FALSE</code>, shows only the contour lines.</p>
</td></tr>
<tr><td><code id="FD.ternaryplot_+3A_nlevels">nlevels</code></td>
<td>
<p>approximate number of contour lines to be drawn.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The number of variables in the fitted model must be 3 to draw a ternary plot.
</p>


<h3>References</h3>


<p>Ongaro, A. and Migliorati, S. (2013) A generalization of the Dirichlet distribution. Journal of Multivariate Analysis, <b>114</b>, 412&ndash;426.<br />
<br />
Migliorati, S., Ongaro, A. and Monti, G. S. (2016) A structured Dirichlet mixture model for compositional data: inferential and applicative issues. Statistics and Computing, doi:10.1007/s11222-016-9665-y.

</p>


<h3>See Also</h3>

<p><code><a href="#topic+FD.estimation">FD.estimation</a></code>, <code><a href="#topic+FD.rightplot">FD.rightplot</a></code>, <code><a href="#topic+FD.marginalplot">FD.marginalplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- FD.generate(n=20,a=c(12,7,15),p=c(0.3,0.4,0.3),t=8)
data
results &lt;- FD.estimation(data, normalize=TRUE,iter.initial.SEM = 5,iter.final.EM = 10)
results
FD.ternaryplot(results)
FD.ternaryplot(results, zoomed=FALSE, showgrid=TRUE, showdata=FALSE, nlevels=3)

</code></pre>

<hr>
<h2 id='FD.theorcontours'>Contour Lines of a Flexible Dirichlet</h2><span id='topic+FD.theorcontours'></span>

<h3>Description</h3>

<p>Contour lines of a Flexible Dirichlet with given parameters on the ternary diagram or on the right triangle.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FD.theorcontours(a, p, t, type = "ternary", var = c(1, 2), zoomed = T,
  showgrid = T, nlevels = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FD.theorcontours_+3A_a">a</code></td>
<td>
<p>vector of the non-negative alpha parameters.</p>
</td></tr>
<tr><td><code id="FD.theorcontours_+3A_p">p</code></td>
<td>
<p>vector of the clusters' probabilities. It must sum to one.</p>
</td></tr>
<tr><td><code id="FD.theorcontours_+3A_t">t</code></td>
<td>
<p>non-negative scalar tau parameter.</p>
</td></tr>
<tr><td><code id="FD.theorcontours_+3A_type">type</code></td>
<td>
<p>string indicating whether to plot the contour lines on a ternary diagram <code>'ternary'</code>, or on a right triangle plot <code>'right'</code>.</p>
</td></tr>
<tr><td><code id="FD.theorcontours_+3A_var">var</code></td>
<td>
<p>numeric vector containing the two variables to be plotted on the axis. Used only if <code>type='right'</code>.</p>
</td></tr>
<tr><td><code id="FD.theorcontours_+3A_zoomed">zoomed</code></td>
<td>
<p>if <code>TRUE</code>, shows only the area where most of the density is concentrated. If <code>FALSE</code>, shows the whole area.</p>
</td></tr>
<tr><td><code id="FD.theorcontours_+3A_showgrid">showgrid</code></td>
<td>
<p>if <code>TRUE</code>, shows the axis and the labels. If <code>FALSE</code>, only the graph is printed.</p>
</td></tr>
<tr><td><code id="FD.theorcontours_+3A_nlevels">nlevels</code></td>
<td>
<p>approximate number of contour lines to be drawn.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The number of variables in the Flexible Dirichlet must be 3 to draw a plot. Vectors <code>a</code> and <code>p</code> must be of the same length.
</p>


<h3>References</h3>


<p>Ongaro, A. and Migliorati, S. (2013) A generalization of the Dirichlet distribution. Journal of Multivariate Analysis, <b>114</b>, 412&ndash;426.<br />
<br />
Migliorati, S., Ongaro, A. and Monti, G. S. (2016) A structured Dirichlet mixture model for compositional data: inferential and applicative issues. Statistics and Computing, doi:10.1007/s11222-016-9665-y.

</p>


<h3>See Also</h3>

<p><code><a href="#topic+FD.generate">FD.generate</a></code>, <code><a href="#topic+FD.density">FD.density</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>alpha &lt;- c(12,7,15)
prob &lt;- c(0.3,0.4,0.3)
tau &lt;- 8
FD.theorcontours(alpha,prob,tau)
FD.theorcontours(alpha,prob,tau, type='right', var=c(3,2), zoomed=FALSE, showgrid=TRUE, nlevels=3)

</code></pre>

<hr>
<h2 id='oliveoil'>Olive oil data</h2><span id='topic+oliveoil'></span>

<h3>Description</h3>

<p>This data set represents eight chemical measurements on different specimen of olive oil produced in various regions in Italy (northern Apulia, southern Apulia, Calabria, Sicily, inland Sardinia and coast Sardinia, eastern and western Liguria, Umbria) and further classifiable into three macro-areas: Centre-North, South, Sardinia.
</p>


<h3>Format</h3>

<p>This data frame contains 572 rows, each corresponding to a different specimen of olive oil, and 10 columns. The first and the second column correspond to the macro-area and the region of origin of the olive oils respectively; here, the term 'region' refers to a geographical area and only partially to administrative borders. Columns 3-10 represent the following eight chemical measurements on the acid components for the oil specimens: palmitic, palmitoleic, stearic, oleic, linoleic, linolenic, arachidic, eicosenoic.</p>


<h3>Source</h3>

<p>Originally included in the package <a href="https://cran.r-project.org/package=pdfCluster/">pdfCluster</a>.
</p>

<hr>
<h2 id='plot.FDfitted'>Plot Method for FDfitted Objects</h2><span id='topic+plot.FDfitted'></span>

<h3>Description</h3>

<p>This method plots the results of <code><a href="#topic+FD.estimation">FD.estimation</a></code>, using the functions <code><a href="#topic+FD.ternaryplot">FD.ternaryplot</a></code> or <code><a href="#topic+FD.rightplot">FD.rightplot</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FDfitted'
plot(x, type = "ternary", var = c(1, 2), zoomed = T,
  showgrid = T, showdata = T, nlevels = 10, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.FDfitted_+3A_x">x</code></td>
<td>
<p>an object of class FDfitted, usually the result of <code><a href="#topic+FD.estimation">FD.estimation</a></code>.</p>
</td></tr>
<tr><td><code id="plot.FDfitted_+3A_type">type</code></td>
<td>
<p>string containing <code>'ternary'</code> or <code>'right'</code>.</p>
</td></tr>
<tr><td><code id="plot.FDfitted_+3A_var">var</code></td>
<td>
<p>numeric vector containing the two variables to be plotted on the axis. Used only if <code>type='right'</code>.</p>
</td></tr>
<tr><td><code id="plot.FDfitted_+3A_zoomed">zoomed</code></td>
<td>
<p>if <code>TRUE</code>, shows only the area where most of the density is concentrated. If <code>FALSE</code>, shows the whole area.</p>
</td></tr>
<tr><td><code id="plot.FDfitted_+3A_showgrid">showgrid</code></td>
<td>
<p>if <code>TRUE</code>, shows the axis and the labels. If <code>FALSE</code>, only the graph is printed.</p>
</td></tr>
<tr><td><code id="plot.FDfitted_+3A_showdata">showdata</code></td>
<td>
<p>if <code>TRUE</code>, prints the data points. If <code>FALSE</code>, shows only the contour lines.</p>
</td></tr>
<tr><td><code id="plot.FDfitted_+3A_nlevels">nlevels</code></td>
<td>
<p>approximate number of contour lines to be drawn.</p>
</td></tr>
<tr><td><code id="plot.FDfitted_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The number of variables in the fitted model must be 3 to draw a plot.
</p>


<h3>References</h3>


<p>Ongaro, A. and Migliorati, S. (2013) A generalization of the Dirichlet distribution. Journal of Multivariate Analysis, <b>114</b>, 412&ndash;426.<br />
<br />
Migliorati, S., Ongaro, A. and Monti, G. S. (2016) A structured Dirichlet mixture model for compositional data: inferential and applicative issues. Statistics and Computing, doi:10.1007/s11222-016-9665-y.

</p>


<h3>See Also</h3>

<p><code><a href="#topic+FD.estimation">FD.estimation</a></code>, <code><a href="#topic+FD.ternaryplot">FD.ternaryplot</a></code>, <code><a href="#topic+FD.rightplot">FD.rightplot</a></code>, <code><a href="#topic+FD.marginalplot">FD.marginalplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- FD.generate(n=20,a=c(12,7,15),p=c(0.3,0.4,0.3),t=8)
data
results &lt;- FD.estimation(data, normalize=TRUE,iter.initial.SEM = 5,iter.final.EM = 10)
results
plot(results)
plot(results, type='right', var=c(3,2), zoomed=FALSE, showgrid=TRUE, showdata=FALSE, nlevels=3)


</code></pre>

<hr>
<h2 id='print.FDfitted'>Print Method for FDfitted Objects</h2><span id='topic+print.FDfitted'></span>

<h3>Description</h3>

<p>This method shows the results of <code><a href="#topic+FD.estimation">FD.estimation</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FDfitted'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.FDfitted_+3A_x">x</code></td>
<td>
<p>an object of class FDfitted, usually the result of <code><a href="#topic+FD.estimation">FD.estimation</a></code>.</p>
</td></tr>
<tr><td><code id="print.FDfitted_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>

<hr>
<h2 id='summary.FDfitted'>Summary Method for FDfitted Objects</h2><span id='topic+summary.FDfitted'></span>

<h3>Description</h3>

<p>This method summarizes the results of <code><a href="#topic+FD.estimation">FD.estimation</a></code>, adding also information from the functions <code><a href="#topic+FD.stddev">FD.stddev</a></code> and <code><a href="#topic+FD.aicbic">FD.aicbic</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FDfitted'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.FDfitted_+3A_object">object</code></td>
<td>
<p>an object of class FDfitted, usually the result of <code><a href="#topic+FD.estimation">FD.estimation</a></code>.</p>
</td></tr>
<tr><td><code id="summary.FDfitted_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list composed by:
</p>

<dl>
<dt><code>par</code></dt><dd><p>Estimated parameter vector</p>
</dd>
<dt><code>sd</code></dt><dd><p>Vector of the estimated standard deviations</p>
</dd>
<dt><code>goodness</code></dt><dd><p>Vector containing LogLikelihood, AIC and BIC</p>
</dd>
</dl>



<h3>References</h3>


<p>Ongaro, A. and Migliorati, S. (2013) A generalization of the Dirichlet distribution. Journal of Multivariate Analysis, <b>114</b>, 412&ndash;426.<br />
<br />
Migliorati, S., Ongaro, A. and Monti, G. S. (2016) A structured Dirichlet mixture model for compositional data: inferential and applicative issues. Statistics and Computing, doi:10.1007/s11222-016-9665-y.

</p>


<h3>See Also</h3>

<p><code><a href="#topic+FD.estimation">FD.estimation</a></code>, <code><a href="#topic+FD.stddev">FD.stddev</a></code>, <code><a href="#topic+FD.aicbic">FD.aicbic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- FD.generate(n=20,a=c(12,7,15),p=c(0.3,0.4,0.3),t=8)
data
results &lt;- FD.estimation(data, normalize=TRUE,iter.initial.SEM = 5,iter.final.EM = 10)
results
summary(results)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
