<!DOCTYPE html><html><head><title>Help for package arima2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {arima2}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aicTable'><p>ARIMA AIC table</p></a></li>
<li><a href='#arima'><p>ARIMA Modeling of Time Series</p></a></li>
<li><a href='#ARMApolyroots'><p>ARMA polyroots</p></a></li>
<li><a href='#miHuron_level'><p>Annual January levels of lake Michigan-Huron</p></a></li>
<li><a href='#plot.Arima2'><p>Plot <code>Arima2</code> object</p></a></li>
<li><a href='#profile.Arima2'><p>Profile for <code>Arima2</code> object</p></a></li>
<li><a href='#sample_ARMA_coef'><p>Sample ARMA coef</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Likelihood Based Inference for ARIMA Modeling</td>
</tr>
<tr>
<td>Version:</td>
<td>3.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimating and analyzing auto regressive integrated moving average
    (ARIMA) models. The primary function in this package is arima(), which fits 
    an ARIMA model to univariate time series data using a random restart
    algorithm. This approach frequently leads to models that have model 
    likelihood greater than or equal to that of the likelihood obtained by 
    fitting the same model using the arima() function from the 'stats' package. 
    This package enables proper optimization of model likelihoods, which is a 
    necessary condition for performing likelihood ratio tests. This package 
    relies heavily on the source code of the arima() function of the 'stats' 
    package. For more information, please see Jesse Wheeler and Edward L. 
    Ionides (2023) &lt;<a href="https://arxiv.org/abs/2310.01198">arXiv:2310.01198</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, methods</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jeswheel/arima2/issues/">https://github.com/jeswheel/arima2/issues/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-16 14:53:21 UTC; jeswheel</td>
</tr>
<tr>
<td>Author:</td>
<td>Jesse Wheeler [aut, cre, cph],
  Noel McAllister [aut],
  Dhajanae Sylvertooth [aut],
  Edward Ionides [ctb],
  Brian Ripley [ctb] (Author of arima source code in stats package.),
  R Core Team [cph] (Author of arima source code in stats package.)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jesse Wheeler &lt;jeswheel@umich.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-16 16:03:54 UTC</td>
</tr>
</table>
<hr>
<h2 id='aicTable'>ARIMA AIC table</h2><span id='topic+aicTable'></span>

<h3>Description</h3>

<p>Construct table of AIC for all combinations 0&lt;=p&lt;=P and 0&lt;=q&lt;=Q
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aicTable(data, P, Q, D = 0, ic = c("aic", "aicc"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aicTable_+3A_data">data</code></td>
<td>
<p>a time series object, or a dataset that can be used as input into
the <a href="#topic+arima">arima</a> function.</p>
</td></tr>
<tr><td><code id="aicTable_+3A_p">P</code></td>
<td>
<p>a positive integer value representing the maximum number of AR
coefficients that should be included in the table.</p>
</td></tr>
<tr><td><code id="aicTable_+3A_q">Q</code></td>
<td>
<p>a positive integer value representing the maximum number of MA
coefficients that should be included in the table.</p>
</td></tr>
<tr><td><code id="aicTable_+3A_d">D</code></td>
<td>
<p>a positive integer value representing the degree of differencing</p>
</td></tr>
<tr><td><code id="aicTable_+3A_ic">ic</code></td>
<td>
<p>Information criterion to be used in the table.</p>
</td></tr>
<tr><td><code id="aicTable_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="#topic+arima">arima()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates an AIC table for ARMA models of varying sizes.
Each row for the table corresponds to a different AR value, and each column
of the table corresponds to a different MA value.
</p>


<h3>Value</h3>

<p>A matrix containing the model AIC values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(654321)
aicTable(presidents, 3, 2)
</code></pre>

<hr>
<h2 id='arima'>ARIMA Modeling of Time Series</h2><span id='topic+arima'></span>

<h3>Description</h3>

<p>Fit an ARIMA model to a univariate time series. This function builds on
the ARIMA model fitting approach used in <code><a href="stats.html#topic+arima">stats::arima()</a></code> by fitting
model parameters via a random restart algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arima(
  x,
  order = c(0L, 0L, 0L),
  seasonal = list(order = c(0L, 0L, 0L), period = NA),
  xreg = NULL,
  include.mean = TRUE,
  transform.pars = TRUE,
  fixed = NULL,
  init = NULL,
  method = c("CSS-ML", "ML", "CSS"),
  n.cond,
  SSinit = c("Rossignol2011", "Gardner1980"),
  optim.method = "BFGS",
  optim.control = list(),
  kappa = 1e+06,
  diffuseControl = TRUE,
  max_iters = 100,
  max_repeats = 10,
  max_inv_root = 1,
  min_inv_root_dist = 0,
  eps_tol = 1e-04
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="arima_+3A_x">x</code></td>
<td>
<p>a univariate time series</p>
</td></tr>
<tr><td><code id="arima_+3A_order">order</code></td>
<td>
<p>A specification of the non-seasonal part of the ARIMA
model: the three integer components <code class="reqn">(p, d, q)</code> are the AR order, the
degree of differencing, and the MA order.</p>
</td></tr>
<tr><td><code id="arima_+3A_seasonal">seasonal</code></td>
<td>
<p>A specification of the seasonal part of the ARIMA
model, plus the period (which defaults to <code>frequency(x)</code>).
This may be a list with components <code>order</code> and
<code>period</code>, or just a numeric vector of length 3 which
specifies the seasonal <code>order</code>.  In the latter case the
default period is used.</p>
</td></tr>
<tr><td><code id="arima_+3A_xreg">xreg</code></td>
<td>
<p>Optionally, a vector or matrix of external regressors,
which must have the same number of rows as <code>x</code>.</p>
</td></tr>
<tr><td><code id="arima_+3A_include.mean">include.mean</code></td>
<td>
<p>Should the ARMA model include a mean/intercept term?  The
default is <code>TRUE</code> for undifferenced series, and it is ignored
for ARIMA models with differencing.</p>
</td></tr>
<tr><td><code id="arima_+3A_transform.pars">transform.pars</code></td>
<td>
<p>logical; if true, the AR parameters are
transformed to ensure that they remain in the region of
stationarity.  Not used for <code>method = "CSS"</code>.  For
<code>method = "ML"</code>, it has been advantageous to set
<code>transform.pars = FALSE</code> in some cases, see also <code>fixed</code>.</p>
</td></tr>
<tr><td><code id="arima_+3A_fixed">fixed</code></td>
<td>
<p>optional numeric vector of the same length as the total
number of coefficients to be estimated.  It should be of the form
</p>
<p style="text-align: center;"><code class="reqn">(\phi_1, \ldots, \phi_p, \theta_1, \ldots, \theta_q,
      \Phi_1, \ldots, \Phi_P, \Theta_1, \ldots, \Theta_Q, \mu),
    </code>
</p>

<p>where <code class="reqn">\phi_i</code> are the AR coefficients,
<code class="reqn">\theta_i</code> are the MA coefficients,
<code class="reqn">\Phi_i</code> are the seasonal AR coefficients,
<code class="reqn">\Theta_i</code> are the seasonal MA coefficients and
<code class="reqn">\mu</code> is the intercept term.  Note that the <code class="reqn">\mu</code>
entry is required if and only if <code>include.mean</code> is <code>TRUE</code>.
In particular it should not be present if the model is an ARIMA
model with differencing.
</p>
<p>The entries of the <code>fixed</code> vector should consist of the
values at which the user wishes to &ldquo;fix&rdquo; the corresponding
coefficient, or <code>NA</code> if that coefficient should <em>not</em> be
fixed, but estimated.
</p>
<p>The argument <code>transform.pars</code> will be set to <code>FALSE</code> if any
AR parameters are fixed.  A warning will be given if <code>transform.pars</code>
is set to (or left at its default) <code>TRUE</code>.  It may be wise to set
<code>transform.pars = FALSE</code> even when fixing MA parameters,
especially at values that cause the model to be nearly non-invertible.
</p>
</td></tr>
<tr><td><code id="arima_+3A_init">init</code></td>
<td>
<p>optional numeric vector of initial parameter
values.  Missing values will be filled in, by zeroes except for
regression coefficients.  Values already specified in <code>fixed</code>
will be ignored.</p>
</td></tr>
<tr><td><code id="arima_+3A_method">method</code></td>
<td>
<p>fitting method: maximum likelihood or minimize
conditional sum-of-squares.  The default (unless there are missing
values) is to use conditional-sum-of-squares to find starting
values, then maximum likelihood.  Can be abbreviated.</p>
</td></tr>
<tr><td><code id="arima_+3A_n.cond">n.cond</code></td>
<td>
<p>only used if fitting by conditional-sum-of-squares: the
number of initial observations to ignore.  It will be ignored if
less than the maximum lag of an AR term.</p>
</td></tr>
<tr><td><code id="arima_+3A_ssinit">SSinit</code></td>
<td>
<p>a string specifying the algorithm to compute the
state-space initialization of the likelihood; see
<code><a href="stats.html#topic+KalmanLike">KalmanLike</a></code> for details.   Can be abbreviated.</p>
</td></tr>
<tr><td><code id="arima_+3A_optim.method">optim.method</code></td>
<td>
<p>The value passed as the <code>method</code> argument to
<code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code id="arima_+3A_optim.control">optim.control</code></td>
<td>
<p>List of control parameters for <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code id="arima_+3A_kappa">kappa</code></td>
<td>
<p>the prior variance (as a multiple of the innovations
variance) for the past observations in a differenced model.  Do not
reduce this.</p>
</td></tr>
<tr><td><code id="arima_+3A_diffusecontrol">diffuseControl</code></td>
<td>
<p>Boolean indicator of whether or initial observations
will have likelihood values ignored if controlled by the diffuse prior,
i.e., have a Kalman gain of at least 1e4.</p>
</td></tr>
<tr><td><code id="arima_+3A_max_iters">max_iters</code></td>
<td>
<p>Maximum number of random restarts for methods &quot;CSS-ML&quot; and
&quot;ML&quot;. If set to 1, the results of this algorithm is the same as
<code><a href="stats.html#topic+arima">stats::arima()</a></code> if argument <code>diffuseControl</code> is also set as TRUE.
<code>max_iters</code> is often not reached because the condition
<code>max_repeats</code> is typically achieved first.</p>
</td></tr>
<tr><td><code id="arima_+3A_max_repeats">max_repeats</code></td>
<td>
<p>Integer. If the last <code>max_repeats</code> random starts did
not result in improved likelihoods, then stop the search. Each result of
the optim function is only considered to improve the likelihood if it does
so by more than <code>eps_tol</code>.</p>
</td></tr>
<tr><td><code id="arima_+3A_max_inv_root">max_inv_root</code></td>
<td>
<p>positive numeric value less than or equal to 1. This
number represents the maximum size of the inverted
MA or AR polynomial roots for a new parameter estimate to be considered an
improvement to previous estimates. Concerns of numeric stability arise
when the size of polynomial roots are near unity circle. The default value
1 means that the the parameter values corresponding with the best
log-likelihood will be returned, even if they are near unity.
Suitable values of this parameter are near the value 1.</p>
</td></tr>
<tr><td><code id="arima_+3A_min_inv_root_dist">min_inv_root_dist</code></td>
<td>
<p>positive numeric value less than 1. This number
represents the minimum distance between AR and MA polynomial roots for a
new parameter estimate to be considered an improvement on previous
estimates. This is intended to avoid the possibility of returning
parameter estimates with nearly canceling roots. Appropriate choices are
values near 0.</p>
</td></tr>
<tr><td><code id="arima_+3A_eps_tol">eps_tol</code></td>
<td>
<p>Tolerance for accepting a new solution to be better than a
previous solution in terms of log-likelihood. The default corresponds to a
one ten-thousandth unit increase in log-likelihood.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>c("Arima2", "Arima")</code>. This list contains all of the
same elements as the output of <a href="stats.html#topic+arima">stats::arima</a>, along with some additional
elements.  All elements of the output list are:
</p>

<dl>
<dt><code>coef</code></dt><dd><p>A vector of AR, MA, and regression coefficients. These can
be extracted by the <a href="stats.html#topic+coef">stats::coef</a> method.</p>
</dd>
<dt><code>sigma2</code></dt><dd><p>The MLE of the variance of the innovations.</p>
</dd>
<dt><code>var.coef</code></dt><dd><p>The estimated variance matrix of the coefficients
<code>coef</code>, which can be extracted by the <a href="stats.html#topic+vcov">stats::vcov</a> method.</p>
</dd>
<dt><code>mask</code></dt><dd><p>A vector containing boolean values, indicating which
parameters of the model were estimated.</p>
</dd>
<dt><code>loglik</code></dt><dd><p>The maximized log-likelihood (of the differenced data).</p>
</dd>
<dt><code>aic</code></dt><dd><p>The AIC value corresponding to the log-likelihood.</p>
</dd>
<dt><code>arma</code></dt><dd><p>A compact form of the model specification, as a vector
giving the number of AR, MA, seasonal AR and seasonal MA coefficients,
plus the period and the number of non-seasonal and seasonal differences.</p>
</dd>
<dt><code>residuals</code></dt><dd><p>The fitted innovations.</p>
</dd>
<dt><code>call</code></dt><dd><p>The matched call.</p>
</dd>
<dt><code>series</code></dt><dd><p>The name of the series x.</p>
</dd>
<dt><code>code</code></dt><dd><p>The convergence value returned by <a href="stats.html#topic+optim">stats::optim</a>.</p>
</dd>
<dt><code>n.cond</code></dt><dd><p>The number of initial observations not used in the
fitting.</p>
</dd>
<dt><code>nobs</code></dt><dd><p>The number of observations used for the fitting.</p>
</dd>
<dt><code>model</code></dt><dd><p>A list representing the Kalman Filter used in the fitting.</p>
</dd>
<dt><code>x</code></dt><dd><p>The input time series.</p>
</dd>
<dt><code>num_starts</code></dt><dd><p>Number of restarts before convergence criteria was
satisfied.</p>
</dd>
<dt><code>all_values</code></dt><dd><p>Numeric vector of length <code>num_starts</code> containing the
loglikelihood of every parameter initialization.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'># example code
set.seed(12345)
arima(miHuron_level$Average, order = c(2, 0, 1), max_iters = 100)

</code></pre>

<hr>
<h2 id='ARMApolyroots'>ARMA polyroots</h2><span id='topic+ARMApolyroots'></span>

<h3>Description</h3>

<p>This function calculates the roots of the AR or MA polynomials that
correspond to an ARMA model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ARMApolyroots(model, type = c("AR", "MA"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ARMApolyroots_+3A_model">model</code></td>
<td>
<p>Either of fitted object of class <code>Arima</code> (i.e., the output of
either <code><a href="stats.html#topic+arima">stats::arima()</a></code> or <a href="#topic+arima">arima</a>), a list with named elements at
least one of the named elements <code>ar</code> or <code>ma</code>, or a vector with named
elements, such as <code>c("ar1" = 0.3, "ar2" = -0.2, "ma1" = 0.14)</code> Seasonal
coefficients are ignored.</p>
</td></tr>
<tr><td><code id="ARMApolyroots_+3A_type">type</code></td>
<td>
<p>character of value &quot;AR&quot; or &quot;MA&quot;, indicating whether or not the
AR or MA polynomial roots are desired.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector containing the roots of the MA or AR polynomials
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123456)
ARMApolyroots(sample_ARMA_coef((order = c(2, 1))), type = "AR")

mod &lt;- arima(lh, order = c(3,0,0))
ARMApolyroots(mod, type = "AR")
</code></pre>

<hr>
<h2 id='miHuron_level'>Annual January levels of lake Michigan-Huron</h2><span id='topic+miHuron_level'></span>

<h3>Description</h3>

<p>The dataset is a subset of the monthly average depth (ft) of lake
Michigan-Huron. The data were retrieved online from  the
Great Lakes Environmental Research Laboratory. Various measurement gauges
exist; this data was taken from the master gauge.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>miHuron_level
</code></pre>


<h3>Format</h3>



<h4><code>miHuron_level</code></h4>

<p>A data frame with 155 observations and two columns:
</p>

<dl>
<dt>Date</dt><dd><p><code>Date</code> column that records when the observation was made.</p>
</dd>
<dt>Average</dt><dd><p><code>numeric</code> column representing the average depth in feet.</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="https://www.glerl.noaa.gov/data/dashboard/data/levels/mGauge/miHuronMog.csv">https://www.glerl.noaa.gov/data/dashboard/data/levels/mGauge/miHuronMog.csv</a>
</p>

<hr>
<h2 id='plot.Arima2'>Plot <code>Arima2</code> object</h2><span id='topic+plot.Arima2'></span>

<h3>Description</h3>

<p>This function plots time series data loaded from an <code>Arima2</code> object or plots
inverse roots of the AR or MA polynomials in a fitted ARIMA model on the
complex unit circle.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Arima2'
plot(x, roots = TRUE, title = NULL, tick.lab = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.Arima2_+3A_x">x</code></td>
<td>
<p>An <code>Arima2</code> object. This parameter is an object created using the function <code>arima2()</code>.</p>
</td></tr>
<tr><td><code id="plot.Arima2_+3A_roots">roots</code></td>
<td>
<p>Would you instead prefer to plot the roots on a unit circle? Insert logical type here.</p>
</td></tr>
<tr><td><code id="plot.Arima2_+3A_title">title</code></td>
<td>
<p>Title of plot</p>
</td></tr>
<tr><td><code id="plot.Arima2_+3A_tick.lab">tick.lab</code></td>
<td>
<p>Time vector of numeric or character/string type.</p>
</td></tr>
<tr><td><code id="plot.Arima2_+3A_...">...</code></td>
<td>
<p>Other parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output of this function is a <code>ggplot</code> object, so layers may be added to
the output of this function using <code>ggplot2</code>'s plus operator.
</p>


<h3>Value</h3>

<p><code style="white-space: pre;">&#8288;Arima 2&#8288;</code> plot, which is a <code>ggplot2</code> object. Type of plot is
indicated through <code>roots</code> parameter.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(arima(lh, order = c(1,0,1)))
plot(x = arima(lh, order = c(3,0,1)), roots = FALSE)
</code></pre>

<hr>
<h2 id='profile.Arima2'>Profile for <code>Arima2</code> object</h2><span id='topic+profile.Arima2'></span>

<h3>Description</h3>

<p>This function performs profile log-likelihood of an <code>Arima2</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Arima2'
profile(
  fitted,
  d = 0,
  npts = 100L,
  lower = -1,
  upper = 1,
  which = 1L,
  max_iters = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="profile.Arima2_+3A_fitted">fitted</code></td>
<td>
<p>An <code>Arima2</code> object that has been fit to data.</p>
</td></tr>
<tr><td><code id="profile.Arima2_+3A_d">d</code></td>
<td>
<p>Integer number of differences. Should match the differences used to
obtain the <code>fitted</code> object.</p>
</td></tr>
<tr><td><code id="profile.Arima2_+3A_npts">npts</code></td>
<td>
<p>Integer number of points to evaluate the profile.</p>
</td></tr>
<tr><td><code id="profile.Arima2_+3A_lower">lower</code></td>
<td>
<p>Numeric lower bound for the profile search.</p>
</td></tr>
<tr><td><code id="profile.Arima2_+3A_upper">upper</code></td>
<td>
<p>Numeric upper bound for the profile search.</p>
</td></tr>
<tr><td><code id="profile.Arima2_+3A_which">which</code></td>
<td>
<p>Integer indicating which parameter to perform the profile over.
See Details section for more information.</p>
</td></tr>
<tr><td><code id="profile.Arima2_+3A_max_iters">max_iters</code></td>
<td>
<p>Maximum number of random restarts. See <a href="#topic+arima">arima</a> for more
details.</p>
</td></tr>
<tr><td><code id="profile.Arima2_+3A_...">...</code></td>
<td>
<p>additional arguments needed for the profile function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parameter <code>which</code> specifies parameter in the following vector will be
profiled over:
</p>
<p style="text-align: center;"><code class="reqn">\phi_1, \ldots, \phi_p, \theta_1, \ldots, \theta_q, \Phi_1, \ldots, \Phi_P, \Theta_1, \ldots, \Theta_Q, \mu</code>
</p>

<p>where <code class="reqn">p, q</code> are non-negative integers representing the number of AR and
MA coefficients of <code>fitted</code>, respectively, and <code class="reqn">\phi_i</code> are the AR
coefficients, <code class="reqn">\theta_i</code> are the MA coefficients, <code class="reqn">\Phi_i</code> are the
seasonal AR coefficients, <code class="reqn">\Theta_i</code> are the seasonal MA coefficients and
<code class="reqn">\mu</code> is the model intercept.
</p>


<h3>Value</h3>

<p>data.frame object containing the results of the profile likelihood.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example code
set.seed(123)
mod &lt;- arima(miHuron_level$Average, order = c(1, 0, 1), max_iters = 100)
prof &lt;- profile(mod, which = 2L, lower = -0.5, upper = 0.5)
plot(prof$ma1, prof$loglik)

</code></pre>

<hr>
<h2 id='sample_ARMA_coef'>Sample ARMA coef</h2><span id='topic+sample_ARMA_coef'></span>

<h3>Description</h3>

<p>This function randomly samples the ARMA coefficients of a specified
ARMA model. The coefficients are sampled so that the resulting ARMA model
is both causal and invertible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_ARMA_coef(
  order = c(0L, 0L),
  seasonal = list(order = c(0L, 0L), period = NA),
  n = 1,
  Mod_bounds = c(0.05, 0.95)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_ARMA_coef_+3A_order">order</code></td>
<td>
<p>A specification of the non-seasonal part of the ARIMA model:
this is different than the <code>order</code> input of <code><a href="stats.html#topic+arima">stats::arima()</a></code>, because
the degree of differencing is not included. Thus order is a vector of
length two of the form <code class="reqn">(p, q)</code>.</p>
</td></tr>
<tr><td><code id="sample_ARMA_coef_+3A_seasonal">seasonal</code></td>
<td>
<p>A specification of the seasonal part of the ARIMA model. Can
be either a vector of length 2, or a list with an <code>order</code> component; if
a list, a period can be included, but it does not affect the function
output.</p>
</td></tr>
<tr><td><code id="sample_ARMA_coef_+3A_n">n</code></td>
<td>
<p>An integer indicating how many sets of ARMA coefficients should be
sampled.</p>
</td></tr>
<tr><td><code id="sample_ARMA_coef_+3A_mod_bounds">Mod_bounds</code></td>
<td>
<p>Bounds on the magnitude of the roots.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For an ARMA model to be causal and invertible, the roots of the AR and MA
polynomials must lie outside the the complex unit circle. The AR and MA
polynomials are defined as:
</p>
<p style="text-align: center;"><code class="reqn">\phi(z) = 1 - \phi_1 z - \phi_2 z^2 - \ldots - \phi_p z^p</code>
</p>

<p style="text-align: center;"><code class="reqn">\theta(z) = 1 + \theta_1 z + \theta_2 z^2 + \ldots + \theta_q z^q</code>
</p>

<p>where <code class="reqn">z</code> is a complex number, <code class="reqn">\phi_1, \ldots, \phi_p</code> are the
<code class="reqn">p</code> AR coefficients of the ARMA model, and
<code class="reqn">\theta_1, \ldots, \theta_p</code> are the <code class="reqn">q</code> MA coefficients of the ARMA
model.
</p>
<p>ARMA coefficients are sampled by sampling inverse roots to be inside the
complex unit circle, and then calculating the resulting polynomial.
To ensure that the resulting polynomial coefficients are real, we only sample
half of the needed number of complex roots, and set the remaining half to be
the complex conjugate of the sampled points. In the case where the number of
coefficients is odd, the first coefficient is sampled as a real number
between 0-1, the remaining roots are sampled as described, and then the
resulting polynomial is checked to ensure all roots lie outside the unit
circle; if not, we resample the coefficients.
</p>


<h3>Value</h3>

<p>a vector of randomly sampled ARMA coefficients.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
sample_ARMA_coef(
   order = c(2, 1),
   seasonal = list(order = c(1, 0), period = 2),
   n = 100
)
}
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
