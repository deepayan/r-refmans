<!DOCTYPE html><html><head><title>Help for package nonmem2R</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nonmem2R}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add.caption'><p>Add caption to ggplot object</p></a></li>
<li><a href='#basic.eta.GOF'><p>Histogram and/or QQ-norm GOF for ETA's</p></a></li>
<li><a href='#basic.GOF4'><p>Basic 4- and 6-panel GOF</p></a></li>
<li><a href='#covload'><p>Load the covariance matrix from a nonmem .cov output file.</p></a></li>
<li><a href='#covload.sub.table'><p>Internal package function</p></a></li>
<li><a href='#do.cat.GOF'><p>Y vs categorical X GOF-plot</p></a></li>
<li><a href='#do.individual.GOF'><p>Individual GOF-plots</p></a></li>
<li><a href='#do.multi.GOF'><p>Multiple Y vs single X GOF-plot</p></a></li>
<li><a href='#do.one.GOF'><p>X-Y GOF-plot</p></a></li>
<li><a href='#eta.cov.GOF'><p>Covariate and pairs ETA GOFs</p></a></li>
<li><a href='#extFormat'><p>Internal package function</p></a></li>
<li><a href='#extload'><p>Load final parameter values from a nonmem .ext output file.</p></a></li>
<li><a href='#extload.sub.table'><p>Internal package function</p></a></li>
<li><a href='#extToTable'><p>Compile parameter table suitable for reports</p></a></li>
<li><a href='#extTransform'><p>Internal package function</p></a></li>
<li><a href='#get.GOF.dictionary'><p>Get, set, and modify the global (or local) GOF parameters and GOF dictionary for labels</p></a></li>
<li><a href='#get.label'><p>Labels for known NONMEM variables</p></a></li>
<li><a href='#get.model.path'><p>Get and set model.path</p></a></li>
<li><a href='#grid.sim'><p>Combine fix grid and simulated grid based on multivariate normal distribution</p></a></li>
<li><a href='#grid.sim.internal1'><p>Internal function</p></a></li>
<li><a href='#grid.sim.internal2'><p>Internal function</p></a></li>
<li><a href='#grid.sim.internal3'><p>Internal function</p></a></li>
<li><a href='#histGOF'><p>Histogram GOF</p></a></li>
<li><a href='#merge2GOF'><p>Merging 2, 4, or 6 GOF's into one graph</p></a></li>
<li><a href='#modload'><p>Show model file</p></a></li>
<li><a href='#position_scale'><p>Position for scaling y</p></a></li>
<li><a href='#PositionScale'><p>ggproto for position_scale</p></a></li>
<li><a href='#print.extToTable'><p>Print function for compiled summary information of class extToTable</p></a></li>
<li><a href='#print.modload'><p>Print function for loaded mod file</p></a></li>
<li><a href='#print.sumoR'><p>Print function for compiled summary information of class sumoR</p></a></li>
<li><a href='#qqnormGOF'><p>QQ-norm GOF</p></a></li>
<li><a href='#readVpc'><p>Internal package function</p></a></li>
<li><a href='#stat_corr'><p>Adding correlation to x-y plots</p></a></li>
<li><a href='#stat_denx'><p>Density for x in x-y plot</p></a></li>
<li><a href='#stat_dnorm'><p>Normal density</p></a></li>
<li><a href='#stat_hmean'><p>Horizontal reference at mean</p></a></li>
<li><a href='#stat_hmedian'><p>Horizontal reference at median</p></a></li>
<li><a href='#StatCorr'><p>ggproto for stat_corr</p></a></li>
<li><a href='#StatDenx'><p>ggproto for stat_denx</p></a></li>
<li><a href='#StatDnorm'><p>ggproto for stat_dnorm</p></a></li>
<li><a href='#StatHmean'><p>ggproto for stat_hmean</p></a></li>
<li><a href='#StatHmedian'><p>ggproto for stat_hmedian</p></a></li>
<li><a href='#sumoR'><p>Compile summary information for NONMEM model based on the lst file, ext file, and the cov file.</p></a></li>
<li><a href='#sumoRU'><p>Internal package function</p></a></li>
<li><a href='#test.grid.sim'><p>Function for testing grid.sim and compare with rmvnorm</p></a></li>
<li><a href='#vpcfig'><p>Visual Predictive Check (VPC) based on Perl-speaks-NONMEM (PsN) generated VPC files (lattice version).</p></a></li>
<li><a href='#vpcfig2'><p>Visual Predictive Check (VPC) based on Perl-speaks-NONMEM (PsN) generated VPC files (ggplot2-version).</p></a></li>
<li><a href='#vpcfig3'><p>Visual Predictive Check (VPC) based on raw Perl-speaks-NONMEM (PsN) generated VPC files.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Loading NONMEM Output Files with Functions for Visual Predictive
Checks (VPC) and Goodness of Fit (GOF) Plots</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.5</td>
</tr>
<tr>
<td>Author:</td>
<td>Magnus Astrand</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Magnus Astrand &lt;magnus.astrand@astrazeneca.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Loading NONMEM (NONlinear Mixed-Effect Modeling, <a href="https://www.iconplc.com/solutions/technologies/nonmem/">https://www.iconplc.com/solutions/technologies/nonmem/</a>) and PSN (Perl-speaks-NONMEM, <a href="https://uupharmacometrics.github.io/PsN/">https://uupharmacometrics.github.io/PsN/</a>) output files to extract parameter estimates, provide visual predictive check (VPC) and goodness of fit (GOF) plots, and simulate with parameter uncertainty.</td>
</tr>
<tr>
<td>License:</td>
<td>Unlimited</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), ggplot2, gridExtra (&ge; 2.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>mvtnorm, lattice, latticeExtra, MASS, splines2, reshape2</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-11 15:59:19 UTC; magnusas</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-11 17:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='add.caption'>Add caption to ggplot object</h2><span id='topic+add.caption'></span>

<h3>Description</h3>

<p>Adds caption text as returned by get.caption to a ggplot object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add.caption(p, control = GOF.control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add.caption_+3A_p">p</code></td>
<td>
<p>ggplot object</p>
</td></tr>
<tr><td><code id="add.caption_+3A_control">control</code></td>
<td>
<p>an optional list of control settings. See GOF.control for the names of the settable control values and their effect.</p>
</td></tr>
</table>

<hr>
<h2 id='basic.eta.GOF'>Histogram and/or QQ-norm GOF for ETA's</h2><span id='topic+basic.eta.GOF'></span><span id='topic+eta.hist.GOF'></span><span id='topic+eta.qqnorm.GOF'></span>

<h3>Description</h3>

<p>Provides histogram and/or QQ-norm GOF for all ETA's included in the input data.frame with
caption added as reurned by get.caption
</p>


<h3>Usage</h3>

<pre><code class='language-R'>basic.eta.GOF(
  data,
  title = "",
  global.ggplot.options = NULL,
  type = c("both", "qqnorm", "hist"),
  ETA.subset = NULL,
  refline = TRUE,
  drop.fixed = TRUE,
  id.column = "ID",
  standardize = TRUE,
  bins = NA,
  control = GOF.control()
)

eta.hist.GOF(
  data,
  title = "",
  drop.fixed = TRUE,
  refline = TRUE,
  id.column = "ID",
  standardize = TRUE,
  bins = NA,
  control = GOF.control()
)

eta.qqnorm.GOF(
  data,
  title = "",
  drop.fixed = TRUE,
  refline = TRUE,
  id.column = "ID",
  standardize = TRUE,
  control = GOF.control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="basic.eta.GOF_+3A_data">data</code></td>
<td>
<p>data.frame to plot</p>
</td></tr>
<tr><td><code id="basic.eta.GOF_+3A_title">title</code></td>
<td>
<p>title</p>
</td></tr>
<tr><td><code id="basic.eta.GOF_+3A_global.ggplot.options">global.ggplot.options</code></td>
<td>
<p>ggplot option added to  each ggplot before plotting/returning object</p>
</td></tr>
<tr><td><code id="basic.eta.GOF_+3A_type">type</code></td>
<td>
<p>do only qq-norm plots (qqnorm), only histograms (hist), or do both (both)</p>
</td></tr>
<tr><td><code id="basic.eta.GOF_+3A_eta.subset">ETA.subset</code></td>
<td>
<p>index for subset of ETA's to plot. If NULL (default) all ETA's are plotted.</p>
</td></tr>
<tr><td><code id="basic.eta.GOF_+3A_refline">refline</code></td>
<td>
<p>add reference line (default =TRUE) or not (FALSE)</p>
</td></tr>
<tr><td><code id="basic.eta.GOF_+3A_drop.fixed">drop.fixed</code></td>
<td>
<p>drop ETA's that are fixed, i.e. any ETA with the same value in all subjects</p>
</td></tr>
<tr><td><code id="basic.eta.GOF_+3A_id.column">id.column</code></td>
<td>
<p>column name that indicate subject identifier</p>
</td></tr>
<tr><td><code id="basic.eta.GOF_+3A_standardize">standardize</code></td>
<td>
<p>Standardize all ETA's  (e.g. scale to unit variance)</p>
</td></tr>
<tr><td><code id="basic.eta.GOF_+3A_bins">bins</code></td>
<td>
<p>number of histogram bins, if NA, bins are set using Sturges' formula</p>
</td></tr>
<tr><td><code id="basic.eta.GOF_+3A_control">control</code></td>
<td>
<p>an optional list of control settings. See GOF.control for the names of the settable control values and their effect.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Get path to the example files included in nonmem2R package
file1 &lt;- system.file("extdata", "sdtab999", package = "nonmem2R")
sdtab&lt;-read.table(file=file1,skip=1,header=TRUE)
set.script.name("MyScript.R")
basic.eta.GOF(sdtab)
</code></pre>

<hr>
<h2 id='basic.GOF4'>Basic 4- and 6-panel GOF</h2><span id='topic+basic.GOF4'></span><span id='topic+basic.GOF6'></span>

<h3>Description</h3>

<p>basic.GOF4 provides a 4-panel GOF plot showing <br />
i) Observations (DV) vs population predictions (PRED) <br />
ii) Observations (DV) vs individual predictions (IPRED) <br />
iii) sqrt(abs(CWRES)) vs individual predictions (IPRED), and <br />
iV) CWRES vs TIME or other columns as set by idv <br />
</p>
<p>basic.GOF6 provides 2 additional GOF's showing histogram and qqnorm GOF's for CWRES.
</p>
<p>Caption is added as reurned by get.caption
</p>


<h3>Usage</h3>

<pre><code class='language-R'>basic.GOF4(
  data,
  residual = "CWRES",
  idv1 = "IPRED",
  idv2 = "TIME",
  title = "",
  color = "",
  log.scale = FALSE,
  global.ggplot.options = NULL,
  refline = TRUE,
  add.loess = TRUE,
  control = GOF.control()
)

basic.GOF6(
  data,
  residual = "CWRES",
  idv1 = "IPRED",
  idv2 = "TIME",
  title = "",
  color = "",
  log.scale = FALSE,
  global.ggplot.options = NULL,
  refline = TRUE,
  add.loess = TRUE,
  bins = NA,
  control = GOF.control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="basic.GOF4_+3A_data">data</code></td>
<td>
<p>data.frame to plot</p>
</td></tr>
<tr><td><code id="basic.GOF4_+3A_residual">residual</code></td>
<td>
<p>column name for residuals, default=&quot;CWRES&quot;</p>
</td></tr>
<tr><td><code id="basic.GOF4_+3A_idv1">idv1</code></td>
<td>
<p>independent variable for plot of sqrt of absolute CWRES</p>
</td></tr>
<tr><td><code id="basic.GOF4_+3A_idv2">idv2</code></td>
<td>
<p>independent variable for plot of CWRES</p>
</td></tr>
<tr><td><code id="basic.GOF4_+3A_title">title</code></td>
<td>
<p>title</p>
</td></tr>
<tr><td><code id="basic.GOF4_+3A_color">color</code></td>
<td>
<p>data columns to set different colors in plot, interpreted as factor</p>
</td></tr>
<tr><td><code id="basic.GOF4_+3A_log.scale">log.scale</code></td>
<td>
<p>use log scale for DV, IPRED and PRED (TRUE) or normal scale (FALSE)</p>
</td></tr>
<tr><td><code id="basic.GOF4_+3A_global.ggplot.options">global.ggplot.options</code></td>
<td>
<p>ggplot option added to  each ggplot before plotting/returning object</p>
</td></tr>
<tr><td><code id="basic.GOF4_+3A_refline">refline</code></td>
<td>
<p>add reference line (default =TRUE) or not (FALSE)</p>
</td></tr>
<tr><td><code id="basic.GOF4_+3A_add.loess">add.loess</code></td>
<td>
<p>add loess smoother to plot (TRUE), or not (FALSE)</p>
</td></tr>
<tr><td><code id="basic.GOF4_+3A_control">control</code></td>
<td>
<p>an optional list of control settings. See GOF.control for the names of the settable control values and their effect.</p>
</td></tr>
<tr><td><code id="basic.GOF4_+3A_bins">bins</code></td>
<td>
<p>number of histogram bins, if NA, bins are set using Sturges' formula</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Get path to the example files included in nonmem2R package
file1 &lt;- system.file("extdata", "sdtab999", package = "nonmem2R")
sdtab&lt;-read.table(file=file1,skip=1,header=TRUE)
set.script.name("MyScript.R")
## Example 4 panel basic GOF
basic.GOF4(subset(sdtab,DV&gt;0),idv2="TAPD")
## Example 6 panel basic GOF
basic.GOF6(subset(sdtab,DV&gt;0),idv1="TAPD",idv2="PRED")
</code></pre>

<hr>
<h2 id='covload'>Load the covariance matrix from a nonmem .cov output file.</h2><span id='topic+covload'></span>

<h3>Description</h3>

<p>Load the covariance matrix from a nonmem .cov output file.
Either the covariance matrix of all THETA parameters (default) or the covariance matrix of all parameters, THETA, OMEGA and SIGMA.
</p>
<p>For cov-files with multiple table results either only the last table result is loaded
(last.table.only=TRUE, default) or all table results are loaded (last.table.only=FALSE).
The result is then a named list of covariance matrix's,
<code>LastTable</code> is the last table in the cov-files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covload(
  model,
  use.model.path = TRUE,
  last.table.only = TRUE,
  theta.only = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covload_+3A_model">model</code></td>
<td>
<p>name of the cov file with or without the .cov extension. model may include full or relative path to the cov file. See examples.</p>
</td></tr>
<tr><td><code id="covload_+3A_use.model.path">use.model.path</code></td>
<td>
<p>Load file from a global defined model library (TRUE=default).
If so will look for a global character vector named <code>model.path</code></p>
</td></tr>
<tr><td><code id="covload_+3A_last.table.only">last.table.only</code></td>
<td>
<p>Include only the last table result for cov files with multiple table results</p>
</td></tr>
<tr><td><code id="covload_+3A_theta.only">theta.only</code></td>
<td>
<p>return covariance matrix of theta's only (default)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The covariance matrix or a named list of covariance matrix's
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##### Load the .cov file "run001.cov"
# 1) Get path to the example file included in nonmem2R package
file1 &lt;- system.file("extdata", "run001.cov", package = "nonmem2R")
# 2) Load the file using the covload function
covload(file1)
</code></pre>

<hr>
<h2 id='covload.sub.table'>Internal package function</h2><span id='topic+covload.sub.table'></span>

<h3>Description</h3>

<p>Internal package function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covload.sub.table(model, skip, nrow, use.model.path = TRUE, theta.only = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covload.sub.table_+3A_model">model</code></td>
<td>
<p>model</p>
</td></tr>
<tr><td><code id="covload.sub.table_+3A_skip">skip</code></td>
<td>
<p>number of rows to skip</p>
</td></tr>
<tr><td><code id="covload.sub.table_+3A_nrow">nrow</code></td>
<td>
<p>number of rows to read</p>
</td></tr>
<tr><td><code id="covload.sub.table_+3A_use.model.path">use.model.path</code></td>
<td>
<p>Load file from a global defined model library (TRUE=default).
If so will look for a global character vector named <code>model.path</code></p>
</td></tr>
<tr><td><code id="covload.sub.table_+3A_theta.only">theta.only</code></td>
<td>
<p>return covariance matrix of theta's only (default)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named list including theta, omega, sigma, and ofv. For MCMC output file each object are matrixes.
</p>

<hr>
<h2 id='do.cat.GOF'>Y vs categorical X GOF-plot</h2><span id='topic+do.cat.GOF'></span>

<h3>Description</h3>

<p>GOF plot with boxplots of Y grouped by categorical data in X, with refline and with caption added as reurned by get.caption
</p>


<h3>Usage</h3>

<pre><code class='language-R'>do.cat.GOF(
  data,
  x,
  y,
  color = "",
  add.points = TRUE,
  refline = c("abline", "href0", "hrefmean", "hrefmedian", "none"),
  title = "",
  lines.by.id = FALSE,
  id.column = "ID",
  fx = NULL,
  fy = NULL,
  control = GOF.control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="do.cat.GOF_+3A_data">data</code></td>
<td>
<p>data.frame to plot</p>
</td></tr>
<tr><td><code id="do.cat.GOF_+3A_x">x</code></td>
<td>
<p>character string with name of column for x</p>
</td></tr>
<tr><td><code id="do.cat.GOF_+3A_y">y</code></td>
<td>
<p>character string with name of column for y</p>
</td></tr>
<tr><td><code id="do.cat.GOF_+3A_color">color</code></td>
<td>
<p>data columns to set different colors in plot, interpreted as factor</p>
</td></tr>
<tr><td><code id="do.cat.GOF_+3A_add.points">add.points</code></td>
<td>
<p>add jittered points of data (TRUE), or not (FALSE)</p>
</td></tr>
<tr><td><code id="do.cat.GOF_+3A_refline">refline</code></td>
<td>
<p>add reference line with intercept=0, slope=1 (abline), horizontal at y=0( href0), horizontal at y=mean of y( hrefmean), horizontal at y=median of y( hrefmedian), or don't add reference line (none)</p>
</td></tr>
<tr><td><code id="do.cat.GOF_+3A_title">title</code></td>
<td>
<p>title</p>
</td></tr>
<tr><td><code id="do.cat.GOF_+3A_lines.by.id">lines.by.id</code></td>
<td>
<p>connect subjects by lines (TRUE), or don't (FALSE)</p>
</td></tr>
<tr><td><code id="do.cat.GOF_+3A_id.column">id.column</code></td>
<td>
<p>column name that indicate subject identifier</p>
</td></tr>
<tr><td><code id="do.cat.GOF_+3A_fx">fx</code></td>
<td>
<p>function for transformation of x before plotting</p>
</td></tr>
<tr><td><code id="do.cat.GOF_+3A_fy">fy</code></td>
<td>
<p>function for transformation of y before plotting</p>
</td></tr>
<tr><td><code id="do.cat.GOF_+3A_control">control</code></td>
<td>
<p>an optional list of control settings. See GOF.control for the names of the settable control values and their effect.</p>
</td></tr>
</table>

<hr>
<h2 id='do.individual.GOF'>Individual GOF-plots</h2><span id='topic+do.individual.GOF'></span>

<h3>Description</h3>

<p>DV, IPRED and PRED (default) individual GOF plots with one panel per subject.
Caption added as reurned by get.caption
</p>


<h3>Usage</h3>

<pre><code class='language-R'>do.individual.GOF(
  data,
  x = "TIME",
  y = c("DV", "IPRED", "PRED"),
  type = c("point", "line", "line"),
  title = "",
  per.page = 20,
  fx = NULL,
  fy = NULL,
  ylab = "Observations/Predictions",
  equal.lims = TRUE,
  global.ggplot.options = NULL,
  control = GOF.control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="do.individual.GOF_+3A_data">data</code></td>
<td>
<p>data.frame to plot</p>
</td></tr>
<tr><td><code id="do.individual.GOF_+3A_x">x</code></td>
<td>
<p>character string with name of column for x</p>
</td></tr>
<tr><td><code id="do.individual.GOF_+3A_y">y</code></td>
<td>
<p>character string vector with names of columns for y, default = c(DV, IPRED , PRED)</p>
</td></tr>
<tr><td><code id="do.individual.GOF_+3A_type">type</code></td>
<td>
<p>plot symbol or line for each y variable, length of type must match length of y</p>
</td></tr>
<tr><td><code id="do.individual.GOF_+3A_title">title</code></td>
<td>
<p>title</p>
</td></tr>
<tr><td><code id="do.individual.GOF_+3A_per.page">per.page</code></td>
<td>
<p>number of subjects/panels on each page</p>
</td></tr>
<tr><td><code id="do.individual.GOF_+3A_fx">fx</code></td>
<td>
<p>function for transformation of x before plotting</p>
</td></tr>
<tr><td><code id="do.individual.GOF_+3A_fy">fy</code></td>
<td>
<p>function for transformation of y before plotting</p>
</td></tr>
<tr><td><code id="do.individual.GOF_+3A_ylab">ylab</code></td>
<td>
<p>y axis label</p>
</td></tr>
<tr><td><code id="do.individual.GOF_+3A_equal.lims">equal.lims</code></td>
<td>
<p>use same x- and y-limits on all pages and panels (TRUE), or use allow to vary across pages (FALSE)</p>
</td></tr>
<tr><td><code id="do.individual.GOF_+3A_global.ggplot.options">global.ggplot.options</code></td>
<td>
<p>ggplot option added to  each ggplot before plotting/returning object</p>
</td></tr>
<tr><td><code id="do.individual.GOF_+3A_control">control</code></td>
<td>
<p>an optional list of control settings. See GOF.control for the names of the settable control values and their effect.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Get path to the example files included in nonmem2R package
file1 &lt;- system.file("extdata", "sdtab999", package = "nonmem2R")
sdtab&lt;-read.table(file=file1,skip=1,header=TRUE)
set.script.name("MyScript.R")
do.individual.GOF(subset(sdtab,DV&gt;0 &amp; ID&lt;13))
</code></pre>

<hr>
<h2 id='do.multi.GOF'>Multiple Y vs single X GOF-plot</h2><span id='topic+do.multi.GOF'></span>

<h3>Description</h3>

<p>X-Y GOF plots for multiple Y's and shared X with reflines and data smoother and with caption
added as reurned by get.caption
</p>


<h3>Usage</h3>

<pre><code class='language-R'>do.multi.GOF(
  data,
  x,
  y,
  color = "",
  add.loess = TRUE,
  refline = c("none", "abline", "href0", "hrefmean", "hrefmedian"),
  title = "",
  lines.by.id = FALSE,
  id.column = "ID",
  fx = NULL,
  fy = NULL,
  ylab = "Observations/Predictions",
  control = GOF.control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="do.multi.GOF_+3A_data">data</code></td>
<td>
<p>data.frame to plot</p>
</td></tr>
<tr><td><code id="do.multi.GOF_+3A_x">x</code></td>
<td>
<p>character string with name of column for x</p>
</td></tr>
<tr><td><code id="do.multi.GOF_+3A_y">y</code></td>
<td>
<p>character string with name of column for y</p>
</td></tr>
<tr><td><code id="do.multi.GOF_+3A_color">color</code></td>
<td>
<p>data columns to set different colors in plot, interpreted as factor</p>
</td></tr>
<tr><td><code id="do.multi.GOF_+3A_add.loess">add.loess</code></td>
<td>
<p>add loess smoother to plot (TRUE), or not (FALSE)</p>
</td></tr>
<tr><td><code id="do.multi.GOF_+3A_refline">refline</code></td>
<td>
<p>add reference line with intercept=0, slope=1 (abline), horizontal at y=0( href0), horizontal at y=mean of y( hrefmean), horizontal at y=median of y( hrefmedian), or don't add reference line (none)</p>
</td></tr>
<tr><td><code id="do.multi.GOF_+3A_title">title</code></td>
<td>
<p>title</p>
</td></tr>
<tr><td><code id="do.multi.GOF_+3A_lines.by.id">lines.by.id</code></td>
<td>
<p>connect subjects by lines (TRUE), or don't (FALSE)</p>
</td></tr>
<tr><td><code id="do.multi.GOF_+3A_id.column">id.column</code></td>
<td>
<p>column name that indicate subject identifier</p>
</td></tr>
<tr><td><code id="do.multi.GOF_+3A_fx">fx</code></td>
<td>
<p>function for transformation of x before plotting</p>
</td></tr>
<tr><td><code id="do.multi.GOF_+3A_fy">fy</code></td>
<td>
<p>function for transformation of y before plotting</p>
</td></tr>
<tr><td><code id="do.multi.GOF_+3A_ylab">ylab</code></td>
<td>
<p>y axis label</p>
</td></tr>
<tr><td><code id="do.multi.GOF_+3A_control">control</code></td>
<td>
<p>an optional list of control settings. See GOF.control for the names of the settable control values and their effect.</p>
</td></tr>
</table>

<hr>
<h2 id='do.one.GOF'>X-Y GOF-plot</h2><span id='topic+do.one.GOF'></span>

<h3>Description</h3>

<p>X-Y GOF plot with reflines and data smoother and with caption added as reurned by get.caption
</p>


<h3>Usage</h3>

<pre><code class='language-R'>do.one.GOF(
  data,
  x,
  y,
  color = "",
  add.loess = TRUE,
  refline = c("abline", "href0", "hrefmean", "hrefmedian", "none"),
  title = "",
  lines.by.id = FALSE,
  id.column = "ID",
  fx = NULL,
  fy = NULL,
  control = GOF.control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="do.one.GOF_+3A_data">data</code></td>
<td>
<p>data.frame to plot</p>
</td></tr>
<tr><td><code id="do.one.GOF_+3A_x">x</code></td>
<td>
<p>character string with name of column for x</p>
</td></tr>
<tr><td><code id="do.one.GOF_+3A_y">y</code></td>
<td>
<p>character string with name of column for y</p>
</td></tr>
<tr><td><code id="do.one.GOF_+3A_color">color</code></td>
<td>
<p>data columns to set different colors in plot, interpreted as factor</p>
</td></tr>
<tr><td><code id="do.one.GOF_+3A_add.loess">add.loess</code></td>
<td>
<p>add loess smoother to plot (TRUE), or not (FALSE)</p>
</td></tr>
<tr><td><code id="do.one.GOF_+3A_refline">refline</code></td>
<td>
<p>add reference line with intercept=0, slope=1 (abline), horizontal at y=0( href0), horizontal at y=mean of y( hrefmean), horizontal at y=median of y( hrefmedian), or don't add reference line (none)</p>
</td></tr>
<tr><td><code id="do.one.GOF_+3A_title">title</code></td>
<td>
<p>title</p>
</td></tr>
<tr><td><code id="do.one.GOF_+3A_lines.by.id">lines.by.id</code></td>
<td>
<p>connect subjects by lines (TRUE), or don't (FALSE)</p>
</td></tr>
<tr><td><code id="do.one.GOF_+3A_id.column">id.column</code></td>
<td>
<p>column name that indicate subject identifier</p>
</td></tr>
<tr><td><code id="do.one.GOF_+3A_fx">fx</code></td>
<td>
<p>function for transformation of x before plotting</p>
</td></tr>
<tr><td><code id="do.one.GOF_+3A_fy">fy</code></td>
<td>
<p>function for transformation of y before plotting</p>
</td></tr>
<tr><td><code id="do.one.GOF_+3A_control">control</code></td>
<td>
<p>an optional list of control settings. See GOF.control for the names of the settable control values and their effect.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Get path to the example files included in nonmem2R package
file1 &lt;- system.file("extdata", "sdtab999", package = "nonmem2R")
sdtab&lt;-read.table(file=file1,skip=1,header=TRUE)
set.script.name("MyScript.R")
do.one.GOF(subset(sdtab,DV&gt;0),"IPRED","DV")
</code></pre>

<hr>
<h2 id='eta.cov.GOF'>Covariate and pairs ETA GOFs</h2><span id='topic+eta.cov.GOF'></span><span id='topic+eta.cat.GOF'></span><span id='topic+eta.pairs.GOF'></span>

<h3>Description</h3>

<p>ETA's vs numerical covariates (eta.cov.GOF) and ETA's vs categorical covariates GOF plots on multiple
or single pages with reflines, data smoother, and caption added as reurned by get.caption.
</p>
<p>eta.pairs.GOF provides a pairs plot of all ETA's.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eta.cov.GOF(
  data,
  covariates = c("AGE", "BWT"),
  ETA.subset = NULL,
  exclude.zero.ETA = FALSE,
  title = "",
  drop.fixed = TRUE,
  id.column = "ID",
  standardize = TRUE,
  refline = TRUE,
  type = c("all-in-one", "covariate-by-page", "eta-by-page"),
  layout = c("ETAbyROW", "ETAbyCOL"),
  add.loess = TRUE,
  control = GOF.control()
)

eta.cat.GOF(
  data,
  covariates = c("SEXM"),
  ETA.subset = NULL,
  exclude.zero.ETA = FALSE,
  title = "",
  drop.fixed = TRUE,
  id.column = "ID",
  standardize = TRUE,
  refline = TRUE,
  type = c("all-in-one", "covariate-by-page", "eta-by-page"),
  layout = c("ETAbyROW", "ETAbyCOL"),
  add.points = TRUE,
  control = GOF.control()
)

eta.pairs.GOF(
  data,
  ETA.subset = NULL,
  title = "",
  drop.fixed = TRUE,
  id.column = "ID",
  density2D = c("none", "upper", "lower"),
  standardize = TRUE,
  control = GOF.control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eta.cov.GOF_+3A_data">data</code></td>
<td>
<p>data.frame to plot</p>
</td></tr>
<tr><td><code id="eta.cov.GOF_+3A_covariates">covariates</code></td>
<td>
<p>covariates, list of character strings</p>
</td></tr>
<tr><td><code id="eta.cov.GOF_+3A_eta.subset">ETA.subset</code></td>
<td>
<p>index for subset of ETA's to plot. If NULL (default) all ETA's are plotted.</p>
</td></tr>
<tr><td><code id="eta.cov.GOF_+3A_exclude.zero.eta">exclude.zero.ETA</code></td>
<td>
<p>If set to TRUE any ETA==0 is excluded before plotting. This option is useful if the model have full shrinkage for subset of individuals e.g. for ETA on ED50 in patents on placebo or on dose==0.</p>
</td></tr>
<tr><td><code id="eta.cov.GOF_+3A_title">title</code></td>
<td>
<p>title</p>
</td></tr>
<tr><td><code id="eta.cov.GOF_+3A_drop.fixed">drop.fixed</code></td>
<td>
<p>drop ETA's that are fixed, i.e. any ETA with the same value in all subjects</p>
</td></tr>
<tr><td><code id="eta.cov.GOF_+3A_id.column">id.column</code></td>
<td>
<p>column name that indicate subject identifier</p>
</td></tr>
<tr><td><code id="eta.cov.GOF_+3A_standardize">standardize</code></td>
<td>
<p>Standardize all ETA's  (e.g. scale to unit variance)</p>
</td></tr>
<tr><td><code id="eta.cov.GOF_+3A_refline">refline</code></td>
<td>
<p>add reference line (default =TRUE) or not (FALSE)</p>
</td></tr>
<tr><td><code id="eta.cov.GOF_+3A_type">type</code></td>
<td>
<p>do all ETA's and covariates on one page (all-in-one), one page for each covariate (covariate-by-page), or one page for each ETA (eta-by-page)</p>
</td></tr>
<tr><td><code id="eta.cov.GOF_+3A_layout">layout</code></td>
<td>
<p>Layout for ETA's and covariates</p>
</td></tr>
<tr><td><code id="eta.cov.GOF_+3A_add.loess">add.loess</code></td>
<td>
<p>add loess smoother to plot (TRUE), or not (FALSE)</p>
</td></tr>
<tr><td><code id="eta.cov.GOF_+3A_control">control</code></td>
<td>
<p>an optional list of control settings. See GOF.control for the names of the settable control values and their effect.</p>
</td></tr>
<tr><td><code id="eta.cov.GOF_+3A_add.points">add.points</code></td>
<td>
<p>add jittered points of data (TRUE), or not (FALSE)</p>
</td></tr>
<tr><td><code id="eta.cov.GOF_+3A_density2d">density2D</code></td>
<td>
<p>add 2D-density above (upper) or below (lower), or don't add (none)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Get path to the example files included in nonmem2R package
file1 &lt;- system.file("extdata", "sdtab999", package = "nonmem2R")
sdtab&lt;-read.table(file=file1,skip=1,header=TRUE)
set.script.name("MyScript.R")
eta.cov.GOF(sdtab,covariates=c("AGE","BWT"))
# Get path to the example files included in nonmem2R package
file1 &lt;- system.file("extdata", "sdtab999", package = "nonmem2R")
sdtab&lt;-read.table(file=file1,skip=1,header=TRUE)
set.script.name("MyScript.R")
eta.cat.GOF(sdtab,covariates=c("SEXM"))
# Get path to the example files included in nonmem2R package
file1 &lt;- system.file("extdata", "sdtab999", package = "nonmem2R")
sdtab&lt;-read.table(file=file1,skip=1,header=TRUE)
set.script.name("MyScript.R")
eta.pairs.GOF(sdtab)
</code></pre>

<hr>
<h2 id='extFormat'>Internal package function</h2><span id='topic+extFormat'></span>

<h3>Description</h3>

<p>Formatting of the named list returned by extload
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extFormat(ext, format.estimate = "% -#6.4g", format.rse = "%#6.3g")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extFormat_+3A_ext">ext</code></td>
<td>
<p>the result ofname of the lst file without the .lst extension. model may include full or relative path to the lst file.</p>
</td></tr>
<tr><td><code id="extFormat_+3A_format.estimate">format.estimate</code></td>
<td>
<p>format for estimated value, passed to sprintf</p>
</td></tr>
<tr><td><code id="extFormat_+3A_format.rse">format.rse</code></td>
<td>
<p>format for rse, passed to sprintf</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character-matrix
</p>

<hr>
<h2 id='extload'>Load final parameter values from a nonmem .ext output file.</h2><span id='topic+extload'></span>

<h3>Description</h3>

<p>Load parameter values from a nonmem .ext output file.
For output files from FO, FOCE and IMP only the final parameter values are loaded.
For output tables of MCMC and SAEM all parameter values from ITERATIONS&gt;0 will be loaded
unless positive.iterations=FALSE in case all the output from all iterations are loaded.
</p>
<p>For ext-files with multiple table results either only the last table result is loaded (last.table.only=TRUE, default)
or all table result are loaded (last.table.only=FALSE).
All but the last table results are then returned as sub-lists to the last table result.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extload(
  model,
  use.model.path = TRUE,
  positive.iterations.only = TRUE,
  last.table.only = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extload_+3A_model">model</code></td>
<td>
<p>name of the ext file with or without the .ext extension.
model may include full or relative path to the ext file. See examples.</p>
</td></tr>
<tr><td><code id="extload_+3A_use.model.path">use.model.path</code></td>
<td>
<p>Load file from a global defined model library (TRUE=default).
If so will look for a global character vector named <code>model.path</code></p>
</td></tr>
<tr><td><code id="extload_+3A_positive.iterations.only">positive.iterations.only</code></td>
<td>
<p>Include only rows with ITERATIONS&gt;0 from MCMC and SEAM table results (default=TRUE)</p>
</td></tr>
<tr><td><code id="extload_+3A_last.table.only">last.table.only</code></td>
<td>
<p>Include only the last table result for ext files with multiple table results</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named list including theta, theta.sd, omega, omega.sd, sigma, sigma.sd, and ofv.
Here .sd is the vector(matrix) with standard errors estimated parameter values in theta(omega &amp; sigma).
</p>
<p>For MCMC output files each object are matrixes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##### Load the .ext file "run001.ext"
# 1) Get path to the example file included in nonmem2R package
file1 &lt;- system.file("extdata", "run001.ext", package = "nonmem2R")
# 2) Load the file using the extload function
extload(file1)
</code></pre>

<hr>
<h2 id='extload.sub.table'>Internal package function</h2><span id='topic+extload.sub.table'></span>

<h3>Description</h3>

<p>Internal package function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extload.sub.table(
  model,
  skip,
  nrows,
  positive.iterations.only,
  use.model.path = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extload.sub.table_+3A_model">model</code></td>
<td>
<p>model</p>
</td></tr>
<tr><td><code id="extload.sub.table_+3A_skip">skip</code></td>
<td>
<p>number of rows to skip</p>
</td></tr>
<tr><td><code id="extload.sub.table_+3A_nrows">nrows</code></td>
<td>
<p>number of rows to read</p>
</td></tr>
<tr><td><code id="extload.sub.table_+3A_positive.iterations.only">positive.iterations.only</code></td>
<td>
<p>positive iterations only</p>
</td></tr>
<tr><td><code id="extload.sub.table_+3A_use.model.path">use.model.path</code></td>
<td>
<p>Load file from a global defined model library (TRUE=default).
If so will look for a global character vector named <code>model.path</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named list including theta, omega, sigma, and ofv. For MCMC output file each object are matrixes.
</p>

<hr>
<h2 id='extToTable'>Compile parameter table suitable for reports</h2><span id='topic+extToTable'></span>

<h3>Description</h3>

<p>Load parameter values from a nonmem .ext output file and compile to table suitable for reports.
Format can be &quot;wide&quot; (wide=TRUE, default) with a similar look as from sumoR,
or similar a 3 column layout (wide=FALSE).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extToTable(
  model,
  use.model.path = TRUE,
  tableType = 2,
  wide = TRUE,
  format.estimate = "% -#6.4g",
  format.rse = "%#6.3g"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extToTable_+3A_model">model</code></td>
<td>
<p>name of the ext file with or without the .ext extension.
model may include full or relative path to the ext file. See examples.</p>
</td></tr>
<tr><td><code id="extToTable_+3A_use.model.path">use.model.path</code></td>
<td>
<p>Load file from a global defined model library (TRUE=default).
If so will look for a global character vector named <code>model.path</code></p>
</td></tr>
<tr><td><code id="extToTable_+3A_tabletype">tableType</code></td>
<td>
<p>Table type for THETA's, OMEGA's and SIGMA's
</p>
<p>tableType=0: Present OMEGA and SIGMA as variance and covariances and display SE for THETA, OMEGA, SIGMA
</p>
<p>tableType=1: Present OMEGA and SIGMA as variance and covariances and display RSE for THETA, OMEGA, SIGMA
</p>
<p>tableType=2: Present OMEGA and SIGMA as standard-deviation and correlations and display RSE for THETA, OMEGA, SIGMA
</p>
<p>tableType=3: Present OMEGA and SIGMA as standard-deviation and correlations and display SE for THETA, OMEGA, SIGMA</p>
</td></tr>
<tr><td><code id="extToTable_+3A_wide">wide</code></td>
<td>
<p>produce a wide 9-column table (wide=TRUE, default) or a thin 3-column table(wide=FALSE)</p>
</td></tr>
<tr><td><code id="extToTable_+3A_format.estimate">format.estimate</code></td>
<td>
<p>format for estimated value, passed to sprintf</p>
</td></tr>
<tr><td><code id="extToTable_+3A_format.rse">format.rse</code></td>
<td>
<p>format for rse, passed to sprintf</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character-matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##### Load the .ext file "run001.ext"
# 1) Get path to the example file included in nonmem2R package
file1 &lt;- system.file("extdata", "run001.ext", package = "nonmem2R")
# 2) Load the file using the extload function
extToTable(file1)

</code></pre>

<hr>
<h2 id='extTransform'>Internal package function</h2><span id='topic+extTransform'></span>

<h3>Description</h3>

<p>Transforming of the named list returned by extload
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extTransform(ext, type = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extTransform_+3A_ext">ext</code></td>
<td>
<p>named list according to output from extload</p>
</td></tr>
<tr><td><code id="extTransform_+3A_type">type</code></td>
<td>
<p>Type=0: Present OMEGA and SIGMA as variance and covariances and display SE for THETA, OMEGA, SIGMA
Type=1: Present OMEGA and SIGMA as variance and covariances and display RSE for THETA, OMEGA, SIGMA
Type=2: Present OMEGA and SIGMA as standard-deviation and correlations and display RSE for THETA, OMEGA, SIGMA
Type=3: Present OMEGA and SIGMA as standard-deviation and correlations and display SE for THETA, OMEGA, SIGMA</p>
</td></tr>
</table>


<h3>Value</h3>

<p>named list according to output from extload
</p>

<hr>
<h2 id='get.GOF.dictionary'>Get, set, and modify the global (or local) GOF parameters and GOF dictionary for labels</h2><span id='topic+get.GOF.dictionary'></span><span id='topic+set.GOF.dictionary'></span><span id='topic+default.GOF.dictionary'></span><span id='topic+set.GOF.params'></span><span id='topic+get.GOF.params'></span><span id='topic+default.GOF.params'></span><span id='topic+set.ETA.labels'></span><span id='topic+set.script.name'></span><span id='topic+GOF.control'></span>

<h3>Description</h3>

<p>The current global GOF parameters and dictionary is automatically applied to every plot you draw.
Use 'get.GOF.params' to get the current GOF parameters, and 'set.GOF.params' to change
one or several parameters.
To change settings for one GOF only you can use GOF.control as input to the GOF function.
See details below for complete list of GOF parameters.
</p>
<p>Similarly use 'get.GOF.dictionary' and 'set.GOF.dictionary' for the dictionary of labels.
'set.GOF.dictionary' also allows for adding new items to the dictionary.
</p>
<p>Use &lsquo;set.ETA.labels' to set labels for ETA&rsquo;s in all plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.GOF.dictionary()

set.GOF.dictionary(...)

default.GOF.dictionary()

set.GOF.params(...)

get.GOF.params()

default.GOF.params()

set.ETA.labels(labels)

set.script.name(script.name)

GOF.control(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.GOF.dictionary_+3A_...">...</code></td>
<td>
<p>named list of GOF parameter or GOF dictionary for labels</p>
</td></tr>
<tr><td><code id="get.GOF.dictionary_+3A_labels">labels</code></td>
<td>
<p>vector of character strings with the labels</p>
</td></tr>
<tr><td><code id="get.GOF.dictionary_+3A_script.name">script.name</code></td>
<td>
<p>character strings for script name to put at end of caption</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Table below describe each of the global GOF parameters that can be modified by 'set.GOF.params'
</p>

<table>
<tr>
 <td style="text-align: left;">
<strong>Parameter</strong> </td><td style="text-align: left;"> <strong>Default</strong> </td><td style="text-align: left;"> <strong>Description</strong> </td>
</tr>
<tr>
 <td style="text-align: left;">
col.data </td><td style="text-align: left;"> "gray20" </td><td style="text-align: left;">  color for points in all GOFs  </td>
</tr>
<tr>
 <td style="text-align: left;">
cex.data </td><td style="text-align: left;"> 1.5 </td><td style="text-align: left;">       cex for points in all GOFs </td>
</tr>
<tr>
 <td style="text-align: left;">
pch.data </td><td style="text-align: left;"> 19 </td><td style="text-align: left;">        pch for points in all GOFs </td>
</tr>
<tr>
 <td style="text-align: left;">
alpha.data </td><td style="text-align: left;"> 0.5 </td><td style="text-align: left;">     alpha for points in all GOFs </td>
</tr>
<tr>
 <td style="text-align: left;">
col.smooth </td><td style="text-align: left;"> "#3366FF" </td><td style="text-align: left;">   color for smoothers  </td>
</tr>
<tr>
 <td style="text-align: left;">
lty.smooth </td><td style="text-align: left;"> 1 </td><td style="text-align: left;">   lty for smoothers </td>
</tr>
<tr>
 <td style="text-align: left;">
lwd.smooth </td><td style="text-align: left;"> 1 </td><td style="text-align: left;">   lwd for smoothers </td>
</tr>
<tr>
 <td style="text-align: left;">
se.smooth </td><td style="text-align: left;"> TRUE </td><td style="text-align: left;"> show confidence interval for loess smoother (TRUE) or not (FALSE)  </td>
</tr>
<tr>
 <td style="text-align: left;">
span.smooth </td><td style="text-align: left;"> 0.6666667 </td><td style="text-align: left;">  span parameter for loess smothers  </td>
</tr>
<tr>
 <td style="text-align: left;">
degree.smooth </td><td style="text-align: left;"> 1 </td><td style="text-align: left;">    degree  parameter for loess smothers </td>
</tr>
<tr>
 <td style="text-align: left;">
family.smooth </td><td style="text-align: left;"> "symmetric" </td><td style="text-align: left;">  family parameter for loess smothers  </td>
</tr>
<tr>
 <td style="text-align: left;">
col.refline </td><td style="text-align: left;"> "red" </td><td style="text-align: left;">   color for reference lines in all GOFs </td>
</tr>
<tr>
 <td style="text-align: left;">
lty.refline </td><td style="text-align: left;"> 2 </td><td style="text-align: left;">    lty for reference lines in all GOFs </td>
</tr>
<tr>
 <td style="text-align: left;">
lwd.refline </td><td style="text-align: left;"> 1 </td><td style="text-align: left;">    lwd for reference lines in all GOFs </td>
</tr>
<tr>
 <td style="text-align: left;">
fill.hist </td><td style="text-align: left;"> "gray30" </td><td style="text-align: left;">  color for filling of histograms   </td>
</tr>
<tr>
 <td style="text-align: left;">
col.hist </td><td style="text-align: left;"> "transparent" </td><td style="text-align: left;"> color for border of histograms   </td>
</tr>
<tr>
 <td style="text-align: left;">
alpha.hist </td><td style="text-align: left;"> 0.5 </td><td style="text-align: left;"> alpha for fill area in histograms   </td>
</tr>
<tr>
 <td style="text-align: left;">
fill.box </td><td style="text-align: left;"> "steelblue" </td><td style="text-align: left;">  color for filling of box-plots   </td>
</tr>
<tr>
 <td style="text-align: left;">
col.box </td><td style="text-align: left;"> "black" </td><td style="text-align: left;"> color for border and whisker of box-plots   </td>
</tr>
<tr>
 <td style="text-align: left;">
alpha.box </td><td style="text-align: left;"> 0.6 </td><td style="text-align: left;"> alpha for fill area in box-plots   </td>
</tr>
<tr>
 <td style="text-align: left;">
axis.labels </td><td style="text-align: left;"> TRUE </td><td style="text-align: left;">   use dictionary for labels (TRUE) or just use column names for axis labels (FALSE) </td>
</tr>
<tr>
 <td style="text-align: left;">
add.caption </td><td style="text-align: left;"> TRUE </td><td style="text-align: left;">   add caption to GOF plots (true) or not (FALSE) </td>
</tr>
<tr>
 <td style="text-align: left;">
size.caption </td><td style="text-align: left;"> 8 </td><td style="text-align: left;">    size for caption text </td>
</tr>
<tr>
 <td style="text-align: left;">
col.caption </td><td style="text-align: left;"> 1 </td><td style="text-align: left;">    color for caption text </td>
</tr>
<tr>
 <td style="text-align: left;">
caption.path.depth </td><td style="text-align: left;"> 99 </td><td style="text-align: left;">  number of folders levels to include in caption  </td>
</tr>
<tr>
 <td style="text-align: left;">
corr.fontface </td><td style="text-align: left;"> 4 </td><td style="text-align: left;">    font face for correlation in eta.pairs.GOF </td>
</tr>
<tr>
 <td style="text-align: left;">
eta.labels </td><td style="text-align: left;"> NULL </td><td style="text-align: left;">    vector of labels for ETA's</td>
</tr>
<tr>
 <td style="text-align: left;">
script.name </td><td style="text-align: left;"> "" </td><td style="text-align: left;">     script name for caption</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>### Example setting ETA labels
set.ETA.labels(c("Ka","CL","V"))
### Example setting script name
set.script.name("MyScript.R")
</code></pre>

<hr>
<h2 id='get.label'>Labels for known NONMEM variables</h2><span id='topic+get.label'></span>

<h3>Description</h3>

<p>get.label match known NONMEM variables to the GOF-dictionary and returns the matched label.
Unless trans is NULL, the label is modified to 'f(matched label)'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.label(x, trans = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.label_+3A_x">x</code></td>
<td>
<p>column to get label for</p>
</td></tr>
<tr><td><code id="get.label_+3A_trans">trans</code></td>
<td>
<p>transformation</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>[get.GOF.dictionary()],  [set.GOF.dictionary()], and [default.GOF.dictionary()].
</p>

<hr>
<h2 id='get.model.path'>Get and set model.path</h2><span id='topic+get.model.path'></span><span id='topic+set.model.path'></span>

<h3>Description</h3>

<p>The model.path in the nonmem2R set of global variables is used by functions
loading NONMEM or PSN generated output file. The model.path can ge retrived by get.model.path and
can be set using set-model.path. When loading nonmem2R the model-path is set to &quot;&quot;,
e.g. the current working directory. The model.path can be set abolute or relative, see examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.model.path()

set.model.path(model.path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.model.path_+3A_model.path">model.path</code></td>
<td>
<p>character string for path to model files</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Example for setting absolute path
set.model.path("c:/NONMEM")
## Example for setting relative path,
set.model.path("../NONMEM")

## End(Not run)
</code></pre>

<hr>
<h2 id='grid.sim'>Combine fix grid and simulated grid based on multivariate normal distribution</h2><span id='topic+grid.sim'></span>

<h3>Description</h3>

<p>grid.sim produce comparable output to mvnorm, however for methods 2 to 4 grid.sim make use of center and scaling,
and or use a fix grid of values for one column of the output. The intended use of grid.sim is for computing
confidence intervals (CI) for model predictions.
Method 1 is the same as rmvnorm, however can handle cases of zero variances in sigma.
Method 2 is method 1 followed by centering and scaling of the simulated matrix. Thus output when using method 2
always have sample mean and covariance equal to input parameters means and sigma.
Method 3 is the same as method 1 however with one column having a fixed range of values rather than a
simulated range of values.
Method 4 is method 3 followed by centering and scaling of the simulated matrix. Thus output when using method 4
always have sample mean and covariance equal to input parameters means and sigma.
</p>
<p>As the number of simulations (n) goes to infinity all methods in grid.sim are identical to mvnorm in
that the sample covariance (mean) of the output will converge to the input covariance matrix sigma (vector means).
</p>
<p>The advantage with methods 2 to 4 (over method 1 and rmvnorm) is that they provides more stable results,
hence number of simulations can be reduced and still have equally stable results when used to represent
parameter uncertainty and or population variability in model predictions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grid.sim(n, means = NULL, sigma, grid.param = NULL, method = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grid.sim_+3A_n">n</code></td>
<td>
<p>Number of simulations</p>
</td></tr>
<tr><td><code id="grid.sim_+3A_means">means</code></td>
<td>
<p>vector of mean values</p>
</td></tr>
<tr><td><code id="grid.sim_+3A_sigma">sigma</code></td>
<td>
<p>covariance matrix</p>
</td></tr>
<tr><td><code id="grid.sim_+3A_grid.param">grid.param</code></td>
<td>
<p>the index of the parameter for which a fix grid (from qnorm) is used instead of a simulated grid (rnorm).
If grid.param=NULL (default) the fix grid will be used for the parameter with largest variance.</p>
</td></tr>
<tr><td><code id="grid.sim_+3A_method">method</code></td>
<td>
<p>simulation method, default=4</p>
</td></tr>
</table>


<h3>Value</h3>

<p>row-matrix of parameters
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sigma&lt;-matrix(c(1,0.5,0.5,2),ncol=2)
sim1&lt;-grid.sim(1000,sigma=sigma)
pairs(sim1)
cov(sim1)
</code></pre>

<hr>
<h2 id='grid.sim.internal1'>Internal function</h2><span id='topic+grid.sim.internal1'></span>

<h3>Description</h3>

<p>Internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grid.sim.internal1(n, means = NULL, sigma, grid.param = NULL, pure.sim = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grid.sim.internal1_+3A_n">n</code></td>
<td>
<p>Number of simulations</p>
</td></tr>
<tr><td><code id="grid.sim.internal1_+3A_means">means</code></td>
<td>
<p>vector of mean values</p>
</td></tr>
<tr><td><code id="grid.sim.internal1_+3A_sigma">sigma</code></td>
<td>
<p>covariance matrix</p>
</td></tr>
<tr><td><code id="grid.sim.internal1_+3A_grid.param">grid.param</code></td>
<td>
<p>the index of the parameter for which a fix grid (from qnorm) is used instead of a simulated grid (rnorm).
If grid.param=NULL ( default) the fix grid will be used for the parameter with largest variance.</p>
</td></tr>
<tr><td><code id="grid.sim.internal1_+3A_pure.sim">pure.sim</code></td>
<td>
<p>Pure sim or use grid simulation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>row-matrix of parameters
</p>

<hr>
<h2 id='grid.sim.internal2'>Internal function</h2><span id='topic+grid.sim.internal2'></span>

<h3>Description</h3>

<p>Internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grid.sim.internal2(n, means = NULL, sigma, grid.param = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grid.sim.internal2_+3A_n">n</code></td>
<td>
<p>Number of simulations</p>
</td></tr>
<tr><td><code id="grid.sim.internal2_+3A_means">means</code></td>
<td>
<p>vector of mean values</p>
</td></tr>
<tr><td><code id="grid.sim.internal2_+3A_sigma">sigma</code></td>
<td>
<p>covariance matrix</p>
</td></tr>
<tr><td><code id="grid.sim.internal2_+3A_grid.param">grid.param</code></td>
<td>
<p>the index of the parameter for which a fix grid (from qnorm) is used instead of a simulated grid (rnorm).
If grid.param=NULL ( default) the fix grid will be used for the parameter with largest variance.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>row-matrix of parameters
</p>

<hr>
<h2 id='grid.sim.internal3'>Internal function</h2><span id='topic+grid.sim.internal3'></span>

<h3>Description</h3>

<p>Internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grid.sim.internal3(n, means = NULL, sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grid.sim.internal3_+3A_n">n</code></td>
<td>
<p>Number of simulations</p>
</td></tr>
<tr><td><code id="grid.sim.internal3_+3A_means">means</code></td>
<td>
<p>vector of mean values</p>
</td></tr>
<tr><td><code id="grid.sim.internal3_+3A_sigma">sigma</code></td>
<td>
<p>covariance matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>row-matrix of parameters
</p>

<hr>
<h2 id='histGOF'>Histogram GOF</h2><span id='topic+histGOF'></span>

<h3>Description</h3>

<p>Histogram GOF showing histogram, smooth density, and normal density as reference line
and caption added as reurned by get.caption
</p>


<h3>Usage</h3>

<pre><code class='language-R'>histGOF(
  data,
  x,
  title = "",
  color = "",
  fx = NULL,
  bins = NA,
  refline = TRUE,
  control = GOF.control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="histGOF_+3A_data">data</code></td>
<td>
<p>data.frame to plot</p>
</td></tr>
<tr><td><code id="histGOF_+3A_x">x</code></td>
<td>
<p>character string with name of column for x</p>
</td></tr>
<tr><td><code id="histGOF_+3A_title">title</code></td>
<td>
<p>title</p>
</td></tr>
<tr><td><code id="histGOF_+3A_color">color</code></td>
<td>
<p>data columns to set different colors in plot, interpreted as factor</p>
</td></tr>
<tr><td><code id="histGOF_+3A_fx">fx</code></td>
<td>
<p>function for transformation of x before plotting</p>
</td></tr>
<tr><td><code id="histGOF_+3A_bins">bins</code></td>
<td>
<p>number of histogram bins, if NA, bins are set using Sturges' formula</p>
</td></tr>
<tr><td><code id="histGOF_+3A_refline">refline</code></td>
<td>
<p>add reference line (default =TRUE) or not (FALSE)</p>
</td></tr>
<tr><td><code id="histGOF_+3A_control">control</code></td>
<td>
<p>an optional list of control settings. See GOF.control for the names of the settable control values and their effect.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>dd&lt;-data.frame(CWRES=rnorm(100),gr=rep(LETTERS[1:5],20))
histGOF(dd,"CWRES",color="gr")

</code></pre>

<hr>
<h2 id='merge2GOF'>Merging 2, 4, or 6 GOF's into one graph</h2><span id='topic+merge2GOF'></span><span id='topic+merge4GOF'></span><span id='topic+merge6GOF'></span>

<h3>Description</h3>

<p>Merging multiple GOFs (ggplot objects) into one graph with
caption added as reurned by get.caption. Any legend present in first GOF is added to the combined graph.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merge2GOF(p1, p2, byrow = TRUE)

merge4GOF(p1, p2, p3, p4)

merge6GOF(p1, p2, p3, p4, p5, p6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merge2GOF_+3A_p1">p1</code></td>
<td>
<p>first ggplot object</p>
</td></tr>
<tr><td><code id="merge2GOF_+3A_p2">p2</code></td>
<td>
<p>second ggplot object</p>
</td></tr>
<tr><td><code id="merge2GOF_+3A_byrow">byrow</code></td>
<td>
<p>combine plots side by side (TRUE) or one above the other (FALSE)</p>
</td></tr>
<tr><td><code id="merge2GOF_+3A_p3">p3</code></td>
<td>
<p>third ggplot object</p>
</td></tr>
<tr><td><code id="merge2GOF_+3A_p4">p4</code></td>
<td>
<p>4th ggplot object</p>
</td></tr>
<tr><td><code id="merge2GOF_+3A_p5">p5</code></td>
<td>
<p>5th ggplot object</p>
</td></tr>
<tr><td><code id="merge2GOF_+3A_p6">p6</code></td>
<td>
<p>6th ggplot object</p>
</td></tr>
</table>

<hr>
<h2 id='modload'>Show model file</h2><span id='topic+modload'></span>

<h3>Description</h3>

<p>Load and dump model file in the consol.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modload(model, use.model.path = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modload_+3A_model">model</code></td>
<td>
<p>name of the mod file with or without the .mod extension.
model may include full or relative path to the mod file. See examples.</p>
</td></tr>
<tr><td><code id="modload_+3A_use.model.path">use.model.path</code></td>
<td>
<p>Load file from a global defined model library (TRUE=default).
If so will look for a global character vector named <code>model.path</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##### Load the .ext file "run001.mod"
# 1) Get path to the example file included in nonmem2R package
file1 &lt;- system.file("extdata", "run001.mod", package = "nonmem2R")
# 2) Load the file using the extload function
modload(file1)

</code></pre>

<hr>
<h2 id='position_scale'>Position for scaling y</h2><span id='topic+position_scale'></span>

<h3>Description</h3>

<p>Position for scaling y
</p>


<h3>Usage</h3>

<pre><code class='language-R'>position_scale(y = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="position_scale_+3A_y">y</code></td>
<td>
<p>scale value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Position for scaling y
</p>

<hr>
<h2 id='PositionScale'>ggproto for position_scale</h2><span id='topic+PositionScale'></span>

<h3>Description</h3>

<p>ggproto for position_scale
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PositionScale
</code></pre>


<h3>Format</h3>

<p>An object of class <code>PositionScale</code> (inherits from <code>PositionDodge</code>, <code>Position</code>, <code>ggproto</code>, <code>gg</code>) of length 5.
</p>

<hr>
<h2 id='print.extToTable'>Print function for compiled summary information of class extToTable</h2><span id='topic+print.extToTable'></span>

<h3>Description</h3>

<p>Print function for compiled summary information of class extToTable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'extToTable'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.extToTable_+3A_x">x</code></td>
<td>
<p>a object af class extToTable.</p>
</td></tr>
<tr><td><code id="print.extToTable_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td></tr>
</table>

<hr>
<h2 id='print.modload'>Print function for loaded mod file</h2><span id='topic+print.modload'></span>

<h3>Description</h3>

<p>Print function for loaded mod file class modload
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'modload'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.modload_+3A_x">x</code></td>
<td>
<p>a object af class modload.</p>
</td></tr>
<tr><td><code id="print.modload_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td></tr>
</table>

<hr>
<h2 id='print.sumoR'>Print function for compiled summary information of class sumoR</h2><span id='topic+print.sumoR'></span>

<h3>Description</h3>

<p>Print function for compiled summary information of class sumoR
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sumoR'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.sumoR_+3A_x">x</code></td>
<td>
<p>a object af class sumoR.</p>
</td></tr>
<tr><td><code id="print.sumoR_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td></tr>
</table>

<hr>
<h2 id='qqnormGOF'>QQ-norm GOF</h2><span id='topic+qqnormGOF'></span>

<h3>Description</h3>

<p>QQ-norm GOF qqnorm plots with reference line
and caption added as reurned by get.caption
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qqnormGOF(
  data,
  sample,
  title = "",
  color = "",
  fx = NULL,
  refline = TRUE,
  control = GOF.control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qqnormGOF_+3A_data">data</code></td>
<td>
<p>data.frame to plot</p>
</td></tr>
<tr><td><code id="qqnormGOF_+3A_sample">sample</code></td>
<td>
<p>character string with name of column for x</p>
</td></tr>
<tr><td><code id="qqnormGOF_+3A_title">title</code></td>
<td>
<p>title</p>
</td></tr>
<tr><td><code id="qqnormGOF_+3A_color">color</code></td>
<td>
<p>data columns to set different colors in plot, interpreted as factor</p>
</td></tr>
<tr><td><code id="qqnormGOF_+3A_fx">fx</code></td>
<td>
<p>function for transformation of x before plotting</p>
</td></tr>
<tr><td><code id="qqnormGOF_+3A_refline">refline</code></td>
<td>
<p>add reference line (default =TRUE) or not (FALSE)</p>
</td></tr>
<tr><td><code id="qqnormGOF_+3A_control">control</code></td>
<td>
<p>an optional list of control settings. See GOF.control for the names of the settable control values and their effect.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>dd&lt;-data.frame(CWRES=rnorm(100))
qqnormGOF(dd,"CWRES")
</code></pre>

<hr>
<h2 id='readVpc'>Internal package function</h2><span id='topic+readVpc'></span>

<h3>Description</h3>

<p>Internal package function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readVpc(vpc.results = NULL, npc.results = NULL, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readVpc_+3A_vpc.results">vpc.results</code></td>
<td>
<p>vpc results</p>
</td></tr>
<tr><td><code id="readVpc_+3A_npc.results">npc.results</code></td>
<td>
<p>npc results</p>
</td></tr>
<tr><td><code id="readVpc_+3A_verbose">verbose</code></td>
<td>
<p>verbose</p>
</td></tr>
<tr><td><code id="readVpc_+3A_...">...</code></td>
<td>
<p>Further arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named list
</p>

<hr>
<h2 id='stat_corr'>Adding correlation to x-y plots</h2><span id='topic+stat_corr'></span>

<h3>Description</h3>

<p>Correlation to x-y plots. This stat is indended for providing correlations e.g. above the
diagonal of a pairs plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_corr(
  mapping = NULL,
  data = NULL,
  geom = "text",
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_corr_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by aes or aes_.</p>
</td></tr>
<tr><td><code id="stat_corr_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer.</p>
</td></tr>
<tr><td><code id="stat_corr_+3A_geom">geom</code></td>
<td>
<p>Use to override the default geom</p>
</td></tr>
<tr><td><code id="stat_corr_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string, or the result of a call to a position adjustment function.</p>
</td></tr>
<tr><td><code id="stat_corr_+3A_na.rm">na.rm</code></td>
<td>
<p>If FALSE, the default, missing values are removed with a warning. If TRUE, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="stat_corr_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends? NA, the default, includes if any aesthetics are mapped. FALSE never includes, and TRUE always includes.</p>
</td></tr>
<tr><td><code id="stat_corr_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If FALSE, overrides the default aesthetics, rather than combining with them.</p>
</td></tr>
<tr><td><code id="stat_corr_+3A_...">...</code></td>
<td>
<p>other arguments passed on to layer.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Provide normal QQplot
</p>

<hr>
<h2 id='stat_denx'>Density for x in x-y plot</h2><span id='topic+stat_denx'></span>

<h3>Description</h3>

<p>Density for x in x-y plot. This stat is indended for providing the a density on the
diagonal of a pairs plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_denx(
  mapping = NULL,
  data = NULL,
  geom = "polygon",
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_denx_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by aes or aes_.</p>
</td></tr>
<tr><td><code id="stat_denx_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer.</p>
</td></tr>
<tr><td><code id="stat_denx_+3A_geom">geom</code></td>
<td>
<p>Use to override the default geom</p>
</td></tr>
<tr><td><code id="stat_denx_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string, or the result of a call to a position adjustment function.</p>
</td></tr>
<tr><td><code id="stat_denx_+3A_na.rm">na.rm</code></td>
<td>
<p>If FALSE, the default, missing values are removed with a warning. If TRUE, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="stat_denx_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends? NA, the default, includes if any aesthetics are mapped. FALSE never includes, and TRUE always includes.</p>
</td></tr>
<tr><td><code id="stat_denx_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If FALSE, overrides the default aesthetics, rather than combining with them.</p>
</td></tr>
<tr><td><code id="stat_denx_+3A_...">...</code></td>
<td>
<p>other arguments passed on to layer.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Provide normal QQplot
</p>

<hr>
<h2 id='stat_dnorm'>Normal density</h2><span id='topic+stat_dnorm'></span>

<h3>Description</h3>

<p>Normal density with ggplot2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_dnorm(
  mapping = NULL,
  data = NULL,
  geom = "line",
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_dnorm_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by aes or aes_.</p>
</td></tr>
<tr><td><code id="stat_dnorm_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer.</p>
</td></tr>
<tr><td><code id="stat_dnorm_+3A_geom">geom</code></td>
<td>
<p>Use to override the default geom</p>
</td></tr>
<tr><td><code id="stat_dnorm_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string, or the result of a call to a position adjustment function.</p>
</td></tr>
<tr><td><code id="stat_dnorm_+3A_na.rm">na.rm</code></td>
<td>
<p>If FALSE, the default, missing values are removed with a warning. If TRUE, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="stat_dnorm_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends? NA, the default, includes if any aesthetics are mapped. FALSE never includes, and TRUE always includes.</p>
</td></tr>
<tr><td><code id="stat_dnorm_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If FALSE, overrides the default aesthetics, rather than combining with them.</p>
</td></tr>
<tr><td><code id="stat_dnorm_+3A_...">...</code></td>
<td>
<p>other arguments passed on to layer.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Provide normal QQplot
</p>

<hr>
<h2 id='stat_hmean'>Horizontal reference at mean</h2><span id='topic+stat_hmean'></span>

<h3>Description</h3>

<p>Horizontal reference at mean with ggplot2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_hmean(
  mapping = NULL,
  data = NULL,
  geom = "hline",
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_hmean_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by aes or aes_.</p>
</td></tr>
<tr><td><code id="stat_hmean_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer.</p>
</td></tr>
<tr><td><code id="stat_hmean_+3A_geom">geom</code></td>
<td>
<p>Use to override the default geom</p>
</td></tr>
<tr><td><code id="stat_hmean_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string, or the result of a call to a position adjustment function.</p>
</td></tr>
<tr><td><code id="stat_hmean_+3A_na.rm">na.rm</code></td>
<td>
<p>If FALSE, the default, missing values are removed with a warning. If TRUE, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="stat_hmean_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends? NA, the default, includes if any aesthetics are mapped. FALSE never includes, and TRUE always includes.</p>
</td></tr>
<tr><td><code id="stat_hmean_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If FALSE, overrides the default aesthetics, rather than combining with them.</p>
</td></tr>
<tr><td><code id="stat_hmean_+3A_...">...</code></td>
<td>
<p>other arguments passed on to layer.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Provide normal QQplot
</p>

<hr>
<h2 id='stat_hmedian'>Horizontal reference at median</h2><span id='topic+stat_hmedian'></span>

<h3>Description</h3>

<p>Horizontal reference at median with ggplot2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_hmedian(
  mapping = NULL,
  data = NULL,
  geom = "hline",
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_hmedian_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by aes or aes_.</p>
</td></tr>
<tr><td><code id="stat_hmedian_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer.</p>
</td></tr>
<tr><td><code id="stat_hmedian_+3A_geom">geom</code></td>
<td>
<p>Use to override the default geom</p>
</td></tr>
<tr><td><code id="stat_hmedian_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string, or the result of a call to a position adjustment function.</p>
</td></tr>
<tr><td><code id="stat_hmedian_+3A_na.rm">na.rm</code></td>
<td>
<p>If FALSE, the default, missing values are removed with a warning. If TRUE, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="stat_hmedian_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends? NA, the default, includes if any aesthetics are mapped. FALSE never includes, and TRUE always includes.</p>
</td></tr>
<tr><td><code id="stat_hmedian_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If FALSE, overrides the default aesthetics, rather than combining with them.</p>
</td></tr>
<tr><td><code id="stat_hmedian_+3A_...">...</code></td>
<td>
<p>other arguments passed on to layer.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Provide normal QQplot
</p>


<h3>Aesthetics</h3>

<p>geom_smooth understands the following aesthetics (required aesthetics are in bold):<br />
<b>x</b>, alpha, colour, fill, group, shape, size, stroke
</p>

<hr>
<h2 id='StatCorr'>ggproto for stat_corr</h2><span id='topic+StatCorr'></span>

<h3>Description</h3>

<p>ggproto for stat_corr adding correlation to x-y plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StatCorr
</code></pre>


<h3>Format</h3>

<p>An object of class <code>StatCorr</code> (inherits from <code>Stat</code>, <code>ggproto</code>, <code>gg</code>) of length 3.
</p>

<hr>
<h2 id='StatDenx'>ggproto for stat_denx</h2><span id='topic+StatDenx'></span>

<h3>Description</h3>

<p>ggproto for stat_denx adding density for x with y-scaled to fit current scale
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StatDenx
</code></pre>


<h3>Format</h3>

<p>An object of class <code>StatDenx</code> (inherits from <code>Stat</code>, <code>ggproto</code>, <code>gg</code>) of length 3.
</p>

<hr>
<h2 id='StatDnorm'>ggproto for stat_dnorm</h2><span id='topic+StatDnorm'></span>

<h3>Description</h3>

<p>ggproto for stat_dnorm doing normal density to histograms
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StatDnorm
</code></pre>


<h3>Format</h3>

<p>An object of class <code>StatDnorm</code> (inherits from <code>Stat</code>, <code>ggproto</code>, <code>gg</code>) of length 3.
</p>

<hr>
<h2 id='StatHmean'>ggproto for stat_hmean</h2><span id='topic+StatHmean'></span>

<h3>Description</h3>

<p>ggproto for stat_hmean doing horizontal reference line at mean
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StatHmean
</code></pre>


<h3>Format</h3>

<p>An object of class <code>StatHmean</code> (inherits from <code>Stat</code>, <code>ggproto</code>, <code>gg</code>) of length 3.
</p>

<hr>
<h2 id='StatHmedian'>ggproto for stat_hmedian</h2><span id='topic+StatHmedian'></span>

<h3>Description</h3>

<p>ggproto for stat_hmedian doing horizontal reference line at median
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StatHmedian
</code></pre>


<h3>Format</h3>

<p>An object of class <code>StatHmedian</code> (inherits from <code>Stat</code>, <code>ggproto</code>, <code>gg</code>) of length 3.
</p>

<hr>
<h2 id='sumoR'>Compile summary information for NONMEM model based on the lst file, ext file, and the cov file.</h2><span id='topic+sumoR'></span>

<h3>Description</h3>

<p>Compile summary information similar to that of the sumo PSN function, based on the NONMEM output files
lst, ext, and if covariance setp was run, the cov file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sumoR(
  model,
  use.model.path = TRUE,
  tableType = 2,
  format.estimate = "% -#6.4g",
  format.rse = "%#6.3g"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sumoR_+3A_model">model</code></td>
<td>
<p>name of the lst file with or without the .lst extension. model may include full or relative path to the lst file.</p>
</td></tr>
<tr><td><code id="sumoR_+3A_use.model.path">use.model.path</code></td>
<td>
<p>Load file from a global defined model library (TRUE=default).
If so will look for a global character vector named <code>model.path</code></p>
</td></tr>
<tr><td><code id="sumoR_+3A_tabletype">tableType</code></td>
<td>
<p>Table type for THETA's, OMEGA's and SIGMA's <br />
tableType=0: Present OMEGA and SIGMA as variance and covariances and display SE for THETA, OMEGA, SIGMA <br />
tableType=1: Present OMEGA and SIGMA as variance and covariances and display RSE for THETA, OMEGA, SIGMA <br />
tableType=2: Present OMEGA and SIGMA as standard-deviation and correlations and display RSE for THETA, OMEGA, SIGMA <br />
tableType=3: Present OMEGA and SIGMA as standard-deviation and correlations and display SE for THETA, OMEGA, SIGMA <br /></p>
</td></tr>
<tr><td><code id="sumoR_+3A_format.estimate">format.estimate</code></td>
<td>
<p>format for estimated value, passed to sprintf</p>
</td></tr>
<tr><td><code id="sumoR_+3A_format.rse">format.rse</code></td>
<td>
<p>format for RSE or SE, passed to sprintf</p>
</td></tr>
</table>


<h3>Value</h3>

<p>named list of class sumoR
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##### Compile summary information from the .lst file "run001.lst"
# 1) Get path to the example file included in nonmem2R package
file1 &lt;- system.file("extdata", "run001.lst", package = "nonmem2R")
# 2) Compile summary information from "run001.lst"
sumoR(file1)
</code></pre>

<hr>
<h2 id='sumoRU'>Internal package function</h2><span id='topic+sumoRU'></span>

<h3>Description</h3>

<p>Internal function for sumoR on unix/linux system
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sumoRU(file.path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sumoRU_+3A_file.path">file.path</code></td>
<td>
<p>path including file name to model lst file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>named list
</p>

<hr>
<h2 id='test.grid.sim'>Function for testing grid.sim and compare with rmvnorm</h2><span id='topic+test.grid.sim'></span>

<h3>Description</h3>

<p>Test grid.sim
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test.grid.sim(n = 1000, k = 1:4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test.grid.sim_+3A_n">n</code></td>
<td>
<p>number of simulations</p>
</td></tr>
<tr><td><code id="test.grid.sim_+3A_k">k</code></td>
<td>
<p>subset of parameters from a 4X4 sigma to use</p>
</td></tr>
</table>


<h3>Value</h3>

<p>graphics
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
require(lattice)
test.grid.sim(n=1000)

## End(Not run)
</code></pre>

<hr>
<h2 id='vpcfig'>Visual Predictive Check (VPC) based on Perl-speaks-NONMEM (PsN) generated VPC files (lattice version).</h2><span id='topic+vpcfig'></span>

<h3>Description</h3>

<p>This function creates VPC using output files from the vpc command in Pearl Speaks NONMEM (PsN).
Graphs are generated using the lattice package with many arguments for plot settings are passed
directly to the xyplot function and have the same flexibility as when used in xyplot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpcfig(
  vpcdir = NULL,
  vpctab = NULL,
  vpcresult = NULL,
  use.model.path = TRUE,
  strata.names = NULL,
  strata.subset = NULL,
  percentile = 10,
  fy = function(y) {     y },
  fx = function(x) {     x },
  xlab = NULL,
  ylab = NULL,
  col.data = 8,
  cex.data = 0.3,
  pch.data = 3,
  col.line = c("blue", "red", "blue"),
  lwd.line = c(1, 2, 1),
  lty.line = c(1, 1, 1),
  col.segm = c("lightblue", "pink", "lightblue"),
  alpha.segm = c(0.5, 0.5, 0.5),
  type = 3,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpcfig_+3A_vpcdir">vpcdir</code></td>
<td>
<p>Path of directory of the VPC files</p>
</td></tr>
<tr><td><code id="vpcfig_+3A_vpctab">vpctab</code></td>
<td>
<p>Path to the vpctab-file</p>
</td></tr>
<tr><td><code id="vpcfig_+3A_vpcresult">vpcresult</code></td>
<td>
<p>Path to the vpcresult file</p>
</td></tr>
<tr><td><code id="vpcfig_+3A_use.model.path">use.model.path</code></td>
<td>
<p>Load file from a global defined model library (TRUE=default).
If so will look for a global character vector named <code>model.path</code></p>
</td></tr>
<tr><td><code id="vpcfig_+3A_strata.names">strata.names</code></td>
<td>
<p>Character vector for strata names. Must have length equal to number of strata's in vpc files, otherwise ignored.</p>
</td></tr>
<tr><td><code id="vpcfig_+3A_strata.subset">strata.subset</code></td>
<td>
<p>Vector specifying subset of strata to use. Either a vector of index, e.g.  strata.subset=c(1,3),
or a character vector naming which strata to use. See details.</p>
</td></tr>
<tr><td><code id="vpcfig_+3A_percentile">percentile</code></td>
<td>
<p>percentile to use, default=10 will display 10
Percentile argument must match columns included in the vpcresult file.</p>
</td></tr>
<tr><td><code id="vpcfig_+3A_fy">fy</code></td>
<td>
<p>transformation function for y-axis, default to identity function (f(y)=y).</p>
</td></tr>
<tr><td><code id="vpcfig_+3A_fx">fx</code></td>
<td>
<p>transformation function for x-axis, default to identity function (f(x)=x)</p>
</td></tr>
<tr><td><code id="vpcfig_+3A_xlab">xlab</code></td>
<td>
<p>label for x-axis, default is IDV as found in vpcresultfile, passed to xyplot.</p>
</td></tr>
<tr><td><code id="vpcfig_+3A_ylab">ylab</code></td>
<td>
<p>label for y-axis, default is DV as found in vpcresultfile, passed to xyplot.</p>
</td></tr>
<tr><td><code id="vpcfig_+3A_col.data">col.data</code></td>
<td>
<p>color for data points, passed to xyplot, default=8</p>
</td></tr>
<tr><td><code id="vpcfig_+3A_cex.data">cex.data</code></td>
<td>
<p>cex for data points, passed to xyplot, default=0.3</p>
</td></tr>
<tr><td><code id="vpcfig_+3A_pch.data">pch.data</code></td>
<td>
<p>plot symbol (pch) for data points, passed to xyplot, default=3</p>
</td></tr>
<tr><td><code id="vpcfig_+3A_col.line">col.line</code></td>
<td>
<p>line color for low quartile, median, and high quartile of data, passed to xyplot, default=c(&quot;blue&quot;,&quot;red&quot;,&quot;blue&quot;)</p>
</td></tr>
<tr><td><code id="vpcfig_+3A_lwd.line">lwd.line</code></td>
<td>
<p>line width (lwd) for low quartile, median, and high quartile of data, passed to xyplot, default=c(1,2,1)</p>
</td></tr>
<tr><td><code id="vpcfig_+3A_lty.line">lty.line</code></td>
<td>
<p>line type (lty) for low quartile, median, and high quartile of data, passed to xyplot, default=c(1,1,1)</p>
</td></tr>
<tr><td><code id="vpcfig_+3A_col.segm">col.segm</code></td>
<td>
<p>Color of CI regions (low, median and high) for model, passed to xyplot, default=c(&quot;lightblue&quot;,&quot;pink&quot;,&quot;lightblue&quot;)</p>
</td></tr>
<tr><td><code id="vpcfig_+3A_alpha.segm">alpha.segm</code></td>
<td>
<p>alpha of CI regions (low, median and high) for model, passed to xyplot, default=c(0.5,0.5,0.5)</p>
</td></tr>
<tr><td><code id="vpcfig_+3A_type">type</code></td>
<td>
<p>type of VPC plot, 1=display model regions only, 2=as 1 + lines (low, median and high) of data,
3= as 2 + points for data.
type=0 can also be used and then no graph is produced but instead a list with 2 dataframes is returned.
one for the vpcresult and on for the observed data in the vpctab file.</p>
</td></tr>
<tr><td><code id="vpcfig_+3A_...">...</code></td>
<td>
<p>Further arguments, passed to xyplot, e.g xlim and ylim axis limits, main for title of plot, abline for adding reference lines, or
scales for formatting axes, see help files for xyplot.
Note: col, cex, pch, lty, lwd, and alpha should not be used.
Instead use the corresponding arguments defined above.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The lattice package is used for creating the VPC and vpcfig have functionality for e.g. modify names of strata,
change layout of panels, use log-scale.
</p>
<p>The data used is either specified by the directory of the PsN generated files,
or by specifying the file names of both the vpctab-file and the vpcresult file.
See examples 1 and 2 below.
</p>
<p>Names of strata can be changed with the strata.names argument, if strata.names
is NULL the names as specified in the vpcresult file are used.
</p>
<p>strata.subset can be used to select a subset of strata, and or to change the order of stratas. Se example 3.
NOTE: strata.subset is matched with strata.names unless strata.names=NULL.
If strata.names=NULL then strata.subset is matched to names as specified in vpcresult file.
Default is to use all strata's (strata.subset=NULL).
</p>
<p>The fy and fx arguments can be used to alter the scale of data plotted.
For example, using fy=function(y)(log(y+1))
is a convenient way to get log-scale for y-axis but with an off-set to show any values==0. Proper y tick marks
can then be set by using the xyplot argument scales.
</p>


<h3>Value</h3>

<p>lattice object of VPC plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Get path to the example files included in nonmem2R package
file1 &lt;- system.file("extdata", "vpctab004.dat", package = "nonmem2R")
file2 &lt;- system.file("extdata", "vpc_results.csv", package = "nonmem2R")


# Ex 1, produce VPC with default setting, here specifying both vpctab and vpcresult
vpcfig(vpctab=file1,vpcresult=file2)

## Not run: 
# Ex 2, produce VPC with default setting, here specifying only directory of vpc files
path1&lt;-gsub("vpctab004.dat","",file1)
vpcfig(vpcdir=path1)

## End(Not run)

# Ex 3, produce VPC with i) modifies strata names, ii) strata in reverse order, and
#        iii) labels
strata.names&lt;-c("Group A","Group B")
xlab&lt;-"Time after dose (hrs)"
ylab&lt;-"Plasma Conc(mmol/L)"
vpcfig(vpctab=file1,vpcresult=file2,strata.names=strata.names,strata.subset=2:1,
       xlab=xlab,ylab=ylab)
</code></pre>

<hr>
<h2 id='vpcfig2'>Visual Predictive Check (VPC) based on Perl-speaks-NONMEM (PsN) generated VPC files (ggplot2-version).</h2><span id='topic+vpcfig2'></span>

<h3>Description</h3>

<p>This function creates VPC using output files from the vpc command in Pearl Speaks NONMEM (PsN).
Graphs are generated using the ggplot2 package and the return object is an ggplot class and
can be further modified, see details below and documentation for ggplot2 for further details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpcfig2(
  vpcdir = NULL,
  vpctab = NULL,
  vpcresult = NULL,
  use.model.path = TRUE,
  strata.names = NULL,
  strata.subset = NULL,
  median.only = FALSE,
  bin.idv = c("median", "midpoint"),
  percentile = 10,
  fy = function(y) {     y },
  fx = function(x) {     x },
  xlab = NULL,
  ylab = NULL,
  col.data = "gray20",
  cex.data = 1,
  pch.data = 19,
  alpha.data = 0.5,
  col.line = "grey20",
  lwd.line = 1,
  lty.line = c(2, 1, 2),
  col.segm = c("steelblue", "gray50", "steelblue"),
  alpha.segm = 0.6,
  type = 3,
  panel.height.censored = 0.25,
  censoring.labels = c("ALQ", "BLQ"),
  ignore.censoring = FALSE,
  control = GOF.control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpcfig2_+3A_vpcdir">vpcdir</code></td>
<td>
<p>Path of directory of the VPC files</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_vpctab">vpctab</code></td>
<td>
<p>Path to the vpctab-file</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_vpcresult">vpcresult</code></td>
<td>
<p>Path to the vpcresult file</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_use.model.path">use.model.path</code></td>
<td>
<p>Load file from a global defined model library (TRUE=default).
If so will look for a global character vector named <code>model.path</code></p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_strata.names">strata.names</code></td>
<td>
<p>Character vector for strata names. Must have length equal to number of strata's in vpc files, otherwise ignored.</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_strata.subset">strata.subset</code></td>
<td>
<p>Vector specifying subset of strata to use. Either a vector of index, e.g.  strata.subset=c(1,3),
or a character vector naming which strata to use. See details.</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_median.only">median.only</code></td>
<td>
<p>Logical to plot only median and no quantiles for model and data (FALSE=default)</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_bin.idv">bin.idv</code></td>
<td>
<p>Method for computed idv value for plotting bin summary values.
Set to &quot;median&quot; to use median of independent variable in each bin on x-axis (default),
or set to &quot;midpoint&quot; to use midpoint of bins on x-axis.</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_percentile">percentile</code></td>
<td>
<p>percentile to use, default=10 will display 10
Percentile argument must match columns included in the vpcresult file.</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_fy">fy</code></td>
<td>
<p>transformation function for y-axis, default to identity function (f(y)=y).</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_fx">fx</code></td>
<td>
<p>transformation function for x-axis, default to identity function (f(x)=x)</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_xlab">xlab</code></td>
<td>
<p>label for x-axis, default is IDV as found in vpcresultfile, passed to labs.</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_ylab">ylab</code></td>
<td>
<p>label for y-axis, default is DV as found in vpcresultfile, passed to labs.</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_col.data">col.data</code></td>
<td>
<p>color for data points, passed to geom_point, default=&quot;gray20&quot;</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_cex.data">cex.data</code></td>
<td>
<p>cex for data points, passed to geom_point, default=1</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_pch.data">pch.data</code></td>
<td>
<p>plot symbol (pch) for data points, passed to geom_point, default=19</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_alpha.data">alpha.data</code></td>
<td>
<p>alpha for plotting of data points, passed to geom_point, default=0.5</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_col.line">col.line</code></td>
<td>
<p>line color for low quartile, median, and high quartile of data,
passed to geom_line, default=&quot;gray20&quot;</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_lwd.line">lwd.line</code></td>
<td>
<p>line width (lwd) for low quartile, median, and high quartile of data, passed to geom_line, default=1</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_lty.line">lty.line</code></td>
<td>
<p>line type (lty) for low quartile, median, and high quartile of data, passed to geom_line,
should be vector of length 3, default=c(2,1,2)</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_col.segm">col.segm</code></td>
<td>
<p>Color of CI regions (low, median and high) for model, passed to geom_polygon,
should be vector of length 3, default=c(&quot;steelblue&quot;, &quot;gray50&quot;, &quot;steelblue&quot;)</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_alpha.segm">alpha.segm</code></td>
<td>
<p>alpha of CI regions (low, median and high) for model, passed to geom_polygon, default=0.6</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_type">type</code></td>
<td>
<p>type of VPC plot:
</p>
<p>1=display model regions only,
</p>
<p>2=as 1 + lines (low, median and high) of data,
</p>
<p>3= as 2 + points for data.
</p>
<p>type=0 can also be used and then no graph is produced but instead a list with 2 dataframes is returned.
one for the vpcresult and on for the observed data in the vpctab file.</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_panel.height.censored">panel.height.censored</code></td>
<td>
<p>Height for BLQ ALQ panels. Height is relative to height of Un-cenored panel, default=0.25</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_censoring.labels">censoring.labels</code></td>
<td>
<p>Character vector used as labels for panels when VPC have either BLQ or ALQ data
Default set to c(&quot;ALQ&quot;,&quot;BLQ&quot;). NOTE: must be character vector of length 2</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_ignore.censoring">ignore.censoring</code></td>
<td>
<p>Ignore any censoring results in VPC result file (BLQ and ALQ), defult=FALSE</p>
</td></tr>
<tr><td><code id="vpcfig2_+3A_control">control</code></td>
<td>
<p>an optional list of control settings. See GOF.control for the names of the settable control values and their effect.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ggplot2 package is used for creating the VPC and vpcfig2 have functionality for e.g. modify
names of strata, order of and subset of strata's, and transform the x- and or y-axis before plotting.
</p>
<p>The data used is either specified by the directory of the PsN generated files,
or by specifying the file names of both the vpctab-file and the vpcresult file.
See examples 1 and 2 below.
</p>
<p>Names of strata can be changed with the strata.names argument, if strata.names
is NULL the names as specified in the vpcresult file are used.
</p>
<p>strata.subset can be used to select a subset of strata, and or to change the order of stratas.
See example 3.
</p>
<p><strong>Strata.subset</strong> is matched with strata.names unless strata.names=NULL.
If strata.names=NULL then strata.subset is matched to names as specified in vpcresult file.
Default is to use all strata's (strata.subset=NULL).
</p>
<p>The fy and fx arguments can be used to alter the scale of data plotted.
For example, using <code>fy=function(y){log(y+1)}</code>
is a convenient way to get log-scale for y-axis but with an off-set to show any values==0.
Proper y tick marks can then be set using the <code>scale_y_continuous</code> ggplot2 function.
</p>
<p>Since the returned objest is a ggplot-class object is can be further modified to e.g. to
log-scale for y.axis;
</p>
<p><code>vpcfig2(...)+scale_y_log10()</code>,
</p>
<p>adding/changing labels &amp; titles;
</p>
<p><code>vpcfig2(...)+labs(y="Modified y-label", title="New title")</code>.
</p>
<p><strong>Axis-limits</strong> are preferably set using the ggplot2 function
<code>coord_cartesian(...)</code>. This way data points outside the axis-limit are only hidden when plotting.
</p>
<p><strong>Stratified</strong> VPC's are created with <code>facet_wrap(~strata)</code> as deafult but can be
modified to use <code>facet_grid</code> for setting the panel grid.
</p>
<p>However faceting must be done with <code>~strata</code>.
</p>
<p>See examples below and documentation for ggplot2 for further details.
</p>


<h3>Value</h3>

<p>ggplot object of VPC plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Get path to the example files included in nonmem2R package
file1 &lt;- system.file("extdata", "vpctab004.dat", package = "nonmem2R")
file2 &lt;- system.file("extdata", "vpc_results.csv", package = "nonmem2R")


# Ex 1, produce VPC with default setting, here specifying both vpctab and vpcresult
vpcfig2(vpctab=file1,vpcresult=file2)

## Not run: 
# Ex 2, produce VPC with default setting, here specifying only directory of vpc files
path1&lt;-gsub("vpctab004.dat","",file1)
vpcfig2(vpcdir=path1)

## End(Not run)

# Ex 3, produce VPC with i) modifies strata names, ii) strata in reverse order, and
#        iii) labels
strata.names&lt;-c("Group A","Group B")
xlab&lt;-"Time after dose (hrs)"
ylab&lt;-"Plasma Conc(mmol/L)"
vpcfig2(vpctab=file1,vpcresult=file2,strata.names=strata.names,strata.subset=2:1,
       xlab=xlab,ylab=ylab)


# Example using the fy argument to transform y-axis setting y-ticks using scale_y_continuous(...)
tmp&lt;-c(1,2,3,4,6)
yticks&lt;-c(0.1,tmp,tmp*10,tmp*100,tmp*1000)
vpcfig2(vpctab=file1,vpcresult=file2,fy=function(y){log(y+1)})+
 scale_y_continuous(breaks=log(yticks+1),labels=yticks,minor_breaks=NULL)

## Not run: 
# Example changing to slog-scale using the ggplot2 function scale_y_log10
vpcfig2(vpctab=file1,vpcresult=file2)+scale_y_log10()

## End(Not run)
# Example changing y-axis label and adding figure title using ggplot2 function labs(...).
vpcfig2(vpctab=file1,vpcresult=file2)+labs(y="Modified y-label", title="New title")


</code></pre>

<hr>
<h2 id='vpcfig3'>Visual Predictive Check (VPC) based on raw Perl-speaks-NONMEM (PsN) generated VPC files.</h2><span id='topic+vpcfig3'></span>

<h3>Description</h3>

<p>This function compile VPC simulated data from the vpc command in Pearl Speaks NONMEM (PsN).
The complied data is then plotted (unless type=0) and returned (ggplot-object) and can then be
further modifed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpcfig3(
  sdtab,
  vpcdir,
  use.model.path = TRUE,
  dv = "DV",
  idvs = "TIME",
  numerical = rep(TRUE, length(idvs)),
  strata = NULL,
  method = c("loess", "spline"),
  pred.corr = c("none", "pred-corr-pro p", "pred-corr-add"),
  maxNsim = NULL,
  knots = 5,
  minobs = 8,
  col.data = "gray20",
  cex.data = 1,
  pch.data = 19,
  alpha.data = 0.5,
  col.line = "grey20",
  lwd.line = 1,
  lty.line = 1,
  col.segm = "steelblue",
  alpha.segm = 0.6,
  type = 3,
  control = GOF.control(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpcfig3_+3A_sdtab">sdtab</code></td>
<td>
<p>file path to sdtab output from model, ALTERNATIVELY a data.fram of the loaded sdtab file. See details.</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_vpcdir">vpcdir</code></td>
<td>
<p>Path of directory of the VPC files, ALTERNATIVELY a data.frame of the loaded matrix file. See details.</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_use.model.path">use.model.path</code></td>
<td>
<p>Load files from a global defined model library (TRUE=default).
If so will look for a global character vector named <code>model.path</code></p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_dv">dv</code></td>
<td>
<p>Dependent variable (y-axis)</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_idvs">idvs</code></td>
<td>
<p>Independent variable (x-axis)</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_numerical">numerical</code></td>
<td>
<p>Logical indicator if idvs is numerical variable(TRUE) or catacorical (FALSE), default=TRUE
NOTE: must be of same length as idvs</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_strata">strata</code></td>
<td>
<p>Stratification column of sdtab, NOTE must be a columns in the sdtab</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_method">method</code></td>
<td>
<p>either &quot;loess&quot; (deault) or &quot;spline&quot; for continuous IDV's</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_pred.corr">pred.corr</code></td>
<td>
<p>Set to     &quot;pred-corr-prop&quot; or &quot;pred-corr-add&quot; to preform prediction corrected VPC or set to
&quot;none&quot; (default) otherwhise.  With &quot;pred-corr-prop&quot; correction is recomened for stricly
positive data, use &quot;pred-corr-add&quot; if some data point are negative,</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_maxnsim">maxNsim</code></td>
<td>
<p>maximum number of simulations used to use for computing VPC.
Default=NULL, meaning all simulations in the input datafile/data.frame will be used.</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_knots">knots</code></td>
<td>
<p>number of knots (bins) for method spline. See details.</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_minobs">minobs</code></td>
<td>
<p>minimum number of observations per number of knots(bins) for method spline. See details.</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_col.data">col.data</code></td>
<td>
<p>color for data points, passed to geom_point, default=&quot;gray20&quot;</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_cex.data">cex.data</code></td>
<td>
<p>cex for data points, passed to geom_point, default=1</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_pch.data">pch.data</code></td>
<td>
<p>plot symbol (pch) for data points, passed to geom_point, default=19</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_alpha.data">alpha.data</code></td>
<td>
<p>alpha for plotting of data points, passed to geom_point, default=0.5</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_col.line">col.line</code></td>
<td>
<p>line color for mean of data, passed to geom_line, default=&quot;gray20&quot;</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_lwd.line">lwd.line</code></td>
<td>
<p>line width (lwd) for mean of data, passed to geom_line, default=1</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_lty.line">lty.line</code></td>
<td>
<p>line type (lty) for mean of data, passed to geom_line, default=1</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_col.segm">col.segm</code></td>
<td>
<p>Color of CI region for model, passed to geom_ribbon, default=&quot;steelblue&quot;</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_alpha.segm">alpha.segm</code></td>
<td>
<p>alpha of CI region for model, passed to geom_polygon, default=0.6</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_type">type</code></td>
<td>
<p>type of VPC plot:
</p>
<p>1=display model regions only,
</p>
<p>2=as 1 + mean of data,
</p>
<p>3= as 2 + points for data.
</p>
<p>type=0 can also be used and then no graph is produced but instead a list with 2 dataframes is returned.
one for the vpcresult and on for the observed data in the vpctab file.</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_control">control</code></td>
<td>
<p>an optional list of control settings. See GOF.control for the names of the settable control values and their effect.</p>
</td></tr>
<tr><td><code id="vpcfig3_+3A_...">...</code></td>
<td>
<p>Additional named arguments (e.g. span and degree) are passed to loess.smooth.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sdtab and vpcdir can either be file name of the sdtab file and the folder name of the psn generated VPC,
or can be data.frames of sdtab and simulation data loaded outside vpcfig3, see example below for the latter case.
</p>
<p>Loading the sdtab and matrix file outside vpcfig2 is convenient when dosing multipe VPC plots or for VPC
using new strata ( or idv) variables not included in the sdtab file, see example.
</p>
<p>If vpcdir is given as a folder names, then a matrix.csv file is loaed from the /m1 subfolder of vpcdir.
</p>
<p>The raw simulated results from the matrix file is loaded to compute mean of data with confidence intervals
For numerical idv variables loess-smooth or linear spline is used on observed actual data and on simulated data.
For categorical idv mean is computed for each unique value if idv
</p>
<p>For method=spline, the actual number of knots(bins) is set as min(knots,N/minobs) where N is the number of observations.
</p>


<h3>Value</h3>

<p>A ggplot object if type&gt;0, or if type==0 a list of 3 data.frames, D1=individual data, D3=mean data, D5=mean model with confidence intervals
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Get path to the example files included in nonmem2R package
file1 &lt;- system.file("extdata", "sdtab", package = "nonmem2R")
file2 &lt;- system.file("extdata", "DV_matrix.csv", package = "nonmem2R")

#load sdtab and matrix file
sdtab&lt;-read.table(file=file1,skip=1,header=TRUE)
vpc&lt;-read.table(file=file2,header=FALSE,sep=",")

# VPC stratified by gender
vpcfig3(sdtab,vpc,dv="DV",idvs="TAD",strata="SEX")

# create new strata variable and do VPC
sdtab$age.group&lt;-cut(sdtab$AGE,c(22,30,50))
vpcfig3(sdtab,vpc,dv="DV",idvs="TAD",strata="age.group")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
