<!DOCTYPE html><html lang="en"><head><title>Help for package someMTP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {someMTP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#someMTP-package'><p> Some Multiple Testing Procedures</p></a></li>
<li><a href='#+2AOrNULL-class'><p>Class *OrNULL</p></a></li>
<li><a href='#draw'>
<p>Plots results of fdrOrd()</p></a></li>
<li><a href='#fdrOrd+2FkfweOrd'><p> Controlling the False Discovery Rate and and the Generalized FWER in ordered Test</p></a></li>
<li><a href='#lsd.object+20class'><p>Class &quot;lsd.object&quot; for storing the result of the function lsd</p></a></li>
<li><a href='#lsd.test'>
<p>Multivariate Left Spherically Distributed (LSD) linear scores test.</p></a></li>
<li><a href='#p.adjust.w'>
<p>Adjust P-values for Multiple Comparisons</p></a></li>
<li><a href='#someMTP.object+20class'><p>Class &quot;someMTP.object&quot; for storing the result of the function fdrOrd</p></a></li>
<li><a href='#step.adj'>
<p>Multipicity correction for Stepwise Selected models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Some Multiple Testing Procedures</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2013-11-04</td>
</tr>
<tr>
<td>Author:</td>
<td>livio finos</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>livio finos &lt;livio@stat.unipd.it&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>methods</td>
</tr>
<tr>
<td>Description:</td>
<td>It's a collection of functions for Multiplicity Correction and Multiple Testing.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-03-01 06:56:08 UTC; hornik</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-03-01 07:10:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='someMTP-package'> Some Multiple Testing Procedures
</h2><span id='topic+someMTP-package'></span><span id='topic+someMTP'></span>

<h3>Description</h3>

<p>It is a collection of functions for Multiplicty Correction and Multiple Testing.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> someMTP</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2011-01-10</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2) </td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>livio finos
</p>
<p>Maintainer: &lt;livio@stat.unipd.it&gt;
</p>


<h3>References</h3>

<p>For weighted methods:
</p>
<p>Benjamini, Hochberg (1997). Multiple hypotheses testing with weights. Scand. J. Statist. 24, 407-418.
</p>
<p>Finos,  Salmaso (2007). FDR- and FWE-controlling methods using data-driven weights. Journal of Statistical Planning and Inference, 137,12, 3859-3870.
</p>
<p>For LSD test:
</p>
<p>J. Lauter, E. Glimm and S. Kropf (1998). Multivariate test based on Left-Spherically Distributed Linear Scores. 
The Annals of Statistics, Vol. 26, No. 5, 1972-1988
</p>
<p>L. Finos (2011). A note on Left-Spherically Distributed Test with
covariates, Statistics and Probabilty Letters, Volume 81, Issue 6, June 2011, Pages 639-641 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(13)
y &lt;- matrix(rnorm(5000),5,1000) #create toy data
y[,1:100] &lt;- y[,1:100]+3 #create toy data

p &lt;- apply(y,2,function(y) t.test(y)$p.value) #compute p-values
M2 &lt;- apply(y^2,2,mean) #compute ordering criterion

fdr   &lt;- p.adjust(p,method="BH") #(unweighted) procedure, fdr control
 sum(fdr&lt;.05)
fdr.w &lt;- p.adjust.w(p,method="BH",w=M2) #weighted procedure, weighted fdr control
 sum(fdr.w&lt;.05)
 
fwer   &lt;- p.adjust(p,method="holm") #(unweighted) procedure, fwer control
 sum(fwer&lt;.05)
fwer.w &lt;- p.adjust.w(p,method="BHfwe",w=M2) #weighted procedure, weighted fwer (=fwer) control
sum(fwer.w&lt;.05)

plot(M2,-log10(p))
</code></pre>

<hr>
<h2 id='+2AOrNULL-class'>Class *OrNULL</h2><span id='topic+numericOrNULL-class'></span><span id='topic+vectorOrNULL-class'></span><span id='topic+matrixOrNULL-class'></span><span id='topic+characterOrNULL-class'></span><span id='topic+listOrNULL-class'></span><span id='topic+callOrNULL-class'></span>

<h3>Description</h3>

<p>class * or Null
</p>


<h3>Objects from the Class</h3>

<p>A virtual Class: No objects may be created from it.</p>


<h3>Methods</h3>

<p>No methods defined with class &quot;*OrNULL&quot; in the signature.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("callOrNULL")
</code></pre>

<hr>
<h2 id='draw'>
Plots results of fdrOrd()
</h2><span id='topic+draw'></span>

<h3>Description</h3>

<p>Plots results of fdrOrd()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw(object, what = c("all", "ordVsP", "stepVsR"), pdfName = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw_+3A_object">object</code></td>
<td>
<p> a <code>someMTP.object</code> resulting from fdrOrd()
</p>
</td></tr>
<tr><td><code id="draw_+3A_what">what</code></td>
<td>

<p>what to plot; <code>"all"</code> is the default
</p>
</td></tr>
<tr><td><code id="draw_+3A_pdfname">pdfName</code></td>
<td>
<p> it is the pdf filename where the plot will be saved. If <code>pdfNane</code> is null (the default) the plot will show as window.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value is returned
</p>


<h3>Author(s)</h3>

<p>Livio Finos
</p>


<h3>See Also</h3>

<p>See Also <code><a href="#topic+fdrOrd">fdrOrd</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(17)
	x=matrix(rnorm(60),3,20)
	x[,1:10]=x[,1:10]+2 ##variables 1:10 have tests under H1
	ts=apply(x,2,function(x) t.test(x)$statistic)
	ps=apply(x,2,function(x) t.test(x)$p.value)
	m2=apply(x^2,2,mean)
	pOrd &lt;- fdrOrd(ps,q=.05,ord=m2)	
	draw(pOrd)
</code></pre>

<hr>
<h2 id='fdrOrd+2FkfweOrd'> Controlling the False Discovery Rate and and the Generalized FWER in ordered Test</h2><span id='topic+fdrOrd'></span><span id='topic+kfweOrd'></span>

<h3>Description</h3>

<p>Ordinal procedure controlling the FDR and the Generalized FWER
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fdrOrd(p, q = .01, ord = NULL, GD=FALSE)
kfweOrd(p, k = 1, alpha = 0.01, ord = NULL, alpha.prime = alpha,
        J = qnbinom(alpha, k, alpha.prime), GD = FALSE)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fdrOrd+2B2FkfweOrd_+3A_p">p</code></td>
<td>
<p> vector of p-values
</p>
</td></tr>
<tr><td><code id="fdrOrd+2B2FkfweOrd_+3A_ord">ord</code></td>
<td>
<p> Values on the basis of which the procedure select the hypotheses (following decreasing order). The vector have the same length of <code>p</code>. If <code>NULL</code> the natural ordering is considered.
</p>
</td></tr>
<tr><td><code id="fdrOrd+2B2FkfweOrd_+3A_q">q</code></td>
<td>
<p> average FDR level
</p>
</td></tr>
<tr><td><code id="fdrOrd+2B2FkfweOrd_+3A_alpha">alpha</code></td>
<td>
<p> global significance level
</p>
</td></tr>
<tr><td><code id="fdrOrd+2B2FkfweOrd_+3A_k">k</code></td>
<td>
<p> number of allowed errors in kFWE controls
</p>
</td></tr>
<tr><td><code id="fdrOrd+2B2FkfweOrd_+3A_j">J</code></td>
<td>
<p> number of allowed jumps befor stopping
</p>
</td></tr>
<tr><td><code id="fdrOrd+2B2FkfweOrd_+3A_alpha.prime">alpha.prime</code></td>
<td>
<p> univariate alpha for single step Guo and Romano procedure
</p>
</td></tr>
<tr><td><code id="fdrOrd+2B2FkfweOrd_+3A_gd">GD</code></td>
<td>
<p> Logic value. Should the correction for general dependence be applied?
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns an object of class <code>someMTP.object</code>.
</p>
<table role = "presentation">
<tr><td><code>rej:</code></td>
<td>
<p>a logical vector indicating whenever the related hypotesis have been rejected. </p>
</td></tr>
<tr><td><code>p:</code></td>
<td>
<p>the vector of p-values used in the call</p>
</td></tr>
<tr><td><code>ord:</code></td>
<td>
<p>The vector used to sort the p-values (decrasing).</p>
</td></tr>
<tr><td><code>MTP:</code></td>
<td>
<p>&quot;fdrOrd&quot; or &quot;kfweOrd&quot;</p>
</td></tr>
<tr><td><code>GD:</code></td>
<td>
<p>A logical value incating if the correction for General Dependence have been used or not.</p>
</td></tr>
<tr><td><code>q:</code></td>
<td>
<p>The level of controlled FDR.</p>
</td></tr>
<tr><td><code>alpha:</code></td>
<td>
<p>The level of controlled k-FWER</p>
</td></tr>
<tr><td><code>alphaprime:</code></td>
<td>
<p>The significance level of individual tests</p>
</td></tr>
<tr><td><code>k:</code></td>
<td>
<p>Number of allowed Errors</p>
</td></tr>
<tr><td><code>J:</code></td>
<td>
<p>Number of allowed Jumps</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> L. Finos and A. Farcomeni
</p>


<h3>References</h3>

<p>L. Finos, A. Farcomeni (2011). k-FWER Control without p-value Adjustment, with Application to Detection of Genetic Determinants of Multiple Sclerosis in Italian Twins. Biometrics.
</p>
<p>A. Farcomeni, L. Finos (2013). FDR Control with Pseudo-Gatekeeping Based on a Possibly Data Driven Order of the Hypotheses. Biometrics.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+draw">draw</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

	set.seed(17)
	x=matrix(rnorm(60),3,20)
	x[,1:10]=x[,1:10]+2 ##variables 1:10 have tests under H1
	ts=apply(x,2,function(x) t.test(x)$statistic)
	ps=apply(x,2,function(x) t.test(x)$p.value) #compute p-values
	m2=apply(x^2,2,mean)           #compute ordering criterion

	pOrd &lt;- fdrOrd(ps,q=.05,ord=m2)   #ordinal Procedure
	pOrd
	draw(pOrd)	
	sum(p.adjust(ps,method="BH")&lt;=.05)  #rejections with BH
	
	kOrd &lt;- kfweOrd(ps,k=5,ord=m2)#ordinal procedure
	kOrd
	kOrdGD &lt;- kfweOrd(ps,k=5,ord=m2,GD=TRUE)#ord. proc. (any dependence)
	kOrdGD
</code></pre>

<hr>
<h2 id='lsd.object+20class'>Class &quot;lsd.object&quot; for storing the result of the function lsd</h2><span id='topic+lsd.object'></span><span id='topic+lsd.object-class'></span><span id='topic+show+2Clsd.object-method'></span><span id='topic+p.value+2Clsd.object-method'></span><span id='topic+summary+2Clsd.object-method'></span><span id='topic+weights+2Clsd.object-method'></span><span id='topic+summary'></span><span id='topic+p.value'></span><span id='topic+weights'></span>

<h3>Description</h3>

<p>The class lsd.object is the output of a call to <code><a href="#topic+lsd.test">lsd.test</a></code></p>


<h3>Slots</h3>


<dl>
<dt><code>F </code>:</dt><dd><p>the test statistic</p>
</dd>
<dt><code>df </code>:</dt><dd><p>the degrees of freedom of F</p>
</dd>
<dt><code>globalP</code>:</dt><dd><p>the associated p-value</p>
</dd>
<dt><code>D</code>:</dt><dd><p>the matrix used in the test (it provides the influence of columns in <code>resp</code> to the test statistic)</p>
</dd>     
<dt><code>call</code>:</dt><dd><p>The matched call to <code><a href="#topic+lsd">lsd</a></code>.</p>
</dd>
<dt><code>MTP</code>:</dt><dd><p>The procedure used (&quot;fdrOrd&quot;, &quot;kfweOrd&quot; or others).</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>p.value</dt><dd><p>(lsd.object): Extracts the p-values.</p>
</dd>
<dt>show</dt><dd><p>lsd.object: Prints the test results: p-value, test statistic, expected value of the test statistic under the null hypothesis, standard deviation of the test statistic under the null hypothesis, and number of covariates tested.</p>
</dd>
<dt>summary</dt><dd><p>lsd.object: Prints the test results: p-value, test statistic, expected value of the test statistic under the null hypothesis, standard deviation of the test statistic under the null hypothesis, and number of covariates tested. </p>
</dd>
<dt>weights</dt><dd><p>lsd.object:  diagonal of matrix D used in the test (i.e. the influence of columns in <code>resp</code> to the test statistic)</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Livio Finos: <a href="mailto:livio@stat.unipd.it">livio@stat.unipd.it</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+lsd">lsd</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>    # Simple examples with random data here
    set.seed(1)
	#Standard multivariate LSD test for one sample case
	X=matrix(rnorm(50),5,10)+5
	res &lt;- lsd.test(resp=X,alternative=~1)
	print(res)
	p.value(res)
    summary(res,showD=TRUE)
</code></pre>

<hr>
<h2 id='lsd.test'> 
Multivariate Left Spherically Distributed (LSD) linear scores test.
</h2><span id='topic+lsd.test'></span><span id='topic+lsd'></span>

<h3>Description</h3>

<p>It performs the multivariate Left Spherically Distributed linear scores test of L\&quot;auter et al. (The Annals of Statistics, 1998) (see also details below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lsd.test(resp, alternative = 1, null = NULL, D = NULL, data=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lsd.test_+3A_resp">resp</code></td>
<td>
<p>The response vector of the regression model. May be
supplied as a vector or as a <code><a href="stats.html#topic+formula">formula</a></code>
object. In the latter case, the right hand side of <code>Y</code>
is passed on to <code>alternative</code> if that argument is missing, or
otherwise to <code>null</code>.</p>
</td></tr>
<tr><td><code id="lsd.test_+3A_alternative">alternative</code></td>
<td>
<p>The part of the design matrix corresponding to
the alternative hypothesis. The covariates of the null model do
not have to be supplied again here. May be given as a half
<code><a href="stats.html#topic+formula">formula</a></code> object (e.g. <code>~a+b</code>). In
that case the intercept is always suppressed.</p>
</td></tr>
<tr><td><code id="lsd.test_+3A_null">null</code></td>
<td>
<p>The part of the design matrix corresponding to the null hypothesis. May be given as a design matrix or as a half <code><a href="stats.html#topic+formula">formula</a></code> object (e.g. <code>~a+b</code>). The default for <code>Z</code> is <code>~1</code>, i.e. only an intercept. This intercept may be suppressed, if desired, with <code>Z = ~0</code>.</p>
</td></tr>
<tr><td><code id="lsd.test_+3A_data">data</code></td>
<td>
<p>Only used when <code>Y</code>, <code>X</code>, or <code>Z</code> is given in formula form. An optional data frame, list or environment containing the variables used in the formulae. If the variables in a formula are not found in <code>data</code>, the variables are taken from environment(formula), typically the environment from which <code>gt</code> is called.</p>
</td></tr>
<tr><td><code id="lsd.test_+3A_d">D</code></td>
<td>

<p>is q x p matrix or it is a function with arguments <code>resp</code> and <code>null</code>
returning the q x p transformation matrix.
When <code>D = NULL</code>, then  <code>D =  diag(t(resp)%*%IP0%*%resp)</code> with <code>IP0 = diag(n) - null%*%solve(t(null)%*%null)%*%t(null)</code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns an object of class <code>lsd.object</code>.
</p>
<table role = "presentation">
<tr><td><code>F</code></td>
<td>
<p>the test statistic</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the degrees of freedom of F</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>the associated p-value</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>the matrix used in the test (it provide information on the influence of columns in <code>resp</code> to the test)</p>
</td></tr>
<tr><td><code>call:</code></td>
<td>
<p>The matched call to <code><a href="#topic+lsd.test">lsd.test</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Livio Finos
</p>


<h3>References</h3>

<p>J. Laeuter, E. Glimm and S. Kropf (1998) Multivariate test based on Left-Spherically Distributed Linear Scores. 
The Annals of Statistics, Vol. 26, No. 5, 1972-1988
</p>
<p>L. Finos (2011). A note on Left-Spherically Distributed Test with
covariates, Statistics and Probabilty Letters, Volume 81, Issue 6, June 2011, Pages 639-641 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
#Standard multivariate LSD test for one sample case
X=matrix(rnorm(50),5,10)+2
lsd.test(resp=X,alternative=~1)

#Standard multivariate LSD test for two sample case
X2=X+matrix(c(0,0,1,1,1),5,10)*10
lsd.test(resp=X2,null=~1,alternative=c(0,0,1,1,1))

#General multivariate LSD test for linear predictor with covariates
lsd.test(resp=X2,null=cbind(rep(1,5),c(0,0,1,1,1)),alternative=1:5)

</code></pre>

<hr>
<h2 id='p.adjust.w'>
Adjust P-values for Multiple Comparisons
</h2><span id='topic+p.adjust.w'></span>

<h3>Description</h3>

<p>Given a set of p-values, returns p-values adjusted using one of several (weighted) methods.
It extends the method of <code>p.adjust{stats}</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.adjust.w(p, method = c("bonferroni","holm","BHfwe","BH","BY"), n = length(p),w=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.adjust.w_+3A_p">p</code></td>
<td>

<p>vector of p-values (possibly with NAs)
</p>
</td></tr>
<tr><td><code id="p.adjust.w_+3A_method">method</code></td>
<td>

<p>correction method
</p>
</td></tr>
<tr><td><code id="p.adjust.w_+3A_n">n</code></td>
<td>

<p>number of comparisons, must be at least length(p); only set this (to non-default) when you know what you are doing!
</p>
</td></tr>
<tr><td><code id="p.adjust.w_+3A_w">w</code></td>
<td>

<p>weigths to be used. <code>p.adjust.w(..., rep(1,length(p)))</code> produces the same results as in <code>p.adjust(...)</code> (i.e. the unweighted counterpart).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of corrected p-values (same length as p) having two attributes: <code>attributes(...)$w</code> is the vecotr of used weights and <code>attributes(...)$method</code> is the method used.
</p>


<h3>Author(s)</h3>

<p>Livio Finos
</p>


<h3>References</h3>

<p>Benjamini, Hochberg (1997). Multiple hypotheses testing with weights. Scand. J. Statist. 24, 407-418.
</p>
<p>Finos,  Salmaso (2007). FDR- and FWE-controlling methods using data-driven weights. Journal of Statistical Planning and Inference, 137,12, 3859-3870.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+p.adjust">p.adjust</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(13)
y &lt;- matrix(rnorm(5000),5,1000) #create toy data
y[,1:100] &lt;- y[,1:100]+3 #create toy data

p &lt;- apply(y,2,function(y) t.test(y)$p.value) #compute p-values
M2 &lt;- apply(y^2,2,mean) #compute ordering criterion

fdr   &lt;- p.adjust(p,method="BH") #(unweighted) procedure, fdr control
 sum(fdr&lt;.05)
fdr.w &lt;- p.adjust.w(p,method="BH",w=M2) #weighted procedure, weighted fdr control
 sum(fdr.w&lt;.05)
 
fwer   &lt;- p.adjust(p,method="holm") #(unweighted) procedure, fwer control
 sum(fwer&lt;.05)
fwer.w &lt;- p.adjust.w(p,method="BHfwe",w=M2) #weighted procedure, weighted fwer (=fwer) control
 sum(fwer.w&lt;.05)

plot(M2,-log10(p))
</code></pre>

<hr>
<h2 id='someMTP.object+20class'>Class &quot;someMTP.object&quot; for storing the result of the function fdrOrd</h2><span id='topic+someMTP.object'></span><span id='topic+length-method'></span><span id='topic+length'></span><span id='topic+summary-method'></span><span id='topic+someMTP.object-class'></span><span id='topic+show+2CsomeMTP.object-method'></span><span id='topic+summary+2CsomeMTP.object-method'></span><span id='topic+length+2CsomeMTP.object-method'></span><span id='topic+names+2CsomeMTP.object-method'></span><span id='topic+names+3C-+2CsomeMTP.object-method'></span><span id='topic+sort+2CsomeMTP.object-method'></span>

<h3>Description</h3>

<p>The class someMTP.object is the output of a call to
<code><a href="#topic+fdrOrd">fdrOrd</a></code>. It also stores the information needed for related plots. </p>


<h3>Slots</h3>


<dl>
<dt><code>rej</code>:</dt><dd><p>a logical vector indicating whenever the related hypotesis have been rejected. </p>
</dd>
<dt><code>p</code>:</dt><dd><p>The vector of (raw) p-values used in the procedure.</p>
</dd>
<dt><code>ord</code>:</dt><dd><p>The vector used to sort the p-values (decreasing).</p>
</dd>
<dt><code>idOrd</code>:</dt><dd><p>The vector of indices used in sorting.</p>
</dd>
<dt><code>MTP</code>:</dt><dd><p>The type of procedure used.</p>
</dd>
<dt><code>GD</code>:</dt><dd><p>A logical value incating if the correction for General Dependence have been used or not.</p>
</dd>
<dt><code>q</code>:</dt><dd><p>The level of contrelled FDR when MTP==&quot;fdrOrd&quot;.</p>
</dd>
<dt><code>k</code>:</dt><dd><p>The number of false rejection when MTP==&quot;kfweOrd&quot;</p>
</dd>
<dt><code>J</code>:</dt><dd><p>The number of allowed Jumps when MTP==&quot;kfweOrd&quot;</p>
</dd>
<dt><code>alpha</code>:</dt><dd><p>The significance level when MTP==&quot;kfweOrd&quot;</p>
</dd>
<dt><code>alphaprime</code>:</dt><dd><p>The significance level of individual tests.</p>
</dd>
<dt><code>call</code>:</dt><dd><p>The cal that generates the object.</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>show</dt><dd><p>someMTP.object: Prints the test results.</p>
</dd>
<dt>summary</dt><dd><p>someMTP.object: Prints the test results (as <code>show</code>).</p>
</dd>
<dt>draw</dt><dd><p>someMTP.object: Plots results; <code>what = c("all","ordVsP", "stepVsR")</code>  </p>
</dd>
<dt>sort</dt><dd><p><code>signature(x = "someMTP.object")</code>: Sorts the p-values to decreasing order of <code>ord</code>.</p>
</dd>
<dt>length</dt><dd><p><code>signature(x = "someMTP.object")</code>: The number of tests performed.</p>
</dd>
<dt>names</dt><dd><p><code>signature(x = "someMTP.object")</code>:  Extracts the row names of the results matrix.</p>
</dd>
<dt>names&lt;-</dt><dd><p><code>signature(x = "someMTP.object")</code>: Changes the row names of the results matrix. Duplicate names are not allowed, but see <code>alias</code>.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Livio Finos: <a href="mailto:livio@stat.unipd.it">livio@stat.unipd.it</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+someMTP.object">someMTP.object</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>    # Simple examples with random data
    set.seed(17)
	x=matrix(rnorm(60),3,20)
	x[,1:10]=x[,1:10]+2 ##variables 1:10 have tests under H1
	ts=apply(x,2,function(x) t.test(x)$statistic)
	ps=apply(x,2,function(x) t.test(x)$p.value)
	m2=apply(x^2,2,mean)
	pOrd &lt;- fdrOrd(ps,q=.05,ord=m2)
	pOrd
    length(pOrd)
	names(pOrd) &lt;- paste("V",1:20,sep="")
	names(pOrd)
	
</code></pre>

<hr>
<h2 id='step.adj'>
Multipicity correction for Stepwise Selected models
</h2><span id='topic+step.adj'></span>

<h3>Description</h3>

<p>Corrects the p-value due to model selection. It works with models of class <code>glm</code> and selected with function <code>step {stats\)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>step.adj(object, MC = 1000, scope = NULL, scale = 0, 
         direction = c("both", "backward", "forward"), 
         trace = 0, keep = NULL, steps = 1000, k = 2) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="step.adj_+3A_object">object</code></td>
<td>
<p>object of class <code>glm</code>. Note that
<code>formula</code> have to write by variables name like <code>y~var1+var2+var3</code>,
<code>data</code> is a data.frame (see example below),
<code>offset</code> is not yet implemented, avoid its use,
<code>glm(formula, data, family=gaussian)</code> produce the same result of lm(formula, data), then linear model can be allways performed
</p>
</td></tr>
<tr><td><code id="step.adj_+3A_mc">MC</code></td>
<td>

<p>number of random permutations for the dependent variable
</p>
</td></tr>
<tr><td><code id="step.adj_+3A_scope">scope</code></td>
<td>
<p>as in function <code>step</code></p>
</td></tr>
<tr><td><code id="step.adj_+3A_scale">scale</code></td>
<td>
<p>as in function <code>step</code></p>
</td></tr>
<tr><td><code id="step.adj_+3A_direction">direction</code></td>
<td>
<p>as in function <code>step</code></p>
</td></tr>
<tr><td><code id="step.adj_+3A_trace">trace</code></td>
<td>
<p>as in function <code>step</code></p>
</td></tr>
<tr><td><code id="step.adj_+3A_keep">keep</code></td>
<td>
<p>as in function <code>step</code></p>
</td></tr>
<tr><td><code id="step.adj_+3A_steps">steps</code></td>
<td>
<p>as in function <code>step</code></p>
</td></tr>
<tr><td><code id="step.adj_+3A_k">k</code></td>
<td>
<p>as in function <code>step</code>, other arguments are not implemented yet.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It performs anova function (stats library) on the model selected by function step vs the null model with the only intercept 
and it corrects for multiplicity.
For <code>lm</code> models and gaussian <code>glm</code> models it computes a F-test, form other models it uses Chisquare-test (see also <code>anova.glm</code> and <code>anova.lm</code> help).
</p>


<h3>Value</h3>

<p>An <code>anova</code> table with an extra column reporting the corrected p-value
</p>


<h3>Author(s)</h3>

<p>Livio Finos and Chiara Brombin
</p>


<h3>References</h3>

<p>L. Finos, C. Brombin, L. Salmaso (2010). Adjusting stepwise p-values in generalized linear models. Communications in Statistics - Theory and Methods. 
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="stats.html#topic+anova">anova</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(17)
y=rnorm(10)
x=matrix(rnorm(50),10,5)
#define a data.frame to be used in the glm function
DATA=data.frame(y,x)
#fit the model on a toy dataset
mod=glm(y~X1+X2+X3+X4+X5,data=DATA)

#select the model using function step
mod.step=step(mod, trace=0)
#test the selected model vs the null model
anova(glm(y~1, data=DATA),mod.step,test="F")

#step.adj do the same, but it also provides multiplicity control
step.adj(mod,MC=101, trace=0)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
