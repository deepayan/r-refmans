<!DOCTYPE html><html><head><title>Help for package MomTrunc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MomTrunc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cdfFMD'>
<p>Cumulative distribution function for folded multivariate distributions</p></a></li>
<li><a href='#dprmvESN'><p>Multivariate Extended-Skew Normal Density, Probablilities and Random Deviates Generator</p></a></li>
<li><a href='#dprmvEST'><p>Multivariate Extended-Skew t Density, Probablilities and Random Deviates Generator</p></a></li>
<li><a href='#dprmvSN'><p>Multivariate Skew Normal Density and Probabilities and Random Deviates</p></a></li>
<li><a href='#dprmvST'><p>Multivariate Skew t Density, Probablilities and Random Deviates Generator</p></a></li>
<li><a href='#MCmeanvarTMD'>
<p>Monte Carlo Mean and variance for doubly truncated multivariate distributions</p></a></li>
<li><a href='#meanvarFMD'>
<p>Mean and variance for folded multivariate distributions</p></a></li>
<li><a href='#meanvarTMD'>
<p>Mean and variance for doubly truncated multivariate distributions</p></a></li>
<li><a href='#momentsFMD'>
<p>Moments for folded multivariate distributions</p></a></li>
<li><a href='#momentsTMD'>
<p>Moments for doubly truncated multivariate distributions</p></a></li>
<li><a href='#MomTrunc-package'>
<p>Moments of Folded and Doubly Truncated Multivariate Distributions</p></a></li>
<li><a href='#onlymeanTMD'>
<p>Mean for doubly truncated multivariate distributions</p></a></li>
<li><a href='#pmvnormt'><p>Multivariate normal and Student-t probabilities</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Moments of Folded and Doubly Truncated Multivariate
Distributions</td>
</tr>
<tr>
<td>Version:</td>
<td>6.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-15</td>
</tr>
<tr>
<td>Author:</td>
<td>Christian E. Galarza
    <a href="https://orcid.org/0000-0002-4818-6006"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre,
    trl],
  Raymond Kan <a href="https://orcid.org/0000-0002-0578-9974"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Victor H. Lachos <a href="https://orcid.org/0000-0002-7239-2459"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, ths]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Christian E. Galarza &lt;cgalarza88@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>It computes arbitrary products moments (mean vector and variance-covariance matrix), for some double truncated (and folded) multivariate distributions. These distributions belong to the family of selection elliptical distributions, which includes well known skewed distributions as the unified skew-t distribution (SUT) and its particular cases as the extended skew-t (EST), skew-t (ST) and the symmetric student-t (T) distribution. Analogous normal cases unified skew-normal (SUN), extended skew-normal (ESN), skew-normal (SN), and symmetric normal (N) are also included. Density, probabilities and random deviates are also offered for these members.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.1), mvtnorm (&ge; 1.0.11), tlrmvnmvt (&ge; 1.1.0),
hypergeo</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp (&ge; 1.0.1), RcppArmadillo, mvtnorm</td>
</tr>
<tr>
<td>Suggests:</td>
<td>tmvtnorm</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-15 18:51:55 UTC; cgala</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-15 23:10:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='cdfFMD'>
Cumulative distribution function for folded multivariate distributions
</h2><span id='topic+cdfFMD'></span>

<h3>Description</h3>

<p>It computes the cumulative distribution function on <code>x</code> for a folded <code>p</code>-variate Normal, Skew-normal (SN), Extended Skew-normal (ESN) and Student's t-distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdfFMD(x,mu,Sigma,lambda = NULL,tau = NULL,dist,nu = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdfFMD_+3A_x">x</code></td>
<td>

<p>vector of length <code class="reqn">p</code> where the cdf is evaluated.
</p>
</td></tr>
<tr><td><code id="cdfFMD_+3A_mu">mu</code></td>
<td>

<p>a numeric vector of length <code class="reqn">p</code> representing the location parameter.
</p>
</td></tr>
<tr><td><code id="cdfFMD_+3A_sigma">Sigma</code></td>
<td>

<p>a numeric positive definite matrix with dimension <code class="reqn">p</code>x<code class="reqn">p</code> representing the scale parameter.
</p>
</td></tr>
<tr><td><code id="cdfFMD_+3A_lambda">lambda</code></td>
<td>

<p>a numeric vector of length <code class="reqn">p</code> representing the skewness parameter for SN and ESN cases. If <code>lambda == 0</code>, the ESN/SN reduces to a normal (symmetric) distribution.
</p>
</td></tr>
<tr><td><code id="cdfFMD_+3A_tau">tau</code></td>
<td>

<p>It represents the extension parameter for the ESN distribution. If <code>tau == 0</code>, the ESN reduces to a SN distribution.
</p>
</td></tr>
<tr><td><code id="cdfFMD_+3A_dist">dist</code></td>
<td>

<p>represents the folded distribution to be computed. The values are <code>normal</code>, <code>SN</code> , <code>ESN</code> and <code>t</code>  for the doubly truncated Normal, Skew-normal, Extended Skew-normal and Student's t-distribution respectively.
</p>
</td></tr>
<tr><td><code id="cdfFMD_+3A_nu">nu</code></td>
<td>

<p>It represents the degrees of freedom for the Student's t-distribution.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Normal case by default, i.e., when <code>dist</code> is not provided. Univariate case is also considered, where <code>Sigma</code> will be the variance <code class="reqn">\sigma^2</code>.
</p>


<h3>Value</h3>

<p>It returns the distribution value for a single point <code>x</code>.
</p>


<h3>Note</h3>

<p>Degrees of freedom must be a positive integer. If <code>nu &gt;= 200</code>, Normal case is considered.&quot;
</p>


<h3>Author(s)</h3>

<p>Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt; and
Victor H. Lachos &lt;<a href="mailto:hlachos@uconn.edu">hlachos@uconn.edu</a>&gt;
</p>
<p>Maintainer: Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Galarza, C. E., Lin, T. I., Wang, W. L., &amp; Lachos, V. H. (2021). On moments of folded and truncated multivariate Student-t distributions based on recurrence relations. Metrika, 84(6), 825-850 &lt;doi:10.1007/s00184-020-00802-1&gt;.
</p>
<p>Galarza, C. E., Matos, L. A., Dey, D. K., &amp; Lachos, V. H. (2022a). &quot;On moments of folded and doubly truncated multivariate extended skew-normal distributions.&quot; Journal of Computational and Graphical Statistics, 1-11 &lt;doi:10.1080/10618600.2021.2000869&gt;.
</p>
<p>Galarza, C. E., Matos, L. A., Castro, L. M., &amp; Lachos, V. H. (2022b). Moments of the doubly truncated selection elliptical distributions with emphasis on the unified multivariate skew-t distribution. Journal of Multivariate Analysis, 189, 104944 &lt;doi:10.1016/j.jmva.2021.104944&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+momentsFMD">momentsFMD</a></code>, <code><a href="#topic+meanvarFMD">meanvarFMD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mu = c(0.1,0.2,0.3,0.4)
Sigma = matrix(data = c(1,0.2,0.3,0.1,0.2,1,0.4,-0.1,0.3,0.4,1,0.2,0.1,-0.1,0.2,1),
               nrow = length(mu),ncol = length(mu),byrow = TRUE)
cdfFMD(x = c(0.5,0.2,1.0,1.3),mu,Sigma,dist="normal")
cdfFMD(x = c(0.5,0.2,1.0,1.3),mu,Sigma,dist = "t",nu = 4)
cdfFMD(x = c(0.5,0.2,1.0,1.3),mu,Sigma,lambda = c(-2,0,2,1),dist = "SN")
cdfFMD(x = c(0.5,0.2,1.0,1.3),mu,Sigma,lambda = c(-2,0,2,1),tau = 1,dist = "ESN")
</code></pre>

<hr>
<h2 id='dprmvESN'>Multivariate Extended-Skew Normal Density, Probablilities and Random Deviates Generator</h2><span id='topic+dmvESN'></span><span id='topic+pmvESN'></span><span id='topic+rmvESN'></span>

<h3>Description</h3>

<p>These functions provide the density function, probabilities and a random number
generator for the multivariate extended-skew normal (ESN) distribution with mean vector <code>mu</code>, scale matrix <code>Sigma</code>, skewness parameter <code>lambda</code> and extension parameter <code>tau</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmvESN(x,mu=rep(0,length(lambda)),Sigma=diag(length(lambda)),lambda,tau=0)
pmvESN(lower = rep(-Inf,length(lambda)),upper=rep(Inf,length(lambda)),
        mu = rep(0,length(lambda)),Sigma,lambda,tau,log2 = FALSE)
rmvESN(n,mu=rep(0,length(lambda)),Sigma=diag(length(lambda)),lambda,tau=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dprmvESN_+3A_x">x</code></td>
<td>
<p>vector or matrix of quantiles. If <code>x</code> is a matrix, each
row is taken to be a quantile.</p>
</td></tr>
<tr><td><code id="dprmvESN_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code id="dprmvESN_+3A_lower">lower</code></td>
<td>

<p>the vector of lower limits of length <code class="reqn">p</code>.
</p>
</td></tr>
<tr><td><code id="dprmvESN_+3A_upper">upper</code></td>
<td>

<p>the vector of upper limits of length <code class="reqn">p</code>.
</p>
</td></tr>
<tr><td><code id="dprmvESN_+3A_mu">mu</code></td>
<td>

<p>a numeric vector of length <code class="reqn">p</code> representing the location parameter.
</p>
</td></tr>
<tr><td><code id="dprmvESN_+3A_sigma">Sigma</code></td>
<td>

<p>a numeric positive definite matrix with dimension <code class="reqn">p</code>x<code class="reqn">p</code> representing the scale parameter.
</p>
</td></tr>
<tr><td><code id="dprmvESN_+3A_lambda">lambda</code></td>
<td>

<p>a numeric vector of length <code class="reqn">p</code> representing the skewness parameter for SN and ESN cases. If <code>lambda == 0</code>, the ESN/SN reduces to a normal (symmetric) distribution.
</p>
</td></tr>
<tr><td><code id="dprmvESN_+3A_tau">tau</code></td>
<td>

<p>It represents the extension parameter for the ESN distribution. If <code>tau == 0</code>, the ESN reduces to a SN distribution.
</p>
</td></tr>
<tr><td><code id="dprmvESN_+3A_log2">log2</code></td>
<td>

<p>a boolean variable, indicating if the log2 result should be returned. This is useful when the true probability is too small for the machine precision.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dmvESN</code> gives the density, <code>pmvESN</code> gives the distribution function, and <code>rmvESN</code> generates random deviates for the Multivariate Extended-Skew Normal Distribution.
</p>


<h3>Author(s)</h3>

<p>Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt; and
Victor H. Lachos &lt;<a href="mailto:hlachos@uconn.edu">hlachos@uconn.edu</a>&gt;
</p>
<p>Maintainer: Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Galarza, C. E., Lin, T. I., Wang, W. L., &amp; Lachos, V. H. (2021). On moments of folded and truncated multivariate Student-t distributions based on recurrence relations. Metrika, 84(6), 825-850 &lt;doi:10.1007/s00184-020-00802-1&gt;.
</p>
<p>Galarza, C. E., Matos, L. A., Dey, D. K., &amp; Lachos, V. H. (2022a). &quot;On moments of folded and doubly truncated multivariate extended skew-normal distributions.&quot; Journal of Computational and Graphical Statistics, 1-11 &lt;doi:10.1080/10618600.2021.2000869&gt;.
</p>
<p>Galarza, C. E., Matos, L. A., Castro, L. M., &amp; Lachos, V. H. (2022b). Moments of the doubly truncated selection elliptical distributions with emphasis on the unified multivariate skew-t distribution. Journal of Multivariate Analysis, 189, 104944 &lt;doi:10.1016/j.jmva.2021.104944&gt;.
</p>
<p>Galarza, C.E., Matos, L.A. and Lachos, V.H. (2022c). An EM algorithm for estimating the parameters of the multivariate skew-normal distribution with censored responses. Metron. &lt;doi:10.1007/s40300-021-00227-4&gt;.
</p>
<p>Genz, A.,  (1992) &quot;Numerical computation of multivariate normal probabilities,&quot; Journal of Computational and Graphical Statistics, 1, 141-149 &lt;doi:10.1080/10618600.1992.10477010&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dmvSN">dmvSN</a></code>, <code><a href="#topic+pmvSN">pmvSN</a></code>, <code><a href="#topic+rmvSN">rmvSN</a></code>, <code><a href="#topic+meanvarFMD">meanvarFMD</a></code>,<code><a href="#topic+meanvarTMD">meanvarTMD</a></code>,<code><a href="#topic+momentsTMD">momentsTMD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Univariate case
dmvESN(x = -1,mu = 2,Sigma = 5,lambda = -2,tau = 0.5)
rmvESN(n = 100,mu = 2,Sigma = 5,lambda = -2,tau = 0.5)
#Multivariate case
mu = c(0.1,0.2,0.3,0.4)
Sigma = matrix(data = c(1,0.2,0.3,0.1,0.2,1,0.4,-0.1,0.3,0.4,1,0.2,0.1,-0.1,0.2,1),
               nrow = length(mu),ncol = length(mu),byrow = TRUE)
lambda = c(-2,0,1,2)
tau = 2
#One observation
dmvESN(x = c(-2,-1,0,1),mu,Sigma,lambda,tau)
rmvESN(n = 100,mu,Sigma,lambda,tau)
#Many observations as matrix
x = matrix(rnorm(4*10),ncol = 4,byrow = TRUE)
dmvESN(x = x,mu,Sigma,lambda,tau)

lower = rep(-Inf,4)
upper = c(-1,0,2,5)
pmvESN(lower,upper,mu,Sigma,lambda,tau)
</code></pre>

<hr>
<h2 id='dprmvEST'>Multivariate Extended-Skew t Density, Probablilities and Random Deviates Generator</h2><span id='topic+dmvEST'></span><span id='topic+pmvEST'></span><span id='topic+rmvEST'></span>

<h3>Description</h3>

<p>These functions provide the density function, probabilities and a random number
generator for the multivariate extended-skew t (EST) distribution with mean vector <code>mu</code>, scale matrix <code>Sigma</code>, skewness parameter <code>lambda</code>, extension parameter <code>tau</code> and degrees of freedom <code>nu</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmvEST(x,mu=rep(0,length(lambda)),Sigma=diag(length(lambda)),lambda,tau=0,nu)
pmvEST(lower = rep(-Inf,length(lambda)),upper=rep(Inf,length(lambda)),
        mu = rep(0,length(lambda)),Sigma,lambda,tau,nu,log2 = FALSE)
rmvEST(n,mu=rep(0,length(lambda)),Sigma=diag(length(lambda)),lambda,tau,nu)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dprmvEST_+3A_x">x</code></td>
<td>
<p>vector or matrix of quantiles. If <code>x</code> is a matrix, each
row is taken to be a quantile.</p>
</td></tr>
<tr><td><code id="dprmvEST_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code id="dprmvEST_+3A_lower">lower</code></td>
<td>

<p>the vector of lower limits of length <code class="reqn">p</code>.
</p>
</td></tr>
<tr><td><code id="dprmvEST_+3A_upper">upper</code></td>
<td>

<p>the vector of upper limits of length <code class="reqn">p</code>.
</p>
</td></tr>
<tr><td><code id="dprmvEST_+3A_mu">mu</code></td>
<td>

<p>a numeric vector of length <code class="reqn">p</code> representing the location parameter.
</p>
</td></tr>
<tr><td><code id="dprmvEST_+3A_sigma">Sigma</code></td>
<td>

<p>a numeric positive definite matrix with dimension <code class="reqn">p</code>x<code class="reqn">p</code> representing the scale parameter.
</p>
</td></tr>
<tr><td><code id="dprmvEST_+3A_lambda">lambda</code></td>
<td>

<p>a numeric vector of length <code class="reqn">p</code> representing the skewness parameter for ST and EST cases. If <code>lambda == 0</code>, the EST/ST reduces to a t (symmetric) distribution.
</p>
</td></tr>
<tr><td><code id="dprmvEST_+3A_tau">tau</code></td>
<td>

<p>It represents the extension parameter for the EST distribution. If <code>tau == 0</code>, the EST reduces to a ST distribution.
</p>
</td></tr>
<tr><td><code id="dprmvEST_+3A_nu">nu</code></td>
<td>

<p>It represents the degrees of freedom of the Student's t-distribution.
</p>
</td></tr>
<tr><td><code id="dprmvEST_+3A_log2">log2</code></td>
<td>

<p>a boolean variable, indicating if the log2 result should be returned. This is useful when the true probability is too small for the machine precision.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dmvEST</code> gives the density, <code>pmvEST</code> gives the distribution function, and <code>rmvEST</code> generates random deviates for the Multivariate Extended-Skew-<code class="reqn">t</code> Distribution.
</p>


<h3>Author(s)</h3>

<p>Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt; and
Victor H. Lachos &lt;<a href="mailto:hlachos@uconn.edu">hlachos@uconn.edu</a>&gt;
</p>
<p>Maintainer: Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Galarza, C. E., Lin, T. I., Wang, W. L., &amp; Lachos, V. H. (2021). On moments of folded and truncated multivariate Student-t distributions based on recurrence relations. Metrika, 84(6), 825-850 &lt;doi:10.1007/s00184-020-00802-1&gt;.
</p>
<p>Galarza, C. E., Matos, L. A., Castro, L. M., &amp; Lachos, V. H. (2022b). Moments of the doubly truncated selection elliptical distributions with emphasis on the unified multivariate skew-t distribution. Journal of Multivariate Analysis, 189, 104944 &lt;doi:10.1016/j.jmva.2021.104944&gt;.
</p>
<p>Genz, A.,  (1992) &quot;Numerical computation of multivariate normal probabilities,&quot; Journal of Computational and Graphical Statistics, 1, 141-149 &lt;doi:10.1080/10618600.1992.10477010&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dmvST">dmvST</a></code>, <code><a href="#topic+pmvST">pmvST</a></code>, <code><a href="#topic+rmvST">rmvST</a></code>, <code><a href="#topic+meanvarFMD">meanvarFMD</a></code>,<code><a href="#topic+meanvarTMD">meanvarTMD</a></code>,<code><a href="#topic+momentsTMD">momentsTMD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Univariate case
dmvEST(x = -1,mu = 2,Sigma = 5,lambda = -2,tau = 0.5,nu=4)
rmvEST(n = 100,mu = 2,Sigma = 5,lambda = -2,tau = 0.5,nu=4)
#Multivariate case
mu = c(0.1,0.2,0.3,0.4)
Sigma = matrix(data = c(1,0.2,0.3,0.1,0.2,1,0.4,-0.1,0.3,0.4,1,0.2,0.1,-0.1,0.2,1),
               nrow = length(mu),ncol = length(mu),byrow = TRUE)
lambda = c(-2,0,1,2)
tau = 2
#One observation
dmvEST(x = c(-2,-1,0,1),mu,Sigma,lambda,tau,nu=4)
rmvEST(n = 100,mu,Sigma,lambda,tau,nu=4)
#Many observations as matrix
x = matrix(rnorm(4*10),ncol = 4,byrow = TRUE)
dmvEST(x = x,mu,Sigma,lambda,tau,nu=4)

lower = rep(-Inf,4)
upper = c(-1,0,2,5)
pmvEST(lower,upper,mu,Sigma,lambda,tau,nu=4)
</code></pre>

<hr>
<h2 id='dprmvSN'>Multivariate Skew Normal Density and Probabilities and Random Deviates</h2><span id='topic+dmvSN'></span><span id='topic+pmvSN'></span><span id='topic+rmvSN'></span>

<h3>Description</h3>

<p>These functions provide the density function and a random number
generator for the multivariate skew normal (SN) distribution with mean vector <code>mu</code>, scale matrix <code>Sigma</code> and skewness parameter <code>lambda</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmvSN(x,mu=rep(0,length(lambda)),Sigma=diag(length(lambda)),lambda)
pmvSN(lower = rep(-Inf,length(lambda)),upper=rep(Inf,length(lambda)),
        mu = rep(0,length(lambda)),Sigma,lambda,log2 = FALSE)
rmvSN(n,mu=rep(0,length(lambda)),Sigma=diag(length(lambda)),lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dprmvSN_+3A_x">x</code></td>
<td>
<p>vector or matrix of quantiles. If <code>x</code> is a matrix, each
row is taken to be a quantile.</p>
</td></tr>
<tr><td><code id="dprmvSN_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code id="dprmvSN_+3A_lower">lower</code></td>
<td>

<p>the vector of lower limits of length <code class="reqn">p</code>.
</p>
</td></tr>
<tr><td><code id="dprmvSN_+3A_upper">upper</code></td>
<td>

<p>the vector of upper limits of length <code class="reqn">p</code>.
</p>
</td></tr>
<tr><td><code id="dprmvSN_+3A_mu">mu</code></td>
<td>

<p>a numeric vector of length <code class="reqn">p</code> representing the location parameter.
</p>
</td></tr>
<tr><td><code id="dprmvSN_+3A_sigma">Sigma</code></td>
<td>

<p>a numeric positive definite matrix with dimension <code class="reqn">p</code>x<code class="reqn">p</code> representing the scale parameter.
</p>
</td></tr>
<tr><td><code id="dprmvSN_+3A_lambda">lambda</code></td>
<td>

<p>a numeric vector of length <code class="reqn">p</code> representing the skewness parameter for SN and SN cases. If <code>lambda == 0</code>, the SN/SN reduces to a normal (symmetric) distribution.
</p>
</td></tr>
<tr><td><code id="dprmvSN_+3A_log2">log2</code></td>
<td>

<p>a boolean variable, indicating if the log2 result should be returned. This is useful when the true probability is too small for the machine precision.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dmvSN</code> gives the density, <code>pmvSN</code> gives the distribution function, and <code>rmvSN</code> generates random deviates for the Multivariate Skew-normal Distribution.
</p>


<h3>Author(s)</h3>

<p>Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt; and
Victor H. Lachos &lt;<a href="mailto:hlachos@uconn.edu">hlachos@uconn.edu</a>&gt;
</p>
<p>Maintainer: Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Galarza, C. E., Matos, L. A., Dey, D. K., &amp; Lachos, V. H. (2022a). &quot;On moments of folded and doubly truncated multivariate extended skew-normal distributions.&quot; Journal of Computational and Graphical Statistics, 1-11 &lt;doi:10.1080/10618600.2021.2000869&gt;.
</p>
<p>Galarza, C. E., Matos, L. A., Castro, L. M., &amp; Lachos, V. H. (2022b). Moments of the doubly truncated selection elliptical distributions with emphasis on the unified multivariate skew-t distribution. Journal of Multivariate Analysis, 189, 104944 &lt;doi:10.1016/j.jmva.2021.104944&gt;.
</p>
<p>Galarza, C.E., Matos, L.A. and Lachos, V.H. (2022c). An EM algorithm for estimating the parameters of the multivariate skew-normal distribution with censored responses. Metron. &lt;doi:10.1007/s40300-021-00227-4&gt;.
</p>
<p>Genz, A.,  (1992) &quot;Numerical computation of multivariate normal probabilities,&quot; Journal of Computational and Graphical Statistics, 1, 141-149 &lt;doi:10.1080/10618600.1992.10477010&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dmvESN">dmvESN</a></code>, <code><a href="#topic+pmvESN">pmvESN</a></code>, <code><a href="#topic+rmvESN">rmvESN</a></code>, <code><a href="#topic+meanvarFMD">meanvarFMD</a></code>,<code><a href="#topic+meanvarTMD">meanvarTMD</a></code>,<code><a href="#topic+momentsTMD">momentsTMD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Univariate case
dmvSN(x = -1,mu = 2,Sigma = 5,lambda = -2)
rmvSN(n = 100,mu = 2,Sigma = 5,lambda = -2)
#Multivariate case
mu = c(0.1,0.2,0.3,0.4)
Sigma = matrix(data = c(1,0.2,0.3,0.1,0.2,1,0.4,-0.1,0.3,0.4,1,0.2,0.1,-0.1,0.2,1),
               nrow = length(mu),ncol = length(mu),byrow = TRUE)
lambda = c(-2,0,1,2)
#One observation
dmvSN(x = c(-2,-1,0,1),mu,Sigma,lambda)
rmvSN(n = 100,mu,Sigma,lambda)
#Many observations as matrix
x = matrix(rnorm(4*10),ncol = 4,byrow = TRUE)
dmvSN(x = x,mu,Sigma,lambda)

lower = rep(-Inf,4)
upper = c(-1,0,2,5)
pmvSN(lower,upper,mu,Sigma,lambda)
</code></pre>

<hr>
<h2 id='dprmvST'>Multivariate Skew t Density, Probablilities and Random Deviates Generator</h2><span id='topic+dmvST'></span><span id='topic+pmvST'></span><span id='topic+rmvST'></span>

<h3>Description</h3>

<p>These functions provide the density function, probabilities and a random number
generator for the multivariate skew t (EST) distribution with mean vector <code>mu</code>, scale matrix <code>Sigma</code>, skewness parameter <code>lambda</code> and degrees of freedom <code>nu</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmvST(x,mu=rep(0,length(lambda)),Sigma=diag(length(lambda)),lambda,nu)
pmvST(lower = rep(-Inf,length(lambda)),upper=rep(Inf,length(lambda)),
        mu = rep(0,length(lambda)),Sigma,lambda,nu,log2 = FALSE)
rmvST(n,mu=rep(0,length(lambda)),Sigma=diag(length(lambda)),lambda,nu)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dprmvST_+3A_x">x</code></td>
<td>
<p>vector or matrix of quantiles. If <code>x</code> is a matrix, each
row is taken to be a quantile.</p>
</td></tr>
<tr><td><code id="dprmvST_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code id="dprmvST_+3A_lower">lower</code></td>
<td>

<p>the vector of lower limits of length <code class="reqn">p</code>.
</p>
</td></tr>
<tr><td><code id="dprmvST_+3A_upper">upper</code></td>
<td>

<p>the vector of upper limits of length <code class="reqn">p</code>.
</p>
</td></tr>
<tr><td><code id="dprmvST_+3A_mu">mu</code></td>
<td>

<p>a numeric vector of length <code class="reqn">p</code> representing the location parameter.
</p>
</td></tr>
<tr><td><code id="dprmvST_+3A_sigma">Sigma</code></td>
<td>

<p>a numeric positive definite matrix with dimension <code class="reqn">p</code>x<code class="reqn">p</code> representing the scale parameter.
</p>
</td></tr>
<tr><td><code id="dprmvST_+3A_lambda">lambda</code></td>
<td>

<p>a numeric vector of length <code class="reqn">p</code> representing the skewness parameter for ST and EST cases. If <code>lambda == 0</code>, the EST/ST reduces to a t (symmetric) distribution.
</p>
</td></tr>
<tr><td><code id="dprmvST_+3A_nu">nu</code></td>
<td>

<p>It represents the degrees of freedom of the Student's t-distribution.
</p>
</td></tr>
<tr><td><code id="dprmvST_+3A_log2">log2</code></td>
<td>

<p>a boolean variable, indicating if the log2 result should be returned. This is useful when the true probability is too small for the machine precision.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dmvST</code> gives the density, <code>pmvST</code> gives the distribution function, and <code>rmvST</code> generates random deviates for the Multivariate Skew-<code class="reqn">t</code> Distribution.
</p>


<h3>Author(s)</h3>

<p>Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt; and
Victor H. Lachos &lt;<a href="mailto:hlachos@uconn.edu">hlachos@uconn.edu</a>&gt;
</p>
<p>Maintainer: Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Galarza, C. E., Lin, T. I., Wang, W. L., &amp; Lachos, V. H. (2021). On moments of folded and truncated multivariate Student-t distributions based on recurrence relations. Metrika, 84(6), 825-850 &lt;doi:10.1007/s00184-020-00802-1&gt;.
</p>
<p>Galarza, C. E., Matos, L. A., Dey, D. K., &amp; Lachos, V. H. (2022a). &quot;On moments of folded and doubly truncated multivariate extended skew-normal distributions.&quot; Journal of Computational and Graphical Statistics, 1-11 &lt;doi:10.1080/10618600.2021.2000869&gt;.
</p>
<p>Galarza, C. E., Matos, L. A., Castro, L. M., &amp; Lachos, V. H. (2022b). Moments of the doubly truncated selection elliptical distributions with emphasis on the unified multivariate skew-t distribution. Journal of Multivariate Analysis, 189, 104944 &lt;doi:10.1016/j.jmva.2021.104944&gt;.
</p>
<p>Genz, A.,  (1992) &quot;Numerical computation of multivariate normal probabilities,&quot; Journal of Computational and Graphical Statistics, 1, 141-149 &lt;doi:10.1080/10618600.1992.10477010&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dmvST">dmvST</a></code>, <code><a href="#topic+pmvST">pmvST</a></code>, <code><a href="#topic+rmvST">rmvST</a></code>, <code><a href="#topic+meanvarFMD">meanvarFMD</a></code>,<code><a href="#topic+meanvarTMD">meanvarTMD</a></code>,<code><a href="#topic+momentsTMD">momentsTMD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Univariate case
dmvST(x = -1,mu = 2,Sigma = 5,lambda = -2,nu=4)
rmvST(n = 100,mu = 2,Sigma = 5,lambda = -2,nu=4)
#Multivariate case
mu = c(0.1,0.2,0.3,0.4)
Sigma = matrix(data = c(1,0.2,0.3,0.1,0.2,1,0.4,-0.1,0.3,0.4,1,0.2,0.1,-0.1,0.2,1),
               nrow = length(mu),ncol = length(mu),byrow = TRUE)
lambda = c(-2,0,1,2)
#One observation
dmvST(x = c(-2,-1,0,1),mu,Sigma,lambda,nu=4)
rmvST(n = 100,mu,Sigma,lambda,nu=4)
#Many observations as matrix
x = matrix(rnorm(4*10),ncol = 4,byrow = TRUE)
dmvST(x = x,mu,Sigma,lambda,nu=4)

lower = rep(-Inf,4)
upper = c(-1,0,2,5)
pmvST(lower,upper,mu,Sigma,lambda,nu=4)
</code></pre>

<hr>
<h2 id='MCmeanvarTMD'>
Monte Carlo Mean and variance for doubly truncated multivariate distributions
</h2><span id='topic+MCmeanvarTMD'></span>

<h3>Description</h3>

<p>It computes the Monte Carlo mean vector and variance-covariance matrix for some doubly truncated skew-elliptical distributions. Monte Carlo simulations are performed via slice Sampling.
It supports the <code>p</code>-variate Normal, Skew-normal (SN), Extended Skew-normal (ESN) and Unified Skew-normal (SUN) as well as the Student's-t, Skew-t (ST), Extended Skew-t (EST) and Unified Skew-t (SUT) distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCmeanvarTMD(lower = rep(-Inf,length(mu)),upper = rep(Inf,length(mu)),mu,Sigma
,lambda = NULL,tau = NULL,Gamma = NULL,nu = NULL,dist,n = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCmeanvarTMD_+3A_lower">lower</code></td>
<td>

<p>the vector of lower limits of length <code class="reqn">p</code>.
</p>
</td></tr>
<tr><td><code id="MCmeanvarTMD_+3A_upper">upper</code></td>
<td>

<p>the vector of upper limits of length <code class="reqn">p</code>.
</p>
</td></tr>
<tr><td><code id="MCmeanvarTMD_+3A_mu">mu</code></td>
<td>

<p>a numeric vector of length <code class="reqn">p</code> representing the location parameter.
</p>
</td></tr>
<tr><td><code id="MCmeanvarTMD_+3A_sigma">Sigma</code></td>
<td>

<p>a numeric positive definite matrix with dimension <code class="reqn">p</code>x<code class="reqn">p</code> representing the scale parameter.
</p>
</td></tr>
<tr><td><code id="MCmeanvarTMD_+3A_lambda">lambda</code></td>
<td>

<p>a numeric matrix of dimension <code class="reqn">p</code>x<code class="reqn">q</code> representing the skewness/shape matrix parameter for the SUN and SUT distribution. For the ESN and EST distributions (<code class="reqn">q=1</code>), <code>lambda</code> is a numeric vector of dimension <code class="reqn">p</code> (see examples at the end of this help). If <code>all(lambda == 0)</code>, the SUN/ESN/SN (SUT/EST/ST) reduces to a normal (t) symmetric distribution.
</p>
</td></tr>
<tr><td><code id="MCmeanvarTMD_+3A_tau">tau</code></td>
<td>

<p>a numeric vector of length <code class="reqn">q</code> representing the extension parameter for the SUN and SUT distribution. For the ESN and EST distributions, <code>tau</code> is a positive scalar (<code class="reqn">q=1</code>). Furthermore, if <code>tau == 0</code>, the ESN (EST) reduces to a SN (ST) distribution.
</p>
</td></tr>
<tr><td><code id="MCmeanvarTMD_+3A_gamma">Gamma</code></td>
<td>

<p>a correlation matrix with dimension <code class="reqn">q</code>x<code class="reqn">q</code>. It must be provided only for the SUN and SUT cases. For particular cases SN, ESN, ST and EST, we have that <code>Gamma == 1</code> (see examples at the end of this help).
</p>
</td></tr>
<tr><td><code id="MCmeanvarTMD_+3A_nu">nu</code></td>
<td>

<p>It represents the degrees of freedom for the Student's t-distribution being a positive real number.
</p>
</td></tr>
<tr><td><code id="MCmeanvarTMD_+3A_dist">dist</code></td>
<td>

<p>represents the truncated distribution to be used. The values are <code>normal</code>, <code>SN</code> , <code>ESN</code> and <code>SUN</code> for the doubly truncated Normal, Skew-normal, Extended Skew-normal and Unified-skew normal distributions and,
<code>t</code>, <code>ST</code> , <code>EST</code> and <code>SUT</code> for the for the doubly truncated Student-t, Skew-t, Extended Skew-t and Unified skew-t distributions.
</p>
</td></tr>
<tr><td><code id="MCmeanvarTMD_+3A_n">n</code></td>
<td>

<p>number of Monte Carlo samples to be generated.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns a list with three elements:
</p>
<table>
<tr><td><code>mean</code></td>
<td>
<p>the estimate for the mean vector of length <code class="reqn">p</code></p>
</td></tr>
<tr><td><code>EYY</code></td>
<td>
<p>the estimate for the second moment matrix of dimensions <code class="reqn">p</code>x<code class="reqn">p</code></p>
</td></tr>
<tr><td><code>varcov</code></td>
<td>
<p>the estimate for the variance-covariance matrix of dimensions <code class="reqn">p</code>x<code class="reqn">p</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt; and
Victor H. Lachos &lt;<a href="mailto:hlachos@uconn.edu">hlachos@uconn.edu</a>&gt;
</p>
<p>Maintainer: Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Arellano-Valle, R. B. &amp; Genton, M. G. (2005). On fundamental skew distributions. Journal of Multivariate
Analysis, 96, 93-116.
</p>
<p>Ho, H. J., Lin, T. I., Chen, H. Y., &amp; Wang, W. L. (2012). Some results on the truncated multivariate t distribution. Journal of Statistical Planning and Inference, 142(1), 25-40.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+meanvarTMD">meanvarTMD</a></code>, <code><a href="#topic+rmvSN">rmvSN</a></code>,<code><a href="#topic+rmvESN">rmvESN</a></code>,<code><a href="#topic+rmvST">rmvST</a></code>, <code><a href="#topic+rmvEST">rmvEST</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a = c(-0.8,-0.7,-0.6)
b = c(0.5,0.6,0.7)
mu = c(0.1,0.2,0.3)
Sigma = matrix(data = c(1,0.2,0.3,0.2,1,0.4,0.3,0.4,1),
               nrow = length(mu),ncol = length(mu),byrow = TRUE)


## Normal case

# Theoretical value
value1 = meanvarTMD(a,b,mu,Sigma,dist="normal")

#MC estimate
MC11 = MCmeanvarTMD(a,b,mu,Sigma,dist="normal") #by defalut n = 10000
MC12 = MCmeanvarTMD(a,b,mu,Sigma,dist="normal",n = 10^5) #more precision

## Skew-t case
 
# Theoretical value
value2 = meanvarTMD(a,b,mu,Sigma,lambda = c(-2,0,1),nu = 4,dist = "ST")

#MC estimate
MC21 = MCmeanvarTMD(a,b,mu,Sigma,lambda = c(-2,0,1),nu = 4,dist = "ST")

## More...

MC5 = MCmeanvarTMD(a,b,mu,Sigma,lambda = c(-2,0,1),tau = 1,dist = "ESN")
MC6 = MCmeanvarTMD(a,b,mu,Sigma,lambda = c(-2,0,1),tau = 1,nu = 4,dist = "EST")


#Skew-unified Normal (SUN) and Skew-unified t (SUT) distributions

Lambda = matrix(c(1,0,2,-3,0,-1),3,2) #A skewness matrix p times q
Gamma  = matrix(c(1,-0.5,-0.5,1),2,2) #A correlation matrix q times q
tau    = c(-1,2)                      #A vector of extension parameters of dim q

MC7 = MCmeanvarTMD(a,b,mu,Sigma,lambda = Lambda,tau = c(-1,2),Gamma = Gamma,dist = "SUN")
MC8 = MCmeanvarTMD(a,b,mu,Sigma,lambda = Lambda,tau = c(-1,2),Gamma = Gamma,nu = 1,dist = "SUT")

</code></pre>

<hr>
<h2 id='meanvarFMD'>
Mean and variance for folded multivariate distributions
</h2><span id='topic+meanvarFMD'></span>

<h3>Description</h3>

<p>It computes the mean vector and variance-covariance matrix for the folded <code>p</code>-variate Normal, Skew-normal (SN), Extended Skew-normal (ESN) and Student's t-distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meanvarFMD(mu,Sigma,lambda = NULL,tau = NULL,nu = NULL,dist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meanvarFMD_+3A_mu">mu</code></td>
<td>

<p>a numeric vector of length <code class="reqn">p</code> representing the location parameter.
</p>
</td></tr>
<tr><td><code id="meanvarFMD_+3A_sigma">Sigma</code></td>
<td>

<p>a numeric positive definite matrix with dimension <code class="reqn">p</code>x<code class="reqn">p</code> representing the scale parameter.
</p>
</td></tr>
<tr><td><code id="meanvarFMD_+3A_lambda">lambda</code></td>
<td>

<p>a numeric vector of length <code class="reqn">p</code> representing the skewness parameter for SN and ESN cases. If <code>lambda == 0</code>, the ESN/SN reduces to a normal (symmetric) distribution.
</p>
</td></tr>
<tr><td><code id="meanvarFMD_+3A_tau">tau</code></td>
<td>

<p>It represents the extension parameter for the ESN distribution. If <code>tau == 0</code>, the ESN reduces to a SN distribution.
</p>
</td></tr>
<tr><td><code id="meanvarFMD_+3A_nu">nu</code></td>
<td>

<p>It represents the degrees of freedom for the Student's t-distribution. Must be an integer greater than 1.
</p>
</td></tr>
<tr><td><code id="meanvarFMD_+3A_dist">dist</code></td>
<td>

<p>represents the folded distribution to be computed. The values are <code>normal</code>, <code>SN</code> , <code>ESN</code> and <code>t</code>  for the doubly truncated Normal, Skew-normal, Extended Skew-normal and Student's t-distribution respectively.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Normal case by default, i.e., when <code>dist</code> is not provided. Univariate case is also considered, where <code>Sigma</code> will be the variance <code class="reqn">\sigma^2</code>.
</p>


<h3>Value</h3>

<p>It returns a list with three elements:
</p>
<table>
<tr><td><code>mean</code></td>
<td>
<p>the mean vector of length <code class="reqn">p</code></p>
</td></tr>
<tr><td><code>EYY</code></td>
<td>
<p>the second moment matrix of dimensions <code class="reqn">p</code>x<code class="reqn">p</code></p>
</td></tr>
<tr><td><code>varcov</code></td>
<td>
<p>the variance-covariance matrix of dimensions <code class="reqn">p</code>x<code class="reqn">p</code></p>
</td></tr>
</table>


<h3>Warning </h3>

<p>The mean can only be provided when <code>nu</code> is larger than 2. On the other hand, the varcov matrix can only be provided when <code>nu</code> is larger than 3.</p>


<h3>Note</h3>

<p>Degree of freedom must be a positive integer. If <code>nu &gt;= 200</code>, Normal case is considered.&quot;
</p>


<h3>Author(s)</h3>

<p>Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt; and
Victor H. Lachos &lt;<a href="mailto:hlachos@uconn.edu">hlachos@uconn.edu</a>&gt;
</p>
<p>Maintainer: Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Galarza, C. E., Lin, T. I., Wang, W. L., &amp; Lachos, V. H. (2021). On moments of folded and truncated multivariate Student-t distributions based on recurrence relations. Metrika, 84(6), 825-850 &lt;doi:10.1007/s00184-020-00802-1&gt;.
</p>
<p>Galarza, C. E., Matos, L. A., Dey, D. K., &amp; Lachos, V. H. (2022a). &quot;On moments of folded and doubly truncated multivariate extended skew-normal distributions.&quot; Journal of Computational and Graphical Statistics, 1-11 &lt;doi:10.1080/10618600.2021.2000869&gt;.
</p>
<p>Galarza, C. E., Matos, L. A., Castro, L. M., &amp; Lachos, V. H. (2022b). Moments of the doubly truncated selection elliptical distributions with emphasis on the unified multivariate skew-t distribution. Journal of Multivariate Analysis, 189, 104944 &lt;doi:10.1016/j.jmva.2021.104944&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+momentsFMD">momentsFMD</a></code>, <code><a href="#topic+onlymeanTMD">onlymeanTMD</a></code>,<code><a href="#topic+meanvarTMD">meanvarTMD</a></code>,<code><a href="#topic+momentsTMD">momentsTMD</a></code>, <code><a href="#topic+dmvSN">dmvSN</a></code>,<code><a href="#topic+pmvSN">pmvSN</a></code>,<code><a href="#topic+rmvSN">rmvSN</a></code>, <code><a href="#topic+dmvESN">dmvESN</a></code>,<code><a href="#topic+pmvESN">pmvESN</a></code>,<code><a href="#topic+rmvESN">rmvESN</a></code>, <code><a href="#topic+dmvST">dmvST</a></code>,<code><a href="#topic+pmvST">pmvST</a></code>,<code><a href="#topic+rmvST">rmvST</a></code>, <code><a href="#topic+dmvEST">dmvEST</a></code>,<code><a href="#topic+pmvEST">pmvEST</a></code>,<code><a href="#topic+rmvEST">rmvEST</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mu = c(0.1,0.2,0.3)
Sigma = matrix(data = c(1,0.2,0.3,0.2,1,0.4,0.3,0.4,1),
               nrow = length(mu),ncol = length(mu),byrow = TRUE)
value1 = meanvarFMD(mu,Sigma,dist="normal")
value2 = meanvarFMD(mu,Sigma,nu = 4,dist = "t")
value3 = meanvarFMD(mu,Sigma,lambda = c(-2,0,1),dist = "SN")
value4 = meanvarFMD(mu,Sigma,lambda = c(-2,0,1),tau = 1,dist = "ESN")
</code></pre>

<hr>
<h2 id='meanvarTMD'>
Mean and variance for doubly truncated multivariate distributions
</h2><span id='topic+meanvarTMD'></span>

<h3>Description</h3>

<p>It computes the mean vector and variance-covariance matrix for some doubly truncated skew-elliptical distributions. It supports the <code>p</code>-variate Normal, Skew-normal (SN), Extended Skew-normal (ESN) and Unified Skew-normal (SUN) as well as the Student's-t, Skew-t (ST), Extended Skew-t (EST) and Unified Skew-t (SUT) distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meanvarTMD(lower = rep(-Inf,length(mu)),upper = rep(Inf,length(mu)),mu,Sigma
,lambda = NULL,tau = NULL,Gamma = NULL,nu = NULL,dist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meanvarTMD_+3A_lower">lower</code></td>
<td>

<p>the vector of lower limits of length <code class="reqn">p</code>.
</p>
</td></tr>
<tr><td><code id="meanvarTMD_+3A_upper">upper</code></td>
<td>

<p>the vector of upper limits of length <code class="reqn">p</code>.
</p>
</td></tr>
<tr><td><code id="meanvarTMD_+3A_mu">mu</code></td>
<td>

<p>a numeric vector of length <code class="reqn">p</code> representing the location parameter.
</p>
</td></tr>
<tr><td><code id="meanvarTMD_+3A_sigma">Sigma</code></td>
<td>

<p>a numeric positive definite matrix with dimension <code class="reqn">p</code>x<code class="reqn">p</code> representing the scale parameter.
</p>
</td></tr>
<tr><td><code id="meanvarTMD_+3A_lambda">lambda</code></td>
<td>

<p>a numeric matrix of dimension <code class="reqn">p</code>x<code class="reqn">q</code> representing the skewness/shape matrix parameter for the SUN and SUT distribution. For the ESN and EST distributions (<code class="reqn">q=1</code>), <code>lambda</code> is a numeric vector of dimension <code class="reqn">p</code> (see examples at the end of this help). If <code>all(lambda == 0)</code>, the SUN/ESN/SN (SUT/EST/ST) reduces to a normal (t) symmetric distribution.
</p>
</td></tr>
<tr><td><code id="meanvarTMD_+3A_tau">tau</code></td>
<td>

<p>a numeric vector of length <code class="reqn">q</code> representing the extension parameter for the SUN and SUT distribution. For the ESN and EST distributions, <code>tau</code> is a positive scalar (<code class="reqn">q=1</code>). Furthermore, if <code>tau == 0</code>, the ESN (EST) reduces to a SN (ST) distribution.
</p>
</td></tr>
<tr><td><code id="meanvarTMD_+3A_gamma">Gamma</code></td>
<td>

<p>a correlation matrix with dimension <code class="reqn">q</code>x<code class="reqn">q</code>. It must be provided only for the SUN and SUT cases. For particular cases SN, ESN, ST and EST, we have that <code>Gamma == 1</code> (see examples at the end of this help).
</p>
</td></tr>
<tr><td><code id="meanvarTMD_+3A_nu">nu</code></td>
<td>

<p>It represents the degrees of freedom for the Student's t-distribution being a positive real number.
</p>
</td></tr>
<tr><td><code id="meanvarTMD_+3A_dist">dist</code></td>
<td>

<p>represents the truncated distribution to be used. The values are <code>normal</code>, <code>SN</code> , <code>ESN</code> and <code>SUN</code> for the doubly truncated Normal, Skew-normal, Extended Skew-normal and Unified-skew normal distributions and,
<code>t</code>, <code>ST</code> , <code>EST</code> and <code>SUT</code> for the for the doubly truncated Student-t, Skew-t, Extended Skew-t and Unified skew-t distributions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Univariate case is also considered, where <code>Sigma</code> will be the variance <code class="reqn">\sigma^2</code>. Normal case code is an R adaptation of the Matlab available function <code>dtmvnmom.m</code> from Kan &amp; Robotti (2017) and it is used for <code>p&lt;=3</code>. For higher dimensions we use an extension of the algorithm in Vaida (2009).
</p>


<h3>Value</h3>

<p>It returns a list with three elements:
</p>
<table>
<tr><td><code>mean</code></td>
<td>
<p>the mean vector of length <code class="reqn">p</code></p>
</td></tr>
<tr><td><code>EYY</code></td>
<td>
<p>the second moment matrix of dimensions <code class="reqn">p</code>x<code class="reqn">p</code></p>
</td></tr>
<tr><td><code>varcov</code></td>
<td>
<p>the variance-covariance matrix of dimensions <code class="reqn">p</code>x<code class="reqn">p</code></p>
</td></tr>
</table>


<h3>Warning </h3>

<p>For the <code class="reqn">t</code> cases, the algorithm supports degrees of freedom <code>nu &lt;= 2</code>.</p>


<h3>Note</h3>

<p>If <code>nu &gt;= 300</code>, Normal case is considered.&quot;
</p>


<h3>Author(s)</h3>

<p>Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt; and
Victor H. Lachos &lt;<a href="mailto:hlachos@uconn.edu">hlachos@uconn.edu</a>&gt;
</p>
<p>Maintainer: Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Galarza, C. E., Lin, T. I., Wang, W. L., &amp; Lachos, V. H. (2021). On moments of folded and truncated multivariate Student-t distributions based on recurrence relations. Metrika, 84(6), 825-850 &lt;doi:10.1007/s00184-020-00802-1&gt;.
</p>
<p>Galarza, C. E., Matos, L. A., Dey, D. K., &amp; Lachos, V. H. (2022a). &quot;On moments of folded and doubly truncated multivariate extended skew-normal distributions.&quot; Journal of Computational and Graphical Statistics, 1-11 &lt;doi:10.1080/10618600.2021.2000869&gt;.
</p>
<p>Galarza, C. E., Matos, L. A., Castro, L. M., &amp; Lachos, V. H. (2022b). Moments of the doubly truncated selection elliptical distributions with emphasis on the unified multivariate skew-t distribution. Journal of Multivariate Analysis, 189, 104944 &lt;doi:10.1016/j.jmva.2021.104944&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MCmeanvarTMD">MCmeanvarTMD</a></code>,
<code><a href="#topic+momentsTMD">momentsTMD</a></code>, <code><a href="#topic+meanvarFMD">meanvarFMD</a></code>, <code><a href="#topic+meanvarFMD">meanvarFMD</a></code>,<code><a href="#topic+momentsFMD">momentsFMD</a></code>, <code><a href="#topic+dmvSN">dmvSN</a></code>,<code><a href="#topic+pmvSN">pmvSN</a></code>,<code><a href="#topic+rmvSN">rmvSN</a></code>, <code><a href="#topic+dmvESN">dmvESN</a></code>,<code><a href="#topic+pmvESN">pmvESN</a></code>,<code><a href="#topic+rmvESN">rmvESN</a></code>, <code><a href="#topic+dmvST">dmvST</a></code>,<code><a href="#topic+pmvST">pmvST</a></code>,<code><a href="#topic+rmvST">rmvST</a></code>, <code><a href="#topic+dmvEST">dmvEST</a></code>,<code><a href="#topic+pmvEST">pmvEST</a></code>,<code><a href="#topic+rmvEST">rmvEST</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a = c(-0.8,-0.7,-0.6)
b = c(0.5,0.6,0.7)
mu = c(0.1,0.2,0.3)
Sigma = matrix(data = c(1,0.2,0.3,0.2,1,0.4,0.3,0.4,1),
               nrow = length(mu),ncol = length(mu),byrow = TRUE)

# Theoretical value
value1 = meanvarTMD(a,b,mu,Sigma,dist="normal")

#MC estimate
MC11 = MCmeanvarTMD(a,b,mu,Sigma,dist="normal") #by defalut n = 10000
MC12 = MCmeanvarTMD(a,b,mu,Sigma,dist="normal",n = 10^5) #more precision

# Now works for for any nu&gt;0
value2 = meanvarTMD(a,b,mu,Sigma,dist = "t",nu = 0.87)

value3 = meanvarTMD(a,b,mu,Sigma,lambda = c(-2,0,1),dist = "SN")
value4 = meanvarTMD(a,b,mu,Sigma,lambda = c(-2,0,1),nu = 4,dist = "ST")
value5 = meanvarTMD(a,b,mu,Sigma,lambda = c(-2,0,1),tau = 1,dist = "ESN")
value6 = meanvarTMD(a,b,mu,Sigma,lambda = c(-2,0,1),tau = 1,nu = 4,dist = "EST")


#Skew-unified Normal (SUN) and Skew-unified t (SUT) distributions

Lambda = matrix(c(1,0,2,-3,0,-1),3,2) #A skewness matrix p times q
Gamma  = matrix(c(1,-0.5,-0.5,1),2,2) #A correlation matrix q times q
tau    = c(-1,2)                      #A vector of extension parameters of dim q

value7 = meanvarTMD(a,b,mu,Sigma,lambda = Lambda,tau = c(-1,2),Gamma = Gamma,dist = "SUN")
value8 = meanvarTMD(a,b,mu,Sigma,lambda = Lambda,tau = c(-1,2),Gamma = Gamma,nu = 4,dist = "SUT")


#The ESN and EST as particular cases of the SUN and SUT for q=1

Lambda = matrix(c(-2,0,1),3,1)
Gamma  = 1
value9 = meanvarTMD(a,b,mu,Sigma,lambda = Lambda,tau = 1,Gamma = Gamma,dist = "SUN")
value10 = meanvarTMD(a,b,mu,Sigma,lambda = Lambda,tau = 1,Gamma = Gamma,nu = 4,dist = "SUT")

round(value5$varcov,2) == round(value9$varcov,2)
round(value6$varcov,2) == round(value10$varcov,2)

</code></pre>

<hr>
<h2 id='momentsFMD'>
Moments for folded multivariate distributions
</h2><span id='topic+momentsFMD'></span>

<h3>Description</h3>

<p>It computes the kappa-th order moments for the folded <code>p</code>-variate Normal, Skew-normal (SN), Extended Skew-normal (ESN) and Student's t-distribution. It also output other lower moments involved in the recurrence approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>momentsFMD(kappa,mu,Sigma,lambda = NULL,tau = NULL,nu = NULL,dist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="momentsFMD_+3A_kappa">kappa</code></td>
<td>

<p>moments vector of length <code class="reqn">p</code>. All its elements must be integers greater or equal to <code class="reqn">0</code>. For the Student's-t case, <code>kappa</code> can be a scalar representing the order of the moment.
</p>
</td></tr>
<tr><td><code id="momentsFMD_+3A_mu">mu</code></td>
<td>

<p>a numeric vector of length <code class="reqn">p</code> representing the location parameter.
</p>
</td></tr>
<tr><td><code id="momentsFMD_+3A_sigma">Sigma</code></td>
<td>

<p>a numeric positive definite matrix with dimension <code class="reqn">p</code>x<code class="reqn">p</code> representing the scale parameter.
</p>
</td></tr>
<tr><td><code id="momentsFMD_+3A_lambda">lambda</code></td>
<td>

<p>a numeric vector of length <code class="reqn">p</code> representing the skewness parameter for SN and ESN cases. If <code>lambda == 0</code>, the ESN/SN reduces to a normal (symmetric) distribution.
</p>
</td></tr>
<tr><td><code id="momentsFMD_+3A_tau">tau</code></td>
<td>

<p>It represents the extension parameter for the ESN distribution. If <code>tau == 0</code>, the ESN reduces to a SN distribution.
</p>
</td></tr>
<tr><td><code id="momentsFMD_+3A_nu">nu</code></td>
<td>

<p>It represents the degrees of freedom for the Student's t-distribution. Must be an integer greater than 1.
</p>
</td></tr>
<tr><td><code id="momentsFMD_+3A_dist">dist</code></td>
<td>

<p>represents the folded distribution to be computed. The values are <code>normal</code>, <code>SN</code> , <code>ESN</code> and <code>t</code>  for the doubly truncated Normal, Skew-normal, Extended Skew-normal and Student's t-distribution respectively.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Univariate case is also considered, where <code>Sigma</code> will be the variance <code class="reqn">\sigma^2</code>.
</p>


<h3>Value</h3>

<p>A data frame containing <code class="reqn">p+1</code> columns. The <code class="reqn">p</code> first containing the set of combinations of exponents summing up to <code>kappa</code> and the last column containing the the expected value. Normal cases (ESN, SN and normal) return <code>prod(kappa)+1</code> moments while the Student's t-distribution case returns all moments of order up to <code>kappa</code>. See example section.
</p>


<h3>Warning </h3>

<p>For the Student-t cases, including ST and EST, <code>kappa</code>-<code class="reqn">th</code> order moments exist only for  <code>kappa &lt; nu</code>.</p>


<h3>Note</h3>

<p>Degrees of freedom must be a positive integer. If <code>nu &gt;= 300</code>, Normal case is considered.&quot;
</p>


<h3>Author(s)</h3>

<p>Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt; and
Victor H. Lachos &lt;<a href="mailto:hlachos@uconn.edu">hlachos@uconn.edu</a>&gt;
</p>
<p>Maintainer: Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Galarza, C. E., Lin, T. I., Wang, W. L., &amp; Lachos, V. H. (2021). On moments of folded and truncated multivariate Student-t distributions based on recurrence relations. Metrika, 84(6), 825-850 &lt;doi:10.1007/s00184-020-00802-1&gt;.
</p>
<p>Galarza, C. E., Matos, L. A., Dey, D. K., &amp; Lachos, V. H. (2022a). &quot;On moments of folded and doubly truncated multivariate extended skew-normal distributions.&quot; Journal of Computational and Graphical Statistics, 1-11 &lt;doi:10.1080/10618600.2021.2000869&gt;.
</p>
<p>Galarza, C. E., Matos, L. A., Castro, L. M., &amp; Lachos, V. H. (2022b). Moments of the doubly truncated selection elliptical distributions with emphasis on the unified multivariate skew-t distribution. Journal of Multivariate Analysis, 189, 104944 &lt;doi:10.1016/j.jmva.2021.104944&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+meanvarFMD">meanvarFMD</a></code>, <code><a href="#topic+onlymeanTMD">onlymeanTMD</a></code>,<code><a href="#topic+meanvarTMD">meanvarTMD</a></code>,<code><a href="#topic+momentsTMD">momentsTMD</a></code>, <code><a href="#topic+dmvSN">dmvSN</a></code>,<code><a href="#topic+pmvSN">pmvSN</a></code>,<code><a href="#topic+rmvSN">rmvSN</a></code>, <code><a href="#topic+dmvESN">dmvESN</a></code>,<code><a href="#topic+pmvESN">pmvESN</a></code>,<code><a href="#topic+rmvESN">rmvESN</a></code>, <code><a href="#topic+dmvST">dmvST</a></code>,<code><a href="#topic+pmvST">pmvST</a></code>,<code><a href="#topic+rmvST">rmvST</a></code>, <code><a href="#topic+dmvEST">dmvEST</a></code>,<code><a href="#topic+pmvEST">pmvEST</a></code>,<code><a href="#topic+rmvEST">rmvEST</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mu = c(0.1,0.2,0.3)
Sigma = matrix(data = c(1,0.2,0.3,0.2,1,0.4,0.3,0.4,1),
               nrow = length(mu),ncol = length(mu),byrow = TRUE)
value1 = momentsFMD(c(2,0,1),mu,Sigma,dist="normal")
value2 = momentsFMD(3,mu,Sigma,dist = "t",nu = 7)
value3 = momentsFMD(c(2,0,1),mu,Sigma,lambda = c(-2,0,1),dist = "SN")
value4 = momentsFMD(c(2,0,1),mu,Sigma,lambda = c(-2,0,1),tau = 1,dist = "ESN")

#T case with kappa vector input
value5 = momentsFMD(c(2,0,1),mu,Sigma,dist = "t",nu = 7)
</code></pre>

<hr>
<h2 id='momentsTMD'>
Moments for doubly truncated multivariate distributions
</h2><span id='topic+momentsTMD'></span>

<h3>Description</h3>

<p>It computes kappa-th order moments for for some doubly truncated skew-elliptical distributions. It supports the <code>p</code>-variate Normal, Skew-normal (SN) and Extended Skew-normal (ESN), as well as the Student's-t, Skew-t (ST) and the Extended Skew-t (EST) distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>momentsTMD(kappa,lower = rep(-Inf,length(mu)),upper = rep(Inf,length(mu)),mu,Sigma,
lambda = NULL,tau = NULL,nu = NULL,dist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="momentsTMD_+3A_kappa">kappa</code></td>
<td>

<p>moments vector of length <code class="reqn">p</code>. All its elements must be integers greater or equal to <code class="reqn">0</code>. For the Student's-t case, <code>kappa</code> can be a scalar representing the order of the moment.
</p>
</td></tr>
<tr><td><code id="momentsTMD_+3A_lower">lower</code></td>
<td>

<p>the vector of lower limits of length <code class="reqn">p</code>.
</p>
</td></tr>
<tr><td><code id="momentsTMD_+3A_upper">upper</code></td>
<td>

<p>the vector of upper limits of length <code class="reqn">p</code>.
</p>
</td></tr>
<tr><td><code id="momentsTMD_+3A_mu">mu</code></td>
<td>

<p>a numeric vector of length <code class="reqn">p</code> representing the location parameter.
</p>
</td></tr>
<tr><td><code id="momentsTMD_+3A_sigma">Sigma</code></td>
<td>

<p>a numeric positive definite matrix with dimension <code class="reqn">p</code>x<code class="reqn">p</code> representing the scale parameter.
</p>
</td></tr>
<tr><td><code id="momentsTMD_+3A_lambda">lambda</code></td>
<td>

<p>a numeric vector of length <code class="reqn">p</code> representing the skewness parameter for SN and ESN cases. If <code>lambda == 0</code>, the ESN/SN reduces to a normal (symmetric) distribution.
</p>
</td></tr>
<tr><td><code id="momentsTMD_+3A_tau">tau</code></td>
<td>

<p>It represents the extension parameter for the ESN distribution. If <code>tau == 0</code>, the ESN reduces to a SN distribution.
</p>
</td></tr>
<tr><td><code id="momentsTMD_+3A_nu">nu</code></td>
<td>

<p>It represents the degrees of freedom for the Student's t-distribution being a positive real number.
</p>
</td></tr>
<tr><td><code id="momentsTMD_+3A_dist">dist</code></td>
<td>

<p>represents the truncated distribution to be used. The values are <code>normal</code>, <code>SN</code> and <code>ESN</code> for the doubly truncated Normal, Skew-normal and Extended Skew-normal distributions and,
<code>t</code>, <code>ST</code> and <code>EST</code> for the for the doubly truncated Student-t, Skew-t and Extended Skew-t distributions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Univariate case is also considered, where <code>Sigma</code> will be the variance <code class="reqn">\sigma^2</code>.
</p>


<h3>Value</h3>

<p>A data frame containing <code class="reqn">p+1</code> columns. The <code class="reqn">p</code> first containing the set of combinations of exponents summing up to <code>kappa</code> and the last column containing the the expected value. Normal cases (ESN, SN and normal) return <code>prod(kappa)+1</code> moments while the Student's t-distribution case returns all moments of order up to <code>kappa</code>. See example section.
</p>


<h3>Note</h3>

<p>If <code>nu &gt;= 300</code>, Normal case is considered.&quot;
</p>


<h3>Author(s)</h3>

<p>Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt; and
Victor H. Lachos &lt;<a href="mailto:hlachos@uconn.edu">hlachos@uconn.edu</a>&gt;
</p>
<p>Maintainer: Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Galarza, C. E., Lin, T. I., Wang, W. L., &amp; Lachos, V. H. (2021). On moments of folded and truncated multivariate Student-t distributions based on recurrence relations. Metrika, 84(6), 825-850.
</p>
<p>Galarza-Morales, C. E., Matos, L. A., Dey, D. K., &amp; Lachos, V. H. (2022a). &quot;On moments of folded and doubly truncated multivariate extended skew-normal distributions.&quot; Journal of Computational and Graphical Statistics, 1-11 &lt;doi:10.1080/10618600.2021.2000869&gt;.
</p>
<p>Galarza, C. E., Matos, L. A., Castro, L. M., &amp; Lachos, V. H. (2022b). Moments of the doubly truncated selection elliptical distributions with emphasis on the unified multivariate skew-t distribution. Journal of Multivariate Analysis, 189, 104944 &lt;doi:10.1016/j.jmva.2021.104944&gt;.
</p>
<p>Kan, R., &amp; Robotti, C. (2017). On moments of folded and truncated multivariate normal distributions. Journal of Computational and Graphical Statistics, 26(4), 930-934.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+onlymeanTMD">onlymeanTMD</a></code>,<code><a href="#topic+meanvarTMD">meanvarTMD</a></code>,<code><a href="#topic+momentsFMD">momentsFMD</a></code>,<code><a href="#topic+meanvarFMD">meanvarFMD</a></code>,<code><a href="#topic+dmvSN">dmvSN</a></code>,<code><a href="#topic+pmvSN">pmvSN</a></code>,<code><a href="#topic+rmvSN">rmvSN</a></code>, <code><a href="#topic+dmvESN">dmvESN</a></code>,<code><a href="#topic+pmvESN">pmvESN</a></code>,<code><a href="#topic+rmvESN">rmvESN</a></code>, <code><a href="#topic+dmvST">dmvST</a></code>,<code><a href="#topic+pmvST">pmvST</a></code>,<code><a href="#topic+rmvST">rmvST</a></code>, <code><a href="#topic+dmvEST">dmvEST</a></code>,<code><a href="#topic+pmvEST">pmvEST</a></code>,<code><a href="#topic+rmvEST">rmvEST</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a = c(-0.8,-0.7,-0.6)
b = c(0.5,0.6,0.7)
mu = c(0.1,0.2,0.3)
Sigma = matrix(data = c(1,0.2,0.3,0.2,1,0.4,0.3,0.4,1),
               nrow = length(mu),ncol = length(mu),byrow = TRUE)
value1 = momentsTMD(c(2,0,1),a,b,mu,Sigma,dist="normal")
value2 = momentsTMD(c(2,0,1),a,b,mu,Sigma,dist = "t",nu = 7)
value3 = momentsTMD(c(2,0,1),a,b,mu,Sigma,lambda = c(-2,0,1),dist = "SN")
value4 = momentsTMD(c(2,0,1),a,b,mu,Sigma,lambda = c(-2,0,1),tau = 1,dist = "ESN")


#T cases with kappa scalar (all moments up to 3)
value5 = momentsTMD(3,a,b,mu,Sigma,nu = 7,dist = "t")
value6 = momentsTMD(3,a,b,mu,Sigma,lambda = c(-2,0,1),nu = 7,dist = "ST")
value7 = momentsTMD(3,a,b,mu,Sigma,lambda = c(-2,0,1),tau = 1,nu = 7,dist = "EST")

</code></pre>

<hr>
<h2 id='MomTrunc-package'>
Moments of Folded and Doubly Truncated Multivariate Distributions
</h2><span id='topic+MomTrunc-package'></span><span id='topic+MomTrunc'></span>

<h3>Description</h3>

<p>It computes arbitrary products moments (mean vector and variance-covariance matrix), for some double truncated (and folded) multivariate distributions. These distributions belong to the family of selection elliptical distributions, which includes well known skewed distributions as the unified skew-t distribution (SUT) and its particular cases as the extended skew-t (EST), skew-t (ST) and the symmetric student-t (T) distribution. Analogous normal cases unified skew-normal (SUN), extended skew-normal (ESN), skew-normal (SN), and symmetric normal (N) are also included. Density, probabilities and random deviates are also offered for these members.
</p>


<h3>Details</h3>

<p>Probabilities can be computed using the functions <code><a href="#topic+pmvSN">pmvSN</a></code> and <code><a href="#topic+pmvESN">pmvESN</a></code> for the normal cases SN and ESN and, <code><a href="#topic+pmvST">pmvST</a></code> and <code><a href="#topic+pmvEST">pmvEST</a></code> for the t cases ST and EST respectively, which offer the option to return the logarithm in base 2 of the probability, useful when the true probability is too small for the machine precision. These functions above use methods in Genz (1992) through the <code>mvtnorm</code> package (linked direclty to our <code>C++</code> functions) and Cao et.al. (2019) through the package <code>tlrmvnmvt</code>. For the double truncated Student-t cases SUT, EST, ST and T, decimal degrees of freedom are supported. Computation of arbitrary moments are based in the works of Kan &amp; Robotti (2017) and Galarza et.al. (2021,2022a,2022b). Reference for the family of selection-elliptical distributions in this package can be found in Arellano-Valle &amp; Genton (2005).
</p>


<h3>Author(s)</h3>

<p>Christian E. Galarza [aut, cre, trl] (&lt;https://orcid.org/0000-0002-4818-6006&gt;), Raymond Kan [ctb] (&lt;https://orcid.org/0000-0002-0578-9974&gt;), Victor H. Lachos [aut, ths] (&lt;https://orcid.org/0000-0002-7239-2459&gt;)
</p>
<p>Maintainer: Christian E. Galarza &lt;cgalarza88@gmail.com&gt;
</p>


<h3>References</h3>

<p>Arellano-Valle, R. B. &amp; Genton, M. G. (2005). On fundamental skew distributions. Journal of Multivariate Analysis, 96, 93-116.
</p>
<p>Cao, J., Genton, M. G., Keyes, D. E., &amp; Turkiyyah, G. M. (2019) &quot;Exploiting Low Rank Covariance Structures for Computing High-Dimensional Normal and Student-t Probabilities&quot; &lt;<a href="https://marcgenton.github.io/2019.CGKT.manuscript.pdf">https://marcgenton.github.io/2019.CGKT.manuscript.pdf</a>&gt;.
</p>
<p>Galarza, C. E., Lin, T. I., Wang, W. L., &amp; Lachos, V. H. (2021). On moments of folded and truncated multivariate Student-t distributions based on recurrence relations. Metrika, 84(6), 825-850 &lt;doi:10.1007/s00184-020-00802-1&gt;.
</p>
<p>Galarza, C. E., Matos, L. A., Dey, D. K., &amp; Lachos, V. H. (2022a). &quot;On moments of folded and doubly truncated multivariate extended skew-normal distributions.&quot; Journal of Computational and Graphical Statistics, 1-11 &lt;doi:10.1080/10618600.2021.2000869&gt;.
</p>
<p>Galarza, C. E., Matos, L. A., Castro, L. M., &amp; Lachos, V. H. (2022b). Moments of the doubly truncated selection elliptical distributions with emphasis on the unified multivariate skew-t distribution. Journal of Multivariate Analysis, 189, 104944 &lt;doi:10.1016/j.jmva.2021.104944&gt;.
</p>
<p>Genz, A., &quot;Numerical computation of multivariate normal probabilities,&quot; Journal of Computational and Graphical Statistics, 1, 141-149 (1992) &lt;doi:10.1080/10618600.1992.10477010&gt;.
</p>
<p>Kan, R., &amp; Robotti, C. (2017). On moments of folded and truncated multivariate normal distributions. Journal of Computational and Graphical Statistics, 26(4), 930-934.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+onlymeanTMD">onlymeanTMD</a></code>,<code><a href="#topic+meanvarTMD">meanvarTMD</a></code>,<code><a href="#topic+momentsTMD">momentsTMD</a></code>,<code><a href="#topic+dmvSN">dmvSN</a></code>,<code><a href="#topic+pmvSN">pmvSN</a></code>,<code><a href="#topic+rmvSN">rmvSN</a></code>,<code><a href="#topic+dmvST">dmvST</a></code>,<code><a href="#topic+pmvST">pmvST</a></code>,<code><a href="#topic+rmvST">rmvST</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a = c(-0.8,-0.7,-0.6)
b = c(0.5,0.6,0.7)
mu = c(0.1,0.2,0.3)
Sigma = matrix(data = c(1,0.2,0.3,0.2,1,0.4,0.3,0.4,1),
               nrow = length(mu),ncol = length(mu),byrow = TRUE)

meanvarTMD(a,b,mu,Sigma,dist="normal") #normal case
meanvarTMD(mu = mu,Sigma = Sigma,lambda = c(-2,0,1),dist="SN") #skew normal with NO truncation
meanvarTMD(a,b,mu,Sigma,lambda = c(-2,0,1),nu = 4.87,dist = "ST") #skew t
momentsTMD(3,a,b,mu,Sigma,nu = 4,dist = "t") #t case, all moments or order &lt;=3
</code></pre>

<hr>
<h2 id='onlymeanTMD'>
Mean for doubly truncated multivariate distributions
</h2><span id='topic+onlymeanTMD'></span>

<h3>Description</h3>

<p>It computes the mean vector for some doubly truncated skew-elliptical distributions. It supports the <code>p</code>-variate Normal, Skew-normal (SN), Extended Skew-normal (ESN) and Unified Skew-normal (SUN) as well as the Student's-t, Skew-t (ST), Extended Skew-t (EST) and Unified Skew-t (SUT) distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>onlymeanTMD(lower = rep(-Inf, length(mu)),upper = rep(Inf,length(mu)),mu,Sigma,
             lambda = NULL,tau = NULL,Gamma = NULL,nu = NULL,dist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="onlymeanTMD_+3A_lower">lower</code></td>
<td>

<p>the vector of lower limits of length <code class="reqn">p</code>.
</p>
</td></tr>
<tr><td><code id="onlymeanTMD_+3A_upper">upper</code></td>
<td>

<p>the vector of upper limits of length <code class="reqn">p</code>.
</p>
</td></tr>
<tr><td><code id="onlymeanTMD_+3A_mu">mu</code></td>
<td>

<p>a numeric vector of length <code class="reqn">p</code> representing the location parameter.
</p>
</td></tr>
<tr><td><code id="onlymeanTMD_+3A_sigma">Sigma</code></td>
<td>

<p>a numeric positive definite matrix with dimension <code class="reqn">p</code>x<code class="reqn">p</code> representing the scale parameter.
</p>
</td></tr>
<tr><td><code id="onlymeanTMD_+3A_lambda">lambda</code></td>
<td>

<p>a numeric vector of length <code class="reqn">p</code> representing the skewness parameter for SN and ESN cases. If <code>lambda == 0</code>, the ESN/SN reduces to a normal (symmetric) distribution.
</p>
</td></tr>
<tr><td><code id="onlymeanTMD_+3A_tau">tau</code></td>
<td>

<p>It represents the extension parameter for the ESN distribution. If <code>tau == 0</code>, the ESN reduces to a SN distribution.
</p>
</td></tr>
<tr><td><code id="onlymeanTMD_+3A_gamma">Gamma</code></td>
<td>

<p>a correlation matrix with dimension <code class="reqn">q</code>x<code class="reqn">q</code>. It must be provided only for the SUN and SUT cases. For particular cases SN, ESN, ST and EST, we have that <code>Gamma == 1</code> (see examples at the end of this help).
</p>
</td></tr>
<tr><td><code id="onlymeanTMD_+3A_nu">nu</code></td>
<td>

<p>It represents the degrees of freedom for the Student's t-distribution.
</p>
</td></tr>
<tr><td><code id="onlymeanTMD_+3A_dist">dist</code></td>
<td>

<p>represents the truncated distribution to be used. The values are <code>normal</code>, <code>SN</code> , <code>ESN</code> and <code>SUN</code> for the doubly truncated Normal, Skew-normal, Extended Skew-normal and Unified-skew normal distributions and,
<code>t</code>, <code>ST</code> , <code>EST</code> and <code>SUT</code> for the for the doubly truncated Student-t, Skew-t, Extended Skew-t and Unified skew-t distributions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Univariate case is also considered, where <code>Sigma</code> will be the variance <code class="reqn">\sigma^2</code>. Normal case code is an R adaptation of the Matlab available function <code>dtmvnmom.m</code> from Kan &amp; Robotti (2017) and it is used for <code>p&lt;=3</code>. For higher dimensions we use proposal in Galarza (2022b).
</p>


<h3>Value</h3>

<p>It returns the mean vector of length <code class="reqn">p</code>.
</p>


<h3>Note</h3>

<p>Degrees of freedom must be a positive integer. If <code>nu &gt;= 300</code>, Normal case is considered.&quot;
</p>


<h3>Author(s)</h3>

<p>Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt; and
Victor H. Lachos &lt;<a href="mailto:hlachos@uconn.edu">hlachos@uconn.edu</a>&gt;
</p>
<p>Maintainer: Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Galarza, C. E., Lin, T. I., Wang, W. L., &amp; Lachos, V. H. (2021). On moments of folded and truncated multivariate Student-t distributions based on recurrence relations. Metrika, 84(6), 825-850.
</p>
<p>Galarza-Morales, C. E., Matos, L. A., Dey, D. K., &amp; Lachos, V. H. (2022a). &quot;On moments of folded and doubly truncated multivariate extended skew-normal distributions.&quot; Journal of Computational and Graphical Statistics, 1-11 &lt;doi:10.1080/10618600.2021.2000869&gt;.
</p>
<p>Galarza, C. E., Matos, L. A., Castro, L. M., &amp; Lachos, V. H. (2022b). Moments of the doubly truncated selection elliptical distributions with emphasis on the unified multivariate skew-t distribution. Journal of Multivariate Analysis, 189, 104944 &lt;doi:10.1016/j.jmva.2021.104944&gt;.
</p>
<p>Kan, R., &amp; Robotti, C. (2017). On moments of folded and truncated multivariate normal distributions. Journal of Computational and Graphical Statistics, 26(4), 930-934.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+momentsTMD">momentsTMD</a></code>, <code><a href="#topic+meanvarFMD">meanvarFMD</a></code>, <code><a href="#topic+momentsFMD">momentsFMD</a></code>,<code><a href="#topic+dmvESN">dmvESN</a></code>,<code><a href="#topic+rmvESN">rmvESN</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a = c(-0.8,-0.7,-0.6)
b = c(0.5,0.6,0.7)
mu = c(0.1,0.2,0.3)
Sigma = matrix(data = c(1,0.2,0.3,0.2,1,0.4,0.3,0.4,1),
               nrow = length(mu),ncol = length(mu),byrow = TRUE)
value1 = onlymeanTMD(a,b,mu,Sigma,dist="normal")

# Now works for for any nu&gt;0
value2 = onlymeanTMD(a,b,mu,Sigma,dist = "t",nu = 0.87)

value3 = onlymeanTMD(a,b,mu,Sigma,lambda = c(-2,0,1),dist = "SN")
value4 = onlymeanTMD(a,b,mu,Sigma,lambda = c(-2,0,1),tau = 1,dist = "ESN")
value5 = onlymeanTMD(a,b,mu,Sigma,lambda = c(-2,0,1),tau = 1,nu = 4,dist = "EST")

#Skew-unified Normal (SUN) and Skew-unified t (SUT) distributions

Lambda = matrix(c(1,0,2,-3,0,-1),3,2) #A skewness matrix p times q
Gamma  = matrix(c(1,-0.5,-0.5,1),2,2) #A correlation matrix q times q
tau    = c(-1,2)                      #A vector of extension parameters of dim q

value6 = onlymeanTMD(a,b,mu,Sigma,lambda = Lambda,tau = c(-1,2),Gamma = Gamma,dist = "SUN")
value7 = onlymeanTMD(a,b,mu,Sigma,lambda = Lambda,tau = c(-1,2),Gamma = Gamma,nu = 4,dist = "SUT")

#The ESN and EST as particular cases of the SUN and SUT for q=1

Lambda = matrix(c(-2,0,1),3,1)
Gamma  = 1
value8 = onlymeanTMD(a,b,mu,Sigma,lambda = Lambda,tau = 1,Gamma = Gamma,dist = "SUN")
value9 = onlymeanTMD(a,b,mu,Sigma,lambda = Lambda,tau = 1,Gamma = Gamma,nu = 4,dist = "SUT")

round(value4,2) == round(value8,2)
round(value5,2) == round(value9,2)
</code></pre>

<hr>
<h2 id='pmvnormt'>Multivariate normal and Student-t probabilities</h2><span id='topic+pmvnormt'></span><span id='topic+pmvnormt'></span>

<h3>Description</h3>

<p>Computation of Multivariate normal and Student-t probabilities using the classic Genz method form packages <code>mvtnorm</code> and <code>tlrmvnmvt</code> packages. In order to save computational effort, it chooses whether to use the function <code>pmvtnorm</code> (<code>pmvt</code>) from <code>mvtnorm</code>, or functions <code>pmvn</code> (<code>pmvt</code>) from the <code>tlrmvnmvt</code> package, depending of the vector size <code>p</code>, real or integer degrees of freedom <code>nu</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pmvnormt(lower = rep(-Inf,ncol(sigma)),upper = rep(Inf,ncol(sigma)),
mean = rep(0,ncol(sigma)),sigma,nu = NULL,uselog2 = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pmvnormt_+3A_lower">lower</code></td>
<td>
<p>lower integration limits, a numeric vector of length p</p>
</td></tr>
<tr><td><code id="pmvnormt_+3A_upper">upper</code></td>
<td>
<p>upper integration limits, a numeric vector of length p</p>
</td></tr>
<tr><td><code id="pmvnormt_+3A_mean">mean</code></td>
<td>
<p>the mean parameter, a numeric vector of length p</p>
</td></tr>
<tr><td><code id="pmvnormt_+3A_sigma">sigma</code></td>
<td>
<p>the covariance matrix, a square matrix that matches the length of 'lower'</p>
</td></tr>
<tr><td><code id="pmvnormt_+3A_nu">nu</code></td>
<td>
<p>degrees of freedom, a positive real number. If <code>NULL</code>, normal case is considered</p>
</td></tr>
<tr><td><code id="pmvnormt_+3A_uselog2">uselog2</code></td>
<td>
<p>a boolean variable, indicating if the log2 result should be returned.
This is useful when the true probability is too small for the machine precision</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimated probability or its log2 if <code>uselog2 == TRUE</code>
</p>


<h3>Note</h3>

<p>If <code>is.null(nu)</code>, normal case is considered.
</p>


<h3>Author(s)</h3>

<p>Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt; and
Victor H. Lachos &lt;<a href="mailto:hlachos@uconn.edu">hlachos@uconn.edu</a>&gt;
</p>
<p>Maintainer: Christian E. Galarza &lt;<a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Genz, A. (1992), &quot;Numerical computation of multivariate
normal probabilities,&quot; Journal of Computational and
Graphical Statistics, 1, 141-149.
</p>
<p>Cao, J., Genton, M. G., Keyes, D. E., &amp; Turkiyyah, G. M. &quot;Exploiting Low Rank Covariance Structures for Computing High-Dimensional Normal and Student- t Probabilities&quot; (2019) &lt;https://marcgenton.github.io/2019.CGKT.manuscript.pdf&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+onlymeanTMD">onlymeanTMD</a></code>,<code><a href="#topic+meanvarTMD">meanvarTMD</a></code>,<code><a href="#topic+momentsFMD">momentsFMD</a></code>,<code><a href="#topic+momentsTMD">momentsTMD</a></code>,<code><a href="#topic+meanvarFMD">meanvarFMD</a></code>,<code><a href="#topic+dmvSN">dmvSN</a></code>,<code><a href="#topic+pmvSN">pmvSN</a></code>,<code><a href="#topic+rmvSN">rmvSN</a></code>, <code><a href="#topic+dmvESN">dmvESN</a></code>,<code><a href="#topic+pmvESN">pmvESN</a></code>,<code><a href="#topic+rmvESN">rmvESN</a></code>, <code><a href="#topic+dmvST">dmvST</a></code>,<code><a href="#topic+pmvST">pmvST</a></code>,<code><a href="#topic+rmvST">rmvST</a></code>, <code><a href="#topic+dmvEST">dmvEST</a></code>,<code><a href="#topic+pmvEST">pmvEST</a></code>,<code><a href="#topic+rmvEST">rmvEST</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a = c(-0.8,-0.7,-0.6)
b = c(0.5,0.6,0.7)
mu = c(0.1,0.2,0.3)
Sigma = matrix(data = c(1,0.2,0.3,0.2,1,0.4,0.3,0.4,1),
               nrow = length(mu),ncol = length(mu),byrow = TRUE)

pmvnormt(lower = a,upper = b,mean = mu,sigma = Sigma) #normal case
pmvnormt(lower = a,upper = b,mean = mu,sigma = Sigma,nu = 4.23)  #t case 
pmvnormt(lower = a,upper = b,mean = mu,sigma = Sigma,nu = 4.23,uselog2 = TRUE) 

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
