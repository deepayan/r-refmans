<!DOCTYPE html><html><head><title>Help for package RCTrep</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RCTrep}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#call_dashboard'><p>Visualizing validation results according to four steps, namely, set-selection, estimation, diagnosis, and validation</p></a></li>
<li><a href='#DGM'><p>Generating RCT data or observational data for the examples used in the package</p></a></li>
<li><a href='#Fusion'><p>Validation of estimates of conditional average treatment effects in objects of class <code>TEstimator</code> and <code>SEstimator</code>.</p></a></li>
<li><a href='#GenerateSyntheticData'><p>Generating the synthetic RCT data given marginal distribution of each covariate</p></a></li>
<li><a href='#quasar.agg'><p>Aggregated data derived from paper of QUASAR trial</p></a></li>
<li><a href='#quasar.obj'><p>An object of class TEstimator_Synthetic using quasar.synthetic</p></a></li>
<li><a href='#quasar.synthetic'><p>A synthetic QUASAR trial dataset, where outcome is a binary variable, treatment is a binary variable.</p></a></li>
<li><a href='#RCTREP'><p>Replicate treatment effect estimates obtained from a randomized control trial using observational data</p></a></li>
<li><a href='#SEstimator_wrapper'><p>Estimating the weighted conditional average treatment effects in <code>source.obj</code> based on input objects <code>source.obj</code> and <code>target.obj</code> of class <code>TEstimator</code>.</p></a></li>
<li><a href='#source.binary.data'><p>A dataset of simulated observational data, where outcome is binary variable. The data is filtered after compared to target.binary.data</p></a></li>
<li><a href='#source.data'><p>A data set of simulated observational data, where outcome is continuous variable, treatment is a binary variable.</p></a></li>
<li><a href='#target.binary.data'><p>A dataset of simulated RCT data, where outcome is binary variable. The data is filtered after compared to source.binary.data</p></a></li>
<li><a href='#target.data'><p>A data set of simulated RCT data, where outcome is continuous variable, treatment is a binary variable.</p></a></li>
<li><a href='#TEstimator_wrapper'><p>Estimating conditional average treatment effects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Validation of Estimates of Treatment Effects in Observational
Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Lingjie Shen [aut, cre, cph],
  Gijs Geleijnse [aut],
  Maurits Kaptein [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lingjie Shen &lt;lingjieshen66@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Validates estimates of (conditional) average treatment effects obtained using observational data by a) making it easy to obtain and visualize estimates derived using a large variety of methods (G-computation, inverse propensity score weighting, etc.), and b) ensuring that estimates are easily compared to a gold standard (i.e., estimates derived from randomized controlled trials). 'RCTrep' offers a generic protocol for treatment effect validation based on four simple steps, namely, set-selection, estimation, diagnosis, and validation. 'RCTrep' provides a simple dashboard to review the obtained results. The validation approach is introduced by Shen, L., Geleijnse, G. and Kaptein, M. (2023) &lt;<a href="https://doi.org/10.21203%2Frs.3.rs-2559287%2Fv2">doi:10.21203/rs.3.rs-2559287/v2</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/duolajiang/RCTrep">https://github.com/duolajiang/RCTrep</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>mvtnorm, MatchIt, ggplot2, ggpubr, PSweight, numDeriv, R6,
dplyr, geex, BART, fastDummies, tidyr, copula, shiny,
shinydashboard, glue, stats, utils, caret</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), base</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-02 13:16:54 UTC; lshen</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-02 14:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='call_dashboard'>Visualizing validation results according to four steps, namely, set-selection, estimation, diagnosis, and validation</h2><span id='topic+call_dashboard'></span>

<h3>Description</h3>

<p>Visualizing validation results according to four steps, namely, set-selection, estimation, diagnosis, and validation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>call_dashboard(source.obj = NULL, target.obj = NULL, source.obj.rep = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="call_dashboard_+3A_source.obj">source.obj</code></td>
<td>
<p>an instantiated object of class <code>TEstimator</code>. The estimates of conditional average treatment effects are compared to those from <code>target.obj</code>.</p>
</td></tr>
<tr><td><code id="call_dashboard_+3A_target.obj">target.obj</code></td>
<td>
<p>an instantiated object of class <code>TEstimator</code>. The estimates of conditional average treatment effects are regarded as unbiased of truth.</p>
</td></tr>
<tr><td><code id="call_dashboard_+3A_source.obj.rep">source.obj.rep</code></td>
<td>
<p>an instantiated object of class <code>SEstimator</code>. The estimates of conditional average treatment effects are compared to those from <code>target.obj</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an interactive interface visualizing results of four steps
</p>

<hr>
<h2 id='DGM'>Generating RCT data or observational data for the examples used in the package</h2><span id='topic+DGM'></span>

<h3>Description</h3>

<p>Generating RCT data or observational data for the examples used in the package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DGM(
  trial,
  n,
  var_name,
  p_success,
  tau,
  y0,
  log.ps = NULL,
  binary = FALSE,
  noise = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DGM_+3A_trial">trial</code></td>
<td>
<p>Logical indicating whether the treatment is randomly assigned in the generated data. If TRUE, RCT data is generated. Otherwise, observational data is generated.</p>
</td></tr>
<tr><td><code id="DGM_+3A_n">n</code></td>
<td>
<p>A numeric value indicating the number of observations in the generated data</p>
</td></tr>
<tr><td><code id="DGM_+3A_var_name">var_name</code></td>
<td>
<p>A character vector indicating the names of variables</p>
</td></tr>
<tr><td><code id="DGM_+3A_p_success">p_success</code></td>
<td>
<p>the success probability of binary variables</p>
</td></tr>
<tr><td><code id="DGM_+3A_tau">tau</code></td>
<td>
<p>a character indicating the generation of the true treatment effect of each individual</p>
</td></tr>
<tr><td><code id="DGM_+3A_y0">y0</code></td>
<td>
<p>a character indicating the generation of the potential outcome under control</p>
</td></tr>
<tr><td><code id="DGM_+3A_log.ps">log.ps</code></td>
<td>
<p>a numeric value indicating the logit of propensity score</p>
</td></tr>
<tr><td><code id="DGM_+3A_binary">binary</code></td>
<td>
<p>logical indicating whether the outcome is binary or continuous variable</p>
</td></tr>
<tr><td><code id="DGM_+3A_noise">noise</code></td>
<td>
<p>a numeric value indicating the standard error of noise term of continuous outcome</p>
</td></tr>
<tr><td><code id="DGM_+3A_...">...</code></td>
<td>
<p>an optional argument indicating pairwise correlations between variables</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame; column names are variables names, z, y
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n_rct &lt;- 500; n_rwd &lt;- 500
var_name &lt;- c("x1","x2","x3","x4","x5","x6")
p_success_rct &lt;- c(0.7,0.9,0.2,0.3,0.2,0.3)
p_success_rwd &lt;- c(0.2,0.2,0.8,0.8,0.7,0.8)
tau &lt;- "6*x2+x6+2"
y0 &lt;- "x1"
log.ps &lt;- "x1*x2+x3*x4+5*x5+x6"
rho1 &lt;- c("x1","x2",0)
rho2 &lt;- c("x2","x3",0)

target.data &lt;- RCTrep::DGM(trial=TRUE, n_rct, var_name,
                           p_success_rct, tau, y0, log.ps=0,
                           binary = FALSE, noise=1, rho1, rho2)
source.data &lt;- RCTrep::DGM(trial=FALSE, n_rwd, var_name,
                           p_success_rwd, tau, y0, log.ps,
                           binary = FALSE, noise=1, rho1, rho2)


</code></pre>

<hr>
<h2 id='Fusion'>Validation of estimates of conditional average treatment effects in objects of class <code>TEstimator</code> and <code>SEstimator</code>.</h2><span id='topic+Fusion'></span>

<h3>Description</h3>

<p>Validation of estimates of conditional average treatment effects in objects of class <code>TEstimator</code> and <code>SEstimator</code>.
</p>
<p>Validation of estimates of conditional average treatment effects in objects of class <code>TEstimator</code> and <code>SEstimator</code>.
</p>


<h3>Value</h3>

<p>an R6 object
</p>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-Fusion-new"><code>Fusion$new()</code></a>
</p>
</li>
<li> <p><a href="#method-Fusion-plot"><code>Fusion$plot()</code></a>
</p>
</li>
<li> <p><a href="#method-Fusion-print"><code>Fusion$print()</code></a>
</p>
</li>
<li> <p><a href="#method-Fusion-evaluate"><code>Fusion$evaluate()</code></a>
</p>
</li>
<li> <p><a href="#method-Fusion-clone"><code>Fusion$clone()</code></a>
</p>
</li></ul>


<hr>
<a id="method-Fusion-new"></a>



<h4>Method <code>new()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Fusion$new(..., stratification = NULL, stratification_joint = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt><dd><p>objects of class <code>TEstimator</code> and <code>SEstimator</code>.</p>
</dd>
<dt><code>stratification</code></dt><dd><p>a character vector specifying variables. The variables are used to select subgroups individually or in combination depending on <code>stratification_joint</code>. Default value is <code>NULL</code>.</p>
</dd>
<dt><code>stratification_joint</code></dt><dd><p>a logical indicating if subgroups are selected based on levels of individual variable in <code>stratification</code> or levels of combined variables in <code>stratifiation</code>. Default value is NULL.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-Fusion-plot"></a>



<h4>Method <code>plot()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Fusion$plot()</pre></div>


<hr>
<a id="method-Fusion-print"></a>



<h4>Method <code>print()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Fusion$print()</pre></div>


<hr>
<a id="method-Fusion-evaluate"></a>



<h4>Method <code>evaluate()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Fusion$evaluate()</pre></div>


<hr>
<a id="method-Fusion-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>Fusion$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>




<h3>Examples</h3>

<pre><code class='language-R'>
source.data &lt;- RCTrep::source.data
target.data &lt;- RCTrep::target.data

vars_name &lt;- list(outcome_predictors = c("x1","x2","x3","x4","x5","x6"),
                  treatment_name = c('z'),
                  outcome_name = c('y')
)
selection_predictors &lt;- c("x2","x6")

source.obj &lt;- TEstimator_wrapper(
 Estimator = "G_computation",
 data = source.data,
 vars_name = vars_name,
 outcome_method = "glm",
 outcome_form=y ~ x1 + x2 + x3 + z + z:x1 + z:x2 +z:x3+ z:x6,
 name = "RWD",
 data.public = FALSE
)

target.obj &lt;- TEstimator_wrapper(
 Estimator = "Crude",
 data = target.data,
 vars_name = vars_name,
 name = "RCT",
 data.public = FALSE,
 isTrial = TRUE
)

strata &lt;- c("x1","x4")
source.rep.obj &lt;- SEstimator_wrapper(Estimator = "Exact",
                                     target.obj = target.obj,
                                     source.obj = source.obj,
                                     selection_predictors =
                                     selection_predictors)
source.rep.obj$EstimateRep(stratification = strata, stratification_joint = TRUE)

fusion &lt;- Fusion$new(target.obj,
                     source.obj,
                     source.rep.obj)
fusion$plot()
fusion$evaluate()


</code></pre>

<hr>
<h2 id='GenerateSyntheticData'>Generating the synthetic RCT data given marginal distribution of each covariate</h2><span id='topic+GenerateSyntheticData'></span>

<h3>Description</h3>

<p>Generating the synthetic RCT data given marginal distribution of each covariate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GenerateSyntheticData(margin_dis, N, margin, var_name, pw.cor = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GenerateSyntheticData_+3A_margin_dis">margin_dis</code></td>
<td>
<p>a character indicating the distribution of each variable, allowable options are <code>"bernoulli_categorical"</code> and <code>"bernoulli"</code>. If some variables have two categories and some have more than two categories, <code>"bernoulli_categorical"</code> should be specified; if all variables have two categories, <code>"bernoulli"</code> should be specified</p>
</td></tr>
<tr><td><code id="GenerateSyntheticData_+3A_n">N</code></td>
<td>
<p>a numeric value specifying the sample size for the simulated data</p>
</td></tr>
<tr><td><code id="GenerateSyntheticData_+3A_margin">margin</code></td>
<td>
<p>a list containing the marginal distribution of variables; if margin_dis=&quot;bernoulli_categorical&quot;, then margin should be list(x1=c(&quot;x1&quot;,nlevels(x1),level1, level2,...,leveln, plevel1, plevel2,...,plevel3), x2=c(&quot;x2&quot;,...)); if margin_dis=&quot;bernoulli&quot;, margin=list(p(x1=1),p(x2=1),...,p(xn=1))</p>
</td></tr>
<tr><td><code id="GenerateSyntheticData_+3A_var_name">var_name</code></td>
<td>
<p>a vector indicating the name of variables, the order of variables should be aligned with <code>margin</code></p>
</td></tr>
<tr><td><code id="GenerateSyntheticData_+3A_pw.cor">pw.cor</code></td>
<td>
<p>a vector specifying the pairwise correlations of the variables, default is 0; when margin_dis=&quot;bernoulli&quot;, then pw.cor must be specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame with columns names x1, x2,....
</p>

<hr>
<h2 id='quasar.agg'>Aggregated data derived from paper of QUASAR trial</h2><span id='topic+quasar.agg'></span>

<h3>Description</h3>

<p>Aggregated data derived from paper of QUASAR trial
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quasar.agg
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 5.
</p>

<hr>
<h2 id='quasar.obj'>An object of class TEstimator_Synthetic using quasar.synthetic</h2><span id='topic+quasar.obj'></span>

<h3>Description</h3>

<p>An object of class TEstimator_Synthetic using quasar.synthetic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quasar.obj
</code></pre>


<h3>Format</h3>

<p>An object of class <code>TEstimator_Synthetic</code> (inherits from <code>TEstimator</code>, <code>R6</code>) of length 15.
</p>

<hr>
<h2 id='quasar.synthetic'>A synthetic QUASAR trial dataset, where outcome is a binary variable, treatment is a binary variable.</h2><span id='topic+quasar.synthetic'></span>

<h3>Description</h3>

<p>A synthetic QUASAR trial dataset, where outcome is a binary variable, treatment is a binary variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quasar.synthetic
</code></pre>


<h3>Format</h3>

<p>## 'quasar.synthetic'
A data frame with 5934 rows and 3 variables:
</p>

<dl>
<dt>Stage2</dt><dd><p>binary variable, 1 indicating stage 2 and 0 indicating stage 3</p>
</dd>
<dt>male</dt><dd><p>binary variable, 1 indicating male and 0 indicating female</p>
</dd>
<dt>age</dt><dd><p>categorical variable, 1 indicating [23,50], 2 indicating [50,59], 3 indicating [60,69], 4 indicating [70,86]</p>
</dd>
</dl>


<hr>
<h2 id='RCTREP'>Replicate treatment effect estimates obtained from a randomized control trial using observational data</h2><span id='topic+RCTREP'></span>

<h3>Description</h3>

<p>The function <code>RCTREP</code> is used to validate the estimates of treatment effects obtained from observational data by comparing to estimates from a target randomized control trial. The function currently implements the following types of estimators of treatment effects: G_computation, inverse propensity score weighting (IPW), and augmented propensity score weighting. The function implements the following three types of weighting estimators to compare the resulting estimates of treatment effects from RWD to the target RCT: exact matching weights, inverse selection probability weighting, and sub-classification. Since we regard the sample in the RCT as the target population, weights for each individual in observational data is <code class="reqn">p/(1-p)</code> so that the weighted population of observational data is representative to the target population.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RCTREP(
  TEstimator = "G_computation",
  SEstimator = "Exact",
  source.data = source.data,
  target.data = target.data,
  source.name = "RWD",
  target.name = "RCT",
  vars_name,
  selection_predictors,
  outcome_method = "glm",
  treatment_method = "glm",
  weighting_method = "glm",
  outcome_formula = NULL,
  treatment_formula = NULL,
  selection_formula = NULL,
  stratification = NULL,
  stratification_joint = FALSE,
  strata_cut_source = NULL,
  strata_cut_target = NULL,
  two_models = FALSE,
  data.public = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RCTREP_+3A_testimator">TEstimator</code></td>
<td>
<p>A character specifying an estimator for conditional average treatment effects. The allowed estimators for <code>TEstimator</code> are: <code>"G_computation"</code>, <code>"IPW"</code>, and <code>"DR"</code>. The corresponding object will be created by the wrapper function <code>TEstimator_wrapper()</code>. The default is <code>"G_computation"</code>, which, along with <code>outcome_method="glm"</code> models the potential outcomes.</p>
</td></tr>
<tr><td><code id="RCTREP_+3A_sestimator">SEstimator</code></td>
<td>
<p>A character specifying an estimator for weight. The allowed estimators are: <code>"Exact"</code>, <code>"Subclass"</code>, <code>"ISW"</code>. The default is <code>"Exact"</code>, which, implements the exact matching on variables in <code>selection_predictors</code> to balance the population covariates between <code>source.data</code> and <code>target.data</code>.</p>
</td></tr>
<tr><td><code id="RCTREP_+3A_source.data">source.data</code></td>
<td>
<p>A data frame containing variables named in <code>vars_name</code> and possible other variables. <code>source.obj</code> is instantiated using <code>source.data</code>.</p>
</td></tr>
<tr><td><code id="RCTREP_+3A_target.data">target.data</code></td>
<td>
<p>A data frame containing variables named in <code>vars_name</code> and possible other variables. <code>target.obj</code> is instantiated using <code>target.data</code>.</p>
</td></tr>
<tr><td><code id="RCTREP_+3A_source.name">source.name</code></td>
<td>
<p>A character indicating the name of <code>source.obj</code>.</p>
</td></tr>
<tr><td><code id="RCTREP_+3A_target.name">target.name</code></td>
<td>
<p>A character indicating the name of <code>target.obj</code>.</p>
</td></tr>
<tr><td><code id="RCTREP_+3A_vars_name">vars_name</code></td>
<td>
<p>A list containing four vectors <code>outcome_predictors</code>, <code>treatment_name</code>, and <code>outcome_name</code>. <code>outcome_predictors</code> is a character vector containing the adjustment variables, which, along with <code>TEstimator</code> and the corresponding <code>outcome_method</code> or <code>treatment_method</code> to correct for confounding; <code>outcome_name</code> is a character vector of length one containing the variable name of outcome; <code>treatment_name</code> is a character vector of length one containing the variable name of treatment.</p>
</td></tr>
<tr><td><code id="RCTREP_+3A_selection_predictors">selection_predictors</code></td>
<td>
<p>a character vector specifying variable names. The weights are estimated based on the variables.</p>
</td></tr>
<tr><td><code id="RCTREP_+3A_outcome_method">outcome_method</code>, <code id="RCTREP_+3A_treatment_method">treatment_method</code>, <code id="RCTREP_+3A_weighting_method">weighting_method</code></td>
<td>
<p>A character specifying model for outcome, treatment, and weight to use. Possible values are found using <code>names(getModelInfo())</code>. See <a href="http://topepo.github.io/caret/train-models-by-tag.html">http://topepo.github.io/caret/train-models-by-tag.html</a>.</p>
</td></tr>
<tr><td><code id="RCTREP_+3A_outcome_formula">outcome_formula</code>, <code id="RCTREP_+3A_treatment_formula">treatment_formula</code>, <code id="RCTREP_+3A_selection_formula">selection_formula</code></td>
<td>
<p>An optional object of class <code>formula</code> describing the outcome model specification, treatment model specification, and selection model specification.</p>
</td></tr>
<tr><td><code id="RCTREP_+3A_stratification">stratification</code></td>
<td>
<p>An optional character vector containing variables to select subgroups. <code>source.obj</code> will compute both weighted and unweighted average treatment effects of the subgroups, <code>targe.obj</code> will calculate the average treatment effects of the subgroups.</p>
</td></tr>
<tr><td><code id="RCTREP_+3A_stratification_joint">stratification_joint</code></td>
<td>
<p>An optional logical indicating if the subgroups are selected based on levels of combined variables in <code>stratification</code> or levels of individual variable in <code>stratification</code>.</p>
</td></tr>
<tr><td><code id="RCTREP_+3A_strata_cut_source">strata_cut_source</code></td>
<td>
<p>An optional list containing lists. Each component is a list with tag named by a variable in <code>source.data</code> to discretize, containing <code>break</code> which is a vector specifying the interval of range of the variable to divide, <code>lable</code> which is a character vector specifying how to code value in the variable according to which interval they fall. The leftmost interval corresponds to level one, the next leftmost to level two and so on. This parameter is useful in the case we concern the integrated treatment effect conditioning on variables with multiple levels (for instance, continuous variable or ordinal variable with multiple levels). Note that we first model based on these continuous variables, then we discretize these variables according to <code>strata_cut</code>. The variables in <code>data</code> of <code>TEstimator</code> object are discretized, and the weight is calculated based on the discretized variables.</p>
</td></tr>
<tr><td><code id="RCTREP_+3A_strata_cut_target">strata_cut_target</code></td>
<td>
<p>An optional list containing lists. Each component is a list with tag named by a variable in <code>target.data</code> to discretize.</p>
</td></tr>
<tr><td><code id="RCTREP_+3A_two_models">two_models</code></td>
<td>
<p>An optional logical indicating whether potential outcomes should be modeled separately when <code>TEstimator="DR"</code>. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="RCTREP_+3A_data.public">data.public</code></td>
<td>
<p>An optional logical indicating whether the <code>data</code> in the output objects are public. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="RCTREP_+3A_...">...</code></td>
<td>
<p>An optional argument passed to <code>fit()</code> of each estimator object for model training and tuning. See <a href="https://topepo.github.io/caret/model-training-and-tuning.html">https://topepo.github.io/caret/model-training-and-tuning.html</a> for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An R6 object is constructed by a wrapper function <code><a href="#topic+TEstimator_wrapper">TEstimator_wrapper</a></code> and <code><a href="#topic+SEstimator_wrapper">SEstimator_wrapper</a></code> with user's input of data and estimators for treatment effect and weight. <code>TEstimator_wrapper()</code> returns initialized objects <code>source.obj</code> and <code>target.obj</code>. <code>SEstimator_wrapper()</code> weights the estimates of <code>source.obj</code> via the class method <code>RCTrep()</code>. The weights are computed using data in the source object <code>source.obj</code>, target object <code>target.obj</code>, and estimator of weights <code>SEstimator</code>.
</p>


<h3>Value</h3>

<p>A list of length three with three R6 class objects, <code>source.obj</code>, <code>target.obj</code> and <code>source.rep.obj</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
output &lt;- RCTREP(TEstimator = "G_computation", SEstimator = "Exact",
                 outcome_method = "BART",
                 source.data = RCTrep::source.data[sample(dim(RCTrep::source.data)[1],500),],
                 target.data = RCTrep::target.data[sample(dim(RCTrep::target.data)[1],500),],
                 vars_name = list(outcome_predictors =
                                    c("x1","x2","x3","x4","x5","x6"),
                                 treatment_name = c('z'),
                                 outcome_name = c('y')),
                 selection_predictors = c("x2","x6"),
                 stratification = c("x1","x3","x4","x5"),
                 stratification_joint = TRUE)
output$target.obj
output$source.obj
output$source.rep.obj

</code></pre>

<hr>
<h2 id='SEstimator_wrapper'>Estimating the weighted conditional average treatment effects in <code>source.obj</code> based on input objects <code>source.obj</code> and <code>target.obj</code> of class <code>TEstimator</code>.</h2><span id='topic+SEstimator_wrapper'></span>

<h3>Description</h3>

<p>Estimating the weighted conditional average treatment effects in <code>source.obj</code> based on input objects <code>source.obj</code> and <code>target.obj</code> of class <code>TEstimator</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SEstimator_wrapper(
  Estimator,
  target.obj,
  source.obj,
  selection_predictors,
  method = "glm",
  sampling_formula = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SEstimator_wrapper_+3A_estimator">Estimator</code></td>
<td>
<p>a character specifying an estimator for weight. The allowed estimators are <code>"Exact"</code>, <code>"ISW"</code>, and <code>"Subclass"</code>.</p>
</td></tr>
<tr><td><code id="SEstimator_wrapper_+3A_target.obj">target.obj</code>, <code id="SEstimator_wrapper_+3A_source.obj">source.obj</code></td>
<td>
<p>an instantiated object of class <code>TEstimator</code>.</p>
</td></tr>
<tr><td><code id="SEstimator_wrapper_+3A_selection_predictors">selection_predictors</code></td>
<td>
<p>a character vector specifying the names of variables in <code>data</code> of <code>source.obj</code> and <code>target.obj</code>. Weights are estimated based on the variables.</p>
</td></tr>
<tr><td><code id="SEstimator_wrapper_+3A_method">method</code></td>
<td>
<p>an optional character specifying a model for estimating sampling probability when <code>Estimator='ISW'</code> or <code>Estimator='Subclass'</code>.</p>
</td></tr>
<tr><td><code id="SEstimator_wrapper_+3A_sampling_formula">sampling_formula</code></td>
<td>
<p>an object of class <code>formula</code> specifying a model specification for sampling probability. Default value is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="SEstimator_wrapper_+3A_...">...</code></td>
<td>
<p>an optional argument specifying training and tuning for a model of sampling probability. See <a href="https://topepo.github.io/caret/model-training-and-tuning.html">https://topepo.github.io/caret/model-training-and-tuning.html</a> for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>SEstimator</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
source.data &lt;- RCTrep::source.data
target.data &lt;- RCTrep::target.data

vars_name &lt;- list(outcome_predictors = c("x1","x2","x3","x4","x5","x6"),
                  treatment_name = c('z'),
                  outcome_name = c('y'))

target.obj &lt;- TEstimator_wrapper(
  Estimator = "Crude",
  data = target.data,
  vars_name = vars_name,
  name = "RCT",
  data.public = FALSE,
  isTrial = TRUE)

source.obj &lt;- TEstimator_wrapper(
  Estimator = "G_computation",
  data = source.data,
  vars_name = vars_name,
  outcome_method = "glm",
  outcome_form=y ~ x1 + x2 + x3 + z + z:x1 + z:x2 +z:x3+ z:x6,
  name = "RWD",
  data.public = TRUE)

source.rep.obj &lt;- SEstimator_wrapper(Estimator="Exact",
                                     target.obj=target.obj,
                                     source.obj=source.obj,
                                     selection_predictors=c("x2","x6"))
source.rep.obj$EstimateRep(stratification = c("x1","x3","x4","x5"),
                           stratification_joint = TRUE)


</code></pre>

<hr>
<h2 id='source.binary.data'>A dataset of simulated observational data, where outcome is binary variable. The data is filtered after compared to target.binary.data</h2><span id='topic+source.binary.data'></span>

<h3>Description</h3>

<p>A dataset of simulated observational data, where outcome is binary variable. The data is filtered after compared to target.binary.data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>source.binary.data
</code></pre>


<h3>Format</h3>

<p>A data frame with 2624 rows and 9 variables.
</p>

<dl>
<dt>x1</dt><dd><p>binary variable, x1 ~ rbinom(5000,1,0.2)</p>
</dd>
<dt>x2</dt><dd><p>binary variable, x2 ~ rbinom(5000,1,0.2)</p>
</dd>
<dt>x3</dt><dd><p>binary variable, x3 ~ rbinom(5000,1,0.8)</p>
</dd>
<dt>x4</dt><dd><p>binary variable, x4 ~ rbinom(5000,1,0.8)</p>
</dd>
<dt>x5</dt><dd><p>binary variable, x5 ~ rbinom(5000,1,0.7)</p>
</dd>
<dt>x6</dt><dd><p>binary variable, x6 ~ rbinom(5000,1,0.8)</p>
</dd>
<dt>z</dt><dd><p>binary variable. pp = x1*x2+x3*x4+5*x5+x6, p(z=1) = p = 1/(1+e^-(pp-mean(pp))/sd(pp)*sqrt(3)/pi), z ~ rbinom(5000,1,p)</p>
</dd>
<dt>y</dt><dd><p>binary variable. pp = x1 + (6*x2+x6+2)*z, p(y=1) = p = 1/(1+e^-(pp-mean(pp))/sd(pp)*sqrt(3)/pi), y ~ rbinom(5000,1,p)</p>
</dd>
<dt>pt</dt><dd><p>a continuous variable within 0 and 1, specifying the probability of p(z=1) given x1,x2,x3,x4,x5,x6</p>
</dd>
</dl>


<hr>
<h2 id='source.data'>A data set of simulated observational data, where outcome is continuous variable, treatment is a binary variable.</h2><span id='topic+source.data'></span>

<h3>Description</h3>

<p>A data set of simulated observational data, where outcome is continuous variable, treatment is a binary variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>source.data
</code></pre>


<h3>Format</h3>

<p>## 'source.data'
A data frame with 5000 rows and 8 variables:
</p>

<dl>
<dt>x1</dt><dd><p>binary variable, x1 ~ rbinom(5000,1,0.2)</p>
</dd>
<dt>x2</dt><dd><p>binary variable, x2 ~ rbinom(5000,1,0.2)</p>
</dd>
<dt>x3</dt><dd><p>binary variable, x3 ~ rbinom(5000,1,0.8)</p>
</dd>
<dt>x4</dt><dd><p>binary variable, x4 ~ rbinom(5000,1,0.8)</p>
</dd>
<dt>x5</dt><dd><p>binary variable, x5 ~ rbinom(5000,1,0.7)</p>
</dd>
<dt>x6</dt><dd><p>binary variable, x6 ~ rbinom(5000,1,0.8)</p>
</dd>
<dt>z</dt><dd><p>binary variable indicating treatment and control. pp = x1*x2+x3*x4+5*x5+x6, p(z=1) = p = 1/(1+e^-(pp-mean(pp))/sd(pp)*sqrt(3)/pi), z ~ rbinom(5000,1,p)</p>
</dd>
<dt>y</dt><dd><p>continuous variable indicating outcome, y ~ x1 + 6*x2+x6+2*z + rnorm(5000,0,1)</p>
</dd>
</dl>


<hr>
<h2 id='target.binary.data'>A dataset of simulated RCT data, where outcome is binary variable. The data is filtered after compared to source.binary.data</h2><span id='topic+target.binary.data'></span>

<h3>Description</h3>

<p>A dataset of simulated RCT data, where outcome is binary variable. The data is filtered after compared to source.binary.data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>target.binary.data
</code></pre>


<h3>Format</h3>

<p>A data frame with 3194 rows and 9 variables.
</p>

<dl>
<dt>x1</dt><dd><p>binary variable, x1 ~ rbinom(5000,1,0.7)</p>
</dd>
<dt>x2</dt><dd><p>binary variable, x2 ~ rbinom(5000,1,0.9)</p>
</dd>
<dt>x3</dt><dd><p>binary variable, x3 ~ rbinom(5000,1,0.2)</p>
</dd>
<dt>x4</dt><dd><p>binary variable, x4 ~ rbinom(5000,1,0.3)</p>
</dd>
<dt>x5</dt><dd><p>binary variable, x5 ~ rbinom(5000,1,0.2)</p>
</dd>
<dt>x6</dt><dd><p>binary variable, x6 ~ rbinom(5000,1,0.3)</p>
</dd>
<dt>z</dt><dd><p>binary variable. pp = x1*x2+x3*x4+5*x5+x6, p(z=1) = p = 1/(1+exp^-(pp-mean(pp))/sd(pp)*sqrt(3)/pi), z ~ rbinom(5000,1,p)</p>
</dd>
<dt>y</dt><dd><p>binary variable. pp = x1 + (6*x2+x6+2)*z, p(y=1) = p = 1/(1+exp^-(pp-mean(pp))/sd(pp)*sqrt(3)/pi), y ~ rbinom(5000,1,p)</p>
</dd>
<dt>pt</dt><dd><p>a continuous variable within 0 and 1, specifying the probability of p(z=1) given x1,x2,x3,x4,x5,x6</p>
</dd>
</dl>


<hr>
<h2 id='target.data'>A data set of simulated RCT data, where outcome is continuous variable, treatment is a binary variable.</h2><span id='topic+target.data'></span>

<h3>Description</h3>

<p>A data set of simulated RCT data, where outcome is continuous variable, treatment is a binary variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>target.data
</code></pre>


<h3>Format</h3>

<p>## 'target.data'
A data frame with 5000 rows and 8 variables:
</p>

<dl>
<dt>x1</dt><dd><p>binary variable, x1 ~ rbinom(5000,1,0.7)</p>
</dd>
<dt>x2</dt><dd><p>binary variable, x2 ~ rbinom(5000,1,0.9)</p>
</dd>
<dt>x3</dt><dd><p>binary variable, x3 ~ rbinom(5000,1,0.2)</p>
</dd>
<dt>x4</dt><dd><p>binary variable, x4 ~ rbinom(5000,1,0.3)</p>
</dd>
<dt>x5</dt><dd><p>binary variable, x5 ~ rbinom(5000,1,0.2)</p>
</dd>
<dt>x6</dt><dd><p>binary variable, x6 ~ rbinom(5000,1,0.3)</p>
</dd>
<dt>z</dt><dd><p>binary variable indicating treatment and control, z ~ rbinom(5000,1,0.5)</p>
</dd>
<dt>y</dt><dd><p>continuous variable indicating outcome, y ~ x1 + 6*x2+x6+2*z + rnorm(5000,0,1)</p>
</dd>
</dl>


<hr>
<h2 id='TEstimator_wrapper'>Estimating conditional average treatment effects</h2><span id='topic+TEstimator_wrapper'></span>

<h3>Description</h3>

<p>Estimating conditional average treatment effects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TEstimator_wrapper(
  Estimator,
  data,
  vars_name,
  name = "",
  outcome_method = "glm",
  treatment_method = "glm",
  two_models = FALSE,
  outcome_formula = NULL,
  treatment_formula = NULL,
  data.public = TRUE,
  isTrial = FALSE,
  strata_cut = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TEstimator_wrapper_+3A_estimator">Estimator</code></td>
<td>
<p>A character specifying an estimator for conditional average treatment effects. The allowed estimators are: <code>"G_computation"</code>, <code>"IPW"</code>, and <code>"DR"</code>.i The corresponding object wll be created by the function <code>TEstimator_wrapper()</code>. The default is <code>"G_computation"</code>, which, along with <code>outcome_method="glm"</code> models the potential outcomes.</p>
</td></tr>
<tr><td><code id="TEstimator_wrapper_+3A_data">data</code></td>
<td>
<p>A data frame containing variables named in <code>vars_name</code> and possible other variables.</p>
</td></tr>
<tr><td><code id="TEstimator_wrapper_+3A_vars_name">vars_name</code></td>
<td>
<p>A list containing four character vectors <code>outcome_predictors</code>, <code>treatment_name</code>, and <code>outcome_name</code>. <code>outcome_predictors</code> is a character vector containing the adjustment variables, which, along with <code>TEstimator</code> and the corresponding <code>outcome_method</code> or <code>treatment_method</code> to correct for confounding; <code>outcome_name</code> is a character vector of length one containing the name of outcome; <code>treatment_name</code> is a character vector of length one containing the name of treatment.</p>
</td></tr>
<tr><td><code id="TEstimator_wrapper_+3A_name">name</code></td>
<td>
<p>A character indicating the name of the output object</p>
</td></tr>
<tr><td><code id="TEstimator_wrapper_+3A_outcome_method">outcome_method</code></td>
<td>
<p>A character specifying a model for outcome. Possible values are found using <code>names(getModelInfo())</code>. See <a href="http://topepo.github.io/caret/train-models-by-tag.html">http://topepo.github.io/caret/train-models-by-tag.html</a>. Default is &quot;glm&quot;.</p>
</td></tr>
<tr><td><code id="TEstimator_wrapper_+3A_treatment_method">treatment_method</code></td>
<td>
<p>A character specifying a model for treatment. Possible values are found using <code>names(getModelInfo())</code>. See <a href="http://topepo.github.io/caret/train-models-by-tag.html">http://topepo.github.io/caret/train-models-by-tag.html</a>. Default is &quot;glm&quot;.</p>
</td></tr>
<tr><td><code id="TEstimator_wrapper_+3A_two_models">two_models</code></td>
<td>
<p>An optional logical indicating whether potential outcomes should be modeled separately when <code>TEstimator="DR"</code>. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="TEstimator_wrapper_+3A_outcome_formula">outcome_formula</code></td>
<td>
<p>An optional object of class <code>formula</code> describing the outcome model specification when <code>Estimator="G_computation"</code> or <code>Estimator="DR"</code>.</p>
</td></tr>
<tr><td><code id="TEstimator_wrapper_+3A_treatment_formula">treatment_formula</code></td>
<td>
<p>An optional object of class <code>formula</code> describing the treatment model specification when <code>Estimator="IPW"</code> or <code>Estimator="DR"</code></p>
</td></tr>
<tr><td><code id="TEstimator_wrapper_+3A_data.public">data.public</code></td>
<td>
<p>An optional logical indicating whether individual-level <code>data</code> is public in the output object. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="TEstimator_wrapper_+3A_istrial">isTrial</code></td>
<td>
<p>An optional logical indicating whether the treatment assignment of <code>data</code> is random or unknown.</p>
</td></tr>
<tr><td><code id="TEstimator_wrapper_+3A_strata_cut">strata_cut</code></td>
<td>
<p>An optional list containing lists. Each component is a list with tag named by a variable in <code>data</code> to discretize, containing <code>break</code> which is a vector specifying the interval of range of the variable to divide, <code>lable</code> which is a character vector specifying how to code value in the variable according to which interval they fall. The leftmost interval corresponds to level one, the next leftmost to level two and so on. This parameter is useful in the case we concern the integrated treatment effect conditioning on variables with multiple levels (for instance, continuous variable or ordinal variable with multiple levels). Note that we first model based on these continuous variables, then we discretize these variables according to <code>strata_cut</code>. The variables in <code>data</code> of the output object are discretized.</p>
</td></tr>
<tr><td><code id="TEstimator_wrapper_+3A_...">...</code></td>
<td>
<p>An optional argument passed to the private function <code>fit()</code> of each class for model training and tuning. See <a href="https://topepo.github.io/caret/model-training-and-tuning.html">https://topepo.github.io/caret/model-training-and-tuning.html</a> for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>TEstimator</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data &lt;- RCTrep::source.data[sample(dim(RCTrep::source.data)[1],500),]
vars_name &lt;- list(outcome_predictors = c("x1","x2","x3","x4","x5","x6"),
                  treatment_name = c('z'),
                  outcome_name = c('y'))

obj &lt;- TEstimator_wrapper(
 Estimator = "G_computation",
 data = data,
 vars_name = vars_name,
 name = "RCT",
 data.public = TRUE,
 isTrial = FALSE)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
