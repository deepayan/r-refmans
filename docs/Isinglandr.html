<!DOCTYPE html><html><head><title>Help for package Isinglandr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Isinglandr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Isinglandr-package'><p>Isinglandr: Landscape Construction and Simulation for Ising Networks</p></a></li>
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#autolayer.resilience'><p>Get ggplot2 layers of resilience metrics to add to the landscape plots</p></a></li>
<li><a href='#calculate_barrier.Isingland'><p>Calculate energy barrier for Ising landscapes</p></a></li>
<li><a href='#calculate_resilience'><p>Calculate the resilience values for Ising landscapes</p></a></li>
<li><a href='#chain_simulate_Isingland'><p>Make Ising chains from (a series of) Ising grid(s) and perform a</p>
chain simulation.</a></li>
<li><a href='#make_2d_Isingland'><p>Make a 2D landscape for an Ising network</p></a></li>
<li><a href='#make_2d_Isingland_matrix'><p>Make a matrix of landscapes for multiple Ising networks</p></a></li>
<li><a href='#make_3d_Isingland'><p>Make a 3D landscape for an Ising network</p></a></li>
<li><a href='#make_Ising_grid'><p>Make a Grid to Specify Multiple Ising Networks</p></a></li>
<li><a href='#make_Ising_grid-control-functions'><p>Control Functions to Specify the Varying Parameters for</p>
an Ising Grid.</a></li>
<li><a href='#MDDNetwork'><p>Estimation data for the Ising network of major depressive disorder</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#shiny_Isingland_MDD'><p>A shiny app that shows the landscape for</p>
the Ising network of major depressive disorder</a></li>
<li><a href='#simulate_Isingland'><p>Simulate a 2D Ising landscape</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Landscape Construction and Simulation for Ising Networks</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>A toolbox for constructing potential landscapes for Ising
    networks. The parameters of the networks can be directly supplied by
    users or estimated by the 'IsingFit' package by van Borkulo and
    Epskamp (2016) <a href="https://CRAN.R-project.org/package=IsingFit">https://CRAN.R-project.org/package=IsingFit</a> from
    empirical data. The Ising model's Boltzmann distribution is preserved
    for the potential landscape function. The landscape functions can be
    used for quantifying and visualizing the stability of network states,
    as well as visualizing the simulation process.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://sciurus365.github.io/Isinglandr/">https://sciurus365.github.io/Isinglandr/</a>,
<a href="https://github.com/Sciurus365/Isinglandr">https://github.com/Sciurus365/Isinglandr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Sciurus365/Isinglandr/issues">https://github.com/Sciurus365/Isinglandr/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, gganimate, ggplot2, glue, magrittr, methods, plotly,
purrr, rlang, shiny, shinycssloaders, shinythemes, simlandr,
tibble, tidyr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>gifski, IsingFit, IsingSampler, transformr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-12 08:33:45 UTC; jingm</td>
</tr>
<tr>
<td>Author:</td>
<td>Jingmeng Cui <a href="https://orcid.org/0000-0003-3421-8457"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Gabriela Lunansky <a href="https://orcid.org/0000-0001-6226-2258"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jingmeng Cui &lt;jingmeng.cui@outlook.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-13 00:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Isinglandr-package'>Isinglandr: Landscape Construction and Simulation for Ising Networks</h2><span id='topic+Isinglandr'></span><span id='topic+Isinglandr-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>A toolbox for constructing potential landscapes for Ising networks. The parameters of the networks can be directly supplied by users or estimated by the 'IsingFit' package by van Borkulo and Epskamp (2016) <a href="https://CRAN.R-project.org/package=IsingFit">https://CRAN.R-project.org/package=IsingFit</a> from empirical data. The Ising model's Boltzmann distribution is preserved for the potential landscape function. The landscape functions can be used for quantifying and visualizing the stability of network states, as well as visualizing the simulation process.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Jingmeng Cui <a href="mailto:jingmeng.cui@outlook.com">jingmeng.cui@outlook.com</a> (<a href="https://orcid.org/0000-0003-3421-8457">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Gabriela Lunansky (<a href="https://orcid.org/0000-0001-6226-2258">ORCID</a>) [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://sciurus365.github.io/Isinglandr/">https://sciurus365.github.io/Isinglandr/</a>
</p>
</li>
<li> <p><a href="https://github.com/Sciurus365/Isinglandr">https://github.com/Sciurus365/Isinglandr</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/Sciurus365/Isinglandr/issues">https://github.com/Sciurus365/Isinglandr/issues</a>
</p>
</li></ul>


<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='autolayer.resilience'>Get ggplot2 layers of resilience metrics to add to the landscape plots</h2><span id='topic+autolayer.resilience'></span><span id='topic+autolayer.resilience_2d_Isingland'></span>

<h3>Description</h3>

<p>Those layers can show how the resilience metrics are calculated on the landscape.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'resilience_2d_Isingland'
autolayer(
  object,
  point = TRUE,
  line = TRUE,
  split_value = TRUE,
  interval = TRUE,
  resilience_value = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autolayer.resilience_+3A_object">object</code></td>
<td>
<p>A <code>resilience</code> object calculated by <code><a href="#topic+calculate_resilience">calculate_resilience()</a></code></p>
</td></tr>
<tr><td><code id="autolayer.resilience_+3A_point">point</code>, <code id="autolayer.resilience_+3A_line">line</code>, <code id="autolayer.resilience_+3A_split_value">split_value</code>, <code id="autolayer.resilience_+3A_interval">interval</code>, <code id="autolayer.resilience_+3A_resilience_value">resilience_value</code></td>
<td>
<p>Show those elements on the layer? Default is <code>TRUE</code> for all of them.</p>
</td></tr>
<tr><td><code id="autolayer.resilience_+3A_...">...</code></td>
<td>
<p>Not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot layer
</p>

<hr>
<h2 id='calculate_barrier.Isingland'>Calculate energy barrier for Ising landscapes</h2><span id='topic+calculate_barrier.Isingland'></span><span id='topic+calculate_barrier.2d_Isingland'></span><span id='topic+calculate_barrier.2d_Isingland_matrix'></span><span id='topic+print.barrier_2d_Isingland'></span><span id='topic+summary.barrier_2d_Isingland'></span><span id='topic+summary.barrier_2d_Isingland_matrix'></span>

<h3>Description</h3>

<p>Calculate energy barrier for Ising landscapes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class ''2d_Isingland''
calculate_barrier(l, ...)

## S3 method for class ''2d_Isingland_matrix''
calculate_barrier(l, ...)

## S3 method for class 'barrier_2d_Isingland'
print(x, simplify = FALSE, ...)

## S3 method for class 'barrier_2d_Isingland'
summary(object, ...)

## S3 method for class 'barrier_2d_Isingland_matrix'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate_barrier.Isingland_+3A_l">l</code></td>
<td>
<p>An <code>Isingland</code> object constructed with <code><a href="#topic+make_2d_Isingland">make_2d_Isingland()</a></code> or <code><a href="#topic+make_2d_Isingland_matrix">make_2d_Isingland_matrix()</a></code>.</p>
</td></tr>
<tr><td><code id="calculate_barrier.Isingland_+3A_...">...</code></td>
<td>
<p>Not in use.</p>
</td></tr>
<tr><td><code id="calculate_barrier.Isingland_+3A_x">x</code></td>
<td>
<p>a result of the <em>default</em> method of <code>summary()</code>.</p>
</td></tr>
<tr><td><code id="calculate_barrier.Isingland_+3A_simplify">simplify</code></td>
<td>
<p>Print a simplified version of the output? Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="calculate_barrier.Isingland_+3A_object">object</code></td>
<td>
<p>an object for which a summary is desired.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>barrier_Isingland</code> object that contains the following components:
</p>

<ul>
<li> <p><code>shape</code> A character describing the shape of the landscape.
</p>
</li>
<li> <p><code>local_min_start</code>,<code>local_min_end</code>,<code>saddle_point</code> The positions of the
two local minimums and the saddle point, described each by a list containing:
</p>

<ul>
<li> <p><code>U</code> The potential value.
</p>
</li>
<li> <p><code>location</code>
</p>

<ul>
<li> <p><code>x_index</code> The row index in <code>get_dist(l)</code>.
</p>
</li>
<li> <p><code>x_value</code> The number of active nodes.
</p>
</li></ul>

</li></ul>

</li>
<li> <p><code>delta_U_start</code>,<code>delta_U_end</code> The barrier heights for both sides.
</p>
</li></ul>



<h3>Functions</h3>


<ul>
<li> <p><code>summary(barrier_2d_Isingland)</code>: Return a vector of
barrier heights.
</p>
</li>
<li> <p><code>summary(barrier_2d_Isingland_matrix)</code>: Return a tibble of
barrier heights and conditions.
</p>
</li></ul>

<hr>
<h2 id='calculate_resilience'>Calculate the resilience values for Ising landscapes</h2><span id='topic+calculate_resilience'></span><span id='topic+calculate_resilience.2d_Isingland'></span><span id='topic+calculate_resilience.2d_Isingland_matrix'></span>

<h3>Description</h3>

<p>The resilience is calculated based on the shape of the potential landscape and the prior knowledge about the qualitatively different parts of the system. Two resilience indicators are calculated separately, and their difference is used to represent a general resilience of the system in favor of the first phase. Within each phase, the potential difference between the local maximum and the local minimum (if multiple minimums exist, use the one that is further from the other phase; and the local maximum should always be on the side to the other phase) is used to represent the resilience of this phase.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_resilience(l, ...)

## S3 method for class ''2d_Isingland''
calculate_resilience(l, split_value = 0.5 * l$Nvar, ...)

## S3 method for class ''2d_Isingland_matrix''
calculate_resilience(l, split_value = 0.5 * l$Nvar, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate_resilience_+3A_l">l</code></td>
<td>
<p>An <code>Isingland</code> object constructed with <code><a href="#topic+make_2d_Isingland">make_2d_Isingland()</a></code> or <code><a href="#topic+make_2d_Isingland_matrix">make_2d_Isingland_matrix()</a></code>.</p>
</td></tr>
<tr><td><code id="calculate_resilience_+3A_...">...</code></td>
<td>
<p>Not in use.</p>
</td></tr>
<tr><td><code id="calculate_resilience_+3A_split_value">split_value</code></td>
<td>
<p>An integer to specify the number of active nodes used to split two resilience ranges. Default is half of the number of nodes.</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt><code><a href="#topic+calculate_resilience.2d_Isingland">calculate_resilience.2d_Isingland()</a></code></dt><dd><p>Returns a <code>calculate_resilience.2d_Isingland</code> project, which contains the following elements:
</p>

<dl>
<dt>dist</dt><dd><p>The distribution tibble which is the same as in the input <code>l</code>.</p>
</dd>
<dt>effective_minindex1,effective_maxindex1,effective_minindex2,effective_maxindex2</dt><dd><p>The (row)indices in <code>dist</code> that were used as the positions of the local minimums and maximums in two parts.</p>
</dd>
<dt>resilience1,resilience2,resilience_diff</dt><dd><p>The resilience measures for the first (left) part, the second part (right), and their difference.</p>
</dd>
</dl>

</dd>
<dt><code><a href="#topic+calculate_resilience.2d_Isingland_matrix">calculate_resilience.2d_Isingland_matrix()</a></code></dt><dd><p>Returns a <code>resilience_2d_Isingland_matrix</code> object, which is a tibble containing columns of the varying parameters and a column <code>resilience</code> of the <code>calculate_resilience.2d_Isingland</code> objects for each landscape.</p>
</dd>
</dl>

<p>When <code>print()</code>ed, a verbal description of the resilience metrics is shown. Use the <code>summary()</code> method for a tidy version of the outputs.
</p>

<hr>
<h2 id='chain_simulate_Isingland'>Make Ising chains from (a series of) Ising grid(s) and perform a
chain simulation.</h2><span id='topic+chain_simulate_Isingland'></span><span id='topic+make_Ising_chain'></span>

<h3>Description</h3>

<p>First specify what is the network parameter in each time points, then
perform a chain simulation based on it. An Ising chain can be generated
from one or more Ising grid(s) with one changing condition each.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chain_simulate_Isingland(
  Ising_chain,
  transform = FALSE,
  initial = 0,
  beta2 = NULL
)

make_Ising_chain(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chain_simulate_Isingland_+3A_ising_chain">Ising_chain</code></td>
<td>
<p>An    <code>Ising_chain</code> object generated from <code>make_Ising_chain()</code>.</p>
</td></tr>
<tr><td><code id="chain_simulate_Isingland_+3A_transform">transform</code></td>
<td>
<p>By default, this function considers the Ising network
to use <code>-1</code> and <code>1</code> for two states. Set <code>transform = TRUE</code> if the Ising
network uses <code>0</code> and <code>1</code> for two states, <em>which is often the case for the
Ising networks estimated using</em> <code><a href="IsingFit.html#topic+isingfit">IsingFit::IsingFit()</a></code>.</p>
</td></tr>
<tr><td><code id="chain_simulate_Isingland_+3A_initial">initial</code></td>
<td>
<p>An integer indicating the initial number
of active nodes for the simulation. Float numbers will be
converted to an integer automatically.</p>
</td></tr>
<tr><td><code id="chain_simulate_Isingland_+3A_beta2">beta2</code></td>
<td>
<p>The <code class="reqn">beta</code> value used for simulation. By default use
the same value as for landscape construction. Manually setting this
value can make the system easier or more difficult to transition
to another state, but will alter the steady-state distribution as well.</p>
</td></tr>
<tr><td><code id="chain_simulate_Isingland_+3A_...">...</code></td>
<td>
<p>Ising grid(s) created by <code><a href="#topic+make_Ising_grid">make_Ising_grid()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>make_Ising_chain</code> returns an <code>Ising_chain</code> object, which is a tibble, and each row
represents a set of parameters for an Ising network.
</p>
<p><code>chain_simulate_Isingland</code> returns a <code>chain_sim_Isingland</code> object,
which is a tibble containing the parameters, the landscape, and
the number of active nodes for each time step.
</p>

<hr>
<h2 id='make_2d_Isingland'>Make a 2D landscape for an Ising network</h2><span id='topic+make_2d_Isingland'></span>

<h3>Description</h3>

<p>Calculate the potential value <code class="reqn">U(n)</code> for each system state, represented by the
number of active nodes <code class="reqn">n</code>. The potential value is determined so that the Boltzmann
distribution is preserved. The Boltzmann distribution is the basis and the
steady-state distribution of all dynamic methods for Ising models, including
those used in <code><a href="IsingSampler.html#topic+IsingSampler">IsingSampler::IsingSampler()</a></code> and Glauber dynamics. This means
that if you assume the real-life system has the same steady-state distribution
as the Boltzmann distribution of the Ising model, then possibility that their
are <code class="reqn">n</code> active nodes in the system is proportional to <code class="reqn">e^{U(n)}</code>.
Because of this property of <code class="reqn">e^{U(n)}</code>, it is aligned with the potential
landscape definition by Wang et al. (2008) and can quantitatively represent
the stability of different system states.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_2d_Isingland(thresholds, weiadj, beta = 1, transform = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_2d_Isingland_+3A_thresholds">thresholds</code>, <code id="make_2d_Isingland_+3A_weiadj">weiadj</code></td>
<td>
<p>The thresholds and the weighted adjacency matrix
of the Ising network. If you have an <code>IsingFit</code> object estimated using
<code><a href="IsingFit.html#topic+isingfit">IsingFit::IsingFit()</a></code>, you can find those two parameters in its components
(<code style="white-space: pre;">&#8288;&lt;IsingFit&gt;$thresholds&#8288;</code> and <code style="white-space: pre;">&#8288;&lt;IsingFit&gt;$weiadj&#8288;</code>).</p>
</td></tr>
<tr><td><code id="make_2d_Isingland_+3A_beta">beta</code></td>
<td>
<p>The <code class="reqn">\beta</code> value for calculating the Hamiltonian.</p>
</td></tr>
<tr><td><code id="make_2d_Isingland_+3A_transform">transform</code></td>
<td>
<p>By default, this function considers the Ising network
to use <code>-1</code> and <code>1</code> for two states. Set <code>transform = TRUE</code> if the Ising
network uses <code>0</code> and <code>1</code> for two states, <em>which is often the case for the
Ising networks estimated using</em> <code><a href="IsingFit.html#topic+isingfit">IsingFit::IsingFit()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The potential function <code class="reqn">U(n)</code> is calculated by the following equation:
</p>
<p style="text-align: center;"><code class="reqn">U(n) = -\log(\sum_{v}^{a(v)=n} e^{-\beta H(v)})/\beta,</code>
</p>

<p>where <code class="reqn">v</code> represent a specific activation state of the network,
<code class="reqn">a(v)</code> is the number of active nodes for <code class="reqn">v</code>, and <code class="reqn">H</code> is the
Hamiltonian function for Ising networks.
</p>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;2d_Isingland&#8288;</code> object that contains the following components:
</p>

<ul>
<li> <p><code>dist_raw</code>,<code>dist</code> Two tibbles containing the probability
distribution and the potential values for different states.
</p>
</li>
<li> <p><code>thresholds</code>,<code>weiadj</code>,<code>beta</code> The parameters supplied to the function.
</p>
</li>
<li> <p><code>Nvar</code> The number of variables (nodes) in the Ising network.
</p>
</li></ul>



<h3>References</h3>

<p>Wang, J., Xu, L., &amp; Wang, E. (2008). Potential landscape and flux framework of nonequilibrium networks: Robustness, dissipation, and coherence of biochemical oscillations. Proceedings of the National Academy of Sciences, 105(34), 12271-12276. https://doi.org/10.1073/pnas.0800579105
Sacha Epskamp (2020). IsingSampler: Sampling methods and distribution functions for the Ising model. R package version 0.2.1. https://CRAN.R-project.org/package=IsingSampler
Glauber, R. J. (1963). Time-dependent statistics of the Ising model. Journal of Mathematical Physics, 4(2), 294-307. https://doi.org/10.1063/1.1703954
</p>


<h3>See Also</h3>

<p><code><a href="#topic+make_3d_Isingland">make_3d_Isingland()</a></code> if you have two groups of nodes that you want
to count the number of active ones separately.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Nvar &lt;- 10
m &lt;- rep(0, Nvar)
w &lt;- matrix(0.1, Nvar, Nvar)
diag(w) &lt;- 0
result1 &lt;- make_2d_Isingland(m, w)
plot(result1)
</code></pre>

<hr>
<h2 id='make_2d_Isingland_matrix'>Make a matrix of landscapes for multiple Ising networks</h2><span id='topic+make_2d_Isingland_matrix'></span>

<h3>Description</h3>

<p>Make multiple landscapes together for different parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_2d_Isingland_matrix(Ising_grid, transform = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_2d_Isingland_matrix_+3A_ising_grid">Ising_grid</code></td>
<td>
<p>Parameter values generated by <code><a href="#topic+make_Ising_grid">make_Ising_grid()</a></code>.</p>
</td></tr>
<tr><td><code id="make_2d_Isingland_matrix_+3A_transform">transform</code></td>
<td>
<p>By default, this function considers the Ising network
to use <code>-1</code> and <code>1</code> for two states. Set <code>transform = TRUE</code> if the Ising
network uses <code>0</code> and <code>1</code> for two states, <em>which is often the case for the
Ising networks estimated using</em> <code><a href="IsingFit.html#topic+isingfit">IsingFit::IsingFit()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;2d_Isingland_matrix&#8288;</code> object that contains the following
components:
</p>

<ul>
<li> <p><code>dist_raw</code>,<code>dist</code> Two tibbles containing the probability
distribution and the potential values for different states.
</p>
</li>
<li> <p><code>Nvar</code> The number of variables (nodes) in the Ising network.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>Nvar &lt;- 10
m &lt;- rep(0, Nvar)
w &lt;- matrix(0.1, Nvar, Nvar)
diag(w) &lt;- 0
result4 &lt;- make_Ising_grid(
all_thresholds(seq(-0.1, 0.1, 0.1), .f = `+`),
whole_weiadj(seq(0.5, 1.5, 0.5)),
m, w
) %&gt;% make_2d_Isingland_matrix()
plot(result4)
</code></pre>

<hr>
<h2 id='make_3d_Isingland'>Make a 3D landscape for an Ising network</h2><span id='topic+make_3d_Isingland'></span>

<h3>Description</h3>

<p>Similar to <code><a href="#topic+make_2d_Isingland">make_2d_Isingland()</a></code>, but two categories of nodes can
be specified so the number of active nodes can be calculated
separately.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_3d_Isingland(thresholds, weiadj, x, y, beta = 1, transform = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_3d_Isingland_+3A_thresholds">thresholds</code>, <code id="make_3d_Isingland_+3A_weiadj">weiadj</code></td>
<td>
<p>The thresholds and the weighted adjacency matrix
of the Ising network. If you have an <code>IsingFit</code> object estimated using
<code><a href="IsingFit.html#topic+isingfit">IsingFit::IsingFit()</a></code>, you can find those two parameters in its components
(<code style="white-space: pre;">&#8288;&lt;IsingFit&gt;$thresholds&#8288;</code> and <code style="white-space: pre;">&#8288;&lt;IsingFit&gt;$weiadj&#8288;</code>).</p>
</td></tr>
<tr><td><code id="make_3d_Isingland_+3A_x">x</code>, <code id="make_3d_Isingland_+3A_y">y</code></td>
<td>
<p>Two vectors specifying the indices or the names of the
nodes for two categories.</p>
</td></tr>
<tr><td><code id="make_3d_Isingland_+3A_beta">beta</code></td>
<td>
<p>The <code class="reqn">\beta</code> value for calculating the Hamiltonian.</p>
</td></tr>
<tr><td><code id="make_3d_Isingland_+3A_transform">transform</code></td>
<td>
<p>By default, this function considers the Ising network
to use <code>-1</code> and <code>1</code> for two states. Set <code>transform = TRUE</code> if the Ising
network uses <code>0</code> and <code>1</code> for two states, <em>which is often the case for the
Ising networks estimated using</em> <code><a href="IsingFit.html#topic+isingfit">IsingFit::IsingFit()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;3d_Isingland&#8288;</code> object that contains the following components:
</p>

<ul>
<li> <p><code>dist_raw</code>,<code>dist</code> Two tibbles containing the probability
distribution and the potential values for different states.
</p>
</li>
<li> <p><code>thresholds</code>,<code>weiadj</code>,<code>beta</code> The parameters supplied to the function.
</p>
</li>
<li> <p><code>Nvar</code> The number of variables (nodes) in the Ising network.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+make_2d_Isingland">make_2d_Isingland()</a></code> for the algorithm.
</p>

<hr>
<h2 id='make_Ising_grid'>Make a Grid to Specify Multiple Ising Networks</h2><span id='topic+make_Ising_grid'></span>

<h3>Description</h3>

<p>Specify one or two varying parameters for
Ising networks. The output of <code>make_Ising_grid()</code> can be used to
make landscapes of multiple networks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_Ising_grid(par1, par2 = NULL, thresholds, weiadj, beta = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_Ising_grid_+3A_par1">par1</code>, <code id="make_Ising_grid_+3A_par2">par2</code></td>
<td>
<p>Generated from one of <code><a href="#topic+single_threshold">single_threshold()</a></code>,
<code><a href="#topic+all_thresholds">all_thresholds()</a></code>, <code><a href="#topic+single_wei">single_wei()</a></code><code style="white-space: pre;">&#8288;, [whole_weiadj()], or [beta_list()]. Use &#8288;</code>par2 = NULL' if you only
want to vary one parameter.</p>
</td></tr>
<tr><td><code id="make_Ising_grid_+3A_thresholds">thresholds</code>, <code id="make_Ising_grid_+3A_weiadj">weiadj</code></td>
<td>
<p>The thresholds and the weighted adjacency matrix
of the Ising network. If you have an <code>IsingFit</code> object estimated using
<code><a href="IsingFit.html#topic+isingfit">IsingFit::IsingFit()</a></code>, you can find those two parameters in its components
(<code style="white-space: pre;">&#8288;&lt;IsingFit&gt;$thresholds&#8288;</code> and <code style="white-space: pre;">&#8288;&lt;IsingFit&gt;$weiadj&#8288;</code>).</p>
</td></tr>
<tr><td><code id="make_Ising_grid_+3A_beta">beta</code></td>
<td>
<p>The <code class="reqn">\beta</code> value for calculating the Hamiltonian.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are five possible ways to vary the parameters for Ising networks,
corresponding to five control functions:
</p>

<ul>
<li> <p><code><a href="#topic+single_threshold">single_threshold()</a></code> Vary a threshold value for a single variable.
</p>
</li>
<li> <p><code><a href="#topic+all_thresholds">all_thresholds()</a></code> Vary all threshold values together.
</p>
</li>
<li> <p><code><a href="#topic+single_wei">single_wei()</a></code> Vary a single weight value for a path between two
variables.
</p>
</li>
<li> <p><code><a href="#topic+whole_weiadj">whole_weiadj()</a></code> Vary the whole weighted adjacency matrix.
</p>
</li>
<li> <p><code><a href="#topic+beta_list">beta_list()</a></code> Use a list of different beta values.
</p>
</li></ul>

<p>See <a href="#topic+make_Ising_grid-control-functions">make_Ising_grid-control-functions</a> for details.
</p>


<h3>Value</h3>

<p>An <code>Ising_grid</code> object that is based on a tibble and
contains the information of all simulation conditions.
</p>

<hr>
<h2 id='make_Ising_grid-control-functions'>Control Functions to Specify the Varying Parameters for
an Ising Grid.</h2><span id='topic+make_Ising_grid-control-functions'></span><span id='topic+single_threshold'></span><span id='topic+single_wei'></span><span id='topic+all_thresholds'></span><span id='topic+whole_weiadj'></span><span id='topic+beta_list'></span>

<h3>Description</h3>

<p>Control Functions to Specify the Varying Parameters for
an Ising Grid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>single_threshold(pos, seq, .f = `*`)

single_wei(pos, seq, .f = `*`)

all_thresholds(seq, .f = `*`)

whole_weiadj(seq, .f = `*`)

beta_list(seq, .f = `*`)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_Ising_grid-control-functions_+3A_pos">pos</code></td>
<td>
<p>The position of the single threshold or the weight
value that should vary across Ising networks. Should be a single
number for <code><a href="#topic+single_threshold">single_threshold()</a></code> or a numeric vector of
length 2 for <code><a href="#topic+single_wei">single_wei()</a></code>.</p>
</td></tr>
<tr><td><code id="make_Ising_grid-control-functions_+3A_seq">seq</code></td>
<td>
<p>A vector that specify the values. Can be generated
with <code><a href="base.html#topic+seq">base::seq()</a></code>.</p>
</td></tr>
<tr><td><code id="make_Ising_grid-control-functions_+3A_.f">.f</code></td>
<td>
<p>What calculation should be done for <code>seq</code>
and the original threshold value(s) or the original weight(ed
adjacency matrix)? <code>*</code> by default, which means the values supplied
in <code>seq</code> will be multiplied to the original value, vector, or matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code style="white-space: pre;">&#8288;ctrl_*&#8288;</code> object specifying the varying parameters.
</p>

<hr>
<h2 id='MDDNetwork'>Estimation data for the Ising network of major depressive disorder</h2><span id='topic+MDDNetwork'></span><span id='topic+MDDConnectivity'></span><span id='topic+MDDThresholds'></span>

<h3>Description</h3>

<p>Estimation data for the Ising network of major depressive disorder
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MDDConnectivity

MDDThresholds
</code></pre>


<h3>Format</h3>

<p>An object of class <code>matrix</code> (inherits from <code>array</code>) with 9 rows and 9 columns.
</p>
<p>An object of class <code>numeric</code> of length 9.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>MDDConnectivity</code>: The connectivity strength of the network,
represented in a weighted adjacency matrix.
</p>
</li>
<li> <p><code>MDDThresholds</code>: The thresholds of the network nodes,
represented in a vector.
</p>
</li></ul>


<h3>Source</h3>

<p><a href="https://figshare.com/projects/Major_depression_as_a_complex_dynamic_system_accepted_for_publication_in_PLoS_ONE_/17360">https://figshare.com/projects/Major_depression_as_a_complex_dynamic_system_accepted_for_publication_in_PLoS_ONE_/17360</a>
</p>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+autolayer'></span><span id='topic+calculate_barrier'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>ggplot2</dt><dd><p><code><a href="ggplot2.html#topic+autolayer">autolayer</a></code></p>
</dd>
<dt>simlandr</dt><dd><p><code><a href="simlandr.html#topic+calculate_barrier">calculate_barrier</a></code></p>
</dd>
</dl>

<hr>
<h2 id='shiny_Isingland_MDD'>A shiny app that shows the landscape for
the Ising network of major depressive disorder</h2><span id='topic+shiny_Isingland_MDD'></span>

<h3>Description</h3>

<p>A shiny app that shows the landscape for
the Ising network of major depressive disorder
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shiny_Isingland_MDD(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shiny_Isingland_MDD_+3A_...">...</code></td>
<td>
<p>Not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function opens a Shiny app session without a return value.
</p>

<hr>
<h2 id='simulate_Isingland'>Simulate a 2D Ising landscape</h2><span id='topic+simulate_Isingland'></span><span id='topic+simulate_Isingland.2d_Isingland'></span><span id='topic+simulate_Isingland.2d_Isingland_matrix'></span>

<h3>Description</h3>

<p>Perform a numeric simulation using the landscape. The simulation is performed
using a similar algorithm as Glauber dynamics, that the transition possibility
is determined by the difference in the potential function, and the steady-state
distribution is the same as the Boltzmann distribution (if not setting <code>beta2</code>).
Note that, the conditional transition possibility of this simulation
may be different from Glauber dynamics or other simulation methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_Isingland(l, ...)

## S3 method for class ''2d_Isingland''
simulate_Isingland(
  l,
  mode = "single",
  initial = 0,
  length = 100,
  beta2 = l$beta,
  ...
)

## S3 method for class ''2d_Isingland_matrix''
simulate_Isingland(
  l,
  mode = "single",
  initial = 0,
  length = 100,
  beta2 = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_Isingland_+3A_l">l</code></td>
<td>
<p>An <code>Isingland</code> object constructed with <code><a href="#topic+make_2d_Isingland">make_2d_Isingland()</a></code> or <code><a href="#topic+make_2d_Isingland_matrix">make_2d_Isingland_matrix()</a></code>.</p>
</td></tr>
<tr><td><code id="simulate_Isingland_+3A_...">...</code></td>
<td>
<p>Not in use.</p>
</td></tr>
<tr><td><code id="simulate_Isingland_+3A_mode">mode</code></td>
<td>
<p>One of <code>"single"</code>, <code>"distribution"</code>. Do you want to simulate
the state of a single system stochastically or simulate the distribution
of the states? <code>"single"</code> is used by default.</p>
</td></tr>
<tr><td><code id="simulate_Isingland_+3A_initial">initial</code></td>
<td>
<p>An integer indicating the initial number
of active nodes for the simulation. Float numbers will be
converted to an integer automatically.</p>
</td></tr>
<tr><td><code id="simulate_Isingland_+3A_length">length</code></td>
<td>
<p>An integer indicating the simulation length.</p>
</td></tr>
<tr><td><code id="simulate_Isingland_+3A_beta2">beta2</code></td>
<td>
<p>The <code class="reqn">beta</code> value used for simulation. By default use
the same value as for landscape construction. Manually setting this
value can make the system easier or more difficult to transition
to another state, but will alter the steady-state distribution as well.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In each simulation step, the system can have one more active node, one
less active node, or the same number of active nodes (if possible; so if all
nodes are already active then it is not possible to have one more active node).
The possibility of the three cases is determined by their potential function:
</p>
<p style="text-align: center;"><code class="reqn">P(n_{t}=b|n_{t-1}=a) = \frac{e^{-\beta U(b)}}{\sum_{i \in \{a-1,a,a+1\},0\leq i\leq N}e^{-\beta U(i)}}, \ \mathrm{if} \ b\in\{a-1,a,a+1\}\ \&amp;\ 0\leq i\leq N; 0, \mathrm{otherwise},</code>
</p>

<p>where <code class="reqn">n_{t}</code> is the number of active nodes at the time <code class="reqn">t</code>, and
<code class="reqn">U(n)</code> is the potential function.
</p>


<h3>Value</h3>

<p>A <code>sim_Isingland</code> object with the following components:
</p>

<ul>
<li> <p><code>output</code> A tibble of the simulation output.
</p>
</li>
<li> <p><code>landscape</code> The landscape object supplied to this function.
</p>
</li>
<li> <p><code>mode</code> A character representing the mode of the simulation.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
Nvar &lt;- 10
m &lt;- rep(0, Nvar)
w &lt;- matrix(0.1, Nvar, Nvar)
diag(w) &lt;- 0
result1 &lt;- make_2d_Isingland(m, w)
plot(result1)

set.seed(1614)
sim1 &lt;- simulate_Isingland(result1, initial = 5)
plot(sim1)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
