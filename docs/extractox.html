<!DOCTYPE html><html lang="en"><head><title>Help for package extractox</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {extractox}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#extr_casrn_from_cid'><p>Retrieve CASRN for PubChem CIDs</p></a></li>
<li><a href='#extr_chem_info'><p>Query Chemical Information from IUPAC Names</p></a></li>
<li><a href='#extr_comptox'><p>Download and Extract Data from CompTox Chemistry Dashboard</p></a></li>
<li><a href='#extr_ctd'><p>Extract Data from the CTD API</p></a></li>
<li><a href='#extr_ice'><p>Extract Data from NTP ICE Database</p></a></li>
<li><a href='#extr_ice_assay_names'><p>Extract Assay Names from the ICE Database</p></a></li>
<li><a href='#extr_iris'><p>Extract Data from EPA IRIS Database</p></a></li>
<li><a href='#extr_monograph'><p>Retrieve WHO IARC Monograph Information</p></a></li>
<li><a href='#extr_pprtv'><p>Extract Data from EPA PPRTVs</p></a></li>
<li><a href='#extr_pubchem_fema'><p>Extract FEMA from PubChem</p></a></li>
<li><a href='#extr_pubchem_ghs'><p>Extract GHS Codes from PubChem</p></a></li>
<li><a href='#extr_tetramer'><p>Extract Tetramer Data from the CTD API</p></a></li>
<li><a href='#extr_tox'><p>Extract Toxicological Information from Multiple Databases</p></a></li>
<li><a href='#search_and_match'><p>Search and Match Data</p></a></li>
<li><a href='#with_extr_sandbox'><p>Run Code in a Temporary Sandbox Environment</p></a></li>
<li><a href='#write_dataframes_to_excel'><p>Write Dataframes to Excel</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Extract Tox Info from Various Databases</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Extract toxicological and chemical information from databases
    maintained by scientific agencies and resources, including the
    Comparative Toxicogenomics Database <a href="https://ctdbase.org/">https://ctdbase.org/</a>, the
    Integrated Chemical Environment <a href="https://ice.ntp.niehs.nih.gov/">https://ice.ntp.niehs.nih.gov/</a>, the
    Integrated Risk Information System <a href="https://cfpub.epa.gov/ncea/iris/">https://cfpub.epa.gov/ncea/iris/</a>,
    Provisional Peer-Reviewed Toxicity Values
    <a href="https://www.epa.gov/pprtv/provisional-peer-reviewed-toxicity-values-pprtvs-assessments">https://www.epa.gov/pprtv/provisional-peer-reviewed-toxicity-values-pprtvs-assessments</a>,
    the CompTox Chemicals Dashboard Resource Hub
    <a href="https://www.epa.gov/comptox-tools/comptox-chemicals-dashboard-resource-hub">https://www.epa.gov/comptox-tools/comptox-chemicals-dashboard-resource-hub</a>,
    PubChem <a href="https://pubchem.ncbi.nlm.nih.gov/">https://pubchem.ncbi.nlm.nih.gov/</a>, and others.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/c1au6i0/extractox">https://github.com/c1au6i0/extractox</a>,
<a href="https://c1au6i0.github.io/extractox/">https://c1au6i0.github.io/extractox/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/c1au6i0/extractox/issues">https://github.com/c1au6i0/extractox/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>cli, httr2, janitor, pingr, readxl, rvest, webchem, withr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>openxlsx, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-07 16:34:03 UTC; heverz</td>
</tr>
<tr>
<td>Author:</td>
<td>Claudio Zanettini <a href="https://orcid.org/0000-0001-5043-8033"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Lucio Queiroz <a href="https://orcid.org/0000-0002-6090-1834"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Claudio Zanettini &lt;claudio.zanettini@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-07 16:50:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='extr_casrn_from_cid'>Retrieve CASRN for PubChem CIDs</h2><span id='topic+extr_casrn_from_cid'></span>

<h3>Description</h3>

<p>This function retrieves the CASRN for a given set of PubChem Compound Identifiers (CID).
It queries PubChem through the <code>webchem</code> package and extracts the CASRN from
the depositor-supplied synonyms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extr_casrn_from_cid(pubchem_ids, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extr_casrn_from_cid_+3A_pubchem_ids">pubchem_ids</code></td>
<td>
<p>A numeric vector of PubChem CIDs. These are unique identifiers
for chemical compounds in the PubChem database.</p>
</td></tr>
<tr><td><code id="extr_casrn_from_cid_+3A_verbose">verbose</code></td>
<td>
<p>A logical value indicating whether to print detailed messages.
Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the CID, CASRN, and IUPAC name of the compound.
The returned data frame includes three columns:
</p>

<dl>
<dt>CID</dt><dd><p>The PubChem Compound Identifier.</p>
</dd>
<dt>casrn</dt><dd><p>The corresponding CASRN of the compound.</p>
</dd>
<dt>iupac_name</dt><dd><p>The IUPAC name of the compound.</p>
</dd>
<dt>query</dt><dd><p>The pubchem_id queried.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><a href="https://pubchem.ncbi.nlm.nih.gov/">PubChem</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example with formaldehyde and aflatoxin
cids &lt;- c(712, 14434) # CID for formaldehyde and aflatoxin B1
extr_casrn_from_cid(cids)

</code></pre>

<hr>
<h2 id='extr_chem_info'>Query Chemical Information from IUPAC Names</h2><span id='topic+extr_chem_info'></span>

<h3>Description</h3>

<p>This function takes a vector of IUPAC names and queries the PubChem database
(using the <code>webchem</code> package) to obtain the corresponding CASRN and CID for
each compound. It reshapes the resulting data, ensuring that each compound has
a unique row with the CID, CASRN, and additional chemical properties.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extr_chem_info(iupac_names, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extr_chem_info_+3A_iupac_names">iupac_names</code></td>
<td>
<p>A character vector of IUPAC names. These are standardized names
of chemical compounds that will be used to search in the PubChem database.</p>
</td></tr>
<tr><td><code id="extr_chem_info_+3A_verbose">verbose</code></td>
<td>
<p>A logical value indicating whether to print detailed messages.
Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with phisio-chemical information on the queried compounds,
including but not limited to:
</p>

<dl>
<dt>iupac_name</dt><dd><p>The IUPAC name of the compound.</p>
</dd>
<dt>cid</dt><dd><p>The PubChem Compound Identifier (CID).</p>
</dd>
<dt>isomeric_smiles</dt><dd><p>The SMILES string (Simplified Molecular Input Line
Entry System).</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
# Example with formaldehyde and aflatoxin
extr_chem_info(iupac_names = c("Formaldehyde", "Aflatoxin B1"))

</code></pre>

<hr>
<h2 id='extr_comptox'>Download and Extract Data from CompTox Chemistry Dashboard</h2><span id='topic+extr_comptox'></span>

<h3>Description</h3>

<p>This function interacts with the CompTox Chemistry Dashboard to download and
extract a wide range of chemical data based on user-defined search criteria.
It allows for flexible input types and supports downloading various chemical
properties, identifiers, and predictive data. It was inspired by the
<code>ECOTOXr::websearch_comptox</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extr_comptox(
  ids,
  download_items = c("CASRN", "INCHIKEY", "IUPAC_NAME", "SMILES", "INCHI_STRING",
    "MS_READY_SMILES", "QSAR_READY_SMILES", "MOLECULAR_FORMULA", "AVERAGE_MASS",
    "MONOISOTOPIC_MASS", "QC_LEVEL", "SAFETY_DATA", "EXPOCAST", "DATA_SOURCES",
    "TOXVAL_DATA", "NUMBER_OF_PUBMED_ARTICLES", "PUBCHEM_DATA_SOURCES", "CPDAT_COUNT",
    "IRIS_LINK", "PPRTV_LINK", "WIKIPEDIA_ARTICLE", "QC_NOTES", "ABSTRACT_SHIFTER",
    "TOXPRINT_FINGERPRINT", "ACTOR_REPORT", "SYNONYM_IDENTIFIER", "RELATED_RELATIONSHIP",
    "ASSOCIATED_TOXCAST_ASSAYS", "TOXVAL_DETAILS", 
     "CHEMICAL_PROPERTIES_DETAILS",
    "BIOCONCENTRATION_FACTOR_TEST_PRED", "BOILING_POINT_DEGC_TEST_PRED",
    "48HR_DAPHNIA_LC50_MOL/L_TEST_PRED", "DENSITY_G/CM^3_TEST_PRED", "DEVTOX_TEST_PRED",
    "96HR_FATHEAD_MINNOW_MOL/L_TEST_PRED", "FLASH_POINT_DEGC_TEST_PRED",
    "MELTING_POINT_DEGC_TEST_PRED", "AMES_MUTAGENICITY_TEST_PRED",
    "ORAL_RAT_LD50_MOL/KG_TEST_PRED", "SURFACE_TENSION_DYN/CM_TEST_PRED",
    "THERMAL_CONDUCTIVITY_MW/(M*K)_TEST_PRED",
    "TETRAHYMENA_PYRIFORMIS_IGC50_MOL/L_TEST_PRED", "VISCOSITY_CP_CP_TEST_PRED", 
    
    "VAPOR_PRESSURE_MMHG_TEST_PRED", "WATER_SOLUBILITY_MOL/L_TEST_PRED",
    "ATMOSPHERIC_HYDROXYLATION_RATE_(AOH)_CM3/MOLECULE*SEC_OPERA_PRED",
    "BIOCONCENTRATION_FACTOR_OPERA_PRED",
    "BIODEGRADATION_HALF_LIFE_DAYS_DAYS_OPERA_PRED", "BOILING_POINT_DEGC_OPERA_PRED",
    "HENRYS_LAW_ATM-M3/MOLE_OPERA_PRED", "OPERA_KM_DAYS_OPERA_PRED",
    "OCTANOL_AIR_PARTITION_COEFF_LOGKOA_OPERA_PRED",
    "SOIL_ADSORPTION_COEFFICIENT_KOC_L/KG_OPERA_PRED",
    "OCTANOL_WATER_PARTITION_LOGP_OPERA_PRED", "MELTING_POINT_DEGC_OPERA_PRED", 
    
    "OPERA_PKAA_OPERA_PRED", "OPERA_PKAB_OPERA_PRED", "VAPOR_PRESSURE_MMHG_OPERA_PRED",
    "WATER_SOLUBILITY_MOL/L_OPERA_PRED",
    "EXPOCAST_MEDIAN_EXPOSURE_PREDICTION_MG/KG-BW/DAY", "NHANES",
    "TOXCAST_NUMBER_OF_ASSAYS/TOTAL", "TOXCAST_PERCENT_ACTIVE"),
  mass_error = 0,
  verify_ssl = FALSE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extr_comptox_+3A_ids">ids</code></td>
<td>
<p>A character vector containing the items to be searched within the
CompTox Chemistry Dashboard. These can be chemical names, CAS Registry Numbers
(CASRN), InChIKeys, or DSSTox substance identifiers (DTXSID).</p>
</td></tr>
<tr><td><code id="extr_comptox_+3A_download_items">download_items</code></td>
<td>
<p>A character vector of items to be downloaded.
This includes a comprehensive set of chemical properties, identifiers, predictive
data, and other relevant information. By Default, it download all the info
</p>

<dl>
<dt>CASRN</dt><dd><p>The Chemical Abstracts Service Registry Number, a unique numerical
identifier for chemical substances.</p>
</dd>
<dt>INCHIKEY</dt><dd><p>The hashed version of the full International Chemical
Identifier (InChI) string.</p>
</dd>
<dt>IUPAC_NAME</dt><dd><p>The International Union of Pure and Applied Chemistry
(IUPAC) name of the chemical.</p>
</dd>
<dt>SMILES</dt><dd><p>The Simplified Molecular Input Line Entry System (SMILES)
representation of the chemical structure.</p>
</dd>
<dt>INCHI_STRING</dt><dd><p>The full International Chemical Identifier (InChI) string.</p>
</dd>
<dt>MS_READY_SMILES</dt><dd><p>The SMILES representation of the chemical structure,
prepared for mass spectrometry analysis.</p>
</dd>
<dt>QSAR_READY_SMILES</dt><dd><p>The SMILES representation of the chemical structure,
prepared for quantitative structure-activity relationship (QSAR) modeling.</p>
</dd>
<dt>MOLECULAR_FORMULA</dt><dd><p>The chemical formula representing the number and type
of atoms in a molecule.</p>
</dd>
<dt>AVERAGE_MASS</dt><dd><p>The average mass of the molecule, calculated based on the
isotopic distribution of the elements.</p>
</dd>
<dt>MONOISOTOPIC_MASS</dt><dd><p>The mass of the molecule calculated using the most
abundant isotope of each element.</p>
</dd>
<dt>QC_LEVEL</dt><dd><p>The quality control level of the data.</p>
</dd>
<dt>SAFETY_DATA</dt><dd><p>Safety information related to the chemical.</p>
</dd>
<dt>EXPOCAST</dt><dd><p>Exposure predictions from the EPA's ExpoCast program.</p>
</dd>
<dt>DATA_SOURCES</dt><dd><p>Sources of the data provided.</p>
</dd>
<dt>TOXVAL_DATA</dt><dd><p>Toxicological values related to the chemical.</p>
</dd>
<dt>NUMBER_OF_PUBMED_ARTICLES</dt><dd><p>The number of articles related to the chemical
in PubMed.</p>
</dd>
<dt>PUBCHEM_DATA_SOURCES</dt><dd><p>Sources of data from PubChem.</p>
</dd>
<dt>CPDAT_COUNT</dt><dd><p>The number of entries in the Chemical and Product Categories
Database (CPDat).</p>
</dd>
<dt>IRIS_LINK</dt><dd><p>Link to the EPA's Integrated Risk Information System (IRIS)
entry for the chemical.</p>
</dd>
<dt>PPRTV_LINK</dt><dd><p>Link to the EPA's Provisional Peer-Reviewed Toxicity Values
(PPRTV) entry for the chemical.</p>
</dd>
<dt>WIKIPEDIA_ARTICLE</dt><dd><p>Link to the Wikipedia article for the chemical.</p>
</dd>
<dt>QC_NOTES</dt><dd><p>Notes related to the quality control of the data.</p>
</dd>
<dt>ABSTRACT_SHIFTER</dt><dd><p>Information related to the abstract shifter.</p>
</dd>
<dt>TOXPRINT_FINGERPRINT</dt><dd><p>The ToxPrint chemoinformatics fingerprint of the chemical.</p>
</dd>
<dt>ACTOR_REPORT</dt><dd><p>The Aggregated Computational Toxicology Resource (ACTOR)
report for the chemical.</p>
</dd>
<dt>SYNONYM_IDENTIFIER</dt><dd><p>Identifiers for synonyms of the chemical.</p>
</dd>
<dt>RELATED_RELATIONSHIP</dt><dd><p>Information on related chemicals.</p>
</dd>
<dt>ASSOCIATED_TOXCAST_ASSAYS</dt><dd><p>Assays associated with the chemical
in the ToxCast database.</p>
</dd>
<dt>TOXVAL_DETAILS</dt><dd><p>Details of toxicological values.</p>
</dd>
<dt>CHEMICAL_PROPERTIES_DETAILS</dt><dd><p>Details of the chemical properties.</p>
</dd>
<dt>BIOCONCENTRATION_FACTOR_TEST_PRED</dt><dd><p>Predicted bioconcentration factor from
tests.</p>
</dd>
<dt>BOILING_POINT_DEGC_TEST_PRED</dt><dd><p>Predicted boiling point in degrees Celsius
from tests.</p>
</dd>
<dt>48HR_DAPHNIA_LC50_MOL/L_TEST_PRED</dt><dd><p>Predicted 48-hour LC50 for Daphnia
in mol/L from tests.</p>
</dd>
<dt>DENSITY_G/CM^3_TEST_PRED</dt><dd><p>Predicted density in g/cm³ from tests.</p>
</dd>
<dt>DEVTOX_TEST_PRED</dt><dd><p>Predicted developmental toxicity from tests.</p>
</dd>
<dt>96HR_FATHEAD_MINNOW_MOL/L_TEST_PRED</dt><dd><p>Predicted 96-hour LC50 for fathead
minnow in mol/L from tests.</p>
</dd>
<dt>FLASH_POINT_DEGC_TEST_PRED</dt><dd><p>Predicted flash point in degrees Celsius
from tests.</p>
</dd>
<dt>MELTING_POINT_DEGC_TEST_PRED</dt><dd><p>Predicted melting point in degrees Celsius
from tests.</p>
</dd>
<dt>AMES_MUTAGENICITY_TEST_PRED</dt><dd><p>Predicted Ames mutagenicity from tests.</p>
</dd>
<dt>ORAL_RAT_LD50_MOL/KG_TEST_PRED</dt><dd><p>Predicted oral LD50 for rats in mol/kg
from tests.</p>
</dd>
<dt>SURFACE_TENSION_DYN/CM_TEST_PRED</dt><dd><p>Predicted surface tension in dyn/cm
from tests.</p>
</dd>
<dt>THERMAL_CONDUCTIVITY_MW_M×K_TEST_PRED</dt><dd><p>Predicted thermal conductivity
in mW/m×K from tests.</p>
</dd>
<dt>TETRAHYMENA_PYRIFORMIS_IGC50_MOL/L_TEST_PRED</dt><dd><p>Predicted IGC50 for Tetrahymena
pyriformis in mol/L from tests.</p>
</dd>
<dt>VISCOSITY_CP_CP_TEST_PRED</dt><dd><p>Predicted viscosity in cP from tests.</p>
</dd>
<dt>VAPOR_PRESSURE_MMHG_TEST_PRED</dt><dd><p>Predicted vapor pressure in mmHg from
tests.</p>
</dd>
<dt>WATER_SOLUBILITY_MOL/L_TEST_PRED</dt><dd><p>Predicted water solubility in mol/L
from tests.</p>
</dd>
<dt>ATMOSPHERIC_HYDROXYLATION_RATE_\(AOH\)_CM3/MOLECULE\*SEC_OPERA_PRED</dt><dd><p>Predicted
atmospheric hydroxylation rate in cm³/molecule\*sec from OPERA.</p>
</dd>
<dt>BIOCONCENTRATION_FACTOR_OPERA_PRED</dt><dd><p>Predicted bioconcentration factor from OPERA.</p>
</dd>
<dt>BIODEGRADATION_HALF_LIFE_DAYS_DAYS_OPERA_PRED</dt><dd><p>Predicted biodegradation
half-life in days from OPERA.</p>
</dd>
<dt>BOILING_POINT_DEGC_OPERA_PRED</dt><dd><p>Predicted boiling point in degrees
Celsius from OPERA.</p>
</dd>
<dt>HENRYS_LAW_ATM-M3/MOLE_OPERA_PRED</dt><dd><p>Predicted Henry's law constant
in atm-m³/mole from OPERA.</p>
</dd>
<dt>OPERA_KM_DAYS_OPERA_PRED</dt><dd><p>Predicted Km in days from OPERA.</p>
</dd>
<dt>OCTANOL_AIR_PARTITION_COEFF_LOGKOA_OPERA_PRED</dt><dd><p>Predicted octanol-air
partition coefficient (log Koa) from OPERA.</p>
</dd>
<dt>SOIL_ADSORPTION_COEFFICIENT_KOC_L/KG_OPERA_PRED</dt><dd><p>Predicted soil adsorption
coefficient (Koc) in L/kg from OPERA.</p>
</dd>
<dt>OCTANOL_WATER_PARTITION_LOGP_OPERA_PRED</dt><dd><p>Predicted octanol-water partition
coefficient (log P) from OPERA.</p>
</dd>
<dt>MELTING_POINT_DEGC_OPERA_PRED</dt><dd><p>Predicted melting point in degrees Celsius
from OPERA.</p>
</dd>
<dt>OPERA_PKAA_OPERA_PRED</dt><dd><p>Predicted pKa (acidic) from OPERA.</p>
</dd>
<dt>OPERA_PKAB_OPERA_PRED</dt><dd><p>Predicted pKa (basic) from OPERA.</p>
</dd>
<dt>VAPOR_PRESSURE_MMHG_OPERA_PRED</dt><dd><p>Predicted vapor pressure in mmHg from
OPERA.</p>
</dd>
<dt>WATER_SOLUBILITY_MOL/L_OPERA_PRED</dt><dd><p>Predicted water solubility in mol/L
from OPERA.</p>
</dd>
<dt>EXPOCAST_MEDIAN_EXPOSURE_PREDICTION_MG/KG-BW/DAY</dt><dd><p>Predicted median
exposure from ExpoCast in mg/kg-bw/day.</p>
</dd>
<dt>NHANES</dt><dd><p>National Health and Nutrition Examination Survey data.</p>
</dd>
<dt>TOXCAST_NUMBER_OF_ASSAYS/TOTAL</dt><dd><p>Number of assays in ToxCast.</p>
</dd>
<dt>TOXCAST_PERCENT_ACTIVE</dt><dd><p>Percentage of active assays in ToxCast.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="extr_comptox_+3A_mass_error">mass_error</code></td>
<td>
<p>Numeric value indicating the mass error tolerance for searches
involving mass data. Default is <code>0</code>.</p>
</td></tr>
<tr><td><code id="extr_comptox_+3A_verify_ssl">verify_ssl</code></td>
<td>
<p>Logical value indicating whether SSL certificates should be
verified. Default is <code>FALSE</code>. Note that this argument is not used on linux OS.</p>
</td></tr>
<tr><td><code id="extr_comptox_+3A_verbose">verbose</code></td>
<td>
<p>A logical value indicating whether to print detailed messages.
Default is TRUE.</p>
</td></tr>
<tr><td><code id="extr_comptox_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>httr2::req_options()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Please note that this function, which pulls data from EPA servers, may encounter
issues on some Linux systems. This is because those servers do not accept secure
legacy renegotiation. On Linux systems, the current function depends on <code>curl</code>
and <code>OpenSSL</code>, which have known problems with unsafe legacy renegotiation
in newer versions. One workaround is to downgrade to <code>curl v7.78.0</code> and
<code>OpenSSL v1.1.1</code>. However, please be aware that using these older versions
might introduce potential security vulnerabilities. Refer to
<a href="https://gist.github.com/c1au6i0/5cc2d87966340a31032ffebf1cfb657c">this gist</a>
for instructions on how to downgrade <code>curl</code> and <code>OpenSSL</code> on Ubuntu.
</p>


<h3>Value</h3>

<p>A cleaned data frame containing the requested data from CompTox.
</p>


<h3>See Also</h3>

<p><a href="https://www.epa.gov/comptox-tools/comptox-chemicals-dashboard-resource-hub">CompTox Chemicals Dashboard Resource Hub</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example usage of the function:
extr_comptox(ids = c("Aspirin", "50-00-0"))

</code></pre>

<hr>
<h2 id='extr_ctd'>Extract Data from the CTD API</h2><span id='topic+extr_ctd'></span>

<h3>Description</h3>

<p>This function queries the Comparative Toxicogenomics Database API to retrieve data related to chemicals, diseases, genes, or other categories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extr_ctd(
  input_terms,
  category = "chem",
  report_type = "genes_curated",
  input_term_search_type = "directAssociations",
  action_types = NULL,
  ontology = NULL,
  verify_ssl = FALSE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extr_ctd_+3A_input_terms">input_terms</code></td>
<td>
<p>A character vector of input terms such as CAS numbers or IUPAC names.</p>
</td></tr>
<tr><td><code id="extr_ctd_+3A_category">category</code></td>
<td>
<p>A string specifying the category of data to query. Valid options
are &quot;all&quot;, &quot;chem&quot;, &quot;disease&quot;, &quot;gene&quot;, &quot;go&quot;, &quot;pathway&quot;, &quot;reference&quot;, and &quot;taxon&quot;.
Default is &quot;chem&quot;.</p>
</td></tr>
<tr><td><code id="extr_ctd_+3A_report_type">report_type</code></td>
<td>
<p>A string specifying the type of report to return. Default is
&quot;genes_curated&quot;. Valid options include:
</p>

<dl>
<dt>&quot;cgixns&quot;</dt><dd><p>Curated chemical-gene interactions. Requires at least one
<code>action_types</code> parameter.</p>
</dd>
<dt>&quot;chems&quot;</dt><dd><p>All chemical associations.</p>
</dd>
<dt>&quot;chems_curated&quot;</dt><dd><p>Curated chemical associations.</p>
</dd>
<dt>&quot;chems_inferred&quot;</dt><dd><p>Inferred chemical associations.</p>
</dd>
<dt>&quot;genes&quot;</dt><dd><p>All gene associations.</p>
</dd>
<dt>&quot;genes_curated&quot;</dt><dd><p>Curated gene associations.</p>
</dd>
<dt>&quot;genes_inferred&quot;</dt><dd><p>Inferred gene associations.</p>
</dd>
<dt>&quot;diseases&quot;</dt><dd><p>All disease associations.</p>
</dd>
<dt>&quot;diseases_curated&quot;</dt><dd><p>Curated disease associations.</p>
</dd>
<dt>&quot;diseases_inferred&quot;</dt><dd><p>Inferred disease associations.</p>
</dd>
<dt>&quot;pathways_curated&quot;</dt><dd><p>Curated pathway associations.</p>
</dd>
<dt>&quot;pathways_inferred&quot;</dt><dd><p>Inferred pathway associations.</p>
</dd>
<dt>&quot;pathways_enriched&quot;</dt><dd><p>Enriched pathway associations.</p>
</dd>
<dt>&quot;phenotypes_curated&quot;</dt><dd><p>Curated phenotype associations.</p>
</dd>
<dt>&quot;phenotypes_inferred&quot;</dt><dd><p>Inferred phenotype associations.</p>
</dd>
<dt>&quot;go&quot;</dt><dd><p>All Gene Ontology (GO) associations. Requires at least one
<code>ontology</code> parameter.</p>
</dd>
<dt>&quot;go_enriched&quot;</dt><dd><p>Enriched GO associations. Requires at least one
<code>ontology</code> parameter.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="extr_ctd_+3A_input_term_search_type">input_term_search_type</code></td>
<td>
<p>A string specifying the search method to use.
Options are &quot;hierarchicalAssociations&quot; or &quot;directAssociations&quot;. Default is
&quot;directAssociations&quot;.</p>
</td></tr>
<tr><td><code id="extr_ctd_+3A_action_types">action_types</code></td>
<td>
<p>An optional character vector specifying one or more interaction
types for filtering results. Default is &quot;ANY&quot;.
Other acceptable inputs are &quot;abundance&quot;, &quot;activity&quot;, &quot;binding&quot;, &quot;cotreatment&quot;,
&quot;expression&quot;, &quot;folding&quot;, &quot;localization&quot;, &quot;metabolic processing&quot;...
See https://ctdbase.org/tools/batchQuery.go for a full list.</p>
</td></tr>
<tr><td><code id="extr_ctd_+3A_ontology">ontology</code></td>
<td>
<p>An optional character vector specifying one or more ontologies
for filtering GO reports. Default NULL.</p>
</td></tr>
<tr><td><code id="extr_ctd_+3A_verify_ssl">verify_ssl</code></td>
<td>
<p>Boolean to control of SSL should be verified or not.</p>
</td></tr>
<tr><td><code id="extr_ctd_+3A_verbose">verbose</code></td>
<td>
<p>A logical value indicating whether to print detailed messages.
Default is TRUE.</p>
</td></tr>
<tr><td><code id="extr_ctd_+3A_...">...</code></td>
<td>
<p>Any other arguments to be supplied to <code>req_option</code> and thus to <code>libcurl</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the queried data in CSV format.
</p>


<h3>References</h3>


<ul>
<li><p> Davis, A. P., Grondin, C. J., Johnson, R. J., Sciaky, D., McMorran, R.,
Wiegers, T. C., &amp; Mattingly, C. J. (2019).
The Comparative Toxicogenomics Database: update 2019. Nucleic acids research,
47(D1), D948–D954. <a href="https://doi.org/10.1093/nar/gky868">doi:10.1093/nar/gky868</a>
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="http://ctdbase.org">Comparative Toxicogenomics Database</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
input_terms &lt;- c("50-00-0", "64-17-5", "methanal", "ethanol")
dat &lt;- extr_ctd(
  input_terms = input_terms,
  category = "chem",
  report_type = "genes_curated",
  input_term_search_type = "directAssociations",
  action_types = "ANY",
  ontology = c("go_bp", "go_cc")
)
str(dat)

# Get expresssion data
dat2 &lt;- extr_ctd(
  input_terms = input_terms,
  report_type = "cgixns",
  category = "chem",
  action_types = "expression"
)

str(dat2)

</code></pre>

<hr>
<h2 id='extr_ice'>Extract Data from NTP ICE Database</h2><span id='topic+extr_ice'></span>

<h3>Description</h3>

<p>The <code>extr_ice</code> function sends a POST request to the ICE API to search for
information based on specified chemical IDs and assays.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extr_ice(casrn, assays = NULL, verify_ssl = FALSE, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extr_ice_+3A_casrn">casrn</code></td>
<td>
<p>A character vector specifying the CASRNs for the search.</p>
</td></tr>
<tr><td><code id="extr_ice_+3A_assays">assays</code></td>
<td>
<p>A character vector specifying the assays to include in the
search. Default is NULL, meaning all assays are included. If you don't
know the exact assay name, you can use the <code>extr_ice_assay_names()</code>
function to search for assay names that match a pattern you're interested in.</p>
</td></tr>
<tr><td><code id="extr_ice_+3A_verify_ssl">verify_ssl</code></td>
<td>
<p>Boolean to control of SSL should be verified or not.</p>
</td></tr>
<tr><td><code id="extr_ice_+3A_verbose">verbose</code></td>
<td>
<p>A logical value indicating whether to print detailed messages.
Default is TRUE.</p>
</td></tr>
<tr><td><code id="extr_ice_+3A_...">...</code></td>
<td>
<p>Any other arguments to be supplied to <code>req_option</code> and
thus to <code>libcurl</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the extracted data from the ICE API.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+extr_ice_assay_names">extr_ice_assay_names</a></code>,
<a href="https://ice.ntp.niehs.nih.gov/">NTP ICE database</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
extr_ice(casrn = c("50-00-0"))

</code></pre>

<hr>
<h2 id='extr_ice_assay_names'>Extract Assay Names from the ICE Database</h2><span id='topic+extr_ice_assay_names'></span>

<h3>Description</h3>

<p>This function allows users to search for assay names in the ICE database
using a regular expression. If no search pattern is provided (<code>regex = NULL</code>),
it returns all available assay names.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extr_ice_assay_names(regex = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extr_ice_assay_names_+3A_regex">regex</code></td>
<td>
<p>A character string containing the regular expression to search for,
or <code>NULL</code> to retrieve all assay names.</p>
</td></tr>
<tr><td><code id="extr_ice_assay_names_+3A_verbose">verbose</code></td>
<td>
<p>A logical value indicating whether to print detailed messages.
Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of matching assay names.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
extr_ice_assay_names("OPERA")
extr_ice_assay_names(NULL)
extr_ice_assay_names("Vivo")

</code></pre>

<hr>
<h2 id='extr_iris'>Extract Data from EPA IRIS Database</h2><span id='topic+extr_iris'></span>

<h3>Description</h3>

<p>The <code>extr_iris</code> function sends a request to the EPA IRIS database to search
for information based on a specified keywords and cancer types. It retrieves
and parses the HTML content from the response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extr_iris(casrn = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extr_iris_+3A_casrn">casrn</code></td>
<td>
<p>A vector CASRN for the search.</p>
</td></tr>
<tr><td><code id="extr_iris_+3A_verbose">verbose</code></td>
<td>
<p>A logical value indicating whether to print detailed messages.
Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the extracted data.
</p>


<h3>See Also</h3>

<p><a href="https://cfpub.epa.gov/ncea/iris/search/">EPA IRIS database</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
extr_iris(casrn = c("1332-21-4", "50-00-0"))

</code></pre>

<hr>
<h2 id='extr_monograph'>Retrieve WHO IARC Monograph Information</h2><span id='topic+extr_monograph'></span>

<h3>Description</h3>

<p>This function returns information regarding Monographs from the World Health
Organization (WHO) International Agency for Research on Cancer (IARC)  based on
CAS Registry Number or Name of the chemical. Note that the data is not fetched
dynamically from the website, but has retrieved and  copy hasbeen saved as
internal data in the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extr_monograph(ids, search_type = "casrn", verbose = TRUE, get_all = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extr_monograph_+3A_ids">ids</code></td>
<td>
<p>A character vector of IDs to search for.</p>
</td></tr>
<tr><td><code id="extr_monograph_+3A_search_type">search_type</code></td>
<td>
<p>A character string specifying the type of search to
perform. Valid options are &quot;casrn&quot; (CAS Registry Number) and &quot;name&quot;
.  (name of the chemical). If <code>search_type</code> is &quot;casrn&quot;, the function filters
.  by the CAS Registry Number.
If <code>search_type</code> is &quot;name&quot;, the function performs a partial match search
for the chemical name.</p>
</td></tr>
<tr><td><code id="extr_monograph_+3A_verbose">verbose</code></td>
<td>
<p>A logical value indicating whether to print detailed messages.
.   Default is TRUE.</p>
</td></tr>
<tr><td><code id="extr_monograph_+3A_get_all">get_all</code></td>
<td>
<p>Logical. If TRUE ignore all the other ignore <code>ids</code>,
<code>search_type</code>, set  <code>force = TRUE</code> and get the all dataset.
This is was introduced for debugging purposes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the relevant information from the WHO IARC,
.  including Monograph <code>volume</code>, <code>volume_publication_year</code>, <code>evaluation_year</code>,
.  and <code>additional_information</code> where the chemical was described.
</p>


<h3>See Also</h3>

<p><a href="https://monographs.iarc.who.int/list-of-classifications/">https://monographs.iarc.who.int/list-of-classifications/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
  dat &lt;- extr_monograph(search_type = "casrn", ids = c("105-74-8", "120-58-1"))
  str(dat)

  # Example usage for name search
  dat2 &lt;- extr_monograph(
    search_type = "name",
    ids = c("Aloe", "Schistosoma", "Styrene")
  )
  str(dat2)
}
</code></pre>

<hr>
<h2 id='extr_pprtv'>Extract Data from EPA PPRTVs</h2><span id='topic+extr_pprtv'></span>

<h3>Description</h3>

<p>Extracts data for specified identifiers (CASRN or chemical names) from the EPA's
Provisional Peer-Reviewed Toxicity Values (PPRTVs) database. The function
retrieves and processes data, with options to use cached files or force a
fresh download.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extr_pprtv(
  ids,
  search_type = "casrn",
  verbose = TRUE,
  force = TRUE,
  get_all = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extr_pprtv_+3A_ids">ids</code></td>
<td>
<p>Character vector of identifiers to search (e.g., CASRN or chemical
names).</p>
</td></tr>
<tr><td><code id="extr_pprtv_+3A_search_type">search_type</code></td>
<td>
<p>Character string specifying the type of identifier: &quot;casrn&quot;
or &quot;name&quot;.
Default is &quot;casrn&quot;. If <code>search_type</code> is &quot;name&quot;, the function performs a
partial match search for the chemical name. NOTE: Since partial mached is
use, multiple seraches might match the same chemical, therefore chemical ids
might not be  uniques.</p>
</td></tr>
<tr><td><code id="extr_pprtv_+3A_verbose">verbose</code></td>
<td>
<p>Logical indicating whether to display progress messages.
Default is TRUE.</p>
</td></tr>
<tr><td><code id="extr_pprtv_+3A_force">force</code></td>
<td>
<p>Logical indicating whether to force a fresh download of the
database. Default is TRUE.</p>
</td></tr>
<tr><td><code id="extr_pprtv_+3A_get_all">get_all</code></td>
<td>
<p>Logical. If TRUE ignore all the other ignore <code>ids</code>,
<code>search_type</code>, set  <code>force = TRUE</code> and get the all dataset.
This is was introduced for debugging purposes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with extracted information matching the specified
identifiers, or NULL if no matches are found.
</p>


<h3>See Also</h3>

<p><a href="https://www.epa.gov/pprtv/provisional-peer-reviewed-toxicity-values-pprtvs-assessments">EPA PPRTVs</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
with_extr_sandbox({ # this is to write on tempdir as for CRAN policies
  # Extract data for a specific CASRN
  extr_pprtv(ids = "107-02-8", search_type = "casrn", verbose = TRUE)

  # Extract data for a chemical name
  extr_pprtv(
    ids = "Acrolein", search_type = "name", verbose = TRUE,
    force = FALSE
  )

  # Extract data for multiple identifiers
  extr_pprtv(
    ids = c("107-02-8", "79-10-7", "42576-02-3"),
    search_type = "casrn",
    verbose = TRUE,
    force = FALSE
  )
})

</code></pre>

<hr>
<h2 id='extr_pubchem_fema'>Extract FEMA from PubChem</h2><span id='topic+extr_pubchem_fema'></span>

<h3>Description</h3>

<p>This function retrieves FEMA (Flavor and Extract Manufacturers Association)
flavor profile information for a list of CAS Registry Numbers (CASRN) from
the PubChem database using the <code>webchem</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extr_pubchem_fema(casrn, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extr_pubchem_fema_+3A_casrn">casrn</code></td>
<td>
<p>A vector of CAS Registry Numbers (CASRN) as atomic vectors.</p>
</td></tr>
<tr><td><code id="extr_pubchem_fema_+3A_verbose">verbose</code></td>
<td>
<p>A logical value indicating whether to print detailed messages.
Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the FEMA flavor profile information for each
CASRN. If no information is found for a particular CASRN, the output will include a row indicating this.
</p>


<h3>See Also</h3>

<p><a href="https://pubchem.ncbi.nlm.nih.gov/">PubChem</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
extr_pubchem_fema(c("83-67-0", "1490-04-6"))

</code></pre>

<hr>
<h2 id='extr_pubchem_ghs'>Extract GHS Codes from PubChem</h2><span id='topic+extr_pubchem_ghs'></span>

<h3>Description</h3>

<p>This function extracts GHS (Globally Harmonized System) codes from PubChem. It relies on the <code>webchem</code> package to interact with PubChem.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extr_pubchem_ghs(casrn, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extr_pubchem_ghs_+3A_casrn">casrn</code></td>
<td>
<p>Character vector of CAS Registry Numbers (CASRN).</p>
</td></tr>
<tr><td><code id="extr_pubchem_ghs_+3A_verbose">verbose</code></td>
<td>
<p>A logical value indicating whether to print detailed messages. Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe containing GHS information.
</p>


<h3>See Also</h3>

<p><a href="https://pubchem.ncbi.nlm.nih.gov/">PubChem</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
extr_pubchem_ghs(casrn = c("50-00-0", "64-17-5"))

</code></pre>

<hr>
<h2 id='extr_tetramer'>Extract Tetramer Data from the CTD API</h2><span id='topic+extr_tetramer'></span>

<h3>Description</h3>

<p>This function queries the Comparative Toxicogenomics Database API to retrieve
tetramer data based on chemicals, diseases, genes, or other categories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extr_tetramer(
  chem,
  disease = "",
  gene = "",
  go = "",
  input_term_search_type = "directAssociations",
  qt_match_type = "equals",
  verify_ssl = FALSE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extr_tetramer_+3A_chem">chem</code></td>
<td>
<p>A string indicating the chemical identifiers such as CAS number or
IUPAC name of the chemical.</p>
</td></tr>
<tr><td><code id="extr_tetramer_+3A_disease">disease</code></td>
<td>
<p>A string indicating a disease term. Default is an empty string.</p>
</td></tr>
<tr><td><code id="extr_tetramer_+3A_gene">gene</code></td>
<td>
<p>A string indicating a gene symbol. Default is an empty string.</p>
</td></tr>
<tr><td><code id="extr_tetramer_+3A_go">go</code></td>
<td>
<p>A string indicating a Gene Ontology term. Default is an empty string.</p>
</td></tr>
<tr><td><code id="extr_tetramer_+3A_input_term_search_type">input_term_search_type</code></td>
<td>
<p>A string specifying the search method to use.
Options are &quot;hierarchicalAssociations&quot; or &quot;directAssociations&quot;. Default is
&quot;directAssociations&quot;.</p>
</td></tr>
<tr><td><code id="extr_tetramer_+3A_qt_match_type">qt_match_type</code></td>
<td>
<p>A string specifying the query type match method. Options
are &quot;equals&quot; or &quot;contains&quot;. Default is &quot;equals&quot;.</p>
</td></tr>
<tr><td><code id="extr_tetramer_+3A_verify_ssl">verify_ssl</code></td>
<td>
<p>Boolean to control if SSL should be verified or not.
Default is FALSE.</p>
</td></tr>
<tr><td><code id="extr_tetramer_+3A_verbose">verbose</code></td>
<td>
<p>A logical value indicating whether to print detailed messages.
Default is TRUE.</p>
</td></tr>
<tr><td><code id="extr_tetramer_+3A_...">...</code></td>
<td>
<p>Any other arguments to be supplied to <code>req_option</code> and thus to <code>libcurl</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the queried tetramer data in CSV format.
</p>


<h3>References</h3>


<ul>
<li><p> Comparative Toxicogenomics Database: <a href="http://ctdbase.org">http://ctdbase.org</a>
</p>
</li>
<li><p> Davis, A. P., Grondin, C. J., Johnson, R. J., Sciaky, D., McMorran, R.,
Wiegers, T. C., &amp; Mattingly, C. J. (2019).
The Comparative Toxicogenomics Database: update 2019. Nucleic acids research,
47(D1), D948–D954. <a href="https://doi.org/10.1093/nar/gky868">doi:10.1093/nar/gky868</a>
</p>
</li>
<li><p> Davis, A. P., Wiegers, T. C., Wiegers, J., Wyatt, B., Johnson,
R. J., Sciaky, D., Barkalow, F., Strong, M., Planchart, A.,
&amp; Mattingly, C. J. (2023). CTD tetramers: A new online tool that computationally
links curated chemicals, genes, phenotypes, and diseases to inform molecular
mechanisms for environmental health. Toxicological Sciences, 195(2), 155–168.
<a href="https://doi.org/10.1093/toxsci/kfad069">doi:10.1093/toxsci/kfad069</a>
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="http://ctdbase.org">Comparative Toxicogenomics Database</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
tetramer_data &lt;- extr_tetramer(
  chem = c("50-00-0", "ethanol"),
  disease = "",
  gene = "",
  go = "",
  input_term_search_type = "directAssociations",
  qt_match_type = "equals"
)
str(tetramer_data)

</code></pre>

<hr>
<h2 id='extr_tox'>Extract Toxicological Information from Multiple Databases</h2><span id='topic+extr_tox'></span>

<h3>Description</h3>

<p>This wrapper function retrieves toxicological information for specified chemicals
by calling several external functions to query multiple databases, including PubChem,
the Integrated Chemical Environment (ICE), CompTox Chemicals Dashboard,
and the Integrated Risk Information System (IRIS) and other.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extr_tox(casrn, verbose = TRUE, force = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extr_tox_+3A_casrn">casrn</code></td>
<td>
<p>A character vector of CAS Registry Numbers (CASRN) representing
the chemicals of interest.</p>
</td></tr>
<tr><td><code id="extr_tox_+3A_verbose">verbose</code></td>
<td>
<p>A logical value indicating whether to print detailed messages.
Default is TRUE.</p>
</td></tr>
<tr><td><code id="extr_tox_+3A_force">force</code></td>
<td>
<p>Logical indicating whether to force a fresh download of the EPA
PPRTV database. Default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Specifically, this function:
</p>

<ul>
<li><p> Calls <code><a href="#topic+extr_monograph">extr_monograph</a></code> to return monographs informations
from WHO IARC.
</p>
</li>
<li><p> Calls <code><a href="#topic+extr_pubchem_ghs">extr_pubchem_ghs</a></code> to retrieve GHS classification
data from PubChem.
</p>
</li>
<li><p> Calls <code><a href="#topic+extr_ice">extr_ice</a></code> to gather assay data from the ICE database.
</p>
</li>
<li><p> Calls <code><a href="#topic+extr_iris">extr_iris</a></code> to retrieve risk assessment information
from the IRIS database.
</p>
</li>
<li><p> Calls <code><a href="#topic+extr_comptox">extr_comptox</a></code> to retrieve data from the CompTox
Chemicals Dashboard.
</p>
</li></ul>



<h3>Value</h3>

<p>A list of data frames containing toxicological information retrieved
from each database:
</p>

<dl>
<dt>who_iarc_monographs</dt><dd><p>Lists if any, the WHO IARC monographs related
to that chemical.</p>
</dd>
<dt>pprtv</dt><dd><p>Risk assessment data from the EPA PPRTV</p>
</dd>
<dt>ghs_dat</dt><dd><p>Toxicity data from PubChem's Globally Harmonized System (GHS)
classification.</p>
</dd>
<dt>ice_dat</dt><dd><p>Assay data from the Integrated Chemical Environment (ICE)
database.</p>
</dd>
<dt>iris</dt><dd><p>Risk assessment data from the IRIS database.</p>
</dd>
<dt>comptox_list</dt><dd><p>List of dataframe with toxicity information
from the CompTox Chemicals Dashboard.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
extr_tox(casrn = c("100-00-5", "107-02-8"))

</code></pre>

<hr>
<h2 id='search_and_match'>Search and Match Data</h2><span id='topic+search_and_match'></span>

<h3>Description</h3>

<p>This function searches for matches in a dataframe based on a given list of ids
and search type, then combines the results into a single dataframe, making sure
that NA rows are added for any missing ids. The column <code>query</code> is a the end of
the dataframe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>search_and_match(dat, ids, search_type, col_names, chemical_col = "chemical")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="search_and_match_+3A_dat">dat</code></td>
<td>
<p>The dataframe to be searched.</p>
</td></tr>
<tr><td><code id="search_and_match_+3A_ids">ids</code></td>
<td>
<p>A vector of ids to search for.</p>
</td></tr>
<tr><td><code id="search_and_match_+3A_search_type">search_type</code></td>
<td>
<p>The type of search: &quot;casrn&quot; or &quot;name&quot;.</p>
</td></tr>
<tr><td><code id="search_and_match_+3A_col_names">col_names</code></td>
<td>
<p>Column names to be used when creating a new dataframe in case of no matches.</p>
</td></tr>
<tr><td><code id="search_and_match_+3A_chemical_col">chemical_col</code></td>
<td>
<p>The name of the column in dat where chemical names are stored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used in <code>extr_pprtv</code> and <code>extr_monograph</code>.
</p>


<h3>Value</h3>

<p>A dataframe with search results.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+extr_pprtv">extr_pprtv</a></code>, <code><a href="#topic+extr_monograph">extr_monograph</a></code>
</p>

<hr>
<h2 id='with_extr_sandbox'>Run Code in a Temporary Sandbox Environment</h2><span id='topic+with_extr_sandbox'></span>

<h3>Description</h3>

<p>This function creates a temporary directory and sets it as <code>R_USER_CACHE_DIR</code>
before executing the provided code block. It is used for testing or running
code without affecting the user's default cache directory as required by CRAN for the examples .
This function is not  designed to be used by package users. Shamelessly &quot;inspired&quot; by
some @luciorq code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>with_extr_sandbox(code, temp_dir = tempdir())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="with_extr_sandbox_+3A_code">code</code></td>
<td>
<p>The code to be executed inside the sandbox. Should be an expression.</p>
</td></tr>
<tr><td><code id="with_extr_sandbox_+3A_temp_dir">temp_dir</code></td>
<td>
<p>A temporary directory created using <code>temdir()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of the executed code.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>with_extr_sandbox(Sys.getenv("R_USER_CACHE_DIR"))
with_extr_sandbox(tools::R_user_dir("extractox", "cache"))
</code></pre>

<hr>
<h2 id='write_dataframes_to_excel'>Write Dataframes to Excel</h2><span id='topic+write_dataframes_to_excel'></span>

<h3>Description</h3>

<p>This function creates an Excel file with each dataframe in a list as a separate sheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_dataframes_to_excel(df_list, filename)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write_dataframes_to_excel_+3A_df_list">df_list</code></td>
<td>
<p>A named list of dataframes to write to the Excel file.</p>
</td></tr>
<tr><td><code id="write_dataframes_to_excel_+3A_filename">filename</code></td>
<td>
<p>The name of the Excel file to create.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. The function prints a message indicating the completion of the Excel file writing.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
tox_dat &lt;- extr_tox("50-00-0")
temp_file &lt;- tempfile(fileext = ".xlsx")
write_dataframes_to_excel(tox_dat, filename = temp_file)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
