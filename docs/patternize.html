<!DOCTYPE html><html lang="en"><head><title>Help for package patternize</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {patternize}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#patternize'><p>patternize - An R package for quantifying color pattern variation.</p></a></li>
<li><a href='#alignLan'><p>Align images using landmarks</p></a></li>
<li><a href='#alignReg'><p>Aligns images using <code>niftyreg</code> utilities for automated image registration..</p></a></li>
<li><a href='#colorChecker'><p>Calibrate images using ColorChecker.</p></a></li>
<li><a href='#colorChecker_customGray'><p>Calibrate images using ColorChecker.</p></a></li>
<li><a href='#colorChecker_half'><p>Calibrate images using (right) half of ColorChecker. Only works for X-Rite.</p></a></li>
<li><a href='#createPhenotype'><p>Plot color pattern prediction for specified PCA values</p></a></li>
<li><a href='#createTarget'><p>Create a target image (RasterStack) from a polygon.</p></a></li>
<li><a href='#extdata'><p>External patternize data</p></a></li>
<li><a href='#GMMImage'><p><code>GMM</code> clustering of image imported as a RasterStack.</p></a></li>
<li><a href='#imageList'><p>imageList</p></a></li>
<li><a href='#kImage'><p><code>kmeans</code> clustering of image imported as a RasterStack. This function is</p>
used by <code>patLanK</code> and <code>patRegK</code>.</a></li>
<li><a href='#kImageHSV'><p><code>kmeans</code> clustering of image imported as a RasterStack. This function is</p>
used by <code>patLanK</code> and <code>patRegK</code>.</a></li>
<li><a href='#lanArray'><p>Build landmark array for <code>Morpho</code>.</p></a></li>
<li><a href='#landmarkArray'><p>landmarkArray</p></a></li>
<li><a href='#landmarkList'><p>landmarkList</p></a></li>
<li><a href='#makeList'><p>Build list of landmarks or RasterStacks from images using filepath and file extension.</p></a></li>
<li><a href='#maskOutline'><p>Intersects a RasterStack with an outline. Everything outside of the outline will be removed</p>
from the raster.</a></li>
<li><a href='#patArea'><p>This fucntion calculates the area in which the color pattern is expressed in each sample as the</p>
relative proportion using the provided outline of the considered trait or structure.</a></li>
<li><a href='#patGMM'><p>Extract colors using GMM clustering (for pre-aligned images).</p></a></li>
<li><a href='#patK'><p>Extract colors using k-means clustering (for pre-aligned images).</p></a></li>
<li><a href='#patK_HSV'><p>Extract colors using k-means clustering (for pre-aligned images).</p></a></li>
<li><a href='#patLanHSV'><p>Aligns images usings transformations obtained from fixed landmarks and extracts colors</p>
using a predefined RGB values and cutoff value.</a></li>
<li><a href='#patLanK'><p>Aligns images usings transformations obtained from fixed landmarks and extracts colors using</p>
k-means clustering.</a></li>
<li><a href='#patLanK_HSV'><p>Aligns images usings transformations obtained from fixed landmarks and extracts colors using</p>
k-means clustering.</a></li>
<li><a href='#patLanRGB'><p>Aligns images usings transformations obtained from fixed landmarks and extracts colors</p>
using a predefined RGB values and cutoff value.</a></li>
<li><a href='#patLanW'><p>Extracts color pattern from landmark transformed image using watershed segmentation. This function</p>
works interactively by allowing to pick a starting pixel within each pattern element from which the
watershed will extract the pattern. This function works best for patterns with sharp boundaries.</a></li>
<li><a href='#patPCA'><p>This function transforms the individual color pattern rasters as obtained by the main</p>
patternize functions to a dataframe of 0 and 1 values that can be used for Principal
Component Analysis (<code>prcomp</code>). This function also allows to plot the
analysis including a visualization of the shape changes along the axis. Pixel values
are predicted by multiplying the rotation matrix (eigenvectors) with a vector that has
the same length as the number of rows in the rotation matrix and in which all values are
set to zero except for the PC value for which we want to predict the pixel values.</a></li>
<li><a href='#patRDA'><p>This function transforms the individual color pattern rasters as obtained by the main</p>
patternize functions to a dataframe of 0 and 1 values that can be used for constrained
Redundancy Analysis (RDA) (<code>rda</code>). This function also allows to plot the
analysis including a visualization of the shape changes along the axis.</a></li>
<li><a href='#patRegHSV'><p>Aligns images using <code>niftyreg</code> utilities for automated image registration</p>
and extracts colors using a predefined HSV values and cutoff value.</a></li>
<li><a href='#patRegK'><p>Aligns images using <code>niftyreg</code> utilities for automated image registration</p>
and extracts colors using k-means clustering.</a></li>
<li><a href='#patRegK_HSV'><p>Aligns images using <code>niftyreg</code> utilities for automated image registration</p>
and extracts colors using k-means clustering.</a></li>
<li><a href='#patRegRGB'><p>Aligns images using <code>niftyreg</code> utilities for automated image registration</p>
and extracts colors using a predefined RGB values and cutoff value.</a></li>
<li><a href='#patRegW'><p>Aligns images using <code>niftyreg</code> utilities for automated image registration</p>
and extracts color pattern using watershed segmentation. This function works interactively by
allowing to pick a starting pixel within each pattern element from which the watershed will
extract the pattern. This function works best for patterns with sharp boundaries.</a></li>
<li><a href='#plotHeat'><p>Plots the color pattern heatmaps from <code>sumRaster</code> output.</p></a></li>
<li><a href='#plotRasterstackAsImage'><p>Plot rasterStack as image.</p></a></li>
<li><a href='#rasterList_lanK'><p>rasterList_lanK</p></a></li>
<li><a href='#rasterList_lanRGB'><p>rasterList_lanRGB</p></a></li>
<li><a href='#rasterList_regK'><p>rasterList_regK</p></a></li>
<li><a href='#rasterList_regRGB'><p>rasterList_regRGB</p></a></li>
<li><a href='#redRes'><p>Reduce the resolution of an image imported as a RasterStack by downsampling.</p></a></li>
<li><a href='#sampleLandmarks'><p>Sample landmarks in an image.</p></a></li>
<li><a href='#sampleRGB'><p>Interactive function to sample RGB value from pixel or square area in an image.</p></a></li>
<li><a href='#setMask'><p>Interactive function to to draw an outline for masking.</p></a></li>
<li><a href='#sumRaster'><p>This function sums the individual color pattern RasterLayes as obtained by the main patternize</p>
functions.</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Quantification of Color Pattern Variation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.5</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Steven Van Belleghem &lt;vanbelleghemsteven@hotmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Quantification of variation in organismal color patterns as
    obtained from image data. Patternize defines homology between pattern positions
    across images either through fixed landmarks or image registration. Pattern
    identification is performed by categorizing the distribution of colors using RGB
    thresholds or image segmentation.</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/StevenVB12/patternize/issues">https://github.com/StevenVB12/patternize/issues</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/StevenVB12/patternize">https://github.com/StevenVB12/patternize</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>raster, sp, sf, abind, Morpho, dplyr, imager, magrittr,
methods, purrr, vegan, RNiftyReg, geomorph, ClusterR</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-21 16:58:38 UTC; u0152771</td>
</tr>
<tr>
<td>Author:</td>
<td>Steven Van Belleghem [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-22 14:40:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='patternize'>patternize - An R package for quantifying color pattern variation.</h2><span id='topic+patternize'></span><span id='topic+patternize-package'></span>

<h3>Description</h3>

<p>Quantifying variation in color patterns to study and compare the consistency of their expression
necessitates the homologous alignment and color-based segmentation of images. Patternize is an R
package that quantifies variation in color patterns as obtained from image data. Patternize
defines homology between pattern positions across specimens either through fixed landmarks or
image registration. Pattern identification is performed by categorizing the distribution of
colors using either an RGB threshold or an unsupervised image segmentation. The quantification
of the color patterns can be visualized as heat maps and compared between sets of samples.
</p>


<h3>patternize main functions</h3>

<p>The package has six main functions depending on how you want the alignment of the iamges and
the color extraction to be performed.
</p>
<p><code>patLanRGB</code> <br />
Aligns images by transformations obtained from fixed landmarks and extracts colors using
a predefined RGB values and cutoff value.
</p>
<p><code>patLanK</code> <br />
Aligns images by transformations obtained from fixed landmarks and extracts colors using
k-means clustering.
</p>
<p><code>patLanW</code> <br />
Aligns images by transformations obtained from fixed landmarks and extracts color
patterns by watershed segmentation using <code><a href="imager.html#topic+imager">imager</a></code> utilities.
</p>
<p><code>patRegRGB</code> <br />
Aligns images using <code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code> utilities for automated image
registration and extracts colors using a predefined RGB values and cutoff value.
</p>
<p><code>patRegK</code> <br />
Aligns images using <code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code> utilities for automated image
registration and extracts colors using k-means clustering.
</p>
<p><code>patRegW</code> <br />
Aligns images using <code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code> utilities for automated image
registration and extracts color patterns by watershed segmentation using
<code><a href="imager.html#topic+imager">imager</a></code> utilities.
</p>


<h3>patternize preprocessing functions</h3>

<p>The input for the main patternize functions are <code>RasterStack</code> objects and when landmark
transformation is used, landmark arrays.
</p>
<p><code>makeList</code> <br />
This function returns a list of RasterStacks or a list of landmarks depending on the input
provided.
</p>
<p><code>sampleLandmarks</code> <br />
Sample landmarks in an image.
</p>
<p><code>lanArray</code> <br />
This function creates a landmark array as used by <code><a href="Morpho.html#topic+procSym">procSym</a></code> in the
package <code>Morpho</code>.
</p>


<h3>patternize postprocessing functions</h3>

<p><code>sumRaster</code> <br />
This function sums the individual color pattern rasters as obtained by the main patternize
functions.
</p>
<p><code>plotHeat</code> <br />
Plots the color pattern heatmaps from <code>sumRaster</code> output.
</p>
<p><code>patPCA</code> <br />
This function transforms the individual color pattern rasters as obtained by the main
patternize functions to a dataframe of 0 and 1 values that can be used for Principal
Component Analysis (<code><a href="stats.html#topic+prcomp">prcomp</a></code>). This function also allows to plot the
analysis including a visualization of the shape changes along the axis.
</p>
<p><code>patRDA</code> <br />
This function transforms the individual color pattern rasters as obtained by the main
patternize functions to a dataframe of 0 and 1 values that can be used for constrained
Redundancy Analysis (<code><a href="vegan.html#topic+rda">rda</a></code>). This function also allows to plot the
analysis including a visualization of the shape changes along the axis.
</p>
<p><code>patArea</code> <br />
This fucntion calculates the area in which the color pattern is expressed in each sample
as the relative proportion using the provided outline of the considered trait or structure.
</p>


<h3>patternize miscellaneous functions</h3>

<p><code>redRes</code> <br />
Reduces the resolution of the <code>RasterStack</code> objects to speed up analysis.
</p>
<p><code>kImage</code> <br />
Performs k-means clustering of images.
</p>
<p><code>sampleRGB</code> <br />
Interactive function to sample RGB value from pixel or area in an image.
</p>
<p><code>createTarget</code> <br />
Creates an artificial target images using a provided outline that can be used for image
registration (experimantal).
</p>
<p><code>maskOutline</code> <br />
Intersects a RasterStack with an outline. Everything outside of the outline will be removed
from the raster.
</p>
<p><code>colorChecker</code> <br />
Calibrate images using ColorChecker.
</p>


<h3>Author(s)</h3>

<p>Steven M. Van Belleghem
</p>


<h3>See Also</h3>

<p><code><a href="raster.html#topic+raster">raster</a></code>,
<code><a href="raster.html#topic+stack">stack</a></code>,
<code><a href="Morpho.html#topic+procSym">procSym</a></code>,
<code><a href="Morpho.html#topic+computeTransform">computeTransform</a></code>,
<code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code>
<code><a href="imager.html#topic+imager">imager</a></code>
</p>
<p><cite>Jon Clayden, Marc Modat, Benoit Presles, Thanasis Anthopoulos and Pankaj Daga (2017).
RNiftyReg: Image Registration Using the 'NiftyReg' Library. R package version 2.5.0.
https://CRAN.R-project.org/package=RNiftyReg</cite> <br />
</p>
<p><cite>Stefan Schlager (2016). Morpho: Calculations and Visualisations Related to Geometric
Morphometrics. R package version 2.4.1.1. https://github.com/zarquon42b/Morpho</cite> <br />
</p>
<p><cite>Simon Barthelmé (2017). imager: Image processing library based on ‘CImg’. R package
version 0.40.2. https://CRAN.R-project.org/package=imager</cite> <br />
</p>

<hr>
<h2 id='alignLan'>Align images using landmarks</h2><span id='topic+alignLan'></span>

<h3>Description</h3>

<p>Align images using landmarks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alignLan(
  imageList,
  landList,
  IDlist = NULL,
  adjustCoords = FALSE,
  resampleFactor = NULL,
  res = c(300, 300),
  transformRef = "meanshape",
  transformType = "tps",
  maskOutline = NULL,
  removebg = NULL,
  removebgColOffset = 0.1,
  inverse = FALSE,
  cartoonID = NULL,
  refImage = NULL,
  plotTransformed = FALSE,
  format = "imageJ"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="alignLan_+3A_imagelist">imageList</code></td>
<td>
<p>List of RasterStack objects.</p>
</td></tr>
<tr><td><code id="alignLan_+3A_landlist">landList</code></td>
<td>
<p>Landmark list as returned by <code><a href="#topic+makeList">makeList</a></code>.</p>
</td></tr>
<tr><td><code id="alignLan_+3A_idlist">IDlist</code></td>
<td>
<p>List of sample IDs should be specified when masking outline and transformRef
is 'meanshape'.</p>
</td></tr>
<tr><td><code id="alignLan_+3A_adjustcoords">adjustCoords</code></td>
<td>
<p>Adjust landmark coordinates in case they are reversed compared to pixel
coordinates (default = FALSE).</p>
</td></tr>
<tr><td><code id="alignLan_+3A_resamplefactor">resampleFactor</code></td>
<td>
<p>Integer for downsampling used by <code><a href="#topic+redRes">redRes</a></code>.</p>
</td></tr>
<tr><td><code id="alignLan_+3A_res">res</code></td>
<td>
<p>Resolution vector c(x,y) for output rasters (default = c(300,300)). This should be
reduced if the number of pixels in the image is lower than th raster.</p>
</td></tr>
<tr><td><code id="alignLan_+3A_transformref">transformRef</code></td>
<td>
<p>ID or landmark matrix of reference sample for shape to which color patterns
will be transformed to. Can be 'meanshape' for transforming to mean shape of Procrustes
analysis.</p>
</td></tr>
<tr><td><code id="alignLan_+3A_transformtype">transformType</code></td>
<td>
<p>Transformation type as used by <code><a href="Morpho.html#topic+computeTransform">computeTransform</a></code>
(default ='tps').</p>
</td></tr>
<tr><td><code id="alignLan_+3A_maskoutline">maskOutline</code></td>
<td>
<p>When outline is specified, everything outside of the outline will be masked for
the color extraction (default = NULL). This can be a list of multiple outlines.</p>
</td></tr>
<tr><td><code id="alignLan_+3A_removebg">removebg</code></td>
<td>
<p>Integer or RGB vector indicating the range of RGB threshold to remove from
image (e.g. 100 removes pixels with average RGB &gt; 100; default = NULL).</p>
</td></tr>
<tr><td><code id="alignLan_+3A_removebgcoloffset">removebgColOffset</code></td>
<td>
<p>Color offset for color background extraction (default = 0.10).</p>
</td></tr>
<tr><td><code id="alignLan_+3A_inverse">inverse</code></td>
<td>
<p>If TRUE, areas withing the outline will be masked. If maskOutline is a list, this
should also be a list.</p>
</td></tr>
<tr><td><code id="alignLan_+3A_cartoonid">cartoonID</code></td>
<td>
<p>ID of the sample for which the cartoon was drawn and will be used for masking
(should be set when transformRef = 'meanShape').</p>
</td></tr>
<tr><td><code id="alignLan_+3A_refimage">refImage</code></td>
<td>
<p>Image (RasterStack) used for target. Use raster::stack('filename').</p>
</td></tr>
<tr><td><code id="alignLan_+3A_plottransformed">plotTransformed</code></td>
<td>
<p>Plot transformed image (default = FALSE).</p>
</td></tr>
<tr><td><code id="alignLan_+3A_format">format</code></td>
<td>
<p>ImageJ (Fiji) or tps format (default = 'imageJ').</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of aligned RasterStack objects.
</p>

<hr>
<h2 id='alignReg'>Aligns images using <code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code> utilities for automated image registration..</h2><span id='topic+alignReg'></span>

<h3>Description</h3>

<p>Aligns images using <code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code> utilities for automated image registration..
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alignReg(
  sampleList,
  target,
  resampleFactor = NULL,
  useBlockPercentage = 75,
  crop = c(0, 0, 0, 0),
  removebgR = NULL,
  maskOutline = NULL,
  plotTransformed = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="alignReg_+3A_samplelist">sampleList</code></td>
<td>
<p>List of RasterStack objects.</p>
</td></tr>
<tr><td><code id="alignReg_+3A_target">target</code></td>
<td>
<p>Image imported as RasterStack used as target for registration.</p>
</td></tr>
<tr><td><code id="alignReg_+3A_resamplefactor">resampleFactor</code></td>
<td>
<p>Integer for downsampling used by <code><a href="#topic+redRes">redRes</a></code> (default = NULL).</p>
</td></tr>
<tr><td><code id="alignReg_+3A_useblockpercentage">useBlockPercentage</code></td>
<td>
<p>Block percentage as used in <code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code>
(default = 75).</p>
</td></tr>
<tr><td><code id="alignReg_+3A_crop">crop</code></td>
<td>
<p>Vector c(xmin, xmax, ymin, ymax) that specifies the pixel coordinates to crop the
original image.</p>
</td></tr>
<tr><td><code id="alignReg_+3A_removebgr">removebgR</code></td>
<td>
<p>Integer indicating the range RGB treshold to remove from image (e.g. 100 removes
pixels with average RGB &gt; 100; default = NULL) for registration analysis. This works only to
remove a white background.</p>
</td></tr>
<tr><td><code id="alignReg_+3A_maskoutline">maskOutline</code></td>
<td>
<p>When outline is specified, everything outside of the outline will be masked for
the color extraction (default = NULL).</p>
</td></tr>
<tr><td><code id="alignReg_+3A_plottransformed">plotTransformed</code></td>
<td>
<p>Whether to plot transformed images while processing (default = FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of raster objects.
</p>

<hr>
<h2 id='colorChecker'>Calibrate images using ColorChecker.</h2><span id='topic+colorChecker'></span>

<h3>Description</h3>

<p>Calibrate images using ColorChecker.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colorChecker(
  IDlist,
  prepath = NULL,
  extension = NULL,
  colorCheckerType = "X-Rite",
  fixedCorners = FALSE,
  patchSize = 0.6,
  colorCheckerXY = NULL,
  fixedModel = NULL,
  resampleFactor = NULL,
  adjustCoords = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="colorChecker_+3A_idlist">IDlist</code></td>
<td>
<p>List of sample IDs.</p>
</td></tr>
<tr><td><code id="colorChecker_+3A_prepath">prepath</code></td>
<td>
<p>Prepath (default = NULL).</p>
</td></tr>
<tr><td><code id="colorChecker_+3A_extension">extension</code></td>
<td>
<p>Extension (default = NULL).</p>
</td></tr>
<tr><td><code id="colorChecker_+3A_colorcheckertype">colorCheckerType</code></td>
<td>
<p>Type of colorChecker. Options are 'X-Rite ' and 'ColorGauge Micro
Analyzer' (default = 'X-Rite ').</p>
</td></tr>
<tr><td><code id="colorChecker_+3A_fixedcorners">fixedCorners</code></td>
<td>
<p>Specify whether to set the coordinates of the colorChecker corners
for every image (default = FALSE).</p>
</td></tr>
<tr><td><code id="colorChecker_+3A_patchsize">patchSize</code></td>
<td>
<p>Proportion of ColorChecker patch that will be used for observed RGB values
(default = 0.6).</p>
</td></tr>
<tr><td><code id="colorChecker_+3A_colorcheckerxy">colorCheckerXY</code></td>
<td>
<p>Landmark list of colorChecker corners as returned
by <code><a href="#topic+makeList">makeList</a></code>. The image will not be plotted.</p>
</td></tr>
<tr><td><code id="colorChecker_+3A_fixedmodel">fixedModel</code></td>
<td>
<p>Precalculated model to adjust colors. Should be a listof a model for R, G
and B (the colorChecker function gives as output such a list obtained from the last image
in the analysis).</p>
</td></tr>
<tr><td><code id="colorChecker_+3A_resamplefactor">resampleFactor</code></td>
<td>
<p>Integer for downsampling used by <code><a href="#topic+redRes">redRes</a></code>.</p>
</td></tr>
<tr><td><code id="colorChecker_+3A_adjustcoords">adjustCoords</code></td>
<td>
<p>Adjust landmark coordinates in case they are reversed compared to pixel
coordinates (default = FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Calibrated image(s) ('filename_calibrated.jpg')
</p>

<hr>
<h2 id='colorChecker_customGray'>Calibrate images using ColorChecker.</h2><span id='topic+colorChecker_customGray'></span>

<h3>Description</h3>

<p>Calibrate images using ColorChecker.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colorChecker_customGray(
  IDlist,
  prepath = NULL,
  extension = NULL,
  colorCheckerType = "X-Rite",
  fixedCorners = FALSE,
  patchSize = 0.6,
  colorCheckerXY = NULL,
  fixedModel = NULL,
  resampleFactor = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="colorChecker_customGray_+3A_idlist">IDlist</code></td>
<td>
<p>List of sample IDs.</p>
</td></tr>
<tr><td><code id="colorChecker_customGray_+3A_prepath">prepath</code></td>
<td>
<p>Prepath (default = NULL).</p>
</td></tr>
<tr><td><code id="colorChecker_customGray_+3A_extension">extension</code></td>
<td>
<p>Extension (default = NULL).</p>
</td></tr>
<tr><td><code id="colorChecker_customGray_+3A_colorcheckertype">colorCheckerType</code></td>
<td>
<p>Type of colorChecker. Options are 'X-Rite ' and 'ColorGauge Micro
Analyzer' (default = 'X-Rite ').</p>
</td></tr>
<tr><td><code id="colorChecker_customGray_+3A_fixedcorners">fixedCorners</code></td>
<td>
<p>Specify whether to set the coordinates of the colorChecker corners
for every image (default = FALSE).</p>
</td></tr>
<tr><td><code id="colorChecker_customGray_+3A_patchsize">patchSize</code></td>
<td>
<p>Proportion of ColorChecker patch that will be used for observed RGB values
(default = 0.6).</p>
</td></tr>
<tr><td><code id="colorChecker_customGray_+3A_colorcheckerxy">colorCheckerXY</code></td>
<td>
<p>Landmark list of colorChecker corners as returned
by <code><a href="#topic+makeList">makeList</a></code>. The image will not be plotted.</p>
</td></tr>
<tr><td><code id="colorChecker_customGray_+3A_fixedmodel">fixedModel</code></td>
<td>
<p>Precalculated model to adjust colors. Should be a listof a model for R, G
and B (the colorChecker function gives as output such a list obtained from the last image
in the analysis).</p>
</td></tr>
<tr><td><code id="colorChecker_customGray_+3A_resamplefactor">resampleFactor</code></td>
<td>
<p>Integer for downsampling used by <code><a href="#topic+redRes">redRes</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Calibrated image(s) ('filename_calibrated.jpg')
</p>

<hr>
<h2 id='colorChecker_half'>Calibrate images using (right) half of ColorChecker. Only works for X-Rite.</h2><span id='topic+colorChecker_half'></span>

<h3>Description</h3>

<p>Calibrate images using (right) half of ColorChecker. Only works for X-Rite.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colorChecker_half(
  IDlist,
  prepath = NULL,
  extension = NULL,
  colorCheckerType = "X-Rite",
  fixedCorners = FALSE,
  patchSize = 0.6,
  colorCheckerXY = NULL,
  fixedModel = NULL,
  resampleFactor = NULL,
  adjustCoords = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="colorChecker_half_+3A_idlist">IDlist</code></td>
<td>
<p>List of sample IDs.</p>
</td></tr>
<tr><td><code id="colorChecker_half_+3A_prepath">prepath</code></td>
<td>
<p>Prepath (default = NULL).</p>
</td></tr>
<tr><td><code id="colorChecker_half_+3A_extension">extension</code></td>
<td>
<p>Extension (default = NULL).</p>
</td></tr>
<tr><td><code id="colorChecker_half_+3A_colorcheckertype">colorCheckerType</code></td>
<td>
<p>Type of colorChecker. Options are 'X-Rite ' and 'ColorGauge Micro
Analyzer' (default = 'X-Rite').</p>
</td></tr>
<tr><td><code id="colorChecker_half_+3A_fixedcorners">fixedCorners</code></td>
<td>
<p>Specify whether to set the coordinates of the colorChecker corners
for every image (default = FALSE).</p>
</td></tr>
<tr><td><code id="colorChecker_half_+3A_patchsize">patchSize</code></td>
<td>
<p>Proportion of ColorChecker patch that will be used for observed RGB values
(default = 0.6).</p>
</td></tr>
<tr><td><code id="colorChecker_half_+3A_colorcheckerxy">colorCheckerXY</code></td>
<td>
<p>Landmark list of colorChecker corners as returned
by <code><a href="#topic+makeList">makeList</a></code>. The image will not be plotted.</p>
</td></tr>
<tr><td><code id="colorChecker_half_+3A_fixedmodel">fixedModel</code></td>
<td>
<p>Precalculated model to adjust colors. Should be a listof a model for R, G
and B (the colorChecker function gives as output such a list obtained from the last image
in the analysis).</p>
</td></tr>
<tr><td><code id="colorChecker_half_+3A_resamplefactor">resampleFactor</code></td>
<td>
<p>Integer for downsampling used by <code><a href="#topic+redRes">redRes</a></code>.</p>
</td></tr>
<tr><td><code id="colorChecker_half_+3A_adjustcoords">adjustCoords</code></td>
<td>
<p>Adjust landmark coordinates in case they are reversed compared to pixel
coordinates (default = FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Calibrated image(s) ('filename_calibrated.jpg')
</p>

<hr>
<h2 id='createPhenotype'>Plot color pattern prediction for specified PCA values</h2><span id='topic+createPhenotype'></span>

<h3>Description</h3>

<p>Plot color pattern prediction for specified PCA values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createPhenotype(
  PCAdata,
  PCApredict,
  IDlist,
  rasterList,
  colpalette = NULL,
  plotCartoon = FALSE,
  refShape = NULL,
  outline = NULL,
  lines = NULL,
  landList = NULL,
  adjustCoords = FALSE,
  cartoonID = NULL,
  normalized = TRUE,
  crop = c(0, 0, 0, 0),
  flipRaster = NULL,
  flipOutline = NULL,
  imageList = NULL,
  cartoonOrder = "above",
  lineOrder = "above",
  cartoonCol = "gray",
  cartoonFill = NULL,
  legendTitle = "Proportion",
  zlim = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createPhenotype_+3A_pcadata">PCAdata</code></td>
<td>
<p>Output of PCA analysis. List item 3 of patPCA.</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_pcapredict">PCApredict</code></td>
<td>
<p>A vector with the PCA values for which to predict the phenotype. This vector
only needs to include the values upto the last PCA axis to predict along, other values are
set to zero.</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_idlist">IDlist</code></td>
<td>
<p>List of sample IDs.</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_rasterlist">rasterList</code></td>
<td>
<p>rasterList used for PCA.</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_colpalette">colpalette</code></td>
<td>
<p>Vector of colors for color palette
(default = c(&quot;white&quot;,&quot;lightblue&quot;,&quot;blue&quot;,&quot;green&quot;, &quot;yellow&quot;,&quot;red&quot;))</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_plotcartoon">plotCartoon</code></td>
<td>
<p>Whether to plot a cartoon. This cartoon should be drawn on one of the samples
used in the analysis.</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_refshape">refShape</code></td>
<td>
<p>This can be 'target' in case the reference shape is a single sample (for
registration analysis) or 'mean' if the images were transformed to a mean shape (only for
meanshape when using landmark transformation)</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_outline">outline</code></td>
<td>
<p>xy coordinates that define outline.</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_lines">lines</code></td>
<td>
<p>list of files with xy coordinates of line objects to be added to cartoon.</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_landlist">landList</code></td>
<td>
<p>Landmark landmarkList.</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_adjustcoords">adjustCoords</code></td>
<td>
<p>Adjust landmark coordinates.</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_cartoonid">cartoonID</code></td>
<td>
<p>ID of the sample for which the cartoon was drawn.</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_normalized">normalized</code></td>
<td>
<p>Set this to true in case the summed rasters are already devided by the
sample number.</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_crop">crop</code></td>
<td>
<p>Vector c(xmin, xmax, ymin, ymax) that specifies the pixel coordinates to crop
the original image used in landmark or registration analysis.</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_flipraster">flipRaster</code></td>
<td>
<p>Whether to flip raster along xy axis (in case there is an inconsistency
between raster and outline coordinates).</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_flipoutline">flipOutline</code></td>
<td>
<p>Whether to flip plot along x, y or xy axis.</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_imagelist">imageList</code></td>
<td>
<p>List of images should be given if one wants to flip the outline or adjust
landmark coordinates.</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_cartoonorder">cartoonOrder</code></td>
<td>
<p>Whether to plot the cartoon outline 'above' or 'under' the pattern raster
(default = 'above'). Set to 'under' for filled outlines.</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_lineorder">lineOrder</code></td>
<td>
<p>Whether to plot the cartoon lines 'above' or 'under' the pattern raster
(default = 'above').</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_cartooncol">cartoonCol</code></td>
<td>
<p>Outline and line color for cartoon (deafault = 'gray').</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_cartoonfill">cartoonFill</code></td>
<td>
<p>Fill color for outline of cartoon (default = NULL).</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_legendtitle">legendTitle</code></td>
<td>
<p>Title of the raster legend (default = 'Proportion').</p>
</td></tr>
<tr><td><code id="createPhenotype_+3A_zlim">zlim</code></td>
<td>
<p>zlim values for predicted pattern.</p>
</td></tr>
</table>

<hr>
<h2 id='createTarget'>Create a target image (RasterStack) from a polygon.</h2><span id='topic+createTarget'></span>

<h3>Description</h3>

<p>Create a target image (RasterStack) from a polygon.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createTarget(
  outline,
  image,
  res = 300,
  colorFill = "black",
  colorBG = "white",
  sigma = 10,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createTarget_+3A_outline">outline</code></td>
<td>
<p>xy coordinates that define outline.</p>
</td></tr>
<tr><td><code id="createTarget_+3A_image">image</code></td>
<td>
<p>Image imported as RasterStack used in the analysis. This is used to extract
the extent and dimensions for the raster layers.</p>
</td></tr>
<tr><td><code id="createTarget_+3A_res">res</code></td>
<td>
<p>Resolution for RasterStack (default = 300).</p>
</td></tr>
<tr><td><code id="createTarget_+3A_colorfill">colorFill</code></td>
<td>
<p>Color for the fill of the polygon (default = 'black').</p>
</td></tr>
<tr><td><code id="createTarget_+3A_colorbg">colorBG</code></td>
<td>
<p>Color for the background (default = 'white').</p>
</td></tr>
<tr><td><code id="createTarget_+3A_sigma">sigma</code></td>
<td>
<p>Size of sigma for Gaussian blurring (default = 10).</p>
</td></tr>
<tr><td><code id="createTarget_+3A_plot">plot</code></td>
<td>
<p>Whether to plot the created target image (default = FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>RasterStack
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
outline_BC0077 &lt;- read.table(paste(system.file("extdata",  package = 'patternize'),
'/BC0077_outline.txt', sep=''), header = FALSE)

data(imageList)

target &lt;- createTarget(outline_BC0077, imageList[[1]], plot =  TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='extdata'>External patternize data</h2><span id='topic+extdata'></span>

<h3>Description</h3>

<p>Raw image, landmark and cartoon data of Heliconius erato hydara wings.
</p>


<h3>Format</h3>

<p>Raw JPG images, landmark and cartoon data.
</p>

<dl>
<dt>BC0077.JPG</dt><dd><p>jpeg image</p>
</dd>
<dt>BC0071.JPG</dt><dd><p>jpeg image</p>
</dd>
<dt>BC0050.JPG</dt><dd><p>jpeg image</p>
</dd>
<dt>BC0049.JPG</dt><dd><p>jpeg image</p>
</dd>
<dt>BC0004.JPG</dt><dd><p>jpeg image</p>
</dd>
<dt>BC0077_landmarks_LFW.Txt</dt><dd><p>xy landmark coordinates</p>
</dd>
<dt>BC0071_landmarks_LFW.Txt</dt><dd><p>xy landmark coordinates</p>
</dd>
<dt>BC0050_landmarks_LFW.Txt</dt><dd><p>xy landmark coordinates</p>
</dd>
<dt>BC0049_landmarks_LFW.Txt</dt><dd><p>xy landmark coordinates</p>
</dd>
<dt>BC0004_landmarks_LFW.Txt</dt><dd><p>xy landmark coordinates</p>
</dd>
<dt>BC0077_outline.txt</dt><dd><p>xy outline coordinates</p>
</dd>
<dt>BC0077_vein1.txt</dt><dd><p>xy vein coordinates</p>
</dd>
<dt>BC0077_vein2.txt</dt><dd><p>xy vein coordinates</p>
</dd>
<dt>BC0077_vein3.txt</dt><dd><p>xy vein coordinates</p>
</dd>
<dt>BC0077_vein4.txt</dt><dd><p>xy vein coordinates</p>
</dd>
<dt>BC0077_vein5.txt</dt><dd><p>xy vein coordinates</p>
</dd>
<dt>BC0077_vein6.txt</dt><dd><p>xy vein coordinates</p>
</dd>
<dt>BC0077_vein7.txt</dt><dd><p>xy vein coordinates</p>
</dd>
<dt>BC0077_vein8.txt</dt><dd><p>xy vein coordinates</p>
</dd>
<dt>BC0077_vein9.txt</dt><dd><p>xy vein coordinates</p>
</dd>
<dt>BC0077_vein10.txt</dt><dd><p>xy vein coordinates</p>
</dd>
<dt>BC0077_vein11.txt</dt><dd><p>xy vein coordinates</p>
</dd>
</dl>


<hr>
<h2 id='GMMImage'><code><a href="ClusterR.html#topic+GMM">GMM</a></code> clustering of image imported as a RasterStack.</h2><span id='topic+GMMImage'></span>

<h3>Description</h3>

<p><code><a href="ClusterR.html#topic+GMM">GMM</a></code> clustering of image imported as a RasterStack.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GMMImage(image, k = 5, maskToNA = NULL, kmeansOnAll = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GMMImage_+3A_image">image</code></td>
<td>
<p>Image imported as a RasterStack for clustering.</p>
</td></tr>
<tr><td><code id="GMMImage_+3A_k">k</code></td>
<td>
<p>Integer for number of k clusters (default = 3).</p>
</td></tr>
<tr><td><code id="GMMImage_+3A_masktona">maskToNA</code></td>
<td>
<p>Replace the color value used for masking (i.e. 0 or 255) with NA.</p>
</td></tr>
<tr><td><code id="GMMImage_+3A_kmeansonall">kmeansOnAll</code></td>
<td>
<p>Whether to perform the kmeans clusters on the combined set of pixels of all images
first (default = FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List including the clustered <code>RasterSatck</code> returned as an array and object
of class &quot;<code>GMM</code>&quot;.
</p>

<hr>
<h2 id='imageList'>imageList</h2><span id='topic+imageList'></span>

<h3>Description</h3>

<p>List of RasterStacks as returned by <code>makeList</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>imageList
</code></pre>


<h3>Format</h3>

<p>A list of 5 <code>RasterStack</code> objects of Heliconius erato hydara dorsal forewings.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(imageList)
summary(imageList)

## End(Not run)
</code></pre>

<hr>
<h2 id='kImage'><code><a href="stats.html#topic+kmeans">kmeans</a></code> clustering of image imported as a RasterStack. This function is
used by <code>patLanK</code> and <code>patRegK</code>.</h2><span id='topic+kImage'></span>

<h3>Description</h3>

<p><code><a href="stats.html#topic+kmeans">kmeans</a></code> clustering of image imported as a RasterStack. This function is
used by <code>patLanK</code> and <code>patRegK</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kImage(image, k = 5, startCenter = NULL, maskToNA = NULL, kmeansOnAll = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kImage_+3A_image">image</code></td>
<td>
<p>Image imported as a RasterStack for k-means clustering.</p>
</td></tr>
<tr><td><code id="kImage_+3A_k">k</code></td>
<td>
<p>Integer for number of k-means clusters (default = 3).</p>
</td></tr>
<tr><td><code id="kImage_+3A_startcenter">startCenter</code></td>
<td>
<p>A matrix of cluster centres to start k-means clustering from (default = NULL).</p>
</td></tr>
<tr><td><code id="kImage_+3A_masktona">maskToNA</code></td>
<td>
<p>Replace the color value used for masking (i.e. 0 or 255) with NA.</p>
</td></tr>
<tr><td><code id="kImage_+3A_kmeansonall">kmeansOnAll</code></td>
<td>
<p>Whether to perform the kmeans clusters on the combined set of pixels of all images
first (default = FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List including the k-means clustered <code>RasterSatck</code> returned as an array and object
of class &quot;<code>kmeans</code>&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>image &lt;- raster::stack(system.file("extdata", "BC0077.jpg", package = "patternize"))
out &lt;- kImage(image, 6)

</code></pre>

<hr>
<h2 id='kImageHSV'><code><a href="stats.html#topic+kmeans">kmeans</a></code> clustering of image imported as a RasterStack. This function is
used by <code>patLanK</code> and <code>patRegK</code>.</h2><span id='topic+kImageHSV'></span>

<h3>Description</h3>

<p><code><a href="stats.html#topic+kmeans">kmeans</a></code> clustering of image imported as a RasterStack. This function is
used by <code>patLanK</code> and <code>patRegK</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kImageHSV(
  image,
  k = 5,
  startCenter = NULL,
  maskToNA = NULL,
  kmeansOnAll = FALSE,
  ignoreHSVvalue = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kImageHSV_+3A_image">image</code></td>
<td>
<p>HSV image imported as a RasterStack for k-means clustering.</p>
</td></tr>
<tr><td><code id="kImageHSV_+3A_k">k</code></td>
<td>
<p>Integer for number of k-means clusters (default = 3).</p>
</td></tr>
<tr><td><code id="kImageHSV_+3A_startcenter">startCenter</code></td>
<td>
<p>A matrix of cluster centres to start k-means clustering from (default = NULL).</p>
</td></tr>
<tr><td><code id="kImageHSV_+3A_masktona">maskToNA</code></td>
<td>
<p>Replace the color value used for masking (i.e. 0 or 255) with NA.</p>
</td></tr>
<tr><td><code id="kImageHSV_+3A_kmeansonall">kmeansOnAll</code></td>
<td>
<p>Whether to perform the kmeans clusters on the combined set of pixels of all images
first (default = FALSE).</p>
</td></tr>
<tr><td><code id="kImageHSV_+3A_ignorehsvvalue">ignoreHSVvalue</code></td>
<td>
<p>Whether to ignore the HSV value (~darkness).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List including the k-means clustered <code>RasterSatck</code> returned as an array and object
of class &quot;<code>kmeans</code>&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>image &lt;- raster::stack(system.file("extdata", "BC0077.jpg", package = "patternize"))
out &lt;- kImage(image, 6)

</code></pre>

<hr>
<h2 id='lanArray'>Build landmark array for <code><a href="Morpho.html#topic+Morpho">Morpho</a></code>.</h2><span id='topic+lanArray'></span>

<h3>Description</h3>

<p>Build landmark array for <code><a href="Morpho.html#topic+Morpho">Morpho</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lanArray(sampleList, adjustCoords = FALSE, imageList = NULL, imageIDs = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lanArray_+3A_samplelist">sampleList</code></td>
<td>
<p>List of landmark matrices as returned by <code><a href="#topic+makeList">makeList</a></code>.</p>
</td></tr>
<tr><td><code id="lanArray_+3A_adjustcoords">adjustCoords</code></td>
<td>
<p>Adjust landmark coordinates in case they are reversed compared to pixel
coordinates (default = FALSE).</p>
</td></tr>
<tr><td><code id="lanArray_+3A_imagelist">imageList</code></td>
<td>
<p>List of RasterStacks as returned by <code><a href="#topic+makeList">makeList</a></code> should be given
when <code>adjustCoords = TRUE</code>.</p>
</td></tr>
<tr><td><code id="lanArray_+3A_imageids">imageIDs</code></td>
<td>
<p>A list of IDs to match landmarks to images if landmarkList and imageList don't
have the same length.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>X x Y x n array, where X and Y define the coordinates of the landmark points and n
is the sample size.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
IDlist &lt;- c('BC0077','BC0071','BC0050','BC0049','BC0004')

prepath &lt;- system.file("extdata",  package = 'patternize')
extension &lt;- '_landmarks_LFW.txt'

landmarkList &lt;- makeList(IDlist, 'landmark', prepath, extension)

landmarkArray &lt;- lanArray(landmarkList)

## End(Not run)

</code></pre>

<hr>
<h2 id='landmarkArray'>landmarkArray</h2><span id='topic+landmarkArray'></span>

<h3>Description</h3>

<p>Array of landmarks as returned by <code>lanArray</code> and used by
<code>link[Morpho]{procsym}</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>landmarkArray
</code></pre>


<h3>Format</h3>

<p>An array of landmarks for 5 Heliconius erato hydara dorsal forewings.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(landmarkArray)
summary(landmarkArray)

## End(Not run)
</code></pre>

<hr>
<h2 id='landmarkList'>landmarkList</h2><span id='topic+landmarkList'></span>

<h3>Description</h3>

<p>List of landmarks as returned by <code>makeList</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>landmarkList
</code></pre>


<h3>Format</h3>

<p>A list of landmarks for 5 Heliconius erato hydara dorsal forewings.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(landmarkList)
summary(landmarkList)

## End(Not run)
</code></pre>

<hr>
<h2 id='makeList'>Build list of landmarks or RasterStacks from images using filepath and file extension.</h2><span id='topic+makeList'></span>

<h3>Description</h3>

<p>Build list of landmarks or RasterStacks from images using filepath and file extension.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeList(
  IDlist,
  type,
  prepath = NULL,
  extension = NULL,
  format = "imageJ",
  tpsFile = NULL,
  skipLandmark = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makeList_+3A_idlist">IDlist</code></td>
<td>
<p>List of sample IDs.</p>
</td></tr>
<tr><td><code id="makeList_+3A_type">type</code></td>
<td>
<p>'landmark' or 'image' depending on what type of list to make.</p>
</td></tr>
<tr><td><code id="makeList_+3A_prepath">prepath</code></td>
<td>
<p>Prepath (default = NULL).</p>
</td></tr>
<tr><td><code id="makeList_+3A_extension">extension</code></td>
<td>
<p>Extension (default = NULL).</p>
</td></tr>
<tr><td><code id="makeList_+3A_format">format</code></td>
<td>
<p>ImageJ (Fiji) or tps format (default = 'imageJ').</p>
</td></tr>
<tr><td><code id="makeList_+3A_tpsfile">tpsFile</code></td>
<td>
<p>Provide filename of tps file ff format is 'tps'.</p>
</td></tr>
<tr><td><code id="makeList_+3A_skiplandmark">skipLandmark</code></td>
<td>
<p>Vector of rownumbers of landmarks to skip.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Landmark or RasterStack list.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>IDlist &lt;- c('BC0077','BC0071','BC0050','BC0049','BC0004')

prepath &lt;- system.file("extdata",  package = 'patternize')
extension &lt;- '_landmarks_LFW.txt'

landmarkList &lt;- makeList(IDlist, 'landmark', prepath, extension)

extension &lt;- '.jpg'
imageList &lt;- makeList(IDlist, 'image', prepath, extension)

</code></pre>

<hr>
<h2 id='maskOutline'>Intersects a RasterStack with an outline. Everything outside of the outline will be removed
from the raster.</h2><span id='topic+maskOutline'></span>

<h3>Description</h3>

<p>Intersects a RasterStack with an outline. Everything outside of the outline will be removed
from the raster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maskOutline(
  RasterStack,
  outline,
  refShape,
  landList = NULL,
  adjustCoords = FALSE,
  cartoonID = NULL,
  IDlist = NULL,
  crop = c(0, 0, 0, 0),
  flipRaster = NULL,
  flipOutline = NULL,
  imageList = NULL,
  maskColor = 0,
  inverse = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="maskOutline_+3A_rasterstack">RasterStack</code></td>
<td>
<p>RasterStack to be masked.</p>
</td></tr>
<tr><td><code id="maskOutline_+3A_outline">outline</code></td>
<td>
<p>xy coordinates that define outline.</p>
</td></tr>
<tr><td><code id="maskOutline_+3A_refshape">refShape</code></td>
<td>
<p>This can be 'target' in case the reference shape is a single sample (for
registration analysis) or 'mean' if the images were transformed to a mean shape (only
for meanshape when using landmark transformation)</p>
</td></tr>
<tr><td><code id="maskOutline_+3A_landlist">landList</code></td>
<td>
<p>Landmark list to be given when type = 'mean'.</p>
</td></tr>
<tr><td><code id="maskOutline_+3A_adjustcoords">adjustCoords</code></td>
<td>
<p>Adjust landmark coordinates in case they are reversed compared to
pixel coordinates (default = FALSE).</p>
</td></tr>
<tr><td><code id="maskOutline_+3A_cartoonid">cartoonID</code></td>
<td>
<p>ID of the sample for which the cartoon was drawn. Only has to be given when
refShape is 'mean'.</p>
</td></tr>
<tr><td><code id="maskOutline_+3A_idlist">IDlist</code></td>
<td>
<p>List of sample IDs should be specified when refShape is 'mean'.</p>
</td></tr>
<tr><td><code id="maskOutline_+3A_crop">crop</code></td>
<td>
<p>Vector c(xmin, xmax, ymin, ymax) that specifies the pixel coordinates to
crop the original image used in landmark or registration analysis.</p>
</td></tr>
<tr><td><code id="maskOutline_+3A_flipraster">flipRaster</code></td>
<td>
<p>Whether to flip raster along xy axis (in case there is an inconsistency
between raster and outline coordinates).</p>
</td></tr>
<tr><td><code id="maskOutline_+3A_flipoutline">flipOutline</code></td>
<td>
<p>Whether to flip plot along x, y or xy axis.</p>
</td></tr>
<tr><td><code id="maskOutline_+3A_imagelist">imageList</code></td>
<td>
<p>List of image as obtained from <code><a href="#topic+makeList">makeList</a></code> should
be given if one wants to flip the outline or adjust landmark coordinates.</p>
</td></tr>
<tr><td><code id="maskOutline_+3A_maskcolor">maskColor</code></td>
<td>
<p>Color the masked area gets. Set to 0 for black (default) or 255 for white.</p>
</td></tr>
<tr><td><code id="maskOutline_+3A_inverse">inverse</code></td>
<td>
<p>If TRUE, areas withing the outline will be masked.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
data(imageList)
outline_BC0077 &lt;- read.table(paste(system.file("extdata",  package = 'patternize'),
'/BC0077_outline.txt', sep=''), header = FALSE)

masked &lt;- maskOutline(imageList[[1]], outline_BC0077, refShape = 'target', flipOutline = 'y')

## End(Not run)

</code></pre>

<hr>
<h2 id='patArea'>This fucntion calculates the area in which the color pattern is expressed in each sample as the
relative proportion using the provided outline of the considered trait or structure.</h2><span id='topic+patArea'></span>

<h3>Description</h3>

<p>This fucntion calculates the area in which the color pattern is expressed in each sample as the
relative proportion using the provided outline of the considered trait or structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patArea(
  rList,
  IDlist,
  refShape,
  type,
  outline = NULL,
  landList = NULL,
  adjustCoords = FALSE,
  cartoonID = NULL,
  crop = c(0, 0, 0, 0),
  flipRaster = NULL,
  flipOutline = NULL,
  imageList = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="patArea_+3A_rlist">rList</code></td>
<td>
<p>List of RasterLayers as obtained from the main patternize functions.</p>
</td></tr>
<tr><td><code id="patArea_+3A_idlist">IDlist</code></td>
<td>
<p>List of sample IDs.</p>
</td></tr>
<tr><td><code id="patArea_+3A_refshape">refShape</code></td>
<td>
<p>This can be 'target' in case the reference shape is a single sample (for
registration analysis) or 'mean' if the images were transformed to a mean shape using landmark
transformation.</p>
</td></tr>
<tr><td><code id="patArea_+3A_type">type</code></td>
<td>
<p>Type of rasterlist; 'RGB' or 'k' (result from RGB or k-means analysis, respectively).</p>
</td></tr>
<tr><td><code id="patArea_+3A_outline">outline</code></td>
<td>
<p>xy coordinates that define outline.</p>
</td></tr>
<tr><td><code id="patArea_+3A_landlist">landList</code></td>
<td>
<p>Landmark list as returned by <code><a href="#topic+makeList">makeList</a></code>.</p>
</td></tr>
<tr><td><code id="patArea_+3A_adjustcoords">adjustCoords</code></td>
<td>
<p>Adjust landmark coordinates in case they are reversed compared to pixel
coordinates (default = FALSE).</p>
</td></tr>
<tr><td><code id="patArea_+3A_cartoonid">cartoonID</code></td>
<td>
<p>ID of the sample for which the cartoon was drawn.</p>
</td></tr>
<tr><td><code id="patArea_+3A_crop">crop</code></td>
<td>
<p>Vector c(xmin, xmax, ymin, ymax) that specifies the pixel coordinates to crop the
original image used in landmark or registration analysis.</p>
</td></tr>
<tr><td><code id="patArea_+3A_flipraster">flipRaster</code></td>
<td>
<p>Whether to flip raster along xy axis (in case there is an inconsistency between
raster and outline coordinates).</p>
</td></tr>
<tr><td><code id="patArea_+3A_flipoutline">flipOutline</code></td>
<td>
<p>Whether to flip plot along x, y or xy axis.</p>
</td></tr>
<tr><td><code id="patArea_+3A_imagelist">imageList</code></td>
<td>
<p>List of images as obtained from <code><a href="#topic+makeList">makeList</a></code> should be given
if one wants to flip the outline or adjust landmark coordinates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Table or list of tables with sample IDs and relative area of color pattern or kmeans cluster.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(rasterList_lanRGB)
#data(rasterList_regRGB)
#data(rasterList_lanK)
#data(rasterList_regK)

data(imageList)

IDlist &lt;- c('BC0077','BC0071','BC0050','BC0049','BC0004')

outline_BC0077 &lt;- read.table(paste(system.file("extdata",  package = 'patternize'),
'/BC0077_outline.txt', sep=''), header = FALSE)

prepath &lt;- system.file("extdata", package = 'patternize')
extension &lt;- '_landmarks_LFW.txt'

landmarkList &lt;- makeList(IDlist, 'landmark', prepath, extension)

## Not run: 
area_lanRGB &lt;- patArea(rasterList_lanRGB, IDlist, refShape = 'mean', type = 'RGB',
outline = outline_BC0077, landList = landmarkList, adjustCoords = TRUE,
imageList = imageList, cartoonID = 'BC0077')

area_regRGB &lt;- patArea(rasterList_regRGB, IDlist, refShape = 'target', type = 'RGB',
outline = outline_BC0077, crop = c(100,400,40,250), adjustCoords = TRUE,
imageList = imageList, cartoonID = 'BC0077', flipRaster = 'xy')

areaList_lanK &lt;- patArea(rasterList_lanK, IDlist, refShape = 'mean', type = 'k',
outline = outline_BC0077, landList = landmarkList, adjustCoords = TRUE,
imageList = imageList, cartoonID = 'BC0077')

areaList_regK &lt;- patArea(rasterList_regK, IDlist, refShape = 'target', type = 'k',
outline = outline_BC0077, crop = c(100,400,40,250), adjustCoords = TRUE,
imageList = imageList, cartoonID = 'BC0077', flipRaster = 'xy')

## End(Not run)

</code></pre>

<hr>
<h2 id='patGMM'>Extract colors using GMM clustering (for pre-aligned images).</h2><span id='topic+patGMM'></span>

<h3>Description</h3>

<p>Extract colors using GMM clustering (for pre-aligned images).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patGMM(
  sampleList,
  k = 3,
  resampleFactor = NULL,
  maskOutline = NULL,
  plot = FALSE,
  focal = FALSE,
  sigma = 3,
  maskToNA = NULL,
  kmeansOnAll = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="patGMM_+3A_samplelist">sampleList</code></td>
<td>
<p>List of RasterStack objects.</p>
</td></tr>
<tr><td><code id="patGMM_+3A_k">k</code></td>
<td>
<p>Integere for defining number of clusters (default = 3).</p>
</td></tr>
<tr><td><code id="patGMM_+3A_resamplefactor">resampleFactor</code></td>
<td>
<p>Integer for downsampling used by <code><a href="#topic+redRes">redRes</a></code>.</p>
</td></tr>
<tr><td><code id="patGMM_+3A_maskoutline">maskOutline</code></td>
<td>
<p>When outline is specified, everything outside of the outline will be masked for
the color extraction (default = NULL).</p>
</td></tr>
<tr><td><code id="patGMM_+3A_plot">plot</code></td>
<td>
<p>Whether to plot transformed color patterns while processing (default = FALSE).</p>
</td></tr>
<tr><td><code id="patGMM_+3A_focal">focal</code></td>
<td>
<p>Whether to perform Gaussian blurring (default = FALSE).</p>
</td></tr>
<tr><td><code id="patGMM_+3A_sigma">sigma</code></td>
<td>
<p>Size of sigma for Gaussian blurring (default = 3).</p>
</td></tr>
<tr><td><code id="patGMM_+3A_masktona">maskToNA</code></td>
<td>
<p>Replace the color value used for masking (i.e. 0 or 255) with NA.</p>
</td></tr>
<tr><td><code id="patGMM_+3A_kmeansonall">kmeansOnAll</code></td>
<td>
<p>Whether to perform the kmeans clusters on the combined set of pixels of all images
first (default = FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of summed raster for each k-means cluster objects.
</p>

<hr>
<h2 id='patK'>Extract colors using k-means clustering (for pre-aligned images).</h2><span id='topic+patK'></span>

<h3>Description</h3>

<p>Extract colors using k-means clustering (for pre-aligned images).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patK(
  sampleList,
  k = 3,
  fixedStartCenter = NULL,
  resampleFactor = NULL,
  maskOutline = NULL,
  plot = FALSE,
  focal = FALSE,
  sigma = 3,
  maskToNA = NULL,
  kmeansOnAll = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="patK_+3A_samplelist">sampleList</code></td>
<td>
<p>List of RasterStack objects.</p>
</td></tr>
<tr><td><code id="patK_+3A_k">k</code></td>
<td>
<p>Integere for defining number of k-means clusters (default = 3).</p>
</td></tr>
<tr><td><code id="patK_+3A_fixedstartcenter">fixedStartCenter</code></td>
<td>
<p>Specify a dataframe with start centers for k-means clustering.</p>
</td></tr>
<tr><td><code id="patK_+3A_resamplefactor">resampleFactor</code></td>
<td>
<p>Integer for downsampling used by <code><a href="#topic+redRes">redRes</a></code>.</p>
</td></tr>
<tr><td><code id="patK_+3A_maskoutline">maskOutline</code></td>
<td>
<p>When outline is specified, everything outside of the outline will be masked for
the color extraction (default = NULL).</p>
</td></tr>
<tr><td><code id="patK_+3A_plot">plot</code></td>
<td>
<p>Whether to plot transformed color patterns while processing (default = FALSE).</p>
</td></tr>
<tr><td><code id="patK_+3A_focal">focal</code></td>
<td>
<p>Whether to perform Gaussian blurring (default = FALSE).</p>
</td></tr>
<tr><td><code id="patK_+3A_sigma">sigma</code></td>
<td>
<p>Size of sigma for Gaussian blurring (default = 3).</p>
</td></tr>
<tr><td><code id="patK_+3A_masktona">maskToNA</code></td>
<td>
<p>Replace the color value used for masking (i.e. 0 or 255) with NA.</p>
</td></tr>
<tr><td><code id="patK_+3A_kmeansonall">kmeansOnAll</code></td>
<td>
<p>Whether to perform the kmeans clusters on the combined set of pixels of all images
first (default = FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of summed raster for each k-means cluster objects.
</p>

<hr>
<h2 id='patK_HSV'>Extract colors using k-means clustering (for pre-aligned images).</h2><span id='topic+patK_HSV'></span>

<h3>Description</h3>

<p>Extract colors using k-means clustering (for pre-aligned images).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patK_HSV(
  sampleList,
  k = 3,
  fixedStartCenter = NULL,
  resampleFactor = NULL,
  maskOutline = NULL,
  plot = FALSE,
  focal = FALSE,
  sigma = 3,
  maskToNA = NULL,
  kmeansOnAll = FALSE,
  ignoreHSVvalue = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="patK_HSV_+3A_samplelist">sampleList</code></td>
<td>
<p>List of RasterStack objects.</p>
</td></tr>
<tr><td><code id="patK_HSV_+3A_k">k</code></td>
<td>
<p>Integere for defining number of k-means clusters (default = 3).</p>
</td></tr>
<tr><td><code id="patK_HSV_+3A_fixedstartcenter">fixedStartCenter</code></td>
<td>
<p>Specify a dataframe with start centers for k-means clustering.</p>
</td></tr>
<tr><td><code id="patK_HSV_+3A_resamplefactor">resampleFactor</code></td>
<td>
<p>Integer for downsampling used by <code><a href="#topic+redRes">redRes</a></code>.</p>
</td></tr>
<tr><td><code id="patK_HSV_+3A_maskoutline">maskOutline</code></td>
<td>
<p>When outline is specified, everything outside of the outline will be masked for
the color extraction (default = NULL).</p>
</td></tr>
<tr><td><code id="patK_HSV_+3A_plot">plot</code></td>
<td>
<p>Whether to plot transformed color patterns while processing (default = FALSE).</p>
</td></tr>
<tr><td><code id="patK_HSV_+3A_focal">focal</code></td>
<td>
<p>Whether to perform Gaussian blurring (default = FALSE).</p>
</td></tr>
<tr><td><code id="patK_HSV_+3A_sigma">sigma</code></td>
<td>
<p>Size of sigma for Gaussian blurring (default = 3).</p>
</td></tr>
<tr><td><code id="patK_HSV_+3A_masktona">maskToNA</code></td>
<td>
<p>Replace the color value used for masking (i.e. 0 or 255) with NA.</p>
</td></tr>
<tr><td><code id="patK_HSV_+3A_kmeansonall">kmeansOnAll</code></td>
<td>
<p>Whether to perform the kmeans clusters on the combined set of pixels of all images
first (default = FALSE).</p>
</td></tr>
<tr><td><code id="patK_HSV_+3A_ignorehsvvalue">ignoreHSVvalue</code></td>
<td>
<p>Whether to ignore the HSV value (~darkness).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of summed raster for each k-means cluster objects.
</p>

<hr>
<h2 id='patLanHSV'>Aligns images usings transformations obtained from fixed landmarks and extracts colors
using a predefined RGB values and cutoff value.</h2><span id='topic+patLanHSV'></span>

<h3>Description</h3>

<p>Aligns images usings transformations obtained from fixed landmarks and extracts colors
using a predefined RGB values and cutoff value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patLanHSV(
  sampleList,
  landList,
  HSV,
  resampleFactor = NULL,
  colOffset = 0.1,
  crop = FALSE,
  cropOffset = c(0, 0, 0, 0),
  res = 300,
  transformRef = "meanshape",
  transformType = "tps",
  adjustCoords = FALSE,
  plot = NULL,
  focal = FALSE,
  sigma = 3,
  iterations = 0,
  ignoreHSVvalue = FALSE,
  patternsToFile = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="patLanHSV_+3A_samplelist">sampleList</code></td>
<td>
<p>List of RasterStack objects.</p>
</td></tr>
<tr><td><code id="patLanHSV_+3A_landlist">landList</code></td>
<td>
<p>Landmark list as returned by <code><a href="#topic+makeList">makeList</a></code>.</p>
</td></tr>
<tr><td><code id="patLanHSV_+3A_hsv">HSV</code></td>
<td>
<p>HSV values for color pattern extraction specified as vector.</p>
</td></tr>
<tr><td><code id="patLanHSV_+3A_resamplefactor">resampleFactor</code></td>
<td>
<p>Integer for downsampling used by <code><a href="#topic+redRes">redRes</a></code>.</p>
</td></tr>
<tr><td><code id="patLanHSV_+3A_coloffset">colOffset</code></td>
<td>
<p>Color offset for color pattern extraction (default = 0.10).</p>
</td></tr>
<tr><td><code id="patLanHSV_+3A_crop">crop</code></td>
<td>
<p>Whether to use the landmarks range to crop the image. This can speed up the
analysis (default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanHSV_+3A_cropoffset">cropOffset</code></td>
<td>
<p>Vector c(xmin, xmax, ymin, ymax) that specifies the number of pixels you
want the cropping to be offset from the landmarks (in case the landmarks do not surround
the entire color pattern). The values specified should present the percentage of the maximum
landmark value along the x and y axis.</p>
</td></tr>
<tr><td><code id="patLanHSV_+3A_res">res</code></td>
<td>
<p>Resolution for color pattern raster (default = 300). This should be reduced if
the number of pixels in the image is lower than th raster.</p>
</td></tr>
<tr><td><code id="patLanHSV_+3A_transformref">transformRef</code></td>
<td>
<p>ID of reference sample for shape to which color patterns will be transformed
to. Can be 'meanshape' for transforming to mean shape of Procrustes analysis.</p>
</td></tr>
<tr><td><code id="patLanHSV_+3A_transformtype">transformType</code></td>
<td>
<p>Transformation type as used by <code><a href="Morpho.html#topic+computeTransform">computeTransform</a></code>
(default ='tps').</p>
</td></tr>
<tr><td><code id="patLanHSV_+3A_adjustcoords">adjustCoords</code></td>
<td>
<p>Adjust landmark coordinates in case they are reversed compared to pixel
coordinates (default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanHSV_+3A_plot">plot</code></td>
<td>
<p>Whether to plot transformed color patterns while processing (default = NULL).
Transformed color patterns can be plot on top of each other ('stack') or next to the
original image for each sample ('compare').</p>
</td></tr>
<tr><td><code id="patLanHSV_+3A_focal">focal</code></td>
<td>
<p>Whether to perform Gaussian blurring (default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanHSV_+3A_sigma">sigma</code></td>
<td>
<p>Size of sigma for Gaussian blurring (default = 3).</p>
</td></tr>
<tr><td><code id="patLanHSV_+3A_iterations">iterations</code></td>
<td>
<p>Number of iterations for recalculating average color.</p>
</td></tr>
<tr><td><code id="patLanHSV_+3A_ignorehsvvalue">ignoreHSVvalue</code></td>
<td>
<p>Whether to ignore the HSV value (~darkness).</p>
</td></tr>
<tr><td><code id="patLanHSV_+3A_patternstofile">patternsToFile</code></td>
<td>
<p>Name of directory to which the color pattern of each individual will be
outputted (default = NULL).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of raster objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
IDlist &lt;- c('BC0077','BC0071','BC0050','BC0049','BC0004')
prepath &lt;- system.file("extdata",  package = 'patternize')
extension &lt;- '_landmarks_LFW.txt'

landmarkList &lt;- makeList(IDlist, 'landmark', prepath, extension)

extension &lt;- '.jpg'
imageList &lt;- makeList(IDlist, 'image', prepath, extension)

HSV &lt;- c(0.025,1,0.45)
rasterList_lanHSV &lt;- patLanRGB(imageList, landmarkList, HSV,
colOffset = 0.15, crop = TRUE, res = 100, adjustCoords = TRUE, plot = 'stack')

## End(Not run)

</code></pre>

<hr>
<h2 id='patLanK'>Aligns images usings transformations obtained from fixed landmarks and extracts colors using
k-means clustering.</h2><span id='topic+patLanK'></span>

<h3>Description</h3>

<p>Aligns images usings transformations obtained from fixed landmarks and extracts colors using
k-means clustering.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patLanK(
  sampleList,
  landList,
  k = 3,
  fixedStartCenter = NULL,
  resampleFactor = NULL,
  crop = FALSE,
  cropOffset = c(0, 0, 0, 0),
  res = 300,
  transformRef = "meanshape",
  transformType = "tps",
  removebg = NULL,
  removebgColOffset = 0.1,
  adjustCoords = FALSE,
  plot = FALSE,
  focal = FALSE,
  sigma = 3
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="patLanK_+3A_samplelist">sampleList</code></td>
<td>
<p>List of RasterStack objects.</p>
</td></tr>
<tr><td><code id="patLanK_+3A_landlist">landList</code></td>
<td>
<p>Landmark list as returned by <code><a href="#topic+makeList">makeList</a></code>.</p>
</td></tr>
<tr><td><code id="patLanK_+3A_k">k</code></td>
<td>
<p>Integere for defining number of k-means clusters (default = 3).</p>
</td></tr>
<tr><td><code id="patLanK_+3A_fixedstartcenter">fixedStartCenter</code></td>
<td>
<p>Specify a dataframe with start centers for k-means clustering.</p>
</td></tr>
<tr><td><code id="patLanK_+3A_resamplefactor">resampleFactor</code></td>
<td>
<p>Integer for downsampling used by <code><a href="#topic+redRes">redRes</a></code>.</p>
</td></tr>
<tr><td><code id="patLanK_+3A_crop">crop</code></td>
<td>
<p>Whether to use the landmarks range to crop the image. This can significantly speed
up the analysis (default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanK_+3A_cropoffset">cropOffset</code></td>
<td>
<p>Vector c(xmin, xmax, ymin, ymax) that specifies the number of pixels you
want the cropping to be offset from the landmarks (in case the landmarks do not surround
the entire color pattern). The values specified should present the percentage of the maximum
landmark value along the x and y axis.</p>
</td></tr>
<tr><td><code id="patLanK_+3A_res">res</code></td>
<td>
<p>Resolution for color pattern raster (default = 300). This should be reduced if the
number of pixels in the image is lower than th raster.</p>
</td></tr>
<tr><td><code id="patLanK_+3A_transformref">transformRef</code></td>
<td>
<p>ID of reference sample for shape to which color patterns will be transformed
to. Can be 'meanshape' for transforming to mean shape of Procrustes analysis.</p>
</td></tr>
<tr><td><code id="patLanK_+3A_transformtype">transformType</code></td>
<td>
<p>Transformation type as used by <code><a href="Morpho.html#topic+computeTransform">computeTransform</a></code>
(default ='tps').</p>
</td></tr>
<tr><td><code id="patLanK_+3A_removebg">removebg</code></td>
<td>
<p>Integer or RGB vector indicating the range of RGB threshold to remove from
image (e.g. 100 removes pixels with average RGB &gt; 100; default = NULL).</p>
</td></tr>
<tr><td><code id="patLanK_+3A_removebgcoloffset">removebgColOffset</code></td>
<td>
<p>Color offset for color background extraction (default = 0.10).</p>
</td></tr>
<tr><td><code id="patLanK_+3A_adjustcoords">adjustCoords</code></td>
<td>
<p>Adjust landmark coordinates in case they are reversed compared to pixel
coordinates (default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanK_+3A_plot">plot</code></td>
<td>
<p>Whether to plot transformed color patterns while processing (default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanK_+3A_focal">focal</code></td>
<td>
<p>Whether to perform Gaussian blurring (default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanK_+3A_sigma">sigma</code></td>
<td>
<p>Size of sigma for Gaussian blurring (default = 3).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of summed raster for each k-means cluster objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
IDlist &lt;- c('BC0077','BC0071','BC0050','BC0049','BC0004')
prepath &lt;- system.file("extdata",  package = 'patternize')
extension &lt;- '_landmarks_LFW.txt'
landmarkList &lt;- makeList(IDlist, 'landmark', prepath, extension)

extension &lt;- '.jpg'
imageList &lt;- makeList(IDlist, 'image', prepath, extension)
# Note that this example only aligns two images with the target,
# remove [1:2] to run a full examples.
rasterList_lanK &lt;- patLanK(imageList[1:2], landmarkList[1:2], k = 4, crop = TRUE,
res = 100, removebg = 100, adjustCoords = TRUE, plot = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='patLanK_HSV'>Aligns images usings transformations obtained from fixed landmarks and extracts colors using
k-means clustering.</h2><span id='topic+patLanK_HSV'></span>

<h3>Description</h3>

<p>Aligns images usings transformations obtained from fixed landmarks and extracts colors using
k-means clustering.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patLanK_HSV(
  sampleList,
  landList,
  k = 3,
  fixedStartCenter = NULL,
  resampleFactor = NULL,
  crop = FALSE,
  cropOffset = c(0, 0, 0, 0),
  res = 300,
  transformRef = "meanshape",
  transformType = "tps",
  removebgK = NULL,
  adjustCoords = FALSE,
  plot = FALSE,
  focal = FALSE,
  sigma = 3,
  ignoreHSVvalue = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="patLanK_HSV_+3A_samplelist">sampleList</code></td>
<td>
<p>List of RasterStack objects.</p>
</td></tr>
<tr><td><code id="patLanK_HSV_+3A_landlist">landList</code></td>
<td>
<p>Landmark list as returned by <code><a href="#topic+makeList">makeList</a></code>.</p>
</td></tr>
<tr><td><code id="patLanK_HSV_+3A_k">k</code></td>
<td>
<p>Integere for defining number of k-means clusters (default = 3).</p>
</td></tr>
<tr><td><code id="patLanK_HSV_+3A_fixedstartcenter">fixedStartCenter</code></td>
<td>
<p>Specify a dataframe with start centers for k-means clustering.</p>
</td></tr>
<tr><td><code id="patLanK_HSV_+3A_resamplefactor">resampleFactor</code></td>
<td>
<p>Integer for downsampling used by <code><a href="#topic+redRes">redRes</a></code>.</p>
</td></tr>
<tr><td><code id="patLanK_HSV_+3A_crop">crop</code></td>
<td>
<p>Whether to use the landmarks range to crop the image. This can significantly speed
up the analysis (default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanK_HSV_+3A_cropoffset">cropOffset</code></td>
<td>
<p>Vector c(xmin, xmax, ymin, ymax) that specifies the number of pixels you
want the cropping to be offset from the landmarks (in case the landmarks do not surround
the entire color pattern). The values specified should present the percentage of the maximum
landmark value along the x and y axis.</p>
</td></tr>
<tr><td><code id="patLanK_HSV_+3A_res">res</code></td>
<td>
<p>Resolution for color pattern raster (default = 300). This should be reduced if the
number of pixels in the image is lower than th raster.</p>
</td></tr>
<tr><td><code id="patLanK_HSV_+3A_transformref">transformRef</code></td>
<td>
<p>ID of reference sample for shape to which color patterns will be transformed
to. Can be 'meanshape' for transforming to mean shape of Procrustes analysis.</p>
</td></tr>
<tr><td><code id="patLanK_HSV_+3A_transformtype">transformType</code></td>
<td>
<p>Transformation type as used by <code><a href="Morpho.html#topic+computeTransform">computeTransform</a></code>
(default ='tps').</p>
</td></tr>
<tr><td><code id="patLanK_HSV_+3A_removebgk">removebgK</code></td>
<td>
<p>Integer indicating the range RGB treshold to remove from image (e.g. 100
removes pixels with average RGB &gt; 100; default = NULL) for k-means analysis. This works only
to remove a white background.</p>
</td></tr>
<tr><td><code id="patLanK_HSV_+3A_adjustcoords">adjustCoords</code></td>
<td>
<p>Adjust landmark coordinates in case they are reversed compared to pixel
coordinates (default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanK_HSV_+3A_plot">plot</code></td>
<td>
<p>Whether to plot transformed color patterns while processing (default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanK_HSV_+3A_focal">focal</code></td>
<td>
<p>Whether to perform Gaussian blurring (default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanK_HSV_+3A_sigma">sigma</code></td>
<td>
<p>Size of sigma for Gaussian blurring (default = 3).</p>
</td></tr>
<tr><td><code id="patLanK_HSV_+3A_ignorehsvvalue">ignoreHSVvalue</code></td>
<td>
<p>Whether to ignore the HSV value (~darkness).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of summed raster for each k-means cluster objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
IDlist &lt;- c('BC0077','BC0071','BC0050','BC0049','BC0004')
prepath &lt;- system.file("extdata",  package = 'patternize')
extension &lt;- '_landmarks_LFW.txt'
landmarkList &lt;- makeList(IDlist, 'landmark', prepath, extension)

extension &lt;- '.jpg'
imageList &lt;- makeList(IDlist, 'image', prepath, extension)
# Note that this example only aligns two images with the target,
# remove [1:2] to run a full examples.
rasterList_lanK &lt;- patLanK(imageList[1:2], landmarkList[1:2], k = 4, crop = TRUE,
res = 100, removebgK = 100, adjustCoords = TRUE, plot = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='patLanRGB'>Aligns images usings transformations obtained from fixed landmarks and extracts colors
using a predefined RGB values and cutoff value.</h2><span id='topic+patLanRGB'></span>

<h3>Description</h3>

<p>Aligns images usings transformations obtained from fixed landmarks and extracts colors
using a predefined RGB values and cutoff value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patLanRGB(
  sampleList,
  landList,
  RGB = NULL,
  sampleRGB = FALSE,
  sampleRGBtype = "point",
  resampleFactor = NULL,
  colOffset = 0.1,
  crop = FALSE,
  cropOffset = c(0, 0, 0, 0),
  res = 300,
  transformRef = "meanshape",
  transformType = "tps",
  adjustCoords = FALSE,
  plot = NULL,
  focal = FALSE,
  sigma = 3,
  iterations = 0,
  imageIDs = NULL,
  patternsToFile = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="patLanRGB_+3A_samplelist">sampleList</code></td>
<td>
<p>List of RasterStack objects.</p>
</td></tr>
<tr><td><code id="patLanRGB_+3A_landlist">landList</code></td>
<td>
<p>Landmark list as returned by <code><a href="#topic+makeList">makeList</a></code>.</p>
</td></tr>
<tr><td><code id="patLanRGB_+3A_rgb">RGB</code></td>
<td>
<p>RGB values for color pattern extraction specified as vector.</p>
</td></tr>
<tr><td><code id="patLanRGB_+3A_samplergb">sampleRGB</code></td>
<td>
<p>Whether to set RGB for each image manually.</p>
</td></tr>
<tr><td><code id="patLanRGB_+3A_samplergbtype">sampleRGBtype</code></td>
<td>
<p>Whether to pick a point or area (defined by left bottom and top right)
for sampleRGB.</p>
</td></tr>
<tr><td><code id="patLanRGB_+3A_resamplefactor">resampleFactor</code></td>
<td>
<p>Integer for downsampling used by <code><a href="#topic+redRes">redRes</a></code>.</p>
</td></tr>
<tr><td><code id="patLanRGB_+3A_coloffset">colOffset</code></td>
<td>
<p>Color offset for color pattern extraction (default = 0.10).</p>
</td></tr>
<tr><td><code id="patLanRGB_+3A_crop">crop</code></td>
<td>
<p>Whether to use the landmarks range to crop the image. This can speed up the
analysis (default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanRGB_+3A_cropoffset">cropOffset</code></td>
<td>
<p>Vector c(xmin, xmax, ymin, ymax) that specifies the number of pixels you
want the cropping to be offset from the landmarks (in case the landmarks do not surround
the entire color pattern). The values specified should present the percentage of the maximum
landmark value along the x and y axis.</p>
</td></tr>
<tr><td><code id="patLanRGB_+3A_res">res</code></td>
<td>
<p>Resolution for color pattern raster (default = 300). This should be reduced if
the number of pixels in the image is lower than th raster.</p>
</td></tr>
<tr><td><code id="patLanRGB_+3A_transformref">transformRef</code></td>
<td>
<p>ID of reference sample for shape to which color patterns will be transformed
to. Can be 'meanshape' for transforming to mean shape of Procrustes analysis.</p>
</td></tr>
<tr><td><code id="patLanRGB_+3A_transformtype">transformType</code></td>
<td>
<p>Transformation type as used by <code><a href="Morpho.html#topic+computeTransform">computeTransform</a></code>
(default ='tps').</p>
</td></tr>
<tr><td><code id="patLanRGB_+3A_adjustcoords">adjustCoords</code></td>
<td>
<p>Adjust landmark coordinates in case they are reversed compared to pixel
coordinates (default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanRGB_+3A_plot">plot</code></td>
<td>
<p>Whether to plot transformed color patterns while processing (default = NULL).
Transformed color patterns can be plot on top of each other ('stack') or next to the
original image for each sample ('compare').</p>
</td></tr>
<tr><td><code id="patLanRGB_+3A_focal">focal</code></td>
<td>
<p>Whether to perform Gaussian blurring (default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanRGB_+3A_sigma">sigma</code></td>
<td>
<p>Size of sigma for Gaussian blurring (default = 3).</p>
</td></tr>
<tr><td><code id="patLanRGB_+3A_iterations">iterations</code></td>
<td>
<p>Number of iterations for recalculating average color.</p>
</td></tr>
<tr><td><code id="patLanRGB_+3A_imageids">imageIDs</code></td>
<td>
<p>A list of IDs to match landmarks to images if landmarkList and imageList don't
have the same length.</p>
</td></tr>
<tr><td><code id="patLanRGB_+3A_patternstofile">patternsToFile</code></td>
<td>
<p>Name of directory to which the color pattern of each individual will be
outputted (default = NULL).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of raster objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
IDlist &lt;- c('BC0077','BC0071','BC0050','BC0049','BC0004')
prepath &lt;- system.file("extdata",  package = 'patternize')
extension &lt;- '_landmarks_LFW.txt'

landmarkList &lt;- makeList(IDlist, 'landmark', prepath, extension)

extension &lt;- '.jpg'
imageList &lt;- makeList(IDlist, 'image', prepath, extension)

RGB &lt;- c(114,17,0)
rasterList_lanRGB &lt;- patLanRGB(imageList, landmarkList, RGB,
colOffset = 0.15, crop = TRUE, res = 100, adjustCoords = TRUE, plot = 'stack')

## End(Not run)

</code></pre>

<hr>
<h2 id='patLanW'>Extracts color pattern from landmark transformed image using watershed segmentation. This function
works interactively by allowing to pick a starting pixel within each pattern element from which the
watershed will extract the pattern. This function works best for patterns with sharp boundaries.</h2><span id='topic+patLanW'></span>

<h3>Description</h3>

<p>Extracts color pattern from landmark transformed image using watershed segmentation. This function
works interactively by allowing to pick a starting pixel within each pattern element from which the
watershed will extract the pattern. This function works best for patterns with sharp boundaries.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patLanW(
  sampleList,
  landList,
  IDlist = NULL,
  adjustCoords = FALSE,
  transformRef = "meanshape",
  resampleFactor = NULL,
  transformType = "tps",
  maskOutline = NULL,
  cartoonID = NULL,
  correct = FALSE,
  blur = TRUE,
  sigma = 3,
  bucketfill = TRUE,
  cleanP = NULL,
  splitC = NULL,
  plotTransformed = FALSE,
  plotCorrect = FALSE,
  plotEdges = FALSE,
  plotPriority = FALSE,
  plotWS = FALSE,
  plotBF = FALSE,
  plotFinal = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="patLanW_+3A_samplelist">sampleList</code></td>
<td>
<p>List of RasterStack objects.</p>
</td></tr>
<tr><td><code id="patLanW_+3A_landlist">landList</code></td>
<td>
<p>Landmark list as returned by <code><a href="#topic+makeList">makeList</a></code>.</p>
</td></tr>
<tr><td><code id="patLanW_+3A_idlist">IDlist</code></td>
<td>
<p>List of sample IDs should be specified when masking outline and transformRef
is 'meanshape'.</p>
</td></tr>
<tr><td><code id="patLanW_+3A_adjustcoords">adjustCoords</code></td>
<td>
<p>Adjust landmark coordinates in case they are reversed compared to pixel
coordinates (default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanW_+3A_transformref">transformRef</code></td>
<td>
<p>ID or landmark matrix of reference sample for shape to which color patterns
will be transformed to. Can be 'meanshape' for transforming to mean shape of Procrustes
analysis.</p>
</td></tr>
<tr><td><code id="patLanW_+3A_resamplefactor">resampleFactor</code></td>
<td>
<p>Integer for downsampling image used by <code><a href="#topic+redRes">redRes</a></code>.</p>
</td></tr>
<tr><td><code id="patLanW_+3A_transformtype">transformType</code></td>
<td>
<p>Transformation type as used by <code><a href="Morpho.html#topic+computeTransform">computeTransform</a></code>
(default ='tps').</p>
</td></tr>
<tr><td><code id="patLanW_+3A_maskoutline">maskOutline</code></td>
<td>
<p>When outline is specified, everything outside of the outline will be masked for
the color extraction (default = NULL).</p>
</td></tr>
<tr><td><code id="patLanW_+3A_cartoonid">cartoonID</code></td>
<td>
<p>ID of the sample for which the cartoon was drawn and will be used for masking
(should be set when transformRef = 'meanShape').</p>
</td></tr>
<tr><td><code id="patLanW_+3A_correct">correct</code></td>
<td>
<p>Correct image illumination using a linear model (default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanW_+3A_blur">blur</code></td>
<td>
<p>Blur image for priority map extraction (default = TRUE).</p>
</td></tr>
<tr><td><code id="patLanW_+3A_sigma">sigma</code></td>
<td>
<p>Size of sigma for Gaussian blurring (default = 5).</p>
</td></tr>
<tr><td><code id="patLanW_+3A_bucketfill">bucketfill</code></td>
<td>
<p>Use a bucket fill on the background to fill holes (default = TRUE).</p>
</td></tr>
<tr><td><code id="patLanW_+3A_cleanp">cleanP</code></td>
<td>
<p>Integer to remove spurious areas with width smaller than cleanP (default = NULL).</p>
</td></tr>
<tr><td><code id="patLanW_+3A_splitc">splitC</code></td>
<td>
<p>Integer to split selected patterns into connected components and remove ones with
areas smaller than splitC (default = NULL).</p>
</td></tr>
<tr><td><code id="patLanW_+3A_plottransformed">plotTransformed</code></td>
<td>
<p>Plot transformed image (default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanW_+3A_plotcorrect">plotCorrect</code></td>
<td>
<p>Plot corrected image, corrected for illumination using a linear model
(default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanW_+3A_plotedges">plotEdges</code></td>
<td>
<p>Plot image gradient (default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanW_+3A_plotpriority">plotPriority</code></td>
<td>
<p>Plot priority map (default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanW_+3A_plotws">plotWS</code></td>
<td>
<p>Plot watershed result (default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanW_+3A_plotbf">plotBF</code></td>
<td>
<p>Plot bucketfill (default = FALSE).</p>
</td></tr>
<tr><td><code id="patLanW_+3A_plotfinal">plotFinal</code></td>
<td>
<p>Plot extracted patterns (default = FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of raster objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
IDlist &lt;- c('BC0077','BC0071','BC0050','BC0049','BC0004')
prepath &lt;- system.file("extdata",  package = 'patternize')
extension &lt;- '_landmarks_LFW.txt'

landmarkList &lt;- makeList(IDlist, 'landmark', prepath, extension)

extension &lt;- '.jpg'
imageList &lt;- makeList(IDlist, 'image', prepath, extension)

outline_BC0077 &lt;- read.table(paste(system.file("extdata",  package = 'patternize'),
'/BC0077_outline.txt', sep=''), header = FALSE)

rasterList_W &lt;- patLanW(imageList, landmarkList, IDlist, transformRef = 'meanshape',
adjustCoords = TRUE, plotTransformed = FALSE, correct = TRUE, plotCorrect = FALSE, blur = FALSE,
sigma = 2, bucketfill = FALSE, cleanP = 0, splitC = 10, plotPriority = TRUE, plotWS = TRUE,
plotBF = TRUE, plotFinal = TRUE, maskOutline = outline_BC0077, cartoonID = 'BC0077')

## End(Not run)

</code></pre>

<hr>
<h2 id='patPCA'>This function transforms the individual color pattern rasters as obtained by the main
patternize functions to a dataframe of 0 and 1 values that can be used for Principal
Component Analysis (<code><a href="stats.html#topic+prcomp">prcomp</a></code>). This function also allows to plot the
analysis including a visualization of the shape changes along the axis. Pixel values
are predicted by multiplying the rotation matrix (eigenvectors) with a vector that has
the same length as the number of rows in the rotation matrix and in which all values are
set to zero except for the PC value for which we want to predict the pixel values.</h2><span id='topic+patPCA'></span>

<h3>Description</h3>

<p>This function transforms the individual color pattern rasters as obtained by the main
patternize functions to a dataframe of 0 and 1 values that can be used for Principal
Component Analysis (<code><a href="stats.html#topic+prcomp">prcomp</a></code>). This function also allows to plot the
analysis including a visualization of the shape changes along the axis. Pixel values
are predicted by multiplying the rotation matrix (eigenvectors) with a vector that has
the same length as the number of rows in the rotation matrix and in which all values are
set to zero except for the PC value for which we want to predict the pixel values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patPCA(
  rList,
  popList,
  colList,
  symbolList = NULL,
  rListPredict = NULL,
  popListPredict = NULL,
  colListPredict = NULL,
  pcaListPredict = NULL,
  pcaPopListPredict = NULL,
  pcaColPredict = "red",
  symbolListPredict = NULL,
  plot = FALSE,
  plotType = "points",
  plotChanges = FALSE,
  PCx = 1,
  PCy = 2,
  plotCartoon = FALSE,
  refShape = NULL,
  outline = NULL,
  lines = NULL,
  landList = NULL,
  adjustCoords = FALSE,
  crop = c(0, 0, 0, 0),
  flipRaster = NULL,
  flipOutline = NULL,
  imageList = NULL,
  cartoonID = NULL,
  refImage = NULL,
  colpalette = NULL,
  normalized = NULL,
  cartoonOrder = "above",
  lineOrder = "above",
  cartoonCol = "gray",
  cartoonFill = NULL,
  plotLandmarks = FALSE,
  landCol = "black",
  zlim = c(-1, 1),
  legendTitle = "Predicted",
  xlab = "",
  ylab = "",
  main = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="patPCA_+3A_rlist">rList</code></td>
<td>
<p>List of raster objects.</p>
</td></tr>
<tr><td><code id="patPCA_+3A_poplist">popList</code></td>
<td>
<p>List of vectors including sampleIDs for each population.</p>
</td></tr>
<tr><td><code id="patPCA_+3A_collist">colList</code></td>
<td>
<p>List of colors for each population.</p>
</td></tr>
<tr><td><code id="patPCA_+3A_symbollist">symbolList</code></td>
<td>
<p>List with graphical plotting symbols (default = NULL).</p>
</td></tr>
<tr><td><code id="patPCA_+3A_rlistpredict">rListPredict</code></td>
<td>
<p>List of raster objects to predict into PCA space (default = NULL).</p>
</td></tr>
<tr><td><code id="patPCA_+3A_poplistpredict">popListPredict</code></td>
<td>
<p>List of vectors including sampleIDs for each set of predict samples
(default = NULL). Note to that this also has to be a list if only one population is included.</p>
</td></tr>
<tr><td><code id="patPCA_+3A_collistpredict">colListPredict</code></td>
<td>
<p>List of colors for each set of predict samples (default = NULL).</p>
</td></tr>
<tr><td><code id="patPCA_+3A_pcalistpredict">pcaListPredict</code></td>
<td>
<p>Points to plot within PCA space.</p>
</td></tr>
<tr><td><code id="patPCA_+3A_pcapoplistpredict">pcaPopListPredict</code></td>
<td>
<p>List of population symbols for plotting additional PCA values.</p>
</td></tr>
<tr><td><code id="patPCA_+3A_pcacolpredict">pcaColPredict</code></td>
<td>
<p>Color for additional PCA values.</p>
</td></tr>
<tr><td><code id="patPCA_+3A_symbollistpredict">symbolListPredict</code></td>
<td>
<p>List with graphical plotting symbols for predict sets (default = NULL).</p>
</td></tr>
<tr><td><code id="patPCA_+3A_plot">plot</code></td>
<td>
<p>Whether to plot the PCA analysis (default = FALSE).</p>
</td></tr>
<tr><td><code id="patPCA_+3A_plottype">plotType</code></td>
<td>
<p>Plot 'points' or sample 'labels' (default = 'points')</p>
</td></tr>
<tr><td><code id="patPCA_+3A_plotchanges">plotChanges</code></td>
<td>
<p>Wether to include plots of the changes along the PC axis (default = FALSE).</p>
</td></tr>
<tr><td><code id="patPCA_+3A_pcx">PCx</code></td>
<td>
<p>PC axis to be presented for x-axis (default PC1).</p>
</td></tr>
<tr><td><code id="patPCA_+3A_pcy">PCy</code></td>
<td>
<p>PC axis to be presented for y-axis (default PC2).</p>
</td></tr>
<tr><td><code id="patPCA_+3A_plotcartoon">plotCartoon</code></td>
<td>
<p>Whether to plot a cartoon. This cartoon should be drawn on one of the
samples used in the analysis.</p>
</td></tr>
<tr><td><code id="patPCA_+3A_refshape">refShape</code></td>
<td>
<p>This can be 'target' in case the reference shape is a single sample (for
registration analysis) or 'mean' if the images were transformed to a mean shape (only for
meanshape when using landmark transformation)</p>
</td></tr>
<tr><td><code id="patPCA_+3A_outline">outline</code></td>
<td>
<p>xy coordinates that define outline.</p>
</td></tr>
<tr><td><code id="patPCA_+3A_lines">lines</code></td>
<td>
<p>list of files with xy coordinates of line objects to be added to cartoon.</p>
</td></tr>
<tr><td><code id="patPCA_+3A_landlist">landList</code></td>
<td>
<p>Landmark landmarkList.</p>
</td></tr>
<tr><td><code id="patPCA_+3A_adjustcoords">adjustCoords</code></td>
<td>
<p>Adjust landmark coordinates.</p>
</td></tr>
<tr><td><code id="patPCA_+3A_crop">crop</code></td>
<td>
<p>Vector c(xmin, xmax, ymin, ymax) that specifies the pixel coordinates to crop
the original image used in landmark or registration analysis.</p>
</td></tr>
<tr><td><code id="patPCA_+3A_flipraster">flipRaster</code></td>
<td>
<p>Whether to flip raster along xy axis (in case there is an inconsistency
between raster and outline coordinates).</p>
</td></tr>
<tr><td><code id="patPCA_+3A_flipoutline">flipOutline</code></td>
<td>
<p>Whether to flip plot along x, y or xy axis.</p>
</td></tr>
<tr><td><code id="patPCA_+3A_imagelist">imageList</code></td>
<td>
<p>List of image should be given if one wants to flip the outline or adjust
landmark coordinates.</p>
</td></tr>
<tr><td><code id="patPCA_+3A_cartoonid">cartoonID</code></td>
<td>
<p>ID of the sample for which the cartoon was drawn.</p>
</td></tr>
<tr><td><code id="patPCA_+3A_refimage">refImage</code></td>
<td>
<p>Image (RasterStack) used for target. Use raster::stack('filename').</p>
</td></tr>
<tr><td><code id="patPCA_+3A_colpalette">colpalette</code></td>
<td>
<p>Vector of colors for color palette
(default = c(&quot;white&quot;,&quot;lightblue&quot;,&quot;blue&quot;,&quot;green&quot;, &quot;yellow&quot;,&quot;red&quot;))</p>
</td></tr>
<tr><td><code id="patPCA_+3A_normalized">normalized</code></td>
<td>
<p>Set this to true in case the summed rasters are already devided by the
sample number.</p>
</td></tr>
<tr><td><code id="patPCA_+3A_cartoonorder">cartoonOrder</code></td>
<td>
<p>Whether to plot the cartoon outline 'above' or 'under' the pattern raster
(default = 'above'). Set to 'under' for filled outlines.</p>
</td></tr>
<tr><td><code id="patPCA_+3A_lineorder">lineOrder</code></td>
<td>
<p>Whether to plot the cartoon lines 'above' or 'under' the pattern raster
(default = 'above').</p>
</td></tr>
<tr><td><code id="patPCA_+3A_cartooncol">cartoonCol</code></td>
<td>
<p>Outline and line color for cartoon (deafault = 'gray').</p>
</td></tr>
<tr><td><code id="patPCA_+3A_cartoonfill">cartoonFill</code></td>
<td>
<p>Fill color for outline of cartoon (default = NULL).</p>
</td></tr>
<tr><td><code id="patPCA_+3A_plotlandmarks">plotLandmarks</code></td>
<td>
<p>Whether to plot the landmarks from the target image or mean shape
landmarks (default = FALSE).</p>
</td></tr>
<tr><td><code id="patPCA_+3A_landcol">landCol</code></td>
<td>
<p>Color for plotting landmarks (default = 'black').</p>
</td></tr>
<tr><td><code id="patPCA_+3A_zlim">zlim</code></td>
<td>
<p>z-axis limit (default = c(0,1))</p>
</td></tr>
<tr><td><code id="patPCA_+3A_legendtitle">legendTitle</code></td>
<td>
<p>Title of the raster legend (default = 'Proportion')</p>
</td></tr>
<tr><td><code id="patPCA_+3A_xlab">xlab</code></td>
<td>
<p>Optional x-axis label.</p>
</td></tr>
<tr><td><code id="patPCA_+3A_ylab">ylab</code></td>
<td>
<p>Optional y-axis label.</p>
</td></tr>
<tr><td><code id="patPCA_+3A_main">main</code></td>
<td>
<p>Optional main title.</p>
</td></tr>
<tr><td><code id="patPCA_+3A_...">...</code></td>
<td>
<p>additional arguments for PCA plot function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If plot = TRUE: List including a [1] dataframe of the binary raster values that can be used for
principle component analysis, [2] a dataframe of sample IDs and specified population
colors and [3] prcomp results. If plot = FALSE: prcomp result.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+prcomp">prcomp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(rasterList_lanRGB)

pop1 &lt;- c('BC0077','BC0071')
pop2 &lt;- c('BC0050','BC0049','BC0004')
popList &lt;- list(pop1, pop2)
colList &lt;- c("red", "blue")

pcaOut &lt;- patPCA(rasterList_lanRGB, popList, colList, plot = TRUE)

</code></pre>

<hr>
<h2 id='patRDA'>This function transforms the individual color pattern rasters as obtained by the main
patternize functions to a dataframe of 0 and 1 values that can be used for constrained
Redundancy Analysis (RDA) (<code><a href="vegan.html#topic+rda">rda</a></code>). This function also allows to plot the
analysis including a visualization of the shape changes along the axis.</h2><span id='topic+patRDA'></span>

<h3>Description</h3>

<p>This function transforms the individual color pattern rasters as obtained by the main
patternize functions to a dataframe of 0 and 1 values that can be used for constrained
Redundancy Analysis (RDA) (<code><a href="vegan.html#topic+rda">rda</a></code>). This function also allows to plot the
analysis including a visualization of the shape changes along the axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patRDA(
  rList,
  popList,
  colList,
  symbolList = NULL,
  rListPredict = NULL,
  popListPredict = NULL,
  colListPredict = NULL,
  symbolListPredict = NULL,
  plot = FALSE,
  plotType = "points",
  plotChanges = FALSE,
  PCx = 1,
  PCy = 2,
  plotCartoon = FALSE,
  refShape = NULL,
  outline = NULL,
  lines = NULL,
  landList = NULL,
  adjustCoords = FALSE,
  crop = c(0, 0, 0, 0),
  flipRaster = NULL,
  flipOutline = NULL,
  imageList = NULL,
  cartoonID = NULL,
  colpalette = NULL,
  normalized = NULL,
  cartoonOrder = "above",
  lineOrder = "above",
  cartoonCol = "gray",
  cartoonFill = NULL,
  plotLandmarks = FALSE,
  landCol = "black",
  zlim = c(-1, 1),
  legendTitle = "Predicted",
  xlab = "",
  ylab = "",
  main = ""
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="patRDA_+3A_rlist">rList</code></td>
<td>
<p>List of raster objects.</p>
</td></tr>
<tr><td><code id="patRDA_+3A_poplist">popList</code></td>
<td>
<p>List of vectors including sampleIDs for each population.</p>
</td></tr>
<tr><td><code id="patRDA_+3A_collist">colList</code></td>
<td>
<p>List of colors for each population.</p>
</td></tr>
<tr><td><code id="patRDA_+3A_symbollist">symbolList</code></td>
<td>
<p>List with graphical plotting symbols (default = NULL).</p>
</td></tr>
<tr><td><code id="patRDA_+3A_rlistpredict">rListPredict</code></td>
<td>
<p>List of raster objects to predict into DFA space (default = NULL).</p>
</td></tr>
<tr><td><code id="patRDA_+3A_poplistpredict">popListPredict</code></td>
<td>
<p>List of vectors including sampleIDs for each set of predict samples
(default = NULL). Note to that this also has to be a list if only one population is included.</p>
</td></tr>
<tr><td><code id="patRDA_+3A_collistpredict">colListPredict</code></td>
<td>
<p>List of colors for each set of predict samples (default = NULL).</p>
</td></tr>
<tr><td><code id="patRDA_+3A_symbollistpredict">symbolListPredict</code></td>
<td>
<p>List with graphical plotting symbols for predict sets (default = NULL).</p>
</td></tr>
<tr><td><code id="patRDA_+3A_plot">plot</code></td>
<td>
<p>Whether to plot the PCA analysis (default = FALSE).</p>
</td></tr>
<tr><td><code id="patRDA_+3A_plottype">plotType</code></td>
<td>
<p>Plot 'points' or sample 'labels' (default = 'points')</p>
</td></tr>
<tr><td><code id="patRDA_+3A_plotchanges">plotChanges</code></td>
<td>
<p>Wether to include plots of the changes along the PC axis (default = FALSE).</p>
</td></tr>
<tr><td><code id="patRDA_+3A_pcx">PCx</code></td>
<td>
<p>PC axis to be presented for x-axis (default PC1).</p>
</td></tr>
<tr><td><code id="patRDA_+3A_pcy">PCy</code></td>
<td>
<p>PC axis to be presented for y-axis (default PC2).</p>
</td></tr>
<tr><td><code id="patRDA_+3A_plotcartoon">plotCartoon</code></td>
<td>
<p>Whether to plot a cartoon. This cartoon should be drawn on one of the
samples used in the analysis.</p>
</td></tr>
<tr><td><code id="patRDA_+3A_refshape">refShape</code></td>
<td>
<p>This can be 'target' in case the reference shape is a single sample (for
registration analysis) or 'mean' if the images were transformed to a mean shape (only for
meanshape when using landmark transformation)</p>
</td></tr>
<tr><td><code id="patRDA_+3A_outline">outline</code></td>
<td>
<p>xy coordinates that define outline.</p>
</td></tr>
<tr><td><code id="patRDA_+3A_lines">lines</code></td>
<td>
<p>list of files with xy coordinates of line objects to be added to cartoon.</p>
</td></tr>
<tr><td><code id="patRDA_+3A_landlist">landList</code></td>
<td>
<p>Landmark landmarkList.</p>
</td></tr>
<tr><td><code id="patRDA_+3A_adjustcoords">adjustCoords</code></td>
<td>
<p>Adjust landmark coordinates.</p>
</td></tr>
<tr><td><code id="patRDA_+3A_crop">crop</code></td>
<td>
<p>Vector c(xmin, xmax, ymin, ymax) that specifies the pixel coordinates to crop
the original image used in landmark or registration analysis.</p>
</td></tr>
<tr><td><code id="patRDA_+3A_flipraster">flipRaster</code></td>
<td>
<p>Whether to flip raster along xy axis (in case there is an inconsistency
between raster and outline coordinates).</p>
</td></tr>
<tr><td><code id="patRDA_+3A_flipoutline">flipOutline</code></td>
<td>
<p>Whether to flip plot along x, y or xy axis.</p>
</td></tr>
<tr><td><code id="patRDA_+3A_imagelist">imageList</code></td>
<td>
<p>List of image should be given if one wants to flip the outline or adjust
landmark coordinates.</p>
</td></tr>
<tr><td><code id="patRDA_+3A_cartoonid">cartoonID</code></td>
<td>
<p>ID of the sample for which the cartoon was drawn.</p>
</td></tr>
<tr><td><code id="patRDA_+3A_colpalette">colpalette</code></td>
<td>
<p>Vector of colors for color palette
(default = c(&quot;white&quot;,&quot;lightblue&quot;,&quot;blue&quot;,&quot;green&quot;, &quot;yellow&quot;,&quot;red&quot;))</p>
</td></tr>
<tr><td><code id="patRDA_+3A_normalized">normalized</code></td>
<td>
<p>Set this to true in case the summed rasters are already devided by the
sample number.</p>
</td></tr>
<tr><td><code id="patRDA_+3A_cartoonorder">cartoonOrder</code></td>
<td>
<p>Whether to plot the cartoon outline 'above' or 'under' the pattern raster
(default = 'above'). Set to 'under' for filled outlines.</p>
</td></tr>
<tr><td><code id="patRDA_+3A_lineorder">lineOrder</code></td>
<td>
<p>Whether to plot the cartoon lines 'above' or 'under' the pattern raster
(default = 'above').</p>
</td></tr>
<tr><td><code id="patRDA_+3A_cartooncol">cartoonCol</code></td>
<td>
<p>Outline and line color for cartoon (deafault = 'gray').</p>
</td></tr>
<tr><td><code id="patRDA_+3A_cartoonfill">cartoonFill</code></td>
<td>
<p>Fill color for outline of cartoon (default = NULL).</p>
</td></tr>
<tr><td><code id="patRDA_+3A_plotlandmarks">plotLandmarks</code></td>
<td>
<p>Whether to plot the landmarks from the target image or mean shape
landmarks (default = FALSE).</p>
</td></tr>
<tr><td><code id="patRDA_+3A_landcol">landCol</code></td>
<td>
<p>Color for plotting landmarks (default = 'black').</p>
</td></tr>
<tr><td><code id="patRDA_+3A_zlim">zlim</code></td>
<td>
<p>z-axis limit (default = c(0,1))</p>
</td></tr>
<tr><td><code id="patRDA_+3A_legendtitle">legendTitle</code></td>
<td>
<p>Title of the raster legend (default = 'Proportion')</p>
</td></tr>
<tr><td><code id="patRDA_+3A_xlab">xlab</code></td>
<td>
<p>Optional x-axis label.</p>
</td></tr>
<tr><td><code id="patRDA_+3A_ylab">ylab</code></td>
<td>
<p>Optional y-axis label.</p>
</td></tr>
<tr><td><code id="patRDA_+3A_main">main</code></td>
<td>
<p>Optional main title.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If plot = TRUE: List including a [1] dataframe of the binary raster values that can be used for
discriminant function analysis, [2] a dataframe of sample IDs and specified population
colors and [3] lda results. if rListPredict not empty: [4] class prediction of samples. If plot = FALSE:
lda result only.
</p>


<h3>See Also</h3>

<p><code><a href="MASS.html#topic+lda">lda</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(rasterList_lanRGB)

pop1 &lt;- c('BC0077','BC0071')
pop2 &lt;- c('BC0050','BC0049','BC0004')
popList &lt;- list(pop1, pop2)
colList &lt;- c("red", "blue")

pcaOut &lt;- patRDA(rasterList_lanRGB, popList, colList, plot = TRUE)

</code></pre>

<hr>
<h2 id='patRegHSV'>Aligns images using <code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code> utilities for automated image registration
and extracts colors using a predefined HSV values and cutoff value.</h2><span id='topic+patRegHSV'></span>

<h3>Description</h3>

<p>Aligns images using <code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code> utilities for automated image registration
and extracts colors using a predefined HSV values and cutoff value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patRegHSV(
  sampleList,
  target,
  HSV,
  resampleFactor = NULL,
  useBlockPercentage = 75,
  colOffset = 0.1,
  crop = c(0, 0, 0, 0),
  removebgR = NULL,
  maskOutline = NULL,
  plot = FALSE,
  focal = FALSE,
  sigma = 3,
  iterations = 0,
  ignoreHSVvalue = FALSE,
  patternsToFile = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="patRegHSV_+3A_samplelist">sampleList</code></td>
<td>
<p>List of RasterStack objects.</p>
</td></tr>
<tr><td><code id="patRegHSV_+3A_target">target</code></td>
<td>
<p>Image imported as RasterStack used as target for registration.</p>
</td></tr>
<tr><td><code id="patRegHSV_+3A_hsv">HSV</code></td>
<td>
<p>Values for color pattern extraction specified as HSV vector.</p>
</td></tr>
<tr><td><code id="patRegHSV_+3A_resamplefactor">resampleFactor</code></td>
<td>
<p>Integer for downsampling used by <code><a href="#topic+redRes">redRes</a></code> (default = NULL).</p>
</td></tr>
<tr><td><code id="patRegHSV_+3A_useblockpercentage">useBlockPercentage</code></td>
<td>
<p>Block percentage as used in <code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code>
(default = 75).</p>
</td></tr>
<tr><td><code id="patRegHSV_+3A_coloffset">colOffset</code></td>
<td>
<p>Color offset for color pattern extraction (default = 0.10).</p>
</td></tr>
<tr><td><code id="patRegHSV_+3A_crop">crop</code></td>
<td>
<p>Vector c(xmin, xmax, ymin, ymax) that specifies the pixel coordinates to crop the
original image.</p>
</td></tr>
<tr><td><code id="patRegHSV_+3A_removebgr">removebgR</code></td>
<td>
<p>Integer indicating the range RGB treshold to remove from image (e.g. 100 removes
pixels with average RGB &gt; 100; default = NULL) for registration analysis. This works only to
remove a white background.</p>
</td></tr>
<tr><td><code id="patRegHSV_+3A_maskoutline">maskOutline</code></td>
<td>
<p>When outline is specified, everything outside of the outline will be masked for
the color extraction (default = NULL).</p>
</td></tr>
<tr><td><code id="patRegHSV_+3A_plot">plot</code></td>
<td>
<p>Whether to plot transformed color patterns while processing (default = FALSE).
Transformed color patterns can be plot on top of each other ('stack') or next to the
original image for each sample ('compare').</p>
</td></tr>
<tr><td><code id="patRegHSV_+3A_focal">focal</code></td>
<td>
<p>Whether to perform Gaussian blurring (default = FALSE).</p>
</td></tr>
<tr><td><code id="patRegHSV_+3A_sigma">sigma</code></td>
<td>
<p>Size of sigma for Gaussian blurring (default = 3).</p>
</td></tr>
<tr><td><code id="patRegHSV_+3A_iterations">iterations</code></td>
<td>
<p>Number of iterations for recalculating average color (default = 0). If set, the
RGB value for pattern extraction will be iteratively recalculated to be the average of the
extracted area. This may improve extraction of distinct color pattern, but fail for more
gradually distributed (in color space) patterns.</p>
</td></tr>
<tr><td><code id="patRegHSV_+3A_ignorehsvvalue">ignoreHSVvalue</code></td>
<td>
<p>Whether to ignore the HSV value (~darkness).</p>
</td></tr>
<tr><td><code id="patRegHSV_+3A_patternstofile">patternsToFile</code></td>
<td>
<p>Name of directory to which the color pattern of each individual will be
outputted (default = NULL).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of raster objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
IDlist &lt;- c('BC0077','BC0071','BC0050','BC0049','BC0004')
prepath &lt;- system.file("extdata",  package = 'patternize')
extension &lt;- '.jpg'

imageList &lt;- makeList(IDlist, 'image', prepath, extension)

target &lt;- imageList[[1]]

HSV &lt;- c(0.025,1,0.45)

# Note that this example only aligns one image with the target,
# remove [2] to run a full examples.
rasterList_regHSV &lt;- patRegRGB(imageList[2], target, HSV,
colOffset= 0.15, crop = c(100,400,40,250), removebgR = 100, plot = 'stack')

## End(Not run)

</code></pre>

<hr>
<h2 id='patRegK'>Aligns images using <code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code> utilities for automated image registration
and extracts colors using k-means clustering.</h2><span id='topic+patRegK'></span>

<h3>Description</h3>

<p>Aligns images using <code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code> utilities for automated image registration
and extracts colors using k-means clustering.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patRegK(
  sampleList,
  target,
  k = 3,
  fixedStartCenter = NULL,
  resampleFactor = NULL,
  useBlockPercentage = 75,
  crop = c(0, 0, 0, 0),
  removebgR = NULL,
  removebgK = NULL,
  maskOutline = NULL,
  maskColor = 0,
  plot = FALSE,
  focal = FALSE,
  sigma = 3
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="patRegK_+3A_samplelist">sampleList</code></td>
<td>
<p>List of RasterStack objects.</p>
</td></tr>
<tr><td><code id="patRegK_+3A_target">target</code></td>
<td>
<p>Image imported as RasterStack used as target for registration.</p>
</td></tr>
<tr><td><code id="patRegK_+3A_k">k</code></td>
<td>
<p>Integere for defining number of k-means clusters (default = 3).</p>
</td></tr>
<tr><td><code id="patRegK_+3A_fixedstartcenter">fixedStartCenter</code></td>
<td>
<p>Specify a dataframe with start centers for k-means clustering.</p>
</td></tr>
<tr><td><code id="patRegK_+3A_resamplefactor">resampleFactor</code></td>
<td>
<p>Integer for downsampling used by <code><a href="#topic+redRes">redRes</a></code> (default = NULL).</p>
</td></tr>
<tr><td><code id="patRegK_+3A_useblockpercentage">useBlockPercentage</code></td>
<td>
<p>Block percentage as used in <code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code>
(default = 75).</p>
</td></tr>
<tr><td><code id="patRegK_+3A_crop">crop</code></td>
<td>
<p>Vector c(xmin, xmax, ymin, ymax) that specifies the pixel coordinates to crop the
original image.</p>
</td></tr>
<tr><td><code id="patRegK_+3A_removebgr">removebgR</code></td>
<td>
<p>Integer indicating the range RGB treshold to remove from image (e.g. 100 removes
pixels with average RGB &gt; 100; default = NULL) for registration analysis. This works only to
remove a white background.</p>
</td></tr>
<tr><td><code id="patRegK_+3A_removebgk">removebgK</code></td>
<td>
<p>Integer indicating the range RGB treshold to remove from image (e.g. 100 removes
pixels with average RGB &gt; 100; default = NULL) for k-means analysis. This works only to remove
a white background.</p>
</td></tr>
<tr><td><code id="patRegK_+3A_maskoutline">maskOutline</code></td>
<td>
<p>When outline is specified, everything outside of the outline will be masked for
the color extraction (default = NULL).</p>
</td></tr>
<tr><td><code id="patRegK_+3A_maskcolor">maskColor</code></td>
<td>
<p>Color the masked area gets. Set to 0 for black (default) or 255 for white.</p>
</td></tr>
<tr><td><code id="patRegK_+3A_plot">plot</code></td>
<td>
<p>Whether to plot k-means clustered image while processing (default = FALSE).</p>
</td></tr>
<tr><td><code id="patRegK_+3A_focal">focal</code></td>
<td>
<p>Whether to perform Gaussian blurring (default = FALSE).</p>
</td></tr>
<tr><td><code id="patRegK_+3A_sigma">sigma</code></td>
<td>
<p>Size of sigma for Gaussian blurring (default = 3).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of rasters for each k-means cluster objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>IDlist &lt;- c('BC0077','BC0071','BC0050','BC0049','BC0004')
prepath &lt;- system.file("extdata",  package = 'patternize')
extension &lt;- '.jpg'

imageList &lt;- makeList(IDlist, 'image', prepath, extension)

target &lt;- imageList[[1]]

## Not run: 
rasterList_regK &lt;- patRegK(imageList[3], target, k = 5,
crop = c(100,400,40,250), removebgR = 100, plot = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='patRegK_HSV'>Aligns images using <code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code> utilities for automated image registration
and extracts colors using k-means clustering.</h2><span id='topic+patRegK_HSV'></span>

<h3>Description</h3>

<p>Aligns images using <code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code> utilities for automated image registration
and extracts colors using k-means clustering.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patRegK_HSV(
  sampleList,
  target,
  k = 3,
  fixedStartCenter = NULL,
  resampleFactor = NULL,
  useBlockPercentage = 75,
  crop = c(0, 0, 0, 0),
  removebgR = NULL,
  removebgK = NULL,
  maskOutline = NULL,
  maskColor = 0,
  plot = FALSE,
  focal = FALSE,
  sigma = 3,
  ignoreHSVvalue = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="patRegK_HSV_+3A_samplelist">sampleList</code></td>
<td>
<p>List of RasterStack objects.</p>
</td></tr>
<tr><td><code id="patRegK_HSV_+3A_target">target</code></td>
<td>
<p>Image imported as RasterStack used as target for registration.</p>
</td></tr>
<tr><td><code id="patRegK_HSV_+3A_k">k</code></td>
<td>
<p>Integere for defining number of k-means clusters (default = 3).</p>
</td></tr>
<tr><td><code id="patRegK_HSV_+3A_fixedstartcenter">fixedStartCenter</code></td>
<td>
<p>Specify a dataframe with start centers for k-means clustering.</p>
</td></tr>
<tr><td><code id="patRegK_HSV_+3A_resamplefactor">resampleFactor</code></td>
<td>
<p>Integer for downsampling used by <code><a href="#topic+redRes">redRes</a></code> (default = NULL).</p>
</td></tr>
<tr><td><code id="patRegK_HSV_+3A_useblockpercentage">useBlockPercentage</code></td>
<td>
<p>Block percentage as used in <code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code>
(default = 75).</p>
</td></tr>
<tr><td><code id="patRegK_HSV_+3A_crop">crop</code></td>
<td>
<p>Vector c(xmin, xmax, ymin, ymax) that specifies the pixel coordinates to crop the
original image.</p>
</td></tr>
<tr><td><code id="patRegK_HSV_+3A_removebgr">removebgR</code></td>
<td>
<p>Integer indicating the range RGB treshold to remove from image (e.g. 100 removes
pixels with average RGB &gt; 100; default = NULL) for registration analysis. This works only to
remove a white background.</p>
</td></tr>
<tr><td><code id="patRegK_HSV_+3A_removebgk">removebgK</code></td>
<td>
<p>Integer indicating the range RGB treshold to remove from image (e.g. 100 removes
pixels with average RGB &gt; 100; default = NULL) for k-means analysis. This works only to remove
a white background.</p>
</td></tr>
<tr><td><code id="patRegK_HSV_+3A_maskoutline">maskOutline</code></td>
<td>
<p>When outline is specified, everything outside of the outline will be masked for
the color extraction (default = NULL).</p>
</td></tr>
<tr><td><code id="patRegK_HSV_+3A_maskcolor">maskColor</code></td>
<td>
<p>Color the masked area gets. Set to 0 for black (default) or 255 for white.</p>
</td></tr>
<tr><td><code id="patRegK_HSV_+3A_plot">plot</code></td>
<td>
<p>Whether to plot k-means clustered image while processing (default = FALSE).</p>
</td></tr>
<tr><td><code id="patRegK_HSV_+3A_focal">focal</code></td>
<td>
<p>Whether to perform Gaussian blurring (default = FALSE).</p>
</td></tr>
<tr><td><code id="patRegK_HSV_+3A_sigma">sigma</code></td>
<td>
<p>Size of sigma for Gaussian blurring (default = 3).</p>
</td></tr>
<tr><td><code id="patRegK_HSV_+3A_ignorehsvvalue">ignoreHSVvalue</code></td>
<td>
<p>Whether to ignore the HSV value (~darkness).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of rasters for each k-means cluster objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>IDlist &lt;- c('BC0077','BC0071','BC0050','BC0049','BC0004')
prepath &lt;- system.file("extdata",  package = 'patternize')
extension &lt;- '.jpg'

imageList &lt;- makeList(IDlist, 'image', prepath, extension)

target &lt;- imageList[[1]]

## Not run: 
rasterList_regK &lt;- patRegK(imageList[3], target, k = 5,
crop = c(100,400,40,250), removebgR = 100, plot = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='patRegRGB'>Aligns images using <code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code> utilities for automated image registration
and extracts colors using a predefined RGB values and cutoff value.</h2><span id='topic+patRegRGB'></span>

<h3>Description</h3>

<p>Aligns images using <code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code> utilities for automated image registration
and extracts colors using a predefined RGB values and cutoff value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patRegRGB(
  sampleList,
  target,
  RGB,
  resampleFactor = NULL,
  useBlockPercentage = 75,
  colOffset = 0.1,
  crop = c(0, 0, 0, 0),
  removebgR = NULL,
  maskOutline = NULL,
  plot = FALSE,
  focal = FALSE,
  sigma = 3,
  iterations = 0,
  patternsToFile = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="patRegRGB_+3A_samplelist">sampleList</code></td>
<td>
<p>List of RasterStack objects.</p>
</td></tr>
<tr><td><code id="patRegRGB_+3A_target">target</code></td>
<td>
<p>Image imported as RasterStack used as target for registration.</p>
</td></tr>
<tr><td><code id="patRegRGB_+3A_rgb">RGB</code></td>
<td>
<p>Values for color pattern extraction specified as RGB vector.</p>
</td></tr>
<tr><td><code id="patRegRGB_+3A_resamplefactor">resampleFactor</code></td>
<td>
<p>Integer for downsampling used by <code><a href="#topic+redRes">redRes</a></code> (default = NULL).</p>
</td></tr>
<tr><td><code id="patRegRGB_+3A_useblockpercentage">useBlockPercentage</code></td>
<td>
<p>Block percentage as used in <code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code>
(default = 75).</p>
</td></tr>
<tr><td><code id="patRegRGB_+3A_coloffset">colOffset</code></td>
<td>
<p>Color offset for color pattern extraction (default = 0.10).</p>
</td></tr>
<tr><td><code id="patRegRGB_+3A_crop">crop</code></td>
<td>
<p>Vector c(xmin, xmax, ymin, ymax) that specifies the pixel coordinates to crop the
original image.</p>
</td></tr>
<tr><td><code id="patRegRGB_+3A_removebgr">removebgR</code></td>
<td>
<p>Integer indicating the range RGB treshold to remove from image (e.g. 100 removes
pixels with average RGB &gt; 100; default = NULL) for registration analysis. This works only to
remove a white background.</p>
</td></tr>
<tr><td><code id="patRegRGB_+3A_maskoutline">maskOutline</code></td>
<td>
<p>When outline is specified, everything outside of the outline will be masked for
the color extraction (default = NULL).</p>
</td></tr>
<tr><td><code id="patRegRGB_+3A_plot">plot</code></td>
<td>
<p>Whether to plot transformed color patterns while processing (default = FALSE).
Transformed color patterns can be plot on top of each other ('stack') or next to the
original image for each sample ('compare').</p>
</td></tr>
<tr><td><code id="patRegRGB_+3A_focal">focal</code></td>
<td>
<p>Whether to perform Gaussian blurring (default = FALSE).</p>
</td></tr>
<tr><td><code id="patRegRGB_+3A_sigma">sigma</code></td>
<td>
<p>Size of sigma for Gaussian blurring (default = 3).</p>
</td></tr>
<tr><td><code id="patRegRGB_+3A_iterations">iterations</code></td>
<td>
<p>Number of iterations for recalculating average color (default = 0). If set, the
RGB value for pattern extraction will be iteratively recalculated to be the average of the
extracted area. This may improve extraction of distinct color pattern, but fail for more
gradually distributed (in color space) patterns.</p>
</td></tr>
<tr><td><code id="patRegRGB_+3A_patternstofile">patternsToFile</code></td>
<td>
<p>Name of directory to which the color pattern of each individual will be
outputted (default = NULL).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of raster objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
IDlist &lt;- c('BC0077','BC0071','BC0050','BC0049','BC0004')
prepath &lt;- system.file("extdata",  package = 'patternize')
extension &lt;- '.jpg'

imageList &lt;- makeList(IDlist, 'image', prepath, extension)

target &lt;- imageList[[1]]

RGB &lt;- c(114,17,0)

# Note that this example only aligns one image with the target,
# remove [2] to run a full examples.
rasterList_regRGB &lt;- patRegRGB(imageList[2], target, RGB,
colOffset= 0.15, crop = c(100,400,40,250), removebgR = 100, plot = 'stack')

## End(Not run)

</code></pre>

<hr>
<h2 id='patRegW'>Aligns images using <code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code> utilities for automated image registration
and extracts color pattern using watershed segmentation. This function works interactively by
allowing to pick a starting pixel within each pattern element from which the watershed will
extract the pattern. This function works best for patterns with sharp boundaries.</h2><span id='topic+patRegW'></span>

<h3>Description</h3>

<p>Aligns images using <code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code> utilities for automated image registration
and extracts color pattern using watershed segmentation. This function works interactively by
allowing to pick a starting pixel within each pattern element from which the watershed will
extract the pattern. This function works best for patterns with sharp boundaries.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patRegW(
  sampleList,
  target,
  resampleFactor = NULL,
  useBlockPercentage = 75,
  crop = c(0, 0, 0, 0),
  removebgR = NULL,
  maskOutline = NULL,
  cartoonID = NULL,
  correct = FALSE,
  blur = TRUE,
  sigma = 3,
  bucketfill = TRUE,
  cleanP = NULL,
  splitC = NULL,
  plotTransformed = FALSE,
  plotCorrect = FALSE,
  plotEdges = FALSE,
  plotPriority = FALSE,
  plotWS = FALSE,
  plotBF = FALSE,
  plotFinal = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="patRegW_+3A_samplelist">sampleList</code></td>
<td>
<p>List of RasterStack objects.</p>
</td></tr>
<tr><td><code id="patRegW_+3A_target">target</code></td>
<td>
<p>Image imported as RasterStack used as target for registration.</p>
</td></tr>
<tr><td><code id="patRegW_+3A_resamplefactor">resampleFactor</code></td>
<td>
<p>Integer for downsampling image used by <code><a href="#topic+redRes">redRes</a></code>.</p>
</td></tr>
<tr><td><code id="patRegW_+3A_useblockpercentage">useBlockPercentage</code></td>
<td>
<p>Block percentage as used in <code><a href="RNiftyReg.html#topic+niftyreg">niftyreg</a></code>
(default = 75).</p>
</td></tr>
<tr><td><code id="patRegW_+3A_crop">crop</code></td>
<td>
<p>Vector c(xmin, xmax, ymin, ymax) that specifies the pixel coordinates to crop the
original image.</p>
</td></tr>
<tr><td><code id="patRegW_+3A_removebgr">removebgR</code></td>
<td>
<p>Integer indicating the range RGB treshold to remove from image (e.g. 100 removes
pixels with average RGB &gt; 100; default = NULL) for registration analysis. This works only to
remove a white background.</p>
</td></tr>
<tr><td><code id="patRegW_+3A_maskoutline">maskOutline</code></td>
<td>
<p>When outline is specified, everything outside of the outline will be masked for
the color extraction (default = NULL).</p>
</td></tr>
<tr><td><code id="patRegW_+3A_cartoonid">cartoonID</code></td>
<td>
<p>ID of the sample for which the cartoon was drawn and will be used for masking.</p>
</td></tr>
<tr><td><code id="patRegW_+3A_correct">correct</code></td>
<td>
<p>Correct image illumination using a linear model (default = FALSE).</p>
</td></tr>
<tr><td><code id="patRegW_+3A_blur">blur</code></td>
<td>
<p>Blur image for priority map extraction (default = TRUE).</p>
</td></tr>
<tr><td><code id="patRegW_+3A_sigma">sigma</code></td>
<td>
<p>Size of sigma for Gaussian blurring (default = 5).</p>
</td></tr>
<tr><td><code id="patRegW_+3A_bucketfill">bucketfill</code></td>
<td>
<p>Use a bucket fill on the background to fill holes (default = TRUE).</p>
</td></tr>
<tr><td><code id="patRegW_+3A_cleanp">cleanP</code></td>
<td>
<p>Integer to remove spurious areas with width smaller than cleanP (default = NULL).</p>
</td></tr>
<tr><td><code id="patRegW_+3A_splitc">splitC</code></td>
<td>
<p>Integer to split selected patterns into connected components and remove ones with
areas smaller than splitC (default = NULL).</p>
</td></tr>
<tr><td><code id="patRegW_+3A_plottransformed">plotTransformed</code></td>
<td>
<p>Plot transformed image (default = FALSE).</p>
</td></tr>
<tr><td><code id="patRegW_+3A_plotcorrect">plotCorrect</code></td>
<td>
<p>Plot corrected image, corrected for illumination using a linear model
(default = FALSE).</p>
</td></tr>
<tr><td><code id="patRegW_+3A_plotedges">plotEdges</code></td>
<td>
<p>Plot image gradient (default = FALSE).</p>
</td></tr>
<tr><td><code id="patRegW_+3A_plotpriority">plotPriority</code></td>
<td>
<p>Plot priority map (default = FALSE).</p>
</td></tr>
<tr><td><code id="patRegW_+3A_plotws">plotWS</code></td>
<td>
<p>Plot watershed result (default = FALSE).</p>
</td></tr>
<tr><td><code id="patRegW_+3A_plotbf">plotBF</code></td>
<td>
<p>Plot bucketfill (default = FALSE).</p>
</td></tr>
<tr><td><code id="patRegW_+3A_plotfinal">plotFinal</code></td>
<td>
<p>Plot extracted patterns (default = FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of raster objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
IDlist &lt;- c('BC0077','BC0071','BC0050','BC0049','BC0004')
prepath &lt;- system.file("extdata",  package = 'patternize')
extension &lt;- '.jpg'

imageList &lt;- makeList(IDlist, 'image', prepath, extension)

target &lt;- imageList[[1]]

outline_BC0077 &lt;- read.table(paste(system.file("extdata",  package = 'patternize'),
'/BC0077_outline.txt', sep=''), header = FALSE)

rasterList_regW &lt;- patRegW(imageList, target, plotTransformed = FALSE, cartoonID = 'BC0077',
                          correct = TRUE, plotCorrect = FALSE, blur = FALSE, sigma = 2,
                          bucketfill = FALSE, cleanP = 0, splitC = 10, plotPriority = TRUE,
                          plotWS = FALSE, plotBF = FALSE, plotFinal = TRUE, removebgR = 100,
                          maskOutline = outline_BC0077)

## End(Not run)

</code></pre>

<hr>
<h2 id='plotHeat'>Plots the color pattern heatmaps from <code>sumRaster</code> output.</h2><span id='topic+plotHeat'></span>

<h3>Description</h3>

<p>Plots the color pattern heatmaps from <code>sumRaster</code> output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotHeat(
  summedRaster,
  IDlist,
  colpalette = NULL,
  plotCartoon = FALSE,
  refShape = NULL,
  outline = NULL,
  lines = NULL,
  landList = NULL,
  adjustCoords = FALSE,
  cartoonID = NULL,
  normalized = FALSE,
  crop = c(0, 0, 0, 0),
  flipRaster = NULL,
  flipOutline = NULL,
  imageList = NULL,
  refImage = NULL,
  cartoonOrder = "above",
  lineOrder = "above",
  cartoonCol = "gray",
  cartoonFill = NULL,
  plotLandmarks = FALSE,
  landCol = "black",
  zlim = c(0, 1),
  legend = TRUE,
  legendTitle = "Proportion",
  legend.side = 4,
  xlab = "",
  ylab = "",
  main = "",
  plotType = "multi",
  imageIDs = NULL,
  format = "imageJ"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotHeat_+3A_summedraster">summedRaster</code></td>
<td>
<p>Summed raster or summedRasterList.</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_idlist">IDlist</code></td>
<td>
<p>List of sample IDs.</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_colpalette">colpalette</code></td>
<td>
<p>Vector of colors for color palette
(default = c(&quot;white&quot;,&quot;lightblue&quot;,&quot;blue&quot;,&quot;green&quot;, &quot;yellow&quot;,&quot;red&quot;))</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_plotcartoon">plotCartoon</code></td>
<td>
<p>Whether to plot a cartoon. This cartoon should be drawn on one of the samples
used in the analysis.</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_refshape">refShape</code></td>
<td>
<p>This can be 'target' in case the reference shape is a single sample (for
registration analysis) or 'mean' if the images were transformed to a mean shape (only for
meanshape when using landmark transformation)</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_outline">outline</code></td>
<td>
<p>xy coordinates that define outline.</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_lines">lines</code></td>
<td>
<p>list of files with xy coordinates of line objects to be added to cartoon.</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_landlist">landList</code></td>
<td>
<p>Landmark landmarkList.</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_adjustcoords">adjustCoords</code></td>
<td>
<p>Adjust landmark coordinates.</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_cartoonid">cartoonID</code></td>
<td>
<p>ID of the sample for which the cartoon was drawn.</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_normalized">normalized</code></td>
<td>
<p>Set this to true in case the summed rasters are already devided by the
sample number.</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_crop">crop</code></td>
<td>
<p>Vector c(xmin, xmax, ymin, ymax) that specifies the pixel coordinates to crop
the original image used in landmark or registration analysis.</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_flipraster">flipRaster</code></td>
<td>
<p>Whether to flip raster along xy axis (in case there is an inconsistency
between raster and outline coordinates).</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_flipoutline">flipOutline</code></td>
<td>
<p>Whether to flip plot along x, y or xy axis.</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_imagelist">imageList</code></td>
<td>
<p>List of images should be given if one wants to flip the outline or adjust
landmark coordinates.</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_refimage">refImage</code></td>
<td>
<p>Image (RasterStack) used for target. Use raster::stack('filename').</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_cartoonorder">cartoonOrder</code></td>
<td>
<p>Whether to plot the cartoon outline 'above' or 'under' the pattern raster
(default = 'above'). Set to 'under' for filled outlines.</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_lineorder">lineOrder</code></td>
<td>
<p>Whether to plot the cartoon lines 'above' or 'under' the pattern raster
(default = 'above').</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_cartooncol">cartoonCol</code></td>
<td>
<p>Outline and line color for cartoon (deafault = 'gray').</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_cartoonfill">cartoonFill</code></td>
<td>
<p>Fill color for outline of cartoon (default = NULL).</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_plotlandmarks">plotLandmarks</code></td>
<td>
<p>Whether to plot the landmarks from the target image or mean shape
landmarks (default = FALSE).</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_landcol">landCol</code></td>
<td>
<p>Color for ploting landmarks (default = 'black').</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_zlim">zlim</code></td>
<td>
<p>z-axis limit (default = c(0,1))</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_legend">legend</code></td>
<td>
<p>Whether to plot legend with heatmaps.</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_legendtitle">legendTitle</code></td>
<td>
<p>Title of the raster legend (default = 'Proportion')</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_legend.side">legend.side</code></td>
<td>
<p>Side to plot legend (default = 4)</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_xlab">xlab</code></td>
<td>
<p>Optional x-axis label.</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_ylab">ylab</code></td>
<td>
<p>Optional y-axis label.</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_main">main</code></td>
<td>
<p>Optional main title.</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_plottype">plotType</code></td>
<td>
<p>Set as 'PCA' when visualizing shape changes along PCA axis in \
code<a href="#topic+patPCA">patPCA</a>, as 'one' when visualizing single image or as 'multi' for multi
plotting or when setting customized margins (default = 'multi').</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_imageids">imageIDs</code></td>
<td>
<p>A list of IDs to match landmarks to images if landmarkList and imageList don't
have the same length.</p>
</td></tr>
<tr><td><code id="plotHeat_+3A_format">format</code></td>
<td>
<p>ImageJ (Fiji) or tps format (default = 'imageJ').</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(rasterList_lanRGB)
IDlist &lt;- c('BC0077','BC0071','BC0050','BC0049','BC0004')
outline_BC0077 &lt;- read.table(paste(system.file("extdata",  package = 'patternize'),
'/BC0077_outline.txt', sep=''), header = FALSE)
lines_BC0077 &lt;- list.files(path=paste(system.file("extdata",  package = 'patternize')),
pattern='vein', full.names = TRUE)

summedRaster_regRGB &lt;- sumRaster(rasterList_regRGB, IDlist, type = 'RGB')
data(imageList)

plotHeat(summedRaster_regRGB, IDlist, plotCartoon = TRUE, refShape = 'target',
outline = outline_BC0077, lines = lines_BC0077, crop = c(100,400,40,250),
flipRaster = 'xy', imageList = imageList, cartoonOrder = 'under', cartoonID = 'BC0077',
cartoonFill = 'black', main = 'registration_example')

## Not run: 
data(rasterList_lanK)
IDlist &lt;- c('BC0077','BC0071','BC0050','BC0049','BC0004')
summedRasterList &lt;- sumRaster(rasterList_lanK, IDlist, type = 'k')
plotHeat(summedRasterList, IDlist)

summedRasterList_regK &lt;- sumRaster(rasterList_regK, IDlist, type = 'k')
plotHeat(summedRasterList_regK, IDlist, plotCartoon = TRUE, refShape = 'target',
outline = outline_BC0077, lines = lines_BC0077, crop = c(100,400,40,250),
flipRaster = 'y', imageList = imageList, cartoonOrder = 'under',
cartoonFill = 'black', main = 'kmeans_example')

plotHeat(summedRasterList_regK[[1]], IDlist, plotCartoon = TRUE, refShape = 'target',
outline = outline_BC0077, lines = lines_BC0077, crop = c(100,400,40,250),
flipRaster = 'y', imageList = imageList, cartoonOrder = 'under',
cartoonFill = 'black', main = 'kmeans_example')


prepath &lt;- system.file("extdata", package = 'patternize')
extension &lt;- '_landmarks_LFW.txt'
landmarkList &lt;- makeList(IDlist, 'landmark', prepath, extension)

summedRaster_lanRGB &lt;- sumRaster(rasterList_lanRGB, IDlist, type = 'RGB')

plotHeat(summedRaster_lanRGB, IDlist, plotCartoon = TRUE, refShape = 'mean',
outline = outline_BC0077, lines = lines_BC0077, landList = landmarkList,
adjustCoords = TRUE, imageList = imageList, cartoonID = 'BC0077',
cartoonOrder = 'under', cartoonFill= 'black', main = 'Landmark_example')

summedRaster_lanK &lt;- sumRaster(rasterList_lanK, IDlist, type = 'k')

plotHeat(summedRaster_lanK, IDlist, plotCartoon = TRUE, refShape = 'mean',
outline = outline_BC0077, lines = lines_BC0077, landList = landmarkList,
adjustCoords = TRUE, imageList = imageList, cartoonID = 'BC0077',
cartoonOrder = 'under', cartoonFill= 'black', main = 'Landmark_example')

plotHeat(summedRaster_lanK[[2]], IDlist, plotCartoon = TRUE, refShape = 'mean',
outline = outline_BC0077, lines = lines_BC0077, landList = landmarkList,
adjustCoords = TRUE, imageList = imageList, cartoonID = 'BC0077',
cartoonOrder = 'under', cartoonFill= 'black', main = 'Landmark_example')

## End(Not run)

</code></pre>

<hr>
<h2 id='plotRasterstackAsImage'>Plot rasterStack as image.</h2><span id='topic+plotRasterstackAsImage'></span>

<h3>Description</h3>

<p>Plot rasterStack as image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotRasterstackAsImage(rasterStack, flipY = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotRasterstackAsImage_+3A_rasterstack">rasterStack</code></td>
<td>
<p>A single rasterStack.</p>
</td></tr>
<tr><td><code id="plotRasterstackAsImage_+3A_flipy">flipY</code></td>
<td>
<p>Whether to flip the raster along the Y-axis.</p>
</td></tr>
</table>

<hr>
<h2 id='rasterList_lanK'>rasterList_lanK</h2><span id='topic+rasterList_lanK'></span>

<h3>Description</h3>

<p>List of RasterLayers as returned by <code>patLanK</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rasterList_lanK
</code></pre>


<h3>Format</h3>

<p>A list of RasterLayers including the red color pattern extracted from 5 Heliconius
erato hydara dorsal forewings using <code>patLanK</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(rasterList_lanK)
summary(rasterList_lanL)

## End(Not run)
</code></pre>

<hr>
<h2 id='rasterList_lanRGB'>rasterList_lanRGB</h2><span id='topic+rasterList_lanRGB'></span>

<h3>Description</h3>

<p>List of RasterLayers as returned by <code>patLanRGB</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rasterList_lanRGB
</code></pre>


<h3>Format</h3>

<p>A list of RasterLayers including the red color pattern extracted from 5 Heliconius
erato hydara dorsal forewings using <code>patLanRGB</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(rasterList_lanRGB)
summary(rasterList_lanRGB)

## End(Not run)
</code></pre>

<hr>
<h2 id='rasterList_regK'>rasterList_regK</h2><span id='topic+rasterList_regK'></span>

<h3>Description</h3>

<p>List of RasterLayers as returned by <code>patRegK</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rasterList_regK
</code></pre>


<h3>Format</h3>

<p>A list of RasterLayers including the red color pattern extracted from 5 Heliconius
erato hydara dorsal forewings using <code>patRegK</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(rasterList_regK)
summary(rasterList_regK)

## End(Not run)
</code></pre>

<hr>
<h2 id='rasterList_regRGB'>rasterList_regRGB</h2><span id='topic+rasterList_regRGB'></span>

<h3>Description</h3>

<p>List of RasterLayers as returned by <code>patRegRGB</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rasterList_regRGB
</code></pre>


<h3>Format</h3>

<p>A list of RasterLayers including the red color pattern extracted from 5 Heliconius
erato hydara dorsal forewings using <code>patRegRGB</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(rasterList_regRGB)
summary(rasterList_regRGB)

## End(Not run)
</code></pre>

<hr>
<h2 id='redRes'>Reduce the resolution of an image imported as a RasterStack by downsampling.</h2><span id='topic+redRes'></span>

<h3>Description</h3>

<p>Reduce the resolution of an image imported as a RasterStack by downsampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redRes(image, resampleFactor)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="redRes_+3A_image">image</code></td>
<td>
<p>RasterStack for downsampling.</p>
</td></tr>
<tr><td><code id="redRes_+3A_resamplefactor">resampleFactor</code></td>
<td>
<p>Integer for downsampling.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Downsampled RasterStack
</p>


<h3>Examples</h3>

<pre><code class='language-R'>image &lt;- raster::stack(system.file("extdata", "BC0077.jpg", package = "patternize"))
image_reduced &lt;- redRes(image, 5)

</code></pre>

<hr>
<h2 id='sampleLandmarks'>Sample landmarks in an image.</h2><span id='topic+sampleLandmarks'></span>

<h3>Description</h3>

<p>Sample landmarks in an image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampleLandmarks(sampleList, resampleFactor = NULL, crop = c(0, 0, 0, 0))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sampleLandmarks_+3A_samplelist">sampleList</code></td>
<td>
<p>RasterStack or list of RasterStack objects as obtained
by <code><a href="#topic+makeList">makeList</a></code>.</p>
</td></tr>
<tr><td><code id="sampleLandmarks_+3A_resamplefactor">resampleFactor</code></td>
<td>
<p>Integer for downsampling the image(s) used by <code><a href="#topic+redRes">redRes</a></code>.</p>
</td></tr>
<tr><td><code id="sampleLandmarks_+3A_crop">crop</code></td>
<td>
<p>Vector c(xmin, xmax, ymin, ymax) that specifies the pixel coordinates to crop the
original image.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>landmark matrix or landmark list
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
IDlist &lt;- c('BC0077','BC0071')
prepath &lt;- system.file("extdata",  package = 'patternize')
extension &lt;- '.jpg'
imageList &lt;- makeList(IDlist, 'image', prepath, extension)

landmarkList &lt;- sampleLandmarks(imageList)

## End(Not run)

</code></pre>

<hr>
<h2 id='sampleRGB'>Interactive function to sample RGB value from pixel or square area in an image.</h2><span id='topic+sampleRGB'></span>

<h3>Description</h3>

<p>Interactive function to sample RGB value from pixel or square area in an image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampleRGB(image, resampleFactor = NULL, crop = c(0, 0, 0, 0), type = "point")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sampleRGB_+3A_image">image</code></td>
<td>
<p>Image imported as a RasterStack.</p>
</td></tr>
<tr><td><code id="sampleRGB_+3A_resamplefactor">resampleFactor</code></td>
<td>
<p>Integer for downsampling used by <code><a href="#topic+redRes">redRes</a></code>.</p>
</td></tr>
<tr><td><code id="sampleRGB_+3A_crop">crop</code></td>
<td>
<p>Vector c(xmin, xmax, ymin, ymax) that specifies the pixel coordinates to crop the
original image.</p>
</td></tr>
<tr><td><code id="sampleRGB_+3A_type">type</code></td>
<td>
<p>Set 'point' to extract RGB from a single point or 'area' to extract from a square
area defined by setting two points (default = 'point').</p>
</td></tr>
</table>


<h3>Value</h3>

<p>RGB vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>image &lt;- raster::stack(system.file("extdata", "BC0077.jpg", package = "patternize"))
RGB &lt;- sampleRGB(image, resampleFactor = 1)

</code></pre>

<hr>
<h2 id='setMask'>Interactive function to to draw an outline for masking.</h2><span id='topic+setMask'></span>

<h3>Description</h3>

<p>Interactive function to to draw an outline for masking.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setMask(summedRaster, IDlist, filename, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setMask_+3A_summedraster">summedRaster</code></td>
<td>
<p>Summed raster of extracted patterns.</p>
</td></tr>
<tr><td><code id="setMask_+3A_idlist">IDlist</code></td>
<td>
<p>List of sample IDs.</p>
</td></tr>
<tr><td><code id="setMask_+3A_filename">filename</code></td>
<td>
<p>Name of file to which mask will be written.</p>
</td></tr>
<tr><td><code id="setMask_+3A_...">...</code></td>
<td>
<p>additional arguments for plotHeat function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>file
</p>

<hr>
<h2 id='sumRaster'>This function sums the individual color pattern RasterLayes as obtained by the main patternize
functions.</h2><span id='topic+sumRaster'></span>

<h3>Description</h3>

<p>This function sums the individual color pattern RasterLayes as obtained by the main patternize
functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sumRaster(rList, IDlist, type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sumRaster_+3A_rlist">rList</code></td>
<td>
<p>List of RasterLayers or list of RasterLayers for each k-means cluster.</p>
</td></tr>
<tr><td><code id="sumRaster_+3A_idlist">IDlist</code></td>
<td>
<p>List of sample IDs.</p>
</td></tr>
<tr><td><code id="sumRaster_+3A_type">type</code></td>
<td>
<p>Type of rasterlist; 'RGB' or 'k' (result from RGB or k-means analysis, respectively).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(rasterList_lanRGB)
IDlist &lt;- c('BC0077','BC0071','BC0050','BC0049','BC0004')
summedRaster &lt;- sumRaster(rasterList_lanRGB, IDlist, type = 'RGB')

data(rasterList_lanK)
IDlist &lt;- c('BC0077','BC0071','BC0050','BC0049','BC0004')
summedRasterList &lt;- sumRaster(rasterList_lanK, IDlist, type = 'k')

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
