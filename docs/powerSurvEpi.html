<!DOCTYPE html><html><head><title>Help for package powerSurvEpi</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {powerSurvEpi}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#numDEpi'>
<p>Calculate Number of Deaths Required for Cox Proportional Hazards Regression with Two Covariates for Epidemiological Studies</p></a></li>
<li><a href='#numDEpi.default'>
<p>Calculate Number of Deaths Required for Cox Proportional Hazards Regression with Two Covariates for Epidemiological Studies</p></a></li>
<li><a href='#Oph'><p>Ophthalmology Data</p></a></li>
<li><a href='#power.stratify'>
<p>Power Calculation for Survival Analysis with Binary Predictor and Exponential Survival Function</p></a></li>
<li><a href='#powerConLogistic.bin'>
<p>Sample Size Calculation for Conditional Logistic Regression with Binary Covariate</p></a></li>
<li><a href='#powerConLogistic.con'>
<p>Sample Size Calculation for Conditional Logistic Regression with Continuous Covariate</p></a></li>
<li><a href='#powerCT'><p> Power Calculation in the Analysis of Survival Data for Clinical Trials</p></a></li>
<li><a href='#powerCT.default'><p> Power Calculation in the Analysis of Survival Data for Clinical Trials</p></a></li>
<li><a href='#powerCT.default0'><p>Power Calculation in the Analysis of Survival Data for Clinical Trials</p></a></li>
<li><a href='#powerEpi'><p> Power Calculation for Cox Proportional Hazards Regression with Two Covariates for Epidemiological Studies</p></a></li>
<li><a href='#powerEpi.default'><p> Power Calculation for Cox Proportional Hazards Regression with Two Covariates for Epidemiological Studies</p></a></li>
<li><a href='#powerEpiCont'>
<p>Power Calculation for Cox Proportional Hazards Regression with Nonbinary Covariates for Epidemiological Studies</p></a></li>
<li><a href='#powerEpiCont.default'>
<p>Power Calculation for Cox Proportional Hazards Regression with Nonbinary Covariates for Epidemiological Studies</p></a></li>
<li><a href='#powerEpiInt'>
<p>Power Calculation Testing Interaction Effect for Cox Proportional Hazards Regression with two covariates for Epidemiological Studies (Both covariates should be binary)</p></a></li>
<li><a href='#powerEpiInt.default0'>
<p>Power Calculation Testing Interaction Effect for Cox Proportional Hazards Regression</p></a></li>
<li><a href='#powerEpiInt.default1'>
<p>Power Calculation Testing Interaction Effect for Cox Proportional Hazards Regression</p></a></li>
<li><a href='#powerEpiInt2'>
<p>Power Calculation Testing Interaction Effect for Cox Proportional Hazards Regression</p></a></li>
<li><a href='#ssize.stratify'>
<p>Sample size calculation for Survival Analysis with Binary Predictor and Exponential Survival Function</p></a></li>
<li><a href='#ssizeCT'><p> Sample Size Calculation in the Analysis of Survival Data for Clinical Trials</p></a></li>
<li><a href='#ssizeCT.default'><p> Sample Size Calculation in the Analysis of Survival Data for Clinical Trials</p></a></li>
<li><a href='#ssizeEpi'><p> Sample Size Calculation for Cox Proportional Hazards Regression</p></a></li>
<li><a href='#ssizeEpi.default'><p> Sample Size Calculation for Cox Proportional Hazards Regression</p></a></li>
<li><a href='#ssizeEpiCont'>
<p>Sample Size Calculation for Cox Proportional Hazards Regression with Nonbinary Covariates for Epidemiological Studies</p></a></li>
<li><a href='#ssizeEpiCont.default'>
<p>Sample Size Calculation for Cox Proportional Hazards Regression with Nonbinary Covariates for Epidemiological Studies</p></a></li>
<li><a href='#ssizeEpiInt'>
<p>Sample Size Calculation Testing Interaction Effect for Cox Proportional Hazards Regression</p></a></li>
<li><a href='#ssizeEpiInt.default0'>
<p>Sample Size Calculation Testing Interaction Effect for Cox Proportional Hazards Regression</p></a></li>
<li><a href='#ssizeEpiInt.default1'>
<p>Sample Size Calculation Testing Interaction Effect for Cox Proportional Hazards Regression</p></a></li>
<li><a href='#ssizeEpiInt2'>
<p>Sample Size Calculation Testing Interaction Effect for Cox Proportional Hazards Regression</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-02-28</td>
</tr>
<tr>
<td>Title:</td>
<td>Power and Sample Size Calculation for Survival Analysis of
Epidemiological Studies</td>
</tr>
<tr>
<td>Author:</td>
<td>Weiliang Qiu, Jorge Chavarro, Ross Lazarus, Bernard Rosner, Jing Ma.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Weiliang Qiu &lt;weiliang.qiu@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, survival, pracma</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to calculate power and
                sample size for testing main effect or interaction effect in
                the survival analysis of epidemiological studies
                (non-randomized studies), taking into account the 
                correlation between the covariate of the
                interest and other covariates. Some calculations also take 
                into account the competing risks and stratified analysis. 
                This package also includes
                a set of functions to calculate power and sample size
                for testing main effect in the survival analysis of 
                randomized clinical trials and conditional logistic regression for nested case-control study.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-03-01 04:55:03 UTC; weiliangqiu</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-03-01 06:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='numDEpi'> 
Calculate Number of Deaths Required for Cox Proportional Hazards Regression with Two Covariates for Epidemiological Studies
</h2><span id='topic+numDEpi'></span>

<h3>Description</h3>

<p>Calculate number of deaths required for Cox proportional hazards regression with two covariates for epidemiological Studies. The covariate of interest should be a binary variable. The other covariate can be either binary or non-binary. The formula takes
into account competing risks and the correlation between the two covariates.
Some parameters will be estimated based on a pilot data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>numDEpi(X1, 
	X2, 
	power, 
	theta, 
	alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="numDEpi_+3A_x1">X1</code></td>
<td>
<p>numeric. a <code>nPilot</code> by 1 vector, where <code>nPilot</code> is the number of subjects 
in the pilot data set. This vector records the values of the covariate of 
interest for the <code>nPilot</code> subjects in the pilot study. <code>X1</code> should 
be binary and take only two possible values: zero and one.</p>
</td></tr>
<tr><td><code id="numDEpi_+3A_x2">X2</code></td>
<td>
<p>numeric. a <code>nPilot</code> by 1 vector, where <code>nPilot</code> is the number of subjects
in the pilot study. This vector records the values of the second covariate 
for the <code>nPilot</code> subjects in the pilot study. <code>X2</code> can be binary or 
non-binary.</p>
</td></tr>
<tr><td><code id="numDEpi_+3A_power">power</code></td>
<td>
<p>numeric. the postulated power.</p>
</td></tr>
<tr><td><code id="numDEpi_+3A_theta">theta</code></td>
<td>
<p>numeric. postulated hazard ratio </p>
</td></tr>
<tr><td><code id="numDEpi_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the calculation of the number of required deaths 
derived by Latouche et al. (2004)
for the following Cox proportional hazards regression in the epidemiological
studies:
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, x_2)=h_0(t)\exp(\beta_1 x_1+\beta_2 x_2),</code>
</p>

<p>where the covariate <code class="reqn">X_1</code> is of our interest. The covariate <code class="reqn">X_1</code> should be
a binary variable taking two possible values: zero and one, while the 
covariate <code class="reqn">X_2</code> can be binary or continuous.
</p>
<p>Suppose we want to check if the hazard of <code class="reqn">X_1=1</code> is equal to 
the hazard of <code class="reqn">X_1=0</code> or not. Equivalently, we want to check if 
the hazard ratio of <code class="reqn">X_1=1</code> to <code class="reqn">X_1=0</code> is equal to <code class="reqn">1</code> 
or is equal to <code class="reqn">\exp(\beta_1)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the total 
number of deaths required to achieve a power of <code class="reqn">1-\beta</code> is
</p>
<p style="text-align: center;"><code class="reqn">D=\frac{\left(z_{1-\alpha/2}+z_{1-\beta}\right)^2}{
[\log(\theta)]^2 p (1-p) (1-\rho^2),
}</code>
</p>

<p>where <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, </p>
<p style="text-align: center;"><code class="reqn">\rho=corr(X_1, X_2)=(p_1-p_0)\times \sqrt{\frac{q(1-q)}{p(1-p)}},</code>
</p>
 
<p>and
<code class="reqn">p=Pr(X_1=1)</code>, <code class="reqn">q=Pr(X_2=1)</code>, <code class="reqn">p_0=Pr(X_1=1|X_2=0)</code>,
and <code class="reqn">p_1=Pr(X_1=1 | X_2=1)</code>.
</p>
<p><code class="reqn">p</code> and <code class="reqn">rho</code> will be estimated from a pilot data set.
</p>


<h3>Value</h3>

<table>
<tr><td><code>D</code></td>
<td>
<p>the number of deaths required to achieve the desired power with 
given type I error rate.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>proportion of subjects taking <code class="reqn">X_1=1</code>.</p>
</td></tr>
<tr><td><code>rho2</code></td>
<td>
<p>square of the correlation between <code class="reqn">X_1</code> and <code class="reqn">X_2</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

 
<p>(1) The formula can be used to calculate
power for a randomized trial study by setting <code>rho2=0</code>.
</p>
<p>(2) When <code>rho2=0</code>, the formula derived by Latouche et al. (2004)
looks the same as that derived by Schoenfeld (1983). Latouche et al. (2004) pointed out that in this situation, the interpretations are different hence
the two formulae are actually different. In Latouched et al. (2004), the
hazard ratio <code class="reqn">\theta</code> measures the difference of effect of a covariate 
at two different levels on  the subdistribution hazard for a particular failure, 
while in Schoenfeld (1983), the hazard ratio <code class="reqn">\theta</code> measures 
the difference of effect on the cause-specific hazard.
</p>


<h3>References</h3>

 
<p>Schoenfeld DA. (1983).
Sample-size formula for the proportional-hazards regression model.
<em>Biometrics</em>. 39:499-503.
</p>
<p>Latouche A., Porcher R. and Chevret S. (2004).
Sample size formula for proportional hazards modelling of competing risks.
<em>Statistics in Medicine</em>. 23:3263-3274.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+numDEpi.default">numDEpi.default</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # generate a toy pilot data set
  X1 &lt;- c(rep(1, 39), rep(0, 61))
  set.seed(123456)
  X2 &lt;- sample(c(0, 1), 100, replace = TRUE)
  res &lt;- numDEpi(X1 = X1, 
		 X2 = X2, 
		 power = 0.8, 
		 theta = 2, 
		 alpha = 0.05)
  print(res)

  # proportion of subjects died of the disease of interest.
  psi &lt;- 0.505

  # total number of subjects required to achieve the desired power
  ceiling(res$D / psi)

</code></pre>

<hr>
<h2 id='numDEpi.default'> 
Calculate Number of Deaths Required for Cox Proportional Hazards Regression with Two Covariates for Epidemiological Studies
</h2><span id='topic+numDEpi.default'></span>

<h3>Description</h3>

<p>Calculate number of deaths required for Cox proportional hazards regression with two covariates for epidemiological Studies. The covariate of interest should be a binary variable. The other covariate can be either binary or non-binary. The formula takes
into account competing risks and the correlation between the two covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>numDEpi.default(power, 
		theta, 
		p, 
		rho2, 
		alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="numDEpi.default_+3A_power">power</code></td>
<td>
<p>numeric. the postulated power.</p>
</td></tr>
<tr><td><code id="numDEpi.default_+3A_theta">theta</code></td>
<td>
<p>numeric. postulated hazard ratio </p>
</td></tr>
<tr><td><code id="numDEpi.default_+3A_p">p</code></td>
<td>
<p>numeric. proportion of subjects taking the value one for the covariate of interest. </p>
</td></tr>
<tr><td><code id="numDEpi.default_+3A_rho2">rho2</code></td>
<td>
<p>numeric. square of the correlation between the covariate of interest and the other covariate. </p>
</td></tr>
<tr><td><code id="numDEpi.default_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the calculation of the number of required deaths 
derived by Latouche et al. (2004)
for the following Cox proportional hazards regression in the epidemiological
studies:
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, x_2)=h_0(t)\exp(\beta_1 x_1+\beta_2 x_2),</code>
</p>

<p>where the covariate <code class="reqn">X_1</code> is of our interest. The covariate <code class="reqn">X_1</code> should be
a binary variable taking two possible values: zero and one, while the 
covariate <code class="reqn">X_2</code> can be binary or continuous.
</p>
<p>Suppose we want to check if the hazard of <code class="reqn">X_1=1</code> is equal to 
the hazard of <code class="reqn">X_1=0</code> or not. Equivalently, we want to check if 
the hazard ratio of <code class="reqn">X_1=1</code> to <code class="reqn">X_1=0</code> is equal to <code class="reqn">1</code> 
or is equal to <code class="reqn">\exp(\beta_1)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the total 
number of deaths required to achieve a power of <code class="reqn">1-\beta</code> is
</p>
<p style="text-align: center;"><code class="reqn">D=\frac{\left(z_{1-\alpha/2}+z_{1-\beta}\right)^2}{
[\log(\theta)]^2 p (1-p) (1-\rho^2),
}</code>
</p>

<p>where <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, </p>
<p style="text-align: center;"><code class="reqn">\rho=corr(X_1, X_2)=(p_1-p_0)\times \sqrt{\frac{q(1-q)}{p(1-p)}},</code>
</p>
 
<p>and
<code class="reqn">p=Pr(X_1=1)</code>, <code class="reqn">q=Pr(X_2=1)</code>, <code class="reqn">p_0=Pr(X_1=1|X_2=0)</code>,
and <code class="reqn">p_1=Pr(X_1=1 | X_2=1)</code>.
</p>


<h3>Value</h3>

<p>The number of deaths required to achieve the desired power with 
given type I error rate.
</p>


<h3>Note</h3>

 
<p>(1) The formula can be used to calculate
power for a randomized trial study by setting <code>rho2=0</code>.
</p>
<p>(2) When <code>rho2=0</code>, the formula derived by Latouche et al. (2004)
looks the same as that derived by Schoenfeld (1983). Latouche et al. (2004) pointed out that in this situation, the interpretations are different hence
the two formulae are actually different. In Latouched et al. (2004), the
hazard ratio <code class="reqn">\theta</code> measures the difference of effect of a covariate 
at two different levels on  the subdistribution hazard for a particular failure, 
while in Schoenfeld (1983), the hazard ratio <code class="reqn">\theta</code> measures 
the difference of effect on the cause-specific hazard.
</p>


<h3>References</h3>

 
<p>Schoenfeld DA. (1983).
Sample-size formula for the proportional-hazards regression model.
<em>Biometrics</em>. 39:499-503.
</p>
<p>Latouche A., Porcher R. and Chevret S. (2004).
Sample size formula for proportional hazards modelling of competing risks.
<em>Statistics in Medicine</em>. 23:3263-3274.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+numDEpi">numDEpi</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Example at the end of Section 5.2 of Latouche et al. (2004)
  # for a cohort study.
  D &lt;- numDEpi.default(power = 0.8, 
		       theta = 2, 
		       p = 0.39, 
                       rho2 = 0.132^2, 
		       alpha = 0.05)

  # proportion of subjects died of the disease of interest.
  psi &lt;- 0.505

  # total number of subjects required to achieve the desired power
  ceiling(D / psi)

</code></pre>

<hr>
<h2 id='Oph'>Ophthalmology Data</h2><span id='topic+Oph'></span>

<h3>Description</h3>

<p>The Ophthalmology data set is described in Example 14.41 on page 807 in Rosner (2006).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Oph)</code></pre>


<h3>Format</h3>

<p>A data frame with 354 observations on the following 3 variables.
</p>

<dl>
<dt><code>times</code></dt><dd><p>a numeric vector recording the survival/censoring time for each event/censoring.</p>
</dd> 
<dt><code>status</code></dt><dd><p>a numeric vector recording if a observed time is event time (<code>status=1</code>) 
or censoring time (<code>status=0</code>).</p>
</dd>
<dt><code>group</code></dt><dd><p>a factor with levels <code>C</code> (indicating control group) and <code>E</code> (indicating 
experimental group).</p>
</dd>
</dl>



<h3>Details</h3>

<p>This data set was from a clinical trial (Berson et al., 1993) conducted to test the efficacy of different 
vitamin supplements in preventing visual loss in patients with retinitis pigmentosa. Rosner (2006) used the
data from this clinical trial to illustrate the analysis of survival data (Sections 14.9-14.12 of Rosner (2006)).
</p>
<p>The data set consists of two groups of participants: 
(1) the experimental group (i.e., group E in which participants receiving 15,000 IU of vitamin A per day)
and (2) the control group (i.e., group C in which participants receiving 75 IU of vitamin A per day).
</p>
<p>The participants were enrolled over a 2-year period (1984-1987) and followed for a maximum of 6 years. The
follow-up was terminated in September 1991. Some participants dropped out of the study before September 1991 
and had not failed. Dropouts were due to death, other diseases, or side effects possibly due to the 
study medications, or unwillingness to comply (take study medications). There are 6 time points (at 1st year, 
2nd year, 3rd year, 4th year, 5-th year, and 6-th year) in this data set.
</p>
<p>Rosner (2006, page 786) defined
the participants who do not reach a disease endpoint during their period of follow-up as censored observations.
A participant has been censored at time <code class="reqn">t</code> if the participant has been followed up to time <code class="reqn">t</code> and has
not failed. Noninformative censoring is assumed. That is, participants who are censored have the same 
underlying survival curve after their censoring time as patients who are not censored.
</p>


<h3>Source</h3>

<p>Created based on Table 14.12 on page 787 of Rosner (2006).
</p>


<h3>References</h3>

<p>Berson, E.L., Rosner, B., Sandberg, M.A., Hayes, K.C., Nicholson, B.W., Weigel-DiFranco, C., and Willett, W.C. (1993).
A randomized trial of vitamin A and vitamin E supplementation for retinitis pigmentosa.
<em>Archives of Ophthalmology</em>. 111:761-772.
</p>
<p>Rosner B. (2006).
<em>Fundamentals of Biostatistics</em>. (6-th edition). Thomson Brooks/Cole.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Oph)
</code></pre>

<hr>
<h2 id='power.stratify'>
Power Calculation for Survival Analysis with Binary Predictor and Exponential Survival Function
</h2><span id='topic+power.stratify'></span>

<h3>Description</h3>

<p>Power calculation for survival analysis with binary predictor and exponential survival function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.stratify(
    n, 
    timeUnit, 
    gVec, 
    PVec, 
    HR, 
    lambda0Vec, 
    power.ini = 0.8, 
    power.low = 0.001, 
    power.upp = 0.999, 
    alpha = 0.05, 
    verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power.stratify_+3A_n">n</code></td>
<td>

<p>integer. Sample size.
</p>
</td></tr>
<tr><td><code id="power.stratify_+3A_timeunit">timeUnit</code></td>
<td>

<p>numeric. Total study length.
</p>
</td></tr>
<tr><td><code id="power.stratify_+3A_gvec">gVec</code></td>
<td>

<p>numerc. m by 1 vector. The s-th element is the proportion of the total sample size for 
the s-th stratum, where m is the number of strata.
</p>
</td></tr>
<tr><td><code id="power.stratify_+3A_pvec">PVec</code></td>
<td>

<p>numeric. m by 1 vector. The s-th element is the proportion of subjects in treatment group 1 for the s-th stratum, where m is the number of strata.
</p>
</td></tr>
<tr><td><code id="power.stratify_+3A_hr">HR</code></td>
<td>

<p>numeric. Hazard ratio (Ratio of the hazard for treatment group 1 to the hazard for treatment group 0, i.e. reference group).
</p>
</td></tr>
<tr><td><code id="power.stratify_+3A_lambda0vec">lambda0Vec</code></td>
<td>

<p>numeric. m by 1 vector. The s-th element is the hazard for treatment group 0 (i.e., reference group) in the s-th stratum.
</p>
</td></tr>
<tr><td><code id="power.stratify_+3A_power.ini">power.ini</code></td>
<td>

<p>numeric. Initial power estimate.
</p>
</td></tr>
<tr><td><code id="power.stratify_+3A_power.low">power.low</code></td>
<td>

<p>numeric. Lower bound for power.
</p>
</td></tr>
<tr><td><code id="power.stratify_+3A_power.upp">power.upp</code></td>
<td>

<p>numeric. Upper bound for power.
</p>
</td></tr>
<tr><td><code id="power.stratify_+3A_alpha">alpha</code></td>
<td>

<p>numeric. Type I error rate.
</p>
</td></tr>
<tr><td><code id="power.stratify_+3A_verbose">verbose</code></td>
<td>

<p>Logical. Indicating if intermediate results will be output or not.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We assume (1) there is only one predictor and no covariates in the survival model 
(exponential survival function); (2) there are <code>m</code> strata; (3) the predictor <code>x</code>
is a binary variable indicating treatment group 1 (<code class="reqn">x=1</code>) or treatment group 0
(<code class="reqn">x=0</code>); (3) the treatment effect is constant over time (proportional hazards);
(4) the hazard ratio is the same in all strata, and (5) the data will be analyzed by 
the stratified log rank test.
</p>
<p>The sample size formula is Formula (1) on page 801 of Palta M and Amini SB (1985):
</p>
<p style="text-align: center;"><code class="reqn">
n=(Z_{\alpha}+Z_{\beta})^2/\mu^2
</code>
</p>
 
<p>where <code class="reqn">\alpha</code> is the Type I error rate,
<code class="reqn">\beta</code> is the Type II error rate (power<code class="reqn">=1-\beta</code>),
<code class="reqn">Z_{\alpha}</code> is the <code class="reqn">100(1-\alpha)</code>-th percentile of standard normal distribution, and
</p>
<p style="text-align: center;"><code class="reqn">
\mu=\log(\delta)\sqrt{ \sum_{s=1}^{m} g_s P_s (1 - P_s) V_s }
</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
V_s=P_s\left[1-\frac{1}{\lambda_{1s}} \left\{
\exp\left[-\lambda_{1s}(T-1)\right]
-\exp(-\lambda_{1s}T)
\right\}
\right]
+(1-P_s)\left[
1-\frac{1}{\lambda_{0s}}
\left\{
\exp\left[-\lambda_{0s}(T-1)\right]
-\exp(-\lambda_{0s}T
\right\}
\right]
</code>
</p>

<p>In the above formulas, <code class="reqn">m</code> is the number of strata,
<code class="reqn">T</code> is the total study length, <code class="reqn">\delta</code> is the hazard ratio,
<code class="reqn">g_s</code> is the proportion of the total sample size in stratum <code class="reqn">s</code>,
<code class="reqn">P_s</code> is the proportion of stratum <code class="reqn">s</code>, which is in treatment group 1,
and <code class="reqn">\lambda_{is}</code> is the hazard for the <code class="reqn">i</code>-th treatment group in 
stratum <code class="reqn">s</code>.
</p>


<h3>Value</h3>

<p>A list of 2 elments.
</p>
<table>
<tr><td><code>power</code></td>
<td>
<p>Estimated power</p>
</td></tr>
<tr><td><code>res.optim</code></td>
<td>
<p>Object returned by funciton <code>optim</code>. We used numerical optimization method to calculate power based on sample size calculation formula.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Palta M and Amini SB. (1985). 
Consideration of covariates and stratification in sample size determination for survival time studies. 
<em>Journal of Chronic Diseases</em>. 38(9):801-809.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ssize.stratify">ssize.stratify</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# example on page 803 of Palta M and Amini SB. (1985). 
res.power &lt;- power.stratify(
  n = 146, 
  timeUnit = 1.25, 
  gVec = c(0.5, 0.5),
  PVec = c(0.5, 0.5), 
  HR = 1 / 1.91, 
  lambda0Vec = c(2.303, 1.139),
  power.ini = 0.8, 
  power.low = 0.001, 
  power.upp = 0.999,
  alpha = 0.05, 
  verbose = TRUE
  )

</code></pre>

<hr>
<h2 id='powerConLogistic.bin'>
Sample Size Calculation for Conditional Logistic Regression with Binary Covariate
</h2><span id='topic+powerConLogistic.bin'></span>

<h3>Description</h3>

<p>Sample Size Calculation for Conditional Logistic Regression with Binary Covariate, such as matched logistic regression or nested case-control study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerConLogistic.bin(
  N = NULL, 
  power = 0.8, 
  OR, 
  pE, 
  nD, 
  nH, 
  R2 = 0, 
  alpha = 0.05, 
  nTests = 1,
  OR.low = 1.01,
  OR.upp = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerConLogistic.bin_+3A_n">N</code></td>
<td>

<p>integer. Number of sets. Each set contains <code>nD</code> cases and <code>nH</code> controls.  
</p>
</td></tr>
<tr><td><code id="powerConLogistic.bin_+3A_power">power</code></td>
<td>

<p>numeric. Power of the test for if the exposure variable is associated with the risk of diseases
</p>
</td></tr>
<tr><td><code id="powerConLogistic.bin_+3A_or">OR</code></td>
<td>

<p>numeric. Odds ratio <code class="reqn">=exp(\theta)</code>, where <code class="reqn">\theta</code> is the 
regression coefficient of the exposure variable.
</p>
</td></tr>
<tr><td><code id="powerConLogistic.bin_+3A_pe">pE</code></td>
<td>

<p>numeric. Population prevalence of exposure.
</p>
</td></tr>
<tr><td><code id="powerConLogistic.bin_+3A_nd">nD</code></td>
<td>

<p>integer. Number of cases per set.
</p>
</td></tr>
<tr><td><code id="powerConLogistic.bin_+3A_nh">nH</code></td>
<td>

<p>integer. Number of controls per set.
</p>
</td></tr>
<tr><td><code id="powerConLogistic.bin_+3A_r2">R2</code></td>
<td>

<p>numeric. Coefficient of determination of the exposure variable and other covariates
</p>
</td></tr>
<tr><td><code id="powerConLogistic.bin_+3A_alpha">alpha</code></td>
<td>

<p>numeric. family-wise type I error rate.
</p>
</td></tr>
<tr><td><code id="powerConLogistic.bin_+3A_ntests">nTests</code></td>
<td>

<p>integer. Number of tests.
</p>
</td></tr>
<tr><td><code id="powerConLogistic.bin_+3A_or.low">OR.low</code></td>
<td>

<p>numeric. Lower bound of odds ratio. Only used when <code>OR=NULL</code> and <code>power</code> and <code>N</code> are not equal to NULL.
</p>
</td></tr>
<tr><td><code id="powerConLogistic.bin_+3A_or.upp">OR.upp</code></td>
<td>

<p>numeric. Upper bound of odds ratio. Only used when <code>OR=NULL</code> and <code>power</code> and <code>N</code> are not equal to NULL.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power and sample size calculation formulas are provided by Lachin (2008, Section 3.3, Formula (38))
</p>
<p style="text-align: center;"><code class="reqn">power = \Phi\left( \sqrt{N c} - z_{\alpha/(2 nTests)}\right)</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">N = (z_{power} + z_{\alpha/(2 nTests)})^2/ c</code>
</p>

<p>where <code class="reqn">\Phi</code> is the cumulative distribution function of the 
standard normal distribution <code class="reqn">N(0, 1)</code>, <code class="reqn">z_{a}</code> is the upper <code class="reqn">100 a</code>-th
percentile of <code class="reqn">N(0, 1)</code>,
</p>
<p style="text-align: center;"><code class="reqn">c = \theta^2 pE (1-pE) (1-R^2)nD*nH/(nD+nH)</code>
</p>

<p>and <code class="reqn">R^2</code> is the coefficient of determination for linear regression
linking the exposure with other covariates.
</p>


<h3>Value</h3>

<p>If the inputs <code>is.null(N) = TRUE</code> and <code>is.null(power) = FALSE</code>, 
then the function returns the number <code>N</code> of sets.
</p>
<p>If the inputs <code>is.null(N) = FALSE</code> and <code>is.null(power) = TRUE</code>, 
then the function returns the power. 
</p>
<p>Otherwise, an error message is output.
</p>


<h3>References</h3>

<p>Lachin, JM
Sample Size Evaluation for a Multiply Matched Case-Control Study Using the Score Test From a Conditional Logistic (Discrete Cox PH) Regression Model.
Stat Med. 2008 27(14): 2509-2523
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# estimate power
power = powerConLogistic.bin(
  N = 59, 
  power = NULL, 
  OR = 3.5, 
  pE = 0.15, 
  nD = 1, 
  nH = 2, 
  R2 = 0, 
  alpha = 0.05, 
  nTests = 1)

print(power) # 0.80

# estimate N (number of sets)
N = powerConLogistic.bin(
  N = NULL, 
  power = 0.80, 
  OR = 3.5, 
  pE = 0.15, 
  nD = 1, 
  nH = 2, 
  R2 = 0, 
  alpha = 0.05, 
  nTests = 1)

print(ceiling(N)) # 59

# estimate OR
OR = powerConLogistic.bin(
  N = 59, 
  power = 0.80, 
  OR = NULL, 
  pE = 0.15, 
  nD = 1, 
  nH = 2, 
  R2 = 0, 
  alpha = 0.05, 
  nTests = 1,
  OR.low = 1.01,
  OR.upp = 100)

print(OR) # 3.49



</code></pre>

<hr>
<h2 id='powerConLogistic.con'>
Sample Size Calculation for Conditional Logistic Regression with Continuous Covariate
</h2><span id='topic+powerConLogistic.con'></span>

<h3>Description</h3>

<p>Sample Size Calculation for Conditional Logistic Regression with Continuous Covariate, such as matched logistic regression or nested case-control study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerConLogistic.con(
  N = NULL, 
  power = 0.8, 
  OR, 
  sigma, 
  nD, 
  nH, 
  R2 = 0, 
  alpha = 0.05, 
  nTests = 1,
  OR.low = 1.01,
  OR.upp = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerConLogistic.con_+3A_n">N</code></td>
<td>

<p>integer. Number of sets. Each set contains <code>nD</code> cases and <code>nH</code> controls.  
</p>
</td></tr>
<tr><td><code id="powerConLogistic.con_+3A_power">power</code></td>
<td>

<p>numeric. Power of the test for if the exposure variable is associated with the risk of diseases
</p>
</td></tr>
<tr><td><code id="powerConLogistic.con_+3A_or">OR</code></td>
<td>

<p>numeric. Odds ratio <code class="reqn">=exp(\theta)</code>, where <code class="reqn">\theta</code> is the 
regression coefficient of the exposure variable.
</p>
</td></tr>
<tr><td><code id="powerConLogistic.con_+3A_sigma">sigma</code></td>
<td>

<p>numeric. Standard deviation of the continuous exposure variable.
</p>
</td></tr>
<tr><td><code id="powerConLogistic.con_+3A_nd">nD</code></td>
<td>

<p>integer. Number of cases per set.
</p>
</td></tr>
<tr><td><code id="powerConLogistic.con_+3A_nh">nH</code></td>
<td>

<p>integer. Number of controls per set.
</p>
</td></tr>
<tr><td><code id="powerConLogistic.con_+3A_r2">R2</code></td>
<td>

<p>numeric. Coefficient of determination of the exposure variable and other covariates
</p>
</td></tr>
<tr><td><code id="powerConLogistic.con_+3A_alpha">alpha</code></td>
<td>

<p>numeric. family-wise type I error rate.
</p>
</td></tr>
<tr><td><code id="powerConLogistic.con_+3A_ntests">nTests</code></td>
<td>

<p>integer. Number of tests.
</p>
</td></tr>
<tr><td><code id="powerConLogistic.con_+3A_or.low">OR.low</code></td>
<td>

<p>numeric. Lower bound of odds ratio. Only used when <code>OR=NULL</code> and <code>power</code> and <code>N</code> are not equal to NULL.
</p>
</td></tr>
<tr><td><code id="powerConLogistic.con_+3A_or.upp">OR.upp</code></td>
<td>

<p>numeric. Upper bound of odds ratio. Only used when <code>OR=NULL</code> and <code>power</code> and <code>N</code> are not equal to NULL.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power and sample size calculation formulas are provided by Lachin (2008, Section 3.1, Formulas (24) and (25))
</p>
<p style="text-align: center;"><code class="reqn">power = \Phi\left( \sqrt{N c} - z_{\alpha/(2 nTests)}\right)</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">N = (z_{power} + z_{\alpha/(2 nTests)})^2/ c</code>
</p>

<p>where <code class="reqn">\Phi</code> is the cumulative distribution function of the 
standard normal distribution <code class="reqn">N(0, 1)</code>, <code class="reqn">z_{a}</code> is the upper <code class="reqn">100 a</code>-th
percentile of <code class="reqn">N(0, 1)</code>,
</p>
<p style="text-align: center;"><code class="reqn">c = \theta^2 \sigma^2 nD (1-1/b) (1-R^2)</code>
</p>

<p>and <code class="reqn">b</code> is the Binomial coefficient (<code class="reqn">n</code> chooses <code class="reqn">nD</code>), <code class="reqn">n = nD + nH</code>,  and <code class="reqn">R^2</code> is the coefficient of determination for linear regression
linking the exposure with other covariates.
</p>


<h3>Value</h3>

<p>If the inputs <code>is.null(N) = TRUE</code> and <code>is.null(power) = FALSE</code>, 
then the function returns the number <code>N</code> of sets.
</p>
<p>If the inputs <code>is.null(N) = FALSE</code> and <code>is.null(power) = TRUE</code>, 
then the function returns the power. 
</p>
<p>Otherwise, an error message is output.
</p>


<h3>References</h3>

<p>Lachin, JM
Sample Size Evaluation for a Multiply Matched Case-Control Study Using the Score Test From a Conditional Logistic (Discrete Cox PH) Regression Model.
Stat Med. 2008 27(14): 2509-2523
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(pracma)

# Section 4.1 in Lachin (2008) 

# estimate number of sets 
N = powerConLogistic.con(N = NULL,
                                power = 0.85,
                                OR = 1.39,
                                sigma = 1,
                                nD = 1,
                                nH = 2,
                                R2 = 0,
                                alpha = 0.05,
                                nTests = 1)
print(ceiling(N)) # 125

# estimate power 
power = powerConLogistic.con(N = 125,
                                power = NULL,
                                OR = 1.39,
                                sigma = 1,
                                nD = 1,
                                nH = 2,
                                R2 = 0,
                                alpha = 0.05,
                                nTests = 1)
print(power) # 0.85

# estimate OR 
OR = powerConLogistic.con(N = 125,
                                power = 0.85,
                                OR = NULL,
                                sigma = 1,
                                nD = 1,
                                nH = 2,
                                R2 = 0,
                                alpha = 0.05,
                                nTests = 1)
print(OR) # 1.39


</code></pre>

<hr>
<h2 id='powerCT'> Power Calculation in the Analysis of Survival Data for Clinical Trials </h2><span id='topic+powerCT'></span>

<h3>Description</h3>

<p>Power calculation for the Comparison of Survival Curves Between Two Groups under
the Cox Proportional-Hazards Model for clinical trials. Some parameters will be estimated based on a pilot data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerCT(formula, 
	dat, 
	nE, 
	nC, 
	RR, 
	alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerCT_+3A_formula">formula</code></td>
<td>
<p> A formula object, e.g. <code>Surv(time, status) ~ x</code>, where 
<code>time</code> is a vector of survival/censoring time, <code>status</code> is a vector of 
censoring indicator, <code>x</code> is the group indicator,
which is a factor object in R and takes only two possible values (<code>C</code> for control group 
and <code>E</code> for experimental group). See also the documentation of the function <code>survfit</code> in the 
library <code>survival</code>.</p>
</td></tr>
<tr><td><code id="powerCT_+3A_dat">dat</code></td>
<td>
<p> a data frame representing the pilot data set and containing at least 3 columns: (1) survival/censoring time; (2) censoring indicator;
(3) group indicator which is a factor object in R and takes only two possible values (<code>C</code> for control group 
and <code>E</code> for experimental group). </p>
</td></tr>
<tr><td><code id="powerCT_+3A_ne">nE</code></td>
<td>
<p>integer. number of participants in the experimental group. </p>
</td></tr>
<tr><td><code id="powerCT_+3A_nc">nC</code></td>
<td>
<p>integer. number of participants in the control group. </p>
</td></tr>
<tr><td><code id="powerCT_+3A_rr">RR</code></td>
<td>
<p>numeric. postulated hazard ratio.</p>
</td></tr>
<tr><td><code id="powerCT_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the power calculation method described in Section 14.12 (page 807)
of Rosner (2006). The method was proposed by Freedman (1982).
</p>
<p>The movitation of this function is that some times we do not have information about <code class="reqn">m</code> or <code class="reqn">p_E</code>
and <code class="reqn">p_C</code> available, but we have a pilot data set that can be used to estimate <code class="reqn">p_E</code> and <code class="reqn">p_C</code> hence
<code class="reqn">m</code>, where  <code class="reqn">m=n_E p_E + n_C p_C</code> is the expected total number of events over both groups, <code class="reqn">n_E</code>
and <code class="reqn">n_C</code> are numbers of participants in group E (experimental group) and group C (control group), respectively.
<code class="reqn">p_E</code> is the probability of failure in group E (experimental group) over the maximum time period of the study (t years).  <code class="reqn">p_C</code> is the probability of failure in group C (control group) over the maximum time period of the study 
(t years). 
</p>
<p>Suppose we want to compare the survival curves between an experimental group (<code class="reqn">E</code>) and 
a control group (<code class="reqn">C</code>) in a clinical trial with a maximum follow-up of <code class="reqn">t</code> years. 
The Cox proportional hazards regression model is assumed to have the form:
</p>
<p style="text-align: center;"><code class="reqn">h(t|X_1)=h_0(t)\exp(\beta_1 X_1).</code>
</p>

<p>Let <code class="reqn">n_E</code> be the number of participants in the <code class="reqn">E</code> group
and <code class="reqn">n_C</code> be the number of participants in the <code class="reqn">C</code> group.  
We wish to test the hypothesis <code class="reqn">H0: RR=1</code> versus <code class="reqn">H1: RR</code> not equal to 1, 
where <code class="reqn">RR=\exp(\beta_1)=</code>underlying hazard ratio
for the <code class="reqn">E</code> group versus the <code class="reqn">C</code> group. Let <code class="reqn">RR</code> be the postulated hazard ratio,
<code class="reqn">\alpha</code> be the significance level. Assume that the test is a two-sided test.
If the ratio of participants in group 
E compared to group C <code class="reqn">= n_E/n_C=k</code>, then the power of the test is
</p>
<p style="text-align: center;"><code class="reqn">power=\Phi(\sqrt{k*m}*|RR-1|/(k*RR+1)-z_{1-\alpha/2}),</code>
</p>
 
<p>where </p>
<p style="text-align: center;"><code class="reqn">m=n_E p_E+n_C p_C,</code>
</p>
 
<p>and <code class="reqn">z_{1-\alpha/2}</code> 
is the <code class="reqn">100 (1-\alpha/2)</code>-th percentile of
the standard normal distribution <code class="reqn">N(0, 1)</code>, <code class="reqn">\Phi</code> is the cumulative distribution function (CDF) 
of <code class="reqn">N(0, 1)</code>.
</p>
<p><code class="reqn">p_C</code> and <code class="reqn">p_E</code> can be calculated from the following formulaes:
</p>
<p style="text-align: center;"><code class="reqn">p_C=\sum_{i=1}^{t}D_i, p_E=\sum_{i=1}^{t}E_i,</code>
</p>

<p>where <code class="reqn">D_i=\lambda_i A_i C_i</code>, <code class="reqn">E_i=RR\lambda_i B_i C_i</code>, 
<code class="reqn">A_i=\prod_{j=0}^{i-1}(1-\lambda_j)</code>, <code class="reqn">B_i=\prod_{j=0}^{i-1}(1-RR\lambda_j)</code>, 
<code class="reqn">C_i=\prod_{j=0}^{i-1}(1-\delta_j)</code>.  And
<code class="reqn">\lambda_i</code> is the probability of failure at time <code>i</code> among participants in the 
control group, given that a participant has survived to time <code class="reqn">i-1</code> and is not censored at time <code class="reqn">i-1</code>,
i.e., the approximate hazard time <code class="reqn">i</code> in the control group, <code class="reqn">i=1,...,t</code>; 
<code class="reqn">RRlambda_i</code> is the probability of failure at time <code>i</code> among participants in the 
experimental group, given that a participant has survived to time <code class="reqn">i-1</code> and is not censored at time <code class="reqn">i-1</code>,
i.e., the approximate hazard time <code class="reqn">i</code> in the experimental group, <code class="reqn">i=1,...,t</code>; 
<code class="reqn">delta</code> is the prbability that a participant is censored at time <code class="reqn">i</code> given that he was 
followed up to time <code class="reqn">i</code> and has not failed, <code class="reqn">i=0, 1, ..., t</code>, which is assumed the same in each group. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>mat.lambda</code></td>
<td>
<p>a matrix with 9 columns and <code>nTimes+1</code> rows, where <code>nTimes</code> is the number of
observed time points for the control group in the data set. The 9 columns are 
(1) <code>time</code> - observed time point for the control group; 
(2) <code>lambda</code>;  
(3) <code>RRlambda</code>; 
(4) <code>delta</code>; 
(5) <code>A</code>; 
(6) <code>B</code>; 
(7) <code>C</code>; 
(8) <code>D</code>; 
(9) <code>E</code>. 
Please refer to the Details section for the definitions of elements
of these quantities. See also Table 14.24 on page 809 of Rosner (2006). 
</p>
</td></tr>
<tr><td><code>mat.event</code></td>
<td>
<p>a matrix with 5 columns and <code>nTimes+1</code> rows, where <code>nTimes</code> is the number of
observed time points for control group in the data set. The 5 columns are 
(1) <code>time</code> - observed time point for the control group; 
(2) <code>nEvent.C</code> - number of events in the control group at each time point;
(3) <code>nCensored.C</code> - number of censorings in the control group at each time point;
(4) <code>nSurvive.C</code> - number of alived in the control group at each time point;
(5) <code>nRisk.C</code> - number of participants at risk in the control group at each time point.
Please refer to Table 14.12 on page 787 of Rosner (2006). 
</p>
</td></tr>
<tr><td><code>pC</code></td>
<td>
<p> estimated probability of failure in group C (control group) over the maximum time period of the study (t years). </p>
</td></tr>
<tr><td><code>pE</code></td>
<td>
<p> estimated probability of failure in group E (experimental group) over the maximum time period of the study (t years). </p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>the power of the test.</p>
</td></tr>
</table>


<h3>Note</h3>

 
<p>(1) The estimates of <code class="reqn">RRlambda_i=RR*\lambda_i</code>. That is, <code>RRlambda</code> is not directly estimated based on data
from the experimental group;
(2) The power formula assumes that the central-limit theorem is valid and hence is appropriate for large samples.
</p>


<h3>References</h3>

 
<p>Freedman, L.S. (1982). 
Tables of the number of patients required in clinical trials using the log-rank test. 
<em>Statistics in Medicine</em>. 1: 121-129
</p>
<p>Rosner B. (2006).
<em>Fundamentals of Biostatistics</em>. (6-th edition). Thomson Brooks/Cole.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+powerCT.default0">powerCT.default0</a></code>, 
<code><a href="#topic+powerCT.default">powerCT.default</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Example 14.42 in Rosner B. Fundamentals of Biostatistics. 
  # (6-th edition). (2006) page 809

  library(survival)

  data(Oph)
  res &lt;- powerCT(formula = Surv(times, status) ~ group, 
		 dat = Oph, 
                 nE = 200, 
		 nC = 200, 
		 RR = 0.7, 
		 alpha = 0.05)

  # Table 14.24 on page 809 of Rosner (2006)
  print(round(res$mat.lambda, 4))

  # Table 14.12 on page 787 of Rosner (2006)
  print(round(res$mat.event, 4))

  # the power
  print(round(res$power, 2))
</code></pre>

<hr>
<h2 id='powerCT.default'> Power Calculation in the Analysis of Survival Data for Clinical Trials </h2><span id='topic+powerCT.default'></span>

<h3>Description</h3>

<p>Power calculation for the Comparison of Survival Curves Between Two Groups under
the Cox Proportional-Hazards Model for clinical trials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerCT.default(nE, 
		nC, 
		pE, 
		pC, 
		RR, 
		alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerCT.default_+3A_ne">nE</code></td>
<td>
<p>integer. number of participants in the experimental group. </p>
</td></tr>
<tr><td><code id="powerCT.default_+3A_nc">nC</code></td>
<td>
<p>integer. number of participants in the control group. </p>
</td></tr>
<tr><td><code id="powerCT.default_+3A_pe">pE</code></td>
<td>
<p>numeric. probability of failure in group E (experimental group) over the maximum time period of the study (t years). </p>
</td></tr>
<tr><td><code id="powerCT.default_+3A_pc">pC</code></td>
<td>
<p>numeric. probability of failure in group C (control group) over the maximum time period of the study (t years). </p>
</td></tr>
<tr><td><code id="powerCT.default_+3A_rr">RR</code></td>
<td>
<p>numeric. postulated hazard ratio.</p>
</td></tr>
<tr><td><code id="powerCT.default_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the power calculation method described in Section 14.12 (page 807)
of Rosner (2006). The method was proposed by Freedman (1982).
</p>
<p>Suppose we want to compare the survival curves between an experimental group (<code class="reqn">E</code>) and 
a control group (<code class="reqn">C</code>) in a clinical trial with a maximum follow-up of <code class="reqn">t</code> years. 
The Cox proportional hazards regression model is assumed to have the form:
</p>
<p style="text-align: center;"><code class="reqn">h(t|X_1)=h_0(t)\exp(\beta_1 X_1).</code>
</p>

<p>Let <code class="reqn">n_E</code> be the number of participants in the <code class="reqn">E</code> group
and <code class="reqn">n_C</code> be the number of participants in the <code class="reqn">C</code> group.  
We wish to test the hypothesis <code class="reqn">H0: RR=1</code> versus <code class="reqn">H1: RR</code> not equal to 1, 
where <code class="reqn">RR=\exp(\beta_1)=</code>underlying hazard ratio
for the <code class="reqn">E</code> group versus the <code class="reqn">C</code> group. Let <code class="reqn">RR</code> be the postulated hazard ratio,
<code class="reqn">\alpha</code> be the significance level. Assume that the test is a two-sided test.
If the ratio of participants in group 
E compared to group C <code class="reqn">= n_E/n_C=k</code>, then the power of the test is
</p>
<p style="text-align: center;"><code class="reqn">power=\Phi(\sqrt{k*m}*|RR-1|/(k*RR+1)-z_{1-\alpha/2}),</code>
</p>
 
<p>where </p>
<p style="text-align: center;"><code class="reqn">m=n_E p_E+n_C p_C,</code>
</p>
 
<p>and <code class="reqn">z_{1-\alpha/2}</code> 
is the <code class="reqn">100 (1-\alpha/2)</code>-th percentile of
the standard normal distribution <code class="reqn">N(0, 1)</code>, <code class="reqn">\Phi</code> is the cumulative distribution function (CDF) 
of <code class="reqn">N(0, 1)</code>.
</p>


<h3>Value</h3>

<p>The power of the test.
</p>


<h3>Note</h3>

 
<p>The power formula assumes that the central-limit theorem is valid and hence is appropriate for large samples.
</p>


<h3>References</h3>

 
<p>Freedman, L.S. (1982). 
Tables of the number of patients required in clinical trials using the log-rank test. 
<em>Statistics in Medicine</em>. 1: 121-129
</p>
<p>Rosner B. (2006).
<em>Fundamentals of Biostatistics</em>. (6-th edition). Thomson Brooks/Cole.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+powerCT.default0">powerCT.default0</a></code>, 
<code><a href="#topic+powerCT">powerCT</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Example 14.42 in Rosner B. Fundamentals of Biostatistics. 
  # (6-th edition). (2006) page 809
  powerCT.default(nE = 200, 
		  nC = 200, 
		  pE = 0.3707, 
		  pC = 0.4890, 
                  RR = 0.7, 
		  alpha = 0.05)
</code></pre>

<hr>
<h2 id='powerCT.default0'>Power Calculation in the Analysis of Survival Data for Clinical Trials</h2><span id='topic+powerCT.default0'></span>

<h3>Description</h3>

<p>Power calculation for the Comparison of Survival Curves Between Two Groups under
the Cox Proportional-Hazards Model for clinical trials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerCT.default0(k, 
		 m, 
		 RR, 
		 alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerCT.default0_+3A_k">k</code></td>
<td>
<p>numeric. ratio of participants in group E (experimental group) compared to group C (control group).</p>
</td></tr>
<tr><td><code id="powerCT.default0_+3A_m">m</code></td>
<td>
<p>integer. expected total number of events over both groups.</p>
</td></tr>
<tr><td><code id="powerCT.default0_+3A_rr">RR</code></td>
<td>
<p>numeric. postulated hazard ratio. </p>
</td></tr>
<tr><td><code id="powerCT.default0_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the power calculation method described in Section 14.12 (page 807)
of Rosner (2006). The method was proposed by Freedman (1982).
</p>
<p>Suppose we want to compare the survival curves between an experimental group (<code class="reqn">E</code>) and 
a control group (<code class="reqn">C</code>) in a clinical trial with a maximum follow-up of <code class="reqn">t</code> years. 
The Cox proportional hazards regression model is assumed to have the form:
</p>
<p style="text-align: center;"><code class="reqn">h(t|X_1)=h_0(t)\exp(\beta_1 X_1).</code>
</p>

<p>Let <code class="reqn">n_E</code> be the number of participants in the <code class="reqn">E</code> group
and <code class="reqn">n_C</code> be the number of participants in the <code class="reqn">C</code> group.  
We wish to test the hypothesis <code class="reqn">H0: RR=1</code> versus <code class="reqn">H1: RR</code> not equal to 1, 
where <code class="reqn">RR=\exp(\beta_1)=</code>underlying hazard ratio
for the <code class="reqn">E</code> group versus the <code class="reqn">C</code> group. Let <code class="reqn">RR</code> be the postulated hazard ratio,
<code class="reqn">\alpha</code> be the significance level. Assume that the test is a two-sided test.
If the ratio of participants in group 
E compared to group C <code class="reqn">= n_E/n_C=k</code>, then the power of the test is
</p>
<p style="text-align: center;"><code class="reqn">power=\Phi(\sqrt{k*m}*|RR-1|/(k*RR+1)-z_{1-\alpha/2}),</code>
</p>
 
<p>where <code class="reqn">z_{1-\alpha/2}</code> 
is the <code class="reqn">100 (1-\alpha/2)</code>-th percentile of
the standard normal distribution <code class="reqn">N(0, 1)</code>, <code class="reqn">\Phi</code> is the cumulative distribution function (CDF) 
of <code class="reqn">N(0, 1)</code>.
</p>


<h3>Value</h3>

<p>The power of the test.
</p>


<h3>Note</h3>

 
<p>The power formula assumes that the central-limit theorem is valid and hence is appropriate for large samples.
</p>


<h3>References</h3>

 
<p>Freedman, L.S. (1982). 
Tables of the number of patients required in clinical trials using the log-rank test. 
<em>Statistics in Medicine</em>. 1: 121-129
</p>
<p>Rosner B. (2006).
<em>Fundamentals of Biostatistics</em>. (6-th edition). Thomson Brooks/Cole.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+powerCT.default">powerCT.default</a></code>,
<code><a href="#topic+powerCT">powerCT</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Example 14.42 in Rosner B. Fundamentals of Biostatistics. 
  # (6-th edition). (2006) page 809
  powerCT.default0(k = 1, 
		   m = 171.9, 
		   RR = 0.7, 
		   alpha = 0.05)
</code></pre>

<hr>
<h2 id='powerEpi'> Power Calculation for Cox Proportional Hazards Regression with Two Covariates for Epidemiological Studies</h2><span id='topic+powerEpi'></span>

<h3>Description</h3>

<p>Power calculation for Cox proportional hazards regression with two covariates for epidemiological Studies. The covariate of interest should be a binary variable. The other covariate can be either binary or non-binary. The formula takes
into account competing risks and the correlation between the two covariates.
Some parameters will be estimated based on a pilot data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerEpi(X1, X2, failureFlag, n, theta, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerEpi_+3A_x1">X1</code></td>
<td>
<p>numeric. a <code>nPilot</code> by 1 vector, where <code>nPilot</code> is the number of subjects 
in the pilot data set. This vector records the values of the covariate of 
interest for the <code>nPilot</code> subjects in the pilot study. <code>X1</code> should 
be binary and take only two possible values: zero and one.
</p>
</td></tr>
<tr><td><code id="powerEpi_+3A_x2">X2</code></td>
<td>
<p>numeric. a <code>nPilot</code> by 1 vector, where <code>nPilot</code> is the number of subjects
in the pilot study. This vector records the values of the second covariate 
for the <code>nPilot</code> subjects in the pilot study. <code>X2</code> can be binary or 
non-binary.
</p>
</td></tr>
<tr><td><code id="powerEpi_+3A_failureflag">failureFlag</code></td>
<td>
<p>numeric. a <code>nPilot</code> by 1 vector of indicators indicating if a subject is 
failure (<code>failureFlag=1</code>) or alive (<code>failureFlag=0</code>). 
</p>
</td></tr>
<tr><td><code id="powerEpi_+3A_n">n</code></td>
<td>
<p>integer. total number of subjects </p>
</td></tr>
<tr><td><code id="powerEpi_+3A_theta">theta</code></td>
<td>
<p>numeric. postulated hazard ratio </p>
</td></tr>
<tr><td><code id="powerEpi_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the power calculation formula 
derived by Latouche et al. (2004)
for the following Cox proportional hazards regression in the epidemiological
studies:
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, x_2)=h_0(t)\exp(\beta_1 x_1+\beta_2 x_2),</code>
</p>

<p>where the covariate <code class="reqn">X_1</code> is of our interest. The covariate <code class="reqn">X_1</code> should be
a binary variable taking two possible values: zero and one, while the 
covariate <code class="reqn">X_2</code> can be binary or continuous.
</p>
<p>Suppose we want to check if the hazard of <code class="reqn">X_1=1</code> is equal to 
the hazard of <code class="reqn">X_1=0</code> or not. Equivalently, we want to check if 
the hazard ratio of <code class="reqn">X_1=1</code> to <code class="reqn">X_1=0</code> is equal to <code class="reqn">1</code> 
or is equal to <code class="reqn">\exp(\beta_1)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the power
required to detect a hazard ratio as small as <code class="reqn">\exp(\beta_1)=\theta</code> is
</p>
<p style="text-align: center;"><code class="reqn">power=\Phi\left(-z_{1-\alpha/2}+\sqrt{n[\log(\theta)]^2
p (1-p) \psi (1-\rho^2)}\right),</code>
</p>

<p>where <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, <code class="reqn">\psi</code> is the proportion of subjects died of
the disease of interest, and 
</p>
<p style="text-align: center;"><code class="reqn">\rho=corr(X_1, X_2)=(p_1-p_0)\times \sqrt{\frac{q(1-q)}{p(1-p)}},</code>
</p>
 
<p>and
<code class="reqn">p=Pr(X_1=1)</code>, <code class="reqn">q=Pr(X_2=1)</code>, <code class="reqn">p_0=Pr(X_1=1|X_2=0)</code>,
and <code class="reqn">p_1=Pr(X_1=1 | X_2=1)</code>.
</p>
<p><code class="reqn">p</code>, <code class="reqn">\rho^2</code>, and <code class="reqn">\psi</code> will be estimated from a pilot data set.
</p>


<h3>Value</h3>

<table>
<tr><td><code>power</code></td>
<td>
<p>the power of the test.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>proportion of subjects taking <code class="reqn">X_1=1</code>.</p>
</td></tr>
<tr><td><code>rho2</code></td>
<td>
<p>square of the correlation between <code class="reqn">X_1</code> and <code class="reqn">X_2</code>.</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p> proportion of subjects died of the disease of interest. </p>
</td></tr>
</table>


<h3>Note</h3>

 
<p>(1) The formula can be used to calculate
power for a randomized trial study by setting <code>rho2=0</code>.
</p>
<p>(2) When <code class="reqn">\rho^2=0</code>, the formula derived by Latouche et al. (2004)
looks the same as that derived by Schoenfeld (1983). Latouche et al. (2004) pointed out that in this situation, the interpretations are different hence
the two formulae are actually different. In Latouched et al. (2004), the
hazard ratio <code class="reqn">\theta</code> measures the difference of effect of a covariate 
at two different levels on  the subdistribution hazard for a particular failure, 
while in Schoenfeld (1983), the hazard ratio <code class="reqn">\theta</code> measures 
the difference of effect on the cause-specific hazard.
</p>


<h3>References</h3>

 
<p>Schoenfeld DA. (1983).
Sample-size formula for the proportional-hazards regression model.
<em>Biometrics</em>. 39:499-503.
</p>
<p>Latouche A., Porcher R. and Chevret S. (2004).
Sample size formula for proportional hazards modelling of competing risks.
<em>Statistics in Medicine</em>. 23:3263-3274.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+powerEpi.default">powerEpi.default</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # generate a toy pilot data set
  X1 &lt;- c(rep(1, 39), rep(0, 61))
  set.seed(123456)
  X2 &lt;- sample(c(0, 1), 100, replace = TRUE)
  failureFlag &lt;- sample(c(0, 1), 100, prob = c(0.5, 0.5), replace = TRUE)

  powerEpi(X1 = X1, X2 = X2, failureFlag = failureFlag, 
    n = 139, theta = 2, alpha = 0.05)

</code></pre>

<hr>
<h2 id='powerEpi.default'> Power Calculation for Cox Proportional Hazards Regression with Two Covariates for Epidemiological Studies</h2><span id='topic+powerEpi.default'></span>

<h3>Description</h3>

<p>Power calculation for Cox proportional hazards regression with two covariates for epidemiological Studies. The covariate of interest should be a binary variable. The other covariate can be either binary or non-binary. The formula takes
into account competing risks and the correlation between the two covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerEpi.default(n, 
		 theta, 
		 p, 
		 psi, 
		 rho2, 
		 alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerEpi.default_+3A_n">n</code></td>
<td>
<p>integer. total number of subjects </p>
</td></tr>
<tr><td><code id="powerEpi.default_+3A_theta">theta</code></td>
<td>
<p>numeric. postulated hazard ratio </p>
</td></tr>
<tr><td><code id="powerEpi.default_+3A_p">p</code></td>
<td>
<p>numeric. proportion of subjects taking the value one for the covariate of interest. </p>
</td></tr>
<tr><td><code id="powerEpi.default_+3A_psi">psi</code></td>
<td>
<p>numeric. proportion of subjects died of the disease of interest. </p>
</td></tr>
<tr><td><code id="powerEpi.default_+3A_rho2">rho2</code></td>
<td>
<p>numeric. square of the correlation between the covariate of interest and the other covariate. </p>
</td></tr>
<tr><td><code id="powerEpi.default_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the power calculation formula 
derived by Latouche et al. (2004)
for the following Cox proportional hazards regression in the epidemiological
studies:
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, x_2)=h_0(t)\exp(\beta_1 x_1+\beta_2 x_2),</code>
</p>

<p>where the covariate <code class="reqn">X_1</code> is of our interest. The covariate <code class="reqn">X_1</code> should be
a binary variable taking two possible values: zero and one, while the 
covariate <code class="reqn">X_2</code> can be binary or continuous.
</p>
<p>Suppose we want to check if the hazard of <code class="reqn">X_1=1</code> is equal to 
the hazard of <code class="reqn">X_1=0</code> or not. Equivalently, we want to check if 
the hazard ratio of <code class="reqn">X_1=1</code> to <code class="reqn">X_1=0</code> is equal to <code class="reqn">1</code> 
or is equal to <code class="reqn">\exp(\beta_1)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the power
required to detect a hazard ratio as small as <code class="reqn">\exp(\beta_1)=\theta</code> is
</p>
<p style="text-align: center;"><code class="reqn">power=\Phi\left(-z_{1-\alpha/2}+\sqrt{n[\log(\theta)]^2
p (1-p) \psi (1-\rho^2)}\right),</code>
</p>

<p>where  <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, <code class="reqn">\psi</code> is the proportion of subjects died of
the disease of interest, and 
</p>
<p style="text-align: center;"><code class="reqn">\rho=corr(X_1, X_2)=(p_1-p_0)\times \sqrt{\frac{q(1-q)}{p(1-p)}},</code>
</p>
 
<p>and
<code class="reqn">p=Pr(X_1=1)</code>, <code class="reqn">q=Pr(X_2=1)</code>, <code class="reqn">p_0=Pr(X_1=1|X_2=0)</code>,
and <code class="reqn">p_1=Pr(X_1=1 | X_2=1)</code>.
</p>


<h3>Value</h3>

<p>The power of the test.
</p>


<h3>Note</h3>

 
<p>(1) The formula can be used to calculate
power for a randomized trial study by setting <code>rho2=0</code>.
</p>
<p>(2) When <code>rho2=0</code>, the formula derived by Latouche et al. (2004)
looks the same as that derived by Schoenfeld (1983). Latouche et al. (2004) pointed out that in this situation, the interpretations are different hence
the two formulae are actually different. In Latouched et al. (2004), the
hazard ratio <code class="reqn">\theta</code> measures the difference of effect of a covariate 
at two different levels on  the subdistribution hazard for a particular failure, 
while in Schoenfeld (1983), the hazard ratio <code class="reqn">\theta</code> measures 
the difference of effect on the cause-specific hazard.
</p>


<h3>References</h3>

 
<p>Schoenfeld DA. (1983).
Sample-size formula for the proportional-hazards regression model.
<em>Biometrics</em>. 39:499-503.
</p>
<p>Latouche A., Porcher R. and Chevret S. (2004).
Sample size formula for proportional hazards modelling of competing risks.
<em>Statistics in Medicine</em>. 23:3263-3274.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+powerEpi">powerEpi</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Example at the end of Section 5.2 of Latouche et al. (2004)
  # for a cohort study.
  powerEpi.default(n = 139, 
		   theta = 2, 
		   p = 0.39, 
		   psi = 0.505,
                   rho2 = 0.132^2, 
		   alpha = 0.05)

</code></pre>

<hr>
<h2 id='powerEpiCont'> 
Power Calculation for Cox Proportional Hazards Regression with Nonbinary Covariates for Epidemiological Studies
</h2><span id='topic+powerEpiCont'></span>

<h3>Description</h3>

<p>Power calculation for Cox proportional hazards regression with nonbinary covariates for Epidemiological Studies. Some parameters will be estimated based on a pilot data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerEpiCont(formula, 
	     dat, 
	     var.X1, 
	     var.failureFlag, 
	     n, 
	     theta, 
	     alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerEpiCont_+3A_formula">formula</code></td>
<td>
<p> a formula object relating the covariate of interest
to other covariates to calculate the multiple correlation coefficient. The
variables in formula must be in the data frame <code>dat</code>.
</p>
</td></tr>
<tr><td><code id="powerEpiCont_+3A_dat">dat</code></td>
<td>
<p> a <code>nPilot</code> by <code>p</code> data frame representing the pilot 
data set, where <code>nPilot</code> is the number of subjects in the pilot study and
the <code>p</code> (<code class="reqn">&gt;1</code>) columns contains the covariate of interest and other
covariates.
</p>
</td></tr>
<tr><td><code id="powerEpiCont_+3A_var.x1">var.X1</code></td>
<td>
<p>character. name of the column in the data frame <code>dat</code>, indicating the covariate of interest.</p>
</td></tr>
<tr><td><code id="powerEpiCont_+3A_var.failureflag">var.failureFlag</code></td>
<td>
<p>character. name of the column in the data frame <code>dat</code>, indicating if a subject is failure (taking value 1) or alive (taking value 0). 
</p>
</td></tr>
<tr><td><code id="powerEpiCont_+3A_n">n</code></td>
<td>
<p>integer. total number of subjects. </p>
</td></tr>
<tr><td><code id="powerEpiCont_+3A_theta">theta</code></td>
<td>
<p>numeric. postulated hazard ratio. </p>
</td></tr>
<tr><td><code id="powerEpiCont_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the power calculation formula 
derived by Hsieh and Lavori (2000)
for the following Cox proportional hazards regression in the epidemiological
studies: 
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, \boldsymbol{x}_2)=h_0(t)\exp(\beta_1 x_1+\boldsymbol{\beta}_2 
\boldsymbol{x}_2),</code>
</p>

<p>where the covariate <code class="reqn">X_1</code> is a nonbinary variable and 
<code class="reqn">\boldsymbol{X}_2</code> is a vector of other covariates.
</p>
<p>Suppose we want to check if  
the hazard ratio of the main effect <code class="reqn">X_1=1</code> to <code class="reqn">X_1=0</code> is equal to 
<code class="reqn">1</code> or is equal to <code class="reqn">\exp(\beta_1)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the power
required to detect a hazard ratio as small as <code class="reqn">\exp(\beta_1)=\theta</code> is
</p>
<p style="text-align: center;"><code class="reqn">power=\Phi\left(-z_{1-\alpha/2}+\sqrt{n[\log(\theta)]^2 \sigma^2 \psi (1-\rho^2)}\right),</code>
</p>

<p>where <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, <code class="reqn">\sigma^2=Var(X_1)</code>, <code class="reqn">\psi</code> is the proportion of subjects died of
the disease of interest, and <code class="reqn">\rho</code> is the multiple correlation coefficient
of the following linear regression:
</p>
<p style="text-align: center;"><code class="reqn">x_1=b_0+\boldsymbol{b}^T\boldsymbol{x}_2.</code>
</p>
 
<p>That is, <code class="reqn">\rho^2=R^2</code>, where <code class="reqn">R^2</code> is the proportion of variance
explained by the regression of <code class="reqn">X_1</code> on the vector of covriates
<code class="reqn">\boldsymbol{X}_2</code>.
</p>
<p><code class="reqn">rho</code> will be estimated from a pilot study.
</p>


<h3>Value</h3>

<table>
<tr><td><code>power</code></td>
<td>
<p>The power of the test.</p>
</td></tr>
<tr><td><code>rho2</code></td>
<td>
<p>square of the correlation between <code class="reqn">X_1</code> and <code class="reqn">X_2</code>.</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p> variance of the covariate of interest. </p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p> proportion of subjects died of the disease of interest. </p>
</td></tr>
</table>


<h3>Note</h3>

 
<p>(1) Hsieh and Lavori (2000) assumed one-sided test, while this implementation assumed two-sided test.
(2) The formula can be used to calculate
power for a randomized trial study by setting <code>rho2=0</code>.
</p>


<h3>References</h3>

 
<p>Hsieh F.Y. and Lavori P.W. (2000).
Sample-size calculation for the Cox proportional hazards regression model with nonbinary covariates.
<em>Controlled Clinical Trials</em>. 21:552-560.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+powerEpiCont.default">powerEpiCont.default</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # generate a toy pilot data set
  set.seed(123456)
  X1 &lt;- rnorm(100, mean = 0, sd = 0.3126)
  X2 &lt;- sample(c(0, 1), 100, replace = TRUE)
  failureFlag &lt;- sample(c(0, 1), 100, prob = c(0.25, 0.75), replace = TRUE)
  dat &lt;- data.frame(X1 = X1, X2 = X2, failureFlag = failureFlag)

  powerEpiCont(formula = X1 ~ X2, 
	       dat = dat, 
	       var.X1 = "X1", 
	       var.failureFlag = "failureFlag", 
               n = 107, 
	       theta = exp(1), 
	       alpha = 0.05)

</code></pre>

<hr>
<h2 id='powerEpiCont.default'> 
Power Calculation for Cox Proportional Hazards Regression with Nonbinary Covariates for Epidemiological Studies
</h2><span id='topic+powerEpiCont.default'></span>

<h3>Description</h3>

<p>Power calculation for Cox proportional hazards regression with nonbinary covariates for Epidemiological Studies. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerEpiCont.default(n, 
		     theta, 
		     sigma2, 
		     psi, 
		     rho2, 
		     alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerEpiCont.default_+3A_n">n</code></td>
<td>
<p>integer. total number of subjects. </p>
</td></tr>
<tr><td><code id="powerEpiCont.default_+3A_theta">theta</code></td>
<td>
<p>numeric. postulated hazard ratio. </p>
</td></tr>
<tr><td><code id="powerEpiCont.default_+3A_sigma2">sigma2</code></td>
<td>
<p>numeric. variance of the covariate of interest. </p>
</td></tr>
<tr><td><code id="powerEpiCont.default_+3A_psi">psi</code></td>
<td>
<p>numeric. proportion of subjects died of the disease of interest. </p>
</td></tr>
<tr><td><code id="powerEpiCont.default_+3A_rho2">rho2</code></td>
<td>
<p>numeric. square of the multiple correlation coefficient between the covariate of interest and other covariates. </p>
</td></tr>
<tr><td><code id="powerEpiCont.default_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the power calculation formula 
derived by Hsieh and Lavori (2000)
for the following Cox proportional hazards regression in the epidemiological
studies: 
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, \boldsymbol{x}_2)=h_0(t)\exp(\beta_1 x_1+\boldsymbol{\beta}_2 
\boldsymbol{x}_2),</code>
</p>

<p>where the covariate <code class="reqn">X_1</code> is a nonbinary variable and 
<code class="reqn">\boldsymbol{X}_2</code> is a vector of other covariates.
</p>
<p>Suppose we want to check if  
the hazard ratio of the main effect <code class="reqn">X_1=1</code> to <code class="reqn">X_1=0</code> is equal to 
<code class="reqn">1</code> or is equal to <code class="reqn">\exp(\beta_1)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the power
required to detect a hazard ratio as small as <code class="reqn">\exp(\beta_1)=\theta</code> is
</p>
<p style="text-align: center;"><code class="reqn">power=\Phi\left(-z_{1-\alpha/2}+\sqrt{n[\log(\theta)]^2 \sigma^2 \psi (1-\rho^2)}\right),</code>
</p>

<p>where  <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, <code class="reqn">\sigma^2=Var(X_1)</code>, <code class="reqn">\psi</code> is the proportion of subjects died of
the disease of interest, and <code class="reqn">\rho</code> is the multiple correlation coefficient
of the following linear regression:
</p>
<p style="text-align: center;"><code class="reqn">x_1=b_0+\boldsymbol{b}^T\boldsymbol{x}_2.</code>
</p>
 
<p>That is, <code class="reqn">\rho^2=R^2</code>, where <code class="reqn">R^2</code> is the proportion of variance
explained by the regression of <code class="reqn">X_1</code> on the vector of covriates
<code class="reqn">\boldsymbol{X}_2</code>.
</p>


<h3>Value</h3>

<p>The power of the test.
</p>


<h3>Note</h3>

 
<p>(1) Hsieh and Lavori (2000) assumed one-sided test, while this implementation assumed two-sided test.
(2) The formula can be used to calculate
power for a randomized trial study by setting <code>rho2=0</code>.
</p>


<h3>References</h3>

 
<p>Hsieh F.Y. and Lavori P.W. (2000).
Sample-size calculation for the Cox proportional hazards regression model with nonbinary covariates.
<em>Controlled Clinical Trials</em>. 21:552-560.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+powerEpiCont">powerEpiCont</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # example in the EXAMPLE section (page 557) of Hsieh and Lavori (2000).
  # Hsieh and Lavori (2000) assumed one-sided test, 
  # while this implementation assumed two-sided test. 
  # Hence alpha=0.1 here (two-sided test) will correspond
  # to alpha=0.05 of one-sided test in Hsieh and Lavori's (2000) example.
  powerEpiCont.default(n = 107, 
		       theta = exp(1), 
		       sigma2 = 0.3126^2, 
                       psi = 0.738, 
		       rho2 = 0.1837, 
		       alpha = 0.1)

</code></pre>

<hr>
<h2 id='powerEpiInt'> 
Power Calculation Testing Interaction Effect for Cox Proportional Hazards Regression with two covariates for Epidemiological Studies (Both covariates should be binary)
</h2><span id='topic+powerEpiInt'></span>

<h3>Description</h3>

<p>Power calculation testing interaction effect for Cox proportional hazards regression with two covariates for Epidemiological Studies. Both covariates should be  binary variables. The formula takes
into account the correlation between the two covariates.
Some parameters will be estimated based on a pilot study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerEpiInt(X1, 
	    X2, 
	    failureFlag, 
	    n, 
	    theta, 
	    alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerEpiInt_+3A_x1">X1</code></td>
<td>
<p>numeric. a <code>nPilot</code> by 1 vector, where <code>nPilot</code> is the number of subjects 
in the pilot data set. This vector records the values of the covariate of 
interest for the <code>nPilot</code> subjects in the pilot study. <code>X1</code> should 
be binary and take only two possible values: zero and one.
</p>
</td></tr>
<tr><td><code id="powerEpiInt_+3A_x2">X2</code></td>
<td>
<p>numeric. a <code>nPilot</code> by 1 vector, where <code>nPilot</code> is the number of subjects
in the pilot study. This vector records the values of the second covariate 
for the <code>nPilot</code> subjects in the pilot study. 
<code>X2</code> should be binary and take only two possible values: zero and one.
</p>
</td></tr>
<tr><td><code id="powerEpiInt_+3A_failureflag">failureFlag</code></td>
<td>
<p>numeric.a <code>nPilot</code> by 1 vector of indicators indicating if a subject is 
failure (<code>failureFlag=1</code>) or alive (<code>failureFlag=0</code>). 
</p>
</td></tr>
<tr><td><code id="powerEpiInt_+3A_n">n</code></td>
<td>
<p>integer. total number of subjects. </p>
</td></tr>
<tr><td><code id="powerEpiInt_+3A_theta">theta</code></td>
<td>
<p>numeric. postulated hazard ratio. </p>
</td></tr>
<tr><td><code id="powerEpiInt_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the power calculation formula 
derived by Schmoor et al. (2000) for
the following Cox proportional hazards regression in the epidemoilogical
studies: 
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, x_2)=h_0(t)\exp(\beta_1 x_1+\beta_2 x_2 + \gamma (x_1 x_2)),</code>
</p>

<p>where both covariates <code class="reqn">X_1</code> and <code class="reqn">X_2</code> are binary variables.
</p>
<p>Suppose we want to check if  
the hazard ratio of the interaction effect <code class="reqn">X_1 X_2=1</code> to <code class="reqn">X_1 X_2=0</code> is equal to <code class="reqn">1</code> 
or is equal to <code class="reqn">\exp(\gamma)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the power
required to detect a hazard ratio as small as <code class="reqn">\exp(\gamma)=\theta</code> is:
</p>
<p style="text-align: center;"><code class="reqn">power=\Phi\left(-z_{1-\alpha/2}+\sqrt{\frac{n}{\delta}[\log(\theta)]^2 \psi}\right),</code>
</p>

<p>where <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, 
</p>
<p style="text-align: center;"><code class="reqn">\delta=\frac{1}{p_{00}}+\frac{1}{p_{01}}+\frac{1}{p_{10}}
+\frac{1}{p_{11}},</code>
</p>

<p><code class="reqn">\psi</code> is the proportion of subjects died of
the disease of interest, and
<code class="reqn">p_{00}=Pr(X_1=0,\mbox{and}, X_2=0)</code>, 
<code class="reqn">p_{01}=Pr(X_1=0,\mbox{and}, X_2=1)</code>, 
<code class="reqn">p_{10}=Pr(X_1=1,\mbox{and}, X_2=0)</code>, 
<code class="reqn">p_{11}=Pr(X_1=1,\mbox{and}, X_2=1)</code>. 
</p>
<p><code class="reqn">p_{00}</code>, <code class="reqn">p_{01}</code>, <code class="reqn">p_{10}</code>, <code class="reqn">p_{11}</code>, and <code class="reqn">\psi</code> will be
estimated from the pilot data.
</p>


<h3>Value</h3>

<table>
<tr><td><code>power</code></td>
<td>
<p>the power of the test.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>estimated <code class="reqn">Pr(X_1=1)</code></p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>estimated <code class="reqn">Pr(X_2=1)</code></p>
</td></tr>
<tr><td><code>p0</code></td>
<td>
<p>estimated <code class="reqn">Pr(X_1=1 | X_2=0)</code></p>
</td></tr>
<tr><td><code>p1</code></td>
<td>
<p>estimated <code class="reqn">Pr(X_1=1 | X_2=1)</code></p>
</td></tr>
<tr><td><code>rho2</code></td>
<td>
<p>square of the estimated <code class="reqn">corr(X_1, X_2)</code></p>
</td></tr>
<tr><td><code>G</code></td>
<td>
<p>a factor adjusting the sample size. The sample size needed to
detect an effect of a prognostic factor with given error probabilities has
to be multiplied by the factor <code>G</code> when an interaction of the
same magnitude is to be detected.</p>
</td></tr>
<tr><td><code>mya</code></td>
<td>
<p>estimated number of subjects taking values <code class="reqn">X_1=0</code> and 
<code class="reqn">X_2=0</code>.</p>
</td></tr>
<tr><td><code>myb</code></td>
<td>
<p>estimated number of subjects taking values <code class="reqn">X_1=0</code> and 
<code class="reqn">X_2=1</code>.</p>
</td></tr>
<tr><td><code>myc</code></td>
<td>
<p>estimated number of subjects taking values <code class="reqn">X_1=1</code> and 
<code class="reqn">X_2=0</code>.</p>
</td></tr>
<tr><td><code>myd</code></td>
<td>
<p>estimated number of subjects taking values <code class="reqn">X_1=1</code> and 
<code class="reqn">X_2=1</code>.</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p> proportion of subjects died of the disease of interest. </p>
</td></tr>
</table>


<h3>References</h3>

 
<p>Schmoor C., Sauerbrei W., and Schumacher M. (2000).
Sample size considerations for the evaluation of prognostic factors in survival analysis.
<em>Statistics in Medicine</em>. 19:441-452.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+powerEpiInt.default0">powerEpiInt.default0</a></code>, <code><a href="#topic+powerEpiInt2">powerEpiInt2</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # generate a toy pilot data set
  X1 &lt;- c(rep(1, 39), rep(0, 61))
  set.seed(123456)
  X2 &lt;- sample(c(0, 1), 100, replace = TRUE)
  failureFlag &lt;- sample(c(0, 1), 100, prob = c(0.25, 0.75), replace = TRUE)

  powerEpiInt(X1 = X1, 
	      X2 = X2, 
	      failureFlag = failureFlag, 
	      n = 184, 
	      theta = 3, 
	      alpha = 0.05)
  
</code></pre>

<hr>
<h2 id='powerEpiInt.default0'> 
Power Calculation Testing Interaction Effect for Cox Proportional Hazards Regression
</h2><span id='topic+powerEpiInt.default0'></span>

<h3>Description</h3>

<p>Power calculation testing interaction effect for Cox proportional hazards regression with two covariates for Epidemiological Studies. Both covariates should be  binary variables. The formula takes
into account the correlation between the two covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerEpiInt.default0(n, 
		     theta, 
		     p, 
		     psi, 
		     G, 
		     rho2, 
		     alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerEpiInt.default0_+3A_n">n</code></td>
<td>
<p>integer. total number of subjects. </p>
</td></tr>
<tr><td><code id="powerEpiInt.default0_+3A_theta">theta</code></td>
<td>
<p>numeric. postulated hazard ratio. </p>
</td></tr>
<tr><td><code id="powerEpiInt.default0_+3A_p">p</code></td>
<td>
<p>numeric. proportion of subjects taking the value one for the covariate of interest. </p>
</td></tr>
<tr><td><code id="powerEpiInt.default0_+3A_psi">psi</code></td>
<td>
<p>numeric. proportion of subjects died of the disease of interest. </p>
</td></tr>
<tr><td><code id="powerEpiInt.default0_+3A_g">G</code></td>
<td>
<p>numeric. a factor adjusting the sample size. The sample size needed to
detect an effect of a prognostic factor with given error probabilities has
to be multiplied by the factor <code>G</code> when an interaction of the
same magnitude is to be detected.</p>
</td></tr>
<tr><td><code id="powerEpiInt.default0_+3A_rho2">rho2</code></td>
<td>
<p>numeric. square of the correlation between the covariate of interest and the other covariate. </p>
</td></tr>
<tr><td><code id="powerEpiInt.default0_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the power calculation formula 
derived by Schmoor et al. (2000) for
the following Cox proportional hazards regression in the epidemiological
studies: 
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, x_2)=h_0(t)\exp(\beta_1 x_1+\beta_2 x_2 + \gamma (x_1 x_2)),</code>
</p>

<p>where both covariates <code class="reqn">X_1</code> and <code class="reqn">X_2</code> are binary variables.
</p>
<p>Suppose we want to check if  
the hazard ratio of the interaction effect <code class="reqn">X_1 X_2=1</code> to <code class="reqn">X_1 X_2=0</code> is equal to <code class="reqn">1</code> 
or is equal to <code class="reqn">\exp(\gamma)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the power 
required to detect a hazard ratio as small as <code class="reqn">\exp(\gamma)=\theta</code> is
</p>
<p style="text-align: center;"><code class="reqn">power=\Phi\left(-z_{1-\alpha/2}+\sqrt{\frac{n}{G}[\log(\theta)]^2 p (1-p) \psi (1-\rho^2)}\right),</code>
</p>

<p>where <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, <code class="reqn">\psi</code> is the proportion of subjects died of
the disease of interest, and 
</p>
<p style="text-align: center;"><code class="reqn">\rho=corr(X_1, X_2)=(p_1-p_0)\times \sqrt{\frac{q(1-q)}{p(1-p)}},</code>
</p>
 
<p>and
<code class="reqn">p=Pr(X_1=1)</code>, <code class="reqn">q=Pr(X_2=1)</code>, <code class="reqn">p_0=Pr(X_1=1|X_2=0)</code>,
and <code class="reqn">p_1=Pr(X_1=1 | X_2=1)</code>, and
</p>
<p style="text-align: center;"><code class="reqn">G=\frac{[(1-q)(1-p_0)p_0+q(1-p_1)p_1]^2}{(1-q)q (1-p_0)p_0 (1-p_1) p_1}.</code>
</p>

<p>If <code class="reqn">X_1</code> and <code class="reqn">X_2</code> are uncorrelated, we have <code class="reqn">p_0=p_1=p</code>
leading to <code class="reqn">1/[(1-q)q]</code>. For <code class="reqn">q=0.5</code>, we have <code class="reqn">G=4</code>.
</p>


<h3>Value</h3>

<p>The power of the test.
</p>


<h3>References</h3>

 
<p>Schmoor C., Sauerbrei W., and Schumacher M. (2000).
Sample size considerations for the evaluation of prognostic factors in survival analysis.
<em>Statistics in Medicine</em>. 19:441-452.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+powerEpiInt.default1">powerEpiInt.default1</a></code>, <code><a href="#topic+powerEpiInt2">powerEpiInt2</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Example at the end of Section 4 of Schmoor et al. (2000).
  powerEpiInt.default0(n = 184, 
		       theta = 3, 
		       p = 0.61, 
		       psi = 139 / 184, 
                       G = 4.79177, 
		       rho2 = 0.015^2, 
		       alpha = 0.05)
  
</code></pre>

<hr>
<h2 id='powerEpiInt.default1'> 
Power Calculation Testing Interaction Effect for Cox Proportional Hazards Regression
</h2><span id='topic+powerEpiInt.default1'></span>

<h3>Description</h3>

<p>Power calculation testing interaction effect for Cox proportional hazards regression with two covariates for Epidemiological Studies. Both covariates should be  binary variables. The formula takes
into account the correlation between the two covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerEpiInt.default1(n, 
		     theta, 
		     psi, 
		     p00, 
		     p01, 
		     p10, 
		     p11, 
		     alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerEpiInt.default1_+3A_n">n</code></td>
<td>
<p>integer. total number of subjects. </p>
</td></tr>
<tr><td><code id="powerEpiInt.default1_+3A_theta">theta</code></td>
<td>
<p>numeric. postulated hazard ratio. </p>
</td></tr>
<tr><td><code id="powerEpiInt.default1_+3A_psi">psi</code></td>
<td>
<p>numeric. proportion of subjects died of the disease of interest. </p>
</td></tr>
<tr><td><code id="powerEpiInt.default1_+3A_p00">p00</code></td>
<td>
<p>numeric. proportion of subjects taking values <code class="reqn">X_1=0</code> and 
<code class="reqn">X_2=0</code>, i.e., <code class="reqn">p_{00}=Pr(X_1=0,\mbox{and}, X_2=0)</code>.</p>
</td></tr>
<tr><td><code id="powerEpiInt.default1_+3A_p01">p01</code></td>
<td>
<p>numeric. proportion of subjects taking values <code class="reqn">X_1=0</code> and 
<code class="reqn">X_2=1</code>, i.e., <code class="reqn">p_{01}=Pr(X_1=0,\mbox{and}, X_2=1)</code>.</p>
</td></tr>
<tr><td><code id="powerEpiInt.default1_+3A_p10">p10</code></td>
<td>
<p>numeric. proportion of subjects taking values <code class="reqn">X_1=1</code> and 
<code class="reqn">X_2=0</code>, i.e., <code class="reqn">p_{10}=Pr(X_1=1,\mbox{and}, X_2=0)</code>.</p>
</td></tr>
<tr><td><code id="powerEpiInt.default1_+3A_p11">p11</code></td>
<td>
<p>numeric. proportion of subjects taking values <code class="reqn">X_1=1</code> and 
<code class="reqn">X_2=1</code>, i.e., <code class="reqn">p_{11}=Pr(X_1=1,\mbox{and}, X_2=1)</code>.</p>
</td></tr>
<tr><td><code id="powerEpiInt.default1_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the power calculation formula 
derived by Schmoor et al. (2000) for
the following Cox proportional hazards regression in the epidemoilogical
studies: 
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, x_2)=h_0(t)\exp(\beta_1 x_1+\beta_2 x_2 + \gamma (x_1 x_2)),</code>
</p>

<p>where both covariates <code class="reqn">X_1</code> and <code class="reqn">X_2</code> are binary variables.
</p>
<p>Suppose we want to check if  
the hazard ratio of the interaction effect <code class="reqn">X_1 X_2=1</code> to <code class="reqn">X_1 X_2=0</code> is equal to <code class="reqn">1</code> 
or is equal to <code class="reqn">\exp(\gamma)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the power
required to detect a hazard ratio as small as <code class="reqn">\exp(\gamma)=\theta</code> is:
</p>
<p style="text-align: center;"><code class="reqn">power=\Phi\left(-z_{1-\alpha/2}+\sqrt{\frac{n}{\delta}[\log(\theta)]^2 \psi}\right),</code>
</p>

<p>where <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, 
</p>
<p style="text-align: center;"><code class="reqn">\delta=\frac{1}{p_{00}}+\frac{1}{p_{01}}+\frac{1}{p_{10}}
+\frac{1}{p_{11}},</code>
</p>

<p><code class="reqn">\psi</code> is the proportion of subjects died of
the disease of interest, and
<code class="reqn">p_{00}=Pr(X_1=0,\mbox{and}, X_2=0)</code>, 
<code class="reqn">p_{01}=Pr(X_1=0,\mbox{and}, X_2=1)</code>, 
<code class="reqn">p_{10}=Pr(X_1=1,\mbox{and}, X_2=0)</code>, 
<code class="reqn">p_{11}=Pr(X_1=1,\mbox{and}, X_2=1)</code>. 
</p>


<h3>Value</h3>

<p>The power of the test.
</p>


<h3>References</h3>

 
<p>Schmoor C., Sauerbrei W., and Schumacher M. (2000).
Sample size considerations for the evaluation of prognostic factors in survival analysis.
<em>Statistics in Medicine</em>. 19:441-452.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+powerEpiInt.default0">powerEpiInt.default0</a></code>, <code><a href="#topic+powerEpiInt2">powerEpiInt2</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Example at the end of Section 4 of Schmoor et al. (2000).
  # p00, p01, p10, and p11 are calculated based on Table III on page 448
  # of Schmoor et al. (2000).
  powerEpiInt.default1(n = 184, 
		       theta = 3, 
		       psi = 139 / 184,
                       p00 = 50 / 184, 
		       p01 = 21 / 184, 
		       p10 = 78 / 184, 
		       p11 = 35 / 184,
                       alpha = 0.05)
  
</code></pre>

<hr>
<h2 id='powerEpiInt2'> 
Power Calculation Testing Interaction Effect for Cox Proportional Hazards Regression
</h2><span id='topic+powerEpiInt2'></span>

<h3>Description</h3>

<p>Power calculation testing interaction effect for Cox proportional hazards regression with two covariates for Epidemiological Studies. Both covariates should be  binary variables. The formula takes
into account the correlation between the two covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerEpiInt2(n, 
	     theta, 
	     psi, 
	     mya, 
	     myb, 
	     myc, 
	     myd, 
	     alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerEpiInt2_+3A_n">n</code></td>
<td>
<p>integer. total number of subjects. </p>
</td></tr>
<tr><td><code id="powerEpiInt2_+3A_theta">theta</code></td>
<td>
<p>numeric. postulated hazard ratio. </p>
</td></tr>
<tr><td><code id="powerEpiInt2_+3A_psi">psi</code></td>
<td>
<p>numeric. proportion of subjects died of the disease of interest. </p>
</td></tr>
<tr><td><code id="powerEpiInt2_+3A_mya">mya</code></td>
<td>
<p>integer. number of subjects taking values <code class="reqn">X_1=0</code> and 
<code class="reqn">X_2=0</code> obtained from a pilot study.</p>
</td></tr>
<tr><td><code id="powerEpiInt2_+3A_myb">myb</code></td>
<td>
<p>integer. number of subjects taking values <code class="reqn">X_1=0</code> and 
<code class="reqn">X_2=1</code> obtained from a pilot study.</p>
</td></tr>
<tr><td><code id="powerEpiInt2_+3A_myc">myc</code></td>
<td>
<p>integer. number of subjects taking values <code class="reqn">X_1=1</code> and 
<code class="reqn">X_2=0</code> obtained from a pilot study.</p>
</td></tr>
<tr><td><code id="powerEpiInt2_+3A_myd">myd</code></td>
<td>
<p>integer. number of subjects taking values <code class="reqn">X_1=1</code> and 
<code class="reqn">X_2=1</code> obtained from a pilot study.</p>
</td></tr>
<tr><td><code id="powerEpiInt2_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the power calculation formula 
derived by Schmoor et al. (2000) for
the following Cox proportional hazards regression in the epidemiological
studies: 
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, x_2)=h_0(t)\exp(\beta_1 x_1+\beta_2 x_2 + \gamma (x_1 x_2)),</code>
</p>

<p>where both covariates <code class="reqn">X_1</code> and <code class="reqn">X_2</code> are binary variables.
</p>
<p>Suppose we want to check if  
the hazard ratio of the interaction effect <code class="reqn">X_1 X_2=1</code> to <code class="reqn">X_1 X_2=0</code> is equal to <code class="reqn">1</code> 
or is equal to <code class="reqn">\exp(\gamma)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the power
required to detect a hazard ratio as small as <code class="reqn">\exp(\gamma)=\theta</code> is
</p>
<p style="text-align: center;"><code class="reqn">power=\Phi\left(-z_{1-\alpha/2}+\sqrt{\frac{n}{G}[\log(\theta)]^2 p (1-p) \psi (1-\rho^2)}\right),</code>
</p>

<p>where <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, <code class="reqn">\psi</code> is the proportion of subjects died of
the disease of interest, and 
</p>
<p style="text-align: center;"><code class="reqn">\rho=corr(X_1, X_2)=(p_1-p_0)\times\sqrt{\frac{q(1-q)}{p(1-p)}},</code>
</p>
 
<p>and
<code class="reqn">p=Pr(X_1=1)</code>, <code class="reqn">q=Pr(X_2=1)</code>, <code class="reqn">p_0=Pr(X_1=1|X_2=0)</code>,
and <code class="reqn">p_1=Pr(X_1=1 | X_2=1)</code>, and
</p>
<p style="text-align: center;"><code class="reqn">G=\frac{[(1-q)(1-p_0)p_0+q(1-p_1)p_1]^2}{(1-q)q (1-p_0)p_0 (1-p_1) p_1},</code>
</p>

<p>and
<code class="reqn">p0=Pr(X_1=1 | X_2=0)=myc/(mya+myc)</code>,
<code class="reqn">p1=Pr(X_1=1 | X_2=1)=myd/(myb+myd)</code>,
<code class="reqn">p=Pr(X_1=1)=(myc+myd)/n_{obs}</code>,
<code class="reqn">q=Pr(X_2=1)=(myb+myd)/n_{obs}</code>,
<code class="reqn">n_{obs}=mya+myb+myc+myd</code>.
</p>
<p><code class="reqn">p_{00}=Pr(X_1=0,\mbox{and}, X_2=0)</code>, 
<code class="reqn">p_{01}=Pr(X_1=0,\mbox{and}, X_2=1)</code>, 
<code class="reqn">p_{10}=Pr(X_1=1,\mbox{and}, X_2=0)</code>, 
<code class="reqn">p_{11}=Pr(X_1=1,\mbox{and}, X_2=1)</code>. 
</p>


<h3>Value</h3>

<p>The power of the test.
</p>


<h3>References</h3>

 
<p>Schmoor C., Sauerbrei W., and Schumacher M. (2000).
Sample size considerations for the evaluation of prognostic factors in survival analysis.
<em>Statistics in Medicine</em>. 19:441-452.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+powerEpiInt.default0">powerEpiInt.default0</a></code>, <code><a href="#topic+powerEpiInt.default1">powerEpiInt.default1</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Example at the end of Section 4 of Schmoor et al. (2000).
  # mya, myb, myc, and myd are obtained from Table III on page 448
  # of Schmoor et al. (2000).
  powerEpiInt2(n = 184, 
	       theta = 3, 
	       psi = 139 / 184,
               mya = 50, 
	       myb = 21, 
	       myc = 78, 
	       myd = 35, 
	       alpha = 0.05)
  
</code></pre>

<hr>
<h2 id='ssize.stratify'>
Sample size calculation for Survival Analysis with Binary Predictor and Exponential Survival Function
</h2><span id='topic+ssize.stratify'></span>

<h3>Description</h3>

<p>Sample size calculation for survival analysis with binary predictor and exponential survival function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssize.stratify(
    power, 
    timeUnit, 
    gVec, 
    PVec, 
    HR, 
    lambda0Vec, 
    alpha = 0.05, 
    verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssize.stratify_+3A_power">power</code></td>
<td>

<p>numeric. Power of the test.
</p>
</td></tr>
<tr><td><code id="ssize.stratify_+3A_timeunit">timeUnit</code></td>
<td>

<p>numeric. Total study length.
</p>
</td></tr>
<tr><td><code id="ssize.stratify_+3A_gvec">gVec</code></td>
<td>

<p>numeric. m by 1 vector. The s-th element is the proportion of the total sample size for 
the s-th stratum, where m is the number of strata.
</p>
</td></tr>
<tr><td><code id="ssize.stratify_+3A_pvec">PVec</code></td>
<td>

<p>numeric. m by 1 vector. The s-th element is the proportion of subjects in treatment group 1 for the s-th stratum, where m is the number of strata.
</p>
</td></tr>
<tr><td><code id="ssize.stratify_+3A_hr">HR</code></td>
<td>

<p>numeric. Hazard ratio (Ratio of the hazard for treatment group 1 to the hazard for treatment group 0, i.e. reference group).
</p>
</td></tr>
<tr><td><code id="ssize.stratify_+3A_lambda0vec">lambda0Vec</code></td>
<td>

<p>numeric. m by 1 vector. The s-th element is the hazard for treatment group 0 (i.e., reference group) in the s-th stratum.
</p>
</td></tr>
<tr><td><code id="ssize.stratify_+3A_alpha">alpha</code></td>
<td>

<p>numeric. Type I error rate.
</p>
</td></tr>
<tr><td><code id="ssize.stratify_+3A_verbose">verbose</code></td>
<td>

<p>Logical. Indicating if intermediate results will be output or not.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We assume (1) there is only one predictor and no covariates in the survival model 
(exponential survival function); (2) there are <code>m</code> strata; (3) the predictor <code>x</code>
is a binary variable indicating treatment group 1 (<code class="reqn">x=1</code>) or treatment group 0
(<code class="reqn">x=0</code>); (3) the treatment effect is constant over time (proportional hazards);
(4) the hazard ratio is the same in all strata, and (5) the data will be analyzed by 
the stratified log rank test.
</p>
<p>The sample size formula is Formula (1) on page 801 of Palta M and Amini SB (1985):
</p>
<p style="text-align: center;"><code class="reqn">
n=(Z_{\alpha}+Z_{\beta})^2/\mu^2
</code>
</p>
 
<p>where <code class="reqn">\alpha</code> is the Type I error rate,
<code class="reqn">\beta</code> is the Type II error rate (power<code class="reqn">=1-\beta</code>),
<code class="reqn">Z_{\alpha}</code> is the <code class="reqn">100(1-\alpha)</code>-th percentile of standard normal distribution, and
</p>
<p style="text-align: center;"><code class="reqn">
\mu=\log(\delta)\sqrt{ \sum_{s=1}^{m} g_s P_s (1 - P_s) V_s }
</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
V_s=P_s\left[1-\frac{1}{\lambda_{1s}} \left\{
\exp\left[-\lambda_{1s}(T-1)\right]
-\exp(-\lambda_{1s}T)
\right\}
\right]
+(1-P_s)\left[
1-\frac{1}{\lambda_{0s}}
\left\{
\exp\left[-\lambda_{0s}(T-1)\right]
-\exp(-\lambda_{0s}T
\right\}
\right]
</code>
</p>

<p>In the above formulas, <code class="reqn">m</code> is the number of strata,
<code class="reqn">T</code> is the total study length, <code class="reqn">\delta</code> is the hazard ratio,
<code class="reqn">g_s</code> is the proportion of the total sample size in stratum <code class="reqn">s</code>,
<code class="reqn">P_s</code> is the proportion of stratum <code class="reqn">s</code>, which is in treatment group 1,
and <code class="reqn">\lambda_{is}</code> is the hazard for the <code class="reqn">i</code>-th treatment group in 
stratum <code class="reqn">s</code>.
</p>


<h3>Value</h3>

<p>The sample size.
</p>


<h3>References</h3>

<p>Palta M and Amini SB. (1985). 
Consideration of covariates and stratification in sample size determination for survival time studies. 
<em>Journal of Chronic Diseases</em>. 38(9):801-809.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+power.stratify">power.stratify</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# example on page 803 of Palta M and Amini SB. (1985). 
n &lt;- ssize.stratify(
  power = 0.9, 
  timeUnit = 1.25, 
  gVec = c(0.5, 0.5),
  PVec = c(0.5, 0.5), 
  HR = 1 / 1.91, 
  lambda0Vec = c(2.303, 1.139),
  alpha = 0.05, 
  verbose = TRUE
)

</code></pre>

<hr>
<h2 id='ssizeCT'> Sample Size Calculation in the Analysis of Survival Data for Clinical Trials </h2><span id='topic+ssizeCT'></span>

<h3>Description</h3>

<p>Sample size calculation for the Comparison of Survival Curves Between Two Groups under
the Cox Proportional-Hazards Model for clinical trials. Some parameters will be estimated based on a pilot data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssizeCT(formula, 
	dat, 
	power, 
	k, 
	RR, 
	alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssizeCT_+3A_formula">formula</code></td>
<td>
<p> A formula object, e.g. <code>Surv(time, status) ~ x</code>, where 
<code>time</code> is a vector of survival/censoring time, <code>status</code> is a vector of 
censoring indicator, <code>x</code> is the group indicator,
which is a factor object in R and takes only two possible values (<code>C</code> for control group 
and <code>E</code> for experimental group). See also the documentation of the function <code>survfit</code> in the 
library <code>survival</code>.</p>
</td></tr>
<tr><td><code id="ssizeCT_+3A_dat">dat</code></td>
<td>
<p> a data frame representing the pilot data set and containing at least 3 columns: (1) survival/censoring time; (2) censoring indicator;
(3) group indicator which is a factor object in R and takes only two possible values (<code>C</code> for control group 
and <code>E</code> for experimental group). </p>
</td></tr>
<tr><td><code id="ssizeCT_+3A_power">power</code></td>
<td>
<p>numeric. power to detect the magnitude of the hazard ratio as small as that specified by <code>RR</code>.</p>
</td></tr>
<tr><td><code id="ssizeCT_+3A_k">k</code></td>
<td>
<p>numeric. ratio of participants in group E (experimental group) compared to group C (control group).</p>
</td></tr>
<tr><td><code id="ssizeCT_+3A_rr">RR</code></td>
<td>
<p>numeric. postulated hazard ratio. </p>
</td></tr>
<tr><td><code id="ssizeCT_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the sample size calculation method described in Section 14.12 (page 807)
of Rosner (2006). The method was proposed by Freedman (1982).
</p>
<p>The movitation of this function is that some times we do not have information about <code class="reqn">m</code> or <code class="reqn">p_E</code>
and <code class="reqn">p_C</code> available, but we have a pilot data set that can be used to estimate <code class="reqn">p_E</code> and <code class="reqn">p_C</code> hence
<code class="reqn">m</code>, where  <code class="reqn">m=n_E p_E + n_C p_C</code> is the expected total number of events over both groups, <code class="reqn">n_E</code>
and <code class="reqn">n_C</code> are numbers of participants in group E (experimental group) and group C (control group), respectively.
<code class="reqn">p_E</code> is the probability of failure in group E (experimental group) over the maximum time period of the study (t years).  <code class="reqn">p_C</code> is the probability of failure in group C (control group) over the maximum time period of the study 
(t years). 
</p>
<p>Suppose we want to compare the survival curves between an experimental group (<code class="reqn">E</code>) and 
a control group (<code class="reqn">C</code>) in a clinical trial with a maximum follow-up of <code class="reqn">t</code> years. 
The Cox proportional hazards regression model is assumed to have the form:
</p>
<p style="text-align: center;"><code class="reqn">h(t|X_1)=h_0(t)\exp(\beta_1 X_1).</code>
</p>

<p>Let <code class="reqn">n_E</code> be the number of participants in the <code class="reqn">E</code> group
and <code class="reqn">n_C</code> be the number of participants in the <code class="reqn">C</code> group.  
We wish to test the hypothesis <code class="reqn">H0: RR=1</code> versus <code class="reqn">H1: RR</code> not equal to 1, 
where <code class="reqn">RR=\exp(\beta_1)=</code>underlying hazard ratio
for the <code class="reqn">E</code> group versus the <code class="reqn">C</code> group. Let <code class="reqn">RR</code> be the postulated hazard ratio,
<code class="reqn">\alpha</code> be the significance level. Assume that the test is a two-sided test.
If the ratio of participants in group 
E compared to group C <code class="reqn">= n_E/n_C=k</code>, then the number of participants needed in each group to 
achieve a power of <code class="reqn">1-\beta</code> is
</p>
<p style="text-align: center;"><code class="reqn">n_E=\frac{m k}{k p_E + p_C}, n_C=\frac{m}{k p_E + p_C}</code>
</p>
 
<p>where </p>
<p style="text-align: center;"><code class="reqn">m=\frac{1}{k}\left(\frac{k RR + 1}{RR - 1}\right)^2\left(
z_{1-\alpha/2}+z_{1-\beta}
\right)^2,</code>
</p>
 
<p>and <code class="reqn">z_{1-\alpha/2}</code> 
is the <code class="reqn">100 (1-\alpha/2)</code>-th percentile of
the standard normal distribution <code class="reqn">N(0, 1)</code>.
</p>
<p><code class="reqn">p_C</code> and <code class="reqn">p_E</code> can be calculated from the following formulaes:
</p>
<p style="text-align: center;"><code class="reqn">p_C=\sum_{i=1}^{t}D_i, p_E=\sum_{i=1}^{t}E_i,</code>
</p>

<p>where <code class="reqn">D_i=\lambda_i A_i C_i</code>, <code class="reqn">E_i=RR\lambda_i B_i C_i</code>, 
<code class="reqn">A_i=\prod_{j=0}^{i-1}(1-\lambda_j)</code>, <code class="reqn">B_i=\prod_{j=0}^{i-1}(1-RR\lambda_j)</code>, 
<code class="reqn">C_i=\prod_{j=0}^{i-1}(1-\delta_j)</code>.  And
<code class="reqn">\lambda_i</code> is the probability of failure at time <code>i</code> among participants in the 
control group, given that a participant has survived to time <code class="reqn">i-1</code> and is not censored at time <code class="reqn">i-1</code>,
i.e., the approximate hazard time <code class="reqn">i</code> in the control group, <code class="reqn">i=1,...,t</code>; 
<code class="reqn">RRlambda_i</code> is the probability of failure at time <code>i</code> among participants in the 
experimental group, given that a participant has survived to time <code class="reqn">i-1</code> and is not censored at time <code class="reqn">i-1</code>,
i.e., the approximate hazard time <code class="reqn">i</code> in the experimental group, <code class="reqn">i=1,...,t</code>; 
<code class="reqn">delta</code> is the prbability that a participant is censored at time <code class="reqn">i</code> given that he was 
followed up to time <code class="reqn">i</code> and has not failed, <code class="reqn">i=0, 1, ..., t</code>, which is assumed the same in each group. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>mat.lambda</code></td>
<td>
<p>a matrix with 9 columns and <code>nTimes+1</code> rows, where <code>nTimes</code> is the number of
observed time points for the control group in the data set. The 9 columns are 
(1) <code>time</code> - observed time point for the control group; 
(2) <code>lambda</code>;  
(3) <code>RRlambda</code>; 
(4) <code>delta</code>; 
(5) <code>A</code>; 
(6) <code>B</code>; 
(7) <code>C</code>; 
(8) <code>D</code>; 
(9) <code>E</code>. 
Please refer to the Details section for the definitions of elements
of these quantities. See also Table 14.24 on page 809 of Rosner (2006). 
</p>
</td></tr>
<tr><td><code>mat.event</code></td>
<td>
<p>a matrix with 5 columns and <code>nTimes+1</code> rows, where <code>nTimes</code> is the number of
observed time points for control group in the data set. The 5 columns are 
(1) <code>time</code> - observed time point for the control group; 
(2) <code>nEvent.C</code> - number of events in the control group at each time point;
(3) <code>nCensored.C</code> - number of censorings in the control group at each time point;
(4) <code>nSurvive.C</code> - number of alived in the control group at each time point;
(5) <code>nRisk.C</code> - number of participants at risk in the control group at each time point.
Please refer to Table 14.12 on page 787 of Rosner (2006). 
</p>
</td></tr>
<tr><td><code>pC</code></td>
<td>
<p> estimated probability of failure in group C (control group) over the maximum time period of the study (t years). </p>
</td></tr>
<tr><td><code>pE</code></td>
<td>
<p> estimated probability of failure in group E (experimental group) over the maximum time period of the study (t years). </p>
</td></tr>
<tr><td><code>ssize</code></td>
<td>
<p>a two-element vector. The first element is <code class="reqn">n_E</code> and the second 
element is <code class="reqn">n_C</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

 
<p>(1) The estimates of <code class="reqn">RRlambda_i=RR*\lambda_i</code>. That is, <code>RRlambda</code> is not directly estimated based on data
from the experimental group;
(2) The sample size formula assumes that the central-limit theorem is valid and hence is appropriate for large samples.
(3) <code class="reqn">n_E</code> and <code class="reqn">n_C</code> will be rounded up to integers.
</p>


<h3>References</h3>

 
<p>Freedman, L.S. (1982). 
Tables of the number of patients required in clinical trials using the log-rank test. 
<em>Statistics in Medicine</em>. 1: 121-129
</p>
<p>Rosner B. (2006).
<em>Fundamentals of Biostatistics</em>. (6-th edition). Thomson Brooks/Cole.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+ssizeCT.default">ssizeCT.default</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Example 14.42 in Rosner B. Fundamentals of Biostatistics. 
  # (6-th edition). (2006) page 809

  library(survival)

  data(Oph)
  res &lt;- ssizeCT(formula = Surv(times, status) ~ group, 
		 dat = Oph, 
                 power = 0.8, 
		 k = 1, 
		 RR = 0.7, 
		 alpha = 0.05)

  # Table 14.24 on page 809 of Rosner (2006)
  print(round(res$mat.lambda, 4))

  # Table 14.12 on page 787 of Rosner (2006)
  print(round(res$mat.event, 4))

  # the sample size
  print(res$ssize)

</code></pre>

<hr>
<h2 id='ssizeCT.default'> Sample Size Calculation in the Analysis of Survival Data for Clinical Trials </h2><span id='topic+ssizeCT.default'></span>

<h3>Description</h3>

<p>Sample size calculation for the Comparison of Survival Curves Between Two Groups under
the Cox Proportional-Hazards Model for clinical trials. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssizeCT.default(power, 
		k, 
		pE, 
		pC, 
		RR, 
		alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssizeCT.default_+3A_power">power</code></td>
<td>
<p>numeric. power to detect the magnitude of the hazard ratio as small as that specified by <code>RR</code>.</p>
</td></tr>
<tr><td><code id="ssizeCT.default_+3A_k">k</code></td>
<td>
<p>numeric. ratio of participants in group E (experimental group) compared to group C (control group).</p>
</td></tr>
<tr><td><code id="ssizeCT.default_+3A_pe">pE</code></td>
<td>
<p>numeric. probability of failure in group E (experimental group) over the maximum time period of the study (t years). </p>
</td></tr>
<tr><td><code id="ssizeCT.default_+3A_pc">pC</code></td>
<td>
<p>numeric. probability of failure in group C (control group) over the maximum time period of the study (t years). </p>
</td></tr>
<tr><td><code id="ssizeCT.default_+3A_rr">RR</code></td>
<td>
<p>numeric. postulated hazard ratio. </p>
</td></tr>
<tr><td><code id="ssizeCT.default_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the sample size calculation method described in Section 14.12 (page 807)
of Rosner (2006). The method was proposed by Freedman (1982).
</p>
<p>Suppose we want to compare the survival curves between an experimental group (<code class="reqn">E</code>) and 
a control group (<code class="reqn">C</code>) in a clinical trial with a maximum follow-up of <code class="reqn">t</code> years. 
The Cox proportional hazards regression model is assumed to have the form:
</p>
<p style="text-align: center;"><code class="reqn">h(t|X_1)=h_0(t)\exp(\beta_1 X_1).</code>
</p>

<p>Let <code class="reqn">n_E</code> be the number of participants in the <code class="reqn">E</code> group
and <code class="reqn">n_C</code> be the number of participants in the <code class="reqn">C</code> group.  
We wish to test the hypothesis <code class="reqn">H0: RR=1</code> versus <code class="reqn">H1: RR</code> not equal to 1, 
where <code class="reqn">RR=\exp(\beta_1)=</code>underlying hazard ratio
for the <code class="reqn">E</code> group versus the <code class="reqn">C</code> group. Let <code class="reqn">RR</code> be the postulated hazard ratio,
<code class="reqn">\alpha</code> be the significance level. Assume that the test is a two-sided test.
If the ratio of participants in group 
E compared to group C <code class="reqn">= n_E/n_C=k</code>, then the number of participants needed in each group to 
achieve a power of <code class="reqn">1-\beta</code> is
</p>
<p style="text-align: center;"><code class="reqn">n_E=\frac{m k}{k p_E + p_C}, n_C=\frac{m}{k p_E + p_C}</code>
</p>
 
<p>where </p>
<p style="text-align: center;"><code class="reqn">m=\frac{1}{k}\left(\frac{k RR + 1}{RR - 1}\right)^2\left(
z_{1-\alpha/2}+z_{1-\beta}
\right)^2,</code>
</p>
 
<p>and <code class="reqn">z_{1-\alpha/2}</code> 
is the <code class="reqn">100 (1-\alpha/2)</code>-th percentile of
the standard normal distribution <code class="reqn">N(0, 1)</code>.
</p>


<h3>Value</h3>

<p>A two-element vector. The first element is <code class="reqn">n_E</code> and the second 
element is <code class="reqn">n_C</code>.
</p>


<h3>Note</h3>

 
<p>(1) The sample size formula assumes that the central-limit theorem is valid and hence is appropriate for large samples.
(2) <code class="reqn">n_E</code> and <code class="reqn">n_C</code> will be rounded up to integers.
</p>


<h3>References</h3>

 
<p>Freedman, L.S. (1982). 
Tables of the number of patients required in clinical trials using the log-rank test. 
<em>Statistics in Medicine</em>. 1: 121-129
</p>
<p>Rosner B. (2006).
<em>Fundamentals of Biostatistics</em>. (6-th edition). Thomson Brooks/Cole.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+ssizeCT">ssizeCT</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Example 14.42 in Rosner B. Fundamentals of Biostatistics. 
  # (6-th edition). (2006) page 809
  ssizeCT.default(power = 0.8, 
		  k = 1, 
		  pE = 0.3707, 
		  pC = 0.4890, 
                  RR = 0.7, 
		  alpha = 0.05)
</code></pre>

<hr>
<h2 id='ssizeEpi'> Sample Size Calculation for Cox Proportional Hazards Regression</h2><span id='topic+ssizeEpi'></span>

<h3>Description</h3>

<p>Sample size calculation for Cox proportional hazards regression with two covariates for Epidemiological Studies. The covariate of interest should be a binary variable. The other covariate can be either binary or non-binary. The formula takes
into account competing risks and the correlation between the two covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssizeEpi(X1, 
	 X2, 
	 failureFlag, 
	 power, 
	 theta, 
	 alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssizeEpi_+3A_x1">X1</code></td>
<td>
<p>numeric. a <code>nPilot</code> by 1 vector, where <code>nPilot</code> is the number of subjects 
in the pilot data set. This vector records the values of the covariate of 
interest for the <code>nPilot</code> subjects in the pilot study. <code>X1</code> should 
be binary and take only two possible values: zero and one.
</p>
</td></tr>
<tr><td><code id="ssizeEpi_+3A_x2">X2</code></td>
<td>
<p>numeric. a <code>nPilot</code> by 1 vector, where <code>nPilot</code> is the number of subjects
in the pilot study. This vector records the values of the second covariate 
for the <code>nPilot</code> subjects in the pilot study. <code>X2</code> can be binary or 
non-binary.
</p>
</td></tr>
<tr><td><code id="ssizeEpi_+3A_failureflag">failureFlag</code></td>
<td>
<p>numeric. a <code>nPilot</code> by 1 vector of indicators indicating if a subject is 
failure (<code>failureFlag=1</code>) or alive (<code>failureFlag=0</code>). 
</p>
</td></tr>
<tr><td><code id="ssizeEpi_+3A_power">power</code></td>
<td>
<p>numeric. postulated power. </p>
</td></tr>
<tr><td><code id="ssizeEpi_+3A_theta">theta</code></td>
<td>
<p>numeric. postulated hazard ratio. </p>
</td></tr>
<tr><td><code id="ssizeEpi_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the sample size formula 
derived by Latouche et al. (2004)
for the following Cox proportional hazards regression in the epidemiological
studies:
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, x_2)=h_0(t)\exp(\beta_1 x_1+\beta_2 x_2),</code>
</p>

<p>where the covariate <code class="reqn">X_1</code> is of our interest. The covariate <code class="reqn">X_1</code> has to be
a binary variable taking two possible values: zero and one, while the 
covariate <code class="reqn">X_2</code> can be binary or continuous.
</p>
<p>Suppose we want to check if the hazard of <code class="reqn">X_1=1</code> is equal to 
the hazard of <code class="reqn">X_1=0</code> or not. Equivalently, we want to check if 
the hazard ratio of <code class="reqn">X_1=1</code> to <code class="reqn">X_1=0</code> is equal to <code class="reqn">1</code> 
or is equal to <code class="reqn">\exp(\beta_1)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the total 
number of subjects required to achieve a power of <code class="reqn">1-\beta</code> is
</p>
<p style="text-align: center;"><code class="reqn">n=\frac{\left(z_{1-\alpha/2}+z_{1-\beta}\right)^2}{
[\log(\theta)]^2 p (1-p) \psi (1-\rho^2)},</code>
</p>

<p>where <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, <code class="reqn">\psi</code> is the proportion of subjects died of
the disease of interest, and 
</p>
<p style="text-align: center;"><code class="reqn">\rho=corr(X_1, X_2)=(p_1-p_0)\times\sqrt{\frac{q(1-q)}{p(1-p)}},</code>
</p>
 
<p>and
<code class="reqn">p=Pr(X_1=1)</code>, <code class="reqn">q=Pr(X_2=1)</code>, <code class="reqn">p_0=Pr(X_1=1|X_2=0)</code>,
and <code class="reqn">p_1=Pr(X_1=1 | X_2=1)</code>.
</p>
<p><code class="reqn">p</code>, <code class="reqn">\rho^2</code>, and <code class="reqn">\psi</code> will be estimated from a pilot study.
</p>


<h3>Value</h3>

<table>
<tr><td><code>n</code></td>
<td>
<p>the total number of subjects required.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>the proportion that <code class="reqn">X_1</code> takes value one.</p>
</td></tr>
<tr><td><code>rho2</code></td>
<td>
<p>square of the correlation between <code class="reqn">X_1</code> and <code class="reqn">X_2</code>.</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p> proportion of subjects died of the disease of interest. </p>
</td></tr>
</table>


<h3>Note</h3>

 
<p>(1) The calculated sample size will be round up to an integer.  
</p>
<p>(2) The formula can be used to calculate
sample size required for a randomized trial study by setting <code>rho2=0</code>.
</p>
<p>(3) When <code>rho2=0</code>, the formula derived by Latouche et al. (2004)
looks the same as that derived by Schoenfeld (1983). Latouche et al. (2004) pointed out that in this situation, the interpretations are different hence
the two formulae are actually different. In Latouched et al. (2004), the
hazard ratio <code class="reqn">\exp(\beta_1)=\theta</code> measures the difference of effect of a covariate 
at two different levels on  the subdistribution hazard for a particular failure, 
while in Schoenfeld (1983), the hazard ratio <code class="reqn">\theta</code> measures 
the difference of effect on the cause-specific hazard.
</p>


<h3>References</h3>

 
<p>Schoenfeld DA. (1983).
Sample-size formula for the proportional-hazards regression model.
<em>Biometrics</em>. 39:499-503.
</p>
<p>Latouche A., Porcher R. and Chevret S. (2004).
Sample size formula for proportional hazards modelling of competing risks.
<em>Statistics in Medicine</em>. 23:3263-3274.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+ssizeEpi.default">ssizeEpi.default</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # generate a toy pilot data set
  X1 &lt;- c(rep(1, 39), rep(0, 61))
  set.seed(123456)
  X2 &lt;- sample(c(0, 1), 100, replace = TRUE)
  failureFlag &lt;- sample(c(0, 1), 100, prob = c(0.5, 0.5), replace = TRUE)

  ssizeEpi(X1 = X1, 
	   X2 = X2, 
	   failureFlag = failureFlag, 
           power = 0.80, 
	   theta = 2, 
	   alpha = 0.05)
</code></pre>

<hr>
<h2 id='ssizeEpi.default'> Sample Size Calculation for Cox Proportional Hazards Regression</h2><span id='topic+ssizeEpi.default'></span>

<h3>Description</h3>

<p>Sample size calculation for Cox proportional hazards regression with two covariates for Epidemiological Studies. The covariate of interest should be a binary variable. The other covariate can be either binary or non-binary. The formula takes
into account competing risks and the correlation between the two covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssizeEpi.default(power, 
		 theta, 
		 p, 
		 psi, 
		 rho2, 
		 alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssizeEpi.default_+3A_power">power</code></td>
<td>
<p>numeric. postulated power. </p>
</td></tr>
<tr><td><code id="ssizeEpi.default_+3A_theta">theta</code></td>
<td>
<p>numeric. postulated hazard ratio. </p>
</td></tr>
<tr><td><code id="ssizeEpi.default_+3A_p">p</code></td>
<td>
<p>numeric. proportion of subjects taking value one for the covariate of interest. </p>
</td></tr>
<tr><td><code id="ssizeEpi.default_+3A_psi">psi</code></td>
<td>
<p>numeric. proportion of subjects died of the disease of interest. </p>
</td></tr>
<tr><td><code id="ssizeEpi.default_+3A_rho2">rho2</code></td>
<td>
<p>numeric. square of the correlation between the covariate of interest and the other covariate. </p>
</td></tr>
<tr><td><code id="ssizeEpi.default_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the sample size formula 
derived by Latouche et al. (2004)
for the following Cox proportional hazards regression in the epidemiological
studies:
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, x_2)=h_0(t)\exp(\beta_1 x_1+\beta_2 x_2),</code>
</p>

<p>where the covariate <code class="reqn">X_1</code> is of our interest. The covariate <code class="reqn">X_1</code> has to be
a binary variable taking two possible values: zero and one, while the 
covariate <code class="reqn">X_2</code> can be binary or continuous.
</p>
<p>Suppose we want to check if the hazard of <code class="reqn">X_1=1</code> is equal to 
the hazard of <code class="reqn">X_1=0</code> or not. Equivalently, we want to check if 
the hazard ratio of <code class="reqn">X_1=1</code> to <code class="reqn">X_1=0</code> is equal to <code class="reqn">1</code> 
or is equal to <code class="reqn">\exp(\beta_1)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the total 
number of subjects required to achieve a power of <code class="reqn">1-\beta</code> is
</p>
<p style="text-align: center;"><code class="reqn">n=\frac{\left(z_{1-\alpha/2}+z_{1-\beta}\right)^2}{
[\log(\theta)]^2 p (1-p) \psi (1-\rho^2)},</code>
</p>

<p>where <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, <code class="reqn">\psi</code> is the proportion of subjects died of
the disease of interest, and 
</p>
<p style="text-align: center;"><code class="reqn">\rho=corr(X_1, X_2)=(p_1-p_0)\times\sqrt{\frac{q(1-q)}{p(1-p)}},</code>
</p>
 
<p>and
<code class="reqn">p=Pr(X_1=1)</code>, <code class="reqn">q=Pr(X_2=1)</code>, <code class="reqn">p_0=Pr(X_1=1|X_2=0)</code>,
and <code class="reqn">p_1=Pr(X_1=1 | X_2=1)</code>.
</p>


<h3>Value</h3>

<p>The required sample size to achieve the specified power with the given
type I error rate.
</p>


<h3>Note</h3>

 
<p>(1) The calculated sample size will be round up to an integer.  
</p>
<p>(2) The formula can be used to calculate
sample size required for a randomized trial study by setting <code>rho2=0</code>.
</p>
<p>(3) When <code>rho2=0</code>, the formula derived by Latouche et al. (2004)
looks the same as that derived by Schoenfeld (1983). Latouche et al. (2004) pointed out that in this situation, the interpretations are different hence
the two formulae are actually different. In Latouched et al. (2004), the
hazard ratio <code class="reqn">\exp(\beta_1)=\theta</code> measures the difference of effect of a covariate 
at two different levels on  the subdistribution hazard for a particular failure, 
while in Schoenfeld (1983), the hazard ratio <code class="reqn">\theta</code> measures 
the difference of effect on the cause-specific hazard.
</p>


<h3>References</h3>

 
<p>Schoenfeld DA. (1983).
Sample-size formula for the proportional-hazards regression model.
<em>Biometrics</em>. 39:499-503.
</p>
<p>Latouche A., Porcher R. and Chevret S. (2004).
Sample size formula for proportional hazards modelling of competing risks.
<em>Statistics in Medicine</em>. 23:3263-3274.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+ssizeEpi">ssizeEpi</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Examples at the end of Section 5.2 of Latouche et al. (2004)
  # for a cohort study.
  ssizeEpi.default(power = 0.80, 
		   theta = 2, 
		   p = 0.39, 
		   psi = 0.505,
                   rho2 = 0.132^2, 
		   alpha = 0.05)
</code></pre>

<hr>
<h2 id='ssizeEpiCont'> 
Sample Size Calculation for Cox Proportional Hazards Regression with Nonbinary Covariates for Epidemiological Studies
</h2><span id='topic+ssizeEpiCont'></span>

<h3>Description</h3>

<p>Sample size calculation for Cox proportional hazards regression with nonbinary covariates for Epidemiological Studies. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssizeEpiCont(formula, 
	     dat, 
	     var.X1, 
	     var.failureFlag, 
	     power, 
	     theta, 
	     alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssizeEpiCont_+3A_formula">formula</code></td>
<td>
<p> a formula object relating the covariate of interest
to other covariates to calculate the multiple correlation coefficient. The
variables in formula must be in the data frame <code>dat</code>.
</p>
</td></tr>
<tr><td><code id="ssizeEpiCont_+3A_dat">dat</code></td>
<td>
<p> a <code>nPilot</code> by <code>p</code> data frame representing the pilot 
data set, where <code>nPilot</code> is the number of subjects in the pilot study and
the <code>p</code> (<code class="reqn">&gt;1</code>) columns contains the covariate of interest and other
covariates.
</p>
</td></tr>
<tr><td><code id="ssizeEpiCont_+3A_var.x1">var.X1</code></td>
<td>
<p>character. name of the column in the data frame <code>dat</code>, indicating the covariate of interest.</p>
</td></tr>
<tr><td><code id="ssizeEpiCont_+3A_var.failureflag">var.failureFlag</code></td>
<td>
<p>character. name of the column in the data frame <code>dat</code>, indicating if a subject is failure (taking value 1) or alive (taking value 0). 
</p>
</td></tr>
<tr><td><code id="ssizeEpiCont_+3A_power">power</code></td>
<td>
<p>numeric. postulated power. </p>
</td></tr>
<tr><td><code id="ssizeEpiCont_+3A_theta">theta</code></td>
<td>
<p>numeric. postulated hazard ratio. </p>
</td></tr>
<tr><td><code id="ssizeEpiCont_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the sample size calculation formula 
derived by Hsieh and Lavori (2000)
for the following Cox proportional hazards regression in the epidemiological
studies: 
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, \boldsymbol{x}_2)=h_0(t)\exp(\beta_1 x_1+\boldsymbol{\beta}_2 
\boldsymbol{x}_2,</code>
</p>

<p>where the covariate <code class="reqn">X_1</code> is a nonbinary variable and 
<code class="reqn">\boldsymbol{X}_2</code> is a vector of other covariates.
</p>
<p>Suppose we want to check if  
the hazard ratio of the main effect <code class="reqn">X_1=1</code> to <code class="reqn">X_1=0</code> is equal to 
<code class="reqn">1</code> or is equal to <code class="reqn">\exp(\beta_1)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the total 
number of subjects required to achieve a sample size of <code class="reqn">1-\beta</code> is
</p>
<p style="text-align: center;"><code class="reqn">n=\frac{\left(z_{1-\alpha/2}+z_{1-\beta}\right)^2}{
[\log(\theta)]^2 \sigma^2 \psi (1-\rho^2)
},</code>
</p>

<p>where <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, <code class="reqn">\sigma^2=Var(X_1)</code>, <code class="reqn">\psi</code> is the proportion of subjects died of
the disease of interest, and <code class="reqn">\rho</code> is the multiple correlation coefficient
of the following linear regression:
</p>
<p style="text-align: center;"><code class="reqn">x_1=b_0+\boldsymbol{b}^T\boldsymbol{x}_2.</code>
</p>
 
<p>That is, <code class="reqn">\rho^2=R^2</code>, where <code class="reqn">R^2</code> is the proportion of variance
explained by the regression of <code class="reqn">X_1</code> on the vector of covriates
<code class="reqn">\boldsymbol{X}_2</code>.
</p>
<p><code class="reqn">rho^2</code>, <code class="reqn">\sigma^2</code>, and <code class="reqn">\psi</code> will be estimated from a pilot study.
</p>


<h3>Value</h3>

<table>
<tr><td><code>n</code></td>
<td>
<p>the total number of subjects required.</p>
</td></tr>
<tr><td><code>rho2</code></td>
<td>
<p>square of the correlation between <code class="reqn">X_1</code> and <code class="reqn">X_2</code>.</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p> variance of the covariate of interest. </p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p> proportion of subjects died of the disease of interest. </p>
</td></tr>
</table>


<h3>Note</h3>

 
<p>(1) Hsieh and Lavori (2000) assumed one-sided test, while this implementation assumed two-sided test.
(2) The formula can be used to calculate
ssize for a randomized trial study by setting <code>rho2=0</code>.
</p>


<h3>References</h3>

 
<p>Hsieh F.Y. and Lavori P.W. (2000).
Sample-size calculation for the Cox proportional hazards regression model with nonbinary covariates.
<em>Controlled Clinical Trials</em>. 21:552-560.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+ssizeEpiCont.default">ssizeEpiCont.default</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # generate a toy pilot data set
  set.seed(123456)
  X1 &lt;- rnorm(100, mean = 0, sd = 0.3126)
  X2 &lt;- sample(c(0, 1), 100, replace = TRUE)
  failureFlag &lt;- sample(c(0, 1), 100, prob = c(0.25, 0.75), replace = TRUE)
  dat &lt;- data.frame(X1 = X1, X2 = X2, failureFlag = failureFlag)

  ssizeEpiCont(formula = X1 ~ X2, 
	       dat = dat, 
	       var.X1 = "X1", 
	       var.failureFlag = "failureFlag", 
               power = 0.806, 
	       theta = exp(1), 
	       alpha = 0.05)

</code></pre>

<hr>
<h2 id='ssizeEpiCont.default'> 
Sample Size Calculation for Cox Proportional Hazards Regression with Nonbinary Covariates for Epidemiological Studies
</h2><span id='topic+ssizeEpiCont.default'></span>

<h3>Description</h3>

<p>Sample size calculation for Cox proportional hazards regression with nonbinary covariates for Epidemiological Studies. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssizeEpiCont.default(power, 
		     theta, 
		     sigma2, 
		     psi, 
		     rho2, 
		     alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssizeEpiCont.default_+3A_power">power</code></td>
<td>
<p>numeric. postulated power. </p>
</td></tr>
<tr><td><code id="ssizeEpiCont.default_+3A_theta">theta</code></td>
<td>
<p>numeric. postulated hazard ratio. </p>
</td></tr>
<tr><td><code id="ssizeEpiCont.default_+3A_sigma2">sigma2</code></td>
<td>
<p>numeric. variance of the covariate of interest. </p>
</td></tr>
<tr><td><code id="ssizeEpiCont.default_+3A_psi">psi</code></td>
<td>
<p>numeric. proportion of subjects died of the disease of interest. </p>
</td></tr>
<tr><td><code id="ssizeEpiCont.default_+3A_rho2">rho2</code></td>
<td>
<p>numeric. square of the multiple correlation coefficient between the covariate of interest and other covariates. </p>
</td></tr>
<tr><td><code id="ssizeEpiCont.default_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the sample size calculation formula 
derived by Hsieh and Lavori (2000)
for the following Cox proportional hazards regression in the epidemiological
studies: 
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, \boldsymbol{x}_2)=h_0(t)\exp(\beta_1 x_1+\boldsymbol{\beta}_2 
\boldsymbol{x}_2,</code>
</p>

<p>where the covariate <code class="reqn">X_1</code> is a nonbinary variable and 
<code class="reqn">\boldsymbol{X}_2</code> is a vector of other covariates.
</p>
<p>Suppose we want to check if  
the hazard ratio of the main effect <code class="reqn">X_1=1</code> to <code class="reqn">X_1=0</code> is equal to 
<code class="reqn">1</code> or is equal to <code class="reqn">\exp(\beta_1)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the total 
number of subjects required to achieve a sample size of <code class="reqn">1-\beta</code> is
</p>
<p style="text-align: center;"><code class="reqn">n=\frac{\left(z_{1-\alpha/2}+z_{1-\beta}\right)^2}{
[\log(\theta)]^2 \sigma^2 \psi (1-\rho^2)
},</code>
</p>

<p>where <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, <code class="reqn">\sigma^2=Var(X_1)</code>, <code class="reqn">\psi</code> is the proportion of subjects died of
the disease of interest, and <code class="reqn">\rho</code> is the multiple correlation coefficient
of the following linear regression:
</p>
<p style="text-align: center;"><code class="reqn">x_1=b_0+\boldsymbol{b}^T\boldsymbol{x}_2.</code>
</p>
 
<p>That is, <code class="reqn">\rho^2=R^2</code>, where <code class="reqn">R^2</code> is the proportion of variance
explained by the regression of <code class="reqn">X_1</code> on the vector of covriates
<code class="reqn">\boldsymbol{X}_2</code>.
</p>


<h3>Value</h3>

<p>The total number of subjects required.
</p>


<h3>Note</h3>

 
<p>(1) Hsieh and Lavori (2000) assumed one-sided test, while this implementation assumed two-sided test.
(2) The formula can be used to calculate
ssize for a randomized trial study by setting <code>rho2=0</code>.
</p>


<h3>References</h3>

 
<p>Hsieh F.Y. and Lavori P.W. (2000).
Sample-size calculation for the Cox proportional hazards regression model with nonbinary covariates.
<em>Controlled Clinical Trials</em>. 21:552-560.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+ssizeEpiCont">ssizeEpiCont</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # example in the EXAMPLE section (page 557) of Hsieh and Lavori (2000).
  # Hsieh and Lavori (2000) assumed one-sided test, 
  # while this implementation assumed two-sided test. 
  # Hence alpha=0.1 here (two-sided test) will correspond
  # to alpha=0.05 of one-sided test in Hsieh and Lavori's (2000) example.
  ssizeEpiCont.default(power = 0.806, 
		       theta = exp(1), 
		       sigma2 = 0.3126^2, 
                       psi = 0.738, 
		       rho2 = 0.1837, 
		       alpha = 0.1)

</code></pre>

<hr>
<h2 id='ssizeEpiInt'> 
Sample Size Calculation Testing Interaction Effect for Cox Proportional Hazards Regression 
</h2><span id='topic+ssizeEpiInt'></span>

<h3>Description</h3>

<p>Sample size calculation testing interaction effect for Cox proportional hazards regression with two covariates for Epidemiological Studies. Both covariates should be  binary variables. The formula takes
into account the correlation between the two covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssizeEpiInt(X1, 
	    X2, 
	    failureFlag, 
	    power, 
	    theta, 
	    alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssizeEpiInt_+3A_x1">X1</code></td>
<td>
<p>numeric. a <code>nPilot</code> by 1 vector, where <code>nPilot</code> is the number of subjects 
in the pilot data set. This vector records the values of the covariate of 
interest for the <code>nPilot</code> subjects in the pilot study. <code>X1</code> should 
be binary and take only two possible values: zero and one.
</p>
</td></tr>
<tr><td><code id="ssizeEpiInt_+3A_x2">X2</code></td>
<td>
<p>numeric. a <code>nPilot</code> by 1 vector, where <code>nPilot</code> is the number of subjects
in the pilot study. This vector records the values of the second covariate 
for the <code>nPilot</code> subjects in the pilot study. 
<code>X2</code> should be binary and take only two possible values: zero and one.
</p>
</td></tr>
<tr><td><code id="ssizeEpiInt_+3A_failureflag">failureFlag</code></td>
<td>
<p>numeric. a <code>nPilot</code> by 1 vector of indicators indicating if a subject is 
failure (<code>failureFlag=1</code>) or alive (<code>failureFlag=0</code>). 
</p>
</td></tr>
<tr><td><code id="ssizeEpiInt_+3A_power">power</code></td>
<td>
<p>numeric. postulated power. </p>
</td></tr>
<tr><td><code id="ssizeEpiInt_+3A_theta">theta</code></td>
<td>
<p>numeric. postulated hazard ratio. </p>
</td></tr>
<tr><td><code id="ssizeEpiInt_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the sample size calculation formula 
derived by Schmoor et al. (2000) for
the following Cox proportional hazards regression in the epidemoilogical
studies: 
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, x_2)=h_0(t)\exp(\beta_1 x_1+\beta_2 x_2 + \gamma (x_1 x_2)),</code>
</p>

<p>where both covariates <code class="reqn">X_1</code> and <code class="reqn">X_2</code> are binary variables.
</p>
<p>Suppose we want to check if  
the hazard ratio of the interaction effect <code class="reqn">X_1 X_2=1</code> to <code class="reqn">X_1 X_2=0</code> is equal to <code class="reqn">1</code> 
or is equal to <code class="reqn">\exp(\gamma)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the total
number of subjects required to achieve the desired power <code class="reqn">1-\beta</code> is:
</p>
<p style="text-align: center;"><code class="reqn">n=\frac{\left(z_{1-\alpha/2}+z_{1-\beta}\right)^2 G}{
[\log(\theta)]^2 \psi (1-p) p (1-\rho^2)
},</code>
</p>

<p>where <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, <code class="reqn">\psi</code> is the proportion of subjects died of
the disease of interest, and 
</p>
<p style="text-align: center;"><code class="reqn">\rho=corr(X_1, X_2)=(p_1-p_0)\times\sqrt{\frac{q(1-q)}{p(1-p)}},</code>
</p>
 
<p>and
<code class="reqn">p=Pr(X_1=1)</code>, <code class="reqn">q=Pr(X_2=1)</code>, <code class="reqn">p_0=Pr(X_1=1|X_2=0)</code>,
and <code class="reqn">p_1=Pr(X_1=1 | X_2=1)</code>, and
</p>
<p style="text-align: center;"><code class="reqn">G=\frac{[(1-q)(1-p_0)p_0+q(1-p_1)p_1]^2}{(1-q)q (1-p_0)p_0 (1-p_1) p_1},</code>
</p>

<p>and
<code class="reqn">p0=Pr(X_1=1 | X_2=0)=myc/(mya+myc)</code>,
<code class="reqn">p1=Pr(X_1=1 | X_2=1)=myd/(myb+myd)</code>,
<code class="reqn">p=Pr(X_1=1)=(myc+myd)/n</code>,
<code class="reqn">q=Pr(X_2=1)=(myb+myd)/n</code>,
<code class="reqn">n=mya+myb+myc+myd</code>.
</p>
<p><code class="reqn">p_{00}=Pr(X_1=0,\mbox{and}, X_2=0)</code>, 
<code class="reqn">p_{01}=Pr(X_1=0,\mbox{and}, X_2=1)</code>, 
<code class="reqn">p_{10}=Pr(X_1=1,\mbox{and}, X_2=0)</code>, 
<code class="reqn">p_{11}=Pr(X_1=1,\mbox{and}, X_2=1)</code>. 
</p>
<p><code class="reqn">p_{00}</code>, <code class="reqn">p_{01}</code>, <code class="reqn">p_{10}</code>, <code class="reqn">p_{11}</code>, and <code class="reqn">\psi</code> will be
estimated from the pilot data.
</p>


<h3>Value</h3>

<table>
<tr><td><code>n</code></td>
<td>
<p>the total number of subjects required.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>estimated <code class="reqn">Pr(X_1=1)</code></p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>estimated <code class="reqn">Pr(X_2=1)</code></p>
</td></tr>
<tr><td><code>p0</code></td>
<td>
<p>estimated <code class="reqn">Pr(X_1=1 | X_2=0)</code></p>
</td></tr>
<tr><td><code>p1</code></td>
<td>
<p>estimated <code class="reqn">Pr(X_1=1 | X_2=1)</code></p>
</td></tr>
<tr><td><code>rho2</code></td>
<td>
<p>square of the estimated <code class="reqn">corr(X_1, X_2)</code></p>
</td></tr>
<tr><td><code>G</code></td>
<td>
<p>a factor adjusting the sample size. The sample size needed to
detect an effect of a prognostic factor with given error probabilities has
to be multiplied by the factor <code>G</code> when an interaction of the
same magnitude is to be detected.</p>
</td></tr>
<tr><td><code>mya</code></td>
<td>
<p>estimated number of subjects taking values <code class="reqn">X_1=0</code> and 
<code class="reqn">X_2=0</code>.</p>
</td></tr>
<tr><td><code>myb</code></td>
<td>
<p>estimated number of subjects taking values <code class="reqn">X_1=0</code> and 
<code class="reqn">X_2=1</code>.</p>
</td></tr>
<tr><td><code>myc</code></td>
<td>
<p>estimated number of subjects taking values <code class="reqn">X_1=1</code> and 
<code class="reqn">X_2=0</code>.</p>
</td></tr>
<tr><td><code>myd</code></td>
<td>
<p>estimated number of subjects taking values <code class="reqn">X_1=1</code> and 
<code class="reqn">X_2=1</code>.</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p> proportion of subjects died of the disease of interest. </p>
</td></tr>
</table>


<h3>References</h3>

 
<p>Schmoor C., Sauerbrei W., and Schumacher M. (2000).
Sample size considerations for the evaluation of prognostic factors in survival analysis.
<em>Statistics in Medicine</em>. 19:441-452.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+ssizeEpiInt.default0">ssizeEpiInt.default0</a></code>, <code><a href="#topic+ssizeEpiInt2">ssizeEpiInt2</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # generate a toy pilot data set
  X1 &lt;- c(rep(1, 39), rep(0, 61))
  set.seed(123456)
  X2 &lt;- sample(c(0, 1), 100, replace = TRUE)
  failureFlag &lt;- sample(c(0, 1), 100, prob = c(0.25, 0.75), replace = TRUE)

  ssizeEpiInt(X1 = X1, 
	      X2 = X2, 
	      failureFlag = failureFlag, 
	      power = 0.88, 
	      theta = 3, 
	      alpha = 0.05)
  
</code></pre>

<hr>
<h2 id='ssizeEpiInt.default0'> 
Sample Size Calculation Testing Interaction Effect for Cox Proportional Hazards Regression
</h2><span id='topic+ssizeEpiInt.default0'></span>

<h3>Description</h3>

<p>Sample size calculation testing interaction effect for Cox proportional hazards regression with two covariates for Epidemiological Studies. Both covariates should be  binary variables. The formula takes
into account the correlation between the two covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssizeEpiInt.default0(power, 
		     theta, 
		     p, 
		     psi, 
		     G, 
		     rho2, 
		     alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssizeEpiInt.default0_+3A_power">power</code></td>
<td>
<p>numeric. postulated power. </p>
</td></tr>
<tr><td><code id="ssizeEpiInt.default0_+3A_theta">theta</code></td>
<td>
<p>numeric. postulated hazard ratio. </p>
</td></tr>
<tr><td><code id="ssizeEpiInt.default0_+3A_p">p</code></td>
<td>
<p>numeric. proportion of subjects taking value one for the covariate of interest. </p>
</td></tr>
<tr><td><code id="ssizeEpiInt.default0_+3A_psi">psi</code></td>
<td>
<p>numeric. proportion of subjects died of the disease of interest. </p>
</td></tr>
<tr><td><code id="ssizeEpiInt.default0_+3A_g">G</code></td>
<td>
<p>numeric. a factor adjusting the sample size. The sample size needed to
detect an effect of a prognostic factor with given error probabilities has
to be multiplied by the factor <code>G</code> when an interaction of the
same magnitude is to be detected.</p>
</td></tr>
<tr><td><code id="ssizeEpiInt.default0_+3A_rho2">rho2</code></td>
<td>
<p>numeric. square of the correlation between the covariate of interest and the other covariate. </p>
</td></tr>
<tr><td><code id="ssizeEpiInt.default0_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the sample size calculation formula 
derived by Schmoor et al. (2000) for
the following Cox proportional hazards regression in the epidemiological
studies: 
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, x_2)=h_0(t)\exp(\beta_1 x_1+\beta_2 x_2 + \gamma (x_1 x_2)),</code>
</p>

<p>where both covariates <code class="reqn">X_1</code> and <code class="reqn">X_2</code> are binary variables.
</p>
<p>Suppose we want to check if  
the hazard ratio of the interaction effect <code class="reqn">X_1 X_2=1</code> to <code class="reqn">X_1 X_2=0</code> is equal to <code class="reqn">1</code> 
or is equal to <code class="reqn">\exp(\gamma)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the total 
number of subjects required to achieve a power of <code class="reqn">1-\beta</code> is
</p>
<p style="text-align: center;"><code class="reqn">n=\frac{\left(z_{1-\alpha/2}+z_{1-\beta}\right)^2 G}{
[\log(\theta)]^2 \psi (1-p) p (1-\rho^2)
},</code>
</p>

<p>where <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, <code class="reqn">\psi</code> is the proportion of subjects died of
the disease of interest, and 
</p>
<p style="text-align: center;"><code class="reqn">\rho=corr(X_1, X_2)=(p_1-p_0)\times\sqrt{\frac{q(1-q)}{p(1-p)}},</code>
</p>
 
<p>and
<code class="reqn">p=Pr(X_1=1)</code>, <code class="reqn">q=Pr(X_2=1)</code>, <code class="reqn">p_0=Pr(X_1=1|X_2=0)</code>,
and <code class="reqn">p_1=Pr(X_1=1 | X_2=1)</code>, and
</p>
<p style="text-align: center;"><code class="reqn">G=\frac{[(1-q)(1-p_0)p_0+q(1-p_1)p_1]^2}{(1-q)q (1-p_0)p_0 (1-p_1) p_1}</code>
</p>
<p>.
</p>
<p>If <code class="reqn">X_1</code> and <code class="reqn">X_2</code> are uncorrelated, we have <code class="reqn">p_0=p_1=p</code>
leading to <code class="reqn">1/[(1-q)q]</code>. For <code class="reqn">q=0.5</code>, we have <code class="reqn">G=4</code>.
</p>


<h3>Value</h3>

<p>The total number of subjects required.
</p>


<h3>References</h3>

 
<p>Schmoor C., Sauerbrei W., and Schumacher M. (2000).
Sample size considerations for the evaluation of prognostic factors in survival analysis.
<em>Statistics in Medicine</em>. 19:441-452.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+ssizeEpiInt.default1">ssizeEpiInt.default1</a></code>, <code><a href="#topic+ssizeEpiInt2">ssizeEpiInt2</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Example at the end of Section 4 of Schmoor et al. (2000).
  ssizeEpiInt.default0(power = 0.8227, 
		       theta = 3, 
		       p = 0.61, 
		       psi = 139 / 184, 
                       G = 4.79177, 
		       rho2 = 0.015^2, 
		       alpha = 0.05)
  
</code></pre>

<hr>
<h2 id='ssizeEpiInt.default1'> 
Sample Size Calculation Testing Interaction Effect for Cox Proportional Hazards Regression
</h2><span id='topic+ssizeEpiInt.default1'></span>

<h3>Description</h3>

<p>Sample size calculation testing interaction effect for Cox proportional hazards regression with two covariates for Epidemiological Studies. Both covariates should be  binary variables. The formula takes
into account the correlation between the two covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssizeEpiInt.default1(power, 
		     theta, 
		     psi, 
		     p00, 
		     p01, 
		     p10, 
		     p11, 
		     alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssizeEpiInt.default1_+3A_power">power</code></td>
<td>
<p>numeric. postulated power. </p>
</td></tr>
<tr><td><code id="ssizeEpiInt.default1_+3A_theta">theta</code></td>
<td>
<p>numeric. postulated hazard ratio. </p>
</td></tr>
<tr><td><code id="ssizeEpiInt.default1_+3A_psi">psi</code></td>
<td>
<p>numeric. proportion of subjects died of the disease of interest. </p>
</td></tr>
<tr><td><code id="ssizeEpiInt.default1_+3A_p00">p00</code></td>
<td>
<p>numeric. proportion of subjects taking values <code class="reqn">X_1=0</code> and 
<code class="reqn">X_2=0</code>, i.e., <code class="reqn">p_{00}=Pr(X_1=0,\mbox{and}, X_2=0)</code>.</p>
</td></tr>
<tr><td><code id="ssizeEpiInt.default1_+3A_p01">p01</code></td>
<td>
<p>numeric. proportion of subjects taking values <code class="reqn">X_1=0</code> and 
<code class="reqn">X_2=1</code>, i.e., <code class="reqn">p_{01}=Pr(X_1=0,\mbox{and}, X_2=1)</code>.</p>
</td></tr>
<tr><td><code id="ssizeEpiInt.default1_+3A_p10">p10</code></td>
<td>
<p>numeric. proportion of subjects taking values <code class="reqn">X_1=1</code> and 
<code class="reqn">X_2=0</code>, i.e., <code class="reqn">p_{10}=Pr(X_1=1,\mbox{and}, X_2=0)</code>.</p>
</td></tr>
<tr><td><code id="ssizeEpiInt.default1_+3A_p11">p11</code></td>
<td>
<p>numeric. proportion of subjects taking values <code class="reqn">X_1=1</code> and 
<code class="reqn">X_2=1</code>, i.e., <code class="reqn">p_{11}=Pr(X_1=1,\mbox{and}, X_2=1)</code>.</p>
</td></tr>
<tr><td><code id="ssizeEpiInt.default1_+3A_alpha">alpha</code></td>
<td>
<p> type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the sample size calculation formula 
derived by Schmoor et al. (2000) for
the following Cox proportional hazards regression in the epidemoilogical
studies: 
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, x_2)=h_0(t)\exp(\beta_1 x_1+\beta_2 x_2 + \gamma (x_1 x_2)),</code>
</p>

<p>where both covariates <code class="reqn">X_1</code> and <code class="reqn">X_2</code> are binary variables.
</p>
<p>Suppose we want to check if  
the hazard ratio of the interaction effect <code class="reqn">X_1 X_2=1</code> to <code class="reqn">X_1 X_2=0</code> is equal to <code class="reqn">1</code> 
or is equal to <code class="reqn">\exp(\gamma)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the total 
number of subjects required to achieve a power of <code class="reqn">1-\beta</code> is
</p>
<p style="text-align: center;"><code class="reqn">n=\frac{\left(z_{1-\alpha/2}+z_{1-\beta}\right)^2\delta}{[\log(\theta)]^2 \psi},</code>
</p>

<p>where <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, 
<code class="reqn">\psi</code> is the proportion of subjects died of
the disease of interest, 
</p>
<p style="text-align: center;"><code class="reqn">\delta=\frac{1}{p_{00}}+\frac{1}{p_{01}}+\frac{1}{p_{10}}
+\frac{1}{p_{11}},</code>
</p>

<p>and
<code class="reqn">p_{00}=Pr(X_1=0,\mbox{and}, X_2=0)</code>, 
<code class="reqn">p_{01}=Pr(X_1=0,\mbox{and}, X_2=1)</code>, 
<code class="reqn">p_{10}=Pr(X_1=1,\mbox{and}, X_2=0)</code>, 
<code class="reqn">p_{11}=Pr(X_1=1,\mbox{and}, X_2=1)</code>. 
</p>


<h3>Value</h3>

<p>The ssize of the test.
</p>


<h3>References</h3>

 
<p>Schmoor C., Sauerbrei W., and Schumacher M. (2000).
Sample size considerations for the evaluation of prognostic factors in survival analysis.
<em>Statistics in Medicine</em>. 19:441-452.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+ssizeEpiInt.default0">ssizeEpiInt.default0</a></code>, <code><a href="#topic+ssizeEpiInt2">ssizeEpiInt2</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Example at the end of Section 4 of Schmoor et al. (2000).
  # p00, p01, p10, and p11 are calculated based on Table III on page 448
  # of Schmoor et al. (2000).
  ssizeEpiInt.default1(power = 0.8227, 
		       theta = 3, 
		       psi = 139 / 184,
                       p00 = 50/184, 
		       p01 = 21 / 184, 
		       p10 = 78 / 184, 
		       p11 = 35 / 184,
                       alpha = 0.05)
  
</code></pre>

<hr>
<h2 id='ssizeEpiInt2'> 
Sample Size Calculation Testing Interaction Effect for Cox Proportional Hazards Regression
</h2><span id='topic+ssizeEpiInt2'></span>

<h3>Description</h3>

<p>Sample size calculation testing interaction effect for Cox proportional hazards regression with two covariates for Epidemiological Studies. Both covariates should be  binary variables. The formula takes
into account the correlation between the two covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssizeEpiInt2(power, 
	     theta, 
	     psi, 
	     mya, 
	     myb, 
	     myc, 
	     myd, 
	     alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssizeEpiInt2_+3A_power">power</code></td>
<td>
<p>numeric. postulated power. </p>
</td></tr>
<tr><td><code id="ssizeEpiInt2_+3A_theta">theta</code></td>
<td>
<p>numeric. postulated hazard ratio. </p>
</td></tr>
<tr><td><code id="ssizeEpiInt2_+3A_psi">psi</code></td>
<td>
<p>numeric. proportion of subjects died of the disease of interest. </p>
</td></tr>
<tr><td><code id="ssizeEpiInt2_+3A_mya">mya</code></td>
<td>
<p>integer. number of subjects taking values <code class="reqn">X_1=0</code> and 
<code class="reqn">X_2=0</code> from the pilot study.</p>
</td></tr>
<tr><td><code id="ssizeEpiInt2_+3A_myb">myb</code></td>
<td>
<p>integer. number of subjects taking values <code class="reqn">X_1=0</code> and 
<code class="reqn">X_2=1</code> from the pilot study.</p>
</td></tr>
<tr><td><code id="ssizeEpiInt2_+3A_myc">myc</code></td>
<td>
<p>integer. number of subjects taking values <code class="reqn">X_1=1</code> and 
<code class="reqn">X_2=0</code> from the pilot study.</p>
</td></tr>
<tr><td><code id="ssizeEpiInt2_+3A_myd">myd</code></td>
<td>
<p>integer. number of subjects taking values <code class="reqn">X_1=1</code> and 
<code class="reqn">X_2=1</code> from the pilot study.</p>
</td></tr>
<tr><td><code id="ssizeEpiInt2_+3A_alpha">alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of the sample size calculation formula 
derived by Schmoor et al. (2000) for
the following Cox proportional hazards regression in the epidemiological
studies: 
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, x_2)=h_0(t)\exp(\beta_1 x_1+\beta_2 x_2 + \gamma (x_1 x_2)),</code>
</p>

<p>where both covariates <code class="reqn">X_1</code> and <code class="reqn">X_2</code> are binary variables.
</p>
<p>Suppose we want to check if  
the hazard ratio of the interaction effect <code class="reqn">X_1 X_2=1</code> to <code class="reqn">X_1 X_2=0</code> is equal to <code class="reqn">1</code> 
or is equal to <code class="reqn">\exp(\gamma)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the total 
number of subjects required to achieve a power of <code class="reqn">1-\beta</code> is
</p>
<p style="text-align: center;"><code class="reqn">n=\frac{\left(z_{1-\alpha/2}+z_{1-\beta}\right)^2 G}{
[\log(\theta)]^2 \psi (1-p) p (1-\rho^2)
},</code>
</p>

<p>where <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, <code class="reqn">\psi</code> is the proportion of subjects died of
the disease of interest, and 
</p>
<p style="text-align: center;"><code class="reqn">\rho=corr(X_1, X_2)=(p_1-p_0)\times\sqrt{\frac{q(1-q)}{p(1-p)}},</code>
</p>
 
<p>and
<code class="reqn">p=Pr(X_1=1)</code>, <code class="reqn">q=Pr(X_2=1)</code>, <code class="reqn">p_0=Pr(X_1=1|X_2=0)</code>,
and <code class="reqn">p_1=Pr(X_1=1 | X_2=1)</code>, and
</p>
<p style="text-align: center;"><code class="reqn">G=\frac{[(1-q)(1-p_0)p_0+q(1-p_1)p_1]^2}{(1-q)q (1-p_0)p_0 (1-p_1) p_1},</code>
</p>

<p>and
<code class="reqn">p0=Pr(X_1=1 | X_2=0)=myc/(mya+myc)</code>,
<code class="reqn">p1=Pr(X_1=1 | X_2=1)=myd/(myb+myd)</code>,
<code class="reqn">p=Pr(X_1=1)=(myc+myd)/n</code>,
<code class="reqn">q=Pr(X_2=1)=(myb+myd)/n</code>,
<code class="reqn">n=mya+myb+myc+myd</code>.
</p>
<p><code class="reqn">p_{00}=Pr(X_1=0,\mbox{and}, X_2=0)</code>, 
<code class="reqn">p_{01}=Pr(X_1=0,\mbox{and}, X_2=1)</code>, 
<code class="reqn">p_{10}=Pr(X_1=1,\mbox{and}, X_2=0)</code>, 
<code class="reqn">p_{11}=Pr(X_1=1,\mbox{and}, X_2=1)</code>. 
</p>


<h3>Value</h3>

<p>The total number of subjects required.
</p>


<h3>References</h3>

 
<p>Schmoor C., Sauerbrei W., and Schumacher M. (2000).
Sample size considerations for the evaluation of prognostic factors in survival analysis.
<em>Statistics in Medicine</em>. 19:441-452.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+ssizeEpiInt.default0">ssizeEpiInt.default0</a></code>, <code><a href="#topic+ssizeEpiInt.default1">ssizeEpiInt.default1</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Example at the end of Section 4 of Schmoor et al. (2000).
  # mya, myb, myc, and myd are obtained from Table III on page 448
  # of Schmoor et al. (2000).
  ssizeEpiInt2(power = 0.8227, 
	       theta = 3, 
	       psi = 139 / 184,
               mya = 50, 
	       myb = 21, 
	       myc = 78, 
	       myd = 35, 
	       alpha = 0.05)
  
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
