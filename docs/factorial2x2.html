<!DOCTYPE html><html lang="en"><head><title>Help for package factorial2x2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {factorial2x2}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cor2x2'><p>Hazard ratios and correlations for the 2x2 statistics</p></a></li>
<li><a href='#crit2x2'><p>Critical values for the Equal Allocation 3, Proportional Allocation 2,</p>
and Equal Allocation 2 procedures</a></li>
<li><a href='#eventProb'><p>Calculate event probabilities</p></a></li>
<li><a href='#fac2x2analyze'><p>Significance testing for the Proportional Allocation 2, Equal Allocation 3,</p>
Equal Allocation 2 procedures</a></li>
<li><a href='#fac2x2design'><p>Power for the Equal Allocation 3, Proportional Allocation 2, and</p>
Equal Allocation 2 procedures.</a></li>
<li><a href='#lgrkPower'><p>Unstratified (ordinary) logrank power</p></a></li>
<li><a href='#powerEA2'><p>Power of the Equal Allocation 2 procedure</p></a></li>
<li><a href='#powerEA3'><p>Power of the Equal Allocation 3 procedure</p></a></li>
<li><a href='#powerPA2'><p>Power of the Proportional Allocation 2 procedure</p></a></li>
<li><a href='#roundDown'><p>Round down a negative number</p></a></li>
<li><a href='#simdat'><p>Simulated 2x2 factorial trial data</p></a></li>
<li><a href='#simdata'><p>Simulated 2x2 factorial trial data</p></a></li>
<li><a href='#simdataSub'><p>Simulated 2x2 factorial trial data</p></a></li>
<li><a href='#strLgrkPower'><p>Stratified (overall) logrank power</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Design and Analysis of a 2x2 Factorial Trial</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Eric Leifer and James Troendle   </td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Eric Leifer &lt;Eric.Leifer@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Used for the design and analysis of a 2x2 factorial trial for
    a time-to-event endpoint.  It performs power calculations and significance
    testing as well as providing estimates of the relevant hazard ratios and the 
    corresponding 95% confidence intervals.  Important reference papers include
    Slud EV. (1994) <a href="https://www.ncbi.nlm.nih.gov/pubmed/8086609">https://www.ncbi.nlm.nih.gov/pubmed/8086609</a>
    Lin DY, Gong J, Gallo P, Bunn PH, Couper D. (2016) &lt;<a href="https://doi.org/10.1111%2Fbiom.12507">doi:10.1111/biom.12507</a>&gt;
    Leifer ES, Troendle JF, Kolecki A, Follmann DA. (2020)
    <a href="https://github.com/EricSLeifer/factorial2x2/blob/master/Leifer%20et%20al.%20paper.pdf">https://github.com/EricSLeifer/factorial2x2/blob/master/Leifer%20et%20al.%20paper.pdf</a>.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0), survival, stats, mvtnorm</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-04-27 15:12:19 UTC; leifere</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-04-27 15:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cor2x2'>Hazard ratios and correlations for the 2x2 statistics</h2><span id='topic+cor2x2'></span>

<h3>Description</h3>

<p>Computes  the hazard ratios, confidence intervals, p-values, and correlations
for the overall A, simple A, and simple AB logrank statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cor2x2(time, event, indA, indB, covmat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cor2x2_+3A_time">time</code></td>
<td>
<p>follow-up times</p>
</td></tr>
<tr><td><code id="cor2x2_+3A_event">event</code></td>
<td>
<p>event indicators (0/1)</p>
</td></tr>
<tr><td><code id="cor2x2_+3A_inda">indA</code></td>
<td>
<p>treatment A indicators (0/1)</p>
</td></tr>
<tr><td><code id="cor2x2_+3A_indb">indB</code></td>
<td>
<p>treatment B indicators (0/1)</p>
</td></tr>
<tr><td><code id="cor2x2_+3A_covmat">covmat</code></td>
<td>
<p>matrix of covariates; one row per subject.  NOTE!! Factor variables must
use 0/1 indicator variables</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes
(i) correlation between the overall A test and the simple A test
(ii) correlation between the overall A test and the simple AB test
(iii) correaltion between the simple A and simple AB test.
The correlation estimates are derived in
Lin, Gong, Gallo, et al. (Biometrics 2016).
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>loghrA</code></td>
<td>
<p>overall A log hazard ratio</p>
</td></tr>
<tr><td><code>seA</code></td>
<td>
<p>standard error of the overall A log hazard ratio</p>
</td></tr>
<tr><td><code>hrA</code></td>
<td>
<p>overall A hazard ratio</p>
</td></tr>
<tr><td><code>ciA</code></td>
<td>
<p>95% confidence interval for overall A hazard ratio</p>
</td></tr>
<tr><td><code>pvalA</code></td>
<td>
<p>two-sided p-value for overall A hazard ratio</p>
</td></tr>
<tr><td><code>loghra</code></td>
<td>
<p>simple A log hazard ratio</p>
</td></tr>
<tr><td><code>sea</code></td>
<td>
<p>standard error of the simple A log hazard ratio</p>
</td></tr>
<tr><td><code>hra</code></td>
<td>
<p>simple A hazard ratio</p>
</td></tr>
<tr><td><code>cia</code></td>
<td>
<p>95% confidence interval for simple A hazard ratio</p>
</td></tr>
<tr><td><code>pvala</code></td>
<td>
<p>two-sided p-value for simple A hazard ratio</p>
</td></tr>
<tr><td><code>loghrab</code></td>
<td>
<p>simple AB log hazard ratio</p>
</td></tr>
<tr><td><code>seab</code></td>
<td>
<p>standard error of the simple AB log hazard ratio</p>
</td></tr>
<tr><td><code>hrab</code></td>
<td>
<p>simple AB hazard ratio</p>
</td></tr>
<tr><td><code>ciab</code></td>
<td>
<p>95% confidence interval for simple AB hazard ratio</p>
</td></tr>
<tr><td><code>pvalab</code></td>
<td>
<p>two-sided p-value for simple AB hazard ratio</p>
</td></tr>
<tr><td><code>corAa</code></td>
<td>
<p>correlation between the overall A and simple A test statistics</p>
</td></tr>
<tr><td><code>corAab</code></td>
<td>
<p>correlation between the overall A and simple AB test statistics</p>
</td></tr>
<tr><td><code>coraab</code></td>
<td>
<p>correlation between the simple A and simple AB test statistics</p>
</td></tr>
</table>


<h3>References</h3>

<p>Lin, D.Y., Glong , J., Gallo, P., Bunn, P.H., Couper, D.
Simultaneous inference on treatment effects in survival studies
with factorial designs. Biometrics, 2016; 72: 1078-1085.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># First load the simulated data variables. The "simdat" file is
# a 100-by-9 matrix which is loaded with the factorial2x2 package.
time &lt;- simdat[, "time"]
event &lt;- simdat[, "event"]
indA &lt;- simdat[, "indA"]
indB &lt;- simdat[, "indB"]
covmat &lt;- simdat[, 6:10]

cor2x2(time, event, indA, indB, covmat)
# $loghrA
# [1] 0.05613844

# $seA
# [1] 0.4531521

# $hrA
# [1] 1.057744

# $ciA
# [1] 0.4351608 2.5710556

# $pvalA
# [1] 0.9014069

# $loghra
# [1] 0.1987329

# $sea
# [1] 0.6805458

# $hra
# [1] 1.219856

# $cia
# [1] 0.3213781 4.6302116

# $pvala
# [1] 0.7702714

# $loghrab
# [1] 0.2864932

# $seab
# [1] 0.6762458

# $hrab
# [1] 1.331749

# $ciab
# [1] 0.3538265 5.0125010

# $pvalab
# [1] 0.6718193

# $corAa
# [1] 0.6123399

# $corAab
# [1] 0.5675396

# $coraab
# [1] 0.4642737
</code></pre>

<hr>
<h2 id='crit2x2'>Critical values for the Equal Allocation 3, Proportional Allocation 2,
and Equal Allocation 2 procedures</h2><span id='topic+crit2x2'></span>

<h3>Description</h3>

<p>Computes  the critical values
for null hypotheses rejection and corresponding nominal two-sided significance
levels for the Equal Allocation 3, Proportional Allocation 2,
and Equal Allocation 2 procedures
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crit2x2(
  corAa,
  corAab,
  coraab,
  dig = 2,
  alpha = 0.05,
  niter = 5,
  abseps = 1e-05,
  tol = 1e-04
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crit2x2_+3A_coraa">corAa</code></td>
<td>
<p>correlation between the overall A and simple A log hazard ratio estimates</p>
</td></tr>
<tr><td><code id="crit2x2_+3A_coraab">corAab</code></td>
<td>
<p>correlation between the overall A and simple AB log hazard ratio estimates</p>
</td></tr>
<tr><td><code id="crit2x2_+3A_coraab">coraab</code></td>
<td>
<p>correlation between the simple A and simple AB log hazard ratio estimates</p>
</td></tr>
<tr><td><code id="crit2x2_+3A_dig">dig</code></td>
<td>
<p>number of decimal places to which we <code><a href="#topic+roundDown">roundDown</a></code> the critical value</p>
</td></tr>
<tr><td><code id="crit2x2_+3A_alpha">alpha</code></td>
<td>
<p>two-sided familywise error level to control</p>
</td></tr>
<tr><td><code id="crit2x2_+3A_niter">niter</code></td>
<td>
<p>number of times we compute the critical values to average out
the randomness from the <code>pmvnorm</code> function call</p>
</td></tr>
<tr><td><code id="crit2x2_+3A_abseps">abseps</code></td>
<td>
<p><code>abseps</code> setting in the <code>pmvnorm</code> function call</p>
</td></tr>
<tr><td><code id="crit2x2_+3A_tol">tol</code></td>
<td>
<p><code>tol</code> setting in the uniroot function call</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the Dunnett-corrected critical values
based on the asymptotic correlations of the overall A, simple A, and simple AB
logrank statistics as described in Leifer, Troendle, et al. (2020) and are derived in
Lin, Gong, et al. (2016) and Slud (1994).  <code>pmvnorm</code> uses a random seed in its algorithm.
To smooth out the randomness,  <code>pmvnorm</code> is called <code>niter</code> times.
The <code>roundDown</code> function is used in conjunction with the <code>dig</code> argument
to insure that any rounding of the (negative) critical values will be done conservatively to control
the familywise type I error at the desired level.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>critEA3</code></td>
<td>
<p>Equal Allocation 3 procedure's critical value for all three test statistics</p>
</td></tr>
<tr><td><code>sigEA3</code></td>
<td>
<p>two-sided nominal significance level corresponding to <code>critEA3</code></p>
</td></tr>
<tr><td><code>critPA2A</code></td>
<td>
<p>Proportional Allocation 2 procedure's critical value for the overall A statistic</p>
</td></tr>
<tr><td><code>sigPA2A</code></td>
<td>
<p>two-sided nominal significance level corresponding to <code>critPA2A</code></p>
</td></tr>
<tr><td><code>critPA2ab</code></td>
<td>
<p>Proportional Allocation 2 procedure's critical value for the simple AB statistic</p>
</td></tr>
<tr><td><code>sigPA2ab</code></td>
<td>
<p>two-sided nominal significance level corresponding to <code>critPA2ab</code></p>
</td></tr>
<tr><td><code>critEA2</code></td>
<td>
<p>Equal Allocation 2 procedure's critical value for the simple A and AB statistics</p>
</td></tr>
<tr><td><code>sigEA2</code></td>
<td>
<p>two-sided nominal significance level corresponding to <code>critEA2</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Leifer, E.S., Troendle, J.F., Kolecki, A., Follmann, D.
Joint testing of overall and simple effect for the two-by-two factorial design. 2020. Submitted.
</p>
<p>Lin, D-Y., Gong, J., Gallo, P., et al. Simultaneous inference on treatment effects
in survival studies with factorial designs. Biometrics. 2016; 72: 1078-1085.
</p>
<p>Slud, E.V. Analysis of factorial survival experiments. Biometrics. 1994; 50: 25-38.
</p>


<h3>See Also</h3>

<p><code>roundDown</code>. <code>eventProb</code>, <code>lgrkPower</code>, <code>strLgrkPower</code>, <code>pmvnorm</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1:  Compute the nominal significance levels for rejection using
# the asymptotic correlations derived in Slud (1994)
corAa  &lt;- 1/sqrt(2)
corAab &lt;- 1/sqrt(2)
coraab &lt;- 1/2

crit2x2(corAa, corAab, coraab, dig = 2, alpha = 0.05, niter = 5)
# critEA3
# [1] -2.32

# sigEA3
# [1] 0.02034088

# critPA2A
# [1] -2.13

# sigPA2A
# [1] 0.03317161

# critPA2ab
# [1] -2.24

# sigPA2ab
# [1] 0.02509092

# critEA2
# [1] -2.22

# sigEA2
# [1] 0.02641877

# Example 2:  Compute the nominal critical values and significance levels for rejection
# using the estimated correlations for simdat.
corAa  &lt;- 0.6123399
corAab &lt;- 0.5675396
coraab &lt;- 0.4642737

crit2x2(corAa, corAab, coraab, dig = 2, alpha = 0.05, niter = 5)
# $critEA3
# [1] -2.34

# $critPA2A
# [1] -2.13

# $sigPA2A
# [1] 0.03317161

# $critPA2ab
# [1] -2.3

# $sigPA2ab
# [1] 0.02144822
#
# $sigEA3
# [1] 0.01928374

# $critEA2
# [1] -2.22

# $sigEA2
# [1] 0.02641877
</code></pre>

<hr>
<h2 id='eventProb'>Calculate event probabilities</h2><span id='topic+eventProb'></span>

<h3>Description</h3>

<p>Calculates the event probabilities for each of the four factorial groups
C, A, B, AB.  The time unit is in years, but of course, any time
unit could be used.  Average event probabilities across various
combinations of the groups are also calculated.
The event times are assumed to be exponentially distributed.  The
censoring times are assumed to be uniformly distributed and indepedent of
the event times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eventProb(rateC, hrA, hrB, hrAB, mincens, maxcens)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eventProb_+3A_ratec">rateC</code></td>
<td>
<p>group C one year event rate</p>
</td></tr>
<tr><td><code id="eventProb_+3A_hra">hrA</code></td>
<td>
<p>group A to group C hazard ratio</p>
</td></tr>
<tr><td><code id="eventProb_+3A_hrb">hrB</code></td>
<td>
<p>group B to group C hazard ratio</p>
</td></tr>
<tr><td><code id="eventProb_+3A_hrab">hrAB</code></td>
<td>
<p>group AB to group C hazard ratio</p>
</td></tr>
<tr><td><code id="eventProb_+3A_mincens">mincens</code></td>
<td>
<p>minimum censoring time</p>
</td></tr>
<tr><td><code id="eventProb_+3A_maxcens">maxcens</code></td>
<td>
<p>maximum censoring time</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>hazC</code></td>
<td>
<p>group C's exponential hazard rate</p>
</td></tr>
<tr><td><code>probC</code></td>
<td>
<p>event probability of the C group</p>
</td></tr>
<tr><td><code>probA</code></td>
<td>
<p>event probability of the A group</p>
</td></tr>
<tr><td><code>probB</code></td>
<td>
<p>event probability of the B group</p>
</td></tr>
<tr><td><code>probAB</code></td>
<td>
<p>event probability of the AB group</p>
</td></tr>
<tr><td><code>avgprob</code></td>
<td>
<p>average event probability across all factorial groups</p>
</td></tr>
<tr><td><code>probA_C</code></td>
<td>
<p>average event probablity of the A and C groups</p>
</td></tr>
<tr><td><code>probAB_C</code></td>
<td>
<p>average event probablity of the AB and C groups</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Corresponds to scenario 5 of Table 2 from Leifer, Troendle, et al. (2019).
rateC &lt;- 0.0445
hrA &lt;- 0.80
hrB &lt;- 0.80
hrAB &lt;- 0.72
mincens &lt;- 4.0
maxcens &lt;- 8.4
eventProb(rateC, hrA, hrB, hrAB, mincens, maxcens)
# hazC
# [1] 0.04552052

# probC
# [1] 0.2446365

# probA
# [1] 0.201254

# probB
# [1] 0.201254

# probAB
# [1] 0.1831806

# avgprob
# [1] 0.2075813

# probAB_C
# [1] 0.2139086
</code></pre>

<hr>
<h2 id='fac2x2analyze'>Significance testing for the Proportional Allocation 2, Equal Allocation 3,
Equal Allocation 2 procedures</h2><span id='topic+fac2x2analyze'></span>

<h3>Description</h3>

<p>Performs significance testing for the Proportional Allocation 2, Equal Allocation 3,
Equal Allocation 2 procedures.
Also reports the hazard ratios, 95% confidence intervals, p-values,
nominal significance levels, and correlations for the overall and simple
test statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fac2x2analyze(time, event, indA, indB, covmat, alpha, dig = 2, niter = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fac2x2analyze_+3A_time">time</code></td>
<td>
<p>follow-up times</p>
</td></tr>
<tr><td><code id="fac2x2analyze_+3A_event">event</code></td>
<td>
<p>event indicators (0/1)</p>
</td></tr>
<tr><td><code id="fac2x2analyze_+3A_inda">indA</code></td>
<td>
<p>treatment A indicators (0/1)</p>
</td></tr>
<tr><td><code id="fac2x2analyze_+3A_indb">indB</code></td>
<td>
<p>treatment B indicators (0/1)</p>
</td></tr>
<tr><td><code id="fac2x2analyze_+3A_covmat">covmat</code></td>
<td>
<p>covariate matrix, must be non-NULL.  Factor variables MUST use 0/1 dummy variables</p>
</td></tr>
<tr><td><code id="fac2x2analyze_+3A_alpha">alpha</code></td>
<td>
<p>two-sided familywise significance level</p>
</td></tr>
<tr><td><code id="fac2x2analyze_+3A_dig">dig</code></td>
<td>
<p>number of decimal places to which we <code><a href="#topic+roundDown">roundDown</a></code> the critical value</p>
</td></tr>
<tr><td><code id="fac2x2analyze_+3A_niter">niter</code></td>
<td>
<p>number of interations passed to <code>crit2x2</code> function call</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each of the three multiple testing procedures, the critical values for
the overall A (respectively, simple A) logrank statistics may be slightly different
from the overall B (respectively, simple B) logrank statistics.  This is
due to their slightly different correlations with each other (i.e., correlation
between overall A and simple A, respectively, overall B and simple B,
statistics) as well as with  the simple AB statistic.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>loghrAoverall</code></td>
<td>
<p>overall A log hazard ratio</p>
</td></tr>
<tr><td><code>seAoverall</code></td>
<td>
<p>standard error of the overall A log hazard ratio</p>
</td></tr>
<tr><td><code>ZstatAoverall</code></td>
<td>
<p>Z-statistic for the overall A log hazard ratio</p>
</td></tr>
<tr><td><code>pvalAoverall</code></td>
<td>
<p>two-sided p-value for the overall hazard ratio</p>
</td></tr>
<tr><td><code>hrAoverall</code></td>
<td>
<p>overall A hazard ratio</p>
</td></tr>
<tr><td><code>ciAoverall</code></td>
<td>
<p>95% confidence interval for the overall A hazard ratio</p>
</td></tr>
<tr><td><code>loghrAsimple</code></td>
<td>
<p>simple A log hazard ratio</p>
</td></tr>
<tr><td><code>seAsimple</code></td>
<td>
<p>standard error of the simple A log hazard ratio</p>
</td></tr>
<tr><td><code>ZstatAsimple</code></td>
<td>
<p>Z-statistic for the simple A log hazard ratio</p>
</td></tr>
<tr><td><code>pvalAsimple</code></td>
<td>
<p>two-sided p-value for the simple A hazard ratio</p>
</td></tr>
<tr><td><code>hrAsimple</code></td>
<td>
<p>simple A hazard ratio</p>
</td></tr>
<tr><td><code>ciAsimple</code></td>
<td>
<p>95% confidence interval for the simple A hazard ratio</p>
</td></tr>
<tr><td><code>loghrABsimple</code></td>
<td>
<p>simple AB log hazard ratio</p>
</td></tr>
<tr><td><code>seABsimple</code></td>
<td>
<p>standard error of the simple AB log hazard ratio</p>
</td></tr>
<tr><td><code>ZstatABsimple</code></td>
<td>
<p>Z-statistic for the simple AB log hazard ratio</p>
</td></tr>
<tr><td><code>pvalABsimple</code></td>
<td>
<p>two-sided p-value for the simple AB hazard ratio</p>
</td></tr>
<tr><td><code>hrABsimple</code></td>
<td>
<p>simple AB hazard ratio</p>
</td></tr>
<tr><td><code>ciABsimple</code></td>
<td>
<p>95% confidence interval for the simple AB hazard ratio</p>
</td></tr>
<tr><td><code>critEA3_A</code></td>
<td>
<p>Equal Allocation 3's critical value for the overall A simple A, and simple AB hypotheses</p>
</td></tr>
<tr><td><code>sigEA3_A</code></td>
<td>
<p>Equal Allocation 3's p-value rejection criterion for the overall A, simple A, and simple AB hypotheses</p>
</td></tr>
<tr><td><code>resultEA3_A</code></td>
<td>
<p>Equal Allocation 3's accept/reject decisions for the overall A, simple A, and simple AB hypotheses</p>
</td></tr>
<tr><td><code>critPA2overallA</code></td>
<td>
<p>Proportional Allocation 2's critical value for the overall A statistic</p>
</td></tr>
<tr><td><code>sigPA2overallA</code></td>
<td>
<p>Proportional Allocation 2's p-value rejection criterion for the overall A hypothesis</p>
</td></tr>
<tr><td><code>critPA2simpleAB</code></td>
<td>
<p>Proportional Allocation 2's critical value for the simple AB hypothesis</p>
</td></tr>
<tr><td><code>sigPA2simpleAB</code></td>
<td>
<p>Proportional Allocation 2 procedure's p-value rejection criterion for the simple AB hypothesis</p>
</td></tr>
<tr><td><code>resultPA2_A</code></td>
<td>
<p>Proportional Allocation 2 procedure's accept/reject decisions for the overall A and simple A hypotheses</p>
</td></tr>
<tr><td><code>critEA2_A</code></td>
<td>
<p>Equal Allocation 2 procedure's critical value for the simple A and simple AB hypotheses</p>
</td></tr>
<tr><td><code>sigEA2_A</code></td>
<td>
<p>Equal Allocation 2 procedure's p-value rejection criterion for the simple A and simple AB hypotheses</p>
</td></tr>
<tr><td><code>resultEA2_A</code></td>
<td>
<p>Equal Allocation 2 procedure's accept/reject decisions for the simple A and simple AB hypotheses </p>
</td></tr>
<tr><td><code>corAa</code></td>
<td>
<p>correlation between the overall A and simple A logrank statistics</p>
</td></tr>
<tr><td><code>corAab</code></td>
<td>
<p>correlation between the overall A and simple AB logrank statistics</p>
</td></tr>
<tr><td><code>coraab</code></td>
<td>
<p>correlation between the simple A and simple AB logrank statistics</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Eric Leifer, James Troendle
</p>


<h3>References</h3>

<p>Leifer, E.S., Troendle, J.F., Kolecki, A., Follmann, D.
Joint testing of overall and simple effect for the two-by-two factorial design. (2020). Submitted.
</p>
<p>Lin, D-Y., Gong, J., Gallo, P., et al. Simultaneous inference on treatment effects
in survival studies with factorial designs. Biometrics. 2016; 72: 1078-1085.
</p>
<p>Slud, E.V. Analysis of factorial survival experiments. Biometrics. 1994; 50: 25-38.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # First load the simulated data variables. The "simdataSub" file is
 # a 100-by-9 matrix which is loaded with the factorial2x2 package.
 time &lt;- simdataSub[, "time"]
 event &lt;- simdataSub[, "event"]
 indA &lt;- simdataSub[, "indA"]
 indB &lt;- simdataSub[, "indB"]
 covmat &lt;- simdataSub[, 6:10]
 fac2x2analyze(time, event, indA, indB, covmat, alpha = 0.05, niter = 5)
#  $loghrA
# [1] 0.05613844

# $seA
# [1] 0.4531521

# $ZstatA
# [1] 0.1238843

# $pvalA
# [1] 0.9014069

# $hrA
# [1] 1.057744

# $ciA
# [1] 0.4351608 2.5710556

# $loghra
# [1] 0.1987329

# $sea
# [1] 0.6805458

# $Zstata
# [1] 0.2920198

# $pvala
# [1] 0.7702714

# $hra
# [1] 1.219856

# $cia
# [1] 0.3213781 4.6302116

# $loghrab
# [1] 0.2864932

# $seab
# [1] 0.6762458

# $Zstatab
# [1] 0.4236525

# $pvalab
# [1] 0.6718193

# $hrab
# [1] 1.331749

# $ciab
# [1] 0.3538265 5.0125010

# $critPA2A
# [1] -2.129

# $sigPA2A
# [1] 0.03325426

# $critPA2ab
# [1] -2.299

# $sigPA2ab
# [1] 0.02150494

# $result23
# [1] "accept overall A" "accept simple AB"

# $critEA3
# [1] -2.338

# $sigEA3
# [1] 0.01938725

# $result13
# [1] "accept overall A" "accept simple A"  "accept simple AB"

# $critEA2
# [1] -2.216

# $sigEA2
# [1] 0.0266915

# $result12
# [1] "accept simple A"  "accept simple AB"

# $corAa
# [1] 0.6123399

# $corAab
# [1] 0.5675396

# $coraab
# [1] 0.4642737
</code></pre>

<hr>
<h2 id='fac2x2design'>Power for the Equal Allocation 3, Proportional Allocation 2, and
Equal Allocation 2 procedures.</h2><span id='topic+fac2x2design'></span>

<h3>Description</h3>

<p>Power for the Equal Allocation 3, Proportional Allocation 2, and
Equal Allocation 2 procedures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fac2x2design(
  n,
  rateC,
  hrA,
  hrB,
  hrAB,
  mincens,
  maxcens,
  dig = 2,
  alpha = 0.05,
  niter = 5,
  abseps = 0.001,
  corAa = 1/sqrt(2),
  corAab = 1/sqrt(2),
  coraab = 1/2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fac2x2design_+3A_n">n</code></td>
<td>
<p>total sample size</p>
</td></tr>
<tr><td><code id="fac2x2design_+3A_ratec">rateC</code></td>
<td>
<p>group C one year event rate</p>
</td></tr>
<tr><td><code id="fac2x2design_+3A_hra">hrA</code></td>
<td>
<p>group A to group C hazard ratio</p>
</td></tr>
<tr><td><code id="fac2x2design_+3A_hrb">hrB</code></td>
<td>
<p>group B to group C hazard ratio</p>
</td></tr>
<tr><td><code id="fac2x2design_+3A_hrab">hrAB</code></td>
<td>
<p>group AB to group C hazard ratio</p>
</td></tr>
<tr><td><code id="fac2x2design_+3A_mincens">mincens</code></td>
<td>
<p>minimum censoring time</p>
</td></tr>
<tr><td><code id="fac2x2design_+3A_maxcens">maxcens</code></td>
<td>
<p>maximum censoring time</p>
</td></tr>
<tr><td><code id="fac2x2design_+3A_dig">dig</code></td>
<td>
<p>number of decimal places to <code><a href="#topic+roundDown">roundDown</a></code> the critical value to</p>
</td></tr>
<tr><td><code id="fac2x2design_+3A_alpha">alpha</code></td>
<td>
<p>two-sided significance level</p>
</td></tr>
<tr><td><code id="fac2x2design_+3A_niter">niter</code></td>
<td>
<p>number of times we call <code>pmvnorm</code> to average out its randomness</p>
</td></tr>
<tr><td><code id="fac2x2design_+3A_abseps">abseps</code></td>
<td>
<p><code>abseps</code> setting in the <code>pmvnorm</code> call</p>
</td></tr>
<tr><td><code id="fac2x2design_+3A_coraa">corAa</code></td>
<td>
<p>correlation between the overall A and simple A log hazard ratio estimates</p>
</td></tr>
<tr><td><code id="fac2x2design_+3A_coraab">corAab</code></td>
<td>
<p>correlation between the overall A and simple AB log hazard ratio estimates</p>
</td></tr>
<tr><td><code id="fac2x2design_+3A_coraab">coraab</code></td>
<td>
<p>correlation between the simple A and simple AB log hazard ratio estimates</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>events</code></td>
<td>
<p>expected number of events</p>
</td></tr>
<tr><td><code>evtprob</code></td>
<td>
<p>event probabilities for the C, A, B, and AB groups, respectively</p>
</td></tr>
<tr><td><code>powerEA3overallA</code></td>
<td>
<p>Equal Allocation 3's power to detect the overall A effect</p>
</td></tr>
<tr><td><code>powerEA3simpleA</code></td>
<td>
<p>Equal Allocation 3's power to detect the simple A effect</p>
</td></tr>
<tr><td><code>powerEA3simpleAB</code></td>
<td>
<p>Equal Allocation 3's power to detect the simple AB effect</p>
</td></tr>
<tr><td><code>powerEA3anyA</code></td>
<td>
<p>Equal Allocation 3's power to detect the simple A or AB effects</p>
</td></tr>
<tr><td><code>powerPA2overallA</code></td>
<td>
<p>Proportional Allocation 2's power to detect the overall A effect</p>
</td></tr>
<tr><td><code>powerPA2simpleAB</code></td>
<td>
<p>Proportional Allocation 2's power to detect the simple AB effect</p>
</td></tr>
<tr><td><code>powerEA2simpleA</code></td>
<td>
<p>Equal Allocation 2's power to detect the simple A effect</p>
</td></tr>
<tr><td><code>powerEA2simpleAB</code></td>
<td>
<p>Equal Allocation 2's power to detect the simple AB effect</p>
</td></tr>
<tr><td><code>powerA</code></td>
<td>
<p>power to detect the overall A effect at the two-sided <code>alpha</code> level</p>
</td></tr>
<tr><td><code>powerB</code></td>
<td>
<p>power to detect the overall B effect at the two-sided <code>alpha</code> level</p>
</td></tr>
</table>


<h3>References</h3>

<p>Leifer, E.S., Troendle, J.F., Kolecki, A., Follmann, D.
Joint testing of overall and simple effect for the two-by-two factorial design. (2019). Submitted.
</p>
<p>Slud, E.V. Analysis of factorial survival experiments. Biometrics. 1994; 50: 25-38.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eventProb">eventProb</a></code>, <code><a href="#topic+crit2x2">crit2x2</a></code>, <code><a href="#topic+lgrkPower">lgrkPower</a></code>
<code><a href="#topic+strLgrkPower">strLgrkPower</a></code>, <code><a href="#topic+powerEA3">powerEA3</a></code>, <code><a href="#topic+powerPA2">powerPA2</a></code>,
<code><a href="#topic+powerEA2">powerEA2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Corresponds to scenario 4 in Table 2 from Leifer, Troendle, et al. (2019).
n &lt;- 4600
rateC &lt;- 0.0445
hrA &lt;- 0.80
hrB &lt;- 0.80
hrAB &lt;- 0.72
mincens &lt;- 4.0
maxcens &lt;- 8.4

fac2x2design(n, rateC, hrA, hrB, hrAB, mincens, maxcens, dig = 2, alpha = 0.05, niter = 1)
# $events
# [1] 954.8738

# $evtprob
# probC     probA     probB    probAB
# 0.2446365 0.2012540 0.2012540 0.1831806

# $powerEA3overallA
# [1] 0.5861992

# $powerEA3simpleA
# [1] 0.5817954

# $powerEA3simplAB
# [1] 0.9071236

# $powerEA3anyA
# [1] 0.7060777
# $powerPA2overallA
# [1] 0.6582819

# $powerPA2simpleAB
# [1] 0.9197286

# $powerEA2simpleA
# [1] 0.6203837
#
# $powerEA2simpleAB
# [1] 0.9226679

# $powerA
# [1] 0.7182932

# $powerB
# [1] 0.7182932

</code></pre>

<hr>
<h2 id='lgrkPower'>Unstratified (ordinary) logrank power</h2><span id='topic+lgrkPower'></span>

<h3>Description</h3>

<p>Computes the power for the unstratified (ordinary) logrank statistic
for two group comparison.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lgrkPower(hr, nevent, alpha = 0.05, rprob = 0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lgrkPower_+3A_hr">hr</code></td>
<td>
<p>hazard ratio</p>
</td></tr>
<tr><td><code id="lgrkPower_+3A_nevent">nevent</code></td>
<td>
<p>expected number of events</p>
</td></tr>
<tr><td><code id="lgrkPower_+3A_alpha">alpha</code></td>
<td>
<p>two-sided significance level</p>
</td></tr>
<tr><td><code id="lgrkPower_+3A_rprob">rprob</code></td>
<td>
<p>randomization probability</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses the formula at the bottom of p.317 from Schoenfeld (Biometrika, 1981)
where the beta should be 1 - beta.  The formula is modified
to assume that values of the hazard ratio
less than 1 correspond to treatment efficacy.  We do this because we only want
to include the probability of rejecting the null in favor of efficacy, not inferiority
as well.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>power</code></td>
<td>
<p>logrank power</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Eric Leifer, James Troendle
</p>


<h3>References</h3>

<p>Schoenfeld, D. The asymptotic properties of nonparametric tests for comparing
survival distributions. Biometrika. 1981; 68: 316-319.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> hr &lt;- 0.5
 nevent &lt;- 98
 lgrkPower(hr, nevent, alpha = 0.05,  rprob = 0.5)
 # $power
 # [1] 0.9293463

</code></pre>

<hr>
<h2 id='powerEA2'>Power of the Equal Allocation 2 procedure</h2><span id='topic+powerEA2'></span>

<h3>Description</h3>

<p>Computes the Equal Allocation 2's procedure power to
detect the simple A effect and the simple AB effect, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerEA2(n, hrA, hrAB, probA_C, probAB_C, crit12)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="powerEA2_+3A_n">n</code></td>
<td>
<p>total subjects with n/4 subjects in each of the C, A, B, and AB groups</p>
</td></tr>
<tr><td><code id="powerEA2_+3A_hra">hrA</code></td>
<td>
<p>group A to group C hazard ratio; <code>hrA</code> &lt; 1 corresponds to group A superiority</p>
</td></tr>
<tr><td><code id="powerEA2_+3A_hrab">hrAB</code></td>
<td>
<p>group AB to group C hazard ratio; <code>hrAB</code> &lt; 1 corresponds to group AB superiority</p>
</td></tr>
<tr><td><code id="powerEA2_+3A_proba_c">probA_C</code></td>
<td>
<p>event probability averaged across the A and C groups</p>
</td></tr>
<tr><td><code id="powerEA2_+3A_probab_c">probAB_C</code></td>
<td>
<p>event probability averaged across the AB and C groups</p>
</td></tr>
<tr><td><code id="powerEA2_+3A_crit12">crit12</code></td>
<td>
<p>logrank statistic critical value for both the simple A and simple AB effects</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a 2-by-2 factorial design, this function computes
the probability that either the simple A, respectively, simple AB logrank statistics
reject their null hypotheses using a Dunnett-corrected <code>crit12</code> critical value.
When the two-sided familywise type I error is 0.05, we may use
<code><a href="#topic+crit2x2">crit2x2</a></code> to compute <code>crit12</code> = -2.22 which corresponds
to a 0.0264 two-sided significance level.  This is described in
Leifer, Troendle, et al. (2020).
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>powerEA2simpleA</code></td>
<td>
<p>power to detect the simple A effect</p>
</td></tr>
<tr><td><code>powerEA2simpleAB</code></td>
<td>
<p>power to detect the simple AB effect</p>
</td></tr>
</table>


<h3>References</h3>

<p>Leifer, E.S., Troendle, J.F., Kolecki, A., Follmann, D.
Joint testing of overall and simple effect for the two-by-two factorial design. (2020). Submitted.
</p>
<p>Lin, D-Y., Gong, J., Gallo, P., et al. Simultaneous inference on treatment effects
in survival studies with factorial designs. Biometrics. 2016; 72: 1078-1085.
</p>
<p>Slud, E.V. Analysis of factorial survival experiments. Biometrics. 1994; 50: 25-38.
</p>


<h3>See Also</h3>

<p><code>crit2x2</code>, <code>lgrkPower</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Corresponds to scenario 4 in Table 2 from Leifer, Troendle, et al. (2020).
rateC &lt;- 0.0445  # one-year C group event rate
hrA &lt;- 0.80
hrB &lt;- 0.80
hrAB &lt;- 0.72
mincens &lt;- 4.0
maxcens &lt;- 8.4
evtprob &lt;- eventProb(rateC, hrA, hrB, hrAB, mincens, maxcens)
probA_C &lt;- evtprob$probA_C
probAB_C &lt;- evtprob$probAB_C
corAa  &lt;- 1/sqrt(2)
corAab &lt;- 1/sqrt(2)
coraab &lt;- 1/2
dig &lt;- 2
alpha &lt;- 0.05
critEA2 &lt;- crit2x2(corAa, corAab, coraab, dig, alpha)$critEA2
n &lt;- 4600
powerEA2(n, hrA, hrAB, probA_C, probAB_C, critEA2)

# $powerEA2simpleA
# [1] 0.6203837

# $powerEA2simpleAB
# [1] 0.9226679

</code></pre>

<hr>
<h2 id='powerEA3'>Power of the Equal Allocation 3 procedure</h2><span id='topic+powerEA3'></span>

<h3>Description</h3>

<p>Computes the Equal Allocation 3 procedure's power to
detect the overall A effect, the simple A effect, or the simple AB effect, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerEA3(
  n,
  hrA,
  hrB,
  hrAB,
  avgprob,
  probA_C,
  probAB_C,
  critEA3,
  dig,
  cormat12 = matrix(c(1, sqrt(0.5), sqrt(0.5), 1), byrow = T, nrow = 2),
  niter = 5,
  abseps = 0.001
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="powerEA3_+3A_n">n</code></td>
<td>
<p>total subjects with n/4 subjects in each of the C, A, B, and AB groups</p>
</td></tr>
<tr><td><code id="powerEA3_+3A_hra">hrA</code></td>
<td>
<p>group A to group C hazard ratio; <code>hrA</code> &lt; 1 corresponds to group A superiority</p>
</td></tr>
<tr><td><code id="powerEA3_+3A_hrb">hrB</code></td>
<td>
<p>group B to group C hazard ratio; <code>hrA</code> &lt; 1 corresponds to group A superiority</p>
</td></tr>
<tr><td><code id="powerEA3_+3A_hrab">hrAB</code></td>
<td>
<p>group AB to group C hazard ratio; <code>hrAB</code> &lt; 1 corresponds to group AB superiority</p>
</td></tr>
<tr><td><code id="powerEA3_+3A_avgprob">avgprob</code></td>
<td>
<p>event probability averaged across the C, A, B, and AB groups</p>
</td></tr>
<tr><td><code id="powerEA3_+3A_proba_c">probA_C</code></td>
<td>
<p>event probability averaged across the A and C groups</p>
</td></tr>
<tr><td><code id="powerEA3_+3A_probab_c">probAB_C</code></td>
<td>
<p>event probability averaged across the AB and C groups</p>
</td></tr>
<tr><td><code id="powerEA3_+3A_critea3">critEA3</code></td>
<td>
<p>rejection critical value for the overall A, simple A, and simple AB logrank statistics</p>
</td></tr>
<tr><td><code id="powerEA3_+3A_dig">dig</code></td>
<td>
<p>number of decimal places to <code><a href="#topic+roundDown">roundDown</a></code> the critical value to</p>
</td></tr>
<tr><td><code id="powerEA3_+3A_cormat12">cormat12</code></td>
<td>
<p>asymptotic correlation matrix for the overall A and simple A, respectively, simple AB logrank statistics</p>
</td></tr>
<tr><td><code id="powerEA3_+3A_niter">niter</code></td>
<td>
<p>number of times we call <code>pmvnorm</code> to average out its randomness</p>
</td></tr>
<tr><td><code id="powerEA3_+3A_abseps">abseps</code></td>
<td>
<p><code>abseps</code> setting in the <code>pmvnorm</code> call</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a 2-by-2 factorial design, this function computes
the probability that either the overall A
or the simple A or the simple AB logrank statistics
reject their null hypotheses at the Dunnet-corrected
<code>critEA3</code> critical value.  As described in Leifer, Troendle, et al. (2019),
the <code>critEA3</code> = -2.32 critical value
corresponds to controlling the famiywise error of the Equal Allocation 3 procedure at the
two-sided 0.05 significance level.
The critical value -2.32 may be computed using the <code>crit2x2</code> function.
The <code>pmvnorm</code> function from the <code>mvtnorm</code> package is used to calculate
the power for simultaneously detecting the overall and simple A effects.
This is used to compute the power for detecting the overall A and/or simple A effects,
which is computed as the sum of the powers for each of the effects minus the
power for simultaneously detecting both effects.
Since the power for simultaneously detecting both effects involves bivariate
normal integration over an unbounded region in R^2, <code>pmvnorm</code>
uses a random seed for these computations.  Note that cRAN suggested
we not include the random seed as an argument in this function.  To smooth out the
randomness, <code>pmvnorm</code> is called <code>niter</code> times and
the average value over the <code>niter</code> calls is taken to be those powers.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>powerEA3overallA</code></td>
<td>
<p>power to detect the overall A effect</p>
</td></tr>
<tr><td><code>powerEA3simpleA</code></td>
<td>
<p>power to detect the simple A effect</p>
</td></tr>
<tr><td><code>powerEA3simpleAB</code></td>
<td>
<p>power to detect the simple AB effect</p>
</td></tr>
<tr><td><code>powerEA3anyA</code></td>
<td>
<p>power to detect either the overall A or simple A effects</p>
</td></tr>
</table>


<h3>References</h3>

<p>Leifer, E.S., Troendle, J.F., Kolecki, A., Follmann, D.
Joint testing of overall and simple effect for the two-by-two factorial design. (2020). Submitted.
</p>
<p>Lin, D-Y., Gong, J., Gallo, P., et al. Simultaneous inference on treatment effects
in survival studies with factorial designs. Biometrics. 2016; 72: 1078-1085.
</p>
<p>Slud, E.V. Analysis of factorial survival experiments. Biometrics. 1994; 50: 25-38.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+crit2x2">crit2x2</a></code>, <code>lgrkPower</code>, <code>strLgrkPower</code>, <code>pmvnorm</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Corresponds to scenario 5 in Table 2 from Leifer, Troendle, et al. (2020).
rateC &lt;- 0.0445
hrA &lt;- 0.80
hrB &lt;- 0.80
hrAB &lt;- 0.72
mincens &lt;- 4.0
maxcens &lt;- 8.4
evtprob &lt;- eventProb(rateC, hrA, hrB, hrAB, mincens, maxcens)
avgprob &lt;- evtprob$avgprob
probAB_C &lt;- evtprob$probAB_C
probA_C &lt;- evtprob$probA_C
dig &lt;- 2
alpha &lt;- 0.05
corAa  &lt;- 1/sqrt(2)
corAab &lt;- 1/sqrt(2)
coraab &lt;- 1/2
critEA3 &lt;- crit2x2(corAa, corAab, coraab, dig, alpha)$critEA3
n &lt;- 4600
powerEA3(n, hrA, hrB, hrAB, avgprob, probA_C, probAB_C,
  critEA3, dig, cormat12 = matrix(c(1, sqrt(0.5), sqrt(0.5), 1), byrow = TRUE,
  nrow = 2), niter = 1, abseps = 1e-03)

# $powerEA3overallA
# [1] 0.5861992

# $powerEA3simpleA
# [1] 0.5817954

# $powerAB
# [1] 0.9071236

# $powerEA3anyA
# [1] 0.7060777
</code></pre>

<hr>
<h2 id='powerPA2'>Power of the Proportional Allocation 2 procedure</h2><span id='topic+powerPA2'></span>

<h3>Description</h3>

<p>Computes the Proportional Allocation 2 procedure's power to
detect the overall A effect or the simple AB effect, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerPA2(n, hrA, hrB, hrAB, avgprob, probAB_C, critPA2A, critPA2ab, dig)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="powerPA2_+3A_n">n</code></td>
<td>
<p>total subjects with n/4 subjects in each of the C, A, B, and AB groups</p>
</td></tr>
<tr><td><code id="powerPA2_+3A_hra">hrA</code></td>
<td>
<p>group A to group C hazard ratio; <code>hrA</code> &lt; 1 corresponds to group A superiority</p>
</td></tr>
<tr><td><code id="powerPA2_+3A_hrb">hrB</code></td>
<td>
<p>group B to group C hazard ratio; <code>hrA</code> &lt; 1 corresponds to group A superiority</p>
</td></tr>
<tr><td><code id="powerPA2_+3A_hrab">hrAB</code></td>
<td>
<p>group AB to group C hazard ratio; <code>hrAB</code> &lt; 1 corresponds to group AB superiority</p>
</td></tr>
<tr><td><code id="powerPA2_+3A_avgprob">avgprob</code></td>
<td>
<p>event probability averaged across the C, A, B, and AB groups</p>
</td></tr>
<tr><td><code id="powerPA2_+3A_probab_c">probAB_C</code></td>
<td>
<p>event probability averaged across the AB and C groups</p>
</td></tr>
<tr><td><code id="powerPA2_+3A_critpa2a">critPA2A</code></td>
<td>
<p>rejection critical value for the overall A stratified logrank statistic</p>
</td></tr>
<tr><td><code id="powerPA2_+3A_critpa2ab">critPA2ab</code></td>
<td>
<p>rejection critical value for the simple AB ordinary logrank statistic</p>
</td></tr>
<tr><td><code id="powerPA2_+3A_dig">dig</code></td>
<td>
<p>number of decimal places to which we <code><a href="#topic+roundDown">roundDown</a></code> the critical value
for the overall A test as calculated in <code><a href="#topic+powerPA2">powerPA2</a></code>
by <code><a href="#topic+strLgrkPower">strLgrkPower</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Proportional Allocation 2 procedure uses a two-sided
2/3 * alpha significance level to test the overall A effect and the
remaining Dunnett-corrected type 1 error to thest the simple AB effect.
When  the familywise error is alpha = 0.05, this corresponds to a
critical value <code>critPA2A</code> = -2.13.
Then <code><a href="#topic+crit2x2">crit2x2</a></code> is used to compute a critical value
<code>critPA2ab</code> = -2.24 to test the simple AB effect.  This corresponds to
a two-sided 0.0251 significance level.  This controls the
asymptotic familywise type I error for the two hypothesis tests at the
two-sided 0.05 level.  This is because of the <code>1/sqrt(2)</code> asymptotic
correlation between the logrank test statistics for the overall A
and simple AB effects (Slud, 1994).  The overall A effect's significance
level 2/3 * 0.05 is prespecified and the simple AB effect's significance
level 0.0251 is computed using <code>crit2x2</code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>powerPA2overallA</code></td>
<td>
<p>power to detect the overall A effect</p>
</td></tr>
<tr><td><code>powerPA2simpleAB</code></td>
<td>
<p>power to detect the simple AB effect</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Eric Leifer, James Troendle
</p>


<h3>References</h3>

<p>Leifer, E.S., Troendle, J.F., Kolecki, A., Follmann, D.
Joint testing of overall and simple effect for the two-by-two factorial design. (2020). Submitted.
</p>
<p>Lin, D-Y., Gong, J., Gallo, P., et al. Simultaneous inference on treatment effects
in survival studies with factorial designs. Biometrics. 2016; 72: 1078-1085.
</p>
<p>Slud, E.V. Analysis of factorial survival experiments. Biometrics. 1994; 50: 25-38.
</p>


<h3>See Also</h3>

<p><code>crit2x2</code>, <code>eventProb</code>, <code>lgrkPower</code>, <code>strLgrkPower</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # Corresponds to scenario 4 in Table 2 from Leifer, Troendle, et al. (2020).
 rateC &lt;- 0.0445  # one-year C group event rate
 hrA &lt;- 0.80
 hrB &lt;- 0.80
 hrAB &lt;- 0.72
 mincens &lt;- 4.0
 maxcens &lt;- 8.4
 evtprob &lt;- eventProb(rateC, hrA, hrB, hrAB, mincens, maxcens)
 avgprob &lt;- evtprob$avgprob
 probAB_C &lt;- evtprob$probAB_C
 dig &lt;- 2
 alpha &lt;- 0.05
 corAa  &lt;- 1/sqrt(2)
 corAab &lt;- 1/sqrt(2)
 coraab &lt;- 1/2
 critvals &lt;- crit2x2(corAa, corAab, coraab, dig, alpha)
 critPA2A &lt;- critvals$critPA2A
 critPA2ab &lt;- critvals$critPA2ab
 n &lt;- 4600
 powerPA2(n, hrA, hrB, hrAB, avgprob, probAB_C,
            critPA2A, critPA2ab, dig)
# $powerPA2overallA
# [1] 0.6582819

# $powerPA2simpleAB
# [1] 0.9197286
</code></pre>

<hr>
<h2 id='roundDown'>Round down a negative number</h2><span id='topic+roundDown'></span>

<h3>Description</h3>

<p>Rounds a negative number to the nearest, more negative
number to a specified decimal place.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roundDown(x, dig)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="roundDown_+3A_x">x</code></td>
<td>
<p>number to be rounded</p>
</td></tr>
<tr><td><code id="roundDown_+3A_dig">dig</code></td>
<td>
<p>number of decimal places to be rounded</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>roundDown</code> is used to
round a negative Z-statistic critical value, which has (infinitely)
many significant digits, to the nearest <code>dig</code> decimal place
which is more extreme
than the critical value itself.  This is done to preserve the
desired type I error level.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>roundDown(-1.95456, 2)
# [1] -1.96
</code></pre>

<hr>
<h2 id='simdat'>Simulated 2x2 factorial trial data</h2><span id='topic+simdat'></span>

<h3>Description</h3>

<p>A dataset mimicking data that might be obtained from a
two-by-two factorial clinical trial.  It is the first 100 rows
of the data set <code>simdata</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(simdat)
</code></pre>


<h3>Format</h3>

<p>A data frame with 100 rows and 10 variables
</p>


<h3>Details</h3>


<ul>
<li> <p><code>subjno</code>  subject ID
</p>
</li>
<li> <p><code>time</code>  time to event or censoring
</p>
</li>
<li> <p><code>event</code> event indicator (1=event, 0=censoring)
</p>
</li>
<li> <p><code>indA</code> indicator of receiving treatment A (1=yes, 0=no)
</p>
</li>
<li> <p><code>indB</code> indicator of receiving treatment B (1=yes, 0=no)
</p>
</li>
<li> <p><code>cvd</code>  history of cardiovascular disease (1=yes, 0=no)
</p>
</li>
<li> <p><code>fac2-fac5</code> indicator variables for the 5 level factor variable
</p>
</li></ul>


<hr>
<h2 id='simdata'>Simulated 2x2 factorial trial data</h2><span id='topic+simdata'></span>

<h3>Description</h3>

<p>A dataset mimicking data that might be obtained from a
two-by-two factorial clinical trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(simdata)
</code></pre>


<h3>Format</h3>

<p>A data frame with 4600 rows and 10 variables
</p>


<h3>Details</h3>


<ul>
<li> <p><code>subjno</code>  subject ID
</p>
</li>
<li> <p><code>time</code>  time to event or censoring
</p>
</li>
<li> <p><code>event</code> event indicator (1=event, 0=censoring)
</p>
</li>
<li> <p><code>indA</code> indicator of receiving treatment A (1=yes, 0=no)
</p>
</li>
<li> <p><code>indB</code> indicator of receiving treatment B (1=yes, 0=no)
</p>
</li>
<li> <p><code>cvd</code>  history of cardiovascular disease (1=yes, 0=no)
</p>
</li>
<li> <p><code>fac2-fac5</code> indicator variables for the 5 level factor variable
</p>
</li></ul>


<hr>
<h2 id='simdataSub'>Simulated 2x2 factorial trial data</h2><span id='topic+simdataSub'></span>

<h3>Description</h3>

<p>A dataset mimicking data that might be obtained from a
two-by-two factorial clinical trial.  It is the first 100 rows
of the data set <code>simdata</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(simdataSub)
</code></pre>


<h3>Format</h3>

<p>A data frame with 100 rows and 10 variables
</p>


<h3>Details</h3>


<ul>
<li> <p><code>subjno</code>  subject ID
</p>
</li>
<li> <p><code>time</code>  time to event or censoring
</p>
</li>
<li> <p><code>event</code> event indicator (1=event, 0=censoring)
</p>
</li>
<li> <p><code>indA</code> indicator of receiving treatment A (1=yes, 0=no)
</p>
</li>
<li> <p><code>indB</code> indicator of receiving treatment B (1=yes, 0=no)
</p>
</li>
<li> <p><code>cvd</code>  history of cardiovascular disease (1=yes, 0=no)
</p>
</li>
<li> <p><code>fac2-fac5</code> indicator variables for the 5 level factor variable
</p>
</li></ul>


<hr>
<h2 id='strLgrkPower'>Stratified (overall) logrank power</h2><span id='topic+strLgrkPower'></span>

<h3>Description</h3>

<p>Computes the power for the overall treatment A effect based on the stratified logrank test
based on Slud (1994).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strLgrkPower(n, hrA, hrB, hrAB, avgprob, dig = 2, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="strLgrkPower_+3A_n">n</code></td>
<td>
<p>total subjects with n/4 subjects in the C, A, B, and AB groups</p>
</td></tr>
<tr><td><code id="strLgrkPower_+3A_hra">hrA</code></td>
<td>
<p>group A to group C hazard ratio</p>
</td></tr>
<tr><td><code id="strLgrkPower_+3A_hrb">hrB</code></td>
<td>
<p>group B to group C hazard ratio</p>
</td></tr>
<tr><td><code id="strLgrkPower_+3A_hrab">hrAB</code></td>
<td>
<p>group AB to group C hazard ratio</p>
</td></tr>
<tr><td><code id="strLgrkPower_+3A_avgprob">avgprob</code></td>
<td>
<p>average event probability across the four groups as
calculated by the function eventProb</p>
</td></tr>
<tr><td><code id="strLgrkPower_+3A_dig">dig</code></td>
<td>
<p>number of decimal places to which we <code><a href="#topic+roundDown">roundDown</a></code> the critical value
corresponding to <code>alpha</code></p>
</td></tr>
<tr><td><code id="strLgrkPower_+3A_alpha">alpha</code></td>
<td>
<p>two-sided significance level</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>roundDown</code> function is used in conjunction with the <code>dig</code> argument
to insure that any rounding of the (negative) critical values will be done conservatively to control
the familywise type I error at the desired level.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mean</code></td>
<td>
<p>logrank mean value</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>logrank power</p>
</td></tr>
<tr><td><code>nevent</code></td>
<td>
<p>expected number of events</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Eric Leifer, James Troendle
</p>


<h3>References</h3>

<p>Leifer, E.S., Troendle, J.F., Kolecki, A., Follmann, D. Joint testing of overall and
simple effect for the two-by-two factorial design. (2019). Submitted.
</p>
<p>Slud, E.V. Analysis of factorial survival experiments. Biometrics. 1994; 50: 25-38.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+roundDown">roundDown</a></code>,  <code><a href="#topic+eventProb">eventProb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rateC &lt;- 0.0445
hrA &lt;- 0.80
hrB &lt;- 0.80
hrAB &lt;- 0.72
mincens &lt;- 4.0
maxcens &lt;- 8.4
avgprob &lt;- eventProb(rateC, hrA, hrB, hrAB, mincens, maxcens)$avgprob
n &lt;- 4600
strLgrkPower(n, hrA, hrB, hrAB, avgprob, dig = 2, alpha = 0.05)
# $mean
# [1] -2.537779

# $power
# [1] 0.7182932

# $nevent
# [1] 954.8738
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
