<!DOCTYPE html><html><head><title>Help for package occupationMeasurement</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {occupationMeasurement}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#algo_similarity_based_reasoning'><p>Make suggestions using similarity based reasoning.</p></a></li>
<li><a href='#api'><p>Start the occupation coding API.</p></a></li>
<li><a href='#app'><p>Get an instance of the interactive shiny occupation coding app.</p></a></li>
<li><a href='#auxco'><p>German Auxiliary Classification of Occupations (AuxCO) v1.2.3</p></a></li>
<li><a href='#button_next'><p>Go to the next page</p></a></li>
<li><a href='#check_condition'><p>Called internally by the shiny server.</p></a></li>
<li><a href='#convert_suggestions'><p>Convert suggestion from one suggestion format into the other</p></a></li>
<li><a href='#create_app_settings'><p>Create app_settings.</p></a></li>
<li><a href='#execute_render'><p>Called internally by the shiny server.</p></a></li>
<li><a href='#execute_run_after'><p>Called internally by the shiny server when navigating to the next page.</p></a></li>
<li><a href='#execute_run_before'><p>Called internally by the shiny server.</p></a></li>
<li><a href='#get_data'><p>Load a standard dataset, while supporting overriding by the user.</p></a></li>
<li><a href='#get_final_codes'><p>Get the final occupation codes</p></a></li>
<li><a href='#get_followup_questions'><p>Get potential follow-up questions for a suggestion.</p></a></li>
<li><a href='#get_item_data'><p>Retrieve data for an item.</p></a></li>
<li><a href='#get_job_suggestions'><p>Make coding suggestions based on a user's open-ended text input.</p></a></li>
<li><a href='#get_page_data'><p>Get questionnaire / page data.</p></a></li>
<li><a href='#get_responses'><p>Convenience function to aggregate all saved results_overview files.</p></a></li>
<li><a href='#get_suggestion_info'><p>Get additional information for a suggestion id.</p></a></li>
<li><a href='#isco_08_en'><p>Categories of the The International Standard Classification of Occupations - ISCO-08</p></a></li>
<li><a href='#leaving_page_backwards'><p>Called internally by the shiny server when navigating to the previous page.</p></a></li>
<li><a href='#load_auxco'><p>Load AuxCO from a directory of CSV files</p></a></li>
<li><a href='#load_kldb_raw'><p>Clean &amp; Load KldB 2010 dataset.</p></a></li>
<li><a href='#new_page'><p>Create a new questionnaire page.</p></a></li>
<li><a href='#page_choose_one_option'><p>Show a page with multiple radio button options where once can be picked.</p></a></li>
<li><a href='#page_feedback'><p>Page to receive feedback on how well the chosen suggestion fits</p></a></li>
<li><a href='#page_final'><p>A final page, showing instructions to close the window.</p></a></li>
<li><a href='#page_first_freetext'><p>The first freetext question to show.</p></a></li>
<li><a href='#page_followup'><p>Show potential followup questions to the user.</p></a></li>
<li><a href='#page_freetext'><p>Show a page with a text field where free text can be entered.</p></a></li>
<li><a href='#page_none_selected_freetext'><p>An additional freetext page to show when no suggestion has been selected.</p></a></li>
<li><a href='#page_results'><p>Page showing the user's results</p></a></li>
<li><a href='#page_second_freetext'><p>An optional, second free text question if the first didn't yield suggestions.</p></a></li>
<li><a href='#page_select_suggestion'><p>Display the generated suggestions for the user to pick one.</p></a></li>
<li><a href='#page_welcome'><p>Welcome Page (optional)</p></a></li>
<li><a href='#preprocess_string'><p>Preprocess a string, removing special characters and handling abbreviations.</p></a></li>
<li><a href='#pretrained_models'><p>Pretrained ML models to be used with the package.</p></a></li>
<li><a href='#questionnaire_demo'><p>A demo questionnaire with additional explanations</p></a></li>
<li><a href='#questionnaire_interviewer_administered'><p>A questionnaire for interviewer-administered surveys</p></a></li>
<li><a href='#questionnaire_web_survey'><p>A web survey which participants can navigate themselves.</p></a></li>
<li><a href='#set_item_data'><p>Set / save data for an item.</p></a></li>
<li><a href='#set_page_data'><p>Set some values in the page/questionnaire data in the current session.</p></a></li>
<li><a href='#train_similarity_based_reasoning'><p>Train Similarity Based Probability Model with anonymized training data</p></a></li>
<li><a href='#validate_questionnaire'><p>Validate (and sanitize the questionnaire)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Interactively Measure Occupations in Interviews and Beyond</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Perform interactive occupation coding during interviews as
    described in Peycheva, D., Sakshaug, J., Calderwood, L. (2021) &lt;<a href="https://doi.org/10.2478%2Fjos-2021-0042">doi:10.2478/jos-2021-0042</a>&gt;
    and Schierholz, M., Gensicke, M., Tschersich, N., Kreuter, F. (2018) &lt;<a href="https://doi.org/10.1111%2Frssa.12297">doi:10.1111/rssa.12297</a>&gt;.
    Generate suggestions for occupational categories based on free text
    input, with pre-trained machine learning models in German and a ready-to-use
    shiny application provided for quick and easy data collection.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://occupationMeasurement.github.io/occupationMeasurement/">https://occupationMeasurement.github.io/occupationMeasurement/</a>,
<a href="https://github.com/occupationMeasurement/occupationMeasurement">https://github.com/occupationMeasurement/occupationMeasurement</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/occupationMeasurement/occupationMeasurement/issues">https://github.com/occupationMeasurement/occupationMeasurement/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table (&ge; 1.14.2), digest, shiny (&ge; 1.7.1), stringdist
(&ge; 0.9.8), stringr (&ge; 1.4.0), text2vec (&ge; 0.6.1), tm (&ge;
0.7.8)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>plumber, knitr, mvtnorm, callr, devtools, httr, sessioninfo,
shinytest2, testthat, withr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-27 12:15:13 UTC; jan</td>
</tr>
<tr>
<td>Author:</td>
<td>Jan Simson <a href="https://orcid.org/0000-0002-9406-7761"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Olga Kononykhina [aut],
  Malte Schierholz <a href="https://orcid.org/0000-0003-4058-1543"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jan Simson &lt;jan.simson@lmu.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-27 13:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='algo_similarity_based_reasoning'>Make suggestions using similarity based reasoning.</h2><span id='topic+algo_similarity_based_reasoning'></span>

<h3>Description</h3>

<p>The Algorithm used here corresponds to Algorithm #10 in (Schierholz, 2019).
Note: This function should not be used directly, but rather as a step /
algorithm in get_job_suggestions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>algo_similarity_based_reasoning(
  text_processed,
  sim_name = "wordwise",
  probabilities = occupationMeasurement::pretrained_models$similarity_based_reasoning,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="algo_similarity_based_reasoning_+3A_text_processed">text_processed</code></td>
<td>
<p>The processed user input.
Will be provided by get_job_suggestions.</p>
</td></tr>
<tr><td><code id="algo_similarity_based_reasoning_+3A_sim_name">sim_name</code></td>
<td>
<p>Which similarity measure to use.
Possible values are &quot;wordwise&quot; or &quot;substring&quot;.</p>
</td></tr>
<tr><td><code id="algo_similarity_based_reasoning_+3A_probabilities">probabilities</code></td>
<td>
<p>Trained probabilities to be used,
defaults to the one bundled with the package. See <a href="#topic+pretrained_models">pretrained_models</a>.
This pretrained model always predicts a 5-digit code from the 2010 German
Classification of Occupations, with some exceptions: -0004 stands for
'Not precise enough/uncodable', -0006 stands for 'Multiple Jobs', -0012
stands for 'Blue-collar workers', -0019 stands for
'Volunteer/Social Service', and -0030 stands for 'Student assistant'.</p>
</td></tr>
<tr><td><code id="algo_similarity_based_reasoning_+3A_...">...</code></td>
<td>
<p>Additional arguments may be passed from <code><a href="#topic+get_job_suggestions">get_job_suggestions()</a></code>,
but will be ignored in this function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.table with suggestions or NULL if no suggestions were found.
</p>


<h3>References</h3>

<p>Schierholz, M. (2019). New Methods for Job and Occupation Classification (Ph.D. Thesis). University of Mannheim.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_job_suggestions">get_job_suggestions()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
# Use with default settings
if (interactive()) {
  get_job_suggestions(
    "Arzt",
    steps = list(
      simbased_default = list(
        algorithm = algo_similarity_based_reasoning
      )
    )
  )
}

# Use with substring similarity
if (interactive()) {
 get_job_suggestions(
   "Arzt",
   steps = list(
     simbased_substring = list(
       algorithm = algo_similarity_based_reasoning,
       parameters = list(
         sim_name = "substring"
       )
     )
   )
 )
}

# Comparison of algo_similarity_based_reasoning() with get_job_suggestions()

# Example of using algo_similarity_based_reasoning() directly. Not recommended.
if (interactive()) {
  algo_similarity_based_reasoning(
    preprocess_string("Arzt"),
    sim_name = "wordwise"
  )[order(score, decreasing = TRUE)]
}

# Same output as before, but the function is more adaptable.
if (interactive()) {
  get_job_suggestions(
    "Arzt",
    suggestion_type = "kldb-2010",
    num_suggestions = 1500,
    steps = list(
      simbased_default = list(
        algorithm = algo_similarity_based_reasoning,
        parameters = list(
          sim_name = "wordwise"
        )
      )
    )
  )[, list(kldb_id, score, sim_name, kldb_id_title = title)]
}

## End(Not run)
</code></pre>

<hr>
<h2 id='api'>Start the occupation coding API.</h2><span id='topic+api'></span>

<h3>Description</h3>

<p>Start the occupation coding API.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>api(
  start = TRUE,
  log_to_file = FALSE,
  file = system.file("plumber", "api", "plumber.R", package = "occupationMeasurement"),
  log_to_console = TRUE,
  log_filepath = file.path("output", "log_api.csv"),
  require_identifier = FALSE,
  allow_origin = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="api_+3A_start">start</code></td>
<td>
<p>Whether to immediately start the api. (Defaults to TRUE)</p>
</td></tr>
<tr><td><code id="api_+3A_log_to_file">log_to_file</code></td>
<td>
<p>Whether to requests should be logged in a file.
Defaults to FALSE.
Note: The file format used here is a CSV file for easier analysis.</p>
</td></tr>
<tr><td><code id="api_+3A_file">file</code></td>
<td>
<p>Path to the <code>plumber.R</code> file describing the API.
Defaults to <code>plumber/api/plumber.R</code> within the installed package.
Refer to this file to understand how the API is implemented.</p>
</td></tr>
<tr><td><code id="api_+3A_log_to_console">log_to_console</code></td>
<td>
<p>Whether to requests should be logged in the console.
Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="api_+3A_log_filepath">log_filepath</code></td>
<td>
<p>The path to a CSV file in which to save the structured
logs.</p>
</td></tr>
<tr><td><code id="api_+3A_require_identifier">require_identifier</code></td>
<td>
<p>Whether an identifier has to be added to api
requests in order to match / identify requests afterwards.
Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="api_+3A_allow_origin">allow_origin</code></td>
<td>
<p>Domain from which to allow cross origin requests (CORS).
If the API is running on a different domain / server than the application
using it, the website's root has to be provided here e.g.
&quot;https://occupationMeasurement.github.io&quot;. For more information see the
<a href="https://www.rplumber.io/articles/security.html#cross-origin-resource-sharing-cors">plumber security page</a>,
and <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin">MDN</a>.
Defaults to NULL to not set any header at all.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A Plumber router
</p>


<h3>See Also</h3>

<p><code>vignette("api")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

if (interactive()) {
  # Get the plumber router
  router &lt;- api(
    start = FALSE,
    # If this is TRUE, the log directory will immediately be created
    log_to_file = FALSE
  )
  # Start the router
  plumber::pr_run(router)
}

if (interactive()) {
  # Immediately start the API
  api(start = TRUE)
}
</code></pre>

<hr>
<h2 id='app'>Get an instance of the interactive shiny occupation coding app.</h2><span id='topic+app'></span>

<h3>Description</h3>

<p>Printing the returned instance or returning it without saving it in a
variable will start the app.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>app(
  questionnaire = questionnaire_web_survey(),
  app_settings = create_app_settings(save_to_file = TRUE),
  css_file = NULL,
  resource_dir = system.file("www", package = "occupationMeasurement"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="app_+3A_questionnaire">questionnaire</code></td>
<td>
<p>The questionnaire to load.
(Defaults to the questionnaire returned by <a href="#topic+questionnaire_web_survey">questionnaire_web_survey</a>().)</p>
</td></tr>
<tr><td><code id="app_+3A_app_settings">app_settings</code></td>
<td>
<p>The app_settings to use. Check the documentation for
create_app_settings to learn about the options.</p>
</td></tr>
<tr><td><code id="app_+3A_css_file">css_file</code></td>
<td>
<p>Path to a CSS file to be included in the app.</p>
</td></tr>
<tr><td><code id="app_+3A_resource_dir">resource_dir</code></td>
<td>
<p>From which directory to static files e.g. styles.
If you want to load additional resources from outside the package, you
should rather do so with <a href="shiny.html#topic+resourcePaths">shiny::addResourcePath</a> rather than with this
parameter.</p>
</td></tr>
<tr><td><code id="app_+3A_...">...</code></td>
<td>
<p>Any additional parameters will be forwarded to shiny::shinyApp().</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A shiny app instance.
</p>


<h3>See Also</h3>

<p><code>vignette("app")</code>, <code><a href="#topic+questionnaire_web_survey">questionnaire_web_survey()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
app_instance &lt;- app(
  app_settings = create_app_settings(
    # Important to save results from the app
    save_to_file = TRUE
  )
)

# Start the app
if (interactive()) {
  app_instance
}

## End(Not run)
</code></pre>

<hr>
<h2 id='auxco'>German Auxiliary Classification of Occupations (AuxCO) v1.2.3</h2><span id='topic+auxco'></span>

<h3>Description</h3>

<p>Berufs-Hilfsklassifikation mit Tätigkeitsbeschreibungen.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auxco
</code></pre>


<h3>Format</h3>

<p>A list with data.tables:
</p>

<dl>
<dt><code>categories</code></dt><dd><p>data.table. Main list of AuxCO categories including their descriptions etc.</p>
</dd>
<dt><code>distinctions</code></dt><dd><p>data.table. List of highly similar AuxCO categories that one may want to present to disambiguate between them.</p>
</dd>
<dt><code>followup_questions</code></dt><dd><p>data.table. Follow-up questions to specify final codings based on AuxCO categories. Includes the questions' answer options as well as information on how to encode more complex occupations which depend on multiple answers.</p>
</dd>
<dt><code>mapping_from_isco</code></dt><dd><p>data.table. Mapping from ISCO-08 categories to AuxCO categories.</p>
</dd>
<dt><code>mapping_from_kldb</code></dt><dd><p>data.table. Mapping from KldB 2010 categories to AuxCO categories.</p>
</dd>
</dl>



<h3>References</h3>

<p>Schierholz, Malte; Brenner, Lorraine; Cohausz, Lea; Damminger, Lisa; Fast, Lisa; Hörig, Ann-Kathrin; Huber, Anna-Lena; Ludwig, Theresa; Petry, Annabell; Tschischka, Laura (2018): Vorstellung einer Hilfsklassifikation mit Tätigkeitsbeschreibungen für Zwecke der Berufskodierung. (IAB-Discussion Paper, 2018), Nürnberg, 45 S. https://www.iab.de/183/section.aspx/Publikation/k180509301
</p>


<h3>See Also</h3>

<p>https://github.com/occupationMeasurement/auxiliary-classification, <code><a href="#topic+load_auxco">load_auxco()</a></code>
</p>

<hr>
<h2 id='button_next'>Go to the next page</h2><span id='topic+button_next'></span><span id='topic+button_previous'></span>

<h3>Description</h3>

<p>Buttons to navigate between pages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>button_next(label = "Weiter")

button_previous(label = "Zurück")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="button_next_+3A_label">label</code></td>
<td>
<p>What label the button should have.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>shiny Action Button
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>button_previous()</code>: Go to the previous page
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+new_page">new_page()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
very_simple_page &lt;- new_page(
  page_id = "example",
  render = function(session, run_before_output, input, output, ...) {
    list(
      shiny::tags$h1("My test page"),
      button_previous(),
      button_next()
    )
  }
)

## End(Not run)
</code></pre>

<hr>
<h2 id='check_condition'>Called internally by the shiny server.</h2><span id='topic+check_condition'></span>

<h3>Description</h3>

<p>Called internally by the shiny server.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_condition(page, session, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_condition_+3A_session">session</code></td>
<td>
<p>The shiny session</p>
</td></tr>
<tr><td><code id="check_condition_+3A_...">...</code></td>
<td>
<p>All additional arguments are passed along</p>
</td></tr>
</table>

<hr>
<h2 id='convert_suggestions'>Convert suggestion from one suggestion format into the other</h2><span id='topic+convert_suggestions'></span>

<h3>Description</h3>

<p>Convert suggestion from one suggestion format into the other
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_suggestions(suggestions, from, to, suggestion_type_options = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_suggestions_+3A_suggestions">suggestions</code></td>
<td>
<p>A data.table of suggestions as returned by one of the
prediction algorithms e.g. <code><a href="#topic+algo_similarity_based_reasoning">algo_similarity_based_reasoning()</a></code>.</p>
</td></tr>
<tr><td><code id="convert_suggestions_+3A_from">from</code></td>
<td>
<p>The current suggestion_type in which suggestions are passed.</p>
</td></tr>
<tr><td><code id="convert_suggestions_+3A_to">to</code></td>
<td>
<p>The suggestion_type in which suggestions should be.</p>
</td></tr>
<tr><td><code id="convert_suggestions_+3A_suggestion_type_options">suggestion_type_options</code></td>
<td>
<p>A list with options for generating
suggestions. Supported options:
- <code>datasets</code>: Pass specific datasets to be used whenn adding information
to predictions e.g. use a specific version of the kldb or auxco.
Supported datasets are: &quot;auxco-1.2.x&quot;, &quot;kldb-2010&quot;. By default the datasets
bundled with this package are used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.table of suggestions in the &quot;to&quot; format
</p>

<hr>
<h2 id='create_app_settings'>Create app_settings.</h2><span id='topic+create_app_settings'></span>

<h3>Description</h3>

<p>This is the primary and most convenient way of configuring the app.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_app_settings(
  save_to_file,
  suggestion_type = "auxco-1.2.x",
  default_num_suggestions = 5,
  require_respondent_id = FALSE,
  warn_before_leaving = FALSE,
  skip_followup_types = c(),
  response_output_dir = file.path("output", "responses"),
  handle_data = NULL,
  get_job_suggestion_params = NULL,
  display_page_ids = TRUE,
  default_tense = "present",
  default_extra_instructions = "on",
  verbose = TRUE,
  .validate = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_app_settings_+3A_save_to_file">save_to_file</code></td>
<td>
<p>Should responses be saved as files in
response_output_dir? Defaults to use the SAVE_TO_FILE environment variable.
We recommend setting this to TRUE.</p>
</td></tr>
<tr><td><code id="create_app_settings_+3A_suggestion_type">suggestion_type</code></td>
<td>
<p>Which type of suggestion to use / provide.
Possible options are &quot;auxco-1.2.x&quot; and &quot;kldb-2010&quot;.</p>
</td></tr>
<tr><td><code id="create_app_settings_+3A_default_num_suggestions">default_num_suggestions</code></td>
<td>
<p>The number of suggestions to generate and
display to users. Accepts all positive integers.
Defaults to 5.</p>
</td></tr>
<tr><td><code id="create_app_settings_+3A_require_respondent_id">require_respondent_id</code></td>
<td>
<p>Are respondent_ids required?
Defaults to FALSE</p>
</td></tr>
<tr><td><code id="create_app_settings_+3A_warn_before_leaving">warn_before_leaving</code></td>
<td>
<p>Should users be warned that their progress will
be lost upon leaving the site? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="create_app_settings_+3A_skip_followup_types">skip_followup_types</code></td>
<td>
<p>A vector of strings corresponding to the
question_type of followup_question that should be skipped. Allowed '
values: c(&quot;anforderungsniveau&quot;, &quot;aufsicht&quot;, &quot;spezialisierung&quot;, &quot;sonstige&quot;)</p>
</td></tr>
<tr><td><code id="create_app_settings_+3A_response_output_dir">response_output_dir</code></td>
<td>
<p>Path to the directory in which to store data
from the app. Defaults to <code style="white-space: pre;">&#8288;./output/responses/&#8288;</code>.</p>
</td></tr>
<tr><td><code id="create_app_settings_+3A_handle_data">handle_data</code></td>
<td>
<p>Callback function to handle data from the app.
This setting takes a function that get's passed 3 parameters:
table_name (A reference name indicating which data to save),
data (A dataframe of data to save), session (the user's current session).</p>
</td></tr>
<tr><td><code id="create_app_settings_+3A_get_job_suggestion_params">get_job_suggestion_params</code></td>
<td>
<p>List of parameters to pass to
get_job_suggestion. Refer to <code><a href="#topic+get_job_suggestions">get_job_suggestions()</a></code> for a list of
supported parameters. Note that the parameter aggregate_score_threshold
needs to be set on <code><a href="#topic+page_first_freetext">page_first_freetext()</a></code> or <code><a href="#topic+page_second_freetext">page_second_freetext()</a></code>.</p>
</td></tr>
<tr><td><code id="create_app_settings_+3A_display_page_ids">display_page_ids</code></td>
<td>
<p>Whether <code>page_ids</code> should be displayed within the
questionnaires.</p>
</td></tr>
<tr><td><code id="create_app_settings_+3A_default_tense">default_tense</code></td>
<td>
<p>We may not always want to ask for the current
occupation, but maybe also for the previous occupation in case of
pensioners etc. with a value of &quot;past&quot;.
Possible values are &quot;present&quot; (default), &quot;past&quot;.
This setting can be overwritten on a session-by-session basis with the
URL-Query parameter &quot;tense&quot;.</p>
</td></tr>
<tr><td><code id="create_app_settings_+3A_default_extra_instructions">default_extra_instructions</code></td>
<td>
<p>Display additional instructions for e.g.
an interviewer conducting an interview.
Possible values are &quot;on&quot; (default), &quot;off&quot;.
This setting can be overwritten on a session-by-session basis with the
URL-Query parameter &quot;extra_instructions&quot;.</p>
</td></tr>
<tr><td><code id="create_app_settings_+3A_verbose">verbose</code></td>
<td>
<p>Should additional output be printed when running?
Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="create_app_settings_+3A_.validate">.validate</code></td>
<td>
<p>Whether the created app_settings should be validated.
Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of app_settings.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

app_settings &lt;- create_app_settings(
  # Important to save results from the app
  save_to_file = TRUE,
  require_respondent_id = TRUE
)
</code></pre>

<hr>
<h2 id='execute_render'>Called internally by the shiny server.</h2><span id='topic+execute_render'></span>

<h3>Description</h3>

<p>Called internally by the shiny server.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>execute_render(page, session, run_before_output, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="execute_render_+3A_session">session</code></td>
<td>
<p>The shiny session</p>
</td></tr>
<tr><td><code id="execute_render_+3A_run_before_output">run_before_output</code></td>
<td>
<p>The output from <code>run_before</code></p>
</td></tr>
<tr><td><code id="execute_render_+3A_...">...</code></td>
<td>
<p>All additional arguments are passed along</p>
</td></tr>
</table>

<hr>
<h2 id='execute_run_after'>Called internally by the shiny server when navigating to the next page.</h2><span id='topic+execute_run_after'></span>

<h3>Description</h3>

<p>Called internally by the shiny server when navigating to the next page.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>execute_run_after(page, session, input, output, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="execute_run_after_+3A_session">session</code></td>
<td>
<p>The shiny session</p>
</td></tr>
<tr><td><code id="execute_run_after_+3A_input">input</code></td>
<td>
<p>The shiny input</p>
</td></tr>
<tr><td><code id="execute_run_after_+3A_...">...</code></td>
<td>
<p>All additional arguments are passed along</p>
</td></tr>
</table>

<hr>
<h2 id='execute_run_before'>Called internally by the shiny server.</h2><span id='topic+execute_run_before'></span>

<h3>Description</h3>

<p>Called internally by the shiny server.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>execute_run_before(page, session, input, output, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="execute_run_before_+3A_session">session</code></td>
<td>
<p>The shiny session</p>
</td></tr>
<tr><td><code id="execute_run_before_+3A_...">...</code></td>
<td>
<p>All additional arguments are passed along</p>
</td></tr>
</table>

<hr>
<h2 id='get_data'>Load a standard dataset, while supporting overriding by the user.</h2><span id='topic+get_data'></span>

<h3>Description</h3>

<p>Load a standard dataset, while supporting overriding by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_data(dataset_name, user_provided_data = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_data_+3A_dataset_name">dataset_name</code></td>
<td>
<p>Name of the dataset. Currently supported values are
&quot;auxco-1.2.x&quot;, &quot;kldb-2010&quot;, &quot;isco-08&quot;</p>
</td></tr>
<tr><td><code id="get_data_+3A_user_provided_data">user_provided_data</code></td>
<td>
<p>List of datasets provided by the user.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The requested dataset.
</p>

<hr>
<h2 id='get_final_codes'>Get the final occupation codes</h2><span id='topic+get_final_codes'></span>

<h3>Description</h3>

<p>The final occupation code will depend on the <code>suggestion_id</code> and,
possibly, on <code>followup_answers</code>, depending on the <code>suggestion_id</code> provided. See
<code>occupationMeasurement::auxco$followup_questions</code> for a list of suggestion_ids (=auxco_id)
and their respective recommended follow-up questions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_final_codes(
  suggestion_id,
  followup_answers = list(),
  standardized_answer_levels = NULL,
  approximate_standardized_answer_levels = TRUE,
  code_type = c("isco_08", "kldb_10"),
  verbose = TRUE,
  suggestion_type = "auxco-1.2.x",
  suggestion_type_options = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_final_codes_+3A_suggestion_id">suggestion_id</code></td>
<td>
<p>Id of the suggestion</p>
</td></tr>
<tr><td><code id="get_final_codes_+3A_followup_answers">followup_answers</code></td>
<td>
<p>A named list of the question_ids with their
respective answers to the followup_questions.
Question ids correspond to list names, answers correspond to list values.</p>
</td></tr>
<tr><td><code id="get_final_codes_+3A_standardized_answer_levels">standardized_answer_levels</code></td>
<td>
<p>A named list of standardized isco
answer levels. Names in the list correspond to the type of isco standard,
values correspond to the level itself.
Possible standardized answer types are: &quot;isco_skill_level&quot; and
&quot;isco_supervisor_manager&quot;.
These can be used instead of some followup questions if
the information is available already from a different source.
Please note that standardized answer levels are <em>not</em> available for all
question types. For a list of options please take a look at the
followup questions included in the auxco for example via
<code>occupationMeasurement::auxco$followup_questions</code>.</p>
</td></tr>
<tr><td><code id="get_final_codes_+3A_approximate_standardized_answer_levels">approximate_standardized_answer_levels</code></td>
<td>
<p>(default TRUE) Follow up
questions were designed to provide answer options that are not in conflict with suggestion_id.
standardized_answer_levels can be in conflict with suggestion_id, and then no exact matches
exist. With approximation, the answer option that is closest to the
standardized_answer_levels provided, will be used.</p>
</td></tr>
<tr><td><code id="get_final_codes_+3A_code_type">code_type</code></td>
<td>
<p>Which type of codes should be returned.
Multiple codes can be returned at the same time.
Supported types of codes are &quot;isco_08&quot; and &quot;kldb_10&quot;.
Defaults to &quot;isco_08&quot; and &quot;kldb_10&quot;.</p>
</td></tr>
<tr><td><code id="get_final_codes_+3A_verbose">verbose</code></td>
<td>
<p>(default TRUE) whether to return a <code>message</code> or not, detailing potential issues with the input provided.</p>
</td></tr>
<tr><td><code id="get_final_codes_+3A_suggestion_type">suggestion_type</code></td>
<td>
<p>Which suggestion type is being used.
Only auxco-based suggestion_types are supported.</p>
</td></tr>
<tr><td><code id="get_final_codes_+3A_suggestion_type_options">suggestion_type_options</code></td>
<td>
<p>A list with options for generating
suggestions. Supported options:
- <code>datasets</code>: Pass specific datasets to be used whenn adding information
to predictions e.g. use a specific version of the kldb or auxco.
Supported datasets are: &quot;auxco-1.2.x&quot;, &quot;kldb-2010&quot;. By default the datasets
bundled with this package are used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The interview situation may not allow to ask these follow-up questions. Some default, but
suboptimal occupation code is returned if <code>followup_answers</code> is missing.
</p>
<p>If <code>followup_answers</code> is missing or incomplete, one may wish to insert/infer the missing information
by using <code>standardized_answer_levels</code>.
</p>


<h3>Value</h3>

<p>A named list corresponding to the code_type(s) specified. Includes a <code>message</code> if <code>verbose = TRUE</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
get_final_codes(
  # Führungsaufgaben mit Personalverantwortung  bei der Lebensmittelherstellung
  "9076",
  followup_answers = list(
    # The first answer option in the first followup question
    "Q9076_1" = 2
  )
)

# The same, but using standardized answer levels
get_final_codes(
  # Führungsaufgaben mit Personalverantwortung  bei der Lebensmittelherstellung
  "9076",
  standardized_answer_levels = list(
    # A response corresponding to the standard ISCO Level "supervisor"
    "isco_supervisor_manager" = "isco_supervisor"
  )
)

# Same example with approximate matching, due to conflicting information:
# External data suggest the person is not a supervisor, but the person still
# says she does supervisory tasks (Führungsaufgaben, as encoded in "9076").
# If approximate_standardized_answer_levels = TRUE (the default), the
# selected answer "9076" trumps the external data and we will code this
# person as a supervisor.
get_final_codes(
  # Führungsaufgaben mit Personalverantwortung  bei der Lebensmittelherstellung
  "9076",
  standardized_answer_levels = list(
    # A response corresponding to the standard ISCO Level "not manager nor supervisor"
    "isco_supervisor_manager" = "isco_not_supervising"
  )
)

## End(Not run)
</code></pre>

<hr>
<h2 id='get_followup_questions'>Get potential follow-up questions for a suggestion.</h2><span id='topic+get_followup_questions'></span>

<h3>Description</h3>

<p>Get potential follow-up questions for a suggestion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_followup_questions(
  suggestion_id,
  tense = "present",
  suggestion_type = "auxco-1.2.x",
  suggestion_type_options = list(),
  include_answer_codes = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_followup_questions_+3A_suggestion_id">suggestion_id</code></td>
<td>
<p>Id of the suggestion</p>
</td></tr>
<tr><td><code id="get_followup_questions_+3A_tense">tense</code></td>
<td>
<p>Which tense i.e. time to use for questions &amp; answers,
this can be &quot;present&quot; or &quot;past&quot;. Defaults to &quot;present&quot;.</p>
</td></tr>
<tr><td><code id="get_followup_questions_+3A_suggestion_type">suggestion_type</code></td>
<td>
<p>Which suggestion type is being used.
Only auxco-based suggestion_types are supported.</p>
</td></tr>
<tr><td><code id="get_followup_questions_+3A_suggestion_type_options">suggestion_type_options</code></td>
<td>
<p>A list with options for generating
suggestions. Supported options:
- <code>datasets</code>: Pass specific datasets to be used whenn adding information
to predictions e.g. use a specific version of the kldb or auxco.
Supported datasets are: &quot;auxco-1.2.x&quot;, &quot;kldb-2010&quot;. By default the datasets
bundled with this package are used.</p>
</td></tr>
<tr><td><code id="get_followup_questions_+3A_include_answer_codes">include_answer_codes</code></td>
<td>
<p>Whether answer options should contain
information on the associated codes. Defaults to FALSE.
(Only for internal use, use <code><a href="#topic+get_final_codes">get_final_codes()</a></code> to get codes)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of followup questions and their answer options.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
# Get followup questions for "Post- und Zustelldienste"
get_followup_questions("1004")

## End(Not run)
</code></pre>

<hr>
<h2 id='get_item_data'>Retrieve data for an item.</h2><span id='topic+get_item_data'></span>

<h3>Description</h3>

<p>Each page in the questionnaire can have multiple items on it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_item_data(
  session,
  page_id,
  item_id = NULL,
  key = c("all", "question_text", "response_text", "response_id"),
  default = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_item_data_+3A_session">session</code></td>
<td>
<p>The shiny session</p>
</td></tr>
<tr><td><code id="get_item_data_+3A_page_id">page_id</code></td>
<td>
<p>The page for which to retrieve data.</p>
</td></tr>
<tr><td><code id="get_item_data_+3A_item_id">item_id</code></td>
<td>
<p>The item for which to retrieve data.
This <em>has</em> to be different for different items on the same page.
Since most pages contain only a single question/item, <code>item_id</code> is set to &quot;default&quot; if missing.</p>
</td></tr>
<tr><td><code id="get_item_data_+3A_key">key</code></td>
<td>
<p>The key for which to retrieve a value. (Optional)
If no key is provided, the items's whole data will be returned.</p>
</td></tr>
<tr><td><code id="get_item_data_+3A_default">default</code></td>
<td>
<p>A default value to return if the key or page is not
present in the questionnaire data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The items's data.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+set_item_data">set_item_data()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
# Set up a "fake" shiny session to store data
session &lt;- shiny::MockShinySession$new()
session$userData &lt;- list(
  current_page_id = "other_page",
  questionnaire_data = list(
    example_page = list()
  )
)

# This code is expected to be run in e.g. run_before or run_after
# It doesn't really make sense to run this code outside
set_item_data(
  session = session,
  page_id = "example_page",
  question_text = "How are you?"
)

# This code is expected to be run in e.g. run_before
get_item_data(
  session = session,
  page_id = "example_page"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='get_job_suggestions'>Make coding suggestions based on a user's open-ended text input.</h2><span id='topic+get_job_suggestions'></span>

<h3>Description</h3>

<p>Given a <code>text</code> input, find up to <code>num_suggestions</code> possible occupation categories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_job_suggestions(
  text,
  suggestion_type = "auxco-1.2.x",
  num_suggestions = 5,
  suggestion_type_options = list(),
  aggregate_score_threshold = 0.02,
  item_score_threshold = 0,
  distinctions = TRUE,
  steps = list(simbased_wordwise = list(algorithm = algo_similarity_based_reasoning,
    parameters = list(sim_name = "wordwise")), simbased_substring = list(algorithm =
    algo_similarity_based_reasoning, parameters = list(sim_name = "substring"))),
  include_general_id = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_job_suggestions_+3A_text">text</code></td>
<td>
<p>The raw text input from the user.</p>
</td></tr>
<tr><td><code id="get_job_suggestions_+3A_suggestion_type">suggestion_type</code></td>
<td>
<p>Which type of suggestion to use / provide.
Possible options are &quot;auxco-1.2.x&quot; and &quot;kldb-2010&quot;.</p>
</td></tr>
<tr><td><code id="get_job_suggestions_+3A_num_suggestions">num_suggestions</code></td>
<td>
<p>The maximum number of suggestions to show.
This is an upper bound and less suggestions may be returned.
Defaults to 5.</p>
</td></tr>
<tr><td><code id="get_job_suggestions_+3A_suggestion_type_options">suggestion_type_options</code></td>
<td>
<p>A list with options for generating
suggestions. Supported options:
- <code>datasets</code>: Pass specific datasets to be used whenn adding information
to predictions e.g. use a specific version of the kldb or auxco.
Supported datasets are: &quot;auxco-1.2.x&quot;, &quot;kldb-2010&quot;. By default the datasets
bundled with this package are used.</p>
</td></tr>
<tr><td><code id="get_job_suggestions_+3A_aggregate_score_threshold">aggregate_score_threshold</code></td>
<td>
<p>A single value or named list of thresholds
between 0 and 1. If it is a list, each entry should correspond to one of
the <code>steps</code>. If it is a single value, it will apply to all steps.
Results from that step will only be returned if the sum of
their scores is equal to or greater than the specified threshold. With a
aggregate_score_threshold of 0 results will always be returned
(if there are any).</p>
</td></tr>
<tr><td><code id="get_job_suggestions_+3A_item_score_threshold">item_score_threshold</code></td>
<td>
<p>A threshold between 0 and 1 (usually
very small, default 0). Results from any step will only be returned if they
are greater than the specified threshold. Allows the removal of highly
implausible suggestions.</p>
</td></tr>
<tr><td><code id="get_job_suggestions_+3A_distinctions">distinctions</code></td>
<td>
<p>Whether or not to add additional distinctions to
similar occupational categories to the source code.
Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="get_job_suggestions_+3A_steps">steps</code></td>
<td>
<p>A list with the algorithms to use and their parameters. Each
entry of the list should contain a nested list with two entries:
algorithm (the algorithm's function itself) and parameters (the parameters
to pass onto the algorithm). Each algorithm will also always have access
to a default set of three parameters:
</p>

<ul>
<li><p> text_processed: The input text after preprocessing
</p>
</li>
<li><p> suggestion_type: Which type of suggestion to output
</p>
</li>
<li><p> num_suggestions: How many suggestions shall be returned
These parameters must not be specified manually and will be provided
automatically instead.
Defaults to:
</p>
</li></ul>

<div class="sourceCode"><pre>list(
  # try similarity "one word at most 1 letter different" first
  list(
    algorithm = algo_similarity_based_reasoning,
    parameters = list(
      sim_name = "wordwise",
      min_aggregate_prob = 0.535
    )
  ),
  # since everything else failed, try "substring" similarity
  list(
    algorithm = algo_similarity_based_reasoning,
    parameters = list(
      sim_name = "substring",
      min_aggregate_prob = 0.02
    )
  )
)
</pre></div></td></tr>
<tr><td><code id="get_job_suggestions_+3A_include_general_id">include_general_id</code></td>
<td>
<p>Whether a general column, called &quot;id&quot; should always
be returned. This will automatically contain the appropriate id for
different suggestion_types i.e. for &quot;auxco-1-2.x&quot; it will contain the same
data as the column &quot;auxco_id&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The procedure implemented here is, roughly speaking, as follows:
</p>

<ol>
<li><p> Predict categories from KldB 2010, including their scores. The first algorithm mentioned in <code>steps</code> is used (default: <code><a href="#topic+algo_similarity_based_reasoning">algo_similarity_based_reasoning()</a></code>).
</p>
</li>
<li><p> Convert the predicted KldB 2010 categories to <code>suggestion_type</code> (default: <code style="white-space: pre;">&#8288;auxco-1.2.x&#8288;</code>, an n:m mapping, scores are mapped accordingly.). See internal function <code>convert_suggestions()</code> for details.
</p>
</li>
<li><p> Remove predicted categories if their score is below <code>item_score_threshold</code> and only keep the <code>num_suggestions</code> top-ranked suggestions.
</p>
</li>
<li><p> Start anew, trying the next algorithm in <code>steps</code>, if the the top-ranked suggestions have a low chance to be correct. (Technically, this happens if the summed score of the <code>num_suggestions</code> top-ranked suggestions is below <code>aggregate_score_threshold</code>.)
</p>
</li>
<li><p> If <code>suggestion_type == "auxco-1.2.x"</code> and <code>distinctions == TRUE</code>, insert additional and (highly) similar categories or replace existing ones. See internal function <code>add_distinctions_auxco()</code>. Reorder and keep only the <code>num_suggestions</code> top-ranked suggestions. Auxco categories which were added during this step can be identified by their scores: It equals 0.05 for categories with high similarity and 0.005 for categories with medium similarity.
</p>
</li></ol>



<h3>Value</h3>

<p>A data.table with suggestions or NULL if no suggestions were found.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
if (interactive()) {
  get_job_suggestions("Koch")
}

if (interactive()) {
  get_job_suggestions("Schlosser")
}

## End(Not run)
</code></pre>

<hr>
<h2 id='get_page_data'>Get questionnaire / page data.</h2><span id='topic+get_page_data'></span>

<h3>Description</h3>

<p>Note that page data is <em>not</em> automatically saved and you probably want
to use page$get_item_data instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_page_data(session, page_id, key = NULL, default = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_page_data_+3A_session">session</code></td>
<td>
<p>The shiny session</p>
</td></tr>
<tr><td><code id="get_page_data_+3A_page_id">page_id</code></td>
<td>
<p>The page for which to retrieve data.
Defaults to the page where data the function is being called from.</p>
</td></tr>
<tr><td><code id="get_page_data_+3A_key">key</code></td>
<td>
<p>The key for which to retrieve a value. (Optional)
If no key is provided, the page's whole data will be returned.</p>
</td></tr>
<tr><td><code id="get_page_data_+3A_default">default</code></td>
<td>
<p>A default value to return if the key or page is not
present in the questionnaire data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The page data value at the provided key or the whole page's data
if no key is provided.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_item_data">get_item_data()</a></code>
</p>

<hr>
<h2 id='get_responses'>Convenience function to aggregate all saved results_overview files.</h2><span id='topic+get_responses'></span>

<h3>Description</h3>

<p>Expects data to be saved as files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_responses(app_settings = create_app_settings(save_to_file = TRUE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_responses_+3A_app_settings">app_settings</code></td>
<td>
<p>The app_settings configuration, should be the same as
used in <code><a href="#topic+app">app()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A combined data.table of user data (based on results_overview) or
NULL if there are no files.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
app_settings &lt;- create_app_settings(save_to_file = TRUE)
if (interactive()) {
  get_responses(app_settings = app_settings)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='get_suggestion_info'>Get additional information for a suggestion id.</h2><span id='topic+get_suggestion_info'></span>

<h3>Description</h3>

<p>This includes a descriptive title, job descriptions etc.
To retrieve information regarding followup questions use
<a href="#topic+get_followup_questions">get_followup_questions</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_suggestion_info(
  suggestion_ids,
  suggestion_type = "auxco-1.2.x",
  suggestion_type_options = list(),
  include_default_codes = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_suggestion_info_+3A_suggestion_ids">suggestion_ids</code></td>
<td>
<p>Suggestion id(s) to retrieve information for.
This should typically be a character vector.</p>
</td></tr>
<tr><td><code id="get_suggestion_info_+3A_suggestion_type">suggestion_type</code></td>
<td>
<p>Which suggestion type is being used.
Only auxco-based suggestion_types are supported.</p>
</td></tr>
<tr><td><code id="get_suggestion_info_+3A_suggestion_type_options">suggestion_type_options</code></td>
<td>
<p>A list with options for generating
suggestions. Supported options:
- <code>datasets</code>: Pass specific datasets to be used whenn adding information
to predictions e.g. use a specific version of the kldb or auxco.
Supported datasets are: &quot;auxco-1.2.x&quot;, &quot;kldb-2010&quot;. By default the datasets
bundled with this package are used.</p>
</td></tr>
<tr><td><code id="get_suggestion_info_+3A_include_default_codes">include_default_codes</code></td>
<td>
<p>Whether default id encodings should be returned
with the rest of infromation e.g. KldB-IDs. Defaults to FALSE.
(Only for internal use, use <code><a href="#topic+get_final_codes">get_final_codes()</a></code> to get codes)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data table with information about the suggestion.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
get_suggestion_info("9079")

## End(Not run)
</code></pre>

<hr>
<h2 id='isco_08_en'>Categories of the The International Standard Classification of Occupations - ISCO-08</h2><span id='topic+isco_08_en'></span>

<h3>Description</h3>

<p>Categories from the International Standard Classification of Occupations - ISCO-08. ISCO-08 is a hierarchical classification, consisting of 10 (1-digit) major groups, 43 (2-digit) sub-major groups, 130 (3-digit) minor groups, and 436 (4-digit) unit groups, all of them included in this data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isco_08_en
</code></pre>


<h3>Format</h3>

<p>A data frame with 619 rows and 3 variables:
</p>

<dl>
<dt><code>code</code></dt><dd><p>character. Unique ISCO-08 identifier / code.</p>
</dd>
<dt><code>label</code></dt><dd><p>character. Short label / title for the category.</p>
</dd>
<dt><code>description</code></dt><dd><p>character. Detailed description of the category.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Source: https://esco.ec.europa.eu
This service uses the ESCO classification of the European Commission. The descriptions used here are taken from the ESCO classification (v1.1, Occupations pillar) of the European Commission, which is based on ISCO-08.
</p>
<p>More information on the ISCO-08: https://isco-ilo.netlify.app/en/isco-08/, https://www.ilo.org/public/english/bureau/stat/isco/isco08/
</p>

<hr>
<h2 id='leaving_page_backwards'>Called internally by the shiny server when navigating to the previous page.</h2><span id='topic+leaving_page_backwards'></span>

<h3>Description</h3>

<p>Called internally by the shiny server when navigating to the previous page.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>leaving_page_backwards(page, session, input, output, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="leaving_page_backwards_+3A_session">session</code></td>
<td>
<p>The shiny session</p>
</td></tr>
<tr><td><code id="leaving_page_backwards_+3A_input">input</code></td>
<td>
<p>The shiny input</p>
</td></tr>
<tr><td><code id="leaving_page_backwards_+3A_...">...</code></td>
<td>
<p>All additional arguments are passed along</p>
</td></tr>
</table>

<hr>
<h2 id='load_auxco'>Load AuxCO from a directory of CSV files</h2><span id='topic+load_auxco'></span>

<h3>Description</h3>

<p>This function loads the Auxiliary Classification of Occupations (AuxCO) by
reading CSVs from the specified directory, while loading e.g. ids in the
correct format. Data is loaded into a named list matching the format
expected by other functions in this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_auxco(dir, add_explanations = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_auxco_+3A_dir">dir</code></td>
<td>
<p>The path to the directory which holds the CSVs.</p>
</td></tr>
<tr><td><code id="load_auxco_+3A_add_explanations">add_explanations</code></td>
<td>
<p>Whether explanations should be added to some of the
harder to understand task descriptions. Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This package also includes an already loaded version of the <a href="#topic+auxco">auxco</a>, which
can be used straight away <em>without</em> calling this function.
</p>


<h3>Value</h3>

<p>A list with multiple data.tables.
</p>


<h3>See Also</h3>

<p>https://github.com/occupationMeasurement/auxiliary-classification, <a href="#topic+auxco">auxco</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
# This function expects the CSV files from
# https://github.com/occupationMeasurement/auxiliary-classification/releases/
# to be there.
path_to_auxco &lt;- "auxco"
if (dir.exists(path_to_auxco)) {
  load_auxco(path_to_auxco)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='load_kldb_raw'>Clean &amp; Load KldB 2010 dataset.</h2><span id='topic+load_kldb_raw'></span><span id='topic+load_kldb'></span>

<h3>Description</h3>

<p>Use load_kldb_raw() to load the whole dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_kldb_raw(
  cache_dir = getOption("occupationMeasurement.cache_dir", tempdir())
)

load_kldb(cache_dir = getOption("occupationMeasurement.cache_dir", tempdir()))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_kldb_raw_+3A_cache_dir">cache_dir</code></td>
<td>
<p>The path to the directory where the downloaded data should be stored.
We recommend setting this to &quot;cache&quot; to store data in the working directory. This
will prevent reloading the data time and time again. This can be set globally via
<code>options(occupationMeasurement.cache_dir = "cache")</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Source: https://www.klassifikationsserver.de/klassService/index.jsp?variant=kldb2010
</p>
<p>More information on the KldB 2010: https://statistik.arbeitsagentur.de/DE/Navigation/Grundlagen/Klassifikationen/Klassifikation-der-Berufe/KldB2010-Fassung2020/KldB2010-Fassung2020-Nav.html The KldB 2010 has been revised in 2020. These changes have not been implemented here yet.
</p>


<h3>Value</h3>

<p>A cleaned / slimmed version of the KldB 2010.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>load_kldb_raw()</code>: Load raw KldB 2010 dataset.
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
# We recommend using a non-temporary directory for caching, so data is
# downloaded only once and not time and time again
cache_dir &lt;- tempdir()
# Note: The dataset will be downloaded from the internet
# Load the cleaned dataset
load_kldb(cache_dir = cache_dir)
# Load the raw dataset
load_kldb_raw(cache_dir = cache_dir)

## End(Not run)
</code></pre>

<hr>
<h2 id='new_page'>Create a new questionnaire page.</h2><span id='topic+new_page'></span>

<h3>Description</h3>

<p>Each page corresponds to a page within the app/questionnaire.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_page(
  page_id,
  render,
  condition = NULL,
  run_before = NULL,
  render_before = NULL,
  render_after = NULL,
  run_after = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_page_+3A_page_id">page_id</code></td>
<td>
<p>A unique string identifiying this page. (Required)
This will be used to store data.</p>
</td></tr>
<tr><td><code id="new_page_+3A_render">render</code></td>
<td>
<p>Function to render the page. (Required)
It is expected, that the function returns a list of shiny tags.
Its output will be combined with <code>render_before</code> and <code>render_after.</code>
This function has access to the shiny <code>session</code> and the <code>run_before_output.</code></p>
</td></tr>
<tr><td><code id="new_page_+3A_condition">condition</code></td>
<td>
<p>Function to check whether the page should be shown.
When this function returns <code>TRUE</code>, the page will be shown upon navigating
there, if it returns <code>FALSE</code> it will be skipped.
Defaults to show the page.
This function has access to the shiny <code>session</code>.</p>
</td></tr>
<tr><td><code id="new_page_+3A_run_before">run_before</code></td>
<td>
<p>Function that prepares data to render the page.
Called immediately after condition (if <code>condition</code> returned <code>TRUE</code>).
Whatever run_before returns is available in render, render_before and
render_after as <code>run_before_output</code>.
This function has access to the shiny <code>session</code>.</p>
</td></tr>
<tr><td><code id="new_page_+3A_render_before">render_before</code></td>
<td>
<p>Called exactly like <code>render</code>. Output will be added
just <em>before</em> the output from render. Mainly used to add additional
outputs to existing pages.</p>
</td></tr>
<tr><td><code id="new_page_+3A_render_after">render_after</code></td>
<td>
<p>Called exactly like <code>render</code>. Output will be added
just <em>after</em> the output from render. Mainly used to add additional
outputs to existing pages.</p>
</td></tr>
<tr><td><code id="new_page_+3A_run_after">run_after</code></td>
<td>
<p>Function that handles the user input when they leave the
page. This function has access to the shiny session and shiny input.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Pages are rendered by calling the different life-cycle functions one
after another. The order in which they are called is as follows:
</p>

<ol>
<li> <p><code>condition</code> (<code>session</code>)
Only if this evaluated to <code>TRUE</code>, continue.
</p>
</li>
<li> <p><code>run_before</code> (<code>session</code>)
</p>
</li>
<li> <p><code>render_before</code> (<code>session</code>, <code>run_before_output</code>, <code>input</code>, <code>output</code>)
</p>
</li>
<li> <p><code>render</code> (<code>session</code>, <code>run_before_output</code>, <code>input</code>, <code>output</code>)
</p>
</li>
<li> <p><code>render_after</code> (<code>session</code>, <code>run_before_output</code>, <code>input</code>, <code>output</code>)
The outputs from <code>render_before</code>, <code>render</code> &amp; <code>render_after</code> are
stitched together to produce the final HTML output of the page.
</p>
</li>
<li> <p><code>run_after</code> (<code>session</code>, <code>input</code>, <code>output</code>)
Run when the user leaves the page (=clicks the next button). Any
user input has to be handled here. For each question asked, one will
typically call <code><a href="#topic+set_item_data">set_item_data()</a></code> to save the collected data
internally.
</p>
</li></ol>

<p>Each of the life-cycle functions above is annotated with the
paramaters it has access to. <code>session</code>, <code>input</code> and <code>output</code> are
passed directly from shiny and correspond to the objects made available by
<code><a href="shiny.html#topic+shinyServer">shiny::shinyServer()</a></code>, <code>run_before_output</code> is available for convenience and
corresponds to whatever is returned by <code>run_before</code>.
</p>
<p>Some side-effects occur:
</p>

<ul>
<li> <p><code>occupationMeasurement:::init_page_data</code> is called before 1. <code>run_before</code>.
It sets up an internal representation of the page data to be saved.
</p>
</li>
<li> <p><code>occupationMeasurement:::finalize_data</code> is called before 6. <code>run_before</code>.
</p>
</li>
<li> <p><code>occupationMeasurement:::save_page_data</code> is called after 6. <code>run_before</code>.
It saves the responses on a hard drive, i.e. it appends the responses
from this page to <code>table_name == "answers"</code>. See the vignette
and <code><a href="#topic+create_app_settings">create_app_settings()</a></code> for details.
</p>
</li></ul>

<p>Use of <code>render_before</code>, <code>render_after</code> is discouraged if not necessary,
as these two life-cycle functions have only been added to allow for easier
modification and extension of existing pages.
</p>


<h3>Value</h3>

<p>A new <code>page</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
very_simple_page &lt;- new_page(
  page_id = "example",
  render = function(session, run_before_output, input, output, ...) {
    list(
      shiny::tags$h1("My test page"),
      button_previous(),
      button_next()
    )
  }
)

# Example where we also save some data
page_that_saves_two_items &lt;- new_page(
  page_id = "questions_1_and_2",
  render = function(session, run_before_output, page, input, output, ...) {
    list(
      shiny::tags$h1("Questions"),
      shiny::textAreaInput(
        inputId = "day_freetext",
        label = "How was your day? Please give a detailed answer.",
        value = get_item_data(
          session = session, page_id = page$page_id,
          item_id = "day_freetext",
          key = "response_text"
        )
      ),
      shiny::tags$p("How would you rate your day? On a scale of 1 - 4"),
      radioButtons(
        inputId = "day_radio",
        label = NULL,
        width = "100%",
        choices = list(One = 1, Two = 2, Three = 3, Four = 4),
        selected = get_item_data(
          session = session,
          page_id = page$page_id,
          item_id = "day_radio",
          key = "response_id",
          default = character(0)
        )
      ),
      button_previous(),
      button_next()
    )
  },
  run_after = function(session, page, input, ...) {
    set_item_data(
      session = session,
      page_id = page$page_id,
      item_id = "day_freetext",
      response_text = input$day_freetext
    )
    set_item_data(
      session = session,
      page_id = page$page_id,
      item_id = "day_radio",
      response_id = input$day_radio
    )
  }
)

questionnaire_that_saves_two_items &lt;- list(
  page_that_saves_two_items,
  # So we have a next page to go to
  very_simple_page
)

if (interactive()) {
  app(questionnaire = questionnaire_that_saves_two_items)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='page_choose_one_option'>Show a page with multiple radio button options where once can be picked.</h2><span id='topic+page_choose_one_option'></span>

<h3>Description</h3>

<p>Show a page with multiple radio button options where once can be picked.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>page_choose_one_option(
  page_id,
  question_text = "Please pick one of the following options",
  list_of_choices = list(One = 1, Two = 2, Three = 3),
  choice_labels = NULL,
  next_button = TRUE,
  previous_button = TRUE,
  run_before = NULL,
  run_after = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="page_choose_one_option_+3A_page_id">page_id</code></td>
<td>
<p>A unique string identifiying this page. Used to store data.</p>
</td></tr>
<tr><td><code id="page_choose_one_option_+3A_question_text">question_text</code></td>
<td>
<p>The question / text to display.
This can be either a string, which will simply be displayed or a function
to dynamically determine the question_text.</p>
</td></tr>
<tr><td><code id="page_choose_one_option_+3A_list_of_choices">list_of_choices</code></td>
<td>
<p>A list of answering options.
This can either be just a simple list of values or a named list with the
names corresponding to what the user sees and the values corresponding to
the actually saved values.
e.g. with <code>list(One = 1, Two = 2, Three = 3)</code> people will see One, Two, ...
and numbers 1, 2, ... will be saved under <code>response_id</code>.
If you want to use more complex choice names than jsut strings (i.e. HTML),
you can also use the choice_labels option for that.</p>
</td></tr>
<tr><td><code id="page_choose_one_option_+3A_choice_labels">choice_labels</code></td>
<td>
<p>List or vector of only the choice names to be shown.
This has to be matched by an equal-length vector in list_of_choices.</p>
</td></tr>
<tr><td><code id="page_choose_one_option_+3A_next_button">next_button</code></td>
<td>
<p>Whether to show the button to navigate to the next page?
Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="page_choose_one_option_+3A_previous_button">previous_button</code></td>
<td>
<p>Whether to show the button to navigate to the preivous page?
Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="page_choose_one_option_+3A_run_before">run_before</code></td>
<td>
<p>Similar to <code>run_before</code> in <code>new_page()</code>, passed explicitly
here as this page adds some of its own code to <code>run_before</code>.</p>
</td></tr>
<tr><td><code id="page_choose_one_option_+3A_run_after">run_after</code></td>
<td>
<p>Similar to <code>run_after</code> in <code>new_page()</code>, passed explicitly
here as this page adds some of its own code to <code>run_after</code>.</p>
</td></tr>
<tr><td><code id="page_choose_one_option_+3A_...">...</code></td>
<td>
<p>Other parametrs are passed on to <code>new_page()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A page object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+new_page">new_page()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
one_page_questionnaire &lt;- list(
  page_choose_one_option(
    "test_page_radio",
    question_text = "Hello there! Please pick your favorite number from the options below:",
    list_of_choices = list(One = 1, Two = 2, Three = 3)
  ),
  page_final()
)
if (interactive()) {
  app(questionnaire = one_page_questionnaire)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='page_feedback'>Page to receive feedback on how well the chosen suggestion fits</h2><span id='topic+page_feedback'></span>

<h3>Description</h3>

<p>Page to receive feedback on how well the chosen suggestion fits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>page_feedback(is_interview = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="page_feedback_+3A_is_interview">is_interview</code></td>
<td>
<p>Should the page show slightly different / additional
instructions and answer options for an interview that is conducted by
another person? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="page_feedback_+3A_...">...</code></td>
<td>
<p>All additional parameters are passed first passed on to
<code><a href="#topic+page_choose_one_option">page_choose_one_option()</a></code> and then <code><a href="#topic+new_page">new_page()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A page object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
my_questionnaire &lt;- list(
  page_first_freetext(),
  page_select_suggestion(),
  page_feedback()
)
if (interactive()) {
  app(questionnaire = my_questionnaire)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='page_final'>A final page, showing instructions to close the window.</h2><span id='topic+page_final'></span>

<h3>Description</h3>

<p>This page saves data in results_overview and marks the questionnaire as
complete.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>page_final(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="page_final_+3A_...">...</code></td>
<td>
<p>All additional parameters are passed to <code><a href="#topic+new_page">new_page()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A page object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+new_page">new_page()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
my_questionnaire &lt;- list(
  page_final()
)
if (interactive()) {
  app(questionnaire = my_questionnaire)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='page_first_freetext'>The first freetext question to show.</h2><span id='topic+page_first_freetext'></span>

<h3>Description</h3>

<p>Here, the description of the job can be entered in an open freetext field
and suggestions will be generated based on the input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>page_first_freetext(
  is_interview = FALSE,
  aggregate_score_threshold = 0.535,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="page_first_freetext_+3A_is_interview">is_interview</code></td>
<td>
<p>Should the page show slightly different / additional
instructions and answer options for an interview that is conducted by
another person? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="page_first_freetext_+3A_aggregate_score_threshold">aggregate_score_threshold</code></td>
<td>
<p>The total sum of the scores of the
suggestions has to be higher than this threshold for suggestions to be
shown. The parameter is passed on to <code><a href="#topic+get_job_suggestions">get_job_suggestions()</a></code>.</p>
</td></tr>
<tr><td><code id="page_first_freetext_+3A_...">...</code></td>
<td>
<p>All additional parameters are passed to <code><a href="#topic+new_page">new_page()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A page object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+new_page">new_page()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
my_questionnaire &lt;- list(
  page_first_freetext(),
  page_second_freetext(),
  page_select_suggestion(),
  page_none_selected_freetext(),
  page_followup(1),
  page_followup(2)
)
if (interactive()) {
  app(questionnaire = my_questionnaire)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='page_followup'>Show potential followup questions to the user.</h2><span id='topic+page_followup'></span>

<h3>Description</h3>

<p>To disambiguate between similar occupations. Depending on the suggestion,
multiple followup questions can be shown.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>page_followup(index, is_interview = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="page_followup_+3A_index">index</code></td>
<td>
<p>The index of the followup question (1-based).
To show the first followup question (if there are any) use
page_followup(index = 1), to show a potential second followup question use
page_followup(index = 2).
For example <code><a href="#topic+questionnaire_web_survey">questionnaire_web_survey()</a></code> uses
<code style="white-space: pre;">&#8288;..., page_followup(index = 1), page_followup(index = 2), ...&#8288;</code></p>
</td></tr>
<tr><td><code id="page_followup_+3A_is_interview">is_interview</code></td>
<td>
<p>Should the page show slightly different / additional
instructions and answer options for an interview that is conducted by
another person? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="page_followup_+3A_...">...</code></td>
<td>
<p>All additional parameters are passed to <code><a href="#topic+new_page">new_page()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A page object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+new_page">new_page()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
my_questionnaire &lt;- list(
  page_first_freetext(),
  page_second_freetext(),
  page_select_suggestion(),
  page_none_selected_freetext(),
  page_followup(1),
  page_followup(2)
)
if (interactive()) {
  app(questionnaire = my_questionnaire)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='page_freetext'>Show a page with a text field where free text can be entered.</h2><span id='topic+page_freetext'></span>

<h3>Description</h3>

<p>Show a page with a text field where free text can be entered.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>page_freetext(
  page_id,
  question_text = "Please enter your answer in the box below",
  is_interview = FALSE,
  no_answer_checkbox = TRUE,
  next_button = TRUE,
  previous_button = TRUE,
  trigger_next_on_enter = TRUE,
  render_question_text = TRUE,
  run_before = NULL,
  run_after = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="page_freetext_+3A_page_id">page_id</code></td>
<td>
<p>A unique string identifiying this page. Used to store data.</p>
</td></tr>
<tr><td><code id="page_freetext_+3A_question_text">question_text</code></td>
<td>
<p>The question / text to display.
This can be either a string, which will simply be displayed or a function
to dynamically determine the question_text.</p>
</td></tr>
<tr><td><code id="page_freetext_+3A_is_interview">is_interview</code></td>
<td>
<p>Should the page show slightly different / additional
instructions and answer options for an interview that is conducted by
another person? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="page_freetext_+3A_no_answer_checkbox">no_answer_checkbox</code></td>
<td>
<p>Whether to provide a checkbox to denote that no
answer has been provided.</p>
</td></tr>
<tr><td><code id="page_freetext_+3A_next_button">next_button</code></td>
<td>
<p>Whether to show the button to navigate to the next page?
Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="page_freetext_+3A_previous_button">previous_button</code></td>
<td>
<p>Whether to show the button to navigate to the preivous page?
Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="page_freetext_+3A_trigger_next_on_enter">trigger_next_on_enter</code></td>
<td>
<p>Whether the next button is triggered
when one presses enter. Defaults to TRUE. There are known issues with IE11.</p>
</td></tr>
<tr><td><code id="page_freetext_+3A_render_question_text">render_question_text</code></td>
<td>
<p>Whether the question text should be displayed?
Only set this to FALSE, if you wish to change the rendering of the
question_text by e.g. using <code>render_before</code>.
Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="page_freetext_+3A_run_before">run_before</code></td>
<td>
<p>Similar to <code>run_before</code> in <code>new_page()</code>, passed explicitly
here as this page adds some of its own code to <code>run_before</code>.</p>
</td></tr>
<tr><td><code id="page_freetext_+3A_run_after">run_after</code></td>
<td>
<p>Similar to <code>run_after</code> in <code>new_page()</code>, passed explicitly
here as this page adds some of its own code to <code>run_after</code>.</p>
</td></tr>
<tr><td><code id="page_freetext_+3A_...">...</code></td>
<td>
<p>Other parametrs are passed on to <code>new_page()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A page object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+new_page">new_page()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
page_freetext(
  "test_page_freetext",
  question_text = "Hello there! Please fill in your name below:",
  no_answer_checkbox = TRUE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='page_none_selected_freetext'>An additional freetext page to show when no suggestion has been selected.</h2><span id='topic+page_none_selected_freetext'></span>

<h3>Description</h3>

<p>An additional freetext page to show when no suggestion has been selected.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>page_none_selected_freetext(is_interview = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="page_none_selected_freetext_+3A_is_interview">is_interview</code></td>
<td>
<p>Should the page show slightly different / additional
instructions and answer options for an interview that is conducted by
another person? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="page_none_selected_freetext_+3A_...">...</code></td>
<td>
<p>All additional parameters are passed to <code><a href="#topic+new_page">new_page()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A page object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+new_page">new_page()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
my_questionnaire &lt;- list(
  page_first_freetext(),
  page_second_freetext(),
  page_select_suggestion(),
  page_none_selected_freetext(),
  page_followup(1),
  page_followup(2)
)
if (interactive()) {
  app(questionnaire = my_questionnaire)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='page_results'>Page showing the user's results</h2><span id='topic+page_results'></span>

<h3>Description</h3>

<p>This page is only meant for demonstration purposes. Users can see what they
entered and which code was being saved. The page is only included in the
<code><a href="#topic+questionnaire_demo">questionnaire_demo()</a></code>, but not in the other questionnaire templates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>page_results(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="page_results_+3A_...">...</code></td>
<td>
<p>All additional parameters are passed to <code><a href="#topic+new_page">new_page()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A page object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+new_page">new_page()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
my_questionnaire &lt;- list(
  page_first_freetext(),
  page_second_freetext(),
  page_select_suggestion(),
  page_none_selected_freetext(),
  page_followup(1),
  page_followup(2),
  page_results()
)
if (interactive()) {
  app(questionnaire = my_questionnaire)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='page_second_freetext'>An optional, second free text question if the first didn't yield suggestions.</h2><span id='topic+page_second_freetext'></span>

<h3>Description</h3>

<p>If the first freetext question didn't provide satisfactory results,
ask for more details and try again.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>page_second_freetext(
  combine_input_with_first = TRUE,
  is_interview = FALSE,
  aggregate_score_threshold = 0.02,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="page_second_freetext_+3A_combine_input_with_first">combine_input_with_first</code></td>
<td>
<p>Should input be combined with the
previous question?</p>
</td></tr>
<tr><td><code id="page_second_freetext_+3A_is_interview">is_interview</code></td>
<td>
<p>Should the page show slightly different / additional
instructions and answer options for an interview that is conducted by
another person? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="page_second_freetext_+3A_aggregate_score_threshold">aggregate_score_threshold</code></td>
<td>
<p>The total sum of the scores of the
suggestions has to be higher than this threshold for suggestions to be
shown. The parameter is passed on to <code><a href="#topic+get_job_suggestions">get_job_suggestions()</a></code>.</p>
</td></tr>
<tr><td><code id="page_second_freetext_+3A_...">...</code></td>
<td>
<p>All additional parameters are passed to <code><a href="#topic+new_page">new_page()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A page object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+new_page">new_page()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
my_questionnaire &lt;- list(
  page_first_freetext(),
  page_second_freetext(),
  page_select_suggestion(),
  page_none_selected_freetext(),
  page_followup(1),
  page_followup(2)
)
if (interactive()) {
  app(questionnaire = my_questionnaire)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='page_select_suggestion'>Display the generated suggestions for the user to pick one.</h2><span id='topic+page_select_suggestion'></span>

<h3>Description</h3>

<p>Display the generated suggestions for the user to pick one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>page_select_suggestion(is_interview = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="page_select_suggestion_+3A_is_interview">is_interview</code></td>
<td>
<p>Should the page show slightly different / additional
instructions and answer options for an interview that is conducted by
another person? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="page_select_suggestion_+3A_...">...</code></td>
<td>
<p>All additional parameters are passed to <code><a href="#topic+new_page">new_page()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A page object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+new_page">new_page()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
my_questionnaire &lt;- list(
  page_first_freetext(),
  page_second_freetext(),
  page_select_suggestion(),
  page_none_selected_freetext(),
  page_followup(1),
  page_followup(2)
)
if (interactive()) {
  app(questionnaire = my_questionnaire)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='page_welcome'>Welcome Page (optional)</h2><span id='topic+page_welcome'></span>

<h3>Description</h3>

<p>Providing an introduction and greeting participants.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>page_welcome(
  title = "Herzlich Willkommen zum Modul zur automatischen Berufskodierung!",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="page_welcome_+3A_title">title</code></td>
<td>
<p>The heading with which to greet participants.</p>
</td></tr>
<tr><td><code id="page_welcome_+3A_...">...</code></td>
<td>
<p>All additional parameters are passed to <code><a href="#topic+new_page">new_page()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A page object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+new_page">new_page()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
my_questionnaire &lt;- list(page_welcome)
if (interactive()) {
  app(questionnaire = my_questionnaire)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='preprocess_string'>Preprocess a string, removing special characters and handling abbreviations.</h2><span id='topic+preprocess_string'></span>

<h3>Description</h3>

<p>Replace some common characters / character sequences
(e.g., Ä, Ü, &quot;DIPL.-ING.&quot;) with their uppercase equivalents and removes
punctuation, empty spaces and the word &quot;Diplom&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preprocess_string(verbatim, lang = "de")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="preprocess_string_+3A_verbatim">verbatim</code></td>
<td>
<p>The character vector to process.</p>
</td></tr>
<tr><td><code id="preprocess_string_+3A_lang">lang</code></td>
<td>
<p>The language the text is in.
Currently only German is supported.
Defaults to &quot;de&quot; (German).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="base.html#topic+charToRaw">charToRaw()</a></code> helps to find UTF-8 characters.
</p>


<h3>Value</h3>

<p>The same character vector after processing
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
preprocess_string(c(
  "Verkauf von B\u00fcchern, Schreibwaren",
  "Fach\u00e4rztin f\u00fcr Kinder- und Jugendmedizin im \u00f6ffentlichen Gesundheitswesen",
  "Industriemechaniker",
  "Dipl.-Ing. - Agrarwirtschaft (Landwirtschaft)"
))

## End(Not run)
</code></pre>

<hr>
<h2 id='pretrained_models'>Pretrained ML models to be used with the package.</h2><span id='topic+pretrained_models'></span>

<h3>Description</h3>

<p>Pretrained ML models to be used with the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pretrained_models
</code></pre>


<h3>Format</h3>

<p>A nested list with pretrained machine learning models:
</p>

<dl>
<dt><code>similarity_based_reasoning</code></dt><dd><p>list. Contains pretrained models to be used with <code><a href="#topic+algo_similarity_based_reasoning">algo_similarity_based_reasoning()</a></code>.</p>
</dd>
<dt><code>similarity_based_reasoning$wordwise</code></dt><dd><p>list. Contains the pretrained model to be used for providing suggestions using full wordwise matching.</p>
</dd>
<dt><code>similarity_based_reasoning$substring</code></dt><dd><p>list. Contains the pretrained model to be used for providing suggestions using substring matching.</p>
</dd>
</dl>

<p>This training data always predicts a 5-digit code from the 2010 German Classification of Occupations, with some exceptions: -0004 stands for 'Not precise enough/uncodable', -0006 stands for 'Multiple Jobs', -0012 stands for 'Blue-collar workers', -0019 stands for 'Volunteer/Social Service', and -0030 stands for 'Student assistant'.
</p>


<h3>Source</h3>

<p>Data from the following surveys were pooled:
</p>
<p>Antoni, M., Drasch, K., Kleinert, C., Matthes, B., Ruland, M. and Trahms, A. (2010): Arbeiten und Lernen im Wandel * Teil 1: Überblick über die Studie, FDZ-Methodenreport 05/2010, Forschungsdatenzentrum der Bundesagentur für Arbeit im Institut für Arbeitsmarkt- und Berufsforschung, Nuremberg.
</p>
<p>Rohrbach-Schmidt, D., Hall, A. (2013): BIBB/BAuA Employment Survey 2012, BIBB-FDZ Data and Methodological Reports Nr. 1/2013. Version 4.1, Federal Institute for Vocational Education and Training (Research Data Centre), Bonn.
</p>
<p>Lange, C., Finger, J., Allen, J., Born, S., Hoebel, J., Kuhnert, R., Müters, S., Thelen, J., Schmich, P., Varga, M., von der Lippe, E., Wetzstein, M., Ziese, T. (2017): Implementation of the European Health Interview Survey (EHIS) into the German Health Update (GEDA), Archives of Public Health, 75, 1–14.
</p>
<p>Hoffmann, R., Lange, M., Butschalowsky, H., Houben, R., Schmich, P., Allen, J., Kuhnert, R., Schaffrath Rosario, A., Gößwald, A. (2018): KiGGS Wave 2 Cross-Sectional Study—Participant Acquisition, Response Rates and Representativeness, Journal of Health Monitoring, 3, 78–91. (only wave 2)
</p>
<p>Trappmann, M., Beste, J., Bethmann, A., Müller, G. (2013): The PASS Panel Survey after Six Waves, Journal for Labour Market Research, 46, 275–281. (only wave 10)
</p>
<p>Job titles were taken from the following publication:
</p>
<p>Bundesagentur für Arbeit (2019). Gesamtberufsliste der Bundesagentur für Arbeit. Stand: 03.01.2019. https://download-portal.arbeitsagentur.de/files/.
</p>
<p>Basically, leaving some data anonymization steps aside, we count for each job title from the Gesamtberufsliste (and some additional titles/texts) how many responses from all surveys are similar to this job title, separately for each coded category. Similarity is calculated in two ways, implying that we obtain two different counts: SubstringSimilarity refers to situations where the job title from the Gesamtberufsliste is a substring of the verbal answer; WordwiseSimilarity refers to situations where a word from the verbal answer is identical to a job title from the Gesamtberufsliste, except that one character from this word is allowed to change (Levenshtein distance). These counts are available as two separate files in the data-raw/training-data/ directory of this package. The algorithm to create these counts is available inside an R-package at https://github.com/malsch/occupationCoding, along with further documentation.
</p>
<p><code><a href="#topic+train_similarity_based_reasoning">train_similarity_based_reasoning()</a></code> is then used to train the ML models. See data-raw/pretrained_models.R for the raw counts and further details.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+algo_similarity_based_reasoning">algo_similarity_based_reasoning()</a></code>, <code><a href="#topic+train_similarity_based_reasoning">train_similarity_based_reasoning()</a></code>, https://github.com/malsch/occupationCoding
</p>

<hr>
<h2 id='questionnaire_demo'>A demo questionnaire with additional explanations</h2><span id='topic+questionnaire_demo'></span>

<h3>Description</h3>

<p>View the function's code itself to see the used pages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>questionnaire_demo(show_feedback_page = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="questionnaire_demo_+3A_show_feedback_page">show_feedback_page</code></td>
<td>
<p>Show the <code><a href="#topic+page_feedback">page_feedback()</a></code> to evaluate the fit of
the chosen suggestion.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note, that this function has more complex code to create
the additional pages.
</p>


<h3>Value</h3>

<p>A questionnaire for <code><a href="#topic+app">app()</a></code> i.e. a list of pages.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
# Inspect the code to create the questionnaire_demo
print(questionnaire_demo)

if (interactive()) {
  # Run the app with the questionnaire_demo
  app(questionnaire = questionnaire_demo())
}

## End(Not run)
</code></pre>

<hr>
<h2 id='questionnaire_interviewer_administered'>A questionnaire for interviewer-administered surveys</h2><span id='topic+questionnaire_interviewer_administered'></span>

<h3>Description</h3>

<p>A questionnaire for Computer-assisted Interviewing (CAI), i.e. telephone interviewing or personal interviewing. In both modes, interviewer asks questions to an interviewee.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>questionnaire_interviewer_administered(show_feedback_page = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="questionnaire_interviewer_administered_+3A_show_feedback_page">show_feedback_page</code></td>
<td>
<p>Show the <code><a href="#topic+page_feedback">page_feedback()</a></code> to evaluate the fit of
the chosen suggestion.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>View the function's code to see the used pages. This function is meant as a template that can be changed to meet your requirements.
</p>


<h3>Value</h3>

<p>A questionnaire for <code><a href="#topic+app">app()</a></code> i.e. a list of pages.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
# Inspect the code to create the questionnaire_interviewer_administered
print(questionnaire_interviewer_administered)

if (interactive()) {
  # Run the app with the questionnaire_interviewer_administered
  app(questionnaire = questionnaire_interviewer_administered())
}

## End(Not run)
</code></pre>

<hr>
<h2 id='questionnaire_web_survey'>A web survey which participants can navigate themselves.</h2><span id='topic+questionnaire_web_survey'></span>

<h3>Description</h3>

<p>The basic default questionnaire. View the function's code to see the
used pages. This function is meant as a template that can be changed to meet your requirements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>questionnaire_web_survey(show_feedback_page = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="questionnaire_web_survey_+3A_show_feedback_page">show_feedback_page</code></td>
<td>
<p>Show the <code><a href="#topic+page_feedback">page_feedback()</a></code> to evaluate the fit of
the chosen suggestion.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A questionnaire for <code><a href="#topic+app">app()</a></code>, i.e. a list of pages.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
# Inspect the code to create the questionnaire_web_survey
print(questionnaire_web_survey)

if (interactive()) {
  # Run the app with the questionnaire_web_survey
  app(questionnaire = questionnaire_web_survey())
}

if (interactive()) {
  # This is used by default within app
  app()
}

## End(Not run)
</code></pre>

<hr>
<h2 id='set_item_data'>Set / save data for an item.</h2><span id='topic+set_item_data'></span>

<h3>Description</h3>

<p>There can be multiple items on any given page. Items can be different
questions, or multiple variables that need to be saved from a single
question. The <code>question_text</code> is typically
saved in <code>run_before</code> and the reply (<code>response_text</code> and/or <code>response_id</code>) is
typically saved in <code>run_after</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_item_data(
  session,
  page_id,
  item_id = NULL,
  question_text = NULL,
  response_text = NULL,
  response_id = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_item_data_+3A_session">session</code></td>
<td>
<p>The shiny session</p>
</td></tr>
<tr><td><code id="set_item_data_+3A_page_id">page_id</code></td>
<td>
<p>The page for which to retrieve data.</p>
</td></tr>
<tr><td><code id="set_item_data_+3A_item_id">item_id</code></td>
<td>
<p>The item for which to set/update data.
This <em>has</em> to be different for different items on the same page.
Since most pages contain only a single question/item, <code>item_id</code> is set to &quot;default&quot; if missing.</p>
</td></tr>
<tr><td><code id="set_item_data_+3A_question_text">question_text</code></td>
<td>
<p>The question's text. (optional)</p>
</td></tr>
<tr><td><code id="set_item_data_+3A_response_text">response_text</code></td>
<td>
<p>The user's response in text form. (optional)</p>
</td></tr>
<tr><td><code id="set_item_data_+3A_response_id">response_id</code></td>
<td>
<p>The user's response as an id from a set of choices.
(optional)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nothing
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_item_data">get_item_data()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
# Set up a "fake" shiny session to store data
session &lt;- shiny::MockShinySession$new()
session$userData &lt;- list(
  current_page_id = "other_page",
  questionnaire_data = list(
    example_page = list()
  )
)

# This code is expected to be run in e.g. run_before or run_after
# It doesn't really make sense to run this code outside
set_item_data(
  session = session,
  page_id = "example_page",
  question_text = "How are you?"
)

set_item_data(
  session = session,
  page_id = "example_page",
  response_id = 3,
  response_text = "I'm doing great! (response_id = 3)"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='set_page_data'>Set some values in the page/questionnaire data in the current session.</h2><span id='topic+set_page_data'></span>

<h3>Description</h3>

<p>Data is automatically linked to a page's page_id.
Note that page data is <em>not</em> automatically saved and you probably want
to use set_item_data instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_page_data(session, page_id, values)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_page_data_+3A_session">session</code></td>
<td>
<p>The shiny session</p>
</td></tr>
<tr><td><code id="set_page_data_+3A_values">values</code></td>
<td>
<p>A named list of values to add / overwrite in the page data.
Values are added / overwritten based on the names provided in the list.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nothing
</p>


<h3>See Also</h3>

<p><code><a href="#topic+set_item_data">set_item_data()</a></code>
</p>

<hr>
<h2 id='train_similarity_based_reasoning'>Train Similarity Based Probability Model with anonymized training data</h2><span id='topic+train_similarity_based_reasoning'></span>

<h3>Description</h3>

<p>This function requires the mvtnorm package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>train_similarity_based_reasoning(
  anonymized_data,
  num_allowed_codes = 1291,
  coding_index_w_codes,
  coding_index_without_codes = NULL,
  preprocessing = list(stopwords = NULL, stemming = NULL, strPreprocessing = TRUE,
    removePunct = FALSE),
  dist_type = c("wordwise", "substring", "fulltext"),
  dist_control = list(method = "osa", weight = c(d = 1, i = 1, s = 1, t = 1)),
  threshold = c(max = 3, use = 1),
  simulation_control = list(n.draws = 250, check_normality = FALSE)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="train_similarity_based_reasoning_+3A_anonymized_data">anonymized_data</code></td>
<td>
<p><code>surveyCountsSubstringSimilarity</code> or <code>surveyCountsWordwiseSimilarity</code></p>
</td></tr>
<tr><td><code id="train_similarity_based_reasoning_+3A_num_allowed_codes">num_allowed_codes</code></td>
<td>
<p>the number of allowed codes in the target classification. There are 1286 categories in the KldB 2010 plus 5 special codes in both anonymized training data sets, so the default value is 1291.</p>
</td></tr>
<tr><td><code id="train_similarity_based_reasoning_+3A_coding_index_w_codes">coding_index_w_codes</code></td>
<td>
<p>a data.table with columns
</p>

<dl>
<dt>bezMale</dt><dd><p>a character vector, contains masculine job titles from the coding index.</p>
</dd>
<dt>bezFemale</dt><dd><p>a character vector, contains feminine job titles from the coding index.</p>
</dd>
<dt>Code</dt><dd><p>a character vector with associated classification codes.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="train_similarity_based_reasoning_+3A_coding_index_without_codes">coding_index_without_codes</code></td>
<td>
<p>(not used, but automatically determined) Any words from <code>anonymized_data$dictString</code> that are not found within <code>coding_index_w_codes</code> belong into this character vector.</p>
</td></tr>
<tr><td><code id="train_similarity_based_reasoning_+3A_preprocessing">preprocessing</code></td>
<td>
<p>a list with elements
</p>

<dl>
<dt>stopwords</dt><dd><p>a character vector, use <code>tm::stopwords("de")</code> for German stopwords. Only used if <code>dist_type = "wordwise"</code>.</p>
</dd>
<dt>stemming</dt><dd><p><code>NULL</code> for no stemming and <code>"de"</code> for stemming using the German porter stemmer. Do not use unless the job titles in <code>coding_index_w_codes</code> were stemmed.</p>
</dd>
<dt>strPreprocessing</dt><dd><p><code>TRUE</code> if <code><a href="#topic+preprocess_string">preprocess_string</a></code> shall be used.</p>
</dd>
<dt>removePunct</dt><dd><p><code>TRUE</code> if <code><a href="tm.html#topic+removePunctuation">removePunctuation</a></code> shall be used.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="train_similarity_based_reasoning_+3A_dist_type">dist_type</code></td>
<td>
<p>How to calculate similarity between entries from both coding_indices and verbal answers from the survey? Three options are currently supported.  Since we use the <code><a href="stringdist.html#topic+stringdist">stringdist</a></code>-function excessively, one could easily extend the functionality of this procedure to other distance metrics.
</p>

<dl>
<dt>dist_type = &quot;fulltext&quot;</dt><dd><p>Uses the <code><a href="stringdist.html#topic+stringdist">stringdist</a></code>-function directly after preprocessing to calculate distances. (the simplest approach but least useful.)</p>
</dd>
<dt>dist_type = &quot;substring&quot;</dt><dd><p>An entry from the coding index and a verbal answer are similar if the entry from the coding index is a substring of the verbal answer.</p>
</dd>
<dt>dist_type = &quot;wordwise&quot;</dt><dd><p>After preprocessing, split the verbal answer into words. Then calculate for each word separately the the similarity with entries from the coding index, using <code><a href="stringdist.html#topic+stringdist">stringdist</a></code>. Not the complete verbal answer but only the words (0 or more) that have highest similarity are then used to determine similarity with entries from the coding index.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="train_similarity_based_reasoning_+3A_dist_control">dist_control</code></td>
<td>
<p>If <code>dist_type = "fulltext"</code> or <code>dist_type = "wordwise"</code> the entries from this list will be passed to <code><a href="stringdist.html#topic+stringdist">stringdist</a></code>. Currently only two possible entries are supported (method = &quot;osa&quot;, weight = c(d = 1, i = 1, s = 1, t = 1) is recommended), but one could easily extend the functionality.</p>
</td></tr>
<tr><td><code id="train_similarity_based_reasoning_+3A_threshold">threshold</code></td>
<td>
<p>A numeric vector with two elements. If <code>dist_type = "fulltext"</code> or <code>dist_type = "wordwise"</code>, the threshold determines up to which distance a verbal answer and an entry from the coding index are similar. The second number actually gets used. The first number is only used to speed up similarity calculations. It should be identical or larger than the second number.</p>
</td></tr>
<tr><td><code id="train_similarity_based_reasoning_+3A_simulation_control">simulation_control</code></td>
<td>
<p>a list with two components,
</p>

<dl>
<dt>n.draws</dt><dd><p>Number of draws from the posterior distribution to determine posterior predictive probabilities. The larger, the more precise the results will be.</p>
</dd>
<dt>check_normality</dt><dd><p>We would like that the hyperprior distribution is normal. Set check_normality to TRUE to do some diagnostics about this.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with components
</p>

<dl>
<dt>prediction.datasets$modelProb</dt><dd><p>Contains all entries from the coding index. dist = &quot;official&quot; if the entry stems from coding_index_w_codes and dist = selfcreated if the entry stems from coding_index_without_codes. <code>string.prob</code> is used for weighting purposes (model averaging) if a new verbal answer is similar to multiple strings. <code>unobserved.mean.theta</code> gives a probability (usually very low) for any category that was not observed in the training data together with this string.</p>
</dd>
<dt>prediction.datasets$categoryProb</dt><dd><p><code>mean.theta</code> is the probability for <code>code</code> given that an incoming verbal answer is similar to <code>string</code>. Only available if this code was at least a single time observed with this string (Use <code>unobserved.mean.theta</code> otherwise).</p>
</dd>
<dt>num_allowed_codes</dt><dd><p>Number of categories in the classification.</p>
</dd>
<dt>preprocessing</dt><dd><p>The input parameter stored to replicate preprocessing with incoming data.</p>
</dd>
<dt>dist_type</dt><dd><p>The input parameter stored to replicate distance calculations with incoming data.</p>
</dd>
<dt>dist_control</dt><dd><p>The input parameter stored to replicate distance calculations with incoming data.</p>
</dd>
<dt>threshold</dt><dd><p>The input parameter stored to replicate distance calculations with incoming data.</p>
</dd>
<dt>simulation_control</dt><dd><p>The input parameters controlling the Monte Carlo simulation.</p>
</dd>
</dl>



<h3>References</h3>

<p>Schierholz, Malte (2019): New methods for job and occupation classification. Dissertation, Mannheim. <a href="https://madoc.bib.uni-mannheim.de/50617/">https://madoc.bib.uni-mannheim.de/50617/</a>, pp. 206-208 and p. 268, pp. 308-320
</p>
<p><a href="https://github.com/malsch/occupationCoding">https://github.com/malsch/occupationCoding</a> (function trainSimilarityBasedReasoning2 is implemented here)
</p>


<h3>See Also</h3>

<p><a href="#topic+pretrained_models">pretrained_models</a>, which were created using this function.
</p>

<hr>
<h2 id='validate_questionnaire'>Validate (and sanitize the questionnaire)</h2><span id='topic+validate_questionnaire'></span>

<h3>Description</h3>

<p>Validate (and sanitize the questionnaire)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_questionnaire(questionnaire, verbose)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validate_questionnaire_+3A_questionnaire">questionnaire</code></td>
<td>
<p>The questionnaire passed to <code><a href="#topic+app">app()</a></code></p>
</td></tr>
<tr><td><code id="validate_questionnaire_+3A_verbose">verbose</code></td>
<td>
<p>Should information about the questionnaire be printed?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Sanitized questionnaire
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
