<!DOCTYPE html><html><head><title>Help for package SAGM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SAGM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#intercrop'>
<p>Intercropping data</p></a></li>
<li><a href='#make_weights'><p>make_weights</p></a></li>
<li><a href='#SAGM'><p>SAGM</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Spatial Autoregressive Graphical Model</td>
</tr>
<tr>
<td>Imports:</td>
<td>fastmatrix, GIGrvg, stats, utils, mvtnorm</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sjoerd Hermes &lt;sjoerd.hermes@wur.nl&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the methodological developments found in Hermes, van Heerwaarden, and Behrouzi (2023) &lt;<a href="https://doi.org/10.48550%2FarXiv.2308.04325">doi:10.48550/arXiv.2308.04325</a>&gt;, and allows for the statistical modeling of asymmetric between-location effects, as well as within-location effects using spatial autoregressive graphical models. The package allows for the generation of spatial weight matrices to capture asymmetric effects for strip-type intercropping designs, although it can handle any type of spatial data commonly found in other sciences.  </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-06 11:22:57 UTC; sjoer</td>
</tr>
<tr>
<td>Author:</td>
<td>Sjoerd Hermes [aut, cre],
  Joost van Heerwaarden [ctb],
  Pariya Behrouzi [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-06 11:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='intercrop'>
Intercropping data
</h2><span id='topic+intercrop'></span>

<h3>Description</h3>

<p>This is a generated dataset containing of 4 different variables, measured across 40 plots on a strip-type intercropping design consisting of 2 crops.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("intercrop")</code></pre>


<h3>Format</h3>

<p>The format is:
40 by 4 matrix
</p>


<h3>Details</h3>

<p>Contains generated data similar to the data used in the Hermes et al. (2023) paper, except that this data consists of a a single row of alternating crops.
</p>


<h3>Source</h3>

<p>Generated
</p>


<h3>References</h3>

<p>1. Hermes, S., van Heerwaarden, J., and Behrouzi, P. (2023). A Spatial Autoregressive Graphical Model with Applications in Intercropping. arXiv preprint, arXiv:2308.04325. <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(intercrop)
</code></pre>

<hr>
<h2 id='make_weights'>make_weights</h2><span id='topic+make_weights'></span>

<h3>Description</h3>

<p>Create 2 weight matrices to capture asymmetric spatial effects for strip-type intercropping designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_weights(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_weights_+3A_n">n</code></td>
<td>
<p>Number of observations.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>W_BA</code></td>
<td>
<p>A <code class="reqn">n \times n</code> spatial weight matrix capturing the locations of type A that are adjacent to locations of type B.</p>
</td></tr>
<tr><td><code>W_AB</code></td>
<td>
<p>A <code class="reqn">n \times n</code> spatial weight matrix capturing the locations of type B that are adjacent to locations of type A.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sjoerd Hermes, Joost van Heerwaarden and Pariya Behrouzi<br />
Maintainer: Sjoerd Hermes <a href="mailto:sjoerd.hermes@wur.nl">sjoerd.hermes@wur.nl</a>
</p>


<h3>References</h3>

<p>1. Hermes, S., van Heerwaarden, J., and Behrouzi, P. (2023). A Spatial Autoregressive Graphical Model with Applications in Intercropping. arXiv preprint, arXiv:2308.04325. <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>make_weights(20)
</code></pre>

<hr>
<h2 id='SAGM'>SAGM</h2><span id='topic+SAGM'></span>

<h3>Description</h3>

<p>This function applies the spatial autoregressive graphical model on a given dataset and array of spatial weight matrices. Different identifiability constraints can be imposed to estimate the <code class="reqn">\Psi_k</code>. The method allows for both normal and normal-gamma priors, where the values for the hyperparameters can be specified by the user. Returns posterior samples for <code class="reqn">\Theta_{E}</code> and the <code class="reqn">\Psi_k</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SAGM(X, W, prior, constraint, triangular, idx_mat, zeta, kappa, b0, b1,
nBurnin, nIter, verbose)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SAGM_+3A_x">X</code></td>
<td>
<p>A <code class="reqn">n \times p</code> matrix, where <code class="reqn">n</code> is the number of observations and <code class="reqn">p</code> is the number of variables.</p>
</td></tr>
<tr><td><code id="SAGM_+3A_w">W</code></td>
<td>
<p>A <code class="reqn">n \times n \times 2</code> array, where the 2 generated spatial matrices are stacked. Note that the order in which the weight matrices are stacked corresponds to the order of the estimated spatial effect matrices.</p>
</td></tr>
<tr><td><code id="SAGM_+3A_prior">prior</code></td>
<td>
<p>Prior choice on the spatial effects. Either normal (<code>"normal"</code>) or normal-gamma (<code>"ng"</code>).</p>
</td></tr>
<tr><td><code id="SAGM_+3A_constraint">constraint</code></td>
<td>
<p>Identifiability constraint on the spatial effects. Either symmetric (<code>"symmetric"</code>), triangular (<code>"triangular"</code>) or informative (<code>"informative"</code>).</p>
</td></tr>
<tr><td><code id="SAGM_+3A_triangular">triangular</code></td>
<td>
<p>Type of triangular restriction. Can be upper-triangular, or lower-triangular, or both, e.g. <code>triangular = c("upper","upper")</code>. Only has an effect whenever <code>constraint = "triangular"</code></p>
</td></tr>
<tr><td><code id="SAGM_+3A_idx_mat">idx_mat</code></td>
<td>
<p>A <code class="reqn">\code{nknown} \times 5 \times</code> matrix, where <code>nknown</code> is the number of known spatial effects. This matrix contains the indices, means and standard deviations of the known spatial effects that is specified by the user. The matrix only needs to be specified whenever <code>constraint = "informative"</code> is entered.</p>
</td></tr>
<tr><td><code id="SAGM_+3A_zeta">zeta</code></td>
<td>
<p>Value of hyperparameter <code class="reqn">\zeta</code>.</p>
</td></tr>
<tr><td><code id="SAGM_+3A_kappa">kappa</code></td>
<td>
<p>Value of hyperparameter <code class="reqn">\kappa</code>.</p>
</td></tr>
<tr><td><code id="SAGM_+3A_b0">b0</code></td>
<td>
<p>Value of hyperparameter <code class="reqn">b_0</code>.</p>
</td></tr>
<tr><td><code id="SAGM_+3A_b1">b1</code></td>
<td>
<p>Value of hyperparameter <code class="reqn">b_1</code>.</p>
</td></tr>
<tr><td><code id="SAGM_+3A_nburnin">nBurnin</code></td>
<td>
<p>Number of burnin samples.</p>
</td></tr>
<tr><td><code id="SAGM_+3A_niter">nIter</code></td>
<td>
<p>Number of post-burnin Gibbs samples.</p>
</td></tr>
<tr><td><code id="SAGM_+3A_verbose">verbose</code></td>
<td>
<p>Return progress of parameter estimation (<code>True</code>) or not (<code>False</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Theta</code></td>
<td>
<p>A <code class="reqn">p \times p \times \code{nIter}</code> array consisting of the post-burnin samples for the within-plot dependencies.</p>
</td></tr>
<tr><td><code>Psi</code></td>
<td>
<p>A <code class="reqn">p \times p \times 2 \times \code{nIter}</code> array consisting of the post-burnin samples for the between-plot effects. The order of the third dimension of the array corresponds to that of the <code>W</code>.</p>
</td></tr>
<tr><td><code>lambda_sq</code></td>
<td>
<p>A <code class="reqn">p \times p \times \code{nIter}</code> array consisting of the post-burnin samples for <code class="reqn">\Lambda^2</code>. This output is of secondary interest.</p>
</td></tr>
<tr><td><code>tau_sq</code></td>
<td>
<p>A vector of length <code>nIter</code> consisting of the post-burnin samples for <code class="reqn">\tau^2</code>. This output is of secondary interest.</p>
</td></tr>
<tr><td><code>accpt_rate</code></td>
<td>
<p>Value of the acceptance rate of the Metropolis Hastings step.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sjoerd Hermes, Joost van Heerwaarden and Pariya Behrouzi<br />
Maintainer: Sjoerd Hermes <a href="mailto:sjoerd.hermes@wur.nl">sjoerd.hermes@wur.nl</a>
</p>


<h3>References</h3>

<p>1. Hermes, S., van Heerwaarden, J., and Behrouzi, P. (2023). A Spatial Autoregressive Graphical Model with Applications in Intercropping. arXiv preprint, arXiv:2308.04325. <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(intercrop)
n &lt;- nrow(intercrop)

W &lt;- make_weights(n)

# Suppose we have 16 known effects. Here we assign informative normal
# priors to these effects
idx_mat &lt;- matrix(NA, 16, 5)
idx_mat[1,] &lt;- c(1,1,1,1, 0.1)
idx_mat[2,] &lt;- c(1,2,1,1, 0.1)
idx_mat[3,] &lt;- c(1,3,1,1, 0.1)
idx_mat[4,] &lt;- c(1,1,2,1, 0.1)
idx_mat[5,] &lt;- c(1,2,2,1, 0.1)
idx_mat[6,] &lt;- c(1,3,2,1, 0.1)
idx_mat[7,] &lt;- c(4,1,1,-1, 0.1)
idx_mat[8,] &lt;- c(4,2,1,-1, 0.1)
idx_mat[9,] &lt;- c(4,3,1,-1, 0.1)
idx_mat[10,] &lt;- c(4,4,1,-1, 0.1)
idx_mat[11,] &lt;- c(4,1,2,-1, 0.1)
idx_mat[12,] &lt;- c(4,2,2,-1, 0.1)
idx_mat[13,] &lt;- c(4,3,2,-1, 0.1)
idx_mat[14,] &lt;- c(4,4,2,-1, 0.1)
idx_mat[15,] &lt;- c(2,3,1,-1, 0.1)
idx_mat[16,] &lt;- c(2,3,2,-1, 0.1)

W &lt;- array(c(W$W_BA, W$W_AB), dim = c(n,n,2))
est &lt;- SAGM(X = intercrop, W = W, prior = "normal", constraint = "informative",
triangular = c("upper","upper"), idx_mat = idx_mat, zeta = 0.1, kappa = 0.1,
b0 = 0.01, b1 = 0.01, nBurnin = 1000, nIter = 1000, verbose = TRUE)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
