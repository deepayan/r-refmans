<!DOCTYPE html><html><head><title>Help for package musica</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {musica}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#basin_PT'><p>Basin average observed and simulated daily precipitation and temperature</p></a></li>
<li><a href='#codes'><p>Conversion between period specification and codes</p></a></li>
<li><a href='#compare'><p>Compare decomposed variables</p></a></li>
<li><a href='#decomp'><p>Decomposition of time-series</p></a></li>
<li><a href='#difs'><p>Functions for evaluating distance between variables</p></a></li>
<li><a href='#m2s'><p>Indication of a season</p></a></li>
<li><a href='#msTrans_abs'><p>Multiscale quantile mapping bias correction</p></a></li>
<li><a href='#msTrans_dif'><p>Multiscale delta method</p></a></li>
<li><a href='#musica-package'><p>An R package for multiscale climate model assessment</p></a></li>
<li><a href='#prob'><p>Evaluation of empirical cumulative distribution function</p></a></li>
<li><a href='#Q'><p>Convenience function for calculation of quantiles</p></a></li>
<li><a href='#tscale'><p>Convert averaging length code to hours</p></a></li>
<li><a href='#vcompare'><p>Assess the relations between two decomposed variables</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multiscale Climate Model Assessment</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions allowing for (1) easy aggregation of multivariate time series into custom time scales, (2) comparison of statistical summaries between different data sets at multiple time scales (e.g. observed and bias-corrected data), (3) comparison of relations between variables and/or different data sets at multiple time scales (e.g. correlation of precipitation and temperature in control and scenario simulation) and (4) transformation of time series at custom time scales.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.15.1), data.table</td>
</tr>
<tr>
<td>Imports:</td>
<td>magrittr, qmap, lubridate</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, ggplot2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-09-02 22:32:07 UTC; mha</td>
</tr>
<tr>
<td>Author:</td>
<td>Martin Hanel [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Martin Hanel &lt;hanel@fzp.czu.cz&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-09-03 10:01:12</td>
</tr>
</table>
<hr>
<h2 id='basin_PT'>Basin average observed and simulated daily precipitation and temperature</h2><span id='topic+basin_PT'></span>

<h3>Description</h3>

<p>A list of three data.tables with observed (<code>obs_ctrl</code>) and RCM simulated data for the control (<code>sim_ctrl</code>) and scenario (<code>sim_scen</code>) periods for Oslava basin (downto Cucice) in the Czech Republic. The basin average precipitation and temperature were obtained from griddedb observations and RCM simulation (EUR-11_CNRM-CERFACS-CNRM-CM5_rcp45_r1i1p1_CLMcom-CCLM4-8-17 simulation conducted within the CORDEX project).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>basin_PT
</code></pre>


<h3>Format</h3>

<p>List of 3 data.tables:
</p>

<dl>
<dt>obs_ctrl</dt><dd><p>observed data for the basin for a period 1981-01-01 &ndash; 2005-21-31</p>
</dd>
<dt>sim_ctrl</dt><dd><p>simulated data for the basin for a period 1981-01-01 &ndash; 2005-21-31</p>
</dd>
<dt>sim_scen</dt><dd><p>simulated data for the basin for a period 2070-01-01 &ndash; 2099-21-31</p>
</dd>
</dl>

<p>Each data.table contains 3 variables:
</p>

<dl>
<dt>DTM</dt><dd><p>date</p>
</dd>
<dt>PR</dt><dd><p>precipitation, mm</p>
</dd>
<dt>TAS</dt><dd><p>temperature, degrees C</p>
</dd>
</dl>

<hr>
<h2 id='codes'>Conversion between period specification and codes</h2><span id='topic+code2period'></span><span id='topic+codes'></span><span id='topic+period2code'></span>

<h3>Description</h3>

<p>Conversion between period specification and codes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>period2code(periods)

code2period(code)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="codes_+3A_periods">periods</code></td>
<td>
<p>period specification</p>
</td></tr>
<tr><td><code id="codes_+3A_code">code</code></td>
<td>
<p>period code</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Periods are specified using keywords &quot;day&quot;, &quot;month&quot;, &quot;year&quot; preceded by an integer and a space and optionally followed by &quot;s&quot; (the specification is further passed to <code>cut.Date</code>, see <code><a href="base.html#topic+cut.Date">cut.Date</a></code> for details). To fit in figures and for simplicity, periods can be also specified by codes, i.e. by <code>D</code>, <code>M</code>, <code>Y</code> (for &quot;day&quot;, &quot;month&quot; and &quot;year&quot;, respectively) and folowed by integer specifying the number of intervals. The functions <code>period2code</code> and <code>code2period</code> provide conversion between the two alternatives.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>period2code(c('1 day', '23 days', '3 month', '2 years'))

code2period(c('D1', 'D23', 'M3', 'Y2'))
</code></pre>

<hr>
<h2 id='compare'>Compare decomposed variables</h2><span id='topic+compare'></span>

<h3>Description</h3>

<p>The function evaluates distance between statistical characteristics of specified data sets. Distance is measured as difference for variables included in <code>getOption('additive_variables')</code>, i.e. temperature (<code>TAS</code>) by default, and as a ratio for other variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare(x, compare_to, fun = mean, wet_int_only = TRUE, wet_int_thr = 0.1,
  exclude_below = 0.9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_+3A_x">x</code></td>
<td>
<p>List of decomposed variables to be compared</p>
</td></tr>
<tr><td><code id="compare_+3A_compare_to">compare_to</code></td>
<td>
<p>Decomposed variable used as a reference</p>
</td></tr>
<tr><td><code id="compare_+3A_fun">fun</code></td>
<td>
<p>Function used for comparison</p>
</td></tr>
<tr><td><code id="compare_+3A_wet_int_only">wet_int_only</code></td>
<td>
<p>(logical) Should only the wet intervals be considered?</p>
</td></tr>
<tr><td><code id="compare_+3A_wet_int_thr">wet_int_thr</code></td>
<td>
<p>Numeric value specifying the minimum depth to be considered wet</p>
</td></tr>
<tr><td><code id="compare_+3A_exclude_below">exclude_below</code></td>
<td>
<p>Some of the intervals might not be of required length, e.g. D10 interval may have less than 10 days available. The <code>exclude_below</code> argument controls the minimum fraction of the interval that has to be available in order to be considered in the summary statistics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.table summarizing the differences with columns:
</p>

<dl>
<dt>variable</dt><dd><p>factor indicating the variable</p>
</dd>
<dt>period</dt><dd><p>specification of the averaging length with 'D' - day(s), 'M' - month(s), 'Y' - year(s) and 'G1' - the overall mean </p>
</dd>
<dt>TS</dt><dd><p>averaging length in hours</p>
</dd>
<dt>sub_period</dt><dd><p>indication of the aggregating scale specified by <code>agg_by</code> argument</p>
</dd>
<dt>comp</dt><dd><p>factor indicating the data sets from <code>x</code> with labels given by <code>names(x)</code></p>
</dd>
<dt>DIF</dt><dd><p>distance between data sets from <code>x</code> and <code>compare_to</code>. Distance is measured as difference for variables included in <code>getOption('additive_variables')</code>, i.e. temperature (<code>TAS</code>) by default, and as a ratio for other variables, see <code><a href="#topic+dif">dif</a></code></p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
data(basin_PT)
## Not run: 
dobs = decomp(basin_PT[['obs_ctrl']])
dctrl = decomp(basin_PT[['sim_ctrl']])
dscen = decomp(basin_PT[['sim_scen']])
d = compare(x = list(CTRL = dctrl, SCEN = dscen), compare_to = dobs, fun = max)
ggplot(d) +
 geom_line(aes(x = TS, y = DIF, col = factor(sub_period))) +
 facet_grid(variable ~ comp, scale = 'free') +
 scale_x_log10()
 
## End(Not run)
</code></pre>

<hr>
<h2 id='decomp'>Decomposition of time-series</h2><span id='topic+decomp'></span>

<h3>Description</h3>

<p>Calculate series of averages over the periods specified in the <code>period</code> argument into the inpur data.table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decomp(x, period = c("Y1", "M6", "M3", "M1", "D15", "D1"), agg_by = quarter,
  full_return = FALSE, remove_incomplete = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="decomp_+3A_x">x</code></td>
<td>
<p>data.table with columns <code>DTM</code> (date), <code>variable</code> and <code>value</code>. Any number of variables are in principle allowed.</p>
</td></tr>
<tr><td><code id="decomp_+3A_period">period</code></td>
<td>
<p>The periods over which the averages will be calculated, see Details</p>
</td></tr>
<tr><td><code id="decomp_+3A_agg_by">agg_by</code></td>
<td>
<p>Function for specification of the period (season, month) to be additionaly included in output, see Details</p>
</td></tr>
<tr><td><code id="decomp_+3A_full_return">full_return</code></td>
<td>
<p>(logical) Should the average be repeated for each scale along with original time series? Default is FALSE (e.g. for M1 only monthly and not daily time series is returned)</p>
</td></tr>
<tr><td><code id="decomp_+3A_remove_incomplete">remove_incomplete</code></td>
<td>
<p>Should the incomplete years be removed from results? Default is TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The original time series in daily time step is decomposed into series of averages ove periods specified in <code>periods</code> argument using letter codes 'D' - day(s), 'M' - month(s), 'Y' - year(s) followed by number corresponding to number of periods and 'G1' the overall mean. The periods must be given in order from longest to shortest, the overall mean is always included (and needs not to be specified in <code>period</code>). Shorter periods are always identified within the closest longer periods, i.e. each shorter period is included in exactly one longer period. As a result, the averages may be calculated over shorter periods than specified. This is due to varying length of &quot;month&quot; and &quot;year&quot; periods. The actual length used for averaging is included in the output. To make further assessment of the decomposed objects easier, indicator of period within the year (e.g. quarter or month) as specified by <code>agg_by</code> argument is included in the output.
</p>


<h3>Value</h3>

<p>data.table with variables:
</p>

<dl>
<dt>variable</dt><dd><p>factor indicating the variable</p>
</dd>
<dt>DTM</dt><dd><p>date</p>
</dd>
<dt>period</dt><dd><p>specification of the averaging length with 'D' - day(s), 'M' - month(s), 'Y' - year(s) and 'G1' - the overall mean </p>
</dd>
<dt>value</dt><dd><p>value of the variable for given averaging length</p>
</dd>
<dt>sub_period</dt><dd><p>indication of the aggregating scale specified by <code>agg_by</code> argument</p>
</dd>
<dt>period_pos</dt><dd><p>average date of the interval</p>
</dd>
<dt>N</dt><dd><p>real length of the vectors used for calculating averages</p>
</dd>
<dt>TS</dt><dd><p>averaging length in hours</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(basin_PT)
str(basin_PT)
basin_PT[['obs_ctrl']]
dobs = decomp(basin_PT[['obs_ctrl']], period = c('1 year', '1 month', '1 day'))
</code></pre>

<hr>
<h2 id='difs'>Functions for evaluating distance between variables</h2><span id='topic+dif'></span><span id='topic+difs'></span><span id='topic+rev_dif'></span><span id='topic+rev_difv'></span>

<h3>Description</h3>

<p>Functions for evaluating distance between variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dif(x, y, var)

rev_dif(x, y, var)

rev_difv(x, var)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="difs_+3A_x">x</code>, <code id="difs_+3A_y">y</code></td>
<td>
<p>variables to be compared</p>
</td></tr>
<tr><td><code id="difs_+3A_var">var</code></td>
<td>
<p>variable code</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Difference or ratio of <code>x</code> and <code>y</code> (for <code>dif</code>) and sum or product (for <code>rev_dif</code> and <code>rev_difv</code>). Distance is measured as difference for variables included in <code>getOption('additive_variables')</code>, i.e. temperature (<code>TAS</code>) by default, and as a ratio for other variables.
</p>
<p>While <code>rev_dif</code> returns <code>sum(x, y)</code> or <code>prod(x, y)</code>, <code>rev_difv</code> takes single vector <code>x</code> and returns <code>sum(x)</code> or <code>prod(x)</code>.
</p>
<p>Used mainly in other functions of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>getOption('additive_variables')

# calculate distance of 2 vectors
dif(c(10, 20, 30), c(11, 18, 3), 'TAS')
dif(c(10, 20, 30), c(11, 18, 3), 'PR')

# inverse for 2 vectors
rev_dif(c(10, 20, 30), c(11, 18, 3), 'TAS')

# inverse for 1 vector
rev_difv(c(10, 1.1, .9), 'TAS')
</code></pre>

<hr>
<h2 id='m2s'>Indication of a season</h2><span id='topic+m2s'></span><span id='topic+month2sea'></span><span id='topic+sscale2sea'></span>

<h3>Description</h3>

<p>Indication of a season
</p>


<h3>Usage</h3>

<pre><code class='language-R'>month2sea(dtm, year_starts = months(0))

sscale2sea(sub_scale, year_starts = months(0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="m2s_+3A_dtm">dtm</code></td>
<td>
<p>a <code>Date</code> object</p>
</td></tr>
<tr><td><code id="m2s_+3A_year_starts">year_starts</code></td>
<td>
<p>Month object indicating the start of the year</p>
</td></tr>
<tr><td><code id="m2s_+3A_sub_scale">sub_scale</code></td>
<td>
<p>integer indicating the season</p>
</td></tr>
</table>


<h3>Value</h3>

<p>3 letter code (as DJF, JJA etc.) specifying the season
</p>


<h3>Examples</h3>

<pre><code class='language-R'>month2sea(as.Date('2000-01-01') + months(1:10) )

sscale2sea(c(1, 1, 2, 2, 2, 3, 3), year_starts = months(-1))
</code></pre>

<hr>
<h2 id='msTrans_abs'>Multiscale quantile mapping bias correction</h2><span id='topic+msTrans_abs'></span>

<h3>Description</h3>

<p>Applies standard quantile mapping at custom time scales.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>msTrans_abs(dta, agg_by = month, wet_int_thr = 0.1, maxiter = 10,
  tol = 1e-04, qstep = 0.001, period = c("G1", "Y1", "M3", "M1", "D1"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="msTrans_abs_+3A_dta">dta</code></td>
<td>
<p>List with components <code>FROM</code> (simulated data for the control period), <code>TO</code> (observed data) and <code>NEWDATA</code> (data to be corrected). Each component is a <code>data.table</code> with columns <code>DTM</code> (date) and the climate variables (typically <code>PR</code> - precipitation and <code>TAS</code> - temperature)</p>
</td></tr>
<tr><td><code id="msTrans_abs_+3A_agg_by">agg_by</code></td>
<td>
<p>Function for specification of the period (season, month) to be additionaly included in output, see Details</p>
</td></tr>
<tr><td><code id="msTrans_abs_+3A_wet_int_thr">wet_int_thr</code></td>
<td>
<p>Numeric value specifying the minimum depth to be considered wet</p>
</td></tr>
<tr><td><code id="msTrans_abs_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations, see Details</p>
</td></tr>
<tr><td><code id="msTrans_abs_+3A_tol">tol</code></td>
<td>
<p>Stoping criterion of the iteration cycle, see Details</p>
</td></tr>
<tr><td><code id="msTrans_abs_+3A_qstep">qstep</code></td>
<td>
<p>A numeric value between 0 and 1. The quantile mapping is fitted only for the quantiles defined by quantile(0,1,probs=seq(0,1,by=qstep). Passed to <code><a href="qmap.html#topic+doQmapQUANT">doQmapQUANT</a></code>.</p>
</td></tr>
<tr><td><code id="msTrans_abs_+3A_period">period</code></td>
<td>
<p>Specification of the aggregation lengths the correction is applied at with 'D' - day(s), 'M' - month(s), 'Y' - year(s) and 'G1' - the overall mean</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The procedure utilizes standard quantile mapping from the <code><a href="qmap.html#topic+qmap">qmap</a></code>-package, but at multiple time scales. Since correction at particular temporal scale influences values at other aggregations, the procedure is applied iterativelly until the maximum number of iterations (<code>maxiter</code>) is reached or the difference between succesive iteration step is smaller than <code>tol</code>. Differences between corrected and uncorrected variable at longer time scales are used to modify daily values after each iteration step (see e.g. Mehrorta and Sharma, 2016; Pegram et al. 2009). To make further assessment of the decomposed objects easier, indicator of period within the year (e.g. quarter or month) as specified by <code>agg_by</code> argument is included in the output.
</p>


<h3>Value</h3>

<p>data.table with corrected data
</p>


<h3>References</h3>

<p>Hanel, M., Kozin, R., 2016. Bias and projected changes in climate model simulations at multiple time scales: consequences for hydrological impact assessment. Environmental Modelling and Software, submitted.
</p>
<p>Mehrotra, R., Sharma, A., 2016. A multivariate quantile-matching bias correction approach with auto-and cross-dependence across multiple time scales: Implications for downscaling. Journal of Climate 29, 3519-3539.
</p>
<p>Pegram, G.G., et al., 2009. A nested multisite daily rainfall stochastic generation model. Journal of Hydrology 371, 142-153.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("basin_PT")
scen = basin_PT$sim_scen
ctrl = basin_PT$sim_ctrl
obs = basin_PT$obs_ctrl
dta = list(TO = obs, FROM = ctrl, NEWDATA = scen)
## Not run: 
msTrans_abs(dta,  maxiter = 10, period = 'D1')

## End(Not run)
</code></pre>

<hr>
<h2 id='msTrans_dif'>Multiscale delta method</h2><span id='topic+msTrans_dif'></span>

<h3>Description</h3>

<p>Transforms observed data such that the changes in summary statistics of variables at custom time scales are similar to those obtained from climate model simulation. Number of functions can be used to summarize the variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>msTrans_dif(dta, model = "const", model_par = list(NULL), agg_by = month,
  wet_int_thr = 0.1, maxiter = 10, tol = 1e-04, period = c("G1", "Y1",
  "M1", "D1"), qstep = 0.001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="msTrans_dif_+3A_dta">dta</code></td>
<td>
<p>List with components <code>FROM</code> (simulated data for the control period), <code>TO</code> (simulated data for the scenario period) and <code>NEWDATA</code> (observed data to be transformed). Each component is a <code>data.table</code> with columns <code>DTM</code> (date) and the climate variables (typically <code>PR</code> - precipitation and <code>TAS</code> - temperature)</p>
</td></tr>
<tr><td><code id="msTrans_dif_+3A_model">model</code></td>
<td>
<p>One of <code>loess</code>, <code>const</code>, <code>identity</code>, <code>lm</code>, <code>smooth</code>, <code>runmed</code>, <code>smooth.spline</code>. The model is used to provide statistical summary of the empirical cumulative distribution function.</p>
</td></tr>
<tr><td><code id="msTrans_dif_+3A_model_par">model_par</code></td>
<td>
<p>optional parameters of the <code>model</code></p>
</td></tr>
<tr><td><code id="msTrans_dif_+3A_agg_by">agg_by</code></td>
<td>
<p>Function for specification of the period (season, month) to be additionaly included in output, see Details</p>
</td></tr>
<tr><td><code id="msTrans_dif_+3A_wet_int_thr">wet_int_thr</code></td>
<td>
<p>Numeric value specifying the minimum depth to be considered wet</p>
</td></tr>
<tr><td><code id="msTrans_dif_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations, see Details</p>
</td></tr>
<tr><td><code id="msTrans_dif_+3A_tol">tol</code></td>
<td>
<p>Stoping criterion of the iteration cycle, see Details</p>
</td></tr>
<tr><td><code id="msTrans_dif_+3A_period">period</code></td>
<td>
<p>Specification of the aggregation lengths the correction is applied at with 'D' - day(s), 'M' - month(s), 'Y' - year(s) and 'G1' - the overall mean</p>
</td></tr>
<tr><td><code id="msTrans_dif_+3A_qstep">qstep</code></td>
<td>
<p>A numeric value between 0 and 1. The ecdf is calculated only for the quantiles defined by quantile(0, 1, probs = seq(0, 1, by = qstep).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>transformed data.table
</p>


<h3>References</h3>

<p>Hanel, M., Kozin, R., 2016. Bias and projected changes in climate model simulations at multiple time scales: consequences for hydrological impact assessment. Environmental Modelling and Software, submitted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("basin_PT")
scen = basin_PT$sim_scen
ctrl = basin_PT$sim_ctrl
obs = basin_PT$obs_ctrl
dta = list(TO = scen, FROM = ctrl, NEWDATA = obs)
## Not run: 
msTrans_dif(dta,  maxiter = 10, period = 'D1')

## End(Not run)
</code></pre>

<hr>
<h2 id='musica-package'>An R package for multiscale climate model assessment</h2><span id='topic+musica-package'></span>

<h3>Description</h3>

<p>Contains functions for flexible assessment of climate model bias and changes at multiple time scales. See documentation for <code><a href="#topic+decomp">decomp</a></code>, <code><a href="#topic+compare">compare</a></code> and <code><a href="#topic+vcompare">vcompare</a></code>. In addition, musica provides functions for multiscale transformations of time series (see <code><a href="#topic+msTrans_abs">msTrans_abs</a></code> and <code><a href="#topic+msTrans_dif">msTrans_dif</a></code>)
</p>


<h3>Package options</h3>

<p>Following option(s) are available:
</p>

<dl>
<dt>additive_variables</dt><dd><p>At several places the package compares values. The character vector <code>additive_values</code> specifies for which variables difference should be used for comparison instead of ratio. Defaults to <code>additive_values = "TAS"</code>. See <code><a href="base.html#topic+options">options</a></code> for setting or examining options.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Martin Hanel <a href="mailto:hanel@fzp.czu.cz">hanel@fzp.czu.cz</a>
</p>


<h3>References</h3>

<p>Hanel, M., Kozin, R. (2016) Bias correction for hydrological modelling, submitted.
</p>

<hr>
<h2 id='prob'>Evaluation of empirical cumulative distribution function</h2><span id='topic+prob'></span>

<h3>Description</h3>

<p>Evaluation of empirical cumulative distribution function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prob(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prob_+3A_x">x</code></td>
<td>
<p>vector of values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of the empirical distribution function evaluated at <code>x</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prob(rnorm(10))
</code></pre>

<hr>
<h2 id='Q'>Convenience function for calculation of quantiles</h2><span id='topic+Q'></span>

<h3>Description</h3>

<p>The typical use is in <code><a href="#topic+compare">compare</a></code> to avoid anonymous functions in specification of its <code>fun</code> argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Q(p, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Q_+3A_p">p</code></td>
<td>
<p>Specification of the quantile</p>
</td></tr>
<tr><td><code id="Q_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code><a href="stats.html#topic+quantile">quantile</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>function calculating the p-th quantile
</p>


<h3>Examples</h3>

<pre><code class='language-R'>q90 = Q(.9)
class(q90)
q90(rnorm(10))
</code></pre>

<hr>
<h2 id='tscale'>Convert averaging length code to hours</h2><span id='topic+tscale'></span>

<h3>Description</h3>

<p>Period durations are calculated by the <code><a href="lubridate.html#topic+lubridate">lubridate</a></code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tscale(x, nyears = 30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tscale_+3A_x">x</code></td>
<td>
<p>Vector of the averaging period codes</p>
</td></tr>
<tr><td><code id="tscale_+3A_nyears">nyears</code></td>
<td>
<p>Overall number of years - used for conversion of the overall mean</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numerical vector of durations in hours
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tscale('M1')
tscale('G1', nyears = 25)
</code></pre>

<hr>
<h2 id='vcompare'>Assess the relations between two decomposed variables</h2><span id='topic+vcompare'></span>

<h3>Description</h3>

<p>Assess the relations between two decomposed variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vcompare(x, fun = cor, wet_int_only = TRUE, wet_int_thr = 0.1,
  exclude_below = 0.9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcompare_+3A_x">x</code></td>
<td>
<p>List of decomposed objects</p>
</td></tr>
<tr><td><code id="vcompare_+3A_fun">fun</code></td>
<td>
<p>Function to sumarize dependence (like <code>cor</code>, <code>cov</code>)</p>
</td></tr>
<tr><td><code id="vcompare_+3A_wet_int_only">wet_int_only</code></td>
<td>
<p>(logical) Should only the wet intervals be considered?</p>
</td></tr>
<tr><td><code id="vcompare_+3A_wet_int_thr">wet_int_thr</code></td>
<td>
<p>Numeric value specifying the minimum depth to be consider wet</p>
</td></tr>
<tr><td><code id="vcompare_+3A_exclude_below">exclude_below</code></td>
<td>
<p>Some of the intervals might not be of required length, e.g. D10 interval may have less than 10 days available. The <code>exclude_below</code> argument controls the minimum fraction of the interval that has to be available in order to be considered in the summary statistics.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>vcompare</code> compares the relation between all pairs of variables included in <code>x</code>, typically precipitation and temperature, but other variables may be included also (e.g. runoff).
</p>


<h3>Value</h3>

<p>data.table summarizing the relation with columns:
</p>

<dl>
<dt>variable</dt><dd><p>factor indicating the variable</p>
</dd>
<dt>period</dt><dd><p>specification of the averaging length with 'D' - day(s), 'M' - month(s), 'Y' - year(s) and 'G1' - the overall mean </p>
</dd>
<dt>TS</dt><dd><p>averaging length in hours</p>
</dd>
<dt>sub_period</dt><dd><p>indication of the aggregating scale specified by <code>agg_by</code> argument</p>
</dd>
<dt>comp</dt><dd><p>factor indicating the data sets from <code>x</code> with labels given by <code>names(x)</code></p>
</dd>
<dt>DIF</dt><dd><p>distance between data sets from <code>x</code> and <code>compare_to</code>. Distance is measured as difference for variables included in <code>getOption('additive_variables')</code>, i.e. temperature (<code>TAS</code>) by default, and as a ratio for other variables, see <code><a href="#topic+dif">dif</a></code></p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
data(basin_PT)
## Not run: 
dobs = decomp(basin_PT[['obs_ctrl']])
dctrl = decomp(basin_PT[['sim_ctrl']])
d = vcompare(x = list(OBS = dobs, CTRL = dctrl), fun = cov)
ggplot(d[period!='G1']) +
 geom_line(aes(x = TS, y = value, col = factor(sub_period))) +
 facet_grid(VARS~ID) +
 scale_x_log10()
 
## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
