<!DOCTYPE html><html><head><title>Help for package trend</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {trend}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bartels.test'><p>Bartels Test for Randomness</p></a></li>
<li><a href='#br.test'><p>Buishand Range Test for Change-Point Detection</p></a></li>
<li><a href='#bu.test'><p>Buishand U Test for Change-Point Detection</p></a></li>
<li><a href='#cs.test'><p>Cox and Stuart Trend Test</p></a></li>
<li><a href='#csmk.test'><p>Correlated Seasonal Mann-Kendall Test</p></a></li>
<li><a href='#hcb'><p>Monthly concentration of particle bound HCB, River Rhine</p></a></li>
<li><a href='#lanzante.test'><p>Lanzante's Test for Change Point Detection</p></a></li>
<li><a href='#maxau'><p>Annual suspended sediment concentration and flow data, River Rhine</p></a></li>
<li><a href='#mk.test'><p>Mann-Kendall Trend Test</p></a></li>
<li><a href='#mult.mk.test'><p>Multivariate (Multisite) Mann-Kendall Test</p></a></li>
<li><a href='#PagesData'><p>Simulated data of Page (1955) as test-example</p>
for change-point detection</a></li>
<li><a href='#partial.cor.trend.test'><p>Partial Correlation Trend Test</p></a></li>
<li><a href='#partial.mk.test'><p>Partial Mann-Kendall Trend Test</p></a></li>
<li><a href='#pettitt.test'><p>Pettitt's Test for Change-Point Detection</p></a></li>
<li><a href='#plot.cptest'><p>Plotting cptest-objects</p></a></li>
<li><a href='#rrod.test'><p>Robust Rank-Order Distributional Test</p></a></li>
<li><a href='#sea.sens.slope'><p>Seasonal Sen's Slope</p></a></li>
<li><a href='#sens.slope'><p>Sen's slope</p></a></li>
<li><a href='#smk.test'><p>Seasonal Mann-Kendall Trend Test</p></a></li>
<li><a href='#snh.test'><p>Standard Normal Homogeinity Test (SNHT) for Change-Point Detection</p></a></li>
<li><a href='#summary.smktest'><p>Object summaries</p></a></li>
<li><a href='#wm.test'><p>Wallis and Moore Phase-Frequency Test</p></a></li>
<li><a href='#ww.test'><p>Wald-Wolfowitz Test for Independence and Stationarity</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.1.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-10</td>
</tr>
<tr>
<td>Title:</td>
<td>Non-Parametric Trend Tests and Change-Point Detection</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>The analysis of environmental data often requires
	     the detection of trends and change-points. 
	     This package includes tests for trend detection
	     (Cox-Stuart Trend Test, Mann-Kendall Trend Test, 
	     (correlated) Hirsch-Slack Test,
             partial Mann-Kendall Trend Test, multivariate (multisite)
	     Mann-Kendall Trend Test, (Seasonal) Sen's slope, 
	     partial Pearson and Spearman correlation trend test),
             change-point detection (Lanzante's test procedures, 
	     Pettitt's test, Buishand Range Test,
	     Buishand U Test, Standard Normal Homogeinity Test),
	     detection of non-randomness (Wallis-Moore Phase Frequency Test,
	     Bartels rank von Neumann's ratio test, Wald-Wolfowitz Test)
	     and the two sample Robust Rank-Order Distributional Test.</td>
</tr>
<tr>
<td>Imports:</td>
<td>extraDistr (&ge; 1.8.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>strucchange, Kendall, psych, datasets</td>
</tr>
<tr>
<td>Classification/MSC-2010:</td>
<td>62F03, 62G10, 62M10, 62P12</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>ZipData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-10 07:57:22 UTC; thorsten</td>
</tr>
<tr>
<td>Author:</td>
<td>Thorsten Pohlert <a href="https://orcid.org/0000-0003-3855-3025"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thorsten Pohlert &lt;thorsten.pohlert@gmx.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-10 08:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bartels.test'>Bartels Test for Randomness</h2><span id='topic+bartels.test'></span>

<h3>Description</h3>

<p>Performes a rank version of von Neumann's ratio test as proposed by
Bartels. The null hypothesis of randomness is tested against the
alternative hypothesis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bartels.test(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bartels.test_+3A_x">x</code></td>
<td>
<p>a vector of class &quot;numeric&quot; or a time series object of class &quot;ts&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In this function, the test is implemented as given by Bartels (1982),
where the ranks <code class="reqn">r_1, \ldots, r_n</code> of
the <code class="reqn">X_i, \ldots, X_n</code> are used for the statistic:
</p>
<p style="text-align: center;"><code class="reqn">
T = \frac{\sum_{i=1}^n (r_i - r_{i+1})^2}{\sum_{i=1}^n (r_i - \bar{r})^2}
</code>
</p>

<p>As proposed by Bartels (1982), the <code class="reqn">p</code>-value is calculated
for sample sizes in the range of <code class="reqn">(10 \le n &lt; 100)</code> with
the non-standard beta distribution for the range <code class="reqn">0 \le x \le 4</code>
with parameters:
</p>
<p style="text-align: center;"><code class="reqn">
 a = b = \frac{5 n \left( n + 1\right) \left(n - 1\right)^2}
         {2 \left(n - 2\right)  \left(5n^2 - 2n - 9\right)} - \frac{1}{2}
</code>
</p>

<p>For sample sizes <code class="reqn">n \ge 100</code> a normal approximation with
<code class="reqn">N(2, 20/(5n + 7))</code> is used for <code class="reqn">p</code>-value calculation.
</p>


<h3>Value</h3>

<p>A list with class &quot;htest&quot;
</p>
<table>
<tr><td><code>data.name</code></td>
<td>
<p>character string that denotes the input data</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>the test statistic</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>the alternative hypothesis</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>character string that denotes the test</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The current function is for complete observations only.
</p>


<h3>References</h3>

<p>R. Bartels (1982), The Rank Version of von Neumann's Ratio Test
for Randomness, <em>Journal of the American Statistical Association</em>
77, 40&ndash;46.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ww.test">ww.test</a></code>,
<code><a href="#topic+wm.test">wm.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example from Schoenwiese (1992, p. 113)
## Number of frost days in April at Munich from 1957 to 1968
## 
frost &lt;- ts(data=c(9,12,4,3,0,4,2,1,4,2,9,7), start=1957)
bartels.test(frost)

## Example from Sachs (1997, p. 486)
x &lt;- c(5,6,2,3,5,6,4,3,7,8,9,7,5,3,4,7,3,5,6,7,8,9)
bartels.test(x)

## Example from Bartels (1982, p. 43)
x &lt;- c(4, 7, 16, 14, 12, 3, 9, 13, 15, 10, 6, 5, 8, 2, 1, 11, 18, 17)
bartels.test(x)
 
</code></pre>

<hr>
<h2 id='br.test'>Buishand Range Test for Change-Point Detection</h2><span id='topic+br.test'></span>

<h3>Description</h3>

<p>Performes the Buishand range test for change-point detection
of a normal variate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>br.test(x, m = 20000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="br.test_+3A_x">x</code></td>
<td>
<p>a vector of class &quot;numeric&quot; or a time series object of class &quot;ts&quot;</p>
</td></tr>
<tr><td><code id="br.test_+3A_m">m</code></td>
<td>
<p>numeric, number of Monte-Carlo replicates, defaults to 20000</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">X</code> denote a normal random variate, then the following model
with a single shift (change-point) can be proposed:
</p>
<p style="text-align: center;"><code class="reqn">
  x_i = \left\{
      \begin{array}{lcl}
       \mu + \epsilon_i, &amp; \qquad &amp; i = 1, \ldots, m \\
       \mu + \Delta + \epsilon_i &amp; \qquad &amp; i = m + 1, \ldots, n \\
      \end{array} \right.</code>
</p>

<p>with <code class="reqn">\epsilon \approx N(0,\sigma)</code>. The null hypothesis <code class="reqn">\Delta = 0</code>
is tested against the alternative <code class="reqn">\Delta \ne 0</code>.
</p>
<p>In the Buishand range test, the rescaled adjusted partial sums
are calculated as
</p>
<p style="text-align: center;"><code class="reqn">S_k = \sum_{i=1}^k \left(x_i - \hat{x}\right) \qquad (1 \le i \le n)</code>
</p>

<p>The test statistic is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">Rb = \left(\max S_k - \min S_k\right) / \sigma</code>
</p>
<p>. 
</p>
<p>The <code>p.value</code> is estimated with a Monte Carlo simulation
using <code>m</code> replicates.
</p>
<p>Critical values based on <code class="reqn">m = 19999</code> Monte Carlo simulations
are tabulated for <code class="reqn">Rb / \sqrt{n}</code>
by Buishand (1982).
</p>


<h3>Value</h3>

<p>A list with class &quot;htest&quot; and &quot;cptest&quot;
</p>
<table>
<tr><td><code>data.name</code></td>
<td>
<p>character string that denotes the input data</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>the test statistic</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the null hypothesis</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>the time of the probable change point</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>the alternative hypothesis</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>character string that denotes the test</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>numeric vector of Sk for plotting</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The current function is for complete observations only.
</p>


<h3>References</h3>

<p>T. A. Buishand (1982), Some Methods for Testing the Homogeneity
of Rainfall Records, <em>Journal of Hydrology</em> 58, 11&ndash;27.
</p>
<p>G. Verstraeten, J. Poesen, G. Demaree, C. Salles (2006),
Long-term (105 years) variability in rain erosivity as derived from 10-min
rainfall depth data for Ukkel (Brussels, Belgium):
Implications for assessing soil erosion rates.
<em>Journal of Geophysical Research</em> 111, D22109.
</p>


<h3>See Also</h3>

<p><code><a href="strucchange.html#topic+efp">efp</a></code>
<code><a href="strucchange.html#topic+sctest.efp">sctest.efp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Nile)
(out &lt;- br.test(Nile))
plot(out)


data(PagesData) ; br.test(PagesData)
 
</code></pre>

<hr>
<h2 id='bu.test'>Buishand U Test for Change-Point Detection</h2><span id='topic+bu.test'></span>

<h3>Description</h3>

<p>Performes the Buishand U test for change-point detection
of a normal variate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bu.test(x, m = 20000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bu.test_+3A_x">x</code></td>
<td>
<p>a vector of class &quot;numeric&quot; or a time series object of class &quot;ts&quot;</p>
</td></tr>
<tr><td><code id="bu.test_+3A_m">m</code></td>
<td>
<p>numeric, number of Monte-Carlo replicates, defaults to 20000</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">X</code> denote a normal random variate, then the following model
with a single shift (change-point) can be proposed:
</p>
<p style="text-align: center;"><code class="reqn">
  x_i = \left\{
      \begin{array}{lcl}
       \mu + \epsilon_i, &amp; \qquad &amp; i = 1, \ldots, m \\
       \mu + \Delta + \epsilon_i &amp; \qquad &amp; i = m + 1, \ldots, n \\
      \end{array} \right.</code>
</p>

<p>with <code class="reqn">\epsilon \approx N(0,\sigma)</code>. The null hypothesis <code class="reqn">\Delta = 0</code>
is tested against the alternative <code class="reqn">\Delta \ne 0</code>.
</p>
<p>In the Buishand U test, the rescaled adjusted partial sums
are calculated as
</p>
<p style="text-align: center;"><code class="reqn">S_k = \sum_{i=1}^k \left(x_i - \bar{x}\right) \qquad (1 \le i \le n)</code>
</p>

<p>The sample standard deviation is
</p>
<p style="text-align: center;"><code class="reqn">
   D_x = \sqrt{n^{-1} \sum_{i=1}^n \left(x_i - \bar{x}\right)}</code>
</p>

<p>The test statistic is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">U = \left[n \left(n + 1 \right) \right]^{-1} \sum_{k=1}^{n-1}
\left(S_k / D_x \right)^2 </code>
</p>
<p>. 
</p>
<p>The <code>p.value</code> is estimated with a Monte Carlo simulation
using <code>m</code> replicates.
</p>
<p>Critical values based on <code class="reqn">m = 19999</code> Monte Carlo simulations
are tabulated for <code class="reqn">U</code> by Buishand (1982, 1984).
</p>


<h3>Value</h3>

<p>A list with class &quot;htest&quot; and &quot;cptest&quot;
</p>
<table>
<tr><td><code>data.name</code></td>
<td>
<p>character string that denotes the input data</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>the test statistic</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the null hypothesis</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>the time of the probable change point</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>the alternative hypothesis</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>character string that denotes the test</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>numeric vector of Sk for plotting</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The current function is for complete observations only.
</p>


<h3>References</h3>

<p>T. A. Buishand (1982), Some Methods for Testing the Homogeneity
of Rainfall Records, <em>Journal of Hydrology</em> 58, 11&ndash;27.
</p>
<p>T. A. Buishand (1984), Tests for Detecting a Shift in the Mean of
Hydrological Time Series, <em>Journal of Hydrology</em> 73, 51&ndash;69.
</p>


<h3>See Also</h3>

<p><code><a href="strucchange.html#topic+efp">efp</a></code>
<code><a href="strucchange.html#topic+sctest.efp">sctest.efp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Nile)
(out &lt;- bu.test(Nile))
plot(out)

data(PagesData)
bu.test(PagesData)
 
</code></pre>

<hr>
<h2 id='cs.test'>Cox and Stuart Trend Test</h2><span id='topic+cs.test'></span>

<h3>Description</h3>

<p>Performes the non-parametric Cox and Stuart trend test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cs.test(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cs.test_+3A_x">x</code></td>
<td>
<p>a vector or a time series object of class &quot;ts&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>First, the series is devided by three. It is compared, whether the
data of the first third of the series are larger or smaller than the
data of the last third of the series.
The test statistic of the Cox-Stuart trend test for <code class="reqn">n &gt; 30</code>
is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">z = \frac{|S - \frac{n}{6}|}{\sqrt{\frac{n}{12}}}</code>
</p>

<p>where <code class="reqn">S</code> denotes the maximum of the number of signs, i.e.
<code class="reqn">+</code> or <code class="reqn">-</code>, respectively. The <code class="reqn">z</code>-statistic is
normally distributed. For <code class="reqn">n \le 30</code> a continuity correction of
<code class="reqn">-0.5</code> is included in the denominator.
</p>


<h3>Value</h3>

<p>An object of class &quot;htest&quot;
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the chosen test</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>the Cox-Stuart z-value</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test</p>
</td></tr>
</table>


<h3>Note</h3>

<p>NA values are omitted. Many ties in the series will lead
to reject H0 in the present test.
</p>


<h3>References</h3>

<p>L. Sachs (1997), <em>Angewandte Statistik</em>. Berlin: Springer.
</p>
<p>C.-D. Schoenwiese (1992), <em>Praktische Statistik</em>. Berlin:
Gebr. Borntraeger.
</p>
<p>D. R. Cox and A. Stuart (1955), Quick sign tests for trend in location
and dispersion. <em>Biometrika</em> 42, 80-95.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mk.test">mk.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example from Schoenwiese (1992, p. 114)
## Number of frost days in April at Munich from 1957 to 1968
## z = -0.5, Accept H0
frost &lt;- ts(data=c(9,12,4,3,0,4,2,1,4,2,9,7), start=1957)
cs.test(frost)

## Example from Sachs (1997, p. 486-487)
## z ~ 2.1, Reject H0 on a level of p = 0.0357
x &lt;- c(5,6,2,3,5,6,4,3,7,8,9,7,5,3,4,7,3,5,6,7,8,9)
cs.test(x)

cs.test(Nile)

</code></pre>

<hr>
<h2 id='csmk.test'>Correlated Seasonal Mann-Kendall Test</h2><span id='topic+csmk.test'></span>

<h3>Description</h3>

<p>Performs a Seasonal Mann-Kendall test under the presence of correlated
seasons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>csmk.test(x, alternative = c("two.sided", "greater", "less"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="csmk.test_+3A_x">x</code></td>
<td>
<p>a time series object with class <code>ts</code> comprising &gt;= 2 seasons;
<code>NA</code> values are not allowed</p>
</td></tr>
<tr><td><code id="csmk.test_+3A_alternative">alternative</code></td>
<td>
<p>the alternative hypothesis, defaults to <code>two.sided</code></p>
</td></tr>
</table>


<h3>Details</h3>


<p>The Mann-Kendall scores are first computed for each season seperately.
The variance - covariance matrix is computed according to Libiseller and Grimvall (2002).
Finally the corrected Z-statistics for the entire series
is calculated as follows, whereas a continuity correction is employed
for <code class="reqn">n \le 10</code>:
</p>
<p style="text-align: center;"><code class="reqn">
   z = \frac{\mathbf{1}^T \mathbf{S}}
   {\sqrt{\mathbf{1}^T \mathbf{\Gamma}~\mathbf{1}}}
   </code>
</p>

<p>where
</p>
<p><code class="reqn">z</code> denotes the quantile of the normal distribution, 1 indicates a vector
with all elements equal to one, <code class="reqn">\mathbf{S}</code> is the vector of Mann-Kendall scores
for each season and <code class="reqn">\mathbf{\Gamma}</code> denotes the variance - covariance matrix.
</p>


<h3>Value</h3>

<p>An object with class &quot;htest&quot;
</p>
<table>
<tr><td><code>data.name</code></td>
<td>
<p>character string that denotes the input data</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the entire series</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>the z quantile of the standard normal distribution
for the entire series</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the null hypothesis</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>the estimates S and varS for the entire series</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>the alternative hypothesis</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>character string that denotes the test</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p>the variance - covariance matrix</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Ties are not corrected. Current Version is for complete observations only.
</p>


<h3>References</h3>

<p>Hipel, K.W. and McLeod, A.I. (1994),
<em>Time Series Modelling of Water Resources and Environmental Systems</em>. 
New York: Elsevier Science.
</p>
<p>Libiseller, C. and Grimvall, A., (2002), Performance of partial
Mann-Kendall tests for trend detection in the presence of covariates.
<em>Environmetrics</em> 13, 71&ndash;84, <a href="https://doi.org/10.1002/env.507">doi:10.1002/env.507</a>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+cor">cor</a></code>,
<code><a href="stats.html#topic+cor.test">cor.test</a></code>,
<code><a href="#topic+mk.test">mk.test</a></code>,
<code><a href="#topic+smk.test">smk.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>csmk.test(nottem)
</code></pre>

<hr>
<h2 id='hcb'>Monthly concentration of particle bound HCB, River Rhine</h2><span id='topic+hcb'></span>

<h3>Description</h3>

<p>Time series of monthly concentration of particle bound
Hexachlorobenzene (HCB) in <code class="reqn">\mu</code>g/kg at six different
monitoring sites at the River Rhine, 1995.1-2006.12
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hcb)
</code></pre>


<h3>Format</h3>

<p>a time series object of class &quot;mts&quot;
</p>

<ul>
<li><p> we first column, series of station Weil (RKM 164.3)
</p>
</li>
<li><p> ka second column, series of station
Karlsruhe-Iffezheim (RKM 333.9)
</p>
</li>
<li><p> mz third column, series of station Mainz (RKM 498.5)
</p>
</li>
<li><p> ko fourth column, series of station Koblenz (RKM 590.3)
</p>
</li>
<li><p> bh fith column, series of station Bad Honnef(RKM 645.8)
</p>
</li>
<li><p> bi sixth column, series of station Bimmen (RKM 865.0)
</p>
</li></ul>



<h3>Details</h3>

<p>NO DATA values in the series were filled with estimated values
using linear interpolation (see <code><a href="stats.html#topic+approx">approx</a></code>.
</p>
<p>The Rhine Kilometer (RKM) is in increasing order from source to mouth
of the River Rhine.
</p>


<h3>Source</h3>

<p>International Commission for the Protection of the River Rhine
</p>


<h3>References</h3>

<p>T. Pohlert, G. Hillebrand, V. Breitung (2011), Trends of persistent
organic pollutants in the suspended matter of the River Rhine,
<em>Hydrological Processes</em> 25, 3803&ndash;3817.
<a href="https://doi.org/10.1002/hyp.8110">doi:10.1002/hyp.8110</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hcb)
plot(hcb)
mult.mk.test(hcb)
</code></pre>

<hr>
<h2 id='lanzante.test'>Lanzante's Test for Change Point Detection</h2><span id='topic+lanzante.test'></span>

<h3>Description</h3>

<p>Performes a non-parametric test after Lanzante in order to test for a
shift in the central tendency of a time series. The null hypothesis,
no shift, is tested against the alternative, shift.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lanzante.test(x, method = c("wilcox.test", "rrod.test"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lanzante.test_+3A_x">x</code></td>
<td>
<p>a vector of class &quot;numeric&quot; or a time series object of class &quot;ts&quot;</p>
</td></tr>
<tr><td><code id="lanzante.test_+3A_method">method</code></td>
<td>
<p>the test method. Defaults to <code>"wilcox.test"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">X</code> denote a continuous random variable, then the following model
with a single shift (change-point) can be proposed:
</p>
<p style="text-align: center;"><code class="reqn">
  x_i = \left\{
      \begin{array}{lcl}
       \theta + \epsilon_i, &amp; \qquad &amp; i = 1, \ldots, m \\
       \theta + \Delta + \epsilon_i &amp; \qquad &amp; i = m + 1, \ldots, n \\
      \end{array} \right.</code>
</p>

<p>with <code class="reqn">\theta(\epsilon) = 0</code>. The null hypothesis, H:<code class="reqn">\Delta = 0</code>
is tested against the alternative A:<code class="reqn">\Delta \ne 0</code>.
</p>
<p>First, the data are transformed into increasing ranks
and for each time-step the adjusted rank sum is computed:
</p>
<p style="text-align: center;"><code class="reqn">U_k = 2 \sum_{i=1}^k r_i - k \left(n + 1\right) \qquad k = 1, \ldots, n</code>
</p>

<p>The probable change point is located at the absolute maximum
of the statistic:
</p>
<p style="text-align: center;"><code class="reqn">m = k(\max |U_k|)</code>
</p>
<p>.
</p>
<p>For <code>method = "wilcox.test"</code> the Wilcoxon-Mann-Whitney two-sample
test is performed, using <code class="reqn">m</code> to split the series. Otherwise,
the robust rank-order distributional test (<code><a href="#topic+rrod.test">rrod.test</a></code> is
performed.
</p>


<h3>Value</h3>

<p>A list with class &quot;htest&quot; and &quot;cptest&quot;.
</p>


<h3>References</h3>

<p>Lanzante, J. R. (1996), Resistant, robust and non-parametric
techniques for the analysis of climate data: Theory and examples,
including applications to historical radiosonde station data,
<em>Int. J. Clim.</em>, 16, 1197&ndash;1226.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pettitt.test">pettitt.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(maxau) ; plot(maxau[,"s"])
s.res &lt;- lanzante.test(maxau[,"s"])
n &lt;- s.res$nobs
i &lt;- s.res$estimate
s.1 &lt;- mean(maxau[1:i,"s"])
s.2 &lt;- mean(maxau[(i+1):n,"s"])
s &lt;- ts(c(rep(s.1,i), rep(s.2,(n-i))))
tsp(s) &lt;- tsp(maxau[,"s"])
lines(s, lty=2)
print(s.res)


data(PagesData) ; lanzante.test(PagesData)
</code></pre>

<hr>
<h2 id='maxau'>Annual suspended sediment concentration and flow data, River Rhine</h2><span id='topic+maxau'></span>

<h3>Description</h3>

<p>Annual time series of average suspended sediment
concentration (s) in mg/l and average discharge (Q) in m^3 / s at
the River Rhine, 1965.1-2009.1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(maxau)
</code></pre>


<h3>Format</h3>

<p>a time series object of class &quot;mts&quot;
</p>

<ul>
<li><p> s. first column, suspended sediment concentration
</p>
</li>
<li><p> Q. second column, average discharge
</p>
</li></ul>



<h3>Source</h3>

<p>Bundesanstalt für Gewässerkunde, Koblenz, Deutschland
(Federal Institute of Hydrology, Koblenz, Germany)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(maxau)
plot(maxau)
</code></pre>

<hr>
<h2 id='mk.test'>Mann-Kendall Trend Test</h2><span id='topic+mk.test'></span>

<h3>Description</h3>

<p>Performs the Mann-Kendall Trend Test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mk.test(x, alternative = c("two.sided", "greater", "less"), continuity = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mk.test_+3A_x">x</code></td>
<td>
<p>a vector of class &quot;numeric&quot; or a time series object of class &quot;ts&quot;</p>
</td></tr>
<tr><td><code id="mk.test_+3A_alternative">alternative</code></td>
<td>
<p>the alternative hypothesis, defaults to <code>two.sided</code></p>
</td></tr>
<tr><td><code id="mk.test_+3A_continuity">continuity</code></td>
<td>
<p>logical, indicates whether a continuity correction
should be applied, defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The null hypothesis is that the data come from a population with
independent realizations and are identically distributed.
For the two sided test, the alternative hypothesis
is that the data follow a monotonic trend. The Mann-Kendall test
statistic is calculated according to:
</p>
<p style="text-align: center;"><code class="reqn">
S = \sum_{k = 1}^{n-1} \sum_{j = k + 1}^n
\mathrm{sgn}\left(x_j - x_k\right)</code>
</p>

<p>with <code class="reqn">\mathrm{sgn}</code> the signum function (see <code><a href="base.html#topic+sign">sign</a></code>).
</p>
<p>The mean of <code class="reqn">S</code> is <code class="reqn">\mu = 0</code>. The variance including the
correction term for ties is
</p>
<p style="text-align: center;"><code class="reqn">
\sigma^2 = \left\{n \left(n-1\right)\left(2n+5\right) -
\sum_{j=1}^p t_j\left(t_j - 1\right)\left(2t_j+5\right) \right\} / 18</code>
</p>

<p>where <code class="reqn">p</code> is the number of the tied groups in the data set and
<code class="reqn">t_j</code> is the number of data points in the <code class="reqn">j</code>-th tied group.
The statistic <code class="reqn">S</code> is approximately normally distributed, with
</p>
<p style="text-align: center;"><code class="reqn">z = S / \sigma</code>
</p>
 
<p>If <code>continuity = TRUE</code> then a continuity correction will be employed:
</p>
<p style="text-align: center;"><code class="reqn">z = \mathrm{sgn}(S) ~ \left(|S| - 1\right) / \sigma</code>
</p>

<p>The statistic <code class="reqn">S</code> is closely related to Kendall's <code class="reqn">\tau</code>:
</p>
<p style="text-align: center;"><code class="reqn">\tau = S / D</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">
D = \left[\frac{1}{2}n\left(n-1\right)-
     \frac{1}{2}\sum_{j=1}^p t_j\left(t_j - 1\right)\right]^{1/2}
    \left[\frac{1}{2}n\left(n-1\right) \right]^{1/2}
</code>
</p>



<h3>Value</h3>

<p>A list with class &quot;htest&quot;
</p>
<table>
<tr><td><code>data.name</code></td>
<td>
<p>character string that denotes the input data</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>the z quantile of the standard normal distribution</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the null hypothesis</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>the estimates S, varS and tau</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>the alternative hypothesis</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>character string that denotes the test</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Current Version is for complete observations only.
</p>


<h3>References</h3>

<p>Hipel, K.W. and McLeod, A.I. (1994),
<em>Time Series Modelling of Water Resources and Environmental Systems</em>. 
New York: Elsevier Science.
</p>
<p>Libiseller, C. and Grimvall, A., (2002), Performance of partial
Mann-Kendall tests for trend detection in the presence of covariates.
<em>Environmetrics</em> 13, 71&ndash;84, <a href="https://doi.org/10.1002/env.507">doi:10.1002/env.507</a>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+cor.test">cor.test</a></code>,
<code><a href="Kendall.html#topic+MannKendall">MannKendall</a></code>,
<code><a href="#topic+partial.mk.test">partial.mk.test</a></code>,
<code><a href="#topic+sens.slope">sens.slope</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Nile)
mk.test(Nile, continuity = TRUE)

##
n &lt;- length(Nile)
cor.test(x=(1:n),y=Nile, meth="kendall", continuity = TRUE)

</code></pre>

<hr>
<h2 id='mult.mk.test'>Multivariate (Multisite) Mann-Kendall Test</h2><span id='topic+mult.mk.test'></span><span id='topic++22Multiside'></span><span id='topic+Mann-Kendall'></span><span id='topic+Test+22'></span>

<h3>Description</h3>

<p>Performs a Multivariate (Multisite) Mann-Kendall test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mult.mk.test(x, alternative = c("two.sided", "greater", "less"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mult.mk.test_+3A_x">x</code></td>
<td>
<p>a time series object of class &quot;ts&quot;</p>
</td></tr>
<tr><td><code id="mult.mk.test_+3A_alternative">alternative</code></td>
<td>
<p>the alternative hypothesis, defaults to <code>two.sided</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Mann-Kendall scores are first computed for each variate (side)
seperately.
</p>
<p style="text-align: center;"><code class="reqn">
S = \sum_{k = 1}^{n-1} \sum_{j = k + 1}^n
\mathrm{sgn}\left(x_j - x_k\right)</code>
</p>

<p>with <code class="reqn">\mathrm{sgn}</code> the signum function (see <code><a href="base.html#topic+sign">sign</a></code>).
</p>
<p>The variance - covariance matrix is computed according to
Libiseller and Grimvall (2002).
</p>
<p style="text-align: center;"><code class="reqn">
\Gamma_{xy} = \frac{1}{3}
\left[K + 4 \sum_{j=1}^n R_{jx} R_{jy} -
n \left(n + 1 \right) \left(n + 1 \right) \right]</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">
K = \sum_{1 \le i &lt; j \le n} \mathrm{sgn} \left\{ \left( x_j - x_i \right)
\left( y_j - y_i \right) \right\}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
R_{jx} = \left\{ n + 1 + \sum_{i=1}^n
\mathrm{sgn} \left( x_j - x_i \right) \right\} / 2</code>
</p>

<p>Finally, the corrected z-statistics for the entire series
is calculated as follows, whereas a continuity correction is employed
for <code class="reqn">n \le 10</code>:
</p>
<p style="text-align: center;"><code class="reqn">
 z = \frac{\sum_{i=1}^d S_i}{\sqrt{\sum_{j=1}^d \sum_{i=1}^d \Gamma_{ij}}}
 </code>
</p>

<p>where
</p>
<p><code class="reqn">z</code> denotes the quantile of the normal distribution
<code class="reqn">S</code> is the vector of Mann-Kendall scores
for each variate (site) <code class="reqn">1 \le i \le d</code> and
<code class="reqn">\Gamma</code> denotes symmetric variance - covariance matrix.
</p>


<h3>Value</h3>

<p>An object with class &quot;htest&quot;
</p>
<table>
<tr><td><code>data.name</code></td>
<td>
<p>character string that denotes the input data</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the entire series</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>the z quantile of the standard normal distribution
for the entire series</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the null hypothesis</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>the estimates S and varS for the entire series</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>the alternative hypothesis</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>character string that denotes the test</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p>the variance - covariance matrix</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Ties are not corrected. Current Version is for complete observations only.
</p>


<h3>References</h3>

<p>Hipel, K.W. and McLeod, A.I. (1994),
<em>Time Series Modelling of Water Resources and Environmental Systems</em>. 
New York: Elsevier Science.
</p>
<p>Lettenmeier, D.P. (1988), Multivariate nonparametric tests for trend
in water quality. <em>Water Resources Bulletin</em> 24, 505&ndash;512.
</p>
<p>Libiseller, C. and Grimvall, A. (2002),
Performance of partial Mann-Kendall tests for trend detection in the
presence of covariates. <em>Environmetrics</em> 13, 71&ndash;84,
<a href="https://doi.org/10.1002/env.507">doi:10.1002/env.507</a>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+cor">cor</a></code>,
<code><a href="stats.html#topic+cor.test">cor.test</a></code>,
<code><a href="#topic+mk.test">mk.test</a></code>,
<code><a href="#topic+smk.test">smk.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hcb)
mult.mk.test(hcb)

</code></pre>

<hr>
<h2 id='PagesData'>Simulated data of Page (1955) as test-example
for change-point detection</h2><span id='topic+PagesData'></span>

<h3>Description</h3>

<p>Simulated data of Page (1955) as test-example for change-point
detection taken from Table 1 of Pettitt (1979)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PagesData)
</code></pre>


<h3>Format</h3>

<p>a vector that contains 40 elements
</p>


<h3>Details</h3>

<p>According to the publication of Pettitt (1979), the series comprise a
significant <code class="reqn">p = 0.014</code> change-point at <code class="reqn">i = 17</code>. The function
<code><a href="#topic+pettitt.test">pettitt.test</a></code> computes the same U statistics as given by
Pettitt (1979) in Table1, row 4.
</p>


<h3>References</h3>

<p>Page, E. S. (1954), A test for a change in a parameter occuring at an
unknown point. <em>Biometrika</em> 41, 100&ndash;114.
</p>
<p>Pettitt, A. N., (1979). A non-parametric approach to the change point
problem. <em>Journal of the Royal Statistical Society Series C, Applied
Statistics</em> 28, 126&ndash;135.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pettitt.test">pettitt.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PagesData)
pettitt.test(PagesData)
</code></pre>

<hr>
<h2 id='partial.cor.trend.test'>Partial Correlation Trend Test</h2><span id='topic+partial.cor.trend.test'></span>

<h3>Description</h3>

<p>Performs a partial correlation trend test with either Pearson's or
Spearman's correlation coefficients (<code class="reqn">r(tx.z)</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>partial.cor.trend.test(x, z, method = c("pearson", "spearman"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="partial.cor.trend.test_+3A_x">x</code></td>
<td>
<p>a &quot;vector&quot; or &quot;ts&quot; object that contains the variable,
which is tested for trend (i.e. correlated with time)</p>
</td></tr>
<tr><td><code id="partial.cor.trend.test_+3A_z">z</code></td>
<td>
<p>a &quot;vector&quot; or &quot;ts&quot; object that contains the co-variate, which
will be partialled out</p>
</td></tr>
<tr><td><code id="partial.cor.trend.test_+3A_method">method</code></td>
<td>
<p>a character string indicating which correlation coefficient
is to be computed. One of &quot;pearson&quot; (default) or &quot;spearman&quot;,
can be abbreviated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs a partial correlation trend test using either
the &quot;pearson&quot; correlation coefficient, or the &quot;spearman&quot; rank
correlation coefficient (Hipel and McLoed (1994), p. 882).
The partial correlation coefficient
for the response variable &quot;x&quot; with time &quot;t&quot;,
when the effect of the explanatory variable &quot;z&quot; is partialled out,
is defined as:
</p>
<p style="text-align: center;"><code class="reqn">
 r_{tx.z} = \frac{r_{tx} - r_{tz}~r_{xz}}
 {\sqrt{1 - r_{tz}^2} ~ \sqrt{1-r_{xz}^2}}
 </code>
</p>

<p>The H0: <code class="reqn">r_{tx.z} = 0</code> (i.e. no trend for &quot;x&quot;, when
effect of &quot;z&quot; is partialled out) is tested against the
alternate Hypothesis, that there is a trend for &quot;x&quot;, when the effect of
&quot;z&quot; is partialled out.
</p>
<p>The partial correlation coefficient is tested for significance with
the student t distribution on <code class="reqn">df = n - 2</code> degree of freedom.
</p>


<h3>Value</h3>

<p>An object of class &quot;htest&quot;
</p>
<table>
<tr><td><code>method</code></td>
<td>

<p>a character string indicating the chosen test
</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>

<p>a character string giving the name(s) of the data
</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>

<p>the value of the test statistic
</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>

<p>the partial correlation coefficient <code class="reqn">r(tx.z)</code>
</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>

<p>the degrees of freedom of the test statistic in the case
that it follows a t distribution
</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>

<p>a character string describing the alternative hypothesis
</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>

<p>the p-value of the test
</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>The value of the null hypothesis</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Current Version is for complete observations only.
</p>


<h3>References</h3>

<p>Hipel, K.W. and McLeod, A.I. (1994),
<em>Time Series Modelling of Water Resources and Environmental Systems</em>. 
New York: Elsevier Science.
</p>
<p>Bahrenberg, G., Giese, E. and Nipper, J., (1992): Statistische Methoden
in der Geographie, Band 2 Multivariate Statistik, Teubner, Stuttgart.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+cor">cor</a></code>,
<code><a href="stats.html#topic+cor.test">cor.test</a></code>,
<code><a href="psych.html#topic+partial.r">partial.r</a></code>,
<code><a href="#topic+partial.mk.test">partial.mk.test</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(maxau)
a &lt;- tsp(maxau) ; tt &lt;- a[1]:a[2]
s &lt;- maxau[,"s"] ; Q &lt;- maxau[,"Q"]
maxau.df &lt;- data.frame(Year = tt, s =s, Q = Q)
plot(maxau.df)

partial.cor.trend.test(s,Q, method="pearson")
partial.cor.trend.test(s,Q, method="spearman")

</code></pre>

<hr>
<h2 id='partial.mk.test'>Partial Mann-Kendall Trend Test</h2><span id='topic+partial.mk.test'></span>

<h3>Description</h3>

<p>Performs a partial Mann-Kendall Trend Test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>partial.mk.test(x, y, alternative = c("two.sided", "greater", "less"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="partial.mk.test_+3A_x">x</code></td>
<td>
<p>a &quot;vector&quot; or &quot;ts&quot; object that contains the variable,
which is tested for trend (i.e. correlated with time)</p>
</td></tr>
<tr><td><code id="partial.mk.test_+3A_y">y</code></td>
<td>
<p>a &quot;vector&quot; or &quot;ts&quot; object that contains the variable,
which effect on &quot;x&quot; is partialled out</p>
</td></tr>
<tr><td><code id="partial.mk.test_+3A_alternative">alternative</code></td>
<td>
<p>character, the alternative method; defaults to
&quot;two.sided&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>According to Libiseller and Grimvall (2002), the test statistic
for <code>x</code> with its covariate <code>y</code> is
</p>
<p style="text-align: center;"><code class="reqn">
z = \frac{S_x - r_{xy} S_y}{\left[ \left( 1 - r_{xy}^2 \right)
n \left(n - 1 \right) \left(2 n + 5 \right) / 18 \right]^{0.5}}</code>
</p>

<p>where the correlation <code class="reqn">r</code> is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">
r_{xy} = \frac{\sigma_{xy}}
{n \left(n - 1\right) \left(2 n + 5 \right) / 18}
</code>
</p>

<p>The conditional covariance between <code class="reqn">x</code> and <code class="reqn">y</code> is
</p>
<p style="text-align: center;"><code class="reqn">
\sigma_{xy} = \frac{1}{3}
\left[K + 4 \sum_{j=1}^n R_{jx} R_{jy} -
n \left(n + 1 \right) \left(n + 1 \right) \right]</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">
K = \sum_{1 \le i &lt; j \le n} \mathrm{sgn} \left\{ \left( x_j - x_i \right)
\left( y_j - y_i \right) \right\}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
R_{jx} = \left\{ n + 1 + \sum_{i=1}^n
\mathrm{sgn} \left( x_j - x_i \right) \right\} / 2</code>
</p>



<h3>Value</h3>

<p>A list with class &quot;htest&quot;
</p>
<table>
<tr><td><code>method</code></td>
<td>

<p>a character string indicating the chosen test
</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>

<p>a character string giving the name(s) of the data
</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>

<p>the value of the test statistic
</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>

<p>the Mann-Kendall score S, the variance varS and the correlation
between x and y
</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>

<p>a character string describing the alternative hypothesis
</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>

<p>the p-value of the test
</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>

<p>the null hypothesis
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Current Version is for complete observations only.
The test statistic is not corrected for ties.
</p>


<h3>References</h3>

<p>Libiseller, C. and Grimvall, A., (2002).
Performance of partial Mann-Kendall tests for trend detection in the
presence of covariates. Environmetrics 13, 71&ndash;84,
<a href="https://doi.org/10.1002/env.507">doi:10.1002/env.507</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+partial.cor.trend.test">partial.cor.trend.test</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(maxau)
s &lt;- maxau[,"s"]; Q &lt;- maxau[,"Q"]
partial.mk.test(s,Q)

</code></pre>

<hr>
<h2 id='pettitt.test'>Pettitt's Test for Change-Point Detection</h2><span id='topic+pettitt.test'></span>

<h3>Description</h3>

<p>Performes a non-parametric test after Pettitt in order to test for a
shift in the central tendency of a time series. The H0-hypothesis,
no change, is tested against the HA-Hypothesis, change.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pettitt.test(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pettitt.test_+3A_x">x</code></td>
<td>
<p>a vector of class &quot;numeric&quot; or a time series object of class &quot;ts&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In this function, the test is implemented as given by Verstraeten et. al.
(2006), where the ranks <code class="reqn">r_1, \ldots, r_n</code> of
the <code class="reqn">X_i, \ldots, X_n</code> are used for the statistic:
</p>
<p style="text-align: center;"><code class="reqn">U_k = 2 \sum_{i=1}^k r_i - k \left(n + 1\right) \qquad k = 1, \ldots, n</code>
</p>

<p>The test statistic is the maximum of the absolute value of the vector:
</p>
<p style="text-align: center;"><code class="reqn">\hat{U} = \max |U_k|</code>
</p>
<p>.
</p>
<p>The probable change-point <code class="reqn">K</code> is located where <code class="reqn">\hat{U}</code> has its maximum.
The approximate probability for a two-sided test is calculated
according to 
</p>
<p style="text-align: center;"><code class="reqn">p = 2 \exp^{-6K^2 / (T^3 + T^2)}</code>
</p>



<h3>Value</h3>

<p>A list with class &quot;htest&quot; and &quot;cptest&quot;
</p>


<h3>Note</h3>

<p>The current function is for complete observations only.
The approximate probability is good for <code class="reqn">p \le 0.5</code>.
</p>


<h3>References</h3>

<p>CHR (ed., 2010), Das Abflussregime des Rheins und seiner Nebenfluesse im
20. Jahrhundert, Report no I-22 of the CHR, p. 172.
</p>
<p>Pettitt, A. N. (1979), A non-parametric approach to the change point
problem. <em>Journal of the Royal Statistical Society Series C</em>, Applied
Statistics 28, 126-135.
</p>
<p>G. Verstraeten, J. Poesen, G. Demaree, C. Salles (2006),
Long-term (105 years) variability in rain erosivity as derived from 10-min
rainfall depth data for Ukkel (Brussels, Belgium):
Implications for assessing soil erosion rates.
<em>Journal of Geophysical Research</em> 111, D22109.
</p>


<h3>See Also</h3>

<p><code><a href="strucchange.html#topic+efp">efp</a></code>
<code><a href="strucchange.html#topic+sctest.efp">sctest.efp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(maxau) ; plot(maxau[,"s"])
s.res &lt;- pettitt.test(maxau[,"s"])
n &lt;- s.res$nobs
i &lt;- s.res$estimate
s.1 &lt;- mean(maxau[1:i,"s"])
s.2 &lt;- mean(maxau[(i+1):n,"s"])
s &lt;- ts(c(rep(s.1,i), rep(s.2,(n-i))))
tsp(s) &lt;- tsp(maxau[,"s"])
lines(s, lty=2)
print(s.res)


data(PagesData) ; pettitt.test(PagesData)
 
</code></pre>

<hr>
<h2 id='plot.cptest'>Plotting cptest-objects</h2><span id='topic+plot.cptest'></span>

<h3>Description</h3>

<p>Plotting method for objects inheriting from class &quot;cptest&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cptest'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.cptest_+3A_x">x</code></td>
<td>
<p>an object of class &quot;cptest&quot;</p>
</td></tr>
<tr><td><code id="plot.cptest_+3A_...">...</code></td>
<td>
<p>further arguments, currently ignored</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(Nile)
(out &lt;- br.test(Nile))
par(mfrow=c(2,1))
plot(Nile) ; plot(out)

</code></pre>

<hr>
<h2 id='rrod.test'>Robust Rank-Order Distributional Test</h2><span id='topic+rrod.test'></span><span id='topic+rrod.test.default'></span><span id='topic+rrod.test.formula'></span>

<h3>Description</h3>

<p>Performs Fligner-Pollicello robust rank-order distributional test
for location.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rrod.test(x, ...)

## Default S3 method:
rrod.test(x, y, alternative = c("two.sided", "less", "greater"), ...)

## S3 method for class 'formula'
rrod.test(formula, data, subset, na.action, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rrod.test_+3A_x">x</code></td>
<td>
<p>a vector of data values.</p>
</td></tr>
<tr><td><code id="rrod.test_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td></tr>
<tr><td><code id="rrod.test_+3A_y">y</code></td>
<td>
<p>an optional numeric vector of data values.</p>
</td></tr>
<tr><td><code id="rrod.test_+3A_alternative">alternative</code></td>
<td>
<p>the alternative hypothesis. Defaults to <code>"two.sided"</code>.</p>
</td></tr>
<tr><td><code id="rrod.test_+3A_formula">formula</code></td>
<td>
<p>a formula of the form <code>response ~ group</code> where
<code>response</code> gives the data values and <code>group</code> a vector or
factor of the corresponding groups.</p>
</td></tr>
<tr><td><code id="rrod.test_+3A_data">data</code></td>
<td>
<p>an optional matrix or data frame (or similar: see
<code><a href="stats.html#topic+model.frame">model.frame</a></code>) containing the variables in the
formula <code>formula</code>.  By default the variables are taken from
<code>environment(formula)</code>.</p>
</td></tr>
<tr><td><code id="rrod.test_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a 
subset of observations to be used.</p>
</td></tr>
<tr><td><code id="rrod.test_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when
the data contain <code>NA</code>s.  Defaults to <code>getOption("na.action")</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The non-parametric RROD two-sample test can be used to test
for differences in location, whereas it does not assume variance
homogeneity.
</p>
<p>Let <code class="reqn">X</code> and <code class="reqn">Y</code> denote two samples with sizes <code class="reqn">n_x</code> and <code class="reqn">n_y</code>
of a continuous variable.First, the combined sample is transformed
into ranks in increasing order.
Let <code class="reqn">S_{xi}</code> and <code class="reqn">S_{yj}</code> denote the counts of <code class="reqn">Y</code> <code class="reqn">(X)</code>
values having a lower rank than <code class="reqn">x_i</code> <code class="reqn">(y_j)</code>. The mean counts are:
</p>
<p style="text-align: center;"><code class="reqn">\bar{S}_x = \sum_{i=1}^{n_x} S_{xi} / n_x</code>
</p>

<p style="text-align: center;"><code class="reqn">\bar{S}_y = \sum_{j=1}^{n_y} S_{yj} / n_y</code>
</p>

<p>The variances are:
</p>
<p style="text-align: center;"><code class="reqn">s^2_{Sx} = \sum_{i=1}^{n_x} \left( S_{xi} - \bar{S}_x \right)^2</code>
</p>

<p style="text-align: center;"><code class="reqn">s^2_{Sy} = \sum_{j=1}^{n_y} \left( S_{yj} - \bar{S}_y \right)^2</code>
</p>

<p>The test statistic is:
</p>
<p style="text-align: center;"><code class="reqn">
z = \frac{1}{2}~
\frac{n_x \bar{S}_x - n_y \bar{S}_y}
{\left( \bar{S}_x \bar{S}_y + s^2_{Sx} + s^2_{Sy} \right)^{1/2}}</code>
</p>

<p>The two samples have significantly different location parameters,
if <code class="reqn">|z| &gt; z_{1-\alpha/2}</code>.
The function calculates the <code class="reqn">p</code>-values of the null hypothesis
for the selected alternative than can be <code>"two.sided"</code>, <code>"greater"</code>
or <code>"less"</code>.
</p>


<h3>Value</h3>

<p>A list with class <code>"htest"</code>.
</p>


<h3>References</h3>

<p>Fligner, M. A., Pollicello, G. E. III. (1981), Robust Rank Procedures for 
the Behrens-Fisher Problem, <em>Journal of the 
American Statistical Association</em>, 76, 162&ndash;168.
</p>
<p>Lanzante, J. R. (1996), Resistant, robust and non-parametric
techniques for the analysis of climate data: Theory and examples,
including applications to historical radiosonde station data,
<em>Int. J. Clim.</em>, 16, 1197&ndash;1226.
</p>
<p>Siegel, S. and Castellan, N. (1988),
<em>Nonparametric Statistics For The Behavioural Sciences</em>,
New York: McCraw-Hill.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+wilcox.test">wilcox.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Two-sample test.
## Hollander &amp; Wolfe (1973), 69f.
## Permeability constants of the human chorioamnion (a placental
##  membrane) at term (x) and between 12 to 26 weeks gestational
##  age (y).  The alternative of interest is greater permeability
##  of the human chorioamnion for the term pregnancy.
x &lt;- c(0.80, 0.83, 1.89, 1.04, 1.45, 1.38, 1.91, 1.64, 0.73, 1.46)
y &lt;- c(1.15, 0.88, 0.90, 0.74, 1.21)
rrod.test(x, y, alternative = "g")

## Formula interface.
boxplot(Ozone ~ Month, data = airquality)
rrod.test(Ozone ~ Month, data = airquality,
            subset = Month %in% c(5, 8)) 
</code></pre>

<hr>
<h2 id='sea.sens.slope'>Seasonal Sen's Slope</h2><span id='topic+sea.sens.slope'></span>

<h3>Description</h3>

<p>Computes seasonal Sen's slope  for linear rate of change
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sea.sens.slope(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sea.sens.slope_+3A_x">x</code></td>
<td>
<p>a time series object of class &quot;ts&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Acccording to Hirsch et al. (1982) the seasonal Sen's slope
is calculated as follows:
</p>
<p style="text-align: center;"><code class="reqn">
d_{ijk} = \frac{x_{ij} - x_{ik}}{j - k}
</code>
</p>

<p>for each <code class="reqn">(x_{ij}, x_{ik})</code>
pair <code class="reqn">i = 1, \ldots, m</code>,
where <code class="reqn">(1 \leq k &lt; j \leq n_i</code> and <code class="reqn">n_i</code> is
the number of known values in the <code class="reqn">i-th</code> season.
The seasonal slope estimator is the median of
the <code class="reqn">d_{ijk}</code> values.
</p>


<h3>Value</h3>

<p>numeric, Seasonal Sen's slope.
</p>


<h3>Note</h3>

<p>Current Version is for complete observations only.
</p>


<h3>References</h3>

<p>Hipel, K.W. and McLeod, A.I. (1994),
<em>Time Series Modelling of Water Resources and Environmental Systems</em>. 
New York: Elsevier Science.
</p>
<p>Hirsch, R., J. Slack, R. Smith (1982), T
echniques of Trend Analysis for Monthly Water Quality Data.
<em>Water Resources Research</em> 18, 107-121.
</p>
<p>Sen, P.K. (1968), Estimates of the regression coefficient based on
Kendall's tau, <em>Journal of the American Statistical Association</em> 63,
1379&ndash;1389.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smk.test">smk.test</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sea.sens.slope(nottem)

</code></pre>

<hr>
<h2 id='sens.slope'>Sen's slope</h2><span id='topic+sens.slope'></span>

<h3>Description</h3>

<p>Computes Sen's slope  for linear rate of change and corresponding
confidence intervalls
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sens.slope(x, conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sens.slope_+3A_x">x</code></td>
<td>
<p>numeric vector or a time series object of class &quot;ts&quot;</p>
</td></tr>
<tr><td><code id="sens.slope_+3A_conf.level">conf.level</code></td>
<td>
<p>numeric, the level of significance</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This test computes both the slope (i.e. linear rate of change) and
confidence levels according to Sen's method. First, a set of linear slopes is
calculated as follows:
</p>
<p style="text-align: center;"><code class="reqn">d_{k} = \frac{x_j - x_i}{j - i}</code>
</p>

<p>for <code class="reqn">\left(1 \le i &lt; j \le n \right)</code>, where d
is the slope, x denotes the variable, n is the number of data, and i,
j are indices.
</p>
<p>Sen's slope is then calculated as the median from all slopes:
<code class="reqn">b_{Sen} = \textnormal{median}(d_k)</code>.
</p>
<p>This function also computes the upper and lower confidence limits for
sens slope.
</p>


<h3>Value</h3>

<p>A list of class &quot;htest&quot;.
</p>
<table>
<tr><td><code>estimates</code></td>
<td>
<p>numeric, Sen's slope</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>character string that denotes the input data</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>the z quantile of the standard normal distribution</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the null hypothesis</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>upper and lower confidence limit</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>the alternative hypothesis</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>character string that denotes the test</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Current Version is for complete observations only.
</p>


<h3>References</h3>

<p>Hipel, K.W. and McLeod, A.I. (1994),
<em>Time Series Modelling of Water Resources and Environmental Systems</em>. 
New York: Elsevier Science.
</p>
<p>Sen, P.K. (1968), Estimates of the regression coefficient based on
Kendall's tau, <em>Journal of the American Statistical Association</em> 63,
1379&ndash;1389.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(maxau)
sens.slope(maxau[,"s"])
mk.test(maxau[,"s"])

</code></pre>

<hr>
<h2 id='smk.test'>Seasonal Mann-Kendall Trend Test</h2><span id='topic+smk.test'></span><span id='topic+Hirsch-Slack-Test'></span>

<h3>Description</h3>

<p>Performs a Seasonal Mann-Kendall Trend Test (Hirsch-Slack Test)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smk.test(x, alternative = c("two.sided", "greater", "less"), continuity = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smk.test_+3A_x">x</code></td>
<td>
<p>a time series object with class <code>ts</code> comprising &gt;= 2 seasons;
<code>NA</code> values are not allowed</p>
</td></tr>
<tr><td><code id="smk.test_+3A_alternative">alternative</code></td>
<td>
<p>the alternative hypothesis, defaults to <code>two.sided</code></p>
</td></tr>
<tr><td><code id="smk.test_+3A_continuity">continuity</code></td>
<td>
<p>logical, indicates, whether a continuity correction
should be done; defaults to <code>TRUE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Mann-Kendall statistic for the $g$-th season is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">
S_g = \sum_{i = 1}^{n-1} \sum_{j = i + 1}^n
\mathrm{sgn}\left(x_{jg} - x_{ig}\right), \qquad (1 \le g \le m)</code>
</p>

<p>with <code class="reqn">\mathrm{sgn}</code> the signum function (see <code><a href="base.html#topic+sign">sign</a></code>).
</p>
<p>The mean of <code class="reqn">S_g</code> is <code class="reqn">\mu_g = 0</code>. The variance including the
correction term for ties is
</p>
<p style="text-align: center;"><code class="reqn">
\sigma_g^2 = \left\{n \left(n-1\right)\left(2n+5\right) -
\sum_{j=1}^p t_{jg}\left(t_{jg} - 1\right)\left(2t_{jg}+5\right) \right\} / 18
~~ (1 \le g \le m)</code>
</p>

<p>The seasonal Mann-Kendall statistic for the entire series is calculated
according to
</p>
<p style="text-align: center;"><code class="reqn">
\begin{array}{ll}
\hat{S} = \sum_{g = 1}^m S_g &amp;
\hat{\sigma}_g^2 =  \sum_{g = 1}^m \sigma_g^2
\end{array}</code>
</p>

<p>The statistic <code class="reqn">S_g</code> is approximately normally distributed, with
</p>
<p style="text-align: center;"><code class="reqn">z_g = S_g / \sigma_g</code>
</p>
 
<p>If <code>continuity = TRUE</code> then a continuity correction will be employed:
</p>
<p style="text-align: center;"><code class="reqn">z = \mathrm{sgn}(S_g) ~ \left(|S_g| - 1\right) / \sigma_g</code>
</p>



<h3>Value</h3>

<p>An object with class &quot;htest&quot; and &quot;smktest&quot;
</p>
<table>
<tr><td><code>data.name</code></td>
<td>
<p>character string that denotes the input data</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the entire series</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>the z quantile of the standard normal distribution
for the entire series</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the null hypothesis</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>the estimates S and varS for the entire series</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>the alternative hypothesis</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>character string that denotes the test</p>
</td></tr>
<tr><td><code>Sg</code></td>
<td>
<p>numeric vector that contains S scores for each season</p>
</td></tr>
<tr><td><code>varSg</code></td>
<td>
<p>numeric vector that contains varS for each season</p>
</td></tr>
<tr><td><code>pvalg</code></td>
<td>
<p>numeric vector that contains p-values for each season</p>
</td></tr>
<tr><td><code>Zg</code></td>
<td>
<p>numeric vector that contains z-quantiles for each season</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hipel, K.W. and McLeod, A.I. (1994),
<em>Time Series Modelling of Water Resources and Environmental Systems</em>. 
New York: Elsevier Science.
</p>
<p>Libiseller, C. and Grimvall, A. (2002), Performance of partial
Mann-Kendall tests for trend detection in the presence of covariates.
<em>Environmetrics</em> 13, 71&ndash;84, <a href="https://doi.org/10.1002/env.507">doi:10.1002/env.507</a>.
</p>
<p>R. Hirsch, J. Slack, R. Smith (1982), Techniques of Trend Analysis for
Monthly Water Quality Data, <em>Water Resources Research</em> 18, 107&ndash;121.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>res &lt;- smk.test(nottem)
## print method
res
## summary method
summary(res)

</code></pre>

<hr>
<h2 id='snh.test'>Standard Normal Homogeinity Test (SNHT) for Change-Point Detection</h2><span id='topic+snh.test'></span>

<h3>Description</h3>

<p>Performes the Standard Normal Homogeinity Test (SNHT)
for change-point detection of a normal variate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>snh.test(x, m = 20000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="snh.test_+3A_x">x</code></td>
<td>
<p>a vector of class &quot;numeric&quot; or a time series object of class &quot;ts&quot;</p>
</td></tr>
<tr><td><code id="snh.test_+3A_m">m</code></td>
<td>
<p>numeric, number of Monte-Carlo replicates, defaults to 20000</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">X</code> denote a normal random variate, then the following model
with a single shift (change-point) can be proposed:
</p>
<p style="text-align: center;"><code class="reqn">
  x_i = \left\{
      \begin{array}{lcl}
       \mu + \epsilon_i, &amp; \qquad &amp; i = 1, \ldots, m \\
       \mu + \Delta + \epsilon_i &amp; \qquad &amp; i = m + 1, \ldots, n \\
      \end{array} \right.</code>
</p>

<p>with <code class="reqn">\epsilon \approx N(0,\sigma)</code>. The null hypothesis <code class="reqn">\Delta = 0</code>
is tested against the alternative <code class="reqn">\Delta \ne 0</code>.
</p>
<p>The test statistic for the SNHT test is calculated as follows:
</p>
<p style="text-align: center;"><code class="reqn">T_k = k z_1^2 + \left(n - k\right) z_2^2 \qquad (1 \le k &lt; n)</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">
\begin{array}{l l}
z_1 = \frac{1}{k} \sum_{i=1}^k \frac{x_i - \bar{x}}{\sigma} &amp;
z_2 = \frac{1}{n-k} \sum_{i=k+1}^n \frac{x_i - \bar{x}}{\sigma}. \\
\end{array}</code>
</p>

<p>The critical value is:
</p>
<p style="text-align: center;"><code class="reqn">T = \max T_k.</code>
</p>
 
<p>The <code>p.value</code> is estimated with a Monte Carlo simulation
using <code>m</code> replicates.
</p>
<p>Critical values based on <code class="reqn">m = 1,000,000</code> Monte Carlo simulations
are tabulated for <code class="reqn">T</code> by Khaliq and Ouarda (2007).
</p>


<h3>Value</h3>

<p>A list with class &quot;htest&quot; and &quot;cptest&quot;
</p>
<table>
<tr><td><code>data.name</code></td>
<td>
<p>character string that denotes the input data</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>the test statistic</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the null hypothesis</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>the time of the probable change point</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>the alternative hypothesis</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>character string that denotes the test</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>numeric vector of Tk for plotting</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The current function is for complete observations only.
</p>


<h3>References</h3>

<p>H. Alexandersson (1986), A homogeneity test applied to precipitation data,
<em>Journal of Climatology</em> 6, 661&ndash;675.
</p>
<p>M. N. Khaliq, T. B. M. J. Ouarda (2007), On the critical values of the
standard normal homogeneity test (SNHT),
<em>International Journal of Climatology</em> 27, 681&ndash;687.
</p>
<p>G. Verstraeten, J. Poesen, G. Demaree, C. Salles (2006),
Long-term (105 years) variability in rain erosivity as derived from 10-min
rainfall depth data for Ukkel (Brussels, Belgium):
Implications for assessing soil erosion rates.
<em>Journal of Geophysical Research</em> 111, D22109.
</p>


<h3>See Also</h3>

<p><code><a href="strucchange.html#topic+efp">efp</a></code>
<code><a href="strucchange.html#topic+sctest.efp">sctest.efp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Nile)
(out &lt;- snh.test(Nile))
plot(out)

data(PagesData) ; snh.test(PagesData)
 
</code></pre>

<hr>
<h2 id='summary.smktest'>Object summaries</h2><span id='topic+summary.smktest'></span>

<h3>Description</h3>

<p>Generic function &quot;summary&quot; for objects of class <code>smktest</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'smktest'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.smktest_+3A_object">object</code></td>
<td>
<p>an object of class <code>smktest</code></p>
</td></tr>
<tr><td><code id="summary.smktest_+3A_...">...</code></td>
<td>
<p>further arguments, currently ignored</p>
</td></tr>
</table>

<hr>
<h2 id='wm.test'>Wallis and Moore Phase-Frequency Test</h2><span id='topic+wm.test'></span>

<h3>Description</h3>

<p>Performes the non-parametric Wallis and Moore phase-frequency
test for testing the H0-hypothesis, whether the series
comprises random data, against the HA-Hypothesis, that the series
is significantly different from randomness (two-sided test).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wm.test(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wm.test_+3A_x">x</code></td>
<td>
<p>a vector or a time series object of class &quot;ts&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test statistic of the phase-frequency test for <code class="reqn">n &gt; 30</code>
is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">z = \frac{| h - \frac{2 n - 7}{3}|}{\sqrt{\frac{16 n - 29}{90}}}</code>
</p>

<p>where <code class="reqn">h</code> denotes the number of phases, whereas the first and the
last phase is not accounted. The <code class="reqn">z</code>-statistic is
normally distributed. For <code class="reqn">n \le 30</code> a continuity correction of
<code class="reqn">-0.5</code> is included in the denominator.
</p>


<h3>Value</h3>

<p>An object of class &quot;htest&quot;
</p>
<table>
<tr><td><code>method</code></td>
<td>

<p>a character string indicating the chosen test
</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>

<p>a character string giving the name(s) of the data
</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>

<p>the Wallis and Moore z-value
</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>

<p>a character string describing the alternative hypothesis
</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>

<p>the p-value for the test
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>NA values are omitted. Many ties in the series will lead to reject H0
in the present test.
</p>


<h3>References</h3>

<p>L. Sachs (1997), <em>Angewandte Statistik</em>. Berlin: Springer.
</p>
<p>C.-D. Schoenwiese (1992), <em>Praktische Statistik</em>. Berlin:
Gebr. Borntraeger.
</p>
<p>W. A. Wallis and G. H. Moore (1941): A significance test for time series
and other ordered observations. Tech. Rep. 1. National Bureau of
Economic Research. New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mk.test">mk.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example from Schoenwiese (1992, p. 113)
## Number of frost days in April at Munich from 1957 to 1968
## z = -0.124, Accept H0
frost &lt;- ts(data=c(9,12,4,3,0,4,2,1,4,2,9,7), start=1957)
wm.test(frost)

## Example from Sachs (1997, p. 486)
## z = 2.56, Reject H0 on a level of p &lt; 0.05
x &lt;- c(5,6,2,3,5,6,4,3,7,8,9,7,5,3,4,7,3,5,6,7,8,9)
wm.test(x)

wm.test(nottem)

</code></pre>

<hr>
<h2 id='ww.test'>Wald-Wolfowitz Test for Independence and Stationarity</h2><span id='topic+ww.test'></span>

<h3>Description</h3>

<p>Performes the non-parametric Wald-Wolfowitz test for
independence and stationarity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ww.test(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ww.test_+3A_x">x</code></td>
<td>
<p>a vector or a time series object of class &quot;ts&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">x_1, x_2, ..., x_n</code> denote the sampled data, then the test
statistic of the Wald-Wolfowitz test is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">R = \sum_{i=1}^{n-1} x_i x_{i+1} + x_1 x_n</code>
</p>

<p>The expected value of R is:
</p>
<p style="text-align: center;"><code class="reqn">E(R) = \frac{s_1^2 - s_2}{n - 1}</code>
</p>

<p>The expected variance is:
</p>
<p style="text-align: center;"><code class="reqn">V(R) = \frac{s_2^2 - s_4}{n - 1} - E(R)^2 + \frac{s_1^4 -
     4 s_1^2 s_2 + 4 s_1 s_3 + s_2^2 - 2 s_4}{(n - 1) (n - 2)}</code>
</p>

<p>with:
</p>
<p style="text-align: center;"><code class="reqn">s_t = \sum_{i=1}^{n} x_i^t, ~~ t = 1, 2, 3, 4</code>
</p>

<p>For <code class="reqn">n &gt; 10</code> the test statistic is normally distributed, with:
</p>
<p style="text-align: center;"><code class="reqn">z = \frac{R - E(R)}{\sqrt{V(R)}}</code>
</p>

<p>ww.test calculates p-values from the standard normal distribution for
the two-sided case.
</p>


<h3>Value</h3>

<p>An object of class &quot;htest&quot;
</p>
<table>
<tr><td><code>method</code></td>
<td>

<p>a character string indicating the chosen test
</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>

<p>a character string giving the name(s) of the data
</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>

<p>the Wald-Wolfowitz z-value
</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>

<p>a character string describing the alternative hypothesis
</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>

<p>the p-value for the test
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>NA values are omitted.
</p>


<h3>References</h3>

<p>R. K. Rai, A. Upadhyay, C. S. P. Ojha and L. M. Lye (2013),
Statistical analysis of hydro-climatic variables. In:
R. Y. Surampalli, T. C. Zhang, C. S. P. Ojha, B. R. Gurjar,
R. D. Tyagi and C. M. Kao (ed. 2013), <em>Climate change modelling,
mitigation, and adaptation</em>. Reston, VA: ASCE. doi =
10.1061/9780784412718.
</p>
<p>A. Wald and J. Wolfowitz (1943), An exact test for randomness in the
non-parametric case based on serial correlation.
<em>Annual Mathematical Statistics</em> 14, 378&ndash;388.
</p>
<p>WMO (2009), <em>Guide to Hydrological Practices</em>. Volume II,
Management of Water Resources and Application of Hydrological
Practices, WMO-No. 168.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ww.test(nottem)
ww.test(Nile)

set.seed(200)
x &lt;- rnorm(100)
ww.test(x)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
