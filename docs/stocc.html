<!DOCTYPE html><html><head><title>Help for package stocc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {stocc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#stocc-package'><p>Fit a Spatial Occupancy Model via Gibbs Sampling</p></a></li>
<li><a href='#habData'><p>A simulated data set of environmental covariates</p></a></li>
<li><a href='#icar.Q'><p>Creates the inverse covariance matrix for an intrinsic conditionally</p>
autoregressive spatial model.</a></li>
<li><a href='#make.so.data'><p>Create spatial data object for model fitting via <code>spatialOccupancy</code></p>
function</a></li>
<li><a href='#occupancyData'><p>Simulated occupancy for the 40 x 40 study area.</p></a></li>
<li><a href='#spatial.occupancy'><p>Fit a spatial occupancy model using Gibbs sampling</p></a></li>
<li><a href='#visitData'><p>Simulated occupancy survey data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fit a Spatial Occupancy Model via Gibbs Sampling</td>
</tr>
<tr>
<td>Version:</td>
<td>1.31</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-05-10</td>
</tr>
<tr>
<td>Author:</td>
<td>Devin S. Johnson</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Devin S. Johnson &lt;devin.johnson@noaa.gov&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit a spatial-temporal occupancy models using
    a probit formulation instead of a traditional logit
    model.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/publicdomain/zero/1.0/legalcode">CC0</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>truncnorm, coda, Matrix, fields, rARPACK</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-05-11 17:10:18 UTC; devin.johnson</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-05-11 17:30:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='stocc-package'>Fit a Spatial Occupancy Model via Gibbs Sampling</h2><span id='topic+stocc-package'></span><span id='topic+stocc'></span>

<h3>Description</h3>

<p>This package contains functions that fit a spatial occupancy model where the
true occupancy is a function of a spatial process.  An efficient Gibbs
sampling algorithm is used by formulating the detection and occupancy
process models with a probit model instead of the traditional logit based
model.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;"> Package: </td><td style="text-align: left;"> stocc</td>
</tr>
<tr>
 <td style="text-align: left;"> Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;"> Version: </td><td style="text-align: left;">
1.4</td>
</tr>
<tr>
 <td style="text-align: left;"> Date: </td><td style="text-align: left;"> May 10, 2021</td>
</tr>
<tr>
 <td style="text-align: left;"> License: </td><td style="text-align: left;"> CC0</td>
</tr>
<tr>
 <td style="text-align: left;"> LazyLoad: </td><td style="text-align: left;">
yes</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Devin S. Johnson
</p>
<p>Maintainer: Devin S. Johnson &lt;devin.johnson@noaa.gov&gt;
</p>

<hr>
<h2 id='habData'>A simulated data set of environmental covariates</h2><span id='topic+habData'></span>

<h3>Description</h3>

<p>This data represents a simulated study area. The study area is a 40 x 40
grid of pixels. There are two variables, a factor variable (e.g., a habitat
layer), as well as, a continuous covariate.
</p>


<h3>Format</h3>

<p>A data frame with 1600 observations on the following 5 variables.
</p>
 <dl>
<dt>site</dt><dd><p>Site labels</p>
</dd> 
<dt>x</dt><dd><p>Longitude
coordinate</p>
</dd> <dt>y</dt><dd><p>Latitude coordinate</p>
</dd> <dt>habCov1</dt><dd><p>a
factor with levels <code>1</code> <code>2</code> <code>3</code></p>
</dd> <dt>habCov2</dt><dd><p>a numeric
vector</p>
</dd> </dl>



<h3>Examples</h3>

<pre><code class='language-R'>
data(habData)
image(x=seq(0.5,39.5,1), y=seq(0.5,39.5,1), 
	z=t(matrix(as.numeric(habData$habCov1),40)), main="habData: Factor environmental covariate",
	xlab="x", ylab="y", col=rainbow(3))


dev.new()
image(x=seq(0.5,39.5,1), y=seq(0.5,39.5,1), 
	z=t(matrix(habData$habCov2,40)), main="habData: Continuous environmental covariate",
	xlab="x", ylab="y", col=terrain.colors(50))


</code></pre>

<hr>
<h2 id='icar.Q'>Creates the inverse covariance matrix for an intrinsic conditionally
autoregressive spatial model.</h2><span id='topic+icar.Q'></span>

<h3>Description</h3>

<p>This function creates the ICAR precision matrices used in the spatial models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>icar.Q(xy, threshold, rho = 1, fun = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="icar.Q_+3A_xy">xy</code></td>
<td>
<p>An n x 2 matrix of spatial coordinates</p>
</td></tr>
<tr><td><code id="icar.Q_+3A_threshold">threshold</code></td>
<td>
<p>Distance threshold for neighborhood definition</p>
</td></tr>
<tr><td><code id="icar.Q_+3A_rho">rho</code></td>
<td>
<p>The autoregressive parameter. Defaults to 1, which is the
Intrinsic Conditionally AutoRegressive model (ICAR)</p>
</td></tr>
<tr><td><code id="icar.Q_+3A_fun">fun</code></td>
<td>
<p>If <code>TRUE</code> this function returns a function of rho that generates the precision matrix of a ICAR process</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Constructs the inverse covariance matrix (aside from scaling) for the ICAR
model
</p>


<h3>Value</h3>

<p>An n x n matrix
</p>


<h3>Author(s)</h3>

<p>Devin S. Johnson &lt;devin.johnson@noaa.gov&gt;
</p>

<hr>
<h2 id='make.so.data'>Create spatial data object for model fitting via <code>spatialOccupancy</code>
function</h2><span id='topic+make.so.data'></span>

<h3>Description</h3>

<p>This function takes an observation data frame and a data frame of site
characteristics and combines them together for analysis with the
<code><a href="#topic+spatial.occupancy">spatial.occupancy</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.so.data(visit.data, site.data, names)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make.so.data_+3A_visit.data">visit.data</code></td>
<td>
<p>A data frame that contains the observed occupancy for each
site and any detection related covariates.</p>
</td></tr>
<tr><td><code id="make.so.data_+3A_site.data">site.data</code></td>
<td>
<p>A data frame that contains the site id, coordinates, and
any habitat related covariates that might influence the occupancy process</p>
</td></tr>
<tr><td><code id="make.so.data_+3A_names">names</code></td>
<td>
<p>A named list with the following elements: (1)<code>visit</code> A
named list with elements &quot;site&quot; = the name of the site id in the observation
data frame and &quot;obs&quot; = the name of the observed occupancy variable (2)
<code>site</code> A named list with elements &quot;site&quot; = the name of the site id and
&quot;coords&quot; = a character vector giving the name of the coordinates (x first
then y)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function combines the two data frames and assigns names so that
<code>spatial.occupancy</code> knows which columns to use. It also performs
some rudimentary error checking to make sure the data is in the proper form
(e.g., the site IDs in the visit data frame must be contained in the site
IDs for the site data frame)
</p>


<h3>Value</h3>

<p>An <code>so.data</code> object is a list with elements equal to the two
data frames. Attributes are set giving the names of columns of interest
</p>


<h3>Author(s)</h3>

<p>Devin S. Johnson &lt;devin.johnson@noaa.gov&gt;
</p>

<hr>
<h2 id='occupancyData'>Simulated occupancy for the 40 x 40 study area.</h2><span id='topic+occupancyData'></span>

<h3>Description</h3>

<p>This data represnts truth with regards to occupancy in the simulated study
area. The probability of occupancy was simulated as <code>pnorm(0, X
+ K alpha, 1, lower=FALSE)</code>, where <code>K</code> and <code>alpha</code> were constructed 
from a reduced rank is an ICAR process with precision
(<code>tau</code>) = 0.3 and <code>gamma = c(-1, 0, 0, 1)</code>
</p>


<h3>Format</h3>

<p>A data frame with 1600 observations on the following 5 variables.
</p>
 
<dl>
<dt>site</dt><dd><p>Site labels</p>
</dd> 
<dt>x</dt><dd><p>Longitude coordinate</p>
</dd> 
<dt>y</dt><dd><p>Latitude coordinate</p>
</dd> 
<dt>psi</dt><dd><p>True probability of occupancy</p>
</dd> 
<dt>psi.fix</dt><dd><p>The fixed effects portion of the occupancy process map</p>
</dd>
<dt>occ</dt><dd><p>True realized occupancy</p>
</dd> 
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
data(occupancyData)
##
## Blue points represent realized occupancy.
##
image(x=seq(0.5,39.5,1), y=seq(0.5,39.5,1), z=t(matrix(occupancyData$psi,40)), 
	xlab="x", ylab="y", main="Occupancy process with realized occupancy")
points(occupancyData$x[occupancyData$occ==1], occupancyData$y[occupancyData$occ==1], 
 pch=20, cex=0.25, col="blue")

</code></pre>

<hr>
<h2 id='spatial.occupancy'>Fit a spatial occupancy model using Gibbs sampling</h2><span id='topic+spatial.occupancy'></span>

<h3>Description</h3>

<p>This function fits a spatial occupancy model where the true occupancy is a
function of a spatial process.  An efficient Gibbs sampling algorithm is
used by formulating the detection and occupancy process models with a probit
model instead of the traditional logit based model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spatial.occupancy(
  detection.model,
  occupancy.model,
  spatial.model,
  so.data,
  prior,
  control,
  initial.values = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spatial.occupancy_+3A_detection.model">detection.model</code></td>
<td>
<p>A formula object describing the detection portion of
the occupancy model. The variables described by the detection model are
located in the <code>visit</code> data frame of the <code>so.data</code>.</p>
</td></tr>
<tr><td><code id="spatial.occupancy_+3A_occupancy.model">occupancy.model</code></td>
<td>
<p>A formula object describing the fixed effects portion
of the spatial occupancy process. The variables described by the occupancy
model are located in the <code>site</code> data frame of an <code>so.data</code> object.</p>
</td></tr>
<tr><td><code id="spatial.occupancy_+3A_spatial.model">spatial.model</code></td>
<td>
<p>A named list object describing the spatial component of
the occupancy process. Currently the only possible models are ICAR, restricted spatial regression,
process convolution models, and no spatial model (i.e., eta = 0). Thus, <code>spatial.model=list(model="icar",
threshold= )</code>, <code>spatial.model=list(model="rsr", threshold=, moran.cut=)</code>, 
<code>spatial.model=list(model="proc.conv", knots=)</code>, and <code>spatial.model=list(model="none")</code>
are the only forms that are accepted at present.  The <code>threshold</code>
component is used the create neighborhoods in the ICAR and RSR models.  All sites
within distance <code>threshold</code> of site i are considered neighbors of site
i.  The <code>moran.cut</code> component is the cut-off for selecting 
the spatial harmonics used in the restricted spatial regression model. The value must be between 1 and N and implies that
the eigen vectors associated with the largest <code>moan.cut</code> eigen values are used for the basis functions.
The item <code>knots</code> are xy locations of the discrete process
convolution knots.</p>
</td></tr>
<tr><td><code id="spatial.occupancy_+3A_so.data">so.data</code></td>
<td>
<p>An <code>so.data</code> object containing the observed occupancies,
detection covariates, site covariates, and site coordinates. This is created
via the <code><a href="#topic+make.so.data">make.so.data</a></code></p>
</td></tr>
<tr><td><code id="spatial.occupancy_+3A_prior">prior</code></td>
<td>
<p>A named list that provides the parameter values for the prior
distributions. At the current time the elements of the list must contain
<code>a.tau</code> and <code>b.tau</code> which are the parameters for the gamma prior on the spatial
process parameter in the occupancy model. Other elements may include
<code>Q.b</code> and <code>mu.b</code> which are the tolerance and mean for the beta
vector (detection parameters). Also <code>Q.g</code> and <code>mu.g</code> which are the
prior parameters for the occupancy model. If the Q.b and Q.g are left out,
the default is Q.b = 0 and Q.g = 0 (i.e., flat priors). If mu.b and mu.g are left out,
the default is zero vectors.</p>
</td></tr>
<tr><td><code id="spatial.occupancy_+3A_control">control</code></td>
<td>
<p>A named list with the control parameters for the MCMC. The
elements of the list must include: (1) <code>burnin</code> is the number of
iterations of burnin, (2) <code>iter</code> is the total number of iterations
retained for the MCMC sample, and (3) <code>thin</code> is the thining rate of the
chain. The real number of MCMC iterations is equal to <code>iter*thin</code> of
which <code>iter - burnin</code> are retained for posterior summary.</p>
</td></tr>
<tr><td><code id="spatial.occupancy_+3A_initial.values">initial.values</code></td>
<td>
<p>A named list that can include any or all of the following vectors or scalers 
(1) <code>beta</code>, a vector of initial values for the detection parameters, (2) <code>gamma</code>, a vector or
initial values for the occupancy model, and (3) <code>tau</code>, an initial value for the spatial precision 
parameter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A Gibbs sampler is run to draw an MCMC sample of the spatial occupancy
parameters <code>beta</code> (detection parameters), <code>gamma</code> (the occupancy
parameters), <code>psi</code> (the model occupancy generating process), and the
realized occupancy.
</p>


<h3>Value</h3>

<p>A list with the following elements: </p>
<table>
<tr><td><code>beta</code></td>
<td>
<p>An object of class
<code>mcmc</code>. The detection model parameters.</p>
</td></tr> <tr><td><code>gamma</code></td>
<td>
<p>An object of
class <code>mcmc</code>. The occupancy model parameters.</p>
</td></tr> <tr><td><code>psi</code></td>
<td>
<p>An object of
class <code>mcmc</code>. The occupancy generating process</p>
</td></tr> <tr><td><code>real.occ</code></td>
<td>
<p>An
object of class <code>mcmc</code>. The realized occupancy at the time of the
survey</p>
</td></tr>  <tr><td><code>tau</code></td>
<td>
<p>An object of
class <code>mcmc</code>. The variance parameter for the spatial model</p>
</td></tr>
<tr><td><code>occupancy.df</code></td>
<td>
<p>A data frame with the spatial
coordinates, site id, and posterior mean and variance of psi, eta, and real.occ</p>
</td></tr>
<tr><td><code>D.m</code></td>
<td>
<p>The posterior predictive loss criterion of Gelfand and Ghosh
(1998; Biometrika 85:1-11) for model selection. The criterion is a combination of a goodness-of-fit measure, G.m, and 
a complexity measure, P.m, similar information criteria such as AIC and BIC. D.m = G.m + P.m. Lower values of D.m imply lower 
expected loss in predicting new data with the posterior model parameters.</p>
</td></tr> 
<tr><td><code>G.m</code></td>
<td>
<p>The
goodness-of-fit portion of D.m</p>
</td></tr> <tr><td><code>P.m</code></td>
<td>
<p>The model complexity component of
D.m</p>
</td></tr> <tr><td><code>detection.model</code></td>
<td>
<p>The detection model call.</p>
</td></tr>
<tr><td><code>occupancy.model</code></td>
<td>
<p>The occupancy model call.</p>
</td></tr> <tr><td><code>model</code></td>
<td>
<p>A character
version of the joint occupancy and detection model call. This is useful for
saving results.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Devin S. Johnson &lt;devin.johnson@noaa.gov&gt;
</p>

<hr>
<h2 id='visitData'>Simulated occupancy survey data</h2><span id='topic+visitData'></span>

<h3>Description</h3>

<p>Data set representing a simulated survey of the 40 x 40 study area.
Approximately 1/3 of the 1600 sites were visited at least once. Those sites
that were surveyed were visited a random number of times with an average of
2.5 visits. Detection was simulated as a function of 2 covariates, a
continuous one (cov1) and a factor (cov2). These are NOT the same as the
cov1 and cov2 of the habData data frame. The coefficients used were
<code>beta = c(1, 0, 0.5, 1, 0)</code>. Thus detection given occupancy of site i
at time j = <code>pnorm(0,X%*%beta,lower=FALSE)</code>.
</p>


<h3>Format</h3>

<p>A data frame with 1340 observations on the following 6 variables.
</p>
 <dl>
<dt>site</dt><dd><p>Site labels</p>
</dd> <dt>x</dt><dd><p>Longitude
coordinate</p>
</dd> <dt>y</dt><dd><p>Latitude coordinate</p>
</dd> <dt>detCov1</dt><dd><p>a
numeric vector</p>
</dd> <dt>detCov2</dt><dd><p>a factor with levels <code>0</code> <code>1</code>
<code>2</code> <code>3</code></p>
</dd> <dt>obs</dt><dd><p>a numeric vector</p>
</dd> </dl>



<h3>Examples</h3>

<pre><code class='language-R'>
data(visitData)
data(occupancyData)
##
## Blue points represent visited sites and green circles represent confirmed occupancy.
##
image(x=seq(0.5,39.5,1), y=seq(0.5,39.5,1), z=t(matrix(occupancyData$psi,40)), 
	xlab="x", ylab="y", main="Occupancy process with visits")
points(visitData$x[visitData$obs==1], visitData$y[visitData$obs==1], col="green")
points(visitData$x, visitData$y, col="blue", pch=20, cex=0.25)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
