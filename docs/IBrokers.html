<!DOCTYPE html><html><head><title>Help for package IBrokers</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {IBrokers}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.placeOrder'>
<p>TWS Orders</p></a></li>
<li><a href='#.twsIncomingMSG'><p> Internal TWS-API MSG and ERR List</p></a></li>
<li><a href='#calculateImpliedVolatility'>
<p>Calculate Option Values</p></a></li>
<li><a href='#eWrapper'><p> eWrapper Closure For Message Processing</p></a></li>
<li><a href='#exerciseOptions'>
<p>Exercise Options Contracts</p></a></li>
<li><a href='#IBrokers-package'>
<p>R API to the Interactive Brokers Trader Workstation (TWS).</p></a></li>
<li><a href='#processMsg'><p> Main TWS-API Event Manager</p></a></li>
<li><a href='#reqAccountUpdates'><p> Request Account Updates</p></a></li>
<li><a href='#reqContractDetails'><p> Request Contract Details From TWS</p></a></li>
<li><a href='#reqCurrentTime'><p> Request The Current TWS Time</p></a></li>
<li><a href='#reqHistoricalData'><p> Request Historical Data From TWS</p></a></li>
<li><a href='#reqIds'>
<p>Request Next Valid Id</p></a></li>
<li><a href='#reqManagedAccts'><p> Managed Accounts</p></a></li>
<li><a href='#reqMatchingSymbols'><p> Stock Contract Search</p></a></li>
<li><a href='#reqMktData'><p> Request Market Data Feed from TWS</p></a></li>
<li><a href='#reqMktDataType'><p> Request Market Data Type from TWS</p></a></li>
<li><a href='#reqMktDepth'><p> Request Market Depth Feed from TWS</p></a></li>
<li><a href='#reqNewsBulletins'>
<p>Subscribe or Unsubscribe To News Bulletins</p></a></li>
<li><a href='#reqRealTimeBars'><p> Request Real Time Bars from TWS</p></a></li>
<li><a href='#setServerLogLevel'><p> Enable API Logging Via TWS</p></a></li>
<li><a href='#twsCALLBACK'><p> Internal Data Callback Routine</p></a></li>
<li><a href='#twsConnect'><p> Establish, Check or Terminate a Connection to TWS or IBG</p></a></li>
<li><a href='#twsConnectionTime'><p> TWS API Utility Functions</p></a></li>
<li><a href='#twsContract'><p> Create a twsContract</p></a></li>
<li><a href='#twsCurrency'><p> Create a twsCurrency</p></a></li>
<li><a href='#twsEquity'><p> Create a twsEquity</p></a></li>
<li><a href='#twsFuture'><p> Create a twsFuture Contract</p></a></li>
<li><a href='#twsOption'><p> Create a twsContract for Options</p></a></li>
<li><a href='#twsOrder'>
<p>Create twsOrder Object</p></a></li>
<li><a href='#twsScannerSubscription'>
<p>Create ScannerSubscription</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>R API to Interactive Brokers Trader Workstation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.10-2</td>
</tr>
<tr>
<td>Depends:</td>
<td>xts, zoo</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides native R access to Interactive Brokers Trader Workstation API.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-15 18:35:34 UTC; josh</td>
</tr>
<tr>
<td>Author:</td>
<td>Jeffrey A. Ryan [aut, cph],
  Joshua M. Ulrich [cre, aut],
  J.W. de Roode [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Joshua M. Ulrich &lt;josh.m.ulrich@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-16 09:30:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='.placeOrder'>
TWS Orders
</h2><span id='topic+.placeOrder'></span><span id='topic+placeOrder'></span><span id='topic+cancelOrder'></span>

<h3>Description</h3>

<p>Place or cancel an order to the TWS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>placeOrder(twsconn, Contract, Order)

cancelOrder(twsconn, orderId)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".placeOrder_+3A_twsconn">twsconn</code></td>
<td>

<p>A twsConnection object.
</p>
</td></tr>
<tr><td><code id=".placeOrder_+3A_contract">Contract</code></td>
<td>

<p>A twsContract object.
</p>
</td></tr>
<tr><td><code id=".placeOrder_+3A_order">Order</code></td>
<td>

<p>A twsOrder object.
</p>
</td></tr>
<tr><td><code id=".placeOrder_+3A_orderid">orderId</code></td>
<td>

<p>A valid order id.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As described by the official Interactive Brokers (tm) documentation.  Caveat Emptor!!
</p>


<h3>Value</h3>

<p>Called for its side effect of placing or cancelling an order on the TWS. This also
returns the orderId used for placeOrder.  An additional side-effect is that
a variable .Last.orderId will be created or updated in the GlobalEnv as well.
</p>


<h3>Note</h3>

<p>Orders via the API are quite complicated, or at least can be.  It is strongly advised to
only proceed with trading real money after one understands not only all the R
code in this package, but the official API as well.  If you are more comfortable
clicking shiny buttons in a GUI, it is probably better that you keep clicking
the buttons and not pretend to program.
</p>
<p>Not for the faint of heart. All profits and losses related are yours and
yours alone.  If you don't like it, write it yourself.
</p>


<h3>Author(s)</h3>

<p>Jeffrey A. Ryan
</p>


<h3>References</h3>

<p>Official Place Order API:
<a href="https://interactivebrokers.github.io/tws-api/classIBApi_1_1EClient.html#aa6ff6f6455c551bef9d66c34d1c8586c">https://interactivebrokers.github.io/tws-api/classIBApi_1_1EClient.html#aa6ff6f6455c551bef9d66c34d1c8586c</a>
</p>


<h3>See Also</h3>


<p><code><a href="#topic+twsContract">twsContract</a></code>
<code><a href="#topic+twsOrder">twsOrder</a></code>
<code><a href="#topic+reqIds">reqIds</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
tws &lt;- twsConnect()
id &lt;- reqIds(tws)

placeOrder(tws, twsSTK("AAPL"), twsOrder(id))
cancelOrder(tws, id)

## End(Not run)
</code></pre>

<hr>
<h2 id='.twsIncomingMSG'> Internal TWS-API MSG and ERR List </h2><span id='topic+.twsIncomingMSG'></span><span id='topic+.twsOutgoingMSG'></span><span id='topic+.twsERR'></span><span id='topic+.lastRequest'></span><span id='topic+reqExecutions'></span><span id='topic+twsExecutionFilter'></span><span id='topic+twsComboLeg'></span><span id='topic+twsBAG'></span><span id='topic+twsDEBUG'></span><span id='topic+requestFA'></span><span id='topic+replaceFA'></span><span id='topic+reqOpenOrders'></span><span id='topic+reqScannerParameters'></span><span id='topic+reqScannerSubscription'></span>

<h3>Description</h3>

<p>Internal List of MSG Codes and Undocumented (Experimental) Functions
</p>

<hr>
<h2 id='calculateImpliedVolatility'>
Calculate Option Values
</h2><span id='topic+calculateImpliedVolatility'></span><span id='topic+calculateOptionPrice'></span>

<h3>Description</h3>

<p>Using the IB API, calculates the implied volatility or option
price given parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateImpliedVolatility(twsconn, 
                           Contract, 
                           optionPrice, 
                           underPrice, 
                           reqId = 1)

calculateOptionPrice(twsconn, 
                     Contract, 
                     volatility, 
                     underPrice, 
                     reqId = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculateImpliedVolatility_+3A_twsconn">twsconn</code></td>
<td>

<p>A twsConnection object
</p>
</td></tr>
<tr><td><code id="calculateImpliedVolatility_+3A_contract">Contract</code></td>
<td>

<p>A twsContract object
</p>
</td></tr>
<tr><td><code id="calculateImpliedVolatility_+3A_optionprice">optionPrice</code></td>
<td>

<p>The option price from which to calculate implied
</p>
</td></tr>
<tr><td><code id="calculateImpliedVolatility_+3A_volatility">volatility</code></td>
<td>

<p>The volatility from which to calculate price
</p>
</td></tr>
<tr><td><code id="calculateImpliedVolatility_+3A_underprice">underPrice</code></td>
<td>

<p>The underlying price
</p>
</td></tr>
<tr><td><code id="calculateImpliedVolatility_+3A_reqid">reqId</code></td>
<td>

<p>The request id
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both calls will use the IB described method for calculation.
See the official API for documentation.
</p>


<h3>Value</h3>

<p>A numeric value corresponding to the request
</p>


<h3>Author(s)</h3>

<p>Jeffrey A. Ryan
</p>


<h3>References</h3>

<p><a href="https://interactivebrokers.github.io/tws-api/classIBApi_1_1EClient.html#a04c5d248c1036dd72435cc1edc7c58e2">https://interactivebrokers.github.io/tws-api/classIBApi_1_1EClient.html#a04c5d248c1036dd72435cc1edc7c58e2</a>
<a href="https://interactivebrokers.github.io/tws-api/classIBApi_1_1EClient.html#a7afa53b655542e74ede683e1de2b2fc4">https://interactivebrokers.github.io/tws-api/classIBApi_1_1EClient.html#a7afa53b655542e74ede683e1de2b2fc4</a>
</p>

<hr>
<h2 id='eWrapper'> eWrapper Closure For Message Processing </h2><span id='topic+eWrapper'></span><span id='topic+eWrapper.MktData.CSV'></span><span id='topic+eWrapper.RealTimeBars'></span><span id='topic+eWrapper.RealTimeBars.CSV'></span><span id='topic+eWrapper.data'></span><span id='topic+eWrapper.MktDepth.CSV'></span>

<h3>Description</h3>

<p>Create an eWrapper closure to allow for custom
incoming message management.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eWrapper(debug = FALSE, errfile=stderr())

eWrapper.data(n)

eWrapper.MktData.CSV(n=1)
eWrapper.RealTimeBars.CSV(n=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eWrapper_+3A_debug">debug</code></td>
<td>
<p> should debugging be enabled </p>
</td></tr>
<tr><td><code id="eWrapper_+3A_errfile">errfile</code></td>
<td>
<p> where error messages are directed (stderr) </p>
</td></tr>
<tr><td><code id="eWrapper_+3A_n">n</code></td>
<td>
<p> number of contracts being watched </p>
</td></tr>
</table>


<h3>Details</h3>

<p><span class="pkg">IBrokers</span> implements an eWrapper scheme similar
to that provided by the official Java API.
</p>
<p>The general idea is that each real-time data
capture function must manage all incoming signals
correctly, while allowing for the end user to
create custom handlers for each specific event.
</p>
<p>Internal to the <code>reqRealTimeBars</code>, 
<code>reqMktData</code>, and <code>reqMktDepth</code>
functions is a single call to the CALLBACK routine
passed to it.  By default this is <code>twsCALLBACK</code> (see also).
A standard argument to this callback is an
eventWrapper &mdash; which is an instance of eWrapper.
</p>
<p>eWrapper is an <span class="rlang"><b>R</b></span> closure that contains a list
of functions to manage all incoming message type, as
found in <code>.twsIncomingMSG</code>.  Each message has a corresponding
function in the eWrapper designed
to handle the particular details of each incoming message type.
</p>
<p>There is also an embedded environment in which data
can be saved and retrieved via a handful of accessor functions mimicking
the standard <span class="rlang"><b>R</b></span> tools.
</p>
<p>The data environment is <code>.Data</code>, with accessor
methods <code>get.Data</code>, <code>assign.Data</code>, and <code>remove.Data</code>.
</p>
<p>These methods can be called from the closure object <code>eWrapper$get.Data</code>,
<code>eWrapper$assign.Data</code>, etc.
</p>
<p>The basic eWrapper call simply produces a visually informative
display of the incoming stream.  E.g. bidSize data would be represented
with a <em>bidSize</em> label, instead of the internal TWS code(s) returned
by the TWS.
</p>
<p>By creating an instance of an eWrapper, accomplished by calling
it as a function call, one can then modify any or all the particular
methods embedded in the object.
</p>
<p>This allows for rapid customization, as well as a built in assurance
that all incoming messages will be handled appropriately without
additional programmer time and resources.
</p>
<p>An example of this ability to modify the object is given in
the <code>eWrapper.MktData.CSV</code> code. This object produces
output deisgned to be space efficient, as well as easily read back into
any R session as a standard CSV file.
</p>
<p>Setting <code>debug=NULL</code> will cause empty function objects
to be created within the eWrapper object returned.  This object
can be treated as a template to implement only the methods
that are needed.  By default, all functions silently return
the entire message they would normally parse.  This includes
<em>empty</em> functions created by setting debug to NULL.
</p>
<p><code>eWrapper.data()</code> allows for data states to be maintained
from call to call, as an xts history of updates/messages is stored
within the object.  This is designed to minimize calling overhead by
removing unneeded function calls from each message parsed.
</p>
<p>Additional, but creating methods that update the internal environment
of the eWrapper object, it is possible to maintain a snapshot of
last k values for any field of interest.  This is directly applicable to
implementing an automated strategy from within a custom <code>twsCALLBACK</code>
method.
</p>


<h3>Value</h3>

<p>A list of functions [and optionally data] to be used for the <code>eventWrapper</code> argument
to <code>reqMktData</code> and <code>reqMktDepth</code>
</p>


<h3>Note</h3>

 
<p>It is possible to also attach data to the closure object, allowing for
a single in-memory object to contain current top of book data. This is
exemplified in the <code>eWrapper.MktData.CSV</code> code, and can be extended
in the user's own direction.
</p>


<h3>Author(s)</h3>

<p> Jeffrey A. Ryan </p>


<h3>See Also</h3>

 <p><code><a href="#topic+twsCALLBACK">twsCALLBACK</a></code>, <code><a href="#topic+processMsg">processMsg</a></code>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>myWrapper &lt;- eWrapper()

str(myWrapper)

# remove tickPrice action
myWrapper$tickPrice &lt;- function(msg, timestamp, file, ...) {}

# add new tickPrice action
myWrapper$tickPrice &lt;- function(msg, timestamp, file, ...) { cat("tickPrice",msg) }

# add new data into the object, and retrieve
myWrapper$assign.Data("myData", 1010)
myWrapper$get.Data("myData")

## Not run: 
tws &lt;- twsConnect()
reqMktData(tws, twsSTK("SBUX"))
reqMktData(tws, twsSTK("SBUX"), eventWrapper=myWrapper)
twsDisconnect(tws)

## End(Not run)
</code></pre>

<hr>
<h2 id='exerciseOptions'>
Exercise Options Contracts
</h2><span id='topic+exerciseOptions'></span>

<h3>Description</h3>

<p>Send message to exercise option contracts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exerciseOptions(twsconn, 
                contract, 
                exerciseAction = 1, 
                exerciseQuantity = 1, 
                account = "", 
                override = 0, 
                tickerId = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exerciseOptions_+3A_twsconn">twsconn</code></td>
<td>

<p>A twsConnection object
</p>
</td></tr>
<tr><td><code id="exerciseOptions_+3A_contract">contract</code></td>
<td>

<p>A twsContract object
</p>
</td></tr>
<tr><td><code id="exerciseOptions_+3A_exerciseaction">exerciseAction</code></td>
<td>

<p>exercise=1 or lapse=2
</p>
</td></tr>
<tr><td><code id="exerciseOptions_+3A_exercisequantity">exerciseQuantity</code></td>
<td>

<p>number of contracts to exercise
</p>
</td></tr>
<tr><td><code id="exerciseOptions_+3A_account">account</code></td>
<td>

<p>IB account [institutional orders]
</p>
</td></tr>
<tr><td><code id="exerciseOptions_+3A_override">override</code></td>
<td>

<p>override system's natural action. 0 for do not override, 1 for override
</p>
</td></tr>
<tr><td><code id="exerciseOptions_+3A_tickerid">tickerId</code></td>
<td>

<p>id for request
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Exercise option contract.
</p>


<h3>Value</h3>

<p>Called for its side-effect.
</p>


<h3>Note</h3>

<p>exch=&lsquo;SMART&rsquo; is not valid in <code>exerciseOptions</code> calls. See
the official API for further details.
</p>


<h3>Author(s)</h3>

<p>Jeffrey A. Ryan
</p>


<h3>References</h3>

<p><a href="https://interactivebrokers.github.io/tws-api/classIBApi_1_1EClient.html#aad70a7b82ad3b5e7ae3e9f0b98dc2a5b">https://interactivebrokers.github.io/tws-api/classIBApi_1_1EClient.html#aad70a7b82ad3b5e7ae3e9f0b98dc2a5b</a>
</p>

<hr>
<h2 id='IBrokers-package'>
R API to the Interactive Brokers Trader Workstation (TWS).
</h2><span id='topic+IBrokers-package'></span><span id='topic+IBrokers'></span><span id='topic+IBrokersRef'></span>

<h3>Description</h3>

<p><em>This software is in no way affiliated, endorsed, or
approved by Interactive Brokers or any of its affiliates.
It comes with absolutely no warranty and should
not be used in actual trading unless the user can
read and understand the source.</em>
</p>
<p><span class="pkg">IBrokers</span> is a pure R implementation of the TWS API.  At present
it is only able pull data from the Interactive
Brokers servers via the TWS.  Future additions will include more API
access, including live
order handling, and better management across R sessions.
</p>
<p>Possible real-time charting via the <span class="pkg">quantmod</span>
package may be incorporated into future
releases.
</p>
<p>Changes to move to version 0.1-0
have made this API implementation much more
robust on all platforms.
Many new error-checking calls have been
incorporated, as well as a more reliable event-loop
to capture the data from the TWS.
</p>
<p>The underlying socket connections are pure <span class="rlang"><b>R</b></span>. This was
a design decision to maximize cross-platform availability,
as well as a recognition that historical data
requests, or any requests while in a single threaded <span class="rlang"><b>R</b></span>
session, must be non-threaded.
</p>
<p>Recent additions include <code>reqMktData</code> to
handle live market data from one or more
symbols, <code>reqMktDepth</code> to
capture market depth for one or more
symbols, and
<code>reqRealTimeBars</code> to recieve 5 second
real time bars. Each of these functions
have been implemented with optional user
defined callback handlers
to allow for R code to interact with the API
while receiving data from the TWS.
</p>
<p>Please report any
and all bugs/experiences to the maintainer so they can be
corrected or incorporated into future versions.
</p>
<p>Additionally, beta testers are needed to make this
a viable alternative for IB-API interaction.  Don't be shy.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> IBrokers</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.9-7</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2012-04-27</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The current API methods supported are:
</p>
<p><code>twsConnect</code>: Establish TWS connection<br />
<code>twsDisconnect</code>: Close TWS connection<br />
<code>isConnected</code>: Check connection<br />
<code>setServerLogLevel</code>: Set logging level<br />
</p>
<p><code>twsAccountUpdates</code>: Get Account Details<br />
<code>reqIds</code>: Request next available ID<br />
<code>reqCurrentTime</code>: The TWS server time in seconds since the epoch<br />
<code>reqHistoricalData</code>: Fetch historical data<br />
<code>reqMktData</code>: Receive real-time market data<br />
<code>reqMktDepth</code>: Receive real-time order book depth<br />
<code>reqRealTimeBars</code>: Receive 5 second OHLCVWC bar data<br />
</p>
<p><em>Experimental support:</em><br />
<code>placeOrder</code>: Place a live order to the TWS<br />
<code>cancelOrder</code>: Cancel a pending order on the TWS<br />
</p>


<h3>Author(s)</h3>

<p>Jeffrey A. Ryan
</p>
<p>Maintainer: Joshua M. Ulrich &lt;josh.m.ulrich@gmail.com&gt;
</p>


<h3>References</h3>

<p>Interactive Brokers: <a href="https://www.interactivebrokers.com">https://www.interactivebrokers.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
IBrokersRef()       # IBrokers Reference Card in PDF viewer

tws &lt;- twsConnect() # make a new connection to the TWS
reqCurrentTime(tws) # check the server's timestamp

contract &lt;- twsEquity('IBKR','SMART','ISLAND') # equity specification

reqHistoricalData(tws,contract) # request historical data
twsDisconnect(tws)  # disconnect from the TWS

## End(Not run)
</code></pre>

<hr>
<h2 id='processMsg'> Main TWS-API Event Manager </h2><span id='topic+processMsg'></span>

<h3>Description</h3>

<p>Function to manage all incoming messages
from the TWS in a consistent manner.
</p>
<p>This is used within the context of an
event loop (often twsCALLBACK) and allows
for custom processing by message type
via the eWrapper argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>processMsg(curMsg, con, eWrapper, timestamp, file, twsconn, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="processMsg_+3A_curmsg">curMsg</code></td>
<td>
<p> The current incoming message </p>
</td></tr>
<tr><td><code id="processMsg_+3A_con">con</code></td>
<td>
<p> a socket connection from a <code>twsConnection</code> </p>
</td></tr>
<tr><td><code id="processMsg_+3A_ewrapper">eWrapper</code></td>
<td>
<p> a functional closure with methods for each message </p>
</td></tr>
<tr><td><code id="processMsg_+3A_timestamp">timestamp</code></td>
<td>
<p> the timestamp format needed </p>
</td></tr>
<tr><td><code id="processMsg_+3A_file">file</code></td>
<td>
<p> the file or connection to write to </p>
</td></tr>
<tr><td><code id="processMsg_+3A_twsconn">twsconn</code></td>
<td>
<p> the twsConnection object </p>
</td></tr>
<tr><td><code id="processMsg_+3A_...">...</code></td>
<td>
<p> additional arguments to internal calls </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is used internally within the context
of a larger infinite listener/loop.
</p>
<p>The basic process involves one or more requests
to the TWS for data/action, followed by a call
to <code>twsCALLBACK</code>.  Inside of the CALLBACK
is a loop that fetches the incoming message type,
and calls <code>processMsg</code> at each new message.
</p>
<p><code>processMsg</code> internally is a series of
if-else statements that branch according to a known
incoming message type.  The <code>eWrapper</code> object
is a closure containing a data environment that
is static and a collection of callback
functions for each type of incoming data.
</p>
<p>This eWrapper function can be defined at
multiple points prior to the use within processMsg,
to allow for access to data outside of the processMsg
call, as well as facilitate custom handling in
an efficient manner.
</p>


<h3>Value</h3>

<p>Called for its side-effects.
</p>


<h3>Note</h3>

 
<p>The entire mechanism (twsCALLBACK -&gt; processMsg -&gt; eWrapper)
is modeled after the official API.
</p>


<h3>Author(s)</h3>

<p> Jeffrey A. Ryan </p>


<h3>References</h3>

<p> Interactive Brokers: <a href="https://www.interactivebrokers.com/">https://www.interactivebrokers.com/</a> </p>


<h3>See Also</h3>

 <p><code><a href="#topic+twsCALLBACK">twsCALLBACK</a></code>, <code><a href="#topic+eWrapper">eWrapper</a></code> </p>

<hr>
<h2 id='reqAccountUpdates'> Request Account Updates </h2><span id='topic+reqAccountUpdates'></span><span id='topic+cancelAccountUpdates'></span><span id='topic+twsPortfolioValue'></span><span id='topic+.reqAccountUpdates'></span>

<h3>Description</h3>

<p>Request and view account details from Interactive Brokers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reqAccountUpdates(conn, 
                  subscribe = TRUE,
                  acctCode = "1",
                  eventWrapper = eWrapper(), 
                  CALLBACK=twsCALLBACK, 
                  ...)

.reqAccountUpdates(conn, subscribe = TRUE, acctCode = "1")

twsPortfolioValue(x, zero.pos=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reqAccountUpdates_+3A_conn">conn</code></td>
<td>
<p> A twsConnection object </p>
</td></tr>
<tr><td><code id="reqAccountUpdates_+3A_subscribe">subscribe</code></td>
<td>
<p> subscribe (TRUE) or unsubscribe (FALSE) </p>
</td></tr>
<tr><td><code id="reqAccountUpdates_+3A_acctcode">acctCode</code></td>
<td>
<p> an account description - not used for most accounts </p>
</td></tr>
<tr><td><code id="reqAccountUpdates_+3A_eventwrapper">eventWrapper</code></td>
<td>
<p> message-level callback closure </p>
</td></tr>
<tr><td><code id="reqAccountUpdates_+3A_callback">CALLBACK</code></td>
<td>
<p> main receiver loop, if any </p>
</td></tr>
<tr><td><code id="reqAccountUpdates_+3A_x">x</code></td>
<td>
<p> object to extract PortfolioValue from. See details. </p>
</td></tr>
<tr><td><code id="reqAccountUpdates_+3A_zero.pos">zero.pos</code></td>
<td>
<p> should PortfolioValue include zero positions? </p>
</td></tr>
<tr><td><code id="reqAccountUpdates_+3A_...">...</code></td>
<td>
<p> additional args </p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, for non-FA accounts, this returns the current login's
account information.
</p>
<p>This main version returns a list of objects as
returned by the TWS.  <code>.reqAccountUpdates</code> sends
the request to subscribe or cancel, but returns immediately.
This is designed to be used within a larger
custom callback routine, where the <code>eventWrapper</code> object
passed to processMsg (see also) keeps trace of the portfolio
updates in a consistent manner.
</p>
<p><code>twsPortfolioValue</code> extracts into a data.frame commonly
used fields from all positions held. There are currently methods
for the the default returned object of <code>reqAccountUpdates</code>.
</p>


<h3>Author(s)</h3>

<p> Jeffrey A. Ryan </p>


<h3>References</h3>

<p> Interactive Brokers API: <a href="https://www.interactivebrokers.com">https://www.interactivebrokers.com</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  tws &lt;- twsConnect()

  reqAccountUpdates(tws)        # this will return a AccountUpdate object
  .reqAccountUpdates(tws)       # this will return immediately

  .reqAccountUpdates(tws, FALSE)  # cancel the request
  cancelAccountUpdates(tws)     # the same

  twsDisconnect(tes)

## End(Not run)
</code></pre>

<hr>
<h2 id='reqContractDetails'> Request Contract Details From TWS </h2><span id='topic+reqContractDetails'></span>

<h3>Description</h3>

<p>Returns an object (a list of class <code>twsContractDetails</code> objects)
of IB contract details relating
to a particular IB tradeable product.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reqContractDetails(conn,
                   Contract,
                   reqId = "1",
                   verbose = FALSE,
                   eventWrapper = eWrapper(),
                   CALLBACK = twsCALLBACK, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reqContractDetails_+3A_conn">conn</code></td>
<td>
<p> a valid <code>twsConnection</code> </p>
</td></tr>
<tr><td><code id="reqContractDetails_+3A_contract">Contract</code></td>
<td>
<p> a valid <code>twsContract</code> </p>
</td></tr>
<tr><td><code id="reqContractDetails_+3A_reqid">reqId</code></td>
<td>
<p> a unique ID </p>
</td></tr>
<tr><td><code id="reqContractDetails_+3A_verbose">verbose</code></td>
<td>
<p> be verbose? </p>
</td></tr>
<tr><td><code id="reqContractDetails_+3A_eventwrapper">eventWrapper</code></td>
<td>
<p> event callback closure </p>
</td></tr>
<tr><td><code id="reqContractDetails_+3A_callback">CALLBACK</code></td>
<td>
<p> main callback loop </p>
</td></tr>
<tr><td><code id="reqContractDetails_+3A_...">...</code></td>
<td>
<p> be verbose? </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns a list of details for the product specified.  See the TWS
API for specifics at this point.
</p>


<h3>Value</h3>

<p>A <code>twsContractDetails</code> object, or list of the same.
</p>


<h3>Author(s)</h3>

<p> Jeffrey A. Ryan </p>


<h3>References</h3>

<p> Interactive Brokers <a href="https://www.interactivebrokers.com/">https://www.interactivebrokers.com/</a> </p>


<h3>See Also</h3>

 <p><code><a href="#topic+twsContract">twsContract</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
tws &lt;- twsConnect()
reqContractDetails(tws, twsEquity("QQQQ"))

# retrieve all QQQQ contracts as a list
reqContractDetails(tws, twsOption(local="", right="", symbol="QQQQ"))
# retrieve only calls
reqContractDetails(tws, twsOption(local="", right="C", symbol="QQQQ"))
# retrieve only puts
reqContractDetails(tws, twsOption(local="", right="P", symbol="QQQQ"))

opt.details &lt;- lapply(c("MSFT","AAPL"),
                      function(x) {
                                    reqContractDetails(tws,
                                      twsOption(local="", right="",
                                                symbol=x))
                                  } )

length(opt.details) #number of symbols passed e.g. 2
sapply(opt.details, length) # contracts per symbol

## End(Not run)
</code></pre>

<hr>
<h2 id='reqCurrentTime'> Request The Current TWS Time </h2><span id='topic+reqCurrentTime'></span>

<h3>Description</h3>

<p>Returns the current time from the TWS
server, expressed as seconds since
1970-01-01 GMT.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reqCurrentTime(twsconn)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reqCurrentTime_+3A_twsconn">twsconn</code></td>
<td>
<p> a valid tws connection object </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Seconds since 1970-01-01 GMT
</p>


<h3>Author(s)</h3>

<p> Jeffrey A. Ryan </p>


<h3>References</h3>

<p> Interactive Brokers <a href="https://www.interactivebrokers.com">https://www.interactivebrokers.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
tws &lt;- twsConnect()
reqCurrentTime(tws)

## End(Not run)
</code></pre>

<hr>
<h2 id='reqHistoricalData'> Request Historical Data From TWS </h2><span id='topic+reqHistoricalData'></span><span id='topic+reqHistory'></span><span id='topic+cancelHistoricalData'></span>

<h3>Description</h3>

<p>Makes a request to the Interactive Brokers Trader Workstation (TWS),
and returns an xts object containing the results of the request
if successful.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reqHistoricalData(conn,
                  Contract,
                  endDateTime,
                  barSize = "1 day",
                  duration = "1 M",
                  useRTH = "1",
                  whatToShow = "TRADES", 
                  timeFormat = "1",
                  tzone = "",
                  verbose = TRUE,
                  tickerId = "1",
                  eventHistoricalData,
                  file)

reqHistory(conn, Contract, barSize, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reqHistoricalData_+3A_conn">conn</code></td>
<td>
<p> a <code>twsConnection</code> object </p>
</td></tr>
<tr><td><code id="reqHistoricalData_+3A_contract">Contract</code></td>
<td>
<p> a <code>twsContract</code> </p>
</td></tr>
<tr><td><code id="reqHistoricalData_+3A_enddatetime">endDateTime</code></td>
<td>
<p> end date/time for request. See details. </p>
</td></tr>
<tr><td><code id="reqHistoricalData_+3A_barsize">barSize</code></td>
<td>
<p> bar size to retrieve </p>
</td></tr>
<tr><td><code id="reqHistoricalData_+3A_duration">duration</code></td>
<td>
<p> time span the request will cover </p>
</td></tr>
<tr><td><code id="reqHistoricalData_+3A_userth">useRTH</code></td>
<td>
<p> limited to regular trading hours </p>
</td></tr>
<tr><td><code id="reqHistoricalData_+3A_whattoshow">whatToShow</code></td>
<td>
<p> type of data to be extracted </p>
</td></tr>
<tr><td><code id="reqHistoricalData_+3A_timeformat">timeFormat</code></td>
<td>
<p> POSIX style or seconds from 1970-01-01 </p>
</td></tr>
<tr><td><code id="reqHistoricalData_+3A_tzone">tzone</code></td>
<td>
<p> time zone of the resulting intraday series (if applicable) </p>
</td></tr>
<tr><td><code id="reqHistoricalData_+3A_verbose">verbose</code></td>
<td>
<p> should progress be documented </p>
</td></tr>
<tr><td><code id="reqHistoricalData_+3A_tickerid">tickerId</code></td>
<td>
<p> a unique id to associte with the request </p>
</td></tr>
<tr><td><code id="reqHistoricalData_+3A_eventhistoricaldata">eventHistoricalData</code></td>
<td>
<p> callback function to process data </p>
</td></tr>
<tr><td><code id="reqHistoricalData_+3A_file">file</code></td>
<td>
<p> file to write data to </p>
</td></tr>
<tr><td><code id="reqHistoricalData_+3A_...">...</code></td>
<td>
<p> args to pass to reqHistoricalData </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>reqHistory</code> function is a simple wrapper to
request maximal history from IB. It is meant to be
used directlty, or as a template for new wrappers.
</p>
<p>All arguments should be character strings.  Attempts will
be made to coerce, but should not be relied upon.
</p>
<p>The <code>endDateTime</code> argument must be of the form
'CCYYMMDD HH:MM:SS TZ'. If not specified the current
time as returned from the TWS server will be used. This
is the preferred method for backfilling data. The &lsquo;TZ&rsquo;
portion of the string is optional.
</p>
<p>Legal <code>barSize</code> values are
&lsquo;1 secs&rsquo;,&lsquo;5 secs&rsquo;,&lsquo;15 secs&rsquo;,
&lsquo;30 mins&rsquo;,&lsquo;1 min&rsquo;,&lsquo;2 mins&rsquo;,
&lsquo;3 mins&rsquo;,&lsquo;5 mins&rsquo;,&lsquo;15 mins&rsquo;,
&lsquo;30 mins&rsquo;,&lsquo;1 hour&rsquo;,&lsquo;1 day&rsquo;,
&lsquo;1 week&rsquo;,&lsquo;1 month&rsquo;,&lsquo;3 months&rsquo;,
and &lsquo;1 year&rsquo;.
</p>
<p>Partial matching is attempted, but it is best to specify the <code>barSize</code>
value exactly as they are given above. There is no guarantee from the API
that all will work for all securities or durations.
</p>
<p>The duration string must be of the form &lsquo;n u&rsquo;
where &lsquo;n&rsquo; is an integer and &lsquo;u&rsquo; is one of:
&lsquo;S&rsquo; (seconds),
&lsquo;D&rsquo; (days),
&lsquo;W&rsquo; (weeks),
&lsquo;M&rsquo; (months),
or &lsquo;Y&rsquo; (year).
For example, &lsquo;1 W&rsquo; would return one week of data.
At present the limit for years is 1.
</p>
<p><code>useRTH</code> takes either &lsquo;1&rsquo; or &lsquo;0&rsquo;,
indicating the request to return only regular trade
hour data, or all data, respectively.
</p>
<p><code>whatToShow</code> can be any one of the following,
though depending on the overall request it may not succeed.
&lsquo;TRADES&rsquo;, &lsquo;MIDPOINT&rsquo;, &lsquo;BID&rsquo;,
&lsquo;ASK&rsquo;, &lsquo;BID_ASK&rsquo;.
</p>
<p><code>time.format</code> should simply be left alone. :D
</p>
<p><code>eventHistoricalData</code> accepts a user function to process the raw
data returned by the TWS.  This consists of a character
vector that includes the first five elements of header
information, with the fifth element specifying the number
of rows in the results set.  Passing <code>NULL</code> to 
<code>eventHistoricalData</code> will return the raw character vector.
If nothing is specified, an xts object is returned.
</p>
<p>The <code>eventHistoricalData</code> function, if any, is called after all
data has been received by the client.
</p>
<p>The <code>file</code> argument calls <code>write.table</code> to produce
output suitable to reading in by <code>read.csv</code>. The <code>file</code>
argument is passed to the write.table call, and if an empty
string will return the output to the console.
</p>
<p>The <em>hasGaps</em> column is converted automatically from
(true,false) to 1 or 0, respectively. 
</p>


<h3>Value</h3>

<p>Returns an <code>xts</code> object containing the requested data, along
with additional information stored in the objects <code>xtsAttributes</code>,
unless <code>callback</code> or <code>file</code> is specified.
</p>


<h3>Note</h3>

<p>The rules for historical data requests are somewhat vague. Not all
symbols have data, and those that do may only be available with specific
combinations of barSize and duration arguments. At present the only
way to know is to try the combination in question.
</p>
<p>There is a strictly enforced 10 seconds between request pacing rule
implemented by the TWS. Keep this in mind.
IBrokers currently does <em>not</em> manage this for the user via
reqHistoricalData, though reqHistory does.
</p>


<h3>Author(s)</h3>

<p> Jeffrey A. Ryan </p>


<h3>References</h3>

<p> Interactive Brokers <a href="https://www.interactivebrokers.com">https://www.interactivebrokers.com</a> </p>


<h3>See Also</h3>

 <p><code><a href="#topic+twsContract">twsContract</a></code>, <code><a href="#topic+twsConnect">twsConnect</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
tws &lt;- twsConnect()
contract &lt;- twsEquity('QQQQ','SMART','ISLAND')

# by default retreives 30 days of daily data
reqHistoricalData(tws, Contract=contract)

# by default retreives a year of 1 minute bars
Sys.sleep(10) # mandatory 10s between request to avoid IB pacing violation
reqHistory(tws, Contract=contract)


## End(Not run)
</code></pre>

<hr>
<h2 id='reqIds'>
Request Next Valid Id
</h2><span id='topic+reqIds'></span><span id='topic+.reqIds'></span>

<h3>Description</h3>

<p>Get the next valid order ID for use with the TWS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reqIds(conn, numIds = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reqIds_+3A_conn">conn</code></td>
<td>

<p>a valid twsConnection object of class <code>twsconn</code>.
</p>
</td></tr>
<tr><td><code id="reqIds_+3A_numids">numIds</code></td>
<td>

<p>currently ignored by the TWS.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>twsconn</code> objects maintain the next valid id inside of the object,
returning the current id, and incrementing by 1 with each call
to reqIds.
</p>
<p>For <code>twsconn</code> objects, <code>reqIds</code> and <code>.reqIds</code> results
are identical.
</p>


<h3>Value</h3>

<p>A character representation of the next numeric ID.
</p>


<h3>Note</h3>

<p>The TWS will keep track of order ids across connection ids
and sessions. The values may be reset only as outlined by the
official TWS documentation.  IBrokers simply records and
manages the data as recieved from the TWS upon initial connection.
Each connection id will have a different order id associated with it.
</p>


<h3>Author(s)</h3>

<p>Jeffrey A. Ryan
</p>

<hr>
<h2 id='reqManagedAccts'> Managed Accounts </h2><span id='topic+reqManagedAccts'></span>

<h3>Description</h3>

<p>A single username can handle more than one account. As mentioned in the Connectivity section, the TWS will automatically send a list of managed accounts once the connection is established. The list can also be fetched via the IBApi.EClient.reqManagedAccts method. For an individual account, this call works as well and returns a single account.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reqManagedAccts(twsconn)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reqManagedAccts_+3A_twsconn">twsconn</code></td>
<td>
<p> a valid tws connection object </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Individual account: a string containing a single account number. For a FamilyAccount  it returns a string with a ',' separated list of available accounts.
</p>


<h3>Author(s)</h3>

<p> J.W. de Roode </p>


<h3>References</h3>

<p> Interactive Brokers <a href="https://www.interactivebrokers.com">https://www.interactivebrokers.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
tws &lt;- twsConnect()
reqManagedAccts(tws)

## End(Not run)
</code></pre>

<hr>
<h2 id='reqMatchingSymbols'> Stock Contract Search </h2><span id='topic+reqMatchingSymbols'></span>

<h3>Description</h3>

<p>Starting in API v973.02 and TWS v964, a function reqMatchingSymbols is available to search for stock contracts. The input can be either the first few letters of the ticker symbol, or for longer strings, a character sequence matching a word in the security name. For instance to search for the stock symbol 'IBKR', the input 'I' or 'IB' can be used, as well as the word 'Interactive'. Up to 16 matching results are returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reqMatchingSymbols(twsconn, pattern)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reqMatchingSymbols_+3A_twsconn">twsconn</code></td>
<td>
<p> a valid tws connection object </p>
</td></tr>
<tr><td><code id="reqMatchingSymbols_+3A_pattern">pattern</code></td>
<td>
<p> either start of ticker symbol or (for larger strings) company name </p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe: conId, symbol, secType, primaryExchange, currency, derivateSecTypes
</p>


<h3>Author(s)</h3>

<p> J.W. de Roode </p>


<h3>References</h3>

<p> Interactive Brokers <a href="https://www.interactivebrokers.com">https://www.interactivebrokers.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
tws &lt;- twsConnect()
reqMatchingSymbols(tws, pattern="IB")

## End(Not run)
</code></pre>

<hr>
<h2 id='reqMktData'> Request Market Data Feed from TWS </h2><span id='topic+reqMktData'></span><span id='topic+cancelMktData'></span>

<h3>Description</h3>

<p>Allows for streaming market data 
to be handled in <span class="rlang"><b>R</b></span>.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reqMktData(conn, 
           Contract,
           tickGenerics = "100,101,104,106,165,221,225,236",
           snapshot = FALSE,
           tickerId = "1",
           timeStamp = "%Y%m%d %H:%M:%OS",
           playback = 1,
           file = "",
           verbose = TRUE,
           eventWrapper = eWrapper(),
           CALLBACK = twsCALLBACK, ...)

cancelMktData(conn,tickerId)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reqMktData_+3A_conn">conn</code></td>
<td>
<p> a valid <code>twsConnection</code> or <code>twsPlayback</code> connection </p>
</td></tr>
<tr><td><code id="reqMktData_+3A_contract">Contract</code></td>
<td>
 <p><code>twsContract</code> object(s) requested data for </p>
</td></tr>
<tr><td><code id="reqMktData_+3A_tickgenerics">tickGenerics</code></td>
<td>
<p> a comman delimited string of generic tick types </p>
</td></tr>
<tr><td><code id="reqMktData_+3A_snapshot">snapshot</code></td>
<td>
<p> should snapshot data be returned </p>
</td></tr>
<tr><td><code id="reqMktData_+3A_tickerid">tickerId</code></td>
<td>
<p> the ticker id to associate with the returned data </p>
</td></tr>
<tr><td><code id="reqMktData_+3A_timestamp">timeStamp</code></td>
<td>
<p> include R time stamps </p>
</td></tr>
<tr><td><code id="reqMktData_+3A_playback">playback</code></td>
<td>
<p> playback speed adjustment </p>
</td></tr>
<tr><td><code id="reqMktData_+3A_file">file</code></td>
<td>
<p> passed to internal <code>cat</code> calls. See associated help </p>
</td></tr>
<tr><td><code id="reqMktData_+3A_verbose">verbose</code></td>
<td>
<p> print diagnostics? </p>
</td></tr>
<tr><td><code id="reqMktData_+3A_eventwrapper">eventWrapper</code></td>
<td>
<p> eWrapper object </p>
</td></tr>
<tr><td><code id="reqMktData_+3A_callback">CALLBACK</code></td>
<td>
<p> main reciever callback</p>
</td></tr>
<tr><td><code id="reqMktData_+3A_...">...</code></td>
<td>
<p> additional args </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provides <span class="rlang"><b>R</b></span> level access to market data streams
as returned by the TWS API.  The Interactive Brokers documentation
should be reference for the exact meaning of the returned data.
</p>
<p><code>timeStamps</code> is unique to the R API in that each
incoming signal will be marked with a (potentially) unique
timestamp.  Alternatively it is possible to
pass a formatting string for use in
<code>format(Sys.time())</code>. To suppress the time stamp
set the argument to NULL.  This is <em>not</em> sent by
the TWS - merely prepended to the output by <span class="rlang"><b>R</b></span>.
</p>
<p>Callbacks, via CALLBACK and eventWrapper
are designed to allow for <span class="rlang"><b>R</b></span> level processing
of the real-time data stream.
</p>
<p>Each message recieved (each
update to the market data) will invoke one
the appropriately names eWrapper callback,
depending on the message type.  By default when nothing is
specified, the code will call the default method for
printing the results to the screen via <code>cat</code>.
</p>
<p>Note that the use of the argument <code>file</code> will
be passed to these <code>cat</code> calls, and therefore
it will be possible to use the functionality of <code>cat</code>
directly - e.g. piping output or writing to a connection.  The
simplest use of file would be to specify the name of a file
to append the output of the stream to.
</p>
<p>The <code>CALLBACK</code> argument is used for more control of the
incoming results.  This requires user-level error checking
as well as TWS API interaction.  It is here for advanced use
and until documented should be left alone.
</p>


<h3>Value</h3>

<p>The real-time market data from the TWS.
</p>


<h3>Note</h3>

 
<p>As <span class="rlang"><b>R</b></span> is single threaded - this request will run until
interupted by an error or by user action. Both will
clean up after themselves when appropriate.
</p>


<h3>Author(s)</h3>

<p> Jeffrey A. Ryan </p>


<h3>References</h3>

<p> Interactive Brokers API:
<a href="https://interactivebrokers.github.io/tws-api/index.html">https://interactivebrokers.github.io/tws-api/index.html</a> </p>


<h3>See Also</h3>

 <p><code><a href="#topic+twsCALLBACK">twsCALLBACK</a></code>,
<code><a href="#topic+eWrapper">eWrapper</a></code>,
<code><a href="#topic+twsConnect">twsConnect</a></code>,
<code><a href="#topic+twsContract">twsContract</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
tws &lt;- twsConnect()
contract &lt;- twsEquity("QQQQ","SMART","ISLAND")
reqMktData(tws, contract)

# write to an open file connection
fh &lt;- file('out.dat',open='a')
reqMktData(tws, contract, file=fh)
close(fh)

## End(Not run)
</code></pre>

<hr>
<h2 id='reqMktDataType'> Request Market Data Type from TWS </h2><span id='topic+reqMktDataType'></span>

<h3>Description</h3>

<p>Set the market data type with TWS
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reqMktDataType(conn, mktDataType = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reqMktDataType_+3A_conn">conn</code></td>
<td>
<p> a valid <code>twsConnection</code> or <code>twsPlayback</code> connection </p>
</td></tr>
<tr><td><code id="reqMktDataType_+3A_mktdatatype">mktDataType</code></td>
<td>
<p> market data type code </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function sets the market data type that will be returned by
TWS when <code>reqMktData</code> is called.
</p>

<dl>
<dt>1</dt><dd><p>Real-time: Live data is streamed back in real time. Market data
subscriptions are required to receive live market data.</p>
</dd>
<dt>2</dt><dd><p>Frozen: Market data is the last data recorded at market close.
Frozen data requires TWS/IBG v.962 or higher and the same market
data subscriptions necessary for real time streaming data.</p>
</dd>
<dt>3</dt><dd><p>Delayed: Market data 15-20 minutes behind real-time (depending on
the exchange). Automatically use delayed data if user does not
have a real-time subscription. Ignored if real-time data is
available.</p>
</dd>
<dt>4</dt><dd><p>Delayed-frozen: Requests delayed &quot;frozen&quot; data for users without
market data subscriptions.</p>
</dd>
</dl>



<h3>Value</h3>

<p><code>NULL</code> (invisibly)
</p>


<h3>Author(s)</h3>

<p> Joshua M. Ulrich </p>


<h3>References</h3>

<p> Interactive Brokers API:
<a href="https://interactivebrokers.github.io/tws-api/index.html">https://interactivebrokers.github.io/tws-api/index.html</a> </p>


<h3>See Also</h3>

 <p><code><a href="#topic+twsConnect">twsConnect</a></code>,
<code><a href="#topic+reqMktData">reqMktData</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
tws &lt;- twsConnect()
contract &lt;- twsEquity("QQQQ","SMART","ISLAND")
# set market data type to 'delayed'
reqMktDataType(tws, 3)
reqMktData(tws, contract)

## End(Not run)
</code></pre>

<hr>
<h2 id='reqMktDepth'> Request Market Depth Feed from TWS </h2><span id='topic+reqMktDepth'></span><span id='topic+cancelMktDepth'></span>

<h3>Description</h3>

<p>Allows for streaming market depth (order book) data
to be handled in <span class="rlang"><b>R</b></span>.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reqMktDepth(conn, 
            Contract,
            tickerId = "1",
            numRows = "20",
            timeStamp = TRUE,
            playback = 1,
            file = "",
            verbose = TRUE,
            eventWrapper = eWrapper(),
            CALLBACK = twsCALLBACK, ...)

cancelMktDepth(conn,tickerId)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reqMktDepth_+3A_conn">conn</code></td>
<td>
<p> a valid <code>twsConnection</code> connection </p>
</td></tr>
<tr><td><code id="reqMktDepth_+3A_contract">Contract</code></td>
<td>
 <p><code>twsContract</code> object(s) requested data for </p>
</td></tr>
<tr><td><code id="reqMktDepth_+3A_tickerid">tickerId</code></td>
<td>
<p> the ticker id to associate with the returned data </p>
</td></tr>
<tr><td><code id="reqMktDepth_+3A_numrows">numRows</code></td>
<td>
<p> depth of book </p>
</td></tr>
<tr><td><code id="reqMktDepth_+3A_timestamp">timeStamp</code></td>
<td>
<p> include <span class="rlang"><b>R</b></span> time stamps </p>
</td></tr>
<tr><td><code id="reqMktDepth_+3A_playback">playback</code></td>
<td>
<p> playback speed adjustment </p>
</td></tr>
<tr><td><code id="reqMktDepth_+3A_file">file</code></td>
<td>
<p> passed to internal <code>cat</code> calls. See associated help. </p>
</td></tr>
<tr><td><code id="reqMktDepth_+3A_verbose">verbose</code></td>
<td>
<p> print diagnostics? </p>
</td></tr>
<tr><td><code id="reqMktDepth_+3A_eventwrapper">eventWrapper</code></td>
<td>
<p> callback closure </p>
</td></tr>
<tr><td><code id="reqMktDepth_+3A_callback">CALLBACK</code></td>
<td>
<p> main reciever loop </p>
</td></tr>
<tr><td><code id="reqMktDepth_+3A_...">...</code></td>
<td>
<p> additional args </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provides <span class="rlang"><b>R</b></span> level access to book data
as returned by the TWS API.  The Interactive Brokers documentation
should be reference for the exact meaning of the returned data.
</p>
<p><code>timeStamps</code> is unique to the R API in that each incoming signal
will be marked with a (potentially) unique timestamp. 
Alternatively it is possible to pass a formatting string for use
in <code>format(Sys.time())</code>. To suppress the time stamp set the
argument to NULL.
</p>
<p>Callbacks, via eventUpdateMktDepth, eventUpdateMktDepthL2, or
CALLBACK are designed to allow for <span class="rlang"><b>R</b></span> level processing
of the real-time data stream.
</p>
<p>The first two correspond to actions based upon the actual signal
recieved.  These may be user-defined functions taking
the appropriate arguments.  Each message recieved (each
update to the market depth) will invoke one
of these callbacks.  By default when nothing is
specified, the code will call the default method for
printing the results to the screen via <code>cat</code>.
</p>
<p>Note that the use of the argument <code>file</code> will
be passed to these <code>cat</code> calls, and therefore
it will be possible to use the functionality of <code>cat</code>
directly - e.g. piping output or writing to a connection.  The
simplest use of file would be to specify the name of a file
to append the output of the stream to.
</p>
<p>The <code>CALLBACK</code> argument is used for more control of the
incoming results.  This requires user-level error checking
as well as TWS API interaction.  It is here for advanced use
and until documented should be left alone. 
</p>


<h3>Value</h3>

<p>The book depth.
</p>


<h3>Note</h3>

 
<p>As <span class="rlang"><b>R</b></span> is single threaded - this request will run until
interupted by an error or by user action. Both will
clean up after themselves when appropriate.
</p>


<h3>Author(s)</h3>

<p> Jeffrey A. Ryan </p>


<h3>References</h3>

<p> Interactive Brokers API:
<a href="https://interactivebrokers.github.io/tws-api/index.html">https://interactivebrokers.github.io/tws-api/index.html</a> </p>


<h3>See Also</h3>

 <p><code><a href="#topic+twsConnect">twsConnect</a></code>,<code><a href="#topic+twsContract">twsContract</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
tws &lt;- twsConnect()
contract &lt;- twsEquity("QQQQ","SMART","ISLAND")
reqMktDepth(tws, contract)

# write to a file
reqMktDepth(tws, contract, file='out.dat')

## End(Not run)
</code></pre>

<hr>
<h2 id='reqNewsBulletins'>
Subscribe or Unsubscribe To News Bulletins
</h2><span id='topic+reqNewsBulletins'></span><span id='topic+cancelNewsBulletins'></span>

<h3>Description</h3>

<p>Subscription start and end methods for the API.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reqNewsBulletins(twsconn, allMsgs=TRUE)

cancelNewsBulletins(twsconn)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reqNewsBulletins_+3A_twsconn">twsconn</code></td>
<td>

<p>A twsConnection object
</p>
</td></tr>
<tr><td><code id="reqNewsBulletins_+3A_allmsgs">allMsgs</code></td>
<td>

<p>Should all existing bulletins be returned (TRUE), or just new ones?
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calling reqNewsBulletins will start a subscription via the API. This will
continue and incoming messages will be handled by eWrapper &lsquo;updateNewBulletin&rsquo;
method. Bulletins are cancelled by calling the cancel version.
</p>


<h3>Value</h3>

<p>Called for its side-effects.
</p>


<h3>Note</h3>

<p>This is not &ldquo;news&rdquo; per se, it is a subscription to the API bulletins.
</p>


<h3>Author(s)</h3>

<p>Jeffrey A. Ryan
</p>


<h3>References</h3>

<p><a href="https://interactivebrokers.github.io/tws-api/classIBApi_1_1EClient.html#a286458a8be7d3b37f0d94fe61bf717fa">https://interactivebrokers.github.io/tws-api/classIBApi_1_1EClient.html#a286458a8be7d3b37f0d94fe61bf717fa</a>
</p>

<hr>
<h2 id='reqRealTimeBars'> Request Real Time Bars from TWS </h2><span id='topic+reqRealTimeBars'></span><span id='topic+cancelRealTimeBars'></span>

<h3>Description</h3>

<p>Allows for streaming real-time bars to be handled in <span class="rlang"><b>R</b></span>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reqRealTimeBars(conn,
                Contract,
                whatToShow = "TRADES", 
                barSize = "5",
                useRTH = TRUE,
                playback = 1,
                tickerId = "1",
                file = "",
                verbose = TRUE,
                eventWrapper=eWrapper(),
                CALLBACK=twsCALLBACK,
                ...) 

cancelRealTimeBars(conn, tickerId)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reqRealTimeBars_+3A_conn">conn</code></td>
<td>
<p> a valid <code>twsConnection</code> or <code>twsPlayback</code> object </p>
</td></tr>
<tr><td><code id="reqRealTimeBars_+3A_contract">Contract</code></td>
<td>
 <p><code>twsContract</code> object(s) requested </p>
</td></tr>
<tr><td><code id="reqRealTimeBars_+3A_tickerid">tickerId</code></td>
<td>
<p> the ticker id to associate with the returned bars </p>
</td></tr>
<tr><td><code id="reqRealTimeBars_+3A_whattoshow">whatToShow</code></td>
<td>
<p> what to show </p>
</td></tr>
<tr><td><code id="reqRealTimeBars_+3A_barsize">barSize</code></td>
<td>
<p> bar size - currently on 5 secs is TWS supported </p>
</td></tr>
<tr><td><code id="reqRealTimeBars_+3A_playback">playback</code></td>
<td>
<p> playback speed adjustment </p>
</td></tr>
<tr><td><code id="reqRealTimeBars_+3A_userth">useRTH</code></td>
<td>
<p> regular trading hours (logical) </p>
</td></tr>
<tr><td><code id="reqRealTimeBars_+3A_file">file</code></td>
<td>
<p> passed to internal <code>cat</code> calls. See associated help. </p>
</td></tr>
<tr><td><code id="reqRealTimeBars_+3A_verbose">verbose</code></td>
<td>
<p> print diagnostics </p>
</td></tr>
<tr><td><code id="reqRealTimeBars_+3A_eventwrapper">eventWrapper</code></td>
<td>
<p> eventWrapper object </p>
</td></tr>
<tr><td><code id="reqRealTimeBars_+3A_callback">CALLBACK</code></td>
<td>
<p> main reciever callback </p>
</td></tr>
<tr><td><code id="reqRealTimeBars_+3A_...">...</code></td>
<td>
<p> additional args to callback </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provides R level access to real time (5 second) bars
returned by the TWS API.  The Interactive Brokers documentation
should be reference for the exact meaning of the returned data.
</p>
<p>If the <code>conn</code> is a connection of data to be played
back all other arguments are ignores, except for <code>playback</code>,
which is a multiplier of the bar size in seconds.  To force
all data to be read without pause set this to 0.
</p>
<p>Callbacks, via eventRealTimeBars and CALLBACK are
designed to allow for R level processing of the real-time data
stream.
</p>
<p>eventWrapper allows for direct manipulation of the actual
signal recieved.
These may be user-defined functions taking the
appropriate arguments.  Each message recieved (each new bar)
will invoke one of this callback.
By default when nothing is specified, the code will
call the default method for printing the results to the screen via
'cat'.
</p>
<p>Note that the use of the argument 'file' will be passed to these
'cat' calls, and therefore it will be possible to use the
functionality of 'cat' directly - e.g. piping output or writing to
a connection.  The simplest use of file would be to specify the
name of a file, or open connection to append the output of the stream to.
</p>
<p>The 'CALLBACK' argument is used for more control of the incoming
results.  This requires user-level error checking as well as TWS
API interaction.  It is here for advanced use and until documented
should be left alone.
</p>


<h3>Value</h3>

<p>The real-time bar data requested.
</p>


<h3>Note</h3>

<p>As R is single threaded - this request will run until interupted
by an error or by user action. Both will clean up after themselves
when appropriate.
</p>


<h3>Author(s)</h3>

<p> Jeffrey A. Ryan </p>


<h3>References</h3>

<p> Interactive Brokers TWS API
<a href="https://interactivebrokers.github.io/tws-api/index.html">https://interactivebrokers.github.io/tws-api/index.html</a>
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+twsConnect">twsConnect</a></code>,<code><a href="#topic+twsContract">twsContract</a></code>,<code><a href="#topic+eWrapper">eWrapper</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
tws &lt;- twsConnect()
contract &lt;- twsEquity("QQQQ","SMART","ISLAND")
reqRealTimeBars(tws, contract)

# write to an open file connection
fh &lt;- file('out.dat',open='a')
reqRealTimeBars(tws, contract, file=fh)
close(fh)

## End(Not run)
</code></pre>

<hr>
<h2 id='setServerLogLevel'> Enable API Logging Via TWS </h2><span id='topic+setServerLogLevel'></span>

<h3>Description</h3>

<p>Set level of API logging to be done by TWS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setServerLogLevel(conn, logLevel = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setServerLogLevel_+3A_conn">conn</code></td>
<td>
<p> a valid <code>twsConnection</code> </p>
</td></tr>
<tr><td><code id="setServerLogLevel_+3A_loglevel">logLevel</code></td>
<td>
<p> an integer from 1 to 5 </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calling this function will set the logging
level for the current connection according
to the following table:
</p>

<ol>
<li><p>1:SYSTEM (least detail)
</p>
</li>
<li><p>2:ERROR (default)
</p>
</li>
<li><p>3:WARNING
</p>
</li>
<li><p>4:INFORMATION
</p>
</li>
<li><p>5:DETAIL (most detail)
</p>
</li></ol>

<p>See TWS documentation for further details.
</p>


<h3>Value</h3>

<p>This function is called for its side-effects.
</p>


<h3>Note</h3>

 
<p>The online documentation warns of performance overhead
when setting <code>logLevel=5</code>.
</p>


<h3>Author(s)</h3>

<p> Jeffrey A. Ryan </p>


<h3>References</h3>

<p> TWS API Logging
<a href="https://interactivebrokers.github.io/tws-api/support.html#tws_logs">https://interactivebrokers.github.io/tws-api/support.html#tws_logs</a>
<a href="https://interactivebrokers.github.io/tws-api/classIBApi_1_1EClient.html#a62ed6f4f391c86743c566d44c29dae48">https://interactivebrokers.github.io/tws-api/classIBApi_1_1EClient.html#a62ed6f4f391c86743c566d44c29dae48</a> </p>

<hr>
<h2 id='twsCALLBACK'> Internal Data Callback Routine </h2><span id='topic+twsCALLBACK'></span>

<h3>Description</h3>

<p>twsCALLBACK is the primary function that is called
after a request for data is sent.  Within this
call messages are recieved from the TWS, processed, and
further actions can be handled.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twsCALLBACK(twsCon, eWrapper, timestamp, file, playback = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twsCALLBACK_+3A_twscon">twsCon</code></td>
<td>
<p> a <code>twsConnection</code> object </p>
</td></tr> 
<tr><td><code id="twsCALLBACK_+3A_ewrapper">eWrapper</code></td>
<td>
<p> a closure created by <code>eWrapper()</code> </p>
</td></tr>
<tr><td><code id="twsCALLBACK_+3A_timestamp">timestamp</code></td>
<td>
<p> a logical indicating if timestamps should be created </p>
</td></tr>
<tr><td><code id="twsCALLBACK_+3A_file">file</code></td>
<td>
<p> the file or connection to write to </p>
</td></tr>
<tr><td><code id="twsCALLBACK_+3A_playback">playback</code></td>
<td>
<p> is this a live or playback connection </p>
</td></tr>
<tr><td><code id="twsCALLBACK_+3A_...">...</code></td>
<td>
<p> additional arguments to internal calls </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used as the primary management tool
within all data calls built into <span class="pkg">IBrokers</span>.
</p>
<p>It works as is, or can be modified to manage unique
data and trading requirements.
</p>
<p>The general logic of the function is to
recieve the header to each incoming message from the TWS.
This then gets passed to the <code>processMsg</code> function, along with
the eWrapper object.
</p>
<p>The eWrapper object can maintain state data (prices), and
has functions for managing all incoming message types from the TWS.
</p>
<p>Once the processMsg call returns, another cycle of the infinite loop
occurs.
</p>
<p>If the eWrapper object is used to maintain state information, it is
possible to access this information from outside of the processMsg
call, and thus be able to apply trade logic based upon the data
acquired from the TWS.
</p>
<p>An example will soon be available in the vignettes included in the package.
</p>


<h3>Value</h3>

<p>No value is returned.  This function is called for its side effects.
</p>


<h3>Author(s)</h3>

<p> Jeffrey A. Ryan </p>


<h3>See Also</h3>

 <p><code><a href="#topic+eWrapper">eWrapper</a></code> </p>

<hr>
<h2 id='twsConnect'> Establish, Check or Terminate a Connection to TWS or IBG </h2><span id='topic+twsConnect'></span><span id='topic+ibgConnect'></span><span id='topic+twsConnect2'></span><span id='topic+is.twsConnection'></span><span id='topic+is.twsPlayback'></span><span id='topic+isConnected'></span><span id='topic+twsDisconnect'></span>

<h3>Description</h3>

<p>Functions to initiate, check, or disconnect from the Trader
Workstation (TWS) or IB Gateway (IBG).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twsConnect(clientId = 1, host = 'localhost', 
           port = 7496, verbose = TRUE, timeout = 5,
           filename = NULL, blocking=.Platform$OS.type=="windows")
ibgConnect(clientId = 1, host = 'localhost', 
           port = 4001, verbose = TRUE, timeout = 5,
           filename = NULL, blocking=.Platform$OS.type=="windows")

twsDisconnect(twsconn)

isConnected(twsconn)
is.twsConnection(x)
is.twsPlayback(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twsConnect_+3A_clientid">clientId</code></td>
<td>
<p> the unique client id to associate with </p>
</td></tr>
<tr><td><code id="twsConnect_+3A_host">host</code></td>
<td>
<p> the host server </p>
</td></tr>
<tr><td><code id="twsConnect_+3A_port">port</code></td>
<td>
<p> the port that the TWS is listening on </p>
</td></tr>
<tr><td><code id="twsConnect_+3A_verbose">verbose</code></td>
<td>
<p> should the connection attempt be verbose </p>
</td></tr>
<tr><td><code id="twsConnect_+3A_timeout">timeout</code></td>
<td>
<p> length in seconds before aborting attempt </p>
</td></tr>
<tr><td><code id="twsConnect_+3A_filename">filename</code></td>
<td>
<p> file containing recorded TWS data </p>
</td></tr>
<tr><td><code id="twsConnect_+3A_blocking">blocking</code></td>
<td>
<p> should a blocking connection be established. See details. </p>
</td></tr>
<tr><td><code id="twsConnect_+3A_twsconn">twsconn</code></td>
<td>
<p> a valid <code>twsConnection</code> object </p>
</td></tr>
<tr><td><code id="twsConnect_+3A_x">x</code></td>
<td>
<p> a connection to be checked </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns a <code>twsConnection</code> object for use in
subsequent TWS API calls. Attempting to create another
connection to the server with the same clientId will
result in an error.
</p>
<p>If <code>filename</code> is set to a file containing
data recorded in the standard TWS format - calls
using this connection will playback the recorded
data.
</p>
<p>While the <span class="pkg">IBrokers</span> package is fully cross-platform,
the behavior of sockets varies by operating system implementation.
In general, setting <code>blocking=TRUE</code> on Windows (the default on
Windows) results in more consistent and reliable connections.
This option is only exposed to enable debugging of platform differences
and optimization - and is not intended to be altered except in
those cases.
</p>


<h3>Value</h3>

<p>A <code>twsconn</code> object.
</p>


<h3>Note</h3>

<p>While it is not strictly required to disconnect via <code>twsDisconnect</code>
it is probably advisable.
</p>
<p>If not set options(digits.secs=6) will be called
internally to properly represent on screen the
R based timestamps.
</p>


<h3>Author(s)</h3>

<p> Jeffrey A. Ryan </p>


<h3>References</h3>

<p> Interactive Brokers: <a href="https://www.interactivebrokers.com">https://www.interactivebrokers.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
tws &lt;- twsConnect()
twsDisconnect(tws)

## End(Not run)
</code></pre>

<hr>
<h2 id='twsConnectionTime'> TWS API Utility Functions </h2><span id='topic+twsConnectionTime'></span><span id='topic+serverVersion'></span>

<h3>Description</h3>

<p>General API utility functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twsConnectionTime(con)

serverVersion(con)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twsConnectionTime_+3A_con">con</code></td>
<td>
<p> a twsConnection object </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is simply extracted from the <code>twsConnection</code> object.
No API request is made.
</p>


<h3>Value</h3>

<p>The requested value.
</p>


<h3>Author(s)</h3>

<p> Jeffrey A. Ryan </p>


<h3>References</h3>

<p> Interactive Brokers LLC <a href="https://www.interactivebrokers.com/">https://www.interactivebrokers.com/</a></p>


<h3>See Also</h3>

 <p><code><a href="#topic+twsConnect">twsConnect</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
twsConnectionTime(con)
serverVersion(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='twsContract'> Create a twsContract </h2><span id='topic+twsContract'></span><span id='topic+twsIND'></span><span id='topic+twsIndex'></span><span id='topic+is.twsContract'></span><span id='topic+as.twsContract'></span>

<h3>Description</h3>

<p>Create, test, and coerce a twsContract for use in API calls.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twsContract(conId,
            symbol,
            sectype,
            exch,
            primary,
            expiry,
            strike,
            currency,
            right,
            local,
            multiplier,
            combo_legs_desc,
            comboleg,
            include_expired,
            secIdType = "",
            secId = "",
            tradingClass = ""
            )

is.twsContract(x)

as.twsContract(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twsContract_+3A_conid">conId</code></td>
<td>
<p> the IB contract ID </p>
</td></tr>
<tr><td><code id="twsContract_+3A_symbol">symbol</code></td>
<td>
<p> the IB symbol requested </p>
</td></tr>
<tr><td><code id="twsContract_+3A_sectype">sectype</code></td>
<td>
<p> the security type </p>
</td></tr>
<tr><td><code id="twsContract_+3A_exch">exch</code></td>
<td>
<p> the requested exchange </p>
</td></tr>
<tr><td><code id="twsContract_+3A_primary">primary</code></td>
<td>
<p> the primary exchange of the security </p>
</td></tr>
<tr><td><code id="twsContract_+3A_expiry">expiry</code></td>
<td>
<p> the expiration date </p>
</td></tr>
<tr><td><code id="twsContract_+3A_strike">strike</code></td>
<td>
<p> the strike price </p>
</td></tr>
<tr><td><code id="twsContract_+3A_currency">currency</code></td>
<td>
<p> the requested currency </p>
</td></tr>
<tr><td><code id="twsContract_+3A_right">right</code></td>
<td>
<p> the requested right </p>
</td></tr>
<tr><td><code id="twsContract_+3A_local">local</code></td>
<td>
<p> the local security name </p>
</td></tr>
<tr><td><code id="twsContract_+3A_multiplier">multiplier</code></td>
<td>
<p> the contract multiplier </p>
</td></tr>
<tr><td><code id="twsContract_+3A_combo_legs_desc">combo_legs_desc</code></td>
<td>
<p> not implemented yet </p>
</td></tr>
<tr><td><code id="twsContract_+3A_comboleg">comboleg</code></td>
<td>
<p> not implemented yet </p>
</td></tr>
<tr><td><code id="twsContract_+3A_include_expired">include_expired</code></td>
<td>
<p> should expired contracts be included </p>
</td></tr>
<tr><td><code id="twsContract_+3A_secidtype">secIdType</code></td>
<td>
<p> unique identifier for secIdType </p>
</td></tr>
<tr><td><code id="twsContract_+3A_secid">secId</code></td>
<td>
<p> security identifier: ISIN, CUSIP, SEDOL, RIC </p>
</td></tr>
<tr><td><code id="twsContract_+3A_tradingclass">tradingClass</code></td>
<td>
<p> trading class name for this contract. Available in TWS
contract description window as well. For example, the trading class for
GBL Dec '13 future's is &quot;FGBL&quot;. </p>
</td></tr>
<tr><td><code id="twsContract_+3A_x">x</code></td>
<td>
<p> object to test or coerce </p>
</td></tr>
<tr><td><code id="twsContract_+3A_...">...</code></td>
<td>
<p> additional arguments </p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are directly from the TWS API.  See that help until I can
find time to fill in this one.
</p>
<p>More useful for specific requests are <code>twsEquity</code>,
<code>twsOption</code>, <code>twsBond</code>, <code>twsFuture</code>, 
and <code>twsCurrency</code>.
</p>


<h3>Value</h3>

<p>A <code>twsContract</code> object.
</p>


<h3>Author(s)</h3>

<p> Jeffrey A. Ryan </p>


<h3>References</h3>

<p> Interactive Brokers: <a href="https://www.interactivebrokers.com">https://www.interactivebrokers.com</a></p>


<h3>See Also</h3>

 <p><code><a href="#topic+reqHistoricalData">reqHistoricalData</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>contract &lt;- twsContract(0,"AAPL","STK","SMART","ISLAND",
                        "","0.0","USD","","","",NULL,NULL,"0")
</code></pre>

<hr>
<h2 id='twsCurrency'> Create a twsCurrency </h2><span id='topic+twsCurrency'></span><span id='topic+twsCASH'></span>

<h3>Description</h3>

<p>Create a twsCurrency for use in API calls.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twsCurrency(symbol,
            currency='USD',
            exch='IDEALPRO',
            primary='',
            strike='0.0',
            right='',
            local='',
            multiplier='',
            include_expired='0',
            conId=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twsCurrency_+3A_symbol">symbol</code></td>
<td>
<p> the IB symbol requested </p>
</td></tr>
<tr><td><code id="twsCurrency_+3A_currency">currency</code></td>
<td>
<p> the requested currency </p>
</td></tr>
<tr><td><code id="twsCurrency_+3A_exch">exch</code></td>
<td>
<p> the requested exchange </p>
</td></tr>
<tr><td><code id="twsCurrency_+3A_primary">primary</code></td>
<td>
<p> the primary exchange of the security </p>
</td></tr>
<tr><td><code id="twsCurrency_+3A_strike">strike</code></td>
<td>
<p> the strike price </p>
</td></tr>
<tr><td><code id="twsCurrency_+3A_right">right</code></td>
<td>
<p> the requested right </p>
</td></tr>
<tr><td><code id="twsCurrency_+3A_local">local</code></td>
<td>
<p> the local security name </p>
</td></tr>
<tr><td><code id="twsCurrency_+3A_multiplier">multiplier</code></td>
<td>
<p> the contract multiplier </p>
</td></tr>
<tr><td><code id="twsCurrency_+3A_include_expired">include_expired</code></td>
<td>
<p> should expired contracts be included </p>
</td></tr>
<tr><td><code id="twsCurrency_+3A_conid">conId</code></td>
<td>
<p> contract ID </p>
</td></tr>
</table>


<h3>Details</h3>

<p>A wrapper to <code>twsContract</code> to make &lsquo;currency/FX&rsquo;
contracts easier to specify.
</p>
<p><code>twsCASH</code> is an alias.
</p>


<h3>Value</h3>

<p>A <code>twsContract</code> object.
</p>


<h3>Author(s)</h3>

<p> Jeffrey A. Ryan </p>


<h3>References</h3>

<p> Interactive Brokers: <a href="https://www.interactivebrokers.com">https://www.interactivebrokers.com</a></p>


<h3>See Also</h3>

 <p><code><a href="#topic+reqHistoricalData">reqHistoricalData</a></code>, <code><a href="#topic+twsContract">twsContract</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>currency &lt;- twsCurrency("EUR")
</code></pre>

<hr>
<h2 id='twsEquity'> Create a twsEquity </h2><span id='topic+twsEquity'></span><span id='topic+twsSTK'></span><span id='topic+twsCFD'></span>

<h3>Description</h3>

<p>Create a twsEquity for use in API calls.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twsEquity(symbol,
          exch="SMART",
          primary,
          strike='0.0',
          currency='USD',
          right='',
          local='',
          multiplier='',
          include_expired='0',
          conId=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twsEquity_+3A_symbol">symbol</code></td>
<td>
<p> the IB symbol requested </p>
</td></tr>
<tr><td><code id="twsEquity_+3A_exch">exch</code></td>
<td>
<p> the requested exchange (defaults to &lsquo;SMART&rsquo;) </p>
</td></tr>
<tr><td><code id="twsEquity_+3A_primary">primary</code></td>
<td>
<p> the primary exchange of the security </p>
</td></tr>
<tr><td><code id="twsEquity_+3A_strike">strike</code></td>
<td>
<p> the strike price </p>
</td></tr>
<tr><td><code id="twsEquity_+3A_currency">currency</code></td>
<td>
<p> the requested currency </p>
</td></tr>
<tr><td><code id="twsEquity_+3A_right">right</code></td>
<td>
<p> the requested right </p>
</td></tr>
<tr><td><code id="twsEquity_+3A_local">local</code></td>
<td>
<p> the local security name </p>
</td></tr>
<tr><td><code id="twsEquity_+3A_multiplier">multiplier</code></td>
<td>
<p> the contract multiplier </p>
</td></tr>
<tr><td><code id="twsEquity_+3A_include_expired">include_expired</code></td>
<td>
<p> should expired contracts be included </p>
</td></tr>
<tr><td><code id="twsEquity_+3A_conid">conId</code></td>
<td>
<p> contract ID </p>
</td></tr>
</table>


<h3>Details</h3>

<p>A wrapper to <code>twsContract</code> to make &lsquo;equity&rsquo;
contracts easier to specify.
</p>
<p><code>twsSTK</code> is an alias.
</p>


<h3>Value</h3>

<p>A <code>twsContract</code> object.
</p>


<h3>Author(s)</h3>

<p> Jeffrey A. Ryan </p>


<h3>References</h3>

<p> Interactive Brokers: <a href="https://www.interactivebrokers.com">https://www.interactivebrokers.com</a></p>


<h3>See Also</h3>

 <p><code><a href="#topic+reqHistoricalData">reqHistoricalData</a></code>, <code><a href="#topic+twsContract">twsContract</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>equity &lt;- twsEquity("AAPL","SMART","ISLAND")
</code></pre>

<hr>
<h2 id='twsFuture'> Create a twsFuture Contract </h2><span id='topic+twsFuture'></span><span id='topic+twsFUT'></span><span id='topic+twsFutureOpt'></span><span id='topic+twsFOP'></span>

<h3>Description</h3>

<p>Create a twsFuture contract for use in API calls.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twsFuture(symbol,
          exch,
          expiry,
          primary='',
          currency='USD',
          right='',
          local='',
          multiplier='',
          include_expired='0',
          conId=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twsFuture_+3A_symbol">symbol</code></td>
<td>
<p> the IB symbol requested </p>
</td></tr>
<tr><td><code id="twsFuture_+3A_exch">exch</code></td>
<td>
<p> the requested exchange </p>
</td></tr>
<tr><td><code id="twsFuture_+3A_expiry">expiry</code></td>
<td>
<p> the requested contract expiration </p>
</td></tr>
<tr><td><code id="twsFuture_+3A_primary">primary</code></td>
<td>
<p> the primary exchange of the security </p>
</td></tr>
<tr><td><code id="twsFuture_+3A_currency">currency</code></td>
<td>
<p> the requested currency </p>
</td></tr>
<tr><td><code id="twsFuture_+3A_right">right</code></td>
<td>
<p> the requested right </p>
</td></tr>
<tr><td><code id="twsFuture_+3A_local">local</code></td>
<td>
<p> the local security name </p>
</td></tr>
<tr><td><code id="twsFuture_+3A_multiplier">multiplier</code></td>
<td>
<p> the contract multiplier </p>
</td></tr>
<tr><td><code id="twsFuture_+3A_include_expired">include_expired</code></td>
<td>
<p> should expired contracts be included </p>
</td></tr>
<tr><td><code id="twsFuture_+3A_conid">conId</code></td>
<td>
<p> contract ID </p>
</td></tr>
</table>


<h3>Details</h3>

<p>A wrapper to <code>twsContract</code> to make &lsquo;futures&rsquo;
contracts easier to specify.
</p>
<p><code>twsFUT</code> is an alias.
</p>


<h3>Value</h3>

<p>A <code>twsContract</code> object.
</p>


<h3>Author(s)</h3>

<p> Jeffrey A. Ryan </p>


<h3>References</h3>

<p> Interactive Brokers: <a href="https://www.interactivebrokers.com">https://www.interactivebrokers.com</a></p>


<h3>See Also</h3>

 <p><code><a href="#topic+reqHistoricalData">reqHistoricalData</a></code>, <code><a href="#topic+twsContract">twsContract</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>future &lt;- twsFuture("NQ","GLOBEX","200803")
</code></pre>

<hr>
<h2 id='twsOption'> Create a twsContract for Options </h2><span id='topic+twsOption'></span><span id='topic+twsOPT'></span>

<h3>Description</h3>

<p>Create a twsContract for use in API calls.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twsOption(local,
          expiry="",
          strike="",
          right="",
          exch="SMART",
          primary="",
          currency='USD',
          symbol='',
          multiplier="100",
          include_expired='0',
          conId=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twsOption_+3A_local">local</code></td>
<td>
<p> the IB symbol requested </p>
</td></tr>
<tr><td><code id="twsOption_+3A_expiry">expiry</code></td>
<td>
<p> option expiration CCYYMM [optional]</p>
</td></tr>
<tr><td><code id="twsOption_+3A_strike">strike</code></td>
<td>
<p> the strike price [optional] </p>
</td></tr>
<tr><td><code id="twsOption_+3A_right">right</code></td>
<td>
<p> the requested right - &lsquo;C&rsquo;,&lsquo;CALL&rsquo;,
&lsquo;P&rsquo;, or &lsquo;PUT&rsquo; [optional]</p>
</td></tr>
<tr><td><code id="twsOption_+3A_exch">exch</code></td>
<td>
<p> the requested exchange [optional, defaults to SMART]</p>
</td></tr>
<tr><td><code id="twsOption_+3A_primary">primary</code></td>
<td>
<p> the primary exchange of the security [optional]</p>
</td></tr>
<tr><td><code id="twsOption_+3A_currency">currency</code></td>
<td>
<p> the requested currency [defaults to USD]</p>
</td></tr>
<tr><td><code id="twsOption_+3A_symbol">symbol</code></td>
<td>
<p> the security name [optional]</p>
</td></tr>
<tr><td><code id="twsOption_+3A_multiplier">multiplier</code></td>
<td>
<p> the contract multiplier </p>
</td></tr>
<tr><td><code id="twsOption_+3A_include_expired">include_expired</code></td>
<td>
<p> should expired contracts be included [defaults to &ldquo;0&rdquo; (false)] </p>
</td></tr>
<tr><td><code id="twsOption_+3A_conid">conId</code></td>
<td>
<p> contract ID </p>
</td></tr>
</table>


<h3>Details</h3>

<p>A wrapper to <code>twsContract</code> to make &lsquo;option&rsquo;
contracts easier to specify.
</p>
<p>Some of the optionable parameters are contingent on the
request being made.  Refer to the <em>TWS</em> documentation
for details.
</p>
<p><code>twsOPT</code> is an alias.
</p>


<h3>Value</h3>

<p>A <code>twsContract</code> object.
</p>


<h3>Note</h3>

<p>Option contracts on the TWS have certain rules which are different than
standard data requests.  
</p>
<p>The <code>local</code> symbol is required. This can be found on the main TWS
screen under contract details, or via the web at <a href="https://www.interactivebrokers.com">https://www.interactivebrokers.com</a>
</p>
<p>Since the local symbol is required, all other values are redundant.  It is best to simply
specify the local name and let the TWS manage the lookup.
</p>
<p>The <code>expiry</code> needs to be either of class <code>Date</code> to be coerced to
a string of format &lsquo;CCYYMM&rsquo;, or provided in that format.
</p>
<p>Historical requests cannot be for a barSize=&lsquo;1 D&rsquo;
or less frequent.  
</p>
<p><code>barSize</code> must be &quot;1 min&quot; per Interactive Brokers API.
</p>


<h3>Author(s)</h3>

<p> Jeffrey A. Ryan </p>


<h3>References</h3>

<p> Interactive Brokers: <a href="https://www.interactivebrokers.com">https://www.interactivebrokers.com</a></p>


<h3>See Also</h3>

 <p><code><a href="#topic+reqMktData">reqMktData</a></code>, <code><a href="#topic+twsContract">twsContract</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>opt &lt;- twsOption("QQQAS",expiry="200901", strike="45.0", right="C")
</code></pre>

<hr>
<h2 id='twsOrder'>
Create twsOrder Object
</h2><span id='topic+twsOrder'></span>

<h3>Description</h3>

<p>Create twsOrder object for <code>placeOrder</code> API call.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twsOrder(orderId,
         action = "BUY", 
         totalQuantity = "10", 
         orderType = "LMT",
         lmtPrice = "0.0", 
         auxPrice = "0.0",
         tif = "",
         outsideRTH = "0",
         openClose = "O",
         origin = .twsOrderID$CUSTOMER,
         ocaGroup = "",
         account = "",
         orderRef = "",
         transmit = TRUE,
         parentId = "0",
         blockOrder = "0",
         sweepToFill = "0",
         displaySize = "0",
         triggerMethod = "0",
         hidden = "0",
         discretionaryAmt = "0.0",
         goodAfterTime = "",
         goodTillDate = "",
         faGroup = "", 
         faMethod = "",
         faPercentage = "",
         faProfile = "",
         shortSaleSlot = "0",
         designatedLocation = .twsOrderID$EMPTY_STR,
         ocaType = "0",
         rule80A = "",
         settlingFirm = "",
         clearingAccount = "",
         clearingIntent = "",
         allOrNone = "0",
         minQty = "",
         percentOffset = "",
         eTradeOnly = "0",
         firmQuoteOnly = "0",
         nbboPriceCap = "",
         auctionStrategy = "0",
         startingPrice = "",
         stockRefPrice = "",
         delta = "",
         stockRangeLower = "",
         stockRangeUpper = "",
         overridePercentageConstraints = "0",
         volatility = "",
         volatilityType = "",
         deltaNeutralOrderType = "",
         deltaNeutralAuxPrice = "",
         continuousUpdate = "0",
         referencePriceType = "",
         trailStopPrice = "",
         basisPoints = "",
         basisPointsType = "",
         scaleInitLevelSize = "",
         scaleSubsLevelSize = "",
         scalePriceIncrement = "",
         notHeld = FALSE,
         algoStrategy = "",
         algoParams = NULL,
         whatIf = FALSE,
         clientId = "",
         permId = "",
         exemptCode = "-1",
         hedgeType = "",
         hedgeParam = "",
         optOutSmartRouting = FALSE,
         scaleTable = "",
         activeStartTime = "",
         activeStopTime = "",
         trailingPercent = "",
         deltaNeutralConId = "0",
         deltaNeutralSettlingFirm = "",
         deltaNeutralClearingAccount = "",
         deltaNeutralClearingIntent = "",
         deltaNeutralOpenClose = "",
         deltaNeutralShortSale = "0",
         deltaNeutralShortSaleSlot = "0",
         deltaNeutralDesignatedLocation = "",
         scalePriceAdjustValue = "0",
         scalePriceAdjustInterval = "0",
         scaleProfitOffset = "0",
         scaleAutoReset = "0",
         scaleInitPosition = "0",
         scaleInitFillQty = "0",
         scaleRandomPercent = "0",
         smartComboRoutingParams = NULL,
         smartComboRoutingParamsCount = "0",
         orderComboLegs = NULL,
         orderComboLegsCount = "0",
         comboLegs = NULL,
         comboLegsCount = "0",
         orderMiscOptions = NULL
         )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twsOrder_+3A_orderid">orderId</code></td>
<td>

<p>The id for the order. Use <code>reqIds</code>.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_action">action</code></td>
<td>

<p>Identifies the side.  ( BUY, SELL, SSHORT )
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_totalquantity">totalQuantity</code></td>
<td>

<p>Order quantity.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_ordertype">orderType</code></td>
<td>

<p>Order type. ( MKT, MKTCLS, LMT, LMTCLS, PEGMKT, SCALE, STP, STPLMT, TRAIL, REL, VWAP, TRAILLIMIT )
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_lmtprice">lmtPrice</code></td>
<td>

<p>The <em>LIMIT</em> price for LMT, STPLMT and REL <code>orderType</code>
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_auxprice">auxPrice</code></td>
<td>

<p>The <em>STOP</em> price for STPLMT (stop-limit) orders, and the offset for REL (relative) orders
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_tif">tif</code></td>
<td>

<p>Time in force. (DAY, GTC, IOC, GTD)
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_outsiderth">outsideRTH</code></td>
<td>

<p>Allow orders to trigger outside of regular trading hours.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_openclose">openClose</code></td>
<td>

<p>Specify whether order is open or close only. (Institutional Accounts Only)
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_origin">origin</code></td>
<td>

<p>The order origin. 0=customer, 1=firm (Institutional Accounts Only)
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_ocagroup">ocaGroup</code></td>
<td>

<p>Identifies OCA group.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_account">account</code></td>
<td>

<p>The account (Institutional Accounts Only)
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_orderref">orderRef</code></td>
<td>

<p>The order reference (Institutional Accounts Only)
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_transmit">transmit</code></td>
<td>

<p>Specify whether the order is transmitted to the TWS.  If FALSE, order is created but not
sent. (not implemented)
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_parentid">parentId</code></td>
<td>

<p>The orderId of the parent order, used for bracket and auto trailing stop orders.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_blockorder">blockOrder</code></td>
<td>

<p>ISE block order?
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_sweeptofill">sweepToFill</code></td>
<td>

<p>Sweep to fill order?
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_displaysize">displaySize</code></td>
<td>

<p>Publicly disclosed order size for Iceberg orders.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_triggermethod">triggerMethod</code></td>
<td>

<p>How should <em>simulated</em> orders be triggered. Valid values are 0-8.
See the official API for details.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_hidden">hidden</code></td>
<td>

<p>Hide order on ISLAND?
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_discretionaryamt">discretionaryAmt</code></td>
<td>

<p>Amount off limit for discretionary orders.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_goodaftertime">goodAfterTime</code></td>
<td>

<p>Trades Good After Time: YYYYMMDD hh:mm:ss or &quot;&quot;
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_goodtilldate">goodTillDate</code></td>
<td>

<p>Trades Good Till Date: YYYYMMDD hh:mm:ss or &quot;&quot;
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_fagroup">faGroup</code></td>
<td>

<p>NA
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_famethod">faMethod</code></td>
<td>

<p>NA
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_fapercentage">faPercentage</code></td>
<td>

<p>NA
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_faprofile">faProfile</code></td>
<td>

<p>NA
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_shortsaleslot">shortSaleSlot</code></td>
<td>

<p>1 or 2
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_designatedlocation">designatedLocation</code></td>
<td>

<p>Only when <code>shortSaleSlot=2</code>
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_ocatype">ocaType</code></td>
<td>

<p>Cancel on Fill with Block = 1
Reduce on Fill with Block = 2
Reduce on Fill without Block = 3
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_rule80a">rule80A</code></td>
<td>

<p>Valid values: I, A, W, J, U, M, K, Y, N.  See API.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_settlingfirm">settlingFirm</code></td>
<td>

<p>(Institutional Only)
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_clearingaccount">clearingAccount</code></td>
<td>

<p>IBExecution customers only.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_clearingintent">clearingIntent</code></td>
<td>

<p>IBExecution customers only.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_allornone">allOrNone</code></td>
<td>

<p>yes=1, no=0
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_minqty">minQty</code></td>
<td>

<p>Minimum quantity order type.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_percentoffset">percentOffset</code></td>
<td>

<p>Percent offset for REL (relative) orders.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_etradeonly">eTradeOnly</code></td>
<td>

<p>Trade with electronic quotes. yes=1, no=0.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_firmquoteonly">firmQuoteOnly</code></td>
<td>

<p>Trade with firm quotes. yes=1, no=0.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_nbbopricecap">nbboPriceCap</code></td>
<td>

<p>The maximum Smart order distance from the NBBO.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_auctionstrategy">auctionStrategy</code></td>
<td>

<p>BOX only.  See API.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_startingprice">startingPrice</code></td>
<td>

<p>BOX only.  See API.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_stockrefprice">stockRefPrice</code></td>
<td>

<p>The stock reference price.  VOL orders. See API.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_delta">delta</code></td>
<td>

<p>BOX only.  See API.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_stockrangelower">stockRangeLower</code></td>
<td>

<p>See API.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_stockrangeupper">stockRangeUpper</code></td>
<td>

<p>See API.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_overridepercentageconstraints">overridePercentageConstraints</code></td>
<td>

<p>See API.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_volatility">volatility</code></td>
<td>

<p>See API.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_volatilitytype">volatilityType</code></td>
<td>

<p>See API.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_deltaneutralordertype">deltaNeutralOrderType</code></td>
<td>

<p>See API.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_deltaneutralauxprice">deltaNeutralAuxPrice</code></td>
<td>

<p>See API.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_continuousupdate">continuousUpdate</code></td>
<td>

<p>See API.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_referencepricetype">referencePriceType</code></td>
<td>

<p>See API.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_trailstopprice">trailStopPrice</code></td>
<td>

<p>For TRAILLIMIT orders only.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_basispoints">basisPoints</code></td>
<td>

<p>EFP orders only.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_basispointstype">basisPointsType</code></td>
<td>

<p>EFP orders only.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_scaleinitlevelsize">scaleInitLevelSize</code></td>
<td>

<p>For Scale orders.  See API.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_scalesubslevelsize">scaleSubsLevelSize</code></td>
<td>

<p>For Scale orders.  See API.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_scalepriceincrement">scalePriceIncrement</code></td>
<td>

<p>For Scale orders.  See API.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_notheld">notHeld</code></td>
<td>

<p>See API and guess.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_algostrategy">algoStrategy</code></td>
<td>

<p>See API and guess.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_algoparams">algoParams</code></td>
<td>

<p>See API and guess.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_whatif">whatIf</code></td>
<td>

<p>Use to request pre-trade commissions and margin information. TRUE/FALSE
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_clientid">clientId</code></td>
<td>

<p>Id of the client that placed the order.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_permid">permId</code></td>
<td>

<p>TWS id used to identify orders. Constant over a session.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_exemptcode">exemptCode</code></td>
<td>

<p>Mark order as exempt from short sale uptick rule.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_hedgetype">hedgeType</code></td>
<td>

<p>For hedge orders. Possible values include: D=delta, B=beta, F=FX, P=Pair
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_hedgeparam">hedgeParam</code></td>
<td>

<p>Beta = x for Beta hedge orders, ratio = y for Pair hedge order
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_optoutsmartrouting">optOutSmartRouting</code></td>
<td>

<p>Use to opt out of default SmartRouting for orders routed directly to ASX.
This attribute defaults to false unless explicitly set to true. When set to
false, orders routed directly to ASX will NOT use SmartRouting. When set to
true, orders routed directly to ASX orders WILL use SmartRouting.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_scaletable">scaleTable</code></td>
<td>

<p>Used for scale orders
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_activestarttime">activeStartTime</code></td>
<td>

<p>for GTC orders
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_activestoptime">activeStopTime</code></td>
<td>

<p>for GTC orders
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_trailingpercent">trailingPercent</code></td>
<td>

<p>Specifies the trailing amount of a trailing stop order as a percentage. See
the API docs for guidelines.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_deltaneutralconid">deltaNeutralConId</code></td>
<td>

<p>See API docs
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_deltaneutralsettlingfirm">deltaNeutralSettlingFirm</code></td>
<td>

<p>See API docs
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_deltaneutralclearingaccount">deltaNeutralClearingAccount</code></td>
<td>

<p>See API docs
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_deltaneutralclearingintent">deltaNeutralClearingIntent</code></td>
<td>

<p>See API docs
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_deltaneutralopenclose">deltaNeutralOpenClose</code></td>
<td>

<p>Specifies whether the order is an Open or a Close order and is used when the
hedge involves a CFD and and the order is clearing away.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_deltaneutralshortsale">deltaNeutralShortSale</code></td>
<td>

<p>Used when the hedge involves a stock and indicates whether or not it is sold
short.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_deltaneutralshortsaleslot">deltaNeutralShortSaleSlot</code></td>
<td>

<p>Has a value of 1 (the clearing broker holds shares) or 2 (delivered from a
third party). If you use 2, then you must specify a deltaNeutralDesignatedLocation.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_deltaneutraldesignatedlocation">deltaNeutralDesignatedLocation</code></td>
<td>

<p>Used only when deltaNeutralShortSaleSlot = 2.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_scalepriceadjustvalue">scalePriceAdjustValue</code></td>
<td>

<p>For extended Scale orders
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_scalepriceadjustinterval">scalePriceAdjustInterval</code></td>
<td>

<p>For extended Scale orders
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_scaleprofitoffset">scaleProfitOffset</code></td>
<td>

<p>For extended Scale orders
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_scaleautoreset">scaleAutoReset</code></td>
<td>

<p>For extended Scale orders
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_scaleinitposition">scaleInitPosition</code></td>
<td>

<p>For extended Scale order
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_scaleinitfillqty">scaleInitFillQty</code></td>
<td>

<p>For extended Scale orders
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_scalerandompercent">scaleRandomPercent</code></td>
<td>

<p>For extended Scale orders
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_smartcomboroutingparams">smartComboRoutingParams</code></td>
<td>

<p>Advanced parameters for Smart combo routing .
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_smartcomboroutingparamscount">smartComboRoutingParamsCount</code></td>
<td>

<p>Number of parameters
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_ordercombolegs">orderComboLegs</code></td>
<td>

<p>List of Per-leg price following the same sequence combo legs are added. The
combo price must be left unspecified when using per-leg prices.
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_ordercombolegscount">orderComboLegsCount</code></td>
<td>

<p>Number of parameters
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_combolegs">comboLegs</code></td>
<td>

<p>See API docs
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_combolegscount">comboLegsCount</code></td>
<td>

<p>See API docs
</p>
</td></tr>
<tr><td><code id="twsOrder_+3A_ordermiscoptions">orderMiscOptions</code></td>
<td>

<p>See API docs
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Read the API documentation, code, and experiment with the paper accounts. And good luck!
</p>


<h3>Value</h3>

<p>Called for its side-effects.
</p>


<h3>Note</h3>

<p>Documentation is far from complete on this topic. Experiment and share your experiences.
</p>


<h3>Author(s)</h3>

<p>Jeffrey A. Ryan
</p>


<h3>References</h3>

<p>Order API:
<a href="https://interactivebrokers.github.io/tws-api/order_management.html">https://interactivebrokers.github.io/tws-api/order_management.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+placeOrder">placeOrder</a></code>
</p>

<hr>
<h2 id='twsScannerSubscription'>
Create ScannerSubscription
</h2><span id='topic+twsScannerSubscription'></span>

<h3>Description</h3>

<p>Create an object for use with <code>reqScannerSubscription</code> and
<code>.reqScannerSubscription</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twsScannerSubscription(numberOfRows = -1, 
                       instrument = "", 
                       locationCode = "", 
                       scanCode = "", 
                       abovePrice = "", 
                       belowPrice = "", 
                       aboveVolume = "",
                       averageOptionVolumeAbove = "",
                       marketCapAbove = "", 
                       marketCapBelow = "", 
                       moodyRatingAbove = "", 
                       moodyRatingBelow = "", 
                       spRatingAbove = "", 
                       spRatingBelow = "", 
                       maturityDateAbove = "", 
                       maturityDateBelow = "", 
                       couponRateAbove = "", 
                       couponRateBelow = "", 
                       excludeConvertible = "", 
                       scannerSettingPairs = "", 
                       stockTypeFilter = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twsScannerSubscription_+3A_numberofrows">numberOfRows</code></td>
<td>

<p>Number of rows of scanner results returned
</p>
</td></tr>
<tr><td><code id="twsScannerSubscription_+3A_instrument">instrument</code></td>
<td>

<p>A character string of STK, ...
</p>
</td></tr>
<tr><td><code id="twsScannerSubscription_+3A_locationcode">locationCode</code></td>
<td>

<p>A character string of STK.NA, STK.US, STK.US.MAJOR, ...
</p>
</td></tr>
<tr><td><code id="twsScannerSubscription_+3A_scancode">scanCode</code></td>
<td>

<p>One of the available scans. See details
</p>
</td></tr>
<tr><td><code id="twsScannerSubscription_+3A_aboveprice">abovePrice</code></td>
<td>

<p>Price to filter above
</p>
</td></tr>
<tr><td><code id="twsScannerSubscription_+3A_belowprice">belowPrice</code></td>
<td>

<p>Price to filter below
</p>
</td></tr>
<tr><td><code id="twsScannerSubscription_+3A_abovevolume">aboveVolume</code></td>
<td>

<p>Volume to filter above
</p>
</td></tr>
<tr><td><code id="twsScannerSubscription_+3A_averageoptionvolumeabove">averageOptionVolumeAbove</code></td>
<td>

<p>Average option volume above this
</p>
</td></tr>
<tr><td><code id="twsScannerSubscription_+3A_marketcapabove">marketCapAbove</code></td>
<td>

<p>Market cap to filter above
</p>
</td></tr>
<tr><td><code id="twsScannerSubscription_+3A_marketcapbelow">marketCapBelow</code></td>
<td>

<p>Market cap to filter below
</p>
</td></tr>
<tr><td><code id="twsScannerSubscription_+3A_moodyratingabove">moodyRatingAbove</code></td>
<td>

<p>Moody rating to filter above
</p>
</td></tr>
<tr><td><code id="twsScannerSubscription_+3A_moodyratingbelow">moodyRatingBelow</code></td>
<td>

<p>Moody rating to filter below
</p>
</td></tr>
<tr><td><code id="twsScannerSubscription_+3A_spratingabove">spRatingAbove</code></td>
<td>

<p>S&amp;P rating to filter above
</p>
</td></tr>
<tr><td><code id="twsScannerSubscription_+3A_spratingbelow">spRatingBelow</code></td>
<td>

<p>S&amp;P rating to filter below
</p>
</td></tr>
<tr><td><code id="twsScannerSubscription_+3A_maturitydateabove">maturityDateAbove</code></td>
<td>

<p>Maturity date to filter above
</p>
</td></tr>
<tr><td><code id="twsScannerSubscription_+3A_maturitydatebelow">maturityDateBelow</code></td>
<td>

<p>Maturity date to filter below
</p>
</td></tr>
<tr><td><code id="twsScannerSubscription_+3A_couponrateabove">couponRateAbove</code></td>
<td>

<p>Coupon rate to filter above
</p>
</td></tr>
<tr><td><code id="twsScannerSubscription_+3A_couponratebelow">couponRateBelow</code></td>
<td>

<p>Coupon rate to filter below
</p>
</td></tr>
<tr><td><code id="twsScannerSubscription_+3A_excludeconvertible">excludeConvertible</code></td>
<td>

<p>?
</p>
</td></tr>
<tr><td><code id="twsScannerSubscription_+3A_scannersettingpairs">scannerSettingPairs</code></td>
<td>

<p>?
</p>
</td></tr>
<tr><td><code id="twsScannerSubscription_+3A_stocktypefilter">stockTypeFilter</code></td>
<td>

<p>&quot;ALL&quot;?
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By necessity, design, or otherwise - scanner data is difficult
to correctly use at the API level.  The valid values and some
small examples are returned by the API using the related
<code>reqScannerParameters</code> function. The XML returned by that
call isn't very clear in its value or purpose though.
</p>


<h3>Value</h3>

<p>A (potentially) valid twsScannerSubscription object for
<code>reqScannerSubscription</code> calls.
</p>


<h3>Note</h3>

<p>Further documentation will be forthcoming. Users are encouraged to email use cases
to make for better documentation.
</p>


<h3>Author(s)</h3>

<p>Jeffrey A. Ryan
</p>


<h3>References</h3>

<p><a href="https://interactivebrokers.github.io/tws-api/classIBApi_1_1ScannerSubscription.html">https://interactivebrokers.github.io/tws-api/classIBApi_1_1ScannerSubscription.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+reqScannerSubscription">reqScannerSubscription</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>scnr &lt;- twsScannerSubscription(numberOfRows=10,
                               instrument="STK",
                               locationCode="STK.US.MAJOR",
                               scanCode="TOP_PERC_GAIN",
                               aboveVolume=0,
                               marketCapAbove=1e8,
                               scannerSettingPairs="Annual,true",
                               stockTypeFilter="ALL")
scnr
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
