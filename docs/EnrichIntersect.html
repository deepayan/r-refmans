<!DOCTYPE html><html><head><title>Help for package EnrichIntersect</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EnrichIntersect}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cancers_drug_groups'><p>Data set 'cancers_drug_groups'</p></a></li>
<li><a href='#cancers_genes_drugs'><p>Data set 'cancers_genes_drugs'</p></a></li>
<li><a href='#enrichment'><p>Plot enrichment map</p></a></li>
<li><a href='#intersectSankey'><p>Plot Sankey diagram for intersecting sets</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Enrichment Analysis and Intersecting Sankey Diagram</td>
</tr>
<tr>
<td>Version:</td>
<td>0.7</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-14</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ocbe-uio/EnrichIntersect">https://github.com/ocbe-uio/EnrichIntersect</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ocbe-uio/EnrichIntersect/issues">https://github.com/ocbe-uio/EnrichIntersect/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>A flexible tool for enrichment analysis based on user-defined sets. It allows users to perform over-representation analysis of the custom sets among any specified ranked feature list, hence making enrichment analysis applicable to various types of data from different scientific fields. 'EnrichIntersect' also enables an interactive means to visualize identified associations based on, for example, the mix-lasso model (Zhao et al., 2022 &lt;<a href="https://doi.org/10.1016%2Fj.isci.2022.104767">doi:10.1016/j.isci.2022.104767</a>&gt;) or similar methods.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, dplyr, networkD3, jsonlite, htmlwidgets, webshot2,
stats, methods, grDevices</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-14 21:53:20 UTC; zhiz</td>
</tr>
<tr>
<td>Author:</td>
<td>Zhi Zhao [aut, cre],
  Manuela Zucknick [aut],
  Tero Aittokallio [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zhi Zhao &lt;zhi.zhao@medisin.uio.no&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-14 22:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cancers_drug_groups'>Data set 'cancers_drug_groups'</h2><span id='topic+cancers_drug_groups'></span>

<h3>Description</h3>

<p>Data set 'cancers_drug_groups' is a list including a score dataframe with 
147 drugs as rows and 19 cancer types as columns, and a dataframe with 9 
self-defined drug groups (1st column) of the 147 drugs (2nd column). More 
details of the data can be found in the results of paper 'Tissue-specific 
identification of multi-omics features for pan-cancer drug response 
prediction' by Zhao Z., Wang S. Zucknick M. and Aittokallio T. (2022).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cancers_drug_groups
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 2.
</p>


<h3>Value</h3>

<p>No return value.
</p>


<h3>References</h3>

<p>Zhao Z, Wang S, Zucknick M and Aittokallio T (2022). 
<em>Tissue-specific identification of multi-omics features for 
pan-cancer drug response prediction</em>. iScience, 25(8): 104767.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load data
data(cancers_drug_groups, package = "EnrichIntersect")

</code></pre>

<hr>
<h2 id='cancers_genes_drugs'>Data set 'cancers_genes_drugs'</h2><span id='topic+cancers_genes_drugs'></span>

<h3>Description</h3>

<p>Data set 'cancers_genes_drugs' is an array with association scores between 
56 genes (1st dimension), three cancer types (2nd dimension) and two drugs 
(3rd dimension). More details of the data can be found in the results of 
paper 'Tissue-specific identification of multi-omics features for pan-cancer 
drug response prediction' by Zhao Z., Wang S. Zucknick M. and Aittokallio 
T. (2022).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cancers_genes_drugs
</code></pre>


<h3>Format</h3>

<p>An object of class <code>array</code> of dimension 56 x 3 x 2.
</p>


<h3>Value</h3>

<p>No return value.
</p>


<h3>References</h3>

<p>Zhao Z, Wang S, Zucknick M and Aittokallio T (2022). <em>
Tissue-specific identification of multi-omics features for pan-cancer drug 
response prediction</em>. iScience, 25(8): 104767.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load data
data(cancers_genes_drugs, package = "EnrichIntersect")

</code></pre>

<hr>
<h2 id='enrichment'>Plot enrichment map</h2><span id='topic+enrichment'></span>

<h3>Description</h3>

<p>Plot enrichment map through a vector (matrix) of scores and a self-defined 
set that summarizes a few groups of the names (rownames) of the vector 
(matrix)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>enrichment(
  x,
  custom.set,
  alpha = 0,
  normalize = TRUE,
  permute.n = 100,
  padj.method = "none",
  pvalue.cutoff = 0.05,
  angle = 45,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="enrichment_+3A_x">x</code></td>
<td>
<p>a vector (matrix) of scores to be enriched</p>
</td></tr>
<tr><td><code id="enrichment_+3A_custom.set">custom.set</code></td>
<td>
<p>a self-defined set that summarizes a few groups of the 
names (rownames) of <code>x</code></p>
</td></tr>
<tr><td><code id="enrichment_+3A_alpha">alpha</code></td>
<td>
<p>exponent weight of the score of ordered features. Default is 
<code>0</code> for calculating enrichment score via classic Kolmogorov-Smirnov 
statistic</p>
</td></tr>
<tr><td><code id="enrichment_+3A_normalize">normalize</code></td>
<td>
<p>logic value to determine if normalizing enrichment scores, 
accounting for custom set size. Default is <code>TRUE</code></p>
</td></tr>
<tr><td><code id="enrichment_+3A_permute.n">permute.n</code></td>
<td>
<p>number of custom-set permutations for significance 
testing. Default is 100</p>
</td></tr>
<tr><td><code id="enrichment_+3A_padj.method">padj.method</code></td>
<td>
<p>correction method, one of <code>"holm"</code>, 
<code>"hochberg"</code>, <code>"hommel"</code>, <code>"bonferroni"</code>, <code>"BH"</code>, 
<code>"BY"</code>, <code>"fdr"</code>, <code>"none"</code>. Default is <code>"none"</code></p>
</td></tr>
<tr><td><code id="enrichment_+3A_pvalue.cutoff">pvalue.cutoff</code></td>
<td>
<p>a cutoff for both unadjusted and adjusted p-value to 
mark significantly enriched classes. Default is 0.05</p>
</td></tr>
<tr><td><code id="enrichment_+3A_angle">angle</code></td>
<td>
<p>angle of rotating x-axis labels. Default is 45</p>
</td></tr>
<tr><td><code id="enrichment_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a list including a matrix of (normalized) enrichment score, 
a matrix of corresponding p-value and ggplot object:
</p>

<ul>
<li><p> S - a matrix of calculated enrichment scores.
</p>
</li>
<li><p> pvalue - a matrix of p-values using permuation test for the calculated enrichment scores.
</p>
</li>
<li><p> g - a ggplot object for visualising the results of an enrichment analysis.
</p>
</li></ul>



<h3>References</h3>

<p>Reimand J, Isserlin R, Voisin V, et al (2019). <em>Pathway 
enrichment analysis and visualization of omics data using g:profiler, gsea, 
cytoscape and enrichmentmap</em>. Nature protocols, 14:482â€“517.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data set 'cancers_drug_groups' is a list including a score dataframe with 147 drugs as rows
# and 19 cancer types as columns, and a dataframe with 9 self-defined drug groups (1st column)
# of the 147 drugs (2nd column).
data(cancers_drug_groups, package = "EnrichIntersect")

x &lt;- cancers_drug_groups$score
custom.set &lt;- cancers_drug_groups$custom.set
set.seed(123)
enrich &lt;- enrichment(x, custom.set, permute.n = 5)

</code></pre>

<hr>
<h2 id='intersectSankey'>Plot Sankey diagram for intersecting sets</h2><span id='topic+intersectSankey'></span>

<h3>Description</h3>

<p>Plot Sankey diagram for intersecting set through an array
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intersectSankey(
  x,
  out.fig = NULL,
  color = NULL,
  step.names = c("Levels", "Variables", "Tasks"),
  fontSize = c(20, 13, 20),
  nodePadding = 11,
  nodeWidth = 5,
  margin = list(right = 180),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intersectSankey_+3A_x">x</code></td>
<td>
<p>an array for constructing intersecting set</p>
</td></tr>
<tr><td><code id="intersectSankey_+3A_out.fig">out.fig</code></td>
<td>
<p>print the figure into <code>"html"</code>, <code>"pdf"</code> or 
<code>"png"</code> file. Default is <code>NULL</code> with R graphics device</p>
</td></tr>
<tr><td><code id="intersectSankey_+3A_color">color</code></td>
<td>
<p>a vector of colors corresponding to individual tasks</p>
</td></tr>
<tr><td><code id="intersectSankey_+3A_step.names">step.names</code></td>
<td>
<p>names of the three dimensions of the array <code>x</code>, i.e. 
names of multiple levels, intermediate variables and tasks. Default is 
<code>c("Levels","Variables","Tasks")</code>. If <code>step.names=NULL</code>, it will 
not show the names</p>
</td></tr>
<tr><td><code id="intersectSankey_+3A_fontsize">fontSize</code></td>
<td>
<p>a value or vector of three values. If it is one value, it 
is the font size for all labels. But a vector of three values specifies the 
font size of the labels in the left, middle and right, respectively. Default
is <code>c(20,10,20)</code></p>
</td></tr>
<tr><td><code id="intersectSankey_+3A_nodepadding">nodePadding</code></td>
<td>
<p>numeric essentially influences the width height</p>
</td></tr>
<tr><td><code id="intersectSankey_+3A_nodewidth">nodeWidth</code></td>
<td>
<p>numeric width of each node</p>
</td></tr>
<tr><td><code id="intersectSankey_+3A_margin">margin</code></td>
<td>
<p>an integer or a named list/vector of integers for the plot 
margins</p>
</td></tr>
<tr><td><code id="intersectSankey_+3A_...">...</code></td>
<td>
<p>graphics parameters to be passed to <code>sankeyNetwork()</code> 
from R package <code>networkD3</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of a D3 JavaScript intersecting Sankey diagram for 
visualising associations based on the input array.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data set 'cancers_genes_drugs' is an array with association scores between 56 genes (1st
# dimension), three cancer types (2nd dimension) and two drugs (3rd dimension)
data(cancers_genes_drugs, package = "EnrichIntersect")

intersectSankey(cancers_genes_drugs, step.names = c("Cancers", "Genes", "Drugs"))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
