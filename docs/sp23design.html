<!DOCTYPE html><html><head><title>Help for package sp23design</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sp23design}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#sp23design-package'>
<p>sp23design: A package for the design, exploration and execution of seamless Phase</p>
II-II clinical trials</a></li>
<li><a href='#analyzeSP23Design'>
<p>Analyses the results of running a design. If a trial history, such as</p>
the result of the function <code>executeSP23Design</code> or a history
of the actual conduct of a single trial is provided, it returns the
analysis results.</a></li>
<li><a href='#computeDGivenXi'>
<p>Given the estimates of the <code class="reqn">\pi</code> and <code class="reqn">\theta</code>, compute <code class="reqn">d</code>.</p></a></li>
<li><a href='#computeGammaSubT'>
<p>Compute the estimate of the variance of the generalized</p>
likelihood ratio statistic at time <code class="reqn">t</code></a></li>
<li><a href='#computeResponseSummary'>
<p>Given interim data, compute the response end-point summary</p></a></li>
<li><a href='#executeSP23Design'>
<p>Given a design object, interim data and the current calendar time,</p>
conduct the interim analysis for the time</a></li>
<li><a href='#exploreSP23Design'>
<p>Explore a specified design by simulation</p></a></li>
<li><a href='#generateClinicalTrialData'>
<p>A function to generate some clinical trial data according the joint</p>
model of response and survival for simulations</a></li>
<li><a href='#generateInterimData'>
<p>Generate interim data for a clinical trial from a data set.</p></a></li>
<li><a href='#generateSP23Design'>
<p>Generate a seamless Phase II-III design object given some the true</p>
parameters and clinical trial parameters</a></li>
<li><a href='#hessian'>
<p>A utility function to compute the hessian of the generalized (conditional)</p>
partial likelihood ratio statistic</a></li>
<li><a href='#loglik1'>
<p>Compute the response log-likelihood</p></a></li>
<li><a href='#loglik1GivenDelta'>
<p>Computes the constrained response log-likelihood (on the alternative)</p></a></li>
<li><a href='#loglik2'>
<p>Computes the survival log-likelihood</p></a></li>
<li><a href='#loglik2.repar0'>
<p>Computes the constrained survival log-likelihood</p></a></li>
<li><a href='#mHP.b'>
<p>Compute the modified Haybittle-Peto boundary</p></a></li>
<li><a href='#mHP.c'>
<p>Compute the modified Haybittle-Peto boundary for the final look</p></a></li>
<li><a href='#performInterimLook'>
<p>Perform an interim look in a seamless Phase II-III clinical trial</p></a></li>
<li><a href='#resetSP23Design'>
<p>Reset the design object so that counts and results are zeroed out</p></a></li>
<li><a href='#solveForCGivenABD'>
<p>A convenience function to reduce dimension by solving for one variable</p>
<code class="reqn">c</code> in terms of others <code class="reqn">a</code>, <code class="reqn">b</code>, <code class="reqn">d</code></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Design and Simulation of Seamless Phase II-III Clinical Trials</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-04-18</td>
</tr>
<tr>
<td>Author:</td>
<td>Balasubramanian Narasimhan [aut, cre],
  Mei-Chiung Shih [aut],
  Pei He [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Balasubramanian Narasimhan &lt;naras@stat.stanford.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides methods for generating, exploring and executing seamless Phase II-III designs of Lai, Lavori and Shih using generalized likelihood ratio statistics. Includes pdf and source files that describe the entire R implementation with the relevant mathematical details.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>mvtnorm, survival</td>
</tr>
<tr>
<td>Suggests:</td>
<td>RUnit</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-04-19 00:19:50 UTC; naras</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-04-19 10:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='sp23design-package'>
sp23design: A package for the design, exploration and execution of seamless Phase
II-II clinical trials
</h2><span id='topic+sp23design-package'></span><span id='topic+sp23design'></span>

<h3>Description</h3>

<p>This package implements the methodology described in the paper below
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> sp23design</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2011-05-05</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> LGPL?</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The most important functions in this package are
<code><a href="#topic+generateSP23Design">generateSP23Design</a></code>, <code><a href="#topic+exploreSP23Design">exploreSP23Design</a></code>,
<code><a href="#topic+executeSP23Design">executeSP23Design</a></code>, and <code><a href="#topic+analyzeSP23Design">analyzeSP23Design</a></code>
</p>


<h3>Author(s)</h3>

<p>Mei-Chiung Shih, Balasubramanian Narasimhan, Pei He
</p>
<p>Maintainer: Balasubramanian Narasimhan &lt;naras@stat.stanford.edu&gt;
</p>


<h3>References</h3>

<p>Lai, Tze Leung and Lavori, Philip W. and Shih, Mei-Chiung. Sequential
Design of Phase II-III Cancer Trials, Statistics in Medicine, Volume 31, issue 18, p.1944-1960, 2012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  catn &lt;- function(...) cat(..., "\n")

  trialParameters &lt;- list(minimumNumberOfEvents = 20,
                          minimumIncreaseInV = 0.2,
                          numberRecruitedEachYear = c(80, 120, 160, 160),
                          followupTime = 3,
                          adminCensoringTime = 7,
                          interimLookTime = c(1, 2, 3, 5, 7),
                          type1ErrorForResponse = 0.05,
                          type2ErrorForResponse = 0.01,
                          glrBoundarySidedness = "one", # one sided or two-sided
                          type1Error = 0.05,
                          type2Error = 0.10,
                          epsType1 = 1/3,
                          epsType2 = 1/3)

  trueParameters &lt;- list(p0 = 0.3,
                         p1 = 0.3,
                         pdiffHyp=0.3,
                         theta = list(
                             alpha = 0,
                             beta = 0,
                             gamma = 0),
                         baselineLambda = 0.35,
                         etaHyp = 0.25)
  rngSeed &lt;- 9872831
  sp23Design &lt;- generateSP23Design(trueParameters, trialParameters)
  print(sp23Design)
  trialHistory &lt;- exploreSP23Design(sp23Design, numberOfSimulations=25, rngSeed=rngSeed)
  result &lt;- analyzeSP23Design(sp23Design, trialHistory)$designSummary
  catn("numberOfTimesH0RIsRejectedAtFirstLook", result[["numberOfTimesH0RIsRejectedAtFirstLook"]])
  catn("numberOfTimesH0RIsRejected", result[["numberOfTimesH0RIsRejected"]])
  catn("numberOfTimesStoppedForFutility", result[["numberOfTimesStoppedForFutility"]])
  catn("numberOfTimesH0SIsAccepted", result[["numberOfTimesH0SIsAccepted"]])
  catn("numberOfTimesH0SIsRejected", result[["numberOfTimesH0SIsRejected"]])
  catn("numberOfTimesFutilityDecidedAtLastLook",result[["numberOfTimesFutilityDecidedAtLastLook"]])
  catn("numberOfTimesTrialEndedAtLook", result[["numberOfTimesTrialEndedAtLook"]])
  catn("avgExitTime", result[["avgExitTime"]])

## End(Not run)
</code></pre>

<hr>
<h2 id='analyzeSP23Design'>
Analyses the results of running a design. If a trial history, such as
the result of the function <code><a href="#topic+executeSP23Design">executeSP23Design</a></code> or a history
of the actual conduct of a single trial is provided, it returns the
analysis results.
</h2><span id='topic+analyzeSP23Design'></span>

<h3>Description</h3>

<p>Produces analysis results from the run of a single trial or a number
of simulations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>analyzeSP23Design(sp23Design, trialHistory = NULL, data = NULL,
  col=c("red", "red", "brown", "brown"), lty=c(1,2,1,2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="analyzeSP23Design_+3A_sp23design">sp23Design</code></td>
<td>

<p>The design object typically produced by calling
<code><a href="#topic+generateSP23Design">generateSP23Design</a></code>.
</p>
</td></tr>
<tr><td><code id="analyzeSP23Design_+3A_trialhistory">trialHistory</code></td>
<td>

<p>Typically the result of calling <code><a href="#topic+executeSP23Design">executeSP23Design</a></code>
which is a single data frame, or, the result produced by calling
<code><a href="#topic+exploreSP23Design">exploreSP23Design</a></code> which is a list of data frames, one
for each simulation.
</p>
</td></tr>
<tr><td><code id="analyzeSP23Design_+3A_data">data</code></td>
<td>

<p>This is only used when the argument <code>trialHistory</code> is a single
data frame, in which case, it should be the data generated in the
clinical trial.
</p>
</td></tr>
<tr><td><code id="analyzeSP23Design_+3A_col">col</code></td>
<td>

<p>Colors used for the survival plots
</p>
</td></tr>
<tr><td><code id="analyzeSP23Design_+3A_lty">lty</code></td>
<td>

<p>Line types for the survival plots
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>trialHistory</code> is a single data frame, the naive response
estimates and a survival plot are produced. Otherwise, the counts of
the number of times the various hypothesis are rejected and other
details are returned.
</p>


<h3>Value</h3>

<p>A list of two items named <code>responseSummary</code> and <code>designSummary</code>
If <code>trialHistory</code> is a single data frame, the naive response
estimates are returned in <code>responseSummary</code> and a survival plot
is produced. Otherwise, the counts of the number of times the various
hypothesis are rejected and other details are returned in
<code>designSummary</code>.
</p>


<h3>Author(s)</h3>

<p>Mei-Chiung Shih, Balasubramanian Narasimhan, Pei He
</p>


<h3>References</h3>

<p>Lai, Tze Leung and Lavori, Philip W. and Shih, Mei-Chiung. Sequential
Design of Phase II-III Cancer Trials, Statistics in Medicine, Volume 31, issue 18, p.1944-1960, 2012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  catn &lt;- function(...) cat(..., "\n")

  trialParameters &lt;- list(minimumNumberOfEvents = 20,
                          minimumIncreaseInV = 0.2,
                          numberRecruitedEachYear = c(80, 120, 160, 160),
                          followupTime = 3,
                          adminCensoringTime = 7,
                          interimLookTime = c(1, 2, 3, 5, 7),
                          type1ErrorForResponse = 0.05,
                          type2ErrorForResponse = 0.01,
                          glrBoundarySidedness = "one", # one sided or two-sided
                          type1Error = 0.05,
                          type2Error = 0.10,
                          epsType1 = 1/3,
                          epsType2 = 1/3)

  trueParameters &lt;- list(p0 = 0.3,
                         p1 = 0.3,
                         pdiffHyp=0.3,
                         theta = list(
                             alpha = 0,
                             beta = 0,
                             gamma = 0),
                         baselineLambda = 0.35,
                         etaHyp = 0.25)
  rngSeed &lt;- 9872831
  sp23Design &lt;- generateSP23Design(trueParameters, trialParameters)
  print(sp23Design)
  trialHistory &lt;- exploreSP23Design(sp23Design, numberOfSimulations=25, rngSeed=rngSeed)
  result &lt;- analyzeSP23Design(sp23Design, trialHistory)$designSummary
  catn("numberOfTimesH0RIsRejectedAtFirstLook",result[["numberOfTimesH0RIsRejectedAtFirstLook"]])
  catn("numberOfTimesH0RIsRejected", result[["numberOfTimesH0RIsRejected"]])
  catn("numberOfTimesStoppedForFutility", result[["numberOfTimesStoppedForFutility"]])
  catn("numberOfTimesH0SIsAccepted", result[["numberOfTimesH0SIsAccepted"]])
  catn("numberOfTimesH0SIsRejected", result[["numberOfTimesH0SIsRejected"]])
  catn("numberOfTimesFutilityDecidedAtLastLook",result[["numberOfTimesFutilityDecidedAtLastLook"]])
  catn("numberOfTimesTrialEndedAtLook", result[["numberOfTimesTrialEndedAtLook"]])
  catn("avgExitTime", result[["avgExitTime"]])

## End(Not run)

</code></pre>

<hr>
<h2 id='computeDGivenXi'>
Given the estimates of the <code class="reqn">\pi</code> and <code class="reqn">\theta</code>, compute <code class="reqn">d</code>.
</h2><span id='topic+computeDGivenXi'></span>

<h3>Description</h3>

<p>This function computes <code class="reqn">d</code> via
</p>
<p style="text-align: center;"><code class="reqn">d(\pi,\xi)=\{ \pi_0 a + (1-\pi_0)\} - \{\pi_1 abc + (1-\pi_1)b \} </code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>computeDGivenXi(piVec, xiVec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="computeDGivenXi_+3A_pivec">piVec</code></td>
<td>
<p> The two-element vector of <code class="reqn">(\pi_0, \pi_1)</code>
</p>
</td></tr>
<tr><td><code id="computeDGivenXi_+3A_xivec">xiVec</code></td>
<td>

<p>The three-element vector of <code class="reqn">(a=e^\alpha, b=e^\beta, c=e^\gamma)</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an approximation to the hazard ratio
</p>


<h3>Value</h3>

<p>The computed value of <code class="reqn">d</code>, a scalar
</p>


<h3>Author(s)</h3>

<p>Mei-Chiung Shih, Balasubramanian Narasimhan, Pei He
</p>


<h3>References</h3>

<p>Lai, Tze Leung and Lavori, Philip W. and Shih, Mei-Chiung. Sequential
Design of Phase II-III Cancer Trials, Statistics in Medicine, Volume 31, issue 18, p.1944-1960, 2012.
</p>

<hr>
<h2 id='computeGammaSubT'>
Compute the estimate of the variance of the generalized
likelihood ratio statistic at time <code class="reqn">t</code>
</h2><span id='topic+computeGammaSubT'></span>

<h3>Description</h3>

<p>This function computes the variance of the generalized
likelihood ratio statistic at interim stopping times
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeGammaSubT(thetaHat, pi, interimData)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="computeGammaSubT_+3A_thetahat">thetaHat</code></td>
<td>

<p>The three-element vector of <code class="reqn">(\alpha, \beta, \gamma)</code>
</p>
</td></tr>
<tr><td><code id="computeGammaSubT_+3A_pi">pi</code></td>
<td>

<p>The two-element vector of <code class="reqn">(\pi_0, \pi_1)</code>
</p>
</td></tr>
<tr><td><code id="computeGammaSubT_+3A_interimdata">interimData</code></td>
<td>

<p>The interim data at time <code class="reqn">t</code> as a data frame
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function builds a hessian matrix and uses a reparametrization to
compute <code class="reqn">\Gamma_t</code>, the variance of the generalized likelihood
ration stochastic process at time
$t$.
</p>


<h3>Value</h3>

<p>A scalar value of the variance <code class="reqn">\Gamma_t</code>
</p>


<h3>Author(s)</h3>

<p>Mei-Chiung Shih, Balasubramanian Narasimhan, Pei He
</p>


<h3>References</h3>

<p>Lai, Tze Leung and Lavori, Philip W. and Shih, Mei-Chiung. Sequential
Design of Phase II-III Cancer Trials, Statistics in Medicine, Volume 31, issue 18, p.1944-1960, 2012.
</p>

<hr>
<h2 id='computeResponseSummary'>
Given interim data, compute the response end-point summary
</h2><span id='topic+computeResponseSummary'></span>

<h3>Description</h3>

<p>Compute the response end-point summary for interim data. This will
include the proportion of responses, the proportion of people on
treatment and control etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeResponseSummary(interimData)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="computeResponseSummary_+3A_interimdata">interimData</code></td>
<td>

<p>The interim data for the clinical trial
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The result is a vector of counts and proportions
</p>


<h3>Value</h3>

<table>
<tr><td><code>m0</code></td>
<td>
<p>number on control arm</p>
</td></tr>
<tr><td><code>m1</code></td>
<td>
<p>number on treatment arm</p>
</td></tr>
<tr><td><code>y0</code></td>
<td>
<p>number of responses in control</p>
</td></tr>
<tr><td><code>y1</code></td>
<td>
<p>number of responses in treatment</p>
</td></tr>
<tr><td><code>numberOfTotalResponses</code></td>
<td>
<p>number of total responses in both arms</p>
</td></tr>
<tr><td><code>controlRespProp</code></td>
<td>
<p>the proportion of responders in control arm</p>
</td></tr>
<tr><td><code>treatmentRespProp</code></td>
<td>
<p>the proportion of responders in the treatment
arm</p>
</td></tr>
<tr><td><code>pooledProp</code></td>
<td>
<p> the pooled response proportion</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mei-Chiung Shih, Balasubramanian Narasimhan, Pei He
</p>


<h3>References</h3>

<p>Lai, Tze Leung and Lavori, Philip W. and Shih, Mei-Chiung. Sequential
Design of Phase II-III Cancer Trials, Statistics in Medicine, Volume 31, issue 18, p.1944-1960, 2012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  trialParameters &lt;- list(minimumNumberOfEvents = 20,
                              minimumIncreaseInV = 0.2,
                              numberRecruitedEachYear = c(80, 120, 160, 160),
                              followupTime = 3,
                              adminCensoringTime = 7,
                              interimLookTime = c(1, 2, 3, 5, 7),
                              type1ErrorForResponse = 0.05,
                              type2ErrorForResponse = 0.01,
                              glrBoundarySidedness = "one", # one sided or two-sided
                              type1Error = 0.05,
                              type2Error = 0.10,
                              epsType1 = 1/3,
                              epsType2 = 1/3)

  trueParameters &lt;- list(p0 = 0.3,
                             p1 = 0.3,
                             pdiffHyp=0.3,
                             theta = list(
                                     alpha = 0,
                                     beta = 0,
                                     gamma = 0),
                             baselineLambda = 0.35,
                             etaHyp = 0.25)
  rngSeed &lt;- 9872831

  d &lt;- generateClinicalTrialData(nRec = trialParameters$numberRecruitedEachYear,
                                     nFUp = trialParameters$followupTime,
                                     pi0 = trueParameters$p0,
                                     pi1 = trueParameters$p1,
                                     theta = trueParameters$theta,
                                     lambda0 = trueParameters$baselineLambda)
  dInterim &lt;- generateInterimData(d, trialParameters$interimLookTime[2],
                                      trialParameters$adminCensoringTime)
  computeResponseSummary(dInterim)

## End(Not run)
</code></pre>

<hr>
<h2 id='executeSP23Design'>
Given a design object, interim data and the current calendar time,
conduct the interim analysis for the time
</h2><span id='topic+executeSP23Design'></span>

<h3>Description</h3>

<p>This function is designed to be used in the field. Assuming a
particular design is chosen, it conducts the interim analysis for a
specific calendar time and provides the means for deciding whether to
stop for futility or efficacy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>executeSP23Design(sp23DesignObject, data, currentCalendarTime)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="executeSP23Design_+3A_sp23designobject">sp23DesignObject</code></td>
<td>

<p>A seamless phase II-III design object, typically one produced by the
<code><a href="#topic+generateSP23Design">generateSP23Design</a></code> function
</p>
</td></tr>
<tr><td><code id="executeSP23Design_+3A_data">data</code></td>
<td>

<p>The interim data, something akin to that produced by the function
<code><a href="#topic+generateInterimData">generateInterimData</a></code>
</p>
</td></tr>
<tr><td><code id="executeSP23Design_+3A_currentcalendartime">currentCalendarTime</code></td>
<td>

<p>The current calendar time of the interim data. This better be one of
the specified interim looks, or the function stops.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is designed to be used in the field, although there are
parts of it that are currently problematic. For example, in the field,
there is typically no inkling of a responder or non-responder and yet
the function as it currently stands is too wedded to the simulation
scenario. Not hard to fix though.
</p>


<h3>Value</h3>

<p> A vector of quantities is returned.
</p>
<table>
<tr><td><code>m0</code></td>
<td>
<p>number on control arm</p>
</td></tr>
<tr><td><code>m1</code></td>
<td>
<p>number on treatment arm</p>
</td></tr>
<tr><td><code>y0</code></td>
<td>
<p>number of responses in control</p>
</td></tr>
<tr><td><code>y1</code></td>
<td>
<p>number of responses in treatment</p>
</td></tr>
<tr><td><code>pi0Hat</code></td>
<td>
<p>estimate of the proportion of responders among control</p>
</td></tr>
<tr><td><code>pi1Hat</code></td>
<td>
<p>estimate of the proportion of responders among treatment</p>
</td></tr>
<tr><td><code>pi0HatH0</code></td>
<td>
<p> estimate of the proportion of responders among control
under <code class="reqn">H_0</code></p>
</td></tr>
<tr><td><code>pi1HatH0</code></td>
<td>
<p>estimate of the proportion of responders among control
under <code class="reqn">H_0</code></p>
</td></tr>
<tr><td><code>pi0HatH1</code></td>
<td>
<p>estimate of the proportion of responders among control
under <code class="reqn">H_1</code></p>
</td></tr>
<tr><td><code>pi1HatH1</code></td>
<td>
<p>estimate of the proportion of responders among control
under <code class="reqn">H_1</code></p>
</td></tr>
<tr><td><code>glrRespH0</code></td>
<td>
<p>estimate of the generalized likelihood ratio
statistic for response under <code class="reqn">H_0</code></p>
</td></tr>
<tr><td><code>glrRespH1</code></td>
<td>
<p>estimate of the generalized likelihood ratio
statistic for response under <code class="reqn">H_1</code></p>
</td></tr>
<tr><td><code>glrSurvH0</code></td>
<td>
<p>estimate of the generalized likelihood ratio
statistic for survival under <code class="reqn">H_0</code></p>
</td></tr>
<tr><td><code>glrSurvH1</code></td>
<td>
<p>estimate of the generalized likelihood ratio
statistic for survival under <code class="reqn">H_1</code></p>
</td></tr>
<tr><td><code>alphaHat</code></td>
<td>
<p>the estimate of <code class="reqn">\alpha</code></p>
</td></tr>
<tr><td><code>alphaHatH0</code></td>
<td>
<p>the estimate of <code class="reqn">\alpha</code> under <code class="reqn">H_0</code></p>
</td></tr>
<tr><td><code>alphaHatH1</code></td>
<td>
<p>the estimate of <code class="reqn">\alpha</code> under <code class="reqn">H_1</code></p>
</td></tr>
<tr><td><code>betaHat</code></td>
<td>
<p>the estimate of <code class="reqn">\beta</code></p>
</td></tr>
<tr><td><code>betaHatH0</code></td>
<td>
<p>the estimate of <code class="reqn">\beta</code> under <code class="reqn">H_0</code></p>
</td></tr>
<tr><td><code>betaHatH1</code></td>
<td>
<p>the estimate of <code class="reqn">\beta</code> under <code class="reqn">H_1</code></p>
</td></tr>
<tr><td><code>gammaHat</code></td>
<td>
<p>the estimate of <code class="reqn">\gamma</code></p>
</td></tr>
<tr><td><code>gammaHatH0</code></td>
<td>
<p>the estimate of <code class="reqn">\gamma</code> under <code class="reqn">H_0</code></p>
</td></tr>
<tr><td><code>gammaHatH1</code></td>
<td>
<p>the estimate of <code class="reqn">\gamma</code> under <code class="reqn">H_1</code></p>
</td></tr>
<tr><td><code>hazard</code></td>
<td>
<p>the estimate of <code class="reqn">d</code></p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>the estimate of <code class="reqn">\Gamma_t</code></p>
</td></tr>
<tr><td><code>rejectH0R</code></td>
<td>
<p>a flag indicating if $H_0^R$ was rejected at the
interim look</p>
</td></tr>
<tr><td><code>acceptH0R</code></td>
<td>
<p>a flag indicating if $H_0^R$ was accepted
(futility) at the interim look</p>
</td></tr>
<tr><td><code>rejectH0S</code></td>
<td>
<p>a flag indicating if $H_0^S$ was rejected at the
interim look</p>
</td></tr>
<tr><td><code>acceptH0S</code></td>
<td>
<p>a flag indicating if $H_0^S$ was accepted
(futility) at the interim look</p>
</td></tr>
<tr><td><code>b.metas.Last</code></td>
<td>
<p>the last Haybittle-Peto boundary for the
survival end-point, if computed</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mei-Chiung Shih, Balasubramanian Narasimhan, Pei He
</p>


<h3>References</h3>

<p>Lai, Tze Leung and Lavori, Philip W. and Shih, Mei-Chiung. Sequential
Design of Phase II-III Cancer Trials, Statistics in Medicine, Volume 31, issue 18, p.1944-1960, 2012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  trialParameters &lt;- list(minimumNumberOfEvents = 20,
                              minimumIncreaseInV = 0.2,
                              numberRecruitedEachYear = c(80, 120, 160, 160),
                              followupTime = 3,
                              adminCensoringTime = 7,
                              interimLookTime = c(1, 2, 3, 5, 7),
                              type1ErrorForResponse = 0.05,
                              type2ErrorForResponse = 0.01,
                              glrBoundarySidedness = "one", # one sided or two-sided
                              type1Error = 0.05,
                              type2Error = 0.10,
                              epsType1 = 1/3,
                              epsType2 = 1/3)

  trueParameters &lt;- list(p0 = 0.3,
                             p1 = 0.3,
                             pdiffHyp=0.3,
                             theta = list(
                                     alpha = 0,
                                     beta = 0,
                                     gamma = 0),
                             baselineLambda = 0.35,
                             etaHyp = 0.25)
  rngSeed &lt;- 9872831

  sp23Design &lt;- generateSP23Design(trueParameters, trialParameters)
  d &lt;- generateClinicalTrialData(nRec = trialParameters$numberRecruitedEachYear,
                                 nFUp = trialParameters$followupTime,
                                 pi0 = trueParameters$p0,
                                 pi1 = trueParameters$p1,
                                 theta = trueParameters$theta,
                                 lambda0 = trueParameters$baselineLambda)
  result &lt;- executeSP23Design(sp23Design, d, trialParameters$interimLookTime[2])

## End(Not run)
</code></pre>

<hr>
<h2 id='exploreSP23Design'>
Explore a specified design by simulation
</h2><span id='topic+exploreSP23Design'></span>

<h3>Description</h3>

<p>Explore a chosen design by generating simulated datasets and storing
data from simulations for further analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exploreSP23Design(sp23Design, numberOfSimulations = 25, rngSeed = 12345,
showProgress = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exploreSP23Design_+3A_sp23design">sp23Design</code></td>
<td>

<p>A design object typically created by the function <code><a href="#topic+generateSP23Design">generateSP23Design</a></code>
</p>
</td></tr>
<tr><td><code id="exploreSP23Design_+3A_numberofsimulations">numberOfSimulations</code></td>
<td>

<p>The number of simulations to use, default 25
</p>
</td></tr>
<tr><td><code id="exploreSP23Design_+3A_rngseed">rngSeed</code></td>
<td>

<p>A seed for the random number generator for reproducibility
</p>
</td></tr>
<tr><td><code id="exploreSP23Design_+3A_showprogress">showProgress</code></td>
<td>

<p>A flag (default <code>TRUE</code>) to show progress or not
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used while exploring the characteristics of a
design. Results are accumulated and can be fed into analysis functions
to inform choices.
</p>


<h3>Value</h3>

<p>A list of length <code>numberOfSimulations</code> where each entry is a data
frame with number of interim looks rows and the following variables in
the column.
</p>
<table>
<tr><td><code>m0</code></td>
<td>
<p>number on control arm</p>
</td></tr>
<tr><td><code>m1</code></td>
<td>
<p>number on treatment arm</p>
</td></tr>
<tr><td><code>y0</code></td>
<td>
<p>number of responses in control</p>
</td></tr>
<tr><td><code>y1</code></td>
<td>
<p>number of responses in treatment</p>
</td></tr>
<tr><td><code>pi0Hat</code></td>
<td>
<p>estimate of the proportion of responders among control</p>
</td></tr>
<tr><td><code>pi1Hat</code></td>
<td>
<p>estimate of the proportion of responders among treatment</p>
</td></tr>
<tr><td><code>pi0HatH0</code></td>
<td>
<p> estimate of the proportion of responders among control
under <code class="reqn">H_0</code></p>
</td></tr>
<tr><td><code>pi1HatH0</code></td>
<td>
<p>estimate of the proportion of responders among control
under <code class="reqn">H_0</code></p>
</td></tr>
<tr><td><code>pi0HatH1</code></td>
<td>
<p>estimate of the proportion of responders among control
under <code class="reqn">H_1</code></p>
</td></tr>
<tr><td><code>pi1HatH1</code></td>
<td>
<p>estimate of the proportion of responders among control
under <code class="reqn">H_1</code></p>
</td></tr>
<tr><td><code>glrRespH0</code></td>
<td>
<p>estimate of the generalized likelihood ratio
statistic for response under <code class="reqn">H_0</code></p>
</td></tr>
<tr><td><code>glrRespH1</code></td>
<td>
<p>estimate of the generalized likelihood ratio
statistic for response under <code class="reqn">H_1</code></p>
</td></tr>
<tr><td><code>glrSurvH0</code></td>
<td>
<p>estimate of the generalized likelihood ratio
statistic for survival under <code class="reqn">H_0</code></p>
</td></tr>
<tr><td><code>glrSurvH1</code></td>
<td>
<p>estimate of the generalized likelihood ratio
statistic for survival under <code class="reqn">H_1</code></p>
</td></tr>
<tr><td><code>alphaHat</code></td>
<td>
<p>the estimate of <code class="reqn">\alpha</code></p>
</td></tr>
<tr><td><code>alphaHatH0</code></td>
<td>
<p>the estimate of <code class="reqn">\alpha</code> under <code class="reqn">H_0</code></p>
</td></tr>
<tr><td><code>alphaHatH1</code></td>
<td>
<p>the estimate of <code class="reqn">\alpha</code> under <code class="reqn">H_1</code></p>
</td></tr>
<tr><td><code>betaHat</code></td>
<td>
<p>the estimate of <code class="reqn">\beta</code></p>
</td></tr>
<tr><td><code>betaHatH0</code></td>
<td>
<p>the estimate of <code class="reqn">\beta</code> under <code class="reqn">H_0</code></p>
</td></tr>
<tr><td><code>betaHatH1</code></td>
<td>
<p>the estimate of <code class="reqn">\beta</code> under <code class="reqn">H_1</code></p>
</td></tr>
<tr><td><code>gammaHat</code></td>
<td>
<p>the estimate of <code class="reqn">\gamma</code></p>
</td></tr>
<tr><td><code>gammaHatH0</code></td>
<td>
<p>the estimate of <code class="reqn">\gamma</code> under <code class="reqn">H_0</code></p>
</td></tr>
<tr><td><code>gammaHatH1</code></td>
<td>
<p>the estimate of <code class="reqn">\gamma</code> under <code class="reqn">H_1</code></p>
</td></tr>
<tr><td><code>hazard</code></td>
<td>
<p>the estimate of <code class="reqn">d</code></p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>the estimate of <code class="reqn">\Gamma_t</code></p>
</td></tr>
<tr><td><code>rejectH0R</code></td>
<td>
<p>a flag indicating if $H_0^R$ was rejected at the
interim look</p>
</td></tr>
<tr><td><code>acceptH0R</code></td>
<td>
<p>a flag indicating if $H_0^R$ was accepted
(futility) at the interim look</p>
</td></tr>
<tr><td><code>rejectH0S</code></td>
<td>
<p>a flag indicating if $H_0^S$ was rejected at the
interim look</p>
</td></tr>
<tr><td><code>acceptH0S</code></td>
<td>
<p>a flag indicating if $H_0^S$ was accepted
(futility) at the interim look</p>
</td></tr>
<tr><td><code>b.metas.Last</code></td>
<td>
<p>the last Haybittle-Peto boundary for the
survival end-point, if computed</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mei-Chiung Shih, Balasubramanian Narasimhan, Pei He
</p>


<h3>References</h3>

<p>Lai, Tze Leung and Lavori, Philip W. and Shih, Mei-Chiung. Sequential
Design of Phase II-III Cancer Trials, Statistics in Medicine, 2011,
(submitted).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  trialParameters &lt;- list(minimumNumberOfEvents = 20,
                          minimumIncreaseInV = 0.2,
                          numberRecruitedEachYear = c(80, 120, 160, 160),
                          followupTime = 3,
                          adminCensoringTime = 7,
                          interimLookTime = c(1, 2, 3, 5, 7),
                          type1ErrorForResponse = 0.05,
                          type2ErrorForResponse = 0.01,
                          glrBoundarySidedness = "one", # one sided or two-sided
                          type1Error = 0.05,
                          type2Error = 0.10,
                          epsType1 = 1/3,
                          epsType2 = 1/3)

  ## Case C of table 1 in paper
  caseC.TrueParameters &lt;- list(p0 = 0.3,
                               p1 = 0.6,
                               pdiffHyp=0.3,
                               theta = list(
                                   alpha = 0,
                                   beta = 0,
                                   gamma = 0),
                               baselineLambda = 0.35,
                               etaHyp = 0.25)
  ## Do case C as example
  sp23Design &lt;- generateSP23Design(caseC.TrueParameters, trialParameters)
  trialHistory &lt;- exploreSP23Design(sp23Design, numberOfSimulations=25, rngSeed=2387487)

## End(Not run)
</code></pre>

<hr>
<h2 id='generateClinicalTrialData'>
A function to generate some clinical trial data according the joint
model of response and survival for simulations
</h2><span id='topic+generateClinicalTrialData'></span>

<h3>Description</h3>

<p>The data is generated according to the model specified in the
reference below, specifically,
</p>
<p style="text-align: center;"><code class="reqn">  \lambda(t \mid Y,Z)=\lambda_0(t) \exp(\alpha Y + \beta Z + \gamma Y
  Z)</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>generateClinicalTrialData(nRec, nFUp, pi0, pi1, theta, lambda0, blockSize = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generateClinicalTrialData_+3A_nrec">nRec</code></td>
<td>

<p>the number of patients recruited every year. Length(nRec) is the number of years of recruitment
</p>
</td></tr>
<tr><td><code id="generateClinicalTrialData_+3A_nfup">nFUp</code></td>
<td>

<p>the number of additional years of followup
</p>
</td></tr>
<tr><td><code id="generateClinicalTrialData_+3A_pi0">pi0</code></td>
<td>

<p>the probability of response under control arm
</p>
</td></tr>
<tr><td><code id="generateClinicalTrialData_+3A_pi1">pi1</code></td>
<td>

<p>the probability of response under treatment arm
</p>
</td></tr>
<tr><td><code id="generateClinicalTrialData_+3A_theta">theta</code></td>
<td>

<p>the three dimensional parameter <code class="reqn">(\alpha, \beta, \gamma)</code> of the
joint response/survival model
</p>
</td></tr>
<tr><td><code id="generateClinicalTrialData_+3A_lambda0">lambda0</code></td>
<td>

<p>the baseline hazard rate
</p>
</td></tr>
<tr><td><code id="generateClinicalTrialData_+3A_blocksize">blockSize</code></td>
<td>

<p>the size of the blocks for randomization of the treatment/control;
we use block randomization
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates data from an exponentail distribution according to the model
and adhering to the recruitment goals for each calendar year
</p>


<h3>Value</h3>

<p>A data frame consisting of the following variables.
</p>
<table>
<tr><td><code>entryTime</code></td>
<td>
<p>entry time of the patient into the trial</p>
</td></tr>
<tr><td><code>responseIndicator</code></td>
<td>
<p>an indicator of patient being a responder or not</p>
</td></tr>
<tr><td><code>treatmentIndicator</code></td>
<td>
<p>an indicator of patient being in treatment
arm or control</p>
</td></tr>
<tr><td><code>timeToEvent</code></td>
<td>
<p>the time to event or death in the language of the paper</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mei-Chiung Shih, Balasubramanian Narasimhan, Pei He
</p>


<h3>References</h3>

<p>Lai, Tze Leung and Lavori, Philip W. and Shih, Mei-Chiung. Sequential
Design of Phase II-III Cancer Trials, Statistics in Medicine, Volume 31, issue 18, p.1944-1960, 2012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  trialParameters &lt;- list(minimumNumberOfEvents = 20,
                              minimumIncreaseInV = 0.2,
                              numberRecruitedEachYear = c(80, 120, 160, 160),
                              followupTime = 3,
                              adminCensoringTime = 7,
                              interimLookTime = c(1, 2, 3, 5, 7),
                              type1ErrorForResponse = 0.05,
                              type2ErrorForResponse = 0.01,
                              glrBoundarySidedness = "one", # one sided or two-sided
                              type1Error = 0.05,
                              type2Error = 0.10,
                              epsType1 = 1/3,
                              epsType2 = 1/3)

  trueParameters &lt;- list(p0 = 0.3,
                             p1 = 0.3,
                             pdiffHyp=0.3,
                             theta = list(
                                     alpha = 0,
                                     beta = 0,
                                     gamma = 0),
                             baselineLambda = 0.35,
                             etaHyp = 0.25)
  rngSeed &lt;- 9872831

  d &lt;- generateClinicalTrialData(nRec = trialParameters$numberRecruitedEachYear,
                                     nFUp = trialParameters$followupTime,
                                     pi0 = trueParameters$p0,
                                     pi1 = trueParameters$p1,
                                     theta = trueParameters$theta,
                                     lambda0 = trueParameters$baselineLambda)

</code></pre>

<hr>
<h2 id='generateInterimData'>
Generate interim data for a clinical trial from a data set.
</h2><span id='topic+generateInterimData'></span>

<h3>Description</h3>

<p>Generate interim data at a given time from a dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generateInterimData(clinicalTrialDF, interimTime, administrativeCensoringTime)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generateInterimData_+3A_clinicaltrialdf">clinicalTrialDF</code></td>
<td>

<p>The data frame from which to generate the interim data. It is assumed
that the variables <code>entryTime</code>, <code>responseIndicator</code>,
<code>treatmentIndicator</code> and <code>timeToEvent</code> are present
</p>
</td></tr>
<tr><td><code id="generateInterimData_+3A_interimtime">interimTime</code></td>
<td>

<p>the interim time for which the data is to generated
</p>
</td></tr>
<tr><td><code id="generateInterimData_+3A_administrativecensoringtime">administrativeCensoringTime</code></td>
<td>

<p>The administrative censoring time when the study concludes
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As it stands this function also is geared towards the simulation
scenario. Needs to be cleaned up a bit.
</p>


<h3>Value</h3>

<p>Returns a subset of the input data frame with the following additional
variables.
</p>
<table>
<tr><td><code>delta</code></td>
<td>
<p>the event indicator</p>
</td></tr>
<tr><td><code>eventTime</code></td>
<td>
<p>calendar event time</p>
</td></tr>
</table>
<p>Furthermore, the <code>timeToEvent</code> variable is appropriately
calculated
</p>


<h3>Author(s)</h3>

<p>Mei-Chiung Shih, Balasubramanian Narasimhan, Pei He
</p>


<h3>References</h3>

<p>Lai, Tze Leung and Lavori, Philip W. and Shih, Mei-Chiung. Sequential
Design of Phase II-III Cancer Trials, Statistics in Medicine, Volume 31, issue 18, p.1944-1960, 2012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  trialParameters &lt;- list(minimumNumberOfEvents = 20,
                              minimumIncreaseInV = 0.2,
                              numberRecruitedEachYear = c(80, 120, 160, 160),
                              followupTime = 3,
                              adminCensoringTime = 7,
                              interimLookTime = c(1, 2, 3, 5, 7),
                              type1ErrorForResponse = 0.05,
                              type2ErrorForResponse = 0.01,
                              glrBoundarySidedness = "one", # one sided or two-sided
                              type1Error = 0.05,
                              type2Error = 0.10,
                              epsType1 = 1/3,
                              epsType2 = 1/3)

  trueParameters &lt;- list(p0 = 0.3,
                             p1 = 0.3,
                             pdiffHyp=0.3,
                             theta = list(
                                     alpha = 0,
                                     beta = 0,
                                     gamma = 0),
                             baselineLambda = 0.35,
                             etaHyp = 0.25)
  rngSeed &lt;- 9872831

  d &lt;- generateClinicalTrialData(nRec = trialParameters$numberRecruitedEachYear,
                                     nFUp = trialParameters$followupTime,
                                     pi0 = trueParameters$p0,
                                     pi1 = trueParameters$p1,
                                     theta = trueParameters$theta,
                                     lambda0 = trueParameters$baselineLambda)
  dInterim &lt;- generateInterimData(d, trialParameters$interimLookTime[2],
                                     trialParameters$adminCensoringTime)

</code></pre>

<hr>
<h2 id='generateSP23Design'>
Generate a seamless Phase II-III design object given some the true
parameters and clinical trial parameters
</h2><span id='topic+generateSP23Design'></span>

<h3>Description</h3>

<p>Generate a seamless Phase II-III design object given some the true
parameters and clinical trial parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generateSP23Design(trueParameters, trialParameters)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generateSP23Design_+3A_trueparameters">trueParameters</code></td>
<td>
<p> A list constisting of several components
including
<code>p0</code>, the true probability of response under control,
<code>p1</code>, the true probability of response under treatment,
<code>theta</code>, a list of three items <code class="reqn">(\alpha,\beta,\gamma)</code>,
<code>baselineLambda</code>, the base line hazard rate (constant for now),
<code>etaHyp</code>, the hypothesized non-null hazard <code class="reqn">d</code>.
</p>
</td></tr>
<tr><td><code id="generateSP23Design_+3A_trialparameters">trialParameters</code></td>
<td>
<p> A list constisting of several components
including
<code>numberRecruitedEachYear</code>, a vector of recruitment numbers for
each year,
<code>interimLookTime</code>,  the calendar interim look times,
<code>followupTime</code>, the follow-up time,
<code>adminCensoringTime</code>, the administrative censoring time,
<code>glrBoundarySidedness</code>, either one or two-sided generalized
likelihood ratio boundaries, default one-sided,
<code>typeIError</code>, the type I error desired,
<code>type2Error</code>, the type II error desired, used only for computing
futility boundaries (only nominally used; need to clarify),
<code>epsTypeI</code>, the fraction to spend in interim looks for the
modified Haybittle-Peto boundaries,
<code>epsTypeII</code>, the fraction to spend in interim looks for the
modified Haybittle-Peto boundaries.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates a design object that is used throughout the simulation or an
actual analysis.
</p>


<h3>Value</h3>

<p>An informal <code>sp23Design</code> object, a list of four items
</p>
<table>
<tr><td><code>trueParameters</code></td>
<td>
<p>exactly the input above</p>
</td></tr>
<tr><td><code>trialParameters</code></td>
<td>
<p>exactly the input above</p>
</td></tr>
<tr><td><code>glrBoundary</code></td>
<td>
<p>a matrix of dimension number of interim looks by 4,
containing the boundaries for futility and efficacy for both
response and survival</p>
</td></tr>
<tr><td><code>interimLookHistoryDF</code></td>
<td>
<p>A data frame as described in
<code><a href="#topic+exploreSP23Design">exploreSP23Design</a></code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mei-Chiung Shih, Balasubramanian Narasimhan, Pei He
</p>


<h3>References</h3>

<p>Lai, Tze Leung and Lavori, Philip W. and Shih, Mei-Chiung. Sequential
Design of Phase II-III Cancer Trials, Statistics in Medicine, Volume 31, issue 18, p.1944-1960, 2012.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+exploreSP23Design">exploreSP23Design</a></code> and examples in the <code>examples</code>
subdirectory of this package
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## trial parameters in paper
trialParameters &lt;- list(minimumNumberOfEvents = 20,
                        minimumIncreaseInV = 0.2,
                        numberRecruitedEachYear = c(80, 120, 160, 160),
                        followupTime = 3,
                        adminCensoringTime = 7,
                        interimLookTime = c(1, 2, 3, 5, 7),
                        type1ErrorForResponse = 0.05,
                        type2ErrorForResponse = 0.01,
                        glrBoundarySidedness = "one", # one sided or two-sided
                        type1Error = 0.05,
                        type2Error = 0.10,
                        epsType1 = 1/3,
                        epsType2 = 1/3)

## Case C of table 1 in paper
caseC.TrueParameters &lt;- list(p0 = 0.3,
                             p1 = 0.6,
                             pdiffHyp=0.3,
                             theta = list(
                               alpha = 0,
                               beta = 0,
                               gamma = 0),
                             baselineLambda = 0.35,
                             etaHyp = 0.25)


## Do case C as example
sp23Design &lt;- generateSP23Design(caseC.TrueParameters, trialParameters)
</code></pre>

<hr>
<h2 id='hessian'>
A utility function to compute the hessian of the generalized (conditional)
partial likelihood ratio statistic
</h2><span id='topic+hessian'></span>

<h3>Description</h3>

<p>A utility function to compute the hessian of the generalized (conditional)
partial likelihood ratio statistic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hessian(theta, pi, interimData)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hessian_+3A_theta">theta</code></td>
<td>

<p>The three-element vector <code class="reqn">(\alpha, \beta, \gamma)</code>
</p>
</td></tr>
<tr><td><code id="hessian_+3A_pi">pi</code></td>
<td>

<p>The two-element vector <code class="reqn">(\pi_0, \pi_1)</code>
</p>
</td></tr>
<tr><td><code id="hessian_+3A_interimdata">interimData</code></td>
<td>

<p>The interim data frame
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes the hessian
</p>


<h3>Value</h3>

<p>A 3<code class="reqn">\times</code>3 matrix of the hessian
</p>


<h3>Author(s)</h3>

<p>Mei-Chiung Shih, Balasubramanian Narasimhan, Pei He
</p>


<h3>References</h3>

<p>Lai, Tze Leung and Lavori, Philip W. and Shih, Mei-Chiung. Sequential
Design of Phase II-III Cancer Trials, Statistics in Medicine, Volume 31, issue 18, p.1944-1960, 2012.
</p>

<hr>
<h2 id='loglik1'>
Compute the response log-likelihood
</h2><span id='topic+loglik1'></span>

<h3>Description</h3>

<p>Compute the response log-likelihood
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglik1(piVec, respSummary)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglik1_+3A_pivec">piVec</code></td>
<td>

<p>The two-element vector of <code class="reqn">(\pi_0, \pi_1)</code>
</p>
</td></tr>
<tr><td><code id="loglik1_+3A_respsummary">respSummary</code></td>
<td>

<p>A vector consisting of the summary of data described in
<code><a href="#topic+computeResponseSummary">computeResponseSummary</a></code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes the log-likelihood
</p>


<h3>Value</h3>

<p> the log-likelihood
</p>


<h3>Author(s)</h3>

<p>Mei-Chiung Shih, Balasubramanian Narasimhan, Pei He
</p>


<h3>References</h3>

<p>Lai, Tze Leung and Lavori, Philip W. and Shih, Mei-Chiung. Sequential
Design of Phase II-III Cancer Trials, Statistics in Medicine, Volume 31, issue 18, p.1944-1960, 2012.
</p>

<hr>
<h2 id='loglik1GivenDelta'>
Computes the constrained response log-likelihood (on the alternative)
</h2><span id='topic+loglik1GivenDelta'></span>

<h3>Description</h3>

<p>Computes the constrained response log-likelihood (on the alternative)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglik1GivenDelta(p, respSummary, delta = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglik1GivenDelta_+3A_p">p</code></td>
<td>

<p>The probability <code class="reqn">\pi_0</code>
</p>
</td></tr>
<tr><td><code id="loglik1GivenDelta_+3A_respsummary">respSummary</code></td>
<td>

<p>A vector consisting of the summary of data described in
<code><a href="#topic+computeResponseSummary">computeResponseSummary</a></code>
</p>
</td></tr>
<tr><td><code id="loglik1GivenDelta_+3A_delta">delta</code></td>
<td>

<p>The scalar value of the difference <code class="reqn">\pi_1-\pi_0</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes the constrained response log-likelihood (on the alternative)
</p>


<h3>Value</h3>

<p>the (constrained) response log likelihood
</p>


<h3>Author(s)</h3>

<p>Mei-Chiung Shih, Balasubramanian Narasimhan, Pei He
</p>


<h3>References</h3>

<p>Lai, Tze Leung and Lavori, Philip W. and Shih, Mei-Chiung. Sequential
Design of Phase II-III Cancer Trials, Statistics in Medicine, Volume 31, issue 18, p.1944-1960, 2012.
</p>

<hr>
<h2 id='loglik2'>
Computes the survival log-likelihood
</h2><span id='topic+loglik2'></span>

<h3>Description</h3>

<p>Computes the survival log-likelihood
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglik2(theta, interimData)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglik2_+3A_theta">theta</code></td>
<td>

<p>the three-element vector of <code class="reqn">(\alpha, \beta, \gamma)</code>
</p>
</td></tr>
<tr><td><code id="loglik2_+3A_interimdata">interimData</code></td>
<td>

<p>The interim data
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes the survival log-likelihood
</p>


<h3>Value</h3>

<p>the survival log-likelihood
</p>


<h3>Author(s)</h3>

<p>Mei-Chiung Shih, Balasubramanian Narasimhan, Pei He
</p>


<h3>References</h3>

<p>Lai, Tze Leung and Lavori, Philip W. and Shih, Mei-Chiung. Sequential
Design of Phase II-III Cancer Trials, Statistics in Medicine, Volume 31, issue 18, p.1944-1960, 2012.
</p>

<hr>
<h2 id='loglik2.repar0'>
Computes the constrained survival log-likelihood
</h2><span id='topic+loglik2.repar0'></span>

<h3>Description</h3>

<p>Computes the constrained survival log-likelihood
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglik2.repar0(xi, interimData, pi0, pi1, eta.hyp = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglik2.repar0_+3A_xi">xi</code></td>
<td>

<p>the three-element vector of <code class="reqn">(a=e^\alpha, b=e^\beta,
      c=e^\gamma)</code>
</p>
</td></tr>
<tr><td><code id="loglik2.repar0_+3A_interimdata">interimData</code></td>
<td>

<p>the interim data
</p>
</td></tr>
<tr><td><code id="loglik2.repar0_+3A_pi0">pi0</code></td>
<td>

<p>the value <code class="reqn">\pi_0</code>
</p>
</td></tr>
<tr><td><code id="loglik2.repar0_+3A_pi1">pi1</code></td>
<td>

<p>the value <code class="reqn">\pi_1</code>
</p>
</td></tr>
<tr><td><code id="loglik2.repar0_+3A_eta.hyp">eta.hyp</code></td>
<td>

<p>The hypothesised difference <code class="reqn">d</code> in the alternative hypothesis
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This uses the reparametrization above in terms of <code class="reqn">(a,b,c)</code> rather
than <code class="reqn">(\alpha, \beta, \gamma )</code>
</p>


<h3>Value</h3>

<p>The constrained survival log-likelihood
</p>


<h3>Author(s)</h3>

<p>Mei-Chiung Shih, Balasubramanian Narasimhan, Pei He
</p>


<h3>References</h3>

<p>Lai, Tze Leung and Lavori, Philip W. and Shih, Mei-Chiung. Sequential
Design of Phase II-III Cancer Trials, Statistics in Medicine, Volume 31, issue 18, p.1944-1960, 2012.
</p>

<hr>
<h2 id='mHP.b'>
Compute the modified Haybittle-Peto boundary
</h2><span id='topic+mHP.b'></span>

<h3>Description</h3>

<p>Compute the modified Haybittle-Peto boundary
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mHP.b(mu = c(0, 0), v = c(1, 2), alpha = 0.05, eps = 1/2, side = c("one", "two"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mHP.b_+3A_mu">mu</code></td>
<td>

<p>The mean vector
</p>
</td></tr>
<tr><td><code id="mHP.b_+3A_v">v</code></td>
<td>

<p>The variance vector, usually proportional to information in calendar time
</p>
</td></tr>
<tr><td><code id="mHP.b_+3A_alpha">alpha</code></td>
<td>

<p>The significance desired
</p>
</td></tr>
<tr><td><code id="mHP.b_+3A_eps">eps</code></td>
<td>

<p>The fraction of alpha to use
</p>
</td></tr>
<tr><td><code id="mHP.b_+3A_side">side</code></td>
<td>

<p>one-sided or two-sided (<code>one</code> or <code>two</code>)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Compute the modified Haybittle-Peto boundary
</p>


<h3>Value</h3>

<p>the modified Haybittle-Peto boundary
</p>


<h3>Author(s)</h3>

<p>Mei-Chiung Shih, Balasubramanian Narasimhan, Pei He
</p>


<h3>References</h3>

<p>Lai, Tze Leung and Lavori, Philip W. and Shih, Mei-Chiung. Sequential
Design of Phase II-III Cancer Trials, Statistics in Medicine, Volume 31, issue 18, p.1944-1960, 2012.
</p>

<hr>
<h2 id='mHP.c'>
Compute the modified Haybittle-Peto boundary for the final look
</h2><span id='topic+mHP.c'></span>

<h3>Description</h3>

<p>Compute the modified Haybittle-Peto boundary for the final look
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mHP.c(mu = c(0, 0, 0), v = c(1, 2, 3), b = 3, alpha = 0.05,
      eps = 1/2, side = c("one", "two"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mHP.c_+3A_mu">mu</code></td>
<td>

<p>the mean vector
</p>
</td></tr>
<tr><td><code id="mHP.c_+3A_v">v</code></td>
<td>

<p>The variance vector, usually proportional to information in calendar time
</p>
</td></tr>
<tr><td><code id="mHP.c_+3A_b">b</code></td>
<td>

<p>The (constant) modified Haybittle-Peto boundary, typically computed
by <code><a href="#topic+mHP.b">mHP.b</a></code>
</p>
</td></tr>
<tr><td><code id="mHP.c_+3A_alpha">alpha</code></td>
<td>

<p>The significance level desired
</p>
</td></tr>
<tr><td><code id="mHP.c_+3A_eps">eps</code></td>
<td>

<p>The fraction of alpha to use
</p>
</td></tr>
<tr><td><code id="mHP.c_+3A_side">side</code></td>
<td>

<p>one-sided or two-sided (<code>one</code> or <code>two</code>)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Compute the modified Haybittle-Peto boundary for the final look
</p>


<h3>Value</h3>

<p>the modified Haybittle-Peto boundary for the final look
</p>


<h3>Author(s)</h3>

<p>Mei-Chiung Shih, Balasubramanian Narasimhan, Pei He
</p>


<h3>References</h3>

<p>Lai, Tze Leung and Lavori, Philip W. and Shih, Mei-Chiung. Sequential
Design of Phase II-III Cancer Trials, Statistics in Medicine, Volume 31, issue 18, p.1944-1960, 2012.
</p>

<hr>
<h2 id='performInterimLook'>
Perform an interim look in a seamless Phase II-III clinical trial
</h2><span id='topic+performInterimLook'></span>

<h3>Description</h3>

<p>Perform an interim look in a seamless Phase II-III clinical trial
</p>


<h3>Usage</h3>

<pre><code class='language-R'>performInterimLook(k, trueParameters, trialParameters, glrBoundary,
                   interimData, interimLookHistoryDF, argRejectH0R)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="performInterimLook_+3A_k">k</code></td>
<td>

<p>the index of the look
</p>
</td></tr>
<tr><td><code id="performInterimLook_+3A_trueparameters">trueParameters</code></td>
<td>

<p>the true parameters, usually available in an object generated by
<code><a href="#topic+generateSP23Design">generateSP23Design</a></code>
</p>
</td></tr>
<tr><td><code id="performInterimLook_+3A_trialparameters">trialParameters</code></td>
<td>

<p>the trial parameters, usually available in an object generated by
<code><a href="#topic+generateSP23Design">generateSP23Design</a></code>
</p>
</td></tr>
<tr><td><code id="performInterimLook_+3A_glrboundary">glrBoundary</code></td>
<td>

<p>the generalized likelihood ratio boundaries,  usually available in
an object produced by <code><a href="#topic+generateSP23Design">generateSP23Design</a></code>
</p>
</td></tr>
<tr><td><code id="performInterimLook_+3A_interimdata">interimData</code></td>
<td>

<p>the interim data
</p>
</td></tr>
<tr><td><code id="performInterimLook_+3A_interimlookhistorydf">interimLookHistoryDF</code></td>
<td>

<p>the interim look history data frame matrix described in
<code><a href="#topic+exploreSP23Design">exploreSP23Design</a></code>
</p>
</td></tr>
<tr><td><code id="performInterimLook_+3A_argrejecth0r">argRejectH0R</code></td>
<td>

<p>A flag that indicates whether <code class="reqn">H_0^R</code> has been rejected in the
previous look; A value of <code>FALSE</code> is used for first look.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Perform an interim look in a seamless Phase II-III clinical trial
</p>


<h3>Value</h3>

<p> a vector of named values described in
<code><a href="#topic+exploreSP23Design">exploreSP23Design</a></code>, essentially providing a new row to
the interim look history data frame
</p>


<h3>Author(s)</h3>

<p>Mei-Chiung Shih, Balasubramanian Narasimhan, Pei He
</p>


<h3>References</h3>

<p>Lai, Tze Leung and Lavori, Philip W. and Shih, Mei-Chiung. Sequential
Design of Phase II-III Cancer Trials, Statistics in Medicine, Volume 31, issue 18, p.1944-1960, 2012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  trialParameters &lt;- list(minimumNumberOfEvents = 20,
                              minimumIncreaseInV = 0.2,
                              numberRecruitedEachYear = c(80, 120, 160, 160),
                              followupTime = 3,
                              adminCensoringTime = 7,
                              interimLookTime = c(1, 2, 3, 5, 7),
                              type1ErrorForResponse = 0.05,
                              type2ErrorForResponse = 0.01,
                              glrBoundarySidedness = "one", # one sided or two-sided
                              type1Error = 0.05,
                              type2Error = 0.10,
                              epsType1 = 1/3,
                              epsType2 = 1/3)

  trueParameters &lt;- list(p0 = 0.3,
                             p1 = 0.3,
                             pdiffHyp=0.3,
                             theta = list(
                                     alpha = 0,
                                     beta = 0,
                                     gamma = 0),
                             baselineLambda = 0.35,
                             etaHyp = 0.25)
  rngSeed &lt;- 9872831

  sp23Design &lt;- generateSP23Design(trueParameters, trialParameters)
  d &lt;- generateClinicalTrialData(nRec = trialParameters$numberRecruitedEachYear,
                                     nFUp = trialParameters$followupTime,
                                     pi0 = trueParameters$p0,
                                     pi1 = trueParameters$p1,
                                     theta = trueParameters$theta,
                                     lambda0 = trueParameters$baselineLambda)
  dInterim &lt;- generateInterimData(d, trialParameters$interimLookTime[1],
                                      trialParameters$adminCensoringTime)
  dInterim &lt;- dInterim[order(dInterim$timeToEvent), ]
  ## This is a tricky function to use for all but the first interim look;
  ## see executeSP23Design code for details! Reason: interim look k depends
  ## on results of interim look k-1
  ##
  performInterimLook(1, sp23Design$trueParameters, trialParameters, sp23Design$glrBoundary,
                     dInterim, sp23Design$interimLookHistoryDF,
                     argRejectH0R = FALSE)

</code></pre>

<hr>
<h2 id='resetSP23Design'>
Reset the design object so that counts and results are zeroed out
</h2><span id='topic+resetSP23Design'></span>

<h3>Description</h3>

<p>Reset the design object so that counts and results are zeroed out
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resetSP23Design(sp23Design)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resetSP23Design_+3A_sp23design">sp23Design</code></td>
<td>

<p>An object usually the result of <code><a href="#topic+generateSP23Design">generateSP23Design</a></code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Reset the design object so that counts and results are zeroed out
</p>


<h3>Value</h3>

<p>A new <code>sp23Design</code> object with counts and results zeroed out
</p>


<h3>Author(s)</h3>

<p>Mei-Chiung Shih, Balasubramanian Narasimhan, Pei He
</p>


<h3>References</h3>

<p>Lai, Tze Leung and Lavori, Philip W. and Shih, Mei-Chiung. Sequential
Design of Phase II-III Cancer Trials, Statistics in Medicine, Volume 31, issue 18, p.1944-1960, 2012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  trialParameters &lt;- list(minimumNumberOfEvents = 20,
                      minimumIncreaseInV = 0.2,
                      numberRecruitedEachYear = c(80, 120, 160, 160),
                      followupTime = 3,
                      adminCensoringTime = 7,
                      interimLookTime = c(1, 2, 3, 5, 7),
                      type1ErrorForResponse = 0.05,
                      type2ErrorForResponse = 0.01,
                      glrBoundarySidedness = "one", # one sided or two-sided
                      type1Error = 0.05,
                      type2Error = 0.10,
                      epsType1 = 1/3,
                      epsType2 = 1/3)

  ## Case C of table 1 in paper
  caseC.TrueParameters &lt;- list(p0 = 0.3,
                               p1 = 0.6,
                               pdiffHyp=0.3,
                               theta = list(
                                   alpha = 0,
                                   beta = 0,
                                   gamma = 0),
                               baselineLambda = 0.35,
                               etaHyp = 0.25)


  ## Do case C as example
  sp23Design &lt;- generateSP23Design(caseC.TrueParameters, trialParameters)
  ## do something ...
  sp23Design &lt;- resetSP23Design(sp23Design)

## End(Not run)
</code></pre>

<hr>
<h2 id='solveForCGivenABD'>
A convenience function to reduce dimension by solving for one variable
<code class="reqn">c</code> in terms of others <code class="reqn">a</code>, <code class="reqn">b</code>, <code class="reqn">d</code>
</h2><span id='topic+solveForCGivenABD'></span>

<h3>Description</h3>

<p>A convenience function to reduce dimension by solving for one variable
<code class="reqn">c</code> in terms of others <code class="reqn">a</code>, <code class="reqn">b</code>, <code class="reqn">d</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>solveForCGivenABD(piVec, a, b, d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="solveForCGivenABD_+3A_pivec">piVec</code></td>
<td>

<p>The two-element vector of <code class="reqn">(\pi_0, \pi_1)</code>
</p>
</td></tr>
<tr><td><code id="solveForCGivenABD_+3A_a">a</code></td>
<td>

<p>The value for <code class="reqn">a</code>
</p>
</td></tr>
<tr><td><code id="solveForCGivenABD_+3A_b">b</code></td>
<td>

<p>The value for <code class="reqn">b</code>
</p>
</td></tr>
<tr><td><code id="solveForCGivenABD_+3A_d">d</code></td>
<td>

<p>The value for <code class="reqn">d</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Just solves the equation in closed form
</p>


<h3>Value</h3>

<p>the value for <code class="reqn">c</code>
</p>


<h3>Author(s)</h3>

<p>Mei-Chiung Shih, Balasubramanian Narasimhan, Pei He
</p>


<h3>References</h3>

<p>Lai, Tze Leung and Lavori, Philip W. and Shih, Mei-Chiung. Sequential
Design of Phase II-III Cancer Trials, Statistics in Medicine, Volume 31, issue 18, p.1944-1960, 2012.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
