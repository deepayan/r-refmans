<!DOCTYPE html><html><head><title>Help for package flip</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {flip}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#flip-package'><p>flip-package</p></a></li>
<li><a href='#cFlip'><p>cFlip</p></a></li>
<li><a href='#flip'><p>flip</p></a></li>
<li><a href='#flip.adjust'><p>Functions for multiplicity corrections</p></a></li>
<li><a href='#flip.object-class'><p>Class flip.object</p></a></li>
<li><a href='#flipMix'><p>The main function for testing mixed models under a permutation (and</p>
rotation) framework</a></li>
<li><a href='#getFlip'><p>getFlip</p></a></li>
<li><a href='#permutationSpace'><p>These functions handle the orbit of permutation/rotation tests (i.e.</p>
permutation/rotation space).</a></li>
<li><a href='#seeds'><p>Seeds data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Permutation Tests</td>
</tr>
<tr>
<td>Version:</td>
<td>2.5.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-08-25</td>
</tr>
<tr>
<td>Author:</td>
<td>Livio Finos, with contributions by Florian Klinglmueller, Dario Basso,
    Aldo Solari, Lucia Benetazzo, Jelle Goeman and Marco Rinaldo.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Livio Finos &lt;livio.finos@unipd.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>It implements many univariate and multivariate permutation (and
    rotation) tests. Allowed tests: the t one and two samples, ANOVA, linear
    models, Chi Squared test, rank tests (i.e. Wilcoxon, Mann-Whitney,
    Kruskal-Wallis), Sign test and Mc Nemar. Test on Linear Models are
    performed also in presence of covariates (i.e. nuisance parameters).
    The permutation and the rotation methods to get the null distribution of
    the test statistics are available. It also implements methods for
    multiplicity control such as Westfall &amp; Young minP procedure and Closed
    Testing (Marcus, 1976) and k-FWER. Moreover, it allows to test for fixed
    effects in mixed effects models.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td>ttps://CRAN.R-project.org/package=flip</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-08-25 15:52:35 UTC; livio</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, cherry, e1071, plyr, someMTP</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-08-25 22:05:41 UTC</td>
</tr>
</table>
<hr>
<h2 id='flip-package'>flip-package</h2><span id='topic+flip-package'></span><span id='topic+flip.package'></span><span id='topic+flippackage'></span>

<h3>Description</h3>

<p>The library is devoted to permutation-based inferential methods.
</p>
<p>It implements many univariate and multivariate permutation (and rotation)
tests.
</p>
<p>The tests comprised are: the one and two samples, ANOVA, linear models, Chi
Squared test, rank tests (i.e. Wilcoxon, Mann-Whitney, Kruskal-Wallis),
Kolmogorov-Smirnov and Anderson-Darling.
</p>
<p>Test on Linear Models are performed also in presence of covariates (i.e.
nuisance parameters).
</p>
<p>The permutation and the rotation method to get the null distribution of the
test statistic(s) are available.
</p>
<p>It also implements methods for multiplicity control such as Westfall-Young
min-p procedure and Closed Testing (Marcus, 1976).
</p>

<table>
<tr>
 <td style="text-align: left;"> Package: </td><td style="text-align: left;"> flip</td>
</tr>
<tr>
 <td style="text-align: left;"> Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;"> Version: </td><td style="text-align: left;">
1.1</td>
</tr>
<tr>
 <td style="text-align: left;"> Date: </td><td style="text-align: left;"> 2012-02-05</td>
</tr>
<tr>
 <td style="text-align: left;"> License: </td><td style="text-align: left;"> GPL &lt;=2</td>
</tr>
<tr>
 <td style="text-align: left;"> LazyLoad: </td><td style="text-align: left;">
yes</td>
</tr>
<tr>
 <td style="text-align: left;"> Depends: </td><td style="text-align: left;"> methods, e1071, someMTP, cherry</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Livio Finos, with contributions by Florian Klinglmueller, Dario
Basso, Aldo Solari, Lucia Benetazzo, Jelle Goeman and Marco Rinaldo. Special
thanks are due to Ivan Marin-Franch and Fredrik Nilsson for the debugging
and the good questions.
</p>
<p>Maintainer: livio finos &lt;livio@stat.unipd.it&gt;
</p>


<h3>References</h3>

<p>For the general framework of univariate and multivariate
permutation tests see: Pesarin, F. (2001) Multivariate Permutation Tests
with Applications in Biostatistics. Wiley, New York.
</p>
<p>#' @references For the general framework of univariate and multivariate
permutation tests see: Pesarin, F. (2001) Multivariate Permutation Tests
with Applications in Biostatistics. Wiley, New York.
</p>
<p>Livio Finos and Fortunato Pesarin (2018) On zero-inflated permutation testing and some related problems. Statistical Papers.
</p>
<p>For analysis of mixed-models see: L. Finos and D. Basso (2014) Permutation
Tests for Between-Unit Fixed Effects in Multivariate Generalized Linear
Mixed Models. Statistics and Computing. Vo- lume 24, Issue 6, pp 941-952.
DOI: 10.1007/s11222-013-9412-6 J. J. Goeman and
</p>
<p>D. Basso, L. Finos (2011) Exact Multivariate Permutation Tests for Fixed
Effec- ts in Mixed-Models. Communications in Statistics - Theory and
Methods. DOI 10.1080/03610926.2011.627103
</p>
<p>For Rotation tests see: Langsrud, O. (2005) Rotation tests, Statistics and
Computing, 15, 1, 53-60
</p>
<p>A. Solari, L. Finos, J.J. Goeman (2014) Rotation-based multiple testing in
the multivariate linear model. Biometrics, 70 (4), 954-961.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Y=data.frame(matrix(rnorm(50),10,5))
names(Y)=LETTERS[1:5]
Y[,1:2]=Y[,1:2]
x=rep(0:1,5)
data=data.frame(x=x, Z=rnorm(10))
res = flip(Y+matrix(x*2,10,5),~x,~Z,data=data)
res

plot(res)

p2=npc(res,"fisher",subsets=list(c1=c("A","B"),c2=names(Y)))
p2

</code></pre>

<hr>
<h2 id='cFlip'>cFlip</h2><span id='topic+cFlip'></span>

<h3>Description</h3>

<p>It concatenates flip objects
warning(&quot;More than one test statistic is imputed, only the first perms space will be stored.&quot;)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cFlip(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cFlip_+3A_...">...</code></td>
<td>
<p>arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>flip.object</code>
</p>

<hr>
<h2 id='flip'>flip</h2><span id='topic+flip'></span><span id='topic+flip.statTest'></span><span id='topic+orthoZ'></span>

<h3>Description</h3>

<p>The main function for univariate and multivariate testing under a
permutation (and rotation) framework + some utilities.
</p>
<p><code>flip</code> is the main function for permutation (or rotation) test.
</p>
<p>It allows for multivariate one sample, C&gt;=2 samples and any regression
tests. Also the use of covariates (to be fitted in the model but) not under
test is allowed.
</p>
<p><code>statTest="t"</code> is the t statistic derived from the correlation among
each Xs and each Ys (i.e. a linear model for each couples of Xs and Ys).
This is different from the fit of a multiple (multivariate) linear models,
since the correlation does not consider the other covariates).  The test
<code>t</code> is valid only under the assumption that each variable in X is
independent of each variable in Y. To get adequate test while adjusting for
covariates, use <code>Z</code> (see example below) The test statistic <code>"sum"</code>
is the sum of values (or frequencies) of the given sample centered on the
expected (i.e. computed on the overall sample). <code>"coeff"</code> is the
statistic based on the estimated coefficient of an <code>lm</code>. It produces a
test for every possible combination of (columns of) <code>X</code> and <code>Y</code>
(p-values can be combined using <code>npc</code>). <code>"cor"</code> is the correlation
(i.e. not partial correlation) between each column of <code>X</code> and each of
<code>Y</code>. <code>"cor.Spearman"</code> (or <code>"cor.rank"</code>) is the analogous for
Spearman's rank correlation coefficient.
</p>
<p><code>"ANOVA"</code> is synonyms of <code>"F"</code>. Only valid for dependence tests
(i.e. non constant <code>X</code>).  <code>"Mann-Whitney"</code> is synonyms of
<code>"Wilcoxon"</code>.  <code>"rank"</code> choose among <code>"Wilcoxon"</code> and
<code>"Kruskal-Wallis"</code> depending if the samples are two or more
(respectively).
</p>
<p>The <code>"Wilcoxon"</code> statistic is based on the 'sum of ranks of second
sample minus n1*(n+1)/2' instead of 'sum of ranks of smallest sample minus
nSmallest*(n+1)/2'. Therefore the statistic is centered on 0 and allow for
two sided alternatives. Despite the p-value are ok, it requires the <code>X</code>
to be a two-levels factor in order to compute the right test statistic. When
the <code>X</code> is not a two-levels factor, it measures the codeviance among
<code>X</code> and ranks of <code>Y</code>.
</p>
<p>For paired samples (see also the argument <code>Strata</code> and the example
below) the Signed Rank test is performed. To perform the Sign Test use
option <code>Sign</code> (i.e. same as Signed Rank but without using magnitude of
ranks).
</p>
<p>The <code>"Fisher"</code> test is allowed only with dichotomous <code>Y</code>s. The
reported statistic is the bottom-right cell of the 2 by 2 frequencies table.
The <code>"chisq.separated"</code> test perform cell-wise chi squared (see also
Finos and Salmaso (2004) Communications in Statistics - Theory and methods).
</p>
<p>The <code>"McNemar"</code> test is based on the signs of the differences, hence it
can be used also with ordinal or continuous responses. Only valid for
symmetry tests (i.e. <code>X</code> is constant or <code>NULL</code>).  The reported
statistic for <code>"McNemar"</code> test is the signed squared root of the
McNemar statistic. Hence it allows for tailed alternatives.
</p>
<p>For ordered <code>X</code>, a stochastic ordering test can be performed using
<code>"t","Wilcoxon","sum"</code> and then combining the separated test using
<code>npc</code>.
</p>
<p>When <code>statTest</code> is a <code>function</code>, the first argument must be
<code>Y</code>. This same function is ran to observed data <code>Y</code> and to a
number of permuted rows of <code>Y</code>. The returned value must be a vector of
test statistics. Please note that argument <code>tail</code> must be defined
accordingly. The default way the rows of <code>Y</code> are rearranged is through
permutation (without strata). More complex permutation strategies can be
defined through proper definition of argument <code>perm</code> (see also
<code><a href="#topic+permutationSpace">permutationSpace</a></code>).
</p>
<p>For <code>testType="rotation"</code>: As long as the number of orthogonalized
residuals (i.e. the number of observations minus the number of columns in
<code>Z</code>) is lower than 50, the function <code>rom</code> is used. The the number
is larger, the faster version <code>romFast</code> is used instead. Although the
latter is less accurate, for such a big sample size, it is not expected to
affect the control of the type I error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flip(Y, X = NULL, Z = NULL, data = NULL, tail = 0, perms = 1000,
  statTest = NULL, Strata = NULL, flipReturn, testType = NULL,
  returnGamma = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flip_+3A_y">Y</code></td>
<td>
<p>The response vector of the regression model. May be supplied as a
vector or as a <code><a href="stats.html#topic+formula">formula</a></code> object. In the latter
case, the right hand side of <code>Y</code> is passed on to <code>alternative</code> if
that argument is missing, or otherwise to <code>null</code>.</p>
</td></tr>
<tr><td><code id="flip_+3A_x">X</code></td>
<td>
<p>The part of the design matrix corresponding to the alternative
hypothesis. The covariates of the null model do not have to be supplied
again here. May be given as a half <code><a href="stats.html#topic+formula">formula</a></code>
object (e.g. <code>~a+b</code>). In that case the intercept is always suppressed.</p>
</td></tr>
<tr><td><code id="flip_+3A_z">Z</code></td>
<td>
<p>The part of the design matrix corresponding to the null hypothesis.
May be given as a design matrix or as a half
<code><a href="stats.html#topic+formula">formula</a></code> object (e.g. <code>~a+b</code>). The default
for <code>Z</code> is <code>~1</code>, i.e. only an intercept. This intercept may be
suppressed, if desired, with <code>Z = ~0</code>.</p>
</td></tr>
<tr><td><code id="flip_+3A_data">data</code></td>
<td>
<p>Only used when <code>Y</code>, <code>X</code>, or <code>Z</code> is given in
formula form. An optional data frame, list or environment containing the
variables used in the formula. If the variables in a formula are not found
in <code>data</code>, the variables are taken from environment(formula), typically
the environment from which <code>gt</code> is called.</p>
</td></tr>
<tr><td><code id="flip_+3A_tail">tail</code></td>
<td>
<p>Vector of values -1, 0 or 1 indicating the tail to be used in
the test for each column of <code>Y</code>. <code>tail=1</code> (-1) means that greater
(smaller) values bring more evidence to the alternative hypothesis.
<code>tail=0</code> indicates a two sided alternative. If the length of
<code>tail</code> is smaller than number of columns of <code>Y</code>, the values are
recycled.</p>
</td></tr>
<tr><td><code id="flip_+3A_perms">perms</code></td>
<td>
<p>The number of permutations to use. The default is <code>perms =
1000</code>. Alternatively it can be a matrix (i.e. the permutation space) or a
list with elements <code>number</code> and <code>seed</code>.</p>
</td></tr>
<tr><td><code id="flip_+3A_stattest">statTest</code></td>
<td>
<p>Choose a test statistic from <code>flip.statTest</code>. See also
Details section.</p>
</td></tr>
<tr><td><code id="flip_+3A_strata">Strata</code></td>
<td>
<p>A vector, which unique values identifies strata. This option
is used only with <code>testType="permutation"</code>; parameter <code>Z</code> is not
considered in this case.  Also note that when only two levels with one
observation per each level are present in each stratum, the problem becomes
a paired two-samples problem and hence simplified to a one-sample test.</p>
</td></tr>
<tr><td><code id="flip_+3A_flipreturn">flipReturn</code></td>
<td>
<p>list of objects indicating what will be included in the
output.
</p>
<p>e.g. <code>list(permP=TRUE,permT=TRUE,data=TRUE)</code>.</p>
</td></tr>
<tr><td><code id="flip_+3A_testtype">testType</code></td>
<td>
<p>by default <code>testType="permutation"</code>. The use of option
<code>"combination"</code> is more efficient when <code>X</code> is indicator of groups
(i.e. C&gt;1 samples testing). When the total number of possible combinations
exceeds 10 thousand, <code>"permutation"</code> is performed. As an alternative,
if you choose <code>"rotation"</code>, resampling is performed through random
linear combinations (i.e. a rotation test is performed). This option is
useful when only few permutations are available, that is, minimum reachable
significance is hight. See also the <code>details</code> section for the algorithm
used. The old syntax <code>rotationTest=TRUE</code> is maintained for
compatibility but is deprecated, use <code>testType="rotation"</code> instead.</p>
</td></tr>
<tr><td><code id="flip_+3A_returngamma">returnGamma</code></td>
<td>
<p>logical. Should be the eigenvectors (with corresponding
non-null eigenvalues) of the anti-projection matrix of <code>Z</code> (i.e. I-
Z(Z'Z)^-1 Z') returned?</p>
</td></tr>
<tr><td><code id="flip_+3A_...">...</code></td>
<td>
<p>Further parameters. The followings are still valid but
deprecated:
</p>
<p><code>permT.return = TRUE, permP.return = FALSE</code>,
</p>
<p><code>permSpace.return = FALSE, permY.return = FALSE</code>. Use <code>flipReturn</code>
instead.
</p>
<p><code>dummyfy</code> a named list of logical values (eg.
<code>list(X=TRUE,Y=TRUE)</code>)
</p>
<p><code>rotationTest= TRUE</code>. Deprecated, use <code>testType='rotation'</code>
instead.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>flip.object</code>.  Several operations and plots
can be made from this object. See also <code><a href="#topic+flip.object-class">flip.object-class</a></code>.
</p>


<h3>Author(s)</h3>

<p>livio finos, Florian Klinglmueller
</p>


<h3>References</h3>

<p>For the general framework of univariate and multivariate
permutation tests see: Pesarin, F. (2001) Multivariate Permutation Tests
with Applications in Biostatistics. Wiley, New York.
</p>
<p>For Rotation tests see: Langsrud, O. (2005) Rotation tests, Statistics and
Computing, 15, 1, 53-60
</p>
<p>A. Solari, L. Finos, J.J. Goeman (2014) Rotation-based multiple testing in
the multivariate linear model. Biometrics, 70 (4), 954-961.
</p>
<p>Livio Finos and Fortunato Pesarin (2018) On zero-inflated permutation testing and some related problems. Statistical Papers.
</p>


<h3>See Also</h3>

<p>The permutation spaces on which the test is based:
<code><a href="#topic+permutationSpace">permutationSpace</a></code> function and useful functions associated with
that object.
</p>
<p>Multiplicity correction: <code><a href="#topic+flip.adjust">flip.adjust</a></code> and Global test:
<code><a href="#topic+npc">npc</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Y=matrix(rnorm(50),10,5)
colnames(Y)=LETTERS[1:5]
Y[,1:2]=Y[,1:2] +1
res = flip(Y)
res
plot(res[[1]])
plot(res[2:3])
plot(res)

X=rep(0:1,5)
Y=Y+matrix(X*2,10,5)

data=data.frame(Y,X=X, Z=rnorm(10))
#testing dependence among Y's and X
(res = flip(Y,~X,data=data))
#same as:
#res = flip(A+B+C+D+E~X,data=data)


#testing dependence among Y's and X, also using covariates
res = flip(Y,~X,~Z,data=data)
res
#Note that
#flip(Y,X=~X,Z=~1,data=data)
#is different from
#flip(Y,~X,data=data)
#since the former is based on orthogonalized residuals of Y and X by Z.

## Not run: 
#Rotation tests:
rot=flip(Y,X,Z=~1,testType="rotation")
# note the use Z=~1.

## End(Not run)

#Using rank tests:
res = flip(Y,~X,data=data,statTest="Wilcoxon")
res

#testing symmetry of Y around 0
Y[,1:2]=Y[,1:2] +2
res = flip(Y)
res
plot(res)


#use of strata (in this case equal to paired samples)
data$S=rep(1:5,rep(2,5))
#paired t
flip(A+B+C+D+E~X,data=data,statTest="t",Strata=~S)
#signed Rank test
flip(A+B+C+D+E~X,data=data,statTest="Wilcox",Strata=~S)

# tests for categorical data
data=data.frame(X=rep(0:2,10))
data=data.frame(X=factor(data$X),Y=factor(rbinom(30,2,.2+.2*data$X)))
flip(~Y,~X,data=data,statTest="chisq")
# separated chisq (Finos and Salmaso, 2004. Nonparametric multi-focus analysis
# for categorical variables. CommStat - T.M.)
(res.sep=flip(~Y,~X,data=data,statTest="chisq.separated"))
npc(res.sep,"sumT2") #note that combined test statistic is the same as chisq

## Not run: 
# User-defined test statistic:
my.fun &lt;- function(Y){
summary(lm(Y~X))$coeff[2,"Estimate"]
}
X &lt;- matrix(rep(0:2,5))
Y &lt;- matrix(rnorm(mean=X,n=15))
res=flip(Y=Y,X=X,statTest=my.fun,tail=0)
res
hist(res)

## End(Not run)
</code></pre>

<hr>
<h2 id='flip.adjust'>Functions for multiplicity corrections</h2><span id='topic+flip.adjust'></span><span id='topic+npc'></span><span id='topic+flip.adjust'></span><span id='topic+flip.npc.methods'></span>

<h3>Description</h3>

<p><code>npc</code> provides overall tests (i.e. weak FWER control), while
<code>flip.adjust</code> provides adjusted p-values (i.e. strong FWER control).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flip.adjust(permTP, method = flip.npc.methods, maxalpha = 1,
  weights = NULL, stdSpace = FALSE, ...)

npc(permTP, comb.funct = c(flip.npc.methods, p.adjust.methods),
  subsets = NULL, weights = NULL, stdSpace = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flip.adjust_+3A_permtp">permTP</code></td>
<td>
<p>A permutation space (B times m matrix) or an
<code>flip.object</code> as produced by <code><a href="#topic+flip">flip</a></code>. Alternatively it can
be a <code><a href="#topic+flip.object-class">flip.object-class</a></code> resulting, for example from a call of
function <code><a href="#topic+flip">flip</a></code>.</p>
</td></tr>
<tr><td><code id="flip.adjust_+3A_method">method</code></td>
<td>
<p>A method among <code><a href="#topic+flip.npc.methods">flip.npc.methods</a></code> or
<code><a href="stats.html#topic+p.adjust.methods">p.adjust.methods</a></code>. By default <code>"maxT"</code> is used.  See also
the section <code>Details</code>.</p>
</td></tr>
<tr><td><code id="flip.adjust_+3A_maxalpha">maxalpha</code></td>
<td>
<p>Adjusted p-values greater than <code>maxalpha</code> are forced to
1. It saves computational time when there are many hypotheses under test.</p>
</td></tr>
<tr><td><code id="flip.adjust_+3A_weights">weights</code></td>
<td>
<p>Optional argument that can be used to give certain variables
greater weight in the combined test.  Can be a vector or a list of vectors.
In the latter case, a separate test will be performed for each weight
vector.  If both <code>subsets</code> and <code>weights</code> are specified as a list,
they must have the same length. In that case, <code>weights</code> vectors may
have either the same length as the number of covariates in
<code>alternative</code>, or the same length as the corresponding subset vector.
Weights can be negative; the sign has no effect unless <code>directional</code> is
<code>TRUE</code>. It works for <code>npc</code> and <code>flip.adjust</code> with
<code>method</code>= &quot;maxT&quot;, &quot;maxTstd&quot; or &quot;minP&quot;</p>
</td></tr>
<tr><td><code id="flip.adjust_+3A_stdspace">stdSpace</code></td>
<td>
<p>Ask if the permutation distribution of the test statistic
should be standardized or not. The default is <code>FALSE</code>. The option is
applied only if <code>comb.funct</code> or <code>method</code> is equal to <code>"maxT"</code>
or <code>"sumT"</code>, it becomes useful when test statistics are of different
nature (e.g. chisquare and t-test).</p>
</td></tr>
<tr><td><code id="flip.adjust_+3A_...">...</code></td>
<td>
<p>further arguments. Among them, <code>tail</code> can be used to set the
tail of the alternative for the <code>permTP</code> (see also <code><a href="#topic+flip">flip</a></code>).
The arguments <code>statTest</code>, <code>fastSumCombination</code> and <code>linComb</code>
are used in objects <code>flipMix</code> and <code>comb.funct=
"data.sum","data.linComb","data.pc"</code> or <code>"data.trace"</code>.</p>
</td></tr>
<tr><td><code id="flip.adjust_+3A_comb.funct">comb.funct</code></td>
<td>
<p>A combining function <code>flip.npc.methods</code> (all but
&quot;kfwer&quot;): &quot;Fisher&quot;, &quot;Liptak&quot;, &quot;MahalanobisT&quot; , &quot;MahalanobisP&quot; (i.e. related
to Hotelling T2), &quot;minP&quot; (i.e. Tippet), &quot;maxT&quot;, &quot;sumT&quot; (i.e. direct) ,
&quot;sumT2&quot; (sum of T^2).  <code>"Fisher"</code> combining function is the default.
See also the section <code>Details</code>.</p>
</td></tr>
<tr><td><code id="flip.adjust_+3A_subsets">subsets</code></td>
<td>
<p>Optional argument that can be used to test one or more
subsets of variables.  Can be a vector of column names or indices of a
<code><a href="#topic+flip.object-class">flip.object-class</a></code> (<code>names(flipObject)</code>), or a list of
such vectors.  In the latter case, a separate test will be performed for
each subset. Only for
<code>comb.funct %in% c("data.sum","data.linComb","data.pc","data.trace")</code> the
names refers to the columns of <code>Y</code> data
<code>colnames(flipObject@data$Y) </code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>npc</code> combines the p-values using the combining functions (and the
method) described in Pesarin (2001). It makes use of the join space of the
permutations. This is usually derived from a call of <code>flip</code> function or
<code>flipMixWithin</code>.
</p>
<p>Very shortly: <code>"Fisher"</code> =-sum log(p-values) <code>"Liptak"</code> =sum
qnorm(p-values)  <code>"MahalanobisT"</code> = Mahalanobis distance of centered
matrix <code>permTP</code> (or <code>permTP@permT </code>) <code>"MahalanobisP"</code> = same
as above, but using scores defined by qnorm(p-values) (tails are forced to
be one-sided)  <code>"minP"</code> = <code>"Tippett"</code> = min(p-values) \
<code>"maxT"</code> = max(test statistics) <code>"maxTstd"</code> = max(standardized
test statistics)  <code>"sumT"</code> = sum (test statistics) <code>"sumTstd"</code>
= sum (standardized test statistics) <code>"sumT2"</code> = <code>sum (test
statistics)^2</code>. The followings have to be used carefully and only with
objects from function <code>flipMix</code>: <code>"data.sum" </code> = sum of all columns of
Y, <code>"data.linComb" </code> = sum of all columns of Y (includes a vector or
matrix <code>linComb</code> among the arguments), <code>"data.pc"</code> = extracts the
first Principal component from the covariance matrix (you may also include a
vector <code>whichPCs</code> indicating which PCs you want to consider)\
<code>"data.trace"</code> = Extends the Pillai Trace, use parametric bootstrap to
asses the significance.<code>"kfwer"</code> = can be only used with
<code>flip.adjust</code> (not in <code>npc</code>). It requires an extra parameter
<code>k</code> (<code>k=11</code> by default).
</p>
<p><code>flip.adjust</code> adjusts the p-value for multiplicity (FamilyWise Error
Rate -FWER- and kFWER).  When <code>method</code> is equal to <code>"maxT"</code>,
<code>"maxTstd"</code> (i.e. max T on <code>scale(permTP)</code>) or &quot;minP&quot; (i.e.
Tippett) it performs the step-down method of Westfall and Young (1993).  For
any other element of <code>flip.npc.methods</code> (i.e. &quot;Fisher&quot;, &quot;Liptak&quot;,
&quot;sumT&quot; (i.e. direct) or &quot;sumT2&quot; (sum of T^2)) a call to <code>npc</code> together
with a closed testing procedure is used (it make use of
<code><a href="cherry.html#topic+closed">cherry:closed</a></code>).  When <code>method</code> is any
among <code>p.adjust.methods</code> the function <code>stats:p.adjust</code> or -if
weights are provided- <code>someMTP:p.adjust.w</code> is used.  To perform control
of the kFWER use <code>flip.adjust</code> with <code>method="kfwer"</code> and extra
parameter <code>k</code>.
</p>


<h3>Value</h3>

<p>The function returns an object of class
<code><a href="#topic+flip.object-class">flip.object-class</a></code> (and the use of
<code>getFlip(obj,"Adjust")</code>.
</p>


<h3>Author(s)</h3>

<p>livio finos, Florian Klinglmueller and Aldo Solari.
</p>


<h3>References</h3>

<p>Pesarin (2001) Multivariate Permutation Tests with Applications
in Biostatistics. Wiley, New York.
</p>
<p>P. H. Westfall and S. S. Young (1993). Resampling-based multiple testing:
Examples and methods for p-value adjustment. John Wiley &amp; Sons.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

Y=data.frame(matrix(rnorm(50),10,5))
names(Y)=LETTERS[1:5]
Y[,1:2]=Y[,1:2]+1.5
res = flip(Y,perms=10000)

########npc
p2=npc(res) # same as p2=npc(res,"Fisher")
summary(p2)
p2=npc(res,"minP")
summary(p2)
p2=npc(res,"Fisher",subsets=list(c1=c("A","B"),c2=names(Y)))
summary(p2)
p2=npc(res,"Fisher",subsets=list(c1=c("A","B"),c2=names(Y)),weights=1:5)
summary(p2)


res=flip.adjust(res, method="maxT")

#res=flip.adjust(res,"BH")
##same as
#p.adjust(res,"BH")

## now try
getFlip(res,"Adjust")

</code></pre>

<hr>
<h2 id='flip.object-class'>Class flip.object</h2><span id='topic+flip.object-class'></span><span id='topic+show+2Cflip.object-method'></span><span id='topic+summary'></span><span id='topic+summary+2Cflip.object-method'></span><span id='topic+summary+2Cflip.object-method'></span><span id='topic+dim+2Cflip.object-method'></span><span id='topic++5B+2Cflip.object+2CANY+2CANY+2CANY-method'></span><span id='topic++5B+2Cflip.object-method'></span><span id='topic++5B+5B'></span><span id='topic++5B+5B+2Cflip.object-method'></span><span id='topic+length'></span><span id='topic+length+2Cflip.object-method'></span><span id='topic+names+2Cflip.object-method'></span><span id='topic+names+3C-+2Cflip.object-method'></span><span id='topic+sort+2Cflip.object-method'></span><span id='topic+hist+2Cflip.object-method'></span><span id='topic+plot+2Cflip.object-method'></span>

<h3>Description</h3>

<p>The class flip.object is the output of a call to <code><a href="#topic+flip">flip</a></code>, <code><a href="#topic+flipMix">flipMix</a></code>, <code><a href="#topic+npc">npc</a></code>, <code><a href="#topic+flip.adjust">flip.adjust</a></code> etc. 
The following are functions to extract and manipulate relevant information from
a <code>flip.object</code>.
</p>
<p><code>show</code> prints the flip.object.
</p>
<p><code>summary</code>: Prints information about the flip-object.
</p>
<p><code>dim</code>: Size of permutation space, i.e. the number of permutations X number of variables.
</p>
<p><code>[</code> and <code>[[</code>: Extract parts of flip.object
</p>
<p><code>names</code>: it deals the names of the tests (the variables, usually)
</p>
<p><code>sort</code>: it sorts the tests stored in <code>flip.objects</code> by their p-values.
</p>
<p><code>hist</code>: it produces the histogram of the distribution of the test statistic.
When there are more test, it produces one histogram for each test statistic.
</p>
<p><code>plot</code>: it produces the scatter plot of the (joint)
distribution of the test statistics.
When there are more than 2 tests, the plot is based on the first two principal components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'flip.object'
show(object)

summary(object, ...)

## S4 method for signature 'flip.object'
summary(object, star.signif = TRUE,
  only.p.leq = NULL, ...)

## S4 method for signature 'flip.object'
dim(x)

## S4 method for signature 'flip.object,ANY,ANY,ANY'
x[i]

## S4 method for signature 'flip.object'
x[[i]]

## S4 method for signature 'flip.object'
length(x)

## S4 method for signature 'flip.object'
names(x)

## S4 replacement method for signature 'flip.object'
names(x) &lt;- value

## S4 method for signature 'flip.object'
sort(x, decreasing = FALSE)

## S4 method for signature 'flip.object'
hist(x, ...)

## S4 method for signature 'flip.object'
plot(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flip.object-class_+3A_object">object</code></td>
<td>
<p>a flip-object</p>
</td></tr>
<tr><td><code id="flip.object-class_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed</p>
</td></tr>
<tr><td><code id="flip.object-class_+3A_star.signif">star.signif</code></td>
<td>
<p>If <code>TRUE</code> (default), it puts stars on the significant tests</p>
</td></tr>
<tr><td><code id="flip.object-class_+3A_only.p.leq">only.p.leq</code></td>
<td>
<p>Shows only tests with a p-value lower than <code>only.p.leq</code>. The default <code>NULL</code> is equivalent to set <code>only.p.leq=1</code>.</p>
</td></tr>
<tr><td><code id="flip.object-class_+3A_x">x</code></td>
<td>
<p>a <code>flip.object</code>.</p>
</td></tr>
<tr><td><code id="flip.object-class_+3A_i">i</code></td>
<td>
<p>indices specifying elements to extract or replace. Indices are <code>numeric</code>, <code>character</code> or <code>logical</code> vectors or empty (missing) or <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="flip.object-class_+3A_value">value</code></td>
<td>
<p><code>character</code> vector of up to the same 
length as <code>x</code>, or <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="flip.object-class_+3A_decreasing">decreasing</code></td>
<td>
<p>logical. Should the sort be increasing or decreasing?</p>
</td></tr>
<tr><td><code id="flip.object-class_+3A_y">y</code></td>
<td>
<p>not used.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>Y=matrix(rnorm(50),10,5)
colnames(Y)=LETTERS[1:5]
Y[,1:2]=Y[,1:2] +2
res = flip(Y)
res
summary(res)
sort(res)
names(res)
length(res)
dim(res)
res=res[2:3]
res
hist(res)
plot(res)
</code></pre>

<hr>
<h2 id='flipMix'>The main function for testing mixed models under a permutation (and
rotation) framework</h2><span id='topic+flipMix'></span><span id='topic+flipMixWithin'></span><span id='topic+obs2coeffWithin'></span>

<h3>Description</h3>

<p>It allows to test fixed effect in mixed models. You can test within-unit
effects, between-unit and interactions of the two. The response can be uni-
or multi-variate. See also examples below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flipMix(modelWithin, X = NULL, Z = NULL, units, perms = 1000,
  data = NULL, tail = 0, statTest = NULL, flipReturn,
  testType = "permutation", Su = NULL, equal.se = FALSE, se = NA,
  replaceNA.coeffWithin = "coeffMeans",
  replaceNA.coeffWithin.se = replaceNA.coeffWithin, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flipMix_+3A_modelwithin">modelWithin</code></td>
<td>
<p>When it is a <code><a href="stats.html#topic+formula">formula</a></code> object,
a (possibly multivariate) multiple linear model is fitted.  Responses are on
the left, while the right part contains ONLY within-unit variables.  In this
case <code>data</code> must be supplied.  Alternatively, it can be a <code>glm</code>, a
<code>lm</code> or <code>vgam</code> (<code>library(VGAM)</code>) (i.e. <code>vglm</code>) object.
The <code>modelWithin</code> have to be performed using only variables
within-unit, without using <code>units</code> indicator (in this case the argument
<code>data</code> is not used).  It can be also a list of models. It can be null
if data is provided in the right format (see below).</p>
</td></tr>
<tr><td><code id="flipMix_+3A_x">X</code></td>
<td>
<p>The part of the design matrix corresponding to the between-unit
effect that are not null under the alternative hypothesis. If it is a matrix
or a data.frame it must have a number of rows equal to the number of units
or equal to the total number of observations (in the latest case all
elements of the same units must have the same values since they are
between-unit effects). The non-null between-unit covariates of null model
are defined in <code>Z</code> (see argument below) and do not have to be supplied
again here. See also the function <code><a href="#topic+flip">flip</a></code>
</p>
<p>NOTE: When called from <code>flipMixWithin</code>, <code>W</code> is used only if
<code>statTest="TBTWest"</code>.</p>
</td></tr>
<tr><td><code id="flipMix_+3A_z">Z</code></td>
<td>
<p>The part of the design matrix corresponding to the non-null
between-unit covariates of the model under the null hypothesis. May be given
as a design matrix or as a half <code><a href="stats.html#topic+formula">formula</a></code> object
(e.g. <code>~a+b</code>). See also the function <code><a href="#topic+flip">flip</a></code>.  If it is a
matrix or a data.frame it must have a number of rows equal to the number of
units or equal to the total number of observations (in the latest case all
elements of the same units must have the same values since they are
between-unit effects).</p>
</td></tr>
<tr><td><code id="flipMix_+3A_units">units</code></td>
<td>
<p>Vector of units IDs. May be given as a vector or as a half
<code><a href="stats.html#topic+formula">formula</a></code> object (e.g. <code>~subj</code>).</p>
</td></tr>
<tr><td><code id="flipMix_+3A_perms">perms</code></td>
<td>
<p>The number of permutations to use. The default is <code>perms =
1000</code>. Alternatively it can be a matrix (i.e. the permutation space) or a
list with elements <code>number</code> and <code>seed</code>. See also the function
<code><a href="#topic+flip">flip</a></code>.</p>
</td></tr>
<tr><td><code id="flipMix_+3A_data">data</code></td>
<td>
<p>Same as in the function <code><a href="#topic+flip">flip</a></code>. If can also be the
results of <code>obs2coeffWithin</code>.</p>
</td></tr>
<tr><td><code id="flipMix_+3A_tail">tail</code></td>
<td>
<p>Same as in the function <code><a href="#topic+flip">flip</a></code>.</p>
</td></tr>
<tr><td><code id="flipMix_+3A_stattest">statTest</code></td>
<td>
<p>For function <code>flipMix</code> choose among <code>"t"</code> and
<code>"F"</code> (very similar to <code>statTest</code> in function <code>flip</code>.\ For
function <code>flipMixWithin</code> choose among <code>"Tnaive"</code> (i.e. no estimate
of the variance), <code>"TH0est"</code> (Default, i.e. estimate of the variance
under H0), <code>"TH1est"</code> (i.e. estimate of the variance under H1 for each
permutation. Slower but some time more powerful) and <code>"TBTWest"</code> (i.e.
estimate of the variance using ILS algorithm at each permutation; it allows
for <code>Z</code> different from a constant term. This is the same algorithm used
for <code>flipMix</code>. MUCH slower but some time even more powerful).
</p>
<p>Both functions allow for vector arguments.</p>
</td></tr>
<tr><td><code id="flipMix_+3A_flipreturn">flipReturn</code></td>
<td>
<p>Same as in the function <code><a href="#topic+flip">flip</a></code>.</p>
</td></tr>
<tr><td><code id="flipMix_+3A_testtype">testType</code></td>
<td>
<p>See also the function <code><a href="#topic+flip">flip</a></code>. Note that this
option used only with function <code>flipMix</code>.</p>
</td></tr>
<tr><td><code id="flipMix_+3A_su">Su</code></td>
<td>
<p>Usually <code>NULL</code>. It is the covariance matrix of the random
effects. If not supplied, it is estimated by iterative least square
algorithm.</p>
</td></tr>
<tr><td><code id="flipMix_+3A_equal.se">equal.se</code></td>
<td>
<p>Logical. If <code>TRUE</code> it force the unit to have the same
variance of errors (like it is usually assumed in the lmer methods).</p>
</td></tr>
<tr><td><code id="flipMix_+3A_se">se</code></td>
<td>
<p>Usually <code>NULL</code>. It is a matrix of unit-specific standard
errors. If not supplied it is estimated by the algorithm.</p>
</td></tr>
<tr><td><code id="flipMix_+3A_replacena.coeffwithin">replaceNA.coeffWithin</code></td>
<td>
<p>deafult is <code>NA</code> i.e. no replacement. You
can provide a specific value (or a vector of values). You can also choose
among &quot;coeffMeans&quot; and &quot;unitMeans&quot; (i.e. mean along columns or along rows of
Y).</p>
</td></tr>
<tr><td><code id="flipMix_+3A_replacena.coeffwithin.se">replaceNA.coeffWithin.se</code></td>
<td>
<p>deafult is <code>Inf</code>. Use the same options
of <code>replaceNA.coeffWithin</code> (but means are over the variances and then
rooted).</p>
</td></tr>
<tr><td><code id="flipMix_+3A_...">...</code></td>
<td>
<p>Further parameters.  <code>test.coeffWithin</code> Vector of names or
IDs of within-unit variables that have to be tested (and reported). Note
that variables not in the list are used in the model (i.e. the they play the
role of nuisance parameters). <code>fastSumCombination</code>,<code>onlyMANOVA</code>
and <code>linComb</code> are used in <code>flipMix</code> to deal with combination of
variables/coefficents.
</p>
<p>See also the function <code><a href="#topic+flip">flip</a></code> for other parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>flipMix</code> and <code>flipMixWithin</code> return an object of class
<code>flip.object</code>.  Several operations and plots can be made from this
object. See also <code><a href="#topic+flip.object-class">flip.object-class</a></code>.
</p>
<p>Note that function <code>flipMix</code> with <code>statTest="t"</code> or <code>"F"</code>
provides tests for each effect between (and interaction) and also provides
the overall test <code>PC1</code> and <code>sum</code> (i.e. all effects ar null, same
as <code>npc</code> does).
</p>
<p>Use <code><a href="#topic+npc">npc</a></code> with any
<code>comb.funct=c("data.sum","data.linComb","data.pc","data.trace")</code> to
combine results.
</p>
<p><code>obs2coeffWithin</code> return a list of objects that can be used as argument
of <code>data</code> in the function <code>flipMix</code> and <code>flipMixWithin</code>.
</p>


<h3>Author(s)</h3>

<p>Livio Finos and Dario Basso
</p>


<h3>References</h3>

<p>L. Finos and D. Basso (2013) Permutation Tests for Between-Unit
Fixed Effects in Multivariate Generalized Linear Mixed Models. Statistics
and Computing.
</p>
<p>D. Basso, L. Finos (2011) Exact Multivariate Permutation Tests for Fixed
Effects in Mixed-Models. Communications in Statistics - Theory and Methods.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+flip">flip</a></code>, <code><a href="#topic+npc">npc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
N=10
toyData= data.frame(subj=rep(1:N,rep(4,N)), Within=rep(1:2,N*2),
          XBetween= rep(1:2,rep(N/2*4,2)),ZBetween= rep(rnorm(N/2),rep(8,N/2)))
toyData= cbind(Y1=rnorm(n=N*4,mean=toyData$subj+toyData$ZBetween+toyData$XBetween),
               Y2=rnorm(n=N*4,mean=toyData$subj+toyData$ZBetween+toyData$Within*2),toyData)
(toyData)

#####################
###Testing Between-unit effects
(res=flipMix(modelWithin=as.matrix(toyData[,c("Y1","Y2")])~Within,data=toyData, 
      X=~XBetween,Z=~ZBetween,units=~subj,perms=1000,testType="permutation",statTest="t"))
#same as:
modelWithin &lt;- lm(as.matrix(toyData[,c("Y1","Y2")])~Within,data=toyData)
(flipMix(modelWithin=modelWithin,data=toyData, X=~XBetween,Z=~ZBetween,units= ~subj, 
        perms=1000,testType="permutation",statTest="t"))

### Note that this is different from:
modelWithin &lt;- list(Y1=lm(Y1~Within,data=toyData),Y2=lm(Y2~Within,data=toyData))
(flipMix(modelWithin=modelWithin,data=toyData, X=~XBetween,Z=~ZBetween,units= ~subj,
        perms=1000,testType="permutation",statTest="t"))

### combining results
(npc(res,"data.pc"))
(npc(res,"data.trace"))
################################
###Testing Within-unit effects
## The resulting test is approximated. The estimate of the variance within units 
## takes in account the presence of effects between units.
(flipMix(modelWithin=as.matrix(toyData[,c("Y1","Y2")])~Within,data=toyData, 
        units= ~subj, perms=1000,testType="permutation",statTest="t"))

###The resulting tests are exact. If effects between are presents, 
## statTest="Tnaive" or "TBTWest" are more suitable:
(res=flipMixWithin(modelWithin=as.matrix(toyData[,c("Y1","Y2")])~Within,data=toyData, 
        units= ~subj, perms=1000,statTest=c("TH1est")))
npc(res)

</code></pre>

<hr>
<h2 id='getFlip'>getFlip</h2><span id='topic+getFlip'></span>

<h3>Description</h3>

<p>It returns a given element of a flip.object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getFlip(obj, element)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getFlip_+3A_obj">obj</code></td>
<td>
<p>a <code>flip.object</code></p>
</td></tr>
<tr><td><code id="getFlip_+3A_element">element</code></td>
<td>
<p>element to the returned</p>
</td></tr>
</table>


<h3>Value</h3>

<p>values of the element requested.
</p>

<hr>
<h2 id='permutationSpace'>These functions handle the orbit of permutation/rotation tests (i.e.
permutation/rotation space).</h2><span id='topic+permutationSpace'></span><span id='topic+make.permSpace'></span><span id='topic+make.signSpace'></span><span id='topic+allpermutations'></span><span id='topic+npermutations'></span><span id='topic+t2p'></span><span id='topic+rom'></span><span id='topic+romFast'></span>

<h3>Description</h3>

<p><code>make.permSpace</code> computes the <code>perms</code> x n matrix of ids used for
test of dependence. <code>make.signSpace</code> computes the <code>perms</code> x n
vector of +1 and -1 used for symmetry test.
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="permutationSpace_+3A_ids">IDs</code></td>
<td>
<p>vector of IDs to be permuted. If <code>IDs</code> is a scalar, it is
replaced with <code>1:IDs</code>.</p>
</td></tr>
<tr><td><code id="permutationSpace_+3A_return.permids">return.permIDs</code></td>
<td>
<p>logical. If <code>TRUE</code>, the matrix of permuted IDs is
stored and returned. Only used with <code>testType="permutaiton"</code></p>
</td></tr>
<tr><td><code id="permutationSpace_+3A_n">N</code></td>
<td>
<p>number of elements of the sample. It is also the dimention of the
random orthogonal matrix in <code>rom</code>.</p>
</td></tr>
<tr><td><code id="permutationSpace_+3A_y">Y</code></td>
<td>
<p>a vector of data. It can also be a vector 1:N referring to the IDs
of observations.</p>
</td></tr>
<tr><td><code id="permutationSpace_+3A_perms">perms</code></td>
<td>
<p>number of random permutations. If it is a list, it has two
elements <code>number</code> (the number of random permutation requested) and
<code>seed</code> (the seed to be set when start generating. it is useful for
reproducibility) If perms &gt; number of all possible flips, then compute the
complete space.</p>
</td></tr>
<tr><td><code id="permutationSpace_+3A_t">T</code></td>
<td>
<p>the (possibly multivariate) permutation space as returned, for
example by <code>flip</code></p>
</td></tr>
<tr><td><code id="permutationSpace_+3A_obs.only">obs.only</code></td>
<td>
<p>logical. If <code>TRUE</code> only the p-value for observed test
statistic is returned, otherwise the whole space is computed. Defaults:
<code>TRUE</code> if <code>T</code> is a <code>flip-object</code>, <code>FALSE</code> otherwise.</p>
</td></tr>
<tr><td><code id="permutationSpace_+3A_tail">tail</code></td>
<td>
<p>Tail of the distribution being significant for H1. See also
argument <code>tail</code> in <code><a href="#topic+flip">flip</a></code>. Defaults: <code>1</code> if <code>T</code>
is NOT a <code>flip-object</code>, it is taken from <code>T</code> otherwise.</p>
</td></tr>
<tr><td><code id="permutationSpace_+3A_testtype">testType</code></td>
<td>
<p>See argument <code>testType</code> in <code><a href="#topic+flip">flip</a></code></p>
</td></tr>
<tr><td><code id="permutationSpace_+3A_strata">Strata</code></td>
<td>
<p>See argument <code>testType</code> in <code><a href="#topic+flip">flip</a></code></p>
</td></tr>
<tr><td><code id="permutationSpace_+3A_x">X</code></td>
<td>
<p>A vector of length <code>N</code> with a different value for each group.
Only used together with <code>testType="combination"</code>.</p>
</td></tr>
<tr><td><code id="permutationSpace_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>rom</code> computes a Random Orthogonal Matrix of size <code>n</code>X<code>n</code>
(C-compiled function, very fast). implements the algorithm of Stewart (1980). The function is
compiled in C++. NOTE: this option is not available in the newest versions. This is now equivalent to <code>romFast</code>
</p>
<p><code>romFast</code> computes a Random Orthogonal Matrix of size <code>n</code>X<code>n</code>
using the <code>qr.Q</code> decomposition. <code>romFast</code> is faster than
<code>rom</code> but can be inaccurate (i.e. providing inaccurate type I error
control when used in testing), specially for very small <code>n</code> (i.e.
sample size).
</p>
<p><code>allpermutations</code> computes all permutations of a vector <code>Y</code>. Is is
based on the function <code>permutations</code> of the <code>library(e1071)</code>.
</p>
<p><code>t2p</code> computes the (possibily multivariate) space of p-values from the
space of test statistic.
</p>


<h3>References</h3>

<p>Pesarin (2001) Multivariate Permutation Tests with Applications
in Biostatistics. Wiley, New York.
</p>
<p>Stewart, G. W. (1980). The efficient generation of random orthogonal
matrices with an application to condition estimators. SIAM Journal on
Numerical Analysis 17, 403-409.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+flip">flip</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#10 random elements of the orbit of a one-sample test
make.signSpace(5, 10)

#All elements of the orbit of a one-sample test (the size of the space is 2^5 &lt; 1000)
make.signSpace(5, 1000)

## Not run: 
#A random rotation matrix of size 3
(r=rom(3))
#verify that it is orthogonal:
r%*%t(r)

## End(Not run)

</code></pre>

<hr>
<h2 id='seeds'>Seeds data</h2><span id='topic+seeds'></span>

<h3>Description</h3>

<p>Famous seeds growing data from Pesarin, F. (2001) Multivariate Permutation
Tests with Applications in Biostatistics. Wiley, New York.
</p>


<h3>Format</h3>

<p>the data.frame contains the three columns: grs, x, y</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
