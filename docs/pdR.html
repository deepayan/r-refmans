<!DOCTYPE html><html><head><title>Help for package pdR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pdR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pdR-package'>
<p>Panel Data Regression: Threshold Model and Unit Root Tests</p>
</p></a></li>
<li><a href='#bank_income'>
<p>Panel data of bank,2001Q1~2010Q1</p></a></li>
<li><a href='#cigaretts'>
<p>Cigaretts consumption of US states</p></a></li>
<li><a href='#contts'>
<p>Function for extracting components from a lm object</p></a></li>
<li><a href='#crime'>
<p>Annual crime dataset of US counties</p></a></li>
<li><a href='#dur_john'>
<p>The cross-country growth data in Durlauf and Johnson(1995)</p></a></li>
<li><a href='#hegy.reg'>
<p>Generate the HEGY regressors.</p></a></li>
<li><a href='#HEGY.test'>
<p>Seasonal unit root test based on Hylleberg et al. (1990)</p></a></li>
<li><a href='#htest_pglm'><p>Specification test for panel glm models</p>
</p></a></li>
<li><a href='#IGF'><p>Unit root test based on Change(2002)</p></a></li>
<li><a href='#inf_M'>
<p>Monthly inflation time series of 20 countries</p></a></li>
<li><a href='#inf_Q'>
<p>Quarterly inflation time series of 20 countries</p></a></li>
<li><a href='#inf19'>
<p>Monthly inflation time series of 19 countries</p></a></li>
<li><a href='#interpolpval'>
<p>Extracting critical value and p-value from Table 1 of Hylleberg et. al (1990)</p></a></li>
<li><a href='#invest'>
<p>investment data of 565 listed companies, 1973-1987</p></a></li>
<li><a href='#ipsHEGY'>
<p>IPS-HEGY seasonal unit root test in panel data, Otero et al.(2007).</p>
</p></a></li>
<li><a href='#lagSelect'><p>Select the optimal number of lags, given criteria</p></a></li>
<li><a href='#lookupCVtable'>
<p>Function for looking up tabulated critical values and associated p-values of HEGY test.</p></a></li>
<li><a href='#model'><p>Estimate specified panel threshold model</p>
</p></a></li>
<li><a href='#pIGF'><p>Panel unit root test of Chang(2002)</p></a></li>
<li><a href='#productivity'>
<p>Productivity data of 48 US state,1970-1986</p></a></li>
<li><a href='#ptm'><p>Threshold specification of panel data</p>
</p></a></li>
<li><a href='#r_est'><p>A subroutine for model()</p>
</p></a></li>
<li><a href='#ret'>
<p>Returns a data.frame of sequential lag matrix.</p></a></li>
<li><a href='#SeasComponent'>
<p>Generate a data matrix of seasonal components</p></a></li>
<li><a href='#selPabic'>
<p>Selection of lags.</p></a></li>
<li><a href='#selPsignf'>
<p>Selection of lags.</p></a></li>
<li><a href='#ship'>
<p>Panel data on the number of ship accidents</p></a></li>
<li><a href='#SMPLSplit_est'><p>Estimation of sub-sampled data</p>
</p></a></li>
<li><a href='#SMPLSplit_example'><p>Example code for sample splitting</p></a></li>
<li><a href='#SMPLSplit_het'><p>Testing for sample splitting</p>
</p></a></li>
<li><a href='#sse_calc'><p>a subroutine of model()</p></a></li>
<li><a href='#tbar'>
<p>Compute the resursive mean</p></a></li>
<li><a href='#thr_sse'><p>a subroutine calculating SSE</p>
</p></a></li>
<li><a href='#tr'><p>A sub-routine calculating trace</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Threshold Model and Unit Root Tests in Cross-Section and Time
Series Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.9.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-06-03</td>
</tr>
<tr>
<td>Author:</td>
<td>Ho Tsung-wu</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ho Tsung-wu &lt;tsungwu@ntnu.edu.tw&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Threshold model, panel version of Hylleberg et al. (1990) &lt;<a href="https://doi.org/10.1016%2F0304-4076%2890%2990080-D">doi:10.1016/0304-4076(90)90080-D</a>&gt; seasonal unit root tests, and panel unit root test of Chang (2002) &lt;<a href="https://doi.org/10.1016%2FS0304-4076%2802%2900095-7">doi:10.1016/S0304-4076(02)00095-7</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>plm, pglm, lme4, glmmTMB</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-03 11:14:15 UTC; badal</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-04 09:49:53 UTC</td>
</tr>
</table>
<hr>
<h2 id='pdR-package'>
Panel Data Regression: Threshold Model and Unit Root Tests
</h2><span id='topic+pdR-package'></span><span id='topic+pdR'></span>

<h3>Description</h3>

<p>Functions for analysis of panel data, including the panel threshold model of Hansen (1999,JE), panel unit root test of Chang(2002,JE) based upon instuments generating functions (IGF), and panel seasonal unit root test based upon Hylleberg et al.(1990,JE).
</p>


<h3>Details</h3>

<p> This version offers formatted output. This package designs a specification function ptm() to estimate the panel threshold model of Hansen(1999). The key feature of ptm() is to generalize Hansen's original code to allow multiple (more-than-one) regime-dependent right-hand-side independent variables; Dr. Hansen's original code admits only 1 regime-dependent right-hand-side independent variable. This version also includes panel unit root tests based on the instrument generating functions(IGF), proposed by Chang (2002, J. of Econometrics), and the panel version of Hylleberg et al.(1990) seasonal unit root test, proposed by Otero, et al. (2005, 2007).
</p>


<h3>Author(s)</h3>

<p>Ho Tsung-wu &lt;tsungwu@ntnu.edu.tw&gt;, College of Management, National Taiwan Normal University.<br />
Maintainer: Ho Tsung-wu &lt;tsungwu@ntnu.edu.tw&gt;
</p>


<h3>References</h3>

 
<p>Chang, Y. (2002) Nonlinear IV Unit Root Tests in Panels with Cross-Sectional Dependency. Journal of Econometrics, 110, 261-292.<br />
Hansen B. E. (1999) Threshold effects in non-dynamic panels: Estimation, testing and inference. Journal of Econometrics,93, 345-368.<br />
Hylleberg, S., Engle, R.F., Granger, C.W.J., and Yoo, B.S.(1990) Seasonal integration and cointegration. Journal of Econometrics,44, 215-238.<br />
Otero, J., Smith, J., and Giulietti, M. (2005) Testing for seasonal unit roots in heterogeneous panels. Economics Letters,  86, 229-235.<br />
Otero, J., Smith, J., and Giulietti, M. (2007) Testing for seasonal unit roots in heterogeneous panels in the presence of cross section dependence. Economics Letters, 86, 179-184.<br />
Pesaran M. Hashem (2007) A simple panel unit root test in the presence of cross-section dependence.  Journal of Applied Econometrics, 22, 265-312.
</p>

<hr>
<h2 id='bank_income'>
Panel data of bank,2001Q1~2010Q1
</h2><span id='topic+bank_income'></span>

<h3>Description</h3>

<p>A quarterly panel data frame with 1000 observations on the following 7 variables, unbalanced panel data ranges from 2001Q1~2010Q1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("bank_income")</code></pre>


<h3>Format</h3>


<dl>
<dt><code>ID</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Qtr</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>preTax_Income</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>shortRatio</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>longRatio</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Current_ratio</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>LoanDeposit_ratio</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(bank_income)
</code></pre>

<hr>
<h2 id='cigaretts'>
Cigaretts consumption of US states 
</h2><span id='topic+cigaretts'></span>

<h3>Description</h3>

<p>Cigaretts consumption of US states </p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cigaretts)
</code></pre>


<h3>Format</h3>

<p>A data frame of 48 US states' cigaretts consumption
</p>

<dl>
<dt><code>State</code></dt><dd><p>State abbreviation, N</p>
</dd>
<dt><code>Year</code></dt><dd><p>Year, t</p>
</dd>
<dt><code>Y_SALES</code></dt><dd><p>Cigarette sales in packs per capita, deflated by population</p>
</dd>
<dt><code>X1_PRICE</code></dt><dd><p>P=Real price per pack of cigarettes, deflated by 1983 CPI.
</p>
</dd>
<dt><code>X2_PIMIN</code></dt><dd><p>Real minimum price in adjoining states per pack of cigarettes, deflated by CPI</p>
</dd>
<dt><code>X3_NDI</code></dt><dd><p>Per capita disposable income</p>
</dd>
</dl>



<h3>References</h3>

<p>Baltagi Badi H. (2005) Econometric Analysis of Panel Data.  John Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cigaretts)
head(cigaretts)
</code></pre>

<hr>
<h2 id='contts'>
Function for extracting components from a lm object
</h2><span id='topic+contts'></span>

<h3>Description</h3>

<p>Extract the standard error and t-stat of the a-th parameter estimate of a lm object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contts(lm, a)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="contts_+3A_lm">lm</code></td>
<td>

<p>lm object
</p>
</td></tr>
<tr><td><code id="contts_+3A_a">a</code></td>
<td>

<p>The a-th parameter estimate of a linear model regression
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>se.coef</code></td>
<td>
<p>The standard error of the selected coefficient</p>
</td></tr>
<tr><td><code>t.stat</code></td>
<td>
<p>The t-stat of the selected coefficient</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ho Tsung-wu &lt;tsungwu@ntnu.edu.tw&gt;, modifed from Javier Lopez-de-Lacalle.
</p>


<h3>References</h3>

<p>Javier Lopez-de-Lacalle in https://github.com/cran/uroot/blob/master/R/hegy.R 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x=rnorm(100)
y=1+0.2*x+rnorm(100)
LMout=lm(y~x)
contts(LMout,1)

#$se.coef
#[1] 0.1081023

#$t.stat
#(Intercept) 
#   10.60401 

</code></pre>

<hr>
<h2 id='crime'>
Annual crime dataset of US counties 
</h2><span id='topic+crime'></span>

<h3>Description</h3>

<p>Annual crime dataset of US counties </p>


<h3>Usage</h3>

<pre><code class='language-R'>data(crime)
</code></pre>


<h3>Format</h3>

<p>A data frame of US counties
</p>

<dl>
<dt><code>county</code></dt><dd><p>counties index, N</p>
</dd>
<dt><code>year</code></dt><dd><p>Year, t</p>
</dd>
<dt><code>crmrte</code></dt><dd><p>crime rate(crime/population)</p>
</dd>
<dt><code>prbarr</code></dt><dd><p>probability of arrest (arrests/offenses)</p>
</dd>
<dt><code>prbconv</code></dt><dd><p>probability of conviction, given arrest</p>
</dd>
<dt><code>prbpris</code></dt><dd><p>probability of a prison, given conviction </p>
</dd>
<dt><code>avgsen</code></dt><dd><p>sanction severity(average prison sentence in days )</p>
</dd>
<dt><code>polpc</code></dt><dd><p>ability of police force to detect crime(# of police per capita)</p>
</dd>
<dt><code>density</code></dt><dd><p>population density(POP/area)
</p>
</dd>
<dt><code>taxpc</code></dt><dd><p>Taxpayment per capita</p>
</dd>
<dt><code>region</code></dt><dd><p>region index of county</p>
</dd>
<dt><code>smsa</code></dt><dd><p>=1 if SAMA, POP&gt;50000; =0 else </p>
</dd>
<dt><code>pctmin</code></dt><dd><p>See Baltagi(2006) for details</p>
</dd>
<dt><code>wcon</code></dt><dd><p>See Baltagi(2006) for details </p>
</dd>
<dt><code>wtuc</code></dt><dd><p>See Baltagi(2006) for details</p>
</dd>
<dt><code>wtrd</code></dt><dd><p>See Baltagi(2006) for details</p>
</dd>
<dt><code>wfir</code></dt><dd><p>See Baltagi(2006) for details</p>
</dd>
<dt><code>wser</code></dt><dd><p>See Baltagi(2006) for details</p>
</dd>
<dt><code>wmfg</code></dt><dd><p>See Baltagi(2006) for details</p>
</dd>
<dt><code>wfed</code></dt><dd><p>See Baltagi(2006) for details</p>
</dd>
<dt><code>wsta</code></dt><dd><p>See Baltagi(2006) for details</p>
</dd>
<dt><code>wloc</code></dt><dd><p>See Baltagi(2006) for details</p>
</dd>
<dt><code>mix</code></dt><dd><p>See Baltagi(2006) for details</p>
</dd>
<dt><code>pctymle</code></dt><dd><p>See Baltagi(2006) for details</p>
</dd>
</dl>



<h3>References</h3>

<p>Baltagi Badi H. (2005) Econometric Analysis of Panel Data.  John Wiley.
Baltagi Badi H. (2006) Estimating an Economic Model of Crime Using Panel Data from North Carolina. J.of Applied Econometrics 21: 543¡V547.
</p>

<hr>
<h2 id='dur_john'>
The cross-country growth data in Durlauf and Johnson(1995)
</h2><span id='topic+dur_john'></span>

<h3>Description</h3>

<p>The Durlauf-Johnson data manupipulated by Hansen(2000),excluding missing variables and oil states 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dur_john)
</code></pre>


<h3>Format</h3>

<p>A data frame with 19 countries
</p>

<dl>
<dt><code>gdpGrowth</code></dt><dd><p>Economic growth measured by GDP of 1960 and 1985</p>
</dd>
<dt><code>logGDP60</code></dt><dd><p>log Per capita GDP in 1960</p>
</dd>
<dt><code>Inv_GDP</code></dt><dd><p>Average ratio of investment (including Government Investment) to GDP      from 1960 to 1985</p>
</dd>
<dt><code>popGrowth</code></dt><dd><p>Average growth rate of working-age population 1960 to 1985</p>
</dd>
<dt><code>School</code></dt><dd><p>Average fraction of working-age population enrolled in secondary school
from 1960 to 1985</p>
</dd>
<dt><code>GDP60</code></dt><dd><p>Per capita GDP in 1960</p>
</dd>
<dt><code>Literacy</code></dt><dd><p>fraction of the population over 15 years old that is able to read 
and write in 1960</p>
</dd>
</dl>



<h3>Details</h3>

<p>Steven N. Durlauf and Paul A. Johnson, &quot;Multiple Regimes and Cross-Country
Growth Behavior,&quot; Journal of Applied Econometrics, Vol. 10, No. 4, 1995,
365-384. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dur_john)
head(dur_john)
</code></pre>

<hr>
<h2 id='hegy.reg'>
Generate the HEGY regressors.
</h2><span id='topic+hegy.reg'></span>

<h3>Description</h3>

<p>This function generates the level regresors in HEGY regression, without differenced lag terms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hegy.reg(wts)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hegy.reg_+3A_wts">wts</code></td>
<td>

<p>Univariate time series, with a possibly seasonal stochastic trend
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function automatically identifies the frequency of time series data, and generate necessary level components as described in  Eq.(3.7) of Hylleberg et. al (1990).
</p>


<h3>Author(s)</h3>

<p>Ho Tsung-wu &lt;tsungwu@ntnu.edu.tw&gt;, modifed from Javier Lopez-de-Lacalle
</p>


<h3>References</h3>

<p>Hylleberg, S., Engle, R.F., Granger, C.W.J., and Yoo, B.S.(1990) Seasonal integration and cointegration. Journal of Econometrics,44, 215-238.<br />
Javier Lopez-de-Lacalle in https://github.com/cran/uroot/blob/master/R/hegy.R
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(inf_Q)
y=inf_Q[,1]
hegy.reg(y)
</code></pre>

<hr>
<h2 id='HEGY.test'>
Seasonal unit root test based on Hylleberg et al. (1990)
</h2><span id='topic+HEGY.test'></span>

<h3>Description</h3>

<p>The function performs seasonal unit root test based on Eq.(3.6) of Hylleberg et al. (1990), univariate time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HEGY.test(wts, itsd, regvar = 0, selectlags = list(mode = "signf", Pmax = NULL))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HEGY.test_+3A_wts">wts</code></td>
<td>
<p>Univariate time series</p>
</td></tr>
<tr><td><code id="HEGY.test_+3A_itsd">itsd</code></td>
<td>
<p>Options for c(i,t,sd)<br /> 
i=1, intercept;=0 no intercept<br />
t=1, trend;=0 no deterministic trend<br />
sd=1, season dummy 1:(s-1);=0 no.
</p>
</td></tr>
<tr><td><code id="HEGY.test_+3A_regvar">regvar</code></td>
<td>
<p>Additional regressors</p>
</td></tr>
<tr><td><code id="HEGY.test_+3A_selectlags">selectlags</code></td>
<td>
<p>Selection of lags<br />
mode, Criteria for selection, having three options: &quot;signf&quot;,&quot;bic&quot;,&quot;aic&quot;. <br />
Pmax, maximum number of lags.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Mode for selectlags has three options, AIC and BIC use R built-in functions for linear model and their meanings are popular and straightforward. They include only lags that meet specific criterion, others are dropped from regressors. That is, lag orders of your model may not be a regular sequence. See also selPsignf() and selPabic().
</p>


<h3>Value</h3>

<table>
<tr><td><code>stats</code></td>
<td>
<p>Tests statistics for HEGY regression coefficients.</p>
</td></tr>
<tr><td><code>hegycoefs</code></td>
<td>
<p>HEGY regression coefficients.</p>
</td></tr>
<tr><td><code>lagsorder</code></td>
<td>
<p>Lags order. &quot;aic&quot; or &quot;bic&quot; returns a scalar; &quot;signf&quot; returns a sequence of numbers</p>
</td></tr>
<tr><td><code>lagcoefs</code></td>
<td>
<p>Coefficients of lag terms.</p>
</td></tr>
<tr><td><code>regvarcoefs</code></td>
<td>
<p>Coefficient(s) of additional regressor(s).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ho Tsung-wu &lt;tsungwu@ntnu.edu.tw&gt;, modifed from Javier Lopez-de-Lacalle
</p>


<h3>References</h3>

<p>Hylleberg, S., Engle, R.F., Granger, C.W.J., and Yoo, B.S.(1990) Seasonal integration and cointegration. Journal of Econometrics,44, 215-238.<br />
Javier Lopez-de-Lacalle in https://github.com/cran/uroot/blob/master/R/hegy.R
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(inf_Q)
y&lt;-inf_Q[,1]
hegy.out&lt;-HEGY.test(wts=y, itsd=c(1,0,c(1:3)),regvar=0, selectlags=list(mode="aic", Pmax=12))

hegy.out$stats #HEGY test statistics
names(hegy.out) # HEGY objects, which can be called by using $, see below.
hegy.out$hegycoefs
hegy.out$regvarcoefs
</code></pre>

<hr>
<h2 id='htest_pglm'>Specification test for panel glm models
</h2><span id='topic+htest_pglm'></span>

<h3>Description</h3>

<p>This function performs Hausman specification test for panel glm. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>htest_pglm(RE, FE, re.method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="htest_pglm_+3A_re">RE</code></td>
<td>
<p>Random effect objects. Support pglm, glmer, glmmTMB</p>
</td></tr>
<tr><td><code id="htest_pglm_+3A_fe">FE</code></td>
<td>
<p>Fixed effect objects.</p>
</td></tr>
<tr><td><code id="htest_pglm_+3A_re.method">re.method</code></td>
<td>
<p>Method that used to estimate the random effect estimation, in addition to &quot;pglm&quot;, it also supports &quot;glmmTMB&quot; of package glmmTMB, and &quot;glmer&quot; of package lme4.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ho Tsung-wu &lt;tsungwu@ntnu.edu.tw&gt;, modifed from phtest() of plm
</p>


<h3>References</h3>

<p>Hausman J.A. (1978). Specification Tests in Econometrics. Econometrica, 46, 1251-1271.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ship)
library(pglm)
Eq1="accident  ~  op_75_79+co_65_69+co_70_74+co_75_79"
FE.pois &lt;- pglm(Eq1,data=ship,family = "poisson",model = "within",index = 'ship',R=10)

RE.pois &lt;- pglm::pglm(Eq1,data=ship,family = "poisson", model = "random", index = 'ship')

## Hausman test
htest_pglm(RE=RE.pois,  FE=FE.pois, re.method="pglm")

Eq2=accident  ~  op_75_79+co_65_69+co_70_74+co_75_79 + (1 | ship)
re.glmmTMB=glmmTMB::glmmTMB(Eq2,data=ship, family="poisson")

## Hausman test
htest_pglm(RE=re.glmmTMB,  FE=FE.pois, re.method="glmmTMB")


</code></pre>

<hr>
<h2 id='IGF'>Unit root test based on Change(2002)
</h2><span id='topic+IGF'></span>

<h3>Description</h3>

<p>This function estimates the unit root regression based on instrument generating function of Change(2002) and returns useful outputs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IGF(y, maxp, ic, spec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IGF_+3A_y">y</code></td>
<td>
<p>A univariate time series data
</p>
</td></tr>
<tr><td><code id="IGF_+3A_maxp">maxp</code></td>
<td>
<p>the max number of lags
</p>
</td></tr>
<tr><td><code id="IGF_+3A_ic">ic</code></td>
<td>
<p>Information criteria, either &quot;AIC&quot; or &quot;BIC&quot;
</p>
</td></tr>
<tr><td><code id="IGF_+3A_spec">spec</code></td>
<td>
<p>regression model specification.<br />
=0, no intercept and trend.<br />
=1, intercept only.<br />
=2, intercept and trend.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimate univariate unit root test of Chang(2002).</p>


<h3>Value</h3>

<table>
<tr><td><code>tstat.IGF</code></td>
<td>
<p>IGF unit root test</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>regression coefficients. The first one is the AR(1) coefficient of unit root, and the last one is the intercept or trend</p>
</td></tr>
<tr><td><code>sdev</code></td>
<td>
<p>The IGF standard error for unit root coefficient</p>
</td></tr>
<tr><td><code>cV</code></td>
<td>
<p>The scalar C in IGF equation</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The optimal number of lag</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ho Tsung-wu &lt;tsungwu@ntnu.edu.tw&gt;, College of Management, National Taiwan Normal University.
</p>


<h3>References</h3>

<p>Chang, Y. (2002) Nonlinear IV Unit Root Tests in Panels with Cross-Sectional Dependency. Journal of Econometrics, 110, 261-292.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(inf19)
y &lt;- inf19[,1]
IGF(y,maxp=35,ic="BIC",spec=2)$tstat.IGF

</code></pre>

<hr>
<h2 id='inf_M'>
Monthly inflation time series of 20 countries
</h2><span id='topic+inf_M'></span>

<h3>Description</h3>

<p>Monthly inflation time series of 19 countries, 1971.1~2011.12
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(inf_M)
</code></pre>


<h3>Format</h3>

<p>A data frame with 20 countries
</p>

<dl>
<dt><code>AUSTRALIA</code></dt><dd><p>inflation of Austrlia</p>
</dd>
<dt><code>AUSTRIA</code></dt><dd><p>inflation of Austria</p>
</dd>
<dt><code>BELGIUM</code></dt><dd><p>inflation of Belgium</p>
</dd>
<dt><code>CANADA</code></dt><dd><p>inflation of Canada</p>
</dd>
<dt><code>DENMARK</code></dt><dd><p>inflation of Denmark</p>
</dd>
<dt><code>FINLAND</code></dt><dd><p>inflation of Finland</p>
</dd>
<dt><code>FRANCE</code></dt><dd><p>inflation of France</p>
</dd>
<dt><code>GREECE</code></dt><dd><p>inflation of Greece</p>
</dd>
<dt><code>ICELAND</code></dt><dd><p>inflation of Iceland</p>
</dd>
<dt><code>ITALY</code></dt><dd><p>inflation of Italy</p>
</dd>
<dt><code>JAPAN</code></dt><dd><p>inflation of Japan</p>
</dd>
<dt><code>LUXEMBOURG</code></dt><dd><p>inflation of Luxembourg</p>
</dd>
<dt><code>NETHERLANDS</code></dt><dd><p>inflation of Netherlands</p>
</dd>
<dt><code>NORWAY</code></dt><dd><p>inflation of Norway</p>
</dd>
<dt><code>PORTUGAL</code></dt><dd><p>inflation of Portugal</p>
</dd>
<dt><code>SPAIN</code></dt><dd><p>inflation of Spain</p>
</dd>
<dt><code>SWEDEN</code></dt><dd><p>inflation of Sweden</p>
</dd>
<dt><code>SWITZERLAND</code></dt><dd><p>inflation of Switzerland</p>
</dd>
<dt><code>UK</code></dt><dd><p>inflation of UK</p>
</dd>
<dt><code>USA</code></dt><dd><p>inflation of USA</p>
</dd>
</dl>



<h3>Details</h3>

<p>Monthly CIP, seasonaly differenced of log CPI of 20 countries
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(inf_M)
head(inf_M)
</code></pre>

<hr>
<h2 id='inf_Q'>
Quarterly inflation time series of 20 countries
</h2><span id='topic+inf_Q'></span>

<h3>Description</h3>

<p>Quarterly inflation time series of 19 countries, 1971Q1~2014Q4
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(inf_Q)
</code></pre>


<h3>Format</h3>

<p>A data frame with 19 countries
</p>

<dl>
<dt><code>AUSTRLIA</code></dt><dd><p>inflation of Austrlia</p>
</dd>
<dt><code>AUSTRIA</code></dt><dd><p>inflation of Austria</p>
</dd>
<dt><code>BELGIUM</code></dt><dd><p>inflation of Belgium</p>
</dd>
<dt><code>CANADA</code></dt><dd><p>inflation of Canada</p>
</dd>
<dt><code>DENMARK</code></dt><dd><p>inflation of Denmark</p>
</dd>
<dt><code>FINLAND</code></dt><dd><p>inflation of Finland</p>
</dd>
<dt><code>FRANCE</code></dt><dd><p>inflation of France</p>
</dd>
<dt><code>GREECE</code></dt><dd><p>inflation of Greece</p>
</dd>
<dt><code>ICELAND</code></dt><dd><p>inflation of Iceland</p>
</dd>
<dt><code>ITALY</code></dt><dd><p>inflation of Italy</p>
</dd>
<dt><code>JAPAN</code></dt><dd><p>inflation of Japan</p>
</dd>
<dt><code>LUXEMBOURG</code></dt><dd><p>inflation of Luxembourg</p>
</dd>
<dt><code>NETHERLANDS</code></dt><dd><p>inflation of Netherlands</p>
</dd>
<dt><code>NORWAY</code></dt><dd><p>inflation of Norway</p>
</dd>
<dt><code>PORTUGAL</code></dt><dd><p>inflation of Portugal</p>
</dd>
<dt><code>SPAIN</code></dt><dd><p>inflation of Spain</p>
</dd>
<dt><code>SWEDEN</code></dt><dd><p>inflation of Sweden</p>
</dd>
<dt><code>SWITZERLAND</code></dt><dd><p>inflation of Switzerland</p>
</dd>
<dt><code>UK</code></dt><dd><p>inflation of UK</p>
</dd>
<dt><code>USA</code></dt><dd><p>inflation of USA</p>
</dd>
</dl>



<h3>Details</h3>

<p>Quarterly CIP, seasonaly differenced of log CPI of 20 countries
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(inf_Q)
head(inf_Q)
</code></pre>

<hr>
<h2 id='inf19'>
Monthly inflation time series of 19 countries
</h2><span id='topic+inf19'></span>

<h3>Description</h3>

<p>Monthly inflation time series of 19 countries, 1984.1~2011.3
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(inf19)
</code></pre>


<h3>Format</h3>

<p>A data frame with 19 countries
</p>

<dl>
<dt><code>AUSTRIA</code></dt><dd><p>inflation of Austria</p>
</dd>
<dt><code>BELGIUM</code></dt><dd><p>inflation of Belgium</p>
</dd>
<dt><code>CANADA</code></dt><dd><p>inflation of Canada</p>
</dd>
<dt><code>DENMARK</code></dt><dd><p>inflation of Denmark</p>
</dd>
<dt><code>FINLAND</code></dt><dd><p>inflation of Finland</p>
</dd>
<dt><code>FRANCE</code></dt><dd><p>inflation of France</p>
</dd>
<dt><code>GREECE</code></dt><dd><p>inflation of Greece</p>
</dd>
<dt><code>ICELAND</code></dt><dd><p>inflation of Iceland</p>
</dd>
<dt><code>ITALY</code></dt><dd><p>inflation of Italy</p>
</dd>
<dt><code>JAPAN</code></dt><dd><p>inflation of Japan</p>
</dd>
<dt><code>LUXEMBOURG</code></dt><dd><p>inflation of Luxembourg</p>
</dd>
<dt><code>NETHERLANDS</code></dt><dd><p>inflation of Netherlands</p>
</dd>
<dt><code>NORWAY</code></dt><dd><p>inflation of Norway</p>
</dd>
<dt><code>PORTUGAL</code></dt><dd><p>inflation of Portugal</p>
</dd>
<dt><code>SPAIN</code></dt><dd><p>inflation of Spain</p>
</dd>
<dt><code>SWEDEN</code></dt><dd><p>inflation of Sweden</p>
</dd>
<dt><code>SWITZERLAND</code></dt><dd><p>inflation of Switzerland</p>
</dd>
<dt><code>UK</code></dt><dd><p>inflation of UK</p>
</dd>
<dt><code>USA</code></dt><dd><p>inflation of USA</p>
</dd>
</dl>



<h3>Details</h3>

<p>Monthly CIP, seasonaly differenced of log CPI of 19 countries
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(inf19)
head(inf19)
</code></pre>

<hr>
<h2 id='interpolpval'>
Extracting critical value and p-value from Table 1 of Hylleberg et. al (1990)
</h2><span id='topic+interpolpval'></span>

<h3>Description</h3>

<p>Hylleberg et. al (1990,pp.226-227) offer simulated critical values for seasonal unitr  to test. interpolpval() is an internal call and should not be used independently.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interpolpval(code, stat, N, swarn = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interpolpval_+3A_code">code</code></td>
<td>

<p>Type of HEGY model, this will be automatically identified.
</p>
</td></tr>
<tr><td><code id="interpolpval_+3A_stat">stat</code></td>
<td>

<p>Empirical test statistics.
</p>
</td></tr>
<tr><td><code id="interpolpval_+3A_n">N</code></td>
<td>

<p>Sample size calculating stat above.
</p>
</td></tr>
<tr><td><code id="interpolpval_+3A_swarn">swarn</code></td>
<td>

<p>Logical. Whether the warning message for negative p-value will be returned? The default is TRUE.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>table</code></td>
<td>
<p>Table for critical value and p-value.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ho Tsung-wu &lt;tsungwu@ntnu.edu.tw&gt;, modifed from Javier Lopez-de-Lacalle
</p>


<h3>References</h3>

<p>Hylleberg, S., Engle, R.F., Granger, C.W.J., and Yoo, B.S.(1990) Seasonal integration and cointegration. Journal of Econometrics,44, 215-238.<br />
Javier Lopez-de-Lacalle in https://github.com/cran/uroot/blob/master/R/hegy.R
</p>

<hr>
<h2 id='invest'>
investment data of 565 listed companies, 1973-1987
</h2><span id='topic+invest'></span>

<h3>Description</h3>

<p>investment data of 565 listed companies, 1973-1987, from Hansen's example
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(invest)
</code></pre>


<h3>Format</h3>

<p>A pooled data frame
</p>

<dl>
<dt><code>invest[,1]</code></dt><dd><p>investment/assets</p>
</dd>
<dt><code>invest[,2]</code></dt><dd><p>Tobin's Q</p>
</dd>
<dt><code>invest[,3]</code></dt><dd><p>cash-flow/assets</p>
</dd>
<dt><code>invest[,4]</code></dt><dd><p>debt/assets</p>
</dd>
</dl>



<h3>Details</h3>

<p>This is a pooled data frame, without date (T) and cross-section(N) ID    
columes </p>


<h3>Examples</h3>

<pre><code class='language-R'>#data(invest)
#head(invest)
</code></pre>

<hr>
<h2 id='ipsHEGY'>
IPS-HEGY seasonal unit root test in panel data, Otero et al.(2007).
</h2><span id='topic+ipsHEGY'></span>

<h3>Description</h3>

<p>This function performs panel data-based HEGY seasonal unit root test, the asymptotics is based upon Otero et al.(2007).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipsHEGY(data, itsd, Sel, pmax, CIPS = TRUE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ipsHEGY_+3A_data">data</code></td>
<td>

<p>Panel data, T by N
</p>
</td></tr>
<tr><td><code id="ipsHEGY_+3A_itsd">itsd</code></td>
<td>
<p>Options for c(i,t,sd).<br /> 
i=1, intercept;=0 no intercept.<br />
t=1, trend;=0 no deterministic trend.<br />
sd=1, season dummy 1:(s-1);=0 no.
</p>
</td></tr>
<tr><td><code id="ipsHEGY_+3A_sel">Sel</code></td>
<td>

<p>Selection of lags, having three options: &quot;signf&quot;,&quot;bic&quot;,&quot;aic&quot;.
</p>
</td></tr>  <tr><td><code id="ipsHEGY_+3A_pmax">pmax</code></td>
<td>

<p>Maximum number of lags for searching optimal criteria.
</p>
</td></tr>
<tr><td><code id="ipsHEGY_+3A_cips">CIPS</code></td>
<td>

<p>Logical. If TRUE, using Pesaran(2007) to account for cross-section correlation. The default is TRUE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Mode for selectlags has three options, AIC and BIC use R built-in functions for linear model and their meanings are popular and straightforward. &quot;signf&quot; includes only statistically significant lags, and statistically insignificant lags are dropped from regressors. That is, once you select this option, lags of your model may not be continuous.<br />
The critical values for panel HEGY are standard normal for individual t-ratios, however,you need to perform simulation for the critical values of F joint test, at pdR 1.3. To this end, you are encouraged to work this out for yourself: using arima.sim() to sample seasonal time series with unit root (1-order difference) and obtain their statistics under the null using ipsHEGY(), then it is streightforward to obtain critical values.<br />
Otero et al. (2007) provide critical values for quarterly frequency.
</p>


<h3>Value</h3>

<table>
<tr><td><code>P_HEGY</code></td>
<td>
<p>Panel HEGY statistics.</p>
</td></tr>
<tr><td><code>U_HEGY</code></td>
<td>
<p>Idividual HEGY statistics of N units.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ho Tsung-wu &lt;tsungwu@ntnu.edu.tw&gt;, College of Management, National Taiwan Normal University.
</p>


<h3>References</h3>

<p>Otero, J., Smith, J., and Giulietti, M. (2005) Testing for seasonal unit roots in heterogeneous panels. Economics Letters,  86, 229-235.<br />
Otero, J., Smith, J., and Giulietti, M. (2007) Testing for seasonal unit roots in heterogeneous panels in the presence of cross section dependence. Economics Letters, 86, 179-184.<br />
Pesaran M. Hashem (2007) A simple panel unit root test in the presence of cross-section dependence.  Journal of Applied Econometrics, 22, 265-312.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(inf_Q)
dataz&lt;-inf_Q
itsd&lt;-c(1,0,c(1:3))
#Seasonal dummy only takes quarters 1:3, 
#becasue of the presence of common intercept.
Sel&lt;-"bic" # "aic","bic", "signf".
pmax&lt;-12

OUT&lt;-ipsHEGY(dataz,itsd,Sel,pmax,CIPS=FALSE)
OUT$P_HEGY
OUT$U_HEGY

# Simulation of critical values





</code></pre>

<hr>
<h2 id='lagSelect'>Select the optimal number of lags, given criteria</h2><span id='topic+lagSelect'></span>

<h3>Description</h3>

<p>Determine the optimal number of lags for dynamic regression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lagSelect(y, maxp, ic)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lagSelect_+3A_y">y</code></td>
<td>
<p>A univariate time series data</p>
</td></tr>
<tr><td><code id="lagSelect_+3A_maxp">maxp</code></td>
<td>
<p>the max number of lags</p>
</td></tr>
<tr><td><code id="lagSelect_+3A_ic">ic</code></td>
<td>
<p>Information criteria, either &quot;AIC&quot; or &quot;BIC&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Information criteria &quot;AIC&quot; and &quot;BIC&quot; use the R built-in functions.
</p>


<h3>Value</h3>

<p>It returns an integer, indicating the optimal lags
</p>


<h3>Author(s)</h3>

<p>Ho Tsung-wu &lt;tsungwu@ntnu.edu.tw&gt;, College of Management, National Taiwan Normal University.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#library(pdR)
#data(inf19)
#y&lt;-inf19[,1]
#lagSelect(y,maxp=25,ic="BIC")
</code></pre>

<hr>
<h2 id='lookupCVtable'>
Function for looking up tabulated critical values and associated p-values of HEGY test.
</h2><span id='topic+lookupCVtable'></span>

<h3>Description</h3>

<p>Function for looking up tabulated critical values and associated p-values,Hylleberg et. al (1990, Table 1a and Table 1b).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lookupCVtable(code)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lookupCVtable_+3A_code">code</code></td>
<td>

<p>Type of HEGY model, this will be automatically identified.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>table</code></td>
<td>
<p>Table for critical value and p-value.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ho Tsung-wu &lt;tsungwu@ntnu.edu.tw&gt;, modifed from Javier Lopez-de-Lacalle
</p>


<h3>References</h3>

<p>Hylleberg, S., Engle, R.F., Granger, C.W.J., and Yoo, B.S.(1990) Seasonal integration and cointegration. Journal of Econometrics,44, 215-238.<br />
Javier Lopez-de-Lacalle in https://github.com/cran/uroot/blob/master/R/hegy.R
</p>

<hr>
<h2 id='model'>Estimate specified panel threshold model
</h2><span id='topic+model'></span>

<h3>Description</h3>

<p>This function is the main function estimating threshold regression for function ptm()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model(r, trim, rep, it, qq1, cf, xt, ct, thresh, tt, qn1, n, qn, cc, yt, ty, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_+3A_r">r</code></td>
<td>
<p>vector of threshold estimate(s).
</p>
</td></tr>
<tr><td><code id="model_+3A_trim">trim</code></td>
<td>
<p>value of trimmed percentage.
</p>
</td></tr>
<tr><td><code id="model_+3A_rep">rep</code></td>
<td>
<p>number bootstrap repetition.
</p>
</td></tr>
<tr><td><code id="model_+3A_it">it</code></td>
<td>
<p>number of regime during computation, used in a for loop.
</p>
</td></tr>
<tr><td><code id="model_+3A_qq1">qq1</code></td>
<td>
<p> defined parameter.
</p>
</td></tr>
<tr><td><code id="model_+3A_cf">cf</code></td>
<td>
<p>special declaration, e.g. lag().
</p>
</td></tr>
<tr><td><code id="model_+3A_xt">xt</code></td>
<td>
<p>regime independent variables.
</p>
</td></tr>
<tr><td><code id="model_+3A_ct">ct</code></td>
<td>
<p>trace of regime dependent variables.
</p>
</td></tr>
<tr><td><code id="model_+3A_thresh">thresh</code></td>
<td>
<p>threshold variable.
</p>
</td></tr>
<tr><td><code id="model_+3A_tt">tt</code></td>
<td>
<p>length of time period.
</p>
</td></tr>
<tr><td><code id="model_+3A_qn1">qn1</code></td>
<td>
<p>as defined by nrow(qq1).
</p>
</td></tr>
<tr><td><code id="model_+3A_n">n</code></td>
<td>
<p>number of cross-section units.
</p>
</td></tr>
<tr><td><code id="model_+3A_qn">qn</code></td>
<td>
<p>number of quantiles to examine.
</p>
</td></tr>
<tr><td><code id="model_+3A_cc">cc</code></td>
<td>
<p>as defined by 2*log(1-sqrt(conf_lev)).
</p>
</td></tr>
<tr><td><code id="model_+3A_yt">yt</code></td>
<td>
<p>vectorized dependent variable.
</p>
</td></tr>
<tr><td><code id="model_+3A_ty">ty</code></td>
<td>
<p>trace of yt.
</p>
</td></tr>
<tr><td><code id="model_+3A_k">k</code></td>
<td>
<p>number of regime-independent independent variables.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Original code offered by Dr. B. E.Hansen (http://www.ssc.wisc.edu/~bhansen/). 
</p>


<h3>References</h3>

<p>Hanse B. E. (1999) Threshold effects in non-dynamic panels: Estimation, testing and inference. Journal of Econometrics,93, 345-368.
</p>

<hr>
<h2 id='pIGF'>Panel unit root test of Chang(2002)</h2><span id='topic+pIGF'></span>

<h3>Description</h3>

<p>Compute the panel unit root test statistic of Chang(2002).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pIGF(datamat, maxp, ic, spec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pIGF_+3A_datamat">datamat</code></td>
<td>
<p>T by N panel data.T is the time length,N is the number of cross-section units.
</p>
</td></tr>
<tr><td><code id="pIGF_+3A_maxp">maxp</code></td>
<td>
<p>the max number of lags
</p>
</td></tr>
<tr><td><code id="pIGF_+3A_ic">ic</code></td>
<td>
<p>Information criteria, either &quot;AIC&quot; or &quot;BIC&quot;.
</p>
</td></tr>
<tr><td><code id="pIGF_+3A_spec">spec</code></td>
<td>
<p>model specification.<br />
=0, no intercept and trend.<br />
=1, intercept only.<br />
=2, intercept and trend.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function estimates the panel unit root test based on univariate instrument generating function of (Chang,2002).
</p>


<h3>Value</h3>

<table>
<tr><td><code>panel.tstat</code></td>
<td>
<p> panel IGF test statistics </p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p> P-value of the panel.tstat </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ho Tsung-wu &lt;tsungwu@ntnu.edu.tw&gt;, College of Management, National Taiwan Normal University.</p>


<h3>References</h3>

<p>Chang,Y.(2002) Nonlinear IV Unit Root Tests in Panels with Cross-Sectional Dependency. Journal of Econometrics, 110, 261-292.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(inf19)
datam &lt;- inf19
pIGF(datam,maxp=25,ic="BIC",spec=2)
</code></pre>

<hr>
<h2 id='productivity'>
Productivity data of 48 US state,1970-1986 
</h2><span id='topic+productivity'></span>

<h3>Description</h3>

<p>Gross state production data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(productivity)
</code></pre>


<h3>Format</h3>

<p>A data frame with US production
</p>

<dl>
<dt>state</dt><dd><p>US state index, 1-48
</p>
</dd>
<dt>year</dt><dd><p>Year index
</p>
</dd>
<dt>y_gsp</dt><dd><p> Gross state product
</p>
</dd>
<dt>x1_hwy</dt><dd><p>Expediture of public utility- highway construction
</p>
</dd>
<dt>x2_water</dt><dd><p>Expediture of public utility- water
</p>
</dd>
<dt>x3_other</dt><dd><p>Expediture of others</p>
</dd>
<dt>x4_private</dt><dd><p>Private consumption of each state</p>
</dd>
<dt>x5_emp</dt><dd><p>Employment rate of each state</p>
</dd>
<dt>x6_unemp</dt><dd><p>Unemployment rate of each state</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(productivity)
head(productivity)
</code></pre>

<hr>
<h2 id='ptm'>Threshold specification of panel data
</h2><span id='topic+ptm'></span>

<h3>Description</h3>

<p>A generalized specification for estimating panel threshold model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ptm(dep, ind1, ind2, d, bootn, trimn, qn, conf_lev, t, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ptm_+3A_dep">dep</code></td>
<td>

<p>Dependent variable
</p>
</td></tr>
<tr><td><code id="ptm_+3A_ind1">ind1</code></td>
<td>

<p>Independent variables: regime dependent 
</p>
</td></tr>
<tr><td><code id="ptm_+3A_ind2">ind2</code></td>
<td>

<p>Independent variables:regime independent
</p>
</td></tr>
<tr><td><code id="ptm_+3A_d">d</code></td>
<td>

<p>Threshold variable
</p>
</td></tr>
<tr><td><code id="ptm_+3A_bootn">bootn</code></td>
<td>

<p>Vector of bootstrap repetition
</p>
</td></tr>
<tr><td><code id="ptm_+3A_trimn">trimn</code></td>
<td>

<p>Vector of trimmed percentage
</p>
</td></tr>
<tr><td><code id="ptm_+3A_qn">qn</code></td>
<td>

<p>Number of quantiles to examine
</p>
</td></tr>
<tr><td><code id="ptm_+3A_conf_lev">conf_lev</code></td>
<td>

<p>Confidence level
</p>
</td></tr>
<tr><td><code id="ptm_+3A_t">t</code></td>
<td>

<p>Length of time period
</p>
</td></tr>
<tr><td><code id="ptm_+3A_n">n</code></td>
<td>

<p>Number of cross-section units
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This code fits only balanced panel data. It generalizes the simple code of Dr. Hansen (http://www.ssc.wisc.edu/~bhansen/), allowing multiple (more-than-one) regime-dependent (ind1) variables. We generalize the original code to better fit general need of threshold modeling in panel data. <br />
bootn and trimn are vector of 3 by 1, indicating numbers of three corresponding regimes.<br />
This version corrects a slight error incurred by argument max_lag, which is used by Hansen to arrange investment data via lags. In this package, users manipulate data to fit personal research to ptm(), hence this argument is omitted lest should degree of freedom will suffer a loss of N.
</p>


<h3>Author(s)</h3>

<p>Ho Tsung-wu &lt;tsungwu@ntnu.edu.tw&gt;, College of Management, National Taiwan Normal University.
</p>


<h3>References</h3>

<p>Hansen B. E. (1999) Threshold effects in non-dynamic panels: Estimation, testing and inference. Journal of Econometrics,93, 345-368.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># library(pdR)
#data(invest)
#dat&lt;-invest[1:1500,]    # subsetting the first 1500 obs., #for simplicity
#t &lt;- 15            #Length of time period
#nt &lt;- nrow(dat)
#n &lt;- nt/t           # number of cross-section units

#dep&lt;- as.matrix(dat[,1])       # investment/assets
#th1&lt;- as.matrix(dat[,2])  #Tobin's Q
#th2&lt;- as.matrix(dat[,3])  # cash-flow/assets
#ind1&lt;- cbind(th1,th2)  #regime-dep covariates 
#d &lt;- as.matrix(dat[,4])      # Threshold variable      
#ind2 &lt;- cbind((th1^2),(th1^3),(th1*d)) # regime-indep covariates:
#bootn&lt;-c(100,200,300)  # bootstrapping replications for each  threshold esitmation
#trimn&lt;-c(0.05,0.05,0.05)   #trimmed percentage for each threshold  esitmation

#qn&lt;-400
#conf_lev&lt;-0.95

#Output=ptm(dep,ind1,ind2,d,bootn,trimn,qn,conf_lev,t,n)
#Output[[1]] #Formatted output of 1st threshold, 2 regimes
#Output[[2]] #Formatted output of 2nd threshold, 3 regimes
#Output[[3]] #Formatted output of 3rd threshold, 4 regimes

# In the output, the Regime-dependent Coefficients matrix
# is, from top to bottom, regime-wise.
</code></pre>

<hr>
<h2 id='r_est'>A subroutine for model()
</h2><span id='topic+r_est'></span>

<h3>Description</h3>

<p>This function is a subroutine for model(), estimation procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>r_est(y, r, trim, tt, qq1, qn1, qn, n, cf, xt, ct, thresh)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="r_est_+3A_y">y</code></td>
<td>
<p>vector of dependent variable.
</p>
</td></tr>
<tr><td><code id="r_est_+3A_r">r</code></td>
<td>
<p>numer of regime. 
</p>
</td></tr>
<tr><td><code id="r_est_+3A_trim">trim</code></td>
<td>
<p>value of trimmed percentage.
</p>
</td></tr>
<tr><td><code id="r_est_+3A_tt">tt</code></td>
<td>
<p>length of time period.
</p>
</td></tr>
<tr><td><code id="r_est_+3A_qq1">qq1</code></td>
<td>
<p>parameter defined by as.matrix(unique(thresh)[floor(sq*nrow(as.matrix(sort(unique(thresh)))))]).
</p>
</td></tr>
<tr><td><code id="r_est_+3A_qn1">qn1</code></td>
<td>
<p>as defined by nrow(qq1).
</p>
</td></tr>
<tr><td><code id="r_est_+3A_qn">qn</code></td>
<td>
<p>number of quantiles to examine.
</p>
</td></tr>
<tr><td><code id="r_est_+3A_n">n</code></td>
<td>
<p>parameter of cross-section units.
</p>
</td></tr>
<tr><td><code id="r_est_+3A_cf">cf</code></td>
<td>
<p>special declaration, e.g. lag().
</p>
</td></tr>
<tr><td><code id="r_est_+3A_xt">xt</code></td>
<td>
<p>regime independent variables.
</p>
</td></tr>
<tr><td><code id="r_est_+3A_ct">ct</code></td>
<td>
<p>trace of regime dependent variables.
</p>
</td></tr>
<tr><td><code id="r_est_+3A_thresh">thresh</code></td>
<td>
<p>threshold variable.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hanse B. E. (1999) Threshold effects in non-dynamic panels: Estimation, testing and inference. Journal of Econometrics,93, 345-368.
</p>
<p>Original code from Dr. Hansen (http://www.ssc.wisc.edu/~bhansen/).
</p>

<hr>
<h2 id='ret'>
Returns a data.frame of sequential lag matrix.
</h2><span id='topic+ret'></span>

<h3>Description</h3>

<p>ret() is similar to embed(), but returns a data.frame specified with colnames, not matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ret(wts, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ret_+3A_wts">wts</code></td>
<td>

<p>Univariate time series.
</p>
</td></tr>
<tr><td><code id="ret_+3A_k">k</code></td>
<td>

<p>k-1 lagged terms. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>ret() is similar to embed(), but returns a data.frame with colnames, not matrix.  Moreover, unlike embed(),ret() fills lagged cells with NA, instead of trimming them.
</p>


<h3>Value</h3>

<p>A T by k dataframe returns. If you need 2 lags, you have to specify k=3, then it returns a dataframe with T by 3 dataframe, the first column is lag0.
</p>


<h3>Author(s)</h3>

<p>Ho Tsung-wu &lt;tsungwu@ntnu.edu.tw&gt;, modifed from Javier Lopez-de-Lacalle
</p>


<h3>References</h3>

<p>Javier Lopez-de-Lacalle in https://github.com/cran/uroot/blob/master/R/hegy.R 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(inf_Q)
y=inf_Q[,2]
ret(y,3)
</code></pre>

<hr>
<h2 id='SeasComponent'>
Generate a data matrix of seasonal components
</h2><span id='topic+SeasComponent'></span>

<h3>Description</h3>

<p>Generate a data matrix of seasonal components, having two pattern cycles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SeasComponent(wts, type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SeasComponent_+3A_wts">wts</code></td>
<td>

<p>A univeriate time series with monthly or quarterly frequency.
</p>
</td></tr>
<tr><td><code id="SeasComponent_+3A_type">type</code></td>
<td>
<p>Types of patterns of seasonal cycle.<br />
=&quot;dummyCycle&quot;, generating dummy variables for the pattern of seasonal cycle, Barsky &amp; Miron (1989)<br />
=&quot;trgCycle&quot;, generating trigonometric variables for the pattern of seasonal cycle, Granger &amp; Newbold (1986).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates data matrix for controlling the pattern of seasonal cycles. type=&quot;dummyCycle&quot; generates DUMMY variables with season frequency. type=&quot;trgCycle&quot; generates trigonometric pattern.  
</p>


<h3>Value</h3>

<p>A dataframe returns. Number of columns is determined by frequency.
</p>


<h3>Author(s)</h3>

<p>Ho Tsung-wu &lt;tsungwu@ntnu.edu.tw&gt;, modifed from Javier Lopez-de-Lacalle
</p>


<h3>References</h3>

<p>Barsky, Robert B. and Jeffrey A. Miron (1989) The Seasonal Cycle and the Business Cycle. Journal of Political Economy, 97 (3): 503-32.<br />
Granger, Clive William John and Newbold, Paul (1986) Forecasting Economic Time Series. 2nd edition. Published by New Milford, Connecticut, U.S.A.: Emerald Group Pub Ltd.<br />
Javier Lopez-de-Lacalle in https://github.com/cran/uroot/blob/master/R/hegy.R 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(inf_Q)
y=inf_Q[,2]
SeasComponent(y,type="dummyCycle")
SeasComponent(y,type="trgCycle")
</code></pre>

<hr>
<h2 id='selPabic'>
Selection of lags.
</h2><span id='topic+selPabic'></span>

<h3>Description</h3>

<p>Lagged coefficient estimates are kept if they meet the inequality condition of AIC or BIC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selPabic(lmdet, type, Pmax = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="selPabic_+3A_lmdet">lmdet</code></td>
<td>

<p>Object of lm()
</p>
</td></tr>
<tr><td><code id="selPabic_+3A_type">type</code></td>
<td>
<p>Take the value of &quot;aic&quot; or &quot;bic&quot;.
</p>
</td></tr>
<tr><td><code id="selPabic_+3A_pmax">Pmax</code></td>
<td>

<p>The maximum number of lag orders.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an internal function used for HEGY.test().  Beginning with pamx, the lag order will be drop  if its inclusion worsens the minimum condition. Hence, they may not be a regular sequence.  For example, for pmax=10, the selected lags may look like (1,4,5,8,9), rather than 1,2,3,...10.
</p>


<h3>Value</h3>

<p>This function returns the lag orders.
</p>


<h3>Author(s)</h3>

<p>Ho Tsung-wu &lt;tsungwu@ntnu.edu.tw&gt;, modifed from Javier Lopez-de-Lacalle
</p>


<h3>References</h3>

<p>Javier Lopez-de-Lacalle in https://github.com/cran/uroot/blob/master/R/hegy.R 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(inf_Q)
y=inf_Q[,1]
hegy.out&lt;-HEGY.test(wts=y, itsd=c(1,0,c(1:3)),regvar=0, selectlags=list(mode="aic", Pmax=12))
hegy.out$lagsorder
hegy.out$lagcoefs
</code></pre>

<hr>
<h2 id='selPsignf'>
Selection of lags.
</h2><span id='topic+selPsignf'></span>

<h3>Description</h3>

<p>Lagged coefficient estimates are kept if they are statistically significant
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selPsignf(lmdet, cvref = 1.65, Pmax = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="selPsignf_+3A_lmdet">lmdet</code></td>
<td>

<p>Object of lm()
</p>
</td></tr>
<tr><td><code id="selPsignf_+3A_cvref">cvref</code></td>
<td>

<p>Reference of critical values, the default is 1.65.
</p>
</td></tr>
<tr><td><code id="selPsignf_+3A_pmax">Pmax</code></td>
<td>

<p>The maximum number of lag orders.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an internal function used for HEGY.test().   Beginning with pamx, the lag order will be kept if it is  statistically significant. Hence, the lag orders may not be a regular sequence.  For example, for pmax=10, the seelcted lags may look like (1,4,5,8,9), rather than 1,2,3,...10.
</p>


<h3>Value</h3>

<p>This function returns the lag orders.
</p>


<h3>Author(s)</h3>

<p>Ho Tsung-wu &lt;tsungwu@ntnu.edu.tw&gt;, modifed from Javier Lopez-de-Lacalle
</p>


<h3>References</h3>

<p>Javier Lopez-de-Lacalle in https://github.com/cran/uroot/blob/master/R/hegy.R 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(inf_Q)
y=inf_Q[,1]
hegy.out&lt;-HEGY.test(wts=y, itsd=c(1,0,c(1:3)),regvar=0, selectlags=list(mode="signf", Pmax=12))
hegy.out$lagsorder
hegy.out$lagcoefs
</code></pre>

<hr>
<h2 id='ship'>
Panel data on the number of ship accidents
</h2><span id='topic+ship'></span>

<h3>Description</h3>

<p>Panel data on the number of ship accidents, McCullagh and
Nelder(1989)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ship")</code></pre>


<h3>Format</h3>


<dl>
<dt><code>accident</code></dt><dd><p>the number of ship accidents</p>
</dd>
<dt><code>ship</code></dt><dd><p>Ship iD</p>
</dd>
<dt><code>service</code></dt><dd><p>the number of months in service</p>
</dd>
<dt><code>op_75_79</code></dt><dd><p>the operating period between 1975 and 1979</p>
</dd>
<dt><code>co_65_69</code></dt><dd><p>consecutive construction periods of 5 years</p>
</dd>
<dt><code>co_70_74</code></dt><dd><p>consecutive construction periods of 5 years</p>
</dd>
<dt><code>co_75_79</code></dt><dd><p>consecutive construction periods of 5 years</p>
</dd>
<dt><code>yr_con</code></dt><dd><p>years of construction</p>
</dd>
<dt><code>yr_op</code></dt><dd><p>years of operation</p>
</dd>
</dl>



<h3>References</h3>

<p>McCullagh, P., and J. A. Nelder (1989) Generalized Linear Models. 2nd ed. London: Chapman and Hall/CRC.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ship)
</code></pre>

<hr>
<h2 id='SMPLSplit_est'>Estimation of sub-sampled data
</h2><span id='topic+SMPLSplit_est'></span>

<h3>Description</h3>

<p>A function for estimating the subsampled data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SMPLSplit_est(data,dep,indep,th,plot,h=1,nonpar=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SMPLSplit_est_+3A_data">data</code></td>
<td>

<p>the data in either data.frame or matrix.  
</p>
</td></tr>
<tr><td><code id="SMPLSplit_est_+3A_dep">dep</code></td>
<td>

<p>the name of dependent variable.
</p>
</td></tr>
<tr><td><code id="SMPLSplit_est_+3A_indep">indep</code></td>
<td>

<p>the name(s) of independent variable(s). 
</p>
</td></tr>
<tr><td><code id="SMPLSplit_est_+3A_th">th</code></td>
<td>

<p>the name of threshold variable.
</p>
</td></tr>
<tr><td><code id="SMPLSplit_est_+3A_plot">plot</code></td>
<td>

<p>=1, plot; =0, do not plot.
</p>
</td></tr>
<tr><td><code id="SMPLSplit_est_+3A_h">h</code></td>
<td>

<p>h=1, heteroskedasticity-consistent covariance; h=0, homoskedastic case. 
</p>
</td></tr>
<tr><td><code id="SMPLSplit_est_+3A_nonpar">nonpar</code></td>
<td>

<p>Indicator for non-parametric method used to estimate nuisance scale in the presence of
heteroskedasticity (only relevant if h=1).Set nonpar=1 to estimate regressions using
a quadratic.Set nonpar=2 to estimate regressions using an Epanechnikov kernel with automatic bandwidth.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This code estimates the parameters of sub-sampled data. It generalizes the simple code of Dr. Hansen, allowing White Corrected Heteroskedastic Errors.
</p>


<h3>Value</h3>

<table>
<tr><td><code>threshold</code></td>
<td>
<p>values of threshold estimates.</p>
</td></tr>
<tr><td><code>est0</code></td>
<td>
<p>coefficient estimates of global data.</p>
</td></tr>
<tr><td><code>est.low</code></td>
<td>
<p>coefficient estimates of low regime.</p>
</td></tr>
<tr><td><code>est.high</code></td>
<td>
<p>coefficient estimates of high regime.</p>
</td></tr>
<tr><td><code>est0.info</code></td>
<td>
<p>additional information of global data.</p>
</td></tr>
<tr><td><code>est.joint.info</code></td>
<td>
<p>additional information of joint threshods.</p>
</td></tr>
<tr><td><code>est.low.info</code></td>
<td>
<p>additional information of est.low.</p>
</td></tr>
<tr><td><code>est.high.info</code></td>
<td>
<p>additional information of est.high.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Original code offered by Dr. B. E.Hansen (http://www.ssc.wisc.edu/~bhansen/). 
</p>


<h3>References</h3>

<p>Hanse B. E. (2000) Sample Splitting and Threshold Estimation. Econometrica, 68, 575-603.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run, becasue of bootstrap replicaiton takes time. Users may unmark # and run. 
data("dur_john")
rep &lt;- 500
trim_per &lt;- 0.15
dep &lt;- "gdpGrowth"
indep &lt;- colnames(dur_john)[c(2,3,4,5)]

SMPLSplit_est(data=dur_john,dep,indep,th="GDP60",plot=0,h=1,nonpar=2)


</code></pre>

<hr>
<h2 id='SMPLSplit_example'>Example code for sample splitting
</h2><span id='topic+SMPLSplit_example'></span>

<h3>Description</h3>

<p>A sample code for learning sample splitting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SMPLSplit_example(data,dep,indep,th1,th2,trim_per,rep,plot)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SMPLSplit_example_+3A_data">data</code></td>
<td>

<p>the data in either data.frame or matrix. 
</p>
</td></tr>
<tr><td><code id="SMPLSplit_example_+3A_dep">dep</code></td>
<td>

<p>the name of dependent variable.
</p>
</td></tr>
<tr><td><code id="SMPLSplit_example_+3A_indep">indep</code></td>
<td>

<p>the name(s) of independent variable(s) 
</p>
</td></tr>
<tr><td><code id="SMPLSplit_example_+3A_th1">th1</code></td>
<td>

<p>the first threshold variable.
</p>
</td></tr>
<tr><td><code id="SMPLSplit_example_+3A_th2">th2</code></td>
<td>

<p>the second threshold variable.
</p>
</td></tr>
<tr><td><code id="SMPLSplit_example_+3A_trim_per">trim_per</code></td>
<td>

<p>trimmed percentage.
</p>
</td></tr>
<tr><td><code id="SMPLSplit_example_+3A_rep">rep</code></td>
<td>

<p>nNumber of bootstrap repetitions.
</p>
</td></tr>
<tr><td><code id="SMPLSplit_example_+3A_plot">plot</code></td>
<td>

<p>=1, plot; =0, do not plot.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This code is the learning example for learning Hansen's econometric sample splitting. I detailed the description of each threshold stage.  
</p>


<h3>Note</h3>

<p>Original code offered by Dr. B. E.Hansen (http://www.ssc.wisc.edu/~bhansen/). 
</p>


<h3>References</h3>

<p>Hanse B. E. (2000) Sample Splitting and Threshold Estimation. Econometrica, 68, 575-603.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run, becasue of bootstrap replicaiton takes time. Users may unmark # and run. 
data("dur_john")
#rep &lt;- 500
#trim_per &lt;- 0.15
#dep &lt;- "gdpGrowth"
#indep &lt;- colnames(dur_john)[c(2,3,4,5)]
#th1 &lt;- "GDP60"
#th2 &lt;- "Literacy"
#OUT=SMPLSplit_est(data=dur_john,dep,indep,th=th1,plot=0,h=1,nonpar=2)
#OUT$TEST
#OUT$Hypothesis
#OUT$Threshold
#stat=matrix(as.numeric(OUT$TEST),byrow = TRUE,8,2)
#colnames(stat)=c("F-Stat","P-value")
#rownames(stat)=OUT$Hypothesis
#stat

</code></pre>

<hr>
<h2 id='SMPLSplit_het'>Testing for sample splitting
</h2><span id='topic+SMPLSplit_het'></span>

<h3>Description</h3>

<p>A function for testing sample split given subsampled data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SMPLSplit_het(data,dep,indep,th,trim_per,rep,plot)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SMPLSplit_het_+3A_data">data</code></td>
<td>

<p>the data in either data.frame or matrix  
</p>
</td></tr>
<tr><td><code id="SMPLSplit_het_+3A_dep">dep</code></td>
<td>

<p>the name of dependent variable.
</p>
</td></tr>
<tr><td><code id="SMPLSplit_het_+3A_indep">indep</code></td>
<td>

<p>the name(s) of independent variable(s). 
</p>
</td></tr>
<tr><td><code id="SMPLSplit_het_+3A_th">th</code></td>
<td>

<p>the name of threshold variable.
</p>
</td></tr>
<tr><td><code id="SMPLSplit_het_+3A_trim_per">trim_per</code></td>
<td>

<p>trimmed percentage.
</p>
</td></tr>
<tr><td><code id="SMPLSplit_het_+3A_rep">rep</code></td>
<td>

<p>number of bootstrap repetition.
</p>
</td></tr>
<tr><td><code id="SMPLSplit_het_+3A_plot">plot</code></td>
<td>

<p>=1, plot; =0, do not plot.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This code tests for the presence of threshold. It generalizes the simple code of Dr. Hansen, allowing Heteroskedastic Errors (White Corrected). </p>


<h3>Value</h3>

<table>
<tr><td><code>fstat</code></td>
<td>
<p>LM-test for no threshold.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>bootstrap P-Value.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Original code offered by Dr. B. E.Hansen (http://www.ssc.wisc.edu/~bhansen/). 
</p>


<h3>References</h3>

<p>Hanse B. E. (2000) Sample Splitting and Threshold Estimation. Econometrica, 68, 575-603.
</p>

<hr>
<h2 id='sse_calc'>a subroutine of model()
</h2><span id='topic+sse_calc'></span>

<h3>Description</h3>

<p>SSE calculation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sse_calc(y, x)
</code></pre>


<h3>Arguments</h3>

<p>This function is a sub-routine for model(), calculating SSE of each regression
</p>
<table>
<tr><td><code id="sse_calc_+3A_y">y</code></td>
<td>
<p>vector of dependent variable.
</p>
</td></tr>
<tr><td><code id="sse_calc_+3A_x">x</code></td>
<td>
<p>matrix of independent variables.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hanse B. E. (1999) Threshold effects in non-dynamic panels: Estimation, testing and inference. Journal of Econometrics,93, 345-368.
</p>
<p>Original code from Dr. Hansen (http://www.ssc.wisc.edu/~bhansen/).
</p>

<hr>
<h2 id='tbar'>
Compute the resursive mean
</h2><span id='topic+tbar'></span>

<h3>Description</h3>

<p>Compute the resursive mean of each series
</p>


<h3>Usage</h3>

<pre><code class='language-R'> tbar(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tbar_+3A_x">x</code></td>
<td>
<p>A univariate time series data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the resursive mean
</p>


<h3>Author(s)</h3>

<p>Ho Tsung-wu &lt;tsungwu@ntnu.edu.tw&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(inf19)
y &lt;- inf19[,1]
tbar(y)

</code></pre>

<hr>
<h2 id='thr_sse'>a subroutine calculating SSE
</h2><span id='topic+thr_sse'></span>

<h3>Description</h3>

<p>This function is a sub-routine for model(), calculating SSE of each threshold regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thr_sse(y, q, r, cf, xt, ct, thresh, tt, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="thr_sse_+3A_y">y</code></td>
<td>
<p>parameter.
</p>
</td></tr>
<tr><td><code id="thr_sse_+3A_q">q</code></td>
<td>
<p>qq1 in model().
</p>
</td></tr>
<tr><td><code id="thr_sse_+3A_r">r</code></td>
<td>
<p>parameter.
</p>
</td></tr>
<tr><td><code id="thr_sse_+3A_cf">cf</code></td>
<td>
<p>as defined in model().
</p>
</td></tr>
<tr><td><code id="thr_sse_+3A_xt">xt</code></td>
<td>
<p>as defined in model().
</p>
</td></tr>
<tr><td><code id="thr_sse_+3A_ct">ct</code></td>
<td>
<p>as defined in model().
</p>
</td></tr>
<tr><td><code id="thr_sse_+3A_thresh">thresh</code></td>
<td>
<p>as defined in model().
</p>
</td></tr>
<tr><td><code id="thr_sse_+3A_tt">tt</code></td>
<td>
<p>as defined in model().
</p>
</td></tr>
<tr><td><code id="thr_sse_+3A_n">n</code></td>
<td>
<p>as defined in model().
</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hanse B. E. (1999) Threshold effects in non-dynamic panels: Estimation, testing and inference. Journal of Econometrics,93, 345-368.
</p>
<p>Original code from Dr. Hansen (http://www.ssc.wisc.edu/~bhansen/).
</p>

<hr>
<h2 id='tr'>A sub-routine calculating trace
</h2><span id='topic+tr'></span>

<h3>Description</h3>

<p> Estimation of trace.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> tr(y, tt, n)
</code></pre>


<h3>Arguments</h3>

<p>This function is a sub-routine for model(), calculating trace  of matrix
</p>
<table>
<tr><td><code id="tr_+3A_y">y</code></td>
<td>
<p>data vector.
</p>
</td></tr>
<tr><td><code id="tr_+3A_tt">tt</code></td>
<td>
<p>time period length.
</p>
</td></tr>
<tr><td><code id="tr_+3A_n">n</code></td>
<td>
<p>number of cross-section units.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hanse B. E. (1999) Threshold effects in non-dynamic panels: Estimation, testing and inference. Journal of Econometrics,93, 345-368.
</p>
<p>Original code from Dr. Hansen (http://www.ssc.wisc.edu/~bhansen/).
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
