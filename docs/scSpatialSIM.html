<!DOCTYPE html><html><head><title>Help for package scSpatialSIM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {scSpatialSIM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#CalculateDensity'><p>Compute Simulation Heatmaps</p></a></li>
<li><a href='#CreateSimulationObject'><p>Create a spatial simulation object.</p></a></li>
<li><a href='#CreateSpatialList'><p>Get Spatial Files from a <code>SpatSimObj</code></p></a></li>
<li><a href='#ExtractParameters'><p>Get Simulation Parameters</p></a></li>
<li><a href='#GenerateCellPositivity'><p>Generate Cell Positivity</p></a></li>
<li><a href='#GenerateDistributions'><p>Generate Characteristic Distributions of Cells</p></a></li>
<li><a href='#GenerateHoles'><p>Generate holes in a spatial simulation object</p></a></li>
<li><a href='#GenerateSpatialPattern'><p>Generate Spatial Point Pattern</p></a></li>
<li><a href='#GenerateTissue'><p>Generate Tissue</p></a></li>
<li><a href='#plot.SpatSimObj'><p>plot function for SpatSimObj</p></a></li>
<li><a href='#PlotSimulation'><p>Plot Simulation</p></a></li>
<li><a href='#SummariseSpatial'><p>Summarise Spatial</p></a></li>
<li><a href='#summary.SpatSimObj'><p>summary function for SpatSimObj</p></a></li>
<li><a href='#UpdateSimulationWindow'><p>Update the simulation window in a SpatSimObj</p></a></li>
<li><a href='#wm'><p>Round spatstat window</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>A Point Pattern Simulator for Spatial Cellular Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Single cell resolution data has been valuable in learning about tissue microenvironments and interactions between cells or spots. This package allows for the simulation of this level of data, be it single cell or ‘spots’, in both a univariate (single metric or cell type) and bivariate (2 or more metrics or cell types) ways. As more technologies come to marker, more methods will be developed to derive spatial metrics from the data which will require a way to benchmark methods against each other. Additionally, as the field currently stands, there is not a gold standard method to be compared against. We set out to develop an R package that will allow users to simulate point patterns that can be biologically informed from different tissue domains, holes, and varying degrees of clustering/colocalization. The data can be exported as spatial files and a summary file (like 'HALO'). <a href="https://github.com/FridleyLab/scSpatialSIM/">https://github.com/FridleyLab/scSpatialSIM/</a>.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, magrittr, spatstat.geom, crayon, ggpubr,
pbmcapply, spatstat.random, tidyr, utils, methods, proxy</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.00)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0), spatialTIME</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/FridleyLab/scSpatialSIM">https://github.com/FridleyLab/scSpatialSIM</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-19 18:02:34 UTC; 4471592</td>
</tr>
<tr>
<td>Author:</td>
<td>Alex Soupir [aut],
  Christopher Wilson [aut],
  Jordan Creed [aut],
  Julia Wrobel [aut],
  Oscar Ospina [aut],
  Brooke Fridley [aut, cph],
  Fridley Lab [cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Fridley Lab &lt;fridley.lab@moffitt.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-19 18:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code style="white-space: pre;">&#8288;magrittr::[\%&gt;\%][magrittr::pipe]&#8288;</code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='CalculateDensity'>Compute Simulation Heatmaps</h2><span id='topic+CalculateDensity'></span>

<h3>Description</h3>

<p>Compute Simulation Heatmaps
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalculateDensity(
  sim_object,
  steps = NULL,
  which = "all",
  step_size = 1,
  cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalculateDensity_+3A_sim_object">sim_object</code></td>
<td>
<p>object created with <code>CreateSimulationObject</code></p>
</td></tr>
<tr><td><code id="CalculateDensity_+3A_steps">steps</code></td>
<td>
<p>which simulation steps to compute heatmaps for (Tissue, Holes, Cells, or All)</p>
</td></tr>
<tr><td><code id="CalculateDensity_+3A_which">which</code></td>
<td>
<p>which simulation to compute it for</p>
</td></tr>
<tr><td><code id="CalculateDensity_+3A_step_size">step_size</code></td>
<td>
<p>resolution of heatmap</p>
</td></tr>
<tr><td><code id="CalculateDensity_+3A_cores">cores</code></td>
<td>
<p>number of cpu cores</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a new <code>SpatSimObj</code> with probability densities calculated
</p>

<hr>
<h2 id='CreateSimulationObject'>Create a spatial simulation object.</h2><span id='topic+CreateSimulationObject'></span>

<h3>Description</h3>

<p>This function creates a <code>SpatSimObj</code> for
spatial simulations. The object contains information about the
simulation window, the number of simulations to perform, and
lists of cells, Tissue1/Tissue2, holes, and spatial files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CreateSimulationObject(window = NULL, sims = NULL, cell_types = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CreateSimulationObject_+3A_window">window</code></td>
<td>
<p>An object of class <code>owin</code> representing the simulation
window. If <code>NULL</code>, defaults to a rectangular window of size (0,10)
in both x and y directions.</p>
</td></tr>
<tr><td><code id="CreateSimulationObject_+3A_sims">sims</code></td>
<td>
<p>The number of simulations to perform. If <code>NULL</code> or l
ess than 1, defaults to 3.</p>
</td></tr>
<tr><td><code id="CreateSimulationObject_+3A_cell_types">cell_types</code></td>
<td>
<p>The number of cell types. Defaults to 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The simulation window is represented by an object of class
<code>owin</code>, which specifies the extent and shape of the spatial
domain in which the simulations will be performed. If no window
is provided, the function creates a rectangular window of size
(0,10) in both x and y directions.
</p>
<p>The <code>sims</code> argument specifies the number of simulations to
perform. If it is set to <code>NULL</code> or less than 1, the function
defaults to 3.
</p>
<p>The <code>cell_types</code> argument specifies the number of cell
types to include in the simulation. By default, the function
creates a single cell type, represented by an object of class
<code>Cell</code>.
</p>
<p>The <code>SpatSimObj</code> is composed of the following classes:
</p>

<ul>
<li><p> A <code>Window</code> object of class <code>owin</code>.
</p>
</li>
<li><p> An integer <code>Sims</code> specifying the number of simulations to perform.
</p>
</li>
<li><p> A list of <code>Cells</code> of class <code>Cell</code>.
</p>
</li>
<li><p> A <code>Tissue</code> object of class <code>Tissue1/Tissue2</code>, representing the Tissue1/Tissue2 components of the simulation.
</p>
</li>
<li><p> A <code>Holes</code> object of class <code>Holes</code>, representing holes in the simulation.
</p>
</li>
<li><p> A list of <code>Spatial Files</code> containing any spatial data associated with the simulation.
</p>
</li></ul>



<h3>Value</h3>

<p>A <code>SpatSimObj</code> containing the simulation
window, the number of simulations to perform, and lists of cells,
Tissue1/Tissue2, holes, and spatial files.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>CreateSimulationObject()
</code></pre>

<hr>
<h2 id='CreateSpatialList'>Get Spatial Files from a <code>SpatSimObj</code></h2><span id='topic+CreateSpatialList'></span>

<h3>Description</h3>

<p>This function extracts the 'Spatial Files' slot from a Spatial Simulation Object
and removes probability columns while converting 'Positive' and 'Negative' in
cell assignment columns to 1 and 0, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CreateSpatialList(sim_object, single_df = FALSE, multihit_action = "random")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CreateSpatialList_+3A_sim_object">sim_object</code></td>
<td>
<p>A <code>SpatSimObj</code></p>
</td></tr>
<tr><td><code id="CreateSpatialList_+3A_single_df">single_df</code></td>
<td>
<p>boolean as to whether to collapse the output list of data frames to a single data frame or not. default is <code>FALSE</code></p>
</td></tr>
<tr><td><code id="CreateSpatialList_+3A_multihit_action">multihit_action</code></td>
<td>
<p>string of value 'random', 'drop', or 'keep' for cells that are positive for multiple cell assignments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output of this function creates a list of the spatial files formatted in a way
that would allow direct import into a mIF object from the package 'spatialTIME'
</p>


<h3>Value</h3>

<p>A list of data frames, one for each simulated cell type, with cleaned columns
</p>

<hr>
<h2 id='ExtractParameters'>Get Simulation Parameters</h2><span id='topic+ExtractParameters'></span>

<h3>Description</h3>

<p>Get Simulation Parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ExtractParameters(sim_object, steps = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ExtractParameters_+3A_sim_object">sim_object</code></td>
<td>
<p>simulation object created with <code><a href="#topic+CreateSimulationObject">CreateSimulationObject</a></code></p>
</td></tr>
<tr><td><code id="ExtractParameters_+3A_steps">steps</code></td>
<td>
<p>which parameters to extract from the <code>SpatSimObj</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function will return any paramters that are stored in the simulation object. If no simulation steps
have been run, then this will return the default parameters. The defaults are over written if new parameters
are provided at each step.
</p>


<h3>Value</h3>

<p>a list of S3 clas <code>SimParams</code> containing parameters stored in the <code>sim_object</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#create simulation object
sim_obj = CreateSimulationObject()
#extract default paramters for the Tissue simulation step
defs = ExtractParameters(sim_obj, "Tissue")
</code></pre>

<hr>
<h2 id='GenerateCellPositivity'>Generate Cell Positivity</h2><span id='topic+GenerateCellPositivity'></span>

<h3>Description</h3>

<p>Generate the probability of a cell being positive given a set of simulation parameters for each file in a SpatSimObj.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GenerateCellPositivity(
  sim_object,
  k = NA,
  xmin = NA,
  xmax = NA,
  ymin = NA,
  ymax = NA,
  sdmin = 1/2,
  sdmax = 2,
  probs = c(0, 1),
  Force = FALSE,
  density_heatmap = FALSE,
  step_size = 1,
  cores = 1,
  shift = 0,
  random = FALSE,
  overwrite = FALSE,
  use_window = FALSE,
  no_kernel = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GenerateCellPositivity_+3A_sim_object">sim_object</code></td>
<td>
<p>A <code>SpatSimObj</code> object containing the simulated data.</p>
</td></tr>
<tr><td><code id="GenerateCellPositivity_+3A_k">k</code></td>
<td>
<p>An integer specifying the number of clusters for each simulated patterns</p>
</td></tr>
<tr><td><code id="GenerateCellPositivity_+3A_xmin">xmin</code></td>
<td>
<p>A numeric value specifying the minimum x value for the kernel.</p>
</td></tr>
<tr><td><code id="GenerateCellPositivity_+3A_xmax">xmax</code></td>
<td>
<p>A numeric value specifying the maximum x value for the kernel.</p>
</td></tr>
<tr><td><code id="GenerateCellPositivity_+3A_ymin">ymin</code></td>
<td>
<p>A numeric value specifying the minimum y value for the kernel.</p>
</td></tr>
<tr><td><code id="GenerateCellPositivity_+3A_ymax">ymax</code></td>
<td>
<p>A numeric value specifying the maximum y value for the kernel.</p>
</td></tr>
<tr><td><code id="GenerateCellPositivity_+3A_sdmin">sdmin</code></td>
<td>
<p>A numeric value specifying the minimum standard deviation for the kernel.</p>
</td></tr>
<tr><td><code id="GenerateCellPositivity_+3A_sdmax">sdmax</code></td>
<td>
<p>A numeric value specifying the maximum standard deviation for the kernel.</p>
</td></tr>
<tr><td><code id="GenerateCellPositivity_+3A_probs">probs</code></td>
<td>
<p>Either a vector of c(low probability, high probability) for all cell types or data frame where each row
is the low and high probabilities for the cell type. If data frame, number of rows must equal number of cells</p>
</td></tr>
<tr><td><code id="GenerateCellPositivity_+3A_force">Force</code></td>
<td>
<p>A logical value indicating whether to force simulation parameters to be within the simulation window limits.</p>
</td></tr>
<tr><td><code id="GenerateCellPositivity_+3A_density_heatmap">density_heatmap</code></td>
<td>
<p>A logical value indicating whether to compute a density heatmap for each cell.</p>
</td></tr>
<tr><td><code id="GenerateCellPositivity_+3A_step_size">step_size</code></td>
<td>
<p>A numeric value specifying the step size for the grid of points within the window.</p>
</td></tr>
<tr><td><code id="GenerateCellPositivity_+3A_cores">cores</code></td>
<td>
<p>An integer value specifying the number of cores to use for parallel computation.</p>
</td></tr>
<tr><td><code id="GenerateCellPositivity_+3A_shift">shift</code></td>
<td>
<p>A value between 0 and 1 for how related a second or more cell type is to the first</p>
</td></tr>
<tr><td><code id="GenerateCellPositivity_+3A_random">random</code></td>
<td>
<p>whether or not to randomly generate kernels for cells 2 or more, uf TRUE, shift is not used</p>
</td></tr>
<tr><td><code id="GenerateCellPositivity_+3A_overwrite">overwrite</code></td>
<td>
<p>boolean whether to overwrite existing cell kernels and assignments if present</p>
</td></tr>
<tr><td><code id="GenerateCellPositivity_+3A_use_window">use_window</code></td>
<td>
<p>boolean whether to use the simulation window to set x and y limits</p>
</td></tr>
<tr><td><code id="GenerateCellPositivity_+3A_no_kernel">no_kernel</code></td>
<td>
<p>boolean whether to create kernels or to randomly assign points positive based on <code>probs</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function generates the probability of a cell being positive given a set of simulation parameters f
or each file in a <code>scSpatialSIM</code> object. It creates a kernel parameter list for <code>k</code> clusters
in each simulated pattern and computes the probability of each point in the grid of points within the
window for each cell. The function also computes a density heatmap for each cell if <code>density_heatmap</code> is set to <code>TRUE</code>.
</p>


<h3>Value</h3>

<p>Returns the original <code>scSpatialSIM</code> object with additional generated data added to each cell object.
</p>

<hr>
<h2 id='GenerateDistributions'>Generate Characteristic Distributions of Cells</h2><span id='topic+GenerateDistributions'></span>

<h3>Description</h3>

<p>Generate Characteristic Distributions of Cells
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GenerateDistributions(
  spatial_data,
  positive_mean = 10,
  negative_mean = 2,
  positive_sd = 2,
  negative_sd = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GenerateDistributions_+3A_spatial_data">spatial_data</code></td>
<td>
<p>object of either class <code>list</code> or <code>data.frame</code>. Can be created from <code>SpatSimObj</code> with <code><a href="#topic+CreateSpatialList">CreateSpatialList</a></code></p>
</td></tr>
<tr><td><code id="GenerateDistributions_+3A_positive_mean">positive_mean</code>, <code id="GenerateDistributions_+3A_negative_mean">negative_mean</code></td>
<td>
<p>number for mean of which to center the distribution of the positive and negative cell types.
Can be single number of vector with length matching number of Cells.</p>
</td></tr>
<tr><td><code id="GenerateDistributions_+3A_positive_sd">positive_sd</code>, <code id="GenerateDistributions_+3A_negative_sd">negative_sd</code></td>
<td>
<p>number for the standard deviation around the positive cell type mean. Can be single value or same length as number of Cells.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object with a class that is the same as input <code>spatial_data</code> with new columns containing distributions for positive/negative assigned cells
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#create simulation object
spatial_data = CreateSimulationObject(sims = 1, cell_types = 1) %&gt;%
  #produce the point pattern
  GenerateSpatialPattern() %&gt;%
  #make tissues
  GenerateTissue(density_heatmap = FALSE, step_size = 0.1, cores = 1) %&gt;%
  #create positive and negative cells
  GenerateCellPositivity(k = 4, sdmin = 3, sdmax = 5,
  density_heatmap = FALSE, step_size = 1, cores = 1, probs = c(0.0, 0.1), shift = 0) %&gt;%
  #convert to a list of spatial data frames
  CreateSpatialList(single_df = FALSE)
spat_data_distribution = GenerateDistributions(spatial_data)
</code></pre>

<hr>
<h2 id='GenerateHoles'>Generate holes in a spatial simulation object</h2><span id='topic+GenerateHoles'></span>

<h3>Description</h3>

<p>This function generates holes (regions of low probability) in a spatial simulation
object based on user-defined parameters. The function uses a kernel density
estimate to simulate holes, and returns a modified version of the input object
with the holes added. The function also has options to compute a density heatmap
and to assign points within the holes to be dropped or kept based on a scaled
probability value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GenerateHoles(
  sim_object,
  xmin = NA,
  xmax = NA,
  ymin = NA,
  ymax = NA,
  sdmin = 1/2,
  sdmax = 2,
  hole_prob = c(0.2, 0.35),
  force = FALSE,
  density_heatmap = FALSE,
  step_size = 1,
  cores = 1,
  overwrite = FALSE,
  use_window = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GenerateHoles_+3A_sim_object">sim_object</code></td>
<td>
<p>A spatial simulation object of class <code>SpatSimObj</code></p>
</td></tr>
<tr><td><code id="GenerateHoles_+3A_xmin">xmin</code></td>
<td>
<p>Minimum x-coordinate for the holes (default: NA)</p>
</td></tr>
<tr><td><code id="GenerateHoles_+3A_xmax">xmax</code></td>
<td>
<p>Maximum x-coordinate for the holes (default: NA)</p>
</td></tr>
<tr><td><code id="GenerateHoles_+3A_ymin">ymin</code></td>
<td>
<p>Minimum y-coordinate for the holes (default: NA)</p>
</td></tr>
<tr><td><code id="GenerateHoles_+3A_ymax">ymax</code></td>
<td>
<p>Maximum y-coordinate for the holes (default: NA)</p>
</td></tr>
<tr><td><code id="GenerateHoles_+3A_sdmin">sdmin</code></td>
<td>
<p>Minimum standard deviation for the kernels (default: 1/2)</p>
</td></tr>
<tr><td><code id="GenerateHoles_+3A_sdmax">sdmax</code></td>
<td>
<p>Maximum standard deviation for the kernels (default: 2)</p>
</td></tr>
<tr><td><code id="GenerateHoles_+3A_hole_prob">hole_prob</code></td>
<td>
<p>A vector of length 2 with the minimum and maximum probabilities of
a point being within a hole (default: c(0.2, 0.35))</p>
</td></tr>
<tr><td><code id="GenerateHoles_+3A_force">force</code></td>
<td>
<p>Logical; if TRUE, forces the function to simulate outside the window
boundaries (default: FALSE)</p>
</td></tr>
<tr><td><code id="GenerateHoles_+3A_density_heatmap">density_heatmap</code></td>
<td>
<p>Logical; if TRUE, computes a density heatmap (default: FALSE)</p>
</td></tr>
<tr><td><code id="GenerateHoles_+3A_step_size">step_size</code></td>
<td>
<p>The step size for the grid (default: 1)</p>
</td></tr>
<tr><td><code id="GenerateHoles_+3A_cores">cores</code></td>
<td>
<p>The number of cores to use for parallel processing (default: 1)</p>
</td></tr>
<tr><td><code id="GenerateHoles_+3A_overwrite">overwrite</code></td>
<td>
<p>boolean to replace holes if they have been simulated previously</p>
</td></tr>
<tr><td><code id="GenerateHoles_+3A_use_window">use_window</code></td>
<td>
<p>boolean whether to use the simulation window to set x and y limits</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function first checks that the input object is of the correct class,
and that no parameters are NULL. If any parameters are NULL, the function stops
with an error message. If the x- and y-ranges for the holes extend beyond the
boundaries of the simulation window, the function also stops with an error message,
unless the force parameter is set to TRUE. The function then produces kernel
parameter lists for each simulated pattern, and generates a grid based on the user-defined
step size. If density_heatmap is set to TRUE, the function computes a density heatmap
using the CalculateGrid function. Finally, the function computes hole probabilities
for each simulated pattern, assigns each point to be dropped or kept based on a
scaled probability value, and returns the modified simulation object.
</p>


<h3>Value</h3>

<p>A modified spatial simulation object with holes added
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim_object &lt;- CreateSimulationObject()

#simulate points
sim_object &lt;- GenerateSpatialPattern(sim_object, lambda = 20)

# Generate tissue with default parameters
sim_object &lt;- GenerateTissue(sim_object)

# Generate holes in the simulation object
sim_object &lt;- GenerateHoles(sim_object, hole_prob = c(0.1, 0.3), force = TRUE)

</code></pre>

<hr>
<h2 id='GenerateSpatialPattern'>Generate Spatial Point Pattern</h2><span id='topic+GenerateSpatialPattern'></span>

<h3>Description</h3>

<p>Generate a spatial point pattern within the simulation object's window using a Poisson point process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GenerateSpatialPattern(
  sim_object,
  lambda = 25,
  ...,
  overwrite = FALSE,
  gridded = FALSE,
  grid_shift = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GenerateSpatialPattern_+3A_sim_object">sim_object</code></td>
<td>
<p>A 'SpatSimObj' containing a window.</p>
</td></tr>
<tr><td><code id="GenerateSpatialPattern_+3A_lambda">lambda</code></td>
<td>
<p>The intensity of the point pattern Default is 25.</p>
</td></tr>
<tr><td><code id="GenerateSpatialPattern_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to 'rpoispp'.</p>
</td></tr>
<tr><td><code id="GenerateSpatialPattern_+3A_overwrite">overwrite</code></td>
<td>
<p>boolean indicating whether or not to replace point patterns if they exist in object</p>
</td></tr>
<tr><td><code id="GenerateSpatialPattern_+3A_gridded">gridded</code></td>
<td>
<p>boolean value to whether or not simulate the point pattern in a grid. See details for more.</p>
</td></tr>
<tr><td><code id="GenerateSpatialPattern_+3A_grid_shift">grid_shift</code></td>
<td>
<p>the amount to move alternative columns down when gridded; between -0.5 and 0.5</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates a spatial point process within the window of the 'sim_object'
using a Poisson point pattern with intensity 'lambda'. The simulated point pattern is added
to the 'Patterns' slot of the 'sim_object'. Additional arguments can be passed to the 'rpoispp' function.
</p>
<p>The <code>gridded</code> parameter is used for simulating point patterns that would represent som spatial transcriptomic
technologies such as visium, where rather than like cell being randomly distributed in a sample, the spots where
data is measured is evenly spaced.
</p>


<h3>Value</h3>

<p>The updated 'sim_object' with a simulated point process added to the 'Processes' slot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim_object &lt;- CreateSimulationObject()
sim_object &lt;- GenerateSpatialPattern(sim_object, lambda = 30)
</code></pre>

<hr>
<h2 id='GenerateTissue'>Generate Tissue</h2><span id='topic+GenerateTissue'></span>

<h3>Description</h3>

<p>This function generates a simulated tissue using a specified number of
clusters and spatial parameters for each pattern in the simulation object.
The tissue is represented by a grid of points with probabilities of
belonging to tissue 1 or tissue 2, based on a Gaussian kernel density
estimate calculated for each pattern
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GenerateTissue(
  sim_object,
  k = NA,
  xmin = NA,
  xmax = NA,
  ymin = NA,
  ymax = NA,
  sdmin = 1/2,
  sdmax = 2,
  force = FALSE,
  density_heatmap = FALSE,
  step_size = 1,
  cores = 1,
  overwrite = FALSE,
  use_window = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GenerateTissue_+3A_sim_object">sim_object</code></td>
<td>
<p>A <code>SpatSimObj</code> created with
<code><a href="#topic+CreateSimulationObject">CreateSimulationObject</a></code>.</p>
</td></tr>
<tr><td><code id="GenerateTissue_+3A_k">k</code></td>
<td>
<p>Number of clusters to generate for each pattern</p>
</td></tr>
<tr><td><code id="GenerateTissue_+3A_xmin">xmin</code></td>
<td>
<p>Minimum x-coordinate for cluster centers.</p>
</td></tr>
<tr><td><code id="GenerateTissue_+3A_xmax">xmax</code></td>
<td>
<p>Maximum x-coordinate for cluster centers.</p>
</td></tr>
<tr><td><code id="GenerateTissue_+3A_ymin">ymin</code></td>
<td>
<p>Minimum y-coordinate for cluster centers.</p>
</td></tr>
<tr><td><code id="GenerateTissue_+3A_ymax">ymax</code></td>
<td>
<p>Maximum y-coordinate for cluster centers.</p>
</td></tr>
<tr><td><code id="GenerateTissue_+3A_sdmin">sdmin</code></td>
<td>
<p>Minimum standard deviation for cluster kernels.</p>
</td></tr>
<tr><td><code id="GenerateTissue_+3A_sdmax">sdmax</code></td>
<td>
<p>Maximum standard deviation for cluster kernels.</p>
</td></tr>
<tr><td><code id="GenerateTissue_+3A_force">force</code></td>
<td>
<p>Logical, whether to force generation of tissue even if the
generated cluster centers would fall outside the simulation window. If
<code>FALSE</code>, an error will be thrown if cluster centers are outside the
window.</p>
</td></tr>
<tr><td><code id="GenerateTissue_+3A_density_heatmap">density_heatmap</code></td>
<td>
<p>Logical, whether to calculate a density heatmap for
the simulated tissue. If <code>TRUE</code>, a grid of points will be generated
covering the entire simulation window, and the probability of each grid
point belonging to tissue 1 will be calculated based on the generated tissue
probability.</p>
</td></tr>
<tr><td><code id="GenerateTissue_+3A_step_size">step_size</code></td>
<td>
<p>Grid step size for the density heatmap.</p>
</td></tr>
<tr><td><code id="GenerateTissue_+3A_cores">cores</code></td>
<td>
<p>Number of cores to use for parallel processing of density
calculations.</p>
</td></tr>
<tr><td><code id="GenerateTissue_+3A_overwrite">overwrite</code></td>
<td>
<p>boolean whether to overwrite if tissue kernels already exist</p>
</td></tr>
<tr><td><code id="GenerateTissue_+3A_use_window">use_window</code></td>
<td>
<p>boolean whether to use the simulation window to set x and y limits</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates a simulated tissue for each pattern in the
simulation object by first generating k clusters within the specified x
and y ranges and with a standard deviation within the specified range.
Then, a Gaussian kernel density estimate is calculated for each pattern
using the generated clusters as center points and the specified standard
deviation as kernel size. The density estimates represent the probability
of each point in the simulation window belonging to tissue 1 or tissue 2.
If <code>density_heatmap = TRUE</code>, a density heatmap will be
calculated using a grid of points covering the entire simulation window.
Finally, for each simulated point, the probability of belonging to
tissue 1 is calculated based on the kernel density estimate, and the tissue
type is assigned with
probability proportional to the probability of belonging to tissue 1.
</p>


<h3>Value</h3>

<p>A modified 'Spatial Simulation Object' with updated tissue grids and
assigned tissue types for each simulated pattern.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a simulation object with a window and point pattern
sim_object &lt;- CreateSimulationObject()

#simulate points
sim_object &lt;- GenerateSpatialPattern(sim_object, lambda = 20)

# Generate tissue with default parameters
sim_object &lt;- GenerateTissue(sim_object)

</code></pre>

<hr>
<h2 id='plot.SpatSimObj'>plot function for SpatSimObj</h2><span id='topic+plot.SpatSimObj'></span>

<h3>Description</h3>

<p>plot function for SpatSimObj
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SpatSimObj'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.SpatSimObj_+3A_x">x</code></td>
<td>
<p>of class <code>SpatSimObj</code></p>
</td></tr>
<tr><td><code id="plot.SpatSimObj_+3A_...">...</code></td>
<td>
<p>other things to pass to the plot method for SpatSimObj including <code>nrow</code>, <code>ncol</code> for the number of rows and columns of plots,
<code>which</code> pattern to plot, and <code>what</code> which currently only works with &quot;Processes&quot; but may be updated in the future</p>
</td></tr>
</table>


<h3>Value</h3>

<p>basic x-y ggplot object
</p>

<hr>
<h2 id='PlotSimulation'>Plot Simulation</h2><span id='topic+PlotSimulation'></span>

<h3>Description</h3>

<p>Plot different aspects of a SpatSimObj
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotSimulation(
  sim_object,
  nrow = 1,
  ncol = 1,
  which = 1,
  what = "tissue heatmap"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PlotSimulation_+3A_sim_object">sim_object</code></td>
<td>
<p>A <code>SpatSimObj</code></p>
</td></tr>
<tr><td><code id="PlotSimulation_+3A_nrow">nrow</code></td>
<td>
<p>Number of rows of plots (only applicable when more than one plot is made)</p>
</td></tr>
<tr><td><code id="PlotSimulation_+3A_ncol">ncol</code></td>
<td>
<p>Number of columns of plots (only applicable when more than one plot is made)</p>
</td></tr>
<tr><td><code id="PlotSimulation_+3A_which">which</code></td>
<td>
<p>Index of the elements of the SpatSimObj to be plotted</p>
</td></tr>
<tr><td><code id="PlotSimulation_+3A_what">what</code></td>
<td>
<p>What to plot (&quot;tissue heatmap&quot;, &quot;hole heatmap&quot;, or &quot;whole core&quot;)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>PlotSimulation</code> function is used to plot different aspects of a SpatSimObj
The function takes a <code>sim_object</code> as its first argument, which should be an object of class
&quot;Spatial Simulation Object&quot;. The function can then be used to plot different aspects of the
simulation, such as heatmaps of the tissue or holes, or a plot of the whole core with assigned cells colored by type.
</p>
<p>When <code>what</code> is set to &quot;tissue heatmap&quot; or &quot;hole heatmap&quot;, the function will plot heatmaps of
the specified tissue or hole. When <code>what</code> is set to &quot;whole core&quot;, the function will plot the
entire core with assigned cells colored by type. Only a single element of the <code>sim_object</code> can
be plotted when <code>what</code> is set to &quot;whole core&quot;. <code>what</code> equal to &quot;tissue points&quot;, &quot;hole points&quot;, or
&quot;tissue hole points&quot; will result in a point plot of the respective assignments on points.
</p>
<p>When more than one plot is made, <code>nrow</code> and <code>ncol</code> can be used to specify the number of rows
and columns of the plot grid, respectively.
</p>


<h3>Value</h3>

<p>A plot or a grid of plots, depending on the input arguments
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create a SpatSimObj
sim_object &lt;- CreateSimulationObject()
sim_object = GenerateSpatialPattern(sim_object)
sim_object = GenerateTissue(sim_object, density_heatmap = TRUE, step_size = 1, cores = 1)
# plot a heatmap of tissue 1
PlotSimulation(sim_object, which = 1, what = "tissue heatmap")
</code></pre>

<hr>
<h2 id='SummariseSpatial'>Summarise Spatial</h2><span id='topic+SummariseSpatial'></span>

<h3>Description</h3>

<p>Summarise Spatial
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SummariseSpatial(spatial_list, markers)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SummariseSpatial_+3A_spatial_list">spatial_list</code></td>
<td>
<p>list of spatial data frames with <code>markers</code> column names</p>
</td></tr>
<tr><td><code id="SummariseSpatial_+3A_markers">markers</code></td>
<td>
<p>names of columns, probably cell types, that contain 1s and 0s representing positive/negative assignments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frome with summary counts and proportions for the markers in each spatial data frame
</p>

<hr>
<h2 id='summary.SpatSimObj'>summary function for SpatSimObj</h2><span id='topic+summary.SpatSimObj'></span>

<h3>Description</h3>

<p>summary function for SpatSimObj
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SpatSimObj'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.SpatSimObj_+3A_object">object</code></td>
<td>
<p>of class <code>SpatSimObj</code></p>
</td></tr>
<tr><td><code id="summary.SpatSimObj_+3A_...">...</code></td>
<td>
<p>nothing else to pass to summary if object is a SpatSimObj</p>
</td></tr>
</table>


<h3>Value</h3>

<p>summary of the SpatSimObj to the terminal
</p>

<hr>
<h2 id='UpdateSimulationWindow'>Update the simulation window in a SpatSimObj</h2><span id='topic+UpdateSimulationWindow'></span>

<h3>Description</h3>

<p>This function updates the simulation window of a <code>SpatSimObj</code> by replacing
the existing window with a new one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UpdateSimulationWindow(sim_object, window = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UpdateSimulationWindow_+3A_sim_object">sim_object</code></td>
<td>
<p>A <code>SpatSimObj</code> object</p>
</td></tr>
<tr><td><code id="UpdateSimulationWindow_+3A_window">window</code></td>
<td>
<p>A new <code>owin</code> object representing the updated simulation window</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>UpdateSimulationWindow()</code> function checks that the input <code>sim_object</code> is of class
'SpatSimObj', that the input <code>window</code> is not null and is of class 'owin'.
If these checks pass, the function updates the simulation window in the input <code>sim_object</code> and
returns the updated <code>SpatSimObj</code> object.
</p>


<h3>Value</h3>

<p>The updated <code>SpatSimObj</code> object
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CreateSimulationObject">CreateSimulationObject</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a simulation object
sim_obj &lt;- CreateSimulationObject()

# Update the simulation window
new_window &lt;- spatstat.geom::owin(c(0, 5), c(0, 5))
updated_sim_obj &lt;- UpdateSimulationWindow(sim_obj, window = new_window)

</code></pre>

<hr>
<h2 id='wm'>Round spatstat window</h2><span id='topic+wm'></span>

<h3>Description</h3>

<p>A mask that turns a window from spatstat round to mimic a window that is similar to most tissue microarray image scans
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wm
</code></pre>


<h3>Format</h3>

<p>An <code>owin</code> object with many slots describing the size and mask
</p>

<dl>
<dt>type</dt><dd><p>mask</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
