<!DOCTYPE html><html><head><title>Help for package amanida</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {amanida}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#amanida'><p>amanida</p></a></li>
<li><a href='#amanida_palette'><p>Get nice colour-blind colours</p></a></li>
<li><a href='#amanida_read'><p>Import data</p></a></li>
<li><a href='#amanida_report'><p>Report</p></a></li>
<li><a href='#amanida_vote'><p>Qualitative meta-analysis</p></a></li>
<li><a href='#check_names'><p>Amanida harmonization</p></a></li>
<li><a href='#compute_amanida'><p>Combine statistical results and compute vote-counting</p></a></li>
<li><a href='#explore_plot'><p>Plot for compounds divergence in reports</p></a></li>
<li><a href='#getsampleDB'><p>Function to sample data path</p></a></li>
<li><a href='#METAtables-class'><p>An S4 class to return results from <code>compute_amanida</code> or <code>amanida_vote</code> function</p></a></li>
<li><a href='#sample_data'><p>Example input data for the amanida function</p></a></li>
<li><a href='#volcano_plot'><p>Volcano plot of combined results</p></a></li>
<li><a href='#vote_plot'><p>Bar-plot for compounds vote-counting</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Meta-Analysis for Non-Integral Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Combination of results for meta-analysis using significance
    and effect size only. P-values and fold-change are combined to obtain
    a global significance on each metabolite. Produces a volcano plot
    summarising the relevant results from meta-analysis. Vote-counting
    reports for metabolites. And explore plot to detect discrepancies
    between studies at a first glance. Methodology is described in the
    Llambrich et al. (2021) &lt;<a href="https://doi.org/10.1093%2Fbioinformatics%2Fbtab591">doi:10.1093/bioinformatics/btab591</a>&gt;.  </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mariallr/amanida">https://github.com/mariallr/amanida</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr (&ge; 1.0.0), ggplot2 (&ge; 3.3.0), ggrepel (&ge; 0.9.0),
kableExtra (&ge; 1.3.0), knitr (&ge; 1.45), magrittr (&ge; 1.5),
methods (&ge; 3.6.0), readr (&ge; 1.0.0), readxl (&ge; 1.0.0),
rmarkdown (&ge; 2.25), stats (&ge; 3.6.0), tibble (&ge; 3.0.0), tidyr
(&ge; 1.1.0), tidyverse (&ge; 1.3.0), webchem (&ge; 1.1.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>markdown, metaboliteIDmapping, testthat, vdiffr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-26 08:43:38 UTC; maria</td>
</tr>
<tr>
<td>Author:</td>
<td>Maria Llambrich <a href="https://orcid.org/0000-0001-8418-0982"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Eudald Correig [aut],
  Raquel Cumeras [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maria Llambrich &lt;maria.llambrich@urv.cat&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-26 11:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='amanida'>amanida</h2><span id='topic+amanida'></span><span id='topic+amanida-package'></span>

<h3>Description</h3>

<p>amanida: A package for Meta-Analysis with non-integral data
</p>


<h3>Author(s)</h3>

<p>Maria Llambrich, Eudald Correig and Raquel Cumeras
</p>
<p>Results combination for meta-analysis using only significance and effect size.
</p>

<ul>
<li><p> P-values and fold-change are combined to obtain a global significance on each metabolite.
</p>
</li>
<li><p> Produces a volcano plot summarizing the relevant results from meta-analysis.
</p>
</li>
<li><p> Qualitative meta-analysis for metabolites
</p>
</li>
<li><p> Graphical representation of qualitative analysis by bar plot
</p>
</li>
<li><p> Trend explore plot to detect discrepancies between studies at a first glance
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/mariallr/amanida">https://github.com/mariallr/amanida</a>
</p>
</li></ul>


<hr>
<h2 id='amanida_palette'>Get nice colour-blind colours</h2><span id='topic+amanida_palette'></span>

<h3>Description</h3>

<p>Get nice colour-blind colours
</p>


<h3>Usage</h3>

<pre><code class='language-R'>amanida_palette()
</code></pre>


<h3>Value</h3>

<p>vector of colours
</p>

<hr>
<h2 id='amanida_read'>Import data</h2><span id='topic+amanida_read'></span>

<h3>Description</h3>

<p><code>amanida_read</code> imports the data and formats for <code>compute_amanida</code>
or <code>amanida_vote</code> functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>amanida_read(file, mode, coln, separator = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="amanida_read_+3A_file">file</code></td>
<td>
<p>path to file</p>
</td></tr>
<tr><td><code id="amanida_read_+3A_mode">mode</code></td>
<td>
<p>indicate if data will be quantitative or qualitative. Options are:
</p>

<ul>
<li><p> &quot;quan&quot; for quantitative meta-analysis using p-value and fold-change
</p>
</li>
<li><p> &quot;qual&quot; for qualitative meta-analysis using trend label
</p>
</li></ul>
</td></tr>
<tr><td><code id="amanida_read_+3A_coln">coln</code></td>
<td>
<p>columns names to use. It has to be in order identification, p-values, fold-changes, sample size and reference.</p>
</td></tr>
<tr><td><code id="amanida_read_+3A_separator">separator</code></td>
<td>
<p>the separator used on file</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that <code>amanida_read</code> skips rows with missing values or NA. Negatives values for fold-change are transformed to positive (1/value).
</p>
<p>Formats compatible are csv, xlsx, xls or txt.
</p>


<h3>Value</h3>

<p>tibble table with data imported
</p>


<h3>Examples</h3>

<pre><code class='language-R'>coln &lt;-  c("Compound Name", "P-value", "Fold-change", "N total", "References")
input_file &lt;- getsampleDB()
datafile &lt;- amanida_read(input_file, mode = "quan", coln, separator=";")

</code></pre>

<hr>
<h2 id='amanida_report'>Report</h2><span id='topic+amanida_report'></span>

<h3>Description</h3>

<p><code>amanida_report</code> creates a report from the data using amanida functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>amanida_report(
  input_file,
  separator = NULL,
  analysis_type = NULL,
  column_id,
  pvalue_cutoff = NULL,
  fc_cutoff = NULL,
  votecount_lim,
  path = NULL,
  comp_inf = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="amanida_report_+3A_input_file">input_file</code></td>
<td>
<p>path to the original dataset in xlsx, xls, csv or txt format</p>
</td></tr>
<tr><td><code id="amanida_report_+3A_separator">separator</code></td>
<td>
<p>indicate the separator used in the input_file parameter</p>
</td></tr>
<tr><td><code id="amanida_report_+3A_analysis_type">analysis_type</code></td>
<td>
<p>indicate if data will be quantitative, qualitative or both. Options are:
</p>

<ul>
<li><p> &quot;quan-qual&quot; for quantitative and qualitative meta-analysis
</p>
</li>
<li><p> &quot;quan&quot; for quantitative meta-analysis using p-value and fold-change
</p>
</li>
<li><p> &quot;qual&quot; for qualitative meta-analysis using trend label
</p>
</li></ul>
</td></tr>
<tr><td><code id="amanida_report_+3A_column_id">column_id</code></td>
<td>
<p>vector containing columns names to use. It has to be in order identification, p-values, fold-changes, sample size and reference.</p>
</td></tr>
<tr><td><code id="amanida_report_+3A_pvalue_cutoff">pvalue_cutoff</code></td>
<td>
<p>numeric value to consider statistical significance</p>
</td></tr>
<tr><td><code id="amanida_report_+3A_fc_cutoff">fc_cutoff</code></td>
<td>
<p>numeric value to consider significance for effect size</p>
</td></tr>
<tr><td><code id="amanida_report_+3A_votecount_lim">votecount_lim</code></td>
<td>
<p>minimum numeric value for vote-counting visualization</p>
</td></tr>
<tr><td><code id="amanida_report_+3A_path">path</code></td>
<td>
<p>path to the directory where html file is created, otherwise the file will be saved in a temporal folder</p>
</td></tr>
<tr><td><code id="amanida_report_+3A_comp_inf">comp_inf</code></td>
<td>
<p>name checking using information from public databases</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses directly the dataset to create a report with the meta-analysis results. In case of quantitative analysis <code>amanida_report</code> uses the functions <code>amanida_read</code> and <code>compute_amanida</code> for analyse the input data. Then the results are showed using <code>volcano_plot</code>, <code>explore_plot</code> and <code>vote_plot</code>.
</p>


<h3>Value</h3>

<p>an html document saved in the working directory
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
column_id = c("Compound Name", "P-value", "Fold-change", "N total", "References")
input_file &lt;- getsampleDB()

amanida_report(input_file, separator = ";", column_id, analysis_type = "quan", 
                pvalue_cutoff = 0.05, fc_cutoff = 4, votecount_lim = 2, 
                comp_inf = F)

## End(Not run)

</code></pre>

<hr>
<h2 id='amanida_vote'>Qualitative meta-analysis</h2><span id='topic+amanida_vote'></span>

<h3>Description</h3>

<p><code>amanida_vote</code> performs vote-counting on qualitative data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>amanida_vote(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="amanida_vote_+3A_data">data</code></td>
<td>
<p>data imported using <code>amanida_read</code> function w/o names checked by <code>check_names</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Vote-counting is computed without trend division. Punctuation of entries is based on trend, up-regulation gives 1, down-regulation give -1 and equal behavior gives 0. Total sum is divided then by the total number of entries on each compound. Compound combination is made with PubChem CID when is available.
</p>
<p>Note that <code>amanida_vote</code> skips rows with missing values or NA.
</p>
<p>Formats compatible are csv, xlsx, xls or txt.
</p>


<h3>Value</h3>

<p>METAtable S4 object with vote-counting for each compound on @slot vote
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
coln = c("Compound Name", "Behaviour", "References")
input_file &lt;- system.file("extdata", "dataset2.csv", package = "amanida")
data_votes &lt;- amanida_read(input_file, mode = "qual", coln, separator = ";")

vote_result &lt;- amanida_vote(data_votes)

## End(Not run)

</code></pre>

<hr>
<h2 id='check_names'>Amanida harmonization</h2><span id='topic+check_names'></span>

<h3>Description</h3>

<p><code>check_names</code> check the names to harmonize them to a common nomenclature. Valid names are:
chemical name, InChI, InChIKey and SMILES.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_names(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_names_+3A_data">data</code></td>
<td>
<p>data imported using <code>amanida_read</code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that <code>check_names</code> depends on <code>webchem</code>package and it slows down the process.
</p>
<p>Formats compatible are <code>amanida_read</code> output
</p>


<h3>Value</h3>

<p>tibble table with data imported with PubChem ID retrieved
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
coln &lt;-  c("Compound Name", "P-value", "Fold-change", "N total", "References")
input_file &lt;- getsampleDB()
datafile &lt;- amanida_read(input_file, mode = "quan", coln, separator=";")

data_checked &lt;- check_names(datafile) 

## End(Not run)

</code></pre>

<hr>
<h2 id='compute_amanida'>Combine statistical results and compute vote-counting</h2><span id='topic+compute_amanida'></span>

<h3>Description</h3>

<p><code>compute_amanida</code> Combines for the same entry or metabolite the statistical values of p-value and fold-change. Also is computed a vote-counting for each compound. Compound combination is made with PubChem CID when is available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_amanida(datafile, comp.inf = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_amanida_+3A_datafile">datafile</code></td>
<td>
<p>data imported using <code>amanida_read</code> function w/o names checked by <code>check_names</code></p>
</td></tr>
<tr><td><code id="compute_amanida_+3A_comp.inf">comp.inf</code></td>
<td>
<p>include compounds IDs from PubChem, InChIKey, SMILES, KEGG, ChEBI, HMDB, Drugbank, Molecular Mass and Molecular Formula</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Entries corresponding to metabolites are combined as follows:
</p>

<ul>
<li><p> P-values are combined using Fisher method weighted by N and gamma distribution
</p>
</li>
<li><p> Fold-change are combined by weighted mean. Transformation works with fold-change transformed to log scale with base 2.
</p>
</li></ul>

<p>Vote-counting is computed based on votes. Punctuation of entries is based on trend, up-regulation gives 1, down-regulation give -1 and equal behavior gives 0. Total sum is divided then by the total number of entries on each compound.
</p>


<h3>Value</h3>

<p>METAtable S4 object with p-value combined, fold-change combined and vote-counting for each compound
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("sample_data")

compute_amanida(sample_data)

## End(Not run)

</code></pre>

<hr>
<h2 id='explore_plot'>Plot for compounds divergence in reports</h2><span id='topic+explore_plot'></span>

<h3>Description</h3>

<p><code>explore_plot</code> creates a bar-plot showing the votes divided in up-regulated and down-regulated and the global result for each compound.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>explore_plot(data, type = "all", counts = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="explore_plot_+3A_data">data</code></td>
<td>
<p>an tibble obtained by <code>amanida_read</code> w/o names checked by <code>check_names</code></p>
</td></tr>
<tr><td><code id="explore_plot_+3A_type">type</code></td>
<td>
<p>select the subset of data to plot. Options are:
</p>

<ul>
<li><p> &quot;all&quot;: all data will be displayed
</p>
</li>
<li><p> &quot;sub&quot;: only data over counts value will be displayed. Need counts value.
</p>
</li>
<li><p> &quot;mix&quot;: will display data over count value and elements with reports in both trends.Need counts value.
</p>
</li></ul>
</td></tr>
<tr><td><code id="explore_plot_+3A_counts">counts</code></td>
<td>
<p>value of vote-counting cut-off. Will be only displayed data over the cut-off.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sum of votes divided by trend are plotted, then is obtained the total result by compound summing both trends.
</p>


<h3>Value</h3>

<p>a ggplot bar-plot showing the sum of votes for each compound divided by the trend
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("sample_data")

explore_plot(sample_data, type = "mix", counts = 1)

</code></pre>

<hr>
<h2 id='getsampleDB'>Function to sample data path</h2><span id='topic+getsampleDB'></span>

<h3>Description</h3>

<p>Function to sample data path
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getsampleDB()
</code></pre>

<hr>
<h2 id='METAtables-class'>An S4 class to return results from <code>compute_amanida</code> or <code>amanida_vote</code> function</h2><span id='topic+METAtables-class'></span><span id='topic+METAtables'></span>

<h3>Description</h3>

<p>An S4 class to return results from <code>compute_amanida</code> or <code>amanida_vote</code> function
</p>


<h3>Slots</h3>


<dl>
<dt><code>stat</code></dt><dd><p>results for statistics combining p-values and fold-changes</p>
</dd>
<dt><code>vote</code></dt><dd><p>vote-counting for metabolites</p>
</dd>
</dl>

<hr>
<h2 id='sample_data'>Example input data for the amanida function</h2><span id='topic+sample_data'></span>

<h3>Description</h3>

<p>A dataset containing results from meta-analysis of metabolomic studies
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 143 rows and 6 variables:
</p>

<dl>
<dt>id</dt><dd><p>Name of the compound under study</p>
</dd>
<dt>pvalue</dt><dd><p>P-value</p>
</dd>
<dt>foldchange</dt><dd><p>Fold-change</p>
</dd>
<dt>N</dt><dd><p>Number of samples of the compound</p>
</dd>
<dt>ref</dt><dd><p>References</p>
</dd>
<dt>trend</dt><dd><p>Trend: 1 (up), -1 (down) or 0 (none)</p>
</dd>
</dl>


<hr>
<h2 id='volcano_plot'>Volcano plot of combined results</h2><span id='topic+volcano_plot'></span>

<h3>Description</h3>

<p><code>volcano_plot</code> returns a volcano plot of the combined results on each metabolite obtained by <code>compute_amanida</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>volcano_plot(mets, cutoff = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="volcano_plot_+3A_mets">mets</code></td>
<td>
<p>an S4 METAtables object</p>
</td></tr>
<tr><td><code id="volcano_plot_+3A_cutoff">cutoff</code></td>
<td>
<p>values for p-value and fold-change significance</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Results are presented as -log10 for p-value and log2 for fold-change.
Values over the cut off are labeled. If not cutoff is provided will be used alpha 0.05 for p-value and 1.5 for logarithmic fold-change.
</p>


<h3>Value</h3>

<p>plot of results
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
   data("sample_data")
   
   amanida_result &lt;- compute_amanida(sample_data)
   volcano_plot(amanida_result)

## End(Not run)

</code></pre>

<hr>
<h2 id='vote_plot'>Bar-plot for compounds vote-counting</h2><span id='topic+vote_plot'></span>

<h3>Description</h3>

<p><code>vote_plot</code> creates a bar-plot showing the vote-count for each compound.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vote_plot(mets, counts = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vote_plot_+3A_mets">mets</code></td>
<td>
<p>an S4 METAtables object obtained by <code>compute_amanida</code> or <code>amanida_vote</code>.</p>
</td></tr>
<tr><td><code id="vote_plot_+3A_counts">counts</code></td>
<td>
<p>value of vote-counting cut-off. Will be only displayed data over the cut-off.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Vote-couting is the sum of number of reports up-regulated and the substraction of reports down-regulated.
</p>


<h3>Value</h3>

<p>a ggplot bar-plot showing the vote-count per compound
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
    data("sample_data")
    result &lt;- compute_amanida(sample_data)
    vote_plot(result)

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
