<!DOCTYPE html><html><head><title>Help for package treeclim</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {treeclim}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#abbrev_name'><p>Shorten month names</p></a></li>
<li><a href='#apply_var_names'><p>(re)name climate variable</p></a></li>
<li><a href='#as_tcclimate'><p>Create the correct data format for variable selection</p></a></li>
<li><a href='#check_months'><p>Check if all months are between -24 and 12 (previous and current december)</p></a></li>
<li><a href='#correct_continuous'><p>Correct continuous month specifications</p></a></li>
<li><a href='#dcc'><p>Response and correlation function analysis</p></a></li>
<li><a href='#dlm'><p>Dendro-flavoured linear model</p></a></li>
<li><a href='#eval_selection'><p>Eval a single list of specifications</p></a></li>
<li><a href='#exclude_from'><p>Exclude months from analysis</p></a></li>
<li><a href='#format_month'><p>Get positions and names for months</p></a></li>
<li><a href='#g_test'><p>Gershunov test for spurious low-frequency modulations</p></a></li>
<li><a href='#init_boot_data'><p>initialize data structure for bootstrapping</p></a></li>
<li><a href='#is_continuous'><p>Check if month specification is continuous</p></a></li>
<li><a href='#make_pmat'><p>Make list of parameter matrices from climate input data</p></a></li>
<li><a href='#make_range_list'><p>deconstruct call to modifier into list</p></a></li>
<li><a href='#muc_clim'><p>Monthly Mean Temperature and Total Precipitation for Forstenrieder</p>
Park, Munich</a></li>
<li><a href='#muc_fake'><p>Modeled Tree-Ring Chronology of a Spruce Population near Munich</p></a></li>
<li><a href='#muc_spruce'><p>Tree-Ring Chronology of a Spruce Population near Munich</p></a></li>
<li><a href='#norw015'><p>Tree-Ring Chronology of a Pine Population at Visdalen, Norway</p></a></li>
<li><a href='#norway_prec'><p>Monthly Precipitation Sums for Norway</p></a></li>
<li><a href='#norway_temp'><p>Monthly Temperature Means for Norway</p></a></li>
<li><a href='#ptest'><p>Significance test for bootstrapped coefficients</p></a></li>
<li><a href='#rt_prec'><p>Monthly Precipitation Sums for Rothenburg ob der Tauber, Germany</p></a></li>
<li><a href='#rt_spruce'><p>Tree-Ring Chronology of a Spruce Population at Rothenburg ob der Tauber</p></a></li>
<li><a href='#rt_temp'><p>Monthly Temperature Means for Rothenburg ob der Tauber, Germany</p></a></li>
<li><a href='#seascorr'><p>Seasonal (partial) correlation analysis</p></a></li>
<li><a href='#shift_year'><p>shifts a month 0, 1, or 2 years back</p></a></li>
<li><a href='#skills'><p>Evaluate reconstruction skills using split-calibration</p></a></li>
<li><a href='#spai020'><p>Tree-Ring Chronology of a Pine Population at Penota, Spain</p></a></li>
<li><a href='#spain_prec'><p>Monthly Precipitation Sums for Spain</p></a></li>
<li><a href='#spain_temp'><p>Monthly Temperature Means for Spain</p></a></li>
<li><a href='#tc_correlation'><p>(bootstrapped) correlation function</p></a></li>
<li><a href='#tc_design'><p>Deparse list structure from month specification and return parameter set</p></a></li>
<li><a href='#tc_efunc'><p>evolving response and correlation function</p></a></li>
<li><a href='#tc_mfunc'><p>moving response and correlation function</p></a></li>
<li><a href='#tc_response'><p>(bootstrapped) response function</p></a></li>
<li><a href='#traceplot'><p>Trace the temporal development of response or correlation coefficients</p></a></li>
<li><a href='#treeclim-modifiers'><p>Modifiers for climate parameter selection</p></a></li>
<li><a href='#treeclim-shifters'><p>Shift months one or two years back</p></a></li>
<li><a href='#truncate_input'><p>Truncate climate and tree data to common interval</p></a></li>
<li><a href='#unify_selection'><p>unify selections to handle &quot;classic&quot; (bootRes-style) selections</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Numerical Calibration of Proxy-Climate Relationships</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.6.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-02-08</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.2), base, stats, utils, Rcpp (&ge; 0.10.6)</td>
</tr>
<tr>
<td>Imports:</td>
<td>abind, plyr, ggplot2, lmtest, lmodel2, np, boot</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo (&ge; 0.4.000.2)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 2.99.0.9000)</td>
</tr>
<tr>
<td>Description:</td>
<td>Bootstrapped response and correlation functions,
    seasonal correlations and evaluation of reconstruction
    skills for use in dendroclimatology and dendroecology,
    see Zang and Biondi (2015) &lt;<a href="https://doi.org/10.1111%2Fecog.01335">doi:10.1111/ecog.01335</a>&gt;.</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/cszang/treeclim">https://github.com/cszang/treeclim</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/cszang/treeclim/issues">https://github.com/cszang/treeclim/issues</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-02-08 10:44:26 UTC; christian</td>
</tr>
<tr>
<td>Author:</td>
<td>Christian Zang [aut, cre, cph, trl],
  Franco Biondi [ctb, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Christian Zang &lt;christian.zang@hswt.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-02-08 15:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='abbrev_name'>Shorten month names</h2><span id='topic+abbrev_name'></span>

<h3>Description</h3>

<p>Shorten month names that are longer than 43 characters by joining
the first and last 20 characters with &quot;...&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>abbrev_name(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="abbrev_name_+3A_x">x</code></td>
<td>
<p>a vector of month names as returned by format_month()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of month names shortened to 43 characters
</p>

<hr>
<h2 id='apply_var_names'>(re)name climate variable</h2><span id='topic+apply_var_names'></span>

<h3>Description</h3>

<p>(re)name climate variable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply_var_names(climate, var_names)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apply_var_names_+3A_climate">climate</code></td>
<td>
<p>an object of class tc_climate</p>
</td></tr>
<tr><td><code id="apply_var_names_+3A_var_names">var_names</code></td>
<td>
<p>either NULL or a character vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the (potentially renamed) climate data
</p>

<hr>
<h2 id='as_tcclimate'>Create the correct data format for variable selection</h2><span id='topic+as_tcclimate'></span>

<h3>Description</h3>

<p>Check the climate data that is either supplied as a matrix, a
data.frame, or a list of data.frames. Reformat the data for
further usage into the internal format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_tcclimate(x, varnames = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_tcclimate_+3A_x">x</code></td>
<td>
<p>the supplied climate data</p>
</td></tr>
<tr><td><code id="as_tcclimate_+3A_varnames">varnames</code></td>
<td>
<p>optionally supplied variable names</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with years in rows and monthly observations
in columns
</p>

<hr>
<h2 id='check_months'>Check if all months are between -24 and 12 (previous and current december)</h2><span id='topic+check_months'></span>

<h3>Description</h3>

<p>Make sure that all the months specified in the (probably complex)
month specification to dcc are correct months, in the sense that
they range between -24 and 12. Further, return the earliest month
in the complete selection to decide if we need previous year
climate later on.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_months(selection)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_months_+3A_selection">selection</code></td>
<td>
<p>the month selection as vector, list, or nested
list</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with the earliest month and the result of the check
(logical)
</p>

<hr>
<h2 id='correct_continuous'>Correct continuous month specifications</h2><span id='topic+correct_continuous'></span>

<h3>Description</h3>

<p>If month specification is continuous, it must be interpreted differently if
it contains 0. E.g., -5:8 must be translated to c(-5:-12, 1:8).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correct_continuous(month)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="correct_continuous_+3A_x">x</code></td>
<td>
<p>a numeric month id specification</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric vector with the corrected month id specification
</p>

<hr>
<h2 id='dcc'>Response and correlation function analysis</h2><span id='topic+dcc'></span>

<h3>Description</h3>

<p>This function calculates (potentially moving or evolving) response
and correlation functions from tree-ring chronologies and monthly
climatic data.  For the moving case, the calculation is performed
repeatedly for consecutive time windows. Function parameters may
be bootstrapped to calculate their significance and confidence
intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dcc(
  chrono,
  climate,
  selection = -6:9,
  method = "response",
  dynamic = "static",
  moving,
  win_size = 25,
  win_offset = 1,
  start_last = TRUE,
  timespan = NULL,
  var_names = NULL,
  ci = 0.05,
  boot = "stationary",
  sb = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dcc_+3A_chrono">chrono</code></td>
<td>
<p><code>data.frame</code> containing a tree-ring
chronologies, e.g. as obtained by <code>chron</code> of package dplR.</p>
</td></tr>
<tr><td><code id="dcc_+3A_climate">climate</code></td>
<td>
<p>either a <code>data.frame</code> or <code>matrix</code> with
climatic data in monthly resolution, with year, month and
climate parameters in columns (all columns except year and month
will be recognized as parameters for response or correlation
functions), or a single <code>data.frame</code> or <code>matrix</code> in
13-column format (see below), or a (potentially named) list of
one or several of the latter.</p>
</td></tr>
<tr><td><code id="dcc_+3A_selection">selection</code></td>
<td>
<p>either a numeric vector, a modifier, or a chain
of modifiers specifying the parameter selection for the model
(see Details).</p>
</td></tr>
<tr><td><code id="dcc_+3A_method">method</code></td>
<td>
<p><code>character</code> string specifying the calculation
method.  Possible values are &ldquo;response&rdquo; and
&ldquo;correlation&rdquo;. Partial strings are ok.</p>
</td></tr>
<tr><td><code id="dcc_+3A_dynamic">dynamic</code></td>
<td>
<p><code>character</code>; should the analyis be carried out
in a static, moving, or evolving fashion. One of
<code>c("static", "moving", "evolving")</code>. Defaults to
<code>"static"</code>. Partial strings are ok.</p>
</td></tr>
<tr><td><code id="dcc_+3A_moving">moving</code></td>
<td>
<p>deprecated, use <code>dynamic</code> instead.</p>
</td></tr>
<tr><td><code id="dcc_+3A_win_size">win_size</code></td>
<td>
<p>integer giving the window size for each
recalculation in years for a moving analysis, and the initial
window size for an evolving analysis.</p>
</td></tr>
<tr><td><code id="dcc_+3A_win_offset">win_offset</code></td>
<td>
<p>integer giving the number of years between each
window start in years.</p>
</td></tr>
<tr><td><code id="dcc_+3A_start_last">start_last</code></td>
<td>
<p><code>logical</code> flag indicating whether the first
window should start at the rear end (youngest part of the
series) or not.</p>
</td></tr>
<tr><td><code id="dcc_+3A_timespan">timespan</code></td>
<td>
<p><code>integer</code> vector of length 2 specifying the
time interval (in years) to be considered for analysis. Defaults
to the maximum possible interval.</p>
</td></tr>
<tr><td><code id="dcc_+3A_var_names">var_names</code></td>
<td>
<p><code>character</code> vector with variable
names. Defaults to corresponding column names of parameter <code>climate</code> if
given as <code>data.frame</code>, or its names if given as <code>list</code>.</p>
</td></tr>
<tr><td><code id="dcc_+3A_ci">ci</code></td>
<td>
<p><code>numerical</code> value to set the test level for
significance test (values 0.01, 0.05 and 0.1 are allowed); the
confidence intervals are adapted accordingly.</p>
</td></tr>
<tr><td><code id="dcc_+3A_boot">boot</code></td>
<td>
<p><code>character</code> indicating which bootstrap method
should be used, one of <code>c("stationary", "std", "exact")</code></p>
</td></tr>
<tr><td><code id="dcc_+3A_sb">sb</code></td>
<td>
<p><code>logical</code> flag indicating whether textual status
bar for moving case should be suppressed. Suppression is
recommended for e.g.  Sweave files.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function builds upon and extents the functionality of
programme DENDROCLIM2002 (Biondi and Waikul, 2004), and will
calculate bootstrapped (and non-bootstrapped) moving and static
response and correlation functions in a similar fashion as
described in the above mentioned paper. Important extensions
include a very flexible parameter selection model (see below), the
possibility to use an unlimited number of climate parameters, and
the option to use exact bootstrapping.
</p>
<p>Input chronology data can be a <code>data.frame</code> such as produced
by function <code>chron</code> of package dplR. It has to be a
<code>data.frame</code> with at least one column containing the
tree-ring indices, and the corresponding years as <code>rownames</code>.
</p>
<p>For climatic input data, there are three possibilities: Firstly,
input climatic data can be a <code>data.frame</code> or <code>matrix</code>
consisting of at least 3 rows for years, months and at least one
climate parameter in the given order. Secondly, input climatic
data can be a single <code>data.frame</code> or <code>matrix</code> in the
style of the original DENDROCLIM2002 input data, i.e. one
parameter with 12 months in one row, where the first column
represents the year. Or thirdly, input climatic data can be a
(potentially named) list of one or several of the latter described
<code>data.frame</code> or <code>matrices</code>. If named list is provided,
potentially provided variable names through argument
<code>var_names</code> are ignored. As an internal format dispatcher
checks the format automatically, it is absolutely necessary that
in all three cases, only complete years (months 1-12) are
provided. It is not possible to mix different formats in one go.
</p>
<p>Parameters can be selected with the 'selection' parameter in two
different ways:
</p>

<ul>
<li><p> simple selections: as an example -6:9 selects from all
climate variables all months from previous year's June (-6,
previous year's months are specified as negative integers) to
current years September (9, months of the current year are
specified as positive integers) as model parameters. Months from
the previous year and the year before that can be selected using
<a href="#topic+treeclim-shifters">treeclim-shifters</a> like <code>..(6)</code> to refer to July of
the year before the previous year.
</p>
</li>
<li><p> using <em>modifiers</em>: More complex parameter selections
can be obtained by the <em>modifiers</em> provided in treeclim:
<code>.range</code>, <code>.mean</code>, and <code>.sum</code>. These modifiers
can also be chained to create complex selections. See
<a href="#topic+treeclim-modifiers">treeclim-modifiers</a> for details.
</p>
</li></ul>

<p>For the exclusion of months, the convenience function
<code><a href="#topic+exclude_from">exclude_from</a></code> (or short <code><a href="#topic+exfr">exfr</a></code>) is
provided.
</p>
<p>1000 bootstrap samples are taken from the original distributions
of climate and tree-ring data, either using the stationary
bootstrap (Politis and Romano 1994, <code>boot = "stationary"</code>) or
classical bootstrap (DENDROCLIM2002-style, <code>boot =
"std"</code>). The stationary bootstrap mimics the stationary properties
of the original time series in the resampled time series by
resampling within blocks. Within each block, the number of
observations is random and has a geometric distribution.
Consequently, the choice of the distribution parameter will affect
the autocorrelation structure of the resampled time
series. Optimal (expected) block length is chosen according to
Politis and White (2004). In the case of response function
analysis, an eigen decomposition of the standardized predictor
matrix is performed. Nonrelevant eigenvectors are removed using
the PVP criterion (Guiot, 1990), principal component scores are
then calculated from the matrices of reduced eigenvectors and
standardized climatic predictors. Response coefficients are found
via singular value decomposition, and tested for significance
using the 95% percentile range method (Dixon, 2001). In case of
correlation function analysis, the coefficients are Pearson's
correlation coefficients. The same method for significance testing
is applied.
</p>
<p>There is also the option to use exact bootstrapping like
implemented in seascorr (Meko et al. 2011, <code>boot =
"exact"</code>). In this case, circulant embedding is used to simulate
the tree-ring data 1000 times as time series with the same
frequency characteristics like the original time-series (Percival
&amp; Constantine, 2006). Empirical non-exceedence probabilities are
used to test the coefficients of the response/correlation function
with the original data for significance. For the exact
bootstrapping case, no confidence intervals for the
response/correlation coefficients can be computed.
</p>


<h3>Value</h3>

<p>'dcc' returns an 'object' of class '&quot;tc_dcc&quot;'.
</p>
<p>The functions 'summary' and 'plot' are used to obtain and print
a summary of the results, and to create a plot. The function
'coef' can be used to extract the coefficients.
</p>
<p>An object of class '&quot;tc_dcc&quot;' is a list containing at least the
following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the call made to function 'dcc'</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>the coefficients, themselves being an object of
class 'tc_coef' for the static case, and of class 'tc_mcoef' for
the moving case. Objects of class 'tc_coef' are single
data.frames, while objects of class 'tc_mcoef' are lists of
seperate data.frames for the coefficients (element 'coef'), upper and
lower confidence interval (elements 'ci_upper' and 'ci_lower'), and
significance flags (element 'significant')</p>
</td></tr>
<tr><td><code>design</code></td>
<td>
<p>the design matrix on which this call to 'dcc'
operates</p>
</td></tr>
<tr><td><code>truncated</code></td>
<td>
<p>the input data truncated to the common timespan
or the specified timespan</p>
</td></tr>
<tr><td><code>original</code></td>
<td>
<p>the original input data, with the climate data
being recast into a single data.frame</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Christian Zang; the original MATLAB code for exact
bootstrapping was written by Dave Meko
</p>


<h3>References</h3>

<p>Biondi, F &amp; Waikul, K (2004) DENDROCLIM2002: A C++
program for statistical calibration of climate signals in
tree-ring chronologies.  <em>Computers &amp; Geosciences</em>
30:303-311
</p>
<p>Dixon, PM (2001) Bootstrap resampling. In: El-Shaarawi, AH,
Piegorsch, WW (Eds.), <em>The Encyclopedia of
Environmetrics</em>. Wiley, New York.
</p>
<p>Guiot, J (1991) The boostrapped response
function. <em>Tree-Ring Bulletin</em> 51:39-41
</p>
<p>Meko DM, Touchan R, Anchukaitis KJ (2011) Seascorr: A MATLAB
program for identifying the seasonal climate signal in an annual
tree-ring time series.  <em>Computers \&amp; Geosciences</em>
37:1234-241
</p>
<p>Percival DB, Constantine WLB (2006) Exact simulation of Gaussian Time 
Series from Nonparametric Spectral Estimates with Application to 
Bootstrapping. <em>Statistics and Computing</em> 16:25-35
</p>
<p>Patton, A. and D.N. Politis and H. White (2009),
&quot;CORRECTION TO 'Automatic block-length selection for the dependent bootstrap' by D. Politis and H.  White&quot;,
Econometric Reviews 28(4), 372-375.
</p>
<p>Politis, D.N. and H. White (2004), Automatic block-length
selection for the dependent bootstrap, Econometric Reviews
23(1), 53-70.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dc_resp &lt;- dcc(muc_spruce, muc_clim)

## End(Not run)
</code></pre>

<hr>
<h2 id='dlm'>Dendro-flavoured linear model</h2><span id='topic+dlm'></span>

<h3>Description</h3>

<p>This is a wrapper around <code><a href="stats.html#topic+lm">lm</a></code> for working with the
same data structures and modifiers as <code><a href="#topic+dcc">dcc</a></code> does.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlm(
  chrono,
  climate,
  selection,
  timespan = NULL,
  var_names = NULL,
  param_names = NULL,
  intercept = TRUE,
  scale = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dlm_+3A_chrono">chrono</code></td>
<td>
<p><code>data.frame</code> containing a tree-ring
chronologies, e.g. as obtained by <code>chron</code> of package dplR.</p>
</td></tr>
<tr><td><code id="dlm_+3A_climate">climate</code></td>
<td>
<p>either a <code>data.frame</code> or <code>matrix</code> with
climatic data in monthly resolution, with year, month and
climate parameters in columns (all columns except year and month
will be recognized as parameters for response or correlation
functions), or a single <code>data.frame</code> or <code>matrix</code> in
13-column format (see below), or a (potentially named) list of
one or several of the latter.</p>
</td></tr>
<tr><td><code id="dlm_+3A_selection">selection</code></td>
<td>
<p>either a numeric vector, a modifier, or a chain
of modifiers specifying the parameter selection for the model
(see Details).</p>
</td></tr>
<tr><td><code id="dlm_+3A_timespan">timespan</code></td>
<td>
<p><code>integer</code> vector of length 2 specifying the
time interval (in years) to be considered for analysis. Defaults
to the maximum possible interval.</p>
</td></tr>
<tr><td><code id="dlm_+3A_var_names">var_names</code></td>
<td>
<p><code>character</code> vector with variable
names. Defaults to corresponding column names of parameter <code>climate</code> if
given as <code>data.frame</code>, or its names if given as <code>list</code>.</p>
</td></tr>
<tr><td><code id="dlm_+3A_param_names">param_names</code></td>
<td>
<p><code>character</code> vector with parameter
names. Defaults to auto-generated (potentially compound) names.</p>
</td></tr>
<tr><td><code id="dlm_+3A_intercept">intercept</code></td>
<td>
<p><code>logical</code>: should intercept be included in
model?</p>
</td></tr>
<tr><td><code id="dlm_+3A_scale">scale</code></td>
<td>
<p><code>logical</code>: should data be scaled prior to
computing model?  If <code>TRUE</code>, <code>intercept</code> will be set
to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Input chronology data can be a <code>data.frame</code> such as produced
by function <code>chron</code> of package dplR. It has to be a
<code>data.frame</code> with at least one column containing the
tree-ring indices, and the corresponding years as <code>rownames</code>.
</p>
<p>For climatic input data, there are three possibilities: Firstly,
input climatic data can be a <code>data.frame</code> or <code>matrix</code>
consisting of at least 3 rows for years, months and at least one
climate parameter in the given order. Secondly, input climatic
data can be a single <code>data.frame</code> or <code>matrix</code> in the
style of the original DENDROCLIM2002 input data, i.e. one
parameter with 12 months in one row, where the first column
represents the year. Or thirdly, input climatic data can be a
(potentially named) list of one or several of the latter described
<code>data.frame</code> or <code>matrices</code>. If named list is provided,
potentially provided variable names through argument
<code>var_names</code> are ignored. As an internal format dispatcher
checks the format automatically, it is absolutely necessary that
in all three cases, only complete years (months 1-12) are
provided. It is not possible to mix different formats in one go.
</p>
<p>In 'dlm', there is no default parameter selection, in contrast to
'dcc'. Parameters can be selected with the 'selection' parameter
in two different ways:
</p>

<ul>
<li><p> simple selections: as an example -6:9 selects from all
climate variables all months from previous year's June (-6,
previous year's months are specified as negative integers) to
current years September (9, months of the current year are
specified as positive integers) as model parameters. Months from
the previous year and the year before that can be selected using
<a href="#topic+treeclim-shifters">treeclim-shifters</a> like <code>..(6)</code> to refer to July of
the year before the previous year.
</p>
</li>
<li><p> using <em>modifiers</em>: More complex parameter selections
can be obtained by the <em>modifiers</em> provided in treeclim:
<code>.range</code>, <code>.mean</code>, and <code>.sum</code>. These modifiers
can also be chained to create complex selections. See
<a href="#topic+treeclim-modifiers">treeclim-modifiers</a> for details.
</p>
</li></ul>

<p>For the exclusion of months, the convenience function
<code><a href="#topic+exclude_from">exclude_from</a></code> (or short <code><a href="#topic+exfr">exfr</a></code>) is
provided.
</p>
<p>With 'dlm' one would usually try to keep the number of predictors
low.
</p>
<p>For pretty output of the resulting linear model, parameters can be
renamed, to e.g. reflect the season they represent.
</p>


<h3>Value</h3>

<p>'dlm' returns an 'object' of class '&quot;tc_dlm&quot;', which is a
superclass of 'lm'. Additional elements to what is included in
standard 'lm' objects:
</p>
<table>
<tr><td><code>call_dlm</code></td>
<td>
<p>the call made to function 'dlm'</p>
</td></tr>
<tr><td><code>design</code></td>
<td>
<p>the design matrix on which this call to 'dlm'
operates</p>
</td></tr>
<tr><td><code>truncated</code></td>
<td>
<p>the input data truncated to the common timespan
or the specified timespan</p>
</td></tr>
<tr><td><code>original</code></td>
<td>
<p>the original input data, with the climate data
being recast into a single data.frame</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Christian Zang
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dlm1 &lt;- dlm(rt_spruce, rt_prec, .sum(6:8), param_names = "summer_prec")
summary(dlm1)

dlm2 &lt;- dlm(rt_spruce, list(rt_prec, rt_temp),
  .sum(6:8, "prec") + .mean(6:8, "temp"), var_names = c("prec", "temp"),
  param_names = c("summer_prec", "summer_temp"))
summary(dlm2)
anova(dlm1, dlm2)
</code></pre>

<hr>
<h2 id='eval_selection'>Eval a single list of specifications</h2><span id='topic+eval_selection'></span>

<h3>Description</h3>

<p>Evaluate a single list of specifications. Climate parameters are selected
from the parameter matrix by name, then the appropriate function is applied
to the correct month subset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eval_selection(clim, sel)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eval_selection_+3A_clim">clim</code></td>
<td>
<p>climate data as returned from make_pmat</p>
</td></tr>
<tr><td><code id="eval_selection_+3A_sel">sel</code></td>
<td>
<p>single list of parameter specifications</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list
</p>

<hr>
<h2 id='exclude_from'>Exclude months from analysis</h2><span id='topic+exclude_from'></span><span id='topic+exfr'></span>

<h3>Description</h3>

<p>Single months or ranges of months can be excluded from
analysis. This is helpful for e.g. excluding winter months without
cambial activity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exclude_from(month, exclude = NULL)

exfr(month, exclude = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exclude_from_+3A_month">month</code></td>
<td>
<p>range of numeric month ids</p>
</td></tr>
<tr><td><code id="exclude_from_+3A_exclude">exclude</code></td>
<td>
<p>range or set of months to exclude</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These convenience function is provided for the exclusion
of months. E.g., <code>.range(exclude_from(-6:10, -11:3))</code> will
yield the monthly values of all parameters for the months
previous June (-6) to current October (10), but without the
months previous November (-11) to current March (3) in
between. While it is also possible to supply arbitrary vectors
as month specification, and not only ranges as shown in most of
the examples here, this way of excluding e.g. the dormant season
is far more convenient.
</p>


<h3>Value</h3>

<p>a reduced set of numeric month ids
</p>


<h3>See Also</h3>

<p><code>link{.range}</code>, <code>link{.mean}</code>,
<code>link{.sum}</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exfr(-5:10, -10:3)
</code></pre>

<hr>
<h2 id='format_month'>Get positions and names for months</h2><span id='topic+format_month'></span>

<h3>Description</h3>

<p>Get positions for supplied numeric month ids in the 2-year span
under consideration, and connect to abbreviated month names for
previous and current year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_month(month)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="format_month_+3A_month">month</code></td>
<td>
<p>range or set of numeric month ids</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of positions and names
</p>

<hr>
<h2 id='g_test'>Gershunov test for spurious low-frequency modulations</h2><span id='topic+g_test'></span>

<h3>Description</h3>

<p>This function provides a test to decide whether low-frequency
modulations in the relationship between climate and tree-growth
are significantly stronger or weaker than could be expected by
chance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>g_test(x, boot = FALSE, sb = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="g_test_+3A_x">x</code></td>
<td>
<p>an object of class '&quot;tc_dcc&quot;' as returned from a call to
<code><a href="#topic+dcc">dcc</a></code> with moving correlations enabled</p>
</td></tr>
<tr><td><code id="g_test_+3A_boot">boot</code></td>
<td>
<p><code>logical</code> shall the individual correlations be
bootstrapped?  (see details)</p>
</td></tr>
<tr><td><code id="g_test_+3A_sb">sb</code></td>
<td>
<p><code>logical</code> shall a status bar be drawn?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a multivariate extension of the test for
spurious low-frequency modulations for moving correlations of time
series as proposed by Gershunov et al. (2001). In short, 1000
simulations of random data sets are generated, where the climate
data is simulated as Gaussian noise, and the tree-data as linear
combinations of the climate parameters using the original
coefficients of the correlation function, and an error component
with a variance equal to the variance unexplained by the
individual parameters.
</p>
<p>For each iteration, a moving correlation function is calculated
with exactly the same settings as the original model. The standard
deviation over the individual windows for each parameter is then
compared to the bootstrapped distribution of the standard
deviation of the simulated data to test for significantly higher
or lower low-frequency modulations.
</p>


<h3>Value</h3>

<p>a <code>data.frame</code> with p values for the testing the null
hypothesis that the low-frequency modulation of the
correlations of the variables with tree-growth can be
considered as noise.
</p>


<h3>References</h3>

<p>Gershunov, A., N. Schneider, and
T. Barnett. 2001. Low-frequency modulation of the ENSO-Indian
Monsoon rainfall relationship: Signal or noise? Journal of
Climate 14:2486-2492.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dc_cor &lt;- dcc(muc_spruce, muc_clim, 3:9, method = "cor", moving = TRUE)
g_test(dc_cor)

## End(Not run)
</code></pre>

<hr>
<h2 id='init_boot_data'>initialize data structure for bootstrapping</h2><span id='topic+init_boot_data'></span>

<h3>Description</h3>

<p>this will create an array for the climate data and corresponding
matrix for the tree-ring data, holding the randomly resampled data
for bootstrapping
</p>


<h3>Usage</h3>

<pre><code class='language-R'>init_boot_data(u, g, n, boot)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="init_boot_data_+3A_u">u</code></td>
<td>
<p>climate data (matrix with parameters in columns and years in rows)</p>
</td></tr>
<tr><td><code id="init_boot_data_+3A_g">g</code></td>
<td>
<p>vector with tree-ring data</p>
</td></tr>
<tr><td><code id="init_boot_data_+3A_n">n</code></td>
<td>
<p>times for resampling</p>
</td></tr>
<tr><td><code id="init_boot_data_+3A_boot">boot</code></td>
<td>
<p>one of c(&quot;stationary&quot;, &quot;std&quot;, &quot;exact&quot;, &quot;none&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list
</p>

<hr>
<h2 id='is_continuous'>Check if month specification is continuous</h2><span id='topic+is_continuous'></span>

<h3>Description</h3>

<p>If month specification is continuous, this function will return
TRUE, and FALSE if not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_continuous(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_continuous_+3A_x">x</code></td>
<td>
<p>a numeric month id specification</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE or FALSE
</p>

<hr>
<h2 id='make_pmat'>Make list of parameter matrices from climate input data</h2><span id='topic+make_pmat'></span>

<h3>Description</h3>

<p>Reformat climate input data into separate lists
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_pmat(x, pad = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_pmat_+3A_x">x</code></td>
<td>
<p>climate data as returned from as_tcclimate</p>
</td></tr>
<tr><td><code id="make_pmat_+3A_pad">pad</code></td>
<td>
<p>how many previous years should be padded with NAs? This is useful when
we want to use the full range of available data when all predictors derive
from the current year (pad = 2, or current and previous, for pad = 1)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Make separate lists for each parameter in the climate data input, and make
them accessible by the parameter names. The single lists correspond to the
scheme years in rows, observations from previous december to current
december in columns.
</p>


<h3>Value</h3>

<p>a list of matrices
</p>

<hr>
<h2 id='make_range_list'>deconstruct call to modifier into list</h2><span id='topic+make_range_list'></span>

<h3>Description</h3>

<p>deconstructs the call to a modifier into a list for further
processing with the list-based parameter selection functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_range_list(call, method)
</code></pre>

<hr>
<h2 id='muc_clim'>Monthly Mean Temperature and Total Precipitation for Forstenrieder
Park, Munich</h2><span id='topic+muc_clim'></span>

<h3>Description</h3>

<p>This dataset gives the monthly mean temperature and total
precipitation at Forstenrieder Park, Munich, Bavaria, Germany.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(muc_clim)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing four columns with year,
month, temperature and precipitation.
</p>


<h3>Source</h3>

<p>Zang C, Pretzsch H, Rothe A (2012) Size-dependent
responses to summer drought in Scots pine, Norway spruce and
common oak. Trees - Structure and Function, 26, 557-569.
</p>

<hr>
<h2 id='muc_fake'>Modeled Tree-Ring Chronology of a Spruce Population near Munich</h2><span id='topic+muc_fake'></span>

<h3>Description</h3>

<p>This dataset gives the modelled tree-ring widths for <em>Picea
abies</em> at Forstenrieder Park, Munich, Bavaria, Germany. Tree
growth was modeled as a response of low temperatures in previous
and current July and August, high temperatures in current February
and March, and high precipitation amounts in current July and
August.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(muc_fake)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing tree-ring indices and
replication depth with respective years as <code>rownames</code>.
</p>


<h3>Source</h3>

<p>Zang C, Pretzsch H, Rothe A (2012) Size-dependent
responses to summer drought in Scots pine, Norway spruce and
common oak. Trees - Structure and Function, 26, 557-569.
</p>

<hr>
<h2 id='muc_spruce'>Tree-Ring Chronology of a Spruce Population near Munich</h2><span id='topic+muc_spruce'></span>

<h3>Description</h3>

<p>This dataset gives the tree-ring indices for <em>Picea abies</em> at
Forstenrieder Park, Munich, Bavaria, Germany. The chronology
represents 20 cores from 10 trees. The series were read in using
<code><a href="dplR.html#topic+read.rwl">read.rwl</a></code> from package <code>dplR</code>, detrended
using a 60a spline with 50% frequency cutoff (function
<code><a href="dplR.html#topic+detrend">detrend</a></code>), and averaged to a chronology using a
robust mean <code><a href="dplR.html#topic+chron">chron</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(muc_spruce)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing tree-ring indices and
replication depth with respective years as <code>rownames</code>.
</p>


<h3>Source</h3>

<p>Zang C, Pretzsch H, Rothe A (2012) Size-dependent
responses to summer drought in Scots pine, Norway spruce and
common oak. Trees - Structure and Function, 26, 557-569.
</p>

<hr>
<h2 id='norw015'>Tree-Ring Chronology of a Pine Population at Visdalen, Norway</h2><span id='topic+norw015'></span>

<h3>Description</h3>

<p>This dataset gives the tree-ring indices for <em>Pinus
sylvestris</em> at a site near Visdalen, Norway. The chronology
represents 34 dated series and spans the period between 1600 and
1983. The raw measurements were obtained from the ITRDB (see
source), and read in, detrended with cubic splines (frequency
cutoff of 50 percent at two thirds of the series length) and
averaged using <code><a href="dplR.html#topic+read.rwl">read.rwl</a></code>,
<code><a href="dplR.html#topic+detrend">detrend</a></code>, and <code><a href="dplR.html#topic+chron">chron</a></code> from
package <code>dplR</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(norw015)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing tree-ring indices and
replication depth with respective years as <code>rownames</code>.
</p>


<h3>Source</h3>

<p>Briffa K. Briffa - Visdalen - PISY - ITRDB
NORW015. http://hurricane.ncdc.noaa.gov/pls/paleox/f?p=519:1:::::P1_STUDY_ID:2861. Accessed
2014/07/03.
</p>

<hr>
<h2 id='norway_prec'>Monthly Precipitation Sums for Norway</h2><span id='topic+norway_prec'></span>

<h3>Description</h3>

<p>This data set gives the monthly precipitation sums at country
level for Norway in a decadal (DENDROCLIM2002-style) format from
the TYN CY 1.1 data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(norway_prec)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing thirteen columns with year
and twelve months of temperature data in degree Celsius.
</p>


<h3>Source</h3>

<p>Mitchell TD, Carter TR, Jones PD, Hulme M, New M, et
al. (2004) A comprehensive set of high-resolution grids of monthly
climate for Europe and the globe: the observed record (1901-2000)
and 16 scenarios (2001-2100). Tyndall Centre for Climate Change
Research Working Paper 55, 25.
</p>

<hr>
<h2 id='norway_temp'>Monthly Temperature Means for Norway</h2><span id='topic+norway_temp'></span>

<h3>Description</h3>

<p>This data set gives the monthly temperature means at country level
for Norway in a decadal (DENDROCLIM2002-style) format from the TYN
CY 1.1 data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(norway_temp)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing thirteen columns with year
and twelve months of temperature data in degree Celsius.
</p>


<h3>Source</h3>

<p>Mitchell TD, Carter TR, Jones PD, Hulme M, New M, et
al. (2004) A comprehensive set of high-resolution grids of monthly
climate for Europe and the globe: the observed record (1901-2000)
and 16 scenarios (2001-2100). Tyndall Centre for Climate Change
Research Working Paper 55, 25.
</p>

<hr>
<h2 id='ptest'>Significance test for bootstrapped coefficients</h2><span id='topic+ptest'></span>

<h3>Description</h3>

<p>For internal use only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ptest(bc, ci, c0 = NULL, method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ptest_+3A_bc">bc</code></td>
<td>
<p>the parameter matrix as returned from correlation of the
bootstapped samples (n * 1000 matrix, with n = number of
parameters)</p>
</td></tr>
<tr><td><code id="ptest_+3A_ci">ci</code></td>
<td>
<p>confidence level, one of c(0.01, 0.05, 0.1)</p>
</td></tr>
<tr><td><code id="ptest_+3A_c0">c0</code></td>
<td>
<p>for weibull: correlation vector for original model</p>
</td></tr>
<tr><td><code id="ptest_+3A_method">method</code></td>
<td>
<p>method for significance test</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a logical vector indicating significance
</p>

<hr>
<h2 id='rt_prec'>Monthly Precipitation Sums for Rothenburg ob der Tauber, Germany</h2><span id='topic+rt_prec'></span>

<h3>Description</h3>

<p>This dataset gives the monthly precipitation sum at Rothenburg ob der Tauber,
Bavaria, Germany in a decadal (DENDROCLIM2002-style) format)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rt_prec)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing thirteen columns with year
and twelve months of precipitation data in mm rainfall.
</p>


<h3>Source</h3>

<p>Zang C, Rothe A, Weis W, Pretzsch H (2011) Zur
Baumarteneignung bei Klimawandel: Ableitung der
Trockenstress-Anfaelligkeit wichtiger Waldbaumarten aus
Jahrringbreiten. Allgemeine Forst- und Jagdzeitung, 182, 98-112.
</p>

<hr>
<h2 id='rt_spruce'>Tree-Ring Chronology of a Spruce Population at Rothenburg ob der Tauber</h2><span id='topic+rt_spruce'></span>

<h3>Description</h3>

<p>This dataset gives the tree-ring indices for <em>Picea abies</em> at Rothenburg
ob der Tauber, Bavaria, Germany. The chronology represents 20 cores from 10
trees. The series were read in using <code><a href="dplR.html#topic+read.rwl">read.rwl</a></code> from
package <code>dplR</code>, detrended using a 60a spline with 50% frequency cutoff
(function <code><a href="dplR.html#topic+detrend">detrend</a></code>), and averaged to a chronology using a 
robust mean <code><a href="dplR.html#topic+chron">chron</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rt_spruce)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing tree-ring indices and
replication depth with respective years as <code>rownames</code>.
</p>


<h3>Source</h3>

<p>Zang C, Rothe A, Weis W, Pretzsch H (2011) Zur
Baumarteneignung bei Klimawandel: Ableitung der
Trockenstress-Anfaelligkeit wichtiger Waldbaumarten aus
Jahrringbreiten. Allgemeine Forst- und Jagdzeitung, 182, 98-112.
</p>

<hr>
<h2 id='rt_temp'>Monthly Temperature Means for Rothenburg ob der Tauber, Germany</h2><span id='topic+rt_temp'></span>

<h3>Description</h3>

<p>This dataset gives the monthly temperature means at Rothenburg ob der Tauber,
Bavaria, Germany in a decadal (DENDROCLIM2002-style) format)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rt_temp)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing thirteen columns with year
and twelve months of temperature data in degree Celsius.
</p>


<h3>Source</h3>

<p>Zang C, Rothe A, Weis W, Pretzsch H (2011) Zur
Baumarteneignung bei Klimawandel: Ableitung der
Trockenstress-Anfaelligkeit wichtiger Waldbaumarten aus
Jahrringbreiten. Allgemeine Forst- und Jagdzeitung, 182, 98-112.
</p>

<hr>
<h2 id='seascorr'>Seasonal (partial) correlation analysis</h2><span id='topic+seascorr'></span>

<h3>Description</h3>

<p>Calculate seasonal correlation with primary and secondary climate
variables and tree-ring data, similar to the seascorr function for
MATLAB.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seascorr(
  chrono,
  climate,
  var_names = NULL,
  timespan = NULL,
  complete = 9,
  season_lengths = c(1, 3, 6),
  primary = 1,
  secondary = 2,
  ci = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seascorr_+3A_chrono">chrono</code></td>
<td>
<p><code>data.frame</code> containing a tree-ring
chronologies, e.g. as obtained by <code>chron</code> of package dplR.</p>
</td></tr>
<tr><td><code id="seascorr_+3A_climate">climate</code></td>
<td>
<p>either a <code>data.frame</code> or <code>matrix</code> with
climatic data in monthly resolution, with year, month and
climate parameters in columns (all columns except year and month
will be recognized as parameters for response or correlation
functions), or a single <code>data.frame</code> or <code>matrix</code> in
13-column format (see below), or a (potentially named) list of
one or several of the latter.</p>
</td></tr>
<tr><td><code id="seascorr_+3A_var_names">var_names</code></td>
<td>
<p><code>character</code> vector with variable
names. Defaults to corresponding column names of parameter <code>climate</code> if
given as <code>data.frame</code>, or its names if given as <code>list</code>.</p>
</td></tr>
<tr><td><code id="seascorr_+3A_timespan">timespan</code></td>
<td>
<p><code>integer</code> vector of length 2 specifying the
time interval (in years) to be considered for analysis. Defaults
to the maximum possible interval.</p>
</td></tr>
<tr><td><code id="seascorr_+3A_complete">complete</code></td>
<td>
<p><code>integer</code> scalar, month when tree-ring growth
is expected to have finished.</p>
</td></tr>
<tr><td><code id="seascorr_+3A_season_lengths">season_lengths</code></td>
<td>
<p><code>numeric</code> vector giving the lengths of
the seasons for variable grouping</p>
</td></tr>
<tr><td><code id="seascorr_+3A_primary">primary</code></td>
<td>
<p>position <code>numeric</code> or name <code>character</code> of
primary climate variable</p>
</td></tr>
<tr><td><code id="seascorr_+3A_secondary">secondary</code></td>
<td>
<p>position <code>numeric</code> or name <code>character</code>
of secondary climate variable</p>
</td></tr>
<tr><td><code id="seascorr_+3A_ci">ci</code></td>
<td>
<p><code>numerical</code> value to set the test level for
significance test (values 0.01, 0.05 and 0.1 are allowed); the
confidence intervals are adapted accordingly.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function mimicks the behaviour of the MATLAB function
seascorr (Meko et al. 2011), which calculates partial correlations
of tree-ring data with a primary and a secondary climatic variable
for seasons of different lengths.
</p>
<p>Input chronology data can be a <code>data.frame</code> such as produced
by function <code>chron</code> of package dplR. It has to be a
<code>data.frame</code> with at least one column containing the
tree-ring indices, and the corresponding years as <code>rownames</code>.
</p>
<p>For climatic input data, there are three possibilities: Firstly,
input climatic data can be a <code>data.frame</code> or <code>matrix</code>
consisting of at least 3 rows for years, months and at least one
climate parameter in the given order. Secondly, input climatic
data can be a single <code>data.frame</code> or <code>matrix</code> in the
style of the original DENDROCLIM2002 input data, i.e. one
parameter with 12 months in one row, where the first column
represents the year. Or thirdly, input climatic data can be a list
of several of the latter described <code>data.frame</code> or
<code>matrices</code>. As an internal format dispatcher checks the
format automatically, it is absolutely necessary that in all three
cases, only complete years (months 1-12) are provided. It is not
possible to mix different formats in one go.
</p>
<p>The 'complete' parameter specifies the months of the current year
in which tree-growth is assumed to finish. This month marks the
last month of the first season, and starting from here, 14
different seasons are computed for each specified season length in
one-month steps. E.g., for a starting value of 9 (current
September) and season length of 3 months, the first season
comprises current July to current September, the second season
comprises current June to current August, and the last season
comprises previous June to previous August. This results in 14
seasons for a given season length. An arbitrary number of season
lengths can be specified.
</p>
<p>The choice for primary vs. secondary variable can be made either
via numeric selection (the integer value 1 stands for the first
variable in the supplied climate data set), or by name (&quot;temp&quot;,
when one of the variables is named &quot;temp&quot;). The correlation of the
primary variable with tree-growth is computed as the simple
(Pearson) correlation coefficient, while the influence of the
secondary variable on tree-growth is computed with the influence
of the primary variable on tree-growth removed.
</p>
<p>Like in the original seascorr program, the significance of each
(partial) correlation is evaluated using exact bootstrapping by
circulant embedding of the tree-ring data (Percival \&amp;
Constantine, 2006).
</p>


<h3>Value</h3>

<p>'seascorr' returns an 'object' of class '&quot;tc_seascorr&quot;'.
</p>
<p>The 'plot' function is used to obtain a plot of the results.
</p>
<p>An object of class '&quot;tc_seascorr&quot;' is a list containing at least
the following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the call made to 'seascorr'</p>
</td></tr>
<tr><td><code>seasons</code></td>
<td>
<p>a list of length n, where n is the number of season
lengths provided; each list element consists of a data.frame
with end month, correlation coefficient and significance flag</p>
</td></tr>
<tr><td><code>truncated</code></td>
<td>
<p>the input data truncated to the common timespan
or the specified timespan</p>
</td></tr>
<tr><td><code>original</code></td>
<td>
<p>the original input data, with the climate data
being recast into a single data.frame</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Christian Zang; the procedure incl. exact bootstrapping
was implemented first by Dave Meko in MATLAB
</p>


<h3>References</h3>

<p>Meko DM, Touchan R, Anchukaitis KJ (2011) Seascorr: A MATLAB
program for identifying the seasonal climate signal in an annual
tree-ring time series. Computers &amp; Geosciences, 37, 1234-1241.
</p>
<p>Percival DB, Constantine WLB (2006) Exact simulation of Gaussian
Time Series from Nonparametric Spectral Estimates with
Application to Bootstrapping. Statistics and Computing 16:25-35
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sc &lt;- seascorr(muc_fake, muc_clim)
sc
plot(sc)
</code></pre>

<hr>
<h2 id='shift_year'>shifts a month 0, 1, or 2 years back</h2><span id='topic+shift_year'></span>

<h3>Description</h3>

<p>there is no intuitive way to signify months from the year previous to the
last one...
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shift_year(month, by = 0)
</code></pre>

<hr>
<h2 id='skills'>Evaluate reconstruction skills using split-calibration</h2><span id='topic+skills'></span>

<h3>Description</h3>

<p>This function allows to evaluate the reconstruction skills for a
given proxy time series in split-calibration approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skills(
  object,
  target = NULL,
  model = "ols",
  calibration = "50%",
  timespan = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="skills_+3A_object">object</code></td>
<td>
<p>an object of class &quot;tc_dcc&quot;, &quot;tc_dlm&quot;, or
&quot;tc_seascorr&quot;</p>
</td></tr>
<tr><td><code id="skills_+3A_target">target</code></td>
<td>
<p>a treeclim selection modifier specifying the climate
target to be reconstructed, see below for details</p>
</td></tr>
<tr><td><code id="skills_+3A_model">model</code></td>
<td>
<p>one of &quot;ols&quot; or &quot;rma&quot;</p>
</td></tr>
<tr><td><code id="skills_+3A_calibration">calibration</code></td>
<td>
<p>which part of the data shall be used as
calibration subset? Given as either a range of years, an integer
corresponding to the first or last number of observations, or a
percentage as character string corresponding to the part of the
data set to be used as calibration subset.</p>
</td></tr>
<tr><td><code id="skills_+3A_timespan">timespan</code></td>
<td>
<p>timespan to be used to truncate the data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The result of a call to <code><a href="#topic+dcc">dcc</a></code>, <code><a href="#topic+dlm">dlm</a></code>, or
<code><a href="#topic+seascorr">seascorr</a></code> can be used as <code>object</code> for the
function. The required data is then taken from this object and no
further processing of the tree and climate variables has to be
done for by the user. This reflects the flow of analysis, where
first general climate/growth relations are explored, and then the
strongest ones are deployed for reconstruction purposes.
</p>
<p><code>target</code> is an aggregation modifier (one of
<code><a href="#topic+.mean">.mean</a></code>, <code><a href="#topic+.sum">.sum</a></code>, and
<code><a href="#topic+.range">.range</a></code>). The user should be aware of the fact that
in case the aggregation modifier evaluates to more than one
variable (e.g., summer means for both temperature and
precipiation), a warning message is issued, and only the first
variable is taken into consideration for evaluating the
reconstruction skills. If not specified, the selection from the
original call to <code><a href="#topic+dcc">dcc</a></code>, <code><a href="#topic+seascorr">seascorr</a></code>, or
<code><a href="#topic+dlm">dlm</a></code> is used.
</p>
<p>The type of regression model (ordinary least squares or
errors-in-variables via reduced major axis regression) can be
selected.
</p>
<p>The part of the data to be used as a calibration subset can be
specified in three different ways: 1) as a range of years, these
are then taken as calibration period; 2) as a single integer, if
positive, this number of observations at the recent end of the
data set is taken as calibration set, if negative, this number of
oldest observations is taken; and 3) as a character string giving
a percentage of values, e.g., &quot;-40%&quot; would select the 40% oldest
observations, while &quot;55%&quot; would select the 55% most recent ones.
</p>
<p>The relationship between climate and tree-ring data is evaluated
for the calibration period and the complete data set. Frequently
used verification statistics are computed: reduction of error
(RE), coefficient of efficiency (CE), and the Durban-Watson
statistic (DW) (Cook et al. 1994, Durbin and Watson, 1951).
</p>


<h3>Value</h3>

<p>'skills' returns an 'object' of class '&quot;tc_skills&quot;'.
</p>
<p>An object of class '&quot;tc_skills&quot;' is a list containing at least
the following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the call made to function 'skills'</p>
</td></tr>
<tr><td><code>target</code></td>
<td>
<p>the target used for reconstruction</p>
</td></tr>
<tr><td><code>r.cal</code></td>
<td>
<p>the coefficient of correlation for the calibration
timespan</p>
</td></tr>
<tr><td><code>r.full</code></td>
<td>
<p>the coefficient of correlation for the complete
data set</p>
</td></tr>
<tr><td><code>coef.cal</code></td>
<td>
<p>regression coefficients for the calibration
model</p>
</td></tr>
<tr><td><code>coef.full</code></td>
<td>
<p>regression coefficients for the full model</p>
</td></tr>
<tr><td><code>p.cal</code></td>
<td>
<p>significance for the calibration model</p>
</td></tr>
<tr><td><code>p.full</code></td>
<td>
<p>significance for the full model</p>
</td></tr>
<tr><td><code>RE</code></td>
<td>
<p>reduction of error statistic</p>
</td></tr>
<tr><td><code>CE</code></td>
<td>
<p>coefficient of efficiency statistic</p>
</td></tr>
<tr><td><code>DW</code></td>
<td>
<p>Durbin-Watson statistic</p>
</td></tr>
<tr><td><code>RMSE</code></td>
<td>
<p>The root mean squared error for the prediction
interval</p>
</td></tr>
<tr><td><code>cal.model</code></td>
<td>
<p>the complete calibration model (an object of
class 'lmodel2')</p>
</td></tr>
<tr><td><code>full.mode</code></td>
<td>
<p>the complete full model (an object of class
'lmodel2')</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cook E, Briffa K, Jones P (1994) Spatial regression
methods in dendroclimatology: A review and comparison of two
techniques. International Journal of Climatology, 14, 379-402.
</p>
<p>Durbin, J, Watson, GS (1951) Testing for serial correlation in
least squares regression. Biometrika 38:159-78.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dc &lt;- dcc(muc_fake, muc_clim, .mean(6:9, "temp") + .sum(6:9,
"prec"))
sk &lt;- skills(dc)
sk
plot(sk)

## End(Not run)
</code></pre>

<hr>
<h2 id='spai020'>Tree-Ring Chronology of a Pine Population at Penota, Spain</h2><span id='topic+spai020'></span>

<h3>Description</h3>

<p>This dataset gives the tree-ring indices for <em>Pinus
sylvestris</em> at a site near Penota, Spain. The chronology
represents 18 dated series and spans the period between 1763 and
1991. The chronology was obtained from the ITRDB (see source), and
read in using <code><a href="dplR.html#topic+read.crn">read.crn</a></code> from package
<code>dplR</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(spai020)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing tree-ring indices and
replication depth with respective years as <code>rownames</code>.
</p>


<h3>Source</h3>

<p>Fernandez-Cancio A, Genova Fuster M: Fernandez-Cancio -
Penota - PISY - ITRDB SPAI020,
http://hurricane.ncdc.noaa.gov/pls/paleox/f?p=519:1:::::P1_STUDY_ID:3255,
accessed 2014/07/03.
</p>

<hr>
<h2 id='spain_prec'>Monthly Precipitation Sums for Spain</h2><span id='topic+spain_prec'></span>

<h3>Description</h3>

<p>This data set gives the monthly precipitation sums at country
level for Spain in a decadal (DENDROCLIM2002-style) format from
the TYN CY 1.1 data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(spain_prec)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing thirteen columns with year
and twelve months of temperature data in degree Celsius.
</p>


<h3>Source</h3>

<p>Mitchell TD, Carter TR, Jones PD, Hulme M, New M, et
al. (2004) A comprehensive set of high-resolution grids of monthly
climate for Europe and the globe: the observed record (1901-2000)
and 16 scenarios (2001-2100). Tyndall Centre for Climate Change
Research Working Paper 55, 25.
</p>

<hr>
<h2 id='spain_temp'>Monthly Temperature Means for Spain</h2><span id='topic+spain_temp'></span>

<h3>Description</h3>

<p>This data set gives the monthly temperature means at country level
for Spain in a decadal (DENDROCLIM2002-style) format from the TYN
CY 1.1 data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(spain_temp)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing thirteen columns with year
and twelve months of temperature data in degree Celsius.
</p>


<h3>Source</h3>

<p>Mitchell TD, Carter TR, Jones PD, Hulme M, New M, et
al. (2004) A comprehensive set of high-resolution grids of monthly
climate for Europe and the globe: the observed record (1901-2000)
and 16 scenarios (2001-2100). Tyndall Centre for Climate Change
Research Working Paper 55, 25.
</p>

<hr>
<h2 id='tc_correlation'>(bootstrapped) correlation function</h2><span id='topic+tc_correlation'></span>

<h3>Description</h3>

<p>See documentation of dcc for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tc_correlation(chrono, climate, ci, boot)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tc_correlation_+3A_chrono">chrono</code></td>
<td>
<p>a tree-ring chronology</p>
</td></tr>
<tr><td><code id="tc_correlation_+3A_climate">climate</code></td>
<td>
<p>data.frame with climate parameters</p>
</td></tr>
<tr><td><code id="tc_correlation_+3A_ci">ci</code></td>
<td>
<p>numeric: p-level for confidence interval (must be in
c(0.1, 0.05, 0.01)</p>
</td></tr>
<tr><td><code id="tc_correlation_+3A_boot">boot</code></td>
<td>
<p>character, which bootstrapping method should be used
(or &quot;none&quot;)</p>
</td></tr>
<tr><td><code id="tc_correlation_+3A_p">p</code></td>
<td>
<p>probability for rgeom, that determines distribution of
sampling blocks for stationary bootstrap scheme</p>
</td></tr>
</table>

<hr>
<h2 id='tc_design'>Deparse list structure from month specification and return parameter set</h2><span id='topic+tc_design'></span>

<h3>Description</h3>

<p>Deparse list structure from month specification into single calls, call an
aggregating function to collect the data, and return a parameter set for
calibration. In general, the months must be specified as a list or nested
list structure. Possible cases are:
list()
list(...)
list(list(...))
list(list(...), list(...), ...)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tc_design(selection, climate, check_2 = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tc_design_+3A_selection">selection</code></td>
<td>
<p>the list structure to specify the month selection</p>
</td></tr>
<tr><td><code id="tc_design_+3A_climate">climate</code></td>
<td>
<p>the climate data as returned by make_pmat</p>
</td></tr>
<tr><td><code id="tc_design_+3A_check_2">check_2</code></td>
<td>
<p>should there be a check for less than 2 variables
in the design matrix?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame
</p>

<hr>
<h2 id='tc_efunc'>evolving response and correlation function</h2><span id='topic+tc_efunc'></span>

<h3>Description</h3>

<p>see doc for dcc for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tc_efunc(chrono, climate, boot, sb, start_last, win_size, ci, method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tc_efunc_+3A_chrono">chrono</code></td>
<td>
<p>tree-ring chronology</p>
</td></tr>
<tr><td><code id="tc_efunc_+3A_climate">climate</code></td>
<td>
<p>data.frame with climate parameters</p>
</td></tr>
<tr><td><code id="tc_efunc_+3A_boot">boot</code></td>
<td>
<p>which bootstrapping method should be used? (or &quot;none&quot;)</p>
</td></tr>
<tr><td><code id="tc_efunc_+3A_sb">sb</code></td>
<td>
<p>logical: draw statusbar or not?</p>
</td></tr>
<tr><td><code id="tc_efunc_+3A_start_last">start_last</code></td>
<td>
<p>logical: start with last (oldest) window?</p>
</td></tr>
<tr><td><code id="tc_efunc_+3A_win_size">win_size</code></td>
<td>
<p>numeric: size of the first window in years</p>
</td></tr>
<tr><td><code id="tc_efunc_+3A_ci">ci</code></td>
<td>
<p>numeric: p-level for confidence interval (must be in
c(0.1, 0.05, 0.01)</p>
</td></tr>
<tr><td><code id="tc_efunc_+3A_method">method</code></td>
<td>
<p>character: method to be used (one of &quot;response&quot; or
&quot;correlation&quot;)</p>
</td></tr>
<tr><td><code id="tc_efunc_+3A_p">p</code></td>
<td>
<p>probability for rgeom, that determines distribution of
sampling blocks for stationary bootstrap scheme</p>
</td></tr>
</table>

<hr>
<h2 id='tc_mfunc'>moving response and correlation function</h2><span id='topic+tc_mfunc'></span>

<h3>Description</h3>

<p>see doc for dcc for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tc_mfunc(
  chrono,
  climate,
  boot,
  sb,
  start_last,
  win_size,
  win_offset,
  ci,
  method
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tc_mfunc_+3A_chrono">chrono</code></td>
<td>
<p>tree-ring chronology</p>
</td></tr>
<tr><td><code id="tc_mfunc_+3A_climate">climate</code></td>
<td>
<p>data.frame with climate parameters</p>
</td></tr>
<tr><td><code id="tc_mfunc_+3A_boot">boot</code></td>
<td>
<p>which bootstrapping method should be used? (or &quot;none&quot;)</p>
</td></tr>
<tr><td><code id="tc_mfunc_+3A_sb">sb</code></td>
<td>
<p>logical: draw statusbar or not?</p>
</td></tr>
<tr><td><code id="tc_mfunc_+3A_start_last">start_last</code></td>
<td>
<p>logical: start with last (oldest) window?</p>
</td></tr>
<tr><td><code id="tc_mfunc_+3A_win_size">win_size</code></td>
<td>
<p>numeric: size of the moving windows in years</p>
</td></tr>
<tr><td><code id="tc_mfunc_+3A_win_offset">win_offset</code></td>
<td>
<p>numeric: size of offset between moving windows
in years</p>
</td></tr>
<tr><td><code id="tc_mfunc_+3A_ci">ci</code></td>
<td>
<p>numeric: p-level for confidence interval (must be in
c(0.1, 0.05, 0.01)</p>
</td></tr>
<tr><td><code id="tc_mfunc_+3A_method">method</code></td>
<td>
<p>character: method to be used (one of &quot;response&quot; or
&quot;correlation&quot;)</p>
</td></tr>
<tr><td><code id="tc_mfunc_+3A_p">p</code></td>
<td>
<p>probability for rgeom, that determines distribution of
sampling blocks for stationary bootstrap scheme</p>
</td></tr>
</table>

<hr>
<h2 id='tc_response'>(bootstrapped) response function</h2><span id='topic+tc_response'></span>

<h3>Description</h3>

<p>See documentation of dcc for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tc_response(chrono, climate, ci, boot)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tc_response_+3A_chrono">chrono</code></td>
<td>
<p>a tree-ring chronology</p>
</td></tr>
<tr><td><code id="tc_response_+3A_climate">climate</code></td>
<td>
<p>data.frame with climate parameters</p>
</td></tr>
<tr><td><code id="tc_response_+3A_ci">ci</code></td>
<td>
<p>numeric: p-level for confidence interval (must be in
c(0.1, 0.05, 0.01)</p>
</td></tr>
<tr><td><code id="tc_response_+3A_boot">boot</code></td>
<td>
<p>string: which bootstrapping method?</p>
</td></tr>
<tr><td><code id="tc_response_+3A_p">p</code></td>
<td>
<p>probability for rgeom, that determines distribution of
sampling blocks for stationary bootstrap scheme</p>
</td></tr>
</table>

<hr>
<h2 id='traceplot'>Trace the temporal development of response or correlation coefficients</h2><span id='topic+traceplot'></span>

<h3>Description</h3>

<p>This is a plotting function that takes the output from a dynamic (&quot;moving&quot;
or &quot;evolving&quot;) <code>dcc</code> run to trace the temporal development of all or
selected variables. The variables can be selected using their name, partial
matching is allowed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>traceplot(x, variables = NULL, facet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="traceplot_+3A_x">x</code></td>
<td>
<p>an object returned from a call to <code>dcc</code> with parameter
<code>dynamic</code> set to either &quot;moving&quot; or &quot;evolving&quot;.</p>
</td></tr>
<tr><td><code id="traceplot_+3A_variables">variables</code></td>
<td>
<p>a character vector of variable names to be plotted; if NULL
(default), all variables will be traced</p>
</td></tr>
<tr><td><code id="traceplot_+3A_facet">facet</code></td>
<td>
<p>logical: shall the plot be splitted into facets for different
variables?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class &quot;gg&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dc_resp &lt;- dcc(muc_spruce, muc_clim, 4:9, dynamic = "evolving")
traceplot(dc_resp, c("prec.curr.may", "prec.curr.jun"))

## End(Not run)
</code></pre>

<hr>
<h2 id='treeclim-modifiers'>Modifiers for climate parameter selection</h2><span id='topic+treeclim-modifiers'></span><span id='topic+.range'></span><span id='topic+.mean'></span><span id='topic+.sum'></span>

<h3>Description</h3>

<p>These modifiers are used to select specific months from specific
climate parameters, and potentially transform the selections into
their respective sums or means. The modifiers can be chained
together using '+'.
<code>.range</code> corresponds to using all specified months
separately, while <code>.sum</code> and <code>.mean</code> will use the sums
and means of the specified months. These modifiers also allow to
select specific climatic variables, addressed by name. Thus,
<code>.mean(4:8, "temp")</code> will select the mean for climate
parameter &quot;temp&quot; for the months April to August. Not only ranges,
but also individual vectors can be used for month specification,
like e.g., <code>.range(c(1, 3, 4, 5)</code>.
</p>
<p>The modifiers can be chained together using the '+' symbol, which
makes it possible to create arbitrarily complex selections of
climate parameters for calibration.  E.g., <code>.mean(2:5,
"temp") + .sum(2:5, "prec")</code> will yield the February-to-May mean
for the variable &quot;temp&quot; and the sum of the variable &quot;prec&quot; for the
same time. While there is no limitation for number of lists that
can be chained together, 'dcc' will not check for meaningful
specifications. Testing smart hypotheses is up the researcher.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.range(.months = NULL, .variables = NULL)

.mean(.months = NULL, .variables = NULL)

.sum(.months = NULL, .variables = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="treeclim-modifiers_+3A_.months">.months</code></td>
<td>
<p>numeric identifiers for the months (-1 for previous
January until 12 for current December, with -6 for previous
June, etc.)</p>
</td></tr>
<tr><td><code id="treeclim-modifiers_+3A_.variables">.variables</code></td>
<td>
<p>names of the variables the modifier shall be
applied to</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
my_calib &lt;- dcc(rt_spruce, list(prec = rt_prec, temp = rt_temp),
  .range(4:9, "temp") + .mean(-5:-9, "temp") + .sum(3:10, "prec"))
plot(my_calib)

## End(Not run)
</code></pre>

<hr>
<h2 id='treeclim-shifters'>Shift months one or two years back</h2><span id='topic+treeclim-shifters'></span><span id='topic+.'></span><span id='topic+..'></span>

<h3>Description</h3>

<p>These functions are used to specify months from previous years for
the design matrix. <code>.(1)</code> is the same as <code>-1</code>, and
specifies previous year's January, whereas <code>..(1)</code> signifies
January of the year prior to the last year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.(x)

..(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="treeclim-shifters_+3A_x">x</code></td>
<td>
<p>numeric identifier (of length 1) for the months (1 for
January, ..., 12 for December)</p>
</td></tr>
</table>

<hr>
<h2 id='truncate_input'>Truncate climate and tree data to common interval</h2><span id='topic+truncate_input'></span>

<h3>Description</h3>

<p>Truncate climate and tree data either to common shared interval
(default) or to specified range of years. Depending on minmonth,
the climate data will need to start one year earlier than the tree
data, if data from the previous year should be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>truncate_input(
  chrono,
  climate,
  timespan = NULL,
  minmonth,
  dynamic,
  silent = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="truncate_input_+3A_chrono">chrono</code></td>
<td>
<p>a tree-ring chronology</p>
</td></tr>
<tr><td><code id="truncate_input_+3A_climate">climate</code></td>
<td>
<p>the climate data as returned by as_tcclimate</p>
</td></tr>
<tr><td><code id="truncate_input_+3A_timespan">timespan</code></td>
<td>
<p>the timespan for truncating as vector with min and max year</p>
</td></tr>
<tr><td><code id="truncate_input_+3A_minmonth">minmonth</code></td>
<td>
<p>the earliest month used for the calibration, as
returned by check_months</p>
</td></tr>
<tr><td><code id="truncate_input_+3A_moving">moving</code></td>
<td>
<p>moving or not? (logical)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of truncated data.frames for climate and tree data
</p>

<hr>
<h2 id='unify_selection'>unify selections to handle &quot;classic&quot; (bootRes-style) selections</h2><span id='topic+unify_selection'></span>

<h3>Description</h3>

<p>unify selections to handle &quot;classic&quot; (bootRes-style) selections
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unify_selection(selection)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unify_selection_+3A_selection">selection</code></td>
<td>
<p>a treeclim selection</p>
</td></tr>
</table>


<h3>Value</h3>

<p>unified (list-style) selection
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
