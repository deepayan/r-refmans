<!DOCTYPE html><html lang="en"><head><title>Help for package evaluate</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {evaluate}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#evaluate-package'><p>evaluate: Parsing and Evaluation Tools that Provide More Details than the Default</p></a></li>
<li><a href='#create_traceback'><p>Generate a traceback from a list of calls</p></a></li>
<li><a href='#evaluate'><p>Evaluate input and return all details of evaluation</p></a></li>
<li><a href='#flush_console'><p>An emulation of <code>flush.console()</code> in <code>evaluate()</code></p></a></li>
<li><a href='#inject_funs'><p>Inject functions into the environment of <code>evaluate()</code></p></a></li>
<li><a href='#is.message'><p>Object class tests</p></a></li>
<li><a href='#line_prompt'><p>Line prompt.</p></a></li>
<li><a href='#local_reproducible_output'><p>Control common output options</p></a></li>
<li><a href='#new_output_handler'><p>Custom output handlers</p></a></li>
<li><a href='#parse_all'><p>Parse, retaining comments</p></a></li>
<li><a href='#replay'><p>Replay a list of evaluated results</p></a></li>
<li><a href='#set_hooks'><p>Set and remove hooks</p></a></li>
<li><a href='#trim_intermediate_plots'><p>Trim away intermediate plots</p></a></li>
<li><a href='#try_capture_stack'><p>Try, capturing stack on error</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Parsing and Evaluation Tools that Provide More Details than the
Default</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Parsing and evaluation tools that make it easy to recreate
    the command line behaviour of R.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://evaluate.r-lib.org/">https://evaluate.r-lib.org/</a>, <a href="https://github.com/r-lib/evaluate">https://github.com/r-lib/evaluate</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/r-lib/evaluate/issues">https://github.com/r-lib/evaluate/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>callr, covr, ggplot2 (&ge; 3.3.6), lattice, methods, pkgload,
rlang, knitr, testthat (&ge; 3.0.0), withr</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>tidyverse/tidytemplate</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-10 22:27:28 UTC; hadleywickham</td>
</tr>
<tr>
<td>Author:</td>
<td>Hadley Wickham [aut, cre],
  Yihui Xie <a href="https://orcid.org/0000-0003-0645-5666"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Michael Lawrence [ctb],
  Thomas Kluyver [ctb],
  Jeroen Ooms [ctb],
  Barret Schloerke [ctb],
  Adam Ryczkowski [ctb],
  Hiroaki Yutani [ctb],
  Michel Lang [ctb],
  Karolis Koncevičius [ctb],
  Posit Software, PBC [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hadley Wickham &lt;hadley@posit.co&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-10 23:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='evaluate-package'>evaluate: Parsing and Evaluation Tools that Provide More Details than the Default</h2><span id='topic+evaluate-package'></span>

<h3>Description</h3>

<p>Parsing and evaluation tools that make it easy to recreate the command line behaviour of R.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Hadley Wickham <a href="mailto:hadley@posit.co">hadley@posit.co</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Yihui Xie (<a href="https://orcid.org/0000-0003-0645-5666">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Michael Lawrence [contributor]
</p>
</li>
<li><p> Thomas Kluyver [contributor]
</p>
</li>
<li><p> Jeroen Ooms [contributor]
</p>
</li>
<li><p> Barret Schloerke [contributor]
</p>
</li>
<li><p> Adam Ryczkowski [contributor]
</p>
</li>
<li><p> Hiroaki Yutani [contributor]
</p>
</li>
<li><p> Michel Lang [contributor]
</p>
</li>
<li><p> Karolis Koncevičius [contributor]
</p>
</li>
<li><p> Posit Software, PBC [copyright holder, funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://evaluate.r-lib.org/">https://evaluate.r-lib.org/</a>
</p>
</li>
<li> <p><a href="https://github.com/r-lib/evaluate">https://github.com/r-lib/evaluate</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/r-lib/evaluate/issues">https://github.com/r-lib/evaluate/issues</a>
</p>
</li></ul>


<hr>
<h2 id='create_traceback'>Generate a traceback from a list of calls</h2><span id='topic+create_traceback'></span>

<h3>Description</h3>

<p>Generate a traceback from a list of calls
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_traceback(callstack)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_traceback_+3A_callstack">callstack</code></td>
<td>
<p>stack of calls, as generated by (e.g.)
<code><a href="base.html#topic+sys.parent">base::sys.calls()</a></code></p>
</td></tr>
</table>

<hr>
<h2 id='evaluate'>Evaluate input and return all details of evaluation</h2><span id='topic+evaluate'></span>

<h3>Description</h3>

<p>Compare to <code><a href="base.html#topic+eval">eval()</a></code>, <code>evaluate</code> captures all of the
information necessary to recreate the output as if you had copied and pasted
the code into a R terminal. It captures messages, warnings, errors and
output, all correctly interleaved in the order in which they occured. It
stores the final result, whether or not it should be visible, and the
contents of the current graphics device.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate(
  input,
  envir = parent.frame(),
  enclos = NULL,
  debug = FALSE,
  stop_on_error = 0L,
  keep_warning = TRUE,
  keep_message = TRUE,
  log_echo = FALSE,
  log_warning = FALSE,
  new_device = TRUE,
  output_handler = NULL,
  filename = NULL,
  include_timing = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evaluate_+3A_input">input</code></td>
<td>
<p>input object to be parsed and evaluated.  May be a string, file
connection or function.  Passed on to <code><a href="#topic+parse_all">parse_all()</a></code>.</p>
</td></tr>
<tr><td><code id="evaluate_+3A_envir">envir</code></td>
<td>
<p>environment in which to evaluate expressions.</p>
</td></tr>
<tr><td><code id="evaluate_+3A_enclos">enclos</code></td>
<td>
<p>when <code>envir</code> is a list or data frame, this is treated as
the parent environment to <code>envir</code>.</p>
</td></tr>
<tr><td><code id="evaluate_+3A_debug">debug</code></td>
<td>
<p>if <code>TRUE</code>, displays information useful for debugging,
including all output that evaluate captures.</p>
</td></tr>
<tr><td><code id="evaluate_+3A_stop_on_error">stop_on_error</code></td>
<td>
<p>A number between 0 and 2 that controls what happens
when the code errors:
</p>

<ul>
<li><p> If <code>0</code>, the default, will continue running all code, just as if you'd
pasted the code into the command line.
</p>
</li>
<li><p> If <code>1</code>, evaluation will stop on first error without signaling the error,
and you will get back all results up to that point.
</p>
</li>
<li><p> If <code>2</code>, evaluation will halt on first error and you will get back no
results.
</p>
</li></ul>
</td></tr>
<tr><td><code id="evaluate_+3A_keep_warning">keep_warning</code>, <code id="evaluate_+3A_keep_message">keep_message</code></td>
<td>
<p>A single logical value that controls what
happens to warnings and messages.
</p>

<ul>
<li><p> If <code>TRUE</code>, the default, warnings and messages will be captured in the
output.
</p>
</li>
<li><p> If <code>NA</code>, warnings and messages will not be captured and bubble up to
the calling environment of <code>evaluate()</code>.
</p>
</li>
<li><p> If <code>FALSE</code>, warnings and messages will be completed supressed and
not shown anywhere.
</p>
</li></ul>

<p>Note that setting the envvar <code>R_EVALUATE_BYPASS_MESSAGES</code> to <code>true</code> will
force these arguments to be set to <code>NA</code>.</p>
</td></tr>
<tr><td><code id="evaluate_+3A_log_echo">log_echo</code>, <code id="evaluate_+3A_log_warning">log_warning</code></td>
<td>
<p>If <code>TRUE</code>, will immediately log code and
warnings (respectively) to <code>stderr</code>.
</p>
<p>This will be force to <code>TRUE</code> if env var <code>ACTIONS_STEP_DEBUG</code> is
<code>true</code>, as when debugging a failing GitHub Actions workflow.</p>
</td></tr>
<tr><td><code id="evaluate_+3A_new_device">new_device</code></td>
<td>
<p>if <code>TRUE</code>, will open a new graphics device and
automatically close it after completion. This prevents evaluation from
interfering with your existing graphics environment.</p>
</td></tr>
<tr><td><code id="evaluate_+3A_output_handler">output_handler</code></td>
<td>
<p>an instance of <code><a href="#topic+output_handler">output_handler()</a></code> that
processes the output from the evaluation. The default simply prints the
visible return values.</p>
</td></tr>
<tr><td><code id="evaluate_+3A_filename">filename</code></td>
<td>
<p>string overrriding the <code><a href="base.html#topic+srcfile">base::srcfile()</a></code> filename.</p>
</td></tr>
<tr><td><code id="evaluate_+3A_include_timing">include_timing</code></td>
<td>
<p>Deprecated.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>evaluate(c(
  "1 + 1",
  "2 + 2"
))

# Not that's there's a difference in output between putting multiple
# expressions on one line vs spreading them across multiple lines
evaluate("1;2;3")
evaluate(c("1", "2", "3"))

# This also affects how errors propagate, matching the behaviour
# of the R console
evaluate("1;stop(2);3")
evaluate(c("1", "stop(2)", "3"))
</code></pre>

<hr>
<h2 id='flush_console'>An emulation of <code>flush.console()</code> in <code>evaluate()</code></h2><span id='topic+flush_console'></span>

<h3>Description</h3>

<p>When <code><a href="#topic+evaluate">evaluate()</a></code> is evaluating code, the text output is diverted into
an internal connection, and there is no way to flush that connection. This
function provides a way to &quot;flush&quot; the connection so that any text output can
be immediately written out, and more importantly, the <code>text</code> handler
(specified in the <code>output_handler</code> argument of <code>evaluate()</code>) will
be called, which makes it possible for users to know it when the code
produces text output using the handler.
</p>
<p>This function is supposed to be called inside <code>evaluate()</code> (e.g.
either a direct <code>evaluate()</code> call or in <span class="pkg">knitr</span> code chunks).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flush_console()
</code></pre>

<hr>
<h2 id='inject_funs'>Inject functions into the environment of <code>evaluate()</code></h2><span id='topic+inject_funs'></span>

<h3>Description</h3>

<p>Create functions in the environment specified in the <code>envir</code> argument of
<code><a href="#topic+evaluate">evaluate()</a></code>. This can be helpful if you want to substitute certain
functions when evaluating the code. To make sure it does not wipe out
existing functions in the environment, only functions that do not exist in
the environment are injected.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inject_funs(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inject_funs_+3A_...">...</code></td>
<td>
<p>Named arguments of functions. If empty, previously injected
functions will be emptied.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns previous values.
</p>


<h3>Note</h3>

<p>For expert use only. Do not use it unless you clearly understand it.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(evaluate)
# normally you cannot capture the output of system
evaluate("system('R --version')")

# replace the system() function
old &lt;- inject_funs(system = function(...) {
  cat(base::system(..., intern = TRUE), sep = "\n")
})

evaluate("system('R --version')")

# restore previously injected functions
inject_funs(old)
</code></pre>

<hr>
<h2 id='is.message'>Object class tests</h2><span id='topic+is.message'></span><span id='topic+is.warning'></span><span id='topic+is.error'></span><span id='topic+is.source'></span><span id='topic+is.recordedplot'></span>

<h3>Description</h3>

<p>Object class tests
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.message(x)

is.warning(x)

is.error(x)

is.source(x)

is.recordedplot(x)
</code></pre>

<hr>
<h2 id='line_prompt'>Line prompt.</h2><span id='topic+line_prompt'></span>

<h3>Description</h3>

<p>Format a single expression as if it had been entered at the command prompt.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>line_prompt(x, prompt = getOption("prompt"), continue = getOption("continue"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="line_prompt_+3A_x">x</code></td>
<td>
<p>string representing a single expression</p>
</td></tr>
<tr><td><code id="line_prompt_+3A_prompt">prompt</code></td>
<td>
<p>prompt for first line</p>
</td></tr>
<tr><td><code id="line_prompt_+3A_continue">continue</code></td>
<td>
<p>prompt for subsequent lines</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a string
</p>

<hr>
<h2 id='local_reproducible_output'>Control common output options</h2><span id='topic+local_reproducible_output'></span>

<h3>Description</h3>

<p>Often when using <code>evaluate()</code> you are running R code with a specific output
context in mind. But there are many options and env vars that packages
will take from the current environment, meaning that output depends on
the current state in undesirable ways.
</p>
<p>This function allows you to describe the characteristics of the desired
output and takes care of setting the options and environment variables
for you.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>local_reproducible_output(
  width = 80,
  color = FALSE,
  unicode = FALSE,
  hyperlinks = FALSE,
  rstudio = FALSE,
  frame = parent.frame()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="local_reproducible_output_+3A_width">width</code></td>
<td>
<p>Value of the <code>"width"</code> option.</p>
</td></tr>
<tr><td><code id="local_reproducible_output_+3A_color">color</code></td>
<td>
<p>Determines whether or not cli/crayon colour should be used.</p>
</td></tr>
<tr><td><code id="local_reproducible_output_+3A_unicode">unicode</code></td>
<td>
<p>Should we use unicode characaters where possible?</p>
</td></tr>
<tr><td><code id="local_reproducible_output_+3A_hyperlinks">hyperlinks</code></td>
<td>
<p>Should we use ANSI hyperlinks?</p>
</td></tr>
<tr><td><code id="local_reproducible_output_+3A_rstudio">rstudio</code></td>
<td>
<p>Should we pretend that we're running inside of RStudio?</p>
</td></tr>
<tr><td><code id="local_reproducible_output_+3A_frame">frame</code></td>
<td>
<p>Scope of the changes; when this calling frame terminates the
changes will be undone. For expert use only.</p>
</td></tr>
</table>

<hr>
<h2 id='new_output_handler'>Custom output handlers</h2><span id='topic+new_output_handler'></span><span id='topic+output_handler'></span>

<h3>Description</h3>

<p>An <code>output_handler</code> handles the results of <code><a href="#topic+evaluate">evaluate()</a></code>,
including the values, graphics, conditions. Each type of output is handled by
a particular function in the handler object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_output_handler(
  source = identity,
  text = identity,
  graphics = identity,
  message = identity,
  warning = identity,
  error = identity,
  value = render,
  calling_handlers = list()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="new_output_handler_+3A_source">source</code></td>
<td>
<p>Function to handle the echoed source code under evaluation.
This function should take two arguments (<code>src</code> and <code>expr</code>), and return
an object that will be inserted into the evaluate outputs. <code>src</code> is the
unparsed text of the source code, and <code>expr</code> is the complete input
expression (which may have 0, 1, 2, or more components; see <code><a href="#topic+parse_all">parse_all()</a></code>
for details).
</p>
<p>Return <code>src</code> for the default evaluate behaviour. Return <code>NULL</code> to
drop the source from the output.</p>
</td></tr>
<tr><td><code id="new_output_handler_+3A_text">text</code></td>
<td>
<p>Function to handle any textual console output.</p>
</td></tr>
<tr><td><code id="new_output_handler_+3A_graphics">graphics</code></td>
<td>
<p>Function to handle graphics, as returned by
<code><a href="grDevices.html#topic+recordPlot">recordPlot()</a></code>.</p>
</td></tr>
<tr><td><code id="new_output_handler_+3A_message">message</code></td>
<td>
<p>Function to handle <code><a href="base.html#topic+message">message()</a></code> output.</p>
</td></tr>
<tr><td><code id="new_output_handler_+3A_warning">warning</code></td>
<td>
<p>Function to handle <code><a href="base.html#topic+warning">warning()</a></code> output.</p>
</td></tr>
<tr><td><code id="new_output_handler_+3A_error">error</code></td>
<td>
<p>Function to handle <code><a href="base.html#topic+stop">stop()</a></code> output.</p>
</td></tr>
<tr><td><code id="new_output_handler_+3A_value">value</code></td>
<td>
<p>Function to handle the values returned from evaluation.
</p>

<ul>
<li><p> If it has one argument, it called on visible values.
</p>
</li>
<li><p> If it has two arguments, it handles all values, with the second
argument indicating whether or not the value is visible.
</p>
</li>
<li><p> If it has three arguments, it will be called on all values, with the
the third argument given the evaluation environment which is needed
to look up print methods for S3 objects.
</p>
</li></ul>
</td></tr>
<tr><td><code id="new_output_handler_+3A_calling_handlers">calling_handlers</code></td>
<td>
<p>List of <a href="base.html#topic+withCallingHandlers">calling handlers</a>.
These handlers have precedence over the exiting handler installed
by <code><a href="#topic+evaluate">evaluate()</a></code> when <code>stop_on_error</code> is set to 0.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The handler functions should accept an output object as their first argument.
The return value of the handlers is ignored, except in the case of the
<code>value</code> handler, where a visible return value is saved in the output
list.
</p>
<p>Calling the constructor with no arguments results in the default handler,
which mimics the behavior of the console by printing visible values.
</p>
<p>Note that recursion is common: for example, if <code>value</code> does any
printing, then the <code>text</code> or <code>graphics</code> handlers may be called.
</p>


<h3>Value</h3>

<p>A new <code>output_handler</code> object
</p>

<hr>
<h2 id='parse_all'>Parse, retaining comments</h2><span id='topic+parse_all'></span>

<h3>Description</h3>

<p>Works very similarly to parse, but also keeps original formatting and
comments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_all(x, filename = NULL, allow_error = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="parse_all_+3A_x">x</code></td>
<td>
<p>object to parse.  Can be a string, a file connection, or a function.
If a connection, will be opened and closed only if it was closed initially.</p>
</td></tr>
<tr><td><code id="parse_all_+3A_filename">filename</code></td>
<td>
<p>string overriding the file name</p>
</td></tr>
<tr><td><code id="parse_all_+3A_allow_error">allow_error</code></td>
<td>
<p>whether to allow syntax errors in <code>x</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame two columns, <code>src</code> and <code>expr</code>, and one row for each complete
input in <code>x</code>. A complete input is R code that would trigger execution when
typed at the console. This might consist of multiple expressions separated
by <code style="white-space: pre;">&#8288;;&#8288;</code> or one expression spread over multiple lines (like a function
definition).
</p>
<p><code>src</code> is a character vector of source code. Each element represents a
complete input expression (which might span multiple line) and always has a
terminal <code style="white-space: pre;">&#8288;\n&#8288;</code>.
</p>
<p><code>expr</code> is a list-column of <a href="base.html#topic+expression">expression</a>s. The expressions can be of any
length, depending on the structure of the complete input source:
</p>

<ul>
<li><p> If <code>src</code> consists of only only whitespace and/or comments, <code>expr</code> will
be length 0.
</p>
</li>
<li><p> If <code>src</code> a single scalar (like <code>TRUE</code>, <code>1</code>, or <code>"x"</code>), name, or
function call, <code>expr</code> will be length 1.
</p>
</li>
<li><p> If <code>src</code> contains multiple expressions separated by <code style="white-space: pre;">&#8288;;&#8288;</code>, <code>expr</code> will
have length two or more.
</p>
</li></ul>

<p>The expressions have their srcrefs removed.
</p>
<p>If there are syntax errors in <code>x</code> and <code>allow_error = TRUE</code>, the data
frame will have an attribute <code>PARSE_ERROR</code> that stores the error object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Each of these inputs are single line, but generate different numbers of
# expressions
source &lt;- c(
  "# a comment",
  "x",
  "x;y",
  "x;y;z"
)
parsed &lt;- parse_all(source)
lengths(parsed$expr)
str(parsed$expr)

# Each of these inputs are a single expression, but span different numbers
# of lines
source &lt;- c(
  "function() {}",
  "function() {",
  "  # Hello!",
  "}",
  "function() {",
  "  # Hello!",
  "  # Goodbye!",
  "}"
)
parsed &lt;- parse_all(source)
lengths(parsed$expr)
parsed$src
</code></pre>

<hr>
<h2 id='replay'>Replay a list of evaluated results</h2><span id='topic+replay'></span>

<h3>Description</h3>

<p>Replay a list of evaluated results, as if you'd run them in an R
terminal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replay(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="replay_+3A_x">x</code></td>
<td>
<p>result from <code><a href="#topic+evaluate">evaluate()</a></code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>f1 &lt;- function() {
  cat("1\n")
  print("2")
  warning("3")
  print("4")
  message("5")
  stop("6")
}
replay(evaluate("f1()"))

f2 &lt;- function() {
  message("Hello")
  plot(1:10)
  message("Goodbye")
}
replay(evaluate("f2()"))
</code></pre>

<hr>
<h2 id='set_hooks'>Set and remove hooks</h2><span id='topic+set_hooks'></span><span id='topic+remove_hooks'></span>

<h3>Description</h3>

<p>This interface wraps the base <code><a href="base.html#topic+setHook">setHook()</a></code> function to provide a return
value that makes it easy to undo.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_hooks(hooks, action = "append")

remove_hooks(hooks)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set_hooks_+3A_hooks">hooks</code></td>
<td>
<p>a named list of hooks - each hook can either be a function or
a list of functions.</p>
</td></tr>
<tr><td><code id="set_hooks_+3A_action">action</code></td>
<td>
<p><code>"replace"</code>, <code>"append"</code> or <code>"prepend"</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>new1 &lt;- list(before.plot.new = function() print("Plotted!"))
new2 &lt;- list(before.plot.new = function() print("Plotted Again!"))
set_hooks(new1)
set_hooks(new2)
plot(1)
remove_hooks(new1)
plot(1)
remove_hooks(new2)
plot(1)
</code></pre>

<hr>
<h2 id='trim_intermediate_plots'>Trim away intermediate plots</h2><span id='topic+trim_intermediate_plots'></span>

<h3>Description</h3>

<p>Trim off plots that are modified by subsequent lines to only show
the &quot;final&quot; plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trim_intermediate_plots(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trim_intermediate_plots_+3A_x">x</code></td>
<td>
<p>An evaluation object produced by <code><a href="#topic+evaluate">evaluate()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A modified evaluation object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ev &lt;- evaluate(c(
  "plot(1:3)",
  "text(1, 1, 'x')",
  "text(1, 1, 'y')"
))

# All intermediate plots are captured
ev
# Only the final plot is shown
trim_intermediate_plots(ev)
</code></pre>

<hr>
<h2 id='try_capture_stack'>Try, capturing stack on error</h2><span id='topic+try_capture_stack'></span>

<h3>Description</h3>

<p>This is a variant of <code><a href="base.html#topic+tryCatch">tryCatch()</a></code> that also captures the call
stack if an error occurs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>try_capture_stack(quoted_code, env)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="try_capture_stack_+3A_quoted_code">quoted_code</code></td>
<td>
<p>code to evaluate, in quoted form</p>
</td></tr>
<tr><td><code id="try_capture_stack_+3A_env">env</code></td>
<td>
<p>environment in which to execute code</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
