<!DOCTYPE html><html lang="en"><head><title>Help for package PDN</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PDN}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#PDN-package'>
<p>Personized Disease Network</p></a></li>
<li><a href='#buildnetworks'><p>Generating Network Matrix</p></a></li>
<li><a href='#comorbidity_data'><p>Sampele comorbidity data set</p></a></li>
<li><a href='#datecut'><p>Generating Optimal cuts for the Data</p></a></li>
<li><a href='#demographic_data'><p>Sampele demographic data set</p></a></li>
<li><a href='#draw.PDN'><p>Draw Personalized Disease Network for one patient with network and ggplot2</p></a></li>
<li><a href='#draw.PDN.circle'><p>Draw Personalized Disease Network for one patient</p></a></li>
<li><a href='#draw.PDN.cluster'><p>Draw Personalized Disease Network for cluster of patients</p></a></li>
<li><a href='#survival_data'><p>Sampele Survival data set</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Personalized Disease Network</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Javier Cabrera &lt;xavier.cabrera@gmail.com&gt;, Fei Wang &lt;cherry8177@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zhenbang Wang &lt;bruce1edward@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Building patient level networks for prediction of 
        medical outcomes and draw the cluster of network.        
        This package is based on paper Personalized disease 
        networks for understanding and predicting cardiovascular 
        diseases and other complex processes 
        (See Cabrera et al. <a href="http://circ.ahajournals.org/content/134/Suppl_1/A14957">http://circ.ahajournals.org/content/134/Suppl_1/A14957</a>).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>survival, glmnet, ggplot2, network</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-11-03 19:40:15 UTC; Bruce</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-11-03 23:27:43 UTC</td>
</tr>
</table>
<hr>
<h2 id='PDN-package'>
Personized Disease Network
</h2><span id='topic+PDN-package'></span>

<h3>Description</h3>

<p>Building patient level networks for prediction of
medical outcomes and draw the cluster of network.
This pakcage is based on paper Personalized disease
networks (PDN) for understanding and predicting cardiovascular
diseases and other complex processes.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> PDN</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2017-08-14</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Javier Cabrera and Fei Wang<br />
Maintainer: Zhenbang Wang &lt;bruce1edward@gmail.com&gt;
</p>


<h3>References</h3>

<p>Cabrera, Javier and Kostis, John B and Wang, Fei and Kostis, William J. (2016)
<em>Personalized Disease Networks in Predicting Cardiovascular Outcomes</em></p>

<hr>
<h2 id='buildnetworks'>Generating Network Matrix</h2><span id='topic+buildnetworks'></span>

<h3>Description</h3>

<p>This function use data set with cut off information to create network matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>buildnetworks(x, k1, del = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="buildnetworks_+3A_x">x</code></td>
<td>
<p>comorbidity data matrix with column correspond to ICD9 codes and row correspond to each patient</p>
</td></tr>
<tr><td><code id="buildnetworks_+3A_k1">k1</code></td>
<td>
<p>the cut off point between Diagnosis/Procedure A to another Diagnosis/Procedure B, it can be fix number, NULL and datecut</p>
</td></tr>
<tr><td><code id="buildnetworks_+3A_del">del</code></td>
<td>
<p>number of character deleted for each name of the input</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Network Matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Select a subset of data for toy example
comorbidity_data = comorbidity_data[c(1:10),]
survival_data = survival_data[c(1:10),]
k1 = datecut(comorbidity_data,survival_data[,1],survival_data[,2])
a = buildnetworks(comorbidity_data,k1)
</code></pre>

<hr>
<h2 id='comorbidity_data'>Sampele comorbidity data set</h2><span id='topic+comorbidity_data'></span>

<h3>Description</h3>

<p>This is the sample data set for Package PDN
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comorbidity_data
</code></pre>


<h3>Format</h3>

<p>100 rows and 10 column matrix</p>

<hr>
<h2 id='datecut'>Generating Optimal cuts for the Data</h2><span id='topic+datecut'></span>

<h3>Description</h3>

<p>Performs Cox proportional hazards regression model on patients survival days based on different cutoffs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>datecut(x, surdays, event)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="datecut_+3A_x">x</code></td>
<td>
<p>comorbidity data matrix with column correspond to ICD9 codes and row correspond to each patient</p>
</td></tr>
<tr><td><code id="datecut_+3A_surdays">surdays</code></td>
<td>
<p>survival days for each patient</p>
</td></tr>
<tr><td><code id="datecut_+3A_event">event</code></td>
<td>
<p>indictor variable 1 represent patient died 0 represent patient survive</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Building and draw personized disease network
</p>


<h3>Value</h3>

<p>a vector of cutoff points that maximize the Z statistics for cox model between each Diagnosis/Procedure A to another Diagnosis/Procedure B
</p>


<h3>Examples</h3>

<pre><code class='language-R'>comorbidity_data
survival_data
#Select a subset of data for toy example
comorbidity_data = comorbidity_data[c(1:10),]
survival_data = survival_data[c(1:10),]
k1 = datecut(comorbidity_data,survival_data[,1],survival_data[,2])
</code></pre>

<hr>
<h2 id='demographic_data'>Sampele demographic data set</h2><span id='topic+demographic_data'></span>

<h3>Description</h3>

<p>This is one of the sample data set.
It contains the demographic information of each patients
It has five variables which are sex, race, hispan, dshyr and prime
</p>


<h3>Usage</h3>

<pre><code class='language-R'>demographic_data
</code></pre>


<h3>Format</h3>

<p>100 rows and 5 column matrix</p>

<hr>
<h2 id='draw.PDN'>Draw Personalized Disease Network for one patient with network and ggplot2</h2><span id='topic+draw.PDN'></span>

<h3>Description</h3>

<p>Draw Personalized Disease Network based on newtwork matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.PDN(tt, labels)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw.PDN_+3A_tt">tt</code></td>
<td>
<p>one row of network matrix generated from comorbidity data matrix using buildnetworks</p>
</td></tr>
<tr><td><code id="draw.PDN_+3A_labels">labels</code></td>
<td>
<p>names of each node in the network matrix</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Select a subset of data for toy example
comorbidity_data = comorbidity_data[c(1:10),]
survival_data = survival_data[c(1:10),]
#  Getting the names
k1 = datecut(comorbidity_data,survival_data[,1],survival_data[,2])
a = buildnetworks(comorbidity_data,k1)
#Plot PDN for patient 7
nn = names(comorbidity_data)
draw.PDN(a[7,],nn)
</code></pre>

<hr>
<h2 id='draw.PDN.circle'>Draw Personalized Disease Network for one patient</h2><span id='topic+draw.PDN.circle'></span>

<h3>Description</h3>

<p>Draw Personalized Disease Network based on newtwork matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.PDN.circle(a0, dak)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw.PDN.circle_+3A_a0">a0</code></td>
<td>
<p>one row of network matrix generated from comorbidity data matrix using buildnetworks</p>
</td></tr>
<tr><td><code id="draw.PDN.circle_+3A_dak">dak</code></td>
<td>
<p>one row of Ranks matrix for corresponding comorbidity data matrix</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Select a subset of data for toy example
comorbidity_data = comorbidity_data[c(1:10),]
survival_data = survival_data[c(1:10),]
#  Find date cuts
k1 = datecut(comorbidity_data,survival_data[,1],survival_data[,2])
#  Build networks
a = buildnetworks(comorbidity_data,k1)

#  Graph individual patients
datark = t(apply(comorbidity_data,1,rank))
dak = sort(datark[1,])
#  draw PDN for the first patient
draw.PDN.circle(a[1,],dak)
#  draw PDN for the whole comorbidity data set
par(mfrow=c(2,5))
for(i in 1 : nrow(a)){
 dak = apply(datark,2,sort)
 draw.PDN.circle(a[i,],dak[i,])
 title(main=paste("Patient",i))
}
</code></pre>

<hr>
<h2 id='draw.PDN.cluster'>Draw Personalized Disease Network for cluster of patients</h2><span id='topic+draw.PDN.cluster'></span>

<h3>Description</h3>

<p>Draw Personalized Disease Network based on cluster information
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.PDN.cluster(a0, dak)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw.PDN.cluster_+3A_a0">a0</code></td>
<td>
<p>network matrix get from buildnetworks</p>
</td></tr>
<tr><td><code id="draw.PDN.cluster_+3A_dak">dak</code></td>
<td>
<p>ranks data for comorbidity data matrix</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Select a subset of data for toy example
comorbidity_data = comorbidity_data[c(1:10),]
survival_data = survival_data[c(1:10),]
##Clustering Example
k1 = datecut(comorbidity_data,survival_data[,1],survival_data[,2])
a = buildnetworks(comorbidity_data,k1)
datark = t(apply(comorbidity_data,1,rank))
require(survival)
zsq = NULL
for(i in 1:ncol(a)){
  a1 = (summary(coxph(Surv(as.numeric(survival_data[,1]),survival_data[,2]) ~ a[,i],
  data=as.data.frame(a)))$coefficient[,4])^2
  zsq = cbind(zsq,a1)
}
zsq = as.numeric(zsq)
wi=zsq/sum(zsq,na.rm=TRUE)
wi[wi&lt;10^ -3]=10^ -3
wi[is.na(wi)]=10^ -3
#weighted matrix
wa = NULL
for(i in 1:ncol(a)){
 wa = cbind(wa,a[,i]*wi[i])
}
#PCA
pr.out=prcomp(wa)
x.svd=svd(wa)
x.score1 &lt;- wa %*% x.svd$v
x.score2 &lt;- x.svd$u %*% diag(x.svd$d)
##HC cluster using the first 8 PCA scores
dp&lt;-dist(x.score2[,1:8])
hcp&lt;-hclust(dp, method="ward.D")
##Plot Network
s1=rev(sort(apply(a[cutree(hcp,3)==2,],2,mean)))[1:50]
dak = sort(apply(datark[cutree(hcp,3)==2,],2,mean,na.rm=TRUE))
names(dak) = unlist(strsplit(names(dak),"DAT"))
draw.PDN.cluster(s1,dak)
</code></pre>

<hr>
<h2 id='survival_data'>Sampele Survival data set</h2><span id='topic+survival_data'></span>

<h3>Description</h3>

<p>This is the sample data set for function datecut.
The first column is the time difference between the patient admission date and death date
The second column is the indictor variable with 1 corresponding to patient death, 0 corresponding to patient alive
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survival_data
</code></pre>


<h3>Format</h3>

<p>100 rows and 2 column matrix</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
