<!DOCTYPE html><html lang="en"><head><title>Help for package bspmma</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bspmma}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bspmma-package'>
<p>bspmma: Bayesian Semiparametric Models for Meta-Analysis</p></a></li>
<li><a href='#bf.c'><p>Compute Bayes Factors for Comparing Values of the Dirichlet</p>
Precision Parameter in the Conditional Dirichlet Model</a></li>
<li><a href='#bf.c.o'><p>Compute Bayes Factors for Conditional vs. Ordinary Dirichlet</p>
Models</a></li>
<li><a href='#bf.o'><p>Compute Bayes Factors for Comparing Values of the Dirichlet</p>
Precision Parameter in the Ordinary Dirichlet Model</a></li>
<li><a href='#bf1'><p>Generate Chains for Computation of Bayes Factors</p></a></li>
<li><a href='#bf2'><p>Compute Constants for Multi-Chain Algorithm to Compute</p>
Bayes Factors</a></li>
<li><a href='#breast.17'><p>Aspirin and Breast Cancer: 17 studies</p></a></li>
<li><a href='#caprie.3grps'><p>CAPRIE Study: Three Risk Groups</p></a></li>
<li><a href='#ddtm.s'><p>Decontamination of the Digestive Tract Mortality, Short Dataset</p></a></li>
<li><a href='#describe.post'><p>Brief summary statistics of the posterior for convenient</p>
comparison of several models</a></li>
<li><a href='#dirichlet.c'><p>Mixture of Conditional Dirichlet Model</p></a></li>
<li><a href='#dirichlet.o'><p>Mixture of Ordinary Dirichlet Model</p></a></li>
<li><a href='#draw.bf'><p>Plot Function for Bayes Factors</p></a></li>
<li><a href='#draw.post'><p>Overlapping Plots of Posterior Distributions for Several Models</p></a></li>
<li><a href='#print.dir.cond'><p>printing method for objects of class dir.cond</p></a></li>
<li><a href='#print.dir.ord'><p>printing method for objects of class dir.ord</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Bayesian Semiparametric Models for Meta-Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1-2</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-01-12</td>
</tr>
<tr>
<td>Author:</td>
<td>Deborah Burr</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Deborah Burr &lt;burr@stat.ufl.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The main functions carry out Gibbs' sampler routines for nonparametric and semiparametric Bayesian models for random effects meta-analysis.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-01-13 16:46:16 UTC; DebDoss</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-01-13 20:20:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='bspmma-package'>
bspmma: Bayesian Semiparametric Models for Meta-Analysis
</h2><span id='topic+bspmma-package'></span><span id='topic+bspmma'></span>

<h3>Description</h3>

<p>Two functions carry out Gibbs' sampler routines to estimate the posterior
distributions from either a non-parametric Bayesian model for random
effects meta-analysis, or from a semi-parametric model.  A group of
three functions are used to compute Bayes factors to compare the two
models.  Three sample datasets are included.  There are routines for
graphing the posteriors and computing summary statistics.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> bspmma</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.1-2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2019-01-19</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
Built: </td><td style="text-align: left;"> R 2.9.2; ; 2012-07-13 19:04:37 UTC; unix</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Index:
</p>
<pre>
bf.c                    Compute Bayes Factors for Comparing Values of
                        the Dirichlet Precision Parameter in the
                        Conditional Dirichlet Model
bf.c.o                  Compute Bayes Factors for Conditional vs.
                        Ordinary Dirichlet Models
bf.o                    Compute Bayes Factors for Comparing Values of
                        the Dirichlet Precision Parameter in the
                        Ordinary Dirichlet Model
bf1                     Generate Chains for Computation of Bayes
                        Factors
bf2                     Compute Constants for Multi-Chain Algorithm to
                        Compute Bayes Factors
breast.17               Aspirin and Breast Cancer: 17 studies
bspmma-package          bspmma: Bayesian Semiparametric Models for
                        Meta-Analysis
caprie.3grps            CAPRIE Study: Three Risk Groups
ddtm.s                  Decontamination of the Digestive Tract
                        Mortality, Short Dataset
describe.post           Brief summary statistics of the posterior for
                        convenient comparison of several models
dirichlet.c             Mixture of Conditional Dirichlet Model
dirichlet.o             Mixture of Ordinary Dirichlet Model
draw.bf                 Plot Function for Bayes Factors
draw.post               Overlapping Plots of Posterior Distributions
                        for Several Models
print.dir.cond          printing method for objects of class dir.cond
print.dir.ord           printing method for objects of class dir.ord
</pre>
<p>The main functions are explained in <cite>Burr (2012)</cite>, and are
illustrated on the datasets <code>breast.17</code> and <code>ddtm.s</code>.
The function <code>dirichlet.c</code> carries out the Markov chain Monte Carlo
(MCMC) algorithm to simulate data from the posterior distribution under
the conditional Dirichlet model described in <cite>Burr and Doss (2005)</cite>.
The computation of Bayes factors is carried out in functions
<code>bf1</code>, <code>bf2</code>, <code>bf.c</code>, <code>bf.o</code>, and <code>bf.c.o</code>,
which implement a multi-chain algorithm described in <cite>Doss (2012)</cite>.
</p>


<h3>Author(s)</h3>

<p>Deborah Burr
</p>
<p>Maintainer: Deborah Burr &lt;burr@stat.ufl.edu&gt;
</p>


<h3>References</h3>

<p>Burr, Deborah (2012).  &ldquo;bspmma:  An R package for Bayesian
semi-parametric models for meta-analysis.&rdquo;  <em>Journal of
Statistical Software</em> 50(4), 1&ndash;23.
<a href="http://www.jstatsoft.org/v50/i04/.">http://www.jstatsoft.org/v50/i04/.</a>
</p>
<p>Doss, Hani (2012).  &ldquo;Hyperparameter and model selection for
nonparametric Bayes problems via Radon-Nikodym derivatives.&rdquo;
<em>Statistica Sinica</em> 22, 1&ndash;26.
</p>

<hr>
<h2 id='bf.c'>Compute Bayes Factors for Comparing Values of the Dirichlet
Precision Parameter in the Conditional Dirichlet Model</h2><span id='topic+bf.c'></span>

<h3>Description</h3>

<p>This function carries out the final step in computing Bayes factors for
comparing a sequence of values of the Dirichlet precision parameter
<code class="reqn">M</code> for the conditional Dirichlet mixing model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bf.c(df=-99, from=.4, incr=.1, to, cc, mat.list)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bf.c_+3A_df">df</code></td>
<td>
<p>degrees of freedom for the <code class="reqn">t</code> distribution in the
model; <code class="reqn">df=-99</code> corresponds to a normal distribution.</p>
</td></tr>
<tr><td><code id="bf.c_+3A_from">from</code></td>
<td>
<p>is the starting value for the sequence of values of
the precision parameter <code class="reqn">M</code> at which to compute
the Bayes factor.</p>
</td></tr>
<tr><td><code id="bf.c_+3A_incr">incr</code></td>
<td>
<p>is the amount by which to increment the values
of <code class="reqn">M</code>.</p>
</td></tr>
<tr><td><code id="bf.c_+3A_to">to</code></td>
<td>
<p>is the ending value for the sequence of values
of <code class="reqn">M</code>.</p>
</td></tr> 
<tr><td><code id="bf.c_+3A_cc">cc</code></td>
<td>
<p>is the vector of nine constants computed by <code>bf1</code>
and <code>bf2</code>.</p>
</td></tr>
<tr><td><code id="bf.c_+3A_mat.list">mat.list</code></td>
<td>
<p>list of nine matrices of MCMC output produced by
<code>bf1</code> for the final computation of the Bayes factors.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function carries out the fourth and final step in the computation
of Bayes factors for the selection of <code class="reqn">M</code> in the conditional
Dirichlet mixing model.  In the current version of the package, the
Bayes factors for <code class="reqn">M</code> are computed relative to
the model with <code class="reqn">M=4</code>.  The sequence of steps implements a
multiple-chain version of Equation (2.6) of Burr (2012); the details
of the multiple-chain algorithm are given in Doss (2012).
Previous steps are two calls to <code>bf1</code> and a call to <code>bf2</code>,
as illustrated in the Examples section and in Burr (2012).
</p>


<h3>Value</h3>

<p>A list with three named components, <code>Mnew</code>, <code>y</code>, and
<code>yinfinity</code>, needed to produce the plot of Bayes factors via the
function <code>draw.bf</code>.  The vector <code>Mnew</code> is the sequence of
(finite) values of <code class="reqn">M</code>.  The vector <code>y</code> is the estimates of
the Bayes factors corresponding to the finite values of <code>Mnew</code>,
and the object <code>yinfinity</code> is the value of the Bayes factor for
<code class="reqn">M</code> at infinity, that is, for the parametric model.  
</p>


<h3>References</h3>

<p>Burr, Deborah (2012).  &ldquo;bspmma:  An R package for Bayesian
semiparametric models for meta-analysis.&rdquo;  <em>Journal of
Statistical Software</em> 50(4), 1&ndash;23.
<a href="http://www.jstatsoft.org/v50/i04/.">http://www.jstatsoft.org/v50/i04/.</a>
</p>
<p>Doss, Hani (2012).  &ldquo;Hyperparameter and model selection for
nonparametric Bayes problems via Radon-Nikodym derivatives.&rdquo;
<em>Statistica Sinica</em> 22, 1&ndash;26.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
##  CPU times are from runs of the R command system.time() on an
##  Intel $2.8$ GHz Q$9550$ running Linux.
## Preliminary steps

data(breast.17) # the breast cancer dataset
breast.data &lt;- as.matrix(breast.17) # put data in matrix object
chain1.list &lt;- bf1(breast.data) # 40.5 secs
cc &lt;- bf2(chain1.list) # 1.6 secs
## Next get a second set of 9 chains, with a different seed
chain2.list &lt;- bf1(breast.data,seed=2) # 40.4 secs

## Compute and plot the Bayes factors
breast.bfc &lt;- bf.c(to=20, cc=cc, mat.list=chain2.list)
draw.bf(breast.bfc)

## End(Not run)
</code></pre>

<hr>
<h2 id='bf.c.o'>Compute Bayes Factors for Conditional vs. Ordinary Dirichlet
Models</h2><span id='topic+bf.c.o'></span>

<h3>Description</h3>

<p>This function carries out the final step in computing Bayes factors for
comparing conditional and ordinary Dirichlet mixing models, for a
sequence of Dirichlet precision parameters <code class="reqn">M</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bf.c.o(df=-99, from=.4, incr=.1, to, cc, mat.list)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bf.c.o_+3A_df">df</code></td>
<td>
<p>degrees of freedom for the <code class="reqn">t</code> distribution in the
model; <code class="reqn">df=-99</code> corresponds to a normal distribution.</p>
</td></tr>
<tr><td><code id="bf.c.o_+3A_cc">cc</code></td>
<td>
<p>is the vector of nine constants computed by <code>bf1</code>
and <code>bf2</code>.</p>
</td></tr>
<tr><td><code id="bf.c.o_+3A_from">from</code></td>
<td>
<p>is the starting value for the sequence of values of
the precision parameter <code class="reqn">M</code> at which to compute
the Bayes factor.</p>
</td></tr>
<tr><td><code id="bf.c.o_+3A_to">to</code></td>
<td>
<p>is the ending value for the sequence of values
of <code class="reqn">M</code>.</p>
</td></tr>
<tr><td><code id="bf.c.o_+3A_incr">incr</code></td>
<td>
<p>is the amount by which to increment the values
of <code class="reqn">M</code>.</p>
</td></tr>
<tr><td><code id="bf.c.o_+3A_mat.list">mat.list</code></td>
<td>
<p>list of nine matrices of MCMC output produced by
<code>bf1</code> for the final computation of the Bayes factors.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function carries out the fourth and final step in the computation
of Bayes factors for the conditional vs. ordinary Dirichlet mixing
models.  It implements a multiple-chain version of Equation (2.7) of
Burr (2012); the details of the multiple-chain algorithm are given in
Doss (2012).  Previous steps are two calls to <code>bf1</code> and a call to
<code>bf2</code>, as illustrated in the Examples section and in Burr (2012).
</p>


<h3>Value</h3>

<p>A list with two named components, <code>Mnew</code> and <code>y</code>.  The
vector <code>Mnew</code> is the sequence of (finite) values of <code class="reqn">M</code>.
The vector <code>y</code> is the estimates of the Bayes factors
corresponding to <code>Mnew</code>.
</p>


<h3>References</h3>

<p>Burr, Deborah (2012).  &ldquo;bspmma:  An R package for Bayesian
semiparametric models for meta-analysis.&rdquo;  <em>Journal of
Statistical Software</em> 50(4), 1&ndash;23.
<a href="http://www.jstatsoft.org/v50/i04/">http://www.jstatsoft.org/v50/i04/</a>.
</p>
<p>Doss, Hani (2012).  &ldquo;Hyperparameter and model selection for
nonparametric Bayes problems via Radon-Nikodym derivatives.&rdquo;
<em>Statistica Sinica</em>22, 1&ndash;26.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
##  CPU times are from runs of the R command system.time() on an
##  Intel $2.8$ GHz Q$9550$ running Linux.
## Preliminary steps

data(breast.17) # the breast cancer dataset
breast.data &lt;- as.matrix(breast.17) # put data in matrix object
chain1.list &lt;- bf1(breast.data) # 40.5 secs
cc &lt;- bf2(chain1.list) # 1.6 secs
## Next get a second set of 9 chains, with a different seed
chain2.list &lt;- bf1(breast.data,seed=2) # 40.4 secs

## OR load the chains and constants saved earlier
load("breast-rdat-2lists-1000")
load("breast-rdat-2lists-1000")

## Compute and plot the Bayes factors
breast.bfco &lt;- bf.c.o(to=20, cc=cc, mat.list=chain2.list) # 107 secs
draw.bf(breast.bfco)

## End(Not run)
</code></pre>

<hr>
<h2 id='bf.o'>Compute Bayes Factors for Comparing Values of the Dirichlet
Precision Parameter in the Ordinary Dirichlet Model</h2><span id='topic+bf.o'></span>

<h3>Description</h3>

<p>This function carries out the final step in computing Bayes factors for
comparing a sequence of values of the Dirichlet precision parameter
<code class="reqn">M</code> for the ordinary Dirichlet mixing model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bf.o(df=-99, from=.4, incr=.1, to, cc, mat.list)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bf.o_+3A_df">df</code></td>
<td>
<p>degrees of freedom for the <code class="reqn">t</code> distribution in the
model; <code class="reqn">df=-99</code> corresponds to a normal distribution.</p>
</td></tr>
<tr><td><code id="bf.o_+3A_from">from</code></td>
<td>
<p>is the starting value for the sequence of values of
the precision parameter <code class="reqn">M</code> at which to compute
the Bayes factor.</p>
</td></tr>
<tr><td><code id="bf.o_+3A_incr">incr</code></td>
<td>
<p>is the amount by which to increment the values
of <code class="reqn">M</code>.</p>
</td></tr>
<tr><td><code id="bf.o_+3A_to">to</code></td>
<td>
<p>is the ending value for the sequence of values
of <code class="reqn">M</code>.</p>
</td></tr>
<tr><td><code id="bf.o_+3A_cc">cc</code></td>
<td>
<p>is the vector of nine constants computed by <code>bf1</code>
and <code>bf2</code> prior to this step in the algorithm.</p>
</td></tr>
<tr><td><code id="bf.o_+3A_mat.list">mat.list</code></td>
<td>
<p>list of nine matrices of MCMC output produced by
<code>bf1</code> for the final computation of the Bayes factors.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function carries out the fourth and final step in the computation
of Bayes factors for the selection of <code class="reqn">M</code> in the ordinary
Dirichlet mixing model.  In the current version of the package, the
Bayes factors for <code class="reqn">M</code> are computed relative to
the model with <code class="reqn">M=4</code>.  The sequence of steps implements a
multiple-chain version of Equation (2.7) of Burr (2012); the details
of the multiple-chain algorithm are given in Doss (2012).
Previous steps are calls to <code>bf1</code>, <code>bf2</code>, and <code>bf1</code>
again, in that order, as illustrated in the Examples section and in
Burr (2012).
</p>


<h3>Value</h3>

<p>A list with three named components, <code>Mnew</code>, <code>y</code>, and
<code>yinfinity</code>, needed to produce the plot of Bayes factors via the
function <code>draw.bf</code>.  The vector <code>Mnew</code> is the sequence of
(finite) values of <code class="reqn">M</code>.  The vector <code>y</code> is the estimates of
the Bayes factors corresponding to the finite values of <code>Mnew</code>,
and the object <code>yinfinity</code> is the value of the Bayes factor for
<code class="reqn">M</code> at infinity, that is, for the parametric model.  
</p>


<h3>References</h3>

<p>Burr, Deborah (2012).  &ldquo;bspmma:  An R package for Bayesian
semi-parametric models for meta-analysis.&rdquo;  <em>Journal of
Statistical Software</em> 50(4), 1&ndash;23.
<a href="http://www.jstatsoft.org/v50/i04/.">http://www.jstatsoft.org/v50/i04/.</a>
</p>
<p>Doss, Hani (2012).  &ldquo;Hyperparameter and model selection for
nonparametric Bayes problems via Radon-Nikodym derivatives.&rdquo;
<em>Statistica Sinica</em> 22, 1&ndash;26.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
##  CPU times are from runs of the R command system.time() on an
##  Intel $2.8$ GHz Q$9550$ running Linux.
## Preliminary steps

data(breast.17) # the breast cancer dataset
breast.data &lt;- as.matrix(breast.17) # put data in matrix object
chain1.list &lt;- bf1(breast.data) # 40.5 secs
cc &lt;- bf2(chain1.list) # 1.6 secs
## Next get a second set of 9 chains, with a different seed
chain2.list &lt;- bf1(breast.data,seed=2) # 40.4 secs

## Compute and plot the Bayes factors
breast.bfo &lt;- bf.o(to=20, cc=cc, mat.list=chain2.list) #51 secs
draw.bf(breast.bfo)

## End(Not run)
</code></pre>

<hr>
<h2 id='bf1'>Generate Chains for Computation of Bayes Factors</h2><span id='topic+bf1'></span>

<h3>Description</h3>

<p>Generate nine matrices of MCMC output under the ordinary Dirichlet
model, for nine fixed values of the precision parameter <code class="reqn">M</code>.
This MCMC output is needed for computing Bayes factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bf1(data,seed=1,ncycles=2000,d=c(.1,.1,0,1000),K=10,burnin=1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bf1_+3A_data">data</code></td>
<td>
<p>is a two-column matrix with a row for each study
in the meta-analysis.  The first column is the log of estimate
of relative risk, often a log(odds ratio).  The second column is
the true or estimated standard error of the log(odds ratio).</p>
</td></tr>
<tr><td><code id="bf1_+3A_seed">seed</code></td>
<td>
<p>is the value of the seed for starting the random number
generator, which will be used before each of the nine calls to the
function <code>dirichlet.o</code>.</p>
</td></tr>
<tr><td><code id="bf1_+3A_ncycles">ncycles</code></td>
<td>
<p>is the number of cycles of the Markov chain.</p>
</td></tr>
<tr><td><code id="bf1_+3A_d">d</code></td>
<td>
<p>is a vector of length four with the values of the
hyperparameters, in order, the location and scale of the Gamma
inverse prior, mean and variance multiplier for the normal prior
on <code class="reqn">\mu</code>.</p>
</td></tr>
<tr><td><code id="bf1_+3A_k">K</code></td>
<td>
<p>is the number of summands to include when one uses
Sethuraman's (1994) representation for getting the parameter
<code class="reqn">\eta =</code> mean(<code class="reqn">F</code>).  If you do not intend
to use this parameter, then take <code class="reqn">K</code> small, say
<code class="reqn">K=10</code>.</p>
</td></tr>  
<tr><td><code id="bf1_+3A_burnin">burnin</code></td>
<td>
<p>is the number of Markov chain cycles to drop.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><cite>Doss (2012)</cite> describes a method for estimating Bayes
factors for many <code class="reqn">M</code> values in a Dirichlet mixing model;
the method requires judicious selection of multiple hyperparameter
points at which to estimate the posterior distribution by MCMC under
the ordinary Dirichlet model.  The function <code>bf1</code> is used for
estimating Bayes factors for conditional vs.\ ordinary Dirichlet
models, and for comparing values of <code class="reqn">M</code> in the conditional
model or in the ordinary model, for a range of the precision parameter
<code class="reqn">M</code> which cover the range of values of interest in most
practical problems.  The function <code>bf1</code> generates the MCMC
output for a hard-wired selection of hyperparameters which work
well to give low-variance estimates of Bayes factors of interest
in practice.  Chains are generated for nine values of the Dirichlet
precision parameter <code class="reqn">M</code>:
<code class="reqn">.25, .5, 1, 2, 4, 8, 16, 32</code>,
and <code class="reqn">64</code>.
The rest of the Dirichlet model is specified by the parameters of the
normal/inverse Gamma prior, which by default are 
<code class="reqn">\vec{d} = (.1,.1,0,1000)</code>.  
</p>


<h3>Value</h3>

<p>List with nine matrix components.  Each matrix has
<code class="reqn">nr</code> rows and <code class="reqn">nc</code> columns, where
<code class="reqn">nr=</code> <code>ncycles</code> <code class="reqn">-</code> <code>burnin</code>,
<code class="reqn">nc=</code> (number of studies) <code class="reqn">+ 4</code> for the row label,
the individual study parameter values, and the three overall
parameters, <code class="reqn">\mu</code>, <code class="reqn">\tau</code>, and <code class="reqn">\eta</code>.
</p>


<h3>References</h3>

<p>Doss, Hani (2012).  &ldquo;Hyperparameter and model selection for
nonparametric Bayes problems via Radon-Nikodym derivatives.&rdquo;
<em>Statistica Sinica</em>, 22, 1&ndash;26.
</p>
<p>Sethuraman, J. (1994).  &ldquo;A constructive definition of Dirichlet
priors.&rdquo; <em>Statistica Sinica 4</em>, 639&ndash;650.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Set up the data.

data(breast.17) # the breast cancer dataset
breast.data &lt;- as.matrix(breast.17) # put data in matrix object

## Default values ncycles=2000, burnin=1000, seed=1
##  CPU time is given from a run of the R command system.time() on an
##  Intel $2.8$ GHz Q$9550$ running Linux
chain1.list &lt;- bf1(breast.data) # 40.5 secs
## Next get a second set of 9 chains, with a different seed 
chain2.list &lt;- bf2(breast.data, seed=2) # 40.4 secs

## Perhaps save for another time.
save(chain1.list,chain2.list,file="breast-rdat-2lists-1000",compress=TRUE)

## later session
load("breast-rdat-2lists-1000")


## End(Not run)
</code></pre>

<hr>
<h2 id='bf2'>Compute Constants for Multi-Chain Algorithm to Compute
Bayes Factors</h2><span id='topic+bf2'></span>

<h3>Description</h3>

<p>This function computes nine constants needed in the multi-chain
algorithm for Bayes factors comparing conditional and ordinary
Dirichlet mixing models, and for Bayes factors comparing Dirichlet
precision parameter (<code class="reqn">M</code>) values for the conditional model,
or for the ordinary model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bf2(chain.list)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bf2_+3A_chain.list">chain.list</code></td>
<td>
<p>is a list of nine matrices of MCMC output produced by
function bf1</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the constants needed for the
denominator of the left-side of Eqn. (2.5) of Doss (2012).
This is the step in which Radon-Nikodym derivatives are evaluated
for each line of MCMC output and then averaged to estimate the
constants.  The actual algorithm is a little more complicated than
that to make use of output from multiple chains.  Nine constants are
computed in this way.
</p>


<h3>Value</h3>

<p>A vector of nine constants which is needed in the next step
of the computation of the Bayes factors.  
Burr (2012) gives detailed explanations of the algorithm and
illustrates the steps in the algorithm.
</p>


<h3>References</h3>

<p>Burr, Deborah (2012).  &ldquo;bspmma:  An R package for Bayesian
semi-parametric models for meta-analysis.&rdquo;  <em>Journal of
Statistical Software</em> 50(4), 1&ndash;23.
<a href="http://www.jstatsoft.org/v50/i04/.">http://www.jstatsoft.org/v50/i04/.</a>
</p>
<p>Doss, Hani (2012).  &ldquo;Hyperparameter and model selection for
nonparametric Bayes problems via Radon-Nikodym derivatives.&rdquo;
<em>Statistica Sinica</em>, 22, 1&ndash;26.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Get the two sets of chains saved from runs of bf1 from
## the breast cancer example in the help file for bf1.
load("breast-rdat-2lists-1000")

## Default values ncycles=2000, burnin=1000
##  CPU time is from a run of the R command system.time() on an
##  Intel $2.8$ GHz Q$9550$ running Linux.
cc &lt;- bf2(chain1.list) #1.6 secs

## Perhaps save for another time.
save(cc,file="breast-rdat-constants",compress=TRUE)

## Next session
load("breast-rdat-constants")


## End(Not run)
</code></pre>

<hr>
<h2 id='breast.17'>Aspirin and Breast Cancer: 17 studies</h2><span id='topic+breast.17'></span>

<h3>Description</h3>

<p>This dataset gives log odds of
breast cancer for long-term aspirin users, and its standard error,
derived from 17 cohort and case-control studies.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(breast.17)</code></pre>


<h3>Format</h3>

<p>A data frame with seventeen rows, corresponding to the seventeen
papers.  There are two columns: psi.hat (numeric, the log odds ratio),
and se.psi.hat (numeric, estimated SE of the log odds ratio).
The <code>rownames</code> attribute gives the first author of the paper
and the citation number of the study in <cite>Harris et.\ al. (2005)</cite>.</p>


<h3>Source</h3>

<p>Harris, R., Beebe-Donk, J., Doss, H., and Burr, D. (2005).
&ldquo;Aspirin, ibuprofen, and other non-steroidal anti-inflammatory
drugs in cancer prevention: A critical review of non-selective
COX-2 blockade (Review).&rdquo;  <em>Oncology Reports 13</em> 559-583.</p>


<h3>References</h3>

<p>Gonzalez-Perez, A., Rodriguez, L., and Lopez-Ridaura, R. (2003).
&ldquo;Effects of non-steroidal anti-inflammatory drugs
on cancer sites other than the colon and rectum: a meta-analysis.&rdquo;
<em>BMC Cancer 3</em> 28.
</p>
<p>Khuder, S. and Mutgi, A. (2001).  &ldquo;Breast cancer and
NSAID use: a meta-analysis.&rdquo;  <em>British Journal of Cancer 84</em>,
1188&ndash;1192.
</p>

<hr>
<h2 id='caprie.3grps'>CAPRIE Study: Three Risk Groups</h2><span id='topic+caprie.3grps'></span>

<h3>Description</h3>

<p>From the CAPRIE study comparing clopidogrel versus Aspirin,
this dataset gives risk ratios and their SEs separately for patients
who had stroke, heart attack (myocardial infarction or MI), and
peripheral arterial disease (PAD).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(caprie.3grps)</code></pre>


<h3>Format</h3>

<p>A data frame with three rows, corresponding to the three risk groups.
There are three columns: study (character, for the risk groups),
psi.hat (numeric, the log odds ratio, and se.psi.hat (numeric,
estimated SE of the log odds ratio).</p>


<h3>Source</h3>

<p>CAPRIE Steering Committee (1996), A randomized, blinded trial of
clopidogrel versus aspirin in patients at risk of ischaemic events
(CAPRIE), <em>Lancet</em>, 348, 1329&ndash;1339.
</p>
<p>Burr and Doss (2005) state how the SEs for the log odds ratios for the
three risk groups are
obtained from data on p.\ 1334 of the CAPRIE article.</p>


<h3>References</h3>

<p>Burr, D. and Doss, H. (2005).  A Bayesian semi-parametric
model for random effects meta analysis.  <em>The
Journal of the American Statistical Association</em>,100,
242&ndash;251.</p>

<hr>
<h2 id='ddtm.s'>Decontamination of the Digestive Tract Mortality, Short Dataset</h2><span id='topic+ddtm.s'></span>

<h3>Description</h3>

<p>This dataset gives number of deaths and number of subjects
in treatment vs. control groups in 14 studies from a meta-analysis of
studies on antiobiotics to reduce infection in intensive-care units.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ddtm.s)</code></pre>


<h3>Format</h3>

<p>A data frame with fourteen rows, corresponding to fourteen
different, unidentified studies.  There are four columns: number of
deaths in the treatment group, sample size in the treatment group,
number of deaths in the control group, sample size in the control
group.
</p>
<p><cite>Burr and Doss (2005)</cite> give the background for this dataset.</p>


<h3>Source</h3>

<p>Selective Decontamination of the Digestive Tract Trialists'
Collaborative Group (1993).  &ldquo;Meta-analysis of randomised
controlled trials of selective decontamination of the digestive tract.&rdquo;
<em>British Medical Journal 307</em> 525&ndash;532.</p>


<h3>References</h3>

<p>Burr, D. and Doss, H. (2005).  &ldquo;A Bayesian semiparametric model
for random-effects meta-analysis.&rdquo;  <em>Journal of the American
Statistical Association 100</em> 242&ndash;251.  
</p>

<hr>
<h2 id='describe.post'>Brief summary statistics of the posterior for convenient
comparison of several models</h2><span id='topic+describe.post'></span>

<h3>Description</h3>

<p>Compute, print posterior means and posterior P(odds ratio &lt; 1) for
the individual study parameters and hyperparameters of the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>describe.post(mcout,burnin=1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="describe.post_+3A_mcout">mcout</code></td>
<td>
<p>is a list.  Each item in the list is a matrix of MCMC
output, corresponding to different values of <code class="reqn">M</code>, the precision
parameter of the Dirichlet model.  If the matrices are output
from <code>dirichlet.c</code>, each matrix has <code class="reqn">ncycles</code> <code class="reqn">+1</code>
rows and <code class="reqn">m+2</code> columns, where
<code class="reqn">m</code> is the number of studies in the meta-analysis and
<code class="reqn">ncycles</code> is the number of runs of the Markov chain.
The matrix output from the ordinary Dirichlet model function
<code>dirichlet.o</code> is similar but has an additional column.  The
rows hold output from separate Markov chain runs (the first row is
the initial values.)  Columns <code class="reqn">1</code> through <code class="reqn">m</code> hold the
individual study parameters, the <code class="reqn">\psi_i</code>'s.  The next two
columns hold the mean and standard deviation parameters of the
centering normal distribution of the Dirichlet prior,
<code class="reqn">\mu</code> and <code class="reqn">\tau</code>.  In the case of the ordinary
Dirichlet model, an additional column is added to hold the values
of <code class="reqn">\eta</code>.</p>
</td></tr>
<tr><td><code id="describe.post_+3A_burnin">burnin</code></td>
<td>
<p>is the number of initial chains to omit from the
estimates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with two named components, means.table and probs.table, returned
invisibly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Set up the data.

data(breast.17) # the breast cancer dataset
breast.data &lt;- as.matrix(breast.17) # put data in matrix object

## Generate at least two chains, from models which are the same except
## for different \eqn{M} values.

set.seed(1) # initialize the seed at 1 
breast.c1 &lt;- dirichlet.c(breast.data, ncycles=4000, M=5)
breast.c2 &lt;- dirichlet.c(breast.data,ncycles=4000, M=1000)

## Create list object.
breast.c1c2 &lt;- list("5"=breast.c1$chain, "1000"= breast.c2$chain)

## Decide on some number of initial runs to omit from the analysis.
describe.post(breast.c1c2, burnin=100)

## End(Not run)
</code></pre>

<hr>
<h2 id='dirichlet.c'>Mixture of Conditional Dirichlet Model</h2><span id='topic+dirichlet.c'></span>

<h3>Description</h3>

<p>MCMC generation of posterior distributions for the
conditional Dirichlet mixing distribution model, using
<code class="reqn">m+1</code>-cycle Gibbs sampler</p>


<h3>Usage</h3>

<pre><code class='language-R'>dirichlet.c(data, ncycles=10, M=1,d=c(.1,.1,0,1000),
            start=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dirichlet.c_+3A_data">data</code></td>
<td>
<p>is a two-column matrix with a row for each study
in the meta-analysis.  The first column is the log of estimate
of relative risk, often a log(odds ratio).  The second column is
the true or estimated standard error of the log(odds ratio).</p>
</td></tr>
<tr><td><code id="dirichlet.c_+3A_ncycles">ncycles</code></td>
<td>
<p>is the number of cycles of the Markov chain.</p>
</td></tr>
<tr><td><code id="dirichlet.c_+3A_m">M</code></td>
<td>
<p>is the precision parameter of the Dirichlet process prior.</p>
</td></tr>
<tr><td><code id="dirichlet.c_+3A_d">d</code></td>
<td>
<p>is a vector of length four with the values of the
hyperparameters, in order, the location and scale of the Gamma
inverse prior, mean and variance multiplier for the normal prior
on <code class="reqn">\mu</code>.</p>
</td></tr>
<tr><td><code id="dirichlet.c_+3A_start">start</code></td>
<td>
<p>is an optional vector containing starting values for the
parameters, <code class="reqn">\psi_i, i=1, \ldots, m</code> where <code class="reqn">m</code> is the number of
studies in the meta-analysis, <code class="reqn">\mu</code> and <code class="reqn">\tau</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates MCMC output for the posterior distribution for
the parameters <code class="reqn">\psi_i, i=1, \ldots, m</code>
where <code class="reqn">m</code> is the number of
studies in the meta-analysis, <code class="reqn">\mu</code> and <code class="reqn">\tau</code>,
in the conditional Dirichlet mixing model for random-effects
meta-analysis.  Notation is taken from <cite>Burr (2012)</cite>,
Model <code class="reqn">4</code>.
</p>
<p>The MCMC algorithm for estimating the posterior under this model is
given in <cite>Burr and Doss (2005)</cite>.  The chain is a
<code class="reqn">(m+1)</code>-cycle Gibbs sampler which cycles through
the vector of <code class="reqn">\psi_i</code>'s and the pair <code class="reqn">\mu</code>,
<code class="reqn">\tau</code>, and
the main part of the computational burden is in the first part of the
cycle, the generation of the vector of <code class="reqn">\psi_i</code>'s.
</p>
<p>If starting values are not specified via the argument <code>start</code>,
the default values are used, which are based on the data.  The study
estimates are the starting values for the <code class="reqn">\psi_i, i=1, \ldots,m</code>,
and the mean and standard deviation of the study estimates are the
starting values for <code class="reqn">\mu</code> and <code class="reqn">\tau</code>, respectively.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>call</code></td>
<td>
<p>the call that resulted in this object</p>
</td></tr>
<tr><td><code>ncycles</code></td>
<td>
<p>the number of cycles in the Markov chain</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>the value of the precision parameter for the conditional
Dirichlet model</p>
</td></tr>
<tr><td><code>prior</code></td>
<td>
<p>the vector length four of hyperparameters</p>
</td></tr>
<tr><td><code>chain</code></td>
<td>
<p>A matrix with <code>ncycles</code> <code class="reqn">+1</code> rows and <code class="reqn">m+2</code>
columns, where <code class="reqn">m</code> is the number of studies in the meta-analysis.
The rows hold output from the Markov chain runs (the first row is
the initial values).   Columns <code class="reqn">1</code> through <code class="reqn">m</code> hold the
individual study parameters, the <code class="reqn">\psi_i</code>'s.  The final two
columns hold the mean and standard deviation parameters of the
centering normal distribution of the Dirichlet prior, <code class="reqn">\mu</code>
and <code class="reqn">\tau</code>.</p>
</td></tr>
<tr><td><code>start.user</code></td>
<td>
<p>logical, TRUE if the user supplied initial values of
the parameter vector, FALSE if input argument <code>start</code> was not
specified by the user.</p>
</td></tr>
<tr><td><code>start</code></td>
<td>
<p>vector of initial parameter values used in the MCMC
algorithm, whether this was the default or was user-supplied</p>
</td></tr>
</table>


<h3>References</h3>

<p>Burr, Deborah (2012).  &ldquo;bspmma:  An R package for Bayesian
semi-parametric models for meta-analysis.&rdquo;  <em>Journal of
Statistical Software</em> 50(4), 1&ndash;23.
<a href="http://www.jstatsoft.org/v50/i04/.">http://www.jstatsoft.org/v50/i04/.</a>
</p>
<p>Burr, D. and Doss, H. (2005).  &ldquo;A Bayesian semiparametric model
for random-effects meta-analysis.&rdquo;  <em>Journal of the American
Statistical Association 100</em> 242&ndash;251.
</p>
<p>Sethuraman, J. (1994).  &ldquo;A constructive definition of Dirichlet 
priors.&rdquo;  <em>Statistica Sinica 4</em>, 639&ndash;650.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(breast.17) # the dataset
breast.data &lt;- as.matrix(breast.17) # put data in matrix object
set.seed(1) # initialize the seed at 1 for test purposes
breast.c1 &lt;- dirichlet.c(breast.data, ncycles=4000, M=5)
breast.c2 &lt;- dirichlet.c(breast.data,ncycles=4000, M=1000)

## End(Not run)
</code></pre>

<hr>
<h2 id='dirichlet.o'>Mixture of Ordinary Dirichlet Model</h2><span id='topic+dirichlet.o'></span>

<h3>Description</h3>

<p>MCMC generation of posterior distributions for the
usual (unconditional) Dirichlet mixing distribution model, using
an <code class="reqn">m+1</code>-cycle Gibbs sampler</p>


<h3>Usage</h3>

<pre><code class='language-R'>dirichlet.o(data, ncycles=10, M=1,d=c(.1,.1,0,1000),
            start=NULL,K=100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dirichlet.o_+3A_data">data</code></td>
<td>
<p>is a two-column matrix with a row for each study
in the meta-analysis.  The first column is the log of estimate
of relative risk, often a log(odds ratio).  The second column is
the true or estimated standard error of the log(odds ratio).</p>
</td></tr>
<tr><td><code id="dirichlet.o_+3A_ncycles">ncycles</code></td>
<td>
<p>is the number of cycles of the Markov chain.</p>
</td></tr>
<tr><td><code id="dirichlet.o_+3A_m">M</code></td>
<td>
<p>is the precision parameter of the Dirichlet process prior.</p>
</td></tr>
<tr><td><code id="dirichlet.o_+3A_d">d</code></td>
<td>
<p>is a vector of length four with the values of the
hyperparameters, in order, the location and scale of the Gamma
inverse prior, mean and variance multiplier for the normal prior
on mu.</p>
</td></tr>
<tr><td><code id="dirichlet.o_+3A_start">start</code></td>
<td>
<p>is an optional vector containing starting values for the
parameters, <code class="reqn">\psi_i, i=1, \ldots, m</code> where <code class="reqn">m</code> is the number of
studies in the meta-analysis, <code class="reqn">\mu</code> and <code class="reqn">\tau</code>.</p>
</td></tr>  
<tr><td><code id="dirichlet.o_+3A_k">K</code></td>
<td>
<p>is the number of summands to include when one uses
Sethuraman's (1994) representation for getting the parameter
<code class="reqn">\eta =</code> mean(<code class="reqn">F</code>).  If you do not intend to use this
parameter, then take <code class="reqn">K</code> small, say <code class="reqn">K=10</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates MCMC output for the posterior distribution for
the parameters <code class="reqn">\psi_i, i=1,...,m</code> where <code class="reqn">m</code> is the number of
studies in the meta-analysis, <code class="reqn">\mu</code>, <code class="reqn">\tau</code>, and <code class="reqn">\eta</code>
in the ordinary Dirichlet mixing model for random-effects
meta-analysis.  Notation is taken from <cite>Burr (2012)</cite>,
Model <code class="reqn">2</code> and <code class="reqn">3</code>.
</p>
<p>The MCMC algorithm for estimating the posterior under this model is
given in <cite>Burr and Doss (2005)</cite>.  The chain is a
<code class="reqn">(m+1)</code>-cycle Gibbs sampler which cycles through
the vector of <code class="reqn">\psi_i</code>'s and the triple <code class="reqn">\mu</code>, <code class="reqn">\tau</code>,
<code class="reqn">\eta</code>, and the main part of the computational burden is in the
first part of the cycle, the generation of the vector of
<code class="reqn">\psi_i</code>'s.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>call</code></td>
<td>
<p>the call that resulted in this object</p>
</td></tr>
<tr><td><code>ncycles</code></td>
<td>
<p>the number of cycles in the Markov chain</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>the value of the precision parameter for the conditional
Dirichlet model</p>
</td></tr>
<tr><td><code>prior</code></td>
<td>
<p>the vector length four of hyperparameters</p>
</td></tr>
<tr><td><code>chain</code></td>
<td>
<p>A matrix with <code>ncycles</code> <code class="reqn">+1</code> rows and
<code class="reqn">m+3</code> columns, where <code class="reqn">m</code> is the number of studies in the
meta-analysis.  The rows hold output from the Markov chain runs
(the first row is the initial values).  Columns <code class="reqn">1</code> through
<code class="reqn">m</code> hold the individual study parameters, the <code class="reqn">\psi_i</code>'s.
The next two columns hold the mean and standard deviation
parameters of the centering normal distribution of the Dirichlet
prior, <code class="reqn">\mu</code> and <code class="reqn">\tau</code>, and the final column holds
the parameter <code class="reqn">\eta</code>.  In the ordinary Dirichlet mixing model,
the parameter <code class="reqn">\mu</code> does not equal the mean of the
distribution <code class="reqn">F</code> of the <code class="reqn">\psi_i</code>'s; we denote this
mean <code class="reqn">\eta</code> and estimate it by Sethuraman's (1994) method.</p>
</td></tr>
<tr><td><code>start.user</code></td>
<td>
<p>logical, TRUE if the user supplied initial values of
the parameter vector, FALSE if input argument <code>start</code> was not
specified by the user.</p>
</td></tr>
<tr><td><code>start</code></td>
<td>
<p>vector of initial parameter values, whether default or
user-supplied</p>
</td></tr>
</table>


<h3>References</h3>

<p>Burr, Deborah (2012).  &ldquo;bspmma:  An R package for Bayesian
semi-parametric models for meta-analysis.&rdquo;  <em>Journal of
Statistical Software</em> 50(4), 1&ndash;23.
<a href="http://www.jstatsoft.org/v50/i04/.">http://www.jstatsoft.org/v50/i04/.</a>
</p>
<p>Burr, D. and Doss, H. (2005).  &ldquo;A Bayesian semiparametric model
for random-effects meta-analysis.&rdquo;  <em>Journal of the American
Statistical Association 100</em> 242&ndash;251.
</p>
<p>Sethuraman, J. (1994).  &ldquo;A constructive definition of Dirichlet
priors.&rdquo;  <em>Statistica Sinica 4</em>, 639&ndash;650.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(breast.17) # the dataset
breast.data &lt;- as.matrix(breast.17) # put data in matrix object
set.seed(1) # initialize the seed at 1 
diro &lt;- dirichlet.o(breast.data, ncycles=4000, M=5)

## a short description of the model and Markov chain
print(diro1)

## the last mcmc cycle
diro$mcmc[4001,]

## End(Not run)
</code></pre>

<hr>
<h2 id='draw.bf'>Plot Function for Bayes Factors</h2><span id='topic+draw.bf'></span>

<h3>Description</h3>

<p>This function plots the output from function bf.c.o.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.bf(obj,line.lwd=2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw.bf_+3A_obj">obj</code></td>
<td>
<p>is a list with two elements, the vectors x and y to be
plotted in a scatterplot, which are produced by function <code>bf.c.o</code>.
The first element is the values of <code class="reqn">M</code> to go on the x-axis,
and the second element is the Bayes factors calculated by
<code>bf.c.o</code>.</p>
</td></tr>
<tr><td><code id="draw.bf_+3A_line.lwd">line.lwd</code></td>
<td>
<p>graphical parameter; the relative thickness of the
plotted line</p>
</td></tr>
<tr><td><code id="draw.bf_+3A_...">...</code></td>
<td>
<p>additional graphical parameters for the overall plot</p>
</td></tr>
</table>

<hr>
<h2 id='draw.post'>Overlapping Plots of Posterior Distributions for Several Models</h2><span id='topic+draw.post'></span>

<h3>Description</h3>

<p>Draw overlapping kernel density estimates of the posterior
distributions of the parameters of the conditional or ordinary
Dirichlet model, where the posteriors arise from different values
of the Dirichlet precision parameter <code class="reqn">M</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.post(mcout,burnin=1000,ind.par=NULL,adjust=1,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw.post_+3A_mcout">mcout</code></td>
<td>
<p>is a list.  Each item in the list is a matrix of MCMC
output, corresponding to different values of <code class="reqn">M</code>, the precision
parameter of the Dirichlet model.  If the matrices are output
from <code>dirichlet.c</code>, each matrix has <code class="reqn">ncycles</code> <code class="reqn">+1</code>
rows and <code class="reqn">m+2</code> columns, where
<code class="reqn">m</code> is the number of studies in the meta-analysis and
<code class="reqn">ncycles</code> is the number of runs of the Markov chain.
The matrix output from the ordinary Dirichlet model function
<code>dirichlet.o</code> is similar but has an additional column.  The
rows hold output from separate Markov chain runs (the first row is
the initial values.)  Columns <code class="reqn">1</code> through <code class="reqn">m</code> hold the
individual study parameters, the <code class="reqn">\psi_i</code>'s.  The next two
columns hold the mean and standard deviation parameters of the
centering normal distribution of the Dirichlet prior,
<code class="reqn">\mu</code> and <code class="reqn">\tau</code>.  In the case of the ordinary
Dirichlet model, an additional column is added to hold the values
of <code class="reqn">\eta</code>.</p>
</td></tr>
<tr><td><code id="draw.post_+3A_burnin">burnin</code></td>
<td>
<p>is the number of initial chains to omit from the
estimates, must be no larger than <code class="reqn">ncycles - 10</code>.</p>
</td></tr>
<tr><td><code id="draw.post_+3A_ind.par">ind.par</code></td>
<td>
<p>an integer vector, containing indices of which columns
of <code>mcout</code> to include in the plots.  By default, only the
posterior density estimates for the hyperparameters <code class="reqn">\mu</code>
and <code class="reqn">\tau</code></p>
</td></tr>
<tr><td><code id="draw.post_+3A_adjust">adjust</code></td>
<td>
<p>is the bin width argument for the call to the R base
package function density.</p>
</td></tr>
<tr><td><code id="draw.post_+3A_...">...</code></td>
<td>
<p>additional arguments to plot may be supplied.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Conditional Dirichlet model

## Set up the breast cancer dataset.

data(breast.17) 
breast.data &lt;- as.matrix(breast.17) # Data must be a matrix object.

##  Generate at least two chains, from models which are the same except
## for different \eqn{M}{M} values.

set.seed(1) # initialize the seed at 1 for test purposes
breast.c1 &lt;- dirichlet.c(breast.data, ncycles=4000, M=5)
breast.c2 &lt;- dirichlet.c(breast.data,ncycles=4000, M=1000)

##  Create list object.

breast.c1c2 &lt;- list("5"=breast.c1$chain, "1000"= breast.c2$chain)

##  Decide on some number of initial runs to omit from the analysis.

draw.post(breast.c1c2, burnin=100) # plots for hyperparameters only

## End(Not run)
</code></pre>

<hr>
<h2 id='print.dir.cond'>printing method for objects of class dir.cond</h2><span id='topic+print.dir.cond'></span>

<h3>Description</h3>

<p>gives limited info</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dir.cond'
print(x,digits=max(3,getOption("digits") -3),...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.dir.cond_+3A_x">x</code></td>
<td>
<p>object of class dir.cond</p>
</td></tr>
<tr><td><code id="print.dir.cond_+3A_digits">digits</code></td>
<td>
<p>positive integer, number of digits for printing</p>
</td></tr>
<tr><td><code id="print.dir.cond_+3A_...">...</code></td>
<td>
<p>place holder</p>
</td></tr>
</table>

<hr>
<h2 id='print.dir.ord'>printing method for objects of class dir.ord</h2><span id='topic+print.dir.ord'></span>

<h3>Description</h3>

<p>gives limited info</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dir.ord'
print(x,digits=max(3,getOption("digits") -3),...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.dir.ord_+3A_x">x</code></td>
<td>
<p>object of class dir.ord</p>
</td></tr>
<tr><td><code id="print.dir.ord_+3A_digits">digits</code></td>
<td>
<p>positive integer, number of digits for printing</p>
</td></tr>
<tr><td><code id="print.dir.ord_+3A_...">...</code></td>
<td>
<p>place holder</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
