<!DOCTYPE html><html><head><title>Help for package semgram</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {semgram}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#extract_motifs'><p>Extract semantic motifs from parsed text object</p></a></li>
<li><a href='#semgram'><p>semgram: R package for extracting semantic motifs from text</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Extracting Semantic Motifs from Textual Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>A framework for extracting semantic motifs around entities in textual data. It implements an entity-centered semantic grammar that distinguishes six classes of motifs: actions of an entity, treatments of an entity, agents acting upon an entity, patients acted upon by an entity, characterizations of an entity, and possessions of an entity. Motifs are identified by applying a set of extraction rules to a parsed text object that includes part-of-speech tags and dependency annotations - such as those generated by 'spacyr'. For further reference, see: Stuhler (2022) &lt;<a href="https://doi.org/10.1177%2F00491241221099551">doi:10.1177/00491241221099551</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/omstuhler/semgram">https://github.com/omstuhler/semgram</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/omstuhler/semgram/issues">https://github.com/omstuhler/semgram/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table, rsyntax (&ge; 0.1.2), stringr</td>
</tr>
<tr>
<td>Author:</td>
<td>Oscar Stuhler <a href="https://orcid.org/0000-0001-7391-1743"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Oscar Stuhler &lt;semgram.r@gmail.com&gt;</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-30 06:19:05 UTC; oscar</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-31 10:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='extract_motifs'>Extract semantic motifs from parsed text object</h2><span id='topic+extract_motifs'></span>

<h3>Description</h3>

<p>This function extracts semantic motifs from text. The input is a data.frame representing a parsed text such as those returned by spacyr::spacy_parse().
The output is a list of data.frames containing semantic motifs such as actions or characterizations of textual entities. For a detailed explanation, see Stuhler (2022).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_motifs(
  tokens,
  entities = "*",
  motif_classes = c("t", "a", "be", "H", "At", "aP"),
  custom_cols,
  fast = F,
  parse_multi_token_entities = T,
  extract = "lemma",
  markup = F,
  add_sentence = F,
  be_entity = T,
  get_aux_verbs = F,
  aux_verb_markup = T,
  pron_as_ap = F,
  use_appos = T,
  lowercase = F,
  verbose = F
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_motifs_+3A_tokens">tokens</code></td>
<td>
<p>A tokens data.frame with predicted dependencies as generated, for instance, by spacyr::spacy_parse(). Dependencies need to be in ClearNLP style. This tag set is used by all English language models implemented in spaCy. Other languages or dependency grammars are currently not supported.</p>
</td></tr>
<tr><td><code id="extract_motifs_+3A_entities">entities</code></td>
<td>
<p>Specifies the core entities around which to extract motifs. This can be a single character string or a vector of character strings.
By default, multi-token strings such as &quot;Harry Potter&quot; will be parsed and considered. Note that this parameter is case-sensitive.
It defaults to &quot;*&quot; in which case any token is treated as a potential entity.</p>
</td></tr>
<tr><td><code id="extract_motifs_+3A_motif_classes">motif_classes</code></td>
<td>
<p>A character vector specifying which motif classes should be considered in the extraction.
This can include &quot;t&quot; for treatments, &quot;a&quot; for actions, &quot;be&quot; for characterizations, &quot;H&quot; for possessions, as well as &quot;At&quot; and &quot;aP&quot; for agent-treatment and action-patient motifs respectively.
By default, all motif classes are considered. Note, however, that runtime increases with the number of motif classes considered.</p>
</td></tr>
<tr><td><code id="extract_motifs_+3A_custom_cols">custom_cols</code></td>
<td>
<p>Generally, the columns in the tokens object should be labeled as follows: &quot;doc_id&quot;, &quot;sentence_id&quot;, &quot;token_id&quot;, &quot;token&quot;, &quot;lemma&quot;, &quot;pos&quot;, &quot;head_token_id&quot; , &quot;dep_rel&quot;. If the columns in your tokens object are not labeled according to this scheme, provide the matching column names to custom_cols in the corresponding order.</p>
</td></tr>
<tr><td><code id="extract_motifs_+3A_fast">fast</code></td>
<td>
<p>If set to true, some of the more specific extraction rules are not applied. This results in fewer extractions but faster run time. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="extract_motifs_+3A_parse_multi_token_entities">parse_multi_token_entities</code></td>
<td>
<p>Should multi-token entities (e.g., &quot;Harry Potter&quot;) be considered? Defaults to TRUE. When using multi-token entities, it is crucial that tokens are separated by a space character. Input should match the tokenized version in the tokens object.
For instance, hyphens are usually considered a token in tokenization, so that &quot;Claude Levi-Strauss&quot; should be passed to the function as &quot;Claude Levi - Strauss&quot;.</p>
</td></tr>
<tr><td><code id="extract_motifs_+3A_extract">extract</code></td>
<td>
<p>Defines whether extracted motifs are represented in &quot;lemma&quot; or &quot;token&quot; form. Defaults to &quot;lemma&quot; which reduces sparsity and is preferable for most purposes.</p>
</td></tr>
<tr><td><code id="extract_motifs_+3A_markup">markup</code></td>
<td>
<p>If TRUE, motifs will also be provided as collapsed markup tokens (e.g., &quot;aP_ask_Harry&quot;). Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="extract_motifs_+3A_add_sentence">add_sentence</code></td>
<td>
<p>If TRUE, the sentence for each motif is added to the extracted motif. Note that this is done by pasting together the tokens of the sentence, so that the representation might differ minimally from the original text. Nonetheless, this can be helpful for validation and for a mode of analyses that switches between distant and close readings of the text. Defaults to FALSE. Note that setting this to TRUE will noticeably increase runtime.</p>
</td></tr>
<tr><td><code id="extract_motifs_+3A_be_entity">be_entity</code></td>
<td>
<p>Should things that are linked to an entity via &quot;being&quot; (or one of its lemmas) be considered as characterization motifs?
For example, if we are extracting characterizations around the &quot;immigrants&quot; in the sentence &quot;my parents are immigrants&quot;, should we extract the characterization motif &quot;be_parent&quot;? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="extract_motifs_+3A_get_aux_verbs">get_aux_verbs</code></td>
<td>
<p>Should auxiliary verbs (e.g., can, could, may, must) be considered actions? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="extract_motifs_+3A_aux_verb_markup">aux_verb_markup</code></td>
<td>
<p>Should auxiliary verbs with &quot;to&quot; be marked up so that &quot;going&quot; in &quot;going to eat&quot; becomes &quot;going-to&quot;.
Note that this will not affect cases of the sort &quot;going to the bar.&quot; This can be useful for analyses concerning modality. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="extract_motifs_+3A_pron_as_ap">pron_as_ap</code></td>
<td>
<p>Should pronouns be considered agents and patients? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="extract_motifs_+3A_use_appos">use_appos</code></td>
<td>
<p>Should things linked to an entity via an appositional modifier be considered as equivalent to the entity?
For example, if we specify our entity to be &quot;Peter&quot; in the sentence &quot;My brother Peter left.&quot;, should &quot;brother&quot; be considered equivalent to &quot;Peter&quot;?
Only if use_appos = TRUE, we can extract &quot;leaving&quot; as action motif associated with Peter, as the subject associated with &quot;leaving&quot; is &quot;brother&quot;. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="extract_motifs_+3A_lowercase">lowercase</code></td>
<td>
<p>Should all tokens and lemmas be lowercased? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="extract_motifs_+3A_verbose">verbose</code></td>
<td>
<p>Should progress be reported during execution? Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the main function for extracting semantic motifs around entities. Extraction is done by applying a set of extraction rules to the parsed text object
that includes part-of-speech tags and dependency relations. Details on the scope of these rules, the theoretical reasoning behind them, and the markup used for motifs can be found in Stuhler (2022).
For a recent application, see Stuhler (2021). The following is an abbreviated explanation of the motif classes from Stuhler (2022: 22-23).
</p>
<p>Action motifs imply that an entity is doing something. The most straightforward example of this is when the entity serves as a nominal subject
of a verb (&quot;ENTITY calls.&quot; - a_call). There are various syntactic constructions, however, in which a verb is considered an action despite the entity not being its nominal
subject. This includes instances in which the entity is the conjunct of a 
nominal subject (&quot;John and ENTITY called.&quot; - a_call), there are multiple verbs (&quot;ENTITY calls and asks.&quot; - a_call, a_ask), 
the entity  serves as an appositional modifier of a nominal subject (My friend ENTITY called. - a_call), 
and passive constructions (&quot;John was called by ENTITY.&quot; - a_call). All actions are either lexical verbs or, if explicitly specified, auxiliary verbs.
</p>
<p>Patient motifs are things that the entity of interest acts towards. They are usually objects of 
transitive verbs that were identified as an entity’s action. These objects can be in accusative case (&quot;ENTITY asks John.&quot; - aP_ask_John) 
or in dative case if the verb is ditransitive (&quot;ENTITY asks John a question.&quot; - aP_ask_John, aP_ask_question). 
Any action motif can lead to multiple Patient motifs – as any transitive verb can have multiple conjunct objects 
(&quot;ENTITY calls John, Jane, and Steve.&quot; - aP_call_John, aP_call_Jane, aP_call_Steve).
Beyond objects, nominal passive subjects are also considered patients (&quot;John is asked by ENTITY.&quot; - aP_ask_John).
</p>
<p>Treatment motifs imply that something is done to an entity of interest. 
This is the case when the entity is the object of a transitive verb. The relationship 
between treatments and the entity is analogous to that of actions and patients.
The entity can function as accusative (&quot;John calls ENTITY&quot; - t_call) or dative 
(&quot;John gives ENTITY an apple.&quot; - t_give) object, as
nominal passive subject (&quot;ENTITY was called.&quot; - t_call), or as conjunct of any 
of these (&quot;John calls Peter and ENTITY&quot; - t_call).
</p>
<p>Agent motifs are things that act towards the entity of interest via a treatment
motif. In most cases, agents are the nominal subject of a verb that has
been identified as a treatment motif (&quot;John calls ENTITY.&quot; - t_call). However, 
agents need not
take that position and can be conjuncts (&quot;Peter and John ask ENTITY.&quot; - At_Peter_ask, At_John_ask) 
or appositional modifiers (&quot;My friend John
asked your brother ENTITY.&quot; - At_friend_ask, At_John_ask) of the nominal subject. Generally, 
the relationship between agents and treatments is analogous to that of the entity and actions, 
so that the transitive verb may take different positions (&quot;John came and asked ENTITY.&quot; - 
At_John_ask; &quot;John wants to ask ENTITY.&quot; At_John_ask), and passive constructions in which 
the entity serves as nominal passive subject (&quot;ENTITY is asked by John.&quot; - At_John_ask) are considered.
</p>
<p>Beyond these process motifs, there are two classes of stasis motifs.
Characterizations are characteristics ascribed to the entity of interest. There
are several ways in which this can happen. The most common one is via a
copular verb, that has either an adjectival (&quot;ENTITY is kind.&quot; - be_kind; &quot;ENTITY looks sad.&quot; - 
be_sad; &quot;ENTITY is kind
and honest.&quot; - be_kind, be_honest) or nominal (&quot;ENTITY is the winner.&quot; - be_winner; &quot;ENTITY 
hopes to remain president.&quot; - be_president) attribute dependent. However, adjectives can also 
be direct dependents of the entity (&quot;John bought a cheap, new ENTITY.&quot; - be_cheap, be_new) to 
be considered characterizations. Furthermore, nominal subjects of copular verbs with the 
entity as attribute dependent (&quot;The winner was ENTITY.&quot; - be_winner) and heads with the 
entity as appositional modifier (&quot;My brother ENTITY won.&quot; - be_brother) are considered characterizations.
</p>
<p>Possessions are things that the entity of interest is said to possess. The rule
set accounts for three ways in which this can be expressed. First, when the
entity serves as a possession modifier to a noun, said noun and its conjunct
dependents are considered possessions (&quot;ENTITY‘s spouse, friends, and parents were 
shocked.&quot; - H_spouse, H_friend, H_parent). Second, constructions where
the entity serves as object dependent of the preposition “of” can lead to possessions (&quot;The 
breaks and wheels of the ENTITY were old.&quot; - H_breaks, H_wheels). Third, if the entity serves 
as nominal subject of “have” or one of its inflections, its direct object and nominal 
conjunctions thereof are considered possessions (&quot;ENTITY has friends and enemies.&quot; - H_friend, H_enemy). 
Note that “have” is a transitive verb, but within the grammar, it is not considered an action, 
and consequently its objects aren’t considered patients.
</p>


<h3>Value</h3>

<p>A list with six dataframes, one for each motif class. List elements of motif classes not specified in the motif_classes parameter will be empty.
</p>


<h3>References</h3>

<p>Stuhler, O. (2022) &quot;Who Does What To Whom? Making Text Parsers Work for Sociological Inquiry.&quot; Sociological Methods and Research. &lt;doi: 10.1177/00491241221099551&gt;.
</p>
<p>Stuhler, O. (2021) &quot;What's in a category? A new approach to Discourse Role Analysis.&quot; Poetics 88. &lt;doi:10.1016/j.poetic.2021.101568&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Given data.frame with parsed sentence – as can be generated with spacyr::spacy_parse().
tokens_df = data.frame(doc_id = rep("text1", 4),
                       sentence_id = rep(1, 4),
                       token_id = 1:4,
                       token = c("Emil", "chased", "the", "thief"),
                       lemma = c("Emil", "chase", "the", "thief"),
                       pos = c("PROPN", "VERB", "DET", "NOUN"),
                       head_token_id = c(2,2,4,2),
                       dep_rel = c("nsubj", "ROOT", "det", "dobj")
                       )

# Extract motifs around specific entities, here "Emil"
extract_motifs(tokens = tokens_df, entities = c("Emil"))

# Extract all possible motifs
extract_motifs(tokens = tokens_df, entities = "*")
</code></pre>

<hr>
<h2 id='semgram'>semgram: R package for extracting semantic motifs from text</h2><span id='topic+semgram'></span>

<h3>Description</h3>

<p>semgram extracts semantic motifs from textual data. It builds on an entity-centered semantic grammar that distinguishes six classes of motifs: actions of an entity, treatments of an entity, agents acting upon an entity, patients acted upon by an entity, characterizations of an entity, and possessions of an entity.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
