<!DOCTYPE html><html><head><title>Help for package RNCEP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RNCEP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gull'><p>GPS data points from a lesser black-backed gull</p></a></li>
<li><a href='#NCEP.aggregate'><p> Temporally Aggregate Weather Data</p></a></li>
<li><a href='#NCEP.Airspeed'><p> Calculate flow-assistance according to equation 'Airspeed'</p></a></li>
<li><a href='#NCEP.array2df'><p> Convert data from an array to a data frame</p></a></li>
<li><a href='#NCEP.bind'><p> Bind Two 3-D Arrays of Weather Data Along the Prime Meridian</p></a></li>
<li><a href='#NCEP.flight'><p> Simulate Trajectories</p></a></li>
<li><a href='#NCEP.FlowSpeed'><p> Calculate flow-assistance according to equation 'FlowSpeed'</p></a></li>
<li><a href='#NCEP.gather'><p>Queries Weather Data</p></a></li>
<li><a href='#NCEP.Groundspeed'><p> Calculate flow-assistance according to equation 'Groundspeed'</p></a></li>
<li><a href='#NCEP.interp'><p> Interpolates Weather Data to a point in space and time</p></a></li>
<li><a href='#NCEP.loxodrome'><p> Calculate the loxodrome angle between two points on Earth.</p></a></li>
<li><a href='#NCEP.M.Groundspeed'><p> Calculate flow-assistance according to equation 'M.Groundspeed'</p></a></li>
<li><a href='#NCEP.NegFlowSpeed'><p> Calculate flow-assistance according to equation 'NegFlowSpeed'</p></a></li>
<li><a href='#NCEP.PartialSpeed'><p> Calculate flow-assistance according to equation 'PartialSpeed'</p></a></li>
<li><a href='#NCEP.restrict'><p> Temporally Filters Weather Data</p></a></li>
<li><a href='#NCEP.Tailwind'><p> Calculate flow-assistance according to equation 'Tailwind'</p></a></li>
<li><a href='#NCEP.track2kml'><p> Plot a track in Google Earth</p></a></li>
<li><a href='#NCEP.uv.revert'><p> Reverts speed and direction to U and V components.</p></a></li>
<li><a href='#NCEP.vis.area'><p> Visualize Weather Data on a Map</p></a></li>
<li><a href='#NCEP.vis.points'><p> Visualize Weather Data Interpolated to a Point on a Map</p></a></li>
<li><a href='#RNCEP-package'>
<p>This package of functions retrieves, organizes, and visualizes weather data from either the NCEP/NCAR Reanalysis or NCEP/DOE Reanalysis II datasets</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Obtain, Organize, and Visualize NCEP Weather Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.10</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-05-26</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael U. Kemp &lt;mukemp+RNCEP@gmail.com&gt; with contributions from E. Emiel van Loon, Judy Shamoun-Baranes, and Willem Bouten</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael U. Kemp &lt;mukemp+RNCEP@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains functions to retrieve, organize, and visualize weather data from the NCEP/NCAR Reanalysis (<a href="http://www.esrl.noaa.gov/psd/data/gridded/data.ncep.reanalysis.html">http://www.esrl.noaa.gov/psd/data/gridded/data.ncep.reanalysis.html</a>) and NCEP/DOE Reanalysis II (<a href="http://www.esrl.noaa.gov/psd/data/gridded/data.ncep.reanalysis2.html">http://www.esrl.noaa.gov/psd/data/gridded/data.ncep.reanalysis2.html</a>) datasets.  Data are queried via the Internet and may be obtained for a specified spatial and temporal extent or interpolated to a point in space and time.  We also provide functions to visualize these weather data on a map.  There are also functions to simulate flight trajectories according to specified behavior using either NCEP wind data or data specified by the user.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>RColorBrewer, abind, fields, tgp, tcltk, graphics, sp</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), maps</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.esrl.noaa.gov/psd/data/gridded/reanalysis/">https://www.esrl.noaa.gov/psd/data/gridded/reanalysis/</a>
<a href="https://sites.google.com/site/michaelukemp/home">https://sites.google.com/site/michaelukemp/home</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-05-26 22:55:05 UTC; michael.kemp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-05-27 05:30:22 UTC</td>
</tr>
</table>
<hr>
<h2 id='gull'>GPS data points from a lesser black-backed gull </h2><span id='topic+gull'></span>

<h3>Description</h3>

<p>This data set contains a collection of GPS coordinates
obtained between June 2008 and July 2009.  The GPS tag,
developed by the University of Amsterdam, was worn by
a lesser black-backed gull (Larus fuscus).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gull</code></pre>


<h3>Format</h3>

<p>A data.frame containing 22115 observations of the varibles latitude, longitude, altitude, and datetime.</p>

<hr>
<h2 id='NCEP.aggregate'> Temporally Aggregate Weather Data </h2><span id='topic+NCEP.aggregate'></span>

<h3>Description</h3>

<p>This function temporally aggregates weather data from the NCEP/NCAR Reanalysis or NCEP/DOE Reanalysis II datasets as returned by <code><a href="#topic+NCEP.gather">NCEP.gather</a></code>.  The spatial structure of the data is retained.  Data can be aggregated by any combination of year, month, day, and hour.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCEP.aggregate(wx.data, YEARS = TRUE, MONTHS = TRUE, DAYS = TRUE,
    HOURS = TRUE, fxn = "%&gt;0")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCEP.aggregate_+3A_wx.data">wx.data</code></td>
<td>
<p> the 3-D array of weather data as returned by <code><a href="#topic+NCEP.gather">NCEP.gather</a></code> to be aggregated </p>
</td></tr>
<tr><td><code id="NCEP.aggregate_+3A_years">YEARS</code></td>
<td>
<p> Logical.  Should the years portion of the datetime be retained in the aggregation? </p>
</td></tr>
<tr><td><code id="NCEP.aggregate_+3A_months">MONTHS</code></td>
<td>
<p> Logical.  Should the months portion of the datetime be retained in the aggregation? </p>
</td></tr>
<tr><td><code id="NCEP.aggregate_+3A_days">DAYS</code></td>
<td>
<p> Logical.  Should the days portion of the datetime be retained in the aggregation? </p>
</td></tr>
<tr><td><code id="NCEP.aggregate_+3A_hours">HOURS</code></td>
<td>
<p> Logical.  Should the hours portion of the datetime be retained in the aggregation? </p>
</td></tr>
<tr><td><code id="NCEP.aggregate_+3A_fxn">fxn</code></td>
<td>
<p> A scalar function to be applied to all aggregated subsets of the data. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each latitude and longitude combination in the array is subset according to the logical datetime arguements in the function call, and <code>fxn</code> is applied to the subsets.  <code>fxn</code> can be an internal R function such as <code><a href="base.html#topic+mean">mean</a></code>, <code><a href="base.html#topic+sum">sum</a></code>, or <code><a href="stats.html#topic+sd">sd</a></code>, or it can be a function created by the user.
</p>
<p>The default setting of <code>fxn</code> (i.e. <code>"%&gt;0"</code>) calculates the percentage of observations in each subset greater than zero.
</p>
<p>To calculate some variables, sequential aggregations may be needed.  For instance, if the user wants to calculate monthly averages of maximum daily relative humidity, two aggregations would be needed.
In the first aggregation, the user would find the maximum relative humidity per day.
A second aggregation would then be required to find the monthly average of those maximum daily values.  See the examples below for a demonstration.
</p>


<h3>Value</h3>

<p>A three-dimensional array (or 2-D if all layers are completely aggregated) containing the same latitude and longitude ranges and intervals as the input data specified in <code>wx.data</code>.
The names of the aggregated time components will be replaced with <code>"XX"</code> or <code>"XXXX"</code> in the output array.
</p>


<h3>Author(s)</h3>

<p> Michael U. Kemp <a href="mailto:mukemp+RNCEP@gmail.com">mukemp+RNCEP@gmail.com</a> </p>


<h3>References</h3>

<p> Kemp, M. U., van Loon, E. E., Shamoun-Baranes, J., and Bouten, W. 2011. RNCEP:global weather and climate data at your fingertips. &ndash; Methods in Ecology and Evolution. DOI:10.1111/j.2041-210X.2011.00138.x. </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(RNCEP)
######################################################
## In the first example, we use the internal R function
## 'mean' to calculate average temperatures per
## month and year

## First gather temperature data from a spatial extent
## for January and February from 2000-2001. 
wx.extent &lt;- NCEP.gather(variable='air', level=850, 
    months.minmax=c(1,2), years.minmax=c(2000,2001), 
    lat.southnorth=c(50, 55), lon.westeast=c(0, 5),
    reanalysis2=FALSE, return.units=TRUE)

## Now calculate the average temperature per month and year ##
wx.ag &lt;- NCEP.aggregate(wx.data=wx.extent, YEARS=TRUE, MONTHS=TRUE,
    DAYS=FALSE, HOURS=FALSE, fxn='mean')

## Notice that aggregated time components have been replaced 
## with "XX" or "XXXX" ##
dimnames(wx.ag)[[3]][1]
	
#######################################################
## In the second example, we create our own function to
## calculate the percentage of observations at each grid
## point with a temperature less than -5 degrees Celsius ##

## First create the function ##
## Note: temperature is in degrees Kelvin in NCEP database ##
COLD &lt;- function(x){
    return(length(which(x &lt; 273.15-5))/(length(x) - sum(is.na(x))))
    }

## Now calculate the percentage of occuence of temperatures
## less than -5 degrees Celsius per month and year ##
wx.cold &lt;- NCEP.aggregate(wx.data=wx.extent, YEARS=TRUE, MONTHS=TRUE,
    DAYS=FALSE, HOURS=FALSE, fxn='COLD')

	
##########################################################
## As explained in the Details section above,
## calculating some variables requires sequential aggregations ##
## Here we calculate the monthly mean of daily average
## relative humidity.

## First gather relative humidity data from near the surface
## for a spatial extent for October through November 
## from 2001-2002. 
wx.extent &lt;- NCEP.gather(variable='rhum.sig995', level='surface',
    months.minmax=c(10,11), years.minmax=c(2001,2002), 
    lat.southnorth=c(50, 55), lon.westeast=c(0, 5),
    reanalysis2=FALSE, return.units=FALSE)

## First calculate maximum daily relative humidity ##
wx.ag &lt;- NCEP.aggregate(wx.data=wx.extent, 
    HOURS=FALSE, fxn='max')

## Then calculate the monthly average of those daily maximums ##
wx.ag2 &lt;- NCEP.aggregate(wx.data=wx.ag, 
    DAYS=FALSE, fxn='mean')

	

##########################################################
## Data that have been aggregated may then be visualized
## or exported in various formats ##

###########################################
## Visualize the aggregated temperatures ##
NCEP.vis.area(wx.ag2, title.args=
    list(main='Monthly average of daily maximum relative humidity
    \n October 2000'), image.plot.args=
    list(legend.args=list(text='%',
    cex=1.15, padj=-1, adj=-.25)))

###########################################################
## Export a layer of the data to a format that can then be
## imported into ArcGIS ##

## Convert the first layer of the aggregated array
## to a data.frame ##
wx.df &lt;- NCEP.array2df(wx.ag[,,1])

## Specify that the data.frame is a spatial object
library(sp)
coordinates(wx.df) &lt;- ~longitude+latitude
gridded(wx.df) &lt;- TRUE
proj4string(wx.df) &lt;- CRS('+proj=longlat + datum=WGS84')

## Save the data in .asc format
write.asciigrid(wx.df, fname='wx.asc')
## Note: Data will be written to your working directory ##

## The resulting .asc file can be imported into ArcMap
## using ArcMap's "ASCII to Raster" tool in the "Conversion Tools"
## section of the ArcToolbox. ##

## End(Not run)
</code></pre>

<hr>
<h2 id='NCEP.Airspeed'> Calculate flow-assistance according to equation 'Airspeed' </h2><span id='topic+NCEP.Airspeed'></span>

<h3>Description</h3>

<p>This function calculates flow-assistance according to equation Airspeed and determines the speed of forward and sideways movement if an animal behaves according to the rules of equation Airspeed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCEP.Airspeed(u, v, direction, airspeed,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCEP.Airspeed_+3A_u">u</code></td>
<td>
<p> A numeric value indicating the U (i.e. zonal or east/west) flow component in meters per second, toward east being positive.  Values must describe the direction into which the flow is moving.    </p>
</td></tr>
<tr><td><code id="NCEP.Airspeed_+3A_v">v</code></td>
<td>
<p> A numeric value indicating the V (i.e. meridional or north/south) flow component in meters per second, toward north being positive.  Values must describe the direction into which the flow is moving. </p>
</td></tr>
<tr><td><code id="NCEP.Airspeed_+3A_direction">direction</code></td>
<td>
<p> A numeric value indicating a preferred direction of movement in degrees from North. </p>
</td></tr>
<tr><td><code id="NCEP.Airspeed_+3A_airspeed">airspeed</code></td>
<td>
<p> The airspeed (i.e. speed relative to the flow) of the animal in meters per second. </p>
</td></tr>  
<tr><td><code id="NCEP.Airspeed_+3A_...">...</code></td>
<td>
<p> Any extra arguments passed to the flow-assistance equation. </p>
</td></tr>  
</table>


<h3>Details</h3>

<p>This function calculates flow-assistance and forward and sideways movement according to equation Airspeed.  Equation Airspeed stipulates that the animal fully compensates for any lateral drift, altering its heading and groundspeed (i.e. speed relative to the fixed Earth), in order to maintain its <code>direction</code>.  If, with the given <code>airspeed</code>, the animal is incapable of maintaining its <code>direction</code>, the equation produces no real solution.  
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing flow-assistance (&lsquo;fa&rsquo;), the animal's forward speed (&lsquo;forward.move&rsquo; which includes the animal's own airspeed), the animal's sideways speed (&lsquo;side.move&rsquo; which includes the animal's own airspeed), the component of the flow parallel to preferred direction of movement(&lsquo;tailwind&rsquo;), the component of the flow perpendicular to the preferred direction of movement (&lsquo;sidewind&rsquo;), the animal's speed relative to the flow (&lsquo;airspeed&rsquo;), and the animal's speed relative to the fixed Earth (&lsquo;groundspeed&rsquo;) each in meters per second, presuming <code>u</code>, <code>v</code>, and <code>airspeed</code> were given in meters per second. </p>


<h3>Author(s)</h3>

<p> Michael U. Kemp <a href="mailto:mukemp+RNCEP@gmail.com">mukemp+RNCEP@gmail.com</a> </p>


<h3>References</h3>

 <p><b>To cite package 'RNCEP' in publications use:</b>
</p>
<p>Kemp, M. U., van Loon, E. E., Shamoun-Baranes, J., and Bouten, W. 2011. RNCEP:global weather and climate data at your fingertips. &ndash; Methods in Ecology and Evolution. DOI:10.1111/j.2041-210X.2011.00138.x. 
</p>
<p><b>For more information on flow-assistance and equation Airspeed see:</b>
</p>
<p>Kemp, M.U., Shamoun-Baranes, J., van Loon, E. E., and Bouten, W. 2012. Quantifying flow-assistance and implications for movement research. &ndash; Journal of Theoretical Biology. In prep.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(RNCEP)
## Using NCEP.Airspeed to calculate flow-assistance ##
tst &lt;- NCEP.Airspeed(u=-2, v=-1, direction=225, airspeed=12)
</code></pre>

<hr>
<h2 id='NCEP.array2df'> Convert data from an array to a data frame </h2><span id='topic+NCEP.array2df'></span>

<h3>Description</h3>

<p>This function takes a 3-dimensional array of weather data, as returned by <code><a href="#topic+NCEP.gather">NCEP.gather</a></code>, and converts it to a dataframe composed of latitude, longitude, datetime, and the weather data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCEP.array2df(wx.data, var.names=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCEP.array2df_+3A_wx.data">wx.data</code></td>
<td>
<p> either a single 3-D array of weather data, as returned by <code>NCEP.gather</code>, or a list of multiple 3-D arrays of different variables but with the exact same spatial and temporal dimensions and intervals.  </p>
</td></tr>
<tr><td><code id="NCEP.array2df_+3A_var.names">var.names</code></td>
<td>
<p> an optional vector of names for the weather variables in the 3-D arrays to be used in the output data frame </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a function to convert the data contained in one or many arrays to a single data.frame.
</p>
<p>The order of the names specified in <code>var.names</code> should correspond to the order of the list of input arrays in <code>wx.data</code>.  Latitude, longitude, and datetime are named automatically and cannot be changed in the function call.
</p>
<p>When converting the data from two or more 3-D arrays to a single data frame, all 3-D arrays must contain the exact same spatial and temporal dimensions and intervals.
</p>


<h3>Value</h3>

<p>A data frame with the components of latitudes, longitude, datetime, and the weather variable(s) from the input data array(s).
</p>


<h3>Author(s)</h3>

<p> Michael U. Kemp <a href="mailto:mukemp+RNCEP@gmail.com">mukemp+RNCEP@gmail.com</a> </p>


<h3>References</h3>

<p> Kemp, M. U., van Loon, E. E., Shamoun-Baranes, J., and Bouten, W. 2011. RNCEP:global weather and climate data at your fingertips. &ndash; Methods in Ecology and Evolution. DOI:10.1111/j.2041-210X.2011.00138.x. </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(RNCEP)
############################################################
############################################################
## In this first example, we take data from a single 3-D array
## and arrange them in a data.frame ##
#############################################################

## First query the temperature for a particular pressure level
## and datetime range ##
wx.extent &lt;- NCEP.gather(variable='air', level=850,
    months.minmax=c(8,9), years.minmax=c(2006,2007),
    lat.southnorth=c(50,55), lon.westeast=c(0,5),
    reanalysis2 = FALSE, return.units = TRUE)
	
## Then convert the 3-D array to a data.frame ##
wx.df &lt;- NCEP.array2df(wx.data=wx.extent, var.names='Temperature')

############################################################
############################################################
## In this second example, we take data from two 3-D arrays 
## and arrange them in a single data.frame ##
#############################################################

## Query the U (east/west) and V (north/south) wind components
## for a particular pressure level and datetime range ##
wx.uwnd &lt;- NCEP.gather(variable='uwnd', level=850,
    months.minmax=c(8,9), years.minmax=c(2006,2007),
    lat.southnorth=c(50,55), lon.westeast=c(0,5),
    reanalysis2 = FALSE, return.units = TRUE)
wx.vwnd &lt;- NCEP.gather(variable='vwnd', level=850,
    months.minmax=c(8,9), years.minmax=c(2006,2007),
    lat.southnorth=c(50,55), lon.westeast=c(0,5),
    reanalysis2 = FALSE, return.units = TRUE)	
	
## Then convert the two 3-D arrays to a single data.frame ##
wx.df &lt;- NCEP.array2df(wx.data=list(wx.uwnd, wx.vwnd), 
    var.names=c('Uwind', 'Vwind'))

## End(Not run)
</code></pre>

<hr>
<h2 id='NCEP.bind'> Bind Two 3-D Arrays of Weather Data Along the Prime Meridian </h2><span id='topic+NCEP.bind'></span>

<h3>Description</h3>

<p>This function is applied automatically by <code><a href="#topic+NCEP.gather">NCEP.gather</a></code> whenever it is needed.  It binds the results from either side of the Prime Meridian.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCEP.bind(data.west, data.east)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCEP.bind_+3A_data.west">data.west</code></td>
<td>
<p> a 3-D array of weather data, as returned by <code> NCEP.gather </code>, from the West side of the Prime Meridian </p>
</td></tr>
<tr><td><code id="NCEP.bind_+3A_data.east">data.east</code></td>
<td>
<p> a 3-D array of weather data, as returned by <code> NCEP.gather </code>, from the East side of the Prime Meridian </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is applied automatically by <code><a href="#topic+NCEP.gather">NCEP.gather</a></code> whenever it is needed.
</p>
<p>The arrays specified in <code>data.west</code> and <code>data.east</code> must have the same latitude and datetime intervals and extents.
</p>
<p>This function depends on the package <span class="pkg"><a href="abind.html#topic+abind">abind</a></span>
</p>
<p>The maximum longitudinal extent of the NCEP dataset is 357.5 not 360.
</p>


<h3>Value</h3>

<p>A 3-D array with the same latitude and datetime intervals and extent as <code>data.west</code> and <code>data.east</code>.  Row names (i.e. longitudes) for data from the west of the Prime Meridian are converted from positive to negative values.
</p>


<h3>Author(s)</h3>

<p> Michael U. Kemp <a href="mailto:mukemp+RNCEP@gmail.com">mukemp+RNCEP@gmail.com</a> </p>


<h3>References</h3>

<p> Kemp, M. U., van Loon, E. E., Shamoun-Baranes, J., and Bouten, W. 2011. RNCEP:global weather and climate data at your fingertips. &ndash; Methods in Ecology and Evolution. DOI:10.1111/j.2041-210X.2011.00138.x. </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(RNCEP)
## Using NCEP.gather(), query weather data from both sides of
## the Prime Meridian ##
## NCEP.bind() is applied automatically ##
wx &lt;- NCEP.gather(variable='air', level=925,
    months.minmax=10, years.minmax=2003,
    lat.southnorth=c(50, 52.5), lon.westeast=c(-2.5, 2.5),
    reanalysis2=FALSE, return.units=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='NCEP.flight'> Simulate Trajectories </h2><span id='topic+NCEP.flight'></span>

<h3>Description</h3>

<p>This function simulates a single trajectory for any time and location by default using wind data returned by <code><a href="#topic+NCEP.interp">NCEP.interp</a></code>.  Various flight behaviors are possible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCEP.flight(beg.loc, end.loc, begin.dt, flow.assist='NCEP.Tailwind', 
  fa.args=list(airspeed=12), path='loxodrome', calibrate.dir=FALSE, 
  calibrate.alt=TRUE, cutoff=0, when2stop=list('latitude','longitude',50),
  levels2consider=c(850,925), hours=12, evaluation.interval=60, id=1, 
  land.if.bad=FALSE, reanalysis2 = FALSE, query=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCEP.flight_+3A_beg.loc">beg.loc</code></td>
<td>
<p> A numeric vector of length two giving the starting location in decimal degrees i.e. c(latitude, longitude)</p>
</td></tr>
<tr><td><code id="NCEP.flight_+3A_end.loc">end.loc</code></td>
<td>
<p> A numeric vector of length two giving the end location (i.e. goal location) in decimal degrees i.e. c(latitude, longitude)</p>
</td></tr>
<tr><td><code id="NCEP.flight_+3A_begin.dt">begin.dt</code></td>
<td>
<p> A character string in the format '%Y-%m-%d %H:%M:%S' indicating the day and time at which to initiate take-off. </p>
</td></tr>
<tr><td><code id="NCEP.flight_+3A_flow.assist">flow.assist</code></td>
<td>
<p> A character string giving the name of the flow-assistance function to apply, which also specifies the behavior of the animal in relation to the flow conditions.  See Details below. </p>
</td></tr>
<tr><td><code id="NCEP.flight_+3A_fa.args">fa.args</code></td>
<td>
<p> A list of arguments passed to the flow-assistance function.  See Details below. </p>
</td></tr>
<tr><td><code id="NCEP.flight_+3A_path">path</code></td>
<td>
<p> Either a numeric value indicating the preferred direction of movement in degrees from North, or one of 'loxodrome' or 'great.circle' describing the method of calculating the preferred direction. </p>
</td></tr>
<tr><td><code id="NCEP.flight_+3A_calibrate.dir">calibrate.dir</code></td>
<td>
<p> A logical expression indicating whether or not to re-calibrate the <code>path</code> to the goal at each evaluation interval. </p>
</td></tr>
<tr><td><code id="NCEP.flight_+3A_calibrate.alt">calibrate.alt</code></td>
<td>
<p> A logigal expression indicating whether or not to re-calibrate the altitude from which to obtain wind data at each evaluation interval.  </p>
</td></tr>
<tr><td><code id="NCEP.flight_+3A_cutoff">cutoff</code></td>
<td>
<p> A numeric value indicating the minimum acceptable flow-assistance to initiate the simulation (and to continue the simulation if <code>land.if.bad = TRUE</code>). </p>
</td></tr>
<tr><td><code id="NCEP.flight_+3A_when2stop">when2stop</code></td>
<td>
<p> A list containing at least one of 'latitude', 'longitude', or a numeric value. See Details below.</p>
</td></tr>
<tr><td><code id="NCEP.flight_+3A_levels2consider">levels2consider</code></td>
<td>
<p> A vector indicating the altitudes at which to consider wind conditions.  Values may be numeric and describe specific pressure levels or may be a character string describing 'surface' and/or 'gaussian'.  See <code><a href="#topic+NCEP.interp">NCEP.interp</a></code> </p>
</td></tr>
<tr><td><code id="NCEP.flight_+3A_hours">hours</code></td>
<td>
<p> A numeric value indicating the maximum number of hours to continue the simulation, in case the spatial goal is not reached. </p>
</td></tr>
<tr><td><code id="NCEP.flight_+3A_evaluation.interval">evaluation.interval</code></td>
<td>
<p> A numeric value indicating the interval (in minutes) in which to reassess the situation and recalibrate (if <code>calibrate.dir</code> or <code>calibrate.alt</code> is <code>TRUE</code>).  Also the interval at which movement statistics are calculated. </p>
</td></tr>
<tr><td><code id="NCEP.flight_+3A_id">id</code></td>
<td>
<p> A character string or numeric value giving an id for the simulation. </p>
</td></tr>
<tr><td><code id="NCEP.flight_+3A_land.if.bad">land.if.bad</code></td>
<td>
<p> A logical expression describing whether or not the simulation should be interrupted if the flow-assistance is <code>NA</code> or below the <code>cutoff</code>. </p>
</td></tr>
<tr><td><code id="NCEP.flight_+3A_reanalysis2">reanalysis2</code></td>
<td>
<p> A logical expression indicating whether wind data should come from the Reanalysis I dataset (<code>FALSE</code>) or from Reanalysis II (<code>TRUE</code>). See <code><a href="#topic+NCEP.interp">NCEP.interp</a></code>. </p>
</td></tr>
<tr><td><code id="NCEP.flight_+3A_query">query</code></td>
<td>
<p> A logical expression indicating whether or not to use <code><a href="#topic+NCEP.interp">NCEP.interp</a></code> to retrieve wind data.  See Details below. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simulates a single trajectory according to the behavioral rules specified in <code>flow.assist</code>.
</p>
<p>The argument <code>flow.assist</code> gives the flow-assistance equation to apply.  It also determines how the animal will behave in relation to the flow conditions and thus how the animal will move.  Internal options for <code>flow.assist</code> include &quot;<code><a href="#topic+NCEP.FlowSpeed">NCEP.FlowSpeed</a></code>&quot;, &quot;<code><a href="#topic+NCEP.NegFlowSpeed">NCEP.NegFlowSpeed</a></code>&quot;, &quot;<code><a href="#topic+NCEP.Tailwind">NCEP.Tailwind</a></code>&quot;, &quot;<code><a href="#topic+NCEP.Groundspeed">NCEP.Groundspeed</a></code>&quot;, &quot;<code><a href="#topic+NCEP.M.Groundspeed">NCEP.M.Groundspeed</a></code>&quot;, &quot;<code><a href="#topic+NCEP.Airspeed">NCEP.Airspeed</a></code>&quot;,and &quot;<code><a href="#topic+NCEP.PartialSpeed">NCEP.PartialSpeed</a></code>&quot;.  Each flow-assistance equation requires further arguements that should be given as a list to <code>fa.args</code>.
</p>
<p>Users are invited to create their own flow-assistance functions using one of the existing functions as a template.  Any flow-assistance function that is used in the context of <code>NCEP.flight</code> must contain at least the arguments <code>u</code>, <code>v</code>, and <code>direction</code>, as these arguments are passed directly by <code>NCEP.flight</code> if <code>query</code> == <code>TRUE</code>.  If <code>query</code> == <code>FALSE</code>, only the argument <code>direction</code> is passed directly by <code>NCEP.flight</code>.  Any other arguments are possible, and their value may be set using <code>fa.args</code>.  As well, any flow-assistance function that is used in the context of <code>NCEP.flight</code> must produce a <code>data.frame</code> as output.  This <code>data.frame</code> must contain at least the variables <code>fa</code>, <code>forward.move</code>, and <code>side.move</code>, but may also contain as many other variables as desired.  Note that <code>forward.move</code> and <code>side.move</code> should give forward and sideways speeds relative to the specified <code>direction</code> in meters per second and should already account for the animal's own airspeed.   
</p>
<p>If <code>calibrate.dir</code> is <code>TRUE</code>, the animal will adjust its <code>direction</code> at each <code>evaluation.interval</code> if necessary to reorient to its <code>end.loc</code>.  The new direction is calculated according to the specification of <code>path</code>.  If <code>calibrate.dir</code> is <code>FALSE</code> and <code>path</code> is not numeric, the direction to the <code>end.loc</code> is calculated before take-off but not again during the simulation.
If <code>path</code> is <code>'loxodrome'</code>, the rhumb line or constant compass direction is calculated to the <code>end.loc</code>.  See <code><a href="#topic+NCEP.loxodrome">NCEP.loxodrome</a></code>.  If <code>path</code> is <code>'great.circle'</code>, the angle describing the shortest path to the <code>end.loc</code> is calculated using <code><a href="fossil.html#topic+earth.bear">earth.bear</a></code>.
A warning is issued if <code>path</code> is numeric and <code>calibrate.dir</code> is <code>TRUE</code>.
</p>
<p>If <code>calibrate.alt</code> is <code>TRUE</code>, the animal will select at each <code>evaluation.interval</code> from <code>levels2consider</code> the most supportive flow conditions according to the specified <code>flow.assist</code> equation.
If <code>calibrate.alt</code> is <code>FALSE</code> and the length of <code>levels2consider</code> is greater than one, the animal will select from <code>levels2consider</code> the most supportive flow conditions according to the specified <code>flow.assist</code> equation only when initiating the simulation and will continue using conditions at that level thereafter.
</p>
<p>If the list passed to <code>when2stop</code> includes the character strings 'latitude' or 'longitude' the simulation will stop when the latitude or longitude, respectively, of the <code>end.loc</code> is reached.  A numeric argument passed to the <code>when2stop</code> list indicates a distance from the <code>end.loc</code> in kilometers at which to stop the simulation. The simulation will end when any of the <code>when2stop</code> arguments are satisfied.
</p>
<p>The argument <code>query</code> indicates whether or not to use <code><a href="#topic+NCEP.interp">NCEP.interp</a></code> to retrieve wind data from the NCEP database via the Internet.  This is intended to facilitate the use of flow conditions from sources other than NCEP.  For example, one could use the time and location of the animal at each timestep to retrieve data from an oceanic dataset or an atmospheric dataset with higher resolution than NCEP.  Alternatively, one could examine the trajectory of an animal that encounters consistent flow conditions of a given intensity for its entire journey.  Since the user supplies the flow information, there is no need to query wind data from NCEP, and the function will run much faster.  See the examples for a demonstration.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing at least the flow-assistance (i.e. <code>fa</code>), <code>forward.move</code>, and <code>side.move</code> each in meters per second. </p>


<h3>Author(s)</h3>

<p> Michael U. Kemp <a href="mailto:mukemp+RNCEP@gmail.com">mukemp+RNCEP@gmail.com</a> </p>


<h3>References</h3>

 <p><b>To cite package 'RNCEP' in publications use:</b>
</p>
<p>Kemp, M. U., van Loon, E. E., Shamoun-Baranes, J., and Bouten, W. 2011. RNCEP:global weather and climate data at your fingertips. &ndash; Methods in Ecology and Evolution. DOI:10.1111/j.2041-210X.2011.00138.x. 
</p>
<p><b>For more information on flow-assistance and NCEP.flight see:</b>
</p>
<p>Kemp, M.U., Shamoun-Baranes, J., van Loon, E. E., and Bouten, W. 2012. Quantifying flow-assistance and implications for movement research. &ndash; Journal of Theoretical Biology. In prep. </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(RNCEP)
## Use NCEP.flight(), to simulate a flight over the North Sea 
## from Norway to the Netherlands using NCEP wind data
## queried automatically from the NCEP Reanalysis datset ##
## Not run: tst &lt;- NCEP.flight(beg.loc=c(58.00,7.00), 
  end.loc=c(53.00,7.00), begin.dt='2007-10-01 18:00:00',
  flow.assist='NCEP.Tailwind', fa.args=list(airspeed=12),
  path='loxodrome', calibrate.dir=FALSE, calibrate.alt=FALSE,
  cutoff=0, when2stop='latitude', levels2consider=c(850,925),
  hours=12, evaluation.interval=60, id=1, land.if.bad=FALSE,
  reanalysis2 = FALSE)
## End(Not run)
  

#######################################################
## Use NCEP.flight(), to simulate a flight without 
## querying the NCEP database.  In this case, we use
## constant wind conditions (i.e. u=2 and v=0). ##
tst2 &lt;- NCEP.flight(beg.loc=c(58.00,7.00), end.loc=c(53.00,7.00), 
  begin.dt='2007-10-01 18:00:00', flow.assist='NCEP.Tailwind', 
  fa.args=list(u=2, v=0, airspeed=12), path='loxodrome',
  calibrate.dir=TRUE, calibrate.alt=FALSE, cutoff=-10, when2stop='latitude', 
  levels2consider=850, hours=12, evaluation.interval=60, 
  id=1, land.if.bad=FALSE, reanalysis2 = FALSE, query=FALSE)

#######################################################
## Use NCEP.flight(), to simulate a flight without 
## querying the NCEP database.  In this case, we use
## wind conditions that depend on the animal's location ##

## First create a flow assistance function that will
## generate u and v flow components based on the animal's
## location
## Note that to use the datetime and the animal's location,
## the function MUST have the arguments lat.x, lon.x, and dt.x
Ex.FA &lt;- function(direction, lat.x, lon.x, dt.x, airspeed){
    deg2rad = pi/180
    rad2deg = 180/pi
    ## Generate U and V flow component based on lat and lon
    u.x &lt;- sin(lat.x*deg2rad) 
    v.x &lt;- cos(lon.x*deg2rad)
    ## Apply NCEP.Tailwind with generated flow data
    return(cbind(NCEP.Tailwind(u=u.x, v=v.x,
        direction=direction, airspeed=airspeed), u.x, v.x))
    }

## Now use the function we just created in NCEP.flight
## The location and datetime are passed to the flow-
## assistance function automatically as lat.x, lon.x, and dt.x
tst3 &lt;- NCEP.flight(beg.loc=c(58.00,7.00), end.loc=c(53.00,7.00), 
  begin.dt='2007-10-01 18:00:00', flow.assist='Ex.FA', 
  fa.args=list(airspeed=12), path='loxodrome',calibrate.dir=TRUE, 
  calibrate.alt=FALSE, cutoff=-10, when2stop='latitude',
  levels2consider=850, hours=12, evaluation.interval=60, 
  id=1, land.if.bad=FALSE, reanalysis2 = FALSE, query=FALSE)

## Confirm that the U and V wind components were determined
## by the latitude and longitude at each timestep
sin(tst3$lat[3] * (pi/180)) == tst3$u.x[3]
cos(tst3$lon[7] * (pi/180)) == tst3$v.x[7]

</code></pre>

<hr>
<h2 id='NCEP.FlowSpeed'> Calculate flow-assistance according to equation 'FlowSpeed' </h2><span id='topic+NCEP.FlowSpeed'></span>

<h3>Description</h3>

<p>This function calculates flow-assistance according to equation FlowSpeed and determines the speed of forward and sideways movement if an animal behaves according to the rules of equation FlowSpeed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCEP.FlowSpeed(u, v, direction, airspeed,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCEP.FlowSpeed_+3A_u">u</code></td>
<td>
<p> A numeric value indicating the U (i.e. zonal or east/west) flow component in meters per second, toward east being positive.  Values must describe the direction into which the flow is moving.    </p>
</td></tr>
<tr><td><code id="NCEP.FlowSpeed_+3A_v">v</code></td>
<td>
<p> A numeric value indicating the V (i.e. meridional or north/south) flow component in meters per second, toward north being positive.  Values must describe the direction into which the flow is moving. </p>
</td></tr>
<tr><td><code id="NCEP.FlowSpeed_+3A_direction">direction</code></td>
<td>
<p> A numeric value indicating the preferred direction of movement in degrees from North.  For this function, <code>direction</code> is required but does not change the calculation of flow-assistance or the direction of movement.  The argument is included for use with <code><a href="#topic+NCEP.flight">NCEP.flight</a></code>. </p>
</td></tr>
<tr><td><code id="NCEP.FlowSpeed_+3A_airspeed">airspeed</code></td>
<td>
<p> The airspeed of the animal in meters per second.  This value does not affect the calculation of flow-assistance, but does affect the forward and sideways movement of the animal. </p>
</td></tr>
<tr><td><code id="NCEP.FlowSpeed_+3A_...">...</code></td>
<td>
<p> Any extra arguments passed to the flow-assistance equation. </p>
</td></tr>  
</table>


<h3>Details</h3>

<p>This function calculates flow-assistance and forward and sideways movement according to equation FlowSpeed.  Equation FlowSpeed assigns the speed of the flow (e.g. wind speed) as flow-assistance, therefore it can never produce negative flow-assistance values.  It assumes that the animal applies its own airspeed in the same direction as the flow (e.g. wind direction).  
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing flow-assistance (&lsquo;fa&rsquo;), the animal's forward speed (&lsquo;forward.move&rsquo; which includes the animal's own airspeed), the animal's sideways speed (&lsquo;side.move&rsquo; which includes the animal's own airspeed), the component of the flow parallel to preferred direction of movement(&lsquo;tailwind&rsquo;), the component of the flow perpendicular to the preferred direction of movement (&lsquo;sidewind&rsquo;), the animal's speed relative to the flow (&lsquo;airspeed&rsquo;), and the animal's speed relative to the fixed Earth (&lsquo;groundspeed&rsquo;) each in meters per second, presuming <code>u</code>, <code>v</code>, and <code>airspeed</code> were given in meters per second.  </p>


<h3>Author(s)</h3>

<p> Michael U. Kemp <a href="mailto:mukemp+RNCEP@gmail.com">mukemp+RNCEP@gmail.com</a> </p>


<h3>References</h3>

 <p><b>To cite package 'RNCEP' in publications use:</b>
</p>
<p>Kemp, M. U., van Loon, E. E., Shamoun-Baranes, J., and Bouten, W. 2011. RNCEP:global weather and climate data at your fingertips. &ndash; Methods in Ecology and Evolution. DOI:10.1111/j.2041-210X.2011.00138.x. 
</p>
<p><b>For more information on flow-assistance and equation FlowSpeed see:</b>
</p>
<p>Kemp, M.U., Shamoun-Baranes, J., van Loon, E. E., and Bouten, W. 2012. Quantifying flow-assistance and implications for movement research. &ndash; Journal of Theoretical Biology. In prep.</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(RNCEP)
## Using NCEP.FlowSpeed to calculate flow-assistance ##
tst &lt;- NCEP.FlowSpeed(u=-2, v=-1, direction=225, airspeed=12)
</code></pre>

<hr>
<h2 id='NCEP.gather'>Queries Weather Data </h2><span id='topic+NCEP.gather'></span><span id='topic+NCEP.gather.gaussian'></span><span id='topic+NCEP.gather.pressure'></span><span id='topic+NCEP.gather.surface'></span><span id='topic+robust.NCEP.gather.gaussian'></span><span id='topic+robust.NCEP.gather.pressure'></span><span id='topic+robust.NCEP.gather.surface'></span>

<h3>Description</h3>

<p>This function queries weather data over the Internet from the NCEP/NCAR Reanalysis<br /> or NCEP/DOE Reanalysis II datasets for the spatial and temporal extents specified in the function call and maintains the spatial and temporal structure of the data in a 3-D array.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCEP.gather(variable, level, months.minmax, years.minmax,
    lat.southnorth, lon.westeast, reanalysis2 = FALSE,
    return.units = TRUE, status.bar=TRUE)

## NCEP.gather is a wrapper function that calls one of the
## following functions based on the value of level.
## Users should avoid using these functions directly.
NCEP.gather.gaussian(variable, months.minmax, years.minmax,
    lat.minmax, lon.minmax, reanalysis2 = FALSE, 
    return.units = TRUE, increments=NULL, pb=NULL)
NCEP.gather.pressure(variable, months.minmax, years.minmax,
    lat.minmax, lon.minmax, pressure, reanalysis2 = FALSE, 
    return.units = TRUE, increments=NULL, pb=NULL)
NCEP.gather.surface(variable, months.minmax, years.minmax, 
    lat.minmax, lon.minmax, reanalysis2 = FALSE, 
    return.units = TRUE, increments=NULL, pb=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCEP.gather_+3A_variable">variable</code></td>
<td>
<p> Character. The name of the weather variable to be obtained.  See &lsquo;Details&rsquo; for possible variable names. </p>
</td></tr>
<tr><td><code id="NCEP.gather_+3A_level">level</code></td>
<td>
<p> A numeric pressure level or one of either &lsquo;gaussian&rsquo; or &lsquo;surface&rsquo;. See &lsquo;Details&rsquo;. </p>
</td></tr>
<tr><td><code id="NCEP.gather_+3A_months.minmax">months.minmax</code></td>
<td>
<p> Numeric.  Specifies the range of months to be obtained from each year. </p>
</td></tr>
<tr><td><code id="NCEP.gather_+3A_years.minmax">years.minmax</code></td>
<td>
<p> Numeric.  Specifies the range of years to be obtained. </p>
</td></tr>
<tr><td><code id="NCEP.gather_+3A_lat.southnorth">lat.southnorth</code></td>
<td>
<p> Numeric. Specifies the range of latitudes to be obtained in the order<br /> <code>c(southernmost, northernmost)</code>. </p>
</td></tr>
<tr><td><code id="NCEP.gather_+3A_lat.minmax">lat.minmax</code></td>
<td>
<p> Same as <code>lat.southnorth</code>. </p>
</td></tr>
<tr><td><code id="NCEP.gather_+3A_lon.westeast">lon.westeast</code></td>
<td>
<p> Numeric. Specifies the range of longitudes to be obtained in the order<br /> <code>c(westernmost, easternmost)</code>. </p>
</td></tr>
<tr><td><code id="NCEP.gather_+3A_lon.minmax">lon.minmax</code></td>
<td>
<p> Same as <code>lat.westeast</code>. </p>
</td></tr>
<tr><td><code id="NCEP.gather_+3A_reanalysis2">reanalysis2</code></td>
<td>
<p> Logical.  Should the data be obtained from the Reanalysis I dataset (default) or from Reanalysis II? </p>
</td></tr>
<tr><td><code id="NCEP.gather_+3A_return.units">return.units</code></td>
<td>
<p> Logical.  Should the units of the variable being obtained be printed after the query finishes? </p>
</td></tr>
<tr><td><code id="NCEP.gather_+3A_pressure">pressure</code></td>
<td>
<p> Numeric.  A pressure level in millibars that is assigned automatically from the value of <code>level</code> when needed. </p>
</td></tr>  
<tr><td><code id="NCEP.gather_+3A_status.bar">status.bar</code></td>
<td>
<p> Logical.  Should a status bar be shown indicating the percentage of completion? </p>
</td></tr>
<tr><td><code id="NCEP.gather_+3A_increments">increments</code></td>
<td>
<p> Numeric.  This value, which is assigned automatically when using <code>NCEP.gather</code>, indicates the number of queries necessary to retrieve all data. </p>
</td></tr>
<tr><td><code id="NCEP.gather_+3A_pb">pb</code></td>
<td>
<p> An object of class &quot;tkProgressBar&quot;, which is assigned automatically when using <code>NCEP.gather</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>NCEP.gather</code> is a wrapper function that applies one of <code>NCEP.gather.gaussian</code>,<br /> <code>NCEP.gather.pressure</code>, or <code>NCEP.gather.surface</code> depending on the value of <code>level</code>.
</p>
<p><code>level</code> must specify one of either &lsquo;gaussian&rsquo; or &lsquo;surface&rsquo; or give a numerical pressure level in millibars.  Numeric pressure levels must be one of 1000, 925, 850, 700, 600, 500, 400, 300, 250, 200, 150, 100, 70, 50, 30, 20, 10
See &lsquo;Variable Naming Conventions&rsquo; below to determine if your variable of interest is stored relative to the surface, a pressure level, or a T62 Gaussian grid.
Note that variables on a T62 Gaussian grid are evenly spaced in longitude but unevenly spaced in latitude while variables from either the surface or a particular pressure level are evenly spaced in both latitude and longitude (2.5 deg. x 2.5 deg.)
</p>
<p>Months and years in <code>months.minmax</code> and <code>years.minmax</code> must be numeric and given in the order <code>c(minimum,maximum)</code>.
</p>
<p>Latitude and longitude ranges should be given in decimal degrees.  If the latitudes or longitudes given do not match a grid point in the NCEP dataset, the function moves to the next grid point such that the specified range is always included.  Latitude should always be given in the order <code>c(southernmost, northernmost)</code> and longitude should always be given in the order <code>c(westernmost, easternmost)</code>.
</p>
<p>Latitudes below the equator are negative.  Longitudes west of the Prime Meridian can be specified using either positive (i.e. 350) or negative (i.e. -10) notation.
</p>
<p>Some variables are not in both the Reanalysis I and II datasets.  If a variable is chosen that is not in the specified dataset, the other dataset will be used... with a warning.
</p>
<p>Very large queries may cause errors due to memory limitations in R.  
See <code><a href="base.html#topic+Memory-limits">Memory-limits</a></code> for more information or <code><a href="utils.html#topic+memory.limit">memory.limit</a></code> to increase available memory.
Alternatively, consider querying subsets of your total desired range.
For instance, subset a very large spatial domain into several smaller regions, perform analyses on each geographical subset independently, and then combine the results.
Functions in the <code><a href="raster.html#topic+raster-package">raster-package</a></code> may be useful for managing subsets in the temporal domain.
</p>
<p>Note that the status bar may be hidden behind an active R window.
</p>
<p><code>variable</code> must be specified using one of the names found in the section &lsquo;Variable Naming Conventions&rsquo; below...
</p>


<h3>Value</h3>

<p>This function returns a three dimensional array of weather data.  The three dimensions are latitude, longitude, and datetime reflected in the dimnames of the array.  Datetimes are always expressed in UTC with the format <code>"%Y_%m_%d_%H"</code>.
</p>
<p>Optionally, the units of the variable being queried are printed upon completion.
</p>


<h3>Variable Naming Conventions</h3>

<p><b>VARIABLES IN REFERENCE TO A PARTICULAR PRESSURE LEVEL</b>
</p>

<table>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;air&rsquo;</b> </td><td style="text-align: left;"> Air Temperature </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;hgt&rsquo;</b> </td><td style="text-align: left;"> Geopotential Height </td><td style="text-align: left;"> m </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;rhum&rsquo;</b> </td><td style="text-align: left;"> Relative Humidity </td><td style="text-align: left;"> % </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;shum&rsquo;</b> </td><td style="text-align: left;"> Specific Humidity </td><td style="text-align: left;"> kg/kg </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;omega&rsquo;</b> </td><td style="text-align: left;"> Omega [Vertical Velocity] </td><td style="text-align: left;"> Pascal/s </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;uwnd&rsquo;</b> </td><td style="text-align: left;"> U-Wind Component [East/West] </td><td style="text-align: left;"> m/s </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;vwnd&rsquo;</b> </td><td style="text-align: left;"> V-Wind Component [North/South] </td><td style="text-align: left;"> m/s
</td>
</tr>

</table>

<p><b>VARIABLES IN REFERENCE TO THE SURFACE</b>
</p>

<table>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;air.sig995&rsquo;</b> </td><td style="text-align: left;"> Air Temperature </td><td style="text-align: left;"> (Near Surface) </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;lftx.sfc&rsquo;</b> </td><td style="text-align: left;"> Surface Lifted Index </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;lftx4.sfc&rsquo;</b> </td><td style="text-align: left;"> Best (4-layer) Lifted Index </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;omega.sig995&rsquo;</b> </td><td style="text-align: left;"> Omega [Vertical Velocity] </td><td style="text-align: left;"> (Near Surface) </td><td style="text-align: left;"> Pascal/s </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;pottmp.sig995&rsquo;</b> </td><td style="text-align: left;"> Potential Temperature </td><td style="text-align: left;"> (Near Surface) </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;pr_wtr.eatm&rsquo;</b> </td><td style="text-align: left;"> Precipitable Water </td><td style="text-align: left;"> (Entire Atmosphere) </td><td style="text-align: left;"> kg/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;pres.sfc&rsquo;</b> </td><td style="text-align: left;"> Pressure </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> Pascals </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;rhum.sig995&rsquo;</b> </td><td style="text-align: left;"> Relative Humidity </td><td style="text-align: left;"> (Near Surface) </td><td style="text-align: left;"> % </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;slp&rsquo;</b> </td><td style="text-align: left;"> Sea Level Pressure </td><td style="text-align: left;"> (Sea Level) </td><td style="text-align: left;"> Pascals </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;mslp&rsquo;</b> </td><td style="text-align: left;"> Mean Sea Level Pressure </td><td style="text-align: left;"> (Sea Level) </td><td style="text-align: left;"> Pascals </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;uwnd.sig995&rsquo;</b> </td><td style="text-align: left;"> U-Wind Component [East/West] </td><td style="text-align: left;"> (Near Surface) </td><td style="text-align: left;"> m/s </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;vwnd.sig995&rsquo;</b> </td><td style="text-align: left;"> V-Wind Component [North/South] </td><td style="text-align: left;"> (Near Surface) </td><td style="text-align: left;"> m/s
</td>
</tr>

</table>

<p><b>VARIABLES IN REFERENCE TO A T62 GAUSSIAN GRID</b>
</p>
<p>&mdash;&ndash; These variables are forecasts valid 6 hours after the reference time &mdash;&ndash;
</p>

<table>
<tr>
 <td style="text-align: left;">
         <b>&lsquo;air.2m&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> Air Temperature  </td><td style="text-align: left;"> </td><td style="text-align: left;"> (At 2 meters) </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
         <b>&lsquo;icec.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> Ice Concentration </td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> fraction </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;pevpr.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">	Potential Evaporation Rate </td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;pres.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">	Pressure  </td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> Pascals </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;runof.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">	Water Runoff						</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> kg/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;sfcr.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">	Surface Roughness					</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> m </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;shum.2m&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">	Specific Humidity					</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At 2 meters) </td><td style="text-align: left;"> kg/kg </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;soilw.0-10cm&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">	Soil Moisture 						</td><td style="text-align: left;"> </td><td style="text-align: left;"> (From 0-10 cm) </td><td style="text-align: left;"> fraction </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;soilw.10-200cm&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> Soil Moisture 						</td><td style="text-align: left;"> </td><td style="text-align: left;"> (From 10-200 cm) </td><td style="text-align: left;"> fraction </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;skt.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">  	Skin Temperature					</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;tmp.0-10cm&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Temperature of 0-10 cm layer		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (From 0-10 cm) </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;tmp.10-200cm&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Temperature of 10-200 cm layer		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (From 10-200 cm) </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;tmp.300cm&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">  	Temperature at 300 cm				</td><td style="text-align: left;"> </td><td style="text-align: left;"> (From 300 cm) </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;uwnd.10m&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">  	U-wind								</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At 10 meters) </td><td style="text-align: left;"> m/s </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;vwnd.10m&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">  	V-wind								</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At 10 meters) </td><td style="text-align: left;"> m/s </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;weasd.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Water equivalent of snow depth		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> kg/m^2
		 </td>
</tr>

</table>

<p>&mdash;&ndash; These variables are 6 hour hindcasts from the reference time &mdash;&ndash;
</p>

<table>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;tmax.2m&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Maximum temperature					</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At 2 meters) </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;tmin.2m&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Minimum temperature					</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At 2 meters) </td><td style="text-align: left;"> deg K
		 </td>
</tr>

</table>

<p>&mdash;&ndash; These variables are 6 hour averages starting at the reference time &mdash;&ndash;
</p>

<table>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;cfnlf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">	Cloud forcing net longwave flux		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;cfnsf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">	Cloud forcing net solar flux		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;cprat.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Convective precipitation rate		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> Kg/m^2/s </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;csdlf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Clear sky downward longwave flux	</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;csdsf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Clear sky downward solar flux		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;dlwrf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Downward longwave radiation flux	</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;dswrf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Downward solar radiation flux		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;dswrf.ntat&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Downward solar radiation flux		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Nominal Top of Atmosphere) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;gflux.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Ground heat flux					</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;lhtfl.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Latent heat net flux				</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;nbdsf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Near IR beam downward solar flux	</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;nddsf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Near IR diffuse downward solar flux	</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;nlwrs.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Net longwave radiation				</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;nswrs.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Net shortwave radiation				</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;prate.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Precipitation rate					</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> Kg/m^2/s </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;shtfl.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Sensible heat net flux				</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;uflx.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Momentum flux (zonal)				</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> N/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;ugwd.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Zonal gravity wave stress			</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> N/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;ulwrf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Upward longwave radiation flux		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;ulwrf.ntat&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Upward longwave radiation flux		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Nominal Top of Atmosphere) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;uswrf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Upward solar radiation flux			</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;uswrf.ntat&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Upward solar radiation flux			</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Nominal Top of Atmosphere) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;vbdsf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">  	Visable beam downward solar flux	</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;vddsf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Visable diffuse downward solar flux	</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;vflx.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Momentum flux (meridional)			</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> N/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;vgwd.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Meridional gravity wave stress		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> N/m^2
		 </td>
</tr>

</table>

<p>&mdash;&ndash; These variables are 6 hour averages starting at the reference time &mdash;&ndash;
</p>

<table>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;csulf.ntat&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Clear Sky Upward Longwave Flux		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Nominal Top of Atmosphere) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;csusf.ntat&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Clear Sky Upward Solar Flux			</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Nominal Top of Atmosphere) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;dswrf.ntat&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Downward Solar Radiation Flux		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Nominal Top of Atmosphere) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;pres.hcb&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Pressure							</td><td style="text-align: left;"> </td><td style="text-align: left;"> (High Cloud Bottom) </td><td style="text-align: left;"> Pascals </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;pres.hct&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Pressure							</td><td style="text-align: left;"> </td><td style="text-align: left;"> (High Cloud Top) </td><td style="text-align: left;"> Pascals </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;pres.lcb&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Pressure							</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Low Cloud Bottom) </td><td style="text-align: left;"> Pascals </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;pres.lct&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Pressure							</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Low Cloud Top) </td><td style="text-align: left;"> Pascals </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;pres.mcb&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Pressure							</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Middle Cloud Bottom) </td><td style="text-align: left;"> Pascals </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;pres.mct&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Pressure							</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Middle Cloud Top) </td><td style="text-align: left;"> Pascals </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;tcdc.eatm&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Total Cloud Cover					</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Entire Atmosphere) </td><td style="text-align: left;"> % </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;ulwrf.ntat&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Upward Longwave Radiation Flux		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Nominal Top of Atmosphere) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;uswrf.ntat&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Upward Solar Radiation Flux			</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Nominal Top of Atmosphere) </td><td style="text-align: left;"> W/m^2
		 </td>
</tr>

</table>



<h3>Author(s)</h3>

<p> Michael U. Kemp <a href="mailto:mukemp+RNCEP@gmail.com">mukemp+RNCEP@gmail.com</a> </p>


<h3>References</h3>

 <p><b>To cite package 'RNCEP' in publications use:</b>
</p>
<p>Kemp, M.U., van Loon, E.E., Shamoun-Baranes, J.,and Bouten, W.
(2011). RNCEP: global weather and climate data at your fingertips.
Methods in Ecology and Evolution, DOI:10.1111/j.2041-210X.2011.00138.x.
</p>
<p><b>To cite the NCEP/NCAR Reanalysis dataset use:</b>
</p>
<p>Kalnay et al. (1996), The NCEP/NCAR 40-year reanalysis project, Bull.
Amer. Meteor. Soc., 77, 437-470
</p>
<p><b>To cite the NCEP/DOE Reanalysis II dataset use:</b>
</p>
<p>Kanamitsu et al. (2002), NCEP-DOE AMIP-II Reanalysis (R-2). Bull.
Amer. Meteor. Soc., 83, 1631-1643
</p>
<p>Please acknowledge the use of NCEP data in any publications by
including text such as, &ldquo;NCEP Reanalysis data provided by the
NOAA/OAR/ESRL PSD, Boulder, Colorado, USA, from their Web site at
<a href="http://www.esrl.noaa.gov/psd/">http://www.esrl.noaa.gov/psd/</a>&rdquo;. They would also appreciate a copy of any publications using NCEP data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(RNCEP)
## Query the temperature from a particular pressure level ##
wx.extent1 &lt;- NCEP.gather(variable='air', level=850,
    months.minmax=c(9,10), years.minmax=c(1996,1997),
    lat.southnorth=c(50,55), lon.westeast=c(5,10),
    reanalysis2 = FALSE, return.units = TRUE)

## Query the temperature at 2 meters altitude with reference to
## the surface
wx.extent2 &lt;- NCEP.gather(variable='air.sig995', level='surface',
    months.minmax=c(2,3), years.minmax=c(2000,2001),
    lat.southnorth=c(50,55), lon.westeast=c(0,5),
    reanalysis2 = FALSE, return.units = TRUE)

## Query the temperature at 2 meters altitude with reference to
## a T62 Gaussian grid
wx.extent3 &lt;- NCEP.gather(variable='air.2m', level='gaussian',
    months.minmax=c(4,5), years.minmax=c(2006,2007),
    lat.southnorth=c(32,35), lon.westeast=c(-35,-32),
    reanalysis2 = FALSE, return.units = TRUE)

## Note that the dimnames of the data array indicate the 
## latitudes, longitudes, and datetimes	of the data. ##
dimnames(wx.extent1)
## Therefore, the latitudes, longitudes, and datetimes
## can be called. ##
dimnames(wx.extent1)[[1]] ## latitudes
dimnames(wx.extent1)[[2]] ## longitudes
dimnames(wx.extent1)[[3]] ## datetimes

#################################################################
#################################################################
#################################################################
## THERE ARE MANY OPTIONS FOR CREATING DIFFERENT R OBJECTS  
## AND/OR FOR EXPORTING THESE WEATHER DATA.
## HERE ARE A FEW EXAMPLES

#########################################################
#########################################################
## The data array may be saved directly as an R object ##
save(wx.extent, file='wx_extent.Rdata')
## And then later recalled ##
load(file='wx_extent.Rdata')


################################################################
################################################################
## Another option is to create a raster object from the array ##
## For more info, see package raster
library(raster)

## Using the data from a query above ##
## First create a stacked raster object using the first 
## layer (i.e. datetime) of the weather data array ##
## Notice the offset of 1.25 degrees (1/2 the spatial resolution)
## to describe the limits of the bounding box not the points
ras &lt;- stack(raster(wx.extent1[,,1], crs="+proj=longlat +datum=WGS84", 
    xmn=min(as.numeric(dimnames(wx.extent1)[[2]])) - 1.25,
    xmx=max(as.numeric(dimnames(wx.extent1)[[2]])) + 1.25, 
    ymn=min(as.numeric(dimnames(wx.extent1)[[1]])) - 1.25,
    ymx=max(as.numeric(dimnames(wx.extent1)[[1]])) + 1.25))

## Then add each subsequent layer to the raster stack ##
for(i in 2:length(dimnames(wx.extent1)[[3]])){
    ras &lt;- addLayer(ras, raster(wx.extent1[,,i], 
        crs="+proj=longlat +datum=WGS84", 
        xmn=min(as.numeric(dimnames(wx.extent1)[[2]])) - 1.25,
        xmx=max(as.numeric(dimnames(wx.extent1)[[2]])) + 1.25, 
        ymn=min(as.numeric(dimnames(wx.extent1)[[1]])) - 1.25,
        ymx=max(as.numeric(dimnames(wx.extent1)[[1]])) + 1.25))
    }

#######################################################
## Optionally, export a layer from the raster stack to 
## a format that can be imported by Esri's ArcGIS products ##

## First, select a layer from the raster stack ##
ras1 &lt;- raster(ras, layer=1)

## Then write the data from that layer to a .bil file ##
writeRaster(ras, filename='ras_example.bil', format="EHdr")
## The file will be saved in your current working directory ##

## The resulting file can be imported into ArcGIS ##
## by using the "Raster to Other Format" tool in the 
## "To Raster" section of the ArcToolbox.

###########################################################
## NOTE: Weather data obtained from a Gaussian grid must 
## first be resampled onto a regular grid !!! ##
## Here we use the interp.loess() function
## from the tgp package

## Using data from a T62 Gaussian grid queried above 
## Interpolate the data from the first layer (i.e. datetime)
## onto a regular grid ##
library(tgp)
wx.reg &lt;- interp.loess(x=rep(as.numeric(dimnames(wx.extent3)[[2]]), 
        each=length(dimnames(wx.extent3)[[1]])),
    y=rep(as.numeric(dimnames(wx.extent3)[[1]]), 
         length(dimnames(wx.extent3)[[2]])), 
    z=as.vector(wx.extent3[,,1]), span=0.6, 
    gridlen=c(length(dimnames(wx.extent3)[[2]]),
        length(dimnames(wx.extent3)[[1]])))

## Create a stacked raster object from the first layer 
## (i.e. datetime) after interpolation ##
## Again, notice the offset (1/2 the resolution) ##
## Also note that the matrix (i.e. wx.reg$z) must be flipped 
## along the y axis and transposed ##
## This is required b/c of the interpolation performed above ##
ras &lt;- stack(raster(t(wx.reg$z[,length(wx.reg$y):1]), 
    crs="+proj=longlat +datum=WGS84", 
    xmn=min(as.numeric(wx.reg$x)) - abs(diff(wx.reg$x)[1]/2),
    xmx=max(as.numeric(wx.reg$x)) + abs(diff(wx.reg$x)[1]/2), 
    ymn=min(as.numeric(wx.reg$y)) - abs(diff(wx.reg$y)[1]/2),
    ymx=max(as.numeric(wx.reg$y)) + abs(diff(wx.reg$y)[1]/2)))
	
## Add each subsequent layer in the array to the raster stack ##
## after interpolating onto a regular grid ##

for(i in 2:length(dimnames(wx.extent3)[[3]])){

  ## Interpolate
  t.wx.reg &lt;- interp.loess(x=rep(as.numeric(dimnames(wx.extent3)[[2]]), 
      each=length(dimnames(wx.extent3)[[1]])), 
      y=rep(as.numeric(dimnames(wx.extent3)[[1]]), 
      length(dimnames(wx.extent3)[[2]])), 
      z=as.vector(wx.extent3[,,i]), span=0.6, 
      gridlen=c(length(dimnames(wx.extent3)[[2]]),
      length(dimnames(wx.extent3)[[1]])))
  
  ## Note the offset ##
  ## Note flipping the matrix along the y axis and transposing ##
  ## Add layer to stack
  ras &lt;- addLayer(ras, raster(t(t.wx.reg$z[,length(t.wx.reg$y):1]),
    crs="+proj=longlat +datum=WGS84",
    xmn=min(as.numeric(t.wx.reg$x)) - abs(diff(t.wx.reg$x)[1]/2),
    xmx=max(as.numeric(t.wx.reg$x)) + abs(diff(t.wx.reg$x)[1]/2), 
    ymn=min(as.numeric(t.wx.reg$y)) - abs(diff(t.wx.reg$y)[1]/2),
    ymx=max(as.numeric(t.wx.reg$y)) + abs(diff(t.wx.reg$y)[1]/2)))
  }

##################################################################
##################################################################
## Another option is to create a Spatial object
## using the sp package
## Again, data from a Gaussian grid may require special attention
## as the grid points are unevenly spaced
library(sp)

## Using the data from a query above
## Convert the array to a data.frame ##
wx.df &lt;- NCEP.array2df(wx.extent2)

## Specify that the data.frame is a spatial object
library(sp)
coordinates(wx.df) &lt;- ~longitude+latitude
gridded(wx.df) &lt;- TRUE
proj4string(wx.df) &lt;- CRS('+proj=longlat + datum=WGS84')

#########################################################
## A Spatial object of a single datetime (i.e. layer) can 
## be written to .asc, a format that may then be 
## imported into ArcGIS.

## First, convert the first layer of the array to a data.frame ##
wx.df &lt;- NCEP.array2df(wx.extent2[,,1])

## Specify that the data.frame is a spatial object
library(sp)
coordinates(wx.df) &lt;- ~longitude+latitude
gridded(wx.df) &lt;- TRUE
proj4string(wx.df) &lt;- CRS('+proj=longlat + datum=WGS84')

## Save the data in .asc format
write.asciigrid(wx.df, fname='wx.asc')
## Note: Data will be written to your working directory ##

## The resulting .asc file can be imported into ArcMap
## using ArcMap's "ASCII to Raster" tool in the "Conversion Tools"
## section of the ArcToolbox. ##

##################################################################
## There are still more options for writing these data to files ##
## See e.g. writeMat() in the R.matlab package for writing Matlab files
## Also see the RSAGA package for GIS functionality in R
## One could even write the data array back to NetCDF 
## (see packages RNetCDF and ncdf)

## End(Not run)
</code></pre>

<hr>
<h2 id='NCEP.Groundspeed'> Calculate flow-assistance according to equation 'Groundspeed' </h2><span id='topic+NCEP.Groundspeed'></span>

<h3>Description</h3>

<p>This function calculates flow-assistance according to equation Groundspeed and determines the speed of forward and sideways movement if an animal behaves according to the rules of equation Groundspeed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCEP.Groundspeed(u, v, direction, groundspeed,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCEP.Groundspeed_+3A_u">u</code></td>
<td>
<p> A numeric value indicating the U (i.e. zonal or east/west) flow component in meters per second, toward east being positive.  Values must describe the direction into which the flow is moving.    </p>
</td></tr>
<tr><td><code id="NCEP.Groundspeed_+3A_v">v</code></td>
<td>
<p> A numeric value indicating the V (i.e. meridional or north/south) flow component in meters per second, toward north being positive.  Values must describe the direction into which the flow is moving. </p>
</td></tr>
<tr><td><code id="NCEP.Groundspeed_+3A_direction">direction</code></td>
<td>
<p> A numeric value indicating the preferred direction of movement in degrees from North. </p>
</td></tr>
<tr><td><code id="NCEP.Groundspeed_+3A_groundspeed">groundspeed</code></td>
<td>
<p> The desired groundspeed (i.e. speed relative to the fixed Earth) of the animal in meters per second. </p>
</td></tr>  
<tr><td><code id="NCEP.Groundspeed_+3A_...">...</code></td>
<td>
<p> Any extra arguments passed to the flow-assistance equation. </p>
</td></tr>  
</table>


<h3>Details</h3>

<p>This function calculates flow-assistance and forward and sideways movement according to equation Groundspeed.  Equation Groundspeed stipulates that an animal maintains the specified <code>groundspeed</code> in the given <code>direction</code> by altering its airspeed and heading.  Note that, as a result of these assumptions, flow-assistance degrades from optimum as the tailwind component increases beyond the specified <code>groundspeed</code> and forward movement remains constant at the speed specified by <code>groundspeed</code>.  
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing flow-assistance (&lsquo;fa&rsquo;), the animal's forward speed (&lsquo;forward.move&rsquo; which includes the animal's own airspeed), the animal's sideways speed (&lsquo;side.move&rsquo; which includes the animal's own airspeed), the component of the flow parallel to preferred direction of movement(&lsquo;tailwind&rsquo;), the component of the flow perpendicular to the preferred direction of movement (&lsquo;sidewind&rsquo;), the animal's speed relative to the flow (&lsquo;airspeed&rsquo;), and the animal's speed relative to the fixed Earth (&lsquo;groundspeed&rsquo;) each in meters per second, presuming <code>u</code>, <code>v</code>, and <code>airspeed</code> were given in meters per second.   </p>


<h3>Author(s)</h3>

<p> Michael U. Kemp <a href="mailto:mukemp+RNCEP@gmail.com">mukemp+RNCEP@gmail.com</a> </p>


<h3>References</h3>

 <p><b>To cite package 'RNCEP' in publications use:</b>
</p>
<p>Kemp, M. U., van Loon, E. E., Shamoun-Baranes, J., and Bouten, W. 2011. RNCEP:global weather and climate data at your fingertips. &ndash; Methods in Ecology and Evolution. DOI:10.1111/j.2041-210X.2011.00138.x. 
</p>
<p><b>For more information on flow-assistance and equation Groundspeed see:</b>
</p>
<p>Kemp, M.U., Shamoun-Baranes, J., van Loon, E. E., and Bouten, W. 2012. Quantifying flow-assistance and implications for movement research. &ndash; Journal of Theoretical Biology. In prep. </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(RNCEP)
## Using NCEP.Groundspeed to calculate flow-assistance ##
tst &lt;- NCEP.Groundspeed(u=-2, v=-1, direction=225, groundspeed=12)
</code></pre>

<hr>
<h2 id='NCEP.interp'> Interpolates Weather Data to a point in space and time </h2><span id='topic+NCEP.interp'></span><span id='topic+NCEP.interp.gaussian'></span><span id='topic+NCEP.interp.pressure'></span><span id='topic+NCEP.interp.surface'></span><span id='topic+robust.NCEP.interp.gaussian'></span><span id='topic+robust.NCEP.interp.pressure'></span><span id='topic+robust.NCEP.interp.surface'></span>

<h3>Description</h3>

<p> This function queries a weather variable via the Internet from the NCEP/NCAR Reanalysis or NCEP/DOE Reanalysis II datasets and subsequently calculates values at desired locations in space and time by interpolation. </p>


<h3>Usage</h3>

<pre><code class='language-R'> NCEP.interp(variable, level, lat, lon, dt, reanalysis2 = FALSE,
    interpolate.space = TRUE, interpolate.time = TRUE,
    keep.unpacking.info = FALSE, return.units = TRUE,
    interp = 'linear', p = 1, status.bar=TRUE) 

## NCEP.interp is a wrapper function that calls one of the
## following functions based on the value of level.
## Users should avoid using these functions directly.

NCEP.interp.gaussian(variable, lat, lon, dt, reanalysis2 = FALSE,
    interpolate.space = TRUE, interpolate.time = TRUE,
    keep.unpacking.info = FALSE, return.units = TRUE,
    interp = 'linear', p = 1, status.bar=TRUE) 
NCEP.interp.pressure(variable, lat, lon, dt, pressure,
    reanalysis2 = FALSE, interpolate.space = TRUE, 
    interpolate.time = TRUE, keep.unpacking.info = FALSE, 
    return.units = TRUE, interp = 'linear', p = 1, status.bar=TRUE) 
NCEP.interp.surface(variable, lat, lon, dt, reanalysis2 = FALSE,
    interpolate.space = TRUE, interpolate.time = TRUE,
    keep.unpacking.info = FALSE, return.units = TRUE,
    interp = 'linear', p = 1, status.bar=TRUE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCEP.interp_+3A_variable">variable</code></td>
<td>
<p> Character. The name of the weather variable to be obtained.  See &lsquo;Variable Naming Conventions&rsquo; below for possible variable names. </p>
</td></tr>
<tr><td><code id="NCEP.interp_+3A_level">level</code></td>
<td>
<p> A numeric pressure level or one of either &lsquo;gaussian&rsquo; or &lsquo;surface&rsquo;. See &lsquo;Details&rsquo;. </p>
</td></tr>
<tr><td><code id="NCEP.interp_+3A_lat">lat</code></td>
<td>
<p> Numeric.  The latitude to which the weather variable should be interpolated. </p>
</td></tr>
<tr><td><code id="NCEP.interp_+3A_lon">lon</code></td>
<td>
<p> Numeric.  The longitude to which the weather variable should be interpolated. </p>
</td></tr>
<tr><td><code id="NCEP.interp_+3A_dt">dt</code></td>
<td>
<p> Character.  The datetime (specified in UTC) to which the weather variable should be interpolated.  Must use the format <code>"%Y-%m-%d %H:%M:%S"</code>. </p>
</td></tr>
<tr><td><code id="NCEP.interp_+3A_reanalysis2">reanalysis2</code></td>
<td>
<p> Logical. Should the data be obtained from the Reanalysis II dataset or from Reanalysis I(default)? </p>
</td></tr>
<tr><td><code id="NCEP.interp_+3A_interpolate.space">interpolate.space</code></td>
<td>
<p> Logical.  Should interpolation be done in space? </p>
</td></tr>
<tr><td><code id="NCEP.interp_+3A_interpolate.time">interpolate.time</code></td>
<td>
<p> Logical.  Should interpolation be done in time? </p>
</td></tr>
<tr><td><code id="NCEP.interp_+3A_keep.unpacking.info">keep.unpacking.info</code></td>
<td>
<p> Logical.  Should the information needed to unpack the data be used for all queries in the function call? </p>
</td></tr>
<tr><td><code id="NCEP.interp_+3A_return.units">return.units</code></td>
<td>
<p> Logical. Should the units of the variable being obtained be printed after the query finishes? </p>
</td></tr>
<tr><td><code id="NCEP.interp_+3A_interp">interp</code></td>
<td>
<p> Method of interpolation.  One of 'linear' (default) or 'IDW'.  See &lsquo;Details&rsquo;.  </p>
</td></tr>
<tr><td><code id="NCEP.interp_+3A_p">p</code></td>
<td>
<p> A positive real number. The power parameter controlling interpolation. Only matters when <code>interp</code> is 'IDW'. See &lsquo;Details&rsquo;.  </p>
</td></tr>
<tr><td><code id="NCEP.interp_+3A_pressure">pressure</code></td>
<td>
<p> Numeric.  A pressure level in millibars that is assigned automatically from the value of <code>level</code> when needed. </p>
</td></tr>    
<tr><td><code id="NCEP.interp_+3A_status.bar">status.bar</code></td>
<td>
<p> Logical.  Should a status bar be shown indicating the percentage of completion? </p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>NCEP.interp</code> is a wrapper function that applies one of <code>NCEP.interp.gaussian</code>,<br /> <code>NCEP.interp.pressure</code>, or <code>NCEP.interp.surface</code> depending
on the value of <code>level</code>.
</p>
<p><code>level</code> must specify one of either &lsquo;gaussian&rsquo; or &lsquo;surface&rsquo; or give a numerical pressure level in millibars.  Numeric pressure levels must be one of 1000, 925, 850, 700, 600, 500, 400, 300, 250, 200, 150, 100, 70, 50, 30, 20, 10.
See &lsquo;Variable Naming Conventions&rsquo; below to determine if your variable of interest is stored relative to the surface, a pressure level, or a T62 Gaussian grid.
Note that variables on a T62 Gaussian grid are evenly spaced in longitude but unevenly spaced in latitude while variables from either the surface or a particular pressure level are evenly spaced in both latitude and longitude (2.5 deg. x 2.5 deg.).
</p>
<p>All arguments except <code>keep.unpacking.info</code>, <code>return.units</code>, and <code>status.bar</code> can be vectors.  The remaining arguments are recycled to the length of the longest arguement.
</p>
<p><code>lat</code> and <code>lon</code> should be given in decimal degrees.  Latitudes south of the equator should be negative.  Longitudes west of the Prime Meridian can be specified using either positive (i.e. 350) or negative (i.e. -10) notation.
</p>
<p>All interpolation is performed assuming a spherical (rather than a planar) grid.
</p>
<p>When <code>interp</code> is 'IDW', 2-D spatial interpolation is done using inverse distance weighting followed by a 1-D linear interpolation in time.
When <code>interp</code> is 'linear', the function performs a trilinear interpolation in latitude, longitude, and time.
If <code>interpolate.space</code> or<br /> <code>interpolate.time</code> is <code>FALSE</code>, the function performs &lsquo;nearest neighbor&rsquo; interpolation and returns data from the grid point closest in space or time, respectively.
The numerical value of <code>p</code> controls the degree of smoothing in the interpolation only when <code>interp</code> is 'IDW'.  Greater values of <code>p</code> assign greater influence to values closest to the interpolated point. For 0 &lt; <code>p</code> &lt; 1 peaks over the interpolated point remain smooth.  As <code>p</code> increases beyond 1, the peaks become sharper.
</p>
<p>Variables in these datasets on a T62 Gaussian grid describe conditions over an interval of time rather than at a particular point in time. (see &lsquo;Variable Naming Conventions&rsquo; below)
As such, it is not appropriate to perform temporal interpolation on these varaibles.
Therefore, <code>NCEP.interp</code> automatically sets <code>interpolate.time</code> to <code>FALSE</code> when querying one of these variables, 
and returns the data corresponding to the interval within which the specified datetime falls.  
Spatial interpolation is still performed as long as <code>interpolate.space</code> is <code>TRUE</code>.
</p>
<p>Unpacking information is unique to each variable and dataset.  Therefore,<br /> <code>keep.unpacking.info</code> can be made <code>TRUE</code> as long as only one variable from one dataset (i.e. Reanalysis I or II) is queried in a single function call, even for multiple times and locations.  <code>keep.unpacking.info</code> will be made <code>FALSE</code>, if necessary, with a warning.
</p>
<p>The function will run faster when <code>keep.unpacking.info</code> is <code>TRUE</code>.
</p>
<p>The robust alternative to <code>NCEP.interp</code> is applied automatically.  These robust functions are applied when interpolation requires data from two different years or from both sides of the Prime Meridian. 
</p>
<p>Some variables are not in both the Reanalysis I and II datasets.  If a variable is chosen that is not in the specified dataset, the other dataset will be used... with a warning.
</p>
<p>The function also returns, as an attribute, standard deviation calculated on all data used in the interpolation.  
This provides an indication of the precision of an interpolated result described in the same units as the interpolated variable.
Smaller values indicate that there is less variability among the points used in interpolation.
Standard deviation is only calcuated on the points used in the interpolation.  Therefore, if <code>interpolate.time</code> and <code>interpolate.space</code> are both <code>TRUE</code>, 
standard deviation is calculated on eight points.<br />
If <code>interpolate.time</code> is <code>FALSE</code> and <code>interpolate.space</code> is <code>TRUE</code>,
standard deviation is calculated on four points. If <code>interpolate.time</code> is <code>TRUE</code> and <code>interpolate.space</code> is <code>FALSE</code>, standard deviation
is calculated on only two points.  If <code>interpolate.time</code> and <code>interpolate.space</code> are both <code>FALSE</code>, standard deviation is not calculated and <code>NA</code> is returned.
This measure of precision is the same irrespective of <code>interp</code>.
</p>
<p>Note that the status bar may be hidden behind an active R window.
</p>
<p><code>variable</code> must be specified using one of the names found in the section &lsquo;Variable Naming Conventions&rsquo; below...
</p>


<h3>Value</h3>

<p>A vector of interpolated results with the associated standard deviation of the points used to perform the interpolation as an attribute.
</p>
<p>Optionally, the units of the variable being queried are printed when the function completes.
</p>


<h3>Variable Naming Conventions</h3>

<p><b>VARIABLES IN REFERENCE TO A PARTICULAR PRESSURE LEVEL</b>
</p>

<table>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;air&rsquo;</b> </td><td style="text-align: left;"> Air Temperature </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;hgt&rsquo;</b> </td><td style="text-align: left;"> Geopotential Height </td><td style="text-align: left;"> m </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;rhum&rsquo;</b> </td><td style="text-align: left;"> Relative Humidity </td><td style="text-align: left;"> % </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;shum&rsquo;</b> </td><td style="text-align: left;"> Specific Humidity </td><td style="text-align: left;"> kg/kg </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;omega&rsquo;</b> </td><td style="text-align: left;"> Omega [Vertical Velocity] </td><td style="text-align: left;"> Pascal/s </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;uwnd&rsquo;</b> </td><td style="text-align: left;"> U-Wind Component [East/West] </td><td style="text-align: left;"> m/s </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;vwnd&rsquo;</b> </td><td style="text-align: left;"> V-Wind Component [North/South] </td><td style="text-align: left;"> m/s
</td>
</tr>

</table>

<p><b>VARIABLES IN REFERENCE TO THE SURFACE</b>
</p>

<table>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;air.sig995&rsquo;</b> </td><td style="text-align: left;"> Air Temperature </td><td style="text-align: left;"> (Near Surface) </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;lftx.sfc&rsquo;</b> </td><td style="text-align: left;"> Surface Lifted Index </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;lftx4.sfc&rsquo;</b> </td><td style="text-align: left;"> Best (4-layer) Lifted Index </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;omega.sig995&rsquo;</b> </td><td style="text-align: left;"> Omega [Vertical Velocity] </td><td style="text-align: left;"> (Near Surface) </td><td style="text-align: left;"> Pascal/s </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;pottmp.sig995&rsquo;</b> </td><td style="text-align: left;"> Potential Temperature </td><td style="text-align: left;"> (Near Surface) </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;pr_wtr.eatm&rsquo;</b> </td><td style="text-align: left;"> Precipitable Water </td><td style="text-align: left;"> (Entire Atmosphere) </td><td style="text-align: left;"> kg/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;pres.sfc&rsquo;</b> </td><td style="text-align: left;"> Pressure </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> Pascals </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;rhum.sig995&rsquo;</b> </td><td style="text-align: left;"> Relative Humidity </td><td style="text-align: left;"> (Near Surface) </td><td style="text-align: left;"> % </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;slp&rsquo;</b> </td><td style="text-align: left;"> Sea Level Pressure </td><td style="text-align: left;"> (Sea Level) </td><td style="text-align: left;"> Pascals </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;mslp&rsquo;</b> </td><td style="text-align: left;"> Mean Sea Level Pressure </td><td style="text-align: left;"> (Sea Level) </td><td style="text-align: left;"> Pascals </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;uwnd.sig995&rsquo;</b> </td><td style="text-align: left;"> U-Wind Component [East/West] </td><td style="text-align: left;"> (Near Surface) </td><td style="text-align: left;"> m/s </td>
</tr>
<tr>
 <td style="text-align: left;">
	<b>&lsquo;vwnd.sig995&rsquo;</b> </td><td style="text-align: left;"> V-Wind Component [North/South] </td><td style="text-align: left;"> (Near Surface) </td><td style="text-align: left;"> m/s
</td>
</tr>

</table>

<p><b>VARIABLES IN REFERENCE TO A T62 GAUSSIAN GRID</b>
</p>
<p>&mdash;&ndash; These variables are forecasts valid 6 hours after the reference time &mdash;&ndash;
</p>

<table>
<tr>
 <td style="text-align: left;">
         <b>&lsquo;air.2m&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> Air Temperature  </td><td style="text-align: left;"> </td><td style="text-align: left;"> (At 2 meters) </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
         <b>&lsquo;icec.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> Ice Concentration </td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> fraction </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;pevpr.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">	Potential Evaporation Rate </td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;pres.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">	Pressure  </td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> Pascals </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;runof.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">	Water Runoff						</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> kg/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;sfcr.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">	Surface Roughness					</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> m </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;shum.2m&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">	Specific Humidity					</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At 2 meters) </td><td style="text-align: left;"> kg/kg </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;soilw.0-10cm&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">	Soil Moisture 						</td><td style="text-align: left;"> </td><td style="text-align: left;"> (From 0-10 cm) </td><td style="text-align: left;"> fraction </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;soilw.10-200cm&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> Soil Moisture 						</td><td style="text-align: left;"> </td><td style="text-align: left;"> (From 10-200 cm) </td><td style="text-align: left;"> fraction </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;skt.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">  	Skin Temperature					</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;tmp.0-10cm&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Temperature of 0-10 cm layer		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (From 0-10 cm) </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;tmp.10-200cm&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Temperature of 10-200 cm layer		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (From 10-200 cm) </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;tmp.300cm&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">  	Temperature at 300 cm				</td><td style="text-align: left;"> </td><td style="text-align: left;"> (From 300 cm) </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;uwnd.10m&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">  	U-wind								</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At 10 meters) </td><td style="text-align: left;"> m/s </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;vwnd.10m&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">  	V-wind								</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At 10 meters) </td><td style="text-align: left;"> m/s </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;weasd.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Water equivalent of snow depth		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> kg/m^2
		 </td>
</tr>

</table>

<p>&mdash;&ndash; These variables are 6 hour hindcasts from the reference time &mdash;&ndash;
</p>

<table>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;tmax.2m&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Maximum temperature					</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At 2 meters) </td><td style="text-align: left;"> deg K </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;tmin.2m&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Minimum temperature					</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At 2 meters) </td><td style="text-align: left;"> deg K
		 </td>
</tr>

</table>

<p>&mdash;&ndash; These variables are 6 hour averages starting at the reference time &mdash;&ndash;
</p>

<table>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;cfnlf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">	Cloud forcing net longwave flux		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;cfnsf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">	Cloud forcing net solar flux		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;cprat.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Convective precipitation rate		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> Kg/m^2/s </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;csdlf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Clear sky downward longwave flux	</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;csdsf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Clear sky downward solar flux		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;dlwrf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Downward longwave radiation flux	</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;dswrf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Downward solar radiation flux		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;dswrf.ntat&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Downward solar radiation flux		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Nominal Top of Atmosphere) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;gflux.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Ground heat flux					</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;lhtfl.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Latent heat net flux				</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;nbdsf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Near IR beam downward solar flux	</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;nddsf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Near IR diffuse downward solar flux	</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;nlwrs.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Net longwave radiation				</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;nswrs.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Net shortwave radiation				</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;prate.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Precipitation rate					</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> Kg/m^2/s </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;shtfl.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Sensible heat net flux				</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;uflx.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Momentum flux (zonal)				</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> N/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;ugwd.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Zonal gravity wave stress			</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> N/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;ulwrf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Upward longwave radiation flux		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;ulwrf.ntat&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Upward longwave radiation flux		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Nominal Top of Atmosphere) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;uswrf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Upward solar radiation flux			</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;uswrf.ntat&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Upward solar radiation flux			</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Nominal Top of Atmosphere) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;vbdsf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;">  	Visable beam downward solar flux	</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;vddsf.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Visable diffuse downward solar flux	</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;vflx.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Momentum flux (meridional)			</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> N/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;vgwd.sfc&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Meridional gravity wave stress		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (At Surface) </td><td style="text-align: left;"> N/m^2
		 </td>
</tr>

</table>

<p>&mdash;&ndash; These variables are 6 hour averages starting at the reference time &mdash;&ndash;
</p>

<table>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;csulf.ntat&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Clear Sky Upward Longwave Flux		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Nominal Top of Atmosphere) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;csusf.ntat&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Clear Sky Upward Solar Flux			</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Nominal Top of Atmosphere) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;dswrf.ntat&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Downward Solar Radiation Flux		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Nominal Top of Atmosphere) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;pres.hcb&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Pressure							</td><td style="text-align: left;"> </td><td style="text-align: left;"> (High Cloud Bottom) </td><td style="text-align: left;"> Pascals </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;pres.hct&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Pressure							</td><td style="text-align: left;"> </td><td style="text-align: left;"> (High Cloud Top) </td><td style="text-align: left;"> Pascals </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;pres.lcb&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Pressure							</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Low Cloud Bottom) </td><td style="text-align: left;"> Pascals </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;pres.lct&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Pressure							</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Low Cloud Top) </td><td style="text-align: left;"> Pascals </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;pres.mcb&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Pressure							</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Middle Cloud Bottom) </td><td style="text-align: left;"> Pascals </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;pres.mct&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Pressure							</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Middle Cloud Top) </td><td style="text-align: left;"> Pascals </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;tcdc.eatm&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Total Cloud Cover					</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Entire Atmosphere) </td><td style="text-align: left;"> % </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;ulwrf.ntat&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Upward Longwave Radiation Flux		</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Nominal Top of Atmosphere) </td><td style="text-align: left;"> W/m^2 </td>
</tr>
<tr>
 <td style="text-align: left;">
		 <b>&lsquo;uswrf.ntat&rsquo;</b> </td><td style="text-align: left;"> </td><td style="text-align: left;"> 	Upward Solar Radiation Flux			</td><td style="text-align: left;"> </td><td style="text-align: left;"> (Nominal Top of Atmosphere) </td><td style="text-align: left;"> W/m^2
		 </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Michael U. Kemp <a href="mailto:mukemp+RNCEP@gmail.com">mukemp+RNCEP@gmail.com</a></p>


<h3>References</h3>

 <p><b>To cite package 'RNCEP' in publications use:</b>
</p>
<p>Kemp, M.U., van Loon, E.E., Shamoun-Baranes, J.,and Bouten, W.
(2011). RNCEP: global weather and climate data at your fingertips.
Methods in Ecology and Evolution, DOI:10.1111/j.2041-210X.2011.00138.x.
</p>
<p><b>To cite the NCEP/NCAR Reanalysis dataset use:</b>
</p>
<p>Kalnay et al. (1996), The NCEP/NCAR 40-year reanalysis project, Bull.
Amer. Meteor. Soc., 77, 437-470
</p>
<p><b>To cite the NCEP/DOE Reanalysis II dataset use:</b>
</p>
<p>Kanamitsu et al. (2002), NCEP-DOE AMIP-II Reanalysis (R-2). Bull.
Amer. Meteor. Soc., 83, 1631-1643
</p>
<p>Please acknowledge the use of NCEP data in any publications by
including text such as, &ldquo;NCEP Reanalysis data provided by the
NOAA/OAR/ESRL PSD, Boulder, Colorado, USA, from their Web site at
<a href="http://www.esrl.noaa.gov/psd/">http://www.esrl.noaa.gov/psd/</a>&rdquo;. They would also appreciate a copy of any publications using NCEP data.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(RNCEP)
###############################################################
###############################################################
## The function can be applied to interpolate a single variable 
## to a single point in space and time ##
## Interpolate temperature from the 850 mb pressure level ##
wx.interp &lt;- NCEP.interp(variable='air', level=850, lat=55.1,
    lon=11.3, dt='2006-10-12 17:23:12',
    interp='linear')

## Interpolate precipitable water (for the entire atmosphere, but
## described in reference to the surface)
wx.interp &lt;- NCEP.interp(variable='pr_wtr.eatm', level='surface',
    lat=55.1, lon=11.3, dt='2006-10-12 17:23:12',
    interp='linear')

## Interpolate specific humidity (at the surface, but in 
## reference to a T62 Gaussian grid) using the IDW interpolation
wx.interp &lt;- NCEP.interp(variable='shum.2m', level='gaussian',
    lat=55.1, lon=11.3, dt='2006-10-12 17:23:12',
    interp='IDW', p=1)

###################################################################
###################################################################	
## The function can also be applied to interpolate several variables,
## locations, datetimes, and/or methods of interpolation in a single
## function call ##
## Interpolate temperature from the 850 and 700 mb pressure levels ## 
## for the same time and location ##
wx.interp &lt;- NCEP.interp(variable='air', level=c(850,700), lat=55.1,
    lon=11.3, dt='2006-10-12 17:23:12',
    interp='linear')

## Interpolate temperature and relative humidity from the 1000 mb 
## pressure level ##
wx.interp &lt;- NCEP.interp(variable=c('air','rhum'), level=1000, 
    lat=55.1, lon=11.3, dt='2006-10-12 17:23:12', interp='linear')

## Interpolate temperature and relative humidity 
## from the 1000 and 700 mb pressure levels, respectively
## for the same datetime ##
wx.interp &lt;- NCEP.interp(variable=c('air','rhum'), 
    level=c(1000,700), lat=55.1, lon=11.3, 
    dt='2006-10-12 17:23:12', interp='linear')

## Interpolate temperature and relative humidity 
## from the 1000 and 700 mb pressure levels, respectively
## for different datetimes ##
wx.interp &lt;- NCEP.interp(variable=c('air','rhum'), level=c(1000,700), lat=55.1,
    lon=11.3, dt=c('2006-10-12 17:23:12', '2006-10-12 18:05:31'),
    interp='linear')
	
## Interpolate geopotential height using 'linear', 'IDW', and 
## 'nearest neighbor' interpolation ##
wx.interp &lt;- NCEP.interp(variable='hgt', level=700, lat=55.1,
    lon=11.3, dt='2006-10-12 17:23:12',
    interp=c('linear','IDW','IDW'), 
    interpolate.space=c(TRUE,TRUE,FALSE))

###############################################################
###############################################################
## Alternatively the function can be applied to interpolate a
## weather variable to multiple datetime and point locations
## in a single function call ##  

## In this example, we use datetime and locational data obtained 
## from a GPS device attached to a lesser black-backed gull.
## We interpolate wind information to to each point in the dataset
data(gull)

## Take a subset of the data based on the datetime of 
## the measurement ##
ss &lt;- subset(gull, format(gull$datetime, "%Y-%m-%d %H:%M:%S") &gt;=
    "2008-09-19 16:00:00" &amp; format(gull$datetime, 
    "%Y-%m-%d %H:%M:%S") &lt;= "2008-09-19 19:30:00")


## Now collect wind information for each point in the subset ##
uwind &lt;- NCEP.interp(variable='uwnd', level=925, 
    lat=ss$latitude, lon=ss$longitude, dt=ss$datetime,
    reanalysis2=TRUE, keep.unpacking.info=TRUE)
vwind &lt;- NCEP.interp(variable='vwnd', level=925, 
    lat=ss$latitude, lon=ss$longitude, dt=ss$datetime, 
    reanalysis2=TRUE, keep.unpacking.info=TRUE)	

	
## Now calculate the tailwind component from the U and V
## wind components assuming that the bird's preferred 
## direction is 225 degrees
tailwind &lt;- (sqrt(uwind^2 + vwind^2)*cos(((atan2(uwind,vwind)*
    (180/pi))-225)*(pi/180)))

## Now visualize the subset of the GPS track using color
## to indicate the tailwind speed ##
NCEP.vis.points(wx=tailwind, lats=ss$latitude, lons=ss$longitude,
    cols=rev(heat.colors(64)),
    title.args=list(main='Lesser black-backed gull'),
    image.plot.args=list(legend.args=list(text='Tailwind m/s',
    adj=0, padj=-2, cex=1.15)),
    map.args=list(xlim=c(-7,4), ylim=c(40,50)))

## End(Not run)
</code></pre>

<hr>
<h2 id='NCEP.loxodrome'> Calculate the loxodrome angle between two points on Earth. </h2><span id='topic+NCEP.loxodrome'></span>

<h3>Description</h3>

<p>This function calculates the loxodrome angle (i.e rhumb line or constant compass heading) between two points on a sphere.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCEP.loxodrome(lat1,lat2,lon1,lon2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCEP.loxodrome_+3A_lat1">lat1</code></td>
<td>
<p> A numeric value giving the starting latitude in decimal degrees. </p>
</td></tr>
<tr><td><code id="NCEP.loxodrome_+3A_lat2">lat2</code></td>
<td>
<p> A numeric value giving the ending latitude in decimal degrees. </p>
</td></tr>
<tr><td><code id="NCEP.loxodrome_+3A_lon1">lon1</code></td>
<td>
<p> A numeric value giving the starting longitude in decimal degrees. </p>
</td></tr>
<tr><td><code id="NCEP.loxodrome_+3A_lon2">lon2</code></td>
<td>
<p> A numeric value giving the ending longitude in decimal degrees. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the loxodrome angle (i.e. rhumb line or constant compass heading) between two points on a sphere.  Output is given in degrees from north.  
</p>


<h3>Value</h3>

<p>A numeric value indicating the loxodrome angle between the two input points in degrees from north. </p>


<h3>Author(s)</h3>

<p> Michael U. Kemp <a href="mailto:mukemp+RNCEP@gmail.com">mukemp+RNCEP@gmail.com</a> </p>


<h3>References</h3>

 <p><a href="http://en.wikipedia.org/wiki/Rhumb_line">http://en.wikipedia.org/wiki/Rhumb_line</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(RNCEP)
## Using NCEP.loxodrome ##
NCEP.loxodrome(lat1=45,lat2=40,lon1=4,lon2=5)
</code></pre>

<hr>
<h2 id='NCEP.M.Groundspeed'> Calculate flow-assistance according to equation 'M.Groundspeed' </h2><span id='topic+NCEP.M.Groundspeed'></span>

<h3>Description</h3>

<p>This function calculates flow-assistance according to equation M.Groundspeed and determines the speed of forward and sideways movement if an animal behaves according to the rules of equation M.Groundspeed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCEP.M.Groundspeed(u, v, direction, p.airspeed,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCEP.M.Groundspeed_+3A_u">u</code></td>
<td>
<p> A numeric value indicating the U (i.e. zonal or east/west) flow component in meters per second, toward east being positive.  Values must describe the direction into which the flow is moving.    </p>
</td></tr>
<tr><td><code id="NCEP.M.Groundspeed_+3A_v">v</code></td>
<td>
<p> A numeric value indicating the V (i.e. meridional or north/south) flow component in meters per second, toward north being positive.  Values must describe the direction into which the flow is moving. </p>
</td></tr>
<tr><td><code id="NCEP.M.Groundspeed_+3A_direction">direction</code></td>
<td>
<p> A numeric value indicating the preferred direction of movement in degrees from North. </p>
</td></tr>
<tr><td><code id="NCEP.M.Groundspeed_+3A_p.airspeed">p.airspeed</code></td>
<td>
<p> A numeric value indicating the animal's <b>preferred</b> speed relative to the flow (i.e. airspeed) in meters per second. See Details.</p>
</td></tr>
<tr><td><code id="NCEP.M.Groundspeed_+3A_...">...</code></td>
<td>
<p> Any extra arguments passed to the flow-assistance equation. </p>
</td></tr>  
</table>


<h3>Details</h3>

<p>This function calculates flow-assistance and forward and sideways movement according to equation M.Groundspeed.  Equation M.Groundspeed stipulates that an animal maintains a speed relative to the fixed Earth (i.e. groundspeed) in the specified <code>direction</code> equal to its preferred airspeed (i.e. <code>p.airspeed</code>) plus the component of the flow parallel to the preferred <code>direction</code> by altering its actual airspeed and heading.  Note that, the actual airspeed that a animal must exhibit, following these assumptions, can be very different from its preferred airspeed. 
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing flow-assistance (&lsquo;fa&rsquo;), the animal's forward speed (&lsquo;forward.move&rsquo; which includes the animal's own airspeed), the animal's sideways speed (&lsquo;side.move&rsquo; which includes the animal's own airspeed), the component of the flow parallel to preferred direction of movement(&lsquo;tailwind&rsquo;), the component of the flow perpendicular to the preferred direction of movement (&lsquo;sidewind&rsquo;), the animal's speed relative to the flow (&lsquo;airspeed&rsquo;), and the animal's speed relative to the fixed Earth (&lsquo;groundspeed&rsquo;) each in meters per second, presuming <code>u</code>, <code>v</code>, and <code>airspeed</code> were given in meters per second. </p>


<h3>Author(s)</h3>

<p> Michael U. Kemp <a href="mailto:mukemp+RNCEP@gmail.com">mukemp+RNCEP@gmail.com</a> </p>


<h3>References</h3>

 <p><b>To cite package 'RNCEP' in publications use:</b>
</p>
<p>Kemp, M. U., van Loon, E. E., Shamoun-Baranes, J., and Bouten, W. 2011. RNCEP:global weather and climate data at your fingertips. &ndash; Methods in Ecology and Evolution. DOI:10.1111/j.2041-210X.2011.00138.x. 
</p>
<p><b>For more information on flow-assistance and equation M.Groundspeed see:</b>
</p>
<p>Kemp, M.U., Shamoun-Baranes, J., van Loon, E. E., and Bouten, W. 2012. Quantifying flow-assistance and implications for movement research. &ndash; Journal of Theoretical Biology. In prep. </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(RNCEP)
## Using NCEP.M.Groundspeed to calculate flow-assistance ##
tst &lt;- NCEP.M.Groundspeed(u=-2, v=-1, direction=225, p.airspeed=12)
</code></pre>

<hr>
<h2 id='NCEP.NegFlowSpeed'> Calculate flow-assistance according to equation 'NegFlowSpeed' </h2><span id='topic+NCEP.NegFlowSpeed'></span>

<h3>Description</h3>

<p>This function calculates flow-assistance according to equation NegFlowSpeed and determines the speed of forward and sideways movement if an animal behaves according to the rules of equation NegFlowSpeed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCEP.NegFlowSpeed(u, v, direction, airspeed,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCEP.NegFlowSpeed_+3A_u">u</code></td>
<td>
<p> A numeric value indicating the U (i.e. zonal or east/west) flow component in meters per second, toward east being positive.  Values must describe the direction into which the flow is moving.    </p>
</td></tr>
<tr><td><code id="NCEP.NegFlowSpeed_+3A_v">v</code></td>
<td>
<p> A numeric value indicating the V (i.e. meridional or north/south) flow component in meters per second, toward north being positive.  Values must describe the direction into which the flow is moving. </p>
</td></tr>
<tr><td><code id="NCEP.NegFlowSpeed_+3A_direction">direction</code></td>
<td>
<p> A numeric value indicating the preferred direction of movement in degrees from North.  For this function, <code>direction</code> is required but does not change the calculation of flow-assistance or the direction of movement.  The argument is included for use with <code><a href="#topic+NCEP.flight">NCEP.flight</a></code>. </p>
</td></tr>
<tr><td><code id="NCEP.NegFlowSpeed_+3A_airspeed">airspeed</code></td>
<td>
<p> The animal's speed relative to the flow in meters per second.  This value does not affect the calculation of flow-assistance, but does affect the forward and sideways movement of the animal. </p>
</td></tr>
<tr><td><code id="NCEP.NegFlowSpeed_+3A_...">...</code></td>
<td>
<p> Any extra arguments passed to the flow-assistance equation. </p>
</td></tr>  
</table>


<h3>Details</h3>

<p>This function calculates flow-assistance and forward and sideways movement according to equation NegFlowSpeed.  Equation NegFlowSpeed considers one minus the speed of the flow (e.g. wind speed) as flow-assistance, therefore it can never produce positive flow-assistance values.  It assumes that the animal applies its own airspeed in the opposite direction of the flow (e.g. wind direction).  
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing flow-assistance (&lsquo;fa&rsquo;), the animal's forward speed (&lsquo;forward.move&rsquo; which includes the animal's own airspeed), the animal's sideways speed (&lsquo;side.move&rsquo; which includes the animal's own airspeed), the component of the flow parallel to preferred direction of movement(&lsquo;tailwind&rsquo;), the component of the flow perpendicular to the preferred direction of movement (&lsquo;sidewind&rsquo;), the animal's speed relative to the flow (&lsquo;airspeed&rsquo;), and the animal's speed relative to the fixed Earth (&lsquo;groundspeed&rsquo;) each in meters per second, presuming <code>u</code>, <code>v</code>, and <code>airspeed</code> were given in meters per second. </p>


<h3>Author(s)</h3>

<p> Michael U. Kemp <a href="mailto:mukemp+RNCEP@gmail.com">mukemp+RNCEP@gmail.com</a> </p>


<h3>References</h3>

 <p><b>To cite package 'RNCEP' in publications use:</b>
</p>
<p>Kemp, M. U., van Loon, E. E., Shamoun-Baranes, J., and Bouten, W. 2011. RNCEP:global weather and climate data at your fingertips. &ndash; Methods in Ecology and Evolution. DOI:10.1111/j.2041-210X.2011.00138.x. 
</p>
<p><b>For more information on flow-assistance and equation NegFlowSpeed see:</b>
</p>
<p>Kemp, M.U., Shamoun-Baranes, J., van Loon, E. E., and Bouten, W. 2012. Quantifying flow-assistance and implications for movement research. &ndash; Journal of Theoretical Biology. In prep.  </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(RNCEP)
## Using NCEP.NegFlowSpeed to calculate flow-assistance ##
tst &lt;- NCEP.NegFlowSpeed(u=-2, v=-1, direction=225, airspeed=12)
</code></pre>

<hr>
<h2 id='NCEP.PartialSpeed'> Calculate flow-assistance according to equation 'PartialSpeed' </h2><span id='topic+NCEP.PartialSpeed'></span>

<h3>Description</h3>

<p>This function calculates flow-assistance according to equation PartialSpeed and determines the speed of forward and sideways movement if an animal behaves according to the rules of equation PartialSpeed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCEP.PartialSpeed(u, v, direction, airspeed, f=0.5,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCEP.PartialSpeed_+3A_u">u</code></td>
<td>
<p> A numeric value indicating the U (i.e. zonal or east/west) flow component in meters per second, toward east being positive.  Values must describe the direction into which the flow is moving.    </p>
</td></tr>
<tr><td><code id="NCEP.PartialSpeed_+3A_v">v</code></td>
<td>
<p> A numeric value indicating the V (i.e. meridional or north/south) flow component in meters per second, toward north being positive.  Values must describe the direction into which the flow is moving. </p>
</td></tr>
<tr><td><code id="NCEP.PartialSpeed_+3A_direction">direction</code></td>
<td>
<p> A numeric value indicating the preferred direction of movement in degrees from North. </p>
</td></tr>
<tr><td><code id="NCEP.PartialSpeed_+3A_airspeed">airspeed</code></td>
<td>
<p> The animal's speed relative to the flow in meters per second. </p>
</td></tr>  
<tr><td><code id="NCEP.PartialSpeed_+3A_f">f</code></td>
<td>
<p> A numeric value between zero and one describing the proportion of the lateral component of the flow for which the animal will compensate. </p>
</td></tr>  
<tr><td><code id="NCEP.PartialSpeed_+3A_...">...</code></td>
<td>
<p> Any extra arguments passed to the flow-assistance equation. </p>
</td></tr>  
</table>


<h3>Details</h3>

<p>This function calculates flow-assistance and forward and sideways movement according to equation PartialSpeed.  Equation PartialSpeed stipulates that the animal compensates for a proportion (specified by <code>f</code>) of the flow lateral to the preferred <code>direction</code> by altering its heading and speed relative to the fixed Earth (i.e. groundspeed).  If, with its given <code>airspeed</code>, the animal is incapable of compensating for the specified proportion of the lateral component of the flow, the equation produces no real solution.
</p>
<p>Setting <code>f</code> to zero specifies no compensation (cf. <code>link{NCEP.Tailwind}</code>), while setting <code>f</code> to one specifies complete compensation (cf. <code>link{NCEP.Airspeed}</code>. 
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing flow-assistance (&lsquo;fa&rsquo;), the animal's forward speed (&lsquo;forward.move&rsquo; which includes the animal's own airspeed), the animal's sideways speed (&lsquo;side.move&rsquo; which includes the animal's own airspeed), the component of the flow parallel to preferred direction of movement(&lsquo;tailwind&rsquo;), the component of the flow perpendicular to the preferred direction of movement (&lsquo;sidewind&rsquo;), the animal's speed relative to the flow (&lsquo;airspeed&rsquo;), and the animal's speed relative to the fixed Earth (&lsquo;groundspeed&rsquo;) each in meters per second, presuming <code>u</code>, <code>v</code>, and <code>airspeed</code> were given in meters per second. </p>


<h3>Author(s)</h3>

<p> Michael U. Kemp <a href="mailto:mukemp+RNCEP@gmail.com">mukemp+RNCEP@gmail.com</a> </p>


<h3>References</h3>

 <p><b>To cite package 'RNCEP' in publications use:</b>
</p>
<p>Kemp, M. U., van Loon, E. E., Shamoun-Baranes, J., and Bouten, W. 2011. RNCEP:global weather and climate data at your fingertips. &ndash; Methods in Ecology and Evolution. DOI:10.1111/j.2041-210X.2011.00138.x. 
</p>
<p><b>For more information on flow-assistance and equation PartialSpeed see:</b>
</p>
<p>Kemp, M.U., Shamoun-Baranes, J., van Loon, E. E., and Bouten, W. 2012. Quantifying flow-assistance and implications for movement research. &ndash; Journal of Theoretical Biology. In prep. </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(RNCEP)
## Using NCEP.PartialSpeed to calculate flow-assistance ##
tst &lt;- NCEP.PartialSpeed(u=-2, v=-1, direction=225, airspeed=12)
</code></pre>

<hr>
<h2 id='NCEP.restrict'> Temporally Filters Weather Data </h2><span id='topic+NCEP.restrict'></span>

<h3>Description</h3>

<p>This function removes unwanted datetime intervals (i.e. layers) of weather data from the NCEP/NCAR Reanalysis or NCEP/DOE Reanalysis II data array as returned by <code><a href="#topic+NCEP.gather">NCEP.gather</a></code>.  The spatial structure of the data is retained.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCEP.restrict(wx.data, years2remove = NULL, months2remove = NULL,
    days2remove = NULL, hours2remove = NULL, other2remove = NULL,
    set2na = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCEP.restrict_+3A_wx.data">wx.data</code></td>
<td>
<p> A 3-D weather dataset as returned by <code><a href="#topic+NCEP.gather">NCEP.gather</a></code> </p>
</td></tr>
<tr><td><code id="NCEP.restrict_+3A_years2remove">years2remove</code></td>
<td>
<p> Numeric.  Specifies which years should be removed from the dataset. </p>
</td></tr>
<tr><td><code id="NCEP.restrict_+3A_months2remove">months2remove</code></td>
<td>
<p> Numeric.  Specifies which months should be removed from the dataset. </p>
</td></tr>
<tr><td><code id="NCEP.restrict_+3A_days2remove">days2remove</code></td>
<td>
<p> Numeric.  Specifies which days of the month should be removed from the dataset. </p>
</td></tr>
<tr><td><code id="NCEP.restrict_+3A_hours2remove">hours2remove</code></td>
<td>
<p> Numeric.  Specifies which hours of the day should be removed from the dataset. </p>
</td></tr>
<tr><td><code id="NCEP.restrict_+3A_other2remove">other2remove</code></td>
<td>
<p> Character.  Specifies any specific combinations of year, month, day, and hour to remove from the dataset. </p>
</td></tr>
<tr><td><code id="NCEP.restrict_+3A_set2na">set2na</code></td>
<td>
<p> Logical.  Should the data matching the year, month, day, or hour specified in the function call be set to <code>NA</code> (default) or should they be removed completely from the dataset. </p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>other2remove</code> is for specific combinations of year, month, day, and hour and must be given in the format <code>"%Y-%m-%d %H"</code>.  
If <code><a href="#topic+NCEP.aggregate">NCEP.aggregate</a></code> has been applied, some datetime components will need to be replaced with <code>"XX"</code> or <code>"XXXX"</code> when specifying <code>other2remove</code>.  
Use <code><a href="base.html#topic+dimnames">dimnames</a></code> to determine how to specify an aggregated datetime.
</p>
<p>If <code>set2na</code> is anything other than <code>TRUE</code> or <code>FALSE</code>, the function replaces items to be removed with the value of <code>set2na</code>.
</p>


<h3>Value</h3>

<p>This function returns a three dimensional array (or a 2-D matrix if all but a single timestep is removed) of weather data.  The three dimensions are latitude, longitude, and datetime reflected in the dimnames of the output array.
</p>


<h3>Author(s)</h3>

<p> Michael U. Kemp <a href="mailto:mukemp+RNCEP@gmail.com">mukemp+RNCEP@gmail.com</a></p>


<h3>References</h3>

<p> Kemp, M. U., van Loon, E. E., Shamoun-Baranes, J., and Bouten, W. 2011. RNCEP:global weather and climate data at your fingertips. &ndash; Methods in Ecology and Evolution. DOI:10.1111/j.2041-210X.2011.00138.x. </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(RNCEP)
## First query the U component of the wind from the 850mb
## pressure level
uwnd &lt;- NCEP.gather(variable='uwnd', level=850,
    months.minmax=c(5,7), years.minmax=c(2000,2001),
    lat.southnorth=c(50,55), lon.westeast=c(0,5))

## Then remove all observations except those made at midnight from
## the first half of either May or July
uwnd.r &lt;- NCEP.restrict(wx.data=uwnd, hours2remove=c(6,12,18),
    days2remove=seq(17,31), months2remove=6, set2na=FALSE)

## Then remove the observation from 1 May 2000 at midnight ##
uwnd.r2 &lt;- NCEP.restrict(wx.data=uwnd.r,
    other2remove="2000-05-01 00", set2na=FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='NCEP.Tailwind'> Calculate flow-assistance according to equation 'Tailwind' </h2><span id='topic+NCEP.Tailwind'></span>

<h3>Description</h3>

<p>This function calculates flow-assistance according to equation Tailwind and determines the speed of forward and sideways movement if an animal behaves according to the rules of equation Tailwind.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCEP.Tailwind(u, v, direction, airspeed=NA,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCEP.Tailwind_+3A_u">u</code></td>
<td>
<p> A numeric value indicating the U (i.e. zonal or east/west) flow component in meters per second, toward east being positive.  Values must describe the direction into which the flow is moving.    </p>
</td></tr>
<tr><td><code id="NCEP.Tailwind_+3A_v">v</code></td>
<td>
<p> A numeric value indicating the V (i.e. meridional or north/south) flow component in meters per second, toward north being positive.  Values must describe the direction into which the flow is moving. </p>
</td></tr>
<tr><td><code id="NCEP.Tailwind_+3A_direction">direction</code></td>
<td>
<p> A numeric value indicating the preferred direction of movement in degrees from North. </p>
</td></tr>
<tr><td><code id="NCEP.Tailwind_+3A_airspeed">airspeed</code></td>
<td>
<p> The animal's speed relative to the flow in meters per second.  This value does not affect the calculation of flow-assistance, but does affect the animal's forward and sideways movement. </p>
</td></tr>
<tr><td><code id="NCEP.Tailwind_+3A_...">...</code></td>
<td>
<p> Any extra arguments passed to the flow-assistance equation. </p>
</td></tr>  
</table>


<h3>Details</h3>

<p>This function calculates flow-assistance and forward and sideways movement according to equation Tailwind.  Equation Tailwind considers flow-assistance to be the component of the flow moving parallel to the specified <code>direction</code>, with negative values indicating flows against the specified <code>direction</code>.  
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing flow-assistance (&lsquo;fa&rsquo;), the animal's forward speed (&lsquo;forward.move&rsquo; which includes the animal's own airspeed), the animal's sideways speed (&lsquo;side.move&rsquo; which includes the animal's own airspeed), the component of the flow parallel to preferred direction of movement(&lsquo;tailwind&rsquo;), the component of the flow perpendicular to the preferred direction of movement (&lsquo;sidewind&rsquo;), the animal's speed relative to the flow (&lsquo;airspeed&rsquo;), and the animal's speed relative to the fixed Earth (&lsquo;groundspeed&rsquo;) each in meters per second, presuming <code>u</code>, <code>v</code>, and <code>airspeed</code> were given in meters per second. </p>


<h3>Author(s)</h3>

<p> Michael U. Kemp <a href="mailto:mukemp+RNCEP@gmail.com">mukemp+RNCEP@gmail.com</a> </p>


<h3>References</h3>

 <p><b>To cite package 'RNCEP' in publications use:</b>
</p>
<p>Kemp, M. U., van Loon, E. E., Shamoun-Baranes, J., and Bouten, W. 2011. RNCEP:global weather and climate data at your fingertips. &ndash; Methods in Ecology and Evolution. DOI:10.1111/j.2041-210X.2011.00138.x. 
</p>
<p><b>For more information on flow-assistance and equation Tailwind see:</b>
</p>
<p>Kemp, M.U., Shamoun-Baranes, J., van Loon, E. E., and Bouten, W. 2012. Quantifying flow-assistance and implications for movement research. &ndash; Journal of Theoretical Biology. In prep. </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(RNCEP)
## Using NCEP.Tailwind to calculate flow-assistance ##
tst &lt;- NCEP.Tailwind(u=-2, v=-1, direction=225, airspeed=12)
</code></pre>

<hr>
<h2 id='NCEP.track2kml'> Plot a track in Google Earth </h2><span id='topic+NCEP.track2kml'></span>

<h3>Description</h3>

<p>This function creates a .kml file from a time series of point locations (e.g. as returned by <code><a href="#topic+NCEP.flight">NCEP.flight</a></code> or measured with a GPS device) that can be viewed as a track in Google Earth.</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCEP.track2kml(latitude, longitude, datetime, altitude=NULL, 
  col.variable=NULL, col.scheme=NULL, point.alpha=255, 
  line.color='goldenrod', line.alpha=255, size.variable=NULL,
  point.names=NULL, data.variables=NULL, output.filename='track',
  descriptive.filename=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCEP.track2kml_+3A_latitude">latitude</code></td>
<td>
<p> A numeric vector of latitudes in decimal degrees </p>
</td></tr>
<tr><td><code id="NCEP.track2kml_+3A_longitude">longitude</code></td>
<td>
<p> A numeric vector of longitudes in decimal degrees </p>
</td></tr>
<tr><td><code id="NCEP.track2kml_+3A_datetime">datetime</code></td>
<td>
<p> A character vector of datetime increments in the format &quot;%Y-%M-%D %H:%M:%S&quot;. </p>
</td></tr>
<tr><td><code id="NCEP.track2kml_+3A_altitude">altitude</code></td>
<td>
<p> An optional vector of altitudes in meters. </p>
</td></tr>
<tr><td><code id="NCEP.track2kml_+3A_col.variable">col.variable</code></td>
<td>
<p> An optional numeric vector upon which the color of each point should be based </p>
</td></tr>
<tr><td><code id="NCEP.track2kml_+3A_col.scheme">col.scheme</code></td>
<td>
<p> A character description of the color scheme to use in coloring the points.  Several options, see Details. </p>
</td></tr>
<tr><td><code id="NCEP.track2kml_+3A_point.alpha">point.alpha</code></td>
<td>
<p> A numeric vector of length one indicating the transparency of all points on a scale from 0 (transparent) to 255 (opaque) </p>
</td></tr>
<tr><td><code id="NCEP.track2kml_+3A_line.color">line.color</code></td>
<td>
<p> An character expression (any of <code><a href="grDevices.html#topic+colors">colors</a></code> or hexadecimal notation), or numeric indicating the color of the line connecting the point locations.</p>
</td></tr>
<tr><td><code id="NCEP.track2kml_+3A_line.alpha">line.alpha</code></td>
<td>
<p> A numeric vector of length one indicating the transparency of the line connecting the point locations on a scale from 0 (transparent) to 255 (opaque) </p>
</td></tr>  
<tr><td><code id="NCEP.track2kml_+3A_size.variable">size.variable</code></td>
<td>
<p> An optional numeric vector upon which the size of the points should be based </p>
</td></tr>
<tr><td><code id="NCEP.track2kml_+3A_point.names">point.names</code></td>
<td>
<p> An optional character vector of containing names for each point </p>
</td></tr>
<tr><td><code id="NCEP.track2kml_+3A_data.variables">data.variables</code></td>
<td>
<p> An optional data.frame containing any descriptor information for each point.  See Details.  </p>
</td></tr>
<tr><td><code id="NCEP.track2kml_+3A_output.filename">output.filename</code></td>
<td>
<p> A character expression giving the name of the resulting output file. This should not include the .kml extension. </p>
</td></tr>
<tr><td><code id="NCEP.track2kml_+3A_descriptive.filename">descriptive.filename</code></td>
<td>
<p> The name of the object in the .kml file.  Defaults to <code>output.filename</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are several options for specifying <code>col.scheme</code>.  A single color may be specified for all points (using e.g. <code>'red'</code>, <code>2</code>, or <code>"#FF0000"</code>), specific colors may be given for each point (e.g. <code>c('red','blue','green', etc.)</code> or codec('#FF0000','#0000FF','#00FF00', etc.)), or the function can automatically assign colors, according to the values in <code>clo.variable</code>, if <code>col.scheme</code> is any color palette in <code><a href="RColorBrewer.html#topic+display.brewer.all">display.brewer.all</a></code> or one of the recognizezd R color palettes (i.e. <code>'rainbow'</code>, <code>'heat.colors'</code>, <code>'terrain.colors'</code>, <code>'topo.colors'</code>, <code>'cm.colors'</code>, or <code>'bpy.colors'</code>).  An alpha value (0-255) may be supplied to <code>point.alpha</code> to adjust transparencies.
</p>
<p>In the output .kml file, each point along the track contains a table of values.  By default, this table contains the latitude, longitude, and datetime. Variables contained in the <code>data.frame</code> described in <code>data.variables</code> will also be included in this table.  
</p>
<p>The altitude associated with each point, i.e. those passed to the <code>altitude</code> argument, should be supplied in meters.  For an example of how to assign general altitudes from pressure levels, see the Examples below.
</p>
<p>Depending on <code>col.scheme</code>, this function may require <span class="pkg">RColorBrewer</span> or <span class="pkg">sp</span>. 
</p>


<h3>Value</h3>

<p>This function returns no data.  It creates a .kml file in the current working directory.
</p>


<h3>Author(s)</h3>

<p> Michael U. Kemp &lt;<a href="mailto:mukemp+RNCEP@gmail.com">mukemp+RNCEP@gmail.com</a>&gt; </p>


<h3>References</h3>

 <p><b>To cite package 'RNCEP' in publications use:</b>
</p>
<p>Kemp, M. U., van Loon, E. E., Shamoun-Baranes, J., and Bouten, W. 2011. RNCEP:global weather and climate data at your fingertips. &ndash; Methods in Ecology and Evolution. DOI:10.1111/j.2041-210X.2011.00138.x. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+NCEP.flight">NCEP.flight</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Load the gull dataset ##
data(gull)

## Create a subset of the full dataset ##
g &lt;- gull[1:100,]

## Create a .kml file from a portion of the GPS track ##
NCEP.track2kml(latitude=g$latitude, longitude=g$longitude,
    datetime=as.character(g$datetime), altitude=g$altitude, 
    col.variable=g$altitude, col.scheme='heat.colors',
    point.alpha=255, line.color='goldenrod', line.alpha=255,
	size.variable=NULL, point.names=NULL, 
    data.variables=data.frame(g$altitude),
	output.filename='track', descriptive.filename=NULL)

## End(Not run)
</code></pre>

<hr>
<h2 id='NCEP.uv.revert'> Reverts speed and direction to U and V components. </h2><span id='topic+NCEP.uv.revert'></span>

<h3>Description</h3>

<p>This function calculates U (i.e. zonal or east/west) and V (i.e. meridional or north/south) components from a specified speed and direction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCEP.uv.revert(spd, dir, radians=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCEP.uv.revert_+3A_spd">spd</code></td>
<td>
<p> A numeric value indicating speed. </p>
</td></tr>
<tr><td><code id="NCEP.uv.revert_+3A_dir">dir</code></td>
<td>
<p> A numeric value indicating direction in degrees from north or radians if <code>radians</code> is TRUE. </p>
</td></tr>
<tr><td><code id="NCEP.uv.revert_+3A_radians">radians</code></td>
<td>
<p> A logical indicating whether <code>dir</code> is given in degrees from north (FALSE) or radians (TRUE). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates U (i.e. zonal or east/west) and V (i.e. meridional or north/south) components from a specified speed and direction.  U and V components describe the direction into which movement occurs with east and north being positive, respectively.  If directions are given in radians, <code>radians</code> must be set to <code>TRUE</code>.  
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing U and V components given in the same units as <code>speed</code>. </p>


<h3>Author(s)</h3>

<p> Michael U. Kemp <a href="mailto:mukemp+RNCEP@gmail.com">mukemp+RNCEP@gmail.com</a> </p>


<h3>References</h3>

 <p><b>To cite package 'RNCEP' in publications use:</b>
</p>
<p>Kemp, M. U., van Loon, E. E., Shamoun-Baranes, J., and Bouten, W. 2011. RNCEP:global weather and climate data at your fingertips. &ndash; Methods in Ecology and Evolution. DOI:10.1111/j.2041-210X.2011.00138.x. </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(RNCEP)
## Using NCEP.uv.revert ##
NCEP.uv.revert(spd=12, dir=225, radians=FALSE)
</code></pre>

<hr>
<h2 id='NCEP.vis.area'> Visualize Weather Data on a Map </h2><span id='topic+NCEP.vis.area'></span>

<h3>Description</h3>

<p> This function creates a filled contour map from weather data.  It visualizes data from a single layer (i.e. timestep) of a data array as returned by <code><a href="#topic+NCEP.gather">NCEP.gather</a></code> or a single aggregated layer as returned by <code><a href="#topic+NCEP.aggregate">NCEP.aggregate</a></code> </p>


<h3>Usage</h3>

<pre><code class='language-R'>NCEP.vis.area(wx.data, layer=1, show.pts=TRUE, draw.contours=TRUE,
    cols=heat.colors(64), transparency=.5, axis.args=NULL, map.args=NULL,
    grid.args=NULL, title.args=NULL, interp.loess.args=NULL, 
    image.plot.args=NULL, contour.args=NULL, points.args=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCEP.vis.area_+3A_wx.data">wx.data</code></td>
<td>
<p> A 3-D array of weather data as returned by <code><a href="#topic+NCEP.gather">NCEP.gather</a></code> or <code><a href="#topic+NCEP.aggregate">NCEP.aggregate</a></code> </p>
</td></tr>
<tr><td><code id="NCEP.vis.area_+3A_layer">layer</code></td>
<td>
<p> Either a numerical indication of the layer (default is the first layer) or a character expression of the datetime of a particular layer. </p>
</td></tr>
<tr><td><code id="NCEP.vis.area_+3A_show.pts">show.pts</code></td>
<td>
<p> Logical.  Should the points at which data were obtained be plotted? </p>
</td></tr>
<tr><td><code id="NCEP.vis.area_+3A_draw.contours">draw.contours</code></td>
<td>
<p> Logical.  Should the map include contour lines? </p>
</td></tr>
<tr><td><code id="NCEP.vis.area_+3A_cols">cols</code></td>
<td>
<p> A vector of colors such as that generated by <code><a href="grDevices.html#topic+rainbow">rainbow</a></code>, <code><a href="grDevices.html#topic+heat.colors">heat.colors</a></code>, <code><a href="grDevices.html#topic+topo.colors">topo.colors</a></code>, <code><a href="grDevices.html#topic+terrain.colors">terrain.colors</a></code>, or similar functions indicating the colors of the filled contours on the map. </p>
</td></tr>  
<tr><td><code id="NCEP.vis.area_+3A_transparency">transparency</code></td>
<td>
<p> A numeric value between 0 and 1 indicating the transparency of the filled contours on the map.</p>
</td></tr>
<tr><td><code id="NCEP.vis.area_+3A_axis.args">axis.args</code></td>
<td>
<p> A list of arguments controlling the drawing of axes. See <code><a href="graphics.html#topic+axis">axis</a></code> for acceptable arguments and the examples below for a demonstration. </p>
</td></tr>
<tr><td><code id="NCEP.vis.area_+3A_map.args">map.args</code></td>
<td>
<p> A list of arguments controlling the drawing of the map. See <code><a href="maps.html#topic+map">map</a></code> for acceptable arguments and the examples below for a demonstration. </p>
</td></tr>
<tr><td><code id="NCEP.vis.area_+3A_grid.args">grid.args</code></td>
<td>
<p> A list of arguments controlling the drawing of the lat/long grid lines. See <code><a href="graphics.html#topic+abline">abline</a></code> for acceptable arguments and the examples below for a demonstration. </p>
</td></tr>
<tr><td><code id="NCEP.vis.area_+3A_title.args">title.args</code></td>
<td>
<p> A list of arguments controlling the how titles and axis lables are written. See <code><a href="graphics.html#topic+title">title</a></code> for acceptable arguments and the examples below for a demonstration. </p>
</td></tr>
<tr><td><code id="NCEP.vis.area_+3A_interp.loess.args">interp.loess.args</code></td>
<td>
<p> A list of arguments controlling the interpolation between grid points. See <code><a href="tgp.html#topic+interp.loess">interp.loess</a></code> for acceptable arguments and the examples below for a demonstration. </p>
</td></tr>
<tr><td><code id="NCEP.vis.area_+3A_image.plot.args">image.plot.args</code></td>
<td>
<p> A list of arguments controlling the plotting of the filled contour surface, the color-bar legend, and the legend axis and labels. See <code><a href="fields.html#topic+image.plot">image.plot</a></code> for acceptable arguments and the examples below for a demonstration. </p>
</td></tr>
<tr><td><code id="NCEP.vis.area_+3A_contour.args">contour.args</code></td>
<td>
<p> A list of arguments controlling the drawing of contour lines. See <code><a href="graphics.html#topic+contour">contour</a></code> for acceptable arguments and the examples below for a demonstration. </p>
</td></tr>
<tr><td><code id="NCEP.vis.area_+3A_points.args">points.args</code></td>
<td>
<p> A list of arguments controlling the plotting of grid points. See <code><a href="graphics.html#topic+points">points</a></code> for acceptable arguments and the examples below for a demonstration. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the specification of <code>layer</code> is not numeric, it must specify a layer by a character expression of its datetime using the format <code>"%Y-%m-%d %H"</code>.
Leading zeros in the month, day, and hour components must be given (e.g. <code>"2006-01-01 06"</code>) 
</p>
<p>If the data array has been aggregated in some way, the datetime dimension may no longer contain information on one or more temporal component: year, month, day, or hour. 
In this case, replace missing datetime componets with <code>"XX"</code> or <code>"XXXX"</code> (e.g. <code>"XXXX-01-XX XX"</code>) when specifying a layer by a character expression of its datetime. 
Use <code><a href="base.html#topic+dimnames">dimnames</a></code> to see the datetime dimension labels. 
</p>
<p>If the geographical area to be plotted contains no landmass, the plot will exhibit a small unfilled border.
</p>
<p>Most of the components of a plot produced by this function can be controlled by supplying a list of arguments to the embedded function that produces the particular component of the plot.
For example, the text and size of the plot's title can be controlled by specifying a list of acceptable arguments to <code>title.args</code>.
Similarly, the axes, map, and grid lines are controlled by specifying a list of acceptable arguements to <code>axis.args</code>, <code>map.args</code>, and <code>grid.args</code>, respectively.
Through the argument <code>image.plot.args</code> the user can control the plotting of the filled contour surface, the color-bar legend, and the color-bar's title and axis labels.
A list of arguments passed to <code>interp.loess.args</code> controls the interpolation of the filled-contour surface.
See the examples below for a demonstration of how to apply these different arguments.
</p>


<h3>Value</h3>

<p> A plot is produced.  No data are returned. </p>


<h3>Author(s)</h3>

<p> Michael U. Kemp <a href="mailto:mukemp+RNCEP@gmail.com">mukemp+RNCEP@gmail.com</a> </p>


<h3>References</h3>

 <p><b>To cite package 'RNCEP' in publications use:</b>
</p>
<p>Kemp, M. U., van Loon, E. E., Shamoun-Baranes, J., and Bouten, W. 2011. RNCEP:global weather and climate data at your fingertips. &ndash; Methods in Ecology and Evolution. DOI:10.1111/j.2041-210X.2011.00138.x. </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(RNCEP)
## Retrieve data for a specified spatial and temporal extent ##
wx.extent &lt;- NCEP.gather(variable = "air", level=850,
    months.minmax = 11, years.minmax = 2000,
    lat.southnorth = c(50, 60), lon.westeast = c(0, 10),
    reanalysis2 = FALSE, return.units = TRUE)

## Visualize the first layer (i.e. first timestep) of the
## variable on a map
## Note how to specify the plot's title
## Note also the adjustment of the Kernal span argument for 
## 		interpolation using interp.loess.args
NCEP.vis.area(wx.data=wx.extent, layer=1, show.pts=TRUE, draw.contours=TRUE,
    cols=heat.colors(64), transparency=.6, title.args=list(main="Example"),
    interp.loess.args=list(span=.75))

## Now visualize a particular layer by specifying its datetime ##
NCEP.vis.area(wx.data=wx.extent, layer='2000-11-01 18', show.pts=TRUE,
    draw.contours=TRUE, cols=terrain.colors(64), transparency=.6,
    title.args=list(main="Example: select layer by datetime"),
    interp.loess.args=list(span=0.5))
	
## Now produce the same graph as above ##
## This time, label the color-bar legend ##
NCEP.vis.area(wx.data=wx.extent, layer='2000-11-01 18', show.pts=TRUE,
    draw.contours=TRUE, cols=terrain.colors(64), transparency=.6,
    title.args=list(main="Example: select layer by datetime"),
    interp.loess.args=list(span=0.5), 
    image.plot.args=list(legend.args=list(text='Kelvin', cex=1.15, padj=-1, adj=-.25)))

## Now produce the same graph as above ##
## This time, explicitly specify the size and location 
## of the color-bar legend using the smallplot argument 
## in the list of image.plot.args ##
NCEP.vis.area(wx.data=wx.extent, layer='2000-11-01 18', show.pts=TRUE,
    draw.contours=TRUE, cols=terrain.colors(64), transparency=.6,
    title.args=list(main="Example: select layer by datetime"),
    interp.loess.args=list(span=0.5), 
    image.plot.args=list(legend.args=list(text='Kelvin', cex=1.15, padj=-1, adj=-.25),
        smallplot=c(0.8475, 0.875, 0.20, 0.8)))

###########################################################
## This function can also show a layer after aggregation ##
###########################################################
## Calculate the average hourly temperature from the data
## obtained above ##
wx.ag &lt;- NCEP.aggregate(wx.data=wx.extent, YEARS=FALSE, MONTHS=FALSE,
    HOURS=TRUE, DAYS=FALSE, fxn='mean')

## Now plot the mean temperature at midnight ##
## Note the adjustment of axis labels
## Note also the adjustment of the point type
NCEP.vis.area(wx=wx.ag, layer=1, interp.loess.args=list(span=0.5),
    title.args=list(main='Example: aggregated layer', xlab='Long [degrees]',
    ylab='Lat [degrees]'), points.args=list(pch=19))

## Now produce the same plot as above ##
## This time, change the font size used in the
## contour labels ##
NCEP.vis.area(wx=wx.ag, layer=1, interp.loess.args=list(span=0.5),
    title.args=list(main='Example: aggregated layer', xlab='Long [degrees]',
    ylab='Lat [degrees]'), points.args=list(pch=19),
    contour.args=list(labcex=.6))
	
## Notice how you can plot an aggregated layer by specifying
## it explicitly ##
NCEP.vis.area(wx=wx.ag, layer="XXXX-XX-XX 18", interp.loess.args=list(span=0.5),
    title.args=list(main='Example: aggregated layer', xlab='Long [degrees]',
    ylab='Lat [degrees]'), points.args=list(pch=19),
    contour.args=list(labcex=.6))

## End(Not run)
</code></pre>

<hr>
<h2 id='NCEP.vis.points'> Visualize Weather Data Interpolated to a Point on a Map </h2><span id='topic+NCEP.vis.points'></span>

<h3>Description</h3>

<p> This function creates a map with points.  The color of the points indicates the value of some variable at that point.  These values can e.g. be obtained by applying the function <code><a href="#topic+NCEP.interp">NCEP.interp</a></code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'>NCEP.vis.points(wx, lats, lons, cols=heat.colors(64),
    transparency=.5, connect=TRUE, axis.args=NULL, 
    points.args=NULL, map.args=NULL, grid.args=NULL, 
    title.args=NULL, image.plot.args=NULL, lines.args=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCEP.vis.points_+3A_wx">wx</code></td>
<td>
<p> A vector of weather data as returned by <code><a href="#topic+NCEP.interp">NCEP.interp</a></code> </p>
</td></tr>
<tr><td><code id="NCEP.vis.points_+3A_lats">lats</code></td>
<td>
<p> A vector of latitudes in decimal degrees indicating the locations of the points </p>
</td></tr>
<tr><td><code id="NCEP.vis.points_+3A_lons">lons</code></td>
<td>
<p> A vector of longitudes in decimal degrees indicating the locations of the points </p>
</td></tr>
<tr><td><code id="NCEP.vis.points_+3A_cols">cols</code></td>
<td>
<p> A vector of colors such as that generated by <code><a href="grDevices.html#topic+rainbow">rainbow</a></code>, <code><a href="grDevices.html#topic+heat.colors">heat.colors</a></code>, <code><a href="grDevices.html#topic+topo.colors">topo.colors</a></code>, <code><a href="grDevices.html#topic+terrain.colors">terrain.colors</a></code>, or similar functions </p>
</td></tr>  
<tr><td><code id="NCEP.vis.points_+3A_transparency">transparency</code></td>
<td>
<p> A numeric value between 0 and 1 indicating the transparency of the filled points on the map.</p>
</td></tr>
<tr><td><code id="NCEP.vis.points_+3A_connect">connect</code></td>
<td>
<p> Logical.  Should a line be drawn connecting the points?</p>
</td></tr>
<tr><td><code id="NCEP.vis.points_+3A_axis.args">axis.args</code></td>
<td>
<p> A list of arguments controlling the drawing of axes. See <code><a href="graphics.html#topic+axis">axis</a></code> for acceptable arguments and the examples below for a demonstration. </p>
</td></tr>
<tr><td><code id="NCEP.vis.points_+3A_points.args">points.args</code></td>
<td>
<p>A list of arguments controlling the drawing of points. See <code><a href="graphics.html#topic+points">points</a></code> for acceptable arguments and the examples below for a demonstration. </p>
</td></tr>  
<tr><td><code id="NCEP.vis.points_+3A_map.args">map.args</code></td>
<td>
<p> A list of arguments controlling the drawing of the map. See <code><a href="maps.html#topic+map">map</a></code> for acceptable arguments and the examples below for a demonstration.</p>
</td></tr>
<tr><td><code id="NCEP.vis.points_+3A_grid.args">grid.args</code></td>
<td>
<p> A list of arguments controlling the drawing of the lat/long grid lines. See <code><a href="graphics.html#topic+abline">abline</a></code> for acceptable arguments and the examples below for a demonstration. </p>
</td></tr>
<tr><td><code id="NCEP.vis.points_+3A_title.args">title.args</code></td>
<td>
<p> A list of arguments controlling the how titles and axis lables are written. See <code><a href="graphics.html#topic+title">title</a></code> for acceptable arguments and the examples below for a demonstration. </p>
</td></tr>
<tr><td><code id="NCEP.vis.points_+3A_image.plot.args">image.plot.args</code></td>
<td>
<p> A list of arguments controlling the plotting of the color-bar legend and the legend axis and labels. See <code><a href="fields.html#topic+image.plot">image.plot</a></code> for acceptable arguments and the examples below for a demonstration. </p>
</td></tr>
<tr><td><code id="NCEP.vis.points_+3A_lines.args">lines.args</code></td>
<td>
<p> A list of arguments controlling the drawing of the line connecting the points. See <code><a href="graphics.html#topic+lines">lines</a></code> for acceptable arguments and the examples below for a demonstration. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Most of the components of a plot produced by this function can be controlled by supplying a list of arguments to the embedded function that produces the particular component of the plot.
For example, the text and size of the plot's title can be controlled by specifying a list of acceptable arguments to <code>title.args</code>.
Similarly, the axes, map, and grid lines are controlled by specifying a list of acceptable arguements to <code>axis.args</code>, <code>map.args</code>, and <code>grid.args</code>, respectively.
Through the argument <code>image.plot.args</code> the user can control the plotting of the color-bar legend and the color-bar's title and axis labels.
See the examples below for a demonstration of how to apply these different arguments.
</p>


<h3>Value</h3>

<p> A plot is produced.  No data are returned. </p>


<h3>Author(s)</h3>

<p> Michael U. Kemp <a href="mailto:mukemp+RNCEP@gmail.com">mukemp+RNCEP@gmail.com</a> </p>


<h3>References</h3>

 <p><b>To cite package 'RNCEP' in publications use:</b>
</p>
<p>Kemp, M. U., van Loon, E. E., Shamoun-Baranes, J., and Bouten, W. 2011. RNCEP:global weather and climate data at your fingertips. &ndash; Methods in Ecology and Evolution. DOI:10.1111/j.2041-210X.2011.00138.x. </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(RNCEP)
## In this example, we use datetime and locational data
## obtained from a GPS device attached to a lesser 
## black-backed gull. 
data(gull, package='RNCEP')

## First, visualize the entire track representing altitude
## with the point colors ##
## Note the specification of the title
## Also, note the specification of the legend label
## and adjustment of its placement
NCEP.vis.points(wx=gull$altitude, lats=gull$latitude, 
    lons=gull$longitude, cols=topo.colors(64),
    title.args=list(main='Lesser black-backed gull'),
    image.plot.args=list(legend.args=list(text='Altitude',
    adj=-1, cex=1.25)))

## Take a subset of the data based on the datetime of 
## the measurement ##
ss &lt;- subset(gull, format(gull$datetime, "%Y-%m-%d %H:%M:%S") &gt;=
    "2008-09-19 16:00:00" &amp; format(gull$datetime, 
    "%Y-%m-%d %H:%M:%S") &lt;= "2008-09-19 19:30:00")


## Now collect cloud cover, temperature, and wind
## information for each point in the subset ##
cloud &lt;- NCEP.interp(variable='tcdc.eatm', level='gaussian', 
    lat=ss$latitude, lon=ss$longitude, dt=ss$datetime, 
    reanalysis2=TRUE, keep.unpacking.info=TRUE)
temp &lt;- NCEP.interp(variable='air.sig995', level='surface', 
    lat=ss$latitude, lon=ss$longitude, dt=ss$datetime,
    reanalysis2=FALSE, keep.unpacking.info=TRUE)
uwind &lt;- NCEP.interp(variable='uwnd', level=925, 
    lat=ss$latitude, lon=ss$longitude, dt=ss$datetime,
    reanalysis2=TRUE, keep.unpacking.info=TRUE)
vwind &lt;- NCEP.interp(variable='vwnd', level=925, 
    lat=ss$latitude, lon=ss$longitude, dt=ss$datetime, 
    reanalysis2=TRUE, keep.unpacking.info=TRUE)	

## Now visualize the subset of the GPS track using color
## to indicate the cloud cover ##
## Note the adjustment to the color of the basemap
## And the setting of the map range ##
## And the explicit placement of the colorbar legend
## using the smallplot argument
NCEP.vis.points(wx=cloud, lats=ss$latitude, lons=ss$longitude,
    cols=rev(heat.colors(64)),
    map.args=list(col='darkgreen',xlim=c(-7,4), ylim=c(40,50)),
    title.args=list(main='Lesser black-backed gull'),
    image.plot.args=list(legend.args=list(text='Cloud Cover %',
        adj=-.1, padj=-.5, cex=1),
    smallplot=c(.83,.86,.15,.85)))

## Now visualize the subset of the GPS track using color
## to indicate the temperature ##
## Note the adjustment of point size
NCEP.vis.points(wx=temp, lats=ss$latitude, lons=ss$longitude,
    cols=rev(heat.colors(64)),
    points.args=list(cex=1.25),
    title.args=list(main='Lesser black-backed gull'),
    image.plot.args=list(legend.args=list(text='Kelvin',
        adj=-.4, padj=-.5, cex=1.15)),
    map.args=list(xlim=c(-7,4), ylim=c(40,50)))

## Now calculate the tailwind component from the U and V
## wind components assuming that the bird's preferred 
## direction is 225 degrees
tailwind &lt;- (sqrt(uwind^2 + vwind^2)*cos(((atan2(uwind,vwind)*
    (180/pi))-225)*(pi/180)))

## Now visualize the subset of the GPS track using color
## to indicate the tailwind speed ##
## Note the adjustment of grid and axis properties
NCEP.vis.points(wx=tailwind, lats=ss$latitude, lons=ss$longitude,
    cols=rev(heat.colors(64)),
    axis.args=list(las=2), grid.args=list(lty=1),
    title.args=list(main='Lesser black-backed gull'),
    image.plot.args=list(legend.args=list(text='Tailwind m/s',
        adj=0, padj=-2, cex=1.15)),
    map.args=list(xlim=c(-7,4), ylim=c(40,50)))

## End(Not run)
</code></pre>

<hr>
<h2 id='RNCEP-package'>
This package of functions retrieves, organizes, and visualizes weather data from either the NCEP/NCAR Reanalysis or NCEP/DOE Reanalysis II datasets
</h2><span id='topic+RNCEP-package'></span><span id='topic+RNCEP'></span>

<h3>Description</h3>

<p>This package contains functions to...
</p>

<ol>
<li><p> Query data from these two NCEP datasets for a specified range of space and time, maintaining both the spatial and temporal structure of the data
</p>
</li>
<li><p> Remove any unwanted time intervals of the returned data
</p>
</li>
<li><p> Temporally aggregate the data and apply any function to the subsets (i.e. calculate user-defined climatic variables)
</p>
</li>
<li><p> Create a contour map from the data
</p>
</li>
<li><p> Query data from these two NCEP datasets interpolated to a particular point in time and space
</p>
</li>
<li><p> Visualize these interpolated data as points on a map using color to represent the interpolated value
</p>
</li>
<li><p> Perform trajectory simulations according to specified behavior using wind data from NCEP or data specified by the user.
</p>
</li></ol>



<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> RNCEP</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.10</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020-05-26</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2) </td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p> Michael U. Kemp <a href="mailto:mukemp+RNCEP@gmail.com">mukemp+RNCEP@gmail.com</a> </p>


<h3>References</h3>

 <p><b>To cite package 'RNCEP' in publications use:</b>
</p>
<p>Kemp, M. U., Emiel van Loon, E., Shamoun-Baranes, J., Bouten, W., 2012. RNCEP: global weather and climate data at your fingertips. Methods in Ecology and Evolution (3), 65-70., DOI: 10.1111/j.2041-210X.2011.00138.x
</p>
<p><b>For more information on flow-assistance and NCEP.flight see:</b>
</p>
<p>Kemp, M.U., Shamoun-Baranes, J., van Loon, E. E., McLaren, J. D., Dokter, A. M., and Bouten, W. 2012. Quantifying flow-assistance and implications for movement research. Journal of Theoretical Biology. (308), 56-67. DOI 10.1016/j.jtbi.2012.05.026
</p>
<p><b>To cite the NCEP/NCAR Reanalysis dataset use:</b>
</p>
<p>Kalnay et al. (1996), The NCEP/NCAR 40-year reanalysis project, Bull. Amer. Meteor. Soc., 77, 437-470
</p>
<p><b>To cite the NCEP/DOE Reanalysis II dataset use:</b>
</p>
<p>Kanamitsu et al. (2002), NCEP-DOE AMIP-II Reanalysis (R-2). Bull. Amer. Meteor. Soc., 83, 1631-1643
</p>
<p>Please acknowledge the use of NCEP data in any publications by including text such as, &ldquo;NCEP Reanalysis data provided by the NOAA/OAR/ESRL PSD, Boulder, Colorado, USA, from their Web site at <a href="http://www.esrl.noaa.gov/psd/">http://www.esrl.noaa.gov/psd/</a>&rdquo;. They would also appreciate a copy of any publications using NCEP data. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(RNCEP)
## Retrieve the temperature from a particular pressure level for
## a specified spatial and temporal extent
wx.extent &lt;- NCEP.gather(variable='air', level=850,
    months.minmax=c(8,9), years.minmax=c(2000,2001),
    lat.southnorth=c(50,55), lon.westeast=c(0,5),
    reanalysis2 = FALSE, return.units = TRUE)

## Retrive the temperature from a particular pressure level
## interpolated in space and time
wx.interp &lt;- NCEP.interp(variable='air', level=850, lat=55.1,
    lon=11.3, dt='2006-10-12 17:23:12')

## Simulate a flight trajectory using NCEP wind data
flight &lt;- NCEP.flight(beg.loc=c(58.00,7.00), 
  end.loc=c(53.00,7.00), begin.dt='2007-10-01 18:00:00',
  flow.assist='NCEP.Tailwind', fa.args=list(airspeed=12),
  path='loxodrome', calibrate.dir=FALSE, calibrate.alt=FALSE,
  cutoff=0, when2stop='latitude', levels2consider=c(850,925),
  hours=12, evaluation.interval=60, id=1, land.if.bad=FALSE,
  reanalysis2 = FALSE, query=TRUE)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
