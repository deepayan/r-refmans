<!DOCTYPE html><html lang="en"><head><title>Help for package Rchoice</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Rchoice}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Articles'>
<p>Doctoral Publications</p></a></li>
<li><a href='#Attitudes'>
<p>Attituded toward working mothers</p></a></li>
<li><a href='#bread.Rchoice'><p>Bread for sandwiches</p></a></li>
<li><a href='#effect'><p>Get average marginal effects for heterokedastic binary models and IV probit models</p></a></li>
<li><a href='#effect.hetprob'><p>Get average marginal effects for heterokedastic binary models</p></a></li>
<li><a href='#effect.ivpml'><p>Get average marginal effects for IV Probit model.</p></a></li>
<li><a href='#effect.Rchoice'><p>Get the conditional individual coefficients</p></a></li>
<li><a href='#estfun.Rchoice'><p>Gradient for observations</p></a></li>
<li><a href='#getSummary.effect.hetprob'><p>Get Model Summaries for use with &quot;mtable&quot; for objects of class effect.hetprob</p></a></li>
<li><a href='#getSummary.effect.ivpml'><p>Get Model Summaries for use with &quot;mtable&quot; for objects of class effect.ivpml</p></a></li>
<li><a href='#getSummary.hetprob'><p>Get Model Summaries for use with &quot;mtable&quot; for objects of class hetprob</p></a></li>
<li><a href='#getSummary.ivpml'><p>Get Model Summaries for use with &quot;mtable&quot; for objects of class ivpml</p></a></li>
<li><a href='#getSummary.Rchoice'><p>Get Model Summaries for use with &quot;mtable&quot; for object of class Rchoice</p></a></li>
<li><a href='#Health'>
<p>German Health Care Data</p></a></li>
<li><a href='#hetprob'><p>Estimate heteroskedastic binary (Probit or Logit) model.</p></a></li>
<li><a href='#ivpml'><p>Estimate Instrumental Variable Probit model by Maximum Likelihood.</p></a></li>
<li><a href='#plot.Rchoice'><p>Plot the distribution of conditional expectation for random parameters.</p></a></li>
<li><a href='#Rchoice'><p>Estimate discrete choice model with random parameters</p></a></li>
<li><a href='#rFormula'><p>Model formula for Rchoice models</p></a></li>
<li><a href='#vcov.Rchoice'><p>vcov method for Rchoice objects</p></a></li>
<li><a href='#Workmroz'>
<p>Labor Force Participation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Discrete Choice (Binary, Poisson and Ordered) Models with Random
Parameters</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3-6</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-03-10</td>
</tr>
<tr>
<td>Description:</td>
<td>An implementation of simulated maximum likelihood method for the estimation of Binary (Probit and Logit), Ordered (Probit and Logit) and Poisson models with random parameters for cross-sectional and longitudinal data as presented in Sarrias (2016) &lt;<a href="https://doi.org/10.18637%2Fjss.v074.i10">doi:10.18637/jss.v074.i10</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0), Formula, maxLik</td>
</tr>
<tr>
<td>Imports:</td>
<td>sandwich, miscTools, numDeriv, memisc, msm, plm, plotrix,
stats, graphics</td>
</tr>
<tr>
<td>Suggests:</td>
<td>car, lmtest, pglm, AER</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mauricio1986/Rchoice">https://github.com/mauricio1986/Rchoice</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mauricio1986/Rchoice/issues">https://github.com/mauricio1986/Rchoice/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>no</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-10 11:44:56 UTC; mauriciosarrias</td>
</tr>
<tr>
<td>Author:</td>
<td>Mauricio Sarrias <a href="https://orcid.org/0000-0001-5932-4817"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Yves Croissant [ctb],
  Achim Zeileis [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mauricio Sarrias &lt;msarrias86@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-10 12:30:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='Articles'>
Doctoral Publications
</h2><span id='topic+Articles'></span>

<h3>Description</h3>

<p>Data from research by Long(1990) that analizes the scientist's level of publications.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Articles)</code></pre>


<h3>Format</h3>

<p>A data frame with 915 observations on the following 6 variables:
</p>

<dl>
<dt><code>art</code></dt><dd><p>Articles during last 3 years of Ph.D.,</p>
</dd>
<dt><code>fem</code></dt><dd><p>1 if female scientist; else 0,</p>
</dd>
<dt><code>mar</code></dt><dd><p>1 if married; else 0,</p>
</dd>
<dt><code>kid5</code></dt><dd><p>Number of children 5 or younger,</p>
</dd>
<dt><code>phd</code></dt><dd><p>Prestige of Ph.D. department,</p>
</dd>
<dt><code>ment</code></dt><dd><p>Articles by mentor during last 3 years,</p>
</dd>
</dl>



<h3>Source</h3>


<ul>
<li><p> Long, J. S. (1990). The origins of sex differences in science. Social Forces, 68(4), 1297-1316.
</p>
</li>
<li><p> Long, J. S. (1997). Regression models for categorical and limited dependent variables (Vol. 7). Sage.
</p>
</li>
<li><p> Long, J. S., &amp; Freese, J. (2006). Regression models for categorical and limited dependent variables using Stata. Stata Press, College Station, TX.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(Articles)
</code></pre>

<hr>
<h2 id='Attitudes'>
Attituded toward working mothers
</h2><span id='topic+Attitudes'></span>

<h3>Description</h3>

<p>In 1997 and 1989, the General Social Survey asked respondents to
evaluate the following statement: &quot;A working mother can establish
just as warm and secure a relationship with her children
as a mother who does not work&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Attitudes)</code></pre>


<h3>Format</h3>

<p>A data frame with 2293 observations on the following 10 variables:
</p>

<dl>
<dt><code>warm</code></dt><dd><p>1 = Strongly disagree, 2 = disagree, 3 = agree, 4 = strongly agree,</p>
</dd>
<dt><code>yr89</code></dt><dd><p>survey year: 1 =  1989; 0 = 1977,</p>
</dd>
<dt><code>male</code></dt><dd><p>1 = male; 0 = female,</p>
</dd>
<dt><code>white</code></dt><dd><p>1 = white; 0 = nonwhite,</p>
</dd>
<dt><code>age</code></dt><dd><p>age in years,</p>
</dd>
<dt><code>ed</code></dt><dd><p>years of education,</p>
</dd>
<dt><code>prst</code></dt><dd><p>occupational prestige,</p>
</dd>
</dl>



<h3>Source</h3>


<ul>
<li><p> Clogg, C. C., &amp; Shihadeh, E. S. (1994). Statistical models for ordinal variables. Thousand Oaks, CA: Sage Publications.
</p>
</li>
<li><p> Long, J. S. (1997). Regression models for categorical and limited dependent variables (Vol. 7). Sage.
</p>
</li>
<li><p> Long, J. S., &amp; Freese, J. (2006). Regression models for categorical and limited dependent variables using Stata. Stata Press, College Station, TX.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(Attitudes)
</code></pre>

<hr>
<h2 id='bread.Rchoice'>Bread for sandwiches</h2><span id='topic+bread.Rchoice'></span>

<h3>Description</h3>

<p>Computes the &ldquo;bread&rdquo; of the sandwich covariance matrix for a model of class <code>Rchoice</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Rchoice'
bread(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bread.Rchoice_+3A_x">x</code></td>
<td>
<p>a fitted model of class <code>Rchoice</code>,</p>
</td></tr>
<tr><td><code id="bread.Rchoice_+3A_...">...</code></td>
<td>
<p>Other arguments when <code>bread</code> is applied to another class object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more information see <code><a href="sandwich.html#topic+bread">bread</a></code> from the package <span class="pkg">sandwich</span>.
</p>


<h3>Value</h3>

<p>the covariance matrix times observations
</p>


<h3>References</h3>

<p>Zeileis A (2006), Object-oriented Computation of Sandwich 
Estimators. Journal of Statistical Software, 16(9), 1&ndash;16.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Probit model
data("Workmroz")
probit &lt;- Rchoice(lfp ~ k5 + k618 + age + wc + hc + lwg + inc,  
                  data = Workmroz , family = binomial('probit'))
summary(probit)

library("sandwich")
bread(probit) 
</code></pre>

<hr>
<h2 id='effect'>Get average marginal effects for heterokedastic binary models and IV probit models</h2><span id='topic+effect'></span>

<h3>Description</h3>

<p>Obtain the average marginal effects from <code>hetprob</code> or <code>ivpml</code> class models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>effect(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="effect_+3A_object">object</code></td>
<td>
<p>an object of class <code>hetprob</code> or <code>ivpml</code>.</p>
</td></tr>
<tr><td><code id="effect_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimates of the average marginal effects computed as the average for each individual.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Data
library("AER")
data("PSID1976")
PSID1976$lfp  &lt;- as.numeric(PSID1976$participation == "yes")
PSID1976$kids &lt;- with(PSID1976, factor((youngkids + oldkids) &gt; 0,
                                      levels = c(FALSE, TRUE), 
                                      labels = c("no", "yes")))
PSID1976$finc &lt;-  PSID1976$fincome / 10000
                                 
# Average marginal effects for heteroskedastic Probit model
labor_het &lt;- hetprob(lfp ~  age + I(age^2) + finc + education + factor(kids) | 
                            factor(kids) + finc,              
                     data = PSID1976,                        
                     link = "probit")
eff_labor_het &lt;- effect(labor_het)
summary(eff_labor_het)

# Average marginal effects for IV probit model 
# (nwincome is endogenous and heducation is the additional instrument)
PSID1976$nwincome &lt;- with(PSID1976, (fincome - hours * wage)/1000)
fiml.probit &lt;- ivpml(lfp ~  education + experience + I(experience^2) + age + 
                            youngkids + oldkids + nwincome |
                            education + experience + I(experience^2) + age + 
                            youngkids + oldkids + heducation, 
                     data = PSID1976)
summary(effect(fiml.probit))
summary(effect(fiml.probit, asf = FALSE))

</code></pre>

<hr>
<h2 id='effect.hetprob'>Get average marginal effects for heterokedastic binary models</h2><span id='topic+effect.hetprob'></span><span id='topic+summary.effect.hetprob'></span><span id='topic+print.effect.hetprob'></span><span id='topic+print.summary.effect.hetprob'></span>

<h3>Description</h3>

<p>Obtain the average marginal effects from <code>hetprob</code> class model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hetprob'
effect(object, vcov = NULL, digits = max(3, getOption("digits") - 2), ...)

## S3 method for class 'effect.hetprob'
summary(object, ...)

## S3 method for class 'effect.hetprob'
print(x, ...)

## S3 method for class 'summary.effect.hetprob'
print(x, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="effect.hetprob_+3A_object">object</code></td>
<td>
<p>an object of class <code>hetprob</code> and <code>effect.hetprob</code> for <code>summary</code> and <code>print</code> method.</p>
</td></tr>
<tr><td><code id="effect.hetprob_+3A_vcov">vcov</code></td>
<td>
<p>an estimate of the asymptotic variance-covariance matrix of the parameters for a <code>hetprob</code> object.</p>
</td></tr>
<tr><td><code id="effect.hetprob_+3A_digits">digits</code></td>
<td>
<p>the number of digits.</p>
</td></tr>
<tr><td><code id="effect.hetprob_+3A_...">...</code></td>
<td>
<p>further arguments.Ignored.</p>
</td></tr>
<tr><td><code id="effect.hetprob_+3A_x">x</code></td>
<td>
<p>an object of class <code>effect.hetprob</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows to obtain the average marginal effects (not the marginal effects at the mean). The standard errors are computed using Delta Method.
</p>


<h3>Value</h3>

<p>An object of class <code>effect.heprob</code>.
</p>


<h3>Author(s)</h3>

<p>Mauricio Sarrias.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Data
library("AER")
data("PSID1976")
PSID1976$lfp  &lt;- as.numeric(PSID1976$participation == "yes")
PSID1976$kids &lt;- with(PSID1976, factor((youngkids + oldkids) &gt; 0,
                                      levels = c(FALSE, TRUE), 
                                      labels = c("no", "yes")))
                                      PSID1976$finc &lt;-  PSID1976$fincome / 10000
                                 
# Average marginal effects for heteroskedastic Probit model
labor_het &lt;- hetprob(lfp ~  age + I(age^2) + finc + education + factor(kids) | 
                            factor(kids) + finc,              
                     data = PSID1976,                        
                     link = "probit")
eff_labor_het &lt;- effect(labor_het)
summary(eff_labor_het)

</code></pre>

<hr>
<h2 id='effect.ivpml'>Get average marginal effects for IV Probit model.</h2><span id='topic+effect.ivpml'></span><span id='topic+summary.effect.ivpml'></span><span id='topic+print.effect.ivpml'></span><span id='topic+print.summary.effect.ivpml'></span>

<h3>Description</h3>

<p>Obtain the average marginal effects from <code>ivpml</code> class model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ivpml'
effect(
  object,
  vcov = NULL,
  asf = TRUE,
  digits = max(3, getOption("digits") - 2),
  ...
)

## S3 method for class 'effect.ivpml'
summary(object, ...)

## S3 method for class 'effect.ivpml'
print(x, ...)

## S3 method for class 'summary.effect.ivpml'
print(x, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="effect.ivpml_+3A_object">object</code></td>
<td>
<p>an object of class <code>ivpml</code> and <code>effect.ivpml</code> for <code>summary</code> and <code>print</code> method.</p>
</td></tr>
<tr><td><code id="effect.ivpml_+3A_vcov">vcov</code></td>
<td>
<p>an estimate of the asymptotic variance-covariance matrix of the parameters for a <code>ivpml</code> object.</p>
</td></tr>
<tr><td><code id="effect.ivpml_+3A_asf">asf</code></td>
<td>
<p>if <code>TRUE</code>, the average structural function is used.</p>
</td></tr>
<tr><td><code id="effect.ivpml_+3A_digits">digits</code></td>
<td>
<p>the number of digits.</p>
</td></tr>
<tr><td><code id="effect.ivpml_+3A_...">...</code></td>
<td>
<p>further arguments.Ignored.</p>
</td></tr>
<tr><td><code id="effect.ivpml_+3A_x">x</code></td>
<td>
<p>an object of class <code>effect.ivpml</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows to obtain the average marginal effects (not the marginal effects at the mean). The standard errors are computed using Delta Method.
</p>


<h3>Value</h3>

<p>An object of class <code>effect.ivpml</code>.
</p>


<h3>Author(s)</h3>

<p>Mauricio Sarrias.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
# Data
library("AER")
data("PSID1976")
PSID1976$lfp  &lt;- as.numeric(PSID1976$participation == "yes")
PSID1976$kids &lt;- with(PSID1976, factor((youngkids + oldkids) &gt; 0,
                                      levels = c(FALSE, TRUE), 
                                      labels = c("no", "yes")))
                                      
# Average marginal effects for IV probit model 
# (nwincome is endogenous and heducation is the additional instrument)
PSID1976$nwincome &lt;- with(PSID1976, (fincome - hours * wage)/1000)
fiml.probit &lt;- ivpml(lfp ~  education + experience + I(experience^2) + age + 
                            youngkids + oldkids + nwincome |
                            education + experience + I(experience^2) + age + 
                            youngkids + oldkids + heducation, 
                     data = PSID1976)
summary(effect(fiml.probit))
summary(effect(fiml.probit, asf = FALSE))
 
</code></pre>

<hr>
<h2 id='effect.Rchoice'>Get the conditional individual coefficients</h2><span id='topic+effect.Rchoice'></span>

<h3>Description</h3>

<p>This a helper function to obtain the individuals' conditional estimate of the random parameters or compensating variations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Rchoice'
effect(object, par = NULL, effect = c("cv", "ce"), wrt = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="effect.Rchoice_+3A_object">object</code></td>
<td>
<p>an object of class <code>Rchoice</code>,</p>
</td></tr>
<tr><td><code id="effect.Rchoice_+3A_par">par</code></td>
<td>
<p>a string giving the name of the variable with random parameter,</p>
</td></tr>
<tr><td><code id="effect.Rchoice_+3A_effect">effect</code></td>
<td>
<p>a string indicating what should be computed: the conditional expectation of the individual coefficients &quot;<code>ce</code>&quot;, or the conditional expectation of the individual compensating variations &quot;<code>cv</code>&quot;,</p>
</td></tr>
<tr><td><code id="effect.Rchoice_+3A_wrt">wrt</code></td>
<td>
<p>a string indicating respect to which variable the compensating variation should be computed,</p>
</td></tr>
<tr><td><code id="effect.Rchoice_+3A_...">...</code></td>
<td>
<p>further arguments. Ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list where &ldquo;mean&rdquo; contains the individuals' conditional mean for the random parameter or compensating variation, and where &lsquo;sd.est&rsquo; contains their standard errors.
</p>


<h3>References</h3>


<ul>
<li><p> Greene, W. H. (2012). Econometric Analysis, Seventh Edition. Pearson Hall.
</p>
</li>
<li><p> Train, K. (2009). Discrete Choice Methods with Simulation. Cambridge university press.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+Rchoice">Rchoice</a></code> for the estimation of different discrete choice models with individual parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Poisson with random parameters
data("Articles")
poisson.ran &lt;- Rchoice(art ~ fem + mar + kid5 + phd + ment, 
                       data = Articles,  family = poisson,
                       ranp = c(kid5 = "n", phd = "n", ment = "n"), 
                       R = 10)

## Get the individuals' conditional mean and their standard errors for ment                      
bi.ment &lt;- effect(poisson.ran, par = "ment", effect = "ce")
summary(bi.ment$mean)
summary(bi.ment$sd.est)

</code></pre>

<hr>
<h2 id='estfun.Rchoice'>Gradient for observations</h2><span id='topic+estfun.Rchoice'></span>

<h3>Description</h3>

<p>It extracts the gradient for each observations evaluated at the estimated parameters for a model of class <code>Rchoice</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Rchoice'
estfun(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estfun.Rchoice_+3A_x">x</code></td>
<td>
<p>a fitted model of class <code>Rchoice</code>,</p>
</td></tr>
<tr><td><code id="estfun.Rchoice_+3A_...">...</code></td>
<td>
<p>Other arguments when <code>estfun</code> is applied to another
class object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more information see <code><a href="sandwich.html#topic+estfun">estfun</a></code> from package <span class="pkg">sandwich</span>.
</p>


<h3>Value</h3>

<p>the gradient matrix of dimension n times k
</p>


<h3>References</h3>

<p>Zeileis A (2006), Object-oriented Computation of Sandwich 
Estimators. Journal of Statistical Software, 16(9), 1&ndash;16.
</p>

<hr>
<h2 id='getSummary.effect.hetprob'>Get Model Summaries for use with &quot;mtable&quot; for objects of class effect.hetprob</h2><span id='topic+getSummary.effect.hetprob'></span>

<h3>Description</h3>

<p>A generic function to collect coefficients and summary statistics from a <code>effect.hetprob</code> object. It is used in <code>mtable</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'effect.hetprob'
getSummary(obj, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getSummary.effect.hetprob_+3A_obj">obj</code></td>
<td>
<p>an <code>effect.hetprob</code> object,</p>
</td></tr>
<tr><td><code id="getSummary.effect.hetprob_+3A_alpha">alpha</code></td>
<td>
<p>level of the confidence intervals,</p>
</td></tr>
<tr><td><code id="getSummary.effect.hetprob_+3A_...">...</code></td>
<td>
<p>further arguments,</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more details see package <span class="pkg">memisc</span>.
</p>

<hr>
<h2 id='getSummary.effect.ivpml'>Get Model Summaries for use with &quot;mtable&quot; for objects of class effect.ivpml</h2><span id='topic+getSummary.effect.ivpml'></span>

<h3>Description</h3>

<p>A generic function to collect coefficients and summary statistics from a <code>effect.ivpml</code> object. It is used in <code>mtable</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'effect.ivpml'
getSummary(obj, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getSummary.effect.ivpml_+3A_obj">obj</code></td>
<td>
<p>an <code>effect.ivpml</code> object,</p>
</td></tr>
<tr><td><code id="getSummary.effect.ivpml_+3A_alpha">alpha</code></td>
<td>
<p>level of the confidence intervals,</p>
</td></tr>
<tr><td><code id="getSummary.effect.ivpml_+3A_...">...</code></td>
<td>
<p>further arguments,</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more details see package <span class="pkg">memisc</span>.
</p>

<hr>
<h2 id='getSummary.hetprob'>Get Model Summaries for use with &quot;mtable&quot; for objects of class hetprob</h2><span id='topic+getSummary.hetprob'></span>

<h3>Description</h3>

<p>A generic function to collect coefficients and summary statistics from a <code>hetprob</code> object. It is used in <code>mtable</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hetprob'
getSummary(obj, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getSummary.hetprob_+3A_obj">obj</code></td>
<td>
<p>a <code>hetprob</code> object,</p>
</td></tr>
<tr><td><code id="getSummary.hetprob_+3A_alpha">alpha</code></td>
<td>
<p>level of the confidence intervals,</p>
</td></tr>
<tr><td><code id="getSummary.hetprob_+3A_...">...</code></td>
<td>
<p>further arguments,</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more details see package <span class="pkg">memisc</span>.
</p>

<hr>
<h2 id='getSummary.ivpml'>Get Model Summaries for use with &quot;mtable&quot; for objects of class ivpml</h2><span id='topic+getSummary.ivpml'></span>

<h3>Description</h3>

<p>A generic function to collect coefficients and summary statistics from a <code>ivpml</code> object. It is used in <code>mtable</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ivpml'
getSummary(obj, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getSummary.ivpml_+3A_obj">obj</code></td>
<td>
<p>a <code>ivpml</code> object,</p>
</td></tr>
<tr><td><code id="getSummary.ivpml_+3A_alpha">alpha</code></td>
<td>
<p>level of the confidence intervals,</p>
</td></tr>
<tr><td><code id="getSummary.ivpml_+3A_...">...</code></td>
<td>
<p>further arguments,</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more details see package <span class="pkg">memisc</span>.
</p>

<hr>
<h2 id='getSummary.Rchoice'>Get Model Summaries for use with &quot;mtable&quot; for object of class Rchoice</h2><span id='topic+getSummary.Rchoice'></span>

<h3>Description</h3>

<p>A generic function to collect coefficients and summary statistics from a <code>Rchoice</code> object. It is used in <code>mtable</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Rchoice'
getSummary(obj, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getSummary.Rchoice_+3A_obj">obj</code></td>
<td>
<p>a <code>Rchoice</code> object,</p>
</td></tr>
<tr><td><code id="getSummary.Rchoice_+3A_alpha">alpha</code></td>
<td>
<p>level of the confidence intervals,</p>
</td></tr>
<tr><td><code id="getSummary.Rchoice_+3A_...">...</code></td>
<td>
<p>further arguments,</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more details see package <span class="pkg">memisc</span>.
</p>

<hr>
<h2 id='Health'>
German Health Care Data
</h2><span id='topic+Health'></span>

<h3>Description</h3>

<p>German Health Care Data, unbalanced panel. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Health)</code></pre>


<h3>Format</h3>

<p>A data frame with 27326 observations on the following 27 variables:
</p>

<dl>
<dt><code>id</code></dt><dd><p>person identification number</p>
</dd>
<dt><code>female</code></dt><dd><p>female =1, male =0</p>
</dd>
<dt><code>year</code></dt><dd><p>calendar year of the observation</p>
</dd>
<dt><code>age</code></dt><dd><p>age in years</p>
</dd>
<dt><code>hsat</code></dt><dd><p>health satisfaction, 0 (low),...,10 (high)</p>
</dd>
<dt><code>handdum</code></dt><dd><p>handicapped = 1, 0 otherwise</p>
</dd>
<dt><code>handper</code></dt><dd><p>degree of handicap in percent; 0,100</p>
</dd>
<dt><code>hhinc</code></dt><dd><p>household nominal monthly net income in German marks</p>
</dd>
<dt><code>hhkids</code></dt><dd><p>children under age 16 in the household = 1; otherwise = 0</p>
</dd>
<dt><code>educ</code></dt><dd><p>years of schooling</p>
</dd>
<dt><code>married</code></dt><dd><p>married =1, otherwise = 0</p>
</dd>
<dt><code>haupts</code></dt><dd><p>highest schooling degree is Hauptschul degree = 1; otherwise = 0</p>
</dd>
<dt><code>reals</code></dt><dd><p>highest schooling degree is Realschul degree = 1, otherwise = 0</p>
</dd>
<dt><code>fachhs</code></dt><dd><p>highest schooling degree is Polytechical degree = 1; otherwise = 0</p>
</dd>
<dt><code>abitur</code></dt><dd><p>highest schooling degree is Abitur = 1; otherwise = 0</p>
</dd>
<dt><code>univ</code></dt><dd><p>highest schooling degree is university degree =1; otherwise = 0</p>
</dd>
<dt><code>working</code></dt><dd><p> employed =1; otherwise = 0</p>
</dd>
<dt><code>bluec</code></dt><dd><p>blue-collar employee = 1; otherwise = 0</p>
</dd>
<dt><code>whitec</code></dt><dd><p>white-collar employeee =1; otherwise = 0</p>
</dd>
<dt><code>self</code></dt><dd><p>self-employed = 1; otherwise = 0</p>
</dd>
<dt><code>beamt</code></dt><dd><p>civil servant = 1; otherwise = 0</p>
</dd>
<dt><code>docvis</code></dt><dd><p>number of doctor visits in last three months</p>
</dd>
<dt><code>hospvis</code></dt><dd><p>number of hospital visits in last calendar year</p>
</dd>
<dt><code>public</code></dt><dd><p>insured in public health =1; otherwise = 0</p>
</dd>
<dt><code>addon</code></dt><dd><p>insured by add-on insurance =1; otherwise = 0</p>
</dd>
<dt><code>hsat2</code></dt><dd><p>40 observations on hsat recorded between 6 and 7 were changed to 7</p>
</dd>
<dt><code>newhsat</code></dt><dd><p>recording of hsat, (0-2) = 0, (3-5)=1, (6-8)=2, (9)=3 (10)=4</p>
</dd>
</dl>



<h3>Source</h3>

<p>Riphahn, R. T., Wambach, A., &amp; Million, A. (2003). Incentive effects in the demand for health care: a bivariate panel count data estimation. Journal of applied econometrics, 18(4), 387-405.
</p>


<h3>References</h3>

<p>Greene, W. H. (2003). Econometric analysis. Pearson Education India.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Health)
</code></pre>

<hr>
<h2 id='hetprob'>Estimate heteroskedastic binary (Probit or Logit) model.</h2><span id='topic+hetprob'></span><span id='topic+terms.hetprob'></span><span id='topic+model.matrix.hetprob'></span><span id='topic+estfun.hetprob'></span><span id='topic+bread.hetprob'></span><span id='topic+vcov.hetprob'></span><span id='topic+df.residual.hetprob'></span><span id='topic+coef.hetprob'></span><span id='topic+logLik.hetprob'></span><span id='topic+print.hetprob'></span><span id='topic+summary.hetprob'></span><span id='topic+print.summary.hetprob'></span><span id='topic+predict.hetprob'></span>

<h3>Description</h3>

<p>Estimation of binary dependent variables, either probit or logit, with heteroskedastic error terms for cross-sectional dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hetprob(formula, data, link = c("probit", "logit"), ...)

## S3 method for class 'hetprob'
terms(x, ...)

## S3 method for class 'hetprob'
model.matrix(object, ...)

## S3 method for class 'hetprob'
estfun(x, ...)

## S3 method for class 'hetprob'
bread(x, ...)

## S3 method for class 'hetprob'
vcov(object, eigentol = 1e-12, ...)

## S3 method for class 'hetprob'
df.residual(object, ...)

## S3 method for class 'hetprob'
coef(object, ...)

## S3 method for class 'hetprob'
logLik(object, ...)

## S3 method for class 'hetprob'
print(x, ...)

## S3 method for class 'hetprob'
summary(object, eigentol = 1e-12, ...)

## S3 method for class 'summary.hetprob'
print(x, digits = max(3, getOption("digits") - 2), ...)

## S3 method for class 'hetprob'
predict(object, newdata = NULL, type = c("xb", "pr", "sigma"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hetprob_+3A_formula">formula</code></td>
<td>
<p>a symbolic description of the model of the form <code>y ~ x | z</code> where <code>y</code> is the binary dependent variable and <code>x</code> and <code>z</code> are regressors variables for the mean of the model and lnsigma.</p>
</td></tr>
<tr><td><code id="hetprob_+3A_data">data</code></td>
<td>
<p>the data of class <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="hetprob_+3A_link">link</code></td>
<td>
<p>the assumption of the distribution of the error term. It could be either <code>link = "probit"</code> or <code>link = "logit"</code>.</p>
</td></tr>
<tr><td><code id="hetprob_+3A_...">...</code></td>
<td>
<p>arguments passed to <code>maxLik</code>.</p>
</td></tr>
<tr><td><code id="hetprob_+3A_x">x</code>, <code id="hetprob_+3A_object">object</code></td>
<td>
<p>an object of class <code>hetprob</code>.</p>
</td></tr>
<tr><td><code id="hetprob_+3A_eigentol">eigentol</code></td>
<td>
<p>the standard errors are only calculated if the ratio of the smallest and largest eigenvalue of the Hessian matrix is less than <code>eigentol</code>.  Otherwise the Hessian is treated as singular.</p>
</td></tr>
<tr><td><code id="hetprob_+3A_digits">digits</code></td>
<td>
<p>the number of digits.</p>
</td></tr>
<tr><td><code id="hetprob_+3A_newdata">newdata</code></td>
<td>
<p>optionally, a data frame in which to look for variables with which to predict.</p>
</td></tr>
<tr><td><code id="hetprob_+3A_type">type</code></td>
<td>
<p>the type of prediction required. The default, <code>type = xb</code>, is on the linear prediction without the variance. If <code>type = pr</code>, the predicted probabilities of a positive outcome is returned. Finally, if <code>type = sigma</code> the predictions of <code class="reqn">\sigma</code> for each individual is returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The heterokedastic binary model for cross-sectional data has the following structure:
</p>
<p style="text-align: center;"><code class="reqn">
y_i^*  = x_i^\top\beta + \epsilon_i,
</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">
var(\epsilon_i|x_i, z_i)  = \sigma_i^2 = \left[\exp\left(z_i^\top\delta\right)\right]^2,   
</code>
</p>

<p>where <code class="reqn">y_i^*</code> is the latent (unobserved) dependent variable for individual <code class="reqn">i = 1,...,N</code>; 
<code class="reqn">x_i</code> is a <code class="reqn">K\times 1</code> vector of independent variables determining the latent variable <code class="reqn">y_i^*</code> (<code>x</code> variables in <code>formula</code>); 
and <code class="reqn">\epsilon_i</code> is the error term distributed either normally or logistically with <code class="reqn">E(\epsilon_i|z_i, x_i) = 0</code> 
and heterokedastic variance <code class="reqn">var(\epsilon_i|x_i, z_i)  = \sigma_i^2, \forall i = 1,...,N</code>. 
The variance for each individual is modeled parametrically assuming that it depends on a <code class="reqn">P\times 1</code> 
vector observed variables <code class="reqn">z_i</code> (<code>z</code> in <code>formula</code>), whereas <code class="reqn">\delta</code> is the vector of parameters associated with each variable. 
It is important to emphasize that <code class="reqn">z_i</code> does not include a constant, otherwise the parameters are not identified.
</p>
<p>The models are estimated using the <code>maxLik</code> function from <code><a href="maxLik.html#topic+maxLik">maxLik</a></code> package using both 
analytic gradient and hessian  (if <code>Hess = TRUE</code>). In particular, the log-likelihood function is:
</p>
<p style="text-align: center;"><code class="reqn">\log L(\theta) = \sum_i^n\log \left\lbrace \left[1- F\left(\frac{x_i^\top\beta}{\exp(z_i^\top\delta)}\right)\right]^{1-y_i}\left[F\left(\frac{x_i^\top\beta}{\exp(z_i^\top\delta)}\right)\right]^{y_i}\right\rbrace.</code>
</p>



<h3>Value</h3>

<p>An object of class &ldquo;<code>hetprob</code>&rdquo;, a list elements:
</p>
<table role = "presentation">
<tr><td><code>logLik0</code></td>
<td>
<p>logLik for the homokedastic model,</p>
</td></tr>
<tr><td><code>f1</code></td>
<td>
<p>the formula,</p>
</td></tr>
<tr><td><code>mf</code></td>
<td>
<p>the model framed used,</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mauricio Sarrias.
</p>


<h3>References</h3>

<p>Greene, W. H. (2012). Econometric Analysis. 7 edition. Prentice Hall.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Estimate a heteroskedastic probit and logit model
data("Health")

het.probit &lt;- hetprob(working ~ factor(female) + factor(year) + educ + age + I(age^2) | 
                                factor(female) + age + I(age^2), 
                     data = Health, 
                     link = "probit")
summary(het.probit)

het.logit &lt;- hetprob(working ~ factor(female) + factor(year) + educ + age + I(age^2) | 
                               factor(female) + age + I(age^2), 
                    data = Health, 
                    link = "logit")
summary(het.logit)

</code></pre>

<hr>
<h2 id='ivpml'>Estimate Instrumental Variable Probit model by Maximum Likelihood.</h2><span id='topic+ivpml'></span><span id='topic+terms.ivpml'></span><span id='topic+model.matrix.ivpml'></span><span id='topic+estfun.ivpml'></span><span id='topic+bread.ivpml'></span><span id='topic+vcov.ivpml'></span><span id='topic+df.residual.ivpml'></span><span id='topic+coef.ivpml'></span><span id='topic+logLik.ivpml'></span><span id='topic+print.ivpml'></span><span id='topic+summary.ivpml'></span><span id='topic+print.summary.ivpml'></span><span id='topic+predict.ivpml'></span>

<h3>Description</h3>

<p>Estimation of Probit model with one endogenous and continuous variable by Maximum Likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ivpml(formula, data, messages = TRUE, ...)

## S3 method for class 'ivpml'
terms(x, ...)

## S3 method for class 'ivpml'
model.matrix(object, ...)

## S3 method for class 'ivpml'
estfun(x, ...)

## S3 method for class 'ivpml'
bread(x, ...)

## S3 method for class 'ivpml'
vcov(object, ...)

## S3 method for class 'ivpml'
df.residual(object, ...)

## S3 method for class 'ivpml'
coef(object, ...)

## S3 method for class 'ivpml'
logLik(object, ...)

## S3 method for class 'ivpml'
print(x, ...)

## S3 method for class 'ivpml'
summary(object, eigentol = 1e-12, ...)

## S3 method for class 'summary.ivpml'
print(x, digits = max(3, getOption("digits") - 2), ...)

## S3 method for class 'ivpml'
predict(object, newdata = NULL, type = c("xb", "pr", "stdp"), asf = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ivpml_+3A_formula">formula</code></td>
<td>
<p>a symbolic description of the model of the form <code>y ~ x | z</code> where <code>y</code> is the binary dependent variable, <code>x</code> includes the exogenous and the endogenous continuous variable, and <code>z</code> is the complete set of instruments.</p>
</td></tr>
<tr><td><code id="ivpml_+3A_data">data</code></td>
<td>
<p>the data of class <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="ivpml_+3A_messages">messages</code></td>
<td>
<p>if <code>TRUE</code>, then additional messages for the estimation procedure are displayed.</p>
</td></tr>
<tr><td><code id="ivpml_+3A_...">...</code></td>
<td>
<p>arguments passed to <code>maxLik</code>.</p>
</td></tr>
<tr><td><code id="ivpml_+3A_x">x</code>, <code id="ivpml_+3A_object">object</code></td>
<td>
<p>an object of class <code>ivpml</code>.</p>
</td></tr>
<tr><td><code id="ivpml_+3A_eigentol">eigentol</code></td>
<td>
<p>the standard errors are only calculated if the ratio of the smallest and largest eigenvalue of the Hessian matrix is less than <code>eigentol</code>.  Otherwise the Hessian is treated as singular.</p>
</td></tr>
<tr><td><code id="ivpml_+3A_digits">digits</code></td>
<td>
<p>the number of digits.</p>
</td></tr>
<tr><td><code id="ivpml_+3A_newdata">newdata</code></td>
<td>
<p>optionally, a data frame in which to look for variables with which to predict.</p>
</td></tr>
<tr><td><code id="ivpml_+3A_type">type</code></td>
<td>
<p>the type of prediction required. The default, <code>type = xb</code>, is on the linear prediction. If <code>type = pr</code>, the predicted probabilities of a positive outcome is returned. Finally, if <code>type = stdp</code> the standard errors of the linear predictions for each individual is returned.</p>
</td></tr>
<tr><td><code id="ivpml_+3A_asf">asf</code></td>
<td>
<p>if <code>TRUE</code>, the average structural function is used. This option is not allowed with <code>xb</code> or <code>stdp</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The IV probit for cross-sectional data has the following structure:
</p>
<p style="text-align: center;"><code class="reqn">
y_{1i}^*  = x_i^\top\beta + \gamma y_{2i}+ \epsilon_i,
</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">
 y_{2i}  = z_i^\top\delta +  \upsilon_i,   
</code>
</p>

<p>where <code class="reqn">y_{1i}^*</code> is the latent (unobserved) dependent variable for individual <code class="reqn">i = 1,...,N</code>; 
<code class="reqn">y_{2i}</code> is the endogenous continuous variable; <code class="reqn">z_i</code> is the vector of exogenous variables 
which also includes the instruments for <code class="reqn">y_{2i}</code>; 
and <code class="reqn">(\epsilon, \upsilon)</code> are normal jointly distributed.
</p>
<p>The model is estimated using the <code>maxLik</code> function from <code><a href="maxLik.html#topic+maxLik">maxLik</a></code> package using 
analytic gradient.
</p>


<h3>Author(s)</h3>

<p>Mauricio Sarrias.
</p>


<h3>References</h3>

<p>Greene, W. H. (2012). Econometric Analysis. 7 edition. Prentice Hall.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
# Data
library("AER")
data("PSID1976")
PSID1976$lfp  &lt;- as.numeric(PSID1976$participation == "yes")
PSID1976$kids &lt;- with(PSID1976, factor((youngkids + oldkids) &gt; 0,
                                      levels = c(FALSE, TRUE), 
                                      labels = c("no", "yes")))
                                      
# IV probit model by MLE
# (nwincome is endogenous and heducation is the additional instrument)
PSID1976$nwincome &lt;- with(PSID1976, (fincome - hours * wage)/1000)
fiml.probit &lt;- ivpml(lfp ~  education + experience + I(experience^2) + age + 
                            youngkids + oldkids + nwincome |
                            education + experience + I(experience^2) + age + 
                            youngkids + oldkids + heducation, 
                     data = PSID1976)
summary(fiml.probit)

</code></pre>

<hr>
<h2 id='plot.Rchoice'>Plot the distribution of conditional expectation for random parameters.</h2><span id='topic+plot.Rchoice'></span>

<h3>Description</h3>

<p>Plot the distribution of the conditional expectation of the random parameters or compensating variations for objects of class <code>Rchoice</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Rchoice'
plot(
  x,
  par = NULL,
  effect = c("ce", "cv"),
  wrt = NULL,
  type = c("density", "histogram"),
  adjust = 1,
  main = NULL,
  col = "indianred1",
  breaks = 10,
  ylab = NULL,
  xlab = NULL,
  ind = FALSE,
  id = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.Rchoice_+3A_x">x</code></td>
<td>
<p>a object of class <code>Rchoice</code>,</p>
</td></tr>
<tr><td><code id="plot.Rchoice_+3A_par">par</code></td>
<td>
<p>a string giving the name of the variable with random parameter,</p>
</td></tr>
<tr><td><code id="plot.Rchoice_+3A_effect">effect</code></td>
<td>
<p>a string indicating what should be plotted: the conditional expectation of the individual coefficients &quot;<code>ce</code>&quot;, or the conditional expectation of the individual compensating variations &quot;<code>cv</code>&quot;,</p>
</td></tr>
<tr><td><code id="plot.Rchoice_+3A_wrt">wrt</code></td>
<td>
<p>a string indicating repect to which variable should be computed the compensating variation,</p>
</td></tr>
<tr><td><code id="plot.Rchoice_+3A_type">type</code></td>
<td>
<p>a string indicating the type of distribution: it can be a <code>histogram</code> or a <code>density</code> of
the conditional expectation,</p>
</td></tr>
<tr><td><code id="plot.Rchoice_+3A_adjust">adjust</code></td>
<td>
<p>bandwidth for the kernel density,</p>
</td></tr>
<tr><td><code id="plot.Rchoice_+3A_main">main</code></td>
<td>
<p>an overall title for the plot,</p>
</td></tr>
<tr><td><code id="plot.Rchoice_+3A_col">col</code></td>
<td>
<p>color for the graph,</p>
</td></tr>
<tr><td><code id="plot.Rchoice_+3A_breaks">breaks</code></td>
<td>
<p>number of breaks for the histrogram if <code>type = "histogram"</code>,</p>
</td></tr>
<tr><td><code id="plot.Rchoice_+3A_ylab">ylab</code></td>
<td>
<p>a title for the y axis,</p>
</td></tr>
<tr><td><code id="plot.Rchoice_+3A_xlab">xlab</code></td>
<td>
<p>a title for the x axis,</p>
</td></tr>
<tr><td><code id="plot.Rchoice_+3A_ind">ind</code></td>
<td>
<p>a boolean. If <code>TRUE</code>, a 95
As default, the conditional expectation of <code>par</code> for the first 10 individual is plotted,</p>
</td></tr>
<tr><td><code id="plot.Rchoice_+3A_id">id</code></td>
<td>
<p>only relevant if <code>ind</code> is not <code>NULL</code>. This is a vector indicating the individuals for which the confidence intervals are plotted,</p>
</td></tr>
<tr><td><code id="plot.Rchoice_+3A_...">...</code></td>
<td>
<p>further arguments. Ignored.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mauricio Sarrias
</p>


<h3>References</h3>


<ul>
<li><p> Greene, W. H. (2012). Econometric analysis, Seventh Edition. Pearson Hall.
</p>
</li>
<li><p> Train, K. (2009). Discrete choice methods with simulation. Cambridge university press.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+Rchoice">Rchoice</a></code> for the estimation of different discrete choice models with individual parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Poisson with random parameters
data("Articles")
poisson.ran &lt;- Rchoice(art ~ fem + mar + kid5 + phd + ment, 
                       data = Articles,  family = poisson,
                       ranp = c(kid5 = "n", phd = "n", ment = "n"), 
                       R = 10)

## Plot the distribution of the conditional mean for ment
plot(poisson.ran, par = "ment", type = "density")

## Plot the conditional mean for the first 20 individuals
plot(poisson.ran, par = "ment", ind =  TRUE, id = 1:20, col = "blue")

## Plot the compensating variation with respect to fem
plot(poisson.ran, par = "ment", effect = "cv", wrt = "fem", type = "histogram")

</code></pre>

<hr>
<h2 id='Rchoice'>Estimate discrete choice model with random parameters</h2><span id='topic+Rchoice'></span><span id='topic+ordinal'></span><span id='topic+terms.Rchoice'></span><span id='topic+model.matrix.Rchoice'></span><span id='topic+coef.Rchoice'></span><span id='topic+fitted.Rchoice'></span><span id='topic+residuals.Rchoice'></span><span id='topic+df.residual.Rchoice'></span><span id='topic+update.Rchoice'></span><span id='topic+logLik.Rchoice'></span><span id='topic+print.Rchoice'></span><span id='topic+summary.Rchoice'></span><span id='topic+print.summary.Rchoice'></span>

<h3>Description</h3>

<p>Estimation of discrete choice models such as Binary (logit and probit), 
Poisson and Ordered (logit and probit) model with random coefficients for cross-sectional and panel data using simulated maximum likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rchoice(
  formula,
  data,
  subset,
  weights,
  na.action,
  family,
  start = NULL,
  ranp = NULL,
  R = 40,
  haltons = NA,
  seed = NULL,
  correlation = FALSE,
  panel = FALSE,
  index = NULL,
  mvar = NULL,
  print.init = FALSE,
  init.ran = 0.1,
  gradient = TRUE,
  ...
)

## S3 method for class 'Rchoice'
terms(x, ...)

## S3 method for class 'Rchoice'
model.matrix(object, ...)

## S3 method for class 'Rchoice'
coef(object, ...)

## S3 method for class 'Rchoice'
fitted(object, ...)

## S3 method for class 'Rchoice'
residuals(object, ...)

## S3 method for class 'Rchoice'
df.residual(object, ...)

## S3 method for class 'Rchoice'
update(object, new, ...)

## S3 method for class 'Rchoice'
logLik(object, ...)

## S3 method for class 'Rchoice'
print(
  x,
  digits = max(3, getOption("digits") - 3),
  width = getOption("width"),
  ...
)

## S3 method for class 'Rchoice'
summary(object, ...)

## S3 method for class 'summary.Rchoice'
print(
  x,
  digits = max(3, getOption("digits") - 3),
  width = getOption("width"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Rchoice_+3A_formula">formula</code></td>
<td>
<p>a symbolic description of the model to be estimated. The <code>formula</code> consists in two parts. The first one is reserved for standard variables with fixed and random parameters. The second one is reserved for variables that enter in the mean of the random parameters. See for example <code><a href="#topic+rFormula">rFormula</a></code>,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_data">data</code></td>
<td>
<p>the data. It may be a <code>pdata.frame</code> object or an ordinary <code>data.frame</code>,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weigths,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_na.action">na.action</code></td>
<td>
<p>a function wich indicated what should happen when the data
contains <code>NA</code>'s,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_family">family</code></td>
<td>
<p>the distribution to be used. It might be <code>family = binomial("probit")</code> for a Probit Model, <code>family = binomial("logit")</code> for a Logit model, <code>family = ordinal("probit")</code> for an Ordered Probit Model, <code>family = ordinal("logit")</code> for a Ordered Logit Model for an Ordered Logit Model, and  <code>family = "poisson"</code> for a Poisson Model,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_start">start</code></td>
<td>
<p>a vector of starting values,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_ranp">ranp</code></td>
<td>
<p>a named vector whose names are the random parameters and values the distribution:
&quot;<code>n</code>&quot; for normal, &quot;<code>ln</code>&quot; for log-normal, &quot;<code>cn</code>&quot; for truncated normal, &quot;<code>u</code>&quot; for uniform, &quot;<code>t</code>&quot; for triangular, &quot;<code>sb</code>&quot; for Johnson Sb,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_r">R</code></td>
<td>
<p>the number of draws if <code>ranp</code> is not <code>NULL</code>,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_haltons">haltons</code></td>
<td>
<p>only relevant if <code>ranp</code> is not <code>NULL</code>. If not <code>NULL</code>, halton sequence is used
instead of pseudo-random numbers. If <code>haltons=NA</code>, some default values are used for
the prime of the sequence and for the number of element dropped. Otherwise, <code>haltons</code> should
be a list with elements <code>prime</code> and <code>drop</code>,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_seed">seed</code></td>
<td>
<p>the seed for the pseudo-random draws. This is only relevant if <code>haltons = NULL</code>,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_correlation">correlation</code></td>
<td>
<p>only relevant if <code>ranp</code> is not <code>NULL</code>. If <code>TRUE</code>, the correlation between random parameters is taken into account,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_panel">panel</code></td>
<td>
<p>if <code>TRUE</code> a panel data model is estimated,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_index">index</code></td>
<td>
<p>a string indicating the &lsquo;id&rsquo; for individuals in the data. This argument is not required if data is a <code>pdata.frame</code> object,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_mvar">mvar</code></td>
<td>
<p>only valid if <code>ranp</code> is not <code>NULL</code>. This is a named list, where the names correspond to the variables with random parameters, and the values correspond to the variables that enter in the mean of each random parameters,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_print.init">print.init</code></td>
<td>
<p>if <code>TRUE</code>, the initial values for the optimization procedure are printed,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_init.ran">init.ran</code></td>
<td>
<p>initial values for standard deviation of random parameters. Default is 0.1,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_gradient">gradient</code></td>
<td>
<p>if <code>FALSE</code>, numerical gradients are used for the optimization procedure of models with random parameters,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="maxLik.html#topic+maxLik">maxLik</a></code>,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_x">x</code>, <code id="Rchoice_+3A_object">object</code></td>
<td>
<p>and object of class <code>Rchoice</code>,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_new">new</code></td>
<td>
<p>an updated formula for the update method,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_digits">digits</code></td>
<td>
<p>number of digits,</p>
</td></tr>
<tr><td><code id="Rchoice_+3A_width">width</code></td>
<td>
<p>width,</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The models are estimated using the <code>maxLik</code> function from <code><a href="maxLik.html#topic+maxLik">maxLik</a></code> package.
</p>
<p>If <code>ranp</code> is not <code>NULL</code>, the random parameter  model is estimated.   
A random parameter model or random coefficient models permits regression parameter to 
vary across individuals according to some distribution. A fully parametric 
random parameter model specifies the latent variable  <code class="reqn">y^{*}</code> conditional on regressors
<code class="reqn">x</code> and given parameters <code class="reqn">\beta_i</code> to have conditional density <code class="reqn">f(y|x, \beta_i)</code> where
<code class="reqn">\beta_i</code> are iid with density <code class="reqn">g(\beta_i|\theta_i)</code>. The density is assumed a priori by the user by the argument
<code>ranp</code>. If the parameters are assumed to be normally distributed <code class="reqn">\beta_i ~ N(\beta, \Sigma)</code>, then the random parameter are constructed as: </p>
<p style="text-align: center;"><code class="reqn">\beta_{ir}=\beta+L\omega_{ir}</code>
</p>
<p> where <code class="reqn">LL'=\Sigma</code> and <code class="reqn">\omega_{ir}</code> is the r-th draw from standard normal distribution for individual <code class="reqn">i</code>. 
</p>
<p>Once the model is specified by the argument <code>family</code>, the model is estimated using 
Simulated Maximum Likelihood (SML). The probabilities, given by <code class="reqn">f(y|x, \beta_i)</code>, are simulated using <code>R</code> pseudo-draws if <code>halton=NULL</code> or <code>R</code> halton draws if <code>halton = NA</code>. The user can also specified the primes and the number of dropped elements for the halton draws. For example, if the model consists of two random parameters, the user can specify <code>haltons = list("prime" = c(2, 3), "drop" = c(11, 11))</code>. 
</p>
<p>A random parameter hierarchical model can be estimated by including heterogeneity in the mean of the 
random parameters: </p>
<p style="text-align: center;"><code class="reqn">\beta_{ir}=\beta+\pi's_i+L\omega_{ir}</code>
</p>
 <p><span class="pkg">Rchoice</span> manages the variables in the hierarchical model by the <code>formula</code> object: all the hierarchical variables (<code class="reqn">s_i</code>) are included after the <code>|</code> symbol. The argument <code>mvar</code> indicate which variables enter in each random parameter. See examples below
</p>


<h3>Value</h3>

<p>An object of class &ldquo;<code>Rchoice</code>&rdquo;, a list elements:
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>the named vector of coefficients,</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>type of model,</p>
</td></tr>
<tr><td><code>link</code></td>
<td>
<p>distribution of the errors,</p>
</td></tr>
<tr><td><code>logLik</code></td>
<td>
<p>a set of values of the maximum likelihood procedure,</p>
</td></tr>   
<tr><td><code>mf</code></td>
<td>
<p>the model framed used,</p>
</td></tr> 
<tr><td><code>formula</code></td>
<td>
<p>the formula (a Formula object),</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p><code>proc.time()</code> minus the start time,</p>
</td></tr>
<tr><td><code>freq</code></td>
<td>
<p>frequency of dependent variable,</p>
</td></tr>
<tr><td><code>draws</code></td>
<td>
<p>type of draws used,</p>
</td></tr>
<tr><td><code>R.model</code></td>
<td>
<p><code>TRUE</code> if a random parameter model is fitted,</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>number of draws used,</p>
</td></tr>
<tr><td><code>bi</code></td>
<td>
<p>an array of dimension <code class="reqn">N \times R \times K</code> with the individual parameters,</p>
</td></tr>
<tr><td><code>Qir</code></td>
<td>
<p>matrix of dimension <code class="reqn">N \times R</code> representing <code class="reqn">P_{ir}/\sum_r P_{ir}</code>,</p>
</td></tr>
<tr><td><code>ranp</code></td>
<td>
<p>vector indicating the variables with random parameters and their distribution,</p>
</td></tr>
<tr><td><code>probabilities</code></td>
<td>
<p>the fitted probabilities for each individuals,</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the residuals,</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mauricio Sarrias <a href="mailto:msarrias86@gmail.com">msarrias86@gmail.com</a>
</p>


<h3>References</h3>

<p>Greene, W. H. (2012). Econometric Analysis. 7 edition. Prentice Hall.
</p>
<p>Train, K. (2009). Discrete Choice Methods with Simulation. Cambridge university press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.Rchoice">plot.Rchoice</a></code>, <code><a href="#topic+effect.Rchoice">effect.Rchoice</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Probit model
data("Workmroz")
probit &lt;- Rchoice(lfp ~ k5 + k618 + age + wc + hc + lwg + inc,  
                 data = Workmroz, family = binomial('probit'))
summary(probit)

## Poisson model
data("Articles")
poisson &lt;- Rchoice(art ~ fem + mar + kid5 + phd + ment, data = Articles, family = poisson)
summary(poisson)

## Ordered probit model
data("Health")
oprobit &lt;- Rchoice(newhsat ~ age + educ + hhinc + married + hhkids, 
data = Health, family = ordinal('probit'), subset = year == 1988)
summary(oprobit)

## Poisson Model with Random Parameters
poisson.ran &lt;- Rchoice(art ~ fem + mar + kid5 + phd + ment, 
                       data = Articles,  family = poisson,
                       ranp = c(kid5 = "n", phd = "n", ment = "n"))
summary(poisson.ran)                      

## Poisson Model with Correlated Random Parameters
poissonc.ran &lt;- Rchoice(art ~ fem + mar + kid5 + phd + ment, 
                       data = Articles, 
                       ranp = c(kid5 = "n", phd = "n", ment = "n"), 
                       family = poisson, 
                       correlation =  TRUE,
                       R = 20)
summary(poissonc.ran)

## Hierarchical Poisson Model
poissonH.ran &lt;- Rchoice(art ~ fem + mar + kid5 + phd + ment | fem + phd,
                       data = Articles,
                       ranp = c(kid5 = "n", phd = "n", ment = "n"),
                       mvar = list(phd = c("fem"), ment = c("fem", "phd")),
                       family = poisson,
                       R = 10)
summary(poissonH.ran)

## Ordered Probit Model with Random Effects and Random Parameters
Health$linc &lt;- log(Health$hhinc)
oprobit.ran &lt;- Rchoice(newhsat ~ age + educ + married + hhkids + linc,
                     data = Health[1:2000, ],
                     family = ordinal('probit'),
                     ranp = c(constant = "n", hhkids = "n", linc = "n"),
                     panel = TRUE,
                     index = "id",
                     R = 10,
                     print.init = TRUE)
summary(oprobit.ran)
 


</code></pre>

<hr>
<h2 id='rFormula'>Model formula for Rchoice models</h2><span id='topic+rFormula'></span><span id='topic+is.rFormula'></span><span id='topic+model.frame.rFormula'></span><span id='topic+model.matrix.rFormula'></span>

<h3>Description</h3>

<p>Two kind of variables are used in models with individual heterogenetiy: the typical
variables that enter in the latent process and those variables that enter in the random
parameter (Hierarchical Model). <code>rFormula</code> deal with this type of models using
suitable methods to extract the elements of the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rFormula(object)

is.rFormula(object)

## S3 method for class 'rFormula'
model.frame(formula, data, ..., lhs = NULL, rhs = NULL)

## S3 method for class 'rFormula'
model.matrix(object, data, rhs = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rFormula_+3A_object">object</code></td>
<td>
<p>a formula form the <code>rFormula</code> function, for the <code>model.matrix</code> method, a <code>rFormula</code> object,</p>
</td></tr>
<tr><td><code id="rFormula_+3A_formula">formula</code></td>
<td>
<p>a <code>rFormula</code> object,</p>
</td></tr>
<tr><td><code id="rFormula_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code>,</p>
</td></tr>
<tr><td><code id="rFormula_+3A_...">...</code></td>
<td>
<p>further arguments.</p>
</td></tr>
<tr><td><code id="rFormula_+3A_lhs">lhs</code></td>
<td>
<p>see <code><a href="Formula.html#topic+Formula">Formula</a></code>,</p>
</td></tr>
<tr><td><code id="rFormula_+3A_rhs">rhs</code></td>
<td>
<p>see <code><a href="Formula.html#topic+Formula">Formula</a></code>,</p>
</td></tr>
</table>

<hr>
<h2 id='vcov.Rchoice'>vcov method for Rchoice objects</h2><span id='topic+vcov.Rchoice'></span><span id='topic+cov.Rchoice'></span><span id='topic+cor.Rchoice'></span><span id='topic+se.cov.Rchoice'></span>

<h3>Description</h3>

<p>The <code>vcov</code> method for <code>Rchoice</code> objects extracts the covariance matrix of the coefficients or the random parameters. It also allows to get the standard errors for the variance-covariance matrix of the random parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Rchoice'
vcov(
  object,
  what = c("coefficient", "ranp"),
  type = c("cov", "cor", "sd"),
  se = FALSE,
  digits = max(3, getOption("digits") - 2),
  ...
)

cov.Rchoice(x)

cor.Rchoice(x)

se.cov.Rchoice(x, sd = FALSE, digits = max(3, getOption("digits") - 2))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcov.Rchoice_+3A_object">object</code></td>
<td>
<p>a fitted model of class <code>Rchoice</code>,</p>
</td></tr>
<tr><td><code id="vcov.Rchoice_+3A_what">what</code></td>
<td>
<p>indicates which covariance matrix has to be extracted. The default is <code>coefficient</code>. In this case the <code>vcov</code> behaves as usual. If <code>what = "ranp"</code> the covariance matrix of the random parameters is returned as default,</p>
</td></tr>
<tr><td><code id="vcov.Rchoice_+3A_type">type</code></td>
<td>
<p>if the model is estimated with random parameters, then this argument indicates what matrix should be returned. If <code>type = "cov"</code>, then the covariance matrix of the random parameters is returned; if <code>type = "cor"</code> then the correlation matrix of the random parameters is returned; if <code>type = "sd"</code> then the standard deviation of the random parameters is returned,</p>
</td></tr>
<tr><td><code id="vcov.Rchoice_+3A_se">se</code></td>
<td>
<p>if <code>TRUE</code> and <code>type = "cov"</code> then the standard error of the covariance matrix of the random parameters is returned; if <code>TRUE</code> and <code>type = "sd"</code> the standard error of the standard deviation of the random parameter is returned. This argument if valid only if the model is estimated using correlated random parameters,</p>
</td></tr>
<tr><td><code id="vcov.Rchoice_+3A_digits">digits</code></td>
<td>
<p>number of digits,</p>
</td></tr>
<tr><td><code id="vcov.Rchoice_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
<tr><td><code id="vcov.Rchoice_+3A_x">x</code></td>
<td>
<p>a fitted model of class <code>Rchoice</code>,</p>
</td></tr>
<tr><td><code id="vcov.Rchoice_+3A_sd">sd</code></td>
<td>
<p>if <code>TRUE</code>, then the standard deviation of the random parameters are returned,</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This new interface replaces the <code>cor.Rchoice</code>, <code>cov.Rchoice</code> and <code>se.cov.Rchoice</code> functions which are deprecated.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Rchoice">Rchoice</a></code> for the estimation of discrete choice models with random parameters.
</p>

<hr>
<h2 id='Workmroz'>
Labor Force Participation
</h2><span id='topic+Workmroz'></span>

<h3>Description</h3>

<p>Data extracted by Mroz(1987) from the 1976 Panel Study of Income Dynacmis. The sample consists of 753 white, married women between the ages of 30 and 60.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Workmroz)</code></pre>


<h3>Format</h3>

<p>A data frame with 753 observations on the following 9 variables:
</p>

<dl>
<dt><code>lfp</code></dt><dd><p>1 if wife is in the paid labor force; else 0,</p>
</dd>
<dt><code>k5</code></dt><dd><p>Number of children ages 5 and younger,</p>
</dd>
<dt><code>k618</code></dt><dd><p>Number of children ages 6 to 18,</p>
</dd>
<dt><code>age</code></dt><dd><p>Wife's age in years,</p>
</dd>
<dt><code>wc</code></dt><dd><p>1 if wife attended college; else 0,</p>
</dd>
<dt><code>hc</code></dt><dd><p>1 if husband attended college; else 0,</p>
</dd>
<dt><code>lwg</code></dt><dd><p>Log of wife's estimated wage rate,</p>
</dd>
<dt><code>inc</code></dt><dd><p>Family income excluding wife's wage,</p>
</dd>
<dt><code>linc</code></dt><dd><p>Log of Family income excluding wife's wage,</p>
</dd>
</dl>



<h3>Source</h3>

<p>Mroz, T. A. (1987). The sensitivity of an empirical model of married women's hours of work to economic and statistical assumptions. Econometrica, 55(4), 765-799
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Workmroz)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
