<!DOCTYPE html><html><head><title>Help for package PPLasso</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PPLasso}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Correction1Vect'>
<p>Correction on two vectors</p></a></li>
<li><a href='#Correction2Vect'>
<p>Correction on two vectors</p></a></li>
<li><a href='#PPLasso-package'>
<p>Prognostic Predictive Lasso for Biomarker Selection</p></a></li>
<li><a href='#ProgPredLasso'>
<p>Identification of prognostic and predictive biomarkers</p></a></li>
<li><a href='#top'>
<p>Thresholding to 0</p></a></li>
<li><a href='#top_thresh'>
<p>Thresholding to a given threshold of the smallest values</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Prognostic Predictive Lasso for Biomarker Selection</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-02-26</td>
</tr>
<tr>
<td>Author:</td>
<td>Wencan Zhu [aut, cre],
  Celine Levy-Leduc [ctb],
  Nils Ternes [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wencan Zhu &lt;wencan.zhu@agroparistech.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>We provide new tools for the identification of prognostic and predictive biomarkers. For further details we refer the reader to the paper: Zhu et al. Identification of prognostic and predictive biomarkers in high-dimensional data with PPLasso. BMC Bioinformatics. 2023 Jan 23;24(1):25.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>genlasso, ggplot2, cvCovEst, glmnet, MASS</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-26 15:54:29 UTC; mmip</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-27 09:12:35 UTC</td>
</tr>
</table>
<hr>
<h2 id='Correction1Vect'>
Correction on two vectors 
</h2><span id='topic+Correction1Vect'></span>

<h3>Description</h3>

<p>For the estimation of <code class="reqn">\beta</code> in  Zhu et al. (2022), this function keeps only the M largest values coefficientss set the others to 0. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Correction1Vect(X, Y, te = NULL, vector, top_grill. = c(1:length(vector)), delta = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Correction1Vect_+3A_x">X</code></td>
<td>

<p>Design matrix
</p>
</td></tr>
<tr><td><code id="Correction1Vect_+3A_y">Y</code></td>
<td>

<p>Response vector
</p>
</td></tr>
<tr><td><code id="Correction1Vect_+3A_te">te</code></td>
<td>

<p>treatment effects
</p>
</td></tr>
<tr><td><code id="Correction1Vect_+3A_vector">vector</code></td>
<td>

<p>The vector on which we performe the thresholding
</p>
</td></tr>
<tr><td><code id="Correction1Vect_+3A_top_grill.">top_grill.</code></td>
<td>

<p>grill of the thresholding
</p>
</td></tr>
<tr><td><code id="Correction1Vect_+3A_delta">delta</code></td>
<td>

<p>parameter <code class="reqn">\delta</code> in the thresholding
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns the thresholded vector.
</p>


<h3>Author(s)</h3>

<p>Wencan Zhu, Celine Levy-Leduc, Nils Ternes
</p>


<h3>Examples</h3>

<pre><code class='language-R'>vect_sample=sample(1:20,20)
X=t(sapply(c(1:10),FUN=function(x) rnorm(20)))
Y=rnorm(10)

Correction1Vect(X=X, Y=Y, vector=vect_sample)

## The function is currently defined as
function(X, Y, te=NULL, vector, top_grill.=c(1:length(vector)), delta=0.95){
  
  beta_interm &lt;- sapply(top_grill., top, vect = vector)
  beta_te &lt;- rbind(rep(te[1],length(top_grill.)), rep(te[2],length(top_grill.)), beta_interm)
  yhat &lt;- as.matrix(X %*% beta_te)
  residuals &lt;- sweep(yhat, 1, Y)
  mse_final_top &lt;- colMeans(residuals^2)
  ratio_mse &lt;- c()
  for (k in 1:(length(top_grill.) - 1)) {
    ratio_mse[k] &lt;- round(mse_final_top[k + 1]/mse_final_top[k],6)
  }
  top_ratio &lt;- min(which(ratio_mse &gt;= delta))
  if (is.infinite(top_ratio)) {
    opt_final_top &lt;- length(vector)
  }
  else {
    opt_final_top &lt;- top_grill.[top_ratio]
  }
  
  return(round(top(vect = vector, thresh = opt_final_top), 6))
  
}
</code></pre>

<hr>
<h2 id='Correction2Vect'>
Correction on two vectors 
</h2><span id='topic+Correction2Vect'></span>

<h3>Description</h3>

<p>For the estimation of <code class="reqn">\tilde{\beta}</code> in  Zhu et al. (2022), this function keeps only the K1 largest values of prognostic biomarkers coefficients and the k2 largest value of the presictive biomarkers coefficients and set the others to the smallest value among the k1 (k2) largest of prognostic (predictive part). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Correction2Vect(X, Y, te=NULL, vector_prog, vector_pred, 
top_grill.=c(1:length(vector_prog)), delta=0.95, toZero=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Correction2Vect_+3A_x">X</code></td>
<td>

<p>Design matrix
</p>
</td></tr>
<tr><td><code id="Correction2Vect_+3A_y">Y</code></td>
<td>

<p>Response vector
</p>
</td></tr>
<tr><td><code id="Correction2Vect_+3A_te">te</code></td>
<td>

<p>treatment effects
</p>
</td></tr>
<tr><td><code id="Correction2Vect_+3A_vector_prog">vector_prog</code></td>
<td>

<p>Vector of prognostic biomarkers
</p>
</td></tr>
<tr><td><code id="Correction2Vect_+3A_vector_pred">vector_pred</code></td>
<td>

<p>Vector of predictive biomarkers
</p>
</td></tr>
<tr><td><code id="Correction2Vect_+3A_top_grill.">top_grill.</code></td>
<td>

<p>grill of the thresholding</p>
</td></tr>
<tr><td><code id="Correction2Vect_+3A_delta">delta</code></td>
<td>

<p>parameter <code class="reqn">\delta</code> in the thresholding
</p>
</td></tr>
<tr><td><code id="Correction2Vect_+3A_tozero">toZero</code></td>
<td>

<p>should the threshold to 0 or not 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns the thresholded vector.
</p>


<h3>Author(s)</h3>

<p>Wencan Zhu, Celine Levy-Leduc, Nils Ternes
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x1=sample(1:10,10)
x2=sample(1:10,10)

X=t(sapply(c(1:10),FUN=function(x) rnorm(20)))
Y=rnorm(10)

Correction2Vect(X=X, Y=Y, vector_prog=x1, vector_pred=x2)

## The function is currently defined as
function(X, Y, te=NULL, vector_prog, vector_pred, 
top_grill.=c(1:length(vector_prog)), delta=0.95, toZero=FALSE){
  
    if(toZero){
      matrix_top_fix &lt;- sapply(top_grill., top, vect=vector_prog)
      matrix_top_opt &lt;- sapply(top_grill., top, vect=vector_pred)
    } else {
      matrix_top_fix &lt;- sapply(top_grill., top_thresh, vect=vector_prog)
      matrix_top_opt &lt;- sapply(top_grill., top_thresh, vect=vector_pred)
    }
    
    
    opt_top_opt &lt;- mse_fix &lt;- c()
    for(j in 1:length(top_grill.)){
      fix_temp &lt;- matrix_top_fix[,j]
      mse_temp &lt;- c()
      yhat &lt;- X%*%c(te, fix_temp, matrix_top_opt[,1])

      mse_temp[1] &lt;- sum((Y-yhat)^2)
      for(m in 2:length(top_grill.)){
        opt_temp &lt;- matrix_top_opt[,m]
        threshed_vect &lt;- c(te, fix_temp, opt_temp)
        yhat &lt;- X%*%threshed_vect
        mse_temp[m] &lt;- sum((Y-yhat)^2)
        ratio_mse &lt;- round(mse_temp[m]/mse_temp[m-1], 6)
        if(ratio_mse &gt;= delta){
          opt_top_opt[j] &lt;- top_grill.[m]
          mse_fix[j] &lt;- mse_temp[m]
          break
        }
      }
      if(m==length(top_grill.)){
        opt_top_opt[j] &lt;- top_grill.[m]
        mse_fix[j] &lt;- mse_temp[m]
      }
      if(j==1){
        ratio_final &lt;- 0
      } else {
        ratio_final &lt;- mse_fix[j]/mse_fix[j-1]
      }
      if(ratio_final &gt;= delta){
        opt_fix &lt;- j
        opt_opt &lt;- m
        break
      }
    }
    
    if(exists("opt_fix")==FALSE){
      opt_fix &lt;- ncol(matrix_top_fix)
      opt_opt &lt;- ncol(matrix_top_opt)
    }
    

    return(c(matrix_top_fix[,opt_fix], matrix_top_opt[,opt_opt]))

}
</code></pre>

<hr>
<h2 id='PPLasso-package'>
Prognostic Predictive Lasso for Biomarker Selection
</h2><span id='topic+PPLasso-package'></span><span id='topic+PPLasso'></span>

<h3>Description</h3>

<p>We provide new tools for the identification of prognostic and predictive biomarkers. For further details we refer the reader to the paper: Zhu et al. Identification of prognostic and predictive biomarkers in high-dimensional data with PPLasso. BMC Bioinformatics. 2023 Jan 23;24(1):25.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> PPLasso</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Prognostic Predictive Lasso for Biomarker Selection</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-02-26</td>
</tr>
<tr>
 <td style="text-align: left;">
Authors@R: </td><td style="text-align: left;"> c(person("Wencan", "Zhu", email = "wencan.zhu@agroparistech.fr", role = c("aut", "cre")),
           person("Celine","Levy-Leduc", email="celine.levy-leduc@agroparistech.fr", role = "ctb"),
           person("Nils", "Ternes", email="Nils.Ternes@sanofi.com", role = "ctb"))</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Wencan Zhu [aut, cre], Celine Levy-Leduc [ctb], Nils Ternes [ctb]</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Wencan Zhu &lt;wencan.zhu@agroparistech.fr&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> We provide new tools for the identification of prognostic and predictive biomarkers. For further details we refer the reader to the paper: Zhu et al. Identification of prognostic and predictive biomarkers in high-dimensional data with PPLasso. BMC Bioinformatics. 2023 Jan 23;24(1):25.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> genlasso, ggplot2, cvCovEst, glmnet, MASS</td>
</tr>
<tr>
 <td style="text-align: left;">
VignetteBuilder: </td><td style="text-align: left;"> knitr</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> knitr, rmarkdown</td>
</tr>
<tr>
 <td style="text-align: left;">
NeedsCompilation: </td><td style="text-align: left;"> no</td>
</tr>
<tr>
 <td style="text-align: left;">
Packaged: </td><td style="text-align: left;"> 2023-02-26 08:33:08 UTC; Wencan</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 3.5.0)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
Correction1Vect         Correction on two vectors
Correction2Vect         Correction on two vectors
PPLasso-package         Prognostic Predictive Lasso for Biomarker
                        Selection
ProgPredLasso           Identification of prognostic and predictive
                        biomarkers
top                     Thresholding to 0
top_thresh              Thresholding to a given threshold of the
                        smallest values
</pre>
<p>This package provide usufull tool for the identification of prognostics and predictive biomarkers.
</p>


<h3>Author(s)</h3>

<p>Wencan Zhu [aut, cre], Celine Levy-Leduc [ctb], Nils Ternes [ctb]
</p>
<p>Maintainer: Wencan Zhu &lt;wencan.zhu@agroparistech.fr&gt;
</p>


<h3>References</h3>

<p>W. Zhu, C. Levy-Leduc, N. Ternes. &quot;A variable selection approach for highly correlated predictors in 
high-dimensional genomic data&quot;. (2020)
</p>

<hr>
<h2 id='ProgPredLasso'>
Identification of prognostic and predictive biomarkers
</h2><span id='topic+ProgPredLasso'></span>

<h3>Description</h3>

<p>The computes the regularization path of the Prognostic Predictive Lasso described in the paper Zhu et al. (2022) given in the references.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ProgPredLasso(X1, X2, Y=Y, cor_matrix=NULL, gamma=0.99, maxsteps=500, lambda='single')
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ProgPredLasso_+3A_x1">X1</code></td>
<td>

<p>Design matrix of patients characteristics with treatment 1
</p>
</td></tr>
<tr><td><code id="ProgPredLasso_+3A_x2">X2</code></td>
<td>

<p>Design matrix of patients characteristics with treatment 2
</p>
</td></tr>
<tr><td><code id="ProgPredLasso_+3A_y">Y</code></td>
<td>

<p>Response variable
</p>
</td></tr>
<tr><td><code id="ProgPredLasso_+3A_cor_matrix">cor_matrix</code></td>
<td>

<p>Correlation matrix of biomarkers. If not specified, the function <code>cvCovEst</code> from package <code>cvCovEst</code> will be used to estimate this matrix.
</p>
</td></tr>
<tr><td><code id="ProgPredLasso_+3A_gamma">gamma</code></td>
<td>

<p>Parameter <code class="reqn">\gamma</code> defined in the paper Zhu et al. (2020) given in the references. Its default value is 0.99.</p>
</td></tr>
<tr><td><code id="ProgPredLasso_+3A_maxsteps">maxsteps</code></td>
<td>

<p>Integer specifying the maximum number of steps for the generalized Lasso algorithm. Its default value is 500.</p>
</td></tr>
<tr><td><code id="ProgPredLasso_+3A_lambda">lambda</code></td>
<td>

<p>Using single tuning parameter or both.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with the following components
</p>
<table>
<tr><td><code>lambda</code></td>
<td>
<p>different values of the parameter <code class="reqn">\lambda</code> considered.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>matrix of the estimations of <code class="reqn">\beta</code> for all the <code class="reqn">\lambda</code> considered.</p>
</td></tr>
<tr><td><code>beta.min</code></td>
<td>
<p>estimation of <code class="reqn">\beta</code> which minimize the MSE.</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>BIC for all the <code class="reqn">\lambda</code> considered.</p>
</td></tr>
<tr><td><code>mse</code></td>
<td>
<p>MSE for all the <code class="reqn">\lambda</code> considered.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wencan Zhu, Celine Levy-Leduc, Nils Ternes
</p>

<hr>
<h2 id='top'>
Thresholding to 0
</h2><span id='topic+top'></span>

<h3>Description</h3>

<p>This function keeps only the K largest values of the vector and sets the others to 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>top(vect, thresh)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="top_+3A_vect">vect</code></td>
<td>

<p>vector to threshold
</p>
</td></tr>
<tr><td><code id="top_+3A_thresh">thresh</code></td>
<td>

<p>threshold
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns the thresholded vector.
</p>


<h3>Author(s)</h3>

<p>Wencan Zhu, Celine Levy-Leduc, Nils Ternes
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x=sample(1:10,10)
thresh=3
top(x,thresh)

## The function is currently defined as
function(vect, thresh){
  sorted_vect &lt;- sort(abs(vect),decreasing=TRUE)
  v&lt;-sorted_vect[thresh]
  ifelse(abs(vect)&gt;=v,vect,0)
}
</code></pre>

<hr>
<h2 id='top_thresh'>
Thresholding to a given threshold of the smallest values
</h2><span id='topic+top_thresh'></span>

<h3>Description</h3>

<p>This function keeps only the K largest values of the vector and sets the others to the smallest value among the K largest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>top_thresh(vect,thresh)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="top_thresh_+3A_vect">vect</code></td>
<td>

<p>vector to threshold
</p>
</td></tr>
<tr><td><code id="top_thresh_+3A_thresh">thresh</code></td>
<td>

<p>threshold
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns the thresholded vector.
</p>


<h3>Author(s)</h3>

<p>Wencan Zhu, Celine Levy-Leduc, Nils Ternes
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x=sample(1:10,10)
thresh=3
top_thresh(x,thresh)

## The function is currently defined as
function (vect, thresh) 
{
    sorted_vect &lt;- sort(abs(vect),decreasing=TRUE)
    v = sorted_vect[thresh]
    ifelse(abs(vect) &gt;= v, vect, v)
  }
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
