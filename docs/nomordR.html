<!DOCTYPE html><html><head><title>Help for package nomordR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nomordR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#get_max_stat'><p>get_max_stat</p></a></li>
<li><a href='#get_max_stat_heur_T'><p>get_max_stat_heur_T</p></a></li>
<li><a href='#get_max_stat_heur_U'><p>get_max_stat_heur_U</p></a></li>
<li><a href='#get_min_stat'><p>get_min_stat</p></a></li>
<li><a href='#get_statistics_for_randomized'><p>get_statistics_for_randomized</p></a></li>
<li><a href='#get_T'><p>get_T</p></a></li>
<li><a href='#get_U'><p>get_U</p></a></li>
<li><a href='#nomord_probe'><p>nomord_probe</p></a></li>
<li><a href='#nomord-class'><p>An S4 class to represent nomord test result</p></a></li>
<li><a href='#nomordR'><p>nomordR: Implementation of a Randomization Test for Sequences of Nominal Values</p></a></li>
<li><a href='#show,nomord-method'><p>nomord class generics method</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Randomization Test for Sequences of Nominal Values</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the nomord_probe() function, which performs a statistical analysis on an input vector (sequence) of nominal (categorical) values.</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>false</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-05-19 12:40:28 UTC; pszabo</td>
</tr>
<tr>
<td>Author:</td>
<td>Peter Szabo [aut, cre],
  Andras Szilagyi [aut],
  Janos Podani [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Peter Szabo &lt;peterszabomail77@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-05-20 07:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='get_max_stat'>get_max_stat</h2><span id='topic+get_max_stat'></span>

<h3>Description</h3>

<p>An internal function that returns the approximate maximum value of a given statistic 
for randomized samples of an input vector of categorical variables
using heuristic rules
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_max_stat(seq, statname)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_max_stat_+3A_seq">seq</code></td>
<td>
<p>A vector of categorical values</p>
</td></tr>
<tr><td><code id="get_max_stat_+3A_statfunc">statfunc</code></td>
<td>
<p>The used statistic formula</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Integer
</p>

<hr>
<h2 id='get_max_stat_heur_T'>get_max_stat_heur_T</h2><span id='topic+get_max_stat_heur_T'></span>

<h3>Description</h3>

<p>An internal function that returns the approximate maximum value of the T statistic 
for randomized samples of an input vector of categorical variables
using a heuristic rule.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_max_stat_heur_T(seq)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_max_stat_heur_T_+3A_seq">seq</code></td>
<td>
<p>A vector of categorical values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Integer
</p>

<hr>
<h2 id='get_max_stat_heur_U'>get_max_stat_heur_U</h2><span id='topic+get_max_stat_heur_U'></span>

<h3>Description</h3>

<p>An internal function that returns the approximate maximum value of the U statistic 
for randomized samples of an input vector of categorical variables
using a heuristic rule.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_max_stat_heur_U(seq)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_max_stat_heur_U_+3A_seq">seq</code></td>
<td>
<p>A vector of categorical values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Integer
</p>

<hr>
<h2 id='get_min_stat'>get_min_stat</h2><span id='topic+get_min_stat'></span>

<h3>Description</h3>

<p>An internal function that returns the exact minimum value of a given statistic 
for randomized samples of an input vector of categorical variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_min_stat(seq, statname)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_min_stat_+3A_seq">seq</code></td>
<td>
<p>A vector of categorical values</p>
</td></tr>
<tr><td><code id="get_min_stat_+3A_statname">statname</code></td>
<td>
<p>The name of the statistic</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Integer
</p>

<hr>
<h2 id='get_statistics_for_randomized'>get_statistics_for_randomized</h2><span id='topic+get_statistics_for_randomized'></span>

<h3>Description</h3>

<p>An internal function that returns the list of statistics for 
n number of randomized versions of the input vector of categorical variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_statistics_for_randomized(seq, statfunc, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_statistics_for_randomized_+3A_seq">seq</code></td>
<td>
<p>A vector of categorical variables</p>
</td></tr>
<tr><td><code id="get_statistics_for_randomized_+3A_statfunc">statfunc</code></td>
<td>
<p>The used statistic function</p>
</td></tr>
<tr><td><code id="get_statistics_for_randomized_+3A_n">n</code></td>
<td>
<p>The number of randomized samples</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of integers
</p>

<hr>
<h2 id='get_T'>get_T</h2><span id='topic+get_T'></span>

<h3>Description</h3>

<p>An internal function that returns the T statistic of
the input vector of categorical variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_T(seq)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_T_+3A_seq">seq</code></td>
<td>
<p>A vector of categorical variables</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The integer-valued statistic
</p>

<hr>
<h2 id='get_U'>get_U</h2><span id='topic+get_U'></span>

<h3>Description</h3>

<p>An internal function that returns the U statistic of
the input vector of categorical variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_U(seq)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_U_+3A_seq">seq</code></td>
<td>
<p>A vector of categorical variables</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The integer-valued statistic
</p>

<hr>
<h2 id='nomord_probe'>nomord_probe</h2><span id='topic+nomord_probe'></span>

<h3>Description</h3>

<p>Returns the probability p
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nomord_probe(seq, statname)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nomord_probe_+3A_seq">seq</code></td>
<td>
<p>A vector of categorical variables</p>
</td></tr>
<tr><td><code id="nomord_probe_+3A_statname">statname</code></td>
<td>
<p>The used statistic function (&quot;U&quot; or &quot;T&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A nomord class S4 object with the following slots: input, statname, statvalue, althyp, p
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nomord_probe(c("B","A","A","C","C","B","A","A"), 'U')

</code></pre>

<hr>
<h2 id='nomord-class'>An S4 class to represent nomord test result</h2><span id='topic+nomord-class'></span>

<h3>Description</h3>

<p>An S4 class to represent nomord test result
</p>


<h3>Slots</h3>


<dl>
<dt><code>input</code></dt><dd><p>The vectorized input sequence</p>
</dd>
<dt><code>p</code></dt><dd><p>p-value of the statistic test</p>
</dd>
</dl>

<hr>
<h2 id='nomordR'>nomordR: Implementation of a Randomization Test for Sequences of Nominal Values</h2><span id='topic+nomordR'></span>

<h3>Description</h3>

<p>The included <code>nomord_probe</code> function performs
a statistical analysis on an input vector (sequence) of nominal (categorical) values.
The vector positions and the corresponding nominal values define ordinal-nominal value pairs,
which can be associated. 
The function first calculates an association statistic, then
performs a randomization test to check for a significant association.
</p>


<h3>Usage</h3>

<p>The <code>nomord_probe</code> function has two mandatory arguments; the input sequence as a vector (obligatory) and the
chosen statistic ('U' or 'T').
The command returns an S4 object with slot names <code>input</code>, <code>statname</code>, <code>statvalue</code>, <code>althyp</code> and <code>p</code>,
standing for the input sequence, the chosen statistic, the (normalized) statistic value, the textual alternative hypothesis,  
and the p-value of the statistical test, respectively.
Printing the result also displays these values.
A statistic ('U' or 'T') value of –1 indicates maximum segregation, while a value of 1 indicates maximum aggregation
of the nominal values along the ordinal dimension. 
</p>
<p>Examples:
</p>
<pre>
&gt; v = c("B","A","A","C","C","B","A","A")
&gt; nomord_probe(v, "U")
Association test for a sequence of nominal values
input:  B A A C C B A A
U -statistic:  -0.4285714
alternative hypothesis:  U statistic is smaller than expected from a random sequence
p-value:  0.2723
&gt;
&gt; result = nomord_probe(v, "U")
&gt; result@p
[1] 0.2723
</pre>


<h3>Computational background</h3>

<p>Two association metrics are available.
The U statistic expresses the topological segregation of the sequence by counting the 
number of other types appearing between every pair of vector elements, denoted by <code class="reqn">w_{ij}</code>.
The unnormalized U' is calculated as <code class="reqn">U' = \sum_{i&lt;j} w_{ij}</code>, and
the normalized U value is calculated as <code class="reqn">U=(U'-U_{min})/(U_{max}-U_{min})</code>,
where <code class="reqn">U'_{max}</code> and <code class="reqn">U'_{min}</code> are the theoretical largest and smallest U' values
for a sequence with the same length and the same nominal value distribution.
</p>
<p>The T statistic expresses the subsequence diversity by counting the number of different
elements in all possible <code class="reqn">v</code>-long substrings. The window width <code class="reqn">v</code>
is equal to the number of distinct nominal values. 
Denoting the number of different elements in a substring starting at index <code class="reqn">i</code> as <code class="reqn">d_i</code>,
the unnormalized T' is calculated as <code class="reqn">U' = \sum_{i} d_{i}</code>, and
the normalized T value is calculated as <code class="reqn">T=(T'-T_{min})/(T_{max}-T_{min})</code>,
where <code class="reqn">T'_{max}</code> and <code class="reqn">T'_{min}</code> are the theoretical largest and smallest T' values
for a sequence with the same length and the same nominal value distribution.
</p>
<p><code class="reqn">U_{min}</code> is equal to zero. The other extremum values are calculated from algorithmically 
generated sequences, with the same length (<em>L</em>) and nominal-value occurrences (<code class="reqn">n_c, c = \{1,2, ... , k\}</code>)
as the input vector. (The validity of these algoriths was checked with a Metropolis–Hastings algorithm.)
</p>
<p>&mdash;&mdash;&mdash;-
</p>
<p><code class="reqn">U_{max}</code>:
</p>
<p>1. Assign <em>p</em> priority values to all elements <code class="reqn">(i = \{1,2, ... , n_c\})</code> of all types <code class="reqn">(c = \{1,2, ... , k\})</code>
according to the rule <code class="reqn">p = i/(n_c + 1)</code>, where <code class="reqn">k</code> is the number of different nominal values.
</p>
<p>2. Order the elements according to their priorities. Break ties between elements of
different types consistently according to any arbitrary ordering of types.
</p>
<p>&mdash;&mdash;&mdash;-
</p>
<p><code class="reqn">T_{min}</code>
</p>
<p>Create a sequence consisting of homogeneous blocks of the different elements.
Place shorter blocks (with smaller <code class="reqn">n_c</code>) as close to either the left or right ends, as possible.
</p>
<p>&mdash;&mdash;&mdash;-
</p>
<p><code class="reqn">T_{max}</code>
</p>
<p>1. Create an indexed list of the different types (e.g. [1, 2, 3, 4]). Initially, the number of
available elements for all types <code class="reqn">(m_c)</code> is equal to their occurrence values <code class="reqn">(n_c)</code>.
</p>
<p>2. Assign elements to the different places of the sequence, starting from the middle and
going towards the left and right ends, using an auxiliary variable i ranging from 1 to
L (sequence length). For each value of i:
</p>
<p>(a) The place to assign a value to is; <em>p = floor(L/2)</em>, if i is odd,
<em>p = floor(L/2) + i/2</em>, if i is even.
</p>
<p>(b) Let the candidate to this place be the type with the index <em>p mod k</em>, denoted by c.
</p>
<p>(c) If <code class="reqn">m_c</code> is zero, then let c be the type with the highest remaining number <code class="reqn">(m_c)</code>.
</p>
<p>(d) Assign c to position <em>p</em> of the sequence and decrease <code class="reqn">m_c</code> with one.
</p>
<p>This algorithm fills a sequence with elements starting from the middle and going towards the
left and right ends. It tries to place different types next to each other, but if it is not possible
(there are no more elements of the desired type), then it is replaced by an element of the most
abundant type.
</p>

<hr>
<h2 id='show+2Cnomord-method'>nomord class generics method</h2><span id='topic+show+2Cnomord-method'></span>

<h3>Description</h3>

<p>nomord class generics method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'nomord'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2Cnomord-method_+3A_object">object</code></td>
<td>
<p>An object</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
