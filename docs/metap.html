<!DOCTYPE html><html><head><title>Help for package metap</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {metap}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#albatros'><p>Albatros plot</p></a></li>
<li><a href='#allmetap'><p>Carry out all or some of the methods in the package</p></a></li>
<li><a href='#dat.metap'><p>Example data</p></a></li>
<li><a href='#invchisq'><p>Combine p values using inverse chi squared method</p></a></li>
<li><a href='#invt'><p>Combine p values using inverse t method</p></a></li>
<li><a href='#logitp'><p>Combine p values using logit method</p></a></li>
<li><a href='#meanp'><p>Combine p values by the mean p method</p></a></li>
<li><a href='#meanz'><p>Combine p values using mean z method</p></a></li>
<li><a href='#metap-package'><p>Meta-Analysis of Significance Values</p></a></li>
<li><a href='#plotp'><p>Q-Q plot of p-values</p></a></li>
<li><a href='#schweder'><p>Schweder and Spjotvoll plot</p></a></li>
<li><a href='#sumlog'><p>Combine p-values by the sum of logs (Fisher's) method</p></a></li>
<li><a href='#sump'><p>Combine p-values using the sum of p (Edgington's) method</p></a></li>
<li><a href='#sumz'><p>Combine p-values using the sum of z (Stouffer's) method</p></a></li>
<li><a href='#truncated'><p>Truncated product method routine</p></a></li>
<li><a href='#two2one'><p>Convert two-sided p-values to one-sided</p></a></li>
<li><a href='#votep'><p>Combine p-values by the vote counting method</p></a></li>
<li><a href='#wilkinsonp'><p>Combine p-values using Wilkinson's method</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Meta-Analysis of Significance Values</td>
</tr>
<tr>
<td>Version:</td>
<td>1.9</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-05</td>
</tr>
<tr>
<td>Description:</td>
<td>The canonical way to perform meta-analysis involves using effect sizes.
   When they are not available this package provides a number of methods for
   meta-analysis of significance values including the methods of Edgington, Fisher,
   Lancaster, Stouffer, Tippett, and Wilkinson; a number of data-sets to replicate published results;
   and routines for graphical display.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>lattice,Rdpack (&ge; 0.7),TFisher,mutoss,mathjaxr (&ge;
0.8-3),qqconf</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack,mathjaxr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-09 11:58:24 UTC; MichaelUser</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael Dewey <a href="https://orcid.org/0000-0002-7522-3677"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael Dewey &lt;lists@dewey.myzen.co.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-09 14:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='albatros'>Albatros plot</h2><span id='topic+albatros'></span><span id='topic+docontours'></span>

<h3>Description</h3>

<p>Produces the albatros plot of Harrison et al<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class='language-R'>albatros(p, n, axes = list(xlimit = NULL, ylimit = NULL,
      lefttext = NULL, righttext = NULL),
   contours = list(type = NULL, contvals = NULL, ltys = NULL, contlabs = NULL),
   plotpars = list(yscale = NULL, pchs = NULL, cols = NULL), ...)
docontours(conttype, xvals, contvals, xtrans, ytrans,
   xlims, ylims, ltys, contlabs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="albatros_+3A_p">p</code></td>
<td>
<p>A vector of \(p\) values</p>
</td></tr>
<tr><td><code id="albatros_+3A_n">n</code></td>
<td>
<p>A vector of sample sizes</p>
</td></tr>
<tr><td><code id="albatros_+3A_axes">axes</code></td>
<td>
<p>A list containing
</p>

<ul>
<li> <p><code>xlimit</code> a single value, the limit
for the x-axis which is used symmetrically
</p>
</li>
<li> <p><code>ylimit</code> a vector of length 2, limits for the y-axis
</p>
</li>
<li> <p><code>lefttext</code> character, to label below plot
</p>
</li>
<li> <p><code>righttext</code> character, to label below plot
</p>
</li></ul>

</td></tr>
<tr><td><code id="albatros_+3A_contours">contours</code></td>
<td>
<p>A list containing
</p>

<ul>
<li> <p><code>type</code> what effect size to use, a character one of &quot;corr&quot;,
&quot;or&quot;, &quot;smd&quot;
</p>
</li>
<li> <p><code>contvals</code> a vector, what values to draw the contours at
</p>
</li>
<li> <p><code>ltys</code> a vector, what line types to use
</p>
</li></ul>

</td></tr>
<tr><td><code id="albatros_+3A_plotpars">plotpars</code></td>
<td>
<p>A list containing
</p>

<ul>
<li> <p><code>yscale</code> Scaling for y-axis, See details
</p>
</li>
<li> <p><code>pchs</code> Symbols to be used
</p>
</li>
<li> <p><code>cols</code> Colours for points
</p>
</li></ul>

</td></tr>
<tr><td><code id="albatros_+3A_...">...</code></td>
<td>
<p>Arguments to be passed through to <code>plot</code></p>
</td></tr>
<tr><td><code id="albatros_+3A_conttype">conttype</code></td>
<td>
<p>Character: one of &quot;smd&quot;, &quot;or&quot;, &quot;corr&quot;</p>
</td></tr>
<tr><td><code id="albatros_+3A_xvals">xvals</code></td>
<td>
<p>A vector of values to evaluate the contour</p>
</td></tr>
<tr><td><code id="albatros_+3A_contvals">contvals</code></td>
<td>
<p>The values at which contours are drawn</p>
</td></tr>
<tr><td><code id="albatros_+3A_xtrans">xtrans</code></td>
<td>
<p>A function for transforming the x-axis</p>
</td></tr>
<tr><td><code id="albatros_+3A_ytrans">ytrans</code></td>
<td>
<p>A function for transforming the y-axis</p>
</td></tr>
<tr><td><code id="albatros_+3A_xlims">xlims</code></td>
<td>
<p>The limits for the x-axis in plotting units</p>
</td></tr>
<tr><td><code id="albatros_+3A_ylims">ylims</code></td>
<td>
<p>The limits for the y-axis in plottng units</p>
</td></tr>
<tr><td><code id="albatros_+3A_ltys">ltys</code></td>
<td>
<p>A vector of line types for the contours</p>
</td></tr>
<tr><td><code id="albatros_+3A_contlabs">contlabs</code></td>
<td>
<p>Logical, draw the labels of the contours?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plots \(n\) against \(p\) and draws contours of
constant effect size.

</p>
<p>The \(p\) value scale on the x-axis is a logarithmic one
but folded at the null value so that the extreme values represent
small probabilities in each direction.
The scale for the y-axis is user selectable.
The original scale in the Stata version is
\((\log_{10}n)^2\) which is obtained by
setting <code>yscale</code> to &quot;classic&quot;
but it is
also possible to use \(\sqrt{n}\)
which is the default or \(n\) by setting
<code>yscale</code> to &quot;n&quot;.
If the dataset contains extreme values the
plot may be uninformative and the <code>xlimit</code>
and <code>ylimit</code> parameters my be helpful to clip
the plot.
If they are not specified the function tries
to choose suitable values.
</p>
<p>For the contours if the <code>type</code> parameter in <code>contours</code>
is NULL (the default) no contours will be plotted.
The options available are
&ldquo;smr&rdquo; (Standardised mean difference)
&ldquo;corr&rdquo; (Correlation)
&ldquo;or&rdquo; (Odds ratio).
</p>
<p>The contours are labelled unless contlabs is set to <code>FALSE</code>.
The function tries to position these so they are not obscured
by the contour lines but if that is unsatisfactory then
it is best to suppress them and position them manually
or use a legend to identify line types.
</p>
<p>The <code>pch</code> parameter may either be a single value
or a vector of the same length as <code>p</code>.
It may contain anything which is legal as input to
the parameter of the same name in the graphics
library and will be used for the plotted points.
The <code>cols</code> parameter works similarly.
</p>
<p>The values of <code>lefttext</code> and <code>righttext</code> are
used to produce labels under the \(x\)-axis and
are placed level with the label.
By default they are not produced.
</p>
<p>The return values from the function may be useful if further
annotations are required as they give the axis limits in
plotting units.
</p>


<h3>Value</h3>

<p>Returns
A list containing
</p>
<table>
<tr><td><code>xlims</code></td>
<td>
<p>The limits for the x-axis in plotting units</p>
</td></tr>
<tr><td><code>ylims</code></td>
<td>
<p>The limits for the y-axis in plotting units</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The docontours function is for internal use only</p>


<h3>Author(s)</h3>

<p>Michael Dewey</p>


<h3>References</h3>

<p>Harrison S, Jones HE, Martin RM, Lewis SJ, Higgins JPT (2017).
&ldquo;The albatros plot: A novel graphical tool for presenting the results of diversely reported studies in a systematic review.&rdquo;
<em>Research Synthesis Methods</em>, <b>8</b>, 281&ndash;289.
</p>


<h3>See Also</h3>

<p>For plotting parameters
see <code><a href="graphics.html#topic+par">par</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dat.metap)
validity &lt;- dat.metap$validity
fit.v &lt;- albatros(validity$p, validity$n,
   contours = list(type = "corr", contvals = c(0.25, 0.5, 0.8), ltys = 1:3),
      axes = list(ylimit = c(1,200),  lefttext = "Negative correlation",
         righttext = "Positive correlation"),
   main = "Validity")
#
fit.z &lt;- albatros(dat.metap$zhang$p, dat.metap$zhang$n,
   contours = list(type = "smd", contvals = c(0.25, 0.5, 1), ltys = 1:3),
   plotpars = list(pchs = letters[unclass(dat.metap$zhang$phase)]),
   axes = list(lefttext = "Favours control", righttext = "Favours exercise"),
   main = "Zhang"
   )
</code></pre>

<hr>
<h2 id='allmetap'>Carry out all or some of the methods in the package</h2><span id='topic+allmetap'></span><span id='topic+print.allmetap'></span>

<h3>Description</h3>

<p>Enables all or a selected number of the package
methods to be executed on the same dataset<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class='language-R'>allmetap(p, method = NULL, log.p = FALSE)
## S3 method for class 'allmetap'
print(x, digits = 5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="allmetap_+3A_p">p</code></td>
<td>
<p>A vector of \(p\)-values</p>
</td></tr>
<tr><td><code id="allmetap_+3A_method">method</code></td>
<td>
<p>A vector of character containing names of methods or &lsquo;<code>all</code>&rsquo;</p>
</td></tr>
<tr><td><code id="allmetap_+3A_log.p">log.p</code></td>
<td>
<p>Logical, are the \(p\)-values passed as logs?</p>
</td></tr>
<tr><td><code id="allmetap_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>allmetap</code>&rsquo;</p>
</td></tr>
<tr><td><code id="allmetap_+3A_digits">digits</code></td>
<td>
<p>How many digits to print?</p>
</td></tr>
<tr><td><code id="allmetap_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed through</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses each of the methods specified
on the data-set in <code>p</code>. If method contains &lsquo;<code>all</code>&rsquo;
then this over&ndash;rides any specific method(s) named.
</p>


<h3>Value</h3>

<p>Returns an object of class
&lsquo;<code>allmetap</code>&rsquo; and &lsquo;<code>data.frame</code>&rsquo; containing columns
</p>
<table>
<tr><td><code>p</code></td>
<td>
<p>The value of p returned</p>
</td></tr>
<tr><td><code>valid</code></td>
<td>
<p>The number of valid p values used for that method</p>
</td></tr>
<tr><td><code>eponym</code></td>
<td>
<p>The eponym, if any, for the method</p>
</td></tr>
</table>
<p>The row names are the names of the methods used.
If any of the methods cannot be applied to that data&ndash;set NA are
returned for <code>p</code> and <code>valid</code>.
</p>


<h3>Author(s)</h3>

<p>Michael Dewey</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dat.metap)
beckerp &lt;- dat.metap$beckerp
allmetap(beckerp, method = "all")
allmetap(beckerp, method = c("sumz", "sumlog"))
</code></pre>

<hr>
<h2 id='dat.metap'>Example data</h2><span id='topic+dat.metap'></span><span id='topic+beckerp'></span><span id='topic+cholest'></span><span id='topic+edgington'></span><span id='topic+naep'></span><span id='topic+mourning'></span><span id='topic+rosenthal'></span><span id='topic+teachexpect'></span><span id='topic+validity'></span>

<h3>Description</h3>

<p>The package contains the following datasets: <code>beckerp</code>,
<code>cholest</code>, <code>edgington</code>, <code>mourning</code>, <code>naep</code>,
<code>rosenthal</code>, <code>teachexpect</code>, <code>validity</code>,
and <code>zhang</code>.
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dat.metap)
</code></pre>


<h3>Format</h3>

<p>A list with the following elements:
</p>

<dl>
<dt><code>beckerp</code></dt><dd>
<p>A vector of length 5
</p>
</dd>
<dt><code>cholest</code></dt><dd>
<p>A data frame with 34 observations on the following 5 variables.
</p>

<dl>
<dt><code>ntreat</code></dt><dd><p>A numeric vector of number treated</p>
</dd>
<dt><code>ncontrol</code></dt><dd><p>A numeric vector of number in the control group</p>
</dd>
<dt><code>dtreat</code></dt><dd><p>A numeric vector of number of deaths in the treated group</p>
</dd>
<dt><code>dcontrol</code></dt><dd><p>A numeric vector of number of deaths in the control group</p>
</dd>
<dt><code>p</code></dt><dd><p>a numeric vector of one sided \(p\) values</p>
</dd>
</dl>

<p>A vector of length 34
</p>
</dd>
<dt><code>edgington</code></dt><dd>
<p>A vector of length 7
</p>
</dd>
<dt><code>naep</code></dt><dd><p>A data frame with 34 observations on the following 2 variables.
</p>

<dl>
<dt><code>state</code></dt><dd><p>a factor with levels <code>AL</code>, <code>AR</code>, <code>AZ</code>, <code>CA</code>, <code>CO</code>, <code>CT</code>, <code>DE</code>, <code>FL</code>, <code>GA</code>, <code>HI</code>, <code>IA</code>, <code>ID</code>, <code>IN</code>, <code>KY</code>, <code>LA</code>, <code>MD</code>, <code>MI</code>, <code>MN</code>, <code>NC</code>, <code>ND</code>, <code>NE</code>, <code>NH</code>, <code>NJ</code>, <code>NM</code>, <code>NY</code>, <code>OH</code>, <code>OK</code>, <code>PA</code>, <code>RI</code>, <code>TX</code>, <code>VA</code>, <code>WI</code>, <code>WV</code>, <code>WY</code>,</p>
</dd>
<dt><code>p</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>
</dd>
<dt><code>mourning</code></dt><dd><p> A data frame with 9 observations on the following 3 variables.
</p>

<dl>
<dt><code>stance</code></dt><dd><p>a factor with levels <code>No stand</code>, <code>Opponent</code>, <code>Supporter</code></p>
</dd>
<dt><code>grade</code></dt><dd><p>a factor with levels <code>G11-12</code>, <code>G7-8</code>, <code>G9-10</code></p>
</dd>
<dt><code>p</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>
</dd>
<dt><code>rosenthal</code></dt><dd>
<p>A data frame with 5 observations on the following 3 variables.
</p>

<dl>
<dt><code>t</code></dt><dd><p>A numeric vector of values of \(t\)</p>
</dd>
<dt><code>df</code></dt><dd><p>a numeric vector of degrees of freedom</p>
</dd>
<dt><code>p</code></dt><dd><p>a numeric vector of one sided \(p\) values</p>
</dd>
</dl>

</dd>
<dt><code>teachexpect</code></dt><dd><p>A vector of length 19
</p>
</dd>
<dt><code>validity</code></dt><dd>
<p>A data frame with 20 observations on the following 3 variables
</p>

<dl>
<dt><code>n</code></dt><dd><p>A numeric vector of sample sizes</p>
</dd>
<dt><code>r</code></dt><dd><p>a numeric vector of correlation coefficients</p>
</dd>
<dt><code>p</code></dt><dd><p>a numeric vector of one sided \(p\) values</p>
</dd>
</dl>

</dd>
<dt><code>zhang</code></dt><dd>
<p>A data frame with 22 observations on the following 11 variables
</p>

<dl>
<dt><code>study</code></dt><dd><p>Character, the study names</p>
</dd>
<dt><code>smd</code></dt><dd><p>numeric, the standardised mean difference</p>
</dd>
<dt><code>lo</code></dt><dd><p>numeric, the lower confidence limit</p>
</dd>
<dt><code>hi</code></dt><dd><p>numeric, the upper confidence limit</p>
</dd>
<dt><code>ntreat</code></dt><dd><p>numeric, the treated sample size</p>
</dd>
<dt><code>ncont</code></dt><dd><p>numeric, the control sample size</p>
</dd>
<dt><code>n</code></dt><dd><p>numeric, the total sample size</p>
</dd>
<dt><code>phase</code></dt><dd><p>factor, what phase the patients were in:
acute, healing, healed</p>
</dd>
<dt><code>sd</code></dt><dd><p>numeric, the calculated standard deviation</p>
</dd>
<dt><code>z</code></dt><dd><p>numeric, the calculated z</p>
</dd>
<dt><code>p</code></dt><dd><p>numeric, the probability associated with z</p>
</dd>
</dl>

</dd>
</dl>



<h3>Details</h3>


<dl>
<dt><code>beckerp</code></dt><dd><p>Hypothetical \(p\) values from Becker (1994)</p>
</dd>
<dt><code>cholest</code></dt><dd><p>\(p\) values from trials
of interventions for lowering cholesterol
lowering from Sutton et al. (2000)</p>
</dd>
<dt><code>edgington</code></dt><dd><p>Hypothetical \(p\) values from Edgington (1972)</p>
</dd>
<dt><code>mourning</code></dt><dd><p>Results from a study of mourning practices of Israeli
youth following the assassination of Itzakh Rabin
from Benjamini and Hochberg (2000)</p>
</dd>
<dt><code>naep</code></dt><dd><p>Results of mathematical achievment scores
from the National Assessment
of Educational Progress from Benjamini and Hochberg (2000)</p>
</dd>
<dt><code>rosenthal</code></dt><dd><p>Hypothetical example from Rosenthal (1978)</p>
</dd>
<dt><code>teachexpect</code></dt><dd><p>\(p\)-values from studies of the effect of
manipulating teacher expectancy on student IQ
from Becker (1994)</p>
</dd>
<dt><code>validity</code></dt><dd><p>Data from studies of validity of
student ratings of their instructors
from Becker (1994)
including correlations and sample sizes as well as \(p\)-values</p>
</dd>
<dt><code>zhang</code></dt><dd><p>Data from trials of exercise training for
patients with cardiovascular disease from
Zhang et al. (2016)
</p>
</dd>
</dl>



<h3>Note</h3>

<p>The \(p\)-values in <code>cholest</code> have been re-calculated
and are of higher accuracy than the ones given in the book.</p>


<h3>Author(s)</h3>

<p>Michael Dewey</p>


<h3>References</h3>

<p>Becker BJ (1994).
&ldquo;Combining significance levels.&rdquo;
In Cooper H, Hedges LV (eds.), <em>A handbook of research synthesis</em>, 215&ndash;230.
Russell Sage, New York.<br /><br /> Benjamini Y, Hochberg Y (2000).
&ldquo;On the adaptive control of the false discovery rate in multiple testing with independent statistics.&rdquo;
<em>Journal of Educational and Behavioral Statistics</em>, <b>25</b>, 60&ndash;83.<br /><br /> Edgington ES (1972).
&ldquo;An additive method for combining probability values from independent experiments.&rdquo;
<em>Journal of Psychology</em>, <b>80</b>, 351&ndash;363.<br /><br /> Rosenthal R (1978).
&ldquo;Combining results of independent studies.&rdquo;
<em>Psychological Bulletin</em>, <b>85</b>, 185&ndash;193.<br /><br /> Sutton AJ, Abrams KR, Jones DR, Sheldon TA, Song F (2000).
<em>Methods for meta-analysis in medical research</em>.
Wiley, Chichester.<br /><br /> Zhang YM, Lu Y, Yang D, Wu HF, Bian ZP, Xu JD, Gu CR, Wang LS, Chen XJ (2016).
&ldquo;The effects of different initiation time of exercise training on left ventricular remodeling and cardiopulmonary rehabilitation in patients with left ventricular dysfunction after myocardial infarction.&rdquo;
<em>Disability and Rehabilitation</em>, <b>38</b>, 268&ndash;276.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dat.metap)
</code></pre>

<hr>
<h2 id='invchisq'>Combine p values using inverse chi squared method</h2><span id='topic+invchisq'></span><span id='topic+Lancaster+27s+20method'></span><span id='topic+print.invchisq'></span>

<h3>Description</h3>

<p>Combine \(p\)-values by the
inverse chi-squared method,
also known as Lancaster's method<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>invchisq(p, k, data = NULL, subset = NULL, na.action = na.fail, log.p = FALSE)
## S3 method for class 'invchisq'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="invchisq_+3A_p">p</code></td>
<td>
<p>A vector of significance values</p>
</td></tr>
<tr><td><code id="invchisq_+3A_k">k</code></td>
<td>
<p>A vector of degrees of freedom to use, see details</p>
</td></tr>
<tr><td><code id="invchisq_+3A_data">data</code></td>
<td>
<p>Optional data frame containing variables</p>
</td></tr>
<tr><td><code id="invchisq_+3A_subset">subset</code></td>
<td>
<p>Optional vector of logicals to specify a subset of the \(p\)-values</p>
</td></tr>
<tr><td><code id="invchisq_+3A_na.action">na.action</code></td>
<td>
<p>A function indicating what should happen when data
contains NAs</p>
</td></tr>
<tr><td><code id="invchisq_+3A_log.p">log.p</code></td>
<td>
<p>Logical, if TRUE result is returned as log(p)</p>
</td></tr>
<tr><td><code id="invchisq_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>invchisq</code>&rsquo;</p>
</td></tr>
<tr><td><code id="invchisq_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed through</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Defined as
\[\sum_{i=1}^n \chi^2_{k_i}(p_i) > \chi^2_{\sum{k_i}}(\alpha)\]
</p>
<p>If <code>k</code> is a single value it is used for all the <code>p</code>
of which there are <code>n</code>.
If any value of \(k_i\le0\) then the corresponding \(p_i\)
is not included.
</p>
<p>The values of \(p_i\) should be such that \(0 < p_i\le 1\) and a warning is given if that is not true. A warning is given if, possibly as a result of removing illegal values, fewer than two values remain and the return values are set to NA.
</p>
<p>The plot method for class &lsquo;<code>metap</code>&rsquo; calls <code><a href="#topic+plotp">plotp</a></code> on the valid <i>p</i>-values.
Inspection of the distribution of \(p\)-values is highly recommended as extreme values in opposite directions do not cancel out. See last example. This may not be what you want.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;<code>invchisq</code>&rsquo; and &lsquo;<code>metap</code>&rsquo;,
a list with entries
</p>
<table>
<tr><td><code>chisq</code></td>
<td>
<p>Value of chi-squared statistic</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>Associated degrees of freedom</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Associated p-value</p>
</td></tr>
<tr><td><code>validp</code></td>
<td>
<p>The input vector with the illegal values removed</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Dewey
</p>


<h3>References</h3>

<p>Becker BJ (1994).
&ldquo;Combining significance levels.&rdquo;
In Cooper H, Hedges LV (eds.), <em>A handbook of research synthesis</em>, 215&ndash;230.
Russell Sage, New York.
</p>
<p>Lancaster HO (1949).
&ldquo;Combination of probabilities arising from data in discrete distributions.&rdquo;
<em>Biometrika</em>, <b>36</b>, 370&ndash;382.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+sumlog">sumlog</a></code> and <code><a href="#topic+plotp">plotp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dat.metap)
beckerp &lt;- dat.metap$beckerp
invchisq(beckerp, 2) # same as sumlog
invchisq(c(0.999, 0.999, 0.001, 0.001), 4)
all.equal(exp(invchisq(beckerp, 2, log.p = TRUE)$p), invchisq(beckerp, 2)$p)
</code></pre>

<hr>
<h2 id='invt'>Combine p values using inverse t method</h2><span id='topic+invt'></span><span id='topic+print.invt'></span>

<h3>Description</h3>

<p>Combine p values using the inverse t method<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class='language-R'>invt(p, k, data = NULL, subset = NULL, na.action = na.fail,
   log.p = FALSE)
## S3 method for class 'invt'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="invt_+3A_p">p</code></td>
<td>
<p>A vector of significance values</p>
</td></tr>
<tr><td><code id="invt_+3A_k">k</code></td>
<td>
<p>A vector of degrees of freedom to use, see details</p>
</td></tr>
<tr><td><code id="invt_+3A_data">data</code></td>
<td>
<p>Optional data frame containing variables</p>
</td></tr>
<tr><td><code id="invt_+3A_subset">subset</code></td>
<td>
<p>Optional vector of logicals to specify a subset of the \(p\)-values</p>
</td></tr>
<tr><td><code id="invt_+3A_na.action">na.action</code></td>
<td>
<p>A function indicating what should happen when data
contains NAs</p>
</td></tr>
<tr><td><code id="invt_+3A_log.p">log.p</code></td>
<td>
<p>Logical, if TRUE result is returned as log(p)</p>
</td></tr>
<tr><td><code id="invt_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>invt</code>&rsquo;</p>
</td></tr>
<tr><td><code id="invt_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed through</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Defined as 
\[\frac{\sum_{i=1}^n t_{k_i}(p_i)}
{\sqrt{\sum_{i=1}^n \frac{k_i}{k_i - 2}}}
> z(\alpha)
\]
</p>
<p>If <code>k</code> is a single value it is used for all the <code>p</code>
of which there are <code>n</code>.
If any value of \(k_i\le2\) then the corresponding \(p_i\)
is not included.
</p>
<p>The values of \(p_i\) should be such that \(0 < p_i\le 1\) and a warning is given if that is not true. A warning is given if, possibly as a result of removing illegal values, fewer than two values remain and the return values are set to NA.
</p>
<p>The plot method for class &lsquo;<code>metap</code>&rsquo; calls <code><a href="#topic+plotp">plotp</a></code> on the valid <i>p</i>-values.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;<code>invt</code>&rsquo; and &lsquo;<code>metap</code>&rsquo;,
a list with entries
</p>
<table>
<tr><td><code>z</code></td>
<td>
<p>Value of z</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Associated p-value</p>
</td></tr>
<tr><td><code>validp</code></td>
<td>
<p>The input vector with the illegal values removed</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Dewey</p>


<h3>References</h3>

<p>Becker BJ (1994).
&ldquo;Combining significance levels.&rdquo;
In Cooper H, Hedges LV (eds.), <em>A handbook of research synthesis</em>, 215&ndash;230.
Russell Sage, New York.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+plotp">plotp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dat.metap)
beckerp &lt;- dat.metap$beckerp
invt(beckerp, 50)
all.equal(exp(invt(beckerp, 50, log.p = TRUE)$p), invt(beckerp, 50)$p)
</code></pre>

<hr>
<h2 id='logitp'>Combine p values using logit method</h2><span id='topic+logitp'></span><span id='topic+print.logitp'></span>

<h3>Description</h3>

<p>Combine \(p\) values using logit method<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logitp(p, log.p = FALSE)
## S3 method for class 'logitp'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logitp_+3A_p">p</code></td>
<td>
<p>A vector of significance values</p>
</td></tr>
<tr><td><code id="logitp_+3A_log.p">log.p</code></td>
<td>
<p>Logical, if TRUE result is returned as log(p)</p>
</td></tr>
<tr><td><code id="logitp_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>logitp</code>&rsquo;</p>
</td></tr>
<tr><td><code id="logitp_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed through</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Defined as \[t = - \frac{\sum_{i=1}^k \log\frac{p_i}{1 - p_i}}{C}\]
where
\[C = \sqrt\frac{k \pi^2 (5 k + 2)}{3(5 k + 4)}\]
and \(k\) is the number of studies.
</p>
<p>The values of \(p_i\) should be such that \(0 < p_i < 1\) and a warning is given if that is not true. A warning is given if, possibly as a result of removing illegal values, fewer than two values remain and the return values are set to NA.
</p>
<p>The plot method for class &lsquo;<code>metap</code>&rsquo; calls <code><a href="#topic+plotp">plotp</a></code> on the valid <i>p</i>-values.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;<code>logitp</code>&rsquo; and
&lsquo;<code>metap</code>&rsquo;, a list with entries
</p>
<table>
<tr><td><code>t</code></td>
<td>
<p>Value of Student's \(t\)</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>Associated degrees of freedom</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Associated \(p\)-value</p>
</td></tr>
<tr><td><code>validp</code></td>
<td>
<p>The input vector with illegal values removed</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Dewey</p>


<h3>References</h3>

<p>Becker BJ (1994).
&ldquo;Combining significance levels.&rdquo;
In Cooper H, Hedges LV (eds.), <em>A handbook of research synthesis</em>, 215&ndash;230.
Russell Sage, New York.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+plotp">plotp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dat.metap)
teachexpect &lt;- dat.metap$teachexpect
logitp(teachexpect) # t = 2.763, df = 99, p = 0.0034, from Becker
beckerp &lt;- dat.metap$beckerp
logitp(beckerp) # t = 1.62, df = 29, NS, from Becker
validity &lt;- dat.metap$validity$p
logitp(validity) # t = 9.521, df = 104, p = 3.89 * 10^{-16}
all.equal(exp(logitp(validity, log.p = TRUE)$p), logitp(validity)$p)
</code></pre>

<hr>
<h2 id='meanp'>Combine p values by the mean p method</h2><span id='topic+meanp'></span><span id='topic+print.meanp'></span>

<h3>Description</h3>

<p>Combine \(p\) values by the mean p method<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class='language-R'>meanp(p)
## S3 method for class 'meanp'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meanp_+3A_p">p</code></td>
<td>
<p>A vector of significance values</p>
</td></tr>
<tr><td><code id="meanp_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>meanp</code>&rsquo;</p>
</td></tr>
<tr><td><code id="meanp_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed through</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Defined as
\[z = (0.5 - \bar{p}) \sqrt{12k}\]
which is a standard normal and due to Edgington (1972)

</p>
<p>The values of \(p_i\) should be such that \(0\le p_i\le 1\) and a warning is given if that is not true. A warning is given if, possibly as a result of removing illegal values, fewer than four values remain and the return values are set to NA.
</p>
<p>The plot method for class &lsquo;<code>metap</code>&rsquo; calls <code><a href="#topic+plotp">plotp</a></code> on the valid <i>p</i>-values.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;<code>meanp</code>&rsquo; and &lsquo;<code>metap</code>&rsquo;,
a list with entries
</p>
<table>
<tr><td><code>z</code></td>
<td>
<p>Value of \(z\)</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Associated \(p\)-value</p>
</td></tr>
<tr><td><code>validp</code></td>
<td>
<p>The input vector with illegal values removed</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Dewey</p>


<h3>References</h3>

<p>Becker BJ (1994).
&ldquo;Combining significance levels.&rdquo;
In Cooper H, Hedges LV (eds.), <em>A handbook of research synthesis</em>, 215&ndash;230.
Russell Sage, New York.<br /><br /> Edgington ES (1972).
&ldquo;A normal curve method for combining probability values from independent experiments.&rdquo;
<em>Journal of Psychology</em>, <b>82</b>, 85&ndash;89.<br /><br /> Rosenthal R (1978).
&ldquo;Combining results of independent studies.&rdquo;
<em>Psychological Bulletin</em>, <b>85</b>, 185&ndash;193.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+plotp">plotp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dat.metap)
rosenthal &lt;- dat.metap$rosenthal
meanp(rosenthal$p) # 2.17, p = 0.015 one tailed
</code></pre>

<hr>
<h2 id='meanz'>Combine p values using mean z method</h2><span id='topic+meanz'></span><span id='topic+print.meanz'></span>

<h3>Description</h3>

<p>Combines p values using the mean of z
method<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class='language-R'>meanz(p, log.p = FALSE)
## S3 method for class 'meanz'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meanz_+3A_p">p</code></td>
<td>
<p>A vector of significance values</p>
</td></tr>
<tr><td><code id="meanz_+3A_log.p">log.p</code></td>
<td>
<p>Logical, if TRUE result is returned as log(p)</p>
</td></tr>
<tr><td><code id="meanz_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>meanz</code>&rsquo;</p>
</td></tr>
<tr><td><code id="meanz_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed through</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let \[\bar{z} = \sum_{i=1}^k \frac{z(p_i)}{k}\]
and \[s_{\bar{z}} = \frac{s_z}{\sqrt{k}}\]
Defined as
\[
\frac{\bar{z}}{s_{\bar{z}}} > t_{k-1}(\alpha)
\]
</p>
<p>The values of \(p_i\) should be such that \(0\le p_i\le 1\) and a warning is given if that is not true. A warning is given if, possibly as a result of removing illegal values, fewer than two values remain and the return values are set to NA.
As can be seen if all the \(p_i\) are equal or close
to equal this gives a \(t=\pm\infty\) leading to
a returned value of 0 or 1. 
A set of \(p\) values with small variance will
necessarily give a small \(p\) value which may be smaller
than that for another set all of whose primary values are less
than any in the first set.
See examples for a demonstration.
</p>
<p>The plot method for class &lsquo;<code>metap</code>&rsquo; calls <code><a href="#topic+plotp">plotp</a></code> on the valid <i>p</i>-values.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;<code>meanz</code>&rsquo; and
&lsquo;<code>metap</code>&rsquo;, a list with entries
</p>
<table>
<tr><td><code>z</code></td>
<td>
<p>The value of the mean \(z\) statistic</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The associated \(p\) value</p>
</td></tr>
<tr><td><code>validp</code></td>
<td>
<p>The input vector with illegal values removed</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Dewey</p>


<h3>References</h3>

<p>Becker BJ (1994).
&ldquo;Combining significance levels.&rdquo;
In Cooper H, Hedges LV (eds.), <em>A handbook of research synthesis</em>, 215&ndash;230.
Russell Sage, New York.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+plotp">plotp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dat.metap)
beckerp &lt;- dat.metap$beckerp
meanz(beckerp)
meanz(c(0.1, 0.2))  # greater than next example
meanz(c(0.3, 0.31)) # less than above
all.equal(exp(meanz(beckerp, log.p = TRUE)$p), meanz(beckerp)$p)
</code></pre>

<hr>
<h2 id='metap-package'>Meta-Analysis of Significance Values</h2><span id='topic+metap-package'></span><span id='topic+metap'></span>

<h3>Description</h3>

<p>The canonical way to perform meta-analysis involves using effect sizes.
   When they are not available this package provides a number of methods for
   meta-analysis of significance values including the methods of Edgington, Fisher,
   Lancaster, Stouffer, Tippett, and Wilkinson; a number of data-sets to replicate published results;
   and routines for graphical display.</p>


<h3>Details</h3>


<p>Index of help topics:
</p>
<pre>
albatros                Albatros plot
allmetap                Carry out all or some of the methods in the
                        package
dat.metap               Example data
invchisq                Combine p values using inverse chi squared
                        method
invt                    Combine p values using inverse t method
logitp                  Combine p values using logit method
meanp                   Combine p values by the mean p method
meanz                   Combine p values using mean z method
metap-package           Meta-Analysis of Significance Values
plotp                   Q-Q plot of p-values
schweder                Schweder and Spjotvoll plot
sumlog                  Combine p-values by the sum of logs (Fisher's)
                        method
sump                    Combine p-values using the sum of p
                        (Edgington's) method
sumz                    Combine p-values using the sum of z
                        (Stouffer's) method
truncated               Truncated product method routine
two2one                 Convert two-sided p-values to one-sided
votep                   Combine p-values by the vote counting method
wilkinsonp              Combine p-values using Wilkinson's method
</pre>

<p>Further information is available in the following vignettes:<br /><br />
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>compare</code> </td><td style="text-align: left;"> Comparison of methods in the metap package (source)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>metap</code> </td><td style="text-align: left;"> Introduction to the metap package (source)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>plotmetap</code> </td><td style="text-align: left;"> Plotting in the metap package (source)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Provides a number of ways in which significance levels may be combined
in a meta-analysis and includes most ot the methods
in Becker (1994).
It includes a number of datasets taken from the literature. 
It also provides a display and
an informal graphical test due to Schweder
and Spjotvoll (Schweder and Spjotvoll 1982)
and the lowest slope line of Benjamini and
Hochberg (Benjamini and Hochberg 2000).
The albatros plot of Harrison et al (Harrison et al. 2017)
is also provided.
</p>
<p>Some further documentation and,
possibly, a development version
may be seen at
<a href="http://www.dewey.myzen.co.uk/meta/meta.html">http://www.dewey.myzen.co.uk/meta/meta.html</a>
</p>


<h3>References</h3>

<p>Becker BJ (1994).
&ldquo;Combining significance levels.&rdquo;
In Cooper H, Hedges LV (eds.), <em>A handbook of research synthesis</em>, 215&ndash;230.
Russell Sage, New York.<br /><br /> Benjamini Y, Hochberg Y (2000).
&ldquo;On the adaptive control of the false discovery rate in multiple testing with independent statistics.&rdquo;
<em>Journal of Educational and Behavioral Statistics</em>, <b>25</b>, 60&ndash;83.<br /><br /> Harrison S, Jones HE, Martin RM, Lewis SJ, Higgins JPT (2017).
&ldquo;The albatros plot: A novel graphical tool for presenting the results of diversely reported studies in a systematic review.&rdquo;
<em>Research Synthesis Methods</em>, <b>8</b>, 281&ndash;289.<br /><br /> Schweder T, Spjotvoll E (1982).
&ldquo;Plots of <code class="reqn">P</code>&ndash;values to evaluate many tests simultaneously.&rdquo;
<em>Biometrika</em>, <b>69</b>, 493&ndash;502.
</p>


<h3>See Also</h3>

<p>The issue of meta-analysis of signficance levels is not completely
unconnected with the topic of adjustment for multiple
comparisons as in for example <code><a href="stats.html#topic+p.adjust">p.adjust</a></code>
</p>

<hr>
<h2 id='plotp'>Q-Q plot of p-values</h2><span id='topic+plotp'></span>

<h3>Description</h3>

<p>Produces a Q&ndash;Q plot of the p-values supplied<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotp(pvals, plotversion = "qqconf", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotp_+3A_pvals">pvals</code></td>
<td>
<p>A vector of \(p\)&ndash;values</p>
</td></tr>
<tr><td><code id="plotp_+3A_plotversion">plotversion</code></td>
<td>
<p>Whether to use the qqconf version or the original</p>
</td></tr>
<tr><td><code id="plotp_+3A_...">...</code></td>
<td>
<p>Other parameters to pass through to <code>qqplot</code>
and <code>qqline</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>After eliminating out of range \(p\)&ndash;values
and missing values produces a Q&ndash;Q plot.
If the package <code>qqconf</code> is unavailable or
<code>plotversion</code> is set other than &quot;qqconf&quot;
then the plot uses the function from base graphics.
The line shown is
through the quantiles (by default the 0.25 and 0.75).
</p>
<p>If the package <code>qqconf</code> is available then the plot
uses that package's function and as well as the Q&ndash;Q plot
produces a confidence region.
Parameters can be passed to <code>qq_conf_plot</code> to
exert further control over the plot.
</p>
<p>If <code>plotversion</code> is set to &quot;qqconf&quot;
but package <code>qqconf</code> is not available
then a warning is given and no plot is produced.
</p>


<h3>Value</h3>

<p>Invisibly returns a list consisting of
</p>
<table>
<tr><td><code>validp</code></td>
<td>
<p>The valid \(p\)&ndash;values</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Dewey</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+qqplot">qqplot</a></code> and <code><a href="stats.html#topic+qqline">qqline</a></code> for
the original plot and <code>qq_conf_plot</code> for
the new version.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dat.metap)
cholest &lt;- dat.metap$cholest$p
plotp(cholest)
</code></pre>

<hr>
<h2 id='schweder'>Schweder and Spjotvoll plot</h2><span id='topic+schweder'></span>

<h3>Description</h3>

<p>Produces the plot suggested by Schweder and Spjotvoll to display
a collection of \(p\)-values and also optionally draws the
lowest slope line suggested by Benjamini and Hochberg<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>schweder(p, xlab = "Rank of p", ylab = "p", drawline = NULL,
   bh.lwd = 1, bh.lty = "solid", bh.col = "black",
   ls.control = list(frac = NULL),
   ls.lwd = 1, ls.lty = "dotted", ls.col = "black",
   ab.control = list(a = NULL, b = NULL),
   ab.lwd = 1, ab.lty = "dashed", ab.col = "black", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="schweder_+3A_p">p</code></td>
<td>
<p>A vector of \(p\)-values</p>
</td></tr>
<tr><td><code id="schweder_+3A_xlab">xlab</code></td>
<td>
<p>Label for plot \(x\)-axis</p>
</td></tr>
<tr><td><code id="schweder_+3A_ylab">ylab</code></td>
<td>
<p>Label for plot \(y\)-axis</p>
</td></tr>
<tr><td><code id="schweder_+3A_drawline">drawline</code></td>
<td>
<p>Which line, if any, to draw. See Details</p>
</td></tr>
<tr><td><code id="schweder_+3A_bh.lwd">bh.lwd</code></td>
<td>
<p>Width of the lowest slope line</p>
</td></tr>
<tr><td><code id="schweder_+3A_bh.lty">bh.lty</code></td>
<td>
<p>Line type of the lowest slope line</p>
</td></tr>
<tr><td><code id="schweder_+3A_bh.col">bh.col</code></td>
<td>
<p>Colour of the lowest slope line</p>
</td></tr>
<tr><td><code id="schweder_+3A_ls.control">ls.control</code></td>
<td>
<p>A list containing a named element <code>frac</code>. See Details</p>
</td></tr>
<tr><td><code id="schweder_+3A_ls.lwd">ls.lwd</code></td>
<td>
<p>Width of the least squares line</p>
</td></tr>
<tr><td><code id="schweder_+3A_ls.lty">ls.lty</code></td>
<td>
<p>Line type of the least squares line</p>
</td></tr>
<tr><td><code id="schweder_+3A_ls.col">ls.col</code></td>
<td>
<p>Colour of the least squares line</p>
</td></tr>
<tr><td><code id="schweder_+3A_ab.control">ab.control</code></td>
<td>
<p>A list containing two elements <code>a</code> and <code>b</code>. See Details</p>
</td></tr>
<tr><td><code id="schweder_+3A_ab.lwd">ab.lwd</code></td>
<td>
<p>Width of the specified line</p>
</td></tr>
<tr><td><code id="schweder_+3A_ab.lty">ab.lty</code></td>
<td>
<p>Line type of the specified line</p>
</td></tr>
<tr><td><code id="schweder_+3A_ab.col">ab.col</code></td>
<td>
<p>Colour of the specified line</p>
</td></tr>
<tr><td><code id="schweder_+3A_...">...</code></td>
<td>
<p>Further parameters to be passed through to plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>After removing invalid \(p\)-values plots them.
Any graphics parameters passed in <code>...</code> affect this part
of the plot only.
Note that the axes are chosen according to the scheme of Banjamini and
Hochberg, Schweder and Spjotvoll used a different system.
</p>
<p>By setting <code>drawline</code> appropriately up to three
lines may be drawn.
</p>
<p>If <code>drawline</code> includes the string <code>"bh"</code>
the lowest slope line of Benjaimin and Hochberg is drawn.
No further parameters are needed here but the characteristics of the
line may be set: width, line type, and colour.
</p>
<p>If <code>drawline</code> includes the string <code>"ls"</code>
a least squares line is drawn passing through the point
\(k+1, 1\).
The parameter <code>frac</code> specified what fraction of the
values be used for this and may need experimentation
to obtain a suitable line.
The characteristics of the
line may be set: width, line type, and colour.
</p>
<p>If <code>drawline</code> includes the string <code>"ab"</code>
a user specified line is drawn.
The parameters <code>a</code> and <code>b</code> specify the intercept
and slope. 
The characteristics of the
line may be set: width, line type, and colour.
</p>


<h3>Value</h3>

<p>A list containing
</p>
<table>
<tr><td><code>p</code></td>
<td>
<p>The values of \(p\) plotted</p>
</td></tr>
<tr><td><code>bh.params</code></td>
<td>
<p>A list containing at least items <code>a</code> and <code>b</code>
the intercept and slope of the line drawn. This is only included if the
lowest slope line was drawn</p>
</td></tr>
<tr><td><code>ls.params</code></td>
<td>
<p>A list containing at least items <code>a</code> and <code>b</code>
the intercept and slope of the line drawn. This is only included if the
least squares line was drawn</p>
</td></tr>
<tr><td><code>ab.params</code></td>
<td>
<p>A list containing at least items <code>a</code> and <code>b</code>
the intercept and slope of the line drawn. This is only included if the
user specified line was drawn</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Dewey</p>


<h3>References</h3>

<p>Becker BJ (1994).
&ldquo;Combining significance levels.&rdquo;
In Cooper H, Hedges LV (eds.), <em>A handbook of research synthesis</em>, 215&ndash;230.
Russell Sage, New York.
</p>
<p>Benjamini Y, Hochberg Y (2000).
&ldquo;On the adaptive control of the false discovery rate in multiple testing with independent statistics.&rdquo;
<em>Journal of Educational and Behavioral Statistics</em>, <b>25</b>, 60&ndash;83.
</p>
<p>Schweder T, Spjotvoll E (1982).
&ldquo;Plots of <i>P</i>&ndash;values to evaluate many tests simultaneously.&rdquo;
<em>Biometrika</em>, <b>69</b>, 493&ndash;502.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   data(dat.metap)
   teachexpect &lt;- dat.metap$teachexpect
   schweder(teachexpect)
</code></pre>

<hr>
<h2 id='sumlog'>Combine p-values by the sum of logs (Fisher's) method
</h2><span id='topic+sumlog'></span><span id='topic+Fisher+27s+20method'></span><span id='topic+chi-square+20+282+29+20method'></span><span id='topic+print.sumlog'></span>

<h3>Description</h3>

<p>Combine \(p\)-values by the sum of logs method,
also known as Fisher's method, and sometimes as the
chi-square (2) method<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class='language-R'>sumlog(p, log.p = FALSE)
## S3 method for class 'sumlog'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sumlog_+3A_p">p</code></td>
<td>
<p>A vector of significance values</p>
</td></tr>
<tr><td><code id="sumlog_+3A_log.p">log.p</code></td>
<td>
<p>Logical, if TRUE result is returned as log(p)</p>
</td></tr>
<tr><td><code id="sumlog_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>sumlog</code>&rsquo;</p>
</td></tr>
<tr><td><code id="sumlog_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed through</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method relies on the fact that
\[\sum_{i=1}^k - 2 \log p_i\]
is a chi-squared with \(2 k\) df where \(k\) is the number
of studies (Fisher 1925).



</p>
<p>The values of \(p_i\) should be such that \(0 < p_i\le 1\) and a warning is given if that is not true. A warning is given if, possibly as a result of removing illegal values, fewer than two values remain and the return values are set to NA.
</p>
<p>The plot method for class &lsquo;<code>metap</code>&rsquo; calls <code><a href="#topic+plotp">plotp</a></code> on the valid <i>p</i>-values.
Inspection of the distribution of \(p\)-values is highly recommended as extreme values in opposite directions do not cancel out. See last example. This may not be what you want.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;<code>sumlog</code>&rsquo; and &lsquo;<code>metap</code>&rsquo;,
a list with entries
</p>
<table>
<tr><td><code>chisq</code></td>
<td>
<p>Value of chi-squared statistic</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>Associated degrees of freedom</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Associated \(p\)-value</p>
</td></tr>
<tr><td><code>validp</code></td>
<td>
<p>The input vector with the illegal values removed</p>
</td></tr>

</table>


<h3>Author(s)</h3>

<p>Michael Dewey</p>


<h3>References</h3>

<p>Becker BJ (1994).
&ldquo;Combining significance levels.&rdquo;
In Cooper H, Hedges LV (eds.), <em>A handbook of research synthesis</em>, 215&ndash;230.
Russell Sage, New York.<br /><br /> Fisher RA (1925).
<em>Statistical methods for research workers</em>.
Oliver and Boyd, Edinburgh.<br /><br /> Rosenthal R (1978).
&ldquo;Combining results of independent studies.&rdquo;
<em>Psychological Bulletin</em>, <b>85</b>, 185&ndash;193.<br /><br /> Sutton AJ, Abrams KR, Jones DR, Sheldon TA, Song F (2000).
<em>Methods for meta-analysis in medical research</em>.
Wiley, Chichester.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+plotp">plotp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dat.metap)
teachexpect &lt;- dat.metap$teachexpect
sumlog(teachexpect) # chisq = 69.473, df = 38, p = 0.0014, from Becker
beckerp &lt;- dat.metap$beckerp
sumlog(beckerp) # chisq = 18.533, df = 10, sig
rosenthal &lt;- dat.metap$rosenthal
sumlog(rosenthal$p) # chisq = 22.97, df = 10, p = 0.006 one sided
cholest &lt;- dat.metap$cholest$p
sumlog(cholest) # chisq = 58.62, df = 68, p = 0.78
validity &lt;- dat.metap$validity$p
sumlog(validity) # chisq = 159.82, df = 40, p = 2.91 * 10^{-16}
sumlog(c(0.0001, 0.0001, 0.9999, 0.9999)) # is significant
all.equal(exp(sumlog(validity, log.p = TRUE)$p), sumlog(validity)$p)
</code></pre>

<hr>
<h2 id='sump'>Combine p-values using the sum of p (Edgington's) method</h2><span id='topic+sump'></span><span id='topic+Edgington+27s+20method'></span><span id='topic+print.sump'></span>

<h3>Description</h3>

<p>Combine \(p\)-values using the sum p method<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class='language-R'>sump(p)
## S3 method for class 'sump'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sump_+3A_p">p</code></td>
<td>
<p>A vector of significance values</p>
</td></tr>
<tr><td><code id="sump_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>sump</code>&rsquo;</p>
</td></tr>
<tr><td><code id="sump_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed through</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Defined as
\[\frac{(\sum_{i=1}^k p_i)^k}{k!}
- {k \choose 1}\frac{(\sum_{i=1}^k p_i - 1)^k}{k!}
+ {k \choose 2}\frac{(\sum_{i=1}^k  p_i - 2)^k}{k!} ...\]
where there are \(k\) studies and the series continues
until the numerator
becomes negative (Edgington 1972).
</p>
<p>Some authors use a simpler version
\[\frac{(\sum_{i=1}^k  p_i)^k}{k!}\]
but this can be very conservative when
\(\sum_{i=1}^k  p_i > 1\).
There seems no particular need to use this method but
it is returned as the value of <code>conservativep</code>
for use in checking published values.
</p>
<p>The values of \(p_i\) should be such that \(0\le p_i\le 1\) and a warning is given if that is not true. A warning is given if, possibly as a result of removing illegal values, fewer than two values remain and the return values are set to NA. A warning is given when the internal calculations
are likely to have been subject to numerical error
and an alternative method should be used to check
the result.
</p>
<p>The plot method for class &lsquo;<code>metap</code>&rsquo; calls <code><a href="#topic+plotp">plotp</a></code> on the valid <i>p</i>-values.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;<code>sump</code>&rsquo; and
&lsquo;<code>metap</code>&rsquo;, a list with entries
</p>
<table>
<tr><td><code>p</code></td>
<td>
<p>The transformed sum of the \(p\)-values</p>
</td></tr>
<tr><td><code>conservativep</code></td>
<td>
<p>See details</p>
</td></tr>
<tr><td><code>validp</code></td>
<td>
<p>The input vector with illegal values removed</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Dewey</p>


<h3>References</h3>

<p>Edgington ES (1972).
&ldquo;An additive method for combining probability values from independent experiments.&rdquo;
<em>Journal of Psychology</em>, <b>80</b>, 351&ndash;363.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+plotp">plotp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dat.metap)
edgington &lt;- dat.metap$edgington
sump(edgington) # p = 0.097
</code></pre>

<hr>
<h2 id='sumz'>Combine p-values using the sum of z (Stouffer's) method</h2><span id='topic+sumz'></span><span id='topic+Stouffer+27s+20method'></span><span id='topic+Sum+20of+20normals+20method'></span><span id='topic+print.sumz'></span>

<h3>Description</h3>

<p>Combine \(p\)-values using the sum z method<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class='language-R'>sumz(p, weights = NULL, data = NULL, subset = NULL, na.action = na.fail,
   log.p = FALSE, log.input = FALSE)
## S3 method for class 'sumz'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sumz_+3A_p">p</code></td>
<td>
<p>A vector of significance values</p>
</td></tr>
<tr><td><code id="sumz_+3A_weights">weights</code></td>
<td>
<p>A vector of weights</p>
</td></tr>
<tr><td><code id="sumz_+3A_data">data</code></td>
<td>
<p>Optional data frame containing variables</p>
</td></tr>
<tr><td><code id="sumz_+3A_subset">subset</code></td>
<td>
<p>Optional vector of logicals to specify
a subset of the \(p\)-values</p>
</td></tr>
<tr><td><code id="sumz_+3A_na.action">na.action</code></td>
<td>
<p>A function indicating what should happen when data
contains NAs</p>
</td></tr>
<tr><td><code id="sumz_+3A_log.p">log.p</code></td>
<td>
<p>Logical, if TRUE result is returned as log(p)</p>
</td></tr>
<tr><td><code id="sumz_+3A_log.input">log.input</code></td>
<td>
<p>Logical, if TRUE the input \(p\) values are assumed to be logged</p>
</td></tr>
<tr><td><code id="sumz_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>sumz</code>&rsquo;</p>
</td></tr>
<tr><td><code id="sumz_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed through</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Defined as \[\frac{\sum_{i=1}^k  w_i z(p_i)}{\sqrt {\sum_{i=1}^k  w_i ^ 2}}\]
is a \(z\) where \(k\) is the number of studies
and \(w\) are the weights (Stouffer et al. 1949).
By default the weights are equal.
In the absence of effect sizes (in which case a method for
combining effect sizes would be more appropriate anyway)
best results are believed to be obtained with weights
proportional to the square root of the sample sizes
(Zaykin 2011)
</p>


<p>The values of \(p_i\) should be such that \(0 < p_i < 1\) and a warning is given if that is not true. A warning is given if, possibly as a result of removing illegal values, fewer than two values remain and the return values are set to NA. If the omitted \(p\) values had supplied weights
a further warning is issued.
</p>
<p>The plot method for class &lsquo;<code>metap</code>&rsquo; calls <code><a href="#topic+plotp">plotp</a></code> on the valid <i>p</i>-values.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;<code>sumz</code>&rsquo; and
&lsquo;<code>metap</code>&rsquo;, a list with entries
</p>
<table>
<tr><td><code>z</code></td>
<td>
<p>Transformed sum of \(z\) values</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Associated \(p\)-value</p>
</td></tr>
<tr><td><code>validp</code></td>
<td>
<p>The input vector with illegal values removed</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>The weight vector corresponding to <code>validp</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Dewey</p>


<h3>References</h3>

<p>Becker BJ (1994).
&ldquo;Combining significance levels.&rdquo;
In Cooper H, Hedges LV (eds.), <em>A handbook of research synthesis</em>, 215&ndash;230.
Russell Sage, New York.<br /><br /> Rosenthal R (1978).
&ldquo;Combining results of independent studies.&rdquo;
<em>Psychological Bulletin</em>, <b>85</b>, 185&ndash;193.<br /><br /> Stouffer SA, Suchman EA, DeVinney LC, Star SA, Williams RMJ (1949).
<em>The American soldier, vol 1: Adjustment during army life</em>.
Princeton University Press, Princeton.<br /><br /> Zaykin DV (2011).
&ldquo;Optimally weighted <i>Z</i>&ndash;test is a powerful method for combining probabilities in meta&ndash;analysis.&rdquo;
<em>Journal of Evolutionary Biology</em>, <b>24</b>, 1836&ndash;1841.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+plotp">plotp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dat.metap)
teachexpect &lt;- dat.metap$teachexpect
sumz(teachexpect) # z = 2.435, p = 0.0074, from Becker
beckerp &lt;- dat.metap$beckerp
sumz(beckerp) # z = 1.53, NS, from Beckerp
rosenthal &lt;- dat.metap$rosenthal
sumz(rosenthal$p) # 2.39, p = 0.009
sumz(p, df, rosenthal) # 3.01, p = 0.0013
validity &lt;- dat.metap$validity$p
sumz(validity) # z = 8.191, p = 1.25 * 10^{-16}
all.equal(exp(sumz(validity, log.p = TRUE)$p), sumz(validity)$p)
all.equal(sumz(log(validity), log.input = TRUE)$p, sumz(validity)$p)
</code></pre>

<hr>
<h2 id='truncated'>Truncated product method routine</h2><span id='topic+truncated'></span><span id='topic+print.truncated'></span><span id='topic+summary.truncated'></span><span id='topic+plot.truncated'></span>

<h3>Description</h3>

<p>Implements two procedures for truncated versions
of Fisher's method<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class='language-R'>truncated(p, ptrunc = NULL, rtrunc = NULL, ...)
## S3 method for class 'truncated'
print(x, ...)
## S3 method for class 'truncated'
summary(object, ...)
## S3 method for class 'truncated'
plot(x, pparams = list(pchs = c(16, 1),
   pcols = c("black", "black")), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="truncated_+3A_p">p</code></td>
<td>
<p>A vector of significance values</p>
</td></tr>
<tr><td><code id="truncated_+3A_ptrunc">ptrunc</code></td>
<td>
<p>Value of \(p\) to truncate at. See Details</p>
</td></tr>
<tr><td><code id="truncated_+3A_rtrunc">rtrunc</code></td>
<td>
<p>Which rank \(p\) to truncate at. See Details</p>
</td></tr>
<tr><td><code id="truncated_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>truncated</code>&rsquo;</p>
</td></tr>
<tr><td><code id="truncated_+3A_object">object</code></td>
<td>
<p>An object of class &lsquo;<code>truncated</code>&rsquo;</p>
</td></tr>
<tr><td><code id="truncated_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed through</p>
</td></tr>
<tr><td><code id="truncated_+3A_pparams">pparams</code></td>
<td>
<p>A list containing a vector <code>pchs</code> of plotting
symbols and a vector <code>pcols</code> of colours</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses routines from TFisher to implement
truncated Fisher (Zaykin et al. 2007; Zhang et al. 2018)
and from mutoss to implement
rank-truncated Fisher (Dudbridge and Koeleman 2003)
</p>
<p>The print method prints the statistic and its associated
\(p\)-value. The summary method also prints how many
of the input values were actually used. The plot method
provides an index plot of the \(p\)-values.
By default used \(p\)-values are plotted
with a black filled circle and those not used with a black
unfilled circle. The colours and plotting symbols can be changed
in <code>pparams</code>. The first element of each vector is for the
used \(p\)-values and the second for the unused ones.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;<code>truncated</code>&rsquo;
a list with entries
</p>
<table>
<tr><td><code>p</code></td>
<td>
<p>The resultant overall \(p\)-value</p>
</td></tr>
<tr><td><code>stat</code></td>
<td>
<p>The test statistic</p>
</td></tr>
<tr><td><code>validp</code></td>
<td>
<p>The input vector with illegal values removed</p>
</td></tr>
<tr><td><code>ptrunc</code></td>
<td>
<p>The \(p\)-value used for truncation</p>
</td></tr>
<tr><td><code>trunc</code></td>
<td>
<p>The  rank value used for truncation</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>A vector containing <code>incl</code>, the number
of valid values included, <code>excl</code>, the number of valid
values not used</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The method used</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Only one of <code>ptrunc</code> or <code>rtrunc</code> is returned
as appropriate. If the function encounters an error
it returns NA for the value of <code>p</code> and gives
a warning message.
The effect of specifying both <code>ptrunc</code>
and <code>rtrunc</code> is undefined.
</p>


<h3>Author(s)</h3>

<p>Michael Dewey
</p>


<h3>References</h3>

<p>Dudbridge F, Koeleman BPC (2003).
&ldquo;Rank truncated product of <i>P</i>&ndash;values, with application to genomewide association scans.&rdquo;
<em>Genetic Epidemiology</em>, <b>25</b>, 360&ndash;366.<br /><br /> Zaykin DV, Zhivotovsky LA, Czika W, Shao S, Wolfinger RD (2007).
&ldquo;Combining p&ndash;values in large&ndash;scale genomics experiments.&rdquo;
<em>Pharmaceutical Statistics</em>, <b>6</b>, 217&ndash;236.<br /><br /> Zhang H, Tong T, Landers J, Wu Z (2018).
&ldquo;TFisher tests: optimal and adaptive thresholding for combining <i>p</i>&ndash;values.&rdquo;
<em>arXiv</em>.
<a href="https://arxiv.org/abs/1801.04309">https://arxiv.org/abs/1801.04309</a>.
</p>


<h3>See Also</h3>

<p><code>ranktruncated</code>, <code>stat.tpm</code>, and <code>p.tpm</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dat.metap)
validity &lt;- dat.metap$validity
truncated(validity, ptrunc = 0.5)
truncated(validity, rtrunc = 5)
</code></pre>

<hr>
<h2 id='two2one'>Convert two-sided p-values to one-sided</h2><span id='topic+two2one'></span>

<h3>Description</h3>

<p>Convert two-sided p-values to one-sided<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class='language-R'>two2one(p, two = NULL, invert = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="two2one_+3A_p">p</code></td>
<td>
<p>A vector of p-values</p>
</td></tr>
<tr><td><code id="two2one_+3A_two">two</code></td>
<td>
<p>A logical vector defining which
\(p\)-values are two-sided and to be converted</p>
</td></tr>
<tr><td><code id="two2one_+3A_invert">invert</code></td>
<td>
<p>A logical vector defining which
\(p\)-values are to be inverted</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The \(p\)-values supplied to the other functions should be
one-sided and all in the same direction.
This convenience function will convert two-sided to
one-sided and invert as necessary.
By default it is assumed that all \(p\)-values are two-sided
and the function converts them all to one-sided.
Use <code>invert</code> to specify if some of the tests
resulted in outcomes in the other direction.
So for example a value of 0.05 will be converted to 0.025 unless
<code>invert</code> is TRUE in which case it is converted to 0.975.</p>


<h3>Value</h3>

<p>A vector of one-sided \(p\)-values all in the correct direction
</p>


<h3>Author(s)</h3>

<p>Michael Dewey</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dat.metap)
rosenthal &lt;- dat.metap$rosenthal
twop &lt;- with(rosenthal, (pt(t, df)))
two2one(twop, two = rep(FALSE, 5), invert = rep(TRUE, 5)) # restore to one-sided
</code></pre>

<hr>
<h2 id='votep'>Combine p-values by the vote counting method</h2><span id='topic+votep'></span><span id='topic+print.votep'></span>

<h3>Description</h3>

<p>Combine \(p\)-values by the vote counting method<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>votep(p, alpha = 0.5)
## S3 method for class 'votep'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="votep_+3A_p">p</code></td>
<td>
<p>A vector of significance values</p>
</td></tr>
<tr><td><code id="votep_+3A_alpha">alpha</code></td>
<td>
<p>A value defining the significance value limits, see Details</p>
</td></tr>
<tr><td><code id="votep_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>votep</code>&rsquo;</p>
</td></tr>
<tr><td><code id="votep_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed through</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default splits the \(p\)-values at 0.5 with those below
counting as positive and those above counting as
negative.
However setting alpha
allows specifying a neutral zone.
In that case values between alpha and 1 - alpha will be
assumed to be neutral and only those outside the zone
counted as positive or negative.
If the value of alpha is greater than unity
it is assumed to be a percentage.
</p>
<p>The values of \(p_i\) should be such that \(0 < p_i < 1\) and a warning is given if that is not true. A warning is given if, possibly as a result of removing illegal values, fewer than two values remain and the return values are set to NA.
</p>
<p>The plot method for class &lsquo;<code>metap</code>&rsquo; calls <code><a href="#topic+plotp">plotp</a></code> on the valid <i>p</i>-values.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;<code>votep</code>&rsquo;
and &lsquo;<code>votep</code>&rsquo;, a list with entries
</p>
<table>
<tr><td><code>p</code></td>
<td>
<p>\(p\) value</p>
</td></tr>
<tr><td><code>pos</code></td>
<td>
<p>Number of positives</p>
</td></tr>
<tr><td><code>neg</code></td>
<td>
<p>Number of negatives</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>The cut&ndash;off significance value lying in the range 0 to 1</p>
</td></tr>
<tr><td><code>validp</code></td>
<td>
<p>The input vector with illegal values removed</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Dewey</p>


<h3>References</h3>

<p>Becker BJ (1994).
&ldquo;Combining significance levels.&rdquo;
In Cooper H, Hedges LV (eds.), <em>A handbook of research synthesis</em>, 215&ndash;230.
Russell Sage, New York.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+plotp">plotp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dat.metap)
beckerp &lt;- dat.metap$beckerp
votep(beckerp)
</code></pre>

<hr>
<h2 id='wilkinsonp'>Combine p-values using Wilkinson's method</h2><span id='topic+wilkinsonp'></span><span id='topic+maximump'></span><span id='topic+minimump'></span><span id='topic+Tippett+27s+20method'></span><span id='topic+print.wilkinsonp'></span><span id='topic+print.maximump'></span><span id='topic+print.minimump'></span>

<h3>Description</h3>

<p>Combine \(p\)-values using Wilkinson's method<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class='language-R'>wilkinsonp(p, r = 1, alpha = 0.05, log.p = FALSE)
maximump(p, alpha = 0.05, log.p = FALSE)
minimump(p, alpha = 0.05, log.p = FALSE)
## S3 method for class 'wilkinsonp'
print(x, ...)
## S3 method for class 'maximump'
print(x, ...)
## S3 method for class 'minimump'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wilkinsonp_+3A_p">p</code></td>
<td>
<p>A vector of significance values</p>
</td></tr>
<tr><td><code id="wilkinsonp_+3A_r">r</code></td>
<td>
<p>Use the \(r\)th  smallest \(p\) value</p>
</td></tr>
<tr><td><code id="wilkinsonp_+3A_alpha">alpha</code></td>
<td>
<p>The significance level</p>
</td></tr>
<tr><td><code id="wilkinsonp_+3A_log.p">log.p</code></td>
<td>
<p>Logical, if TRUE result is returned as log(p)</p>
</td></tr>
<tr><td><code id="wilkinsonp_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>wilkinsonp</code>&rsquo;
or of class &lsquo;<code>maximump</code>&rsquo;
or of class &lsquo;<code>minimump</code>&rsquo;</p>
</td></tr>
<tr><td><code id="wilkinsonp_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed through</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Wilkinson (Wilkinson 1951)
originally proposed his method in the context of
simultaneous statistical inference: the probability
of obtaining \(r\) or more significant statistics by
chance in a group of \(k\).
The values are obtained from the Beta distribution, see
<code><a href="stats.html#topic+pbeta">pbeta</a></code>.
</p>
<p>If <code>alpha</code> is greater than unity
it is assumed to be a percentage. Either values greater than 0.5 (assumed to
be confidence coefficient) or less than 0.5 are accepted.
</p>
<p>The values of \(p_i\) should be such that \(0\le p_i\le 1\) and a warning is given if that is not true. A warning is given if, possibly as a result of removing illegal values, fewer than two values remain and the return values are set to NA.
</p>
<p><code>maximump</code> and
<code>minimump</code> each provide a wrapper for <code>wilkinsonp</code>
for the special case when \(r = \mathrm{length}(p)\)
or \(r=1\) respectively and each has its own
print method.
The method of minimum \(p\) is also known as Tippett's method
(Tippett 1931).

</p>
<p>The plot method for class &lsquo;<code>metap</code>&rsquo; calls <code><a href="#topic+plotp">plotp</a></code> on the valid <i>p</i>-values.
Inspection of the distribution of \(p\)-values is highly recommended as extreme values in opposite directions do not cancel out. See last example. This may not be what you want.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;<code>wilkinsonp</code>&rsquo;
and &lsquo;<code>metap</code>&rsquo; or of class &lsquo;<code>maximump</code>&rsquo;
and &lsquo;<code>metap</code>&rsquo; or of class &lsquo;<code>minimump</code>&rsquo;
and &lsquo;<code>metap</code>&rsquo;,
a list with entries
</p>
<table>
<tr><td><code>p</code></td>
<td>
<p>The \(p\)-value resulting from the meta&ndash;analysis</p>
</td></tr>
<tr><td><code>pr</code></td>
<td>
<p>The \(r\)th smallest \(p\) value used</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>The value of \(r\)</p>
</td></tr>
<tr><td><code>critp</code></td>
<td>
<p>The critical value at which the \(r\)th value
would have been significant for the chosen <code>alpha</code></p>
</td></tr>
<tr><td><code>validp</code></td>
<td>
<p>The input vector with illegal values removed</p>
</td></tr>

</table>


<h3>Note</h3>

<p>The value of <code>critp</code> is always on the raw scale even
if <code>log.p</code> has been set to TRUE</p>


<h3>Author(s)</h3>

<p>Michael Dewey</p>


<h3>References</h3>

<p>Becker BJ (1994).
&ldquo;Combining significance levels.&rdquo;
In Cooper H, Hedges LV (eds.), <em>A handbook of research synthesis</em>, 215&ndash;230.
Russell Sage, New York.<br /><br /> Birnbaum A (1954).
&ldquo;Combining independent tests of significance.&rdquo;
<em>Journal of the American Statistical Association</em>, <b>49</b>, 559&ndash;574.<br /><br /> Tippett LHC (1931).
<em>The methods of statistics</em>.
Williams and Norgate, London.<br /><br /> Wilkinson B (1951).
&ldquo;A statistical consideration in psychological research.&rdquo;
<em>Psychological Bulletin</em>, <b>48</b>, 156&ndash;158.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+plotp">plotp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dat.metap)
beckerp &lt;- dat.metap$beckerp
minimump(beckerp) # signif = FALSE, critp = 0.0102, minp = 0.016
teachexpect &lt;- dat.metap$teachexpect
minimump(teachexpect) # crit 0.0207, note Becker says minp = 0.0011
wilkinsonp(c(0.223, 0.223), r = 2) # Birnbaum, just signif
validity &lt;- dat.metap$validity$p
minimump(validity) # minp = 0.00001, critp = 1.99 * 10^{-4}
minimump(c(0.0001, 0.0001, 0.9999, 0.9999)) # is significant
all.equal(exp(minimump(validity, log.p = TRUE)$p), minimump(validity)$p)
all.equal(exp(maximump(validity, log.p = TRUE)$p), maximump(validity)$p)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
