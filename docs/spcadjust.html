<!DOCTYPE html><html><head><title>Help for package spcadjust</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {spcadjust}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cardiacsurgery'><p>Cardiac surgery data</p></a></li>
<li><a href='#getcdfupdates'><p>CDF of Updates of a Control Chart</p></a></li>
<li><a href='#getq'><p>Returns a List to Compute Properties of a chart</p></a></li>
<li><a href='#runchart'><p>Runs a chart</p></a></li>
<li><a href='#SPC2sidedconfint'><p>Computes a two-sided confidence interval for properties of a control chart.</p></a></li>
<li><a href='#SPCchart-class'><p>Virtual Base Class for Control Charts</p></a></li>
<li><a href='#SPCCUSUM-class'><p>CUSUM Charts</p></a></li>
<li><a href='#SPCDataModel-class'><p>Data Model for SPC charts</p></a></li>
<li><a href='#SPCEWMA-class'><p>EWMA Charts</p></a></li>
<li><a href='#SPCModellm'><p>Data model based on a linear model</p></a></li>
<li><a href='#SPCModellogregLikRatio'><p>Data Model for Binary Responses using a logarithmic model and likelihood ratio updates.</p></a></li>
<li><a href='#SPCModellogregOE'><p>Data Model for Binary Responses using a Logarithmic Model and observed minus expected updates.</p></a></li>
<li><a href='#SPCModelNonpar'><p>Generic Model for Nonparametric Resampling</p></a></li>
<li><a href='#SPCModelNonparCenterScale'><p>Nonparametric Resampling with Centering and Scaling</p></a></li>
<li><a href='#SPCModelNormal'><p>Parametric Model for Normally Distributed Data with Centering and Scaling</p></a></li>
<li><a href='#SPCproperty'><p>Computes bootstrap adjusted properties for control charts</p></a></li>
<li><a href='#SPCpropertyres-class'><p>Results of SPCproperty.</p></a></li>
<li><a href='#SPCShew-class'><p>Shewhart charts.</p></a></li>
<li><a href='#updates'><p>Updates of a Control Chart</p></a></li>
<li><a href='#xiofdata'><p>Estimate Chart Parameters</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-11-20</td>
</tr>
<tr>
<td>Title:</td>
<td>Functions for Calibrating Control Charts</td>
</tr>
<tr>
<td>Author:</td>
<td>Axel Gandy &lt;a.gandy@imperial.ac.uk&gt; and Jan Terje Kvaloy
    &lt;jan.t.kvaloy@uis.no&gt;.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Axel Gandy &lt;a.gandy@imperial.ac.uk&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, stats, utils, graphics</td>
</tr>
<tr>
<td>Description:</td>
<td>Calibration of thresholds of control charts such as
    CUSUM charts based on past data, taking estimation error into account.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, parallel, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Collate:</td>
<td>'CUSUMlib.R' 'model.R' 'main.R' 'CUSUM.R' 'EWMAlib.R' 'EWMA.R'
'data.R' 'lm.R' 'logreg.R' 'shewhart.R'</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-09-29 08:54:58 UTC; agandy</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-09-29 11:37:35</td>
</tr>
</table>
<hr>
<h2 id='cardiacsurgery'>Cardiac surgery data</h2><span id='topic+cardiacsurgery'></span>

<h3>Description</h3>

<p>A dataset describing the results of cardiac surgery. The data give
information about the date of surgery, surgeon, Parsonnet score and
outcome up to 90 days after surgery.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cardiacsurgery)
</code></pre>


<h3>Format</h3>

<p>A data frame with  5595 rows and 5 variables:
</p>

<table>
<tr>
 <td style="text-align: left;">
  date:</td><td style="text-align: left;"> date of the operation in days since the beginning of study </td>
</tr>
<tr>
 <td style="text-align: left;">
  time:</td><td style="text-align: left;"> number of days between surgery and the earlier of death and 90 days</td>
</tr>
<tr>
 <td style="text-align: left;">
  status:</td><td style="text-align: left;"> status at endpoint, 0/1 for censored/dead</td>
</tr>
<tr>
 <td style="text-align: left;">
  Parsonnet:</td><td style="text-align: left;"> Parsonnet score of the patient</td>
</tr>
<tr>
 <td style="text-align: left;">
  surgeon:</td><td style="text-align: left;"> surgeon performing the operation, numbered from 1 to 7</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<h3>Source</h3>

<p>Based on the data described in Steiner et al (2000). A
subset of the data has been selected, some noise has been
introduced and the follow-up was censored at 90 days.
</p>


<h3>References</h3>

<p>Steiner SH, Cook RJ, Farewell VT, Treasure T (2000).
Monitoring surgical performance using risk-adjusted cumulative sum
charts. Biostat 1(4) 441-452.
</p>

<hr>
<h2 id='getcdfupdates'>CDF of Updates of a Control Chart</h2><span id='topic+getcdfupdates'></span><span id='topic+getcdfupdates+2CSPCShew-method'></span><span id='topic+getcdfupdates+2CSPCchart-method'></span>

<h3>Description</h3>

<p>Consider running a control chart with given parameters with data
coming from a given probability model. This function computes the
cumulative distribution function (CDF) of the updates of the
control charts as they would be computed by the method <code><a href="#topic+updates">updates</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getcdfupdates(chart, P, xi)

## S4 method for signature 'SPCchart'
getcdfupdates(chart, P, xi)

## S4 method for signature 'SPCShew'
getcdfupdates(chart, P, xi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getcdfupdates_+3A_chart">chart</code></td>
<td>
<p>the chart to be used.</p>
</td></tr>
<tr><td><code id="getcdfupdates_+3A_p">P</code></td>
<td>
<p>the probability model from which data is generated.</p>
</td></tr>
<tr><td><code id="getcdfupdates_+3A_xi">xi</code></td>
<td>
<p>the parameters of the control chart.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A function mapping one-dimensional numerical values into
the interval [0,1], having all properties of a cumulative
distribution function.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>SPCchart</code>: Standard method which simply first applies
getcdfresiduals from the data model.
</p>
</li>
<li> <p><code>SPCShew</code>: Computes the CDF of the updates taking
into account if the chart is one-sided or two-sided.
</p>
</li></ul>

<hr>
<h2 id='getq'>Returns a List to Compute Properties of a chart</h2><span id='topic+getq'></span><span id='topic+getq+2CSPCCUSUM-method'></span><span id='topic+getq+2CSPCEWMA-method'></span><span id='topic+getq+2CSPCShew-method'></span>

<h3>Description</h3>

<p>Returns functions to compute desired properties of a given
control chart.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getq(chart, property, params)

## S4 method for signature 'SPCCUSUM'
getq(chart, property, params)

## S4 method for signature 'SPCEWMA'
getq(chart, property, params)

## S4 method for signature 'SPCShew'
getq(chart, property, params)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getq_+3A_chart">chart</code></td>
<td>
<p>the chart to be used.</p>
</td></tr>
<tr><td><code id="getq_+3A_property">property</code></td>
<td>
<p>the name of the property.</p>
</td></tr>
<tr><td><code id="getq_+3A_params">params</code></td>
<td>
<p>additional parameters needed for the computations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the elements <code>q</code>, <code>trafo</code>, <code>lowerconf</code>, <code>format</code>.
</p>

<ul>
<li><p><code>q(P,xi)</code>: The transformed property of interest. To improve the bootstrap a log transform is used for <code>calARL</code>,<code>calhitprob</code> and <code>ARL</code>, and a logit transform for <code>hitprob</code>. This function depends on the distribution of updates <code>P</code> and the chart parameters <code>xi</code>. 
</p>
</li>
<li><p><code>trafo(x)</code>: The inverse of the transformation of the property used in the bootstrap. Needed to back-transform the result to the correct scale. 
</p>
</li>
<li><p><code>lowerconf</code>: Logical value. TRUE if a lower confidence interval should be reported, FALSE otherwise. Default is TRUE for properties <code>calARL</code>,  <code>calhitprob</code> and <code>hitprob</code> and FALSE for <code>ARL</code>. 
</p>
</li>
<li><p><code>format(res)</code>: Output summary given as a text string. 
</p>
</li></ul>



<h3>Methods (by class)</h3>


<ul>
<li> <p><code>SPCCUSUM</code>: Implements the properties <code>ARL</code>,
<code>calARL</code>, <code>hitprob</code> and <code>calhitprob</code>.
</p>
</li>
<li> <p><code>SPCEWMA</code>: Implements the properties <code>ARL</code>,
<code>calARL</code>, <code>hitprob</code> and <code>calhitprob</code>.
</p>
</li>
<li> <p><code>SPCShew</code>: Implements the properties <code>ARL</code>,
<code>calARL</code>, <code>hitprob</code> and <code>calhitprob</code>.
</p>
</li></ul>

<hr>
<h2 id='runchart'>Runs a chart</h2><span id='topic+runchart'></span><span id='topic+runchart+2CSPCCUSUM-method'></span><span id='topic+runchart+2CSPCEWMA-method'></span><span id='topic+runchart+2CSPCShew-method'></span>

<h3>Description</h3>

<p>Generic method for running a chart on new data using given
parameters <code>xi</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runchart(chart, newdata, xi)

## S4 method for signature 'SPCCUSUM'
runchart(chart, newdata, xi)

## S4 method for signature 'SPCEWMA'
runchart(chart, newdata, xi)

## S4 method for signature 'SPCShew'
runchart(chart, newdata, xi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runchart_+3A_chart">chart</code></td>
<td>
<p>the chart to be used.</p>
</td></tr>
<tr><td><code id="runchart_+3A_newdata">newdata</code></td>
<td>
<p>the new observed data.</p>
</td></tr>
<tr><td><code id="runchart_+3A_xi">xi</code></td>
<td>
<p>the parameters to be used in running the chart.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The path of the chart over time.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>SPCCUSUM</code>: Generic function for running CUSUM
charts. Relies on <code><a href="#topic+updates">updates</a></code> being implemented for the
chart.
</p>
</li>
<li> <p><code>SPCEWMA</code>: Generic function for running EWMA
charts. Relies on <code><a href="#topic+updates">updates</a></code> being implemented for the
chart.
</p>
</li>
<li> <p><code>SPCShew</code>: Simply computes the updates appropriate for
the Shewhart chart and returns them.
</p>
</li></ul>

<hr>
<h2 id='SPC2sidedconfint'>Computes a two-sided confidence interval for properties of a control chart.</h2><span id='topic+SPC2sidedconfint'></span>

<h3>Description</h3>

<p>Computes a two-sided confidence interval for properties of a control chart.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SPC2sidedconfint(covprob = 0.9, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SPC2sidedconfint_+3A_covprob">covprob</code></td>
<td>
<p>The coverage probability of the adjustment.</p>
</td></tr>
<tr><td><code id="SPC2sidedconfint_+3A_...">...</code></td>
<td>
<p>Parameters to be passed to SPCproperty</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The desired confidence interval, a vector of length 2.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SPCproperty">SPCproperty</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Compute 2-sided CI for the ARL of a CUSUM control chart assuming normality.
 X &lt;-  rnorm(100) #observed data
 chart &lt;- new("SPCCUSUM",model=SPCModelNormal(Delta=1)) # CUSUM chart with normal observations
 SPC2sidedconfint(data=X,nrep=100,covprob=0.95,
            property="ARL",chart=chart,params=list(threshold=4))

</code></pre>

<hr>
<h2 id='SPCchart-class'>Virtual Base Class for Control Charts</h2><span id='topic+SPCchart-class'></span>

<h3>Description</h3>

<p>Virtual S4 base class for Control Charts.
</p>


<h3>Slots</h3>


<dl>
<dt><code>model</code></dt><dd><p>The data model to be used in the chart. Must be of type
<code><a href="#topic+SPCDataModel">SPCDataModel</a></code>.</p>
</dd>
</dl>

<hr>
<h2 id='SPCCUSUM-class'>CUSUM Charts</h2><span id='topic+SPCCUSUM-class'></span>

<h3>Description</h3>

<p>Class extending SPCChart with a basic  CUSUM charts implementation.
</p>


<h3>Details</h3>

<p>The only slot this class contains is the data model. This data
model should already incorporate the negative mean for in-control
updates that is typical for CUSUM charts.
</p>
<p>Let <code class="reqn">U_t, t=1,2,\dots</code> be the updates from the data model. Then
the CUSUM chart is given by <code class="reqn">S_0=0</code> and
</p>
<p style="text-align: center;"><code class="reqn">S_t=max(S_{t-1}+U_t,0)</code>
</p>



<h3>Examples</h3>

<pre><code class='language-R'>X &lt;-  rnorm(1000)
chart &lt;- new("SPCCUSUM",model=SPCModelNormal(Delta=1))
## Not run: 
SPCproperty(data=X,nrep=10,chart=chart,
            property="calARL",params=list(target=100))
SPCproperty(data=X,nrep=10,chart=chart,
            property="calhitprob",params=list(target=0.05,nsteps=1e3))
SPCproperty(data=X,nrep=10,chart=chart,
            property="ARL",params=list(threshold=3))

## End(Not run)
SPCproperty(data=X,nrep=10,chart=chart,
            property="hitprob",params=list(threshold=3,nsteps=1e3))
#increase the number of repetitions nrep for real applications.

</code></pre>

<hr>
<h2 id='SPCDataModel-class'>Data Model for SPC charts</h2><span id='topic+SPCDataModel'></span><span id='topic+SPCDataModel-class'></span>

<h3>Description</h3>

<p>This is the basic structure for converting observations (data) into
updates for control charts. Classes of this type also have the
ability to generate new data sets (resampling).
</p>


<h3>Details</h3>

<p>Every element of this class has to consist of a list of the
following functions: updates, getcdfupdates, Pofdata,
resample, xiofP, which have to be of a specific form.  The arguments generally have the
following meaning: <code>xi</code> denotes the parameter vector needed to create
updates for running the chart from observed data, <code>data</code> is
observed data, <code>P</code> is a data model.
</p>

<ul>
<li> <p><code>updates(xi,data)</code>:  Returns updates for the chart using the parameter <code>xi</code> and the observed data <code>data</code>.
</p>
</li>
<li> <p><code>Pofdata(data)</code>:  Estimates a probability model from the data.
</p>
</li>
<li><p> xiofP(P): Computes the parameter <code>xi</code> needed to compute updates from an (estimated) probability model <code>P</code>.
</p>
</li>
<li> <p><code>resample(P)</code>: Generates a new data set from the probability model <code>P</code>.
</p>
</li>
<li> <p><code>getcdfupdates(P,xi,cadlag=TRUE)</code>: Returns the cumulative distribution function (CDF) of updates of data generated from the probability model <code>P</code> and computed using the parameter <code>xi</code>. The CDF has to be a function of one argument that also accepts vectors. If cadlag is  TRUE then the CDF is right-continuous (i.e. <code class="reqn">F(x)=P(X\le x)</code>). If cadlag is FALSE then the CDF is left-continuous (i.e. <code class="reqn">F(x) = P(X&lt;x)</code>).
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+SPCModelNormal">SPCModelNormal</a></code>,
<code><a href="#topic+SPCModelNonpar">SPCModelNonpar</a></code>,
<code><a href="#topic+SPCModelNonparCenterScale">SPCModelNonparCenterScale</a></code>
</p>

<hr>
<h2 id='SPCEWMA-class'>EWMA Charts</h2><span id='topic+SPCEWMA-class'></span>

<h3>Description</h3>

<p>Class extending SPCChart with a basic  EWMA charts implementation.
</p>


<h3>Details</h3>

<p>Let <code class="reqn">Y_t, t=1,2,\dots</code> be the updates from the data model. Then
the EWMA chart is given by <code class="reqn">Q_0=0</code> and
</p>
<p style="text-align: center;"><code class="reqn">Q_t=lambda Y_t+(1-lambda) Q_{t-1}</code>
</p>



<h3>Slots</h3>


<dl>
<dt><code>model</code></dt><dd><p>The data model. The  data  model should center the in-control
updates such that they have mean 0.</p>
</dd>
<dt><code>lambda</code></dt><dd><p>The smoothing constant, <code class="reqn">0&lt;lambda&lt;=1</code>.</p>
</dd>
</dl>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;-  rnorm(1000)
chart &lt;- new("SPCEWMA",model=SPCModelNormal(Delta=0),lambda=0.8)
## Not run: 
SPCproperty(data=X,nrep=10,chart=chart,
            property="calARL",params=list(target=100))
SPCproperty(data=X,nrep=10,chart=chart,
            property="calhitprob",params=list(target=0.05,nsteps=1e3))

## End(Not run)
SPCproperty(data=X,nrep=10,chart=chart,
            property="ARL",params=list(threshold=3))
SPCproperty(data=X,nrep=10,chart=chart,
            property="hitprob",params=list(threshold=3,nsteps=1e3))
#increase the number of repetitions nrep for real applications.

</code></pre>

<hr>
<h2 id='SPCModellm'>Data model based on a linear model</h2><span id='topic+SPCModellm'></span>

<h3>Description</h3>

<p>The parameters needed for running the chart are the fitted linear
model. Resampled data sets are created by resampling cases with
replacement (i.e. keeping observations together).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SPCModellm(formula, Delta = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SPCModellm_+3A_formula">formula</code></td>
<td>
<p>the linear model specified as a formula.</p>
</td></tr>
<tr><td><code id="SPCModellm_+3A_delta">Delta</code></td>
<td>
<p>Object of class <code>"numeric"</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 1000
Xlinreg &lt;- data.frame(x1= rbinom(n,1,0.4), x2= runif(n,0,1), x3= rnorm(n))
Xlinreg$y &lt;- 2 + Xlinreg$x1 + Xlinreg$x2 + Xlinreg$x3 + rnorm(n)
## Not run: 
chartlinregCUSUM &lt;- new("SPCCUSUM", model=SPCModellm(Delta=1,formula="y~x1+x2+x3"))
SPCproperty(data=Xlinreg,nrep=10,property="calARL",
            chart=chartlinregCUSUM,params=list(target=100))
#increase nrep in real applications.
#' chartlinregCUSUM2 &lt;- new("SPCCUSUM",model=SPCModellm(Delta=1,formula="y~x1"))
SPCproperty(data=Xlinreg,nrep=10,property="calARL",
            chart=chartlinregCUSUM2,params=list(target=100))
#increase nrep in real applications.

chartlinregEWMA &lt;- new("SPCEWMA", model=SPCModellm(Delta=0,formula="y~x1+x2+x3"),lambda=0.8)
SPCproperty(data=Xlinreg,nrep=10,property="calARL",
            chart=chartlinregEWMA,params=list(target=100))
#increase nrep in real applications.

chartlinregEWMA2 &lt;- new("SPCEWMA",model=SPCModellm(Delta=0,formula="y~x1"),lambda=0.8)
SPCproperty(data=Xlinreg,nrep=10,property="calARL",
            chart=chartlinregEWMA2,params=list(target=100))

## End(Not run)
#increase nrep in real applications.
</code></pre>

<hr>
<h2 id='SPCModellogregLikRatio'>Data Model for Binary Responses using a logarithmic model and likelihood ratio updates.</h2><span id='topic+SPCModellogregLikRatio'></span>

<h3>Description</h3>

<p>Data Model for Binary Responses using a logarithmic model and likelihood ratio updates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SPCModellogregLikRatio(formula, Delta = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SPCModellogregLikRatio_+3A_formula">formula</code></td>
<td>
<p>The formula of the model.</p>
</td></tr>
<tr><td><code id="SPCModellogregLikRatio_+3A_delta">Delta</code></td>
<td>
<p>This value will be added to the log odds ratio in the
out-of-control model in the likelihood ratio between the
out-of-control and the in-control model constituting the updates.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 1000
Xlogreg &lt;- data.frame(x1=rbinom(n,1,0.4), x2=runif(n,0,1), x3=rnorm(n))
xbeta &lt;- -1+Xlogreg$x1*100+Xlogreg$x2+Xlogreg$x3
Xlogreg$y &lt;- rbinom(n,1,exp(xbeta)/(1+exp(xbeta)))
chartlogreg &lt;- new("SPCCUSUM",
                   model=SPCModellogregLikRatio(Delta= 1, formula="y~x1+x2+x3"))
SPCproperty(data=Xlogreg,nrep=10,property="calARL",
            chart=chartlogreg,params=list(target=100))
#increase nrep for real applications.
</code></pre>

<hr>
<h2 id='SPCModellogregOE'>Data Model for Binary Responses using a Logarithmic Model and observed minus expected updates.</h2><span id='topic+SPCModellogregOE'></span>

<h3>Description</h3>

<p>Data Model for Binary Responses using a Logarithmic Model and observed minus expected updates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SPCModellogregOE(formula, Delta = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SPCModellogregOE_+3A_formula">formula</code></td>
<td>
<p>The formula of the model.</p>
</td></tr>
<tr><td><code id="SPCModellogregOE_+3A_delta">Delta</code></td>
<td>
<p>Half of this value will be subtracted for every update.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 1000
Xlogreg &lt;- data.frame(x1=rbinom(n,1,0.4), x2=runif(n,0,1), x3=rnorm(n))
xbeta &lt;- -1+Xlogreg$x1*100+Xlogreg$x2+Xlogreg$x3
Xlogreg$y &lt;- rbinom(n,1,exp(xbeta)/(1+exp(xbeta)))
chartlogreg &lt;- new("SPCEWMA",
                   model=SPCModellogregOE(Delta= 0, formula="y~x1+x2+x3"), lambda=0.8)
SPCproperty(data=Xlogreg,nrep=10,property="calARL",
            chart=chartlogreg,params=list(target=100))
#increase nrep for real applications.
</code></pre>

<hr>
<h2 id='SPCModelNonpar'>Generic Model for Nonparametric Resampling</h2><span id='topic+SPCModelNonpar'></span>

<h3>Description</h3>

<p>Generic model that allows nonparametric resampling (with
replacement) of the data. The transformation of data into updates
needs to be defined via the arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SPCModelNonpar(updates, xiofP)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SPCModelNonpar_+3A_updates">updates</code></td>
<td>
<p>function that computes updates.</p>
</td></tr>
<tr><td><code id="SPCModelNonpar_+3A_xiofp">xiofP</code></td>
<td>
<p>function that computes xi given P.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parameters to the functions being returned have the following meaning.
</p>

<ul>
<li><p> data: a numeric vector or a matrix where the rows contain the observations.
</p>
</li>
<li><p> xi: depends on the parameter xiofP.
</p>
</li>
<li><p> P: The <code>data</code> with no modifications (thus either a numeric vector or a matrix).
</p>
</li></ul>

<p>The main operations are defined as follows:
</p>

<ul>
<li><p> resample(P): generates a new data set of the same size by either resampling the values (if the data is a vector) or by resampling the rows of the data matrix (both use resampling with replacement).
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class SPCDataModel.
</p>

<hr>
<h2 id='SPCModelNonparCenterScale'>Nonparametric Resampling with Centering and Scaling</h2><span id='topic+SPCModelNonparCenterScale'></span>

<h3>Description</h3>

<p>Nonparametric resampling of univariate observations. Updates are
centered and scaled transformations of the data (with a constant
potentially being subtracted).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SPCModelNonparCenterScale(Delta = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SPCModelNonparCenterScale_+3A_delta">Delta</code></td>
<td>
<p>how much to subtract before scaling.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calls <code><a href="#topic+SPCModelNonpar">SPCModelNonpar</a></code> to generate the data object, so it only needs to specify the meaning of <code>xi</code>, the parameter needed to compute updates and the definition of the updates.
</p>

<ul>
<li><p> xi: a list with two elements:
</p>

<ul>
<li><p> mu: the mean.
</p>
</li>
<li><p> sd: the standard deviation.
</p>
</li></ul>

</li>
<li><p> updates(xi,data): returns the centered and scale version of the data from which <code class="reqn">Delta/2</code> has been subtracted, i.e.
</p>
<p style="text-align: center;"><code class="reqn">\frac{data-mu-Delta/2}{sd}</code>
</p>

</li></ul>



<h3>Value</h3>

<p>An object of class SPCDataModel.
</p>
<p>An object of class SPCDataModel.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SPCModelNonpar">SPCModelNonpar</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- rnorm(1000)

#CUSUM chart
model &lt;- SPCModelNonparCenterScale(1)
chart &lt;- new("SPCCUSUM",model=model)
SPCproperty(data=X,nrep=10,property="calARL",
            chart=chart,params=list(target=100))

#Shewhart chart
model &lt;- SPCModelNonparCenterScale(0)
chart &lt;- new("SPCCUSUM",model=model)
SPCproperty(data=X,nrep=10,property="calARL",
            chart=chart,params=list(target=100))
</code></pre>

<hr>
<h2 id='SPCModelNormal'>Parametric Model for Normally Distributed Data with Centering and Scaling</h2><span id='topic+SPCModelNormal'></span>

<h3>Description</h3>

<p>Returns a data model for univariate observations using normality
assumptions with updates that center and scale the observations and
potentially subtract half of a constant <code>Delta</code>. Subtracting
<code class="reqn">Delta/2</code> is useful for CUSUM charts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SPCModelNormal(Delta = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SPCModelNormal_+3A_delta">Delta</code></td>
<td>
<p>Half of this constant is subtracted for updates (before centering and scaling).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parameters to the function have the following meaning.
</p>

<ul>
<li><p> data: a numeric vector.
</p>
</li>
<li><p> xi: a list with two elements:
</p>

<ul>
<li><p> mu: the mean.
</p>
</li>
<li><p> sd: the standard deviation.
</p>
</li></ul>

</li>
<li><p> P: a list with three elements:
</p>

<ul>
<li><p> mu: the mean.
</p>
</li>
<li><p> sd: the standard deviation.
</p>
</li>
<li><p> m: the number of data points to resample.
</p>
</li></ul>

</li></ul>

<p>The main operations are defined as follows:
</p>

<ul>
<li><p> updates(xi,data): returns the centered and scale version of the data from which <code class="reqn">Delta/2</code> has been subtracted, i.e.
</p>
<p style="text-align: center;"><code class="reqn">\frac{data-mu-Delta/2}{sd}</code>
</p>
<p>.
</p>
</li>
<li><p> resample(P): resamples <code>m</code> new data points from a normal distribution if mean <code>mu</code> and standard deviation <code>sd</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class <code><a href="#topic+SPCDataModel">SPCDataModel</a></code>.
</p>

<hr>
<h2 id='SPCproperty'>Computes bootstrap adjusted properties for control charts</h2><span id='topic+SPCproperty'></span>

<h3>Description</h3>

<p>Computes bootstrap adjusted properties for control charts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SPCproperty(data, nrep = 500, chart, property, params, covprob = 0.9,
  quiet = FALSE, reportdistr = FALSE, parallel = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SPCproperty_+3A_data">data</code></td>
<td>
<p>The observed data.</p>
</td></tr>
<tr><td><code id="SPCproperty_+3A_nrep">nrep</code></td>
<td>
<p>The number of bootstrap repetitions. Default 500.</p>
</td></tr>
<tr><td><code id="SPCproperty_+3A_chart">chart</code></td>
<td>
<p>The chart to be used.</p>
</td></tr>
<tr><td><code id="SPCproperty_+3A_property">property</code></td>
<td>
<p>The property to be computed. A string. Must be implemented by the chart.</p>
</td></tr>
<tr><td><code id="SPCproperty_+3A_params">params</code></td>
<td>
<p>Additional parameters for computing the property.</p>
</td></tr>
<tr><td><code id="SPCproperty_+3A_covprob">covprob</code></td>
<td>
<p>The coverage probability of the adjustment. Default 0.9.</p>
</td></tr>
<tr><td><code id="SPCproperty_+3A_quiet">quiet</code></td>
<td>
<p>Logical value indicating if progress bar should be suppressed. Default FALSE.</p>
</td></tr>
<tr><td><code id="SPCproperty_+3A_reportdistr">reportdistr</code></td>
<td>
<p>Logical value indicating if the ecdf of the bootstrap distribution should be plotted. Default FALSE.</p>
</td></tr>
<tr><td><code id="SPCproperty_+3A_parallel">parallel</code></td>
<td>
<p>Number of cores to use for parallel computations
(using mclapply from the package parallel). Defaults to 1. If set
to <code>Inf</code> then the number of cores is automatically detected
and all but one are used. Has to be set to 1 under Windows.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of type SPCpropertyres.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SPC2sidedconfint">SPC2sidedconfint</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # calibrate CUSUM chart to an in-control ARL of 100.
 # run with a larger number of replications in real examples!
 X &lt;-  rnorm(100) #observed data
 chart &lt;- new("SPCCUSUM",model=SPCModelNormal(Delta=1)) # CUSUM chart with normal observations
SPCproperty(data=X,nrep=15,chart=chart,property="calARL", params=list(target=100))

</code></pre>

<hr>
<h2 id='SPCpropertyres-class'>Results of SPCproperty.</h2><span id='topic+SPCpropertyres-class'></span><span id='topic+show+2CSPCpropertyres-method'></span>

<h3>Description</h3>

<p>Results of SPCproperty.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'SPCpropertyres'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SPCpropertyres-class_+3A_object">object</code></td>
<td>
<p>the result to be shown.</p>
</td></tr>
</table>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>show</code>: Prints the object nicely.
</p>
</li></ul>


<h3>Slots</h3>


<dl>
<dt><code>nrep</code></dt><dd><p>number of repetitions used in the simulation.</p>
</dd>
<dt><code>chart</code></dt><dd><p>the chart used.</p>
</dd>
<dt><code>property</code></dt><dd><p>the property of interest, <code>ARL</code>, <code>calARL</code>, <code>calhitprob</code> or <code>hitprob</code>.</p>
</dd>
<dt><code>covprob</code></dt><dd><p>the probability of the guaranteed conditional performance.</p>
</dd>
<dt><code>res</code></dt><dd><p>the guaranteed conditional performance.</p>
</dd>
<dt><code>raw</code></dt><dd><p>the unadjusted result.</p>
</dd>
<dt><code>params</code></dt><dd><p>additional parameters used for computing this property.</p>
</dd>
<dt><code>restext</code></dt><dd><p>a readable version of the result.</p>
</dd>
</dl>

<hr>
<h2 id='SPCShew-class'>Shewhart charts.</h2><span id='topic+SPCShew-class'></span>

<h3>Description</h3>

<p>Shewhart charts.
</p>


<h3>Slots</h3>


<dl>
<dt><code>twosided</code></dt><dd><p>TRUE if a two-sided chart should be used. Default FALSE.</p>
</dd>
</dl>


<h3>Examples</h3>

<pre><code class='language-R'>X&lt;-rnorm(100);
##calibrate to ARL 100
chartShew &lt;- new("SPCShew",model=SPCModelNormal(),twosided=TRUE)
## Not run: 
SPCproperty(data=X,nrep=500,
            property="calARL",chart=chartShew,params=list(target=100),
            covprob=c(0.7,0.9))

chartShewOneSided &lt;- new("SPCShew",model=SPCModelNormal(),twosided=FALSE)
SPCproperty(data=X,nrep=500,
            property="calARL",chart=chartShewOneSided,
            params=list(target=100),covprob=c(0.7,0.9))

##calibrate to a hitting probability of 0.01 in 100 steps
SPCproperty(data=X,nrep=500,
            property="calhitprob",
            chart=chartShew,params=list(target=0.01,nsteps=100))
SPCproperty(data=X,nrep=500,
            property="calhitprob",chart=chartShewOneSided,params=list(target=0.01,nsteps=100))

## work out  for ARL for a fixed threshold of 4
SPCproperty(data=X,nrep=500,
            property="ARL",chart=chartShew,params=list(threshold=4))
SPCproperty(data=X,nrep=500,
            property="ARL",chart=chartShewOneSided,
            params=list(threshold=4))

SPCproperty(data=X,nrep=500,
            property="hitprob",chart=chartShew,params=list(nsteps=100,threshold=4))

SPCproperty(data=X,nrep=500,
            property="hitprob",chart=chartShewOneSided,params=list(nsteps=100,threshold=4))

## End(Not run)

X&lt;-rnorm(100)
chartShew &lt;- new("SPCShew",model=SPCModelNormal())
## Not run: 
SPCproperty(data=X,nrep=500,
            property="calARL", chart=chartShew,
            params=list(target=1000))
SPCproperty(data=X,nrep=500,
            property="calhitprob",chart=chartShew,
            params=list(target=0.01,nsteps=100))
SPCproperty(data=X,nrep=10,chart=chartShew,
            property="ARL",params=list(threshold=3))
SPCproperty(data=X,nrep=500,
            property="hitprob",
            chart=chartShew,params=list(nsteps=100,threshold=4))

## End(Not run)
</code></pre>

<hr>
<h2 id='updates'>Updates of a Control Chart</h2><span id='topic+updates'></span><span id='topic+updates+2CSPCShew-method'></span><span id='topic+updates+2CSPCchart-method'></span>

<h3>Description</h3>

<p>Computes updates of a control chart using the given parameters and the given data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updates(chart, xi, data)

## S4 method for signature 'SPCchart'
updates(chart, xi, data)

## S4 method for signature 'SPCShew'
updates(chart, xi, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="updates_+3A_chart">chart</code></td>
<td>
<p>the control chart.</p>
</td></tr>
<tr><td><code id="updates_+3A_xi">xi</code></td>
<td>
<p>the parameters used for running the chart.</p>
</td></tr>
<tr><td><code id="updates_+3A_data">data</code></td>
<td>
<p>the observed data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the same length as data.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>SPCchart</code>: Standard method which simply first applies
getresiduals from the data model.
</p>
</li>
<li> <p><code>SPCShew</code>: Computes the updates taking into account if the
chart is one-sided or two-sided.
</p>
</li></ul>

<hr>
<h2 id='xiofdata'>Estimate Chart Parameters</h2><span id='topic+xiofdata'></span><span id='topic+xiofdata+2CSPCchart-method'></span>

<h3>Description</h3>

<p>Estimates the parameters used to run a control chart from given
data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xiofdata(chart, data)

## S4 method for signature 'SPCchart'
xiofdata(chart, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xiofdata_+3A_chart">chart</code></td>
<td>
<p>the control chart to be used.</p>
</td></tr>
<tr><td><code id="xiofdata_+3A_data">data</code></td>
<td>
<p>the data to be used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The parameter values for running the control chart <code>chart</code>.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>SPCchart</code>: Standard method which simply first applies
PofData to get a model and then xiofP to get the parameters.
</p>
</li></ul>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
