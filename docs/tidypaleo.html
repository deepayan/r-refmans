<!DOCTYPE html><html><head><title>Help for package tidypaleo</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tidypaleo}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#age_depth_as_sec_axis'><p>Use an age depth model as a second ggplot axis</p></a></li>
<li><a href='#age_depth_interpolate'><p>Age-depth model interpolators/extrapolators</p></a></li>
<li><a href='#age_depth_model'><p>Create age depth models</p></a></li>
<li><a href='#alta_lake_210Pb_ages'><p>Alta Lake Lead-210 and Carbon-14 Ages</p></a></li>
<li><a href='#as_trans_factory'><p>Coerce and validate transforms and functions that produce them</p></a></li>
<li><a href='#facet_abundanceh'><p>Facet for relative abundance data</p></a></li>
<li><a href='#geom_col_segsh'><p>Useful geometries for strat diagrams</p></a></li>
<li><a href='#geom_lineh'><p>Connect observations in the vertical direction</p></a></li>
<li><a href='#geom_point_exaggerate'><p>Exaggerated geometries that do not train scales</p></a></li>
<li><a href='#geom_ribbonh'><p>Vertical ribbons and area plots</p></a></li>
<li><a href='#halifax_lakes_plottable'><p>Halifax lakes water chemistry and top/bottom diatom counts</p></a></li>
<li><a href='#keji_lakes_plottable'><p>Keji lakes core diatom counts</p></a></li>
<li><a href='#kellys_lake_cladocera'><p>Kellys Lake Data</p></a></li>
<li><a href='#label_geochem'><p>Geochem facet labelers</p></a></li>
<li><a href='#label_species'><p>Species facet labellers</p></a></li>
<li><a href='#layer_dendrogram'><p>Add a dendrogram as a layer or facet</p></a></li>
<li><a href='#layer_scores'><p>Add scores to a plot</p></a></li>
<li><a href='#long_lake_14C_ages'><p>Long Lake Carbon-14 Ages</p></a></li>
<li><a href='#nested_analysis'><p>Perform an analysis on a nested data matrix</p></a></li>
<li><a href='#nested_data'><p>Prepare a parameter-long data frame for statistical analysis</p></a></li>
<li><a href='#nested_hclust'><p>Nested (Constrained) hierarchical clustering</p></a></li>
<li><a href='#nested_prcomp'><p>Nested Principal Components Analysis (PCA)</p></a></li>
<li><a href='#plot.age_depth_model'><p>Plot an age depth model using base graphics</p></a></li>
<li><a href='#plot.nested_analysis'><p>Plot a nested analysis</p></a></li>
<li><a href='#predict.age_depth_model'><p>Predict age and depth values</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#rotated_facet_labels'><p>Common plot modifications for stratigraphic plots</p></a></li>
<li><a href='#scale_x_abundance'><p>Scales for relative abundance values</p></a></li>
<li><a href='#scale_y_depth_age'><p>Age-depth scales</p></a></li>
<li><a href='#sequential_layer_facets'><p>Change facet ordering behaviour</p></a></li>
<li><a href='#stat_nested_hclust'><p>Display a dendrogram as a ggplot2 layer</p></a></li>
<li><a href='#theme_paleo'><p>A Paleo-friendly ggplot2 theme</p></a></li>
<li><a href='#tidypaleo-package'><p>tidypaleo: Tidy Tools for Paleoenvironmental Archives</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Tidy Tools for Paleoenvironmental Archives</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a set of functions with a common framework for age-depth model management, 
  stratigraphic visualization, and common statistical transformations. The focus of the
  package is stratigraphic visualization, for which 'ggplot2' components are provided
  to reproduce the scales, geometries, facets, and theme elements commonly used in
  publication-quality stratigraphic diagrams. Helpers are also provided to reproduce
  the exploratory statistical summaries that are frequently included on
  stratigraphic diagrams. See Dunnington et al. (2021) &lt;<a href="https://doi.org/10.18637%2Fjss.v101.i07">doi:10.18637/jss.v101.i07</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, vegan, patchwork, forcats, vdiffr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://paleolimbot.github.io/tidypaleo/">https://paleolimbot.github.io/tidypaleo/</a>,
<a href="https://github.com/paleolimbot/tidypaleo">https://github.com/paleolimbot/tidypaleo</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/paleolimbot/tidypaleo/issues">https://github.com/paleolimbot/tidypaleo/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>rlang, tidyselect, dplyr, vctrs, tibble, scales, ggplot2 (&ge;
3.0.0), styler, purrr, ggstance, stringr, withr, tidyr (&ge;
1.0.2), digest, rioja</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-18 02:56:24 UTC; deweydunnington</td>
</tr>
<tr>
<td>Author:</td>
<td>Dewey Dunnington <a href="https://orcid.org/0000-0002-9415-4582"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dewey Dunnington &lt;dewey@fishandwhistle.net&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-18 08:20:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='age_depth_as_sec_axis'>Use an age depth model as a second ggplot axis</h2><span id='topic+age_depth_as_sec_axis'></span>

<h3>Description</h3>

<p>Use an age depth model as a second ggplot axis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>age_depth_as_sec_axis(x, primary = c("depth", "age"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="age_depth_as_sec_axis_+3A_x">x</code></td>
<td>
<p>An <a href="#topic+age_depth_model">age_depth_model</a></p>
</td></tr>
<tr><td><code id="age_depth_as_sec_axis_+3A_primary">primary</code></td>
<td>
<p>Specify the primary axis as 'age' or 'depth'</p>
</td></tr>
<tr><td><code id="age_depth_as_sec_axis_+3A_...">...</code></td>
<td>
<p>Passed to <a href="ggplot2.html#topic+sec_axis">sec_axis</a></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 <a href="ggplot2.html#topic+sec_axis">sec_axis</a> for use in <a href="ggplot2.html#topic+scale_continuous">scale_x_continuous</a>,
<a href="ggplot2.html#topic+scale_continuous">scale_y_continuous</a>, or their reverse variants.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
alta_lake_adm &lt;- age_depth_model(
  alta_lake_210Pb_ages,
  depth = depth_cm,
  age = age_year_ad
)

ggplot(alta_lake_210Pb_ages, aes(y = depth_cm, x = age_year_ad)) +
  geom_path() +
  geom_point() +
  scale_y_reverse(sec.axis = age_depth_as_sec_axis(alta_lake_adm))

</code></pre>

<hr>
<h2 id='age_depth_interpolate'>Age-depth model interpolators/extrapolators</h2><span id='topic+age_depth_interpolate'></span><span id='topic+age_depth_extrapolate'></span><span id='topic+age_depth_exact'></span><span id='topic+age_depth_na'></span>

<h3>Description</h3>

<p>Age-depth model interpolators/extrapolators
</p>


<h3>Usage</h3>

<pre><code class='language-R'>age_depth_interpolate(x, y)

age_depth_extrapolate(x, y, x0 = last, y0 = last, slope = NULL)

age_depth_exact(x, y)

age_depth_na(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="age_depth_interpolate_+3A_x">x</code></td>
<td>
<p>A paired vector of x values</p>
</td></tr>
<tr><td><code id="age_depth_interpolate_+3A_y">y</code></td>
<td>
<p>A paired vector of y values</p>
</td></tr>
<tr><td><code id="age_depth_interpolate_+3A_x0">x0</code></td>
<td>
<p>The x value to anchor the transform</p>
</td></tr>
<tr><td><code id="age_depth_interpolate_+3A_y0">y0</code></td>
<td>
<p>The y value to anchor the transform</p>
</td></tr>
<tr><td><code id="age_depth_interpolate_+3A_slope">slope</code></td>
<td>
<p>The slope (in units of y/x) to use for the transform</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with component functions <code>trans</code> and <code>inverse</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>age_depth_model(
  alta_lake_210Pb_ages,
  depth = depth_cm, age = age_year_ad,
  age_max = age_year_ad + age_error_yr,
  age_min = age_year_ad - age_error_yr,
  extrapolate_age_below = ~age_depth_extrapolate(
    tail(.x, 3), tail(.y, 3), x0 = dplyr::last, y0 = dplyr::last
  ),
  extrapolate_age_above = ~age_depth_extrapolate(
    head(.x, 3), head(.y, 3), x0 = dplyr::first, y0 = dplyr::first
  )
)

</code></pre>

<hr>
<h2 id='age_depth_model'>Create age depth models</h2><span id='topic+age_depth_model'></span>

<h3>Description</h3>

<p>Create age depth models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>age_depth_model(
  .data = NULL,
  depth,
  age,
  age_min = NA_real_,
  age_max = NA_real_,
  interpolate_age = age_depth_interpolate,
  extrapolate_age_below = ~age_depth_extrapolate(.x, .y, x0 = last, y0 = last),
  extrapolate_age_above = ~age_depth_extrapolate(.x, .y, x0 = first, y0 = first),
  interpolate_age_limits = age_depth_exact,
  extrapolate_age_limits_below = age_depth_na,
  extrapolate_age_limits_above = age_depth_na
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="age_depth_model_+3A_.data">.data</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="age_depth_model_+3A_depth">depth</code>, <code id="age_depth_model_+3A_age">age</code>, <code id="age_depth_model_+3A_age_min">age_min</code>, <code id="age_depth_model_+3A_age_max">age_max</code></td>
<td>
<p>Expressions evaluated in <code>.data</code> that
provide the known depths, known ages, and error information if available.
These expressions are evaluated like they are within <a href="dplyr.html#topic+mutate">mutate</a>
if <code>.data</code> is present.</p>
</td></tr>
<tr><td><code id="age_depth_model_+3A_interpolate_age">interpolate_age</code>, <code id="age_depth_model_+3A_extrapolate_age_below">extrapolate_age_below</code>, <code id="age_depth_model_+3A_extrapolate_age_above">extrapolate_age_above</code></td>
<td>
<p>These
arguments provide the rules for interpolating and extrapolating ages based
on depths.</p>
</td></tr>
<tr><td><code id="age_depth_model_+3A_interpolate_age_limits">interpolate_age_limits</code>, <code id="age_depth_model_+3A_extrapolate_age_limits_below">extrapolate_age_limits_below</code>, <code id="age_depth_model_+3A_extrapolate_age_limits_above">extrapolate_age_limits_above</code></td>
<td>
<p>These arguments provide the rules for interpolating and extrapolating age
min and max values based on depths.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An age depth model object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>age_depth_model(
  alta_lake_210Pb_ages,
  depth = depth_cm, age = age_year_ad,
  age_max = age_year_ad + age_error_yr,
  age_min = age_year_ad - age_error_yr
)

</code></pre>

<hr>
<h2 id='alta_lake_210Pb_ages'>Alta Lake Lead-210 and Carbon-14 Ages</h2><span id='topic+alta_lake_210Pb_ages'></span><span id='topic+alta_lake_14C_ages'></span><span id='topic+alta_lake_bacon_ages'></span><span id='topic+alta_lake_geochem'></span>

<h3>Description</h3>

<p>The <code>alta_lake_210Pb_ages</code> object contains raw depths and ages for Alta
Lake (Whistler, British Columbia, Canada) core AL-GC2 (Dunnington et al.
2016; Dunnington 2015). For these values, ages were calculated from Lead-210
activities using the constant rate of supply (CRS) model (Appleby and
Oldfield 1983). The <code>alta_lake_14C_ages</code> object contains one
uncalibrated Carbon-14 measurement from the same core.
The <code>alta_lake_bacon_ages</code> object contains the combined result of the
Lead-210 and the Carbon-14 ages as modelled by the rbacon package
(Blaauw and Christen 2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alta_lake_210Pb_ages

alta_lake_14C_ages

alta_lake_bacon_ages

alta_lake_geochem
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 9 rows and 5 columns.
</p>
<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 1 rows and 5 columns.
</p>
<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 58 rows and 5 columns.
</p>
<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 192 rows and 9 columns.
</p>


<h3>References</h3>

<p>Appleby, P. G., and F. Oldfield. &quot;The Assessment of 210Pb Data from Sites
with Varying Sediment Accumulation Rates.&quot; Hydrobiologia 103, no. 1 (July 1,
1983): 29–35. <a href="https://doi.org/10.1007/BF00028424">doi:10.1007/BF00028424</a>.
</p>
<p>Blaauw, Maarten, and J. Andrés Christen. &quot;Flexible Paleoclimate Age-Depth
Models Using an Autoregressive Gamma Process.&quot; Bayesian Analysis 6, no. 3
(September 2011): 457–74. <a href="https://doi.org/10.1214/ba/1339616472">doi:10.1214/ba/1339616472</a>.
</p>
<p>Dunnington, Dewey W., Ian S. Spooner, Chris E. White, R. Jack Cornett, Dave
Williamson, and Mike Nelson. &quot;A Geochemical Perspective on the Impact of
Development at Alta Lake, British Columbia, Canada.&quot; Journal of
Paleolimnology 56, no. 4 (November 2016): 315–330.
<a href="https://doi.org/10.1007/s10933-016-9919-x">doi:10.1007/s10933-016-9919-x</a>.
</p>
<p>Dunnington, Dewey W. &quot;A 500-Year Applied Paleolimnological Assessment of
Environmental Change at Alta Lake, Whistler, British Columbia, Canada.&quot; M.Sc.
Thesis, Acadia University, 2015.
<a href="https://scholar.acadiau.ca/islandora/object/theses:411">https://scholar.acadiau.ca/islandora/object/theses:411</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>alta_lake_210Pb_ages
alta_lake_14C_ages
alta_lake_bacon_ages

</code></pre>

<hr>
<h2 id='as_trans_factory'>Coerce and validate transforms and functions that produce them</h2><span id='topic+as_trans_factory'></span><span id='topic+validate_trans_factory'></span><span id='topic+validate_trans'></span>

<h3>Description</h3>

<p>Coerce and validate transforms and functions that produce them
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_trans_factory(factory, env = parent.frame())

validate_trans_factory(factory, x = 1:3, y = 1:3)

validate_trans(trans, x = 1:3, y = 1:3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_trans_factory_+3A_factory">factory</code></td>
<td>
<p>A function that produces a transform object</p>
</td></tr>
<tr><td><code id="as_trans_factory_+3A_env">env</code></td>
<td>
<p>The calling environment, for transform factories that are calls or
rlang lambda-style functions.</p>
</td></tr>
<tr><td><code id="as_trans_factory_+3A_x">x</code></td>
<td>
<p>The test x data</p>
</td></tr>
<tr><td><code id="as_trans_factory_+3A_y">y</code></td>
<td>
<p>The test y data</p>
</td></tr>
<tr><td><code id="as_trans_factory_+3A_trans">trans</code></td>
<td>
<p>A transform object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input, invisibly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>as_trans_factory(age_depth_interpolate)

</code></pre>

<hr>
<h2 id='facet_abundanceh'>Facet for relative abundance data</h2><span id='topic+facet_abundanceh'></span><span id='topic+facet_abundance'></span><span id='topic+facet_geochem_wraph'></span><span id='topic+facet_geochem_wrap'></span><span id='topic+facet_geochem_grid'></span><span id='topic+facet_geochem_gridh'></span>

<h3>Description</h3>

<p>Provides a number of modifications to the plot that are necessary for relative abundance plots
of a number of species. See <a href="#topic+scale_x_abundance">scale_x_abundance</a>, <a href="ggplot2.html#topic+facet_grid">facet_grid</a>,
<a href="ggplot2.html#topic+facet_grid">facet_grid</a>, <a href="#topic+label_species">label_species</a>, <a href="#topic+label_geochem">label_geochem</a>,
and <a href="#topic+rotated_facet_labels">rotated_facet_labels</a> <a href="#topic+rotated_axis_labels">rotated_axis_labels</a>
for examples of how to customize the default behaviour.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>facet_abundanceh(
  taxon,
  grouping = NULL,
  rotate_facet_labels = 45,
  labeller = label_species,
  scales = "free_x",
  space = "free_x",
  dont_italicize = c("\\(.*?\\)", "spp?\\.", "-complex", "[Oo]ther"),
  ...
)

facet_abundance(
  taxon,
  grouping = NULL,
  rotate_facet_labels = 0,
  labeller = label_species,
  scales = "free_y",
  space = "free_y",
  dont_italicize = c("\\(.*?\\)", "spp?\\.", "-complex", "[Oo]ther"),
  ...
)

facet_geochem_wraph(
  param,
  grouping = NULL,
  rotate_axis_labels = 90,
  scales = "free_x",
  labeller = label_geochem,
  renamers = c(`^d([0-9]+)([HCNOS])$` = "paste(delta ^ \\1, \\2)", `^210Pb$` =
    "paste({}^210, Pb)", `^Pb210$` = "paste({}^210, Pb)"),
  units = character(0),
  default_units = NA_character_,
  ...
)

facet_geochem_wrap(
  param,
  grouping = NULL,
  scales = "free_y",
  labeller = label_geochem,
  renamers = c(`^d([0-9]+)([HCNOS])$` = "paste(delta ^ \\1, \\2)", `^210Pb$` =
    "paste({}^210, Pb)", `^Pb210$` = "paste({}^210, Pb)"),
  units = character(0),
  default_units = NA_character_,
  ...
)

facet_geochem_grid(
  param,
  grouping = NULL,
  rotate_axis_labels = 0,
  scales = "free_y",
  space = "fixed",
  labeller = label_geochem,
  renamers = c(`^d([0-9]+)([HCNOS])$` = "paste(delta ^ \\1, \\2)", `^210Pb$` =
    "paste({}^210, Pb)", `^Pb210$` = "paste({}^210, Pb)"),
  units = character(0),
  default_units = NA_character_,
  ...
)

facet_geochem_gridh(
  param,
  grouping = NULL,
  rotate_axis_labels = 90,
  scales = "free_x",
  space = "fixed",
  labeller = label_geochem,
  renamers = c(`^d([0-9]+)([HCNOS])$` = "paste(delta ^ \\1, \\2)", `^210Pb$` =
    "paste({}^210, Pb)", `^Pb210$` = "paste({}^210, Pb)"),
  units = character(0),
  default_units = NA_character_,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="facet_abundanceh_+3A_taxon">taxon</code>, <code id="facet_abundanceh_+3A_param">param</code></td>
<td>
<p>A call to <a href="ggplot2.html#topic+vars">vars</a>, defining the column that identifies the taxon (parameter).</p>
</td></tr>
<tr><td><code id="facet_abundanceh_+3A_grouping">grouping</code></td>
<td>
<p>A call to <a href="ggplot2.html#topic+vars">vars</a>, identifying additional grouping columns</p>
</td></tr>
<tr><td><code id="facet_abundanceh_+3A_rotate_facet_labels">rotate_facet_labels</code>, <code id="facet_abundanceh_+3A_rotate_axis_labels">rotate_axis_labels</code></td>
<td>
<p>Facet (axis) label rotation (degrees)</p>
</td></tr>
<tr><td><code id="facet_abundanceh_+3A_labeller">labeller</code></td>
<td>
<p>Labeller to process facet names. Use <a href="#topic+label_species">label_species</a> to italicize
species names, <a href="#topic+label_geochem">label_geochem</a> to perform common formatting and units,
or <a href="ggplot2.html#topic+labellers">label_value</a> to suppress.</p>
</td></tr>
<tr><td><code id="facet_abundanceh_+3A_space">space</code>, <code id="facet_abundanceh_+3A_scales">scales</code></td>
<td>
<p>Modify default scale freedom behaviour</p>
</td></tr>
<tr><td><code id="facet_abundanceh_+3A_dont_italicize">dont_italicize</code></td>
<td>
<p>Regular expressions that should not be italicized</p>
</td></tr>
<tr><td><code id="facet_abundanceh_+3A_...">...</code></td>
<td>
<p>Passed to <a href="ggplot2.html#topic+facet_grid">facet_grid</a> (abundance) or <a href="ggplot2.html#topic+facet_wrap">facet_wrap</a> (geochem).</p>
</td></tr>
<tr><td><code id="facet_abundanceh_+3A_renamers">renamers</code></td>
<td>
<p>Search and replace operations to perform in the form
search = replace. Replace text can (should) contain backreferences,
and will be parsed as an expression (see <a href="grDevices.html#topic+plotmath">plotmath</a>). Use
NULL to suppress renaming.</p>
</td></tr>
<tr><td><code id="facet_abundanceh_+3A_units">units</code></td>
<td>
<p>A named list of values = unit</p>
</td></tr>
<tr><td><code id="facet_abundanceh_+3A_default_units">default_units</code></td>
<td>
<p>The default units to apply</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A subclass of <code><a href="ggplot2.html#topic+facet_grid">ggplot2::facet_grid()</a></code> or <code><a href="ggplot2.html#topic+facet_wrap">ggplot2::facet_wrap()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

ggplot(keji_lakes_plottable, aes(x = rel_abund, y = depth)) +
  geom_col_segsh() +
  scale_y_reverse() +
  facet_abundanceh(vars(taxon), grouping = vars(location)) +
  labs(y = "Depth (cm)")

ggplot(keji_lakes_plottable, aes(y = rel_abund, x = depth)) +
  geom_col_segs() +
  scale_x_reverse() +
  facet_abundance(vars(taxon), grouping = vars(location)) +
  labs(x = "Depth (cm)")

ggplot(alta_lake_geochem, aes(x = value, y = depth)) +
  geom_lineh() +
  geom_point() +
  scale_y_reverse() +
  facet_geochem_wrap(vars(param), units = c(C = "%", Cu = "ppm", Ti = "ppm"), nrow = 1) +
  labs(x = NULL, y = "Depth (cm)")

ggplot(alta_lake_geochem, aes(x = value, y = depth)) +
  geom_lineh() +
  geom_point() +
  scale_y_reverse() +
  facet_geochem_gridh(vars(param), units = c(C = "%", Cu = "ppm", Ti = "ppm")) +
  labs(x = NULL, y = "Depth (cm)")

ggplot(alta_lake_geochem, aes(y = value, x = depth)) +
  geom_line() +
  geom_point() +
  scale_x_reverse() +
  facet_geochem_grid(vars(param), units = c(C = "%", Cu = "ppm", Ti = "ppm")) +
  labs(y = NULL, x = "Depth (cm)")

</code></pre>

<hr>
<h2 id='geom_col_segsh'>Useful geometries for strat diagrams</h2><span id='topic+geom_col_segsh'></span><span id='topic+geom_col_segs'></span><span id='topic+GeomColSegsh'></span><span id='topic+GeomColSegs'></span><span id='topic+GeomLineh'></span>

<h3>Description</h3>

<p>Useful geometries for strat diagrams
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_col_segsh(
  mapping = NULL,
  data = NULL,
  stat = "identity",
  position = "identity",
  ...,
  xend = 0,
  arrow = NULL,
  arrow.fill = NULL,
  lineend = "butt",
  linejoin = "round",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE
)

geom_col_segs(
  mapping = NULL,
  data = NULL,
  stat = "identity",
  position = "identity",
  ...,
  yend = 0,
  arrow = NULL,
  arrow.fill = NULL,
  lineend = "butt",
  linejoin = "round",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE
)

GeomColSegsh

GeomColSegs

GeomLineh
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geom_col_segsh_+3A_mapping">mapping</code>, <code id="geom_col_segsh_+3A_data">data</code>, <code id="geom_col_segsh_+3A_stat">stat</code>, <code id="geom_col_segsh_+3A_position">position</code>, <code id="geom_col_segsh_+3A_arrow">arrow</code>, <code id="geom_col_segsh_+3A_arrow.fill">arrow.fill</code>, <code id="geom_col_segsh_+3A_lineend">lineend</code>, <code id="geom_col_segsh_+3A_linejoin">linejoin</code>, <code id="geom_col_segsh_+3A_na.rm">na.rm</code>, <code id="geom_col_segsh_+3A_show.legend">show.legend</code>, <code id="geom_col_segsh_+3A_inherit.aes">inherit.aes</code>, <code id="geom_col_segsh_+3A_...">...</code></td>
<td>
<p>See
<a href="ggplot2.html#topic+geom_segment">geom_segment</a>.</p>
</td></tr>
<tr><td><code id="geom_col_segsh_+3A_xend">xend</code>, <code id="geom_col_segsh_+3A_yend">yend</code></td>
<td>
<p>The end of the horizontal or vertical segment bars, respectively.</p>
</td></tr>
</table>


<h3>Format</h3>

<p>An object of class <code>GeomColSegsh</code> (inherits from <code>GeomSegment</code>, <code>Geom</code>, <code>ggproto</code>, <code>gg</code>) of length 4.
</p>
<p>An object of class <code>GeomColSegs</code> (inherits from <code>GeomSegment</code>, <code>Geom</code>, <code>ggproto</code>, <code>gg</code>) of length 4.
</p>
<p>An object of class <code>GeomLineh</code> (inherits from <code>GeomPath</code>, <code>Geom</code>, <code>ggproto</code>, <code>gg</code>) of length 2.
</p>


<h3>Value</h3>

<p>A ggplot2 layer
</p>

<hr>
<h2 id='geom_lineh'>Connect observations in the vertical direction</h2><span id='topic+geom_lineh'></span>

<h3>Description</h3>

<p>Connect observations in the vertical direction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_lineh(
  mapping = NULL,
  data = NULL,
  stat = "identity",
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geom_lineh_+3A_mapping">mapping</code>, <code id="geom_lineh_+3A_data">data</code>, <code id="geom_lineh_+3A_stat">stat</code>, <code id="geom_lineh_+3A_position">position</code>, <code id="geom_lineh_+3A_na.rm">na.rm</code>, <code id="geom_lineh_+3A_show.legend">show.legend</code>, <code id="geom_lineh_+3A_inherit.aes">inherit.aes</code>, <code id="geom_lineh_+3A_...">...</code></td>
<td>
<p>See
<a href="ggplot2.html#topic+geom_path">geom_line</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 layer.
</p>

<hr>
<h2 id='geom_point_exaggerate'>Exaggerated geometries that do not train scales</h2><span id='topic+geom_point_exaggerate'></span><span id='topic+geom_line_exaggerate'></span><span id='topic+geom_lineh_exaggerate'></span><span id='topic+geom_area_exaggerate'></span><span id='topic+geom_areah_exaggerate'></span>

<h3>Description</h3>

<p>Exaggerated geometries that do not train scales
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_point_exaggerate(
  mapping = NULL,
  data = NULL,
  stat = "identity",
  position = "identity",
  ...,
  exaggerate_x = 1,
  exaggerate_y = 1,
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE
)

geom_line_exaggerate(
  mapping = NULL,
  data = NULL,
  stat = "identity",
  position = "identity",
  ...,
  exaggerate_x = 1,
  exaggerate_y = 1,
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE
)

geom_lineh_exaggerate(
  mapping = NULL,
  data = NULL,
  stat = "identity",
  position = "identity",
  ...,
  exaggerate_x = 1,
  exaggerate_y = 1,
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE
)

geom_area_exaggerate(
  mapping = NULL,
  data = NULL,
  stat = "identity",
  position = "identity",
  ...,
  exaggerate_x = 1,
  exaggerate_y = 1,
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE
)

geom_areah_exaggerate(
  mapping = NULL,
  data = NULL,
  stat = "identity",
  position = "identity",
  ...,
  exaggerate_x = 1,
  exaggerate_y = 1,
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geom_point_exaggerate_+3A_mapping">mapping</code>, <code id="geom_point_exaggerate_+3A_data">data</code>, <code id="geom_point_exaggerate_+3A_stat">stat</code>, <code id="geom_point_exaggerate_+3A_position">position</code>, <code id="geom_point_exaggerate_+3A_na.rm">na.rm</code>, <code id="geom_point_exaggerate_+3A_show.legend">show.legend</code>, <code id="geom_point_exaggerate_+3A_inherit.aes">inherit.aes</code>, <code id="geom_point_exaggerate_+3A_...">...</code></td>
<td>
<p>See
parent geometries</p>
</td></tr>
<tr><td><code id="geom_point_exaggerate_+3A_exaggerate_x">exaggerate_x</code>, <code id="geom_point_exaggerate_+3A_exaggerate_y">exaggerate_y</code></td>
<td>
<p>The factor by which to exaggerate x or y values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A subclass of <a href="ggplot2.html#topic+ggplot2-ggproto">ggplot2::Geom</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

ggplot(keji_lakes_plottable, aes(x = rel_abund, y = depth)) +
  geom_lineh_exaggerate(exaggerate_x = 2, lty = 2) +
  geom_col_segsh() +
  scale_y_reverse() +
  facet_abundanceh(vars(taxon), grouping = vars(location)) +
  labs(y = "Depth (cm)")

</code></pre>

<hr>
<h2 id='geom_ribbonh'>Vertical ribbons and area plots</h2><span id='topic+geom_ribbonh'></span><span id='topic+GeomRibbonh'></span><span id='topic+geom_areah'></span><span id='topic+GeomAreah'></span>

<h3>Description</h3>

<p>Vertical ribbons and area plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_ribbonh(
  mapping = NULL,
  data = NULL,
  stat = "identity",
  position = "identity",
  ...,
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE
)

GeomRibbonh

geom_areah(
  mapping = NULL,
  data = NULL,
  stat = "identity",
  position = "stackv",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)

GeomAreah
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geom_ribbonh_+3A_mapping">mapping</code>, <code id="geom_ribbonh_+3A_data">data</code>, <code id="geom_ribbonh_+3A_stat">stat</code>, <code id="geom_ribbonh_+3A_position">position</code>, <code id="geom_ribbonh_+3A_na.rm">na.rm</code>, <code id="geom_ribbonh_+3A_show.legend">show.legend</code>, <code id="geom_ribbonh_+3A_inherit.aes">inherit.aes</code>, <code id="geom_ribbonh_+3A_...">...</code></td>
<td>
<p>See
<a href="ggplot2.html#topic+geom_ribbon">geom_ribbon</a>.</p>
</td></tr>
</table>


<h3>Format</h3>

<p>An object of class <code>GeomRibbonh</code> (inherits from <code>Geom</code>, <code>ggproto</code>, <code>gg</code>) of length 6.
</p>
<p>An object of class <code>GeomAreah</code> (inherits from <code>GeomRibbonh</code>, <code>Geom</code>, <code>ggproto</code>, <code>gg</code>) of length 4.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

# Generate data
huron &lt;- data.frame(year = 1875:1972, level = as.vector(LakeHuron))
h &lt;- ggplot(huron, aes(y = year))

h + geom_ribbonh(aes(xmin=0, xmax=level))
h + geom_areah(aes(x = level))

# Add aesthetic mappings
h +
  geom_ribbonh(aes(xmin = level - 1, xmax = level + 1), fill = "grey70") +
  geom_lineh(aes(x = level))

</code></pre>

<hr>
<h2 id='halifax_lakes_plottable'>Halifax lakes water chemistry and top/bottom diatom counts</h2><span id='topic+halifax_lakes_plottable'></span>

<h3>Description</h3>

<p>A subset of well-labeled, clean diatom count data for 44 Halifax-area (Nova Scotia) lakes,
an analysis of which has been published by Ginn et al. (2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>halifax_lakes_plottable
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 114 rows and 5 columns.
</p>


<h3>Source</h3>

<p>Neotoma paleoecology database (<a href="https://www.neotomadb.org">https://www.neotomadb.org</a>)
</p>


<h3>References</h3>

<p>Ginn, Brian K., Thiyake Rajaratnam, Brian F. Cumming, and John P.
Smol. &quot;Establishing Realistic Management Objectives for Urban Lakes Using
Paleolimnological Techniques: An Example from Halifax Region (Nova Scotia,
Canada).&quot; Lake and Reservoir Management 31, no. 2 (April 3, 2015): 92-108.
<a href="https://doi.org/10.1080/10402381.2015.1013648">doi:10.1080/10402381.2015.1013648</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>halifax_lakes_plottable

</code></pre>

<hr>
<h2 id='keji_lakes_plottable'>Keji lakes core diatom counts</h2><span id='topic+keji_lakes_plottable'></span>

<h3>Description</h3>

<p>A subset of well-labeled, clean diatom count data for 3 Keji-area (Nova
Scotia) lakes, which form part of the analysis in Ginn et al. (2007).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>keji_lakes_plottable
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 202 rows and 5 columns.
</p>


<h3>Source</h3>

<p>Neotoma paleoecology database (<a href="https://www.neotomadb.org">https://www.neotomadb.org</a>)
</p>


<h3>References</h3>

<p>Ginn, Brian K., Brian F. Cumming, and John P. Smol. &quot;Long-Term
Lake Acidification Trends in High- and Low-Sulphate Deposition Regions from
Nova Scotia, Canada.&quot; Hydrobiologia 586, no. 1 (July 1, 2007): 261-75.
<a href="https://doi.org/10.1007/s10750-007-0644-3">doi:10.1007/s10750-007-0644-3</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>keji_lakes_plottable

</code></pre>

<hr>
<h2 id='kellys_lake_cladocera'>Kellys Lake Data</h2><span id='topic+kellys_lake_cladocera'></span><span id='topic+kellys_lake_geochem'></span><span id='topic+kellys_lake_ages'></span>

<h3>Description</h3>

<p>Geochemistry measurements and Cladocera counts from Kellys Lake,
Cape Breton Island, Nova Scotia, Canada.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kellys_lake_cladocera

kellys_lake_geochem

kellys_lake_ages
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 300 rows and 5 columns.
</p>
<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 305 rows and 9 columns.
</p>
<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 14 rows and 5 columns.
</p>


<h3>References</h3>

<p>Joshua Kurek, Ian Spooner, and Dewey Dunnington (unpublished data).
</p>

<hr>
<h2 id='label_geochem'>Geochem facet labelers</h2><span id='topic+label_geochem'></span>

<h3>Description</h3>

<p>Geochem facet labelers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>label_geochem(
  labels,
  units = character(0),
  default_units = NA_character_,
  geochem_facet = 1,
  renamers = c(`^d([0-9]+)([HCNOS])$` = "paste(delta ^ \\1, \\2)", `^210Pb$` =
    "paste({}^210, Pb)", `^Pb210$` = "paste({}^210, Pb)"),
  multi_line = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="label_geochem_+3A_labels">labels</code></td>
<td>
<p>A data.frame of facet label values</p>
</td></tr>
<tr><td><code id="label_geochem_+3A_units">units</code></td>
<td>
<p>A named list of values = unit</p>
</td></tr>
<tr><td><code id="label_geochem_+3A_default_units">default_units</code></td>
<td>
<p>The default units to apply</p>
</td></tr>
<tr><td><code id="label_geochem_+3A_geochem_facet">geochem_facet</code></td>
<td>
<p>Which facet to apply formatting</p>
</td></tr>
<tr><td><code id="label_geochem_+3A_renamers">renamers</code></td>
<td>
<p>Search and replace operations to perform in the form
search = replace. Replace text can (should) contain backreferences,
and will be parsed as an expression (see <a href="grDevices.html#topic+plotmath">plotmath</a>). Use
NULL to suppress renaming.</p>
</td></tr>
<tr><td><code id="label_geochem_+3A_multi_line">multi_line</code></td>
<td>
<p>See <a href="ggplot2.html#topic+labellers">label_parsed</a></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+labeller">ggplot2::labeller()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(ggplot2)

ggplot(alta_lake_geochem, aes(x = value, y = depth)) +
  geom_lineh() +
  geom_point() +
  scale_y_reverse() +
  facet_wrap(
    vars(param),
    labeller = purrr::partial(label_geochem, geochem_facet = "param"),
    nrow = 1,
    scales = "free_x"
  ) +
  labs(x = NULL, y = "Depth (cm)")

</code></pre>

<hr>
<h2 id='label_species'>Species facet labellers</h2><span id='topic+label_species'></span>

<h3>Description</h3>

<p>Use these to label species with partial italic formatting. See <a href="ggplot2.html#topic+labellers">label_parsed</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>label_species(
  labels,
  dont_italicize = c("\\(.*?\\)", "spp?\\.", "-complex", "[Oo]ther"),
  species_facet = 1,
  multi_line = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="label_species_+3A_labels">labels</code></td>
<td>
<p>A data.frame of facet label values</p>
</td></tr>
<tr><td><code id="label_species_+3A_dont_italicize">dont_italicize</code></td>
<td>
<p>Regular expressions that should not be italicized</p>
</td></tr>
<tr><td><code id="label_species_+3A_species_facet">species_facet</code></td>
<td>
<p>Which facet(s) contain species values</p>
</td></tr>
<tr><td><code id="label_species_+3A_multi_line">multi_line</code></td>
<td>
<p>See <a href="ggplot2.html#topic+labellers">label_parsed</a></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+labeller">ggplot2::labeller()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(ggplot2)

ggplot(keji_lakes_plottable, aes(x = rel_abund, y = depth)) +
  geom_col_segsh() +
  scale_y_reverse() +
  facet_grid(
    cols = vars(taxon),
    rows = vars(location),
    scales = "free_x",
    space = "free_x",
    labeller = purrr::partial(label_species, species_facet = "taxon")
  ) +
  labs(y = "Depth (cm)")

</code></pre>

<hr>
<h2 id='layer_dendrogram'>Add a dendrogram as a layer or facet</h2><span id='topic+layer_dendrogram'></span><span id='topic+plot_layer_dendrogram'></span><span id='topic+layer_zone_boundaries'></span>

<h3>Description</h3>

<p>Add a dendrogram as a layer or facet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>layer_dendrogram(
  object,
  mapping,
  ...,
  colour = "black",
  size = 0.5,
  linetype = 1,
  alpha = NA,
  sequential_facets = TRUE
)

plot_layer_dendrogram(object, mapping, ..., panel_label = "CONISS")

layer_zone_boundaries(
  object,
  mapping,
  ...,
  linetype = 2,
  alpha = 0.7,
  colour = "black",
  size = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="layer_dendrogram_+3A_object">object</code></td>
<td>
<p>A <a href="#topic+nested_hclust">nested_hclust</a> object.</p>
</td></tr>
<tr><td><code id="layer_dendrogram_+3A_mapping">mapping</code></td>
<td>
<p>Map at least one axis (x or y) to a qualifier, like <code>aes(x = depth)</code> or similar.</p>
</td></tr>
<tr><td><code id="layer_dendrogram_+3A_...">...</code></td>
<td>
<p>Use facet_var = &quot;CONISS&quot; or similar to name the panel</p>
</td></tr>
<tr><td><code id="layer_dendrogram_+3A_linetype">linetype</code>, <code id="layer_dendrogram_+3A_alpha">alpha</code>, <code id="layer_dendrogram_+3A_colour">colour</code>, <code id="layer_dendrogram_+3A_size">size</code></td>
<td>
<p>Customize the apperance of boundary/dendrogram segment lines</p>
</td></tr>
<tr><td><code id="layer_dendrogram_+3A_sequential_facets">sequential_facets</code></td>
<td>
<p>TRUE will result in the panel containing the dendrogram added to the right
of the plot.</p>
</td></tr>
<tr><td><code id="layer_dendrogram_+3A_panel_label">panel_label</code></td>
<td>
<p>Use to label a pane on a stanalone dendrogram plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+layer">ggplot2::layer()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
library(dplyr, warn.conflicts = FALSE)

alta_coniss &lt;- nested_data(
  alta_lake_geochem,
  qualifiers = c(age, depth, zone),
  key = param,
  value = value,
  trans = scale
) %&gt;%
  nested_chclust_coniss()

ggplot() +
  layer_dendrogram(alta_coniss, aes(y = depth)) +
  scale_y_reverse()

</code></pre>

<hr>
<h2 id='layer_scores'>Add scores to a plot</h2><span id='topic+layer_scores'></span><span id='topic+plot_layer_scores'></span>

<h3>Description</h3>

<p>Add scores to a plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>layer_scores(
  object,
  mapping = NULL,
  which = "PC1",
  key = "param",
  value = "value",
  scores_geom = list(ggplot2::geom_path(), ggplot2::geom_point()),
  sequential_facets = TRUE
)

plot_layer_scores(
  object,
  mapping,
  which = "PC1",
  key = "param",
  value = "value",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="layer_scores_+3A_object">object</code></td>
<td>
<p>A <a href="#topic+nested_prcomp">nested_prcomp</a> or similar object</p>
</td></tr>
<tr><td><code id="layer_scores_+3A_mapping">mapping</code></td>
<td>
<p>A mapping created with <a href="ggplot2.html#topic+aes">aes</a></p>
</td></tr>
<tr><td><code id="layer_scores_+3A_which">which</code></td>
<td>
<p>Which principal components to plot</p>
</td></tr>
<tr><td><code id="layer_scores_+3A_key">key</code></td>
<td>
<p>The column name to use for the principal component names</p>
</td></tr>
<tr><td><code id="layer_scores_+3A_value">value</code></td>
<td>
<p>The column name to use for the principal component score values</p>
</td></tr>
<tr><td><code id="layer_scores_+3A_scores_geom">scores_geom</code></td>
<td>
<p>One or more geometries to which scores should be applied.</p>
</td></tr>
<tr><td><code id="layer_scores_+3A_sequential_facets">sequential_facets</code></td>
<td>
<p>TRUE will result in the panel containing the dendrogram added to the right
of the plot.</p>
</td></tr>
<tr><td><code id="layer_scores_+3A_...">...</code></td>
<td>
<p>Passed to layer_scores()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list()</code> that can be addeed to a <code><a href="ggplot2.html#topic+ggplot">ggplot2::ggplot()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
library(dplyr, warn.conflicts = FALSE)

alta_pca &lt;- nested_data(
  alta_lake_geochem,
  qualifiers = c(age, depth, zone),
  key = param,
  value = value,
  trans = scale
) %&gt;%
  nested_prcomp()

ggplot() +
  layer_scores(alta_pca, aes(value, depth), which = "PC1") +
  scale_y_reverse()

plot_layer_scores(alta_pca, aes(y = depth), which = c("PC1", "PC2")) +
  scale_y_reverse()

</code></pre>

<hr>
<h2 id='long_lake_14C_ages'>Long Lake Carbon-14 Ages</h2><span id='topic+long_lake_14C_ages'></span><span id='topic+long_lake_bacon_ages'></span><span id='topic+long_lake_plottable'></span>

<h3>Description</h3>

<p>This object contains several uncalibrated Carbon-14 measurements from Long
Lake (Nova Scotia-New Brunswick Border Region, Canada) core LL-PC2
(Dunnington et al. 2017; White 2012). The <code>long_lake_bacon_ages</code> object
contains the result of the Carbon-14 ages as
modelled by the rbacon package (Blaauw and Christen 2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>long_lake_14C_ages

long_lake_bacon_ages

long_lake_plottable
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 5 rows and 5 columns.
</p>
<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 86 rows and 5 columns.
</p>
<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 51 rows and 10 columns.
</p>


<h3>References</h3>

<p>Blaauw, Maarten, and J. Andrés Christen. &quot;Flexible Paleoclimate Age-Depth
Models Using an Autoregressive Gamma Process.&quot; Bayesian Analysis 6, no. 3
(September 2011): 457–74. <a href="https://doi.org/10.1214/ba/1339616472">doi:10.1214/ba/1339616472</a>.
</p>
<p>Dunnington, Dewey W., Hilary White, Ian S. Spooner, Mark L. Mallory, Chris
White, Nelson J. O’Driscoll, and Nic R. McLellan. &quot;A Paleolimnological
Archive of Metal Sequestration and Release in the Cumberland Basin Marshes,
Atlantic Canada.&quot; FACETS 2, no. 1 (May 23, 2017): 440–60.
<a href="https://doi.org/10.1139/facets-2017-0004">doi:10.1139/facets-2017-0004</a>.
</p>
<p>White, Hilary E. &quot;Paleolimnological Records of Post-Glacial Lake
and Wetland Evolution from the Isthmus of Chignecto Region, Eastern Canada.&quot;
M.Sc. Thesis, Acadia University, 2012.
<a href="https://scholar.acadiau.ca/islandora/object/theses:247">https://scholar.acadiau.ca/islandora/object/theses:247</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>long_lake_14C_ages
long_lake_bacon_ages
long_lake_plottable

</code></pre>

<hr>
<h2 id='nested_analysis'>Perform an analysis on a nested data matrix</h2><span id='topic+nested_analysis'></span>

<h3>Description</h3>

<p>Perform an analysis on a nested data matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nested_analysis(
  .data,
  .fun,
  ...,
  .output_column = "model",
  .reserved_names = NULL,
  .env = parent.frame()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nested_analysis_+3A_.data">.data</code></td>
<td>
<p>A data frame with a list column of data frames, possibly created using
<a href="#topic+nested_data">nested_data</a>.</p>
</td></tr>
<tr><td><code id="nested_analysis_+3A_.fun">.fun</code></td>
<td>
<p>A model function</p>
</td></tr>
<tr><td><code id="nested_analysis_+3A_...">...</code></td>
<td>
<p>Passed to fun</p>
</td></tr>
<tr><td><code id="nested_analysis_+3A_.output_column">.output_column</code></td>
<td>
<p>A column name in which the output of .fun should be stored.</p>
</td></tr>
<tr><td><code id="nested_analysis_+3A_.reserved_names">.reserved_names</code></td>
<td>
<p>Names that should not be allowed as columns in any
data frame within this object</p>
</td></tr>
<tr><td><code id="nested_analysis_+3A_.env">.env</code></td>
<td>
<p>Passed to <a href="rlang.html#topic+as_function">as_function</a></p>
</td></tr>
</table>


<h3>Value</h3>

<p>.data with an additional list column of fun output
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nd &lt;- nested_data(
  alta_lake_geochem,
  qualifiers = c(age, depth, zone),
  key = param,
  value = value,
  trans = scale
)

na &lt;- nested_analysis(nd, vegan::rda, X = data)
plot(na)

</code></pre>

<hr>
<h2 id='nested_data'>Prepare a parameter-long data frame for statistical analysis</h2><span id='topic+nested_data'></span><span id='topic+unnested_data'></span>

<h3>Description</h3>

<p>Prepare a parameter-long data frame for statistical analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nested_data(
  .data,
  qualifiers = NULL,
  key = NULL,
  value,
  fill = NA,
  select_if = ~TRUE,
  filter_all = any_vars(TRUE),
  trans = identity,
  groups = NULL
)

unnested_data(.data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nested_data_+3A_.data">.data</code></td>
<td>
<p>Data in parameter-long form</p>
</td></tr>
<tr><td><code id="nested_data_+3A_qualifiers">qualifiers</code></td>
<td>
<p>Columns that add context to observations (e.g., depth, zone, core)</p>
</td></tr>
<tr><td><code id="nested_data_+3A_key">key</code></td>
<td>
<p>The column name that contains the column names of the data matrix</p>
</td></tr>
<tr><td><code id="nested_data_+3A_value">value</code></td>
<td>
<p>The column name that contains the values</p>
</td></tr>
<tr><td><code id="nested_data_+3A_fill">fill</code></td>
<td>
<p>If a key/value combination doesn't exist in the input, this value will be
assigned in the data matrix. Generally, using NA for geochemical data and 0 for relative
abundance data is advised.</p>
</td></tr>
<tr><td><code id="nested_data_+3A_select_if">select_if</code></td>
<td>
<p>Use <code>~TRUE</code> to keep all columns; use <code>~all(is.finite(.))</code> to keep columns
with all finite values. See <a href="dplyr.html#topic+select_all">select_if</a>.</p>
</td></tr>
<tr><td><code id="nested_data_+3A_filter_all">filter_all</code></td>
<td>
<p>Use <code>any_vars(TRUE)</code> to keep all observations; use <code>all_vars(is.finite(.))</code> to
keep only observations with finite (non-missing) values. See <a href="dplyr.html#topic+filter_all">filter_all</a>.</p>
</td></tr>
<tr><td><code id="nested_data_+3A_trans">trans</code></td>
<td>
<p>A function that will be applied to all columns, column-wise. Use <a href="base.html#topic+identity">identity</a>
to perform no transformation, use <a href="base.html#topic+scale">scale</a> to scale each column to a mean of zero and
variance of 1. See <a href="dplyr.html#topic+mutate_all">mutate_all</a>.</p>
</td></tr>
<tr><td><code id="nested_data_+3A_groups">groups</code></td>
<td>
<p>Use <a href="dplyr.html#topic+group_by">group_by</a> or this argument to group by one or more columns (e.g., core or lake)</p>
</td></tr>
<tr><td><code id="nested_data_+3A_...">...</code></td>
<td>
<p>One or more columns to unnest.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A nested data matrix, which is composed of a <code><a href="tibble.html#topic+tibble">tibble::tibble()</a></code>
with tibble list-columns <code>data</code>, <code>discarded_rows</code>, <code>discarded_columns</code>, and
<code>qualifiers</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nested_data(
  alta_lake_geochem,
  qualifiers = c(age, depth, zone),
  key = param,
  value = value,
  trans = scale
)

</code></pre>

<hr>
<h2 id='nested_hclust'>Nested (Constrained) hierarchical clustering</h2><span id='topic+nested_hclust'></span><span id='topic+nested_chclust_conslink'></span><span id='topic+nested_chclust_coniss'></span>

<h3>Description</h3>

<p>Powered by <a href="rioja.html#topic+chclust">chclust</a> and <a href="stats.html#topic+hclust">hclust</a>; broken stick using <a href="rioja.html#topic+chclust">bstick</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nested_hclust(
  .data,
  data_column = "data",
  qualifiers_column = "qualifiers",
  distance_fun = stats::dist,
  n_groups = NULL,
  ...,
  .fun = stats::hclust,
  .reserved_names = character(0)
)

nested_chclust_conslink(
  .data,
  data_column = "data",
  qualifiers_column = "qualifiers",
  distance_fun = stats::dist,
  n_groups = NULL,
  ...
)

nested_chclust_coniss(
  .data,
  data_column = "data",
  qualifiers_column = "qualifiers",
  distance_fun = stats::dist,
  n_groups = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nested_hclust_+3A_.data">.data</code></td>
<td>
<p>A data frame with a list column of data frames, possibly created using
<a href="#topic+nested_data">nested_data</a>.</p>
</td></tr>
<tr><td><code id="nested_hclust_+3A_data_column">data_column</code></td>
<td>
<p>An expression that evalulates to the data object within each row of .data</p>
</td></tr>
<tr><td><code id="nested_hclust_+3A_qualifiers_column">qualifiers_column</code></td>
<td>
<p>The column that contains the qualifiers</p>
</td></tr>
<tr><td><code id="nested_hclust_+3A_distance_fun">distance_fun</code></td>
<td>
<p>A distance function like <a href="stats.html#topic+dist">dist</a> or <a href="vegan.html#topic+vegdist">vegdist</a>.</p>
</td></tr>
<tr><td><code id="nested_hclust_+3A_n_groups">n_groups</code></td>
<td>
<p>The number of groups to use (can be a vector or expression using vars in .data)</p>
</td></tr>
<tr><td><code id="nested_hclust_+3A_...">...</code></td>
<td>
<p>Passed to <a href="rioja.html#topic+chclust">chclust</a> or <a href="stats.html#topic+hclust">hclust</a>.</p>
</td></tr>
<tr><td><code id="nested_hclust_+3A_.fun">.fun</code></td>
<td>
<p>Function powering the clustering. Must return an hclust object of some kind.</p>
</td></tr>
<tr><td><code id="nested_hclust_+3A_.reserved_names">.reserved_names</code></td>
<td>
<p>Names that should not be allowed as columns in any
data frame within this object</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>.data</code> with additional columns
</p>


<h3>References</h3>

<p>Bennett, K. (1996) Determination of the number of zones in a biostratigraphic sequence.
New Phytologist, 132, 155-170.
<a href="https://doi.org/10.1111/j.1469-8137.1996.tb04521.x">doi:10.1111/j.1469-8137.1996.tb04521.x</a> (Broken stick)
</p>
<p>Grimm, E.C. (1987) CONISS: A FORTRAN 77 program for stratigraphically constrained cluster
analysis by the method of incremental sum of squares. Computers &amp; Geosciences, 13, 13-35.
<a href="https://doi.org/10.1016/0098-3004%2887%2990022-7">doi:10.1016/0098-3004(87)90022-7</a>
</p>
<p>Juggins, S. (2017) rioja: Analysis of Quaternary Science Data, R package version (0.9-15.1).
(<a href="https://cran.r-project.org/package=rioja">https://cran.r-project.org/package=rioja</a>).
</p>
<p>See <a href="stats.html#topic+hclust">hclust</a> for hierarchical clustering references
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(tidyr)
library(dplyr, warn.conflicts = FALSE)

nested_coniss &lt;- keji_lakes_plottable %&gt;%
  group_by(location) %&gt;%
  nested_data(depth, taxon, rel_abund, fill = 0) %&gt;%
  nested_chclust_coniss()

# plot the dendrograms using base graphics
plot(nested_coniss, main = location, ncol = 1)

# plot broken stick dispersion to verify number of plausible groups
library(ggplot2)

nested_coniss %&gt;%
  select(location, broken_stick) %&gt;%
  unnest(broken_stick) %&gt;%
  tidyr::gather(type, value, broken_stick_dispersion, dispersion) %&gt;%
  ggplot(aes(x = n_groups, y = value, col = type)) +
  geom_line() +
  geom_point() +
  facet_wrap(vars(location))

</code></pre>

<hr>
<h2 id='nested_prcomp'>Nested Principal Components Analysis (PCA)</h2><span id='topic+nested_prcomp'></span>

<h3>Description</h3>

<p>Powered by <a href="stats.html#topic+prcomp">prcomp</a>. When creating the <a href="#topic+nested_data">nested_data</a>,
the data should be scaled (i.e, <code>trans = scale</code>) if all variables are not
in the same unit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nested_prcomp(.data, data_column = .data$data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nested_prcomp_+3A_.data">.data</code></td>
<td>
<p>A data frame with a list column of data frames, possibly created using
<a href="#topic+nested_data">nested_data</a>.</p>
</td></tr>
<tr><td><code id="nested_prcomp_+3A_data_column">data_column</code></td>
<td>
<p>An expression that evalulates to the data object within each row of .data</p>
</td></tr>
<tr><td><code id="nested_prcomp_+3A_...">...</code></td>
<td>
<p>Passed to <a href="stats.html#topic+prcomp">prcomp</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>.data with additional columns 'model', 'loadings', 'variance' and 'scores'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr, warn.conflicts = FALSE)

nested_pca &lt;- alta_lake_geochem %&gt;%
  nested_data(
    qualifiers = c(depth, zone),
    key = param,
    value = value,
    trans = scale
  ) %&gt;%
  nested_prcomp()

# get variance info
nested_pca %&gt;% unnested_data(variance)

# get loadings info
nested_pca %&gt;% unnested_data(loadings)

# scores, requalified
nested_pca %&gt;% unnested_data(c(qualifiers, scores))

</code></pre>

<hr>
<h2 id='plot.age_depth_model'>Plot an age depth model using base graphics</h2><span id='topic+plot.age_depth_model'></span>

<h3>Description</h3>

<p>Plot an age depth model using base graphics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'age_depth_model'
plot(
  x,
  xlab = "depth",
  ylab = "age",
  xlim = NULL,
  ylim = NULL,
  add = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.age_depth_model_+3A_x">x</code></td>
<td>
<p>An <a href="#topic+age_depth_model">age_depth_model</a></p>
</td></tr>
<tr><td><code id="plot.age_depth_model_+3A_xlab">xlab</code>, <code id="plot.age_depth_model_+3A_ylab">ylab</code></td>
<td>
<p>Axis labels</p>
</td></tr>
<tr><td><code id="plot.age_depth_model_+3A_xlim">xlim</code>, <code id="plot.age_depth_model_+3A_ylim">ylim</code></td>
<td>
<p>Axis limits</p>
</td></tr>
<tr><td><code id="plot.age_depth_model_+3A_add">add</code></td>
<td>
<p>Pass TRUE to skip creating a new plot</p>
</td></tr>
<tr><td><code id="plot.age_depth_model_+3A_...">...</code></td>
<td>
<p>Passed to <a href="graphics.html#topic+points">points</a> to customize points display</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input, invisibly
</p>


<h3>Examples</h3>

<pre><code class='language-R'>adm &lt;- age_depth_model(
  alta_lake_210Pb_ages,
  depth = depth_cm, age = age_year_ad,
  age_max = age_year_ad + age_error_yr,
  age_min = age_year_ad - age_error_yr
)

plot(adm)

</code></pre>

<hr>
<h2 id='plot.nested_analysis'>Plot a nested analysis</h2><span id='topic+plot.nested_analysis'></span><span id='topic+plot_nested_analysis'></span><span id='topic+biplot.nested_prcomp'></span>

<h3>Description</h3>

<p>Calls <a href="graphics.html#topic+plot.default">plot</a> or another (base) plotting function on all models, arranging the output in subplots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nested_analysis'
plot(x, ..., main = "", nrow = NULL, ncol = NULL)

plot_nested_analysis(
  .x,
  .fun,
  ...,
  nrow = NULL,
  ncol = NULL,
  .model_column = .data$model,
  .output_column = NULL
)

## S3 method for class 'nested_prcomp'
biplot(x, ..., nrow = NULL, ncol = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.nested_analysis_+3A_x">x</code>, <code id="plot.nested_analysis_+3A_.x">.x</code></td>
<td>
<p>A <a href="#topic+nested_analysis">nested_analysis</a> object (or subclass)</p>
</td></tr>
<tr><td><code id="plot.nested_analysis_+3A_...">...</code></td>
<td>
<p>Passed to the plot function. Tidy evaluation is supported, and arguments are evaluated
within a transposed version of x for each row.</p>
</td></tr>
<tr><td><code id="plot.nested_analysis_+3A_main">main</code></td>
<td>
<p>The plot title</p>
</td></tr>
<tr><td><code id="plot.nested_analysis_+3A_nrow">nrow</code>, <code id="plot.nested_analysis_+3A_ncol">ncol</code></td>
<td>
<p>Force a number of rows or columns in the output</p>
</td></tr>
<tr><td><code id="plot.nested_analysis_+3A_.fun">.fun</code></td>
<td>
<p>A function that produces graphical output</p>
</td></tr>
<tr><td><code id="plot.nested_analysis_+3A_.model_column">.model_column</code></td>
<td>
<p>The column containing the model</p>
</td></tr>
<tr><td><code id="plot.nested_analysis_+3A_.output_column">.output_column</code></td>
<td>
<p>The column in which the output of the plot function should be placed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the input, invisibly
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nd &lt;- nested_data(
  alta_lake_geochem,
  qualifiers = c(age, depth, zone),
  key = param,
  value = value,
  trans = scale
)

na &lt;- nested_analysis(nd, vegan::rda, X = data)
plot(na)

</code></pre>

<hr>
<h2 id='predict.age_depth_model'>Predict age and depth values</h2><span id='topic+predict.age_depth_model'></span><span id='topic+predict_depth'></span><span id='topic+predict_age'></span>

<h3>Description</h3>

<p>Predict age and depth values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'age_depth_model'
predict(object, .data = NULL, depth = NULL, age = NULL, ...)

predict_depth(object, age)

predict_age(object, depth)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.age_depth_model_+3A_object">object</code></td>
<td>
<p>An <a href="#topic+age_depth_model">age_depth_model</a> object</p>
</td></tr>
<tr><td><code id="predict.age_depth_model_+3A_.data">.data</code></td>
<td>
<p>Optional input data frame</p>
</td></tr>
<tr><td><code id="predict.age_depth_model_+3A_depth">depth</code>, <code id="predict.age_depth_model_+3A_age">age</code></td>
<td>
<p>Specify exactly one of these to predict the other.</p>
</td></tr>
<tr><td><code id="predict.age_depth_model_+3A_...">...</code></td>
<td>
<p>Unused</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the same number of observations as the input age or
depth vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>adm &lt;- age_depth_model(
  alta_lake_210Pb_ages,
  depth = depth_cm, age = age_year_ad,
  age_max = age_year_ad + age_error_yr,
  age_min = age_year_ad - age_error_yr
)

predict(adm, depth = 1:5)

</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+first'></span><span id='topic+last'></span><span id='topic+vars'></span><span id='topic+position_fillv'></span><span id='topic+PositionFillv'></span><span id='topic+position_stackv'></span><span id='topic+PositionStackv'></span><span id='topic+position_dodge2v'></span><span id='topic+PositionDodge2v'></span><span id='topic+position_dodgev'></span><span id='topic+PositionDodgev'></span><span id='topic+geom_colh'></span><span id='topic+GeomColh'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>dplyr</dt><dd><p><code><a href="dplyr.html#topic+nth">first</a></code>, <code><a href="dplyr.html#topic+nth">last</a></code></p>
</dd>
<dt>ggplot2</dt><dd><p><code><a href="ggplot2.html#topic+vars">vars</a></code></p>
</dd>
<dt>ggstance</dt><dd><p><code><a href="ggstance.html#topic+ggstance-ggproto">GeomColh</a></code>, <code><a href="ggstance.html#topic+ggstance-ggproto">PositionDodge2v</a></code>, <code><a href="ggstance.html#topic+ggstance-ggproto">PositionDodgev</a></code>, <code><a href="ggstance.html#topic+ggstance-ggproto">PositionFillv</a></code>, <code><a href="ggstance.html#topic+ggstance-ggproto">PositionStackv</a></code>, <code><a href="ggstance.html#topic+geom_barh">geom_colh</a></code>, <code><a href="ggstance.html#topic+position-vertical">position_dodge2v</a></code>, <code><a href="ggstance.html#topic+position-vertical">position_dodgev</a></code>, <code><a href="ggstance.html#topic+position-vertical">position_fillv</a></code>, <code><a href="ggstance.html#topic+position-vertical">position_stackv</a></code></p>
</dd>
</dl>

<hr>
<h2 id='rotated_facet_labels'>Common plot modifications for stratigraphic plots</h2><span id='topic+rotated_facet_labels'></span><span id='topic+rotated_axis_labels'></span>

<h3>Description</h3>

<p>Common plot modifications for stratigraphic plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rotated_facet_labels(
  angle = 45,
  direction = "x",
  remove_label_background = TRUE
)

rotated_axis_labels(angle = 90, direction = "x")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rotated_facet_labels_+3A_angle">angle</code></td>
<td>
<p>The angle at which labels should be rotated</p>
</td></tr>
<tr><td><code id="rotated_facet_labels_+3A_direction">direction</code></td>
<td>
<p>The axes along which the operations should be performed</p>
</td></tr>
<tr><td><code id="rotated_facet_labels_+3A_remove_label_background">remove_label_background</code></td>
<td>
<p>Whether or not label backgrounds should be removed along
rotated label axes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object or list of objects that can be added to a <a href="ggplot2.html#topic+ggplot">ggplot</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

ggplot(mpg, aes(cty, hwy)) +
  geom_point() +
  facet_wrap(vars(class)) +
  rotated_facet_labels(45, "x")

</code></pre>

<hr>
<h2 id='scale_x_abundance'>Scales for relative abundance values</h2><span id='topic+scale_x_abundance'></span><span id='topic+scale_y_abundance'></span>

<h3>Description</h3>

<p>Continuous scales that (1) always start at 0, (2) always have the same breaks, and
(3) expand using a constant rather than a percentage. These scales assume that data are
in percentages (i.e., range 0 to 100 rather than 0 to 1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_x_abundance(
  ...,
  limits = c(0, NA),
  breaks = seq(10, 90, 30),
  minor_breaks = seq(0, 100, 10),
  expand = c(0, 1)
)

scale_y_abundance(
  ...,
  limits = c(0, NA),
  breaks = seq(10, 90, 30),
  minor_breaks = seq(0, 100, 10),
  expand = c(0, 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_x_abundance_+3A_...">...</code></td>
<td>
<p>Passed to <a href="ggplot2.html#topic+scale_continuous">scale_y_continuous</a> or <a href="ggplot2.html#topic+scale_continuous">scale_x_continuous</a></p>
</td></tr>
<tr><td><code id="scale_x_abundance_+3A_limits">limits</code></td>
<td>
<p>Limits for the scale</p>
</td></tr>
<tr><td><code id="scale_x_abundance_+3A_breaks">breaks</code></td>
<td>
<p>Where to place labels on the scale</p>
</td></tr>
<tr><td><code id="scale_x_abundance_+3A_minor_breaks">minor_breaks</code></td>
<td>
<p>Where to place minor breaks</p>
</td></tr>
<tr><td><code id="scale_x_abundance_+3A_expand">expand</code></td>
<td>
<p>A vector of expantion constants</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="ggplot2.html#topic+scale_continuous">scale_y_continuous</a> or <a href="ggplot2.html#topic+scale_continuous">scale_x_continuous</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr, warn.conflicts = FALSE)
library(ggplot2)

keji_lakes_plottable %&gt;%
  filter(taxon == "Other", location == "Beaverskin Lake") %&gt;%
  ggplot(aes(rel_abund, depth)) +
  geom_col_segsh() +
  scale_x_abundance() +
  scale_y_reverse()

</code></pre>

<hr>
<h2 id='scale_y_depth_age'>Age-depth scales</h2><span id='topic+scale_y_depth_age'></span><span id='topic+scale_y_age_depth'></span><span id='topic+scale_x_depth_age'></span><span id='topic+scale_x_age_depth'></span>

<h3>Description</h3>

<p>Age-depth scales
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_y_depth_age(
  model = NULL,
  age_name = "age",
  age_breaks = waiver(),
  age_labels = waiver(),
  ...
)

scale_y_age_depth(
  model = NULL,
  reversed = FALSE,
  depth_name = "depth",
  depth_breaks = waiver(),
  depth_labels = waiver(),
  ...
)

scale_x_depth_age(
  model = NULL,
  age_name = "age",
  age_breaks = waiver(),
  age_labels = waiver(),
  ...
)

scale_x_age_depth(
  model = NULL,
  reversed = FALSE,
  depth_name = "depth",
  depth_breaks = waiver(),
  depth_labels = waiver(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_y_depth_age_+3A_model">model</code></td>
<td>
<p>An age-depth model, or NULL to suppress the second axis</p>
</td></tr>
<tr><td><code id="scale_y_depth_age_+3A_age_name">age_name</code>, <code id="scale_y_depth_age_+3A_depth_name">depth_name</code></td>
<td>
<p>Label for the second axis</p>
</td></tr>
<tr><td><code id="scale_y_depth_age_+3A_age_breaks">age_breaks</code>, <code id="scale_y_depth_age_+3A_depth_breaks">depth_breaks</code></td>
<td>
<p>Breaks for the second axis</p>
</td></tr>
<tr><td><code id="scale_y_depth_age_+3A_age_labels">age_labels</code>, <code id="scale_y_depth_age_+3A_depth_labels">depth_labels</code></td>
<td>
<p>Labels for each break on the second axis</p>
</td></tr>
<tr><td><code id="scale_y_depth_age_+3A_...">...</code></td>
<td>
<p>Passed to <a href="ggplot2.html#topic+scale_continuous">scale_y_continuous</a> or <a href="ggplot2.html#topic+scale_continuous">scale_x_continuous</a></p>
</td></tr>
<tr><td><code id="scale_y_depth_age_+3A_reversed">reversed</code></td>
<td>
<p>Reverse the primary age axis (for years BP or similar)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="ggplot2.html#topic+scale_continuous">scale_y_continuous</a> or <a href="ggplot2.html#topic+scale_continuous">scale_x_continuous</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
library(dplyr, warn.conflicts = FALSE)

adm &lt;- age_depth_model(
  alta_lake_210Pb_ages,
  depth = depth_cm, age = age_year_ad
)

alta_lake_geochem %&gt;%
  filter(param == "Cu") %&gt;%
  ggplot(aes(value, depth)) +
  geom_point() +
  scale_y_depth_age(adm)

</code></pre>

<hr>
<h2 id='sequential_layer_facets'>Change facet ordering behaviour</h2><span id='topic+sequential_layer_facets'></span>

<h3>Description</h3>

<p>Normally, facets are ordered using <a href="base.html#topic+factor">as.factor</a> on all values that occur
within layer data, which means that when adding additional layers, any ordering
is not preserved unless the factor levels are identical on all factors. This function
changes this behaviour such that facet levels are combined in layer order. This is
useful when adding standalone layers to a plot without disturbing the existing order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sequential_layer_facets(reverse = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sequential_layer_facets_+3A_reverse">reverse</code></td>
<td>
<p>Use TRUE to process layers in reverse order</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object that can be added to a <code><a href="ggplot2.html#topic+ggplot">ggplot2::ggplot()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

p &lt;- ggplot(mapping = aes(x, y)) +
  geom_point(data = data.frame(x = 1:5, y = 1:5, facet = "b")) +
  geom_point(data = data.frame(x = 1:5, y = 1:5, facet = "a")) +
  facet_wrap(vars(facet))

p
p + sequential_layer_facets()

</code></pre>

<hr>
<h2 id='stat_nested_hclust'>Display a dendrogram as a ggplot2 layer</h2><span id='topic+stat_nested_hclust'></span><span id='topic+StatNestedHclust'></span>

<h3>Description</h3>

<p>Display a dendrogram as a ggplot2 layer
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_nested_hclust(
  mapping = NULL,
  data = NULL,
  geom = "segment",
  position = "identity",
  ...,
  inherit.aes = TRUE,
  show.legend = NA
)

StatNestedHclust
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_nested_hclust_+3A_mapping">mapping</code></td>
<td>
<p>A mapping created using <a href="ggplot2.html#topic+aes">aes</a>. Must map x OR y to a qualifier.</p>
</td></tr>
<tr><td><code id="stat_nested_hclust_+3A_data">data</code></td>
<td>
<p>A <a href="#topic+nested_hclust">nested_hclust</a> object</p>
</td></tr>
<tr><td><code id="stat_nested_hclust_+3A_geom">geom</code></td>
<td>
<p>Any geom that takes x, xend, y, and yend. Probably <a href="ggplot2.html#topic+geom_segment">geom_segment</a> is
the only one that makes sense.</p>
</td></tr>
<tr><td><code id="stat_nested_hclust_+3A_position">position</code></td>
<td>
<p>Position adjustment</p>
</td></tr>
<tr><td><code id="stat_nested_hclust_+3A_...">...</code></td>
<td>
<p>Passed to the the stat/geom (see <a href="ggplot2.html#topic+geom_segment">geom_segment</a>)</p>
</td></tr>
<tr><td><code id="stat_nested_hclust_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>Inherit aesthetics from ggplot()?</p>
</td></tr>
<tr><td><code id="stat_nested_hclust_+3A_show.legend">show.legend</code></td>
<td>
<p>Show mapped aesthetics in the legend?</p>
</td></tr>
</table>


<h3>Format</h3>

<p>An object of class <code>StatNestedHclust</code> (inherits from <code>Stat</code>, <code>ggproto</code>, <code>gg</code>) of length 4.
</p>


<h3>Value</h3>

<p>A <a href="ggplot2.html#topic+ggplot2-ggproto">ggplot2::Stat</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
library(dplyr, warn.conflicts = FALSE)

alta_coniss &lt;- nested_data(
  alta_lake_geochem,
  qualifiers = c(age, depth, zone),
  key = param,
  value = value,
  trans = scale
) %&gt;%
  nested_chclust_coniss()

ggplot(alta_coniss) +
  stat_nested_hclust(aes(model = model, y = depth)) +
  scale_y_reverse()

</code></pre>

<hr>
<h2 id='theme_paleo'>A Paleo-friendly ggplot2 theme</h2><span id='topic+theme_paleo'></span>

<h3>Description</h3>

<p>Essentially, this is <code><a href="ggplot2.html#topic+ggtheme">ggplot2::theme_bw()</a></code> with a few modifications
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theme_paleo(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="theme_paleo_+3A_...">...</code></td>
<td>
<p>Passed to <code><a href="ggplot2.html#topic+ggtheme">ggplot2::theme_bw()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A complete <code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

ggplot(mpg, aes(cty, hwy)) +
  geom_point() +
  theme_paleo()

</code></pre>

<hr>
<h2 id='tidypaleo-package'>tidypaleo: Tidy Tools for Paleoenvironmental Archives</h2><span id='topic+tidypaleo'></span><span id='topic+tidypaleo-package'></span>

<h3>Description</h3>

<p>Provides a set of functions with a common framework for age-depth model management, stratigraphic visualization, and common statistical transformations. The focus of the package is stratigraphic visualization, for which 'ggplot2' components are provided to reproduce the scales, geometries, facets, and theme elements commonly used in publication-quality stratigraphic diagrams. Helpers are also provided to reproduce the exploratory statistical summaries that are frequently included on stratigraphic diagrams. See Dunnington et al. (2021) <a href="https://doi.org/10.18637/jss.v101.i07">doi:10.18637/jss.v101.i07</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Dewey Dunnington <a href="mailto:dewey@fishandwhistle.net">dewey@fishandwhistle.net</a> (<a href="https://orcid.org/0000-0002-9415-4582">ORCID</a>) [copyright holder]
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://paleolimbot.github.io/tidypaleo/">https://paleolimbot.github.io/tidypaleo/</a>
</p>
</li>
<li> <p><a href="https://github.com/paleolimbot/tidypaleo">https://github.com/paleolimbot/tidypaleo</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/paleolimbot/tidypaleo/issues">https://github.com/paleolimbot/tidypaleo/issues</a>
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
