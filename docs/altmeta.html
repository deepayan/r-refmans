<!DOCTYPE html><html><head><title>Help for package altmeta</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {altmeta}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dat.adams'>
<p>A Meta-Analysis on the Effects of Fluvastatin 20 mg/day on High-Density Lipoprotein</p></a></li>
<li><a href='#dat.aex'>
<p>A Meta-Analysis for Evaluating the Effect of Aerobic Exercise on Visceral Adipose Tissue Content/Volume</p></a></li>
<li><a href='#dat.annane'>
<p>A Meta-Analysis for Comparing the Effect of Steroids vs. Control in the Length of Intensive Care Unit (ICU) Stay</p></a></li>
<li><a href='#dat.baker'>
<p>A Network Meta-Analysis on Effects of Pharmacologic Treatments for Chronic Obstructive Pulmonary Disease</p></a></li>
<li><a href='#dat.barlow'>
<p>A Meta-Analysis on the Effect of Parent Training Programs vs. Control for Improving Parental Psychosocial Health Within 4 Weeks After Intervention</p></a></li>
<li><a href='#dat.beck17'>
<p>A Meta-Analysis of Prevalence of Depression or Depressive Symptoms Among Medical Students</p></a></li>
<li><a href='#dat.bellamy'>
<p>A Meta-Analysis on Type 2 Diabetes Mellitus After Gestational Diabetes</p></a></li>
<li><a href='#dat.bjelakovic'>
<p>A Meta-Analysis on the Beneficial and Harmful Effects of Vitamin D Supplementation for the Prevention of Mortality in Healthy Adults and Adults in a Stable Phase of Disease</p></a></li>
<li><a href='#dat.bohren'>
<p>A Meta-Analysis on the Effects of Continuous, One-To-One Intrapartum Support on Spontaneous Vaginal Births, Compared With Usual Care</p></a></li>
<li><a href='#dat.butters'>
<p>A Meta-Analysis on the Overall Response of the Addition of Drugs to a Chemotherapy Regimen for Metastatic Breast Cancer</p></a></li>
<li><a href='#dat.carless'>
<p>A Meta-Analysis on the Efficacy of Platelet-Rich-Plasmapheresis in Reducing Peri-Operative Allogeneic Red Blood Cell Transfusion in Cardiac Surgery</p></a></li>
<li><a href='#dat.chor'>
<p>A Meta-Analysis of Proportions on Chorioamnionitis</p></a></li>
<li><a href='#dat.ducharme'>
<p>A Meta-Analysis on the Effect of Long-Acting Inhaled Beta2-Agonists vs. Control for Chronic Asthma</p></a></li>
<li><a href='#dat.fib'>
<p>A Multivariate Meta-Analysis by the Fibrinogen Studies Collaboration</p></a></li>
<li><a href='#dat.ha'>
<p>A Meta-Analysis on the Effect of Placebo Interventions for All Clinical Conditions Regarding Patient-Reported Outcomes</p></a></li>
<li><a href='#dat.henry'>
<p>A Meta-Analysis for Evaluating the Effect of Tranexamic Acid on Perioperative Allogeneic Blood Transfusion</p></a></li>
<li><a href='#dat.hipfrac'>
<p>A Meta-Analysis on the Magnitude and Duration of Excess Mortality After Hip Fracture Among Older Men</p></a></li>
<li><a href='#dat.kaner'>
<p>A Meta-Analysis on the Effect of Brief Alcohol Interventions vs. Control in Primary Care Populations</p></a></li>
<li><a href='#dat.lcj'>
<p>A Meta-Analysis on the Effect of Progressive Resistance Strength Training Exercise vs. Control</p></a></li>
<li><a href='#dat.paige'>
<p>A Meta-Analysis on the Effectiveness of Spinal Manipulative Therapies (Other Than Sham)</p></a></li>
<li><a href='#dat.plourde'>
<p>A Meta-Analysis for Comparing the Fluoroscopy Time in Percutaneous Coronary Intervention Between Radial and Femoral Accesses</p></a></li>
<li><a href='#dat.poole'>
<p>A Meta-Analysis for Evaluating the Effect of Mucolytic on Bronchitis/Chronic Obstructive Pulmonary Disease</p></a></li>
<li><a href='#dat.pte'>
<p>Meta-Analysis of Multiple Risk Factors for Pterygium</p></a></li>
<li><a href='#dat.sc'>
<p>A Network Meta-Analysis on Smoking Cessation</p></a></li>
<li><a href='#dat.scheidler'>
<p>Meta-Analysis on the Utility of Lymphangiography, Computed Tomography, and Magnetic Resonance Imaging for the Diagnosis of Lymph Node Metastasis</p></a></li>
<li><a href='#dat.slf'>
<p>A Meta-Analysis on the Effect of Nicotine Gum for Smoking Cessation</p></a></li>
<li><a href='#dat.smith'>
<p>Meta-Analysis on the Diagnostic Accuracy of Ultrasound for Detecting Partial Thickness Rotator Cuff Tears</p></a></li>
<li><a href='#dat.whiting'>
<p>A Meta-Analysis on Adverse Events for the Comparison Cannabinoid vs. Placebo</p></a></li>
<li><a href='#dat.williams'>
<p>A Meta-Analysis on the Effect of Pharmacotherapy for Social Anxiety Disorder</p></a></li>
<li><a href='#dat.xu'>
<p>A Network Meta-Analysis on Immune Checkpoint Inhibitor Drugs</p></a></li>
<li><a href='#maprop.glmm'>
<p>Meta-Analysis of Proportions Using Generalized Linear Mixed Models</p></a></li>
<li><a href='#maprop.twostep'>
<p>Meta-Analysis of Proportions Using Two-Step Methods</p></a></li>
<li><a href='#meta.biv'>
<p>Bivariate Method for Meta-Analysis.</p></a></li>
<li><a href='#meta.dt'>
<p>Meta-Analysis of Diagnostic Tests</p></a></li>
<li><a href='#meta.pen'>
<p>A penalization approach to random-effects meta-analysis</p></a></li>
<li><a href='#metahet'>
<p>Meta-Analysis Heterogeneity Measures</p></a></li>
<li><a href='#metaoutliers'>
<p>Outlier Detection in Meta-Analysis</p></a></li>
<li><a href='#metapb'>
<p>Detecting and Quantifying Publication Bias/Small-Study Effects</p></a></li>
<li><a href='#mvma'>
<p>Multivariate Meta-Analysis</p></a></li>
<li><a href='#mvma.bayesian'>
<p>Bayesian Random-Effects Multivariate Meta-Analysis</p></a></li>
<li><a href='#mvma.hybrid'>
<p>Hybrid Model for Random-Effects Multivariate Meta-Analysis</p></a></li>
<li><a href='#mvma.hybrid.bayesian'>
<p>Bayesian Hybrid Model for Random-Effects Multivariate Meta-Analysis</p></a></li>
<li><a href='#nma.icdf'>
<p>Evidence Inconsistency Degrees of Freedom in Bayesian Network Meta-Analysis</p></a></li>
<li><a href='#nma.predrank'>
<p>Predictive P-Score for Treatment Ranking in Bayesian Network Meta-Analysis</p></a></li>
<li><a href='#pb.bayesian.binary'>
<p>Bayesian Method for Assessing Publication Bias/Small-Study Effects in Meta-Analysis of a Binary Outcome</p></a></li>
<li><a href='#pb.hybrid.binary'>
<p>Hybrid Test for Publication Bias/Small-Study Effects in Meta-Analysis With Binary Outcomes</p></a></li>
<li><a href='#pb.hybrid.generic'>
<p>Hybrid Test for Publication Bias/Small-Study Effects in Meta-Analysis With Generic Outcomes</p></a></li>
<li><a href='#plot.meta.dt'>
<p>Plot for Meta-Analysis of Diagnostic Tests</p></a></li>
<li><a href='#plot.metaoutliers'>
<p>Standardized Residual Plot for Outliers Diagnostics</p></a></li>
<li><a href='#print.meta.dt'>
<p>Print Method for &quot;meta.dt&quot; Objects</p></a></li>
<li><a href='#ssfunnel'>
<p>Contour-Enhanced Sample-Size-Based Funnel Plot</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Alternative Meta-Analysis Methods</td>
</tr>
<tr>
<td>Version:</td>
<td>4.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-08-27</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lifeng Lin &lt;lifenglin@arizona.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>rjags (&ge; 4-6), coda, graphics, grDevices, lme4, Matrix,
metafor (&ge; 3.0-2), methods, stats, utils</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>JAGS 4.x.y (http://mcmc-jags.sourceforge.net)</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides alternative statistical methods for meta-analysis, including:
 - bivariate generalized linear mixed models for synthesizing odds ratios, relative risks,
   and risk differences
   (Chu et al., 2012 &lt;<a href="https://doi.org/10.1177%2F0962280210393712">doi:10.1177/0962280210393712</a>&gt;)
 - heterogeneity tests and measures and penalization methods that are robust to outliers
   (Lin et al., 2017 &lt;<a href="https://doi.org/10.1111%2Fbiom.12543">doi:10.1111/biom.12543</a>&gt;;
    Wang et al., 2022 &lt;<a href="https://doi.org/10.1002%2Fsim.9261">doi:10.1002/sim.9261</a>&gt;);
 - measures, tests, and visualization tools for publication bias or small-study effects
   (Lin and Chu, 2018 &lt;<a href="https://doi.org/10.1111%2Fbiom.12817">doi:10.1111/biom.12817</a>&gt;;
    Lin, 2019 &lt;<a href="https://doi.org/10.1002%2Fjrsm.1340">doi:10.1002/jrsm.1340</a>&gt;;
    Lin, 2020 &lt;<a href="https://doi.org/10.1177%2F0962280220910172">doi:10.1177/0962280220910172</a>&gt;;
    Shi et al., 2020 &lt;<a href="https://doi.org/10.1002%2Fjrsm.1415">doi:10.1002/jrsm.1415</a>&gt;);
 - meta-analysis of diagnostic tests for synthesizing sensitivities, specificities, etc.
   (Reitsma et al., 2005 &lt;<a href="https://doi.org/10.1016%2Fj.jclinepi.2005.02.022">doi:10.1016/j.jclinepi.2005.02.022</a>&gt;;
    Chu and Cole, 2006 &lt;<a href="https://doi.org/10.1016%2Fj.jclinepi.2006.06.011">doi:10.1016/j.jclinepi.2006.06.011</a>&gt;);
 - meta-analysis methods for synthesizing proportions
   (Lin and Chu, 2020 &lt;<a href="https://doi.org/10.1097%2Fede.0000000000001232">doi:10.1097/ede.0000000000001232</a>&gt;);
 - models for multivariate meta-analysis, measures of inconsistency degrees of freedom
   in Bayesian network meta-analysis, and predictive P-score
   (Lin and Chu, 2018 &lt;<a href="https://doi.org/10.1002%2Fjrsm.1293">doi:10.1002/jrsm.1293</a>&gt;;
    Lin, 2020 &lt;<a href="https://doi.org/10.1080%2F10543406.2020.1852247">doi:10.1080/10543406.2020.1852247</a>&gt;;
    Rosenberger et al., 2021 &lt;<a href="https://doi.org/10.1186%2Fs12874-021-01397-5">doi:10.1186/s12874-021-01397-5</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-27 23:35:53 UTC; lifen</td>
</tr>
<tr>
<td>Author:</td>
<td>Lifeng Lin <a href="https://orcid.org/0000-0002-3562-9816"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Kristine J. Rosenberger [ctb],
  Linyu Shi [ctb],
  Yipeng Wang [ctb],
  Haitao Chu <a href="https://orcid.org/0000-0003-0932-598X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-29 07:30:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='dat.adams'>
A Meta-Analysis on the Effects of Fluvastatin 20 mg/day on High-Density Lipoprotein
</h2><span id='topic+dat.adams'></span>

<h3>Description</h3>

<p>This meta-analysis serves as an example to illustrate the usage of the function <code><a href="#topic+meta.pen">meta.pen</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.ha")</code></pre>


<h3>Format</h3>

<p>A data frame containing 32 studies.
</p>

<dl>
<dt><code>y</code></dt><dd><p>the observed effect size (mean difference) for each study in the meta-analysis.</p>
</dd>
<dt><code>s2</code></dt><dd><p>the within-study variance for each study.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Adams SP, Sekhon SS, Tsang M, Wright JM (2018). &quot;Fluvastatin for lowering lipids.&quot; <em>Cochrane Database of Systematic Reviews</em>, <b>7</b>. Art. No.: CD012282. &lt;doi: <a href="https://doi.org/10.1002/14651858.CD012282.pub2">10.1002/14651858.CD012282.pub2</a>&gt;
</p>

<hr>
<h2 id='dat.aex'>
A Meta-Analysis for Evaluating the Effect of Aerobic Exercise on Visceral Adipose Tissue Content/Volume
</h2><span id='topic+dat.aex'></span>

<h3>Description</h3>

<p>This meta-analysis serves as an example to illustrate function usage in the package <span class="pkg">altmeta</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.aex")</code></pre>


<h3>Format</h3>

<p>A data frame containing 29 studies with the observed effect sizes and their within-study variances.
</p>

<dl>
<dt><code>y</code></dt><dd><p>the observed effect size for each collected study in the meta-analysis.</p>
</dd>
<dt><code>s2</code></dt><dd><p>the within-study variance for each study.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Ismail I, Keating SE, Baker MK, Johnson NA (2012). &quot;A systematic review and meta-analysis of the effect of aerobic vs. resistance exercise training on visceral fat.&quot; <em>Obesity Reviews</em>, <b>13</b>(1), 68&ndash;91. &lt;doi: <a href="https://doi.org/10.1111/j.1467-789X.2011.00931.x">10.1111/j.1467-789X.2011.00931.x</a>&gt;
</p>

<hr>
<h2 id='dat.annane'>
A Meta-Analysis for Comparing the Effect of Steroids vs. Control in the Length of Intensive Care Unit (ICU) Stay
</h2><span id='topic+dat.annane'></span>

<h3>Description</h3>

<p>This dataset serves as an example of meta-analysis of mean differences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.annane")</code></pre>


<h3>Format</h3>

<p>A data frame with 12 studies with the following 5 variables within each study.
</p>

<dl>
<dt><code>y</code></dt><dd><p>point esimates of mean differences.</p>
</dd>
<dt><code>s2</code></dt><dd><p>sample variances of mean differences.</p>
</dd>
<dt><code>n1</code></dt><dd><p>sample sizes in treatment group 1 (steroids).</p>
</dd>
<dt><code>n2</code></dt><dd><p>sample sizes in treatment group 2 (control).</p>
</dd>
<dt><code>n</code></dt><dd><p>total sample sizes.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Annane D, Bellissant E, Bollaert PE, Briegel J, Keh D, Kupfer Y (2015). &quot;Corticosteroids for treating sepsis.&quot; <em>Cochrane Database of Systematic Reviews</em>, <b>12</b>, Art. No.: CD002243. &lt;doi: <a href="https://doi.org/10.1002/14651858.CD002243.pub3">10.1002/14651858.CD002243.pub3</a>&gt;
</p>

<hr>
<h2 id='dat.baker'>
A Network Meta-Analysis on Effects of Pharmacologic Treatments for Chronic Obstructive Pulmonary Disease
</h2><span id='topic+dat.baker'></span>

<h3>Description</h3>

<p>This dataset serves as an example of network meta-analysis with binary outcomes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.baker")</code></pre>


<h3>Format</h3>

<p>A dataset of network meta-analysis with binary outcomes, containing 38 studies and 5 treatments.
</p>

<dl>
<dt><code>sid</code></dt><dd><p>study IDs.</p>
</dd>
<dt><code>tid</code></dt><dd><p>treatment IDs.</p>
</dd>
<dt><code>r</code></dt><dd><p>event counts.</p>
</dd>
<dt><code>n</code></dt><dd><p>sample sizes.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Treatment IDs represent: 1) placebo; 2) inhaled corticosteroid; 3) inhaled corticosteroid + long-acting <code class="reqn">\beta_2</code>-agonist; 4) long-acting <code class="reqn">\beta_2</code>-agonist; and 5) tiotropium.
</p>


<h3>Source</h3>

<p>Baker WL, Baker EL, Coleman CI (2009). &quot;Pharmacologic treatments for chronic obstructive pulmonary disease: a mixed-treatment comparison meta-analysis.&quot; <em>Pharmacotherapy</em>, <b>29</b>(8), 891&ndash;905. &lt;doi: <a href="https://doi.org/10.1592/phco.29.8.891">10.1592/phco.29.8.891</a>&gt;
</p>

<hr>
<h2 id='dat.barlow'>
A Meta-Analysis on the Effect of Parent Training Programs vs. Control for Improving Parental Psychosocial Health Within 4 Weeks After Intervention
</h2><span id='topic+dat.barlow'></span>

<h3>Description</h3>

<p>This dataset serves as an example of meta-analysis of standardized mean differences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.barlow")</code></pre>


<h3>Format</h3>

<p>A data frame with 26 studies with the following 5 variables within each study.
</p>

<dl>
<dt><code>y</code></dt><dd><p>point esimates of standardized mean differences.</p>
</dd>
<dt><code>s2</code></dt><dd><p>sample variances of standardized mean differences.</p>
</dd>
<dt><code>n1</code></dt><dd><p>sample sizes in treatment group 1 (parent training programs).</p>
</dd>
<dt><code>n2</code></dt><dd><p>sample sizes in treatment group 2 (control).</p>
</dd>
<dt><code>n</code></dt><dd><p>total sample sizes.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Barlow J, Smailagic N, Huband N, Roloff V, Bennett C (2014). &quot;Group-based parent training programmes for improving parental psychosocial health.&quot; <em>Cochrane Database of Systematic Reviews</em>, <b>5</b>, Art. No.: CD002020. &lt;doi: <a href="https://doi.org/10.1002/14651858.CD002020.pub4">10.1002/14651858.CD002020.pub4</a>&gt;
</p>

<hr>
<h2 id='dat.beck17'>
A Meta-Analysis of Prevalence of Depression or Depressive Symptoms Among Medical Students
</h2><span id='topic+dat.beck17'></span>

<h3>Description</h3>

<p>This dataset serves as an example of meta-analysis of proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.beck17")</code></pre>


<h3>Format</h3>

<p>A data frame with 6 studies with the following 2 variables within each study.
</p>

<dl>
<dt><code>e</code></dt><dd><p>event counts of samples with depression or depressive symptoms.</p>
</dd>
<dt><code>n</code></dt><dd><p>sample sizes.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The original article by Rotenstein et al. (2016) stratified all extracted studies based on various screening instruments and cutoff scores. This dataset focuses on the meta-analysis of 6 studies with Beck Depression Inventory Score <code class="reqn">\geq</code>17.
</p>


<h3>Source</h3>

<p>Rotenstein LS, Ramos MA, Torre M, Segal JB, Peluso MJ, Guille C, Sen S, Mata DA (2016). &quot;Prevalence of depression, depressive symptoms, and suicidal ideation among medical students: a systematic review and meta-analysis.&quot; <em>JAMA</em>, <b>316</b>(21), 2214&ndash;2236. &lt;doi: <a href="https://doi.org/10.1001/jama.2016.17324">10.1001/jama.2016.17324</a>&gt;
</p>

<hr>
<h2 id='dat.bellamy'>
A Meta-Analysis on Type 2 Diabetes Mellitus After Gestational Diabetes
</h2><span id='topic+dat.bellamy'></span>

<h3>Description</h3>

<p>This meta-analysis serves as an example of meta-analysis with binary outcomes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.bellamy")</code></pre>


<h3>Format</h3>

<p>A data frame containing 20 cohort studies with the following 4 variables.
</p>

<dl>
<dt><code>sid</code></dt><dd><p>study IDs.</p>
</dd>
<dt><code>tid</code></dt><dd><p>treatment/exposure IDs (0: non-exposure; 1: exposure).</p>
</dd>
<dt><code>e</code></dt><dd><p>event counts.</p>
</dd>
<dt><code>n</code></dt><dd><p>sample sizes.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Bellamy L, Casas JP, Hingorani AD, Williams D (2009). &quot;Type 2 diabetes mellitus after gestational diabetes: a systematic review and meta-analysis.&quot; <em>Lancet</em>, <b>373</b>(9677), 1773&ndash;1779. &lt;doi: <a href="https://doi.org/10.1016/S0140-6736(09)60731-5">10.1016/S0140-6736(09)60731-5</a>&gt;
</p>

<hr>
<h2 id='dat.bjelakovic'>
A Meta-Analysis on the Beneficial and Harmful Effects of Vitamin D Supplementation for the Prevention of Mortality in Healthy Adults and Adults in a Stable Phase of Disease
</h2><span id='topic+dat.bjelakovic'></span>

<h3>Description</h3>

<p>This meta-analysis serves as an example to illustrate the usage of the function <code><a href="#topic+meta.pen">meta.pen</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.ha")</code></pre>


<h3>Format</h3>

<p>A data frame containing 53 studies.
</p>

<dl>
<dt><code>n1</code></dt><dd><p>the sample size in the treatment group in each study.</p>
</dd>
<dt><code>n2</code></dt><dd><p>the sample size in the control group in each study.</p>
</dd>
<dt><code>r1</code></dt><dd><p>the event count in the treatment group in each study.</p>
</dd>
<dt><code>r2</code></dt><dd><p>the event count in the control group in each study.</p>
</dd>
<dt><code>y</code></dt><dd><p>the observed effect size (log odds ratio) for each study in the meta-analysis.</p>
</dd>
<dt><code>s2</code></dt><dd><p>the within-study variance for each study.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Bjelakovic G, Gluud LL, Nikolova D, Whitfield K, Wetterslev J, Simonetti RG, Bjelakovic M, Gluud C (2014). &quot;Vitamin D supplementation for prevention of mortality in adults.&quot; <em>Cochrane Database of Systematic Reviews</em>, <b>7</b>. Art. No.: CD007470. &lt;doi: <a href="https://doi.org/10.1002/14651858.CD007470.pub3">10.1002/14651858.CD007470.pub3</a>&gt;
</p>

<hr>
<h2 id='dat.bohren'>
A Meta-Analysis on the Effects of Continuous, One-To-One Intrapartum Support on Spontaneous Vaginal Births, Compared With Usual Care
</h2><span id='topic+dat.bohren'></span>

<h3>Description</h3>

<p>This meta-analysis serves as an example to illustrate the usage of the function <code><a href="#topic+meta.pen">meta.pen</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.ha")</code></pre>


<h3>Format</h3>

<p>A data frame containing 21 studies.
</p>

<dl>
<dt><code>n1</code></dt><dd><p>the sample size in the treatment group in each study.</p>
</dd>
<dt><code>n2</code></dt><dd><p>the sample size in the control group in each study.</p>
</dd>
<dt><code>r1</code></dt><dd><p>the event count in the treatment group in each study.</p>
</dd>
<dt><code>r2</code></dt><dd><p>the event count in the control group in each study.</p>
</dd>
<dt><code>y</code></dt><dd><p>the observed effect size (log odds ratio) for each study in the meta-analysis.</p>
</dd>
<dt><code>s2</code></dt><dd><p>the within-study variance for each study.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Bohren MA, Hofmeyr GJ, Sakala C, Fukuzawa RK, Cuthbert A (2017). &quot;Continuous support for women during childbirth.&quot; <em>Cochrane Database of Systematic Reviews</em>, <b>7</b>. Art. No.: CD003766. &lt;doi: <a href="https://doi.org/10.1002/14651858.CD003766.pub6">10.1002/14651858.CD003766.pub6</a>&gt;
</p>

<hr>
<h2 id='dat.butters'>
A Meta-Analysis on the Overall Response of the Addition of Drugs to a Chemotherapy Regimen for Metastatic Breast Cancer
</h2><span id='topic+dat.butters'></span>

<h3>Description</h3>

<p>This dataset serves as an example of meta-analysis of (log) odds ratios.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.butters")</code></pre>


<h3>Format</h3>

<p>A data frame with 16 studies with the following 7 variables within each study.
</p>

<dl>
<dt><code>y</code></dt><dd><p>point esimates of log odds ratios.</p>
</dd>
<dt><code>s2</code></dt><dd><p>sample variances of log odds ratios.</p>
</dd>
<dt><code>n1</code></dt><dd><p>sample sizes in treatment group 1 (addition of drug).</p>
</dd>
<dt><code>n2</code></dt><dd><p>sample sizes in treatment group 2 (control).</p>
</dd>
<dt><code>r1</code></dt><dd><p>event counts in treatment group 1.</p>
</dd>
<dt><code>r2</code></dt><dd><p>event counts in treatment group 2.</p>
</dd>
<dt><code>n</code></dt><dd><p>total sample sizes.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Butters DJ, Ghersi D, Wilcken N, Kirk SJ, Mallon PT (2010). &quot;Addition of drug/s to a chemotherapy regimen for metastatic breast cancer.&quot; <em>Cochrane Database of Systematic Reviews</em>, <b>11</b>, Art. No.: CD003368. &lt;doi: <a href="https://doi.org/10.1002/14651858.CD003368.pub3">10.1002/14651858.CD003368.pub3</a>&gt;
</p>

<hr>
<h2 id='dat.carless'>
A Meta-Analysis on the Efficacy of Platelet-Rich-Plasmapheresis in Reducing Peri-Operative Allogeneic Red Blood Cell Transfusion in Cardiac Surgery
</h2><span id='topic+dat.carless'></span>

<h3>Description</h3>

<p>This meta-analysis serves as an example to illustrate the usage of the function <code><a href="#topic+meta.pen">meta.pen</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.ha")</code></pre>


<h3>Format</h3>

<p>A data frame containing 20 studies.
</p>

<dl>
<dt><code>n1</code></dt><dd><p>the sample size in the treatment group in each study.</p>
</dd>
<dt><code>n2</code></dt><dd><p>the sample size in the control group in each study.</p>
</dd>
<dt><code>r1</code></dt><dd><p>the event count in the treatment group in each study.</p>
</dd>
<dt><code>r2</code></dt><dd><p>the event count in the control group in each study.</p>
</dd>
<dt><code>y</code></dt><dd><p>the observed effect size (log odds ratio) for each study in the meta-analysis.</p>
</dd>
<dt><code>s2</code></dt><dd><p>the within-study variance for each study.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Carless PA, Rubens FD, Anthony DM, O'Connell D, Henry DA (2011). &quot;Platelet-rich-plasmapheresis for minimising peri-operative allogeneic blood transfusion.&quot; <em>Cochrane Database of Systematic Reviews</em>, <b>3</b>. Art. No.: CD004172. &lt;doi: <a href="https://doi.org/10.1002/14651858.CD004172.pub2">10.1002/14651858.CD004172.pub2</a>&gt;
</p>

<hr>
<h2 id='dat.chor'>
A Meta-Analysis of Proportions on Chorioamnionitis
</h2><span id='topic+dat.chor'></span>

<h3>Description</h3>

<p>This dataset serves as an example of meta-analysis of proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.chor")</code></pre>


<h3>Format</h3>

<p>A data frame with 21 studies with the following 2 variables within each study.
</p>

<dl>
<dt><code>e</code></dt><dd><p>event counts of horioamnionitis.</p>
</dd>
<dt><code>n</code></dt><dd><p>sample sizes.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Woodd SL, Montoya A, Barreix M, Pi L, Calvert C, Rehman AM, Chou D, Campbell OMR (2019). &quot;Incidence of maternal peripartum infection: a systematic review and meta-analysis.&quot; <em>PLOS Medicine</em>, <b>16</b>(12), e1002984. &lt;doi: <a href="https://doi.org/10.1371/journal.pmed.1002984">10.1371/journal.pmed.1002984</a>&gt;
</p>

<hr>
<h2 id='dat.ducharme'>
A Meta-Analysis on the Effect of Long-Acting Inhaled Beta2-Agonists vs. Control for Chronic Asthma
</h2><span id='topic+dat.ducharme'></span>

<h3>Description</h3>

<p>This meta-analysis serves as an example of meta-analysis with binary outcomes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.ducharme")</code></pre>


<h3>Format</h3>

<p>A data frame containing 33 studies with the following 4 variables within each study.
</p>

<dl>
<dt><code>n00</code></dt><dd><p>counts of non-events in treatment group 0 (placebo).</p>
</dd>
<dt><code>n01</code></dt><dd><p>counts of events in treatment group 0 (placebo).</p>
</dd>
<dt><code>n10</code></dt><dd><p>counts of non-events in treatment group 1 (beta2-agonists).</p>
</dd>
<dt><code>n11</code></dt><dd><p>counts of events in treatment group 1 (beta2-agonists).</p>
</dd>
</dl>



<h3>Note</h3>

<p>The original review collected 35 studies; two double-zero-counts studies are excluded from this dataset because their odds ratios are not estimable.</p>


<h3>Source</h3>

<p>Ducharme FM, Ni Chroinin M, Greenstone I, Lasserson TJ (2010). &quot;Addition of long-acting beta2-agonists to inhaled corticosteroids versus same dose inhaled corticosteroids for chronic asthma in adults and children.&quot; <em>Cochrane Database of Systematic Reviews</em>, <b>5</b>, Art. No.: CD005535. &lt;doi: <a href="https://doi.org/10.1002/14651858.CD005535.pub2">10.1002/14651858.CD005535.pub2</a>&gt;
</p>

<hr>
<h2 id='dat.fib'>
A Multivariate Meta-Analysis by the Fibrinogen Studies Collaboration
</h2><span id='topic+dat.fib'></span>

<h3>Description</h3>

<p>This multivariate meta-analysis serves as an example to illustrate function usage in the package <span class="pkg">altmeta</span>. It consists of 31 studies with 4 outcomes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.fib")</code></pre>


<h3>Format</h3>

<p>A list containing three elements, <code>y</code>, <code>S</code>, and <code>sd</code>.
</p>

<dl>
<dt><code>y</code></dt><dd><p>a 31 x 4 numeric matrix containing the observed effect sizes; the rows represent studies and the columns represent outcomes.</p>
</dd>
<dt><code>S</code></dt><dd><p>a list containing 31 elements; each element is within-study covariance matrix of the corresponding study.</p>
</dd>
<dt><code>sd</code></dt><dd><p>a 31 x 4 numeric matrix containing the within-study standard deviations; the rows represent studies and the columns represent outcomes.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Fibrinogen Studies Collaboration (2004). &quot;Collaborative meta-analysis of prospective studies of plasma fibrinogen and cardiovascular disease.&quot; <em>European Journal of Cardiovascular Prevention and Rehabilitation</em>, <b>11</b>(1), 9&ndash;17. &lt;doi: <a href="https://doi.org/10.1097/01.hjr.0000114968.39211.01">10.1097/01.hjr.0000114968.39211.01</a>&gt;
</p>
<p>Fibrinogen Studies Collaboration (2005). &quot;Plasma fibrinogen level and the risk of major cardiovascular diseases and nonvascular mortality: an individual participant meta-analysis.&quot; <em>JAMA</em>, <b>294</b>(14), 1799&ndash;1809. &lt;doi: <a href="https://doi.org/10.1001/jama.294.14.1799">10.1001/jama.294.14.1799</a>&gt;
</p>

<hr>
<h2 id='dat.ha'>
A Meta-Analysis on the Effect of Placebo Interventions for All Clinical Conditions Regarding Patient-Reported Outcomes
</h2><span id='topic+dat.ha'></span>

<h3>Description</h3>

<p>This meta-analysis serves as an example to illustrate function usage in the package <span class="pkg">altmeta</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.ha")</code></pre>


<h3>Format</h3>

<p>A data frame containing 109 studies with the observed effect sizes and their within-study variances.
</p>

<dl>
<dt><code>y</code></dt><dd><p>the observed effect size for each collected study in the meta-analysis.</p>
</dd>
<dt><code>s2</code></dt><dd><p>the within-study variance for each study.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Hrobjartsson A, Gotzsche PC (2010). &quot;Placebo interventions for all clinical conditions.&quot; <em>Cochrane Database of Systematic Reviews</em>, <b>1</b>. Art. No.: CD003974. &lt;doi: <a href="https://doi.org/10.1002/14651858.CD003974.pub3">10.1002/14651858.CD003974.pub3</a>&gt;
</p>

<hr>
<h2 id='dat.henry'>
A Meta-Analysis for Evaluating the Effect of Tranexamic Acid on Perioperative Allogeneic Blood Transfusion
</h2><span id='topic+dat.henry'></span>

<h3>Description</h3>

<p>This meta-analysis serves as an example of meta-analysis with binary outcomes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.henry")</code></pre>


<h3>Format</h3>

<p>A data frame containing 26 studies with the following 4 variables within each study.
</p>

<dl>
<dt><code>n00</code></dt><dd><p>counts of non-events in treatment group 0 (placebo).</p>
</dd>
<dt><code>n01</code></dt><dd><p>counts of events in treatment group 0 (placebo).</p>
</dd>
<dt><code>n10</code></dt><dd><p>counts of non-events in treatment group 1 (tranexamic acid).</p>
</dd>
<dt><code>n11</code></dt><dd><p>counts of events in treatment group 1 (tranexamic acid).</p>
</dd>
</dl>



<h3>Note</h3>

<p>The original review collected 27 studies; one double-zero-counts study is excluded from this dataset because its odds ratio is not estimable.</p>


<h3>Source</h3>

<p>Henry DA, Carless PA, Moxey AJ, O'Connell, Stokes BJ, Fergusson DA, Ker K (2011). &quot;Anti-fibrinolytic use for minimising perioperative allogeneic blood transfusion.&quot; <em>Cochrane Database of Systematic Reviews</em>, <b>1</b>, Art. No.: CD001886. &lt;doi: <a href="https://doi.org/10.1002/14651858.CD001886.pub3">10.1002/14651858.CD001886.pub3</a>&gt;
</p>

<hr>
<h2 id='dat.hipfrac'>
A Meta-Analysis on the Magnitude and Duration of Excess Mortality After Hip Fracture Among Older Men
</h2><span id='topic+dat.hipfrac'></span>

<h3>Description</h3>

<p>This meta-analysis serves as an example to illustrate function usage in the package <span class="pkg">altmeta</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.hipfrac")</code></pre>


<h3>Format</h3>

<p>A data frame containing 17 studies with the observed effect sizes and their within-study variances.
</p>

<dl>
<dt><code>y</code></dt><dd><p>the observed effect size for each collected study in the meta-analysis.</p>
</dd>
<dt><code>s2</code></dt><dd><p>the within-study variance for each study.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Haentjens P, Magaziner J, Colon-Emeric CS, Vanderschueren D, Milisen K, Velkeniers B, Boonen S (2010). &quot;Meta-analysis: excess mortality after hip fracture among older women and men&quot;. <em>Annals of Internal Medicine</em>, <b>152</b>(6), 380&ndash;390. &lt;doi: <a href="https://doi.org/10.7326/0003-4819-152-6-201003160-00008">10.7326/0003-4819-152-6-201003160-00008</a>&gt;
</p>

<hr>
<h2 id='dat.kaner'>
A Meta-Analysis on the Effect of Brief Alcohol Interventions vs. Control in Primary Care Populations
</h2><span id='topic+dat.kaner'></span>

<h3>Description</h3>

<p>This dataset serves as an example of meta-analysis of risk differences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.kaner")</code></pre>


<h3>Format</h3>

<p>A data frame with 13 studies with the following 7 variables within each study.
</p>

<dl>
<dt><code>y</code></dt><dd><p>point esimates of risk differences.</p>
</dd>
<dt><code>s2</code></dt><dd><p>sample variances of risk differences.</p>
</dd>
<dt><code>n1</code></dt><dd><p>sample sizes in treatment group 1 (brief alcohol interventions).</p>
</dd>
<dt><code>n2</code></dt><dd><p>sample sizes in treatment group 2 (control).</p>
</dd>
<dt><code>r1</code></dt><dd><p>event counts in treatment group 1.</p>
</dd>
<dt><code>r2</code></dt><dd><p>event counts in treatment group 2.</p>
</dd>
<dt><code>n</code></dt><dd><p>total sample sizes.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Kaner EF, Dickinson HO, Beyer FR, Campbell F, Schlesinger C, Heather N, Saunders JB, Burnand B, Pienaar ED (2007). &quot;Effectiveness of brief alcohol interventions in primary care populations.&quot; <em>Cochrane Database of Systematic Reviews</em>, <b>2</b>, Art. No.: CD004148. &lt;doi: <a href="https://doi.org/10.1002/14651858.CD004148.pub3">10.1002/14651858.CD004148.pub3</a>&gt;
</p>

<hr>
<h2 id='dat.lcj'>
A Meta-Analysis on the Effect of Progressive Resistance Strength Training Exercise vs. Control
</h2><span id='topic+dat.lcj'></span>

<h3>Description</h3>

<p>This meta-analysis serves as an example to illustrate function usage in the package <span class="pkg">altmeta</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.lcj")</code></pre>


<h3>Format</h3>

<p>A data frame containing 33 studies with the observed effect sizes and their within-study variances.
</p>

<dl>
<dt><code>y</code></dt><dd><p>the observed effect size for each collected study in the meta-analysis.</p>
</dd>
<dt><code>s2</code></dt><dd><p>the within-study variance for each study.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Liu CJ, Latham NK (2009). &quot;Progressive resistance strength training for improving physical function in older adults.&quot; <em>Cochrane Database of Systematic Reviews</em>, <b>3</b>. Art. No.: CD002759. &lt;doi: <a href="https://doi.org/10.1002/14651858.CD002759.pub2">10.1002/14651858.CD002759.pub2</a>&gt;
</p>

<hr>
<h2 id='dat.paige'>
A Meta-Analysis on the Effectiveness of Spinal Manipulative Therapies (Other Than Sham)
</h2><span id='topic+dat.paige'></span>

<h3>Description</h3>

<p>This dataset serves as an example of meta-analysis of standardized mean differences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.paige")</code></pre>


<h3>Format</h3>

<p>A data frame with 6 studies with the following 5 variables within each study.
</p>

<dl>
<dt><code>y</code></dt><dd><p>point esimates of standardized mean differences.</p>
</dd>
<dt><code>s2</code></dt><dd><p>sample variances of standardized mean differences.</p>
</dd>
<dt><code>n1</code></dt><dd><p>sample sizes in treatment group 1 (spinal manipulation).</p>
</dd>
<dt><code>n2</code></dt><dd><p>sample sizes in treatment group 2 (comparator).</p>
</dd>
<dt><code>n</code></dt><dd><p>total sample sizes.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Paige NM, Miake-Lye IM, Booth MS, Beroes JM, Mardian AS, Dougherty P, Branson R, Tang B, Morton SC, Shekelle PG (2017). &quot;Association of spinal manipulative therapy with clinical benefit and harm for acute low back pain: systematic review and meta-analysis.&quot; <em>JAMA</em>, <b>317</b>(14), 1451&ndash;1460. &lt;doi: <a href="https://doi.org/10.1001/jama.2017.3086">10.1001/jama.2017.3086</a>&gt;
</p>

<hr>
<h2 id='dat.plourde'>
A Meta-Analysis for Comparing the Fluoroscopy Time in Percutaneous Coronary Intervention Between Radial and Femoral Accesses
</h2><span id='topic+dat.plourde'></span>

<h3>Description</h3>

<p>This dataset serves as an example of meta-analysis of mean differences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.plourde")</code></pre>


<h3>Format</h3>

<p>A data frame with 19 studies with the following 5 variables within each study.
</p>

<dl>
<dt><code>y</code></dt><dd><p>point esimates of mean differences.</p>
</dd>
<dt><code>s2</code></dt><dd><p>sample variances of mean differences.</p>
</dd>
<dt><code>n1</code></dt><dd><p>sample sizes in treatment group 1 (radial).</p>
</dd>
<dt><code>n2</code></dt><dd><p>sample sizes in treatment group 2 (femoral).</p>
</dd>
<dt><code>n</code></dt><dd><p>total sample sizes.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Plourde G, Pancholy SB, Nolan J, Jolly S, Rao SV, Amhed I, Bangalore S, Patel T, Dahm JB, Bertrand OF (2015). &quot;Radiation exposure in relation to the arterial access site used for diagnostic coronary angiography and percutaneous coronary intervention: a systematic review and meta-analysis.&quot; <em>Lancet</em>, <b>386</b>(10009), 2192&ndash;2203. &lt;doi: <a href="https://doi.org/10.1016/S0140-6736(15)00305-0">10.1016/S0140-6736(15)00305-0</a>&gt;
</p>

<hr>
<h2 id='dat.poole'>
A Meta-Analysis for Evaluating the Effect of Mucolytic on Bronchitis/Chronic Obstructive Pulmonary Disease
</h2><span id='topic+dat.poole'></span>

<h3>Description</h3>

<p>This meta-analysis serves as an example of meta-analysis with binary outcomes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.poole")</code></pre>


<h3>Format</h3>

<p>A data frame containing 24 studies with the following 4 variables within each study.
</p>

<dl>
<dt><code>n00</code></dt><dd><p>counts of non-events in treatment group 0 (placebo).</p>
</dd>
<dt><code>n01</code></dt><dd><p>counts of events in treatment group 0 (placebo).</p>
</dd>
<dt><code>n10</code></dt><dd><p>counts of non-events in treatment group 1 (mucolytic).</p>
</dd>
<dt><code>n11</code></dt><dd><p>counts of events in treatment group 1 (mucolytic).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Poole P, Chong J, Cates CJ (2015). &quot;Mucolytic agents versus placebo for chronic bronchitis or chronic obstructive pulmonary disease.&quot; <em>Cochrane Database of Systematic Reviews</em>, <b>7</b>, Art. No.: CD001287. &lt;doi: <a href="https://doi.org/10.1002/14651858.CD001287.pub5">10.1002/14651858.CD001287.pub5</a>&gt;
</p>

<hr>
<h2 id='dat.pte'>
Meta-Analysis of Multiple Risk Factors for Pterygium
</h2><span id='topic+dat.pte'></span>

<h3>Description</h3>

<p>This dataset serves as an example to illustrate network meta-analysis of multiple factors. It consists of 29 studies on a total of 8 risk factors: area of residence (rural vs. urban); education attainment (low vs. high); latitude of residence (low vs. high); occupation type (outdoor vs. indoor); smoking status (yes vs. no); use of hat (yes vs. no); use of spectacles (yes vs. no); and use of sunglasses (yes vs. no). Each study only investigates a subset of the 8 risk factors, so the dataset contains many missing values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.pte")</code></pre>


<h3>Format</h3>

<p>A list containing two elements, <code>y</code> and <code>se</code>.
</p>

<dl>
<dt><code>y</code></dt><dd><p>a 29 x 8 numeric matrix containing the observed effect sizes; the rows represent studies and the columns represent outcomes.</p>
</dd>
<dt><code>se</code></dt><dd><p>a 29 x 8 numeric matrix containing the within-study standard errors; the rows represent studies and the columns represent outcomes.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Serghiou S, Patel CJ, Tan YY, Koay P, Ioannidis JPA (2016). &quot;Field-wide meta-analyses of observational associations can map selective availability of risk factors and the impact of model specifications.&quot; <em>Journal of Clinical Epidemiology</em>, <b>71</b>, 58&ndash;67. &lt;doi: <a href="https://doi.org/10.1016/j.jclinepi.2015.09.004">10.1016/j.jclinepi.2015.09.004</a>&gt;
</p>

<hr>
<h2 id='dat.sc'>
A Network Meta-Analysis on Smoking Cessation
</h2><span id='topic+dat.sc'></span>

<h3>Description</h3>

<p>The dataset is extracted from Lu and Ades (2006); it was initially reported by Hasselblad (1998) (without performing a formal network meta-analysis).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.sc")</code></pre>


<h3>Format</h3>

<p>A dataset of network meta-analysis with binary outcomes, containing 24 studies and 4 treatments.
</p>

<dl>
<dt><code>sid</code></dt><dd><p>study IDs.</p>
</dd>
<dt><code>tid</code></dt><dd><p>treatment IDs.</p>
</dd>
<dt><code>r</code></dt><dd><p>event counts.</p>
</dd>
<dt><code>n</code></dt><dd><p>sample sizes.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Treatment IDs represent: 1)no contact; 2) selfhelp; 3) individual counseling; and 4) group counseling.
</p>


<h3>Source</h3>

<p>Hasselblad V (1998). &quot;Meta-analysis of multitreatment studies.&quot; <em>Medical Decision Making</em>, <b>18</b>(1), 37&ndash;43. &lt;doi: <a href="https://doi.org/10.1177/0272989X9801800110">10.1177/0272989X9801800110</a>&gt;
</p>
<p>Lu G, Ades AE (2006). &quot;Assessing evidence inconsistency in mixed treatment comparisons.&quot; <em>Journal of the American Statistical Association</em>, <b>101</b>(474), 447&ndash;459. &lt;doi: <a href="https://doi.org/10.1198/016214505000001302">10.1198/016214505000001302</a>&gt;
</p>

<hr>
<h2 id='dat.scheidler'>
Meta-Analysis on the Utility of Lymphangiography, Computed Tomography, and Magnetic Resonance Imaging for the Diagnosis of Lymph Node Metastasis
</h2><span id='topic+dat.scheidler'></span>

<h3>Description</h3>

<p>This meta-analysis serves as an example of meta-analyses of diagnostic tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.scheidler")</code></pre>


<h3>Format</h3>

<p>A data frame with 44 studies with the following 5 variables; each row represents a study.
</p>

<dl>
<dt><code>dt</code></dt><dd><p>types of diagnostic tests; CT: computed tomography; LAG: lymphangiography; and MRI: magnetic resonance imaging.</p>
</dd>
<dt><code>tp</code></dt><dd><p>counts of true positives.</p>
</dd>
<dt><code>fp</code></dt><dd><p>counts of false positives.</p>
</dd>
<dt><code>fn</code></dt><dd><p>counts of false negatives.</p>
</dd>
<dt><code>tn</code></dt><dd><p>counts of true negatives.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Scheidler J, Hricak H, Yu KK, Subak L, Segal MR (1997). &quot;Radiological evaluation of lymph node metastases in patients with cervical cancer: a meta-analysis.&quot; <em>JAMA</em>, <b>278</b>(13), 1096&ndash;1101. &lt;doi: <a href="https://doi.org/10.1001/jama.1997.03550130070040">10.1001/jama.1997.03550130070040</a>&gt;
</p>

<hr>
<h2 id='dat.slf'>
A Meta-Analysis on the Effect of Nicotine Gum for Smoking Cessation
</h2><span id='topic+dat.slf'></span>

<h3>Description</h3>

<p>This meta-analysis serves as an example to illustrate function usage in the package <span class="pkg">altmeta</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.slf")</code></pre>


<h3>Format</h3>

<p>A data frame containing 56 studies with the observed effect sizes and their within-study variances.
</p>

<dl>
<dt><code>y</code></dt><dd><p>the observed effect size for each collected study in the meta-analysis.</p>
</dd>
<dt><code>s2</code></dt><dd><p>the within-study variance for each study.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Stead LF, Perera R, Bullen C, Mant D, Hartmann-Boyce J, Cahill K, Lancaster T (2012). &quot;Nicotine replacement therapy for smoking cessation.&quot; <em>Cochrane Database of Systematic Reviews</em>, <b>11</b>. Art. No.: CD000146. &lt;doi: <a href="https://doi.org/10.1002/14651858.CD000146.pub4">10.1002/14651858.CD000146.pub4</a>&gt;
</p>

<hr>
<h2 id='dat.smith'>
Meta-Analysis on the Diagnostic Accuracy of Ultrasound for Detecting Partial Thickness Rotator Cuff Tears
</h2><span id='topic+dat.smith'></span>

<h3>Description</h3>

<p>This meta-analysis serves as an example of meta-analyses of diagnostic tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.smith")</code></pre>


<h3>Format</h3>

<p>A data frame with 30 studies with the following 4 variables; each row represents a study.
</p>

<dl>
<dt><code>tp</code></dt><dd><p>counts of true positives.</p>
</dd>
<dt><code>fp</code></dt><dd><p>counts of false positives.</p>
</dd>
<dt><code>fn</code></dt><dd><p>counts of false negatives.</p>
</dd>
<dt><code>tn</code></dt><dd><p>counts of true negatives.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Smith TO, Back T, Toms AP, Hing CB (2011). &quot;Diagnostic accuracy of ultrasound for rotator cuff tears in adults: a systematic review and meta-analysis.&quot; <em>Clinical Radiology</em>, <b>66</b>(11), 1036&ndash;1048. &lt;doi: <a href="https://doi.org/10.1016/j.crad.2011.05.007">10.1016/j.crad.2011.05.007</a>&gt;
</p>

<hr>
<h2 id='dat.whiting'>
A Meta-Analysis on Adverse Events for the Comparison Cannabinoid vs. Placebo
</h2><span id='topic+dat.whiting'></span>

<h3>Description</h3>

<p>This dataset serves as an example of meta-analysis of (log) odds ratios.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.whiting")</code></pre>


<h3>Format</h3>

<p>A data frame with 29 studies with the following 9 variables within each study.
</p>

<dl>
<dt><code>y</code></dt><dd><p>point esimates of log odds ratios.</p>
</dd>
<dt><code>s2</code></dt><dd><p>sample variances of log odds ratios.</p>
</dd>
<dt><code>n00</code></dt><dd><p>counts of non-events in treatment group 0 (placebo).</p>
</dd>
<dt><code>n01</code></dt><dd><p>counts of events in treatment group 0.</p>
</dd>
<dt><code>n10</code></dt><dd><p>counts of non-events in treatment group 1 (cannabinoid).</p>
</dd>
<dt><code>n11</code></dt><dd><p>counts of events in treatment group 1 (cannabinoid).</p>
</dd>
<dt><code>n0</code></dt><dd><p>sample sizes in treatment group 0.</p>
</dd>
<dt><code>n1</code></dt><dd><p>sample sizes in treatment group 1.</p>
</dd>
<dt><code>n</code></dt><dd><p>total sample sizes.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Whiting PF, Wolff RF, Deshpande S, Di Nisio M, Duffy S, Hernandez AV, Keurentjes JC, Lang S, Misso K, Ryder S, Schmidlkofer S, Westwood M, Kleijnen J (2015). &quot;Cannabinoids for medical use: a systematic review and meta-analysis.&quot; <em>JAMA</em>, <b>313</b>(24), 2456&ndash;2473. &lt;doi: <a href="https://doi.org/10.1001/jama.2015.6358">10.1001/jama.2015.6358</a>&gt;
</p>

<hr>
<h2 id='dat.williams'>
A Meta-Analysis on the Effect of Pharmacotherapy for Social Anxiety Disorder
</h2><span id='topic+dat.williams'></span>

<h3>Description</h3>

<p>This dataset serves as an example of meta-analysis of (log) relative risks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.williams")</code></pre>


<h3>Format</h3>

<p>A data frame with 20 studies with the following 7 variables within each study.
</p>

<dl>
<dt><code>y</code></dt><dd><p>point esimates of log relative risks.</p>
</dd>
<dt><code>s2</code></dt><dd><p>sample variances of log relative risks.</p>
</dd>
<dt><code>n1</code></dt><dd><p>sample sizes in treatment group 1 (medication).</p>
</dd>
<dt><code>n2</code></dt><dd><p>sample sizes in treatment group 2 (placebo).</p>
</dd>
<dt><code>r1</code></dt><dd><p>event counts in treatment group 1.</p>
</dd>
<dt><code>r2</code></dt><dd><p>event counts in treatment group 2.</p>
</dd>
<dt><code>n</code></dt><dd><p>total sample sizes.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Williams T, Hattingh CJ, Kariuki CM, Tromp SA, van Balkom AJ, Ipser JC, Stein DJ (2017). &quot;Pharmacotherapy for social anxiety disorder (SAnD).&quot; <em>Cochrane Database of Systematic Reviews</em>, <b>10</b>, Art. No.: CD001206. &lt;doi: <a href="https://doi.org/10.1002/14651858.CD001206.pub3">10.1002/14651858.CD001206.pub3</a>&gt;
</p>

<hr>
<h2 id='dat.xu'>
A Network Meta-Analysis on Immune Checkpoint Inhibitor Drugs
</h2><span id='topic+dat.xu'></span>

<h3>Description</h3>

<p>This network meta-analysis investigates the effects of seven immune checkpoint inhibitor (ICI) drugs on all-grade treatment-related adverse events (TrAEs). It aimed to provide a safety ranking of the ICI drugs for the treatment of cancer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.xu")</code></pre>


<h3>Format</h3>

<p>A dataset of network meta-analysis with binary outcomes, containing 23 studies and 7 treatments.
</p>

<dl>
<dt><code>sid</code></dt><dd><p>study IDs.</p>
</dd>
<dt><code>tid</code></dt><dd><p>treatment IDs.</p>
</dd>
<dt><code>r</code></dt><dd><p>event counts.</p>
</dd>
<dt><code>n</code></dt><dd><p>sample sizes.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Treatment IDs represent: 1) conventional therapy; 2) nivolumab; 3) pembrolizumab; 4) two ICIs; 5) ICI and conventional therapy; 6) atezolizumab; and 7) ipilimumab.
</p>


<h3>Source</h3>

<p>Xu C, Chen YP, Du XJ, Liu JQ, Huang CL, Chen L, Zhou GQ, Li WF, Mao YP, Hsu C, Liu Q, Lin AH, Tang LL, Sun Y, Ma J (2018). &quot;Comparative safety of immune checkpoint inhibitors in cancer: systematic review and network meta-analysis.&quot; <em>BMJ</em>, <b>363</b>, k4226. &lt;doi: <a href="https://doi.org/10.1136/bmj.k4226">10.1136/bmj.k4226</a>&gt;
</p>

<hr>
<h2 id='maprop.glmm'>
Meta-Analysis of Proportions Using Generalized Linear Mixed Models
</h2><span id='topic+maprop.glmm'></span>

<h3>Description</h3>

<p>Performs a meta-analysis of proportions using generalized linear mixed models (GLMMs) with various link functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maprop.glmm(e, n, data, link = "logit", alpha = 0.05,
            pop.avg = TRUE, int.approx = 10000, b.iter = 1000,
            seed = 1234, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="maprop.glmm_+3A_e">e</code></td>
<td>

<p>a numeric vector specifying the event counts in the collected studies.
</p>
</td></tr>
<tr><td><code id="maprop.glmm_+3A_n">n</code></td>
<td>

<p>a numeric vector specifying the sample sizes in the collected studies.
</p>
</td></tr>
<tr><td><code id="maprop.glmm_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the meta-analysis dataset. If <code>data</code> is specified, the previous arguments, <code>e</code> and <code>n</code>, should be specified as their corresponding column names in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="maprop.glmm_+3A_link">link</code></td>
<td>

<p>a character string specifying the link function used in the GLMM, which can be one of <code>"log"</code> (log link), <code>"logit"</code> (logit link, the default), <code>"probit"</code> (probit link), <code>"cauchit"</code> (cauchit link), and <code>"cloglog"</code> (complementary log-log link).
</p>
</td></tr>
<tr><td><code id="maprop.glmm_+3A_alpha">alpha</code></td>
<td>

<p>a numeric value specifying the statistical significance level.
</p>
</td></tr>
<tr><td><code id="maprop.glmm_+3A_pop.avg">pop.avg</code></td>
<td>

<p>a logical value indicating whether the population-averaged proportion and its confidence interval are to be produced. This quantity is the marginal mean of study-specific proportions, while the commonly-reported overall proportion usually represents the median (or interpreted as a conditional measure); see more details about this quantity in Section 13.2.3 in Agresti (2013), Chu et al. (2012), Lin and Chu (2020), and Zeger et al. (1988). If <code>pop.avg</code> = <code>TRUE</code> (the default), the bootstrap resampling is used to produce the confidence interval of the population-averaged proportion; the confidence interval of the commonly-reported median proportion will be also produced, in addition to its conventional confidence interval (by back-transforming the Wald-type confidence interval derived on the scale specified by <code>link</code>).
</p>
</td></tr>
<tr><td><code id="maprop.glmm_+3A_int.approx">int.approx</code></td>
<td>

<p>an integer specifying the number of independent standard normal samples for numerically approximating the integration involved in the calculation of the population-averaged proportion; see details in Lin and Chu (2020). It is only used when <code>pop.avg</code> = <code>TRUE</code> and <code>link</code> is not <code>"probit"</code>. The probit link leads to a closed form of the population-averaged proportion, so it does not need the numerical approximation; for other links, the population-averaged proportion does not have a closed form.
</p>
</td></tr>
<tr><td><code id="maprop.glmm_+3A_b.iter">b.iter</code></td>
<td>

<p>an integer specifying the number of bootstrap iterations; it is only used when <code>pop.avg</code> = <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="maprop.glmm_+3A_seed">seed</code></td>
<td>

<p>an integer for specifying the seed of the random number generation for reproducibility during the bootstrap resampling (and numerical approximation for the population-averaged proportion); it is only used when <code>pop.avg</code> = <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="maprop.glmm_+3A_...">...</code></td>
<td>

<p>other arguments that can be passed to the function <code><a href="lme4.html#topic+glmer">glmer</a></code> in the package <span class="pkg">lme4</span>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a list containing the point and interval estimates of the overall proportion. Specifically, <code>prop.c.est</code> is the commonly-reported median (or conditional) proportion, and <code>prop.c.ci</code> is its confidence interval. It also returns information about AIC, BIC, log likelihood, deviance, and residual degrees-of-freedom. If <code>pop.avg</code> = <code>TRUE</code>, the following additional elements will be also in the produced list: <code>prop.c.ci.b</code> is the bootstrap confidence interval of the commonly-reported median (conditional) proportion, <code>prop.m.est</code> is the point estimate of the population-averaged (marginal) proportion, <code>prop.m.ci.b</code> is the bootstrap confidence interval of the population-averaged (marginal) proportion, and <code>b.w.e</code> is a vector of two numeric values, indicating the counts of warnings and errors occurred during the bootstrap iterations.
</p>


<h3>Note</h3>

<p>This function implements the GLMM for the meta-analysis of proportions via the function <code><a href="lme4.html#topic+glmer">glmer</a></code> in the package <span class="pkg">lme4</span>. It is possible that the algorithm of the GLMM estimation may not converge for some bootstrapped meta-analyses when <code>pop.avg</code> = <code>TRUE</code>, and the function <code><a href="lme4.html#topic+glmer">glmer</a></code> may report warnings or errors about the convergence issue. The bootstrap iterations are continued until <code>b.iter</code> replicates without any warnings or errors are obtained; those replicates with any warnings or errors are discarded.
</p>


<h3>References</h3>

<p>Agresti A (2013). <em>Categorical Data Analysis</em>. Third edition. John Wiley &amp; Sons, Hoboken, NJ.
</p>
<p>Bakbergenuly I, Kulinskaya E (2018). &quot;Meta-analysis of binary outcomes via generalized linear mixed models: a simulation study.&quot; <em>BMC Medical Research Methodology</em>, <b>18</b>, 70. &lt;doi: <a href="https://doi.org/10.1186/s12874-018-0531-9">10.1186/s12874-018-0531-9</a>&gt;
</p>
<p>Chu H, Nie L, Chen Y, Huang Y, Sun W (2012). &quot;Bivariate random effects models for meta-analysis of comparative studies with binary outcomes: methods for the absolute risk difference and relative risk.&quot; <em>Statistical Methods in Medical Research</em>, <b>21</b>(6), 621&ndash;633. &lt;doi: <a href="https://doi.org/10.1177/0962280210393712">10.1177/0962280210393712</a>&gt;
</p>
<p>Hamza TH, van Houwelingen HC, Stijnen T (2008). &quot;The binomial distribution of meta-analysis was preferred to model within-study variability.&quot; <em>Journal of Clinical Epidemiology</em>, <b>61</b>(1), 41&ndash;51. &lt;doi: <a href="https://doi.org/10.1016/j.jclinepi.2007.03.016">10.1016/j.jclinepi.2007.03.016</a>&gt;
</p>
<p>Lin L, Chu H (2020). &quot;Meta-analysis of proportions using generalized linear mixed models.&quot; <em>Epidemiology</em>, <b>31</b>(5), 713&ndash;717. &lt;doi: <a href="https://doi.org/10.1097/ede.0000000000001232">10.1097/ede.0000000000001232</a>&gt;
</p>
<p>Stijnen T, Hamza TH, Ozdemir P (2010). &quot;Random effects meta-analysis of event outcome in the framework of the generalized linear mixed model with applications in sparse data.&quot; <em>Statistics in Medicine</em>, <b>29</b>(29), 3046&ndash;3067. &lt;doi: <a href="https://doi.org/10.1002/sim.4040">10.1002/sim.4040</a>&gt;
</p>
<p>Zeger SL, Liang K-Y, Albert PS (1988). &quot;Models for longitudinal data: a generalized estimating equation approach.&quot; <em>Biometrics</em>, <b>44</b>(4), 1049&ndash;1060. &lt;doi: <a href="https://doi.org/10.2307/2531734">10.2307/2531734</a>&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+maprop.twostep">maprop.twostep</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># chorioamnionitis data
data("dat.chor")
# GLMM with the logit link with only 10 bootstrap iterations
out.chor.glmm.logit &lt;- maprop.glmm(e, n, data = dat.chor,
  link = "logit", b.iter = 10, seed = 1234)
out.chor.glmm.logit
# not calculating the population-averaged (marginal) proportion,
#  without bootstrap resampling
out.chor.glmm.logit &lt;- maprop.glmm(e, n, data = dat.chor,
  link = "logit", pop.avg = FALSE)
out.chor.glmm.logit

# increases the number of bootstrap iterations to 1000,
#  taking longer time
out.chor.glmm.logit &lt;- maprop.glmm(e, n, data = dat.chor,
  link = "logit", b.iter = 1000, seed = 1234)
out.chor.glmm.logit

# GLMM with the log link
out.chor.glmm.log &lt;- maprop.glmm(e, n, data = dat.chor,
  link = "log", b.iter = 10, seed = 1234)
out.chor.glmm.log
# GLMM with the probit link
out.chor.glmm.probit &lt;- maprop.glmm(e, n, data = dat.chor,
  link = "probit", b.iter = 10, seed = 1234)
out.chor.glmm.probit
# GLMM with the cauchit link
out.chor.glmm.cauchit &lt;- maprop.glmm(e, n, data = dat.chor,
  link = "cauchit", b.iter = 10, seed = 1234)
out.chor.glmm.cauchit
# GLMM with the cloglog link
out.chor.glmm.cloglog &lt;- maprop.glmm(e, n, data = dat.chor,
  link = "cloglog", b.iter = 10, seed = 1234)
out.chor.glmm.cloglog


# depression data
data("dat.beck17")
out.beck17.glmm.log &lt;- maprop.glmm(e, n, data = dat.beck17,
  link = "log", b.iter = 10, seed = 1234)
out.beck17.glmm.log
out.beck17.glmm.logit &lt;- maprop.glmm(e, n, data = dat.beck17,
  link = "logit", b.iter = 10, seed = 1234)
out.beck17.glmm.logit
out.beck17.glmm.probit &lt;- maprop.glmm(e, n, data = dat.beck17,
  link = "probit", b.iter = 10, seed = 1234)
out.beck17.glmm.probit
out.beck17.glmm.cauchit &lt;- maprop.glmm(e, n, data = dat.beck17,
  link = "cauchit", b.iter = 10, seed = 1234)
out.beck17.glmm.cauchit
out.beck17.glmm.cloglog&lt;- maprop.glmm(e, n, data = dat.beck17,
  link = "cloglog", b.iter = 10, seed = 1234)
out.beck17.glmm.cloglog

</code></pre>

<hr>
<h2 id='maprop.twostep'>
Meta-Analysis of Proportions Using Two-Step Methods
</h2><span id='topic+maprop.twostep'></span>

<h3>Description</h3>

<p>Performs a meta-analysis of proportions using conventional two-step methods with various data transformations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maprop.twostep(e, n, data, link = "logit", method = "ML", alpha = 0.05,
               pop.avg = TRUE, int.approx = 10000, b.iter = 1000,
               seed = 1234)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="maprop.twostep_+3A_e">e</code></td>
<td>

<p>a numeric vector specifying the event counts in the collected studies.
</p>
</td></tr>
<tr><td><code id="maprop.twostep_+3A_n">n</code></td>
<td>

<p>a numeric vector specifying the sample sizes in the collected studies.
</p>
</td></tr>
<tr><td><code id="maprop.twostep_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the meta-analysis dataset. If <code>data</code> is specified, the previous arguments, <code>e</code> and <code>n</code>, should be specified as their corresponding column names in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="maprop.twostep_+3A_link">link</code></td>
<td>

<p>a character string specifying the data transformation for each study's proportion used in the two-step method, which can be one of <code>"log"</code> (log transformation), <code>"logit"</code> (logit transformation, the default), <code>"arcsine"</code> (arcsine transformation), and <code>"double.arcsine"</code> (Freeman&ndash;Tukey double-arcsine transformation).
</p>
</td></tr>
<tr><td><code id="maprop.twostep_+3A_method">method</code></td>
<td>

<p>a character string specifying the method to perform the meta-analysis, which is passed to the argument <code>method</code> in the function <code><a href="metafor.html#topic+rma.uni">rma.uni</a></code> in the package <span class="pkg">metafor</span>. It can be one of <code>"ML"</code> (maximum likelihood, the default), <code>"REML"</code> (restricted maximum likelihood), and many other options; see more details in the manual of <span class="pkg">metafor</span>. The default is set to <code>"ML"</code> for consistency with the function <code><a href="#topic+maprop.glmm">maprop.glmm</a></code>, where generalized linear mixed models are often estimated via the maximum likelihood approach. For the two-step method, users might also use <code>"REML"</code> because the restricted maximum likelihood estimation may have superior performance in many cases.
</p>
</td></tr>
<tr><td><code id="maprop.twostep_+3A_alpha">alpha</code></td>
<td>

<p>a numeric value specifying the statistical significance level.
</p>
</td></tr>
<tr><td><code id="maprop.twostep_+3A_pop.avg">pop.avg</code></td>
<td>

<p>a logical value indicating whether the population-averaged proportion and its confidence interval are to be produced. This quantity is the marginal mean of study-specific proportions, while the commonly-reported overall proportion usually represents the median (or interpreted as a conditional measure); see more details about this quantity in Section 13.2.3 in Agresti (2013), Chu et al. (2012), Lin and Chu (2020), and Zeger et al. (1988). If <code>pop.avg</code> = <code>TRUE</code> (the default), the bootstrap resampling is used to produce the confidence interval of the population-averaged proportion; the confidence interval of the commonly-reported median proportion will be also produced, in addition to its conventional confidence interval (by back-transforming the Wald-type confidence interval derived on the scale specified by <code>link</code>).
</p>
</td></tr>
<tr><td><code id="maprop.twostep_+3A_int.approx">int.approx</code></td>
<td>

<p>an integer specifying the number of independent standard normal samples for numerically approximating the integration involved in the calculation of the population-averaged proportion; see details in Lin and Chu (2020). It is only used when <code>pop.avg</code> = <code>TRUE</code>. For the commonly-used data transformations available for <code>link</code>, the population-averaged proportion does not have a closed form.
</p>
</td></tr>
<tr><td><code id="maprop.twostep_+3A_b.iter">b.iter</code></td>
<td>

<p>an integer specifying the number of bootstrap iterations; it is only used when <code>pop.avg</code> = <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="maprop.twostep_+3A_seed">seed</code></td>
<td>

<p>an integer for specifying the seed of the random number generation for reproducibility during the bootstrap resampling (and numerical approximation for the population-averaged proportion); it is only used when <code>pop.avg</code> = <code>TRUE</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a list containing the point and interval estimates of the overall proportion. Specifically, <code>prop.c.est</code> is the commonly-reported median (or conditional) proportion, and <code>prop.c.ci</code> is its confidence interval. If <code>pop.avg</code> = <code>TRUE</code>, the following additional elements will be also in the produced list: <code>prop.c.ci.b</code> is the bootstrap confidence interval of the commonly-reported median (conditional) proportion, <code>prop.m.est</code> is the point estimate of the population-averaged (marginal) proportion, <code>prop.m.ci.b</code> is the bootstrap confidence interval of the population-averaged (marginal) proportion, and <code>b.w.e</code> is a vector of two numeric values, indicating the counts of warnings and errors occurred during the bootstrap iterations. Moreover, if the Freeman&ndash;Tukey double-arcsine transformation (<code>link</code> = <code>"double.arcsine"</code>) is used, the back-transformation will be implemented at four values as the overall sample size: the harmonic, geometric, and arithmetic means of the study-specific sample sizes, and the inverse of the synthesized result's variance. See details in Barendregt et al. (2013) and Schwarzer et al. (2019).
</p>


<h3>Note</h3>

<p>This function implements the two-step method for the meta-analysis of proportions via the <code><a href="metafor.html#topic+rma.uni">rma.uni</a></code> function in the package <span class="pkg">metafor</span>. It is possible that the algorithm of the maximum likelihood or restricted maximum likelihood estimation may not converge for some bootstrapped meta-analyses when <code>pop.avg</code> = <code>TRUE</code>, and the <code><a href="metafor.html#topic+rma.uni">rma.uni</a></code> function may report warnings or errors about the convergence issue. The bootstrap iterations are continued until <code>b.iter</code> replicates without any warnings or errors are obtained; those replicates with any warnings or errors are discarded.
</p>


<h3>References</h3>

<p>Agresti A (2013). <em>Categorical Data Analysis</em>. Third edition. John Wiley &amp; Sons, Hoboken, NJ.
</p>
<p>Barendregt JJ, Doi SA, Lee YY, Norman RE, Vos T (2013). &quot;Meta-analysis of prevalence.&quot; <em>Journal of Epidemiology and Community Health</em>, <b>67</b>(11), 974&ndash;978. &lt;doi: <a href="https://doi.org/10.1136/jech-2013-203104">10.1136/jech-2013-203104</a>&gt;
</p>
<p>Freeman MF, Tukey JW (1950). &quot;Transformations related to the angular and the square root.&quot; <em>The Annals of Mathematical Statistics</em>, <b>21</b>(4), 607&ndash;611. &lt;doi: <a href="https://doi.org/10.1214/aoms/1177729756">10.1214/aoms/1177729756</a>&gt;
</p>
<p>Lin L, Chu H (2020). &quot;Meta-analysis of proportions using generalized linear mixed models.&quot; <em>Epidemiology</em>, <b>31</b>(5), 713&ndash;717. &lt;doi: <a href="https://doi.org/10.1097/ede.0000000000001232">10.1097/ede.0000000000001232</a>&gt;
</p>
<p>Miller JJ (1978). &quot;The inverse of the Freeman&ndash;Tukey double arcsine transformation.&quot; <em>The American Statistician</em>, <b>32</b>(4), 138. &lt;doi: <a href="https://doi.org/10.1080/00031305.1978.10479283">10.1080/00031305.1978.10479283</a>&gt;
</p>
<p>Schwarzer G, Chemaitelly H, Abu-Raddad LJ, Rucker G (2019). &quot;Seriously misleading results using inverse of Freeman-Tukey double arcsine transformation in meta-analysis of single proportions.&quot; <em>Research Synthesis Methods</em>, <b>10</b>(3), 476&ndash;483. &lt;doi: <a href="https://doi.org/10.1002/jrsm.1348">10.1002/jrsm.1348</a>&gt;
</p>
<p>Viechtbauer W (2010). &quot;Conducting meta-analyses in R with the metafor package.&quot; <em>Journal of Statistical Software</em>, <b>36</b>, 3. &lt;doi: <a href="https://doi.org/10.18637/jss.v036.i03">10.18637/jss.v036.i03</a>&gt;
</p>
<p>Zeger SL, Liang K-Y, Albert PS (1988). &quot;Models for longitudinal data: a generalized estimating equation approach.&quot; <em>Biometrics</em>, <b>44</b>(4), 1049&ndash;1060. &lt;doi: <a href="https://doi.org/10.2307/2531734">10.2307/2531734</a>&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+maprop.glmm">maprop.glmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># chorioamnionitis data
data("dat.chor")
# two-step method with the logit transformation
out.chor.twostep.logit &lt;- maprop.twostep(e, n, data = dat.chor,
  link = "logit", b.iter = 10, seed = 1234)
out.chor.twostep.logit
# not calculating the population-averaged (marginal) proportion,
#  without bootstrap resampling
out.chor.twostep.logit &lt;- maprop.twostep(e, n, data = dat.chor,
  link = "logit", pop.avg = FALSE)
out.chor.twostep.logit

# increases the number of bootstrap iterations to 1000,
#  taking longer time
out.chor.twostep.logit &lt;- maprop.twostep(e, n, data = dat.chor,
  link = "logit", b.iter = 1000, seed = 1234)
out.chor.twostep.logit

# two-step method with the log transformation
out.chor.twostep.log &lt;- maprop.twostep(e, n, data = dat.chor,
  link = "log", b.iter = 10, seed = 1234)
out.chor.twostep.log
# two-step method with the arcsine transformation
out.chor.twostep.arcsine &lt;- maprop.twostep(e, n, data = dat.chor,
  link = "arcsine", b.iter = 10, seed = 1234)
out.chor.twostep.arcsine
# two-step method with the Freeman--Tukey double-arcsine transformation
out.chor.twostep.double.arcsine &lt;- maprop.twostep(e, n, data = dat.chor,
  link = "double.arcsine", b.iter = 10, seed = 1234)
out.chor.twostep.double.arcsine


# depression data
data("dat.beck17")
out.beck17.twostep.log &lt;- maprop.twostep(e, n, data = dat.beck17,
  link = "log", b.iter = 10, seed = 1234)
out.beck17.twostep.log
out.beck17.twostep.logit &lt;- maprop.twostep(e, n, data = dat.beck17,
  link = "logit", b.iter = 10, seed = 1234)
out.beck17.twostep.logit
out.beck17.twostep.arcsine &lt;- maprop.twostep(e, n, data = dat.beck17,
  link = "arcsine", b.iter = 10, seed = 1234)
out.beck17.twostep.arcsine
out.beck17.twostep.double.arcsine &lt;- maprop.twostep(e, n, data = dat.beck17,
  link = "double.arcsine", b.iter = 10, seed = 1234)
out.beck17.twostep.double.arcsine

</code></pre>

<hr>
<h2 id='meta.biv'>
Bivariate Method for Meta-Analysis.
</h2><span id='topic+meta.biv'></span>

<h3>Description</h3>

<p>Performs a meta-analysis with a binary outcome using a bivariate generalized linear mixed model (GLMM) described in Chu et al. (2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meta.biv(sid, tid, e, n, data, link = "logit", alpha = 0.05,
         b.iter = 1000, seed = 1234, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meta.biv_+3A_sid">sid</code></td>
<td>

<p>a vector specifying the study IDs.
</p>
</td></tr>
<tr><td><code id="meta.biv_+3A_tid">tid</code></td>
<td>

<p>a vector of 0/1 specifying the treatment/exposure IDs (0: control/non-exposure; 1: treatment/exposure).
</p>
</td></tr>
<tr><td><code id="meta.biv_+3A_e">e</code></td>
<td>

<p>a numeric vector specifying the event counts.
</p>
</td></tr>
<tr><td><code id="meta.biv_+3A_n">n</code></td>
<td>

<p>a numeric vector specifying the sample sizes.
</p>
</td></tr>
<tr><td><code id="meta.biv_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the meta-analysis dataset. If <code>data</code> is specified, the previous arguments, <code>sid</code>, <code>tid</code>, <code>e</code>, and <code>n</code>, should be specified as their corresponding column names in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="meta.biv_+3A_link">link</code></td>
<td>

<p>a character string specifying the link function used in the GLMM, which can be either <code>"logit"</code> (the default) or <code>"probit"</code>.
</p>
</td></tr>
<tr><td><code id="meta.biv_+3A_alpha">alpha</code></td>
<td>

<p>a numeric value specifying the statistical significance level.
</p>
</td></tr>
<tr><td><code id="meta.biv_+3A_b.iter">b.iter</code></td>
<td>

<p>an integer specifying the number of bootstrap iterations, which are used to produce confidence intervals of marginal results.
</p>
</td></tr>
<tr><td><code id="meta.biv_+3A_seed">seed</code></td>
<td>

<p>an integer for specifying the seed of the random number generation for reproducibility during the bootstrap resampling.
</p>
</td></tr>
<tr><td><code id="meta.biv_+3A_...">...</code></td>
<td>

<p>other arguments that can be passed to the function <code><a href="lme4.html#topic+glmer">glmer</a></code> in the package <span class="pkg">lme4</span>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose a meta-analysis with a binary outcome contains <code class="reqn">N</code> studies. Let <code class="reqn">n_{i0}</code> and <code class="reqn">n_{i1}</code> be the sample sizes in the control/non-exposure and treatment/exposure groups in study <code class="reqn">i</code>, respectively, and let <code class="reqn">e_{i0}</code> and <code class="reqn">e_{i1}</code> be the event counts (<code class="reqn">i = 1, \ldots, N</code>). The event counts are assumed to independently follow binomial distributions:
</p>
<p style="text-align: center;"><code class="reqn">e_{i0} \sim Bin(n_{i0}, p_{i0});</code>
</p>

<p style="text-align: center;"><code class="reqn">e_{i1} \sim Bin(n_{i1}, p_{i1}),</code>
</p>

<p>where <code class="reqn">p_{i0}</code> and <code class="reqn">p_{i1}</code> represent the true event probabilities. They are modeled jointly as follows:
</p>
<p style="text-align: center;"><code class="reqn">g(p_{i0}) = \mu_0 + \nu_{i0};</code>
</p>

<p style="text-align: center;"><code class="reqn">g(p_{i1}) = \mu_1 + \nu_{i1};</code>
</p>

<p style="text-align: center;"><code class="reqn">(\nu_{i0}, \nu_{i1})^\prime \sim N ((0, 0)^\prime, \mathbf{\Sigma}).</code>
</p>

<p>Here, <code class="reqn">g(\cdot)</code> denotes the link function that transforms the event probabilities to linear forms. The fixed effects <code class="reqn">\mu_0</code> and <code class="reqn">\mu_1</code> represent the overall event probabilities on the transformed scale. The study-specific parameters <code class="reqn">\nu_{i0}</code> and <code class="reqn">\nu_{i1}</code> are random effects, which are assumed to follow the bivariate normal distribution with zero means and variance-covariance matrix <code class="reqn">\mathbf{\Sigma}</code>. The diagonal elements of <code class="reqn">\mathbf{\Sigma}</code> are <code class="reqn">\sigma_0^2</code> and <code class="reqn">\sigma_1^2</code> (between-study variances due to heterogeneity), and the off-diagonal elements are <code class="reqn">\rho \sigma_0 \sigma_1</code>, where <code class="reqn">\rho</code> is the correlation coefficient.
</p>
<p>When using the logit link, <code class="reqn">\mu_1 - \mu_0</code> represents the log odds ratio (Van Houwelingen et al., 1993; Stijnen et al., 2010; Jackson et al., 2018); <code class="reqn">\exp(\mu_1 - \mu_0)</code> may be referred to as the conditional odds ratio (Agresti, 2013). Alternatively, we can obtain the marginal event probabilities (Chu et al., 2012):
</p>
<p style="text-align: center;"><code class="reqn">p_k = E[p_{ik}] \approx \left[1 + \exp\left(-\mu_k/\sqrt{1 + C^2 \sigma_k^2}\right)\right]^{-1}</code>
</p>

<p>for <code class="reqn">k</code> = 0 and 1, where <code class="reqn">C = 16 \sqrt{3} / (15 \pi)</code>. The marginal odds ratio, relative risk, and risk difference are subsequently obtained as <code class="reqn">[p_1/(1 - p_1)]/[p_0/(1 - p_0)]</code>, <code class="reqn">p_1/p_0</code>, and <code class="reqn">p_1 - p_0</code>, respectively.
</p>
<p>When using the probit link, the model does not yield the conditional odds ratio. The marginal probabilities have closed-form solutions:
</p>
<p style="text-align: center;"><code class="reqn">p_k = E[p_{ik}] = \Phi\left(\mu_k/\sqrt{1 + \sigma_k^2}\right)</code>
</p>

<p>for <code class="reqn">k</code> = 0 and 1, where <code class="reqn">\Phi(\cdot)</code> is the cumulative distribution function of the standard normal distribution. They further lead to the marginal odds ratio, relative risk, and risk difference.
</p>


<h3>Value</h3>

<p>This function returns a list containing the point and interval estimates of the marginal event rates (<code>p0.m</code>, <code>p0.m.ci</code>, <code>p1.m</code>, and <code>p1.m.ci</code>), odds ratio (<code>OR.m</code> and <code>OR.m.ci</code>), relative risk (<code>RR.m</code> and <code>RR.m.ci</code>), risk difference (<code>RD.m</code> and <code>RD.m.ci</code>), and correlation coefficient between the two treatment/exposure groups (<code>rho</code> and <code>rho.ci</code>). These interval estimates are obtained using the bootstrap resampling. During the bootstrap resampling, computational warnings or errors may occur for implementing the bivariate GLMM in some resampled meta-analyses. This function returns the counts of warnings and errors (<code>b.w.e</code>). The resampled meta-analyses that lead to warnings and errors are not used for producing the bootstrap confidence intervals; the bootstrap iterations stop after obtaining <code>b.iter</code> resampled meta-analyses without warnings and errors. If the logit link is used (<code>link</code> = <code>"logit"</code>), it also returns the point and interval estimates of the conditional odds ratio (<code>OR.c</code> and <code>OR.c.ci</code>), which are more frequently reported in the current literature than the marginal odds ratios. Unlike the marginal results that use the bootstrap resampling to produce their confidence intervals, the Wald-type confidence interval is calculated for the log conditional odds ratio; it is then transformed to the odds ratio scale.
</p>


<h3>References</h3>

<p>Agresti A (2013). <em>Categorical Data Analysis</em>. Third edition. John Wiley &amp; Sons, Hoboken, NJ.
</p>
<p>Chu H, Nie L, Chen Y, Huang Y, Sun W (2012). &quot;Bivariate random effects models for meta-analysis of comparative studies with binary outcomes: methods for the absolute risk difference and relative risk.&quot; <em>Statistical Methods in Medical Research</em>, <b>21</b>(6), 621&ndash;633. &lt;doi: <a href="https://doi.org/10.1177/0962280210393712">10.1177/0962280210393712</a>&gt;
</p>
<p>Jackson D, Law M, Stijnen T, Viechtbauer W, White IR (2018). &quot;A comparison of seven random-effects models for meta-analyses that estimate the summary odds ratio.&quot; <em>Statistics in Medicine</em>, <b>37</b>(7), 1059&ndash;1085. &lt;doi: <a href="https://doi.org/10.1002/sim.7588">10.1002/sim.7588</a>&gt;
</p>
<p>Stijnen T, Hamza TH, Ozdemir P (2010). &quot;Random effects meta-analysis of event outcome in the framework of the generalized linear mixed model with applications in sparse data.&quot; <em>Statistics in Medicine</em>, <b>29</b>(29), 3046&ndash;3067. &lt;doi: <a href="https://doi.org/10.1002/sim.4040">10.1002/sim.4040</a>&gt;
</p>
<p>Van Houwelingen HC, Zwinderman KH, Stijnen T (1993). &quot;A bivariate approach to meta-analysis.&quot; <em>Statistics in Medicine</em>, <b>12</b>(24), 2273&ndash;2284. &lt;doi: <a href="https://doi.org/10.1002/sim.4780122405">10.1002/sim.4780122405</a>&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+maprop.glmm">maprop.glmm</a></code>, <code><a href="#topic+meta.dt">meta.dt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("dat.bellamy")
out.bellamy.logit &lt;- meta.biv(sid, tid, e, n, data = dat.bellamy,
  link = "logit", b.iter = 1000)
out.bellamy.logit
out.bellamy.probit &lt;- meta.biv(sid, tid, e, n, data = dat.bellamy,
  link = "probit", b.iter = 1000)
out.bellamy.probit

</code></pre>

<hr>
<h2 id='meta.dt'>
Meta-Analysis of Diagnostic Tests
</h2><span id='topic+meta.dt'></span>

<h3>Description</h3>

<p>Performs a meta-analysis of diagnostic tests using approaches described in Reitsma et al. (2005) and Chu and Cole (2006).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meta.dt(tp, fp, fn, tn, data, method = "biv.glmm", alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meta.dt_+3A_tp">tp</code></td>
<td>

<p>counts of true positives.
</p>
</td></tr>
<tr><td><code id="meta.dt_+3A_fp">fp</code></td>
<td>

<p>counts of false positives.
</p>
</td></tr>
<tr><td><code id="meta.dt_+3A_fn">fn</code></td>
<td>

<p>counts of false negatives.
</p>
</td></tr>
<tr><td><code id="meta.dt_+3A_tn">tn</code></td>
<td>

<p>counts of true negatives.
</p>
</td></tr>
<tr><td><code id="meta.dt_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the meta-analysis dataset. If <code>data</code> is specified, the previous arguments, <code>tp</code>, <code>fp</code>, <code>fn</code>, and <code>tn</code>, should be specified as their corresponding column names in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="meta.dt_+3A_method">method</code></td>
<td>

<p>a character string specifying the method used to implement the meta-analysis of diagnostic tests. It should be one of <code>"s.roc"</code> (summary ROC approach), <code>"biv.lmm"</code> (bivariate linear mixed model), and <code>"biv.glmm"</code> (bivariate generalized linear mixed model, the default). See details.
</p>
</td></tr>
<tr><td><code id="meta.dt_+3A_alpha">alpha</code></td>
<td>

<p>a numeric value specifying the statistical significance level.
</p>
</td></tr>
<tr><td><code id="meta.dt_+3A_...">...</code></td>
<td>

<p>other arguments that can be passed to the function <code><a href="stats.html#topic+lm">lm</a></code> (when <code>method</code> = <code>"s.roc"</code>), the function <code><a href="metafor.html#topic+rma.mv">rma.mv</a></code> in the package <span class="pkg">metafor</span> (when <code>method</code> = <code>"biv.lmm"</code>), or the function <code><a href="lme4.html#topic+glmer">glmer</a></code> in the package <span class="pkg">lme4</span> (when <code>method</code> = <code>"biv.glmm"</code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose a meta-analysis of diagnostic tests contains <code class="reqn">N</code> studies. Each study reports the counts of true positives, false positives, false negatives, and true negatives, denoted by <code class="reqn">TP_i</code>, <code class="reqn">FP_i</code>, <code class="reqn">FN_i</code>, and <code class="reqn">TN_i</code>, respectively. The study-specific estimates of sensitivity and specificity are calculated as <code class="reqn">Se_i = TP_i/(TP_i + FN_i)</code> and <code class="reqn">Sp_i = TN_i/(FP_i + TN_i)</code> for <code class="reqn">i = 1, \cdots, N</code>. They are analyzed on the logarithmic scale in the meta-analysis. When using the summary ROC (receiver operating characteristic) approach or the bivariate linear mixed model, 0.5 needs to be added to all four counts in a study when at least one count is zero.
</p>
<p>The summary ROC approach first calculates
</p>
<p style="text-align: center;"><code class="reqn">D_i = \log \left( \frac{Se_i}{1 - Se_i} \right) + \log \left( \frac{Sp_i}{1 - Sp_i} \right);</code>
</p>

<p style="text-align: center;"><code class="reqn">S_i = \log \left( \frac{Se_i}{1 - Se_i} \right) - \log \left( \frac{Sp_i}{1 - Sp_i} \right),</code>
</p>

<p>where <code class="reqn">D_i</code> represents the log diagnostic odds ratio (DOR) in study <code class="reqn">i</code>. A linear regression is then fitted:
</p>
<p style="text-align: center;"><code class="reqn">D_i = \alpha + \beta \cdot S_i.</code>
</p>

<p>The regression could be either unweighted or weighted; this function performs both versions. If weighted, the study-specific weights are the inverse of the variances of <code class="reqn">D_i</code>, i.e., <code class="reqn">1/TP_i + 1/FP_i + 1/FN_i + 1/TN_i</code>. Based on the estimated regression intercept <code class="reqn">\hat{\alpha}</code> and slope <code class="reqn">\hat{\beta}</code>, one may obtain the DOR at mean of <code class="reqn">S_i</code>, Q point, summary ROC curve, and area under the curve (AUC). The Q point is the point on the summary ROC curve where sensitivity and specificity are equal. The ROC curve is given by
</p>
<p style="text-align: center;"><code class="reqn">Se = \left\{ 1 + e^{-\hat{\alpha}/(1 - \hat{\beta})} \cdot [Sp/(1 - Sp)]^{(1 + \hat{\beta})/(1 - \hat{\beta})} \right\}^{-1}.</code>
</p>

<p>See more details of the summary ROC approach in Moses et al. (1993) and Irwig et al. (1995).
</p>
<p>The bivariate linear mixed model described in Reitsma et al. (2005) assumes that the logit sensitivity and logit specificity independently follow normal distributions within each study: <code class="reqn">g(Se_i) \sim N(\theta_{i, Se}, s_{i, Se}^2)</code> and <code class="reqn">g(Sp_i) \sim N(\theta_{i, Sp}, s_{i, Sp}^2)</code>, where <code class="reqn">g(\cdot)</code> denotes the logit function. The within-study variances are calculated as <code class="reqn">s_{i, Se}^2 = 1/TP_i + 1/FN_i</code> and <code class="reqn">s_{i, Sp}^2 = 1/FP_i + 1/TN_i</code>. The parameters <code class="reqn">\theta_{i, Se}</code> and <code class="reqn">\theta_{i, Sp}</code> are the underlying true sensitivity and specificity (on the logit scale) in study <code class="reqn">i</code>. They are assumed to be random effects, jointly following a bivariate normal distribution:
</p>
<p style="text-align: center;"><code class="reqn">\left(\theta_{i, Se}, \theta_{i, Sp}\right)^\prime \sim N\left((\mu_{Se}, \mu_{Sp})^\prime, \mathbf{\Sigma} \right),</code>
</p>

<p>where <code class="reqn">\mathbf{\Sigma}</code> is the between-study variance-covariance matrix. The diagonal elements of <code class="reqn">\mathbf{\Sigma}</code> are <code class="reqn">\sigma_{Se}^2</code> and <code class="reqn">\sigma_{Sp}^2</code>, representing the heterogeneity variances of sensitivities and specificities (on the logit scale), respectively. The correlation coefficient is <code class="reqn">\rho</code>.
</p>
<p>The bivariate generalized linear mixed model described in Chu and Cole (2006) refines the bivariate linear mixed model by directly modeling the counts of true positives and true negatives. This approach does not require the assumption that the logit sensitivity and logit specificity approximately follow normal distributions within studies, which could be seriously violated in the presence of small data counts. It also avoids corrections for zero counts. Specificially, the counts of true positives and true negatives are modeled using binomial likelihoods:
</p>
<p style="text-align: center;"><code class="reqn">TP_i \sim Bin(TP_i + FN_i, Se_i);</code>
</p>

<p style="text-align: center;"><code class="reqn">TN_i \sim Bin(FP_i + TN_i, Sp_i);</code>
</p>

<p style="text-align: center;"><code class="reqn">\left( g(Se_i), g(Sp_i) \right)^\prime \sim N\left((\mu_{Se}, \mu_{Sp})^\prime, \mathbf{\Sigma} \right).</code>
</p>

<p>See more details in Chu and Cole (2006) and Ma et al. (2016).
</p>
<p>For both the bivariate linear mixed model and bivariate generalized linear mixed model, <code class="reqn">\mu_{Se}</code> and <code class="reqn">\mu_{Sp}</code> represent the overall sensitivity and specificity (on the logit scale) across studies, respectively, and <code class="reqn">\mu_{Se} + \mu_{Sp}</code> represents the log DOR. The summary ROC curve may be constructed as
</p>
<p style="text-align: center;"><code class="reqn">Se = \left\{ 1 + e^{-\hat{\mu}_{Se} + \hat{\mu}_{Sp} \cdot \hat{\rho} \hat{\sigma}_{Se}/\hat{\sigma}_{Sp}} \cdot [Sp/(1 - Sp)]^{-\rho \hat{\sigma}_{Se}/\hat{\sigma}_{Sp}} \right\}^{-1}.</code>
</p>



<h3>Value</h3>

<p>This function returns a list of the meta-analysis results. When <code>method</code> = <code>"s.roc"</code>, the list consists of the regression intercept (<code>inter.unwtd</code>), slope (<code>slope.unwtd</code>), their variance-covariance matrix (<code>vcov.unwtd</code>), DOR at mean of <code class="reqn">S_i</code> (<code>DOR.meanS.unwtd</code>) with its confidence interval (<code>DOR.meanS.unwtd.ci</code>), Q point (<code>Q.unwtd</code>) with its confidence interval (<code>Q.unwtd.ci</code>), and AUC (<code>AUC.unwtd</code>) for the unweighted regression; it also consists of the counterparts for the weighted regression. When <code>method</code> = <code>"biv.lmm"</code> or <code>"biv.glmm"</code>, the list consists of the overall sensitivity (<code>sens.overall</code>) with its confidence interval (<code>sens.overall.ci</code>), overall specificity (<code>spec.overall</code>) with its confidence interval (<code>spec.overall.ci</code>), overall DOR (<code>DOR.overall</code>) with its confidence interval (<code>DOR.overall.ci</code>), AUC (<code>AUC</code>), estimated <code class="reqn">\mu_{Se}</code> (<code>mu.sens</code>), <code class="reqn">\mu_{Sp}</code> (<code>mu.spec</code>), their variance-covariance matrix (<code>mu.vcov</code>), estimated <code class="reqn">\sigma_{Se}</code> (<code>sig.sens</code>), <code class="reqn">\sigma_{Sp}</code> (<code>sig.spec</code>), and <code class="reqn">\rho</code> (<code>rho</code>). In addition, the list includes the method used to perform the meta-analysis of diagnostic tests (<code>method</code>), significance level (<code>alpha</code>), and original data (<code>data</code>).
</p>


<h3>Note</h3>

<p>The original articles by Reitsma et al. (2005) and Chu and Cole (2006) used SAS to implement (generalized) linear mixed models (specifically, <code>PROC MIXED</code> and <code>PROC NLMIXED</code>); this function imports <code><a href="metafor.html#topic+rma.mv">rma.mv</a></code> from the package <span class="pkg">metafor</span> and <code><a href="lme4.html#topic+glmer">glmer</a></code> from the package <span class="pkg">lme4</span> for implementing these models. The estimation approaches adopted in SAS and the R packages <span class="pkg">metafor</span> and <span class="pkg">lme4</span> may differ, which may impact the results. See, for example, Zhang et al. (2011).
</p>


<h3>Author(s)</h3>

<p>Lifeng Lin, Kristine J. Rosenberger
</p>


<h3>References</h3>

<p>Chu H, Cole SR (2006). &quot;Bivariate meta-analysis of sensitivity and specificity with sparse data: a generalized linear mixed model approach.&quot; <em>Journal of Clinical Epidemiology</em>, <b>59</b>(12), 1331&ndash;1332. &lt;doi: <a href="https://doi.org/10.1016/j.jclinepi.2006.06.011">10.1016/j.jclinepi.2006.06.011</a>&gt;
</p>
<p>Irwig L, Macaskill P, Glasziou P, Fahey M (1995). &quot;Meta-analytic methods for diagnostic test accuracy.&quot; <em>Journal of Clinical Epidemiology</em>, <b>48</b>(1), 119&ndash;130. &lt;doi: <a href="https://doi.org/10.1016/0895-4356(94)00099-C">10.1016/0895-4356(94)00099-C</a>&gt;
</p>
<p>Ma X, Nie L, Cole SR, Chu H (2016). &quot;Statistical methods for multivariate meta-analysis of diagnostic tests: an overview and tutorial.&quot; <em>Statistical Methods in Medical Research</em>, <b>25</b>(4), 1596&ndash;1619. &lt;doi: <a href="https://doi.org/10.1177/0962280213492588">10.1177/0962280213492588</a>&gt;
</p>
<p>Moses LE, Shapiro D, Littenberg B (1993). &quot;Combining independent studies of a diagnostic test into a summary ROC curve: data-analytic approaches and some additional considerations.&quot; <em>Statistics in Medicine</em>, <b>12</b>(14), 1293&ndash;1316. &lt;doi: <a href="https://doi.org/10.1002/sim.4780121403">10.1002/sim.4780121403</a>&gt;
</p>
<p>Reitsma JB, Glas AS, Rutjes AWS, Scholten RJPM, Bossuyt PM, Zwinderman AH (2005). &quot;Bivariate analysis of sensitivity and specificity produces informative summary measures in diagnostic reviews.&quot; <em>Journal of Clinical Epidemiology</em>, <b>58</b>(10), 982&ndash;990. &lt;doi: <a href="https://doi.org/10.1016/j.jclinepi.2005.02.022">10.1016/j.jclinepi.2005.02.022</a>&gt;
</p>
<p>Zhang H, Lu N, Feng C, Thurston SW, Xia Y, Zhu L, Tu XM (2011). &quot;On fitting generalized linear mixed-effects models for binary responses using different statistical packages.&quot; <em>Statistics in Medicine</em>, <b>30</b>(20), 2562&ndash;2572. &lt;doi: <a href="https://doi.org/10.1002/sim.4265">10.1002/sim.4265</a>&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+maprop.twostep">maprop.twostep</a></code>, <code><a href="#topic+meta.biv">meta.biv</a></code>, <code><a href="#topic+plot.meta.dt">plot.meta.dt</a></code>, <code><a href="#topic+print.meta.dt">print.meta.dt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dat.scheidler")
out1 &lt;- meta.dt(tp, fp, fn, tn, data = dat.scheidler[dat.scheidler$dt == "MRI",],
  method = "s.roc")
out1
plot(out1)
out2 &lt;- meta.dt(tp, fp, fn, tn, data = dat.scheidler[dat.scheidler$dt == "MRI",],
  method = "biv.lmm")
out2
plot(out2, predict = TRUE)
out3 &lt;- meta.dt(tp, fp, fn, tn, data = dat.scheidler[dat.scheidler$dt == "MRI",],
  method = "biv.glmm")
out3
plot(out3, add = TRUE, studies = FALSE,
  col.roc = "blue", col.overall = "blue", col.confid = "blue",
  predict = TRUE,col.predict = "blue")

data("dat.smith")
out4 &lt;- meta.dt(tp, fp, fn, tn, data = dat.smith, method = "biv.glmm")
out4
plot(out4, predict = TRUE)
</code></pre>

<hr>
<h2 id='meta.pen'>
A penalization approach to random-effects meta-analysis
</h2><span id='topic+meta.pen'></span>

<h3>Description</h3>

<p>Performs the penalization methods introduced in Wang et al. (2022) to achieve a compromise between the common-effect and random-effects model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meta.pen(y, s2, data, tuning.para = "tau", upp = 1, n.cand = 100, tol = 1e-10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meta.pen_+3A_y">y</code></td>
<td>

<p>a numeric vector or the corresponding column name in the argument data, specifying the observed effect sizes in the collected studies.
</p>
</td></tr>
<tr><td><code id="meta.pen_+3A_s2">s2</code></td>
<td>

<p>a numeric vector or the corresponding column name in the argument data, specifying the within-study variances.
</p>
</td></tr>
<tr><td><code id="meta.pen_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the meta-analysis dataset. If <code>data</code> is specified, the previous arguments, <code>y</code> and <code>s2</code>, should be specified as their corresponding column names in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="meta.pen_+3A_tuning.para">tuning.para</code></td>
<td>

<p>a character string specifying the type of tuning parameter used in the penalization method. It should be one of &quot;lambda&quot; (use lambda as a tuning parameter) or &quot;tau&quot; (use the standard deviation as a tuning parameter). The default is &quot;tau&quot;.
</p>
</td></tr>
<tr><td><code id="meta.pen_+3A_upp">upp</code></td>
<td>

<p>a positive scalar used to control the upper bound of the range for the tuning parameter. Specifically, [0, T*<code>upp</code>] is used as the range of a tuning parameter. T is the upper threshold value of a tuning parameter. The default value of <code>upp</code> is 1. 
</p>
</td></tr>
<tr><td><code id="meta.pen_+3A_n.cand">n.cand</code></td>
<td>

<p>the total number of candidate values of the tuning parameter within the specified range. The default is 100. 
</p>
</td></tr>
<tr><td><code id="meta.pen_+3A_tol">tol</code></td>
<td>

<p>the desired accuracy (convergence tolerance). The default is 1e-10.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose a meta-analysis collects <code class="reqn">n</code> independent studies. Let <code class="reqn">\mu_{i}</code> be the true effect size in study <code class="reqn">i</code> (<code class="reqn">i</code> = 1, ..., <code class="reqn">n</code>). Each study reports an estimate of the effect size and its sample variance, denoted by <code class="reqn">y_{i}</code> and <code class="reqn">s_{i}^{2}</code>, respectively. These data are commonly modeled as <code class="reqn">y_{i}</code> from <code class="reqn">N(\mu_{i},s_{i}^{2})</code>. If study-specific true effect sizes <code class="reqn">\mu_{i}</code> are assumed i.i.d. from <code class="reqn">N(\mu, \tau^{2})</code>, this is the random-effects (RE) model, where <code class="reqn">\mu</code> is the overall effect size and <code class="reqn">\tau^{2}</code> is the between-study variance. If <code class="reqn">\tau^{2}=0</code> and thus <code class="reqn">\mu_{i}=\mu</code> for all studies, this implies that studies are homogeneous and the RE model is reduced to the common-effect (CE) model.
</p>
<p>Marginally, the RE model yields <code class="reqn">y_{i} \sim N(\mu,s_{i}^2+\tau^{2})</code>, and its log-likelihood is 
</p>
<p style="text-align: center;"><code class="reqn">l(\mu, \tau^{2}) = -\frac{1}{2} \sum_{i=1}^{n} \left[\log(s_{i}^{2} + \tau^{2}) + \frac{(y_{i} - \mu)^2}{s_{i}^2 + \tau^2}\right] + C,</code>
</p>

<p>where <code class="reqn">C</code> is a constant. In the past two decades, penalization methods have been rapidly developed for variable selection in high-dimensional data analysis to control model complexity and reduce the variance of parameter estimates. Borrowing the idea from the penalization methods, we employ a penalty term on the between-study variance <code class="reqn">\tau^2</code> when the heterogeneity is overestimated. The penalty term increases with <code class="reqn">\tau^2</code>. Specifically, we consider the following optimization problem:
</p>
<p style="text-align: center;"><code class="reqn">(\hat{\mu}(\lambda), \hat{\tau}^2(\lambda)) = \min_{\mu, \tau^2 \geq 0} \left\{\sum_{i=1}^{n} \left[ \log(s_{i}^{2} + \tau^{2}) + \frac{(y_{i} - \mu)^2}{s_{i}^2 + \tau^2}\right] + \lambda \tau^2\right\},</code>
</p>

<p>where <code class="reqn">\lambda \geq 0</code> is a tuning parameter that controls the penalty strength. Using the technique of profile likelihood by taking the target function's derivative in the above equation with respect to <code class="reqn">\mu</code> for a given <code class="reqn">\tau^2</code>. The bivariate optimization problem is reduced to a univariate minimization problem. When <code class="reqn">\lambda=0</code>, the minimization problem is equivalent to minimizing the log-likelihood without penalty, so the penalized-likelihood method is identical to the conventional RE model. By contrast, it can be shown that a sufficiently large <code class="reqn">\lambda</code> produces the estimated between-study variance as 0, leading to the conventional CE model.
</p>
<p>As different tuning parameters lead to different estimates of <code class="reqn">\hat{\mu}(\lambda)</code> and <code class="reqn">\hat{\tau}^2(\lambda)</code>, it is important to select the optimal <code class="reqn">\lambda</code> among a set of candidate values. We perform the cross-validation process and construct a loss function of <code class="reqn">\lambda</code> to measure the performance of specific <code class="reqn">\lambda</code> values. The <code class="reqn">\lambda</code> corresponding to the smallest loss is considered optimal. The threshold, denoted by <code class="reqn">\lambda_{\max}</code>, based on the penalty function <code class="reqn">p(\tau^2)=\tau^2</code> can be calculated. For all <code class="reqn">\lambda &gt; \lambda_{\max}</code>, the estimated between-study variance is 0. Consequently, we select a certain number of candidate values (e.g., 100) from the range <code class="reqn">[0,\lambda_{\max}]</code> for the tuning parameter. For a set of tuning parameters, the leave-one-study-out (i.e., <code class="reqn">n</code>-fold) cross-validation is used to construct the loss function. Specifically, we use the following loss function for the penalization method by tuning <code class="reqn">\lambda</code>:
</p>
<p style="text-align: center;"><code class="reqn">\hat{L}(\lambda) = \left[\frac{1}{n} \sum_{i=1}^{n} \frac{(y_{i} - \hat{\mu}_{(-i)}(\lambda))^2}{s_{i}^2 + \hat{\tau}_{RE(-i)}^2 + \frac{\sum_{j \ne i}(s_{j}^2 + \hat{\tau}_{RE(-i)}^2) / (s_{j}^2 + \hat{\tau}^2_{(-i)}(\lambda))^2}{(\sum_{j \ne i} 1 / (s_{j}^2 + \hat{\tau}^2_{(-i)}(\lambda)))^2}}\right]^{1/2},</code>
</p>

<p>where the subscript <code class="reqn">(-i)</code> indicates that study <code class="reqn">i</code> is removed, <code class="reqn">\hat{\tau}^2_{(-i)}(\lambda)</code> is the estimated between-study variance for a given <code class="reqn">\lambda</code>, <code class="reqn">\hat{\tau}_{RE(-i)}^2</code> is the corresponding between-study variance estimate of the RE model, and 
</p>
<p style="text-align: center;"><code class="reqn">\hat{\mu}_{(-i)}(\lambda) = \frac{\sum_{j \ne i} y_{j} / (s_{j}^2 + \hat{\tau}^2_{(-i)}(\lambda))}{\sum_{j \ne i} 1 / (s_{j}^2 + \hat{\tau}^2_{(-i)}(\lambda))}.</code>
</p>

<p>The above procedure focuses on tuning the parameter, <code class="reqn">\lambda</code>, to control the penalty strength for the between-study variance. Alternatively, for the purpose of shrinking the potentially overestimated heterogeneity, we can directly treat the between-study standard deviation (SD), <code class="reqn">\tau</code>, as the tuning parameter. A set of candidate values of <code class="reqn">\tau</code> are considered, and the value that produces the minimum loss function is selected. Compared with tuning <code class="reqn">\lambda</code> from the perspective of penalized likelihood, tuning <code class="reqn">\tau</code> is more straightforward and intuitive from the practical perspective. The candidate values of <code class="reqn">\tau</code> can be naturally chosen from <code class="reqn">[0,\hat{\tau}_{RE}]</code>, with the lower and upper bounds corresponding to the CE and RE models, respectively. Denoted the candidate SDs as <code class="reqn">\tau_{t}</code>, the loss function with respect to <code class="reqn">\tau_{t}</code> is similarly defined as
</p>
<p style="text-align: center;"><code class="reqn">\hat{L}(\tau_{t}) = \left[\frac{1}{n} \sum_{i=1}^{n} \frac{(y_i - \hat{\mu}_{(-i)}(\tau_{t}))^2}{s_{i}^2 + \hat{\tau}_{RE(-i)} + \frac{\sum_{j \ne i}(s_{j}^2 + \hat{\tau}^2_{RE(-i)}) / (s_{j}^2 + \tau_{t}^2)^2}{[\sum_{j \ne i} 1 / (s_{j}^2 + \tau_{t}^2)]^2}}\right]^{1/2},</code>
</p>

<p>where the overall effect size estimate (excluding study <code class="reqn">i</code>) is
</p>
<p style="text-align: center;"><code class="reqn">\hat{\mu}_{(-i)}(\tau_{t}) = \frac{\sum_{j \ne i} y_j / (s_{j}^2 + \tau_{t}^2)}{\sum_{j \ne i} 1 / (s_{j}^2 + \tau_{t}^2)}.</code>
</p>



<h3>Value</h3>

<p>This function returns a list containing estimates of the overall effect size and their 95% confidence intervals. Specifically, the components include:
</p>
<table>
<tr><td><code>n</code></td>
<td>
<p>the number of studies in the meta-analysis.</p>
</td></tr>
<tr><td><code>I2</code></td>
<td>
<p>the <code class="reqn">I^2</code> statistic for quantifying heterogeneity.</p>
</td></tr>
<tr><td><code>tau2.re</code></td>
<td>
<p>the maximum likelihood estimate of the between-study variance.</p>
</td></tr>
<tr><td><code>mu.fe</code></td>
<td>
<p>the estimated overall effect size of the <code>CE</code> model.</p>
</td></tr>
<tr><td><code>se.fe</code></td>
<td>
<p>the standard deviation of the overall effect size estimate of the <code>CE</code> model.</p>
</td></tr>
<tr><td><code>mu.re</code></td>
<td>
<p>the estimated overall effect size of the <code>RE</code> model.</p>
</td></tr>
<tr><td><code>se.re</code></td>
<td>
<p>the standard deviation of the overall effect size estimate of the <code>RE</code> model.</p>
</td></tr>
<tr><td><code>loss</code></td>
<td>
<p>the values of the loss function for candidate tuning parameters.</p>
</td></tr>
<tr><td><code>tau.cand</code></td>
<td>
<p>the candidate values of the tuning parameter <code class="reqn">\tau</code>.</p>
</td></tr>
<tr><td><code>lambda.cand</code></td>
<td>
<p>the candidate values of the tuning parameter <code class="reqn">\lambda</code>.</p>
</td></tr>
<tr><td><code>tau.opt</code></td>
<td>
<p>the estimated between-study standard deviation of the penalization method.</p>
</td></tr>
<tr><td><code>mu.opt</code></td>
<td>
<p>the estimated overall effect size of the penalization method.</p>
</td></tr>
<tr><td><code>se.opt</code></td>
<td>
<p>the standard error estimate of the estimated overall effect size of the penalization method.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yipeng Wang <a href="mailto:yipeng.wang1@ufl.edu">yipeng.wang1@ufl.edu</a>
</p>


<h3>References</h3>

<p>Wang Y, Lin L, Thompson CG, Chu H (2022). &quot;A penalization approach to random-effects meta-analysis.&quot; <em>Statistics in Medicine</em>, <b>41</b>(3), 500&ndash;516. &lt;doi: <a href="https://doi.org/10.1002/sim.9261">10.1002/sim.9261</a>&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dat.bohren") ## log odds ratio
## perform the penaliztion method by tuning tau
out11 &lt;- meta.pen(y, s2, dat.bohren)
## plot the loss function and candidate taus
plot(out11$tau.cand, out11$loss, xlab = NA, ylab = NA, 
  lwd = 1.5, type = "l", cex.lab = 0.8, cex.axis = 0.8)
title(xlab = expression(paste(tau[t])),
  ylab = expression(paste("Loss function ", ~hat(L)(tau[t]))),
  cex.lab = 0.8, line = 2)
idx &lt;- which(out11$loss == min(out11$loss))
abline(v = out11$tau.cand[idx], col = "gray", lwd = 1.5, lty = 2)
     
## perform the penaliztion method by tuning lambda     
out12 &lt;- meta.pen(y, s2, dat.bohren, tuning.para = "lambda")
## plot the loss function and candidate lambdas
plot(log(out12$lambda.cand + 1), out12$loss, xlab = NA, ylab = NA, 
  lwd=1.5, type = "l", cex.lab = 0.8, cex.axis = 0.8)
title(xlab = expression(log(lambda + 1)),
  ylab = expression(paste("Loss function ", ~hat(L)(lambda))),
  cex.lab = 0.8, line = 2)
idx &lt;- which(out12$loss == min(out12$loss))
abline(v = log(out12$lambda.cand[idx] + 1), col = "gray", lwd = 1.5, lty = 2)


data("dat.bjelakovic") ## log odds ratio
## perform the penaliztion method by tuning tau
out21 &lt;- meta.pen(y, s2, dat.bjelakovic)
## plot the loss function and candidate taus
plot(out21$tau.cand, out21$loss, xlab = NA, ylab = NA, 
  lwd=1.5, type = "l", cex.lab = 0.8, cex.axis = 0.8)
title(xlab = expression(paste(tau[t])),
  ylab = expression(paste("Loss function ", ~hat(L)(tau[t]))),
  cex.lab = 0.8, line = 2)
idx &lt;- which(out21$loss == min(out21$loss))
abline(v = out21$tau.cand[idx], col = "gray", lwd = 1.5, lty = 2)

out22 &lt;- meta.pen(y, s2, dat.bjelakovic, tuning.para = "lambda")

data("dat.carless") ## log odds ratio
## perform the penaliztion method by tuning tau
out31 &lt;- meta.pen(y, s2, dat.carless)
## plot the loss function and candidate taus
plot(out31$tau.cand, out31$loss, xlab = NA, ylab = NA, 
  lwd=1.5, type = "l", cex.lab = 0.8, cex.axis = 0.8)
title(xlab = expression(paste(tau[t])),
  ylab = expression(paste("Loss function ", ~hat(L)(tau[t]))),
  cex.lab = 0.8, line = 2)
idx &lt;- which(out31$loss == min(out31$loss))
abline(v = out31$tau.cand[idx], col = "gray", lwd = 1.5, lty = 2)

out32 &lt;- meta.pen(y, s2, dat.carless, tuning.para = "lambda")

data("dat.adams") ## mean difference
out41 &lt;- meta.pen(y, s2, dat.adams)
## plot the loss function and candidate taus
plot(out41$tau.cand, out41$loss, xlab = NA, ylab = NA, 
  lwd=1.5, type = "l", cex.lab = 0.8, cex.axis = 0.8)
title(xlab = expression(paste(tau[t])),
  ylab = expression(paste("Loss function ", ~hat(L)(tau[t]))),
  cex.lab = 0.8, line = 2)
idx &lt;- which(out41$loss == min(out41$loss))
abline(v = out41$tau.cand[idx], col = "gray", lwd = 1.5, lty = 2)

out42 &lt;- meta.pen(y, s2, dat.adams, tuning.para = "lambda")

</code></pre>

<hr>
<h2 id='metahet'>
Meta-Analysis Heterogeneity Measures
</h2><span id='topic+metahet'></span>

<h3>Description</h3>

<p>Calculates various between-study heterogeneity measures in meta-analysis, including the conventional measures (e.g., <code class="reqn">I^2</code>) and the alternative measures (e.g., <code class="reqn">I_r^2</code>) which are robust to outlying studies; p-values of various tests are also calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metahet(y, s2, data, n.resam = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metahet_+3A_y">y</code></td>
<td>

<p>a numeric vector specifying the observed effect sizes in the collected studies; they are assumed to be normally distributed.
</p>
</td></tr>
<tr><td><code id="metahet_+3A_s2">s2</code></td>
<td>

<p>a numeric vector specifying the within-study variances.
</p>
</td></tr>
<tr><td><code id="metahet_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the meta-analysis dataset. If <code>data</code> is specified, the previous arguments, <code>y</code> and <code>s2</code>, should be specified as their corresponding column names in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="metahet_+3A_n.resam">n.resam</code></td>
<td>

<p>a positive integer specifying the number of resampling iterations for calculating p-values of test statistics and 95% confidence interval of heterogeneity measures.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that a meta-analysis collects <code class="reqn">n</code> studies. The observed effect size in study <code class="reqn">i</code> is <code class="reqn">y_i</code> and its within-study variance is <code class="reqn">s^{2}_{i}</code>. Also, the inverse-variance weight is <code class="reqn">w_i = 1 / s^{2}_{i}</code>. The fixed-effect estimate of overall effect size is <code class="reqn">\bar{\mu} = \sum_{i = 1}^{n} w_i y_i / \sum_{i = 1}^{n} w_i</code>. The conventional test statistic for heterogeneity is
</p>
<p style="text-align: center;"><code class="reqn">Q = \sum_{i = 1}^{n} w_i (y_{i} - \bar{\mu})^2.</code>
</p>

<p>Based on the <code class="reqn">Q</code> statistic, the method-of-moments estimate of the between-study variance <code class="reqn">\hat{\tau}_{DL}^2</code> is (DerSimonian and Laird, 1986)
</p>
<p style="text-align: center;"><code class="reqn">\hat{\tau}^2_{DL} = \max \left\{ 0, \frac{Q - (n - 1)}{\sum_{i = 1}^{n} w_{i} - \sum_{i = 1}^{n} w_{i}^{2} / \sum_{i = 1}^{n} w_{i}} \right\}.</code>
</p>

<p>Also, the <code class="reqn">H</code> and <code class="reqn">I^2</code> statistics (Higgins and Thompson, 2002; Higgins et al., 2003) are widely used in practice because they do not depend on the number of collected studies <code class="reqn">n</code> and the effect size scale; these two statistics are defined as
</p>
<p style="text-align: center;"><code class="reqn">H = \sqrt{Q/(n - 1)};</code>
</p>

<p style="text-align: center;"><code class="reqn">I^{2} = \frac{Q - (n - 1)}{Q}.</code>
</p>

<p>Specifically, the <code class="reqn">H</code> statistic reflects the ratio of the standard deviation of the underlying mean from a random-effects meta-analysis compared to the standard deviation from a fixed-effect meta-analysis; the <code class="reqn">I^2</code> statistic describes the proportion of total variance across studies that is due to heterogeneity rather than sampling error.
</p>
<p>Outliers are frequently present in meta-analyses, and they may have great impact on the above heterogeneity measures. Alternatively, to be more robust to outliers, the test statistic may be modified as (Lin et al., 2017):
</p>
<p style="text-align: center;"><code class="reqn">Q_{r} = \sum_{i = 1}^{n} \sqrt{w_i} |y_{i} - \bar{\mu}|.</code>
</p>

<p>Based on the <code class="reqn">Q_r</code> statistic, the method-of-moments estimate of the between-study variance <code class="reqn">\hat{\tau}_r^2</code> is defined as the solution to
</p>
<p style="text-align: center;"><code class="reqn">Q_r \sqrt{\frac{\pi}{2}} = \sum_{i = 1}^{n} \left\{1 - \frac{w_{i}}{\sum_{j = 1}^{n} w_{j}} + \tau^{2} \left[ w_{i} - \frac{2 w_{i}^{2}}{\sum_{j = 1}^{n} w_{j}} + \frac{w_{i} \sum_{j = 1}^{n} w_{j}^{2}}{(\sum_{j = 1}^{n} w_{j})^2} \right]\right\}.</code>
</p>

<p>If no positive solution exists to the equation above, set <code class="reqn">\hat{\tau}_{r}^{2} = 0</code>. The counterparts of the <code class="reqn">H</code> and <code class="reqn">I^2</code> statistics are defined as
</p>
<p style="text-align: center;"><code class="reqn">H_{r} = Q_r \sqrt{\pi/[2 n (n - 1)]};</code>
</p>

<p style="text-align: center;"><code class="reqn">I_{r}^{2} = \frac{Q_{r}^{2} - 2 n (n - 1) / \pi}{Q_{r}^{2}}.</code>
</p>

<p>To further improve the robustness of heterogeneity assessment, the weighted <em>mean</em> in the <code class="reqn">Q_r</code> statistic may be replaced by the weighted <em>median</em> <code class="reqn">\hat{\mu}_m</code>, which is the solution to <code class="reqn">\sum_{i = 1}^{n} w_i [I (\theta \geq y_i) - 0.5] = 0</code> with respect to <code class="reqn">\theta</code>. The new test statistic is
</p>
<p style="text-align: center;"><code class="reqn">Q_m = \sum_{i = 1}^{n} \sqrt{w_i} |y_{i} - \hat{\mu}_m|.</code>
</p>

<p>Based on <code class="reqn">Q_m</code>, the new estimator of the between-study variance <code class="reqn">\hat{\tau}_m^2</code> is the solution to
</p>
<p style="text-align: center;"><code class="reqn">Q_m \sqrt{\pi/2} = \sum_{i = 1}^{n} \sqrt{(s_i^2 + \tau^2)/s_i^2}.</code>
</p>

<p>The counterparts of the <code class="reqn">H</code> and <code class="reqn">I^2</code> statistics are
</p>
<p style="text-align: center;"><code class="reqn">H_m = \frac{Q_m}{n} \sqrt{\pi/2};</code>
</p>

<p style="text-align: center;"><code class="reqn">I_m^2 = \frac{Q_m^2 - 2 n^2/\pi}{Q_m^2}.</code>
</p>



<h3>Value</h3>

<p>This function returns a list containing p-values of various heterogeneity tests and various heterogeneity measures with 95% confidence intervals. Specifically, the components include:
</p>
<table>
<tr><td><code>p.Q</code></td>
<td>
<p>p-value of the <code class="reqn">Q</code> statistic (using the resampling method).</p>
</td></tr>
<tr><td><code>p.Q.theo</code></td>
<td>
<p>p-value of the <code class="reqn">Q</code> statistic using the <code class="reqn">Q</code>'s theoretical chi-squared distribution.</p>
</td></tr>
<tr><td><code>p.Qr</code></td>
<td>
<p>p-value of the <code class="reqn">Q_r</code> statistic (using the resampling method).</p>
</td></tr>
<tr><td><code>p.Qm</code></td>
<td>
<p>p-value of the <code class="reqn">Q_m</code> statistic (using the resampling method).</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>the <code class="reqn">Q</code> statistic.</p>
</td></tr>
<tr><td><code>ci.Q</code></td>
<td>
<p>95% CI of the <code class="reqn">Q</code> statistic.</p>
</td></tr>
<tr><td><code>tau2.DL</code></td>
<td>
<p>DerSimonian&ndash;Laird estimate of the between-study variance.</p>
</td></tr>
<tr><td><code>ci.tau2.DL</code></td>
<td>
<p>95% CI of the between-study variance based on the DerSimonian&ndash;Laird method.</p>
</td></tr>
<tr><td><code>H</code></td>
<td>
<p>the <code class="reqn">H</code> statistic.</p>
</td></tr>
<tr><td><code>ci.H</code></td>
<td>
<p>95% CI of the <code class="reqn">H</code> statistic.</p>
</td></tr>
<tr><td><code>I2</code></td>
<td>
<p>the <code class="reqn">I^2</code> statistic.</p>
</td></tr>
<tr><td><code>ci.I2</code></td>
<td>
<p>95% CI of the <code class="reqn">I^2</code> statistic.</p>
</td></tr>
<tr><td><code>Qr</code></td>
<td>
<p>the <code class="reqn">Q_r</code> statistic.</p>
</td></tr>
<tr><td><code>ci.Qr</code></td>
<td>
<p>95% CI of the <code class="reqn">Q_r</code> statistic.</p>
</td></tr>
<tr><td><code>tau2.r</code></td>
<td>
<p>the between-study variance estimate based on the <code class="reqn">Q_r</code> statistic.</p>
</td></tr>
<tr><td><code>ci.tau2.r</code></td>
<td>
<p>95% CI of the between-study variance based on the <code class="reqn">Q_r</code> statistic.</p>
</td></tr>
<tr><td><code>Hr</code></td>
<td>
<p>the <code class="reqn">H_r</code> statistic.</p>
</td></tr>
<tr><td><code>ci.Hr</code></td>
<td>
<p>95% CI of the <code class="reqn">H_r</code> statistic.</p>
</td></tr>
<tr><td><code>Ir2</code></td>
<td>
<p>the <code class="reqn">I_r^2</code> statistic.</p>
</td></tr>
<tr><td><code>ci.Ir2</code></td>
<td>
<p>95% CI of the <code class="reqn">I_r^2</code> statistic.</p>
</td></tr>
<tr><td><code>Qm</code></td>
<td>
<p>the <code class="reqn">Q_m</code> statistic.</p>
</td></tr>
<tr><td><code>ci.Qm</code></td>
<td>
<p>95% CI of the <code class="reqn">Q_m</code> statistic.</p>
</td></tr>
<tr><td><code>tau2.m</code></td>
<td>
<p>the between-study variance estimate based on the <code class="reqn">Q_m</code> statistic.</p>
</td></tr>
<tr><td><code>ci.tau2.m</code></td>
<td>
<p>95% CI of the between-study variance based on the <code class="reqn">Q_m</code> statistic</p>
</td></tr>
<tr><td><code>Hm</code></td>
<td>
<p>the <code class="reqn">H_m</code> statistic.</p>
</td></tr>
<tr><td><code>ci.Hm</code></td>
<td>
<p>95% CI of the <code class="reqn">H_m</code> statistic.</p>
</td></tr>
<tr><td><code>Im2</code></td>
<td>
<p>the <code class="reqn">I_m^2</code> statistic.</p>
</td></tr>
<tr><td><code>ci.Im2</code></td>
<td>
<p>95% CI of the <code class="reqn">I_m^2</code> statistic.</p>
</td></tr>
</table>


<h3>References</h3>

<p>DerSimonian R, Laird N (1986). &quot;Meta-analysis in clinical trials.&quot; <em>Controlled Clinical Trials</em>, <b>7</b>(3), 177&ndash;188. &lt;doi: <a href="https://doi.org/10.1016/0197-2456(86)90046-2">10.1016/0197-2456(86)90046-2</a>&gt;
</p>
<p>Higgins JPT, Thompson SG (2002). &quot;Quantifying heterogeneity in a meta-analysis.&quot; <em>Statistics in Medicine</em>, <b>21</b>(11), 1539&ndash;1558. &lt;doi: <a href="https://doi.org/10.1002/sim.1186">10.1002/sim.1186</a>&gt;
</p>
<p>Higgins JPT, Thompson SG, Deeks JJ, Altman DG (2003). &quot;Measuring inconsistency in meta-analyses.&quot; <em>BMJ</em>, <b>327</b>(7414), 557&ndash;560. &lt;doi: <a href="https://doi.org/10.1136/bmj.327.7414.557">10.1136/bmj.327.7414.557</a>&gt;
</p>
<p>Lin L, Chu H, Hodges JS (2017). &quot;Alternative measures of between-study heterogeneity in meta-analysis: reducing the impact of outlying studies.&quot; <em>Biometrics</em>, <b>73</b>(1), 156&ndash;166. &lt;doi: <a href="https://doi.org/10.1111/biom.12543">10.1111/biom.12543</a>&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dat.aex")
set.seed(1234)
metahet(y, s2, dat.aex, 100)
metahet(y, s2, dat.aex, 1000)

data("dat.hipfrac")
set.seed(1234)
metahet(y, s2, dat.hipfrac, 100)
metahet(y, s2, dat.hipfrac, 1000)
</code></pre>

<hr>
<h2 id='metaoutliers'>
Outlier Detection in Meta-Analysis
</h2><span id='topic+metaoutliers'></span>

<h3>Description</h3>

<p>Calculates the standardized residual for each study in meta-analysis using the methods desribed in Chapter 12 in Hedges and Olkin (1985) and Viechtbauer and Cheung (2010). A study is considered as an outlier if its standardized residual is greater than 3 in absolute magnitude.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metaoutliers(y, s2, data, model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metaoutliers_+3A_y">y</code></td>
<td>

<p>a numeric vector specifying the observed effect sizes in the collected studies; they are assumed to be normally distributed.
</p>
</td></tr>
<tr><td><code id="metaoutliers_+3A_s2">s2</code></td>
<td>

<p>a numeric vector specifying the within-study variances.
</p>
</td></tr>
<tr><td><code id="metaoutliers_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the meta-analysis dataset. If <code>data</code> is specified, the previous arguments, <code>y</code> and <code>s2</code>, should be specified as their corresponding column names in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="metaoutliers_+3A_model">model</code></td>
<td>

<p>a character string specified as either <code>"FE"</code> or <code>"RE"</code>. If <code>model</code> = <code>"FE"</code>, this function uses the outlier detection procedure for the fixed-effect meta-analysis desribed in Chapter 12 in Hedges and Olkin (1985); If <code>model</code> = <code>"RE"</code>, the procedure for the random-effects meta-analysis desribed in Viechtbauer and Cheung (2010) is used. See Details for the two approaches. If the argument <code>model</code> is not specified, this function sets <code>model</code> = <code>"FE"</code> if <code class="reqn">I_r^2 &lt; 30\%</code> and sets <code>model</code> = <code>"RE"</code> if <code class="reqn">I_r^2 \geq 30\%</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that a meta-analysis collects <code class="reqn">n</code> studies. The observed effect size in study <code class="reqn">i</code> is <code class="reqn">y_i</code> and its within-study variance is <code class="reqn">s^{2}_{i}</code>. Also, the inverse-variance weight is <code class="reqn">w_i = 1 / s^{2}_{i}</code>.
</p>
<p>Chapter 12 in Hedges and Olkin (1985) describes the outlier detection procedure for the fixed-effect meta-analysis (<code>model</code> = <code>"FE"</code>). Using the studies except study <code class="reqn">i</code>, the pooled estimate of the overall effect size is <code class="reqn">\bar{\mu}_{(-i)} = \sum_{j \neq i} w_j y_j / \sum_{j \neq i} w_j</code>. The residual of study <code class="reqn">i</code> is <code class="reqn">e_{i} = y_i - \bar{\mu}_{(-i)}</code>. The variance of <code class="reqn">e_{i}</code> is <code class="reqn">v_{i} = s_{i}^{2} + (\sum_{j \neq i} w_{j})^{-1}</code>, so the standardized residual of study <code class="reqn">i</code> is <code class="reqn">\epsilon_{i} = e_{i} / \sqrt{v_{i}}</code>.
</p>
<p>Viechtbauer and Cheung (2010) describes the outlier detection procedure for the random-effects meta-analysis (<code>model</code> = <code>"RE"</code>). Using the studies except study <code class="reqn">i</code>, let the method-of-moments estimate of the between-study variance be <code class="reqn">\hat{\tau}_{(-i)}^{2}</code>. The pooled estimate of the overall effect size is <code class="reqn">\bar{\mu}_{(-i)} = \sum_{j \neq i} \tilde{w}_{(-i)j} y_j / \sum_{j \neq i} \tilde{w}_{(-i)j}</code>, where <code class="reqn">\tilde{w}_{(-i)j} = 1/(s_{j}^{2} + \hat{\tau}_{(-i)}^{2})</code>. The residual of study <code class="reqn">i</code> is <code class="reqn">e_{i} = y_i - \bar{\mu}_{(-i)}</code>, and its variance is <code class="reqn">v_{i} = s_{i}^2 + \hat{\tau}_{(-i)}^{2} + (\sum_{j \neq i} \tilde{w}_{(-i)j})^{-1}</code>. Then, the standardized residual of study <code class="reqn">i</code> is <code class="reqn">\epsilon_{i} = e_{i} / \sqrt{v_{i}}</code>. 
</p>


<h3>Value</h3>

<p>This functions returns a list which contains standardized residuals and identified outliers. A study is considered as an outlier if its standardized residual is greater than 3 in absolute magnitude.
</p>


<h3>References</h3>

<p>Hedges LV, Olkin I (1985). <em>Statistical Method for Meta-Analysis</em>. Academic Press, Orlando, FL.
</p>
<p>Viechtbauer W, Cheung MWL (2010). &quot;Outlier and influence diagnostics for meta-analysis.&quot; <em>Research Synthesis Methods</em>, <b>1</b>(2), 112&ndash;125. &lt;doi: <a href="https://doi.org/10.1002/jrsm.11">10.1002/jrsm.11</a>&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dat.aex")
metaoutliers(y, s2, dat.aex, model = "FE")
metaoutliers(y, s2, dat.aex, model = "RE")

data("dat.hipfrac")
metaoutliers(y, s2, dat.hipfrac)
</code></pre>

<hr>
<h2 id='metapb'>
Detecting and Quantifying Publication Bias/Small-Study Effects
</h2><span id='topic+metapb'></span>

<h3>Description</h3>

<p>Performs the regression test and calculates skewness for detecting and quantifying publication bias/small-study effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metapb(y, s2, data, model = "RE", n.resam = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metapb_+3A_y">y</code></td>
<td>

<p>a numeric vector specifying the observed effect sizes in the collected studies; they are assumed to be normally distributed.
</p>
</td></tr>
<tr><td><code id="metapb_+3A_s2">s2</code></td>
<td>

<p>a numeric vector specifying the within-study variances.
</p>
</td></tr>
<tr><td><code id="metapb_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the meta-analysis dataset. If <code>data</code> is specified, the previous arguments, <code>y</code> and <code>s2</code>, should be specified as their corresponding column names in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="metapb_+3A_model">model</code></td>
<td>

<p>a characher string specifying the fixed-effect (<code>"FE"</code>) or random-effects (<code>"RE"</code>, the default) model. If not specified, this function uses the <code class="reqn">Q</code> statistic to test for heterogeneity: if the p-value is smaller than 0.05, <code>model</code> is set to <code>"RE"</code>; otherwise, <code>model</code> = <code>"FE"</code>.
</p>
</td></tr>
<tr><td><code id="metapb_+3A_n.resam">n.resam</code></td>
<td>

<p>a positive integer specifying the number of resampling iterations.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function derives the measures of publication bias introduced in Lin and Chu (2018).
</p>


<h3>Value</h3>

<p>This function returns a list containing measures of publication bias, their 95% confidence intervals, and p-values. Specifically, the components include:
</p>
<table>
<tr><td><code>n</code></td>
<td>
<p>the number of studies in the meta-analysis.</p>
</td></tr>
<tr><td><code>p.Q</code></td>
<td>
<p>the p-value of the <code class="reqn">Q</code>-test for heterogeneity.</p>
</td></tr>
<tr><td><code>I2</code></td>
<td>
<p>the <code class="reqn">I^2</code> statistic for quantifying heterogeneity.</p>
</td></tr>
<tr><td><code>tau2</code></td>
<td>
<p>the DerSimonian&ndash;Laird estimate of the between-study variance.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the model setting (<code>"FE"</code> or <code>"RE"</code>).</p>
</td></tr>
<tr><td><code>std.dev</code></td>
<td>
<p>the standardized deviates of the studies.</p>
</td></tr>
<tr><td><code>reg.int</code></td>
<td>
<p>the estimate of the regression intercept for quantifying publication bias.</p>
</td></tr>
<tr><td><code>reg.int.ci</code></td>
<td>
<p>the 95% CI of the regression intercept.</p>
</td></tr>
<tr><td><code>reg.int.ci.resam</code></td>
<td>
<p>the 95% CI of the regression intercept based on the resampling method.</p>
</td></tr>
<tr><td><code>reg.pval</code></td>
<td>
<p>the p-value of the regression intercept.</p>
</td></tr>
<tr><td><code>reg.pval</code></td>
<td>
<p>the p-value of the regression intercept based on the resampling method.</p>
</td></tr>
<tr><td><code>skewness</code></td>
<td>
<p>the estimate of the skewness for quantifying publication bias.</p>
</td></tr>
<tr><td><code>skewness.ci</code></td>
<td>
<p>the 95% CI of the skewness.</p>
</td></tr>
<tr><td><code>skewness.ci.resam</code></td>
<td>
<p>the 95% CI of the skewness based on the resampling method.</p>
</td></tr>
<tr><td><code>skewness.pval</code></td>
<td>
<p>the p-value of the skewness.</p>
</td></tr>
<tr><td><code>skewness.pval.resam</code></td>
<td>
<p>the p-value of the skewness based on the resampling method.</p>
</td></tr>
<tr><td><code>combined.pval</code></td>
<td>
<p>the p-value of the combined test that incorporates the regression intercept and the skewness.</p>
</td></tr>
<tr><td><code>combined.pval.resam</code></td>
<td>
<p>the p-value of the combined test that incorporates the regression intercept and the skewness based on the resampling method.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Egger M, Davey Smith G, Schneider M, Minder C (1997). &quot;Bias in meta-analysis detected by a simple, graphical test.&quot; <em>BMJ</em>, <b>315</b>(7109), 629&ndash;634. &lt;doi: <a href="https://doi.org/10.1136/bmj.315.7109.629">10.1136/bmj.315.7109.629</a>&gt;
</p>
<p>Lin L, Chu H (2018). &quot;Quantifying publication bias in meta-analysis.&quot; <em>Biometrics</em>, <b>74</b>(3), 785&ndash;794. &lt;doi: <a href="https://doi.org/10.1111/biom.12817">10.1111/biom.12817</a>&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dat.slf")
set.seed(1234)
metapb(y, s2, dat.slf)

data("dat.ha")
set.seed(1234)
metapb(y, s2, dat.ha)

data("dat.lcj")
set.seed(1234)
metapb(y, s2, dat.lcj)
</code></pre>

<hr>
<h2 id='mvma'>
Multivariate Meta-Analysis
</h2><span id='topic+mvma'></span>

<h3>Description</h3>

<p>Performs a multivariate meta-analysis when the within-study correlations are known.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvma(ys, covs, data, method = "reml", tol = 1e-10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mvma_+3A_ys">ys</code></td>
<td>

<p>an n x p numeric matrix containing the observed effect sizes. The n rows represent studies, and the p columns represent the multivariate endpoints. <code>NA</code> is allowed for missing endpoints.
</p>
</td></tr>
<tr><td><code id="mvma_+3A_covs">covs</code></td>
<td>

<p>a numeric list with length n. Each element is the p x p within-study covariance matrix. <code>NA</code> is allowed for missing endpoints in the covariance matrix.
</p>
</td></tr>
<tr><td><code id="mvma_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the multivariate meta-analysis dataset. If <code>data</code> is specified, the previous arguments, <code>ys</code> and <code>covs</code>, should be specified as their corresponding column names in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="mvma_+3A_method">method</code></td>
<td>

<p>a character string specifying the method for estimating the overall effect sizes. It should be <code>"fe"</code> (fixed-effects model), <code>"ml"</code> (random-effects model using the maximum likelihood method), or <code>"reml"</code> (random-effects model using the restricted maximum likelihood method, the default).
</p>
</td></tr>
<tr><td><code id="mvma_+3A_tol">tol</code></td>
<td>

<p>a small number specifying the convergence tolerance for the estimates by maximizing (restricted) likelihood. The default is <code>1e-10</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose <code class="reqn">n</code> studies are collected in a multivariate meta-analysis on a total of <code class="reqn">p</code> endpoints. Denote the <code class="reqn">p</code>-dimensional vector of effect sizes as <code class="reqn">\boldsymbol{y}_i</code>, and the within-study covariance matrix <code class="reqn">\mathbf{S}_i</code> is assumed to be known. Then, the random-effects model is as follows:
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{y}_i \sim N (\boldsymbol{\mu}_i, \mathbf{S}_i);</code>
</p>

<p style="text-align: center;"><code class="reqn">\boldsymbol{\mu}_i \sim N (\boldsymbol{\mu}, \mathbf{T}).</code>
</p>

<p>Here, <code class="reqn">\boldsymbol{\mu}_i</code> represents the true underlying effect sizes in study <code class="reqn">i</code>, <code class="reqn">\boldsymbol{\mu}</code> represents the overall effect sizes across studies, and <code class="reqn">\mathbf{T}</code> is the between-study covariance matrix due to heterogeneity. By setting <code class="reqn">\mathbf{T} = \mathbf{0}</code>, this model becomes the fixed-effects model.
</p>


<h3>Value</h3>

<p>This function returns a list containing the following elements:
</p>
<table>
<tr><td><code>mu.est</code></td>
<td>
<p>The estimated overall effect sizes of the p endpoints.</p>
</td></tr>
<tr><td><code>Tau.est</code></td>
<td>
<p>The estimated between-study covariance matrix.</p>
</td></tr>
<tr><td><code>mu.cov</code></td>
<td>
<p>The covariance matrix of the estimated overall effect sizes.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The method used to produce the estimates.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Jackson D, Riley R, White IR (2011). &quot;Multivariate meta-analysis: potential and promise.&quot; <em>Statistics in Medicine</em>, <b>30</b>(20), 2481&ndash;2498. &lt;doi: <a href="https://doi.org/10.1002/sim.4172">10.1002/sim.4172</a>&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mvma.bayesian">mvma.bayesian</a></code>, <code><a href="#topic+mvma.hybrid">mvma.hybrid</a></code>, <code><a href="#topic+mvma.hybrid.bayesian">mvma.hybrid.bayesian</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dat.fib")
mvma(ys = y, covs = S, data = dat.fib, method = "fe")

mvma(ys = y, covs = S, data = dat.fib, method = "reml")

</code></pre>

<hr>
<h2 id='mvma.bayesian'>
Bayesian Random-Effects Multivariate Meta-Analysis
</h2><span id='topic+mvma.bayesian'></span>

<h3>Description</h3>

<p>Performs a Bayesian random-effects model for multivariate meta-analysis when the within-study correlations are known.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvma.bayesian(ys, covs, data, n.adapt = 1000, n.chains = 3,
              n.burnin = 10000, n.iter = 10000, n.thin = 1,
              data.name = NULL, traceplot = FALSE, coda = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mvma.bayesian_+3A_ys">ys</code></td>
<td>

<p>an n x p numeric matrix containing the observed effect sizes. The n rows represent studies, and the p columns represent the multivariate endpoints. <code>NA</code> is allowed for missing endpoints.
</p>
</td></tr>
<tr><td><code id="mvma.bayesian_+3A_covs">covs</code></td>
<td>

<p>a numeric list with length n. Each element is the p x p within-study covariance matrix. <code>NA</code> is allowed for missing endpoints in the covariance matrix.
</p>
</td></tr>
<tr><td><code id="mvma.bayesian_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the multivariate meta-analysis dataset. If <code>data</code> is specified, the previous arguments, <code>ys</code> and <code>covs</code>, should be specified as their corresponding column names in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="mvma.bayesian_+3A_n.adapt">n.adapt</code></td>
<td>

<p>the number of iterations for adaptation in the Markov chain Monte Carlo (MCMC) algorithm. The default is 1,000. This argument and the following <code>n.chains</code>, <code>n.burnin</code>, <code>n.iter</code>, and <code>n.thin</code> are passed to the functions in the package <span class="pkg">rjags</span>.
</p>
</td></tr>
<tr><td><code id="mvma.bayesian_+3A_n.chains">n.chains</code></td>
<td>

<p>the number of MCMC chains. The default is 3.
</p>
</td></tr>
<tr><td><code id="mvma.bayesian_+3A_n.burnin">n.burnin</code></td>
<td>

<p>the number of iterations for burn-in period. The default is 10,000.
</p>
</td></tr>
<tr><td><code id="mvma.bayesian_+3A_n.iter">n.iter</code></td>
<td>

<p>the total number of iterations in each MCMC chain after the burn-in period. The default is 10,000.
</p>
</td></tr>
<tr><td><code id="mvma.bayesian_+3A_n.thin">n.thin</code></td>
<td>

<p>a positive integer specifying thinning rate. The default is 1.
</p>
</td></tr>
<tr><td><code id="mvma.bayesian_+3A_data.name">data.name</code></td>
<td>

<p>a character string specifying the data name. This is used in the names of the generated files that contain results. The default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="mvma.bayesian_+3A_traceplot">traceplot</code></td>
<td>

<p>a logical value indicating whether to save trace plots for the overall effect sizes and between-study standard deviations. The default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="mvma.bayesian_+3A_coda">coda</code></td>
<td>

<p>a logical value indicating whether to output MCMC posterior samples. The default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose <code class="reqn">n</code> studies are collected in a multivariate meta-analysis on a total of <code class="reqn">p</code> endpoints. Denote the <code class="reqn">p</code>-dimensional vector of effect sizes as <code class="reqn">\boldsymbol{y}_i</code>, and the within-study covariance matrix <code class="reqn">\mathbf{S}_i</code> is assumed to be known. Then, the random-effects model is as follows:
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{y}_i \sim N (\boldsymbol{\mu}_i, \mathbf{S}_i);</code>
</p>

<p style="text-align: center;"><code class="reqn">\boldsymbol{\mu}_i \sim N (\boldsymbol{\mu}, \mathbf{T}).</code>
</p>

<p>Here, <code class="reqn">\boldsymbol{\mu}_i</code> represents the true underlying effect sizes in study <code class="reqn">i</code>, <code class="reqn">\boldsymbol{\mu}</code> represents the overall effect sizes across studies, and <code class="reqn">\mathbf{T}</code> is the between-study covariance matrix due to heterogeneity.
</p>
<p>The vague priors <code class="reqn">N (0, 10^3)</code> are specified for the fixed effects <code class="reqn">\boldsymbol{\mu}</code>. Also, this function uses the separation strategy to specify vague priors for the variance and correlation components in <code class="reqn">\mathbf{T}</code> (Pinheiro and Bates, 1996); this technique is considered less sensitive to hyperparameters compared to specifying the inverse-Wishart prior (Lu and Ades, 2009; Wei and Higgins, 2013). Specifically, write the between-study covariance matrix as <code class="reqn">\mathbf{T} = \mathbf{D}^{1/2} \mathbf{R} \mathbf{D}^{1/2}</code>, where the diagonal matrix <code class="reqn">\mathbf{D} = diag(\mathbf{T}) = diag(\tau_1^2, \ldots, \tau_p^2)</code> contains the between-study variances, and <code class="reqn">\mathbf{R}</code> is the correlation matrix. Uniform priors <code class="reqn">U (0, 10)</code> are specified for <code class="reqn">\tau_j</code>'s (<code class="reqn">j = 1, \ldots, p</code>). Further, the correlation matrix can be written as <code class="reqn">\mathbf{R} = \mathbf{L} \mathbf{L}^\prime</code>, where <code class="reqn">\mathbf{L} = (L_{ij})</code> is a lower triangular matrix with nonnegative diagonal elements. Also, <code class="reqn">L_{11} = 1</code> and for <code class="reqn">i = 2, \ldots, p</code>, <code class="reqn">L_{ij} = \cos \theta_{i2}</code> if <code class="reqn">j = 1</code>; <code class="reqn">L_{ij} = (\prod_{k = 2}^{j} \sin \theta_{ik}) \cos \theta_{i, j + 1}</code> if <code class="reqn">j = 2, \ldots, i - 1</code>; and <code class="reqn">L_{ij} = \prod_{k = 2}^{i} \sin \theta_{ik}</code> if <code class="reqn">j = i</code>. Here, <code class="reqn">\theta_{ij}</code>'s are angle parameters for <code class="reqn">2 \leq j \leq i \leq p</code>, and <code class="reqn">\theta_{ij} \in (0, \pi)</code>. Uniform priors are specified for the angle parameters: <code class="reqn">\theta_{ij} \sim U (0, \pi)</code>.
</p>


<h3>Value</h3>

<p>This functions produces posterior estimates and Gelman and Rubin's potential scale reduction factor, and it generates several files that contain trace plots (if <code>traceplot</code> = <code>TRUE</code>) and MCMC posterior samples (if <code>coda</code> = <code>TRUE</code>) in users' working directory. In these results, <code>mu</code> represents the overall effect sizes, <code>tau</code> represents the between-study variances, <code>R</code> contains the elements of the correlation matrix, and <code>theta</code> represents the angle parameters (see &quot;Details&quot;).
</p>


<h3>Note</h3>

<p>This function only implements the MCMC algorithm for the random-effects multivariate model, but not the fixed-effects model. Generally, the fixed-effects model can be easily implemented using the function <code><a href="#topic+mvma">mvma</a></code>. However, when using <code><a href="#topic+mvma">mvma</a></code> to fit the random-effects model, a large number of parameters need to be estimated, and the algorithm for maximizing (restricted) likelihood may not converge well. The Bayesian method in this function provides an alternative.
</p>
<p>If a warning &quot;adaptation incomplete&quot; appears, users may increase <code>n.adapt</code>.
</p>


<h3>References</h3>

<p>Gelman A, Rubin DB (1992). &quot;Inference from iterative simulation using multiple sequences.&quot; <em>Statistical Science</em>, <b>7</b>(4), 457&ndash;472. &lt;doi: <a href="https://doi.org/10.1214/ss/1177011136">10.1214/ss/1177011136</a>&gt;
</p>
<p>Jackson D, Riley R, White IR (2011). &quot;Multivariate meta-analysis: potential and promise.&quot; <em>Statistics in Medicine</em>, <b>30</b>(20), 2481&ndash;2498. &lt;doi: <a href="https://doi.org/10.1002/sim.4172">10.1002/sim.4172</a>&gt;
</p>
<p>Lu G, Ades AE (2009). &quot;Modeling between-trial variance structure in mixed treatment comparisons.&quot; <em>Biostatistics</em>, <b>10</b>(4), 792&ndash;805. &lt;doi: <a href="https://doi.org/10.1093/biostatistics/kxp032">10.1093/biostatistics/kxp032</a>&gt;
</p>
<p>Pinheiro JC, Bates DM (1996). &quot;Unconstrained parametrizations for variance-covariance matrices.&quot; <em>Statistics and Computing</em>, <b>6</b>(3), 289&ndash;296. &lt;doi: <a href="https://doi.org/10.1007/BF00140873">10.1007/BF00140873</a>&gt;
</p>
<p>Wei Y, Higgins JPT (2013). &quot;Bayesian multivariate meta-analysis with multiple outcomes.&quot; <em>Statistics in Medicine</em>, <b>32</b>(17), 2911&ndash;2934. &lt;doi: <a href="https://doi.org/10.1002/sim.5745">10.1002/sim.5745</a>&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mvma">mvma</a></code>, <code><a href="#topic+mvma.hybrid">mvma.hybrid</a></code>, <code><a href="#topic+mvma.hybrid.bayesian">mvma.hybrid.bayesian</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("dat.fib")
set.seed(12345)
## increase n.burnin and n.iter for better convergence of MCMC
out &lt;- mvma.bayesian(ys = y, covs = S, data = dat.fib,
  n.adapt = 1000, n.chains = 3, n.burnin = 100, n.iter = 100,
  n.thin = 1, data.name = "Fibrinogen")
out

</code></pre>

<hr>
<h2 id='mvma.hybrid'>
Hybrid Model for Random-Effects Multivariate Meta-Analysis
</h2><span id='topic+mvma.hybrid'></span>

<h3>Description</h3>

<p>Performs a multivariate meta-analysis using the hybrid random-effects model when the within-study correlations are unknown.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvma.hybrid(ys, vars, data, method = "reml", tol = 1e-10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mvma.hybrid_+3A_ys">ys</code></td>
<td>

<p>an n x p numeric matrix containing the observed effect sizes. The n rows represent studies, and the p columns represent the multivariate endpoints. <code>NA</code> is allowed for missing endpoints.
</p>
</td></tr>
<tr><td><code id="mvma.hybrid_+3A_vars">vars</code></td>
<td>

<p>an n x p numeric matrix containing the observed within-study variances. The n rows represent studies, and the p columns represent the multivariate endpoints. <code>NA</code> is allowed for missing endpoints.
</p>
</td></tr>
<tr><td><code id="mvma.hybrid_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the multivariate meta-analysis dataset. If <code>data</code> is specified, the previous arguments, <code>ys</code> and <code>vars</code>, should be specified as their corresponding column names in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="mvma.hybrid_+3A_method">method</code></td>
<td>

<p>a character string specifying the method for estimating the overall effect sizes. It should be <code>"ml"</code> (random-effects model using the maximum likelihood method) or <code>"reml"</code> (random-effects model using the restricted maximum likelihood method, the default).
</p>
</td></tr>
<tr><td><code id="mvma.hybrid_+3A_tol">tol</code></td>
<td>

<p>a small number specifying the convergence tolerance for the estimates by maximizing (restricted) likelihood. The default is <code>1e-10</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose <code class="reqn">n</code> studies are collected in a multivariate meta-analysis on a total of <code class="reqn">p</code> endpoints. Denote the <code class="reqn">p</code>-dimensional vector of effect sizes as <code class="reqn">\boldsymbol{y}_i</code>, and their within-study variances form a diagonal matrix <code class="reqn">\mathbf{D}_i</code>. However, the within-study correlations are unknown. Then, the random-effects hybrid model is as follows (Riley et al., 2008; Lin and Chu, 2018):
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{y}_i \sim N (\boldsymbol{\mu}, (\mathbf{D}_i + \mathbf{T})^{1/2} \mathbf{R} (\mathbf{D}_i + \mathbf{T})^{1/2}),</code>
</p>

<p>where <code class="reqn">\boldsymbol{\mu}</code> represents the overall effect sizes across studies, <code class="reqn">\mathbf{T} = diag(\tau_1^2, \ldots, \tau_p^2)</code> consists of the between-study variances, and <code class="reqn">\mathbf{R}</code> is the marginal correlation matrix. Although the within-study correlations are unknown, this model accounts for both within- and between-study correlations by using the marginal correlation matrix.
</p>


<h3>Value</h3>

<p>This function returns a list containing the following elements:
</p>
<table>
<tr><td><code>mu.est</code></td>
<td>
<p>The estimated overall effect sizes of the p endpoints.</p>
</td></tr>
<tr><td><code>tau2.est</code></td>
<td>
<p>The estimated between-study variances of the p endpoints.</p>
</td></tr>
<tr><td><code>mar.R</code></td>
<td>
<p>The estimated marginal correlation matrix.</p>
</td></tr>
<tr><td><code>mu.cov</code></td>
<td>
<p>The covariance matrix of the estimated overall effect sizes.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The method used to produce the estimates.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The algorithm for maximizing (restricted) likelihood may not converge when the dimension of endpoints is too high or the data are too sparse.
</p>


<h3>References</h3>

<p>Lin L, Chu H (2018), &quot;Bayesian multivariate meta-analysis of multiple factors.&quot; <em>Research Synthesis Methods</em>, <b>9</b>(2), 261&ndash;272. &lt;doi: <a href="https://doi.org/10.1002/jrsm.1293">10.1002/jrsm.1293</a>&gt;
</p>
<p>Riley RD, Thompson JR, Abrams KR (2008), &quot;An alternative model for bivariate random-effects meta-analysis when the within-study correlations are unknown.&quot; <em>Biostatistics</em>, <b>9</b>(1), 172&ndash;186. &lt;doi: <a href="https://doi.org/10.1093/biostatistics/kxm023">10.1093/biostatistics/kxm023</a>&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mvma">mvma</a></code>, <code><a href="#topic+mvma.bayesian">mvma.bayesian</a></code>, <code><a href="#topic+mvma.hybrid.bayesian">mvma.hybrid.bayesian</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("dat.fib")
y &lt;- dat.fib$y
sd &lt;- dat.fib$sd
mvma.hybrid(y = y, vars = sd^2)

</code></pre>

<hr>
<h2 id='mvma.hybrid.bayesian'>
Bayesian Hybrid Model for Random-Effects Multivariate Meta-Analysis
</h2><span id='topic+mvma.hybrid.bayesian'></span>

<h3>Description</h3>

<p>Performs a multivariate meta-analysis using the Bayesian hybrid random-effects model when the within-study correlations are unknown.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvma.hybrid.bayesian(ys, vars, data, n.adapt = 1000, n.chains = 3,
                     n.burnin = 10000, n.iter = 10000, n.thin = 1,
                     data.name = NULL, traceplot = FALSE, coda = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mvma.hybrid.bayesian_+3A_ys">ys</code></td>
<td>

<p>an n x p numeric matrix containing the observed effect sizes. The n rows represent studies, and the p columns represent the multivariate endpoints. <code>NA</code> is allowed for missing endpoints.
</p>
</td></tr>
<tr><td><code id="mvma.hybrid.bayesian_+3A_vars">vars</code></td>
<td>

<p>an n x p numeric matrix containing the observed within-study variances. The n rows represent studies, and the p columns represent the multivariate endpoints. <code>NA</code> is allowed for missing endpoints.
</p>
</td></tr>
<tr><td><code id="mvma.hybrid.bayesian_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the multivariate meta-analysis dataset. If <code>data</code> is specified, the previous arguments, <code>ys</code> and <code>vars</code>, should be specified as their corresponding column names in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="mvma.hybrid.bayesian_+3A_n.adapt">n.adapt</code></td>
<td>

<p>the number of iterations for adaptation in the Markov chain Monte Carlo (MCMC) algorithm. The default is 1,000. This argument and the following <code>n.chains</code>, <code>n.burnin</code>, <code>n.iter</code>, and <code>n.thin</code> are passed to the functions in the package <span class="pkg">rjags</span>.
</p>
</td></tr>
<tr><td><code id="mvma.hybrid.bayesian_+3A_n.chains">n.chains</code></td>
<td>

<p>the number of MCMC chains. The default is 3.
</p>
</td></tr>
<tr><td><code id="mvma.hybrid.bayesian_+3A_n.burnin">n.burnin</code></td>
<td>

<p>the number of iterations for burn-in period. The default is 10,000.
</p>
</td></tr>
<tr><td><code id="mvma.hybrid.bayesian_+3A_n.iter">n.iter</code></td>
<td>

<p>the total number of iterations in each MCMC chain after the burn-in period. The default is 10,000.
</p>
</td></tr>
<tr><td><code id="mvma.hybrid.bayesian_+3A_n.thin">n.thin</code></td>
<td>

<p>a positive integer specifying thinning rate. The default is 1.
</p>
</td></tr>
<tr><td><code id="mvma.hybrid.bayesian_+3A_data.name">data.name</code></td>
<td>

<p>a character string specifying the data name. This is used in the names of the generated files that contain results. The default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="mvma.hybrid.bayesian_+3A_traceplot">traceplot</code></td>
<td>

<p>a logical value indicating whether to save trace plots for the overall effect sizes and between-study standard deviations. The default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="mvma.hybrid.bayesian_+3A_coda">coda</code></td>
<td>

<p>a logical value indicating whether to output MCMC posterior samples. The default is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose <code class="reqn">n</code> studies are collected in a multivariate meta-analysis on a total of <code class="reqn">p</code> endpoints. Denote the <code class="reqn">p</code>-dimensional vector of effect sizes as <code class="reqn">\boldsymbol{y}_i</code>, and their within-study variances form a diagonal matrix <code class="reqn">\mathbf{D}_i</code>. However, the within-study correlations are unknown. Then, the random-effects hybrid model is as follows (Riley et al., 2008; Lin and Chu, 2018):
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{y}_i \sim N (\boldsymbol{\mu}, (\mathbf{D}_i + \mathbf{T})^{1/2} \mathbf{R} (\mathbf{D}_i + \mathbf{T})^{1/2}),</code>
</p>

<p>where <code class="reqn">\boldsymbol{\mu}</code> represents the overall effect sizes across studies, <code class="reqn">\mathbf{T} = diag(\tau_1^2, \ldots, \tau_p^2)</code> consists of the between-study variances, and <code class="reqn">\mathbf{R}</code> is the marginal correlation matrix. Although the within-study correlations are unknown, this model accounts for both within- and between-study correlations by using the marginal correlation matrix.
</p>
<p>Uniform priors <code class="reqn">U (0, 10)</code> are specified for the between-study standard deviations <code class="reqn">\tau_j</code> (<code class="reqn">j = 1, \ldots, p</code>). The correlation matrix can be written as <code class="reqn">\mathbf{R} = \mathbf{L} \mathbf{L}^\prime</code>, where <code class="reqn">\mathbf{L} = (L_{ij})</code> is a lower triangular matrix with nonnegative diagonal elements. Also, <code class="reqn">L_{11} = 1</code> and for <code class="reqn">i = 2, \ldots, p</code>, <code class="reqn">L_{ij} = \cos \theta_{i2}</code> if <code class="reqn">j = 1</code>; <code class="reqn">L_{ij} = (\prod_{k = 2}^{j} \sin \theta_{ik}) \cos \theta_{i, j + 1}</code> if <code class="reqn">j = 2, \ldots, i - 1</code>; and <code class="reqn">L_{ij} = \prod_{k = 2}^{i} \sin \theta_{ik}</code> if <code class="reqn">j = i</code> (Lu and Ades, 2009; Wei and Higgins, 2013). Here, <code class="reqn">\theta_{ij}</code>'s are angle parameters for <code class="reqn">2 \leq j \leq i \leq p</code>, and <code class="reqn">\theta_{ij} \in (0, \pi)</code>. Uniform priors are specified for the angle parameters: <code class="reqn">\theta_{ij} \sim U (0, \pi)</code>.
</p>


<h3>Value</h3>

<p>This functions produces posterior estimates and Gelman and Rubin's potential scale reduction factor, and it generates several files that contain trace plots (if <code>traceplot</code> = <code>TRUE</code>), and MCMC posterior samples (if <code>coda</code> = <code>TRUE</code>) in users' working directory. In these results, <code>mu</code> represents the overall effect sizes, <code>tau</code> represents the between-study variances, <code>R</code> contains the elements of the correlation matrix, and <code>theta</code> represents the angle parameters (see &quot;Details&quot;).
</p>


<h3>References</h3>

<p>Lin L, Chu H (2018), &quot;Bayesian multivariate meta-analysis of multiple factors.&quot; <em>Research Synthesis Methods</em>, <b>9</b>(2), 261&ndash;272. &lt;doi: <a href="https://doi.org/10.1002/jrsm.1293">10.1002/jrsm.1293</a>&gt;
</p>
<p>Lu G, Ades AE (2009). &quot;Modeling between-trial variance structure in mixed treatment comparisons.&quot; <em>Biostatistics</em>, <b>10</b>(4), 792&ndash;805. &lt;doi: <a href="https://doi.org/10.1093/biostatistics/kxp032">10.1093/biostatistics/kxp032</a>&gt;
</p>
<p>Riley RD, Thompson JR, Abrams KR (2008), &quot;An alternative model for bivariate random-effects meta-analysis when the within-study correlations are unknown.&quot; <em>Biostatistics</em>, <b>9</b>(1), 172&ndash;186. &lt;doi: <a href="https://doi.org/10.1093/biostatistics/kxm023">10.1093/biostatistics/kxm023</a>&gt;
</p>
<p>Wei Y, Higgins JPT (2013). &quot;Bayesian multivariate meta-analysis with multiple outcomes.&quot; <em>Statistics in Medicine</em>, <b>32</b>(17), 2911&ndash;2934. &lt;doi: <a href="https://doi.org/10.1002/sim.5745">10.1002/sim.5745</a>&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mvma">mvma</a></code>, <code><a href="#topic+mvma.bayesian">mvma.bayesian</a></code>, <code><a href="#topic+mvma.hybrid">mvma.hybrid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("dat.pte")
set.seed(12345)
## increase n.burnin and n.iter for better convergence of MCMC
out &lt;- mvma.hybrid.bayesian(ys = dat.pte$y, vars = (dat.pte$se)^2,
  n.adapt = 1000, n.chains = 3, n.burnin = 100, n.iter = 100,
  n.thin = 1, data.name = "Pterygium")
out

</code></pre>

<hr>
<h2 id='nma.icdf'>
Evidence Inconsistency Degrees of Freedom in Bayesian Network Meta-Analysis
</h2><span id='topic+nma.icdf'></span>

<h3>Description</h3>

<p>Calculates evidence inconsistency degrees of freedom (ICDF) in Bayesian network meta-analysis with binary outcomes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nma.icdf(sid, tid, r, n, data, type = c("la", "fe", "re"),
         n.adapt = 1000, n.chains = 3, n.burnin = 5000, n.iter = 20000,
         n.thin = 2, traceplot = FALSE, nma.name = NULL, seed = 1234)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nma.icdf_+3A_sid">sid</code></td>
<td>

<p>a vector specifying the study IDs.
</p>
</td></tr>
<tr><td><code id="nma.icdf_+3A_tid">tid</code></td>
<td>

<p>a vector specifying the treatment IDs.
</p>
</td></tr>
<tr><td><code id="nma.icdf_+3A_r">r</code></td>
<td>

<p>a numeric vector specifying the event counts.
</p>
</td></tr>
<tr><td><code id="nma.icdf_+3A_n">n</code></td>
<td>

<p>a numeric vector specifying the sample sizes.
</p>
</td></tr>
<tr><td><code id="nma.icdf_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the network meta-analysis dataset. If <code>data</code> is specified, the previous arguments, <code>sid</code>, <code>tid</code>, <code>r</code>, and <code>n</code>, should be specified as their corresponding column names in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="nma.icdf_+3A_type">type</code></td>
<td>

<p>a character string or a vector of character strings specifying the ICDF measures. It can be chosen from <code>"la"</code> (the Lu&ndash;Ades measure), <code>"fe"</code> (based on fixed-effects models), and <code>"re"</code> (based on random-effects models).
</p>
</td></tr>
<tr><td><code id="nma.icdf_+3A_n.adapt">n.adapt</code></td>
<td>

<p>the number of iterations for adaptation in the Markov chain Monte Carlo (MCMC) algorithm. The default is 1,000. This argument and the following <code>n.chains</code>, <code>n.burnin</code>, <code>n.iter</code>, and <code>n.thin</code> are passed to the functions in the package <span class="pkg">rjags</span>.
</p>
</td></tr>
<tr><td><code id="nma.icdf_+3A_n.chains">n.chains</code></td>
<td>

<p>the number of MCMC chains. The default is 3.
</p>
</td></tr>
<tr><td><code id="nma.icdf_+3A_n.burnin">n.burnin</code></td>
<td>

<p>the number of iterations for burn-in period. The default is 5,000.
</p>
</td></tr>
<tr><td><code id="nma.icdf_+3A_n.iter">n.iter</code></td>
<td>

<p>the total number of iterations in each MCMC chain after the burn-in period. The default is 20,000.
</p>
</td></tr>
<tr><td><code id="nma.icdf_+3A_n.thin">n.thin</code></td>
<td>

<p>a positive integer specifying thinning rate. The default is 2.
</p>
</td></tr>
<tr><td><code id="nma.icdf_+3A_traceplot">traceplot</code></td>
<td>

<p>a logical value indicating whether to generate trace plots of network meta-analysis models for calculating the ICDF measures. It is only used when the argument <code>type</code> includes <code>"fe"</code> and/or <code>"re"</code>.
</p>
</td></tr>
<tr><td><code id="nma.icdf_+3A_nma.name">nma.name</code></td>
<td>

<p>a character string for specifying the name of the network meta-analysis, which will be used in the file names of the trace plots. It is only used when <code>traceplot</code> = <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="nma.icdf_+3A_seed">seed</code></td>
<td>

<p>an integer for specifying the seed of the random number generation for reproducibility during the Markov chain Monte Carlo (MCMC) algorithm for performing Bayesian network meta-analysis models.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Network meta-analysis frequenlty assumes that direct evidence is consistent with indirect evidence, but this consistency assumption may not hold in some cases. One may use the ICDF to assess the potential that a network meta-analysis might suffer from inconsistency. Suppose that a network meta-analysis compares a total of <code class="reqn">K</code> treatments. When it contains two-arm studies only, Lu and Ades (2006) propose to measure the ICDF as
</p>
<p style="text-align: center;"><code class="reqn">ICDF^{LA} = T - K + 1,</code>
</p>

<p>where <code class="reqn">T</code> is the total number of treatment pairs that are directly compared in the treatment network. This measure is interpreted as the number of independent treatment loops. However, it may not be feasibly calculated when the network meta-analysis contains multi-arm studies. Multi-arm studies provide intrinsically consistent evidence and complicate the calculation of the ICDF.
</p>
<p>Alternatively, the ICDF may be measured as the difference between the effective numbers of parameters of the consistency and inconsistency models for network meta-analysis. The consistency model assumes evidence consistency in all treatment loops, and the inconsistency model treats the overall effect sizes of all direct treatment comparisons as separate, unrelated parameters (Dias et al., 2013). The effective number of parameters is frequently used to assess the complexity of Bayesian hierarchical models (Spiegelhalter et al., 2002). The effect measure is the (log) odds ratio in the models used in this function. Let <code class="reqn">p_D^{FE,con}</code> and <code class="reqn">p_D^{FE,incon}</code> be the effective numbers of parameters of the consistency and inconsistency models under the fixed-effects setting, and <code class="reqn">p_D^{RE,con}</code> and <code class="reqn">p_D^{RE,incon}</code> be those under the random-effects setting. The ICDF measures under the fixed-effects and random-effects settings are
</p>
<p style="text-align: center;"><code class="reqn">ICDF^{FE} = p_D^{FE,incon} - p_D^{FE,con};</code>
</p>

<p style="text-align: center;"><code class="reqn">ICDF^{RE} = p_D^{RE,incon} - p_D^{RE,con},</code>
</p>

<p>respectively. See more details in Lin (2020).
</p>


<h3>Value</h3>

<p>This function produces a list containing the following results: a table of the number of arms within studies and the corresponding counts of studies (<code>nstudy.trtarm</code>); the number of multi-arm studies (<code>nstudy.multi</code>); the set of treatments compared in each multi-arm study (<code>multi.trtarm</code>); the Lu&ndash;Ades ICDF measure (<code>icdf.la</code>); the ICDF measure based on the fixed-effects consistency and inconsistency models (<code>icdf.fe</code>); and the ICDF measure based on the random-effects consistency and inconsistency models (<code>icdf.re</code>). The Lu&ndash;Ades ICDF measure is <code>NA</code> (not available) in the presence of multi-arm studies, because multi-arm studies complicate the counting of independent treatment loops in generic network meta-analyses. When <code>traceplot</code> = <code>TRUE</code>, the trace plots will be saved in users' working directory.
</p>


<h3>References</h3>

<p>Dias S, Welton NJ, Sutton AJ, Caldwell DM, Lu G, Ades AE (2013). &quot;Evidence synthesis for decision making 4: inconsistency in networks of evidence based on randomized controlled trials.&quot; <em>Medical Decision Making</em>, <b>33</b>(5), 641&ndash;656. &lt;doi: <a href="https://doi.org/10.1177/0272989X12455847">10.1177/0272989X12455847</a>&gt;
</p>
<p>Lin L (2021). &quot;Evidence inconsistency degrees of freedom in Bayesian network meta-analysis.&quot; <em>Journal of Biopharmaceutical Statistics</em>, <b>31</b>(3), 317&ndash;330. &lt;doi: <a href="https://doi.org/10.1080/10543406.2020.1852247">10.1080/10543406.2020.1852247</a>&gt;
</p>
<p>Lu G, Ades AE (2006). &quot;Assessing evidence inconsistency in mixed treatment comparisons.&quot; <em>Journal of the American Statistical Association</em>, <b>101</b>(474), 447&ndash;459. &lt;doi: <a href="https://doi.org/10.1198/016214505000001302">10.1198/016214505000001302</a>&gt;
</p>
<p>Spiegelhalter DJ, Best NG, Carlin BP, Van Der Linde A (2002). &quot;Bayesian measures of model complexity and fit.&quot; <em>Journal of the Royal Statistical Society, Series B (Statistical Methodology)</em>, <b>64</b>(4), 583&ndash;639. &lt;doi: <a href="https://doi.org/10.1111/1467-9868.00353">10.1111/1467-9868.00353</a>&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("dat.baker")
## increase n.burnin (e.g., to 50000) and n.iter (e.g., to 200000)
##  for better convergence of MCMC
out &lt;- nma.icdf(sid, tid, r, n, data = dat.baker,
  type = c("la", "fe", "re"),
  n.adapt = 1000, n.chains = 3, n.burnin = 500, n.iter = 2000,
  n.thin = 2, traceplot = FALSE, seed = 1234)
out

</code></pre>

<hr>
<h2 id='nma.predrank'>
Predictive P-Score for Treatment Ranking in Bayesian Network Meta-Analysis
</h2><span id='topic+nma.predrank'></span>

<h3>Description</h3>

<p>Calculates the P-score and predictive P-score for a network meta-analysis in the Bayesian framework described in Rosenberger et al. (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nma.predrank(sid, tid, r, n, data, n.adapt = 1000, n.chains = 3, n.burnin = 2000,
             n.iter = 5000, n.thin = 2, lowerbetter = TRUE, pred = TRUE,
             pred.samples = FALSE, trace = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nma.predrank_+3A_sid">sid</code></td>
<td>

<p>a vector specifying the study IDs, from 1 to the number of studies.
</p>
</td></tr>
<tr><td><code id="nma.predrank_+3A_tid">tid</code></td>
<td>

<p>a vector specifying the treatment IDs, from 1 to the number of treatments.
</p>
</td></tr>
<tr><td><code id="nma.predrank_+3A_r">r</code></td>
<td>

<p>a numeric vector specifying the event counts.
</p>
</td></tr>
<tr><td><code id="nma.predrank_+3A_n">n</code></td>
<td>

<p>a numeric vector specifying the sample sizes.
</p>
</td></tr>
<tr><td><code id="nma.predrank_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the network meta-analysis dataset. If <code>data</code> is specified, the previous arguments, <code>sid</code>, <code>tid</code>, <code>r</code>, and <code>n</code>, should be specified as their corresponding column names in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="nma.predrank_+3A_n.adapt">n.adapt</code></td>
<td>

<p>the number of iterations for adaptation in the Markov chain Monte Carlo (MCMC) algorithm. The default is 1,000. This argument and the following <code>n.chains</code>, <code>n.burnin</code>, <code>n.iter</code>, and <code>n.thin</code> are passed to the functions in the package <span class="pkg">rjags</span>.
</p>
</td></tr>
<tr><td><code id="nma.predrank_+3A_n.chains">n.chains</code></td>
<td>

<p>the number of MCMC chains. The default is 3.
</p>
</td></tr>
<tr><td><code id="nma.predrank_+3A_n.burnin">n.burnin</code></td>
<td>

<p>the number of iterations for burn-in period. The default is 2,000.
</p>
</td></tr>
<tr><td><code id="nma.predrank_+3A_n.iter">n.iter</code></td>
<td>

<p>the total number of iterations in each MCMC chain after the burn-in period. The default is 5,000.
</p>
</td></tr>
<tr><td><code id="nma.predrank_+3A_n.thin">n.thin</code></td>
<td>

<p>a positive integer specifying thinning rate. The default is 2.
</p>
</td></tr>
<tr><td><code id="nma.predrank_+3A_lowerbetter">lowerbetter</code></td>
<td>

<p>A logical value indicating whether lower effect measures indicate better treaetments. If <code>lowerbetter</code> = <code>TRUE</code> (the default), then lower effect measures indicate better treatments.
</p>
</td></tr>
<tr><td><code id="nma.predrank_+3A_pred">pred</code></td>
<td>

<p>a logical value indicating whether the treatment ranking measures in a new study are to be derived. These measures are only derived when <code>pred</code> = <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="nma.predrank_+3A_pred.samples">pred.samples</code></td>
<td>

<p>a logical value indicating whether the posterior samples of expected scaled ranks in a new study are to be saved.
</p>
</td></tr>
<tr><td><code id="nma.predrank_+3A_trace">trace</code></td>
<td>

<p>a logical value indicating whether all posterior samples are to be saved.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Under the frequentist setting, the P-score is built on the quantiles
</p>
<p style="text-align: center;"><code class="reqn">P_{kh} = \Phi((\hat{d}_{1k} - \hat{d}_{1h})/s_{kh}),</code>
</p>

<p>where <code class="reqn">\hat{d}_{1k}</code> and <code class="reqn">\hat{d}_{1h}</code> are the point estimates of treatment effects for <code class="reqn">k</code> vs. 1 and <code class="reqn">h</code> vs. 1, respectively, and <code class="reqn">s_{kh}</code> is the standard error of <code class="reqn">\hat{d}_{1k} - \hat{d}_{1h}</code> (Rucker and Schwarzer, 2015). Moreover, <code class="reqn">\Phi(\cdot)</code> is the cumulative distribution function of the standard normal distribution. The quantity <code class="reqn">P_{kh}</code> can be interpreted as the extent of certainty that treatment <code class="reqn">k</code> is better than <code class="reqn">h</code>. The frequentist P-score of treatment <code class="reqn">k</code> is <code class="reqn">\frac{1}{K-1} \sum_{h \neq k} P_{kh}</code>.
</p>
<p>Analogously to the frequentist P-score, conditional on <code class="reqn">d_{1h}</code> and <code class="reqn">d_{1k}</code>, the quantities <code class="reqn">P_{hk}</code> from the Bayesian perspective can be considered as <code class="reqn">I(d_{1k} &gt; d_{1h})</code>, which are Bernoulli random variables. To quantify the overall performance of treatment <code class="reqn">k</code>, we may similarly use
</p>
<p style="text-align: center;"><code class="reqn">\bar{P}_k = \frac{1}{K-1} \sum_{h \neq k} I(d_{1k} &gt; d_{1h}).</code>
</p>

<p>Note that <code class="reqn">\bar{P}_k</code> is a parameter under the Bayesian framework, while the frequentist P-score is a statistic. Moreover, <code class="reqn">\sum_{h \neq k} I(d_{1k} &gt; d_{1h})</code> is equivalent to <code class="reqn">K - R_k</code>, where <code class="reqn">R_k</code> is the true rank of treatment <code class="reqn">k</code>. Thus, we may also write <code class="reqn">\bar{P}_k = (K - R_k)/(K - 1)</code>; this corresponds to the findings by Rucker and Schwarzer (2015). Consequently, we call <code class="reqn">\bar{P}_k</code> the scaled rank in the network meta-analysis (NMA) for treatment <code class="reqn">k</code>. It transforms the range of the original rank between 1 and <code class="reqn">K</code> to a range between 0 and 1. In addition, note that <code class="reqn">E[I(d_{1k} &gt; d_{1h} | Data)] = \Pr(d_{1k} &gt; d_{1h} | Data)</code>, which is analogous to the quantity of <code class="reqn">P_{kh}</code> under the frequentist framework. Therefore, we use the posterior mean of the scaled rank <code class="reqn">\bar{P}_k</code> as the Bayesian P-score; it is a counterpart of the frequentist P-score.
</p>
<p>The scaled ranks <code class="reqn">\bar{P}_k</code> can be feasibly estimated via the MCMC algorithm. Let <code class="reqn">\{d_{1k}^{(j)}; k = 2, \ldots, K\}_{j=1}^J</code> be the posterior samples of the overall relative effects <code class="reqn">d_{1k}</code> of all treatments vs. the reference treatment 1 in a total of <code class="reqn">J</code> MCMC iterations after the burn-in period, where <code class="reqn">j</code> indexes the iterations. As <code class="reqn">d_{11}</code> is trivially 0, we set <code class="reqn">d_{11}^{(j)}</code> to 0 for all <code class="reqn">j</code>. The <code class="reqn">j</code>th posterior sample of treatment <code class="reqn">k</code>'s scaled rank is <code class="reqn">\bar{P}_k^{(j)} = \frac{1}{K-1} \sum_{h \neq k}I(d_{1k}^{(j)} &gt; d_{1h}^{(j)})</code>. We can make inferences for the scaled ranks from the posterior samples <code class="reqn">\{\bar{P}_k^{(j)}\}_{j=1}^{J}</code>, and use their posterior means as the Bayesian P-scores. We may also obtain the posterior medians as another set of point estimates, and the 2.5% and 97.5% posterior quantiles as the lower and upper bounds of 95% credible intervals (CrIs), respectively. Because the posterior samples of the scaled ranks take discrete values, the posterior medians and the CrI bounds are also discrete.
</p>
<p>Based on the idea of the Bayesian P-score, we can similarly define the predictive P-score for a future study by accounting for the heterogeneity between the existing studies in the NMA and the new study. Specifically, we consider the probabilities in the new study
</p>
<p style="text-align: center;"><code class="reqn">P_{new,kh} = \Pr(\delta_{new,1k} &gt; \delta_{new,1h}),</code>
</p>

<p>conditional on the population parameters <code class="reqn">d_{1h}</code>, <code class="reqn">d_{1k}</code>, and <code class="reqn">\tau</code> from the NMA. Here, <code class="reqn">\delta_{new,1k}</code> and <code class="reqn">\delta_{new,1h}</code> represent the treatment effects of <code class="reqn">k</code> vs. 1 and <code class="reqn">h</code> vs. 1 in the new study, respectively. The <code class="reqn">P_{new,kh}</code> corresponds to the quantity <code class="reqn">P_{kh}</code> in the NMA; it represents the probability of treatment <code class="reqn">k</code> being better than <code class="reqn">h</code> in the new study. Due to heterogeneity, <code class="reqn">\delta_{new,1k} \sim N(d_{1k}, \tau^2)</code> and <code class="reqn">\delta_{new,1h} \sim N(d_{1h}, \tau^{2})</code>. The correlation coefficients between treatment comparisons are typically assumed to be 0.5; therefore, such probabilities in the new study can be explicitly calculated as <code class="reqn">P_{new,kh} = \Phi((d_{1k} - d_{1h})/\tau)</code>, which is a function of <code class="reqn">d_{1h}</code>, <code class="reqn">d_{1k}</code>, and <code class="reqn">\tau</code>. Finally, we use
</p>
<p style="text-align: center;"><code class="reqn">\bar{P}_{new,k} = \frac{1}{K-1} \sum_{h \neq k} P_{new,kh}</code>
</p>

<p>to quantify the performance of treatment <code class="reqn">k</code> in the new study. The posterior samples of <code class="reqn">\bar{P}_{new,k}</code> can be derived from the posterior samples of <code class="reqn">d_{1k}</code>, <code class="reqn">d_{1h}</code>, and <code class="reqn">\tau</code> during the MCMC algorithm.
</p>
<p>Note that the probabilities <code class="reqn">P_{new,kh}</code> can be written as <code class="reqn">E[I(\delta_{new,1k} &gt; \delta_{new,1h})]</code>. Based on similar observations for the scaled ranks in the NMA, the <code class="reqn">\bar{P}_{new,k}</code> in the new study subsequently becomes
</p>
<p style="text-align: center;"><code class="reqn">\bar{P}_{new,k} = \frac{1}{K-1} E\left[\sum_{h \neq k} I(\delta_{new,1k} &gt; \delta_{new,1h})\right] = E\left[\frac{K - R_{new,k}}{K - 1}\right],</code>
</p>

<p>where <code class="reqn">R_{new,k}</code> is the true rank of treatment <code class="reqn">k</code> in the new study. Thus, we call <code class="reqn">\bar{P}_{new,k}</code> the expected scaled rank in the new study. Like the Bayesian P-score, we define the predictive P-score as the posterior mean of <code class="reqn">\bar{P}_{new,k}</code>. The posterior medians and 95% CrIs can also be obtained using the MCMC samples of <code class="reqn">\bar{P}_{new,k}</code>. See more details in Rosenberger et al. (2021).
</p>


<h3>Value</h3>

<p>This function estimates the P-score for all treatments in a Bayesian NMA, estimates the predictive P-score (if <code>pred</code> = <code>TRUE</code>), gives the posterior samples of expected scaled ranks in a new study (if <code>pred.samples</code> = <code>TRUE</code>), and outputs all MCMC posterior samples (if <code>trace</code> = <code>TRUE</code>).
</p>


<h3>Author(s)</h3>

<p>Kristine J. Rosenberger, Lifeng Lin 
</p>


<h3>References</h3>

<p>Rosenberger KJ, Duan R, Chen Y, Lin L (2021). &quot;Predictive P-score for treatment ranking in Bayesian network meta-analysis.&quot; <em>BMC Medical Research Methodology</em>, <b>21</b>, 213. &lt;doi: <a href="https://doi.org/10.1186/s12874-021-01397-5">10.1186/s12874-021-01397-5</a>&gt;
</p>
<p>Rucker G, Schwarzer G (2015). &quot;Ranking treatments in frequentist network meta-analysis works without resampling methods.&quot; <em>BMC Medical Research Methodology</em>, <b>15</b>, 58. &lt;doi: <a href="https://doi.org/10.1186/s12874-015-0060-8">10.1186/s12874-015-0060-8</a>&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## increase n.burnin (e.g., to 50000) and n.iter (e.g., to 200000)
## for better convergence of MCMC
data("dat.sc")
set.seed(1234)
out1 &lt;- nma.predrank(sid, tid, r, n, data = dat.sc, n.burnin = 500, n.iter = 2000,
  lowerbetter = FALSE, pred.samples = TRUE)
out1$P.score
out1$P.score.pred

cols &lt;- c("red4", "plum4", "paleturquoise4", "palegreen4")
cols.hist &lt;- adjustcolor(cols, alpha.f = 0.4)
trtnames &lt;- c("1) No contact", "2) Self-help", "3) Individual counseling",
  "4) Group counseling")
brks &lt;- seq(0, 1, 0.01)
hist(out1$P.pred[[1]], breaks = brks, freq = FALSE,
  xlim = c(0, 1), ylim = c(0, 5), col = cols.hist[1], border = cols[1],
  xlab = "Expected scaled rank in a new study", ylab = "Density", main = "")
hist(out1$P.pred[[2]], breaks = brks, freq = FALSE,
  col = cols.hist[2], border = cols[2], add = TRUE)
hist(out1$P.pred[[3]], breaks = brks, freq = FALSE,
  col = cols.hist[3], border = cols[3], add = TRUE)
hist(out1$P.pred[[4]], breaks = brks, freq = FALSE,
  col = cols.hist[4], border = cols[4], add = TRUE)
legend("topright", fill = cols.hist, border = cols, legend = trtnames)


data("dat.xu")
set.seed(1234)
out2 &lt;- nma.predrank(sid, tid, r, n, data = dat.xu, n.burnin = 500, n.iter = 2000)
out2

</code></pre>

<hr>
<h2 id='pb.bayesian.binary'>
Bayesian Method for Assessing Publication Bias/Small-Study Effects in Meta-Analysis of a Binary Outcome
</h2><span id='topic+pb.bayesian.binary'></span>

<h3>Description</h3>

<p>Performs multiple methods introduced in Shi et al. (2020) to assess publication bias/small-study effects under the Bayesian framework in a meta-analysis of (log) odds ratios.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pb.bayesian.binary(n00, n01, n10, n11, p01 = NULL, p11 = NULL, data,
                   sig.level = 0.1,  method = "bay", het = "mul",
                   sd.prior = "unif", n.adapt = 1000, n.chains = 3,
                   n.burnin = 5000, n.iter = 10000, thin = 2,
                   upp.het = 2, phi = 0.5, coda = FALSE,
                   traceplot = FALSE, seed = 1234)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pb.bayesian.binary_+3A_n00">n00</code></td>
<td>

<p>a numeric vector or the corresponding column name in the argument <code>data</code>, specifying the counts of non-events in treatment group 0 in the collected studies.
</p>
</td></tr>
<tr><td><code id="pb.bayesian.binary_+3A_n01">n01</code></td>
<td>

<p>a numeric vector or the corresponding column name in the argument <code>data</code>, specifying the counts of events in treatment group 0 in the collected studies.
</p>
</td></tr>
<tr><td><code id="pb.bayesian.binary_+3A_n10">n10</code></td>
<td>

<p>a numeric vector or the corresponding column name in the argument <code>data</code>, specifying the counts of non-events in treatment group 1 in the collected studies.
</p>
</td></tr>
<tr><td><code id="pb.bayesian.binary_+3A_n11">n11</code></td>
<td>

<p>a numeric vector or the corresponding column name in the argument <code>data</code>, specifying the counts of events in treatment group 1 in the collected studies. 
</p>
</td></tr>
<tr><td><code id="pb.bayesian.binary_+3A_p01">p01</code></td>
<td>

<p>an optional numeric vector specifying true event rates (e.g., from simulations) in the treatment group 0 across studies.
</p>
</td></tr>
<tr><td><code id="pb.bayesian.binary_+3A_p11">p11</code></td>
<td>

<p>an optional numeric vector specifying true event rates (e.g., from simulations) in the treatment group 1 across studies.
</p>
</td></tr>
<tr><td><code id="pb.bayesian.binary_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the meta-analysis dataset. If <code>data</code> is specified, the previous arguments, <code>n00</code>, <code>n01</code>, <code>n10</code>, <code>n11</code>, <code>p01</code> (if any), and <code>p11</code> (if any) should be specified as their corresponding column names in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="pb.bayesian.binary_+3A_sig.level">sig.level</code></td>
<td>

<p>a numeric value specifying the statistical significance level <code class="reqn">\alpha</code> for testing for publication bias. The default is 0.1. It corresponds to <code class="reqn">(1 - \alpha) \times 100\%</code> confidence/credible intervals.
</p>
</td></tr>
<tr><td><code id="pb.bayesian.binary_+3A_method">method</code></td>
<td>

<p>a character string specifying the method for assessing publication bias via Bayesian hierarchical models. It can be one of <code>"bay"</code> (the Bayesian approach proposed in Shi et al., 2020), <code>"reg.bay"</code> (Egger's regression test, see Egger et al., 1997, under the Bayesian framework) and <code>"smoothed.bay"</code> (the regression test based on the smoothed sample variance, see Jin et al., 2014, under the Bayesian framework), where all regression tests are under the random-effects setting. The default is <code>"bay"</code>. 
</p>
</td></tr>
<tr><td><code id="pb.bayesian.binary_+3A_het">het</code></td>
<td>

<p>a character string specifying the type of heterogeneity assumption for the publication bias tests. It can be either <code>"mul"</code> (multiplicative heterogeneity assumption; see Thompson and Sharpe, 1999) or <code>"add"</code> (additive heterogeneity assumption). The default is <code>"mul"</code>.
</p>
</td></tr>
<tr><td><code id="pb.bayesian.binary_+3A_sd.prior">sd.prior</code></td>
<td>

<p>a character string specifying prior distributions for standard deviation parameters. It can be either <code>"unif"</code> (uniform distribution) or <code>"hn"</code> (half-normal distribution). The default is <code>"unif"</code>.
</p>
</td></tr>
<tr><td><code id="pb.bayesian.binary_+3A_n.adapt">n.adapt</code></td>
<td>

<p>the number of iterations for adaptation in the Markov chain Monte Carlo (MCMC) algorithm. The default is 1,000. This argument and the following <code>n.chains</code>, <code>n.burnin</code>, <code>n.iter</code>, and <code>thin</code> are passed to the functions in the package <span class="pkg">rjags</span>.
</p>
</td></tr>
<tr><td><code id="pb.bayesian.binary_+3A_n.chains">n.chains</code></td>
<td>

<p>the number of MCMC chains. The default is 1.
</p>
</td></tr>
<tr><td><code id="pb.bayesian.binary_+3A_n.burnin">n.burnin</code></td>
<td>

<p>the number of iterations for burn-in period. The default is 5,000.
</p>
</td></tr>
<tr><td><code id="pb.bayesian.binary_+3A_n.iter">n.iter</code></td>
<td>

<p>the total number of iterations in each MCMC chain after the burn-in period. The default is 10,000.
</p>
</td></tr>
<tr><td><code id="pb.bayesian.binary_+3A_thin">thin</code></td>
<td>

<p>a positive integer specifying thinning rate. The default is 2.
</p>
</td></tr>
<tr><td><code id="pb.bayesian.binary_+3A_upp.het">upp.het</code></td>
<td>

<p>a positive number for specifying the upper bound of uniform priors for standard deviation parameters (if <code>sd.prior</code> = <code>"unif"</code>). The default is 2.
</p>
</td></tr>
<tr><td><code id="pb.bayesian.binary_+3A_phi">phi</code></td>
<td>

<p>a positive number for specifying the hyper-parameter of half-normal priors for standard deviation parameters (if <code>sd.prior</code> = <code>"hn"</code>). The default is 0.5. 
</p>
</td></tr>
<tr><td><code id="pb.bayesian.binary_+3A_coda">coda</code></td>
<td>

<p>a logical value indicating whether to output MCMC posterior samples. The default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="pb.bayesian.binary_+3A_traceplot">traceplot</code></td>
<td>

<p>a logical value indicating whether to draw trace plots for the regression slopes. The default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="pb.bayesian.binary_+3A_seed">seed</code></td>
<td>

<p>an integer for specifying the seed value for reproducibility.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Bayesian models are specified in Shi et al. (2020). The vague prior N(0, <code class="reqn">10^4</code>) is used for the regression intercept and slope, and the uniform prior U(0, <code>upp.het</code>) and half-normal prior HN(<code>phi</code>) are used for standard deviation parameters. The half-normal priors may be preferred in meta-analyses with rare events or small sample sizes.
</p>


<h3>Value</h3>

<p>This function returns a list containing estimates of regression slopes and their credible intervals with the specified significance level (<code>sig.level</code>) as well as MCMC posterior samples (if <code>coda</code> = <code>TRUE</code>). Each element name in this list is related to a certain publication bias method (e.g., <code>est.bay</code> and <code>ci.bay</code> represent the slope estimate and its credible interval based on the proposed Bayesian method). In addition, trace plots for the regression slope are drawn if <code>traceplot</code> = <code>TRUE</code>. 
</p>


<h3>Note</h3>

<p>The current version does not support other effect measures such as relative risks or risk differences.
</p>


<h3>Author(s)</h3>

<p>Linyu Shi <a href="mailto:ls16d@my.fsu.edu">ls16d@my.fsu.edu</a>
</p>


<h3>References</h3>

<p>Egger M, Davey Smith G, Schneider M, Minder C (1997). &quot;Bias in meta-analysis detected by a simple, graphical test.&quot; <em>BMJ</em>, <b>315</b>(7109), 629&ndash;634. &lt;doi: <a href="https://doi.org/10.1136/bmj.315.7109.629">10.1136/bmj.315.7109.629</a>&gt;
</p>
<p>Jin Z-C, Wu C, Zhou X-H, He J (2014). &quot;A modified regression method to test publication bias in meta-analyses with binary outcomes.&quot; <em>BMC Medical Research Methodology</em>, <b>14</b>, 132. &lt;doi: <a href="https://doi.org/10.1186/1471-2288-14-132">10.1186/1471-2288-14-132</a>&gt;
</p>
<p>Shi L, Chu H, Lin L (2020). &quot;A Bayesian approach to assessing small-study effects in meta-analysis of a binary outcome with controlled false positive rate&quot;. <em>Research Synthesis Methods</em>, <b>11</b>(4), 535&ndash;552. &lt;doi: <a href="https://doi.org/10.1002/jrsm.1415">10.1002/jrsm.1415</a>&gt;
</p>
<p>Thompson SG, Sharp SJ (1999). &quot;Explaining heterogeneity in meta-analysis: a comparison of methods.&quot; <em>Statistics in Medicine</em>, <b>18</b>(20), 2693&ndash;2708. &lt;doi: <a href="https://doi.org/10.1002/(SICI)1097-0258(19991030)18:20%3C2693::AID-SIM235%3E3.0.CO;2-V">10.1002/(SICI)1097-0258(19991030)18:20&lt;2693::AID-SIM235&gt;3.0.CO;2-V</a>&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pb.hybrid.binary">pb.hybrid.binary</a></code>, <code><a href="#topic+pb.hybrid.generic">pb.hybrid.generic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("dat.poole")
set.seed(654321)
## increase n.burnin and n.iter for better convergence of MCMC
rslt.poole &lt;- pb.bayesian.binary(n00, n01, n10, n11, data = dat.poole,
  method = "bay", het = "mul", sd.prior = "unif", n.adapt = 1000,
  n.chains = 3, n.burnin = 500, n.iter = 2000, thin = 2, upp.het = 2)
rslt.poole

data("dat.ducharme")
set.seed(654321)
## increase n.burnin and n.iter for better convergence of MCMC
rslt.ducharme &lt;- pb.bayesian.binary(n00, n01, n10, n11, data = dat.ducharme,
  method = "bay", het = "mul", sd.prior = "unif", n.adapt = 1000,
  n.chains = 3, n.burnin = 500, n.iter = 2000, thin = 2, upp.het = 2)
rslt.ducharme

data("dat.henry")
set.seed(654321)
## increase n.burnin and n.iter for better convergence of MCMC
rslt.henry &lt;- pb.bayesian.binary(n00, n01, n10, n11, data = dat.henry,
  method = "bay", het = "mul", sd.prior = "unif", n.adapt = 1000,
  n.chains = 3, n.burnin = 500, n.iter = 2000, thin = 2, upp.het = 2)
rslt.henry

</code></pre>

<hr>
<h2 id='pb.hybrid.binary'>
Hybrid Test for Publication Bias/Small-Study Effects in Meta-Analysis With Binary Outcomes
</h2><span id='topic+pb.hybrid.binary'></span>

<h3>Description</h3>

<p>Performs the hybrid test for publication bias/small-study effects introduced in Lin (2020), which synthesizes results from multiple popular publication bias tests, in a meta-analysis with binary outcomes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pb.hybrid.binary(n00, n01, n10, n11, data, methods,
                 iter.resam = 1000, theo.pval = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pb.hybrid.binary_+3A_n00">n00</code></td>
<td>

<p>a numeric vector or the corresponding column name in the argument <code>data</code>, specifying the counts of non-events in treatment group 0 in the collected studies.
</p>
</td></tr>
<tr><td><code id="pb.hybrid.binary_+3A_n01">n01</code></td>
<td>

<p>a numeric vector or the corresponding column name in the argument <code>data</code>, specifying the counts of events in treatment group 0 in the collected studies.
</p>
</td></tr>
<tr><td><code id="pb.hybrid.binary_+3A_n10">n10</code></td>
<td>

<p>a numeric vector or the corresponding column name in the argument <code>data</code>, specifying the counts of non-events in treatment group 1 in the collected studies.
</p>
</td></tr>
<tr><td><code id="pb.hybrid.binary_+3A_n11">n11</code></td>
<td>

<p>a numeric vector or the corresponding column name in the argument <code>data</code>, specifying the counts of events in treatment group 1 in the collected studies.
</p>
</td></tr>
<tr><td><code id="pb.hybrid.binary_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the meta-analysis dataset. If <code>data</code> is specified, the previous arguments, <code>n00</code>, <code>n01</code>, <code>n10</code>, and <code>n11</code>, should be specified as their corresponding column names in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="pb.hybrid.binary_+3A_methods">methods</code></td>
<td>

<p>a vector of character strings specifying the publication bias tests to be included in the hybrid test. They can be a subset of <code>"rank"</code> (Begg's rank test; see Begg and Mazumdar, 1994), <code>"reg"</code> (Egger's regression test under the fixed-effect setting; see Egger et al., 1997), <code>"reg.het"</code> (Egger's regression test accounting for additive heterogeneity), <code>"skew"</code> (the skewness-based test under the fixed-effect setting; see Lin and Chu, 2018), <code>"skew.het"</code> (the skewness-based test accounting for additive heterogeneity), <code>"inv.sqrt.n"</code> (the regression test based on sample sizes; see Tang and Liu, 2000), <code>"trimfill"</code> (the trim-and-fill method; see Duval and Tweedie, 2000), <code>"n"</code> (the regressoin test with sample sizes as the predictor; see Macaskill et al., 2001), <code>"inv.n"</code> (the regressoin test with the inverse of sample sizes as the predictor; see Peters et al., 2006), <code>"as.rank"</code> (the rank test based on the arcsine-transformed effect sizes; see Rucker et al., 2008), <code>"as.reg"</code> (the regression test based on the arcsine-transformed effect sizes under the fixed-effect setting), <code>"as.reg.het"</code> (the regression test based on the arcsine-transformed effect sizes accounting for additive heterogeneity), <code>"smoothed"</code> (the regression test based on the smoothed sample variances under the fixed-effect setting; see Jin et al., 2014), <code>"smoothed.het"</code> (the regression test based on the smoothed sample variances accounting for additive heterogeneity), <code>"score"</code> (the regression test based on the score function; see Harbord et al., 2006), and <code>"count"</code> (the test based on the hypergeometric distributions of event counts, designed for sparse data; see Schwarzer et al., 2007). The default is to include all aforementioned tests.
</p>
</td></tr>
<tr><td><code id="pb.hybrid.binary_+3A_iter.resam">iter.resam</code></td>
<td>

<p>a positive integer specifying the number of resampling iterations for calculating the p-value of the hybrid test.
</p>
</td></tr>
<tr><td><code id="pb.hybrid.binary_+3A_theo.pval">theo.pval</code></td>
<td>

<p>a logical value indicating whether additionally calculating the p-values of the tests specified in <code>methods</code> based on the test statistics' theoretical null distributions. Regardless of this argument, the resampling-based p-values are always produced by this function for the tests specified in <code>methods</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The hybrid test statistic is defined as the minimum p-value among the publication bias tests considered in the set specified by the argument <code>methods</code>. Note that the minimum p-value is no longer a genuine p-value because it cannot control the type I error rate. Its p-value needs to be calculated via the resampling approach. See more details in Lin (2020).
</p>


<h3>Value</h3>

<p>This function returns a list containing p-values of the publication bias tests specified in <code>methods</code> as well as the hybrid test. Each element's name in this list has the format of <code>pval.x</code>, where <code>x</code> stands for the character string corresponding to a certain publication bias test, such as <code>rank</code>, <code>reg</code>, <code>skew</code>, etc. The hybrid test's p-value has the name <code>pval.hybrid</code>. If <code>theo.pval</code> = <code>TRUE</code>, additional elements of p-values of the tests in <code>methods</code> based on theorectical null distributions are included in the produced list; their names have the format of <code>pval.x.theo</code>. Another p-value of the hybrid test is also produced based on them; its corresponding element has the name <code>pval.hybrid.theo</code>.
</p>


<h3>References</h3>

<p>Begg CB, Mazumdar M (1994). &quot;Operating characteristics of a rank correlation test for publication bias.&quot; <em>Biometrics</em>, <b>50</b>(4), 1088&ndash;1101. &lt;doi: <a href="https://doi.org/10.2307/2533446">10.2307/2533446</a>&gt;
</p>
<p>Duval S, Tweedie R (2000). &quot;A nonparametric &lsquo;trim and fill&rsquo; method of accounting for publication bias in meta-analysis.&quot; <em>Journal of the American Statistical Association</em>, <b>95</b>(449), 89&ndash;98. &lt;doi: <a href="https://doi.org/10.1080/01621459.2000.10473905">10.1080/01621459.2000.10473905</a>&gt;
</p>
<p>Egger M, Davey Smith G, Schneider M, Minder C (1997). &quot;Bias in meta-analysis detected by a simple, graphical test.&quot; <em>BMJ</em>, <b>315</b>(7109), 629&ndash;634. &lt;doi: <a href="https://doi.org/10.1136/bmj.315.7109.629">10.1136/bmj.315.7109.629</a>&gt;
</p>
<p>Harbord RM, Egger M, Sterne JAC (2006). &quot;A modified test for small-study effects in meta-analyses of controlled trials with binary endpoints.&quot; <em>Statistics in Medicine</em>, <b>25</b>(20), 3443&ndash;3457. &lt;doi: <a href="https://doi.org/10.1002/sim.2380">10.1002/sim.2380</a>&gt;
</p>
<p>Jin Z-C, Wu C, Zhou X-H, He J (2014). &quot;A modified regression method to test publication bias in meta-analyses with binary outcomes.&quot; <em>BMC Medical Research Methodology</em>, <b>14</b>, 132. &lt;doi: <a href="https://doi.org/10.1186/1471-2288-14-132">10.1186/1471-2288-14-132</a>&gt;
</p>
<p>Lin L (2020). &quot;Hybrid test for publication bias in meta-analysis.&quot; <em>Statistical Methods in Medical Research</em>, <b>29</b>(10), 2881&ndash;2899. &lt;doi: <a href="https://doi.org/10.1177/0962280220910172">10.1177/0962280220910172</a>&gt;
</p>
<p>Lin L, Chu H (2018). &quot;Quantifying publication bias in meta-analysis.&quot; <em>Biometrics</em>, <b>74</b>(3), 785&ndash;794. &lt;doi: <a href="https://doi.org/10.1111/biom.12817">10.1111/biom.12817</a>&gt;
</p>
<p>Macaskill P, Walter SD, Irwig L (2001). &quot;A comparison of methods to detect publication bias in meta-analysis.&quot; <em>Statistics in Medicine</em>, <b>20</b>(4), 641&ndash;654. &lt;doi: <a href="https://doi.org/10.1002/sim.698">10.1002/sim.698</a>&gt;
</p>
<p>Peters JL, Sutton AJ, Jones DR, Abrams KR, Rushton L (2006). &quot;Comparison of two methods to detect publication bias in meta-analysis.&quot; <em>JAMA</em>, <b>295</b>(6), 676&ndash;680. &lt;doi: <a href="https://doi.org/10.1001/jama.295.6.676">10.1001/jama.295.6.676</a>&gt;
</p>
<p>Rucker G, Schwarzer G, Carpenter J (2008). &quot;Arcsine test for publication bias in meta-analyses with binary outcomes.&quot; <em>Statistics in Medicine</em>, <b>27</b>(5), 746&ndash;763. &lt;doi: <a href="https://doi.org/10.1002/sim.2971">10.1002/sim.2971</a>&gt;
</p>
<p>Schwarzer G, Antes G, Schumacher M (2007). &quot;A test for publication bias in meta-analysis with sparse binary data.&quot; <em>Statistics in Medicine</em>, <b>26</b>(4), 721&ndash;733. &lt;doi: <a href="https://doi.org/10.1002/sim.2588">10.1002/sim.2588</a>&gt;
</p>
<p>Tang J-L, Liu JLY (2000). &quot;Misleading funnel plot for detection of bias in meta-analysis.&quot; <em>Journal of Clinical Epidemiology</em>, <b>53</b>(5), 477&ndash;484. &lt;doi: <a href="https://doi.org/10.1016/S0895-4356(99)00204-8">10.1016/S0895-4356(99)00204-8</a>&gt;
</p>
<p>Thompson SG, Sharp SJ (1999). &quot;Explaining heterogeneity in meta-analysis: a comparison of methods.&quot; <em>Statistics in Medicine</em>, <b>18</b>(20), 2693&ndash;2708. &lt;doi: <a href="https://doi.org/10.1002/(SICI)1097-0258(19991030)18:20%3C2693::AID-SIM235%3E3.0.CO;2-V">10.1002/(SICI)1097-0258(19991030)18:20&lt;2693::AID-SIM235&gt;3.0.CO;2-V</a>&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pb.bayesian.binary">pb.bayesian.binary</a></code>, <code><a href="#topic+pb.hybrid.generic">pb.hybrid.generic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## meta-analysis of (log) odds ratios
data("dat.whiting")
# based on only 10 resampling iterations
set.seed(1234)
out.whiting &lt;- pb.hybrid.binary(n00 = n00, n01 = n01,
  n10 = n10, n11 = n11, data = dat.whiting, iter.resam = 10)
out.whiting
# increases the number of resampling iterations to 10000,
#  taking longer time
</code></pre>

<hr>
<h2 id='pb.hybrid.generic'>
Hybrid Test for Publication Bias/Small-Study Effects in Meta-Analysis With Generic Outcomes
</h2><span id='topic+pb.hybrid.generic'></span>

<h3>Description</h3>

<p>Performs the hybrid test for publication bias/small-study effects introduced in Lin (2020), which synthesizes results from multiple popular publication bias tests, in a meta-analysis with generic outcomes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pb.hybrid.generic(y, s2, n, data, methods,
                  iter.resam = 1000, theo.pval = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pb.hybrid.generic_+3A_y">y</code></td>
<td>

<p>a numeric vector or the corresponding column name in the argument <code>data</code>, specifying the observed effect sizes in the collected studies.
</p>
</td></tr>
<tr><td><code id="pb.hybrid.generic_+3A_s2">s2</code></td>
<td>

<p>a numeric vector or the corresponding column name in the argument <code>data</code>, specifying the within-study variances.
</p>
</td></tr>
<tr><td><code id="pb.hybrid.generic_+3A_n">n</code></td>
<td>

<p>an optional numeric vector or the corresponding column name in the argument <code>data</code>, specifying the study-specific total sample sizes. This argument is required if the sample-size-based test (<code>"inv.sqrt.n"</code>) is included in <code>method</code>.
</p>
</td></tr>
<tr><td><code id="pb.hybrid.generic_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the meta-analysis dataset. If <code>data</code> is specified, the previous arguments, <code>y</code>, <code>s2</code>, and <code>n</code>, should be specified as their corresponding column names in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="pb.hybrid.generic_+3A_methods">methods</code></td>
<td>

<p>a vector of character strings specifying the publication bias tests to be included in the hybrid test. They can be a subset of <code>"rank"</code> (Begg's rank test; see Begg and Mazumdar, 1994), <code>"reg"</code> (Egger's regression test under the fixed-effect setting; see Egger et al., 1997), <code>"reg.het"</code> (Egger's regression test accounting for additive heterogeneity), <code>"skew"</code> (the skewness-based test under the fixed-effect setting; see Lin and Chu, 2018), <code>"skew.het"</code> (the skewness-based test accounting for additive heterogeneity), <code>"inv.sqrt.n"</code> (the regression test based on sample sizes; see Tang and Liu, 2000), and <code>"trimfill"</code> (the trim-and-fill method; see Duval and Tweedie, 2000). The default is to include all aforementioned tests.
</p>
</td></tr>
<tr><td><code id="pb.hybrid.generic_+3A_iter.resam">iter.resam</code></td>
<td>

<p>a positive integer specifying the number of resampling iterations for calculating the p-value of the hybrid test.
</p>
</td></tr>
<tr><td><code id="pb.hybrid.generic_+3A_theo.pval">theo.pval</code></td>
<td>

<p>a logical value indicating whether additionally calculating the p-values of the tests specified in <code>methods</code> based on the test statistics' theoretical null distributions. Regardless of this argument, the resampling-based p-values are always produced by this function for the tests specified in <code>methods</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The hybrid test statistic is defined as the minimum p-value among the publication bias tests considered in the set specified by the argument <code>methods</code>. Note that the minimum p-value is no longer a genuine p-value because it cannot control the type I error rate. Its p-value needs to be calculated via the resampling approach. See more details in Lin (2020).
</p>


<h3>Value</h3>

<p>This function returns a list containing p-values of the publication bias tests specified in <code>methods</code> as well as the hybrid test. Each element's name in this list has the format of <code>pval.x</code>, where <code>x</code> stands for the character string corresponding to a certain publication bias test, such as <code>rank</code>, <code>reg</code>, <code>skew</code>, etc. The hybrid test's p-value has the name <code>pval.hybrid</code>. If <code>theo.pval</code> = <code>TRUE</code>, additional elements of p-values of the tests in <code>methods</code> based on theorectical null distributions are included in the produced list; their names have the format of <code>pval.x.theo</code>. Another p-value of the hybrid test is also produced based on them; its corresponding element has the name <code>pval.hybrid.theo</code>.
</p>


<h3>References</h3>

<p>Begg CB, Mazumdar M (1994). &quot;Operating characteristics of a rank correlation test for publication bias.&quot; <em>Biometrics</em>, <b>50</b>(4), 1088&ndash;1101. &lt;doi: <a href="https://doi.org/10.2307/2533446">10.2307/2533446</a>&gt;
</p>
<p>Duval S, Tweedie R (2000). &quot;A nonparametric &lsquo;trim and fill&rsquo; method of accounting for publication bias in meta-analysis.&quot; <em>Journal of the American Statistical Association</em>, <b>95</b>(449), 89&ndash;98. &lt;doi: <a href="https://doi.org/10.1080/01621459.2000.10473905">10.1080/01621459.2000.10473905</a>&gt;
</p>
<p>Egger M, Davey Smith G, Schneider M, Minder C (1997). &quot;Bias in meta-analysis detected by a simple, graphical test.&quot; <em>BMJ</em>, <b>315</b>(7109), 629&ndash;634. &lt;doi: <a href="https://doi.org/10.1136/bmj.315.7109.629">10.1136/bmj.315.7109.629</a>&gt;
</p>
<p>Lin L (2020). &quot;Hybrid test for publication bias in meta-analysis.&quot; <em>Statistical Methods in Medical Research</em>, <b>29</b>(10), 2881&ndash;2899. &lt;doi: <a href="https://doi.org/10.1177/0962280220910172">10.1177/0962280220910172</a>&gt;
</p>
<p>Lin L, Chu H (2018). &quot;Quantifying publication bias in meta-analysis.&quot; <em>Biometrics</em>, <b>74</b>(3), 785&ndash;794. &lt;doi: <a href="https://doi.org/10.1111/biom.12817">10.1111/biom.12817</a>&gt;
</p>
<p>Tang J-L, Liu JLY (2000). &quot;Misleading funnel plot for detection of bias in meta-analysis.&quot; <em>Journal of Clinical Epidemiology</em>, <b>53</b>(5), 477&ndash;484. &lt;doi: <a href="https://doi.org/10.1016/S0895-4356(99)00204-8">10.1016/S0895-4356(99)00204-8</a>&gt;
</p>
<p>Thompson SG, Sharp SJ (1999). &quot;Explaining heterogeneity in meta-analysis: a comparison of methods.&quot; <em>Statistics in Medicine</em>, <b>18</b>(20), 2693&ndash;2708. &lt;doi: <a href="https://doi.org/10.1002/(SICI)1097-0258(19991030)18:20%3C2693::AID-SIM235%3E3.0.CO;2-V">10.1002/(SICI)1097-0258(19991030)18:20&lt;2693::AID-SIM235&gt;3.0.CO;2-V</a>&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pb.bayesian.binary">pb.bayesian.binary</a></code>, <code><a href="#topic+pb.hybrid.binary">pb.hybrid.binary</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## meta-analysis of mean differences
data("dat.plourde")
# based on only 10 resampling iterations
set.seed(1234)
out.plourde &lt;- pb.hybrid.generic(y = y, s2 = s2, n = n,
  data = dat.plourde, iter.resam = 10)
out.plourde
# only produces resampling-based p-values
set.seed(1234)
pb.hybrid.generic(y = y, s2 = s2, n = n,
  data = dat.plourde, iter.resam = 10, theo.pval = FALSE)
# increases the number of resampling iterations to 10000,
#  taking longer time

## meta-analysis of standardized mean differences
data("dat.paige")
# based on only 10 resampling iterations
set.seed(1234)
out.paige &lt;- pb.hybrid.generic(y = y, s2 = s2, n = n,
  data = dat.paige, iter.resam = 10)
out.paige
# increases the number of resampling iterations to 10000,
#  taking longer time
</code></pre>

<hr>
<h2 id='plot.meta.dt'>
Plot for Meta-Analysis of Diagnostic Tests
</h2><span id='topic+plot.meta.dt'></span>

<h3>Description</h3>

<p>Visualizes meta-analysis of diagnostic tests by presenting summary results, such as ROC (receiver operating characteristic) curve, overall sensitivity and overall specificity (1 <code class="reqn">-</code> specificity), and their confidence and prediction regions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'meta.dt'
plot(x, add = FALSE, xlab, ylab, alpha,
     studies = TRUE, cex.studies, col.studies, pch.studies,
     roc, col.roc, lty.roc, lwd.roc, weight = FALSE,
     eqline, col.eqline, lty.eqline, lwd.eqline,
     overall = TRUE, cex.overall, col.overall, pch.overall,
     confid = TRUE, col.confid, lty.confid, lwd.confid,
     predict = FALSE, col.predict, lty.predict, lwd.predict, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.meta.dt_+3A_x">x</code></td>
<td>

<p>an object of class <code>"meta.dt"</code> created by the function <code><a href="#topic+meta.dt">meta.dt</a></code>.
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_add">add</code></td>
<td>

<p>a logical value indicating if the plot is added to an already existing plot.
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_xlab">xlab</code></td>
<td>

<p>a label for the x axis; the default is &quot;1 - Specificity&quot;.
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_ylab">ylab</code></td>
<td>

<p>a label for the y axis; the default is &quot;Sensitivity&quot;.
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_alpha">alpha</code></td>
<td>

<p>a numeric value specifying the statistical significance level for the confidence and prediction regions. If not specified, the plot uses the significance level stored in <code>x</code> (i.e., <code>x$alpha</code>).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_studies">studies</code></td>
<td>

<p>a logical value indicating if the individual studies are presented in the plot.
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_cex.studies">cex.studies</code></td>
<td>

<p>the size of points representing individual studies (the default is 1).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_col.studies">col.studies</code></td>
<td>

<p>the color of points representing individual studies (the default is <code>"black"</code>).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_pch.studies">pch.studies</code></td>
<td>

<p>the symbol of points representing individual studies (the default is 1, i.e., circle).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_roc">roc</code></td>
<td>

<p>a logical value indicating if the ROC curve is presented in the plot. The default is <code>TRUE</code> for the summary ROC approach (<code>x$method</code> = <code>"s.roc"</code>) and is <code>FALSE</code> for the bivariate (generalized) linear mixed model (<code>x$method</code> = <code>"biv.lmm"</code> or <code>"biv.glmm"</code>).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_col.roc">col.roc</code></td>
<td>

<p>the color of the ROC curve (the default is <code>"black"</code>).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_lty.roc">lty.roc</code></td>
<td>

<p>the line type of the ROC curve (the default is 1, i.e., solid line).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_lwd.roc">lwd.roc</code></td>
<td>

<p>the line width of the ROC curve (the default is 1).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_weight">weight</code></td>
<td>

<p>a logical value indicating if the weighted (<code>TRUE</code>) or unweighted (<code>FALSE</code>, the default) regression is used for the summary ROC approach (when <code>x$method</code> is <code>"s.roc"</code>).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_eqline">eqline</code></td>
<td>

<p>a logical value indicating if the line of sensitivity equaling to specificity is presented in the plot.
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_col.eqline">col.eqline</code></td>
<td>

<p>the color of the equality line (the default is <code>"black"</code>).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_lty.eqline">lty.eqline</code></td>
<td>

<p>the type of the equality line (the default is 4, i.e., dot-dash line).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_lwd.eqline">lwd.eqline</code></td>
<td>

<p>the width of the equality line (the default is 1).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_overall">overall</code></td>
<td>

<p>a logical value indicating if the overall sensitivity and overall specificity are presented in the plot. This and the following arguments are used for the bivariate (generalized) linear mixed model (<code>x$method</code> = <code>"biv.lmm"</code> or <code>"biv.glmm"</code>).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_cex.overall">cex.overall</code></td>
<td>

<p>the size of the point representing the overall sensitivity and overall specificity  (the default is 1).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_col.overall">col.overall</code></td>
<td>

<p>the color of the point representing the overall sensitivity and overall specificity  (the default is <code>"black"</code>).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_pch.overall">pch.overall</code></td>
<td>

<p>the symbol of the point representing the overall sensitivity and overall specificity  (the default is 15, i.e., filled square).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_confid">confid</code></td>
<td>

<p>a logical value indicating if the confidence region of the overall sensitivity and overall specificity is presented in the plot.
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_col.confid">col.confid</code></td>
<td>

<p>the line color of the confidence region (the default is <code>"black"</code>).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_lty.confid">lty.confid</code></td>
<td>

<p>the line type of the confidence region (the default is 2, i.e., dashed line).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_lwd.confid">lwd.confid</code></td>
<td>

<p>the line width of the confidence region (the default is 1).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_predict">predict</code></td>
<td>

<p>a logical value indicating if the prediction region of the overall sensitivity and overall specificity is presented in the plot.
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_col.predict">col.predict</code></td>
<td>

<p>the line color of the prediction region (the default is <code>"black"</code>).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_lty.predict">lty.predict</code></td>
<td>

<p>the line type of the prediction region (the default is 3, i.e., dotted line).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_lwd.predict">lwd.predict</code></td>
<td>

<p>the line width of the prediction region (the default is 1).
</p>
</td></tr>
<tr><td><code id="plot.meta.dt_+3A_...">...</code></td>
<td>

<p>other arguments that can be passed to the function <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+meta.dt">meta.dt</a></code>, <code><a href="#topic+print.meta.dt">print.meta.dt</a></code>
</p>

<hr>
<h2 id='plot.metaoutliers'>
Standardized Residual Plot for Outliers Diagnostics
</h2><span id='topic+plot.metaoutliers'></span>

<h3>Description</h3>

<p>Draws a plot showing study-specific standardized residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'metaoutliers'
plot(x, xtick.cex = 1, ytick.cex = 0.5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.metaoutliers_+3A_x">x</code></td>
<td>

<p>an object created by the function <code><a href="#topic+metaoutliers">metaoutliers</a></code>.
</p>
</td></tr>
<tr><td><code id="plot.metaoutliers_+3A_xtick.cex">xtick.cex</code></td>
<td>

<p>a numeric value specifying the size of ticks on the x axis.
</p>
</td></tr>
<tr><td><code id="plot.metaoutliers_+3A_ytick.cex">ytick.cex</code></td>
<td>

<p>a numeric value specifying the size of ticks on the y axis.
</p>
</td></tr>
<tr><td><code id="plot.metaoutliers_+3A_...">...</code></td>
<td>

<p>other arguments that can be passed to the function <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+metaoutliers">metaoutliers</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dat.aex")
attach(dat.aex)
out.aex &lt;- metaoutliers(y, s2, model = "FE")
detach(dat.aex)
plot(out.aex)

data("dat.hipfrac")
attach(dat.hipfrac)
out.hipfrac &lt;- metaoutliers(y, s2, model = "RE")
detach(dat.hipfrac)
plot(out.hipfrac)
</code></pre>

<hr>
<h2 id='print.meta.dt'>
Print Method for &quot;meta.dt&quot; Objects
</h2><span id='topic+print.meta.dt'></span>

<h3>Description</h3>

<p>Prints information about a meta-analysis of diagnostic tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'meta.dt'
print(x, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.meta.dt_+3A_x">x</code></td>
<td>

<p>an object of class <code>"meta.dt"</code> produced by the function <code><a href="#topic+meta.dt">meta.dt</a></code>.
</p>
</td></tr>
<tr><td><code id="print.meta.dt_+3A_digits">digits</code></td>
<td>

<p>an integer specifying the number of decimal places to which the printed results should be rounded.
</p>
</td></tr>
<tr><td><code id="print.meta.dt_+3A_...">...</code></td>
<td>

<p>other arguments.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+meta.dt">meta.dt</a></code>, <code><a href="#topic+plot.meta.dt">plot.meta.dt</a></code>
</p>

<hr>
<h2 id='ssfunnel'>
Contour-Enhanced Sample-Size-Based Funnel Plot
</h2><span id='topic+ssfunnel'></span>

<h3>Description</h3>

<p>Generates contour-enhanced sample-size-based funnel plot for a meta-analysis of mean differences, standardized mean differences, (log) odds ratios, (log) relative risks, or risk differences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssfunnel(y, s2, n, data, type, alpha = c(0.1, 0.05, 0.01, 0.001),
         log.ss = FALSE, sigma, p0, xlim, ylim, xlab, ylab,
         cols.contour, col.mostsig, cex.pts, lwd.contour, pch,
         x.legend, y.legend, cex.legend, bg.legend, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssfunnel_+3A_y">y</code></td>
<td>

<p>a numeric vector or the corresponding column name in the argument <code>data</code>, specifying the observed effect sizes in the collected studies.
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_s2">s2</code></td>
<td>

<p>a numeric vector or the corresponding column name in the argument <code>data</code>, specifying the within-study variances.
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_n">n</code></td>
<td>

<p>a numeric vector or the corresponding column name in the argument <code>data</code>, specifying the study-specific total sample sizes.
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the meta-analysis dataset. If <code>data</code> is specified, the previous arguments, <code>y</code>, <code>s2</code>, and <code>n</code>, should be specified as their corresponding column names in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_type">type</code></td>
<td>

<p>a character string specifying the type of effect size, which should be one of <code>"md"</code> (mean difference), <code>"smd"</code> (standardized mean difference), <code>"lor"</code> (log odds ratio), <code>"lrr"</code> (log relative risk), and <code>"rd"</code> (risk difference).
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_alpha">alpha</code></td>
<td>

<p>a numeric vector specifying the significance levels to be presented in the sample-size-based funnel plot.
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_log.ss">log.ss</code></td>
<td>

<p>a logical value indicating whether sample sizes are plotted on a logarithmic scale (<code>TRUE</code>) or not (<code>FALSE</code>, the default).
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_sigma">sigma</code></td>
<td>

<p>a positive numeric value that is required for the mean difference (<code>type</code> = <code>"md"</code>), specifying a rough estimate of the common standard deviation of the samples' continuous outcomes in the two groups across studies. It is not used for other effect size types.
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_p0">p0</code></td>
<td>

<p>an optional numeric value specifying a rough estimate of the common event rate in the control group across studies. It is only used for the (log) odds ratio, (log) relative risk, and risk difference.
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_xlim">xlim</code></td>
<td>

<p>the x limits <code>c(x1, x2)</code> of the plot.
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_ylim">ylim</code></td>
<td>

<p>the y limits <code>c(y1, y2)</code> of the plot.
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_xlab">xlab</code></td>
<td>

<p>a label for the x axis.
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_ylab">ylab</code></td>
<td>

<p>a label for the y axis.
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_cols.contour">cols.contour</code></td>
<td>

<p>a vector of character strings; they indicate colors of the contours to be presented in the sample-size-based funnel plot, and correspond to the significance levels specified in the argument <code>alpha</code>.
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_col.mostsig">col.mostsig</code></td>
<td>

<p>a character string specifying the color for the most significant result among the studies in the meta-analysis.
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_cex.pts">cex.pts</code></td>
<td>

<p>the size of the points.
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_lwd.contour">lwd.contour</code></td>
<td>

<p>the width of the contours.
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_pch">pch</code></td>
<td>

<p>the symbol of the points.
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_x.legend">x.legend</code></td>
<td>

<p>the x co-ordinate or a keyword, such as <code>"topleft"</code> (the default), to be used to position the legend. It is passed to <code><a href="graphics.html#topic+legend">legend</a></code>.
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_y.legend">y.legend</code></td>
<td>

<p>the y co-ordinate to be used to position the legend (the default is <code>NULL</code>).
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_cex.legend">cex.legend</code></td>
<td>

<p>the size of legend text.
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_bg.legend">bg.legend</code></td>
<td>

<p>the background color for the legend box.
</p>
</td></tr>
<tr><td><code id="ssfunnel_+3A_...">...</code></td>
<td>

<p>other arguments that can be passed to <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A contour-enhanced sample-size-based funnel plot is generated; it presents study-specific total sample sizes against the corresponding effect size estimates. It is helpful to avoid the confounding effect caused by the intrinsic association between effect size estimates and standard errors in the conventional standard-error-based funnel plot. See details of the derivations of the contours in Lin (2019).
</p>


<h3>Value</h3>

<p>None.
</p>


<h3>References</h3>

<p>Lin L (2019). &quot;Graphical augmentations to sample-size-based funnel plot in meta-analysis.&quot; <em>Research Synthesis Methods</em>, <b>10</b>(3), 376&ndash;388. &lt;doi: <a href="https://doi.org/10.1002/jrsm.1340">10.1002/jrsm.1340</a>&gt;
</p>
<p>Peters JL, Sutton AJ, Jones DR, Abrams KR, Rushton L (2006). &quot;Comparison of two methods to detect publication bias in meta-analysis.&quot; <em>JAMA</em>, <b>295</b>(6), 676&ndash;680. &lt;doi: <a href="https://doi.org/10.1001/jama.295.6.676">10.1001/jama.295.6.676</a>&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## mean difference
data("dat.annane")
# descriptive statistics for sigma (continuous outcomes' standard deviation)
quantile(sqrt(dat.annane$s2/(1/dat.annane$n1 + 1/dat.annane$n2)),
  probs = c(0, 0.25, 0.5, 0.75, 1))
# based on sigma = 8
ssfunnel(y, s2, n, data = dat.annane, type = "md",
  alpha = c(0.1, 0.05, 0.01, 0.001), sigma = 8)
# sample sizes presented on a logarithmic scale with plot title
ssfunnel(y, s2, n, data = dat.annane, type = "md",
  alpha = c(0.1, 0.05, 0.01, 0.001), sigma = 8, log.ss = TRUE,
  main = "Contour-enhanced sample-size-based funnel plot")
# based on sigma = 17, with specified x and y limits
ssfunnel(y, s2, n, data = dat.annane, type = "md",
  xlim = c(-15, 15), ylim = c(30, 500),
  alpha = c(0.1, 0.05, 0.01, 0.001), sigma = 17, log.ss = TRUE)
# based on sigma = 20
ssfunnel(y, s2, n, data = dat.annane, type = "md",
  xlim = c(-15, 15), ylim = c(30, 500),
  alpha = c(0.1, 0.05, 0.01, 0.001), sigma = 20, log.ss = TRUE)

## standardized mean difference
data("dat.barlow")
ssfunnel(y, s2, n, data = dat.barlow, type = "smd",
  alpha = c(0.1, 0.05, 0.01, 0.001), xlim = c(-1.5, 1))

## log odds ratio
data("dat.butters")
ssfunnel(y, s2, n, data = dat.butters, type = "lor",
  alpha = c(0.1, 0.05, 0.01, 0.001), xlim = c(-1.5, 1.5))
# use different colors for contours
ssfunnel(y, s2, n, data = dat.butters, type = "lor",
  alpha = c(0.1, 0.05, 0.01, 0.001), xlim = c(-1.5, 1.5),
  cols.contour = c("blue", "green", "yellow", "red"), col.mostsig = "black")
# based on p0 = 0.3 (common event rate in the control group across studies)
ssfunnel(y, s2, n, data = dat.butters, type = "lor",
  alpha = c(0.1, 0.05, 0.01, 0.001), xlim = c(-1.5, 1.5), p0 = 0.3)
# based on p0 = 0.5
ssfunnel(y, s2, n, data = dat.butters, type = "lor",
  alpha = c(0.1, 0.05, 0.01, 0.001), xlim = c(-1.5, 1.5), p0 = 0.5)

## log relative risk
data("dat.williams")
ssfunnel(y, s2, n, data = dat.williams, type = "lrr",
  alpha = c(0.1, 0.05, 0.01, 0.001), xlim = c(-1.5, 2.5))
# based on p0 = 0.2
ssfunnel(y, s2, n, data = dat.williams, type = "lrr",
  alpha = c(0.1, 0.05, 0.01, 0.001), p0 = 0.2, xlim = c(-1.5, 2.5))
# based on p0 = 0.3
ssfunnel(y, s2, n, data = dat.williams, type = "lrr",
  alpha = c(0.1, 0.05, 0.01, 0.001), p0 = 0.3, xlim = c(-1.5, 2.5))

## risk difference
data("dat.kaner")
ssfunnel(y, s2, n, data = dat.kaner, type = "rd",
  alpha = c(0.1, 0.05, 0.01, 0.001), xlim = c(-0.5, 0.5))
# based on p0 = 0.1
ssfunnel(y, s2, n, data = dat.kaner, type = "rd",
  alpha = c(0.1, 0.05, 0.01, 0.001), p0 = 0.1, xlim = c(-0.5, 0.5))
# based on p0 = 0.4
ssfunnel(y, s2, n, data = dat.kaner, type = "rd",
  alpha = c(0.1, 0.05, 0.01, 0.001), p0 = 0.4, xlim = c(-0.5, 0.5))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
