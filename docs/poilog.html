<!DOCTYPE html><html><head><title>Help for package poilog</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {poilog}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#poilog-package'>
<p>Poisson lognormal and bivariate Poisson lognormal distribution</p></a></li>
<li><a href='#Bivariate Poisson lognormal'><p> Bivariate Poisson Lognormal Distribution</p></a></li>
<li><a href='#MLE for bivariate Poisson lognormal distribution'><p> Maximum Likelihood Estimation for Bivariate Poisson Lognormal Distribution</p></a></li>
<li><a href='#MLE for Poisson lognormal distribution'><p> Maximum Likelihood Estimation for Poisson Lognormal Distribution</p></a></li>
<li><a href='#Poisson lognormal'><p> Poisson lognormal distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Poisson Lognormal and Bivariate Poisson Lognormal Distribution</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-10-07</td>
</tr>
<tr>
<td>Author:</td>
<td>Vidar Grotan and Steinar Engen</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Vidar Grotan &lt;vidar.grotan@ntnu.no&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for obtaining the density, random deviates 
             and maximum likelihood estimates of the Poisson lognormal 
             distribution and the bivariate Poisson lognormal distribution.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-12 15:44:22 UTC; vidargr</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-13 08:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='poilog-package'>
Poisson lognormal and bivariate Poisson lognormal distribution
</h2><span id='topic+poilog-package'></span><span id='topic+poilog'></span>

<h3>Description</h3>

<p>Functions for obtaining the density, random deviates and maximum likelihood 
estimates of the Poisson lognormal distribution and the bivariate Poisson 
lognormal distribution.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> poilog</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.4.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2022-10-07</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><code><a href="#topic+dpoilog">dpoilog</a></code> returns the density, <code><a href="#topic+rpoilog">rpoilog</a></code> returns random 
deviates and <code><a href="#topic+poilogMLE">poilogMLE</a></code> performs maximum likelihood estimation of
parameters for the Poisson lognormal distribution.
</p>
<p><code><a href="#topic+dbipoilog">dbipoilog</a></code> returns the density, <code><a href="#topic+rbipoilog">rbipoilog</a></code> returns random 
deviates and <code><a href="#topic+bipoilogMLE">bipoilogMLE</a></code> performs maximum likelihood estimation of
parameters for the bivariate Poisson lognormal distribution.
</p>


<h3>Author(s)</h3>

<p>Vidar Grotan and Steinar Engen
</p>
<p>Maintainer: 
Vidar Grotan <a href="mailto:vidar.grotan@ntnu.no">vidar.grotan@ntnu.no</a>
</p>


<h3>References</h3>

<p>Bulmer, M. G. 1974. On fitting the Poisson lognormal distribution to species abundance data. Biometrics <b>30</b>, 651-660.<br />
Engen, S., R. Lande, T. Walla and P. J. DeVries. 2002. Analyzing spatial structure of communities using the two-dimensional 
Poisson lognormal species abundance model. American Naturalist <b>160</b>, 60-73.
</p>

<hr>
<h2 id='Bivariate+20Poisson+20lognormal'> Bivariate Poisson Lognormal Distribution </h2><span id='topic+dbipoilog'></span><span id='topic+rbipoilog'></span>

<h3>Description</h3>

<p>Density and random generation for the for the bivariate Poisson 
lognormal distribution with parameters <code>mu1</code>, <code>mu2</code>, 
<code>sig1</code>, <code>sig2</code> and <code>rho</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbipoilog(n1, n2, mu1, mu2, sig1, sig2, rho)
rbipoilog(S, mu1, mu2, sig1, sig2, rho, nu1=1, nu2=1, 
          condS=FALSE, keep0=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Bivariate+2B20Poisson+2B20lognormal_+3A_n1">n1</code></td>
<td>
<p> vector of observed individuals for each species in sample 1</p>
</td></tr>
<tr><td><code id="Bivariate+2B20Poisson+2B20lognormal_+3A_n2">n2</code></td>
<td>
<p> vector of observed individuals for each species in sample 2 <br />(in the same order as in sample 1) </p>
</td></tr>
<tr><td><code id="Bivariate+2B20Poisson+2B20lognormal_+3A_mu1">mu1</code></td>
<td>
<p> mean of lognormal distribution in sample 1 </p>
</td></tr>
<tr><td><code id="Bivariate+2B20Poisson+2B20lognormal_+3A_mu2">mu2</code></td>
<td>
<p> mean of lognormal distribution in sample 1 </p>
</td></tr>
<tr><td><code id="Bivariate+2B20Poisson+2B20lognormal_+3A_sig1">sig1</code></td>
<td>
<p> standard deviation of lognormal distribution in sample 1 </p>
</td></tr>
<tr><td><code id="Bivariate+2B20Poisson+2B20lognormal_+3A_sig2">sig2</code></td>
<td>
<p> standard deviation of lognormal distribution in sample 2 </p>
</td></tr>
<tr><td><code id="Bivariate+2B20Poisson+2B20lognormal_+3A_rho">rho</code></td>
<td>
<p> correlation among samples </p>
</td></tr>
<tr><td><code id="Bivariate+2B20Poisson+2B20lognormal_+3A_s">S</code></td>
<td>
<p> Total number of species in both communities </p>
</td></tr>
<tr><td><code id="Bivariate+2B20Poisson+2B20lognormal_+3A_nu1">nu1</code></td>
<td>
<p> sampling intensity sample 1 </p>
</td></tr>
<tr><td><code id="Bivariate+2B20Poisson+2B20lognormal_+3A_nu2">nu2</code></td>
<td>
<p> sampling intensity sample 2 </p>
</td></tr>
<tr><td><code id="Bivariate+2B20Poisson+2B20lognormal_+3A_conds">condS</code></td>
<td>
<p> logical; if TRUE random deviates are conditional on S </p>
</td></tr>
<tr><td><code id="Bivariate+2B20Poisson+2B20lognormal_+3A_keep0">keep0</code></td>
<td>
<p> logical; if TRUE species with count 0 in both communities are included in the random deviates </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following is written from the perspective of using the Poisson lognormal distribution 
to describe community structure (the distribution of species when sampling individuals 
from a community of several species).
</p>
<p>The following assumes knowledge of the <b>Details</b> section of <code><a href="#topic+dpoilog">dpoilog</a></code>.
</p>
<p>Consider two communities jointly and assume that the log abundances among species have the binormal distribution
with parameters (<code>mu1</code>,<code>sig1</code>,<code>mu2</code>,<code>sig2</code>,<code>rho</code>). If sampling intensities are 
<code>nu1</code> = <code>nu2</code> = 1, samples from the communities will have the bivariate Poisson lognormal distribution
</p>
<p style="text-align: center;"><code class="reqn"> P(N_1 = \code{n1}, N_2 = \code{n2}; \;\code{mu1},\code{sig1},\code{mu2},\code{sig2},\code{rho}) = </code>
</p>

<p style="text-align: center;"><code class="reqn"> q(\code{n1},\code{n2};\;\code{mu1},\code{sig1},\code{mu2},\code{sig2},\code{rho}) = </code>
</p>

<p style="text-align: center;"><code class="reqn">\int\limits_{-\infty}^{\infty}\int\limits_{-\infty}^{\infty} g_{\code{n1}}(\code{mu1,sig1},u) g_{\code{n2}}(\code{mu2,sig2},v)\,\phi(u,v;\code{rho})\,du dv,</code>
</p>

<p>where <code class="reqn">\phi(u,v; \code{rho})</code> here denotes the binormal distribution with zero means, unit variances and correlation <code>rho</code>.
In the general case with sampling intensities <code>nu1</code> and <code>nu2</code>, <code>mu1</code> and <code>mu2</code> should be replaced by 
<code>mu1</code> + ln <code>nu1</code> and <code>mu2</code> + ln <code>nu2</code> respectively. In this case, some species will be missing from both samples.
The number of individuals for observed species will then have the truncated distribution
</p>
<p style="text-align: center;"><code class="reqn">\frac{q(\code{n1},\code{n2};\;\code{mu1},\code{sig1},\code{mu2},\code{sig2},\code{rho})}{1-q(0,0;\;\code{mu1},\code{sig1},\code{mu2},\code{sig2},\code{rho})}</code>
</p>



<h3>Value</h3>

<p><code>dbipoilog</code> returns the density<br />
<code>rbipoilog</code> returns random deviates
</p>


<h3>Author(s)</h3>

<p> Vidar Grotan <a href="mailto:vidar.grotan@ntnu.no">vidar.grotan@ntnu.no</a> and Steinar Engen   </p>


<h3>References</h3>

<p> Engen, S., R. Lande, T. Walla and P. J. DeVries. 2002. Analyzing spatial structure of communities using the two-dimensional 
Poisson lognormal species abundance model. American Naturalist <b>160</b>, 60-73. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+bipoilogMLE">bipoilogMLE</a></code> for maximum likelihood estimation </p>


<h3>Examples</h3>

<pre><code class='language-R'>
### change in density of n2 for two different values of rho (given n1=10)   
barplot(rbind(dbipoilog(n1=rep(10,21),n2=0:20,mu1=0,mu2=0,sig=1,sig2=1,rho=0.0),
              dbipoilog(n1=rep(10,21),n2=0:20,mu1=0,mu2=0,sig=1,sig2=1,rho=0.8)),
              beside=TRUE,space=c(0,0.2),names.arg=0:20,xlab="n2",col=1:2)
legend(35,0.0012,c("rho=0","rho=0.8"),fill=1:2)


### draw random deviates from a community of 50 species 
rbipoilog(S=50,mu1=0,mu2=0,sig1=1,sig2=2,rho=0.7)

### draw random deviates including zeros
rbipoilog(S=50,mu1=0,mu2=0,sig1=1,sig2=2,rho=0.7,keep0=TRUE)

### draw random deviates with sampling intensities nu1=0.5 and nu2=0.7 
rbipoilog(S=50,mu1=0,mu2=0,sig1=1,sig2=2,rho=0.7,nu1=0.5,nu2=0.7)

### draw random deviates conditioned on a certain number of species 
rbipoilog(S=50,mu1=0,mu2=0,sig1=1,sig2=2,rho=0.7,nu1=0.5,nu2=0.7,condS=TRUE)


### how many species are likely to be observed in at least one of the samples
### (given S,mu1,mu2,sig1,sig2,rho)? 
hist(replicate(1000,nrow(rbipoilog(S=50,mu1=0,mu2=0,sig1=1,sig2=2,rho=0.7))),
     main="", xlab = "Number of species observed in at least one of the samples")

### how many individuals are likely to be observed 
### (given S,mu1,mu2,sig1,sig2,rho)? 
hist(replicate(1000,sum(rbipoilog(S=50,mu1=0,mu2=0,sig1=1,sig2=2,rho=0.7))),
     main="", xlab="sum nr of individuals in both samples")
</code></pre>

<hr>
<h2 id='MLE+20for+20bivariate+20Poisson+20lognormal+20distribution'> Maximum Likelihood Estimation for Bivariate Poisson Lognormal Distribution </h2><span id='topic+bipoilogMLE'></span>

<h3>Description</h3>

<p><code>bipoilogMLE</code> fits the bivariate Poisson lognormal distribution to data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bipoilogMLE(n1, n2 = NULL, 
            startVals = c(mu1=1, mu2=1, sig1=2, sig2=2, rho=0.5), 
            nboot = 0, zTrunc = TRUE, file = NULL, 
            method = "BFGS", control = list(maxit=1000))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MLE+2B20for+2B20bivariate+2B20Poisson+2B20lognormal+2B20distribution_+3A_n1">n1</code></td>
<td>
<p> a vector or a matrix with two columns of pairwise counts of observed individuals for each species </p>
</td></tr>
<tr><td><code id="MLE+2B20for+2B20bivariate+2B20Poisson+2B20lognormal+2B20distribution_+3A_n2">n2</code></td>
<td>
<p> if n1 is not given as a matrix, a vector of counts with same ordering of species as in argument n1</p>
</td></tr>
<tr><td><code id="MLE+2B20for+2B20bivariate+2B20Poisson+2B20lognormal+2B20distribution_+3A_startvals">startVals</code></td>
<td>
<p> starting values of parameters </p>
</td></tr>
<tr><td><code id="MLE+2B20for+2B20bivariate+2B20Poisson+2B20lognormal+2B20distribution_+3A_nboot">nboot</code></td>
<td>
<p> number of parametric bootstraps, defaults to zero </p>
</td></tr>
<tr><td><code id="MLE+2B20for+2B20bivariate+2B20Poisson+2B20lognormal+2B20distribution_+3A_ztrunc">zTrunc</code></td>
<td>
<p> logical; if TRUE (default) the zero-truncated distribution is fitted </p>
</td></tr>
<tr><td><code id="MLE+2B20for+2B20bivariate+2B20Poisson+2B20lognormal+2B20distribution_+3A_file">file</code></td>
<td>
<p> text file to hold copies of bootstrap estimates </p>
</td></tr>
<tr><td><code id="MLE+2B20for+2B20bivariate+2B20Poisson+2B20lognormal+2B20distribution_+3A_method">method</code></td>
<td>
<p> method to use during optimization, see details </p>
</td></tr>
<tr><td><code id="MLE+2B20for+2B20bivariate+2B20Poisson+2B20lognormal+2B20distribution_+3A_control">control</code></td>
<td>
<p> a list of control parameters for the optimization routine, see details </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function estimates the parameters <code>mu1</code>, <code>sig1</code>, <code>mu2</code>, <code>sig2</code> and <code>rho</code>. 
In cases of incomplete sampling the estimates of <code>mu1</code> and <code>mu2</code> will be confounded with the sampling
intensities (see <code><a href="#topic+rbipoilog">rbipoilog</a></code>). Assuming sampling intensities <code class="reqn">\nu_1</code> and <code class="reqn">\nu_2</code>, 
the estimates of the means are <code class="reqn">\code{mu1}+\ln \nu_1</code> and <code class="reqn">\code{mu2}+\ln\nu_2</code>. Parameters
<code>sig1</code>, <code>sig2</code> and <code>rho</code> can be estimated without any knowledge of sampling intensities.
The parameters must be given starting values for the optimization procedure (default starting values are 
used if starting values are not specified in the function call).
</p>
<p>A zero-truncated distribution (see <code><a href="#topic+dbipoilog">dbipoilog</a></code>) is assumed by default (<code>zTrunc = TRUE</code>).
In cases where the number of zeros is known the <code>zTrunc</code> argument should be set to <code>FALSE</code>.
</p>
<p>The function uses the optimization procedures in <code><a href="stats.html#topic+optim">optim</a></code> to obtain the maximum likelihood estimate.
The <code>method</code> and <code>control</code> arguments are passed to <code><a href="stats.html#topic+optim">optim</a></code>, see the help page for this 
function for additional methods and control parameters.
</p>
<p>The approximate fraction of species revealed by each sample is estimated as 1 minus the zero term of the 
univariate Poisson lognormal distribution: <code class="reqn">1-q(0;\code{mu1},\code{sig1})</code> and <code class="reqn">1-q(0;\code{mu2},\code{sig2})</code>.
</p>
<p>Parametric bootstrapping could be time consuming for large data sets. If argument <code>file</code> is specified, e.g. 
<code>file =</code>&lsquo;<code>C:\\myboots.txt</code>&rsquo;, the matrix with bootstrap estimates are copied into a tab-separated text-file 
providing extra backup. Bootstrapping is done by simulating new sets of observations conditioned on the observed number of 
species (see <code><a href="#topic+rbipoilog">rbipoilog</a></code>).
</p>


<h3>Value</h3>

<table>
<tr><td><code>par</code></td>
<td>
<p>Maximum likelihood estimates of the parameters</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Approximate fraction of species revealed by the samples for sample 1 and 2 respectively</p>
</td></tr>
<tr><td><code>logLval</code></td>
<td>
<p>Log likelihood of the data given the estimated parameters</p>
</td></tr>
<tr><td><code>gof</code></td>
<td>
<p>Goodness of fit measure obtained by checking the rank of logLval against logLval's obtained 
during the bootstrap procedure, (<code>gof</code> &lt; 0.05) or (<code>gof</code> &gt; 0.95) indicates lack of fit</p>
</td></tr>
<tr><td><code>boot</code></td>
<td>
<p>A data frame containing the bootstrap replicates of parameters and logLval</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Vidar Grotan <a href="mailto:vidar.grotan@ntnu.no">vidar.grotan@ntnu.no</a>, Steinar Engen   </p>


<h3>References</h3>

 
<p>Engen, S., R. Lande, T. Walla and P. J. DeVries. 2002. Analyzing spatial structure of communities using the two-dimensional 
Poisson lognormal species abundance model. American Naturalist <b>160</b>, 60-73.</p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+optim">optim</a></code>, <code><a href="#topic+dbipoilog">dbipoilog</a></code>, <code><a href="#topic+rbipoilog">rbipoilog</a></code>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## simulate observations
xy  &lt;- rbipoilog(S=30,mu1=1,mu2=1,sig1=2,sig2=2,rho=0.5)

## obtain estimates of parameters
est &lt;- bipoilogMLE(xy)

## change start values and request tracing information 
## from optimization procedure
## Not run: est &lt;- bipoilogMLE(xy,startVals=c(2,2,4,4,0.3),
       control=list(maxit=1000,trace=1, REPORT=1))
## End(Not run)

## effect of sampling intensity 
xy  &lt;- rbipoilog(S=100,mu1=1,mu2=1,sig1=2,sig2=2,rho=0.5,nu1=0.5,nu2=0.5)
## Not run: est &lt;- bipoilogMLE(xy)
## the expected estimates of mu1 and mu2 are now 1-log(0.5) = 0.3 (approximately) 


</code></pre>

<hr>
<h2 id='MLE+20for+20Poisson+20lognormal+20distribution'> Maximum Likelihood Estimation for Poisson Lognormal Distribution </h2><span id='topic+poilogMLE'></span>

<h3>Description</h3>

<p><code>poilogMLE</code> fits the Poisson lognormal distribution to data and estimates 
parameters mean <code>mu</code> and standard deviation <code>sig</code> in the lognormal distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poilogMLE(n, startVals = c(mu=1, sig=2), 
          nboot = 0, zTrunc = TRUE,
          method = "BFGS", control = list(maxit=1000))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MLE+2B20for+2B20Poisson+2B20lognormal+2B20distribution_+3A_n">n</code></td>
<td>
<p> A vector of counts </p>
</td></tr>
<tr><td><code id="MLE+2B20for+2B20Poisson+2B20lognormal+2B20distribution_+3A_startvals">startVals</code></td>
<td>
<p> Starting values of parameters, see details </p>
</td></tr>
<tr><td><code id="MLE+2B20for+2B20Poisson+2B20lognormal+2B20distribution_+3A_nboot">nboot</code></td>
<td>
<p> Number of parametric bootstraps, defaults to zero </p>
</td></tr>
<tr><td><code id="MLE+2B20for+2B20Poisson+2B20lognormal+2B20distribution_+3A_ztrunc">zTrunc</code></td>
<td>
<p> Zero-truncated distribution, defaults to TRUE </p>
</td></tr>
<tr><td><code id="MLE+2B20for+2B20Poisson+2B20lognormal+2B20distribution_+3A_method">method</code></td>
<td>
<p> Method to use during optimization, see details </p>
</td></tr>
<tr><td><code id="MLE+2B20for+2B20Poisson+2B20lognormal+2B20distribution_+3A_control">control</code></td>
<td>
<p> A list of control parameters for the optimization routine, see details </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function estimates parameters mean <code>mu</code> and standard deviation <code>sig</code>. 
In cases of incomplete sampling the estimate of <code>mu</code> will be confounded with the sampling
intensity (see <code><a href="#topic+rpoilog">rpoilog</a></code>). Assuming sampling intensity <code class="reqn">\nu</code>, 
the estimates of the mean is <code class="reqn">\code{mu}+\ln(\nu)</code>. Parameter <code>sig</code> can be estimated without 
any knowledge of sampling intensity.<br />
The parameters must be given starting values for the optimization procedure (default starting values are 
used if starting values are not specified in the function call).
</p>
<p>The function uses the optimization procedures in <code><a href="stats.html#topic+optim">optim</a></code> to obtain the maximum likelihood estimate.
The <code>method</code> and <code>control</code> arguments are passed to <code><a href="stats.html#topic+optim">optim</a></code>, see the help page for this 
function for additional methods and control parameters.
</p>
<p>A zero-truncated distribution (see <code><a href="#topic+dpoilog">dpoilog</a></code>) is assumed by default (<code>zTrunc = TRUE</code>).
In cases where the number of zeros is known the <code>zTrunc</code> argument should be set to <code>FALSE</code>.
</p>
<p>The approximate fraction of species revealed by the sample is <code class="reqn">1-q(0;\code{mu},\code{sig})</code>.
</p>
<p>Parametric bootstrapping is done by simulating new sets of observations using the  estimated parameters 
(see <code><a href="#topic+rbipoilog">rbipoilog</a></code>).
</p>


<h3>Value</h3>

<table>
<tr><td><code>par</code></td>
<td>
<p>Maximum likelihood estimates of the parameters</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Approximate fraction of species revealed by the sample</p>
</td></tr>
<tr><td><code>logLval</code></td>
<td>
<p>Log likelihood of the data given the estimated parameters</p>
</td></tr>
<tr><td><code>gof</code></td>
<td>
<p>Goodness of fit measure obtained by checking the rank of logLval against logLval's obtained 
during the bootstrap procedure, (gof&lt;0.05) or (gof&gt;0.95) indicates lack of fit</p>
</td></tr>
<tr><td><code>boot</code></td>
<td>
<p>A data frame containing the bootstrap replicates of parameters and logLval</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Vidar Grotan <a href="mailto:vidar.grotan@ntnu.no">vidar.grotan@ntnu.no</a>, Steinar Engen</p>


<h3>References</h3>

<p>Bulmer, M. G. 1974. On fitting the Poisson lognormal distribution to species abundance data. Biometrics <b>30</b>, 651-660.<br />
Engen, S., R. Lande, T. Walla and P. J. DeVries. 2002. Analyzing spatial structure of communities using the two-dimensional 
Poisson lognormal species abundance model. American Naturalist <b>160</b>, 60-73.</p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+optim">optim</a></code>, <code><a href="#topic+dpoilog">dpoilog</a></code>, <code><a href="#topic+rpoilog">rpoilog</a></code>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>### simulate observations

n &lt;- rpoilog(S=80,mu=1,sig=2)

### obtain estimates of parameters
est &lt;- poilogMLE(n)

### similar, but now with bootstrapping ###
## Not run: est &lt;- poilogMLE(n,nboot=10)

### change start values and request tracing information 
### from optimization procedure
est &lt;- poilogMLE(n,startVals=c(2,3),
                 control=list(maxit=1000,trace=1, REPORT=1))
</code></pre>

<hr>
<h2 id='Poisson+20lognormal'> Poisson lognormal distribution </h2><span id='topic+dpoilog'></span><span id='topic+rpoilog'></span>

<h3>Description</h3>

<p>Density and random generation for the Poisson lognormal distribution with parameters <code>mu</code> and <code>sig</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpoilog(n, mu, sig)
rpoilog(S, mu, sig, nu=1, condS=FALSE, keep0=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Poisson+2B20lognormal_+3A_n">n</code></td>
<td>
<p> vector of observed individuals for each species </p>
</td></tr>
<tr><td><code id="Poisson+2B20lognormal_+3A_s">S</code></td>
<td>
<p> number of species in the community </p>
</td></tr>
<tr><td><code id="Poisson+2B20lognormal_+3A_mu">mu</code></td>
<td>
<p> mean of lognormal distribution  </p>
</td></tr>
<tr><td><code id="Poisson+2B20lognormal_+3A_sig">sig</code></td>
<td>
<p> standard deviation of lognormal distribution </p>
</td></tr>
<tr><td><code id="Poisson+2B20lognormal_+3A_nu">nu</code></td>
<td>
<p> sampling intensity, defaults to 1 </p>
</td></tr>
<tr><td><code id="Poisson+2B20lognormal_+3A_conds">condS</code></td>
<td>
<p> logical; if TRUE random deviates are conditional on S</p>
</td></tr>
<tr><td><code id="Poisson+2B20lognormal_+3A_keep0">keep0</code></td>
<td>
<p> logical; if TRUE species with count 0 are included in the random deviates </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following is written from the perspective of using the Poisson lognormal distribution 
to describe community structure (the distribution of species when sampling individuals 
from a community of several species). 
</p>
<p>Under the assumption of random sampling, the number of individuals sampled from a given 
species with abundance <em>y</em>, say <em>N</em>, is Poisson distributed with mean <code class="reqn">\code{nu}\,y</code> 
where the parameter <code>nu</code> expresses the sampling intensity. If ln <em>y</em> is normally distributed 
with mean <code>mu</code> and standard deviation <code>sig</code> among species, then the vector of individuals sampled 
from all <code>S</code> species then constitutes a sample from the Poisson lognormal distribution
with parameters (<code>mu</code> + ln <code>nu</code>, <code>sig</code>), where <code>mu</code> and <code>sig</code> 
are the mean and standard deviation of the log abundances. For <code>nu</code> = 1, this is the Poisson 
lognormal distribution with parameters (<code>mu</code>,<code>sig</code>) which may be written in the form
</p>
<p style="text-align: center;"><code class="reqn">P(N=\code{n};\code{mu},\code{sig}) = q(\code{n};\code{mu},\code{sig}) = \int\limits_{-\infty}^{\infty} g_\code{n}(\code{mu},\code{sig},u)\phi(u)\;du,</code>
</p>

<p>where <code class="reqn">\phi(u)</code> is the standard normal distribution and
</p>
<p style="text-align: center;"><code class="reqn">g_\code{n}(\code{mu},\code{sig},u) = \frac{\exp(u\,\code{sig}\,\code{n} + \code{mu}\,\code{n} - \exp(u\,\code{sig} + \code{mu}))}{\code{n}!}</code>
</p>
 
<p>Since <code>S</code> is usually unknown, we only consider the observed number of individuals for the observed species.
With a general sampling intensity <code>nu</code>, the distribution of the number of individuals then follows the
zero-truncated Poisson lognormal distribution
</p>
<p style="text-align: center;"><code class="reqn">\frac{q(\code{n};\code{mu},\code{sig})}{1-q(0;\code{mu},\code{sig})}</code>
</p>



<h3>Value</h3>

<p><code>dpoilog</code> returns the density<br />    
<code>rpoilog</code> returns random deviates
</p>


<h3>Author(s)</h3>

<p> Vidar Grotan <a href="mailto:vidar.grotan@ntnu.no">vidar.grotan@ntnu.no</a> and Steinar Engen   </p>


<h3>References</h3>

<p> Engen, S., R. Lande, T. Walla &amp; P. J. DeVries. 2002. Analyzing spatial structure of communities using the two-dimensional 
Poisson lognormal species abundance model. American Naturalist 160: 60-73.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+poilogMLE">poilogMLE</a></code> for ML estimation</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### plot density for given parameters 
barplot(dpoilog(n=0:20,mu=2,sig=1),names.arg=0:20)

### draw random deviates from a community of 50 species 
rpoilog(S=50,mu=2,sig=1)

### draw random deviates including zeros 
rpoilog(S=50,mu=2,sig=1,keep0=TRUE)

### draw random deviates with sampling intensity = 0.5 
rpoilog(S=50,mu=2,sig=1,nu=0.5)

### how many species are likely to be observed 
### (given S,mu,sig2 and nu)? 
hist(replicate(1000,length(rpoilog(S=30,mu=0,sig=3,nu=0.7))))

### how many individuals are likely to be observed
### (given S,mu,sig2 and nu)? 
hist(replicate(1000,sum(rpoilog(S=30,mu=0,sig=3,nu=0.7))))


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
