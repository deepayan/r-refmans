<!DOCTYPE html><html><head><title>Help for package FMStable</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FMStable}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Estable'><p>Extremal or Maximally Skew Stable Distributions</p></a></li>
<li><a href='#FMstable'><p>Finite Moment Log Stable Distributions</p></a></li>
<li><a href='#Gstable'><p>General Stable Distributions</p></a></li>
<li><a href='#impliedVolatility'><p>Computations Regarding Value of Options for Log Normal Distributions</p></a></li>
<li><a href='#moments'><p>Convolutions of Finite Moment Log Stable Distributions and the</p>
Moments of such Distributions</a></li>
<li><a href='#optionValues'><p>Values of Options over Finite Moment Log Stable Distributions</p></a></li>
<li><a href='#stableParameters'><p>Setting up Parameters to Describe both Extremal Stable Distributions</p>
and Finite Moment Log Stable Distributions</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Finite Moment Stable Distributions</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1-4</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-03</td>
</tr>
<tr>
<td>Author:</td>
<td>Geoff Robinson</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel Wilson &lt;hmp.R.package@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Some basic procedures for dealing
        with log maximally skew stable distributions, which are also
        called finite moment log stable distributions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-03 14:15:08 UTC; wilson</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-06 20:10:26 UTC</td>
</tr>
</table>
<hr>
<h2 id='Estable'>Extremal or Maximally Skew Stable Distributions</h2><span id='topic+Estable'></span><span id='topic+dEstable'></span><span id='topic+pEstable'></span><span id='topic+qEstable'></span><span id='topic+tailsEstable'></span>

<h3>Description</h3>

<p>Density function, distribution function, quantile function
and random generation for stable distributions which are maximally
skewed to the right.  These distributions are called Extremal by
Zolotarev (1986).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  dEstable(x, stableParamObj, log=FALSE) 
  pEstable(x, stableParamObj, log=FALSE, lower.tail=TRUE)
  qEstable(p, stableParamObj, log=FALSE, lower.tail=TRUE)
  tailsEstable(x, stableParamObj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Estable_+3A_x">x</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="Estable_+3A_stableparamobj">stableParamObj</code></td>
<td>
<p>An object of class <code><a href="#topic+stableParameters">stableParameters</a></code> which
describes a maximally skew stable distribution. It may, for
instance, have been created by <code><a href="#topic+setParam">setParam</a></code> or
<code><a href="#topic+setMomentsFMstable">setMomentsFMstable</a></code>.</p>
</td></tr>
<tr><td><code id="Estable_+3A_p">p</code></td>
<td>
<p>Vector of tail probabilities.</p>
</td></tr>
<tr><td><code id="Estable_+3A_log">log</code></td>
<td>
<p>Logical; if <code>TRUE</code>, the log density or log tail
probability is returned by functions <code>dEstable</code> and
<code>pEstable</code>; and logarithms of probabilities are input to function
<code>qEstable</code>. </p>
</td></tr>
<tr><td><code id="Estable_+3A_lower.tail">lower.tail</code></td>
<td>
<p>Logical; if <code>TRUE</code>, the lower tail probability
is returned.  Otherwise, the upper tail probability.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The values are worked out by interpolation, with several different
interpolation formulae in various regions.
</p>


<h3>Value</h3>

<p><code>dEstable</code> gives the density function;
<code>pEstable</code> gives the distribution function or its complement;
<code>qEstable</code> gives quantiles;
<code>tailsEstable</code> returns a list with the following components
which are all the same length as <code>x</code>:
</p>

<dl>
<dt>density</dt><dd><p>The probability density function.</p>
</dd>
<dt>F</dt><dd><p>The probability distribution function.  i.e. the
probability of being less than or equal to <code>x</code>.</p>
</dd>
<dt>righttail</dt><dd><p>The probability of being larger than <code>x</code>.</p>
</dd>
<dt>logdensity</dt><dd><p>The probability density function.</p>
</dd>
<dt>logF</dt><dd><p>The logarithm of the probability of being less than
or equal to <code>x</code>.</p>
</dd>
<dt>logrighttail</dt><dd><p>The logarithm of the probability of being
larger than <code>x</code>.</p>
</dd>
</dl>




<h3>References</h3>

<p>Chambers, J.M., Mallows, C.L. and Stuck, B.W. (1976).  A method for
simulating stable random variables. Journal of the American
Statistical Association, 71, 340&ndash;344.
</p>


<h3>See Also</h3>

<p>If <code class="reqn">x</code> has an extremal stable distribution then
<code class="reqn">\exp(-x)</code> has a finite moment log stable distribution.
The left hand tail probability computed using <code>pEstable</code> should be
the same as the coresponding right hand tail probability computed using
<code><a href="#topic+pFMstable">pFMstable</a></code>.
</p>
<p>Aspects of extremal stable distributions may also be computed (though
more slowly) using <code><a href="#topic+tailsGstable">tailsGstable</a></code> with <code>beta</code>=1.
</p>
<p>Functions for generation of random variables having stable distributions
are available in package <code>stabledist</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tailsEstable(-2:3, setMomentsFMstable(mean=1, sd=1.5, alpha=1.7))

# Compare Estable and FMstable
obj &lt;- setMomentsFMstable(1.7, mean=.5, sd=.2)
x &lt;- c(.001, 1, 10)
pFMstable(x,  obj, lower.tail=TRUE, log=TRUE)
pEstable(-log(x), obj, lower.tail=FALSE, log=TRUE)

x &lt;- seq(from=-5, to=10, length=30)
plot(x, dEstable(x, setMomentsFMstable(alpha=1.5)), type="l", log="y",
  ylab="Log(density) for stable distribution",
  main="log stable distribution with alpha=1.5, mean=1, sd=1" )

x &lt;- seq(from=-2, to=5, length=30)
plot(x, x, ylim=c(0,1), type="n", ylab="Distribution function")
for (i in 0:2)lines(x, pEstable(x,
  setParam(location=0, logscale=-.5, alpha=1.5, pm=i)), col=i+1)
legend("bottomright", legend=paste("S", 0:2, sep=""), lty=rep(1,3), col=1:3)

p &lt;- c(1.e-10, .01, .1, .2, .5, .99, 1-1.e-10)
obj &lt;- setMomentsFMstable(alpha=1.95)
result &lt;- qEstable(p, obj)
pEstable(result, obj) - p

# Plot to illustrate continuity near alpha=1
y &lt;- seq(from=-36, to=0, length=30)
logprob &lt;- -exp(-y)
plot(0, 0, type="n", xlim=c(-25,0), ylim=c(-35, -1),
  xlab="x (M parametrization)", ylab="-log(-log(distribution function))")
for (oneminusalpha in seq(from=-.2, to=0.2, by=.02)){
  obj &lt;- setParam(oneminusalpha=oneminusalpha, location=0, logscale=0, pm=0)
  type &lt;- if(oneminusalpha==0) 2 else 1
  lines(qEstable(logprob, obj, log=TRUE), y, lty=type, lwd=type)
}
</code></pre>

<hr>
<h2 id='FMstable'>Finite Moment Log Stable Distributions</h2><span id='topic+FMstable'></span><span id='topic+dFMstable'></span><span id='topic+pFMstable'></span><span id='topic+pFMstable.alpha0'></span><span id='topic+qFMstable'></span><span id='topic+tailsFMstable'></span>

<h3>Description</h3>

<p>Density function, distribution function, and quantile function
for a log stable distribution with
location, scale and shape parameters.  For such families of
distributions all moments are finite.  Carr and Wu (2003) refer to
such distributions as &ldquo;finite moment log stable processes&rdquo;.
</p>
<p>The finite moment log stable distribution is well-defined for
<code class="reqn">\alpha=0</code>,
when the distribution is discrete with probability concentrated at x=0
and at one other point.  The distribution function may be
computed by <code>pFMstable.alpha0</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  dFMstable(x, stableParamObj, log=FALSE) 
  pFMstable(x, stableParamObj, log=FALSE, lower.tail=TRUE)
  pFMstable.alpha0(x, mean=1, sd=1, lower.tail=TRUE)
  qFMstable(p, stableParamObj, lower.tail=TRUE)
  tailsFMstable(x, stableParamObj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FMstable_+3A_x">x</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="FMstable_+3A_stableparamobj">stableParamObj</code></td>
<td>
<p>An object of class <code>stableParameters</code> which
describes a maximally skew stable distribution.   It may, for
instance, have been created by <code><a href="#topic+setMomentsFMstable">setMomentsFMstable</a></code> or
<code><a href="#topic+fitGivenQuantile">fitGivenQuantile</a></code>.</p>
</td></tr>
<tr><td><code id="FMstable_+3A_mean">mean</code></td>
<td>
<p>Mean of logstable distribution.</p>
</td></tr>
<tr><td><code id="FMstable_+3A_sd">sd</code></td>
<td>
<p>Standard deviation of logstable distribution.</p>
</td></tr>
<tr><td><code id="FMstable_+3A_p">p</code></td>
<td>
<p>Vector of tail probabilities.</p>
</td></tr>
<tr><td><code id="FMstable_+3A_log">log</code></td>
<td>
<p>Logical; if <code>TRUE</code>, the log density or log tail
probability is returned by functions <code>dFMstable</code> and
<code>pFMstable</code>; and logarithms of probabilities are input to function
<code>qFMstable</code>. </p>
</td></tr>
<tr><td><code id="FMstable_+3A_lower.tail">lower.tail</code></td>
<td>
<p>Logical; if <code>TRUE</code>, the lower tail probability
is returned.  Otherwise, the upper tail probability.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The values are worked out by interpolation, with several different
interpolation formulae in various regions.
</p>


<h3>Value</h3>

<p><code>dFMstable</code> gives the density function;
<code>pFMstable</code> gives the distribution function or its complement;
<code>qFMstable</code> gives quantiles;
<code>tailsFMstable</code>  returns a list with the following components
which are all the same length as <code>x</code>:
</p>

<dl>
<dt>density</dt><dd><p>The probability density function.</p>
</dd>
<dt>F</dt><dd><p>The probability distribution function.  i.e. the
probability of being less than or equal to <code>x</code>.</p>
</dd>
<dt>righttail</dt><dd><p>The probability of being larger than <code>x</code>.</p>
</dd>
<dt>logdensity</dt><dd><p>The probability density function.</p>
</dd>
<dt>logF</dt><dd><p>The logarithm of the probability of being less than
or equal to <code>x</code>.</p>
</dd>
<dt>logrighttail</dt><dd><p>The logarithm of the probability of being
larger than <code>x</code>.</p>
</dd>
</dl>




<h3>References</h3>

<p>Carr, P. and Wu, L. (2003). The Finite Moment Log Stable Process and
Option Pricing. Journal of Finance, American Finance Association, vol. 58(2), pages 753-778
</p>


<h3>See Also</h3>

<p>If a random variable <code class="reqn">X</code> has a finite moment stable
distribution then <code class="reqn">\log(X)</code> has the corresponding extremal stable
distribution.  The density of <code class="reqn">\log(X)</code> can be found using
<code><a href="#topic+dEstable">dEstable</a></code>.
Option prices can be found using <code><a href="#topic+callFMstable">callFMstable</a></code> and
<code><a href="#topic+putFMstable">putFMstable</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tailsFMstable(1:10, setMomentsFMstable(3, 1.5, alpha=1.7))

x &lt;- c(-1, 0, 1.e-5, .001, .01, .03, seq(from=.1, to=4.5, length=100))
plot(x, pFMstable(x, setMomentsFMstable(1, 1.5, 2)), type="l" ,xlim=c(0, 4.3),
  ylim=c(0,1), ylab="Distribution function")
for (alpha in c(.03, 1:19/10)) lines(x, pFMstable(x,
  setMomentsFMstable(1, 1.5, alpha)), col=2)
lines(x, pFMstable.alpha0(x, mean=1, sd=1.5), col=3)

p &lt;- c(1.e-10, .01, .1, .2, .5, .99, 1-1.e-10)
obj &lt;- setMomentsFMstable(alpha=1.95)
result &lt;- qFMstable(p, obj)
OK &lt;- result &gt; 0
pFMstable(result[OK], obj) - p[OK]
</code></pre>

<hr>
<h2 id='Gstable'>General Stable Distributions</h2><span id='topic+Gstable'></span><span id='topic+tailsGstable'></span>

<h3>Description</h3>

<p>A procedure based on the <span class="rlang"><b>R</b></span> function <code>integrate</code> for computing the
distribution function for stable distributions
which may be skew but have standard location and scale parameters.
This computation is not fast.
</p>
<p>It is not designed to work for <code>alpha</code> near to 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tailsGstable(x, logabsx, alpha, oneminusalpha, twominusalpha, 
  beta, betaplus1, betaminus1, parametrization, lower.tail=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Gstable_+3A_x">x</code></td>
<td>
<p>Value (scalar).</p>
</td></tr>
<tr><td><code id="Gstable_+3A_logabsx">logabsx</code></td>
<td>
<p>Logarithm of absolute value of x.  Must be used when x
is outside the range over which numbers can be stored. (e.g. 1.e-5000)</p>
</td></tr>
<tr><td><code id="Gstable_+3A_alpha">alpha</code></td>
<td>
<p>Value of parameter of stable distribution.</p>
</td></tr>
<tr><td><code id="Gstable_+3A_oneminusalpha">oneminusalpha</code></td>
<td>
<p>Value of alpha.  This should be specified when
alpha is near to 1 so that the difference from 1 is specified
accurately.</p>
</td></tr>
<tr><td><code id="Gstable_+3A_twominusalpha">twominusalpha</code></td>
<td>
<p>Value of 2 - alpha.  This should be specified when
alpha is near to 2 so that the difference from 2 is specified
accurately.</p>
</td></tr>
<tr><td><code id="Gstable_+3A_beta">beta</code></td>
<td>
<p>Value of parameter of stable distribution.</p>
</td></tr>
<tr><td><code id="Gstable_+3A_betaplus1">betaplus1</code></td>
<td>
<p>Value of beta + 1.  This should be specified when
beta is near to -1 so that the difference from -1 is specified accurately.</p>
</td></tr>
<tr><td><code id="Gstable_+3A_betaminus1">betaminus1</code></td>
<td>
<p>Value of beta - 1.  This should be specified when
beta is near to 1 so that the difference from 1 is specified accurately.</p>
</td></tr>
<tr><td><code id="Gstable_+3A_parametrization">parametrization</code></td>
<td>
<p>Parametrization: 0 for Zolotarev's M = Nolan
S0, 1 for Zolotarev's A = Nolan S1 and 2 for
Zolotarev's C = Chambers, Mallows and Stuck.</p>
</td></tr>
<tr><td><code id="Gstable_+3A_lower.tail">lower.tail</code></td>
<td>
<p>Logical: Whether the lower tail of the distribution is of
primary interest.  This parameter affects whether numerical integration
is used for the lower or upper tail.  The other tail is computed by
subtraction.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with the following components:
</p>

<dl>
<dt>left.tail.prob</dt><dd><p>The probability distribution function.  I.e. the
probability of being less than or equal to <code>x</code>.</p>
</dd>
<dt>right.tail.prob</dt><dd><p>The probability of being larger than <code>x</code>.</p>
</dd>
<dt>est.error</dt><dd><p>An estimate of the computational error in the
previous two numbers.</p>
</dd>
<dt>message</dt><dd><p>A message produced by R's standard
<code><a href="stats.html#topic+integrate">integrate</a></code> routine.</p>
</dd>
</dl>



<h3>Note</h3>

<p>This code is included mainly as an illustration of a way to deal with
the problem that different parametrizations are useful in different
regions.
It is also of some value for checking other code, particularly since it
was not used as the basis for the interpolation tables.
</p>
<p>For the C parametrization for <code>alpha</code> greater than 1, the parameter
<code>beta</code> needs to be set to -1 for the distribution to be skewed to
the right.
</p>


<h3>References</h3>

<p>Chambers, J.M., Mallows, C.L. and Stuck, B.W. (1976) A method for
simulating stable random variables. Journal of the American
Statistical Association 71, 340&ndash;344.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Check relationship between maximally skew and other stable distributions
# in paper by J.M. Chambers, C.L. Mallows and B.W. Stuck
alpha &lt;- 1.9
beta &lt;- -.5
k &lt;- 1- abs(1-alpha)
denom &lt;- sin(pi*k)
p &lt;- (sin(.5*pi*k * (1+beta))/denom)^(1/alpha)
q &lt;- (sin(.5*pi*k * (1-beta))/denom)^(1/alpha)
# Probability that p S1 - q S2 &lt; x
S1 &lt;- setParam(alpha=1.9, location=0, logscale =log(p), pm="C")
S2 &lt;- setParam(alpha=1.9, location=0, logscale =log(q), pm="C")
S3 &lt;- setParam(alpha=1.9, location=0, logscale =0, pm="C")
xgiven &lt;- 1
f &lt;- function(x) dEstable(x, S1) * pEstable(xgiven + x, S2)
print(integrate(f, lower=-Inf, upper=Inf, rel.tol=1.e-12)$value, digits=16)
f &lt;- function(x) dEstable(x, S3) * pEstable((xgiven + p*x)/q, S3)
print(integrate(f, lower=-Inf, upper=Inf, rel.tol=1.e-8)$value, digits=16)
direct &lt;- tailsGstable(x=xgiven, logabsx=log(xgiven),alpha=alpha,
  beta=beta, parametrization=2)
print(direct$left.tail.prob, digits=16)

# Compare Estable and Gstable
# List fractional discrepancies
disc &lt;- function(tol){
  for(pm in pms) for (a in alphas) for(x in xs) {
    lx &lt;- log(abs(x))
    beta &lt;- if(pm==2 &amp;&amp; a &gt; 1) -1 else 1
    if(x &gt; 0 || a &gt; 1){
      a1 &lt;- pEstable(x, setParam(alpha=a, location=0, logscale=0, pm=pm))
      a2 &lt;- tailsGstable(x=x, logabsx=lx, alpha=a, beta=beta,
        parametrization=pm)$left.tail.prob
      print(paste("parametrization=", pm, "alpha=", a,"x=", x,
        "Frac disc=", a1/a2-1), quote=FALSE)
    }
  }
}

alphas &lt;- c(.3, .8, 1.1, 1.5, 1.9)
pms &lt;- 0:2
xs &lt;- c(-2, .01, 4.3)
disc()
</code></pre>

<hr>
<h2 id='impliedVolatility'>Computations Regarding Value of Options for Log Normal Distributions</h2><span id='topic+BSOptionValue'></span><span id='topic+ImpliedVol'></span><span id='topic+lnorm.param'></span>

<h3>Description</h3>

<p>Computes values of European-style call and put options over
assets whose future price is expected to follow a log normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BSOptionValue(spot, strike, expiry, volatility,
  intRate=0, carryCost=0, Call=TRUE)
ImpliedVol(spot, strike, expiry, price, intRate=0, carryCost=0,
  Call=TRUE, ImpliedVolLowerBound=.01, ImpliedVolUpperBound=1, tol=1.e-9)
lnorm.param(mean, sd) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="impliedVolatility_+3A_spot">spot</code></td>
<td>
<p>The current price of a security.</p>
</td></tr>
<tr><td><code id="impliedVolatility_+3A_strike">strike</code></td>
<td>
<p>The strike price for an option.</p>
</td></tr>
<tr><td><code id="impliedVolatility_+3A_expiry">expiry</code></td>
<td>
<p>The time when an option may be exercised.  (We are only
dealing with European options which have a single date on which they may
be exercised.)</p>
</td></tr>
<tr><td><code id="impliedVolatility_+3A_volatility">volatility</code></td>
<td>
<p>The volatility of the price of a security per unit
time.  This is the standard deviation of the logarithm of price.</p>
</td></tr>
<tr><td><code id="impliedVolatility_+3A_price">price</code></td>
<td>
<p>The price for an option.  This is used as an input
parameter when computing the implied volatility.</p>
</td></tr> 
<tr><td><code id="impliedVolatility_+3A_intrate">intRate</code></td>
<td>
<p>The interest rate.</p>
</td></tr>
<tr><td><code id="impliedVolatility_+3A_carrycost">carryCost</code></td>
<td>
<p>The carrying cost for a security. This may be
negative when a security is expected to pay a dividend.</p>
</td></tr>
<tr><td><code id="impliedVolatility_+3A_call">Call</code></td>
<td>
<p>Logical: Whether the option for which a <code>price</code> is
given is a call option.</p>
</td></tr>
<tr><td><code id="impliedVolatility_+3A_impliedvollowerbound">ImpliedVolLowerBound</code></td>
<td>
<p>Lower bound used when searching for the
inplied volatility.</p>
</td></tr>
<tr><td><code id="impliedVolatility_+3A_impliedvolupperbound">ImpliedVolUpperBound</code></td>
<td>
<p>Upper bound used when searching for the
inplied volatility.</p>
</td></tr>
<tr><td><code id="impliedVolatility_+3A_tol">tol</code></td>
<td>
<p>Tolerance specifying accuracy of search for implied
volatility.</p>
</td></tr>
<tr><td><code id="impliedVolatility_+3A_mean">mean</code></td>
<td>
<p>The mean of a quantity which has a lognormal distribution.</p>
</td></tr>
<tr><td><code id="impliedVolatility_+3A_sd">sd</code></td>
<td>
<p>The standard deviation of a quantity which has a
lognormal distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The lognormal distribution is
the limit of finite moment log stable distributions as <code>alpha</code> tends to
2.  The function <code>lnorm.param</code> finds the mean and standard
deviation of a lognormal distribution on the log scale given the mean
and standard deviation on the raw scale.  The function
<code>BSOptionValue</code> finds the value of a European call or put option.
The function <code>ImpliedVol</code> allows computation of the implied
volatility, which is the volatility on the logarithmic scale which
matches the value of an option to a specified price.
</p>


<h3>Value</h3>

<p><code>impVol</code> returns the implied volatility when the value of options
is computed using a finite moment log stable distribution.
<code>approx.impVol</code> returns an approximation to the implied volatility.
<code>lnorm.param</code> returns the mean and standard deviation of the
underlying normal distribution.
</p>


<h3>See Also</h3>

<p>Option prices computed using the log normal model can be
compared to those computed for the finite moment log stable model
using <code><a href="#topic+putFMstable">putFMstable</a></code> and <code><a href="#topic+callFMstable">callFMstable</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lnorm.param(mean=5, sd=.8) 
BSOptionValue(spot=4, strike=c(4, 4.5), expiry=.5, volatility=.15)
ImpliedVol(spot=4, strike=c(4, 4.5), expiry=.5, price=c(.18,.025))
</code></pre>

<hr>
<h2 id='moments'>Convolutions of Finite Moment Log Stable Distributions and the
Moments of such Distributions</h2><span id='topic+iidcombine'></span><span id='topic+moments'></span>

<h3>Description</h3>

<p>If <code class="reqn">X_1, \dots , X_n</code> are independent random variables with the same stable
distribution then <code class="reqn">X_1+ \dots +X_n</code> has a stable distribution with the same
alpha.  The function <code>iidcombine</code> allows the parameters of the
resulting stable distribution to be computed.
Because stable distributions are infinitely divisible, it is also easy
to find the parameters describing the distribution of <code class="reqn">X_1</code> from the
parameters describing the distribution of <code class="reqn">X_1+ \dots +X_n</code>.
</p>
<p>Convolutions of maximally skew stable distributions correspond to
products of logstable distributions.  The raw moments of these distributions
(i.e. moments about zero, not moments about the mean)
can be readily computed using the function <code>moments</code>.
Note that the raw moments of the convolution of two independent
distributions are the products of the corresponding moments of the
component distributions, so the accuracy of <code>iidcombine</code> can be
checked by using <code>moments</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iidcombine(n, stableParamObj)
moments(powers, stableParamObj, log=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moments_+3A_n">n</code></td>
<td>
<p>Number of random variables to be convoluted.  May be any
positive number.</p>
</td></tr>
<tr><td><code id="moments_+3A_powers">powers</code></td>
<td>
<p>Raw moments of logstable distributions to be computed.</p>
</td></tr>
<tr><td><code id="moments_+3A_stableparamobj">stableParamObj</code></td>
<td>
<p>An object of class <code>stableParameters</code> which
describes a maximally skew stable distribution.</p>
</td></tr>
<tr><td><code id="moments_+3A_log">log</code></td>
<td>
<p>Logical; if <code>TRUE</code>, the logarithms of moments are returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value returned by <code>iidcombine</code>
is another object of class <code>stableParameters</code>.
The value returned by <code>moments</code> is a numeric vector
giving the values of the specified raw moments.
</p>


<h3>See Also</h3>

<p>Objects of class <code>stableParameters</code> can be created using
functions such as <code><a href="#topic+setParam">setParam</a></code>.
The taking of convolutions is sometimes associated with the computing of
values of options using functions such as <code><a href="#topic+callFMstable">callFMstable</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>yearDsn &lt;- fitGivenQuantile(mean=1, sd=2, prob=.7, value=.1)
upper &lt;- exp(-yearDsn$location)	# Only sensible for alpha&lt;.5
x &lt;- exp(seq(from=log(.0001), to=log(upper), length=50))
plot(x, pFMstable(x, yearDsn), type="l", ylim=c(.2,1), lwd=2, xlab="Price",
  ylab="Distribution function of future price")
half &lt;- iidcombine(.5, yearDsn)
lines(x, pFMstable(x, half), lty=2, lwd=2)
quarter &lt;- iidcombine(.25, yearDsn)
lines(x, pFMstable(x, quarter), lty=3, lwd=2)
legend("bottomright", legend=paste(c("1","1/2","1/4"),"year"), lty=c(1,2,3),
  lwd=c(2,2,2))
moments(1:2, yearDsn)
moments(1:2, half)
moments(1:2, quarter)

# Check logstable against lognormal
iidcombine(2, setMomentsFMstable(.5, .2, alpha=2))
p &lt;- lnorm.param(.5, .2)
2*p$meanlog		# Gives the mean
log(p$sdlog)	# Gives the logscale
</code></pre>

<hr>
<h2 id='optionValues'>Values of Options over Finite Moment Log Stable Distributions</h2><span id='topic+putFMstable'></span><span id='topic+callFMstable'></span><span id='topic+optionsFMstable'></span>

<h3>Description</h3>

<p>Computes values of European-style call and put options over
assets whose future price is expected to follow a finite moment log
stable distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>putFMstable(strike, paramObj, rel.tol=1.e-10)
callFMstable(strike, paramObj, rel.tol=1.e-10)
optionsFMstable(strike, paramObj, rel.tol=1.e-10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optionValues_+3A_strike">strike</code></td>
<td>
<p>The strike price for an option.</p>
</td></tr>
<tr><td><code id="optionValues_+3A_paramobj">paramObj</code></td>
<td>
<p>An object of class <code>stableParameters</code> which
describes a maximally skew stable distribution.  This is the
distribution which describes possible prices for the underlying security
at the time of expiry.</p>
</td></tr>
<tr><td><code id="optionValues_+3A_rel.tol">rel.tol</code></td>
<td>
<p>The relative tolerance used for numerical integration
for finding option values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>optionsFMstable</code> returns a list containing the values of put
options and the values of call options.
</p>


<h3>Note</h3>

<p>When comparing option values based on finite moment log stable
distributions with ones based on log normal distributions, remember that
the interest rate and holding cost have been ignored here.
</p>
<p>Rather than using functions <code>putFMstable</code> and <code>callFMstable</code>
for options that are extremely in-the-money (i.e. the options are almost
certain to be exercised), the values of such options can be computed
more accurately by first computing the value of the out-of-the-money
option and then using the relationship <code>spot</code> + <code>put</code> =
<code>call</code> + <code>strike</code>.  This is done by function
<code>optionsFMstable</code>.
</p>


<h3>See Also</h3>

<p>An example of how an object of class <code>stableParameters</code>
may be created is by <code><a href="#topic+setParam">setParam</a></code>.  Procedures for dealing with
the log normal model for options pricing include <code><a href="#topic+BSOptionValue">BSOptionValue</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>paramObj &lt;- setMomentsFMstable(mean=10, sd=1.5, alpha=1.8)
putFMstable(c(10,7), paramObj)
callFMstable(c(10,7), paramObj)
optionsFMstable(8:12, paramObj)
# Note that call - put = mean - strike

# Values of some extreme put options
paramObj &lt;- setMomentsFMstable(mean=1, sd=1.5, alpha=0.02)
putFMstable(1.e-200, paramObj)
putFMstable(1.e-100, paramObj)
pFMstable(1.e-100, paramObj)
putFMstable(1.e-50, paramObj)

# Asymptotic behaviour
logmlogx &lt;- seq(from=2, to=6, length=30)
logx &lt;- -exp(logmlogx)
x &lt;- exp(logx)
plot(logmlogx , putFMstable(x, paramObj)/(x*pFMstable(x, paramObj)), type="l")

# Work out the values of some options using FMstable model
spot &lt;- 20
strikes &lt;- c(15,18:20, 20:24, 18:20, 20:23)
isCall &lt;- rep(c(FALSE,TRUE,FALSE,TRUE), c(4,5,3,4))
expiry &lt;- rep(c(.2, .5), c(9,7))
# Distributions for 0.2 and 0.5 of a year given distribution describing
#   multiplicative change in price over a year:
annual &lt;- fitGivenQuantile(mean=1, sd=.2, prob=2.e-4, value=.01)
timep2 &lt;- iidcombine(.2, annual)
timep5 &lt;- iidcombine(.5, annual)
imp.vols &lt;- prices &lt;- rep(NA, length(strikes))
use &lt;- isCall &amp; expiry==.2
prices[use] &lt;- callFMstable(strikes[use]/spot, timep2) * spot
use &lt;- !isCall &amp; expiry==.2
prices[use] &lt;- putFMstable(strikes[use]/spot, timep2) * spot
use &lt;- isCall &amp; expiry==.5
prices[use] &lt;- callFMstable(strikes[use]/spot, timep5) * spot
use &lt;- !isCall &amp; expiry==.5
prices[use] &lt;- putFMstable(strikes[use]/spot, timep5) * spot
# Compute implied volatilities.
imp.vols[isCall] &lt;- ImpliedVol(spot=spot, strike=strikes[isCall],
  expiry=expiry[isCall], price=prices[isCall], Call=TRUE)
imp.vols[!isCall] &lt;- ImpliedVol(spot=spot, strike=strikes[!isCall],
  expiry=expiry[!isCall], price=prices[!isCall], Call=FALSE)

# List values of options
cbind(strikes, expiry, isCall, prices, imp.vols)

# Can the distribution be recovered from the values of the options?
discrepancy &lt;- function(alpha, cv){
  annual.fit &lt;- setMomentsFMstable(mean=1, sd=cv, alpha=alpha)
  timep2.fit &lt;- iidcombine(.2, annual.fit)
  timep5.fit &lt;- iidcombine(.5, annual.fit)
  prices.fit &lt;- rep(NA, length(strikes))
  use &lt;- isCall &amp; expiry==.2
  prices.fit[use] &lt;- callFMstable(strikes[use]/spot, timep2.fit) * spot
  use &lt;- !isCall &amp; expiry==.2
  prices.fit[use] &lt;- putFMstable(strikes[use]/spot, timep2.fit) * spot
  use &lt;- isCall &amp; expiry==.5
  prices.fit[use] &lt;- callFMstable(strikes[use]/spot, timep5.fit) * spot
  use &lt;- !isCall &amp; expiry==.5
  prices.fit[use] &lt;- putFMstable(strikes[use]/spot, timep5.fit) * spot
  return(sum((prices.fit - prices)^2))
}
# Search on scales of log(2-alpha) and log(cv)
d &lt;- function(param) discrepancy(2-exp(param[1]), exp(param[2]))
system.time(result &lt;- nlm(d, p=c(-2,-1.5)))
# Estimated alpha
2-exp(result$estimate[1])
# Estimated cv
exp(result$estimate[2])

# Searching just for best alpha
d &lt;- function(param) discrepancy(param, .2)
system.time(result &lt;- optimize(d, lower=1.6, upper=1.98))
# Estimated alpha
result$minimum
</code></pre>

<hr>
<h2 id='stableParameters'>Setting up Parameters to Describe both Extremal Stable Distributions
and Finite Moment Log Stable Distributions</h2><span id='topic+stableParameters'></span><span id='topic+stable'></span><span id='topic+setParam'></span><span id='topic+setMomentsFMstable'></span><span id='topic+fitGivenQuantile'></span><span id='topic+matchQuartiles'></span><span id='topic+print.stableParameters'></span>

<h3>Description</h3>

<p>Functions which create stable distributions having specified
properties.  Each of these functions takes scalar arguments and produces
a description of a single stable distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setParam(alpha, oneminusalpha, twominusalpha, location, logscale, pm)
setMomentsFMstable(mean=1, sd=1, alpha, oneminusalpha, twominusalpha)
fitGivenQuantile(mean, sd, prob, value, tol=1.e-10)
matchQuartiles(quartiles, alpha, oneminusalpha, twominusalpha, tol=1.e-10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stableParameters_+3A_alpha">alpha</code></td>
<td>
<p>Stable distribution parameter which must be a single
value satisfying <code class="reqn">0 &lt; \alpha &lt;= 2</code>.</p>
</td></tr>
<tr><td><code id="stableParameters_+3A_oneminusalpha">oneminusalpha</code></td>
<td>
<p>Alternative specification of stable distribution
parameter: Specify 1-alpha.</p>
</td></tr>
<tr><td><code id="stableParameters_+3A_twominusalpha">twominusalpha</code></td>
<td>
<p>Alternative specification of stable distribution
parameter: Specify 2-alpha.</p>
</td></tr>
<tr><td><code id="stableParameters_+3A_location">location</code></td>
<td>
<p>Location parameter of stable distribution.</p>
</td></tr>
<tr><td><code id="stableParameters_+3A_logscale">logscale</code></td>
<td>
<p>Logarithm of scale parameter of stable distribution.</p>
</td></tr>
<tr><td><code id="stableParameters_+3A_pm">pm</code></td>
<td>
<p>Parametrization used in specifying stable distribution
which is maximally skewed to the right.  Allowable values are 0, &quot;S0&quot;, &quot;M&quot;,
1, &quot;S1&quot;, &quot;A&quot;, 2, &quot;CMS&quot; or &quot;C&quot; for some common parametrizations.</p>
</td></tr>
<tr><td><code id="stableParameters_+3A_mean">mean</code></td>
<td>
<p>Mean of logstable distribution.</p>
</td></tr>
<tr><td><code id="stableParameters_+3A_sd">sd</code></td>
<td>
<p>Standard deviation of logstable distribution.</p>
</td></tr>
<tr><td><code id="stableParameters_+3A_value">value</code>, <code id="stableParameters_+3A_prob">prob</code></td>
<td>
<p>Required probability distribution function (&gt; 0) for a
logstable distribution at a value (&gt; 0).</p>
</td></tr>
<tr><td><code id="stableParameters_+3A_quartiles">quartiles</code></td>
<td>
<p>Vector of two quartiles to be matched by a
logstable distribution.</p>
</td></tr>
<tr><td><code id="stableParameters_+3A_tol">tol</code></td>
<td>
<p>Tolerance for matching of quantile or quartiles.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parametrizations used internally by this package are Nolan's &quot;S0&quot;
(or Zolotarev's &quot;M&quot;) parametrization when <code>alpha</code> &gt;= 0.5, and
the Zolotarev's &quot;C&quot; parametrization (which was used by Chambers, Mallows
and Struck (1976) when <code>alpha</code> &lt; 0.5.
</p>
<p>By using objects of class <code>stableParameters</code> to store descriptions
of stable distributions, it will generally be possible to write code in a way
which is not affected by the internal representation.
Such usage is encouraged.
</p>


<h3>Value</h3>

<p>Each of the functions described here produces an object of class
<code>stableParameters</code> which describes a maximally skew stable
distribution.  Its components include at least the shape parameter
<code>alpha</code>, a location parameter referred to as <code>location</code> and
the logarithm of a scale parameter referred to as <code>logscale</code>.  
</p>
<p>Currently objects of this class also store information about how they
were created, as well as storing the numbers 1-<code>alpha</code>
and 2-<code>alpha</code> in order to improve computational precision.</p>


<h3>References</h3>

<p>Chambers, J.M.,  Mallows, C.L. and Stuck, B.W. (1976). A method for
simulating stable random variables. Journal of the American
Statistical Association, Vol. 71, 340&ndash;344.
</p>
<p>Nolan, J.P. (2012). Stable Distributions. ISBN 9780817641597
</p>
<p>Zolotarev, V.M. (1986). One-Dimensional Stable Distributions.
Amer. Math.  Soc. Transl. of Math. Monographs, Vol. 65.  Amer Math. Soc.,
Providence, RI. (Original Russian version was published in 1983.)
</p>


<h3>See Also</h3>

<p>Extremal stable distributions with parameters set up using
these procedures can be used by functions such as
<code><a href="#topic+dEstable">dEstable</a></code>.  The corresponding finite moment log stable
distributions can be dealt with using functions such as <code><a href="#topic+dFMstable">dFMstable</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>setParam(alpha=1.5, location=1, logscale=-.6, pm="M")
setParam(alpha=.4, location=1, logscale=-.6, pm="M")
setMomentsFMstable(alpha=1.7, mean=.5, sd=.2)
fitGivenQuantile(mean=5, sd=1, prob=.001, value=.01, tol=1.e-10)
fitGivenQuantile(mean=20, sd=1, prob=1.e-20, value=1, tol=1.e-24)
matchQuartiles(quartiles=c(9,11), alpha=1.8)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
