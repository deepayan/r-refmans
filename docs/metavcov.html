<!DOCTYPE html><html><head><title>Help for package metavcov</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {metavcov}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#metavcov-package'><p>Computing Variances and Covariances, Visualization and Missing Data Solution for Multivariate Meta Analysis</p></a></li>
<li><a href='#Craft2003'><p>Correlation Coefficients Data from the Craft et al. Meta-Analysis</p></a></li>
<li><a href='#Geeganage2010'><p>Multivariate Effect Sizes of Different Types from the Geeganage et al. Meta-Analysis</p></a></li>
<li><a href='#lgor_lgrr'><p>Computing Covariance between Log Odds Ratio and Log Risk Ratio</p></a></li>
<li><a href='#lgor_rd'><p>Computing Covariance between Log Odds Ratio and Risk Difference</p></a></li>
<li><a href='#lgOR.vcov'><p>Computing Variance-Covariance Matrices for Log Odds Ratios</p></a></li>
<li><a href='#lgrr_rd'><p>Computing Covariance between Log Risk Ratio and Risk Difference</p></a></li>
<li><a href='#lgRR.vcov'><p>Computing Variance-Covariance Matrices for Log Risk Ratios</p></a></li>
<li><a href='#md_lgor'><p>Computing Covariance between Mean Difference and Log Odds Ratio</p></a></li>
<li><a href='#md_lgrr'><p>Computing Covariance between Mean Difference and Log Risk Ratio</p></a></li>
<li><a href='#md_rd'><p>Computing Covariance between Mean Difference and Risk Difference</p></a></li>
<li><a href='#md_smd'><p>Computing Covariance between Mean Difference and Standardized Mean Difference</p></a></li>
<li><a href='#md.vcov'><p>Computing Variance-Covariance Matrices for Mean Differences</p></a></li>
<li><a href='#metafixed'><p>Fitting Fixed-Effect Meta-Analysis Models</p></a></li>
<li><a href='#metami'><p>Multiple Imputation for Missing Data in Meta-Analysis</p></a></li>
<li><a href='#mix.vcov'><p>Computing Variance-Covariance Matrices for Effect Sizes of the Same or Different Types</p></a></li>
<li><a href='#plotCI'><p>Plot Confidence Intervals for a Meta-Analysis</p></a></li>
<li><a href='#r.vcov'><p>Computing Variance-Covariance Matrices for Correlation Coefficients</p></a></li>
<li><a href='#rd.vcov'><p>Computing Variance-Covariance Matrices for Risk Differences</p></a></li>
<li><a href='#smd_lgor'><p>Computing Covariance between Standardized Mean Difference and Log Odds Ratio</p></a></li>
<li><a href='#smd_lgrr'><p>Computing Covariance between Standardized Mean Difference and Log Risk Ratio</p></a></li>
<li><a href='#smd_rd'><p>Computing Covariance between Standardized Mean Difference and Risk Difference</p></a></li>
<li><a href='#smd.vcov'><p>Computing Variance-Covariance Matrices for Standardized Mean Differences</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Computing Variances and Covariances, Visualization and Missing
Data Solution for Multivariate Meta-Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-06-22</td>
</tr>
<tr>
<td>Author:</td>
<td>Min Lu &lt;m.lu6@umiami.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Min Lu &lt;m.lu6@umiami.edu&gt;</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/luminwin/metavcov/issues/new">https://github.com/luminwin/metavcov/issues/new</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0),</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>mixmeta, metaSEM, mvmeta, mice</td>
</tr>
<tr>
<td>Description:</td>
<td>Collection of functions to compute within-study covariances for different effect sizes, data visualization, and single and multiple imputations for missing data. Effect sizes include correlation (r), mean difference (MD), standardized mean difference (SMD), log odds ratio (logOR), log risk ratio (logRR), and risk difference (RD).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/luminwin/metavcov">https://github.com/luminwin/metavcov</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-24 00:23:56 UTC; min</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-24 04:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='metavcov-package'>Computing Variances and Covariances, Visualization and Missing Data Solution for Multivariate Meta Analysis</h2><span id='topic+metavcov-package'></span><span id='topic+metavcov'></span>

<h3>Description</h3>

<p>The package <code>metavcov</code> computes variances and covariances for effect sizes as preparations for multivariate meta-analysis. Effect sizes include correlation (r), mean difference (MD), standardized mean difference (SMD), log odds ratio (logOR), log risk ratio (logRR), and risk difference (RD). Functions for plotting confidence intervals and multiple imputation for missing data are offered. It can fit a fixed-effect model for demonstration purposes; users are highly encouraged to use packages <code>mixmeta</code> and <code>metaSEM</code> for random-effect models. </p>


<h3>Author(s)</h3>

<p>Min Lu (Maintainer,&lt;m.lu6@umiami.edu&gt;)
</p>


<h3>References</h3>

<p>Lu, M. (2023). Computing within-study covariances, data visualization, and missing data solutions for multivariate meta-analysis with metavcov. <em>Frontiers in Psychology</em>, 14:1185012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
###############################################
# Effect size: correlation coefficients
###############################################
data(Craft2003)
# extract correlation from the dataset (craft)
corflat &lt;- subset(Craft2003, select=C1:C6)
# transform correlations to z and compute variance-covariance matrix.
computvcov &lt;- r.vcov(n = Craft2003$N, corflat = corflat, method = "average")
# name transformed z scores as y
y &lt;- computvcov$ef
# name variance-covariance matrix of trnasformed z scores as S
S &lt;- computvcov$matrix.vcov
S[1, ]
## fixed-effect model
MMA_FE &lt;- summary(metafixed(y = y, Slist = computvcov$list.vcov))
MMA_FE
# Restricted maximum likelihood (REML) estimator from the mixmeta package
#library(mixmeta)
#mvmeta_RE &lt;- summary(mixmeta(cbind(C1, C2, C3, C4, C5, C6)~1,
#                           S = S, data = y, method = "reml"))
#mvmeta_RE

# maximum likelihood estimators from the metaSEM package
# library(metaSEM)
# metaSEM_RE &lt;- summary(meta(y = y, v = S))
# metaSEM_RE
# Plotting the result:
obj &lt;- MMA_FE
# obj &lt;- mvmeta_RE
# obj &lt;- metaSEM_RE
# pdf("CI.pdf", width = 4, height = 7)
plotCI(y = computvcov$ef, v = computvcov$list.vcov,
        name.y = NULL, name.study = Craft2003$ID,
        y.all = obj$coefficients[,1],
        y.all.se = obj$coefficients[,2])
# dev.off()
#########################################################################
# Other effect sizes of the same or different type
# Choose variable SBP, DBP, DD, D with effect sizes "MD","MD","RD","lgOR"
#########################################################################
data(Geeganage2010)
## set the correlation coefficients list r
r12 &lt;- 0.71
r13 &lt;- 0.5
r14 &lt;- 0.25
r23 &lt;- 0.6
r24 &lt;- 0.16
r34 &lt;- 0.16
r &lt;- vecTosm(c(r12, r13, r14, r23, r24, r34))
diag(r) &lt;- 1
mix.r &lt;- lapply(1:nrow(Geeganage2010), function(i){r})
attach(Geeganage2010)
## compute variance co-variances
computvcov &lt;- mix.vcov(type = c("MD", "MD", "RD", "lgOR"),
                       d = cbind(MD_SBP, MD_DBP, NA, NA),
                       sdt = cbind(sdt_SBP, sdt_DBP, NA, NA),
                       sdc = cbind(sdc_SBP, sdc_DBP, NA, NA),
                       nt = cbind(nt_SBP, nt_DBP, nt_DD, nt_D),
                       nc = cbind(nc_SBP, nc_DBP, nc_DD, nc_D),
                       st = cbind(NA, NA, st_DD, st_D),
                       sc = cbind(NA, NA, sc_DD, sc_D),
                       r = mix.r,
                       name = c("MD.SBP", "MD.DBP", "RD.DD", "lgOR.D"))
# save different effect sizes in y
y &lt;- computvcov$ef
head(y)
# save variances and covariances of all the effect sizes in a matrix S
S &lt;- computvcov$matrix.vcov
S[1, ]
## fixed-effect model
MMA_FE &lt;- summary(metafixed(y = y, Slist = computvcov$list.vcov))
# Restricted maximum likelihood (REML) estimator from the mixmeta package
# library(mixmeta)
# mvmeta_RE &lt;- summary(mixmeta(cbind(MD.SBP, MD.DBP, RD.DD, lgOR.D) ~1,
#                            S = S, data = y, method = "reml"))
# mvmeta_RE

# maximum likelihood estimators from the metaSEM package
# library(metaSEM)
# metaSEM_RE &lt;- summary(meta(y = y, v = S))
# metaSEM_RE
# Plotting the result:
obj &lt;- MMA_FE
# obj &lt;- mvmeta_RE
# obj &lt;- metaSEM_RE
# pdf("CI.pdf", width = 4, height = 7)
plotCI(y = computvcov$ef, v = computvcov$list.vcov,
        name.y = NULL, name.study = Geeganage2010$studyID,
        y.all = obj$coefficients[,1],
        y.all.se = obj$coefficients[,2],
        hline = c(0, 0, 0, 1))
# dev.off()
#####################################################################################
# Multiple Imputation for missing data
#####################################################################################
# prepare a dataset with missing values and input arguments for meta.mi
Craft2003.mnar &lt;- Craft2003[, c(2, 4:10)]
Craft2003.mnar[sample(which(Craft2003$C4 &lt; 0), 6), "C4"] &lt;- NA
dat &lt;- Craft2003.mnar
n.name &lt;- "N"
ef.name &lt;- c("C1", "C2", "C3", "C4", "C5", "C6")
# fixed-effect model
obj &lt;- metami(dat, M = 2, vcov = "r.vcov",
             n.name, ef.name,
             func = "metafixed")
# Plotting the result
computvcov &lt;- r.vcov(n = Craft2003$N,
                     corflat = subset(Craft2003.mnar, select = C1:C6),
                     method = "average")
plotCI(y = computvcov$ef, v = computvcov$list.vcov,
        name.y = NULL, name.study = Craft2003$ID,
        y.all = obj$coefficients[,1],
        y.all.se = obj$coefficients[,2])
</code></pre>

<hr>
<h2 id='Craft2003'>Correlation Coefficients Data from the Craft et al. Meta-Analysis</h2><span id='topic+Craft2003'></span>

<h3>Description</h3>

<p>This dataset includes 18 studies of correlation coefficients reported by Craft, Magyar, Becker, and
Feltz (2003).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Craft2003)</code></pre>


<h3>Details</h3>

<p>The primary purpose of Craft and colleagues' meta-analysis was to examine the interrelationships between athletic performance and three subscales, cognitive anxiety, somatic anxiety, and self-concept, of the Competitive State Anxiety Inventory (CSAI 2; CITATION). In this meta-analysis, the correlation coefficient was the primary effect size measure. For the purpose of demonstration, I use a subset of the data, i.e., six correlation coefficients among cognitive anxiety, somatic anxiety, self-concept, and sport performance in athletes.
</p>

<table>
<tr>
 <td style="text-align: left;">
ID </td><td style="text-align: left;"> ID for each study included</td>
</tr>
<tr>
 <td style="text-align: left;">
N </td><td style="text-align: left;"> Sample size from each study included</td>
</tr>
<tr>
 <td style="text-align: left;">
gender </td><td style="text-align: left;"> Gender</td>
</tr>
<tr>
 <td style="text-align: left;">
p_male </td><td style="text-align: left;"> Percentage of male </td>
</tr>
<tr>
 <td style="text-align: left;">
C1 </td><td style="text-align: left;"> Correlation coefficient between cognitive anxiety and somatic anxiety </td>
</tr>
<tr>
 <td style="text-align: left;">
C2 </td><td style="text-align: left;"> Correlation coefficient between cognitive anxiety and self concept </td>
</tr>
<tr>
 <td style="text-align: left;">
C3 </td><td style="text-align: left;"> Correlation coefficient between cognitive anxiety and athletic performance </td>
</tr>
<tr>
 <td style="text-align: left;">
C4 </td><td style="text-align: left;"> Correlation coefficient between somatic anxiety and self concept </td>
</tr>
<tr>
 <td style="text-align: left;">
C5 </td><td style="text-align: left;"> Correlation coefficient between somatic anxiety and athletic performance </td>
</tr>
<tr>
 <td style="text-align: left;">
C6 </td><td style="text-align: left;"> Correlation coefficient between self concept and athletic performance </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<h3>Source</h3>

<p>Craft, L. L., Magyar, T. M., Becker, B. J., &amp; Feltz, D. L. (2003). The relationship between the competitive state anxiety inventory-2 and sport performance: a meta-analysis. <em>Journal of Sport and Exercise Psychology, 25</em>(1), 44-65.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(Craft2003)
</code></pre>

<hr>
<h2 id='Geeganage2010'>Multivariate Effect Sizes of Different Types from the Geeganage et al. Meta-Analysis</h2><span id='topic+Geeganage2010'></span>

<h3>Description</h3>

<p>This dataset includes 17 studies of multivariate effect sizes with four different outcomes reported by Geeganage and Bath (2010).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Geeganage2010)</code></pre>


<h3>Details</h3>

<p>In a meta-analysis, Geeganage and Bath (2010) studied whether blood pressure (BP) should be actively altered during the acute phase of stroke, and assessed the effect of multiple vasoactive drugs on BP in acute stroke. Selection criteria included: Randomized trials of interventions that would be expected, on pharmacological grounds, to alter BP in patients within one week of the onset of acute stroke. There were four outcomes: systolic blood pressure (SBP, in mHg), diastolic blood pressure (DBP, in mHg), death (D), and death or disability (DD).
</p>

<table>
<tr>
 <td style="text-align: left;">
ID: </td><td style="text-align: left;"> ID for each study included</td>
</tr>
<tr>
 <td style="text-align: left;">
ft_D </td><td style="text-align: left;">	Number of early death within 1 month (D) in "1 Drug" Group</td>
</tr>
<tr>
 <td style="text-align: left;">
fc_D </td><td style="text-align: left;">	Number of D in "control" Group </td>
</tr>
<tr>
 <td style="text-align: left;">
nt_D </td><td style="text-align: left;">	Number of people in "1 Drug" Group reporting D status </td>
</tr>
<tr>
 <td style="text-align: left;">
nc_D </td><td style="text-align: left;">	Number of people in "control" Group reporting D status </td>
</tr>
<tr>
 <td style="text-align: left;">
OR_D </td><td style="text-align: left;">	Odds ratio of D for "1 Drug" versus "control" group </td>
</tr>
<tr>
 <td style="text-align: left;">
ft_DD </td><td style="text-align: left;">	Number of early death or deterioration within 1 month (DD) in "1 Drug" Group </td>
</tr>
<tr>
 <td style="text-align: left;">
fc_DD </td><td style="text-align: left;">	Number of early DD in "control" Group </td>
</tr>
<tr>
 <td style="text-align: left;">
nt_DD </td><td style="text-align: left;">	Number of people in "1 Drug" Group reporting DD status </td>
</tr>
<tr>
 <td style="text-align: left;">
nc_DD </td><td style="text-align: left;">	Number of people in "control" Group reporting DD status </td>
</tr>
<tr>
 <td style="text-align: left;">
OR_DD </td><td style="text-align: left;">	Odds ratio of DD for "1 Drug" versus "control" group </td>
</tr>
<tr>
 <td style="text-align: left;">
nt_SBP </td><td style="text-align: left;">	Number of people in "1 Drug" Group reporting Systolic blood pressure (SBP) status </td>
</tr>
<tr>
 <td style="text-align: left;">
nc_SBP </td><td style="text-align: left;">	Number of people in "control" Group reporting SBP status </td>
</tr>
<tr>
 <td style="text-align: left;">
MD_SBP </td><td style="text-align: left;">	Mean difference of SBP for "1 Drug" versus "control" group </td>
</tr>
<tr>
 <td style="text-align: left;">
sdt_SBP </td><td style="text-align: left;">	Standard deviation of SBP in "1 Drug" Group </td>
</tr>
<tr>
 <td style="text-align: left;">
sdc_SBP </td><td style="text-align: left;">	Standard deviation of SBP in "control" Group </td>
</tr>
<tr>
 <td style="text-align: left;">
nt_DBP </td><td style="text-align: left;">	Number of people in "1 Drug" Group reporting Diastolic blood pressure (DBP) status </td>
</tr>
<tr>
 <td style="text-align: left;">
nc_DBP </td><td style="text-align: left;">	Number of people in "control" Group reporting DBP status </td>
</tr>
<tr>
 <td style="text-align: left;">
MD_DBP </td><td style="text-align: left;">	Mean difference of DBP for "1 Drug" versus "control" group </td>
</tr>
<tr>
 <td style="text-align: left;">
sdt_DBP </td><td style="text-align: left;">	Standard deviation of DBP in "1 Drug" Group </td>
</tr>
<tr>
 <td style="text-align: left;">
sdc_DBP </td><td style="text-align: left;">	Standard deviation of DBP in "control" Group </td>
</tr>
<tr>
 <td style="text-align: left;">
SMD_SBP </td><td style="text-align: left;">	Standardized mean difference of SBP for "1 Drug" versus "control" group </td>
</tr>
<tr>
 <td style="text-align: left;">
SMD_DBP </td><td style="text-align: left;">	Standardized mean difference of DBP for "1 Drug" versus "control" group </td>
</tr>

</table>



<h3>Source</h3>

<p>Geeganage, C., &amp; Bath, P. M. (2010). Vasoactive drugs for acute stroke. <em>Cochrane Database of Systematic Reviews</em> 2010(7).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(Geeganage2010)
</code></pre>

<hr>
<h2 id='lgor_lgrr'>Computing Covariance between Log Odds Ratio and Log Risk Ratio</h2><span id='topic+lgor_lgrr'></span>

<h3>Description</h3>

<p>The function <code>lgor_lgrr</code> computes covariance between log odds ratio and log risk ratio, when the two outcomes are binary. See <code><a href="#topic+mix.vcov">mix.vcov</a></code> for effect sizes of the same or different types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lgor_lgrr(r, n1c, n2c, n1t, n2t,
          n12c = min(n1c, n2c),
          n12t = min(n1t, n2t),
          s2c, s2t, f2c, f2t, s1c, s1t, f1t, f1c)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lgor_lgrr_+3A_r">r</code></td>
<td>
<p> Correlation coefficient of the two outcomes.</p>
</td></tr>
<tr><td><code id="lgor_lgrr_+3A_n1c">n1c</code></td>
<td>
<p> Number of participants reporting outcome 1 in the control group.</p>
</td></tr>
<tr><td><code id="lgor_lgrr_+3A_n2c">n2c</code></td>
<td>
<p> Number of participants reporting outcome 2 in the control group.</p>
</td></tr>
<tr><td><code id="lgor_lgrr_+3A_n1t">n1t</code></td>
<td>
<p> Number of participants reporting outcome 1 in the treatment group.</p>
</td></tr>
<tr><td><code id="lgor_lgrr_+3A_n2t">n2t</code></td>
<td>
<p> Number of participants reporting outcome 2 in the treatment group.</p>
</td></tr>
<tr><td><code id="lgor_lgrr_+3A_n12c">n12c</code></td>
<td>
<p> Number of participants reporting both outcome 1 and outcome 2 in the control group. By default, it is equal to the smaller number between <code>n1c</code> and <code>n2c</code>.</p>
</td></tr>
<tr><td><code id="lgor_lgrr_+3A_n12t">n12t</code></td>
<td>
<p> Defined in a similar way as <code>n12c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="lgor_lgrr_+3A_s2c">s2c</code></td>
<td>
<p> Number of participants with event for outcome 2 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="lgor_lgrr_+3A_s2t">s2t</code></td>
<td>
<p> Defined in a similar way as <code>s2c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="lgor_lgrr_+3A_f2c">f2c</code></td>
<td>
<p> Number of participants without event for outcome 2 (dichotomous) in the control group. </p>
</td></tr>
<tr><td><code id="lgor_lgrr_+3A_f2t">f2t</code></td>
<td>
<p> Defined in a similar way as <code>f2c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="lgor_lgrr_+3A_s1c">s1c</code></td>
<td>
<p> Number of participants with event for outcome 1 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="lgor_lgrr_+3A_s1t">s1t</code></td>
<td>
<p> Defined in a similar way as <code>s1c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="lgor_lgrr_+3A_f1c">f1c</code></td>
<td>
<p> Number of participants without event for outcome 1 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="lgor_lgrr_+3A_f1t">f1t</code></td>
<td>
<p> Defined in a similar way as <code>f1c</code> for the treatment group. </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>lgor</code></td>
<td>
<p>Log odds ratio for outcome 1.</p>
</td></tr>
<tr><td><code>lgrr</code></td>
<td>
<p>Log risk ratio for outcome 2.</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>Computed covariance.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Min Lu
</p>


<h3>References</h3>

<p>Lu, M. (2023). Computing within-study covariances, data visualization, and missing data solutions for multivariate meta-analysis with metavcov. <em>Frontiers in Psychology</em>, 14:1185012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lgor_lgrr(r = 0.71,
          n1c = 30, n2c = 35, n1t = 28, n2t = 32,
          s2c = 5, s2t = 8, f2c = 30, f2t = 24,
          s1c = 5, s1t = 8, f1c = 25, f1t = 20)
## calculate covariances for variable D and DD in Geeganage2010 data
attach(Geeganage2010)
D_DD &lt;- unlist(lapply(1:nrow(Geeganage2010),
              function(i){lgor_lgrr(r = 0.71, n1c = nc_SBP[i], n2c = nc_DD[i],
                 n1t = nt_SBP[i], n2t = nt_DD[i], s2t = st_DD[i], s2c = sc_DD[i],
                 f2c = nc_DD[i] - sc_DD[i], f2t = nt_DD[i] - st_DD[i],
                 s1t = st_D[i], s1c = sc_D[i],
                 f1c = nc_D[i] - sc_D[i], f1t = nt_D[i] - st_D[i])$v}))
D_DD
## the function mix.vcov() should be used for dataset
</code></pre>

<hr>
<h2 id='lgor_rd'>Computing Covariance between Log Odds Ratio and Risk Difference</h2><span id='topic+lgor_rd'></span>

<h3>Description</h3>

<p>The function <code>lgor_rd</code> computes covariance between log odds ratio and risk difference, when the two outcomes are binary.  See <code><a href="#topic+mix.vcov">mix.vcov</a></code> for effect sizes of the same or different types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lgor_rd(r, n1c, n2c, n1t, n2t,
        n12c = min(n1c, n2c), n12t = min(n1t, n2t),
        s2c, s2t, f2c, f2t, s1c, s1t, f1t, f1c)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lgor_rd_+3A_r">r</code></td>
<td>
<p> Correlation coefficient of the two outcomes.</p>
</td></tr>
<tr><td><code id="lgor_rd_+3A_n1c">n1c</code></td>
<td>
<p> Number of participants reporting outcome 1 in the control group.</p>
</td></tr>
<tr><td><code id="lgor_rd_+3A_n2c">n2c</code></td>
<td>
<p> Number of participants reporting outcome 2 in the control group.</p>
</td></tr>
<tr><td><code id="lgor_rd_+3A_n1t">n1t</code></td>
<td>
<p> Number of participants reporting outcome 1 in the treatment group.</p>
</td></tr>
<tr><td><code id="lgor_rd_+3A_n2t">n2t</code></td>
<td>
<p> Number of participants reporting outcome 2 in the treatment group.</p>
</td></tr>
<tr><td><code id="lgor_rd_+3A_n12c">n12c</code></td>
<td>
<p> Number of participants reporting both outcome 1 and outcome 2 in the control group. By default, it is equal to the smaller number between <code>n1c</code> and <code>n2c</code>.</p>
</td></tr>
<tr><td><code id="lgor_rd_+3A_n12t">n12t</code></td>
<td>
<p> Number defined in a similar way as <code>n12c</code> for treatment group. </p>
</td></tr>
<tr><td><code id="lgor_rd_+3A_s2c">s2c</code></td>
<td>
<p> Number of participants with event for outcome 2 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="lgor_rd_+3A_s2t">s2t</code></td>
<td>
<p> Defined in a similar way as <code>s2c</code> for treatment group. </p>
</td></tr>
<tr><td><code id="lgor_rd_+3A_f2c">f2c</code></td>
<td>
<p> Number of participants without event for outcome 2 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="lgor_rd_+3A_f2t">f2t</code></td>
<td>
<p> Defined in a similar way as <code>f2c</code> for treatment group </p>
</td></tr>
<tr><td><code id="lgor_rd_+3A_s1c">s1c</code></td>
<td>
<p> Number of participants with event for outcome 1 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="lgor_rd_+3A_s1t">s1t</code></td>
<td>
<p> Defined in a similar way as <code>s1c</code> for treatment group. </p>
</td></tr>
<tr><td><code id="lgor_rd_+3A_f1c">f1c</code></td>
<td>
<p> Number of participants without event for outcome 1 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="lgor_rd_+3A_f1t">f1t</code></td>
<td>
<p> Defined in a similar way as <code>f1c</code> for treatment group. </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>lgor</code></td>
<td>
<p>Log odds ratio for outcome 1.</p>
</td></tr>
<tr><td><code>rd</code></td>
<td>
<p>Risk difference for outcome 2.</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>Computed covariance.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Min Lu
</p>


<h3>References</h3>

<p>Lu, M. (2023). Computing within-study covariances, data visualization, and missing data solutions for multivariate meta-analysis with metavcov. <em>Frontiers in Psychology</em>, 14:1185012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## simple example
lgor_rd(r = 0.71, n1c = 30, n2c = 35, n1t = 28, n2t = 32,
        s2c = 5, s2t = 8, f2c = 30, f2t = 24,
        s1c = 5, s1t = 8, f1c = 25, f1t = 20)
## calculate covariances for variable D and DD in Geeganage2010 data
attach(Geeganage2010)
D_DD &lt;- unlist(lapply(1:nrow(Geeganage2010), function(i){lgor_rd(r = 0.71,
              n1c = nc_SBP[i], n2c = nc_DD[i],
              n1t = nt_SBP[i], n2t = nt_DD[i], s2t = st_DD[i], s2c = sc_DD[i],
              f2c = nc_DD[i] - sc_DD[i], f2t = nt_DD[i] - st_DD[i],
              s1t = st_D[i], s1c = sc_D[i],
              f1c = nc_D[i] - sc_D[i], f1t = nt_D[i] - st_D[i])$v}))
D_DD
## the function mix.vcov() should be used for dataset
</code></pre>

<hr>
<h2 id='lgOR.vcov'>Computing Variance-Covariance Matrices for Log Odds Ratios</h2><span id='topic+lgOR.vcov'></span>

<h3>Description</h3>

<p>The function <code>lgOR.vcov</code> computes effect sizes and variance-covariance matrix for multivariate meta-analysis when the effect sizes of interest are all measured by log odds ratio. See <code><a href="#topic+mix.vcov">mix.vcov</a></code> for effect sizes of the same or different types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lgOR.vcov(r, nt, nc, st, sc, n_rt = NA, n_rc = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lgOR.vcov_+3A_r">r</code></td>
<td>
<p> A <code class="reqn">N</code>-dimensional list of <code class="reqn">p \times p</code> correlation matrices for the <code class="reqn">p</code> outcomes from the <code class="reqn">N</code> studies. <code>r[[k]][i,j]</code> is the correlation coefficient between outcome <code class="reqn">i</code> and outcome <code class="reqn">j</code> from study <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code id="lgOR.vcov_+3A_nt">nt</code></td>
<td>
<p> A <code class="reqn">N \times p</code> matrix storing sample sizes in the treatment group reporting the  <code class="reqn">p</code> outcomes. <code>nt[i,j]</code> is the sample size from study <code class="reqn">i</code> reporting outcome <code class="reqn">j</code>.</p>
</td></tr>
<tr><td><code id="lgOR.vcov_+3A_nc">nc</code></td>
<td>
<p> A matrix defined in a similar way as <code>nt</code> for the control group.</p>
</td></tr>
<tr><td><code id="lgOR.vcov_+3A_st">st</code></td>
<td>
<p> A <code class="reqn">N \times p</code> matrix recording number of participants with event for all outcomes (dichotomous) in treatment group. <code>st[i,j]</code> reports number of participants with event for outcome <code class="reqn">j</code> in treatment group for study <code class="reqn">i</code>. If outcome <code class="reqn">j</code> is not dichotomous, NA has to be imputed in column <code class="reqn">j</code>.</p>
</td></tr>
<tr><td><code id="lgOR.vcov_+3A_sc">sc</code></td>
<td>
<p> Defined in a similar way as <code>st</code> for the control group.</p>
</td></tr>
<tr><td><code id="lgOR.vcov_+3A_n_rt">n_rt</code></td>
<td>
<p>A <code class="reqn">N</code>-dimensional list of <code class="reqn">p \times p</code> matrices storing sample sizes in the treatment group reporting pairwise outcomes in the off-diagonal elements. <code>n_rt[[k]][i,j]</code> is the sample size reporting both outcome <code class="reqn">i</code> and outcome <code class="reqn">j</code> from study <code class="reqn">k</code>. Diagonal elements of these matrices are discarded. The default value is <code>NA</code>, which means that the smaller sample size reporting the corresponding two outcomes is imputed: i.e. <code>n_rt[[k]][i,j]=min(nt[k,i],nt[k,j])</code>. </p>
</td></tr>
<tr><td><code id="lgOR.vcov_+3A_n_rc">n_rc</code></td>
<td>
<p> A list defined in a similar way as <code>n_rt</code> for the control group.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>ef</code></td>
<td>
<p>A <code class="reqn">N \times p</code> data frame whose columns are computed log odds ratios.</p>
</td></tr>
<tr><td><code>list.vcov</code></td>
<td>
<p> A <code class="reqn">N</code>-dimensional list of <code class="reqn">p(p+1)/2 \times p(p+1)/2</code> matrices of computed variance-covariance matrices.</p>
</td></tr>
<tr><td><code>matrix.vcov</code></td>
<td>
<p> A <code class="reqn">N \times p(p+1)/2</code> matrix whose rows are computed variance-covariance vectors.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Min Lu
</p>


<h3>References</h3>

<p>Lu, M. (2023). Computing within-study covariances, data visualization, and missing data solutions for multivariate meta-analysis with metavcov. <em>Frontiers in Psychology</em>, 14:1185012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##########################################################################
# Example: Geeganage2010 data
# Preparing log odds ratios and covariances for multivariate meta-analysis
##########################################################################
data(Geeganage2010)
## set the correlation coefficients list r
r12 &lt;- 0.71
r.Gee &lt;- lapply(1:nrow(Geeganage2010), function(i){matrix(c(1, r12, r12, 1), 2, 2)})


computvcov &lt;- lgOR.vcov(nt = subset(Geeganage2010, select = c(nt_DD, nt_D)),
                     nc = subset(Geeganage2010, select = c(nc_DD, nc_D)),
                     st = subset(Geeganage2010, select = c(st_DD, st_D)),
                     sc = subset(Geeganage2010, select = c(sc_DD, sc_D)),
                     r = r.Gee)
# name computed log odds ratio as y
y &lt;- computvcov$ef
colnames(y) &lt;- c("lgOR.DD", "lgOR.D")
# name variance-covariance matrix of trnasformed z scores as S
S &lt;- computvcov$matrix.vcov
## fixed-effect model
MMA_FE &lt;- summary(metafixed(y = y, Slist = computvcov$list.vcov))
MMA_FE
#######################################################################
# Running random-effects model using package "mixmeta" or "metaSEM"
#######################################################################
# Restricted maximum likelihood (REML) estimator from the mixmeta package
#library(mixmeta)
#mvmeta_RE &lt;- summary(mixmeta(cbind(lgOR.DD, lgOR.D)~1,
#                            S = S,
#                            data = as.data.frame(y),
#                            method = "reml"))
#mvmeta_RE

# maximum likelihood estimators from the metaSEM package
# library(metaSEM)
# metaSEM_RE &lt;- summary(meta(y = y, v = S))
# metaSEM_RE
##############################################################
# Plotting the result:
##############################################################
obj &lt;- MMA_FE
# obj &lt;- mvmeta_RE
# obj &lt;- metaSEM_RE
# pdf("CI.pdf", width = 4, height = 7)
plotCI(y = computvcov$ef, v = computvcov$list.vcov,
        name.y = c("lgOR.DD", "lgOR.D"),
        name.study = Geeganage2010$studyID,
        y.all = obj$coefficients[,1],
        y.all.se = obj$coefficients[,2],
        hline = 1)
# dev.off()
</code></pre>

<hr>
<h2 id='lgrr_rd'>Computing Covariance between Log Risk Ratio and Risk Difference</h2><span id='topic+lgrr_rd'></span>

<h3>Description</h3>

<p>The function <code>lgrr_rd</code> compute covariance between log risk ratio and risk difference, when the two outcomes are binary. See <code><a href="#topic+mix.vcov">mix.vcov</a></code> for effect sizes of the same or different types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lgrr_rd(r, n1c, n2c, n1t, n2t,
        n12c = min(n1c, n2c),
        n12t = min(n1t, n2t),
        s2c, s2t, f2c, f2t,
        s1c, s1t, f1c, f1t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lgrr_rd_+3A_r">r</code></td>
<td>
<p> Correlation coefficient of the two outcomes.</p>
</td></tr>
<tr><td><code id="lgrr_rd_+3A_n1c">n1c</code></td>
<td>
<p> Number of participants reporting outcome 1 in the control group.</p>
</td></tr>
<tr><td><code id="lgrr_rd_+3A_n2c">n2c</code></td>
<td>
<p> Number of participants reporting outcome 2 in the control group.</p>
</td></tr>
<tr><td><code id="lgrr_rd_+3A_n1t">n1t</code></td>
<td>
<p> Number of participants reporting outcome 1 in the treatment group.</p>
</td></tr>
<tr><td><code id="lgrr_rd_+3A_n2t">n2t</code></td>
<td>
<p> Number of participants reporting outcome 2 in the treatment group.</p>
</td></tr>
<tr><td><code id="lgrr_rd_+3A_n12c">n12c</code></td>
<td>
<p> Number of participants reporting both outcome 1 and outcome 2 in the control group. By default, it is equal to the smaller number between <code>n1c</code> and <code>n2c</code>.</p>
</td></tr>
<tr><td><code id="lgrr_rd_+3A_n12t">n12t</code></td>
<td>
<p> Defined in a similar way as <code>n12c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="lgrr_rd_+3A_s2c">s2c</code></td>
<td>
<p> Number of participants with event for outcome 2 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="lgrr_rd_+3A_s2t">s2t</code></td>
<td>
<p> Defined in a similar way as <code>s2c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="lgrr_rd_+3A_f2c">f2c</code></td>
<td>
<p> Number of participants without event for outcome 2 (dichotomous) in the control group. </p>
</td></tr>
<tr><td><code id="lgrr_rd_+3A_f2t">f2t</code></td>
<td>
<p> Defined in a similar way as <code>f2c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="lgrr_rd_+3A_s1c">s1c</code></td>
<td>
<p> Number of participants with event for outcome 1 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="lgrr_rd_+3A_s1t">s1t</code></td>
<td>
<p> Defined in a similar way as <code>s1c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="lgrr_rd_+3A_f1c">f1c</code></td>
<td>
<p> Number of participants without event for outcome 1 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="lgrr_rd_+3A_f1t">f1t</code></td>
<td>
<p> Defined in a similar way as <code>f1c</code> for the treatment group. </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>lgrr</code></td>
<td>
<p>Log risk ratio for outcome 1.</p>
</td></tr>
<tr><td><code>rd</code></td>
<td>
<p>Risk difference for outcome 1.</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>Computed covariance.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Min Lu
</p>


<h3>References</h3>

<p>Lu, M. (2023). Computing within-study covariances, data visualization, and missing data solutions for multivariate meta-analysis with metavcov. <em>Frontiers in Psychology</em>, 14:1185012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## simple example
lgrr_rd(r = 0.71, n1c = 30, n2c = 35, n1t = 28, n2t = 32,
        s2c = 5, s2t = 8, f2c = 30, f2t = 24,
        s1c = 5, s1t = 8, f1c = 25, f1t = 20)
## calculate covariances for variable D and DD in Geeganage2010 data
attach(Geeganage2010)
D_DD &lt;- unlist(lapply(1:nrow(Geeganage2010), function(i){lgrr_rd(r = 0.71,
        n1c = nc_SBP[i], n2c = nc_DD[i],
        n1t = nt_SBP[i], n2t = nt_DD[i], s2t = st_DD[i], s2c = sc_DD[i],
        f2c = nc_DD[i] - sc_DD[i], f2t = nt_DD[i] - st_DD[i],
        s1t = st_D[i], s1c = sc_D[i], f1c = nc_D[i] - sc_D[i], f1t = nt_D[i] - st_D[i])$v}))
D_DD
## the function mix.vcov() should be used for dataset
</code></pre>

<hr>
<h2 id='lgRR.vcov'>Computing Variance-Covariance Matrices for Log Risk Ratios</h2><span id='topic+lgRR.vcov'></span>

<h3>Description</h3>

<p>The function <code>lgOR.vcov</code> computes effect sizes and variance-covariance matrix for multivariate meta-analysis when the effect sizes of interest are all measured by log risk ratio (or log relative risk). See <code><a href="#topic+mix.vcov">mix.vcov</a></code> for effect sizes of the same or different types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lgRR.vcov(r, nt, nc, st, sc, n_rt = NA, n_rc = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lgRR.vcov_+3A_r">r</code></td>
<td>
<p> A <code class="reqn">N</code>-dimensional list of <code class="reqn">p \times p</code> correlation matrices for the <code class="reqn">p</code> outcomes from the <code class="reqn">N</code> studies. <code>r[[k]][i,j]</code> is the correlation coefficient between outcome <code class="reqn">i</code> and outcome <code class="reqn">j</code> from study <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code id="lgRR.vcov_+3A_nt">nt</code></td>
<td>
<p> A <code class="reqn">N \times p</code> matrix storing sample sizes in the treatment group reporting the  <code class="reqn">p</code> outcomes. <code>nt[i,j]</code> is the sample size from study <code class="reqn">i</code> reporting outcome <code class="reqn">j</code>.</p>
</td></tr>
<tr><td><code id="lgRR.vcov_+3A_nc">nc</code></td>
<td>
<p> A matrix defined in a similar way as <code>nt</code> for the control group.</p>
</td></tr>
<tr><td><code id="lgRR.vcov_+3A_st">st</code></td>
<td>
<p> A <code class="reqn">N \times p</code> matrix recording number of participants with event for all outcomes (dichotomous) in treatment group. <code>st[i,j]</code> reports number of participants with event for outcome <code class="reqn">j</code> in treatment group for study <code class="reqn">i</code>. If outcome <code class="reqn">j</code> is not dichotomous, NA has to be imputed in column <code class="reqn">j</code>.</p>
</td></tr>
<tr><td><code id="lgRR.vcov_+3A_sc">sc</code></td>
<td>
<p> Defined in a similar way as <code>st</code> for the control group.</p>
</td></tr>
<tr><td><code id="lgRR.vcov_+3A_n_rt">n_rt</code></td>
<td>
<p>A <code class="reqn">N</code>-dimensional list of <code class="reqn">p \times p</code> matrices storing sample sizes in the treatment group reporting pairwise outcomes in the off-diagonal elements. <code>n_rt[[k]][i,j]</code> is the sample size reporting both outcome <code class="reqn">i</code> and outcome <code class="reqn">j</code> from study <code class="reqn">k</code>. Diagonal elements of these matrices are discarded. The default value is <code>NA</code>, which means that the smaller sample size reporting the corresponding two outcomes is imputed: i.e. <code>n_rt[[k]][i,j]=min(nt[k,i],nt[k,j])</code>. </p>
</td></tr>
<tr><td><code id="lgRR.vcov_+3A_n_rc">n_rc</code></td>
<td>
<p> A list defined in a similar way as <code>n_rt</code> for the control group.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>ef</code></td>
<td>
<p>A <code class="reqn">N \times p</code> data frame whose columns are computed log risk ratios.</p>
</td></tr>
<tr><td><code>list.vcov</code></td>
<td>
<p> A <code class="reqn">N</code>-dimensional list of <code class="reqn">p(p+1)/2 \times p(p+1)/2</code> matrices of computed variance-covariance matrices.</p>
</td></tr>
<tr><td><code>matrix.vcov</code></td>
<td>
<p> A <code class="reqn">N \times p(p+1)/2</code> matrix whose rows are computed variance-covariance vectors.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Min Lu
</p>


<h3>References</h3>

<p>Lu, M. (2023). Computing within-study covariances, data visualization, and missing data solutions for multivariate meta-analysis with metavcov. <em>Frontiers in Psychology</em>, 14:1185012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##########################################################################
# Example: Geeganage2010 data
# Preparing log risk ratios and covariances for multivariate meta-analysis
##########################################################################
data(Geeganage2010)
## set the correlation coefficients list r
r12 &lt;- 0.71
r.Gee &lt;- lapply(1:nrow(Geeganage2010), function(i){matrix(c(1, r12, r12, 1), 2, 2)})


computvcov &lt;- lgRR.vcov(nt = subset(Geeganage2010, select = c(nt_DD, nt_D)),
                      nc = subset(Geeganage2010, select = c(nc_DD, nc_D)),
                      st = subset(Geeganage2010, select=c(st_DD, st_D)),
                      sc = subset(Geeganage2010, select=c(sc_DD, sc_D)),
                      r = r.Gee)
# name computed log risk ratio as y
y &lt;- computvcov$ef
colnames(y) = c("lgRR.DD", "lgRR.D")
# name variance-covariance matrix of trnasformed z scores as covars
S &lt;- computvcov$matrix.vcov
## fixed-effect model
MMA_FE &lt;- summary(metafixed(y = y, Slist = computvcov$list.vcov))
MMA_FE
#######################################################################
# Running random-effects model using package "mixmeta" or "metaSEM"
#######################################################################
#library(mixmeta)
#mvmeta_RE = summary(mixmeta(cbind(lgRR.DD, lgRR.D)~1,
#                            S = S, data = as.data.frame(y),
#                            method = "reml"))
#mvmeta_RE

# maximum likelihood estimators from the metaSEM package
# library(metaSEM)
# metaSEM_RE &lt;- summary(meta(y = y, v = S))
# metaSEM_RE
##############################################################
# Plotting the result:
##############################################################
obj &lt;- MMA_FE
# obj &lt;- mvmeta_RE
# obj &lt;- metaSEM_RE
# pdf("CI.pdf", width = 4, height = 7)
plotCI(y = computvcov$ef, v = computvcov$list.vcov,
        name.y = c("lgRR.DD", "lgRR.D"),
        name.study = Geeganage2010$studyID,
        y.all = obj$coefficients[,1],
        y.all.se = obj$coefficients[,2],
        hline = 1)
# dev.off()
</code></pre>

<hr>
<h2 id='md_lgor'>Computing Covariance between Mean Difference and Log Odds Ratio</h2><span id='topic+md_lgor'></span>

<h3>Description</h3>

<p>The function <code>lgor_rd</code> computes covariance between mean difference and log odds ratio.  See <code><a href="#topic+mix.vcov">mix.vcov</a></code> for effect sizes of the same or different types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md_lgor(r, n1c, n2c, n1t, n2t,
        n12c = min(n1c, n2c), n12t = min(n1t, n2t),
        s2c, s2t, f2c, f2t, sd1c, sd1t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md_lgor_+3A_r">r</code></td>
<td>
<p> Correlation coefficient of the two outcomes.</p>
</td></tr>
<tr><td><code id="md_lgor_+3A_n1c">n1c</code></td>
<td>
<p> Number of participants reporting outcome 1 in the control group.</p>
</td></tr>
<tr><td><code id="md_lgor_+3A_n2c">n2c</code></td>
<td>
<p> Number of participants reporting outcome 2 in the control group.</p>
</td></tr>
<tr><td><code id="md_lgor_+3A_n1t">n1t</code></td>
<td>
<p> Number of participants reporting outcome 1 in the treatment group.</p>
</td></tr>
<tr><td><code id="md_lgor_+3A_n2t">n2t</code></td>
<td>
<p> Number of participants reporting outcome 2 in the treatment group.</p>
</td></tr>
<tr><td><code id="md_lgor_+3A_n12c">n12c</code></td>
<td>
<p> Number of participants reporting both outcome 1 and outcome 2 in the control group. By default, it is equal to the smaller number between <code>n1c</code> and <code>n2c</code>.</p>
</td></tr>
<tr><td><code id="md_lgor_+3A_n12t">n12t</code></td>
<td>
<p> Number defined in a similar way as <code>n12c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="md_lgor_+3A_s2c">s2c</code></td>
<td>
<p> Number of participants with event for outcome 2 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="md_lgor_+3A_s2t">s2t</code></td>
<td>
<p> Defined in a similar way as <code>s2c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="md_lgor_+3A_f2c">f2c</code></td>
<td>
<p> Number of participants without event for outcome 2 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="md_lgor_+3A_f2t">f2t</code></td>
<td>
<p> Defined in a similar way as <code>f2c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="md_lgor_+3A_sd1c">sd1c</code></td>
<td>
<p> Sample standard deviation of outcome 1 for the control group.</p>
</td></tr>
<tr><td><code id="md_lgor_+3A_sd1t">sd1t</code></td>
<td>
<p> Defined in a similar way as <code>sd1c</code> for the treatment group.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>lgor</code></td>
<td>
<p>Log odds ratio for outcome 2.</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>Computed covariance.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Min Lu
</p>


<h3>References</h3>

<p>Lu, M. (2023). Computing within-study covariances, data visualization, and missing data solutions for multivariate meta-analysis with metavcov. <em>Frontiers in Psychology</em>, 14:1185012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## a simple example
md_lgor(r = 0.71, n1c = 34, n2c = 35, n1t = 25, n2t = 32,
        s2c = 5, s2t = 8, f2c = 30, f2t = 24, sd1t = 0.4, sd1c = 8)
## calculate covariances for variable SBP and DD in Geeganage2010 data
attach(Geeganage2010)
SBP_DD &lt;- unlist(lapply(1:nrow(Geeganage2010), function(i){md_lgor(r = 0.71,
               n1c = nc_SBP[i], n2c = nc_DD[i], n1t = nt_SBP[i], n2t = nt_DD[i],
               sd1t = sdt_SBP[i], s2t = st_DD[i], sd1c = sdc_SBP[i], s2c = sc_DD[i],
               f2c = nc_DD[i] - sc_DD[i], f2t = nt_DD[i] - st_DD[i])$v}))
SBP_DD
## the function mix.vcov() should be used for dataset
</code></pre>

<hr>
<h2 id='md_lgrr'>Computing Covariance between Mean Difference and Log Risk Ratio</h2><span id='topic+md_lgrr'></span>

<h3>Description</h3>

<p>The function <code>md_lgrr</code> computes covariance between mean difference and log risk ratio.  See <code><a href="#topic+mix.vcov">mix.vcov</a></code> for effect sizes of the same or different types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md_lgrr(r, n1c, n2c, n1t, n2t,
        n12c = min(n1c, n2c), n12t = min(n1t, n2t),
        s2c, s2t, f2c, f2t, sd1c, sd1t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md_lgrr_+3A_r">r</code></td>
<td>
<p> Correlation coefficient of the two outcomes.</p>
</td></tr>
<tr><td><code id="md_lgrr_+3A_n1c">n1c</code></td>
<td>
<p> Number of participants reporting outcome 1 in the control group.</p>
</td></tr>
<tr><td><code id="md_lgrr_+3A_n2c">n2c</code></td>
<td>
<p> Number of participants reporting outcome 2 in the control group.</p>
</td></tr>
<tr><td><code id="md_lgrr_+3A_n1t">n1t</code></td>
<td>
<p> Number of participants reporting outcome 1 in the treatment group.</p>
</td></tr>
<tr><td><code id="md_lgrr_+3A_n2t">n2t</code></td>
<td>
<p> Number of participants reporting outcome 2 in the treatment group.</p>
</td></tr>
<tr><td><code id="md_lgrr_+3A_n12c">n12c</code></td>
<td>
<p> Number of participants reporting both outcome 1 and outcome 2 in the control group. By default, it is equal to the smaller number between <code>n1c</code> and <code>n2c</code>.</p>
</td></tr>
<tr><td><code id="md_lgrr_+3A_n12t">n12t</code></td>
<td>
<p> Number defined in a similar way as <code>n12c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="md_lgrr_+3A_s2c">s2c</code></td>
<td>
<p> Number of participants with event for outcome 2 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="md_lgrr_+3A_s2t">s2t</code></td>
<td>
<p> Defined in a similar way as <code>s2c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="md_lgrr_+3A_f2c">f2c</code></td>
<td>
<p> Number of participants without event for outcome 2 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="md_lgrr_+3A_f2t">f2t</code></td>
<td>
<p> Defined in a similar way as <code>f2c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="md_lgrr_+3A_sd1c">sd1c</code></td>
<td>
<p> Sample standard deviation of outcome 1 for the control group.</p>
</td></tr>
<tr><td><code id="md_lgrr_+3A_sd1t">sd1t</code></td>
<td>
<p> Defined in a similar way as <code>sd1c</code> for the treatment group.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>lgrr</code></td>
<td>
<p>Log risk ratio for outcome 2.</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>Computed covariance.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Min Lu
</p>


<h3>References</h3>

<p>Lu, M. (2023). Computing within-study covariances, data visualization, and missing data solutions for multivariate meta-analysis with metavcov. <em>Frontiers in Psychology</em>, 14:1185012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## a simple example
md_lgrr(r = 0.71, n1c = 34, n2c = 35, n1t = 25, n2t = 32,
        s2c = 5, s2t = 8, f2c = 30, f2t = 24, sd1t = 0.4, sd1c = 8)
## calculate covariances for variable SBP and DD in Geeganage2010 data
attach(Geeganage2010)
SBP_DD &lt;- unlist(lapply(1:nrow(Geeganage2010), function(i){md_lgrr(r = 0.71,
                n1c = nc_SBP[i], n2c = nc_DD[i], n1t = nt_SBP[i], n2t = nt_DD[i],
                sd1t = sdt_SBP[i], s2t = st_DD[i], sd1c = sdc_SBP[i], s2c = sc_DD[i],
                f2c = nc_DD[i] - sc_DD[i], f2t = nt_DD[i] - st_DD[i])$v}))
SBP_DD
## the function mix.vcov() should be used for dataset
</code></pre>

<hr>
<h2 id='md_rd'>Computing Covariance between Mean Difference and Risk Difference</h2><span id='topic+md_rd'></span>

<h3>Description</h3>

<p>The function <code>lgor_rd</code> computes covariance between mean difference and risk difference.  See <code><a href="#topic+mix.vcov">mix.vcov</a></code> for effect sizes of the same or different types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md_rd(r, n1c, n2c, n1t, n2t,
      n12c = min(n1c, n2c), n12t = min(n1t, n2t),
      s2c, s2t, f2c, f2t, sd1c, sd1t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md_rd_+3A_r">r</code></td>
<td>
<p> Correlation coefficient of the two outcomes.</p>
</td></tr>
<tr><td><code id="md_rd_+3A_n1c">n1c</code></td>
<td>
<p> Number of participants reporting outcome 1 in the control group.</p>
</td></tr>
<tr><td><code id="md_rd_+3A_n2c">n2c</code></td>
<td>
<p> Number of participants reporting outcome 2 in the control group.</p>
</td></tr>
<tr><td><code id="md_rd_+3A_n1t">n1t</code></td>
<td>
<p> Number of participants reporting outcome 1 in the treatment group.</p>
</td></tr>
<tr><td><code id="md_rd_+3A_n2t">n2t</code></td>
<td>
<p> Number of participants reporting outcome 2 in the treatment group.</p>
</td></tr>
<tr><td><code id="md_rd_+3A_n12c">n12c</code></td>
<td>
<p> Number of participants reporting both outcome 1 and outcome 2 in the control group. By default, it is equal to the smaller number between <code>n1c</code> and <code>n2c</code>.</p>
</td></tr>
<tr><td><code id="md_rd_+3A_n12t">n12t</code></td>
<td>
<p> Number defined in a similar way as <code>n12c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="md_rd_+3A_s2c">s2c</code></td>
<td>
<p> Number of participants with event for outcome 2 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="md_rd_+3A_s2t">s2t</code></td>
<td>
<p> Defined in a similar way as <code>s2c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="md_rd_+3A_f2c">f2c</code></td>
<td>
<p> Number of participants without event for outcome 2 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="md_rd_+3A_f2t">f2t</code></td>
<td>
<p> Defined in a similar way as <code>f2c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="md_rd_+3A_sd1c">sd1c</code></td>
<td>
<p> Sample standard deviation of outcome 1 for the control group.</p>
</td></tr>
<tr><td><code id="md_rd_+3A_sd1t">sd1t</code></td>
<td>
<p> Defined in a similar way as <code>sd1c</code> for the treatment group.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>rd</code></td>
<td>
<p>Computed risk difference for outcome 2.</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>Computed covariance.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Min Lu
</p>


<h3>References</h3>

<p>Lu, M. (2023). Computing within-study covariances, data visualization, and missing data solutions for multivariate meta-analysis with metavcov. <em>Frontiers in Psychology</em>, 14:1185012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## a simple example
md_rd(r = 0.71, n1c = 34, n2c = 35, n1t = 25, n2t = 32,
      s2c = 5, s2t = 8, f2c = 30, f2t = 24, sd1t = 0.4, sd1c = 8)
## calculate covariances for variable SBP and DD in Geeganage2010 data
attach(Geeganage2010)
SBP_DD &lt;- unlist(lapply(1:nrow(Geeganage2010), function(i){md_rd(r = 0.71,
               n1c = nc_SBP[i], n2c = nc_DD[i], n1t = nt_SBP[i], n2t = nt_DD[i],
               sd1t = sdt_SBP[i], s2t = st_DD[i], sd1c = sdc_SBP[i], s2c = sc_DD[i],
               f2c = nc_DD[i] - sc_DD[i], f2t = nt_DD[i] - st_DD[i])$v}))
SBP_DD
## the function mix.vcov() should be used for dataset
</code></pre>

<hr>
<h2 id='md_smd'>Computing Covariance between Mean Difference and Standardized Mean Difference</h2><span id='topic+md_smd'></span>

<h3>Description</h3>

<p>The function <code>lgor_rd</code> computes covariance between mean difference and standardized mean difference.  See <code><a href="#topic+mix.vcov">mix.vcov</a></code> for effect sizes of the same or different types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md_smd(smd, r, n1c, n2c, n1t, n2t,
       n12c = min(n1c, n2c), n12t = min(n1t, n2t),
       sd1t, sd2t, sd1c, sd2c)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md_smd_+3A_smd">smd</code></td>
<td>
<p> Standardized mean difference for outcome 2.</p>
</td></tr>
<tr><td><code id="md_smd_+3A_r">r</code></td>
<td>
<p> Correlation coefficient of the two outcomes.</p>
</td></tr>
<tr><td><code id="md_smd_+3A_n1c">n1c</code></td>
<td>
<p> Number of participants reporting outcome 1 in the control group.</p>
</td></tr>
<tr><td><code id="md_smd_+3A_n2c">n2c</code></td>
<td>
<p> Number of participants reporting outcome 2 in the control group.</p>
</td></tr>
<tr><td><code id="md_smd_+3A_n1t">n1t</code></td>
<td>
<p> Number of participants reporting outcome 1 in the treatment group.</p>
</td></tr>
<tr><td><code id="md_smd_+3A_n2t">n2t</code></td>
<td>
<p> Number of participants reporting outcome 2 in the treatment group.</p>
</td></tr>
<tr><td><code id="md_smd_+3A_n12c">n12c</code></td>
<td>
<p> Number of participants reporting both outcome 1 and outcome 2 in the control group. By default, it is equal to the smaller number between <code>n1c</code> and <code>n2c</code>.</p>
</td></tr>
<tr><td><code id="md_smd_+3A_n12t">n12t</code></td>
<td>
<p> Number defined in a similar way as <code>n12c</code> for treatment group. </p>
</td></tr>
<tr><td><code id="md_smd_+3A_sd1t">sd1t</code></td>
<td>
<p> Sample standard deviation of outcome 1 for the treatment group.</p>
</td></tr>
<tr><td><code id="md_smd_+3A_sd2t">sd2t</code></td>
<td>
<p> Sample standard deviation of outcome 2 for the treatment group.</p>
</td></tr>
<tr><td><code id="md_smd_+3A_sd1c">sd1c</code></td>
<td>
<p> Defined in a similar way as <code>sd1t</code> for the control group.</p>
</td></tr>
<tr><td><code id="md_smd_+3A_sd2c">sd2c</code></td>
<td>
<p> Defined in a similar way as <code>sd2t</code> for the control group.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>g</code></td>
<td>
<p>Computed Hedge's g from the input argument smd for outcome 2.</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>Computed covariance.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Min Lu
</p>


<h3>References</h3>

<p>Lu, M. (2023). Computing within-study covariances, data visualization, and missing data solutions for multivariate meta-analysis with metavcov. <em>Frontiers in Psychology</em>, 14:1185012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## a simple example
md_smd(smd = 1, r = 0.71, n1c = 34, n2c = 35, n1t = 25, n2t = 32,
       sd1t = 0.6, sd2t = 0.4, sd1c = 8, sd2c = 0.9)
## calculate covariances for variable SBP and DBP in Geeganage2010 data
attach(Geeganage2010)
SBP_DBP &lt;- unlist(lapply(1:nrow(Geeganage2010), function(i){md_smd(smd = SMD_DBP, r = 0.71,
                n1c = nc_SBP[i], n2c = nc_DBP[i], n1t = nt_SBP[i], n2t = nt_DBP[i],
                sd1t = sdt_SBP[i], sd2t = sdt_DBP[i],
                sd1c = sdc_SBP[i], sd2c = sdc_SBP[i])$v}))
SBP_DBP
## the function mix.vcov() should be used for dataset
</code></pre>

<hr>
<h2 id='md.vcov'>Computing Variance-Covariance Matrices for Mean Differences</h2><span id='topic+md.vcov'></span>

<h3>Description</h3>

<p>The function <code>md.vcov</code> computes effect sizes and variance-covariance matrix for multivariate meta-analysis when the effect sizes of interest are all measured by mean difference. See <code><a href="#topic+mix.vcov">mix.vcov</a></code> for effect sizes of the same or different types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.vcov(r, nt, nc, n_rt = NA, n_rc = NA, sdt, sdc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.vcov_+3A_r">r</code></td>
<td>
<p> A <code class="reqn">N</code>-dimensional list of <code class="reqn">p \times p</code> correlation matrices for the <code class="reqn">p</code> outcomes from the <code class="reqn">N</code> studies. <code>r[[k]][i,j]</code> is the correlation coefficient between outcome <code class="reqn">i</code> and outcome <code class="reqn">j</code> from study <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code id="md.vcov_+3A_nt">nt</code></td>
<td>
<p> A <code class="reqn">N \times p</code> matrix storing sample sizes in the treatment group reporting the  <code class="reqn">p</code> outcomes. <code>nt[i,j]</code> is the sample size from study <code class="reqn">i</code> reporting outcome <code class="reqn">j</code>.</p>
</td></tr>
<tr><td><code id="md.vcov_+3A_nc">nc</code></td>
<td>
<p> A matrix defined in a similar way as <code>nt</code> for the control group.</p>
</td></tr>
<tr><td><code id="md.vcov_+3A_n_rt">n_rt</code></td>
<td>
<p>A <code class="reqn">N</code>-dimensional list of <code class="reqn">p \times p</code> matrices storing sample sizes in the treatment group reporting pairwise outcomes in the off-diagonal elements. <code>n_rt[[k]][i,j]</code> is the sample size reporting both outcome <code class="reqn">i</code> and outcome <code class="reqn">j</code> from study <code class="reqn">k</code>. Diagonal elements of these matrices are discarded. The default value is <code>NA</code>, which means that the smaller sample size reporting the corresponding two outcomes is imputed: i.e. <code>n_rt[[k]][i,j]=min(nt[k,i],nt[k,j])</code>. </p>
</td></tr>
<tr><td><code id="md.vcov_+3A_n_rc">n_rc</code></td>
<td>
<p> A list defined in a similar way as <code>n_rt</code> for the control group.</p>
</td></tr>
<tr><td><code id="md.vcov_+3A_sdt">sdt</code></td>
<td>
<p> A <code class="reqn">N \times p</code> matrix storing sample standard deviations for each outcome from treatment group. <code>sdt[i,j]</code> is the sample standard deviation from study <code class="reqn">i</code> for outcome <code class="reqn">j</code>. If outcome <code class="reqn">j</code> is not continuous such as MD or SMD, NA has to be imputed in the <code class="reqn">j</code>th column.</p>
</td></tr>
<tr><td><code id="md.vcov_+3A_sdc">sdc</code></td>
<td>
<p> A matrix defined in a similar way as <code>sdt</code> for the control group.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>list.vcov</code></td>
<td>
<p> A <code class="reqn">N</code>-dimensional list of <code class="reqn">p(p+1)/2 \times p(p+1)/2</code> matrices of computed variance-covariance matrices.</p>
</td></tr>
<tr><td><code>matrix.vcov</code></td>
<td>
<p> A <code class="reqn">N \times p(p+1)/2</code> matrix whose rows are computed variance-covariance vectors.</p>
</td></tr></table>


<h3>Author(s)</h3>

<p>Min Lu
</p>


<h3>References</h3>

<p>Lu, M. (2023). Computing within-study covariances, data visualization, and missing data solutions for multivariate meta-analysis with metavcov. <em>Frontiers in Psychology</em>, 14:1185012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>######################################################
# Example: Geeganage2010 data
# Preparing covariances for multivariate meta-analysis
######################################################
## set the correlation coefficients list r
r12 &lt;- 0.71
r.Gee &lt;- lapply(1:nrow(Geeganage2010), function(i){matrix(c(1, r12, r12, 1), 2, 2)})

computvcov &lt;- md.vcov(nt = subset(Geeganage2010, select = c(nt_SBP, nt_DBP)),
                    nc = subset(Geeganage2010, select = c(nc_SBP, nc_DBP)),
                    sdt = subset(Geeganage2010, select=c(sdt_SBP, sdt_DBP)),
                    sdc = subset(Geeganage2010, select=c(sdc_SBP, sdc_DBP)),
                    r = r.Gee)
# name variance-covariance matrix as S
S &lt;- computvcov$matrix.vcov
## fixed-effect model
y &lt;- as.data.frame(subset(Geeganage2010, select = c(MD_SBP, MD_DBP)))
MMA_FE &lt;- summary(metafixed(y = y, Slist = computvcov$list.vcov))
MMA_FE
#######################################################################
# Running random-effects model using package "mixmeta" or "metaSEM"
#######################################################################
# Restricted maximum likelihood (REML) estimator from the mixmeta package
#library(mixmeta)
#mvmeta_RE &lt;- summary(mixmeta(cbind(MD_SBP, MD_DBP)~1, S = S,
#                         data = subset(Geeganage2010, select = c(MD_SBP, MD_DBP)),
#                         method = "reml"))
#mvmeta_RE

# maximum likelihood estimators from the metaSEM package
# library(metaSEM)
# metaSEM_RE &lt;- summary(meta(y = y, v = S))
# metaSEM_RE
##############################################################
# Plotting the result:
##############################################################
# obj &lt;- MMA_FE
# obj &lt;- mvmeta_RE
# obj &lt;- metaSEM_RE

# plotCI(y = y, v = computvcov$list.vcov,
#         name.y = c("MD_SBP", "MD_DBP"), name.study = Geeganage2010$studyID,
#         y.all = obj$coefficients[,1],
#         y.all.se = obj$coefficients[,2])
</code></pre>

<hr>
<h2 id='metafixed'>Fitting Fixed-Effect Meta-Analysis Models</h2><span id='topic+metafixed'></span><span id='topic+print.summary.metafixed'></span><span id='topic+summary.metafixed'></span><span id='topic+maketable'></span>

<h3>Description</h3>

<p>The function <code>metafixed</code> performs fixed-effects multivariate meta-analysis with the generalized least squares (GLS) method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metafixed(y, Slist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metafixed_+3A_y">y</code></td>
<td>
<p> A <code class="reqn">N \times p</code> matrix or data frame that stores effect sizes from <code class="reqn">N</code> primary studies. Usually the output value <code>ef</code> produced by <code><a href="#topic+r.vcov">r.vcov</a></code> for correlation coefficients or <code><a href="#topic+mix.vcov">mix.vcov</a></code> for other types of effect sizes. </p>
</td></tr>
<tr><td><code id="metafixed_+3A_slist">Slist</code></td>
<td>
<p> A <code class="reqn">N</code>-dimensional list of <code class="reqn">p(p+1)/2 \times p(p+1)/2</code> matrices that stores within-study (co)variance matrices of the estimated effect sizes for each one of the <code class="reqn">N</code> studies. Usually the output value <code>list.vcov</code> produced by <code><a href="#topic+r.vcov">r.vcov</a></code> for correlation coefficients or <code><a href="#topic+mix.vcov">mix.vcov</a></code> for other types of effect sizes. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimators were calculated from the generalized least squares approach.
</p>


<h3>Value</h3>

<p>The <code>metafixed</code> function typically returns a list object of class &quot;metafixed&quot; representing the meta-analytical model. Use the <code>summary</code> function to check the analysis results.  </p>


<h3>Author(s)</h3>

<p>Min Lu
</p>


<h3>References</h3>

<p>Lu, M. (2023). Computing within-study covariances, data visualization, and missing data solutions for multivariate meta-analysis with metavcov. <em>Frontiers in Psychology</em>, 14:1185012.
</p>
<p>Cooper, H., Hedges, L.V., &amp; Valentine, J.C. (Eds.) (2009). <em>The handbook of research synthesis and
meta-analysis.</em> New York: Russell Sage Foundation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>######################################################
# Example: Craft2003 data
# Preparing covariances for multivariate meta-analysis
######################################################
data(Craft2003)
computvcov &lt;- r.vcov(n = Craft2003$N,
                     corflat = subset(Craft2003, select = C1:C6),
                     method = "average")
y &lt;- computvcov$ef
Slist &lt;- computvcov$list.vcov
#####################################################
# Running fixed-effects model using "metafixed"
#####################################################
MMA_FE &lt;- summary(metafixed(y = y, Slist = Slist))
MMA_FE$coefficients
##############################################################
# Plotting the result:
##############################################################
plotCI(y = computvcov$ef, v = computvcov$list.vcov,
        name.y = NULL, name.study = Craft2003$ID,
        y.all = MMA_FE$coefficients[,1],
        y.all.se = MMA_FE$coefficients[,2],
        up.bound = Inf, low.bound = -Inf)
</code></pre>

<hr>
<h2 id='metami'>Multiple Imputation for Missing Data in Meta-Analysis</h2><span id='topic+metami'></span><span id='topic+print.summary.metami'></span><span id='topic+summary.metami'></span><span id='topic+rubinpool'></span>

<h3>Description</h3>

<p>Multiple imputation allows for the uncertainty about the missing data by generating several different plausible imputed data sets and appropriately combining results obtained from each of them. Let  <code class="reqn">\hat{\theta}_{*m}</code> be the estimated coefficient from the <code class="reqn">m</code>th imputed dataset for one of the <code class="reqn">p</code> dimensions in the multivariate outcome, where <code class="reqn">m=1,\dots,M</code>. The coefficient from MI <code class="reqn">\bar{\theta}</code> is  simply just an arithmetic mean of the individual coefficients estimated from each of the <code class="reqn">M</code> meta-analysis. We have
</p>
<p style="text-align: center;"><code class="reqn">\bar{\theta}=\frac{\sum_{m=1}^{M}\hat{\theta}_{*m}}{M}.</code>
</p>

<p>Estimation of the standard error for each variable is little more complicated. Let <code class="reqn">V_W</code> be the within imputation variance, which is the average of the variance of the estimated coefficient from each imputed dateset:
</p>
<p style="text-align: center;"><code class="reqn">V_W=\frac{\sum_{m=1}^{M}V ({\hat{\theta}_{*m}})}{M},</code>
</p>

<p>where <code class="reqn">V ({\hat{\theta}_{*m}})</code> is the variance of the estimator calculated from generalized least squares methods using the imputed dataset. Let <code class="reqn">V_B</code> be the between imputation variance, which is calculated as
</p>
<p style="text-align: center;"><code class="reqn">V_B=\frac{\sum_{m=1}^{M}({\hat{\theta}_{*m}}-\bar{\theta})^2}{M-1}.</code>
</p>

<p>From <code class="reqn">V_W</code> and <code class="reqn">V_B</code>, the variance of the pooled coefficients is calculated as
</p>
<p style="text-align: center;"><code class="reqn">V(\bar{\theta})=V_W+V_B+\frac{V_B}{M}</code>
</p>

<p>The above variance is statistically principled since <code class="reqn">V_W</code> reflects the sampling variance and <code class="reqn">V_B</code> reflects the extra variance due to the missing data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metami(data, M = 20, vcov = "r.vcov",
        r.n.name, ef.name, x.name = NULL,
        rvcov.method = "average", rvcov.zscore = TRUE,
        type = NULL,
        d = NULL, sdt = NULL, sdc = NULL,
        nt = NULL, nc = NULL,
        st = NULL, sc = NULL,
        n_rt = NA, n_rc = NA,
        r = NULL,
        func = "mixmeta",
        formula = NULL,
        method = "fixed",
        pool.seq = NULL,
        return.mi = FALSE,
        ci.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metami_+3A_data">data</code></td>
<td>
<p> A  <code class="reqn">N \times p</code> data frame that contains effect sizes and predictors for meta-regression, if any.</p>
</td></tr>
<tr><td><code id="metami_+3A_m">M</code></td>
<td>
<p> Number of imputed data sets.</p>
</td></tr>
<tr><td><code id="metami_+3A_vcov">vcov</code></td>
<td>
<p> Method for computing effect sizes; options including <code>vcov = "r.vcov"</code> for correlation coefficients and <code>vcov = "mix.vcov"</code> for other types of effect sizes. See <code><a href="#topic+r.vcov">r.vcov</a></code> and <code><a href="#topic+mix.vcov">mix.vcov</a></code> for details.</p>
</td></tr>
<tr><td><code id="metami_+3A_r.n.name">r.n.name</code></td>
<td>
<p> A string defining the column name for sample sizes in <code>data</code> when the effect sizes are correlation coefficients (<code>vcov = "r.vcov"</code>).</p>
</td></tr>
<tr><td><code id="metami_+3A_ef.name">ef.name</code></td>
<td>
<p> A <code class="reqn">p</code>-dimensional vector that stores the column names for sample sizes in <code>data</code> when the effect sizes are correlation coefficients (<code>vcov = "r.vcov"</code>). </p>
</td></tr>
<tr><td><code id="metami_+3A_x.name">x.name</code></td>
<td>
<p> A vector that stores the column names in <code>data</code> for predictors for meta-regression. </p>
</td></tr>
<tr><td><code id="metami_+3A_rvcov.method">rvcov.method</code></td>
<td>
<p>Method used for <code><a href="#topic+r.vcov">r.vcov</a></code>; options including <code>"average"</code> and <code>"each"</code>. </p>
</td></tr>
<tr><td><code id="metami_+3A_rvcov.zscore">rvcov.zscore</code></td>
<td>
<p> Whether the correlation coefficients in <code>data</code> are already transformed into Fisher's <code class="reqn">z</code> scores.</p>
</td></tr>
<tr><td><code id="metami_+3A_type">type</code></td>
<td>
<p> A <code class="reqn">p</code>-dimensional vector indicating types of effect sizes for the argument <code>vcov = "mix.vcov"</code>. <code>"MD"</code> stands for mean difference, <code>"SMD"</code> stands for standardized mean difference, <code>"logOR"</code> stands for log odds ratio, <code>"logRR"</code> stands for log risk ratio, and <code>"RD"</code> stands for risk difference. </p>
</td></tr>
<tr><td><code id="metami_+3A_d">d</code></td>
<td>
<p> A <code class="reqn">p</code>-dimensional vector that stores the column names in <code>data</code> for continuous effect sizes such as MD or SMD. If outcome <code class="reqn">j</code> is dichotomous, NA has to be imputed in for <code class="reqn">d[j]</code>. </p>
</td></tr>
<tr><td><code id="metami_+3A_sdt">sdt</code></td>
<td>
<p> A <code class="reqn">p</code>-dimensional vector that stores the column names in <code>data</code> for the sample standard deviations of each outcome from the treatment group. If outcome <code class="reqn">j</code> is dichotomous, NA has to be imputed in for <code class="reqn">d[j]</code>. </p>
</td></tr>
<tr><td><code id="metami_+3A_sdc">sdc</code></td>
<td>
<p> A vector defined in a similar way as <code>sdt</code> for the control group.</p>
</td></tr>
<tr><td><code id="metami_+3A_nt">nt</code></td>
<td>
<p> A <code class="reqn">p</code>-dimensional vector that stores the column names in <code>data</code> for sample sizes of <code class="reqn">p</code> outcomes from treatment group. </p>
</td></tr>
<tr><td><code id="metami_+3A_nc">nc</code></td>
<td>
<p> A vector defined in a similar way as <code>nt</code> for the control group.</p>
</td></tr>
<tr><td><code id="metami_+3A_st">st</code></td>
<td>
<p> A <code class="reqn">p</code>-dimensional vector that stores the column names in <code>data</code> for the number of participants with event for all outcomes (dichotomous) in the treatment group. If outcome <code class="reqn">j</code> is dichotomous, NA has to be imputed in for <code class="reqn">st[j]</code>. </p>
</td></tr>
<tr><td><code id="metami_+3A_sc">sc</code></td>
<td>
<p> A vector defined in a similar way as <code>st</code> for the control group.</p>
</td></tr>
<tr><td><code id="metami_+3A_n_rt">n_rt</code></td>
<td>
<p>A <code class="reqn">N</code>-dimensional list of <code class="reqn">p \times p</code> correlation matrices storing sample sizes in the treatment group reporting pairwise outcomes in the off-diagonal elements. See <code><a href="#topic+mix.vcov">mix.vcov</a></code> for details.</p>
</td></tr>
<tr><td><code id="metami_+3A_n_rc">n_rc</code></td>
<td>
<p> A list defined in a similar way as <code>n_rt</code> for the control group.</p>
</td></tr>
<tr><td><code id="metami_+3A_r">r</code></td>
<td>
<p>A <code class="reqn">N</code>-dimensional list of <code class="reqn">p \times p</code> correlation matrices for the <code class="reqn">p</code> outcomes from the <code class="reqn">N</code> studies. See <code><a href="#topic+mix.vcov">mix.vcov</a></code> for details.</p>
</td></tr>
<tr><td><code id="metami_+3A_func">func</code></td>
<td>
<p> A string defining the function to be used for fitting the meta-analysis. Options include <code>func = "metafixed"</code> for fixed-effect meta-analysis (see <code><a href="#topic+metafixed">metafixed</a></code> for details). <code>func = "mixmeta"</code>, for which the <code>mixmeta</code> package must be installed beforehand, and <code>func = "meta"</code>, for which the <code>metaSEM</code> package must be installed beforehand. </p>
</td></tr>
<tr><td><code id="metami_+3A_formula">formula</code></td>
<td>
<p> Formula used for the function  <code>func = "mixmeta"</code> from the <code>mixmeta</code> package when <code>func = "mixmeta"</code>. </p>
</td></tr>
<tr><td><code id="metami_+3A_method">method</code></td>
<td>
<p> Method used for the function  <code>func = "mixmeta"</code> from the <code>mixmeta</code> package when <code>func = "mixmeta"</code>.</p>
</td></tr>
<tr><td><code id="metami_+3A_pool.seq">pool.seq</code></td>
<td>
<p> A numeric vector indicating if the results are pooled from subsets of the <code>M</code> data sets. By default, the results are only pooled from all <code>M</code> data sets. </p>
</td></tr>
<tr><td><code id="metami_+3A_return.mi">return.mi</code></td>
<td>
<p> Should the <code>M</code> imputed data sets be returned?</p>
</td></tr>
<tr><td><code id="metami_+3A_ci.level">ci.level</code></td>
<td>
<p> Significant level for the pooled confidence intervals. The default is 0.05. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the imputation phase, this function imports the <code>mice</code> package that imputes incomplete multivariate data by chained equations. The pooling phase is performed via the Rubin's rules.
</p>


<h3>Value</h3>

<table>
<tr><td><code>coefficients</code></td>
<td>
<p> A data.frame that contains the pooled results from the <code>M</code> imputed data sets.</p>
</td></tr>
<tr><td><code>results.mi</code></td>
<td>
<p> A <code class="reqn">M</code>-dimensional list of results from each imputed data set.</p>
</td></tr>
<tr><td><code>data.mi</code></td>
<td>
<p> A <code class="reqn">M</code>-dimensional list of imputed data sets if the argument <code>return.mi = TRUE</code>.</p>
</td></tr>
<tr><td><code>result.seq</code></td>
<td>
<p> A list of results from the pooled results from the subsets of the <code>M</code> imputed data sets if the argument <code>pool.seq = TRUE</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Min Lu
</p>


<h3>References</h3>

<p>Lu, M. (2023). Computing within-study covariances, data visualization, and missing data solutions for multivariate meta-analysis with metavcov. <em>Frontiers in Psychology</em>, 14:1185012.
</p>
<p>Van Buuren, S. and Groothuis-Oudshoorn, K., 2011. mice: Multivariate imputation by chained equations in R. <em>Journal of statistical software</em>, 45(1), pp.1-67.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#####################################################################################
# Example: Craft2003 data
# Preparing input arguments for meta.mi() and fixed-effect model
#####################################################################################
# prepare a dataset with missing values and input arguments for meta.mi
Craft2003.mnar &lt;- Craft2003[, c(2, 4:10)]
Craft2003.mnar[sample(which(Craft2003$C4 &lt; 0), 6), "C4"] &lt;- NA
dat &lt;- Craft2003.mnar
n.name &lt;- "N"
ef.name &lt;- c("C1", "C2", "C3", "C4", "C5", "C6")
# fixed-effect model
obj &lt;- metami(dat, M = 2, vcov = "r.vcov",
             n.name, ef.name,
             func = "metafixed")

########################
# Plotting the result
########################
computvcov &lt;- r.vcov(n = Craft2003$N,
                     corflat = subset(Craft2003.mnar, select = C1:C6),
                     method = "average")
plotCI(y = computvcov$ef, v = computvcov$list.vcov,
        name.y = NULL, name.study = Craft2003$ID,
        y.all = obj$coefficients[,1],
        y.all.se = obj$coefficients[,2])

########################
# Pooling from subsets
########################
# o1 &lt;- metami(dat, M = 10, vcov = "r.vcov",
#               n.name, ef.name,
#               func = "metafixed",
#               pool.seq = c(5, 10))
# pooled results from M = 5 imputed data sets
# o1$result.seq$M5$coefficients
# pooled results from M = 10 imputed data sets
# o1$result.seq$M10$coefficients
#########################################################################################
# Running random-effects and meta-regression model using packages "mixmeta" or "metaSEM"
#########################################################################################
# Restricted maximum likelihood (REML) estimator from the mixmeta package
# library(mixmeta)
# o2 &lt;- metami(dat, M = 10, vcov = "r.vcov",
#                     n.name, ef.name,
#                     formula = as.formula(cbind(C1, C2, C3, C4, C5, C6) ~ 1),
#                     func = "mixmeta",
#                     method = "reml")
# maximum likelihood estimators from the metaSEM package
# library(metaSEM)
# o3 &lt;- metami(dat, M = 10, vcov = "r.vcov",
#               n.name, ef.name,
#               func = "meta")

# meta-regression
# library(metaSEM)
# o4 &lt;- metami(dat, M = 10, vcov = "r.vcov",
#                     n.name, ef.name, x.name = "p_male",
#                     func = "meta")
# library(mixmeta)
# o5 &lt;- metami(dat, M = 20, vcov = "r.vcov",
#               n.name, ef.name, x.name = "p_male",
#               formula = as.formula(cbind(C1, C2, C3, C4, C5, C6) ~ p_male ),
#               func = "mixmeta",
#               method = "reml")
#####################################################################################
# Example: Geeganage2010 data
# Preparing input arguments for meta.mi() and fixed-effect model
#####################################################################################
# Geeganage2010.mnar &lt;- Geeganage2010
# Geeganage2010.mnar$MD_SBP[sample(1:nrow(Geeganage2010),7)] &lt;- NA
# r12 &lt;- 0.71
# r13 &lt;- 0.5
# r14 &lt;- 0.25
# r23 &lt;- 0.6
# r24 &lt;- 0.16
# r34 &lt;- 0.16
# r &lt;- vecTosm(c(r12, r13, r14, r23, r24, r34))
# diag(r) &lt;- 1
# mix.r &lt;- lapply(1:nrow(Geeganage2010), function(i){r})
# o &lt;- metami(data = Geeganage2010.mnar, M = 10, vcov = "mix.vcov",
#               ef.name = c("MD_SBP", "MD_DBP", "RD_DD", "lgOR_D"),
#               type = c("MD", "MD", "RD", "lgOR"),
#               d = c("MD_SBP", "MD_DBP", NA, NA),
#               sdt = c("sdt_SBP", "sdt_DBP", NA, NA),
#               sdc = c("sdc_SBP", "sdc_DBP", NA, NA),
#               nt = c("nt_SBP", "nt_DBP", "nt_DD", "nt_D"),
#               nc = c("nc_SBP", "nc_DBP", "nc_DD", "nc_D"),
#               st = c(NA, NA, "st_DD", "st_D"),
#               sc = c(NA, NA, "sc_DD", "sc_D"),
#               r = mix.r,
#               func = "metafixed")
</code></pre>

<hr>
<h2 id='mix.vcov'>Computing Variance-Covariance Matrices for Effect Sizes of the Same or Different Types</h2><span id='topic+mix.vcov'></span><span id='topic+vecTosm'></span>

<h3>Description</h3>

<p>The function <code>r.vcov</code> computes effect sizes and variance-covariance matrices between effect sizes of the same of different types. Effect sizes include mean difference (MD), standardized mean difference (SMD), log odds ratio (logOR), log risk ratio (logRR), and risk difference (RD). Formulas are in Table I of Wei et al.'s paper (2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mix.vcov(d, r, nt, nc,
         st, sc, n_rt = NA, n_rc = NA,
         sdt, sdc, type,
         name = NULL, na.impute = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mix.vcov_+3A_d">d</code></td>
<td>
<p> A <code class="reqn">N \times p</code> matrix or data frame with mean differences (MD) and/or standard mean differences (SMD) from the <code class="reqn">N</code> studies. <code>d[i,j]</code> is the value from study <code class="reqn">i</code> for outcome <code class="reqn">j</code>. If outcome <code class="reqn">j</code> is not MD or SMD, NA has to be imputed in column <code class="reqn">j</code>. </p>
</td></tr>
<tr><td><code id="mix.vcov_+3A_r">r</code></td>
<td>
<p> A <code class="reqn">N</code>-dimensional list of <code class="reqn">p \times p</code> correlation matrices for the <code class="reqn">p</code> outcomes from the <code class="reqn">N</code> studies. <code>r[[k]][i,j]</code> is the correlation coefficient between outcome <code class="reqn">i</code> and outcome <code class="reqn">j</code> from study <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code id="mix.vcov_+3A_nt">nt</code></td>
<td>
<p> A <code class="reqn">N \times p</code> matrix storing sample sizes in the treatment group reporting the  <code class="reqn">p</code> outcomes. <code>nt[i,j]</code> is the sample size from study <code class="reqn">i</code> reporting outcome <code class="reqn">j</code>.</p>
</td></tr>
<tr><td><code id="mix.vcov_+3A_nc">nc</code></td>
<td>
<p> A matrix defined in a similar way as <code>nt</code> for the control group.</p>
</td></tr>
<tr><td><code id="mix.vcov_+3A_st">st</code></td>
<td>
<p> A <code class="reqn">N \times p</code> matrix recording number of participants with event for all outcomes (dichotomous) in treatment group. <code>st[i,j]</code> reports number of participants with event for outcome <code class="reqn">j</code> in treatment group for study <code class="reqn">i</code>. If outcome <code class="reqn">j</code> is not dichotomous, NA has to be imputed in column <code class="reqn">j</code>.</p>
</td></tr>
<tr><td><code id="mix.vcov_+3A_sc">sc</code></td>
<td>
<p> Defined in a similar way as <code>st</code> for the control group.</p>
</td></tr>
<tr><td><code id="mix.vcov_+3A_n_rt">n_rt</code></td>
<td>
<p>A <code class="reqn">N</code>-dimensional list of <code class="reqn">p \times p</code> matrices storing sample sizes in the treatment group reporting pairwise outcomes in the off-diagonal elements. <code>n_rt[[k]][i,j]</code> is the sample size reporting both outcome <code class="reqn">i</code> and outcome <code class="reqn">j</code> from study <code class="reqn">k</code>. Diagonal elements of these matrices are discarded. The default value is <code>NA</code>, which means that the smaller sample size reporting the corresponding two outcomes is imputed: i.e. <code>n_rt[[k]][i,j]=min(nt[k,i],nt[k,j])</code>. </p>
</td></tr>
<tr><td><code id="mix.vcov_+3A_n_rc">n_rc</code></td>
<td>
<p> A list defined in a similar way as <code>n_rt</code> for the control group.</p>
</td></tr>
<tr><td><code id="mix.vcov_+3A_sdt">sdt</code></td>
<td>
<p> A <code class="reqn">N \times p</code> matrix storing sample standard deviations for each outcome from treatment group. <code>sdt[i,j]</code> is the sample standard deviation from study <code class="reqn">i</code> for outcome <code class="reqn">j</code>. If outcome <code class="reqn">j</code> is not continuous such as MD or SMD, NA has to be imputed in the <code class="reqn">j</code>th column.</p>
</td></tr>
<tr><td><code id="mix.vcov_+3A_sdc">sdc</code></td>
<td>
<p> A matrix defined in a similar way as <code>sdt</code> for the control group.</p>
</td></tr>
<tr><td><code id="mix.vcov_+3A_type">type</code></td>
<td>
<p> A <code class="reqn">p</code>-dimensional vector indicating types of effect sizes. <code>"MD"</code> stands for mean difference, <code>"SMD"</code> stands for standardized mean difference, <code>"logOR"</code> stands for log odds ratio, <code>"logRR"</code> stands for log risk ratio, and <code>"RD"</code> stands for risk difference. </p>
</td></tr>
<tr><td><code id="mix.vcov_+3A_name">name</code></td>
<td>
<p> A <code class="reqn">p</code>-dimensional vector storing names for the effect sizes.</p>
</td></tr>
<tr><td><code id="mix.vcov_+3A_na.impute">na.impute</code></td>
<td>
<p> Missing values in <code>d</code> can be imputed by a numeric value, such as zero by setting <code>na.impute = 0</code>. With the default setting <code>na.impute = NA</code>, missing values are not imputed. If specifying <code>na.impute = "average"</code>, missing values are imputed by the mean of <code>d</code> that is sample-size weighted from the complete records. </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>ef</code></td>
<td>
<p>A <code class="reqn">N \times p</code> data frame whose columns are computed effect sizes according to the input argument <code>"type"</code>. SMD will be converted to Hedges's g (Wei and Higgins, 2013).</p>
</td></tr>
<tr><td><code>list.vcov</code></td>
<td>
<p> A <code class="reqn">N</code>-dimensional list of <code class="reqn">p(p+1)/2 \times p(p+1)/2</code> matrices of computed variance-covariance matrices.</p>
</td></tr>
<tr><td><code>matrix.vcov</code></td>
<td>
<p> A <code class="reqn">N \times p(p+1)/2</code> matrix whose rows are computed variance-covariance vectors.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Min Lu
</p>


<h3>References</h3>

<p>Lu, M. (2023). Computing within-study covariances, data visualization, and missing data solutions for multivariate meta-analysis with metavcov. <em>Frontiers in Psychology</em>, 14:1185012.
</p>
<p>Wei, Y., &amp;  Higgins, J. (2013). Estimating within study covariances in multivariate meta-analysis with multiple outcomes. <em>Statistics in Medicine, 32</em>(7), 119-1205.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#########################################################################
# Example: Geeganage2010 data
# Preparing covariances for a multivariate meta-analysis
# Choose variable SBP, DBP, DD, D with effect sizes "MD","MD","RD","lgOR"
#########################################################################
data(Geeganage2010)
## set the correlation coefficients list r
r12 &lt;- 0.71
r13 &lt;- 0.5
r14 &lt;- 0.25
r23 &lt;- 0.6
r24 &lt;- 0.16
r34 &lt;- 0.16
r &lt;- vecTosm(c(r12, r13, r14, r23, r24, r34))
diag(r) &lt;- 1
mix.r &lt;- lapply(1:nrow(Geeganage2010), function(i){r})
attach(Geeganage2010)
## compute variance co-variances
computvcov &lt;- mix.vcov(type = c("MD", "MD", "RD", "lgOR"),
                       d = cbind(MD_SBP, MD_DBP, NA, NA),
                       sdt = cbind(sdt_SBP, sdt_DBP, NA, NA),
                       sdc = cbind(sdc_SBP, sdc_DBP, NA, NA),
                       nt = cbind(nt_SBP, nt_DBP, nt_DD, nt_D),
                       nc = cbind(nc_SBP, nc_DBP, nc_DD, nc_D),
                       st = cbind(NA, NA, st_DD, st_D),
                       sc = cbind(NA, NA, sc_DD, sc_D),
                       r = mix.r,
                       name = c("MD.SBP", "MD.DBP", "RD.DD", "lgOR.D"))
# save different effect sizes in y
y &lt;- computvcov$ef
head(y)
# save variances and covariances of all the effect sizes in a matrix S
S &lt;- computvcov$matrix.vcov
S[1, ]
## fixed-effect model
MMA_FE &lt;- summary(metafixed(y = y, Slist = computvcov$list.vcov))
#######################################################################
# Running random-effects model using package "mixmeta" or "metaSEM"
#######################################################################
# Restricted maximum likelihood (REML) estimator from the mixmeta package
# library(mixmeta)
# mvmeta_RE &lt;- summary(mixmeta(cbind(MD.SBP, MD.DBP, RD.DD, lgOR.D) ~ 1,
#                            S = S, data = y, method = "reml"))
# mvmeta_RE

# maximum likelihood estimators from the metaSEM package
# library(metaSEM)
# metaSEM_RE &lt;- summary(meta(y = y, v = S))
# metaSEM_RE
##############################################################
# Plotting the result:
##############################################################
obj &lt;- MMA_FE
# obj &lt;- mvmeta_RE
# obj &lt;- metaSEM_RE
# pdf("CI.pdf", width = 4, height = 7)
plotCI(y = computvcov$ef, v = computvcov$list.vcov,
        name.y = NULL, name.study = Geeganage2010$studyID,
        y.all = obj$coefficients[,1],
        y.all.se = obj$coefficients[,2],
        hline = c(0, 0, 0, 1))
# dev.off()
</code></pre>

<hr>
<h2 id='plotCI'>Plot Confidence Intervals for a Meta-Analysis</h2><span id='topic+plotCI'></span><span id='topic+ciplotgg'></span>

<h3>Description</h3>

<p>The function <code>plot.CI</code> generates confidence interval figures for effect sizes from each study and the estimated effect sizes across studies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotCI(y, v,
       name.y = NULL,
       name.study = NULL,
       y.all, y.all.se,
       hline = 0,
       up.bound = Inf, low.bound = -Inf,
       return.data = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCI_+3A_y">y</code></td>
<td>
<p> A <code class="reqn">N \times p</code> matrix or data frame that stores effect sizes from <code class="reqn">N</code> primary studies. Usually the output value <code>ef</code> produced by <code><a href="#topic+r.vcov">r.vcov</a></code> for correlation coefficients or <code><a href="#topic+mix.vcov">mix.vcov</a></code> for other types of effect sizes. </p>
</td></tr>
<tr><td><code id="plotCI_+3A_v">v</code></td>
<td>
<p> A <code class="reqn">N</code>-dimensional list of <code class="reqn">p \times p</code> matrices that stores within-study (co)variance matrices of the estimated effect sizes for each one of the <code class="reqn">N</code> studies. Usually the output value <code>list.vcov</code> produced by <code><a href="#topic+r.vcov">r.vcov</a></code> for correlation coefficients or <code><a href="#topic+mix.vcov">mix.vcov</a></code> for other types of effect sizes.</p>
</td></tr>
<tr><td><code id="plotCI_+3A_name.y">name.y</code></td>
<td>
<p> A <code class="reqn">p</code>-dimensional vector that stores names for the effect sizes in <code>y</code>. By default, it is the columname of <code>y</code>. </p>
</td></tr>
<tr><td><code id="plotCI_+3A_name.study">name.study</code></td>
<td>
<p> A <code class="reqn">N</code>-dimensional vector that stores names for the primary in <code>y</code>. By default, it is the row name of <code>y</code>. </p>
</td></tr>
<tr><td><code id="plotCI_+3A_y.all">y.all</code></td>
<td>
<p> A <code class="reqn">p</code>-dimensional vector that stores the estimated effect sizes across studies.</p>
</td></tr>
<tr><td><code id="plotCI_+3A_y.all.se">y.all.se</code></td>
<td>
<p> A <code class="reqn">p</code>-dimensional vector that stores the standard errors for the estimated effect sizes in <code>y.all</code>.</p>
</td></tr>
<tr><td><code id="plotCI_+3A_hline">hline</code></td>
<td>
<p> A <code class="reqn">p</code>-dimensional vector that specifies the position of the dash line in the figures to compare the coefficients across studies. If its length is one instead of <code class="reqn">p</code>, this number will be adopted for all the <code class="reqn">p</code> effect sizes. </p>
</td></tr>
<tr><td><code id="plotCI_+3A_up.bound">up.bound</code></td>
<td>
<p> A <code class="reqn">p</code>-dimensional vector that specifies the upper bound in the figures. If its length is one instead of <code class="reqn">p</code>, this number will be adopted for all the <code class="reqn">p</code> effect sizes. </p>
</td></tr>
<tr><td><code id="plotCI_+3A_low.bound">low.bound</code></td>
<td>
<p> A <code class="reqn">p</code>-dimensional vector that specifies the lower bound in the figures. If its length is one instead of <code class="reqn">p</code>, this number will be adopted for all the <code class="reqn">p</code> effect sizes. </p>
</td></tr>
<tr><td><code id="plotCI_+3A_return.data">return.data</code></td>
<td>
<p> 	Should the data for the confidence interval plots be returned?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The difference between a forest plot and a confidence interval plot is that a forest plot requires a symbol on each confidence interval that is proportional to the weight for each study. Because the weighting mechanism in multivariate meta-analysis is too complex to be visualized, such a propositional symbol is omitted for multivariate meta-analysis.
</p>


<h3>Author(s)</h3>

<p>Min Lu
</p>


<h3>References</h3>

<p>Lu, M. (2023). Computing within-study covariances, data visualization, and missing data solutions for multivariate meta-analysis with metavcov. <em>Frontiers in Psychology</em>, 14:1185012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>######################################################
# Example: Craft2003 data
######################################################
data(Craft2003)
computvcov &lt;- r.vcov(n = Craft2003$N,
                     corflat = subset(Craft2003, select = C1:C6),
                     method = "average")
y &lt;- computvcov$ef
Slist &lt;- computvcov$list.vcov
MMA_FE &lt;- summary(metafixed(y = y, Slist = Slist))
obj &lt;- MMA_FE
# pdf("CI.pdf", width = 4, height = 7)
plotCI(y = computvcov$ef, v = computvcov$list.vcov,
        name.y = NULL, name.study = Craft2003$ID,
        y.all = obj$coefficients[,1],
        y.all.se = obj$coefficients[,2])
# dev.off()

######################################################
# Substitute obj for Random-effect model
######################################################
# library(mvmeta)
# S &lt;- computvcov$matrix.vcov
# MMA_RE &lt;- summary(mvmeta(cbind(C1, C2, C3, C4, C5, C6),
#                            S = S, data = y, method = "reml"))
# obj &lt;- MMA_RE

</code></pre>

<hr>
<h2 id='r.vcov'>Computing Variance-Covariance Matrices for Correlation Coefficients</h2><span id='topic+r.vcov'></span><span id='topic+rToz'></span><span id='topic+smTovec'></span>

<h3>Description</h3>

<p>The function <code>r.vcov</code> computes variance-covariance matrix for multivariate meta-analysis when the effect size is measured by correlation coefficient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>r.vcov(n, corflat, zscore = FALSE, name = NULL, method = "average", na.impute = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="r.vcov_+3A_n">n</code></td>
<td>
<p> A <code class="reqn">N</code>-dimensional vector containing sample sizes from <code class="reqn">N</code> studies.</p>
</td></tr>
<tr><td><code id="r.vcov_+3A_corflat">corflat</code></td>
<td>
<p> A <code class="reqn">N \times p</code> matrix or data frame storing <code class="reqn">p</code> correlation coefficients from each of the <code class="reqn">N</code> studies.</p>
</td></tr>
<tr><td><code id="r.vcov_+3A_zscore">zscore</code></td>
<td>
<p> Whether the correlation coefficients in <code>corflat</code> are already transformed into Fisher's <code class="reqn">z</code> scores.</p>
</td></tr>
<tr><td><code id="r.vcov_+3A_name">name</code></td>
<td>
<p> A <code class="reqn">p</code>-dimensional vector containing names for the <code class="reqn">p</code> correlation coefficients.</p>
</td></tr>
<tr><td><code id="r.vcov_+3A_method">method</code></td>
<td>
<p> Method <code>"average"</code> computes variance and covariances with mean correlation coefficients that are sample-size weighted from all the <code class="reqn">N</code> studies (missing values are omitted); method <code>"each"</code> computes variance and covariances with each of the corresponding correlation coefficients.</p>
</td></tr>
<tr><td><code id="r.vcov_+3A_na.impute">na.impute</code></td>
<td>
<p> Missing values can be imputed by a numeric value, such as zero by setting <code>na.impute = 0</code>. With the default setting <code>na.impute = NA</code>, missing values are not imputed. If specifying <code>na.impute = "average"</code>, missing values are imputed by mean correlation coefficients that are sample-size weighted from the complete records. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>How to arrange correlation coefficients of each study from matrix to vector is in Cooper et al book page 385 to 386. Details for average method are in book of Cooper et al page 388. Let <code class="reqn">r_{ist}</code> denote the sample correlation coefficient that describes the relationship between variables <code class="reqn">s</code> and <code class="reqn">t</code> in study <code class="reqn">i</code>. We can calculate its variance as
<code class="reqn">var({{r}_{ist}})={{(1-\rho_{ist}^{2})}^{2}}/{{n}_{i}},</code> and the covariance between two correlation coefficients is
<code class="reqn">
	cov({{r}_{ist}},{{r}_{iuv}})=[.5{{\rho }_{ist}}{{\rho }_{iuv}}({{\rho }}_{isu}^{2}+{{\rho }}_{isv}^{2}+{{\rho }}_{itu}^{2}+{{\rho }}_{itv}^{2})+{{\rho }_{isu}}{{\rho }_{itv}}+{{\rho }_{isv}}{{\rho }_{itu}} \nonumber \\
	 -({{\rho }_{ist}}{{\rho }_{isu}}{{\rho }_{isv}}+{{\rho }_{its}}{{\rho }_{itu}}{{\rho }_{itv}}+{{\rho }_{ius}}{{\rho }_{iut}}{{\rho }_{iuv}}+{{\rho }_{ivs}}{{\rho }_{ivt}}{{\rho }_{ivu}})]/{{n}_{i}},
</code>
where <code class="reqn">\rho_{i..}</code> represents the population value. In practice, <code class="reqn">\rho_{i..}</code> can be substituted by the observed sample correlation or sample-size weighted mean correlation coefficients from all studies.
</p>


<h3>Value</h3>

<table>
<tr><td><code>r</code></td>
<td>
<p> A <code class="reqn">N \times p</code> data frame that contains the input argument <code>corflat</code> with column names and imputed values according to the input argument <code>na.impute</code>. If the input argument <code>zscore=TRUE</code>, <code>r</code> is transformed from Fisher's <code class="reqn">z</code> score in <code>corflat</code>. </p>
</td></tr>
<tr><td><code>list.rvcov</code></td>
<td>
<p> A <code class="reqn">N</code>-dimensional list of <code class="reqn">p(p+1)/2 \times p(p+1)/2</code> matrices of computed variance-covariance matrices.</p>
</td></tr>
<tr><td><code>matrix.rvcov</code></td>
<td>
<p> A <code class="reqn">N \times p(p+1)/2</code> matrix whose rows are computed variance-covariance vectors.</p>
</td></tr>
<tr><td><code>ef</code></td>
<td>
<p> A <code class="reqn">N \times p</code> data frame that contains Fisher's <code class="reqn">z</code> transformed correlation coefficients from the input argument <code>corflat</code> with column names and imputed values according to the input argument <code>na.impute</code>. </p>
</td></tr>
<tr><td><code>list.vcov</code></td>
<td>
<p> A list in the same format of <code>list.rvcov</code> for Fisher's <code class="reqn">z</code> transformed correlation coefficients.</p>
</td></tr>
<tr><td><code>matrix.vcov</code></td>
<td>
<p> A matrix <code>matrix.rvcov</code> for Fisher's <code class="reqn">z</code> transformed correlation coefficients.</p>
</td></tr></table>


<h3>Author(s)</h3>

<p>Min Lu
</p>


<h3>References</h3>

<p>Lu, M. (2023). Computing within-study covariances, data visualization, and missing data solutions for multivariate meta-analysis with metavcov. <em>Frontiers in Psychology</em>, 14:1185012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##############################################################
# A simple example:
# Checking the example in Harris Cooper et al.'s book page 388
##############################################################
r &lt;- matrix(c(-0.074, -0.127, 0.324, 0.523, -0.416, -0.414), 1)
n &lt;- 142
computvcov &lt;- r.vcov(n = n, corflat = r,
                     name = paste("C", c("st", "su", "sv", "tu", "tv", "uv"), sep = ""),
                     method = "each")
round(computvcov$list.rvcov[[1]], 4)
round(computvcov$ef, 4)
round(computvcov$list.vcov[[1]], 4)
round(computvcov$matrix.vcov, 4)
######################################################
# Example: Craft2003 data
# Preparing covariances for multivariate meta-analysis
######################################################
data(Craft2003)
# extract correlation from the dataset (craft)
corflat &lt;- subset(Craft2003, select=C1:C6)
# transform correlations to z and compute variance-covariance matrix.
computvcov &lt;- r.vcov(n = Craft2003$N, corflat = corflat, method = "average")
# name transformed z scores as y
y &lt;- computvcov$ef
# name variance-covariance matrix of trnasformed z scores as S
S &lt;- computvcov$matrix.vcov
S[1, ]
## fixed-effect model
MMA_FE &lt;- summary(metafixed(y = y, Slist = computvcov$list.vcov))
#######################################################################
# Running random-effects model using package "mixmeta" or "metaSEM"
#######################################################################
# Restricted maximum likelihood (REML) estimator from the mixmeta package
#library(mixmeta)
#mvmeta_RE &lt;- summary(mixmeta(cbind(C1, C2, C3, C4, C5, C6) ~ 1,
#                           S = S, data = y, method = "reml"))
#mvmeta_RE

# maximum likelihood estimators from the metaSEM package
# library(metaSEM)
# metaSEM_RE &lt;- summary(meta(y = y, v = S))
# metaSEM_RE
##############################################################
# Plotting the result:
##############################################################
obj &lt;- MMA_FE
# obj &lt;- mvmeta_RE
# obj &lt;- metaSEM_RE
# pdf("CI.pdf", width = 4, height = 7)
plotCI(y = computvcov$ef, v = computvcov$list.vcov,
        name.y = NULL, name.study = Craft2003$ID,
        y.all = obj$coefficients[,1],
        y.all.se = obj$coefficients[,2])
# dev.off()
</code></pre>

<hr>
<h2 id='rd.vcov'>Computing Variance-Covariance Matrices for Risk Differences</h2><span id='topic+rd.vcov'></span>

<h3>Description</h3>

<p>The function <code>lgOR.vcov</code> computes effect sizes and variance-covariance matrix for multivariate meta-analysis when the effect sizes of interest are all measured by risk difference. See <code><a href="#topic+mix.vcov">mix.vcov</a></code> for effect sizes of the same or different types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rd.vcov(r, nt, nc, st, sc, n_rt = NA, n_rc = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rd.vcov_+3A_r">r</code></td>
<td>
<p> A <code class="reqn">N</code>-dimensional list of <code class="reqn">p \times p</code> correlation matrices for the <code class="reqn">p</code> outcomes from the <code class="reqn">N</code> studies. <code>r[[k]][i,j]</code> is the correlation coefficient between outcome <code class="reqn">i</code> and outcome <code class="reqn">j</code> from study <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code id="rd.vcov_+3A_nt">nt</code></td>
<td>
<p> A <code class="reqn">N \times p</code> matrix storing sample sizes in the treatment group reporting the  <code class="reqn">p</code> outcomes. <code>nt[i,j]</code> is the sample size from study <code class="reqn">i</code> reporting outcome <code class="reqn">j</code>.</p>
</td></tr>
<tr><td><code id="rd.vcov_+3A_nc">nc</code></td>
<td>
<p> A matrix defined in a similar way as <code>nt</code> for the control group.</p>
</td></tr>
<tr><td><code id="rd.vcov_+3A_st">st</code></td>
<td>
<p> A <code class="reqn">N \times p</code> matrix recording number of participants with event for all outcomes (dichotomous) in treatment group. <code>st[i,j]</code> reports number of participants with event for outcome <code class="reqn">j</code> in treatment group for study <code class="reqn">i</code>. If outcome <code class="reqn">j</code> is not dichotomous, NA has to be imputed in column <code class="reqn">j</code>.</p>
</td></tr>
<tr><td><code id="rd.vcov_+3A_sc">sc</code></td>
<td>
<p> Defined in a similar way as <code>st</code> for the control group.</p>
</td></tr>
<tr><td><code id="rd.vcov_+3A_n_rt">n_rt</code></td>
<td>
<p>A <code class="reqn">N</code>-dimensional list of <code class="reqn">p \times p</code> matrices storing sample sizes in the treatment group reporting pairwise outcomes in the off-diagonal elements. <code>n_rt[[k]][i,j]</code> is the sample size reporting both outcome <code class="reqn">i</code> and outcome <code class="reqn">j</code> from study <code class="reqn">k</code>. Diagonal elements of these matrices are discarded. The default value is <code>NA</code>, which means that the smaller sample size reporting the corresponding two outcomes is imputed: i.e. <code>n_rt[[k]][i,j]=min(nt[k,i],nt[k,j])</code>. </p>
</td></tr>
<tr><td><code id="rd.vcov_+3A_n_rc">n_rc</code></td>
<td>
<p> A list defined in a similar way as <code>n_rt</code> for the control group.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>ef</code></td>
<td>
<p>A <code class="reqn">N \times p</code> data frame whose columns are computed risk differences.</p>
</td></tr>
<tr><td><code>list.vcov</code></td>
<td>
<p> A <code class="reqn">N</code>-dimensional list of <code class="reqn">p(p+1)/2 \times p(p+1)/2</code> matrices of computed variance-covariance matrices.</p>
</td></tr>
<tr><td><code>matrix.vcov</code></td>
<td>
<p> A <code class="reqn">N \times p(p+1)/2</code> matrix whose rows are computed variance-covariance vectors.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Min Lu
</p>


<h3>References</h3>

<p>Lu, M. (2023). Computing within-study covariances, data visualization, and missing data solutions for multivariate meta-analysis with metavcov. <em>Frontiers in Psychology</em>, 14:1185012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###########################################################################
# Example: Geeganage2010 data
# Preparing risk differences and covariances for multivariate meta-analysis
###########################################################################
data(Geeganage2010)
## set the correlation coefficients list r
r12 &lt;- 0.71
r.Gee &lt;- lapply(1:nrow(Geeganage2010), function(i){matrix(c(1, r12, r12, 1), 2, 2)})


computvcov &lt;- rd.vcov(nt = subset(Geeganage2010, select = c(nt_DD, nt_D)),
                      nc = subset(Geeganage2010, select = c(nc_DD, nc_D)),
                      st = subset(Geeganage2010, select = c(st_DD, st_D)),
                      sc = subset(Geeganage2010, select = c(sc_DD, sc_D)),
                      r = r.Gee)
# name computed relative risk as y
y &lt;- computvcov$ef
colnames(y) &lt;- c("rd.DD", "rd.D")
# name variance-covariance matrix of trnasformed z scores as covars
S &lt;- computvcov$matrix.vcov
## fixed-effect model
MMA_FE &lt;- summary(metafixed(y = y, Slist = computvcov$list.vcov))
#######################################################################
# Running random-effects model using package "mixmeta" or "metaSEM"
#######################################################################
#library(mixmeta)
#mvmeta_RE &lt;- summary(mixmeta(cbind(rd.DD, rd.D)~1,
#                          S = S, data = as.data.frame(y),
#                          method = "reml"))
#mvmeta_RE

# maximum likelihood estimators from the metaSEM package
# library(metaSEM)
# metaSEM_RE &lt;- summary(meta(y = y, v = S))
# metaSEM_RE
##############################################################
# Plotting the result:
##############################################################
obj &lt;- MMA_FE
# obj &lt;- mvmeta_RE
# obj &lt;- metaSEM_RE
# pdf("CI.pdf", width = 4, height = 7)
plotCI(y = computvcov$ef, v = computvcov$list.vcov,
        name.y = c("rd.DD", "rd.D"),
        name.study = Geeganage2010$studyID,
        y.all = obj$coefficients[,1],
        y.all.se = obj$coefficients[,2])
# dev.off()
</code></pre>

<hr>
<h2 id='smd_lgor'>Computing Covariance between Standardized Mean Difference and Log Odds Ratio</h2><span id='topic+smd_lgor'></span>

<h3>Description</h3>

<p>The function <code>smd_lgor</code> computes covariance between standardized mean difference and log odds ratio.  See <code><a href="#topic+mix.vcov">mix.vcov</a></code> for effect sizes of the same or different types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smd_lgor(d, r, n1c, n2c, n1t, n2t,
         n12c = min(n1c, n2c), n12t = min(n1t, n2t),
         s2c, s2t, f2c, f2t, sd1c, sd1t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smd_lgor_+3A_d">d</code></td>
<td>
<p> Standardized mean difference for outcome 1.</p>
</td></tr>
<tr><td><code id="smd_lgor_+3A_r">r</code></td>
<td>
<p> Correlation coefficient of the two outcomes.</p>
</td></tr>
<tr><td><code id="smd_lgor_+3A_n1c">n1c</code></td>
<td>
<p> Number of participants reporting outcome 1 in the control group.</p>
</td></tr>
<tr><td><code id="smd_lgor_+3A_n2c">n2c</code></td>
<td>
<p> Number of participants reporting outcome 2 in the control group.</p>
</td></tr>
<tr><td><code id="smd_lgor_+3A_n1t">n1t</code></td>
<td>
<p> Number of participants reporting outcome 1 in the treatment group.</p>
</td></tr>
<tr><td><code id="smd_lgor_+3A_n2t">n2t</code></td>
<td>
<p> Number of participants reporting outcome 2 in the treatment group.</p>
</td></tr>
<tr><td><code id="smd_lgor_+3A_n12c">n12c</code></td>
<td>
<p> Number of participants reporting both outcome 1 and outcome 2 in the control group. By default, it is equal to the smaller number between <code>n1c</code> and <code>n2c</code>.</p>
</td></tr>
<tr><td><code id="smd_lgor_+3A_n12t">n12t</code></td>
<td>
<p> Number defined in a similar way as <code>n12c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="smd_lgor_+3A_s2c">s2c</code></td>
<td>
<p> Number of participants with event for outcome 2 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="smd_lgor_+3A_s2t">s2t</code></td>
<td>
<p> Defined in a similar way as <code>s2c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="smd_lgor_+3A_f2c">f2c</code></td>
<td>
<p> Number of participants without event for outcome 2 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="smd_lgor_+3A_f2t">f2t</code></td>
<td>
<p> Defined in a similar way as <code>f2c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="smd_lgor_+3A_sd1c">sd1c</code></td>
<td>
<p> Sample standard deviation of outcome 1 for the control group.</p>
</td></tr>
<tr><td><code id="smd_lgor_+3A_sd1t">sd1t</code></td>
<td>
<p> Defined in a similar way as <code>sd1c</code> for the treatment group.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>g</code></td>
<td>
<p>Computed Hedge's g from the input argument <code>d</code> for outcome 1.</p>
</td></tr>
<tr><td><code>lgor</code></td>
<td>
<p>Computed log odds ratio for outcome 2.</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>Computed covariance.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Min Lu
</p>


<h3>References</h3>

<p>Lu, M. (2023). Computing within-study covariances, data visualization, and missing data solutions for multivariate meta-analysis with metavcov. <em>Frontiers in Psychology</em>, 14:1185012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## simple example
smd_lgor(d = 1, r = 0.71, n1c = 34, n2c = 35, n1t = 25, n2t = 32,
         s2c = 5, s2t = 8, f2c = 30, f2t = 24, sd1t = 0.4, sd1c = 8)
## calculate covariances for variable SBP and DD in Geeganage2010 data
attach(Geeganage2010)
SBP_DD &lt;- unlist(lapply(1:nrow(Geeganage2010), function(i){smd_lgor(d = SMD_SBP, r = 0.71,
                n1c = nc_SBP[i], n2c = nc_DD[i], n1t = nt_SBP[i], n2t = nt_DD[i],
                sd1t = sdt_SBP[i], s2t = st_DD[i], sd1c = sdc_SBP[i], s2c = sc_DD[i],
                f2c = nc_DD[i] - sc_DD[i], f2t = nt_DD[i] - st_DD[i])$v}))
SBP_DD
## the function mix.vcov() should be used for dataset
</code></pre>

<hr>
<h2 id='smd_lgrr'>Computing Covariance between Standardized Mean Difference and Log Risk Ratio</h2><span id='topic+smd_lgrr'></span>

<h3>Description</h3>

<p>The function <code>smd_lgrr</code> computes covariance between standardized mean difference and log risk ratio.  See <code><a href="#topic+mix.vcov">mix.vcov</a></code> for effect sizes of the same or different types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smd_lgrr(d, r, n1c, n2c, n1t, n2t,
         n12c = min(n1c, n2c), n12t = min(n1t, n2t),
         s2c, s2t, f2c, f2t, sd1c, sd1t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smd_lgrr_+3A_d">d</code></td>
<td>
<p> Standardized mean difference for outcome 1.</p>
</td></tr>
<tr><td><code id="smd_lgrr_+3A_r">r</code></td>
<td>
<p> Correlation coefficient of the two outcomes.</p>
</td></tr>
<tr><td><code id="smd_lgrr_+3A_n1c">n1c</code></td>
<td>
<p> Number of participants reporting outcome 1 in the control group.</p>
</td></tr>
<tr><td><code id="smd_lgrr_+3A_n2c">n2c</code></td>
<td>
<p> Number of participants reporting outcome 2 in the control group.</p>
</td></tr>
<tr><td><code id="smd_lgrr_+3A_n1t">n1t</code></td>
<td>
<p> Number of participants reporting outcome 1 in the treatment group.</p>
</td></tr>
<tr><td><code id="smd_lgrr_+3A_n2t">n2t</code></td>
<td>
<p> Number of participants reporting outcome 2 in the treatment group.</p>
</td></tr>
<tr><td><code id="smd_lgrr_+3A_n12c">n12c</code></td>
<td>
<p> Number of participants reporting both outcome 1 and outcome 2 in the control group. By default, it is equal to the smaller number between <code>n1c</code> and <code>n2c</code>.</p>
</td></tr>
<tr><td><code id="smd_lgrr_+3A_n12t">n12t</code></td>
<td>
<p> Number defined in a similar way as <code>n12c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="smd_lgrr_+3A_s2c">s2c</code></td>
<td>
<p> Number of participants with event for outcome 2 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="smd_lgrr_+3A_s2t">s2t</code></td>
<td>
<p> Defined in a similar way as <code>s2c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="smd_lgrr_+3A_f2c">f2c</code></td>
<td>
<p> Number of participants without event for outcome 2 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="smd_lgrr_+3A_f2t">f2t</code></td>
<td>
<p> Defined in a similar way as <code>f2c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="smd_lgrr_+3A_sd1c">sd1c</code></td>
<td>
<p> Sample standard deviation of outcome 1 for the control group.</p>
</td></tr>
<tr><td><code id="smd_lgrr_+3A_sd1t">sd1t</code></td>
<td>
<p> Defined in a similar way as <code>sd1c</code> for the treatment group.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>g</code></td>
<td>
<p>Computed Hedge's g from the input argument <code>d</code> for outcome 1.</p>
</td></tr>
<tr><td><code>lgrr</code></td>
<td>
<p>Computed log risk ratio for outcome 2.</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>Computed covariance.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Min Lu
</p>


<h3>References</h3>

<p>Lu, M. (2023). Computing within-study covariances, data visualization, and missing data solutions for multivariate meta-analysis with metavcov. <em>Frontiers in Psychology</em>, 14:1185012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## simple example
smd_lgrr(d = 1, r = 0.3, n1c = 34, n2c = 35, n1t = 25, n2t = 32,
         s2c = 5, s2t = 8, f2c = 30, f2t = 24, sd1t = 0.4, sd1c = 8)
## calculate covariances for variable SBP and DD in Geeganage2010 data
attach(Geeganage2010)
SBP_DD &lt;- unlist(lapply(1:nrow(Geeganage2010), function(i){smd_lgrr(d = SMD_SBP, r = 0.3,
                 n1c = nc_SBP[i], n2c = nc_DD[i], n1t = nt_SBP[i], n2t = nt_DD[i],
                 sd1t = sdt_SBP[i], s2t = st_DD[i], sd1c = sdc_SBP[i], s2c = sc_DD[i],
                 f2c = nc_DD[i] - sc_DD[i], f2t = nt_DD[i] - st_DD[i])$v}))
SBP_DD
## the function mix.vcov() should be used for dataset
</code></pre>

<hr>
<h2 id='smd_rd'>Computing Covariance between Standardized Mean Difference and Risk Difference</h2><span id='topic+smd_rd'></span>

<h3>Description</h3>

<p>The function <code>smd_rd</code> computes covariance between standardized mean difference and risk difference.  See <code><a href="#topic+mix.vcov">mix.vcov</a></code> for effect sizes of the same or different types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smd_rd(d, r, n1c, n2c, n1t, n2t,
       n12c = min(n1c, n2c), n12t = min(n1t, n2t),
       s2c, s2t, f2c, f2t, sd1c, sd1t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smd_rd_+3A_d">d</code></td>
<td>
<p> Standardized mean difference for outcome 1.</p>
</td></tr>
<tr><td><code id="smd_rd_+3A_r">r</code></td>
<td>
<p> Correlation coefficient of the two outcomes.</p>
</td></tr>
<tr><td><code id="smd_rd_+3A_n1c">n1c</code></td>
<td>
<p> Number of participants reporting outcome 1 in the control group.</p>
</td></tr>
<tr><td><code id="smd_rd_+3A_n2c">n2c</code></td>
<td>
<p> Number of participants reporting outcome 2 in the control group.</p>
</td></tr>
<tr><td><code id="smd_rd_+3A_n1t">n1t</code></td>
<td>
<p> Number of participants reporting outcome 1 in the treatment group.</p>
</td></tr>
<tr><td><code id="smd_rd_+3A_n2t">n2t</code></td>
<td>
<p> Number of participants reporting outcome 2 in the treatment group.</p>
</td></tr>
<tr><td><code id="smd_rd_+3A_n12c">n12c</code></td>
<td>
<p> Number of participants reporting both outcome 1 and outcome 2 in the control group. By default, it is equal to the smaller number between <code>n1c</code> and <code>n2c</code>.</p>
</td></tr>
<tr><td><code id="smd_rd_+3A_n12t">n12t</code></td>
<td>
<p> Number defined in a similar way as <code>n12c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="smd_rd_+3A_s2c">s2c</code></td>
<td>
<p> Number of participants with event for outcome 2 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="smd_rd_+3A_s2t">s2t</code></td>
<td>
<p> Defined in a similar way as <code>s2c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="smd_rd_+3A_f2c">f2c</code></td>
<td>
<p> Number of participants without event for outcome 2 (dichotomous) in the control group.</p>
</td></tr>
<tr><td><code id="smd_rd_+3A_f2t">f2t</code></td>
<td>
<p> Defined in a similar way as <code>f2c</code> for the treatment group. </p>
</td></tr>
<tr><td><code id="smd_rd_+3A_sd1c">sd1c</code></td>
<td>
<p> Sample standard deviation of outcome 1 for the control group.</p>
</td></tr>
<tr><td><code id="smd_rd_+3A_sd1t">sd1t</code></td>
<td>
<p> Defined in a similar way as <code>sd1c</code> for the treatment group.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>g</code></td>
<td>
<p>Computed Hedge's g from the input argument <code>d</code> for outcome 1.</p>
</td></tr>
<tr><td><code>rd</code></td>
<td>
<p>Computed risk difference for outcome 1.</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>Computed covariance.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Min Lu
</p>


<h3>References</h3>

<p>Lu, M. (2023). Computing within-study covariances, data visualization, and missing data solutions for multivariate meta-analysis with metavcov. <em>Frontiers in Psychology</em>, 14:1185012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## simple example
smd_rd(d = 1, r = 0.71, n1c = 34, n2c = 35, n1t = 25, n2t = 32,
       s2c = 5, s2t = 8, f2c = 30, f2t = 24, sd1t = 0.4, sd1c = 8)
## calculate covariances for variable SBP and DD in Geeganage2010 data
attach(Geeganage2010)
SBP_DD &lt;- unlist(lapply(1:nrow(Geeganage2010), function(i){smd_rd(d = SMD_SBP, r = 0.71,
                n1c = nc_SBP[i], n2c = nc_DD[i], n1t = nt_SBP[i], n2t = nt_DD[i],
                sd1t = sdt_SBP[i], s2t = st_DD[i], sd1c = sdc_SBP[i], s2c = sc_DD[i],
                f2c = nc_DD[i] - sc_DD[i], f2t = nt_DD[i] - st_DD[i])}))
SBP_DD
## the function mix.vcov() should be used for dataset
</code></pre>

<hr>
<h2 id='smd.vcov'>Computing Variance-Covariance Matrices for Standardized Mean Differences</h2><span id='topic+smd.vcov'></span>

<h3>Description</h3>

<p>The function <code>lgOR.vcov</code> computes effect sizes and variance-covariance matrix for multivariate meta-analysis when the effect sizes of interest are all measured by standardized mean difference. See <code><a href="#topic+mix.vcov">mix.vcov</a></code> for effect sizes of the same or different types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smd.vcov(nt, nc, d, r, n_rt = NA, n_rc = NA, name = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smd.vcov_+3A_nt">nt</code></td>
<td>
<p> A <code class="reqn">N \times p</code> matrix storing sample sizes in the treatment group reporting the  <code class="reqn">p</code> outcomes. <code>nt[i,j]</code> is the sample size from study <code class="reqn">i</code> reporting outcome <code class="reqn">j</code>.</p>
</td></tr>
<tr><td><code id="smd.vcov_+3A_nc">nc</code></td>
<td>
<p> A matrix defined in a similar way as <code>nt</code> for the control group.</p>
</td></tr>
<tr><td><code id="smd.vcov_+3A_d">d</code></td>
<td>
<p> A <code class="reqn">N \times p</code> matrix or data frame with standard mean differences (SMD) from the <code class="reqn">N</code> studies. <code>d[i,j]</code> is the value from study <code class="reqn">i</code> for outcome <code class="reqn">j</code>. </p>
</td></tr>
<tr><td><code id="smd.vcov_+3A_r">r</code></td>
<td>
<p> A <code class="reqn">N</code>-dimensional list of <code class="reqn">p \times p</code> correlation matrices for the <code class="reqn">p</code> outcomes from the <code class="reqn">N</code> studies. <code>r[[k]][i,j]</code> is the correlation coefficient between outcome <code class="reqn">i</code> and outcome <code class="reqn">j</code> from study <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code id="smd.vcov_+3A_n_rt">n_rt</code></td>
<td>
<p>A <code class="reqn">N</code>-dimensional list of <code class="reqn">p \times p</code> matrices storing sample sizes in the treatment group reporting pairwise outcomes in the off-diagonal elements. <code>n_rt[[k]][i,j]</code> is the sample size reporting both outcome <code class="reqn">i</code> and outcome <code class="reqn">j</code> from study <code class="reqn">k</code>. Diagonal elements of these matrices are discarded. The default value is <code>NA</code>, which means that the smaller sample size reporting the corresponding two outcomes is imputed: i.e. <code>n_rt[[k]][i,j]=min(nt[k,i],nt[k,j])</code>. </p>
</td></tr>
<tr><td><code id="smd.vcov_+3A_n_rc">n_rc</code></td>
<td>
<p> A list defined in a similar way as <code>n_rt</code> for the control group.</p>
</td></tr>
<tr><td><code id="smd.vcov_+3A_name">name</code></td>
<td>
<p> Names for the outcomes.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>ef</code></td>
<td>
<p> A <code class="reqn">N \times p</code> data frame that transforms the input argument <code>d</code> into Hedges's g (Wei and Higgins, 2013).</p>
</td></tr>
<tr><td><code>list.vcov</code></td>
<td>
<p> A <code class="reqn">N</code>-dimensional list of <code class="reqn">p(p+1)/2 \times p(p+1)/2</code> variance-covariance matrices for Hedges's g (Wei and Higgins, 2013).</p>
</td></tr>
<tr><td><code>matrix.vcov</code></td>
<td>
<p>A <code class="reqn">N \times p(p+1)/2</code> whose rows are computed variance-covariance vectors for Hedges's g (Wei and Higgins, 2013).</p>
</td></tr>
<tr><td><code>list.dvcov</code></td>
<td>
<p>A <code class="reqn">N</code>-dimensional list of <code class="reqn">p(p+1)/2 \times p(p+1)/2</code> variance-covariance matrices for SMD (Olkin and Gleser, 2009).</p>
</td></tr>
<tr><td><code>matrix.dvcov</code></td>
<td>
<p>A <code class="reqn">N \times p(p+1)/2</code> matrix whose rows are computed variance-covariance vectors for SMD (Olkin and Gleser, 2009).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Min Lu
</p>


<h3>References</h3>

<p>Lu, M. (2023). Computing within-study covariances, data visualization, and missing data solutions for multivariate meta-analysis with metavcov. <em>Frontiers in Psychology</em>, 14:1185012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>######################################################
# Example: Geeganage2010 data
# Preparing covarianceS for multivariate meta-analysis
######################################################
data(Geeganage2010)
## set the correlation coefficients list r
r12 &lt;- 0.71
r.Gee &lt;- lapply(1:nrow(Geeganage2010), function(i){matrix(c(1, r12, r12, 1), 2, 2)})

computvcov &lt;- smd.vcov(nt = subset(Geeganage2010, select = c(nt_SBP, nt_DBP)),
               nc = subset(Geeganage2010, select = c(nc_SBP, nc_DBP)),
               d = subset(Geeganage2010, select = c(SMD_SBP, SMD_DBP)), r = r.Gee,
               name = c("SMD_SBP", "SMD_DBP"))
# name variance-covariance matrix as S
S &lt;- computvcov$matrix.vcov
## fixed-effect model
y &lt;- computvcov$ef
MMA_FE &lt;- summary(metafixed(y = y, Slist = computvcov$list.vcov))
#######################################################################
# Running random-effects model using package "mixmeta" or "metaSEM"
#######################################################################
# Restricted maximum likelihood (REML) estimator from the mixmeta package
#library(mixmeta)
#mvmeta_RE &lt;- summary(mixmeta(cbind(SMD_SBP, SMD_DBP)~1,
#                     S = S,
#                     data = y,
#                     method = "reml"))
#mvmeta_RE

# maximum likelihood estimators from the metaSEM package
# library(metaSEM)
# metaSEM_RE &lt;- summary(meta(y = y, v = S))
# metaSEM_RE
##############################################################
# Plotting the result:
##############################################################
obj &lt;- MMA_FE
# obj &lt;- mvmeta_RE
# obj &lt;- metaSEM_RE
# pdf("CI.pdf", width = 4, height = 7)
plotCI(y = computvcov$ef, v = computvcov$list.vcov,
        name.y = NULL, name.study = Geeganage2010$studyID,
        y.all = obj$coefficients[,1],
        y.all.se = obj$coefficients[,2])
# dev.off()
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
