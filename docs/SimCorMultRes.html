<!DOCTYPE html><html><head><title>Help for package SimCorMultRes</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SimCorMultRes}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SimCorMultRes-package'><p>Simulating Correlated Multinomial Responses</p></a></li>
<li><a href='#rbin'><p>Simulating Correlated Binary Responses Conditional on a Marginal Model</p>
Specification</a></li>
<li><a href='#rmult.acl'><p>Simulating Correlated Ordinal Responses Conditional on a Marginal</p>
Adjacent-Category Logit Model Specification</a></li>
<li><a href='#rmult.bcl'><p>Simulating Correlated Nominal Responses Conditional on a Marginal</p>
Baseline-Category Logit Model Specification</a></li>
<li><a href='#rmult.clm'><p>Simulating Correlated Ordinal Responses Conditional on a Marginal Cumulative</p>
Link Model Specification</a></li>
<li><a href='#rmult.crm'><p>Simulating Correlated Ordinal Responses Conditional on a Marginal</p>
Continuation-Ratio Model Specification</a></li>
<li><a href='#rnorta'><p>Simulating Random Vectors using the NORTA Method</p></a></li>
<li><a href='#rsmvnorm'><p>Simulating Continuous Random Vectors from a Multivariate Normal Distribution</p></a></li>
<li><a href='#simulation'><p>Simulated Correlation Parameters</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Simulates Correlated Multinomial Responses</td>
</tr>
<tr>
<td>Description:</td>
<td>Simulates correlated multinomial responses conditional on a marginal model specification.</td>
</tr>
<tr>
<td>Version:</td>
<td>1.9.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 2.15.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>evd, methods, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>bookdown, covr, gee, knitr, multgee (&ge; 1.2), rmarkdown,
R.rsp, testthat</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/AnestisTouloumis/SimCorMultRes">https://github.com/AnestisTouloumis/SimCorMultRes</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/AnestisTouloumis/SimCorMultRes/issues">https://github.com/AnestisTouloumis/SimCorMultRes/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, R.rsp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-10 12:50:16 UTC; anestis</td>
</tr>
<tr>
<td>Author:</td>
<td>Anestis Touloumis <a href="https://orcid.org/0000-0002-5965-1639"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Anestis Touloumis &lt;A.Touloumis@brighton.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-11 08:40:38 UTC</td>
</tr>
</table>
<hr>
<h2 id='SimCorMultRes-package'>Simulating Correlated Multinomial Responses</h2><span id='topic+SimCorMultRes-package'></span><span id='topic+SimCorMultRes'></span>

<h3>Description</h3>

<p>Functions to simulate correlated multinomial responses (three or more
nominal or ordinal response categories) and correlated binary responses
subject to a marginal model specification.
</p>


<h3>Details</h3>

<p>The simulated correlated binary or multinomial responses are drawn as
realizations of a latent regression model for continuous random vectors with
the correlation structure expressed in terms of the latent correlation.
</p>
<p>For an ordinal response scale, the multinomial variables are simulated
conditional on a marginal cumulative link model
(<code><a href="#topic+rmult.clm">rmult.clm</a></code>), a marginal continuation-ratio model
(<code><a href="#topic+rmult.crm">rmult.crm</a></code>) or a marginal adjacent-category logit model
(<code><a href="#topic+rmult.acl">rmult.acl</a></code>).
</p>
<p>For a nominal response scale, the multinomial responses are simulated
conditional on a marginal baseline-category logit model
(<code><a href="#topic+rmult.bcl">rmult.bcl</a></code>).
</p>
<p>Correlated binary responses are simulated using the function
<code><a href="#topic+rbin">rbin</a></code>.
</p>
<p>The threshold approaches that give rise to the implemented marginal models
are fully described in <cite>Touloumis (2016)</cite> and in the Vignette.
</p>
<p>The formulae are easier to read from either the Vignette or the Reference
Manual (both available
<a href="https://CRAN.R-project.org/package=SimCorMultRes">here</a>).
</p>


<h3>Author(s)</h3>

<p>Anestis Touloumis
</p>
<p>Maintainer: Anestis Touloumis <a href="mailto:A.Touloumis@brighton.ac.uk">A.Touloumis@brighton.ac.uk</a>
</p>


<h3>References</h3>

<p>Cario, M. C. and Nelson, B. L. (1997) <em>Modeling and
generating random vectors with arbitrary marginal distributions and
correlation matrix</em>. Technical Report, Department of Industrial Engineering
and Management Sciences, Northwestern University, Evanston, Illinois.
</p>
<p>Emrich, L. J. and Piedmonte, M. R. (1991) A method for generating
high-dimensional multivariate binary variates. <em>The American
Statistician</em> <b>45</b>, 302&ndash;304.
</p>
<p>Li, S. T. and Hammond, J. L. (1975) Generation of pseudorandom numbers with
specified univariate distributions and correlation coefficients. <em>IEEE
Transactions on Systems, Man and Cybernetics</em> <b>5</b>, 557&ndash;561.
</p>
<p>McCullagh, P. (1980) Regression models for ordinal data. <em>Journal of
the Royal Statistical Society B</em> <b>42</b>, 109&ndash;142.
</p>
<p>McFadden, D. (1974) <em>Conditional logit analysis of qualitative choice
behavior</em>. New York: Academic Press, 105&ndash;142.
</p>
<p>Touloumis, A. (2016) Simulating Correlated Binary and Multinomial Responses
under Marginal Model Specification: The SimCorMultRes Package. <em>The R
Journal</em> <b>8</b>, 79&ndash;91.
</p>
<p>Touloumis, A., Agresti, A. and Kateri, M. (2013) GEE for multinomial
responses using a local odds ratios parameterization. <em>Biometrics</em>
<b>69</b>, 633&ndash;640.
</p>
<p>Tutz, G. (1991) Sequential models in categorical regression.
<em>Computational Statistics &amp; Data Analysis</em> <b>11</b>, 275&ndash;295.
</p>

<hr>
<h2 id='rbin'>Simulating Correlated Binary Responses Conditional on a Marginal Model
Specification</h2><span id='topic+rbin'></span>

<h3>Description</h3>

<p>Simulates correlated binary responses assuming a regression model for the
marginal probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rbin(clsize = clsize, intercepts = intercepts, betas = betas,
  xformula = formula(xdata), xdata = parent.frame(), link = "logit",
  cor.matrix = cor.matrix, rlatent = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rbin_+3A_clsize">clsize</code></td>
<td>
<p>integer indicating the common cluster size.</p>
</td></tr>
<tr><td><code id="rbin_+3A_intercepts">intercepts</code></td>
<td>
<p>numerical (or numeric vector of length <code>clsize</code>)
containing the intercept(s) of the marginal model.</p>
</td></tr>
<tr><td><code id="rbin_+3A_betas">betas</code></td>
<td>
<p>numerical vector or matrix containing the value of the marginal
regression parameter vector associated with the covariates (i.e., excluding
<code>intercepts</code>).</p>
</td></tr>
<tr><td><code id="rbin_+3A_xformula">xformula</code></td>
<td>
<p>formula expression as in other marginal regression models
but without including a response variable.</p>
</td></tr>
<tr><td><code id="rbin_+3A_xdata">xdata</code></td>
<td>
<p>optional data frame containing the variables provided in
<code>xformula</code>.</p>
</td></tr>
<tr><td><code id="rbin_+3A_link">link</code></td>
<td>
<p>character string indicating the link function in the marginal
model. Options include <code>'probit'</code>, <code>'logit'</code>, <code>'cloglog'</code>,
<code>'cauchit'</code> or <code>'identity'</code>. Required when <code>rlatent = NULL</code>.</p>
</td></tr>
<tr><td><code id="rbin_+3A_cor.matrix">cor.matrix</code></td>
<td>
<p>matrix indicating the correlation matrix of the
multivariate normal distribution when the NORTA method is employed
(<code>rlatent = NULL</code>).</p>
</td></tr>
<tr><td><code id="rbin_+3A_rlatent">rlatent</code></td>
<td>
<p>matrix with <code>clsize</code> columns containing realizations of
the latent random vectors when the NORTA method is not preferred. See
details for more info.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formulae are easier to read from either the Vignette or the Reference
Manual (both available
<a href="https://CRAN.R-project.org/package=SimCorMultRes">here</a>).
</p>
<p>The assumed marginal model is </p>
<p style="text-align: center;"><code class="reqn">Pr(Y_{it} = 1 |x_{it})=F(\beta_{t0}
+\beta^{'}_{t} x_{it})</code>
</p>
<p> where <code class="reqn">F</code> is the cumulative distribution
function determined by <code>link</code>. For subject <code class="reqn">i</code>, <code class="reqn">Y_{it}</code> is the
<code class="reqn">t</code>-th binary response and <code class="reqn">x_{it}</code> is the associated covariates
vector. Finally, <code class="reqn">\beta_{t0}</code> and <code class="reqn">\beta_{t}</code> are the intercept and
regression parameter vector at the <code class="reqn">t</code>-th measurement occasion.
</p>
<p>The binary response <code class="reqn">Y_{it}</code> is obtained by extending the approach of
<cite>Emrich and Piedmonte (1991)</cite> as suggested in <cite>Touloumis (2016)</cite>.
</p>
<p>When <code class="reqn">\beta_{t0}=\beta_{0}</code> for all <code class="reqn">t</code>, then <code>intercepts</code>
should be provided as a single number. Otherwise, <code>intercepts</code> must be
provided as a numeric vector such that the <code class="reqn">t</code>-th element corresponds to
the intercept at measurement occasion <code class="reqn">t</code>.
</p>
<p><code>betas</code> should be provided as a numeric vector only when
<code class="reqn">\beta_{t}=\beta</code> for all <code class="reqn">t</code>. Otherwise, <code>betas</code> must be
provided as a numeric matrix with <code>clsize</code> rows such that the
<code class="reqn">t</code>-th row contains the value of <code class="reqn">\beta_{t}</code>. In either case,
<code>betas</code> should reflect the order of the terms implied by
<code>xformula</code>.
</p>
<p>The appropriate use of <code>xformula</code> is <code>xformula = ~ covariates</code>,
where <code>covariates</code> indicate the linear predictor as in other marginal
regression models.
</p>
<p>The optional argument <code>xdata</code> should be provided in &ldquo;long&rdquo; format.
</p>
<p>The NORTA method is the default option for simulating the latent random
vectors denoted by <code class="reqn">e^{B}_{it}</code> in <cite>Touloumis (2016)</cite>. To import
simulated values for the latent random vectors without utilizing the NORTA
method, the user can employ the <code>rlatent</code> argument. In this case,
element (<code class="reqn">i,t</code>) of <code>rlatent</code> represents the realization of
<code class="reqn">e^{B}_{it}</code>.
</p>


<h3>Value</h3>

<p>Returns a list that has components: </p>
<table>
<tr><td><code>Ysim</code></td>
<td>
<p>the simulated binary
responses. Element (<code class="reqn">i</code>,<code class="reqn">t</code>) represents the realization of
<code class="reqn">Y_{it}</code>.</p>
</td></tr> <tr><td><code>simdata</code></td>
<td>
<p>a data frame that includes the simulated
response variables (y), the covariates specified by <code>xformula</code>,
subjects' identities (id) and the corresponding measurement occasions
(time).</p>
</td></tr> <tr><td><code>rlatent</code></td>
<td>
<p>the latent random variables denoted by
<code class="reqn">e^{B}_{it}</code> in <cite>Touloumis (2016)</cite>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Anestis Touloumis
</p>


<h3>References</h3>

<p>Cario, M. C. and Nelson, B. L. (1997) <em>Modeling and
generating random vectors with arbitrary marginal distributions and
correlation matrix</em>. Technical Report, Department of Industrial Engineering
and Management Sciences, Northwestern University, Evanston, Illinois.
</p>
<p>Emrich, L. J. and Piedmonte, M. R. (1991) A method for generating
high-dimensional multivariate binary variates. <em>The American
Statistician</em> <b>45</b>, 302&ndash;304.
</p>
<p>Li, S. T. and Hammond, J. L. (1975) Generation of pseudorandom numbers with
specified univariate distributions and correlation coefficients. <em>IEEE
Transactions on Systems, Man and Cybernetics</em> <b>5</b>, 557&ndash;561.
</p>
<p>Touloumis, A. (2016) Simulating Correlated Binary and Multinomial Responses
under Marginal Model Specification: The SimCorMultRes Package. <em>The R
Journal</em> <b>8</b>, 79&ndash;91.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rmult.bcl">rmult.bcl</a></code> for simulating correlated nominal
responses, <code><a href="#topic+rmult.clm">rmult.clm</a></code>, <code><a href="#topic+rmult.crm">rmult.crm</a></code> and
<code><a href="#topic+rmult.acl">rmult.acl</a></code> for simulating correlated ordinal responses.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See Example 3.5 in the Vignette.
set.seed(123)
sample_size &lt;- 5000
cluster_size &lt;- 4
beta_intercepts &lt;- 0
beta_coefficients &lt;- 0.2
latent_correlation_matrix &lt;- toeplitz(c(1, 0.9, 0.9, 0.9))
x &lt;- rep(rnorm(sample_size), each = cluster_size)
simulated_binary_dataset &lt;- rbin(clsize = cluster_size,
  intercepts = beta_intercepts, betas = beta_coefficients,
  xformula = ~x, cor.matrix = latent_correlation_matrix, link = "probit")
library(gee)
binary_gee_model &lt;- gee(y ~ x, family = binomial("probit"), id = id,
  data = simulated_binary_dataset$simdata)
summary(binary_gee_model)$coefficients

## See Example 3.6 in the Vignette.
set.seed(8)
library(evd)
simulated_latent_variables1 &lt;- rmvevd(sample_size, dep = sqrt(1 - 0.9),
  model = "log", d = cluster_size)
  simulated_latent_variables2 &lt;- rmvevd(sample_size, dep = sqrt(1 - 0.9),
  model = "log", d = cluster_size)
simulated_latent_variables &lt;- simulated_latent_variables1 -
  simulated_latent_variables2
simulated_binary_dataset &lt;- rbin(clsize = cluster_size,
  intercepts = beta_intercepts, betas = beta_coefficients,
  xformula = ~x, rlatent = simulated_latent_variables)
binary_gee_model &lt;- gee(y ~ x, family = binomial("logit"), id = id,
  data = simulated_binary_dataset$simdata)
summary(binary_gee_model)$coefficients
</code></pre>

<hr>
<h2 id='rmult.acl'>Simulating Correlated Ordinal Responses Conditional on a Marginal
Adjacent-Category Logit Model Specification</h2><span id='topic+rmult.acl'></span>

<h3>Description</h3>

<p>Simulates correlated ordinal responses assuming an adjacent-category logit
model for the marginal probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmult.acl(clsize = clsize, intercepts = intercepts, betas = betas,
  xformula = formula(xdata), xdata = parent.frame(),
  cor.matrix = cor.matrix, rlatent = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmult.acl_+3A_clsize">clsize</code></td>
<td>
<p>integer indicating the common cluster size.</p>
</td></tr>
<tr><td><code id="rmult.acl_+3A_intercepts">intercepts</code></td>
<td>
<p>numerical vector or matrix containing the intercepts of
the marginal adjacent-category logit model.</p>
</td></tr>
<tr><td><code id="rmult.acl_+3A_betas">betas</code></td>
<td>
<p>numerical vector or matrix containing the value of the marginal
regression parameter vector.</p>
</td></tr>
<tr><td><code id="rmult.acl_+3A_xformula">xformula</code></td>
<td>
<p>formula expression as in other marginal regression models
but without including a response variable.</p>
</td></tr>
<tr><td><code id="rmult.acl_+3A_xdata">xdata</code></td>
<td>
<p>optional data frame containing the variables provided in
<code>xformula</code>.</p>
</td></tr>
<tr><td><code id="rmult.acl_+3A_cor.matrix">cor.matrix</code></td>
<td>
<p>matrix indicating the correlation matrix of the
multivariate normal distribution when the NORTA method is employed
(<code>rlatent = NULL</code>).</p>
</td></tr>
<tr><td><code id="rmult.acl_+3A_rlatent">rlatent</code></td>
<td>
<p>matrix with <code>(clsize * ncategories)</code> columns containing
realizations of the latent random vectors when the NORTA method is not
preferred. See details for more info.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formulae are easier to read from either the Vignette or the Reference
Manual (both available
<a href="https://CRAN.R-project.org/package=SimCorMultRes">here</a>).
</p>
<p>The assumed marginal adjacent-category logit model is </p>
<p style="text-align: center;"><code class="reqn">log
\frac{Pr(Y_{it}=j |x_{it})}{Pr(Y_{it}=j+1 |x_{it})}=\beta_{tj0}
+ \beta^{'}_{t} x_{it}</code>
</p>

<p>For subject <code class="reqn">i</code>, <code class="reqn">Y_{it}</code> is the <code class="reqn">t</code>-th ordinal response
and <code class="reqn">x_{it}</code> is the associated covariates vector. Also <code class="reqn">\beta_{tj0}</code>
is the <code class="reqn">j</code>-th category-specific intercept at the <code class="reqn">t</code>-th measurement
occasion and <code class="reqn">\beta_{t}</code> is the regression
parameter vector at the <code class="reqn">t</code>-th measurement occasion.
</p>
<p>The ordinal response <code class="reqn">Y_{it}</code> is obtained by utilizing the threshold
approach described in the Vignette. This approach is based on the connection
between baseline-category and adjacent-category logit models.
</p>
<p>When <code class="reqn">\beta_{tj0}=\beta_{j0}</code> for all <code class="reqn">t</code>, then <code>intercepts</code>
should be provided as a numerical vector. Otherwise, <code>intercepts</code> must
be a numerical matrix such that row <code class="reqn">t</code> contains the category-specific
intercepts at the <code class="reqn">t</code>-th measurement occasion.
</p>
<p><code>betas</code> should be provided as a numeric vector only when
<code class="reqn">\beta_{t}=\beta</code> for all <code class="reqn">t</code>. Otherwise, <code>betas</code> must be
provided as a numeric matrix with <code>clsize</code> rows such that the
<code class="reqn">t</code>-th row contains the value of <code class="reqn">\beta_{t}</code>. In either case,
<code>betas</code> should reflect the order of the terms implied by
<code>xformula</code>.
</p>
<p>The appropriate use of <code>xformula</code> is <code>xformula = ~ covariates</code>,
where <code>covariates</code> indicate the linear predictor as in other marginal
regression models.
</p>
<p>The optional argument <code>xdata</code> should be provided in &ldquo;long&rdquo; format.
</p>
<p>The NORTA method is the default option for simulating the latent random
vectors denoted by <code class="reqn">e^{O3}_{itj}</code> in the Vignette. To import
simulated values for the latent random vectors without utilizing the NORTA
method, the user can employ the <code>rlatent</code> argument. In this case,
row <code class="reqn">i</code> corresponds to subject <code class="reqn">i</code> and columns
<code class="reqn">(t-1)*\code{ncategories}+1,...,t*\code{ncategories}</code> should contain the
realization of <code class="reqn">e^{O3}_{it1},...,e^{O3}_{itJ}</code>, respectively, for
<code class="reqn">t=1,\ldots,\code{clsize}</code>.
</p>


<h3>Value</h3>

<p>Returns a list that has components: </p>
<table>
<tr><td><code>Ysim</code></td>
<td>
<p>the simulated
nominal responses. Element (<code class="reqn">i</code>,<code class="reqn">t</code>) represents the realization of
<code class="reqn">Y_{it}</code>.</p>
</td></tr> <tr><td><code>simdata</code></td>
<td>
<p>a data frame that includes the simulated
response variables (y), the covariates specified by <code>xformula</code>,
subjects' identities (id) and the corresponding measurement occasions
(time).</p>
</td></tr> <tr><td><code>rlatent</code></td>
<td>
<p>the latent random variables denoted by
<code class="reqn">e^{O3}_{itj}</code> in the Vignette.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Anestis Touloumis
</p>


<h3>References</h3>

<p>Cario, M. C. and Nelson, B. L. (1997) <em>Modeling and
generating random vectors with arbitrary marginal distributions and
correlation matrix</em>. Technical Report, Department of Industrial Engineering
and Management Sciences, Northwestern University, Evanston, Illinois.
</p>
<p>Li, S. T. and Hammond, J. L. (1975) Generation of pseudorandom numbers with
specified univariate distributions and correlation coefficients. <em>IEEE
Transactions on Systems, Man and Cybernetics</em> <b>5</b>, 557&ndash;561.
</p>
<p>Touloumis, A. (2016) Simulating Correlated Binary and Multinomial Responses
under Marginal Model Specification: The SimCorMultRes Package. <em>The R
Journal</em> <b>8</b>, 79&ndash;91.
</p>
<p>Touloumis, A., Agresti, A. and Kateri, M. (2013) GEE for multinomial
responses using a local odds ratios parameterization. <em>Biometrics</em>
<b>69</b>, 633&ndash;640.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rbin">rbin</a></code> for simulating correlated binary responses,
<code><a href="#topic+rmult.clm">rmult.clm</a></code> and <code><a href="#topic+rmult.crm">rmult.crm</a></code> for simulating
correlated ordinal responses, and <code><a href="#topic+rmult.bcl">rmult.bcl</a></code> for simulating
nominal responses.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See Example 3.4 in the Vignette.
beta_intercepts &lt;- c(3, 1, 2)
beta_coefficients &lt;- c(1, 1)
sample_size &lt;- 500
cluster_size &lt;- 3
set.seed(321)
x1 &lt;- rep(rnorm(sample_size), each = cluster_size)
x2 &lt;- rnorm(sample_size * cluster_size)
xdata &lt;- data.frame(x1, x2)
identity_matrix &lt;- diag(4)
equicorrelation_matrix &lt;- toeplitz(c(1, rep(0.95, cluster_size - 1)))
latent_correlation_matrix &lt;- kronecker(equicorrelation_matrix,
  identity_matrix)
simulated_ordinal_dataset &lt;- rmult.acl(clsize = cluster_size,
  intercepts = beta_intercepts, betas = beta_coefficients,
  xformula = ~ x1 + x2, xdata = xdata,
  cor.matrix = latent_correlation_matrix)
suppressPackageStartupMessages(library("multgee"))
ordinal_gee_model &lt;- ordLORgee(y ~ x1 + x2,
  data = simulated_ordinal_dataset$simdata, id = id, repeated = time,
  LORstr = "time.exch", link = "acl")
round(coef(ordinal_gee_model), 2)
</code></pre>

<hr>
<h2 id='rmult.bcl'>Simulating Correlated Nominal Responses Conditional on a Marginal
Baseline-Category Logit Model Specification</h2><span id='topic+rmult.bcl'></span>

<h3>Description</h3>

<p>Simulates correlated nominal responses assuming a baseline-category logit
model for the marginal probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmult.bcl(clsize = clsize, ncategories = ncategories, betas = betas,
  xformula = formula(xdata), xdata = parent.frame(),
  cor.matrix = cor.matrix, rlatent = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmult.bcl_+3A_clsize">clsize</code></td>
<td>
<p>integer indicating the common cluster size.</p>
</td></tr>
<tr><td><code id="rmult.bcl_+3A_ncategories">ncategories</code></td>
<td>
<p>integer indicating the number of nominal response
categories.</p>
</td></tr>
<tr><td><code id="rmult.bcl_+3A_betas">betas</code></td>
<td>
<p>numerical vector or matrix containing the value of the marginal
regression parameter vector.</p>
</td></tr>
<tr><td><code id="rmult.bcl_+3A_xformula">xformula</code></td>
<td>
<p>formula expression as in other marginal regression models
but without including a response variable.</p>
</td></tr>
<tr><td><code id="rmult.bcl_+3A_xdata">xdata</code></td>
<td>
<p>optional data frame containing the variables provided in
<code>xformula</code>.</p>
</td></tr>
<tr><td><code id="rmult.bcl_+3A_cor.matrix">cor.matrix</code></td>
<td>
<p>matrix indicating the correlation matrix of the
multivariate normal distribution when the NORTA method is employed
(<code>rlatent = NULL</code>).</p>
</td></tr>
<tr><td><code id="rmult.bcl_+3A_rlatent">rlatent</code></td>
<td>
<p>matrix with <code>(clsize * ncategories)</code> columns containing
realizations of the latent random vectors when the NORTA method is not
preferred. See details for more info.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formulae are easier to read from either the Vignette or the Reference
Manual (both available
<a href="https://CRAN.R-project.org/package=SimCorMultRes">here</a>).
</p>
<p>The assumed marginal baseline category logit model is </p>
<p style="text-align: center;"><code class="reqn">log
\frac{Pr(Y_{it}=j |x_{it})}{Pr(Y_{it}=J |x_{it})}=(\beta_{tj0}-\beta_{tJ0})
+ (\beta^{'}_{tj}-\beta^{'}_{tJ}) x_{it}=\beta^{*}_{tj0}+ \beta^{*'}_{tj}
x_{it}</code>
</p>
<p> For subject <code class="reqn">i</code>, <code class="reqn">Y_{it}</code> is the <code class="reqn">t</code>-th nominal response
and <code class="reqn">x_{it}</code> is the associated covariates vector. Also <code class="reqn">\beta_{tj0}</code>
is the <code class="reqn">j</code>-th category-specific intercept at the <code class="reqn">t</code>-th measurement
occasion and <code class="reqn">\beta_{tj}</code> is the <code class="reqn">j</code>-th category-specific regression
parameter vector at the <code class="reqn">t</code>-th measurement occasion.
</p>
<p>The nominal response <code class="reqn">Y_{it}</code> is obtained by extending the principle of
maximum random utility (<cite>McFadden, 1974</cite>) as suggested in
<cite>Touloumis (2016)</cite>.
</p>
<p><code>betas</code> should be provided as a numeric vector only when
<code class="reqn">\beta_{tj0}=\beta_{j0}</code> and <code class="reqn">\beta_{tj}=\beta_j</code> for all <code class="reqn">t</code>.
Otherwise, <code>betas</code> must be provided as a numeric matrix with
<code>clsize</code> rows such that the <code class="reqn">t</code>-th row contains the value of
(<code class="reqn">\beta_{t10},\beta_{t1},\beta_{t20},\beta_{t2},...,\beta_{tJ0},
\beta_{tJ}</code>). In either case, <code>betas</code> should reflect the order of the
terms implied by <code>xformula</code>.
</p>
<p>The appropriate use of <code>xformula</code> is <code>xformula = ~ covariates</code>,
where <code>covariates</code> indicate the linear predictor as in other marginal
regression models.
</p>
<p>The optional argument <code>xdata</code> should be provided in &ldquo;long&rdquo; format.
</p>
<p>The NORTA method is the default option for simulating the latent random
vectors denoted by <code class="reqn">e^{NO}_{itj}</code> in <cite>Touloumis (2016)</cite>. In this
case, the algorithm forces <code>cor.matrix</code> to respect the assumption of
choice independence. To import simulated values for the latent random
vectors without utilizing the NORTA method, the user can employ the
<code>rlatent</code> argument. In this case, row <code class="reqn">i</code> corresponds to subject
<code class="reqn">i</code> and columns
<code class="reqn">(t-1)*\code{ncategories}+1,...,t*\code{ncategories}</code> should contain the
realization of <code class="reqn">e^{NO}_{it1},...,e^{NO}_{itJ}</code>, respectively, for
<code class="reqn">t=1,\ldots,\code{clsize}</code>.
</p>


<h3>Value</h3>

<p>Returns a list that has components: </p>
<table>
<tr><td><code>Ysim</code></td>
<td>
<p>the simulated
nominal responses. Element (<code class="reqn">i</code>,<code class="reqn">t</code>) represents the realization of
<code class="reqn">Y_{it}</code>.</p>
</td></tr> <tr><td><code>simdata</code></td>
<td>
<p>a data frame that includes the simulated
response variables (y), the covariates specified by <code>xformula</code>,
subjects' identities (id) and the corresponding measurement occasions
(time).</p>
</td></tr> <tr><td><code>rlatent</code></td>
<td>
<p>the latent random variables denoted by
<code class="reqn">e^{NO}_{it}</code> in <cite>Touloumis (2016)</cite>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Anestis Touloumis
</p>


<h3>References</h3>

<p>Cario, M. C. and Nelson, B. L. (1997) <em>Modeling and
generating random vectors with arbitrary marginal distributions and
correlation matrix</em>. Technical Report, Department of Industrial Engineering
and Management Sciences, Northwestern University, Evanston, Illinois.
</p>
<p>Li, S. T. and Hammond, J. L. (1975) Generation of pseudorandom numbers with
specified univariate distributions and correlation coefficients. <em>IEEE
Transactions on Systems, Man and Cybernetics</em> <b>5</b>, 557&ndash;561.
</p>
<p>McFadden, D. (1974) <em>Conditional logit analysis of qualitative choice
behavior</em>. New York: Academic Press, 105&ndash;142.
</p>
<p>Touloumis, A. (2016) Simulating Correlated Binary and Multinomial Responses
under Marginal Model Specification: The SimCorMultRes Package. <em>The R
Journal</em> <b>8</b>, 79&ndash;91.
</p>
<p>Touloumis, A., Agresti, A. and Kateri, M. (2013) GEE for multinomial
responses using a local odds ratios parameterization. <em>Biometrics</em>
<b>69</b>, 633&ndash;640.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rbin">rbin</a></code> for simulating correlated binary responses,
<code><a href="#topic+rmult.clm">rmult.clm</a></code>, <code><a href="#topic+rmult.crm">rmult.crm</a></code> and
<code><a href="#topic+rmult.acl">rmult.acl</a></code> for simulating correlated ordinal responses.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See Example 3.1 in the Vignette.
betas &lt;- c(1, 3, 2, 1.25, 3.25, 1.75, 0.75, 2.75, 2.25, 0, 0, 0)
sample_size &lt;- 500
categories_no &lt;- 4
cluster_size &lt;- 3
set.seed(1)
x1 &lt;- rep(rnorm(sample_size), each = cluster_size)
x2 &lt;- rnorm(sample_size * cluster_size)
xdata &lt;- data.frame(x1, x2)
equicorrelation_matrix &lt;- toeplitz(c(1, rep(0.95, cluster_size - 1)))
identity_matrix &lt;- diag(categories_no)
latent_correlation_matrix &lt;- kronecker(equicorrelation_matrix,
  identity_matrix)
simulated_nominal_dataset &lt;- rmult.bcl(clsize = cluster_size,
  ncategories = categories_no, betas = betas, xformula = ~ x1 + x2,
  xdata = xdata, cor.matrix = latent_correlation_matrix)
suppressPackageStartupMessages(library("multgee"))
nominal_gee_model &lt;- nomLORgee(y ~ x1 + x2,
  data = simulated_nominal_dataset$simdata, id = id, repeated = time,
  LORstr = "time.exch")
round(coef(nominal_gee_model), 2)
</code></pre>

<hr>
<h2 id='rmult.clm'>Simulating Correlated Ordinal Responses Conditional on a Marginal Cumulative
Link Model Specification</h2><span id='topic+rmult.clm'></span>

<h3>Description</h3>

<p>Simulates correlated ordinal responses assuming a cumulative link model for
the marginal probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmult.clm(clsize = clsize, intercepts = intercepts, betas = betas,
  xformula = formula(xdata), xdata = parent.frame(), link = "logit",
  cor.matrix = cor.matrix, rlatent = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmult.clm_+3A_clsize">clsize</code></td>
<td>
<p>integer indicating the common cluster size.</p>
</td></tr>
<tr><td><code id="rmult.clm_+3A_intercepts">intercepts</code></td>
<td>
<p>numerical vector or matrix containing the intercepts of
the marginal cumulative link model.</p>
</td></tr>
<tr><td><code id="rmult.clm_+3A_betas">betas</code></td>
<td>
<p>numerical vector or matrix containing the value of the marginal
regression parameter vector associated with the covariates (i.e., excluding
<code>intercepts</code>).</p>
</td></tr>
<tr><td><code id="rmult.clm_+3A_xformula">xformula</code></td>
<td>
<p>formula expression as in other marginal regression models
but without including a response variable.</p>
</td></tr>
<tr><td><code id="rmult.clm_+3A_xdata">xdata</code></td>
<td>
<p>optional data frame containing the variables provided in
<code>xformula</code>.</p>
</td></tr>
<tr><td><code id="rmult.clm_+3A_link">link</code></td>
<td>
<p>character string indicating the link function in the marginal
cumulative link model. Options include <code>'probit'</code>, <code>'logit'</code>,
<code>'cloglog'</code> or <code>'cauchit'</code>. Required when <code>rlatent = NULL</code>.</p>
</td></tr>
<tr><td><code id="rmult.clm_+3A_cor.matrix">cor.matrix</code></td>
<td>
<p>matrix indicating the correlation matrix of the
multivariate normal distribution when the NORTA method is employed
(<code>rlatent = NULL</code>).</p>
</td></tr>
<tr><td><code id="rmult.clm_+3A_rlatent">rlatent</code></td>
<td>
<p>matrix with <code>clsize</code> columns containing realizations of
the latent random vectors when the NORTA method is not preferred. See
details for more info.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formulae are easier to read from either the Vignette or the Reference
Manual (both available
<a href="https://CRAN.R-project.org/package=SimCorMultRes">here</a>).
</p>
<p>The assumed marginal cumulative link model is </p>
<p style="text-align: center;"><code class="reqn">Pr(Y_{it}\le j
|x_{it})=F(\beta_{tj0} +\beta^{'}_{t} x_{it})</code>
</p>
<p> where <code class="reqn">F</code> is the
cumulative distribution function determined by <code>link</code>. For subject
<code class="reqn">i</code>, <code class="reqn">Y_{it}</code> is the <code class="reqn">t</code>-th ordinal response and <code class="reqn">x_{it}</code> is
the associated covariates vector. Finally, <code class="reqn">\beta_{tj0}</code> is the
<code class="reqn">j</code>-th category-specific intercept at the <code class="reqn">t</code>-th measurement
occasion and <code class="reqn">\beta_{tj}</code> is the <code class="reqn">j</code>-th category-specific regression
parameter vector at the <code class="reqn">t</code>-th measurement occasion.
</p>
<p>The ordinal response <code class="reqn">Y_{it}</code> is obtained by extending the approach of
<cite>McCullagh (1980)</cite> as suggested in <cite>Touloumis (2016)</cite>.
</p>
<p>When <code class="reqn">\beta_{tj0}=\beta_{j0}</code> for all <code class="reqn">t</code>, then <code>intercepts</code>
should be provided as a numerical vector. Otherwise, <code>intercepts</code> must
be a numerical matrix such that row <code class="reqn">t</code> contains the category-specific
intercepts at the <code class="reqn">t</code>-th measurement occasion.
</p>
<p><code>betas</code> should be provided as a numeric vector only when
<code class="reqn">\beta_{t}=\beta</code> for all <code class="reqn">t</code>. Otherwise, <code>betas</code> must be
provided as a numeric matrix with <code>clsize</code> rows such that the
<code class="reqn">t</code>-th row contains the value of <code class="reqn">\beta_{t}</code>. In either case,
<code>betas</code> should reflect the order of the terms implied by
<code>xformula</code>.
</p>
<p>The appropriate use of <code>xformula</code> is <code>xformula = ~ covariates</code>,
where <code>covariates</code> indicate the linear predictor as in other marginal
regression models.
</p>
<p>The optional argument <code>xdata</code> should be provided in &ldquo;long&rdquo; format.
</p>
<p>The NORTA method is the default option for simulating the latent random
vectors denoted by <code class="reqn">e^{O1}_{it}</code> in <cite>Touloumis (2016)</cite>. To import
simulated values for the latent random vectors without utilizing the NORTA
method, the user can employ the <code>rlatent</code> argument. In this case,
element (<code class="reqn">i,t</code>) of <code>rlatent</code> represents the realization of
<code class="reqn">e^{O1}_{it}</code>.
</p>


<h3>Value</h3>

<p>Returns a list that has components: </p>
<table>
<tr><td><code>Ysim</code></td>
<td>
<p>the simulated
ordinal responses. Element (<code class="reqn">i</code>,<code class="reqn">t</code>) represents the realization of
<code class="reqn">Y_{it}</code>.</p>
</td></tr> <tr><td><code>simdata</code></td>
<td>
<p>a data frame that includes the simulated
response variables (y), the covariates specified by <code>xformula</code>,
subjects' identities (id) and the corresponding measurement occasions
(time).</p>
</td></tr> <tr><td><code>rlatent</code></td>
<td>
<p>the latent random variables denoted by
<code class="reqn">e^{O1}_{it}</code> in <cite>Touloumis (2016)</cite>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Anestis Touloumis
</p>


<h3>References</h3>

<p>Cario, M. C. and Nelson, B. L. (1997) <em>Modeling and
generating random vectors with arbitrary marginal distributions and
correlation matrix</em>. Technical Report, Department of Industrial Engineering
and Management Sciences, Northwestern University, Evanston, Illinois.
</p>
<p>Li, S. T. and Hammond, J. L. (1975) Generation of pseudorandom numbers with
specified univariate distributions and correlation coefficients. <em>IEEE
Transactions on Systems, Man and Cybernetics</em> <b>5</b>, 557&ndash;561.
</p>
<p>McCullagh, P. (1980) Regression models for ordinal data. <em>Journal of
the Royal Statistical Society B</em> <b>42</b>, 109&ndash;142.
</p>
<p>Touloumis, A. (2016) Simulating Correlated Binary and Multinomial Responses
under Marginal Model Specification: The SimCorMultRes Package. <em>The R
Journal</em> <b>8</b>, 79&ndash;91.
</p>
<p>Touloumis, A., Agresti, A. and Kateri, M. (2013) GEE for multinomial
responses using a local odds ratios parameterization. <em>Biometrics</em>
<b>69</b>, 633&ndash;640.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rmult.bcl">rmult.bcl</a></code> for simulating correlated nominal
responses, <code><a href="#topic+rmult.crm">rmult.crm</a></code> and <code><a href="#topic+rmult.acl">rmult.acl</a></code> for
simulating correlated ordinal responses and <code><a href="#topic+rbin">rbin</a></code> for
simulating correlated binary responses.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See Example 3.2 in the Vignette.
set.seed(12345)
sample_size &lt;- 500
cluster_size &lt;- 4
beta_intercepts &lt;- c(-1.5, -0.5, 0.5, 1.5)
beta_coefficients &lt;- matrix(c(1, 2, 3, 4), 4, 1)
x &lt;- rep(rnorm(sample_size), each = cluster_size)
latent_correlation_matrix &lt;- toeplitz(c(1, 0.85, 0.5, 0.15))
simulated_ordinal_dataset &lt;- rmult.clm(clsize = cluster_size,
  intercepts = beta_intercepts, betas = beta_coefficients, xformula = ~x,
  cor.matrix = latent_correlation_matrix, link = "probit")
head(simulated_ordinal_dataset$simdata, n = 8)

## Same sampling scheme except that the parameter vector is time-stationary.
set.seed(12345)
simulated_ordinal_dataset &lt;- rmult.clm(clsize = cluster_size, betas = 1,
  xformula = ~x, cor.matrix = latent_correlation_matrix,
  intercepts = beta_intercepts, link = "probit")
## Fit a GEE model (Touloumis et al., 2013) to estimate the regression
## coefficients.
library(multgee)
ordinal_gee_model &lt;- ordLORgee(y ~ x, id = id, repeated = time,
  link = "probit", data = simulated_ordinal_dataset$simdata)
coef(ordinal_gee_model)
</code></pre>

<hr>
<h2 id='rmult.crm'>Simulating Correlated Ordinal Responses Conditional on a Marginal
Continuation-Ratio Model Specification</h2><span id='topic+rmult.crm'></span>

<h3>Description</h3>

<p>Simulates correlated ordinal responses assuming a continuation-ratio model
for the marginal probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmult.crm(clsize = clsize, intercepts = intercepts, betas = betas,
  xformula = formula(xdata), xdata = parent.frame(), link = "logit",
  cor.matrix = cor.matrix, rlatent = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmult.crm_+3A_clsize">clsize</code></td>
<td>
<p>integer indicating the common cluster size.</p>
</td></tr>
<tr><td><code id="rmult.crm_+3A_intercepts">intercepts</code></td>
<td>
<p>numerical vector or matrix containing the intercepts of
the marginal continuation-ratio model.</p>
</td></tr>
<tr><td><code id="rmult.crm_+3A_betas">betas</code></td>
<td>
<p>numerical vector or matrix containing the value of the marginal
regression parameter vector associated with the covariates (i.e., excluding
<code>intercepts</code>).</p>
</td></tr>
<tr><td><code id="rmult.crm_+3A_xformula">xformula</code></td>
<td>
<p>formula expression as in other marginal regression models
but without including a response variable.</p>
</td></tr>
<tr><td><code id="rmult.crm_+3A_xdata">xdata</code></td>
<td>
<p>optional data frame containing the variables provided in
<code>xformula</code>.</p>
</td></tr>
<tr><td><code id="rmult.crm_+3A_link">link</code></td>
<td>
<p>character string indicating the link function of the marginal
continuation-ratio model. Options include <code>'probit'</code>, <code>'logit'</code>,
<code>'cloglog'</code> or <code>'cauchit'</code>. Required when <code>rlatent = NULL</code>.</p>
</td></tr>
<tr><td><code id="rmult.crm_+3A_cor.matrix">cor.matrix</code></td>
<td>
<p>matrix indicating the correlation matrix of the
multivariate normal distribution when the NORTA method is employed
(<code>rlatent = NULL</code>).</p>
</td></tr>
<tr><td><code id="rmult.crm_+3A_rlatent">rlatent</code></td>
<td>
<p>matrix with <code>clsize</code> rows and <code>ncategories</code> columns
containing realizations of the latent random vectors when the NORTA method
is not employed. See details for more info.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formulae are easier to read from either the Vignette or the Reference
Manual (both available
<a href="https://CRAN.R-project.org/package=SimCorMultRes">here</a>).
</p>
<p>The assumed marginal continuation-ratio model is </p>
<p style="text-align: center;"><code class="reqn">Pr(Y_{it}=j |Y_{it}
\ge j,x_{it})=F(\beta_{tj0} +\beta^{'}_{t} x_{it})</code>
</p>
<p> where <code class="reqn">F</code> is the
cumulative distribution function determined by <code>link</code>. For subject
<code class="reqn">i</code>, <code class="reqn">Y_{it}</code> is the <code class="reqn">t</code>-th multinomial response and
<code class="reqn">x_{it}</code> is the associated covariates vector. Finally, <code class="reqn">\beta_{tj0}</code>
is the <code class="reqn">j</code>-th category-specific intercept at the <code class="reqn">t</code>-th measurement
occasion and <code class="reqn">\beta_{tj}</code> is the <code class="reqn">j</code>-th category-specific regression
parameter vector at the <code class="reqn">t</code>-th measurement occasion.
</p>
<p>The ordinal response <code class="reqn">Y_{it}</code> is determined by extending the latent
variable threshold approach of <cite>Tutz (1991)</cite> as suggested in
<cite>Touloumis (2016)</cite>.
</p>
<p>When <code class="reqn">\beta_{tj0}=\beta_{j0}</code> for all <code class="reqn">t</code>, then <code>intercepts</code>
should be provided as a numerical vector. Otherwise, <code>intercepts</code> must
be a numerical matrix such that row <code class="reqn">t</code> contains the category-specific
intercepts at the <code class="reqn">t</code>-th measurement occasion.
</p>
<p><code>betas</code> should be provided as a numeric vector only when
<code class="reqn">\beta_{t}=\beta</code> for all <code class="reqn">t</code>. Otherwise, <code>betas</code> must be
provided as a numeric matrix with <code>clsize</code> rows such that the
<code class="reqn">t</code>-th row contains the value of <code class="reqn">\beta_{t}</code>. In either case,
<code>betas</code> should reflect the order of the terms implied by
<code>xformula</code>.
</p>
<p>The appropriate use of <code>xformula</code> is <code>xformula = ~ covariates</code>,
where <code>covariates</code> indicate the linear predictor as in other marginal
regression models.
</p>
<p>The optional argument <code>xdata</code> should be provided in &ldquo;long&rdquo; format.
</p>
<p>The NORTA method is the default option for simulating the latent random
vectors denoted by <code class="reqn">e^{O2}_{itj}</code> in <cite>Touloumis (2016)</cite>. In this
case, the algorithm forces <code>cor.matrix</code> to respect the local
independence assumption. To import simulated values for the latent random
vectors without utilizing the NORTA method, the user can employ the
<code>rlatent</code> argument. In this case, row <code class="reqn">i</code> corresponds to subject
<code class="reqn">i</code> and columns
<code class="reqn">(t-1)*\code{ncategories}+1,...,t*\code{ncategories}</code> should contain the
realization of <code class="reqn">e^{O2}_{it1},...,e^{O2}_{itJ}</code>, respectively, for
<code class="reqn">t=1,\ldots,\code{clsize}</code>.
</p>


<h3>Value</h3>

<p>Returns a list that has components: </p>
<table>
<tr><td><code>Ysim</code></td>
<td>
<p>the simulated
ordinal responses. Element (<code class="reqn">i</code>,<code class="reqn">t</code>) represents the realization of
<code class="reqn">Y_{it}</code>.</p>
</td></tr> <tr><td><code>simdata</code></td>
<td>
<p>a data frame that includes the simulated
response variables (y), the covariates specified by <code>xformula</code>,
subjects' identities (id) and the corresponding measurement occasions
(time).</p>
</td></tr> <tr><td><code>rlatent</code></td>
<td>
<p>the latent random variables denoted by
<code class="reqn">e^{O2}_{it}</code> in <cite>Touloumis (2016)</cite>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Anestis Touloumis
</p>


<h3>References</h3>

<p>Cario, M. C. and Nelson, B. L. (1997) <em>Modeling and
generating random vectors with arbitrary marginal distributions and
correlation matrix</em>. Technical Report, Department of Industrial Engineering
and Management Sciences, Northwestern University, Evanston, Illinois.
</p>
<p>Li, S. T. and Hammond, J. L. (1975) Generation of pseudorandom numbers with
specified univariate distributions and correlation coefficients. <em>IEEE
Transactions on Systems, Man and Cybernetics</em> <b>5</b>, 557&ndash;561.
</p>
<p>Touloumis, A. (2016) Simulating Correlated Binary and Multinomial Responses
under Marginal Model Specification: The SimCorMultRes Package. <em>The R
Journal (forthcoming)</em>.
</p>
<p>Tutz, G. (1991) Sequential models in categorical regression.
<em>Computational Statistics &amp; Data Analysis</em> <b>11</b>, 275&ndash;295.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rmult.bcl">rmult.bcl</a></code> for simulating correlated nominal
responses, <code><a href="#topic+rmult.clm">rmult.clm</a></code> and <code><a href="#topic+rmult.acl">rmult.acl</a></code> for simulating
correlated ordinal responses and <code><a href="#topic+rbin">rbin</a></code> for simulating
correlated binary responses.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See Example 3.3 in the Vignette.
set.seed(1)
sample_size &lt;- 500
cluster_size &lt;- 4
beta_intercepts &lt;- c(-1.5, -0.5, 0.5, 1.5)
beta_coefficients &lt;- 1
x &lt;- rnorm(sample_size * cluster_size)
categories_no &lt;- 5
identity_matrix &lt;- diag(1, (categories_no - 1) * cluster_size)
equicorrelation_matrix &lt;- toeplitz(c(0, rep(0.24, categories_no - 2)))
ones_matrix &lt;- matrix(1, cluster_size, cluster_size)
latent_correlation_matrix &lt;- identity_matrix +
  kronecker(equicorrelation_matrix, ones_matrix)
simulated_ordinal_dataset &lt;- rmult.crm(clsize = cluster_size,
  intercepts = beta_intercepts, betas = beta_coefficients, xformula = ~x,
  cor.matrix = latent_correlation_matrix, link = "probit")
head(simulated_ordinal_dataset$Ysim)
</code></pre>

<hr>
<h2 id='rnorta'>Simulating Random Vectors using the NORTA Method</h2><span id='topic+rnorta'></span>

<h3>Description</h3>

<p>Utility function to simulate random vectors with predefined marginal
distributions via the NORTA method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rnorta(R = R, cor.matrix = cor.matrix, distr = distr,
  qparameters = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rnorta_+3A_r">R</code></td>
<td>
<p>integer indicating the sample size.</p>
</td></tr>
<tr><td><code id="rnorta_+3A_cor.matrix">cor.matrix</code></td>
<td>
<p>matrix indicating the correlation matrix of the
multivariate normal distribution employed in the NORTA method.</p>
</td></tr>
<tr><td><code id="rnorta_+3A_distr">distr</code></td>
<td>
<p>character string vector of length <code>ncol(cor.matrix)</code>
naming the quantile functions of the desired marginal distributions.</p>
</td></tr>
<tr><td><code id="rnorta_+3A_qparameters">qparameters</code></td>
<td>
<p>list of <code>ncol(cor.matrix)</code> lists indicating the
parameter values of the quantile functions specified by <code>distr</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Checks are made to ensure that <code>cor.matrix</code> is a positive definite
correlation matrix. The positive definiteness of <code>cor.matrix</code> is
assessed via eigenvalues.
</p>
<p>The <code class="reqn">t</code>-th character string in <code>distr</code> indicates the quantile
function of the <code class="reqn">t</code>-th marginal distribution. See
<code><a href="stats.html#topic+Distributions">Distributions</a></code> for the most common distributions. Quantile
functions supported by other R packages are allowed provided that these
packages have been uploaded first. However, note that no checks are made to
ensure that the character strings in <code>distr</code> correspond to valid names
of quantile functions.
</p>
<p>If <code>qparameters = NULL</code> then the default parameter values for the
quantile functions specified by <code>distr</code> are used. Otherwise,
<code>qparameters</code> should be provided as a list of <code>ncol(cor.matrix)</code>
lists such that the <code class="reqn">t</code>-th list contains the desired parameter values of
the <code class="reqn">t</code>-th quantile function.
</p>


<h3>Value</h3>

<p>Returns <code>R</code> random vectors of size <code>ncol(cor.matrix)</code> with
marginal distributions specified by <code>distr</code> (and <code>qparameters</code>).
</p>


<h3>Author(s)</h3>

<p>Anestis Touloumis
</p>


<h3>References</h3>

<p>Cario, M. C. and Nelson, B. L. (1997) <em>Modeling and
generating random vectors with arbitrary marginal distributions and
correlation matrix</em>. Technical Report, Department of Industrial Engineering
and Management Sciences, Northwestern University, Evanston, Illinois.
</p>
<p>Li, S. T. and Hammond, J. L. (1975) Generation of pseudorandom numbers with
specified univariate distributions and correlation coefficients. <em>IEEE
Transactions on Systems, Man and Cybernetics</em> <b>5</b>, 557&ndash;561.
</p>
<p>Touloumis, A. (2016) Simulating Correlated Binary and Multinomial Responses
under Marginal Model Specification: The SimCorMultRes Package. <em>The R
Journal</em> <b>8</b>, 79&ndash;91.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## An example with standard logistic as marginal distribution.
set.seed(1)
sample_size &lt;- 1000
latent_correlation_matrix &lt;- toeplitz(c(1, rep(0.8, 2)))
latent_correlation_matrix
common_marginal_distribution &lt;- rep("qlogis", 3)
simulated_logistic_responses &lt;- rnorta(R = sample_size,
  cor.matrix = latent_correlation_matrix,
  distr = common_marginal_distribution)

## The following lines exemplify the NORTA method.
set.seed(1)
simulated_normal_responses &lt;- rsmvnorm(R = sample_size,
  cor.matrix = latent_correlation_matrix)
norta_simulated &lt;- qlogis(pnorm(simulated_normal_responses))
all(simulated_logistic_responses == norta_simulated)

## Change the marginal distributions to standard normal, standard
## logistic and standard extreme value distribution.
set.seed(1)
different_marginal_distributions &lt;- c("qnorm", "qlogis", "qgumbel")
simulated_logistic_responses &lt;- rnorta(R = sample_size,
  cor.matrix = latent_correlation_matrix,
  distr = different_marginal_distributions)
cor(simulated_logistic_responses)
colMeans(simulated_logistic_responses)
apply(simulated_logistic_responses, 2, sd)

## Same as above but using parameter values other than the default ones.
set.seed(1)
qpars &lt;- list(c(mean = 1, sd = 9), c(location = 2, scale = 1),
  c(loc = 3, scale = 1))
simulated_logistic_responses &lt;- rnorta(R = sample_size,
  cor.matrix = latent_correlation_matrix,
  distr = different_marginal_distributions, qparameters = qpars)
cor(simulated_logistic_responses)
colMeans(simulated_logistic_responses)
apply(simulated_logistic_responses, 2, sd)
</code></pre>

<hr>
<h2 id='rsmvnorm'>Simulating Continuous Random Vectors from a Multivariate Normal Distribution</h2><span id='topic+rsmvnorm'></span>

<h3>Description</h3>

<p>Utility function to simulate continuous random vectors from a multivariate
normal distribution such that all marginal distributions are univariate
standard normal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsmvnorm(R = R, cor.matrix = cor.matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsmvnorm_+3A_r">R</code></td>
<td>
<p>integer indicating the sample size.</p>
</td></tr>
<tr><td><code id="rsmvnorm_+3A_cor.matrix">cor.matrix</code></td>
<td>
<p>matrix indicating the correlation matrix of the
multivariate normal distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Checks are made to ensure that <code>cor.matrix</code> is a positive definite
correlation matrix. The positive definiteness of <code>cor.matrix</code> is
assessed via eigenvalues.
</p>


<h3>Value</h3>

<p>Returns <code>R</code> random vectors of size <code>ncol(cor.matrix)</code>.
</p>


<h3>Author(s)</h3>

<p>Anestis Touloumis
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Simulating 10000 bivariate random vectors with correlation parameter
## equal to 0.4.
set.seed(1)
sample_size &lt;- 10000
correlation_matrix &lt;- toeplitz(c(1, 0.4))
simulated_normal_responses &lt;- rsmvnorm(R = sample_size,
  cor.matrix = correlation_matrix)
colMeans(simulated_normal_responses)
apply(simulated_normal_responses, 2, sd)
cor(simulated_normal_responses)
</code></pre>

<hr>
<h2 id='simulation'>Simulated Correlation Parameters</h2><span id='topic+simulation'></span>

<h3>Description</h3>

<p>A simulated dataset to explore the association between the correlation
parameter of bivariate normally distributed random variables used in the
intermediate step of the NORTA method and the correlation parameter of the
resulting non-normal random responses generated by the NORTA method for all
the threshold approached implemented in this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation
</code></pre>


<h3>Format</h3>

<p>A data frame with 100 rows and 4 columns:
</p>

<dl>
<dt>rho</dt><dd><p>numeric indicating the true value of the correlation parameter.</p>
</dd>
<dt>normal</dt><dd><p>numeric indicating the simulated correlation parameter when
the marginal distribution of each of the latent variables is normal.</p>
</dd>
<dt>logistic</dt><dd><p>numeric indicating the simulated correlation parameter
when the marginal distribution of each of the latent variables is
logistic.</p>
</dd>
<dt>gumbel</dt><dd><p>numeric indicating the simulated correlation parameter when
the marginal distribution of each of the latent variables is Gumbel.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>plot(rho - normal ~ rho, data = simulation, type = "l", col = "blue",
    ylim = c(0, 0.016),
    ylab = expression(rho - bar(rho)[sim]),
    xlab = expression(rho))
points(rho - logistic ~ rho, data = simulation, type = "l", col = "red")
points(rho - gumbel ~ rho, data = simulation, type = "l", col = "grey")
legend("topright", legend = c("Normal", "Logistic", "Gumbel"),
      col = c("blue", "red", "grey"), pch = "l" )
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
