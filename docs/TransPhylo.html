<!DOCTYPE html><html lang="en"><head><title>Help for package TransPhylo</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TransPhylo}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#TransPhylo-package'><p>Inference of Transmission Tree from a Dated Phylogeny</p></a></li>
<li><a href='#as.mcmc.resTransPhylo'><p>Convert to coda mcmc format</p></a></li>
<li><a href='#computeMatTDist'><p>Build a matrix indicating for each pairs of individuals how many intermediates there are in the transmission chain</p></a></li>
<li><a href='#computeMatWIW'><p>Build a matrix of probability of who infected whom from a MCMC output</p></a></li>
<li><a href='#consTTree'><p>Build a consensus transmission tree from a MCMC output</p></a></li>
<li><a href='#convertToCoda'><p>Convert to coda mcmc format</p></a></li>
<li><a href='#dateLastSample'><p>Return the date of last sample from a ttree or ctree or ptree</p></a></li>
<li><a href='#extractCTree'><p>Return the combined tree corresponding to a given iteration of the TransPhylo results</p></a></li>
<li><a href='#extractPTree'><p>Extracts phylogenetic tree from a combined phylogenetic/transmission tree</p></a></li>
<li><a href='#extractTTree'><p>Extracts transmission tree from a combined phylogenetic/transmission tree</p></a></li>
<li><a href='#getGenerationTimeDist'><p>Extract and return realised generation time distribution</p></a></li>
<li><a href='#getIncidentCases'><p>Returns and/or plot numbers of sampled and unsampled cases over time</p></a></li>
<li><a href='#getInfectionTimeDist'><p>Extract and return distribution of infection time of given sampled case(s)</p></a></li>
<li><a href='#getOffspringDist'><p>Extract and return offspring distribution of given sampled case(s)</p></a></li>
<li><a href='#getSamplingTimeDist'><p>Extract and return realised sampling time distribution</p></a></li>
<li><a href='#infer_multittree_share_param'><p>Simultaneously infer transmission trees given phylogenetic trees</p>
User can specify any subset of parameters that will be shared by providing a character vector of parameter names to
the argument &quot;share&quot;.</a></li>
<li><a href='#inferTTree'><p>Infer transmission tree given a phylogenetic tree</p></a></li>
<li><a href='#makeCTreeFromPTree'><p>Create a transmission tree compatible with the provided phylogenetic tree</p></a></li>
<li><a href='#makeTTree'><p>Simulate a transmission tree</p></a></li>
<li><a href='#medTTree'><p>Return the medoid from a MCMC output</p></a></li>
<li><a href='#phyloFromPTree'><p>Converts a phylogenetic tree into an ape phylo object</p></a></li>
<li><a href='#plot.ctree'><p>Plotting for ctree</p></a></li>
<li><a href='#plot.ptree'><p>Plotting for ptree</p></a></li>
<li><a href='#plot.resTransPhylo'><p>Plotting for resTransPhylo</p></a></li>
<li><a href='#plot.ttree'><p>Plotting for ttree</p></a></li>
<li><a href='#plotCTree'><p>Plot both phylogenetic and transmission trees using colors on the phylogeny</p></a></li>
<li><a href='#plotTraces'><p>Plot MCMC traces</p></a></li>
<li><a href='#plotTTree'><p>Plot a transmission tree in a detailed format</p></a></li>
<li><a href='#plotTTree2'><p>Plot a transmission tree in an economic format</p></a></li>
<li><a href='#print.ctree'><p>Print function for ctree objects</p></a></li>
<li><a href='#print.ptree'><p>Print function for ptree objects</p></a></li>
<li><a href='#print.resTransPhylo'><p>Print function for resTransPhylo objects</p></a></li>
<li><a href='#print.ttree'><p>Print function for ttree objects</p></a></li>
<li><a href='#probPTreeGivenTTree'><p>Calculate the probability of a phylogenetic tree given a transmission tree</p></a></li>
<li><a href='#probPTreeGivenTTreeR'><p>Calculate the probability of a phylogenetic tree given a transmission tree</p></a></li>
<li><a href='#probTTree'><p>Calculates the log-probability of a transmission tree</p></a></li>
<li><a href='#probTTreeR'><p>Calculates the log-probability of a transmission tree</p></a></li>
<li><a href='#ptreeFromPhylo'><p>Converts an ape phylo object into a phylogenetic tree</p></a></li>
<li><a href='#selectTTree'><p>Select the most representative transmission tree from a MCMC output</p></a></li>
<li><a href='#simulateOutbreak'><p>Simulate an outbreak</p></a></li>
<li><a href='#summary.resTransPhylo'><p>Summary function for resTransPhylo objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.4.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-04-20</td>
</tr>
<tr>
<td>Title:</td>
<td>Inference of Transmission Tree from a Dated Phylogeny</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xavier Didelot &lt;xavier.didelot@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Inference of transmission tree from a dated phylogeny. 
    Includes methods to simulate and analyse outbreaks.
    The methodology is described in
    Didelot et al. (2014) &lt;<a href="https://doi.org/10.1093%2Fmolbev%2Fmsu121">doi:10.1093/molbev/msu121</a>&gt;,
    Didelot et al. (2017) &lt;<a href="https://doi.org/10.1093%2Fmolbev%2Fmsw275">doi:10.1093/molbev/msw275</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.8), stats, graphics, ape</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, testthat, purrr, coda, grDevices, lattice, rmarkdown</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-04-20 12:19:58 UTC; Xavier</td>
</tr>
<tr>
<td>Author:</td>
<td>Xavier Didelot <a href="https://orcid.org/0000-0003-1885-500X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Yuanwei Xu [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-04-20 13:30:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='TransPhylo-package'>Inference of Transmission Tree from a Dated Phylogeny</h2><span id='topic+TransPhylo-package'></span><span id='topic+TransPhylo'></span>

<h3>Description</h3>

<p>Inference of transmission tree from a dated phylogeny. 
Includes methods to simulate and analyse outbreaks.
</p>


<h3>Author(s)</h3>

<p>Xavier Didelot <a href="mailto:xavier.didelot@gmail.com">xavier.didelot@gmail.com</a>
</p>


<h3>References</h3>

<p>Didelot et al. (2014) &lt;doi:10.1093/molbev/msu121&gt;
Didelot et al. (2017) &lt;doi:10.1093/molbev/msw275&gt;.
</p>


<h3>See Also</h3>

<p>https://github.com/xavierdidelot/TransPhylo
</p>

<hr>
<h2 id='as.mcmc.resTransPhylo'>Convert to coda mcmc format</h2><span id='topic+as.mcmc.resTransPhylo'></span>

<h3>Description</h3>

<p>Convert to coda mcmc format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.mcmc.resTransPhylo(x, burnin = 0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.mcmc.resTransPhylo_+3A_x">x</code></td>
<td>
<p>Output from inferTTree</p>
</td></tr>
<tr><td><code id="as.mcmc.resTransPhylo_+3A_burnin">burnin</code></td>
<td>
<p>Proportion of the MCMC output to be discarded as burnin</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mcmc object from coda package
</p>

<hr>
<h2 id='computeMatTDist'>Build a matrix indicating for each pairs of individuals how many intermediates there are in the transmission chain</h2><span id='topic+computeMatTDist'></span>

<h3>Description</h3>

<p>Build a matrix indicating for each pairs of individuals how many intermediates there are in the transmission chain
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeMatTDist(record, burnin = 0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computeMatTDist_+3A_record">record</code></td>
<td>
<p>Output from inferTTree function</p>
</td></tr>
<tr><td><code id="computeMatTDist_+3A_burnin">burnin</code></td>
<td>
<p>Proportion of the MCMC output to be discarded as burnin</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of intermediates in transmission chains between pairs of hosts
</p>

<hr>
<h2 id='computeMatWIW'>Build a matrix of probability of who infected whom from a MCMC output</h2><span id='topic+computeMatWIW'></span>

<h3>Description</h3>

<p>Build a matrix of probability of who infected whom from a MCMC output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeMatWIW(record, burnin = 0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computeMatWIW_+3A_record">record</code></td>
<td>
<p>Output from inferTTree function</p>
</td></tr>
<tr><td><code id="computeMatWIW_+3A_burnin">burnin</code></td>
<td>
<p>Proportion of the MCMC output to be discarded as burnin</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of probability of who infected whom
</p>

<hr>
<h2 id='consTTree'>Build a consensus transmission tree from a MCMC output</h2><span id='topic+consTTree'></span>

<h3>Description</h3>

<p>Build a consensus transmission tree from a MCMC output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>consTTree(record, burnin = 0.5, minimum = 0.2, debug = F)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="consTTree_+3A_record">record</code></td>
<td>
<p>Output from inferTTree function</p>
</td></tr>
<tr><td><code id="consTTree_+3A_burnin">burnin</code></td>
<td>
<p>Proportion of the MCMC output to be discarded as burnin</p>
</td></tr>
<tr><td><code id="consTTree_+3A_minimum">minimum</code></td>
<td>
<p>Minimum probability for inclusion of a partition in the consensus</p>
</td></tr>
<tr><td><code id="consTTree_+3A_debug">debug</code></td>
<td>
<p>Used for debugging</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The consensus transmission tree
</p>

<hr>
<h2 id='convertToCoda'>Convert to coda mcmc format</h2><span id='topic+convertToCoda'></span>

<h3>Description</h3>

<p>Convert to coda mcmc format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convertToCoda(record, burnin = 0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convertToCoda_+3A_record">record</code></td>
<td>
<p>Output from inferTTree function</p>
</td></tr>
<tr><td><code id="convertToCoda_+3A_burnin">burnin</code></td>
<td>
<p>Proportion of the MCMC output to be discarded as burnin</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class mcmc from coda package
</p>

<hr>
<h2 id='dateLastSample'>Return the date of last sample from a ttree or ctree or ptree</h2><span id='topic+dateLastSample'></span>

<h3>Description</h3>

<p>Return the date of last sample from a ttree or ctree or ptree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dateLastSample(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dateLastSample_+3A_x">x</code></td>
<td>
<p>A transmission tree or colored tree or phylogenetic tree</p>
</td></tr>
</table>


<h3>Value</h3>

<p>date of the last sample
</p>

<hr>
<h2 id='extractCTree'>Return the combined tree corresponding to a given iteration of the TransPhylo results</h2><span id='topic+extractCTree'></span>

<h3>Description</h3>

<p>Return the combined tree corresponding to a given iteration of the TransPhylo results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractCTree(res, iteration)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extractCTree_+3A_res">res</code></td>
<td>
<p>Output from inferTTree command</p>
</td></tr>
<tr><td><code id="extractCTree_+3A_iteration">iteration</code></td>
<td>
<p>Number of the iteration to be extracted</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The colored tree at the specified iteeatino
</p>

<hr>
<h2 id='extractPTree'>Extracts phylogenetic tree from a combined phylogenetic/transmission tree</h2><span id='topic+extractPTree'></span>

<h3>Description</h3>

<p>Extracts phylogenetic tree from a combined phylogenetic/transmission tree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractPTree(ctree)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extractPTree_+3A_ctree">ctree</code></td>
<td>
<p>Combined tree</p>
</td></tr>
</table>


<h3>Value</h3>

<p>phylogenetic tree
</p>


<h3>Examples</h3>

<pre><code class='language-R'>extractPTree(simulateOutbreak())
</code></pre>

<hr>
<h2 id='extractTTree'>Extracts transmission tree from a combined phylogenetic/transmission tree</h2><span id='topic+extractTTree'></span>

<h3>Description</h3>

<p>Extracts transmission tree from a combined phylogenetic/transmission tree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractTTree(ctree)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extractTTree_+3A_ctree">ctree</code></td>
<td>
<p>Combined tree</p>
</td></tr>
</table>


<h3>Value</h3>

<p>transmission tree
</p>


<h3>Examples</h3>

<pre><code class='language-R'>extractTTree(simulateOutbreak())
</code></pre>

<hr>
<h2 id='getGenerationTimeDist'>Extract and return realised generation time distribution</h2><span id='topic+getGenerationTimeDist'></span>

<h3>Description</h3>

<p>Extract and return realised generation time distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getGenerationTimeDist(
  record,
  burnin = 0.5,
  maxi = 2,
  numBins = 20,
  show.plot = F
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getGenerationTimeDist_+3A_record">record</code></td>
<td>
<p>MCMC output produced by inferTTree</p>
</td></tr>
<tr><td><code id="getGenerationTimeDist_+3A_burnin">burnin</code></td>
<td>
<p>Proportion of the MCMC output to be discarded as burnin</p>
</td></tr>
<tr><td><code id="getGenerationTimeDist_+3A_maxi">maxi</code></td>
<td>
<p>Maximum generation time to consider</p>
</td></tr>
<tr><td><code id="getGenerationTimeDist_+3A_numbins">numBins</code></td>
<td>
<p>Number of time bins to compute and display distribution</p>
</td></tr>
<tr><td><code id="getGenerationTimeDist_+3A_show.plot">show.plot</code></td>
<td>
<p>Show a barplot of the distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of times between becoming infected and infecting others (generation times) in the posterior
</p>

<hr>
<h2 id='getIncidentCases'>Returns and/or plot numbers of sampled and unsampled cases over time</h2><span id='topic+getIncidentCases'></span>

<h3>Description</h3>

<p>Returns and/or plot numbers of sampled and unsampled cases over time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getIncidentCases(
  record,
  burnin = 0.5,
  numBins = 10,
  dateT = NA,
  show.plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getIncidentCases_+3A_record">record</code></td>
<td>
<p>Output from inferTTree function</p>
</td></tr>
<tr><td><code id="getIncidentCases_+3A_burnin">burnin</code></td>
<td>
<p>Proportion of the MCMC output to be discarded as burnin</p>
</td></tr>
<tr><td><code id="getIncidentCases_+3A_numbins">numBins</code></td>
<td>
<p>Number of time bins to compute and display incident cases</p>
</td></tr>
<tr><td><code id="getIncidentCases_+3A_datet">dateT</code></td>
<td>
<p>Date when process stops (this can be Inf for fully resolved outbreaks)</p>
</td></tr>
<tr><td><code id="getIncidentCases_+3A_show.plot">show.plot</code></td>
<td>
<p>Show a plot of incident cases over time with stacked bars</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with four entries. Time is a vector of the time points. allCases is the average number of cases at each time in the posterior. sampledCases: average number of sampled cases. unsampCases: average number of unsampled cases.
</p>

<hr>
<h2 id='getInfectionTimeDist'>Extract and return distribution of infection time of given sampled case(s)</h2><span id='topic+getInfectionTimeDist'></span>

<h3>Description</h3>

<p>Extract and return distribution of infection time of given sampled case(s)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getInfectionTimeDist(record, burnin = 0.5, k, numBins = 10, show.plot = F)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getInfectionTimeDist_+3A_record">record</code></td>
<td>
<p>MCMC output produced by inferTTree</p>
</td></tr>
<tr><td><code id="getInfectionTimeDist_+3A_burnin">burnin</code></td>
<td>
<p>Proportion of the MCMC output to be discarded as burnin</p>
</td></tr>
<tr><td><code id="getInfectionTimeDist_+3A_k">k</code></td>
<td>
<p>Case(s) whose posterior infection times are to be extracted. Either a string matching one of the case names in the data, or a vector of such strings</p>
</td></tr>
<tr><td><code id="getInfectionTimeDist_+3A_numbins">numBins</code></td>
<td>
<p>Number of bins to use for plot</p>
</td></tr>
<tr><td><code id="getInfectionTimeDist_+3A_show.plot">show.plot</code></td>
<td>
<p>Show a barplot of the distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Posterior infection times for the case(s) in k. If length(k)==1 then a vector is returned, otherwise a matrix
</p>

<hr>
<h2 id='getOffspringDist'>Extract and return offspring distribution of given sampled case(s)</h2><span id='topic+getOffspringDist'></span>

<h3>Description</h3>

<p>Extract and return offspring distribution of given sampled case(s)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getOffspringDist(record, burnin = 0.5, k, show.plot = F)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getOffspringDist_+3A_record">record</code></td>
<td>
<p>MCMC output produced by inferTTree</p>
</td></tr>
<tr><td><code id="getOffspringDist_+3A_burnin">burnin</code></td>
<td>
<p>Proportion of the MCMC output to be discarded as burnin</p>
</td></tr>
<tr><td><code id="getOffspringDist_+3A_k">k</code></td>
<td>
<p>Case(s) whose offspring distribution are to be extracted. Either a string matching one of the case names in the data, or a vector of such strings</p>
</td></tr>
<tr><td><code id="getOffspringDist_+3A_show.plot">show.plot</code></td>
<td>
<p>Show a barplot of the distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Posterior offspring distribution for the case(s) in k. If length(k)==1 then a vector is returned, otherwise a matrix
</p>

<hr>
<h2 id='getSamplingTimeDist'>Extract and return realised sampling time distribution</h2><span id='topic+getSamplingTimeDist'></span>

<h3>Description</h3>

<p>Extract and return realised sampling time distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSamplingTimeDist(
  record,
  burnin = 0.5,
  maxi = 2,
  numBins = 20,
  show.plot = F
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getSamplingTimeDist_+3A_record">record</code></td>
<td>
<p>MCMC output produced by inferTTree</p>
</td></tr>
<tr><td><code id="getSamplingTimeDist_+3A_burnin">burnin</code></td>
<td>
<p>Proportion of the MCMC output to be discarded as burnin</p>
</td></tr>
<tr><td><code id="getSamplingTimeDist_+3A_maxi">maxi</code></td>
<td>
<p>Maximum generation time to consider</p>
</td></tr>
<tr><td><code id="getSamplingTimeDist_+3A_numbins">numBins</code></td>
<td>
<p>Number of time bins to compute and display distribution</p>
</td></tr>
<tr><td><code id="getSamplingTimeDist_+3A_show.plot">show.plot</code></td>
<td>
<p>Show a barplot of the distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of times between becoming infected and becoming sampled in the posterior
</p>

<hr>
<h2 id='infer_multittree_share_param'>Simultaneously infer transmission trees given phylogenetic trees 
User can specify any subset of parameters that will be shared by providing a character vector of parameter names to 
the argument &quot;share&quot;.</h2><span id='topic+infer_multittree_share_param'></span>

<h3>Description</h3>

<p>Simultaneously infer transmission trees given phylogenetic trees 
User can specify any subset of parameters that will be shared by providing a character vector of parameter names to 
the argument &quot;share&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>infer_multittree_share_param(
  ptree_lst,
  w.shape = 2,
  w.scale = 1,
  ws.shape = w.shape,
  ws.scale = w.scale,
  mcmcIterations = 1000,
  thinning = 1,
  startNeg = 100/365,
  startOff.r = 1,
  startOff.p = 0.5,
  startPi = 0.5,
  prior_pi_a = 1,
  prior_pi_b = 1,
  updateNeg = TRUE,
  updateOff.r = TRUE,
  updateOff.p = FALSE,
  updatePi = TRUE,
  share = NULL,
  startCTree_lst = rep(NA, length(ptree_lst)),
  updateTTree = TRUE,
  optiStart = 2,
  dateT = Inf,
  verbose = F
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="infer_multittree_share_param_+3A_ptree_lst">ptree_lst</code></td>
<td>
<p>List of phylogenetic tree</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_w.shape">w.shape</code></td>
<td>
<p>Shape parameter of the Gamma probability density function representing the generation time</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_w.scale">w.scale</code></td>
<td>
<p>Scale parameter of the Gamma probability density function representing the generation time</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_ws.shape">ws.shape</code></td>
<td>
<p>Shape parameter of the Gamma probability density function representing the sampling time</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_ws.scale">ws.scale</code></td>
<td>
<p>Scale parameter of the Gamma probability density function representing the sampling time</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_mcmciterations">mcmcIterations</code></td>
<td>
<p>Number of MCMC iterations to run the algorithm for</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_thinning">thinning</code></td>
<td>
<p>MCMC thinning interval between two sampled iterations</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_startneg">startNeg</code></td>
<td>
<p>Starting value of within-host coalescent parameter Ne*g</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_startoff.r">startOff.r</code></td>
<td>
<p>Starting value of parameter off.r</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_startoff.p">startOff.p</code></td>
<td>
<p>Starting value of parameter off.p</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_startpi">startPi</code></td>
<td>
<p>Starting value of sampling proportion pi</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_prior_pi_a">prior_pi_a</code></td>
<td>
<p>First shape parameter of Beta prior for pi</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_prior_pi_b">prior_pi_b</code></td>
<td>
<p>Second shape parameter of Beta prior for pi</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_updateneg">updateNeg</code></td>
<td>
<p>Whether of not to update the parameter Ne*g</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_updateoff.r">updateOff.r</code></td>
<td>
<p>Whether or not to update the parameter off.r</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_updateoff.p">updateOff.p</code></td>
<td>
<p>Whether or not to update the parameter off.p</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_updatepi">updatePi</code></td>
<td>
<p>Whether or not to update the parameter pi</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_share">share</code></td>
<td>
<p>Character vector of parameters to be shared. For example, share = c(&quot;off.r&quot;, &quot;off.p&quot;) would 
share the offspring distribution. Allowed parameter names are &quot;neg&quot;, &quot;off.r&quot;, &quot;off.p&quot; and &quot;pi&quot;.</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_startctree_lst">startCTree_lst</code></td>
<td>
<p>Optional combined list of trees to start from</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_updatettree">updateTTree</code></td>
<td>
<p>Whether or not to update the transmission tree</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_optistart">optiStart</code></td>
<td>
<p>Type of optimisation to apply to MCMC start point (0=none, 1=slow, 2=fast)</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_datet">dateT</code></td>
<td>
<p>Date when process stops (this can be Inf for fully simulated outbreaks)</p>
</td></tr>
<tr><td><code id="infer_multittree_share_param_+3A_verbose">verbose</code></td>
<td>
<p>Whether or not to use verbose mode (default is false)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list the same size as input, each element contains posterior transmission trees inferred from
corresponding phylogenetic tree
</p>


<h3>Author(s)</h3>

<p>Yuanwei Xu
</p>

<hr>
<h2 id='inferTTree'>Infer transmission tree given a phylogenetic tree</h2><span id='topic+inferTTree'></span>

<h3>Description</h3>

<p>Infer transmission tree given a phylogenetic tree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inferTTree(
  ptree,
  w.shape = 2,
  w.scale = 1,
  ws.shape = NA,
  ws.scale = NA,
  w.mean = NA,
  w.std = NA,
  ws.mean = NA,
  ws.std = NA,
  mcmcIterations = 1000,
  thinning = 1,
  startNeg = 100/365,
  startOff.r = 1,
  startOff.p = 0.5,
  startPi = 0.5,
  updateNeg = TRUE,
  updateOff.r = TRUE,
  updateOff.p = FALSE,
  updatePi = TRUE,
  startCTree = NA,
  updateTTree = TRUE,
  optiStart = 2,
  dateT = Inf,
  verbose = F
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inferTTree_+3A_ptree">ptree</code></td>
<td>
<p>Phylogenetic tree</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_w.shape">w.shape</code></td>
<td>
<p>Shape parameter of the Gamma distribution representing the generation time</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_w.scale">w.scale</code></td>
<td>
<p>Scale parameter of the Gamma distribution representing the generation time</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_ws.shape">ws.shape</code></td>
<td>
<p>Shape parameter of the Gamma distribution representing the sampling time</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_ws.scale">ws.scale</code></td>
<td>
<p>Scale parameter of the Gamma distribution representing the sampling time</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_w.mean">w.mean</code></td>
<td>
<p>Mean of the Gamma distribution representing the generation time</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_w.std">w.std</code></td>
<td>
<p>Std of the Gamma distribution representing the generation time</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_ws.mean">ws.mean</code></td>
<td>
<p>Mean of the Gamma distribution representing the sampling time</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_ws.std">ws.std</code></td>
<td>
<p>Std of the Gamma distribution representing the sampling time</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_mcmciterations">mcmcIterations</code></td>
<td>
<p>Number of MCMC iterations to run the algorithm for</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_thinning">thinning</code></td>
<td>
<p>MCMC thinning interval between two sampled iterations</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_startneg">startNeg</code></td>
<td>
<p>Starting value of within-host coalescent parameter Ne*g</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_startoff.r">startOff.r</code></td>
<td>
<p>Starting value of parameter off.r</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_startoff.p">startOff.p</code></td>
<td>
<p>Starting value of parameter off.p</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_startpi">startPi</code></td>
<td>
<p>Starting value of sampling proportion pi</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_updateneg">updateNeg</code></td>
<td>
<p>Whether of not to update the parameter Ne*g</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_updateoff.r">updateOff.r</code></td>
<td>
<p>Whether or not to update the parameter off.r</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_updateoff.p">updateOff.p</code></td>
<td>
<p>Whether or not to update the parameter off.p</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_updatepi">updatePi</code></td>
<td>
<p>Whether or not to update the parameter pi</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_startctree">startCTree</code></td>
<td>
<p>Optional combined tree to start from</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_updatettree">updateTTree</code></td>
<td>
<p>Whether or not to update the transmission tree</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_optistart">optiStart</code></td>
<td>
<p>Type of optimisation to apply to MCMC start point (0=none, 1=slow, 2=fast)</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_datet">dateT</code></td>
<td>
<p>Date when process stops (this can be Inf for fully simulated outbreaks)</p>
</td></tr>
<tr><td><code id="inferTTree_+3A_verbose">verbose</code></td>
<td>
<p>Whether or not to use verbose mode (default is false)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>posterior sample set of transmission trees
</p>


<h3>Examples</h3>

<pre><code class='language-R'>inferTTree(ptreeFromPhylo(ape::rtree(5),2020),mcmcIterations=100)
</code></pre>

<hr>
<h2 id='makeCTreeFromPTree'>Create a transmission tree compatible with the provided phylogenetic tree</h2><span id='topic+makeCTreeFromPTree'></span>

<h3>Description</h3>

<p>Create a transmission tree compatible with the provided phylogenetic tree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeCTreeFromPTree(
  ptree,
  off.r = NA,
  off.p = NA,
  neg = NA,
  pi = NA,
  w.shape = NA,
  w.scale = NA,
  ws.shape = NA,
  ws.scale = NA,
  T = NA,
  optiStart = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makeCTreeFromPTree_+3A_ptree">ptree</code></td>
<td>
<p>Phylogenetic tree</p>
</td></tr>
<tr><td><code id="makeCTreeFromPTree_+3A_off.r">off.r</code></td>
<td>
<p>First parameter of the negative binomial distribution for offspring number</p>
</td></tr>
<tr><td><code id="makeCTreeFromPTree_+3A_off.p">off.p</code></td>
<td>
<p>Second parameter of the negative binomial distribution for offspring number</p>
</td></tr>
<tr><td><code id="makeCTreeFromPTree_+3A_neg">neg</code></td>
<td>
<p>the within-host effective population size (Ne) timesgeneration duration (g)</p>
</td></tr>
<tr><td><code id="makeCTreeFromPTree_+3A_pi">pi</code></td>
<td>
<p>probability of sampling an infected individual</p>
</td></tr>
<tr><td><code id="makeCTreeFromPTree_+3A_w.shape">w.shape</code></td>
<td>
<p>Shape parameter of the Gamma probability density function representing the generation time</p>
</td></tr>
<tr><td><code id="makeCTreeFromPTree_+3A_w.scale">w.scale</code></td>
<td>
<p>Scale parameter of the Gamma probability density function representing the generation time</p>
</td></tr>
<tr><td><code id="makeCTreeFromPTree_+3A_ws.shape">ws.shape</code></td>
<td>
<p>Shape parameter of the Gamma probability density function representing the sampling time</p>
</td></tr>
<tr><td><code id="makeCTreeFromPTree_+3A_ws.scale">ws.scale</code></td>
<td>
<p>Scale parameter of the Gamma probability density function representing the sampling time</p>
</td></tr>
<tr><td><code id="makeCTreeFromPTree_+3A_t">T</code></td>
<td>
<p>Date when process stops (this can be Inf for fully simulated outbreaks)</p>
</td></tr>
<tr><td><code id="makeCTreeFromPTree_+3A_optistart">optiStart</code></td>
<td>
<p>Method used to optimised colored tree (0=none, 1=slow, 2=fast)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A minimal non-zero probability phylogenetic+transmission tree, or an optimised version if parameters are provided
</p>

<hr>
<h2 id='makeTTree'>Simulate a transmission tree</h2><span id='topic+makeTTree'></span>

<h3>Description</h3>

<p>Simulate a transmission tree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeTTree(
  off.r,
  off.p,
  pi,
  w.shape,
  w.scale,
  ws.shape = w.shape,
  ws.scale = w.scale,
  maxTime = Inf,
  nSampled = NA
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makeTTree_+3A_off.r">off.r</code></td>
<td>
<p>First parameter of the negative binomial distribution for offspring number</p>
</td></tr>
<tr><td><code id="makeTTree_+3A_off.p">off.p</code></td>
<td>
<p>Second parameter of the negative binomial distribution for offspring number</p>
</td></tr>
<tr><td><code id="makeTTree_+3A_pi">pi</code></td>
<td>
<p>probability of sampling an infected individual</p>
</td></tr>
<tr><td><code id="makeTTree_+3A_w.shape">w.shape</code></td>
<td>
<p>Shape parameter of the Gamma probability density function representing the generation time</p>
</td></tr>
<tr><td><code id="makeTTree_+3A_w.scale">w.scale</code></td>
<td>
<p>Scale parameter of the Gamma probability density function representing the generation time</p>
</td></tr>
<tr><td><code id="makeTTree_+3A_ws.shape">ws.shape</code></td>
<td>
<p>Shape parameter of the Gamma probability density function representing the sampling time</p>
</td></tr>
<tr><td><code id="makeTTree_+3A_ws.scale">ws.scale</code></td>
<td>
<p>Scale parameter of the Gamma probability density function representing the sampling time</p>
</td></tr>
<tr><td><code id="makeTTree_+3A_maxtime">maxTime</code></td>
<td>
<p>Duration of simulation (can be Inf)</p>
</td></tr>
<tr><td><code id="makeTTree_+3A_nsampled">nSampled</code></td>
<td>
<p>Number of sampled individuals (can be NA for any)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A N*3 matrix in the following format with one row per infected host, first column is time of infection, second column is time of sampling, third column is infector
</p>

<hr>
<h2 id='medTTree'>Return the medoid from a MCMC output</h2><span id='topic+medTTree'></span>

<h3>Description</h3>

<p>Return the medoid from a MCMC output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>medTTree(record, burnin = 0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="medTTree_+3A_record">record</code></td>
<td>
<p>Output from inferTTree function</p>
</td></tr>
<tr><td><code id="medTTree_+3A_burnin">burnin</code></td>
<td>
<p>Proportion of the MCMC output to be discarded as burnin</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The index of the medoid
</p>

<hr>
<h2 id='phyloFromPTree'>Converts a phylogenetic tree into an ape phylo object</h2><span id='topic+phyloFromPTree'></span>

<h3>Description</h3>

<p>Converts a phylogenetic tree into an ape phylo object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phyloFromPTree(ptree)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phyloFromPTree_+3A_ptree">ptree</code></td>
<td>
<p>phylogenetic tree</p>
</td></tr>
</table>


<h3>Value</h3>

<p>phylo object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>phyloFromPTree(extractPTree(simulateOutbreak()))
</code></pre>

<hr>
<h2 id='plot.ctree'>Plotting for ctree</h2><span id='topic+plot.ctree'></span>

<h3>Description</h3>

<p>Plotting for ctree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ctree'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.ctree_+3A_x">x</code></td>
<td>
<p>Object of class ctree, ie a colored phylogenetic tree</p>
</td></tr>
<tr><td><code id="plot.ctree_+3A_...">...</code></td>
<td>
<p>Additional parameters are passed on</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of ctree
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(simulateOutbreak())
</code></pre>

<hr>
<h2 id='plot.ptree'>Plotting for ptree</h2><span id='topic+plot.ptree'></span>

<h3>Description</h3>

<p>Plotting for ptree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ptree'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.ptree_+3A_x">x</code></td>
<td>
<p>Object of class ptree, ie  a phylogenetic tree</p>
</td></tr>
<tr><td><code id="plot.ptree_+3A_...">...</code></td>
<td>
<p>Additional parameters are passed on to ape::plot.phylo</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of ptree
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(ptreeFromPhylo(ape::rtree(5),2020))
</code></pre>

<hr>
<h2 id='plot.resTransPhylo'>Plotting for resTransPhylo</h2><span id='topic+plot.resTransPhylo'></span>

<h3>Description</h3>

<p>Plotting for resTransPhylo
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'resTransPhylo'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.resTransPhylo_+3A_x">x</code></td>
<td>
<p>Output from inferTTree</p>
</td></tr>
<tr><td><code id="plot.resTransPhylo_+3A_...">...</code></td>
<td>
<p>Additional parameters are passed on</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of TransPhylo results
</p>

<hr>
<h2 id='plot.ttree'>Plotting for ttree</h2><span id='topic+plot.ttree'></span>

<h3>Description</h3>

<p>Plotting for ttree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ttree'
plot(x, type = "summarised", w.shape = NA, w.scale = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.ttree_+3A_x">x</code></td>
<td>
<p>Object of class ttree, ie  a transmission tree</p>
</td></tr>
<tr><td><code id="plot.ttree_+3A_type">type</code></td>
<td>
<p>Type of plot to display, can be 'detailed' or 'summarised' (default)</p>
</td></tr>
<tr><td><code id="plot.ttree_+3A_w.shape">w.shape</code></td>
<td>
<p>Shape parameter of the generation time, needed for detailed plot only</p>
</td></tr>
<tr><td><code id="plot.ttree_+3A_w.scale">w.scale</code></td>
<td>
<p>Scale parameter of the generation time, needed for detailed plot only</p>
</td></tr>
<tr><td><code id="plot.ttree_+3A_...">...</code></td>
<td>
<p>Additional parameters are passed on</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of ttree
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(extractTTree(simulateOutbreak()))
</code></pre>

<hr>
<h2 id='plotCTree'>Plot both phylogenetic and transmission trees using colors on the phylogeny</h2><span id='topic+plotCTree'></span>

<h3>Description</h3>

<p>Plot both phylogenetic and transmission trees using colors on the phylogeny
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotCTree(
  tree,
  showLabels = TRUE,
  showStars = TRUE,
  cols = NA,
  maxTime = NA,
  cex = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotCTree_+3A_tree">tree</code></td>
<td>
<p>Combined phylogenetic/transmission tree</p>
</td></tr>
<tr><td><code id="plotCTree_+3A_showlabels">showLabels</code></td>
<td>
<p>Whether or not to show the labels</p>
</td></tr>
<tr><td><code id="plotCTree_+3A_showstars">showStars</code></td>
<td>
<p>Whether or not to show stars representing transmission events</p>
</td></tr>
<tr><td><code id="plotCTree_+3A_cols">cols</code></td>
<td>
<p>Colors to use for hosts</p>
</td></tr>
<tr><td><code id="plotCTree_+3A_maxtime">maxTime</code></td>
<td>
<p>Maximum time to show on the x axis</p>
</td></tr>
<tr><td><code id="plotCTree_+3A_cex">cex</code></td>
<td>
<p>Expansion factor</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns invisibly the first parameter
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plotCTree(simulateOutbreak())
</code></pre>

<hr>
<h2 id='plotTraces'>Plot MCMC traces</h2><span id='topic+plotTraces'></span>

<h3>Description</h3>

<p>Plot MCMC traces
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotTraces(record, burnin = 0, extend = F)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotTraces_+3A_record">record</code></td>
<td>
<p>Output from inferTTree function</p>
</td></tr>
<tr><td><code id="plotTraces_+3A_burnin">burnin</code></td>
<td>
<p>Proportion of the MCMC output to be discarded as burnin</p>
</td></tr>
<tr><td><code id="plotTraces_+3A_extend">extend</code></td>
<td>
<p>Whether to also show traces of off.r and off.p</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns invisibly the first parameter
</p>

<hr>
<h2 id='plotTTree'>Plot a transmission tree in a detailed format</h2><span id='topic+plotTTree'></span>

<h3>Description</h3>

<p>Plot a transmission tree in a detailed format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotTTree(ttree, w.shape, w.scale, showLabels = TRUE, maxTime = NA, cex = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotTTree_+3A_ttree">ttree</code></td>
<td>
<p>Transmission tree</p>
</td></tr>
<tr><td><code id="plotTTree_+3A_w.shape">w.shape</code></td>
<td>
<p>Shape parameter of the Gamma probability density function representing the generation time</p>
</td></tr>
<tr><td><code id="plotTTree_+3A_w.scale">w.scale</code></td>
<td>
<p>Scale parameter of the Gamma probability density function representing the generation time</p>
</td></tr>
<tr><td><code id="plotTTree_+3A_showlabels">showLabels</code></td>
<td>
<p>Whether or not to show the labels</p>
</td></tr>
<tr><td><code id="plotTTree_+3A_maxtime">maxTime</code></td>
<td>
<p>Maximum value of time to show on x axis</p>
</td></tr>
<tr><td><code id="plotTTree_+3A_cex">cex</code></td>
<td>
<p>Expansion factor</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns invisibly the first parameter
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plotTTree(extractTTree(simulateOutbreak()),2,1)
</code></pre>

<hr>
<h2 id='plotTTree2'>Plot a transmission tree in an economic format</h2><span id='topic+plotTTree2'></span>

<h3>Description</h3>

<p>Plot a transmission tree in an economic format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotTTree2(
  ttree,
  showLabels = TRUE,
  showMissingLinks = 0,
  maxTime = NA,
  cex = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotTTree2_+3A_ttree">ttree</code></td>
<td>
<p>Transmission tree</p>
</td></tr>
<tr><td><code id="plotTTree2_+3A_showlabels">showLabels</code></td>
<td>
<p>Boolean for whether or not to show the labels</p>
</td></tr>
<tr><td><code id="plotTTree2_+3A_showmissinglinks">showMissingLinks</code></td>
<td>
<p>Option for how to show missing links: (0) as dots, (1) as several gray levels, (2) as a single gray level</p>
</td></tr>
<tr><td><code id="plotTTree2_+3A_maxtime">maxTime</code></td>
<td>
<p>Maximum value of time to show on x axis</p>
</td></tr>
<tr><td><code id="plotTTree2_+3A_cex">cex</code></td>
<td>
<p>Expansion factor</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns invisibly the first parameter
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plotTTree2(extractTTree(simulateOutbreak()))
</code></pre>

<hr>
<h2 id='print.ctree'>Print function for ctree objects</h2><span id='topic+print.ctree'></span>

<h3>Description</h3>

<p>Print function for ctree objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ctree'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.ctree_+3A_x">x</code></td>
<td>
<p>Object of class ctree, ie a colored phylogenetic tree</p>
</td></tr>
<tr><td><code id="print.ctree_+3A_...">...</code></td>
<td>
<p>Additional parameters are passed on</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print out details of the ctree
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print(simulateOutbreak())
</code></pre>

<hr>
<h2 id='print.ptree'>Print function for ptree objects</h2><span id='topic+print.ptree'></span>

<h3>Description</h3>

<p>Print function for ptree objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ptree'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.ptree_+3A_x">x</code></td>
<td>
<p>Object of class ptree, ie a phylogenetic tree</p>
</td></tr>
<tr><td><code id="print.ptree_+3A_...">...</code></td>
<td>
<p>Additional parameters are passed on</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print out details of the ptree
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print(extractPTree(simulateOutbreak()))
</code></pre>

<hr>
<h2 id='print.resTransPhylo'>Print function for resTransPhylo objects</h2><span id='topic+print.resTransPhylo'></span>

<h3>Description</h3>

<p>Print function for resTransPhylo objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'resTransPhylo'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.resTransPhylo_+3A_x">x</code></td>
<td>
<p>output from inferTTree</p>
</td></tr>
<tr><td><code id="print.resTransPhylo_+3A_...">...</code></td>
<td>
<p>Additional parameters are passed on</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print out details of TransPhylo results
</p>

<hr>
<h2 id='print.ttree'>Print function for ttree objects</h2><span id='topic+print.ttree'></span>

<h3>Description</h3>

<p>Print function for ttree objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ttree'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.ttree_+3A_x">x</code></td>
<td>
<p>Object of class ttree, ie a transmission tree</p>
</td></tr>
<tr><td><code id="print.ttree_+3A_...">...</code></td>
<td>
<p>Additional parameters are passed on</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print out details of the ttree
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print(extractTTree(simulateOutbreak()))
</code></pre>

<hr>
<h2 id='probPTreeGivenTTree'>Calculate the probability of a phylogenetic tree given a transmission tree</h2><span id='topic+probPTreeGivenTTree'></span>

<h3>Description</h3>

<p>Calculate the probability of a phylogenetic tree given a transmission tree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probPTreeGivenTTree(ctree, neg, w = integer(0))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="probPTreeGivenTTree_+3A_ctree">ctree</code></td>
<td>
<p>Combined phylogenetic/transmission tree</p>
</td></tr>
<tr><td><code id="probPTreeGivenTTree_+3A_neg">neg</code></td>
<td>
<p>Within-host coalescent rate</p>
</td></tr>
<tr><td><code id="probPTreeGivenTTree_+3A_w">w</code></td>
<td>
<p>Vector of hosts for which to calculate the probability, or nothing for all</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Probability of phylogeny given transmission tree
</p>

<hr>
<h2 id='probPTreeGivenTTreeR'>Calculate the probability of a phylogenetic tree given a transmission tree</h2><span id='topic+probPTreeGivenTTreeR'></span>

<h3>Description</h3>

<p>Calculate the probability of a phylogenetic tree given a transmission tree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probPTreeGivenTTreeR(ctree, neg, w = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="probPTreeGivenTTreeR_+3A_ctree">ctree</code></td>
<td>
<p>Combined phylogenetic/transmission tree</p>
</td></tr>
<tr><td><code id="probPTreeGivenTTreeR_+3A_neg">neg</code></td>
<td>
<p>Within-host coalescent rate</p>
</td></tr>
<tr><td><code id="probPTreeGivenTTreeR_+3A_w">w</code></td>
<td>
<p>Vector of hosts for which to calculate the probability, or NULL for all</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Probability of phylogeny given transmission tree
</p>

<hr>
<h2 id='probTTree'>Calculates the log-probability of a transmission tree</h2><span id='topic+probTTree'></span>

<h3>Description</h3>

<p>Calculates the log-probability of a transmission tree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probTTree(
  ttree,
  rOff,
  pOff,
  pi,
  shGen,
  scGen,
  shSam,
  scSam,
  dateT,
  delta_t = 0.01
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="probTTree_+3A_ttree">ttree</code></td>
<td>
<p>Transmission tree</p>
</td></tr>
<tr><td><code id="probTTree_+3A_roff">rOff</code></td>
<td>
<p>First parameter of the negative binomial distribution for offspring number</p>
</td></tr>
<tr><td><code id="probTTree_+3A_poff">pOff</code></td>
<td>
<p>Second parameter of the negative binomial distribution for offspring number</p>
</td></tr>
<tr><td><code id="probTTree_+3A_pi">pi</code></td>
<td>
<p>probability of sampling an infected individual</p>
</td></tr>
<tr><td><code id="probTTree_+3A_shgen">shGen</code></td>
<td>
<p>Shape parameter of the Gamma probability density function representing the generation time</p>
</td></tr>
<tr><td><code id="probTTree_+3A_scgen">scGen</code></td>
<td>
<p>Scale parameter of the Gamma probability density function representing the generation time</p>
</td></tr>
<tr><td><code id="probTTree_+3A_shsam">shSam</code></td>
<td>
<p>Shape parameter of the Gamma probability density function representing the sampling time</p>
</td></tr>
<tr><td><code id="probTTree_+3A_scsam">scSam</code></td>
<td>
<p>Scale parameter of the Gamma probability density function representing the sampling time</p>
</td></tr>
<tr><td><code id="probTTree_+3A_datet">dateT</code></td>
<td>
<p>Date when process stops (this can be Inf for fully simulated outbreaks)</p>
</td></tr>
<tr><td><code id="probTTree_+3A_delta_t">delta_t</code></td>
<td>
<p>Grid precision</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Probability of the transmission tree
</p>

<hr>
<h2 id='probTTreeR'>Calculates the log-probability of a transmission tree</h2><span id='topic+probTTreeR'></span>

<h3>Description</h3>

<p>Calculates the log-probability of a transmission tree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probTTreeR(
  ttree,
  off.r,
  off.p,
  pi,
  w.shape,
  w.scale,
  ws.shape,
  ws.scale,
  dateT
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="probTTreeR_+3A_ttree">ttree</code></td>
<td>
<p>Transmission tree</p>
</td></tr>
<tr><td><code id="probTTreeR_+3A_off.r">off.r</code></td>
<td>
<p>First parameter of the negative binomial distribution for offspring number</p>
</td></tr>
<tr><td><code id="probTTreeR_+3A_off.p">off.p</code></td>
<td>
<p>Second parameter of the negative binomial distribution for offspring number</p>
</td></tr>
<tr><td><code id="probTTreeR_+3A_pi">pi</code></td>
<td>
<p>probability of sampling an infected individual</p>
</td></tr>
<tr><td><code id="probTTreeR_+3A_w.shape">w.shape</code></td>
<td>
<p>Shape parameter of the Gamma probability density function representing the generation time</p>
</td></tr>
<tr><td><code id="probTTreeR_+3A_w.scale">w.scale</code></td>
<td>
<p>Scale parameter of the Gamma probability density function representing the generation time</p>
</td></tr>
<tr><td><code id="probTTreeR_+3A_ws.shape">ws.shape</code></td>
<td>
<p>Shape parameter of the Gamma probability density function representing the sampling time</p>
</td></tr>
<tr><td><code id="probTTreeR_+3A_ws.scale">ws.scale</code></td>
<td>
<p>Scale parameter of the Gamma probability density function representing the sampling time</p>
</td></tr>
<tr><td><code id="probTTreeR_+3A_datet">dateT</code></td>
<td>
<p>Date when process stops (this can be Inf for fully simulated outbreaks)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Probability of the transmission tree
</p>

<hr>
<h2 id='ptreeFromPhylo'>Converts an ape phylo object into a phylogenetic tree</h2><span id='topic+ptreeFromPhylo'></span>

<h3>Description</h3>

<p>Converts an ape phylo object into a phylogenetic tree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ptreeFromPhylo(tr, dateLastSample)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ptreeFromPhylo_+3A_tr">tr</code></td>
<td>
<p>phylo object</p>
</td></tr>
<tr><td><code id="ptreeFromPhylo_+3A_datelastsample">dateLastSample</code></td>
<td>
<p>date of the last sample</p>
</td></tr>
</table>


<h3>Value</h3>

<p>phylogenetic tree
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ptreeFromPhylo(ape::rtree(5),2020)
</code></pre>

<hr>
<h2 id='selectTTree'>Select the most representative transmission tree from a MCMC output</h2><span id='topic+selectTTree'></span>

<h3>Description</h3>

<p>Select the most representative transmission tree from a MCMC output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selectTTree(record, burnin = 0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="selectTTree_+3A_record">record</code></td>
<td>
<p>Output from inferTTree function</p>
</td></tr>
<tr><td><code id="selectTTree_+3A_burnin">burnin</code></td>
<td>
<p>Proportion of the MCMC output to be discarded as burnin</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The index of the selected transmission tree
</p>

<hr>
<h2 id='simulateOutbreak'>Simulate an outbreak</h2><span id='topic+simulateOutbreak'></span>

<h3>Description</h3>

<p>Simulate an outbreak
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulateOutbreak(
  off.r = 1,
  off.p = 0.5,
  neg = 0.25,
  nSampled = NA,
  pi = 0.5,
  w.shape = 2,
  w.scale = 1,
  ws.shape = NA,
  ws.scale = NA,
  w.mean = NA,
  w.std = NA,
  ws.mean = NA,
  ws.std = NA,
  dateStartOutbreak = 2000,
  dateT = Inf
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulateOutbreak_+3A_off.r">off.r</code></td>
<td>
<p>First parameter of the negative binomial distribution for offspring number</p>
</td></tr>
<tr><td><code id="simulateOutbreak_+3A_off.p">off.p</code></td>
<td>
<p>Second parameter of the negative binomial distribution for offspring number</p>
</td></tr>
<tr><td><code id="simulateOutbreak_+3A_neg">neg</code></td>
<td>
<p>the within-host effective population size (Ne) timesgeneration duration (g)</p>
</td></tr>
<tr><td><code id="simulateOutbreak_+3A_nsampled">nSampled</code></td>
<td>
<p>number of sampled infected individuals, or NA for any</p>
</td></tr>
<tr><td><code id="simulateOutbreak_+3A_pi">pi</code></td>
<td>
<p>probability of sampling an infected individual</p>
</td></tr>
<tr><td><code id="simulateOutbreak_+3A_w.shape">w.shape</code></td>
<td>
<p>Shape parameter of the Gamma probability density function representing the generation time</p>
</td></tr>
<tr><td><code id="simulateOutbreak_+3A_w.scale">w.scale</code></td>
<td>
<p>Scale parameter of the Gamma probability density function representing the generation time</p>
</td></tr>
<tr><td><code id="simulateOutbreak_+3A_ws.shape">ws.shape</code></td>
<td>
<p>Shape parameter of the Gamma probability density function representing the sampling time</p>
</td></tr>
<tr><td><code id="simulateOutbreak_+3A_ws.scale">ws.scale</code></td>
<td>
<p>Scale parameter of the Gamma probability density function representing the sampling time</p>
</td></tr>
<tr><td><code id="simulateOutbreak_+3A_w.mean">w.mean</code></td>
<td>
<p>Mean of the Gamma distribution representing the generation time</p>
</td></tr>
<tr><td><code id="simulateOutbreak_+3A_w.std">w.std</code></td>
<td>
<p>Std of the Gamma distribution representing the generation time</p>
</td></tr>
<tr><td><code id="simulateOutbreak_+3A_ws.mean">ws.mean</code></td>
<td>
<p>Mean of the Gamma distribution representing the sampling time</p>
</td></tr>
<tr><td><code id="simulateOutbreak_+3A_ws.std">ws.std</code></td>
<td>
<p>Std of the Gamma distribution representing the sampling time</p>
</td></tr>
<tr><td><code id="simulateOutbreak_+3A_datestartoutbreak">dateStartOutbreak</code></td>
<td>
<p>Date when index case becomes infected</p>
</td></tr>
<tr><td><code id="simulateOutbreak_+3A_datet">dateT</code></td>
<td>
<p>Date when process stops (this can be Inf for fully simulated outbreaks)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Combined phylogenetic and transmission tree
</p>


<h3>Examples</h3>

<pre><code class='language-R'>simulateOutbreak()
simulateOutbreak(off.r=2,dateStartOutbreak=2010,dateT=2015)
</code></pre>

<hr>
<h2 id='summary.resTransPhylo'>Summary function for resTransPhylo objects</h2><span id='topic+summary.resTransPhylo'></span>

<h3>Description</h3>

<p>Summary function for resTransPhylo objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'resTransPhylo'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.resTransPhylo_+3A_object">object</code></td>
<td>
<p>output from inferTTree</p>
</td></tr>
<tr><td><code id="summary.resTransPhylo_+3A_...">...</code></td>
<td>
<p>Passed on to print.phylo</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print out details of TransPhylo results
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
