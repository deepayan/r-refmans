<!DOCTYPE html><html lang="en"><head><title>Help for package amen</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {amen}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#amen-package'><p>Additive and Multiplicative Effects Models for Networks and Relational Data</p></a></li>
<li><a href='#addhealthc3'><p>AddHealth community 3 data</p></a></li>
<li><a href='#addhealthc9'><p>AddHealth community 9 data</p></a></li>
<li><a href='#addlines'><p>Add lines</p></a></li>
<li><a href='#ame'><p>AME model fitting routine</p></a></li>
<li><a href='#ame_rep'><p>AME model fitting routine for replicated relational data</p></a></li>
<li><a href='#circplot'><p>Circular network plot</p></a></li>
<li><a href='#coldwar'><p>Cold War data</p></a></li>
<li><a href='#comtrade'><p>Comtrade data</p></a></li>
<li><a href='#design_array'><p>Computes the design socioarray of covariate values</p></a></li>
<li><a href='#dutchcollege'><p>Dutch college data</p></a></li>
<li><a href='#el2sm'><p>Edgelist to sociomatrix</p></a></li>
<li><a href='#gofstats'><p>Goodness of fit statistics</p></a></li>
<li><a href='#IR90s'><p>International relations in the 90s</p></a></li>
<li><a href='#lazegalaw'><p>Lazega's law firm data</p></a></li>
<li><a href='#ldZgbme'><p>log density for GBME models</p></a></li>
<li><a href='#llsrmRho'><p>SRM log likelihood evaluated on a grid of rho-values</p></a></li>
<li><a href='#mhalf'><p>Symmetric square root of a matrix</p></a></li>
<li><a href='#netplot'><p>Network plotting</p></a></li>
<li><a href='#plot.ame'><p>Plot results of an AME object</p></a></li>
<li><a href='#precomputeX'><p>Precomputation of design matrix quantities.</p></a></li>
<li><a href='#raSab_bin_fc'><p>Simulate a and Sab from full conditional distributions under bin likelihood</p></a></li>
<li><a href='#raSab_cbin_fc'><p>Simulate a and Sab from full conditional distributions under the cbin</p>
likelihood</a></li>
<li><a href='#raSab_frn_fc'><p>Simulate a and Sab from full conditional distributions under frn likelihood</p></a></li>
<li><a href='#rbeta_ab_fc'><p>Conditional simulation of additive effects and regression coefficients</p></a></li>
<li><a href='#rbeta_ab_rep_fc'><p>Gibbs sampling of additive row and column effects and regression coefficient</p>
with independent replicate relational data</a></li>
<li><a href='#rmvnorm'><p>Simulation from a multivariate normal distribution</p></a></li>
<li><a href='#rrho_fc'><p>Griddy Gibbs update for dyadic correlation</p></a></li>
<li><a href='#rrho_mh'><p>Metropolis update for dyadic correlation</p></a></li>
<li><a href='#rrho_mh_rep'><p>Metropolis update for dyadic correlation with independent replicate data</p></a></li>
<li><a href='#rs2_fc'><p>Gibbs update for dyadic variance</p></a></li>
<li><a href='#rs2_rep_fc'><p>Gibbs update for dyadic variance with independent replicate relational data</p></a></li>
<li><a href='#rSab_fc'><p>Gibbs update for additive effects covariance</p></a></li>
<li><a href='#rSuv_fc'><p>Gibbs update for multiplicative effects covariance</p></a></li>
<li><a href='#rUV_fc'><p>Gibbs sampling of U and V</p></a></li>
<li><a href='#rUV_rep_fc'><p>Gibbs sampling of U and V</p></a></li>
<li><a href='#rUV_sym_fc'><p>Gibbs sampling of U and V</p></a></li>
<li><a href='#rwish'><p>Simulation from a Wishart distribution</p></a></li>
<li><a href='#rZ_bin_fc'><p>Simulate Z based on a probit model</p></a></li>
<li><a href='#rZ_cbin_fc'><p>Simulate Z given fixed rank nomination data</p></a></li>
<li><a href='#rZ_frn_fc'><p>Simulate Z given fixed rank nomination data</p></a></li>
<li><a href='#rZ_nrm_fc'><p>Simulate missing values in a normal AME model</p></a></li>
<li><a href='#rZ_ord_fc'><p>Simulate Z given the partial ranks</p></a></li>
<li><a href='#rZ_rrl_fc'><p>Simulate Z given relative rank nomination data</p></a></li>
<li><a href='#rZ_tob_fc'><p>Simulate Z based on a tobit model</p></a></li>
<li><a href='#sampsonmonks'><p>Sampson's monastery data</p></a></li>
<li><a href='#sheep'><p>Sheep dominance data</p></a></li>
<li><a href='#simY_bin'><p>Simulate a network, i.e. a binary relational matrix</p></a></li>
<li><a href='#simY_frn'><p>Simulate an relational matrix based on a fixed rank nomination scheme</p></a></li>
<li><a href='#simY_nrm'><p>Simulate a normal relational matrix</p></a></li>
<li><a href='#simY_ord'><p>Simulate an ordinal relational matrix</p></a></li>
<li><a href='#simY_rrl'><p>Simulate an relational matrix based on a relative rank nomination scheme</p></a></li>
<li><a href='#simY_tob'><p>Simulate a tobit relational matrix</p></a></li>
<li><a href='#simZ'><p>Simulate Z given its expectation and covariance</p></a></li>
<li><a href='#sm2el'><p>Sociomatrix to edgelist</p></a></li>
<li><a href='#summary.ame'><p>Summary of an AME object</p></a></li>
<li><a href='#Xbeta'><p>Linear combinations of submatrices of an array</p></a></li>
<li><a href='#xnet'><p>Network embedding</p></a></li>
<li><a href='#YX_bin'><p>binary relational data and covariates</p></a></li>
<li><a href='#YX_bin_long'><p>binary relational data and covariates</p></a></li>
<li><a href='#YX_cbin'><p>Censored binary nomination data and covariates</p></a></li>
<li><a href='#YX_frn'><p>Fixed rank nomination data and covariates</p></a></li>
<li><a href='#YX_nrm'><p>normal relational data and covariates</p></a></li>
<li><a href='#YX_ord'><p>ordinal relational data and covariates</p></a></li>
<li><a href='#YX_rrl'><p>row-specific ordinal relational data and covariates</p></a></li>
<li><a href='#zscores'><p>rank-based z-scores</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Additive and Multiplicative Effects Models for Networks and
Relational Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.5</td>
</tr>
<tr>
<td>Description:</td>
<td>Analysis of dyadic network and relational data using additive and
    multiplicative effects (AME) models. The basic model includes
    regression terms, the covariance structure of the social relations model
    (Warner, Kenny and Stoto (1979) &lt;<a href="https://doi.org/10.1037%2F0022-3514.37.10.1742">doi:10.1037/0022-3514.37.10.1742</a>&gt;, 
    Wong (1982) &lt;<a href="https://doi.org/10.2307%2F2287296">doi:10.2307/2287296</a>&gt;), and multiplicative factor
    models (Hoff(2009) &lt;<a href="https://doi.org/10.1007%2Fs10588-008-9040-4">doi:10.1007/s10588-008-9040-4</a>&gt;). 
    Several different link functions accommodate different
    relational data structures, including binary/network data, normal
    relational data, zero-inflated positive outcomes using a tobit model, ordinal relational data and data from
    fixed-rank nomination schemes. Several of these link functions are
    discussed in Hoff, Fosdick, Volfovsky and Stovel (2013) 
    &lt;<a href="https://doi.org/10.1017%2Fnws.2013.17">doi:10.1017/nws.2013.17</a>&gt;. Development of this
    software was supported in part by NIH grant R01HD067509.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Peter Hoff &lt;peter.hoff@duke.edu&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/pdhoff/amen">https://github.com/pdhoff/amen</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/pdhoff/amen/issues">https://github.com/pdhoff/amen/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-20</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>coda,network,knitr,rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-20 18:31:12 UTC; pdhoff</td>
</tr>
<tr>
<td>Author:</td>
<td>Peter Hoff [aut, cre],
  Bailey Fosdick [aut],
  Alex Volfovsky [aut],
  Yanjun He [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-20 23:20:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='amen-package'>Additive and Multiplicative Effects Models for Networks and Relational Data</h2><span id='topic+amen-package'></span><span id='topic+amen'></span>

<h3>Description</h3>

<p>Analysis of network and relational data using additive and multiplicative
effects (AME) models. The basic model includes regression terms,
the covariance structure of the social relations model
(Warner, Kenny and Stoto (1979), Wong (1982)), and multiplicative
factor effects (Hoff(2009)). Four different link functions accommodate
different relational data structures, including binary/network data (bin),
normal relational data (nrm), ordinal relational data (ord) and data from
fixed-rank nomination schemes (frn).  Several of these link functions are
discussed in Hoff, Fosdick, Volfovsky and Stovel (2013). Development of this
software was supported in part by NICHD grant R01HD067509.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;"> Package: </td><td style="text-align: left;"> amen</td>
</tr>
<tr>
 <td style="text-align: left;"> Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;"> Version: </td><td style="text-align: left;">
1.4.4 </td>
</tr>
<tr>
 <td style="text-align: left;"> Date: </td><td style="text-align: left;"> 2020-12-01 </td>
</tr>
<tr>
 <td style="text-align: left;"> License: </td><td style="text-align: left;"> GPL-3 </td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Peter Hoff, Bailey Fosdick, Alex Volfovsky, Yanjun He
</p>
<p>Maintainer: Peter Hoff &lt;peter.hoff@duke.edu&gt;
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/pdhoff/amen">https://github.com/pdhoff/amen</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/pdhoff/amen/issues">https://github.com/pdhoff/amen/issues</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>

data(YX_frn)
fit&lt;-ame(YX_frn$Y,YX_frn$X,burn=5,nscan=5,odens=1,family="frn")

summary(fit)

plot(fit) 

</code></pre>

<hr>
<h2 id='addhealthc3'>AddHealth community 3 data</h2><span id='topic+addhealthc3'></span>

<h3>Description</h3>

<p>A valued sociomatrix (Y) and matrix of nodal attributes (X) for 
students in community 3 of the AddHealth study. 
</p>

<ul>
<li><p> Y: A sociomatrix in which the value of the edge corresponds to an ad-hoc measure of intensity of the relation. Note that students were only allowed to nominate up to 5 male friends and 5 female friends. 
</p>
</li>
<li><p> X: Matrix of students attributes, including sex, race (1=white, 2=black, 3=hispanic, 4=asian, 5=mixed/other) and grade. 
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(addhealthc3)
</code></pre>


<h3>Format</h3>

<p>list
</p>

<hr>
<h2 id='addhealthc9'>AddHealth community 9 data</h2><span id='topic+addhealthc9'></span>

<h3>Description</h3>

<p>A valued sociomatrix (Y) and matrix of nodal attributes (X) for 
students in community 9 of the AddHealth study. 
</p>

<ul>
<li><p> Y: A sociomatrix in which the value of the edge corresponds to an ad-hoc measure of intensity of the relation. Note that students were only allowed to nominate up to 5 male friends and 5 female friends. 
</p>
</li>
<li><p> X: Matrix of students attributes, including sex, race (1=white, 2=black, 3=hispanic, 4=asian, 5=mixed/other) and grade. 
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(addhealthc9)
</code></pre>


<h3>Format</h3>

<p>list
</p>

<hr>
<h2 id='addlines'>Add lines</h2><span id='topic+addlines'></span>

<h3>Description</h3>

<p>Add lines to a network plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addlines(Y,X,col="lightblue",alength=0,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="addlines_+3A_y">Y</code></td>
<td>
<p>a sociomatrix</p>
</td></tr>
<tr><td><code id="addlines_+3A_x">X</code></td>
<td>
<p>coordinates of nodes</p>
</td></tr>
<tr><td><code id="addlines_+3A_col">col</code></td>
<td>
<p>color of lines. Can be a vector of length equal to the number of edges to be drawn</p>
</td></tr>
<tr><td><code id="addlines_+3A_alength">alength</code></td>
<td>
<p>length of arrows to be drawn</p>
</td></tr>
<tr><td><code id="addlines_+3A_...">...</code></td>
<td>
<p>additional plotting parameters</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(addhealthc3) 
Y&lt;-addhealthc3$Y
X&lt;-xnet(Y) 
netplot(Y,X) 
addlines(Y,X,col=Y[Y!=0]) 

</code></pre>

<hr>
<h2 id='ame'>AME model fitting routine</h2><span id='topic+ame'></span>

<h3>Description</h3>

<p>An MCMC routine providing a fit to an additive and multiplicative effects
(AME) regression model to relational data of various types
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ame(Y, Xdyad=NULL, Xrow=NULL, Xcol=NULL, family, R=0, rvar = !(family=="rrl") ,
cvar = TRUE,  dcor = !symmetric, nvar=TRUE,
intercept=!is.element(family,c("rrl","ord")),
symmetric=FALSE,
odmax=rep(max(apply(Y&gt;0,1,sum,na.rm=TRUE)),nrow(Y)), seed = 1, nscan =
10000, burn = 500, odens = 25, plot=TRUE, print = TRUE, gof=TRUE,
prior=list())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ame_+3A_y">Y</code></td>
<td>
<p>an n x n square relational matrix of relations. See family below for
various data types.</p>
</td></tr>
<tr><td><code id="ame_+3A_xdyad">Xdyad</code></td>
<td>
<p>an n x n x pd array of covariates</p>
</td></tr>
<tr><td><code id="ame_+3A_xrow">Xrow</code></td>
<td>
<p>an n x pr matrix of nodal row covariates</p>
</td></tr>
<tr><td><code id="ame_+3A_xcol">Xcol</code></td>
<td>
<p>an n x pc matrix of nodal column covariates</p>
</td></tr>
<tr><td><code id="ame_+3A_family">family</code></td>
<td>
<p>character: one of &quot;nrm&quot;,&quot;tob&quot;,&quot;bin&quot;,&quot;ord&quot;,&quot;cbin&quot;,&quot;frn&quot;,&quot;rrl&quot; - see
the details below</p>
</td></tr>
<tr><td><code id="ame_+3A_r">R</code></td>
<td>
<p>integer: dimension of the multiplicative effects (can be zero)</p>
</td></tr>
<tr><td><code id="ame_+3A_rvar">rvar</code></td>
<td>
<p>logical: fit row random effects (asymmetric case)?</p>
</td></tr>
<tr><td><code id="ame_+3A_cvar">cvar</code></td>
<td>
<p>logical: fit column random effects (asymmetric case)?</p>
</td></tr>
<tr><td><code id="ame_+3A_dcor">dcor</code></td>
<td>
<p>logical: fit a dyadic correlation (asymmetric case)?</p>
</td></tr>
<tr><td><code id="ame_+3A_nvar">nvar</code></td>
<td>
<p>logical: fit nodal random effects (symmetric case)?</p>
</td></tr>
<tr><td><code id="ame_+3A_intercept">intercept</code></td>
<td>
<p>logical: fit model with an intercept?</p>
</td></tr>
<tr><td><code id="ame_+3A_symmetric">symmetric</code></td>
<td>
<p>logical: Is the sociomatrix symmetric by design?</p>
</td></tr>
<tr><td><code id="ame_+3A_odmax">odmax</code></td>
<td>
<p>a scalar integer or vector of length n giving the maximum
number of nominations that each node may make - used for &quot;frn&quot; and &quot;cbin&quot;
families</p>
</td></tr>
<tr><td><code id="ame_+3A_seed">seed</code></td>
<td>
<p>random seed</p>
</td></tr>
<tr><td><code id="ame_+3A_nscan">nscan</code></td>
<td>
<p>number of iterations of the Markov chain (beyond burn-in)</p>
</td></tr>
<tr><td><code id="ame_+3A_burn">burn</code></td>
<td>
<p>burn in for the Markov chain</p>
</td></tr>
<tr><td><code id="ame_+3A_odens">odens</code></td>
<td>
<p>output density for the Markov chain</p>
</td></tr>
<tr><td><code id="ame_+3A_plot">plot</code></td>
<td>
<p>logical: plot results while running?</p>
</td></tr>
<tr><td><code id="ame_+3A_print">print</code></td>
<td>
<p>logical: print results while running?</p>
</td></tr>
<tr><td><code id="ame_+3A_gof">gof</code></td>
<td>
<p>logical: calculate goodness of fit statistics?</p>
</td></tr>
<tr><td><code id="ame_+3A_prior">prior</code></td>
<td>
<p>list: A list of hyperparameters for the prior distribution</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This command provides posterior inference for parameters in AME models of
relational data, assuming one of six possible data types/models:
</p>
<p>&quot;nrm&quot;: A normal AME model.
</p>
<p>&quot;tob&quot;: A tobit AME model. 
</p>
<p>&quot;bin&quot;: A binary probit AME model.
</p>
<p>&quot;ord&quot;: An ordinal probit AME model. An intercept is not identifiable in this
model.
</p>
<p>&quot;cbin&quot;: An AME model for censored binary data.  The value of 'odmax'
specifies the maximum number of links each row may have.
</p>
<p>&quot;frn&quot;: An AME model for fixed rank nomination networks. A higher value of
the rank indicates a stronger relationship. The value of 'odmax' specifies
the maximum number of links each row may have.
</p>
<p>&quot;rrl&quot;: An AME model based on the row ranks. This is appropriate if the
relationships across rows are not directly comparable in terms of scale. An
intercept, row random effects and row regression effects are not estimable
for this model.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>BETA</code></td>
<td>
<p>posterior samples of regression coefficients</p>
</td></tr>
<tr><td><code>VC</code></td>
<td>
<p>posterior samples of the variance parameters</p>
</td></tr>
<tr><td><code>APM</code></td>
<td>
<p>posterior mean of additive row effects a</p>
</td></tr> <tr><td><code>BPM</code></td>
<td>
<p>posterior
mean of additive column effects b</p>
</td></tr> <tr><td><code>U</code></td>
<td>
<p>posterior mean of multiplicative
row effects u</p>
</td></tr> <tr><td><code>V</code></td>
<td>
<p>posterior mean of multiplicative column effects v (asymmetric case)</p>
</td></tr>
<tr><td><code>UVPM</code></td>
<td>
<p>posterior mean of UV (asymmetric case)</p>
</td></tr> 
<tr><td><code>ULUPM</code></td>
<td>
<p>posterior mean of ULU (symmetric case)</p>
</td></tr> 
<tr><td><code>L</code></td>
<td>
<p>posterior mean of L (symmetric case)</p>
</td></tr> 
<tr><td><code>EZ</code></td>
<td>
<p>estimate of expectation of Z
matrix</p>
</td></tr> <tr><td><code>YPM</code></td>
<td>
<p>posterior mean of Y (for imputing missing values)</p>
</td></tr>
<tr><td><code>GOF</code></td>
<td>
<p>observed (first row) and posterior predictive (remaining rows)
values of four goodness-of-fit statistics</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(YX_frn) 
fit&lt;-ame(YX_frn$Y,YX_frn$X,burn=5,nscan=5,odens=1,family="frn")
# you should run the Markov chain much longer than this

 
</code></pre>

<hr>
<h2 id='ame_rep'>AME model fitting routine for replicated relational data</h2><span id='topic+ame_rep'></span>

<h3>Description</h3>

<p>An MCMC routine providing a fit to an additive and multiplicative effects
(AME) regression model to replicated relational data of
various types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ame_rep(Y,Xdyad=NULL, Xrow=NULL, Xcol=NULL, family, R=0, rvar = !(family=="rrl"),
cvar = TRUE, dcor = !symmetric, nvar=TRUE,  
intercept=!is.element(family,c("rrl","ord")),
symmetric=FALSE,
odmax=rep(max(apply(Y&gt;0,c(1,3),sum,na.rm=TRUE)),nrow(Y[,,1])), seed = 1,
nscan = 10000, burn = 500, odens = 25, plot=TRUE, print = TRUE, gof=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ame_rep_+3A_y">Y</code></td>
<td>
<p>an n x n x T array of relational matrix, where the third dimension correponds to replicates (over time, for example). See
family below for various data types.</p>
</td></tr>
<tr><td><code id="ame_rep_+3A_xdyad">Xdyad</code></td>
<td>
<p>an n x n x pd x T array of covariates</p>
</td></tr>
<tr><td><code id="ame_rep_+3A_xrow">Xrow</code></td>
<td>
<p>an n x pr x T array of nodal row covariates</p>
</td></tr>
<tr><td><code id="ame_rep_+3A_xcol">Xcol</code></td>
<td>
<p>an n x pc x T array of nodal column covariates</p>
</td></tr>
<tr><td><code id="ame_rep_+3A_family">family</code></td>
<td>
<p>character: one of &quot;nrm&quot;,&quot;bin&quot;,&quot;ord&quot;,&quot;cbin&quot;,&quot;frn&quot;,&quot;rrl&quot; - see
the details below</p>
</td></tr>
<tr><td><code id="ame_rep_+3A_r">R</code></td>
<td>
<p>integer: dimension of the multiplicative effects (can be zero)</p>
</td></tr>
<tr><td><code id="ame_rep_+3A_rvar">rvar</code></td>
<td>
<p>logical: fit row random effects (asymmetric case)?</p>
</td></tr>
<tr><td><code id="ame_rep_+3A_cvar">cvar</code></td>
<td>
<p>logical: fit column random effects (asymmetric case)?</p>
</td></tr>
<tr><td><code id="ame_rep_+3A_dcor">dcor</code></td>
<td>
<p>logical: fit a dyadic correlation (asymmetric case)?</p>
</td></tr>
<tr><td><code id="ame_rep_+3A_nvar">nvar</code></td>
<td>
<p>logical: fit nodal random effects (symmetric case)?</p>
</td></tr>
<tr><td><code id="ame_rep_+3A_intercept">intercept</code></td>
<td>
<p>logical: fit model with an intercept?</p>
</td></tr>
<tr><td><code id="ame_rep_+3A_symmetric">symmetric</code></td>
<td>
<p>logical: Is the sociomatrix symmetric by design?</p>
</td></tr>
<tr><td><code id="ame_rep_+3A_odmax">odmax</code></td>
<td>
<p>a scalar integer or vector of length n giving the maximum
number of nominations that each node may make - used for &quot;frn&quot; and &quot;cbin&quot;
families</p>
</td></tr>
<tr><td><code id="ame_rep_+3A_seed">seed</code></td>
<td>
<p>random seed</p>
</td></tr>
<tr><td><code id="ame_rep_+3A_nscan">nscan</code></td>
<td>
<p>number of iterations of the Markov chain (beyond burn-in)</p>
</td></tr>
<tr><td><code id="ame_rep_+3A_burn">burn</code></td>
<td>
<p>burn in for the Markov chain</p>
</td></tr>
<tr><td><code id="ame_rep_+3A_odens">odens</code></td>
<td>
<p>output density for the Markov chain</p>
</td></tr>
<tr><td><code id="ame_rep_+3A_plot">plot</code></td>
<td>
<p>logical: plot results while running?</p>
</td></tr>
<tr><td><code id="ame_rep_+3A_print">print</code></td>
<td>
<p>logical: print results while running?</p>
</td></tr>
<tr><td><code id="ame_rep_+3A_gof">gof</code></td>
<td>
<p>logical: calculate goodness of fit statistics?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This command provides posterior inference for parameters in AME models of
independent replicated relational data, assuming one of six possible data
types/models:
</p>
<p>&quot;nrm&quot;: A normal AME model.
</p>
<p>&quot;bin&quot;: A binary probit AME model.
</p>
<p>&quot;ord&quot;: An ordinal probit AME model. An intercept is not identifiable in this
model.
</p>
<p>&quot;cbin&quot;: An AME model for censored binary data.  The value of 'odmax'
specifies the maximum number of links each row may have.
</p>
<p>&quot;frn&quot;: An AME model for fixed rank nomination networks. A higher value of
the rank indicates a stronger relationship. The value of 'odmax' specifies
the maximum number of links each row may have.
</p>
<p>&quot;rrl&quot;: An AME model based on the row ranks. This is appropriate if the
relationships across rows are not directly comparable in terms of scale. An
intercept, row random effects and row regression effects are not estimable
for this model.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>BETA</code></td>
<td>
<p>posterior samples of regression coefficients</p>
</td></tr>
<tr><td><code>VC</code></td>
<td>
<p>posterior samples of the variance parameters</p>
</td></tr>
<tr><td><code>APM</code></td>
<td>
<p>posterior mean of additive row effects a</p>
</td></tr> <tr><td><code>BPM</code></td>
<td>
<p>posterior
mean of additive column effects b</p>
</td></tr> <tr><td><code>U</code></td>
<td>
<p>posterior mean of multiplicative
row effects u</p>
</td></tr> 
<tr><td><code>V</code></td>
<td>
<p>posterior mean of multiplicative column effects v (asymmetric case)</p>
</td></tr>
<tr><td><code>UVPM</code></td>
<td>
<p>posterior mean of UV</p>
</td></tr>
<tr><td><code>ULUPM</code></td>
<td>
<p>posterior mean of ULU (symmetric case)</p>
</td></tr> 
<tr><td><code>L</code></td>
<td>
<p>posterior mean of L (symmetric case)</p>
</td></tr> 
<tr><td><code>EZ</code></td>
<td>
<p>estimate of expectation of Z
matrix</p>
</td></tr> <tr><td><code>YPM</code></td>
<td>
<p>posterior mean of Y (for imputing missing values)</p>
</td></tr>
<tr><td><code>GOF</code></td>
<td>
<p>observed (first row) and posterior predictive (remaining rows)
values of four goodness-of-fit statistics</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Hoff, Yanjun He
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(YX_bin_long) 
fit&lt;-ame_rep(YX_bin_long$Y,YX_bin_long$X,burn=5,nscan=5,odens=1,family="bin")
# you should run the Markov chain much longer than this

</code></pre>

<hr>
<h2 id='circplot'>Circular network plot</h2><span id='topic+circplot'></span>

<h3>Description</h3>

<p>Produce a circular network plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>circplot(
  Y,
  U = NULL,
  V = NULL,
  row.names = rownames(Y),
  col.names = colnames(Y),
  plotnames = TRUE,
  vscale = 0.8,
  pscale = 1.75,
  mscale = 0.3,
  lcol = "gray",
  rcol = "brown",
  ccol = "blue",
  pch = 16,
  lty = 3,
  jitter = 0.1 * (nrow(Y)/(1 + nrow(Y))),
  bty = "n",
  add = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="circplot_+3A_y">Y</code></td>
<td>
<p>(matrix) m by n relational matrix.</p>
</td></tr>
<tr><td><code id="circplot_+3A_u">U</code></td>
<td>
<p>(matrix) m by 2 matrix of row factors of Y.</p>
</td></tr>
<tr><td><code id="circplot_+3A_v">V</code></td>
<td>
<p>(matrix) n by 2 matrix of column factors of Y.</p>
</td></tr>
<tr><td><code id="circplot_+3A_row.names">row.names</code></td>
<td>
<p>(character vector) names of the row objects.</p>
</td></tr>
<tr><td><code id="circplot_+3A_col.names">col.names</code></td>
<td>
<p>(character vector) names of the columns objects.</p>
</td></tr>
<tr><td><code id="circplot_+3A_plotnames">plotnames</code></td>
<td>
<p>(logical) plot row and column names.</p>
</td></tr>
<tr><td><code id="circplot_+3A_vscale">vscale</code></td>
<td>
<p>(scalar) scaling factor for V coordinates.</p>
</td></tr>
<tr><td><code id="circplot_+3A_pscale">pscale</code></td>
<td>
<p>(scalar) scaling factor for plotting characters.</p>
</td></tr>
<tr><td><code id="circplot_+3A_mscale">mscale</code></td>
<td>
<p>(scalar) scaling factor for plotting characters.</p>
</td></tr>
<tr><td><code id="circplot_+3A_lcol">lcol</code></td>
<td>
<p>(scalar or vector) line color(s) for the nonzero elements of Y.</p>
</td></tr>
<tr><td><code id="circplot_+3A_rcol">rcol</code></td>
<td>
<p>(scalar or vector) node color(s) for the rows.</p>
</td></tr>
<tr><td><code id="circplot_+3A_ccol">ccol</code></td>
<td>
<p>(scalar or vector) node color(s) for the columns.</p>
</td></tr>
<tr><td><code id="circplot_+3A_pch">pch</code></td>
<td>
<p>(integer) plotting character.</p>
</td></tr>
<tr><td><code id="circplot_+3A_lty">lty</code></td>
<td>
<p>(integer) line type.</p>
</td></tr>
<tr><td><code id="circplot_+3A_jitter">jitter</code></td>
<td>
<p>(scalar) a number to control jittering of nodes.</p>
</td></tr>
<tr><td><code id="circplot_+3A_bty">bty</code></td>
<td>
<p>(character) bounding box type.</p>
</td></tr>
<tr><td><code id="circplot_+3A_add">add</code></td>
<td>
<p>(logical) add to existing plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates a circle plot of a relational matrix or social network.
If not supplied via <code>U</code> and <code>V</code>, two-dimensional row factors and 
column factors are computed from the SVD of <code>Y</code>, scaled versions of 
which are used to plot positions on the outside edge (<code>U</code>) and inside
edge (<code>V</code>) of the circle plot. The magnitudes of the plotting characters
are determined by the magnitudes of the rows of <code>U</code> and <code>V</code>. 
Segments are drawn between each row object <code>i</code> and column object 
<code>j</code> for which <code>Y[i,j]!=0</code>.
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(IR90s) 
circplot(IR90s$dyadvars[,,1])

</code></pre>

<hr>
<h2 id='coldwar'>Cold War data</h2><span id='topic+coldwar'></span>

<h3>Description</h3>

<p>Positive and negative relations between countries during the cold war
</p>


<h3>Format</h3>

<p>A list including the following dyadic and nodal variables:
</p>

<ul>
<li> <p><code>cc</code>: a socioarray of ordinal levels of military 
cooperation (positive) and conflict (negative), every 5 years; 
</p>
</li>
<li> <p><code>distance</code>: between-country distance (in thousands of kilometers); 
</p>
</li>
<li> <p><code>gdp</code>: country gdp in dollars every 5 years; 
</p>
</li>
<li> <p><code>polity</code>: country polity every 5 years.  
</p>
</li></ul>



<h3>Source</h3>

<p>Xun Cao : <a href="https://polisci.la.psu.edu/people/xuc11/">https://polisci.la.psu.edu/people/xuc11/</a>
</p>

<hr>
<h2 id='comtrade'>Comtrade data</h2><span id='topic+comtrade'></span>

<h3>Description</h3>

<p>Eleven years of import and export data between 229 countries. 
The data use the SITC Rev. 1 commodity classification, aggregated at the 
first level (AG1).
</p>


<h3>Format</h3>

<p>A list consisting of a socioarray <code>Trade</code> and a vector 
<code>dollars2010</code> of inflation rates. The socioarray gives 
yearly trade volume (exports and imports) 
in dollars for 10 different commodity classes 
for eleven years between 229 countries. This gives a five-way 
array. The first index is the reporting country, so 
<code>Trade[i,j,t,k,1]</code> is what <code>i</code> reports for exports to 
<code>j</code>, but in general this is not the same as 
<code>Trade[j,i,t,k,2]</code>, what <code>j</code> reports as importing from <code>i</code>.
</p>


<h3>Source</h3>

<p><a href="https://comtrade.un.org">https://comtrade.un.org</a>, <a href="https://www.measuringworth.com">https://www.measuringworth.com</a>
</p>

<hr>
<h2 id='design_array'>Computes the design socioarray of covariate values</h2><span id='topic+design_array'></span>

<h3>Description</h3>

<p>Computes the design socioarray of covariate values for an AME fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>design_array(Xrow=NULL,Xcol=NULL,Xdyad=NULL,intercept=TRUE,n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="design_array_+3A_xrow">Xrow</code></td>
<td>
<p>an n x pr matrix of row covariates</p>
</td></tr>
<tr><td><code id="design_array_+3A_xcol">Xcol</code></td>
<td>
<p>an n x pc matrix of column covariates</p>
</td></tr>
<tr><td><code id="design_array_+3A_xdyad">Xdyad</code></td>
<td>
<p>an n x n x pd array of dyadic covariates</p>
</td></tr>
<tr><td><code id="design_array_+3A_intercept">intercept</code></td>
<td>
<p>logical</p>
</td></tr>
<tr><td><code id="design_array_+3A_n">n</code></td>
<td>
<p>number of rows/columns</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an n x n x (pr+pc+pd+intercept) 3-way array
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='dutchcollege'>Dutch college data</h2><span id='topic+dutchcollege'></span>

<h3>Description</h3>

<p>Longitudinal relational measurements and nodal characteristics 
of Dutch college students, described in 
van de Bunt, van Duijn, and Snijders (1999). 
The time interval between the first four measurements was 
three weeks, whereas the interval between the last three 
was six weeks.
</p>


<h3>Format</h3>

<p>A list consisting of a socioarray <code>Y</code> and a matrix 
<code>X</code>  of static nodal attributes. The relational 
measurements range from -1 to 4, indicating the following:
</p>

<ul>
<li><p> -1 a troubled or negative relationship
</p>
</li>
<li><p>  0 don't know
</p>
</li>
<li><p>  1 neutral relationship
</p>
</li>
<li><p>  2 friendly
</p>
</li>
<li><p>  3 friendship
</p>
</li>
<li><p>  4 best friends
</p>
</li></ul>



<h3>Source</h3>

<p>Linton Freeman
</p>

<hr>
<h2 id='el2sm'>Edgelist to sociomatrix</h2><span id='topic+el2sm'></span>

<h3>Description</h3>

<p>Construction of a sociomatrix from an edgelist
</p>


<h3>Usage</h3>

<pre><code class='language-R'>el2sm(el,directed=TRUE,nadiag=all(el[,1]!=el[,2]))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="el2sm_+3A_el">el</code></td>
<td>
<p>a matrix in which each row contains the indices of an edge and possibly the weight for the edge</p>
</td></tr>
<tr><td><code id="el2sm_+3A_directed">directed</code></td>
<td>
<p>if FALSE, then a relation is placed in both entry ij and ji of the sociomatrix, for each edge ij (or ji)</p>
</td></tr>
<tr><td><code id="el2sm_+3A_nadiag">nadiag</code></td>
<td>
<p>put NAs on the diagonal</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a sociomatrix
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Y&lt;-matrix(rpois(10*10,.5),10,10) ; diag(Y)&lt;-NA
E&lt;-sm2el(Y) 
el2sm(E) - Y 

</code></pre>

<hr>
<h2 id='gofstats'>Goodness of fit statistics</h2><span id='topic+gofstats'></span>

<h3>Description</h3>

<p>Goodness of fit statistics evaluating second and third-order dependence
patterns
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofstats(Y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gofstats_+3A_y">Y</code></td>
<td>
<p>a relational data matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of gof statistics
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(YX_nrm) 

gofstats(YX_nrm$Y) 


</code></pre>

<hr>
<h2 id='IR90s'>International relations in the 90s</h2><span id='topic+IR90s'></span>

<h3>Description</h3>

<p>A relational dataset recording 
a variety of nodal and dyadic variables on countries in the 1990s,
including information on conflicts, trade and other variables. 
Except for the conflict variable, the variables are averages
across the decade.
</p>


<h3>Format</h3>

<p>A list consisting of a socioarray <code>dyadvars</code> of 
dyadic variables and matrix  <code>nodevars</code> of nodal variables. 
The dyadic variables include
</p>

<ul>
<li><p> total number of conflicts;
</p>
</li>
<li><p> exports (in billions of dollars);
</p>
</li>
<li><p> distance (in thousands of kilometers);
</p>
</li>
<li><p> number of shared IGOs (averages across the years);
</p>
</li>
<li><p> polity interaction. 
</p>
</li></ul>
 
<p>The nodal variables include
</p>

<ul>
<li><p> population (in millions); 
</p>
</li>
<li><p> gdp (in billions of dollars); 
</p>
</li>
<li><p> polity 
</p>
</li></ul>



<h3>Source</h3>

<p>Michael Ward.
</p>

<hr>
<h2 id='lazegalaw'>Lazega's law firm data</h2><span id='topic+lazegalaw'></span>

<h3>Description</h3>

<p>Several nodal and dyadic variables measured on 71 attorneys in a law firm.
</p>


<h3>Format</h3>

<p>A list consisting of a socioarray <code>Y</code> and a nodal attribute matrix <code>X</code>. 
</p>
<p>The dyadic variables in <code>Y</code> include three binary networks: advice, friendship
and co-worker status. 
</p>
<p>The categorical nodal attributes in <code>X</code> are coded as follows: 
</p>

<ul>
<li><p> status (1=partner, 2=associate)
</p>
</li>
<li><p> office (1=Boston, 2=Hartford, 3=Providence) 
</p>
</li>
<li><p> practice (1=litigation, 2=corporate) 
</p>
</li>
<li><p> law school (1=Harvard or Yale, 2=UConn, 3=other)  
</p>
</li></ul>

<p><code>seniority</code> and <code>age</code> are given in years, and <code>female</code> is 
a binary indicator.
</p>


<h3>Source</h3>

<p>Linton Freeman
</p>

<hr>
<h2 id='ldZgbme'>log density for GBME models</h2><span id='topic+ldZgbme'></span>

<h3>Description</h3>

<p>Calculation of the log conditional density of the 
latent AMEN matrix <code>Z</code> given observed data <code>Y</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ldZgbme(Z, Y, llYZ, EZ, rho, s2 = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ldZgbme_+3A_z">Z</code></td>
<td>
<p>n X n latent relational matrix following an AMEN model</p>
</td></tr>
<tr><td><code id="ldZgbme_+3A_y">Y</code></td>
<td>
<p>n X n observed relational matrix</p>
</td></tr>
<tr><td><code id="ldZgbme_+3A_llyz">llYZ</code></td>
<td>
<p>a vectorizable function taking two arguments, y and z. See details below.</p>
</td></tr>
<tr><td><code id="ldZgbme_+3A_ez">EZ</code></td>
<td>
<p>n X n mean matrix for <code>Z</code> based on AMEN model (including additive effects)</p>
</td></tr>
<tr><td><code id="ldZgbme_+3A_rho">rho</code></td>
<td>
<p>dyadic correlation in AMEN model for <code>Z</code></p>
</td></tr>
<tr><td><code id="ldZgbme_+3A_s2">s2</code></td>
<td>
<p>residual variance in AMEN model for <code>Z</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used for updating dyadic pairs of 
the latent variable matrix <code>Z</code> based on <code>Y</code> and 
an AMEN model for <code>Z</code>. The function <code>llYZ</code> specifies 
the log likelihood for each single <code>z[i,j]</code> based on 
<code>y[i,j]</code>, that is, <code>llYZ</code> gives the log probability 
density (or mass function) of <code>y[i,j]</code> given <code>z[i,j]</code>.
</p>


<h3>Value</h3>

<p>a symmetric matrix where entry i,j is proportional 
to the log conditional bivariate density of <code>z[i,j],z[j,i]</code>.
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## For (overdispersed) Poisson regression, use
llYZ&lt;-function(y,z){ dpois(y,z,log=TRUE) } 

</code></pre>

<hr>
<h2 id='llsrmRho'>SRM log likelihood evaluated on a grid of rho-values</h2><span id='topic+llsrmRho'></span>

<h3>Description</h3>

<p>Calculation of the SRM log-likelihood over a grid of rho-values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>llsrmRho(Y, Sab, rhos, s2 = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="llsrmRho_+3A_y">Y</code></td>
<td>
<p>sociomatrix assumed to follow a mean-zero SRM distribution</p>
</td></tr>
<tr><td><code id="llsrmRho_+3A_sab">Sab</code></td>
<td>
<p>covariance matrix of additive effects</p>
</td></tr>
<tr><td><code id="llsrmRho_+3A_rhos">rhos</code></td>
<td>
<p>vector of rho-values at which to calculate the log-likelihood</p>
</td></tr>
<tr><td><code id="llsrmRho_+3A_s2">s2</code></td>
<td>
<p>current value of s2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of log-likelihood values
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='mhalf'>Symmetric square root of a matrix</h2><span id='topic+mhalf'></span>

<h3>Description</h3>

<p>Computes the symmetric square root of a positive definite matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mhalf(M)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mhalf_+3A_m">M</code></td>
<td>
<p>a positive definite matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix <code>H</code> such that <code>H^2</code> equals <code>M</code>
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='netplot'>Network plotting</h2><span id='topic+netplot'></span>

<h3>Description</h3>

<p>Plot the graph of a sociomatrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>netplot(Y,X=NULL,xaxt="n",yaxt="n",xlab="",ylab="",
 lcol="gray",ncol="black",lwd=1,lty=1,pch=16,bty="n",plotnames=FALSE,
 seed=1,
 plot.iso=TRUE,directed=NULL,add=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="netplot_+3A_y">Y</code></td>
<td>
<p>a sociomatrix</p>
</td></tr>
<tr><td><code id="netplot_+3A_x">X</code></td>
<td>
<p>coordinates for plotting the nodes</p>
</td></tr>
<tr><td><code id="netplot_+3A_xaxt">xaxt</code></td>
<td>
<p>x-axis type</p>
</td></tr>
<tr><td><code id="netplot_+3A_yaxt">yaxt</code></td>
<td>
<p>y-axis type</p>
</td></tr>
<tr><td><code id="netplot_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label</p>
</td></tr>
<tr><td><code id="netplot_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label</p>
</td></tr>
<tr><td><code id="netplot_+3A_lcol">lcol</code></td>
<td>
<p>edge color</p>
</td></tr>
<tr><td><code id="netplot_+3A_ncol">ncol</code></td>
<td>
<p>node color (can be node-specific)</p>
</td></tr>
<tr><td><code id="netplot_+3A_lwd">lwd</code></td>
<td>
<p>line width</p>
</td></tr>
<tr><td><code id="netplot_+3A_lty">lty</code></td>
<td>
<p>line type</p>
</td></tr>
<tr><td><code id="netplot_+3A_pch">pch</code></td>
<td>
<p>plotting character for nodes (can be node-specific)</p>
</td></tr>
<tr><td><code id="netplot_+3A_bty">bty</code></td>
<td>
<p>bounding box type</p>
</td></tr>
<tr><td><code id="netplot_+3A_plotnames">plotnames</code></td>
<td>
<p>plot rownames of Y as node labels</p>
</td></tr>
<tr><td><code id="netplot_+3A_seed">seed</code></td>
<td>
<p>random seed</p>
</td></tr>
<tr><td><code id="netplot_+3A_plot.iso">plot.iso</code></td>
<td>
<p>include isolates in plot</p>
</td></tr>
<tr><td><code id="netplot_+3A_directed">directed</code></td>
<td>
<p>draw arrows</p>
</td></tr>
<tr><td><code id="netplot_+3A_add">add</code></td>
<td>
<p>add to an existing plot region</p>
</td></tr>
<tr><td><code id="netplot_+3A_...">...</code></td>
<td>
<p>additional plotting parameters</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(addhealthc3)
Y&lt;-addhealthc3$Y
X&lt;-xnet(Y) 
netplot(Y,X) 

</code></pre>

<hr>
<h2 id='plot.ame'>Plot results of an AME object</h2><span id='topic+plot.ame'></span>

<h3>Description</h3>

<p>A set of plots summarizing the MCMC routine for an AME fit, as well as some
posterior predictive checks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ame'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.ame_+3A_x">x</code></td>
<td>
<p>the result of fitting an AME model</p>
</td></tr>
<tr><td><code id="plot.ame_+3A_...">...</code></td>
<td>
<p>additional parameters (not used)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a series of plots
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='precomputeX'>Precomputation of design matrix quantities.</h2><span id='topic+precomputeX'></span>

<h3>Description</h3>

<p>Computation of a variety of quantities from the design array
to be used in MCMC model fitting algorithms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>precomputeX(X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="precomputeX_+3A_x">X</code></td>
<td>
<p>a three way array, the design array for an AME model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the same three-way array but with derived quantities 
as attributes.
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='raSab_bin_fc'>Simulate a and Sab from full conditional distributions under bin likelihood</h2><span id='topic+raSab_bin_fc'></span>

<h3>Description</h3>

<p>Simulate a and Sab from full conditional distributions under bin likelihood
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raSab_bin_fc(Z, Y, a, b, Sab, Sab0=NULL, eta0=NULL, SS = round(sqrt(nrow(Z))))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="raSab_bin_fc_+3A_z">Z</code></td>
<td>
<p>a square matrix, the current value of Z</p>
</td></tr>
<tr><td><code id="raSab_bin_fc_+3A_y">Y</code></td>
<td>
<p>square binary relational matrix</p>
</td></tr>
<tr><td><code id="raSab_bin_fc_+3A_a">a</code></td>
<td>
<p>current value of row effects</p>
</td></tr>
<tr><td><code id="raSab_bin_fc_+3A_b">b</code></td>
<td>
<p>current value of column effects</p>
</td></tr>
<tr><td><code id="raSab_bin_fc_+3A_sab">Sab</code></td>
<td>
<p>current value of Cov(a,b)</p>
</td></tr>
<tr><td><code id="raSab_bin_fc_+3A_sab0">Sab0</code></td>
<td>
<p>prior (inverse) scale matrix for the prior distribution</p>
</td></tr>
<tr><td><code id="raSab_bin_fc_+3A_eta0">eta0</code></td>
<td>
<p>prior degrees of freedom for the prior distribution</p>
</td></tr>
<tr><td><code id="raSab_bin_fc_+3A_ss">SS</code></td>
<td>
<p>number of iterations</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Z</code></td>
<td>
<p>new value of Z</p>
</td></tr> <tr><td><code>Sab</code></td>
<td>
<p>new value of Sab</p>
</td></tr> <tr><td><code>a</code></td>
<td>
<p>new
value of a</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='raSab_cbin_fc'>Simulate a and Sab from full conditional distributions under the cbin
likelihood</h2><span id='topic+raSab_cbin_fc'></span>

<h3>Description</h3>

<p>Simulate a and Sab from full conditional distributions under the cbin
likelihood
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raSab_cbin_fc(Z, Y, a, b, Sab, odmax, odobs, Sab0=NULL, eta0=NULL,SS =
round(sqrt(nrow(Z))))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="raSab_cbin_fc_+3A_z">Z</code></td>
<td>
<p>a square matrix, the current value of Z</p>
</td></tr>
<tr><td><code id="raSab_cbin_fc_+3A_y">Y</code></td>
<td>
<p>square matrix of ranked nomination data</p>
</td></tr>
<tr><td><code id="raSab_cbin_fc_+3A_a">a</code></td>
<td>
<p>current value of row effects</p>
</td></tr>
<tr><td><code id="raSab_cbin_fc_+3A_b">b</code></td>
<td>
<p>current value of column effects</p>
</td></tr>
<tr><td><code id="raSab_cbin_fc_+3A_sab">Sab</code></td>
<td>
<p>current value of Cov(a,b)</p>
</td></tr>
<tr><td><code id="raSab_cbin_fc_+3A_odmax">odmax</code></td>
<td>
<p>a scalar or vector giving the maximum number of nominations for
each individual</p>
</td></tr>
<tr><td><code id="raSab_cbin_fc_+3A_odobs">odobs</code></td>
<td>
<p>observed outdegree</p>
</td></tr>
<tr><td><code id="raSab_cbin_fc_+3A_sab0">Sab0</code></td>
<td>
<p>prior (inverse) scale matrix for the prior distribution</p>
</td></tr>
<tr><td><code id="raSab_cbin_fc_+3A_eta0">eta0</code></td>
<td>
<p>prior degrees of freedom for the prior distribution</p>
</td></tr>
<tr><td><code id="raSab_cbin_fc_+3A_ss">SS</code></td>
<td>
<p>number of iterations</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Z</code></td>
<td>
<p>new value of Z</p>
</td></tr> <tr><td><code>Sab</code></td>
<td>
<p>new value of Sab</p>
</td></tr> <tr><td><code>a</code></td>
<td>
<p>new
value of a</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='raSab_frn_fc'>Simulate a and Sab from full conditional distributions under frn likelihood</h2><span id='topic+raSab_frn_fc'></span>

<h3>Description</h3>

<p>Simulate a and Sab from full conditional distributions under frn likelihood
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raSab_frn_fc(Z, Y, YL, a, b, Sab, odmax, odobs, Sab0=NULL, eta0=NULL,
SS=round(sqrt(nrow(Z))))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="raSab_frn_fc_+3A_z">Z</code></td>
<td>
<p>a square matrix, the current value of Z</p>
</td></tr>
<tr><td><code id="raSab_frn_fc_+3A_y">Y</code></td>
<td>
<p>square matrix of ranked nomination data</p>
</td></tr>
<tr><td><code id="raSab_frn_fc_+3A_yl">YL</code></td>
<td>
<p>list of ranked individuals, from least to most preferred in each
row</p>
</td></tr>
<tr><td><code id="raSab_frn_fc_+3A_a">a</code></td>
<td>
<p>current value of row effects</p>
</td></tr>
<tr><td><code id="raSab_frn_fc_+3A_b">b</code></td>
<td>
<p>current value of column effects</p>
</td></tr>
<tr><td><code id="raSab_frn_fc_+3A_sab">Sab</code></td>
<td>
<p>current value of Cov(a,b)</p>
</td></tr>
<tr><td><code id="raSab_frn_fc_+3A_odmax">odmax</code></td>
<td>
<p>a scalar or vector giving the maximum number of nominations for
each individual</p>
</td></tr>
<tr><td><code id="raSab_frn_fc_+3A_odobs">odobs</code></td>
<td>
<p>observed outdegree</p>
</td></tr>
<tr><td><code id="raSab_frn_fc_+3A_sab0">Sab0</code></td>
<td>
<p>prior (inverse) scale matrix for the prior distribution</p>
</td></tr>
<tr><td><code id="raSab_frn_fc_+3A_eta0">eta0</code></td>
<td>
<p>prior degrees of freedom for the prior distribution</p>
</td></tr>
<tr><td><code id="raSab_frn_fc_+3A_ss">SS</code></td>
<td>
<p>number of iterations</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Z</code></td>
<td>
<p>new value of Z</p>
</td></tr> <tr><td><code>Sab</code></td>
<td>
<p>new value of Sab</p>
</td></tr> <tr><td><code>a</code></td>
<td>
<p>new
value of a</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='rbeta_ab_fc'>Conditional simulation of additive effects and regression coefficients</h2><span id='topic+rbeta_ab_fc'></span>

<h3>Description</h3>

<p>Simulates from the joint full conditional distribution of (beta,a,b)
in a social relations regression model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rbeta_ab_fc(
  Z,
  Sab,
  rho,
  X = NULL,
  s2 = 1,
  offset = 0,
  iV0 = NULL,
  m0 = NULL,
  g = length(Z)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rbeta_ab_fc_+3A_z">Z</code></td>
<td>
<p>n X n normal relational matrix</p>
</td></tr>
<tr><td><code id="rbeta_ab_fc_+3A_sab">Sab</code></td>
<td>
<p>row and column covariance</p>
</td></tr>
<tr><td><code id="rbeta_ab_fc_+3A_rho">rho</code></td>
<td>
<p>dyadic correlation</p>
</td></tr>
<tr><td><code id="rbeta_ab_fc_+3A_x">X</code></td>
<td>
<p>n x n x p covariate array</p>
</td></tr>
<tr><td><code id="rbeta_ab_fc_+3A_s2">s2</code></td>
<td>
<p>dyadic variance</p>
</td></tr>
<tr><td><code id="rbeta_ab_fc_+3A_offset">offset</code></td>
<td>
<p>a matrix of the same dimension as Z. It is assumed that 
Z-offset follows a SRRM, so the offset should contain any multiplicative 
effects (such as <code>U%*% t(V) </code> )</p>
</td></tr>
<tr><td><code id="rbeta_ab_fc_+3A_iv0">iV0</code></td>
<td>
<p>prior precision matrix for regression parameters</p>
</td></tr>
<tr><td><code id="rbeta_ab_fc_+3A_m0">m0</code></td>
<td>
<p>prior mean vector for regression parameters</p>
</td></tr>
<tr><td><code id="rbeta_ab_fc_+3A_g">g</code></td>
<td>
<p>prior variance scale for g-prior when iV0 is unspecified</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>beta</code></td>
<td>
<p>regression coefficients</p>
</td></tr> <tr><td><code>a</code></td>
<td>
<p>additive row effects</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>additive column effects</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='rbeta_ab_rep_fc'>Gibbs sampling of additive row and column effects and regression coefficient
with independent replicate relational data</h2><span id='topic+rbeta_ab_rep_fc'></span>

<h3>Description</h3>

<p>Simulates from the joint full conditional distribution of (a,b,beta),
assuming same additive row and column effects and regression coefficient
across replicates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rbeta_ab_rep_fc(Z.T,Sab,rho,X.T,s2=1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rbeta_ab_rep_fc_+3A_z.t">Z.T</code></td>
<td>
<p>n x n x T array, with the third dimension for replicates.
Each slice of the array is a (latent) normal relational matrix, with
multiplicative effects subtracted out</p>
</td></tr>
<tr><td><code id="rbeta_ab_rep_fc_+3A_sab">Sab</code></td>
<td>
<p>row and column covariance</p>
</td></tr>
<tr><td><code id="rbeta_ab_rep_fc_+3A_rho">rho</code></td>
<td>
<p>dyadic correlation</p>
</td></tr>
<tr><td><code id="rbeta_ab_rep_fc_+3A_x.t">X.T</code></td>
<td>
<p>n x n x p x T covariate array</p>
</td></tr>
<tr><td><code id="rbeta_ab_rep_fc_+3A_s2">s2</code></td>
<td>
<p>dyadic variance</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>beta</code></td>
<td>
<p>regression coefficients</p>
</td></tr> <tr><td><code>a</code></td>
<td>
<p>additive row effects</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>additive column effects</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Hoff, Yanjun He
</p>

<hr>
<h2 id='rmvnorm'>Simulation from a multivariate normal distribution</h2><span id='topic+rmvnorm'></span>

<h3>Description</h3>

<p>Simulates a matrix where the rows are i.i.d. samples from a multivariate
normal distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmvnorm(n, mu, Sigma, Sigma.chol = chol(Sigma))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rmvnorm_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="rmvnorm_+3A_mu">mu</code></td>
<td>
<p>multivariate mean vector</p>
</td></tr>
<tr><td><code id="rmvnorm_+3A_sigma">Sigma</code></td>
<td>
<p>covariance matrix</p>
</td></tr>
<tr><td><code id="rmvnorm_+3A_sigma.chol">Sigma.chol</code></td>
<td>
<p>Cholesky factorization of <code>Sigma</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with <code>n</code> rows
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='rrho_fc'>Griddy Gibbs update for dyadic correlation</h2><span id='topic+rrho_fc'></span>

<h3>Description</h3>

<p>Simulation of dyadic correlation from its approximate full conditional 
distribution using griddy Gibbs sampling
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rrho_fc(Z, Sab, s2 = 1, offset = 0, ngp = 100, asp = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rrho_fc_+3A_z">Z</code></td>
<td>
<p>n X n normal relational matrix</p>
</td></tr>
<tr><td><code id="rrho_fc_+3A_sab">Sab</code></td>
<td>
<p>covariance of additive effects</p>
</td></tr>
<tr><td><code id="rrho_fc_+3A_s2">s2</code></td>
<td>
<p>residual variance</p>
</td></tr>
<tr><td><code id="rrho_fc_+3A_offset">offset</code></td>
<td>
<p>matrix of the same dimension as Z. It is assumed that 
Z-offset follows an SRM distribution, so the offset should contain any 
regression terms and multiplicative effects (such as 
<code>Xbeta(X,beta+ U%*%t(V) </code>   )</p>
</td></tr>
<tr><td><code id="rrho_fc_+3A_ngp">ngp</code></td>
<td>
<p>the number of points for an unevenly-spaced 
grid on which to approximate the full conditional distribution</p>
</td></tr>
<tr><td><code id="rrho_fc_+3A_asp">asp</code></td>
<td>
<p>use arc sine prior (TRUE) or uniform prior (FALSE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a value of rho
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='rrho_mh'>Metropolis update for dyadic correlation</h2><span id='topic+rrho_mh'></span>

<h3>Description</h3>

<p>Metropolis update for dyadic correlation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rrho_mh(Z, rho, s2 = 1,offset=0, asp=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rrho_mh_+3A_z">Z</code></td>
<td>
<p>n X n normal relational matrix</p>
</td></tr>
<tr><td><code id="rrho_mh_+3A_rho">rho</code></td>
<td>
<p>current value of rho</p>
</td></tr>
<tr><td><code id="rrho_mh_+3A_s2">s2</code></td>
<td>
<p>current value of s2</p>
</td></tr>
<tr><td><code id="rrho_mh_+3A_offset">offset</code></td>
<td>
<p>matrix of the same dimension as Z. It is assumed that 
Z-offset is equal to dyadic noise, so the offset should contain any 
additive and multiplicative effects (such as 
<code>Xbeta(X,beta+ U%*%t(V) +  outer(a,b,"+")  </code>   )</p>
</td></tr>
<tr><td><code id="rrho_mh_+3A_asp">asp</code></td>
<td>
<p>use arc sine prior (TRUE) or uniform prior (FALSE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a new value of rho
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='rrho_mh_rep'>Metropolis update for dyadic correlation with independent replicate data</h2><span id='topic+rrho_mh_rep'></span>

<h3>Description</h3>

<p>Metropolis update for dyadic correlation with independent replicate data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rrho_mh_rep(E.T, rho, s2 = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rrho_mh_rep_+3A_e.t">E.T</code></td>
<td>
<p>Array of square residual relational matrix series. The third
dimension of the array is for different replicates. Each slice of the array
according to the third dimension is a square residual relational matrix.</p>
</td></tr>
<tr><td><code id="rrho_mh_rep_+3A_rho">rho</code></td>
<td>
<p>current value of rho</p>
</td></tr>
<tr><td><code id="rrho_mh_rep_+3A_s2">s2</code></td>
<td>
<p>current value of s2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a new value of rho
</p>


<h3>Author(s)</h3>

<p>Peter Hoff, Yanjun He
</p>

<hr>
<h2 id='rs2_fc'>Gibbs update for dyadic variance</h2><span id='topic+rs2_fc'></span>

<h3>Description</h3>

<p>Gibbs update for dyadic variance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rs2_fc(Z, rho,offset=0,nu0=NULL,s20=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rs2_fc_+3A_z">Z</code></td>
<td>
<p>n X n normal relational matrix</p>
</td></tr>
<tr><td><code id="rs2_fc_+3A_rho">rho</code></td>
<td>
<p>current value of rho</p>
</td></tr>
<tr><td><code id="rs2_fc_+3A_offset">offset</code></td>
<td>
<p>matrix of the same dimension as Z. It is assumed that Z-offset
is equal to dyadic noise, so the offset should contain any additive and 
multiplicative effects (such as <code>Xbeta(X,beta+ U%*%t(V) +  
outer(a,b,"+")  </code> )</p>
</td></tr>
<tr><td><code id="rs2_fc_+3A_nu0">nu0</code></td>
<td>
<p>prior degrees of freedom</p>
</td></tr>
<tr><td><code id="rs2_fc_+3A_s20">s20</code></td>
<td>
<p>prior estimate of s2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a new value of s2
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='rs2_rep_fc'>Gibbs update for dyadic variance with independent replicate relational data</h2><span id='topic+rs2_rep_fc'></span>

<h3>Description</h3>

<p>Gibbs update for dyadic variance with independent replicate relational data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rs2_rep_fc(E.T, rho)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rs2_rep_fc_+3A_e.t">E.T</code></td>
<td>
<p>Array of square residual relational matrix series. The third
dimension of the array is for different replicates. Each slice of the array
according to the third dimension is a square residual relational matrix</p>
</td></tr>
<tr><td><code id="rs2_rep_fc_+3A_rho">rho</code></td>
<td>
<p>current value of rho</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a new value of s2
</p>


<h3>Author(s)</h3>

<p>Peter Hoff, Yanjun He
</p>

<hr>
<h2 id='rSab_fc'>Gibbs update for additive effects covariance</h2><span id='topic+rSab_fc'></span>

<h3>Description</h3>

<p>Gibbs update for additive effects covariance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rSab_fc(a,b,Sab0=NULL,eta0=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rSab_fc_+3A_a">a</code></td>
<td>
<p>vector of row random effects</p>
</td></tr>
<tr><td><code id="rSab_fc_+3A_b">b</code></td>
<td>
<p>vector of row random effects</p>
</td></tr>
<tr><td><code id="rSab_fc_+3A_sab0">Sab0</code></td>
<td>
<p>prior (inverse) scale matrix for the prior distribution</p>
</td></tr>
<tr><td><code id="rSab_fc_+3A_eta0">eta0</code></td>
<td>
<p>prior degrees of freedom for the prior distribution</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='rSuv_fc'>Gibbs update for multiplicative effects covariance</h2><span id='topic+rSuv_fc'></span>

<h3>Description</h3>

<p>Gibbs update for multiplicative effects covariance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rSuv_fc(U,V, Suv0=NULL,kappa0=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rSuv_fc_+3A_u">U</code></td>
<td>
<p>matrix of row random effects</p>
</td></tr>
<tr><td><code id="rSuv_fc_+3A_v">V</code></td>
<td>
<p>matrix of row random effects</p>
</td></tr>
<tr><td><code id="rSuv_fc_+3A_suv0">Suv0</code></td>
<td>
<p>prior (inverse) scale matrix for the prior distribution</p>
</td></tr>
<tr><td><code id="rSuv_fc_+3A_kappa0">kappa0</code></td>
<td>
<p>prior degrees of freedom for the prior distribution</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='rUV_fc'>Gibbs sampling of U and V</h2><span id='topic+rUV_fc'></span>

<h3>Description</h3>

<p>A Gibbs sampler for updating the multiplicative effect matrices U and V
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rUV_fc(Z, U, V, Suv, rho, s2 = 1, offset = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rUV_fc_+3A_z">Z</code></td>
<td>
<p>n X n normal relational matrix</p>
</td></tr>
<tr><td><code id="rUV_fc_+3A_u">U</code></td>
<td>
<p>current value of U</p>
</td></tr>
<tr><td><code id="rUV_fc_+3A_v">V</code></td>
<td>
<p>current value of V</p>
</td></tr>
<tr><td><code id="rUV_fc_+3A_suv">Suv</code></td>
<td>
<p>covariance of (U V)</p>
</td></tr>
<tr><td><code id="rUV_fc_+3A_rho">rho</code></td>
<td>
<p>dyadic correlation</p>
</td></tr>
<tr><td><code id="rUV_fc_+3A_s2">s2</code></td>
<td>
<p>dyadic variance</p>
</td></tr>
<tr><td><code id="rUV_fc_+3A_offset">offset</code></td>
<td>
<p>a matrix of the same dimension as Z. It is assumed that
Z-offset is equal to the multiplicative effects plus dyadic noise, so the 
offset should contain any additive effects (such as <code>Xbeta(X,beta+ 
outer(a,b,"+")  </code>  )</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>U</code></td>
<td>
<p>a new value of U</p>
</td></tr> <tr><td><code>V</code></td>
<td>
<p>a new value of V</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='rUV_rep_fc'>Gibbs sampling of U and V</h2><span id='topic+rUV_rep_fc'></span>

<h3>Description</h3>

<p>A Gibbs sampler for updating the multiplicative effect matrices U and V,
assuming they are the same across replicates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rUV_rep_fc(E.T,U,V,rho,s2=1,shrink=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rUV_rep_fc_+3A_e.t">E.T</code></td>
<td>
<p>Array of square residual relational matrix series with additive
effects and covariates subtracted out. The third dimension of the array is
for different replicates. Each slice of the array according to the third
dimension is a square residual relational matrix.</p>
</td></tr>
<tr><td><code id="rUV_rep_fc_+3A_u">U</code></td>
<td>
<p>current value of U</p>
</td></tr>
<tr><td><code id="rUV_rep_fc_+3A_v">V</code></td>
<td>
<p>current value of V</p>
</td></tr>
<tr><td><code id="rUV_rep_fc_+3A_rho">rho</code></td>
<td>
<p>dyadic correlation</p>
</td></tr>
<tr><td><code id="rUV_rep_fc_+3A_s2">s2</code></td>
<td>
<p>dyadic variance</p>
</td></tr>
<tr><td><code id="rUV_rep_fc_+3A_shrink">shrink</code></td>
<td>
<p>adaptively shrink the factors with a hierarchical prior</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>U</code></td>
<td>
<p>a new value of U</p>
</td></tr> <tr><td><code>V</code></td>
<td>
<p>a new value of V</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Hoff, Yanjun He
</p>

<hr>
<h2 id='rUV_sym_fc'>Gibbs sampling of U and V</h2><span id='topic+rUV_sym_fc'></span>

<h3>Description</h3>

<p>A Gibbs sampler for updating the multiplicative effect matrices U and V
in the symmetric case. In this case <code>U%*%t(V)</code> is symmetric, so
this is parameterized as <code>V=U%*%L</code> where <code>L</code> is the 
diagonal matrix of eigenvalues of <code>U%*%t(V)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rUV_sym_fc(E, U, V, s2 = 1, shrink=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rUV_sym_fc_+3A_e">E</code></td>
<td>
<p>square residual relational matrix</p>
</td></tr>
<tr><td><code id="rUV_sym_fc_+3A_u">U</code></td>
<td>
<p>current value of U</p>
</td></tr>
<tr><td><code id="rUV_sym_fc_+3A_v">V</code></td>
<td>
<p>current value of V</p>
</td></tr>
<tr><td><code id="rUV_sym_fc_+3A_s2">s2</code></td>
<td>
<p>dyadic variance</p>
</td></tr>
<tr><td><code id="rUV_sym_fc_+3A_shrink">shrink</code></td>
<td>
<p>adaptively shrink the factors with a hierarchical prior</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>U</code></td>
<td>
<p>a new value of U</p>
</td></tr> <tr><td><code>V</code></td>
<td>
<p>a new value of V</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
U0&lt;-matrix(rnorm(30,2),30,2) ; V0&lt;-U0%*%diag(c(3,-2)) 
E&lt;- U0%*%t(V0) + matrix(rnorm(30^2),30,30) 
rUV_sym_fc 

</code></pre>

<hr>
<h2 id='rwish'>Simulation from a Wishart distribution</h2><span id='topic+rwish'></span>

<h3>Description</h3>

<p>Simulates a random Wishart-distributed matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rwish(S0, nu = dim(S0)[1] + 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rwish_+3A_s0">S0</code></td>
<td>
<p>a positive definite matrix</p>
</td></tr>
<tr><td><code id="rwish_+3A_nu">nu</code></td>
<td>
<p>a positive integer</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a positive definite matrix
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## The expectation is S0*nu

S0&lt;-rwish(diag(3)) 

SS&lt;-matrix(0,3,3) 
for(s in 1:1000) { SS&lt;-SS+rwish(S0,5) }

SS/s 

S0*5


</code></pre>

<hr>
<h2 id='rZ_bin_fc'>Simulate Z based on a probit model</h2><span id='topic+rZ_bin_fc'></span>

<h3>Description</h3>

<p>Simulates a random latent matrix Z given its expectation, dyadic correlation
and a binary relational matrix Y
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rZ_bin_fc(Z, EZ, rho, Y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rZ_bin_fc_+3A_z">Z</code></td>
<td>
<p>a square matrix, the current value of Z</p>
</td></tr>
<tr><td><code id="rZ_bin_fc_+3A_ez">EZ</code></td>
<td>
<p>expected value of Z</p>
</td></tr>
<tr><td><code id="rZ_bin_fc_+3A_rho">rho</code></td>
<td>
<p>dyadic correlation</p>
</td></tr>
<tr><td><code id="rZ_bin_fc_+3A_y">Y</code></td>
<td>
<p>square binary relational matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a square matrix , the new value of Z
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='rZ_cbin_fc'>Simulate Z given fixed rank nomination data</h2><span id='topic+rZ_cbin_fc'></span>

<h3>Description</h3>

<p>Simulates a random latent matrix Z given its expectation, dyadic correlation
and censored binary nomination data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rZ_cbin_fc(Z, EZ, rho, Y, odmax, odobs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rZ_cbin_fc_+3A_z">Z</code></td>
<td>
<p>a square matrix, the current value of Z</p>
</td></tr>
<tr><td><code id="rZ_cbin_fc_+3A_ez">EZ</code></td>
<td>
<p>expected value of Z</p>
</td></tr>
<tr><td><code id="rZ_cbin_fc_+3A_rho">rho</code></td>
<td>
<p>dyadic correlation</p>
</td></tr>
<tr><td><code id="rZ_cbin_fc_+3A_y">Y</code></td>
<td>
<p>square matrix of ranked nomination data</p>
</td></tr>
<tr><td><code id="rZ_cbin_fc_+3A_odmax">odmax</code></td>
<td>
<p>a scalar or vector giving the maximum number of nominations for
each individual</p>
</td></tr>
<tr><td><code id="rZ_cbin_fc_+3A_odobs">odobs</code></td>
<td>
<p>observed outdegree</p>
</td></tr>
</table>


<h3>Details</h3>

<p>simulates Z under the constraints (1) Y[i,j]=1, Y[i,k]=0 =&gt; Z[i,j]&gt;Z[i,k] ,
(2) Y[i,j]=1 =&gt; Z[i,j]&gt;0 , (3) Y[i,j]=0 &amp; odobs[i]&lt;odmax[i] =&gt; Z[i,j]&lt;0
</p>


<h3>Value</h3>

<p>a square matrix, the new value of Z
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='rZ_frn_fc'>Simulate Z given fixed rank nomination data</h2><span id='topic+rZ_frn_fc'></span>

<h3>Description</h3>

<p>Simulates a random latent matrix Z given its expectation, dyadic correlation
and fixed rank nomination data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rZ_frn_fc(Z, EZ, rho, Y, YL, odmax, odobs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rZ_frn_fc_+3A_z">Z</code></td>
<td>
<p>a square matrix, the current value of Z</p>
</td></tr>
<tr><td><code id="rZ_frn_fc_+3A_ez">EZ</code></td>
<td>
<p>expected value of Z</p>
</td></tr>
<tr><td><code id="rZ_frn_fc_+3A_rho">rho</code></td>
<td>
<p>dyadic correlation</p>
</td></tr>
<tr><td><code id="rZ_frn_fc_+3A_y">Y</code></td>
<td>
<p>square matrix of ranked nomination data</p>
</td></tr>
<tr><td><code id="rZ_frn_fc_+3A_yl">YL</code></td>
<td>
<p>list of ranked individuals, from least to most preferred in each
row</p>
</td></tr>
<tr><td><code id="rZ_frn_fc_+3A_odmax">odmax</code></td>
<td>
<p>a scalar or vector giving the maximum number of nominations for
each individual</p>
</td></tr>
<tr><td><code id="rZ_frn_fc_+3A_odobs">odobs</code></td>
<td>
<p>observed outdegree</p>
</td></tr>
</table>


<h3>Details</h3>

<p>simulates Z under the constraints (1) Y[i,j]&gt;Y[i,k] =&gt; Z[i,j]&gt;Z[i,k] , (2)
Y[i,j]&gt;0 =&gt; Z[i,j]&gt;0 , (3) Y[i,j]=0 &amp; odobs[i]&lt;odmax[i] =&gt; Z[i,j]&lt;0
</p>


<h3>Value</h3>

<p>a square matrix, the new value of Z
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='rZ_nrm_fc'>Simulate missing values in a normal AME model</h2><span id='topic+rZ_nrm_fc'></span>

<h3>Description</h3>

<p>Simulates missing values of a sociomatrix under a normal AME model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rZ_nrm_fc(Z, EZ, rho,s2, Y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rZ_nrm_fc_+3A_z">Z</code></td>
<td>
<p>a square matrix, the current value of Z</p>
</td></tr>
<tr><td><code id="rZ_nrm_fc_+3A_ez">EZ</code></td>
<td>
<p>expected value of Z</p>
</td></tr>
<tr><td><code id="rZ_nrm_fc_+3A_rho">rho</code></td>
<td>
<p>dyadic correlation</p>
</td></tr>
<tr><td><code id="rZ_nrm_fc_+3A_s2">s2</code></td>
<td>
<p>dyadic variance</p>
</td></tr>
<tr><td><code id="rZ_nrm_fc_+3A_y">Y</code></td>
<td>
<p>square relational matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a square matrix, equal to Y at non-missing values
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='rZ_ord_fc'>Simulate Z given the partial ranks</h2><span id='topic+rZ_ord_fc'></span>

<h3>Description</h3>

<p>Simulates a random latent matrix Z given its expectation, dyadic correlation
and partial rank information provided by W
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rZ_ord_fc(Z, EZ, rho, Y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rZ_ord_fc_+3A_z">Z</code></td>
<td>
<p>a square matrix, the current value of Z</p>
</td></tr>
<tr><td><code id="rZ_ord_fc_+3A_ez">EZ</code></td>
<td>
<p>expected value of Z</p>
</td></tr>
<tr><td><code id="rZ_ord_fc_+3A_rho">rho</code></td>
<td>
<p>dyadic correlation</p>
</td></tr>
<tr><td><code id="rZ_ord_fc_+3A_y">Y</code></td>
<td>
<p>matrix of ordinal data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a square matrix, the new value of Z
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='rZ_rrl_fc'>Simulate Z given relative rank nomination data</h2><span id='topic+rZ_rrl_fc'></span>

<h3>Description</h3>

<p>Simulates a random latent matrix Z given its expectation, dyadic correlation
and relative rank nomination data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rZ_rrl_fc(Z, EZ, rho, Y, YL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rZ_rrl_fc_+3A_z">Z</code></td>
<td>
<p>a square matrix, the current value of Z</p>
</td></tr>
<tr><td><code id="rZ_rrl_fc_+3A_ez">EZ</code></td>
<td>
<p>expected value of Z</p>
</td></tr>
<tr><td><code id="rZ_rrl_fc_+3A_rho">rho</code></td>
<td>
<p>dyadic correlation</p>
</td></tr>
<tr><td><code id="rZ_rrl_fc_+3A_y">Y</code></td>
<td>
<p>square matrix of ranked nomination data</p>
</td></tr>
<tr><td><code id="rZ_rrl_fc_+3A_yl">YL</code></td>
<td>
<p>list of ranked individuals, from least to most preferred in each
row</p>
</td></tr>
</table>


<h3>Details</h3>

<p>simulates Z under the constraints (1) Y[i,j]&gt;Y[i,k] =&gt; Z[i,j]&gt;Z[i,k]
</p>


<h3>Value</h3>

<p>a square matrix, the new value of Z
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='rZ_tob_fc'>Simulate Z based on a tobit model</h2><span id='topic+rZ_tob_fc'></span>

<h3>Description</h3>

<p>Simulates a random latent matrix Z given its expectation, dyadic correlation
and a nonnegative relational matrix Y
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rZ_tob_fc(Z, EZ,rho,s2,Y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rZ_tob_fc_+3A_z">Z</code></td>
<td>
<p>a square matrix, the current value of Z</p>
</td></tr>
<tr><td><code id="rZ_tob_fc_+3A_ez">EZ</code></td>
<td>
<p>expected value of Z</p>
</td></tr>
<tr><td><code id="rZ_tob_fc_+3A_rho">rho</code></td>
<td>
<p>dyadic correlation</p>
</td></tr>
<tr><td><code id="rZ_tob_fc_+3A_s2">s2</code></td>
<td>
<p>dyadic variance</p>
</td></tr>
<tr><td><code id="rZ_tob_fc_+3A_y">Y</code></td>
<td>
<p>square relational matrix with nonnegative entries</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a square matrix, the new value of Z
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='sampsonmonks'>Sampson's monastery data</h2><span id='topic+sampsonmonks'></span>

<h3>Description</h3>

<p>Several dyadic variables measured on 18 members of a monastery.
</p>


<h3>Format</h3>

<p>A socioarray whose dimensions represent nominators, nominatees and relations. 
Each monk was asked to rank up to three other monks on a variety of positive 
and negative relations. A rank of three indicates the &quot;highest&quot; ranking for 
a particular relational variable. The relations <code>like_m2</code> and <code>like_m1</code>
are evaluations of likeing at one and two timepoints previous to when the 
other relations were measured.
</p>


<h3>Source</h3>

<p>Linton Freeman
</p>

<hr>
<h2 id='sheep'>Sheep dominance data</h2><span id='topic+sheep'></span>

<h3>Description</h3>

<p>Number of dominance encounters between 28 female bighorn sheep. 
Cell (i,j) records the number of times sheep i dominated sheep j. 
From Hass (1991).
</p>


<h3>Format</h3>

<p>A list consisting of the following:
</p>

<ul>
<li> <p><code>dom</code>: a directed socioarray recording the number of 
dominance encounters. 
</p>
</li>
<li> <p><code>age</code>: the age of each sheep in years. 
</p>
</li></ul>



<h3>Source</h3>

<p>Linton Freeman
</p>

<hr>
<h2 id='simY_bin'>Simulate a network, i.e. a binary relational matrix</h2><span id='topic+simY_bin'></span>

<h3>Description</h3>

<p>Simulates a network, i.e. a binary relational matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simY_bin(EZ, rho)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simY_bin_+3A_ez">EZ</code></td>
<td>
<p>square matrix giving the expected value of the latent Z matrix</p>
</td></tr>
<tr><td><code id="simY_bin_+3A_rho">rho</code></td>
<td>
<p>dyadic correlation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a square binary matrix
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='simY_frn'>Simulate an relational matrix based on a fixed rank nomination scheme</h2><span id='topic+simY_frn'></span>

<h3>Description</h3>

<p>Simulate an relational matrix based on a fixed rank nomination scheme
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simY_frn(EZ, rho, odmax, YO)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simY_frn_+3A_ez">EZ</code></td>
<td>
<p>a square matrix giving the expected value of the latent Z matrix</p>
</td></tr>
<tr><td><code id="simY_frn_+3A_rho">rho</code></td>
<td>
<p>dyadic correlation</p>
</td></tr>
<tr><td><code id="simY_frn_+3A_odmax">odmax</code></td>
<td>
<p>a scalar or vector giving the maximum number of nominations for
each node</p>
</td></tr>
<tr><td><code id="simY_frn_+3A_yo">YO</code></td>
<td>
<p>a square matrix identifying where missing values should be
maintained</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a square matrix, where higher values represent stronger
relationships
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='simY_nrm'>Simulate a normal relational matrix</h2><span id='topic+simY_nrm'></span>

<h3>Description</h3>

<p>Simulates a normal relational matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simY_nrm(EY, rho, s2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simY_nrm_+3A_ey">EY</code></td>
<td>
<p>square matrix giving the expected value of the relational matrix</p>
</td></tr>
<tr><td><code id="simY_nrm_+3A_rho">rho</code></td>
<td>
<p>dyadic correlation</p>
</td></tr>
<tr><td><code id="simY_nrm_+3A_s2">s2</code></td>
<td>
<p>dyadic variance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a square matrix
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='simY_ord'>Simulate an ordinal relational matrix</h2><span id='topic+simY_ord'></span>

<h3>Description</h3>

<p>Simulates an ordinal relational matrix having a particular marginal
distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simY_ord(EZ, rho, Y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simY_ord_+3A_ez">EZ</code></td>
<td>
<p>square matrix giving the expected value of the latent Z matrix</p>
</td></tr>
<tr><td><code id="simY_ord_+3A_rho">rho</code></td>
<td>
<p>scalar giving the within-dyad correlation</p>
</td></tr>
<tr><td><code id="simY_ord_+3A_y">Y</code></td>
<td>
<p>ordinal relational data matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a square matrix
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='simY_rrl'>Simulate an relational matrix based on a relative rank nomination scheme</h2><span id='topic+simY_rrl'></span>

<h3>Description</h3>

<p>Simulate an relational matrix based on a relative rank nomination scheme
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simY_rrl(EZ, rho, odobs, YO)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simY_rrl_+3A_ez">EZ</code></td>
<td>
<p>a square matrix giving the expected value of the latent Z matrix</p>
</td></tr>
<tr><td><code id="simY_rrl_+3A_rho">rho</code></td>
<td>
<p>dyadic correlation</p>
</td></tr>
<tr><td><code id="simY_rrl_+3A_odobs">odobs</code></td>
<td>
<p>a scalar or vector giving the observed number of nominations
for each node</p>
</td></tr>
<tr><td><code id="simY_rrl_+3A_yo">YO</code></td>
<td>
<p>a square matrix identifying where missing values should be
maintained</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a square matrix, where higher values represent stronger
relationships
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='simY_tob'>Simulate a tobit relational matrix</h2><span id='topic+simY_tob'></span>

<h3>Description</h3>

<p>Simulates a tobit relational matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simY_tob(EY, rho, s2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simY_tob_+3A_ey">EY</code></td>
<td>
<p>square matrix giving the expected value of the relational matrix</p>
</td></tr>
<tr><td><code id="simY_tob_+3A_rho">rho</code></td>
<td>
<p>dyadic correlation</p>
</td></tr>
<tr><td><code id="simY_tob_+3A_s2">s2</code></td>
<td>
<p>dyadic variance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a square matrix
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='simZ'>Simulate Z given its expectation and covariance</h2><span id='topic+simZ'></span>

<h3>Description</h3>

<p>Simulate Z given its expectation and covariance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simZ(EZ, rho, s2 = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simZ_+3A_ez">EZ</code></td>
<td>
<p>expected value of Z</p>
</td></tr>
<tr><td><code id="simZ_+3A_rho">rho</code></td>
<td>
<p>dyadic correlation</p>
</td></tr>
<tr><td><code id="simZ_+3A_s2">s2</code></td>
<td>
<p>dyadic variance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a simulated value of Z
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='sm2el'>Sociomatrix to edgelist</h2><span id='topic+sm2el'></span>

<h3>Description</h3>

<p>Construction of an edgelist from a sociomatrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sm2el(sm,directed=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sm2el_+3A_sm">sm</code></td>
<td>
<p>a sociomatrix with possibly valued relations</p>
</td></tr>
<tr><td><code id="sm2el_+3A_directed">directed</code></td>
<td>
<p>if TRUE, only use the upper triangular part of the matrix to enumerate edges</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an edglist
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Y&lt;-matrix(rpois(10*10,.5),10,10) ; diag(Y)&lt;-NA
E&lt;-sm2el(Y) 
el2sm(E) - Y 

</code></pre>

<hr>
<h2 id='summary.ame'>Summary of an AME object</h2><span id='topic+summary.ame'></span>

<h3>Description</h3>

<p>Summary method for an AME object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ame'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.ame_+3A_object">object</code></td>
<td>
<p>the result of fitting an AME model</p>
</td></tr>
<tr><td><code id="summary.ame_+3A_...">...</code></td>
<td>
<p>additional parameters (not used)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a summary of parameter estimates and confidence intervals for an AME
fit
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='Xbeta'>Linear combinations of submatrices of an array</h2><span id='topic+Xbeta'></span>

<h3>Description</h3>

<p>Computes a matrix of expected values based on an array X of predictors and a
vector beta of regression coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Xbeta(X, beta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Xbeta_+3A_x">X</code></td>
<td>
<p>an n by n by p array</p>
</td></tr>
<tr><td><code id="Xbeta_+3A_beta">beta</code></td>
<td>
<p>a p by 1 vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An n by n matrix
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='xnet'>Network embedding</h2><span id='topic+xnet'></span>

<h3>Description</h3>

<p>Compute an embedding of a sociomatrix into a two-dimensional space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xnet(
  Y,
  fm = try(requireNamespace("network", quietly = TRUE), silent = TRUE),
  seed = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xnet_+3A_y">Y</code></td>
<td>
<p>(square matrix) The sociomatrix.</p>
</td></tr>
<tr><td><code id="xnet_+3A_fm">fm</code></td>
<td>
<p>(logical scalar) If TRUE, the Fruchterman-Reingold layout will 
be used (requires the network package).</p>
</td></tr>
<tr><td><code id="xnet_+3A_seed">seed</code></td>
<td>
<p>(integer) The random seed (the FR layout is random).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Coordinates are obtained using the Fruchterman-Reingold layout if the 
package <code>network</code> is installed, and otherwise uses the first two 
eigenvectors the sociomatrix.
</p>


<h3>Value</h3>

<p>(matrix) A matrix of two-dimensional coordinates.
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(addhealthc3) 
Y&lt;-addhealthc3$Y
X&lt;-xnet(Y) 
netplot(Y,X) 

</code></pre>

<hr>
<h2 id='YX_bin'>binary relational data and covariates</h2><span id='topic+YX_bin'></span>

<h3>Description</h3>

<p>a synthetic dataset that includes binary relational data as well as
information on eight covariates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(YX_bin)
</code></pre>


<h3>Format</h3>

<p>The format is: List of 2 $ Y: num [1:100, 1:100] NA 0 0 0 0 0 0 0 0
1 ...  $ X: num [1:100, 1:100, 1:8] 1 1 1 1 1 1 1 1 1 1 ...  ..- attr(*,
&quot;dimnames&quot;)=List of 3 .. ..$ : NULL .. ..$ : NULL .. ..$ : chr [1:8]
&quot;intercept&quot; &quot;rgpa&quot; &quot;rsmoke&quot; &quot;cgpa&quot; ...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(YX_bin)
gofstats(YX_bin$Y) 

</code></pre>

<hr>
<h2 id='YX_bin_long'>binary relational data and covariates</h2><span id='topic+YX_bin_long'></span>

<h3>Description</h3>

<p>a synthetic dataset that includes longitudinal binary relational data
as well as information on covariates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(YX_bin_long)
</code></pre>


<h3>Format</h3>

<p>a list
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(YX_bin_long)
gofstats(YX_bin_long$Y[,,1]) 

</code></pre>

<hr>
<h2 id='YX_cbin'>Censored binary nomination data and covariates</h2><span id='topic+YX_cbin'></span>

<h3>Description</h3>

<p>a synthetic dataset that includes relational data where the number of
nominations per row is censored at 10, along with information on eight
covariates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(YX_cbin)
</code></pre>


<h3>Format</h3>

<p>The format is: List of 2 $ Y: num [1:100, 1:100] NA 0 0 0 1 0 0 0 0
3 ...  $ X: num [1:100, 1:100, 1:8] 1 1 1 1 1 1 1 1 1 1 ...  ..- attr(*,
&quot;dimnames&quot;)=List of 3 .. ..$ : NULL .. ..$ : NULL .. ..$ : chr [1:8]
&quot;intercept&quot; &quot;rgpa&quot; &quot;rsmoke&quot; &quot;cgpa&quot; ...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(YX_cbin)
gofstats(YX_cbin$Y) 

</code></pre>

<hr>
<h2 id='YX_frn'>Fixed rank nomination data and covariates</h2><span id='topic+YX_frn'></span>

<h3>Description</h3>

<p>a synthetic dataset that includes fixed rank nomination data as well as
information on eight covariates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(YX_frn)
</code></pre>


<h3>Format</h3>

<p>The format is: List of 2 $ Y: num [1:100, 1:100] NA 0 0 0 1 0 0 0 0
3 ...  $ X: num [1:100, 1:100, 1:8] 1 1 1 1 1 1 1 1 1 1 ...  ..- attr(*,
&quot;dimnames&quot;)=List of 3 .. ..$ : NULL .. ..$ : NULL .. ..$ : chr [1:8]
&quot;intercept&quot; &quot;rgpa&quot; &quot;rsmoke&quot; &quot;cgpa&quot; ...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(YX_frn)
gofstats(YX_frn$Y) 

</code></pre>

<hr>
<h2 id='YX_nrm'>normal relational data and covariates</h2><span id='topic+YX_nrm'></span>

<h3>Description</h3>

<p>a synthetic dataset that includes continuous (normal) relational data as
well as information on eight covariates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(YX_nrm)
</code></pre>


<h3>Format</h3>

<p>The format is: List of 2 $ Y: num [1:100, 1:100] NA -4.05 -0.181
-3.053 -1.579 ...  $ X: num [1:100, 1:100, 1:8] 1 1 1 1 1 1 1 1 1 1 ...  ..-
attr(*, &quot;dimnames&quot;)=List of 3 .. ..$ : NULL .. ..$ : NULL .. ..$ : chr [1:8]
&quot;intercept&quot; &quot;rgpa&quot; &quot;rsmoke&quot; &quot;cgpa&quot; ...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(YX_nrm)
gofstats(YX_nrm$Y)


</code></pre>

<hr>
<h2 id='YX_ord'>ordinal relational data and covariates</h2><span id='topic+YX_ord'></span>

<h3>Description</h3>

<p>a synthetic dataset that includes ordinal relational data as well as
information on seven covariates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(YX_ord)
</code></pre>


<h3>Format</h3>

<p>The format is: List of 2 $ Y: num [1:100, 1:100] NA 0 3 0 3 1 0 1 1
0 ...  $ X: num [1:100, 1:100, 1:7] 1 1 1 1 1 1 1 1 1 1 ...  ..- attr(*,
&quot;dimnames&quot;)=List of 3 .. ..$ : NULL .. ..$ : NULL .. ..$ : chr [1:7] &quot;rgpa&quot;
&quot;rsmoke&quot; &quot;cgpa&quot; &quot;csmoke&quot; ...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(YX_ord)
gofstats(YX_ord$Y)

</code></pre>

<hr>
<h2 id='YX_rrl'>row-specific ordinal relational data and covariates</h2><span id='topic+YX_rrl'></span>

<h3>Description</h3>

<p>a synthetic dataset that includes row-specific ordinal relational data as
well as information on five covariates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(YX_rrl)
</code></pre>


<h3>Format</h3>

<p>The format is: List of 2 $ Y: num [1:100, 1:100] NA 0 3 0 3 1 0 1 1
0 ...  $ X: num [1:100, 1:100, 1:5] 1 1 1 1 1 1 1 1 1 1 ...  ..- attr(*,
&quot;dimnames&quot;)=List of 3 .. ..$ : NULL .. ..$ : NULL .. ..$ : chr [1:5] &quot;cgpa&quot;
&quot;csmoke&quot; &quot;igrade&quot; &quot;ismoke&quot; ...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(YX_rrl)
gofstats(YX_rrl$Y)

</code></pre>

<hr>
<h2 id='zscores'>rank-based z-scores</h2><span id='topic+zscores'></span>

<h3>Description</h3>

<p>Computes the normal scores corresponding to the ranks of a data vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zscores(y,ties.method="average")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="zscores_+3A_y">y</code></td>
<td>
<p>a numeric vector</p>
</td></tr>
<tr><td><code id="zscores_+3A_ties.method">ties.method</code></td>
<td>
<p>method for dealing with ties</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric vector
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
