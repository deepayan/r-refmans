<!DOCTYPE html><html lang="en-GB"><head><title>Help for package DiscreteFWER</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DiscreteFWER}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DiscreteFWER-package'><p>FWER-Based Multiple Testing Procedures with Adaptation for Discrete Tests</p></a></li>
<li><a href='#DBonferroni'><p>Discrete Bonferroni Procedure</p></a></li>
<li><a href='#DHochberg'><p>Discrete Hochberg Procedure</p></a></li>
<li><a href='#DHolm'><p>Discrete Holm Procedure</p></a></li>
<li><a href='#direct_discrete_FWER'><p>Direct Application of Multiple Testing Procedures to Dataset</p></a></li>
<li><a href='#discrete_FWER'><p>Discrete Family-wise Error Rate (FWER) Adaptation Procedures</p></a></li>
<li><a href='#DSidak'><p>Discrete Šidák Procedure for Independent Tests</p></a></li>
<li><a href='#hist.DiscreteFWER'><p>Histogram of Raw P-Values</p></a></li>
<li><a href='#kernel'><p>Kernel Functions</p></a></li>
<li><a href='#match_pvals'><p>Matching Raw P-Values with Supports</p></a></li>
<li><a href='#plot.DiscreteFWER'><p>Plot Method for <code>DiscreteFWER</code> objects</p></a></li>
<li><a href='#print.DiscreteFWER'><p>Printing discrete FWER results</p></a></li>
<li><a href='#summary.DiscreteFWER'><p>Summarizing Discrete FWER Results</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>FWER-Based Multiple Testing Procedures with Adaptation for
Discrete Tests</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-11-26</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementations of several multiple testing procedures that control
    the family-wise error rate (FWER) designed specifically for discrete tests.
    Included are discrete adaptations of the Bonferroni, Holm, Hochberg and
    Šidák procedures as described in the papers Döhler (2010) "Validation of
    credit default probabilities using multiple-testing procedures"
    &lt;<a href="https://doi.org/10.21314%2FJRMV.2010.062">doi:10.21314/JRMV.2010.062</a>&gt; and Zhu &amp; Guo (2019) "Family-Wise Error Rate
    Controlling Procedures for Discrete Data" 
    &lt;<a href="https://doi.org/10.1080%2F19466315.2019.1654912">doi:10.1080/19466315.2019.1654912</a>&gt;. The main procedures of this package
    take as input the results of a test procedure from package 'DiscreteTests'
    or a set of observed p-values and their discrete support under their nulls.
    A shortcut function to apply discrete procedures directly to data is also
    provided.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.13), checkmate, DiscreteFDR (&ge; 2.0.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>DiscreteDatasets, DiscreteTests (&ge; 0.2.1)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/DISOhda/DiscreteFWER">https://github.com/DISOhda/DiscreteFWER</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/DISOhda/DiscreteFWER/issues">https://github.com/DISOhda/DiscreteFWER/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-11-26 19:49:39 UTC; fjunge</td>
</tr>
<tr>
<td>Author:</td>
<td>Sebastian Döhler <a href="https://orcid.org/0000-0002-0321-6355"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, ctb],
  Florian Junge <a href="https://orcid.org/0009-0001-6856-6938"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, ctb, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Florian Junge &lt;diso.fbmn@h-da.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-11-27 13:00:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='DiscreteFWER-package'>FWER-Based Multiple Testing Procedures with Adaptation for Discrete Tests</h2><span id='topic+DiscreteFWER'></span><span id='topic+DiscreteFWER-package'></span>

<h3>Description</h3>

<p>This package implements adaptions for discrete tests of the Bonferroni, Holm,
Hochberg and Šidák procedures for control of the family-wise error rate
(FWER).
</p>


<h3>Details</h3>

<p>The main function <code><a href="#topic+discrete_FWER">discrete_FWER()</a></code> makes all four procedures available to
the user. <code><a href="#topic+DBonferroni">DBonferroni()</a></code>, <code><a href="#topic+DHolm">DHolm()</a></code>, <code><a href="#topic+DHochberg">DHochberg()</a></code> and <code><a href="#topic+DSidak">DSidak()</a></code>
are wrapper functions that enable the user to access them directly. Their
main parameters are either a
<code><a href="DiscreteTests.html#topic+DiscreteTestResults">DiscreteTestResults</a></code> object from
package <a href="DiscreteTests.html#topic+DiscreteTests-package">DiscreteTests</a> or a vector of
raw observed p-values and a list whose elements are the discrete supports
of the CDFs of the <code class="reqn">p</code>-values.
</p>
<p>The function <code><a href="#topic+direct_discrete_FWER">direct_discrete_FWER()</a></code>is a wrapper for
<code><a href="DiscreteFDR.html#topic+generate.pvalues">DiscreteFDR::generate.pvalues()</a></code> and <code><a href="#topic+discrete_FWER">discrete_FWER()</a></code>, which applies
discrete procedures directly to data.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Florian Junge <a href="mailto:diso.fbmn@h-da.de">diso.fbmn@h-da.de</a> (<a href="https://orcid.org/0009-0001-6856-6938">ORCID</a>) [contributor]
</p>
<p>Authors:
</p>

<ul>
<li><p> Sebastian Döhler <a href="mailto:sebastian.doehler@h-da.de">sebastian.doehler@h-da.de</a> (<a href="https://orcid.org/0000-0002-0321-6355">ORCID</a>) [contributor]
</p>
</li></ul>



<h3>References</h3>

<p>Döhler, S. (2010). Validation of credit default probabilities using
multiple-testing procedures. <em>Journal of Risk Model Validation</em>, <em>4</em>(4),
59-92. <a href="https://doi.org/10.21314/JRMV.2010.062">doi:10.21314/JRMV.2010.062</a>
</p>
<p>Zhu, Y., &amp; Guo, W. (2019). Family-Wise Error Rate Controlling Procedures for
Discrete Data. <em>Statistics in Biopharmaceutical Research</em>, <em>12</em>(1),
117-128. <a href="https://doi.org/10.1080/19466315.2019.1654912">doi:10.1080/19466315.2019.1654912</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/DISOhda/DiscreteFWER">https://github.com/DISOhda/DiscreteFWER</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/DISOhda/DiscreteFWER/issues">https://github.com/DISOhda/DiscreteFWER/issues</a>
</p>
</li></ul>


<hr>
<h2 id='DBonferroni'>Discrete Bonferroni Procedure</h2><span id='topic+DBonferroni'></span><span id='topic+DBonferroni.default'></span><span id='topic+DBonferroni.DiscreteTestResults'></span>

<h3>Description</h3>

<p><code>DBonferroni()</code> is a wrapper function of <code><a href="#topic+discrete_FWER">discrete_FWER()</a></code> for computing
the discrete Bonferroni procedure for tests with an arbitrary dependency
structure. It simply passes its arguments to <code><a href="#topic+discrete_FWER">discrete_FWER()</a></code> with fixed
<code>independence = FALSE</code> and <code>single_step = TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DBonferroni(test_results, ...)

## Default S3 method:
DBonferroni(
  test_results,
  pCDFlist,
  alpha = 0.05,
  critical_values = FALSE,
  select_threshold = 1,
  pCDFlist_indices = NULL,
  ...
)

## S3 method for class 'DiscreteTestResults'
DBonferroni(
  test_results,
  alpha = 0.05,
  critical_values = FALSE,
  select_threshold = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DBonferroni_+3A_test_results">test_results</code></td>
<td>
<p>either a numeric vector with <code class="reqn">p</code>-values or an R6 object of class <code><a href="DiscreteTests.html#topic+DiscreteTestResults">DiscreteTestResults</a></code> from package <a href="DiscreteTests.html#topic+DiscreteTests">DiscreteTests</a> for which a discrete FWER procedure is to be performed.</p>
</td></tr>
<tr><td><code id="DBonferroni_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from other methods. They are ignored here.</p>
</td></tr>
<tr><td><code id="DBonferroni_+3A_pcdflist">pCDFlist</code></td>
<td>
<p>list of the supports of the CDFs of the <code class="reqn">p</code>-values; each list item must be a numeric vector, which is sorted in increasing order and whose last element equals 1.</p>
</td></tr>
<tr><td><code id="DBonferroni_+3A_alpha">alpha</code></td>
<td>
<p>single real number strictly between 0 and 1 indicating the target FWER level.</p>
</td></tr>
<tr><td><code id="DBonferroni_+3A_critical_values">critical_values</code></td>
<td>
<p>single boolean specifying whether critical constants are to be computed.</p>
</td></tr>
<tr><td><code id="DBonferroni_+3A_select_threshold">select_threshold</code></td>
<td>
<p>single real number strictly between 0 and 1 indicating the largest raw <code class="reqn">p</code>-value to be considered, i.e. only <code class="reqn">p</code>-values below this threshold are considered and the procedures are adjusted in order to take this selection effect into account; if <code>select_threshold = 1</code> (the default), all raw <code class="reqn">p</code>-values are selected.</p>
</td></tr>
<tr><td><code id="DBonferroni_+3A_pcdflist_indices">pCDFlist_indices</code></td>
<td>
<p>list of numeric vectors containing the test indices that indicate to which raw <code class="reqn">p</code>-value(s) each support in <code>pCDFlist</code> belongs; if <code>NULL</code> (the default) the lengths of <code>test_results</code> and <code>pCDFlist</code> <strong>must</strong> be equal.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computing critical constants (<code>critical_values = TRUE</code>) requires considerably
more execution time, especially if the number of unique supports is large.
We recommend that users should only have them calculated when they need them,
e.g. for illustrating the rejection set in a plot or other theoretical
reasons. Setting (<code>critical_values = FALSE</code>) is sufficient for obtaining
rejection decisions and adjusted <code class="reqn">p</code>-values.
</p>


<h3>Value</h3>

<p>A <code>DiscreteFWER</code> S3 class object whose elements are:
</p>
<table role = "presentation">
<tr><td><code>Rejected</code></td>
<td>
<p>rejected raw <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Indices</code></td>
<td>
<p>indices of rejected hypotheses.</p>
</td></tr>
<tr><td><code>Num_rejected</code></td>
<td>
<p>number of rejections.</p>
</td></tr>
<tr><td><code>Adjusted</code></td>
<td>
<p>adjusted <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Critical_constants</code></td>
<td>
<p>critical values (only exists if computations where performed with <code>critical_values = TRUE</code>).</p>
</td></tr>
<tr><td><code>Data</code></td>
<td>
<p>list with input data.</p>
</td></tr>
<tr><td><code>Data$Method</code></td>
<td>
<p>character string describing the performed algorithm, e.g. 'Discrete Bonferroni procedure'.</p>
</td></tr>
<tr><td><code>Data$Raw_pvalues</code></td>
<td>
<p>observed <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Data$pCDFlist</code></td>
<td>
<p>list of the <code class="reqn">p</code>-value supports.</p>
</td></tr>
<tr><td><code>Data$FWER_level</code></td>
<td>
<p>FWER level <code>alpha</code>.</p>
</td></tr>
<tr><td><code>Data$Independence</code></td>
<td>
<p>boolean indicating whether the <code class="reqn">p</code>-values were considered as independent.</p>
</td></tr>
<tr><td><code>Data$Single_step</code></td>
<td>
<p>boolean indicating whether a single-step or step-down procedure was performed.</p>
</td></tr>
<tr><td><code>Data$Data_name</code></td>
<td>
<p>the respective variable names of the input data.</p>
</td></tr>
<tr><td><code>Select</code></td>
<td>
<p>list with data related to <code class="reqn">p</code>-value selection; only exists if <code>select_threshold &lt; 1</code>.</p>
</td></tr>
<tr><td><code>Select$Threshold</code></td>
<td>
<p><code class="reqn">p</code>-value selection threshold (<code>select_threshold</code>).</p>
</td></tr>
<tr><td><code>Select$Effective_Thresholds</code></td>
<td>
<p>results of each <code class="reqn">p</code>-value CDF evaluated at the selection threshold.</p>
</td></tr>
<tr><td><code>Select$Pvalues</code></td>
<td>
<p>selected <code class="reqn">p</code>-values that are <code class="reqn">\leq</code> selection threshold.</p>
</td></tr>
<tr><td><code>Select$Indices</code></td>
<td>
<p>indices of <code class="reqn">p</code>-values <code class="reqn">\leq</code> selection threshold.</p>
</td></tr>
<tr><td><code>Select$Scaled</code></td>
<td>
<p>scaled selected <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Select$Number</code></td>
<td>
<p>number of selected <code class="reqn">p</code>-values <code class="reqn">\leq</code> selection threshold.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Döhler, S. (2010). Validation of credit default probabilities using
multiple-testing procedures. <em>Journal of Risk Model Validation</em>, <em>4</em>(4),
59-92. <a href="https://doi.org/10.21314/JRMV.2010.062">doi:10.21314/JRMV.2010.062</a>
</p>
<p>Zhu, Y., &amp; Guo, W. (2019). Family-Wise Error Rate Controlling Procedures for
Discrete Data. <em>Statistics in Biopharmaceutical Research</em>, <em>12</em>(1),
117-128. <a href="https://doi.org/10.1080/19466315.2019.1654912">doi:10.1080/19466315.2019.1654912</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+discrete_FWER">discrete_FWER()</a></code>, <code><a href="#topic+DHolm">DHolm()</a></code>, <code><a href="#topic+DSidak">DSidak()</a></code>, <code><a href="#topic+DHochberg">DHochberg()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X1 &lt;- c(4, 2, 2, 14, 6, 9, 4, 0, 1)
X2 &lt;- c(0, 0, 1, 3, 2, 1, 2, 2, 2)
N1 &lt;- rep(148, 9)
N2 &lt;- rep(132, 9)
Y1 &lt;- N1 - X1
Y2 &lt;- N2 - X2
df &lt;- data.frame(X1, Y1, X2, Y2)
df

# Computation of p-values and their supports with Fisher's exact test
library(DiscreteTests)  # for Fisher's exact test
test_results &lt;- fisher_test_pv(df)
raw_pvalues &lt;- test_results$get_pvalues()
pCDFlist &lt;- test_results$get_pvalue_supports()

# d-Bonferroni without critical values; using extracted p-values and supports
DBonferroni_fast &lt;- DBonferroni(raw_pvalues, pCDFlist)
summary(DBonferroni_fast)

# d-Bonferroni with critical values; using test results object
DBonferroni_crit &lt;- DBonferroni(test_results, critical_values = TRUE)
summary(DBonferroni_crit)

</code></pre>

<hr>
<h2 id='DHochberg'>Discrete Hochberg Procedure</h2><span id='topic+DHochberg'></span><span id='topic+DHochberg.default'></span><span id='topic+DHochberg.DiscreteTestResults'></span>

<h3>Description</h3>

<p><code>DHochberg()</code> is a wrapper function of <code><a href="#topic+discrete_FWER">discrete_FWER()</a></code> for computing the
discrete Hochberg step-up procedure for independent or positively correlated
discrete tests. It simply passes its arguments to <code><a href="#topic+discrete_FWER">discrete_FWER()</a></code> with
fixed <code>independence = TRUE</code> and <code>single_step = FALSE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DHochberg(test_results, ...)

## Default S3 method:
DHochberg(
  test_results,
  pCDFlist,
  alpha = 0.05,
  critical_values = FALSE,
  select_threshold = 1,
  pCDFlist_indices = NULL,
  ...
)

## S3 method for class 'DiscreteTestResults'
DHochberg(
  test_results,
  alpha = 0.05,
  critical_values = FALSE,
  select_threshold = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DHochberg_+3A_test_results">test_results</code></td>
<td>
<p>either a numeric vector with <code class="reqn">p</code>-values or an R6 object of class <code><a href="DiscreteTests.html#topic+DiscreteTestResults">DiscreteTestResults</a></code> from package <a href="DiscreteTests.html#topic+DiscreteTests">DiscreteTests</a> for which a discrete FWER procedure is to be performed.</p>
</td></tr>
<tr><td><code id="DHochberg_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from other methods. They are ignored here.</p>
</td></tr>
<tr><td><code id="DHochberg_+3A_pcdflist">pCDFlist</code></td>
<td>
<p>list of the supports of the CDFs of the <code class="reqn">p</code>-values; each list item must be a numeric vector, which is sorted in increasing order and whose last element equals 1.</p>
</td></tr>
<tr><td><code id="DHochberg_+3A_alpha">alpha</code></td>
<td>
<p>single real number strictly between 0 and 1 indicating the target FWER level.</p>
</td></tr>
<tr><td><code id="DHochberg_+3A_critical_values">critical_values</code></td>
<td>
<p>single boolean specifying whether critical constants are to be computed.</p>
</td></tr>
<tr><td><code id="DHochberg_+3A_select_threshold">select_threshold</code></td>
<td>
<p>single real number strictly between 0 and 1 indicating the largest raw <code class="reqn">p</code>-value to be considered, i.e. only <code class="reqn">p</code>-values below this threshold are considered and the procedures are adjusted in order to take this selection effect into account; if <code>select_threshold = 1</code> (the default), all raw <code class="reqn">p</code>-values are selected.</p>
</td></tr>
<tr><td><code id="DHochberg_+3A_pcdflist_indices">pCDFlist_indices</code></td>
<td>
<p>list of numeric vectors containing the test indices that indicate to which raw <code class="reqn">p</code>-value(s) each support in <code>pCDFlist</code> belongs; if <code>NULL</code> (the default) the lengths of <code>test_results</code> and <code>pCDFlist</code> <strong>must</strong> be equal.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computing critical constants (<code>critical_values = TRUE</code>) requires considerably
more execution time, especially if the number of unique supports is large.
We recommend that users should only have them calculated when they need them,
e.g. for illustrating the rejection set in a plot or other theoretical
reasons. Setting (<code>critical_values = FALSE</code>) is sufficient for obtaining
rejection decisions and adjusted <code class="reqn">p</code>-values.
</p>


<h3>Value</h3>

<p>A <code>DiscreteFWER</code> S3 class object whose elements are:
</p>
<table role = "presentation">
<tr><td><code>Rejected</code></td>
<td>
<p>rejected raw <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Indices</code></td>
<td>
<p>indices of rejected hypotheses.</p>
</td></tr>
<tr><td><code>Num_rejected</code></td>
<td>
<p>number of rejections.</p>
</td></tr>
<tr><td><code>Adjusted</code></td>
<td>
<p>adjusted <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Critical_constants</code></td>
<td>
<p>critical values (only exists if computations where performed with <code>critical_values = TRUE</code>).</p>
</td></tr>
<tr><td><code>Data</code></td>
<td>
<p>list with input data.</p>
</td></tr>
<tr><td><code>Data$Method</code></td>
<td>
<p>character string describing the performed algorithm, e.g. 'Discrete Bonferroni procedure'.</p>
</td></tr>
<tr><td><code>Data$Raw_pvalues</code></td>
<td>
<p>observed <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Data$pCDFlist</code></td>
<td>
<p>list of the <code class="reqn">p</code>-value supports.</p>
</td></tr>
<tr><td><code>Data$FWER_level</code></td>
<td>
<p>FWER level <code>alpha</code>.</p>
</td></tr>
<tr><td><code>Data$Independence</code></td>
<td>
<p>boolean indicating whether the <code class="reqn">p</code>-values were considered as independent.</p>
</td></tr>
<tr><td><code>Data$Single_step</code></td>
<td>
<p>boolean indicating whether a single-step or step-down procedure was performed.</p>
</td></tr>
<tr><td><code>Data$Data_name</code></td>
<td>
<p>the respective variable names of the input data.</p>
</td></tr>
<tr><td><code>Select</code></td>
<td>
<p>list with data related to <code class="reqn">p</code>-value selection; only exists if <code>select_threshold &lt; 1</code>.</p>
</td></tr>
<tr><td><code>Select$Threshold</code></td>
<td>
<p><code class="reqn">p</code>-value selection threshold (<code>select_threshold</code>).</p>
</td></tr>
<tr><td><code>Select$Effective_Thresholds</code></td>
<td>
<p>results of each <code class="reqn">p</code>-value CDF evaluated at the selection threshold.</p>
</td></tr>
<tr><td><code>Select$Pvalues</code></td>
<td>
<p>selected <code class="reqn">p</code>-values that are <code class="reqn">\leq</code> selection threshold.</p>
</td></tr>
<tr><td><code>Select$Indices</code></td>
<td>
<p>indices of <code class="reqn">p</code>-values <code class="reqn">\leq</code> selection threshold.</p>
</td></tr>
<tr><td><code>Select$Scaled</code></td>
<td>
<p>scaled selected <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Select$Number</code></td>
<td>
<p>number of selected <code class="reqn">p</code>-values <code class="reqn">\leq</code> selection threshold.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Zhu, Y., &amp; Guo, W. (2019). Family-Wise Error Rate Controlling Procedures for
Discrete Data. <em>Statistics in Biopharmaceutical Research</em>, <em>12</em>(1),
117-128. <a href="https://doi.org/10.1080/19466315.2019.1654912">doi:10.1080/19466315.2019.1654912</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+discrete_FWER">discrete_FWER()</a></code>, <code><a href="#topic+DSidak">DSidak()</a></code>, <code><a href="#topic+DBonferroni">DBonferroni()</a></code>, <code><a href="#topic+DHolm">DHolm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X1 &lt;- c(4, 2, 2, 14, 6, 9, 4, 0, 1)
X2 &lt;- c(0, 0, 1, 3, 2, 1, 2, 2, 2)
N1 &lt;- rep(148, 9)
N2 &lt;- rep(132, 9)
Y1 &lt;- N1 - X1
Y2 &lt;- N2 - X2
df &lt;- data.frame(X1, Y1, X2, Y2)
df

# Computation of p-values and their supports with Fisher's exact test
library(DiscreteTests)  # for Fisher's exact test
test_results &lt;- fisher_test_pv(df)
raw_pvalues &lt;- test_results$get_pvalues()
pCDFlist &lt;- test_results$get_pvalue_supports()

# d-Hochberg without critical values; using test results object
DHoch_fast &lt;- DHochberg(test_results)
summary(DHoch_fast)

# d-Hochberg with critical values; using extracted p-values and supports
DHoch_crit &lt;- DHochberg(raw_pvalues, pCDFlist, critical_values = TRUE)
summary(DHoch_crit)

</code></pre>

<hr>
<h2 id='DHolm'>Discrete Holm Procedure</h2><span id='topic+DHolm'></span><span id='topic+DHolm.default'></span><span id='topic+DHolm.DiscreteTestResults'></span>

<h3>Description</h3>

<p><code>DHolm()</code> is a wrapper function of <code><a href="#topic+discrete_FWER">discrete_FWER()</a></code> for computing the
discrete Holm step-down procedure for tests with an arbitrary dependency
structure. It simply passes its arguments to <code><a href="#topic+discrete_FWER">discrete_FWER()</a></code> with fixed
<code>independence = FALSE</code> and <code>single_step = FALSE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DHolm(test_results, ...)

## Default S3 method:
DHolm(
  test_results,
  pCDFlist,
  alpha = 0.05,
  critical_values = FALSE,
  select_threshold = 1,
  pCDFlist_indices = NULL,
  ...
)

## S3 method for class 'DiscreteTestResults'
DHolm(
  test_results,
  alpha = 0.05,
  critical_values = FALSE,
  select_threshold = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DHolm_+3A_test_results">test_results</code></td>
<td>
<p>either a numeric vector with <code class="reqn">p</code>-values or an R6 object of class <code><a href="DiscreteTests.html#topic+DiscreteTestResults">DiscreteTestResults</a></code> from package <a href="DiscreteTests.html#topic+DiscreteTests">DiscreteTests</a> for which a discrete FWER procedure is to be performed.</p>
</td></tr>
<tr><td><code id="DHolm_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from other methods. They are ignored here.</p>
</td></tr>
<tr><td><code id="DHolm_+3A_pcdflist">pCDFlist</code></td>
<td>
<p>list of the supports of the CDFs of the <code class="reqn">p</code>-values; each list item must be a numeric vector, which is sorted in increasing order and whose last element equals 1.</p>
</td></tr>
<tr><td><code id="DHolm_+3A_alpha">alpha</code></td>
<td>
<p>single real number strictly between 0 and 1 indicating the target FWER level.</p>
</td></tr>
<tr><td><code id="DHolm_+3A_critical_values">critical_values</code></td>
<td>
<p>single boolean specifying whether critical constants are to be computed.</p>
</td></tr>
<tr><td><code id="DHolm_+3A_select_threshold">select_threshold</code></td>
<td>
<p>single real number strictly between 0 and 1 indicating the largest raw <code class="reqn">p</code>-value to be considered, i.e. only <code class="reqn">p</code>-values below this threshold are considered and the procedures are adjusted in order to take this selection effect into account; if <code>select_threshold = 1</code> (the default), all raw <code class="reqn">p</code>-values are selected.</p>
</td></tr>
<tr><td><code id="DHolm_+3A_pcdflist_indices">pCDFlist_indices</code></td>
<td>
<p>list of numeric vectors containing the test indices that indicate to which raw <code class="reqn">p</code>-value(s) each support in <code>pCDFlist</code> belongs; if <code>NULL</code> (the default) the lengths of <code>test_results</code> and <code>pCDFlist</code> <strong>must</strong> be equal.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computing critical constants (<code>critical_values = TRUE</code>) requires considerably
more execution time, especially if the number of unique supports is large.
We recommend that users should only have them calculated when they need them,
e.g. for illustrating the rejection set in a plot or other theoretical
reasons. Setting (<code>critical_values = FALSE</code>) is sufficient for obtaining
rejection decisions and adjusted <code class="reqn">p</code>-values.
</p>


<h3>Value</h3>

<p>A <code>DiscreteFWER</code> S3 class object whose elements are:
</p>
<table role = "presentation">
<tr><td><code>Rejected</code></td>
<td>
<p>rejected raw <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Indices</code></td>
<td>
<p>indices of rejected hypotheses.</p>
</td></tr>
<tr><td><code>Num_rejected</code></td>
<td>
<p>number of rejections.</p>
</td></tr>
<tr><td><code>Adjusted</code></td>
<td>
<p>adjusted <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Critical_constants</code></td>
<td>
<p>critical values (only exists if computations where performed with <code>critical_values = TRUE</code>).</p>
</td></tr>
<tr><td><code>Data</code></td>
<td>
<p>list with input data.</p>
</td></tr>
<tr><td><code>Data$Method</code></td>
<td>
<p>character string describing the performed algorithm, e.g. 'Discrete Bonferroni procedure'.</p>
</td></tr>
<tr><td><code>Data$Raw_pvalues</code></td>
<td>
<p>observed <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Data$pCDFlist</code></td>
<td>
<p>list of the <code class="reqn">p</code>-value supports.</p>
</td></tr>
<tr><td><code>Data$FWER_level</code></td>
<td>
<p>FWER level <code>alpha</code>.</p>
</td></tr>
<tr><td><code>Data$Independence</code></td>
<td>
<p>boolean indicating whether the <code class="reqn">p</code>-values were considered as independent.</p>
</td></tr>
<tr><td><code>Data$Single_step</code></td>
<td>
<p>boolean indicating whether a single-step or step-down procedure was performed.</p>
</td></tr>
<tr><td><code>Data$Data_name</code></td>
<td>
<p>the respective variable names of the input data.</p>
</td></tr>
<tr><td><code>Select</code></td>
<td>
<p>list with data related to <code class="reqn">p</code>-value selection; only exists if <code>select_threshold &lt; 1</code>.</p>
</td></tr>
<tr><td><code>Select$Threshold</code></td>
<td>
<p><code class="reqn">p</code>-value selection threshold (<code>select_threshold</code>).</p>
</td></tr>
<tr><td><code>Select$Effective_Thresholds</code></td>
<td>
<p>results of each <code class="reqn">p</code>-value CDF evaluated at the selection threshold.</p>
</td></tr>
<tr><td><code>Select$Pvalues</code></td>
<td>
<p>selected <code class="reqn">p</code>-values that are <code class="reqn">\leq</code> selection threshold.</p>
</td></tr>
<tr><td><code>Select$Indices</code></td>
<td>
<p>indices of <code class="reqn">p</code>-values <code class="reqn">\leq</code> selection threshold.</p>
</td></tr>
<tr><td><code>Select$Scaled</code></td>
<td>
<p>scaled selected <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Select$Number</code></td>
<td>
<p>number of selected <code class="reqn">p</code>-values <code class="reqn">\leq</code> selection threshold.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Döhler, S. (2010). Validation of credit default probabilities using
multiple-testing procedures. <em>Journal of Risk Model Validation</em>, <em>4</em>(4),
59-92. <a href="https://doi.org/10.21314/JRMV.2010.062">doi:10.21314/JRMV.2010.062</a>
</p>
<p>Zhu, Y., &amp; Guo, W. (2019). Family-Wise Error Rate Controlling Procedures for
Discrete Data. <em>Statistics in Biopharmaceutical Research</em>, <em>12</em>(1),
117-128. <a href="https://doi.org/10.1080/19466315.2019.1654912">doi:10.1080/19466315.2019.1654912</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+discrete_FWER">discrete_FWER()</a></code>, <code><a href="#topic+DBonferroni">DBonferroni()</a></code>, <code><a href="#topic+DSidak">DSidak()</a></code>, <code><a href="#topic+DHochberg">DHochberg()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X1 &lt;- c(4, 2, 2, 14, 6, 9, 4, 0, 1)
X2 &lt;- c(0, 0, 1, 3, 2, 1, 2, 2, 2)
N1 &lt;- rep(148, 9)
N2 &lt;- rep(132, 9)
Y1 &lt;- N1 - X1
Y2 &lt;- N2 - X2
df &lt;- data.frame(X1, Y1, X2, Y2)
df

# Computation of p-values and their supports with Fisher's exact test
library(DiscreteTests)  # for Fisher's exact test
test_results &lt;- fisher_test_pv(df)
raw_pvalues &lt;- test_results$get_pvalues()
pCDFlist &lt;- test_results$get_pvalue_supports()

# d-Holm without critical values; using extracted p-values and supports
DHolm_fast &lt;- DHolm(raw_pvalues, pCDFlist)
summary(DHolm_fast)

# d-Holm with critical values; using test results object
DHolm_crit &lt;- DHolm(test_results, critical_values = TRUE)
summary(DHolm_crit)

</code></pre>

<hr>
<h2 id='direct_discrete_FWER'>Direct Application of Multiple Testing Procedures to Dataset</h2><span id='topic+direct_discrete_FWER'></span>

<h3>Description</h3>

<p>Apply one of the various FWER adaptation procedures, with or without
computing the critical constants, to a data set of 2x2 contingency tables
using statistical test functions from package
<code><a href="DiscreteTests.html#topic+DiscreteTests-package">DiscreteTests</a></code>. If necessary,
functions for pre-processing can be passed as well.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>direct_discrete_FWER(
  dat,
  test_fun,
  test_args = NULL,
  alpha = 0.05,
  independence = FALSE,
  single_step = TRUE,
  critical_values = FALSE,
  select_threshold = 1,
  preprocess_fun = NULL,
  preprocess_args = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="direct_discrete_FWER_+3A_dat">dat</code></td>
<td>
<p>input data; must be suitable for the first parameter of the provided <code>preprocess_fun</code> function or, if <code>preprocess_fun</code> is <code>NULL</code>, for the first parameter of the <code>test_fun</code> function.</p>
</td></tr>
<tr><td><code id="direct_discrete_FWER_+3A_test_fun">test_fun</code></td>
<td>
<p>function <strong>from package <code><a href="DiscreteTests.html#topic+DiscreteTests-package">DiscreteTests</a></code></strong>, i.e. one whose name ends with <code style="white-space: pre;">&#8288;*_test_pv&#8288;</code> and which performs hypothesis tests and provides an object with <code class="reqn">p</code>-values and their support sets; can be specified by a single character string (which is automatically checked for being a suitable function <strong>from that package</strong> and may be abbreviated) or a single function object.</p>
</td></tr>
<tr><td><code id="direct_discrete_FWER_+3A_test_args">test_args</code></td>
<td>
<p>optional named list with arguments for <code>test_fun</code>; the names of the list fields must match the test function's parameter names. The first parameter of the test function (i.e. the data) MUST NOT be included!</p>
</td></tr>
<tr><td><code id="direct_discrete_FWER_+3A_alpha">alpha</code></td>
<td>
<p>single real number strictly between 0 and 1 indicating the target FWER level.</p>
</td></tr>
<tr><td><code id="direct_discrete_FWER_+3A_independence">independence</code></td>
<td>
<p>single boolean specifying whether the <code class="reqn">p</code>-values are statistically independent or not.</p>
</td></tr>
<tr><td><code id="direct_discrete_FWER_+3A_single_step">single_step</code></td>
<td>
<p>single boolean specifying whether to perform a single-step (<code>TRUE</code>) or step-down (<code>FALSE</code>; the default) procedure.</p>
</td></tr>
<tr><td><code id="direct_discrete_FWER_+3A_critical_values">critical_values</code></td>
<td>
<p>single boolean specifying whether critical constants are to be computed.</p>
</td></tr>
<tr><td><code id="direct_discrete_FWER_+3A_select_threshold">select_threshold</code></td>
<td>
<p>single real number strictly between 0 and 1 indicating the largest raw <code class="reqn">p</code>-value to be considered, i.e. only <code class="reqn">p</code>-values below this threshold are considered and the procedures are adjusted in order to take this selection effect into account; if <code>select_threshold = 1</code> (the default), all raw <code class="reqn">p</code>-values are selected.</p>
</td></tr>
<tr><td><code id="direct_discrete_FWER_+3A_preprocess_fun">preprocess_fun</code></td>
<td>
<p>optional function for pre-processing the input <code>data</code>; its result must be suitable for the first parameter of the <code>test_fun</code> function.</p>
</td></tr>
<tr><td><code id="direct_discrete_FWER_+3A_preprocess_args">preprocess_args</code></td>
<td>
<p>optional named list with arguments for <code>preprocess_fun</code>; the names of the list fields must match the pre-processing function's parameter names. The first parameter of the test function (i.e. the data) MUST NOT be included!</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>DiscreteFWER</code> S3 class object whose elements are:
</p>
<table role = "presentation">
<tr><td><code>Rejected</code></td>
<td>
<p>rejected raw <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Indices</code></td>
<td>
<p>indices of rejected hypotheses.</p>
</td></tr>
<tr><td><code>Num_rejected</code></td>
<td>
<p>number of rejections.</p>
</td></tr>
<tr><td><code>Adjusted</code></td>
<td>
<p>adjusted <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Critical_constants</code></td>
<td>
<p>critical values (only exists if computations where performed with <code>critical_values = TRUE</code>).</p>
</td></tr>
<tr><td><code>Data</code></td>
<td>
<p>list with input data.</p>
</td></tr>
<tr><td><code>Data$Method</code></td>
<td>
<p>character string describing the performed algorithm, e.g. 'Discrete Bonferroni procedure'.</p>
</td></tr>
<tr><td><code>Data$Raw_pvalues</code></td>
<td>
<p>observed <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Data$pCDFlist</code></td>
<td>
<p>list of the <code class="reqn">p</code>-value supports.</p>
</td></tr>
<tr><td><code>Data$FWER_level</code></td>
<td>
<p>FWER level <code>alpha</code>.</p>
</td></tr>
<tr><td><code>Data$Independence</code></td>
<td>
<p>boolean indicating whether the <code class="reqn">p</code>-values were considered as independent.</p>
</td></tr>
<tr><td><code>Data$Single_step</code></td>
<td>
<p>boolean indicating whether a single-step or step-down procedure was performed.</p>
</td></tr>
<tr><td><code>Data$Data_name</code></td>
<td>
<p>the respective variable names of the input data.</p>
</td></tr>
<tr><td><code>Select</code></td>
<td>
<p>list with data related to <code class="reqn">p</code>-value selection; only exists if <code>select_threshold &lt; 1</code>.</p>
</td></tr>
<tr><td><code>Select$Threshold</code></td>
<td>
<p><code class="reqn">p</code>-value selection threshold (<code>select_threshold</code>).</p>
</td></tr>
<tr><td><code>Select$Effective_Thresholds</code></td>
<td>
<p>results of each <code class="reqn">p</code>-value CDF evaluated at the selection threshold.</p>
</td></tr>
<tr><td><code>Select$Pvalues</code></td>
<td>
<p>selected <code class="reqn">p</code>-values that are <code class="reqn">\leq</code> selection threshold.</p>
</td></tr>
<tr><td><code>Select$Indices</code></td>
<td>
<p>indices of <code class="reqn">p</code>-values <code class="reqn">\leq</code> selection threshold.</p>
</td></tr>
<tr><td><code>Select$Scaled</code></td>
<td>
<p>scaled selected <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Select$Number</code></td>
<td>
<p>number of selected <code class="reqn">p</code>-values <code class="reqn">\leq</code> selection threshold.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>X1 &lt;- c(4, 2, 2, 14, 6, 9, 4, 0, 1)
X2 &lt;- c(0, 0, 1, 3, 2, 1, 2, 2, 2)
N1 &lt;- rep(148, 9)
N2 &lt;- rep(132, 9)
Y1 &lt;- N1 - X1
Y2 &lt;- N2 - X2
df &lt;- data.frame(X1, Y1, X2, Y2)
df

# Computation of p-values and their supports with Fisher's exact test
library(DiscreteTests)  # for Fisher's exact test
test_results &lt;- fisher_test_pv(df)
raw_pvalues &lt;- test_results$get_pvalues()
pCDFlist &lt;- test_results$get_pvalue_supports()

DBonf &lt;- direct_discrete_FWER(df, "fisher")
summary(DBonf)

DHolm &lt;- direct_discrete_FWER(df, "fisher_test_pv", single_step = FALSE)
summary(DHolm)

DBonf_bin &lt;- direct_discrete_FWER(X1 + X2, "binom_test_pv", 
                                  list(n = N1 + N2, p = 0.05))
summary(DBonf_bin)

DHolm_bin &lt;- direct_discrete_FWER(X1 + X2, "binom", 
                                  list(n = N1 + N2, p = 0.05),
                                  single_step = TRUE)
summary(DHolm_bin)

</code></pre>

<hr>
<h2 id='discrete_FWER'>Discrete Family-wise Error Rate (FWER) Adaptation Procedures</h2><span id='topic+discrete_FWER'></span><span id='topic+discrete_FWER.default'></span><span id='topic+discrete_FWER.DiscreteTestResults'></span>

<h3>Description</h3>

<p>Apply a discrete FWER adaptation procedure, with or without computing the
critical values, to a set of p-values and their discrete support.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>discrete_FWER(test_results, ...)

## Default S3 method:
discrete_FWER(
  test_results,
  pCDFlist,
  alpha = 0.05,
  independence = FALSE,
  single_step = FALSE,
  critical_values = FALSE,
  select_threshold = 1,
  pCDFlist_indices = NULL,
  ...
)

## S3 method for class 'DiscreteTestResults'
discrete_FWER(
  test_results,
  alpha = 0.05,
  independence = FALSE,
  single_step = FALSE,
  critical_values = FALSE,
  select_threshold = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="discrete_FWER_+3A_test_results">test_results</code></td>
<td>
<p>either a numeric vector with <code class="reqn">p</code>-values or an R6 object of class <code><a href="DiscreteTests.html#topic+DiscreteTestResults">DiscreteTestResults</a></code> from package <a href="DiscreteTests.html#topic+DiscreteTests">DiscreteTests</a> for which a discrete FWER procedure is to be performed.</p>
</td></tr>
<tr><td><code id="discrete_FWER_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from other methods. They are ignored here.</p>
</td></tr>
<tr><td><code id="discrete_FWER_+3A_pcdflist">pCDFlist</code></td>
<td>
<p>list of the supports of the CDFs of the <code class="reqn">p</code>-values; each list item must be a numeric vector, which is sorted in increasing order and whose last element equals 1.</p>
</td></tr>
<tr><td><code id="discrete_FWER_+3A_alpha">alpha</code></td>
<td>
<p>single real number strictly between 0 and 1 indicating the target FWER level.</p>
</td></tr>
<tr><td><code id="discrete_FWER_+3A_independence">independence</code></td>
<td>
<p>single boolean specifying whether the <code class="reqn">p</code>-values are statistically independent or not.</p>
</td></tr>
<tr><td><code id="discrete_FWER_+3A_single_step">single_step</code></td>
<td>
<p>single boolean specifying whether to perform a single-step (<code>TRUE</code>) or step-down (<code>FALSE</code>; the default) procedure.</p>
</td></tr>
<tr><td><code id="discrete_FWER_+3A_critical_values">critical_values</code></td>
<td>
<p>single boolean specifying whether critical constants are to be computed.</p>
</td></tr>
<tr><td><code id="discrete_FWER_+3A_select_threshold">select_threshold</code></td>
<td>
<p>single real number strictly between 0 and 1 indicating the largest raw <code class="reqn">p</code>-value to be considered, i.e. only <code class="reqn">p</code>-values below this threshold are considered and the procedures are adjusted in order to take this selection effect into account; if <code>select_threshold = 1</code> (the default), all raw <code class="reqn">p</code>-values are selected.</p>
</td></tr>
<tr><td><code id="discrete_FWER_+3A_pcdflist_indices">pCDFlist_indices</code></td>
<td>
<p>list of numeric vectors containing the test indices that indicate to which raw <code class="reqn">p</code>-value(s) each support in <code>pCDFlist</code> belongs; if <code>NULL</code> (the default) the lengths of <code>test_results</code> and <code>pCDFlist</code> <strong>must</strong> be equal.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computing critical constants (<code>critical_values = TRUE</code>) requires considerably
more execution time, especially if the number of unique supports is large.
We recommend that users should only have them calculated when they need them,
e.g. for illustrating the rejection set in a plot or other theoretical
reasons. Setting (<code>critical_values = FALSE</code>) is sufficient for obtaining
rejection decisions and adjusted <code class="reqn">p</code>-values.
</p>
<p>Depending on the choices of <code>independence</code> and <code>single_step</code>, one of the
following procedures, is applied:</p>

<table>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: center;"> single-step </td><td style="text-align: center;"> stepwise </td>
</tr>
<tr>
 <td style="text-align: left;">
   independent </td><td style="text-align: center;"> Šidák </td><td style="text-align: center;"> Hochberg (step-up) </td>
</tr>
<tr>
 <td style="text-align: left;">
   not independent </td><td style="text-align: center;"> Bonferroni </td><td style="text-align: center;"> Holm (step-down) </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Each procedure is available by its own shortcut function:</p>

<table>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: center;"> single-step </td><td style="text-align: center;"> stepwise </td>
</tr>
<tr>
 <td style="text-align: left;">
   independent </td><td style="text-align: center;"> <code>DSidak()</code> </td><td style="text-align: center;"> <code>DHochberg()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   not independent </td><td style="text-align: center;"> <code>DBonferroni()</code> </td><td style="text-align: center;"> <code>DHolm()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Value</h3>

<p>A <code>DiscreteFWER</code> S3 class object whose elements are:
</p>
<table role = "presentation">
<tr><td><code>Rejected</code></td>
<td>
<p>rejected raw <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Indices</code></td>
<td>
<p>indices of rejected hypotheses.</p>
</td></tr>
<tr><td><code>Num_rejected</code></td>
<td>
<p>number of rejections.</p>
</td></tr>
<tr><td><code>Adjusted</code></td>
<td>
<p>adjusted <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Critical_constants</code></td>
<td>
<p>critical values (only exists if computations where performed with <code>critical_values = TRUE</code>).</p>
</td></tr>
<tr><td><code>Data</code></td>
<td>
<p>list with input data.</p>
</td></tr>
<tr><td><code>Data$Method</code></td>
<td>
<p>character string describing the performed algorithm, e.g. 'Discrete Bonferroni procedure'.</p>
</td></tr>
<tr><td><code>Data$Raw_pvalues</code></td>
<td>
<p>observed <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Data$pCDFlist</code></td>
<td>
<p>list of the <code class="reqn">p</code>-value supports.</p>
</td></tr>
<tr><td><code>Data$FWER_level</code></td>
<td>
<p>FWER level <code>alpha</code>.</p>
</td></tr>
<tr><td><code>Data$Independence</code></td>
<td>
<p>boolean indicating whether the <code class="reqn">p</code>-values were considered as independent.</p>
</td></tr>
<tr><td><code>Data$Single_step</code></td>
<td>
<p>boolean indicating whether a single-step or step-down procedure was performed.</p>
</td></tr>
<tr><td><code>Data$Data_name</code></td>
<td>
<p>the respective variable names of the input data.</p>
</td></tr>
<tr><td><code>Select</code></td>
<td>
<p>list with data related to <code class="reqn">p</code>-value selection; only exists if <code>select_threshold &lt; 1</code>.</p>
</td></tr>
<tr><td><code>Select$Threshold</code></td>
<td>
<p><code class="reqn">p</code>-value selection threshold (<code>select_threshold</code>).</p>
</td></tr>
<tr><td><code>Select$Effective_Thresholds</code></td>
<td>
<p>results of each <code class="reqn">p</code>-value CDF evaluated at the selection threshold.</p>
</td></tr>
<tr><td><code>Select$Pvalues</code></td>
<td>
<p>selected <code class="reqn">p</code>-values that are <code class="reqn">\leq</code> selection threshold.</p>
</td></tr>
<tr><td><code>Select$Indices</code></td>
<td>
<p>indices of <code class="reqn">p</code>-values <code class="reqn">\leq</code> selection threshold.</p>
</td></tr>
<tr><td><code>Select$Scaled</code></td>
<td>
<p>scaled selected <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Select$Number</code></td>
<td>
<p>number of selected <code class="reqn">p</code>-values <code class="reqn">\leq</code> selection threshold.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Döhler, S. (2010). Validation of credit default probabilities using
multiple-testing procedures. <em>Journal of Risk Model Validation</em>, <em>4</em>(4),
59-92. <a href="https://doi.org/10.21314/JRMV.2010.062">doi:10.21314/JRMV.2010.062</a>
</p>
<p>Zhu, Y., &amp; Guo, W. (2019). Family-Wise Error Rate Controlling Procedures for
Discrete Data. <em>Statistics in Biopharmaceutical Research</em>, <em>12</em>(1),
117-128. <a href="https://doi.org/10.1080/19466315.2019.1654912">doi:10.1080/19466315.2019.1654912</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DiscreteFWER-package">DiscreteFWER</a></code>, <code><a href="#topic+DBonferroni">DBonferroni()</a></code>, <code><a href="#topic+DHolm">DHolm()</a></code>,
<code><a href="#topic+DSidak">DSidak()</a></code>, <code><a href="#topic+DHochberg">DHochberg()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X1 &lt;- c(4, 2, 2, 14, 6, 9, 4, 0, 1)
X2 &lt;- c(0, 0, 1, 3, 2, 1, 2, 2, 2)
N1 &lt;- rep(148, 9)
N2 &lt;- rep(132, 9)
Y1 &lt;- N1 - X1
Y2 &lt;- N2 - X2
df &lt;- data.frame(X1, Y1, X2, Y2)
df

# Computation of p-values and their supports with Fisher's exact test
library(DiscreteTests)  # for Fisher's exact test
test_results &lt;- fisher_test_pv(df)
raw_pvalues &lt;- test_results$get_pvalues()
pCDFlist &lt;- test_results$get_pvalue_supports()

# d-Holm without critical values; using test results object
DFWER_dep_sd_fast &lt;- discrete_FWER(test_results)
summary(DFWER_dep_sd_fast)

# d-Holm with critical values; using extracted p-values and supports
DFWER_dep_sd_crit &lt;- discrete_FWER(raw_pvalues, pCDFlist, 
                                   critical_values = TRUE)
summary(DFWER_dep_sd_crit)

# d-Bonferroni without critical values; using test results object
DFWER_dep_fast &lt;- discrete_FWER(test_results, single_step = TRUE)
summary(DFWER_dep_fast)

# d-Bonferroni with critical values; using extracted p-values and supports
DFWER_dep_crit &lt;- discrete_FWER(raw_pvalues, pCDFlist, single_step = TRUE,
                                critical_values = TRUE)
summary(DFWER_dep_crit)

# d-Hochberg without critical values; using test results object
DFWER_ind_su_fast &lt;- discrete_FWER(test_results, independence = TRUE)
summary(DFWER_ind_su_fast)

# d-Hochberg with critical values; using extracted p-values and supports
DFWER_ind_su_crit &lt;- discrete_FWER(raw_pvalues, pCDFlist, 
                                   independence = TRUE,
                                   critical_values = TRUE)
summary(DFWER_ind_su_crit)

# d-Šidák without critical values; using extracted p-values and supports
DFWER_ind_fast &lt;- discrete_FWER(raw_pvalues, pCDFlist,
                                independence = TRUE,
                                single_step = TRUE)
summary(DFWER_ind_fast)

# d-Šidák with critical values; using test results object
DFWER_ind_crit &lt;- discrete_FWER(test_results, independence = TRUE,
                                single_step = TRUE, 
                                critical_values = TRUE)
summary(DFWER_ind_crit)

</code></pre>

<hr>
<h2 id='DSidak'>Discrete Šidák Procedure for Independent Tests</h2><span id='topic+DSidak'></span><span id='topic+DSidak.default'></span><span id='topic+DSidak.DiscreteTestResults'></span>

<h3>Description</h3>

<p><code>DSidak()</code> is a wrapper function of <code><a href="#topic+discrete_FWER">discrete_FWER()</a></code> for computing the
discrete Šidák procedure for independent discrete tests. It simply passes its
arguments to <code><a href="#topic+discrete_FWER">discrete_FWER()</a></code> with fixed <code>independence = TRUE</code> and
<code>single_step = TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DSidak(test_results, ...)

## Default S3 method:
DSidak(
  test_results,
  pCDFlist,
  alpha = 0.05,
  critical_values = FALSE,
  select_threshold = 1,
  pCDFlist_indices = NULL,
  ...
)

## S3 method for class 'DiscreteTestResults'
DSidak(
  test_results,
  alpha = 0.05,
  critical_values = FALSE,
  select_threshold = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DSidak_+3A_test_results">test_results</code></td>
<td>
<p>either a numeric vector with <code class="reqn">p</code>-values or an R6 object of class <code><a href="DiscreteTests.html#topic+DiscreteTestResults">DiscreteTestResults</a></code> from package <a href="DiscreteTests.html#topic+DiscreteTests">DiscreteTests</a> for which a discrete FWER procedure is to be performed.</p>
</td></tr>
<tr><td><code id="DSidak_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from other methods. They are ignored here.</p>
</td></tr>
<tr><td><code id="DSidak_+3A_pcdflist">pCDFlist</code></td>
<td>
<p>list of the supports of the CDFs of the <code class="reqn">p</code>-values; each list item must be a numeric vector, which is sorted in increasing order and whose last element equals 1.</p>
</td></tr>
<tr><td><code id="DSidak_+3A_alpha">alpha</code></td>
<td>
<p>single real number strictly between 0 and 1 indicating the target FWER level.</p>
</td></tr>
<tr><td><code id="DSidak_+3A_critical_values">critical_values</code></td>
<td>
<p>single boolean specifying whether critical constants are to be computed.</p>
</td></tr>
<tr><td><code id="DSidak_+3A_select_threshold">select_threshold</code></td>
<td>
<p>single real number strictly between 0 and 1 indicating the largest raw <code class="reqn">p</code>-value to be considered, i.e. only <code class="reqn">p</code>-values below this threshold are considered and the procedures are adjusted in order to take this selection effect into account; if <code>select_threshold = 1</code> (the default), all raw <code class="reqn">p</code>-values are selected.</p>
</td></tr>
<tr><td><code id="DSidak_+3A_pcdflist_indices">pCDFlist_indices</code></td>
<td>
<p>list of numeric vectors containing the test indices that indicate to which raw <code class="reqn">p</code>-value(s) each support in <code>pCDFlist</code> belongs; if <code>NULL</code> (the default) the lengths of <code>test_results</code> and <code>pCDFlist</code> <strong>must</strong> be equal.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computing critical constants (<code>critical_values = TRUE</code>) requires considerably
more execution time, especially if the number of unique supports is large.
We recommend that users should only have them calculated when they need them,
e.g. for illustrating the rejection set in a plot or other theoretical
reasons. Setting (<code>critical_values = FALSE</code>) is sufficient for obtaining
rejection decisions and adjusted <code class="reqn">p</code>-values.
</p>


<h3>Value</h3>

<p>A <code>DiscreteFWER</code> S3 class object whose elements are:
</p>
<table role = "presentation">
<tr><td><code>Rejected</code></td>
<td>
<p>rejected raw <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Indices</code></td>
<td>
<p>indices of rejected hypotheses.</p>
</td></tr>
<tr><td><code>Num_rejected</code></td>
<td>
<p>number of rejections.</p>
</td></tr>
<tr><td><code>Adjusted</code></td>
<td>
<p>adjusted <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Critical_constants</code></td>
<td>
<p>critical values (only exists if computations where performed with <code>critical_values = TRUE</code>).</p>
</td></tr>
<tr><td><code>Data</code></td>
<td>
<p>list with input data.</p>
</td></tr>
<tr><td><code>Data$Method</code></td>
<td>
<p>character string describing the performed algorithm, e.g. 'Discrete Bonferroni procedure'.</p>
</td></tr>
<tr><td><code>Data$Raw_pvalues</code></td>
<td>
<p>observed <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Data$pCDFlist</code></td>
<td>
<p>list of the <code class="reqn">p</code>-value supports.</p>
</td></tr>
<tr><td><code>Data$FWER_level</code></td>
<td>
<p>FWER level <code>alpha</code>.</p>
</td></tr>
<tr><td><code>Data$Independence</code></td>
<td>
<p>boolean indicating whether the <code class="reqn">p</code>-values were considered as independent.</p>
</td></tr>
<tr><td><code>Data$Single_step</code></td>
<td>
<p>boolean indicating whether a single-step or step-down procedure was performed.</p>
</td></tr>
<tr><td><code>Data$Data_name</code></td>
<td>
<p>the respective variable names of the input data.</p>
</td></tr>
<tr><td><code>Select</code></td>
<td>
<p>list with data related to <code class="reqn">p</code>-value selection; only exists if <code>select_threshold &lt; 1</code>.</p>
</td></tr>
<tr><td><code>Select$Threshold</code></td>
<td>
<p><code class="reqn">p</code>-value selection threshold (<code>select_threshold</code>).</p>
</td></tr>
<tr><td><code>Select$Effective_Thresholds</code></td>
<td>
<p>results of each <code class="reqn">p</code>-value CDF evaluated at the selection threshold.</p>
</td></tr>
<tr><td><code>Select$Pvalues</code></td>
<td>
<p>selected <code class="reqn">p</code>-values that are <code class="reqn">\leq</code> selection threshold.</p>
</td></tr>
<tr><td><code>Select$Indices</code></td>
<td>
<p>indices of <code class="reqn">p</code>-values <code class="reqn">\leq</code> selection threshold.</p>
</td></tr>
<tr><td><code>Select$Scaled</code></td>
<td>
<p>scaled selected <code class="reqn">p</code>-values.</p>
</td></tr>
<tr><td><code>Select$Number</code></td>
<td>
<p>number of selected <code class="reqn">p</code>-values <code class="reqn">\leq</code> selection threshold.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Döhler, S. (2010). Validation of credit default probabilities using
multiple-testing procedures. <em>Journal of Risk Model Validation</em>, <em>4</em>(4),
59-92. <a href="https://doi.org/10.21314/JRMV.2010.062">doi:10.21314/JRMV.2010.062</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+discrete_FWER">discrete_FWER()</a></code>, <code><a href="#topic+DHochberg">DHochberg()</a></code>, <code><a href="#topic+DBonferroni">DBonferroni()</a></code>, <code><a href="#topic+DHolm">DHolm()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X1 &lt;- c(4, 2, 2, 14, 6, 9, 4, 0, 1)
X2 &lt;- c(0, 0, 1, 3, 2, 1, 2, 2, 2)
N1 &lt;- rep(148, 9)
N2 &lt;- rep(132, 9)
Y1 &lt;- N1 - X1
Y2 &lt;- N2 - X2
df &lt;- data.frame(X1, Y1, X2, Y2)
df

# Computation of p-values and their supports with Fisher's exact test
library(DiscreteTests)  # for Fisher's exact test
test_results &lt;- fisher_test_pv(df)
raw_pvalues &lt;- test_results$get_pvalues()
pCDFlist &lt;- test_results$get_pvalue_supports()

# d-Šidák without critical values; using extracted p-values and supports
DSidak_fast &lt;- DSidak(raw_pvalues, pCDFlist)
summary(DSidak_fast)

# d-Šidák with critical values; using test results object
DSidak_crit &lt;- DSidak(test_results, critical_values = TRUE)
summary(DSidak_crit)

</code></pre>

<hr>
<h2 id='hist.DiscreteFWER'>Histogram of Raw P-Values</h2><span id='topic+hist.DiscreteFWER'></span>

<h3>Description</h3>

<p>Computes a histogram of the raw p-values of a <code>DiscreteFWER</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'DiscreteFWER'
hist(x, breaks = "FD", mode = c("raw", "selected"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hist.DiscreteFWER_+3A_x">x</code></td>
<td>
<p>an object of class <code>DiscreteFWER</code>.</p>
</td></tr>
<tr><td><code id="hist.DiscreteFWER_+3A_breaks">breaks</code></td>
<td>
<p>as in <code><a href="graphics.html#topic+hist">graphics::hist()</a></code>; here, the Friedman-Diaconis
algorithm (<code>"FD"</code>) is used as default.</p>
</td></tr>
<tr><td><code id="hist.DiscreteFWER_+3A_mode">mode</code></td>
<td>
<p>single character string specifying for which $p$-values the
histogram is to be generated; must either be <code>"raw"</code> or
<code>"selected"</code>.</p>
</td></tr>
<tr><td><code id="hist.DiscreteFWER_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="graphics.html#topic+hist">graphics::hist()</a></code> or
<code><a href="graphics.html#topic+plothistogram">graphics::plot.histogram()</a></code>, respectively.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>x</code> does not contain results of a selection approach, a warning is issued
and a histogram of the raw p-values is drawn.
</p>


<h3>Value</h3>

<p>An object of class <code>histogram</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X1 &lt;- c(4, 2, 2, 14, 6, 9, 4, 0, 1)
X2 &lt;- c(0, 0, 1, 3, 2, 1, 2, 2, 2)
N1 &lt;- rep(148, 9)
N2 &lt;- rep(132, 9)
Y1 &lt;- N1 - X1
Y2 &lt;- N2 - X2
df &lt;- data.frame(X1, Y1, X2, Y2)
df

# Computation of p-values and their supports with Fisher's exact test
library(DiscreteTests)  # for Fisher's exact test
test_results &lt;- fisher_test_pv(df)
raw_pvalues &lt;- test_results$get_pvalues()
pCDFlist &lt;- test_results$get_pvalue_supports()

# d-Holm with critical values; using test results object
DHolm_crit &lt;- DHolm(test_results, critical_values = TRUE)
hist(DHolm_crit)

</code></pre>

<hr>
<h2 id='kernel'>Kernel Functions</h2><span id='topic+kernel'></span><span id='topic+kernel_DFWER_singlestep_fast'></span><span id='topic+kernel_DFWER_singlestep_crit'></span><span id='topic+kernel_DFWER_stepwise_fast'></span><span id='topic+kernel_DFWER_stepwise_crit'></span>

<h3>Description</h3>

<p>Kernel functions that transform observed p-values or their support according
to a discrete FWER approach. The outputs are used by <code><a href="#topic+discrete_FWER">discrete_FWER()</a></code>.
<code>kernel_DFWER_fast</code>, computes the transformed <code class="reqn">p</code>-values, while
<code>kernel_DFWER_crit</code> additionally computes and returns the critical
constants. The end user should not use these functions directly, as they are
internal functions and parameters (including their names, order, etc.) may
be changed without notice!
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kernel_DFWER_singlestep_fast(
  pCDFlist,
  pvalues,
  independence = FALSE,
  pCDFcounts = NULL
)

kernel_DFWER_singlestep_crit(
  pCDFlist,
  support,
  sorted_pv,
  alpha = 0.05,
  independence = FALSE,
  pCDFcounts = NULL
)

kernel_DFWER_stepwise_fast(
  pCDFlist,
  sorted_pv,
  independence = FALSE,
  pCDFindices = NULL
)

kernel_DFWER_stepwise_crit(
  pCDFlist,
  support,
  sorted_pv,
  alpha = 0.05,
  independence = FALSE,
  pCDFindices = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kernel_+3A_pcdflist">pCDFlist</code></td>
<td>
<p>list of the supports of the CDFs of the <code class="reqn">p</code>-values; each list item must be a numeric vector, which is sorted in increasing order and whose last element equals 1.</p>
</td></tr>
<tr><td><code id="kernel_+3A_pvalues">pvalues</code></td>
<td>
<p>numeric vector, sorted in increasing order, that
either must contain the entirety of all observable
values of the p-value supports (when computing
critical constants) or only the sorted raw p-values.</p>
</td></tr>
<tr><td><code id="kernel_+3A_independence">independence</code></td>
<td>
<p>single boolean specifying whether the <code class="reqn">p</code>-values
are independent; if FALSE (the default), the discrete
Bonferroni procedure [d-Bonf] is performed;
otherwise, [d-Ind] is computed.</p>
</td></tr>
<tr><td><code id="kernel_+3A_pcdfcounts">pCDFcounts</code></td>
<td>
<p>integer vector of counts that indicates to how many
p-values each <strong>unique</strong> p-value distributions
belongs.</p>
</td></tr>
<tr><td><code id="kernel_+3A_support">support</code></td>
<td>
<p>numeric vector, sorted in increasing order, that
contains the entirety of all observable values of the
p-value supports.</p>
</td></tr>
<tr><td><code id="kernel_+3A_sorted_pv">sorted_pv</code></td>
<td>
<p>numeric vector, sorted in increasing order, containing
the raw p-values.</p>
</td></tr>
<tr><td><code id="kernel_+3A_alpha">alpha</code></td>
<td>
<p>single real number strictly between 0 and 1 indicating
the target FWER level.</p>
</td></tr>
<tr><td><code id="kernel_+3A_pcdfindices">pCDFindices</code></td>
<td>
<p>list of integer vectors containing the indices that
indicate to which raw <code class="reqn">p</code>-value in <code>sorted_pv</code>
each item in <code>pCDFlist</code> belongs, and must have the
same length as <code>pCDFlist</code>; if <code>NULL</code> (the default), it
is assumed that the first item of <code>pCDFlist</code>
corresponds to the first <code class="reqn">p</code>-value, the second
item to the second <code class="reqn">p</code>-value etc. in which case
the lengths of <code>pCDFlist</code> and <code>sorted_pv</code> must be
equal.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>kernel_DFWER_singlestep_fast()</code> and <code>kernel_DFWER_stepwise_fast()</code> a
vector of transformed p-values is returned. <code>kernel_DFWER_singlestep_crit</code>
and <code>kernel_DFWER_stepwise_crit</code> return a list with critical constants
(<code style="white-space: pre;">&#8288;$crit_consts&#8288;</code>) and adjusted p-values (<code style="white-space: pre;">&#8288;$pval_transf&#8288;</code>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+discrete_FWER">discrete_FWER()</a></code>, <code><a href="#topic+direct_discrete_FWER">direct_discrete_FWER()</a></code>
</p>

<hr>
<h2 id='match_pvals'>Matching Raw P-Values with Supports</h2><span id='topic+match_pvals'></span>

<h3>Description</h3>

<p>Constructs the observed p-values from the raw observed p-values, by rounding
them to their nearest neighbour, matching with the supports of their
respective CDFs (as in function <code>p.discrete.adjust()</code> of package
<code>discreteMTP</code>, which is no longer available on CRAN).
</p>
<p><strong>Note</strong>: This is an internal function and has to be called directly via
<code>:::</code>, i.e. <code>DiscreteFWER:::match_pvals()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>match_pvals(test_results, pCDFlist, pCDFlist_indices = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="match_pvals_+3A_test_results">test_results</code></td>
<td>
<p>either a numeric vector with <code class="reqn">p</code>-values or an R6 object of class <code><a href="DiscreteTests.html#topic+DiscreteTestResults">DiscreteTestResults</a></code> from package <a href="DiscreteTests.html#topic+DiscreteTests">DiscreteTests</a> for which a discrete FWER procedure is to be performed.</p>
</td></tr>
<tr><td><code id="match_pvals_+3A_pcdflist">pCDFlist</code></td>
<td>
<p>list of the supports of the CDFs of the <code class="reqn">p</code>-values; each list item must be a numeric vector, which is sorted in increasing order and whose last element equals 1.</p>
</td></tr>
<tr><td><code id="match_pvals_+3A_pcdflist_indices">pCDFlist_indices</code></td>
<td>
<p>list of numeric vectors containing the test indices that indicate to which raw <code class="reqn">p</code>-value(s) each support in <code>pCDFlist</code> belongs; if <code>NULL</code> (the default) the lengths of <code>test_results</code> and <code>pCDFlist</code> <strong>must</strong> be equal.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Well computed raw p-values should already belong to their respective CDF
support. So this function is called at the beginning of
<code><a href="#topic+discrete_FWER.default">discrete_FWER.default()</a></code> and its wrappers, just in case raw p-values may
be biased.
</p>
<p>For each raw p-value that needs to be rounded, a warning is issued.
</p>


<h3>Value</h3>

<p>A vector where each raw p-value has been replaced by its nearest neighbour,
if necessary.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+discrete_FWER">discrete_FWER()</a></code>
</p>

<hr>
<h2 id='plot.DiscreteFWER'>Plot Method for <code>DiscreteFWER</code> objects</h2><span id='topic+plot.DiscreteFWER'></span>

<h3>Description</h3>

<p>Plots raw p-values of a <code>DiscreteFWER</code> object and highlights rejected and
accepted p-values. If calculated, the critical values are plotted, too.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'DiscreteFWER'
plot(
  x,
  col = c(2, 4, 1),
  pch = c(20, 20, 17),
  lwd = rep(par()$lwd, 3),
  cex = rep(par()$cex, 3),
  type_crit = "b",
  legend = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.DiscreteFWER_+3A_x">x</code></td>
<td>
<p>object of class <code>DiscreteFWER</code>.</p>
</td></tr>
<tr><td><code id="plot.DiscreteFWER_+3A_col">col</code></td>
<td>
<p>numeric or character vector of length 3 indicating the
colours of the </p>

<ol>
<li><p> rejected p-values
</p>
</li>
<li><p> accepted p-values
</p>
</li>
<li><p> critical values (if present).
</p>
</li></ol>
</td></tr>
<tr><td><code id="plot.DiscreteFWER_+3A_pch">pch</code></td>
<td>
<p>numeric or character vector of length 3 indicating the
point characters of the </p>

<ol>
<li><p> rejected p-values
</p>
</li>
<li><p> accepted p-values
</p>
</li>
<li><p> critical values (if present and <code>type_crit</code>
is a plot type like <code>'p'</code>, <code>'b'</code> etc.).
</p>
</li></ol>
</td></tr>
<tr><td><code id="plot.DiscreteFWER_+3A_lwd">lwd</code></td>
<td>
<p>numeric vector of length 3 indicating the thickness of the
points and lines; defaults to current <code>par()$lwd</code> setting.</p>
</td></tr>
<tr><td><code id="plot.DiscreteFWER_+3A_cex">cex</code></td>
<td>
<p>numeric vector of length 3 indicating the size of point
characters or lines of the </p>

<ol>
<li><p> rejected p-values
</p>
</li>
<li><p> accepted p-values
</p>
</li>
<li><p> critical values (if present).
</p>
</li></ol>

<p>defaults to current <code>par()$cex</code> setting.</p>
</td></tr>
<tr><td><code id="plot.DiscreteFWER_+3A_type_crit">type_crit</code></td>
<td>
<p>1-character string giving the type of plot desired for the
critical values (e.g.: <code>'p'</code>, <code>'l'</code> etc; see <code><a href="base.html#topic+plot">plot()</a></code>).</p>
</td></tr>
<tr><td><code id="plot.DiscreteFWER_+3A_legend">legend</code></td>
<td>
<p>if <code>NULL</code>, no legend is plotted; otherwise expecting a
character string like <code>"topleft"</code> etc. or a numeric vector
of two elements indicating (x, y) coordinates.</p>
</td></tr>
<tr><td><code id="plot.DiscreteFWER_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="graphics.html#topic+plot.default">plot.default()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot is created, but no value is returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X1 &lt;- c(4, 2, 2, 14, 6, 9, 4, 0, 1)
X2 &lt;- c(0, 0, 1, 3, 2, 1, 2, 2, 2)
N1 &lt;- rep(148, 9)
N2 &lt;- rep(132, 9)
Y1 &lt;- N1 - X1
Y2 &lt;- N2 - X2
df &lt;- data.frame(X1, Y1, X2, Y2)
df

# Computation of p-values and their supports with Fisher's exact test
library(DiscreteTests)  # for Fisher's exact test
test_results &lt;- fisher_test_pv(df)
raw_pvalues &lt;- test_results$get_pvalues()
pCDFlist &lt;- test_results$get_pvalue_supports()

DBonf_fast &lt;- DBonferroni(raw_pvalues, pCDFlist)
DBonf_crit &lt;- DBonferroni(test_results, critical_values = TRUE)
DHolm_fast &lt;- DHolm(test_results)
DHolm_crit &lt;- DHolm(raw_pvalues, pCDFlist, critical_values = TRUE)

plot(DBonf_fast)
plot(DBonf_crit, xlim = c(1, 5), ylim = c(0, 0.4))
plot(DHolm_fast, col = c(2, 4), pch = c(2, 3), lwd = c(2, 2), 
     legend = "topleft", xlim = c(1, 5), ylim = c(0, 0.4))
plot(DHolm_crit, col = c(2, 4, 1), pch = c(1, 1, 4), lwd = c(1, 1, 2), 
     type_crit = 'o', legend = c(1, 0.4), lty = 1, xlim = c(1, 5), 
     ylim = c(0, 0.4))

</code></pre>

<hr>
<h2 id='print.DiscreteFWER'>Printing discrete FWER results</h2><span id='topic+print.DiscreteFWER'></span>

<h3>Description</h3>

<p>Prints the results of discrete FWER analysis, stored in a <code>DiscreteFWER</code>
S3 class object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'DiscreteFWER'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.DiscreteFWER_+3A_x">x</code></td>
<td>
<p>object of class <code>DiscreteFWER</code>.</p>
</td></tr>
<tr><td><code id="print.DiscreteFWER_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from other methods. They
are ignored in this function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The respective input object is invisibly returned via <code>invisible(x)</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X1 &lt;- c(4, 2, 2, 14, 6, 9, 4, 0, 1)
X2 &lt;- c(0, 0, 1, 3, 2, 1, 2, 2, 2)
N1 &lt;- rep(148, 9)
N2 &lt;- rep(132, 9)
Y1 &lt;- N1 - X1
Y2 &lt;- N2 - X2
df &lt;- data.frame(X1, Y1, X2, Y2)
df

# Computation of p-values and their supports with Fisher's exact test
library(DiscreteTests)  # for Fisher's exact test
test_results &lt;- fisher_test_pv(df)
raw_pvalues &lt;- test_results$get_pvalues()
pCDFlist &lt;- test_results$get_pvalue_supports()

# d-Holm with critical values; using test results object
DHolm_crit &lt;- DHolm(test_results, critical.values = TRUE)
# print results
print(DHolm_crit)

</code></pre>

<hr>
<h2 id='summary.DiscreteFWER'>Summarizing Discrete FWER Results</h2><span id='topic+summary.DiscreteFWER'></span><span id='topic+print.summary.DiscreteFWER'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>DiscreteFWER</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'DiscreteFWER'
summary(object, ...)

## S3 method for class 'summary.DiscreteFWER'
print(x, max = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.DiscreteFWER_+3A_object">object</code></td>
<td>
<p>an object of class <code>DiscreteFWER</code>.</p>
</td></tr>
<tr><td><code id="summary.DiscreteFWER_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="summary.DiscreteFWER_+3A_x">x</code></td>
<td>
<p>an object of class <code>summary.DiscreteFWER</code>.</p>
</td></tr>
<tr><td><code id="summary.DiscreteFWER_+3A_max">max</code></td>
<td>
<p>numeric or <code>NULL</code>, specifying the maximal number of
<em>rows</em> of the p-value table to be printed. By default,
when <code>NULL</code>, <code>getOption("max.print")</code> is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>summary.DiscreteFWER</code> objects contain all data of an <code>DiscreteFWER</code> object,
but also include an additional table which includes the raw p-values,
their indices, the respective critical values (if present), the adjusted
p-values (if present) and a logical column to indicate rejection. The table
is sorted in ascending order by the raw p-values.
</p>
<p><code>print.summary.DiscreteFWER</code> simply prints the same output as
<code>print.DiscreteFWER</code>, but also prints the p-value table.
</p>


<h3>Value</h3>

<p><code>summary.DiscreteFWER</code> computes and returns a list that includes all the
data of an input <code>DiscreteFWER</code> object, plus
</p>
<table role = "presentation">
<tr><td><code>Table</code></td>
<td>
<p><code>data.frame</code>, sorted by the raw p-values, that contains the
indices, the raw p-values themselves, their respective critical
values (if present), their adjusted p-values (if present) and a
logical column to indicate rejection.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>X1 &lt;- c(4, 2, 2, 14, 6, 9, 4, 0, 1)
X2 &lt;- c(0, 0, 1, 3, 2, 1, 2, 2, 2)
N1 &lt;- rep(148, 9)
N2 &lt;- rep(132, 9)
Y1 &lt;- N1 - X1
Y2 &lt;- N2 - X2
df &lt;- data.frame(X1, Y1, X2, Y2)
df

# Computation of p-values and their supports with Fisher's exact test
library(DiscreteTests)  # for Fisher's exact test
test_results &lt;- fisher_test_pv(df)
raw_pvalues &lt;- test_results$get_pvalues()
pCDFlist &lt;- test_results$get_pvalue_supports()

# d-Holm procedure without critical values; using test results object
DFWER_dep_sd_fast &lt;- discrete_FWER(test_results)
summary(DFWER_dep_sd_fast)

# d-Bonferroni procedure with critical values; using test results object
DFWER_dep_crit &lt;- discrete_FWER(test_results, single_step = TRUE,
critical_values = TRUE)
summary(DFWER_dep_crit)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
