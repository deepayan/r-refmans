<!DOCTYPE html><html lang="en"><head><title>Help for package saery</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {saery}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#saery-package'>
<p>Small Area Estimation for Rao and Yu model</p></a></li>
<li><a href='#datos'>
<p>Dataset for saery package</p></a></li>
<li><a href='#eblup.saery'>
<p>The function <code>eblup.saery</code> calculate the eblup and mse for a model.</p></a></li>
<li><a href='#fit.saery'>
<p>The function <code>fit.saery</code> is used to fit the correct model for three options.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Small Area Estimation for Rao and Yu Model</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Perez Agustin &lt;agustin.perez@umh.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to calculate EBLUPs (Empirical Best Linear Unbiased Predictor) estimators and their MSEs (Mean Squared Errors). Estimators are based on an area-level linear mixed model introduced by Rao and Yu (1994) &lt;<a href="https://doi.org/10.2307%2F3315407">doi:10.2307/3315407</a>&gt;. The REML (Residual Maximum Likelihood) method is used for fitting the model.</td>
</tr>
<tr>
<td>Imports:</td>
<td>grDevices, graphics, stats, utils</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Author:</td>
<td>Cabello E. [aut],
  Esteban M.D. [aut],
  Morales Domingo [aut],
  Perez Agustin [aut, cre]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-06 19:01:57 UTC; estebancabello</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-07 09:50:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='saery-package'>
Small Area Estimation for Rao and Yu model
</h2><span id='topic+saery-package'></span><span id='topic+saery'></span>

<h3>Description</h3>

<p>A complete set of functions to calculate several eblups estimators and its mean square errors. All estimators are based in area-level linear mixed model introduced by Rao and Yu in 1994 (see documentation). Saery package are developed to fit the model with REML method.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> saery</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2025-02-06</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The main functions of the saery package are <code>fit.saery</code> and <code>eblup.saery</code>.
The function <code>fit.saery</code> is used to fit the correct model for three options. <code>eblup.saery</code> calculates the eblup and mse for the model.
</p>


<h3>Author(s)</h3>

<p>Esteban Cabello Garcia, Maria Dolores Esteban Lefler, Domingo Morales Gonzalez, Agustin Perez Martin
</p>
<p>Maintainer: Perez Agustin &lt;agustin.perez@umh.es&gt;
</p>


<h3>References</h3>

<p>Rao, J.N.K., Yu, M., 1994. Small area estimation by combining time series and cross sectional data. Canadian Journal of Statistics 22, 511-528.
</p>
<p>Esteban, M.D., Morales, D., Perez, A., Santamaria, L., 2012. Small area estimation of poverty proportions under area-level time models. Computational Statistics and Data Analysis, 56 (10), pp. 2840-2855.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sigma2edi &lt;- datos[,6]
X &lt;- as.matrix(datos[,5])
ydi &lt;- datos[,3]
D &lt;- length(unique(datos[,1]))
md &lt;- rep(length(unique(datos[,2])), D)

output.fit.ar1 &lt;- fit.saery(X, ydi, D, md, sigma2edi, "AR", 0.9)
output.fit.ar1

#For computational reasons B is too low. We recomend to increase up to 100
eblup.output.ar1 &lt;- eblup.saery(X, ydi, D, md, sigma2edi, "a", plot = TRUE, B = 2)
eblup.output.ar1
</code></pre>

<hr>
<h2 id='datos'>
Dataset for saery package
</h2><span id='topic+datos'></span>

<h3>Description</h3>

<p>A simulated dataset created by the authors in order to check the correct operation of the saery package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(datos)</code></pre>


<h3>Format</h3>

<p>A simulated data frame with 2000 observations on the following 6 variables.
</p>

<dl>
<dt><code>Area</code></dt><dd><p>a numeric vector with the area (domain) of the data</p>
</dd>
<dt><code>Period</code></dt><dd><p>a numeric vector with the period (subdomain) of the data</p>
</dd>
<dt><code>ydi</code></dt><dd><p>a numeric vector with the direct estimator of the indicator of interest for area (domain)</p>
</dd>
<dt><code>ones</code></dt><dd><p>a numeric vector. This is only needed to include the intercept parameter in the model</p>
</dd>
<dt><code>xdi</code></dt><dd><p>a numeric vector containing the aggregated (population) values of an auxiliary variable</p>
</dd>
<dt><code>sigma2edi</code></dt><dd><p>a numeric vector with the known variance of the error term</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
sigma2edi &lt;- datos[,6]
X &lt;- as.matrix(datos[,5])
ydi &lt;- datos[,3]
D &lt;- length(unique(datos[,1]))
md &lt;- rep(length(unique(datos[,2])), D)

output.fit.ar1 &lt;- fit.saery(X, ydi, D, md, sigma2edi, "AR", 0.9)
output.fit.ar1

#For computational reasons B is too low. We recomend to increase up to 100
eblup.output.ar1 &lt;- eblup.saery(X, ydi, D, md, sigma2edi, "a", plot = TRUE, B = 2)
eblup.output.ar1
</code></pre>

<hr>
<h2 id='eblup.saery'>
The function <code>eblup.saery</code> calculate the eblup and mse for a model.
</h2><span id='topic+eblup.saery'></span><span id='topic+eblup.saery.AR1'></span><span id='topic+eblup.saery.MA1'></span><span id='topic+eblup.saery.indep'></span>

<h3>Description</h3>

<p>The function <code>eblup.saery</code> calculate the eblup and mse for a model. Is recomended that the model was previusly checked by <code><a href="#topic+fit.saery">fit.saery</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eblup.saery(X, ydi, D, md, sigma2edi,
      model = c("INDEP", "AR1", "MA1"),
      plot = FALSE, type = "I", B = 100)
eblup.saery.AR1(X, ydi, D, md, sigma2edi, plot, type, B)
eblup.saery.MA1(X, ydi, D, md, sigma2edi, plot, type, B)
eblup.saery.indep(X, ydi, D, md, sigma2edi, plot)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eblup.saery_+3A_x">X</code></td>
<td>

<p>a numeric vector or data frame containing the aggregated (population) values of p auxiliary variables. A ones columns must be agregated to calculate the intercept parameter
</p>
</td></tr>
<tr><td><code id="eblup.saery_+3A_ydi">ydi</code></td>
<td>

<p>a numeric vector with the direct estimator of the indicator of interest for area (domain)
</p>
</td></tr>
<tr><td><code id="eblup.saery_+3A_d">D</code></td>
<td>

<p>a numeric vector with the number of areas (domain) of the data
</p>
</td></tr>
<tr><td><code id="eblup.saery_+3A_md">md</code></td>
<td>

<p>a numeric vector with the number of periods (subdomains) for each area of the data
</p>
</td></tr>
<tr><td><code id="eblup.saery_+3A_sigma2edi">sigma2edi</code></td>
<td>

<p>a numeric vector with the known variance of the error term
</p>
</td></tr>
<tr><td><code id="eblup.saery_+3A_model">model</code></td>
<td>

<p>Three diferents types of model must be fit. For an indepent model <code>INDEP</code> or an abbreviated version of it must be typed. An AR1 model can be fit using <code>AR1</code> or an abbreviated version. For MA1 model, use <code>MA1</code> or an abbreviated version. This function and <code><a href="#topic+fit.saery">fit.saery</a></code> use the REML method to fit the model. 
</p>
</td></tr>
<tr><td><code id="eblup.saery_+3A_plot">plot</code></td>
<td>

<p>logical specifying if a set of plot be returned. <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="eblup.saery_+3A_type">type</code></td>
<td>

<p>three types of mse can be calculated for <code>AR1</code> and <code>MA1</code> models. One of the with an explicit and direct function, and the orther two by a bootstrap procedure that takes more time to the system to calculate them. For the <code>indep</code> model, only the an explicit function are developed <code>type = "I"</code>
</p>
</td></tr>
<tr><td><code id="eblup.saery_+3A_b">B</code></td>
<td>

<p>the number of bootstrap samples to be generated and fitted for types <code>"I"</code> and <code>"II"</code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the eblups and its mse be returned. A set of plots be displayed if <code>plot = TRUE</code>
</p>


<h3>Author(s)</h3>

<p>Maria Dolores Esteban Lefler, Domingo Morales Gonzalez, Agustin Perez Martin
</p>


<h3>References</h3>

<p>Rao, J.N.K., Yu, M., 1994. Small area estimation by combining time series and cross sectional data. Canadian Journal of Statistics 22, 511-528.
</p>
<p>Esteban, M.D., Morales, D., Perez, A., Santamaria, L., 2012. Small area estimation of poverty proportions under area-level time models. Computational Statistics and Data Analysis, 56 (10), pp. 2840-2855.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit.saery">fit.saery</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sigma2edi &lt;- datos[,6]
X &lt;- as.matrix(datos[,5])
ydi &lt;- datos[,3]
D &lt;- length(unique(datos[,1]))
md &lt;- rep(length(unique(datos[,2])), D)

#For computational reasons B is too low. We recomend to increase up to 100
eblup.output.ar1 &lt;- eblup.saery(X, ydi, D, md, sigma2edi, model = "a", plot = TRUE, B = 2)
eblup.output.ar1

#For computational reasons B is too low. We recomend to increase up to 100
eblup.output.ma1 &lt;- eblup.saery(X, ydi, D, md, sigma2edi,
                    model = "ma", plot = FALSE, type = "II", B = 2)
eblup.output.ma1

eblup.output.indep &lt;- eblup.saery(X, ydi, D, md, sigma2edi,
                      model = "i", plot = TRUE)
eblup.output.indep
</code></pre>

<hr>
<h2 id='fit.saery'>
The function <code>fit.saery</code> is used to fit the correct model for three options.
</h2><span id='topic+fit.saery'></span><span id='topic+fit.saery.AR1'></span><span id='topic+fit.saery.MA1'></span><span id='topic+fit.saery.indep'></span>

<h3>Description</h3>

<p>The function <code>fit.saery</code> fits the model for three options. This function and <code><a href="#topic+eblup.saery">eblup.saery</a></code> use the REML method to fit the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.saery(X, ydi, D, md, sigma2edi,
      model = c("INDEP", "AR1", "MA1"),
      conf.level = 0.95)
fit.saery.AR1(X, ydi, D, md, sigma2edi, conf.level)
fit.saery.MA1(X, ydi, D, md, sigma2edi, conf.level)
fit.saery.indep(X, ydi, D, md, sigma2edi, conf.level)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit.saery_+3A_x">X</code></td>
<td>

<p>a numeric vector or data frame containing the aggregated (population) values of p auxiliary variables. A ones columns must be agregated to calculate the intercept parameter
</p>
</td></tr>
<tr><td><code id="fit.saery_+3A_ydi">ydi</code></td>
<td>

<p>a numeric vector with the direct estimator of the indicator of interest for area (domain)
</p>
</td></tr>
<tr><td><code id="fit.saery_+3A_d">D</code></td>
<td>

<p>a numeric vector with the number of areas (domain) of the data
</p>
</td></tr>
<tr><td><code id="fit.saery_+3A_md">md</code></td>
<td>

<p>a numeric vector with the number of periods (subdomains) for each area of the data
</p>
</td></tr>
<tr><td><code id="fit.saery_+3A_sigma2edi">sigma2edi</code></td>
<td>

<p>a numeric vector with the known variance of the error term
</p>
</td></tr>
<tr><td><code id="fit.saery_+3A_model">model</code></td>
<td>

<p>Three diferents types of model must be fit. For an indepent model <code>INDEP</code> or an abbreviated version of it must be typed. An AR1 model can be fit using <code>AR1</code> or an abbreviated version. For MA1 model, use <code>MA1</code> or an abbreviated version. This function and <code><a href="#topic+fit.saery">fit.saery</a></code> use the REML method to fit the model. 
</p>
</td></tr>
<tr><td><code id="fit.saery_+3A_conf.level">conf.level</code></td>
<td>

<p>a value under 1 for the confidence level for the confidence intervals returned by the function
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the fitted parameters of the model are returned. Caonfidence intervals, p-values, the Fisher Scoring matrix and the number of iterations of the model are also returned.
</p>


<h3>Author(s)</h3>

<p>Maria Dolores Esteban Lefler, Domingo Morales Gonzalez, Agustin Perez Martin
</p>


<h3>References</h3>

<p>Rao, J.N.K., Yu, M., 1994. Small area estimation by combining time series and cross sectional data. Canadian Journal of Statistics 22, 511-528.
</p>
<p>Esteban, M.D., Morales, D., Perez, A., Santamaria, L., 2012. Small area estimation of poverty proportions under area-level time models. Computational Statistics and Data Analysis, 56 (10), pp. 2840-2855.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eblup.saery">eblup.saery</a></code>, ~~~
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sigma2edi &lt;- datos[,6]
X &lt;- as.matrix(datos[,5])
ydi &lt;- datos[,3]
D &lt;- length(unique(datos[,1]))
md &lt;- rep(length(unique(datos[,2])), D)

output.fit.ar1 &lt;- fit.saery(X, ydi, D, md, sigma2edi, "AR", 0.9)
output.fit.ar1

output.fit.ma1 &lt;- fit.saery(X, ydi, D, md, sigma2edi, "MA", 0.9)
output.fit.ma1

output.fit.indep &lt;- fit.saery(X, ydi, D, md, sigma2edi, "indep", 0.9)
output.fit.indep
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
