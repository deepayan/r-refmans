<!DOCTYPE html><html lang="en-US"><head><title>Help for package bdsm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bdsm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#best_models'><p>Table with the best models according to one of the posterior criteria</p></a></li>
<li><a href='#bma'><p>Calculation of the bma object</p></a></li>
<li><a href='#bma_summary'><p>Summary of a model space</p></a></li>
<li><a href='#coef_hist'><p>Graphs of the distribution of the coefficients over the model space</p></a></li>
<li><a href='#data_prep'><p>Perform standardization of variables and prepears fixed effects estiamtion</p></a></li>
<li><a href='#economic_growth'><p>Economic Growth Data</p></a></li>
<li><a href='#economic_growth_bma_params'><p>Example Approximate Summary of Parameters of Interest Based on Model Space</p></a></li>
<li><a href='#economic_growth_liks'><p>Example Approximate Likelihoods Summary based on Model Space</p></a></li>
<li><a href='#economic_growth_ms'><p>Example Model Space</p></a></li>
<li><a href='#economic_growth_ms_full_proj_const'><p>Full Model Space with Constant Projection Matrix</p></a></li>
<li><a href='#economic_growth_ms_full_proj_var'><p>Full Model Space with Varying Projection Matrix</p></a></li>
<li><a href='#exogenous_matrix'><p>Matrix with exogenous variables for SEM representation</p></a></li>
<li><a href='#feature_standardization'><p>Perform feature standarization</p></a></li>
<li><a href='#hessian'><p>Hessian matrix</p></a></li>
<li><a href='#initialize_model_space'><p>Initialize model space matrix</p></a></li>
<li><a href='#join_lagged_col'><p>Dataframe with no lagged column</p></a></li>
<li><a href='#jointness'><p>Calculation of of the jointness measures</p></a></li>
<li><a href='#likelihoods_summary'><p>Approximate standard deviations for the models</p></a></li>
<li><a href='#matrices_from_df'><p>List of matrices for SEM model</p></a></li>
<li><a href='#model_pmp'><p>Graphs of the prior and posterior model probabilities for the best individual models</p></a></li>
<li><a href='#model_sizes'><p>Graphs of the prior and posterior model probabilities of the model sizes</p></a></li>
<li><a href='#optimal_model_space'><p>Finds MLE parameters for each model in the given model space</p></a></li>
<li><a href='#parameters_summary'><p>BMA summary for parameters of interest</p></a></li>
<li><a href='#regressor_names_from_params_vector'><p>Helper function to extract names from a vector defining a model</p></a></li>
<li><a href='#residual_maker_matrix'><p>Residual Maker Matrix</p></a></li>
<li><a href='#SEM_B_matrix'><p>Coefficients matrix for SEM representation</p></a></li>
<li><a href='#SEM_C_matrix'><p>Coefficients matrix for initial conditions</p></a></li>
<li><a href='#SEM_dep_var_matrix'><p>Matrix with dependent variable data for SEM representation</p></a></li>
<li><a href='#SEM_likelihood'><p>Likelihood for the SEM model</p></a></li>
<li><a href='#SEM_psi_matrix'><p>Matrix with psi parameters for SEM representation</p></a></li>
<li><a href='#SEM_regressors_matrix'><p>Matrix with regressors data for SEM representation</p></a></li>
<li><a href='#SEM_sigma_matrix'><p>Covariance matrix for SEM representation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Bayesian Dynamic Systems Modeling</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements methods for building and analyzing models based on panel
    data as described in the paper by 
    Moral-Benito (2013, &lt;<a href="https://doi.org/10.1080%2F07350015.2013.818003">doi:10.1080/07350015.2013.818003</a>&gt;).
    The package provides functions to estimate dynamic panel data models
    and analyze the results of the estimation.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>spelling, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, ggpubr, grid, gridExtra, knitr, magrittr,
optimbase, parallel, rje, rlang, rootSolve, stats, tidyr,
tidyselect</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-16 21:34:16 UTC; marcindubel</td>
</tr>
<tr>
<td>Author:</td>
<td>Mateusz Wyszynski [aut],
  Marcin Dubel [ctb, cre],
  Krzysztof Beck [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marcin Dubel &lt;marcindubel@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-17 07:30:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='best_models'>Table with the best models according to one of the posterior criteria</h2><span id='topic+best_models'></span>

<h3>Description</h3>

<p>This function creates a ranking of best models according to one of the possible criterion (PMP under binomial model prior, PMP under binomial-beta model prior, R^2 under binomial model prior, R^2 under binomial-beta model prior).
The function gives two types of tables in three different formats: inclusion table (where 1 indicates presence of the regressor in the model and 0 indicates that the variable is excluded from the model) and estimation results table (it displays the best models and estimation output for those models: point estimates, standard errors, significance level, and R^2).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>best_models(
  bma_list,
  criterion = 1,
  best = 5,
  app = 3,
  estimate = TRUE,
  robust = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="best_models_+3A_bma_list">bma_list</code></td>
<td>
<p>bma object (the result of the bma function)</p>
</td></tr>
<tr><td><code id="best_models_+3A_criterion">criterion</code></td>
<td>
<p>The criterion that will be used for a basis of the model ranking: <br />
1 - binomial model prior <br />
2 - binomial-beta model prior</p>
</td></tr>
<tr><td><code id="best_models_+3A_best">best</code></td>
<td>
<p>The number of the best models to be considered</p>
</td></tr>
<tr><td><code id="best_models_+3A_app">app</code></td>
<td>
<p>Parameter indicating the decimal place to which number in the tables should be rounded (default app = 3)</p>
</td></tr>
<tr><td><code id="best_models_+3A_estimate">estimate</code></td>
<td>
<p>A parameter with values TRUE or FALSE indicating which table should be displayed when
the function finishes calculations. Works well when best is small.<br />
TRUE - table with estimation to the results <br />
FALSE - table with the inclusion of regressors in the best models</p>
</td></tr>
<tr><td><code id="best_models_+3A_robust">robust</code></td>
<td>
<p>A parameter with values TRUE or FALSE indicating which type of stanrdard errors should be displayed
when the function finishes calculations. Works only if estimate = TRUE. Works well when best is small.<br />
TRUE - robust standard errors <br />
FALSE - regular standard errors</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with best_models objects: <br />
</p>

<ol>
<li><p> matrix with inclusion of the regressors in the best models <br />
</p>
</li>
<li><p> matrix with estimation output in the best models with regular standard errors <br />
</p>
</li>
<li><p> matrix with estimation output in the best models with robust standard errors <br />
</p>
</li>
<li><p> knitr_kable table with inclusion of the regressors in the best models (the best for the display on the console - up to 11 models) <br />
</p>
</li>
<li><p> knitr_kable table with estimation output in the best models with regular standard errors (the best for the display on the console - up to 6 models) <br />
</p>
</li>
<li><p> knitr_kable table with estimation output in the best models with robust standard errors (the best for the display on the console - up to 6 models) <br />
</p>
</li>
<li><p> gTree table with inclusion of the regressors in the best models (displayed as a plot). Use grid::grid.draw() to display.<br />
</p>
</li>
<li><p> gTree table with estimation output in the best models with regular standard errors (displayed as a plot). Use grid::grid.draw() to display.
</p>
</li>
<li><p> gTree table with estimation output in the best models with robust standard errors (displayed as a plot). Use grid::grid.draw() to display.
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>
library(magrittr)

data_prepared &lt;- economic_growth[,1:7] %&gt;%
   feature_standardization(timestamp_col = year, entity_col = country) %&gt;%
   feature_standardization(timestamp_col = year, entity_col = country,
                           time_effects = TRUE, scale = FALSE)

model_space &lt;- optimal_model_space(df = data_prepared, dep_var_col = gdp,
                                   timestamp_col = year, entity_col = country,
                                   init_value = 0.5)

bma_results &lt;- bma(df = data_prepared, dep_var_col = gdp, timestamp_col = year,
entity_col = country, model_space = model_space, run_parallel = FALSE, dilution = 0)

best_5_models &lt;- best_models(bma_results, criterion = 1, best = 5, estimate = TRUE, robust = TRUE)

</code></pre>

<hr>
<h2 id='bma'>Calculation of the bma object</h2><span id='topic+bma'></span>

<h3>Description</h3>

<p>This function calculates bma object for the model_space object obtained using optimal_model_space function.
It calculates BMA statistics and objects for the use by other functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bma(
  df,
  dep_var_col,
  timestamp_col,
  entity_col,
  model_space,
  run_parallel = FALSE,
  app = 4,
  EMS = NULL,
  dilution = 0,
  dil.Par = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bma_+3A_df">df</code></td>
<td>
<p>Data frame with data for the SEM analysis.</p>
</td></tr>
<tr><td><code id="bma_+3A_dep_var_col">dep_var_col</code></td>
<td>
<p>Column with the dependent variable</p>
</td></tr>
<tr><td><code id="bma_+3A_timestamp_col">timestamp_col</code></td>
<td>
<p>The name of the column with timestamps</p>
</td></tr>
<tr><td><code id="bma_+3A_entity_col">entity_col</code></td>
<td>
<p>Column with entities (e.g. countries)</p>
</td></tr>
<tr><td><code id="bma_+3A_model_space">model_space</code></td>
<td>
<p>The result of the optimal_model_space function. A matrix (with named rows)
with each column corresponding to a model. Each column specifies model parameters. Compare with <a href="#topic+optimal_model_space">optimal_model_space</a></p>
</td></tr>
<tr><td><code id="bma_+3A_run_parallel">run_parallel</code></td>
<td>
<p>If <code>TRUE</code> the optimization is run in parallel using
the <a href="parallel.html#topic+parApply">parApply</a> function. If <code>FALSE</code> (default value) the
base apply function is used. Note that using the parallel computing requires
setting the default cluster. See README.</p>
</td></tr>
<tr><td><code id="bma_+3A_app">app</code></td>
<td>
<p>Parameter indicating the decimal place to which number in the BMA tables should be rounded (default app = 4)</p>
</td></tr>
<tr><td><code id="bma_+3A_ems">EMS</code></td>
<td>
<p>Expected model size for model binomial and binomial-beta model prior</p>
</td></tr>
<tr><td><code id="bma_+3A_dilution">dilution</code></td>
<td>
<p>Binary parameter: 0 - NO application of a dilution prior; 1 - application of a dilution prior (George 2010).</p>
</td></tr>
<tr><td><code id="bma_+3A_dil.par">dil.Par</code></td>
<td>
<p>Parameter associated with dilution prior - the exponent of the determinant (George 2010). Used only if parameter dilution = 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with bma objects: <br />
</p>

<ol>
<li><p> uniform_table - table with the results under binomial model prior <br />
</p>
</li>
<li><p> random_table - table with the results under binomial-beta model prior <br />
</p>
</li>
<li><p> reg_names - vector with names of the regressors - to be used by the functions <br />
</p>
</li>
<li><p> R - total number of regressors <br />
</p>
</li>
<li><p> M - size of the mode space <br />
</p>
</li>
<li><p> forJointnes - table with model IDs and PMPs for jointness function <br />
</p>
</li>
<li><p> forBestModels - table with model IDs, PMPs, coefficients, stds, and, stdRs for best_models function <br />
</p>
</li>
<li><p> EMS - expected model size for binomial and binomial-beta model prior specified by the user (default EMS = R/2) <br />
</p>
</li>
<li><p> sizePriors - table with uniform and random model priors spread over model sizes for model_sizes function <br />
</p>
</li>
<li><p> PMPs - table with posterior model probabilities for model_sizes function <br />
</p>
</li>
<li><p> modelPriors - table with priors on models for model_pmp function <br />
</p>
</li>
<li><p> dilution - parameter indication if priors were diluted for model_sizes function <br />
</p>
</li>
<li><p> alphas - coefficients on lagged dependent variable for coef_hist function<br />
</p>
</li>
<li><p> betas_nonzero - nonzero coefficients on the regressors for coef_hist function <br />
</p>
</li>
<li><p> d_free - table with degrees of freedom of estimated models for best_models function <br />
</p>
</li>
<li><p> PMStable - table with prior and posterior expected model size for binomial and binomial-beta model prior
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>
library(magrittr)

data_prepared &lt;- economic_growth[,1:7] %&gt;%
   feature_standardization(timestamp_col = year, entity_col = country) %&gt;%
   feature_standardization(timestamp_col = year, entity_col = country,
                           time_effects = TRUE, scale = FALSE)

model_space &lt;- optimal_model_space(df = data_prepared, dep_var_col = gdp,
                                   timestamp_col = year, entity_col = country,
                                   init_value = 0.5)

bma_results &lt;- bma(df = data_prepared, dep_var_col = gdp, timestamp_col = year,
entity_col = country, model_space = model_space, run_parallel = FALSE, dilution = 0)

</code></pre>

<hr>
<h2 id='bma_summary'>Summary of a model space</h2><span id='topic+bma_summary'></span>

<h3>Description</h3>

<p>A summary of a given model space is prepared. This include things such as
posterior inclusion probability (PIP), posterior mean and so on. This is the
core function of the package, because it allows to make assessments and
decisions about the parameters and models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bma_summary(
  df,
  dep_var_col,
  timestamp_col,
  entity_col,
  model_space,
  exact_value = TRUE,
  model_prior = "uniform",
  run_parallel = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bma_summary_+3A_df">df</code></td>
<td>
<p>Data frame with data for the SEM analysis.</p>
</td></tr>
<tr><td><code id="bma_summary_+3A_dep_var_col">dep_var_col</code></td>
<td>
<p>Column with the dependent variable</p>
</td></tr>
<tr><td><code id="bma_summary_+3A_timestamp_col">timestamp_col</code></td>
<td>
<p>The name of the column with timestamps</p>
</td></tr>
<tr><td><code id="bma_summary_+3A_entity_col">entity_col</code></td>
<td>
<p>Column with entities (e.g. countries)</p>
</td></tr>
<tr><td><code id="bma_summary_+3A_model_space">model_space</code></td>
<td>
<p>A matrix (with named rows) with each column corresponding
to a model. Each column specifies model parameters. Compare with
<a href="#topic+optimal_model_space">optimal_model_space</a></p>
</td></tr>
<tr><td><code id="bma_summary_+3A_exact_value">exact_value</code></td>
<td>
<p>Whether the exact value of the likelihood should be
computed (<code>TRUE</code>) or just the proportional part (<code>FALSE</code>). Check
<a href="#topic+SEM_likelihood">SEM_likelihood</a> for details.</p>
</td></tr>
<tr><td><code id="bma_summary_+3A_model_prior">model_prior</code></td>
<td>
<p>Which model prior to use. For now there are two options:
<code>'uniform'</code> and <code>'binomial-beta'</code>. Default is <code>'uniform'</code>.</p>
</td></tr>
<tr><td><code id="bma_summary_+3A_run_parallel">run_parallel</code></td>
<td>
<p>If <code>TRUE</code> the optimization is run in parallel using
the <a href="parallel.html#topic+parApply">parApply</a> function. If <code>FALSE</code> (default value) the
base apply function is used. Note that using the parallel computing requires
setting the default cluster. See README.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of parameters describing analyzed models
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(magrittr)

data_prepared &lt;- economic_growth[,1:7] %&gt;%
   feature_standardization(timestamp_col = year, entity_col = country) %&gt;%
   feature_standardization(timestamp_col = year, entity_col = country,
                           time_effects = TRUE, scale = FALSE)


bma_result &lt;- bma_summary(df = data_prepared, dep_var_col = gdp,
                          timestamp_col = year, entity_col = country,
                          model_space = economic_growth_ms)


</code></pre>

<hr>
<h2 id='coef_hist'>Graphs of the distribution of the coefficients over the model space</h2><span id='topic+coef_hist'></span>

<h3>Description</h3>

<p>This function draws graphs of the distribution (in the form of histogram or kernel density) of the coefficients for all the considered regressors over the part of the model space that includes this regressors (half of the model space).
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef_hist_+3A_bma_list">bma_list</code></td>
<td>
<p>bma object (the result of the bma function)</p>
</td></tr>
<tr><td><code id="coef_hist_+3A_bw">BW</code></td>
<td>
<p>Parameter indicating what method should be chosen to find bin widths for the histograms: <br />
</p>

<ol>
<li><p> &quot;FD&quot; Freedman-Diaconis method <br />
</p>
</li>
<li><p> &quot;SC&quot; Scott method <br />
</p>
</li>
<li><p> &quot;vec&quot; user specified bin widths provided through a vector (parameter: binW)
</p>
</li></ol>
</td></tr>
<tr><td><code id="coef_hist_+3A_binw">binW</code></td>
<td>
<p>A vector with bin widths to be used to construct histograms for the regressors. The vector must be of the size equal to total number of regressors. The vector with bin widths is used only if parameter BW=&quot;vec&quot;.</p>
</td></tr>
<tr><td><code id="coef_hist_+3A_bn">BN</code></td>
<td>
<p>Parameter taking the values (default: BN = 0): <br />
1 - the histogram will be build based on the number of bins specified by the user through parameter num. If BN=1, the function ignores parameters BW. <br />
0 - the histogram will be build in line with parameter BW</p>
</td></tr>
<tr><td><code id="coef_hist_+3A_num">num</code></td>
<td>
<p>A vector with the numbers of bins used to be used to construct histograms for the regressors. The vector must be of the size equal to total number of regressors. The vector with bin widths is used only if parameter BN=1.</p>
</td></tr>
<tr><td><code id="coef_hist_+3A_kernel">kernel</code></td>
<td>
<p>A parameter taking the values (default: kernel = 0):<br />
1 - the function will build graphs using kernel density for the distribution of coefficients (with kernel=1, the function ignores parameters BW and BN) <br />
0 - the function will build regular histogram density for the distribution of coefficients</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the graphs of the distribution of coefficients for all the considered regressors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(magrittr)

data_prepared &lt;- economic_growth[,1:7] %&gt;%
   feature_standardization(timestamp_col = year, entity_col = country) %&gt;%
   feature_standardization(timestamp_col = year, entity_col = country,
                           time_effects = TRUE, scale = FALSE)

model_space &lt;- optimal_model_space(df = data_prepared, dep_var_col = gdp,
                                   timestamp_col = year, entity_col = country,
                                   init_value = 0.5)

bma_results &lt;- bma(df = data_prepared, dep_var_col = gdp, timestamp_col = year,
entity_col = country, model_space = model_space, run_parallel = FALSE, dilution = 0)

coef_plots &lt;- coef_hist(bma_results, kernel = 1)

</code></pre>

<hr>
<h2 id='data_prep'>Perform standardization of variables and prepears fixed effects estiamtion</h2><span id='topic+data_prep'></span>

<h3>Description</h3>

<p>This function performs
<a href="https://en.wikipedia.org/wiki/Feature_scaling">feature standarization</a>
(also known as z-score normalization), i.e. the features are centered around
the mean and scaled with standard deviation. Additionally, it allows introduction
of cross sectional and time fixed effects through demeaning.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_prep(
  df,
  timestamp_col,
  entity_col,
  standardize = TRUE,
  entity_effects = FALSE,
  time_effects = FALSE,
  scale = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="data_prep_+3A_df">df</code></td>
<td>
<p>Dataframe with data that should be prepared for LIML estimation</p>
</td></tr>
<tr><td><code id="data_prep_+3A_timestamp_col">timestamp_col</code></td>
<td>
<p>Column with timestamps (e.g. years)</p>
</td></tr>
<tr><td><code id="data_prep_+3A_entity_col">entity_col</code></td>
<td>
<p>Column with entities (e.g. countries)</p>
</td></tr>
<tr><td><code id="data_prep_+3A_standardize">standardize</code></td>
<td>
<p>Whether to standardize the data (by mean subtraction)</p>
</td></tr>
<tr><td><code id="data_prep_+3A_entity_effects">entity_effects</code></td>
<td>
<p>Whether to introduce time cross-section effects
(by time demeaning)</p>
</td></tr>
<tr><td><code id="data_prep_+3A_time_effects">time_effects</code></td>
<td>
<p>Whether to introduce time fixed effects
(by cross-sectional demeaning)</p>
</td></tr>
<tr><td><code id="data_prep_+3A_scale">scale</code></td>
<td>
<p>Whether to divide by the standard deviation <code>TRUE</code> or not
<code>FALSE</code> during standardization. Default is <code>TRUE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with standardized variables or/and prepared for fixed effects
estimation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- data.frame(
  year = c(2000, 2001, 2002, 2003, 2004),
  country = c("A", "A", "B", "B", "C"),
  gdp = c(1, 2, 3, 4, 5),
  ish = c(2, 3, 4, 5, 6),
  sed = c(3, 4, 5, 6, 7)
)

data_prep(df, year, country, entity_effects = TRUE)

</code></pre>

<hr>
<h2 id='economic_growth'>Economic Growth Data</h2><span id='topic+economic_growth'></span>

<h3>Description</h3>

<p>Data used in Growth Empirics in Panel Data under Model Uncertainty and Weak
Exogeneity (Moral-Benito, 2016, Journal of Applied Econometrics).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>economic_growth
</code></pre>


<h3>Format</h3>



<h4><code>economic_growth</code></h4>

<p>A data frame with 365 rows and 12 columns:
</p>

<dl>
<dt>year</dt><dd><p>Year</p>
</dd>
<dt>country</dt><dd><p>Country ID</p>
</dd>
<dt>gdp</dt><dd><p>Logarithm of GDP per capita (2000 US dollars at PP)</p>
</dd>
<dt>ish</dt><dd><p>Ratio of real domestic investment to GDP</p>
</dd>
<dt>sed</dt><dd><p>Stock of years of secondary education in the total population</p>
</dd>
<dt>pgrw</dt><dd><p>Average growth rate of population</p>
</dd>
<dt>pop</dt><dd><p>Population in millions of people</p>
</dd>
<dt>ipr</dt><dd><p>Purchasing-power-parity numbers for investment goods</p>
</dd>
<dt>opem</dt><dd><p>Exports plus imports as a share of GDP</p>
</dd>
<dt>gsh</dt><dd><p>Ratio of government consumption to GDP</p>
</dd>
<dt>lnlex</dt><dd><p>Logarithm of the life expectancy at birth</p>
</dd>
<dt>polity</dt><dd><p>Composite index given by the democracy score minus the
autocracy score</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="http://qed.econ.queensu.ca/jae/datasets/moral-benito001/">http://qed.econ.queensu.ca/jae/datasets/moral-benito001/</a>
</p>

<hr>
<h2 id='economic_growth_bma_params'>Example Approximate Summary of Parameters of Interest Based on Model Space</h2><span id='topic+economic_growth_bma_params'></span>

<h3>Description</h3>

<p>A matrix representing the summary of parameters computed with
<code>parameters_summary</code> based on the <code>economic_growth_ms</code> model
space. TODO: describe the matrix properly after cleaning up the code of the
function <code>parameters_summary</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>economic_growth_bma_params
</code></pre>


<h3>Format</h3>



<h4><code>economic_growth_bma_params</code></h4>

<p>A double matrix with 5 rows and 8 columns
</p>


<hr>
<h2 id='economic_growth_liks'>Example Approximate Likelihoods Summary based on Model Space</h2><span id='topic+economic_growth_liks'></span>

<h3>Description</h3>

<p>A matrix representing the summary of likelihoods computed with
<code>likelihoods_summary</code> based on the <code>economic_growth_ms</code> model
space. The matrix contains likelihoods, standard deviations and robust
standard deviations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>economic_growth_liks
</code></pre>


<h3>Format</h3>



<h4><code>economic_growth_stds</code></h4>

<p>A double matrix with 11 rows and 16 columns.
</p>

<dl>
<dt>first row</dt><dd><p>Likelihoods for the models</p>
</dd>
<dt>second row</dt><dd><p>Almost 1/2 * BIC_k as in Raftery's Bayesian Model
Selection in Social Research eq. 19.</p>
</dd>
<dt>rows 3-7</dt><dd><p>Standard deviations</p>
</dd>
<dt>rows 8-12</dt><dd><p>Robust standard deviations</p>
</dd>
</dl>



<hr>
<h2 id='economic_growth_ms'>Example Model Space</h2><span id='topic+economic_growth_ms'></span>

<h3>Description</h3>

<p>A matrix representing the model space built using subset of regressors from
the <code>economic_growth</code> dataset. The included regressors are <code>ish</code>,
<code>sed</code>, <code>pgrw</code> and <code>pop</code>. Therefore the model space contains
<code>2^4 = 16</code> models (columns).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>economic_growth_ms
</code></pre>


<h3>Format</h3>



<h4><code>economic_growth_ms</code></h4>

<p>A double matrix with 51 rows and 16 columns.
</p>


<hr>
<h2 id='economic_growth_ms_full_proj_const'>Full Model Space with Constant Projection Matrix</h2><span id='topic+economic_growth_ms_full_proj_const'></span>

<h3>Description</h3>

<p>A matrix representing the model space built using all regressors from
the <code>economic_growth</code> dataset. Therefore the model space contains
<code>2^9 = 512</code> models (columns). The same projection matrix is used for
each model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>economic_growth_ms_full_proj_const
</code></pre>


<h3>Format</h3>



<h4><code>economic_growth_ms_full_proj_const</code></h4>

<p>A double matrix with 106 rows and 512 columns.
</p>



<h3>Details</h3>

<p>TODO: to avoid NaNs when computing estimates of standard deviations, the step
size in the hessian function has to be increased to 1e-2. This is most likely
cause by the fact that the likelihood values are much closer to each other
after the correction for the projection matrix is introduced. Hence we have
to either increase the relative tolerance of the optimization algorithm or
loosen the precision when computing approximate hessian.
</p>

<hr>
<h2 id='economic_growth_ms_full_proj_var'>Full Model Space with Varying Projection Matrix</h2><span id='topic+economic_growth_ms_full_proj_var'></span>

<h3>Description</h3>

<p>A matrix representing the model space built using all regressors from
the <code>economic_growth</code> dataset. Therefore the model space contains
<code>2^9 = 512</code> models (columns). This model space generates Posterior
Inclusion Probabilities which are consistent with the results presented by
Moral-Benito. The original results were approximated up to the 4th decimal
place. The results obtained using this model space lead to exactly the same
approximations. A different projection matrix is used for each model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>economic_growth_ms_full_proj_var
</code></pre>


<h3>Format</h3>



<h4><code>economic_growth_ms_full_proj_var</code></h4>

<p>A double matrix with 106 rows and 512 columns.
</p>


<hr>
<h2 id='exogenous_matrix'>Matrix with exogenous variables for SEM representation</h2><span id='topic+exogenous_matrix'></span>

<h3>Description</h3>

<p>Create matrix which contains exogenous variables used in the Simultaneous
Equations Model (SEM) representation. Currently these are: dependent variable
from the lowest time stamp and regressors from the second lowest time stamp.
The matrix is then used to compute likelihood for SEM analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exogenous_matrix(df, timestamp_col, entity_col, dep_var_col)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exogenous_matrix_+3A_df">df</code></td>
<td>
<p>Data frame with data for the SEM analysis.</p>
</td></tr>
<tr><td><code id="exogenous_matrix_+3A_timestamp_col">timestamp_col</code></td>
<td>
<p>Column which determines time periods. For now only
natural numbers can be used as timestamps</p>
</td></tr>
<tr><td><code id="exogenous_matrix_+3A_entity_col">entity_col</code></td>
<td>
<p>Column which determines entities (e.g. countries, people)</p>
</td></tr>
<tr><td><code id="exogenous_matrix_+3A_dep_var_col">dep_var_col</code></td>
<td>
<p>Column with dependent variable</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of size N x k+1 where N is the number of entities considered and k is
the number of chosen regressors
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
df &lt;- data.frame(
  entities = rep(1:4, 5),
  times = rep(seq(1960, 2000, 10), each = 4),
  dep_var = stats::rnorm(20), a = stats::rnorm(20), b = stats::rnorm(20)
)
exogenous_matrix(df, times, entities, dep_var)
</code></pre>

<hr>
<h2 id='feature_standardization'>Perform feature standarization</h2><span id='topic+feature_standardization'></span>

<h3>Description</h3>

<p>This function performs
<a href="https://en.wikipedia.org/wiki/Feature_scaling">feature standarization</a>
(also known as z-score normalization), i.e. the features are centered around
the mean and scaled with standard deviation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>feature_standardization(
  df,
  timestamp_col,
  entity_col,
  time_effects = FALSE,
  scale = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="feature_standardization_+3A_df">df</code></td>
<td>
<p>Dataframe with data that should be prepared for LIML estimation</p>
</td></tr>
<tr><td><code id="feature_standardization_+3A_timestamp_col">timestamp_col</code></td>
<td>
<p>Column with timestamps (e.g. years)</p>
</td></tr>
<tr><td><code id="feature_standardization_+3A_entity_col">entity_col</code></td>
<td>
<p>Column with entities (e.g. countries)</p>
</td></tr>
<tr><td><code id="feature_standardization_+3A_time_effects">time_effects</code></td>
<td>
<p>Whether to introduce time fixed effects
(by cross-sectional demeaning)</p>
</td></tr>
<tr><td><code id="feature_standardization_+3A_scale">scale</code></td>
<td>
<p>Whether to divide by the standard deviation <code>TRUE</code> or not
<code>FALSE</code>. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with standardized features
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- data.frame(
  year = c(2000, 2001, 2002, 2003, 2004),
  country = c("A", "A", "B", "B", "C"),
  gdp = c(1, 2, 3, 4, 5),
  ish = c(2, 3, 4, 5, 6),
  sed = c(3, 4, 5, 6, 7)
)

feature_standardization(df, year, country)

</code></pre>

<hr>
<h2 id='hessian'>Hessian matrix</h2><span id='topic+hessian'></span>

<h3>Description</h3>

<p>Creates the hessian matrix for a given likelihood function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hessian(lik, theta, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hessian_+3A_lik">lik</code></td>
<td>
<p>function</p>
</td></tr>
<tr><td><code id="hessian_+3A_theta">theta</code></td>
<td>
<p>kx1 matrix</p>
</td></tr>
<tr><td><code id="hessian_+3A_...">...</code></td>
<td>
<p>other parameters passed to <code>lik</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Hessian kxk matrix where k is the number of parameters
included in the theta matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lik &lt;- function(theta) {
 return(theta[1]^2 + theta[2]^2)
}

hessian(lik, c(1, 1))

</code></pre>

<hr>
<h2 id='initialize_model_space'>Initialize model space matrix</h2><span id='topic+initialize_model_space'></span>

<h3>Description</h3>

<p>This function builds a representation of the model space, by creating a
dataframe where each column represents values of the parameters for a given
model. Real value means that the parameter is included in the model. A
parameter not present in the model is marked as <code>NA</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initialize_model_space(
  df,
  timestamp_col,
  entity_col,
  dep_var_col,
  init_value = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="initialize_model_space_+3A_df">df</code></td>
<td>
<p>Data frame with data for the SEM analysis.</p>
</td></tr>
<tr><td><code id="initialize_model_space_+3A_timestamp_col">timestamp_col</code></td>
<td>
<p>Column which determines time periods. For now only
natural numbers can be used as timestamps</p>
</td></tr>
<tr><td><code id="initialize_model_space_+3A_entity_col">entity_col</code></td>
<td>
<p>Column which determines entities (e.g. countries, people)</p>
</td></tr>
<tr><td><code id="initialize_model_space_+3A_dep_var_col">dep_var_col</code></td>
<td>
<p>Column with dependent variable</p>
</td></tr>
<tr><td><code id="initialize_model_space_+3A_init_value">init_value</code></td>
<td>
<p>Initial value for parameters present in the model. Default
is <code>1</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently the set of features is assumed to be all columns which remain after
excluding <code>timestamp_col</code>, <code>entity_col</code> and <code>dep_var_col</code>.
</p>
<p>A power set of all possible exclusions of linear dependence on the given
feature is created, i.e. if there are 4 features we end up with 2^4 possible
models (for each model we independently decide whether to include or not a
feature).
</p>


<h3>Value</h3>

<p>matrix of model parameters
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(magrittr)

data_prepared &lt;- economic_growth[,1:7] %&gt;%
  feature_standardization(timestamp_col = year, entity_col = country) %&gt;%
  feature_standardization(timestamp_col = year, entity_col = country,
                        time_effects = TRUE, scale = FALSE)

initialize_model_space(data_prepared, year, country, gdp)
</code></pre>

<hr>
<h2 id='join_lagged_col'>Dataframe with no lagged column</h2><span id='topic+join_lagged_col'></span>

<h3>Description</h3>

<p>This function allows to turn data in the format with lagged values for a
chosen column (i.e. there are two columns with the same quantity, but one
column is lagged in time) into the format with just one column
</p>


<h3>Usage</h3>

<pre><code class='language-R'>join_lagged_col(
  df,
  col,
  col_lagged,
  timestamp_col,
  entity_col,
  timestep = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="join_lagged_col_+3A_df">df</code></td>
<td>
<p>Dataframe with data with a column with lagged values</p>
</td></tr>
<tr><td><code id="join_lagged_col_+3A_col">col</code></td>
<td>
<p>Column with quantity not lagged</p>
</td></tr>
<tr><td><code id="join_lagged_col_+3A_col_lagged">col_lagged</code></td>
<td>
<p>Column with the same quantity as <code>col</code>, but the values
are lagged in time</p>
</td></tr>
<tr><td><code id="join_lagged_col_+3A_timestamp_col">timestamp_col</code></td>
<td>
<p>Column with timestamps (e.g. years)</p>
</td></tr>
<tr><td><code id="join_lagged_col_+3A_entity_col">entity_col</code></td>
<td>
<p>Column with entities (e.g. countries)</p>
</td></tr>
<tr><td><code id="join_lagged_col_+3A_timestep">timestep</code></td>
<td>
<p>Difference between timestamps (e.g. 10)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with two columns merged, i.e. just one column with the desired
quantity is left.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- data.frame(
  year = c(2000, 2001, 2002, 2003, 2004),
  country = c("A", "A", "B", "B", "C"),
  gdp = c(1, 2, 3, 4, 5),
  gdp_lagged = c(NA, 1, 2, 3, 4)
)

join_lagged_col(df, gdp, gdp_lagged, year, country, 1)

</code></pre>

<hr>
<h2 id='jointness'>Calculation of of the jointness measures</h2><span id='topic+jointness'></span>

<h3>Description</h3>

<p>This function calculates four types of the jointness measures based on the posterior model probabilities calculated using binomial and binomial-beta model prior. The four measures are: <br />
</p>

<ol>
<li><p> HCGHM - for Hofmarcher et al. (2018) measure; <br />
</p>
</li>
<li><p> LS - for Ley &amp; Steel (2007) measure; <br />
</p>
</li>
<li><p> DW - for Doppelhofer &amp; Weeks (2009) measure; <br />
</p>
</li>
<li><p> PPI - for posterior probability of including both variables. <br />
The measures under binomial model prior will appear in a table above the diagonal, and the measure calculated under binomial-beta model prior below the diagonal. <br />
<br />
REFERENCES <br />
Doppelhofer G, Weeks M (2009) Jointness of growth determinants. Journal of Applied Econometrics., 24(2), 209-244. doi: 10.1002/jae.1046 <br />
Hofmarcher P, Crespo Cuaresma J, Gr√ºn B, Humer S, Moser M (2018) Bivariate jointness measures in Bayesian Model Averaging: Solving the conundrum. Journal of Macroeconomics, 57, 150-165. doi: 10.1016/j.jmacro.2018.05.005 <br />
Ley E, Steel M (2007) Jointness in Bayesian variable selection with applications to growth regression. Journal of Macroeconomics, 29(3), 476-493. doi: 10.1016/j.jmacro.2006.12.002
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>jointness(bma_list, measure = "HCGHM", rho = 0.5, app = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="jointness_+3A_bma_list">bma_list</code></td>
<td>
<p>bma object (the result of the bma function)</p>
</td></tr>
<tr><td><code id="jointness_+3A_measure">measure</code></td>
<td>
<p>Parameter for choosing the measure of jointness: <br />
HCGHM - for Hofmarcher et al. (2018) measure; <br />
LS - for Ley &amp; Steel (2007) measure; <br />
DW - for Doppelhofer &amp; Weeks (2009) measure; <br />
PPI - for posterior probability of including both variables.</p>
</td></tr>
<tr><td><code id="jointness_+3A_rho">rho</code></td>
<td>
<p>The parameter &quot;rho&quot; (<code class="reqn">\rho</code>) to be used in HCGHM jointness measure (default rho = 0.5). Works only if HCGHM measure is chosen (Hofmarcher et al. 2018).</p>
</td></tr>
<tr><td><code id="jointness_+3A_app">app</code></td>
<td>
<p>Parameter indicating the decimal place to which the jointness measures should be rounded (default app = 3).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table with jointness measures for all the pairs of regressors used in the analysis. Parameter &quot;above&quot; indicates what model prior is used for the values ABOVE the diagonal, and parameter &quot;below&quot; indicates what model prior is used for the values BELOW the diagonal.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(magrittr)

data_prepared &lt;- economic_growth[,1:7] %&gt;%
   feature_standardization(timestamp_col = year, entity_col = country) %&gt;%
   feature_standardization(timestamp_col = year, entity_col = country,
                           time_effects = TRUE, scale = FALSE)

model_space &lt;- optimal_model_space(df = data_prepared, dep_var_col = gdp,
                                   timestamp_col = year, entity_col = country,
                                   init_value = 0.5)

bma_results &lt;- bma(df = data_prepared, dep_var_col = gdp, timestamp_col = year,
entity_col = country, model_space = model_space, run_parallel = FALSE, dilution = 0)

jointness_table &lt;- jointness(bma_results, measure = "HCGHM", rho = 0.5, app = 3)

</code></pre>

<hr>
<h2 id='likelihoods_summary'>Approximate standard deviations for the models</h2><span id='topic+likelihoods_summary'></span>

<h3>Description</h3>

<p>Approximate standard deviations are computed for the models in the given
model space. Two versions are computed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>likelihoods_summary(
  df,
  dep_var_col,
  timestamp_col,
  entity_col,
  model_space,
  exact_value = TRUE,
  model_prior = "uniform",
  run_parallel = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="likelihoods_summary_+3A_df">df</code></td>
<td>
<p>Data frame with data for the SEM analysis.</p>
</td></tr>
<tr><td><code id="likelihoods_summary_+3A_dep_var_col">dep_var_col</code></td>
<td>
<p>Column with the dependent variable</p>
</td></tr>
<tr><td><code id="likelihoods_summary_+3A_timestamp_col">timestamp_col</code></td>
<td>
<p>The name of the column with timestamps</p>
</td></tr>
<tr><td><code id="likelihoods_summary_+3A_entity_col">entity_col</code></td>
<td>
<p>Column with entities (e.g. countries)</p>
</td></tr>
<tr><td><code id="likelihoods_summary_+3A_model_space">model_space</code></td>
<td>
<p>A matrix (with named rows) with each column corresponding
to a model. Each column specifies model parameters. Compare with
<a href="#topic+optimal_model_space">optimal_model_space</a></p>
</td></tr>
<tr><td><code id="likelihoods_summary_+3A_exact_value">exact_value</code></td>
<td>
<p>Whether the exact value of the likelihood should be
computed (<code>TRUE</code>) or just the proportional part (<code>FALSE</code>). Check
<a href="#topic+SEM_likelihood">SEM_likelihood</a> for details.</p>
</td></tr>
<tr><td><code id="likelihoods_summary_+3A_model_prior">model_prior</code></td>
<td>
<p>Which model prior to use. For now there are two options:
<code>'uniform'</code> and <code>'binomial-beta'</code>. Default is <code>'uniform'</code>.</p>
</td></tr>
<tr><td><code id="likelihoods_summary_+3A_run_parallel">run_parallel</code></td>
<td>
<p>If <code>TRUE</code> the optimization is run in parallel using
the <a href="parallel.html#topic+parApply">parApply</a> function. If <code>FALSE</code> (default value) the
base apply function is used. Note that using the parallel computing requires
setting the default cluster. See README.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix with columns describing likelihood and standard deviations for each
model. The first row is the likelihood for the model (computed using the
parameters in the provided model space). The second row is almost 1/2 * BIC_k
as in Raftery's Bayesian Model Selection in Social Research eq. 19 (see TODO
in the code below). The third row is model posterior probability. Then there
are rows with standard deviations for each parameter. After that we have rows
with robust standard deviation (not sure yet what exactly &quot;robust&quot; means).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data_centered_scaled &lt;-
    feature_standardization(df = bdsm::economic_growth[,1:7],
                            timestamp_col = year, entity_col = country)
  data_cross_sectional_standarized &lt;-
    feature_standardization(df = data_centered_scaled, timestamp_col = year,
                            entity_col = country, time_effects = TRUE,
                            scale = FALSE)

    likelihoods_summary(df = data_cross_sectional_standarized,
                        dep_var_col = gdp, timestamp_col = year,
                        entity_col = country, model_space = economic_growth_ms)


</code></pre>

<hr>
<h2 id='matrices_from_df'>List of matrices for SEM model</h2><span id='topic+matrices_from_df'></span>

<h3>Description</h3>

<p>List of matrices for SEM model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matrices_from_df(
  df,
  timestamp_col,
  entity_col,
  dep_var_col,
  lin_related_regressors = NULL,
  which_matrices = c("Y1", "Y2", "Z", "cur_Y2", "cur_Z", "res_maker_matrix")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="matrices_from_df_+3A_df">df</code></td>
<td>
<p>Dataframe with data for the likelihood computations.</p>
</td></tr>
<tr><td><code id="matrices_from_df_+3A_timestamp_col">timestamp_col</code></td>
<td>
<p>Column which determines time stamps. For now only
natural numbers can be used.</p>
</td></tr>
<tr><td><code id="matrices_from_df_+3A_entity_col">entity_col</code></td>
<td>
<p>Column which determines entities (e.g. countries, people)</p>
</td></tr>
<tr><td><code id="matrices_from_df_+3A_dep_var_col">dep_var_col</code></td>
<td>
<p>Column with dependent variable</p>
</td></tr>
<tr><td><code id="matrices_from_df_+3A_lin_related_regressors">lin_related_regressors</code></td>
<td>
<p>Vector of strings of column names. Which subset of regressors is in non trivial
linear relation with the dependent variable (<code>dep_var_col</code>). In other
words regressors with non-zero <code>beta</code> parameters.</p>
</td></tr>
<tr><td><code id="matrices_from_df_+3A_which_matrices">which_matrices</code></td>
<td>
<p>character vector with names of matrices which should be
computed. Possible matrices are
<code>"Y1"</code>, <code>"Y2"</code>, <code>"Z"</code>, <code>"cur_Y2"</code>, <code>"cur_Z"</code>,
<code>"res_maker_matrix"</code>. Default is
<code>c("Y1", "Y2", "Z", "cur_Y2","cur_Z", "res_maker_matrix")</code> in which case
all possible matrices are generated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named list with matrices as its elements
</p>


<h3>Examples</h3>

<pre><code class='language-R'>matrices_from_df(economic_growth, year, country, gdp, c("pop", "sed"),
                 c("Y1", "Y2"))
</code></pre>

<hr>
<h2 id='model_pmp'>Graphs of the prior and posterior model probabilities for the best individual models</h2><span id='topic+model_pmp'></span>

<h3>Description</h3>

<p>This function draws four graphs of prior and posterior model probabilities for the best individual models: <br />
a) The results with binomial model prior (based on PMP - posterior model probability) <br />
b) The results with binomial-beta model prior (based on PMP - posterior model probability) <br />
Models on the graph are ordered according to their posterior model probability.
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="model_pmp_+3A_bma_list">bma_list</code></td>
<td>
<p>bma_list object (the result of the bma function)</p>
</td></tr>
<tr><td><code id="model_pmp_+3A_top">top</code></td>
<td>
<p>The number of the best model to be placed on the graphs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with three graphs with prior and posterior model probabilities for individual models:<br />
</p>

<ol>
<li><p> The results with binomial model prior (based on PMP - posterior model probability) <br />
</p>
</li>
<li><p> The results with binomial-beta model prior (based on PMP - posterior model probability) <br />
</p>
</li>
<li><p> On graph combining the aforementioned graphs
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>
library(magrittr)

data_prepared &lt;- economic_growth[,1:7] %&gt;%
   feature_standardization(timestamp_col = year, entity_col = country) %&gt;%
   feature_standardization(timestamp_col = year, entity_col = country,
                           time_effects = TRUE, scale = FALSE)

model_space &lt;- optimal_model_space(df = data_prepared, dep_var_col = gdp,
                                   timestamp_col = year, entity_col = country,
                                   init_value = 0.5)

bma_results &lt;- bma(df = data_prepared, dep_var_col = gdp, timestamp_col = year,
entity_col = country, model_space = model_space, run_parallel = FALSE, dilution = 0)

model_graphs &lt;- model_pmp(bma_results, top = 16)


</code></pre>

<hr>
<h2 id='model_sizes'>Graphs of the prior and posterior model probabilities of the model sizes</h2><span id='topic+model_sizes'></span>

<h3>Description</h3>

<p>This function draws four graphs of prior and posterior model probabilities: <br />
a) The results with binomial model prior (based on PMP - posterior model probability) <br />
b) The results with binomial-beta model prior (based on PMP - posterior model probability)
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="model_sizes_+3A_bma_list">bma_list</code></td>
<td>
<p>bma_list object (the result of the bma function)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with three graphs with prior and posterior model probabilities for model sizes:<br />
</p>

<ol>
<li><p> The results with binomial model prior (based on PMP - posterior model probability) <br />
</p>
</li>
<li><p> The results with binomial-beta model prior (based on PMP - posterior model probability) <br />
</p>
</li>
<li><p> One graph combining all the aforementioned graphs
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>
library(magrittr)

data_prepared &lt;- economic_growth[,1:7] %&gt;%
   feature_standardization(timestamp_col = year, entity_col = country) %&gt;%
   feature_standardization(timestamp_col = year, entity_col = country,
                           time_effects = TRUE, scale = FALSE)

model_space &lt;- optimal_model_space(df = data_prepared, dep_var_col = gdp,
                                   timestamp_col = year, entity_col = country,
                                   init_value = 0.5)

bma_results &lt;- bma(df = data_prepared, dep_var_col = gdp, timestamp_col = year,
entity_col = country, model_space = model_space, run_parallel = FALSE, dilution = 0)

size_graphs &lt;- model_sizes(bma_results)


</code></pre>

<hr>
<h2 id='optimal_model_space'>Finds MLE parameters for each model in the given model space</h2><span id='topic+optimal_model_space'></span>

<h3>Description</h3>

<p>Given a dataset and an initial value for parameters, initializes a model
space with parameters equal to initial value for each model. Then for each
model performs a numerical optimization and finds parameters which maximize
the likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optimal_model_space(
  df,
  timestamp_col,
  entity_col,
  dep_var_col,
  init_value,
  exact_value = TRUE,
  run_parallel = FALSE,
  control = list(trace = 2, maxit = 10000, fnscale = -1, REPORT = 100, scale = 0.05)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="optimal_model_space_+3A_df">df</code></td>
<td>
<p>Data frame with data for the SEM analysis.</p>
</td></tr>
<tr><td><code id="optimal_model_space_+3A_timestamp_col">timestamp_col</code></td>
<td>
<p>The name of the column with time stamps</p>
</td></tr>
<tr><td><code id="optimal_model_space_+3A_entity_col">entity_col</code></td>
<td>
<p>Column with entities (e.g. countries)</p>
</td></tr>
<tr><td><code id="optimal_model_space_+3A_dep_var_col">dep_var_col</code></td>
<td>
<p>Column with the dependent variable</p>
</td></tr>
<tr><td><code id="optimal_model_space_+3A_init_value">init_value</code></td>
<td>
<p>The value with which the model space will be initialized.
This will be the starting point for the numerical optimization.</p>
</td></tr>
<tr><td><code id="optimal_model_space_+3A_exact_value">exact_value</code></td>
<td>
<p>Whether the exact value of the likelihood should be
computed (<code>TRUE</code>) or just the proportional part (<code>FALSE</code>). Check
<a href="#topic+SEM_likelihood">SEM_likelihood</a> for details.</p>
</td></tr>
<tr><td><code id="optimal_model_space_+3A_run_parallel">run_parallel</code></td>
<td>
<p>If <code>TRUE</code> the optimization is run in parallel using
the <a href="parallel.html#topic+parApply">parApply</a> function. If <code>FALSE</code> (default value) the
base apply function is used. Note that using the parallel computing requires
setting the default cluster. See README.</p>
</td></tr>
<tr><td><code id="optimal_model_space_+3A_control">control</code></td>
<td>
<p>a list of control parameters for the optimization which are
passed to <a href="stats.html#topic+optim">optim</a>. Default is
<code>list(trace = 2, maxit = 10000, fnscale = -1, REPORT = 100, scale = 0.05)</code>, but note
that <code>scale</code> is used only for adjusting the <code>parscale</code> element added later in the function code.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of parameters describing analyzed models
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(magrittr)

data_prepared &lt;- economic_growth[,1:7] %&gt;%
   feature_standardization(timestamp_col = year, entity_col = country) %&gt;%
   feature_standardization(timestamp_col = year, entity_col = country,
                           time_effects = TRUE, scale = FALSE)

model_space &lt;- optimal_model_space(df = data_prepared, dep_var_col = gdp,
                                   timestamp_col = year, entity_col = country,
                                   init_value = 0.5)


</code></pre>

<hr>
<h2 id='parameters_summary'>BMA summary for parameters of interest</h2><span id='topic+parameters_summary'></span>

<h3>Description</h3>

<p>TODO This is just the code previously present in the morel-benito.R script
wrapped as a function (to get rid of the script). Well written code and docs
are still needed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parameters_summary(
  regressors,
  bet,
  pvarh,
  pvarr,
  fy,
  fyt,
  ppmsize,
  cout,
  nts,
  pts,
  variables_n
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="parameters_summary_+3A_regressors">regressors</code></td>
<td>
<p>TODO</p>
</td></tr>
<tr><td><code id="parameters_summary_+3A_bet">bet</code></td>
<td>
<p>TODO</p>
</td></tr>
<tr><td><code id="parameters_summary_+3A_pvarh">pvarh</code></td>
<td>
<p>TODO</p>
</td></tr>
<tr><td><code id="parameters_summary_+3A_pvarr">pvarr</code></td>
<td>
<p>TODO</p>
</td></tr>
<tr><td><code id="parameters_summary_+3A_fy">fy</code></td>
<td>
<p>TODO</p>
</td></tr>
<tr><td><code id="parameters_summary_+3A_fyt">fyt</code></td>
<td>
<p>TODO</p>
</td></tr>
<tr><td><code id="parameters_summary_+3A_ppmsize">ppmsize</code></td>
<td>
<p>TODO</p>
</td></tr>
<tr><td><code id="parameters_summary_+3A_cout">cout</code></td>
<td>
<p>TODO</p>
</td></tr>
<tr><td><code id="parameters_summary_+3A_nts">nts</code></td>
<td>
<p>TODO (negatives)</p>
</td></tr>
<tr><td><code id="parameters_summary_+3A_pts">pts</code></td>
<td>
<p>TODO (positives)</p>
</td></tr>
<tr><td><code id="parameters_summary_+3A_variables_n">variables_n</code></td>
<td>
<p>TODO</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TODO dataframe with results
</p>

<hr>
<h2 id='regressor_names_from_params_vector'>Helper function to extract names from a vector defining a model</h2><span id='topic+regressor_names_from_params_vector'></span>

<h3>Description</h3>

<p>For now it is assumed that we can only exclude linear relationships between
regressors and the dependent variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regressor_names_from_params_vector(params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="regressor_names_from_params_vector_+3A_params">params</code></td>
<td>
<p>a vector with parameters describing the model</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The vector needs to have named rows, i.e. it is assumed it comes from a
model space (see <a href="#topic+initialize_model_space">initialize_model_space</a> for details).
</p>


<h3>Value</h3>

<p>Names of regressors which are assumed to be linearly connected with dependent
variable within the model described by the <code>params</code> vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>params &lt;- c(alpha = 1, beta_gdp = 1, beta_gdp_lagged = 1, phi_0 = 1, err_var = 1)
regressor_names_from_params_vector(params)

</code></pre>

<hr>
<h2 id='residual_maker_matrix'>Residual Maker Matrix</h2><span id='topic+residual_maker_matrix'></span>

<h3>Description</h3>

<p>Create residual maker matrix from a given matrix <code>m</code>. See article about
<a href="https://en.wikipedia.org/wiki/Projection_matrix">projection matrix</a> on
the Wikipedia.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>residual_maker_matrix(m)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residual_maker_matrix_+3A_m">m</code></td>
<td>
<p>Matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>M x M matrix where M is the number of rows in the <code>m</code> matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>residual_maker_matrix(matrix(c(1,2,3,4), nrow = 2))
</code></pre>

<hr>
<h2 id='SEM_B_matrix'>Coefficients matrix for SEM representation</h2><span id='topic+SEM_B_matrix'></span>

<h3>Description</h3>

<p>Create coefficients matrix for Simultaneous Equations Model (SEM)
representation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SEM_B_matrix(alpha, periods_n, beta = c())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SEM_B_matrix_+3A_alpha">alpha</code></td>
<td>
<p>numeric</p>
</td></tr>
<tr><td><code id="SEM_B_matrix_+3A_periods_n">periods_n</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="SEM_B_matrix_+3A_beta">beta</code></td>
<td>
<p>numeric vector. Default is c() for no regressors case.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with two matrices B11 and B12
</p>


<h3>Examples</h3>

<pre><code class='language-R'>SEM_B_matrix(3, 4, 4:6)
</code></pre>

<hr>
<h2 id='SEM_C_matrix'>Coefficients matrix for initial conditions</h2><span id='topic+SEM_C_matrix'></span>

<h3>Description</h3>

<p>Create matrix for Simultaneous Equations Model (SEM)
representation with coefficients placed next to initial values
of regressors, dependent variable and country-specific time-invariant
variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SEM_C_matrix(alpha, phi_0, periods_n, beta = c(), phi_1 = c())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SEM_C_matrix_+3A_alpha">alpha</code></td>
<td>
<p>numeric</p>
</td></tr>
<tr><td><code id="SEM_C_matrix_+3A_phi_0">phi_0</code></td>
<td>
<p>numeric</p>
</td></tr>
<tr><td><code id="SEM_C_matrix_+3A_periods_n">periods_n</code></td>
<td>
<p>numeric</p>
</td></tr>
<tr><td><code id="SEM_C_matrix_+3A_beta">beta</code></td>
<td>
<p>numeric vector. Default is c() for no regressors case.</p>
</td></tr>
<tr><td><code id="SEM_C_matrix_+3A_phi_1">phi_1</code></td>
<td>
<p>numeric vector. Default is c() for no regressors case.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'>alpha &lt;- 9
phi_0 &lt;- 19
beta &lt;- 11:15
phi_1 &lt;- 21:25
periods_n &lt;- 4
SEM_C_matrix(alpha, phi_0, periods_n, beta, phi_1)
</code></pre>

<hr>
<h2 id='SEM_dep_var_matrix'>Matrix with dependent variable data for SEM representation</h2><span id='topic+SEM_dep_var_matrix'></span>

<h3>Description</h3>

<p>Create matrix which contains dependent variable data used in the Simultaneous
Equations Model (SEM) representation on the left hand side of the equations.
The matrix contains the data for time periods greater than or equal to the
second lowest time stamp. The matrix is then used to compute likelihood for
SEM analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SEM_dep_var_matrix(df, timestamp_col, entity_col, dep_var_col)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SEM_dep_var_matrix_+3A_df">df</code></td>
<td>
<p>Data frame with data for the SEM analysis.</p>
</td></tr>
<tr><td><code id="SEM_dep_var_matrix_+3A_timestamp_col">timestamp_col</code></td>
<td>
<p>Column which determines time periods. For now only
natural numbers can be used as timestamps</p>
</td></tr>
<tr><td><code id="SEM_dep_var_matrix_+3A_entity_col">entity_col</code></td>
<td>
<p>Column which determines entities (e.g. countries, people)</p>
</td></tr>
<tr><td><code id="SEM_dep_var_matrix_+3A_dep_var_col">dep_var_col</code></td>
<td>
<p>Column with dependent variable</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of size N x T where N is the number of entities considered and T is
the number of periods greater than or equal to the second lowest time stamp.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
df &lt;- data.frame(
  entities = rep(1:4, 5),
  times = rep(seq(1960, 2000, 10), each = 4),
  dep_var = stats::rnorm(20), a = stats::rnorm(20), b = stats::rnorm(20)
)
SEM_dep_var_matrix(df, times, entities, dep_var)
</code></pre>

<hr>
<h2 id='SEM_likelihood'>Likelihood for the SEM model</h2><span id='topic+SEM_likelihood'></span>

<h3>Description</h3>

<p>Likelihood for the SEM model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SEM_likelihood(
  params,
  data,
  timestamp_col,
  entity_col,
  dep_var_col,
  lin_related_regressors = NULL,
  per_entity = FALSE,
  exact_value = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SEM_likelihood_+3A_params">params</code></td>
<td>
<p>Parameters describing the model. Can be either a vector or a
list with named parameters. See 'Details'</p>
</td></tr>
<tr><td><code id="SEM_likelihood_+3A_data">data</code></td>
<td>
<p>Data for the likelihood computations. Can be either a list of
matrices or a dataframe. If the dataframe, additional parameters are
required to build the matrices within the function.</p>
</td></tr>
<tr><td><code id="SEM_likelihood_+3A_timestamp_col">timestamp_col</code></td>
<td>
<p>Column which determines time stamps. For now only
natural numbers can be used.</p>
</td></tr>
<tr><td><code id="SEM_likelihood_+3A_entity_col">entity_col</code></td>
<td>
<p>Column which determines entities (e.g. countries, people)</p>
</td></tr>
<tr><td><code id="SEM_likelihood_+3A_dep_var_col">dep_var_col</code></td>
<td>
<p>Column with dependent variable</p>
</td></tr>
<tr><td><code id="SEM_likelihood_+3A_lin_related_regressors">lin_related_regressors</code></td>
<td>
<p>Which subset of columns should be used as
regressors for the current model. In other words <code>regressors</code> are the
total set of regressors and <code>lin_related_regressors</code> are the ones for
which linear relation is not set to zero for a given model.</p>
</td></tr>
<tr><td><code id="SEM_likelihood_+3A_per_entity">per_entity</code></td>
<td>
<p>Whether to compute overall likelihood or a vector of
likelihoods with per entity value</p>
</td></tr>
<tr><td><code id="SEM_likelihood_+3A_exact_value">exact_value</code></td>
<td>
<p>Whether the exact value of the likelihood should be
computed (<code>TRUE</code>) or just the proportional part (<code>FALSE</code>).
Currently <code>TRUE</code> adds: 1. a normalization constant coming from Gaussian
distribution, 2. a term disappearing during likelihood simplification in
Likelihood-based Estimation of Dynamic Panels with Predetermined Regressors
by Moral-Benito (see Appendix A.1). The latter happens when transitioning
from equation (47) to equation (48), in step 2: the term <code>trace(HG_22)</code> is
dropped, because it can be assumed to be constant from Moral-Benito
perspective. To get the exact value of the likelihood we have to take this
term into account.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>params</code> argument is a list that should contain the following
components:
</p>
<p><code>alpha</code> scalar value which determines linear dependence on lagged
dependent variable
</p>
<p><code>phi_0</code> scalar value which determines linear dependence on the value
of dependent variable at the lowest time stamp
</p>
<p><code>err_var</code> scalar value which determines classical error component
(Sigma11 matrix, sigma_epsilon^2)
</p>
<p><code>dep_vars</code> double vector of length equal to the number of time stamps
(i.e. time stamps greater than or equal to the second lowest time stamp)
</p>
<p><code>beta</code> double vector which determines the linear dependence on
regressors different than the lagged dependent variable; The vector should
have length equal to the number of regressors.
</p>
<p><code>phi_1</code> double vector which determines the linear dependence on
initial values of regressors different than the lagged dependent variable;
The vector should have length equal to the number of regressors.
</p>
<p><code>phis</code> double vector which together with <code>psis</code> determines upper
right and bottom left part of the covariance matrix; The vector should have
length equal to the number of regressors times number of time stamps minus 1,
i.e. <code>regressors_n * (periods_n - 1)</code>
</p>
<p><code>psis</code> double vector which together with <code>psis</code> determines upper
right and bottom left part of the covariance matrix; The vector should have
length equal to the number of regressors times number of time stamps minus 1
times number of time stamps divided by 2, i.e.
<code>regressors_n * (periods_n - 1) * periods_n / 2</code>
</p>


<h3>Value</h3>

<p>The value of the likelihood for SEM model (or a part of interest of the
likelihood)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
df &lt;- data.frame(
  entities = rep(1:4, 5),
  times = rep(seq(1960, 2000, 10), each = 4),
  dep_var = stats::rnorm(20), a = stats::rnorm(20), b = stats::rnorm(20)
)
df &lt;-
  feature_standardization(df, timestamp_col = times, entity_col = entities)
SEM_likelihood(0.5, df, times, entities, dep_var)
</code></pre>

<hr>
<h2 id='SEM_psi_matrix'>Matrix with psi parameters for SEM representation</h2><span id='topic+SEM_psi_matrix'></span>

<h3>Description</h3>

<p>Matrix with psi parameters for SEM representation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SEM_psi_matrix(psis, timestamps_n, features_n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SEM_psi_matrix_+3A_psis">psis</code></td>
<td>
<p>double vector with psi parameter values</p>
</td></tr>
<tr><td><code id="SEM_psi_matrix_+3A_timestamps_n">timestamps_n</code></td>
<td>
<p>number of time stamps (e.g. years)</p>
</td></tr>
<tr><td><code id="SEM_psi_matrix_+3A_features_n">features_n</code></td>
<td>
<p>number of features (e.g. population size, investment rate)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with <code>timestamps_n</code> rows and
<code>(timestamps_n - 1) * feature_n</code> columns. Psis are filled in row by row
in a block manner, i.e. blocks of size <code>feature_n</code> are placed next to
each other
</p>


<h3>Examples</h3>

<pre><code class='language-R'>SEM_psi_matrix(1:30, 4, 5)
</code></pre>

<hr>
<h2 id='SEM_regressors_matrix'>Matrix with regressors data for SEM representation</h2><span id='topic+SEM_regressors_matrix'></span>

<h3>Description</h3>

<p>Create matrix which contains regressors data used in the Simultaneous
Equations Model (SEM) representation on the left hand side of the equations.
The matrix contains regressors data for time periods greater than or equal to
the second lowest time stamp. The matrix is then used to compute likelihood
for SEM analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SEM_regressors_matrix(df, timestamp_col, entity_col, dep_var_col)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SEM_regressors_matrix_+3A_df">df</code></td>
<td>
<p>Data frame with data for the SEM analysis.</p>
</td></tr>
<tr><td><code id="SEM_regressors_matrix_+3A_timestamp_col">timestamp_col</code></td>
<td>
<p>Column which determines time periods. For now only
natural numbers can be used as timestamps</p>
</td></tr>
<tr><td><code id="SEM_regressors_matrix_+3A_entity_col">entity_col</code></td>
<td>
<p>Column which determines entities (e.g. countries, people)</p>
</td></tr>
<tr><td><code id="SEM_regressors_matrix_+3A_dep_var_col">dep_var_col</code></td>
<td>
<p>Column with dependent variable</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of size N x (T-1)*k where N is the number of entities considered, T is
the number of periods greater than or equal to the second lowest time stamp
and k is the number of chosen regressors. If there are no regressors returns
<code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
df &lt;- data.frame(
  entities = rep(1:4, 5),
  times = rep(seq(1960, 2000, 10), each = 4),
  dep_var = stats::rnorm(20), a = stats::rnorm(20), b = stats::rnorm(20)
)
SEM_regressors_matrix(df, times, entities, dep_var)
</code></pre>

<hr>
<h2 id='SEM_sigma_matrix'>Covariance matrix for SEM representation</h2><span id='topic+SEM_sigma_matrix'></span>

<h3>Description</h3>

<p>Create covariance matrix for Simultaneous Equations Model (SEM)
representation. Only the part necessary to compute concentrated likelihood
function is computed (cf. Appendix in the Moral-Benito paper)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SEM_sigma_matrix(err_var, dep_vars, phis = c(), psis = c())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SEM_sigma_matrix_+3A_err_var">err_var</code></td>
<td>
<p>numeric</p>
</td></tr>
<tr><td><code id="SEM_sigma_matrix_+3A_dep_vars">dep_vars</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="SEM_sigma_matrix_+3A_phis">phis</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="SEM_sigma_matrix_+3A_psis">psis</code></td>
<td>
<p>numeric vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with two matrices Sigma11 and Sigma12
</p>


<h3>Examples</h3>

<pre><code class='language-R'>err_var &lt;- 1
dep_vars &lt;- c(2, 2, 2, 2)
phis &lt;- c(10, 10, 20, 20, 30, 30)
psis &lt;- c(101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112)
SEM_sigma_matrix(err_var, dep_vars, phis, psis)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
