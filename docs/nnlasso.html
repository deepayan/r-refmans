<!DOCTYPE html><html lang="en"><head><title>Help for package nnlasso</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nnlasso}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bars'><p>Error bars</p></a></li>
<li><a href='#car'>
<p>The car data</p></a></li>
<li><a href='#coef.nnlasso'><p>Extract coefficients from a fitted nnlasso object</p></a></li>
<li><a href='#cv.nnlasso'><p>k-fold cross validation for penalized generalized linear models for normal/binomial/poisson family</p></a></li>
<li><a href='#cv.nnlasso.binomial'><p>k-fold cross validation for penalized generalized linear models subject to non-negativity constrains for binomial family</p></a></li>
<li><a href='#cv.nnlasso.normal'><p>k-fold cross validation for penalized generalized linear models for normal family</p></a></li>
<li><a href='#cv.nnlasso.poisson'><p>k-fold cross validation for penalized generalized linear models for poisson family</p></a></li>
<li><a href='#fold'><p>Particular fold of a data after k fold partition</p></a></li>
<li><a href='#kfold'><p>k-fold partition of data at random</p></a></li>
<li><a href='#msefun.binomial'><p>Deviances for hold out data in cross validation</p></a></li>
<li><a href='#msefun.normal'><p>Prediction means squared errors for hold out data in cross validation</p></a></li>
<li><a href='#msefun.poisson'><p>Deviances for hold out data in cross validation</p></a></li>
<li><a href='#nnlasso'><p>Entire regularization path of non-negative penalized generalized linear model for normal/binomial/poisson family using multiplicative iterative algorithm</p></a></li>
<li><a href='#nnlasso.binomial'><p>Entire regularization path of non-negative penalized generalized linear model for binomial family using using Multiplicative Iterative Algorithm</p></a></li>
<li><a href='#nnlasso.binomial.lambda'><p>Coefficients of non-negative penalized generalized linear models for a given lambda for binomial family</p></a></li>
<li><a href='#nnlasso.normal'><p>Entire regularization path of non-negative penalized generalized linear model for normal family using Multiplicative Iterative Algorithm</p></a></li>
<li><a href='#nnlasso.normal.lambda'><p>Coefficients of non-negative penalized generalized linear models for a given lambda for normal family</p></a></li>
<li><a href='#nnlasso.poisson'><p>Entire regularization path of non-negative penalized generalized linear model for poisson family using multiplicative iterative algorithm</p></a></li>
<li><a href='#nnlasso.poisson.lambda'><p>Coefficients of non-negative penalized generalized linear models for a given lambda for Poisson family</p></a></li>
<li><a href='#plot.nnlasso'><p>Plot of regularization path</p></a></li>
<li><a href='#predict.nnlasso'><p>Prediction of coefficients of a penalized linear regression or generalized linear models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Non-Negative Lasso and Elastic Net Penalized Generalized Linear
Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-03-09</td>
</tr>
<tr>
<td>Author:</td>
<td>Baidya Nath Mandal &lt;mandal.stat@gmail.com&gt; and Jun Ma &lt;jun.ma@mq.edu.au&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Baidya Nath Mandal &lt;mandal.stat@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.2)</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates of coefficients of lasso penalized linear regression and generalized linear models subject to non-negativity constraints on the parameters using multiplicative iterative algorithm. Entire regularization path for a sequence of lambda values can be obtained. Functions are available for creating plots of regularization path, cross validation and estimating coefficients at a given lambda value. There is also provision for obtaining standard error of coefficient estimates.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-03-10 05:10:00 UTC; Lenovo</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-03-10 08:00:33</td>
</tr>
</table>
<hr>
<h2 id='bars'>Error bars</h2><span id='topic+bars'></span>

<h3>Description</h3>

<p>The function places error bars on crossvalidation plots</p>


<h3>Usage</h3>

<pre><code class='language-R'>bars(x, up, low, width = 0.03, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bars_+3A_x">x</code></td>
<td>
<p>a vector</p>
</td></tr>
<tr><td><code id="bars_+3A_up">up</code></td>
<td>
<p>a vector</p>
</td></tr>
<tr><td><code id="bars_+3A_low">low</code></td>
<td>
<p>a vector</p>
</td></tr>
<tr><td><code id="bars_+3A_width">width</code></td>
<td>
<p>a vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is internal and used by cross validation routines.</p>


<h3>Author(s)</h3>

<p>Baidya Nath Mandal and Jun Ma</p>

<hr>
<h2 id='car'>
The car data
</h2><span id='topic+car'></span>

<h3>Description</h3>

<p>Car data has 105 observations and 12 variables. All variables except the 12th are standardized such that mean of each of them is 0 and standard deviation is 1. First 10 variables are various characteristics of the cars. The 11th variable y is the price. The 12th variable is a binary variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("car")</code></pre>


<h3>Format</h3>

<p>A data frame with 105 observations on the following 12 variables.
</p>

<dl>
<dt><code>Weight</code></dt><dd><p>weights of the cars</p>
</dd>
<dt><code>Length</code></dt><dd><p>overall length</p>
</dd>
<dt><code>Wheel.base</code></dt><dd><p>length of wheelbase</p>
</dd>
<dt><code>Width</code></dt><dd><p>width of car</p>
</dd>
<dt><code>Frt.Leg.Room</code></dt><dd><p>maximum front leg room</p>
</dd>
<dt><code>Front.Hd</code></dt><dd><p>distance between the car's head-liner and the head of a 5 ft. 9 in. front seat passenger</p>
</dd>
<dt><code>Turning</code></dt><dd><p>the radius of the turning circle</p>
</dd>
<dt><code>Disp</code></dt><dd><p>engine displacement</p>
</dd>
<dt><code>HP</code></dt><dd><p>net horsepower</p>
</dd>
<dt><code>Tank</code></dt><dd><p>fuel refill capacity</p>
</dd>
<dt><code>y</code></dt><dd><p>price</p>
</dd>
<dt><code>y1</code></dt><dd><p>High or low price</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data is created from car90 data of rpart package with selected 11 variables. The selected variables are Weight,Length,Wheel.base,Width,Frt.Leg.Room,Front.Hd,Turning,Disp,HP,Tank,Price. All these variables are standardized such that each of them has mean 0 and standard deviation 1. Price variable has been renamed as y. The variable y1 is a dichotomous variable created from that the data such that if price &gt;=25000, then y1=1 else y1=0. Only complete cases are considered, so the data has 105 observations in place of 111 observations in car90 data set.</p>


<h3>Source</h3>

<p>Terry Therneau, Beth Atkinson and Brian Ripley (2014). rpart: Recursive Partitioning and Regression Trees. R package version 4.1-8. http://CRAN.R-project.org/package=rpart
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(car)
</code></pre>

<hr>
<h2 id='coef.nnlasso'>Extract coefficients from a fitted nnlasso object</h2><span id='topic+coef.nnlasso'></span>

<h3>Description</h3>

<p>The function returns the coefficients from a fitted nnlasso object</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nnlasso'
coef(object,...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.nnlasso_+3A_object">object</code></td>
<td>
<p>A &lsquo;nnlasso&rsquo; object obtained using &lsquo;nnlasso&rsquo; function.</p>
</td></tr>
<tr><td><code id="coef.nnlasso_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimated coefficients for different lambdas starting from maximum value of lambda to minimum value of lambda</p>


<h3>Author(s)</h3>

<p>Baidya Nath Mandal and Jun Ma</p>


<h3>References</h3>

<p>Mandal, B.N. and Ma, J. (2016). L1 regularized multiplicative iterative path algorithm for non-negative generalized linear models</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(car)
attach(car)
x=car[,1:10]
g1=nnlasso(x,y1,family="binomial")
coef(g1)
g1=nnlasso(x,y,family="normal")
coef(g1)
detach(car)
</code></pre>

<hr>
<h2 id='cv.nnlasso'>k-fold cross validation for penalized generalized linear models for normal/binomial/poisson family</h2><span id='topic+cv.nnlasso'></span>

<h3>Description</h3>

<p>The function does k-fold cross validation for selecting best value of regularization parameter.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv.nnlasso(x,y,family=c("binomial","normal","poisson"),
k=5,nlambda=50,tau=1,plot=TRUE, errorbars=TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv.nnlasso_+3A_x">x</code></td>
<td>
<p>x is matrix of order n x p where n is number of observations and p is number of predictor variables. Rows should represent observations and columns should represent predictor variables.</p>
</td></tr>
<tr><td><code id="cv.nnlasso_+3A_y">y</code></td>
<td>
<p>y is a vector of response variable of order n x 1.</p>
</td></tr>
<tr><td><code id="cv.nnlasso_+3A_family">family</code></td>
<td>
<p>family is either &quot;normal&quot; or &quot;binomial&quot; or &quot;poisson&quot;.</p>
</td></tr>
<tr><td><code id="cv.nnlasso_+3A_k">k</code></td>
<td>
<p>Number of folds for cross validation. Default is k=5.</p>
</td></tr>
<tr><td><code id="cv.nnlasso_+3A_nlambda">nlambda</code></td>
<td>
<p>Number of lambda values to be used for cross validation. Default is nlambda=50.</p>
</td></tr>
<tr><td><code id="cv.nnlasso_+3A_tau">tau</code></td>
<td>
<p>Elastic net parameter, <code class="reqn">0 \le \tau \le 1</code> in elastic net penalty <code class="reqn">\lambda{\tau|\beta|_1+(1-\tau)|\beta|_2^2}</code>. Default tau=1 corresponds to LASSO penalty.</p>
</td></tr>
<tr><td><code id="cv.nnlasso_+3A_plot">plot</code></td>
<td>
<p>if TRUE, produces a plot of cross validated prediction mean squared errors/ deviances against lambda. Default is TRUE.</p>
</td></tr>
<tr><td><code id="cv.nnlasso_+3A_errorbars">errorbars</code></td>
<td>
<p>If TRUE, error bars are drawn in the plot. Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Produces a plot and returns a list with following components:
</p>
<table role = "presentation">
<tr><td><code>lambda</code></td>
<td>
<p>Value of lambda for which average cross validation error is minimum</p>
</td></tr>
<tr><td><code>pmse</code></td>
<td>
<p>A vector of average cross validation errors for various lambda values</p>
</td></tr>
<tr><td><code>lambdas</code></td>
<td>
<p>A vector of lambda values used in cross validation</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>A vector containing standard errors of cross validation errors</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function uses prediction means squared errors for normal family and deviance for binomial and poisson family.</p>


<h3>Author(s)</h3>

<p>Baidya Nath Mandal and Jun Ma</p>


<h3>References</h3>

<p>Mandal, B.N. and Ma, J. (2016). L1 regularized multiplicative iterative path algorithm for non-negative generalized linear models.</p>


<h3>Examples</h3>

<pre><code class='language-R'>#normal family
data(car)
attach(car)
x=as.matrix(car[,1:10])
## Not run: cv.nnlasso(x,y,family="normal",k=5)
#binomial family with same data
## Not run: cv.nnlasso(x,y1,family="binomial",k=5)
detach(car)

#poisson family
x=matrix(rnorm(100*30),100,30)
y=sample(c(1:5),100,replace=TRUE)
## Not run: cv.nnlasso(x,y,family="poisson",k=5)
</code></pre>

<hr>
<h2 id='cv.nnlasso.binomial'>k-fold cross validation for penalized generalized linear models subject to non-negativity constrains for binomial family</h2><span id='topic+cv.nnlasso.binomial'></span>

<h3>Description</h3>

<p>The function does k-fold cross validation for selecting best value of regularization parameter.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv.nnlasso.binomial(x,y,k=5,nlambda=50,tau=1,plot=TRUE,errorbars=TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv.nnlasso.binomial_+3A_x">x</code></td>
<td>
<p>x is matrix of order n x p where n is number of observations and p is number of predictor variables. Rows should represent observations and columns should represent predictor variables.</p>
</td></tr>
<tr><td><code id="cv.nnlasso.binomial_+3A_y">y</code></td>
<td>
<p>y is a vector of response variable of order n x 1.</p>
</td></tr>
<tr><td><code id="cv.nnlasso.binomial_+3A_k">k</code></td>
<td>
<p>Number of folds for cross validation. Default is k=5.</p>
</td></tr>
<tr><td><code id="cv.nnlasso.binomial_+3A_nlambda">nlambda</code></td>
<td>
<p>Number of lambda values to be used for cross validation. Default is nlambda=50.</p>
</td></tr>
<tr><td><code id="cv.nnlasso.binomial_+3A_tau">tau</code></td>
<td>
<p>Elastic net parameter, <code class="reqn">0 \le \tau \le 1</code> in elastic net penalty <code class="reqn">\lambda{\tau|\beta|_1+(1-\tau)|\beta|_2^2}</code>. Default tau=1 corresponds to LASSO penalty.</p>
</td></tr>
<tr><td><code id="cv.nnlasso.binomial_+3A_plot">plot</code></td>
<td>
<p>if TRUE, produces a plot of cross validated prediction mean squared errors against lambda. Default is TRUE.</p>
</td></tr>
<tr><td><code id="cv.nnlasso.binomial_+3A_errorbars">errorbars</code></td>
<td>
<p>If TRUE, error bars are drawn in the plot. Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Produces a plot and returns a list with following components:
</p>
<table role = "presentation">
<tr><td><code>lambda</code></td>
<td>
<p>Value of lambda for which average cross validation error is minimum</p>
</td></tr>
<tr><td><code>pmse</code></td>
<td>
<p>A vector of average cross validation errors for various lambda values</p>
</td></tr>
<tr><td><code>lambdas</code></td>
<td>
<p>A vector of lambda values used in cross validation</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>A vector containing standard errors of cross validation errors</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function need not be called by user. The function is internally called by cv.nnlasso function.</p>


<h3>Author(s)</h3>

<p>Baidya Nath Mandal and Jun Ma</p>


<h3>References</h3>

<p>Mandal, B.N. and  Ma, J.(2016).L1 regularized multiplicative iterative path algorithm for non-negative generalized linear models</p>

<hr>
<h2 id='cv.nnlasso.normal'>k-fold cross validation for penalized generalized linear models for normal family</h2><span id='topic+cv.nnlasso.normal'></span>

<h3>Description</h3>

<p>The function does k-fold cross validation for selecting best value of regularization parameter.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv.nnlasso.normal(x,y,k=5,nlambda=50,tau=1,plot=TRUE,errorbars=TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv.nnlasso.normal_+3A_x">x</code></td>
<td>
<p>x is matrix of order n x p where n is number of observations and p is number of predictor variables. Rows should represent observations and columns should represent predictor variables.</p>
</td></tr>
<tr><td><code id="cv.nnlasso.normal_+3A_y">y</code></td>
<td>
<p>y is a vector of response variable of order n x 1.</p>
</td></tr>
<tr><td><code id="cv.nnlasso.normal_+3A_k">k</code></td>
<td>
<p>Number of folds for cross validation. Default is k=5.</p>
</td></tr>
<tr><td><code id="cv.nnlasso.normal_+3A_nlambda">nlambda</code></td>
<td>
<p>Number of lambda values to be used for cross validation. Default is nlambda=50.</p>
</td></tr>
<tr><td><code id="cv.nnlasso.normal_+3A_tau">tau</code></td>
<td>
<p>Elastic net parameter, <code class="reqn">0 \le \tau \le 1</code> in elastic net penalty <code class="reqn">\lambda{\tau|\beta|_1+(1-\tau)|\beta|_2^2}</code>. Default tau=1 corresponds to LASSO penalty.</p>
</td></tr>
<tr><td><code id="cv.nnlasso.normal_+3A_plot">plot</code></td>
<td>
<p>if TRUE, produces a plot of cross validated prediction mean squared errors against lambda. Default is TRUE.</p>
</td></tr>
<tr><td><code id="cv.nnlasso.normal_+3A_errorbars">errorbars</code></td>
<td>
<p>If TRUE, error bars are drawn in the plot. Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Produces a plot and returns a list with following components:
</p>
<table role = "presentation">
<tr><td><code>lambda</code></td>
<td>
<p>Value of lambda for which average cross validation error is minimum</p>
</td></tr>
<tr><td><code>pmse</code></td>
<td>
<p>A vector of average cross validation errors for various lambda values</p>
</td></tr>
<tr><td><code>lambdas</code></td>
<td>
<p>A vector of lambda values used in cross validation</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>A vector containing standard errors of cross validation errors</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function need not be called by user. The function is internally called by cv.nnlasso function.</p>


<h3>Author(s)</h3>

<p>Baidya Nath Mandal and Jun Ma</p>


<h3>References</h3>

<p>Mandal, B.N. and Ma, J. (2016). L1 regularized multiplicative iterative path algorithm for non-negative generalized linear models.</p>

<hr>
<h2 id='cv.nnlasso.poisson'>k-fold cross validation for penalized generalized linear models for poisson family</h2><span id='topic+cv.nnlasso.poisson'></span>

<h3>Description</h3>

<p>The function does k-fold cross validation for selecting best value of regularization parameter.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv.nnlasso.poisson(x,y,k=5,nlambda=50,tau=1,plot=TRUE,errorbars=TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv.nnlasso.poisson_+3A_x">x</code></td>
<td>
<p>x is matrix of order n x p where n is number of observations and p is number of predictor variables. Rows should represent observations and columns should represent predictor variables.</p>
</td></tr>
<tr><td><code id="cv.nnlasso.poisson_+3A_y">y</code></td>
<td>
<p>y is a vector of response variable of order n x 1.</p>
</td></tr>
<tr><td><code id="cv.nnlasso.poisson_+3A_k">k</code></td>
<td>
<p>Number of folds for cross validation. Default is k=5.</p>
</td></tr>
<tr><td><code id="cv.nnlasso.poisson_+3A_nlambda">nlambda</code></td>
<td>
<p>Number of lambda values to be used for cross validation. Default is nlambda=50.</p>
</td></tr>
<tr><td><code id="cv.nnlasso.poisson_+3A_tau">tau</code></td>
<td>
<p>Elastic net parameter, <code class="reqn">0 \le \tau \le 1</code> in elastic net penalty <code class="reqn">\lambda{\tau|\beta|_1+(1-\tau)|\beta|_2^2}</code>. Default tau=1 corresponds to LASSO penalty.</p>
</td></tr>
<tr><td><code id="cv.nnlasso.poisson_+3A_plot">plot</code></td>
<td>
<p>if TRUE, produces a plot of cross validated prediction mean squared errors against lambda. Default is TRUE.</p>
</td></tr>
<tr><td><code id="cv.nnlasso.poisson_+3A_errorbars">errorbars</code></td>
<td>
<p>If TRUE, error bars are drawn in the plot. Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Produces a plot and returns a list with following components:
</p>
<table role = "presentation">
<tr><td><code>lambda</code></td>
<td>
<p>Value of lambda for which average cross validation error is minimum</p>
</td></tr>
<tr><td><code>pmse</code></td>
<td>
<p>A vector of average cross validation errors for various lambda values</p>
</td></tr>
<tr><td><code>lambdas</code></td>
<td>
<p>A vector of lambda values used in cross validation</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>A vector containing standard errors of cross validation errors</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function need not be called by user. The function is internally called by cv.nnlasso function.</p>


<h3>Author(s)</h3>

<p>Baidya Nath Mandal and Jun Ma</p>


<h3>References</h3>

<p>Mandal, B.N. and Ma, J. (2016). L1 regularized multiplicative iterative path algorithm for non-negative generalized linear models.</p>

<hr>
<h2 id='fold'>Particular fold of a data after k fold partition</h2><span id='topic+fold'></span>

<h3>Description</h3>

<p>The function returns a particular fold after k-fold partitioning by kfold function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>fold(data1,k,i)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fold_+3A_data1">data1</code></td>
<td>
<p>A matrix.</p>
</td></tr>   
<tr><td><code id="fold_+3A_k">k</code></td>
<td>
<p>Number of folds</p>
</td></tr>
<tr><td><code id="fold_+3A_i">i</code></td>
<td>
<p>The fold to be returned</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is internal and used by cross validation routines.</p>


<h3>Value</h3>

<p>A matrix with desired fold specified.</p>


<h3>Author(s)</h3>

<p>Baidya Nath Mandal and Jun Ma</p>


<h3>Examples</h3>

<pre><code class='language-R'>data=matrix(rnorm(10*4),10,4)
kfold(data,3)
fold(data,3,2)
</code></pre>

<hr>
<h2 id='kfold'>k-fold partition of data at random</h2><span id='topic+kfold'></span>

<h3>Description</h3>

<p>The function partitions a data set into k folds of equal sizes at random.</p>


<h3>Usage</h3>

<pre><code class='language-R'>kfold(data1,k)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kfold_+3A_data1">data1</code></td>
<td>
<p>A matrix.</p>
</td></tr>   
<tr><td><code id="kfold_+3A_k">k</code></td>
<td>
<p>Number of folds</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is internal and used by cross validation routines.</p>


<h3>Value</h3>

<p>A matrix with fold identification in first column.</p>


<h3>Author(s)</h3>

<p>Baidya Nath Mandal and Jun Ma</p>


<h3>Examples</h3>

<pre><code class='language-R'>data=matrix(rnorm(10*4),10,4)
kfold(data,3)
</code></pre>

<hr>
<h2 id='msefun.binomial'>Deviances for hold out data in cross validation</h2><span id='topic+msefun.binomial'></span>

<h3>Description</h3>

<p>The function computes deviances for hold out data of ith fold</p>


<h3>Usage</h3>

<pre><code class='language-R'>msefun.binomial(lambda1,f1,xi,yi)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="msefun.binomial_+3A_lambda1">lambda1</code></td>
<td>
<p>value of lambda</p>
</td></tr>   
<tr><td><code id="msefun.binomial_+3A_f1">f1</code></td>
<td>
<p>A fitted &lsquo;nnlasso&rsquo; object</p>
</td></tr>
<tr><td><code id="msefun.binomial_+3A_xi">xi</code></td>
<td>
<p>Hold out data of predictor variables</p>
</td></tr>
<tr><td><code id="msefun.binomial_+3A_yi">yi</code></td>
<td>
<p>Hold out data of response variables</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is internal and used by cross validation routines.</p>


<h3>Value</h3>

<p>A value of deviance</p>


<h3>Author(s)</h3>

<p>Baidya Nath Mandal and Jun Ma</p>

<hr>
<h2 id='msefun.normal'>Prediction means squared errors for hold out data in cross validation</h2><span id='topic+msefun.normal'></span>

<h3>Description</h3>

<p>The function computes Prediction means squared errors for hold out data of ith fold</p>


<h3>Usage</h3>

<pre><code class='language-R'>msefun.normal(lambda1,f1,xi,yi)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="msefun.normal_+3A_lambda1">lambda1</code></td>
<td>
<p>value of lambda</p>
</td></tr>   
<tr><td><code id="msefun.normal_+3A_f1">f1</code></td>
<td>
<p>A fitted &lsquo;nnlasso&rsquo; object</p>
</td></tr>
<tr><td><code id="msefun.normal_+3A_xi">xi</code></td>
<td>
<p>Hold out data of predictor variables</p>
</td></tr>
<tr><td><code id="msefun.normal_+3A_yi">yi</code></td>
<td>
<p>Hold out data of response variables</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is internal and used by cross validation routines.</p>


<h3>Value</h3>

<p>A value of prediction mean squared error</p>


<h3>Author(s)</h3>

<p>Baidya Nath Mandal and Jun Ma</p>

<hr>
<h2 id='msefun.poisson'>Deviances for hold out data in cross validation</h2><span id='topic+msefun.poisson'></span>

<h3>Description</h3>

<p>The function computes deviances for hold out data of ith fold</p>


<h3>Usage</h3>

<pre><code class='language-R'>msefun.poisson(lambda1,f1,xi,yi)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="msefun.poisson_+3A_lambda1">lambda1</code></td>
<td>
<p>value of lambda</p>
</td></tr>   
<tr><td><code id="msefun.poisson_+3A_f1">f1</code></td>
<td>
<p>A fitted &lsquo;nnlasso&rsquo; object</p>
</td></tr>
<tr><td><code id="msefun.poisson_+3A_xi">xi</code></td>
<td>
<p>Hold out data of predictor variables</p>
</td></tr>
<tr><td><code id="msefun.poisson_+3A_yi">yi</code></td>
<td>
<p>Hold out data of response variables</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is internal and used by cross validation routines.</p>


<h3>Value</h3>

<p>A value of deviance</p>


<h3>Author(s)</h3>

<p>Baidya Nath Mandal and Jun Ma</p>

<hr>
<h2 id='nnlasso'>Entire regularization path of non-negative penalized generalized linear model for normal/binomial/poisson family using multiplicative iterative algorithm</h2><span id='topic+nnlasso'></span>

<h3>Description</h3>

<p>The function computes coefficients of a penalized generalized linear model subject to non-negativity constraints for normal/binomial/poisson family using multiplicative iterative algorithm for a sequence of lambda values. Currently lasso and elastic net penalty are supported.</p>


<h3>Usage</h3>

<pre><code class='language-R'>nnlasso(x,y,family=c("normal","binomial","poisson"),lambda=NULL,
intercept=TRUE,normalize=TRUE,tau=1,tol=1e-6,maxiter=1e5,nstep=100,min.lambda=1e-4,
eps=1e-6,path=TRUE,SE=FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nnlasso_+3A_x">x</code></td>
<td>
<p>x is matrix of order n x p where n is number of observations and p is number of predictor variables. Rows should represent observations and columns should represent predictor variables.</p>
</td></tr>
<tr><td><code id="nnlasso_+3A_y">y</code></td>
<td>
<p>y is a vector of response variable of order n x 1. y should follow either normal/binomial/poisson distribution.</p>
</td></tr>
<tr><td><code id="nnlasso_+3A_family">family</code></td>
<td>
<p>family should be one of these: &quot;normal&quot;,&quot;binomial&quot;,&quot;poisson&quot;</p>
</td></tr>
<tr><td><code id="nnlasso_+3A_lambda">lambda</code></td>
<td>
<p>The value of lambda for which coefficients are desired. The value of path must be FALSE in this case.</p>
</td></tr>
<tr><td><code id="nnlasso_+3A_intercept">intercept</code></td>
<td>
<p>If TRUE, model includes intercept, else the model does not have intercept.</p>
</td></tr>
<tr><td><code id="nnlasso_+3A_normalize">normalize</code></td>
<td>
<p>If TRUE, columns of x matrix are normalized with mean 0 and norm 1 prior to fitting the model. The coefficients at end are returned on the original scale. Default is normalize = TRUE.</p>
</td></tr>
<tr><td><code id="nnlasso_+3A_tau">tau</code></td>
<td>
<p>Elastic net parameter, <code class="reqn">0 \le \tau \le 1</code> in elastic net penalty <code class="reqn">\lambda{\tau||\beta||_1+(1-\tau)||\beta||_2^2}</code>. Default tau = 1 corresponds to LASSO penalty.</p>
</td></tr>
<tr><td><code id="nnlasso_+3A_tol">tol</code></td>
<td>
<p>Tolerance criteria for convergence of solutions. Default is tol = 1e-6.</p>
</td></tr>
<tr><td><code id="nnlasso_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations permissible for solving optimization problem for a particular lambda. Default is 10000. Rarely you need to change this to higher value.</p>
</td></tr>
<tr><td><code id="nnlasso_+3A_nstep">nstep</code></td>
<td>
<p>Number of steps from maximum value of lambda to minimum value of lambda. Default is nstep = 100.</p>
</td></tr>
<tr><td><code id="nnlasso_+3A_min.lambda">min.lambda</code></td>
<td>
<p>Minimum value of lambda. Default is min.lambda=1e-4.</p>
</td></tr>
<tr><td><code id="nnlasso_+3A_eps">eps</code></td>
<td>
<p>A small value below which a coefficient would be considered as zero.</p>
</td></tr>
<tr><td><code id="nnlasso_+3A_path">path</code></td>
<td>
<p>Logical. If path=TRUE, entire regularization path will be obtained for a sequence of lambda values which are calculated automatically. To get coefficient estimates for a single lambda value, set path=FALSE with lambda=value. Default is path=TRUE.</p>
</td></tr>
<tr><td><code id="nnlasso_+3A_se">SE</code></td>
<td>
<p>logical. If SE=TRUE, standard errors are produced for estimated coefficient at a given lambda. Standard errors are not produced if path=TRUE. Default is SE=FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &lsquo;nnlasso&rsquo; with following components:
</p>
<table role = "presentation">
<tr><td><code>beta0</code></td>
<td>
<p>A vector of order nstep of intercept estimates. Each value denote an estimate for a particular lambda. Corresponding lambda values are available in &lsquo;lambdas&rsquo; element of the &lsquo;nnlasso&rsquo; object.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A matrix of order nstep x p of slope estimates. Each row denotes solution for a particular lambda. Corresponding lambda values are available in &lsquo;lambdas&rsquo; element of the &lsquo;nnlasso&rsquo; object. Here p is number of predictor variables.</p>
</td></tr>
<tr><td><code>lambdas</code></td>
<td>
<p>Sequence of lambda values for which coefficients are obtained</p>
</td></tr>
<tr><td><code>L1norm</code></td>
<td>
<p>L1norm of the coefficients</p>
</td></tr>
<tr><td><code>norm.frac</code></td>
<td>
<p>Fractions of norm computed as L1 norm at current lambda divided by maximum L1 norm</p>
</td></tr>
<tr><td><code>lambda.iter</code></td>
<td>
<p>Number of iterations used for different lambdas</p>
</td></tr>
<tr><td><code>of.value</code></td>
<td>
<p>Objective function values</p>
</td></tr>
<tr><td><code>normx</code></td>
<td>
<p>Norm of x variables</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>The standard errors of coefficient estimates</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Baidya Nath Mandal and Jun Ma</p>


<h3>References</h3>

<p>Mandal, B.N. and Ma, J. (2016). L1 regularized multiplicative iterative path algorithm for non-negative generalized linear models.</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Non-negative LASSO
data(car)
attach(car)
x=as.matrix(car[,1:10])
g1=nnlasso(x,y,family="normal")
plot(g1)
plot(g1,xvar="lambda")


#Non-negative Elastic net with same data
## Not run: 
g2=nnlasso(x,y,family="normal",tau=0.6)
plot(g2)
plot(g2,xvar="lambda")

## End(Not run)

#Non-negative Ridge regression with same data
## Not run: 
g3=nnlasso(x,y,family="normal",tau=0)
plot(g3)
plot(g3,xvar="lambda")

## End(Not run)

#Non-negative L1 penalized GLM for binomial family
## Not run: 
g1=nnlasso(x,y1,family="binomial")
plot(g1)
plot(g1,xvar="lambda")

## End(Not run)

#Non-negative Elastic net with GLM with binomial family
## Not run: 
g2=nnlasso(x,y1,family="binomial",tau=0.8)
plot(g2)
plot(g2,xvar="lambda")

## End(Not run)

#coefficient estimates for a particular lambda for normal family
g1=nnlasso(x,y,lambda=0.01,family="normal",path=FALSE,SE=TRUE)
coef(g1)
round(g1$se,3)


#coefficient estimates for a particular lambda for binomial family
## Not run: 
g2=nnlasso(x,y1,lambda=0.01,family="binomial",path=FALSE,SE=TRUE)
coef(g2)
round(g2$se,3)
detach(car)

## End(Not run)
</code></pre>

<hr>
<h2 id='nnlasso.binomial'>Entire regularization path of non-negative penalized generalized linear model for binomial family using using Multiplicative Iterative Algorithm</h2><span id='topic+nnlasso.binomial'></span>

<h3>Description</h3>

<p>The function computes coefficients of a penalized generalized linear model subject to non-negativity constraints for binomial family using Multiplicative Iterative Algorithm for a sequence of lambda values. The function can also be used to obtain coefficient estimates for a given lambda value. Currently lasso and elastic net penalty are supported.</p>


<h3>Usage</h3>

<pre><code class='language-R'>nnlasso.binomial(x,y,lambda=NULL,intercept=TRUE,normalize=TRUE,tau=1,tol=1e-6,
maxiter=1e5,nstep=100,min.lambda=1e-4,eps=1e-6,path=TRUE,SE=FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nnlasso.binomial_+3A_x">x</code></td>
<td>
<p>x is matrix of order n x p where n is number of observations and p is number of predictor variables. Rows should represent observations and columns should represent predictor variables.</p>
</td></tr>
<tr><td><code id="nnlasso.binomial_+3A_y">y</code></td>
<td>
<p>y is a vector of response variable of order n x 1. y should follow binomial distribution and y should be a vector of 0 and 1.</p>
</td></tr>
<tr><td><code id="nnlasso.binomial_+3A_lambda">lambda</code></td>
<td>
<p>The value of lambda for which coefficients are desired. The value of path must be FALSE in this case.</p>
</td></tr>
<tr><td><code id="nnlasso.binomial_+3A_intercept">intercept</code></td>
<td>
<p>If TRUE, model includes intercept, else the model does not have intercept.</p>
</td></tr>
<tr><td><code id="nnlasso.binomial_+3A_normalize">normalize</code></td>
<td>
<p>If TRUE, columns of x matrix are norma	lized with mean 0 and norm 1 prior to fitting the model. The coefficients at end are returned on the original scale. Default is normalize = TRUE.</p>
</td></tr>
<tr><td><code id="nnlasso.binomial_+3A_tau">tau</code></td>
<td>
<p>Elastic net parameter, <code class="reqn">0 \le \tau \le 1</code> in elastic net penalty <code class="reqn">\lambda\{\tau\|\beta\|_1+(1-\tau)\|\beta\|_2^2\}</code>. Default tau = 1 corresponds to LASSO penalty.</p>
</td></tr>
<tr><td><code id="nnlasso.binomial_+3A_tol">tol</code></td>
<td>
<p>Tolerance criteria for convergence of solutions. Default is tol = 1e-6.</p>
</td></tr>
<tr><td><code id="nnlasso.binomial_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations permissible for solving optimization problem for a particular lambda. Default is 10000. Rarely you need to change this to higher value.</p>
</td></tr>
<tr><td><code id="nnlasso.binomial_+3A_nstep">nstep</code></td>
<td>
<p>Number of steps from maximum value of lambda to minimum value of lambda. Default is nstep = 100.</p>
</td></tr>
<tr><td><code id="nnlasso.binomial_+3A_min.lambda">min.lambda</code></td>
<td>
<p>Minimum value of lambda. Default is min.lambda=1e-4.</p>
</td></tr>
<tr><td><code id="nnlasso.binomial_+3A_eps">eps</code></td>
<td>
<p>A small value below which a coefficient would be considered as zero.</p>
</td></tr>
<tr><td><code id="nnlasso.binomial_+3A_path">path</code></td>
<td>
<p>Logical. If path=TRUE, entire regularization path will be obtained for a sequence of lambda values which are calculated automatically. To get coefficient estimates for a single lambda value, set path=FALSE with lambda=value. Default is path=TRUE.</p>
</td></tr>
<tr><td><code id="nnlasso.binomial_+3A_se">SE</code></td>
<td>
<p>logical. If SE=TRUE, standard errors are produced for estimated coefficient at a given lambda. Standard errors are not produced if path=TRUE. Default is SE=FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &lsquo;nnlasso&rsquo; for which plot, predict and coef method exists. The object has following components:
</p>
<table role = "presentation">
<tr><td><code>beta0</code></td>
<td>
<p>A vector of order nstep of intercept estimates. Each value denote an estimate for a particular lambda. Corresponding lambda values are available in &lsquo;lambdas&rsquo; element of the &lsquo;nnlasso&rsquo; object.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A matrix of order nstep x p of slope estimates. Each row denotes solution for a particular lambda. Corresponding lambda values are available in &lsquo;lambdas&rsquo; element of the &lsquo;nnlasso&rsquo; object.</p>
</td></tr>
<tr><td><code>lambdas</code></td>
<td>
<p>Sequence of lambda values for which coefficients are obtained</p>
</td></tr>
<tr><td><code>L1norm</code></td>
<td>
<p>L1norm of the coefficients</p>
</td></tr>
<tr><td><code>norm.frac</code></td>
<td>
<p>Fractions of norm computed as L1 norm at current lambda divided by maximum L1 norm</p>
</td></tr>
<tr><td><code>lambda.iter</code></td>
<td>
<p>Number of iterations used for different lambdas</p>
</td></tr>
<tr><td><code>of.value</code></td>
<td>
<p>Objective function values</p>
</td></tr>
<tr><td><code>normx</code></td>
<td>
<p>Norm of x variables</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>The standard errors of coefficient estimates</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Baidya Nath Mandal and Jun Ma</p>


<h3>References</h3>

<p>Mandal, B.N. and Ma, J. (2016). L1 regularized multiplicative iterative path algorithm for non-negative generalized linear models.</p>

<hr>
<h2 id='nnlasso.binomial.lambda'>Coefficients of non-negative penalized generalized linear models for a given lambda for binomial family</h2><span id='topic+nnlasso.binomial.lambda'></span>

<h3>Description</h3>

<p>The function computes regression coefficients for a penalized generalized linear models subject to non-negativity constraints for a given lambda value for response variable following binomial distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>nnlasso.binomial.lambda(n,p,sumy,beta0.old,beta1.old,x,y
,dxkx0,tau,lambda1,tol,maxiter,xbeta.old,mu1,eps,SE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nnlasso.binomial.lambda_+3A_n">n</code></td>
<td>
<p>Number of observations</p>
</td></tr>
<tr><td><code id="nnlasso.binomial.lambda_+3A_p">p</code></td>
<td>
<p>Number of predictors</p>
</td></tr>  
<tr><td><code id="nnlasso.binomial.lambda_+3A_sumy">sumy</code></td>
<td>
<p>Sum of y values</p>
</td></tr>
<tr><td><code id="nnlasso.binomial.lambda_+3A_beta0.old">beta0.old</code></td>
<td>
<p>Initial value of intercept</p>
</td></tr>
<tr><td><code id="nnlasso.binomial.lambda_+3A_beta1.old">beta1.old</code></td>
<td>
<p>A vector of initial values of slope coefficients</p>
</td></tr>
<tr><td><code id="nnlasso.binomial.lambda_+3A_x">x</code></td>
<td>
<p>A n by p matrix of predictors</p>
</td></tr>
<tr><td><code id="nnlasso.binomial.lambda_+3A_y">y</code></td>
<td>
<p>A vector of n observations</p>
</td></tr>
<tr><td><code id="nnlasso.binomial.lambda_+3A_dxkx0">dxkx0</code></td>
<td>
<p>In case of a model with intercept, first diagonal of X'X</p>
</td></tr>
<tr><td><code id="nnlasso.binomial.lambda_+3A_tau">tau</code></td>
<td>
<p>Elastic net paramter. Default is 1</p>
</td></tr>
<tr><td><code id="nnlasso.binomial.lambda_+3A_lambda1">lambda1</code></td>
<td>
<p>The value of lambda</p>
</td></tr>
<tr><td><code id="nnlasso.binomial.lambda_+3A_tol">tol</code></td>
<td>
<p>Tolerance criterion. Default is 10^-6</p>
</td></tr>
<tr><td><code id="nnlasso.binomial.lambda_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations. Default is 10000</p>
</td></tr>
<tr><td><code id="nnlasso.binomial.lambda_+3A_xbeta.old">xbeta.old</code></td>
<td>
<p>A n by 1 vector of xbeta values</p>
</td></tr>
<tr><td><code id="nnlasso.binomial.lambda_+3A_mu1">mu1</code></td>
<td>
<p>The value of mu at beta.old</p>
</td></tr>	
<tr><td><code id="nnlasso.binomial.lambda_+3A_eps">eps</code></td>
<td>
<p>A small value below which a coefficient would be considered as zero. Default is eps=1e-6</p>
</td></tr>
<tr><td><code id="nnlasso.binomial.lambda_+3A_se">SE</code></td>
<td>
<p>Logical. If SE=TRUE, standard errors of the coefficients will be produced. Default is SE=FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is internal and used by nnlasso.binomial function. User need not call this function.</p>


<h3>Value</h3>

<p>A list with following components
</p>
<table role = "presentation">
<tr><td><code>beta0.new</code></td>
<td>
<p>Intercept estimate</p>
</td></tr>
<tr><td><code>beta1.new</code></td>
<td>
<p>Slope coefficient estimates</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p>&quot;yes&quot; means converged and &quot;no&quot; means did not converge</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations to estimate the coefficients</p>
</td></tr>
<tr><td><code>ofv.new</code></td>
<td>
<p>Objective function value at solution</p>
</td></tr>
<tr><td><code>xbeta.new</code></td>
<td>
<p>xbeta values at solution</p>
</td></tr>
<tr><td><code>mu1</code></td>
<td>
<p>Value of mu at solution</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>Variance-covariance matrix of the coefficient estimates</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Baidya Nath Mandal and Jun Ma</p>

<hr>
<h2 id='nnlasso.normal'>Entire regularization path of non-negative penalized generalized linear model for normal family using Multiplicative Iterative Algorithm</h2><span id='topic+nnlasso.normal'></span>

<h3>Description</h3>

<p>The function computes coefficients of a penalized generalized linear model subject to non-negativity constraint for normal family using Multiplicative Iterative Algorithm for a sequence of lambda values or alternatively for a single lambda value. Currently lasso and elastic net penalty are supported.</p>


<h3>Usage</h3>

<pre><code class='language-R'>nnlasso.normal(x,y,lambda=NULL, intercept=TRUE,normalize=TRUE,tau=
1,tol=1e-6,maxiter=1e5,nstep=100,min.lambda=1e-4,eps=1e-6,path=TRUE,SE=FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nnlasso.normal_+3A_x">x</code></td>
<td>
<p>x is matrix of order n x p where n is number of observations and p is number of predictor variables. Rows should represent observations and columns should represent predictor variables.</p>
</td></tr>
<tr><td><code id="nnlasso.normal_+3A_y">y</code></td>
<td>
<p>y is a vector of response variable of order n x 1. y should follow normal distribution.</p>
</td></tr>
<tr><td><code id="nnlasso.normal_+3A_lambda">lambda</code></td>
<td>
<p>The value of lambda for which coefficients are desired. The value of path must be FALSE in this case.</p>
</td></tr>
<tr><td><code id="nnlasso.normal_+3A_intercept">intercept</code></td>
<td>
<p>If TRUE, model includes intercept, else the model does not have intercept.</p>
</td></tr>
<tr><td><code id="nnlasso.normal_+3A_normalize">normalize</code></td>
<td>
<p>If TRUE, columns of x matrix are normalized with mean 0 and norm 1 prior to fitting the model. The coefficients at end are returned on the original scale. Default is normalize = TRUE.</p>
</td></tr>
<tr><td><code id="nnlasso.normal_+3A_tau">tau</code></td>
<td>
<p>Elastic net parameter, <code class="reqn">0 \le \tau \le 1</code> in elastic net penalty <code class="reqn">\lambda\{\tau\|\beta\|_1+(1-\tau)\|\beta\|_2^2\}</code>. Default tau = 1 corresponds to LASSO penalty.</p>
</td></tr>
<tr><td><code id="nnlasso.normal_+3A_tol">tol</code></td>
<td>
<p>Tolerance criteria for convergence of solutions. Default is tol = 1e-6.</p>
</td></tr>
<tr><td><code id="nnlasso.normal_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations permissible for solving optimization problem for a particular lambda. Default is 10000. Rarely you need to change this to higher value.</p>
</td></tr>
<tr><td><code id="nnlasso.normal_+3A_nstep">nstep</code></td>
<td>
<p>Number of steps from maximum value of lambda to minimum value of lambda. Default is nstep = 100.</p>
</td></tr>
<tr><td><code id="nnlasso.normal_+3A_min.lambda">min.lambda</code></td>
<td>
<p>Minimum value of lambda. Default is min.lambda=1e-4.</p>
</td></tr>
<tr><td><code id="nnlasso.normal_+3A_eps">eps</code></td>
<td>
<p>A small value below which a coefficient would be considered as zero.</p>
</td></tr>
<tr><td><code id="nnlasso.normal_+3A_path">path</code></td>
<td>
<p>Logical. If path=TRUE, entire regularization path will be obtained for a sequence of lambda values which are calculated automatically. To get coefficient estimates for a single lambda value, set path=FALSE with lambda=value. Default is path=TRUE.</p>
</td></tr>
<tr><td><code id="nnlasso.normal_+3A_se">SE</code></td>
<td>
<p>logical. If SE=TRUE, standard errors are produced for estimated coefficient at a given lambda. Standard errors are not produced if path=TRUE. Default is SE=FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &lsquo;nnlasso&rsquo; for which plot, predict and coef method exists. The object has following components:
</p>
<table role = "presentation">
<tr><td><code>beta0</code></td>
<td>
<p>A vector of order nstep of intercept estimates. Each value denote an estimate for a particular lambda. Corresponding lambda values are available in &lsquo;lambdas&rsquo; element of the &lsquo;nnlasso&rsquo; object.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A matrix of order nstep x p. Each row denotes solution for a particular lambda. Corresponding lambda values are available in &lsquo;lambdas&rsquo; element of the &lsquo;nnlasso&rsquo; object. Here p is number of predictor variables.</p>
</td></tr>
<tr><td><code>lambdas</code></td>
<td>
<p>Sequence of lambda values for which coefficients are obtained</p>
</td></tr>
<tr><td><code>L1norm</code></td>
<td>
<p>L1norm of the coefficients</p>
</td></tr>
<tr><td><code>norm.frac</code></td>
<td>
<p>Fractions of norm computed as L1 norm at current lambda divided by maximum L1 norm</p>
</td></tr>
<tr><td><code>lambda.iter</code></td>
<td>
<p>Number of iterations used for different lambdas</p>
</td></tr>
<tr><td><code>of.value</code></td>
<td>
<p>Objective function values</p>
</td></tr>
<tr><td><code>normx</code></td>
<td>
<p>Norm of x variables</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>The standard errors of coefficient estimates</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Baidya Nath Mandal and Jun Ma</p>


<h3>References</h3>

<p>Mandal, B.N. and Ma, J. (2016). L1 regularized multiplicative iterative path algorithm for non-negative generalized linear models.</p>

<hr>
<h2 id='nnlasso.normal.lambda'>Coefficients of non-negative penalized generalized linear models for a given lambda for normal family</h2><span id='topic+nnlasso.normal.lambda'></span>

<h3>Description</h3>

<p>The function computes regression coefficients for a penalized generalized linear models subject to non-negativity constraints for a given lambda value for response variable following normal distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>nnlasso.normal.lambda(n,p,x,y,xpx,xpy,beta.old,tau,
lambda1,tol,maxiter,xbeta.old,eps,SE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nnlasso.normal.lambda_+3A_n">n</code></td>
<td>
<p>Number of observations</p>
</td></tr>
<tr><td><code id="nnlasso.normal.lambda_+3A_p">p</code></td>
<td>
<p>Number of predictors.</p>
</td></tr>  
<tr><td><code id="nnlasso.normal.lambda_+3A_x">x</code></td>
<td>
<p>A n by p1 matrix of predictors.</p>
</td></tr>
<tr><td><code id="nnlasso.normal.lambda_+3A_y">y</code></td>
<td>
<p>A vector of n observations.</p>
</td></tr>
<tr><td><code id="nnlasso.normal.lambda_+3A_xpx">xpx</code></td>
<td>
<p>Matrix X'X</p>
</td></tr>
<tr><td><code id="nnlasso.normal.lambda_+3A_xpy">xpy</code></td>
<td>
<p>Vector X'y</p>
</td></tr>
<tr><td><code id="nnlasso.normal.lambda_+3A_beta.old">beta.old</code></td>
<td>
<p>A vector of initial values of beta.</p>
</td></tr>
<tr><td><code id="nnlasso.normal.lambda_+3A_tau">tau</code></td>
<td>
<p>Elastic net paramter. Default is 1</p>
</td></tr>
<tr><td><code id="nnlasso.normal.lambda_+3A_lambda1">lambda1</code></td>
<td>
<p>The value of lambda</p>
</td></tr> 
<tr><td><code id="nnlasso.normal.lambda_+3A_tol">tol</code></td>
<td>
<p>Tolerance criterion. Default is 10^-6</p>
</td></tr>
<tr><td><code id="nnlasso.normal.lambda_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations. Default is 10000.</p>
</td></tr>
<tr><td><code id="nnlasso.normal.lambda_+3A_xbeta.old">xbeta.old</code></td>
<td>
<p>A n by 1 vector of xbeta values.</p>
</td></tr>
<tr><td><code id="nnlasso.normal.lambda_+3A_eps">eps</code></td>
<td>
<p>A small value below which a coefficient would be considered as zero. Default is eps=1e-6</p>
</td></tr>
<tr><td><code id="nnlasso.normal.lambda_+3A_se">SE</code></td>
<td>
<p>Logical. If SE=TRUE, standard errors of the coefficients will be produced. Default is SE=FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is internal and used by nnlasso.normal function. User need not call this function.</p>


<h3>Value</h3>

<p>A list with following components
</p>
<table role = "presentation">
<tr><td><code>beta.new</code></td>
<td>
<p>Coefficient estimates</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p>&quot;yes&quot; means converged and &quot;no&quot; means did not converge</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations to estimate the coefficients</p>
</td></tr>
<tr><td><code>ofv.new</code></td>
<td>
<p>Objective function value at solution</p>
</td></tr>
<tr><td><code>xbeta.new</code></td>
<td>
<p>xbeta values at solution</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>Variance-covariance matrix of the coefficient estimates</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Baidya Nath Mandal and Jun Ma</p>

<hr>
<h2 id='nnlasso.poisson'>Entire regularization path of non-negative penalized generalized linear model for poisson family using multiplicative iterative algorithm</h2><span id='topic+nnlasso.poisson'></span>

<h3>Description</h3>

<p>The function computes coefficients of a penalized generalized linear model subject to non-negativity constraints for poisson family using multiplicative iterative algorithm for a sequence of lambda values. Currently lasso and elastic net penalty are supported.</p>


<h3>Usage</h3>

<pre><code class='language-R'>nnlasso.poisson(x,y,lambda=NULL,intercept=TRUE,normalize=TRUE,tau=
1,tol=1e-6,maxiter=1e5,nstep=100,min.lambda=1e-4,eps=1e-6,path=TRUE,SE=FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nnlasso.poisson_+3A_x">x</code></td>
<td>
<p>x is matrix of order n x p where n is number of observations and p is number of predictor variables. Rows should represent observations and columns should represent predictor variables.</p>
</td></tr>
<tr><td><code id="nnlasso.poisson_+3A_y">y</code></td>
<td>
<p>y is a vector of response variable of order n x 1. y should follow poisson distribution and y should be a vector of counts.</p>
</td></tr>
<tr><td><code id="nnlasso.poisson_+3A_lambda">lambda</code></td>
<td>
<p>The value of lambda for which coefficients are desired. The value of path must be FALSE in this case.</p>
</td></tr>
<tr><td><code id="nnlasso.poisson_+3A_intercept">intercept</code></td>
<td>
<p>If TRUE, model includes intercept, else the model does not have intercept.</p>
</td></tr>
<tr><td><code id="nnlasso.poisson_+3A_normalize">normalize</code></td>
<td>
<p>If TRUE, columns of x matrix are normalized with mean 0 and norm 1 prior to fitting the model. The coefficients at end are returned on the original scale. Default is normalize = TRUE.</p>
</td></tr>
<tr><td><code id="nnlasso.poisson_+3A_tau">tau</code></td>
<td>
<p>Elastic net parameter, <code class="reqn">0 \le \tau \le 1</code> in elastic net penalty <code class="reqn">\lambda\{\tau\|\beta\|_1+(1-\tau)\|\beta\|_2^2\}</code>. Default tau = 1 corresponds to LASSO penalty.</p>
</td></tr>
<tr><td><code id="nnlasso.poisson_+3A_tol">tol</code></td>
<td>
<p>Tolerance criteria for convergence of solutions. Default is tol = 1e-6.</p>
</td></tr>
<tr><td><code id="nnlasso.poisson_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations permissible for solving optimization problem for a particular lambda. Default is 10000. Rarely you need to change this to higher value.</p>
</td></tr>
<tr><td><code id="nnlasso.poisson_+3A_nstep">nstep</code></td>
<td>
<p>Number of steps from maximum value of lambda to minimum value of lambda. Default is nstep = 100.</p>
</td></tr>
<tr><td><code id="nnlasso.poisson_+3A_min.lambda">min.lambda</code></td>
<td>
<p>Minimum value of lambda. Default is min.lambda=1e-4.</p>
</td></tr>
<tr><td><code id="nnlasso.poisson_+3A_eps">eps</code></td>
<td>
<p>A small value below which a coefficient would be considered as zero.</p>
</td></tr>
<tr><td><code id="nnlasso.poisson_+3A_path">path</code></td>
<td>
<p>Logical. If path=TRUE, entire regularization path will be obtained for a sequence of lambda values which are calculated automatically. To get coefficient estimates for a single lambda value, set path=FALSE with lambda=value. Default is path=TRUE.</p>
</td></tr>
<tr><td><code id="nnlasso.poisson_+3A_se">SE</code></td>
<td>
<p>logical. If SE=TRUE, standard errors are produced for estimated coefficient at a given lambda. Standard errors are not produced if path=TRUE. Default is SE=FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &lsquo;nnlasso&rsquo; for which plot, predict and coef method exists. The object has following components:
</p>
<table role = "presentation">
<tr><td><code>beta0</code></td>
<td>
<p>A vector of order nstep of intercept estimates. Each value denote an estimate for a particular lambda. Corresponding lambda values are available in &lsquo;lambdas&rsquo; element of the &lsquo;nnlasso&rsquo; object.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A matrix of order nstep x p of slope coefficients. Each row denote solution for a particular lambda. Corresponding lambda values are available in &lsquo;lambdas&rsquo; element of the &lsquo;nnlasso&rsquo; object.</p>
</td></tr>
<tr><td><code>lambdas</code></td>
<td>
<p>Sequence of lambda values for which coefficients are obtained</p>
</td></tr>
<tr><td><code>L1norm</code></td>
<td>
<p>L1norm of the coefficients</p>
</td></tr>
<tr><td><code>norm.frac</code></td>
<td>
<p>Fractions of norm computed as L1 norm at current lambda divided by maximum L1 norm</p>
</td></tr>
<tr><td><code>lambda.iter</code></td>
<td>
<p>Number of iterations used for different lambdas</p>
</td></tr>
<tr><td><code>of.value</code></td>
<td>
<p>Objective function values</p>
</td></tr>
<tr><td><code>normx</code></td>
<td>
<p>Norm of x variables</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>The standard errors of coefficient estimates</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Baidya Nath Mandal and Jun Ma</p>


<h3>References</h3>

<p>Mandal, B.N. and Ma, J. (2016). L1 regularized multiplicative iterative path algorithm for non-negative generalized linear models.</p>

<hr>
<h2 id='nnlasso.poisson.lambda'>Coefficients of non-negative penalized generalized linear models for a given lambda for Poisson family</h2><span id='topic+nnlasso.poisson.lambda'></span>

<h3>Description</h3>

<p>The function computes regression coefficients for a penalized generalized linear models subject to non-negativity constraints for a given lambda value for response variable following Poisson distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>nnlasso.poisson.lambda(n,p,sumy,beta0.old,beta1.old,
x,y,dxkx0,tau,lambda1,tol,maxiter,xbeta.old,mu1,eps,SE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nnlasso.poisson.lambda_+3A_n">n</code></td>
<td>
<p>Number of observations</p>
</td></tr>
<tr><td><code id="nnlasso.poisson.lambda_+3A_p">p</code></td>
<td>
<p>Number of predictors</p>
</td></tr>  
<tr><td><code id="nnlasso.poisson.lambda_+3A_sumy">sumy</code></td>
<td>
<p>Sum of y values</p>
</td></tr>
<tr><td><code id="nnlasso.poisson.lambda_+3A_beta0.old">beta0.old</code></td>
<td>
<p>Initial value of intercept</p>
</td></tr>
<tr><td><code id="nnlasso.poisson.lambda_+3A_beta1.old">beta1.old</code></td>
<td>
<p>A vector of initial values of slope coefficients</p>
</td></tr>
<tr><td><code id="nnlasso.poisson.lambda_+3A_x">x</code></td>
<td>
<p>A n by p1 matrix of predictors</p>
</td></tr>
<tr><td><code id="nnlasso.poisson.lambda_+3A_y">y</code></td>
<td>
<p>A vector of n observations</p>
</td></tr>
<tr><td><code id="nnlasso.poisson.lambda_+3A_dxkx0">dxkx0</code></td>
<td>
<p>In case of a model with intercept, first diagonal of X'X</p>
</td></tr>
<tr><td><code id="nnlasso.poisson.lambda_+3A_tau">tau</code></td>
<td>
<p>Elastic net paramter. Default is 1</p>
</td></tr>
<tr><td><code id="nnlasso.poisson.lambda_+3A_lambda1">lambda1</code></td>
<td>
<p>The value of lambda</p>
</td></tr>
<tr><td><code id="nnlasso.poisson.lambda_+3A_tol">tol</code></td>
<td>
<p>Tolerance criterion. Default is 10^-6</p>
</td></tr>
<tr><td><code id="nnlasso.poisson.lambda_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations. Default is 10000</p>
</td></tr>
<tr><td><code id="nnlasso.poisson.lambda_+3A_xbeta.old">xbeta.old</code></td>
<td>
<p>A n by 1 vector of xbeta values</p>
</td></tr>
<tr><td><code id="nnlasso.poisson.lambda_+3A_mu1">mu1</code></td>
<td>
<p>The value of mu at beta.old</p>
</td></tr>
<tr><td><code id="nnlasso.poisson.lambda_+3A_eps">eps</code></td>
<td>
<p>A small value below which a coefficient would be considered as zero. Default is eps=1e-6</p>
</td></tr>
<tr><td><code id="nnlasso.poisson.lambda_+3A_se">SE</code></td>
<td>
<p>Logical. If SE=TRUE, standard errors of the coefficients will be produced. Default is SE=FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is internal and used by nnlasso.poisson function. User need not call this function.</p>


<h3>Value</h3>

<p>A list with following components
</p>
<table role = "presentation">
<tr><td><code>beta0.new</code></td>
<td>
<p>Intercept estimate</p>
</td></tr>
<tr><td><code>beta1.new</code></td>
<td>
<p>Slope coefficient estimates</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p>&quot;yes&quot; means converged and &quot;no&quot; means did not converge</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations to estimate the coefficients</p>
</td></tr>
<tr><td><code>ofv.new</code></td>
<td>
<p>Objective function value at solution</p>
</td></tr>
<tr><td><code>xbeta.new</code></td>
<td>
<p>xbeta values at solution</p>
</td></tr>
<tr><td><code>mu1</code></td>
<td>
<p>Value of mu at solution</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>Variance-covariance matrix of the coefficient estimates</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Baidya Nath Mandal and Jun Ma</p>

<hr>
<h2 id='plot.nnlasso'>Plot of regularization path</h2><span id='topic+plot.nnlasso'></span>

<h3>Description</h3>

<p>Produces a plot of entire regularization path from a 'nnlasso' object obtained using &lsquo;nnlasso&rsquo; function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nnlasso'
plot(x,xvar=c("lambda","L1norm","fraction of norm"),...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.nnlasso_+3A_x">x</code></td>
<td>
<p>A &lsquo;nnlasso&rsquo; object obtained using &lsquo;nnlasso&rsquo; function.</p>
</td></tr>
<tr><td><code id="plot.nnlasso_+3A_xvar">xvar</code></td>
<td>
<p>What should be on x-axis? xvar=&quot;lambda&quot; produces a plot of regularization path with respect to lambda, xvar=&quot;L1norm&quot; produces a plot of regularization path with respect to L1 norm of coefficients and xvar=&quot;fraction of norm&quot; produces a plot of regularization path with respect to fraction of norm of coefficients. Default is xvar=&quot;L1norm&quot;.</p>
</td></tr>
<tr><td><code id="plot.nnlasso_+3A_...">...</code></td>
<td>
<p>Optional graphical parameters to matplot() function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of regularization path is produced.</p>


<h3>Author(s)</h3>

<p>Baidya Nath Mandal and Jun Ma</p>


<h3>References</h3>

<p>Mandal, B.N. and Ma, J. (2016). L1 regularized multiplicative iterative path algorithm for non-negative generalized linear models.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(car)
attach(car)
x=as.matrix(car[,1:10])
g1=nnlasso(x,y,family="normal")
plot(g1)
plot(g1,xvar="lambda")
g1=nnlasso(x,y1,family="binomial")
plot(g1)
plot(g1,xvar="lambda")
detach(car)
</code></pre>

<hr>
<h2 id='predict.nnlasso'>Prediction of coefficients of a penalized linear regression or generalized linear models</h2><span id='topic+predict.nnlasso'></span>

<h3>Description</h3>

<p>The function computes estimated coefficients value at a given lambda or L1 norm or fraction of norm using a &lsquo;nnlasso&rsquo; object obtained using &lsquo;nnlasso&rsquo; function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nnlasso'
predict(object,mode=c("fraction","norm","lambda"),at=0,...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.nnlasso_+3A_object">object</code></td>
<td>
<p>A &lsquo;nnlasso&rsquo; object obtained using &lsquo;nnlasso&rsquo; function.</p>
</td></tr>
<tr><td><code id="predict.nnlasso_+3A_mode">mode</code></td>
<td>
<p>If mode=&quot;lambda&quot;, prediction is made for a given lambda, if mode=&quot;norm&quot;, prediction is made for a given L1 norm and if mode=&quot;fraction&quot;, prediction is made for a fraction of norm value. Default is mode=&quot;lambda&quot;</p>
</td></tr>
<tr><td><code id="predict.nnlasso_+3A_at">at</code></td>
<td>
<p>A value at which prediction is to be made. Default is at = 0.</p>
</td></tr>
<tr><td><code id="predict.nnlasso_+3A_...">...</code></td>
<td>
<p>Not used. Other arguments to predict.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of estimated coefficients of length p or p+1 at the given value of lambda or L1 norm or fraction of norm, depending on intercept=TRUE or FALSE in &lsquo;nnlasso&rsquo; object. Here p is number of predictor variables.</p>


<h3>Author(s)</h3>

<p>Baidya Nath Mandal and Jun Ma</p>


<h3>References</h3>

<p>Mandal, B.N. and Ma, J. (2016). L1 regularized multiplicative iterative path algorithm for non-negative generalized linear models.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(car)
attach(car)
x=as.matrix(car[,1:10])
g1=nnlasso(x,y1,family="binomial")
predict(g1,mode="lambda",at=0.1)
predict(g1,mode="L1norm",at=1)
predict(g1,mode="fraction",at=0.5)
g1=nnlasso(x,y,family="normal")
predict(g1,mode="lambda",at=0.09)
predict(g1,mode="L1norm",at=0.6)
predict(g1,mode="fraction",at=0.8)
detach(car)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
