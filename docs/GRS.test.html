<!DOCTYPE html><html lang="en"><head><title>Help for package GRS.test</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GRS.test}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#GRS.test-package'>
<p>GRS Test for Portfolio Efficiency, Its Statistical Power Analysis, and Optimal Significance Level Calculation</p></a></li>
<li><a href='#data'>
<p>Fama-French Data: 25 size-B/M portfolio and risk factors, obtained from French's library</p></a></li>
<li><a href='#GRS.MLtest'>
<p>GRS Test Statistic and p-value based on Maximum Likelihood Estimator for Covariance matrix</p></a></li>
<li><a href='#GRS.optimal'>
<p>Optimal Level of Significance for the GRS test: Normality Assumption</p></a></li>
<li><a href='#GRS.optimalboot'>
<p>Optimal Level of Significance for the GRS test: Bootstrapping</p></a></li>
<li><a href='#GRS.optimalbootweight'>
<p>Weighted Optimal Level of Significance for the GRS test: Bootstrapping</p></a></li>
<li><a href='#GRS.optimalweight'>
<p>Weighted Optimal Level of Significance for the GRS test: Normality Assumption</p></a></li>
<li><a href='#GRS.Power'>
<p>Statistical Power of the GRS test</p></a></li>
<li><a href='#GRS.Powerfunc'>
<p>Power functions for the GRS test</p></a></li>
<li><a href='#GRS.T'>
<p>Sample Size Selection for the GRS test</p></a></li>
<li><a href='#GRS.test'>
<p>GRS test and Model Estimation Results</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>GRS Test for Portfolio Efficiency, Its Statistical Power
Analysis, and Optimal Significance Level Calculation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-29</td>
</tr>
<tr>
<td>Author:</td>
<td>Jae H. Kim &lt;jaekim8080@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jae H. Kim &lt;jaekim8080@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Computational resources for test proposed by Gibbons, Ross, Shanken (1989)&lt;<a href="https://doi.org/10.2307%2F1913625">doi:10.2307/1913625</a>&gt;.
	It also has the functions for the power analysis and the choice of the optimal level of significance.
	The optimal level is determined by minimizing the expected loss from hypothesis testing. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-30 10:07:01 UTC; jh808</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-07-01 21:30:21 UTC</td>
</tr>
</table>
<hr>
<h2 id='GRS.test-package'>
GRS Test for Portfolio Efficiency, Its Statistical Power Analysis, and Optimal Significance Level Calculation
</h2><span id='topic+GRS.test-package'></span>

<h3>Description</h3>

<p>Computational resources for test proposed by Gibbons, Ross, Shanken (1989)&lt;DOI:10.2307/1913625&gt;.
	It also has the functions for the power analysis and the choice of the optimal level of significance.
	The optimal level is determined by minimizing the expected loss from hypothesis testing. 
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> GRS.test</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> GRS Test for Portfolio Efficiency, Its Statistical Power Analysis, and Optimal Significance Level Calculation</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2022-06-29</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Jae H. Kim &lt;jaekim8080@gmail.com&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Jae H. Kim &lt;jaekim8080@gmail.com&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Computational resources for test proposed by Gibbons, Ross, Shanken (1989)&lt;DOI:10.2307/1913625&gt;.
	It also has the functions for the power analysis and the choice of the optimal level of significance.
	The optimal level is determined by minimizing the expected loss from hypothesis testing. </td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
GRS.MLtest              GRS Test Statistic and p-value based on Maximum
                        Likelihood Estimator for Covariance matrix
GRS.Power               Statistical Power of the GRS test
GRS.Powerfunc           Power functions for the GRS test
GRS.T                   Sample Size Selection for the GRS test
GRS.optimal             Optimal Level of Significance for the GRS test:
                        Normality Assumption
GRS.optimalboot         Optimal Level of Significance for the GRS test:
                        Bootstrapping
GRS.optimalbootweight   Weighted Optimal Level of Significance for the
                        GRS test: Bootstrapping
GRS.optimalweight       Weighted Optimal Level of Significance for the
                        GRS test: Normality Assumption
GRS.test                GRS test and Model Estimation Results
GRS.test-package        GRS Test for Portfolio Efficiency, Its
                        Statistical Power Analysis, and Optimal
                        Significance Level Calculation
data                    Fama-French Data: 25 size-B/M portfolio and
                        risk factors, obtained from French's library
</pre>
<p>The package accompanies the working paper:
</p>
<p>Kim and Shamsuddin, 2017, Empirical Validity of Asset-pricing Models: Application of Optimal Significance Level and Equal Probability Test
</p>
<p>The function GRS.test returns the GRS test statistics with model estimation results.
</p>
<p>The function GRS.MLtest provides an alternative test statistic with theta and theta* estimation results. 
</p>
<p>Additional functions for the power analysis and calculation of optimal level of significance are also included.
</p>


<h3>Author(s)</h3>

<p>Jae H. Kim &lt;jaekim8080@gmail.com&gt;
</p>
<p>Maintainer: Jae H. Kim &lt;jaekim8080@gmail.com&gt;
</p>


<h3>References</h3>

<p>Gibbons, Ross, Shanken, 1989. A test of the efficiency of a given portfolio, Econometrica, 57,1121-1152.
&lt;DOI:10.2307/1913625&gt;
</p>
<p>Fama and French, 1993, Common risk factors in the returns on stocks and bonds, Journal of Financial Economics, 33, 3-56.
&lt;DOI:10.1016/0304-405X(93)90023-5&gt;
</p>
<p>Fama and French, 2015, A five-factor asset-pricing model, Journal of Financial Economics, 1-22.
&lt;DOI:http://dx.doi.org/10.1016/j.jfineco.2014.10.010&gt;
</p>


<h3>See Also</h3>

<p>The examples replicate the results reported in Fama and French (1993) and Kim and Shamsuddin (2016) 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data)
factor.mat = data[1:342,2:4]            # Fama-French 3-factor model
ret.mat = data[1:342,8:ncol(data)]      # 25 size-BM portfolio returns
GRS.test(ret.mat,factor.mat)$GRS.stat   # Table 9C of Fama-French (1993)
</code></pre>

<hr>
<h2 id='data'>
Fama-French Data: 25 size-B/M portfolio and risk factors, obtained from French's library
</h2><span id='topic+data'></span>

<h3>Description</h3>

<p>http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("data")</code></pre>


<h3>Format</h3>

<p>A data frame with 630 observations on the following 32 variables.
</p>

<dl>
<dt><code>date</code></dt><dd><p>date</p>
</dd>
<dt><code>RM_RF</code></dt><dd><p>Market Excess Return</p>
</dd>
<dt><code>SMB</code></dt><dd><p>SMB</p>
</dd>
<dt><code>HML</code></dt><dd><p>HML</p>
</dd>
<dt><code>RMW</code></dt><dd><p>RMW</p>
</dd>
<dt><code>CMA</code></dt><dd><p>CMA</p>
</dd>
<dt><code>MOM</code></dt><dd><p>MOM</p>
</dd>
<dt><code>P11</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P12</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P13</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P14</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P15</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P21</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P22</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P23</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P24</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P25</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P31</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P32</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P33</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P34</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P35</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P41</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P42</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P43</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P44</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P45</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P51</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P52</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P53</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P54</code></dt><dd><p>Portfolio Returns</p>
</dd>
<dt><code>P55</code></dt><dd><p>Portfolio Returns</p>
</dd>
</dl>



<h3>Details</h3>

<p>http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html
</p>


<h3>Source</h3>

<p>http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html
</p>
<p>Monthly from 1963 to 2015
</p>


<h3>References</h3>

<p>Fama and French, 1993, Common risk factors in the returns on stocks and bonds, Journal of Financial Economics, 33, 3-56.
&lt;DOI:10.1016/0304-405X(93)90023-5&gt;
</p>
<p>Fama and French, 2015, A five-factor asset-pricing model, Journal of Financial Economics, 116-1-22.
&lt;DOI:http://dx.doi.org/10.1016/j.jfineco.2014.10.010&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data)
y=ts(data[,2],frequency=12,start=c(1950,1))
plot.ts(y)
</code></pre>

<hr>
<h2 id='GRS.MLtest'>
GRS Test Statistic and p-value based on Maximum Likelihood Estimator for Covariance matrix
</h2><span id='topic+GRS.MLtest'></span>

<h3>Description</h3>

<p>W statistic given in (7) of GRS (1989) &lt;DOI:10.2307/1913625&gt;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GRS.MLtest(ret.mat, factor.mat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GRS.MLtest_+3A_ret.mat">ret.mat</code></td>
<td>
<p> portfolio return matrix, T by N </p>
</td></tr>
<tr><td><code id="GRS.MLtest_+3A_factor.mat">factor.mat</code></td>
<td>
<p> matrix of risk factors, T by K </p>
</td></tr>
</table>


<h3>Details</h3>

<p>T: sample size, N: number of portfolio returns, K: number of risk factors</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>GRS.stat</code></td>
<td>
<p>GRS test statistic</p>
</td></tr>
<tr><td><code>GRS.pval</code></td>
<td>
<p>its p-value</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p> maximum Sharpe ratio of the K factor portfolios</p>
</td></tr>
<tr><td><code>thetas</code></td>
<td>
<p>slope of the efficient frontier based on all assets</p>
</td></tr>
<tr><td><code>ratio</code></td>
<td>
<p>theta/thetas, proportion of the potential efficiency</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Applicable to CAPM as well as a multi-factor model
</p>


<h3>Author(s)</h3>

<p>Jae H. Kim
</p>


<h3>References</h3>

<p>Gibbons, Ross, Shanken, 1989. A test of the efficiency of a given portfolio, Econometrica, 57,1121-1152.
&lt;DOI:10.2307/1913625&gt;
</p>


<h3>See Also</h3>

<p>Fama and French, 1993, Common risk factors in the returns on stocks and bonds, Journal of Financial Economics, 33, 3-56.
&lt;DOI:10.1016/0304-405X(93)90023-5&gt;
</p>
<p>Fama and French, 2015, A five-factor asset-pricing model, Journal of Financial Economics, 116-1-22.
&lt;DOI:http://dx.doi.org/10.1016/j.jfineco.2014.10.010&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data)
factor.mat = data[1:342,2:4]            # Fama-French 3-factor model
ret.mat = data[1:342,8:ncol(data)]      # 25 size-BM portfolio returns
GRS.MLtest(ret.mat,factor.mat)          # See column (iv), Table 9C of Fama-French (1993)

</code></pre>

<hr>
<h2 id='GRS.optimal'>
Optimal Level of Significance for the GRS test: Normality Assumption
</h2><span id='topic+GRS.optimal'></span>

<h3>Description</h3>

<p>The optimal level is calculated by minimizing expected loss from hypothesis testing
</p>
<p>The F-distributions are used to calculate the power, under the normality assumption
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GRS.optimal(T, N, K, theta, ratio, p = 0.5, k = 1, Graph = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GRS.optimal_+3A_t">T</code></td>
<td>
<p> sample size </p>
</td></tr>
<tr><td><code id="GRS.optimal_+3A_n">N</code></td>
<td>
<p> the number of portfolio returns</p>
</td></tr>
<tr><td><code id="GRS.optimal_+3A_k">K</code></td>
<td>
<p> the number of risk factors </p>
</td></tr>
<tr><td><code id="GRS.optimal_+3A_theta">theta</code></td>
<td>
<p> maximum Sharpe ratio of the K factor portfolios</p>
</td></tr>
<tr><td><code id="GRS.optimal_+3A_ratio">ratio</code></td>
<td>
<p> theta/thetas, proportion of the potential efficiency </p>
</td></tr>
<tr><td><code id="GRS.optimal_+3A_p">p</code></td>
<td>
<p> prior probability for H0, default is p = 0.5</p>
</td></tr>
<tr><td><code id="GRS.optimal_+3A_k">k</code></td>
<td>
<p> relative loss, k = L2/L1, default is k = 1</p>
</td></tr>
<tr><td><code id="GRS.optimal_+3A_graph">Graph</code></td>
<td>
<p> show graph if TRUE. No graph otherwise </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the power calculation of the GRS test, as in GRS (1989) &lt;DOI:10.2307/1913625&gt;.
</p>
<p>The blue square in the plot is the point where the expected loss is mimimized.
</p>
<p>The red horizontal line in the plot indicates the point of the covnentional level of significance (alpha = 0.05).
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>opt.sig</code></td>
<td>
<p>Optimal level of significance</p>
</td></tr>
<tr><td><code>opt.crit</code></td>
<td>
<p>Critical value corresponding to opt.sig</p>
</td></tr>
<tr><td><code>opt.beta</code></td>
<td>
<p>Type II error probability corresponding to opt.sig</p>
</td></tr>
</table>


<h3>Note</h3>

<p>ratio = theta/thetas
</p>
<p>thetas = maximum Sharpe ratio of the K factor portfolios: GRS (1989) &lt;DOI:10.2307/1913625&gt;
</p>


<h3>Author(s)</h3>

<p>Jae H. Kim
</p>


<h3>References</h3>

<p>Leamer, E. 1978, Specification Searches: Ad Hoc Inference with Nonexperimental Data, Wiley, New York.
</p>
<p>Kim, JH and Ji, P. 2015, Significance Testing in Empirical Finance: A Critical Review and Assessment, Journal of Empirical Finance 34, 1-14.
&lt;DOI:http://dx.doi.org/10.1016/j.jempfin.2015.08.006&gt;
</p>
<p>Gibbons, Ross, Shanken, 1989. A test of the efficiency of a given portfolio, Econometrica, 57,1121-1152.
&lt;DOI:10.2307/1913625&gt;
</p>
<p>Kim and Shamsuddin, 2017, Empirical Validity of Asset-pricing Models: Application of Optimal Significance Level and Equal Probability Test</p>


<h3>See Also</h3>

<p>Kim and Choi, 2017, Choosing the Level of Significance: A Decision-theoretic Approach
</p>


<h3>Examples</h3>

<pre><code class='language-R'>GRS.optimal(T=90, N=25, K=3, theta=0.25, ratio=0.4) # Figure 3 of Kim and Shamsuddin (2017)
</code></pre>

<hr>
<h2 id='GRS.optimalboot'>
Optimal Level of Significance for the GRS test: Bootstrapping
</h2><span id='topic+GRS.optimalboot'></span>

<h3>Description</h3>

<p>The optimal level is calculated by minimizing expected loss from hypothesis testing
</p>
<p>The bootstrap is used to calculate the power.
</p>
<p>The power is calculated at the estimated values (unrestricted) of parameters under H1. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GRS.optimalboot(ret.mat,factor.mat,p=0.5,k=1,nboot=3000,wild=FALSE,Graph=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GRS.optimalboot_+3A_ret.mat">ret.mat</code></td>
<td>
<p> portfolio return matrix, T by N </p>
</td></tr>
<tr><td><code id="GRS.optimalboot_+3A_factor.mat">factor.mat</code></td>
<td>
<p> matrix of risk factors, T by K </p>
</td></tr>
<tr><td><code id="GRS.optimalboot_+3A_p">p</code></td>
<td>
<p> prior probability for H0, default is p = 0.5</p>
</td></tr>
<tr><td><code id="GRS.optimalboot_+3A_k">k</code></td>
<td>
<p> relative loss, k = L2/L1, default is k = 1</p>
</td></tr>
<tr><td><code id="GRS.optimalboot_+3A_nboot">nboot</code></td>
<td>
<p> the number of bootstrap iterations, the default is 3000</p>
</td></tr>
<tr><td><code id="GRS.optimalboot_+3A_wild">wild</code></td>
<td>
<p> if TRUE, wild bootsrap is conducted; if FALSE (default), bootstrap is based on iid residual resampling</p>
</td></tr>
<tr><td><code id="GRS.optimalboot_+3A_graph">Graph</code></td>
<td>
<p> show graph if TRUE (default). No graph otherwise </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The blue square in the plot is the point where the expected loss is mimimized.
</p>
<p>The red horizontal line in the plot indicates the point of the covnentional level of significance (alpha = 0.05).
</p>
<p>The function also returns the density functions under H0 and H1 (black and red curves, with vertical line the critical value at the optimal level).
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>opt.sig</code></td>
<td>
<p>Optimal level of significance</p>
</td></tr>
<tr><td><code>opt.crit</code></td>
<td>
<p>Critical value corresponding to opt.sig</p>
</td></tr>
<tr><td><code>opt.beta</code></td>
<td>
<p>Type II error probability corresponding to opt.sig</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The example below sets nboot=500 for faster execution, but a higher number is recommended. 
</p>


<h3>Author(s)</h3>

<p>Jae H. Kim
</p>


<h3>References</h3>

<p>Leamer, E. 1978, Specification Searches: Ad Hoc Inference with Nonexperimental Data, Wiley, New York.
</p>
<p>Kim, JH and Ji, P. 2015, Significance Testing in Empirical Finance: A Critical Review and Assessment, Journal of Empirical Finance 34, 1-14.
&lt;DOI:http://dx.doi.org/10.1016/j.jempfin.2015.08.006&gt;
</p>
<p>Gibbons, Ross, Shanken, 1989. A test of the efficiency of a given portfolio, Econometrica, 57,1121-1152.
&lt;DOI:10.2307/1913625&gt;
</p>
<p>Kim and Shamsuddin, 2017, Empirical Validity of Asset-pricing Models: Application of Optimal Significance Level and Equal Probability Test
</p>


<h3>See Also</h3>

<p>Kim and Choi, 2017, Choosing the Level of Significance: A Decision-theoretic Approach
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data)
n=60; m1=nrow(data)-n+1; m2=nrow(data)  # Choose the last n observations from the data set
factor.mat = data[m1:m2,2:6]            # Fama-French 5-factors
ret.mat = data[m1:m2,8:ncol(data)]      # 25 size-BM portfolio returns
GRS.optimalboot(ret.mat,factor.mat,p=0.5,k=1,nboot=500,wild=TRUE,Graph=TRUE)
</code></pre>

<hr>
<h2 id='GRS.optimalbootweight'>
Weighted Optimal Level of Significance for the GRS test: Bootstrapping
</h2><span id='topic+GRS.optimalbootweight'></span>

<h3>Description</h3>

<p>The optimal level is calculated by minimizing expected loss from hypothesis testing
</p>
<p>The bootstrap is used to calculate the power.
</p>
<p>The non-centrality paramter is estimated and its bootstrap distribution is obtained. 
</p>
<p>9 percentiles from this distribution is used to caculate the power and the optimal level. 
</p>
<p>These optimal levesl ared weighted using the weights from the density of the bootstrap distribution of lambda. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GRS.optimalbootweight(ret.mat,factor.mat,p=0.5,k=1,nboot=3000,wild=FALSE,Graph=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GRS.optimalbootweight_+3A_ret.mat">ret.mat</code></td>
<td>
<p> portfolio return matrix, T by N </p>
</td></tr>
<tr><td><code id="GRS.optimalbootweight_+3A_factor.mat">factor.mat</code></td>
<td>
<p> matrix of risk factors, T by K </p>
</td></tr>
<tr><td><code id="GRS.optimalbootweight_+3A_p">p</code></td>
<td>
<p> prior probability for H0, default is p = 0.5</p>
</td></tr>
<tr><td><code id="GRS.optimalbootweight_+3A_k">k</code></td>
<td>
<p> relative loss, k = L2/L1, default is k = 1</p>
</td></tr>
<tr><td><code id="GRS.optimalbootweight_+3A_nboot">nboot</code></td>
<td>
<p> the number of bootstrap iterations, the default is 3000</p>
</td></tr>
<tr><td><code id="GRS.optimalbootweight_+3A_wild">wild</code></td>
<td>
<p> if TRUE, wild bootsrap is conducted; if FALSE  (default), bootstrap is based on iid residual resampling</p>
</td></tr>
<tr><td><code id="GRS.optimalbootweight_+3A_graph">Graph</code></td>
<td>
<p> show graph if TRUE (default). No graph otherwise </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Power is calculated based on the bootstrap
</p>
<p>The plot shows the bootstrap distribution of lambda (non-centrality parameter)
</p>
<p>See Kim and Choi, 2017, Choosing the Level of Significance: A Decision-theoretic Approach
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>opt.sig</code></td>
<td>
<p>Optimal level of significance</p>
</td></tr>
<tr><td><code>opt.crit</code></td>
<td>
<p>Critical value corresponding to opt.sig</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The example below sets nboot=500 for faster execution, but a higher number is recommended. 
</p>


<h3>Author(s)</h3>

<p>Jae H. Kim
</p>


<h3>References</h3>

<p>Leamer, E. 1978, Specification Searches: Ad Hoc Inference with Nonexperimental Data, Wiley, New York.
</p>
<p>Kim, JH and Ji, P. 2015, Significance Testing in Empirical Finance: A Critical Review and Assessment, Journal of Empirical Finance 34, 1-14.
&lt;DOI:http://dx.doi.org/10.1016/j.jempfin.2015.08.006&gt;
</p>
<p>Gibbons, Ross, Shanken, 1989. A test of the efficiency of a given portfolio, Econometrica, 57,1121-1152.
&lt;DOI:10.2307/1913625&gt;
</p>
<p>Kim and Shamsuddin, 2017, Empirical Validity of Asset-pricing Models: Application of Optimal Significance Level and Equal Probability Test
</p>


<h3>See Also</h3>

<p>Kim and Choi, 2017, Choosing the Level of Significance: A Decision-theoretic Approach
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data)
n=60; m1=nrow(data)-n+1; m2=nrow(data)   # Choose the last n observations from the data set
factor.mat = data[m1:m2,2:6]            # Fama-French 5-factors
ret.mat = data[m1:m2,8:ncol(data)]      # 25 size-BM portfolio returns
GRS.optimalboot(ret.mat,factor.mat,p=0.5,k=1,nboot=500,wild=TRUE,Graph=TRUE)

</code></pre>

<hr>
<h2 id='GRS.optimalweight'>
Weighted Optimal Level of Significance for the GRS test: Normality Assumption
</h2><span id='topic+GRS.optimalweight'></span>

<h3>Description</h3>

<p>The optimal level is calculated by minimizing expected loss from hypothesis testing.
</p>
<p>The F-distributions are used to calculate the power, under the normality assumption
</p>
<p>The power is calculated using a range of non-centrality parameters (lamdba), folloing a folded-normal distribution.
</p>
<p>The weights are obtained from the density function of folded-normal distribution. 
</p>
<p>See, for details, Kim and Choi, 2017, Choosing the Level of Significance: A Decision-theoretic Approach. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GRS.optimalweight(T, N, K, theta, ratio, delta = 3, p = 0.5, k = 1, Graph = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GRS.optimalweight_+3A_t">T</code></td>
<td>
<p> sample size </p>
</td></tr>
<tr><td><code id="GRS.optimalweight_+3A_n">N</code></td>
<td>
<p> the number of portfolio returns</p>
</td></tr>
<tr><td><code id="GRS.optimalweight_+3A_k">K</code></td>
<td>
<p> the number of risk factors </p>
</td></tr>
<tr><td><code id="GRS.optimalweight_+3A_theta">theta</code></td>
<td>
<p> maximum Sharpe ratio of the K factor portfolios</p>
</td></tr>
<tr><td><code id="GRS.optimalweight_+3A_ratio">ratio</code></td>
<td>
<p> theta/thetas, proportion of the potential efficiency </p>
</td></tr>
<tr><td><code id="GRS.optimalweight_+3A_delta">delta</code></td>
<td>
<p> the standard deviation of the folded-normal distribution, default is 3 </p>
</td></tr>
<tr><td><code id="GRS.optimalweight_+3A_p">p</code></td>
<td>
<p> prior probability for H0, default is p = 0.5</p>
</td></tr>
<tr><td><code id="GRS.optimalweight_+3A_k">k</code></td>
<td>
<p> relative loss, k = L2/L1, default is k = 1</p>
</td></tr>
<tr><td><code id="GRS.optimalweight_+3A_graph">Graph</code></td>
<td>
<p> show graph if TRUE. No graph otherwise </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the power calculation of the GRS test, as in GRS (1989) &lt;DOI:10.2307/1913625&gt;.
</p>
<p>The plot shows the folded-normal distribution. 
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>opt.sig</code></td>
<td>
<p>Optimal level of significance</p>
</td></tr>
<tr><td><code>opt.crit</code></td>
<td>
<p>Critical value corresponding to opt.sig</p>
</td></tr>
</table>


<h3>Note</h3>

<p>ratio = theta/thetas
</p>
<p>thetas = maximum Sharpe ratio of the K factor portfolios: GRS (1989) &lt;DOI:10.2307/1913625&gt;
</p>


<h3>Author(s)</h3>

<p>Jae H. Kim
</p>


<h3>References</h3>

<p>Leamer, E. 1978, Specification Searches: Ad Hoc Inference with Nonexperimental Data, Wiley, New York.
</p>
<p>Kim, JH and Ji, P. 2015, Significance Testing in Empirical Finance: A Critical Review and Assessment, Journal of Empirical Finance 34, 1-14.
&lt;DOI:http://dx.doi.org/10.1016/j.jempfin.2015.08.006&gt;
</p>
<p>Gibbons, Ross, Shanken, 1989. A test of the efficiency of a given portfolio, Econometrica, 57,1121-1152.
&lt;DOI:10.2307/1913625&gt;
</p>
<p>Kim and Shamsuddin, 2017, Empirical Validity of Asset-pricing Models: Application of Optimal Significance Level and Equal Probability Test
</p>


<h3>See Also</h3>

<p>Kim and Choi, 2017, Choosing the Level of Significance: A Decision-theoretic Approach
</p>


<h3>Examples</h3>

<pre><code class='language-R'>GRS.optimalweight(T=90, N=25, K=3, theta=0.25, ratio=0.4) 
</code></pre>

<hr>
<h2 id='GRS.Power'>
Statistical Power of the GRS test
</h2><span id='topic+GRS.Power'></span>

<h3>Description</h3>

<p>Calculates the power of the GRS test with density functions under H0 and H1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GRS.Power(T, N, K, theta, ratio, alpha = 0.05, xmax = 10, Graph = "TRUE")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GRS.Power_+3A_t">T</code></td>
<td>
<p> sample size </p>
</td></tr>
<tr><td><code id="GRS.Power_+3A_n">N</code></td>
<td>
<p> the number of portfolio returns</p>
</td></tr>
<tr><td><code id="GRS.Power_+3A_k">K</code></td>
<td>
<p> the number of risk factors </p>
</td></tr>
<tr><td><code id="GRS.Power_+3A_theta">theta</code></td>
<td>
<p> maximum Sharpe ratio of the K factor portfolios</p>
</td></tr>
<tr><td><code id="GRS.Power_+3A_ratio">ratio</code></td>
<td>
<p> theta/thetas, proportion of the potential efficiency </p>
</td></tr>
<tr><td><code id="GRS.Power_+3A_alpha">alpha</code></td>
<td>
<p> the level of significance, default is 0.05 </p>
</td></tr>
<tr><td><code id="GRS.Power_+3A_xmax">xmax</code></td>
<td>
<p> the support of the desnity is from 0 to xmax, default is 10 </p>
</td></tr>
<tr><td><code id="GRS.Power_+3A_graph">Graph</code></td>
<td>
<p> show graph if TRUE. No graph otherwise </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculate the power following GRS (1989) &lt;DOI:10.2307/1913625&gt;
</p>
<p>The distribution under H1 is based on the value of theta and ratio
</p>
<p>Under H0: ratio = 1; under H1: ratio &lt; 1
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Power</code></td>
<td>
<p>power of the test</p>
</td></tr>
<tr><td><code>Critical.value</code></td>
<td>
<p>critical value at alpha</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The graph option plots the density functions of the GRS test under H0 and H1.
</p>
<p>The blue vertical line represents the critical value at alpha level of significance
</p>
<p>The black density function is the one under H0, and the gray-shaded area is level of significance.
</p>
<p>The red one is the one under H1, and the red-shaded area is the power.
</p>


<h3>Author(s)</h3>

<p>Jae H. Kim
</p>


<h3>References</h3>

<p>Gibbons, Ross, Shanken, 1989. A test of the efficiency of a given portfolio, Econometrica, 57,1121-1152.
&lt;DOI:10.2307/1913625&gt;
</p>


<h3>See Also</h3>

<p>GRS(1989) &lt;DOI:10.2307/1913625&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>GRS.Power(T=120, N=25, K=3, theta=0.3, ratio=0.5)  # Figure 1 of Kim and Shamsuddin (2016)
</code></pre>

<hr>
<h2 id='GRS.Powerfunc'>
Power functions for the GRS test </h2><span id='topic+GRS.Powerfunc'></span>

<h3>Description</h3>

<p>The function plots the power functions for a range of sample size (T), given the other parameter values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GRS.Powerfunc(Tvec, N, K, theta, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GRS.Powerfunc_+3A_tvec">Tvec</code></td>
<td>
<p> a vector of sample sizes </p>
</td></tr>
<tr><td><code id="GRS.Powerfunc_+3A_n">N</code></td>
<td>
<p> the number of portfolio returns</p>
</td></tr>
<tr><td><code id="GRS.Powerfunc_+3A_k">K</code></td>
<td>
<p> the number of risk factors </p>
</td></tr>
<tr><td><code id="GRS.Powerfunc_+3A_theta">theta</code></td>
<td>
<p> maximum Sharpe ratio of the K factor portfolios</p>
</td></tr>
<tr><td><code id="GRS.Powerfunc_+3A_alpha">alpha</code></td>
<td>
<p> the level of significance, default is 0.05 </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power is plotted against the ratio=theta/thetas, the proprotion of potential efficiency </p>


<h3>Value</h3>

<p>Power: Matrix of power values plotted
</p>


<h3>Note</h3>

<p>Under H0: ratio = 1, so the power = alpha when ratio = 1.
</p>
<p>The power increases as the ratio declines from 1.
</p>
<p>The power increases with sample size, so the upper power function is associated with larger sample size. 
</p>


<h3>Author(s)</h3>

<p>Jae H. Kim
</p>


<h3>References</h3>

<p>Gibbons, Ross, Shanken, 1989. A test of the efficiency of a given portfolio, Econometrica, 57,1121-1152.
&lt;DOI:10.2307/1913625&gt;
</p>


<h3>See Also</h3>

<p>GRS (1989) &lt;DOI:10.2307/1913625&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>GRS.Powerfunc(Tvec=c(60,120),N=25, K=3,theta=0.3)  # Figure 2 of Kim and Shamsuddin (2016)
</code></pre>

<hr>
<h2 id='GRS.T'>
Sample Size Selection for the GRS test
</h2><span id='topic+GRS.T'></span>

<h3>Description</h3>

<p>Given the desired level of Type I and II error probabilities, the function returns the sample size required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GRS.T(N, K, theta, ratio, alpha, beta, Tmax = 10000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GRS.T_+3A_n">N</code></td>
<td>
<p> the number of portfolio returns</p>
</td></tr>
<tr><td><code id="GRS.T_+3A_k">K</code></td>
<td>
<p> the number of risk factors </p>
</td></tr>
<tr><td><code id="GRS.T_+3A_theta">theta</code></td>
<td>
<p> maximum Sharpe ratio of the K factor portfolios</p>
</td></tr>
<tr><td><code id="GRS.T_+3A_ratio">ratio</code></td>
<td>
<p> theta/thetas, proportion of the potential efficiency </p>
</td></tr>
<tr><td><code id="GRS.T_+3A_alpha">alpha</code></td>
<td>
<p> the desried level of significance, or Type I error probability </p>
</td></tr>
<tr><td><code id="GRS.T_+3A_beta">beta</code></td>
<td>
<p>  the desried level of Type II error probability</p>
</td></tr>
<tr><td><code id="GRS.T_+3A_tmax">Tmax</code></td>
<td>
<p> the maximum number of sample size, default is 10000 </p>
</td></tr>
</table>


<h3>Details</h3>

<p> the desired level of power = 1 - beta </p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Required.T</code></td>
<td>
<p>required sample size</p>
</td></tr>
<tr><td><code>Critical.value</code></td>
<td>
<p>the corresponding critical value</p>
</td></tr>   
</table>


<h3>Note</h3>

<p>Critical.value is from the F-distribution with df1=N and df2=Required.T-N-K degrees of freedom, at the alpha level of significance. 
</p>


<h3>Author(s)</h3>

<p>Jae H. Kim
</p>


<h3>References</h3>

<p>Gibbons, Ross, Shanken, 1989. A test of the efficiency of a given portfolio, Econometrica, 57,1121-1152.
&lt;DOI:10.2307/1913625&gt;
</p>


<h3>See Also</h3>

<p>Kim and Shamsuddin, 2017, Empirical Validity of Asset-pricing Models: Application of Optimal Significance Level and Equal Probability Test
</p>


<h3>Examples</h3>

<pre><code class='language-R'>GRS.T(N=25,K=3,theta=0.25,ratio=0.4,alpha=0.05, beta=0.05, Tmax=5000) 
</code></pre>

<hr>
<h2 id='GRS.test'>
GRS test and Model Estimation Results
</h2><span id='topic+GRS.test'></span>

<h3>Description</h3>

<p>Wu statistic given in (5) of GRS (1989) &lt;DOI:10.2307/1913625&gt;
</p>
<p>The function also provide estimation results for asset pricing models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GRS.test(ret.mat, factor.mat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GRS.test_+3A_ret.mat">ret.mat</code></td>
<td>
<p> portfolio return matrix, T by N </p>
</td></tr>
<tr><td><code id="GRS.test_+3A_factor.mat">factor.mat</code></td>
<td>
<p> matrix of risk factors, T by K </p>
</td></tr>
</table>


<h3>Details</h3>

<p> T: sample size, N: number of portfolio returns, K: number of risk factors </p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>GRS.stat</code></td>
<td>
<p>GRS test statistic</p>
</td></tr>
<tr><td><code>GRS.pval</code></td>
<td>
<p>its p-value</p>
</td></tr>  
<tr><td><code>coef</code></td>
<td>
<p>matrix of coefficient estimates from N equations, N by (K+1)</p>
</td></tr> 
<tr><td><code>resid</code></td>
<td>
<p>matrix of residuals from N equations, T by N</p>
</td></tr>   
<tr><td><code>tstat</code></td>
<td>
<p>matrix of t-statistics for coefficients, N by (K+1)</p>
</td></tr>   
<tr><td><code>se</code></td>
<td>
<p>matrix of standard errors for coefficients, N by (K+1)</p>
</td></tr>   
<tr><td><code>R2</code></td>
<td>
<p>matrix of R-squares for N equations, N by 1</p>
</td></tr>   
</table>


<h3>Note</h3>

<p>Applicable to CAPM as well as a multi-factor model
</p>


<h3>Author(s)</h3>

<p>Jae H. Kim
</p>


<h3>References</h3>

<p>Gibbons, Ross, Shanken, 1989. A test of the efficiency of a given portfolio, Econometrica, 57,1121-1152.
&lt;DOI:10.2307/1913625&gt;
</p>


<h3>See Also</h3>

<p>Fama and French, 1993, Common risk factors in the returns on stocks and bonds, Journal of Financial Economics, 33, 3-56.
&lt;DOI:10.1016/0304-405X(93)90023-5&gt;
</p>
<p>Fama and French, 2015, A five-factor asset-pricing model, Journal of Financial Economics, 1-22.
&lt;DOI:http://dx.doi.org/10.1016/j.jfineco.2014.10.010&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data)
factor.mat = data[1:342,2:4]            # Fama-French 3-factor model
ret.mat = data[1:342,8:ncol(data)]      # 25 size-BM portfolio returns
GRS.test(ret.mat,factor.mat)$GRS.stat   # See Table 9C of Fama-French (1993)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
