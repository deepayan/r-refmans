<!DOCTYPE html><html><head><title>Help for package fitPS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fitPS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#==.psData'><p>S3 method for objects of class <code>psData</code></p></a></li>
<li><a href='#as.data.frame.psData'><p>Converts an object of class <code>psData</code> to a <code>data.frame</code></p></a></li>
<li><a href='#bootCI'><p>Bootstrap confidence intervals or regions</p></a></li>
<li><a href='#compareSurveys'><p>Compare two surveys on the basis of their shape parameters</p></a></li>
<li><a href='#compareSurveysLRT'><p>Compare two or more surveys on the basis of their shape parameters using a Likelihood Ratio Test</p></a></li>
<li><a href='#confint.psFit'><p>S3 confint method for objects of class psFit</p></a></li>
<li><a href='#fitDist'><p>Fit a Zeta Distribution to Forensic Data</p></a></li>
<li><a href='#fitlogDist'><p>Fit a Logarithmic Distribution to Forensic Data</p></a></li>
<li><a href='#fitted.psFit'><p>S3 fitted method for an object of class <code>psFit</code></p></a></li>
<li><a href='#fitZIDist'><p>Fit a Zero-Inflated Zeta Distribution to Forensic Data</p></a></li>
<li><a href='#makePSData'><p>Create a survey data set manually</p></a></li>
<li><a href='#mean.psData'><p>An S3 method for computing the mean of clothing survey for the number of</p>
groups or size of groups</a></li>
<li><a href='#plot.psFit'><p>S3 plot method for an object of class <code>psFit</code></p></a></li>
<li><a href='#predict.psFit'><p>S3 predict method for an object of class <code>psFit</code></p></a></li>
<li><a href='#print.psData'><p>S3 print method for an object of class <code>psData</code></p></a></li>
<li><a href='#print.psFit'><p>S3 print method for an object of class <code>psFit</code></p></a></li>
<li><a href='#probfun'><p>Probability Functions</p></a></li>
<li><a href='#Psurveys'><p>Number of Groups of Glass Data</p></a></li>
<li><a href='#readData'><p>Read count data from file</p></a></li>
<li><a href='#rzeta'><p>Generate random variates from a zeta distribution</p></a></li>
<li><a href='#rZIzeta'><p>Generate zero inflated zeta random variates</p></a></li>
<li><a href='#Ssurveys'><p>Size of Groups of Glass Data</p></a></li>
<li><a href='#summary.psFit'><p>S3 summary method for an object of class <code>psFit</code></p></a></li>
<li><a href='#var'><p>Variance generic</p></a></li>
<li><a href='#var.psData'><p>An S3 method for computing the variance of clothing survey for the number of</p>
groups or size of groups</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fit Zeta Distributions to Forensic Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-12</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits Zeta distributions (discrete power laws) to data that arises
    from forensic surveys of clothing on the presence of glass and paint in
    various populations. The general method is described to some extent in
    Coulson, S.A., Buckleton, J.S., Gummer, A.B., and Triggs, C.M. (2001) 
    &lt;<a href="https://doi.org/10.1016%2FS1355-0306%2801%2971847-3">doi:10.1016/S1355-0306(01)71847-3</a>&gt;, although the implementation differs.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>foreach, R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>doParallel, dplyr, Hmisc, iterators, knitr, ks, methods,
pbapply, Rdpack, readxl, VGAM</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jmcurran/fitPS">https://github.com/jmcurran/fitPS</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jmcurran/fitPS/issues">https://github.com/jmcurran/fitPS/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>sp, xtable</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-20 00:14:40 UTC; james</td>
</tr>
<tr>
<td>Author:</td>
<td>James Curran [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>James Curran &lt;j.curran@auckland.ac.nz&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-20 00:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+3D+3D.psData'>S3 method for objects of class <code>psData</code></h2><span id='topic++3D+3D.psData'></span>

<h3>Description</h3>

<p>Tests to see if two objects of class <code>psData</code> are equal. That is
their <code>type</code> is the same, and the data contained in <code>data</code> is the
same. See <code><a href="#topic+readData">readData</a></code> for a description of the <code>psData</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psData'
lhs == rhs
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B3D+2B3D.psData_+3A_lhs">lhs</code></td>
<td>
<p>an object of class <code>psData</code>.</p>
</td></tr>
<tr><td><code id="+2B3D+2B3D.psData_+3A_rhs">rhs</code></td>
<td>
<p>an object of class <code>psData</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NOTE: the <code>notes</code> member variable is ignored in this function
as it is unlikely that a user would want to see if the notes are the same.
</p>


<h3>Value</h3>

<p>TRUE if the two objects are equal
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p = readData(system.file("extdata", "p.xlsx", package = "fitPS"))
p1 = makePSData(n = 0:2, count = c(98, 1, 1), type = "P")
p2 = makePSData(n = 0:2, count = c(97, 2, 1), type = "P")
p == p1 ## TRUE
p == p2 ## FALSE
p1 == p2 ## FALSE
</code></pre>

<hr>
<h2 id='as.data.frame.psData'>Converts an object of class <code>psData</code> to a <code>data.frame</code></h2><span id='topic+as.data.frame.psData'></span>

<h3>Description</h3>

<p>Converts an object of class <code>psData</code>&mdash;see <code><a href="#topic+readData">readData</a></code>&mdash;to a
<code>data.frame</code> that can be used with in functions in other packages such as
<code><a href="VGAM.html#topic+vglm">vglm</a></code> to fit more complicated models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psData'
as.data.frame(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.data.frame.psData_+3A_x">x</code></td>
<td>
<p>an object of class <code>psData</code>&mdash;see <code><a href="#topic+readData">readData</a></code>for more
details.</p>
</td></tr>
<tr><td><code id="as.data.frame.psData_+3A_...">...</code></td>
<td>
<p>any other arguments passed to <code>data.frame</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>x</code> is a <code>psData</code> object of type <code>"P"</code>, i.e. it
relates to numbers of groups of glass, then a <code>data.frame</code> with a single variable
<code>count</code> will be return where <code>count = rep(x$data$n + 1,
  x$data$rn)</code>. The counts have one added to them because the zeta
distribution requires that the counts are greater than or equal to one.  If
<code>x</code> is a <code>psData</code> object of type <code>"P"</code>, i.e. it relates to
group sizes, then a <code>data.frame</code> with a single variable <code>count</code>
will be return where <code>count = rep(x$data$n, x$data$rn)</code>.
</p>


<h3>Value</h3>

<p>a <code>data.frame</code> with a single variable <code>count</code>. The number
of rows in the <code>data.frame</code> is equal to <code>sum(x$data$rn)</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p = readData(system.file("extdata", "p.xlsx", package = "fitPS"))
p.df = as.data.frame(p)
table(p.df$count)
p$data
</code></pre>

<hr>
<h2 id='bootCI'>Bootstrap confidence intervals or regions</h2><span id='topic+bootCI'></span><span id='topic+bootCI.default'></span><span id='topic+bootCI.psData'></span><span id='topic+bootCI.psFit'></span>

<h3>Description</h3>

<p>Use boostrapping to generate confidence intervals, or confidence regions in
the case of the zero-inflated model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootCI(x, ...)

## Default S3 method:
bootCI(
  x,
  level = 0.95,
  B = 2000,
  model = c("zeta", "ziz"),
  returnBootValues = FALSE,
  silent = FALSE,
  plot = FALSE,
  parallel = TRUE,
  progressBar = FALSE,
  pbopts = list(type = "txt"),
  ...
)

## S3 method for class 'psData'
bootCI(x, ...)

## S3 method for class 'psFit'
bootCI(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootCI_+3A_x">x</code></td>
<td>
<p>a object either of class <code>psData</code>&mdash;see <code><a href="#topic+readData">readData</a></code> for more
details&mdash;or of class <code>psFit</code>.</p>
</td></tr>
<tr><td><code id="bootCI_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
<tr><td><code id="bootCI_+3A_level">level</code></td>
<td>
<p>the confidence level required&mdash;restricted to [0.75, 1). This may
be a vector, in which case multiple intervals, or confidence regions will be
returned.</p>
</td></tr>
<tr><td><code id="bootCI_+3A_b">B</code></td>
<td>
<p>the number of bootstrap samples to take.</p>
</td></tr>
<tr><td><code id="bootCI_+3A_model">model</code></td>
<td>
<p>which model to fit to the data, either <code>"zeta"</code> or
<code>"ziz"</code>. Maybe abbreviated to <code>"z"</code> and <code>"zi"</code>. Default
is <code>"zeta"</code>.</p>
</td></tr>
<tr><td><code id="bootCI_+3A_returnbootvalues">returnBootValues</code></td>
<td>
<p>if <code>TRUE</code> then the <code>vector</code> (or
<code>data.frame</code>) of bootstrapped values is returned. This can be useful
for debugging or understanding the results. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="bootCI_+3A_silent">silent</code></td>
<td>
<p>if <code>TRUE</code>, then no output will be displayed whilst the
bootstrapping is being undertaken. <code>plot</code> if <code>TRUE</code> then the
contours for the confidence region will be plotted. This only works if
<code>model = "ziz"</code>. It is ignored otherwise. <code>parallel</code> if
<code>TRUE</code> then the bootstrapping is performed in parallel.</p>
</td></tr>
<tr><td><code id="bootCI_+3A_plot">plot</code></td>
<td>
<p>if <code>TRUE</code> and <code>model == "ziz"</code>, then a plot of the
bootstrapped values will be produced and confidence contour lines will be
drawn for each value in level.</p>
</td></tr>
<tr><td><code id="bootCI_+3A_parallel">parallel</code></td>
<td>
<p>if <code>TRUE</code>, then the package will attempt to use multiple
cores to speed up computation.</p>
</td></tr>
<tr><td><code id="bootCI_+3A_progressbar">progressBar</code></td>
<td>
<p>if <code>TRUE</code>, then progress bars will be displayed to
show progress on the bootstrapping.</p>
</td></tr>
<tr><td><code id="bootCI_+3A_pbopts">pbopts</code></td>
<td>
<p>a list of arguments for the <code><a href="pbapply.html#topic+pboptions">pboptions</a></code>
function that affect the progress bars. Ignored if <code>progressBar =
FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses bootstrapping to compute a confidence interval for
the shape parameter in the case of the zeta model and a confidence region in
the case of the zero-inflated zeta model. A smoothed bootstrap approach is
taken rather than a simple percentile method. The kernel density estimation
is performed by the <code>ks</code> package using a smoothed cross-validated
bandwidth selection procedure.
</p>


<h3>Value</h3>

<p>If <code>returnBootVals == TRUE</code> then the results are returned in a
list with elements named <code>ci</code> and <code>bootVals</code> for the zeta model
and <code>confRegion</code> and <code>bootVals</code> for the zero-inflated zeta model.
The structure of <code>ci</code> and <code>confregion</code> is described below. If
<code>model == "zeta"</code>, then either a <code>vector</code> or a <code>data.frame</code>
with elements/columns named <code>"lower"</code> and <code>"upper"</code> representing
the lower and upper bounds of the confidence interval(s). Multiple bounds
are returned in a <code>data.frame</code> when <code>level</code> has more than one
value. If <code>model == "ziz
 "</code>, then a list with length equal to the
length of <code>level</code> is returned. The name of each element in the list is
the level with 
list has a single element named <code>"95%"</code>. It is possible for there to
be multiple contours for the confidence region for a given <code>level</code>. If
there is only one contour for each value of <code>level</code>, then each element
of the list consists of a <code>list</code> with elements named <code>pi</code> and
<code>shape</code> which specify the coordinates of the contour(s) for that level.
There is a third element named <code>level</code> which gives the height of the
kernel density estimate at that contour. If there are multiple contours for
a given value of <code>level</code> then each list element is a list of lists with
the structure given above (<code>level</code>, <code>pi</code>, and <code>shape</code>). NOTE:
it is quite possible that there are multiple contours for a given height. If
you want a way of thinking about this consider a mountain range with two
mountains of equal height. If you draw the contours for (almost) any
elevation, then you would expect to capture a region from each mountain.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>bootCI(default)</code>: Bootstrap confidence intervals or regions
</p>
</li>
<li> <p><code>bootCI(psData)</code>: Bootstrap confidence intervals or regions
</p>
</li>
<li> <p><code>bootCI(psFit)</code>: Bootstrap confidence intervals or regions
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Psurveys)
roux = Psurveys$roux
confRegion = bootCI(roux, model = "ziz", parallel = FALSE, plot = TRUE)

## This will not work unless you have the sp package installed
## Count how many of the points lie within the 95% confidence region
lapply(confRegion, function(cr){
  table(sp::point.in.polygon(fit$pi,fit$shape, cr$pi, cr$shape))
. })

## End(Not run)
</code></pre>

<hr>
<h2 id='compareSurveys'>Compare two surveys on the basis of their shape parameters</h2><span id='topic+compareSurveys'></span><span id='topic+compare.surveys'></span><span id='topic+comp.survs'></span><span id='topic+compareSurveys.default'></span><span id='topic+compareSurveys.psData'></span><span id='topic+compareSurveys.psFit'></span>

<h3>Description</h3>

<p>Compare two surveys on the basis of their shape parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compareSurveys(x, ...)

## Default S3 method:
compareSurveys(
  x,
  y,
  xname = NULL,
  yname = NULL,
  alternative = c("two.sided", "less", "greater"),
  null.value = 0,
  print = TRUE,
  ...
)

## S3 method for class 'psData'
compareSurveys(x, y, ...)

## S3 method for class 'psFit'
compareSurveys(x, y, ...)

compare.surveys(x, ...)

comp.survs(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compareSurveys_+3A_x">x</code></td>
<td>
<p>either an object of class <code>psData</code>&mdash;see <code><a href="#topic+readData">readData</a></code>
or an object of class <code>psFit</code>&mdash;see <code><a href="#topic+fitDist">fitDist</a></code>.</p>
</td></tr>
<tr><td><code id="compareSurveys_+3A_y">y</code></td>
<td>
<p>either an object of class <code>psData</code>&mdash;see <code><a href="#topic+readData">readData</a></code>
or an object of class <code>psFit</code>&mdash;see <code><a href="#topic+fitDist">fitDist</a></code>.</p>
</td></tr>
<tr><td><code id="compareSurveys_+3A_xname">xname</code></td>
<td>
<p>an optional name for the first survey object.</p>
</td></tr>
<tr><td><code id="compareSurveys_+3A_yname">yname</code></td>
<td>
<p>an optional name for the second survey object.</p>
</td></tr>
<tr><td><code id="compareSurveys_+3A_alternative">alternative</code></td>
<td>
<p>one of <code>"two.sided"</code>, <code>"less"</code>, or <code>"greater"</code>, depending on the type of
hypothesis test you wish to carry out. These may be replaced by single letter (or more) abbreviations.</p>
</td></tr>
<tr><td><code id="compareSurveys_+3A_null.value">null.value</code></td>
<td>
<p>the true value of the difference in the shape parameters under the null hypothesis.</p>
</td></tr>
<tr><td><code id="compareSurveys_+3A_print">print</code></td>
<td>
<p>if <code>TRUE</code> then the function will print summary output to the screen. This lets output be suppressed
in situations where the user wants the function to run silently.</p>
</td></tr>
<tr><td><code id="compareSurveys_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function **only** works for the zeta distribution. It does not work for the zero-inflated zeta distribution. If
the results from fitting ZIZ models are passed to this function, then it will ignore the zero-inflated part and simply refit a zeta model.
</p>
<p>There is very little reason for <code>null.value</code> to be set to be anything other than <code>0</code>. However it has been included for flexibility.
</p>
<p><code>alternative = "greater"</code> is the alternative that x has a larger shape parameter than y.
<code>alternative = "less"</code> is the alternative that x has a smaller shape parameter than y.
</p>


<h3>Value</h3>

<p>The function returns a <code>list</code> of class <code>"htest"</code> with the following elements:
</p>

<dl>
<dt><code>statistic</code></dt><dd><p> &ndash; the test statistic.</p>
</dd>
<dt><code>p.value</code></dt><dd><p> &ndash; the P-value associated with the estimate.</p>
</dd>
<dt><code>estimate</code></dt><dd><p> &ndash; the estimated difference in the shape parameters.</p>
</dd>
<dt><code>null.value</code></dt><dd><p> &ndash; the specified hypothesized value of the difference in shape parameters&mdash;<code>0</code> by default.</p>
</dd>
<dt><code>stderr</code></dt><dd><p> &ndash; the standard error of the difference.</p>
</dd>
<dt><code>alternative</code></dt><dd><p> &ndash; a character string describing the alternative hypothesis.</p>
</dd>
<dt><code>method</code></dt><dd><p> &ndash; a character string describing the method.</p>
</dd>
<dt><code>data.name</code></dt><dd><p> &ndash; a character string with the names of the two input data sets separated by &quot; and &quot;.</p>
</dd>
</dl>



<h3>Methods (by class)</h3>


<ul>
<li> <p><code>compareSurveys(default)</code>: Compare two surveys on the basis of their shape parameters
</p>
</li>
<li> <p><code>compareSurveys(psData)</code>: Compare two surveys on the basis of their shape parameters
</p>
</li>
<li> <p><code>compareSurveys(psFit)</code>: Compare two surveys on the basis of their shape parameters
</p>
</li></ul>


<h3>Functions</h3>


<ul>
<li> <p><code>compare.surveys()</code>: Compare two surveys on the basis of their shape parameters
</p>
</li>
<li> <p><code>comp.survs()</code>: Compare two surveys on the basis of their shape parameters
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>data(Psurveys)
lau = Psurveys$lau
jackson = Psurveys$jackson
compareSurveys(lau, jackson)

## Example with fitted objects - note the function just refits the models
fit.lau = fitDist(lau)
fit.jackson = fitDist(jackson)
compareSurveys(fit.lau, fit.jackson)

## Example with a bigger difference
compareSurveys(Psurveys$roux, lau)

</code></pre>

<hr>
<h2 id='compareSurveysLRT'>Compare two or more surveys on the basis of their shape parameters using a Likelihood Ratio Test</h2><span id='topic+compareSurveysLRT'></span>

<h3>Description</h3>

<p>Compare two or more surveys on the basis of their shape parameters using a Likelihood Ratio Test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compareSurveysLRT(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compareSurveysLRT_+3A_...">...</code></td>
<td>
<p>two or more objects of class <code>"psData"</code>&mdash;see <code><a href="#topic+readData">readData</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function **only** works for the zeta distribution. The function carries out a likelihood ratio test (LRT) to test the null hypothesis
</p>
<p style="text-align: center;"><code class="reqn">H_0: \alpha_1 = \alpha_2 = \ldots = \alpha_K</code>
</p>
<p> versus the alternative
</p>
<p style="text-align: center;"><code class="reqn">H_1: \alpha_i \neq \alpha_j \mbox{ for some } i \neq j \in \left\{1, \ldots, K\right\},</code>
</p>

<p>where <code class="reqn">\alpha_i</code> is the shape parameter for the zeta distribution of the <code class="reqn">i^\mathrm{th}</code> survey.
</p>


<h3>Value</h3>

<p>The function returns a <code>list</code> of class <code>"htest"</code> with the following elements:
</p>

<dl>
<dt><code>statistic</code></dt><dd><p> &ndash; the test statistic.</p>
</dd>
<dt><code>parameter</code></dt><dd><p> &ndash; the degrees of freedom for the test</p>
</dd>
<dt><code>p.value</code></dt><dd><p> &ndash; the P-value associated with the estimate.</p>
</dd>
<dt><code>method</code></dt><dd><p> &ndash; a character string describing the method hypothesis.</p>
</dd>
<dt><code>data.name</code></dt><dd><p> &ndash; the names of the data sets used in the test</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(Psurveys)
lau = Psurveys$lau
jackson = Psurveys$jackson
compareSurveysLRT(lau, jackson)

## Example with three surveys
roux = Psurveys$roux
compareSurveysLRT(lau, jackson, roux)

</code></pre>

<hr>
<h2 id='confint.psFit'>S3 confint method for objects of class psFit</h2><span id='topic+confint.psFit'></span>

<h3>Description</h3>

<p>S3 confint method for objects of class psFit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psFit'
confint(object, parm, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.psFit_+3A_object">object</code></td>
<td>
<p>an object of class <code>psFit</code>&mdash;see fitDist for more details</p>
</td></tr>
<tr><td><code id="confint.psFit_+3A_parm">parm</code></td>
<td>
<p>added for compatibility. Should be left empty as it is ignored.</p>
</td></tr>
<tr><td><code id="confint.psFit_+3A_level">level</code></td>
<td>
<p>the confidence level required&mdash;restricted to [0.75, 1)</p>
</td></tr>
<tr><td><code id="confint.psFit_+3A_...">...</code></td>
<td>
<p>in theory other parameters to be passed to <code>confint</code>, but in
reality passed as extra parameters to the internal function <code>plZIZ</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NOTE: the method for ZIZ model is a little computationally intensive
and possibly (almost certainly) unstable.
</p>


<h3>Value</h3>

<p>if the zeta model is used (i.e <code>object</code> comes from a call to
<code><a href="#topic+fitDist">fitDist</a></code>),then a list with two items: <code>wald</code> and
<code>prof</code> containing the Wald and profile likelihood confidence intervals
respectively for the shape parameter of the fitted zeta distribution is
returned. In general these should be relatively close to each other.
**NOTE** These values are for the <span class="pkg">VGAM</span> parameterisation of the Zeta
distribution which uses <code class="reqn">s^\prime = s - 1</code>. This means they
can be used without alteration in <code><a href="VGAM.html#topic+dzeta">dzeta</a></code>. If a
zero-inflated zeta model is used (i.e. <code>object</code> comes from a call to
<code><a href="#topic+fitZIDist">fitZIDist</a></code>) then list of a confidence regions is returned with
and element for each value of <code>level</code>. The confidence regions are
<code>data.frame</code>s with variables <code>pi</code> and <code>shape</code> which can be
used with <code><a href="graphics.html#topic+lines">lines</a></code> or <code><a href="graphics.html#topic+polygon">polygon</a></code>
to draw a the confidence region.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Psurveys)
roux = Psurveys$roux
fit = fitDist(roux)
confint(fit)

## Not run: 
fit.zi = fitZIDist(roux)
cr = confint(fit.zi, level = c(0.80, 0.95))
plot(cr[["0.95"]], type = "l")
polygon(cr[["0.8"]])

## End(Not run)

</code></pre>

<hr>
<h2 id='fitDist'>Fit a Zeta Distribution to Forensic Data</h2><span id='topic+fitDist'></span><span id='topic+fitdist'></span>

<h3>Description</h3>

<p>This function uses maximum likelihood estimation (MLE) to estimate the shape
parameter of  a zeta distribution from a set of observed counts for either
the number of groups/sources of forensically interesting material (mostly
glass or paint) recovered from clothing, or the number of fragments/particles
in each group. This, in turn, allows the estimation of the P and S
probabilities, as described by Evett and Buckleton (1990), which used in
computing the likelihood ratio (LR) for activity level propositions. The data
itself arises from clothing surveys. The general method is described in
Coulson et al. (2001), although poor typesetting, and a lack of definition of
terms makes it hard to see. This package improves on the estimation in that
linear interpolation is not required, and standard numerical optimisation is
used instead. The zeta distribution has probability mass function </p>
<p style="text-align: center;"><code class="reqn">p(k)
= \frac{k^{-s}}{\zeta(s)}</code>
</p>
<p> where <code class="reqn">\zeta(s)</code>
is the Reimann Zeta function. Coulson et al. (2001) did not have an easy way
to rapidly compute this quantity, hence their use of linear interpolation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitDist(x, nterms = 10, start = 1, ...)

fitdist(x, nterms = 10, start = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitDist_+3A_x">x</code></td>
<td>
<p>an object of type <code>psData</code>, usually obtained from
<code><a href="#topic+readData">readData</a></code>.</p>
</td></tr>
<tr><td><code id="fitDist_+3A_nterms">nterms</code></td>
<td>
<p>the number of terms to compute the probability distribution
for.</p>
</td></tr>
<tr><td><code id="fitDist_+3A_start">start</code></td>
<td>
<p>a starting value for the optimiser.</p>
</td></tr>
<tr><td><code id="fitDist_+3A_...">...</code></td>
<td>
<p>other parameters - not currently used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns an object of class <code>psFit</code> which is a
<code>list</code> contains four elements:
</p>

<dl>
<dt><code>psData</code></dt><dd><p> &ndash; an object of class <code>psData</code>&ndash;see <code><a href="#topic+readData">readData</a></code>,</p>
</dd>
<dt><code>fit</code></dt><dd><p> &ndash; the fitted object from <code><a href="stats.html#topic+optim">optim</a></code>,</p>
</dd>
<dt><code>shape</code></dt><dd><p> &ndash; the maximum likelihood estimate of the shape parameter,</p>
</dd>
<dt><code>var.shape</code></dt><dd><p> - the maximum likelihood estimate of the shape parameter,</p>
</dd>
<dt><code>fitted</code></dt><dd><p> - a named <code>vector</code> containing the first <code>nterms of
the fitted distribution.</code></p>
</dd>
<dt><code>model</code></dt><dd><p> - set to <code>"zeta"</code> for this model</p>
</dd>
</dl>
<p>.
The output can be used in a variety of ways. If the interest is just in the
shape parameter estimate, then the <code>shape</code> member of the <code>psFit</code>
object contains this information. It is also displayed along with a number
of fitted probabilities by the <code><a href="#topic+print.psFit">print.psFit</a></code> method. The fitted
object can also be plotted using the plot method <code><a href="#topic+plot.psFit">plot.psFit</a></code>,
and to create a probability function with <code><a href="#topic+probfun">probfun</a></code>. **NOTE**
The value of the shape parameter that is printed (if you print the fitted
object) is different from that value that is stored in <code>shape</code>. The
stored value is for the <span class="pkg">VGAM</span> parameterisation of the Zeta
distribution which uses <code class="reqn">s^\prime = s - 1</code>. Therefore the
printed value is <code class="reqn">s = s^\prime + 1</code>. If you intend to use
the fitted value with <code><a href="VGAM.html#topic+dzeta">dzeta</a></code>, then you should use the
stored value <code class="reqn">s^\prime</code>.
</p>
<p>If <code>start</code> is not specified, then it is chosen randomly from (0.5, 1).
The reason the lower value is not zero is that small starting values seem
to cause instability in the likelihood. If you specify your own starting
value, it would be sensible to keep it above 0.5.
</p>


<h3>Value</h3>

<p>an object of class <code>psFit</code>&ndash;see Details.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>fitdist()</code>: Fit a Zeta Distribution to Forensic Data
export
</p>
</li></ul>


<h3>References</h3>

<p>Coulson, S. A., Buckleton, J. S., Gummer, A. B., and Triggs,
C.M., &quot;Glass on clothing and shoes of members of the general population and
people suspected of breaking crimes&quot;, Science &amp; Justice 2001: 41(1):
39&ndash;48.
</p>
<p>Evett, I. W. and Buckleton, J. S., &quot;The interpretation of glass evidence. A
practical approach&quot;, Journal of the Forensic Science Society 1990: 30(4):
215&ndash;223.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.psFit">plot.psFit</a></code>, <code><a href="#topic+print.psFit">print.psFit</a></code>,
<code><a href="#topic+probfun">probfun</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p = readData(system.file("extdata", "p.xlsx", package = "fitPS"))
fit = fitDist(p)
fit
</code></pre>

<hr>
<h2 id='fitlogDist'>Fit a Logarithmic Distribution to Forensic Data</h2><span id='topic+fitlogDist'></span><span id='topic+fitLogdist'></span><span id='topic+fitlogdist'></span>

<h3>Description</h3>

<p>This function uses maximum likelihood estimation (MLE) to estimate the shape
parameter of a logarithmic distribution from a set of observed counts
for either the number of groups/sources of forensically interesting material
(mostly glass or paint) recovered from clothing, or the number of
fragments/particles in each group. This, in turn, allows the estimation of
the P and S probabilities, as described by Evett and Buckleton (1990), which
used in computing the likelihood ratio (LR) for activity level propositions.
The data itself arises from clothing surveys. The logarithmic
distribution has probability mass function
</p>
<p style="text-align: center;"><code class="reqn">p(k) = \frac{\pi^k}{k\log_e(1-\pi)},0&lt;\pi&lt;1.</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>fitlogDist(x, nterms = 10, start = 0.5, ...)

fitLogdist(x, nterms = 10, start = 0.5, ...)

fitlogdist(x, nterms = 10, start = 0.5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitlogDist_+3A_x">x</code></td>
<td>
<p>an object of type <code>psData</code>, usually obtained from
<code><a href="#topic+readData">readData</a></code>.</p>
</td></tr>
<tr><td><code id="fitlogDist_+3A_nterms">nterms</code></td>
<td>
<p>the number of terms to compute the probability distribution
for.</p>
</td></tr>
<tr><td><code id="fitlogDist_+3A_start">start</code></td>
<td>
<p>a starting value for the optimiser.</p>
</td></tr>
<tr><td><code id="fitlogDist_+3A_...">...</code></td>
<td>
<p>other parameters - not currently used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns an object of class <code>psFit</code> which is a
<code>list</code> contains seven elements:
</p>

<dl>
<dt><code>psData</code></dt><dd><p> &ndash; an object of class <code>psData</code>&ndash;see <code><a href="#topic+readData">readData</a></code>,</p>
</dd>
<dt><code>fit</code></dt><dd><p> &ndash; the fitted object from <code><a href="stats.html#topic+optim">optim</a></code>,</p>
</dd>
<dt><code>pi</code></dt><dd><p> - the maximum likelihood estimate of the shape parameter,</p>
</dd>
<dt><code>var</code></dt><dd><p> &ndash; the estimated variance for the shape parameter,</p>
</dd>
<dt><code>fitted</code></dt><dd><p> &ndash; a named <code>vector</code> containing the first <code>nterms of
the fitted distribution.</code></p>
</dd>
</dl>



<h3>Value</h3>

<p>an object of class <code>psFit</code>&ndash;see Details.
</p>


<h3>References</h3>

<p>Evett, I. W. and Buckleton, J. S., &quot;The interpretation of glass
evidence. A practical approach&quot;, Journal of the Forensic Science Society
1990: 30(4): 215&ndash;223.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.psFit">plot.psFit</a></code>, <code><a href="#topic+print.psFit">print.psFit</a></code>,
<code><a href="#topic+probfun">probfun</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Psurveys)
roux = Psurveys$roux
fit = fitlogDist(roux)
fit
</code></pre>

<hr>
<h2 id='fitted.psFit'>S3 fitted method for an object of class <code>psFit</code></h2><span id='topic+fitted.psFit'></span>

<h3>Description</h3>

<p>S3 fitted method for an object of class <code>psFit</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psFit'
fitted(object, n = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.psFit_+3A_object">object</code></td>
<td>
<p>an object of class <code>psFit</code>, usually from <code><a href="#topic+fitDist">fitDist</a></code>
or <code><a href="#topic+fitZIDist">fitZIDist</a></code>.</p>
</td></tr>
<tr><td><code id="fitted.psFit_+3A_n">n</code></td>
<td>
<p>This parameter is <code>NULL</code> by default. If it is not <code>NULL</code>
then it must be either the number of fitted terms to be return, or, a vector
containing the desired fitted values.</p>
</td></tr>
<tr><td><code id="fitted.psFit_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>fitted</code>&mdash;not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a named vector of fitted probabilities
</p>

<hr>
<h2 id='fitZIDist'>Fit a Zero-Inflated Zeta Distribution to Forensic Data</h2><span id='topic+fitZIDist'></span><span id='topic+fitZIdist'></span><span id='topic+fitzidist'></span>

<h3>Description</h3>

<p>This function uses maximum likelihood estimation (MLE) to estimate mixing
parameter and the shape parameter of a zero-inflated zeta distribution from a
set of observed counts for either the number of groups/sources of
forensically interesting material (mostly glass or paint) recovered from
clothing, or the number of fragments/particles in each group. This, in turn,
allows the estimation of the P and S probabilities, as described by Evett and
Buckleton (1990), which used in computing the likelihood ratio (LR) for
activity level propositions. The data itself arises from clothing surveys.
The zero-inflated zeta distribution has probability mass function
</p>
<p style="text-align: center;"><code class="reqn">p(k) = \begin{cases}
\pi + \frac{(1-\pi)}{\zeta(s)}&amp;,k=0, \\
\frac{(1-\pi)k^{-s}}{\zeta(s)}&amp;,k=1,2,\ldots
\end{cases}
</code>
</p>

<p>where <code class="reqn">\zeta(s)</code> is the Reimann Zeta function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitZIDist(x, nterms = 10, start = c(0.5, 1), ...)

fitZIdist(x, nterms = 10, start = c(0.5, 1), ...)

fitzidist(x, nterms = 10, start = c(0.5, 1), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitZIDist_+3A_x">x</code></td>
<td>
<p>an object of type <code>psData</code>, usually obtained from
<code><a href="#topic+readData">readData</a></code>.</p>
</td></tr>
<tr><td><code id="fitZIDist_+3A_nterms">nterms</code></td>
<td>
<p>the number of terms to compute the probability distribution
for.</p>
</td></tr>
<tr><td><code id="fitZIDist_+3A_start">start</code></td>
<td>
<p>a starting value for the optimiser.</p>
</td></tr>
<tr><td><code id="fitZIDist_+3A_...">...</code></td>
<td>
<p>other parameters - not currently used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns an object of class <code>psFit</code> which is a
<code>list</code> contains seven elements:
</p>

<dl>
<dt><code>psData</code></dt><dd><p> &ndash; an object of class <code>psData</code>&ndash;see <code><a href="#topic+readData">readData</a></code>,</p>
</dd>
<dt><code>fit</code></dt><dd><p> &ndash; the fitted object from <code><a href="stats.html#topic+optim">optim</a></code>,</p>
</dd>
<dt><code>pi</code></dt><dd><p> - the maximum likelihood estimate of the mixing parameter,</p>
</dd>
<dt><code>shape</code></dt><dd><p> &ndash; the maximum likelihood estimate of the shape parameter,</p>
</dd>
<dt><code>var.cov</code></dt><dd><p> &ndash; the estimated variance-covariance matrix for the parameters,</p>
</dd>
<dt><code>fitted</code></dt><dd><p> &ndash; a named <code>vector</code> containing the first <code>nterms of
the fitted distribution.</code></p>
</dd>
<dt><code>model</code></dt><dd><p> &ndash; set to <code>"ziz"</code> for this model.</p>
</dd>
</dl>

<p>The output can be used in a variety of ways. If the interest is just in the
mixing and shape parameter estimates, then the <code>pi</code> and <code>shape</code>
member of the <code>psFit</code> object contains this information. It is also
displayed along with a number of fitted probabilities by the
<code><a href="#topic+print.psFit">print.psFit</a></code> method. The fitted object can also be plotted
using the plot method <code><a href="#topic+plot.psFit">plot.psFit</a></code>, and to create a probability
function with <code><a href="#topic+probfun">probfun</a></code>. **NOTE** The value of the shape
parameter that is printed (if you print the fitted object) is different
from that value that is stored in <code>shape</code>. The stored value is for the
<span class="pkg">VGAM</span> parameterisation of the zeta distribution which uses
<code class="reqn">s^\prime = s - 1</code>. Therefore the printed value is <code class="reqn">s =
s^\prime + 1</code>. If you intend to use the fitted value with
<code><a href="VGAM.html#topic+dzeta">dzeta</a></code>, then you should use the stored value
<code class="reqn">s^\prime</code>.
</p>
<p>If <code>start</code> is not specified, then it is set to (0.5, 1). The reason
the starting values are not zero is that small starting values seem to
cause instability in the likelihood. If you specify your own starting
value, it would be sensible to keep both above 0.5.
</p>


<h3>Value</h3>

<p>an object of class <code>psFit</code>&ndash;see Details.
</p>


<h3>References</h3>

<p>Evett, I. W. and Buckleton, J. S., &quot;The interpretation of glass
evidence. A practical approach&quot;, Journal of the Forensic Science Society
1990: 30(4): 215&ndash;223.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.psFit">plot.psFit</a></code>, <code><a href="#topic+print.psFit">print.psFit</a></code>,
<code><a href="#topic+probfun">probfun</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Psurveys)
roux = Psurveys$roux
fit = fitZIDist(roux)
fit
</code></pre>

<hr>
<h2 id='makePSData'>Create a survey data set manually</h2><span id='topic+makePSData'></span><span id='topic+makeData'></span><span id='topic+createPSData'></span>

<h3>Description</h3>

<p>Create a survey data set from the command line rather than reading data in
from a file. This function is likely to be only useful where there are a very
small number of group sizes, or sizes of groups of glass.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makePSData(n, count = NULL, type = c("P", "S"), notes = NULL)

makeData(n, count = NULL, type = c("P", "S"), notes = NULL)

createPSData(n, count = NULL, type = c("P", "S"), notes = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="makePSData_+3A_n">n</code></td>
<td>
<p>Either the number of groups of glass or the size of different groups
of glass, or a <code>vector</code> of observed groups of glass, or group sizes.
See details for a longer explanation.</p>
</td></tr>
<tr><td><code id="makePSData_+3A_count">count</code></td>
<td>
<p>Either the number of people in the survey sample who had
<code class="reqn">n</code> groups of glass on their clothing, or the number of people who
had a group of glass of size <code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="makePSData_+3A_type">type</code></td>
<td>
<p>either <code>"P"</code> or <code>"S"</code></p>
</td></tr>
<tr><td><code id="makePSData_+3A_notes">notes</code></td>
<td>
<p>a <code><a href="utils.html#topic+bibentry">bibentry</a></code> or a character string which
allows extra information about the data to be stored, such as the source,
or reference. <code>NULL</code> by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>count</code> is <code>NULL</code>, then it is assumed that <code>n</code>
consists of actual observed group sizes or numbers of groups of glass found
on a survey of N individuals. That is, one could provide <code>n = rep(0:1,
  98, 1)</code> or <code>n = 0:1, count = c(98, 1)</code>. The former is more useful when
performing simulation studies.
</p>


<h3>Value</h3>

<p>an object of type <code>psData</code>&mdash;see <code><a href="#topic+readData">readData</a></code> for more
details.
</p>


<h3>See Also</h3>

<p>readData
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## recreate the data read in the readData example
p1 = makePSData(n = c(0, 1, 2), count = c(98, 1, 1), type = "P")
s1 = makePSData(n = 1:3, count = c(1, 1, 1), type = "S")
p1
s1

</code></pre>

<hr>
<h2 id='mean.psData'>An S3 method for computing the mean of clothing survey for the number of
groups or size of groups</h2><span id='topic+mean.psData'></span>

<h3>Description</h3>

<p>An S3 method for computing the mean of clothing survey for the number of
groups or size of groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psData'
mean(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mean.psData_+3A_x">x</code></td>
<td>
<p>an object of class <code>psData</code>&mdash;<code><a href="#topic+readData">readData</a></code> for more
details.</p>
</td></tr>
<tr><td><code id="mean.psData_+3A_...">...</code></td>
<td>
<p>other arguments which are passed to <code><a href="base.html#topic+sum">sum</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>the mean of the data. If there are <code class="reqn">r_i</code> observations of
the value <code class="reqn">n_i</code> then the mean is given by
</p>
<p style="text-align: center;"><code class="reqn">\sum_i\frac{r_i\times n_i}{\sum_i{r_i}}</code>
</p>
<p>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Psurveys)
mean(Psurveys$roux)
</code></pre>

<hr>
<h2 id='plot.psFit'>S3 plot method for an object of class <code>psFit</code></h2><span id='topic+plot.psFit'></span>

<h3>Description</h3>

<p>S3 plot method for an object of class <code>psFit</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psFit'
plot(
  x,
  ylim = c(0, 1),
  conf = FALSE,
  conf.level = 0.95,
  ci.type = c("wald", "prof"),
  log.scale = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.psFit_+3A_x">x</code></td>
<td>
<p>an object of class <code>psFit</code>, usually from <code><a href="#topic+fitDist">fitDist</a></code>
or <code><a href="#topic+fitZIDist">fitZIDist</a></code>.</p>
</td></tr>
<tr><td><code id="plot.psFit_+3A_ylim">ylim</code></td>
<td>
<p>the limits of the y-axis.</p>
</td></tr>
<tr><td><code id="plot.psFit_+3A_conf">conf</code></td>
<td>
<p>if <code>TRUE</code>, and the model is the the zeta model (as opposed
to the zero-inflated zeta (ZIZ), then confidence intervals (based on the standard
error of the shape parameter) are drawn on the plot. If the ZIZ model has
been used, then this is ignored.</p>
</td></tr>
<tr><td><code id="plot.psFit_+3A_conf.level">conf.level</code></td>
<td>
<p>the confidence level for the confidence intervals. Must be
between 0.75 and 0.99.</p>
</td></tr>
<tr><td><code id="plot.psFit_+3A_ci.type">ci.type</code></td>
<td>
<p>Specifies the type of confidence interval. If <code>conf ==
TRUE</code>, then then <code>ci.type</code> can be either <code>"wald"</code> <code>"prof"</code> (or
an abbreviation), depending on whether the Wald interval or the profile
likelihood interval should be used. Note that these are intervals on the shape
parameter and not the density heights. Therefore the intervals around the
probabilities should not really be thought of as confidence intervals but
rather something more similar to a &quot;sensitivity&quot; interval.</p>
</td></tr>
<tr><td><code id="plot.psFit_+3A_log.scale">log.scale</code></td>
<td>
<p>if <code>TRUE</code> the <code class="reqn">y</code>-axis is changed to a
logarithmic (base 10) axis.</p>
</td></tr>
<tr><td><code id="plot.psFit_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p = readData(system.file("extdata", "p.xlsx", package = "fitPS"))
fit = fitDist(p)
plot(fit)

## An example with Wald generated intervals
plot(fit, conf = TRUE)

plot(fit, conf = TRUE, ci.type = "p")
</code></pre>

<hr>
<h2 id='predict.psFit'>S3 predict method for an object of class <code>psFit</code></h2><span id='topic+predict.psFit'></span>

<h3>Description</h3>

<p>S3 predict method for an object of class <code>psFit</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psFit'
predict(
  object,
  newdata,
  interval = c("none", "prof", "wald"),
  level = 0.95,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.psFit_+3A_object">object</code></td>
<td>
<p>an object of class <code>psFit</code>, usually from <code><a href="#topic+fitDist">fitDist</a></code>
or <code><a href="#topic+fitZIDist">fitZIDist</a></code>.</p>
</td></tr>
<tr><td><code id="predict.psFit_+3A_newdata">newdata</code></td>
<td>
<p>an optional vector of integers at which to calculate
<code class="reqn">\Pr(X = x)</code>.</p>
</td></tr>
<tr><td><code id="predict.psFit_+3A_interval">interval</code></td>
<td>
<p>either <code>"none"</code>, <code>"prof"</code>, or <code>"wald"</code> and can
be abbreviated. If <code>"prof"</code> or <code>"wald"</code> AND the zeta model has
been used  then an interval, based on the bounds of a 100 * <code>level</code>
confidence interval for the shape parameter, is given for each predicted
probability. The interval is provided based on either a Profile Likelihood,
or a Wald, confidence interval for the shape, and therefore cannot really
be regarded as a confidence interval for the probabilities. The intervals
might be more sensibly regarded as a measure of how sensitive the
probabilities are to the choice of shape parameter. NOTE: this parameter is
ignored if the Zero-inflated (ZIZ) model has been used.</p>
</td></tr>
<tr><td><code id="predict.psFit_+3A_level">level</code></td>
<td>
<p>the level of a confidence interval. Ignored if <code>interval ==
"none"</code>.</p>
</td></tr>
<tr><td><code id="predict.psFit_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>predict</code>&mdash;not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>either a named vector of fitted probabilities, or a <code>data.frame</code>
with columns <code>predicted</code>, <code>lower</code>, and <code>upper</code> and the row
names set to show what terms are being calculatd
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Psurveys)
roux = Psurveys$roux
fit = fitDist(roux)
predict(fit, interval = "prof")
</code></pre>

<hr>
<h2 id='print.psData'>S3 print method for an object of class <code>psData</code></h2><span id='topic+print.psData'></span>

<h3>Description</h3>

<p>S3 print method for an object of class <code>psData</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psData'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.psData_+3A_x">x</code></td>
<td>
<p>an object of class <code>psData</code>, usually from <code><a href="#topic+readData">readData</a></code>
or <code><a href="#topic+makePSData">makePSData</a></code></p>
</td></tr>
<tr><td><code id="print.psData_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>print</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>

<hr>
<h2 id='print.psFit'>S3 print method for an object of class <code>psFit</code></h2><span id='topic+print.psFit'></span>

<h3>Description</h3>

<p>S3 print method for an object of class <code>psFit</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psFit'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.psFit_+3A_x">x</code></td>
<td>
<p>an object of class <code>psFit</code>, usually from <code><a href="#topic+fitDist">fitDist</a></code>
or #' <code><a href="#topic+fitZIDist">fitZIDist</a></code>.</p>
</td></tr>
<tr><td><code id="print.psFit_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>print</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>

<hr>
<h2 id='probfun'>Probability Functions</h2><span id='topic+probfun'></span>

<h3>Description</h3>

<p>Creates a probability function that allows the computation of any P or S
term.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probfun(psFitobj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probfun_+3A_psfitobj">psFitobj</code></td>
<td>
<p>an object of class <code>psFit</code>&ndash;see <code><a href="#topic+fitDist">fitDist</a></code>
and <code><a href="#topic+fitZIDist">fitZIDist</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a function that can be used to calculate any P or S term.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p = readData(system.file("extdata", "p.xlsx", package = "fitPS"))
fit = fitDist(p)
P = probfun(fit)
P(0:5)
</code></pre>

<hr>
<h2 id='Psurveys'>Number of Groups of Glass Data</h2><span id='topic+Psurveys'></span>

<h3>Description</h3>

<p>Count data from six different surveys looking at the number of sources/groups
of glass found on the upper surfaces of clothing taken from the general public.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Psurveys)
</code></pre>


<h3>Format</h3>

<p>A <code>list</code> with nine objects of class <code>psData</code>&mdash;see
<code><a href="#topic+readData">readData</a></code> for more details. The elements of the list are
named: <code>coulson</code>, <code>jackson</code>, <code>lau</code>, <code>lewis.all</code>,
<code>lewis.clothing</code>, <code>lewis.shoes</code>, <code>pettard</code>,
<code>ross</code>, and <code>roux</code>, corresponding to the lead author in each of
the references given below. <code>lau</code>, <code>pettard</code>, and <code>ross</code>
were taken from Coulson et al. (2001) rather than the original source. The three
objects starting with <code>lewis</code> represent the combined data (<code>all</code>),
the groups of glass found on the outer clothing (<code>clothing</code>), and the groups of
glass found on shoes/footwear (<code>shoes</code>).
</p>


<h3>Source</h3>

<p>Coulson, S. A., Buckleton, J. S., Gummer, A. B., and Triggs, C. M.
(2001) <a href="https://doi.org/10.1016/S1355-0306%2801%2971847-3">doi:10.1016/S1355-0306(01)71847-3</a> Glass on clothing and shoes of members
of the general population and people suspected of breaking crimes, Science &amp;
Justice, 41(1):39&ndash;48.
</p>


<h3>References</h3>

<p>Lau L, Beveridge AD, Callowhill BC, Conners N, Foster K, Groves RJ, Ohashi KN, Sumner AM, Wong H (1997).
&ldquo;The Frequency of Occurrence of Paint and Glass on the Clothing of High School Students.&rdquo;
<em>Canadian Society of Forensic Science Journal</em>, <b>30</b>(4), 233&ndash;240.
<a href="https://doi.org/10.1080/00085030.1997.10757103">doi:10.1080/00085030.1997.10757103</a>.
</p>
<p>Lewis AD, Alexander LC, Ovide O, Duffett O, Curran JM, Buzzini P, Trejos T (2023).
&ldquo;A study on the occurrence of glass and paint across various cities in the United States&mdash;Part I: Background presence of glass in the general population.&rdquo;
<em>Forensic Chemistry</em>, <b>34</b>, 100497.
<a href="https://doi.org/10.1016/j.forc.2023.100497">doi:10.1016/j.forc.2023.100497</a>.
</p>
<p>Petterd CI, McCallum I, Bradford L, Brinch K, Stewart S (1998).
&ldquo;Glass particles in the clothing of the general population in Canberra&mdash;a survey.&rdquo;
In <em>Proceedings of the 14th International Symposium on the Forensic Sciences</em>.
</p>
<p>Ross P, Nguyen H (1998).
&ldquo;A survey of clothing for the presence of glass fragments.&rdquo;
In <em>Proceedings of the 14th International Symposium on the Forensic Sciences</em>.
</p>
<p>Roux C, Kirk R, Benson S, Van Haren T, Petterd CI (2001).
&ldquo;Glass particles in footwear of members of the public in south-eastern Australia&mdash;a survey.&rdquo;
<em>Forensic Science International</em>, <b>116</b>(2), 149&ndash;156.
<a href="https://doi.org/10.1016/S0379-0738%2800%2900355-8">doi:10.1016/S0379-0738(00)00355-8</a>.
</p>
<p>Jackson F,  Maynard P, Cavanagh-Steer K, Dusting T, Roux C (2013).
&ldquo;A survey of glass found on the headwear and head hair of a random population vs. people working with glass.&rdquo;
<em>Forensic Science International</em>, <b>226</b>(1), 125&ndash;131.
<a href="https://doi.org/10.1016/j.forsciint.2012.12.017">doi:10.1016/j.forsciint.2012.12.017</a>.
</p>

<hr>
<h2 id='readData'>Read count data from file</h2><span id='topic+readData'></span>

<h3>Description</h3>

<p>Reads observed counts of either the number of groups or the size of the
groups. The file must have only two columns. One of the columns must be
labelled P or S and the other count. It does not matter if the column names
are in upper case or not. The P column can have labels 0, 1, 2, ...
representing the observation of 0, 1, 2, or more groups. The corresponding
count column should contain a positive (non-zero) count for each number of
groups. Similarly, if the file contains S counts, then the S column can
contain labels 1, 2, ... representing the observation of 1, 2, ...
fragments in a group. Note that zeros are neither allowed, or useful, in the
file as they both simply result in log-likelihood terms of zero, and
therefore make no difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readData(fileName, notes = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readData_+3A_filename">fileName</code></td>
<td>
<p>the name of the file to be read. Must be either a modern
(xlsx) Excel file or a csv file.</p>
</td></tr>
<tr><td><code id="readData_+3A_notes">notes</code></td>
<td>
<p>any additional information about the data, such as the source or
a reference.</p>
</td></tr>
<tr><td><code id="readData_+3A_...">...</code></td>
<td>
<p>any additional parameters which will be passed to either
<code>read_excel</code> or <code>read.csv</code> depending on the extension of your
input file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>psData</code> which is a list containing member
variables:
</p>

<dl>
<dt><code>type</code></dt><dd><p> &ndash; either <code>"P"</code> or <code>"S"</code></p>
</dd>
<dt><code>data</code></dt><dd><p> &ndash; a <code>data.frame</code> which contains columns
<code>n</code> and <code>rn</code>, representing the number of groups/fragments, and the
number of times that was seen, respectively.</p>
</dd>
<dt><code>notes</code></dt><dd><p> &mdash; either a <code><a href="utils.html#topic+bibentry">bibentry</a></code> or a character
string which allows extra information about the data to be stored, such as
the source, or reference.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>p = readData(system.file("extdata", "p.xlsx", package = "fitPS"))
p
s = readData(system.file("extdata", "s.xlsx", package = "fitPS"))
s
</code></pre>

<hr>
<h2 id='rzeta'>Generate random variates from a zeta distribution</h2><span id='topic+rzeta'></span>

<h3>Description</h3>

<p>Generate random variates from a zeta distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rzeta(n, shape)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rzeta_+3A_n">n</code></td>
<td>
<p>Same as <code><a href="stats.html#topic+Poisson">Poisson</a></code>.</p>
</td></tr>
<tr><td><code id="rzeta_+3A_shape">shape</code></td>
<td>
<p>The positive shape parameter </p>
<p style="text-align: center;"><code class="reqn">s = \alpha - 1</code>
</p>
<p>.
</p>
<p>See <code><a href="VGAM.html#topic+rzeta">rzeta</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='rZIzeta'>Generate zero inflated zeta random variates</h2><span id='topic+rZIzeta'></span><span id='topic+rzizeta'></span>

<h3>Description</h3>

<p>Generate zero inflated zeta random variates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rZIzeta(n, pi = 0.5, shape = 1, offset = 0)

rzizeta(n, pi = 0.5, shape = 1, offset = 0)

rzizeta(n, pi = 0.5, shape = 1, offset = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rZIzeta_+3A_n">n</code></td>
<td>
<p>the number of observations.</p>
</td></tr>
<tr><td><code id="rZIzeta_+3A_pi">pi</code></td>
<td>
<p>the mixing parameter for the zero-inflated zeta model&mdash;must be in
(0, 1).</p>
</td></tr>
<tr><td><code id="rZIzeta_+3A_shape">shape</code></td>
<td>
<p>the shape parameter for the zero-inflated zeta. Must be greater
than zero.</p>
</td></tr>
<tr><td><code id="rZIzeta_+3A_offset">offset</code></td>
<td>
<p>the zeta distribution returns random variates that are greater
than, or equal to one. If the offset is greater than 0, then the
distribution is anchored on (has minimum value of) <code>1 - offset</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Technically this function returns values from the one-inflated zeta
distribution. However, if <code>offset</code> is greater than zero (and typically
we expect it to be 1), then the minimium random variate value is <code>1 -
  offset</code>. We chose the name &quot;zero-inflated zeta&quot; as more people are familiar
with zero-inflated models.
</p>


<h3>Value</h3>

<p>a vector of random variates from a zero-inflated zeta model
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Psurveys)
roux = Psurveys$roux
fit.zi = fitZIDist(roux)
x = rZIzeta(n = sum(roux$data$rn), pi = fit.zi$pi, shape = fit.zi$shape)
table(x)
</code></pre>

<hr>
<h2 id='Ssurveys'>Size of Groups of Glass Data</h2><span id='topic+Ssurveys'></span>

<h3>Description</h3>

<p>Count data from six different surveys looking at the number of sources/groups
of glass found on the upper surfaces of clothing taken from the general
public.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Psurveys)
</code></pre>


<h3>Format</h3>

<p>A <code>list</code> with five objects of class <code>psData</code>&mdash;see
<code><a href="#topic+readData">readData</a></code> for more details. The elements of the list are
named: <code>jackson</code>, <code>lau</code>, <code>pettard</code>, <code>ross</code>, and
<code>roux</code>, corresponding to the lead author in each of the references
given below. <code>lau</code>, <code>pettard</code>, and <code>ross</code> were taken from
Coulson et al. (2001) rather than the original source.
</p>


<h3>Source</h3>

<p>Coulson, S. A., Buckleton, J. S., Gummer, A. B., and Triggs, C. M.
(2001) <a href="https://doi.org/10.1016/S1355-0306%2801%2971847-3">doi:10.1016/S1355-0306(01)71847-3</a> Glass on clothing and shoes of
members of the general population and people suspected of breaking crimes,
Science &amp; Justice, 41(1):39&ndash;48.
</p>


<h3>References</h3>

<p>Lau L, Beveridge AD, Callowhill BC, Conners N, Foster K, Groves RJ, Ohashi KN, Sumner AM, Wong H (1997).
&ldquo;The Frequency of Occurrence of Paint and Glass on the Clothing of High School Students.&rdquo;
<em>Canadian Society of Forensic Science Journal</em>, <b>30</b>(4), 233&ndash;240.
<a href="https://doi.org/10.1080/00085030.1997.10757103">doi:10.1080/00085030.1997.10757103</a>.
</p>
<p>Petterd CI, McCallum I, Bradford L, Brinch K, Stewart S (1998).
&ldquo;Glass particles in the clothing of the general population in Canberra&mdash;a survey.&rdquo;
In <em>Proceedings of the 14th International Symposium on the Forensic Sciences</em>.
</p>
<p>Ross P, Nguyen H (1998).
&ldquo;A survey of clothing for the presence of glass fragments.&rdquo;
In <em>Proceedings of the 14th International Symposium on the Forensic Sciences</em>.
</p>
<p>Coulson SA, Buckleton JS, Gummer AB, Triggs CM (20011).
&ldquo;Glass on clothing and shoes of members of the general population and people suspected of breaking crimes.&rdquo;
<em>Science &amp; Justice</em>, <b>41</b>(1), 39&ndash;48.
<a href="https://doi.org/10.1016/S1355-0306%2801%2971847-3">doi:10.1016/S1355-0306(01)71847-3</a>.
</p>
<p>Roux C, Kirk R, Benson S, Van Haren T, Petterd CI (2001).
&ldquo;Glass particles in footwear of members of the public in south-eastern Australia&mdash;a survey.&rdquo;
<em>Forensic Science International</em>, <b>116</b>(2), 149&ndash;156.
<a href="https://doi.org/10.1016/S0379-0738%2800%2900355-8">doi:10.1016/S0379-0738(00)00355-8</a>.
</p>
<p>Jackson F,  Maynard P, Cavanagh-Steer K, Dusting T, Roux C (2013).
&ldquo;A survey of glass found on the headwear and head hair of a random population vs. people working with glass.&rdquo;
<em>Forensic Science International</em>, <b>226</b>(1), 125&ndash;131.
<a href="https://doi.org/10.1016/j.forsciint.2012.12.017">doi:10.1016/j.forsciint.2012.12.017</a>.
</p>

<hr>
<h2 id='summary.psFit'>S3 summary method for an object of class <code>psFit</code></h2><span id='topic+summary.psFit'></span>

<h3>Description</h3>

<p>S3 summary method for an object of class <code>psFit</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psFit'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.psFit_+3A_object">object</code></td>
<td>
<p>an object of class <code>psFit</code>, usually from <code><a href="#topic+fitDist">fitDist</a></code>
or <code><a href="#topic+fitZIDist">fitZIDist</a></code></p>
</td></tr>
<tr><td><code id="summary.psFit_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>summary</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Experimental because I am unsure if it is useful. If <code>object</code> is a zero-inflated zeta fitted object,
then the function carries out a likelihood ratio test for the value of pi. Currently not implemented for the logarithmic
distribution because we are currently not interested in the logarithmic distribution.
</p>


<h3>Value</h3>

<p>No return value, called for side effects
</p>

<hr>
<h2 id='var'>Variance generic</h2><span id='topic+var'></span>

<h3>Description</h3>

<p>Variance generic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="var_+3A_x">x</code></td>
<td>
<p>an object for which we want to compute the sample variance.</p>
</td></tr>
<tr><td><code id="var_+3A_...">...</code></td>
<td>
<p>Any additional arguments to be passed to <code>var</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='var.psData'>An S3 method for computing the variance of clothing survey for the number of
groups or size of groups</h2><span id='topic+var.psData'></span>

<h3>Description</h3>

<p>An S3 method for computing the variance of clothing survey for the number of
groups or size of groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psData'
var(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="var.psData_+3A_x">x</code></td>
<td>
<p>an object of class <code>psData</code>&mdash;<code><a href="#topic+readData">readData</a></code> for more
details.</p>
</td></tr>
<tr><td><code id="var.psData_+3A_...">...</code></td>
<td>
<p>other arguments which are passed to <code><a href="base.html#topic+sum">sum</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>the mean of the data. If there are <code class="reqn">r_i</code> observations of
the value <code class="reqn">n_i</code> then the variance is computed by
<code class="reqn">\mathrm{E}[X^2]-\mathrm{E}[X]^2</code>, where
<code class="reqn">\mathrm{E}[X]</code> is computed using </p>
<p style="text-align: center;"><code class="reqn">\sum_i\frac{r_i\times
  n_i}{\sum_i{r_i}}</code>
</p>
<p> , and
<code class="reqn">\mathrm{E}[X^2]</code> is computed by </p>
<p style="text-align: center;"><code class="reqn">\sum_i\frac{r_i\times
  n_i^2}{\sum_i{r_i}}</code>
</p>
<p>. We realise that the
computational formula,
<code class="reqn">\mathrm{E}[X^2]-\mathrm{E}[X]^2</code>, is usually not
regarded as computationally stable, but the magnitude of the numbers
involved is such that, that this is not likely to cause an issue.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Psurveys)
var(Psurveys$roux)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
