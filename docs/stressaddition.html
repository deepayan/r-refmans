<!DOCTYPE html><html lang="en"><head><title>Help for package stressaddition</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {stressaddition}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#stressaddition-package'><p>stressaddition: Modelling Tri-Phasic Concentration-Response Relationships</p></a></li>
<li><a href='#ecxsys'><p>ECx-SyS</p></a></li>
<li><a href='#lc'><p>Lethal Concentrations</p></a></li>
<li><a href='#log10_ticks'><p>Logarithmic axis tick marks</p></a></li>
<li><a href='#multi_tox'><p>Predict the survival of binary toxicant mixtures</p></a></li>
<li><a href='#multiple_stress'><p>Survival of Daphnia magna exposed to multiple stressors</p></a></li>
<li><a href='#plot_ecxsys'><p>Plot the results of the ECx-SyS model</p></a></li>
<li><a href='#predict_ecxsys'><p>Predict survival and stress</p></a></li>
<li><a href='#Stressconversion'><p>Convert Between Stress and Survival</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Modelling Tri-Phasic Concentration-Response Relationships</td>
</tr>
<tr>
<td>Version:</td>
<td>3.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-10-19</td>
</tr>
<tr>
<td>Description:</td>
<td>The stress addition approach is an alternative to the traditional
    concentration addition or effect addition models. It allows the modelling
    of tri-phasic concentration-response relationships either as single toxicant
    experiments, in combination with an environmental stressor or as mixtures of
    two toxicants. See Liess et al. (2019) &lt;<a href="https://doi.org/10.1038%2Fs41598-019-51645-4">doi:10.1038/s41598-019-51645-4</a>&gt;
    and Liess et al. (2020) &lt;<a href="https://doi.org/10.1186%2Fs12302-020-00394-7">doi:10.1186/s12302-020-00394-7</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Copyright:</td>
<td>file inst/COPYRIGHTS</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://git.ufz.de/oekotox/stressaddition">https://git.ufz.de/oekotox/stressaddition</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>drc (&ge; 3.0), plotrix</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 2.1.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-11-03 13:15:30 UTC; Sebastian</td>
</tr>
<tr>
<td>Author:</td>
<td>Sebastian Henz <a href="https://orcid.org/0000-0001-8299-8852"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Matthias Liess <a href="https://orcid.org/0000-0002-3321-8909"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Naeem Shahid <a href="https://orcid.org/0000-0001-6581-1654"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Helmholtz-Zentrum fuer Umweltforschung GmbH - UFZ [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sebastian Henz &lt;bastihz.dev@posteo.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-11-03 21:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='stressaddition-package'>stressaddition: Modelling Tri-Phasic Concentration-Response Relationships</h2><span id='topic+stressaddition'></span><span id='topic+stressaddition-package'></span>

<h3>Description</h3>

<p>The stress addition approach is an alternative to the traditional
concentration addition or effect addition models. It allows the modelling
of tri-phasic concentration-response relationships either as single toxicant
experiments, in combination with an environmental stressor or as mixtures of
two toxicants. See Liess et al. (2019) &lt;doi:10.1038/s41598-019-51645-4&gt;
and Liess et al. (2020) &lt;doi:10.1186/s12302-020-00394-7&gt;.
</p>


<h3>Details</h3>

<p>This R package contains the definitions of the
<a href="#topic+ecxsys">ECx-SyS</a> model and the <a href="#topic+multi_tox">Multi-TOX</a> model.
See the publications linked below for more information including equations.
</p>
<p>Author contributions: M. Liess conceived the ECx-SyS and Multi-TOX models.
S. Henz developed this R package. N. Shahid contributed to the optimization
of the Multi-TOX model and provided the <a href="#topic+multiple_stress">multiple_stress</a> data set.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Sebastian Henz <a href="mailto:bastihz.dev@posteo.de">bastihz.dev@posteo.de</a> (<a href="https://orcid.org/0000-0001-8299-8852">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Matthias Liess (<a href="https://orcid.org/0000-0002-3321-8909">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Naeem Shahid (<a href="https://orcid.org/0000-0001-6581-1654">ORCID</a>) [contributor]
</p>
</li>
<li><p> Helmholtz-Zentrum fuer Umweltforschung GmbH - UFZ [copyright holder, funder]
</p>
</li></ul>



<h3>References</h3>

<p><a href="https://doi.org/10.1038/s41598-019-51645-4">Liess, M.,
Henz, S. &amp; Knillmann, S. Predicting low-concentration effects of
pesticides. Sci Rep 9, 15248 (2019).</a>
</p>
<p><a href="https://doi.org/10.1186/s12302-020-00394-7">Liess, M., Henz, S. &amp;
Shahid, N. Modeling the synergistic effects of
toxicant mixtures. Environ Sci Eur 32, 119 (2020).</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://git.ufz.de/oekotox/stressaddition">https://git.ufz.de/oekotox/stressaddition</a>
</p>
</li></ul>


<hr>
<h2 id='ecxsys'>ECx-SyS</h2><span id='topic+ecxsys'></span>

<h3>Description</h3>

<p>ECx-SyS is a model for tri-phasic concentration-response relationships where
hormetic and subhormetic effects are observed at low concentrations. It
expands the Stress Addition Model (SAM) by introducing system stress (SyS)
which is negatively correlated with toxicant stress. A constant environmental
stress can be included. See the publication for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecxsys(
  concentration,
  hormesis_concentration,
  survival_tox_observed,
  survival_tox_env_observed = NULL,
  survival_max = 100,
  curves_concentration_max = NULL,
  p = 3.2,
  q = 3.2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ecxsys_+3A_concentration">concentration</code></td>
<td>
<p>A vector of concentrations. Must be sorted in ascending
order and the first element must be 0 to indicate the control.</p>
</td></tr>
<tr><td><code id="ecxsys_+3A_hormesis_concentration">hormesis_concentration</code></td>
<td>
<p>The concentration where the hormesis occurs.
This is usually the concentration of the highest survival after the
control.</p>
</td></tr>
<tr><td><code id="ecxsys_+3A_survival_tox_observed">survival_tox_observed</code></td>
<td>
<p>A vector of survival values observed at the given
concentrations and in absence of environmental stress. Values must be
between 0 and <code>survival_max</code>.</p>
</td></tr>
<tr><td><code id="ecxsys_+3A_survival_tox_env_observed">survival_tox_env_observed</code></td>
<td>
<p>Survival values observed in the presence of
environmental stress. Must be between 0 and <code>survival_max</code>.</p>
</td></tr>
<tr><td><code id="ecxsys_+3A_survival_max">survival_max</code></td>
<td>
<p>The maximum value the survival could possibly reach. For
survival data in percent this should be 100 (the default).</p>
</td></tr>
<tr><td><code id="ecxsys_+3A_curves_concentration_max">curves_concentration_max</code></td>
<td>
<p>The maximum concentration of the predicted
curves. This might be useful if for example your highest observed
concentration is 30 but you would like to know the predicted values on a
scale between 0 and 100.</p>
</td></tr>
<tr><td><code id="ecxsys_+3A_p">p</code>, <code id="ecxsys_+3A_q">q</code></td>
<td>
<p>The shape parameters of the beta distribution. Default is
<code>p = q = 3.2</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is advised to complete the curve down to zero for optimal prediction.
Therefore <code>survival_tox_observed</code> in the highest concentration should be
at or close to zero. If the model does not fit properly try adding a survival
of 0 at ten times the maximum observed concentration.
</p>
<p>The vectors <code>concentration</code>, <code>survival_tox_observed</code> and
<code>survival_tox_env_observed</code> (if provided) must be of equal length and
sorted by increasing concentration.
</p>


<h3>Value</h3>

<p>A list (of class ecxsys) containing many different objects of which
the most important are listed below. The survival and stress vectors
correspond to the provided concentrations.
</p>

<dl>
<dt>survival_tox</dt><dd><p>Modeled survival resulting from toxicant stress.</p>
</dd>
<dt>survival_tox_sys</dt><dd><p>Modeled survival resulting from toxicant and
system stress.</p>
</dd>
<dt>survival_tox_env</dt><dd><p>Modeled survival resulting from toxicant and
environmental stress.</p>
</dd>
<dt>survival_tox_env_sys</dt><dd><p>Modeled survival resulting from toxicant,
environmental and system stress.</p>
</dd>
<dt>survival_tox_LL5</dt><dd><p>The survival predicted by the five-parameter
log-logistic model derived from the observations under toxicant stress
but without environmental stress.</p>
</dd>
<dt>survival_tox_env_LL5</dt><dd><p>The survival predicted by the five-parameter
log-logistic model derived from the observations under toxicant stress
with environmental stress.</p>
</dd>
<dt>curves</dt><dd><p>A data frame containing survival and stress values as
returned by <code><a href="#topic+predict_ecxsys">predict_ecxsys</a></code>. The concentrations are
regularly spaced on a logarithmic scale in the given concentration range.
The control is approximated by the lowest non-control concentration times
1e-7. The additional column <code>concentration_for_plots</code> is used by the
plotting functions of this package to approximate the control and
generate a nice concentration axis.</p>
</dd>
</dl>



<h3>References</h3>

<p><a href="https://doi.org/10.1038/s41598-019-51645-4">Liess, M.,
Henz, S. &amp; Knillmann, S. Predicting low-concentration effects of
pesticides. Sci Rep 9, 15248 (2019).</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>model &lt;- ecxsys(
    concentration = c(0, 0.05, 0.5, 5, 30),
    hormesis_concentration = 0.5,
    survival_tox_observed = c(90, 81, 92, 28, 0),
    survival_tox_env_observed = c(29, 27, 33, 5, 0)
)

# Use survival_max if for example the survival is given as the average number
# of surviving animals and the initial number of animals is 21:
model &lt;- ecxsys(
    concentration = c(0, 0.03, 0.3, 3, 30),
    hormesis_concentration = 0.3,
    survival_tox_observed = c(17, 15.2, 18.8, 7, 0),
    survival_tox_env_observed = c(4.8, 4.6, 6.4, 0, 0),
    survival_max = 21
)

</code></pre>

<hr>
<h2 id='lc'>Lethal Concentrations</h2><span id='topic+lc'></span>

<h3>Description</h3>

<p>Estimate the concentration to reach a certain mortality relative
to the control.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lc(model, response_name, response_level, reference, warn = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lc_+3A_model">model</code></td>
<td>
<p>This can be one of three types of objects: Either the output of
<code><a href="#topic+ecxsys">ecxsys</a></code> or the output of <code><a href="#topic+predict_ecxsys">predict_ecxsys</a></code> or a
data frame with a &quot;concentration&quot; column and a <code>response_name</code> column.
In the case of the data frame the first row is assumed to be the control.
See the examples.</p>
</td></tr>
<tr><td><code id="lc_+3A_response_name">response_name</code></td>
<td>
<p>The name of the survival or stress for which you want to
calculate the LC.</p>
</td></tr>
<tr><td><code id="lc_+3A_response_level">response_level</code></td>
<td>
<p>The desired response level as a percentage between 0
and 100. For example with the value 10 the function will return the LC10,
i.e. the concentration where the response falls below 90 % of the control
response. In other words: where a mortality of 10 % relative to the control
is reached.</p>
</td></tr>
<tr><td><code id="lc_+3A_reference">reference</code></td>
<td>
<p>The reference value of the response, usually the control at
concentration 0. This argument is optional. If it is missing, the first
value of the response is used as control. This value determines what number
<code>response_level</code> actually corresponds to. For example if
response_level is 10 and reference is 45, then the function returns the
concentration where the curve is reduced by 10% relative to 45 = 40.5.</p>
</td></tr>
<tr><td><code id="lc_+3A_warn">warn</code></td>
<td>
<p>Logical. Should the function emit a warning if the calculation of
the lethal concentration is not possible?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the response level occurs multiple times because of hormesis, which may
happen for low values of <code>response_level</code>, then the occurrence with the
smallest concentration is returned.
</p>
<p>This function only makes sense for curves which generally go down with
increasing concentration, i.e. all <code>survival_*</code> curves and also
<code>sys_tox</code> and <code>sys_tox_env</code>. Others are untested and may give
unexpected results, if any.
</p>


<h3>Value</h3>

<p>A list containing the lethal concentration and the corresponding
survival. The survival will be <code>NA</code> if its calculation is impossible
using the supplied data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Calculate the LC10, the concentration where the survival falls
# below 90% of the survival in the control.

model &lt;- ecxsys(
    concentration = c(0, 0.05, 0.5, 5, 30),
    hormesis_concentration = 0.5,
    survival_tox_observed = c(90, 81, 92, 28, 0)
)

# using the ecxsys() output or the curves therein directly:
lc(model, "survival_tox_sys", 10)
lc(model$curves, "survival_tox_sys", 10)

# using the output of predict_ecxsys() with custom concentrations:
conc &lt;- 10^seq(-9, 1, length.out = 1000)
curves &lt;- predict_ecxsys(model, conc)
lc(curves, "survival_tox_sys", 10)

# using a custom data frame:
df_custom &lt;- data.frame(
    concentration = curves$concentration,
    foo = curves$survival_tox_sys
)
lc(df_custom, "foo", 10)

# Calculate the LC50 relative to an survival of 100
# instead of relative to the control:
lc(model, "survival_tox_sys", 50, reference = 100)

</code></pre>

<hr>
<h2 id='log10_ticks'>Logarithmic axis tick marks</h2><span id='topic+log10_ticks'></span>

<h3>Description</h3>

<p>Calculate the positions and labels of major and minor tick marks for a base
10 logarithmic axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log10_ticks(x, label_zero = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="log10_ticks_+3A_x">x</code></td>
<td>
<p>A vector of axis values. Can be arbitrarily long but only the
minimum and maximum are necessary.</p>
</td></tr>
<tr><td><code id="log10_ticks_+3A_label_zero">label_zero</code></td>
<td>
<p>Whether or not to replace the smallest major label with
&quot;0&quot;. This defaults to <code>TRUE</code> and is useful for some types of plots
used to display concentration-response data where the leftmost data point
represents the control.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the positions and labels of the major and minor tick
marks. The labels are formatted without trailing zeros using
<code>formatC(labels, format = "fg")</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(0.01, 0.2, 3, 10, 50)
plot(x, c(5, 4, 2.5, 1, 0), xaxt = "n", log = "x")
ticks &lt;- log10_ticks(x)
axis(1, at = ticks$major, labels = ticks$major_labels)
axis(1, at = ticks$minor, labels = FALSE, tcl = -0.25)

</code></pre>

<hr>
<h2 id='multi_tox'>Predict the survival of binary toxicant mixtures</h2><span id='topic+multi_tox'></span>

<h3>Description</h3>

<p>The Multi-TOX model predicts the effects of binary toxicant mixtures based on
three-phasic concentration-response relationships. See the publication for
details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi_tox(
  model_a,
  model_b,
  concentration_a,
  concentration_b,
  sa_contribution = 0.5,
  survival_max = 100
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multi_tox_+3A_model_a">model_a</code>, <code id="multi_tox_+3A_model_b">model_b</code></td>
<td>
<p>The ecxsys models of the toxicants.</p>
</td></tr>
<tr><td><code id="multi_tox_+3A_concentration_a">concentration_a</code>, <code id="multi_tox_+3A_concentration_b">concentration_b</code></td>
<td>
<p>The concentrations of the toxicants in
the mixture. Both vectors must either be the same length or the longer
length must be a multiple of the shorter length. That's because the shorter
concentration vector gets recycled to the length of the longer one.</p>
</td></tr>
<tr><td><code id="multi_tox_+3A_sa_contribution">sa_contribution</code></td>
<td>
<p>The proportion of stress addition contributing to the
calculation of the toxicant stress in the mixture. Must be between 0 and 1
where 1 stands for 100 % stress addition.</p>
</td></tr>
<tr><td><code id="multi_tox_+3A_survival_max">survival_max</code></td>
<td>
<p>Controls the scaling of the result. This represents the
maximum value the survival could possibly reach. For survival data in
percent this should be 100 (the default).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The predictions are symmetric, i.e. it does not matter which of the toxicant
models is a or b as long as the concentration arguments are supplied in the
same order.
</p>
<p>This method is only suitable for experiments without or with low
environmental stress. Any environmental stress supplied as arguments to
<code><a href="#topic+ecxsys">ecxsys</a></code> in <code>model_a</code> or <code>model_b</code> is ignored.
</p>


<h3>Value</h3>

<p>A data frame with columns of the supplied concentrations and the
corresponding mixture survival and stresses.
</p>


<h3>References</h3>

<p><a href="https://doi.org/10.1186/s12302-020-00394-7">Liess, M.,
Henz, S. &amp; Shahid, N. Modeling the synergistic effects of
toxicant mixtures. Environ Sci Eur 32, 119 (2020).</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Using a data set which is included in this package. See ?multiple_stress
ms &lt;- multiple_stress
esfen &lt;- ms[ms$food == 1 &amp; ms$prochloraz == 0, ]
proch &lt;- ms[ms$food == 1 &amp; ms$esfenvalerate == 0, ]

model_esfen &lt;- ecxsys(
    concentration = esfen$esfenvalerate,
    survival_tox_observed = esfen$survival,
    hormesis_concentration = 0.1
)
model_proch &lt;- ecxsys(
    concentration = proch$prochloraz,
    survival_tox_observed = proch$survival,
    hormesis_concentration = 100
)

# Predict the survival at 8 different esfenvalerate concentrations
# but keep the prochloraz concentration constant at 32:
mt &lt;- multi_tox(
    model_esfen,
    model_proch,
    c(0, 0.0001, 0.001, 0.01, 0.1, 0.316, 1, 3.16),
    32,
    sa_contribution = 0.8
)
mt[1:3]  # The concentrations and survival of the 8 mixtures.

# Predict the survival at 4 different combinations
# of esfenvalerate and prochloraz:
mt &lt;- multi_tox(
    model_esfen,
    model_proch,
    c(0.1, 0.2, 0.3, 0.4),
    c(0, 1, 32, 100),
    sa_contribution = 0.8
)
mt[1:3]  # The concentrations and survival of the 4 mixtures.


</code></pre>

<hr>
<h2 id='multiple_stress'>Survival of Daphnia magna exposed to multiple stressors</h2><span id='topic+multiple_stress'></span>

<h3>Description</h3>

<p>A data set of mixture toxicity experiments. Individuals of Daphnia magna were
exposed to combinations of food stress and multiple concentrations of the
pesticides esfenvalerate and prochloraz. The survival was recorded at 21 days
after contamination.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiple_stress
</code></pre>


<h3>Format</h3>

<p>A data frame with 58 rows and 4 variables:
</p>

<dl>
<dt>food</dt><dd><p>The amount of food in percent.</p>
</dd>
<dt>esfenvalerate</dt><dd><p>The concentration of esfenvalerate in µg/L.</p>
</dd>
<dt>prochloraz</dt><dd><p>The concentration of prochloraz in µg/L.</p>
</dd>
<dt>survival</dt><dd><p>The mean survival in percent.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://doi.org/10.1021/acs.est.9b04293">Shahid, N., Liess, M.,
Knillmann, S., 2019. Environmental Stress Increases Synergistic Effects
of Pesticide Mixtures on Daphnia magna. Environ. Sci. Technol. 53,
12586–12593.</a>
</p>
<p><a href="https://doi.org/10.1186/s12302-020-00394-7">Liess, M., Henz, S. &amp;
Shahid, N. Modeling the synergistic effects of
toxicant mixtures. Environ Sci Eur 32, 119 (2020).</a>
</p>

<hr>
<h2 id='plot_ecxsys'>Plot the results of the ECx-SyS model</h2><span id='topic+plot_ecxsys'></span><span id='topic+plot_stress'></span><span id='topic+plot_survival'></span>

<h3>Description</h3>

<p>Plot the observed and modeled survivals and stresses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_stress(
  model,
  which = c("sys_tox", "sys_tox_observed", "sys_tox_env", "sys_tox_env_observed"),
  show_legend = FALSE,
  xlab = "concentration",
  ylab = "stress",
  main = NULL
)

plot_survival(
  model,
  which = c("survival_tox", "survival_tox_sys", "survival_tox_observed",
    "survival_tox_env", "survival_tox_env_sys", "survival_tox_env_observed"),
  show_legend = FALSE,
  xlab = "concentration",
  ylab = "survival",
  main = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_ecxsys_+3A_model">model</code></td>
<td>
<p>The model object returned from <code><a href="#topic+ecxsys">ecxsys</a></code>.</p>
</td></tr>
<tr><td><code id="plot_ecxsys_+3A_which">which</code></td>
<td>
<p>A vector of curve names to plot. Allowed are all values of
<code>names(model$curves)</code> except <code>"concentration"</code>. See the
<em>Value</em> section of <code><a href="#topic+predict_ecxsys">predict_ecxsys</a></code> for descriptions of
these names. Additionally, you can use <code>"survival_tox_observed"</code> and
<code>"survival_tox_env_observed"</code> for the observed survival and
<code>"sys_tox_observed"</code> and <code>"sys_tox_env_observed"</code> for the
observed Sys. Use <code>"all"</code> to plot everything or <code>NA</code> to only draw
the axis and labels. Invalid names will be silently ignored.</p>
</td></tr>
<tr><td><code id="plot_ecxsys_+3A_show_legend">show_legend</code></td>
<td>
<p>Should the plot include a legend? Defaults to <code>FALSE</code>
because it may cover some parts of the plot depending on the plot size and
the number of elements shown.</p>
</td></tr>
<tr><td><code id="plot_ecxsys_+3A_xlab">xlab</code>, <code id="plot_ecxsys_+3A_ylab">ylab</code>, <code id="plot_ecxsys_+3A_main">main</code></td>
<td>
<p>Axis labels and title.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Examples</h3>

<pre><code class='language-R'>model &lt;- ecxsys(
    concentration = c(0, 0.05, 0.5, 5, 30),
    hormesis_concentration = 0.5,
    survival_tox_observed = c(90, 81, 92, 28, 0),
    survival_tox_env_observed = c(29, 27, 33, 5, 0)
)
plot_survival(model, show_legend = TRUE)
plot_stress(model, show_legend = TRUE)

# Plot all curves:
plot_survival(model, which = "all")
plot_stress(model, which = "all")

# Plot only some selected curves:
plot_survival(model, which = c("survival_tox_sys", "survival_tox_env_sys"))
plot_stress(model, which = c("sys_tox", "sys_tox_env"))

# Plot only the observed values:
plot_survival(model, which = c("survival_tox_observed", "survival_tox_env_observed"))
plot_stress(model, which = c("sys_tox_observed", "sys_tox_env_observed"))
</code></pre>

<hr>
<h2 id='predict_ecxsys'>Predict survival and stress</h2><span id='topic+predict_ecxsys'></span>

<h3>Description</h3>

<p>Calculate the survivals and stresses of an ECx-SyS model at arbitrary
concentrations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_ecxsys(model, concentration)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict_ecxsys_+3A_model">model</code></td>
<td>
<p>An ECx-SyS model as returned by <code><a href="#topic+ecxsys">ecxsys</a></code>.</p>
</td></tr>
<tr><td><code id="predict_ecxsys_+3A_concentration">concentration</code></td>
<td>
<p>A numeric vector of concentrations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame (of class &quot;ecxsys_predicted&quot;) with the following
columns:
</p>

<dl>
<dt>concentration</dt><dd><p>The supplied concentrations.</p>
</dd>
<dt>survival_tox_LL5</dt><dd><p>The survival predicted by the five-parameter
log-logistic model derived from the observations under toxicant stress
but without environmental stress.</p>
</dd>
<dt>survival_tox</dt><dd><p>Modeled survival resulting from toxicant stress.</p>
</dd>
<dt>survival_tox_sys</dt><dd><p>Modeled survival resulting from toxicant
and system stress.</p>
</dd>
<dt>stress_tox</dt><dd><p>The toxicant stress.</p>
</dd>
<dt>sys_tox</dt><dd><p>System stress under toxicant stress conditions
without environmental stress.</p>
</dd>
<dt>stress_tox_sys</dt><dd><p>The sum of <code>stress_tox</code> and
<code>sys_tox</code>.</p>
</dd>
<dt>survival_tox_env_LL5</dt><dd><p>The survival predicted by the five-parameter
log-logistic model derived from the observations under toxicant stress
with environmental stress.</p>
</dd>
<dt>survival_tox_env</dt><dd><p>Modeled survival resulting from toxicant and
environmental stress.</p>
</dd>
<dt>survival_tox_env_sys</dt><dd><p>Modeled survival resulting from toxicant,
environmental and system stress.</p>
</dd>
<dt>stress_env</dt><dd><p>Environmental stress.</p>
</dd>
<dt>stress_tox_env</dt><dd><p>The sum of toxicant and environmental stress.</p>
</dd>
<dt>sys_tox_env</dt><dd><p>System stress under toxicant and
environmental stress conditions.</p>
</dd>
<dt>stress_tox_env_sys</dt><dd><p>The sum of <code>stress_tox_env</code> and
<code>sys_tox_env</code>.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>model &lt;- ecxsys(
    concentration = c(0, 0.05, 0.5, 5, 30),
    hormesis_concentration = 0.5,
    survival_tox_observed = c(90, 81, 92, 28, 0),
    survival_tox_env_observed = c(29, 27, 33, 5, 0)
)
p &lt;- predict_ecxsys(model, c(0.001, 0.01, 0.1, 1, 10))

</code></pre>

<hr>
<h2 id='Stressconversion'>Convert Between Stress and Survival</h2><span id='topic+Stressconversion'></span><span id='topic+survival_to_stress'></span><span id='topic+stress_to_survival'></span>

<h3>Description</h3>

<p>Functions to convert survival to general stress or vice versa using the beta
distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survival_to_stress(survival, p = 3.2, q = 3.2)

stress_to_survival(stress, p = 3.2, q = 3.2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Stressconversion_+3A_survival">survival</code></td>
<td>
<p>One or more survival values to convert to general stress.
Should be a value between 0 and 1. Smaller or bigger values are treated as
0 or 1 respectively.</p>
</td></tr>
<tr><td><code id="Stressconversion_+3A_p">p</code>, <code id="Stressconversion_+3A_q">q</code></td>
<td>
<p>The shape parameters of the <code><a href="stats.html#topic+Beta">beta</a></code>
distribution. Default is 3.2.</p>
</td></tr>
<tr><td><code id="Stressconversion_+3A_stress">stress</code></td>
<td>
<p>One or more stress values to convert to survival.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are simple wrappers around the beta distribution function
<code><a href="stats.html#topic+Beta">pbeta</a></code> and the beta quantile function
<code><a href="stats.html#topic+Beta">qbeta</a></code>.
</p>


<h3>Value</h3>

<p><code>stress_to_survival</code> returns a vector the same length as
<code>stress</code> giving the survival caused by each amount of stress.
</p>
<p><code>survival_to_stress</code> returns a vector the same length as
<code>survival</code> containing the stress values associated with each survival.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>stress &lt;- 0.3
survival &lt;- stress_to_survival(stress)
survival_to_stress(survival)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
