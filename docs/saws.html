<!DOCTYPE html><html lang="en"><head><title>Help for package saws</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {saws}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#saws-package'><p>Small-Sample Adjustments for Wald tests Using Sandwich Estimators</p></a></li>
<li><a href='#clogistCalc'><p> Conditional Logistic Regression fit</p></a></li>
<li><a href='#dietfat'><p>Mammary Tumors and Different Types of Dietary Fat in Rodents</p></a></li>
<li><a href='#geeUOmega'><p> Modified gee function to output extra objects for saws</p></a></li>
<li><a href='#lmfitSaws'><p> Linear model function to output extra objects for saws</p></a></li>
<li><a href='#mgee'><p> Modified gee function to output extra objects for saws</p></a></li>
<li><a href='#micefat'><p>Dietary fat and Mammary tumors in Mice</p></a></li>
<li><a href='#print.saws'><p>Print saws object</p></a></li>
<li><a href='#saws'><p>Small sample Adjustments for Wald-type tests using Sandwich estimator of variance</p></a></li>
<li><a href='#saws-internal'><p>Internal functions, not to be called directly</p></a></li>
<li><a href='#SDcorn'><p>Mammary tumors in Sprague-Dawley rats fed Corn Oil</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Small-Sample Adjustments for Wald Tests Using Sandwich
Estimators</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9-7.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-23</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael P. Fay</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael P. Fay &lt;mfay@niaid.nih.gov&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tests coefficients with sandwich estimator of variance and with small samples. Regression types supported are gee, linear regression, and conditional logistic regression.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.6.0), gee, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>MASS</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-23 17:40:50 UTC; faym</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-23 18:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='saws-package'>Small-Sample Adjustments for Wald tests Using Sandwich Estimators
</h2><span id='topic+saws-package'></span>

<h3>Description</h3>

<p>Tests coefficients with sandwich estimator of variance and with small samples. 
Regression types supported are gee, linear regression, and conditional logistic regression.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> saws</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.9-7.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2022-06-23</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2 or greater </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The main function of this package is <code><a href="#topic+saws">saws</a></code>, which takes output from some regression models
(gee, linear regression, conditional logistic regression) and gives inferences (confidence intervals, p-values) 
using small sample adjusted sandwich estimators of variance. Using methods described in Fay and Graubard (2001).
</p>
<p>The output from the regression model must be a list including the following  
three elements:
The 'coefficients' is a vector with p parameter 
estimates, and is a standard output from the regression. The matrix 'u' is K by p with u[i,] the ith 
estimating equation, where there are K approximately independent estimating equations. The array 'omega' is K by p by p  
where omega[i,,] is a p by p matrix estimating - du/dbeta (here beta=coefficients). See Fay and Graubard (2001) for details. 
</p>
<p>Since the 'u' matrix and 'omega' array are not normally part of standard output,  
there are three specialized functions for creating regression output for use in the 
<code><a href="#topic+saws">saws</a></code> function: <code><a href="#topic+mgee">mgee</a></code> (for gee), <code><a href="#topic+lmfitSaws">lmfitSaws</a></code> (for linear models) and <code><a href="#topic+clogistCalc">clogistCalc</a></code> (for conditional logistic regression). 
For example, the function <code>mgee</code> 
does a gee analysis using the <code>gee</code> function 
of the gee package, takes the output and runs it through the <code><a href="#topic+geeUOmega">geeUOmega</a></code> function to create the 'u' matrix and the 'omega' array, and adds those onto the output 
from the gee (in the process other output from the gee may be corrected, see <code><a href="#topic+geeUOmega">geeUOmega</a></code>). 
</p>
<p>The cox regression function is not included in this version of the package. Unless there is demand (and I have time) it will not be included in a future version. 
There is a demo recreating the example in Fay and Graubard (2001).  
</p>


<h3>Author(s)</h3>

<p>M.P. Fay
</p>
<p>Maintainer: Michael Fay &lt;mfay@niaid.nih.gov&gt;
</p>


<h3>References</h3>

<p> Fay and Graubard (2001). Small-Sample Adjustments for Wald-Type Tests Using Sandwich Estimators.
Biometrics 57: 1198-1206. (for copy see /inst/doc/ directory</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(gee)
data(warpbreaks)
g&lt;-gee(breaks~tension,id=wool, data=warpbreaks, corstr="exchangeable")
guo&lt;-geeUOmega(g)
saws(guo)
</code></pre>

<hr>
<h2 id='clogistCalc'> Conditional Logistic Regression fit</h2><span id='topic+clogistCalc'></span><span id='topic+clogistInfo'></span><span id='topic+clogistLoglike'></span>

<h3>Description</h3>

<p>Perform conditional logistic regression with output formatted for input into <code><a href="#topic+saws">saws</a></code> which 
will give confidence intervals and p-values. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clogistCalc(n, m, x, set, initb = NA, h = 1e-04, maxitr = 15,
     epsilon = 1e-08, conf.level = 0.95)
clogistLoglike(n, m, x, beta)
clogistInfo(n, m, x, beta, h)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clogistCalc_+3A_n">n</code></td>
<td>
<p>vector of number at risk</p>
</td></tr>
<tr><td><code id="clogistCalc_+3A_m">m</code></td>
<td>
<p>vector of number of events</p>
</td></tr>
<tr><td><code id="clogistCalc_+3A_x">x</code></td>
<td>
<p>matrix of covariates</p>
</td></tr>
<tr><td><code id="clogistCalc_+3A_set">set</code></td>
<td>
<p>vector of denoting clusters</p>
</td></tr>
<tr><td><code id="clogistCalc_+3A_initb">initb</code></td>
<td>
<p>vector of initial parameter estimates, initb=NA uses unconditional logistic regression for initial estimate</p>
</td></tr>
<tr><td><code id="clogistCalc_+3A_h">h</code></td>
<td>
<p>small value for numeric integration</p>
</td></tr>
<tr><td><code id="clogistCalc_+3A_maxitr">maxitr</code></td>
<td>
<p>maximum number of iterations</p>
</td></tr>
<tr><td><code id="clogistCalc_+3A_epsilon">epsilon</code></td>
<td>
<p>convergence criteria (see details) </p>
</td></tr>
<tr><td><code id="clogistCalc_+3A_conf.level">conf.level</code></td>
<td>
<p> confidence level for confidence intervals</p>
</td></tr>
<tr><td><code id="clogistCalc_+3A_beta">beta</code></td>
<td>
<p>vector of current parameter estimate</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The main program is <code>clogistCalc</code>. It calls  <code>clogistLoglike</code> and 
<code>clogistInfo</code> which are not to be called explicitly. The function
<code>clogistLoglike</code> finds the loglikelihood using recursive methods, 
and <code>clogistInfo</code> calculates score vector and information
matrix using numerical methods. Both methods are described in Gail, Lubin and Rubinstein (1981), and the h value is 
the same as is defined in that paper. 
</p>
<p>The algorithm stops when the largest absolute relative change in either the loglikelihood or in any parameter 
is less than epsilon. For parameters close to zero (i.e., less than 0.01 in absolute value) the relative change 
is defined as change/0.01.
</p>


<h3>Value</h3>

<p>A list for input into the <code><a href="#topic+saws">saws</a></code> function, containing  
the following elements (K=number of clusters, p=number of parameters):
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>p by 1 vector of parameter estimates</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>K by p matrix of scores or estimating equations</p>
</td></tr>
<tr><td><code>omega</code></td>
<td>
<p>K by p by p array of -1*information</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Fay, modeled after a Fortran program by Doug Midthune</p>


<h3>References</h3>

<p>     Gail, Lubin and Rubinstein (1981) Biometrika, 703-707 </p>


<h3>See Also</h3>

<p> See also <code><a href="#topic+saws">saws</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(micefat)
cout&lt;-clogistCalc(micefat$N,micefat$NTUM,micefat[,c("fatCal","totalCal")],micefat$cluster)
## usual model based variance
saws(cout,method="dm")
## sandwich based variance with small sample correction
s3&lt;-saws(cout,method="d3")
s3
print.default(s3)
</code></pre>

<hr>
<h2 id='dietfat'>Mammary Tumors and Different Types of Dietary Fat in Rodents</h2><span id='topic+dietfat'></span>

<h3>Description</h3>

<p>This is a data set from a meta analysis described in Fay, Freedman, Clifford, and Midthune (1997).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dietfat)</code></pre>


<h3>Format</h3>

<p>A data frame with 442 observations on the following 9 variables.
</p>

<dl>
<dt><code>ARTICLE</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>SET</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>N</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>RESTRICT</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>PN3</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>PN6</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>PZERO</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>PMONO</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>NTUM</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>For relationship of article numbers to references see Article.numbers.txt in the /doc/ directory. 
</p>


<h3>References</h3>

<p>Fay, MP, Freedman, LS, Clifford, CK, Midthune, DN. Cancer Research 57: 3979-3988.
</p>
<p>Fay, MP, Graubard, BI. Biometrics 57: 1198-1206.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dietfat)
## maybe str(dietfat) ; plot(dietfat) ...
</code></pre>

<hr>
<h2 id='geeUOmega'> Modified gee function to output extra objects for saws </h2><span id='topic+geeUOmega'></span>

<h3>Description</h3>

<p>This function is normally not to be called directly, but one should usually use <code><a href="#topic+mgee">mgee</a></code> (see warning below).
</p>
<p>This function takes output from the <code><a href="gee.html#topic+gee">gee</a></code>  function from the <code>gee</code> package and creates a score matrix 
(i.e., estimating equation) and information array (i.e., minus the derivative of the estimating equation).
Note the function creates the X matrix assuming the data set is the same as it was for the original call to gee, see Warning section.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geeUOmega(geeOutput)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geeUOmega_+3A_geeoutput">geeOutput</code></td>
<td>
<p>object of class gee, output from gee function</p>
</td></tr>
</table>


<h3>Value</h3>

 
<p>A gee object with two extra elements to the list, u and omega (see <code><a href="#topic+saws">saws</a></code>).
</p>


<h3>Warning</h3>

<p>It is safer to use the <code><a href="#topic+mgee">mgee</a></code> function, which internally calls <code>gee</code> then <code>geeUOmega</code>. If you do not use <code>mgee</code>,
and instead call <code>geeUOmega</code> directly, 
there could be a problem if the data set has been changed after the initial <code>gee</code> call. This is 
because the model matrix (i.e., the X matrix) is not saved as part of the gee object, we must recreate it from the gee call. So it is created assuming that the 
data argument in gee means the same thing that it did when gee was called. So if you change the data set between the original gee call and using the geeUOmega function, there may be problems. </p>


<h3>Note</h3>

<p>The function recalculates the fitted.values and the residuals to the gee object, since in gee (version 4.13-18 at least)
the fited.values and residuals can be wrong if there is an offset or if y is a matrix (as in the binomial model).</p>


<h3>Author(s)</h3>

<p> M.P. Fay, with some lines copied from <code><a href="gee.html#topic+gee">gee</a></code> function </p>


<h3>See Also</h3>

<p><code><a href="gee.html#topic+gee">gee</a></code>,<code><a href="#topic+mgee">mgee</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>##  example from gee help
data(warpbreaks)
geeout&lt;-gee(breaks~tension,id=wool,data=warpbreaks,corstr="exchangeable")
guo&lt;-geeUOmega(geeout)
saws(guo)
</code></pre>

<hr>
<h2 id='lmfitSaws'> Linear model function to output extra objects for saws </h2><span id='topic+lmfitSaws'></span>

<h3>Description</h3>

<p>This is a very basic linear model function. It outputs only the objects needed for input into <code><a href="#topic+saws">saws</a></code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmfitSaws(x,y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lmfitSaws_+3A_x">x</code></td>
<td>
<p>design matrix</p>
</td></tr>
<tr><td><code id="lmfitSaws_+3A_y">y</code></td>
<td>
<p>response vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p> The <code><a href="#topic+saws">saws</a></code> function requires three inputs, the parameter estimates (coefficients), 
u, and omega. The value u is the K by p matrix of estimating equations evaluated at the coefficient, 
where each row is an independent estimating 
equation. For the linear model u[i,] = x[i,] * residual[i]. The value omega is a K by p by p array, where 
omega[i,,] is the derivative of the ith estimating equation with respect to the parameter vector. For the linear
model omega[i,,]= t(Xi) 
</p>


<h3>Value</h3>

 
<p>A list with the following elements
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>p by 1 coefficient vector</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>K by p matrix of estimating equations</p>
</td></tr>
<tr><td><code>omega</code></td>
<td>
<p>K by p by p array, see details</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> M.P. Fay</p>


<h3>References</h3>

<p> Fay and Graubard (2001). Small-Sample Adjustments for Wald-Type Tests Using Sandwich Estimators.
Biometrics 57: 1198-1206. (for copy see /inst/doc/ directory</p>


<h3>See Also</h3>

<p><code>link{lm}</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
n&lt;-20
x1&lt;-rnorm(n)
x2&lt;-factor(c(rep("a",n/2),rep("b",n/2)))
y&lt;-rnorm(n,x1)
out&lt;-lmfitSaws(model.matrix(~x1*x2),y)
saws(out)
</code></pre>

<hr>
<h2 id='mgee'> Modified gee function to output extra objects for saws </h2><span id='topic+mgee'></span>

<h3>Description</h3>

<p>This function calls the <code><a href="gee.html#topic+gee">gee</a></code>  function from the <code>gee</code> package, then applies the <code><a href="#topic+geeUOmega">geeUOmega</a></code> function to it to create a score matrix 
(i.e., estimating equation) and information array (i.e., minus the derivative of the estimating equation).
Since the <code>mgee</code> function just calls the <code>gee</code> function all help for <code><a href="gee.html#topic+gee">gee</a></code> applies to <code>mgee</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mgee(formula = formula(data), id = id, data = parent.frame(),
    subset, na.action, R = NULL, b = NULL, tol = 0.001, 
    maxiter = 25, family = gaussian, corstr = "independence", 
    Mv = 1, silent = TRUE, contrasts = NULL, scale.fix = FALSE,
    scale.value = 1, v4.4compat = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mgee_+3A_formula">formula</code></td>
<td>
<p> see gee help</p>
</td></tr>
<tr><td><code id="mgee_+3A_id">id</code></td>
<td>
<p> see gee help</p>
</td></tr>
<tr><td><code id="mgee_+3A_data">data</code></td>
<td>
<p> see gee help</p>
</td></tr>
<tr><td><code id="mgee_+3A_subset">subset</code></td>
<td>
<p>see gee help</p>
</td></tr>
<tr><td><code id="mgee_+3A_na.action">na.action</code></td>
<td>
<p> see gee help</p>
</td></tr>
<tr><td><code id="mgee_+3A_r">R</code></td>
<td>
<p> see gee help</p>
</td></tr>
<tr><td><code id="mgee_+3A_b">b</code></td>
<td>
<p> see gee help</p>
</td></tr>
<tr><td><code id="mgee_+3A_tol">tol</code></td>
<td>
<p> see gee help</p>
</td></tr>
<tr><td><code id="mgee_+3A_maxiter">maxiter</code></td>
<td>
<p>see gee help</p>
</td></tr>
<tr><td><code id="mgee_+3A_family">family</code></td>
<td>
<p> see gee help</p>
</td></tr>
<tr><td><code id="mgee_+3A_corstr">corstr</code></td>
<td>
<p> see gee help</p>
</td></tr>
<tr><td><code id="mgee_+3A_mv">Mv</code></td>
<td>
<p> see gee help</p>
</td></tr>
<tr><td><code id="mgee_+3A_silent">silent</code></td>
<td>
<p>see gee help</p>
</td></tr>
<tr><td><code id="mgee_+3A_contrasts">contrasts</code></td>
<td>
<p>see gee help</p>
</td></tr>
<tr><td><code id="mgee_+3A_scale.fix">scale.fix</code></td>
<td>
<p> see gee help</p>
</td></tr>
<tr><td><code id="mgee_+3A_scale.value">scale.value</code></td>
<td>
<p> see gee help</p>
</td></tr>
<tr><td><code id="mgee_+3A_v4.4compat">v4.4compat</code></td>
<td>
<p> see gee help</p>
</td></tr>
</table>


<h3>Value</h3>

 
<p>A gee object with two extra elements to the list, u and omega (see <code><a href="#topic+saws">saws</a></code>).
</p>


<h3>Note</h3>

<p> You can alternatively take the output from <code>gee</code> and apply the <code><a href="#topic+geeUOmega">geeUOmega</a></code> function. But see the warning for that function. </p>


<h3>Author(s)</h3>

<p> last few lines by M.P. Fay, for the rest see <code><a href="gee.html#topic+gee">gee</a></code> package DESCRIPTION </p>


<h3>See Also</h3>

<p><code><a href="gee.html#topic+gee">gee</a></code>, <code><a href="#topic+geeUOmega">geeUOmega</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>##  example from gee help
data(warpbreaks)
mout&lt;-mgee(breaks~tension,id=wool,data=warpbreaks,corstr="exchangeable")
saws(mout)
</code></pre>

<hr>
<h2 id='micefat'>Dietary fat and Mammary tumors in Mice</h2><span id='topic+micefat'></span>

<h3>Description</h3>

<p>Data from meta analysis of mice bred for spontaneous tumors and their response to different diets. 
The sources for the data are from the literature and listed in Freedman et al (1990).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(micefat)</code></pre>


<h3>Format</h3>

<p>A data frame with 57 observations on the following 5 variables.
</p>

<dl>
<dt><code>NTUM</code></dt><dd><p>number of mice in group with any mammary tumor</p>
</dd>
<dt><code>N</code></dt><dd><p>number of mice in group</p>
</dd>
<dt><code>fatCal</code></dt><dd><p>fat calories per day (kcal)</p>
</dd>
<dt><code>totalCal</code></dt><dd><p>total calcories per day (kcal)</p>
</dd>
<dt><code>cluster</code></dt><dd><p>different experiments</p>
</dd>
</dl>



<h3>Source</h3>

<p>Freedman, LS, Clifford, C, and Messina, M (1990). Cancer Research 50: 5710-5719.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(micefat)
head(micefat)
</code></pre>

<hr>
<h2 id='print.saws'>Print saws object</h2><span id='topic+print.saws'></span>

<h3>Description</h3>

<p>Prints confidence intervals and p-values from saws object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'saws'
print(x, digits = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.saws_+3A_x">x</code></td>
<td>
<p>object of class 'saws'</p>
</td></tr>
<tr><td><code id="print.saws_+3A_digits">digits</code></td>
<td>
<p> number of digits</p>
</td></tr>
<tr><td><code id="print.saws_+3A_...">...</code></td>
<td>
<p> other objects passed to print default</p>
</td></tr>
</table>


<h3>Details</h3>

<p>THe default is to test that each parameter (i.e., each Estimate) is 0. Then the output printed is those estimates with confidence intervals and p-values. Under the default the test matrix is a p X p diagonal matrix, and beta0 is a p X 1 matrix of 0. If the default is not true then the jth Estimate column represents the jth row of  
<code>test * coef - beta0</code>, where '*' is matrix multiplication and 'coef' are the parameter estimates. Also when the default is not true, then the test matrix and beta0 vector are printed.  
</p>

<hr>
<h2 id='saws'>Small sample Adjustments for Wald-type tests using Sandwich estimator of variance</h2><span id='topic+saws'></span><span id='topic+saws.default'></span>

<h3>Description</h3>

<p>This function takes an object from a regression function and gives confidence intervals and p-values using 
the sandwich estimator of variance corrected for small samples. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>saws(x,test = diag(p), beta0 = matrix(0, p, 1), 
    conf.level = 0.95, method = c("d3", "d5", "d1", "d2", "d4", "dm"),bound=.75)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="saws_+3A_x">x</code></td>
<td>
<p>a list containing three elements: coefficients, u, omega (see details)</p>
</td></tr>
<tr><td><code id="saws_+3A_test">test</code></td>
<td>
<p>either a numeric vector giving elements of coefficient to test,
or an r by p matrix of constants for testing (see details)</p>
</td></tr>
<tr><td><code id="saws_+3A_beta0">beta0</code></td>
<td>
<p>null parameters for testing (see details)</p>
</td></tr>
<tr><td><code id="saws_+3A_conf.level">conf.level</code></td>
<td>
<p>level for confidence intervals</p>
</td></tr>
<tr><td><code id="saws_+3A_method">method</code></td>
<td>
<p>one of &quot;d3&quot;, &quot;d5&quot;, &quot;d1&quot;, &quot;d2&quot;, &quot;d4&quot;,  or &quot;dm&quot; (see details)</p>
</td></tr>
<tr><td><code id="saws_+3A_bound">bound</code></td>
<td>
<p>bound for bias correction, denoted b in Fay and Graubard, 2001</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Typically, the x object is created in a specialized function. Currently there are three such functions, 
<code>link{lmfitSaws}</code>,<code><a href="#topic+geeUOmega">geeUOmega</a></code> and <code><a href="#topic+clogistCalc">clogistCalc</a></code>. The function <code><a href="#topic+lmfitSaws">lmfitSaws</a></code> 
is a simple linear model function that creates all the output needed. The function <code><a href="#topic+geeUOmega">geeUOmega</a></code> takes output from the gee function of the gee package
and  creates the 'u' matrix and the 'omega' array. The 'coefficients' is a vector with p parameter 
estimates, and is a standard output from the regression. The matrix 'u' is K by p with u[i,] the ith 
estimating equation, where there are K approximately independent estimating equations. The array 'omega' is K by p by p  
where omega[i,,] is a p by p matrix estimating - du/dbeta (here beta=coefficients). See Fay and Graubard (2001) for details. 
</p>
<p>Suppose that the coefficient vector from the regression is beta. Then we test r hypotheses, based on the the matrix product,
TEST (beta-beta0)=0, where TEST is an  r by p matrix. If the argument 'test' is an r by p matrix (where r is arbitrary), then TEST=test.
If 'test' is a vector, then each element of test corresponds to testing that row of beta is 0, i.e., TEST&lt;-diag(p)[test,],
where p is the length of the coefficient vector. For example, test&lt;-c(2,5), tests that beta[2]-beta0[2]=0 and that beta[5]-beta0[5]=0. 
The alternatives are always two-sided.
</p>
<p>There are several methods available. They are all discussed in Fay and Graubard (2001). The naming of the 
methods follows that paper (see for example Table 1, where deltam corresponds to dm, etc.):
</p>

<dl>
<dt>dm</dt><dd><p>the usual model based method which does not use the sandwich, uses a chi squared distribution</p>
</dd>
<dt>d1</dt><dd><p>the standard sandwich method which makes no corrections for small samples</p>
</dd>
<dt>d2</dt><dd><p>sandwich method, no bias correction, uses F distribution with df=dhat (see paper)</p>
</dd>
<dt>d3</dt><dd><p>(default method:sandwich method, no bias correction, uses F distribution with df=dtilde (see paper)</p>
</dd>
<dt>d4</dt><dd><p>sandwich method, with bias correction, uses F distribution with df=dhatH (see paper)</p>
</dd>
<dt>d5</dt><dd><p>sandwich method, with bias correction, uses F distribution with df=dtildeH (see paper)</p>
</dd>
</dl>



<h3>Value</h3>

<p>An object of class 'saws'. A list with elements:
</p>
<table role = "presentation">
<tr><td><code>originalCall</code></td>
<td>
<p>call from the original object</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>method used (see details)</p>
</td></tr>
<tr><td><code>test</code></td>
<td>
<p>test matrix (see details)</p>
</td></tr>
<tr><td><code>beta0</code></td>
<td>
<p>beta0 vector (see details)</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>estimated coefficients</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>a vector of estimated degrees of freedom. This will have as many elements as there are coefficients</p>
</td></tr>
<tr><td><code>V</code></td>
<td>
<p>variance-covariance matrix</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>vector of standard errors of the coefficients</p>
</td></tr>
<tr><td><code>t.value</code></td>
<td>
<p>a vector of t-values: test (coef - beta0)/se </p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>a vector of two-sided p-values</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>p by 2 matrix of confidence intervals</p>
</td></tr> 
</table>


<h3>Note</h3>

<p>For versions prior to 0.9-7.0, when there was an offset in the formula, the results where incorrect. See the NEWS file. </p>


<h3>Author(s)</h3>

<p> M.P. Fay</p>


<h3>References</h3>

<p> Fay and Graubard (2001). Small-Sample Adjustments for Wald-Type Tests Using Sandwich Estimators.
Biometrics 57: 1198-1206. (for copy see /inst/doc/ directory)</p>


<h3>See Also</h3>

<p> For examples, see <code><a href="#topic+geeUOmega">geeUOmega</a></code> and <code><a href="#topic+clogistCalc">clogistCalc</a></code>. See also <code><a href="#topic+print.saws">print.saws</a></code></p>

<hr>
<h2 id='saws-internal'>Internal functions, not to be called directly</h2><span id='topic+PsiTildeCalc'></span><span id='topic+dfCalc'></span><span id='topic+PsiHatCalc'></span><span id='topic+sawsCalc'></span>

<h3>Description</h3>

<p>Called by <code>link{saws}</code> </p>


<h3>Usage</h3>

<pre><code class='language-R'>PsiTildeCalc(u, H, test, omega, vm, vminv, p, K)
PsiHatCalc(u, H)
dfCalc(Psi, u, omega, H, test, vm)
sawsCalc(beta, u, omega, test = diag(p), 
    beta0 = matrix(0, p, 1), conf.level = 0.95, 
    method = c("d3", "d5", "d1", "d2", "d4", "dm"),
    bound=.75)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="saws-internal_+3A_p">p</code></td>
<td>
<p>length of coefficient vector</p>
</td></tr>
<tr><td><code id="saws-internal_+3A_k">K</code></td>
<td>
<p>number of terms in estimating equation</p>
</td></tr>
<tr><td><code id="saws-internal_+3A_beta">beta</code></td>
<td>
<p>coefficient vector of length p</p>
</td></tr>
<tr><td><code id="saws-internal_+3A_u">u</code></td>
<td>
<p>K by p score matrix, u[i,] is the ith term in the estimating equation</p>
</td></tr>
<tr><td><code id="saws-internal_+3A_h">H</code></td>
<td>
<p>K by p adjustment matrix, diag(H[i,])=Hi in Fay and Graubard, 2001</p>
</td></tr>
<tr><td><code id="saws-internal_+3A_test">test</code></td>
<td>
<p>r by p test matrix</p>
</td></tr>
<tr><td><code id="saws-internal_+3A_omega">omega</code></td>
<td>
<p>K by p by p array, omega[i,,] estimates -du/dbeta.</p>
</td></tr>
<tr><td><code id="saws-internal_+3A_vm">vm</code></td>
<td>
<p> p by p matrix,model based variance </p>
</td></tr>
<tr><td><code id="saws-internal_+3A_vminv">vminv</code></td>
<td>
<p>inverse of vm</p>
</td></tr>
<tr><td><code id="saws-internal_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level for confidence intervals</p>
</td></tr>
<tr><td><code id="saws-internal_+3A_method">method</code></td>
<td>
<p>see <code><a href="#topic+saws">saws</a></code> </p>
</td></tr>
<tr><td><code id="saws-internal_+3A_bound">bound</code></td>
<td>
<p>bound for bias correction, denoted b in Fay and Graubard, 2001</p>
</td></tr>
</table>

<hr>
<h2 id='SDcorn'>Mammary tumors in Sprague-Dawley rats fed Corn Oil</h2><span id='topic+SDcorn'></span>

<h3>Description</h3>

<p>These data are part of a meta analysis to determine how fat calories and total calories 
effect the changes of getting a mammary tumor.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SDcorn)</code></pre>


<h3>Format</h3>

<p>A data frame with 104 observations on the following 10 variables.
</p>

<dl>
<dt><code>ARTICLE</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>NTUM</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>N</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>TFA2</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>KCA2</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>PFC</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>LOGIT</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>KCAL</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>SET</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>TEMPSET</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>Note the adjustment in Fay, Graubard, Freedman, and Midthune (1998) is slightly different from the one 
in Fay and Graubard (2001) so the <code><a href="#topic+saws">saws</a></code> does not match exactly with the 1998 paper.
</p>
<p>For relationship of article numbers to references see Article.numbers.txt in the /doc/ directory. 
</p>


<h3>References</h3>

<p>Fay, MP, Freedman, LS, Clifford, CK, Midthune, DN. Cancer Research 57: 3979-3988.
</p>
<p>Fay, MP, Graubard, BI, Freedman, LS, Midthune, DN. Biometrics 54: 195-208.
</p>
<p>Fay, MP, Graubard, BI. Biometrics 57: 1198-1206.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SDcorn)
## maybe str(SDcorn) ; plot(SDcorn) ...
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
