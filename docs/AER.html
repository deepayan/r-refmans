<!DOCTYPE html><html lang="en"><head><title>Help for package AER</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AER}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Affairs'><p>Fair's Extramarital Affairs Data</p></a></li>
<li><a href='#ArgentinaCPI'><p>Consumer Price Index in Argentina</p></a></li>
<li><a href='#Baltagi2002'><p>Data and Examples from Baltagi (2002)</p></a></li>
<li><a href='#BankWages'><p>Bank Wages</p></a></li>
<li><a href='#BenderlyZwick'><p>Benderly and Zwick Data: Inflation, Growth and Stock Returns</p></a></li>
<li><a href='#BondYield'><p>Bond Yield Data</p></a></li>
<li><a href='#CameronTrivedi1998'><p>Data and Examples from Cameron and Trivedi (1998)</p></a></li>
<li><a href='#CartelStability'><p>CartelStability</p></a></li>
<li><a href='#CASchools'><p>California Test Score Data</p></a></li>
<li><a href='#ChinaIncome'><p>Chinese Real National Income Data</p></a></li>
<li><a href='#CigarettesB'><p>Cigarette Consumption Data</p></a></li>
<li><a href='#CigarettesSW'><p>Cigarette Consumption Panel Data</p></a></li>
<li><a href='#CollegeDistance'><p>College Distance Data</p></a></li>
<li><a href='#ConsumerGood'><p>Properties of a Fast-Moving Consumer Good</p></a></li>
<li><a href='#CPS1985'><p>Determinants of Wages Data (CPS 1985)</p></a></li>
<li><a href='#CPS1988'><p>Determinants of Wages Data (CPS 1988)</p></a></li>
<li><a href='#CPSSW'><p>Stock and Watson CPS Data Sets</p></a></li>
<li><a href='#CreditCard'><p>Expenditure and Default Data</p></a></li>
<li><a href='#dispersiontest'><p>Dispersion Test</p></a></li>
<li><a href='#DJFranses'><p>Dow Jones Index Data (Franses)</p></a></li>
<li><a href='#DJIA8012'><p>Dow Jones Industrial Average (DJIA) index</p></a></li>
<li><a href='#DoctorVisits'><p>Australian Health Service Utilization Data</p></a></li>
<li><a href='#DutchAdvert'><p>TV and Radio Advertising Expenditures Data</p></a></li>
<li><a href='#DutchSales'><p>Dutch Retail Sales Index Data</p></a></li>
<li><a href='#Electricity1955'><p>Cost Function of Electricity Producers (1955, Nerlove Data)</p></a></li>
<li><a href='#Electricity1970'><p>Cost Function of Electricity Producers 1970</p></a></li>
<li><a href='#EquationCitations'><p>Number of Equations and Citations for Evolutionary Biology Publications</p></a></li>
<li><a href='#Equipment'><p>Transportation Equipment Manufacturing Data</p></a></li>
<li><a href='#EuroEnergy'><p>European Energy Consumption Data</p></a></li>
<li><a href='#Fatalities'><p>US Traffic Fatalities</p></a></li>
<li><a href='#Fertility'><p>Fertility and Women's Labor Supply</p></a></li>
<li><a href='#Franses1998'><p>Data and Examples from Franses (1998)</p></a></li>
<li><a href='#FrozenJuice'><p>Price of Frozen Orange Juice</p></a></li>
<li><a href='#GermanUnemployment'><p>Unemployment in Germany Data</p></a></li>
<li><a href='#GoldSilver'><p>Gold and Silver Prices</p></a></li>
<li><a href='#Greene2003'><p>Data and Examples from Greene (2003)</p></a></li>
<li><a href='#GrowthDJ'><p>Determinants of Economic Growth</p></a></li>
<li><a href='#GrowthSW'><p>Determinants of Economic Growth</p></a></li>
<li><a href='#Grunfeld'><p>Grunfeld's Investment Data</p></a></li>
<li><a href='#GSOEP9402'><p>German Socio-Economic Panel 1994&ndash;2002</p></a></li>
<li><a href='#GSS7402'><p>US General Social Survey 1974&ndash;2002</p></a></li>
<li><a href='#Guns'><p>More Guns, Less Crime?</p></a></li>
<li><a href='#HealthInsurance'><p>Medical Expenditure Panel Survey Data</p></a></li>
<li><a href='#HMDA'><p>Home Mortgage Disclosure Act Data</p></a></li>
<li><a href='#HousePrices'><p>House Prices in the City of Windsor, Canada</p></a></li>
<li><a href='#ivreg'><p>Instrumental-Variable Regression</p></a></li>
<li><a href='#ivreg.fit'><p>Fitting Instrumental-Variable Regressions</p></a></li>
<li><a href='#Journals'><p>Economics Journal Subscription Data</p></a></li>
<li><a href='#KleinI'><p>Klein Model I</p></a></li>
<li><a href='#Longley'><p>Longley's Regression Data</p></a></li>
<li><a href='#ManufactCosts'><p>Manufacturing Costs Data</p></a></li>
<li><a href='#MarkDollar'><p>DEM/USD Exchange Rate Returns</p></a></li>
<li><a href='#MarkPound'><p>DEM/GBP Exchange Rate Returns</p></a></li>
<li><a href='#MASchools'><p>Massachusetts Test Score Data</p></a></li>
<li><a href='#Medicaid1986'><p>Medicaid Utilization Data</p></a></li>
<li><a href='#Mortgage'><p>Fixed versus Adjustable Mortgages</p></a></li>
<li><a href='#MotorCycles'><p>Motor Cycles in The Netherlands</p></a></li>
<li><a href='#MotorCycles2'><p>Motor Cycles in The Netherlands</p></a></li>
<li><a href='#MSCISwitzerland'><p>MSCI Switzerland Index</p></a></li>
<li><a href='#Municipalities'><p>Municipal Expenditure Data</p></a></li>
<li><a href='#MurderRates'><p>Determinants of Murder Rates in the United States</p></a></li>
<li><a href='#NaturalGas'><p>Natural Gas Data</p></a></li>
<li><a href='#NMES1988'><p>Demand for Medical Care in NMES 1988</p></a></li>
<li><a href='#NYSESW'><p>Daily NYSE Composite Index</p></a></li>
<li><a href='#OECDGas'><p>Gasoline Consumption Data</p></a></li>
<li><a href='#OECDGrowth'><p>OECD Macroeconomic Data</p></a></li>
<li><a href='#OlympicTV'><p>Television Rights for Olympic Games</p></a></li>
<li><a href='#OrangeCounty'><p>Orange County Employment</p></a></li>
<li><a href='#Parade2005'><p>Parade Magazine 2005 Earnings Data</p></a></li>
<li><a href='#PepperPrice'><p>Black and White Pepper Prices</p></a></li>
<li><a href='#PhDPublications'><p>Doctoral Publications</p></a></li>
<li><a href='#ProgramEffectiveness'><p>Program Effectiveness Data</p></a></li>
<li><a href='#PSID1976'><p>Labor Force Participation Data</p></a></li>
<li><a href='#PSID1982'><p>PSID Earnings Data 1982</p></a></li>
<li><a href='#PSID7682'><p>PSID Earnings Panel Data (1976&ndash;1982)</p></a></li>
<li><a href='#RecreationDemand'><p>Recreation Demand Data</p></a></li>
<li><a href='#ResumeNames'><p>Are Emily and Greg More Employable Than Lakisha and Jamal?</p></a></li>
<li><a href='#ShipAccidents'><p>Ship Accidents</p></a></li>
<li><a href='#SIC33'><p>SIC33 Production Data</p></a></li>
<li><a href='#SmokeBan'><p>Do Workplace Smoking Bans Reduce Smoking?</p></a></li>
<li><a href='#SportsCards'><p>Endowment Effect for Sports Cards</p></a></li>
<li><a href='#STAR'><p>Project STAR: Student-Teacher Achievement Ratio</p></a></li>
<li><a href='#StockWatson2007'><p>Data and Examples from Stock and Watson (2007)</p></a></li>
<li><a href='#StrikeDuration'><p>Strike Durations</p></a></li>
<li><a href='#summary.ivreg'><p>Methods for Instrumental-Variable Regression</p></a></li>
<li><a href='#SwissLabor'><p>Swiss Labor Market Participation Data</p></a></li>
<li><a href='#TeachingRatings'><p>Impact of Beauty on Instructor's Teaching Ratings</p></a></li>
<li><a href='#TechChange'><p>Technological Change Data</p></a></li>
<li><a href='#tobit'><p>Tobit Regression</p></a></li>
<li><a href='#TradeCredit'><p>Trade Credit and the Money Market</p></a></li>
<li><a href='#TravelMode'><p>Travel Mode Choice Data</p></a></li>
<li><a href='#UKInflation'><p>UK Manufacturing Inflation Data</p></a></li>
<li><a href='#UKNonDurables'><p>Consumption of Non-Durables in the UK</p></a></li>
<li><a href='#USAirlines'><p>Cost Data for US Airlines</p></a></li>
<li><a href='#USConsump1950'><p>US Consumption Data (1940&ndash;1950)</p></a></li>
<li><a href='#USConsump1979'><p>US Consumption Data (1970&ndash;1979)</p></a></li>
<li><a href='#USConsump1993'><p>US Consumption Data (1950&ndash;1993)</p></a></li>
<li><a href='#USCrudes'><p>US Crudes Data</p></a></li>
<li><a href='#USGasB'><p>US Gasoline Market Data (1950&ndash;1987, Baltagi)</p></a></li>
<li><a href='#USGasG'><p>US Gasoline Market Data (1960&ndash;1995, Greene)</p></a></li>
<li><a href='#USInvest'><p>US Investment Data</p></a></li>
<li><a href='#USMacroB'><p>US Macroeconomic Data (1959&ndash;1995, Baltagi)</p></a></li>
<li><a href='#USMacroG'><p>US Macroeconomic Data (1950&ndash;2000, Greene)</p></a></li>
<li><a href='#USMacroSW'><p>US Macroeconomic Data (1957&ndash;2005, Stock &amp; Watson)</p></a></li>
<li><a href='#USMacroSWM'><p>Monthly US Macroeconomic Data (1947&ndash;2004, Stock &amp; Watson)</p></a></li>
<li><a href='#USMacroSWQ'><p>Quarterly US Macroeconomic Data (1947&ndash;2004, Stock &amp; Watson)</p></a></li>
<li><a href='#USMoney'><p>USMoney</p></a></li>
<li><a href='#USProdIndex'><p>Index of US Industrial Production</p></a></li>
<li><a href='#USSeatBelts'><p>Effects of Mandatory Seat Belt Laws in the US</p></a></li>
<li><a href='#USStocksSW'><p>Monthly US Stock Returns (1931&ndash;2002, Stock &amp; Watson)</p></a></li>
<li><a href='#WeakInstrument'><p>Artificial Weak Instrument Data</p></a></li>
<li><a href='#WinkelmannBoes2009'><p>Data and Examples from Winkelmann and Boes (2009)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.2-14</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-09-28</td>
</tr>
<tr>
<td>Title:</td>
<td>Applied Econometrics with R</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions, data sets, examples, demos, and vignettes for the book
             Christian Kleiber and Achim Zeileis (2008),
	     Applied Econometrics with R, Springer-Verlag, New York.
	     ISBN 978-0-387-77316-2. &lt;<a href="https://doi.org/10.1007%2F978-0-387-77318-6">doi:10.1007/978-0-387-77318-6</a>&gt;
             (See the vignette "AER" for a package overview.)</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), car (&ge; 2.0-19), lmtest, sandwich (&ge; 2.4-0),
survival (&ge; 2.37-5), zoo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>boot, dynlm, effects, fGarch, forecast, foreign, ineq,
KernSmooth, lattice, longmemo, MASS, mlogit, nlme, nnet, np,
plm, pscl, quantreg, rgl, ROCR, rugarch, sampleSelection,
scatterplot3d, strucchange, systemfit (&ge; 1.1-20), truncreg,
tseries, urca, vars</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, Formula (&ge; 0.2-0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-28 02:34:53 UTC; zeileis</td>
</tr>
<tr>
<td>Author:</td>
<td>Christian Kleiber <a href="https://orcid.org/0000-0002-6781-4733"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Achim Zeileis <a href="https://orcid.org/0000-0003-0918-3766"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Achim Zeileis &lt;Achim.Zeileis@R-project.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-28 06:50:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='Affairs'>Fair's Extramarital Affairs Data</h2><span id='topic+Affairs'></span>

<h3>Description</h3>

<p>Infidelity data, known as Fair's Affairs. Cross-section data from a survey
conducted by Psychology Today in 1969.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Affairs")</code></pre>


<h3>Format</h3>

<p>A data frame containing 601 observations on 9 variables.
</p>

<dl>
<dt>affairs</dt><dd><p>numeric. How often engaged in extramarital sexual intercourse
during the past year? <code>0</code> = none, <code>1</code> = once, <code>2</code> = twice,
<code>3</code> = 3 times, <code>7</code> = 4&ndash;10 times, <code>12</code> = monthly,
<code>12</code> = weekly, <code>12</code> = daily.</p>
</dd>
<dt>gender</dt><dd><p>factor indicating gender.</p>
</dd>
<dt>age</dt><dd><p>numeric variable coding age in years: <code>17.5</code> = under 20, <code>22</code> = 20&ndash;24,
<code>27</code> = 25&ndash;29, <code>32</code> = 30&ndash;34, <code>37</code> = 35&ndash;39, <code>42</code> = 40&ndash;44,
<code>47</code> = 45&ndash;49, <code>52</code> = 50&ndash;54, <code>57</code> = 55 or over.</p>
</dd>
<dt>yearsmarried</dt><dd><p>numeric variable coding number of years married: <code>0.125</code> = 3 months or less,
<code>0.417</code> = 4&ndash;6 months, <code>0.75</code> = 6 months&ndash;1 year, <code>1.5</code> = 1&ndash;2 years,
<code>4</code> = 3&ndash;5 years, <code>7</code> = 6&ndash;8 years, <code>10</code> = 9&ndash;11 years, <code>15</code> = 12 or more years.</p>
</dd>
<dt>children</dt><dd><p>factor. Are there children in the marriage?</p>
</dd>
<dt>religiousness</dt><dd><p>numeric variable coding religiousness: <code>1</code> = anti, <code>2</code> = not at all,
<code>3</code> = slightly, <code>4</code> = somewhat, <code>5</code> = very.</p>
</dd>
<dt>education</dt><dd><p>numeric variable coding level of education: <code>9</code> = grade school,
<code>12</code> = high school graduate, <code>14</code> = some college, <code>16</code> = college graduate,
<code>17</code> = some graduate work, <code>18</code> = master's degree, <code>20</code> = Ph.D., M.D., or
other advanced degree.</p>
</dd>
<dt>occupation</dt><dd><p>numeric variable coding occupation according to Hollingshead classification
(reverse numbering).</p>
</dd>
<dt>rating</dt><dd><p>numeric variable coding self rating of marriage: <code>1</code> = very unhappy,
<code>2</code> = somewhat unhappy, <code>3</code> = average, <code>4</code> = happier than average, 
<code>5</code> = very happy.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Greene (2003). Table F22.2.
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>
<p>Fair, R.C. (1978). A Theory of Extramarital Affairs. <em>Journal of Political Economy</em>,
<b>86</b>, 45&ndash;61.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("Affairs")

## Greene (2003)
## Tab. 22.3 and 22.4
fm_ols &lt;- lm(affairs ~ age + yearsmarried + religiousness + occupation + rating,
  data = Affairs)
fm_probit &lt;- glm(I(affairs &gt; 0) ~ age + yearsmarried + religiousness + occupation + rating,
  data = Affairs, family = binomial(link = "probit"))

fm_tobit &lt;- tobit(affairs ~ age + yearsmarried + religiousness + occupation + rating,
  data = Affairs)
fm_tobit2 &lt;- tobit(affairs ~ age + yearsmarried + religiousness + occupation + rating,
  right = 4, data = Affairs)

fm_pois &lt;- glm(affairs ~ age + yearsmarried + religiousness + occupation + rating,
  data = Affairs, family = poisson)

library("MASS")
fm_nb &lt;- glm.nb(affairs ~ age + yearsmarried + religiousness + occupation + rating,
  data = Affairs)

## Tab. 22.6
library("pscl")
fm_zip &lt;- zeroinfl(affairs ~ age + yearsmarried + religiousness + occupation + rating | age + 
  yearsmarried + religiousness + occupation + rating, data = Affairs)
</code></pre>

<hr>
<h2 id='ArgentinaCPI'>Consumer Price Index in Argentina</h2><span id='topic+ArgentinaCPI'></span>

<h3>Description</h3>

<p>Time series of consumer price index (CPI) in Argentina (index with 1969(4) = 1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ArgentinaCPI")</code></pre>


<h3>Format</h3>

<p>A quarterly univariate time series from 1970(1) to 1989(4).
</p>


<h3>Source</h3>

<p>Online complements to Franses (1998).
</p>


<h3>References</h3>

<p>De Ruyter van Steveninck, M.A. (1996). <em>The Impact of Capital Imports; Argentina 1970&ndash;1989</em>.
Amsterdam: Thesis Publishers.
</p>
<p>Franses, P.H. (1998). <em>Time Series Models for Business and Economic Forecasting</em>.
Cambridge, UK: Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Franses1998">Franses1998</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("ArgentinaCPI")
plot(ArgentinaCPI)
plot(log(ArgentinaCPI))

library("dynlm")
## estimation sample 1970.3-1988.4 means
acpi &lt;- window(ArgentinaCPI, start = c(1970,1), end = c(1988,4)) 

## eq. (3.90), p.54
acpi_ols &lt;- dynlm(d(log(acpi)) ~ L(d(log(acpi))))
summary(acpi_ols)

## alternatively
ar(diff(log(acpi)), order.max = 1, method = "ols") 
</code></pre>

<hr>
<h2 id='Baltagi2002'>Data and Examples from Baltagi (2002)</h2><span id='topic+Baltagi2002'></span>

<h3>Description</h3>

<p>This manual page collects a list of examples from the book. Some 
solutions might not be exact and the list is certainly not complete.
If you have suggestions for improvement (preferably in the form of code),
please contact the package maintainer.
</p>


<h3>References</h3>

<p>Baltagi, B.H. (2002). <em>Econometrics</em>, 3rd ed., Berlin: Springer-Verlag. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BenderlyZwick">BenderlyZwick</a></code>, <code><a href="#topic+CigarettesB">CigarettesB</a></code>, <code><a href="#topic+EuroEnergy">EuroEnergy</a></code>,
<code><a href="#topic+Grunfeld">Grunfeld</a></code>, <code><a href="#topic+Mortgage">Mortgage</a></code>, <code><a href="#topic+NaturalGas">NaturalGas</a></code>,
<code><a href="#topic+OECDGas">OECDGas</a></code>, <code><a href="#topic+OrangeCounty">OrangeCounty</a></code>, <code><a href="#topic+PSID1982">PSID1982</a></code>,
<code><a href="#topic+TradeCredit">TradeCredit</a></code>, <code><a href="#topic+USConsump1993">USConsump1993</a></code>, <code><a href="#topic+USCrudes">USCrudes</a></code>,
<code><a href="#topic+USGasB">USGasB</a></code>, <code><a href="#topic+USMacroB">USMacroB</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
################################
## Cigarette consumption data ##
################################

## data
data("CigarettesB", package = "AER")

## Table 3.3
cig_lm &lt;- lm(packs ~ price, data = CigarettesB)
summary(cig_lm)

## Figure 3.9
plot(residuals(cig_lm) ~ price, data = CigarettesB)
abline(h = 0, lty = 2)

## Figure 3.10
cig_pred &lt;- with(CigarettesB,
  data.frame(price = seq(from = min(price), to = max(price), length = 30)))
cig_pred &lt;- cbind(cig_pred, predict(cig_lm, newdata = cig_pred, interval = "confidence"))
plot(packs ~ price, data = CigarettesB)
lines(fit ~ price, data = cig_pred)
lines(lwr ~ price, data = cig_pred, lty = 2)
lines(upr ~ price, data = cig_pred, lty = 2)

## Chapter 5: diagnostic tests (p. 111-115)
cig_lm2 &lt;- lm(packs ~ price + income, data = CigarettesB)
summary(cig_lm2)
## Glejser tests (p. 112)
ares &lt;- abs(residuals(cig_lm2))
summary(lm(ares ~ income, data = CigarettesB))
summary(lm(ares ~ I(1/income), data = CigarettesB))
summary(lm(ares ~ I(1/sqrt(income)), data = CigarettesB))
summary(lm(ares ~ sqrt(income), data = CigarettesB))
## Goldfeld-Quandt test (p. 112)
gqtest(cig_lm2, order.by = ~ income, data = CigarettesB, fraction = 12, alternative = "less")
## NOTE: Baltagi computes the test statistic as mss1/mss2,
## i.e., tries to find decreasing variances. gqtest() always uses
## mss2/mss1 and has an "alternative" argument.

## Spearman rank correlation test (p. 113)
cor.test(~ ares + income, data = CigarettesB, method = "spearman")
## Breusch-Pagan test (p. 113)
bptest(cig_lm2, varformula = ~ income, data = CigarettesB, student = FALSE)
## White test (Table 5.1, p. 113)
bptest(cig_lm2, ~ income * price + I(income^2) + I(price^2), data = CigarettesB)
## White HC standard errors (Table 5.2, p. 114)
coeftest(cig_lm2, vcov = vcovHC(cig_lm2, type = "HC1"))
## Jarque-Bera test (Figure 5.2, p. 115)
hist(residuals(cig_lm2), breaks = 16, ylim = c(0, 10), col = "lightgray")
library("tseries")
jarque.bera.test(residuals(cig_lm2))

## Tables 8.1 and 8.2
influence.measures(cig_lm2)


#####################################
## US consumption data (1950-1993) ##
#####################################

## data
data("USConsump1993", package = "AER")
plot(USConsump1993, plot.type = "single", col = 1:2)

## Chapter 5 (p. 122-125)
fm &lt;- lm(expenditure ~ income, data = USConsump1993)
summary(fm)
## Durbin-Watson test (p. 122)
dwtest(fm)
## Breusch-Godfrey test (Table 5.4, p. 124)
bgtest(fm)
## Newey-West standard errors (Table 5.5, p. 125)
coeftest(fm, vcov = NeweyWest(fm, lag = 3, prewhite = FALSE, adjust = TRUE)) 

## Chapter 8
library("strucchange")
## Recursive residuals
rr &lt;- recresid(fm)
rr
## Recursive CUSUM test
rcus &lt;- efp(expenditure ~ income, data = USConsump1993)
plot(rcus)
sctest(rcus)
## Harvey-Collier test
harvtest(fm)
## NOTE" Mistake in Baltagi (2002) who computes
## the t-statistic incorrectly as 0.0733 via
mean(rr)/sd(rr)/sqrt(length(rr))
## whereas it should be (as in harvtest)
mean(rr)/sd(rr) * sqrt(length(rr))

## Rainbow test
raintest(fm, center = 23)

## J test for non-nested models
library("dynlm")
fm1 &lt;- dynlm(expenditure ~ income + L(income), data = USConsump1993)
fm2 &lt;- dynlm(expenditure ~ income + L(expenditure), data = USConsump1993)
jtest(fm1, fm2)

## Chapter 11
## Table 11.1 Instrumental-variables regression
usc &lt;- as.data.frame(USConsump1993)
usc$investment &lt;- usc$income - usc$expenditure
fm_ols &lt;- lm(expenditure ~ income, data = usc)
fm_iv &lt;- ivreg(expenditure ~ income | investment, data = usc)
## Hausman test
cf_diff &lt;- coef(fm_iv) - coef(fm_ols)
vc_diff &lt;- vcov(fm_iv) - vcov(fm_ols)
x2_diff &lt;- as.vector(t(cf_diff) %*% solve(vc_diff) %*% cf_diff)
pchisq(x2_diff, df = 2, lower.tail = FALSE)

## Chapter 14
## ACF and PACF for expenditures and first differences
exps &lt;- USConsump1993[, "expenditure"]
(acf(exps))
(pacf(exps))
(acf(diff(exps)))
(pacf(diff(exps)))

## dynamic regressions, eq. (14.8)
fm &lt;- dynlm(d(exps) ~ I(time(exps) - 1949) + L(exps))
summary(fm)


################################
## Grunfeld's investment data ##
################################

## select the first three companies (as panel data)
data("Grunfeld", package = "AER")
pgr &lt;- subset(Grunfeld, firm %in% levels(Grunfeld$firm)[1:3])
library("plm")
pgr &lt;- pdata.frame(pgr, c("firm", "year"))

## Ex. 10.9
library("systemfit")
gr_ols &lt;- systemfit(invest ~ value + capital, method = "OLS", data = pgr)
gr_sur &lt;- systemfit(invest ~ value + capital, method = "SUR", data = pgr)


#########################################
## Panel study on income dynamics 1982 ##
#########################################

## data
data("PSID1982", package = "AER")

## Table 4.1
earn_lm &lt;- lm(log(wage) ~ . + I(experience^2), data = PSID1982)
summary(earn_lm)

## Table 13.1
union_lpm &lt;- lm(I(as.numeric(union) - 1) ~ . - wage, data = PSID1982)
union_probit &lt;- glm(union ~ . - wage, data = PSID1982, family = binomial(link = "probit"))
union_logit &lt;- glm(union ~ . - wage, data = PSID1982, family = binomial)
## probit OK, logit and LPM rather different.
</code></pre>

<hr>
<h2 id='BankWages'>Bank Wages</h2><span id='topic+BankWages'></span>

<h3>Description</h3>

<p>Wages of employees of a US bank.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("BankWages")</code></pre>


<h3>Format</h3>

<p>A data frame containing 474 observations on 4 variables.
</p>

<dl>
<dt>job</dt><dd><p>Ordered factor indicating job category, with levels <code>"custodial"</code>,
<code>"admin"</code>  and <code>"manage"</code>.</p>
</dd>
<dt>education</dt><dd><p>Education in years.</p>
</dd>
<dt>gender</dt><dd><p>Factor indicating gender.</p>
</dd>
<dt>minority</dt><dd><p>Factor. Is the employee member of a minority?</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Heij, de Boer, Franses, Kloek, and van Dijk (2004). 
</p>
<p><a href="https://global.oup.com/booksites/content/0199268010/datasets/ch6/xr614bwa.asc">https://global.oup.com/booksites/content/0199268010/datasets/ch6/xr614bwa.asc</a>
</p>


<h3>References</h3>

<p>Heij, C., de Boer, P.M.C., Franses, P.H., Kloek, T. and van Dijk, H.K. (2004). 
<em>Econometric Methods with Applications in Business and Economics</em>. 
Oxford: Oxford University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("BankWages")

## exploratory analysis of job ~ education
## (tables and spine plots, some education levels merged)
xtabs(~ education + job, data = BankWages)
edcat &lt;- factor(BankWages$education)
levels(edcat)[3:10] &lt;- rep(c("14-15", "16-18", "19-21"), c(2, 3, 3))
tab &lt;- xtabs(~ edcat + job, data = BankWages)
prop.table(tab, 1)
spineplot(tab, off = 0)
plot(job ~ edcat, data = BankWages, off = 0)

## fit multinomial model for male employees
library("nnet")
fm_mnl &lt;- multinom(job ~ education + minority, data = BankWages,
  subset = gender == "male", trace = FALSE)
summary(fm_mnl)
confint(fm_mnl)

## same with mlogit package
library("mlogit")
fm_mlogit &lt;- mlogit(job ~ 1 | education + minority, data = BankWages,
  subset = gender == "male", shape = "wide", reflevel = "custodial")
summary(fm_mlogit)
</code></pre>

<hr>
<h2 id='BenderlyZwick'>Benderly and Zwick Data: Inflation, Growth and Stock Returns</h2><span id='topic+BenderlyZwick'></span>

<h3>Description</h3>

<p>Time series data, 1952&ndash;1982.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("BenderlyZwick")</code></pre>


<h3>Format</h3>

<p>An annual multiple time series from 1952 to 1982 with 5 variables.
</p>

<dl>
<dt>returns</dt><dd><p>real annual returns on stocks, measured using
the Ibbotson-Sinquefeld data base.</p>
</dd>
<dt>growth</dt><dd><p>annual growth rate of output, measured by real GNP
(from the given year to the next year).</p>
</dd>
<dt>inflation</dt><dd><p>inflation rate, measured as growth of price
rate (from December of the previous year to December of the present year).</p>
</dd>
<dt>growth2</dt><dd><p>annual growth rate of real GNP as given by Baltagi.</p>
</dd>
<dt>inflation2</dt><dd><p>inflation rate as given by Baltagi</p>
</dd>
</dl>



<h3>Source</h3>

<p>The first three columns of the data are from Table 1 in Benderly and Zwick (1985).
The remaining columns are taken from the online complements of Baltagi (2002).
The first column is identical in both sources, the other two variables differ
in their numeric values and additionally the growth series seems to be lagged
differently. Baltagi (2002) states Lott and Ray (1992) as the source for his
version of the data set.
</p>


<h3>References</h3>

<p>Baltagi, B.H. (2002). <em>Econometrics</em>, 3rd ed. Berlin, Springer. 
</p>
<p>Benderly, J., and Zwick, B. (1985). Inflation, Real Balances, Output and Real Stock
Returns. <em>American Economic Review</em>, <b>75</b>, 1115&ndash;1123.
</p>
<p>Lott, W.F., and Ray, S.C. (1992). <em>Applied Econometrics: Problems with Data Sets</em>.
New York: The Dryden Press.
</p>
<p>Zaman, A., Rousseeuw, P.J., and  Orhan, M. (2001). Econometric Applications of
High-Breakdown Robust Regression Techniques. <em>Economics Letters</em>, <b>71</b>, 1&ndash;8.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Baltagi2002">Baltagi2002</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("BenderlyZwick")
plot(BenderlyZwick)

## Benderly and Zwick (1985), p. 1116
library("dynlm")
bz_ols &lt;- dynlm(returns ~ growth + inflation,
  data = BenderlyZwick/100, start = 1956, end = 1981)
summary(bz_ols)

## Zaman, Rousseeuw and Orhan (2001)
## use larger period, without scaling
bz_ols2 &lt;- dynlm(returns ~ growth + inflation,
  data = BenderlyZwick, start = 1954, end = 1981)
summary(bz_ols2)
</code></pre>

<hr>
<h2 id='BondYield'>Bond Yield Data</h2><span id='topic+BondYield'></span>

<h3>Description</h3>

<p>Monthly averages of the yield on a Moody's Aaa rated corporate bond (in percent/year).  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("BondYield")</code></pre>


<h3>Format</h3>

<p>A monthly univariate time series from 1990(1) to 1994(12).
</p>


<h3>Source</h3>

<p>Online complements to Greene (2003), Table F20.1.
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("BondYield")
plot(BondYield)
</code></pre>

<hr>
<h2 id='CameronTrivedi1998'>Data and Examples from Cameron and Trivedi (1998)</h2><span id='topic+CameronTrivedi1998'></span>

<h3>Description</h3>

<p>This manual page collects a list of examples from the book. Some 
solutions might not be exact and the list is certainly not complete.
If you have suggestions for improvement (preferably in the form of code),
please contact the package maintainer.
</p>


<h3>References</h3>

<p>Cameron, A.C. and Trivedi, P.K. (1998). <em>Regression Analysis of Count Data</em>. 
Cambridge: Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DoctorVisits">DoctorVisits</a></code>, <code><a href="#topic+NMES1988">NMES1988</a></code>, <code><a href="#topic+RecreationDemand">RecreationDemand</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>

library("MASS")
library("pscl")

###########################################
## Australian health service utilization ##
###########################################

## data
data("DoctorVisits", package = "AER")

## Poisson regression
dv_pois &lt;- glm(visits ~ . + I(age^2), data = DoctorVisits, family = poisson)
dv_qpois &lt;- glm(visits ~ . + I(age^2), data = DoctorVisits, family = quasipoisson)

## Table 3.3 
round(cbind(
  Coef = coef(dv_pois),
  MLH = sqrt(diag(vcov(dv_pois))),
  MLOP = sqrt(diag(vcovOPG(dv_pois))),
  NB1 = sqrt(diag(vcov(dv_qpois))),
  RS = sqrt(diag(sandwich(dv_pois)))
), digits = 3)

## Table 3.4
## NM2-ML
dv_nb &lt;- glm.nb(visits ~ . + I(age^2), data = DoctorVisits)
summary(dv_nb)
## NB1-GLM = quasipoisson
summary(dv_qpois)

## overdispersion tests (page 79)
lrtest(dv_pois, dv_nb) ## p-value would need to be halved
dispersiontest(dv_pois, trafo = 1)
dispersiontest(dv_pois, trafo = 2)


##########################################
## Demand for medical care in NMES 1988 ##
##########################################

## select variables for analysis
data("NMES1988", package = "AER")
nmes &lt;- NMES1988[,-(2:6)]

## dependent variable
## Table 6.1
table(cut(nmes$visits, c(0:13, 100)-0.5, labels = 0:13))

## NegBin regression
nmes_nb &lt;- glm.nb(visits ~ ., data = nmes)

## NegBin hurdle
nmes_h &lt;- hurdle(visits ~ ., data = nmes, dist = "negbin")

## from Table 6.3
lrtest(nmes_nb, nmes_h)

## from Table 6.4
AIC(nmes_nb)
AIC(nmes_nb, k = log(nrow(nmes)))
AIC(nmes_h)
AIC(nmes_h, k = log(nrow(nmes)))

## Table 6.8
coeftest(nmes_h, vcov = sandwich)
logLik(nmes_h)
1/nmes_h$theta


###################################################
## Recreational boating trips to Lake Somerville ##
###################################################

## data
data("RecreationDemand", package = "AER")

## Poisson model:
## Cameron and Trivedi (1998), Table 6.11
## Ozuna and Gomez (1995), Table 2, col. 3
fm_pois &lt;- glm(trips ~ ., data = RecreationDemand, family = poisson)
summary(fm_pois)
logLik(fm_pois)
coeftest(fm_pois, vcov = sandwich)

## Negbin model:
## Cameron and Trivedi (1998), Table 6.11
## Ozuna and Gomez (1995), Table 2, col. 5
library("MASS")
fm_nb &lt;- glm.nb(trips ~ ., data = RecreationDemand)
coeftest(fm_nb, vcov = vcovOPG)
logLik(fm_nb)

## ZIP model:
## Cameron and Trivedi (1998), Table 6.11
fm_zip &lt;- zeroinfl(trips ~  . | quality + income, data = RecreationDemand)
summary(fm_zip)
logLik(fm_zip)

## Hurdle models
## Cameron and Trivedi (1998), Table 6.13
## poisson-poisson
sval &lt;- list(count = c(2.15, 0.044, .467, -.097, .601, .002, -.036, .024), 
             zero = c(-1.88, 0.815, .403, .01, 2.95, 0.006, -.052, .046))
fm_hp0 &lt;- hurdle(trips ~ ., data = RecreationDemand, dist = "poisson",
  zero = "poisson", start = sval, maxit = 0)
fm_hp1 &lt;- hurdle(trips ~ ., data = RecreationDemand, dist = "poisson",
  zero = "poisson", start = sval)
fm_hp2 &lt;- hurdle(trips ~ ., data = RecreationDemand, dist = "poisson",
  zero = "poisson")
sapply(list(fm_hp0, fm_hp1, fm_hp2), logLik)

## negbin-negbin
fm_hnb &lt;- hurdle(trips ~ ., data = RecreationDemand, dist = "negbin", zero = "negbin")
summary(fm_hnb)
logLik(fm_hnb)

sval &lt;- list(count = c(0.841, 0.172, .622, -.057, .576, .057, -.078, .012), 
             zero = c(-3.046, 4.638, -.025, .026, 16.203, 0.030, -.156, .117),
             theta = c(count = 1/1.7, zero = 1/5.609))
fm_hnb2 &lt;- try(hurdle(trips ~ ., data = RecreationDemand,
  dist = "negbin", zero = "negbin", start = sval))
if(!inherits(fm_hnb2, "try-error")) {
summary(fm_hnb2)
logLik(fm_hnb2)
}

## geo-negbin
sval98 &lt;- list(count = c(0.841, 0.172, .622, -.057, .576, .057, -.078, .012), 
             zero = c(-2.88, 1.44, .4, .03, 9.43, 0.01, -.08, .071),
             theta = c(count = 1/1.7))
sval96 &lt;- list(count = c(0.841, 0.172, .622, -.057, .576, .057, -.078, .012), 
             zero = c(-2.882, 1.437, .406, .026, 11.936, 0.008, -.081, .071),
             theta = c(count = 1/1.7))
      
fm_hgnb &lt;- hurdle(trips ~ ., data = RecreationDemand, dist = "negbin", zero = "geometric")
summary(fm_hgnb)
logLik(fm_hgnb)

## logLik with starting values from Gurmu + Trivedi 1996
fm_hgnb96 &lt;- hurdle(trips ~ ., data = RecreationDemand, dist = "negbin", zero = "geometric",
                  start = sval96, maxit = 0)
logLik(fm_hgnb96)

## logit-negbin
fm_hgnb2 &lt;- hurdle(trips ~ ., data = RecreationDemand, dist = "negbin")
summary(fm_hgnb2)
logLik(fm_hgnb2)

## Note: quasi-complete separation
with(RecreationDemand, table(trips &gt; 0, userfee))

</code></pre>

<hr>
<h2 id='CartelStability'>CartelStability</h2><span id='topic+CartelStability'></span>

<h3>Description</h3>

<p>Weekly observations on prices and other factors from 1880&ndash;1886, for a total of 326 weeks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CartelStability")</code></pre>


<h3>Format</h3>

<p>A data frame containing 328 observations on 5 variables.
</p>

<dl>
<dt>price</dt><dd><p>weekly index of price of shipping a ton of grain by rail.</p>
</dd>
<dt>cartel</dt><dd><p>factor. Is a railroad cartel operative?</p>
</dd>
<dt>quantity</dt><dd><p>total tonnage of grain shipped in the week.</p>
</dd>
<dt>season</dt><dd><p>factor indicating season of year. To match the weekly data,
the calendar has been divided into 13 periods, each approximately 4 weeks long.</p>
</dd>
<dt>ice</dt><dd><p>factor. Are the Great Lakes innavigable because of ice?</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Porter, R. H. (1983). A Study of Cartel Stability: The Joint Executive Committee, 1880&ndash;1886. <em>The Bell Journal of Economics</em>, <b>14</b>, 301&ndash;314.
</p>
<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("CartelStability")
summary(CartelStability)
</code></pre>

<hr>
<h2 id='CASchools'>California Test Score Data</h2><span id='topic+CASchools'></span>

<h3>Description</h3>

<p>The dataset contains data on test performance, school 
characteristics and student demographic backgrounds for school districts in California.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CASchools")</code></pre>


<h3>Format</h3>

<p>A data frame containing 420 observations on 14 variables.
</p>

<dl>
<dt>district</dt><dd><p>character. District code.</p>
</dd>
<dt>school</dt><dd><p>character. School name.</p>
</dd>
<dt>county</dt><dd><p>factor indicating county.</p>
</dd>
<dt>grades</dt><dd><p>factor indicating grade span of district.</p>
</dd>
<dt>students</dt><dd><p>Total enrollment.</p>
</dd>
<dt>teachers</dt><dd><p>Number of teachers.</p>
</dd>
<dt>calworks</dt><dd><p>Percent qualifying for CalWorks (income assistance).</p>
</dd>
<dt>lunch</dt><dd><p>Percent qualifying for reduced-price lunch.</p>
</dd>
<dt>computer</dt><dd><p>Number of computers.</p>
</dd>   
<dt>expenditure</dt><dd><p>Expenditure per student.</p>
</dd>
<dt>income</dt><dd><p>District average income (in USD 1,000).</p>
</dd>
<dt>english</dt><dd><p>Percent of English learners.</p>
</dd>
<dt>read</dt><dd><p>Average reading score.</p>
</dd>
<dt>math</dt><dd><p>Average math score.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data used here are from all 420 K-6 and K-8 districts in California 
with data available for 1998 and 1999.  Test scores are on the Stanford 
9 standardized test administered to 5th grade students.  
School characteristics (averaged across the district) include enrollment, 
number of teachers (measured as &ldquo;full-time equivalents&rdquo;, number of 
computers per classroom, and expenditures per student. Demographic 
variables for the students are averaged across the district.  
The demographic variables include the percentage of students in the 
public assistance program CalWorks (formerly AFDC), the percentage 
of students that qualify for a reduced price lunch, and the 
percentage of students that are English learners (that is, students 
for whom English is a second language). 
</p>


<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Stock, J. H. and Watson, M. W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code>, <code><a href="#topic+MASchools">MASchools</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## data and transformations
data("CASchools")
CASchools$stratio &lt;- with(CASchools, students/teachers)
CASchools$score &lt;- with(CASchools, (math + read)/2)

## Stock and Watson (2007)
## p. 152
fm1 &lt;- lm(score ~ stratio, data = CASchools)
coeftest(fm1, vcov = sandwich)

## p. 159
fm2 &lt;- lm(score ~ I(stratio &lt; 20), data = CASchools)
## p. 199
fm3 &lt;- lm(score ~ stratio + english, data = CASchools)
## p. 224
fm4 &lt;- lm(score ~ stratio + expenditure + english, data = CASchools)

## Table 7.1, p. 242 (numbers refer to columns)
fmc3 &lt;- lm(score ~ stratio + english + lunch, data = CASchools)
fmc4 &lt;- lm(score ~ stratio + english + calworks, data = CASchools)
fmc5 &lt;- lm(score ~ stratio + english + lunch + calworks, data = CASchools)

## More examples can be found in:
## help("StockWatson2007")
</code></pre>

<hr>
<h2 id='ChinaIncome'>Chinese Real National Income Data</h2><span id='topic+ChinaIncome'></span>

<h3>Description</h3>

<p>Time series of real national income in China per section (index with 1952 = 100).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ChinaIncome")</code></pre>


<h3>Format</h3>

<p>An annual multiple time series from 1952 to 1988 with 5 variables.
</p>

<dl>
<dt>agriculture</dt><dd><p>Real national income in agriculture sector.</p>
</dd>
<dt>industry</dt><dd><p>Real national income in industry sector.</p>
</dd>
<dt>construction</dt><dd><p>Real national income in construction sector.</p>
</dd>
<dt>transport</dt><dd><p>Real national income in transport sector.</p>
</dd>
<dt>commerce</dt><dd><p>Real national income in commerce sector.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Franses (1998).
</p>


<h3>References</h3>

<p>Chow, G.C. (1993). Capital Formation and Economic Growth in China.
<em>Quarterly Journal of Economics</em>, <b>103</b>, 809&ndash;842.
</p>
<p>Franses, P.H. (1998). <em>Time Series Models for Business and Economic Forecasting</em>.
Cambridge, UK: Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Franses1998">Franses1998</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ChinaIncome")
plot(ChinaIncome)
</code></pre>

<hr>
<h2 id='CigarettesB'>Cigarette Consumption Data</h2><span id='topic+CigarettesB'></span>

<h3>Description</h3>

<p>Cross-section data on cigarette consumption for 46 US States, for the year 1992.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CigarettesB")</code></pre>


<h3>Format</h3>

<p>A data frame containing 46 observations on 3 variables. 
</p>

<dl>
<dt>packs</dt><dd><p>Logarithm of cigarette consumption (in packs) per person of smoking age (&gt; 16 years).</p>
</dd>
<dt>price</dt><dd><p>Logarithm of real price of cigarette in each state.</p>
</dd>
<dt>income</dt><dd><p>Logarithm of real disposable income (per capita) in each state.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data are from Baltagi (2002).
</p>


<h3>References</h3>

<p>Baltagi, B.H. (2002). <em>Econometrics</em>, 3rd ed. Berlin, Springer. 
</p>
<p>Baltagi, B.H. and Levin, D. (1992). Cigarette Taxation: Raising Revenues and Reducing Consumption. 
<em>Structural Change and Economic Dynamics</em>, <b>3</b>, 321&ndash;335.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Baltagi2002">Baltagi2002</a></code>, <code><a href="#topic+CigarettesSW">CigarettesSW</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("CigarettesB")

## Baltagi (2002)
## Table 3.3
cig_lm &lt;- lm(packs ~ price, data = CigarettesB)
summary(cig_lm)

## Chapter 5: diagnostic tests (p. 111-115)
cig_lm2 &lt;- lm(packs ~ price + income, data = CigarettesB)
summary(cig_lm2)
## Glejser tests (p. 112)
ares &lt;- abs(residuals(cig_lm2))
summary(lm(ares ~ income, data = CigarettesB))
summary(lm(ares ~ I(1/income), data = CigarettesB))
summary(lm(ares ~ I(1/sqrt(income)), data = CigarettesB))
summary(lm(ares ~ sqrt(income), data = CigarettesB))
## Goldfeld-Quandt test (p. 112)
gqtest(cig_lm2, order.by = ~ income, data = CigarettesB, fraction = 12, alternative = "less")
## NOTE: Baltagi computes the test statistic as mss1/mss2,
## i.e., tries to find decreasing variances. gqtest() always uses
## mss2/mss1 and has an "alternative" argument.

## Spearman rank correlation test (p. 113)
cor.test(~ ares + income, data = CigarettesB, method = "spearman")
## Breusch-Pagan test (p. 113)
bptest(cig_lm2, varformula = ~ income, data = CigarettesB, student = FALSE)
## White test (Table 5.1, p. 113)
bptest(cig_lm2, ~ income * price + I(income^2) + I(price^2), data = CigarettesB)
## White HC standard errors (Table 5.2, p. 114)
coeftest(cig_lm2, vcov = vcovHC(cig_lm2, type = "HC1"))
## Jarque-Bera test (Figure 5.2, p. 115)
hist(residuals(cig_lm2), breaks = 16, ylim = c(0, 10), col = "lightgray")
library("tseries")
jarque.bera.test(residuals(cig_lm2))

## Tables 8.1 and 8.2
influence.measures(cig_lm2)

## More examples can be found in:
## help("Baltagi2002")
</code></pre>

<hr>
<h2 id='CigarettesSW'>Cigarette Consumption Panel Data</h2><span id='topic+CigarettesSW'></span>

<h3>Description</h3>

<p>Panel data on cigarette consumption for the 48 continental US States from 1985&ndash;1995.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CigarettesSW")</code></pre>


<h3>Format</h3>

<p>A data frame containing 48 observations on 7 variables for 2 periods. 
</p>

<dl>
<dt>state</dt><dd><p>Factor indicating state.</p>
</dd>
<dt>year</dt><dd><p>Factor indicating year.</p>
</dd>
<dt>cpi</dt><dd><p>Consumer price index.</p>
</dd>
<dt>population</dt><dd><p>State population.</p>
</dd>
<dt>packs</dt><dd><p>Number of packs per capita.</p>
</dd>
<dt>income</dt><dd><p>State personal income (total, nominal).</p>
</dd>
<dt>tax</dt><dd><p>Average state, federal and average local excise taxes for fiscal year.</p>
</dd>
<dt>price</dt><dd><p>Average price during fiscal year, including sales tax.</p>
</dd>
<dt>taxs</dt><dd><p>Average excise taxes for fiscal year, including sales tax.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>,
2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code>, <code><a href="#topic+CigarettesB">CigarettesB</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Stock and Watson (2007)
## data and transformations 
data("CigarettesSW")
CigarettesSW &lt;- transform(CigarettesSW,
  rprice  = price/cpi,
  rincome = income/population/cpi,
  rtax    = tax/cpi,
  rtdiff  = (taxs - tax)/cpi
)
c1985 &lt;- subset(CigarettesSW, year == "1985")
c1995 &lt;- subset(CigarettesSW, year == "1995")

## convenience function: HC1 covariances
hc1 &lt;- function(x) vcovHC(x, type = "HC1")

## Equations 12.9--12.11
fm_s1 &lt;- lm(log(rprice) ~ rtdiff, data = c1995)
coeftest(fm_s1, vcov = hc1)
fm_s2 &lt;- lm(log(packs) ~ fitted(fm_s1), data = c1995)
fm_ivreg &lt;- ivreg(log(packs) ~ log(rprice) | rtdiff, data = c1995)
coeftest(fm_ivreg, vcov = hc1)

## Equation 12.15
fm_ivreg2 &lt;- ivreg(log(packs) ~ log(rprice) + log(rincome) | log(rincome) + rtdiff, data = c1995)
coeftest(fm_ivreg2, vcov = hc1)
## Equation 12.16
fm_ivreg3 &lt;- ivreg(log(packs) ~ log(rprice) + log(rincome) | log(rincome) + rtdiff + rtax,
  data = c1995)
coeftest(fm_ivreg3, vcov = hc1)

## More examples can be found in:
## help("StockWatson2007")
</code></pre>

<hr>
<h2 id='CollegeDistance'>College Distance Data</h2><span id='topic+CollegeDistance'></span>

<h3>Description</h3>

<p>Cross-section data from the High School and Beyond survey conducted by the
Department of Education in 1980, with a follow-up in 1986. The survey included
students from approximately 1,100 high schools.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CollegeDistance")</code></pre>


<h3>Format</h3>

<p>A data frame containing 4,739 observations on 14 variables.
</p>

<dl>
<dt>gender</dt><dd><p>factor indicating gender.</p>
</dd>
<dt>ethnicity</dt><dd><p>factor indicating ethnicity (African-American, Hispanic or other).</p>
</dd>
<dt>score</dt><dd><p>base year composite test score. These are achievement tests given to high
school seniors in the sample.</p>
</dd>
<dt>fcollege</dt><dd><p>factor. Is the father a college graduate?</p>
</dd>
<dt>mcollege</dt><dd><p>factor. Is the mother a college graduate?</p>
</dd>
<dt>home</dt><dd><p>factor. Does the family own their home?</p>
</dd>
<dt>urban</dt><dd><p>factor. Is the school in an urban area?</p>
</dd>
<dt>unemp</dt><dd><p>county unemployment rate in 1980.</p>
</dd>
<dt>wage</dt><dd><p>state hourly wage in manufacturing in 1980.</p>
</dd>
<dt>distance</dt><dd><p>distance from 4-year college (in 10 miles).</p>
</dd>
<dt>tuition</dt><dd><p>average state 4-year college tuition (in 1000 USD).</p>
</dd>
<dt>education</dt><dd><p>number of years of education.</p>
</dd>
<dt>income</dt><dd><p>factor. Is the family income above USD 25,000 per year?</p>
</dd>
<dt>region</dt><dd><p>factor indicating region (West or other).</p>
</dd>
</dl>



<h3>Details</h3>

<p>Rouse (1995) computed years of education by assigning 12 years to all
members of the senior class. Each additional year of secondary education counted as a
one year. Students with vocational degrees were assigned 13 years, AA degrees were
assigned 14 years, BA degrees were assigned 16 years, those with some graduate
education were assigned 17 years, and those with a graduate degree were assigned 18
years.
</p>
<p>Stock and Watson (2007) provide separate data files for the students from
Western states and the remaining students. <code>CollegeDistance</code> includes
both data sets, subsets are easily obtained (see also examples).
</p>


<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Rouse, C.E. (1995). Democratization or Diversion? The Effect of Community
Colleges on Educational Attainment. <em>Journal of Business &amp; Economic Statistics</em>,
<b>12</b>, 217&ndash;224.
</p>
<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## exclude students from Western states
data("CollegeDistance")
cd &lt;- subset(CollegeDistance, region != "west")
summary(cd)
</code></pre>

<hr>
<h2 id='ConsumerGood'>Properties of a Fast-Moving Consumer Good</h2><span id='topic+ConsumerGood'></span>

<h3>Description</h3>

<p>Time series of distribution, market share and price of a fast-moving
consumer good.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ConsumerGood")</code></pre>


<h3>Format</h3>

<p>A weekly multiple time series from 1989(11) to 1991(9) with 3 variables.
</p>

<dl>
<dt>distribution</dt><dd><p>Distribution.</p>
</dd>
<dt>share</dt><dd><p>Market share.</p>
</dd>
<dt>price</dt><dd><p>Price.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Franses (1998).
</p>


<h3>References</h3>

<p>Franses, P.H. (1998). <em>Time Series Models for Business and Economic Forecasting</em>.
Cambridge, UK: Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Franses1998">Franses1998</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ConsumerGood")
plot(ConsumerGood)
</code></pre>

<hr>
<h2 id='CPS1985'>Determinants of Wages Data (CPS 1985)</h2><span id='topic+CPS1985'></span>

<h3>Description</h3>

<p>Cross-section data originating from the May 1985 Current Population Survey
by the US Census Bureau (random sample drawn for Berndt 1991).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CPS1985")</code></pre>


<h3>Format</h3>

<p>A data frame containing 534 observations on 11 variables.
</p>

<dl>
<dt>wage</dt><dd><p>Wage (in dollars per hour).</p>
</dd>
<dt>education</dt><dd><p>Number of years of education.</p>
</dd>
<dt>experience</dt><dd><p>Number of years of potential work experience
(<code>age - education - 6</code>).</p>
</dd>
<dt>age</dt><dd><p>Age in years.</p>
</dd>
<dt>ethnicity</dt><dd><p>Factor with levels <code>"cauc"</code>, <code>"hispanic"</code>,
<code>"other"</code>.</p>
</dd>
<dt>region</dt><dd><p>Factor. Does the individual live in the South?</p>
</dd>
<dt>gender</dt><dd><p>Factor indicating gender.</p>
</dd>
<dt>occupation</dt><dd><p>Factor with levels <code>"worker"</code> (tradesperson or assembly line worker),
<code>"technical"</code> (technical or professional worker), <code>"services"</code> (service
worker), <code>"office"</code> (office and clerical worker), <code>"sales"</code> (sales worker),
<code>"management"</code> (management and administration).</p>
</dd>
<dt>sector</dt><dd><p>Factor with levels <code>"manufacturing"</code> (manufacturing or mining),
<code>"construction"</code>, <code>"other"</code>.</p>
</dd>
<dt>union</dt><dd><p>Factor. Does the individual work on a union job?</p>
</dd>
<dt>married</dt><dd><p>Factor. Is the individual married?</p>
</dd>
</dl>



<h3>Source</h3>

<p>StatLib. 
</p>
<p><a href="https://lib.stat.cmu.edu/datasets/CPS_85_Wages">https://lib.stat.cmu.edu/datasets/CPS_85_Wages</a>
</p>


<h3>References</h3>

<p>Berndt, E.R. (1991). <em>The Practice of Econometrics</em>. New York: Addison-Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CPS1988">CPS1988</a></code>, <code><a href="#topic+CPSSW">CPSSW</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("CPS1985")

## Berndt (1991)
## Exercise 2, p. 196
cps_2b &lt;- lm(log(wage) ~ union + education, data = CPS1985)
cps_2c &lt;- lm(log(wage) ~ -1 + union + education, data = CPS1985)

## Exercise 3, p. 198/199
cps_3a &lt;- lm(log(wage) ~ education + experience + I(experience^2),
  data = CPS1985)
cps_3b &lt;- lm(log(wage) ~ gender + education + experience + I(experience^2),
  data = CPS1985)
cps_3c &lt;- lm(log(wage) ~ gender + married + education + experience + I(experience^2),
  data = CPS1985)
cps_3e &lt;- lm(log(wage) ~ gender*married + education + experience + I(experience^2),
  data = CPS1985)

## Exercise 4, p. 199/200
cps_4a &lt;- lm(log(wage) ~ gender + union + ethnicity + education + experience + I(experience^2),
  data = CPS1985)
cps_4c &lt;- lm(log(wage) ~ gender + union + ethnicity + education * experience + I(experience^2),
  data = CPS1985)

## Exercise 6, p. 203
cps_6a &lt;- lm(log(wage) ~ gender + union + ethnicity + education + experience + I(experience^2),
  data = CPS1985)
cps_6a_noeth &lt;- lm(log(wage) ~ gender + union + education + experience + I(experience^2),
  data = CPS1985)
anova(cps_6a_noeth, cps_6a)

## Exercise 8, p. 208
cps_8a &lt;- lm(log(wage) ~ gender + union + ethnicity + education + experience + I(experience^2),
  data = CPS1985)
summary(cps_8a)
coeftest(cps_8a, vcov = vcovHC(cps_8a, type = "HC0"))
</code></pre>

<hr>
<h2 id='CPS1988'>Determinants of Wages Data (CPS 1988)</h2><span id='topic+CPS1988'></span>

<h3>Description</h3>

<p>Cross-section data originating from the March 1988 Current Population Survey by the 
US Census Bureau.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CPS1988")</code></pre>


<h3>Format</h3>

<p>A data frame containing 28,155 observations on 7 variables.
</p>

<dl>
<dt>wage</dt><dd><p>Wage (in dollars per week).</p>
</dd>
<dt>education</dt><dd><p>Number of years of education.</p>
</dd>
<dt>experience</dt><dd><p>Number of years of potential work experience.</p>
</dd>
<dt>ethnicity</dt><dd><p>Factor with levels <code>"cauc"</code> and <code>"afam"</code> (African-American).</p>
</dd>
<dt>smsa</dt><dd><p>Factor. Does the individual reside in a Standard Metropolitan Statistical Area (SMSA)?</p>
</dd>
<dt>region</dt><dd><p>Factor with levels <code>"northeast"</code>, <code>"midwest"</code>, <code>"south"</code>, <code>"west"</code>.</p>
</dd>
<dt>parttime</dt><dd><p>Factor. Does the individual work part-time?</p>
</dd>
</dl>



<h3>Details</h3>

<p>A sample of men aged 18 to 70 with positive annual income greater than USD 50 in 1992, 
who are not self-employed nor working without pay. Wages are deflated by the deflator of 
Personal Consumption Expenditure for 1992.
</p>
<p>A problem with CPS data is that it does not provide actual work experience. 
It is therefore customary to compute experience as <code>age - education - 6</code> 
(as was done by Bierens and Ginther, 2001), this may be considered potential experience. 
As a result, some respondents have negative experience.
</p>


<h3>Source</h3>

<p>Personal web page of Herman J. Bierens.
</p>


<h3>References</h3>

<p>Bierens, H.J., and Ginther, D. (2001). Integrated Conditional Moment Testing of Quantile Regression Models. 
<em>Empirical Economics</em>, <b>26</b>, 307&ndash;324.
</p>
<p>Buchinsky, M. (1998). Recent Advances in Quantile Regression Models: A Practical Guide for Empirical Research. 
<em>Journal of Human Resources</em>, <b>33</b>, 88&ndash;126.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CPS1985">CPS1985</a></code>, <code><a href="#topic+CPSSW">CPSSW</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## data and packages
library("quantreg")
data("CPS1988")
CPS1988$region &lt;- relevel(CPS1988$region, ref = "south")

## Model equations: Mincer-type, quartic, Buchinsky-type
mincer &lt;- log(wage) ~ ethnicity + education + experience + I(experience^2)
quart &lt;- log(wage) ~ ethnicity + education + experience + I(experience^2) +
  I(experience^3) + I(experience^4)
buchinsky &lt;- log(wage) ~ ethnicity * (education + experience + parttime) + 
  region*smsa + I(experience^2) + I(education^2) + I(education*experience)

## OLS and LAD fits (for LAD see Bierens and Ginter, Tables 1-3.A.)
mincer_ols &lt;- lm(mincer, data = CPS1988)
quart_ols &lt;- lm(quart, data = CPS1988)
buchinsky_ols &lt;- lm(buchinsky, data = CPS1988)

quart_lad &lt;- rq(quart, data = CPS1988)
mincer_lad &lt;- rq(mincer, data = CPS1988)
buchinsky_lad &lt;- rq(buchinsky, data = CPS1988)

</code></pre>

<hr>
<h2 id='CPSSW'>Stock and Watson CPS Data Sets</h2><span id='topic+CPSSW'></span><span id='topic+CPSSW9298'></span><span id='topic+CPSSW9204'></span><span id='topic+CPSSW04'></span><span id='topic+CPSSW3'></span><span id='topic+CPSSW8'></span><span id='topic+CPSSWEducation'></span>

<h3>Description</h3>

<p>Stock and Watson (2007) provide several subsets created from 
March Current Population Surveys (CPS) with data on the
relationship of earnings and education over several year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CPSSW9204")
data("CPSSW9298")
data("CPSSW04")
data("CPSSW3")
data("CPSSW8")
data("CPSSWEducation")
</code></pre>


<h3>Format</h3>

<p><code>CPSSW9298</code>: A data frame containing 13,501 observations on 5 variables.
<code>CPSSW9204</code>: A data frame containing 15,588 observations on 5 variables.
<code>CPSSW04</code>: A data frame containing 7,986 observations on 4 variables.
<code>CPSSW3</code>: A data frame containing 20,999 observations on 3 variables.
<code>CPSSW8</code>: A data frame containing 61,395 observations on 5 variables.
<code>CPSSWEducation</code>: A data frame containing 2,950 observations on 4 variables.
</p>

<dl>
<dt>year</dt><dd><p>factor indicating year.</p>
</dd>
<dt>earnings</dt><dd><p>average hourly earnings (sum of annual pretax wages, salaries, tips,
and bonuses, divided by the number of hours worked annually).</p>
</dd>
<dt>education</dt><dd><p>number of years of education.</p>
</dd>
<dt>degree</dt><dd><p>factor indicating highest educational degree (<code>"bachelor"</code>
or<code>"highschool"</code>).</p>
</dd>
<dt>gender</dt><dd><p>factor indicating gender.</p>
</dd>
<dt>age</dt><dd><p>age in years.</p>
</dd> 
<dt>region</dt><dd><p>factor indicating region of residence
(<code>"Northeast"</code>, <code>"Midwest"</code>, <code>"South"</code>, <code>"West"</code>).</p>
</dd>
</dl>



<h3>Details</h3>

<p>Each month the Bureau of Labor Statistics in the US Department of Labor
conducts the Current Population Survey (CPS), which provides data
on labor force characteristics of the population, including the level of
employment, unemployment, and earnings. Approximately 65,000 randomly
selected US households are surveyed each month. The sample is chosen by
randomly selecting addresses from a database. 
Details can be found in the Handbook of Labor Statistics and is described
on the Bureau of Labor Statistics website (<a href="https://www.bls.gov/">https://www.bls.gov/</a>).
</p>
<p>The survey conducted each March is more detailed than in other months
and asks questions about earnings during the previous year. 
The data sets contain data for 2004 (from the March 2005 survey), and some
also for earlier years (up to 1992). 
</p>
<p>If education is given, it is for full-time workers, defined as
workers employed more than 35 hours per week for at least 48 weeks in the
previous year. Data are provided for workers whose 
highest educational achievement is a high school diploma and a bachelor's degree.
</p>
<p>Earnings for years earlier than 2004 were adjusted for inflation by putting them
in 2004 USD using the Consumer Price Index (CPI). From 1992 to 2004, the
price of the CPI market basket rose by 34.6%. To make earnings in 1992 and 2004
comparable, 1992 earnings are inflated by the amount of overall CPI price
inflation, by multiplying 1992 earnings by 1.346 to put them into 2004 dollars.
</p>
<p><code>CPSSW9204</code> provides the distribution of earnings in the US in 1992 and 2004
for college-educated full-time workers aged 25&ndash;34.
<code>CPSSW04</code> is a subset of <code>CPSSW9204</code> and provides the distribution of
earnings in the US in 2004 for college-educated full-time workers aged 25&ndash;34.
<code>CPSSWEducation</code> is similar (but not a true subset) and contains the
distribution of earnings in the US in 2004 for college-educated full-time workers
aged 29&ndash;30.
<code>CPSSW8</code> contains a larger sample with workers aged 21&ndash;64, additionally
providing information about the region of residence.
<code>CPSSW9298</code> is similar to <code>CPSSW9204</code> providing data from 1992 and 1998
(with the 1992 subsets not being exactly identical).
<code>CPSSW3</code> provides trends (from 1992 to 2004) in hourly earnings in the US of
working college graduates aged 25&ndash;34 (in 2004 USD).
</p>


<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code>, <code><a href="#topic+CPS1985">CPS1985</a></code>, <code><a href="#topic+CPS1988">CPS1988</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("CPSSW3")
with(CPSSW3, interaction.plot(year, gender, earnings))

## Stock and Watson, p. 165
data("CPSSWEducation")
plot(earnings ~ education, data = CPSSWEducation)
fm &lt;- lm(earnings ~ education, data = CPSSWEducation)
coeftest(fm, vcov = sandwich)
abline(fm)
</code></pre>

<hr>
<h2 id='CreditCard'>Expenditure and Default Data</h2><span id='topic+CreditCard'></span>

<h3>Description</h3>

<p>Cross-section data on the credit history for a sample of applicants for a type of credit card.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CreditCard")</code></pre>


<h3>Format</h3>

<p>A data frame containing 1,319 observations on 12 variables.
</p>

<dl>
<dt>card</dt><dd><p>Factor. Was the application for a credit card accepted?</p>
</dd>
<dt>reports</dt><dd><p>Number of major derogatory reports.</p>
</dd>
<dt>age</dt><dd><p>Age in years plus twelfths of a year.</p>
</dd>
<dt>income</dt><dd><p>Yearly income (in USD 10,000).</p>
</dd>
<dt>share</dt><dd><p>Ratio of monthly credit card expenditure to yearly income.</p>
</dd>
<dt>expenditure</dt><dd><p>Average monthly credit card expenditure.</p>
</dd>
<dt>owner</dt><dd><p>Factor. Does the individual own their home?</p>
</dd>
<dt>selfemp</dt><dd><p>Factor. Is the individual self-employed?</p>
</dd>
<dt>dependents</dt><dd><p>Number of dependents.</p>
</dd>   
<dt>months</dt><dd><p>Months living at current address.</p>
</dd>
<dt>majorcards</dt><dd><p>Number of major credit cards held.</p>
</dd>
<dt>active</dt><dd><p>Number of active credit accounts.</p>
</dd>   
</dl>



<h3>Details</h3>

<p>According to Greene (2003, p. 952) <code>dependents</code> equals <code>1 + number of dependents</code>, 
our calculations suggest that it equals <code>number of dependents</code>.
</p>
<p>Greene (2003) provides this data set twice in Table F21.4 and F9.1, respectively.
Table F9.1 has just the observations, rounded to two digits. Here, we give the 
F21.4 version, see the examples for the F9.1 version. Note that <code>age</code> has some
suspiciously low values (below one year) for some applicants. One of these differs
between the F9.1 and F21.4 version.
</p>


<h3>Source</h3>

<p>Online complements to Greene (2003). Table F21.4.
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("CreditCard")

## Greene (2003)
## extract data set F9.1
ccard &lt;- CreditCard[1:100,]
ccard$income &lt;- round(ccard$income, digits = 2)
ccard$expenditure &lt;- round(ccard$expenditure, digits = 2)
ccard$age &lt;- round(ccard$age + .01)
## suspicious:
CreditCard$age[CreditCard$age &lt; 1]
## the first of these is also in TableF9.1 with 36 instead of 0.5:
ccard$age[79] &lt;- 36

## Example 11.1
ccard &lt;- ccard[order(ccard$income),]
ccard0 &lt;- subset(ccard, expenditure &gt; 0)
cc_ols &lt;- lm(expenditure ~ age + owner + income + I(income^2), data = ccard0)

## Figure 11.1
plot(residuals(cc_ols) ~ income, data = ccard0, pch = 19)

## Table 11.1
mean(ccard$age)
prop.table(table(ccard$owner))
mean(ccard$income)

summary(cc_ols)
sqrt(diag(vcovHC(cc_ols, type = "HC0")))
sqrt(diag(vcovHC(cc_ols, type = "HC2"))) 
sqrt(diag(vcovHC(cc_ols, type = "HC1")))

bptest(cc_ols, ~ (age + income + I(income^2) + owner)^2 + I(age^2) + I(income^4), data = ccard0)
gqtest(cc_ols)
bptest(cc_ols, ~ income + I(income^2), data = ccard0, studentize = FALSE)
bptest(cc_ols, ~ income + I(income^2), data = ccard0)

## More examples can be found in:
## help("Greene2003")
</code></pre>

<hr>
<h2 id='dispersiontest'>Dispersion Test</h2><span id='topic+dispersiontest'></span>

<h3>Description</h3>

<p>Tests the null hypothesis of equidispersion in Poisson GLMs against
the alternative of overdispersion and/or underdispersion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dispersiontest(object, trafo = NULL, alternative = c("greater", "two.sided", "less"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dispersiontest_+3A_object">object</code></td>
<td>
<p>a fitted Poisson GLM of class <code>"glm"</code> as fitted
by <code><a href="stats.html#topic+glm">glm</a></code> with family <code><a href="stats.html#topic+poisson">poisson</a></code>.</p>
</td></tr>
<tr><td><code id="dispersiontest_+3A_trafo">trafo</code></td>
<td>
<p>a specification of the alternative (see also details),
can be numeric or a (positive) function or <code>NULL</code> (the default).</p>
</td></tr>
<tr><td><code id="dispersiontest_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis:
<code>"greater"</code> corresponds to overdispersion, <code>"less"</code> to
underdispersion and <code>"two.sided"</code> to either one.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The standard Poisson GLM models the (conditional) mean
<code class="reqn">\mathsf{E}[y] = \mu</code> which is assumed to be equal to the
variance <code class="reqn">\mathsf{VAR}[y] = \mu</code>. <code>dispersiontest</code>
assesses the hypothesis that this assumption holds (equidispersion) against
the alternative that the variance is of the form:
</p>
<p style="text-align: center;"><code class="reqn">\mathsf{VAR}[y] \quad = \quad \mu \; + \; \alpha \cdot \mathrm{trafo}(\mu).</code>
</p>

<p>Overdispersion corresponds to <code class="reqn">\alpha &gt; 0</code> and underdispersion to
<code class="reqn">\alpha &lt; 0</code>. The coefficient <code class="reqn">\alpha</code> can be estimated
by an auxiliary OLS regression and tested with the corresponding t (or z) statistic
which is asymptotically standard normal under the null hypothesis.
</p>
<p>Common specifications of the transformation function <code class="reqn">\mathrm{trafo}</code> are
<code class="reqn">\mathrm{trafo}(\mu) = \mu^2</code> or <code class="reqn">\mathrm{trafo}(\mu) = \mu</code>.
The former corresponds to a negative binomial (NB) model with quadratic variance function
(called NB2 by Cameron and Trivedi, 2005), the latter to a NB model with linear variance
function (called NB1 by Cameron and Trivedi, 2005) or quasi-Poisson model with dispersion 
parameter, i.e.,
</p>
<p style="text-align: center;"><code class="reqn">\mathsf{VAR}[y] \quad = \quad (1 + \alpha) \cdot \mu = \mathrm{dispersion} \cdot \mu.</code>
</p>

<p>By default, for <code>trafo = NULL</code>, the latter dispersion formulation is used in
<code>dispersiontest</code>. Otherwise, if <code>trafo</code> is specified, the test is formulated
in terms of the parameter <code class="reqn">\alpha</code>. The transformation <code>trafo</code> can either
be specified as a function or an integer corresponding to the function <code>function(x) x^trafo</code>,
such that <code>trafo = 1</code> and <code>trafo = 2</code> yield the linear and quadratic formulations
respectively.
</p>


<h3>Value</h3>

<p>An object of class <code>"htest"</code>.</p>


<h3>References</h3>

<p>Cameron, A.C. and Trivedi, P.K. (1990). Regression-based Tests for Overdispersion in the Poisson Model.  
<em>Journal of Econometrics</em>, <b>46</b>, 347&ndash;364.
</p>
<p>Cameron, A.C. and Trivedi, P.K. (1998). <em>Regression Analysis of Count Data</em>. 
Cambridge: Cambridge University Press.
</p>
<p>Cameron, A.C. and Trivedi, P.K. (2005). <em>Microeconometrics: Methods and Applications</em>.
Cambridge: Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="stats.html#topic+poisson">poisson</a></code>, <code><a href="MASS.html#topic+glm.nb">glm.nb</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("RecreationDemand")
rd &lt;- glm(trips ~ ., data = RecreationDemand, family = poisson)

## linear specification (in terms of dispersion)
dispersiontest(rd)
## linear specification (in terms of alpha)
dispersiontest(rd, trafo = 1)
## quadratic specification (in terms of alpha)
dispersiontest(rd, trafo = 2)
dispersiontest(rd, trafo = function(x) x^2)

## further examples
data("DoctorVisits")
dv &lt;- glm(visits ~ . + I(age^2), data = DoctorVisits, family = poisson)
dispersiontest(dv)

data("NMES1988")
nmes &lt;- glm(visits ~ health + age + gender + married + income + insurance,
  data = NMES1988, family = poisson)
dispersiontest(nmes)
</code></pre>

<hr>
<h2 id='DJFranses'>Dow Jones Index Data (Franses)</h2><span id='topic+DJFranses'></span>

<h3>Description</h3>

<p>Dow Jones index time series computed at the end of the week where
week is assumed to run from Thursday to Wednesday.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("DJFranses")</code></pre>


<h3>Format</h3>

<p>A weekly univariate time series from 1980(1) to 1994(42).
</p>


<h3>Source</h3>

<p>Online complements to Franses (1998).
</p>


<h3>References</h3>

<p>Franses, P.H. (1998). <em>Time Series Models for Business and Economic Forecasting</em>.
Cambridge, UK: Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Franses1998">Franses1998</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("DJFranses")
plot(DJFranses)
</code></pre>

<hr>
<h2 id='DJIA8012'>Dow Jones Industrial Average (DJIA) index</h2><span id='topic+DJIA8012'></span>

<h3>Description</h3>

<p>Time series of the Dow Jones Industrial Average (DJIA) index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("DJIA8012")</code></pre>


<h3>Format</h3>

<p>A daily univariate time series from 1980-01-01 to 2012-12-31 (of class <code>"zoo"</code> with <code>"Date"</code> index).
</p>


<h3>Source</h3>

<p>Online complements to Franses, van Dijk and Opschoor (2014).
</p>
<p><a href="https://www.cambridge.org/us/academic/subjects/economics/econometrics-statistics-and-mathematical-economics/time-series-models-business-and-economic-forecasting-2nd-edition">https://www.cambridge.org/us/academic/subjects/economics/econometrics-statistics-and-mathematical-economics/time-series-models-business-and-economic-forecasting-2nd-edition</a>
</p>


<h3>References</h3>

<p>Franses, P.H., van Dijk, D. and Opschoor, A. (2014). <em>Time Series Models for Business and Economic Forecasting</em>, 2nd ed.
Cambridge, UK: Cambridge University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("DJIA8012")
plot(DJIA8012)

# p.26, Figure 2.18
dldjia &lt;- diff(log(DJIA8012))
plot(dldjia)

# p.141, Figure 6.4
plot(window(dldjia, start = "1987-09-01", end = "1987-12-31"))

# p.167, Figure 7.1
dldjia9005 &lt;- window(dldjia, start = "1990-01-01", end = "2005-12-31")
qqnorm(dldjia9005)
qqline(dldjia9005, lty = 2)

# p.170, Figure 7.4
acf(dldjia9005,  na.action = na.exclude, lag.max = 250, ylim =  c(-0.1, 0.25))
acf(dldjia9005^2,  na.action = na.exclude, lag.max = 250, ylim =  c(-0.1, 0.25))
acf(abs(dldjia9005),  na.action = na.exclude, lag.max = 250, ylim =  c(-0.1, 0.25))
</code></pre>

<hr>
<h2 id='DoctorVisits'>Australian Health Service Utilization Data</h2><span id='topic+DoctorVisits'></span>

<h3>Description</h3>

<p>Cross-section data originating from the 1977&ndash;1978 Australian Health Survey. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("DoctorVisits")</code></pre>


<h3>Format</h3>

<p>A data frame containing 5,190 observations on 12 variables.
</p>

<dl>
<dt>visits</dt><dd><p>Number of doctor visits in past 2 weeks.</p>
</dd>
<dt>gender</dt><dd><p>Factor indicating gender.</p>
</dd>
<dt>age</dt><dd><p>Age in years divided by 100.</p>
</dd>
<dt>income</dt><dd><p>Annual income in tens of thousands of dollars.</p>
</dd>
<dt>illness</dt><dd><p>Number of illnesses in past 2 weeks.</p>
</dd>
<dt>reduced</dt><dd><p>Number of days of reduced activity in past 2 weeks due to illness or injury.</p>
</dd>
<dt>health</dt><dd><p>General health questionnaire score using Goldberg's method.</p>
</dd>
<dt>private</dt><dd><p>Factor. Does the individual have private health insurance?</p>
</dd>
<dt>freepoor</dt><dd><p>Factor. Does the individual have free government health insurance due to low income?</p>
</dd>   
<dt>freerepat</dt><dd><p>Factor. Does the individual have free government health insurance due to old age, 
disability or veteran status?</p>
</dd>  
<dt>nchronic</dt><dd><p>Factor. Is there a chronic condition not limiting activity?</p>
</dd>
<dt>lchronic</dt><dd><p>Factor. Is there a chronic condition limiting activity?</p>
</dd>
</dl>



<h3>Source</h3>

<p>Journal of Applied Econometrics Data Archive. 
</p>
<p><a href="http://qed.econ.queensu.ca/jae/1997-v12.3/mullahy/">http://qed.econ.queensu.ca/jae/1997-v12.3/mullahy/</a>
</p>


<h3>References</h3>

<p>Cameron, A.C. and Trivedi, P.K. (1986). Econometric Models Based on Count Data: 
Comparisons and Applications of Some Estimators and Tests.
<em>Journal of Applied Econometrics</em>,
<b>1</b>, 29&ndash;53.
</p>
<p>Cameron, A.C. and Trivedi, P.K. (1998). <em>Regression Analysis of Count Data</em>. 
Cambridge: Cambridge University Press.
</p>
<p>Mullahy, J. (1997). Heterogeneity, Excess Zeros, and the Structure of Count Data Models.  
<em>Journal of Applied Econometrics</em>,
<b>12</b>, 337&ndash;350.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CameronTrivedi1998">CameronTrivedi1998</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("DoctorVisits", package = "AER")
library("MASS")

## Cameron and Trivedi (1986), Table III, col. (1)
dv_lm &lt;- lm(visits ~ . + I(age^2), data = DoctorVisits)
summary(dv_lm)

## Cameron and Trivedi (1998), Table 3.3 
dv_pois &lt;- glm(visits ~ . + I(age^2), data = DoctorVisits, family = poisson)
summary(dv_pois)                  ## MLH standard errors
coeftest(dv_pois, vcov = vcovOPG) ## MLOP standard errors
logLik(dv_pois)
## standard errors denoted RS ("unspecified omega robust sandwich estimate")
coeftest(dv_pois, vcov = sandwich)

## Cameron and Trivedi (1986), Table III, col. (4)
dv_nb &lt;- glm.nb(visits ~ . + I(age^2), data = DoctorVisits)
summary(dv_nb)
logLik(dv_nb)
</code></pre>

<hr>
<h2 id='DutchAdvert'>TV and Radio Advertising Expenditures Data</h2><span id='topic+DutchAdvert'></span>

<h3>Description</h3>

<p>Time series of television and radio advertising expenditures (in real terms)
in The Netherlands.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("DutchAdvert")</code></pre>


<h3>Format</h3>

<p>A four-weekly multiple time series from 1978(1) to 1994(13) with 2 variables.
</p>

<dl>
<dt>tv</dt><dd><p>Television advertising expenditures.</p>
</dd>
<dt>radio</dt><dd><p>Radio advertising expenditures.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Originally available as an online supplement to Franses (1998). Now available via online complements to Franses, van Dijk and Opschoor (2014).
</p>
<p><a href="https://www.cambridge.org/us/academic/subjects/economics/econometrics-statistics-and-mathematical-economics/time-series-models-business-and-economic-forecasting-2nd-edition">https://www.cambridge.org/us/academic/subjects/economics/econometrics-statistics-and-mathematical-economics/time-series-models-business-and-economic-forecasting-2nd-edition</a>
</p>


<h3>References</h3>

<p>Franses, P.H. (1998). <em>Time Series Models for Business and Economic Forecasting</em>.
Cambridge, UK: Cambridge University Press.
</p>
<p>Franses, P.H., van Dijk, D. and Opschoor, A. (2014). <em>Time Series Models for Business and Economic Forecasting</em>, 2nd ed.
Cambridge, UK: Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Franses1998">Franses1998</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("DutchAdvert")
plot(DutchAdvert)

## EACF tables (Franses 1998, Sec. 5.1, p. 99)
ctrafo &lt;- function(x) residuals(lm(x ~ factor(cycle(x))))
ddiff &lt;- function(x) diff(diff(x, frequency(x)), 1)
eacf &lt;- function(y, lag = 12) {
  stopifnot(all(lag &gt; 0))
  if(length(lag) &lt; 2) lag &lt;- 1:lag
  rval &lt;- sapply(
    list(y = y, dy = diff(y), cdy = ctrafo(diff(y)),
         Dy = diff(y, frequency(y)), dDy = ddiff(y)),
    function(x) acf(x, plot = FALSE, lag.max = max(lag))$acf[lag + 1])
  rownames(rval) &lt;- lag
  return(rval)
}

## Franses (1998, p. 103), Table 5.4
round(eacf(log(DutchAdvert[,"tv"]), lag = c(1:19, 26, 39)), digits = 3)
</code></pre>

<hr>
<h2 id='DutchSales'>Dutch Retail Sales Index Data</h2><span id='topic+DutchSales'></span>

<h3>Description</h3>

<p>Time series of retail sales index in The Netherlands.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("DutchSales")</code></pre>


<h3>Format</h3>

<p>A monthly univariate time series from 1960(5) to 1995(9).
</p>


<h3>Source</h3>

<p>Online complements to Franses (1998).
</p>


<h3>References</h3>

<p>Franses, P.H. (1998). <em>Time Series Models for Business and Economic Forecasting</em>.
Cambridge, UK: Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Franses1998">Franses1998</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("DutchSales")
plot(DutchSales)

## EACF tables (Franses 1998, p. 99)
ctrafo &lt;- function(x) residuals(lm(x ~ factor(cycle(x))))
ddiff &lt;- function(x) diff(diff(x, frequency(x)), 1)
eacf &lt;- function(y, lag = 12) {
  stopifnot(all(lag &gt; 0))
  if(length(lag) &lt; 2) lag &lt;- 1:lag
  rval &lt;- sapply(
    list(y = y, dy = diff(y), cdy = ctrafo(diff(y)),
         Dy = diff(y, frequency(y)), dDy = ddiff(y)),
    function(x) acf(x, plot = FALSE, lag.max = max(lag))$acf[lag + 1])
  rownames(rval) &lt;- lag
  return(rval)
}

## Franses (1998), Table 5.3
round(eacf(log(DutchSales), lag = c(1:18, 24, 36)), digits = 3)
</code></pre>

<hr>
<h2 id='Electricity1955'>Cost Function of Electricity Producers (1955, Nerlove Data)</h2><span id='topic+Electricity1955'></span>

<h3>Description</h3>

<p>Cost function data for 145 (+14) US electricity producers in 1955.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Electricity1955")</code></pre>


<h3>Format</h3>

<p>A data frame containing 159 observations on 8 variables.
</p>

<dl>
<dt>cost</dt><dd><p>total cost.</p>
</dd>
<dt>output</dt><dd><p>total output.</p>
</dd>
<dt>labor</dt><dd><p>wage rate.</p>
</dd>
<dt>laborshare</dt><dd><p>cost share for labor.</p>
</dd>
<dt>capital</dt><dd><p>capital price index.</p>
</dd>
<dt>capitalshare</dt><dd><p>cost share for capital.</p>
</dd>
<dt>fuel</dt><dd><p>fuel price.</p>
</dd>
<dt>fuelshare</dt><dd><p>cost share for fuel.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data contains several extra observations that are aggregates
of commonly owned firms. Only the first 145 observations should be used for analysis.
</p>


<h3>Source</h3>

<p>Online complements to Greene (2003). Table F14.2.
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>
<p>Nerlove, M. (1963) &ldquo;Returns to Scale in Electricity Supply.&rdquo;
In C. Christ (ed.), <em>Measurement in Economics: Studies in Mathematical Economics
and Econometrics in Memory of Yehuda Grunfeld</em>. Stanford University Press, 1963.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code>, <code><a href="#topic+Electricity1970">Electricity1970</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Electricity1955")
Electricity &lt;- Electricity1955[1:145,]

## Greene (2003)
## Example 7.3
## Cobb-Douglas cost function
fm_all &lt;- lm(log(cost/fuel) ~ log(output) + log(labor/fuel) + log(capital/fuel),
  data = Electricity)
summary(fm_all)

## hypothesis of constant returns to scale
linearHypothesis(fm_all, "log(output) = 1")

## Table 7.4
## log quadratic cost function
fm_all2 &lt;- lm(log(cost/fuel) ~ log(output) + I(log(output)^2) + log(labor/fuel) + log(capital/fuel),
  data = Electricity)
summary(fm_all2)

## More examples can be found in:
## help("Greene2003")
</code></pre>

<hr>
<h2 id='Electricity1970'>Cost Function of Electricity Producers 1970</h2><span id='topic+Electricity1970'></span>

<h3>Description</h3>

<p>Cross-section data, at the firm level, on electric power generation.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Electricity1970")</code></pre>


<h3>Format</h3>

<p>A data frame containing 158 cross-section observations on 9 variables.
</p>

<dl>
<dt>cost</dt><dd><p>total cost.</p>
</dd>
<dt>output</dt><dd><p>total output.</p>
</dd>
<dt>labor</dt><dd><p>wage rate.</p>
</dd>
<dt>laborshare</dt><dd><p>cost share for labor.</p>
</dd>
<dt>capital</dt><dd><p>capital price index.</p>
</dd>
<dt>capitalshare</dt><dd><p>cost share for capital.</p>
</dd>
<dt>fuel</dt><dd><p>fuel price.</p>
</dd>
<dt>fuelshare</dt><dd><p>cost share for fuel.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data are from Christensen and Greene (1976) and pertain to the year 1970. 
However, the file contains some extra observations, the holding companies. 
Only the first 123 observations are needed to replicate Christensen and Greene (1976).
</p>


<h3>Source</h3>

<p>Online complements to Greene (2003), Table F5.2.
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Christensen, L. and Greene, W.H. (1976). Economies of Scale in U.S. Electric Power Generation.
<em>Journal of Political Economy</em>, <b>84</b>, 655&ndash;676.
</p>
<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code>, <code><a href="#topic+Electricity1955">Electricity1955</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Electricity1970")

## Greene (2003), Ex. 5.6: a generalized Cobb-Douglas cost function
fm &lt;- lm(log(cost/fuel) ~ log(output) + I(log(output)^2/2) + 
  log(capital/fuel) + log(labor/fuel), data=Electricity1970[1:123,])

</code></pre>

<hr>
<h2 id='EquationCitations'>Number of Equations and Citations for Evolutionary Biology Publications</h2><span id='topic+EquationCitations'></span>

<h3>Description</h3>

<p>Analysis of citations of evolutionary biology papers published in 1998 in the
top three journals (as judged by their 5-year impact factors in
the Thomson Reuters Journal Citation Reports 2010).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("EquationCitations")</code></pre>


<h3>Format</h3>

<p>A data frame containing 649 observations on 13 variables.
</p>

<dl>
<dt>journal</dt><dd><p>Factor. Journal in which the paper was published
(The American Naturalist, Evolution, Proceedings of the Royal Society
of London B: Biological Sciences).</p>
</dd>
<dt>authors</dt><dd><p>Character. Names of authors.</p>
</dd>
<dt>volume</dt><dd><p>Volume in which the paper was published.</p>
</dd>
<dt>startpage</dt><dd><p>Starting page of publication.</p>
</dd>
<dt>pages</dt><dd><p>Number of pages.</p>
</dd>
<dt>equations</dt><dd><p>Number of equations in total.</p>
</dd>
<dt>mainequations</dt><dd><p>Number of equations in main text.</p>
</dd>
<dt>appequations</dt><dd><p>Number of equations in appendix.</p>
</dd>
<dt>cites</dt><dd><p>Number of citations in total.</p>
</dd>
<dt>selfcites</dt><dd><p>Number of citations by the authors themselves.</p>
</dd>
<dt>othercites</dt><dd><p>Number of citations by other authors.</p>
</dd>
<dt>theocites</dt><dd><p>Number of citations by theoretical papers.</p>
</dd>
<dt>nontheocites</dt><dd><p>Number of citations by nontheoretical papers.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Fawcett and Higginson (2012) investigate the relationship between the
number of citations evolutionary biology papers receive, depending on the number
of equations per page in the cited paper. Overall it can be shown
that papers with many mathematical equations significantly lower
the number of citations they receive, in particular from
nontheoretical papers.
</p>


<h3>Source</h3>

<p>Online supplements to Fawcett and Higginson (2012).
</p>
<p><a href="https://www.pnas.org/doi/suppl/10.1073/pnas.1205259109/suppl_file/sd01.xlsx">https://www.pnas.org/doi/suppl/10.1073/pnas.1205259109/suppl_file/sd01.xlsx</a>
</p>


<h3>References</h3>

<p>Fawcett, T.W. and Higginson, A.D. (2012). Heavy Use of Equations Impedes
Communication among Biologists.
<em>PNAS &ndash; Proceedings of the National Academy of Sciences of the United States of America</em>,
<b>109</b>, 11735&ndash;11739. <a href="https://doi.org/10.1073/pnas.1205259109">doi:10.1073/pnas.1205259109</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PhDPublications">PhDPublications</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## load data and MASS package
data("EquationCitations", package = "AER")
library("MASS")

## convenience function for summarizing NB models
nbtable &lt;- function(obj, digits = 3) round(cbind(
  "OR" = exp(coef(obj)),
  "CI" = exp(confint.default(obj)),
  "Wald z" = coeftest(obj)[,3],
  "p" = coeftest(obj)[, 4]), digits = digits)


#################
## Replication ##
#################

## Table 1
m1a &lt;- glm.nb(othercites ~ I(equations/pages) * pages + journal,
  data = EquationCitations)
m1b &lt;- update(m1a, nontheocites ~ .)
m1c &lt;- update(m1a, theocites ~ .)
nbtable(m1a)
nbtable(m1b)
nbtable(m1c)

## Table 2
m2a &lt;- glm.nb(
  othercites ~ (I(mainequations/pages) + I(appequations/pages)) * pages + journal,
  data = EquationCitations)
m2b &lt;- update(m2a, nontheocites ~ .)
m2c &lt;- update(m2a, theocites ~ .)
nbtable(m2a)
nbtable(m2b)
nbtable(m2c)


###############
## Extension ##
###############

## nonlinear page effect: use log(pages) instead of pages+interaction
m3a &lt;- glm.nb(othercites ~ I(equations/pages) + log(pages) + journal,
  data = EquationCitations)
m3b &lt;- update(m3a, nontheocites ~ .)
m3c &lt;- update(m3a, theocites ~ .)

## nested models: allow different equation effects over journals
m4a &lt;- glm.nb(othercites ~ journal / I(equations/pages) + log(pages),
  data = EquationCitations)
m4b &lt;- update(m4a, nontheocites ~ .)
m4c &lt;- update(m4a, theocites ~ .)

## nested model best (wrt AIC) for all responses
AIC(m1a, m2a, m3a, m4a)
nbtable(m4a)
AIC(m1b, m2b, m3b, m4b)
nbtable(m4b)
AIC(m1c, m2c, m3c, m4c)
nbtable(m4c)
## equation effect by journal/response
##           comb nontheo theo
## AmNat     =/-  -       +
## Evolution =/+  =       +
## ProcB     -    -       =/+
</code></pre>

<hr>
<h2 id='Equipment'>Transportation Equipment Manufacturing Data</h2><span id='topic+Equipment'></span>

<h3>Description</h3>

<p>Statewide data on transportation equipment manufacturing for 25 US states.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Equipment")</code></pre>


<h3>Format</h3>

<p>A data frame containing 25 observations on 4 variables.
</p>

<dl>
<dt>valueadded</dt><dd><p>Aggregate output, in millions of 1957 dollars.</p>
</dd>
<dt>capital</dt><dd><p>Capital input, in millions of 1957 dollars.</p>
</dd>
<dt>labor</dt><dd><p>Aggregate labor input, in millions of man hours.</p>
</dd>
<dt>firms</dt><dd><p>Number of firms.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Journal of Applied Econometrics Data Archive. 
</p>
<p><a href="http://qed.econ.queensu.ca/jae/1998-v13.2/zellner-ryu/">http://qed.econ.queensu.ca/jae/1998-v13.2/zellner-ryu/</a>
</p>
<p>Online complements to Greene (2003), Table F9.2.
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>
<p>Zellner, A. and Revankar, N. (1969). Generalized Production Functions. 
<em>Review of Economic Studies</em>, <b>36</b>, 241&ndash;250.
</p>
<p>Zellner, A. and Ryu, H. (1998). Alternative Functional Forms for Production, 
Cost and Returns to Scale Functions. 
<em>Journal of Applied Econometrics</em>, <b>13</b>, 101&ndash;127.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Greene (2003), Example 17.5
data("Equipment")

## Cobb-Douglas
fm_cd &lt;- lm(log(valueadded/firms) ~ log(capital/firms) + log(labor/firms), data = Equipment)

## generalized Cobb-Douglas with Zellner-Revankar trafo
GCobbDouglas &lt;- function(theta)
 lm(I(log(valueadded/firms) + theta * valueadded/firms) ~ log(capital/firms) + log(labor/firms), 
     data = Equipment)

## yields classical Cobb-Douglas for theta = 0
fm_cd0 &lt;- GCobbDouglas(0)

## ML estimation of generalized model
## choose starting values from classical model
par0 &lt;- as.vector(c(coef(fm_cd0), 0, mean(residuals(fm_cd0)^2)))

## set up likelihood function
nlogL &lt;- function(par) {
  beta &lt;- par[1:3]
  theta &lt;- par[4]
  sigma2 &lt;- par[5]

  Y &lt;- with(Equipment, valueadded/firms)
  K &lt;- with(Equipment, capital/firms)
  L &lt;- with(Equipment, labor/firms)

  rhs &lt;- beta[1] + beta[2] * log(K) + beta[3] * log(L)
  lhs &lt;- log(Y) + theta * Y

  rval &lt;- sum(log(1 + theta * Y) - log(Y) +
    dnorm(lhs, mean = rhs, sd = sqrt(sigma2), log = TRUE))
  return(-rval)
}

## optimization
opt &lt;- optim(par0, nlogL, hessian = TRUE)

## Table 17.2
opt$par
sqrt(diag(solve(opt$hessian)))[1:4]
-opt$value

## re-fit ML model
fm_ml &lt;- GCobbDouglas(opt$par[4])
deviance(fm_ml)
sqrt(diag(vcov(fm_ml)))

## fit NLS model
rss &lt;- function(theta) deviance(GCobbDouglas(theta))
optim(0, rss)
opt2 &lt;- optimize(rss, c(-1, 1))
fm_nls &lt;- GCobbDouglas(opt2$minimum)
-nlogL(c(coef(fm_nls), opt2$minimum, mean(residuals(fm_nls)^2)))
</code></pre>

<hr>
<h2 id='EuroEnergy'>European Energy Consumption Data</h2><span id='topic+EuroEnergy'></span>

<h3>Description</h3>

<p>Cross-section data on energy consumption for 20 European countries, for the year 1980. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("EuroEnergy")</code></pre>


<h3>Format</h3>

<p>A data frame containing 20 observations on 2 variables. 
</p>

<dl>
<dt>gdp</dt><dd><p>Real gross domestic product for the year 1980 (in million 1975 US dollars).</p>
</dd>
<dt>energy</dt><dd><p>Aggregate energy consumption (in million kilograms coal equivalence).</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data are from Baltagi (2002).
</p>


<h3>References</h3>

<p>Baltagi, B.H. (2002). <em>Econometrics</em>, 3rd ed. Berlin, Springer. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Baltagi2002">Baltagi2002</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("EuroEnergy")
energy_lm &lt;- lm(log(energy) ~ log(gdp), data = EuroEnergy)
influence.measures(energy_lm)
</code></pre>

<hr>
<h2 id='Fatalities'>US Traffic Fatalities</h2><span id='topic+Fatalities'></span>

<h3>Description</h3>

<p>US traffic fatalities panel data for the &ldquo;lower 48&rdquo; US states 
(i.e., excluding Alaska and Hawaii), annually for 1982 through 1988.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Fatalities")</code></pre>


<h3>Format</h3>

<p>A data frame containing 336 observations on 34 variables.
</p>

<dl>
<dt>state</dt><dd><p>factor indicating state.</p>
</dd>
<dt>year</dt><dd><p>factor indicating year.</p>
</dd>
<dt>spirits</dt><dd><p>numeric. Spirits consumption.</p>
</dd>
<dt>unemp</dt><dd><p>numeric. Unemployment rate.</p>
</dd>
<dt>income</dt><dd><p>numeric. Per capita personal income in 1987 dollars.</p>
</dd>  
<dt>emppop</dt><dd><p>numeric. Employment/population ratio.</p>
</dd>
<dt>beertax</dt><dd><p>numeric. Tax on case of beer.</p>
</dd>
<dt>baptist</dt><dd><p>numeric. Percent of southern baptist.</p>
</dd>
<dt>mormon</dt><dd><p>numeric. Percent of mormon.</p>
</dd>
<dt>drinkage</dt><dd><p>numeric. Minimum legal drinking age.</p>
</dd>   
<dt>dry</dt><dd><p>numeric. Percent residing in &ldquo;dry&rdquo; countries.</p>
</dd>
<dt>youngdrivers</dt><dd><p>numeric. Percent of drivers aged 15&ndash;24.</p>
</dd>
<dt>miles</dt><dd><p>numeric. Average miles per driver.</p>
</dd>
<dt>breath</dt><dd><p>factor. Preliminary breath test law?</p>
</dd>
<dt>jail</dt><dd><p>factor. Mandatory jail sentence?</p>
</dd>
<dt>service</dt><dd><p>factor. Mandatory community service?</p>
</dd>
<dt>fatal</dt><dd><p>numeric. Number of vehicle fatalities.</p>
</dd>
<dt>nfatal</dt><dd><p>numeric. Number of night-time vehicle fatalities.</p>
</dd>  
<dt>sfatal</dt><dd><p>numeric. Number of single vehicle fatalities.</p>
</dd>    
<dt>fatal1517</dt><dd><p>numeric. Number of vehicle fatalities, 15&ndash;17 year olds.</p>
</dd>    
<dt>nfatal1517</dt><dd><p>numeric. Number of night-time vehicle fatalities, 15&ndash;17 year olds.</p>
</dd>  
<dt>fatal1820</dt><dd><p>numeric. Number of vehicle fatalities, 18&ndash;20 year olds.</p>
</dd>    
<dt>nfatal1820</dt><dd><p>numeric. Number of night-time vehicle fatalities, 18&ndash;20 year olds.</p>
</dd>  
<dt>fatal2124</dt><dd><p>numeric. Number of vehicle fatalities, 21&ndash;24 year olds.</p>
</dd>    
<dt>nfatal2124</dt><dd><p>numeric. Number of night-time vehicle fatalities, 21&ndash;24 year olds.</p>
</dd>  
<dt>afatal</dt><dd><p>numeric. Number of alcohol-involved vehicle fatalities.</p>
</dd>    
<dt>pop</dt><dd><p>numeric. Population.</p>
</dd>  
<dt>pop1517</dt><dd><p>numeric. Population, 15&ndash;17 year olds.</p>
</dd>  
<dt>pop1820</dt><dd><p>numeric. Population, 18&ndash;20 year olds.</p>
</dd>    
<dt>pop2124</dt><dd><p>numeric. Population, 21&ndash;24 year olds.</p>
</dd>      
<dt>milestot</dt><dd><p>numeric. Total vehicle miles (millions).</p>
</dd>      
<dt>unempus</dt><dd><p>numeric. US unemployment rate.</p>
</dd>        
<dt>emppopus</dt><dd><p>numeric. US employment/population ratio.</p>
</dd>          
<dt>gsp</dt><dd><p>numeric. GSP rate of change.</p>
</dd>          
</dl>



<h3>Details</h3>

<p>Traffic fatalities are from the US Department of 
Transportation Fatal Accident Reporting System.  The beer tax is the 
tax on a case of beer, which is an available measure of state 
alcohol taxes more generally. The drinking age variable is a factor 
indicating whether the legal drinking age is 18, 19, or 20.  
The two binary punishment variables  describe the state's minimum 
sentencing requirements for an initial drunk driving conviction. 
</p>
<p>Total vehicle miles traveled annually by state was obtained from 
the Department of Transportation. Personal income was obtained 
from the US Bureau of Economic Analysis, and the unemployment 
rate was obtained from the US Bureau of Labor Statistics.
</p>


<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Ruhm, C. J. (1996). Alcohol Policies and Highway Vehicle Fatalities. 
<em>Journal of Health Economics</em>, <b>15</b>, 435&ndash;454.
</p>
<p>Stock, J. H. and Watson, M. W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## data from Stock and Watson (2007)
data("Fatalities", package = "AER")
## add fatality rate (number of traffic deaths
## per 10,000 people living in that state in that year)
Fatalities$frate &lt;- with(Fatalities, fatal/pop * 10000)
## add discretized version of minimum legal drinking age
Fatalities$drinkagec &lt;- cut(Fatalities$drinkage,
  breaks = 18:22, include.lowest = TRUE, right = FALSE)
Fatalities$drinkagec &lt;- relevel(Fatalities$drinkagec, ref = 4)
## any punishment?
Fatalities$punish &lt;- with(Fatalities,
  factor(jail == "yes" | service == "yes", labels = c("no", "yes")))
## plm package
library("plm")

## for comparability with Stata we use HC1 below
## p. 351, Eq. (10.2)
f1982 &lt;- subset(Fatalities, year == "1982")
fm_1982 &lt;- lm(frate ~ beertax, data = f1982)
coeftest(fm_1982, vcov = vcovHC(fm_1982, type = "HC1"))

## p. 353, Eq. (10.3)
f1988 &lt;- subset(Fatalities, year == "1988")
fm_1988 &lt;- lm(frate ~ beertax, data = f1988)
coeftest(fm_1988, vcov = vcovHC(fm_1988, type = "HC1"))

## pp. 355, Eq. (10.8)
fm_diff &lt;- lm(I(f1988$frate - f1982$frate) ~ I(f1988$beertax - f1982$beertax))
coeftest(fm_diff, vcov = vcovHC(fm_diff, type = "HC1"))

## pp. 360, Eq. (10.15)
##   (1) via formula
fm_sfe &lt;- lm(frate ~ beertax + state - 1, data = Fatalities)
##   (2) by hand
fat &lt;- with(Fatalities,
  data.frame(frates = frate - ave(frate, state),
  beertaxs = beertax - ave(beertax, state)))
fm_sfe2 &lt;- lm(frates ~ beertaxs - 1, data = fat)
##   (3) via plm()
fm_sfe3 &lt;- plm(frate ~ beertax, data = Fatalities,
  index = c("state", "year"), model = "within")

coeftest(fm_sfe, vcov = vcovHC(fm_sfe, type = "HC1"))[1,]
## uses different df in sd and p-value
coeftest(fm_sfe2, vcov = vcovHC(fm_sfe2, type = "HC1"))[1,]
## uses different df in p-value
coeftest(fm_sfe3, vcov = vcovHC(fm_sfe3, type = "HC1", method = "white1"))[1,]


## pp. 363, Eq. (10.21)
## via lm()
fm_stfe &lt;- lm(frate ~ beertax + state + year - 1, data = Fatalities)
coeftest(fm_stfe, vcov = vcovHC(fm_stfe, type = "HC1"))[1,]
## via plm()
fm_stfe2 &lt;- plm(frate ~ beertax, data = Fatalities,
  index = c("state", "year"), model = "within", effect = "twoways")
coeftest(fm_stfe2, vcov = vcovHC) ## different


## p. 368, Table 10.1, numbers refer to cols.
fm1 &lt;- plm(frate ~ beertax, data = Fatalities, index = c("state", "year"), model = "pooling")
fm2 &lt;- plm(frate ~ beertax, data = Fatalities, index = c("state", "year"), model = "within")
fm3 &lt;- plm(frate ~ beertax, data = Fatalities, index = c("state", "year"), model = "within",
  effect = "twoways")
fm4 &lt;- plm(frate ~ beertax + drinkagec + jail + service + miles + unemp + log(income),
  data = Fatalities, index = c("state", "year"), model = "within", effect = "twoways")
fm5 &lt;- plm(frate ~ beertax + drinkagec + jail + service + miles,
  data = Fatalities, index = c("state", "year"), model = "within", effect = "twoways")
fm6 &lt;- plm(frate ~ beertax + drinkage + punish + miles + unemp + log(income),
  data = Fatalities, index = c("state", "year"), model = "within", effect = "twoways")
fm7 &lt;- plm(frate ~ beertax + drinkagec + jail + service + miles + unemp + log(income),
  data = Fatalities, index = c("state", "year"), model = "within", effect = "twoways")
## summaries not too close, s.e.s generally too small
coeftest(fm1, vcov = vcovHC)
coeftest(fm2, vcov = vcovHC)
coeftest(fm3, vcov = vcovHC)
coeftest(fm4, vcov = vcovHC)
coeftest(fm5, vcov = vcovHC)
coeftest(fm6, vcov = vcovHC)
coeftest(fm7, vcov = vcovHC)

## TODO: Testing exclusion restrictions

</code></pre>

<hr>
<h2 id='Fertility'>Fertility and Women's Labor Supply</h2><span id='topic+Fertility'></span><span id='topic+Fertility2'></span>

<h3>Description</h3>

<p>Cross-section data from the 1980 US Census on married women
aged 21&ndash;35 with two or more children.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Fertility")
data("Fertility2")
</code></pre>


<h3>Format</h3>

<p>A data frame containing 254,654 (and 30,000, respectively) observations on 8 variables.
</p>

<dl>
<dt>morekids</dt><dd><p>factor. Does the mother have more than 2 children?</p>
</dd>
<dt>gender1</dt><dd><p>factor indicating gender of first child.</p>
</dd>
<dt>gender2</dt><dd><p>factor indicating gender of second child.</p>
</dd>
<dt>age</dt><dd><p>age of mother at census.</p>
</dd>
<dt>afam</dt><dd><p>factor. Is the mother African-American?</p>
</dd>  
<dt>hispanic</dt><dd><p>factor. Is the mother Hispanic?</p>
</dd> 
<dt>other</dt><dd><p>factor. Is the mother's ethnicity neither African-American nor
Hispanic, nor Caucasian? (see below)</p>
</dd>
<dt>work</dt><dd><p>number of weeks in which the mother worked in 1979.</p>
</dd>
</dl>



<h3>Details</h3>

<p><code>Fertility2</code> is a random subset of <code>Fertility</code> with 30,000 observations.
</p>
<p>There are conflicts in the ethnicity coding (see also examples). Hence, it was
not possible to create a single factor and the original three indicator
variables have been retained.
</p>
<p>Not all variables from Angrist and Evans (1998) have been included.
</p>


<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Angrist, J.D., and Evans, W.N. (1998). Children and Their Parents' Labor Supply: Evidence from Exogenous Variation in Family Size
<em>American Economic Review</em>, <b>88</b>, 450&ndash;477.
</p>
<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Fertility2")

## conflicts in ethnicity coding
ftable(xtabs(~ afam + hispanic + other, data = Fertility2))

## create convenience variables
Fertility2$mkids &lt;- with(Fertility2, as.numeric(morekids) - 1)
Fertility2$samegender &lt;- with(Fertility2, factor(gender1 == gender2))
Fertility2$twoboys &lt;- with(Fertility2, factor(gender1 == "male" &amp; gender2 == "male"))
Fertility2$twogirls &lt;- with(Fertility2, factor(gender1 == "female" &amp; gender2 == "female"))

## similar to Angrist and Evans, p. 462
fm1 &lt;- lm(mkids ~ samegender, data = Fertility2)
summary(fm1)

fm2 &lt;- lm(mkids ~ gender1 + gender2 + samegender + age + afam + hispanic + other, data = Fertility2)
summary(fm2)

fm3 &lt;- lm(mkids ~ gender1 + twoboys + twogirls + age + afam + hispanic + other, data = Fertility2)
summary(fm3)
</code></pre>

<hr>
<h2 id='Franses1998'>Data and Examples from Franses (1998)</h2><span id='topic+Franses1998'></span>

<h3>Description</h3>

<p>This manual page collects a list of examples from the book. Some 
solutions might not be exact and the list is certainly not complete.
If you have suggestions for improvement (preferably in the form of code),
please contact the package maintainer.
</p>


<h3>References</h3>

<p>Franses, P.H. (1998). <em>Time Series Models for Business and Economic Forecasting</em>.
Cambridge, UK: Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ArgentinaCPI">ArgentinaCPI</a></code>, <code><a href="#topic+ChinaIncome">ChinaIncome</a></code>, <code><a href="#topic+ConsumerGood">ConsumerGood</a></code>,
<code><a href="#topic+DJFranses">DJFranses</a></code>, <code><a href="#topic+DutchAdvert">DutchAdvert</a></code>, <code><a href="#topic+DutchSales">DutchSales</a></code>,
<code><a href="#topic+GermanUnemployment">GermanUnemployment</a></code>, <code><a href="#topic+MotorCycles">MotorCycles</a></code>, <code><a href="#topic+OlympicTV">OlympicTV</a></code>,
<code><a href="#topic+PepperPrice">PepperPrice</a></code>, <code><a href="#topic+UKNonDurables">UKNonDurables</a></code>, <code><a href="#topic+USProdIndex">USProdIndex</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>###########################
## Convenience functions ##
###########################

## EACF tables (Franses 1998, p. 99)
ctrafo &lt;- function(x) residuals(lm(x ~ factor(cycle(x))))
ddiff &lt;- function(x) diff(diff(x, frequency(x)), 1)
eacf &lt;- function(y, lag = 12) {
  stopifnot(all(lag &gt; 0))
  if(length(lag) &lt; 2) lag &lt;- 1:lag
  rval &lt;- sapply(
    list(y = y, dy = diff(y), cdy = ctrafo(diff(y)),
         Dy = diff(y, frequency(y)), dDy = ddiff(y)),
    function(x) acf(x, plot = FALSE, lag.max = max(lag))$acf[lag + 1])
  rownames(rval) &lt;- lag
  return(rval)
}

#######################################
## Index of US industrial production ##
#######################################

data("USProdIndex", package = "AER")
plot(USProdIndex, plot.type = "single", col = 1:2)

## Franses (1998), Table 5.1
round(eacf(log(USProdIndex[,1])), digits = 3)

## Franses (1998), Equation 5.6: Unrestricted airline model
## (Franses: ma1 = 0.388 (0.063), ma4 = -0.739 (0.060), ma5 = -0.452 (0.069))
arima(log(USProdIndex[,1]), c(0, 1, 5), c(0, 1, 0), fixed = c(NA, 0, 0, NA, NA))

###########################################
## Consumption of non-durables in the UK ##
###########################################

data("UKNonDurables", package = "AER")
plot(UKNonDurables)

## Franses (1998), Table 5.2
round(eacf(log(UKNonDurables)), digits = 3)

## Franses (1998), Equation 5.51
## (Franses: sma1 = -0.632 (0.069))
arima(log(UKNonDurables), c(0, 1, 0), c(0, 1, 1))

##############################
## Dutch retail sales index ##
##############################

data("DutchSales", package = "AER")
plot(DutchSales)

## Franses (1998), Table 5.3
round(eacf(log(DutchSales), lag = c(1:18, 24, 36)), digits = 3)

###########################################
## TV and radio advertising expenditures ##
###########################################

data("DutchAdvert", package = "AER")
plot(DutchAdvert)

## Franses (1998), Table 5.4
round(eacf(log(DutchAdvert[,"tv"]), lag = c(1:19, 26, 39)), digits = 3)
</code></pre>

<hr>
<h2 id='FrozenJuice'>Price of Frozen Orange Juice</h2><span id='topic+FrozenJuice'></span>

<h3>Description</h3>

<p>Monthly data on the price of frozen orange juice concentrate and temperature
in the orange-growing region of Florida.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("FrozenJuice")</code></pre>


<h3>Format</h3>

<p>A monthly multiple time series from 1950(1) to 2000(12) with 3 variables.
</p>

<dl>
<dt>price</dt><dd><p>Average producer price for frozen orange juice.</p>
</dd>
<dt>ppi</dt><dd><p>Producer price index for finished goods. Used to deflate the
overall producer price index for finished goods to eliminate the 
effects of overall price inflation.</p>
</dd>
<dt>fdd</dt><dd><p>Number of freezing degree days at the Orlando, Florida, airport.
Calculated as the sum of the number of degrees Fahrenheit that the 
minimum temperature falls below freezing (32 degrees Fahrenheit = about 0 degrees Celsius)
in a given day over all days in the month: <code>fdd</code> = sum(max(0, 32 - minimum daily temperature)),
e.g. for February <code>fdd</code> is the number of freezing degree days from January 11
to February 10.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The orange juice price data are the frozen orange juice component of processed foods and
feeds group of the Producer Price Index (PPI), collected by the US Bureau of Labor
Statistics (BLS series wpu02420301). The orange juice price series was divided by the
overall PPI for finished goods to adjust for general price inflation. The freezing degree
days series was constructed from daily minimum temperatures recorded at Orlando area
airports, obtained from the National Oceanic and Atmospheric Administration (NOAA)
of the US Department of Commerce.
</p>


<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## load data
data("FrozenJuice")

## Stock and Watson, p. 594
library("dynlm")
fm_dyn &lt;- dynlm(d(100 * log(price/ppi)) ~ fdd, data = FrozenJuice)
coeftest(fm_dyn, vcov = vcovHC(fm_dyn, type = "HC1"))

## equivalently, returns can be computed 'by hand'
## (reducing the complexity of the formula notation)
fj &lt;- ts.union(fdd = FrozenJuice[, "fdd"],
  ret = 100 * diff(log(FrozenJuice[,"price"]/FrozenJuice[,"ppi"])))
fm_dyn &lt;- dynlm(ret ~ fdd, data = fj)

## Stock and Watson, p. 595
fm_dl &lt;- dynlm(ret ~ L(fdd, 0:6), data = fj)
coeftest(fm_dl, vcov = vcovHC(fm_dl, type = "HC1"))

## Stock and Watson, Table 15.1, p. 620, numbers refer to columns
## (1) Dynamic Multipliers 
fm1 &lt;- dynlm(ret ~ L(fdd, 0:18), data = fj)
coeftest(fm1, vcov = NeweyWest(fm1, lag = 7, prewhite =  FALSE))
## (2) Cumulative Multipliers
fm2 &lt;- dynlm(ret ~ L(d(fdd), 0:17) + L(fdd, 18), data = fj)
coeftest(fm2, vcov = NeweyWest(fm2, lag = 7, prewhite =  FALSE))
## (3) Cumulative Multipliers, more lags in NW
coeftest(fm2, vcov = NeweyWest(fm2, lag = 14, prewhite =  FALSE))
## (4) Cumulative Multipliers with monthly indicators
fm4 &lt;- dynlm(ret ~ L(d(fdd), 0:17) + L(fdd, 18) + season(fdd), data = fj)
coeftest(fm4, vcov = NeweyWest(fm4, lag = 7, prewhite =  FALSE))
## monthly indicators needed?
fm4r &lt;- update(fm4, . ~ . - season(fdd))
waldtest(fm4, fm4r, vcov= NeweyWest(fm4, lag = 7, prewhite = FALSE)) ## close ...
</code></pre>

<hr>
<h2 id='GermanUnemployment'>Unemployment in Germany Data</h2><span id='topic+GermanUnemployment'></span>

<h3>Description</h3>

<p>Time series of unemployment rate (in percent) in Germany.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("GermanUnemployment")</code></pre>


<h3>Format</h3>

<p>A quarterly multiple time series from 1962(1) to 1991(4) with 2 variables.
</p>

<dl>
<dt>unadjusted</dt><dd><p>Raw unemployment rate,</p>
</dd>
<dt>adjusted</dt><dd><p>Seasonally adjusted rate.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Franses (1998).
</p>


<h3>References</h3>

<p>Franses, P.H. (1998). <em>Time Series Models for Business and Economic Forecasting</em>.
Cambridge, UK: Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Franses1998">Franses1998</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("GermanUnemployment")
plot(GermanUnemployment, plot.type = "single", col = 1:2)
</code></pre>

<hr>
<h2 id='GoldSilver'>Gold and Silver Prices</h2><span id='topic+GoldSilver'></span>

<h3>Description</h3>

<p>Time series of gold and silver prices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("GoldSilver")</code></pre>


<h3>Format</h3>

<p>A daily multiple time series from 1977-12-30 to 2012-12-31 (of class <code>"zoo"</code> with <code>"Date"</code> index).
</p>

<dl>
<dt>gold</dt><dd><p>spot price for gold,</p>
</dd>
<dt>silver</dt><dd><p>spot price for silver.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Franses, van Dijk and Opschoor (2014).
</p>
<p><a href="https://www.cambridge.org/us/academic/subjects/economics/econometrics-statistics-and-mathematical-economics/time-series-models-business-and-economic-forecasting-2nd-edition">https://www.cambridge.org/us/academic/subjects/economics/econometrics-statistics-and-mathematical-economics/time-series-models-business-and-economic-forecasting-2nd-edition</a>
</p>


<h3>References</h3>

<p>Franses, P.H., van Dijk, D. and Opschoor, A. (2014). <em>Time Series Models for Business and Economic Forecasting</em>, 2nd ed.
Cambridge, UK: Cambridge University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("GoldSilver", package = "AER")

## p.31, daily returns
lgs &lt;- log(GoldSilver)
plot(lgs[, c("silver", "gold")])

dlgs &lt;- 100 * diff(lgs) 
plot(dlgs[, c("silver", "gold")])

## p.31, monthly log prices
lgs7812 &lt;- window(lgs, start = as.Date("1978-01-01"))
lgs7812m &lt;- aggregate(lgs7812, as.Date(as.yearmon(time(lgs7812))), mean)
plot(lgs7812m, plot.type = "single", lty = 1:2, lwd = 2)

## p.93, empirical ACF of absolute daily gold returns, 1978-01-01 - 2012-12-31
absgret &lt;- abs(100 * diff(lgs7812[, "gold"]))
sacf &lt;- acf(absgret, lag.max = 200, na.action = na.exclude, plot = FALSE)
plot(1:201, sacf$acf, ylim = c(0.04, 0.28), type = "l", xaxs = "i", yaxs = "i", las = 1)


## ARFIMA(0,1,1) model, eq. (4.44)
library("longmemo")
WhittleEst(absgret, model = "fARIMA", p = 0, q = 1, start = list(H = 0.3, MA = .25))

library("forecast")
arfima(as.vector(absgret), max.p = 0, max.q = 1)


## p.254: VAR(2), monthly data for 1986.1 - 2012.12
library("vars")

lgs8612 &lt;- window(lgs, start = as.Date("1986-01-01"))
dim(lgs8612)

lgs8612m &lt;- aggregate(lgs8612, as.Date(as.yearmon(time(lgs8612))), mean)
plot(lgs8612m)
dim(lgs8612m)

VARselect(lgs8612m, 5)
gs2 &lt;- VAR(lgs8612m, 2)

summary(gs2)
summary(gs2)$covres

## ACF of residuals, p.256
acf(resid(gs2), 2, plot = FALSE)


## Figure 9.1, p.260 (somewhat different)
plot(irf(gs2, impulse = "gold", n.ahead = 50), ylim = c(-0.02, 0.1))
plot(irf(gs2, impulse = "silver", n.ahead = 50), ylim = c(-0.02, 0.1))


## Table 9.2, p.261
fevd(gs2)

## p.266
ls &lt;- lgs8612[, "silver"]
lg &lt;- lgs8612[, "gold"]

gsreg &lt;- lm(lg ~ ls)
summary(gsreg)
sgreg &lt;- lm(ls ~ lg)
summary(sgreg)

library("tseries")
adf.test(resid(gsreg), k = 0)
adf.test(resid(sgreg), k = 0)

</code></pre>

<hr>
<h2 id='Greene2003'>Data and Examples from Greene (2003)</h2><span id='topic+Greene2003'></span>

<h3>Description</h3>

<p>This manual page collects a list of examples from the book. Some 
solutions might not be exact and the list is certainly not complete.
If you have suggestions for improvement (preferably in the form of code),
please contact the package maintainer.
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
URL <a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Affairs">Affairs</a></code>, <code><a href="#topic+BondYield">BondYield</a></code>, <code><a href="#topic+CreditCard">CreditCard</a></code>,
<code><a href="#topic+Electricity1955">Electricity1955</a></code>, <code><a href="#topic+Electricity1970">Electricity1970</a></code>, <code><a href="#topic+Equipment">Equipment</a></code>,
<code><a href="#topic+Grunfeld">Grunfeld</a></code>, <code><a href="#topic+KleinI">KleinI</a></code>, <code><a href="#topic+Longley">Longley</a></code>,
<code><a href="#topic+ManufactCosts">ManufactCosts</a></code>, <code><a href="#topic+MarkPound">MarkPound</a></code>, <code><a href="#topic+Municipalities">Municipalities</a></code>,
<code><a href="#topic+ProgramEffectiveness">ProgramEffectiveness</a></code>, <code><a href="#topic+PSID1976">PSID1976</a></code>, <code><a href="#topic+SIC33">SIC33</a></code>,
<code><a href="#topic+ShipAccidents">ShipAccidents</a></code>, <code><a href="#topic+StrikeDuration">StrikeDuration</a></code>, <code><a href="#topic+TechChange">TechChange</a></code>,
<code><a href="#topic+TravelMode">TravelMode</a></code>, <code><a href="#topic+UKInflation">UKInflation</a></code>, <code><a href="#topic+USConsump1950">USConsump1950</a></code>,
<code><a href="#topic+USConsump1979">USConsump1979</a></code>, <code><a href="#topic+USGasG">USGasG</a></code>, <code><a href="#topic+USAirlines">USAirlines</a></code>,
<code><a href="#topic+USInvest">USInvest</a></code>, <code><a href="#topic+USMacroG">USMacroG</a></code>, <code><a href="#topic+USMoney">USMoney</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>

#####################################
## US consumption data (1970-1979) ##
#####################################

## Example 1.1
data("USConsump1979", package = "AER")
plot(expenditure ~ income, data = as.data.frame(USConsump1979), pch = 19)
fm &lt;- lm(expenditure ~ income, data = as.data.frame(USConsump1979))
summary(fm)
abline(fm)


#####################################
## US consumption data (1940-1950) ##
#####################################

## data
data("USConsump1950", package = "AER")
usc &lt;- as.data.frame(USConsump1950)
usc$war &lt;- factor(usc$war, labels = c("no", "yes"))

## Example 2.1
plot(expenditure ~ income, data = usc, type = "n", xlim = c(225, 375), ylim = c(225, 350))
with(usc, text(income, expenditure, time(USConsump1950)))

## single model
fm &lt;- lm(expenditure ~ income, data = usc)
summary(fm)

## different intercepts for war yes/no
fm2 &lt;- lm(expenditure ~ income + war, data = usc)
summary(fm2)

## compare
anova(fm, fm2)

## visualize
abline(fm, lty = 3)                                   
abline(coef(fm2)[1:2])                                
abline(sum(coef(fm2)[c(1, 3)]), coef(fm2)[2], lty = 2)

## Example 3.2
summary(fm)$r.squared
summary(lm(expenditure ~ income, data = usc, subset = war == "no"))$r.squared
summary(fm2)$r.squared


########################
## US investment data ##
########################

data("USInvest", package = "AER")

## Chapter 3 in Greene (2003)
## transform (and round) data to match Table 3.1
us &lt;- as.data.frame(USInvest)
us$invest &lt;- round(0.1 * us$invest/us$price, digits = 3)
us$gnp &lt;- round(0.1 * us$gnp/us$price, digits = 3)
us$inflation &lt;- c(4.4, round(100 * diff(us$price)/us$price[-15], digits = 2))
us$trend &lt;- 1:15
us &lt;- us[, c(2, 6, 1, 4, 5)]

## p. 22-24
coef(lm(invest ~ trend + gnp, data = us))
coef(lm(invest ~ gnp, data = us))

## Example 3.1, Table 3.2
cor(us)[1,-1]
pcor &lt;- solve(cor(us))
dcor &lt;- 1/sqrt(diag(pcor))
pcor &lt;- (-pcor * (dcor %o% dcor))[1,-1]

## Table 3.4
fm  &lt;- lm(invest ~ trend + gnp + interest + inflation, data = us)
fm1 &lt;- lm(invest ~ 1, data = us)
anova(fm1, fm)

## Example 4.1
set.seed(123)
w &lt;- rnorm(10000)
x &lt;- rnorm(10000)
eps &lt;- 0.5 * w
y &lt;- 0.5 + 0.5 * x + eps
b &lt;- rep(0, 500)
for(i in 1:500) {
  ix &lt;- sample(1:10000, 100)
  b[i] &lt;- lm.fit(cbind(1, x[ix]), y[ix])$coef[2]
}
hist(b, breaks = 20, col = "lightgray")


###############################
## Longley's regression data ##
###############################

## package and data
data("Longley", package = "AER")
library("dynlm")

## Example 4.6
fm1 &lt;- dynlm(employment ~ time(employment) + price + gnp + armedforces,
  data = Longley)
fm2 &lt;- update(fm1, end = 1961)
cbind(coef(fm2), coef(fm1))

## Figure 4.3
plot(rstandard(fm2), type = "b", ylim = c(-3, 3))
abline(h = c(-2, 2), lty = 2)


#########################################
## US gasoline market data (1960-1995) ##
#########################################

## data
data("USGasG", package = "AER")

## Greene (2003)
## Example 2.3
fm &lt;- lm(log(gas/population) ~ log(price) + log(income) + log(newcar) + log(usedcar),
  data = as.data.frame(USGasG))
summary(fm)

## Example 4.4
## estimates and standard errors (note different offset for intercept)
coef(fm)
sqrt(diag(vcov(fm)))
## confidence interval
confint(fm, parm = "log(income)")
## test linear hypothesis
linearHypothesis(fm, "log(income) = 1")

## Figure 7.5
plot(price ~ gas, data = as.data.frame(USGasG), pch = 19,
  col = (time(USGasG) &gt; 1973) + 1)
legend("topleft", legend = c("after 1973", "up to 1973"), pch = 19, col = 2:1, bty = "n")

## Example 7.6
## re-used in Example 8.3
## linear time trend
ltrend &lt;- 1:nrow(USGasG)
## shock factor
shock &lt;- factor(time(USGasG) &gt; 1973, levels = c(FALSE, TRUE), labels = c("before", "after"))

## 1960-1995
fm1 &lt;- lm(log(gas/population) ~ log(income) + log(price) + log(newcar) + log(usedcar) + ltrend,
  data = as.data.frame(USGasG))
summary(fm1)
## pooled
fm2 &lt;- lm(
  log(gas/population) ~ shock + log(income) + log(price) + log(newcar) + log(usedcar) + ltrend,
  data = as.data.frame(USGasG))
summary(fm2)
## segmented
fm3 &lt;- lm(
  log(gas/population) ~ shock/(log(income) + log(price) + log(newcar) + log(usedcar) + ltrend),
  data = as.data.frame(USGasG))
summary(fm3)

## Chow test
anova(fm3, fm1)
library("strucchange")
sctest(log(gas/population) ~ log(income) + log(price) + log(newcar) + log(usedcar) + ltrend,
  data = USGasG, point = c(1973, 1), type = "Chow")
## Recursive CUSUM test
rcus &lt;- efp(log(gas/population) ~ log(income) + log(price) + log(newcar) + log(usedcar) + ltrend,
   data = USGasG, type = "Rec-CUSUM")
plot(rcus)
sctest(rcus)
## Note: Greene's remark that the break is in 1984 (where the process crosses its boundary)
## is wrong. The break appears to be no later than 1976.

## Example 12.2
library("dynlm")
resplot &lt;- function(obj, bound = TRUE) {
  res &lt;- residuals(obj)
  sigma &lt;- summary(obj)$sigma
  plot(res, ylab = "Residuals", xlab = "Year")
  grid()
  abline(h = 0)
  if(bound) abline(h = c(-2, 2) * sigma, col = "red")  
  lines(res)
}
resplot(dynlm(log(gas/population) ~ log(price), data = USGasG))
resplot(dynlm(log(gas/population) ~ log(price) + log(income), data = USGasG))
resplot(dynlm(log(gas/population) ~ log(price) + log(income) + log(newcar) + log(usedcar) +
  log(transport) + log(nondurable) + log(durable) +log(service) + ltrend, data = USGasG))
## different shock variable than in 7.6
shock &lt;- factor(time(USGasG) &gt; 1974, levels = c(FALSE, TRUE), labels = c("before", "after"))
resplot(dynlm(log(gas/population) ~ shock/(log(price) + log(income) + log(newcar) + log(usedcar) +
  log(transport) + log(nondurable) + log(durable) + log(service) + ltrend), data = USGasG))
## NOTE: something seems to be wrong with the sigma estimates in the `full' models

## Table 12.4, OLS
fm &lt;- dynlm(log(gas/population) ~ log(price) + log(income) + log(newcar) + log(usedcar),
  data = USGasG)
summary(fm)
resplot(fm, bound = FALSE)
dwtest(fm)

## ML
g &lt;- as.data.frame(USGasG)
y &lt;- log(g$gas/g$population)
X &lt;- as.matrix(cbind(log(g$price), log(g$income), log(g$newcar), log(g$usedcar)))
arima(y, order = c(1, 0, 0), xreg = X)


#######################################
## US macroeconomic data (1950-2000) ##
#######################################
## data and trend
data("USMacroG", package = "AER")
ltrend &lt;- 0:(nrow(USMacroG) - 1)

## Example 5.3
## OLS and IV regression
library("dynlm")
fm_ols &lt;- dynlm(consumption ~ gdp, data = USMacroG)
fm_iv &lt;- dynlm(consumption ~ gdp | L(consumption) + L(gdp), data = USMacroG)

## Hausman statistic
library("MASS")
b_diff &lt;- coef(fm_iv) - coef(fm_ols)
v_diff &lt;- summary(fm_iv)$cov.unscaled - summary(fm_ols)$cov.unscaled
(t(b_diff) %*% ginv(v_diff) %*% b_diff) / summary(fm_ols)$sigma^2

## Wu statistic
auxreg &lt;- dynlm(gdp ~ L(consumption) + L(gdp), data = USMacroG)
coeftest(dynlm(consumption ~ gdp + fitted(auxreg), data = USMacroG))[3,3] 
## agrees with Greene (but not with errata)

## Example 6.1
## Table 6.1
fm6.1 &lt;- dynlm(log(invest) ~ tbill + inflation + log(gdp) + ltrend, data = USMacroG)
fm6.3 &lt;- dynlm(log(invest) ~ I(tbill - inflation) + log(gdp) + ltrend, data = USMacroG)
summary(fm6.1)
summary(fm6.3)
deviance(fm6.1)
deviance(fm6.3)
vcov(fm6.1)[2,3] 

## F test
linearHypothesis(fm6.1, "tbill + inflation = 0")
## alternatively
anova(fm6.1, fm6.3)
## t statistic
sqrt(anova(fm6.1, fm6.3)[2,5])
 
## Example 6.3
## Distributed lag model:
## log(Ct) = b0 + b1 * log(Yt) + b2 * log(C(t-1)) + u
us &lt;- log(USMacroG[, c(2, 5)])
fm_distlag &lt;- dynlm(log(consumption) ~ log(dpi) + L(log(consumption)),
  data = USMacroG)
summary(fm_distlag)

## estimate and test long-run MPC 
coef(fm_distlag)[2]/(1-coef(fm_distlag)[3])
linearHypothesis(fm_distlag, "log(dpi) + L(log(consumption)) = 1")
## correct, see errata
 
## Example 6.4
## predict investiment in 2001(1)
predict(fm6.1, interval = "prediction",
  newdata = data.frame(tbill = 4.48, inflation = 5.262, gdp = 9316.8, ltrend = 204))

## Example 7.7
## no GMM available in "strucchange"
## using OLS instead yields
fs &lt;- Fstats(log(m1/cpi) ~ log(gdp) + tbill, data = USMacroG,
  vcov = NeweyWest, from = c(1957, 3), to = c(1991, 3))
plot(fs)
## which looks somewhat similar ...
 
## Example 8.2
## Ct = b0 + b1*Yt + b2*Y(t-1) + v
fm1 &lt;- dynlm(consumption ~ dpi + L(dpi), data = USMacroG)
## Ct = a0 + a1*Yt + a2*C(t-1) + u
fm2 &lt;- dynlm(consumption ~ dpi + L(consumption), data = USMacroG)

## Cox test in both directions:
coxtest(fm1, fm2)
## ... and do the same for jtest() and encomptest().
## Notice that in this particular case two of them are coincident.
jtest(fm1, fm2)
encomptest(fm1, fm2)
## encomptest could also be performed `by hand' via
fmE &lt;- dynlm(consumption ~ dpi + L(dpi) + L(consumption), data = USMacroG)
waldtest(fm1, fmE, fm2)

## Table 9.1
fm_ols &lt;- lm(consumption ~ dpi, data = as.data.frame(USMacroG))
fm_nls &lt;- nls(consumption ~ alpha + beta * dpi^gamma,
  start = list(alpha = coef(fm_ols)[1], beta = coef(fm_ols)[2], gamma = 1),
  control = nls.control(maxiter = 100), data = as.data.frame(USMacroG))
summary(fm_ols)
summary(fm_nls)
deviance(fm_ols)
deviance(fm_nls)
vcov(fm_nls)

## Example 9.7
## F test
fm_nls2 &lt;- nls(consumption ~ alpha + beta * dpi,
  start = list(alpha = coef(fm_ols)[1], beta = coef(fm_ols)[2]),
  control = nls.control(maxiter = 100), data = as.data.frame(USMacroG))
anova(fm_nls, fm_nls2)
## Wald test
linearHypothesis(fm_nls, "gamma = 1")

## Example 9.8, Table 9.2
usm &lt;- USMacroG[, c("m1", "tbill", "gdp")]
fm_lin &lt;- lm(m1 ~ tbill + gdp, data = usm)
fm_log &lt;- lm(m1 ~ tbill + gdp, data = log(usm))
## PE auxiliary regressions
aux_lin &lt;- lm(m1 ~ tbill + gdp + I(fitted(fm_log) - log(fitted(fm_lin))), data = usm)
aux_log &lt;- lm(m1 ~ tbill + gdp + I(fitted(fm_lin) - exp(fitted(fm_log))), data = log(usm))
coeftest(aux_lin)[4,]
coeftest(aux_log)[4,]
## matches results from errata
## With lmtest &gt;= 0.9-24:
## petest(fm_lin, fm_log)

## Example 12.1
fm_m1 &lt;- dynlm(log(m1) ~ log(gdp) + log(cpi), data = USMacroG)
summary(fm_m1)

## Figure 12.1
par(las = 1)
plot(0, 0, type = "n", axes = FALSE,
     xlim = c(1950, 2002), ylim = c(-0.3, 0.225),
     xaxs = "i", yaxs = "i",
     xlab = "Quarter", ylab = "", main = "Least Squares Residuals")
box()
axis(1, at = c(1950, 1963, 1976, 1989, 2002))
axis(2, seq(-0.3, 0.225, by = 0.075))
grid(4, 7, col = grey(0.6))
abline(0, 0)
lines(residuals(fm_m1), lwd = 2)

## Example 12.3
fm_pc &lt;- dynlm(d(inflation) ~ unemp, data = USMacroG)
summary(fm_pc)
## Figure 12.3
plot(residuals(fm_pc))
## natural unemployment rate
coef(fm_pc)[1]/coef(fm_pc)[2]
## autocorrelation
res &lt;- residuals(fm_pc)
summary(dynlm(res ~ L(res)))

## Example 12.4
coeftest(fm_m1)
coeftest(fm_m1, vcov = NeweyWest(fm_m1, lag = 5))
summary(fm_m1)$r.squared
dwtest(fm_m1)
as.vector(acf(residuals(fm_m1), plot = FALSE)$acf)[2]
## matches Tab. 12.1 errata and Greene 6e, apart from Newey-West SE


#################################################
## Cost function of electricity producers 1870 ##
#################################################

## Example 5.6: a generalized Cobb-Douglas cost function
data("Electricity1970", package = "AER")
fm &lt;- lm(log(cost/fuel) ~ log(output) + I(log(output)^2/2) + 
  log(capital/fuel) + log(labor/fuel), data=Electricity1970[1:123,])


####################################################
## SIC 33: Production for primary metals industry ##
####################################################

## data
data("SIC33", package = "AER")

## Example 6.2
## Translog model
fm_tl &lt;- lm(
  output ~ labor + capital + I(0.5 * labor^2) + I(0.5 * capital^2) + I(labor * capital),
  data = log(SIC33))
## Cobb-Douglas model
fm_cb &lt;- lm(output ~ labor + capital, data = log(SIC33))

## Table 6.2 in Greene (2003)
deviance(fm_tl)
deviance(fm_cb)
summary(fm_tl)
summary(fm_cb)
vcov(fm_tl)
vcov(fm_cb)

## Cobb-Douglas vs. Translog model
anova(fm_cb, fm_tl)
## hypothesis of constant returns
linearHypothesis(fm_cb, "labor + capital = 1")


###############################
## Cost data for US airlines ##
###############################

## data
data("USAirlines", package = "AER")

## Example 7.2
fm_full &lt;- lm(log(cost) ~ log(output) + I(log(output)^2) + log(price) + load + year + firm,
  data = USAirlines)
fm_time &lt;- lm(log(cost) ~ log(output) + I(log(output)^2) + log(price) + load + year,
  data = USAirlines)
fm_firm &lt;- lm(log(cost) ~ log(output) + I(log(output)^2) + log(price) + load + firm,
  data = USAirlines)
fm_no &lt;- lm(log(cost) ~ log(output) + I(log(output)^2) + log(price) + load, data = USAirlines)

## full fitted model
coef(fm_full)[1:5]
plot(1970:1984, c(coef(fm_full)[6:19], 0), type = "n",
     xlab = "Year", ylab = expression(delta(Year)),
     main = "Estimated Year Specific Effects")
grid()
points(1970:1984, c(coef(fm_full)[6:19], 0), pch = 19)

## Table 7.2
anova(fm_full, fm_time)
anova(fm_full, fm_firm)
anova(fm_full, fm_no)

## alternatively, use plm()
library("plm")
usair &lt;- pdata.frame(USAirlines, c("firm", "year"))
fm_full2 &lt;- plm(log(cost) ~ log(output) + I(log(output)^2) + log(price) + load,
  data = usair, model = "within", effect = "twoways")
fm_time2 &lt;- plm(log(cost) ~ log(output) + I(log(output)^2) + log(price) + load,
  data = usair, model = "within", effect = "time")
fm_firm2 &lt;- plm(log(cost) ~ log(output) + I(log(output)^2) + log(price) + load,
  data = usair, model = "within", effect = "individual")
fm_no2 &lt;- plm(log(cost) ~ log(output) + I(log(output)^2) + log(price) + load,
  data = usair, model = "pooling")
pFtest(fm_full2, fm_time2)
pFtest(fm_full2, fm_firm2)
pFtest(fm_full2, fm_no2)


## Example 13.1, Table 13.1
fm_no &lt;- plm(log(cost) ~ log(output) + log(price) + load, data = usair, model = "pooling")
fm_gm &lt;- plm(log(cost) ~ log(output) + log(price) + load, data = usair, model = "between")
fm_firm &lt;- plm(log(cost) ~ log(output) + log(price) + load, data = usair, model = "within")
fm_time &lt;- plm(log(cost) ~ log(output) + log(price) + load, data = usair, model = "within",
  effect = "time")
fm_ft &lt;- plm(log(cost) ~ log(output) + log(price) + load, data = usair, model = "within",
  effect = "twoways")

summary(fm_no)
summary(fm_gm)
summary(fm_firm)
fixef(fm_firm)
summary(fm_time)
fixef(fm_time)
summary(fm_ft)
fixef(fm_ft, effect = "individual")
fixef(fm_ft, effect = "time")

## Table 13.2
fm_rfirm &lt;- plm(log(cost) ~ log(output) + log(price) + load, data = usair, model = "random")
fm_rft &lt;- plm(log(cost) ~ log(output) + log(price) + load, data = usair, model = "random",
  effect = "twoways")
summary(fm_rfirm)
summary(fm_rft)


#################################################
## Cost function of electricity producers 1955 ##
#################################################

## Nerlove data
data("Electricity1955", package = "AER")
Electricity &lt;- Electricity1955[1:145,]

## Example 7.3
## Cobb-Douglas cost function
fm_all &lt;- lm(log(cost/fuel) ~ log(output) + log(labor/fuel) + log(capital/fuel),
  data = Electricity)
summary(fm_all)

## hypothesis of constant returns to scale
linearHypothesis(fm_all, "log(output) = 1")

## Figure 7.4
plot(residuals(fm_all) ~ log(output), data = Electricity)
## scaling seems to be different in Greene (2003) with logQ &gt; 10?

## grouped functions
Electricity$group &lt;- with(Electricity, cut(log(output), quantile(log(output), 0:5/5),
  include.lowest = TRUE, labels = 1:5))
fm_group &lt;- lm(
  log(cost/fuel) ~ group/(log(output) + log(labor/fuel) + log(capital/fuel)) - 1,
  data = Electricity)

## Table 7.3 (close, but not quite)
round(rbind(coef(fm_all)[-1], matrix(coef(fm_group), nrow = 5)[,-1]), digits = 3)

## Table 7.4
## log quadratic cost function
fm_all2 &lt;- lm(
  log(cost/fuel) ~ log(output) + I(log(output)^2) + log(labor/fuel) + log(capital/fuel),
  data = Electricity)
summary(fm_all2)


##########################
## Technological change ##
##########################

## Exercise 7.1
data("TechChange", package = "AER")
fm1 &lt;- lm(I(output/technology) ~ log(clr), data = TechChange)
fm2 &lt;- lm(I(output/technology) ~ I(1/clr), data = TechChange)
fm3 &lt;- lm(log(output/technology) ~ log(clr), data = TechChange)
fm4 &lt;- lm(log(output/technology) ~ I(1/clr), data = TechChange)

## Exercise 7.2 (a) and (c)
plot(I(output/technology) ~ clr, data = TechChange)
sctest(I(output/technology) ~ log(clr), data = TechChange,
  type = "Chow", point = c(1942, 1))


##################################
## Expenditure and default data ##
##################################

## full data set (F21.4)
data("CreditCard", package = "AER")

## extract data set F9.1
ccard &lt;- CreditCard[1:100,]
ccard$income &lt;- round(ccard$income, digits = 2)
ccard$expenditure &lt;- round(ccard$expenditure, digits = 2)
ccard$age &lt;- round(ccard$age + .01)
## suspicious:
CreditCard$age[CreditCard$age &lt; 1]
## the first of these is also in TableF9.1 with 36 instead of 0.5:
ccard$age[79] &lt;- 36

## Example 11.1
ccard &lt;- ccard[order(ccard$income),]
ccard0 &lt;- subset(ccard, expenditure &gt; 0)
cc_ols &lt;- lm(expenditure ~ age + owner + income + I(income^2), data = ccard0)

## Figure 11.1
plot(residuals(cc_ols) ~ income, data = ccard0, pch = 19)

## Table 11.1
mean(ccard$age)
prop.table(table(ccard$owner))
mean(ccard$income)

summary(cc_ols)
sqrt(diag(vcovHC(cc_ols, type = "HC0")))
sqrt(diag(vcovHC(cc_ols, type = "HC2"))) 
sqrt(diag(vcovHC(cc_ols, type = "HC1")))

bptest(cc_ols, ~ (age + income + I(income^2) + owner)^2 + I(age^2) + I(income^4),
  data = ccard0)
gqtest(cc_ols)
bptest(cc_ols, ~ income + I(income^2), data = ccard0, studentize = FALSE)
bptest(cc_ols, ~ income + I(income^2), data = ccard0)

## Table 11.2, WLS and FGLS
cc_wls1 &lt;- lm(expenditure ~ age + owner + income + I(income^2), weights = 1/income,
  data = ccard0)
cc_wls2 &lt;- lm(expenditure ~ age + owner + income + I(income^2), weights = 1/income^2,
  data = ccard0)

auxreg1 &lt;- lm(log(residuals(cc_ols)^2) ~ log(income), data = ccard0)
cc_fgls1 &lt;- lm(expenditure ~ age + owner + income + I(income^2),
  weights = 1/exp(fitted(auxreg1)), data = ccard0)

auxreg2 &lt;- lm(log(residuals(cc_ols)^2) ~ income + I(income^2), data = ccard0)
cc_fgls2 &lt;- lm(expenditure ~ age + owner + income + I(income^2),
  weights = 1/exp(fitted(auxreg2)), data = ccard0)

alphai &lt;- coef(lm(log(residuals(cc_ols)^2) ~ log(income), data = ccard0))[2]
alpha &lt;- 0
while(abs((alphai - alpha)/alpha) &gt; 1e-7) {
  alpha &lt;- alphai
  cc_fgls3 &lt;- lm(expenditure ~ age + owner + income + I(income^2), weights = 1/income^alpha,
    data = ccard0)
  alphai &lt;- coef(lm(log(residuals(cc_fgls3)^2) ~ log(income), data = ccard0))[2]
}
alpha ## 1.7623 for Greene
cc_fgls3 &lt;- lm(expenditure ~ age + owner + income + I(income^2), weights = 1/income^alpha,
  data = ccard0)

llik &lt;- function(alpha)
  -logLik(lm(expenditure ~ age + owner + income + I(income^2), weights = 1/income^alpha,
    data = ccard0))
plot(0:100/20, -sapply(0:100/20, llik), type = "l", xlab = "alpha", ylab = "logLik")
alpha &lt;- optimize(llik, interval = c(0, 5))$minimum
cc_fgls4 &lt;- lm(expenditure ~ age + owner + income + I(income^2), weights = 1/income^alpha,
  data = ccard0)

## Table 11.2
cc_fit &lt;- list(cc_ols, cc_wls1, cc_wls2, cc_fgls2, cc_fgls1, cc_fgls3, cc_fgls4)
t(sapply(cc_fit, coef))
t(sapply(cc_fit, function(obj) sqrt(diag(vcov(obj)))))

## Table 21.21, Poisson and logit models
cc_pois &lt;- glm(reports ~ age + income + expenditure, data = CreditCard, family = poisson)
summary(cc_pois)
logLik(cc_pois)
xhat &lt;- colMeans(CreditCard[, c("age", "income", "expenditure")])
xhat &lt;- as.data.frame(t(xhat))
lambda &lt;- predict(cc_pois, newdata = xhat, type = "response")
ppois(0, lambda) * nrow(CreditCard)

cc_logit &lt;- glm(factor(reports &gt; 0) ~ age + income + owner,
  data = CreditCard, family = binomial)
summary(cc_logit)
logLik(cc_logit)

## Table 21.21, "split population model"
library("pscl")
cc_zip &lt;- zeroinfl(reports ~ age + income + expenditure | age + income + owner,
  data = CreditCard)
summary(cc_zip)
sum(predict(cc_zip, type = "prob")[,1])


###################################
## DEM/GBP exchange rate returns ##
###################################

## data as given by Greene (2003)
data("MarkPound")
mp &lt;- round(MarkPound, digits = 6)

## Figure 11.3 in Greene (2003)
plot(mp)

## Example 11.8 in Greene (2003), Table 11.5
library("tseries")
mp_garch &lt;- garch(mp, grad = "numerical")
summary(mp_garch)
logLik(mp_garch)  
## Greene (2003) also includes a constant and uses different
## standard errors (presumably computed from Hessian), here
## OPG standard errors are used. garchFit() in "fGarch"
## implements the approach used by Greene (2003).

## compare Errata to Greene (2003)
library("dynlm")
res &lt;- residuals(dynlm(mp ~ 1))^2
mp_ols &lt;- dynlm(res ~ L(res, 1:10))
summary(mp_ols)
logLik(mp_ols)
summary(mp_ols)$r.squared * length(residuals(mp_ols))


################################
## Grunfeld's investment data ##
################################

## subset of data with mistakes
data("Grunfeld", package = "AER")
ggr &lt;- subset(Grunfeld, firm %in% c("General Motors", "US Steel",
  "General Electric", "Chrysler", "Westinghouse"))
ggr[c(26, 38), 1] &lt;- c(261.6, 645.2)
ggr[32, 3] &lt;- 232.6

## Tab. 13.4
fm_pool &lt;- lm(invest ~ value + capital, data = ggr)
summary(fm_pool)
logLik(fm_pool)
## White correction
sqrt(diag(vcovHC(fm_pool, type = "HC0")))

## heteroskedastic FGLS
auxreg1 &lt;- lm(residuals(fm_pool)^2 ~ firm - 1, data = ggr)
fm_pfgls &lt;- lm(invest ~ value + capital, data = ggr, weights = 1/fitted(auxreg1))
summary(fm_pfgls)

## ML, computed as iterated FGLS
sigmasi &lt;- fitted(lm(residuals(fm_pfgls)^2 ~ firm - 1 , data = ggr))
sigmas &lt;- 0
while(any(abs((sigmasi - sigmas)/sigmas) &gt; 1e-7)) {
   sigmas &lt;- sigmasi
   fm_pfgls_i &lt;- lm(invest ~ value + capital, data = ggr, weights = 1/sigmas)
   sigmasi &lt;- fitted(lm(residuals(fm_pfgls_i)^2 ~ firm - 1 , data = ggr))
   }
fm_pmlh &lt;- lm(invest ~ value + capital, data = ggr, weights = 1/sigmas)
summary(fm_pmlh)
logLik(fm_pmlh)

## Tab. 13.5
auxreg2 &lt;- lm(residuals(fm_pfgls)^2 ~ firm - 1, data = ggr)
auxreg3 &lt;- lm(residuals(fm_pmlh)^2 ~ firm - 1, data = ggr)
rbind(
  "OLS" = coef(auxreg1),
  "Het. FGLS" = coef(auxreg2),
  "Het. ML" = coef(auxreg3))


## Chapter 14: explicitly treat as panel data
library("plm")
pggr &lt;- pdata.frame(ggr, c("firm", "year"))

## Tab. 14.1
library("systemfit")
fm_sur &lt;- systemfit(invest ~ value + capital, data = pggr, method = "SUR",
  methodResidCov = "noDfCor")
fm_psur &lt;- systemfit(invest ~ value + capital, data = pggr, method = "SUR", pooled = TRUE, 
  methodResidCov = "noDfCor", residCovWeighted = TRUE)

## Tab 14.2
fm_ols &lt;- systemfit(invest ~ value + capital, data = pggr, method = "OLS")
fm_pols &lt;- systemfit(invest ~ value + capital, data = pggr, method = "OLS", pooled = TRUE)
## or "by hand"
fm_gm &lt;- lm(invest ~ value + capital, data = ggr, subset = firm == "General Motors")
mean(residuals(fm_gm)^2)   ## Greene uses MLE
## etc.
fm_pool &lt;- lm(invest ~ value + capital, data = ggr)

## Tab. 14.3 (and Tab 13.4, cross-section ML)
## (not run due to long computation time)
## Not run: 
fm_ml &lt;- systemfit(invest ~ value + capital, data = pggr, method = "SUR",
  methodResidCov = "noDfCor", maxiter = 1000, tol = 1e-10)
fm_pml &lt;- systemfit(invest ~ value + capital, data = pggr, method = "SUR", pooled = TRUE, 
  methodResidCov = "noDfCor", residCovWeighted = TRUE, maxiter = 1000, tol = 1e-10)

## End(Not run)

## Fig. 14.2
plot(unlist(residuals(fm_sur)[, c(3, 1, 2, 5, 4)]), 
  type = "l", ylab = "SUR residuals", ylim = c(-400, 400), xaxs = "i", yaxs = "i")
abline(v = c(20,40,60,80), h = 0, lty = 2)


###################
## Klein model I ##
###################

## data
data("KleinI", package = "AER")

## Tab. 15.3, OLS
library("dynlm")
fm_cons &lt;- dynlm(consumption ~ cprofits + L(cprofits) + I(pwage + gwage), data = KleinI)
fm_inv &lt;- dynlm(invest ~ cprofits + L(cprofits) + capital, data = KleinI)
fm_pwage &lt;- dynlm(pwage ~ gnp + L(gnp) + I(time(gnp) - 1931), data = KleinI)
summary(fm_cons)
summary(fm_inv)
summary(fm_pwage)
## Notes:
##  - capital refers to previous year's capital stock -&gt; no lag needed!
##  - trend used by Greene (p. 381, "time trend measured as years from 1931")
##    Maddala uses years since 1919

## preparation of data frame for systemfit
KI &lt;- ts.intersect(KleinI, lag(KleinI, k = -1), dframe = TRUE)
names(KI) &lt;- c(colnames(KleinI), paste("L", colnames(KleinI), sep = ""))
KI$trend &lt;- (1921:1941) - 1931

library("systemfit")
system &lt;- list(
  consumption = consumption ~ cprofits + Lcprofits + I(pwage + gwage),
  invest = invest ~ cprofits + Lcprofits + capital,
  pwage = pwage ~ gnp + Lgnp + trend)

## Tab. 15.3 OLS again
fm_ols &lt;- systemfit(system, method = "OLS", data = KI)
summary(fm_ols)

## Tab. 15.3 2SLS, 3SLS, I3SLS
inst &lt;- ~ Lcprofits + capital + Lgnp + gexpenditure + taxes + trend + gwage
fm_2sls &lt;- systemfit(system, method = "2SLS", inst = inst,
  methodResidCov = "noDfCor", data = KI)

fm_3sls &lt;- systemfit(system, method = "3SLS", inst = inst,
  methodResidCov = "noDfCor", data = KI)

fm_i3sls &lt;- systemfit(system, method = "3SLS", inst = inst,
  methodResidCov = "noDfCor", maxiter = 100, data = KI)


############################################
## Transportation equipment manufacturing ##
############################################

## data
data("Equipment", package = "AER")

## Example 17.5
## Cobb-Douglas
fm_cd &lt;- lm(log(valueadded/firms) ~ log(capital/firms) + log(labor/firms),
  data = Equipment)

## generalized Cobb-Douglas with Zellner-Revankar trafo
GCobbDouglas &lt;- function(theta)
 lm(I(log(valueadded/firms) + theta * valueadded/firms) ~ log(capital/firms) + log(labor/firms),
     data = Equipment)

## yields classical Cobb-Douglas for theta = 0
fm_cd0 &lt;- GCobbDouglas(0)

## ML estimation of generalized model
## choose starting values from classical model
par0 &lt;- as.vector(c(coef(fm_cd0), 0, mean(residuals(fm_cd0)^2)))

## set up likelihood function
nlogL &lt;- function(par) {
  beta &lt;- par[1:3]
  theta &lt;- par[4]
  sigma2 &lt;- par[5]

  Y &lt;- with(Equipment, valueadded/firms)
  K &lt;- with(Equipment, capital/firms)
  L &lt;- with(Equipment, labor/firms)

  rhs &lt;- beta[1] + beta[2] * log(K) + beta[3] * log(L)
  lhs &lt;- log(Y) + theta * Y

  rval &lt;- sum(log(1 + theta * Y) - log(Y) +
    dnorm(lhs, mean = rhs, sd = sqrt(sigma2), log = TRUE))
  return(-rval)
}

## optimization
opt &lt;- optim(par0, nlogL, hessian = TRUE)

## Table 17.2
opt$par
sqrt(diag(solve(opt$hessian)))[1:4]
-opt$value

## re-fit ML model
fm_ml &lt;- GCobbDouglas(opt$par[4])
deviance(fm_ml)
sqrt(diag(vcov(fm_ml)))

## fit NLS model
rss &lt;- function(theta) deviance(GCobbDouglas(theta))
optim(0, rss)
opt2 &lt;- optimize(rss, c(-1, 1))
fm_nls &lt;- GCobbDouglas(opt2$minimum)
-nlogL(c(coef(fm_nls), opt2$minimum, mean(residuals(fm_nls)^2)))


############################
## Municipal expenditures ##
############################

## Table 18.2
data("Municipalities", package = "AER")
summary(Municipalities)


###########################
## Program effectiveness ##
###########################

## Table 21.1, col. "Probit"
data("ProgramEffectiveness", package = "AER")
fm_probit &lt;- glm(grade ~ average + testscore + participation,
  data = ProgramEffectiveness, family = binomial(link = "probit"))
summary(fm_probit)


####################################
## Labor force participation data ##
####################################

## data and transformations
data("PSID1976", package = "AER")
PSID1976$kids &lt;- with(PSID1976, factor((youngkids + oldkids) &gt; 0,
  levels = c(FALSE, TRUE), labels = c("no", "yes")))
PSID1976$nwincome &lt;- with(PSID1976, (fincome - hours * wage)/1000)

## Example 4.1, Table 4.2
## (reproduced in Example 7.1, Table 7.1)
gr_lm &lt;- lm(log(hours * wage) ~ age + I(age^2) + education + kids,
  data = PSID1976, subset = participation == "yes")
summary(gr_lm)
vcov(gr_lm)

## Example 4.5
summary(gr_lm)
## or equivalently
gr_lm1 &lt;- lm(log(hours * wage) ~ 1, data = PSID1976, subset = participation == "yes")
anova(gr_lm1, gr_lm)

## Example 21.4, p. 681, and Tab. 21.3, p. 682
gr_probit1 &lt;- glm(participation ~ age + I(age^2) + I(fincome/10000) + education + kids,
  data = PSID1976, family = binomial(link = "probit") )
gr_probit2 &lt;- glm(participation ~ age + I(age^2) + I(fincome/10000) + education,
  data = PSID1976, family = binomial(link = "probit"))
gr_probit3 &lt;- glm(participation ~ kids/(age + I(age^2) + I(fincome/10000) + education),
  data = PSID1976, family = binomial(link = "probit"))
## LR test of all coefficients
lrtest(gr_probit1)
## Chow-type test
lrtest(gr_probit2, gr_probit3)
## equivalently:
anova(gr_probit2, gr_probit3, test = "Chisq")
## Table 21.3
summary(gr_probit1)

## Example 22.8, Table 22.7, p. 786
library("sampleSelection")
gr_2step &lt;- selection(participation ~ age + I(age^2) + fincome + education + kids, 
  wage ~ experience + I(experience^2) + education + city,
  data = PSID1976, method = "2step")
gr_ml &lt;- selection(participation ~ age + I(age^2) + fincome + education + kids, 
  wage ~ experience + I(experience^2) + education + city,
  data = PSID1976, method = "ml")
gr_ols &lt;- lm(wage ~ experience + I(experience^2) + education + city, 
  data = PSID1976, subset = participation == "yes")
## NOTE: ML estimates agree with Greene, 5e errata. 
## Standard errors are based on the Hessian (here), while Greene has BHHH/OPG.



####################
## Ship accidents ##
####################

## subset data
data("ShipAccidents", package = "AER")
sa &lt;- subset(ShipAccidents, service &gt; 0)

## Table 21.20
sa_full &lt;- glm(incidents ~ type + construction + operation, family = poisson,
  data = sa, offset = log(service))
summary(sa_full)

sa_notype &lt;- glm(incidents ~ construction + operation, family = poisson,
  data = sa, offset = log(service))
summary(sa_notype)

sa_noperiod &lt;- glm(incidents ~ type + operation, family = poisson,
  data = sa, offset = log(service))
summary(sa_noperiod)

## model comparison
anova(sa_full, sa_notype, test = "Chisq")
anova(sa_full, sa_noperiod, test = "Chisq")

## test for overdispersion
dispersiontest(sa_full)
dispersiontest(sa_full, trafo = 2)


######################################
## Fair's extramarital affairs data ##
######################################

## data
data("Affairs", package = "AER")

## Tab. 22.3 and 22.4
fm_ols &lt;- lm(affairs ~ age + yearsmarried + religiousness + occupation + rating,
  data = Affairs)
fm_probit &lt;- glm(I(affairs &gt; 0) ~ age + yearsmarried + religiousness + occupation + rating,
  data = Affairs, family = binomial(link = "probit"))

fm_tobit &lt;- tobit(affairs ~ age + yearsmarried + religiousness + occupation + rating,
  data = Affairs)
fm_tobit2 &lt;- tobit(affairs ~ age + yearsmarried + religiousness + occupation + rating,
  right = 4, data = Affairs)

fm_pois &lt;- glm(affairs ~ age + yearsmarried + religiousness + occupation + rating,
  data = Affairs, family = poisson)

library("MASS")
fm_nb &lt;- glm.nb(affairs ~ age + yearsmarried + religiousness + occupation + rating,
  data = Affairs)

## Tab. 22.6
library("pscl")
fm_zip &lt;- zeroinfl(affairs ~ age + yearsmarried + religiousness + occupation + rating | age + 
  yearsmarried + religiousness + occupation + rating, data = Affairs)


######################
## Strike durations ##
######################

## data and package
data("StrikeDuration", package = "AER")
library("MASS")

## Table 22.10
fit_exp &lt;- fitdistr(StrikeDuration$duration, "exponential")
fit_wei &lt;- fitdistr(StrikeDuration$duration, "weibull")
fit_wei$estimate[2]^(-1)
fit_lnorm &lt;- fitdistr(StrikeDuration$duration, "lognormal")
1/fit_lnorm$estimate[2]
exp(-fit_lnorm$estimate[1])
## Weibull and lognormal distribution have
## different parameterizations, see Greene p. 794

## Example 22.10
library("survival")
fm_wei &lt;- survreg(Surv(duration) ~ uoutput, dist = "weibull", data = StrikeDuration)
summary(fm_wei)

</code></pre>

<hr>
<h2 id='GrowthDJ'>Determinants of Economic Growth</h2><span id='topic+GrowthDJ'></span>

<h3>Description</h3>

<p>Growth regression data as provided by Durlauf &amp; Johnson (1995).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("GrowthDJ")</code></pre>


<h3>Format</h3>

<p>A data frame containing 121 observations on 10 variables.
</p>

<dl>
<dt>oil</dt><dd><p>factor. Is the country an oil-producing country?</p>
</dd>
<dt>inter</dt><dd><p>factor. Does the country have better quality data?</p>
</dd>
<dt>oecd</dt><dd><p>factor. Is the country a member of the OECD?</p>
</dd>
<dt>gdp60</dt><dd><p>Per capita GDP in 1960.</p>
</dd>
<dt>gdp85</dt><dd><p>Per capita GDP in 1985.</p>
</dd>
<dt>gdpgrowth</dt><dd><p>Average growth rate of per capita GDP from 1960 to 1985 (in percent).</p>
</dd>
<dt>popgrowth</dt><dd><p>Average growth rate of working-age population 1960 to 1985 (in percent).</p>
</dd>
<dt>invest</dt><dd><p>Average ratio of investment (including Government Investment) to GDP 
from 1960 to 1985 (in percent).</p>
</dd>
<dt>school</dt><dd><p>Average fraction of working-age population enrolled in secondary school
from 1960 to 1985 (in percent).</p>
</dd>   
<dt>literacy60</dt><dd><p>Fraction of the population over 15 years old that is able to read 
and write in 1960 (in percent).</p>
</dd>  
</dl>



<h3>Details</h3>

<p>The data are derived from the Penn World Table 4.0 and are given in Mankiw, Romer and Weil (1992),
except <code>literacy60</code> that is from the World Bank's World Development Report.
</p>


<h3>Source</h3>

<p>Journal of Applied Econometrics Data Archive. 
</p>
<p><a href="http://qed.econ.queensu.ca/jae/1995-v10.4/durlauf-johnson/">http://qed.econ.queensu.ca/jae/1995-v10.4/durlauf-johnson/</a>
</p>


<h3>References</h3>

<p>Durlauf, S.N., and Johnson, P.A. (1995). Multiple Regimes and Cross-Country
Growth Behavior. <em>Journal of Applied Econometrics</em>, <b>10</b>, 365&ndash;384. 
</p>
<p>Koenker, R., and Zeileis, A. (2009). On Reproducible Econometric Research.
<em>Journal of Applied Econometrics</em>, <b>24</b>(5), 833&ndash;847.
</p>
<p>Mankiw, N.G, Romer, D., and Weil, D.N. (1992). A Contribution to the Empirics of Economic Growth. 
<em>Quarterly Journal of Economics</em>, <b>107</b>, 407&ndash;437. 
</p>
<p>Masanjala, W.H., and Papageorgiou, C. (2004). The Solow Model with CES
Technology: Nonlinearities and Parameter Heterogeneity. <em>Journal of
Applied Econometrics</em>, <b>19</b>, 171&ndash;201.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+OECDGrowth">OECDGrowth</a></code>, <code><a href="#topic+GrowthSW">GrowthSW</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## data for non-oil-producing countries
data("GrowthDJ")
dj &lt;- subset(GrowthDJ, oil == "no")
## Different scalings have been used by different authors,
## different types of standard errors, etc.,
## see Koenker &amp; Zeileis (2009) for an overview

## Durlauf &amp; Johnson (1995), Table II
mrw_model &lt;- I(log(gdp85) - log(gdp60)) ~ log(gdp60) +
  log(invest/100) + log(popgrowth/100 + 0.05) + log(school/100)
dj_mrw &lt;- lm(mrw_model, data = dj)
coeftest(dj_mrw) 

dj_model &lt;- I(log(gdp85) - log(gdp60)) ~ log(gdp60) +
  log(invest) + log(popgrowth/100 + 0.05) + log(school)
dj_sub1 &lt;- lm(dj_model, data = dj, subset = gdp60 &lt; 1800 &amp; literacy60 &lt; 50)
coeftest(dj_sub1, vcov = sandwich)

dj_sub2 &lt;- lm(dj_model, data = dj, subset = gdp60 &gt;= 1800 &amp; literacy60 &gt;= 50)
coeftest(dj_sub2, vcov = sandwich)
</code></pre>

<hr>
<h2 id='GrowthSW'>Determinants of Economic Growth</h2><span id='topic+GrowthSW'></span>

<h3>Description</h3>

<p>Data on average growth rates over 1960&ndash;1995 for 65 countries, along with
variables that are potentially related to growth.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("GrowthSW")</code></pre>


<h3>Format</h3>

<p>A data frame containing 65 observations on 6 variables.
</p>

<dl>
<dt>growth</dt><dd><p>average annual percentage growth of real GDP from 1960 to 1995.</p>
</dd>
<dt>rgdp60</dt><dd><p>value of GDP per capita in 1960, converted to 1960 US dollars.</p>
</dd>
<dt>tradeshare</dt><dd><p>average share of trade in the economy from 1960 to 1995, 
measured as the sum of exports (X) plus imports (M), divided by GDP;
that is, the average value of (X + M)/GDP from 1960 to 1995.</p>
</dd>
<dt>education</dt><dd><p>average number of years of schooling of adult residents in that country in 1960.</p>
</dd>
<dt>revolutions</dt><dd><p>average annual number of revolutions, 
insurrections (successful or not) and coup d'etats in that country from 1960 to 1995.</p>
</dd>
<dt>assassinations</dt><dd><p>average annual number of political assassinations 
in that country from 1960 to 1995 (in per million population).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Beck, T., Levine, R., and Loayza, N. (2000). Finance and the Sources of Growth.
<em>Journal of Financial Economics</em>, <b>58</b>, 261&ndash;300.
</p>
<p>Stock, J. H. and Watson, M. W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code>, <code><a href="#topic+GrowthDJ">GrowthDJ</a></code>, <code><a href="#topic+OECDGrowth">OECDGrowth</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("GrowthSW")
summary(GrowthSW)
</code></pre>

<hr>
<h2 id='Grunfeld'>Grunfeld's Investment Data</h2><span id='topic+Grunfeld'></span>

<h3>Description</h3>

<p>Panel data on 11 large US manufacturing firms over 20 years, for the years 1935&ndash;1954.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Grunfeld")</code></pre>


<h3>Format</h3>

<p>A data frame containing 20 annual observations on 3 variables for 11 firms. 
</p>

<dl>
<dt>invest</dt><dd><p>Gross investment, defined as additions to plant and equipment plus 
maintenance and repairs in millions of dollars deflated by the implicit price
deflator of producers' durable equipment (base 1947).</p>
</dd>
<dt>value</dt><dd><p>Market value of the firm, defined as the price of common shares at
December 31 (or, for WH, IBM and CH, the average price of December 31 and
January 31 of the following year) times the number of common shares
outstanding plus price of preferred shares at December 31 (or average price
of December 31 and January 31 of the following year) times number of
preferred shares plus total book value of debt at December 31 in millions of
dollars deflated by the implicit GNP price deflator (base 1947).</p>
</dd>
<dt>capital</dt><dd><p>Stock of plant and equipment, defined as the accumulated sum of net additions
to plant and equipment deflated by the implicit price deflator for producers' durable
equipment (base 1947) minus depreciation allowance deflated by depreciation expense deflator
(10 years moving average of wholesale price index of metals and metal products, base 1947).</p>
</dd>
<dt>firm</dt><dd><p>factor with 11 levels: <code>"General Motors"</code>, <code>"US Steel"</code>,
<code>"General Electric"</code>, <code>"Chrysler"</code>, <code>"Atlantic Refining"</code>, <code>"IBM"</code>,
<code>"Union Oil"</code>, <code>"Westinghouse"</code>, <code>"Goodyear"</code>, <code>"Diamond Match"</code>,
<code>"American Steel"</code>.</p>
</dd>
<dt>year</dt><dd><p>Year.</p>
</dd>
</dl>



<h3>Details</h3>

<p>This is a popular data set for teaching purposes. Unfortunately, there exist several 
different versions (see Kleiber and Zeileis, 2010, for a detailed discussion). 
In particular, the version provided by Greene (2003) has a couple of errors
for <code>"US Steel"</code> (firm 2): 
investment in 1940 is 261.6 (instead of the correct 361.6), 
investment in 1952 is 645.2 (instead of the correct 645.5), 
capital    in 1946 is 132.6 (instead of the correct 232.6).
</p>
<p>Here, we provide the original data from Grunfeld (1958). The data for
the first 10 firms are identical to those of Baltagi (2002) or Baltagi (2005),
now also used by Greene (2008).
</p>


<h3>Source</h3>

<p>The data are taken from Grunfeld (1958, Appendix, Tables 2&ndash;9 and 11&ndash;13).
</p>


<h3>References</h3>

<p>Baltagi, B.H. (2002). <em>Econometrics</em>, 3rd ed., Berlin: Springer-Verlag. 
</p>
<p>Baltagi, B.H. (2005). <em>Econometric Analysis of Panel Data</em>, 3rd ed. Chichester, UK: John Wiley.
</p>
<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>
<p>Greene, W.H. (2008). <em>Econometric Analysis</em>, 6th edition. Upper Saddle River, NJ: Prentice Hall.
</p>
<p>Grunfeld, Y. (1958). <em>The Determinants of Corporate Investment</em>. 
Unpublished Ph.D. Dissertation, University of Chicago.
</p>
<p>Kleiber, C., and Zeileis, A. (2010). &ldquo;The Grunfeld Data at 50.&rdquo;
<em>German Economic Review</em>, <b>11</b>(4), 404&ndash;417.
<a href="https://doi.org/10.1111/j.1468-0475.2010.00513.x">doi:10.1111/j.1468-0475.2010.00513.x</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Baltagi2002">Baltagi2002</a></code>, <code><a href="#topic+Greene2003">Greene2003</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("Grunfeld", package = "AER")

## Greene (2003)
## subset of data with mistakes
ggr &lt;- subset(Grunfeld, firm %in% c("General Motors", "US Steel",
  "General Electric", "Chrysler", "Westinghouse"))
ggr[c(26, 38), 1] &lt;- c(261.6, 645.2)
ggr[32, 3] &lt;- 232.6

## Tab. 14.2, col. "GM"
fm_gm &lt;- lm(invest ~ value + capital, data = ggr, subset = firm == "General Motors")
mean(residuals(fm_gm)^2)   ## Greene uses MLE

## Tab. 14.2, col. "Pooled"
fm_pool &lt;- lm(invest ~ value + capital, data = ggr)

## equivalently
library("plm")
pggr &lt;- pdata.frame(ggr, c("firm", "year"))
library("systemfit")
fm_ols &lt;- systemfit(invest ~ value + capital, data = pggr, method = "OLS")
fm_pols &lt;- systemfit(invest ~ value + capital, data = pggr, method = "OLS",
  pooled = TRUE)

## Tab. 14.1
fm_sur &lt;- systemfit(invest ~ value + capital, data = pggr, method = "SUR",
  methodResidCov = "noDfCor")
fm_psur &lt;- systemfit(invest ~ value + capital, data = pggr, method = "SUR", pooled = TRUE,
  methodResidCov = "noDfCor", residCovWeighted = TRUE)

## Further examples:
## help("Greene2003")



## Panel models
library("plm")
pg &lt;- pdata.frame(subset(Grunfeld, firm != "American Steel"), c("firm", "year"))

fm_fe &lt;- plm(invest ~ value + capital, model = "within", data = pg)
summary(fm_fe)
coeftest(fm_fe, vcov = vcovHC)

fm_reswar &lt;- plm(invest ~ value + capital, data = pg,
  model = "random", random.method = "swar")
summary(fm_reswar)

## testing for random effects
fm_ols &lt;- plm(invest ~ value + capital, data = pg, model = "pooling")
plmtest(fm_ols, type = "bp")
plmtest(fm_ols, type = "honda")

## Random effects models
fm_ream &lt;- plm(invest ~ value + capital, data = pg, model = "random",
  random.method = "amemiya")
fm_rewh &lt;- plm(invest ~ value + capital, data = pg, model = "random",
  random.method = "walhus")
fm_rener &lt;- plm(invest ~ value + capital, data = pg, model = "random",
  random.method = "nerlove")

## Baltagi (2005), Tab. 2.1
rbind(
  "OLS(pooled)" = coef(fm_ols),
  "FE" = c(NA, coef(fm_fe)),
  "RE-SwAr" = coef(fm_reswar),
  "RE-Amemiya" = coef(fm_ream),
  "RE-WalHus" = coef(fm_rewh),
  "RE-Nerlove" = coef(fm_rener))

## Hausman test
phtest(fm_fe, fm_reswar)

## Further examples:
## help("Baltagi2002")
## help("Greene2003")
</code></pre>

<hr>
<h2 id='GSOEP9402'>German Socio-Economic Panel 1994&ndash;2002</h2><span id='topic+GSOEP9402'></span>

<h3>Description</h3>

<p>Cross-section data for 675 14-year old children born between 1980 and 1988.
The sample is taken from the German Socio-Economic Panel (GSOEP) for the years
1994 to 2002 to investigate the determinants of secondary school choice.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("GSOEP9402")</code></pre>


<h3>Format</h3>

<p>A data frame containing 675 observations on 12 variables. 
</p>

<dl>
<dt>school</dt><dd><p>factor. Child's secondary school level.</p>
</dd>
<dt>birthyear</dt><dd><p>Year of child's birth.</p>
</dd>
<dt>gender</dt><dd><p>factor indicating child's gender.</p>
</dd>
<dt>kids</dt><dd><p>Total number of kids living in household.</p>
</dd>
<dt>parity</dt><dd><p>Birth order.</p>
</dd>
<dt>income</dt><dd><p>Household income.</p>
</dd>
<dt>size</dt><dd><p>Household size</p>
</dd>
<dt>state</dt><dd><p>factor indicating German federal state.</p>
</dd>
<dt>marital</dt><dd><p>factor indicating mother's marital status.</p>
</dd>
<dt>meducation</dt><dd><p>Mother's educational level in years.</p>
</dd>
<dt>memployment</dt><dd><p>factor indicating mother's employment level:
full-time, part-time, or not working.</p>
</dd>
<dt>year</dt><dd><p>Year of GSOEP wave.</p>
</dd>
</dl>



<h3>Details</h3>

<p>This sample from the German Socio-Economic Panel (GSOEP) for the years
between 1994 and 2002 has been selected by Winkelmann and Boes (2009)
to investigate the determinants of secondary school choice.
</p>
<p>In the German schooling system, students are separated relatively early into
different school types, depending on their ability as perceived by the teachers
after four years of primary school. After that, around the age of ten, students are placed
into one of three types of secondary school: <code>"Hauptschule"</code>
(lower secondary school), <code>"Realschule"</code> (middle secondary school), or
<code>"Gymnasium"</code> (upper secondary school). Only a degree from the latter
type of school (called Abitur) provides direct access to universities.
</p>
<p>A frequent criticism of this system is that the tracking takes place too
early, and that it cements inequalities in education across generations. 
Although the secondary school choice is based on the teachers' recommendations,
it is typically also influenced by the parents; both indirectly through
their own educational level and directly through influence on the teachers.
</p>


<h3>Source</h3>

<p>Online complements to Winkelmann and Boes (2009).
</p>


<h3>References</h3>

<p>Winkelmann, R., and Boes, S. (2009). <em>Analysis of Microdata</em>, 2nd ed. Berlin and Heidelberg: Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WinkelmannBoes2009">WinkelmannBoes2009</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## data
data("GSOEP9402", package = "AER")

## some convenience data transformations
gsoep &lt;- GSOEP9402
gsoep$year2 &lt;- factor(gsoep$year)

## visualization
plot(school ~ meducation, data = gsoep, breaks = c(7, 9, 10.5, 11.5, 12.5, 15, 18))


## Chapter 5, Table 5.1
library("nnet")
gsoep_mnl &lt;- multinom(
  school ~ meducation + memployment + log(income) + log(size) + parity + year2,
  data = gsoep)
coeftest(gsoep_mnl)[c(1:6, 1:6 + 14),]
 
## alternatively
library("mlogit")
gsoep_mnl2 &lt;- mlogit(
  school ~ 0 | meducation + memployment + log(income) + log(size) + parity + year2,
  data = gsoep, shape = "wide", reflevel = "Hauptschule")
coeftest(gsoep_mnl2)[1:12,]

## Table 5.2
library("effects")
gsoep_eff &lt;- effect("meducation", gsoep_mnl,
  xlevels = list(meducation = sort(unique(gsoep$meducation))))
gsoep_eff$prob
plot(gsoep_eff, confint = FALSE)

## omit year
gsoep_mnl1 &lt;- multinom(
  school ~ meducation + memployment + log(income) + log(size) + parity,
  data = gsoep)
lrtest(gsoep_mnl, gsoep_mnl1)


## Chapter 6
## Table 6.1
library("MASS")
gsoep_pop &lt;- polr(
  school ~ meducation + I(memployment != "none") + log(income) + log(size) + parity + year2,
  data = gsoep, method = "probit", Hess = TRUE)
gsoep_pol &lt;- polr(
  school ~ meducation + I(memployment != "none") + log(income) + log(size) + parity + year2,
  data = gsoep, Hess = TRUE)

## compare polr and multinom via AIC
gsoep_pol1 &lt;- polr(
  school ~ meducation + memployment + log(income) + log(size) + parity,
  data = gsoep, Hess = TRUE)
AIC(gsoep_pol1, gsoep_mnl)

## effects
eff_pol1 &lt;- allEffects(gsoep_pol1)
plot(eff_pol1, ask = FALSE, confint = FALSE)


## More examples can be found in:
## help("WinkelmannBoes2009")
</code></pre>

<hr>
<h2 id='GSS7402'>US General Social Survey 1974&ndash;2002</h2><span id='topic+GSS7402'></span>

<h3>Description</h3>

<p>Cross-section data for 9120 women taken from every fourth
year of the US General Social Survey between 1974 and 2002
to investigate the determinants of fertility.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("GSS7402")</code></pre>


<h3>Format</h3>

<p>A data frame containing 9120 observations on 10 variables. 
</p>

<dl>
<dt>kids</dt><dd><p>Number of children. This is coded as a numerical variable
but note that the value <code>8</code> actually encompasses 8 or more children.</p>
</dd>
<dt>age</dt><dd><p>Age of respondent.</p>
</dd>
<dt>education</dt><dd><p>Highest year of school completed.</p>
</dd>
<dt>year</dt><dd><p>GSS year for respondent.</p>
</dd>
<dt>siblings</dt><dd><p>Number of brothers and sisters.</p>
</dd>
<dt>agefirstbirth</dt><dd><p>Woman's age at birth of first child.</p>
</dd>
<dt>ethnicity</dt><dd><p>factor indicating ethnicity.
Is the individual Caucasian (<code>"cauc"</code>) or not (<code>"other"</code>)?</p>
</dd>
<dt>city16</dt><dd><p>factor. Did the respondent live in a city
(with population &gt; 50,000) at age 16?</p>
</dd>
<dt>lowincome16</dt><dd><p>factor. Was the income below average at age 16?</p>
</dd>
<dt>immigrant</dt><dd><p>factor. Was the respondent (or both parents)
born abroad?</p>
</dd>
</dl>



<h3>Details</h3>

<p>This subset of the US General Social Survey (GSS) for every fourth year
between 1974 and 2002 has been selected by Winkelmann and Boes (2009)
to investigate the determinants of fertility. To do so they typically
restrict their empirical analysis to the women for which the completed
fertility is (assumed to be) known, employing the common cutoff of 40 years.
Both, the average number of children borne to a woman and the probability
of being childless, are of interest.
</p>


<h3>Source</h3>

<p>Online complements to Winkelmann and Boes (2009).
</p>


<h3>References</h3>

<p>Winkelmann, R., and Boes, S. (2009). <em>Analysis of Microdata</em>, 2nd ed. Berlin and Heidelberg: Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WinkelmannBoes2009">WinkelmannBoes2009</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## completed fertility subset
data("GSS7402", package = "AER")
gss40 &lt;- subset(GSS7402, age &gt;= 40)

## Chapter 1
## exploratory statistics
gss_kids &lt;- prop.table(table(gss40$kids))
names(gss_kids)[9] &lt;- "8+"

gss_zoo &lt;- as.matrix(with(gss40, cbind(
  tapply(kids, year, mean),
  tapply(kids, year, function(x) mean(x &lt;= 0)),
  tapply(education, year, mean))))
colnames(gss_zoo) &lt;- c("Number of children",
  "Proportion childless", "Years of schooling")
gss_zoo &lt;- zoo(gss_zoo, sort(unique(gss40$year)))

## visualizations instead of tables
barplot(gss_kids,
  xlab = "Number of children ever borne to women (age 40+)",
  ylab = "Relative frequencies")

library("lattice")
trellis.par.set(theme = canonical.theme(color = FALSE))
print(xyplot(gss_zoo[,3:1], type = "b", xlab = "Year"))


## Chapter 3, Example 3.14
## Table 3.1
gss40$nokids &lt;- factor(gss40$kids &lt;= 0, levels = c(FALSE, TRUE), labels = c("no", "yes"))
gss40$trend &lt;- gss40$year - 1974
nokids_p1 &lt;- glm(nokids ~ 1, data = gss40, family = binomial(link = "probit"))
nokids_p2 &lt;- glm(nokids ~ trend, data = gss40, family = binomial(link = "probit"))
nokids_p3 &lt;- glm(nokids ~ trend + education + ethnicity + siblings,
  data = gss40, family = binomial(link = "probit"))
lrtest(nokids_p1, nokids_p2, nokids_p3)


## Chapter 4, Figure 4.4
library("effects")
nokids_p3_ef &lt;- effect("education", nokids_p3, xlevels = list(education = 0:20))
plot(nokids_p3_ef, rescale.axis = FALSE, ylim = c(0, 0.3))


## Chapter 8, Example 8.11
kids_pois &lt;- glm(kids ~ education + trend + ethnicity + immigrant + lowincome16 + city16,
  data = gss40, family = poisson)
library("MASS")
kids_nb &lt;- glm.nb(kids ~ education + trend + ethnicity + immigrant + lowincome16 + city16,
  data = gss40)
lrtest(kids_pois, kids_nb)


## More examples can be found in:
## help("WinkelmannBoes2009")
</code></pre>

<hr>
<h2 id='Guns'>More Guns, Less Crime?</h2><span id='topic+Guns'></span>

<h3>Description</h3>

<p>Guns is a balanced panel of data on 50 US states, plus the District of Columbia (for a
total of 51 states), by year for 1977&ndash;1999.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Guns")</code></pre>


<h3>Format</h3>

<p>A data frame containing 1,173 observations on 13 variables.
</p>

<dl>
<dt>state</dt><dd><p>factor indicating state.</p>
</dd>
<dt>year</dt><dd><p>factor indicating year.</p>
</dd>
<dt>violent</dt><dd><p>violent crime rate (incidents per 100,000 members of the population).</p>
</dd>
<dt>murder</dt><dd><p>murder rate (incidents per 100,000).</p>
</dd>
<dt>robbery</dt><dd><p>robbery rate (incidents per 100,000).</p>
</dd>
<dt>prisoners</dt><dd><p>incarceration rate in the state in the previous year
(sentenced prisoners per 100,000 residents; value for the previous year).</p>
</dd>
<dt>afam</dt><dd><p>percent of state population that is African-American, ages 10 to 64.</p>
</dd>
<dt>cauc</dt><dd><p>percent of state population that is Caucasian, ages 10 to 64.</p>
</dd>
<dt>male</dt><dd><p>percent of state population that is male, ages 10 to 29.</p>
</dd>
<dt>population</dt><dd><p>state population, in millions of people.</p>
</dd>
<dt>income</dt><dd><p>real per capita personal income in the state (US dollars).</p>
</dd>
<dt>density</dt><dd><p>population per square mile of land area, divided by 1,000.</p>
</dd>
<dt>law</dt><dd><p>factor. Does the state have a shall carry law in effect in that year?</p>
</dd>
</dl>



<h3>Details</h3>

<p>Each observation is a given state in a given year. 
There are a total of 51 states times 23 years = 1,173 observations.
</p>


<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Ayres, I., and Donohue, J.J. (2003). Shooting Down the &lsquo;More Guns Less Crime&rsquo; Hypothesis.
<em>Stanford Law Review</em>, <b>55</b>, 1193&ndash;1312.
</p>
<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## data
data("Guns")

## visualization
library("lattice")
xyplot(log(violent) ~ as.numeric(as.character(year)) | state, data = Guns, type = "l")

## Stock &amp; Watson (2007), Empirical Exercise 10.1, pp. 376--377
fm1 &lt;- lm(log(violent) ~ law, data = Guns)
coeftest(fm1, vcov = sandwich)

fm2 &lt;- lm(log(violent) ~ law + prisoners + density + income + 
  population + afam + cauc + male, data = Guns)
coeftest(fm2, vcov = sandwich)

fm3 &lt;- lm(log(violent) ~ law + prisoners + density + income + 
  population + afam + cauc + male + state, data = Guns)
printCoefmat(coeftest(fm3, vcov = sandwich)[1:9,])
            
fm4 &lt;- lm(log(violent) ~ law + prisoners + density + income + 
  population + afam + cauc + male + state + year, data = Guns)
printCoefmat(coeftest(fm4, vcov = sandwich)[1:9,])
</code></pre>

<hr>
<h2 id='HealthInsurance'>Medical Expenditure Panel Survey Data</h2><span id='topic+HealthInsurance'></span>

<h3>Description</h3>

<p>Cross-section data originating from the Medical Expenditure Panel Survey survey conducted in 1996.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("HealthInsurance")</code></pre>


<h3>Format</h3>

<p>A data frame containing 8,802 observations on 11 variables.
</p>

<dl>
<dt>health</dt><dd><p>factor. Is the self-reported health status &ldquo;healthy&rdquo;?.</p>
</dd>
<dt>age</dt><dd><p>age in years.</p>
</dd>
<dt>limit</dt><dd><p>factor. Is there any limitation?</p>
</dd>
<dt>gender</dt><dd><p>factor indicating gender.</p>
</dd>
<dt>insurance</dt><dd><p>factor. Does the individual have a health insurance?</p>
</dd>
<dt>married</dt><dd><p>factor. Is the individual married?</p>
</dd>
<dt>selfemp</dt><dd><p>factor. Is the individual self-employed?</p>
</dd>
<dt>family</dt><dd><p>family size.</p>
</dd>
<dt>region</dt><dd><p>factor indicating region.</p>
</dd>
<dt>ethnicity</dt><dd><p>factor indicating ethnicity: African-American, Caucasian, other.</p>
</dd>
<dt>education</dt><dd><p>factor indicating highest degree attained:
no degree, GED (high school equivalent), high school, bachelor, master, PhD, other.</p>
</dd>
</dl>



<h3>Details</h3>

<p>This is a subset of the data used in Perry and Rosen (2004).
</p>


<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Perry, C. and Rosen, H.S. (2004). &ldquo;The Self-Employed are Less Likely than
Wage-Earners to Have Health Insurance. So What?&rdquo; in
Holtz-Eakin, D. and Rosen, H.S. (eds.), <em>Entrepeneurship and
Public Policy</em>, MIT Press. 
</p>
<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("HealthInsurance")
summary(HealthInsurance)
prop.table(xtabs(~ selfemp + insurance, data = HealthInsurance), 1)
</code></pre>

<hr>
<h2 id='HMDA'>Home Mortgage Disclosure Act Data</h2><span id='topic+HMDA'></span>

<h3>Description</h3>

<p>Cross-section data on the Home Mortgage Disclosure Act (HMDA).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("HMDA")</code></pre>


<h3>Format</h3>

<p>A data frame containing 2,380 observations on 14 variables.
</p>

<dl>
<dt>deny</dt><dd><p>Factor. Was the mortgage denied?</p>
</dd>
<dt>pirat</dt><dd><p>Payments to income ratio.</p>
</dd>    
<dt>hirat</dt><dd><p>Housing expense to income ratio.</p>
</dd>
<dt>lvrat</dt><dd><p>Loan to value ratio.</p>
</dd>
<dt>chist</dt><dd><p>Factor. Credit history: consumer payments.</p>
</dd>      
<dt>mhist</dt><dd><p>Factor. Credit history: mortgage payments.</p>
</dd>          
<dt>phist</dt><dd><p>Factor. Public bad credit record?</p>
</dd>    
<dt>unemp</dt><dd><p>1989 Massachusetts unemployment rate in applicant's industry.</p>
</dd>    
<dt>selfemp</dt><dd><p>Factor. Is the individual self-employed?</p>
</dd>  
<dt>insurance</dt><dd><p>Factor. Was the individual denied mortgage insurance?</p>
</dd>  
<dt>condomin</dt><dd><p>Factor. Is the unit a condominium?</p>
</dd>    
<dt>afam</dt><dd><p>Factor. Is the individual African-American?</p>
</dd>  
<dt>single</dt><dd><p>Factor. Is the individual single?</p>
</dd>    
<dt>hschool</dt><dd><p>Factor. Does the individual have a high-school diploma?</p>
</dd>    
</dl>



<h3>Details</h3>

<p>Only includes variables used by Stock and Watson (2007), 
some of which had to be generated from the raw data.
</p>


<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Munnell, A. H., Tootell, G. M. B., Browne, L. E. and McEneaney, J. (1996). 
Mortgage Lending in Boston: Interpreting HMDA Data. <em>American Economic Review</em>, <b>86</b>, 25&ndash;53.
</p>
<p>Stock, J. H. and Watson, M. W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("HMDA")

## Stock and Watson (2007)
## Equations 11.1, 11.3, 11.7, 11.8 and 11.10, pp. 387--395
fm1 &lt;- lm(I(as.numeric(deny) - 1) ~ pirat, data = HMDA)
fm2 &lt;- lm(I(as.numeric(deny) - 1) ~ pirat + afam, data = HMDA)
fm3 &lt;- glm(deny ~ pirat, family = binomial(link = "probit"), data = HMDA)
fm4 &lt;- glm(deny ~ pirat + afam, family = binomial(link = "probit"), data = HMDA)
fm5 &lt;- glm(deny ~ pirat + afam, family = binomial(link = "logit"), data = HMDA)

## More examples can be found in:
## help("StockWatson2007")
</code></pre>

<hr>
<h2 id='HousePrices'>House Prices in the City of Windsor, Canada</h2><span id='topic+HousePrices'></span>

<h3>Description</h3>

<p>Sales prices of houses sold in the city of Windsor, Canada, during July, August and September, 1987.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("HousePrices")</code></pre>


<h3>Format</h3>

<p>A data frame containing 546 observations on 12 variables.
</p>

<dl>
<dt>price</dt><dd><p>Sale price of a house.</p>
</dd>
<dt>lotsize</dt><dd><p>Lot size of a property in square feet.</p>
</dd>
<dt>bedrooms</dt><dd><p>Number of bedrooms.</p>
</dd>
<dt>bathrooms</dt><dd><p>Number of full bathrooms.</p>
</dd>
<dt>stories</dt><dd><p>Number of stories excluding basement.</p>
</dd>
<dt>driveway</dt><dd><p>Factor. Does the house have a driveway?</p>
</dd>
<dt>recreation</dt><dd><p>Factor. Does the house have a recreational room?</p>
</dd>
<dt>fullbase</dt><dd><p>Factor. Does the house have a full finished basement?</p>
</dd>
<dt>gasheat</dt><dd><p>Factor. Does the house use gas for hot water heating?</p>
</dd>
<dt>aircon</dt><dd><p>Factor. Is there central air conditioning?</p>
</dd>
<dt>garage</dt><dd><p>Number of garage places.</p>
</dd>
<dt>prefer</dt><dd><p>Factor. Is the house located in the preferred neighborhood of the city?</p>
</dd>
</dl>



<h3>Source</h3>

<p>Journal of Applied Econometrics Data Archive. 
</p>
<p><a href="http://qed.econ.queensu.ca/jae/1996-v11.6/anglin-gencay/">http://qed.econ.queensu.ca/jae/1996-v11.6/anglin-gencay/</a>
</p>


<h3>References</h3>

<p>Anglin, P., and Gencay, R. (1996). Semiparametric Estimation of a Hedonic Price Function. 
<em>Journal of Applied Econometrics</em>, <b>11</b>, 633&ndash;648.
</p>
<p>Verbeek, M. (2004). <em>A Guide to Modern Econometrics</em>, 2nd ed. Chichester, UK: John Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("HousePrices")

### Anglin + Gencay (1996), Table II
fm_ag &lt;- lm(log(price) ~ driveway + recreation + fullbase + gasheat + 
  aircon + garage + prefer + log(lotsize) + log(bedrooms) + 
  log(bathrooms) + log(stories), data = HousePrices)

### Anglin + Gencay (1996), Table III
fm_ag2 &lt;- lm(log(price) ~ driveway + recreation + fullbase + gasheat + 
  aircon + garage + prefer + log(lotsize) + bedrooms + 
  bathrooms + stories, data = HousePrices)

### Verbeek (2004), Table 3.1
fm &lt;- lm(log(price) ~ log(lotsize) + bedrooms + bathrooms + aircon, data = HousePrices)
summary(fm)

### Verbeek (2004), Table 3.2
fm_ext &lt;- lm(log(price) ~ . - lotsize + log(lotsize), data = HousePrices)
summary(fm_ext)

### Verbeek (2004), Table 3.3
fm_lin &lt;- lm(price ~ . , data = HousePrices)
summary(fm_lin)
</code></pre>

<hr>
<h2 id='ivreg'>Instrumental-Variable Regression</h2><span id='topic+ivreg'></span><span id='topic+print.ivreg'></span>

<h3>Description</h3>

<p>Fit instrumental-variable regression by two-stage least squares. This
is equivalent to direct instrumental-variables estimation when the number of
instruments is equal to the number of predictors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ivreg(formula, instruments, data, subset, na.action, weights, offset,
  contrasts = NULL, model = TRUE, y = TRUE, x = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ivreg_+3A_formula">formula</code>, <code id="ivreg_+3A_instruments">instruments</code></td>
<td>
<p>formula specification(s) of the regression
relationship and the instruments. Either <code>instruments</code> is missing and
<code>formula</code> has three parts as in <code>y ~ x1 + x2 | z1 + z2 + z3</code>
(recommended) or <code>formula</code> is <code>y ~ x1 + x2</code> and <code>instruments</code>
is a one-sided formula <code>~ z1 + z2 + z3</code> (only for backward compatibility).</p>
</td></tr>
<tr><td><code id="ivreg_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model. 
By default the variables are taken from the environment of the <code>formula</code>.</p>
</td></tr>
<tr><td><code id="ivreg_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used in 
fitting the model.</p>
</td></tr>
<tr><td><code id="ivreg_+3A_na.action">na.action</code></td>
<td>
<p>a function that indicates what should happen when the 
data contain <code>NA</code>s. The default is set by the <code>na.action</code> option.</p>
</td></tr>
<tr><td><code id="ivreg_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="ivreg_+3A_offset">offset</code></td>
<td>
<p>an optional offset that can be used to specify an a priori known
component to be included during fitting.</p>
</td></tr>       
<tr><td><code id="ivreg_+3A_contrasts">contrasts</code></td>
<td>
<p>an optional list. See the <code>contrasts.arg</code> of 
<code><a href="stats.html#topic+model.matrix">model.matrix.default</a></code>.</p>
</td></tr>
<tr><td><code id="ivreg_+3A_model">model</code>, <code id="ivreg_+3A_x">x</code>, <code id="ivreg_+3A_y">y</code></td>
<td>
<p>logicals.  If <code>TRUE</code> the corresponding components of
the fit (the model frame, the model matrices , the response) are returned.</p>
</td></tr>
<tr><td><code id="ivreg_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="#topic+ivreg.fit">ivreg.fit</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ivreg</code> is the high-level interface to the work-horse function <code><a href="#topic+ivreg.fit">ivreg.fit</a></code>,
a set of standard methods (including <code>print</code>, <code>summary</code>, <code>vcov</code>, <code>anova</code>,
<code>hatvalues</code>, <code>predict</code>, <code>terms</code>, <code>model.matrix</code>, <code>bread</code>,
<code>estfun</code>) is available and described on <code><a href="#topic+summary.ivreg">summary.ivreg</a></code>.
</p>
<p>Regressors and instruments for <code>ivreg</code> are most easily specified in a formula
with two parts on the right-hand side, e.g., <code>y ~ x1 + x2 | z1 + z2 + z3</code>,
where <code>x1</code> and <code>x2</code> are the regressors and <code>z1</code>,
<code>z2</code>, and <code>z3</code> are the instruments. Note that exogenous
regressors have to be included as instruments for themselves. For
example, if there is one exogenous regressor <code>ex</code> and one endogenous
regressor <code>en</code> with instrument <code>in</code>, the appropriate formula
would be <code>y ~ ex + en | ex + in</code>. Equivalently, this can be specified as
<code>y ~ ex + en | . - en + in</code>, i.e., by providing an update formula with a
<code>.</code> in the second part of the formula. The latter is typically more convenient,
if there is a large number of exogenous regressors.
</p>


<h3>Value</h3>

<p><code>ivreg</code> returns an object of class <code>"ivreg"</code>, with the following components:
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>parameter estimates.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>a vector of residuals.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>a vector of predicted means.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>either the vector of weights used (if any) or <code>NULL</code> (if none).</p>
</td></tr>
<tr><td><code>offset</code></td>
<td>
<p>either the offset used (if any) or <code>NULL</code> (if none).</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code>nobs</code></td>
<td>
<p>number of observations with non-zero weights.</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>the numeric rank of the fitted linear model.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>residual degrees of freedom for fitted model.</p>
</td></tr>
<tr><td><code>cov.unscaled</code></td>
<td>
<p>unscaled covariance matrix for the coefficients.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>residual standard error.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the original function call.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>the model formula.</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>a list with elements <code>"regressors"</code> and <code>"instruments"</code>
containing the terms objects for the respective components.</p>
</td></tr>
<tr><td><code>levels</code></td>
<td>
<p>levels of the categorical regressors.</p>
</td></tr>
<tr><td><code>contrasts</code></td>
<td>
<p>the contrasts used for categorical regressors.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the full model frame (if <code>model = TRUE</code>).</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the response vector (if <code>y = TRUE</code>).</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>a list with elements <code>"regressors"</code>, <code>"instruments"</code>, <code>"projected"</code>,
containing the model matrices from the respective components
(if <code>x = TRUE</code>). <code>"projected"</code> is the matrix of regressors projected
on the image of the instruments.</p>
</td></tr>
</table>


<h3>References</h3>

    
<p>Greene, W. H. (1993)
<em>Econometric Analysis</em>, 2nd ed., Macmillan.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ivreg.fit">ivreg.fit</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="stats.html#topic+lmfit">lm.fit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## data
data("CigarettesSW", package = "AER")
CigarettesSW &lt;- transform(CigarettesSW,
  rprice  = price/cpi,
  rincome = income/population/cpi,
  tdiff   = (taxs - tax)/cpi
)

## model 
fm &lt;- ivreg(log(packs) ~ log(rprice) + log(rincome) | log(rincome) + tdiff + I(tax/cpi),
  data = CigarettesSW, subset = year == "1995")
summary(fm)
summary(fm, vcov = sandwich, df = Inf, diagnostics = TRUE)

## ANOVA
fm2 &lt;- ivreg(log(packs) ~ log(rprice) | tdiff, data = CigarettesSW, subset = year == "1995")
anova(fm, fm2)
</code></pre>

<hr>
<h2 id='ivreg.fit'>Fitting Instrumental-Variable Regressions</h2><span id='topic+ivreg.fit'></span>

<h3>Description</h3>

<p>Fit instrumental-variable regression by two-stage least squares. This
is equivalent to direct instrumental-variables estimation when the number of
instruments is equal to the number of predictors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ivreg.fit(x, y, z, weights, offset, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ivreg.fit_+3A_x">x</code></td>
<td>
<p>regressor matrix.</p>
</td></tr>
<tr><td><code id="ivreg.fit_+3A_y">y</code></td>
<td>
<p>vector with dependent variable.</p>
</td></tr>
<tr><td><code id="ivreg.fit_+3A_z">z</code></td>
<td>
<p>instruments matrix.</p>
</td></tr>
<tr><td><code id="ivreg.fit_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="ivreg.fit_+3A_offset">offset</code></td>
<td>
<p>an optional offset that can be used to specify an a priori known
component to be included during fitting.</p>
</td></tr>       
<tr><td><code id="ivreg.fit_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="stats.html#topic+lmfit">lm.fit</a></code> or
<code><a href="stats.html#topic+lmfit">lm.wfit</a></code>, respectively.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+ivreg">ivreg</a></code> is the high-level interface to the work-horse function <code>ivreg.fit</code>,
a set of standard methods (including <code>summary</code>, <code>vcov</code>, <code>anova</code>,
<code>hatvalues</code>, <code>predict</code>, <code>terms</code>, <code>model.matrix</code>, <code>bread</code>,
<code>estfun</code>) is available and described on <code><a href="#topic+summary.ivreg">summary.ivreg</a></code>.
</p>
<p><code>ivreg.fit</code> is a convenience interface to <code><a href="stats.html#topic+lmfit">lm.fit</a></code> (or <code><a href="stats.html#topic+lmfit">lm.wfit</a></code>)
for first projecting <code>x</code> onto the image of <code>z</code> and the running 
a regression of <code>y</code> onto the projected <code>x</code>.
</p>


<h3>Value</h3>

<p><code>ivreg.fit</code> returns an unclassed list with the following components:
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>parameter estimates.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>a vector of residuals.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>a vector of predicted means.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>either the vector of weights used (if any) or <code>NULL</code> (if none).</p>
</td></tr>
<tr><td><code>offset</code></td>
<td>
<p>either the offset used (if any) or <code>NULL</code> (if none).</p>
</td></tr>
<tr><td><code>estfun</code></td>
<td>
<p>a matrix containing the empirical estimating functions.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code>nobs</code></td>
<td>
<p>number of observations with non-zero weights.</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>the numeric rank of the fitted linear model.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>residual degrees of freedom for fitted model.</p>
</td></tr>
<tr><td><code>cov.unscaled</code></td>
<td>
<p>unscaled covariance matrix for the coefficients.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>residual standard error.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+ivreg">ivreg</a></code>, <code><a href="stats.html#topic+lmfit">lm.fit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## data
data("CigarettesSW")
CigarettesSW &lt;- transform(CigarettesSW,
  rprice  = price/cpi,
  rincome = income/population/cpi,
  tdiff   = (taxs - tax)/cpi
)

## high-level interface
fm &lt;- ivreg(log(packs) ~ log(rprice) + log(rincome) | log(rincome) + tdiff + I(tax/cpi),
  data = CigarettesSW, subset = year == "1995")

## low-level interface
y &lt;- fm$y
x &lt;- model.matrix(fm, component = "regressors")
z &lt;- model.matrix(fm, component = "instruments")
ivreg.fit(x, y, z)$coefficients
</code></pre>

<hr>
<h2 id='Journals'>Economics Journal Subscription Data</h2><span id='topic+Journals'></span>

<h3>Description</h3>

<p>Subscriptions to economics journals at US libraries, for the year 2000.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Journals")</code></pre>


<h3>Format</h3>

<p>A data frame containing 180 observations on 10 variables.
</p>

<dl>
<dt>title</dt><dd><p>Journal title.</p>
</dd>
<dt>publisher</dt><dd><p>factor with publisher name.</p>
</dd>
<dt>society</dt><dd><p>factor. Is the journal published by a scholarly society?</p>
</dd>
<dt>price</dt><dd><p>Library subscription price.</p>
</dd>
<dt>pages</dt><dd><p>Number of pages.</p>
</dd>
<dt>charpp</dt><dd><p>Characters per page.</p>
</dd>
<dt>citations</dt><dd><p>Total number of citations.</p>
</dd>
<dt>foundingyear</dt><dd><p>Year journal was founded.</p>
</dd>
<dt>subs</dt><dd><p>Number of library subscriptions.</p>
</dd>
<dt>field</dt><dd><p>factor with field description.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Data on 180 economic journals, collected in particular for analyzing journal
pricing. See also <a href="https://econ.ucsb.edu/~tedb/Journals/jpricing.html">https://econ.ucsb.edu/~tedb/Journals/jpricing.html</a>
for general information on this topic as well as a more up-to-date version of
the data set. This version is taken from Stock and Watson (2007).
</p>
<p>The data as obtained from the online complements for Stock and Watson (2007)
contained two journals with title &ldquo;World Development&rdquo;. One of these (observation 80)
seemed to be an error and was changed to &ldquo;The World Economy&rdquo;.
</p>


<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Bergstrom, T. (2001). Free Labor for Costly Journals? <em>Journal of Economic Perspectives</em>, 15, 183&ndash;198.
</p>
<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## data and transformed variables
data("Journals")
journals &lt;- Journals[, c("subs", "price")]
journals$citeprice &lt;- Journals$price/Journals$citations
journals$age &lt;- 2000 - Journals$foundingyear
journals$chars &lt;- Journals$charpp*Journals$pages/10^6

## Stock and Watson (2007)
## Figure 8.9 (a) and (b)
plot(subs ~ citeprice, data = journals, pch = 19)
plot(log(subs) ~ log(citeprice), data = journals, pch = 19)
fm1 &lt;- lm(log(subs) ~ log(citeprice), data = journals)
abline(fm1)

## Table 8.2, use HC1 for comparability with Stata 
fm2 &lt;- lm(subs ~ citeprice + age + chars, data = log(journals))
fm3 &lt;- lm(subs ~ citeprice + I(citeprice^2) + I(citeprice^3) +
  age + I(age * citeprice) + chars, data = log(journals))
fm4 &lt;- lm(subs ~ citeprice + age + I(age * citeprice) + chars, data = log(journals))
coeftest(fm1, vcov = vcovHC(fm1, type = "HC1"))
coeftest(fm2, vcov = vcovHC(fm2, type = "HC1"))
coeftest(fm3, vcov = vcovHC(fm3, type = "HC1"))
coeftest(fm4, vcov = vcovHC(fm4, type = "HC1"))
waldtest(fm3, fm4, vcov = vcovHC(fm3, type = "HC1"))

## changes with respect to age
library("strucchange")
## Nyblom-Hansen test
scus &lt;- gefp(subs ~ citeprice, data = log(journals), fit = lm, order.by = ~ age)
plot(scus, functional = meanL2BB)
## estimate breakpoint(s)
journals &lt;- journals[order(journals$age),]
bp &lt;- breakpoints(subs ~ citeprice, data = log(journals), h = 20)
plot(bp)
bp.age &lt;- journals$age[bp$breakpoints]
## visualization
plot(subs ~ citeprice, data = log(journals), pch = 19, col = (age &gt; log(bp.age)) + 1)
abline(coef(bp)[1,], col = 1)
abline(coef(bp)[2,], col = 2)
legend("bottomleft", legend = c("age &gt; 18", "age &lt; 18"), lty = 1, col = 2:1, bty = "n")
</code></pre>

<hr>
<h2 id='KleinI'>Klein Model I</h2><span id='topic+KleinI'></span>

<h3>Description</h3>

<p>Klein's Model I for the US economy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("KleinI")</code></pre>


<h3>Format</h3>

<p>An annual multiple time series from 1920 to 1941 with 9 variables.
</p>

<dl>
<dt>consumption</dt><dd><p>Consumption.</p>
</dd>
<dt>cprofits</dt><dd><p>Corporate profits.</p>
</dd>
<dt>pwage</dt><dd><p>Private wage bill.</p>
</dd>
<dt>invest</dt><dd><p>Investment.</p>
</dd>
<dt>capital</dt><dd><p>Previous year's capital stock.</p>
</dd>
<dt>gnp</dt><dd><p>Gross national product.</p>
</dd>    
<dt>gwage</dt><dd><p>Government wage bill.</p>
</dd>
<dt>gexpenditure</dt><dd><p>Government spending.</p>
</dd>
<dt>taxes</dt><dd><p>Taxes.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Greene (2003). Table F15.1.
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>
<p>Klein, L. (1950). <em>Economic Fluctuations in the United States, 1921&ndash;1941</em>. New York: John Wiley.
</p>
<p>Maddala, G.S. (1977). <em>Econometrics</em>. New York: McGraw-Hill.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("KleinI", package = "AER")
plot(KleinI)

## Greene (2003), Tab. 15.3, OLS
library("dynlm")
fm_cons &lt;- dynlm(consumption ~ cprofits + L(cprofits) + I(pwage + gwage), data = KleinI)
fm_inv &lt;- dynlm(invest ~ cprofits + L(cprofits) + capital, data = KleinI)
fm_pwage &lt;- dynlm(pwage ~ gnp + L(gnp) + I(time(gnp) - 1931), data = KleinI)
summary(fm_cons)
summary(fm_inv)
summary(fm_pwage)

## More examples can be found in:
## help("Greene2003")
</code></pre>

<hr>
<h2 id='Longley'>Longley's Regression Data</h2><span id='topic+Longley'></span>

<h3>Description</h3>

<p>US macroeconomic time series, 1947&ndash;1962.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Longley")</code></pre>


<h3>Format</h3>

<p>An annual multiple time series from 1947 to 1962 with 4 variables.
</p>

<dl>
<dt>employment</dt><dd><p>Number of people employed (in 1000s).</p>
</dd>
<dt>price</dt><dd><p>GNP deflator.</p>
</dd>
<dt>gnp</dt><dd><p>Gross national product.</p>
</dd>
<dt>armedforces</dt><dd><p>Number of people in the armed forces.</p>
</dd>
</dl>



<h3>Details</h3>

<p>An extended version of this data set, formatted as a <code>"data.frame"</code>
is available as <code><a href="datasets.html#topic+longley">longley</a></code> in base R.
</p>


<h3>Source</h3>

<p>Online complements to Greene (2003). Table F4.2.
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>
<p>Longley, J.W. (1967). An Appraisal of Least-Squares Programs from the Point of View of the User.
<em>Journal of the American Statistical Association</em>, <b>62</b>, 819&ndash;841.
</p>


<h3>See Also</h3>

<p><code><a href="datasets.html#topic+longley">longley</a></code>, <code><a href="#topic+Greene2003">Greene2003</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("Longley")
library("dynlm")

## Example 4.6 in Greene (2003)
fm1 &lt;- dynlm(employment ~ time(employment) + price + gnp + armedforces,
  data = Longley)
fm2 &lt;- update(fm1, end = 1961)
cbind(coef(fm2), coef(fm1))

## Figure 4.3 in Greene (2003)
plot(rstandard(fm2), type = "b", ylim = c(-3, 3))
abline(h = c(-2, 2), lty = 2)
</code></pre>

<hr>
<h2 id='ManufactCosts'>Manufacturing Costs Data</h2><span id='topic+ManufactCosts'></span>

<h3>Description</h3>

<p>US time series data on prices and cost shares in manufacturing, 1947&ndash;1971.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ManufactCosts")</code></pre>


<h3>Format</h3>

<p>An annual multiple time series from 1947 to 1971 with 9 variables.
</p>

<dl>
<dt>cost</dt><dd><p>Cost index.</p>
</dd>
<dt>capitalcost</dt><dd><p>Capital cost share.</p>
</dd>
<dt>laborcost</dt><dd><p>Labor cost share.</p>
</dd>
<dt>energycost</dt><dd><p>Energy cost share.</p>
</dd>
<dt>materialscost</dt><dd><p>Materials cost share.</p>
</dd>
<dt>capitalprice</dt><dd><p>Capital price.</p>
</dd>
<dt>laborprice</dt><dd><p>Labor price.</p>
</dd>
<dt>energyprice</dt><dd><p>Energy price.</p>
</dd>
<dt>materialsprice</dt><dd><p>Materials price.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Greene (2003).
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Berndt, E. and Wood, D. (1975). Technology, Prices, and the Derived Demand for Energy.
<em>Review of Economics and Statistics</em>, <b>57</b>, 376&ndash;384.
</p>
<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ManufactCosts")
plot(ManufactCosts)
</code></pre>

<hr>
<h2 id='MarkDollar'>DEM/USD Exchange Rate Returns</h2><span id='topic+MarkDollar'></span>

<h3>Description</h3>

<p>A time series of intra-day percentage returns of Deutsche mark/US dollar (DEM/USD)
exchange rates, consisting of two observations per day from 1992-10-01 through 1993-09-29.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("MarkDollar")</code></pre>


<h3>Format</h3>

<p>A univariate time series of 518 returns (exact dates unknown) for the DEM/USD exchange rate.
</p>


<h3>Source</h3>

<p>Journal of Business &amp; Economic Statistics Data Archive. 
</p>
<p><code style="white-space: pre;">&#8288;http://www.amstat.org/publications/jbes/upload/index.cfm?fuseaction=ViewArticles&amp;pub=JBES&amp;issue=96-2-APR&#8288;</code>
</p>


<h3>References</h3>

<p>Bollerslev, T., and Ghysels, E. (1996). Periodic Autoregressive Conditional Heteroskedasticity.  
<em>Journal of Business &amp; Economic Statistics</em>,
<b>14</b>, 139&ndash;151.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MarkPound">MarkPound</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
library("tseries")
data("MarkDollar")

## GARCH(1,1)
fm &lt;- garch(MarkDollar, grad = "numerical")
summary(fm)
logLik(fm)  
</code></pre>

<hr>
<h2 id='MarkPound'>DEM/GBP Exchange Rate Returns</h2><span id='topic+MarkPound'></span>

<h3>Description</h3>

<p>A daily time series of percentage returns of Deutsche mark/British pound (DEM/GBP)
exchange rates from 1984-01-03 through 1991-12-31.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("MarkPound")</code></pre>


<h3>Format</h3>

<p>A univariate time series of 1974 returns (exact dates unknown) for the DEM/GBP exchange rate.
</p>


<h3>Details</h3>

<p>Greene (2003, Table F11.1) rounded the series to six digits while eight digits are given in
Bollerslev and Ghysels (1996). Here, we provide the original data. Using <code><a href="base.html#topic+round">round</a></code>
a series can be produced that is virtually identical to that of Greene (2003) (except for
eight observations where a slightly different rounding arithmetic was used).
</p>


<h3>Source</h3>

<p>Journal of Business &amp; Economic Statistics Data Archive. 
</p>
<p><code style="white-space: pre;">&#8288;http://www.amstat.org/publications/jbes/upload/index.cfm?fuseaction=ViewArticles&amp;pub=JBES&amp;issue=96-2-APR&#8288;</code>
</p>


<h3>References</h3>

<p>Bollerslev, T., and Ghysels, E. (1996). Periodic Autoregressive Conditional Heteroskedasticity.  
<em>Journal of Business &amp; Economic Statistics</em>,
<b>14</b>, 139&ndash;151.
</p>
<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code>, <code><a href="#topic+MarkDollar">MarkDollar</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## data as given by Greene (2003)
data("MarkPound")
mp &lt;- round(MarkPound, digits = 6)

## Figure 11.3 in Greene (2003)
plot(mp)

## Example 11.8 in Greene (2003), Table 11.5
library("tseries")
mp_garch &lt;- garch(mp, grad = "numerical")
summary(mp_garch)
logLik(mp_garch)  
## Greene (2003) also includes a constant and uses different
## standard errors (presumably computed from Hessian), here
## OPG standard errors are used. garchFit() in "fGarch"
## implements the approach used by Greene (2003).

## compare Errata to Greene (2003)
library("dynlm")
res &lt;- residuals(dynlm(mp ~ 1))^2
mp_ols &lt;- dynlm(res ~ L(res, 1:10))
summary(mp_ols)
logLik(mp_ols)
summary(mp_ols)$r.squared * length(residuals(mp_ols))
</code></pre>

<hr>
<h2 id='MASchools'>Massachusetts Test Score Data</h2><span id='topic+MASchools'></span>

<h3>Description</h3>

<p>The dataset contains data on test performance, school 
characteristics and student demographic backgrounds for school districts 
in Massachusetts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("MASchools")</code></pre>


<h3>Format</h3>

<p>A data frame containing 220 observations on 16 variables.
</p>

<dl>
<dt>district</dt><dd><p>character. District code.</p>
</dd>
<dt>municipality</dt><dd><p>character. Municipality name.</p>
</dd>
<dt>expreg</dt><dd><p>Expenditures per pupil, regular.</p>
</dd>
<dt>expspecial</dt><dd><p>Expenditures per pupil, special needs.</p>
</dd>
<dt>expbil</dt><dd><p>Expenditures per pupil, bilingual.</p>
</dd>
<dt>expocc</dt><dd><p>Expenditures per pupil, occupational.</p>
</dd>
<dt>exptot</dt><dd><p>Expenditures per pupil, total.</p>
</dd>   
<dt>scratio</dt><dd><p>Students per computer.</p>
</dd>
<dt>special</dt><dd><p>Special education students (per cent).</p>
</dd>
<dt>lunch</dt><dd><p>Percent qualifying for reduced-price lunch.</p>
</dd>
<dt>stratio</dt><dd><p>Student-teacher ratio.</p>
</dd>
<dt>income</dt><dd><p>Per capita income.</p>
</dd>
<dt>score4</dt><dd><p>4th grade score (math + English + science).</p>
</dd>
<dt>score8</dt><dd><p>8th grade score (math + English + science).</p>
</dd>  
<dt>salary</dt><dd><p>Average teacher salary.</p>
</dd>
<dt>english</dt><dd><p>Percent of English learners.</p>
</dd>  
</dl>



<h3>Details</h3>

<p>The Massachusetts data are district-wide averages for 
public elementary school districts in 1998. The test score is taken 
from the Massachusetts Comprehensive Assessment System (MCAS) test, 
administered to all fourth graders in Massachusetts public schools 
in the spring of 1998. The test is sponsored by the Massachusetts 
Department of Education and is mandatory for all public schools.  
The data analyzed here are the overall total score, which is the sum 
of the scores on the English, Math, and Science portions of the 
test. Data on the student-teacher ratio, the percent of students 
receiving a subsidized lunch and on the percent of students still 
learning english are averages for each elementary school district 
for the 1997&ndash;1998 school year and were obtained from the 
Massachusetts department of education. Data on average district 
income are from the 1990 US Census.
</p>


<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Stock, J. H. and Watson, M. W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code>, <code><a href="#topic+CASchools">CASchools</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Massachusetts
data("MASchools")

## compare with California
data("CASchools")
CASchools$stratio &lt;- with(CASchools, students/teachers)
CASchools$score4 &lt;- with(CASchools, (math + read)/2)

## Stock and Watson, parts of Table 9.1, p. 330
vars &lt;- c("score4", "stratio", "english", "lunch", "income")
cbind(
  CA_mean = sapply(CASchools[, vars], mean),
  CA_sd   = sapply(CASchools[, vars], sd),
  MA_mean = sapply(MASchools[, vars], mean),
  MA_sd   = sapply(MASchools[, vars], sd))

## Stock and Watson, Table 9.2, p. 332, col. (1)
fm1 &lt;- lm(score4 ~ stratio, data = MASchools)
coeftest(fm1, vcov = vcovHC(fm1, type = "HC1"))

## More examples, notably the entire Table 9.2, can be found in:
## help("StockWatson2007")
</code></pre>

<hr>
<h2 id='Medicaid1986'>Medicaid Utilization Data</h2><span id='topic+Medicaid1986'></span>

<h3>Description</h3>

<p>Cross-section data originating from the 1986 Medicaid Consumer Survey. The data comprise
two groups of Medicaid eligibles at two sites in California (Santa Barbara and Ventura 
counties): a group enrolled in a managed care demonstration program and a fee-for-service 
comparison group of non-enrollees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Medicaid1986")</code></pre>


<h3>Format</h3>

<p>A data frame containing 996 observations on 14 variables.
</p>

<dl>
<dt>visits</dt><dd><p>Number of doctor visits.</p>
</dd>
<dt>exposure</dt><dd><p>Length of observation period for ambulatory care (days).</p>
</dd>
<dt>children</dt><dd><p>Total number of children in the household.</p>
</dd>
<dt>age</dt><dd><p>Age of the respondent.</p>
</dd>
<dt>income</dt><dd><p>Annual household income (average of income range in million USD).</p>
</dd>
<dt>health1</dt><dd><p>The first principal component (divided by 1000) of three
health-status variables: functional limitations, acute conditions, and chronic
conditions.</p>
</dd>
<dt>health2</dt><dd><p>The second principal component (divided by 1000) of three
health-status variables: functional limitations, acute conditions, and chronic
conditions.</p>
</dd>
<dt>access</dt><dd><p>Availability of health services (0 = low access, 1 = high access).</p>
</dd>
<dt>married</dt><dd><p>Factor. Is the individual married?</p>
</dd>   
<dt>gender</dt><dd><p>Factor indicating gender.</p>
</dd>  
<dt>ethnicity</dt><dd><p>Factor indicating ethnicity (<code>"cauc"</code> or <code>"other"</code>).</p>
</dd>
<dt>school</dt><dd><p>Number of years completed in school.</p>
</dd>
<dt>enroll</dt><dd><p>Factor. Is the individual enrolled in a demonstration program?</p>
</dd>
<dt>program</dt><dd><p>Factor indicating the managed care demonstration program:
Aid to Families with Dependent Children (<code>"afdc"</code>) or
non-institutionalized Supplementary Security Income (<code>"ssi"</code>).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Journal of Applied Econometrics Data Archive. 
</p>
<p><a href="http://qed.econ.queensu.ca/jae/1997-v12.3/gurmu/">http://qed.econ.queensu.ca/jae/1997-v12.3/gurmu/</a>
</p>


<h3>References</h3>

<p>Gurmu, S. (1997). Semi-Parametric Estimation of Hurdle Regression Models 
with an Application to Medicaid Utilization.  <em>Journal of Applied Econometrics</em>,
<b>12</b>, 225&ndash;242.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## data and packages
data("Medicaid1986")
library("MASS")
library("pscl")

## scale regressors
Medicaid1986$age2 &lt;- Medicaid1986$age^2 / 100
Medicaid1986$school &lt;- Medicaid1986$school / 10
Medicaid1986$income &lt;- Medicaid1986$income / 10

## subsets
afdc &lt;- subset(Medicaid1986, program == "afdc")[, c(1, 3:4, 15, 5:9, 11:13)]
ssi &lt;- subset(Medicaid1986, program == "ssi")[, c(1, 3:4, 15, 5:13)]

## Gurmu (1997):
## Table VI., Poisson and negbin models
afdc_pois &lt;- glm(visits ~ ., data = afdc, family = poisson)
summary(afdc_pois)
coeftest(afdc_pois, vcov = sandwich)

afdc_nb &lt;- glm.nb(visits ~ ., data = afdc)
ssi_pois &lt;- glm(visits ~ ., data = ssi, family = poisson)
ssi_nb &lt;- glm.nb(visits ~ ., data = ssi)

## Table VII., Hurdle models (without semi-parametric effects)
afdc_hurdle &lt;- hurdle(visits ~ . | . - access, data = afdc, dist = "negbin")
ssi_hurdle &lt;- hurdle(visits ~ . | . - access, data = ssi, dist = "negbin")

## Table VIII., Observed and expected frequencies
round(cbind(
  Observed = table(afdc$visits)[1:8],
  Poisson = sapply(0:7, function(x) sum(dpois(x, fitted(afdc_pois)))),
  Negbin = sapply(0:7, function(x) sum(dnbinom(x, mu = fitted(afdc_nb), size = afdc_nb$theta))),
  Hurdle = colSums(predict(afdc_hurdle, type = "prob")[,1:8])
  )/nrow(afdc), digits = 3) * 100
round(cbind(
  Observed = table(ssi$visits)[1:8],
  Poisson = sapply(0:7, function(x) sum(dpois(x, fitted(ssi_pois)))),
  Negbin = sapply(0:7, function(x) sum(dnbinom(x, mu = fitted(ssi_nb), size = ssi_nb$theta))),
  Hurdle = colSums(predict(ssi_hurdle, type = "prob")[,1:8])
  )/nrow(ssi), digits = 3) * 100
</code></pre>

<hr>
<h2 id='Mortgage'>Fixed versus Adjustable Mortgages</h2><span id='topic+Mortgage'></span>

<h3>Description</h3>

<p>Cross-section data about fixed versus adjustable mortgages for
78 households.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Mortgage")</code></pre>


<h3>Format</h3>

<p>A data frame containing 78 observations on 16 variables.
</p>

<dl>
<dt>rate</dt><dd><p>Factor with levels <code>"fixed"</code> and <code>"adjustable"</code>.</p>
</dd>
<dt>age</dt><dd><p>Age of the borrower.</p>
</dd>
<dt>school</dt><dd><p>Years of schooling for the borrower.</p>
</dd>
<dt>networth</dt><dd><p>Net worth of the borrower.</p>
</dd>
<dt>interest</dt><dd><p>Fixed interest rate.</p>
</dd>
<dt>points</dt><dd><p>Ratio of points paid on adjustable to fixed rate mortgages.</p>
</dd>
<dt>maturities</dt><dd><p>Ratio of maturities on adjustable to fixed rate mortgages.</p>
</dd>
<dt>years</dt><dd><p>Years at the present address.</p>
</dd>
<dt>married</dt><dd><p>Factor. Is the borrower married?</p>
</dd>
<dt>first</dt><dd><p>Factor. Is the borrower a first-time home buyer?</p>
</dd>
<dt>selfemp</dt><dd><p>Factor. Is the borrower self-employed?</p>
</dd>
<dt>tdiff</dt><dd><p>The difference between the 10-year treasury rate less the 1-year treasury rate.</p>
</dd>
<dt>margin</dt><dd><p>The margin on the adjustable rate mortgage.</p>
</dd>
<dt>coborrower</dt><dd><p>Factor. Is there a co-borrower?</p>
</dd>
<dt>liability</dt><dd><p>Short-term liabilities.</p>
</dd>
<dt>liquid</dt><dd><p>Liquid assets.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data is from Baltagi (2002).
</p>


<h3>References</h3>

<p>Baltagi, B.H. (2002). <em>Econometrics</em>, 3rd ed. Berlin, Springer. 
</p>
<p>Dhillon, U.S., Shilling, J.D. and Sirmans, C.F. (1987). Choosing Between Fixed and
Adjustable Rate Mortgages. <em>Journal of Money, Credit and Banking</em>, <b>19</b>, 260&ndash;267.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Baltagi2002">Baltagi2002</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Mortgage")
plot(rate ~ interest, data = Mortgage, breaks = fivenum(Mortgage$interest))
plot(rate ~ margin, data = Mortgage, breaks = fivenum(Mortgage$margin))
plot(rate ~ coborrower, data = Mortgage)
</code></pre>

<hr>
<h2 id='MotorCycles'>Motor Cycles in The Netherlands</h2><span id='topic+MotorCycles'></span>

<h3>Description</h3>

<p>Time series of stock of motor cycles (two wheels) in The Netherlands
(in thousands).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("MotorCycles")</code></pre>


<h3>Format</h3>

<p>An annual univariate time series from 1946 to 1993.
</p>


<h3>Details</h3>

<p>An updated version is available under the name <code>MotorCycles2</code>. However, the values for the years 1992 and 1993 differ there.</p>


<h3>Source</h3>

<p>Online complements to Franses (1998).
</p>


<h3>References</h3>

<p>Franses, P.H. (1998). <em>Time Series Models for Business and Economic Forecasting</em>.
Cambridge, UK: Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Franses1998">Franses1998</a></code>, <code><a href="#topic+MotorCycles2">MotorCycles2</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("MotorCycles")
plot(MotorCycles)
</code></pre>

<hr>
<h2 id='MotorCycles2'>Motor Cycles in The Netherlands</h2><span id='topic+MotorCycles2'></span>

<h3>Description</h3>

<p>Time series of stock of motor cycles (two wheels) in The Netherlands
(in thousands).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("MotorCycles2")</code></pre>


<h3>Format</h3>

<p>An annual univariate time series from 1946 to 2012.
</p>


<h3>Details</h3>

<p>This is an update of the series that was available with Franses (1998). However, the values for the years 1992 and 1993 differ.</p>


<h3>Source</h3>

<p>Online complements to Franses, van Dijk and Opschoor (2014).
</p>
<p><a href="https://www.cambridge.org/us/academic/subjects/economics/econometrics-statistics-and-mathematical-economics/time-series-models-business-and-economic-forecasting-2nd-edition">https://www.cambridge.org/us/academic/subjects/economics/econometrics-statistics-and-mathematical-economics/time-series-models-business-and-economic-forecasting-2nd-edition</a>
</p>


<h3>References</h3>

<p>Franses, P.H. (1998). <em>Time Series Models for Business and Economic Forecasting</em>.
Cambridge, UK: Cambridge University Press.
</p>
<p>Franses, P.H., van Dijk, D. and Opschoor, A. (2014). <em>Time Series Models for Business and Economic Forecasting</em>, 2nd ed.
Cambridge, UK: Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Franses1998">Franses1998</a></code>, <code><a href="#topic+MotorCycles">MotorCycles</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("MotorCycles2")
plot(MotorCycles2)
</code></pre>

<hr>
<h2 id='MSCISwitzerland'>MSCI Switzerland Index</h2><span id='topic+MSCISwitzerland'></span>

<h3>Description</h3>

<p>Time series of the MSCI Switzerland index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("MSCISwitzerland")</code></pre>


<h3>Format</h3>

<p>A daily univariate time series from 1994-12-30 to 2012-12-31 (of class <code>"zoo"</code> with <code>"Date"</code> index).
</p>


<h3>Source</h3>

<p>Online complements to Franses, van Dijk and Opschoor (2014).
</p>
<p><a href="https://www.cambridge.org/us/academic/subjects/economics/econometrics-statistics-and-mathematical-economics/time-series-models-business-and-economic-forecasting-2nd-edition">https://www.cambridge.org/us/academic/subjects/economics/econometrics-statistics-and-mathematical-economics/time-series-models-business-and-economic-forecasting-2nd-edition</a>
</p>


<h3>References</h3>

<p>Ding, Z., Granger, C. W. J. and Engle, R. F. (1993). A Long Memory Property of Stock Market Returns and a New Model. <em>Journal of Empirical Finance</em>, 1(1), 83&ndash;106.
</p>
<p>Franses, P.H., van Dijk, D. and Opschoor, A. (2014). <em>Time Series Models for Business and Economic Forecasting</em>, 2nd ed.
Cambridge, UK: Cambridge University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("MSCISwitzerland", package = "AER")

## p.190, Fig. 7.6
dlmsci &lt;- 100 * diff(log(MSCISwitzerland))
plot(dlmsci)

dlmsci9501 &lt;- window(dlmsci, end = as.Date("2001-12-31"))

## Figure 7.7
plot(acf(dlmsci9501^2, lag.max = 200, na.action = na.exclude),
  ylim = c(-0.1, 0.3), type = "l")


## GARCH(1,1) model, p.190, eq. (7.60)

## standard errors using first derivatives (as apparently used by Franses et al.)
library("tseries")
msci9501_g11 &lt;- garch(zooreg(dlmsci9501), trace = FALSE)
summary(msci9501_g11)

## standard errors using second derivatives
library("fGarch")
msci9501_g11a &lt;- garchFit( ~ garch(1,1), include.mean = FALSE,
  data = dlmsci9501, trace = FALSE)
summary(msci9501_g11a)

round(msci9501_g11a@fit$coef, 3)
round(msci9501_g11a@fit$se.coef, 3)

## Fig. 7.8, p.192
plot(msci9501_g11a, which = 2)
abline(h = sd(dlmsci9501))


## TGARCH model (also known as GJR-GARCH model), p. 191, eq. (7.61)
msci9501_tg11 &lt;- garchFit( ~ aparch(1,1), include.mean = FALSE,
  include.delta = FALSE, delta = 2, data = dlmsci9501, trace = FALSE)
summary(msci9501_tg11)

## GJR form using reparameterization as given by Ding et al. (1993, pp. 100-101)
coef(msci9501_tg11)["alpha1"] * (1 - coef(msci9501_tg11)["gamma1"])^2  ## alpha*
4 * coef(msci9501_tg11)["alpha1"] * coef(msci9501_tg11)["gamma1"]      ## gamma*

## GARCH and GJR-GARCH with rugarch

library("rugarch")
spec_g11 &lt;- ugarchspec(variance.model = list(model = "sGARCH"),
  mean.model = list(armaOrder = c(0,0), include.mean = FALSE))
msci9501_g11b &lt;- ugarchfit(spec_g11, data = dlmsci9501)
msci9501_g11b

spec_gjrg11 &lt;- ugarchspec(variance.model = list(model = "gjrGARCH", garchOrder = c(1,1)),
  mean.model = list(armaOrder = c(0, 0), include.mean = FALSE))
msci9501_gjrg11 &lt;- ugarchfit(spec_gjrg11, data = dlmsci9501)
msci9501_gjrg11

round(coef(msci9501_gjrg11), 3)

</code></pre>

<hr>
<h2 id='Municipalities'>Municipal Expenditure Data</h2><span id='topic+Municipalities'></span>

<h3>Description</h3>

<p>Panel data set for 265 Swedish municipalities covering 9 years (1979-1987).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Municipalities")</code></pre>


<h3>Format</h3>

<p>A data frame containing 2,385 observations on 5 variables.
</p>

<dl>
<dt>municipality</dt><dd><p>factor with ID number for municipality.</p>
</dd>
<dt>year</dt><dd><p>factor coding year.</p>
</dd>
<dt>expenditures</dt><dd><p>total expenditures.</p>
</dd>
<dt>revenues</dt><dd><p>total own-source revenues.</p>
</dd>
<dt>grants</dt><dd><p>intergovernmental grants received by the municipality.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Total expenditures contains both capital and current expenditures. 
</p>
<p>Expenditures, revenues, and grants are expressed in million SEK. The 
series are deflated and in per capita form. The implicit deflator is a 
municipality-specific price index obtained by dividing total local 
consumption expenditures at current prices by total local consumption 
expenditures at fixed (1985) prices. 
</p>
<p>The data are gathered by Statistics Sweden and obtained from 
Financial Accounts for the Municipalities (Kommunernas Finanser). 
</p>


<h3>Source</h3>

<p>Journal of Applied Econometrics Data Archive. 
</p>
<p><a href="http://qed.econ.queensu.ca/jae/2000-v15.4/dahlberg-johansson/">http://qed.econ.queensu.ca/jae/2000-v15.4/dahlberg-johansson/</a>
</p>


<h3>References</h3>

<p>Dahlberg, M., and Johansson, E. (2000). An Examination of the Dynamic Behavior of Local Governments Using GMM Bootstrapping Methods. 
<em>Journal of Applied Econometrics</em>, <b>15</b>, 401&ndash;416.
</p>
<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Greene (2003), Table 18.2
data("Municipalities")
summary(Municipalities)
</code></pre>

<hr>
<h2 id='MurderRates'>Determinants of Murder Rates in the United States</h2><span id='topic+MurderRates'></span>

<h3>Description</h3>

<p>Cross-section data on states in 1950.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("MurderRates")</code></pre>


<h3>Format</h3>

<p>A data frame containing 44 observations on 8 variables.
</p>

<dl>
<dt>rate</dt><dd><p>Murder rate per 100,000 (FBI estimate, 1950).</p>
</dd>
<dt>convictions</dt><dd><p>Number of convictions divided by number of murders in 1950.</p>
</dd>
<dt>executions</dt><dd><p>Average number of executions during 1946&ndash;1950 divided by convictions in 1950.</p>
</dd>
<dt>time</dt><dd><p>Median time served (in months) of convicted murderers released in 1951.</p>
</dd>   
<dt>income</dt><dd><p>Median family income in 1949 (in 1,000 USD).</p>
</dd>  
<dt>lfp</dt><dd><p>Labor force participation rate in 1950 (in percent).</p>
</dd>
<dt>noncauc</dt><dd><p>Proportion of population that is non-Caucasian in 1950.</p>
</dd>
<dt>southern</dt><dd><p>Factor indicating region.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Maddala (2001), Table 8.4, p. 330
</p>


<h3>References</h3>

<p>Maddala, G.S. (2001). <em>Introduction to Econometrics</em>, 3rd ed. New York: John Wiley.
</p>
<p>McManus, W.S. (1985). Estimates of the Deterrent Effect of Capital Punishment: 
The Importance of the Researcher's Prior Beliefs. <em>Journal of Political Economy</em>, 
<b>93</b>, 417&ndash;425.
</p>
<p>Stokes, H. (2004). On the Advantage of Using Two or More Econometric Software Systems to Solve the Same Problem.
<em>Journal of Economic and Social Measurement</em>, <b>29</b>, 307&ndash;320.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("MurderRates")

## Maddala (2001, pp. 331)
fm_lm &lt;- lm(rate ~ . + I(executions &gt; 0), data = MurderRates)
summary(fm_lm)

model &lt;- I(executions &gt; 0) ~ time + income + noncauc + lfp + southern
fm_lpm &lt;- lm(model, data = MurderRates)
summary(fm_lpm)

## Binomial models. Note: southern coefficient
fm_logit &lt;- glm(model, data = MurderRates, family = binomial)
summary(fm_logit)

fm_logit2 &lt;- glm(model, data = MurderRates, family = binomial,
  control = list(epsilon = 1e-15, maxit = 50, trace = FALSE))
summary(fm_logit2)

fm_probit &lt;- glm(model, data = MurderRates, family = binomial(link = "probit"))
summary(fm_probit)

fm_probit2 &lt;- glm(model, data = MurderRates , family = binomial(link = "probit"),
  control = list(epsilon = 1e-15, maxit = 50, trace = FALSE))
summary(fm_probit2)

## Explanation: quasi-complete separation
with(MurderRates, table(executions &gt; 0, southern))
</code></pre>

<hr>
<h2 id='NaturalGas'>Natural Gas Data</h2><span id='topic+NaturalGas'></span>

<h3>Description</h3>

<p>Panel data originating from 6 US states over the period 1967&ndash;1989.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("NaturalGas")</code></pre>


<h3>Format</h3>

<p>A data frame containing 138 observations on 10 variables.
</p>

<dl>
<dt>state</dt><dd><p>factor. State abbreviation.</p>
</dd>
<dt>statecode</dt><dd><p>factor. State Code.</p>
</dd>
<dt>year</dt><dd><p>factor coding year.</p>
</dd>
<dt>consumption</dt><dd><p>Consumption of natural gas by the residential sector.</p>
</dd>
<dt>price</dt><dd><p>Price of natural gas</p>
</dd>
<dt>eprice</dt><dd><p>Price of electricity.</p>
</dd>
<dt>oprice</dt><dd><p>Price of distillate fuel oil.</p>
</dd>
<dt>lprice</dt><dd><p>Price of liquefied petroleum gas.</p>
</dd>
<dt>heating</dt><dd><p>Heating degree days.</p>
</dd>
<dt>income</dt><dd><p>Real per-capita personal income.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data are from Baltagi (2002).
</p>


<h3>References</h3>

<p>Baltagi, B.H. (2002). <em>Econometrics</em>, 3rd ed. Berlin, Springer. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Baltagi2002">Baltagi2002</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("NaturalGas")
summary(NaturalGas)
</code></pre>

<hr>
<h2 id='NMES1988'>Demand for Medical Care in NMES 1988</h2><span id='topic+NMES1988'></span>

<h3>Description</h3>

<p>Cross-section data originating from the US National Medical Expenditure Survey (NMES) 
conducted in 1987 and 1988. The NMES is based upon a representative, national 
probability sample of the civilian non-institutionalized population and individuals 
admitted to long-term care facilities during 1987. The data are a subsample of 
individuals ages 66 and over all of whom are covered by Medicare 
(a public insurance program providing substantial protection against health-care costs).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("NMES1988")</code></pre>


<h3>Format</h3>

<p>A data frame containing 4,406 observations on 19 variables.
</p>

<dl>
<dt>visits</dt><dd><p>Number of physician office visits.</p>
</dd>
<dt>nvisits</dt><dd><p>Number of non-physician office visits.</p>
</dd>
<dt>ovisits</dt><dd><p>Number of physician hospital outpatient visits.</p>
</dd>
<dt>novisits</dt><dd><p>Number of non-physician hospital outpatient visits.</p>
</dd>
<dt>emergency</dt><dd><p>Emergency room visits.</p>
</dd>
<dt>hospital</dt><dd><p>Number of hospital stays.</p>
</dd>
<dt>health</dt><dd><p>Factor indicating self-perceived health status, levels are
<code>"poor"</code>, <code>"average"</code> (reference category), <code>"excellent"</code>.</p>
</dd>
<dt>chronic</dt><dd><p>Number of chronic conditions.</p>
</dd>
<dt>adl</dt><dd><p>Factor indicating whether the individual has a condition that
limits activities of daily living (<code>"limited"</code>) or not (<code>"normal"</code>).</p>
</dd>
<dt>region</dt><dd><p>Factor indicating region, levels are <code>northeast</code>,
<code>midwest</code>, <code>west</code>, <code>other</code> (reference category).</p>
</dd>  
<dt>age</dt><dd><p>Age in years (divided by 10).</p>
</dd>
<dt>afam</dt><dd><p>Factor. Is the individual African-American?</p>
</dd>
<dt>gender</dt><dd><p>Factor indicating gender.</p>
</dd>
<dt>married</dt><dd><p>Factor. is the individual married?</p>
</dd>
<dt>school</dt><dd><p>Number of years of education.</p>
</dd>
<dt>income</dt><dd><p>Family income in USD 10,000.</p>
</dd>
<dt>employed</dt><dd><p>Factor. Is the individual employed?</p>
</dd>
<dt>insurance</dt><dd><p>Factor. Is the individual covered by private insurance?</p>
</dd>
<dt>medicaid</dt><dd><p>Factor. Is the individual covered by Medicaid?</p>
</dd>
</dl>



<h3>Source</h3>

<p>Journal of Applied Econometrics Data Archive for Deb and Trivedi (1997). 
</p>
<p><a href="http://qed.econ.queensu.ca/jae/1997-v12.3/deb-trivedi/">http://qed.econ.queensu.ca/jae/1997-v12.3/deb-trivedi/</a>
</p>


<h3>References</h3>

<p>Cameron, A.C. and Trivedi, P.K. (1998). <em>Regression Analysis of Count Data</em>. 
Cambridge: Cambridge University Press.
</p>
<p>Deb, P., and Trivedi, P.K. (1997). Demand for Medical Care by the
Elderly: A Finite Mixture Approach. <em>Journal of Applied Econometrics</em>,
<b>12</b>, 313&ndash;336.
</p>
<p>Zeileis, A., Kleiber, C., and Jackman, S. (2008). Regression Models
for Count Data in R. <em>Journal of Statistical Software</em>, <b>27</b>(8).
<a href="https://doi.org/10.18637/jss.v027.i08">doi:10.18637/jss.v027.i08</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CameronTrivedi1998">CameronTrivedi1998</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## packages
library("MASS")
library("pscl")

## select variables for analysis
data("NMES1988")
nmes &lt;- NMES1988[, c(1, 7:8, 13, 15, 18)]

## dependent variable
hist(nmes$visits, breaks = 0:(max(nmes$visits)+1) - 0.5)
plot(table(nmes$visits))

## convenience transformations for exploratory graphics
clog &lt;- function(x) log(x + 0.5)
cfac &lt;- function(x, breaks = NULL) {
  if(is.null(breaks)) breaks &lt;- unique(quantile(x, 0:10/10))
  x &lt;- cut(x, breaks, include.lowest = TRUE, right = FALSE)
  levels(x) &lt;- paste(breaks[-length(breaks)], ifelse(diff(breaks) &gt; 1,
    c(paste("-", breaks[-c(1, length(breaks))] - 1, sep = ""), "+"), ""), sep = "")
  return(x)
}

## bivariate visualization
par(mfrow = c(3, 2))
plot(clog(visits) ~ health, data = nmes, varwidth = TRUE)
plot(clog(visits) ~ cfac(chronic), data = nmes)
plot(clog(visits) ~ insurance, data = nmes, varwidth = TRUE)
plot(clog(visits) ~ gender, data = nmes, varwidth = TRUE)
plot(cfac(visits, c(0:2, 4, 6, 10, 100)) ~ school, data = nmes, breaks = 9)
par(mfrow = c(1, 1))

## Poisson regression
nmes_pois &lt;- glm(visits ~ ., data = nmes, family = poisson)
summary(nmes_pois)

## LM test for overdispersion
dispersiontest(nmes_pois)
dispersiontest(nmes_pois, trafo = 2)

## sandwich covariance matrix
coeftest(nmes_pois, vcov = sandwich)

## quasipoisson model
nmes_qpois &lt;- glm(visits ~ ., data = nmes, family = quasipoisson)

## NegBin regression
nmes_nb &lt;- glm.nb(visits ~ ., data = nmes)

## hurdle regression
nmes_hurdle &lt;- hurdle(visits ~ . | chronic + insurance + school + gender,
  data = nmes, dist = "negbin")

## zero-inflated regression model
nmes_zinb &lt;- zeroinfl(visits ~ . | chronic + insurance + school + gender,
  data = nmes, dist = "negbin")

## compare estimated coefficients
fm &lt;- list("ML-Pois" = nmes_pois, "Quasi-Pois" = nmes_qpois, "NB" = nmes_nb,
  "Hurdle-NB" = nmes_hurdle, "ZINB" = nmes_zinb)
round(sapply(fm, function(x) coef(x)[1:7]), digits = 3)

## associated standard errors
round(cbind("ML-Pois" = sqrt(diag(vcov(nmes_pois))),
  "Adj-Pois" = sqrt(diag(sandwich(nmes_pois))),
  sapply(fm[-1], function(x) sqrt(diag(vcov(x)))[1:7])),
  digits = 3)

## log-likelihoods and number of estimated parameters
rbind(logLik = sapply(fm, function(x) round(logLik(x), digits = 0)),
  Df = sapply(fm, function(x) attr(logLik(x), "df")))

## predicted number of zeros
round(c("Obs" = sum(nmes$visits &lt; 1),
  "ML-Pois" = sum(dpois(0, fitted(nmes_pois))),
  "Adj-Pois" = NA,
  "Quasi-Pois" = NA,
  "NB" = sum(dnbinom(0, mu = fitted(nmes_nb), size = nmes_nb$theta)),
  "NB-Hurdle" = sum(predict(nmes_hurdle, type = "prob")[,1]),
  "ZINB" = sum(predict(nmes_zinb, type = "prob")[,1])))

## coefficients of zero-augmentation models
t(sapply(fm[4:5], function(x) round(x$coefficients$zero, digits = 3)))
</code></pre>

<hr>
<h2 id='NYSESW'>Daily NYSE Composite Index</h2><span id='topic+NYSESW'></span>

<h3>Description</h3>

<p>A daily time series from 1990 to 2005 of the New York Stock Exchange composite index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("NYSESW")</code></pre>


<h3>Format</h3>

<p>A daily univariate time series from 1990-01-02 to 2005-11-11 (of class
<code>"zoo"</code> with <code>"Date"</code> index).
</p>


<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## returns
data("NYSESW")
ret &lt;- 100 * diff(log(NYSESW))
plot(ret)

## Stock and Watson (2007), p. 667, GARCH(1,1) model
library("tseries")
fm &lt;- garch(coredata(ret))
summary(fm)
</code></pre>

<hr>
<h2 id='OECDGas'>Gasoline Consumption Data</h2><span id='topic+OECDGas'></span>

<h3>Description</h3>

<p>Panel data on gasoline consumption in 18 OECD countries over 19 years, 1960&ndash;1978. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("OECDGas")</code></pre>


<h3>Format</h3>

<p>A data frame containing 342 observations on 6 variables.
</p>

<dl>
<dt>country</dt><dd><p>Factor indicating country.</p>
</dd>
<dt>year</dt><dd><p>Year.</p>
</dd>
<dt>gas</dt><dd><p>Logarithm of motor gasoline consumption per car.</p>
</dd>
<dt>income</dt><dd><p>Logarithm of real per-capita income.</p>
</dd>
<dt>price</dt><dd><p>Logarithm of real motor gasoline price.</p>
</dd>
<dt>cars</dt><dd><p>Logarithm of the stock of cars per-capita.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data is from Baltagi (2002).
</p>


<h3>References</h3>

<p>Baltagi, B.H. (2002). <em>Econometrics</em>, 3rd ed. Berlin, Springer. 
</p>
<p>Baltagi, B.H. and Griffin, J.M. (1983). Gasoline Demand in the OECD: An Application
of Pooling and Testing Procedures. <em>European Economic Review</em>, <b>22</b>, 117&ndash;137.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Baltagi2002">Baltagi2002</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("OECDGas")

library("lattice")
xyplot(exp(cars) ~ year | country, data = OECDGas, type = "l")
xyplot(exp(gas) ~ year | country, data = OECDGas, type = "l")
</code></pre>

<hr>
<h2 id='OECDGrowth'>OECD Macroeconomic Data</h2><span id='topic+OECDGrowth'></span>

<h3>Description</h3>

<p>Cross-section data on OECD countries, used for growth regressions. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("OECDGrowth")</code></pre>


<h3>Format</h3>

<p>A data frame with 22 observations on the following 6 variables.
</p>

<dl>
<dt>gdp85</dt><dd><p>real GDP in 1985 (per person of working age, i.e., age 15 to 65),
in 1985 international prices.</p>
</dd>
<dt>gdp60</dt><dd><p>real GDP in 1960 (per person of working age, i.e., age 15 to 65),
in 1985 international prices.</p>
</dd>
<dt>invest</dt><dd><p>average of annual ratios of real domestic investment to real GDP (1960&ndash;1985).</p>
</dd>
<dt>school</dt><dd><p>percentage of the working-age population that is in secondary school.</p>
</dd>
<dt>randd</dt><dd><p>average of annual ratios of gross domestic expenditure on research 
and development to nominal GDP (of available observations during 1960&ndash;1985).</p>
</dd>    
<dt>popgrowth</dt><dd><p>annual population growth 1960&ndash;1985, computed as <code>log(pop85/pop60)/25</code>.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Appendix 1 Nonneman and Vanhoudt (1996), except for one bad misprint:
The value of <code>school</code> for Norway is given as 0.01, the correct value is 0.1
(see Mankiw, Romer and Weil, 1992). <code>OECDGrowth</code> contains the corrected data.
</p>


<h3>References</h3>

<p>Mankiw, N.G., Romer, D., and Weil, D.N. (1992). A Contribution to the Empirics of Economic Growth. 
<em>Quarterly Journal of Economics</em>, <b>107</b>, 407&ndash;437.
</p>
<p>Nonneman, W., and Vanhoudt, P. (1996). A Further Augmentation of the Solow Model
and the Empirics of Economic Growth. <em>Quarterly Journal of Economics</em>, <b>111</b>, 943&ndash;953.
</p>
<p>Zaman, A., Rousseeuw, P.J., and  Orhan, M. (2001). Econometric Applications of
High-Breakdown Robust Regression Techniques. <em>Economics Letters</em>, <b>71</b>, 1&ndash;8.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GrowthDJ">GrowthDJ</a></code>, <code><a href="#topic+GrowthSW">GrowthSW</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("OECDGrowth")

## Nonneman and Vanhoudt (1996), Table II
cor(OECDGrowth[, 3:6])
cor(log(OECDGrowth[, 3:6]))

## textbook Solow model
## Nonneman and Vanhoudt (1996), Table IV, and
## Zaman, Rousseeuw and Orhan (2001), Table 2
so_ols &lt;- lm(log(gdp85/gdp60) ~ log(gdp60) + log(invest) + log(popgrowth+.05),
  data = OECDGrowth)
summary(so_ols)

## augmented and extended Solow growth model
## Nonneman and Vanhoudt (1996), Table IV
aso_ols &lt;- lm(log(gdp85/gdp60) ~ log(gdp60) + log(invest) +
  log(school) + log(popgrowth+.05), data = OECDGrowth)
eso_ols &lt;- lm(log(gdp85/gdp60) ~ log(gdp60) + log(invest) +
  log(school) + log(randd) + log(popgrowth+.05), data = OECDGrowth)

## determine unusual observations using LTS
library("MASS")
so_lts &lt;- lqs(log(gdp85/gdp60) ~ log(gdp60) +  log(invest) + log(popgrowth+.05),
  data = OECDGrowth, psamp = 13, nsamp = "exact")

## large residuals
nok1 &lt;- abs(residuals(so_lts))/so_lts$scale[2] &gt; 2.5
residuals(so_lts)[nok1]/so_lts$scale[2]

## high leverage
X &lt;- model.matrix(so_ols)[,-1]
cv &lt;- cov.rob(X, nsamp = "exact")
mh &lt;- sqrt(mahalanobis(X, cv$center, cv$cov))
nok2 &lt;- mh &gt; 2.5
mh[nok2]

## bad leverage
nok &lt;- which(nok1 &amp; nok2)
nok

## robust results without bad leverage points
so_rob &lt;- update(so_ols, subset = -nok)
summary(so_rob)
## This is similar to Zaman, Rousseeuw and Orhan (2001), Table 2
## but uses exact computations (and not sub-optimal results
## for the robust functions lqs and cov.rob)
</code></pre>

<hr>
<h2 id='OlympicTV'>Television Rights for Olympic Games</h2><span id='topic+OlympicTV'></span>

<h3>Description</h3>

<p>Television rights for Olympic Games for US networks (in millions USD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("OlympicTV")</code></pre>


<h3>Format</h3>

<p>A data frame with 10 observations and 2 variables.
</p>

<dl>
<dt>rights</dt><dd><p>time series of television rights (in million USD),</p>
</dd>
<dt>network</dt><dd><p>factor coding television network.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Franses (1998).
</p>


<h3>References</h3>

<p>Franses, P.H. (1998). <em>Time Series Models for Business and Economic Forecasting</em>.
Cambridge, UK: Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Franses1998">Franses1998</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("OlympicTV")
plot(OlympicTV$rights)
</code></pre>

<hr>
<h2 id='OrangeCounty'>Orange County Employment</h2><span id='topic+OrangeCounty'></span>

<h3>Description</h3>

<p>Quarterly time series data on employment in Orange county, 1965&ndash;1983.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("OrangeCounty")</code></pre>


<h3>Format</h3>

<p>A quarterly multiple time series from 1965 to 1983 with 2 variables.
</p>

<dl>
<dt>employment</dt><dd><p>Quarterly employment in Orange county.</p>
</dd>
<dt>gnp</dt><dd><p>Quarterly real GNP.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data is from Baltagi (2002).
</p>


<h3>References</h3>

<p>Baltagi, B.H. (2002). <em>Econometrics</em>, 3rd ed. Berlin, Springer. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Baltagi2002">Baltagi2002</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("OrangeCounty")
plot(OrangeCounty)
</code></pre>

<hr>
<h2 id='Parade2005'>Parade Magazine 2005 Earnings Data</h2><span id='topic+Parade2005'></span>

<h3>Description</h3>

<p>US earnings data, as provided in an annual survey of Parade (here from 2005), the
Sunday newspaper magazine supplementing the Sunday (or Weekend) edition of many
daily newspapers in the USA. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Parade2005")</code></pre>


<h3>Format</h3>

<p>A data frame containing 130 observations on 5 variables.
</p>

<dl>
<dt>earnings</dt><dd><p>Annual personal earnings.</p>
</dd>
<dt>age</dt><dd><p>Age in years.</p>
</dd>
<dt>gender</dt><dd><p>Factor indicating gender.</p>
</dd>
<dt>state</dt><dd><p>Factor indicating state.</p>
</dd>
<dt>celebrity</dt><dd><p>Factor. Is the individual a celebrity?</p>
</dd>
</dl>



<h3>Details</h3>

<p>In addition to the four variables provided by Parade (earnings, age, gender, and state),
a fifth variable was introduced, the &ldquo;celebrity factor&rdquo; (here actors, athletes, 
TV personalities, politicians, and CEOs are considered celebrities). The data are quite 
far from a simple random sample, there being substantial oversampling of celebrities.
</p>


<h3>Source</h3>

<p>Parade (2005). What People Earn. Issue March 13, 2005.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## data
data("Parade2005")
attach(Parade2005)
summary(Parade2005)

## bivariate visualizations
plot(density(log(earnings), bw = "SJ"), type = "l", main = "log(earnings)")
rug(log(earnings))
plot(log(earnings) ~ gender, main = "log(earnings)")

## celebrity vs. non-celebrity earnings
noncel &lt;- subset(Parade2005, celebrity == "no")
cel &lt;- subset(Parade2005, celebrity == "yes")

library("ineq")
plot(Lc(noncel$earnings), main = "log(earnings)")
lines(Lc(cel$earnings), lty = 2)
lines(Lc(earnings), lty = 3)

Gini(noncel$earnings)
Gini(cel$earnings)
Gini(earnings)

## detach data
detach(Parade2005)
</code></pre>

<hr>
<h2 id='PepperPrice'>Black and White Pepper Prices</h2><span id='topic+PepperPrice'></span>

<h3>Description</h3>

<p>Time series of average monthly European spot prices for black and
white pepper (fair average quality) in US dollars per ton.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("PepperPrice")</code></pre>


<h3>Format</h3>

<p>A monthly multiple time series from 1973(10) to 1996(4) with 2 variables.
</p>

<dl>
<dt>black</dt><dd><p>spot price for black pepper,</p>
</dd>
<dt>white</dt><dd><p>spot price for white pepper.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Originally available as an online supplement to Franses (1998). Now available via online complements to Franses, van Dijk and Opschoor (2014).
</p>
<p><a href="https://www.cambridge.org/us/academic/subjects/economics/econometrics-statistics-and-mathematical-economics/time-series-models-business-and-economic-forecasting-2nd-edition">https://www.cambridge.org/us/academic/subjects/economics/econometrics-statistics-and-mathematical-economics/time-series-models-business-and-economic-forecasting-2nd-edition</a>
</p>


<h3>References</h3>

<p>Franses, P.H. (1998). <em>Time Series Models for Business and Economic Forecasting</em>.
Cambridge, UK: Cambridge University Press.
</p>
<p>Franses, P.H., van Dijk, D. and Opschoor, A. (2014). <em>Time Series Models for Business and Economic Forecasting</em>, 2nd ed.
Cambridge, UK: Cambridge University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## data
data("PepperPrice", package = "AER")
plot(PepperPrice, plot.type = "single", col = 1:2)

## package
library("tseries")
library("urca")

## unit root tests
adf.test(log(PepperPrice[, "white"]))
adf.test(diff(log(PepperPrice[, "white"])))
pp.test(log(PepperPrice[, "white"]), type = "Z(t_alpha)")
pepper_ers &lt;- ur.ers(log(PepperPrice[, "white"]),
  type = "DF-GLS", model = "const", lag.max = 4)
summary(pepper_ers)

## stationarity tests
kpss.test(log(PepperPrice[, "white"]))

## cointegration
po.test(log(PepperPrice))
pepper_jo &lt;- ca.jo(log(PepperPrice), ecdet = "const", type = "trace")
summary(pepper_jo)
pepper_jo2 &lt;- ca.jo(log(PepperPrice), ecdet = "const", type = "eigen")
summary(pepper_jo2)
</code></pre>

<hr>
<h2 id='PhDPublications'>Doctoral Publications</h2><span id='topic+PhDPublications'></span>

<h3>Description</h3>

<p>Cross-section data on the scientific productivity of PhD students in biochemistry. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("PhDPublications")</code></pre>


<h3>Format</h3>

<p>A data frame containing 915 observations on 6 variables.
</p>

<dl>
<dt>articles</dt><dd><p>Number of articles published during last 3 years of PhD.</p>
</dd>
<dt>gender</dt><dd><p>factor indicating gender.</p>
</dd>
<dt>married</dt><dd><p>factor. Is the PhD student married?</p>
</dd>
<dt>kids</dt><dd><p>Number of children less than 6 years old.</p>
</dd>
<dt>prestige</dt><dd><p>Prestige of the graduate program.</p>
</dd>
<dt>mentor</dt><dd><p>Number of articles published by student's mentor.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Long (1997). 
</p>


<h3>References</h3>

<p>Long, J.S. (1990).
<em>Regression Models for Categorical and Limited Dependent Variables</em>.
Thousand Oaks: Sage Publications.
</p>
<p>Long, J.S. (1997). The Origin of Sex Differences in Science.
<em>Social Forces</em>, <b>68</b>, 1297&ndash;1315.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## from Long (1997)
data("PhDPublications")

## Table 8.1, p. 227
summary(PhDPublications)

## Figure 8.2, p. 220
plot(0:10, dpois(0:10, mean(PhDPublications$articles)), type = "b", col = 2,
  xlab = "Number of articles", ylab = "Probability")
lines(0:10, prop.table(table(PhDPublications$articles))[1:11], type = "b")
legend("topright", c("observed", "predicted"), col = 1:2, lty = rep(1, 2), bty = "n")

## Table 8.2, p. 228
fm_lrm &lt;- lm(log(articles + 0.5) ~ ., data = PhDPublications)
summary(fm_lrm)
-2 * logLik(fm_lrm)
fm_prm &lt;- glm(articles ~ ., data = PhDPublications, family = poisson)
library("MASS")
fm_nbrm &lt;- glm.nb(articles ~ ., data = PhDPublications)

## Table 8.3, p. 246
library("pscl")
fm_zip &lt;- zeroinfl(articles ~ . | ., data = PhDPublications)
fm_zinb &lt;- zeroinfl(articles ~ . | ., data = PhDPublications, dist = "negbin")
</code></pre>

<hr>
<h2 id='ProgramEffectiveness'>Program Effectiveness Data</h2><span id='topic+ProgramEffectiveness'></span>

<h3>Description</h3>

<p>Data used to study the effectiveness of a program.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ProgramEffectiveness")</code></pre>


<h3>Format</h3>

<p>A data frame containing 32 cross-section observations on 4 variables.
</p>

<dl>
<dt>grade</dt><dd><p>Factor with levels <code>"increase"</code> and <code>"decrease"</code>.</p>
</dd>
<dt>average</dt><dd><p>Grade-point average.</p>
</dd>
<dt>testscore</dt><dd><p>Test score on economics test.</p>
</dd>
<dt>participation</dt><dd><p>Factor. Did the individual participate in the program?</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data are taken form Spencer and Mazzeo (1980) who examined whether a new method 
of teaching economics significantly influenced performance in later economics courses.
</p>


<h3>Source</h3>

<p>Online complements to Greene (2003).
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>
<p>Spector, L. and Mazzeo, M. (1980). Probit Analysis and Economic Education. 
<em>Journal of Economic Education</em>, <b>11</b>, 37&ndash;44.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ProgramEffectiveness")

## Greene (2003), Table 21.1, col. "Probit"
fm_probit &lt;- glm(grade ~ average + testscore + participation,
  data = ProgramEffectiveness, family = binomial(link = "probit"))
summary(fm_probit)
</code></pre>

<hr>
<h2 id='PSID1976'>Labor Force Participation Data</h2><span id='topic+PSID1976'></span>

<h3>Description</h3>

<p>Cross-section data originating from the 1976 Panel Study of Income Dynamics (PSID),
based on data for the previous year, 1975. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("PSID1976")</code></pre>


<h3>Format</h3>

<p>A data frame containing 753 observations on 21 variables.
</p>

<dl>
<dt>participation</dt><dd><p>Factor. Did the individual participate in the labor force in 1975?
(This is essentially <code>wage &gt; 0</code> or <code>hours &gt; 0</code>.)</p>
</dd>
<dt>hours</dt><dd><p>Wife's hours of work in 1975.</p>
</dd>
<dt>youngkids</dt><dd><p>Number of children less than 6 years old in household.</p>
</dd>
<dt>oldkids</dt><dd><p>Number of children between ages 6 and 18 in household.</p>
</dd>
<dt>age</dt><dd><p>Wife's age in years.</p>
</dd>
<dt>education</dt><dd><p>Wife's education in years.</p>
</dd>
<dt>wage</dt><dd><p>Wife's average hourly wage, in 1975 dollars.</p>
</dd>
<dt>repwage</dt><dd><p>Wife's wage reported at the time of the 1976 interview 
(not the same as the 1975 estimated wage). To use the subsample with this wage,
one needs to select 1975 workers with <code>participation == "yes"</code>, then select only those
women with non-zero wage. Only 325 women work in 1975 and have a non-zero wage in 1976.</p>
</dd>
<dt>hhours</dt><dd><p>Husband's hours worked in 1975.</p>
</dd>
<dt>hage</dt><dd><p>Husband's age in years.</p>
</dd>
<dt>heducation</dt><dd><p>Husband's education in years.</p>
</dd>
<dt>hwage</dt><dd><p>Husband's wage, in 1975 dollars.</p>
</dd>
<dt>fincome</dt><dd><p>Family income, in 1975 dollars. (This variable is used to construct the
property income variable.)</p>
</dd>
<dt>tax</dt><dd><p>Marginal tax rate facing the wife, and is taken from published federal 
tax tables (state and local income taxes are excluded). The taxable income on 
which this tax rate is calculated includes Social Security, if applicable to wife.</p>
</dd>
<dt>meducation</dt><dd><p>Wife's mother's educational attainment, in years.</p>
</dd>
<dt>feducation</dt><dd><p>Wife's father's educational attainment, in years.</p>
</dd>
<dt>unemp</dt><dd><p>Unemployment rate in county of residence, in percentage points.
(This is taken from bracketed ranges.)</p>
</dd>
<dt>city</dt><dd><p>Factor. Does the individual live in a large city?</p>
</dd>
<dt>experience</dt><dd><p>Actual years of wife's previous labor market experience.</p>
</dd>
<dt>college</dt><dd><p>Factor. Did the individual attend college?</p>
</dd>
<dt>hcollege</dt><dd><p>Factor. Did the individual's husband attend college?</p>
</dd>
</dl>



<h3>Details</h3>

<p>This data set is also known as the Mroz (1987) data.
</p>
<p>Warning: Typical applications using these data employ the variable
<code>wage</code> (aka <code>earnings</code> in previous versions of the data) as the dependent variable.
The variable <code>repwage</code> is the reported wage in a 1976 interview, named RPWG by Greene (2003).
</p>


<h3>Source</h3>

<p>Online complements to Greene (2003). Table F4.1.
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>
<p>McCullough, B.D. (2004). Some Details of Nonlinear Estimation. In:
Altman, M., Gill, J., and McDonald, M.P.:  
<em>Numerical Issues in Statistical Computing for the Social Scientist</em>. 
Hoboken, NJ: John Wiley, Ch. 8, 199&ndash;218.
</p>
<p>Mroz, T.A. (1987). The Sensitivity of an Empirical Model of Married Women's Hours of Work to
Economic and Statistical Assumptions. <em>Econometrica</em>, <b>55</b>, 765&ndash;799.
</p>
<p>Winkelmann, R., and Boes, S. (2009). <em>Analysis of Microdata</em>, 2nd ed. Berlin and Heidelberg: Springer-Verlag.
</p>
<p>Wooldridge, J.M. (2002). <em>Econometric Analysis of Cross-Section and Panel Data</em>. 
Cambridge, MA: MIT Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code>, <code><a href="#topic+WinkelmannBoes2009">WinkelmannBoes2009</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## data and transformations
data("PSID1976")
PSID1976$kids &lt;- with(PSID1976, factor((youngkids + oldkids) &gt; 0,
  levels = c(FALSE, TRUE), labels = c("no", "yes")))
PSID1976$nwincome &lt;- with(PSID1976, (fincome - hours * wage)/1000)
PSID1976$partnum &lt;- as.numeric(PSID1976$participation) - 1

###################
## Greene (2003) ##
###################

## Example 4.1, Table 4.2
## (reproduced in Example 7.1, Table 7.1)
gr_lm &lt;- lm(log(hours * wage) ~ age + I(age^2) + education + kids,
  data = PSID1976, subset = participation == "yes")
summary(gr_lm)
vcov(gr_lm)

## Example 4.5
summary(gr_lm)
## or equivalently
gr_lm1 &lt;- lm(log(hours * wage) ~ 1, data = PSID1976, subset = participation == "yes")
anova(gr_lm1, gr_lm)

## Example 21.4, p. 681, and Tab. 21.3, p. 682
gr_probit1 &lt;- glm(participation ~ age + I(age^2) + I(fincome/10000) + education + kids,
  data = PSID1976, family = binomial(link = "probit") )  
gr_probit2 &lt;- glm(participation ~ age + I(age^2) + I(fincome/10000) + education,
  data = PSID1976, family = binomial(link = "probit"))
gr_probit3 &lt;- glm(participation ~ kids/(age + I(age^2) + I(fincome/10000) + education),
  data = PSID1976, family = binomial(link = "probit"))
## LR test of all coefficients
lrtest(gr_probit1)
## Chow-type test
lrtest(gr_probit2, gr_probit3)
## equivalently:
anova(gr_probit2, gr_probit3, test = "Chisq")
## Table 21.3
summary(gr_probit1)

## Example 22.8, Table 22.7, p. 786
library("sampleSelection")
gr_2step &lt;- selection(participation ~ age + I(age^2) + fincome + education + kids, 
  wage ~ experience + I(experience^2) + education + city,
  data = PSID1976, method = "2step")
gr_ml &lt;- selection(participation ~ age + I(age^2) + fincome + education + kids, 
  wage ~ experience + I(experience^2) + education + city,
  data = PSID1976, method = "ml")
gr_ols &lt;- lm(wage ~ experience + I(experience^2) + education + city,
  data = PSID1976, subset = participation == "yes")
## NOTE: ML estimates agree with Greene, 5e errata. 
## Standard errors are based on the Hessian (here), while Greene has BHHH/OPG. 


#######################
## Wooldridge (2002) ##
#######################

## Table 15.1, p. 468
wl_lpm &lt;- lm(partnum ~ nwincome + education + experience + I(experience^2) +
  age + youngkids + oldkids, data = PSID1976)
wl_logit &lt;- glm(participation ~ nwincome + education + experience + I(experience^2) +
  age + youngkids + oldkids, family = binomial, data = PSID1976)
wl_probit &lt;- glm(participation ~ nwincome + education + experience + I(experience^2) +
  age + youngkids + oldkids, family = binomial(link = "probit"), data = PSID1976)
## (same as Altman et al.)

## convenience functions
pseudoR2 &lt;- function(obj) 1 - as.vector(logLik(obj)/logLik(update(obj, . ~ 1)))
misclass &lt;- function(obj) 1 - sum(diag(prop.table(table(
  model.response(model.frame(obj)), round(fitted(obj))))))

coeftest(wl_logit)
logLik(wl_logit)
misclass(wl_logit)
pseudoR2(wl_logit)

coeftest(wl_probit)
logLik(wl_probit)
misclass(wl_probit)
pseudoR2(wl_probit)

## Table 16.2, p. 528
form &lt;- hours ~ nwincome + education + experience + I(experience^2) + age + youngkids + oldkids 
wl_ols &lt;- lm(form, data = PSID1976)
wl_tobit &lt;- tobit(form, data = PSID1976)
summary(wl_ols)
summary(wl_tobit)


#######################
## McCullough (2004) ##
#######################

## p. 203
mc_probit &lt;- glm(participation ~ nwincome + education + experience + I(experience^2) +
  age + youngkids + oldkids, family = binomial(link = "probit"), data = PSID1976)
mc_tobit &lt;- tobit(hours ~ nwincome + education + experience + I(experience^2) + age +
  youngkids + oldkids, data = PSID1976)
coeftest(mc_probit)
coeftest(mc_tobit)
coeftest(mc_tobit, vcov = vcovOPG)
</code></pre>

<hr>
<h2 id='PSID1982'>PSID Earnings Data 1982</h2><span id='topic+PSID1982'></span>

<h3>Description</h3>

<p>Cross-section data originating from the Panel Study on Income Dynamics, 1982.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("PSID1982")</code></pre>


<h3>Format</h3>

<p>A data frame containing 595 observations on 12 variables.
</p>

<dl>
<dt>experience</dt><dd><p>Years of full-time work experience.</p>
</dd>
<dt>weeks</dt><dd><p>Weeks worked.</p>
</dd>
<dt>occupation</dt><dd><p>factor. Is the individual a white-collar (<code>"white"</code>) or blue-collar (<code>"blue"</code>) worker?</p>
</dd>
<dt>industry</dt><dd><p>factor. Does the individual work in a manufacturing industry?</p>
</dd>
<dt>south</dt><dd><p>factor. Does the individual reside in the South?</p>
</dd>
<dt>smsa</dt><dd><p>factor. Does the individual reside in a SMSA (standard metropolitan statistical area)?</p>
</dd>
<dt>married</dt><dd><p>factor. Is the individual married?</p>
</dd>
<dt>gender</dt><dd><p>factor indicating gender.</p>
</dd>
<dt>union</dt><dd><p>factor. Is the individual's wage set by a union contract?</p>
</dd>
<dt>education</dt><dd><p>Years of education.</p>
</dd>
<dt>ethnicity</dt><dd><p>factor indicating ethnicity.
Is the individual African-American (<code>"afam"</code>) or not (<code>"other"</code>)?</p>
</dd>
<dt>wage</dt><dd><p>Wage.</p>
</dd>
</dl>



<h3>Details</h3>

<p><code>PSID1982</code> is the cross-section for the year 1982 taken from a larger panel data set
<code><a href="#topic+PSID7682">PSID7682</a></code> for the years 1976&ndash;1982, originating from Cornwell and Rupert (1988).
Baltagi (2002) just uses the 1982 cross-section; hence <code>PSID1982</code> is available as a
standalone data set because it was included in <span class="pkg">AER</span> prior to the availability of the
full <code>PSID7682</code> panel version.
</p>


<h3>Source</h3>

<p>The data is from Baltagi (2002).
</p>


<h3>References</h3>

<p>Baltagi, B.H. (2002). <em>Econometrics</em>, 3rd ed. Berlin, Springer. 
</p>
<p>Cornwell, C., and Rupert, P. (1988). Efficient Estimation with Panel Data: 
An Empirical Comparison of Instrumental Variables Estimators. 
<em>Journal of Applied Econometrics</em>, <b>3</b>, 149&ndash;155.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PSID7682">PSID7682</a></code>, <code><a href="#topic+Baltagi2002">Baltagi2002</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("PSID1982")
plot(density(PSID1982$wage, bw = "SJ"))

## Baltagi (2002), Table 4.1
earn_lm &lt;- lm(log(wage) ~ . + I(experience^2), data = PSID1982)
summary(earn_lm)

## Baltagi (2002), Table 13.1
union_lpm &lt;- lm(I(as.numeric(union) - 1) ~ . - wage, data = PSID1982)
union_probit &lt;- glm(union ~ . - wage, data = PSID1982, family = binomial(link = "probit"))
union_logit &lt;- glm(union ~ . - wage, data = PSID1982, family = binomial)
## probit OK, logit and LPM rather different.
</code></pre>

<hr>
<h2 id='PSID7682'>PSID Earnings Panel Data (1976&ndash;1982)</h2><span id='topic+PSID7682'></span>

<h3>Description</h3>

<p>Panel data on earnings of 595 individuals for the years 1976&ndash;1982,
originating from the Panel Study of Income Dynamics.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("PSID7682")</code></pre>


<h3>Format</h3>

<p>A data frame containing 7 annual observations on 12 variables for 595 individuals. 
</p>

<dl>
<dt>experience</dt><dd><p>Years of full-time work experience.</p>
</dd>
<dt>weeks</dt><dd><p>Weeks worked.</p>
</dd>
<dt>occupation</dt><dd><p>factor. Is the individual a white-collar (<code>"white"</code>)
or blue-collar (<code>"blue"</code>) worker?</p>
</dd>
<dt>industry</dt><dd><p>factor. Does the individual work in a manufacturing industry?</p>
</dd>
<dt>south</dt><dd><p>factor. Does the individual reside in the South?</p>
</dd>
<dt>smsa</dt><dd><p>factor. Does the individual reside in a SMSA (standard
metropolitan statistical area)?</p>
</dd>
<dt>married</dt><dd><p>factor. Is the individual married?</p>
</dd>
<dt>gender</dt><dd><p>factor indicating gender.</p>
</dd>
<dt>union</dt><dd><p>factor. Is the individual's wage set by a union contract?</p>
</dd>
<dt>education</dt><dd><p>Years of education.</p>
</dd>
<dt>ethnicity</dt><dd><p>factor indicating ethnicity.
Is the individual African-American (<code>"afam"</code>) or not (<code>"other"</code>)?</p>
</dd>
<dt>wage</dt><dd><p>Wage.</p>
</dd>
<dt>year</dt><dd><p>factor indicating year.</p>
</dd>
<dt>id</dt><dd><p>factor indicating individual subject ID.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data were originally analyzed by Cornwell and Rupert (1988) and employed
for assessing various instrumental-variable estimators for panel models
(including the Hausman-Taylor model). Baltagi and Khanti-Akom (1990) reanalyzed
the data, made corrections to the data and also suggest modeling with a different
set of instruments.
</p>
<p><code>PSID7682</code> is the version of the data as provided by Baltagi (2005),
or Greene (2008).
</p>
<p>Baltagi (2002) just uses the cross-section for the year 1982,
i.e., <code>subset(PSID7682, year == "1982")</code>. This is also available as
a standalone data set <code><a href="#topic+PSID1982">PSID1982</a></code> because it was included
in <span class="pkg">AER</span> prior to the availability of the full <code>PSID7682</code> panel
version.
</p>


<h3>Source</h3>

<p>Online complements to Baltagi (2005).
</p>
<p><a href="http://www.wiley.com/legacy/wileychi/baltagi3e/data_sets.html">http://www.wiley.com/legacy/wileychi/baltagi3e/data_sets.html</a>
</p>
<p>Also provided in the online complements to Greene (2008), Table F9.1.
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/Edition6/tablelist6.htm">https://pages.stern.nyu.edu/~wgreene/Text/Edition6/tablelist6.htm</a>
</p>


<h3>References</h3>

<p>Baltagi, B.H., and Khanti-Akom, S. (1990). On Efficient Estimation with
Panel Data: An Empirical Comparison of Instrumental Variables Estimators.
<em>Journal of Applied Econometrics</em>, <b>5</b>, 401&ndash;406.
</p>
<p>Baltagi, B.H. (2001). <em>Econometric Analysis of Panel Data</em>, 2nd ed. Chichester, UK: John Wiley.
</p>
<p>Baltagi, B.H. (2002). <em>Econometrics</em>, 3rd ed. Berlin, Springer. 
</p>
<p>Baltagi, B.H. (2005). <em>Econometric Analysis of Panel Data</em>, 3rd ed. Chichester, UK: John Wiley.
</p>
<p>Cornwell, C., and Rupert, P. (1988). Efficient Estimation with Panel Data: 
An Empirical Comparison of Instrumental Variables Estimators. 
<em>Journal of Applied Econometrics</em>, <b>3</b>, 149&ndash;155.
</p>
<p>Greene, W.H. (2008). <em>Econometric Analysis</em>, 6th ed. Upper Saddle River, NJ: Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PSID1982">PSID1982</a></code>, <code><a href="#topic+Baltagi2002">Baltagi2002</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("PSID7682")

library("plm")
psid &lt;- pdata.frame(PSID7682, c("id", "year"))

## Baltagi &amp; Khanti-Akom, Table I, column "HT"
## original Cornwell &amp; Rupert choice of exogenous variables
psid_ht1 &lt;- plm(log(wage) ~ weeks + south + smsa + married +
  experience + I(experience^2) + occupation + industry + union + gender + ethnicity + education |
  weeks + south + smsa + married + gender + ethnicity,
  data = psid, model = "ht")

## Baltagi &amp; Khanti-Akom, Table II, column "HT"
## alternative choice of exogenous variables
psid_ht2 &lt;- plm(log(wage) ~ occupation + south + smsa + industry +
  experience + I(experience^2) + weeks + married + union + gender + ethnicity + education |
  occupation + south + smsa + industry + gender + ethnicity,
  data = psid, model = "ht")

## Baltagi &amp; Khanti-Akom, Table III, column "HT"
## original choice of exogenous variables + time dummies
## (see also Baltagi, 2001, Table 7.1)
psid$time &lt;- psid$year
psid_ht3 &lt;- plm(log(wage) ~ weeks + south + smsa + married + experience + I(experience^2) +
  occupation + industry + union + gender + ethnicity + education + time |
  weeks + south + smsa + married + gender + ethnicity + time,
  data = psid, model = "ht")
</code></pre>

<hr>
<h2 id='RecreationDemand'>Recreation Demand Data</h2><span id='topic+RecreationDemand'></span>

<h3>Description</h3>

<p>Cross-section data on the number of recreational boating trips to Lake Somerville, Texas, in 1980,  
based on a survey administered to 2,000 registered leisure boat owners in 23 counties in eastern Texas. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("RecreationDemand")</code></pre>


<h3>Format</h3>

<p>A data frame containing 659 observations on 8 variables.
</p>

<dl>
<dt>trips</dt><dd><p>Number of recreational boating trips.</p>
</dd>
<dt>quality</dt><dd><p>Facility's subjective quality ranking on a scale of 1 to 5.</p>
</dd>
<dt>ski</dt><dd><p>factor. Was the individual engaged in water-skiing at the lake?</p>
</dd>
<dt>income</dt><dd><p>Annual household income of the respondent (in 1,000 USD).</p>
</dd>
<dt>userfee</dt><dd><p>factor. Did the individual pay an annual user fee at Lake Somerville?</p>
</dd>
<dt>costC</dt><dd><p>Expenditure when visiting Lake Conroe (in USD).</p>
</dd>
<dt>costS</dt><dd><p>Expenditure when visiting Lake Somerville (in USD).</p>
</dd>
<dt>costH</dt><dd><p>Expenditure when visiting Lake Houston (in USD).</p>
</dd>
</dl>



<h3>Details</h3>

<p>According to the original source (Seller, Stoll and Chavas, 1985, p. 168), the quality rating is on a scale from 1 to 5 and gives 0 for those who had not visited the lake. This explains the remarkably low mean for this variable, but also suggests that its treatment in various more recent publications is far from ideal. For consistency with other sources we handle the variable as a numerical variable, including the zeros.   
</p>


<h3>Source</h3>

<p>Journal of Business &amp; Economic Statistics Data Archive. 
</p>
<p><code style="white-space: pre;">&#8288;http://www.amstat.org/publications/jbes/upload/index.cfm?fuseaction=ViewArticles&amp;pub=JBES&amp;issue=96-4-OCT&#8288;</code>
</p>


<h3>References</h3>

<p>Cameron, A.C. and Trivedi, P.K. (1998). <em>Regression Analysis of Count Data</em>. 
Cambridge: Cambridge University Press.
</p>
<p>Gurmu, S. and Trivedi, P.K. (1996). Excess Zeros in Count Models for Recreational Trips.  
<em>Journal of Business &amp; Economic Statistics</em>,
<b>14</b>, 469&ndash;477.
</p>
<p>Ozuna, T. and Gomez, I.A. (1995). Specification and Testing of Count Data Recreation Demand Functions.
<em>Empirical Economics</em>, <b>20</b>, 543&ndash;550.
</p>
<p>Seller, C., Stoll, J.R. and Chavas, J.-P. (1985). Validation of Empirical Measures of Welfare Change: A Comparison of Nonmarket Techniques. <em>Land Economics</em>, <b>61</b>, 156&ndash;175.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CameronTrivedi1998">CameronTrivedi1998</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("RecreationDemand")

## Poisson model:
## Cameron and Trivedi (1998), Table 6.11
## Ozuna and Gomez (1995), Table 2, col. 3
fm_pois &lt;- glm(trips ~ ., data = RecreationDemand, family = poisson)
summary(fm_pois)
logLik(fm_pois)
coeftest(fm_pois, vcov = sandwich)

## Negbin model:
## Cameron and Trivedi (1998), Table 6.11
## Ozuna and Gomez (1995), Table 2, col. 5
library("MASS")
fm_nb &lt;- glm.nb(trips ~ ., data = RecreationDemand)
coeftest(fm_nb, vcov = vcovOPG)

## ZIP model:
## Cameron and Trivedi (1998), Table 6.11
library("pscl")
fm_zip &lt;- zeroinfl(trips ~  . | quality + income, data = RecreationDemand)
summary(fm_zip)

## Hurdle models
## Cameron and Trivedi (1998), Table 6.13
## poisson-poisson
fm_hp &lt;- hurdle(trips ~ ., data = RecreationDemand, dist = "poisson", zero = "poisson")
## negbin-negbin
fm_hnb &lt;- hurdle(trips ~ ., data = RecreationDemand, dist = "negbin", zero = "negbin")
## binom-negbin == geo-negbin
fm_hgnb &lt;- hurdle(trips ~ ., data = RecreationDemand, dist = "negbin")

## Note: quasi-complete separation
with(RecreationDemand, table(trips &gt; 0, userfee))
</code></pre>

<hr>
<h2 id='ResumeNames'>Are Emily and Greg More Employable Than Lakisha and Jamal?</h2><span id='topic+ResumeNames'></span>

<h3>Description</h3>

<p>Cross-section data about resume, call-back and employer information for 4,870 fictitious
resumes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ResumeNames")</code></pre>


<h3>Format</h3>

<p>A data frame containing 4,870 observations on 27 variables.
</p>

<dl>
<dt>name</dt><dd><p>factor indicating applicant's first name.</p>
</dd>
<dt>gender</dt><dd><p>factor indicating gender.</p>
</dd>
<dt>ethnicity</dt><dd><p>factor indicating ethnicity (i.e., Caucasian-sounding
vs. African-American sounding first name).</p>
</dd>
<dt>quality</dt><dd><p>factor indicating quality of resume.</p>
</dd>
<dt>call</dt><dd><p>factor. Was the applicant called back?</p>
</dd>
<dt>city</dt><dd><p>factor indicating city: Boston or Chicago.</p>
</dd>
<dt>jobs</dt><dd><p>number of jobs listed on resume.</p>
</dd>
<dt>experience</dt><dd><p>number of years of work experience on the resume.</p>
</dd>
<dt>honors</dt><dd><p>factor. Did the resume mention some honors?</p>
</dd>
<dt>volunteer</dt><dd><p>factor. Did the resume mention some volunteering experience?</p>
</dd>
<dt>military</dt><dd><p>factor. Does the applicant have military experience?</p>
</dd>
<dt>holes</dt><dd><p>factor. Does the resume have some employment holes?</p>
</dd>
<dt>school</dt><dd><p>factor. Does the resume mention some work experience while at school?</p>
</dd>
<dt>email</dt><dd><p>factor. Was the e-mail address on the applicant's resume?</p>
</dd>
<dt>computer</dt><dd><p>factor. Does the resume mention some computer skills?</p>
</dd>
<dt>special</dt><dd><p>factor. Does the resume mention some special skills?</p>
</dd>
<dt>college</dt><dd><p>factor. Does the applicant have a college degree or more?</p>
</dd>
<dt>minimum</dt><dd><p>factor indicating minimum experience requirement of the employer.</p>
</dd>
<dt>equal</dt><dd><p>factor. Is the employer EOE (equal opportunity employment)?</p>
</dd>
<dt>wanted</dt><dd><p>factor indicating type of position wanted by employer.</p>
</dd>
<dt>requirements</dt><dd><p>factor. Does the ad mention some requirement for the job?</p>
</dd>
<dt>reqexp</dt><dd><p>factor. Does the ad mention some experience requirement?</p>
</dd>
<dt>reqcomm</dt><dd><p>factor. Does the ad mention some communication skills requirement?</p>
</dd>
<dt>reqeduc</dt><dd><p>factor. Does the ad mention some educational requirement?</p>
</dd>
<dt>reqcomp</dt><dd><p>factor. Does the ad mention some computer skills requirement?</p>
</dd>
<dt>reqorg</dt><dd><p>factor. Does the ad mention some organizational skills requirement?</p>
</dd>
<dt>industry</dt><dd><p>factor indicating type of employer industry.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Cross-section data about resume, call-back and employer information for 4,870 fictitious
resumes sent in response to employment advertisements in Chicago and Boston in 2001, 
in a randomized controlled experiment conducted by Bertrand and Mullainathan (2004).
The resumes contained information concerning the ethnicity of the applicant.
Because ethnicity is not typically included on a resume, resumes were differentiated on
the basis of so-called &ldquo;Caucasian sounding names&rdquo; (such as Emily Walsh or Gregory Baker)
and &ldquo;African American sounding names&rdquo; (such as Lakisha Washington or Jamal Jones).
A large collection of fictitious resumes were created and the pre-supposed
ethnicity (based on the sound of the name) was randomly assigned to each resume.
These resumes were sent to prospective employers to see which resumes generated a phone call
from the prospective employer.
</p>


<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Bertrand, M. and Mullainathan, S. (2004). Are Emily and Greg More Employable Than Lakisha and
Jamal? A Field Experiment on Labor Market Discrimination. 
<em>American Economic Review</em>, <b>94</b>, 991&ndash;1013.
</p>
<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ResumeNames")
summary(ResumeNames)
prop.table(xtabs(~ ethnicity + call, data = ResumeNames), 1)
</code></pre>

<hr>
<h2 id='ShipAccidents'>Ship Accidents</h2><span id='topic+ShipAccidents'></span>

<h3>Description</h3>

<p>Data on ship accidents.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ShipAccidents")</code></pre>


<h3>Format</h3>

<p>A data frame containing 40 observations on 5 ship types in 4 vintages and 2 service periods. 
</p>

<dl>
<dt>type</dt><dd><p>factor with levels <code>"A"</code> to <code>"E"</code> for the different ship types,</p>
</dd>
<dt>construction</dt><dd><p>factor with levels <code>"1960-64"</code>, <code>"1965-69"</code>, <code>"1970-74"</code>, 
<code>"1975-79"</code> for the periods of construction,</p>
</dd>
<dt>operation</dt><dd><p>factor with levels <code>"1960-74"</code>, <code>"1975-79"</code> for the periods of
operation,</p>
</dd>
<dt>service</dt><dd><p>aggregate months of service,</p>
</dd>
<dt>incidents</dt><dd><p>number of damage incidents.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data are from McCullagh and Nelder (1989, p. 205, Table 6.2) and were
also used by Greene (2003, Ch. 21), see below.
</p>
<p>There are five ships (observations 7, 15, 23, 31, 39) with an operation period
<em>before</em> the construction period, hence the variables <code>service</code> and
<code>incidents</code> are necessarily 0. An additional observation (34) has entries
representing <em>accidentally empty cells</em> (see McCullagh and Nelder, 1989, p. 205).
</p>
<p>It is a bit unclear what exactly the above means. In any case, the models are fit
only to those observations with <code>service &gt; 0</code>.
</p>


<h3>Source</h3>

<p>Online complements to Greene (2003).
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>
<p>McCullagh, P. and Nelder, J.A. (1989). <em>Generalized Linear Models</em>, 2nd edition.
London: Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ShipAccidents")
sa &lt;- subset(ShipAccidents, service &gt; 0)

## Greene (2003), Table 21.20
## (see also McCullagh and Nelder, 1989, Table 6.3)
sa_full &lt;- glm(incidents ~ type + construction + operation, family = poisson,
  data = sa, offset = log(service))
summary(sa_full)

sa_notype &lt;- glm(incidents ~ construction + operation, family = poisson,
  data = sa, offset = log(service))
summary(sa_notype)

sa_noperiod &lt;- glm(incidents ~ type + operation, family = poisson,
  data = sa, offset = log(service))
summary(sa_noperiod)

## model comparison
anova(sa_full, sa_notype, test = "Chisq")
anova(sa_full, sa_noperiod, test = "Chisq")

## test for overdispersion
dispersiontest(sa_full)
dispersiontest(sa_full, trafo = 2)
</code></pre>

<hr>
<h2 id='SIC33'>SIC33 Production Data</h2><span id='topic+SIC33'></span>

<h3>Description</h3>

<p>Statewide production data for primary metals industry (SIC 33).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("SIC33")</code></pre>


<h3>Format</h3>

<p>A data frame containing 27 observations on 3 variables.
</p>

<dl>
<dt>output</dt><dd><p>Value added.</p>
</dd>
<dt>labor</dt><dd><p>Labor input.</p>
</dd>
<dt>capital</dt><dd><p>Capital stock.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Greene (2003). Table F6.1.
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("SIC33", package = "AER")

## Example 6.2 in Greene (2003)
## Translog model
fm_tl &lt;- lm(output ~ labor + capital + I(0.5 * labor^2) + I(0.5 * capital^2) + I(labor * capital),
  data = log(SIC33))
## Cobb-Douglas model
fm_cb &lt;- lm(output ~ labor + capital, data = log(SIC33))

## Table 6.2 in Greene (2003)
deviance(fm_tl)
deviance(fm_cb)
summary(fm_tl)
summary(fm_cb)
vcov(fm_tl)
vcov(fm_cb)

## Cobb-Douglas vs. Translog model
anova(fm_cb, fm_tl)
## hypothesis of constant returns
linearHypothesis(fm_cb, "labor + capital = 1")

## 3D Visualization
library("scatterplot3d")
  s3d &lt;- scatterplot3d(log(SIC33)[,c(2, 3, 1)], pch = 16)
  s3d$plane3d(fm_cb, lty.box = "solid", col = 4)

## Interactive 3D Visualization

if(require("rgl")) {
  x &lt;- log(SIC33)[,2]
  y &lt;- log(SIC33)[,3]
  z &lt;- log(SIC33)[,1]
  plot3d(x, y, z, type = "s", col = "gray", radius = 0.1)
  x &lt;- seq(4.5, 7.5, by = 0.5)
  y &lt;- seq(5.5, 10, by = 0.5)
  z &lt;- outer(x, y, function(x, y) predict(fm_cb, data.frame(labor = x, capital = y)))
  surface3d(x, y, z, color = "blue", alpha = 0.5, shininess = 128)
}

</code></pre>

<hr>
<h2 id='SmokeBan'>Do Workplace Smoking Bans Reduce Smoking?</h2><span id='topic+SmokeBan'></span>

<h3>Description</h3>

<p>Estimation of the effect of workplace smoking bans on smoking of indoor workers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("SmokeBan")</code></pre>


<h3>Format</h3>

<p>A data frame containing 10,000 observations on 7 variables.
</p>

<dl>
<dt>smoker</dt><dd><p>factor. Is the individual a current smoker?</p>
</dd>
<dt>ban</dt><dd><p>factor. Is there a work area smoking ban?</p>
</dd>
<dt>age</dt><dd><p>age in years.</p>
</dd>
<dt>education</dt><dd><p>factor indicating highest education level attained:
high school (hs) drop out, high school graduate, some college,
college graduate, master's degree (or higher).</p>
</dd>
<dt>afam</dt><dd><p>factor. Is the individual African-American?</p>
</dd>  
<dt>hispanic</dt><dd><p>factor. Is the individual Hispanic?</p>
</dd> 
<dt>gender</dt><dd><p>factor indicating gender.</p>
</dd>
</dl>



<h3>Details</h3>

<p><code>SmokeBank</code> is a cross-sectional data set with observations on 10,000 indoor workers, which
is a subset of a 18,090-observation data set collected as part of the National Health
Interview Survey in 1991 and then again (with different respondents) in 1993.
The data set contains information on whether individuals were, or were not, subject to a workplace
smoking ban, whether or not the individuals smoked and other individual characteristics.
</p>


<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Evans, W. N., Farrelly, M.C., and Montgomery, E. (1999). Do Workplace Smoking Bans Reduce Smoking?
<em>American Economic Review</em>, <b>89</b>, 728&ndash;747.
</p>
<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("SmokeBan")

## proportion of non-smokers increases with education
plot(smoker ~ education, data = SmokeBan)

## proportion of non-smokers constant over age
plot(smoker ~ age, data = SmokeBan)
</code></pre>

<hr>
<h2 id='SportsCards'>Endowment Effect for Sports Cards</h2><span id='topic+SportsCards'></span>

<h3>Description</h3>

<p>Trading sports cards: Does ownership increase the value of goods to consumers?
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("SportsCards")</code></pre>


<h3>Format</h3>

<p>A data frame containing 148 observations on 9 variables.
</p>

<dl>
<dt>good</dt><dd><p>factor. Was the individual given good A or B (see below)?</p>
</dd>
<dt>dealer</dt><dd><p>factor. Was the individual a dealer?</p>
</dd>
<dt>permonth</dt><dd><p>number of trades per month reported by the individual.</p>
</dd>
<dt>years</dt><dd><p>number of years that the individual has been trading.</p>
</dd>
<dt>income</dt><dd><p>factor indicating income group (in 1000 USD).</p>
</dd>
<dt>gender</dt><dd><p>factor indicating gender.</p>
</dd>
<dt>education</dt><dd><p>factor indicating highest level of education (8th grade or less,
high school, 2-year college, other post-high school, 4-year college or graduate school).</p>
</dd>
<dt>age</dt><dd><p>age in years.</p>
</dd>
<dt>trade</dt><dd><p>factor. Did the individual trade the good he was given for the other good?</p>
</dd>
</dl>



<h3>Details</h3>

<p><code>SportsCards</code> contains data from 148 randomly selected traders who attended
a trading card show in Orlando, Florida, in 1998. Traders were randomly given one
of two sports collectables, say good A or good B, that had approximately equal market
value. Those receiving good A were then given the option of trading good A for good B
with the experimenter; those receiving good B were given the option of trading good B
for good A with the experimenter. Good A was a ticket stub from the game that Cal Ripken Jr.
set the record for consecutive games played, and Good B was a souvenir
from the game that Nolan Ryan won his 300th game.
</p>


<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>List, J.A. (2003). Does Market Experience Eliminate Market Anomalies?
<em>Quarterly Journal of Economcis</em>, <b>118</b>, 41&ndash;71.
</p>
<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("SportsCards")
summary(SportsCards)

plot(trade ~ permonth, data = SportsCards, breaks = c(0, 5, 10, 20, 30, 70))
plot(trade ~ years, data = SportsCards, breaks = c(0, 5, 10, 20, 60))
</code></pre>

<hr>
<h2 id='STAR'>Project STAR: Student-Teacher Achievement Ratio</h2><span id='topic+STAR'></span>

<h3>Description</h3>

<p>The Project STAR public access data set, assessing the effect
of reducing class size on test scores in the early grades.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("STAR")</code></pre>


<h3>Format</h3>

<p>A data frame containing 11,598 observations on 47 variables.
</p>

<dl>
<dt>gender</dt><dd><p>factor indicating student's gender.</p>
</dd>
<dt>ethnicity</dt><dd><p>factor indicating student's ethnicity with levels
<code>"cauc"</code> (Caucasian), <code>"afam"</code> (African-American), <code>"asian"</code> (Asian), 
<code>"hispanic"</code> (Hispanic), <code>"amindian"</code> (American-Indian) or <code>"other"</code>.</p>
</dd>
<dt>birth</dt><dd><p>student's birth quarter (of class <code><a href="zoo.html#topic+yearqtr">yearqtr</a></code>).</p>
</dd>
<dt>stark</dt><dd><p>factor indicating the STAR class type in kindergarten:
regular, small, or regular-with-aide. <code>NA</code> indicates that no STAR class was attended.</p>
</dd>
<dt>star1</dt><dd><p>factor indicating the STAR class type in 1st grade:
regular, small, or regular-with-aide. <code>NA</code> indicates that no STAR class was attended.</p>
</dd>
<dt>star2</dt><dd><p>factor indicating the STAR class type in 2nd grade:
regular, small, or regular-with-aide. <code>NA</code> indicates that no STAR class was attended.</p>
</dd>
<dt>star3</dt><dd><p>factor indicating the STAR class type in 3rd grade:
regular, small, or regular-with-aide. <code>NA</code> indicates that no STAR class was attended.</p>
</dd>
<dt>readk</dt><dd><p>total reading scaled score in kindergarten.</p>
</dd>
<dt>read1</dt><dd><p>total reading scaled score in 1st grade.</p>
</dd>
<dt>read2</dt><dd><p>total reading scaled score in 2nd grade.</p>
</dd>
<dt>read3</dt><dd><p>total reading scaled score in 3rd grade.</p>
</dd>
<dt>mathk</dt><dd><p>total math scaled score in kindergarten.</p>
</dd>
<dt>math1</dt><dd><p>total math scaled score in 1st grade.</p>
</dd>
<dt>math2</dt><dd><p>total math scaled score in 2nd grade.</p>
</dd>
<dt>math3</dt><dd><p>total math scaled score in 3rd grade.</p>
</dd>
<dt>lunchk</dt><dd><p>factor indicating whether the student qualified for free lunch in kindergarten.</p>
</dd>
<dt>lunch1</dt><dd><p>factor indicating whether the student qualified for free lunch in 1st grade.</p>
</dd>
<dt>lunch2</dt><dd><p>factor indicating whether the student qualified for free lunch in 2nd grade.</p>
</dd>
<dt>lunch3</dt><dd><p>factor indicating whether the student qualified for free lunch in 3rd grade.</p>
</dd>
<dt>schoolk</dt><dd><p>factor indicating school type in kindergarten:
<code>"inner-city"</code>, <code>"suburban"</code>, <code>"rural"</code> or <code>"urban"</code>.</p>
</dd>
<dt>school1</dt><dd><p>factor indicating school type in 1st grade:
<code>"inner-city"</code>, <code>"suburban"</code>, <code>"rural"</code> or <code>"urban"</code>.</p>
</dd>
<dt>school2</dt><dd><p>factor indicating school type in 2nd grade:
<code>"inner-city"</code>, <code>"suburban"</code>, <code>"rural"</code> or <code>"urban"</code>.</p>
</dd>
<dt>school3</dt><dd><p>factor indicating school type in 3rd grade:
<code>"inner-city"</code>, <code>"suburban"</code>, <code>"rural"</code> or <code>"urban"</code>.</p>
</dd>
<dt>degreek</dt><dd><p>factor indicating highest degree of kindergarten teacher:
<code>"bachelor"</code>, <code>"master"</code>, <code>"specialist"</code>, or <code>"master+"</code>.</p>
</dd>
<dt>degree1</dt><dd><p>factor indicating highest degree of 1st grade teacher:
<code>"bachelor"</code>, <code>"master"</code>, <code>"specialist"</code>, or <code>"phd"</code>.</p>
</dd>
<dt>degree2</dt><dd><p>factor indicating highest degree of 2nd grade teacher:
<code>"bachelor"</code>, <code>"master"</code>, <code>"specialist"</code>, or <code>"phd"</code>.</p>
</dd>
<dt>degree3</dt><dd><p>factor indicating highest degree of 3rd grade teacher:
<code>"bachelor"</code>, <code>"master"</code>, <code>"specialist"</code>, or <code>"phd"</code>.</p>
</dd>
<dt>ladderk</dt><dd><p>factor indicating teacher's career ladder level in kindergarten: <code>"level1"</code>,
<code>"level2"</code>, <code>"level3"</code>, <code>"apprentice"</code>, <code>"probation"</code> or <code>"pending"</code>.</p>
</dd>
<dt>ladder1</dt><dd><p>factor indicating teacher's career ladder level in 1st grade: <code>"level1"</code>,
<code>"level2"</code>, <code>"level3"</code>, <code>"apprentice"</code>, <code>"probation"</code> or <code>"noladder"</code>.</p>
</dd>
<dt>ladder2</dt><dd><p>factor indicating teacher's career ladder level in 2nd grade: <code>"level1"</code>,
<code>"level2"</code>, <code>"level3"</code>, <code>"apprentice"</code>, <code>"probation"</code> or <code>"noladder"</code>.</p>
</dd>
<dt>ladder3</dt><dd><p>factor indicating teacher's career ladder level in 3rd grade: <code>"level1"</code>,
<code>"level2"</code>, <code>"level3"</code>, <code>"apprentice"</code>, <code>"probation"</code> or <code>"noladder"</code>.</p>
</dd>
<dt>experiencek</dt><dd><p>years of teacher's total teaching experience in kindergarten.</p>
</dd>
<dt>experience1</dt><dd><p>years of teacher's total teaching experience in 1st grade.</p>
</dd>
<dt>experience2</dt><dd><p>years of teacher's total teaching experience in 2nd grade.</p>
</dd>
<dt>experience3</dt><dd><p>years of teacher's total teaching experience in 3rd grade.</p>
</dd>
<dt>tethnicityk</dt><dd><p>factor indicating teacher's ethnicity in kindergarten with levels
<code>"cauc"</code> (Caucasian) or <code>"afam"</code> (African-American).</p>
</dd>
<dt>tethnicity1</dt><dd><p>factor indicating teacher's ethnicity in 1st grade with levels
<code>"cauc"</code> (Caucasian) or <code>"afam"</code> (African-American).</p>
</dd>
<dt>tethnicity2</dt><dd><p>factor indicating teacher's ethnicity in 2nd grade with levels
<code>"cauc"</code> (Caucasian) or <code>"afam"</code> (African-American).</p>
</dd>
<dt>tethnicity3</dt><dd><p>factor indicating teacher's ethnicity in 3rd grade with levels
<code>"cauc"</code> (Caucasian), <code>"afam"</code> (African-American), or <code>"asian"</code> (Asian).</p>
</dd>
<dt>systemk</dt><dd><p>factor indicating school system ID in kindergarten.</p>
</dd>
<dt>system1</dt><dd><p>factor indicating school system ID in 1st grade.</p>
</dd>
<dt>system2</dt><dd><p>factor indicating school system ID in 2nd grade.</p>
</dd>
<dt>system3</dt><dd><p>factor indicating school system ID in 3rd grade.</p>
</dd>
<dt>schoolidk</dt><dd><p>factor indicating school ID in kindergarten.</p>
</dd>
<dt>schoolid1</dt><dd><p>factor indicating school ID in 1st grade.</p>
</dd>
<dt>schoolid2</dt><dd><p>factor indicating school ID in 2nd grade.</p>
</dd>
<dt>schoolid3</dt><dd><p>factor indicating school ID in 3rd grade.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Project STAR (Student/Teacher Achievement Ratio) was a four-year
longitudinal class-size study funded by the Tennessee General Assembly
and conducted in the late 1980s by the State Department of Education. Over 7,000 students
in 79 schools were randomly assigned into one of three interventions:
small class (13 to 17 students per teacher), regular class (22 to 25
students per teacher), and regular-with-aide class (22 to 25 students
with a full-time teacher's aide).  Classroom teachers were also randomly
assigned to the classes they would teach. The interventions were
initiated as the students entered school in kindergarten and continued
through third grade.
</p>
<p>The Project STAR public access data set contains data on test scores,
treatment groups, and student and teacher characteristics for
the four years of the experiment, from academic year 1985&ndash;1986 to
academic year 1988&ndash;1989. The test score data analyzed in this
chapter are the sum of the scores on the math and reading portion of the
Stanford Achievement Test. 
</p>
<p>Stock and Watson (2007) obtained the data set from the
Project STAR Web site.
</p>
<p>The data is provided in wide format. Reshaping it into long format
is illustrated below. Note that the levels of the <code>degree</code>, <code>ladder</code>
and <code>tethnicity</code> variables differ slightly between kindergarten
and higher grades.
</p>


<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("STAR")

## Stock and Watson, p. 488
fmk &lt;- lm(I(readk + mathk) ~ stark, data = STAR)
fm1 &lt;- lm(I(read1 + math1) ~ star1, data = STAR)
fm2 &lt;- lm(I(read2 + math2) ~ star2, data = STAR)
fm3 &lt;- lm(I(read3 + math3) ~ star3, data = STAR)

coeftest(fm3, vcov = sandwich)
plot(I(read3 + math3) ~ star3, data = STAR)

## Stock and Watson, p. 489
fmke &lt;- lm(I(readk + mathk) ~ stark + experiencek, data = STAR)
coeftest(fmke, vcov = sandwich)

## reshape data from wide into long format
## 1. variables and their levels
nam &lt;- c("star", "read", "math", "lunch", "school", "degree", "ladder",
  "experience", "tethnicity", "system", "schoolid")
lev &lt;- c("k", "1", "2", "3")
## 2. reshaping
star &lt;- reshape(STAR, idvar = "id", ids = row.names(STAR),
  times = lev, timevar = "grade", direction = "long",
  varying = lapply(nam, function(x) paste(x, lev, sep = "")))
## 3. improve variable names and type
names(star)[5:15] &lt;- nam
star$id &lt;- factor(star$id)
star$grade &lt;- factor(star$grade, levels = lev, labels = c("kindergarten", "1st", "2nd", "3rd"))
rm(nam, lev)

## fit a single model nested in grade (equivalent to fmk, fm1, fm2, fmk)
fm &lt;- lm(I(read + math) ~ 0 + grade/star, data = star)
coeftest(fm, vcov = sandwich)

## visualization
library("lattice")
bwplot(I(read + math) ~ star | grade, data = star)
</code></pre>

<hr>
<h2 id='StockWatson2007'>Data and Examples from Stock and Watson (2007)</h2><span id='topic+StockWatson2007'></span>

<h3>Description</h3>

<p>This manual page collects a list of examples from the book. Some 
solutions might not be exact and the list is certainly not complete.
If you have suggestions for improvement (preferably in the form of code),
please contact the package maintainer.
</p>


<h3>References</h3>

<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CartelStability">CartelStability</a></code>, <code><a href="#topic+CASchools">CASchools</a></code>, <code><a href="#topic+CigarettesSW">CigarettesSW</a></code>,
<code><a href="#topic+CollegeDistance">CollegeDistance</a></code>, <code><a href="#topic+CPSSW04">CPSSW04</a></code>, <code><a href="#topic+CPSSW3">CPSSW3</a></code>, <code><a href="#topic+CPSSW8">CPSSW8</a></code>,
<code><a href="#topic+CPSSW9298">CPSSW9298</a></code>, <code><a href="#topic+CPSSW9204">CPSSW9204</a></code>, <code><a href="#topic+CPSSWEducation">CPSSWEducation</a></code>,
<code><a href="#topic+Fatalities">Fatalities</a></code>, <code><a href="#topic+Fertility">Fertility</a></code>, <code><a href="#topic+Fertility2">Fertility2</a></code>, <code><a href="#topic+FrozenJuice">FrozenJuice</a></code>,
<code><a href="#topic+GrowthSW">GrowthSW</a></code>, <code><a href="#topic+Guns">Guns</a></code>, <code><a href="#topic+HealthInsurance">HealthInsurance</a></code>, <code><a href="#topic+HMDA">HMDA</a></code>,
<code><a href="#topic+Journals">Journals</a></code>, <code><a href="#topic+MASchools">MASchools</a></code>, <code><a href="#topic+NYSESW">NYSESW</a></code>, <code><a href="#topic+ResumeNames">ResumeNames</a></code>,
<code><a href="#topic+SmokeBan">SmokeBan</a></code>, <code><a href="#topic+SportsCards">SportsCards</a></code>, <code><a href="#topic+STAR">STAR</a></code>, <code><a href="#topic+TeachingRatings">TeachingRatings</a></code>,
<code><a href="#topic+USMacroSW">USMacroSW</a></code>, <code><a href="#topic+USMacroSWM">USMacroSWM</a></code>, <code><a href="#topic+USMacroSWQ">USMacroSWQ</a></code>, <code><a href="#topic+USSeatBelts">USSeatBelts</a></code>,
<code><a href="#topic+USStocksSW">USStocksSW</a></code>, <code><a href="#topic+WeakInstrument">WeakInstrument</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
###############################
## Current Population Survey ##
###############################

## p. 165
data("CPSSWEducation", package = "AER")
plot(earnings ~ education, data = CPSSWEducation)
fm &lt;- lm(earnings ~ education, data = CPSSWEducation)
coeftest(fm, vcov = sandwich)
abline(fm)


############################
## California test scores ##
############################

## data and transformations
data("CASchools", package = "AER")
CASchools &lt;- transform(CASchools,
  stratio = students/teachers,
  score   = (math + read)/2
)

## p. 152
fm1 &lt;- lm(score ~ stratio, data = CASchools)
coeftest(fm1, vcov = sandwich)

## p. 159
fm2 &lt;- lm(score ~ I(stratio &lt; 20), data = CASchools)
## p. 199
fm3 &lt;- lm(score ~ stratio + english, data = CASchools)
## p. 224
fm4 &lt;- lm(score ~ stratio + expenditure + english, data = CASchools)

## Table 7.1, p. 242 (numbers refer to columns)
fmc3 &lt;- lm(score ~ stratio + english + lunch, data = CASchools)
fmc4 &lt;- lm(score ~ stratio + english + calworks, data = CASchools)
fmc5 &lt;- lm(score ~ stratio + english + lunch + calworks, data = CASchools)

## Equation 8.2, p. 258
fmquad &lt;- lm(score ~ income + I(income^2), data = CASchools)
## Equation 8.11, p. 266
fmcub &lt;- lm(score ~ income + I(income^2) + I(income^3), data = CASchools)
## Equation 8.23, p. 272
fmloglog &lt;- lm(log(score) ~ log(income), data = CASchools)
## Equation 8.24, p. 274
fmloglin &lt;- lm(log(score) ~ income, data = CASchools)
## Equation 8.26, p. 275
fmlinlogcub &lt;- lm(score ~ log(income) + I(log(income)^2) + I(log(income)^3),
  data = CASchools)

## Table 8.3, p. 292 (numbers refer to columns)
fmc2 &lt;- lm(score ~ stratio + english + lunch + log(income), data = CASchools)
fmc7 &lt;- lm(score ~ stratio + I(stratio^2) + I(stratio^3) + english + lunch + log(income),
  data = CASchools)


#####################################
## Economics journal Subscriptions ##
#####################################

## data and transformed variables
data("Journals", package = "AER")
journals &lt;- Journals[, c("subs", "price")]
journals$citeprice &lt;- Journals$price/Journals$citations
journals$age &lt;- 2000 - Journals$foundingyear
journals$chars &lt;- Journals$charpp*Journals$pages/10^6

## Figure 8.9 (a) and (b)
plot(subs ~ citeprice, data = journals, pch = 19)
plot(log(subs) ~ log(citeprice), data = journals, pch = 19)
fm1 &lt;- lm(log(subs) ~ log(citeprice), data = journals)
abline(fm1)

## Table 8.2, use HC1 for comparability with Stata 
fm1 &lt;- lm(subs ~ citeprice, data = log(journals))
fm2 &lt;- lm(subs ~ citeprice + age + chars, data = log(journals))
fm3 &lt;- lm(subs ~ citeprice + I(citeprice^2) + I(citeprice^3) +
  age + I(age * citeprice) + chars, data = log(journals))
fm4 &lt;- lm(subs ~ citeprice + age + I(age * citeprice) + chars, data = log(journals))
coeftest(fm1, vcov = vcovHC(fm1, type = "HC1"))
coeftest(fm2, vcov = vcovHC(fm2, type = "HC1"))
coeftest(fm3, vcov = vcovHC(fm3, type = "HC1"))
coeftest(fm4, vcov = vcovHC(fm4, type = "HC1"))
waldtest(fm3, fm4, vcov = vcovHC(fm3, type = "HC1"))


###############################
## Massachusetts test scores ##
###############################

## compare Massachusetts with California
data("MASchools", package = "AER")
data("CASchools", package = "AER")
CASchools &lt;- transform(CASchools,
  stratio = students/teachers,
  score4  = (math + read)/2
)

## parts of Table 9.1, p. 330
vars &lt;- c("score4", "stratio", "english", "lunch", "income")
cbind(
  CA_mean = sapply(CASchools[, vars], mean),
  CA_sd   = sapply(CASchools[, vars], sd),
  MA_mean = sapply(MASchools[, vars], mean),
  MA_sd   = sapply(MASchools[, vars], sd))

## Table 9.2, pp. 332--333, numbers refer to columns
MASchools &lt;- transform(MASchools, higheng = english &gt; median(english))
fm1 &lt;- lm(score4 ~ stratio, data = MASchools)
fm2 &lt;- lm(score4 ~ stratio + english + lunch + log(income), data = MASchools)
fm3 &lt;- lm(score4 ~ stratio + english + lunch + income + I(income^2) + I(income^3),
  data = MASchools)
fm4 &lt;- lm(score4 ~ stratio + I(stratio^2) + I(stratio^3) + english + lunch +
  income + I(income^2) + I(income^3), data = MASchools)
fm5 &lt;- lm(score4 ~ stratio + higheng + I(higheng * stratio) + lunch +
  income + I(income^2) + I(income^3), data = MASchools)
fm6 &lt;- lm(score4 ~ stratio + lunch + income + I(income^2) + I(income^3),
  data = MASchools)

## for comparability with Stata use HC1 below
coeftest(fm1, vcov = vcovHC(fm1, type = "HC1"))
coeftest(fm2, vcov = vcovHC(fm2, type = "HC1"))
coeftest(fm3, vcov = vcovHC(fm3, type = "HC1"))
coeftest(fm4, vcov = vcovHC(fm4, type = "HC1"))
coeftest(fm5, vcov = vcovHC(fm5, type = "HC1"))
coeftest(fm6, vcov = vcovHC(fm6, type = "HC1"))

## Testing exclusion of groups of variables
fm3r &lt;- update(fm3, . ~ . - I(income^2) - I(income^3))
waldtest(fm3, fm3r, vcov = vcovHC(fm3, type = "HC1"))

fm4r_str1 &lt;- update(fm4, . ~ . - stratio - I(stratio^2) - I(stratio^3))
waldtest(fm4, fm4r_str1, vcov = vcovHC(fm4, type = "HC1"))
fm4r_str2 &lt;- update(fm4, . ~ . - I(stratio^2) - I(stratio^3))
waldtest(fm4, fm4r_str2, vcov = vcovHC(fm4, type = "HC1"))
fm4r_inc &lt;- update(fm4, . ~ . - I(income^2) - I(income^3))
waldtest(fm4, fm4r_inc, vcov = vcovHC(fm4, type = "HC1"))

fm5r_str &lt;- update(fm5, . ~ . - stratio - I(higheng * stratio))
waldtest(fm5, fm5r_str, vcov = vcovHC(fm5, type = "HC1"))
fm5r_inc &lt;- update(fm5, . ~ . - I(income^2) - I(income^3))
waldtest(fm5, fm5r_inc, vcov = vcovHC(fm5, type = "HC1"))
fm5r_high &lt;- update(fm5, . ~ . - higheng - I(higheng * stratio))
waldtest(fm5, fm5r_high, vcov = vcovHC(fm5, type = "HC1"))

fm6r_inc &lt;- update(fm6, . ~ . - I(income^2) - I(income^3))
waldtest(fm6, fm6r_inc, vcov = vcovHC(fm6, type = "HC1"))


##################################
## Home mortgage disclosure act ##
##################################

## data
data("HMDA", package = "AER")

## 11.1, 11.3, 11.7, 11.8 and 11.10, pp. 387--395
fm1 &lt;- lm(I(as.numeric(deny) - 1) ~ pirat, data = HMDA)
fm2 &lt;- lm(I(as.numeric(deny) - 1) ~ pirat + afam, data = HMDA)
fm3 &lt;- glm(deny ~ pirat, family = binomial(link = "probit"), data = HMDA)
fm4 &lt;- glm(deny ~ pirat + afam, family = binomial(link = "probit"), data = HMDA)
fm5 &lt;- glm(deny ~ pirat + afam, family = binomial(link = "logit"), data = HMDA)

## Table 11.1, p. 401
mean(HMDA$pirat)
mean(HMDA$hirat)
mean(HMDA$lvrat)
mean(as.numeric(HMDA$chist))
mean(as.numeric(HMDA$mhist))
mean(as.numeric(HMDA$phist)-1)
prop.table(table(HMDA$insurance))
prop.table(table(HMDA$selfemp))
prop.table(table(HMDA$single))
prop.table(table(HMDA$hschool))
mean(HMDA$unemp)
prop.table(table(HMDA$condomin))
prop.table(table(HMDA$afam))
prop.table(table(HMDA$deny))

## Table 11.2, pp. 403--404, numbers refer to columns
HMDA$lvrat &lt;- factor(ifelse(HMDA$lvrat &lt; 0.8, "low",
  ifelse(HMDA$lvrat &gt;= 0.8 &amp; HMDA$lvrat &lt;= 0.95, "medium", "high")),
  levels = c("low", "medium", "high"))
HMDA$mhist &lt;- as.numeric(HMDA$mhist)
HMDA$chist &lt;- as.numeric(HMDA$chist)

fm1 &lt;- lm(I(as.numeric(deny) - 1) ~ afam + pirat + hirat + lvrat + chist + mhist +
  phist + insurance + selfemp, data = HMDA)
fm2 &lt;- glm(deny ~ afam + pirat + hirat + lvrat + chist + mhist + phist + insurance +
  selfemp, family = binomial, data = HMDA)
fm3 &lt;- glm(deny ~ afam + pirat + hirat + lvrat + chist + mhist + phist + insurance +
  selfemp, family = binomial(link = "probit"), data = HMDA)
fm4 &lt;- glm(deny ~ afam + pirat + hirat + lvrat + chist + mhist + phist + insurance +
  selfemp + single + hschool + unemp, family = binomial(link = "probit"), data = HMDA)
fm5 &lt;- glm(deny ~ afam + pirat + hirat + lvrat + chist + mhist + phist + insurance +
  selfemp + single + hschool + unemp + condomin + 
  I(mhist==3) + I(mhist==4) + I(chist==3) + I(chist==4) + I(chist==5) + I(chist==6), 
  family = binomial(link = "probit"), data = HMDA)
fm6 &lt;- glm(deny ~ afam * (pirat + hirat) + lvrat + chist + mhist + phist + insurance +
  selfemp + single + hschool + unemp, family = binomial(link = "probit"), data = HMDA)
coeftest(fm1, vcov = sandwich)

fm4r &lt;- update(fm4, . ~ . - single - hschool - unemp)
waldtest(fm4, fm4r, vcov = sandwich)
fm5r &lt;- update(fm5, . ~ . - single - hschool - unemp)
waldtest(fm5, fm5r, vcov = sandwich)
fm6r &lt;- update(fm6, . ~ . - single - hschool - unemp)
waldtest(fm6, fm6r, vcov = sandwich)

fm5r2 &lt;- update(fm5, . ~ . - I(mhist==3) - I(mhist==4) - I(chist==3) - I(chist==4) -
  I(chist==5) - I(chist==6))
waldtest(fm5, fm5r2, vcov = sandwich)

fm6r2 &lt;- update(fm6, . ~ . - afam * (pirat + hirat) + pirat + hirat)
waldtest(fm6, fm6r2, vcov = sandwich)

fm6r3 &lt;- update(fm6, . ~ . - afam * (pirat + hirat) + pirat + hirat + afam)
waldtest(fm6, fm6r3, vcov = sandwich)



#########################################################
## Shooting down the "More Guns Less Crime" hypothesis ##
#########################################################

## data
data("Guns", package = "AER")

## Empirical Exercise 10.1
fm1 &lt;- lm(log(violent) ~ law, data = Guns)
fm2 &lt;- lm(log(violent) ~ law + prisoners + density + income + 
  population + afam + cauc + male, data = Guns)
fm3 &lt;- lm(log(violent) ~ law + prisoners + density + income + 
  population + afam + cauc + male + state, data = Guns)
fm4 &lt;- lm(log(violent) ~ law + prisoners + density + income + 
  population + afam + cauc + male + state + year, data = Guns)
coeftest(fm1, vcov = sandwich)
coeftest(fm2, vcov = sandwich)
printCoefmat(coeftest(fm3, vcov = sandwich)[1:9,])
printCoefmat(coeftest(fm4, vcov = sandwich)[1:9,])


###########################
## US traffic fatalities ##
###########################

## data from Stock and Watson (2007)
data("Fatalities", package = "AER")
Fatalities &lt;- transform(Fatalities, 
  ## fatality rate (number of traffic deaths per 10,000 people living in that state in that year)
  frate = fatal/pop * 10000,
  ## add discretized version of minimum legal drinking age
  drinkagec = relevel(cut(drinkage, breaks = 18:22, include.lowest = TRUE, right = FALSE), ref = 4),
  ## any punishment?
  punish = factor(jail == "yes" | service == "yes", labels = c("no", "yes"))
)
## plm package
library("plm")

## for comparability with Stata we use HC1 below
## p. 351, Eq. (10.2)
f1982 &lt;- subset(Fatalities, year == "1982")
fm_1982 &lt;- lm(frate ~ beertax, data = f1982)
coeftest(fm_1982, vcov = vcovHC(fm_1982, type = "HC1"))

## p. 353, Eq. (10.3)
f1988 &lt;- subset(Fatalities, year == "1988")
fm_1988 &lt;- lm(frate ~ beertax, data = f1988)
coeftest(fm_1988, vcov = vcovHC(fm_1988, type = "HC1"))

## pp. 355, Eq. (10.8)
fm_diff &lt;- lm(I(f1988$frate - f1982$frate) ~ I(f1988$beertax - f1982$beertax))
coeftest(fm_diff, vcov = vcovHC(fm_diff, type = "HC1"))

## pp. 360, Eq. (10.15)
##   (1) via formula
fm_sfe &lt;- lm(frate ~ beertax + state - 1, data = Fatalities)
##   (2) by hand
fat &lt;- with(Fatalities,
  data.frame(frates = frate - ave(frate, state),
  beertaxs = beertax - ave(beertax, state)))
fm_sfe2 &lt;- lm(frates ~ beertaxs - 1, data = fat)
##   (3) via plm()
fm_sfe3 &lt;- plm(frate ~ beertax, data = Fatalities,
  index = c("state", "year"), model = "within")

coeftest(fm_sfe, vcov = vcovHC(fm_sfe, type = "HC1"))[1,]

## uses different df in sd and p-value
coeftest(fm_sfe2, vcov = vcovHC(fm_sfe2, type = "HC1"))[1,]

## uses different df in p-value
coeftest(fm_sfe3, vcov = vcovHC(fm_sfe3, type = "HC1", method = "white1"))[1,]


## pp. 363, Eq. (10.21)
## via lm()
fm_stfe &lt;- lm(frate ~ beertax + state + year - 1, data = Fatalities)
coeftest(fm_stfe, vcov = vcovHC(fm_stfe, type = "HC1"))[1,]
## via plm()
fm_stfe2 &lt;- plm(frate ~ beertax, data = Fatalities,
  index = c("state", "year"), model = "within", effect = "twoways")
coeftest(fm_stfe2, vcov = vcovHC) ## different


## p. 368, Table 10.1, numbers refer to cols.
fm1 &lt;- plm(frate ~ beertax, data = Fatalities, index = c("state", "year"),
  model = "pooling")
fm2 &lt;- plm(frate ~ beertax, data = Fatalities, index = c("state", "year"),
  model = "within")
fm3 &lt;- plm(frate ~ beertax, data = Fatalities, index = c("state", "year"),
  model = "within", effect = "twoways")
fm4 &lt;- plm(frate ~ beertax + drinkagec + jail + service + miles + unemp + log(income),
  data = Fatalities, index = c("state", "year"), model = "within", effect = "twoways")
fm5 &lt;- plm(frate ~ beertax + drinkagec + jail + service + miles,
  data = Fatalities, index = c("state", "year"), model = "within", effect = "twoways")
fm6 &lt;- plm(frate ~ beertax + drinkage + punish + miles + unemp + log(income),
  data = Fatalities, index = c("state", "year"), model = "within", effect = "twoways")
fm7 &lt;- plm(frate ~ beertax + drinkagec + jail + service + miles + unemp + log(income),
  data = Fatalities, index = c("state", "year"), model = "within", effect = "twoways")
## summaries not too close, s.e.s generally too small
coeftest(fm1, vcov = vcovHC)
coeftest(fm2, vcov = vcovHC)
coeftest(fm3, vcov = vcovHC)
coeftest(fm4, vcov = vcovHC)
coeftest(fm5, vcov = vcovHC)
coeftest(fm6, vcov = vcovHC)
coeftest(fm7, vcov = vcovHC)


######################################
## Cigarette consumption panel data ##
######################################

## data and transformations 
data("CigarettesSW", package = "AER")
CigarettesSW &lt;- transform(CigarettesSW,
  rprice  = price/cpi,
  rincome = income/population/cpi,
  rtax    = tax/cpi,
  rtdiff  = (taxs - tax)/cpi
)
c1985 &lt;- subset(CigarettesSW, year == "1985")
c1995 &lt;- subset(CigarettesSW, year == "1995")

## convenience function: HC1 covariances
hc1 &lt;- function(x) vcovHC(x, type = "HC1")

## Equations 12.9--12.11
fm_s1 &lt;- lm(log(rprice) ~ rtdiff, data = c1995)
coeftest(fm_s1, vcov = hc1)
fm_s2 &lt;- lm(log(packs) ~ fitted(fm_s1), data = c1995)
fm_ivreg &lt;- ivreg(log(packs) ~ log(rprice) | rtdiff, data = c1995)
coeftest(fm_ivreg, vcov = hc1)

## Equation 12.15
fm_ivreg2 &lt;- ivreg(log(packs) ~ log(rprice) + log(rincome) | log(rincome) + rtdiff, data = c1995)
coeftest(fm_ivreg2, vcov = hc1)
## Equation 12.16
fm_ivreg3 &lt;- ivreg(log(packs) ~ log(rprice) + log(rincome) | log(rincome) + rtdiff + rtax,
  data = c1995)
coeftest(fm_ivreg3, vcov = hc1)

## Table 12.1, p. 448
ydiff &lt;- log(c1995$packs) - log(c1985$packs)
pricediff &lt;- log(c1995$price/c1995$cpi) - log(c1985$price/c1985$cpi)
incdiff &lt;- log(c1995$income/c1995$population/c1995$cpi) -
  log(c1985$income/c1985$population/c1985$cpi)
taxsdiff &lt;- (c1995$taxs - c1995$tax)/c1995$cpi - (c1985$taxs - c1985$tax)/c1985$cpi
taxdiff &lt;- c1995$tax/c1995$cpi - c1985$tax/c1985$cpi

fm_diff1 &lt;- ivreg(ydiff ~ pricediff + incdiff | incdiff + taxsdiff)
fm_diff2 &lt;- ivreg(ydiff ~ pricediff + incdiff | incdiff + taxdiff)
fm_diff3 &lt;- ivreg(ydiff ~ pricediff + incdiff | incdiff + taxsdiff + taxdiff)
coeftest(fm_diff1, vcov = hc1)
coeftest(fm_diff2, vcov = hc1)
coeftest(fm_diff3, vcov = hc1)

## checking instrument relevance
fm_rel1 &lt;- lm(pricediff ~ taxsdiff + incdiff)
fm_rel2 &lt;- lm(pricediff ~ taxdiff + incdiff)
fm_rel3 &lt;- lm(pricediff ~ incdiff + taxsdiff + taxdiff)
linearHypothesis(fm_rel1, "taxsdiff = 0", vcov = hc1)
linearHypothesis(fm_rel2, "taxdiff = 0", vcov = hc1)
linearHypothesis(fm_rel3, c("taxsdiff = 0", "taxdiff = 0"),  vcov = hc1)

## testing overidentifying restrictions (J test)
fm_or &lt;- lm(residuals(fm_diff3) ~ incdiff + taxsdiff + taxdiff)
(fm_or_test &lt;- linearHypothesis(fm_or, c("taxsdiff = 0", "taxdiff = 0"), test = "Chisq"))
## warning: df (and hence p-value) invalid above.
## correct df: # instruments - # endogenous variables
pchisq(fm_or_test[2,5], df.residual(fm_diff3) - df.residual(fm_or), lower.tail = FALSE)


#####################################################
## Project STAR: Student-teacher achievement ratio ##
#####################################################

## data
data("STAR", package = "AER")

## p. 488
fmk &lt;- lm(I(readk + mathk) ~ stark, data = STAR)
fm1 &lt;- lm(I(read1 + math1) ~ star1, data = STAR)
fm2 &lt;- lm(I(read2 + math2) ~ star2, data = STAR)
fm3 &lt;- lm(I(read3 + math3) ~ star3, data = STAR)
coeftest(fm3, vcov = sandwich)

## p. 489
fmke &lt;- lm(I(readk + mathk) ~ stark + experiencek, data = STAR)
coeftest(fmke, vcov = sandwich)

## equivalently:
##   - reshape data from wide into long format
##   - fit a single model nested in grade
## (a) variables and their levels
nam &lt;- c("star", "read", "math", "lunch", "school", "degree", "ladder",
  "experience", "tethnicity", "system", "schoolid")
lev &lt;- c("k", "1", "2", "3")
## (b) reshaping
star &lt;- reshape(STAR, idvar = "id", ids = row.names(STAR),
  times = lev, timevar = "grade", direction = "long",
  varying = lapply(nam, function(x) paste(x, lev, sep = "")))
## (c) improve variable names and type
names(star)[5:15] &lt;- nam
star$id &lt;- factor(star$id)
star$grade &lt;- factor(star$grade, levels = lev,
  labels = c("kindergarten", "1st", "2nd", "3rd"))
rm(nam, lev)
## (d) model fitting
fm &lt;- lm(I(read + math) ~ 0 + grade/star, data = star)


#################################################
## Quarterly US macroeconomic data (1957-2005) ##
#################################################

## data
data("USMacroSW", package = "AER")
library("dynlm")
usm &lt;- ts.intersect(USMacroSW, 4 * 100 * diff(log(USMacroSW[, "cpi"])))
colnames(usm) &lt;- c(colnames(USMacroSW), "infl")

## Equation 14.7, p. 536
fm_ar1 &lt;- dynlm(d(infl) ~ L(d(infl)),
  data = usm, start = c(1962,1), end = c(2004,4))
coeftest(fm_ar1, vcov = sandwich)

## Equation 14.13, p. 538
fm_ar4 &lt;- dynlm(d(infl) ~ L(d(infl), 1:4), 
  data = usm, start = c(1962,1), end = c(2004,4))
coeftest(fm_ar4, vcov = sandwich)

## Equation 14.16, p. 542
fm_adl41 &lt;- dynlm(d(infl) ~ L(d(infl), 1:4) + L(unemp),
  data = usm, start = c(1962,1), end = c(2004,4))
coeftest(fm_adl41, vcov = sandwich)

## Equation 14.17, p. 542
fm_adl44 &lt;- dynlm(d(infl) ~ L(d(infl), 1:4) + L(unemp, 1:4),
  data = usm, start = c(1962,1), end = c(2004,4))
coeftest(fm_adl44, vcov = sandwich)

## Granger causality test mentioned on p. 547
waldtest(fm_ar4, fm_adl44, vcov = sandwich)  

## Equation 14.28, p. 559
fm_sp1 &lt;- dynlm(infl ~ log(gdpjp), start = c(1965,1), end = c(1981,4), data = usm)
coeftest(fm_sp1, vcov = sandwich)

## Equation 14.29, p. 559
fm_sp2 &lt;- dynlm(infl ~ log(gdpjp), start = c(1982,1), end = c(2004,4), data = usm)
coeftest(fm_sp2, vcov = sandwich)

## Equation 14.34, p. 563: ADF by hand
fm_adf &lt;- dynlm(d(infl) ~ L(infl) + L(d(infl), 1:4), 
  data = usm, start = c(1962,1), end = c(2004,4))
coeftest(fm_adf)

## Figure 14.5, p. 570
## SW perform partial break test of unemp coefs
## here full model is used
library("strucchange")
infl &lt;- usm[, "infl"]
unemp &lt;- usm[, "unemp"]
usm &lt;- ts.intersect(diff(infl), lag(diff(infl), k = -1), lag(diff(infl), k = -2),
  lag(diff(infl), k = -3), lag(diff(infl), k = -4), lag(unemp, k = -1),
  lag(unemp, k = -2), lag(unemp, k = -3), lag(unemp, k = -4))
colnames(usm) &lt;- c("dinfl", paste("dinfl", 1:4, sep = ""), paste("unemp", 1:4, sep = ""))
usm &lt;- window(usm, start = c(1962, 1), end = c(2004, 4))
fs &lt;- Fstats(dinfl ~ ., data = usm)
sctest(fs, type = "supF") 
plot(fs)

## alternatively: re-use fm_adl44
mf &lt;- model.frame(fm_adl44)
mf &lt;- ts(as.matrix(mf), start = c(1962, 1), freq = 4)
colnames(mf) &lt;- c("y", paste("x", 1:8, sep = ""))
ff &lt;- as.formula(paste("y", "~",  paste("x", 1:8, sep = "", collapse = " + ")))
fs &lt;- Fstats(ff, data = mf, from = 0.1)
plot(fs)
lines(boundary(fs, alpha = 0.01), lty = 2, col = 2)
lines(boundary(fs, alpha = 0.1), lty = 3, col = 2)


##########################################
## Monthly US stock returns (1931-2002) ##
##########################################

## package and data
library("dynlm")
data("USStocksSW", package = "AER")

## Table 14.3, p. 540
fm1 &lt;- dynlm(returns ~ L(returns), data = USStocksSW, start = c(1960,1))
coeftest(fm1, vcov = sandwich)
fm2 &lt;- dynlm(returns ~ L(returns, 1:2), data = USStocksSW, start = c(1960,1))
waldtest(fm2, vcov = sandwich)
fm3 &lt;- dynlm(returns ~ L(returns, 1:4), data = USStocksSW, start = c(1960,1))
waldtest(fm3, vcov = sandwich)

## Table 14.7, p. 574
fm4 &lt;- dynlm(returns ~ L(returns) + L(d(dividend)),
  data = USStocksSW, start = c(1960, 1))
fm5 &lt;- dynlm(returns ~ L(returns, 1:2) + L(d(dividend), 1:2),
  data = USStocksSW, start = c(1960, 1))
fm6 &lt;- dynlm(returns ~ L(returns) + L(dividend),
  data = USStocksSW, start = c(1960, 1))


##################################
## Price of frozen orange juice ##
##################################

## load data
data("FrozenJuice")

## Stock and Watson, p. 594
library("dynlm")
fm_dyn &lt;- dynlm(d(100 * log(price/ppi)) ~ fdd, data = FrozenJuice)
coeftest(fm_dyn, vcov = vcovHC(fm_dyn, type = "HC1"))

## equivalently, returns can be computed 'by hand'
## (reducing the complexity of the formula notation)
fj &lt;- ts.union(fdd = FrozenJuice[, "fdd"],
  ret = 100 * diff(log(FrozenJuice[,"price"]/FrozenJuice[,"ppi"])))
fm_dyn &lt;- dynlm(ret ~ fdd, data = fj)

## Stock and Watson, p. 595
fm_dl &lt;- dynlm(ret ~ L(fdd, 0:6), data = fj)
coeftest(fm_dl, vcov = vcovHC(fm_dl, type = "HC1"))

## Stock and Watson, Table 15.1, p. 620, numbers refer to columns
## (1) Dynamic Multipliers 
fm1 &lt;- dynlm(ret ~ L(fdd, 0:18), data = fj)
coeftest(fm1, vcov = NeweyWest(fm1, lag = 7, prewhite =  FALSE))
## (2) Cumulative Multipliers
fm2 &lt;- dynlm(ret ~ L(d(fdd), 0:17) + L(fdd, 18), data = fj)
coeftest(fm2, vcov = NeweyWest(fm2, lag = 7, prewhite =  FALSE))
## (3) Cumulative Multipliers, more lags in NW
coeftest(fm2, vcov = NeweyWest(fm2, lag = 14, prewhite =  FALSE))
## (4) Cumulative Multipliers with monthly indicators
fm4 &lt;- dynlm(ret ~ L(d(fdd), 0:17) + L(fdd, 18) + season(fdd), data = fj)
coeftest(fm4, vcov = NeweyWest(fm4, lag = 7, prewhite =  FALSE))
## monthly indicators needed?
fm4r &lt;- update(fm4, . ~ . - season(fdd))
waldtest(fm4, fm4r, vcov= NeweyWest(fm4, lag = 7, prewhite = FALSE)) ## close ...


#############################################
## New York Stock Exchange composite index ##
#############################################

## returns
data("NYSESW", package = "AER")
ret &lt;- 100 * diff(log(NYSESW))
plot(ret)

## fit GARCH(1,1)
library("tseries")
fm &lt;- garch(coredata(ret))
</code></pre>

<hr>
<h2 id='StrikeDuration'>Strike Durations</h2><span id='topic+StrikeDuration'></span>

<h3>Description</h3>

<p>Data on the duration of strikes in US manufacturing industries, 1968&ndash;1976.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("StrikeDuration")</code></pre>


<h3>Format</h3>

<p>A data frame containing 62 observations on 2 variables for the period 1968&ndash;1976.
</p>

<dl>
<dt>duration</dt><dd><p>strike duration in days.</p>
</dd>
<dt>uoutput</dt><dd><p>unanticipated output (a measure of unanticipated aggregate
industrial production net of seasonal and trend components).</p>
</dd>
</dl>



<h3>Details</h3>

<p>The original data provided by Kennan (1985) are on a monthly basis, for the period 1968(1) through 1976(12). Greene (2003) only provides the June data for each year. Also, the duration for observation 36 is given as 3 by Greene while Kennan has 2. Here we use Greene's version.
</p>
<p><code>uoutput</code> is the residual from a regression of the logarithm of industrial production in manufacturing on time, time squared, and monthly dummy variables.  
</p>


<h3>Source</h3>

<p>Online complements to Greene (2003).
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>
<p>Kennan, J. (1985). The Duration of Contract Strikes in US Manufacturing. 
<em>Journal of Econometrics</em>, <b>28</b>, 5&ndash;28.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("StrikeDuration")
library("MASS")

## Greene (2003), Table 22.10
fit_exp &lt;- fitdistr(StrikeDuration$duration, "exponential")
fit_wei &lt;- fitdistr(StrikeDuration$duration, "weibull")
fit_wei$estimate[2]^(-1)
fit_lnorm &lt;- fitdistr(StrikeDuration$duration, "lognormal")
1/fit_lnorm$estimate[2]
exp(-fit_lnorm$estimate[1])
## Weibull and lognormal distribution have
## different parameterizations, see Greene p. 794

## Greene (2003), Example 22.10
library("survival")
fm_wei &lt;- survreg(Surv(duration) ~ uoutput, dist = "weibull", data = StrikeDuration)
summary(fm_wei)
</code></pre>

<hr>
<h2 id='summary.ivreg'>Methods for Instrumental-Variable Regression</h2><span id='topic+summary.ivreg'></span><span id='topic+print.summary.ivreg'></span><span id='topic+vcov.ivreg'></span><span id='topic+bread.ivreg'></span><span id='topic+estfun.ivreg'></span><span id='topic+anova.ivreg'></span><span id='topic+hatvalues.ivreg'></span><span id='topic+predict.ivreg'></span><span id='topic+terms.ivreg'></span><span id='topic+model.matrix.ivreg'></span><span id='topic+update.ivreg'></span>

<h3>Description</h3>

<p>Methods to standard generics for instrumental-variable regressions
fitted by <code><a href="#topic+ivreg">ivreg</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ivreg'
summary(object, vcov. = NULL, df = NULL, diagnostics = FALSE, ...)
## S3 method for class 'ivreg'
anova(object, object2, test = "F", vcov = NULL, ...)

## S3 method for class 'ivreg'
terms(x, component = c("regressors", "instruments"), ...)
## S3 method for class 'ivreg'
model.matrix(object, component = c("projected", "regressors", "instruments"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.ivreg_+3A_object">object</code>, <code id="summary.ivreg_+3A_object2">object2</code>, <code id="summary.ivreg_+3A_x">x</code></td>
<td>
<p>an object of class <code>"ivreg"</code> as fitted by
<code><a href="#topic+ivreg">ivreg</a></code>.</p>
</td></tr>
<tr><td><code id="summary.ivreg_+3A_vcov.">vcov.</code>, <code id="summary.ivreg_+3A_vcov">vcov</code></td>
<td>
<p>a specification of the covariance matrix of the estimated
coefficients. This can be specified as a matrix or as a function yielding a matrix
when applied to the fitted model. If it is a function it is also employed in the two
diagnostic F tests (if <code>diagnostics = TRUE</code> in the <code>summary()</code> method).</p>
</td></tr>
<tr><td><code id="summary.ivreg_+3A_df">df</code></td>
<td>
<p>the degrees of freedom to be used. By default this is set to
residual degrees of freedom for which a t or F test is computed. Alternatively,
it can be set to <code>Inf</code> (or equivalently <code>0</code>) for which a z or Chi-squared
test is computed.</p>
</td></tr>
<tr><td><code id="summary.ivreg_+3A_diagnostics">diagnostics</code></td>
<td>
<p>logical. Should diagnostic tests for the instrumental-variable
regression be carried out? These encompass an F test of the first stage regression
for weak instruments, a Wu-Hausman test for endogeneity, and a Sargan
test of overidentifying restrictions (only if there are more instruments than
regressors).</p>
</td></tr>
<tr><td><code id="summary.ivreg_+3A_test">test</code></td>
<td>
<p>character specifying whether to compute the large sample Chi-squared
statistic (with asymptotic Chi-squared distribution) or the finite sample F statistic
(with approximate F distribution).</p>
</td></tr>
<tr><td><code id="summary.ivreg_+3A_component">component</code></td>
<td>
<p>character specifying for which component of the
terms or model matrix should be extracted. <code>"projected"</code> gives the matrix of
regressors projected on the image of the instruments.</p>
</td></tr>
<tr><td><code id="summary.ivreg_+3A_...">...</code></td>
<td>
<p>currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+ivreg">ivreg</a></code> is the high-level interface to the work-horse function <code><a href="#topic+ivreg.fit">ivreg.fit</a></code>,
a set of standard methods (including <code>summary</code>, <code>vcov</code>, <code>anova</code>,
<code>hatvalues</code>, <code>predict</code>, <code>terms</code>, <code>model.matrix</code>, <code>update</code>, <code>bread</code>,
<code>estfun</code>) is available.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ivreg">ivreg</a></code>, <code><a href="stats.html#topic+lmfit">lm.fit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## data
data("CigarettesSW")
CigarettesSW &lt;- transform(CigarettesSW,
  rprice  = price/cpi,
  rincome = income/population/cpi,
  tdiff   = (taxs - tax)/cpi
)

## model 
fm &lt;- ivreg(log(packs) ~ log(rprice) + log(rincome) | log(rincome) + tdiff + I(tax/cpi),
  data = CigarettesSW, subset = year == "1995")
summary(fm)
summary(fm, vcov = sandwich, df = Inf, diagnostics = TRUE)

## ANOVA
fm2 &lt;- ivreg(log(packs) ~ log(rprice) | tdiff, data = CigarettesSW, subset = year == "1995")
anova(fm, fm2, vcov = sandwich, test = "Chisq")
</code></pre>

<hr>
<h2 id='SwissLabor'>Swiss Labor Market Participation Data</h2><span id='topic+SwissLabor'></span>

<h3>Description</h3>

<p>Cross-section data originating from the health survey SOMIPOPS
for Switzerland in 1981.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("SwissLabor")</code></pre>


<h3>Format</h3>

<p>A data frame containing 872 observations on 7 variables.
</p>

<dl>
<dt>participation</dt><dd><p>Factor. Did the individual participate in the labor force?</p>
</dd>
<dt>income</dt><dd><p>Logarithm of nonlabor income.</p>
</dd>
<dt>age</dt><dd><p>Age in decades (years divided by 10).</p>
</dd>
<dt>education</dt><dd><p>Years of formal education.</p>
</dd>
<dt>youngkids</dt><dd><p>Number of young children (under 7 years of age).</p>
</dd>
<dt>oldkids</dt><dd><p>Number of older children (over 7 years of age).</p>
</dd>
<dt>foreign</dt><dd><p>Factor. Is the individual a foreigner (i.e., not Swiss)?</p>
</dd>
</dl>



<h3>Source</h3>

<p>Journal of Applied Econometrics Data Archive. 
</p>
<p><a href="http://qed.econ.queensu.ca/jae/1996-v11.3/gerfin/">http://qed.econ.queensu.ca/jae/1996-v11.3/gerfin/</a>
</p>


<h3>References</h3>

<p>Gerfin, M. (1996). Parametric and Semi-Parametric Estimation of the Binary Response
Model of Labour Market Participation. <em>Journal of Applied Econometrics</em>,
<b>11</b>, 321&ndash;339.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("SwissLabor")

### Gerfin (1996), Table I.
fm_probit &lt;- glm(participation ~ . + I(age^2), data = SwissLabor,
  family = binomial(link = "probit"))
summary(fm_probit)

### alternatively
fm_logit &lt;- glm(participation ~ . + I(age^2), data = SwissLabor,
  family = binomial)
summary(fm_logit)
</code></pre>

<hr>
<h2 id='TeachingRatings'>Impact of Beauty on Instructor's Teaching Ratings</h2><span id='topic+TeachingRatings'></span>

<h3>Description</h3>

<p>Data on course evaluations, course characteristics, and professor
characteristics for 463 courses for the academic years 2000&ndash;2002 at the
University of Texas at Austin.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("TeachingRatings")</code></pre>


<h3>Format</h3>

<p>A data frame containing 463 observations on 13 variables.
</p>

<dl>
<dt>minority</dt><dd><p>factor. Does the instructor belong to a minority (non-Caucasian)?</p>
</dd>
<dt>age</dt><dd><p>the professor's age.</p>
</dd>
<dt>gender</dt><dd><p>factor indicating instructor's gender.</p>
</dd>
<dt>credits</dt><dd><p>factor. Is the course a single-credit elective (e.g., yoga, aerobics, dance)?</p>
</dd>
<dt>beauty</dt><dd><p>rating of the instructor's physical appearance by a panel of six students,
averaged across the six panelists, shifted to have a mean of zero.</p>
</dd>
<dt>eval</dt><dd><p>course overall teaching evaluation score, on
a scale of 1 (very unsatisfactory) to 5 (excellent).</p>
</dd>
<dt>division</dt><dd><p>factor. Is the course an upper or lower division course? (Lower division
courses are mainly large freshman and sophomore courses)?</p>
</dd>
<dt>native</dt><dd><p>factor. Is the instructor a native English speaker?</p>
</dd>
<dt>tenure</dt><dd><p>factor. Is the instructor on tenure track?</p>
</dd>
<dt>students</dt><dd><p>number of students that participated in the evaluation.</p>
</dd>
<dt>allstudents</dt><dd><p>number of students enrolled in the course.</p>
</dd>
<dt>prof</dt><dd><p>factor indicating instructor identifier.</p>
</dd>
</dl>



<h3>Details</h3>

<p>A sample of student instructional ratings for a group of university teachers along with
beauty rating (average from six independent judges)  and a number of other characteristics.
</p>


<h3>Source</h3>

<p>The data were provided by Prof. Hamermesh. The first 8 variables are also available in the
online complements to Stock and Watson (2007) at
</p>


<h3>References</h3>

<p>Hamermesh, D.S., and Parker, A. (2005).
Beauty in the Classroom: Instructors' Pulchritude and Putative Pedagogical Productivity.
<em>Economics of Education Review</em>, <b>24</b>, 369&ndash;376.
</p>
<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("TeachingRatings", package = "AER")

## evaluation score vs. beauty
plot(eval ~ beauty, data = TeachingRatings)
fm &lt;- lm(eval ~ beauty, data = TeachingRatings)
abline(fm)
summary(fm)

## prediction of Stock &amp; Watson's evaluation score
sw &lt;- with(TeachingRatings, mean(beauty) + c(0, 1) * sd(beauty))
names(sw) &lt;- c("Watson", "Stock")
predict(fm, newdata = data.frame(beauty = sw))

## Hamermesh and Parker, 2005, Table 3
fmw &lt;- lm(eval ~ beauty + gender + minority + native + tenure + division + credits,
  weights = students, data = TeachingRatings)
coeftest(fmw, vcov = vcovCL, cluster = TeachingRatings$prof)
</code></pre>

<hr>
<h2 id='TechChange'>Technological Change Data</h2><span id='topic+TechChange'></span>

<h3>Description</h3>

<p>US time series data, 1909&ndash;1949.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("TechChange")</code></pre>


<h3>Format</h3>

<p>An annual multiple time series from 1909 to 1949 with 3 variables.
</p>

<dl>
<dt>output</dt><dd><p>Output.</p>
</dd>
<dt>clr</dt><dd><p>Capital/labor ratio.</p>
</dd>
<dt>technology</dt><dd><p>Index of technology.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Greene (2003), Table F7.2.
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>
<p>Solow, R. (1957). Technical Change and the Aggregate Production Function. 
<em>Review of Economics and Statistics</em>, <b>39</b>, 312&ndash;320.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("TechChange")

## Greene (2003)
## Exercise 7.1
fm1 &lt;- lm(I(output/technology) ~ log(clr), data = TechChange)
fm2 &lt;- lm(I(output/technology) ~ I(1/clr), data = TechChange)
fm3 &lt;- lm(log(output/technology) ~ log(clr), data = TechChange)
fm4 &lt;- lm(log(output/technology) ~ I(1/clr), data = TechChange)

## Exercise 7.2 (a) and (c)
plot(I(output/technology) ~ clr, data = TechChange)

library("strucchange")
sctest(I(output/technology) ~ log(clr), data = TechChange, type = "Chow", point = c(1942, 1))
</code></pre>

<hr>
<h2 id='tobit'>Tobit Regression</h2><span id='topic+tobit'></span><span id='topic+print.tobit'></span><span id='topic+summary.tobit'></span><span id='topic+print.summary.tobit'></span><span id='topic+formula.tobit'></span><span id='topic+model.frame.tobit'></span><span id='topic+update.tobit'></span><span id='topic+waldtest.tobit'></span><span id='topic+lrtest.tobit'></span><span id='topic+linearHypothesis.tobit'></span><span id='topic+deviance.survreg'></span>

<h3>Description</h3>

<p>Fitting and testing tobit regression models for censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  tobit(formula, left = 0, right = Inf, dist = "gaussian",
    subset = NULL, data = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tobit_+3A_formula">formula</code></td>
<td>
<p>a symbolic description of a regression model of type
<code>y ~ x1 + x2 + ...</code>.</p>
</td></tr>
<tr><td><code id="tobit_+3A_left">left</code></td>
<td>
<p>left limit for the censored dependent variable <code>y</code>.
If set to <code>-Inf</code>, <code>y</code> is assumed not to be left-censored.</p>
</td></tr>
<tr><td><code id="tobit_+3A_right">right</code></td>
<td>
<p>right limit for the censored dependent variable <code>y</code>.
If set to <code>Inf</code>, the default, <code>y</code> is assumed not to be right-censored.</p>
</td></tr>
<tr><td><code id="tobit_+3A_dist">dist</code></td>
<td>
<p>assumed distribution for the dependent variable <code>y</code>.
This is passed to <code><a href="survival.html#topic+survreg">survreg</a></code>, see the respective man page for
more details.</p>
</td></tr>
<tr><td><code id="tobit_+3A_subset">subset</code></td>
<td>
<p>a specification of the rows to be used.</p>
</td></tr>
<tr><td><code id="tobit_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="tobit_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="survival.html#topic+survreg">survreg</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>tobit</code> is a convenience interface to <code><a href="survival.html#topic+survreg">survreg</a></code>
(for survival regression, including censored regression) setting different
defaults and providing a more convenient interface for specification
of the censoring information.
</p>
<p>The default is the classical tobit model (Tobin 1958, Greene 2003) assuming 
a normal distribution for the dependent variable with left-censoring at 0.
</p>
<p>Technically, the formula of type <code>y ~ x1 + x2 + ...</code> passed to <code>tobit</code>
is simply transformed into a formula suitable for <code><a href="survival.html#topic+survreg">survreg</a></code>: This means
the dependent variable is first censored and then wrapped into a <code><a href="survival.html#topic+Surv">Surv</a></code>
object containing the censoring information which is subsequently passed to 
<code><a href="survival.html#topic+survreg">survreg</a></code>, e.g., <code>Surv(ifelse(y &lt;= 0, 0, y), y &gt; 0, type = "left") ~ x1 + x2 + ...</code>
for the default settings.
</p>


<h3>Value</h3>

<p>An object of class <code>"tobit"</code> inheriting from class <code>"survreg"</code>.
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>
<p>Tobin, J. (1958). Estimation of Relationships for Limited Dependent Variables.
<em>Econometrica</em>, <b>26</b>, 24&ndash;36.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Affairs")

## from Table 22.4 in Greene (2003)
fm.tobit &lt;- tobit(affairs ~ age + yearsmarried + religiousness + occupation + rating,
  data = Affairs)
fm.tobit2 &lt;- tobit(affairs ~ age + yearsmarried + religiousness + occupation + rating,
  right = 4, data = Affairs)

summary(fm.tobit)
summary(fm.tobit2)
</code></pre>

<hr>
<h2 id='TradeCredit'>Trade Credit and the Money Market</h2><span id='topic+TradeCredit'></span>

<h3>Description</h3>

<p>Macroeconomic time series data from 1946 to 1966 on trade credit and the money market.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("TradeCredit")</code></pre>


<h3>Format</h3>

<p>An annual multiple time series from 1946 to 1966 on 7 variables.
</p>

<dl>
<dt>trade</dt><dd><p>Nominal total trade money.</p>
</dd>
<dt>reserve</dt><dd><p>Nominal effective reserve money.</p>
</dd>
<dt>gnp</dt><dd><p>GNP in current dollars.</p>
</dd>
<dt>utilization</dt><dd><p>Degree of market utilization.</p>
</dd>
<dt>interest</dt><dd><p>Short-term rate of interest.</p>
</dd>
<dt>size</dt><dd><p>Mean real size of the representative economic unit (1939 = 100).</p>
</dd>
<dt>price</dt><dd><p>GNP price deflator (1958 = 100).</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data are from Baltagi (2002).
</p>


<h3>References</h3>

<p>Baltagi, B.H. (2002). <em>Econometrics</em>, 3rd ed. Berlin, Springer. 
</p>
<p>Laffer, A.B. (1970). Trade Credit and the Money Market. <em>Journal of Political Economy</em>,
<b>78</b>, 239&ndash;267.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Baltagi2002">Baltagi2002</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("TradeCredit")
plot(TradeCredit)
</code></pre>

<hr>
<h2 id='TravelMode'>Travel Mode Choice Data</h2><span id='topic+TravelMode'></span>

<h3>Description</h3>

<p>Data on travel mode choice for travel between Sydney and Melbourne, Australia.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("TravelMode")</code></pre>


<h3>Format</h3>

<p>A data frame containing 840 observations on 4 modes for 210 individuals.
</p>

<dl>
<dt>individual</dt><dd><p>Factor indicating individual with levels <code>1</code> to <code>210</code>.</p>
</dd>
<dt>mode</dt><dd><p>Factor indicating travel mode with levels
<code>"car"</code>, <code>"air"</code>, <code>"train"</code>, or <code>"bus"</code>.</p>
</dd>
<dt>choice</dt><dd><p>Factor indicating choice with levels <code>"no"</code> and <code>"yes"</code>.</p>
</dd>
<dt>wait</dt><dd><p>Terminal waiting time, 0 for car.</p>
</dd>
<dt>vcost</dt><dd><p>Vehicle cost component.</p>
</dd>
<dt>travel</dt><dd><p>Travel time in the vehicle.</p>
</dd>
<dt>gcost</dt><dd><p>Generalized cost measure.</p>
</dd>
<dt>income</dt><dd><p>Household income.</p>
</dd>
<dt>size</dt><dd><p>Party size.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Greene (2003).
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("TravelMode", package = "AER")

## overall proportions for chosen mode
with(TravelMode, prop.table(table(mode[choice == "yes"])))

## travel vs. waiting time for different travel modes
library("lattice")
xyplot(travel ~ wait | mode, data = TravelMode)

## Greene (2003), Table 21.11, conditional logit model
library("mlogit")
TravelMode$incair &lt;- with(TravelMode, income * (mode == "air"))
tm_cl &lt;- mlogit(choice ~ gcost + wait + incair, data = TravelMode,
  shape = "long", alt.var = "mode", reflevel = "car")
summary(tm_cl)
</code></pre>

<hr>
<h2 id='UKInflation'>UK Manufacturing Inflation Data</h2><span id='topic+UKInflation'></span>

<h3>Description</h3>

<p>Time series of observed and expected price changes in British manufacturing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("UKInflation")</code></pre>


<h3>Format</h3>

<p>A quarterly multiple time series from 1972(1) to 1985(2) with 2 variables.
</p>

<dl>
<dt>actual</dt><dd><p>Actual inflation.</p>
</dd>
<dt>expected</dt><dd><p>Expected inflation.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Greene (2003), Table F8.1.
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>
<p>Pesaran, M.H., and Hall, A.D. (1988). Tests of Non-nested Linear Regression Models
Subject To Linear Restrictions. <em>Economics Letters</em>, <b>27</b>, 341&ndash;348.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("UKInflation")
plot(UKInflation)
</code></pre>

<hr>
<h2 id='UKNonDurables'>Consumption of Non-Durables in the UK</h2><span id='topic+UKNonDurables'></span>

<h3>Description</h3>

<p>Time series of consumption of non-durables in the UK (in 1985 prices).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("UKNonDurables")</code></pre>


<h3>Format</h3>

<p>A quarterly univariate time series from 1955(1) to 1988(4).
</p>


<h3>Source</h3>

<p>Online complements to Franses (1998).
</p>


<h3>References</h3>

<p>Osborn, D.R. (1988). A Survey of Seasonality in UK Macroeconomic Variables.
<em>International Journal of Forecasting</em>, <b>6</b>, 327&ndash;336.
</p>
<p>Franses, P.H. (1998). <em>Time Series Models for Business and Economic Forecasting</em>.
Cambridge, UK: Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Franses1998">Franses1998</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("UKNonDurables")
plot(UKNonDurables)

## EACF tables (Franses 1998, p. 99)
ctrafo &lt;- function(x) residuals(lm(x ~ factor(cycle(x))))
ddiff &lt;- function(x) diff(diff(x, frequency(x)), 1)
eacf &lt;- function(y, lag = 12) {
  stopifnot(all(lag &gt; 0))
  if(length(lag) &lt; 2) lag &lt;- 1:lag
  rval &lt;- sapply(
    list(y = y, dy = diff(y), cdy = ctrafo(diff(y)),
         Dy = diff(y, frequency(y)), dDy = ddiff(y)),
    function(x) acf(x, plot = FALSE, lag.max = max(lag))$acf[lag + 1])
  rownames(rval) &lt;- lag
  return(rval)
}

## Franses (1998), Table 5.2
round(eacf(log(UKNonDurables)), digits = 3)

## Franses (1998), Equation 5.51
## (Franses: sma1 = -0.632 (0.069))
arima(log(UKNonDurables), c(0, 1, 0), c(0, 1, 1))
</code></pre>

<hr>
<h2 id='USAirlines'>Cost Data for US Airlines</h2><span id='topic+USAirlines'></span>

<h3>Description</h3>

<p>Cost data for six US airlines in 1970&ndash;1984.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("USAirlines")</code></pre>


<h3>Format</h3>

<p>A data frame containing 90 observations on 6 variables.
</p>

<dl>
<dt>firm</dt><dd><p>factor indicating airline firm.</p>
</dd>
<dt>year</dt><dd><p>factor indicating year.</p>
</dd>
<dt>output</dt><dd><p>output revenue passenger miles index number.</p>
</dd>
<dt>cost</dt><dd><p>total cost (in USD 1000).</p>
</dd>
<dt>price</dt><dd><p>fuel price.</p>
</dd>
<dt>load</dt><dd><p>average capacity utilization of the fleet.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Greene (2003). Table F7.1.
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("USAirlines")

## Example 7.2 in Greene (2003)
fm_full &lt;- lm(log(cost) ~ log(output) + I(log(output)^2) + log(price) + load + year + firm,
  data = USAirlines)
fm_time &lt;- lm(log(cost) ~ log(output) + I(log(output)^2) + log(price) + load + year,
  data = USAirlines)
fm_firm &lt;- lm(log(cost) ~ log(output) + I(log(output)^2) + log(price) + load + firm,
  data = USAirlines)
fm_no &lt;- lm(log(cost) ~ log(output) + I(log(output)^2) + log(price) + load, data = USAirlines)

## Table 7.2
anova(fm_full, fm_time)
anova(fm_full, fm_firm)
anova(fm_full, fm_no)

## alternatively, use plm()
library("plm")
usair &lt;- pdata.frame(USAirlines, c("firm", "year"))
fm_full2 &lt;- plm(log(cost) ~ log(output) + I(log(output)^2) + log(price) + load,
  data = usair, model = "within", effect = "twoways")
fm_time2 &lt;- plm(log(cost) ~ log(output) + I(log(output)^2) + log(price) + load,
  data = usair, model = "within", effect = "time")
fm_firm2 &lt;- plm(log(cost) ~ log(output) + I(log(output)^2) + log(price) + load,
  data = usair, model = "within", effect = "individual")
fm_no2 &lt;- plm(log(cost) ~ log(output) + I(log(output)^2) + log(price) + load,
  data = usair, model = "pooling")
pFtest(fm_full2, fm_time2)
pFtest(fm_full2, fm_firm2)
pFtest(fm_full2, fm_no2)

## More examples can be found in:
## help("Greene2003")
</code></pre>

<hr>
<h2 id='USConsump1950'>US Consumption Data (1940&ndash;1950)</h2><span id='topic+USConsump1950'></span>

<h3>Description</h3>

<p>Time series data on US income and consumption expenditure, 1940&ndash;1950.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("USConsump1950")</code></pre>


<h3>Format</h3>

<p>An annual multiple time series from 1940 to 1950 with 3 variables.
</p>

<dl>
<dt>income</dt><dd><p>Disposable income.</p>
</dd>
<dt>expenditure</dt><dd><p>Consumption expenditure.</p>
</dd>
<dt>war</dt><dd><p>Indicator variable: Was the year a year of war?</p>
</dd> 
</dl>



<h3>Source</h3>

<p>Online complements to Greene (2003). Table F2.1.
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code>, <code><a href="#topic+USConsump1979">USConsump1979</a></code>, <code><a href="#topic+USConsump1993">USConsump1993</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Greene (2003)
## data
data("USConsump1950")
usc &lt;- as.data.frame(USConsump1950)
usc$war &lt;- factor(usc$war, labels = c("no", "yes"))

## Example 2.1
plot(expenditure ~ income, data = usc, type = "n", xlim = c(225, 375), ylim = c(225, 350))
with(usc, text(income, expenditure, time(USConsump1950)))

## single model
fm &lt;- lm(expenditure ~ income, data = usc)
summary(fm)

## different intercepts for war yes/no
fm2 &lt;- lm(expenditure ~ income + war, data = usc)
summary(fm2)

## compare
anova(fm, fm2)

## visualize
abline(fm, lty = 3)                                   
abline(coef(fm2)[1:2])                                
abline(sum(coef(fm2)[c(1, 3)]), coef(fm2)[2], lty = 2)

## Example 3.2
summary(fm)$r.squared
summary(lm(expenditure ~ income, data = usc, subset = war == "no"))$r.squared
summary(fm2)$r.squared
</code></pre>

<hr>
<h2 id='USConsump1979'>US Consumption Data (1970&ndash;1979)</h2><span id='topic+USConsump1979'></span>

<h3>Description</h3>

<p>Time series data on US income and consumption expenditure, 1970&ndash;1979.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("USConsump1979")</code></pre>


<h3>Format</h3>

<p>An annual multiple time series from 1970 to 1979 with 2 variables.
</p>

<dl>
<dt>income</dt><dd><p>Disposable income.</p>
</dd> 
<dt>expenditure</dt><dd><p>Consumption expenditure.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Greene (2003). Table F1.1.
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code>, <code><a href="#topic+USConsump1950">USConsump1950</a></code>, <code><a href="#topic+USConsump1993">USConsump1993</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("USConsump1979")
plot(USConsump1979)

## Example 1.1 in Greene (2003)
plot(expenditure ~ income, data = as.data.frame(USConsump1979), pch = 19)
fm &lt;- lm(expenditure ~ income, data = as.data.frame(USConsump1979))
summary(fm)
abline(fm)
</code></pre>

<hr>
<h2 id='USConsump1993'>US Consumption Data (1950&ndash;1993)</h2><span id='topic+USConsump1993'></span>

<h3>Description</h3>

<p>Time series data on US income and consumption expenditure, 1950&ndash;1993.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("USConsump1993")</code></pre>


<h3>Format</h3>

<p>An annual multiple time series from 1950 to 1993 with 2 variables.
</p>

<dl>
<dt>income</dt><dd><p>Disposable personal income (in 1987 USD).</p>
</dd>
<dt>expenditure</dt><dd><p>Personal consumption expenditures (in 1987 USD).</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data is from Baltagi (2002).
</p>


<h3>References</h3>

<p>Baltagi, B.H. (2002). <em>Econometrics</em>, 3rd ed. Berlin, Springer. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Baltagi2002">Baltagi2002</a></code>, <code><a href="#topic+USConsump1950">USConsump1950</a></code>, <code><a href="#topic+USConsump1979">USConsump1979</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## data from Baltagi (2002)
data("USConsump1993", package = "AER")
plot(USConsump1993, plot.type = "single", col = 1:2)

## Chapter 5 (p. 122-125)
fm &lt;- lm(expenditure ~ income, data = USConsump1993)
summary(fm)
## Durbin-Watson test (p. 122)
dwtest(fm)
## Breusch-Godfrey test (Table 5.4, p. 124)
bgtest(fm)
## Newey-West standard errors (Table 5.5, p. 125)
coeftest(fm, vcov = NeweyWest(fm, lag = 3, prewhite = FALSE, adjust = TRUE)) 

## Chapter 8
library("strucchange")
## Recursive residuals
rr &lt;- recresid(fm)
rr
## Recursive CUSUM test
rcus &lt;- efp(expenditure ~ income, data = USConsump1993)
plot(rcus)
sctest(rcus)
## Harvey-Collier test
harvtest(fm)
## NOTE" Mistake in Baltagi (2002) who computes
## the t-statistic incorrectly as 0.0733 via
mean(rr)/sd(rr)/sqrt(length(rr))
## whereas it should be (as in harvtest)
mean(rr)/sd(rr) * sqrt(length(rr))

## Rainbow test
raintest(fm, center = 23)

## J test for non-nested models
library("dynlm")
fm1 &lt;- dynlm(expenditure ~ income + L(income), data = USConsump1993)
fm2 &lt;- dynlm(expenditure ~ income + L(expenditure), data = USConsump1993)
jtest(fm1, fm2)

## Chapter 14
## ACF and PACF for expenditures and first differences
exps &lt;- USConsump1993[, "expenditure"]
(acf(exps))
(pacf(exps))
(acf(diff(exps)))
(pacf(diff(exps)))

## dynamic regressions, eq. (14.8)
fm &lt;- dynlm(d(exps) ~ I(time(exps) - 1949) + L(exps))
summary(fm)
</code></pre>

<hr>
<h2 id='USCrudes'>US Crudes Data</h2><span id='topic+USCrudes'></span>

<h3>Description</h3>

<p>Cross-section data originating from 99 US oil field postings. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("USCrudes")</code></pre>


<h3>Format</h3>

<p>A data frame containing 99 observations on 3 variables.
</p>

<dl>
<dt>price</dt><dd><p>Crude prices (USD/barrel).</p>
</dd>
<dt>gravity</dt><dd><p>Gravity (degree API).</p>
</dd>
<dt>sulphur</dt><dd><p>Sulphur (in %).</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data is from Baltagi (2002).
</p>


<h3>References</h3>

<p>Baltagi, B.H. (2002). <em>Econometrics</em>, 3rd ed. Berlin, Springer. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Baltagi2002">Baltagi2002</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("USCrudes")
plot(price ~ gravity, data = USCrudes)
plot(price ~ sulphur, data = USCrudes)
fm &lt;- lm(price ~ sulphur + gravity, data = USCrudes)

## 3D Visualization
library("scatterplot3d")
s3d &lt;- scatterplot3d(USCrudes[, 3:1], pch = 16)
s3d$plane3d(fm, lty.box = "solid", col = 4)
</code></pre>

<hr>
<h2 id='USGasB'>US Gasoline Market Data (1950&ndash;1987, Baltagi)</h2><span id='topic+USGasB'></span>

<h3>Description</h3>

<p>Time series data on the US gasoline market.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("USGasB")</code></pre>


<h3>Format</h3>

<p>An annual multiple time series from 1950 to 1987 with 6 variables.
</p>

<dl>
<dt>cars</dt><dd><p>Stock of cars.</p>
</dd>
<dt>gas</dt><dd><p>Consumption of motor gasoline (in 1000 gallons).</p>
</dd>
<dt>price</dt><dd><p>Retail price of motor gasoline.</p>
</dd>
<dt>population</dt><dd><p>Population.</p>
</dd>
<dt>gnp</dt><dd><p>Real gross national product (in 1982 dollars).</p>
</dd>
<dt>deflator</dt><dd><p>GNP deflator (1982 = 100).</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data are from Baltagi (2002).
</p>


<h3>References</h3>

<p>Baltagi, B.H. (2002). <em>Econometrics</em>, 3rd ed. Berlin, Springer. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Baltagi2002">Baltagi2002</a></code>, <code><a href="#topic+USGasG">USGasG</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("USGasB")
plot(USGasB)
</code></pre>

<hr>
<h2 id='USGasG'>US Gasoline Market Data (1960&ndash;1995, Greene)</h2><span id='topic+USGasG'></span>

<h3>Description</h3>

<p>Time series data on the US gasoline market.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("USGasG")</code></pre>


<h3>Format</h3>

<p>An annual multiple time series from 1960 to 1995 with 10 variables.
</p>

<dl>
<dt>gas</dt><dd><p>Total US gasoline consumption (computed as
total expenditure divided by price index).</p>
</dd>
<dt>price</dt><dd><p>Price index for gasoline.</p>
</dd>
<dt>income</dt><dd><p>Per capita disposable income.</p>
</dd>
<dt>newcar</dt><dd><p>Price index for new cars.</p>
</dd>
<dt>usedcar</dt><dd><p>Price index for used cars.</p>
</dd>
<dt>transport</dt><dd><p>Price index for public transportation.</p>
</dd>
<dt>durable</dt><dd><p>Aggregate price index for consumer durables.</p>
</dd>
<dt>nondurable</dt><dd><p>Aggregate price index for consumer nondurables.</p>
</dd>
<dt>service</dt><dd><p>Aggregate price index for consumer services.</p>
</dd>
<dt>population</dt><dd><p>US total population in millions.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Greene (2003). Table F2.2.
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code>, <code><a href="#topic+USGasB">USGasB</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("USGasG", package = "AER")
plot(USGasG)

## Greene (2003)
## Example 2.3
fm &lt;- lm(log(gas/population) ~ log(price) + log(income) + log(newcar) + log(usedcar),
  data = as.data.frame(USGasG))
summary(fm)

## Example 4.4
## estimates and standard errors (note different offset for intercept)
coef(fm)
sqrt(diag(vcov(fm)))
## confidence interval
confint(fm, parm = "log(income)")
## test linear hypothesis
linearHypothesis(fm, "log(income) = 1")

## Example 7.6
## re-used in Example 8.3
trend &lt;- 1:nrow(USGasG)
shock &lt;- factor(time(USGasG) &gt; 1973, levels = c(FALSE, TRUE),
  labels = c("before", "after"))

## 1960-1995
fm1 &lt;- lm(log(gas/population) ~ log(income) + log(price) + log(newcar) +
  log(usedcar) + trend, data = as.data.frame(USGasG))
summary(fm1)
## pooled
fm2 &lt;- lm(log(gas/population) ~ shock + log(income) + log(price) + log(newcar) +
  log(usedcar) + trend, data = as.data.frame(USGasG))
summary(fm2)
## segmented
fm3 &lt;- lm(log(gas/population) ~ shock/(log(income) + log(price) + log(newcar) +
  log(usedcar) + trend), data = as.data.frame(USGasG))
summary(fm3)

## Chow test
anova(fm3, fm1)
library("strucchange")
sctest(log(gas/population) ~ log(income) + log(price) + log(newcar) +
  log(usedcar) + trend, data = USGasG, point = c(1973, 1), type = "Chow")
## Recursive CUSUM test
rcus &lt;- efp(log(gas/population) ~ log(income) + log(price) + log(newcar) +
  log(usedcar) + trend, data = USGasG, type = "Rec-CUSUM")
plot(rcus)
sctest(rcus)
## Note: Greene's remark that the break is in 1984 (where the process crosses its
## boundary) is wrong. The break appears to be no later than 1976.

## More examples can be found in:
## help("Greene2003")
</code></pre>

<hr>
<h2 id='USInvest'>US Investment Data</h2><span id='topic+USInvest'></span>

<h3>Description</h3>

<p>Time series data on investments in the US, 1968&ndash;1982.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("USInvest")</code></pre>


<h3>Format</h3>

<p>An annual multiple time series from 1968 to 1982 with 4 variables.
</p>

<dl>
<dt>gnp</dt><dd><p>Nominal gross national product,</p>
</dd>
<dt>invest</dt><dd><p>Nominal investment,</p>
</dd>
<dt>price</dt><dd><p>Consumer price index,</p>
</dd>
<dt>interest</dt><dd><p>Interest rate (average yearly discount rate at the New York Federal Reserve Bank).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Greene (2003). Table F3.1.
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("USInvest")

## Chapter 3 in Greene (2003)
## transform (and round) data to match Table 3.1
us &lt;- as.data.frame(USInvest)
us$invest &lt;- round(0.1 * us$invest/us$price, digits = 3)
us$gnp &lt;- round(0.1 * us$gnp/us$price, digits = 3)
us$inflation &lt;- c(4.4, round(100 * diff(us$price)/us$price[-15], digits = 2))
us$trend &lt;- 1:15
us &lt;- us[, c(2, 6, 1, 4, 5)]

## p. 22-24
coef(lm(invest ~ trend + gnp, data = us))
coef(lm(invest ~ gnp, data = us))

## Example 3.1, Table 3.2
cor(us)[1,-1]
pcor &lt;- solve(cor(us))
dcor &lt;- 1/sqrt(diag(pcor))
pcor &lt;- (-pcor * (dcor %o% dcor))[1,-1]

## Table 3.4
fm  &lt;- lm(invest ~ trend + gnp + interest + inflation, data = us)
fm1 &lt;- lm(invest ~ 1, data = us)
anova(fm1, fm)

## More examples can be found in:
## help("Greene2003")
</code></pre>

<hr>
<h2 id='USMacroB'>US Macroeconomic Data (1959&ndash;1995, Baltagi)</h2><span id='topic+USMacroB'></span>

<h3>Description</h3>

<p>Time series data on 3 US macroeconomic variables for 1959&ndash;1995,
extracted from the Citibank data base.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("USMacroB")</code></pre>


<h3>Format</h3>

<p>A quarterly multiple time series from 1959(1) to 1995(2) with 3 variables.
</p>

<dl>
<dt>gnp</dt><dd><p>Gross national product.</p>
</dd>
<dt>mbase</dt><dd><p>Average of the seasonally adjusted monetary base.</p>
</dd>
<dt>tbill</dt><dd><p>Average of 3 month treasury-bill rate (per annum).</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data is from Baltagi (2002).
</p>


<h3>References</h3>

<p>Baltagi, B.H. (2002). <em>Econometrics</em>, 3rd ed. Berlin, Springer. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Baltagi2002">Baltagi2002</a></code>, <code><a href="#topic+USMacroSW">USMacroSW</a></code>, <code><a href="#topic+USMacroSWQ">USMacroSWQ</a></code>,
<code><a href="#topic+USMacroSWM">USMacroSWM</a></code>, <code><a href="#topic+USMacroG">USMacroG</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("USMacroB")
plot(USMacroB)
</code></pre>

<hr>
<h2 id='USMacroG'>US Macroeconomic Data (1950&ndash;2000, Greene)</h2><span id='topic+USMacroG'></span>

<h3>Description</h3>

<p>Time series data on 12 US macroeconomic variables for 1950&ndash;2000.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("USMacroG")</code></pre>


<h3>Format</h3>

<p>A quarterly multiple time series from 1950(1) to 2000(4) with 12 variables.
</p>

<dl>
<dt>gdp</dt><dd><p>Real gross domestic product (in billion USD),</p>
</dd>
<dt>consumption</dt><dd><p>Real consumption expenditures,</p>
</dd>
<dt>invest</dt><dd><p>Real investment by private sector,</p>
</dd>
<dt>government</dt><dd><p>Real government expenditures,</p>
</dd>
<dt>dpi</dt><dd><p>Real disposable personal income,</p>
</dd>
<dt>cpi</dt><dd><p>Consumer price index,</p>
</dd>
<dt>m1</dt><dd><p>Nominal money stock,</p>
</dd>
<dt>tbill</dt><dd><p>Quarterly average of month end 90 day treasury bill rate,</p>
</dd>
<dt>unemp</dt><dd><p>Unemployment rate,</p>
</dd>
<dt>population</dt><dd><p>Population (in million), interpolation of year end figures
using constant growth rate per quarter,</p>
</dd>
<dt>inflation</dt><dd><p>Inflation rate,</p>
</dd>
<dt>interest</dt><dd><p>Ex post real interest rate (essentially, <code>tbill - inflation</code>).</p>
</dd> 
</dl>



<h3>Source</h3>

<p>Online complements to Greene (2003). Table F5.1.
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code>, <code><a href="#topic+USMacroSW">USMacroSW</a></code>, <code><a href="#topic+USMacroSWQ">USMacroSWQ</a></code>,
<code><a href="#topic+USMacroSWM">USMacroSWM</a></code>, <code><a href="#topic+USMacroB">USMacroB</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## data and trend as used by Greene (2003)
data("USMacroG")
ltrend &lt;- 1:nrow(USMacroG) - 1

## Example 6.1
## Table 6.1
library("dynlm")
fm6.1 &lt;- dynlm(log(invest) ~ tbill + inflation + log(gdp) + ltrend, data = USMacroG)
fm6.3 &lt;- dynlm(log(invest) ~ I(tbill - inflation) + log(gdp) + ltrend, data = USMacroG)
summary(fm6.1)
summary(fm6.3)
deviance(fm6.1)
deviance(fm6.3)
vcov(fm6.1)[2,3] 

## F test
linearHypothesis(fm6.1, "tbill + inflation = 0")
## alternatively
anova(fm6.1, fm6.3)
## t statistic
sqrt(anova(fm6.1, fm6.3)[2,5])
 
## Example 8.2
## Ct = b0 + b1*Yt + b2*Y(t-1) + v
fm1 &lt;- dynlm(consumption ~ dpi + L(dpi), data = USMacroG)
## Ct = a0 + a1*Yt + a2*C(t-1) + u
fm2 &lt;- dynlm(consumption ~ dpi + L(consumption), data = USMacroG)

## Cox test in both directions:
coxtest(fm1, fm2)
## ...and do the same for jtest() and encomptest().
## Notice that in this particular case two of them are coincident.
jtest(fm1, fm2)
encomptest(fm1, fm2)
## encomptest could also be performed `by hand' via
fmE &lt;- dynlm(consumption ~ dpi + L(dpi) + L(consumption), data = USMacroG)
waldtest(fm1, fmE, fm2)

## More examples can be found in:
## help("Greene2003")
</code></pre>

<hr>
<h2 id='USMacroSW'>US Macroeconomic Data (1957&ndash;2005, Stock &amp; Watson)</h2><span id='topic+USMacroSW'></span>

<h3>Description</h3>

<p>Time series data on 7 (mostly) US macroeconomic variables for 1957&ndash;2005.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("USMacroSW")
</code></pre>


<h3>Format</h3>

<p>A quarterly multiple time series from 1957(1) to 2005(1) with 7 variables.
</p>

<dl>
<dt>unemp</dt><dd><p>Unemployment rate.</p>
</dd>
<dt>cpi</dt><dd><p>Consumer price index.</p>
</dd>
<dt>ffrate</dt><dd><p>Federal funds interest rate.</p>
</dd>    
<dt>tbill</dt><dd><p>3-month treasury bill interest rate.</p>
</dd>
<dt>tbond</dt><dd><p>1-year treasury bond interest rate.</p>
</dd>
<dt>gbpusd</dt><dd><p>GBP/USD exchange rate (US dollar in cents per British pound).</p>
</dd>
<dt>gdpjp</dt><dd><p>GDP for Japan.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The US Consumer Price Index is measured using monthly surveys 
and is compiled by the Bureau of Labor Statistics (BLS). The
unemployment rate is computed from the BLS's Current Population. The quarterly data
used here were computed by averaging the monthly values. The interest data are the
monthly average of daily rates as reported by the Federal Reserve and the dollar-pound
exchange rate data are the monthly average of daily rates; both are for the final month in
the quarter. Japanese real GDP data were obtained from the OECD.
</p>


<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code>, <code><a href="#topic+USMacroSWM">USMacroSWM</a></code>, <code><a href="#topic+USMacroSWQ">USMacroSWQ</a></code>,
<code><a href="#topic+USMacroB">USMacroB</a></code>, <code><a href="#topic+USMacroG">USMacroG</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Stock and Watson (2007)
data("USMacroSW", package = "AER")
library("dynlm")
library("strucchange")
usm &lt;- ts.intersect(USMacroSW, 4 * 100 * diff(log(USMacroSW[, "cpi"])))
colnames(usm) &lt;- c(colnames(USMacroSW), "infl")

## Equations 14.7, 14.13, 14.16, 14.17, pp. 536
fm_ar1 &lt;- dynlm(d(infl) ~ L(d(infl)),
  data = usm, start = c(1962,1), end = c(2004,4))
fm_ar4 &lt;- dynlm(d(infl) ~ L(d(infl), 1:4), 
  data = usm, start = c(1962,1), end = c(2004,4))
fm_adl41 &lt;- dynlm(d(infl) ~ L(d(infl), 1:4) + L(unemp),
  data = usm, start = c(1962,1), end = c(2004,4))
fm_adl44 &lt;- dynlm(d(infl) ~ L(d(infl), 1:4) + L(unemp, 1:4),
  data = usm, start = c(1962,1), end = c(2004,4))
coeftest(fm_ar1, vcov = sandwich)
coeftest(fm_ar4, vcov = sandwich)
coeftest(fm_adl41, vcov = sandwich)
coeftest(fm_adl44, vcov = sandwich)

## Granger causality test mentioned on p. 547
waldtest(fm_ar4, fm_adl44, vcov = sandwich)  

## Figure 14.5, p. 570
## SW perform partial break test of unemp coefs
## here full model is used
mf &lt;- model.frame(fm_adl44) ## re-use fm_adl44
mf &lt;- ts(as.matrix(mf), start = c(1962, 1), freq = 4)
colnames(mf) &lt;- c("y", paste("x", 1:8, sep = ""))
ff &lt;- as.formula(paste("y", "~",  paste("x", 1:8, sep = "", collapse = " + ")))
fs &lt;- Fstats(ff, data = mf, from = 0.1)
plot(fs)
lines(boundary(fs, alpha = 0.01), lty = 2, col = 2)
lines(boundary(fs, alpha = 0.1), lty = 3, col = 2)

## More examples can be found in:
## help("StockWatson2007")
</code></pre>

<hr>
<h2 id='USMacroSWM'>Monthly US Macroeconomic Data (1947&ndash;2004, Stock &amp; Watson)</h2><span id='topic+USMacroSWM'></span>

<h3>Description</h3>

<p>Time series data on 4 US macroeconomic variables for 1947&ndash;2004.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("USMacroSWM")</code></pre>


<h3>Format</h3>

<p>A monthly multiple time series from 1947(1) to 2004(4) with 4 variables.
</p>

<dl>
<dt>production</dt><dd><p>index of industrial production.</p>
</dd>
<dt>oil</dt><dd><p>oil price shocks, starting 1948(1).</p>
</dd>
<dt>cpi</dt><dd><p>all-items consumer price index.</p>
</dd>
<dt>expenditure</dt><dd><p>personal consumption expenditures price deflator, starting 1959(1).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code>, <code><a href="#topic+USMacroSW">USMacroSW</a></code>, <code><a href="#topic+USMacroSWQ">USMacroSWQ</a></code>,
<code><a href="#topic+USMacroB">USMacroB</a></code>, <code><a href="#topic+USMacroG">USMacroG</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("USMacroSWM")
plot(USMacroSWM)
</code></pre>

<hr>
<h2 id='USMacroSWQ'>Quarterly US Macroeconomic Data (1947&ndash;2004, Stock &amp; Watson)</h2><span id='topic+USMacroSWQ'></span>

<h3>Description</h3>

<p>Time series data on 2 US macroeconomic variables for 1947&ndash;2004.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("USMacroSWQ")</code></pre>


<h3>Format</h3>

<p>A quarterly multiple time series from 1947(1) to 2004(4) with 2 variables.
</p>

<dl>
<dt>gdp</dt><dd><p>real GDP for the United States in billions of chained (2000) dollars
seasonally adjusted, annual rate.</p>
</dd>
<dt>tbill</dt><dd><p>3-month treasury bill rate. Quarterly averages of daily dates
in percentage points at an annual rate.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code>, <code><a href="#topic+USMacroSW">USMacroSW</a></code>, <code><a href="#topic+USMacroSWM">USMacroSWM</a></code>,
<code><a href="#topic+USMacroB">USMacroB</a></code>, <code><a href="#topic+USMacroG">USMacroG</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("USMacroSWQ")
plot(USMacroSWQ)
</code></pre>

<hr>
<h2 id='USMoney'>USMoney</h2><span id='topic+USMoney'></span>

<h3>Description</h3>

<p>Money, output and price deflator time series data, 1950&ndash;1983.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("USMoney")</code></pre>


<h3>Format</h3>

<p>A quarterly multiple time series from 1950 to 1983 with 3 variables.
</p>

<dl>
<dt>gnp</dt><dd><p>nominal GNP.</p>
</dd>
<dt>m1</dt><dd><p>M1 measure of money stock.</p>
</dd>
<dt>deflator</dt><dd><p>implicit price deflator for GNP.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Greene (2003), Table F20.2.
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm">https://pages.stern.nyu.edu/~wgreene/Text/tables/tablelist5.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Upper Saddle River, NJ: Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Greene2003">Greene2003</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("USMoney")
plot(USMoney)
</code></pre>

<hr>
<h2 id='USProdIndex'>Index of US Industrial Production</h2><span id='topic+USProdIndex'></span>

<h3>Description</h3>

<p>Index of US industrial production (1985 = 100).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("USProdIndex")</code></pre>


<h3>Format</h3>

<p>A quarterly multiple time series from 1960(1) to 1981(4) with 2 variables.
</p>

<dl>
<dt>unadjusted</dt><dd><p>raw index of industrial production,</p>
</dd>
<dt>adjusted</dt><dd><p>seasonally adjusted index.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Franses (1998).
</p>


<h3>References</h3>

<p>Franses, P.H. (1998). <em>Time Series Models for Business and Economic Forecasting</em>.
Cambridge, UK: Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Franses1998">Franses1998</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("USProdIndex")
plot(USProdIndex, plot.type = "single", col = 1:2)

## EACF tables (Franses 1998, p. 99)
ctrafo &lt;- function(x) residuals(lm(x ~ factor(cycle(x))))
ddiff &lt;- function(x) diff(diff(x, frequency(x)), 1)
eacf &lt;- function(y, lag = 12) {
  stopifnot(all(lag &gt; 0))
  if(length(lag) &lt; 2) lag &lt;- 1:lag
  rval &lt;- sapply(
    list(y = y, dy = diff(y), cdy = ctrafo(diff(y)),
         Dy = diff(y, frequency(y)), dDy = ddiff(y)),
    function(x) acf(x, plot = FALSE, lag.max = max(lag))$acf[lag + 1])
  rownames(rval) &lt;- lag
  return(rval)
}

## Franses (1998), Table 5.1
round(eacf(log(USProdIndex[,1])), digits = 3)

## Franses (1998), Equation 5.6: Unrestricted airline model
## (Franses: ma1 = 0.388 (0.063), ma4 = -0.739 (0.060), ma5 = -0.452 (0.069))
arima(log(USProdIndex[,1]), c(0, 1, 5), c(0, 1, 0), fixed = c(NA, 0, 0, NA, NA))
</code></pre>

<hr>
<h2 id='USSeatBelts'>Effects of Mandatory Seat Belt Laws in the US</h2><span id='topic+USSeatBelts'></span>

<h3>Description</h3>

<p>Balanced panel data for the years 1983&ndash;1997 from 50 US States, plus the District of Columbia,
for assessing traffic fatalities and seat belt usage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("USSeatBelts")</code></pre>


<h3>Format</h3>

<p>A data frame containing 765 observations on 12 variables.
</p>

<dl>
<dt>state</dt><dd><p>factor indicating US state (abbreviation).</p>
</dd>
<dt>year</dt><dd><p>factor indicating year.</p>
</dd>
<dt>miles</dt><dd><p>millions of traffic miles per year.</p>
</dd>
<dt>fatalities</dt><dd><p>number of fatalities per million of traffic miles
(absolute frequencies of fatalities = <code>fatalities</code> times <code>miles</code>).</p>
</dd>
<dt>seatbelt</dt><dd><p>seat belt usage rate, as self-reported by state population surveyed.</p>
</dd>  
<dt>speed65</dt><dd><p>factor. Is there a 65 mile per hour speed limit?</p>
</dd>
<dt>speed70</dt><dd><p>factor. Is there a 70 (or higher) mile per hour speed limit?</p>
</dd>  
<dt>drinkage</dt><dd><p>factor. Is there a minimum drinking age of 21 years?</p>
</dd> 
<dt>alcohol</dt><dd><p>factor. Is there a maximum of 0.08 blood alcohol content?</p>
</dd>
<dt>income</dt><dd><p>median per capita income (in current US dollar).</p>
</dd>
<dt>age</dt><dd><p>mean age.</p>
</dd>
<dt>enforce</dt><dd><p>factor indicating seat belt law enforcement
(<code>"no"</code>, <code>"primary"</code>, <code>"secondary"</code>).</p>
</dd>
</dl>



<h3>Details</h3>

<p>Some data series from Cohen and Einav (2003) have not been included in the data frame.
</p>


<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Cohen, A., and Einav, L. (2003). The Effects of Mandatory Seat Belt Laws on Driving
Behavior and Traffic Fatalities.
<em>The Review of Economics and Statistics</em>, <b>85</b>, 828&ndash;843
</p>
<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("USSeatBelts")
summary(USSeatBelts)

library("lattice")
xyplot(fatalities ~ as.numeric(as.character(year)) | state, data = USSeatBelts, type = "l")
</code></pre>

<hr>
<h2 id='USStocksSW'>Monthly US Stock Returns (1931&ndash;2002, Stock &amp; Watson)</h2><span id='topic+USStocksSW'></span>

<h3>Description</h3>

<p>Monthly data from 1931&ndash;2002 for US stock prices, measured by the
broad-based (NYSE and AMEX) value-weighted index of stock prices as
constructed by the Center for Research in Security Prices (CRSP). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("USStocksSW")</code></pre>


<h3>Format</h3>

<p>A monthly multiple time series from 1931(1) to 2002(12) with 2 variables.
</p>

<dl>
<dt>returns</dt><dd><p>monthly excess returns. The monthly return on stocks
(in percentage terms) minus the return on a safe asset (in this case:
US treasury bill). The return on the stocks includes the price changes
plus any dividends you receive during the month.</p>
</dd>
<dt>dividend</dt><dd><p>100 times log(dividend yield). (Multiplication by 100
means the changes are interpreted as percentage points). It is calculated 
as the dividends over the past 12 months, divided by the price in the current month.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Campbell, J.Y., and Yogo, M. (2006). Efficient Tests of Stock Return Predictability
<em>Journal of Financial Economics</em>, <b>81</b>, 27&ndash;60.
</p>
<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("USStocksSW")
plot(USStocksSW)

## Stock and Watson, p. 540, Table 14.3
library("dynlm")
fm1 &lt;- dynlm(returns ~ L(returns), data = USStocksSW, start = c(1960,1))
coeftest(fm1, vcov = sandwich)
fm2 &lt;- dynlm(returns ~ L(returns, 1:2), data = USStocksSW, start = c(1960,1))
waldtest(fm2, vcov = sandwich)
fm3 &lt;- dynlm(returns ~ L(returns, 1:4), data = USStocksSW, start = c(1960,1))
waldtest(fm3, vcov = sandwich)

## Stock and Watson, p. 574, Table 14.7
fm4 &lt;- dynlm(returns ~ L(returns) + L(d(dividend)), data = USStocksSW, start = c(1960, 1))
fm5 &lt;- dynlm(returns ~ L(returns, 1:2) + L(d(dividend), 1:2), data = USStocksSW, start = c(1960,1))
fm6 &lt;- dynlm(returns ~ L(returns) + L(dividend), data = USStocksSW, start = c(1960,1))
</code></pre>

<hr>
<h2 id='WeakInstrument'>Artificial Weak Instrument Data</h2><span id='topic+WeakInstrument'></span>

<h3>Description</h3>

<p>Artificial data set to illustrate the problem of weak instruments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("WeakInstrument")</code></pre>


<h3>Format</h3>

<p>A data frame containing 200 observations on 3 variables.
</p>

<dl>
<dt>y</dt><dd><p>dependent variable.</p>
</dd>
<dt>x</dt><dd><p>regressor variable.</p>
</dd>
<dt>z</dt><dd><p>instrument variable.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Online complements to Stock and Watson (2007). 
</p>


<h3>References</h3>

<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed. Boston: Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StockWatson2007">StockWatson2007</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("WeakInstrument")
fm &lt;- ivreg(y ~ x | z, data = WeakInstrument)
summary(fm)
</code></pre>

<hr>
<h2 id='WinkelmannBoes2009'>Data and Examples from Winkelmann and Boes (2009)</h2><span id='topic+WinkelmannBoes2009'></span>

<h3>Description</h3>

<p>This manual page collects a list of examples from the book. Some 
solutions might not be exact and the list is not complete.
If you have suggestions for improvement (preferably in the form of code),
please contact the package maintainer.
</p>


<h3>References</h3>

<p>Winkelmann, R., and Boes, S. (2009). <em>Analysis of Microdata</em>, 2nd ed. Berlin and Heidelberg: Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GSS7402">GSS7402</a></code>, <code><a href="#topic+GSOEP9402">GSOEP9402</a></code>, <code><a href="#topic+PSID1976">PSID1976</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>

#########################################
## US General Social Survey 1974--2002 ##
#########################################

## data
data("GSS7402", package = "AER")

## completed fertility subset
gss40 &lt;- subset(GSS7402, age &gt;= 40)


## Chapter 1
## Table 1.1
gss_kids &lt;- table(gss40$kids)
cbind(absolute = gss_kids,
  relative = round(prop.table(gss_kids) * 100, digits = 2))

## Table 1.2
sd1 &lt;- function(x) sd(x) / sqrt(length(x))
with(gss40, round(cbind(
  "obs"            = tapply(kids, year, length),
  "av kids"        = tapply(kids, year, mean),
  " " =              tapply(kids, year, sd1),
  "prop childless" = tapply(kids, year, function(x) mean(x &lt;= 0)),
   " " =             tapply(kids, year, function(x) sd1(x &lt;= 0)),
  "av schooling"   = tapply(education, year, mean),
   " " =             tapply(education, year, sd1)
), digits = 2))

## Table 1.3
gss40$trend &lt;- gss40$year - 1974
kids_lm1 &lt;- lm(kids ~ factor(year), data = gss40)
kids_lm2 &lt;- lm(kids ~ trend, data = gss40)
kids_lm3 &lt;- lm(kids ~ trend + education, data = gss40)


## Chapter 2
## Table 2.1
kids_tab &lt;- prop.table(xtabs(~ kids + year, data = gss40), 2) * 100
round(kids_tab[,c(4, 8)], digits = 2)
## Figure 2.1
barplot(t(kids_tab[, c(4, 8)]), beside = TRUE, legend = TRUE)


## Chapter 3, Example 3.14
## Table 3.1
gss40$nokids &lt;- factor(gss40$kids &lt;= 0,
  levels = c(FALSE, TRUE), labels = c("no", "yes"))
nokids_p1 &lt;- glm(nokids ~ 1, data = gss40, family = binomial(link = "probit"))
nokids_p2 &lt;- glm(nokids ~ trend, data = gss40, family = binomial(link = "probit"))
nokids_p3 &lt;- glm(nokids ~ trend + education + ethnicity + siblings,
  data = gss40, family = binomial(link = "probit"))

## p. 87
lrtest(nokids_p1, nokids_p2, nokids_p3)

## Chapter 4, Example 4.1
gss40$nokids01 &lt;- as.numeric(gss40$nokids) - 1
nokids_lm3 &lt;- lm(nokids01 ~ trend + education + ethnicity + siblings, data = gss40)
coeftest(nokids_lm3, vcov = sandwich)

## Example 4.3
## Table 4.1
nokids_l1 &lt;- glm(nokids ~ 1, data = gss40, family = binomial(link = "logit"))
nokids_l3 &lt;- glm(nokids ~ trend + education + ethnicity + siblings,
  data = gss40, family = binomial(link = "logit"))
lrtest(nokids_p3)
lrtest(nokids_l3)

## Table 4.2
nokids_xbar &lt;- colMeans(model.matrix(nokids_l3))
sum(coef(nokids_p3) * nokids_xbar)
sum(coef(nokids_l3) * nokids_xbar)
dnorm(sum(coef(nokids_p3) * nokids_xbar))
dlogis(sum(coef(nokids_l3) * nokids_xbar))
dnorm(sum(coef(nokids_p3) * nokids_xbar)) * coef(nokids_p3)[3]
dlogis(sum(coef(nokids_l3) * nokids_xbar)) * coef(nokids_l3)[3]
exp(coef(nokids_l3)[3])

## Figure 4.4
## everything by hand (for ethnicity = "cauc" group)
nokids_xbar &lt;- as.vector(nokids_xbar)
nokids_nd &lt;- data.frame(education = seq(0, 20, by = 0.5), trend = nokids_xbar[2],
  ethnicity = "cauc", siblings = nokids_xbar[4])
nokids_p3_fit &lt;- predict(nokids_p3, newdata = nokids_nd,
  type = "response", se.fit = TRUE)
plot(nokids_nd$education, nokids_p3_fit$fit, type = "l", 
  xlab = "education", ylab = "predicted probability", ylim = c(0, 0.3))
polygon(c(nokids_nd$education, rev(nokids_nd$education)),
  c(nokids_p3_fit$fit + 1.96 * nokids_p3_fit$se.fit,
  rev(nokids_p3_fit$fit - 1.96 * nokids_p3_fit$se.fit)),
  col = "lightgray", border = "lightgray")
lines(nokids_nd$education, nokids_p3_fit$fit)

## using "effects" package (for average "ethnicity" variable)
library("effects")
nokids_p3_ef &lt;- effect("education", nokids_p3, xlevels = list(education = 0:20))
plot(nokids_p3_ef, rescale.axis = FALSE, ylim = c(0, 0.3))

## using "effects" plus modification by hand
nokids_p3_ef1 &lt;- as.data.frame(nokids_p3_ef)
plot(pnorm(fit) ~ education, data = nokids_p3_ef1, type = "n", ylim = c(0, 0.3))
polygon(c(0:20, 20:0), pnorm(c(nokids_p3_ef1$upper, rev(nokids_p3_ef1$lower))),
  col = "lightgray", border = "lightgray")
lines(pnorm(fit) ~ education, data = nokids_p3_ef1)

## Table 4.6
## McFadden's R^2
1 - as.numeric( logLik(nokids_p3) / logLik(nokids_p1) )
1 - as.numeric( logLik(nokids_l3) / logLik(nokids_l1) )
## McKelvey and Zavoina R^2
r2mz &lt;- function(obj) {
  ystar &lt;- predict(obj)
  sse &lt;- sum((ystar - mean(ystar))^2)
  s2 &lt;- switch(obj$family$link, "probit" = 1, "logit" = pi^2/3, NA)
  n &lt;- length(residuals(obj))
  sse / (n * s2 + sse)
}
r2mz(nokids_p3)
r2mz(nokids_l3)
## AUC
library("ROCR")
nokids_p3_pred &lt;- prediction(fitted(nokids_p3), gss40$nokids)
nokids_l3_pred &lt;- prediction(fitted(nokids_l3), gss40$nokids)
plot(performance(nokids_p3_pred, "tpr", "fpr"))
abline(0, 1, lty = 2)
performance(nokids_p3_pred, "auc")
plot(performance(nokids_l3_pred, "tpr", "fpr"))
abline(0, 1, lty = 2)
performance(nokids_l3_pred, "auc")@y.values

## Chapter 7
## Table 7.3
## subset selection
gss02 &lt;- subset(GSS7402, year == 2002 &amp; (age &lt; 40 | !is.na(agefirstbirth)))
#Z# This selection conforms with top of page 229. However, there
#Z# are too many observations: 1374. Furthermore, there are six
#Z# observations with agefirstbirth &lt;= 14 which will cause problems in
#Z# taking logs!

## computing time to first birth
gss02$tfb &lt;- with(gss02, ifelse(is.na(agefirstbirth), age - 14, agefirstbirth - 14))
#Z# currently this is still needed before taking logs
gss02$tfb &lt;- pmax(gss02$tfb, 1)

tfb_tobit &lt;- tobit(log(tfb) ~ education + ethnicity + siblings + city16 + immigrant,
  data = gss02, left = -Inf, right = log(gss02$age - 14))
tfb_ols &lt;- lm(log(tfb) ~ education + ethnicity + siblings + city16 + immigrant,
  data = gss02, subset = !is.na(agefirstbirth))

## Chapter 8
## Example 8.3
gss2002 &lt;- subset(GSS7402, year == 2002 &amp; (agefirstbirth &lt; 40 | age &lt; 40))
gss2002$afb &lt;- with(gss2002, Surv(ifelse(kids &gt; 0, agefirstbirth, age), kids &gt; 0))
afb_km &lt;- survfit(afb ~ 1, data = gss2002)
afb_skm &lt;- summary(afb_km)
print(afb_skm)
with(afb_skm, plot(n.event/n.risk ~ time, type = "s"))
plot(afb_km, xlim = c(10, 40), conf.int = FALSE)

## Example 8.9
library("survival")
afb_ex &lt;- survreg(
  afb ~ education + siblings + ethnicity + immigrant + lowincome16 + city16,
  data = gss2002, dist = "exponential")
afb_wb &lt;- survreg(
  afb ~ education + siblings + ethnicity + immigrant + lowincome16 + city16,
  data = gss2002, dist = "weibull")
afb_ln &lt;- survreg(
  afb ~ education + siblings + ethnicity + immigrant + lowincome16 + city16,
  data = gss2002, dist = "lognormal")

## Example 8.11
kids_pois &lt;- glm(kids ~ education + trend + ethnicity + immigrant + lowincome16 + city16,
  data = gss40, family = poisson)
library("MASS")
kids_nb &lt;- glm.nb(kids ~ education + trend + ethnicity + immigrant + lowincome16 + city16,
  data = gss40)
lrtest(kids_pois, kids_nb)


############################################
## German Socio-Economic Panel 1994--2002 ##
############################################

## data
data("GSOEP9402", package = "AER")

## some convenience data transformations
gsoep &lt;- GSOEP9402
gsoep$meducation2 &lt;- cut(gsoep$meducation, breaks = c(6, 10.25, 12.25, 18),
  labels = c("7-10", "10.5-12", "12.5-18"))
gsoep$year2 &lt;- factor(gsoep$year)

## Chapter 1
## Table 1.4 plus visualizations
gsoep_tab &lt;- xtabs(~ meducation2 + school, data = gsoep)
round(prop.table(gsoep_tab, 1) * 100, digits = 2)
spineplot(gsoep_tab)
plot(school ~ meducation, data = gsoep, breaks = c(7, 10.25, 12.25, 18))
plot(school ~ meducation, data = gsoep, breaks = c(7, 9, 10.5, 11.5, 12.5, 15, 18))


## Chapter 5
## Table 5.1
library("nnet")
gsoep_mnl &lt;- multinom(
  school ~ meducation + memployment + log(income) + log(size) + parity + year2,
  data = gsoep)
coeftest(gsoep_mnl)[c(1:6, 1:6 + 14),]
 
## alternatively
library("mlogit")
gsoep_mnl2 &lt;- mlogit(school ~ 0 | meducation + memployment + log(income) +
  log(size) + parity + year2, data = gsoep, shape = "wide", reflevel = "Hauptschule")
coeftest(gsoep_mnl2)[1:12,]

## Table 5.2
library("effects")
gsoep_eff &lt;- effect("meducation", gsoep_mnl,
  xlevels = list(meducation = sort(unique(gsoep$meducation))))
gsoep_eff$prob
plot(gsoep_eff, confint = FALSE)

## Table 5.3, odds
exp(coef(gsoep_mnl)[, "meducation"])

## all effects
eff_mnl &lt;- allEffects(gsoep_mnl)
plot(eff_mnl, ask = FALSE, confint = FALSE)
plot(eff_mnl, ask = FALSE, style = "stacked", colors = gray.colors(3))

## omit year
gsoep_mnl1 &lt;- multinom(
  school ~ meducation + memployment + log(income) + log(size) + parity,
  data = gsoep)
lrtest(gsoep_mnl, gsoep_mnl1)
eff_mnl1 &lt;- allEffects(gsoep_mnl1)
plot(eff_mnl1, ask = FALSE, confint = FALSE)
plot(eff_mnl1, ask = FALSE, style = "stacked", colors = gray.colors(3))


## Chapter 6
## Table 6.1
library("MASS")
gsoep$munemp &lt;- factor(gsoep$memployment != "none",
  levels = c(FALSE, TRUE), labels = c("no", "yes"))
gsoep_pop &lt;- polr(school ~ meducation + munemp + log(income) + log(size) + parity + year2,
  data = gsoep, method = "probit", Hess = TRUE)
gsoep_pol &lt;- polr(school ~ meducation + munemp + log(income) + log(size) + parity + year2,
  data = gsoep, Hess = TRUE)
lrtest(gsoep_pop)
lrtest(gsoep_pol)

## Table 6.2
## todo
eff_pol &lt;- allEffects(gsoep_pol)
plot(eff_pol, ask = FALSE, confint = FALSE)
plot(eff_pol, ask = FALSE, style = "stacked", colors = gray.colors(3))


####################################
## Labor Force Participation Data ##
####################################

## Mroz data
data("PSID1976", package = "AER")
PSID1976$nwincome &lt;- with(PSID1976, (fincome - hours * wage)/1000)

## visualizations
plot(hours ~ nwincome, data = PSID1976,
  xlab = "Non-wife income (in USD 1000)",
  ylab = "Hours of work in 1975")

plot(jitter(hours, 200) ~ jitter(wage, 50), data = PSID1976,
  xlab = "Wife's average hourly wage (jittered)",
  ylab = "Hours of work in 1975 (jittered)")

## Chapter 1, p. 18
hours_lm &lt;- lm(hours ~ wage + nwincome + youngkids + oldkids, data = PSID1976,
  subset = participation == "yes")

## Chapter 7
## Example 7.2, Table 7.1
hours_tobit &lt;- tobit(hours ~ nwincome + education + experience + I(experience^2) +
  age + youngkids + oldkids, data = PSID1976)
hours_ols1 &lt;- lm(hours ~ nwincome + education + experience + I(experience^2) +
  age + youngkids + oldkids, data = PSID1976)
hours_ols2 &lt;- lm(hours ~ nwincome + education + experience + I(experience^2) +
  age + youngkids + oldkids, data = PSID1976, subset = participation == "yes")

## Example 7.10, Table 7.4
wage_ols &lt;- lm(log(wage) ~ education + experience + I(experience^2),
  data = PSID1976, subset = participation == "yes")

library("sampleSelection")
wage_ghr &lt;- selection(participation ~ nwincome + age + youngkids + oldkids +
  education + experience + I(experience^2), 
  log(wage) ~ education + experience + I(experience^2), data = PSID1976)

## Exercise 7.13
hours_cragg1 &lt;- glm(participation ~ nwincome + education +
  experience + I(experience^2) + age + youngkids + oldkids,
  data = PSID1976, family = binomial(link = "probit"))
library("truncreg")
hours_cragg2 &lt;- truncreg(hours ~ nwincome + education +
  experience + I(experience^2) + age + youngkids + oldkids,
  data = PSID1976, subset = participation == "yes")

## Exercise 7.15
wage_olscoef &lt;- sapply(c(-Inf, 0.5, 1, 1.5, 2), function(censpoint)
  coef(lm(log(wage) ~ education + experience + I(experience^2),
  data = PSID1976[log(PSID1976$wage) &gt; censpoint,])))
wage_mlcoef &lt;- sapply(c(0.5, 1, 1.5, 2), function(censpoint)
  coef(tobit(log(wage) ~ education + experience + I(experience^2),
  data = PSID1976, left = censpoint)))


##################################
## Choice of Brand for Crackers ##
##################################

## data
library("mlogit")
data("Cracker", package = "mlogit")
head(Cracker, 3)
crack &lt;- mlogit.data(Cracker, varying = 2:13, shape = "wide", choice = "choice")
head(crack, 12)

## Table 5.6 (model 3 probably not fully converged in W&amp;B)
crack$price &lt;- crack$price/100
crack_mlogit1 &lt;- mlogit(choice ~ price | 0, data = crack, reflevel = "private")
crack_mlogit2 &lt;- mlogit(choice ~ price | 1, data = crack, reflevel = "private")
crack_mlogit3 &lt;- mlogit(choice ~ price + feat + disp | 1, data = crack,
  reflevel = "private")
lrtest(crack_mlogit1, crack_mlogit2, crack_mlogit3)

## IIA test
crack_mlogit_all &lt;- update(crack_mlogit2, reflevel = "nabisco")
crack_mlogit_res &lt;- update(crack_mlogit_all,
  alt.subset = c("keebler", "nabisco", "sunshine"))
hmftest(crack_mlogit_all, crack_mlogit_res)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
