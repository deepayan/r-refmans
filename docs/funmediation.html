<!DOCTYPE html><html lang="en"><head><title>Help for package funmediation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {funmediation}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#funmediation'><p>funmediation:  Fit funmediation model</p></a></li>
<li><a href='#plot.funmediation'><p>plot.funmediation: Produces plots for a funmediation model.</p></a></li>
<li><a href='#print.funmediation'><p>print.funmediation:  Print output from a model that was fit by the funmediation function.</p></a></li>
<li><a href='#simulate_funmediation_example'><p>simulate_funmediation_example function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Functional Mediation for a Distal Outcome</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>refund, tvem, boot</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>John J. Dziak &lt;dziakj1@gmail.com&gt;</td>
</tr>
<tr>
<td>Copyright:</td>
<td>2021 by The Pennsylvania State University</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits a functional mediation model with a scalar distal outcome. The method is described in detail by Coffman, Dziak, Litson, Chakraborti, Piper &amp; Li (2021) &lt;<a href="https://doi.org/10.48550/arXiv.2112.03960">doi:10.48550/arXiv.2112.03960</a>&gt;. The model is similar to that of Lindquist (2012) &lt;<a href="https://doi.org/10.1080%2F01621459.2012.695640">doi:10.1080/01621459.2012.695640</a>&gt; although allowing a binary outcome as an alternative to a numerical outcome.  The current version is a minor bug fix in the vignette. The development of this package was part of a research project supported by National Institutes of Health grants P50 DA039838 from the National Institute of Drug Abuse and 1R01 CA229542-01 from the National Cancer Institute and the NIH Office of Behavioral and Social Science Research. Content is solely the responsibility of the authors and does not necessarily represent the official views of the funding institutions mentioned above. This software is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-09 02:20:04 UTC; dziak</td>
</tr>
<tr>
<td>Author:</td>
<td>John J. Dziak <a href="https://orcid.org/0000-0003-0762-5495"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Donna L. Coffman <a href="https://orcid.org/0000-0001-6305-6579"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Kaylee Litson [aut],
  Yajnaseni Chakraborti [aut],
  Runze Li [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-09 08:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='funmediation'>funmediation:  Fit funmediation model</h2><span id='topic+funmediation'></span>

<h3>Description</h3>

<p>Calculate indirect effect of a binary treatment on a scalar
response as mediated by a longitudinal functional trajectory
(see Baron &amp; Kenny, 1986; Lindquist, 2012; Coffman et al., 2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>funmediation(
  data,
  treatment,
  mediator,
  outcome,
  id,
  time,
  tve_covariates_on_mediator = NULL,
  tie_covariates_on_mediator = NULL,
  covariates_on_outcome = NULL,
  interpolate = TRUE,
  tvem_penalize = TRUE,
  tvem_penalty_order = 1,
  tvem_spline_order = 3,
  tvem_num_knots = 3,
  tvem_do_loop = FALSE,
  tvem_use_bic = FALSE,
  binary_mediator = FALSE,
  binary_outcome = FALSE,
  nboot = 200,
  boot_level = 0.05,
  show_progress = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="funmediation_+3A_data">data</code></td>
<td>
<p>The dataset containing the data to be analyzed, in long
format (one row per observation, multiple per individual).</p>
</td></tr>
<tr><td><code id="funmediation_+3A_treatment">treatment</code></td>
<td>
<p>The name of the variable containing the treatment
assignment, assumed to be unidimensional (either binary
or else numeric).  We recommend a binary (dichotomous) treatment with
0 for control and 1 for experimental).  The values of this variable
should be the same for each row for a given subject.  If there are
more than one treatment variables, such as a dummy-coded exposure with
more than two levels, specify them as a formula such as ~x1+x2.</p>
</td></tr>
<tr><td><code id="funmediation_+3A_mediator">mediator</code></td>
<td>
<p>The name of the mediator variable. The values of
this variable can (and should) vary within each subject.</p>
</td></tr>
<tr><td><code id="funmediation_+3A_outcome">outcome</code></td>
<td>
<p>The name of the outcome variable. The values of this
variable should be the same for each row for a given subject.</p>
</td></tr>
<tr><td><code id="funmediation_+3A_id">id</code></td>
<td>
<p>The name of the variable identifying each subject.</p>
</td></tr>
<tr><td><code id="funmediation_+3A_time">time</code></td>
<td>
<p>The name of the time variable.</p>
</td></tr>
<tr><td><code id="funmediation_+3A_tve_covariates_on_mediator">tve_covariates_on_mediator</code></td>
<td>
<p>The covariates with time-varying-effects,
if any, to be included in the model predicting the mediator from
the treatment.</p>
</td></tr>
<tr><td><code id="funmediation_+3A_tie_covariates_on_mediator">tie_covariates_on_mediator</code></td>
<td>
<p>The covariates with time-invariant
effects, if any, to be included in the
model predicting the mediator from the treatment.</p>
</td></tr>
<tr><td><code id="funmediation_+3A_covariates_on_outcome">covariates_on_outcome</code></td>
<td>
<p>The covariates, if any, to be included
in the model predicting the outcome from the treatment.
They are assumed to be subject-level (time-invariant both in value
and in effect).</p>
</td></tr>
<tr><td><code id="funmediation_+3A_interpolate">interpolate</code></td>
<td>
<p>What kind of presmoothing to use in the
penalized functional regression &ndash; specifically, whether
to interpolate each subject's trajectory on the mediator
(TRUE) or fit a spline to each subject's trajectory on the
mediator (FALSE).  This will be counted as TRUE if
binary_mediator is TRUE because it does
not make as much sense to interpolate a binary outcome.</p>
</td></tr>
<tr><td><code id="funmediation_+3A_tvem_penalize">tvem_penalize</code></td>
<td>
<p>Input to be passed on to the tvem function</p>
</td></tr>
<tr><td><code id="funmediation_+3A_tvem_penalty_order">tvem_penalty_order</code></td>
<td>
<p>Input to be passed on to the tvem function</p>
</td></tr>
<tr><td><code id="funmediation_+3A_tvem_spline_order">tvem_spline_order</code></td>
<td>
<p>Input to be passed on to the tvem function</p>
</td></tr>
<tr><td><code id="funmediation_+3A_tvem_num_knots">tvem_num_knots</code></td>
<td>
<p>If tvem_do_loop is FALSE, then tvem_num_knots
is passed on to the tvem function as num_knots, an integer representing
the number of interior knots per B-spline. If tvem_do_loop is
TRUE then tvem_num_knots is reinterpreted as the highest number of
interior knots to try.</p>
</td></tr>
<tr><td><code id="funmediation_+3A_tvem_do_loop">tvem_do_loop</code></td>
<td>
<p>Whether to use a loop to select the number of knots
with a pseudo-AIC or pseudo-BIC, passed on to the tvem function</p>
</td></tr>
<tr><td><code id="funmediation_+3A_tvem_use_bic">tvem_use_bic</code></td>
<td>
<p>This parameter only matters if tvem_do_loop is TRUE.
If tvem_do_loop is TRUE
and tvem_use_bic is TRUE, then the information criterion used will be
a pseudolikelihood version of BIC.
If tvem_do_loop is TRUE and tvem_use_bic is FALSE, then the information
criterion used will be
a pseudolikelihood version of AIC instead. If tvem_do_loop is FALSE then
tvem_use_bic is ignored.</p>
</td></tr>
<tr><td><code id="funmediation_+3A_binary_mediator">binary_mediator</code></td>
<td>
<p>Whether the mediator should be modeled as
dichotomous with a logistic model (TRUE),
or numerical with a normal model (FALSE).</p>
</td></tr>
<tr><td><code id="funmediation_+3A_binary_outcome">binary_outcome</code></td>
<td>
<p>Whether the outcome should be modeled as
dichotomous with a logistic model (TRUE),
or numerical with a normal model (FALSE).</p>
</td></tr>
<tr><td><code id="funmediation_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap samples for bootstrap significance
test of the overall effect. This test is done using the boot
function from the boot package by Angelo Canty and Brian Ripley.
It differs somewhat from the bootstrap approach used in a similar
context by Lindquist (2012).  We recommend using at least 200 bootstrap
samples and preferably 500 or more.</p>
</td></tr>
<tr><td><code id="funmediation_+3A_boot_level">boot_level</code></td>
<td>
<p>One minus the nominal coverage for
the bootstrap confidence interval estimates.</p>
</td></tr>
<tr><td><code id="funmediation_+3A_show_progress">show_progress</code></td>
<td>
<p>Whether to display intermediate updates on the progress of
the bootstrap simulations.  If show_progress==FALSE then the funmediation
function runs silently but results can be viewed via the print and plot methods.
If show_progress==TRUE then progress messages will be printed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of type funmediation. The components of an object of
type funmediation are as follows:
</p>

<dl>
<dt>original_results</dt><dd><p>The estimates from the fitted models for
predicting the mediator from the treatment, predicting the outcome
from the mediator and treatment, and predicting the outcome from the
treatment alone.</p>
</dd>
<dt>bootstrap_results</dt><dd><p>The estimate and confidence interval of the
indirect effect using a bootstrap approach.</p>
</dd>
</dl>

<p>The original_results component has these components within it:
</p>

<dl>
<dt>time_grid</dt><dd><p>Grid of time points on which the functional
coefficients are estimated.</p>
</dd>
<dt>alpha_int_estimate</dt><dd><p>Estimated intercept function (as a vector
of estimates) from the TVEM regression of the mediator, M, on treatment, X.</p>
</dd>
<dt>alpha_int_se</dt><dd><p>Estimated pointwise standard errors associated
with the above.</p>
</dd>
<dt>alpha_X_estimate</dt><dd><p>Estimated time-varying treatment effect
from the TVEM regression of the mediator, M, on the treatment, X.</p>
</dd>
<dt>alpha_X_se</dt><dd><p>Estimated pointwise standard errors associated
with the above.</p>
</dd>
<dt>beta_int_estimate</dt><dd><p>Estimated scalar intercept from the scalar-on-
function regression of the outcome, Y, on the mediator, M, and treatment, X.</p>
</dd>
<dt>beta_int_se</dt><dd><p>Estimated standard error for the above.</p>
</dd>
<dt>beta_X_estimate</dt><dd><p>Estimated scalar coefficient for the treatment, X,
from the scalar-on-function regression of the outcome, Y, on the mediator,
M, and treatment, X.</p>
</dd>
<dt>beta_X_se</dt><dd><p>Estimated standard error for the above.</p>
</dd>
<dt>beta_M_estimate</dt><dd><p>Estimated functional coefficient for the mediator,
M, from the scalar-on-function regression of the outcome, Y, on the mediator,
M, and treatment, X.</p>
</dd>
<dt>beta_M_se</dt><dd><p>Estimated pointwise standard errors associated with the above</p>
</dd>
<dt>beta_M_pvalue</dt><dd><p>The p-value for significance of the mediator, M, in
predicting outcome, Y, after adjusting for treatment, X.</p>
</dd>
<dt>tau_int_estimate</dt><dd><p>Intercept from simple model predicting outcome, Y,
directly from treatment, X.</p>
</dd>
<dt>tau_int_se</dt><dd><p>Estimated standard error for the above.</p>
</dd>
<dt>tau_X_estimate</dt><dd><p>Coefficient for treatment in model predicting outcome,
Y, directly from treatment, X.</p>
</dd>
<dt>tau_X_se</dt><dd><p>Estimated standard error for the above.</p>
</dd>
<dt>indirect_effect_estimate</dt><dd><p>Estimated indirect effect, calculated as
the dot product of the effect of treatment on mediator and the treatment-
adjusted effect of mediator on outcome.  It is a scalar, even though the
two component effects are functions of time.</p>
</dd>
<dt>tvem_XM_details</dt><dd><p>Detailed output from the tvem function for the time-
varying-effect model predicting the mediator, M, from the treatment, X.</p>
</dd>
<dt>funreg_MY_details</dt><dd><p>Detailed output from the refund::pfr function for
the scalar-on-function functional regression predicting the outcome, Y, from
the treatment, X, and mediator, M.</p>
</dd>
<dt>total_effect_details</dt><dd><p>Detailed output from the linear or generalized
linear model predicting the outcome from the treatment alone, ignoring the
mediator (i.e., total effect)</p>
</dd>
</dl>

<p>The bootstrap_results component has these components within it:
</p>

<dl>
<dt>indirect_effect_boot_estimate</dt><dd><p>Bootstrap point estimate of the
indirect effect (average of bootstrap sample estimates).</p>
</dd>
<dt>indirect_effect_boot_se</dt><dd><p>Bootstrap standard error for the
indirect effect (standard deviation of bootstrap sample estimates).</p>
</dd>
<dt>indirect_effect_boot_norm_lower</dt><dd><p>Lower end of the bootstrap
confidence interval using the normal method in boot.ci in the boot package.</p>
</dd>
<dt>indirect_effect_boot_norm_upper</dt><dd><p>Upper end of the bootstrap
confidence interval using the normal method.</p>
</dd>
<dt>indirect_effect_boot_basic_lower</dt><dd><p>Lower end of the bootstrap
confidence interval using the basic method in boot.ci in the boot package.</p>
</dd>
<dt>indirect_effect_boot_basic_upper</dt><dd><p>Upper end of the bootstrap
confidence interval using the basic method.</p>
</dd>
<dt>indirect_effect_boot_perc_lower</dt><dd><p>Lower end of the bootstrap
confidence interval using the percentile method in boot.ci in the boot package.</p>
</dd>
<dt>indirect_effect_boot_perc_upper</dt><dd><p>Upper end of the bootstrap
confidence interval using the percentile method.</p>
</dd>
<dt>boot_level</dt><dd><p>The alpha level used for the bootstrap confidence interval.</p>
</dd>
<dt>boot1</dt><dd><p>The output returned from the boot function.</p>
</dd>
<dt>time.required</dt><dd><p>The amount of time spent doing the bootstrap test,
including generating and analyzing all samples.</p>
</dd>
</dl>



<h3>Note</h3>

<p>This function calls the tvem function in the tvem package.
It also calls the pfr function in the refund package (see
Goldsmith et al., 2011) to perform penalized functional regression.
Some suggestions on interpreting the output from penalized functional
regression are given by Dziak et al. (2019).
</p>


<h3>References</h3>

<p>Baron, R.M., &amp; Kenny, D.A. (1986). The moderator-mediator variable
distinction in social psychological research: Conceptual, strategic,
and statistical considerations. Journal of Personality &amp; Social
Psychology, 51: 1173-1182.
</p>
<p>Coffman, D. L., Dziak, J. J., Litson, K., Chakraborti, Y., Piper, M. E., &amp; Li, R. #' (2021). A causal approach to functional mediation analysis with application to a
smoking cessation intervention. &lt;arXiv:2112.03960&gt;
</p>
<p>Dziak, J. J., Coffman, D. L., Reimherr, M., Petrovich, J., Li, R.,
Shiffman, S., &amp; Shiyko, M. P. (2019). Scalar-on-function regression
for predicting distal outcomes from intensively gathered longitudinal
data: interpretability for applied scientists.
Statistics Surveys, 13, 150-180. &lt;doi:10.1214/19-SS126&gt;
</p>
<p>Goldsmith, J., Bobb, J., Crainiceanu, C., Caffo, B., &amp; Reich, D.
(2011). Penalized functional regression. Journal of Computational
and Graphical Statistics, 20(4), 830-851. &lt;doi:10.1198/jcgs.2010.10007&gt;
</p>
<p>Lindquist, M. A. (2012). Functional Causal Mediation Analysis
With an Application to Brain Connectivity. Journal of the American
Statistical Association, 107: 1297-1309. &lt;doi:10.1080/01621459.2012.695640&gt;
</p>

<hr>
<h2 id='plot.funmediation'>plot.funmediation: Produces plots for a funmediation model.</h2><span id='topic+plot.funmediation'></span>

<h3>Description</h3>

<p>Produces plots from a funmediation object produced by
the funmediation function. These plots will be shown on the default
output device (likely the screen); they can of course be
written to a file instead, by preceding the call to plot
with a call to png(), pdf(), or other R graphic file output functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'funmediation'
plot(
  x,
  use_panes = TRUE,
  what_plot = c("pfr", "pfrgam", "coefs", "tvem"),
  alpha_level = 0.05,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.funmediation_+3A_x">x</code></td>
<td>
<p>The funmediation object to be plotted.</p>
</td></tr>
<tr><td><code id="plot.funmediation_+3A_use_panes">use_panes</code></td>
<td>
<p>Whether to plot multiple coefficient functions in a single image.</p>
</td></tr>
<tr><td><code id="plot.funmediation_+3A_what_plot">what_plot</code></td>
<td>
<p>One of &quot;pfr&quot;,&quot;coefs&quot;, or &quot;tvem.&quot;  These options are as follows:
</p>

<dl>
<dt>pfr</dt><dd><p>For a &quot;pfr&quot; plot, the functional coefficient for predicting the
outcome, Y, from the mediator, M (conditional on X), is shown.</p>
</dd>
<dt>pfrgam</dt><dd><p>Similar to a &quot;pfr&quot; plot, but uses the plot method for
the penalized functional regression results. See the
documentation for pfr() in the refund library and for
plot.gam() in the mgcv library  for more information.</p>
</dd>
<dt>coefs</dt><dd><p>For a &quot;coefs&quot; plot, the three important functional coefficients
in the model (intercept for predicting M, effect of X on M,
and the effect of M on Y adjusting for X) are plotted one after
another. That is, the plots are shown for the alpha_int_estimate, alpha_X_estimate,
and beta_M_estimate, each as a function of time_grid.  Approximate pointwise
95 percent confidence intervals are also shown if possible.  If there is only
one dichotomous treatment variable and panes are being used, the lower right
pane will be free, so the indirect effect will be printed there even
though it is a scalar.</p>
</dd>
<dt>tvem</dt><dd><p>For a &quot;tvem&quot; plot, the functional coefficients in the TVEM model
predicting M from X are displayed.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="plot.funmediation_+3A_alpha_level">alpha_level</code></td>
<td>
<p>Default is .05 for pointwise 95 percent confidence intervals.</p>
</td></tr>
<tr><td><code id="plot.funmediation_+3A_...">...</code></td>
<td>
<p>Further arguments currently not supported</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function does not return an object, but is called for its side effect of plotting to the active device.
</p>

<hr>
<h2 id='print.funmediation'>print.funmediation:  Print output from a model that was fit by the funmediation function.</h2><span id='topic+print.funmediation'></span>

<h3>Description</h3>

<p>print.funmediation:  Print output from a model that was fit by the funmediation function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'funmediation'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.funmediation_+3A_x">x</code></td>
<td>
<p>The funmediation object (output of the funmediation function)</p>
</td></tr>
<tr><td><code id="print.funmediation_+3A_...">...</code></td>
<td>
<p>Further arguments currently not supported</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function does not return an object, but is called for its side effect of printing information.
</p>

<hr>
<h2 id='simulate_funmediation_example'>simulate_funmediation_example function</h2><span id='topic+simulate_funmediation_example'></span>

<h3>Description</h3>

<p>Simulates a dataset for demonstrating the funmediation function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_funmediation_example(
  nsub = 500,
  nlevels = 2,
  ntimes = 100,
  observe_rate = 0.4,
  alpha_int = function(t) {
     return(t^0.5)
 },
  alpha_X = function(t) {
     return(-(t/2)^0.5)
 },
  beta_M = function(t) {
     (1/2) * (exp(t) - 1)
 },
  beta_int = 0,
  beta_X = 0.2,
  sigma_Y = 1,
  sigma_M_error = 2,
  rho_M_error = 0.8,
  simulate_binary_Y = FALSE,
  make_covariate_S = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_funmediation_example_+3A_nsub">nsub</code></td>
<td>
<p>Number of subjects</p>
</td></tr>
<tr><td><code id="simulate_funmediation_example_+3A_nlevels">nlevels</code></td>
<td>
<p>Number of treatment groups or levels on the treatment variable X.
Subjects are assumed to be randomly assigned to each level with equal
probability (i.e., the probability per level is 1/nlevel).  Default is 2 for
a randomized controlled trial with a control group X=0 and an experimental
group X=1.  There should not be less than 2 or more than 5 groups for purposes
of this function.</p>
</td></tr>
<tr><td><code id="simulate_funmediation_example_+3A_ntimes">ntimes</code></td>
<td>
<p>Number of potential times that could be observed on each subject</p>
</td></tr>
<tr><td><code id="simulate_funmediation_example_+3A_observe_rate">observe_rate</code></td>
<td>
<p>Proportion of potential times on which there are actually
observations. Not all times are observed; this is assumed to be completely random and
to be done by design to reduce participant burden.</p>
</td></tr>
<tr><td><code id="simulate_funmediation_example_+3A_alpha_int">alpha_int</code></td>
<td>
<p>Function representing the time-varying mean of mediator variable
for the level of treatment with all treatment dummy codes X set to 0 (e.g., the
control group).</p>
</td></tr>
<tr><td><code id="simulate_funmediation_example_+3A_alpha_x">alpha_X</code></td>
<td>
<p>Function representing the time-varying effect of X on the
mediator (if there are two treatment levels) or a list of nlevels-1
functions representing the effect of receiving each nonzero level of X rather
than control (if there are more than two treatment levels).</p>
</td></tr>
<tr><td><code id="simulate_funmediation_example_+3A_beta_m">beta_M</code></td>
<td>
<p>Function representing the functional coefficient for cumulative
(scalar-on-function) effect of the mediator M on the treatment Y adjusting
for the treatment X</p>
</td></tr>
<tr><td><code id="simulate_funmediation_example_+3A_beta_int">beta_int</code></td>
<td>
<p>Mean of Y if the X is zero and M is the 0 function</p>
</td></tr>
<tr><td><code id="simulate_funmediation_example_+3A_beta_x">beta_X</code></td>
<td>
<p>Numeric value representing the direct effect of X on Y after adjusting
for M (if there are two treatment levels) or a vector of nlevels-1 numeric values
(if there are more than two treatment levels)</p>
</td></tr>
<tr><td><code id="simulate_funmediation_example_+3A_sigma_y">sigma_Y</code></td>
<td>
<p>Error standard deviation of the outcome Y (conditional on
treatment and mediator trajectory)</p>
</td></tr>
<tr><td><code id="simulate_funmediation_example_+3A_sigma_m_error">sigma_M_error</code></td>
<td>
<p>Error standard deviation of the mediator M (conditional
on treatment and time)</p>
</td></tr>
<tr><td><code id="simulate_funmediation_example_+3A_rho_m_error">rho_M_error</code></td>
<td>
<p>Autoregressive correlation coefficient of the error
in the mediator M, from one observation to the next</p>
</td></tr>
<tr><td><code id="simulate_funmediation_example_+3A_simulate_binary_y">simulate_binary_Y</code></td>
<td>
<p>Whether Y should be generated from a binary
logistic (TRUE) or Gaussian (FALSE) model</p>
</td></tr>
<tr><td><code id="simulate_funmediation_example_+3A_make_covariate_s">make_covariate_S</code></td>
<td>
<p>Whether to generate a random binary covariate S
at the subject (i.e., time-invariant) level. It will be generated to have 
zero population-level relationship to the outcome.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<dl>
<dt>time_grid</dt><dd><p>The time grid for interpreting functional coefficients.</p>
</dd>
<dt>true_alpha_int</dt><dd><p>True value of the time-varying alpha_int parameter,
representing the time-specific mean of the mediator M when the
treatment value X is 0. </p>
</dd>
<dt>true_alpha_X</dt><dd><p>True value of the time-varying alpha_X parameter,
representing the effect of X on M.  This is a single number if nlevels=2,
or a vector of effects if nlevels&gt;2.</p>
</dd>
<dt>true_beta_int</dt><dd><p>True value of the beta_M parameter, representing
the mean of the outcome Y when X=0 and M=0.</p>
</dd>
<dt>true_beta_M</dt><dd><p>True value of the beta_M parameter, representing the
functional effect of treatment on the outcome Y.</p>
</dd>
<dt>true_beta_X</dt><dd><p>True value of the beta_X parameter, representing the
effect of treatment on the outcome Y adjusting for the mediator. This
is a single function if nlevels=2, or a vector of functions if nlevels&gt;2.</p>
</dd>
<dt>true_indirect</dt><dd><p>True value of the indirect parameter, representing
the indirect (mediated) effect of treatment on the outcome Y.  This is
a single number if nlevels=2, or a vector of effects if nlevels&gt;2.</p>
</dd>
<dt>dataset</dt><dd><p>The simulated longitudinal dataset in long form.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
# Simplest way to call the function:
simulation_all_defaults &lt;- simulate_funmediation_example()
summary(simulation_all_defaults)
head(simulation_all_defaults)
# Changing the sample size to be larger:
simulation_larger &lt;- simulate_funmediation_example(nsub=10000)
summary(simulation_larger)
# Changing the effect of the mediator to be null:
simulation_null &lt;- simulate_funmediation_example(beta_M=function(t) {return(0*t)})
summary(simulation_null)
# Simulating a exposure variable with three levels (two dichotomous dummy codes)
simulation_three_group &lt;- simulate_funmediation_example(nlevels=3,
                              alpha_X = list(function(t) {return(.1*t)},
                                             function(t) {return(-(t/2)^.5)}),
                              beta_X = c(-.2,.2))
print(summary(simulation_three_group));

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
