<!DOCTYPE html><html lang="en"><head><title>Help for package PUGMM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PUGMM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#penguins'><p>Penguins</p></a></li>
<li><a href='#plot.pugmm'><p>Plotting method for <code>pugmm</code> object</p></a></li>
<li><a href='#pugmm'><p>Parsimonious Ultrametric Gaussian Mixture Models</p></a></li>
<li><a href='#pugmm_available_models'><p>PUGMM Model Names</p></a></li>
<li><a href='#rand.member'><p>Random partition of objects into classes</p></a></li>
<li><a href='#UCM'><p>Ultrametric Correlation Matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Title:</td>
<td>Parsimonious Ultrametric Gaussian Mixture Models</td>
</tr>
<tr>
<td>Description:</td>
<td>Finite Gaussian mixture models with parsimonious extended ultrametric covariance structures estimated via a grouped coordinate ascent algorithm, which is equivalent to the Expectation-Maximization algorithm. The thirteen ultrametric covariance structures implemented allow for the inspection of different hierarchical relationships among variables. The estimation of an ultrametric correlation matrix is included as a function. The methodologies are described in Cavicchia, Vichi, Zaccaria (2024) &lt;<a href="https://doi.org/10.1007%2Fs11222-024-10405-9">doi:10.1007/s11222-024-10405-9</a>&gt;, Cavicchia, Vichi, Zaccaria (2022) &lt;<a href="https://doi.org/10.1007%2Fs11634-021-00488-x">doi:10.1007/s11634-021-00488-x</a>&gt; and Cavicchia, Vichi, Zaccaria (2020) &lt;<a href="https://doi.org/10.1007%2Fs11634-020-00400-z">doi:10.1007/s11634-020-00400-z</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ClusterR, doParallel, foreach, igraph, MASS, Matrix, mclust,
mcompanion, ppclust</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/giorgiazaccaria/PUGMM">https://github.com/giorgiazaccaria/PUGMM</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/giorgiazaccaria/PUGMM/issues">https://github.com/giorgiazaccaria/PUGMM/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Giorgia Zaccaria &lt;giorgia.zaccaria@unimib.it&gt;</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-08 15:10:20 UTC; GZ082042</td>
</tr>
<tr>
<td>Author:</td>
<td>Giorgia Zaccaria <a href="https://orcid.org/0000-0001-9119-9104"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Carlo Cavicchia <a href="https://orcid.org/0000-0003-1816-3521"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Lorenzo Balzotti <a href="https://orcid.org/0000-0001-6191-9801"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-10 13:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='penguins'>Penguins</h2><span id='topic+penguins'></span>

<h3>Description</h3>

<p>The data set contains five measurements made on 342 penguins which are classified into three species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(penguins)
</code></pre>


<h3>Format</h3>

<p>A data frame with 342 observations and 5 variables, which are described as follows.
</p>

<dl>
<dt>species</dt><dd><p>Penguin species (Chinstrap, Ad√©lie, or Gentoo)</p>
</dd>
<dt>culmen_length_mm</dt><dd><p>Culmen length (mm)</p>
</dd>
<dt>culmen_depth_mm</dt><dd><p>Culmen depth (mm)</p>
</dd>
<dt>flipper_length_mm</dt><dd><p>Flipper length (mm)</p>
</dd>
<dt>body_mass_g</dt><dd><p>Body mass (g)</p>
</dd>
</dl>



<h3>Details</h3>

<p>Data were collected and made available by Dr. Kristen Gorman and the Palmer Station, Antarctica LTER, a member of the Long Term Ecological Research Network.
The categorical variables 'island' and 'sex' have been removed from the original dataset, as well as the incomplete observations on the five variables reported herein.
</p>


<h3>Source</h3>

<p>Dataset downloaded from Kaggle <a href="https://www.kaggle.com/code/parulpandey/penguin-dataset-the-new-iris">https://www.kaggle.com/code/parulpandey/penguin-dataset-the-new-iris</a>.
</p>


<h3>References</h3>

<p>Gorman, K.B., Williams T.D., Fraser W.R. (2014). Ecological sexual dimorphism and environmental variability within a community of Antarctic penguins (genus Pygoscelis). <em>PLoS ONE</em>, 9(3), e90081.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(penguins)

</code></pre>

<hr>
<h2 id='plot.pugmm'>Plotting method for <code>pugmm</code> object</h2><span id='topic+plot.pugmm'></span>

<h3>Description</h3>

<p>Plots for Parsimonious Ultrametric Gaussian Mixture Models results, such as BIC and path diagrams.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pugmm'
plot(x, what = NULL, nrow = NULL, ncol = NULL, cluster_names = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.pugmm_+3A_x">x</code></td>
<td>
<p>Output from <code>pugmm</code>.</p>
</td></tr>
<tr><td><code id="plot.pugmm_+3A_what">what</code></td>
<td>
<p>A string specifying the type of graph requested. Available choices are: <br />
</p>

<dl>
<dt><code>"BIC"</code></dt><dd><p>Plot of BIC values for the fitted models. For each <code class="reqn">G</code>, the best BIC among the ones corresponding to different <code class="reqn">m</code> is displayed.</p>
</dd>
<dt><code>"Path Diagram"</code></dt><dd><p>Path diagram representation of the extended ultrametric covariance matrix per component for the best model.</p>
</dd></dl>
</td></tr>
<tr><td><code id="plot.pugmm_+3A_nrow">nrow</code></td>
<td>
<p>Number of rows in the graphical window. A new graphical window is opened every 6 plots, i.e., components of <code>pugmm</code>.</p>
</td></tr>
<tr><td><code id="plot.pugmm_+3A_ncol">ncol</code></td>
<td>
<p>Number of columns in the graphical window. A new graphical window is opened every 6 plots, i.e., components of <code>pugmm</code>.</p>
</td></tr>
<tr><td><code id="plot.pugmm_+3A_cluster_names">cluster_names</code></td>
<td>
<p>String of dimension <code class="reqn">G</code> with the clusters/components' name.</p>
</td></tr>
<tr><td><code id="plot.pugmm_+3A_...">...</code></td>
<td>
<p>Other graphics parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value since this is a plot method.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pugmm">pugmm()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(penguins)
x &lt;- scale(penguins[, 2:5])
pugmm.penguins &lt;- pugmm(x, 3, 1)
plot.pugmm(pugmm.penguins, what = c("BIC", "Path Diagram"))
</code></pre>

<hr>
<h2 id='pugmm'>Parsimonious Ultrametric Gaussian Mixture Models</h2><span id='topic+pugmm'></span>

<h3>Description</h3>

<p>Model-based clustering via Parsimonious Ultrametric Gaussian Mixture Models. Hierarchical relationships among variables within and between clusters are inspected. The grouped coordinate ascent algorithm is used for the parameter estimation. The optimal model is selected according to BIC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pugmm(
  X,
  G = NULL,
  m = NULL,
  normalization = NULL,
  model = NULL,
  maxiter = 500,
  tol = 1e-06,
  stop = "aitken",
  rndstart = 1,
  initG = "kmeans",
  initm = "ucms",
  gaussian = "mclust",
  parallel = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pugmm_+3A_x">X</code></td>
<td>
<p>(<code class="reqn">n \times p</code>) numeric matrix or data frame, where <code class="reqn">n</code> and <code class="reqn">p</code> represent the number of units and variables, respectively. Categorical variables are not allowed.</p>
</td></tr>
<tr><td><code id="pugmm_+3A_g">G</code></td>
<td>
<p>Integer (vector) specifying the number of mixture components (default: <code>G = 1:5</code>).</p>
</td></tr>
<tr><td><code id="pugmm_+3A_m">m</code></td>
<td>
<p>Integer (vector) specifying the number of variable groups (default: <code>m = 1:5</code>).</p>
</td></tr>
<tr><td><code id="pugmm_+3A_normalization">normalization</code></td>
<td>
<p>Character string specifying the data transformation. If <code>NULL</code>, no transformation is applied to the data matrix (default). Other options are: &quot;standard&quot; for the standardization; &quot;center&quot; for centering the data; &quot;range&quot; for the MinMax transformation; &quot;SVD&quot; for the Singular Value Decomposition transformation.</p>
</td></tr>
<tr><td><code id="pugmm_+3A_model">model</code></td>
<td>
<p>Vector of character strings indicating the model names to be fitted. If <code>NULL</code>, all the possible models are fitted (default). See the possible models using <code>available_models()</code>.</p>
</td></tr>
<tr><td><code id="pugmm_+3A_maxiter">maxiter</code></td>
<td>
<p>Integer value specifying the maximum number of iterations of the algorithm (default: <code>maxiter = 500</code>).</p>
</td></tr>
<tr><td><code id="pugmm_+3A_tol">tol</code></td>
<td>
<p>Numeric value specifying the tolerance for the convergence criterion (default: <code>tol = 1e-6</code>).</p>
</td></tr>
<tr><td><code id="pugmm_+3A_stop">stop</code></td>
<td>
<p>Character string specifying the convergence criteria. If &quot;aitken&quot;, the Aitken acceleration-based stopping rule is used (default); if &quot;relative&quot;, the relative log-likelihood in two sequential iterations is evaluated.</p>
</td></tr>
<tr><td><code id="pugmm_+3A_rndstart">rndstart</code></td>
<td>
<p>Integer value specifying the number of random starts (default: <code>rndstart = 1</code>).</p>
</td></tr>
<tr><td><code id="pugmm_+3A_initg">initG</code></td>
<td>
<p>Character string specifying the method for the initialization of the unit-component membership. If &quot;kmeans&quot;, k-means via RcppArmadillo is used (default). Other options are: &quot;random&quot; for random assignment; &quot;kmeansf&quot; for fuzzy c-means (via the function fcm of the package ppclust).</p>
</td></tr>
<tr><td><code id="pugmm_+3A_initm">initm</code></td>
<td>
<p>Character string specifying the method for the initialization of the variable-group membership. If &quot;ucms&quot;, the multivariate model to be used for obtaining the variable-group membership estimated is the same model.name used for estimating the Parsimonious Ultrametric Gaussian Mixture Model (default); if &quot;random&quot;, a random assignment is performed.</p>
</td></tr>
<tr><td><code id="pugmm_+3A_gaussian">gaussian</code></td>
<td>
<p>Character string specifying the way to compute the log-likelihood. If &quot;mclust&quot;, <code>dmvnorm</code> of <code>mclust</code> is used (default); if &quot;canonical&quot;, the log-likelihood computation is based upon the canonical representation of an extended ultrametric covariance matrix.</p>
</td></tr>
<tr><td><code id="pugmm_+3A_parallel">parallel</code></td>
<td>
<p>A logical value, specifying whether the models should be run in parallel.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The grouped coordinate ascent algorithm used for the estimation of PUGMMs parameters was demonstrated to be equivalent to an Expectation-Maximization algorithm in the GMM framework (Hathaway, 1986).
</p>


<h3>Value</h3>

<p>An object of class <code>pugmm</code> containing the results of the optimal - according to BIC - Parsimonious Ultrametric Gaussian Mixture Model estimation. <br />
</p>
<p><code>call</code> Matched call.
</p>
<p><code>X</code> Input data matrix.
</p>
<p><code>G</code> Number of components of the best model.
</p>
<p><code>m</code> Number of variable groups of the best model.
</p>
<p><code>label</code> Integer vector of dimension <code class="reqn">n</code>, taking values in <code class="reqn">\{1, \ldots, G\}</code>. It identifies the unit classification according to the maximum a posteriori of the best model.
</p>
<p><code>pp</code> Numeric vector of dimension <code class="reqn">G</code> containing the prior probabilities for the best model.
</p>
<p><code>mu</code> (<code class="reqn">G \times p</code>) numeric matrix containing the component mean vectors (by row) for the best model.
</p>
<p><code>sigma</code> List of dimension <code class="reqn">G</code> containing the (<code class="reqn">p \times p</code>) numeric component extended ultrametric covariance matrices for the best model.
</p>
<p><code>V</code> List of dimension <code class="reqn">G</code> containing the (<code class="reqn">p \times m</code>) binary variable-group membership matrices for the best model.
</p>
<p><code>Sv</code> List of dimension <code class="reqn">G</code> containing the (<code class="reqn">m \times m</code>) numeric diagonal matrices of the group variances for the best model.
</p>
<p><code>Sw</code> List of dimension <code class="reqn">G</code> containing the (<code class="reqn">m \times m</code>) numeric diagonal matrices of the within-group covariances for the best model.
</p>
<p><code>Sb</code> List of dimension <code class="reqn">G</code> containing the (<code class="reqn">m \times m</code>) numeric hallow matrices of the between-group covariances for the best model.
</p>
<p><code>post</code> (<code class="reqn">n \times G</code>) numeric matrix containing the posterior probabilities for the best model.
</p>
<p><code>pm</code> Number of parameters of the best model.
</p>
<p><code>pm.cov</code> Number of covariance parameters of the best model.
</p>
<p><code>pm.free</code> Number of free parameters of the best model (<code>pm</code> - (constraints on <code class="reqn">V</code> + <code>count.constr.SwSb</code> + <code>count.constr.SvSw</code>)).
</p>
<p><code>count.constr.SwSb</code> Number of times the constraint between <code>Sw</code> and <code>Sb</code> has been turned on for the best model.
</p>
<p><code>count.constr.SvSw</code> Number of times the constraint between <code>Sv</code> and <code>Sw</code> has been turned on for the best model.
</p>
<p><code>BIC</code> BIC values for all the fitted models. If BIC is <code class="reqn">NA</code>, the model has not been computed since its structure is equal to another model, while if BIC is <code class="reqn">-Inf</code> the solution has a number of clusters <code class="reqn">&lt; G</code>.
</p>
<p><code>bic</code> BIC value of the best model.
</p>
<p><code>loglik</code> Log-likelihood of the best model.
</p>
<p><code>loop</code> Random start corresponding to the selected solution of the best model.
</p>
<p><code>iter</code> Number of iterations needed to estimate the best model.
</p>
<p><code>model.name</code> Character string denoting the PUGMM model name of the best model among the ones fitted.
</p>
<p><code>messages</code> Messages.
</p>


<h3>References</h3>

<p>Cavicchia, C., Vichi, M., Zaccaria, G. (2024) Parsimonious ultrametric Gaussian mixture models. <em>Statistics and Computing</em>, 34, 108.
</p>
<p>Cavicchia, C., Vichi, M., Zaccaria, G. (2022) Gaussian mixture model with an extended ultrametric covariance structure. <em>Advances in Data Analysis and Classification</em>, 16(2), 399-427.
</p>
<p>Hathaway, R. (1986) Another interpretation of the EM algorithm for mixture distributions. <em>Statistics and Probability Letters</em>, 4(2), 53-56.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pugmm_available_models">pugmm_available_models()</a></code>, <code><a href="#topic+plot.pugmm">plot.pugmm()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(penguins)
x &lt;- scale(penguins[, 2:5])
pugmm.penguins &lt;- pugmm(x, 3, 1)
table(penguins$species, pugmm.penguins$label)

pugmm.penguins &lt;- pugmm(x)
pugmm.penguins$G
pugmm.penguins$m
pugmm.penguins$model.name
</code></pre>

<hr>
<h2 id='pugmm_available_models'>PUGMM Model Names</h2><span id='topic+pugmm_available_models'></span>

<h3>Description</h3>

<p>Description  of the model names used in the <em>PUGMM</em> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pugmm_available_models()
</code></pre>


<h3>Details</h3>

<p>The PUGMM model names in the <em>PUGMM</em> package are characterized by four letters:
</p>

<ul>
<li><p> First letter: it refers to the variable-group membership matrix <code class="reqn">V</code>, which can be equal (E) or free to vary (F) across components.
</p>
</li>
<li><p> Second, third, fourth letters: they refer to the matrices of the group variances <code class="reqn">\Sigma_{V}</code>, the within-group covariances <code class="reqn">\Sigma_{W}</code> and the between-group covariances <code class="reqn">\Sigma_{B}</code>, respectively, by indicating if they are unique (U, i.e., equal within and across components), isotropic (I, i.e., equal within components), equal (E, i.e., equal across components) or free to vary across components (F).
</p>
</li></ul>



<h3>Value</h3>

<p>Available models in PUGMM, i.e., the thirteen extended ultrametric covariance structures of PUGMM.
</p>


<h3>References</h3>

<p>Cavicchia, C., Vichi, M., Zaccaria, G. (2024) Parsimonious ultrametric Gaussian mixture models. <em>Statistics and Computing</em>, 34, 108.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pugmm">pugmm()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pugmm_available_models()

</code></pre>

<hr>
<h2 id='rand.member'>Random partition of objects into classes</h2><span id='topic+rand.member'></span>

<h3>Description</h3>

<p>Performs a random partition of objects into classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rand.member(n.obs, G)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rand.member_+3A_n.obs">n.obs</code></td>
<td>
<p>Number of objects</p>
</td></tr>
<tr><td><code id="rand.member_+3A_g">G</code></td>
<td>
<p>Number of classes</p>
</td></tr>
</table>


<h3>Details</h3>

<p>No empty classes can occur.
</p>


<h3>Value</h3>

<p>A binary and row-stochastic matrix with <code class="reqn">n.obs</code> rows and <code class="reqn">G</code> columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rand.member(10, 3)
</code></pre>

<hr>
<h2 id='UCM'>Ultrametric Correlation Matrix</h2><span id='topic+UCM'></span>

<h3>Description</h3>

<p>Fit an ultrametric correlation matrix on a nonnegative correlation one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UCM(R, m, rndstart, maxiter = 100, eps = 1e-06)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="UCM_+3A_r">R</code></td>
<td>
<p>(<code class="reqn">p \times p</code>) nonnegative correlation matrix.</p>
</td></tr>
<tr><td><code id="UCM_+3A_m">m</code></td>
<td>
<p>Integer specifying the number of variable groups.</p>
</td></tr>
<tr><td><code id="UCM_+3A_rndstart">rndstart</code></td>
<td>
<p>Integer value specifying the number of random starts.</p>
</td></tr>
<tr><td><code id="UCM_+3A_maxiter">maxiter</code></td>
<td>
<p>Integer value specifying the maximum number of iterations of the EM algorithm (default: maxiter = 100).</p>
</td></tr>
<tr><td><code id="UCM_+3A_eps">eps</code></td>
<td>
<p>Numeric value specifying the tolerance for the convergence criterion used in the coordinate descent algorithm (default: eps = 1e-6).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements: <br />
</p>
<p><code>call</code> Matched call.
</p>
<p><code>V</code> Optimal binary and row-stochastic (<code class="reqn">p \times m</code>) variable-group membership matrix.
</p>
<p><code>Rt</code> Optimal (<code class="reqn">p \times p</code>) ultrametric correlation matrix.
</p>
<p><code>Rw</code> Optimal (<code class="reqn">m \times m</code>) within-concept consistency (diagonal) matrix.
</p>
<p><code>Rb</code> Optimal (<code class="reqn">m \times m</code>) between-concept correlation matrix.
</p>
<p><code>of</code> Objective function corresponding to the optimal solution.
</p>
<p><code>loop</code> Random start corresponding to the optimal solution.
</p>
<p><code>iter</code> Number of iterations needed to obtain the optimal solution.
</p>


<h3>References</h3>

<p>Cavicchia, C., Vichi, M., Zaccaria, G. (2020) The ultrametric correlation matrix for modelling hierarchical latent concepts. <em>Advances in Data Analysis and Classification</em>, 14(4), 837-853.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(penguins)
R &lt;- cor(penguins[, 2:5])
UCM(R, 4, 1)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
