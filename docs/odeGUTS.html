<!DOCTYPE html><html><head><title>Help for package odeGUTS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {odeGUTS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#fit_odeGUTS'><p>Model calibration results for a GUTS-SD theoretical species exposed to a compound.</p></a></li>
<li><a href='#odeGUTS-package'><p>odeGUTS: Solve ODE for GUTS-RED-SD and GUTS-RED-IT Using Compiled Code</p></a></li>
<li><a href='#predict_Nsurv_check'><p>Checking goodness-of-fit method for <code>survFitPredict</code> and</p>
<code>survFitPredict_Nsurv</code> objects</a></li>
<li><a href='#predict_ode'><p>Predict method for <code>survFit</code> objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Solve ODE for GUTS-RED-SD and GUTS-RED-IT Using Compiled Code</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Allows performing forwards prediction for the General Unified 
          Threshold model of Survival using compiled ode code. This package 
          was created to avoid dependency with the 'morse' package that requires 
          the installation of 'JAGS'. This package is based on functions from 
          the 'morse' package v3.3.1: Virgile Baudrot, Sandrine Charles, 
          Marie Laure Delignette-Muller, Wandrille Duchemin, Benoit Goussen, 
          Nils Kehrein, Guillaume Kon-Kam-King, Christelle Lopes, Philippe Ruiz, 
          Alexander Singer and Philippe Veber (2021) <a href="https://CRAN.R-project.org/package=morse">https://CRAN.R-project.org/package=morse</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/bgoussen/odeGUTS">https://github.com/bgoussen/odeGUTS</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/bgoussen/odeGUTS/issues">https://github.com/bgoussen/odeGUTS/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>deSolve, magrittr, stats, dplyr, zoo, tidyr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Suggests:</td>
<td>morse</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-30 20:54:31 UTC; gob</td>
</tr>
<tr>
<td>Author:</td>
<td>Benoit Goussen <a href="https://orcid.org/0000-0001-7204-7981"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Benoit Goussen &lt;benoit.goussen@ibacon.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-30 21:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='fit_odeGUTS'>Model calibration results for a GUTS-SD theoretical species exposed to a compound.</h2><span id='topic+fit_odeGUTS'></span>

<h3>Description</h3>

<p>Model calibration results for a GUTS-SD theoretical species exposed to a compound.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fit_odeGUTS)
</code></pre>


<h3>Format</h3>

<p>A list of class <code>survFit</code> constructed
</p>

<dl>
<dt><code>mcmc</code></dt><dd><p>A list of mcmc chain results</p>
</dd>
<dt><code>model_type</code></dt><dd><p>A character string containing the type of GUTS model used (here 'SD').</p>
</dd>
</dl>


<hr>
<h2 id='odeGUTS-package'>odeGUTS: Solve ODE for GUTS-RED-SD and GUTS-RED-IT Using Compiled Code</h2><span id='topic+odeGUTS'></span><span id='topic+odeGUTS-package'></span>

<h3>Description</h3>

<p>Allows performing forwards prediction for the General Unified 
Threshold model of Survival using compiled ode code. This package 
was created to avoid dependency with the 'morse' package that requires 
the installation of 'JAGS'. This package is based on functions from 
the 'morse' package v3.3.1: Virgile Baudrot, Sandrine Charles, 
Marie Laure Delignette-Muller, Wandrille Duchemin, Benoit Goussen, 
Nils Kehrein, Guillaume Kon-Kam-King, Christelle Lopes, Philippe Ruiz, 
Alexander Singer and Philippe Veber (2021) &lt;https://CRAN.R-project.org/package=morse&gt;.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Benoit Goussen <a href="mailto:benoit.goussen@ibacon.com">benoit.goussen@ibacon.com</a> (<a href="https://orcid.org/0000-0001-7204-7981">ORCID</a>)
</p>


<h3>References</h3>

<p>Virgile Baudrot, Sandrine Charles, Marie Laure Delignette-Muller, Wandrille
Duchemin, Benoit Goussen, Nils Kehrein, Guillaume, Kon-Kam-King,
Christelle Lopes, Philippe Ruiz, Alexander Singer and Philippe Veber (2021).
morse: Modelling Tools for Reproduction and Survival Data in Ecotoxicology.
R package version 3.3.1. https://CRAN.R-project.org/package=morse
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/bgoussen/odeGUTS">https://github.com/bgoussen/odeGUTS</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/bgoussen/odeGUTS/issues">https://github.com/bgoussen/odeGUTS/issues</a>
</p>
</li></ul>


<hr>
<h2 id='predict_Nsurv_check'>Checking goodness-of-fit method for <code>survFitPredict</code> and
<code>survFitPredict_Nsurv</code> objects</h2><span id='topic+predict_Nsurv_check'></span><span id='topic+predict_Nsurv_check.survFitPredict_Nsurv'></span>

<h3>Description</h3>

<p>Function from the <code>morse v 3.3.1</code> package.
It returns measures of goodness-of-fit for predictions.
</p>
<p>Function from the <code>morse v 3.3.1</code> package.
Provide various criteria for assessment of the model performance:
(i) percentage of observation within the 95\
interval of the Posterior Prediction Check (PPC), the Normalised Root Mean
Square Error (NRMSE) and the Survival Probability Prediction Error (SPPE) as
recommended by the recent Scientific Opinion from EFSA (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_Nsurv_check(object, ...)

## S3 method for class 'survFitPredict_Nsurv'
predict_Nsurv_check(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_Nsurv_check_+3A_object">object</code></td>
<td>
<p>an object of class <code>survFitPredict_Nsurv</code></p>
</td></tr>
<tr><td><code id="predict_Nsurv_check_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function return a list with three items:
</p>
<table>
<tr><td><code>PPC</code></td>
<td>
<p>The criterion, in percent, compares the predicted median numbers
of survivors associated to their uncertainty limits with the observed numbers
of survivors. Based on experience, PPC resulting in less than <code class="reqn">50\%</code> of the
observations within the uncertainty limits indicate poor model performance. A fit of
<code class="reqn">100\%</code> may hide too large uncertainties of prediction (so covering all data).</p>
</td></tr>
<tr><td><code>PPC_global</code></td>
<td>
<p>percentage of PPC for the whole data set by gathering replicates.</p>
</td></tr>
<tr><td><code>NRMSE</code></td>
<td>
<p>The criterion, in percent, is based on the classical root-mean-square error (RMSE),
used to aggregate the magnitudes of the errors in predictions for various time-points
into a single measure of predictive power. In order to provide a criterion expressed
as a percentage, NRMSE is the normalised RMSE by the mean of the observations.</p>
</td></tr>
<tr><td><code>NRMSE_global</code></td>
<td>
<p>NRMSE for the whole data set by gathering replicates.</p>
</td></tr>
<tr><td><code>SPPE</code></td>
<td>
<p>The SPPE indicator, in percent, is negative (between <code class="reqn">0</code> and <code class="reqn">-100\%</code>) for an
underestimation of effects, and positive (between <code class="reqn">0</code> and <code class="reqn">100</code>) for an
overestimation of effects. An SPPE value of <code class="reqn">0</code> means an exact prediction
of the observed survival probability at the end of the exposure profile.</p>
</td></tr>
</table>
<p>@references
EFSA PPR Scientific Opinion (2018)
<em>Scientific Opinion on the state of the art of Toxicokinetic/Toxicodynamic (TKTD) effect models for regulatory risk assessment of pesticides for aquatic organisms</em>
<a href="https://www.efsa.europa.eu/en/efsajournal/pub/5377">https://www.efsa.europa.eu/en/efsajournal/pub/5377</a>
</p>

<hr>
<h2 id='predict_ode'>Predict method for <code>survFit</code> objects</h2><span id='topic+predict_ode'></span><span id='topic+predict_ode.survFit'></span><span id='topic+predict_Nsurv_ode'></span><span id='topic+predict_Nsurv_ode.survFit'></span>

<h3>Description</h3>

<p>Function from the <code>morse v 3.3.1</code> package.
This is a <code>method</code> to replace function <code>predict</code> used on <code>survFit</code>
object when computing issues happen. <code>predict_ode</code> uses the <code>deSolve</code>
library to improve robustness. However, time to compute may be longer.
</p>
<p>Function from the <code>morse v 3.3.1</code> package.
This is the generic <code>predict</code> S3 method for the <code>survFit</code> class.
It provides predicted survival rate for &quot;SD&quot; or &quot;IT&quot; models under constant or time-variable exposure.
</p>
<p>Function from the <code>morse v 3.3.1</code> package.
This is a <code>method</code> to replace function <code>predict_Nsurv</code> used on <code>survFit</code>
object when computing issues happen. <code>predict_nsurv_ode</code> uses the <code>deSolve</code>
library to improve robustness. However, time to compute may be longer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_ode(object, ...)

## S3 method for class 'survFit'
predict_ode(
  object,
  data_predict = NULL,
  spaghetti = FALSE,
  mcmc_size = 1000,
  hb_value = FALSE,
  interpolate_length = 100,
  interpolate_method = "linear",
  hb_valueFORCED = 0,
  ...
)

predict_Nsurv_ode(
  object,
  data_predict,
  spaghetti,
  mcmc_size,
  hb_value,
  hb_valueFORCED,
  extend_time,
  interpolate_length,
  interpolate_method,
  ...
)

## S3 method for class 'survFit'
predict_Nsurv_ode(
  object,
  data_predict = NULL,
  spaghetti = FALSE,
  mcmc_size = 1000,
  hb_value = FALSE,
  hb_valueFORCED = 0,
  extend_time = 100,
  interpolate_length = NULL,
  interpolate_method = "linear",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_ode_+3A_object">object</code></td>
<td>
<p>An object of class <code>survFit</code>.</p>
</td></tr>
<tr><td><code id="predict_ode_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
<tr><td><code id="predict_ode_+3A_data_predict">data_predict</code></td>
<td>
<p>A dataframe with three columns <code>time</code>, <code>conc</code> and <code>replicate</code>
used for prediction. If <code>NULL</code>, prediction is based on <code>x</code> object of
class <code>survFit</code> used for fitting.</p>
</td></tr>
<tr><td><code id="predict_ode_+3A_spaghetti">spaghetti</code></td>
<td>
<p>If <code>TRUE</code>, return a set of survival curves using
parameters drawn from the posterior distribution.</p>
</td></tr>
<tr><td><code id="predict_ode_+3A_mcmc_size">mcmc_size</code></td>
<td>
<p>Can be used to reduce the number of mcmc samples in order to speed up
the computation. <code>mcmc_size</code> is the number of selected iterations for one chain. Default
is 1000. If all MCMC is wanted, set argument to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="predict_ode_+3A_hb_value">hb_value</code></td>
<td>
<p>If <code>TRUE</code>, the background mortality <code>hb</code> is taken into account from the posterior.
If <code>FALSE</code>, parameter <code>hb</code> is set to 0. The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="predict_ode_+3A_interpolate_length">interpolate_length</code></td>
<td>
<p>Length of the time sequence for which output is wanted.</p>
</td></tr>
<tr><td><code id="predict_ode_+3A_interpolate_method">interpolate_method</code></td>
<td>
<p>The interpolation method for concentration. See package <code>deSolve</code> for details.
Default is <code>linear</code>.</p>
</td></tr>
<tr><td><code id="predict_ode_+3A_hb_valueforced">hb_valueFORCED</code></td>
<td>
<p>If <code>hb_value</code> is <code>FALSE</code>, it fix <code>hb</code>. Default is <code>0</code></p>
</td></tr>
<tr><td><code id="predict_ode_+3A_extend_time">extend_time</code></td>
<td>
<p>Length of time points interpolated with variable exposure profiles.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns an object of class <code>survFitPredict</code> or
<code>survFitPredict_Nsurv</code> with two items:
</p>
<table>
<tr><td><code>df_quantile</code></td>
<td>
<p>Predicted quantiles (q50, qinf95, and qsup95)</p>
</td></tr>
<tr><td><code>df_spaghetti</code></td>
<td>
<p>Predicted survival curve (if spaghetti = <code>TRUE</code>)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library("odeGUTS")
data(fit_odeGUTS)

data_4prediction &lt;- data.frame(time = 1:10,
                               conc = c(0,5,30,30,0,0,5,30,15,0),
                               replicate= rep("predict", 10))

predict_out &lt;- predict_ode(object = fit_odeGUTS, data_predict = data_4prediction,
                           mcmc_size = 200, spaghetti = FALSE)



</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
