<!DOCTYPE html><html><head><title>Help for package NACHO</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NACHO}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#autoplot'><p>autoplot generic</p></a></li>
<li><a href='#autoplot.nacho'><p>Plot quality-control metrics and thresholds of a &quot;nacho&quot; object</p></a></li>
<li><a href='#check_outliers'><p>Annotate a &quot;nacho&quot; object for outliers</p></a></li>
<li><a href='#deploy'><p>Deploy (copy) the shiny application to the specified directory</p></a></li>
<li><a href='#GSE74821'><p>A &quot;nacho&quot; object containing 20 samples of GSE74821 dataset</p></a></li>
<li><a href='#load_rcc'><p>Produce a &quot;nacho&quot; object from RCC NanoString files</p></a></li>
<li><a href='#NACHO-package'><p>NACHO: NanoString Quality Control Dashboard</p></a></li>
<li><a href='#normalise'><p>(re)Normalise a &quot;nacho&quot; object</p></a></li>
<li><a href='#print.nacho'><p>Print method for &quot;nacho&quot; object</p></a></li>
<li><a href='#render'><p>Render a HTML report of a &quot;nacho&quot; object</p></a></li>
<li><a href='#visualise'><p>Visualise quality-control metrics of a &quot;nacho&quot; object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>NanoString Quality Control Dashboard</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.6</td>
</tr>
<tr>
<td>Description:</td>
<td>NanoString nCounter data are gene expression assays
    where there is no need for the use of enzymes or amplification
    protocols and work with fluorescent barcodes (Geiss et al. (2018)
    &lt;<a href="https://doi.org/10.1038%2Fnbt1385">doi:10.1038/nbt1385</a>&gt;). Each barcode is assigned a
    messenger-RNA/micro-RNA (mRNA/miRNA) which after bonding with its
    target can be counted. As a result each count of a specific barcode
    represents the presence of its target mRNA/miRNA. 'NACHO' (NAnoString
    quality Control dasHbOard) is able to analyse the exported NanoString
    nCounter data and facilitates the user in performing a quality
    control. 'NACHO' does this by visualising quality control metrics,
    expression of control genes, principal components and sample specific
    size factors in an interactive web application.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mcanouil/NACHO/">https://github.com/mcanouil/NACHO/</a>, <a href="https://m.canouil.dev/NACHO/">https://m.canouil.dev/NACHO/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mcanouil/NACHO/issues">https://github.com/mcanouil/NACHO/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, data.table, ggplot2 (&ge; 3.3.0), ggforce (&ge; 0.3.1),
ggrepel (&ge; 0.8.1), knitr (&ge; 1.25), rmarkdown (&ge; 1.16), shiny
(&ge; 1.4.0), shinyWidgets (&ge; 0.4.9)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>roxygen2 (&ge; 7.2.0), testthat (&ge; 2.2.1), covr (&ge; 3.3.2),
Biobase, GEOquery, limma</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.0</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>pandoc (&gt;= 1.14), pandoc-citeproc</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-12 18:55:29 UTC; mcanouil</td>
</tr>
<tr>
<td>Author:</td>
<td>Mickaël Canouil <a href="https://orcid.org/0000-0002-3396-4549"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Roderick Slieker <a href="https://orcid.org/0000-0003-0961-9152"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Gerard Bouland [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mickaël Canouil &lt;pro@mickael.canouil.dev&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-12 19:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='autoplot'>autoplot generic</h2><span id='topic+autoplot'></span>

<h3>Description</h3>

<p>See <code>ggplot2::<a href="ggplot2.html#topic+autoplot">autoplot</a></code> for details.
</p>

<hr>
<h2 id='autoplot.nacho'>Plot quality-control metrics and thresholds of a &quot;nacho&quot; object</h2><span id='topic+autoplot.nacho'></span>

<h3>Description</h3>

<p>This function allows to plot any qualit-control figures available
within the shiny app using <code><a href="#topic+visualise">visualise()</a></code> or in the HTML report from <code><a href="#topic+render">render()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nacho'
autoplot(
  object,
  x,
  colour = "CartridgeID",
  size = 0.5,
  show_legend = TRUE,
  show_outliers = TRUE,
  outliers_factor = 1,
  outliers_labels = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.nacho_+3A_object">object</code></td>
<td>
<p>[<a href="base.html#topic+list">list</a>] List obtained from <code><a href="#topic+load_rcc">load_rcc()</a></code> or <code><a href="#topic+normalise">normalise()</a></code>.</p>
</td></tr>
<tr><td><code id="autoplot.nacho_+3A_x">x</code></td>
<td>
<p>[<a href="base.html#topic+character">character</a>] Character string naming the quality-control metrics to plot from <code>nacho_object</code>.
The possible values are:
</p>

<ul>
<li> <p><code>"BD"</code> (Binding Density)
</p>
</li>
<li> <p><code>"FoV"</code> (Imaging)
</p>
</li>
<li> <p><code>"PCL"</code> (Positive Control Linearity)
</p>
</li>
<li> <p><code>"LoD"</code> (Limit of Detection)
</p>
</li>
<li> <p><code>"Positive"</code> (Positive Controls)
</p>
</li>
<li> <p><code>"Negative"</code> (Negative Controls)
</p>
</li>
<li> <p><code>"Housekeeping"</code> (Housekeeping Genes)
</p>
</li>
<li> <p><code>"PN"</code> (Positive Controls vs. Negative Controls)
</p>
</li>
<li> <p><code>"ACBD"</code> (Average Counts vs. Binding Density)
</p>
</li>
<li> <p><code>"ACMC"</code> (Average Counts vs. Median Counts)
</p>
</li>
<li> <p><code>"PCA12"</code> (Principal Component 1 vs. 2)
</p>
</li>
<li> <p><code>"PCAi"</code> (Principal Component scree plot)
</p>
</li>
<li> <p><code>"PCA"</code> (Principal Components planes)
</p>
</li>
<li> <p><code>"PFNF"</code> (Positive Factor vs. Negative Factor)
</p>
</li>
<li> <p><code>"HF"</code> (Housekeeping Factor)
</p>
</li>
<li> <p><code>"NORM"</code> (Normalisation Factor)
</p>
</li></ul>
</td></tr>
<tr><td><code id="autoplot.nacho_+3A_colour">colour</code></td>
<td>
<p>[<a href="base.html#topic+character">character</a>] Character string of the column in <code>ssheet_csv</code>
or more generally in <code>nacho_object$nacho</code> to be used as grouping colour.</p>
</td></tr>
<tr><td><code id="autoplot.nacho_+3A_size">size</code></td>
<td>
<p>[<a href="base.html#topic+numeric">numeric</a>] A numeric controlling point size
(<code><a href="ggplot2.html#topic+geom_point">ggplot2::geom_point()</a></code>
or line size (<code><a href="ggplot2.html#topic+geom_path">ggplot2::geom_line()</a></code>).</p>
</td></tr>
<tr><td><code id="autoplot.nacho_+3A_show_legend">show_legend</code></td>
<td>
<p>[<a href="base.html#topic+logical">logical</a>] Boolean to indicate whether the plot legends should
be plotted (<code>TRUE</code>) or not (<code>FALSE</code>). Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="autoplot.nacho_+3A_show_outliers">show_outliers</code></td>
<td>
<p>[<a href="base.html#topic+logical">logical</a>] Boolean to indicate whether the outliers should be highlighted
in red (<code>TRUE</code>) or not (<code>FALSE</code>). Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="autoplot.nacho_+3A_outliers_factor">outliers_factor</code></td>
<td>
<p>[<a href="base.html#topic+numeric">numeric</a>] Size factor for outliers compared to <code>size</code>. Default is <code>1</code>.</p>
</td></tr>
<tr><td><code id="autoplot.nacho_+3A_outliers_labels">outliers_labels</code></td>
<td>
<p>[<a href="base.html#topic+character">character</a>] Character to indicate which column in <code>nacho_object$nacho</code>
should be used to be printed as the labels for outliers or not. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="autoplot.nacho_+3A_...">...</code></td>
<td>
<p>Other arguments (Not used).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
data(GSE74821)

autoplot(GSE74821, x = "BD")

</code></pre>

<hr>
<h2 id='check_outliers'>Annotate a &quot;nacho&quot; object for outliers</h2><span id='topic+check_outliers'></span>

<h3>Description</h3>

<p>Add or update <code>"is_outlier"</code> column in the <code>"nacho"</code> field of an object from
a call to <code><a href="#topic+load_rcc">load_rcc()</a></code> or <code><a href="#topic+normalise">normalise()</a></code> (<code>nacho_object$nacho</code>),
using the current quality-control thresholds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_outliers(nacho_object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_outliers_+3A_nacho_object">nacho_object</code></td>
<td>
<p>[<a href="base.html#topic+list">list</a>] A list object of class <code>"nacho"</code> obtained
from <code><a href="#topic+load_rcc">load_rcc()</a></code> or <code><a href="#topic+normalise">normalise()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A [<a href="base.html#topic+list">list</a>] object of class <code>"nacho"</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(GSE74821)
nacho_object &lt;- check_outliers(GSE74821)
head(nacho_object$nacho)

</code></pre>

<hr>
<h2 id='deploy'>Deploy (copy) the shiny application to the specified directory</h2><span id='topic+deploy'></span>

<h3>Description</h3>

<p>Deploy (copy) the shiny application to the specified directory
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deploy(directory = "/srv/shiny-server", app_name = "NACHO")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deploy_+3A_directory">directory</code></td>
<td>
<p>[<a href="base.html#topic+character">character</a>] A character vector of one path to the new location.</p>
</td></tr>
<tr><td><code id="deploy_+3A_app_name">app_name</code></td>
<td>
<p>[<a href="base.html#topic+character">character</a>] A character vector defining the shiny application name in the new location.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>[<a href="base.html#topic+logical">logical</a>] A logical indicating whether the deployment is successfull (<code>TRUE</code>) or not (<code>FALSE</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
deploy(directory = ".")

if (interactive()) {
  shiny::runApp("NACHO")
}

</code></pre>

<hr>
<h2 id='GSE74821'>A &quot;nacho&quot; object containing 20 samples of GSE74821 dataset</h2><span id='topic+GSE74821'></span>

<h3>Description</h3>

<p>NanoString nCounter RUO-PAM50 Gene Expression Custom CodeSet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GSE74821
</code></pre>


<h3>Format</h3>

<p>A [<a href="base.html#topic+list">list</a>] object of class <code>"nacho"</code>.
</p>


<h3>Source</h3>

<p><a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE74821">GSE74821</a>
</p>

<hr>
<h2 id='load_rcc'>Produce a &quot;nacho&quot; object from RCC NanoString files</h2><span id='topic+load_rcc'></span>

<h3>Description</h3>

<p>This function is used to preprocess the data from NanoString nCounter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_rcc(
  data_directory,
  ssheet_csv,
  id_colname = NULL,
  housekeeping_genes = NULL,
  housekeeping_predict = FALSE,
  housekeeping_norm = TRUE,
  normalisation_method = "GEO",
  n_comp = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_rcc_+3A_data_directory">data_directory</code></td>
<td>
<p>[<a href="base.html#topic+character">character</a>] A character string of the directory where the data are stored.</p>
</td></tr>
<tr><td><code id="load_rcc_+3A_ssheet_csv">ssheet_csv</code></td>
<td>
<p>[<a href="base.html#topic+character">character</a>] or [<a href="base.html#topic+data.frame">data.frame</a>] Either a string with the name of the CSV
of the samplesheet or the samplesheet as a <code>data.frame</code>.
Should contain a column that matches the file names in the folder.</p>
</td></tr>
<tr><td><code id="load_rcc_+3A_id_colname">id_colname</code></td>
<td>
<p>[<a href="base.html#topic+character">character</a>] Character string of the column in <code>ssheet_csv</code> that matches
the file names in <code>data_directory</code>.</p>
</td></tr>
<tr><td><code id="load_rcc_+3A_housekeeping_genes">housekeeping_genes</code></td>
<td>
<p>[<a href="base.html#topic+character">character</a>] A vector of names of the miRNAs/mRNAs
that should be used as housekeeping genes. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="load_rcc_+3A_housekeeping_predict">housekeeping_predict</code></td>
<td>
<p>[<a href="base.html#topic+logical">logical</a>] Boolean to indicate whether the housekeeping genes
should be predicted (<code>TRUE</code>) or not (<code>FALSE</code>). Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="load_rcc_+3A_housekeeping_norm">housekeeping_norm</code></td>
<td>
<p>[<a href="base.html#topic+logical">logical</a>] Boolean to indicate whether the housekeeping normalisation
should be performed. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="load_rcc_+3A_normalisation_method">normalisation_method</code></td>
<td>
<p>[<a href="base.html#topic+character">character</a>] Either <code>"GEO"</code> or <code>"GLM"</code>.
Character string to indicate normalisation using the geometric mean (<code>"GEO"</code>)
or a generalized linear model (<code>"GLM"</code>). Default is <code>"GEO"</code>.</p>
</td></tr>
<tr><td><code id="load_rcc_+3A_n_comp">n_comp</code></td>
<td>
<p>[<a href="base.html#topic+numeric">numeric</a>] Number indicating the number of principal components to compute.
Cannot be more than n-1 samples. Default is <code>10</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>[<a href="base.html#topic+list">list</a>] A list object of class <code>"nacho"</code>:
</p>

<dl>
<dt><code>access</code></dt><dd><p>[<a href="base.html#topic+character">character</a>] Value passed to <code><a href="#topic+load_rcc">load_rcc()</a></code> in <code>id_colname</code>.</p>
</dd>
<dt><code>housekeeping_genes</code></dt><dd><p>[<a href="base.html#topic+character">character</a>] Value passed to <code><a href="#topic+load_rcc">load_rcc()</a></code>.</p>
</dd>
<dt><code>housekeeping_predict</code></dt><dd><p>[<a href="base.html#topic+logical">logical</a>] Value passed to <code><a href="#topic+load_rcc">load_rcc()</a></code>.</p>
</dd>
<dt><code>housekeeping_norm</code></dt><dd><p>[<a href="base.html#topic+logical">logical</a>] Value passed to <code><a href="#topic+load_rcc">load_rcc()</a></code>.</p>
</dd>
<dt><code>normalisation_method</code></dt><dd><p>[<a href="base.html#topic+character">character</a>] Value passed to <code><a href="#topic+load_rcc">load_rcc()</a></code>.</p>
</dd>
<dt><code>remove_outliers</code></dt><dd><p>[<a href="base.html#topic+logical">logical</a>] <code>FALSE</code>.</p>
</dd>
<dt><code>n_comp</code></dt><dd><p>[<a href="base.html#topic+numeric">numeric</a>] Value passed to <code><a href="#topic+load_rcc">load_rcc()</a></code>.</p>
</dd>
<dt><code>data_directory</code></dt><dd><p>[<a href="base.html#topic+character">character</a>] Value passed to <code><a href="#topic+load_rcc">load_rcc()</a></code>.</p>
</dd>
<dt><code>pc_sum</code></dt><dd><p>[<a href="base.html#topic+data.frame">data.frame</a>] A <code>data.frame</code> with <code>n_comp</code> rows and four columns:
&quot;Standard deviation&quot;, &quot;Proportion of Variance&quot;, &quot;Cumulative Proportion&quot; and &quot;PC&quot;.</p>
</dd>
<dt><code>nacho</code></dt><dd><p>[<a href="base.html#topic+data.frame">data.frame</a>] A <code>data.frame</code> with all columns from the sample sheet <code>ssheet_csv</code>
and all computed columns, <em>i.e.</em>, quality-control metrics and counts, with one sample per row.</p>
</dd>
<dt><code>outliers_thresholds</code></dt><dd><p>[<a href="base.html#topic+list">list</a>] A <code>list</code> of the (default) quality-control thresholds used.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
if (interactive()) {
  library(GEOquery)
  library(NACHO)

  # Import data from GEO
  gse &lt;- GEOquery::getGEO(GEO = "GSE74821")
  targets &lt;- Biobase::pData(Biobase::phenoData(gse[[1]]))
  GEOquery::getGEOSuppFiles(GEO = "GSE74821", baseDir = tempdir())
  utils::untar(
    tarfile = file.path(tempdir(), "GSE74821", "GSE74821_RAW.tar"),
    exdir = file.path(tempdir(), "GSE74821")
  )
  targets$IDFILE &lt;- list.files(
    path = file.path(tempdir(), "GSE74821"),
    pattern = ".RCC.gz$"
  )
  targets[] &lt;- lapply(X = targets, FUN = iconv, from = "latin1", to = "ASCII")
  utils::write.csv(
    x = targets,
    file = file.path(tempdir(), "GSE74821", "Samplesheet.csv")
  )

  # Read RCC files and format
  nacho &lt;- load_rcc(
    data_directory = file.path(tempdir(), "GSE74821"),
    ssheet_csv = file.path(tempdir(), "GSE74821", "Samplesheet.csv"),
    id_colname = "IDFILE"
  )
}

</code></pre>

<hr>
<h2 id='NACHO-package'>NACHO: NanoString Quality Control Dashboard</h2><span id='topic+NACHO'></span><span id='topic+NACHO-package'></span>

<h3>Description</h3>

<p>NanoString nCounter data are gene expression assays where there is no need for the use of enzymes or amplification protocols and work with fluorescent barcodes (Geiss et al. (2018) <a href="https://doi.org/10.1038/nbt1385">doi:10.1038/nbt1385</a>). Each barcode is assigned a messenger-RNA/micro-RNA (mRNA/miRNA) which after bonding with its target can be counted. As a result each count of a specific barcode represents the presence of its target mRNA/miRNA. 'NACHO' (NAnoString quality Control dasHbOard) is able to analyse the exported NanoString nCounter data and facilitates the user in performing a quality control. 'NACHO' does this by visualising quality control metrics, expression of control genes, principal components and sample specific size factors in an interactive web application.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Mickaël Canouil <a href="mailto:pro@mickael.canouil.dev">pro@mickael.canouil.dev</a> (<a href="https://orcid.org/0000-0002-3396-4549">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Roderick Slieker <a href="mailto:R.C.Slieker@lumc.nl">R.C.Slieker@lumc.nl</a> (<a href="https://orcid.org/0000-0003-0961-9152">ORCID</a>)
</p>
</li>
<li><p> Gerard Bouland <a href="mailto:G.A.Bouland@lumc.nl">G.A.Bouland@lumc.nl</a>
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/mcanouil/NACHO/">https://github.com/mcanouil/NACHO/</a>
</p>
</li>
<li> <p><a href="https://m.canouil.dev/NACHO/">https://m.canouil.dev/NACHO/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/mcanouil/NACHO/issues">https://github.com/mcanouil/NACHO/issues</a>
</p>
</li></ul>


<hr>
<h2 id='normalise'>(re)Normalise a &quot;nacho&quot; object</h2><span id='topic+normalise'></span><span id='topic+normalize'></span>

<h3>Description</h3>

<p>This function creates a list in which your settings, the raw counts and normalised counts are stored,
using the result from a call to <code><a href="#topic+load_rcc">load_rcc()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalise(
  nacho_object,
  housekeeping_genes = nacho_object[["housekeeping_genes"]],
  housekeeping_predict = nacho_object[["housekeeping_predict"]],
  housekeeping_norm = nacho_object[["housekeeping_norm"]],
  normalisation_method = nacho_object[["normalisation_method"]],
  n_comp = nacho_object[["n_comp"]],
  remove_outliers = nacho_object[["remove_outliers"]],
  outliers_thresholds = nacho_object[["outliers_thresholds"]]
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalise_+3A_nacho_object">nacho_object</code></td>
<td>
<p>[<a href="base.html#topic+list">list</a>] A list object of class <code>"nacho"</code> obtained
from <code><a href="#topic+load_rcc">load_rcc()</a></code> or <code><a href="#topic+normalise">normalise()</a></code>.</p>
</td></tr>
<tr><td><code id="normalise_+3A_housekeeping_genes">housekeeping_genes</code></td>
<td>
<p>[<a href="base.html#topic+character">character</a>] A vector of names of the miRNAs/mRNAs
that should be used as housekeeping genes. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="normalise_+3A_housekeeping_predict">housekeeping_predict</code></td>
<td>
<p>[<a href="base.html#topic+logical">logical</a>] Boolean to indicate whether the housekeeping genes
should be predicted (<code>TRUE</code>) or not (<code>FALSE</code>). Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="normalise_+3A_housekeeping_norm">housekeeping_norm</code></td>
<td>
<p>[<a href="base.html#topic+logical">logical</a>] Boolean to indicate whether the housekeeping normalisation
should be performed. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="normalise_+3A_normalisation_method">normalisation_method</code></td>
<td>
<p>[<a href="base.html#topic+character">character</a>] Either <code>"GEO"</code> or <code>"GLM"</code>.
Character string to indicate normalisation using the geometric mean (<code>"GEO"</code>)
or a generalized linear model (<code>"GLM"</code>). Default is <code>"GEO"</code>.</p>
</td></tr>
<tr><td><code id="normalise_+3A_n_comp">n_comp</code></td>
<td>
<p>[<a href="base.html#topic+numeric">numeric</a>] Number indicating the number of principal components to compute.
Cannot be more than n-1 samples. Default is <code>10</code>.</p>
</td></tr>
<tr><td><code id="normalise_+3A_remove_outliers">remove_outliers</code></td>
<td>
<p>[<a href="base.html#topic+logical">logical</a>] A boolean to indicate if outliers should be excluded.</p>
</td></tr>
<tr><td><code id="normalise_+3A_outliers_thresholds">outliers_thresholds</code></td>
<td>
<p>[<a href="base.html#topic+list">list</a>] List of thresholds to exclude outliers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Outliers definition (<code>remove_outliers = TRUE</code>):
</p>

<ul>
<li><p> Binding Density (<code>BD</code>) &lt; 0.1
</p>
</li>
<li><p> Binding Density (<code>BD</code>) &gt; 2.25
</p>
</li>
<li><p> Field of View (<code>FoV</code>) &lt; 75
</p>
</li>
<li><p> Positive Control Linearity (<code>PCL</code>) &lt; 0.95
</p>
</li>
<li><p> Limit of Detection (<code>LoD</code>) &lt; 2
</p>
</li>
<li><p> Positive normalisation factor (<code>Positive_factor</code>) &lt; 0.25
</p>
</li>
<li><p> Positive normalisation factor (<code>Positive_factor</code>) &gt; 4
</p>
</li>
<li><p> Housekeeping normalisation factor (<code>house_factor</code>) &lt; 1/11
</p>
</li>
<li><p> Housekeeping normalisation factor (<code>house_factor</code>) &gt; 11
</p>
</li></ul>



<h3>Value</h3>

<p>[<a href="base.html#topic+list">list</a>] A list containing parameters and data.
</p>

<dl>
<dt><code>access</code></dt><dd><p>[<a href="base.html#topic+character">character</a>] Value passed to <code><a href="#topic+load_rcc">load_rcc()</a></code> in <code>id_colname</code>.</p>
</dd>
<dt><code>housekeeping_genes</code></dt><dd><p>[<a href="base.html#topic+character">character</a>] Value passed to <code><a href="#topic+load_rcc">load_rcc()</a></code> or <code><a href="#topic+normalise">normalise()</a></code>.</p>
</dd>
<dt><code>housekeeping_predict</code></dt><dd><p>[<a href="base.html#topic+logical">logical</a>] Value passed to <code><a href="#topic+load_rcc">load_rcc()</a></code>.</p>
</dd>
<dt><code>housekeeping_norm</code></dt><dd><p>[<a href="base.html#topic+logical">logical</a>] Value passed to <code><a href="#topic+load_rcc">load_rcc()</a></code> or <code><a href="#topic+normalise">normalise()</a></code>.</p>
</dd>
<dt><code>normalisation_method</code></dt><dd><p>[<a href="base.html#topic+character">character</a>] Value passed to <code><a href="#topic+load_rcc">load_rcc()</a></code> or <code><a href="#topic+normalise">normalise()</a></code>.</p>
</dd>
<dt><code>remove_outliers</code></dt><dd><p>[<a href="base.html#topic+logical">logical</a>] Value passed to <code><a href="#topic+normalise">normalise()</a></code>.</p>
</dd>
<dt><code>n_comp</code></dt><dd><p>[<a href="base.html#topic+numeric">numeric</a>] Value passed to <code><a href="#topic+load_rcc">load_rcc()</a></code>.</p>
</dd>
<dt><code>data_directory</code></dt><dd><p>[<a href="base.html#topic+character">character</a>] Value passed to <code><a href="#topic+load_rcc">load_rcc()</a></code>.</p>
</dd>
<dt><code>pc_sum</code></dt><dd><p>[<a href="base.html#topic+data.frame">data.frame</a>] A <code>data.frame</code> with <code>n_comp</code> rows and four columns:
&quot;Standard deviation&quot;, &quot;Proportion of Variance&quot;, &quot;Cumulative Proportion&quot; and &quot;PC&quot;.</p>
</dd>
<dt><code>nacho</code></dt><dd><p>[<a href="base.html#topic+data.frame">data.frame</a>] A <code>data.frame</code> with all columns from the sample sheet <code>ssheet_csv</code>
and all computed columns, <em>i.e.</em>, quality-control metrics and counts, with one sample per row.</p>
</dd>
<dt><code>outliers_thresholds</code></dt><dd><p>[<a href="base.html#topic+list">list</a>] A <code>list</code> of the quality-control thresholds used.</p>
</dd>
<dt><code>raw_counts</code></dt><dd><p>[<a href="base.html#topic+data.frame">data.frame</a>] Raw counts with probes as rows and samples as columns.
With <code>"CodeClass"</code> (first column), the type of the probes and
<code>"Name"</code> (second column), the Name of the probes.</p>
</dd>
<dt><code>normalised_counts</code></dt><dd><p>[<a href="base.html#topic+data.frame">data.frame</a>] Normalised counts with probes as rows and samples as columns.
With <code>"CodeClass"</code> (first column)), the type of the probes and
<code>"Name"</code> (second column), the name of the probes.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
data(GSE74821)
GSE74821_norm &lt;- normalise(
  nacho_object = GSE74821,
  housekeeping_norm = TRUE,
  normalisation_method = "GEO",
  remove_outliers = TRUE
)

if (interactive()) {
  library(GEOquery)
  library(NACHO)

  # Import data from GEO
  gse &lt;- GEOquery::getGEO(GEO = "GSE74821")
  targets &lt;- Biobase::pData(Biobase::phenoData(gse[[1]]))
  GEOquery::getGEOSuppFiles(GEO = "GSE74821", baseDir = tempdir())
  utils::untar(
    tarfile = file.path(tempdir(), "GSE74821", "GSE74821_RAW.tar"),
    exdir = file.path(tempdir(), "GSE74821")
  )
  targets$IDFILE &lt;- list.files(
    path = file.path(tempdir(), "GSE74821"),
    pattern = ".RCC.gz$"
  )
  targets[] &lt;- lapply(X = targets, FUN = iconv, from = "latin1", to = "ASCII")
  utils::write.csv(
    x = targets,
    file = file.path(tempdir(), "GSE74821", "Samplesheet.csv")
  )

  # Read RCC files and format
  nacho &lt;- load_rcc(
    data_directory = file.path(tempdir(), "GSE74821"),
    ssheet_csv = file.path(tempdir(), "GSE74821", "Samplesheet.csv"),
    id_colname = "IDFILE"
  )

  # (re)Normalise data by removing outliers
  nacho_norm &lt;- normalise(
    nacho_object = nacho,
    remove_outliers = TRUE
  )

  # (re)Normalise data with "GLM" method and removing outliers
  nacho_norm &lt;- normalise(
    nacho_object = nacho,
    normalisation_method = "GLM",
    remove_outliers = TRUE
  )
}

</code></pre>

<hr>
<h2 id='print.nacho'>Print method for &quot;nacho&quot; object</h2><span id='topic+print.nacho'></span>

<h3>Description</h3>

<p>This function allows to print text and figures from the results of a call to <code><a href="#topic+load_rcc">load_rcc()</a></code>
or <code><a href="#topic+normalise">normalise()</a></code>.
It is intended to be used in a Rmarkdown chunk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nacho'
print(
  x,
  colour = "CartridgeID",
  size = 0.5,
  show_legend = FALSE,
  show_outliers = TRUE,
  outliers_factor = 1,
  outliers_labels = NULL,
  echo = FALSE,
  title_level = 1,
  xaringan = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.nacho_+3A_x">x</code></td>
<td>
<p>[<a href="base.html#topic+list">list</a>] A list object of class <code>"nacho"</code> obtained from <code><a href="#topic+load_rcc">load_rcc()</a></code> or <code><a href="#topic+normalise">normalise()</a></code>.</p>
</td></tr>
<tr><td><code id="print.nacho_+3A_colour">colour</code></td>
<td>
<p>[<a href="base.html#topic+character">character</a>] Character string of the column in <code>ssheet_csv</code>
or more generally in <code>nacho_object$nacho</code> to be used as grouping colour.</p>
</td></tr>
<tr><td><code id="print.nacho_+3A_size">size</code></td>
<td>
<p>[<a href="base.html#topic+numeric">numeric</a>] A numeric controlling point size
(<code><a href="ggplot2.html#topic+geom_point">ggplot2::geom_point()</a></code>
or line size (<code><a href="ggplot2.html#topic+geom_path">ggplot2::geom_line()</a></code>).</p>
</td></tr>
<tr><td><code id="print.nacho_+3A_show_legend">show_legend</code></td>
<td>
<p>[<a href="base.html#topic+logical">logical</a>] Boolean to indicate whether the plot legends should
be plotted (<code>TRUE</code>) or not (<code>FALSE</code>). Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="print.nacho_+3A_show_outliers">show_outliers</code></td>
<td>
<p>[<a href="base.html#topic+logical">logical</a>] Boolean to indicate whether the outliers should be highlighted
in red (<code>TRUE</code>) or not (<code>FALSE</code>). Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="print.nacho_+3A_outliers_factor">outliers_factor</code></td>
<td>
<p>[<a href="base.html#topic+numeric">numeric</a>] Size factor for outliers compared to <code>size</code>. Default is <code>1</code>.</p>
</td></tr>
<tr><td><code id="print.nacho_+3A_outliers_labels">outliers_labels</code></td>
<td>
<p>[<a href="base.html#topic+character">character</a>] Character to indicate which column in <code>nacho_object$nacho</code>
should be used to be printed as the labels for outliers or not. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="print.nacho_+3A_echo">echo</code></td>
<td>
<p>[<a href="base.html#topic+logical">logical</a>] A boolean to indicate whether text and plots should be printed.
Mainly for use within a Rmarkdown chunk.</p>
</td></tr>
<tr><td><code id="print.nacho_+3A_title_level">title_level</code></td>
<td>
<p>[<a href="base.html#topic+numeric">numeric</a>] A numeric to indicate the title level to start with, using markdown style,
<em>i.e.</em>, the number of <code>"#"</code>.</p>
</td></tr>
<tr><td><code id="print.nacho_+3A_xaringan">xaringan</code></td>
<td>
<p>[<a href="base.html#topic+logical">logical</a>] A boolean to format output for Xaringan slides.</p>
</td></tr>
<tr><td><code id="print.nacho_+3A_...">...</code></td>
<td>
<p>Other arguments (<em>Not used</em>).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
data(GSE74821)
print(GSE74821)

</code></pre>

<hr>
<h2 id='render'>Render a HTML report of a &quot;nacho&quot; object</h2><span id='topic+render'></span>

<h3>Description</h3>

<p>This function create a Rmarkdown script and render it as a HTML document.
The HTML document is a quality-control report using all the metrics from <code><a href="#topic+visualise">visualise()</a></code>
based on recommendations from NanoString.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>render(
  nacho_object,
  colour = "CartridgeID",
  output_file = "NACHO_QC.html",
  output_dir = ".",
  size = 1,
  show_legend = TRUE,
  show_outliers = TRUE,
  outliers_factor = 1,
  outliers_labels = NULL,
  clean = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="render_+3A_nacho_object">nacho_object</code></td>
<td>
<p>[<a href="base.html#topic+list">list</a>] A list object of class <code>"nacho"</code> obtained
from <code><a href="#topic+load_rcc">load_rcc()</a></code> or <code><a href="#topic+normalise">normalise()</a></code>.</p>
</td></tr>
<tr><td><code id="render_+3A_colour">colour</code></td>
<td>
<p>[<a href="base.html#topic+character">character</a>] Character string of the column in <code>ssheet_csv</code>
or more generally in <code>nacho_object$nacho</code> to be used as grouping colour.</p>
</td></tr>
<tr><td><code id="render_+3A_output_file">output_file</code></td>
<td>
<p>[<a href="base.html#topic+character">character</a>] The name of the output file.</p>
</td></tr>
<tr><td><code id="render_+3A_output_dir">output_dir</code></td>
<td>
<p>[<a href="base.html#topic+character">character</a>] The output directory for the rendered output_file.
This allows for a choice of an alternate directory to which the output file should be written
(the default output directory is the working directory, <em>i.e.</em>, <code>.</code>).
If a path is provided with a filename in <code>output_file</code> the directory specified here will take precedence.
Please note that any directory path provided will create any necessary directories if they do not exist.</p>
</td></tr>
<tr><td><code id="render_+3A_size">size</code></td>
<td>
<p>[<a href="base.html#topic+numeric">numeric</a>] A numeric controlling point size
(<code><a href="ggplot2.html#topic+geom_point">ggplot2::geom_point()</a></code>
or line size (<code><a href="ggplot2.html#topic+geom_path">ggplot2::geom_line()</a></code>).</p>
</td></tr>
<tr><td><code id="render_+3A_show_legend">show_legend</code></td>
<td>
<p>[<a href="base.html#topic+logical">logical</a>] Boolean to indicate whether the plot legends should
be plotted (<code>TRUE</code>) or not (<code>FALSE</code>). Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="render_+3A_show_outliers">show_outliers</code></td>
<td>
<p>[<a href="base.html#topic+logical">logical</a>] Boolean to indicate whether the outliers should be highlighted
in red (<code>TRUE</code>) or not (<code>FALSE</code>). Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="render_+3A_outliers_factor">outliers_factor</code></td>
<td>
<p>[<a href="base.html#topic+numeric">numeric</a>] Size factor for outliers compared to <code>size</code>. Default is <code>1</code>.</p>
</td></tr>
<tr><td><code id="render_+3A_outliers_labels">outliers_labels</code></td>
<td>
<p>[<a href="base.html#topic+character">character</a>] Character to indicate which column in <code>nacho_object$nacho</code>
should be used to be printed as the labels for outliers or not. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="render_+3A_clean">clean</code></td>
<td>
<p>[<a href="base.html#topic+logical">logical</a>] Boolean to indicate whether the Rmd and Rdata file used to produce the HTML report
are removed from <code>output_dir</code>. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
if (interactive()) {
  data(GSE74821)
  render(GSE74821)
}

</code></pre>

<hr>
<h2 id='visualise'>Visualise quality-control metrics of a &quot;nacho&quot; object</h2><span id='topic+visualise'></span><span id='topic+visualize'></span>

<h3>Description</h3>

<p>This function allows to visualise results from <code><a href="#topic+load_rcc">load_rcc()</a></code> or <code><a href="#topic+normalise">normalise()</a></code>
several quality-control metrics in an interactive shiny application,
in which thresholds can be customised and exported.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>visualise(nacho_object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="visualise_+3A_nacho_object">nacho_object</code></td>
<td>
<p>[<a href="base.html#topic+list">list</a>] A list object of class <code>"nacho"</code> obtained
from <code><a href="#topic+load_rcc">load_rcc()</a></code> or <code><a href="#topic+normalise">normalise()</a></code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
if (interactive()) {
  data(GSE74821)
  # Must be run in an interactive R session!
  visualise(GSE74821)
}

if (interactive()) {
  library(GEOquery)
  library(NACHO)

  # Import data from GEO
  gse &lt;- GEOquery::getGEO(GEO = "GSE74821")
  targets &lt;- Biobase::pData(Biobase::phenoData(gse[[1]]))
  GEOquery::getGEOSuppFiles(GEO = "GSE74821", baseDir = tempdir())
  utils::untar(
    tarfile = file.path(tempdir(), "GSE74821", "GSE74821_RAW.tar"),
    exdir = file.path(tempdir(), "GSE74821")
  )
  targets$IDFILE &lt;- list.files(
    path = file.path(tempdir(), "GSE74821"),
    pattern = ".RCC.gz$"
  )
  targets[] &lt;- lapply(X = targets, FUN = iconv, from = "latin1", to = "ASCII")
  utils::write.csv(
    x = targets,
    file = file.path(tempdir(), "GSE74821", "Samplesheet.csv")
  )

  # Read RCC files and format
  nacho &lt;- load_rcc(
    data_directory = file.path(tempdir(), "GSE74821"),
    ssheet_csv = file.path(tempdir(), "GSE74821", "Samplesheet.csv"),
    id_colname = "IDFILE"
  )
  visualise(nacho)

  # (re)Normalise data by removing outliers
  nacho_norm &lt;- normalise(
    nacho_object = nacho,
    remove_outliers = TRUE
  )
  visualise(nacho_norm)

  # (re)Normalise data with "GLM" method and removing outliers
  nacho_norm &lt;- normalise(
    nacho_object = nacho,
    normalisation_method = "GLM",
    remove_outliers = TRUE
  )
  visualise(nacho_norm)
}

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
