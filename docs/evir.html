<!DOCTYPE html><html><head><title>Help for package evir</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {evir}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bmw'><p>Daily Log Returns on BMW Share Price</p></a></li>
<li><a href='#danish'><p>Danish Fire Insurance Claims</p></a></li>
<li><a href='#decluster'><p>Decluster Point Process</p></a></li>
<li><a href='#dgev'><p>Generalized Extreme Value Distribution</p></a></li>
<li><a href='#dgpd'><p>Generalized Pareto Distribution</p></a></li>
<li><a href='#emplot'><p>Plot of Empirical Distribution Function</p></a></li>
<li><a href='#exindex'><p>Estimate Extremal Index</p></a></li>
<li><a href='#findthresh'><p>Find Threshold</p></a></li>
<li><a href='#gev'><p>Fit Generalized Extreme Value Distribution</p></a></li>
<li><a href='#gpd'><p>Fit Generalized Pareto Model</p></a></li>
<li><a href='#gpd.q'><p>Add Quantile Estimates to plot.gpd</p></a></li>
<li><a href='#gpd.sfall'><p>Add Expected Shortfall Estimates to a GPD Plot</p></a></li>
<li><a href='#gpdbiv'><p>Implements Bivariate POT Method</p></a></li>
<li><a href='#gumbel'><p>Fit Gumbel Distribution</p></a></li>
<li><a href='#hill'><p>Create Hill Plot</p></a></li>
<li><a href='#interpret.gpdbiv'><p>Interpret Results of Bivariate GPD Fit</p></a></li>
<li><a href='#meplot'><p>Sample Mean Excess Plot</p></a></li>
<li><a href='#nidd.annual'><p>The River Nidd Data</p></a></li>
<li><a href='#nidd.thresh'><p>The River Nidd Data</p></a></li>
<li><a href='#plot.gev'><p>Plot Fitted GEV Model</p></a></li>
<li><a href='#plot.gpd'><p>Plot Fitted GPD Model</p></a></li>
<li><a href='#plot.gpdbiv'><p>Plot Fitted Bivariate GPD Model</p></a></li>
<li><a href='#plot.potd'><p>Plot Fitted POT Model</p></a></li>
<li><a href='#pot'><p>Peaks Over Thresholds Model</p></a></li>
<li><a href='#qplot'><p>Exploratory QQplot for Extreme Value Analysis</p></a></li>
<li><a href='#quant'><p>Plot of GPD Tail Estimate of a High Quantile</p></a></li>
<li><a href='#records'><p>Calculate Record Development</p></a></li>
<li><a href='#riskmeasures'><p>Calculates Quantiles and Expected Shortfalls</p></a></li>
<li><a href='#rlevel.gev'><p>Calculate Return Levels Based on GEV Fit</p></a></li>
<li><a href='#shape'><p>Plot for GPD Shape Parameter</p></a></li>
<li><a href='#siemens'><p>Daily Log Returns on Siemens Share Price</p></a></li>
<li><a href='#sp.raw'><p>SP Data to June 1993</p></a></li>
<li><a href='#spto87'><p>SP Return Data to October 1987</p></a></li>
<li><a href='#tailplot'><p>Plot Tail Estimate From GPD Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.7-4</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-03-19</td>
</tr>
<tr>
<td>Title:</td>
<td>Extreme Values in R</td>
</tr>
<tr>
<td>Depends:</td>
<td>stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for extreme value theory, which may be 
  divided into the following groups; exploratory data analysis, 
  block maxima, peaks over thresholds (univariate and bivariate), 
  point processes, gev/gpd distributions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Author:</td>
<td>Bernhard Pfaff [aut, cre],
  Eric Zivot [ctb],
  Alexander McNeil [aut] (S original (EVIS)),
  Alec Stephenson [trl] (R port of EVIS)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bernhard Pfaff &lt;bernhard@pfaffikus.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Repository/R-Forge/Project:</td>
<td>evir</td>
</tr>
<tr>
<td>Repository/R-Forge/Revision:</td>
<td>13</td>
</tr>
<tr>
<td>Repository/R-Forge/DateTimeStamp:</td>
<td>2018-03-19 20:00:59</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-03-20 12:00:27 UTC</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-03-19 20:06:44 UTC; rforge</td>
</tr>
</table>
<hr>
<h2 id='bmw'>Daily Log Returns on BMW Share Price</h2><span id='topic+bmw'></span>

<h3>Description</h3>

<p>These data are the daily log returns on BMW share price 
from Tuesday 2nd January 1973 until Tuesday 23rd July 1996.
The data are contained in a numeric vector.
The dates of each observation are contained in a <code>times</code>
attribute, which is an object of class <code>"POSIXct"</code> (see
<code><a href="base.html#topic+DateTimeClasses">DateTimeClasses</a></code>).
Note that these data form an irregular time series because
no trading takes place at the weekend. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bmw)</code></pre>


<h3>Format</h3>

<p>A numeric vector containing 6146 observations, with a
<code>times</code> attribute which is a <code>POSIXct</code> object
of the same length.</p>

<hr>
<h2 id='danish'>Danish Fire Insurance Claims</h2><span id='topic+danish'></span>

<h3>Description</h3>

<p>These data describe large fire insurance claims 
in Denmark from Thursday 3rd January 1980 until
Monday 31st December 1990.
The data are contained in a numeric vector.
The dates of each observation are contained in a <code>times</code>
attribute, which is an object of class <code>"POSIXct"</code> (see
<code><a href="base.html#topic+DateTimeClasses">DateTimeClasses</a></code>).
They were supplied by Mette Rytgaard of Copenhagen Re. 
Note that these data form an irregular time series. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(danish)</code></pre>


<h3>Format</h3>

<p>A numeric vector containing 2167 observations, with a
<code>times</code> attribute which is a <code>POSIXct</code> object
of the same length.</p>

<hr>
<h2 id='decluster'>Decluster Point Process</h2><span id='topic+decluster'></span>

<h3>Description</h3>

<p>Declusters clustered point process data so that Poisson
assumption is more tenable over a high threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decluster(series, run = NA, picture = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="decluster_+3A_series">series</code></td>
<td>
<p>a numeric vector of threshold exceedances
with a <code>times</code> attribute which should be a numeric
vector containing either the indices or the times/dates
of each exceedance (if times/dates, the attribute should
be an object of class <code>"POSIXct"</code> or an object that
can be converted to that class; see
<code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>)</p>
</td></tr>
<tr><td><code id="decluster_+3A_run">run</code></td>
<td>
<p>parameter to be used in the runs method; any two
consecutive threshold exceedances separated by more than this
number of observations/days are considered to belong to
different clusters</p>
</td></tr>  
<tr><td><code id="decluster_+3A_picture">picture</code></td>
<td>
<p>whether or not a picture of declustering should
be drawn</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The declustered object. 
</p>


<h3>References</h3>

<p>Embrechts, P., Klueppelberg, C., Mikosch, T. (1997).
<em>Modelling Extremal Events</em>. Springer.
Chapter 8, 413&ndash;429. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pot">pot</a></code>, <code><a href="#topic+exindex">exindex</a></code>,
<code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># decluster the 200 exceedances of a particular threshold in 
# the negative BMW data
data(bmw)
out &lt;- pot(-bmw, ne = 200) 
decluster(out$data, 30) 
</code></pre>

<hr>
<h2 id='dgev'>Generalized Extreme Value Distribution</h2><span id='topic+dgev'></span><span id='topic+pgev'></span><span id='topic+qgev'></span><span id='topic+rgev'></span>

<h3>Description</h3>

<p>Cumulative probability, quantiles, density and random generation
from the generalized extreme value distribution. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pgev(q, xi = 1, mu = 0, sigma = 1) 
qgev(p, xi = 1, mu = 0, sigma = 1) 
dgev(x, xi = 1, mu = 0, sigma = 1) 
rgev(n, xi = 1, mu = 0, sigma = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dgev_+3A_q">q</code></td>
<td>
<p>vector of quantiles</p>
</td></tr>
<tr><td><code id="dgev_+3A_p">p</code></td>
<td>
<p>vector of probabilities</p>
</td></tr>
<tr><td><code id="dgev_+3A_x">x</code></td>
<td>
<p>vector of values at which to evaluate density</p>
</td></tr>
<tr><td><code id="dgev_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="dgev_+3A_xi">xi</code></td>
<td>
<p>shape parameter</p>
</td></tr>
<tr><td><code id="dgev_+3A_mu">mu</code></td>
<td>
<p>location parameter</p>
</td></tr>
<tr><td><code id="dgev_+3A_sigma">sigma</code></td>
<td>
<p>scale parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Probability (<code>pgev</code>), quantile (<code>qgev</code>), density
(<code>dgev</code>) or random sample (<code>rgev</code>) for the GEV
distribution with shape <code>xi</code>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dgpd">dgpd</a></code>, <code><a href="#topic+gev">gev</a></code></p>

<hr>
<h2 id='dgpd'>Generalized Pareto Distribution </h2><span id='topic+dgpd'></span><span id='topic+pgpd'></span><span id='topic+qgpd'></span><span id='topic+rgpd'></span>

<h3>Description</h3>

<p>Cumulative probability, quantiles, density and random
generation from the generalized Pareto distribution. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pgpd(q, xi, mu = 0, beta = 1) 
qgpd(p, xi, mu = 0, beta = 1) 
dgpd(x, xi, mu = 0, beta = 1) 
rgpd(n, xi, mu = 0, beta = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dgpd_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="dgpd_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="dgpd_+3A_x">x</code></td>
<td>
<p>vector of values at which to evaluate density</p>
</td></tr>
<tr><td><code id="dgpd_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="dgpd_+3A_xi">xi</code></td>
<td>
<p>shape parameter.</p>
</td></tr>
<tr><td><code id="dgpd_+3A_mu">mu</code></td>
<td>
<p>location parameter.</p>
</td></tr>
<tr><td><code id="dgpd_+3A_beta">beta</code></td>
<td>
<p>scale parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Probability (<code>pgpd</code>), quantile (<code>qgpd</code>), density
(<code>dgpd</code>) or random sample (<code>rgpd</code>) for the GPD
distribution with shape <code>xi</code>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dgev">dgev</a></code>, <code><a href="#topic+gpd">gpd</a></code></p>

<hr>
<h2 id='emplot'>Plot of Empirical Distribution Function</h2><span id='topic+emplot'></span>

<h3>Description</h3>

<p>Plots empirical distribution function of a sample. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emplot(data, alog = "x", labels = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emplot_+3A_data">data</code></td>
<td>
<p>data vector</p>
</td></tr>
<tr><td><code id="emplot_+3A_alog">alog</code></td>
<td>
<p>whether axes are to be logged: <code>"x"</code> x-axis
only; <code>"y"</code> y-axis only; <code>"xy"</code> both axes;
<code>""</code> neither axis.</p>
</td></tr>
<tr><td><code id="emplot_+3A_labels">labels</code></td>
<td>
<p>whether or not axes should be labelled</p>
</td></tr>
<tr><td><code id="emplot_+3A_...">...</code></td>
<td>
<p>other graphics parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a simple explanatory function. A straight line on the  
double log scale indicates Pareto tail behaviour. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qplot">qplot</a></code>, <code><a href="#topic+meplot">meplot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: data(danish)
## Not run: emplot(danish) 
# Danish fire insurance data show Pareto tail behaviour 
</code></pre>

<hr>
<h2 id='exindex'>Estimate Extremal Index</h2><span id='topic+exindex'></span>

<h3>Description</h3>

<p>Plot estimates of extremal index using the blocks method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exindex(data, block, start = 5, end = NA, reverse = FALSE,
    auto.scale = TRUE, labels = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exindex_+3A_data">data</code></td>
<td>
<p>data vector (raw values not block maxima).</p>
</td></tr>
<tr><td><code id="exindex_+3A_block">block</code></td>
<td>
<p>the block size. A numeric value is interpreted as
the number of data values in each successive block.
All the data is used, so the last block may not contain
<code>block</code> observations.
If the <code>data</code> has a <code>times</code> attribute containing (in
an object of class <code>"POSIXct"</code>, or an object that can be
converted to that class; see <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>) the
times/dates of each observation, then <code>block</code> may instead
take the character values <code>"month"</code>, <code>"quarter"</code>,
<code>"semester"</code> or <code>"year"</code>.</p>
</td></tr>
<tr><td><code id="exindex_+3A_start">start</code></td>
<td>
<p>lowest value of K at which to plot a point; K is the
number of blocks in which a specified threshold is exceeded</p>
</td></tr>
<tr><td><code id="exindex_+3A_end">end</code></td>
<td>
<p>highest value of K at which to plot a point</p>
</td></tr>
<tr><td><code id="exindex_+3A_reverse">reverse</code></td>
<td>
<p>whether plot is to be by increasing threshold
(<code>TRUE</code>) or increasing K value (<code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="exindex_+3A_auto.scale">auto.scale</code></td>
<td>
<p>whether or not plot should be automatically
scaled; if not, <code>xlim</code> and <code>ylim</code> graphical parameters
may be entered</p>
</td></tr>
<tr><td><code id="exindex_+3A_labels">labels</code></td>
<td>
<p>whether or not axes should be labelled</p>
</td></tr>
<tr><td><code id="exindex_+3A_...">...</code></td>
<td>
<p>other graphics parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table of results is returned invisibly.
</p>


<h3>References</h3>

<p>Embrechts, P., Klueppelberg, C., Mikosch, T. (1997).
<em>Modelling Extremal Events</em>. Springer. Chapter 8, 413-429.  
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gev">gev</a></code>, <code><a href="#topic+hill">hill</a></code>,
<code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: data(bmw)
## Not run: exindex(bmw, 100) 
## Not run: exindex(-bmw, 100) 
# calculate extremal index for the right and left tails of the BMW 
# log returns 
</code></pre>

<hr>
<h2 id='findthresh'>Find Threshold</h2><span id='topic+findthresh'></span>

<h3>Description</h3>

<p>Finds a threshold so that a given number of
extremes lie above.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findthresh(data, ne)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findthresh_+3A_data">data</code></td>
<td>
<p>data vector</p>
</td></tr>
<tr><td><code id="findthresh_+3A_ne">ne</code></td>
<td>
<p>vector giving number of extremes above the threshold</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the data are tied a threshold is found so that at least 
the specified number of extremes lie above.
</p>


<h3>Value</h3>

<p>Vector of suitable thresholds. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hill">hill</a></code>, <code><a href="#topic+gpd">gpd</a></code>,
<code><a href="#topic+pot">pot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Find threshold giving (at least) fifty exceedances for Danish data
data(danish)
findthresh(danish, 50) 
</code></pre>

<hr>
<h2 id='gev'>Fit Generalized Extreme Value Distribution</h2><span id='topic+gev'></span>

<h3>Description</h3>

<p>Fits generalized extreme value distribution (GEV) to
block maxima data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gev(data, block = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gev_+3A_data">data</code></td>
<td>
<p>data vector. Interpretation depends on value of
block: if no block size is specified then data are
interpreted as block maxima; if block size is set, then data
are interpreted as raw data and block maxima are calculated.</p>
</td></tr>
<tr><td><code id="gev_+3A_block">block</code></td>
<td>
<p>the block size. A numeric value is interpreted as the
number of data values in each successive block. All the data is
used, so the last block may not contain <code>block</code> observations.
If the <code>data</code> has a <code>times</code> attribute containing (in
an object of class <code>"POSIXct"</code>, or an object that can be
converted to that class; see <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>) the
times/dates of each observation, then <code>block</code> may instead
take the character values <code>"month"</code>, <code>"quarter"</code>,
<code>"semester"</code> or <code>"year"</code>.</p>
</td></tr>
<tr><td><code id="gev_+3A_...">...</code></td>
<td>
<p>arguments passed to <code>optim</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>gev</code> describing the fit and including
parameter estimates and standard errors.
Fitting is carried out using maximum likelihood.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.gev">plot.gev</a></code>, <code><a href="#topic+gumbel">gumbel</a></code>,
<code><a href="stats.html#topic+optim">optim</a></code>, <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Fit GEV to monthly maxima
data(bmw)
out &lt;- gev(bmw, "month") 
# Fit GEV to maxima of blocks of 100 observations
out &lt;- gev(bmw, 100) 
# Fit GEV to the data in nidd.annual, the annual maximum water 
# levels of the River Nidd, using the "BFGS" optimization method
data(nidd.annual) 
out &lt;- gev(nidd.annual, method = "BFGS", control = list(maxit = 500))   
</code></pre>

<hr>
<h2 id='gpd'>Fit Generalized Pareto Model</h2><span id='topic+gpd'></span>

<h3>Description</h3>

<p>Returns an object of class <code>"gpd"</code> representing the fit of
a generalized Pareto model to excesses over a high threshold. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gpd(data, threshold = NA, nextremes = NA, method = c("ml", "pwm"),
    information = c("observed", "expected"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gpd_+3A_data">data</code></td>
<td>
<p>data vector</p>
</td></tr>
<tr><td><code id="gpd_+3A_threshold">threshold</code></td>
<td>
<p>a threshold value (either this or
<code>nextremes</code> must be given but not both)</p>
</td></tr>
<tr><td><code id="gpd_+3A_nextremes">nextremes</code></td>
<td>
<p>the number of upper extremes to be used (either
this or <code>threshold</code> must be given but not both)</p>
</td></tr>
<tr><td><code id="gpd_+3A_method">method</code></td>
<td>
<p>whether parameters should be estimated by the maximum
likelihood method <code>"ml"</code> or the probability-weighted moments
method <code>"pwm"</code></p>
</td></tr>
<tr><td><code id="gpd_+3A_information">information</code></td>
<td>
<p>whether standard errors should be calculated with
<code>"observed"</code> or <code>"expected"</code> information. This only applies
to the maximum likelihood method; for the probability-weighted moments
method <code>"expected"</code> information is used if possible</p>
</td></tr>
<tr><td><code id="gpd_+3A_...">...</code></td>
<td>
<p>arguments passed to <code>optim</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses the general purpose optimization function
<code>optim</code> when <code>method = "ml"</code> is chosen.
</p>


<h3>Value</h3>

<p>An object of class <code>"gpd"</code> describing the fit and including
parameter estimates and standard errors. 
</p>


<h3>References</h3>

<p>Parameter and  quantile  estimation  for  the  generalized
Pareto   distribution,   JRM   Hosking   and   JR  Wallis,
<em>Technometrics</em> <b>29</b>(3), pages 339-349, 1987.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.gpd">plot.gpd</a></code>, <code><a href="#topic+shape">shape</a></code>, 
<code><a href="#topic+quant">quant</a></code>, <code><a href="stats.html#topic+optim">optim</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(danish)
out &lt;- gpd(danish, 10) 
# Fits GPD to excess losses over 10 for the Danish
# fire insurance data 
</code></pre>

<hr>
<h2 id='gpd.q'>Add Quantile Estimates to plot.gpd</h2><span id='topic+gpd.q'></span>

<h3>Description</h3>

<p>Calculates quantile estimates and confidence intervals for
high quantiles above the threshold in a GPD analysis, and
adds a graphical representation to an existing plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gpd.q(x, pp, ci.type = c("likelihood", "wald"), ci.p = 0.95,
    like.num = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gpd.q_+3A_x">x</code></td>
<td>
<p>a list object returned by <code>plot.gpd</code> or
<code>tailplot</code></p>
</td></tr>
<tr><td><code id="gpd.q_+3A_pp">pp</code></td>
<td>
<p>the desired probability for quantile estimate (e.g. 0.99
for the 99th percentile)</p>
</td></tr>
<tr><td><code id="gpd.q_+3A_ci.type">ci.type</code></td>
<td>
<p>method for calculating a confidence interval:
<code>"likelihood"</code> or <code>"wald"</code></p>
</td></tr>
<tr><td><code id="gpd.q_+3A_ci.p">ci.p</code></td>
<td>
<p>probability for confidence interval (must be less
than 0.999)</p>
</td></tr>
<tr><td><code id="gpd.q_+3A_like.num">like.num</code></td>
<td>
<p>number of times to evaluate profile likelihood</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The GPD approximation in the tail is used to estimate quantile. 
The <code>"wald"</code> method uses the observed Fisher information
matrix to calculate confidence interval. The <code>"likelihood"</code>
method reparametrizes the likelihood in terms of the unknown
quantile and uses profile likelihood arguments to construct a
confidence interval. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gpd">gpd</a></code>, <code><a href="#topic+plot.gpd">plot.gpd</a></code>,
<code><a href="#topic+gpd.sfall">gpd.sfall</a></code>, <code><a href="#topic+tailplot">tailplot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: data(danish)
## Not run: out &lt;- gpd(danish, 10) 
## Not run: tp &lt;- tailplot(out) 
## Not run: gpd.q(tp, 0.999) 
# Estimates 99.9th percentile of Danish fire losses 
</code></pre>

<hr>
<h2 id='gpd.sfall'>Add Expected Shortfall Estimates to a GPD Plot</h2><span id='topic+gpd.sfall'></span>

<h3>Description</h3>

<p>Calculates expected shortfall (tail conditional expectation) 
estimates and confidence intervals for high quantiles above the
threshold in a GPD analysis, and adds a graphical representation
to an existing plot.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gpd.sfall(x, pp, ci.p = 0.95, like.num = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gpd.sfall_+3A_x">x</code></td>
<td>
<p>a list object returned by <code>plot.gpd</code> or
<code>tailplot</code></p>
</td></tr>
<tr><td><code id="gpd.sfall_+3A_pp">pp</code></td>
<td>
<p>the desired probability for expected shortfall estimate
(e.g. 0.99 for the 99th percentile)</p>
</td></tr>
<tr><td><code id="gpd.sfall_+3A_ci.p">ci.p</code></td>
<td>
<p>probability for confidence interval (must be less
than 0.999)</p>
</td></tr>
<tr><td><code id="gpd.sfall_+3A_like.num">like.num</code></td>
<td>
<p>number of times to evaluate profile likelihood</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Expected shortfall is the expected size of the loss, given that a
particular quantile of the loss distribution is exceeded. 
The GPD approximation in the tail is used to estimate expected
shortfall. The likelihood is reparametrised  in terms of the unknown
expected shortfall and profile likelihood arguments are used to
construct a confidence interval. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gpd">gpd</a></code>, <code><a href="#topic+plot.gpd">plot.gpd</a></code>,
<code><a href="#topic+tailplot">tailplot</a></code>, <code><a href="#topic+gpd.q">gpd.q</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: data(danish)
## Not run: out &lt;- gpd(danish, 10)
## Not run: tp &lt;- tailplot(out)
## Not run: gpd.q(tp, 0.999) 
# Estimates 99.9th percentile of Danish fire losses 
## Not run: gpd.sfall(tp, 0.999) 
# Estimates associated expected shortfall for Danish fire losses 
</code></pre>

<hr>
<h2 id='gpdbiv'>Implements Bivariate POT Method</h2><span id='topic+gpdbiv'></span>

<h3>Description</h3>

<p>Returns an object of class <code>"gpdbiv"</code> representing the fit
of a bivariate POT (peaks over thresholds) model for joint
excesses over thresholds. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gpdbiv(data1 = NA, data2 = NA, u1 = NA, u2 = NA, ne1 = NA, ne2 = NA,
    global = FALSE, method = "BFGS", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gpdbiv_+3A_data1">data1</code></td>
<td>
<p>first data vector</p>
</td></tr>
<tr><td><code id="gpdbiv_+3A_data2">data2</code></td>
<td>
<p>second data vector</p>
</td></tr>
<tr><td><code id="gpdbiv_+3A_u1">u1</code></td>
<td>
<p>threshold for <code>data1</code> (either this or <code>ne1</code>
must be given but not both)</p>
</td></tr>
<tr><td><code id="gpdbiv_+3A_u2">u2</code></td>
<td>
<p>threshold for <code>data2</code> (either this or <code>ne2</code>
must be given but not both)</p>
</td></tr>
<tr><td><code id="gpdbiv_+3A_ne1">ne1</code></td>
<td>
<p>number of upper extremes to be used for <code>data1</code>
(either this or <code>u1</code> must be given but not both)</p>
</td></tr>
<tr><td><code id="gpdbiv_+3A_ne2">ne2</code></td>
<td>
<p>number of upper extremes to be used for <code>data2</code>
(either this or <code>u2</code> must be given but not both)</p>
</td></tr>
<tr><td><code id="gpdbiv_+3A_global">global</code></td>
<td>
<p>should a global maximisation of the likelihood with
respect to marginal and dependence parameters be undertaken. The
default alternative is a two-stage local fit where first the
marginal parameters are estimated and then the dependence
parameter. This is much faster than a global fit.</p>
</td></tr>
<tr><td><code id="gpdbiv_+3A_method">method</code></td>
<td>
<p>the optimization method (see <code>optim</code>).
The argument has been created (as distinct from ...) in order
to make the <code>"BFGS"</code> method the default, as the default
used by <code>optim</code> is not recommended for the one-dimensional
optimizations that occur when <code>global = FALSE</code>.</p>
</td></tr>
<tr><td><code id="gpdbiv_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>optim</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements a model suggested by Richard Smith (see
references below). The marginal excess distributions are GPD
distributions, as suggested by univariate EVT and implemented in gpd.  
The dependence specification is known as the logistic or Gumbel
dependence structure, but it would be easy to program alternatives. 
</p>


<h3>Value</h3>

<p>An object of class <code>"gpdbiv"</code> representing the fit and including
parameter estimates and standard errors. 
</p>


<h3>References</h3>

<p>Multivariate Threshold Methods, Richard L. Smith,
in <em>Extreme Value Theory and Applications</em>, ed. J. Galambos,
published by Kluwer, pages 225-248, 1994.
</p>
<p>Markov Chain Models for Threshold Exceedances,
R.L. Smith, J.A. Tawn, S.G. Coles,
<em>Biometrika</em> <b>84</b>, 249-268, 1997. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gpd">gpd</a></code>, <code><a href="#topic+plot.gpdbiv">plot.gpdbiv</a></code>, 
<code><a href="#topic+interpret.gpdbiv">interpret.gpdbiv</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bmw) ; data(siemens)
out &lt;- gpdbiv(-bmw, -siemens, ne1 = 100, ne2 = 100)
interpret.gpdbiv(out, 0.05, 0.05)
## Not run: plot(out) 
</code></pre>

<hr>
<h2 id='gumbel'>Fit Gumbel Distribution</h2><span id='topic+gumbel'></span>

<h3>Description</h3>

<p>Fits gumbel distribution (GEV with <code>xi = 0</code>) to
block maxima data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gumbel(data, block = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gumbel_+3A_data">data</code></td>
<td>
<p>data vector. Interpretation depends on value of
block: if no block size is specified then data are
interpreted as block maxima; if block size is set, then data
are interpreted as raw data and block maxima are calculated.</p>
</td></tr>
<tr><td><code id="gumbel_+3A_block">block</code></td>
<td>
<p>the block size. A numeric value is interpreted as the
number of data values in each successive block. All the data is
used, so the last block may not contain <code>block</code> observations.
If the <code>data</code> has a <code>times</code> attribute containing (in
an object of class <code>"POSIXct"</code>, or an object that can be
converted to that class; see <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>) the
times/dates of each observation, then <code>block</code> may instead
take the character values <code>"month"</code>, <code>"quarter"</code>,
<code>"semester"</code> or <code>"year"</code>.</p>
</td></tr>
<tr><td><code id="gumbel_+3A_...">...</code></td>
<td>
<p>arguments passed to <code>optim</code></p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>This function is primarily intended for comparison with GEV for 
assessing the need for a heavy-tailed Frechet (or short-tailed 
Weibull) to model block maxima. 
</p>


<h3>Value</h3>

<p>An object of class <code>"gev"</code> describing the fit and including
parameter estimates and standard errors.
Fitting is carried out using maximum likelihood.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.gev">plot.gev</a></code>, <code><a href="#topic+gev">gev</a></code>,
<code><a href="stats.html#topic+optim">optim</a></code>, <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Fit Gumbel to maxima of blocks of 100 observations
data(bmw)
out &lt;- gumbel(bmw, 100) 
# Fit Gumbel to the data in nidd.annual, the annual maximum water 
# levels of the River Nidd, using the "BFGS" optimization method
data(nidd.annual)
out &lt;- gumbel(nidd.annual, method = "BFGS", control = list(maxit = 500))
</code></pre>

<hr>
<h2 id='hill'>Create Hill Plot</h2><span id='topic+hill'></span>

<h3>Description</h3>

<p>Plot the Hill estimate of the tail index of heavy-tailed
data, or of an associated quantile estimate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hill(data, option = c("alpha","xi","quantile"), start = 15,
    end = NA, reverse = FALSE, p = NA, ci = 0.95,
    auto.scale = TRUE, labels = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hill_+3A_data">data</code></td>
<td>
<p>data vector</p>
</td></tr>
<tr><td><code id="hill_+3A_option">option</code></td>
<td>
<p>whether <code>"alpha"</code>, <code>"xi"</code> (1/alpha) or
<code>"quantile"</code> (a quantile estimate) should be plotted</p>
</td></tr>
<tr><td><code id="hill_+3A_start">start</code></td>
<td>
<p>lowest number of order statistics at which to plot
a point</p>
</td></tr>
<tr><td><code id="hill_+3A_end">end</code></td>
<td>
<p>highest number of order statistics at which to plot
a point</p>
</td></tr>
<tr><td><code id="hill_+3A_reverse">reverse</code></td>
<td>
<p>whether plot is to be by increasing threshold
(<code>TRUE</code>) or increasing number of order statistics
(<code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="hill_+3A_p">p</code></td>
<td>
<p>probability required when option <code>"quantile"</code> is
chosen</p>
</td></tr>
<tr><td><code id="hill_+3A_ci">ci</code></td>
<td>
<p>probability for asymptotic confidence band; for no
confidence band set <code>ci</code> to zero</p>
</td></tr>
<tr><td><code id="hill_+3A_auto.scale">auto.scale</code></td>
<td>
<p>whether or not plot should be automatically
scaled; if not, <code>xlim</code> and <code>ylim</code> graphical
parameters may be entered</p>
</td></tr>
<tr><td><code id="hill_+3A_labels">labels</code></td>
<td>
<p>whether or not axes should be labelled</p>
</td></tr>
<tr><td><code id="hill_+3A_...">...</code></td>
<td>
<p>other graphics parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This plot is usually calculated from the alpha perspective.
For a generalized Pareto analysis of heavy-tailed data using
the <code>gpd</code> function, it helps to plot the Hill estimates
for xi. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+shape">shape</a></code>, <code><a href="#topic+quant">quant</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: data(danish)
## Not run: hill(danish) 
# Hill plot of heavy-tailed Danish fire insurance data 
## Not run: hill(danish, option = "quantile", end = 500, p = 0.999) 
# Hill plot of estimated 0.999 quantile of Danish fire insurance data 
</code></pre>

<hr>
<h2 id='interpret.gpdbiv'>Interpret Results of Bivariate GPD Fit</h2><span id='topic+interpret.gpdbiv'></span>

<h3>Description</h3>

<p>Interprets the results of a bivariate GPD model fitted
using the bivariate POT method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interpret.gpdbiv(out, x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interpret.gpdbiv_+3A_out">out</code></td>
<td>
<p>a <code>gpdbiv</code> object</p>
</td></tr>
<tr><td><code id="interpret.gpdbiv_+3A_x">x</code></td>
<td>
<p>a scalar value greater than first threshold</p>
</td></tr>
<tr><td><code id="interpret.gpdbiv_+3A_y">y</code></td>
<td>
<p>a scalar value greater than second threshold</p>
</td></tr>
</table>


<h3>Details</h3>

<p>First marginal probabilities of exceeding the points x and y
are calculated, and then joint and conditional probabilities. 
</p>


<h3>Value</h3>

<p>A vector of probabilities is invisibly returned, in printed order. 
</p>


<h3>Side Effects</h3>

<p>A simple interpretation of the fit in terms of exceedance 
probabilities for the point (x,y) is printed. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gpdbiv">gpdbiv</a></code>, <code><a href="#topic+plot.gpdbiv">plot.gpdbiv</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bmw) ; data(siemens)
out &lt;- gpdbiv(-bmw, -siemens, ne1 = 100, ne2 = 100) 
interpret.gpdbiv(out, 0.05, 0.05) 
# probabilities of 5% falls in BMW and Siemens stock prices 
</code></pre>

<hr>
<h2 id='meplot'>Sample Mean Excess Plot</h2><span id='topic+meplot'></span>

<h3>Description</h3>

<p>Plots sample mean excesses over increasing thresholds.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meplot(data, omit = 3, labels = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meplot_+3A_data">data</code></td>
<td>
<p>data vector</p>
</td></tr>
<tr><td><code id="meplot_+3A_omit">omit</code></td>
<td>
<p>number of upper plotting points to be omitted</p>
</td></tr>
<tr><td><code id="meplot_+3A_labels">labels</code></td>
<td>
<p>whether or not axes are to be labelled</p>
</td></tr>
<tr><td><code id="meplot_+3A_...">...</code></td>
<td>
<p>other graphics parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An upward trend in plot shows heavy-tailed behaviour. In particular,
a straight line with positive gradient above some threshold is a sign 
of Pareto behaviour in tail. A downward trend shows thin-tailed 
behaviour whereas a line with zero gradient shows an exponential 
tail. Because upper plotting points are the average of a handful of
extreme excesses, these may be omitted for a prettier plot. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gpd">gpd</a></code>, <code><a href="#topic+qplot">qplot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: data(danish)
## Not run: meplot(danish) 
# Sample mean excess plot of heavy-tailed Danish fire insurance data 
</code></pre>

<hr>
<h2 id='nidd.annual'>The River Nidd Data</h2><span id='topic+nidd.annual'></span>

<h3>Description</h3>

<p>These data represent annual maximal levels of the 
River Nidd in Yorkshire. 
These data are suitable for analysis with <code>gev</code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(nidd.annual)</code></pre>


<h3>Format</h3>

<p>A numeric vector containing 35 observations.</p>

<hr>
<h2 id='nidd.thresh'>The River Nidd Data</h2><span id='topic+nidd.thresh'></span>

<h3>Description</h3>

<p>These data represent high river levels of the 
River Nidd in Yorkshire above a threshold value 
of 65. These data are suitable for analysis with 
<code>gpd</code>.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(nidd.thresh)</code></pre>


<h3>Format</h3>

<p>A numeric vector containing 154 observations.</p>

<hr>
<h2 id='plot.gev'>Plot Fitted GEV Model</h2><span id='topic+plot.gev'></span>

<h3>Description</h3>

<p>The plot method plot.gev provides two different residual plots 
for assessing fitted GEV model. The user selects the plot type 
from a menu. See the examples below. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gev'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.gev_+3A_x">x</code></td>
<td>
<p>a <code>gev</code> object</p>
</td></tr>
<tr><td><code id="plot.gev_+3A_...">...</code></td>
<td>
<p>other graphics parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data are converted to unit exponentially distributed residuals
under null hypothesis that GEV fits. Two diagnostics for iid
exponential data are offered. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gev">gev</a></code>, <code><a href="#topic+qplot">qplot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bmw)
out &lt;- gev(bmw, 100) 
## Not run: plot(out)
 
## Not run: Make a plot selection (or 0 to exit):
## Not run: 1: plot: Scatterplot of Residuals
## Not run: 2: plot: QQplot of Residuals
</code></pre>

<hr>
<h2 id='plot.gpd'>Plot Fitted GPD Model</h2><span id='topic+plot.gpd'></span>

<h3>Description</h3>

<p>The plot method plot.gpd provides four different plots 
for assessing fitted GPD model. The user selects the plot
type from a menu. See the examples below. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gpd'
plot(x, optlog = NA, extend = 1.5, labels = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.gpd_+3A_x">x</code></td>
<td>
<p>a <code>gpd</code> object</p>
</td></tr>
<tr><td><code id="plot.gpd_+3A_optlog">optlog</code></td>
<td>
<p>optional argument for plots 1 and 2 giving a
particular choice of logarithmic axes: <code>"x"</code> x-axis
only; <code>"y"</code> y-axis only; <code>"xy"</code> both axes;
<code>""</code> neither axis.</p>
</td></tr>
<tr><td><code id="plot.gpd_+3A_extend">extend</code></td>
<td>
<p>optional argument for plots 1 and 2 expressing how
far x-axis should extend as a multiple of the largest data value.
This argument must take values greater than 1 and is useful for
showing estimated quantiles beyond data.</p>
</td></tr>
<tr><td><code id="plot.gpd_+3A_labels">labels</code></td>
<td>
<p>optional argument for plots 1 and 2  specifying whether
or not axes should be labelled</p>
</td></tr>
<tr><td><code id="plot.gpd_+3A_...">...</code></td>
<td>
<p>other graphics parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If plot 1 or 2 is selected as the final plot, a list object containing
details of the plot is returned invisibly.
This object should be used as the first argument of <code>gpd.q</code>
or <code>gpd.sfall</code> to add quantile estimates or expected shortfall
estimates to the plot.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gpd">gpd</a></code>, <code><a href="#topic+quant">quant</a></code>, <code><a href="#topic+shape">shape</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(danish)
out &lt;- gpd(danish, 10) 
## Not run: plot(out) 

## Not run: Make a plot selection (or 0 to exit):
## Not run: 1: plot: Excess Distribution 
## Not run: 2: plot: Tail of Underlying Distribution 
## Not run: 3: plot: Scatterplot of Residuals 
## Not run: 4: plot: QQplot of Residuals 
</code></pre>

<hr>
<h2 id='plot.gpdbiv'>Plot Fitted Bivariate GPD Model</h2><span id='topic+plot.gpdbiv'></span>

<h3>Description</h3>

<p>Provides a number of plots summarising a bivariate GPD model
fitted using the bivariate POT method. See the examples below. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gpdbiv'
plot(x, extend = 1.1, n.contours = 15, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.gpdbiv_+3A_x">x</code></td>
<td>
<p>a <code>gpdbiv</code> object</p>
</td></tr>
<tr><td><code id="plot.gpdbiv_+3A_extend">extend</code></td>
<td>
<p>optional argument expressing how far x-axis should
extend as a multiple of the largest data value.</p>
</td></tr>
<tr><td><code id="plot.gpdbiv_+3A_n.contours">n.contours</code></td>
<td>
<p>number of contours in bivariate contour plots</p>
</td></tr>
<tr><td><code id="plot.gpdbiv_+3A_...">...</code></td>
<td>
<p>other graphics parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Option 1 plots the threshold exceedance data; option 2 plots contours
of the fitted bivariate distribution function in the joint upper tail
(above both thresholds); option 3 plots corresponding contours of the
fitted joint survival function; plots 4 and 5 show the fitted tails
of the marginal distributions. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gpd">gpd</a></code>, <code><a href="#topic+gpdbiv">gpdbiv</a></code>,
<code><a href="#topic+tailplot">tailplot</a></code>, <code><a href="#topic+interpret.gpdbiv">interpret.gpdbiv</a></code>,
<code><a href="#topic+plot.gpd">plot.gpd</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bmw) ; data(siemens)
out &lt;- gpdbiv(-bmw, -siemens, ne1 = 100, ne2 = 100) 
## Not run: plot(out)
 
## Not run: Make a plot selection (or 0 to exit): 
## Not run: 1: plot: Exceedance data
## Not run: 2: plot: Contours of Bivariate Distribution Function
## Not run: 3: plot: Contours of Bivariate Survival Function 
## Not run: 4: plot: Tail of Marginal 1 
## Not run: 5: plot: Tail of Marginal 2 
</code></pre>

<hr>
<h2 id='plot.potd'>Plot Fitted POT Model</h2><span id='topic+plot.potd'></span>

<h3>Description</h3>

<p>The plot method plot.potd provides seven different plots 
for assessing fitted POT model. The user selects the plot
type from a menu. See the examples below. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'potd'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.potd_+3A_x">x</code></td>
<td>
<p>an object returned by the function <code>pot</code></p>
</td></tr>
<tr><td><code id="plot.potd_+3A_...">...</code></td>
<td>
<p>other graphics parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plot 1 displays the exceedance process of the chosen threshold. 
Plots 2-4  assess the Poisson nature of the exceedance process 
by looking at the scaled gaps between exceedances, which should
be iid unit exponentially distributed. Plots 5-6 assess the GPD
nature of the excesses by looking at suitably defined residuals,
which should again be iid unit exponentially distributed. Option
8 allows the user to call GPD plotting functions. 
</p>


<h3>Value</h3>

<p>If plot 1 or 2 from the GPD plots is selected as the final plot
(i.e. option 8 is selected, followed by option 1 or 2), a list
object containing details of the plot is returned invisibly.
This object should be used as the first argument of <code>gpd.q</code>
or <code>gpd.sfall</code> to add quantile estimates or expected shortfall
estimates to the plot.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gpd">gpd</a></code>, <code><a href="#topic+pot">pot</a></code>,
<code><a href="#topic+plot.gpd">plot.gpd</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(danish)
out &lt;- pot(danish,10) 
## Not run: plot(out) 
  
## Not run: Make a plot selection (or 0 to exit): 
## Not run: 1: plot: Point Process of Exceedances 
## Not run: 2: plot: Scatterplot of Gaps 
## Not run: 3: plot: Qplot of Gaps 
## Not run: 4: plot: ACF of Gaps 
## Not run: 5: plot: Scatterplot of Residuals 
## Not run: 6: plot: Qplot of Residuals 
## Not run: 7: plot: ACF of Residuals 
## Not run: 8: plot: Go to GPD Plots   
</code></pre>

<hr>
<h2 id='pot'>Peaks Over Thresholds Model</h2><span id='topic+pot'></span>

<h3>Description</h3>

<p>Fits a Poisson point process to the data, an approach 
sometimes known as peaks over thresholds (POT), and
returns an object of class <code>"potd"</code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pot(data, threshold = NA, nextremes = NA, run = NA, picture = TRUE,
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pot_+3A_data">data</code></td>
<td>
<p>numeric vector of data, which may have a <code>times</code>
attribute containing (in an object of class <code>"POSIXct"</code>, or
an object that can be converted to that class; see
<code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>) the times/dates of each observation.
If no <code>times</code> attribute exists, the data are assumed to
be equally spaced.</p>
</td></tr>
<tr><td><code id="pot_+3A_threshold">threshold</code></td>
<td>
<p>a threshold value (either this or <code>nextremes</code>
must be given but not both)</p>
</td></tr>
<tr><td><code id="pot_+3A_nextremes">nextremes</code></td>
<td>
<p>the number of upper extremes to be used (either
this or <code>threshold</code> must be given but not both)</p>
</td></tr>
<tr><td><code id="pot_+3A_run">run</code></td>
<td>
<p>if the data are to be declustered the run length
parameter for the runs method (see <code><a href="#topic+decluster">decluster</a></code>)
should be entered here</p>
</td></tr>
<tr><td><code id="pot_+3A_picture">picture</code></td>
<td>
<p>whether or not a picture should be drawn if
declustering is performed</p>
</td></tr>
<tr><td><code id="pot_+3A_...">...</code></td>
<td>
<p>arguments passed to <code>optim</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses <code>optim</code> for point process likelihood maximization. 
</p>


<h3>Value</h3>

<p>An object of class <code>"potd"</code> describing the fit and including
parameter estimates and standard errors. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gpd">gpd</a></code>, <code><a href="#topic+plot.potd">plot.potd</a></code>, 
<code><a href="#topic+plot.gpd">plot.gpd</a></code>, <code><a href="#topic+decluster">decluster</a></code>,
<code><a href="stats.html#topic+optim">optim</a></code>, <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(danish)
out &lt;- pot(danish, 10)  
# Fits POT model to Danish fire insurance losses 
</code></pre>

<hr>
<h2 id='qplot'>Exploratory QQplot for Extreme Value Analysis</h2><span id='topic+qplot'></span>

<h3>Description</h3>

<p>Creates a QQplot for threshold data against the exponential 
distribution or the generalized Pareto distribution. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qplot(data, xi = 0, trim = NA, threshold = NA, line = TRUE,
    labels = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qplot_+3A_data">data</code></td>
<td>
<p>data vector</p>
</td></tr>
<tr><td><code id="qplot_+3A_xi">xi</code></td>
<td>
<p>the xi value of a generalized Pareto distribution</p>
</td></tr>
<tr><td><code id="qplot_+3A_trim">trim</code></td>
<td>
<p>value at which data are to be right-truncated</p>
</td></tr>
<tr><td><code id="qplot_+3A_threshold">threshold</code></td>
<td>
<p>value at which data are to be left-truncated</p>
</td></tr>
<tr><td><code id="qplot_+3A_line">line</code></td>
<td>
<p>whether or not a straight line is to be added</p>
</td></tr>
<tr><td><code id="qplot_+3A_labels">labels</code></td>
<td>
<p>whether or not the axes are to be labelled</p>
</td></tr>
<tr><td><code id="qplot_+3A_...">...</code></td>
<td>
<p>other graphics parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If xi is zero the reference distribution is the exponential; if 
xi is non-zero the reference distribution is the generalized 
Pareto with that value of xi. 
In the case of the exponential, the plot is interpreted as follows. 
Concave departures from a straight line are a sign of heavy-tailed  
behaviour. Convex departures show thin-tailed behaviour. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gpd">gpd</a></code>, <code><a href="#topic+meplot">meplot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: data(danish)
## Not run: qplot(danish) 
# QQplot of heavy-tailed Danish fire insurance data 
</code></pre>

<hr>
<h2 id='quant'>Plot of GPD Tail Estimate of a High Quantile</h2><span id='topic+quant'></span>

<h3>Description</h3>

<p>Creates a plot showing how the estimate of a high quantile in
the tail of a dataset based on the GPD approximation varies with
threshold or number of extremes. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quant(data, p = 0.99, models = 30, start = 15, end = 500, reverse =
    TRUE, ci = 0.95, auto.scale = TRUE, labels = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quant_+3A_data">data</code></td>
<td>
<p>numeric vector of data</p>
</td></tr>
<tr><td><code id="quant_+3A_p">p</code></td>
<td>
<p>desired probability for quantile estimate (e.g. 0.99
gives 99th percentile)</p>
</td></tr>
<tr><td><code id="quant_+3A_models">models</code></td>
<td>
<p>number of consecutive gpd models to be fitted</p>
</td></tr>
<tr><td><code id="quant_+3A_start">start</code></td>
<td>
<p>lowest number of exceedances to be considered</p>
</td></tr>
<tr><td><code id="quant_+3A_end">end</code></td>
<td>
<p>maximum number of exceedances to be considered</p>
</td></tr>
<tr><td><code id="quant_+3A_reverse">reverse</code></td>
<td>
<p>should plot be by increasing threshold
(<code>TRUE</code>) or number of extremes (<code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="quant_+3A_ci">ci</code></td>
<td>
<p>probability for asymptotic confidence band; for no
confidence band set to zero</p>
</td></tr>
<tr><td><code id="quant_+3A_auto.scale">auto.scale</code></td>
<td>
<p>whether or not plot should be automatically scaled;
if not, xlim and ylim graphical parameters may be entered</p>
</td></tr>
<tr><td><code id="quant_+3A_labels">labels</code></td>
<td>
<p>whether or not axes should be labelled</p>
</td></tr>
<tr><td><code id="quant_+3A_...">...</code></td>
<td>
<p>other graphics parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For every model <code>gpd</code> is called. Evaluation may be slow. 
Confidence intervals by the Wald method (which is fastest). 
</p>


<h3>Value</h3>

<p>A table of results is returned invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gpd">gpd</a></code>, <code><a href="#topic+plot.gpd">plot.gpd</a></code>,
<code><a href="#topic+gpd.q">gpd.q</a></code>, <code><a href="#topic+shape">shape</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: data(danish)
## Not run: quant(danish, 0.999) 
# Estimates of the 99.9th percentile of the Danish losses using 
# the GPD model with various thresholds 
</code></pre>

<hr>
<h2 id='records'>Calculate Record Development</h2><span id='topic+records'></span>

<h3>Description</h3>

<p>Creates a data frame showing the development of records in 
a dataset and calculating the expected behaviour for iid data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>records(data, do.plot = TRUE, conf.level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="records_+3A_data">data</code></td>
<td>
<p>data vector</p>
</td></tr>
<tr><td><code id="records_+3A_do.plot">do.plot</code></td>
<td>
<p>whether a plot of record development should be
created</p>
</td></tr>
<tr><td><code id="records_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level for record development plot</p>
</td></tr>
<tr><td><code id="records_+3A_...">...</code></td>
<td>
<p>graphics parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Records are counted and the observations at which they occur 
recorded. This is compared with the expected behaviour for iid 
data. 
</p>


<h3>Value</h3>

<p>A data frame. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: data(danish)
## Not run: records(danish) 
# Record fire insurance losses in Denmark 
</code></pre>

<hr>
<h2 id='riskmeasures'>Calculates Quantiles and Expected Shortfalls</h2><span id='topic+riskmeasures'></span>

<h3>Description</h3>

<p>Makes a rapid calculation of point estimates of prescribed
quantiles and expected shortfalls using the output of the
function <code>gpd</code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>riskmeasures(x, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="riskmeasures_+3A_x">x</code></td>
<td>
<p>results of a <code>gpd</code> fit</p>
</td></tr>
<tr><td><code id="riskmeasures_+3A_p">p</code></td>
<td>
<p>a vector of probability levels</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simply calculates point estimates and (at present)
makes no attempt to calculate confidence intervals for the risk
measures. If confidence levels are required use <code>gpd.q</code> and
<code>gpd.sfall</code> which interact with graphs of the tail of a loss
distribution and are much slower. 
</p>


<h3>Value</h3>

<p>A matrix with three columns: probability level, quantile
estimate, shortfall estimate. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gpd">gpd</a></code>, <code><a href="#topic+tailplot">tailplot</a></code>,
<code><a href="#topic+gpd.q">gpd.q</a></code>, <code><a href="#topic+gpd.sfall">gpd.sfall</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(danish)
out &lt;- gpd(danish, 10) 
riskmeasures(out, c(0.999, 0.9999)) 
# gives estimates of 0.999 and 0.9999 quantiles of Danish loss
# distribution as well as the associated expected shortfall estimates 
</code></pre>

<hr>
<h2 id='rlevel.gev'>Calculate Return Levels Based on GEV Fit</h2><span id='topic+rlevel.gev'></span>

<h3>Description</h3>

<p>Calculates the k-block return level and 95% confidence interval
based on a GEV model for block maxima, where k is specified by
the user. The k-block return level is that level exceeded once
every k blocks, on average. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rlevel.gev(out, k.blocks = 20, add = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rlevel.gev_+3A_out">out</code></td>
<td>
<p>an object returned by the function <code>gev</code></p>
</td></tr>
<tr><td><code id="rlevel.gev_+3A_k.blocks">k.blocks</code></td>
<td>
<p>specifies the particular return level to be
estimated; default set arbitrarily to 20</p>
</td></tr>
<tr><td><code id="rlevel.gev_+3A_add">add</code></td>
<td>
<p>whether the return level should be added graphically
to a time series plot; if <code>FALSE</code> a graph of the profile
likelihood curve showing the return level and its confidence
interval is produced</p>
</td></tr>
<tr><td><code id="rlevel.gev_+3A_...">...</code></td>
<td>
<p>other graphics parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The GEV likelihood is reparameterized in terms of the unknown
return level and profile likelihood arguments are used to
construct a confidence interval. 
</p>


<h3>Value</h3>

<p>Vector containing lower 95% bound of confidence interval,
estimated return level and upper 95% bound. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gev">gev</a></code>, <code><a href="#topic+plot.gev">plot.gev</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bmw)
out &lt;- gev(bmw, "month")
# Fit GEV to monthly maxima of daily returns on BMW share price
## Not run: rlevel.gev(out, 40)
# Calculate the 40 month return level
</code></pre>

<hr>
<h2 id='shape'>Plot for GPD Shape Parameter</h2><span id='topic+shape'></span>

<h3>Description</h3>

<p>Creates a plot showing how the estimate of shape varies
with threshold or number of extremes. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shape(data, models = 30, start = 15, end = 500, reverse = TRUE,
    ci = 0.95, auto.scale = TRUE, labels = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shape_+3A_data">data</code></td>
<td>
<p>numeric vector of data</p>
</td></tr>
<tr><td><code id="shape_+3A_models">models</code></td>
<td>
<p>number of consecutive gpd models to be fitted</p>
</td></tr>
<tr><td><code id="shape_+3A_start">start</code></td>
<td>
<p>lowest number of exceedances to be considered</p>
</td></tr>
<tr><td><code id="shape_+3A_end">end</code></td>
<td>
<p>maximum number of exceedances to be considered</p>
</td></tr>
<tr><td><code id="shape_+3A_reverse">reverse</code></td>
<td>
<p>should plot be by increasing threshold
(<code>TRUE</code>) or number of extremes (<code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="shape_+3A_ci">ci</code></td>
<td>
<p>probability for asymptotic confidence band; for no
confidence band set to zero</p>
</td></tr>
<tr><td><code id="shape_+3A_auto.scale">auto.scale</code></td>
<td>
<p>whether or not plot should be automatically
scaled; if not, <code>xlim</code> and <code>ylim</code> graphical
parameters may be entered</p>
</td></tr>
<tr><td><code id="shape_+3A_labels">labels</code></td>
<td>
<p>whether or not axes should be labelled</p>
</td></tr>
<tr><td><code id="shape_+3A_...">...</code></td>
<td>
<p>other graphics parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For every model <code>gpd</code> is called. Evaluation may be slow. 
</p>


<h3>Value</h3>

<p>A table of results is returned invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gpd">gpd</a></code>, <code><a href="#topic+plot.gpd">plot.gpd</a></code>,
<code><a href="#topic+hill">hill</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: data(danish)
## Not run: shape(danish)
# Shape plot of heavy-tailed Danish fire insurance data 
</code></pre>

<hr>
<h2 id='siemens'>Daily Log Returns on Siemens Share Price</h2><span id='topic+siemens'></span>

<h3>Description</h3>

<p>These data are the daily log returns on Siemens share price 
from Tuesday 2nd January 1973 until Tuesday 23rd July 1996.
The data are contained in a numeric vector.
The dates of each observation are contained in a <code>times</code>
attribute, which is an object of class <code>"POSIXct"</code> (see
<code><a href="base.html#topic+DateTimeClasses">DateTimeClasses</a></code>).
Note that these data form an irregular time series because 
no trading takes place at the weekend. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(siemens)</code></pre>


<h3>Format</h3>

<p>A numeric vector containing 6146 observations, with a
<code>times</code> attribute which is a <code>POSIXct</code> object
of the same length.</p>

<hr>
<h2 id='sp.raw'>SP Data to June 1993</h2><span id='topic+sp.raw'></span>

<h3>Description</h3>

<p>The daily closing values of the S&amp;P index from
Monday 4th January 1960 until Friday 11th June 1993.
The data are contained in a numeric vector.
The dates of each observation are contained in a <code>times</code>
attribute, which is an object of class <code>"POSIXct"</code> (see
<code><a href="base.html#topic+DateTimeClasses">DateTimeClasses</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sp.raw)</code></pre>


<h3>Format</h3>

<p>A numeric vector containing 8415 observations, with a
<code>times</code> attribute which is a <code>POSIXct</code> object
of the same length.</p>

<hr>
<h2 id='spto87'>SP Return Data to October 1987</h2><span id='topic+spto87'></span>

<h3>Description</h3>

<p>The daily log returns on the S&amp;P index value from
Tuesday 5th January 1960 until Friday 16 October 1987.
The data are contained in a numeric vector.
The dates of each observation are contained in a <code>times</code>
attribute, which is an object of class <code>"POSIXct"</code> (see
<code><a href="base.html#topic+DateTimeClasses">DateTimeClasses</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(spto87)</code></pre>


<h3>Format</h3>

<p>A numeric vector containing 6985 observations, with a
<code>times</code> attribute which is a <code>POSIXct</code> object
of the same length.</p>

<hr>
<h2 id='tailplot'>Plot Tail Estimate From GPD Model</h2><span id='topic+tailplot'></span>

<h3>Description</h3>

<p>Interacts with the output of gpd to produce a plot of the tail
of the underlying distribution of the data.
This is one of the options of <code>plot.gpd</code>, but tailplot enables
the user to bypass the menu of the former. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tailplot(x, optlog = NA, extend = 1.5, labels = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tailplot_+3A_x">x</code></td>
<td>
<p>a <code>gpd</code> object</p>
</td></tr>
<tr><td><code id="tailplot_+3A_optlog">optlog</code></td>
<td>
<p>optional argument giving a particular choice
of logarithmic axes: <code>"x"</code> x-axis only; <code>"y"</code>
y-axis only; <code>"xy"</code> both axes; <code>""</code> neither axis.</p>
</td></tr>
<tr><td><code id="tailplot_+3A_extend">extend</code></td>
<td>
<p>optional argument expressing how far x-axis should
extend as a multiple of the largest data value. This argument
must take values greater than 1 and is useful for showing
estimated quantiles beyond data.</p>
</td></tr>
<tr><td><code id="tailplot_+3A_labels">labels</code></td>
<td>
<p>optional argument specifying whether or not axes
should be labelled</p>
</td></tr>
<tr><td><code id="tailplot_+3A_...">...</code></td>
<td>
<p>other graphics parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object containing details of the plot is returned invisibly.
This object should be used as the first argument of <code>gpd.q</code>
or <code>gpd.sfall</code> to add quantile estimates or expected shortfall
estimates to the plot.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gpd">gpd</a></code>, <code><a href="#topic+plot.gpd">plot.gpd</a></code>,
<code><a href="#topic+shape">shape</a></code>, <code><a href="#topic+quant">quant</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(danish)
out &lt;- gpd(danish, 10) 
## Not run: tailplot(out) 
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
