<!DOCTYPE html><html><head><title>Help for package gtfstools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gtfstools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#convert_from_standard'><p>Convert a standards-compliant GTFS into a gtfstools' GTFS</p></a></li>
<li><a href='#convert_shapes_to_sf'><p>Convert <code>shapes</code> table to simple feature object</p></a></li>
<li><a href='#convert_stops_to_sf'><p>Convert <code>stops</code> table to simple feature object</p></a></li>
<li><a href='#convert_time_to_seconds'><p>Convert time fields to seconds after midnight</p></a></li>
<li><a href='#convert_to_standard'><p>Convert a gtfstools' GTFS into a standards-compliant GTFS</p></a></li>
<li><a href='#copy_gtfs_diff_field_class'><p>Make a GTFS copy with a field of a different class</p></a></li>
<li><a href='#copy_gtfs_without_field'><p>Make a GTFS copy without a given field from a given file</p></a></li>
<li><a href='#copy_gtfs_without_file'><p>Make a GTFS copy without a given file</p></a></li>
<li><a href='#date_to_integer'><p>Convert a Date vector into an integer vector</p></a></li>
<li><a href='#download_validator'><p>Download MobilityData's GTFS validator</p></a></li>
<li><a href='#filter_by_agency_id'><p>Filter GTFS object by <code>agency_id</code></p></a></li>
<li><a href='#filter_by_route_id'><p>Filter GTFS object by <code>route_id</code></p></a></li>
<li><a href='#filter_by_route_type'><p>Filter GTFS object by <code>route_type</code> (transport mode)</p></a></li>
<li><a href='#filter_by_service_id'><p>Filter GTFS object by <code>service_id</code></p></a></li>
<li><a href='#filter_by_sf'><p>Filter a GTFS object using a <code style="white-space: pre;">&#8288;simple features&#8288;</code> object</p></a></li>
<li><a href='#filter_by_shape_id'><p>Filter GTFS object by <code>shape_id</code></p></a></li>
<li><a href='#filter_by_stop_id'><p>Filter GTFS object by <code>stop_id</code></p></a></li>
<li><a href='#filter_by_time_of_day'><p>Filter GTFS object by time of day</p></a></li>
<li><a href='#filter_by_trip_id'><p>Filter GTFS object by <code>trip_id</code></p></a></li>
<li><a href='#filter_by_weekday'><p>Filter GTFS object by weekday</p></a></li>
<li><a href='#frequencies_to_stop_times'><p>Convert frequencies to stop times</p></a></li>
<li><a href='#get_children_stops'><p>Get children stops recursively</p></a></li>
<li><a href='#get_parent_station'><p>Get parent stations recursively</p></a></li>
<li><a href='#get_stop_times_patterns'><p>Get stop times patterns</p></a></li>
<li><a href='#get_trip_duration'><p>Get trip duration</p></a></li>
<li><a href='#get_trip_geometry'><p>Get trip geometry</p></a></li>
<li><a href='#get_trip_length'><p>Get trip length</p></a></li>
<li><a href='#get_trip_segment_duration'><p>Get trip segments' duration</p></a></li>
<li><a href='#get_trip_speed'><p>Get trip speed</p></a></li>
<li><a href='#gtfstools'><p>gtfstools: General Transit Feed Specification (GTFS) Editing and Analysing</p>
Tools</a></li>
<li><a href='#integer_to_date'><p>Convert an integer vector into a Date vector</p></a></li>
<li><a href='#merge_gtfs'><p>Merge GTFS files</p></a></li>
<li><a href='#read_gtfs'><p>Read GTFS files</p></a></li>
<li><a href='#remove_duplicates'><p>Remove duplicated entries</p></a></li>
<li><a href='#seconds_to_string'><p>Convert seconds after midnight to time string</p></a></li>
<li><a href='#set_trip_speed'><p>Set trip average speed</p></a></li>
<li><a href='#string_to_seconds'><p>Convert time string to seconds after midnight</p></a></li>
<li><a href='#validate_gtfs'><p>Validate GTFS feed</p></a></li>
<li><a href='#write_gtfs'><p>Write GTFS files</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>General Transit Feed Specification (GTFS) Editing and Analysing
Tools</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Utility functions to read, manipulate, analyse and write
    transit feeds in the General Transit Feed Specification (GTFS) data
    format.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://ipeagit.github.io/gtfstools/">https://ipeagit.github.io/gtfstools/</a>,
<a href="https://github.com/ipeaGIT/gtfstools">https://github.com/ipeaGIT/gtfstools</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ipeaGIT/gtfstools/issues">https://github.com/ipeaGIT/gtfstools/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>checkmate, curl, data.table, gtfsio (&ge; 1.0.0), processx, sf,
sfheaders, units, utils, zip</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, ggplot2, jsonlite, knitr, rmarkdown, testthat,</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>cpp11</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-24 12:47:53 UTC; dhersz</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel Herszenhut <a href="https://orcid.org/0000-0001-8066-1105"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Rafael H. M. Pereira
    <a href="https://orcid.org/0000-0003-2125-7465"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Pedro R. Andrade <a href="https://orcid.org/0000-0001-8675-4046"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Joao Bazzo <a href="https://orcid.org/0000-0003-4536-5006"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Mark Padgham [ctb],
  Marcus Saraiva <a href="https://orcid.org/0000-0001-6218-2338"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Ipea - Institute for Applied Economic Research [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel Herszenhut &lt;dhersz@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-24 13:10:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='convert_from_standard'>Convert a standards-compliant GTFS into a gtfstools' GTFS</h2><span id='topic+convert_from_standard'></span>

<h3>Description</h3>

<p>Converts a standards-compliant GTFS into a gtfstools' GTFS (i.e. one in which
date fields are Date objects, not integers).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_from_standard(gtfs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_from_standard_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The GTFS object passed to the <code>gtfs</code> parameter, after converting the
relevant fields.
</p>

<hr>
<h2 id='convert_shapes_to_sf'>Convert <code>shapes</code> table to simple feature object</h2><span id='topic+convert_shapes_to_sf'></span>

<h3>Description</h3>

<p>Converts the <code>shapes</code> table to a <code style="white-space: pre;">&#8288;LINESTRING sf&#8288;</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_shapes_to_sf(gtfs, shape_id = NULL, crs = 4326)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_shapes_to_sf_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="convert_shapes_to_sf_+3A_shape_id">shape_id</code></td>
<td>
<p>A character vector including the <code>shape_id</code>s to be converted.
If <code>NULL</code> (the default), all shapes are converted.</p>
</td></tr>
<tr><td><code id="convert_shapes_to_sf_+3A_crs">crs</code></td>
<td>
<p>The CRS of the resulting object, either as an EPSG code or as an
<code>crs</code> object. Defaults to 4326 (WGS 84).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;LINESTRING sf&#8288;</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># read gtfs
data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")
gtfs &lt;- read_gtfs(data_path)

shapes_sf &lt;- convert_shapes_to_sf(gtfs)
head(shapes_sf)

shapes_sf &lt;- convert_shapes_to_sf(gtfs, shape_id = "17846")
shapes_sf

</code></pre>

<hr>
<h2 id='convert_stops_to_sf'>Convert <code>stops</code> table to simple feature object</h2><span id='topic+convert_stops_to_sf'></span>

<h3>Description</h3>

<p>Converts the <code>stops</code> table to a <code style="white-space: pre;">&#8288;POINT sf&#8288;</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_stops_to_sf(gtfs, stop_id = NULL, crs = 4326)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_stops_to_sf_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="convert_stops_to_sf_+3A_stop_id">stop_id</code></td>
<td>
<p>A character vector including the <code>stop_id</code>s to be converted.
If <code>NULL</code> (the default), all stops are converted.</p>
</td></tr>
<tr><td><code id="convert_stops_to_sf_+3A_crs">crs</code></td>
<td>
<p>The CRS of the resulting object, either as an EPSG code or as an
<code>crs</code> object. Defaults to 4326 (WGS 84).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;POINT sf&#8288;</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># read gtfs
data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")
gtfs &lt;- read_gtfs(data_path)

stops_sf &lt;- convert_stops_to_sf(gtfs)
head(stops_sf)

stops_sf &lt;- convert_stops_to_sf(gtfs, stop_id = "18848")
stops_sf

</code></pre>

<hr>
<h2 id='convert_time_to_seconds'>Convert time fields to seconds after midnight</h2><span id='topic+convert_time_to_seconds'></span>

<h3>Description</h3>

<p>Converts <code>stop_times</code>' and <code>frequencies</code>' fields in the &quot;HH:MM:SS&quot; format to
seconds after midnight. Instead of overwritting the existing fields, creates
new fields with the <code style="white-space: pre;">&#8288;_secs&#8288;</code> suffix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_time_to_seconds(gtfs, file = NULL, by_reference = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_time_to_seconds_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="convert_time_to_seconds_+3A_file">file</code></td>
<td>
<p>A character vector, specifying the file whose fields should be
converted. If <code>NULL</code> (the default), the function attempts to convert the
times from both files, but only raises an error if none of them exist.</p>
</td></tr>
<tr><td><code id="convert_time_to_seconds_+3A_by_reference">by_reference</code></td>
<td>
<p>Whether to update the tables by reference. Defaults to
<code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>by_reference</code> is <code>FALSE</code>, returns a GTFS object with additional
time in seconds columns (identified by a <code style="white-space: pre;">&#8288;_secs&#8288;</code> suffix). Else, returns a
GTFS object invisibly (please note that in such case the original GTFS object
is altered).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")

gtfs &lt;- read_gtfs(data_path)

# by default converts both 'stop_times' and 'frequencies' times
converted_gtfs &lt;- convert_time_to_seconds(gtfs)
head(converted_gtfs$stop_times)
head(converted_gtfs$frequencies)

# choose which table to convert with 'file'
converted_gtfs &lt;- convert_time_to_seconds(gtfs, file = "frequencies")
head(converted_gtfs$stop_times)
head(converted_gtfs$frequencies)

# original gtfs remained unchanged, as seen with the frequencies table above
# change original object without creating a copy with 'by_reference = TRUE'
convert_time_to_seconds(gtfs, by_reference = TRUE)
head(gtfs$stop_times)
head(gtfs$frequencies)

</code></pre>

<hr>
<h2 id='convert_to_standard'>Convert a gtfstools' GTFS into a standards-compliant GTFS</h2><span id='topic+convert_to_standard'></span>

<h3>Description</h3>

<p>Converts a gtfstools' GTFS into a standards-compliant GTFS (i.e. date fields
are converted from Date to integer).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_to_standard(gtfs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_to_standard_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The GTFS object passed to the <code>gtfs</code> parameter, after converting the
relevant fields.
</p>

<hr>
<h2 id='copy_gtfs_diff_field_class'>Make a GTFS copy with a field of a different class</h2><span id='topic+copy_gtfs_diff_field_class'></span>

<h3>Description</h3>

<p>Creates a copy of a GTFS object while changing the class of a given field.
Used for testing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>copy_gtfs_diff_field_class(gtfs, file, field, class)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="copy_gtfs_diff_field_class_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="copy_gtfs_diff_field_class_+3A_file">file</code></td>
<td>
<p>File whose field must have the class changed.</p>
</td></tr>
<tr><td><code id="copy_gtfs_diff_field_class_+3A_field">field</code></td>
<td>
<p>Field to have the class changed.</p>
</td></tr>
<tr><td><code id="copy_gtfs_diff_field_class_+3A_class">class</code></td>
<td>
<p>The desired class.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A GTFS object with the field of desired class.
</p>

<hr>
<h2 id='copy_gtfs_without_field'>Make a GTFS copy without a given field from a given file</h2><span id='topic+copy_gtfs_without_field'></span>

<h3>Description</h3>

<p>Creates a copy of a GTFS object without a given field from a given file. Used
for testing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>copy_gtfs_without_field(gtfs, file, field)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="copy_gtfs_without_field_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="copy_gtfs_without_field_+3A_file">file</code></td>
<td>
<p>File from which the field must be removed.</p>
</td></tr>
<tr><td><code id="copy_gtfs_without_field_+3A_field">field</code></td>
<td>
<p>Field to be removed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A GTFS object without the given field.
</p>

<hr>
<h2 id='copy_gtfs_without_file'>Make a GTFS copy without a given file</h2><span id='topic+copy_gtfs_without_file'></span>

<h3>Description</h3>

<p>Creates a copy of a GTFS object without a given file. Used for testing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>copy_gtfs_without_file(gtfs, file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="copy_gtfs_without_file_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="copy_gtfs_without_file_+3A_file">file</code></td>
<td>
<p>File to be removed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A GTFS object without the given file.
</p>

<hr>
<h2 id='date_to_integer'>Convert a Date vector into an integer vector</h2><span id='topic+date_to_integer'></span>

<h3>Description</h3>

<p>Convert a Date vector into an integer vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>date_to_integer(field)
</code></pre>

<hr>
<h2 id='download_validator'>Download MobilityData's GTFS validator</h2><span id='topic+download_validator'></span>

<h3>Description</h3>

<p>Downloads MobilityData's command line tool to validate GTFS feeds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_validator(path, version = "latest", force = FALSE, quiet = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="download_validator_+3A_path">path</code></td>
<td>
<p>A string. The directory where the validator should be saved to.</p>
</td></tr>
<tr><td><code id="download_validator_+3A_version">version</code></td>
<td>
<p>A string. The version of the validator that should be
downloaded. Defaults to <code>"latest"</code>, but accepts version numbers as strings
(i.e. to download version v4.0.0 please enter <code>"4.0.0"</code>). Please check
<a href="https://github.com/MobilityData/gtfs-validator/releases">MobilityData/gtfs-validator releases</a> for the
full set of available versions.</p>
</td></tr>
<tr><td><code id="download_validator_+3A_force">force</code></td>
<td>
<p>A logical. Whether to overwrite a previously downloaded
validator in <code>path</code>. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="download_validator_+3A_quiet">quiet</code></td>
<td>
<p>A logical. Whether to hide log messages and progress bars.
Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns the normalized path to the downloaded validator.
</p>


<h3>See Also</h3>

<p>Other validation: 
<code><a href="#topic+validate_gtfs">validate_gtfs</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
path &lt;- tempdir()

download_validator(path)

# specifying a specific version
download_validator(path, version = "4.0.0")

</code></pre>

<hr>
<h2 id='filter_by_agency_id'>Filter GTFS object by <code>agency_id</code></h2><span id='topic+filter_by_agency_id'></span>

<h3>Description</h3>

<p>Filters a GTFS object by <code>agency_id</code>s, keeping (or dropping) the relevant
entries in each file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_by_agency_id(gtfs, agency_id, keep = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_by_agency_id_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="filter_by_agency_id_+3A_agency_id">agency_id</code></td>
<td>
<p>A character vector. The <code>agency_id</code>s used to filter the
data.</p>
</td></tr>
<tr><td><code id="filter_by_agency_id_+3A_keep">keep</code></td>
<td>
<p>A logical. Whether the entries related to the specified
<code>agency_id</code>s should be kept or dropped (defaults to <code>TRUE</code>, which keeps the
entries).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The GTFS object passed to the <code>gtfs</code> parameter, after the filtering
process.
</p>


<h3>See Also</h3>

<p>Other filtering functions: 
<code><a href="#topic+filter_by_route_id">filter_by_route_id</a>()</code>,
<code><a href="#topic+filter_by_route_type">filter_by_route_type</a>()</code>,
<code><a href="#topic+filter_by_service_id">filter_by_service_id</a>()</code>,
<code><a href="#topic+filter_by_sf">filter_by_sf</a>()</code>,
<code><a href="#topic+filter_by_shape_id">filter_by_shape_id</a>()</code>,
<code><a href="#topic+filter_by_stop_id">filter_by_stop_id</a>()</code>,
<code><a href="#topic+filter_by_time_of_day">filter_by_time_of_day</a>()</code>,
<code><a href="#topic+filter_by_trip_id">filter_by_trip_id</a>()</code>,
<code><a href="#topic+filter_by_weekday">filter_by_weekday</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/ber_gtfs.zip", package = "gtfstools")
gtfs &lt;- read_gtfs(data_path)
agency_id &lt;- "92"

object.size(gtfs)

# keeps entries related to passed agency_id
smaller_gtfs &lt;- filter_by_agency_id(gtfs, agency_id)
object.size(smaller_gtfs)

# drops entries related to passed agency_id
smaller_gtfs &lt;- filter_by_agency_id(gtfs, agency_id, keep = FALSE)
object.size(smaller_gtfs)

</code></pre>

<hr>
<h2 id='filter_by_route_id'>Filter GTFS object by <code>route_id</code></h2><span id='topic+filter_by_route_id'></span>

<h3>Description</h3>

<p>Filters a GTFS object by <code>route_id</code>s, keeping (or dropping) the relevant
entries in each file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_by_route_id(gtfs, route_id, keep = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_by_route_id_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="filter_by_route_id_+3A_route_id">route_id</code></td>
<td>
<p>A character vector. The <code>route_id</code>s used to filter the data.</p>
</td></tr>
<tr><td><code id="filter_by_route_id_+3A_keep">keep</code></td>
<td>
<p>A logical. Whether the entries related to the specified
<code>route_id</code>s should be kept or dropped (defaults to <code>TRUE</code>, which keeps the
entries).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The GTFS object passed to the <code>gtfs</code> parameter, after the filtering
process.
</p>


<h3>See Also</h3>

<p>Other filtering functions: 
<code><a href="#topic+filter_by_agency_id">filter_by_agency_id</a>()</code>,
<code><a href="#topic+filter_by_route_type">filter_by_route_type</a>()</code>,
<code><a href="#topic+filter_by_service_id">filter_by_service_id</a>()</code>,
<code><a href="#topic+filter_by_sf">filter_by_sf</a>()</code>,
<code><a href="#topic+filter_by_shape_id">filter_by_shape_id</a>()</code>,
<code><a href="#topic+filter_by_stop_id">filter_by_stop_id</a>()</code>,
<code><a href="#topic+filter_by_time_of_day">filter_by_time_of_day</a>()</code>,
<code><a href="#topic+filter_by_trip_id">filter_by_trip_id</a>()</code>,
<code><a href="#topic+filter_by_weekday">filter_by_weekday</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")
gtfs &lt;- read_gtfs(data_path)
route_ids &lt;- c("6450-51", "CPTM L11")

object.size(gtfs)

# keeps entries related to passed route_ids
smaller_gtfs &lt;- filter_by_route_id(gtfs, route_ids)
object.size(smaller_gtfs)

# drops entries related to passed route_ids
smaller_gtfs &lt;- filter_by_route_id(gtfs, route_ids, keep = FALSE)
object.size(smaller_gtfs)

</code></pre>

<hr>
<h2 id='filter_by_route_type'>Filter GTFS object by <code>route_type</code> (transport mode)</h2><span id='topic+filter_by_route_type'></span>

<h3>Description</h3>

<p>Filters a GTFS object by <code>route_type</code>s, keeping (or dropping) the relevant
entries in each file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_by_route_type(gtfs, route_type, keep = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_by_route_type_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="filter_by_route_type_+3A_route_type">route_type</code></td>
<td>
<p>An integer vector. The <code>route_type</code>s used to filter the
data.</p>
</td></tr>
<tr><td><code id="filter_by_route_type_+3A_keep">keep</code></td>
<td>
<p>A logical. Whether the entries related to the specified
<code>route_type</code>s should be kept or dropped (defaults to <code>TRUE</code>, which keeps
the entries).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The GTFS object passed to the <code>gtfs</code> parameter, after the filtering
process.
</p>


<h3>Route types</h3>

<p>Valid options are:
</p>

<ul>
<li><p> 0 - Tram, Streetcar, Light rail. Any light rail or street level system
within a metropolitan area.
</p>
</li>
<li><p> 1 - Subway, Metro. Any underground rail system within a metropolitan area.
</p>
</li>
<li><p> 2 - Rail. Used for intercity or long-distance travel.
</p>
</li>
<li><p> 3 - Bus. Used for short- and long-distance bus routes.
</p>
</li>
<li><p> 4 - Ferry. Used for short- and long-distance boat service.
</p>
</li>
<li><p> 5 - Cable tram. Used for street-level rail cars where the cable runs
beneath the vehicle, e.g., cable car in San Francisco.
</p>
</li>
<li><p> 6 - Aerial lift, suspended cable car (e.g., gondola lift, aerial tramway).
Cable transport where cabins, cars, gondolas or open chairs are suspended by
means of one or more cables.
</p>
</li>
<li><p> 7 - Funicular. Any rail system designed for steep inclines.
</p>
</li>
<li><p> 11 - Trolleybus. Electric buses that draw power from overhead wires using
poles.
</p>
</li>
<li><p> 12 - Monorail. Railway in which the track consists of a single rail or a
beam.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other filtering functions: 
<code><a href="#topic+filter_by_agency_id">filter_by_agency_id</a>()</code>,
<code><a href="#topic+filter_by_route_id">filter_by_route_id</a>()</code>,
<code><a href="#topic+filter_by_service_id">filter_by_service_id</a>()</code>,
<code><a href="#topic+filter_by_sf">filter_by_sf</a>()</code>,
<code><a href="#topic+filter_by_shape_id">filter_by_shape_id</a>()</code>,
<code><a href="#topic+filter_by_stop_id">filter_by_stop_id</a>()</code>,
<code><a href="#topic+filter_by_time_of_day">filter_by_time_of_day</a>()</code>,
<code><a href="#topic+filter_by_trip_id">filter_by_trip_id</a>()</code>,
<code><a href="#topic+filter_by_weekday">filter_by_weekday</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># read gtfs
data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")
gtfs &lt;- read_gtfs(data_path)

object.size(gtfs)

# keeps entries related to passed route_types
smaller_gtfs &lt;- filter_by_route_type(gtfs, route_type = 1)
object.size(smaller_gtfs)

# drops entries related to passed route_types
smaller_gtfs &lt;- filter_by_route_type(gtfs, route_type = 1, keep = FALSE)
object.size(smaller_gtfs)

</code></pre>

<hr>
<h2 id='filter_by_service_id'>Filter GTFS object by <code>service_id</code></h2><span id='topic+filter_by_service_id'></span>

<h3>Description</h3>

<p>Filters a GTFS object by <code>service_id</code>s, keeping (or dropping) the relevant
entries in each file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_by_service_id(gtfs, service_id, keep = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_by_service_id_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="filter_by_service_id_+3A_service_id">service_id</code></td>
<td>
<p>A character vector. The <code>service_id</code>s used to filter the
data.</p>
</td></tr>
<tr><td><code id="filter_by_service_id_+3A_keep">keep</code></td>
<td>
<p>A logical. Whether the entries related to the specified
<code>service_id</code>s should be kept or dropped (defaults to <code>TRUE</code>, which keeps the
entries).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The GTFS object passed to the <code>gtfs</code> parameter, after the filtering
process.
</p>


<h3>See Also</h3>

<p>Other filtering functions: 
<code><a href="#topic+filter_by_agency_id">filter_by_agency_id</a>()</code>,
<code><a href="#topic+filter_by_route_id">filter_by_route_id</a>()</code>,
<code><a href="#topic+filter_by_route_type">filter_by_route_type</a>()</code>,
<code><a href="#topic+filter_by_sf">filter_by_sf</a>()</code>,
<code><a href="#topic+filter_by_shape_id">filter_by_shape_id</a>()</code>,
<code><a href="#topic+filter_by_stop_id">filter_by_stop_id</a>()</code>,
<code><a href="#topic+filter_by_time_of_day">filter_by_time_of_day</a>()</code>,
<code><a href="#topic+filter_by_trip_id">filter_by_trip_id</a>()</code>,
<code><a href="#topic+filter_by_weekday">filter_by_weekday</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")
gtfs &lt;- read_gtfs(data_path)
service_ids &lt;- c("USD", "U__")

object.size(gtfs)

# keeps entries related to the specified service_ids
smaller_gtfs &lt;- filter_by_service_id(gtfs, service_ids)
object.size(smaller_gtfs)

# drops entries related to the specified service_ids
smaller_gtfs &lt;- filter_by_service_id(gtfs, service_ids, keep = FALSE)
object.size(smaller_gtfs)

</code></pre>

<hr>
<h2 id='filter_by_sf'>Filter a GTFS object using a <code style="white-space: pre;">&#8288;simple features&#8288;</code> object</h2><span id='topic+filter_by_sf'></span>

<h3>Description</h3>

<p>Filters a GTFS object using the geometry of an <code>sf</code> object, keeping (or
dropping) entries related to shapes and trips selected through a spatial
operation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_by_sf(gtfs, geom, spatial_operation = sf::st_intersects, keep = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_by_sf_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="filter_by_sf_+3A_geom">geom</code></td>
<td>
<p>An <code>sf</code> object. Describes the geometry used to filter the data.</p>
</td></tr>
<tr><td><code id="filter_by_sf_+3A_spatial_operation">spatial_operation</code></td>
<td>
<p>A spatial operation function from the set of
options listed in <a href="sf.html#topic+geos_binary_pred">geos_binary_pred</a> (check the
<a href="https://en.wikipedia.org/wiki/DE-9IM">DE-I9M</a> Wikipedia entry for the
definition of each function). Defaults to <code>sf::st_intersects</code>, which tests
if the shapes and trips have ANY intersection with the object specified in
<code>geom</code>. Please note that <code>geom</code> is passed as the <code>x</code> argument of these
functions.</p>
</td></tr>
<tr><td><code id="filter_by_sf_+3A_keep">keep</code></td>
<td>
<p>A logical. Whether the entries related to the shapes and trips
that cross through the given geometry should be kept or dropped (defaults
to <code>TRUE</code>, which keeps the entries).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The GTFS object passed to the <code>gtfs</code> parameter, after the filtering
process.
</p>


<h3>See Also</h3>

<p>Other filtering functions: 
<code><a href="#topic+filter_by_agency_id">filter_by_agency_id</a>()</code>,
<code><a href="#topic+filter_by_route_id">filter_by_route_id</a>()</code>,
<code><a href="#topic+filter_by_route_type">filter_by_route_type</a>()</code>,
<code><a href="#topic+filter_by_service_id">filter_by_service_id</a>()</code>,
<code><a href="#topic+filter_by_shape_id">filter_by_shape_id</a>()</code>,
<code><a href="#topic+filter_by_stop_id">filter_by_stop_id</a>()</code>,
<code><a href="#topic+filter_by_time_of_day">filter_by_time_of_day</a>()</code>,
<code><a href="#topic+filter_by_trip_id">filter_by_trip_id</a>()</code>,
<code><a href="#topic+filter_by_weekday">filter_by_weekday</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")
gtfs &lt;- read_gtfs(data_path)

shape_id &lt;- "68962"
shape_sf &lt;- convert_shapes_to_sf(gtfs, shape_id)
bbox &lt;- sf::st_bbox(shape_sf)
object.size(gtfs)

# keeps entries that intersect with the specified polygon
smaller_gtfs &lt;- filter_by_sf(gtfs, bbox)
object.size(smaller_gtfs)

# drops entries that intersect with the specified polygon
smaller_gtfs &lt;- filter_by_sf(gtfs, bbox, keep = FALSE)
object.size(smaller_gtfs)

# uses a different function to filter the gtfs
smaller_gtfs &lt;- filter_by_sf(gtfs, bbox, spatial_operation = sf::st_contains)
object.size(smaller_gtfs)

</code></pre>

<hr>
<h2 id='filter_by_shape_id'>Filter GTFS object by <code>shape_id</code></h2><span id='topic+filter_by_shape_id'></span>

<h3>Description</h3>

<p>Filters a GTFS object by <code>shape_id</code>s, keeping (or dropping) the relevant
entries in each file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_by_shape_id(gtfs, shape_id, keep = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_by_shape_id_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="filter_by_shape_id_+3A_shape_id">shape_id</code></td>
<td>
<p>A character vector. The <code>shape_id</code>s used to filter the data.</p>
</td></tr>
<tr><td><code id="filter_by_shape_id_+3A_keep">keep</code></td>
<td>
<p>A logical. Whether the entries related to the specified
<code>shape_id</code>s should be kept or dropped (defaults to <code>TRUE</code>, which keeps the
entries).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The GTFS object passed to the <code>gtfs</code> parameter, after the filtering
process.
</p>


<h3>See Also</h3>

<p>Other filtering functions: 
<code><a href="#topic+filter_by_agency_id">filter_by_agency_id</a>()</code>,
<code><a href="#topic+filter_by_route_id">filter_by_route_id</a>()</code>,
<code><a href="#topic+filter_by_route_type">filter_by_route_type</a>()</code>,
<code><a href="#topic+filter_by_service_id">filter_by_service_id</a>()</code>,
<code><a href="#topic+filter_by_sf">filter_by_sf</a>()</code>,
<code><a href="#topic+filter_by_stop_id">filter_by_stop_id</a>()</code>,
<code><a href="#topic+filter_by_time_of_day">filter_by_time_of_day</a>()</code>,
<code><a href="#topic+filter_by_trip_id">filter_by_trip_id</a>()</code>,
<code><a href="#topic+filter_by_weekday">filter_by_weekday</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")
gtfs &lt;- read_gtfs(data_path)
shape_ids &lt;- c("17846", "68962")

object.size(gtfs)

# keeps entries related to passed shape_ids
smaller_gtfs &lt;- filter_by_shape_id(gtfs, shape_ids)
object.size(smaller_gtfs)

# drops entries related to passed shape_ids
smaller_gtfs &lt;- filter_by_shape_id(gtfs, shape_ids, keep = FALSE)
object.size(smaller_gtfs)

</code></pre>

<hr>
<h2 id='filter_by_stop_id'>Filter GTFS object by <code>stop_id</code></h2><span id='topic+filter_by_stop_id'></span>

<h3>Description</h3>

<p>Filters a GTFS object by <code>stop_id</code>s, keeping (or dropping) relevant entries
in each file. In order to keep the integrity of trips as described in the
<code>stop_times</code> table, the <code>stop_id</code>s are actually used to filter <code>trip_id</code>s,
which are then used to filter the rest of the GTFS object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_by_stop_id(gtfs, stop_id, keep = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_by_stop_id_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="filter_by_stop_id_+3A_stop_id">stop_id</code></td>
<td>
<p>A character vector. The <code>stop_id</code>s used to filter the data.</p>
</td></tr>
<tr><td><code id="filter_by_stop_id_+3A_keep">keep</code></td>
<td>
<p>A logical. Whether the entries related to the <code>trip_id</code>s that
passes through the specified <code>stop_id</code>s should be kept or dropped (defaults
to <code>TRUE</code>, which keeps the entries).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The GTFS object passed to the <code>gtfs</code> parameter, after the filtering
process.
</p>


<h3>See Also</h3>

<p>Other filtering functions: 
<code><a href="#topic+filter_by_agency_id">filter_by_agency_id</a>()</code>,
<code><a href="#topic+filter_by_route_id">filter_by_route_id</a>()</code>,
<code><a href="#topic+filter_by_route_type">filter_by_route_type</a>()</code>,
<code><a href="#topic+filter_by_service_id">filter_by_service_id</a>()</code>,
<code><a href="#topic+filter_by_sf">filter_by_sf</a>()</code>,
<code><a href="#topic+filter_by_shape_id">filter_by_shape_id</a>()</code>,
<code><a href="#topic+filter_by_time_of_day">filter_by_time_of_day</a>()</code>,
<code><a href="#topic+filter_by_trip_id">filter_by_trip_id</a>()</code>,
<code><a href="#topic+filter_by_weekday">filter_by_weekday</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")
gtfs &lt;- read_gtfs(data_path)
stop_ids &lt;- c("18848", "940004157")

object.size(gtfs)

# keeps entries related to trips that pass through specified stop_ids
smaller_gtfs &lt;- filter_by_stop_id(gtfs, stop_ids)
object.size(smaller_gtfs)

# drops entries related to trips that pass through specified stop_ids
smaller_gtfs &lt;- filter_by_stop_id(gtfs, stop_ids, keep = FALSE)
object.size(smaller_gtfs)

</code></pre>

<hr>
<h2 id='filter_by_time_of_day'>Filter GTFS object by time of day</h2><span id='topic+filter_by_time_of_day'></span>

<h3>Description</h3>

<p>Filters a GTFS object by time of day, keeping (or dropping) the relevant
entries in each file. Please see the details section for more information on
how this function filters the <code>frequencies</code> and <code>stop_times</code> tables, as well
as how it handles <code>stop_times</code> tables that contain trips with some empty
departure and arrival times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_by_time_of_day(
  gtfs,
  from,
  to,
  keep = TRUE,
  full_trips = FALSE,
  update_frequencies = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_by_time_of_day_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="filter_by_time_of_day_+3A_from">from</code></td>
<td>
<p>A string. The starting point of the time of day, in the
&quot;HH:MM:SS&quot; format.</p>
</td></tr>
<tr><td><code id="filter_by_time_of_day_+3A_to">to</code></td>
<td>
<p>A string. The ending point of the time of day, in the &quot;HH:MM:SS&quot;
format.</p>
</td></tr>
<tr><td><code id="filter_by_time_of_day_+3A_keep">keep</code></td>
<td>
<p>A logical. Whether the entries related to the specified time of
day should be kept or dropped (defaults to <code>TRUE</code>, which keeps the entries).</p>
</td></tr>
<tr><td><code id="filter_by_time_of_day_+3A_full_trips">full_trips</code></td>
<td>
<p>A logical. Whether trips should be treated as immutable
blocks or each of its stops should be considered separately when filtering
the <code>stop_times</code> table (defaults to <code>FALSE</code>, which considers each stop
individually). Please check the details section for more information on how
this parameter changes the function behaviour.</p>
</td></tr>
<tr><td><code id="filter_by_time_of_day_+3A_update_frequencies">update_frequencies</code></td>
<td>
<p>A logical. Whether the <code>frequencies</code> table should
have its <code>start_time</code> and <code>end_time</code> fields updated to fit inside/outside the
specified time of day (defaults to <code>FALSE</code>, which doesn't update the fields).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The GTFS object passed to the <code>gtfs</code> parameter, after the filtering
process.
</p>


<h3>Details</h3>

<p>When filtering the <code>frequencies</code> table, <code>filter_by_time_of_day()</code> respects
the <code>exact_times</code> field. This field indicates whether the service follows a
fixed schedule throughout the day or not. If it's 0 (or if it's not
present), the service does not follow a fixed schedule. Instead, the
operators try to maintain the listed headways. In such cases, if
<code>update_frequencies</code> is <code>TRUE</code> we just update <code>start_time</code> and <code>end_time</code> to
the appropriate value of <code>from</code> or <code>to</code> (which of this value is used depends
on <code>keep</code>).
</p>
<p>If <code>exact_times</code> is 1, however, operators try to strictly adhere to the start
times and headway. As a result, when updating the <code>start_time</code> field we need
to follow the listed headway. For example, take a trip that has its start
time listed as 06:00:00, its end time listed as 08:00:00 and its headway
listed as 300 secs (5 minutes). If you decide to filter the feed to keep the
time of day between 06:32:00 and 08:00:00 while updating <code>frequencies</code>, the
<code>start_time</code> field must be updated to 06:35:00 in order to preserve the
correct departure times of this trips, instead of simply updating it to
06:32:00.
</p>
<p>Another things to keep an eye on when filtering the <code>frequencies</code> table is
that the corresponding <code>stop_times</code> entries of trips listed in the
<code>frequencies</code> table should not be filtered, even if their departure and
arrival times fall outside the specified time of day. This is because the
<code>stop_times</code> entries of <code>frequencies</code>' trips are just templates that describe
how long a segment between two stops takes, so the departure and arrival
times listed there do not actually represent the actual departure and
arrival times seen in practice. Taking the same example listed above, the
corresponding <code>stop_times</code> entries of that trip could describe a departure
from the first stop at 12:00:00 and an arrival at the second stop at
12:03:00. That doesn't mean the trip will actually leave and arrive at the
stops at these times, but rather that it takes 3 minutes to get from the
first to the second stop. So when the trip departs from the first stop at
06:35:00, it will get to the second at 06:38:00.
</p>
<p>When filtering the <code>stop_times</code> table, a few other details should be
observed. First, one could wish to filter a GTFS object in order to keep all
trips that cross a given time of day, whereas others may want to keep only
the specific entries that fall inside the specified time of day. For
example, take a trip that leaves the first stop at 06:30:00, gets to the
second at 06:35:00 and then gets to the third at 06:45:00. When filtering to
keep entire trips that cross the time of day between 06:30:00 and 06:40:00,
all three stops will have to be kept. If, however, you want to keep only the
entries that fall within the specified time of day, only the first two
should be kept. To control such behaviour you need to set the <code>full_trips</code>
parameter. When it's <code>TRUE</code>, the function behaves like the first case, and
when it's <code>FALSE</code>, like the second.
</p>
<p>When using <code>full_trips</code> in conjunction with <code>keep</code>, please note how their
behaviour stack. When both are <code>TRUE</code>, trips are always fully kept. When
<code>keep</code> is <code>FALSE</code>, however, trips are fully dropped, even if some of their
stops are visited outside the specified time of day.
</p>
<p>Finally, please note that many GTFS feeds may contain <code>stop_times</code> entries
with empty departure and arrival times. In such cases, filtering by time of
day with <code>full_trips</code> as <code>FALSE</code> will drop the entries with empty times.
Please set <code>full_trips</code> to <code>TRUE</code> to preserve these entries.
</p>


<h3>See Also</h3>

<p>Other filtering functions: 
<code><a href="#topic+filter_by_agency_id">filter_by_agency_id</a>()</code>,
<code><a href="#topic+filter_by_route_id">filter_by_route_id</a>()</code>,
<code><a href="#topic+filter_by_route_type">filter_by_route_type</a>()</code>,
<code><a href="#topic+filter_by_service_id">filter_by_service_id</a>()</code>,
<code><a href="#topic+filter_by_sf">filter_by_sf</a>()</code>,
<code><a href="#topic+filter_by_shape_id">filter_by_shape_id</a>()</code>,
<code><a href="#topic+filter_by_stop_id">filter_by_stop_id</a>()</code>,
<code><a href="#topic+filter_by_trip_id">filter_by_trip_id</a>()</code>,
<code><a href="#topic+filter_by_weekday">filter_by_weekday</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")
gtfs &lt;- read_gtfs(data_path)

# taking a look at the original frequencies and stop_times
head(gtfs$frequencies)
head(gtfs$stop_times)

smaller_gtfs &lt;- filter_by_time_of_day(gtfs, "05:00:00", "06:00:00")

# filter_by_time_of_day filters the frequencies table but doesn't filter the
# stop_times table because they're just templates
head(smaller_gtfs$frequencies)
head(smaller_gtfs$stop_times)

# frequencies entries can be adjusted using update_frequencies = TRUE
smaller_gtfs &lt;- filter_by_time_of_day(
  gtfs,
  "05:30:00",
  "06:00:00",
  update_frequencies = TRUE
)
head(smaller_gtfs$frequencies)

# when keep = FALSE, the behaviour of the function in general, and of
# update_frequencies in particular, is a bit different
smaller_gtfs &lt;- filter_by_time_of_day(
  gtfs,
  "05:30:00",
  "06:00:00",
  keep = FALSE,
  update_frequencies = TRUE
)
head(smaller_gtfs$frequencies)

# let's remove the frequencies table to check the behaviour of full_trips
gtfs$frequencies &lt;- NULL
smaller_gtfs &lt;- filter_by_time_of_day(
  gtfs,
  "05:30:00",
  "06:00:00"
)
head(smaller_gtfs$stop_times)

smaller_gtfs &lt;- filter_by_time_of_day(
  gtfs,
  "05:30:00",
  "06:00:00",
  full_trips = TRUE
)
head(smaller_gtfs$stop_times)
</code></pre>

<hr>
<h2 id='filter_by_trip_id'>Filter GTFS object by <code>trip_id</code></h2><span id='topic+filter_by_trip_id'></span>

<h3>Description</h3>

<p>Filters a GTFS object by <code>trip_id</code>s, keeping (or dropping) the relevant
entries in each file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_by_trip_id(gtfs, trip_id, keep = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_by_trip_id_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="filter_by_trip_id_+3A_trip_id">trip_id</code></td>
<td>
<p>A character vector. The <code>trip_id</code>s used to filter the data.</p>
</td></tr>
<tr><td><code id="filter_by_trip_id_+3A_keep">keep</code></td>
<td>
<p>A logical. Whether the entries related to the specified
<code>trip_id</code>s should be kept or dropped (defaults to <code>TRUE</code>, which keeps the
entries).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The GTFS object passed to the <code>gtfs</code> parameter, after the filtering
process.
</p>


<h3>See Also</h3>

<p>Other filtering functions: 
<code><a href="#topic+filter_by_agency_id">filter_by_agency_id</a>()</code>,
<code><a href="#topic+filter_by_route_id">filter_by_route_id</a>()</code>,
<code><a href="#topic+filter_by_route_type">filter_by_route_type</a>()</code>,
<code><a href="#topic+filter_by_service_id">filter_by_service_id</a>()</code>,
<code><a href="#topic+filter_by_sf">filter_by_sf</a>()</code>,
<code><a href="#topic+filter_by_shape_id">filter_by_shape_id</a>()</code>,
<code><a href="#topic+filter_by_stop_id">filter_by_stop_id</a>()</code>,
<code><a href="#topic+filter_by_time_of_day">filter_by_time_of_day</a>()</code>,
<code><a href="#topic+filter_by_weekday">filter_by_weekday</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")
gtfs &lt;- read_gtfs(data_path)
trip_ids &lt;- c("CPTM L07-0", "2002-10-0")

object.size(gtfs)

# keeps entries related to passed trip_ids
smaller_gtfs &lt;- filter_by_trip_id(gtfs, trip_ids)
object.size(smaller_gtfs)

# drops entries related to passed trip_ids
smaller_gtfs &lt;- filter_by_trip_id(gtfs, trip_ids, keep = FALSE)
object.size(smaller_gtfs)

</code></pre>

<hr>
<h2 id='filter_by_weekday'>Filter GTFS object by weekday</h2><span id='topic+filter_by_weekday'></span>

<h3>Description</h3>

<p>Filters a GTFS object by weekday, keeping (or dropping) the relevant entries
in each file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_by_weekday(gtfs, weekday, combine = "or", keep = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_by_weekday_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="filter_by_weekday_+3A_weekday">weekday</code></td>
<td>
<p>A character vector. The weekdays used to filter the data.
Possible values are <code>c("monday", "tuesday", "wednesday", "thursday", "friday", "saturday", "sunday")</code>.</p>
</td></tr>
<tr><td><code id="filter_by_weekday_+3A_combine">combine</code></td>
<td>
<p>A string. Specifies which logic operation (OR or AND) should
be used to filter the calendar table when multiple weekdays are specified.
Defaults to <code>"or"</code>. Please check the details and examples sections for more
information on this argument usage.</p>
</td></tr>
<tr><td><code id="filter_by_weekday_+3A_keep">keep</code></td>
<td>
<p>A logical. Whether the entries related to the specified weekdays
should be kept or dropped (defaults to <code>TRUE</code>, which keeps the entries).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The GTFS object passed to the <code>gtfs</code> parameter, after the filtering
process.
</p>


<h3><code>combine</code> usage</h3>

<p>When filtering the calendar table using weekdays, one could reason about the
process in different ways. For example, you may want to keep only services
who run on mondays AND tuesdays. Or you may want to keep services that run
EITHER on mondays OR on tuesdays. The first case is the equivalent of
filtering using the expression <code>monday == 1 &amp; tuesday == 1</code>, while the second
uses <code>monday == 1 | tuesday == 1</code>. You can use the <code>combine</code> argument to
control this behaviour.
</p>
<p>Please note that <code>combine</code> also works together with <code>keep</code>. Using the same
examples listed above, you could either keep the entries related to services
that run on mondays and tuesdays or drop them, depending on the value you
pass to <code>keep</code>.
</p>


<h3>See Also</h3>

<p>Other filtering functions: 
<code><a href="#topic+filter_by_agency_id">filter_by_agency_id</a>()</code>,
<code><a href="#topic+filter_by_route_id">filter_by_route_id</a>()</code>,
<code><a href="#topic+filter_by_route_type">filter_by_route_type</a>()</code>,
<code><a href="#topic+filter_by_service_id">filter_by_service_id</a>()</code>,
<code><a href="#topic+filter_by_sf">filter_by_sf</a>()</code>,
<code><a href="#topic+filter_by_shape_id">filter_by_shape_id</a>()</code>,
<code><a href="#topic+filter_by_stop_id">filter_by_stop_id</a>()</code>,
<code><a href="#topic+filter_by_time_of_day">filter_by_time_of_day</a>()</code>,
<code><a href="#topic+filter_by_trip_id">filter_by_trip_id</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># read gtfs
data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")
gtfs &lt;- read_gtfs(data_path)

object.size(gtfs)

# keeps entries related to services than run EITHER on monday OR on sunday
smaller_gtfs &lt;- filter_by_weekday(gtfs, weekday = c("monday", "sunday"))
smaller_gtfs$calendar[, c("service_id", "monday", "sunday")]
object.size(smaller_gtfs)

# keeps entries related to services than run on monday AND on sunday
smaller_gtfs &lt;- filter_by_weekday(
  gtfs,
  weekday = c("monday", "sunday"),
  combine = "and"
)
smaller_gtfs$calendar[, c("service_id", "monday", "sunday")]
object.size(smaller_gtfs)

# drops entries related to services than run EITHER on monday OR on sunday
# the resulting gtfs shouldn't include any trips running on these days
smaller_gtfs &lt;- filter_by_weekday(
  gtfs,
  weekday = c("monday", "sunday"),
  keep = FALSE
)
smaller_gtfs$calendar[, c("service_id", "monday", "sunday")]
object.size(smaller_gtfs)

# drops entries related to services than run on monday AND on sunday
# the resulting gtfs may include trips that run on these days, but no trips
# that run on both these days
smaller_gtfs &lt;- filter_by_weekday(
  gtfs,
  weekday = c("monday", "sunday"),
  combine = "and",
  keep = FALSE
)
smaller_gtfs$calendar[, c("service_id", "monday", "sunday")]
object.size(smaller_gtfs)
</code></pre>

<hr>
<h2 id='frequencies_to_stop_times'>Convert frequencies to stop times</h2><span id='topic+frequencies_to_stop_times'></span>

<h3>Description</h3>

<p>Creates <code>stop_times</code> entries based on the frequencies specified in the
<code>frequencies</code> table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>frequencies_to_stop_times(gtfs, trip_id = NULL, force = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="frequencies_to_stop_times_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="frequencies_to_stop_times_+3A_trip_id">trip_id</code></td>
<td>
<p>A character vector including the <code>trip_id</code>s to have their
frequencies converted to <code>stop_times</code> entries. If <code>NULL</code> (the default), the
function converts all trips listed in the <code>frequencies</code> table.</p>
</td></tr>
<tr><td><code id="frequencies_to_stop_times_+3A_force">force</code></td>
<td>
<p>Whether to convert trips specified in the <code>frequencies</code> table
even if they are not described in <code>stop_times</code> (defaults to <code>FALSE</code>). When
set to <code>TRUE</code>, these mismatched trip are removed from the <code>frequencies</code> table
and their correspondent entries in <code>trips</code> are substituted by what would be
their converted counterpart.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A GTFS object with updated <code>frequencies</code>, <code>stop_times</code> and <code>trips</code>
tables.
</p>


<h3>Details</h3>

<p>A single trip described in a <code>frequencies</code> table may yield multiple trips
after converting the GTFS. Let's say, for example, that the <code>frequencies</code>
table describes a trip called <code>"example_trip"</code>, that starts at 08:00 and
stops at 09:00, with a 30 minutes headway.
</p>
<p>In practice, that means that one trip will depart at 08:00, another at 08:30
and yet another at 09:00. <code>frequencies_to_stop_times()</code> appends a <code>"_&lt;n&gt;"</code>
suffix to the newly created trips to differentiate each one of them (e.g. in
this case, the new trips, described in the <code>trips</code> and <code>stop_times</code> tables,
would be called <code>"example_trip_1"</code>, <code>"example_trip_2"</code> and
<code>"example_trip_3"</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")
gtfs &lt;- read_gtfs(data_path)
trip &lt;- "CPTM L07-0"

# converts all trips listed in the frequencies table
converted_gtfs &lt;- frequencies_to_stop_times(gtfs)

# converts only the specified trip_id
converted_gtfs &lt;- frequencies_to_stop_times(gtfs, trip)

# how the specified trip_id was described in the frequencies table
head(gtfs$frequencies[trip_id == trip])

# the first row of each equivalent stop_times entry in the converted gtfs
equivalent_stop_times &lt;- converted_gtfs$stop_times[grepl(trip, trip_id)]
equivalent_stop_times[equivalent_stop_times[, .I[1], by = trip_id]$V1]

</code></pre>

<hr>
<h2 id='get_children_stops'>Get children stops recursively</h2><span id='topic+get_children_stops'></span>

<h3>Description</h3>

<p>Returns the (recursive) children stops of each specified <code>stop_id</code>.
Recursive in this context means it returns all children's children (i.e.
first children, then children's children, and then their children, and so
on).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_children_stops(gtfs, stop_id = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_children_stops_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="get_children_stops_+3A_stop_id">stop_id</code></td>
<td>
<p>A string vector including the <code>stop_id</code>s to have their
children returned. If <code>NULL</code> (the default), the function returns the
children of every <code>stop_id</code> in the GTFS.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.table</code> containing the <code>stop_id</code>s and their children'
<code>stop_id</code>s. If a stop doesn't have a child, its correspondent <code>child_id</code>
entry is marked as <code>""</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/ggl_gtfs.zip", package = "gtfstools")
gtfs &lt;- read_gtfs(data_path)

children &lt;- get_children_stops(gtfs)
head(children)

# use the stop_id argument to control which stops are analyzed
children &lt;- get_children_stops(gtfs, stop_id = c("F12S", "F12N"))
children

</code></pre>

<hr>
<h2 id='get_parent_station'>Get parent stations recursively</h2><span id='topic+get_parent_station'></span>

<h3>Description</h3>

<p>Returns the (recursive) parent stations of each specified <code>stop_id</code>.
Recursive in this context means it returns all parents' parents (i.e. first
parents, then parents' parents, and then their parents, and so on).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_parent_station(gtfs, stop_id = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_parent_station_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="get_parent_station_+3A_stop_id">stop_id</code></td>
<td>
<p>A string vector including the <code>stop_id</code>s to have their parents
returned. If <code>NULL</code> (the default), the function returns the parents of
every <code>stop_id</code> in the GTFS.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.table</code> containing the <code>stop_id</code>s and their <code>parent_station</code>s.
If a stop doesn't have a parent, its correspondent <code>parent_station</code> entry
is marked as <code>""</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_children_stops">get_children_stops()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/ggl_gtfs.zip", package = "gtfstools")

gtfs &lt;- read_gtfs(data_path)

parents &lt;- get_parent_station(gtfs)
head(parents)

# use the stop_id argument to control which stops are analyzed
parents &lt;- get_parent_station(gtfs, c("B1", "B2"))
parents

</code></pre>

<hr>
<h2 id='get_stop_times_patterns'>Get stop times patterns</h2><span id='topic+get_stop_times_patterns'></span>

<h3>Description</h3>

<p>Identifies spatial and spatiotemporal patterns within the <code>stop_times</code>
table. Please see the details to understand what a &quot;pattern&quot; means in each of
these cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_stop_times_patterns(gtfs, trip_id = NULL, type = "spatial")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_stop_times_patterns_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="get_stop_times_patterns_+3A_trip_id">trip_id</code></td>
<td>
<p>A character vector including the <code>trip_id</code>s to have their
<code>stop_times</code> entries analyzed. If <code>NULL</code> (the default), the function
analyses the pattern of every <code>trip_id</code> in the GTFS.</p>
</td></tr>
<tr><td><code id="get_stop_times_patterns_+3A_type">type</code></td>
<td>
<p>A string specifying the type of patterns to be analyzed. Either
<code>"spatial"</code> (the default) or &quot;spatiotemporal&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.table</code> associating each <code>trip_id</code> to a <code>pattern_id</code>.
</p>


<h3>Details</h3>

<p>Two trips are assigned to the same spatial <code>pattern_id</code> if they travel along
the same sequence of stops. They are assigned to the same spatiotemporal
<code>pattern_id</code>, on the other hand, if they travel along the same sequence of
stops and they take the same time between stops. Please note that, in such
case, only the time between stops is taken into account, and the time that
the trip started is ignored (e.g. if two trips depart from stop A and follow
the same sequence of stops to arrive at stop B, taking both 1 hour to do so,
their spatiotemporal pattern will be considered the same, even if one
departed at 6 am and another at 7 am). Please also note that the
<code>stop_sequence</code> field is currently ignored - which means that two stops are
considered to follow the same sequence if one is listed right below the
other on the <code>stop_times</code> table (e.g. if trip X lists stops A followed by
stop B with <code>stop_sequence</code>s 1 and 2, and trip Y lists stops A followed by
stop B with <code>stop_sequence</code>s 1 and 3, they are assigned to the same
<code>pattern_id</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/ber_gtfs.zip", package = "gtfstools")

gtfs &lt;- read_gtfs(data_path)

patterns &lt;- get_stop_times_patterns(gtfs)
head(patterns)

# use the trip_id argument to control which trips are analyzed
patterns &lt;- get_stop_times_patterns(
  gtfs,
  trip_id = c("143765658", "143765659", "143765660")
)
patterns

# use the type argument to control the type of pattern analyzed
patterns &lt;- get_stop_times_patterns(
  gtfs,
  trip_id = c("143765658", "143765659", "143765660"),
  type = "spatiotemporal"
)
patterns

</code></pre>

<hr>
<h2 id='get_trip_duration'>Get trip duration</h2><span id='topic+get_trip_duration'></span>

<h3>Description</h3>

<p>Returns the duration of each specified <code>trip_id</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_trip_duration(gtfs, trip_id = NULL, unit = "min")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_trip_duration_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="get_trip_duration_+3A_trip_id">trip_id</code></td>
<td>
<p>A string vector including the <code>trip_id</code>s to have their
duration calculated. If <code>NULL</code> (the default) the function calculates the
duration of every <code>trip_id</code> in the GTFS.</p>
</td></tr>
<tr><td><code id="get_trip_duration_+3A_unit">unit</code></td>
<td>
<p>A string representing the time unit in which the duration is
desired. One of <code>"s"</code> (seconds), <code>"min"</code> (minutes, the default), <code>"h"</code>
(hours) or <code>"d"</code> (days).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.table</code> containing the duration of each specified trip.
</p>


<h3>Details</h3>

<p>The duration of a trip is defined as the time difference between its last
arrival time and its first departure time, as specified in the <code>stop_times</code>
table.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")

gtfs &lt;- read_gtfs(data_path)

trip_duration &lt;- get_trip_duration(gtfs)
head(trip_duration)

trip_ids &lt;- c("CPTM L07-0", "2002-10-0")
trip_duration &lt;- get_trip_duration(gtfs, trip_id = trip_ids)
trip_duration

trip_duration &lt;- get_trip_duration(gtfs, trip_id = trip_ids, unit = "h")
trip_duration

</code></pre>

<hr>
<h2 id='get_trip_geometry'>Get trip geometry</h2><span id='topic+get_trip_geometry'></span>

<h3>Description</h3>

<p>Returns the geometry of each specified <code>trip_id</code>, based either on the
<code>shapes</code> or the <code>stop_times</code> file (or both).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_trip_geometry(gtfs, trip_id = NULL, file = NULL, crs = 4326)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_trip_geometry_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="get_trip_geometry_+3A_trip_id">trip_id</code></td>
<td>
<p>A character vector including the <code>trip_id</code>s to have their
geometries generated. If <code>NULL</code> (the default), the function generates
geometries for every <code>trip_id</code> in the GTFS.</p>
</td></tr>
<tr><td><code id="get_trip_geometry_+3A_file">file</code></td>
<td>
<p>A character vector specifying the file from which geometries
should be generated (either one of or both <code>shapes</code> and <code>stop_times</code>). If
<code>NULL</code> (the default), the function attemps to generate the geometries from
both files, but only raises an error if none of the files exist.</p>
</td></tr>
<tr><td><code id="get_trip_geometry_+3A_crs">crs</code></td>
<td>
<p>The CRS of the resulting object, either as an EPSG code or as an
<code>crs</code> object. Defaults to 4326 (WGS 84).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;LINESTRING sf&#8288;</code>.
</p>


<h3>Details</h3>

<p>The geometry generation works differently for the two files. In the case of
<code>shapes</code>, the shape as described in the text file is converted to an <code>sf</code>
object. For <code>stop_times</code> the geometry is the result of linking subsequent
stops along a straight line (stops' coordinates are retrieved from the
<code>stops</code> file). Thus, the resolution of the geometry when generated with
<code>shapes</code> tends to be much higher than when created with <code>stop_times</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")

gtfs &lt;- read_gtfs(data_path)

trip_geometry &lt;- get_trip_geometry(gtfs)
head(trip_geometry)

# the above is identical to
trip_geometry &lt;- get_trip_geometry(gtfs, file = c("shapes", "stop_times"))
head(trip_geometry)

trip_ids &lt;- c("CPTM L07-0", "2002-10-0")
trip_geometry &lt;- get_trip_geometry(gtfs, trip_id = trip_ids)
trip_geometry
plot(trip_geometry["origin_file"])

</code></pre>

<hr>
<h2 id='get_trip_length'>Get trip length</h2><span id='topic+get_trip_length'></span>

<h3>Description</h3>

<p>Returns the length of each specified <code>trip_id</code>, based either on the <code>shapes</code>
or the <code>stop_times</code> file (or both).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_trip_length(gtfs, trip_id = NULL, file = NULL, unit = "km")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_trip_length_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="get_trip_length_+3A_trip_id">trip_id</code></td>
<td>
<p>A character vector including the <code>trip_id</code>s to have their
length calculated If <code>NULL</code> (the default), the function calculates the
length of each <code>trip_id</code> in the GTFS.</p>
</td></tr>
<tr><td><code id="get_trip_length_+3A_file">file</code></td>
<td>
<p>A character vector specifying the file from which lengths should
be calculated (either one of or both <code>shapes</code> and <code>stop_times</code>). If <code>NULL</code>
(the default), the function attempts to calculate the lengths from both
files, but only raises an error if none of the files exist.</p>
</td></tr>
<tr><td><code id="get_trip_length_+3A_unit">unit</code></td>
<td>
<p>A string representing the unit in which lengths are desired.
Either <code>"km"</code> (the default) or <code>"m"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.table</code> containing the length of each specified trip.
</p>


<h3>Details</h3>

<p>Please check <code><a href="#topic+get_trip_geometry">get_trip_geometry()</a></code> documentation to understand how geometry
generation, and consequently length calculation, differs depending on the
chosen file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")

gtfs &lt;- read_gtfs(data_path)

trip_length &lt;- get_trip_length(gtfs)
head(trip_length)

# the above is identical to
trip_length &lt;- get_trip_length(gtfs, file = c("shapes", "stop_times"))
head(trip_length)

trip_ids &lt;- c("CPTM L07-0", "2002-10-0")
trip_length &lt;- get_trip_length(gtfs, trip_id = trip_ids)
trip_length

</code></pre>

<hr>
<h2 id='get_trip_segment_duration'>Get trip segments' duration</h2><span id='topic+get_trip_segment_duration'></span>

<h3>Description</h3>

<p>Returns the duration of segments between stops of each specified <code>trip_id</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_trip_segment_duration(gtfs, trip_id = NULL, unit = "min")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_trip_segment_duration_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="get_trip_segment_duration_+3A_trip_id">trip_id</code></td>
<td>
<p>A string vector including the <code>trip_id</code>s to have their
segments' duration calculated. If <code>NULL</code> (the default) the function
calculates the segments' duration of every <code>trip_id</code> in the GTFS.</p>
</td></tr>
<tr><td><code id="get_trip_segment_duration_+3A_unit">unit</code></td>
<td>
<p>A string representing the time unit in which the duration is
desired. One of <code>"s"</code> (seconds), <code>"min"</code> (minutes, the default),
<code>"h"</code> (hours) or <code>"d"</code> (days).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.table</code> containing the segments' duration of each specified
trip.
</p>


<h3>Details</h3>

<p>A trip segment is defined as the path between two subsequent stops in the
same trip. The  duration of a segment is defined as the time difference
between its arrival time and its departure time, as specified in the
<code>stop_times</code> file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")

gtfs &lt;- read_gtfs(data_path)

trip_segment_dur &lt;- get_trip_segment_duration(gtfs)
head(trip_segment_dur)

# use the trip_id argument to control which trips are analyzed
trip_segment_dur &lt;- get_trip_segment_duration(gtfs, trip_id = "CPTM L07-0")
trip_segment_dur

# use the unit argument to control in which unit the durations are calculated
trip_segment_dur &lt;- get_trip_segment_duration(gtfs, "CPTM L07-0", unit = "s")
trip_segment_dur

</code></pre>

<hr>
<h2 id='get_trip_speed'>Get trip speed</h2><span id='topic+get_trip_speed'></span>

<h3>Description</h3>

<p>Returns the speed of each specified <code>trip_id</code>, based on the geometry created
from either the <code>shapes</code> or the <code>stop_times</code> file (or both).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_trip_speed(gtfs, trip_id = NULL, file = "shapes", unit = "km/h")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_trip_speed_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="get_trip_speed_+3A_trip_id">trip_id</code></td>
<td>
<p>A character vector including the <code>trip_id</code>s to have their
speeds calculated. If <code>NULL</code> (the default), the function calculates the
speed of every <code>trip_id</code> in the GTFS.</p>
</td></tr>
<tr><td><code id="get_trip_speed_+3A_file">file</code></td>
<td>
<p>The file from which geometries should be generated, either
<code>shapes</code> or <code>stop_times</code> (geometries are used to calculate the length of a
trip). Defaults to <code>shapes</code>.</p>
</td></tr>
<tr><td><code id="get_trip_speed_+3A_unit">unit</code></td>
<td>
<p>A string representing the unit in which the speeds are desired.
Either <code>"km/h"</code> (the default) or <code>"m/s"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.table</code> containing the duration of each specified trip and the
file from which geometries were generated.
</p>


<h3>Details</h3>

<p>Please check <code><a href="#topic+get_trip_geometry">get_trip_geometry()</a></code> documentation to understand how geometry
generation differs depending on the chosen file.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_trip_geometry">get_trip_geometry()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")

gtfs &lt;- read_gtfs(data_path)

trip_speed &lt;- get_trip_speed(gtfs)
head(trip_speed)

trip_ids &lt;- c("CPTM L07-0", "2002-10-0")
trip_speed &lt;- get_trip_speed(gtfs, trip_ids)
trip_speed

trip_speed &lt;- get_trip_speed(
  gtfs,
  trip_ids,
  file = c("shapes", "stop_times")
)
trip_speed

trip_speed &lt;- get_trip_speed(gtfs, trip_ids, unit = "m/s")
trip_speed

</code></pre>

<hr>
<h2 id='gtfstools'>gtfstools: General Transit Feed Specification (GTFS) Editing and Analysing
Tools</h2><span id='topic+gtfstools'></span><span id='topic+_PACKAGE'></span><span id='topic+gtfstools-package'></span>

<h3>Description</h3>

<p>Utility functions to read, manipulate, analyse and write transit feeds in the
General Transit Feed Specification (GTFS) data format.
</p>


<h3>Usage</h3>

<p>Please check the vignettes for more on the package usage:
</p>

<ul>
<li><p> Basic usage: reading, analysing, manipulating and writing feeds. Run
<code>vignette("gtfstools")</code> or check it on the <a href="https://ipeagit.github.io/gtfstools/articles/gtfstools.html">website</a>.
</p>
</li>
<li><p> Filtering GTFS feeds. Run <code>vignette("filtering", package = "gtfstools")</code> or
check it on the <a href="https://ipeagit.github.io/gtfstools/articles/filtering.html">website</a>.
</p>
</li>
<li><p> Validating GTFS feeds. Run <code>vignette("validating", package = "gtfstools")</code>
or check it on the
<a href="https://ipeagit.github.io/gtfstools/articles/validating.html">website</a>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Daniel Herszenhut <a href="mailto:dhersz@gmail.com">dhersz@gmail.com</a> (<a href="https://orcid.org/0000-0001-8066-1105">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Rafael H. M. Pereira (<a href="https://orcid.org/0000-0003-2125-7465">ORCID</a>)
</p>
</li>
<li><p> Pedro R. Andrade (<a href="https://orcid.org/0000-0001-8675-4046">ORCID</a>)
</p>
</li>
<li><p> Joao Bazzo (<a href="https://orcid.org/0000-0003-4536-5006">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Mark Padgham [contributor]
</p>
</li>
<li><p> Marcus Saraiva (<a href="https://orcid.org/0000-0001-6218-2338">ORCID</a>) [contributor]
</p>
</li>
<li><p> Ipea - Institute for Applied Economic Research [copyright holder, funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://ipeagit.github.io/gtfstools/">https://ipeagit.github.io/gtfstools/</a>
</p>
</li>
<li> <p><a href="https://github.com/ipeaGIT/gtfstools">https://github.com/ipeaGIT/gtfstools</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ipeaGIT/gtfstools/issues">https://github.com/ipeaGIT/gtfstools/issues</a>
</p>
</li></ul>


<hr>
<h2 id='integer_to_date'>Convert an integer vector into a Date vector</h2><span id='topic+integer_to_date'></span>

<h3>Description</h3>

<p>Convert an integer vector into a Date vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>integer_to_date(field)
</code></pre>

<hr>
<h2 id='merge_gtfs'>Merge GTFS files</h2><span id='topic+merge_gtfs'></span>

<h3>Description</h3>

<p>Combines many GTFS objects into a single one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merge_gtfs(..., files = NULL, warnings, prefix = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merge_gtfs_+3A_...">...</code></td>
<td>
<p>GTFS objects to be merged. Each argument can either be a GTFS or
a list of GTFS objects.</p>
</td></tr>
<tr><td><code id="merge_gtfs_+3A_files">files</code></td>
<td>
<p>A character vector listing the GTFS tables to be merged. If
<code>NULL</code> (the default), all tables are merged.</p>
</td></tr>
<tr><td><code id="merge_gtfs_+3A_warnings">warnings</code></td>
<td>
<p>Whether to display warning messages (defaults to <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="merge_gtfs_+3A_prefix">prefix</code></td>
<td>
<p>Either a logical or a character vector (defaults to <code>FALSE</code>).
Whether to add a prefix to the value of id fields that identify from which
GTFS object the value comes from. If <code>TRUE</code>, the prefixes will range from
<code>"1"</code> to <code>n</code>, where <code>n</code> is the number of objects passed to the function. If a
character vector, its elements will be used to identify the GTFS objects, and
the length of the vector must equal the total amount of objects passed in
<code>...</code> (the first element will identify the first GTFS, the second element the
second GTFS, and so on).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A GTFS object in which each table is a combination (by row) of the
tables from the specified GTFS objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spo_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")
ggl_path &lt;- system.file("extdata/ggl_gtfs.zip", package = "gtfstools")

spo_gtfs &lt;- read_gtfs(spo_path)
names(spo_gtfs)

ggl_gtfs &lt;- read_gtfs(ggl_path)
names(ggl_gtfs)

merged_gtfs &lt;- merge_gtfs(spo_gtfs, ggl_gtfs)
names(merged_gtfs)

# use a list() to programatically merge many GTFS objects
gtfs_list &lt;- list(spo_gtfs, ggl_gtfs)
merged_gtfs &lt;- merge_gtfs(gtfs_list)

# 'prefix' helps disambiguating from which GTFS each id comes from.
# if TRUE, the ids range from 1:n, where n is the number of gtfs
merged_gtfs &lt;- merge_gtfs(gtfs_list, prefix = TRUE)
merged_gtfs$agency

# if a character vector, its elements will be used to identify the each gtfs
merged_gtfs &lt;- merge_gtfs(gtfs_list, prefix = c("spo", "ggl"))
merged_gtfs$agency
</code></pre>

<hr>
<h2 id='read_gtfs'>Read GTFS files</h2><span id='topic+read_gtfs'></span>

<h3>Description</h3>

<p>Reads GTFS text files from either a local <code>.zip</code> file or an URL.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_gtfs(
  path,
  files = NULL,
  fields = NULL,
  skip = NULL,
  quiet = TRUE,
  encoding = "unknown"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_gtfs_+3A_path">path</code></td>
<td>
<p>The path to a GTFS <code>.zip</code> file.</p>
</td></tr>
<tr><td><code id="read_gtfs_+3A_files">files</code></td>
<td>
<p>A character vector containing the text files to be read from the
GTFS (without the <code>.txt</code> extension). If <code>NULL</code> (the default) all existing
files are read.</p>
</td></tr>
<tr><td><code id="read_gtfs_+3A_fields">fields</code></td>
<td>
<p>A named list containing the fields to be read from each text
file, in the format <code>list(file = c("field1", "field2"))</code>. If <code>NULL</code> (the
default), all fields from the files specified in <code>files</code> are read. If a
file is specified in <code>files</code> but not in <code>fields</code>, all fields from that file
will be read (i.e. you may specify in <code>fields</code> only files whose fields you
want to subset).</p>
</td></tr>
<tr><td><code id="read_gtfs_+3A_skip">skip</code></td>
<td>
<p>A character vector containing the text files that should not be
read from the GTFS, without the <code>.txt</code> extension. If <code>NULL</code> (the default),
no files are skipped. Cannot be used if <code>files</code> is already set.</p>
</td></tr>
<tr><td><code id="read_gtfs_+3A_quiet">quiet</code></td>
<td>
<p>Whether to hide log messages and progress bars (defaults to
<code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="read_gtfs_+3A_encoding">encoding</code></td>
<td>
<p>A string, ultimately passed to <code><a href="data.table.html#topic+fread">data.table::fread()</a></code>.
Defaults to <code>"unknown"</code>. Other possible options are <code>"UTF-8"</code> and
<code>"Latin-1"</code>. Please note that this is not used to re-encode the input, but
to enable handling encoded strings in their native encoding.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.table</code>-based GTFS object: a <code>list</code> of <code>data.table</code>s in which
each table represents a GTFS text file.
</p>


<h3>Details</h3>

<p>The column types of each <code>data.table</code> in the final GTFS object conform as
closely as possible to the <a href="https://developers.google.com/transit/gtfs/reference">Google's Static GTFS Reference</a>. Exceptions are
date-related columns (such as <code>calendar.txt</code>'s <code>start_date</code> and <code>end_date</code>,
for example), which are converted to <code>Date</code> objects, instead of being kept as
<code>integer</code>s, allowing for easier data manipulation. These columns are
converted back to <code>integer</code>s when writing the GTFS object to a <code>.zip</code> file
using <code><a href="#topic+write_gtfs">write_gtfs()</a></code>.
</p>


<h3>See Also</h3>

<p>Other io functions: 
<code><a href="#topic+write_gtfs">write_gtfs</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")

gtfs &lt;- read_gtfs(data_path)
names(gtfs)

gtfs &lt;- read_gtfs(data_path, files = c("trips", "stop_times"))
names(gtfs)

gtfs &lt;- read_gtfs(data_path, skip = "trips")
names(gtfs)

gtfs &lt;- read_gtfs(data_path, fields = list(agency = "agency_id"))
names(gtfs)
names(gtfs$agency)

</code></pre>

<hr>
<h2 id='remove_duplicates'>Remove duplicated entries</h2><span id='topic+remove_duplicates'></span>

<h3>Description</h3>

<p>Removes duplicated entries from GTFS objects tables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_duplicates(gtfs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_duplicates_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A GTFS object containing only unique entries.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")
gtfs &lt;- read_gtfs(data_path)

# this gtfs includes some duplicated entries
gtfs$agency

gtfs &lt;- remove_duplicates(gtfs)
gtfs$agency

</code></pre>

<hr>
<h2 id='seconds_to_string'>Convert seconds after midnight to time string</h2><span id='topic+seconds_to_string'></span>

<h3>Description</h3>

<p>Converts seconds after midnight as integers to strings in the &quot;HH:MM:SS&quot;
format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seconds_to_string(seconds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seconds_to_string_+3A_seconds">seconds</code></td>
<td>
<p>An integer.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A time-representing string.
</p>

<hr>
<h2 id='set_trip_speed'>Set trip average speed</h2><span id='topic+set_trip_speed'></span>

<h3>Description</h3>

<p>Sets the average speed of each specified <code>trip_id</code> by changing the
<code>arrival_time</code> and <code>departure_time</code> columns in <code>stop_times</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_trip_speed(gtfs, trip_id, speed, unit = "km/h", by_reference = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_trip_speed_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="set_trip_speed_+3A_trip_id">trip_id</code></td>
<td>
<p>A string vector including the <code>trip_id</code>s to have their
average speed set.</p>
</td></tr>
<tr><td><code id="set_trip_speed_+3A_speed">speed</code></td>
<td>
<p>A numeric representing the speed to be set. Its length must
either equal 1, in which case the value is recycled for all
<code>trip_id</code>s, or equal <code>trip_id</code>'s length.</p>
</td></tr>
<tr><td><code id="set_trip_speed_+3A_unit">unit</code></td>
<td>
<p>A string representing the unit in which the speed is given. One
of <code>"km/h"</code> (the default) or <code>"m/s"</code>.</p>
</td></tr>
<tr><td><code id="set_trip_speed_+3A_by_reference">by_reference</code></td>
<td>
<p>Whether to update <code>stop_times</code>' <code>data.table</code> by
reference. Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>by_reference</code> is set to <code>FALSE</code>, returns a GTFS object with the
time columns of its <code>stop_times</code> adjusted. Else, returns a GTFS object
invisibly (note that in this case the original GTFS object is altered).
</p>


<h3>Details</h3>

<p>The average speed is calculated as the difference between the arrival time
at the last stop minus the departure time at the first top, over the trip's
length (as calculated via <code><a href="#topic+get_trip_geometry">get_trip_geometry()</a></code>, based on the <code>shapes</code>
file). The arrival and departure times at all other stops (i.e. not the
first neither the last) are set as <code>""</code>, which is written as <code>NA</code> with
<code><a href="#topic+write_gtfs">write_gtfs()</a></code>. Some transport routing software, such as
<a href="http://www.opentripplanner.org/">OpenTripPlanner</a>, support specifying stop
times like so. In such cases, they estimate arrival/departure times at the
others stops based on the average speed as well. We plan to add that feature
to this function in the future.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")

gtfs &lt;- read_gtfs(data_path)

gtfs_new_speed &lt;- set_trip_speed(gtfs, trip_id = "CPTM L07-0", 50)
gtfs_new_speed$stop_times[trip_id == "CPTM L07-0"]

# use the unit argument to change the speed unit
gtfs_new_speed &lt;- set_trip_speed(
  gtfs,
  trip_id = "CPTM L07-0",
  speed = 15,
  unit = "m/s"
)
gtfs_new_speed$stop_times[trip_id == "CPTM L07-0"]

# original gtfs remains unchanged
gtfs$stop_times[trip_id == "CPTM L07-0"]

# when doing by reference, original gtfs is changed
set_trip_speed(gtfs, trip_id = "CPTM L07-0", 50, by_reference = TRUE)
gtfs$stop_times[trip_id == "CPTM L07-0"]

</code></pre>

<hr>
<h2 id='string_to_seconds'>Convert time string to seconds after midnight</h2><span id='topic+string_to_seconds'></span>

<h3>Description</h3>

<p>Converts strings in the &quot;HH:MM:SS&quot; format to seconds after midnight.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>string_to_seconds(string)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="string_to_seconds_+3A_string">string</code></td>
<td>
<p>A string in &quot;HH:MM:SS&quot; format.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The seconds after midnight of a given time string as an integer.
</p>

<hr>
<h2 id='validate_gtfs'>Validate GTFS feed</h2><span id='topic+validate_gtfs'></span>

<h3>Description</h3>

<p>Uses MobilityData's <a href="https://github.com/MobilityData/gtfs-validator">GTFS validator</a> to perform a GTFS
business rule validation. The results are available as an HTML report (if
validator v3.1.0 or higher is used) and in JSON format. Please check the
complete set of rules used in the validation
<a href="https://github.com/MobilityData/gtfs-validator/blob/master/RULES.md">here</a>.
Please note that this function requires a working installation of Java 11 or
higher to work.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_gtfs(
  gtfs,
  output_path,
  validator_path,
  overwrite = TRUE,
  html_preview = TRUE,
  pretty_json = FALSE,
  quiet = TRUE,
  n_threads = parallel::detectCores() - 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validate_gtfs_+3A_gtfs">gtfs</code></td>
<td>
<p>The GTFS to be validated. Can be in the format of a GTFS object,
of a path to a GTFS file, of a path to a directory or an URL to a feed.</p>
</td></tr>
<tr><td><code id="validate_gtfs_+3A_output_path">output_path</code></td>
<td>
<p>A string. The path to the directory that the validator
will create and in which the results will be saved to.</p>
</td></tr>
<tr><td><code id="validate_gtfs_+3A_validator_path">validator_path</code></td>
<td>
<p>A string. The path to the GTFS validator, previously
downloaded with <code><a href="#topic+download_validator">download_validator()</a></code>.</p>
</td></tr>
<tr><td><code id="validate_gtfs_+3A_overwrite">overwrite</code></td>
<td>
<p>A logical. Whether to overwrite existing validation results
in <code>output_path</code>. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="validate_gtfs_+3A_html_preview">html_preview</code></td>
<td>
<p>A logical. Whether to show HTML report in a viewer, such
as RStudio or a browser. Defaults to <code>TRUE</code> (only works on interactive
sessions).</p>
</td></tr>
<tr><td><code id="validate_gtfs_+3A_pretty_json">pretty_json</code></td>
<td>
<p>A logical. Whether JSON results should be printed in a
readable way, that allows it to be inspected without manually formatting.
Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="validate_gtfs_+3A_quiet">quiet</code></td>
<td>
<p>A logical. Whether to hide informative messages. Defaults to
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="validate_gtfs_+3A_n_threads">n_threads</code></td>
<td>
<p>An integer between 1 and the number of cores in the running
machine. Control how many threads are used during the validation. Defaults
to using all but one of the available cores.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns the normalized path to the directory where the
validation results were saved to.
</p>


<h3>See Also</h3>

<p>Other validation: 
<code><a href="#topic+download_validator">download_validator</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")
output_path &lt;- tempfile("validation_result")
validator_path &lt;- download_validator(tempdir())
gtfs &lt;- read_gtfs(data_path)

validate_gtfs(gtfs, output_path, validator_path)
list.files(output_path)

# works with feeds saved to disk
new_output_path &lt;- tempfile("new_validation_result")
validate_gtfs(data_path, new_output_path, validator_path)
list.files(new_output_path)

# and with feeds pointed by an url
newer_output_path &lt;- tempfile("newer_validation_result")
gtfs_url &lt;- "https://github.com/ipeaGIT/gtfstools/raw/master/inst/extdata/spo_gtfs.zip"
validate_gtfs(gtfs_url, newer_output_path, validator_path)
list.files(newer_output_path)

</code></pre>

<hr>
<h2 id='write_gtfs'>Write GTFS files</h2><span id='topic+write_gtfs'></span>

<h3>Description</h3>

<p>Writes GTFS objects as GTFS <code>.zip</code> files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_gtfs(
  gtfs,
  path,
  files = NULL,
  standard_only = FALSE,
  as_dir = FALSE,
  overwrite = TRUE,
  quiet = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_gtfs_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS object, as created by <code><a href="#topic+read_gtfs">read_gtfs()</a></code>.</p>
</td></tr>
<tr><td><code id="write_gtfs_+3A_path">path</code></td>
<td>
<p>The path to the <code>.zip</code> file in which the feed should be written
to.</p>
</td></tr>
<tr><td><code id="write_gtfs_+3A_files">files</code></td>
<td>
<p>A character vector containing the name of the elements to be
written to the feed. If <code>NULL</code> (the default), all elements inside the GTFS
object are written.</p>
</td></tr>
<tr><td><code id="write_gtfs_+3A_standard_only">standard_only</code></td>
<td>
<p>Whether to write only standard files and fields
(defaults to <code>FALSE</code>, which doesn't drop extra files and fields).</p>
</td></tr>
<tr><td><code id="write_gtfs_+3A_as_dir">as_dir</code></td>
<td>
<p>Whether to write the feed as a directory, instead of a <code>.zip</code>
file (defaults to <code>FALSE</code>, which means that the field is written as a zip
file).</p>
</td></tr>
<tr><td><code id="write_gtfs_+3A_overwrite">overwrite</code></td>
<td>
<p>Whether to overwrite existing <code>.zip</code> file (defaults to
<code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="write_gtfs_+3A_quiet">quiet</code></td>
<td>
<p>Whether to hide log messages and progress bars (defaults to
<code>TRUE</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns the same GTFS object passed to the <code>gtfs</code>
parameter.
</p>


<h3>See Also</h3>

<p>Other io functions: 
<code><a href="#topic+read_gtfs">read_gtfs</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")
gtfs &lt;- read_gtfs(data_path)

tmp_dir &lt;- file.path(tempdir(), "tmpdir")
dir.create(tmp_dir)
list.files(tmp_dir) #'
tmp_file &lt;- tempfile(pattern = "gtfs", tmpdir = tmp_dir, fileext = ".zip")
write_gtfs(gtfs, tmp_file)
list.files(tmp_dir)

gtfs_all_files &lt;- read_gtfs(tmp_file)
names(gtfs_all_files)

write_gtfs(gtfs, tmp_file, files = "stop_times")
gtfs_stop_times &lt;- read_gtfs(tmp_file)
names(gtfs_stop_times)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
