<!DOCTYPE html><html><head><title>Help for package DRDID</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DRDID}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DRDID-package'><p>Doubly robust difference-in-differences estimators</p></a></li>
<li><a href='#drdid'><p>Locally efficient doubly robust DiD estimators for the ATT</p></a></li>
<li><a href='#drdid_imp_panel'><p>Improved locally efficient doubly robust DiD estimator for the ATT, with panel data</p></a></li>
<li><a href='#drdid_imp_rc'><p>Improved locally efficient doubly robust DiD estimator for the ATT, with repeated cross-section data</p></a></li>
<li><a href='#drdid_imp_rc1'><p>Improved doubly robust DiD estimator for the ATT, with repeated cross-section data</p></a></li>
<li><a href='#drdid_panel'><p>Locally efficient doubly robust DiD estimator for the ATT, with panel data</p></a></li>
<li><a href='#drdid_rc'><p>Locally efficient doubly robust DiD estimator for the ATT, with repeated cross-section data</p></a></li>
<li><a href='#drdid_rc1'><p>Doubly robust DiD estimator for the ATT, with repeated cross-section data</p></a></li>
<li><a href='#ipw_did_panel'><p>Inverse probability weighted DiD estimator, with panel data</p></a></li>
<li><a href='#ipw_did_rc'><p>Inverse probability weighted DiD estimator, with repeated cross-section data</p></a></li>
<li><a href='#ipwdid'><p>Inverse probability weighted DiD estimators for the ATT</p></a></li>
<li><a href='#nsw'><p>National Supported Work Demonstration dataset</p></a></li>
<li><a href='#nsw_long'><p>National Supported Work Demonstration dataset, in long format</p></a></li>
<li><a href='#ordid'><p>Outcome regression DiD estimators for the ATT</p></a></li>
<li><a href='#reg_did_panel'><p>Outcome regression DiD estimator for the ATT, with panel data</p></a></li>
<li><a href='#reg_did_rc'><p>Outcome regression DiD estimator for the ATT, with repeated cross-section data</p></a></li>
<li><a href='#sim_rc'><p>Simulated repeated cross-section data</p></a></li>
<li><a href='#std_ipw_did_panel'><p>Standardized inverse probability weighted DiD estimator, with panel data</p></a></li>
<li><a href='#std_ipw_did_rc'><p>Standardized inverse probability weighted DiD estimator, with repeated cross-section data</p></a></li>
<li><a href='#twfe_did_panel'><p>Two-way fixed effects DiD estimator, with panel data</p></a></li>
<li><a href='#twfe_did_rc'><p>Two-way fixed effects DiD estimator, with repeated cross-section data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Doubly Robust Difference-in-Differences Estimators</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.6</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the locally efficient doubly robust difference-in-differences (DiD)
    estimators for the average treatment effect proposed by Sant'Anna and Zhao (2020)
    &lt;<a href="https://doi.org/10.1016%2Fj.jeconom.2020.06.003">doi:10.1016/j.jeconom.2020.06.003</a>&gt;. The estimator combines inverse probability weighting and outcome
    regression estimators (also implemented in the package) to form estimators with
    more attractive statistical properties. Two different estimation methods can be used
    to estimate the nuisance functions.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://psantanna.com/DRDID/">https://psantanna.com/DRDID/</a>, <a href="https://github.com/pedrohcgs/DRDID">https://github.com/pedrohcgs/DRDID</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, trust, BMisc (&ge; 1.4.1)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, spelling, testthat</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-05-18</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/pedrohcgs/DRDID/issues">https://github.com/pedrohcgs/DRDID/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-18 17:04:27 UTC; pedrosantanna</td>
</tr>
<tr>
<td>Author:</td>
<td>Pedro H. C. Sant'Anna [aut, cre],
  Jun Zhao [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pedro H. C. Sant'Anna &lt;pedrosantanna@causal-solutions.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-18 17:50:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='DRDID-package'>Doubly robust difference-in-differences estimators</h2><span id='topic+DRDID-package'></span>

<h3>Description</h3>

<p>The <code>DRDID</code> package implements different estimators for the average treatment effect on
the treated in difference-in-differences (DiD) setups where the parallel trends assumption
holds after you condition on a vector of pre-treatment covariates. The main estimators
implemented here are the locally efficient, doubly-robust DiD estimators proposed by
Sant'Anna and Zhao (2020) &lt;https://arxiv.org/abs/1812.01723&gt;. A number of other DiD
estimators discussed in Sant'Anna and Zhao (2020) are also implemented.
</p>


<h3>References</h3>


<p><cite>Sant'Anna, Pedro H. C. and Zhao, Jun. (2020),
&quot;Doubly Robust Difference-in-Differences Estimators.&quot; Journal of Econometrics, Vol. 219 (1), pp. 101-122,
<a href="https://doi.org/10.1016/j.jeconom.2020.06.003">doi:10.1016/j.jeconom.2020.06.003</a></cite>

</p>

<hr>
<h2 id='drdid'>Locally efficient doubly robust DiD estimators for the ATT</h2><span id='topic+drdid'></span>

<h3>Description</h3>

<p><code>drdid</code> is used to compute the locally efficient doubly robust estimators for the ATT
in difference-in-differences (DiD) setups. It can be used with panel or stationary repeated cross section data.
Data should be store in &quot;long&quot; format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drdid(
  yname,
  tname,
  idname,
  dname,
  xformla = NULL,
  data,
  panel = TRUE,
  estMethod = c("imp", "trad"),
  weightsname = NULL,
  boot = FALSE,
  boot.type = c("weighted", "multiplier"),
  nboot = 999,
  inffunc = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drdid_+3A_yname">yname</code></td>
<td>
<p>The name of the outcome variable.</p>
</td></tr>
<tr><td><code id="drdid_+3A_tname">tname</code></td>
<td>
<p>The name of the column containing the time periods.</p>
</td></tr>
<tr><td><code id="drdid_+3A_idname">idname</code></td>
<td>
<p>The name of the column containing the unit id name.</p>
</td></tr>
<tr><td><code id="drdid_+3A_dname">dname</code></td>
<td>
<p>The name of the column containing the treatment group (=1 if observation is treated in the post-treatment, =0 otherwise)</p>
</td></tr>
<tr><td><code id="drdid_+3A_xformla">xformla</code></td>
<td>
<p>A formula for the covariates to include in the model. It should be of the form <code>~ X1 + X2</code>
(intercept should not be listed as it is always automatically included). Default is NULL which is equivalent to <code>xformla=~1</code>.</p>
</td></tr>
<tr><td><code id="drdid_+3A_data">data</code></td>
<td>
<p>The name of the data.frame that contains the data.</p>
</td></tr>
<tr><td><code id="drdid_+3A_panel">panel</code></td>
<td>
<p>Whether or not the data is a panel dataset. The panel dataset should be provided in long format &ndash; that
is, where each row corresponds to a unit observed at a particular point in time.  The default is TRUE.
When <code>panel = FALSE</code>, the data is treated
as stationary repeated cross sections.</p>
</td></tr>
<tr><td><code id="drdid_+3A_estmethod">estMethod</code></td>
<td>
<p>the method to estimate the nuisance parameters.
The default is &quot;imp&quot; which uses weighted least squares to estimate the outcome regressions and
inverse probability tilting to the estimate the the propensity score, leading to the improved locally efficient  DR DiD estimator
proposed by Sant'Anna and Zhao (2020). The other alternative is &quot;trad&quot;,
which then uses OLS to estimate outcome regressions and maximum likelihood to estimate propensity score. This leads
to the &quot;traditional&quot; locally efficient DR DiD estimator proposed by Sant'Anna and Zhao (2020).</p>
</td></tr>
<tr><td><code id="drdid_+3A_weightsname">weightsname</code></td>
<td>
<p>The name of the column containing the sampling weights. If NULL, then every observation has the same weights.</p>
</td></tr>
<tr><td><code id="drdid_+3A_boot">boot</code></td>
<td>
<p>Logical argument to whether bootstrap should be used for inference. Default is <code>FALSE</code> and analytical
standard errors are reported.</p>
</td></tr>
<tr><td><code id="drdid_+3A_boot.type">boot.type</code></td>
<td>
<p>Type of bootstrap to be performed (not relevant if <code>boot = FALSE</code>). Options are &quot;weighted&quot; and &quot;multiplier&quot;.
If <code>boot = TRUE</code>, default is &quot;weighted&quot;.</p>
</td></tr>
<tr><td><code id="drdid_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repetitions (not relevant if boot = <code>FALSE</code>). Default is 999.</p>
</td></tr>
<tr><td><code id="drdid_+3A_inffunc">inffunc</code></td>
<td>
<p>Logical argument to whether influence function should be returned. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When panel data are available (<code>panel = TRUE</code>), the <code>drdid</code> function implements the
locally efficient doubly robust difference-in-differences (DiD) estimator for the average treatment effect
on the treated (ATT) defined in equation (3.1) in Sant'Anna and Zhao (2020). This estimator makes use of
a logistic propensity score model for the probability of being in the treated group,
and of a linear regression model for the outcome evolution among the comparison units.
</p>
<p>When only stationary repeated cross-section data are available (<code>panel = FALSE</code>), the <code>drdid</code> function
implements the locally efficient doubly robust difference-in-differences (DiD) estimator for the
average treatment effect on the treated (ATT) defined in equation (3.4) in Sant'Anna and Zhao (2020).
This estimator makes use of a logistic propensity score model for the probability of being in the
treated group, and of (separate) linear regression models for the outcome of both treated and comparison units,
in both pre and post-treatment periods.
</p>
<p>When one sets <code>estMethod = "imp"</code> (the default), the nuisance parameters (propensity score and
outcome regression parameters) are estimated using the methods described in Sections 3.1 and 3.2 of
Sant'Anna and Zhao (2020). In short, the propensity score parameters are estimated using the inverse
probability tilting estimator proposed by Graham, Pinto and Pinto (2012), and the outcome
regression coefficients are estimated using weighted least squares,where the weights depend on
the propensity score estimates; see Sant'Anna and Zhao (2020) for details.
</p>
<p>When one sets <code>estMethod = "trad"</code>, the propensity score parameters are estimated using maximum
likelihood, and the outcome regression coefficients are estimated using ordinary least squares.
</p>
<p>The main advantage of using <code>estMethod = "imp"</code> is that the resulting estimator is not only
locally efficient and doubly robust for the ATT, but it is also doubly robust for inference;
see Sant'Anna and Zhao (2020) for details.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>ATT</code></td>
<td>
<p>The DR DiD point estimate</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p> The DR DiD standard error</p>
</td></tr>
<tr><td><code>uci</code></td>
<td>
<p>Estimate of the upper bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>lci</code></td>
<td>
<p>Estimate of the lower bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>boots</code></td>
<td>
<p>All Bootstrap draws of the ATT, in case bootstrap was used to conduct inference. Default is NULL</p>
</td></tr>
<tr><td><code>att.inf.func</code></td>
<td>
<p>Estimate of the influence function. Default is NULL</p>
</td></tr>
<tr><td><code>ps.flag</code></td>
<td>
<p>Convergence Flag for the propensity score estimation
(only active if <code>estMethod = "imp"</code>.): =0 if <code>trust</code> algorithm converged,
=1 if IPT (original) algorithm converged (in case it was used), =2 if
GLM logit estimator was used (i.e., if both <code>trust</code> and IPT
did not converged).</p>
</td></tr>
<tr><td><code>call.param</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>argu</code></td>
<td>
<p>Some arguments used in the call (panel, estMethod, boot, boot.type, nboot, type=&quot;dr&quot;)</p>
</td></tr>
</table>


<h3>References</h3>

<p><cite>Graham, Bryan, Pinto, Cristine, and Egel, Daniel (2012),
&quot;Inverse Probability Tilting for Moment Condition Models with Missing Data.&quot;
Review of Economic Studies, vol. 79 (3), pp. 1053-1079, <a href="https://doi.org/10.1093/restud/rdr047">doi:10.1093/restud/rdr047</a></cite>
</p>
<p><cite>Sant'Anna, Pedro H. C. and Zhao, Jun. (2020),
&quot;Doubly Robust Difference-in-Differences Estimators.&quot; Journal of Econometrics, Vol. 219 (1), pp. 101-122,
<a href="https://doi.org/10.1016/j.jeconom.2020.06.003">doi:10.1016/j.jeconom.2020.06.003</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># -----------------------------------------------
# Panel data case
# -----------------------------------------------
# Form the Lalonde sample with CPS comparison group
eval_lalonde_cps &lt;- subset(nsw_long, nsw_long$treated == 0 | nsw_long$sample == 2)
# Further reduce sample to speed example
set.seed(123)
unit_random &lt;- sample(unique(eval_lalonde_cps$id), 5000)
eval_lalonde_cps &lt;- eval_lalonde_cps[eval_lalonde_cps$id %in% unit_random,]
# -----------------------------------------------
# Implement improved DR locally efficient DiD with panel data
drdid(yname="re", tname = "year", idname = "id", dname = "experimental",
      xformla= ~ age+ educ+ black+ married+ nodegree+ hisp+ re74,
      data = eval_lalonde_cps, panel = TRUE)

#Implement "traditional" DR locally efficient DiD with panel data
drdid(yname="re", tname = "year", idname = "id", dname = "experimental",
      xformla= ~ age+ educ+ black+ married+ nodegree+ hisp+ re74,
      data = eval_lalonde_cps, panel = TRUE, estMethod = "trad")

# -----------------------------------------------
# Repeated cross section case
# -----------------------------------------------
# use the simulated data provided in the package
#Implement "improved" DR locally efficient DiD with repeated cross-section data
drdid(yname="y", tname = "post", idname = "id", dname = "d",
      xformla= ~ x1 + x2 + x3 + x4,
      data = sim_rc, panel = FALSE, estMethod = "imp")

#Implement "traditional" DR locally efficient DiD with repeated cross-section data
drdid(yname="y", tname = "post", idname = "id", dname = "d",
      xformla= ~ x1 + x2 + x3 + x4,
      data = sim_rc, panel = FALSE, estMethod = "trad")

</code></pre>

<hr>
<h2 id='drdid_imp_panel'>Improved locally efficient doubly robust DiD estimator for the ATT, with panel data</h2><span id='topic+drdid_imp_panel'></span>

<h3>Description</h3>

<p><code>drdid_imp_panel</code> is used to compute the locally efficient doubly robust estimators for the ATT
in difference-in-differences (DiD) setups with panel data. The resulting estimator is also doubly robust
for inference; see Section 3.1 of Sant'Anna and Zhao (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drdid_imp_panel(
  y1,
  y0,
  D,
  covariates,
  i.weights = NULL,
  boot = FALSE,
  boot.type = "weighted",
  nboot = NULL,
  inffunc = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drdid_imp_panel_+3A_y1">y1</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes from the post-treatment period.</p>
</td></tr>
<tr><td><code id="drdid_imp_panel_+3A_y0">y0</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes from the pre-treatment period.</p>
</td></tr>
<tr><td><code id="drdid_imp_panel_+3A_d">D</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Group indicators (=1 if observation is treated in the post-treatment, =0 otherwise).</p>
</td></tr>
<tr><td><code id="drdid_imp_panel_+3A_covariates">covariates</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">k</code> matrix of covariates to be used in the propensity score and regression estimation.
If covariates = NULL, this leads to an unconditional DiD estimator.</p>
</td></tr>
<tr><td><code id="drdid_imp_panel_+3A_i.weights">i.weights</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of weights to be used. If NULL, then every observation has the same weights.</p>
</td></tr>
<tr><td><code id="drdid_imp_panel_+3A_boot">boot</code></td>
<td>
<p>Logical argument to whether bootstrap should be used for inference. Default is FALSE.</p>
</td></tr>
<tr><td><code id="drdid_imp_panel_+3A_boot.type">boot.type</code></td>
<td>
<p>Type of bootstrap to be performed (not relevant if <code>boot = FALSE</code>). Options are &quot;weighted&quot; and &quot;multiplier&quot;.
If <code>boot = TRUE</code>, default is &quot;weighted&quot;.</p>
</td></tr>
<tr><td><code id="drdid_imp_panel_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repetitions (not relevant if <code>boot = FALSE</code>). Default is 999.</p>
</td></tr>
<tr><td><code id="drdid_imp_panel_+3A_inffunc">inffunc</code></td>
<td>
<p>Logical argument to whether influence function should be returned. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>drdid_imp_panel</code> function implements the locally efficient doubly robust difference-in-differences (DiD)
estimator for the average treatment effect on the treated (ATT) defined in equation (3.1)
in Sant'Anna and Zhao (2020). This estimator makes use of a logistic propensity score model for the probability
of being in the treated group, and of a linear regression model for the outcome evolution among the comparison units.
</p>
<p>The nuisance parameters (propensity score and outcome regression parameters) are estimated using the methods
described in Sections 3.1 of Sant'Anna and Zhao (2020). In short, the propensity score parameters are estimated
using the inverse probability tilting estimator proposed by Graham, Pinto and Pinto (2012), and the outcome
regression coefficients are estimated using weighted least squares,where the weights depend on
the propensity score estimates; see Sant'Anna and Zhao (2020) for details.
</p>
<p>The resulting estimator is not only locally efficient and doubly robust for the ATT,
but it is also doubly robust for inference; see Sant'Anna and Zhao (2020) for details.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>ATT</code></td>
<td>
<p>The DiD point estimate.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>The DiD standard error.</p>
</td></tr>
<tr><td><code>uci</code></td>
<td>
<p>The upper bound of the 95% CI for the ATT.</p>
</td></tr>
<tr><td><code>lci</code></td>
<td>
<p>The lower bound of the 95% CI for the ATT</p>
</td></tr>
<tr><td><code>boots</code></td>
<td>
<p>All Bootstrap draws of the ATT, in case bootstrap was used to conduct inference. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code>ps.flag</code></td>
<td>
<p>Convergence Flag for the propensity score estimation: =0 if <code>trust</code> algorithm converged,
=1 if IPW algorithm converged (in case it was used), =2 if GLM logit estimator was used (i.e., if both <code>trust</code> and IPT
did not converged).</p>
</td></tr>
<tr><td><code>att.inf.func</code></td>
<td>
<p>Estimate of the influence function. Default is NULL</p>
</td></tr>
<tr><td><code>call.param</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>argu</code></td>
<td>
<p>Some arguments used (explicitly or not) in the call (panel = TRUE, estMethod = &quot;imp&quot;, boot, boot.type, nboot, type=&quot;dr&quot;)</p>
</td></tr>
</table>


<h3>References</h3>

<p><cite>Graham, Bryan, Pinto, Cristine, and Egel, Daniel (2012),
&quot;Inverse Probability Tilting for Moment Condition Models with Missing Data.&quot;
Review of Economic Studies, vol. 79 (3), pp. 1053-1079, <a href="https://doi.org/10.1093/restud/rdr047">doi:10.1093/restud/rdr047</a></cite>
</p>
<p><cite>Sant'Anna, Pedro H. C. and Zhao, Jun. (2020),
&quot;Doubly Robust Difference-in-Differences Estimators.&quot; Journal of Econometrics, Vol. 219 (1), pp. 101-122,
<a href="https://doi.org/10.1016/j.jeconom.2020.06.003">doi:10.1016/j.jeconom.2020.06.003</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Form the Lalonde sample with CPS comparison group
eval_lalonde_cps &lt;- subset(nsw, nsw$treated == 0 | nsw$sample == 2)
# Further reduce sample to speed example
set.seed(123)
unit_random &lt;- sample(1:nrow(eval_lalonde_cps), 5000)
eval_lalonde_cps &lt;- eval_lalonde_cps[unit_random,]
# Select some covariates
covX = as.matrix(cbind(eval_lalonde_cps$age, eval_lalonde_cps$educ,
                             eval_lalonde_cps$black, eval_lalonde_cps$married,
                             eval_lalonde_cps$nodegree, eval_lalonde_cps$hisp,
                             eval_lalonde_cps$re74))

# Implement improved DR locally efficient DiD with panel data
drdid_imp_panel(y1 = eval_lalonde_cps$re78, y0 = eval_lalonde_cps$re75,
                D = eval_lalonde_cps$experimental,
                covariates = covX)

</code></pre>

<hr>
<h2 id='drdid_imp_rc'>Improved locally efficient doubly robust DiD estimator for the ATT, with repeated cross-section data</h2><span id='topic+drdid_imp_rc'></span>

<h3>Description</h3>

<p><code>drdid_imp_rc</code> is used to compute the locally efficient doubly robust estimators for the ATT
in difference-in-differences (DiD) setups with stationary repeated cross-sectional data. The resulting estimator is
also doubly robust for inference; see Section 3.2 of Sant'Anna and Zhao (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drdid_imp_rc(
  y,
  post,
  D,
  covariates,
  i.weights = NULL,
  boot = FALSE,
  boot.type = "weighted",
  nboot = NULL,
  inffunc = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drdid_imp_rc_+3A_y">y</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes from the both pre and post-treatment periods.</p>
</td></tr>
<tr><td><code id="drdid_imp_rc_+3A_post">post</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Post-Treatment dummies (post = 1 if observation belongs to post-treatment period,
and post = 0 if observation belongs to pre-treatment period.)</p>
</td></tr>
<tr><td><code id="drdid_imp_rc_+3A_d">D</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Group indicators (=1 if observation is treated in the post-treatment, =0 otherwise).</p>
</td></tr>
<tr><td><code id="drdid_imp_rc_+3A_covariates">covariates</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">k</code> matrix of covariates to be used in the propensity score and regression estimation.
If covariates = NULL, this leads to an unconditional DiD estimator.</p>
</td></tr>
<tr><td><code id="drdid_imp_rc_+3A_i.weights">i.weights</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of weights to be used. If NULL, then every observation has the same weights.</p>
</td></tr>
<tr><td><code id="drdid_imp_rc_+3A_boot">boot</code></td>
<td>
<p>Logical argument to whether bootstrap should be used for inference. Default is FALSE.</p>
</td></tr>
<tr><td><code id="drdid_imp_rc_+3A_boot.type">boot.type</code></td>
<td>
<p>Type of bootstrap to be performed (not relevant if <code>boot = FALSE</code>). Options are &quot;weighted&quot; and &quot;multiplier&quot;.
If <code>boot = TRUE</code>, default is &quot;weighted&quot;.</p>
</td></tr>
<tr><td><code id="drdid_imp_rc_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repetitions (not relevant if <code>boot = FALSE</code>). Default is 999.</p>
</td></tr>
<tr><td><code id="drdid_imp_rc_+3A_inffunc">inffunc</code></td>
<td>
<p>Logical argument to whether influence function should be returned. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>drdid_imp_rc</code> function implements the locally efficient doubly robust difference-in-differences (DiD)
estimator for the average treatment effect on the treated (ATT) defined in equation (3.4)
in Sant'Anna and Zhao (2020). This estimator makes use of a logistic propensity score model for the probability
of being in the treated group, and of (separate) linear regression models for the outcome of both
treated and comparison units, in both pre and post-treatment periods.
</p>
<p>The nuisance parameters (propensity score and outcome regression parameters) are estimated using the methods
described in Sections 3.2 of Sant'Anna and Zhao (2020). In short, the propensity score parameters are estimated
using the inverse probability tilting estimator proposed by Graham, Pinto and Pinto (2012), and the outcome
regression coefficients are estimated using weighted least squares,where the weights depend on
the propensity score estimates; see Sant'Anna and Zhao (2020) for details.
</p>
<p>The resulting estimator is not only locally efficient and doubly robust for the ATT,
but it is also doubly robust for inference; see Sant'Anna and Zhao (2020) for details.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>ATT</code></td>
<td>
<p>The DR DiD point estimate</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p> The DR DiD standard error</p>
</td></tr>
<tr><td><code>uci</code></td>
<td>
<p>Estimate of the upper bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>lci</code></td>
<td>
<p>Estimate of the lower bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>boots</code></td>
<td>
<p>All Bootstrap draws of the ATT, in case bootstrap was used to conduct inference. Default is NULL</p>
</td></tr>
<tr><td><code>ps.flag</code></td>
<td>
<p>Convergence Flag for the propensity score estimation: =0 if <code>trust</code> algorithm converged,
=1 if IPW algorithm converged (in case it was used), =2 if GLM logit estimator was used (i.e., if both <code>trust</code> and IPT
did not converged).</p>
</td></tr>
<tr><td><code>att.inf.func</code></td>
<td>
<p>Estimate of the influence function. Default is NULL</p>
</td></tr>
<tr><td><code>call.param</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>argu</code></td>
<td>
<p>Some arguments used (explicitly or not) in the call (panel = FALSE, estMethod = &quot;imp&quot;, boot, boot.type, nboot, type=&quot;dr&quot;)</p>
</td></tr>
</table>


<h3>References</h3>

<p><cite>Graham, Bryan, Pinto, Cristine, and Egel, Daniel (2012),
&quot;Inverse Probability Tilting for Moment Condition Models with Missing Data.&quot;
Review of Economic Studies, vol. 79 (3), pp. 1053-1079, <a href="https://doi.org/10.1093/restud/rdr047">doi:10.1093/restud/rdr047</a></cite>
</p>
<p><cite>Sant'Anna, Pedro H. C. and Zhao, Jun. (2020),
&quot;Doubly Robust Difference-in-Differences Estimators.&quot; Journal of Econometrics, Vol. 219 (1), pp. 101-122,
<a href="https://doi.org/10.1016/j.jeconom.2020.06.003">doi:10.1016/j.jeconom.2020.06.003</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># use the simulated data
covX = as.matrix(sim_rc[,5:8])
# Implement the improved, locally efficient DR DiD estimator
drdid_imp_rc(y = sim_rc$y, post = sim_rc$post, D = sim_rc$d,
             covariates= covX)

</code></pre>

<hr>
<h2 id='drdid_imp_rc1'>Improved doubly robust DiD estimator for the ATT, with repeated cross-section data</h2><span id='topic+drdid_imp_rc1'></span>

<h3>Description</h3>

<p><code>drdid_imp_rc1</code> is used to compute the doubly robust estimators for the ATT
in difference-in-differences (DiD) setups with stationary repeated cross-sectional data. The resulting estimator is also doubly robust for inference,
though it is not locally efficient; see Section 3.2 of Sant'Anna and Zhao (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drdid_imp_rc1(
  y,
  post,
  D,
  covariates,
  i.weights = NULL,
  boot = FALSE,
  boot.type = "weighted",
  nboot = NULL,
  inffunc = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drdid_imp_rc1_+3A_y">y</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes from the both pre and post-treatment periods.</p>
</td></tr>
<tr><td><code id="drdid_imp_rc1_+3A_post">post</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Post-Treatment dummies (post = 1 if observation belongs to post-treatment period,
and post = 0 if observation belongs to pre-treatment period.)</p>
</td></tr>
<tr><td><code id="drdid_imp_rc1_+3A_d">D</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Group indicators (=1 if observation is treated in the post-treatment, =0 otherwise).</p>
</td></tr>
<tr><td><code id="drdid_imp_rc1_+3A_covariates">covariates</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">k</code> matrix of covariates to be used in the propensity score and regression estimation.
If covariates = NULL, this leads to an unconditional DiD estimator.</p>
</td></tr>
<tr><td><code id="drdid_imp_rc1_+3A_i.weights">i.weights</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of weights to be used. If NULL, then every observation has the same weights.</p>
</td></tr>
<tr><td><code id="drdid_imp_rc1_+3A_boot">boot</code></td>
<td>
<p>Logical argument to whether bootstrap should be used for inference. Default is FALSE.</p>
</td></tr>
<tr><td><code id="drdid_imp_rc1_+3A_boot.type">boot.type</code></td>
<td>
<p>Type of bootstrap to be performed (not relevant if <code>boot = FALSE</code>). Options are &quot;weighted&quot; and &quot;multiplier&quot;.
If <code>boot = TRUE</code>, default is &quot;weighted&quot;.</p>
</td></tr>
<tr><td><code id="drdid_imp_rc1_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repetitions (not relevant if <code>boot = FALSE</code>). Default is 999.</p>
</td></tr>
<tr><td><code id="drdid_imp_rc1_+3A_inffunc">inffunc</code></td>
<td>
<p>Logical argument to whether influence function should be returned. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>drdid_imp_rc1</code> function implements the doubly robust difference-in-differences (DiD)
estimator for the average treatment effect on the treated (ATT) defined in equation (3.3)
in Sant'Anna and Zhao (2020). This estimator makes use of a logistic propensity score model for the probability
of being in the treated group, and of (separate) linear regression models for the outcome among the comparison units in both pre and
post-treatment time periods. Importantly, this estimator is not locally efficient for the ATT.
</p>
<p>The nuisance parameters (propensity score and outcome regression parameters) are estimated using the methods
described in Sections 3.2 of Sant'Anna and Zhao (2020). In short, the propensity score parameters are estimated
using the inverse probability tilting estimator proposed by Graham, Pinto and Pinto (2012), and the outcome
regression coefficients are estimated using weighted least squares,where the weights depend on
the propensity score estimates; see Sant'Anna and Zhao (2020) for details.
</p>
<p>The resulting estimator is not only doubly robust for the ATT,
but it is also doubly robust for inference. However, we stress that it is not locally efficient;
see Sant'Anna and Zhao (2020) for details.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>ATT</code></td>
<td>
<p>The DR DiD point estimate</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p> The DR DiD standard error</p>
</td></tr>
<tr><td><code>uci</code></td>
<td>
<p>Estimate of the upper bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>lci</code></td>
<td>
<p>Estimate of the lower bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>boots</code></td>
<td>
<p>All Bootstrap draws of the ATT, in case bootstrap was used to conduct inference. Default is NULL</p>
</td></tr>
<tr><td><code>ps.flag</code></td>
<td>
<p>Convergence Flag for the propensity score estimation: =0 if <code>trust</code> algorithm converged,
=1 if IPW algorithm converged (in case it was used), =2 if GLM logit estimator was used (i.e., if both <code>trust</code> and IPT
did not converged).</p>
</td></tr>
<tr><td><code>att.inf.func</code></td>
<td>
<p>Estimate of the influence function. Default is NULL</p>
</td></tr>
<tr><td><code>call.param</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>argu</code></td>
<td>
<p>Some arguments used (explicitly or not) in the call (panel = FALSE, estMethod = &quot;imp2&quot;, boot, boot.type, nboot, type=&quot;dr&quot;)</p>
</td></tr>
</table>


<h3>References</h3>

<p><cite>Graham, Bryan, Pinto, Cristine, and Egel, Daniel (2012),
&quot;Inverse Probability Tilting for Moment Condition Models with Missing Data.&quot;
Review of Economic Studies, vol. 79 (3), pp. 1053-1079, <a href="https://doi.org/10.1093/restud/rdr047">doi:10.1093/restud/rdr047</a></cite>
</p>
<p><cite>Sant'Anna, Pedro H. C. and Zhao, Jun. (2020),
&quot;Doubly Robust Difference-in-Differences Estimators.&quot; Journal of Econometrics, Vol. 219 (1), pp. 101-122,
<a href="https://doi.org/10.1016/j.jeconom.2020.06.003">doi:10.1016/j.jeconom.2020.06.003</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># use the simulated data provided in the package
covX = as.matrix(sim_rc[,5:8])
# Implement the improved DR DiD estimator (but not locally efficient!)
drdid_imp_rc1(y = sim_rc$y, post = sim_rc$post, D = sim_rc$d,
             covariates= covX)

</code></pre>

<hr>
<h2 id='drdid_panel'>Locally efficient doubly robust DiD estimator for the ATT, with panel data</h2><span id='topic+drdid_panel'></span>

<h3>Description</h3>

<p><code>drdid_panel</code> is used to compute the locally efficient doubly robust estimators for the ATT
in difference-in-differences (DiD) setups with panel data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drdid_panel(
  y1,
  y0,
  D,
  covariates,
  i.weights = NULL,
  boot = FALSE,
  boot.type = "weighted",
  nboot = NULL,
  inffunc = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drdid_panel_+3A_y1">y1</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes from the post-treatment period.</p>
</td></tr>
<tr><td><code id="drdid_panel_+3A_y0">y0</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes from the pre-treatment period.</p>
</td></tr>
<tr><td><code id="drdid_panel_+3A_d">D</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Group indicators (=1 if observation is treated in the post-treatment, =0 otherwise).</p>
</td></tr>
<tr><td><code id="drdid_panel_+3A_covariates">covariates</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">k</code> matrix of covariates to be used in the propensity score and regression estimation.
If covariates = NULL, this leads to an unconditional DiD estimator.</p>
</td></tr>
<tr><td><code id="drdid_panel_+3A_i.weights">i.weights</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of weights to be used. If NULL, then every observation has the same weights.</p>
</td></tr>
<tr><td><code id="drdid_panel_+3A_boot">boot</code></td>
<td>
<p>Logical argument to whether bootstrap should be used for inference. Default is FALSE.</p>
</td></tr>
<tr><td><code id="drdid_panel_+3A_boot.type">boot.type</code></td>
<td>
<p>Type of bootstrap to be performed (not relevant if <code>boot = FALSE</code>). Options are &quot;weighted&quot; and &quot;multiplier&quot;.
If <code>boot = TRUE</code>, default is &quot;weighted&quot;.</p>
</td></tr>
<tr><td><code id="drdid_panel_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repetitions (not relevant if <code>boot = FALSE</code>). Default is 999.</p>
</td></tr>
<tr><td><code id="drdid_panel_+3A_inffunc">inffunc</code></td>
<td>
<p>Logical argument to whether influence function should be returned. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>drdid_panel</code> function implements the locally efficient doubly robust difference-in-differences (DiD)
estimator for the average treatment effect on the treated (ATT) defined in equation (3.1)
in Sant'Anna and Zhao (2020). This estimator makes use of a logistic propensity score model for the probability
of being in the treated group, and of a linear regression model for the outcome evolution among the comparison units.
</p>
<p>The propensity score parameters are estimated using maximum
likelihood, and the outcome regression coefficients are estimated using ordinary least squares.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>ATT</code></td>
<td>
<p>The DR DiD point estimate.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p> The DR DiD standard error.</p>
</td></tr>
<tr><td><code>uci</code></td>
<td>
<p>Estimate of the upper bound of a 95% CI for the ATT.</p>
</td></tr>
<tr><td><code>lci</code></td>
<td>
<p>Estimate of the lower bound of a 95% CI for the ATT.</p>
</td></tr>
<tr><td><code>boots</code></td>
<td>
<p>All Bootstrap draws of the ATT, in case bootstrap was used to conduct inference. Default is NULL.</p>
</td></tr>
<tr><td><code>att.inf.func</code></td>
<td>
<p>Estimate of the influence function. Default is NULL.</p>
</td></tr>
<tr><td><code>call.param</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>argu</code></td>
<td>
<p>Some arguments used (explicitly or not) in the call (panel = TRUE, estMethod = &quot;trad&quot;, boot, boot.type, nboot, type=&quot;dr&quot;)</p>
</td></tr>
</table>


<h3>References</h3>


<p><cite>Sant'Anna, Pedro H. C. and Zhao, Jun. (2020),
&quot;Doubly Robust Difference-in-Differences Estimators.&quot; Journal of Econometrics, Vol. 219 (1), pp. 101-122,
<a href="https://doi.org/10.1016/j.jeconom.2020.06.003">doi:10.1016/j.jeconom.2020.06.003</a></cite>

</p>


<h3>Examples</h3>

<pre><code class='language-R'># Form the Lalonde sample with CPS comparison group (data in wide format)
eval_lalonde_cps &lt;- subset(nsw, nsw$treated == 0 | nsw$sample == 2)
# Further reduce sample to speed example
set.seed(123)
unit_random &lt;- sample(1:nrow(eval_lalonde_cps), 5000)
eval_lalonde_cps &lt;- eval_lalonde_cps[unit_random,]
# Select some covariates
covX = as.matrix(cbind(eval_lalonde_cps$age, eval_lalonde_cps$educ,
                       eval_lalonde_cps$black, eval_lalonde_cps$married,
                       eval_lalonde_cps$nodegree, eval_lalonde_cps$hisp,
                       eval_lalonde_cps$re74))

# Implement traditional DR locally efficient DiD with panel data
drdid_panel(y1 = eval_lalonde_cps$re78, y0 = eval_lalonde_cps$re75,
             D = eval_lalonde_cps$experimental,
             covariates = covX)

</code></pre>

<hr>
<h2 id='drdid_rc'>Locally efficient doubly robust DiD estimator for the ATT, with repeated cross-section data</h2><span id='topic+drdid_rc'></span>

<h3>Description</h3>

<p><code>drdid_rc</code> is used to compute the locally efficient doubly robust estimators for the ATT
in difference-in-differences (DiD) setups with stationary repeated cross-sectional data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drdid_rc(
  y,
  post,
  D,
  covariates,
  i.weights = NULL,
  boot = FALSE,
  boot.type = "weighted",
  nboot = NULL,
  inffunc = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drdid_rc_+3A_y">y</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes from the both pre and post-treatment periods.</p>
</td></tr>
<tr><td><code id="drdid_rc_+3A_post">post</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Post-Treatment dummies (post = 1 if observation belongs to post-treatment period,
and post = 0 if observation belongs to pre-treatment period.)</p>
</td></tr>
<tr><td><code id="drdid_rc_+3A_d">D</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Group indicators (=1 if observation is treated in the post-treatment, =0 otherwise).</p>
</td></tr>
<tr><td><code id="drdid_rc_+3A_covariates">covariates</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">k</code> matrix of covariates to be used in the propensity score and regression estimation.
If covariates = NULL, this leads to an unconditional DiD estimator.</p>
</td></tr>
<tr><td><code id="drdid_rc_+3A_i.weights">i.weights</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of weights to be used. If NULL, then every observation has the same weights.</p>
</td></tr>
<tr><td><code id="drdid_rc_+3A_boot">boot</code></td>
<td>
<p>Logical argument to whether bootstrap should be used for inference. Default is FALSE.</p>
</td></tr>
<tr><td><code id="drdid_rc_+3A_boot.type">boot.type</code></td>
<td>
<p>Type of bootstrap to be performed (not relevant if <code>boot = FALSE</code>). Options are &quot;weighted&quot; and &quot;multiplier&quot;.
If <code>boot = TRUE</code>, default is &quot;weighted&quot;.</p>
</td></tr>
<tr><td><code id="drdid_rc_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repetitions (not relevant if <code>boot = FALSE</code>). Default is 999.</p>
</td></tr>
<tr><td><code id="drdid_rc_+3A_inffunc">inffunc</code></td>
<td>
<p>Logical argument to whether influence function should be returned. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>drdid_rc</code> function implements the locally efficient doubly robust difference-in-differences (DiD)
estimator for the average treatment effect on the treated (ATT) defined in equation (3.4)
in Sant'Anna and Zhao (2020). This estimator makes use of a logistic propensity score model for the probability
of being in the treated group, and of (separate) linear regression models for the outcome of both treated and comparison units,
in both pre and post-treatment periods.
</p>
<p>The propensity score parameters are estimated using maximum
likelihood, and the outcome regression coefficients are estimated using ordinary least squares;
see Sant'Anna and Zhao (2020) for details.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>ATT</code></td>
<td>
<p>The DR DiD point estimate</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p> The DR DiD standard error</p>
</td></tr>
<tr><td><code>uci</code></td>
<td>
<p>Estimate of the upper bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>lci</code></td>
<td>
<p>Estimate of the lower bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>boots</code></td>
<td>
<p>All Bootstrap draws of the ATT, in case bootstrap was used to conduct inference. Default is NULL</p>
</td></tr>
<tr><td><code>att.inf.func</code></td>
<td>
<p>Estimate of the influence function. Default is NULL</p>
</td></tr>
<tr><td><code>call.param</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>argu</code></td>
<td>
<p>Some arguments used (explicitly or not) in the call (panel = TRUE, estMethod = &quot;trad&quot;, boot, boot.type, nboot, type=&quot;dr&quot;)</p>
</td></tr>
</table>


<h3>References</h3>


<p><cite>Sant'Anna, Pedro H. C. and Zhao, Jun. (2020),
&quot;Doubly Robust Difference-in-Differences Estimators.&quot; Journal of Econometrics, Vol. 219 (1), pp. 101-122,
<a href="https://doi.org/10.1016/j.jeconom.2020.06.003">doi:10.1016/j.jeconom.2020.06.003</a></cite>

</p>


<h3>Examples</h3>

<pre><code class='language-R'># use the simulated data provided in the package
covX = as.matrix(sim_rc[,5:8])
# Implement the 'traditional' locally efficient DR DiD estimator
drdid_rc(y = sim_rc$y, post = sim_rc$post, D = sim_rc$d,
         covariates= covX)

</code></pre>

<hr>
<h2 id='drdid_rc1'>Doubly robust DiD estimator for the ATT, with repeated cross-section data</h2><span id='topic+drdid_rc1'></span>

<h3>Description</h3>

<p><code>drdid_rc1</code> is used to compute the doubly robust estimators for the ATT
in difference-in-differences (DiD) setups with stationary repeated cross-sectional data. The resulting estimator is
not locally efficient; see Section 3.2 of Sant'Anna and Zhao (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drdid_rc1(
  y,
  post,
  D,
  covariates,
  i.weights = NULL,
  boot = FALSE,
  boot.type = "weighted",
  nboot = NULL,
  inffunc = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drdid_rc1_+3A_y">y</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes from the both pre and post-treatment periods.</p>
</td></tr>
<tr><td><code id="drdid_rc1_+3A_post">post</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Post-Treatment dummies (post = 1 if observation belongs to post-treatment period,
and post = 0 if observation belongs to pre-treatment period.)</p>
</td></tr>
<tr><td><code id="drdid_rc1_+3A_d">D</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Group indicators (=1 if observation is treated in the post-treatment, =0 otherwise).</p>
</td></tr>
<tr><td><code id="drdid_rc1_+3A_covariates">covariates</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">k</code> matrix of covariates to be used in the propensity score and regression estimation.
If covariates = NULL, this leads to an unconditional DiD estimator.</p>
</td></tr>
<tr><td><code id="drdid_rc1_+3A_i.weights">i.weights</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of weights to be used. If NULL, then every observation has the same weights.</p>
</td></tr>
<tr><td><code id="drdid_rc1_+3A_boot">boot</code></td>
<td>
<p>Logical argument to whether bootstrap should be used for inference. Default is FALSE.</p>
</td></tr>
<tr><td><code id="drdid_rc1_+3A_boot.type">boot.type</code></td>
<td>
<p>Type of bootstrap to be performed (not relevant if <code>boot = FALSE</code>). Options are &quot;weighted&quot; and &quot;multiplier&quot;.
If <code>boot = TRUE</code>, default is &quot;weighted&quot;.</p>
</td></tr>
<tr><td><code id="drdid_rc1_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repetitions (not relevant if <code>boot = FALSE</code>). Default is 999.</p>
</td></tr>
<tr><td><code id="drdid_rc1_+3A_inffunc">inffunc</code></td>
<td>
<p>Logical argument to whether influence function should be returned. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>drdid_rc1</code> function implements the doubly robust difference-in-differences (DiD)
estimator for the average treatment effect on the treated (ATT) defined in equation (3.3)
in Sant'Anna and Zhao (2020). This estimator makes use of a logistic propensity score model for the probability
of being in the treated group, and of (separate) linear regression models for the outcome among the comparison units in both pre and
post-treatment time periods. Importantly, this estimator is not locally efficient for the ATT.
</p>
<p>The propensity score parameters are estimated using maximum
likelihood, and the outcome regression coefficients are estimated using ordinary least squares.
</p>
<p>The resulting estimator is not not locally efficient; see Sant'Anna and Zhao (2020) for details.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>ATT</code></td>
<td>
<p>The DR DiD point estimate</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p> The DR DiD standard error</p>
</td></tr>
<tr><td><code>uci</code></td>
<td>
<p>Estimate of the upper bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>lci</code></td>
<td>
<p>Estimate of the lower bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>boots</code></td>
<td>
<p>All Bootstrap draws of the ATT, in case bootstrap was used to conduct inference. Default is NULL</p>
</td></tr>
<tr><td><code>att.inf.func</code></td>
<td>
<p>Estimate of the influence function. Default is NULL</p>
</td></tr>
<tr><td><code>call.param</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>argu</code></td>
<td>
<p>Some arguments used (explicitly or not) in the call (panel = FALSE, estMethod = &quot;trad2&quot;, boot, boot.type, nboot, type=&quot;dr&quot;)</p>
</td></tr>
</table>


<h3>References</h3>


<p><cite>Sant'Anna, Pedro H. C. and Zhao, Jun. (2020),
&quot;Doubly Robust Difference-in-Differences Estimators.&quot; Journal of Econometrics, Vol. 219 (1), pp. 101-122,
<a href="https://doi.org/10.1016/j.jeconom.2020.06.003">doi:10.1016/j.jeconom.2020.06.003</a></cite>

</p>


<h3>Examples</h3>

<pre><code class='language-R'># use the simulated data provided in the package
covX = as.matrix(sim_rc[,5:8])
# Implement the 'traditional' DR DiD estimator (not locally efficient!)
drdid_rc1(y = sim_rc$y, post = sim_rc$post, D = sim_rc$d,
          covariates= covX)

</code></pre>

<hr>
<h2 id='ipw_did_panel'>Inverse probability weighted DiD estimator, with panel data</h2><span id='topic+ipw_did_panel'></span>

<h3>Description</h3>

<p><code>ipw_did_panel</code> is used to compute inverse probability weighted (IPW) estimators for the ATT
in difference-in-differences (DiD) setups with panel data. IPW weights are not normalized to sum up to one,
that is, the estimator is of the Horwitz-Thompson type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipw_did_panel(
  y1,
  y0,
  D,
  covariates,
  i.weights = NULL,
  boot = FALSE,
  boot.type = "weighted",
  nboot = NULL,
  inffunc = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ipw_did_panel_+3A_y1">y1</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes from the post-treatment period.</p>
</td></tr>
<tr><td><code id="ipw_did_panel_+3A_y0">y0</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes from the pre-treatment period.</p>
</td></tr>
<tr><td><code id="ipw_did_panel_+3A_d">D</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Group indicators (=1 if observation is treated in the post-treatment, =0 otherwise).</p>
</td></tr>
<tr><td><code id="ipw_did_panel_+3A_covariates">covariates</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">k</code> matrix of covariates to be used in the propensity score estimation.
If covariates = NULL, this leads to an unconditional DiD estimator.</p>
</td></tr>
<tr><td><code id="ipw_did_panel_+3A_i.weights">i.weights</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of weights to be used. If NULL, then every observation has the same weights.</p>
</td></tr>
<tr><td><code id="ipw_did_panel_+3A_boot">boot</code></td>
<td>
<p>Logical argument to whether bootstrap should be used for inference. Default is FALSE.</p>
</td></tr>
<tr><td><code id="ipw_did_panel_+3A_boot.type">boot.type</code></td>
<td>
<p>Type of bootstrap to be performed (not relevant if <code>boot = FALSE</code>). Options are &quot;weighted&quot; and &quot;multiplier&quot;.
If <code>boot = TRUE</code>, default is &quot;weighted&quot;.</p>
</td></tr>
<tr><td><code id="ipw_did_panel_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repetitions (not relevant if <code>boot = FALSE</code>). Default is 999.</p>
</td></tr>
<tr><td><code id="ipw_did_panel_+3A_inffunc">inffunc</code></td>
<td>
<p>Logical argument to whether influence function should be returned. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>ATT</code></td>
<td>
<p>The IPW DiD point estimate.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p> The IPW DiD standard error</p>
</td></tr>
<tr><td><code>uci</code></td>
<td>
<p>Estimate of the upper bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>lci</code></td>
<td>
<p>Estimate of the lower bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>boots</code></td>
<td>
<p>All Bootstrap draws of the ATT, in case bootstrap was used to conduct inference. Default is NULL</p>
</td></tr>
<tr><td><code>att.inf.func</code></td>
<td>
<p>Estimate of the influence function. Default is NULL</p>
</td></tr>
<tr><td><code>call.param</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>argu</code></td>
<td>
<p>Some arguments used (explicitly or not) in the call (panel = TRUE, normalized = FALSE, boot, boot.type, nboot, type=&quot;ipw&quot;)</p>
</td></tr>
</table>


<h3>References</h3>

<p><cite>Abadie, Alberto (2005), &quot;Semiparametric Difference-in-Differences Estimators&quot;,
Review of Economic Studies, vol. 72(1), p. 1-19, <a href="https://doi.org/10.1111/0034-6527.00321">doi:10.1111/0034-6527.00321</a></cite>
</p>
<p><cite>Sant'Anna, Pedro H. C. and Zhao, Jun. (2020),
&quot;Doubly Robust Difference-in-Differences Estimators.&quot; Journal of Econometrics, Vol. 219 (1), pp. 101-122,
<a href="https://doi.org/10.1016/j.jeconom.2020.06.003">doi:10.1016/j.jeconom.2020.06.003</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Form the Lalonde sample with CPS comparison group
eval_lalonde_cps &lt;- subset(nsw, nsw$treated == 0 | nsw$sample == 2)
# Further reduce sample to speed example
set.seed(123)
unit_random &lt;- sample(1:nrow(eval_lalonde_cps), 5000)
eval_lalonde_cps &lt;- eval_lalonde_cps[unit_random,]
# Select some covariates
covX = as.matrix(cbind(eval_lalonde_cps$age, eval_lalonde_cps$educ,
                             eval_lalonde_cps$black, eval_lalonde_cps$married,
                             eval_lalonde_cps$nodegree, eval_lalonde_cps$hisp,
                             eval_lalonde_cps$re74))
# Implement (unnormalized) IPW DiD with panel data
ipw_did_panel(y1 = eval_lalonde_cps$re78, y0 = eval_lalonde_cps$re75,
                D = eval_lalonde_cps$experimental,
                covariates = covX)

</code></pre>

<hr>
<h2 id='ipw_did_rc'>Inverse probability weighted DiD estimator, with repeated cross-section data</h2><span id='topic+ipw_did_rc'></span>

<h3>Description</h3>

<p><code>ipw_did_rc</code> is used to compute inverse probability weighted (IPW) estimators for the ATT
in difference-in-differences (DiD) setups with stationary cross-sectional data. IPW weights are not normalized
to sum up to one, that is, the estimator is of the Horwitz-Thompson type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipw_did_rc(
  y,
  post,
  D,
  covariates,
  i.weights = NULL,
  boot = FALSE,
  boot.type = "weighted",
  nboot = NULL,
  inffunc = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ipw_did_rc_+3A_y">y</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes from the both pre and post-treatment periods.</p>
</td></tr>
<tr><td><code id="ipw_did_rc_+3A_post">post</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Post-Treatment dummies (post = 1 if observation belongs to post-treatment period,
and post = 0 if observation belongs to pre-treatment period.)</p>
</td></tr>
<tr><td><code id="ipw_did_rc_+3A_d">D</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Group indicators (=1 if observation is treated in the post-treatment, =0 otherwise).</p>
</td></tr>
<tr><td><code id="ipw_did_rc_+3A_covariates">covariates</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">k</code> matrix of covariates to be used in the propensity score estimation.
If covariates = NULL, this leads to an unconditional DiD estimator.</p>
</td></tr>
<tr><td><code id="ipw_did_rc_+3A_i.weights">i.weights</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of weights to be used. If NULL, then every observation has the same weights.</p>
</td></tr>
<tr><td><code id="ipw_did_rc_+3A_boot">boot</code></td>
<td>
<p>Logical argument to whether bootstrap should be used for inference. Default is FALSE.</p>
</td></tr>
<tr><td><code id="ipw_did_rc_+3A_boot.type">boot.type</code></td>
<td>
<p>Type of bootstrap to be performed (not relevant if <code>boot = FALSE</code>). Options are &quot;weighted&quot; and &quot;multiplier&quot;.
If <code>boot = TRUE</code>, default is &quot;weighted&quot;.</p>
</td></tr>
<tr><td><code id="ipw_did_rc_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repetitions (not relevant if <code>boot = FALSE</code>). Default is 999.</p>
</td></tr>
<tr><td><code id="ipw_did_rc_+3A_inffunc">inffunc</code></td>
<td>
<p>Logical argument to whether influence function should be returned. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>ATT</code></td>
<td>
<p>The IPW DiD point estimate.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p> The IPW DiD standard error</p>
</td></tr>
<tr><td><code>uci</code></td>
<td>
<p>Estimate of the upper bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>lci</code></td>
<td>
<p>Estimate of the lower bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>boots</code></td>
<td>
<p>All Bootstrap draws of the ATT, in case bootstrap was used to conduct inference. Default is NULL</p>
</td></tr>
<tr><td><code>att.inf.func</code></td>
<td>
<p>Estimate of the influence function. Default is NULL</p>
</td></tr>
<tr><td><code>call.param</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>argu</code></td>
<td>
<p>Some arguments used (explicitly or not) in the call (panel = FALSE, normalized = FALSE, boot, boot.type, nboot, type=&quot;ipw&quot;)</p>
</td></tr>
</table>


<h3>References</h3>

<p><cite>Abadie, Alberto (2005), &quot;Semiparametric Difference-in-Differences Estimators&quot;,
Review of Economic Studies, vol. 72(1), p. 1-19, <a href="https://doi.org/10.1111/0034-6527.00321">doi:10.1111/0034-6527.00321</a></cite>
</p>
<p><cite>Sant'Anna, Pedro H. C. and Zhao, Jun. (2020),
&quot;Doubly Robust Difference-in-Differences Estimators.&quot; Journal of Econometrics, Vol. 219 (1), pp. 101-122,
<a href="https://doi.org/10.1016/j.jeconom.2020.06.003">doi:10.1016/j.jeconom.2020.06.003</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># use the simulated data provided in the package
covX = as.matrix(sim_rc[,5:8])
# Implement unnormalized IPW DiD estimator
ipw_did_rc(y = sim_rc$y, post = sim_rc$post, D = sim_rc$d,
           covariates= covX)

</code></pre>

<hr>
<h2 id='ipwdid'>Inverse probability weighted DiD estimators for the ATT</h2><span id='topic+ipwdid'></span>

<h3>Description</h3>

<p><code>ipwdid</code> computes the inverse probability weighted estimators for the average treatment effect
on the treated in difference-in-differences (DiD) setups. It can be used with panel or stationary repeated
cross-sectional data, with or without normalized (stabilized) weights. See Abadie (2005) and Sant'Anna and
Zhao (2020) for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipwdid(
  yname,
  tname,
  idname,
  dname,
  xformla = NULL,
  data,
  panel = TRUE,
  normalized = TRUE,
  weightsname = NULL,
  boot = FALSE,
  boot.type = c("weighted", "multiplier"),
  nboot = 999,
  inffunc = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ipwdid_+3A_yname">yname</code></td>
<td>
<p>The name of the outcome variable.</p>
</td></tr>
<tr><td><code id="ipwdid_+3A_tname">tname</code></td>
<td>
<p>The name of the column containing the time periods.</p>
</td></tr>
<tr><td><code id="ipwdid_+3A_idname">idname</code></td>
<td>
<p>The name of the column containing the unit id name.</p>
</td></tr>
<tr><td><code id="ipwdid_+3A_dname">dname</code></td>
<td>
<p>The name of the column containing the treatment group (=1 if observation is treated in the post-treatment, =0 otherwise)</p>
</td></tr>
<tr><td><code id="ipwdid_+3A_xformla">xformla</code></td>
<td>
<p>A formula for the covariates to include in the model. It should be of the form <code>~ X1 + X2</code>
(intercept should not be listed as it is always automatically included). Default is NULL which is equivalent to <code>xformla=~1</code>.</p>
</td></tr>
<tr><td><code id="ipwdid_+3A_data">data</code></td>
<td>
<p>The name of the data.frame that contains the data.</p>
</td></tr>
<tr><td><code id="ipwdid_+3A_panel">panel</code></td>
<td>
<p>Whether or not the data is a panel dataset. The panel dataset should be provided in long format &ndash; that
is, where each row corresponds to a unit observed at a particular point in time.  The default is TRUE.
When <code>panel = FALSE</code>, the data is treated
as stationary repeated cross sections.</p>
</td></tr>
<tr><td><code id="ipwdid_+3A_normalized">normalized</code></td>
<td>
<p>Logical argument to whether IPW weights should be normalized to sum up to one. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ipwdid_+3A_weightsname">weightsname</code></td>
<td>
<p>The name of the column containing the sampling weights. If NULL, then every observation has the same weights.</p>
</td></tr>
<tr><td><code id="ipwdid_+3A_boot">boot</code></td>
<td>
<p>Logical argument to whether bootstrap should be used for inference. Default is <code>FALSE</code> and analytical
standard errors are reported.</p>
</td></tr>
<tr><td><code id="ipwdid_+3A_boot.type">boot.type</code></td>
<td>
<p>Type of bootstrap to be performed (not relevant if <code>boot = FALSE</code>). Options are &quot;weighted&quot; and &quot;multiplier&quot;.
If <code>boot = TRUE</code>, default is &quot;weighted&quot;.</p>
</td></tr>
<tr><td><code id="ipwdid_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repetitions (not relevant if boot = <code>FALSE</code>). Default is 999.</p>
</td></tr>
<tr><td><code id="ipwdid_+3A_inffunc">inffunc</code></td>
<td>
<p>Logical argument to whether influence function should be returned. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>ipwdid</code> function implements the
inverse probability weighted (IPW) difference-in-differences (DiD) estimator for the average treatment effect
on the treated (ATT) proposed by Abadie (2005) (<code>normalized = FALSE</code>) or Hajek-type version
defined in equations (4.1) and (4.2) in Sant'Anna and Zhao (2020), when either panel data or
stationary repeated cross-sectional data are available. This estimator makes use of
a logistic propensity score model for the probability of being in the treated group, and the propensity score
parameters are estimated via maximum likelihood.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>ATT</code></td>
<td>
<p>The IPW DiD point estimate</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p> The IPW DiD standard error</p>
</td></tr>
<tr><td><code>uci</code></td>
<td>
<p>Estimate of the upper bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>lci</code></td>
<td>
<p>Estimate of the lower bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>boots</code></td>
<td>
<p>All Bootstrap draws of the ATT, in case bootstrap was used to conduct inference. Default is NULL</p>
</td></tr>
<tr><td><code>att.inf.func</code></td>
<td>
<p>Estimate of the influence function. Default is NULL</p>
</td></tr>
<tr><td><code>call.param</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>argu</code></td>
<td>
<p>Some arguments used in the call (panel, normalized, boot, boot.type, nboot, type==&quot;ipw&quot;)</p>
</td></tr>
</table>


<h3>References</h3>

<p><cite>Abadie, Alberto (2005), &quot;Semiparametric Difference-in-Differences Estimators&quot;,
Review of Economic Studies, vol. 72(1), p. 1-19, <a href="https://doi.org/10.1111/0034-6527.00321">doi:10.1111/0034-6527.00321</a></cite>
</p>
<p><cite>Sant'Anna, Pedro H. C. and Zhao, Jun. (2020),
&quot;Doubly Robust Difference-in-Differences Estimators.&quot; Journal of Econometrics, Vol. 219 (1), pp. 101-122,
<a href="https://doi.org/10.1016/j.jeconom.2020.06.003">doi:10.1016/j.jeconom.2020.06.003</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># -----------------------------------------------
# Panel data case
# -----------------------------------------------
# Form the Lalonde sample with CPS comparison group
eval_lalonde_cps &lt;- subset(nsw_long, nsw_long$treated == 0 | nsw_long$sample == 2)
# Further reduce sample to speed example
set.seed(123)
unit_random &lt;- sample(unique(eval_lalonde_cps$id), 5000)
eval_lalonde_cps &lt;- eval_lalonde_cps[eval_lalonde_cps$id %in% unit_random,]

# Implement IPW DiD with panel data (normalized weights)
ipwdid(yname="re", tname = "year", idname = "id", dname = "experimental",
      xformla= ~ age+ educ+ black+ married+ nodegree+ hisp+ re74,
      data = eval_lalonde_cps, panel = TRUE)

# -----------------------------------------------
# Repeated cross section case
# -----------------------------------------------
# use the simulated data provided in the package
#Implement IPW DiD with repeated cross-section data (normalized weights)
# use Bootstrap to make inference with 199 bootstrap draws (just for illustration)
ipwdid(yname="y", tname = "post", idname = "id", dname = "d",
      xformla= ~ x1 + x2 + x3 + x4,
      data = sim_rc, panel = FALSE,
      boot = TRUE, nboot = 199)

</code></pre>

<hr>
<h2 id='nsw'>National Supported Work Demonstration dataset</h2><span id='topic+nsw'></span>

<h3>Description</h3>

<p><code>nsw</code> contains all the subsamples of from the
National Supported Work (NSW) Demonstration analyzed used by Smith and Todd (2005)
in their paper &quot;Does matching overcome LaLonde's critique of nonexperimental estimators?&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nsw
</code></pre>


<h3>Format</h3>

<p>A data frame in &quot;wide&quot; format with 19204 observations on the following and 14 variables:
</p>

<dl>
<dt>treated</dt><dd><p>an indicator variable for treatment status. Missing if not part of the
NSW experimental sample</p>
</dd>
<dt>age</dt><dd><p>age in years.</p>
</dd>
<dt>educ</dt><dd><p>years of schooling.</p>
</dd>
<dt>black</dt><dd><p>indicator variable for blacks.</p>
</dd>
<dt>married</dt><dd><p>indicator variable for martial status.</p>
</dd>
<dt>nodegree</dt><dd><p>indicator variable for high school diploma.</p>
</dd>
<dt>dwincl</dt><dd><p>indicator variable for inclusion in Dehejia and Wahba sample.
Missing if not part of the experimental sample</p>
</dd>
<dt>re74</dt><dd><p>real earnings in 1974 (pre-treatment).</p>
</dd>
<dt>re75</dt><dd><p>real earnings in 1975 (pre-treatment).</p>
</dd>
<dt>re78</dt><dd><p>real earnings in 1978 (post-treatment).</p>
</dd>
<dt>hisp</dt><dd><p>indicator variable for Hispanics.</p>
</dd>
<dt>early_ra</dt><dd><p>indicator variable for inclusion in the early random assignment
sample in Smith and Todd (2005). Missing if not part of the experimental sample</p>
</dd>
<dt>sample</dt><dd><p>1 if NSW (experimental sample), 2 if CPS comparison group, 3 if PSID
comparison group.</p>
</dd>
<dt>experimental</dt><dd><p>1 if in experimental sample, 0 otherwise.</p>
</dd>
</dl>



<h3>Source</h3>

<p>https://dataverse.harvard.edu/file.xhtml?persistentId=doi:10.7910/DVN/23407/DYEWLO&amp;version=1.0.
</p>


<h3>References</h3>

<p><cite>Diamond, Alexis, and Sekhon, Jasjeet S. (2013),
'Genetic Matching for Estimating Causal Effects: A General Multivariate Matching Method for Achieving Balance
in Observational Studies' Review of Economics and Statistics, vol. 95 , pp. 932-945, <a href="https://doi.org/10.1162/REST_a_00318">doi:10.1162/REST_a_00318</a></cite>
</p>
<p><cite>Smith, Jeffrey, and Todd, Petra (2005),
Does matching overcome LaLonde's critique of nonexperimental estimators?' Journal of Econometrics,
vol. 125, pp. 305-353, <a href="https://doi.org/10.1016/j.jeconom.2004.04.011">doi:10.1016/j.jeconom.2004.04.011</a></cite>
</p>

<hr>
<h2 id='nsw_long'>National Supported Work Demonstration dataset, in long format</h2><span id='topic+nsw_long'></span>

<h3>Description</h3>

<p><code>nsw_long</code> is the same dataset as <code>nsw</code> but in a long format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nsw_long
</code></pre>


<h3>Format</h3>

<p>A data frame in &quot;long&quot; format with 38408 observations on the following and
15 variables:
</p>

<dl>
<dt>id</dt><dd><p>unique identifier for each cross-sectional unit (worker).</p>
</dd>
<dt>year</dt><dd><p>year. 1975 is the pre-treatment and 1978 is the post-treatment</p>
</dd>
<dt>treated</dt><dd><p>an indicator variable for treatment status. Missing if not part of the
NSW experimental sample.</p>
</dd>
<dt>age</dt><dd><p>age in years.</p>
</dd>
<dt>educ</dt><dd><p>years of schooling.</p>
</dd>
<dt>black</dt><dd><p>indicator variable for blacks.</p>
</dd>
<dt>married</dt><dd><p>indicator variable for martial status.</p>
</dd>
<dt>nodegree</dt><dd><p>indicator variable for high school diploma.</p>
</dd>
<dt>dwincl</dt><dd><p>indicator variable for inclusion in Dehejia and Wahba sample.
Missing if not part of the experimental sample</p>
</dd>
<dt>re74</dt><dd><p>real earnings in 1974 (pre-treatment).</p>
</dd>
<dt>hisp</dt><dd><p>indicator variable for Hispanics.</p>
</dd>
<dt>early_ra</dt><dd><p>indicator variable for inclusion in the early random assignment
sample in Smith and Todd (2005). Missing if not part of the experimental sample</p>
</dd>
<dt>sample</dt><dd><p>1 if NSW (experimental sample), 2 if CPS comparison group, 3 if PSID
comparison group.</p>
</dd>
<dt>re</dt><dd><p>real earnings (outcome of interest).</p>
</dd>
<dt>experimental</dt><dd><p>1 if in experimental sample, 0 otherwise.</p>
</dd>
</dl>



<h3>Source</h3>

<p>https://dataverse.harvard.edu/file.xhtml?persistentId=doi:10.7910/DVN/23407/DYEWLO&amp;version=1.0.
</p>


<h3>References</h3>

<p><cite>Diamond, Alexis, and Sekhon, Jasjeet S. (2013),
'Genetic Matching for Estimating Causal Effects: A General Multivariate Matching Method for Achieving Balance
in Observational Studies' Review of Economics and Statistics, vol. 95 , pp. 932-945, <a href="https://doi.org/10.1162/REST_a_00318">doi:10.1162/REST_a_00318</a></cite>
</p>
<p><cite>Smith, Jeffrey, and Todd, Petra (2005),
Does matching overcome LaLonde's critique of nonexperimental estimators?' Journal of Econometrics,
vol. 125, pp. 305-353, <a href="https://doi.org/10.1016/j.jeconom.2004.04.011">doi:10.1016/j.jeconom.2004.04.011</a></cite>
</p>

<hr>
<h2 id='ordid'>Outcome regression DiD estimators for the ATT</h2><span id='topic+ordid'></span>

<h3>Description</h3>

<p><code>ordid</code> computes the outcome regressions estimators for the average treatment effect on the
treated in difference-in-differences (DiD) setups. It can be used with panel or repeated cross section data.
See Sant'Anna and Zhao (2020) for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ordid(
  yname,
  tname,
  idname,
  dname,
  xformla = NULL,
  data,
  panel = TRUE,
  weightsname = NULL,
  boot = FALSE,
  boot.type = c("weighted", "multiplier"),
  nboot = 999,
  inffunc = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ordid_+3A_yname">yname</code></td>
<td>
<p>The name of the outcome variable.</p>
</td></tr>
<tr><td><code id="ordid_+3A_tname">tname</code></td>
<td>
<p>The name of the column containing the time periods.</p>
</td></tr>
<tr><td><code id="ordid_+3A_idname">idname</code></td>
<td>
<p>The name of the column containing the unit id name.</p>
</td></tr>
<tr><td><code id="ordid_+3A_dname">dname</code></td>
<td>
<p>The name of the column containing the treatment group (=1 if observation is treated in the post-treatment, =0 otherwise)</p>
</td></tr>
<tr><td><code id="ordid_+3A_xformla">xformla</code></td>
<td>
<p>A formula for the covariates to include in the model. It should be of the form <code>~ X1 + X2</code>.
(intercept should not be listed as it is always automatically included). Default is NULL which is equivalent to <code>xformla=~1</code>.</p>
</td></tr>
<tr><td><code id="ordid_+3A_data">data</code></td>
<td>
<p>The name of the data.frame that contains the data.</p>
</td></tr>
<tr><td><code id="ordid_+3A_panel">panel</code></td>
<td>
<p>Whether or not the data is a panel dataset. The panel dataset should be provided in long format &ndash; that
is, where each row corresponds to a unit observed at a particular point in time.  The default is TRUE.
When <code>panel = FALSE</code>, the data is treated
as stationary repeated cross sections.</p>
</td></tr>
<tr><td><code id="ordid_+3A_weightsname">weightsname</code></td>
<td>
<p>The name of the column containing the sampling weights. If NULL, then every observation has the same weights.</p>
</td></tr>
<tr><td><code id="ordid_+3A_boot">boot</code></td>
<td>
<p>Logical argument to whether bootstrap should be used for inference. Default is <code>FALSE</code> and analytical
standard errors are reported.</p>
</td></tr>
<tr><td><code id="ordid_+3A_boot.type">boot.type</code></td>
<td>
<p>Type of bootstrap to be performed (not relevant if <code>boot = FALSE</code>). Options are &quot;weighted&quot; and &quot;multiplier&quot;.
If <code>boot = TRUE</code>, default is &quot;weighted&quot;.</p>
</td></tr>
<tr><td><code id="ordid_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repetitions (not relevant if boot = <code>FALSE</code>). Default is 999.</p>
</td></tr>
<tr><td><code id="ordid_+3A_inffunc">inffunc</code></td>
<td>
<p>Logical argument to whether influence function should be returned. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>ordid</code> function implements
outcome regression difference-in-differences (DiD) estimator for the average treatment effect
on the treated (ATT) defined in equation (2.2) of Sant'Anna and Zhao (2020). The estimator follows the same spirit
of the nonparametric estimators proposed by Heckman, Ichimura and Todd (1997), though here the the outcome regression
models are assumed to be linear in covariates (parametric).
</p>
<p>The nuisance parameters (outcome regression coefficients) are estimated via ordinary least squares.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>ATT</code></td>
<td>
<p>The OR DiD point estimate</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p> The OR DiD standard error</p>
</td></tr>
<tr><td><code>uci</code></td>
<td>
<p>Estimate of the upper bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>lci</code></td>
<td>
<p>Estimate of the lower bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>boots</code></td>
<td>
<p>All Bootstrap draws of the ATT, in case bootstrap was used to conduct inference. Default is NULL</p>
</td></tr>
<tr><td><code>att.inf.func</code></td>
<td>
<p>Estimate of the influence function. Default is NULL</p>
</td></tr>
<tr><td><code>call.param</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>argu</code></td>
<td>
<p>Some arguments used in the call (panel, normalized, boot, boot.type, nboot, type==&quot;or&quot;)</p>
</td></tr>
</table>


<h3>References</h3>

<p><cite>Heckman, James J., Ichimura, Hidehiko, and Todd, Petra E. (1997),&quot;Matching as an Econometric Evaluation Estimator: Evidence from Evaluating a Job Training Programme&quot;,
Review of Economic Studies, vol. 64(4), p. 605–654, <a href="https://doi.org/10.2307/2971733">doi:10.2307/2971733</a>.
</cite>
</p>
<p><cite>Sant'Anna, Pedro H. C. and Zhao, Jun. (2020),
&quot;Doubly Robust Difference-in-Differences Estimators.&quot; Journal of Econometrics, Vol. 219 (1), pp. 101-122,
<a href="https://doi.org/10.1016/j.jeconom.2020.06.003">doi:10.1016/j.jeconom.2020.06.003</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># -----------------------------------------------
# Panel data case
# -----------------------------------------------
# Form the Lalonde sample with CPS comparison group
eval_lalonde_cps &lt;- subset(nsw_long, nsw_long$treated == 0 | nsw_long$sample == 2)
# Further reduce sample to speed example
set.seed(123)
unit_random &lt;- sample(unique(eval_lalonde_cps$id), 5000)
eval_lalonde_cps &lt;- eval_lalonde_cps[eval_lalonde_cps$id %in% unit_random,]
# Implement OR DiD with panel data
ordid(yname="re", tname = "year", idname = "id", dname = "experimental",
      xformla= ~ age+ educ+ black+ married+ nodegree+ hisp+ re74,
      data = eval_lalonde_cps, panel = TRUE)

# -----------------------------------------------
# Repeated cross section case
# -----------------------------------------------
# use the simulated data provided in the package
# Implement OR DiD with repeated cross-section data
# use Bootstrap to make inference with 199 bootstrap draws (just for illustration)
ordid(yname="y", tname = "post", idname = "id", dname = "d",
      xformla= ~ x1 + x2 + x3 + x4,
      data = sim_rc, panel = FALSE,
      boot = TRUE, nboot = 199)



</code></pre>

<hr>
<h2 id='reg_did_panel'>Outcome regression DiD estimator for the ATT, with panel data</h2><span id='topic+reg_did_panel'></span>

<h3>Description</h3>

<p><code>reg_did_panel</code> computes the outcome regressions estimators for the average treatment effect on the
treated in difference-in-differences (DiD) setups with panel data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reg_did_panel(
  y1,
  y0,
  D,
  covariates,
  i.weights = NULL,
  boot = FALSE,
  boot.type = "weighted",
  nboot = NULL,
  inffunc = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reg_did_panel_+3A_y1">y1</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes from the post-treatment period.</p>
</td></tr>
<tr><td><code id="reg_did_panel_+3A_y0">y0</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes from the pre-treatment period.</p>
</td></tr>
<tr><td><code id="reg_did_panel_+3A_d">D</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Group indicators (=1 if observation is treated in the post-treatment, =0 otherwise).</p>
</td></tr>
<tr><td><code id="reg_did_panel_+3A_covariates">covariates</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">k</code> matrix of covariates to be used in the regression estimation.
If covariates = NULL, this leads to an unconditional DiD estimator.</p>
</td></tr>
<tr><td><code id="reg_did_panel_+3A_i.weights">i.weights</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of weights to be used. If NULL, then every observation has the same weights.</p>
</td></tr>
<tr><td><code id="reg_did_panel_+3A_boot">boot</code></td>
<td>
<p>Logical argument to whether bootstrap should be used for inference. Default is FALSE.</p>
</td></tr>
<tr><td><code id="reg_did_panel_+3A_boot.type">boot.type</code></td>
<td>
<p>Type of bootstrap to be performed (not relevant if <code>boot = FALSE</code>). Options are &quot;weighted&quot; and &quot;multiplier&quot;.
If <code>boot = TRUE</code>, default is &quot;weighted&quot;.</p>
</td></tr>
<tr><td><code id="reg_did_panel_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repetitions (not relevant if <code>boot = FALSE</code>). Default is 999.</p>
</td></tr>
<tr><td><code id="reg_did_panel_+3A_inffunc">inffunc</code></td>
<td>
<p>Logical argument to whether influence function should be returned. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>reg_did_panel</code> function implements
outcome regression difference-in-differences (DiD) estimator for the average treatment effect
on the treated (ATT) defined in equation (2.2) of Sant'Anna and Zhao (2020) when panel data are available.
The estimator follows the same spirit of the nonparametric estimators proposed by Heckman, Ichimura and Todd (1997),
though here the the outcome regression models are assumed to be linear in covariates (parametric),
</p>
<p>The nuisance parameters (outcome regression coefficients) are estimated via ordinary least squares.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>ATT</code></td>
<td>
<p>The OR DiD point estimate</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>The OR DiD standard error</p>
</td></tr>
<tr><td><code>uci</code></td>
<td>
<p>Estimate of the upper bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>lci</code></td>
<td>
<p>Estimate of the lower bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>boots</code></td>
<td>
<p>All Bootstrap draws of the ATT, in case bootstrap was used to conduct inference. Default is NULL</p>
</td></tr>
<tr><td><code>att.inf.func</code></td>
<td>
<p>Estimate of the influence function. Default is NULL</p>
</td></tr>
<tr><td><code>call.param</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>argu</code></td>
<td>
<p>Some arguments used (explicitly or not) in the call (panel = TRUE, boot, boot.type, nboot, type=&quot;or&quot;)</p>
</td></tr>
</table>


<h3>References</h3>

<p><cite>Heckman, James J., Ichimura, Hidehiko, and Todd, Petra E. (1997),&quot;Matching as an Econometric Evaluation Estimator: Evidence from Evaluating a Job Training Programme&quot;,
Review of Economic Studies, vol. 64(4), p. 605–654, <a href="https://doi.org/10.2307/2971733">doi:10.2307/2971733</a>.
</cite>
</p>
<p><cite>Sant'Anna, Pedro H. C. and Zhao, Jun. (2020),
&quot;Doubly Robust Difference-in-Differences Estimators.&quot; Journal of Econometrics, Vol. 219 (1), pp. 101-122,
<a href="https://doi.org/10.1016/j.jeconom.2020.06.003">doi:10.1016/j.jeconom.2020.06.003</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Form the Lalonde sample with CPS comparison group
eval_lalonde_cps &lt;- subset(nsw, nsw$treated == 0 | nsw$sample == 2)
# Further reduce sample to speed example
set.seed(123)
unit_random &lt;- sample(1:nrow(eval_lalonde_cps), 5000)
eval_lalonde_cps &lt;- eval_lalonde_cps[unit_random,]
# Select some covariates
covX = as.matrix(cbind(eval_lalonde_cps$age, eval_lalonde_cps$educ,
                       eval_lalonde_cps$black, eval_lalonde_cps$married,
                       eval_lalonde_cps$nodegree, eval_lalonde_cps$hisp,
                       eval_lalonde_cps$re74))
# Implement OR DiD with panel data
reg_did_panel(y1 = eval_lalonde_cps$re78, y0 = eval_lalonde_cps$re75,
               D = eval_lalonde_cps$experimental,
               covariates = covX)

</code></pre>

<hr>
<h2 id='reg_did_rc'>Outcome regression DiD estimator for the ATT, with repeated cross-section data</h2><span id='topic+reg_did_rc'></span>

<h3>Description</h3>

<p><code>reg_did_rc</code> computes the outcome regressions estimators for the average treatment effect on the
treated in difference-in-differences (DiD) setups with stationary repeated cross-sectional data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reg_did_rc(
  y,
  post,
  D,
  covariates,
  i.weights = NULL,
  boot = FALSE,
  boot.type = "weighted",
  nboot = NULL,
  inffunc = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reg_did_rc_+3A_y">y</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes from the both pre and post-treatment periods.</p>
</td></tr>
<tr><td><code id="reg_did_rc_+3A_post">post</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Post-Treatment dummies (post = 1 if observation belongs to post-treatment period,
and post = 0 if observation belongs to pre-treatment period.)</p>
</td></tr>
<tr><td><code id="reg_did_rc_+3A_d">D</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Group indicators (=1 if observation is treated in the post-treatment, =0 otherwise).</p>
</td></tr>
<tr><td><code id="reg_did_rc_+3A_covariates">covariates</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">k</code> matrix of covariates to be used in the regression estimation.
If covariates = NULL, this leads to an unconditional DiD estimator.</p>
</td></tr>
<tr><td><code id="reg_did_rc_+3A_i.weights">i.weights</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of weights to be used. If NULL, then every observation has the same weights.</p>
</td></tr>
<tr><td><code id="reg_did_rc_+3A_boot">boot</code></td>
<td>
<p>Logical argument to whether bootstrap should be used for inference. Default is FALSE.</p>
</td></tr>
<tr><td><code id="reg_did_rc_+3A_boot.type">boot.type</code></td>
<td>
<p>Type of bootstrap to be performed (not relevant if <code>boot = FALSE</code>). Options are &quot;weighted&quot; and &quot;multiplier&quot;.
If <code>boot = TRUE</code>, default is &quot;weighted&quot;.</p>
</td></tr>
<tr><td><code id="reg_did_rc_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repetitions (not relevant if <code>boot = FALSE</code>). Default is 999.</p>
</td></tr>
<tr><td><code id="reg_did_rc_+3A_inffunc">inffunc</code></td>
<td>
<p>Logical argument to whether influence function should be returned. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>reg_did_rc</code> function implements
outcome regression difference-in-differences (DiD) estimator for the average treatment effect
on the treated (ATT) defined in equation (2.2) of Sant'Anna and Zhao (2020) when stationary repeated cross-sectional
data are available.  The estimator follows the same spirit of the nonparametric estimators proposed by Heckman, Ichimura and Todd (1997),
though here the the outcome regression models are assumed to be linear in covariates (parametric),
</p>
<p>The nuisance parameters (outcome regression coefficients) are estimated via ordinary least squares.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>ATT</code></td>
<td>
<p>The OR DiD point estimate</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>The OR DiD standard error</p>
</td></tr>
<tr><td><code>uci</code></td>
<td>
<p>Estimate of the upper bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>lci</code></td>
<td>
<p>Estimate of the lower bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>boots</code></td>
<td>
<p>All Bootstrap draws of the ATT, in case bootstrap was used to conduct inference. Default is NULL</p>
</td></tr>
<tr><td><code>att.inf.func</code></td>
<td>
<p>Estimate of the influence function. Default is NULL</p>
</td></tr>
<tr><td><code>call.param</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>argu</code></td>
<td>
<p>Some arguments used (explicitly or not) in the call (panel = FALSE, boot, boot.type, nboot, type=&quot;or&quot;)</p>
</td></tr>
</table>


<h3>References</h3>

<p><cite>Heckman, James J., Ichimura, Hidehiko, and Todd, Petra E. (1997),&quot;Matching as an Econometric Evaluation Estimator: Evidence from Evaluating a Job Training Programme&quot;,
Review of Economic Studies, vol. 64(4), p. 605–654, <a href="https://doi.org/10.2307/2971733">doi:10.2307/2971733</a>.
</cite>
</p>
<p><cite>Sant'Anna, Pedro H. C. and Zhao, Jun. (2020),
&quot;Doubly Robust Difference-in-Differences Estimators.&quot; Journal of Econometrics, Vol. 219 (1), pp. 101-122,
<a href="https://doi.org/10.1016/j.jeconom.2020.06.003">doi:10.1016/j.jeconom.2020.06.003</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># use the simulated data provided in the package
covX = as.matrix(sim_rc[,5:8])
# Implement OR DiD estimator
reg_did_rc(y = sim_rc$y, post = sim_rc$post, D = sim_rc$d,
           covariates= covX)

</code></pre>

<hr>
<h2 id='sim_rc'>Simulated repeated cross-section data</h2><span id='topic+sim_rc'></span>

<h3>Description</h3>

<p><code>sim_rc</code> contains a simulated dataset following the DGP1 in Sant'Anna
and Zhao (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_rc
</code></pre>


<h3>Format</h3>

<p>A data frame in &quot;long&quot; format with 1000 observations on the following and 8 variables:
</p>

<dl>
<dt>id</dt><dd><p>unique identifier for each cross-sectional unit.</p>
</dd>
<dt>post</dt><dd><p>an indicator variable for post-treatment period (1 if post,
0 if pre treatment period).</p>
</dd>
<dt>y</dt><dd><p>outcome of interest</p>
</dd>
<dt>d</dt><dd><p>an indicator variable for treatment group. Equal to 1 if
experience treatment in the post-treatment period; equal to 0 if never experience
treatment.</p>
</dd>
<dt>x1</dt><dd><p>Covariate z1 in Sant'Anna and Zhao(2020)</p>
</dd>
<dt>x2</dt><dd><p>Covariate z2 in Sant'Anna and Zhao(2020)</p>
</dd>
<dt>x3</dt><dd><p>Covariate z3 in Sant'Anna and Zhao(2020)</p>
</dd>
<dt>x4</dt><dd><p>Covariate z4 in Sant'Anna and Zhao(2020)</p>
</dd>
</dl>



<h3>Source</h3>

<p>Sant'Anna and Zhao (2020)
</p>


<h3>References</h3>


<p><cite>Sant'Anna, Pedro H. C. and Zhao, Jun. (2020),
&quot;Doubly Robust Difference-in-Differences Estimators.&quot; Journal of Econometrics, Vol. 219 (1), pp. 101-122,
<a href="https://doi.org/10.1016/j.jeconom.2020.06.003">doi:10.1016/j.jeconom.2020.06.003</a></cite>

</p>

<hr>
<h2 id='std_ipw_did_panel'>Standardized inverse probability weighted DiD estimator, with panel data</h2><span id='topic+std_ipw_did_panel'></span>

<h3>Description</h3>

<p><code>std_ipw_did_panel</code> is used to compute inverse probability weighted (IPW) estimators for the ATT
in difference-in-differences (DiD) setups with panel data. IPW weights are normalized to sum up to one, that is,
the estimator is of the Hajek type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>std_ipw_did_panel(
  y1,
  y0,
  D,
  covariates,
  i.weights = NULL,
  boot = FALSE,
  boot.type = "weighted",
  nboot = NULL,
  inffunc = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="std_ipw_did_panel_+3A_y1">y1</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes from the post-treatment period.</p>
</td></tr>
<tr><td><code id="std_ipw_did_panel_+3A_y0">y0</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes from the pre-treatment period.</p>
</td></tr>
<tr><td><code id="std_ipw_did_panel_+3A_d">D</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Group indicators (=1 if observation is treated in the post-treatment, =0 otherwise).</p>
</td></tr>
<tr><td><code id="std_ipw_did_panel_+3A_covariates">covariates</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">k</code> matrix of covariates to be used in the propensity score estimation.
If covariates = NULL, this leads to an unconditional DiD estimator.</p>
</td></tr>
<tr><td><code id="std_ipw_did_panel_+3A_i.weights">i.weights</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of weights to be used. If NULL, then every observation has the same weights.</p>
</td></tr>
<tr><td><code id="std_ipw_did_panel_+3A_boot">boot</code></td>
<td>
<p>Logical argument to whether bootstrap should be used for inference. Default is FALSE.</p>
</td></tr>
<tr><td><code id="std_ipw_did_panel_+3A_boot.type">boot.type</code></td>
<td>
<p>Type of bootstrap to be performed (not relevant if <code>boot = FALSE</code>). Options are &quot;weighted&quot; and &quot;multiplier&quot;.
If <code>boot = TRUE</code>, default is &quot;weighted&quot;.</p>
</td></tr>
<tr><td><code id="std_ipw_did_panel_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repetitions (not relevant if <code>boot = FALSE</code>). Default is 999.</p>
</td></tr>
<tr><td><code id="std_ipw_did_panel_+3A_inffunc">inffunc</code></td>
<td>
<p>Logical argument to whether influence function should be returned. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>ATT</code></td>
<td>
<p>The IPW DiD point estimate.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p> The IPW DiD standard error</p>
</td></tr>
<tr><td><code>uci</code></td>
<td>
<p>Estimate of the upper bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>lci</code></td>
<td>
<p>Estimate of the lower bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>boots</code></td>
<td>
<p>All Bootstrap draws of the ATT, in case bootstrap was used to conduct inference. Default is NULL</p>
</td></tr>
<tr><td><code>att.inf.func</code></td>
<td>
<p>Estimate of the influence function. Default is NULL</p>
</td></tr>
<tr><td><code>call.param</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>argu</code></td>
<td>
<p>Some arguments used (explicitly or not) in the call (panel = TRUE, normalized = TRUE, boot, boot.type, nboot, type=&quot;ipw&quot;)</p>
</td></tr>
</table>


<h3>References</h3>

<p><cite>Abadie, Alberto (2005), &quot;Semiparametric Difference-in-Differences Estimators&quot;,
Review of Economic Studies, vol. 72(1), p. 1-19, <a href="https://doi.org/10.1111/0034-6527.00321">doi:10.1111/0034-6527.00321</a>.
</cite>
</p>
<p><cite>Sant'Anna, Pedro H. C. and Zhao, Jun. (2020),
&quot;Doubly Robust Difference-in-Differences Estimators.&quot; Journal of Econometrics, Vol. 219 (1), pp. 101-122,
<a href="https://doi.org/10.1016/j.jeconom.2020.06.003">doi:10.1016/j.jeconom.2020.06.003</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Form the Lalonde sample with CPS comparison group
eval_lalonde_cps &lt;- subset(nsw, nsw$treated == 0 | nsw$sample == 2)
# Further reduce sample to speed example
set.seed(123)
unit_random &lt;- sample(1:nrow(eval_lalonde_cps), 5000)
eval_lalonde_cps &lt;- eval_lalonde_cps[unit_random,]
# Select some covariates
covX = as.matrix(cbind(eval_lalonde_cps$age, eval_lalonde_cps$educ,
                       eval_lalonde_cps$black, eval_lalonde_cps$married,
                       eval_lalonde_cps$nodegree, eval_lalonde_cps$hisp,
                       eval_lalonde_cps$re74))
# Implement normalized IPW DiD with panel data
std_ipw_did_panel(y1 = eval_lalonde_cps$re78, y0 = eval_lalonde_cps$re75,
                D = eval_lalonde_cps$experimental,
                covariates = covX)

</code></pre>

<hr>
<h2 id='std_ipw_did_rc'>Standardized inverse probability weighted DiD estimator, with repeated cross-section data</h2><span id='topic+std_ipw_did_rc'></span>

<h3>Description</h3>

<p><code>std_ipw_did_rc</code> is used to compute inverse probability weighted (IPW) estimators for the ATT
in DID setups with stationary repeated cross-sectional data. IPW weights are normalized to sum up to one, that is,
the estimator is of the Hajek type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>std_ipw_did_rc(
  y,
  post,
  D,
  covariates,
  i.weights = NULL,
  boot = FALSE,
  boot.type = "weighted",
  nboot = NULL,
  inffunc = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="std_ipw_did_rc_+3A_y">y</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes from the both pre and post-treatment periods.</p>
</td></tr>
<tr><td><code id="std_ipw_did_rc_+3A_post">post</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Post-Treatment dummies (post = 1 if observation belongs to post-treatment period,
and post = 0 if observation belongs to pre-treatment period.)</p>
</td></tr>
<tr><td><code id="std_ipw_did_rc_+3A_d">D</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Group indicators (=1 if observation is treated in the post-treatment, =0 otherwise).</p>
</td></tr>
<tr><td><code id="std_ipw_did_rc_+3A_covariates">covariates</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">k</code> matrix of covariates to be used in the propensity score estimation.
If covariates = NULL, this leads to an unconditional DID estimator.</p>
</td></tr>
<tr><td><code id="std_ipw_did_rc_+3A_i.weights">i.weights</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of weights to be used. If NULL, then every observation has the same weights.</p>
</td></tr>
<tr><td><code id="std_ipw_did_rc_+3A_boot">boot</code></td>
<td>
<p>Logical argument to whether bootstrap should be used for inference. Default is FALSE.</p>
</td></tr>
<tr><td><code id="std_ipw_did_rc_+3A_boot.type">boot.type</code></td>
<td>
<p>Type of bootstrap to be performed (not relevant if <code>boot = FALSE</code>). Options are &quot;weighted&quot; and &quot;multiplier&quot;.
If <code>boot = TRUE</code>, default is &quot;weighted&quot;.</p>
</td></tr>
<tr><td><code id="std_ipw_did_rc_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repetitions (not relevant if <code>boot = FALSE</code>). Default is 999.</p>
</td></tr>
<tr><td><code id="std_ipw_did_rc_+3A_inffunc">inffunc</code></td>
<td>
<p>Logical argument to whether influence function should be returned. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>ATT</code></td>
<td>
<p>The IPW DID point estimate.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p> The IPW DID standard error</p>
</td></tr>
<tr><td><code>uci</code></td>
<td>
<p>Estimate of the upper bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>lci</code></td>
<td>
<p>Estimate of the lower bound of a 95% CI for the ATT</p>
</td></tr>
<tr><td><code>boots</code></td>
<td>
<p>All Bootstrap draws of the ATT, in case bootstrap was used to conduct inference. Default is NULL</p>
</td></tr>
<tr><td><code>att.inf.func</code></td>
<td>
<p>Estimate of the influence function. Default is NULL</p>
</td></tr>
<tr><td><code>call.param</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>argu</code></td>
<td>
<p>Some arguments used (explicitly or not) in the call (panel = FALSE, normalized = TRUE, boot, boot.type, nboot, type=&quot;ipw&quot;)</p>
</td></tr>
</table>


<h3>References</h3>

<p><cite>Abadie, Alberto (2005), &quot;Semiparametric Difference-in-Differences Estimators&quot;,
Review of Economic Studies, vol. 72(1), p. 1-19, <a href="https://doi.org/10.1111/0034-6527.00321">doi:10.1111/0034-6527.00321</a>.
</cite>
</p>
<p><cite>Sant'Anna, Pedro H. C. and Zhao, Jun. (2020),
&quot;Doubly Robust Difference-in-Differences Estimators.&quot; Journal of Econometrics, Vol. 219 (1), pp. 101-122,
<a href="https://doi.org/10.1016/j.jeconom.2020.06.003">doi:10.1016/j.jeconom.2020.06.003</a></cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># use the simulated data provided in the package
covX = as.matrix(sim_rc[,5:8])
# Implement normalized IPW DID estimator
std_ipw_did_rc(y = sim_rc$y, post = sim_rc$post, D = sim_rc$d,
               covariates= covX)

</code></pre>

<hr>
<h2 id='twfe_did_panel'>Two-way fixed effects DiD estimator, with panel data</h2><span id='topic+twfe_did_panel'></span>

<h3>Description</h3>

<p><code>twfe_did_panel</code> is used to compute linear two-way fixed effects estimators for the ATT
in difference-in-differences (DiD) setups with panel data. As illustrated by Sant'Anna and Zhao (2020),
this estimator generally do not recover the ATT. We encourage empiricists to adopt alternative specifications.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twfe_did_panel(
  y1,
  y0,
  D,
  covariates,
  i.weights = NULL,
  boot = FALSE,
  boot.type = "weighted",
  nboot = NULL,
  inffunc = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twfe_did_panel_+3A_y1">y1</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes from the post-treatment period.</p>
</td></tr>
<tr><td><code id="twfe_did_panel_+3A_y0">y0</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes from the pre-treatment period.</p>
</td></tr>
<tr><td><code id="twfe_did_panel_+3A_d">D</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Group indicators (=1 if observation is treated in the post-treatment, =0 otherwise).</p>
</td></tr>
<tr><td><code id="twfe_did_panel_+3A_covariates">covariates</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">k</code> matrix of covariates to be used in the regression estimation.</p>
</td></tr>
<tr><td><code id="twfe_did_panel_+3A_i.weights">i.weights</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of weights to be used. If NULL, then every observation has the same weights.</p>
</td></tr>
<tr><td><code id="twfe_did_panel_+3A_boot">boot</code></td>
<td>
<p>Logical argument to whether bootstrap should be used for inference. Default is FALSE.</p>
</td></tr>
<tr><td><code id="twfe_did_panel_+3A_boot.type">boot.type</code></td>
<td>
<p>Type of bootstrap to be performed (not relevant if <code>boot = FALSE</code>). Options are &quot;weighted&quot; and &quot;multiplier&quot;.
If <code>boot = TRUE</code>, default is &quot;weighted&quot;.</p>
</td></tr>
<tr><td><code id="twfe_did_panel_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repetitions (not relevant if <code>boot = FALSE</code>). Default is 999.</p>
</td></tr>
<tr><td><code id="twfe_did_panel_+3A_inffunc">inffunc</code></td>
<td>
<p>Logical argument to whether influence function should be returned. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>ATT</code></td>
<td>
<p>The TWFE DiD point estimate</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>The TWFE DiD standard error</p>
</td></tr>
<tr><td><code>uci</code></td>
<td>
<p>Estimate of the upper bound of a 95% CI for the TWFE parameter.</p>
</td></tr>
<tr><td><code>lci</code></td>
<td>
<p>Estimate of the lower bound of a 95% CI for the TWFE parameter.</p>
</td></tr>
<tr><td><code>boots</code></td>
<td>
<p>All Bootstrap draws of the ATT, in case bootstrap was used to conduct inference. Default is NULL</p>
</td></tr>
<tr><td><code>att.inf.func</code></td>
<td>
<p>Estimate of the influence function. Default is NULL</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Form the Lalonde sample with CPS comparison group
eval_lalonde_cps &lt;- subset(nsw, nsw$treated == 0 | nsw$sample == 2)
# Further reduce sample to speed example
set.seed(123)
unit_random &lt;- sample(1:nrow(eval_lalonde_cps), 5000)
eval_lalonde_cps &lt;- eval_lalonde_cps[unit_random,]
# Select some covariates
covX = as.matrix(cbind(eval_lalonde_cps$age, eval_lalonde_cps$educ,
                       eval_lalonde_cps$black, eval_lalonde_cps$married,
                       eval_lalonde_cps$nodegree, eval_lalonde_cps$hisp,
                       eval_lalonde_cps$re74))
# Implement TWFE DiD with panel data
twfe_did_panel(y1 = eval_lalonde_cps$re78, y0 = eval_lalonde_cps$re75,
               D = eval_lalonde_cps$experimental,
               covariates = covX)

</code></pre>

<hr>
<h2 id='twfe_did_rc'>Two-way fixed effects DiD estimator, with repeated cross-section data</h2><span id='topic+twfe_did_rc'></span>

<h3>Description</h3>

<p><code>twfe_did_rc</code> is used to compute linear two-way fixed effects estimators for the ATT
in difference-in-differences (DiD) setups with stationary repeated cross-sectional data. As illustrated
by Sant'Anna and Zhao (2020),this estimator generally do not recover the ATT. We encourage empiricists
to adopt alternative specifications.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twfe_did_rc(
  y,
  post,
  D,
  covariates = NULL,
  i.weights = NULL,
  boot = FALSE,
  boot.type = "weighted",
  nboot = NULL,
  inffunc = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twfe_did_rc_+3A_y">y</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of outcomes from the both pre and post-treatment periods.</p>
</td></tr>
<tr><td><code id="twfe_did_rc_+3A_post">post</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Post-Treatment dummies (post = 1 if observation belongs to post-treatment period,
and post = 0 if observation belongs to pre-treatment period.)</p>
</td></tr>
<tr><td><code id="twfe_did_rc_+3A_d">D</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of Group indicators (=1 if observation is treated in the post-treatment period, =0 otherwise).</p>
</td></tr>
<tr><td><code id="twfe_did_rc_+3A_covariates">covariates</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">k</code> matrix of covariates to be used in the regression estimation.</p>
</td></tr>
<tr><td><code id="twfe_did_rc_+3A_i.weights">i.weights</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">1</code> vector of weights to be used. If NULL, then every observation has the same weights.</p>
</td></tr>
<tr><td><code id="twfe_did_rc_+3A_boot">boot</code></td>
<td>
<p>Logical argument to whether bootstrap should be used for inference. Default is FALSE.</p>
</td></tr>
<tr><td><code id="twfe_did_rc_+3A_boot.type">boot.type</code></td>
<td>
<p>Type of bootstrap to be performed (not relevant if <code>boot = FALSE</code>). Options are &quot;weighted&quot; and &quot;multiplier&quot;.
If <code>boot = TRUE</code>, default is &quot;weighted&quot;.</p>
</td></tr>
<tr><td><code id="twfe_did_rc_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repetitions (not relevant if <code>boot = FALSE</code>). Default is 999.</p>
</td></tr>
<tr><td><code id="twfe_did_rc_+3A_inffunc">inffunc</code></td>
<td>
<p>Logical argument to whether influence function should be returned. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>ATT</code></td>
<td>
<p>The TWFE DiD point estimate</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>The TWFE DiD standard error</p>
</td></tr>
<tr><td><code>uci</code></td>
<td>
<p>Estimate of the upper bound of a 95% CI for the TWFE parameter.</p>
</td></tr>
<tr><td><code>lci</code></td>
<td>
<p>Estimate of the lower bound of a 95% CI for the TWFE parameter.</p>
</td></tr>
<tr><td><code>boots</code></td>
<td>
<p>All Bootstrap draws of the ATT, in case bootstrap was used to conduct inference. Default is NULL</p>
</td></tr>
<tr><td><code>att.inf.func</code></td>
<td>
<p>Estimate of the influence function. Default is NULL</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># use the simulated data provided in the package
covX = as.matrix(sim_rc[,5:8])
# Implement TWFE DiD estimator (you probably should consider something else....)
twfe_did_rc(y = sim_rc$y, post = sim_rc$post, D = sim_rc$d,
           covariates= covX)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
