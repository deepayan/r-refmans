<!DOCTYPE html><html><head><title>Help for package discfrail</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {discfrail}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#discfrail-package'><p>discfrail: Cox Models for Time-to-Event Data with Nonparametric Discrete Group-Specific Frailties.</p></a></li>
<li><a href='#nelsonaalen_npdf'><p>Nelson-Aalen estimates of group-specific cumulative hazard from a nonparametric discrete frailty model</p></a></li>
<li><a href='#npdf_cox'><p>Cox model for grouped survival data with nonparametric discrete shared frailties</p></a></li>
<li><a href='#plot.nelsonaalen_npdf'><p>Plot Nelson-Aalen estimates of group-specific cumulative hazard from a nonparametric discrete frailty model</p></a></li>
<li><a href='#plot.npdf'><p>Survival or cumulative hazard curves from a fitted nonparametric discrete frailty model</p></a></li>
<li><a href='#plot.npdflist'><p>Survival or cumulative hazard curves from a nonparametric discrete frailty model chosen by automatic model selection</p></a></li>
<li><a href='#plot.survfit_npdf'><p>Plot Kaplan-Meier estimates of group-specific cumulative hazard from a nonparametric discrete frailty model</p></a></li>
<li><a href='#print.npdf'><p>Print output from a fitted nonparametric discrete frailty model</p></a></li>
<li><a href='#print.npdflist'><p>Print output from a nonparametric discrete frailty modelling procedure with automatic model selection.</p></a></li>
<li><a href='#sim_npdf'><p>Simulation of grouped time-to-event data with nonparametric baseline hazard and discrete shared frailty distribution</p></a></li>
<li><a href='#sim_weibdf'><p>Simulation of grouped time-to-event data with Weibull baseline hazard and discrete shared frailty distribution</p></a></li>
<li><a href='#survfit_npdf'><p>Kaplan-Meier estimates of group-specific cumulative hazard from a nonparametric discrete frailty model</p></a></li>
<li><a href='#weibdata10040'><p>Hierarchical time-to-event data simulated from a Weibull baseline distribution with a nonparametric frailty</p></a></li>
<li><a href='#weibdata2030'><p>Hierarchical time-to-event data simulated from a Weibull baseline distribution with a nonparametric frailty</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Cox Models for Time-to-Event Data with Nonparametric Discrete
Group-Specific Frailties</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Francesca Gasperoni &lt;francesca.gasperoni@polimi.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for fitting Cox proportional hazards models for grouped time-to-event data, where the shared group-specific frailties have a discrete nonparametric distribution. The methods proposed in the package is described by Gasperoni, F., Ieva, F., Paganoni, A. M., Jackson, C. H., Sharples, L. (2018) &lt;<a href="https://doi.org/10.1093%2Fbiostatistics%2Fkxy071">doi:10.1093/biostatistics/kxy071</a>&gt;. There are also functions for simulating from these models, with a nonparametric or a parametric baseline hazard function.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/fgaspe04/discfrail">https://github.com/fgaspe04/discfrail</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/fgaspe04/discfrail/issues">https://github.com/fgaspe04/discfrail/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0), survival</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Imports:</td>
<td>Matrix, numDeriv</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-03-08 20:59:17 UTC; Francesca</td>
</tr>
<tr>
<td>Author:</td>
<td>Francesca Gasperoni [aut, cre],
  Christopher Jackson [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-03-13 12:03:29 UTC</td>
</tr>
</table>
<hr>
<h2 id='discfrail-package'>discfrail: Cox Models for Time-to-Event Data with Nonparametric Discrete Group-Specific Frailties.</h2><span id='topic+discfrail-package'></span><span id='topic+_PACKAGE'></span><span id='topic+discfrail'></span>

<h3>Description</h3>

<p>discfrail: Functions for fitting Cox proportional hazards models for grouped time-to-event data, where the shared group-specific frailties have a discrete nonparametric distribution.
</p>


<h3>Details</h3>

<p>The methods are fully described and illustrated in Gasperoni et al. (2018).
</p>
<p>Groups of individuals are clustered into a number of latent populations of groups, each with a common frailty that is assumed to act multiplicatively on their hazard.   Covariates can be included through proportional hazards, in the manner of the standard Cox model.   The baseline hazard is left unspecified as in the Cox model, and estimation is performed by maximum partial likelihood through an EM algorithm.
</p>
<p>There are also functions for simulating from these models, and from similar models with a parametric baseline survival function.
</p>
<p><code><a href="#topic+npdf_cox">npdf_cox</a></code> fits nonparametric discrete frailty models.  The number of latent populations of groups can either be fixed, or estimated through an automated model comparison and selection procedure.
</p>
<p><code><a href="#topic+plot.npdf">plot.npdf</a></code> plots fitted survival or cumulative hazard curves from the fitted models.
</p>
<p><code><a href="#topic+sim_npdf">sim_npdf</a></code> simulates from a proportional hazards model with an arbitrary baseline survival distribution and discrete shared frailty terms.
</p>
<p><code><a href="#topic+sim_weibdf">sim_weibdf</a></code> simulates from a Weibull survival model with discrete shared frailty terms.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Francesca Gasperoni <a href="mailto:francesca.gasperoni@polimi.it">francesca.gasperoni@polimi.it</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Christopher Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a>
</p>
</li></ul>



<h3>References</h3>

<p>F. Gasperoni, F. Ieva, A.M. Paganoni, C. Jackson, L. Sharples. (2018)
Nonparametric frailty Cox models for hierarchical time-to-event data.
Biostatistics.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/fgaspe04/discfrail">https://github.com/fgaspe04/discfrail</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/fgaspe04/discfrail/issues">https://github.com/fgaspe04/discfrail/issues</a>
</p>
</li></ul>


<hr>
<h2 id='nelsonaalen_npdf'>Nelson-Aalen estimates of group-specific cumulative hazard from a nonparametric discrete frailty model</h2><span id='topic+nelsonaalen_npdf'></span>

<h3>Description</h3>

<p>Nelson-Aalen estimates of group-specific cumulative hazard from a nonparametric discrete frailty model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nelsonaalen_npdf(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nelsonaalen_npdf_+3A_x">x</code></td>
<td>
<p>A fitted nonparametric discrete frailty model, as returned by <code><a href="#topic+npdf_cox">npdf_cox</a></code> with <code>estK=FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of objects of length equal to the number of groups in the data.  Each component is a list, equivalent to the output of <code><a href="survival.html#topic+survfit">survfit</a></code> called for the corresponding group with <code>type="fh"</code>, but with two additional components:
</p>
<p><code>y0</code>:  <code>-log</code> of the survival estimate
</p>
<p><code>sfun0</code>:  a step function for <code>y0</code> in terms of time, estimated using <code><a href="stats.html#topic+stepfun">stepfun</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.nelsonaalen_npdf">plot.nelsonaalen_npdf</a></code>, <code><a href="#topic+plot.npdf">plot.npdf</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = npdf_cox( Surv(time, status) ~ x, groups=family, data=weibdata2030, K = 2,
               estK=FALSE, eps_conv=10^-4)
object = nelsonaalen_npdf( x )

</code></pre>

<hr>
<h2 id='npdf_cox'>Cox model for grouped survival data with nonparametric discrete shared frailties</h2><span id='topic+npdf_cox'></span>

<h3>Description</h3>

<p>This function fits a Cox proportional hazards model to grouped survival data, where the shared group-specific frailties have a nonparametric discrete distribution.  An EM algorithm is used to maximise the marginal partial likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npdf_cox(formula, groups, data, K = 2, estK = TRUE,
  criterion = "BIC", eps_conv = 10^-4, se_method = c("louis",
  "exact"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npdf_cox_+3A_formula">formula</code></td>
<td>
<p>A formula expression in conventional R linear modelling
syntax. The response must be a survival time constructed by the
<code><a href="survival.html#topic+Surv">Surv</a></code> function from the <span class="pkg">survival</span> package, and
any covariates are given on the right-hand
side.  For example,
</p>
<p><code>Surv(time, dead) ~ age + sex</code>
</p>
<p>Only <code>Surv</code> objects of <code>type="right"</code> are supported, corresponding to right-censored observations.</p>
</td></tr>
<tr><td><code id="npdf_cox_+3A_groups">groups</code></td>
<td>
<p>name of the variable which indicates the group in which each individual belongs (e.g. the hospital that the individual is treated in).  This can be integer, factor or character.  The name should be unquoted.</p>
</td></tr>
<tr><td><code id="npdf_cox_+3A_data">data</code></td>
<td>
<p>A data frame in which to find variables supplied in
<code>formula</code>.  If not given, the variables should be in the working
environment.</p>
</td></tr>
<tr><td><code id="npdf_cox_+3A_k">K</code></td>
<td>
<p>initial number of latent populations, or clusters of groups which have the same discrete frailty.</p>
</td></tr>
<tr><td><code id="npdf_cox_+3A_estk">estK</code></td>
<td>
<p>If <code>TRUE</code> (the default) then
multiple models are fitted with number of latent groups ranging from 1 to <code>K</code>.  The &quot;best fitting&quot; model according to the criterion specified in <code>criterion</code> is then highlighted when printing the object returned by this function.
</p>
<p>If <code>FALSE</code> then the number of latent populations is fixed at <code>K</code>.</p>
</td></tr>
<tr><td><code id="npdf_cox_+3A_criterion">criterion</code></td>
<td>
<p>Criterion used to choose the best-fitting model to highlight when <code>estK</code> is <code>TRUE</code>.
</p>
<p><code>"Laird"</code> for the Laird criterion. Running from K latent populations to 1 latent population, this criterion selects the maximum number of latent populations that are non empty as the best K.
</p>
<p><code>"AIC"</code> for Akaike's information criterion.
</p>
<p><code>"BIC"</code> for the Bayesian information criterion (the default).</p>
</td></tr>
<tr><td><code id="npdf_cox_+3A_eps_conv">eps_conv</code></td>
<td>
<p>convergence tolerance for the EM algorithm.</p>
</td></tr>
<tr><td><code id="npdf_cox_+3A_se_method">se_method</code></td>
<td>
<p>Method or methods used to compute the standard errors.  A character vector containing one or more of the following:
</p>
<p><code>"louis"</code> The method of Louis (1982) based on an approximation to the information matrix.
</p>
<p><code>"exact"</code> In this method the standard errors are computed directly from the observed information matrix obtained by analytic differentiation.
</p>
<p><code>"numeric"</code> This method uses numerical differentiation to approximate the information matrix, and is substantially slower.
</p>
<p>By default this is <code>c("louis","exact")</code> because these two methods are equally fast. So that SEs from both these two methods are calculated and presented.   Set <code>se_method=NULL</code> to compute no standard errors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>estK=FALSE</code> this returns a list of class <code>npdf</code> which includes information about the model fit, including estimates and standard errors.
</p>
<p>If <code>estK=TRUE</code> this returns a list of class <code>npdflist</code>.  This has an element <code>models</code> that contains a list of length <code>K</code>, with one component of class <code>npdf</code> for each fitted model.
</p>
<p><code>comparison</code> is a matrix composed of <code>K</code> rows and 5 columns (<code>K</code>, <code>K_fitted</code>, <code>llik</code>, <code>AIC</code>, <code>BIC</code>). <code>K_fitted</code> is the number of estimated latent populations, which can be equal to or less than <code>K</code>. <code>llik</code> stands for log-likelihood, <code>AIC</code> for Akaike Information Criterion and <code>BIC</code> for Bayesian Information Criterion.
</p>
<p><code>Kopt</code> is optimal model under each criterion.
</p>
<p><code>criterion</code> is the preferred criterion.
</p>
<p>In either case, the data frame used for the fit (the &quot;model frame&quot;) is appended as a component <code>mf</code>.
</p>


<h3>References</h3>

<p>Gasperoni, F., Ieva, F., Paganoni, A.M., Jackson, C. and Sharples, L. (2018). Nonparametric frailty Cox models for hierarchical time-to-event data. <em>Biostatistics</em>.
</p>
<p>Laird, N. (1978). Nonparametric maximum likelihood estimation of a mixing distribution. <em>Journal of the American Statistical Association</em>, 73(364), 805–811.
</p>
<p>Louis, T. A. (1982). Finding the observed information matrix when using the EM algorithm. <em>Journal of the Royal Statistical Society. Series B</em>, 44(2), 226–233.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>test &lt;- npdf_cox( Surv(time, status) ~ x, groups=family, data=weibdata2030, K = 4, eps_conv=10^-4)
test    # optimal model (by all criteria) has 2 latent populations
test$models[[1]] # examine alternative model with 1 latent population

</code></pre>

<hr>
<h2 id='plot.nelsonaalen_npdf'>Plot Nelson-Aalen estimates of group-specific cumulative hazard from a nonparametric discrete frailty model</h2><span id='topic+plot.nelsonaalen_npdf'></span>

<h3>Description</h3>

<p>Plot Nelson-Aalen estimates of group-specific cumulative hazard from a nonparametric discrete frailty model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nelsonaalen_npdf'
plot(x, xlim = NULL, ylim = NULL,
  xlab = NULL, ylab = NULL, cols = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.nelsonaalen_npdf_+3A_x">x</code></td>
<td>
<p>Object returned by <code><a href="#topic+nelsonaalen_npdf">nelsonaalen_npdf</a></code> representing Nelson-Aalen estimates from a nonparametric discrete frailty model</p>
</td></tr>
<tr><td><code id="plot.nelsonaalen_npdf_+3A_xlim">xlim</code></td>
<td>
<p>x-axis limits (vector of 2)</p>
</td></tr>
<tr><td><code id="plot.nelsonaalen_npdf_+3A_ylim">ylim</code></td>
<td>
<p>x-axis limits (vector of 2)</p>
</td></tr>
<tr><td><code id="plot.nelsonaalen_npdf_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label</p>
</td></tr>
<tr><td><code id="plot.nelsonaalen_npdf_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label</p>
</td></tr>
<tr><td><code id="plot.nelsonaalen_npdf_+3A_cols">cols</code></td>
<td>
<p>vector of colour names or numbers, of the same length as the number of groups</p>
</td></tr>
<tr><td><code id="plot.nelsonaalen_npdf_+3A_...">...</code></td>
<td>
<p>options to pass to the generic <code>plot</code> function</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+nelsonaalen_npdf">nelsonaalen_npdf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 x = npdf_cox( Surv(time, status) ~ x, groups=family, data=weibdata2030, K = 2,
                estK=FALSE, eps_conv=10^-4)
object = nelsonaalen_npdf( x )
plot( object )
plot( object, xlim=c(0,200), ylim=c(0,2),
     xlab="Follow-up days", ylab="Nelson-Aalen estimate",
     cols=ifelse(x$belonging==2, "purple", "black"))

</code></pre>

<hr>
<h2 id='plot.npdf'>Survival or cumulative hazard curves from a fitted nonparametric discrete frailty model</h2><span id='topic+plot.npdf'></span>

<h3>Description</h3>

<p>This function plots estimates of the survival or cumulative hazard for each group, coloured according to the latent population that each group belongs to.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'npdf'
plot(x, type = "km", cols = NULL, survfit_opts = NULL,
  na_opts = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.npdf_+3A_x">x</code></td>
<td>
<p>A fitted nonparametric discrete frailty model, as returned by <code><a href="#topic+npdf_cox">npdf_cox</a></code> with <code>estK=FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.npdf_+3A_type">type</code></td>
<td>
<p>character. If <code>"km"</code> group-specific Kaplan-Meier estimates of survival are plotted.   If <code>"na"</code> group-specific Nelson-Aalen estimates of the cumulative hazard are plotted.  The default is <code>"km"</code>.</p>
</td></tr>
<tr><td><code id="plot.npdf_+3A_cols">cols</code></td>
<td>
<p>Vector of colour names or numbers, of the same length as the number of groups.  If not given, this defaults to <code>x$belonging</code>.</p>
</td></tr>
<tr><td><code id="plot.npdf_+3A_survfit_opts">survfit_opts</code></td>
<td>
<p>Optional list of additional arguments to pass to <code><a href="survival.html#topic+survfit.formula">survfit.formula</a></code>.</p>
</td></tr>
<tr><td><code id="plot.npdf_+3A_na_opts">na_opts</code></td>
<td>
<p>Optional list of arguments (other than <code>"cols"</code>) to pass to <code><a href="#topic+plot.nelsonaalen_npdf">plot.nelsonaalen_npdf</a></code>.</p>
</td></tr>
<tr><td><code id="plot.npdf_+3A_...">...</code></td>
<td>
<p>Optional arguments to pass to <code><a href="survival.html#topic+plot.survfit">plot.survfit</a></code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
result = npdf_cox( Surv(time, status) ~ x, groups = family, data = weibdata2030,
                    K = 2, estK = FALSE, eps_conv=10^-4)
plot( result )
plot( result, type = "km" )
plot( result, cols = ifelse( result$belonging == 1, "purple", "black" ), xlim = c( 0, 150 ) )

## use of survfit_opts.  show only first 10 groups
plot( result, survfit_opts = list(subset = (weibdata2030$family &gt;= 10) ))

plot( result, type = "na" )

## use of na_opts to customise the Nelson-Aalen plot
plot( result, type = "na", cols=ifelse(result$belonging==2, "purple", "black"),
     na_opts = list(xlim=c(0,200), ylim=c(0,2),
                    xlab="Follow-up days",
                    ylab="Nelson-Aalen estimate"))

</code></pre>

<hr>
<h2 id='plot.npdflist'>Survival or cumulative hazard curves from a nonparametric discrete frailty model chosen by automatic model selection</h2><span id='topic+plot.npdflist'></span>

<h3>Description</h3>

<p>Survival or cumulative hazard curves from a nonparametric discrete frailty model chosen by automatic model selection
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'npdflist'
plot(x, K = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.npdflist_+3A_x">x</code></td>
<td>
<p>An object returned by <code><a href="#topic+npdf_cox">npdf_cox</a></code> with <code>estK=TRUE</code>, containing a list of fitted nonparametric discrete frailty models</p>
</td></tr>
<tr><td><code id="plot.npdflist_+3A_k">K</code></td>
<td>
<p>The number of latent populations which identifies the specific model to plot estimates from.  By default this is the model selected by the criterion specified when calling <code><a href="#topic+npdf_cox">npdf_cox</a></code>.</p>
</td></tr>
<tr><td><code id="plot.npdflist_+3A_...">...</code></td>
<td>
<p>Options to customise the plot, passed to <code><a href="#topic+plot.npdf">plot.npdf</a></code>.  See <code><a href="#topic+plot.npdf">plot.npdf</a></code> for a description of these.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+plot.npdf">plot.npdf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>result = npdf_cox( Surv(time, status) ~ x, groups = family, data = weibdata2030,
                   K = 2, eps_conv=10^-4)
plot( result, K = 2 )
plot( result, type = "na" )
plot( result, type = "na", cols=ifelse(result$belonging==2, "purple", "black"),
     na_opts = list(xlim=c(0,200), ylim=c(0,2),
                    xlab="Follow-up days",
                    ylab="Nelson-Aalen estimate"))

</code></pre>

<hr>
<h2 id='plot.survfit_npdf'>Plot Kaplan-Meier estimates of group-specific cumulative hazard from a nonparametric discrete frailty model</h2><span id='topic+plot.survfit_npdf'></span>

<h3>Description</h3>

<p>Plot Kaplan-Meier estimates of group-specific cumulative hazard from a nonparametric discrete frailty model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survfit_npdf'
plot(x, xlab = NULL, ylab = NULL, cols = NULL,
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.survfit_npdf_+3A_x">x</code></td>
<td>
<p>Object returned by <code><a href="#topic+survfit_npdf">survfit_npdf</a></code> representing Kaplan-Meier estimates from a nonparametric discrete frailty model</p>
</td></tr>
<tr><td><code id="plot.survfit_npdf_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label</p>
</td></tr>
<tr><td><code id="plot.survfit_npdf_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label</p>
</td></tr>
<tr><td><code id="plot.survfit_npdf_+3A_cols">cols</code></td>
<td>
<p>vector of colour names or numbers, of the same length as the number of groups</p>
</td></tr>
<tr><td><code id="plot.survfit_npdf_+3A_...">...</code></td>
<td>
<p>options to pass to the generic <code>plot</code> function</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+plot.npdf">plot.npdf</a></code>, <code><a href="#topic+survfit_npdf">survfit_npdf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> x = npdf_cox( Surv(time, status) ~ x, groups=family, data=weibdata2030, K = 2,
                estK=FALSE, eps_conv=10^-4)
object = survfit_npdf( x )
plot( object )

</code></pre>

<hr>
<h2 id='print.npdf'>Print output from a fitted nonparametric discrete frailty model</h2><span id='topic+print.npdf'></span>

<h3>Description</h3>

<p>Prints estimates, standard errors, likelihood and model comparison statistics from a fitted nonparametric discrete frailty model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'npdf'
print(x, digits = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.npdf_+3A_x">x</code></td>
<td>
<p>A fitted nonparametric discrete frailty model, as returned by <code><a href="#topic+npdf_cox">npdf_cox</a></code> with <code>estK=FALSE</code></p>
</td></tr>
<tr><td><code id="print.npdf_+3A_digits">digits</code></td>
<td>
<p>Number of significant digits to present, by default <code>max(1, getOption("digits") - 4)</code></p>
</td></tr>
<tr><td><code id="print.npdf_+3A_...">...</code></td>
<td>
<p>Further options (currently unused)</p>
</td></tr>
</table>

<hr>
<h2 id='print.npdflist'>Print output from a nonparametric discrete frailty modelling procedure with automatic model selection.</h2><span id='topic+print.npdflist'></span>

<h3>Description</h3>

<p>Prints the model comparison statistics comparing models with different numbers of latent populations, and prints the estimates from the optimal model according to the criterion that was specified when calling <code><a href="#topic+npdf_cox">npdf_cox</a></code> (by default, BIC criterion).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'npdflist'
print(x, digits = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.npdflist_+3A_x">x</code></td>
<td>
<p>An object returned by <code><a href="#topic+npdf_cox">npdf_cox</a></code> with <code>estK=TRUE</code>, containing a list of fitted nonparametric discrete frailty models</p>
</td></tr>
<tr><td><code id="print.npdflist_+3A_digits">digits</code></td>
<td>
<p>Number of significant digits to present, by default <code>max(1, getOption("digits") - 4)</code></p>
</td></tr>
<tr><td><code id="print.npdflist_+3A_...">...</code></td>
<td>
<p>Further options (currently unused)</p>
</td></tr>
</table>

<hr>
<h2 id='sim_npdf'>Simulation of grouped time-to-event data with nonparametric baseline hazard and discrete shared frailty distribution</h2><span id='topic+sim_npdf'></span>

<h3>Description</h3>

<p>This function returns a dataset generated from a semiparametric proportional hazards model with a shared discrete frailty term, for given cumulative baseline hazard function, hazard ratios, distribution of groups among latent populations, frailty values for each latent population, and randomly-generated covariate values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_npdf(J, N = NULL, beta, Lambda_0_inv, p, w_values, cens_perc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_npdf_+3A_j">J</code></td>
<td>
<p>number of groups in the data</p>
</td></tr>
<tr><td><code id="sim_npdf_+3A_n">N</code></td>
<td>
<p>number of individuals in each group</p>
</td></tr>
<tr><td><code id="sim_npdf_+3A_beta">beta</code></td>
<td>
<p>vector of log hazard ratios</p>
</td></tr>
<tr><td><code id="sim_npdf_+3A_lambda_0_inv">Lambda_0_inv</code></td>
<td>
<p>inverse cumulative baseline hazard function, that is, with covariate values 0 and frailty ratio 1</p>
</td></tr>
<tr><td><code id="sim_npdf_+3A_p">p</code></td>
<td>
<p>vector of K elements.  The kth element gives the proportion of groups in the kth latent population of groups.</p>
</td></tr>
<tr><td><code id="sim_npdf_+3A_w_values">w_values</code></td>
<td>
<p>vector of K distinct frailty values, one for each latent population.</p>
</td></tr>
<tr><td><code id="sim_npdf_+3A_cens_perc">cens_perc</code></td>
<td>
<p>percentage of censored events. Censoring times are assumed to be distributed as a Normal with variance equal to 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with one row for each simulated individual, and the following columns:
</p>
<p><code>family</code>: the group which the individual is in (integers 1, 2, ...)
</p>
<p><code>time</code>: the simulated event time.
</p>
<p><code>status</code>: the simulated survival status. Censoring times are generated from a Normal distribution with standard deviation equal to 1 and the mean is estimated in order to guarantee the determined percentage of censored events. The event time is observed (status=1) if it is less than the censoring time, and censored otherwise (status=0).
</p>
<p><code>x</code>: matrix of covariate values, generated from a standard normal distribution.
</p>
<p><code>belong</code>:  the frailty hazard ratio corresponding to the cluster of groups in which the individual's group has been allocated.
</p>


<h3>References</h3>

<p>Wan, F. (2017). Simulating survival data with predefined censoring rates for proportional hazards models. <em>Statistics in medicine</em>, 36(5), 838-854.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>J &lt;- 100
N &lt;- 40
Lambda_0_inv = function( t, c=0.01, d=4.6 ) ( t^( 1/d ) )/c
beta &lt;- 1.6
p &lt;- c( 0.8, 0.2 )
w_values &lt;- c( 0.8, 1.6 )
cens_perc &lt;- 0.1
data &lt;- sim_npdf( J, N, beta, Lambda_0_inv, p, w_values, cens_perc )
head( data )
</code></pre>

<hr>
<h2 id='sim_weibdf'>Simulation of grouped time-to-event data with Weibull baseline hazard and discrete shared frailty distribution</h2><span id='topic+sim_weibdf'></span>

<h3>Description</h3>

<p>This function returns a dataset generated from a Weibull proportional hazards model with a shared discrete frailty term, for given Weibull parameters, hazard ratios, distribution of groups among latent populations, frailty values for each latent population, and randomly-generated covariate values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_weibdf(J, N = NULL, lambda, rho, beta, p, w_values, cens_perc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_weibdf_+3A_j">J</code></td>
<td>
<p>number of groups in the data</p>
</td></tr>
<tr><td><code id="sim_weibdf_+3A_n">N</code></td>
<td>
<p>number of individuals in each group</p>
</td></tr>
<tr><td><code id="sim_weibdf_+3A_lambda">lambda</code></td>
<td>
<p>Weibull baseline rate parameter (see below), interpreted as the rate parameter with covariate values of 0 and frailty ratio 1.  For <code class="reqn">rho=1</code> this is the baseline hazard.</p>
</td></tr>
<tr><td><code id="sim_weibdf_+3A_rho">rho</code></td>
<td>
<p>Weibull shape parameter (see below)</p>
</td></tr>
<tr><td><code id="sim_weibdf_+3A_beta">beta</code></td>
<td>
<p>covariate effects in the Weibull distribution, interpreted as log hazard ratios (see below)</p>
</td></tr>
<tr><td><code id="sim_weibdf_+3A_p">p</code></td>
<td>
<p>vector of K elements.  The kth element gives the proportion of groups in the kth latent population of groups.</p>
</td></tr>
<tr><td><code id="sim_weibdf_+3A_w_values">w_values</code></td>
<td>
<p>vector of K distinct frailty values, one for each latent population.</p>
</td></tr>
<tr><td><code id="sim_weibdf_+3A_cens_perc">cens_perc</code></td>
<td>
<p>cens_perc percentage of censored events. Censoring times are assumed to be distributed as a Normal with variance equal to 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The &quot;proportional hazards&quot; parameterisation of the Weibull distribution is used, with survivor function <code class="reqn">S(t) = exp(-\lambda t^{\rho} w exp(x^T {\beta}) )</code>. Note this is different from the &quot;accelerated failure time&quot; parameterisation used in, e.g. <code><a href="stats.html#topic+dweibull">dweibull</a></code>.  Distribution functions for the proportional hazards parameterisation can be found in the <span class="pkg">flexsurv</span> package.
</p>


<h3>Value</h3>

<p>A data frame with one row for each simulated individual, and the following columns:
</p>
<p><code>family</code>: the group which the individual is in (integers 1, 2, ...)
</p>
<p><code>time</code>: the simulated event time.
</p>
<p><code>status</code>: the simulated survival status. Censoring times are generated from a Normal distribution with standard deviation equal to 1 and the mean is estimated in order to guarantee the determined percentage of censored events. The event time is observed (status=1) if it is less than the censoring time, and censored otherwise (status=0).
</p>
<p><code>x</code>: matrix of covariate values, generated from a standard normal distribution.
</p>
<p><code>belong</code>:  the frailty hazard ratio corresponding to the cluster of groups in which the individual's group has been allocated.
</p>


<h3>References</h3>

<p>Wan, F. (2017). Simulating survival data with predefined censoring rates for proportional hazards models. <em>Statistics in medicine</em>, 36(5), 838-854.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>J &lt;- 100
N &lt;- 40
lambda &lt;- 0.5
beta &lt;- 1.6
rho &lt;- 1
p &lt;- c( 0.8, 0.2 )
w_values &lt;- c( 0.8, 1.6 )
cens_perc &lt;- 0.2
data &lt;- sim_weibdf( J, N, lambda, rho, beta, p, w_values, cens_perc)
head( data )

</code></pre>

<hr>
<h2 id='survfit_npdf'>Kaplan-Meier estimates of group-specific cumulative hazard from a nonparametric discrete frailty model</h2><span id='topic+survfit_npdf'></span>

<h3>Description</h3>

<p>Kaplan-Meier estimates of group-specific cumulative hazard from a nonparametric discrete frailty model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survfit_npdf(x, survfit_opts = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="survfit_npdf_+3A_x">x</code></td>
<td>
<p>A fitted nonparametric discrete frailty model, as returned by <code><a href="#topic+npdf_cox">npdf_cox</a></code> with <code>estK=FALSE</code>.</p>
</td></tr>
<tr><td><code id="survfit_npdf_+3A_survfit_opts">survfit_opts</code></td>
<td>
<p>Optional list of additional arguments to pass to <code><a href="survival.html#topic+survfit.formula">survfit.formula</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of survival estimates, one for each group, as produced by <code><a href="survival.html#topic+survfit.formula">survfit.formula</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.npdf">plot.npdf</a></code>, <code><a href="#topic+plot.survfit_npdf">plot.survfit_npdf</a></code>
</p>

<hr>
<h2 id='weibdata10040'>Hierarchical time-to-event data simulated from a Weibull baseline distribution with a nonparametric frailty</h2><span id='topic+weibdata10040'></span>

<h3>Description</h3>

<p>Hierarchical time-to-event data simulated from a Weibull baseline distribution with a nonparametric frailty
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weibdata10040
</code></pre>


<h3>Format</h3>

<p>A data frame with 4000 rows and the following columns
</p>

<dl>
<dt>family</dt><dd><p>Integer from 1 to 100 indicating the group membership.  There are 40 individuals in each group.</p>
</dd>
<dt>time</dt><dd><p>Survival time</p>
</dd>
<dt>status</dt><dd><p>Indicator for an observed event at the survival time</p>
</dd>
<dt>x</dt><dd><p>Covariate value, generated from a standard normal distribution</p>
</dd>
<dt>belong</dt><dd><p>Underlying group-specific frailty value</p>
</dd>
</dl>

<p>There are two underlying latent populations with proportion 0.8 and 0.2 with frailty values 0.8 and 1.6 respectively, thus the second population has twice the hazard of the first.  The covariate is associated with a log hazard ratio of 1.6.
</p>
<p>The baseline hazard is set to that of a Weibull model.
</p>
<p>The percentage of censored events is equal to 20.
</p>
<p>The dataset was generated by <code><a href="#topic+sim_weibdf">sim_weibdf</a></code> as follows.
</p>
<p><code>sim_weibdf( J = 100, N = 40, lambda = 0.3, rho = 1.3, beta = 1.6, p = c( 0.8, 0.2 ), w_values = c( 0.8, 1.6 ), cens_perc = 0.2)</code></p>

<hr>
<h2 id='weibdata2030'>Hierarchical time-to-event data simulated from a Weibull baseline distribution with a nonparametric frailty</h2><span id='topic+weibdata2030'></span>

<h3>Description</h3>

<p>Hierarchical time-to-event data simulated from a Weibull baseline distribution with a nonparametric frailty
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weibdata2030
</code></pre>


<h3>Format</h3>

<p>A data frame with 600 rows and the following columns
</p>

<dl>
<dt>family</dt><dd><p>Integer from 1 to 20 indicating the group membership. Each group has 30 individuals.</p>
</dd>
<dt>time</dt><dd><p>Survival time</p>
</dd>
<dt>status</dt><dd><p>Indicator for an observed event at the survival time</p>
</dd>
<dt>x</dt><dd><p>Covariate value, generated from a standard normal distribution</p>
</dd>
<dt>belong</dt><dd><p>Underlying group-specific frailty value</p>
</dd>
</dl>

<p>There are two underlying latent populations with proportion 0.3 and 0.7 with frailty values 0.8 and 1.6 respectively, thus the second population has twice the hazard of the first.  The covariate is associated with a log hazard ratio of 1.6.
</p>
<p>The baseline hazard is set to that of a Weibull model.
</p>
<p>The percentage of censored events is equal to 10.
</p>
<p>The dataset was generated by <code><a href="#topic+sim_weibdf">sim_weibdf</a></code> as follows.
</p>
<p><code>sim_weibdf( J = 20, N = 30, lambda = 0.6, rho = 1.1, beta = 1.6, p = c( 0.3, 0.7 ), w_values = c( 0.8, 1.6 ), cens_perc = 0.1)</code></p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
