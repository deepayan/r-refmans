<!DOCTYPE html><html lang="en"><head><title>Help for package phenoCDM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {phenoCDM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fitCDM'><p>Fit a CDM Model</p></a></li>
<li><a href='#getGibbsSummary'><p>Summarize Output of the CDM Model</p></a></li>
<li><a href='#phenoSim'><p>Simulate Green-up Phenology Data</p></a></li>
<li><a href='#phenoSimPlot'><p>Plot Simulated Phenology Data</p></a></li>
<li><a href='#plotPOGibbs'><p>Plot Observed vs Predicted</p></a></li>
<li><a href='#plotPost'><p>Plot Posterior Distributions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Continuous Development Models for Incremental Time-Series
Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-05-01</td>
</tr>
<tr>
<td>Author:</td>
<td>Bijan Seyednasrollah, Jennifer J. Swenson, Jean-Christophe Domec, James S. Clark</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bijan Seyednasrollah &lt;bijan.s.nasr@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Using the Bayesian state-space approach, we developed a continuous development model to quantify dynamic incremental changes in the response variable. While the model was originally developed for daily changes in forest green-up, the model can be used to predict any similar process. The CDM can capture both timing and rate of nonlinear processes. Unlike statics methods, which aggregate variations into a single metric, our dynamic model tracks the changing impacts over time. The CDM accommodates nonlinear responses to variation in predictors, which changes throughout development. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>rjags</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1.9000</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/bnasr/phenoCDM/issues">https://github.com/bnasr/phenoCDM/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-05-01 23:34:01 UTC; bijan</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-05-02 03:45:15 UTC</td>
</tr>
</table>
<hr>
<h2 id='fitCDM'>Fit a CDM Model</h2><span id='topic+fitCDM'></span>

<h3>Description</h3>

<p>This function fits a CDM model on the input data as it is described by the phenoSim function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitCDM(x, z, connect = NULL, nGibbs = 1000, nBurnin = 1, n.adapt = 100,
  n.chains = 4, quiet = FALSE, calcLatentGibbs = FALSE, trend = +1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitCDM_+3A_x">x</code></td>
<td>
<p>Matrix of predictors [N x p].</p>
</td></tr>
<tr><td><code id="fitCDM_+3A_z">z</code></td>
<td>
<p>Vector of response values [N x 1].</p>
</td></tr>
<tr><td><code id="fitCDM_+3A_connect">connect</code></td>
<td>
<p>The connectivity matrix for the z vector [n x 2]. Each row contains the last and next elements of the time-series. NA values indicate not connected.</p>
</td></tr>
<tr><td><code id="fitCDM_+3A_ngibbs">nGibbs</code></td>
<td>
<p>Number of MCMC itterations</p>
</td></tr>
<tr><td><code id="fitCDM_+3A_nburnin">nBurnin</code></td>
<td>
<p>Number of burn-in itterations.</p>
</td></tr>
<tr><td><code id="fitCDM_+3A_n.adapt">n.adapt</code></td>
<td>
<p>Number of itterations for adaptive sampling</p>
</td></tr>
<tr><td><code id="fitCDM_+3A_n.chains">n.chains</code></td>
<td>
<p>Number of MCMC chains</p>
</td></tr>
<tr><td><code id="fitCDM_+3A_quiet">quiet</code></td>
<td>
<p>logical value indicating whether to report the progress</p>
</td></tr>
<tr><td><code id="fitCDM_+3A_calclatentgibbs">calcLatentGibbs</code></td>
<td>
<p>logical value indicating whether to calculate the latent states</p>
</td></tr>
<tr><td><code id="fitCDM_+3A_trend">trend</code></td>
<td>
<p>time-series expected trend as -1:decreasing, +1:increasing, 0: not constrained</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
#Summarize CDM Model Ouput

ssSim &lt;- phenoSim(nSites = 2, #number of sites
                  nTSet = 30, #number of Time steps
                  beta = c(1, 2), #beta coefficients
                  sig = .01, #process error
                  tau = .1, #observation error
                  plotFlag = TRUE, #whether plot the data or not
                  miss = 0.05, #fraction of missing data
                  ymax = c(6, 3) #maximum of saturation trajectory
)

ssOut &lt;- fitCDM(x = ssSim$x, #predictors
                nGibbs = 200,
                nBurnin = 100,
                z = ssSim$z,#response
                connect = ssSim$connect, #connectivity of time data
                quiet=TRUE)

summ &lt;- getGibbsSummary(ssOut, burnin = 100, sigmaPerSeason = FALSE)

colMeans(summ$ymax)
colMeans(summ$betas)
colMeans(summ$tau)
colMeans(summ$sigma)

</code></pre>

<hr>
<h2 id='getGibbsSummary'>Summarize Output of the CDM Model</h2><span id='topic+getGibbsSummary'></span>

<h3>Description</h3>

<p>This function return a summary of the output from the Gibbs-Sampling of the CDM model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getGibbsSummary(ssOut, burnin = NULL, colNames = NULL,
  sigmaPerSeason = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getGibbsSummary_+3A_ssout">ssOut</code></td>
<td>
<p>CDM output list.</p>
</td></tr>
<tr><td><code id="getGibbsSummary_+3A_burnin">burnin</code></td>
<td>
<p>Number of burnin itterations .</p>
</td></tr>
<tr><td><code id="getGibbsSummary_+3A_colnames">colNames</code></td>
<td>
<p>vector of charachters includes names of each variable in the output.</p>
</td></tr>
<tr><td><code id="getGibbsSummary_+3A_sigmaperseason">sigmaPerSeason</code></td>
<td>
<p>logical value indicating whether each site/season has a separate process error</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
#Summarize CDM Model Ouput

ssSim &lt;- phenoSim(nSites = 2, #number of sites
                  nTSet = 30, #number of Time steps
                  beta = c(1, 2), #beta coefficients
                  sig = .01, #process error
                  tau = .1, #observation error
                  plotFlag = TRUE, #whether plot the data or not
                  miss = 0.05, #fraction of missing data
                  ymax = c(6, 3) #maximum of saturation trajectory
)

ssOut &lt;- fitCDM(x = ssSim$x, #predictors
                nGibbs = 200,
                nBurnin = 100,
                z = ssSim$z,#response
                connect = ssSim$connect, #connectivity of time data
                quiet=TRUE)

summ &lt;- getGibbsSummary(ssOut, burnin = 100, sigmaPerSeason = FALSE)

colMeans(summ$ymax)
colMeans(summ$betas)
colMeans(summ$tau)
colMeans(summ$sigma)

</code></pre>

<hr>
<h2 id='phenoSim'>Simulate Green-up Phenology Data</h2><span id='topic+phenoSim'></span>

<h3>Description</h3>

<p>This function return a set of simulated data for multiple green-up phenology time-series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phenoSim(nSites = 1000, nTSet = c(3:6), p = 2, beta = NULL, sig = 0.1,
  tau = 0.01, miss = 0, plotFlag = FALSE, ymax = 1, trend = +1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phenoSim_+3A_nsites">nSites</code></td>
<td>
<p>Number of sites/seasons</p>
</td></tr>
<tr><td><code id="phenoSim_+3A_ntset">nTSet</code></td>
<td>
<p>A vector of integer values. Length of each time-series will be randomly sampled from this vector.</p>
</td></tr>
<tr><td><code id="phenoSim_+3A_p">p</code></td>
<td>
<p>Number of predictors in the model.</p>
</td></tr>
<tr><td><code id="phenoSim_+3A_beta">beta</code></td>
<td>
<p>Beta coefficients</p>
</td></tr>
<tr><td><code id="phenoSim_+3A_sig">sig</code></td>
<td>
<p>Process error.</p>
</td></tr>
<tr><td><code id="phenoSim_+3A_tau">tau</code></td>
<td>
<p>Observation error.</p>
</td></tr>
<tr><td><code id="phenoSim_+3A_miss">miss</code></td>
<td>
<p>Fraction of missing data.</p>
</td></tr>
<tr><td><code id="phenoSim_+3A_plotflag">plotFlag</code></td>
<td>
<p>logical value indicating whether to plot the resulted time-series.</p>
</td></tr>
<tr><td><code id="phenoSim_+3A_ymax">ymax</code></td>
<td>
<p>Asymptotic maximum values.</p>
</td></tr>
<tr><td><code id="phenoSim_+3A_trend">trend</code></td>
<td>
<p>time-series expected trend as -1:decreasing, +1:increasing, 0: not constrained</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
#Simulate Phenology Data
ssSim &lt;- phenoSim(nSites = 2, #number of sites
                  nTSet = 30, #number of time steps
                  beta = c(1, 2), #beta coefficients
                  sig = .01, #process error
                  tau = .1, #observation error
                  plotFlag = TRUE, #whether plot the data or not
                  miss = 0.05, #fraction of missing data
                  ymax = c(6, 3) #maximum of saturation trajectory
)

</code></pre>

<hr>
<h2 id='phenoSimPlot'>Plot Simulated Phenology Data</h2><span id='topic+phenoSimPlot'></span>

<h3>Description</h3>

<p>This function plots the time-series data described with a connectivity matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phenoSimPlot(z, connect, add = FALSE, col = "blue", ylim = range(z, na.rm
  = TRUE), pch = 1, lwd = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phenoSimPlot_+3A_z">z</code></td>
<td>
<p>A vector of time-series data [n x 1]</p>
</td></tr>
<tr><td><code id="phenoSimPlot_+3A_connect">connect</code></td>
<td>
<p>The connectivity matrix for the z vector [n x 2]. Each row contains the last and next elements of the time-series. NA values means not connected.</p>
</td></tr>
<tr><td><code id="phenoSimPlot_+3A_add">add</code></td>
<td>
<p>logical value indicating whether the plot should be overlaid on the current panel.</p>
</td></tr>
<tr><td><code id="phenoSimPlot_+3A_col">col</code></td>
<td>
<p>The color variable as charachter</p>
</td></tr>
<tr><td><code id="phenoSimPlot_+3A_ylim">ylim</code></td>
<td>
<p>Range of the y axis</p>
</td></tr>
<tr><td><code id="phenoSimPlot_+3A_pch">pch</code></td>
<td>
<p>pch value for the symbols</p>
</td></tr>
<tr><td><code id="phenoSimPlot_+3A_lwd">lwd</code></td>
<td>
<p>lwd value for line tickness</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
#Simulate Phenology Data
ssSim &lt;- phenoSim(nSites = 2, #number of sites
                  nTSet = 30, #number of time steps
                  beta = c(1, 2), #beta coefficients
                  sig = .01, #process error
                  tau = .1, #observation error
                  plotFlag = TRUE, #whether plot the data or not
                  miss = 0.05, #fraction of missing data
                  ymax = c(6, 3) #maximum of saturation trajectory
)

#Plot Simulated Data
phenoSimPlot(ssSim$z, ssSim$connect)

</code></pre>

<hr>
<h2 id='plotPOGibbs'>Plot Observed vs Predicted</h2><span id='topic+plotPOGibbs'></span>

<h3>Description</h3>

<p>This function plot posterior distributions of the parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPOGibbs(o, p, nburnin = NULL, xlim = range(o, na.rm = TRUE),
  ylim = range(p, na.rm = TRUE), xlab = "Observed", ylab = "Predicted",
  colSet = c("#fb8072", "#80b1d3", "black"), cex = 1, lwd = 2, pch = 19)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotPOGibbs_+3A_o">o</code></td>
<td>
<p>Observed vector</p>
</td></tr>
<tr><td><code id="plotPOGibbs_+3A_p">p</code></td>
<td>
<p>Predicted Gibbs samples</p>
</td></tr>
<tr><td><code id="plotPOGibbs_+3A_nburnin">nburnin</code></td>
<td>
<p>numbe of burn-in itterations</p>
</td></tr>
<tr><td><code id="plotPOGibbs_+3A_xlim">xlim</code></td>
<td>
<p>x-axis range</p>
</td></tr>
<tr><td><code id="plotPOGibbs_+3A_ylim">ylim</code></td>
<td>
<p>y-axis range</p>
</td></tr>
<tr><td><code id="plotPOGibbs_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label</p>
</td></tr>
<tr><td><code id="plotPOGibbs_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label</p>
</td></tr>
<tr><td><code id="plotPOGibbs_+3A_colset">colSet</code></td>
<td>
<p>vector of colors for points, bars and the 1:1 line</p>
</td></tr>
<tr><td><code id="plotPOGibbs_+3A_cex">cex</code></td>
<td>
<p>cex value for size</p>
</td></tr>
<tr><td><code id="plotPOGibbs_+3A_lwd">lwd</code></td>
<td>
<p>line width</p>
</td></tr>
<tr><td><code id="plotPOGibbs_+3A_pch">pch</code></td>
<td>
<p>pch value for symbols</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
ssSim &lt;- phenoSim(nSites = 2, #number of sites
                  nTSet = 30, #number of Time steps
                  beta = c(1, 2), #beta coefficients
                  sig = .01, #process error
                  tau = .1, #observation error
                  plotFlag = TRUE, #whether plot the data or not
                  miss = 0.05, #fraction of missing data
                  ymax = c(6, 3) #maximum of saturation trajectory
)

ssOut &lt;- fitCDM(x = ssSim$x, #predictors
                nGibbs = 200,
                nBurnin = 100,
                z = ssSim$z,#response
                connect = ssSim$connect, #connectivity of time data
                quiet=TRUE)

summ &lt;- getGibbsSummary(ssOut, burnin = 100, sigmaPerSeason = FALSE)

colMeans(summ$ymax)
colMeans(summ$betas)
colMeans(summ$tau)
colMeans(summ$sigma)

par(mfrow = c(1,3), oma = c(1,1,3,1), mar=c(2,2,0,1), font.axis=2)

plotPost(chains = ssOut$chains[,c("beta.1", "beta.2")], trueValues = ssSim$beta)
plotPost(chains = ssOut$chains[,c("ymax.1", "ymax.2")], trueValues = ssSim$ymax)
plotPost(chains = ssOut$chains[,c("sigma", "tau")], trueValues = c(ssSim$sig, ssSim$tau))

mtext('Posterior distributions of the parameters', side = 3, outer = TRUE, line = 1, font = 2)
legend('topleft', legend = c('posterior', 'true value'),
     col = c('black', 'red'), lty = 1, bty = 'n', cex=1.5, lwd =2)


yGibbs &lt;- ssOut$latentGibbs
zGibbs &lt;- ssOut$zpred
o &lt;- ssOut$data$z
p &lt;- apply(ssOut$rawsamples$y, 1, mean)
R2 &lt;- cor(na.omit(cbind(o, p)))[1,2]^2
#Plot Observed vs Predicted
par( mar=c(4,4,1,1), font.axis=2)
plotPOGibbs(o = o , p = zGibbs,
            xlim = c(0,10), ylim=c(0,10),
            cex = .7, nburnin = 1000)
            points(o, p, pch = 3)

mtext(paste0('R² = ', signif(R2, 3)), line = -1, cex = 2, font = 2, side = 1, adj = .9)
legend('topleft', legend = c('mean', '95th percentile', '1:1 line', 'latent states'),
      col = c('#fb8072','#80b1d3','black', 'black'),
      bty = 'n', cex=1.5,
      lty = c(NA, 1, 2, NA), lwd =c(NA, 2, 2, 2), pch = c(16, NA, NA, 3))

</code></pre>

<hr>
<h2 id='plotPost'>Plot Posterior Distributions</h2><span id='topic+plotPost'></span>

<h3>Description</h3>

<p>This function plot posterior distributions of the parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPost(chains, trueValues = NULL, outline = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotPost_+3A_chains">chains</code></td>
<td>
<p>Gibbs sampling chains</p>
</td></tr>
<tr><td><code id="plotPost_+3A_truevalues">trueValues</code></td>
<td>
<p>numeric vector of true values</p>
</td></tr>
<tr><td><code id="plotPost_+3A_outline">outline</code></td>
<td>
<p>logical value whether showing outliers</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
ssSim &lt;- phenoSim(nSites = 2, #number of sites
                  nTSet = 30, #number of Time steps
                  beta = c(1, 2), #beta coefficients
                  sig = .01, #process error
                  tau = .1, #observation error
                  plotFlag = TRUE, #whether plot the data or not
                  miss = 0.05, #fraction of missing data
                  ymax = c(6, 3) #maximum of saturation trajectory
)

ssOut &lt;- fitCDM(x = ssSim$x, #predictors
                nGibbs = 200,
                nBurnin = 100,
                z = ssSim$z,#response
                connect = ssSim$connect, #connectivity of time data
                quiet=TRUE)

summ &lt;- getGibbsSummary(ssOut, burnin = 100, sigmaPerSeason = FALSE)

colMeans(summ$ymax)
colMeans(summ$betas)
colMeans(summ$tau)
colMeans(summ$sigma)

par(mfrow = c(1,3), oma = c(1,1,3,1), mar=c(2,2,0,1), font.axis=2)

plotPost(chains = ssOut$chains[,c("beta.1", "beta.2")], trueValues = ssSim$beta)
plotPost(chains = ssOut$chains[,c("ymax.1", "ymax.2")], trueValues = ssSim$ymax)
plotPost(chains = ssOut$chains[,c("sigma", "tau")], trueValues = c(ssSim$sig, ssSim$tau))

mtext('Posterior distributions of the parameters', side = 3, outer = TRUE, line = 1, font = 2)
legend('topleft', legend = c('posterior', 'true value'), col = c('black', 'red'),
         lty = 1, bty = 'n', cex=1.5, lwd =2)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
