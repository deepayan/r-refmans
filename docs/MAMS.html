<!DOCTYPE html><html lang="en"><head><title>Help for package MAMS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MAMS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.onAttach'><p>.onAttach</p></a></li>
<li><a href='#mams'><p>Function to design multi-arm multi-stage studies with normal endpoints</p></a></li>
<li><a href='#mams.sim'><p>Simulating multi-arm multi-stage designs</p></a></li>
<li><a href='#MAMSNews'><p>Shows changes and news</p></a></li>
<li><a href='#new.bounds'><p>Function to update boundaries based on observed sample sizes</p></a></li>
<li><a href='#ordinal.mams'><p>Function to design multi-arm multi-stage studies with ordinal or binary</p>
endpoints</a></li>
<li><a href='#plot.MAMS'><p>Plot method for MAMS objects</p></a></li>
<li><a href='#plot.MAMS.stepdown'><p>Plot method for MAMS.stepdown objects</p></a></li>
<li><a href='#print.MAMS'><p>Generic print function for class MAMS.</p></a></li>
<li><a href='#print.MAMS.stepdown'><p>Generic print function for class MAMS.stepdown.</p></a></li>
<li><a href='#stepdown.mams'><p>Function to find stopping boundaries for a 2- or 3-stage (step-down)</p>
multiple-comparisons-with-control test.</a></li>
<li><a href='#stepdown.update'><p>Update the stopping boundaries of multi-arm multi-stage study at an interim</p>
analysis, allowing for unplanned treatment selection and/or sample-size
reassessment.</a></li>
<li><a href='#summary.MAMS'><p>Generic summary function for class MAMS.</p></a></li>
<li><a href='#summary.MAMS.stepdown'><p>Generic summary function for class MAMS.stepdown.</p></a></li>
<li><a href='#tite.mams'><p>Function to design multi-arm multi-stage studies with time-to-event</p>
endpoints</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Designing Multi-Arm Multi-Stage Studies</td>
</tr>
<tr>
<td>Version:</td>
<td>3.0.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>mvtnorm, methods, future, future.apply, cli</td>
</tr>
<tr>
<td>Description:</td>
<td>Designing multi-arm multi-stage studies with (asymptotically) normal endpoints and known variance.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://tjaki.github.io/MAMS/">https://tjaki.github.io/MAMS/</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>mvtnorm</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2.9000</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-30 10:51:53 UTC; Nikita</td>
</tr>
<tr>
<td>Author:</td>
<td>Thomas Jaki <a href="https://orcid.org/0000-0002-1096-188X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Dominique-Laurent Couturier
    <a href="https://orcid.org/0000-0001-5774-5036"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Dominic Magirr [aut],
  Nikita Mozgunov <a href="https://orcid.org/0000-0003-0941-718X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Philip Pallmann [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thomas Jaki &lt;thomas.jaki@pm.me&gt;</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-30 22:30:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='.onAttach'>.onAttach</h2><span id='topic+.onAttach'></span>

<h3>Description</h3>

<p>Print MAMS package info
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.onAttach(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".onAttach_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>

<hr>
<h2 id='mams'>Function to design multi-arm multi-stage studies with normal endpoints</h2><span id='topic+mams'></span>

<h3>Description</h3>

<p>The function determines the boundaries of a multi-arm multi-stage study
for a given boundary shape and finds the required number of subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mams(obj = NULL, K=NULL, J=NULL, alpha=NULL, power=NULL, r=NULL, 
                     r0=NULL, p=NULL, p0=NULL, delta=NULL, delta0=NULL, 
                     sd=NULL,ushape=NULL, lshape=NULL, ufix=NULL, lfix=NULL, 
                     nstart=NULL, nstop=NULL, sample.size=NULL, Q=NULL,
                     type=NULL, parallel=NULL, print=NULL, nsim=NULL, 
                     H0=NULL, method=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mams_+3A_obj">obj</code></td>
<td>
<p>object of class <code>MAMS</code></p>
</td></tr>
<tr><td><code id="mams_+3A_k">K</code></td>
<td>
<p>Number of experimental treatments (default=4).</p>
</td></tr>
<tr><td><code id="mams_+3A_j">J</code></td>
<td>
<p>Number of stages (default=2).</p>
</td></tr>
<tr><td><code id="mams_+3A_alpha">alpha</code></td>
<td>
<p>One-sided familywise error rate (default=0.05).</p>
</td></tr>
<tr><td><code id="mams_+3A_power">power</code></td>
<td>
<p>Desired power (default=0.9).</p>
</td></tr>
<tr><td><code id="mams_+3A_r">r</code></td>
<td>
<p>Vector of allocation ratios (default=1:2).</p>
</td></tr>
<tr><td><code id="mams_+3A_r0">r0</code></td>
<td>
<p>Vector ratio on control (default=1:2).</p>
</td></tr>
<tr><td><code id="mams_+3A_p">p</code></td>
<td>
<p>Interesting treatment effect on the probability scale.
See Details (default=0.75).</p>
</td></tr>
<tr><td><code id="mams_+3A_p0">p0</code></td>
<td>
<p>Uninteresting treatment effect on the probability scale.
See Details (default=0.5). Note that this parameter affects the sample size
estimation to ensure that Treatment 1 is best only when selecting the
simultaneous stopping rule (i.e., 'method = &quot;simultaneous&quot;') and, for all
methods, as values for treatment arms 2 to K in the simulations under H1.</p>
</td></tr>
<tr><td><code id="mams_+3A_delta">delta</code></td>
<td>
<p>Interesting treatment effect on the traditional scale.
See Details (default=NULL).</p>
</td></tr>
<tr><td><code id="mams_+3A_delta0">delta0</code></td>
<td>
<p>Uninteresting treatment effect on the traditional scale.
See Details (default=NULL). Note that this parameter affects the sample size
estimation to ensure that Treatment 1 is best only when selecting the
simultaneous stopping rule (i.e., 'method = &quot;simultaneous&quot;') and, for all
methods, as values for treatment arms 2 to K in the simulations under H1.</p>
</td></tr>
<tr><td><code id="mams_+3A_sd">sd</code></td>
<td>
<p>Standard deviation, assumed to be known.
See Details (default=NULL).</p>
</td></tr>
<tr><td><code id="mams_+3A_ushape">ushape</code></td>
<td>
<p>Shape of upper boundary. Either a function specifying the shape
or one of &quot;pocock&quot;, &quot;obf&quot; (the default), &quot;triangular&quot; and &quot;fixed&quot;.
See details.</p>
</td></tr>
<tr><td><code id="mams_+3A_lshape">lshape</code></td>
<td>
<p>Shape of lower boundary. Either a function specifying the shape
or one of &quot;pocock&quot;, &quot;obf&quot;, &quot;triangular&quot; and &quot;fixed&quot; (the default).
See details.</p>
</td></tr>
<tr><td><code id="mams_+3A_ufix">ufix</code></td>
<td>
<p>Fixed upper boundary (default=NULL). Only used if shape=&quot;fixed&quot;.</p>
</td></tr>
<tr><td><code id="mams_+3A_lfix">lfix</code></td>
<td>
<p>Fixed lower boundary (default=0). Only used if shape=&quot;fixed&quot;.</p>
</td></tr>
<tr><td><code id="mams_+3A_nstart">nstart</code></td>
<td>
<p>Starting point for finding the sample size (default=1).</p>
</td></tr>
<tr><td><code id="mams_+3A_nstop">nstop</code></td>
<td>
<p>Stopping point for finding the sample size (default=NULL).</p>
</td></tr>
<tr><td><code id="mams_+3A_sample.size">sample.size</code></td>
<td>
<p>Logical if sample size should be found as well
(default=TRUE).</p>
</td></tr>
<tr><td><code id="mams_+3A_q">Q</code></td>
<td>
<p>Number of quadrature points per dimension in the outer integral
(default=20).</p>
</td></tr>
<tr><td><code id="mams_+3A_type">type</code></td>
<td>
<p>Will be changed automatically by the wrappers tite.mams()
(to &quot;tite&quot;) and ordinal.mams() (to &quot;ordinal&quot;) to customise the output.</p>
</td></tr>
<tr><td><code id="mams_+3A_parallel">parallel</code></td>
<td>
<p>if TRUE (default), allows parallelization of the computation
via a user-defined strategy specified by means of the function
future::plan().
If not set differently, the default strategy is sequential, which
corresponds to a computation without parallelization.</p>
</td></tr>
<tr><td><code id="mams_+3A_print">print</code></td>
<td>
<p>if TRUE (default), indicate at which stage the computation is.</p>
</td></tr>
<tr><td><code id="mams_+3A_nsim">nsim</code></td>
<td>
<p>a scalar indicating the number of simulations (default = 50'000,
minimum = 1000)</p>
</td></tr>
<tr><td><code id="mams_+3A_h0">H0</code></td>
<td>
<p>if TRUE (default), the simulation also considers the case with all
effect sizes set to 0.</p>
</td></tr>
<tr><td><code id="mams_+3A_method">method</code></td>
<td>
<p>Type of the desired design: <code>simultaneous</code>(default) for
simultaneous stopping rules, <code>sep</code> for separate stopping, and <code>dtl</code>
for drop-the-losers design.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function finds the boundaries and sample size of a multi-arm multi-stage
study with K active treatments plus control in which all promising
treatments are continued at interim analyses as described in
Magirr et al (2012). At each interim analysis the test statistics are
compared to the lower (futility) bound and any treatment whose corresponding
test statistic falls below that bound is discontinued. Similarly if any test
statistic exceeds the upper (efficacy) bound the null hypothesis
corresponding to that treatment can be rejected and superiority of that
treatment over control claimed. At the same time the study is stopped.
If at least one test statistic exceeds the lower bound and none exceeds the
upper bound the study is continued and further patients are recruited to all
remaining experimental treatments plus control.
</p>
<p>The design is found under the least favorable configuration, which requires
an interesting treatment effect <code>p</code> that if present we would like to find
with
high probability and an uninteresting effect <code>p0</code>. Both <code>p</code> and <code>p0</code> are
parameterized as <code class="reqn">P(X_k &gt; X_0 ) = p</code>, that is the
probability of a randomly selected person on treatment k observing a
better outcome than a random person on control. For <code>p=0.5</code> the experimental
treatment and control perform equally well.
The advantage of this parameterization is that no knowledge about the
variance is required. To convert traditional effect sizes,
d<code class="reqn">\delta</code>
to this format use
<code class="reqn">p=\Phi(\frac{\delta}{\sqrt{2}\sigma})</code>.
Alternatively, the interesting and uninteresting effect size can also be
specified directly on the traditional scale of <code>delta</code> and <code>delta</code> with an
additional specification of the standard deviation <code>sd</code> assumed to be known.
</p>
<p>The shape of the boundaries (<code>ushape</code>, <code>lshape</code>) are either using the
predefined shapes following Pocock (1977), O'Brien &amp; Fleming (1979) or the
triangular Test (Whitehead, 1997) using options &quot;<code style="white-space: pre;">&#8288;pocock"&#8288;</code>, <code>"obf"</code>or
<code>"triangular"</code> respectively, are constant (option <code>"fixed"</code>) or supplied
in as a function.
If a function is passed it should require exactly one argument specifying
the number of stages and return a vector of the same length. The lower
boundary shape is required to be non-decreasing while the upper boundary
shape needs to be non-increasing. If a fixed lower boundary is used, <code>lfix</code>
must be smaller than <code class="reqn">\Phi^{-1}(1-\alpha)/2</code>
to ensure that it is smaller than the upper boundary.
</p>
<p>The default starting point for finding the sample size is <code>nstart=1</code>, and
the default point where the search is stopped (when <code>nstop=NULL</code>) is 3
times the sample size of the corresponding fixed single-stage design.
</p>
<p>Computation of designs with more than four stages are very time consuming
and not advised. The parameter <code>sample.size</code> controls whether the required
sample size is computed as well. Setting to <code>FALSE</code> approximately halves
the computation time.
</p>
<p>For designs with more than 2 stages, parallelization of the computation by
means of the packages <span class="pkg">future</span> and <span class="pkg">future.apply</span> lead to decreased
computation times when choosing a parallelization strategy like, for
example, <code>multicore</code> (using separate forked R processes, available to
unix/osx users) or <code>multisession</code> (using separate R sessions, available
to all users) (refer to <a href="future.html#topic+plan">future::plan()</a> for detail).
</p>


<h3>Value</h3>

<p>An object of the class MAMS containing the following components:
</p>
<table role = "presentation">
<tr><td><code>l</code></td>
<td>
<p>Lower boundary.</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>Upper boundary.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Sample size on control in stage 1.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Maximum total sample size.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>Number of experimental treatments.</p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>Number of stages in the trial.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Familywise error rate.</p>
</td></tr>
<tr><td><code>alpha.star</code></td>
<td>
<p>Cumulative familywise error rate spent by each analysis.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>Power under least favorable configuration.</p>
</td></tr>
<tr><td><code>rMat</code></td>
<td>
<p>Matrix of allocation ratios. First row corresponds to control
while subsequent rows are for the experimental treatments.</p>
</td></tr>
<tr><td><code>sim</code></td>
<td>
<p>a list indicating, for each hypothesis of interest (null and/or
alternative), the expected sample size and standard deviation per group
(ess), the cumulated probability of efficacy (efficacy) and futility
(futility) per treatment arm and look</p>
</td></tr>
<tr><td><code>input</code></td>
<td>
<p>the list of all input parameters except K and J</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thomas Jaki, Dominic Magirr, Dominique-Laurent Couturier
and Nikita Mozgunov
</p>


<h3>References</h3>

<p>Jaki T., Pallmann P., and Magirr D. (2019), <em>The R Package MAMS for
Designing Multi-Arm Multi-Stage Clinical Trials</em>, <b>Journal of
Statistical Software</b>, 88(4), 1-25. Link:
<a href="https://doi.org/10.18637/jss.v088.i04">doi:10.18637/jss.v088.i04</a>
</p>
<p>Magirr D., Jaki T., and Whitehead J. (2012), <em>A generalized Dunnett test
for multi-arm multi-stage clinical studies with treatment selection</em>,
<b>Biometrika</b>, 99(2), 494-501. Link:
<a href="https://doi.org/10.1093/biomet/ass002">doi:10.1093/biomet/ass002</a>
</p>
<p>Pocock S.J. (1977), <em>Group sequential methods in the design and analysis
of clinical trials</em>, <b>Biometrika</b>, 64(2), 191-199.
</p>
<p>O'Brien P.C., and Fleming T.R. (1979), <em>A multiple testing procedure for
clinical trials</em>, <b>Biometrics</b>, 35(3), 549-556.
</p>
<p>Whitehead J. (1997), <em>The Design and Analysis of Sequential
Clinical Trials</em>, <b>Wiley</b>: Chichester, UK.
Wason J, Stallard N, Bowden J, Jennison C. A multi-stage drop-the-losers
design for multi-arm clinical trials. Statistical Methods in Medical
Research. 2017;26(1):508-524. doi:10.1177/0962280214550759
</p>


<h3>See Also</h3>

<p><a href="#topic+new.bounds">new.bounds</a>, <a href="#topic+ordinal.mams">ordinal.mams</a>, <a href="#topic+tite.mams">tite.mams</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## A fixed sample (single stage) design specified on the p scale
mams(K=4, J=1, alpha=0.05, power=0.9, r=1, r0=1, p=0.65, p0=0.55)

## The same design specified on the delta scale

mams(K=4, J=1, alpha=0.05, power=0.9, r=1, r0=1, p=NULL, p0=NULL,
     delta=0.545, delta0=0.178, sd=1)

## An example in Table 1 of Magirr et al (2012)
# 2-stage design with O'Brien &amp; Fleming efficacy and zero futility boundary

mams(K=4, J=2, alpha=0.05, power=0.9, r=1:2, r0=1:2, p=0.65, p0=0.55,
     ushape="obf", lshape="fixed", lfix=0, nstart=40)

## An example of separate stopping rules
# 2-stage design with O'Brien &amp; Fleming efficacy and zero futility boundary

mams(method = "sep",K=4, J=2, alpha=0.05, power=0.9, r=1:2, r0=1:2, 
       p=0.65, p0=0.55, ushape="obf", lshape="fixed", lfix=0, nstart=40)

# An example of running drop-the-losers design 
# `K` should be defined as vector length of J defining allocation arms per 
# stages with final element equal to 1.
mams(method = "dtl", K=c(4,1), J=2, alpha=0.05,  
         power=0.9, r=1:2, r0=1:2, p=0.65, p0=0.55, ushape="obf", 
         lshape="fixed", lfix=0, nstart=40)



# Note that these examples may take a few minutes to run

## 3-stage design with Triangular efficacy and futility boundary
mams(K=4, J=3, alpha=0.05, power=0.9, r=1:3, r0=1:3, p=0.65, p0=0.55,
  ushape="triangular", lshape="triangular", nstart=30)

## Different allocation ratios between control and experimental treatments.
## Twice as many patients are randomized to control at each stage.
  mams(K=4, J=2, alpha=0.05, power=0.9, r=1:2, r0=c(2, 4), p=0.65, 
  p0=0.55, ushape="obf", lshape="fixed", lfix=0, nstart=30)


  ##
  ## example considering different parallelization strategies
  ##


  # parallel = FALSE (future framework not used)
  set.seed(1)
  system.time(
  print(mams(K=4, J=3, alpha=0.05, power=0.9, r=1:3, r0=1:3,
          p=0.65, p0=0.55, ushape="triangular", lshape="triangular",
          nstart=30, parallel = FALSE))
          )
 # parallel = TRUE (default) with default strategy (sequential computation)
 plan(sequential)
 set.seed(1)
 system.time(
 print(mams(K=4, J=3, alpha=0.05, power=0.9, r=1:3, r0=1:3,
          p=0.65, p0=0.55, ushape="triangular", lshape="triangular", 
          nstart=30))
          )
 # parallel = TRUE(default) with multisession strategy (parallel computation)
 plan(multisession)
 set.seed(1)
 system.time(
 print(mams(K=4, J=3, alpha=0.05, power=0.9, r=1:3, r0=1:3, 
          p=0.65, p0=0.55, ushape="triangular", lshape="triangular",
           nstart=30))
          )
          plan("default")
          
</code></pre>

<hr>
<h2 id='mams.sim'>Simulating multi-arm multi-stage designs</h2><span id='topic+mams.sim'></span>

<h3>Description</h3>

<p>The function simulates multi-arm multi-stage designs and estimates power and
expected sample size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mams.sim(obj=NULL,nsim=NULL, nMat=NULL,
u=NULL, l=NULL, pv=NULL, deltav=NULL, sd=NULL, ptest=NULL,
parallel=NULL, H0=NULL, K = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mams.sim_+3A_obj">obj</code></td>
<td>
<p>an object of class <code>MAMS</code>. The parameters/design of the
considered in the output of the <code>mams()</code> function are considered as
reference for the simulation. If other parameters are given, their values
<em>override</em> the parameters of the <code>MAMS</code> object</p>
</td></tr>
<tr><td><code id="mams.sim_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulations (default='50000&ldquo;).</p>
</td></tr>
<tr><td><code id="mams.sim_+3A_nmat">nMat</code></td>
<td>
<p>Jx(K+1) dimensional matrix of observed/expected sample sizes.
Rows correspond to stages and columns to arms. First column is control
(default: <code>NULL</code>).</p>
</td></tr>
<tr><td><code id="mams.sim_+3A_u">u</code></td>
<td>
<p>Vector of previously used upper boundaries (default=<code>NULL</code>).</p>
</td></tr>
<tr><td><code id="mams.sim_+3A_l">l</code></td>
<td>
<p>Vector of previously used upper boundaries (default=<code>NULL</code>).</p>
</td></tr>
<tr><td><code id="mams.sim_+3A_pv">pv</code></td>
<td>
<p>Vector of size K of true treatment effects on the probability
scale. See Details (default=<code>NULL</code>).</p>
</td></tr>
<tr><td><code id="mams.sim_+3A_deltav">deltav</code></td>
<td>
<p>Vector of size K of true treatment effects on the traditional
scale. See Details (default=<code>NULL</code>).</p>
</td></tr>
<tr><td><code id="mams.sim_+3A_sd">sd</code></td>
<td>
<p>Standard deviation. See Details (default=<code>NULL</code>).</p>
</td></tr>
<tr><td><code id="mams.sim_+3A_ptest">ptest</code></td>
<td>
<p>Vector of treatment numbers for determining power.
For example, c(1, 2) will count rejections of one or both hypotheses for
testing treatments 1 and 2 against control (default=<code>1</code>).</p>
</td></tr>
<tr><td><code id="mams.sim_+3A_parallel">parallel</code></td>
<td>
<p>if <code>TRUE</code> (default), allows parallelization of the
computation via a user-defined strategy specified by means of the function
<code><a href="future.html#topic+plan">plan</a></code>. If not set differently, the default
strategy is <code>sequential</code>, which corresponds to a computation without
parallelization.</p>
</td></tr>
<tr><td><code id="mams.sim_+3A_h0">H0</code></td>
<td>
<p>if <code>TRUE</code> (default), the simulation also considers the case with
all effect sizes set to 0.</p>
</td></tr>
<tr><td><code id="mams.sim_+3A_k">K</code></td>
<td>
<p>Allocation for treatment arms (used only with method = &quot;dtl&quot;)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simulates multi-arm multi-stage studies for a given matrix of
sample sizes and boundaries given by the vectors <code>u</code> and  <code>l</code>.
The effect difference between each experimental treatment and control is
given by <code>pv</code> and is parameterized as
<code class="reqn">P(X_k &gt; X_0 ) = p</code>.
That is the probability of a randomly selected person on treatment k
observing a better outcome than a random person on control.
For <code>pv=rep(0.5,4)</code> the experimental treatments and control perform equally
well (i.e. the global null hypothesis is true).
The advantage of this parameterization is that no knowledge about the
variance is required. To convert traditional effect sizes,
<code class="reqn">\delta</code> to this format use
<code class="reqn">p=\Phi(\frac{\delta}{\sqrt{2}\sigma})</code>.
Alternatively, the effect size can also be specified directly on the
traditional scale of <code>deltav</code> with an additional specification of
the standard deviation <code>sd</code>.
</p>
<p>he function returns the probability of rejecting any hypothesis (<code>typeI</code>),
the power to reject the first hypothesis when the first treatment has the
largest estimated effect, the proportion of rejections of the hypothesis
specified by <code>ptest</code> (<code>prop.rej</code>) as well as the expected
sample size.
</p>


<h3>Value</h3>

<p>An object containing the following components:
</p>
<table role = "presentation">
<tr><td><code>l</code></td>
<td>
<p>Lower boundary.</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>Upper boundary.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Sample size on control in stage 1.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Maximum total sample size.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>Number of experimental treatments.</p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>Number of stages in the trial.</p>
</td></tr>
<tr><td><code>rMat</code></td>
<td>
<p>Matrix of allocation ratios. First row corresponds to control
and second row to experimental treatments.</p>
</td></tr>
<tr><td><code>nsim</code></td>
<td>
<p>Number of simulation runs.</p>
</td></tr>
<tr><td><code>typeI</code></td>
<td>
<p>The proportion any hypothesis is rejected.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>The proportion the first hypothesis is rejected and the
corresponding test statistic is largest.</p>
</td></tr>
<tr><td><code>ptest</code></td>
<td>
<p>The vector <code>ptest</code>.</p>
</td></tr>
<tr><td><code>prop.rej</code></td>
<td>
<p>The proportion of times at least one of the hypothesis
specified by <code>ptest</code> is rejected.</p>
</td></tr>
<tr><td><code>exss</code></td>
<td>
<p>The expected sample size.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thomas Jaki, Dominic Magirr and Dominique-Laurent Couturier
</p>


<h3>References</h3>

<p>Jaki T., Pallmann P., and Magirr D. (2019), <em>The R Package MAMS for
Designing Multi-Arm Multi-Stage Clinical Trials</em>, <b>Journal of
Statistical Software</b>, 88(4), 1-25. Link:
<a href="https://doi.org/10.18637/jss.v088.i04">doi:10.18637/jss.v088.i04</a>
</p>
<p>Magirr D., Jaki T., and Whitehead J. (2012), <em>A generalized Dunnett test
for multi-arm multi-stage clinical studies with treatment selection</em>,
<b>Biometrika</b>, 99(2), 494-501. Link:
<a href="https://doi.org/10.1093/biomet/ass002">doi:10.1093/biomet/ass002</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+mams">mams</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Note that some of these examples may take a few minutes to run

# 2-stage design with O'Brien &amp; Fleming efficacy and zero futility boundary
# with equal sample size per arm and stage. Design can be found using
# mams(K=4, J=2, alpha=0.05, power=0.9, r=1:2, r0=1:2, ushape="obf", 
     # lshape="fixed",
     # lfix=0, p=0.65, p0=0.55)

# under global null hypothesis (using the pv scale)
mams.sim(nsim=10000, nMat=matrix(c(44, 88), nrow=2, ncol=5), 
             u=c(3.068, 2.169),
             l=c(0.000, 2.169), pv=rep(0.5, 4), ptest=1)

# under global null hypothesis (using the deltav scale)
mams.sim(nsim=10000, nMat=matrix(c(44, 88), nrow=2, ncol=5), 
        u=c(3.068, 2.169),
        l=c(0.000, 2.169), pv=NULL, deltav=rep(0, 4), sd=1, ptest=1)

# under LFC
mams.sim(nsim=10000, nMat=matrix(c(44, 88), nrow=2, ncol=5), 
        u=c(3.068, 2.169),
        l=c(0.000, 2.169), pv=c(0.65, 0.55, 0.55, 0.55), ptest=1:2)

# when all treatments doing similarly well
mams.sim(nsim=10000, nMat=matrix(c(44, 88), nrow=2, ncol=5),
        u=c(3.068, 2.169),
        l=c(0.000, 2.169), pv=c(0.63, 0.62, 0.60, 0.61), ptest=4)

##
## example considering different parallelisation strategies
##

# parallel = FALSE (future framework not used)
set.seed(1)
system.time(
 print(mams.sim(nsim=25000, nMat=matrix(c(44, 88), nrow=2, ncol=5), 
                u=c(3.068, 2.169),
                l=c(0.000, 2.169), pv=c(0.65, 0.55, 0.55, 0.55),
                ptest=1:2, parallel=FALSE))
)
# parallel = TRUE (default) with default strategy (sequential computation)
plan(sequential)
set.seed(1)
system.time(
 print(mams.sim(nsim=25000, nMat=matrix(c(44, 88), nrow=2, ncol=5), 
                u=c(3.068, 2.169),
                l=c(0.000, 2.169), pv=c(0.65, 0.55, 0.55, 0.55), ptest=1:2))
)
# parallel = TRUE (default) with multisession strategy (parallel computation)
plan(multisession)
set.seed(1)
system.time(
 print(mams.sim(nsim=25000, nMat=matrix(c(44, 88), nrow=2, ncol=5),
                u=c(3.068, 2.169),
                l=c(0.000, 2.169), pv=c(0.65, 0.55, 0.55, 0.55), ptest=1:2))
)
plan("default")

</code></pre>

<hr>
<h2 id='MAMSNews'>Shows changes and news</h2><span id='topic+MAMSNews'></span>

<h3>Description</h3>

<p>Functions showing changes since previous versions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MAMSNews()
</code></pre>


<h3>Details</h3>

<p>Displays the changes and news given in the NEWS file of the package.
</p>


<h3>Value</h3>

<p>Screen output.
</p>


<h3>Author(s)</h3>

<p>Thomas Jaki
</p>


<h3>Examples</h3>

<pre><code class='language-R'>MAMSNews()
</code></pre>

<hr>
<h2 id='new.bounds'>Function to update boundaries based on observed sample sizes</h2><span id='topic+new.bounds'></span>

<h3>Description</h3>

<p>The function determines updated boundaries of a multi-arm
multi-stage study based on observed number of observations per arm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new.bounds(
  K = 3,
  J = 2,
  alpha = 0.05,
  nMat = matrix(c(10, 20), nrow = 2, ncol = 4),
  u = NULL,
  l = NULL,
  ushape = "obf",
  lshape = "fixed",
  ufix = NULL,
  lfix = 0,
  N = 20,
  parallel = TRUE,
  print = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="new.bounds_+3A_k">K</code></td>
<td>
<p>Number of experimental treatments (default=3).</p>
</td></tr>
<tr><td><code id="new.bounds_+3A_j">J</code></td>
<td>
<p>Number of stages (default=2).</p>
</td></tr>
<tr><td><code id="new.bounds_+3A_alpha">alpha</code></td>
<td>
<p>One-sided familywise error rate (default=0.05).</p>
</td></tr>
<tr><td><code id="new.bounds_+3A_nmat">nMat</code></td>
<td>
<p>Jx(K+1) dimensional matrix of observed/expected sample sizes.
Rows correspond to stages and columns to arms. First column is control
(default: 2x4 matrix with 10 subjects per stage and arm).</p>
</td></tr>
<tr><td><code id="new.bounds_+3A_u">u</code></td>
<td>
<p>Vector of previously used upper boundaries (default=NULL).</p>
</td></tr>
<tr><td><code id="new.bounds_+3A_l">l</code></td>
<td>
<p>Vector of previously used upper boundaries (default=NULL).</p>
</td></tr>
<tr><td><code id="new.bounds_+3A_ushape">ushape</code></td>
<td>
<p>Shape of upper boundary. Either a function specifying the
shape or one of &quot;pocock&quot;, &quot;obf&quot; (the default), &quot;triangular&quot; and &quot;fixed&quot;.
See details.</p>
</td></tr>
<tr><td><code id="new.bounds_+3A_lshape">lshape</code></td>
<td>
<p>Shape of lower boundary. Either a function specifying the
shape or one of &quot;pocock&quot;, &quot;obf&quot;, &quot;triangular&quot; and &quot;fixed&quot; (the default).
See details.</p>
</td></tr>
<tr><td><code id="new.bounds_+3A_ufix">ufix</code></td>
<td>
<p>Fixed upper boundary (default=NULL). Only used if shape=&quot;fixed&quot;.</p>
</td></tr>
<tr><td><code id="new.bounds_+3A_lfix">lfix</code></td>
<td>
<p>Fixed lower boundary (default=0). Only used if shape=&quot;fixed&quot;.</p>
</td></tr>
<tr><td><code id="new.bounds_+3A_n">N</code></td>
<td>
<p>Number of quadrature points per dimension in the outer integral
(default=20).</p>
</td></tr>
<tr><td><code id="new.bounds_+3A_parallel">parallel</code></td>
<td>
<p>if TRUE (default), allows parallelisation of the computation
via a user-defined strategy specified by means of the function
future::plan(). If not set differently, the default strategy is sequential,
which corresponds to a computation without parallelisation.</p>
</td></tr>
<tr><td><code id="new.bounds_+3A_print">print</code></td>
<td>
<p>if TRUE (default), indicate at which stage the computation is.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function finds the boundaries for a given matrix of sample
sizes in multi-arm multi-stage study with K active treatments plus control.
The vectors u and l are the boundaries used so far while u.shape and l.shape
specify the shape to the boundaries for the remaining analysis.
By specifying u and l as NULL, a design using only the shapes given by
ushape and lshape can be found for any sample sizes per stage and arm.
</p>
<p>The shape of the boundaries (ushape, lshape) are either using the
predefined shapes following Pocock (1977), O'Brien &amp; Fleming (1979)
or the triangular Test (Whitehead, 1997) using options &quot;pocock&quot;, &quot;obf&quot; or
&quot;triangular&quot; respectively, are constant (option &quot;fixed&quot;) or supplied in as
a function. If a function is passed it should require exactly one argument
specifying the number of stages and return a vector of the same length.
The lower boundary shape is required to be non-decreasing while the upper
boundary shape needs to be non-increasing. If a fixed lower boundary is
used, lfix must be smaller than <code class="reqn">\Phi^{-1}(1-\alpha)/2</code>
to ensure that it is smaller than the upper boundary.
</p>


<h3>Value</h3>

<p>An object of the class MAMS containing the following components: <br />
</p>
<table role = "presentation">
<tr><td><code>l</code></td>
<td>
<p>Lower boundary.</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>Upper boundary.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Sample size on control in stage 1.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Maximum total sample size.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>Number of experimental treatments.</p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>Number of stages in the trial.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Familywise error rate.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>Power under least favorable configuration.</p>
</td></tr>
<tr><td><code>rMat</code></td>
<td>
<p>Matrix of allocation ratios. First row corresponds to control
and second row to experimental treatments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thomas Jaki, Dominic Magirr and Dominique-Laurent Couturier
</p>


<h3>References</h3>

<p>Jaki T., Pallmann P. and Magirr D. (2019), The R Package MAMS for Designing
Multi-Arm Multi-Stage Clinical Trials, Journal of Statistical Software,
88(4), 1-25. Link: doi:10.18637/jss.v088.i04
</p>
<p>Magirr D., Jaki T. and Whitehead J. (2012), A generalized Dunnett test for
multi-arm multi-stage clinical studies with treatment selection, Biometrika,
99(2), 494-501. Link: doi:10.1093/biomet/ass002
</p>
<p>Magirr D., Stallard N. and Jaki T. (2014), Flexible sequential designs for
multi-arm clinical trials, Statistics in Medicine, 33(19), 3269-3279.
Link: doi:10.1002/sim.6183
</p>
<p>Pocock S.J. (1977), Group sequential methods in the design and analysis of
clinical trials, Biometrika, 64(2), 191-199.
</p>
<p>O'Brien P.C., Fleming T.R. (1979), A multiple testing procedure for clinical
trials, Biometrics, 35(3), 549-556.
</p>
<p>Whitehead J. (1997), The Design and Analysis of Sequential Clinical Trials,
Wiley: Chichester, UK.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Note that some of these examples may take a few minutes to run
# 2-stage design with O'Brien &amp; Fleming efficacy and zero futility boundary
with 
# equal sample size per arm and stage. Results are equivalent to using 
 mams(K=4, J=2, alpha=0.05, power=0.9, r=1:2, r0=1:2, ushape="obf",
           lshape="fixed", lfix=0, sample.size=FALSE)
new.bounds(K=4, J=2, alpha=0.05, nMat=matrix(c(10, 20), nrow=2, ncol=5),
u=NULL, l=NULL, 
           ushape="obf", lshape="fixed", lfix=0)
# A 2-stage design that was designed to use an O'Brien &amp; Fleming efficacy 
# and zero futility boundary with equal sample size per arm and stage (n=14).
# The observed sample size after stage one are 10, 10, 18, 10, 13 for each 
# arm while the original upper bounds used are (3.068, 2.169) for stage 1. 
# The updated bounds are (3.068, 2.167).
new.bounds(K=4, J=2, alpha=0.05, 
     nMat=matrix(c(10, 28, 10, 28, 18, 28, 10, 28, 13, 28), nrow=2, ncol=5), 
     u=3.068, l=0, ushape="obf", lshape="fixed", lfix=0)
           
# same using parallelisation via separate R sessions running in the 
# background
future::plan(multisession)
new.bounds(K=4, J=2, alpha=0.05, 
           nMat=matrix(c(10, 28, 10, 28, 18, 28, 10, 28, 13, 28), 
           nrow=2, ncol=5), 
           u=3.068, l=0, ushape="obf", lshape="fixed", lfix=0)
future::plan("default")

</code></pre>

<hr>
<h2 id='ordinal.mams'>Function to design multi-arm multi-stage studies with ordinal or binary
endpoints</h2><span id='topic+ordinal.mams'></span>

<h3>Description</h3>

<p>The function determines (approximately) the boundaries of a
multi-arm multi-stage study with ordinal or binary endpoints for a given
boundary shape and finds the required number of subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ordinal.mams(
  prob = c(0.35, 0.4, 0.25),
  or = 2,
  or0 = 1.2,
  K = 4,
  J = 2,
  alpha = 0.05,
  power = 0.9,
  r = 1:2,
  r0 = 1:2,
  ushape = "obf",
  lshape = "fixed",
  ufix = NULL,
  lfix = 0,
  nstart = 1,
  nstop = NULL,
  sample.size = TRUE,
  Q = 20,
  parallel = TRUE,
  print = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ordinal.mams_+3A_prob">prob</code></td>
<td>
<p>Vector of expected probabilities of falling into each category
under control conditions. The elements must sum up to one
(default=c(0.35, 0.4, 0.25)).</p>
</td></tr>
<tr><td><code id="ordinal.mams_+3A_or">or</code></td>
<td>
<p>Interesting treatment effect on the scale of odds ratios
(default=2).</p>
</td></tr>
<tr><td><code id="ordinal.mams_+3A_or0">or0</code></td>
<td>
<p>Uninteresting treatment effect on the scale of odds ratios
(default=1.2).</p>
</td></tr>
<tr><td><code id="ordinal.mams_+3A_k">K</code></td>
<td>
<p>Number of experimental treatments (default=4).</p>
</td></tr>
<tr><td><code id="ordinal.mams_+3A_j">J</code></td>
<td>
<p>Number of stages (default=2).</p>
</td></tr>
<tr><td><code id="ordinal.mams_+3A_alpha">alpha</code></td>
<td>
<p>One-sided familywise error rate (default=0.05).</p>
</td></tr>
<tr><td><code id="ordinal.mams_+3A_power">power</code></td>
<td>
<p>Desired power (default=0.9).</p>
</td></tr>
<tr><td><code id="ordinal.mams_+3A_r">r</code></td>
<td>
<p>Vector of allocation ratios (default=1:2).</p>
</td></tr>
<tr><td><code id="ordinal.mams_+3A_r0">r0</code></td>
<td>
<p>Vector ratio on control (default=1:2).</p>
</td></tr>
<tr><td><code id="ordinal.mams_+3A_ushape">ushape</code></td>
<td>
<p>Shape of upper boundary. Either a function specifying the
shape or one of &quot;pocock&quot;, &quot;obf&quot; (the default), &quot;triangular&quot; and &quot;fixed&quot;.</p>
</td></tr>
<tr><td><code id="ordinal.mams_+3A_lshape">lshape</code></td>
<td>
<p>Shape of lower boundary. Either a function specifying the
shape or one of &quot;pocock&quot;, &quot;obf&quot;, &quot;triangular&quot; and &quot;fixed&quot; (the default).</p>
</td></tr>
<tr><td><code id="ordinal.mams_+3A_ufix">ufix</code></td>
<td>
<p>Fixed upper boundary (default=NULL). Only used if shape=&quot;fixed&quot;.</p>
</td></tr>
<tr><td><code id="ordinal.mams_+3A_lfix">lfix</code></td>
<td>
<p>Fixed lower boundary (default=0). Only used if shape=&quot;fixed&quot;.</p>
</td></tr>
<tr><td><code id="ordinal.mams_+3A_nstart">nstart</code></td>
<td>
<p>Starting point for finding the sample size (default=1).</p>
</td></tr>
<tr><td><code id="ordinal.mams_+3A_nstop">nstop</code></td>
<td>
<p>Stopping point for finding the sample size (default=NULL).</p>
</td></tr>
<tr><td><code id="ordinal.mams_+3A_sample.size">sample.size</code></td>
<td>
<p>Logical if sample size should be found as well
(default=TRUE).</p>
</td></tr>
<tr><td><code id="ordinal.mams_+3A_q">Q</code></td>
<td>
<p>Number of quadrature points per dimension in the outer integral
(default=20).</p>
</td></tr>
<tr><td><code id="ordinal.mams_+3A_parallel">parallel</code></td>
<td>
<p>if TRUE (default), allows parallelisation of the computation
via a user-defined strategy specified by means of the function
future::plan(). If not set differently, the default strategy is sequential,
which corresponds to a computation without parallelisation.</p>
</td></tr>
<tr><td><code id="ordinal.mams_+3A_print">print</code></td>
<td>
<p>if TRUE (default), indicate at which stage the computation is.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function finds the (approximate) boundaries and sample size of
a multi-arm multi-stage study with ordinal or binary endpoints with K active
treatments plus control in which all promising treatments are continued at
interim analyses as described in Magirr et al (2012). It is a wrapper around
the basic mams function to facilitate its use with ordinal and binary
endpoints, following ideas of Whitehead &amp; Jaki (2009) and Jaki &amp; Magirr
(2013). For a binary endpoint the vector prob has only two elements
(success/failure, yes/no, etc.). See mams for further details on the basic
methodology.
</p>


<h3>Value</h3>

<p>An object of the class MAMS containing the following components: <br />
</p>
<table role = "presentation">
<tr><td><code>prob</code></td>
<td>
<p>Vector of expected probabilities of falling into each category
under control conditions. The elements must sum up to one
(default=<code>c(0.35, 0.4, 0.25)</code>).</p>
</td></tr>
<tr><td><code>or</code></td>
<td>
<p>Interesting treatment effect on the scale of odds ratios
(default=<code>2</code>).</p>
</td></tr>
<tr><td><code>or0</code></td>
<td>
<p>Uninteresting treatment effect on the scale of odds ratios
(default=<code>1.2</code>).</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>Number of experimental treatments (default=<code>4</code>).</p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>Number of stages (default=<code>2</code>).</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>One-sided familywise error rate (default=<code>0.05</code>).</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>Desired power (default=<code>0.9</code>).</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>Vector of allocation ratios (default=<code>1:2</code>).</p>
</td></tr>
<tr><td><code>r0</code></td>
<td>
<p>Vector ratio on control (default=<code>1:2</code>).</p>
</td></tr>
<tr><td><code>ushape</code></td>
<td>
<p>Shape of upper boundary. Either a function specifying the
shape or one of <code>"pocock"</code>, <code>"obf"</code> (the default),
<code>"triangular"</code> and <code>"fixed"</code>.</p>
</td></tr>
<tr><td><code>lshape</code></td>
<td>
<p>Shape of lower boundary. Either a function specifying the
shape or one of <code>"pocock"</code>, <code>"obf"</code>, <code>"triangular"</code> and
<code>"fixed"</code> (the default).</p>
</td></tr>
<tr><td><code>ufix</code></td>
<td>
<p>Fixed upper boundary (default=<code>NULL</code>). Only used if
<code>shape="fixed"</code>.</p>
</td></tr>
<tr><td><code>lfix</code></td>
<td>
<p>Fixed lower boundary (default=<code>0</code>). Only used if
<code>shape="fixed"</code>.</p>
</td></tr>
<tr><td><code>nstart</code></td>
<td>
<p>Starting point for finding the sample size
(default=<code>1</code>).</p>
</td></tr>
<tr><td><code>nstop</code></td>
<td>
<p>Stopping point for finding the sample size
(default=<code>NULL</code>).</p>
</td></tr>
<tr><td><code>sample.size</code></td>
<td>
<p>Logical if sample size should be found as well
(default=<code>TRUE</code>).</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Number of quadrature points per dimension in the outer integral
(default=<code>20</code>).</p>
</td></tr>
<tr><td><code>parallel</code></td>
<td>
<p>if <code>TRUE</code> (default), allows parallelisation of the
computation via a user-defined strategy specified by means of the function
<code><a href="future.html#topic+plan">future::plan()</a></code>. If not set differently,
the default strategy is <code>sequential</code>, which corresponds to a
computation without parallelisation.</p>
</td></tr>
<tr><td><code>print</code></td>
<td>
<p>if <code>TRUE</code> (default), indicate at which stage the
computation is.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Philip Pallmann
</p>


<h3>References</h3>

<p>Jaki T., Pallmann P. and Magirr D. (2019), The R Package MAMS for Designing
Multi-Arm Multi-Stage Clinical Trials, Journal of Statistical Software,
88(4), 1-25. Link: doi:10.18637/jss.v088.i04
</p>
<p>Magirr D., Jaki T. and Whitehead J. (2012), A generalized Dunnett test for
multi-arm multi-stage clinical studies with treatment selection, Biometrika,
99(2), 494-501. Link: doi:10.1093/biomet/ass002
</p>
<p>Magirr D., Stallard N. and Jaki T. (2014), Flexible sequential designs for
multi-arm clinical trials, Statistics in Medicine, 33(19), 3269-3279. Link:
doi:10.1002/sim.6183
</p>
<p>Pocock S.J. (1977), Group sequential methods in the design and analysis of
clinical trials, Biometrika, 64(2), 191-199.
</p>
<p>O'Brien P.C., Fleming T.R. (1979), A multiple testing procedure for clinical
trials, Biometrics, 35(3), 549-556.
</p>
<p>Whitehead J. (1997), The Design and Analysis of Sequential Clinical Trials,
Wiley: Chichester, UK.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## An example based on the example in Whitehead &amp; Jaki (2009)
# 2-stage design with triangular efficacy and futility boundaries
prob &lt;- c(0.075, 0.182, 0.319, 0.243, 0.015, 0.166)
ordinal.mams(prob=prob, or=3.06, or0=1.32, K=3, J=2, alpha=0.05,
                 power=0.9, r=1:2, r0=1:2, ushape="triangular",
                 lshape="triangular")
# same example with parallelisation via separate R sessions running in the
# background
future::plan(multisession)
ordinal.mams(prob=prob, or=3.06, or0=1.32, K=3, J=2, alpha=0.05,
                 power=0.9, r=1:2, r0=1:2, ushape="triangular",
                 lshape="triangular", parallel=TRUE)
future::plan("default")

</code></pre>

<hr>
<h2 id='plot.MAMS'>Plot method for MAMS objects</h2><span id='topic+plot.MAMS'></span>

<h3>Description</h3>

<p>produces as plot of the boundaries.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MAMS'
plot(
  x,
  ask = TRUE,
  which = 1:2,
  new = TRUE,
  col = NULL,
  pch = NULL,
  lty = NULL,
  main = NULL,
  xlab = "Analysis",
  ylab = "Test statistic",
  ylim = NULL,
  type = NULL,
  las = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.MAMS_+3A_x">x</code></td>
<td>
<p>An output object of class MAMS</p>
</td></tr>
<tr><td><code id="plot.MAMS_+3A_ask">ask</code></td>
<td>
<p>A logical indicating if R should wait for the next plot to be
displayed.</p>
</td></tr>
<tr><td><code id="plot.MAMS_+3A_which">which</code></td>
<td>
<p>A vector indicating which plot(s) to define. <code>1</code> displays
the efficacy and futility limits per stage, <code>2</code> displays the efficacy
nd futility probabilities per stage, <code>1:2</code> (default) displays both.</p>
</td></tr>
<tr><td><code id="plot.MAMS_+3A_new">new</code></td>
<td>
<p>A logical indicating if the new plot of the futility and efficacy
limits should be displayed (default='TRUE&ldquo;).</p>
</td></tr>
<tr><td><code id="plot.MAMS_+3A_col">col</code></td>
<td>
<p>A specification for the default plotting color (default=<code>NULL</code>).
See <code>par</code> for more details.</p>
</td></tr>
<tr><td><code id="plot.MAMS_+3A_pch">pch</code></td>
<td>
<p>Either an integer specifying a symbol or a single character to be
used as the default in plotting points (default=<code>NULL</code>). See <code>par</code>
for more details.</p>
</td></tr>
<tr><td><code id="plot.MAMS_+3A_lty">lty</code></td>
<td>
<p>A specification for the default line type to be used between
analyses (default=<code>NULL</code>). Setting to zero suppresses plotting of the
lines. See <code>par</code> for more details.</p>
</td></tr>
<tr><td><code id="plot.MAMS_+3A_main">main</code></td>
<td>
<p>An overall title for the plot (default=<code>NULL</code>).</p>
</td></tr>
<tr><td><code id="plot.MAMS_+3A_xlab">xlab</code></td>
<td>
<p>A title for the x axis (default=<code>"Analysis"</code>).</p>
</td></tr>
<tr><td><code id="plot.MAMS_+3A_ylab">ylab</code></td>
<td>
<p>A title for the y axis (default='&quot;Test statistic&quot;&ldquo;).</p>
</td></tr>
<tr><td><code id="plot.MAMS_+3A_ylim">ylim</code></td>
<td>
<p>A title for the y axis (default=<code>"Test statistic"</code>).</p>
</td></tr>
<tr><td><code id="plot.MAMS_+3A_type">type</code></td>
<td>
<p>Type of plot to be used (default=<code>NULL</code>). See <code>plot</code>
for more details.</p>
</td></tr>
<tr><td><code id="plot.MAMS_+3A_las">las</code></td>
<td>
<p>A specification of the axis labeling style. The default <code>1</code>
ensures the labels are always horizontal. See <code>?par</code> for details.</p>
</td></tr>
<tr><td><code id="plot.MAMS_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Graphic output.
</p>


<h3>Author(s)</h3>

<p>Thomas Jaki, Dominique-Laurent Couturier
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 2-stage design with triangular boundaries
res &lt;- mams(K=4, J=2, alpha=0.05, power=0.9, r=1:2, r0=1:2,
 p=0.65, p0=0.55, ushape="triangular", lshape="triangular", nstart=30)

plot(res)

</code></pre>

<hr>
<h2 id='plot.MAMS.stepdown'>Plot method for MAMS.stepdown objects</h2><span id='topic+plot.MAMS.stepdown'></span>

<h3>Description</h3>

<p>produces as plot of the boundaries.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MAMS.stepdown'
plot(
  x,
  col = NULL,
  pch = NULL,
  lty = NULL,
  main = NULL,
  xlab = "Analysis",
  ylab = "Test statistic",
  ylim = NULL,
  type = NULL,
  bty = "n",
  las = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.MAMS.stepdown_+3A_x">x</code></td>
<td>
<p>An output object of class MAMS.stepdown</p>
</td></tr>
<tr><td><code id="plot.MAMS.stepdown_+3A_col">col</code></td>
<td>
<p>A specification for the default plotting color (default=<code>NULL</code>).
See <code>par</code> for more details.</p>
</td></tr>
<tr><td><code id="plot.MAMS.stepdown_+3A_pch">pch</code></td>
<td>
<p>Either an integer specifying a symbol or a single character to be
used as the default in plotting points (default=<code>NULL</code>). See <code>par</code>
for more details.</p>
</td></tr>
<tr><td><code id="plot.MAMS.stepdown_+3A_lty">lty</code></td>
<td>
<p>A specification for the default line type to be used between
analyses (default=<code>NULL</code>). Setting to zero suppresses plotting of the
lines. See <code>par</code> for more details.</p>
</td></tr>
<tr><td><code id="plot.MAMS.stepdown_+3A_main">main</code></td>
<td>
<p>An overall title for the plot (default=<code>NULL</code>).</p>
</td></tr>
<tr><td><code id="plot.MAMS.stepdown_+3A_xlab">xlab</code></td>
<td>
<p>A title for the x axis (default=<code>"Analysis"</code>).</p>
</td></tr>
<tr><td><code id="plot.MAMS.stepdown_+3A_ylab">ylab</code></td>
<td>
<p>A title for the y axis (default='&quot;Test statistic&quot;&ldquo;).</p>
</td></tr>
<tr><td><code id="plot.MAMS.stepdown_+3A_ylim">ylim</code></td>
<td>
<p>A title for the y axis (default=<code>"Test statistic"</code>).</p>
</td></tr>
<tr><td><code id="plot.MAMS.stepdown_+3A_type">type</code></td>
<td>
<p>Type of plot to be used (default=<code>NULL</code>). See <code>plot</code>
for more details.</p>
</td></tr>
<tr><td><code id="plot.MAMS.stepdown_+3A_bty">bty</code></td>
<td>
<p>Should a box be drawn around the legend? The default <code>"n"</code>
does not draw a box, the alternative option <code>"o"</code> does.</p>
</td></tr>
<tr><td><code id="plot.MAMS.stepdown_+3A_las">las</code></td>
<td>
<p>A specification of the axis labeling style. The default <code>1</code>
ensures the labels are always horizontal. See <code>?par</code> for details.</p>
</td></tr>
<tr><td><code id="plot.MAMS.stepdown_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Graphic output.
</p>


<h3>Author(s)</h3>

<p>Thomas Jaki, Dominique-Laurent Couturier
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 2-stage design with triangular boundaries
res &lt;- mams(K=4, J=2, alpha=0.05, power=0.9, r=1:2, r0=1:2,
 p=0.65, p0=0.55, ushape="triangular", lshape="triangular", nstart=30)

plot(res)

</code></pre>

<hr>
<h2 id='print.MAMS'>Generic print function for class MAMS.</h2><span id='topic+print.MAMS'></span>

<h3>Description</h3>

<p>Generic print function for class MAMS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MAMS'
print(x, digits = max(3, getOption("digits") - 4), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.MAMS_+3A_x">x</code></td>
<td>
<p>An output object of class MAMS</p>
</td></tr>
<tr><td><code id="print.MAMS_+3A_digits">digits</code></td>
<td>
<p>Number of significant digits to be printed.</p>
</td></tr>
<tr><td><code id="print.MAMS_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>print produces a brief summary of an object from class MAMS
including boundaries and requires sample size if initially requested.
</p>


<h3>Value</h3>

<p>Text output.
</p>


<h3>Author(s)</h3>

<p>Thomas Jaki, Dominic Magirr, Philip Pallmann
</p>


<h3>References</h3>

<p>Magirr D, Jaki T, Whitehead J (2012) A generalized Dunnett test for multi-arm
multi-stage clinical studies with treatment selection.
Biometrika, 99(2), 494-501. Stallard N, Todd S (2003) Sequential designs for
phase III clinical trials
incorporating treatment selection. Statistics in Medicine, 22(5), 689-703.
Magirr D, Stallard N, Jaki T (2014) Flexible sequential designs for multi-arm
clinical trials. Statistics in Medicine, 33(19), 3269-3279.
</p>


<h3>See Also</h3>

<p><a href="#topic+mams">mams</a>, <a href="#topic+stepdown.mams">stepdown.mams</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 2-stage design with triangular boundaries
res &lt;- mams(K=4, J=2, alpha=0.05, power=0.9, r=1:2, r0=1:2, 
             p=0.65,p0=0.55,
             ushape="triangular", lshape="triangular", nstart=30)

print(res)

</code></pre>

<hr>
<h2 id='print.MAMS.stepdown'>Generic print function for class MAMS.stepdown.</h2><span id='topic+print.MAMS.stepdown'></span>

<h3>Description</h3>

<p>Generic print function for class MAMS.stepdown.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MAMS.stepdown'
print(x, digits = max(3, getOption("digits") - 4), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.MAMS.stepdown_+3A_x">x</code></td>
<td>
<p>An output object of class MAMS</p>
</td></tr>
<tr><td><code id="print.MAMS.stepdown_+3A_digits">digits</code></td>
<td>
<p>Number of significant digits to be printed.</p>
</td></tr>
<tr><td><code id="print.MAMS.stepdown_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>print produces a brief summary of an object from class MAMS.stepdown
including boundaries and requires sample size if initially requested.
</p>


<h3>Value</h3>

<p>Text output.
</p>

<hr>
<h2 id='stepdown.mams'>Function to find stopping boundaries for a 2- or 3-stage (step-down)
multiple-comparisons-with-control test.</h2><span id='topic+stepdown.mams'></span>

<h3>Description</h3>

<p>The function determines stopping boundaries for all intersection
hypothesis tests in a multi-arm multi-stage study, given the amount of alpha
(familywise error rate) to be spent at each analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stepdown.mams(nMat=matrix(c(10, 20), nrow=2, ncol=4),
             alpha.star=c(0.01, 0.025), lb=0,
             selection="all.promising")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stepdown.mams_+3A_nmat">nMat</code></td>
<td>
<p>Matrix containing the cumulative sample sizes in each treatment
arm columns: control, trt 1, ..., trt K), at each analysis (rows).
The number of analyses must be either 2 or 3 (default=matrix(c(10, 20),
nrow=2, ncol=4)).</p>
</td></tr>
<tr><td><code id="stepdown.mams_+3A_alpha.star">alpha.star</code></td>
<td>
<p>Cumulative familywise error rate to be spent at each
analysis (default=c(0.01, 0.025)).</p>
</td></tr>
<tr><td><code id="stepdown.mams_+3A_lb">lb</code></td>
<td>
<p>Fixed lower boundary (default=0).</p>
</td></tr>
<tr><td><code id="stepdown.mams_+3A_selection">selection</code></td>
<td>
<p>How are treatments selected for the next stage? Using the
default &quot;all.promising&quot; method, all treatments with a test statistic
exceeding the lower boundary are taken forward to the next stage.
If &quot;select.best&quot;, only the treatment with the largest statistic may be
selected for future stages. (default=&quot;all.promising&quot;).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function implements the methods described in Magirr et al (2014)
to find individual boundaries for all intersection hypotheses.
</p>


<h3>Value</h3>

<p>An object of the class MAMS.stepdown containing the following
components: <br />
</p>
<table role = "presentation">
<tr><td><code>l</code></td>
<td>
<p>Lower boundaries.</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>Upper boundaries.</p>
</td></tr>
<tr><td><code>nMat</code></td>
<td>
<p>Cumulative sample sizes on each treatment arm.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>Number of experimental treatments.</p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>Number of stages in the trial.</p>
</td></tr>
<tr><td><code>alpha.star</code></td>
<td>
<p>Cumulative familywise error rate spent at each analysis.</p>
</td></tr>
<tr><td><code>selection</code></td>
<td>
<p>Pre-specified method of treatment selection.</p>
</td></tr>
<tr><td><code>zscores</code></td>
<td>
<p>A list containing the observed test statistics at analyses
so far (at the design stage this is NULL).</p>
</td></tr>
<tr><td><code>selected.trts</code></td>
<td>
<p>A list containing the treatments selected for
each stage.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dominic Magirr
</p>


<h3>References</h3>

<p>Jaki T., Pallmann P. and Magirr D. (2019), The R Package MAMS for Designing
Multi-Arm Multi-Stage Clinical Trials, Journal of Statistical Software,
88(4), 1-25. Link: doi:10.18637/jss.v088.i04
</p>
<p>Magirr D., Jaki T. and Whitehead J. (2012), A generalized Dunnett test for
multi-arm multi-stage clinical studies with treatment selection, Biometrika,
99(2), 494-501. Link: doi:10.1093/biomet/ass002
</p>
<p>Magirr D., Stallard N. and Jaki T. (2014), Flexible sequential designs for
multi-arm clinical trials, Statistics in Medicine, 33(19), 3269-3279.
Link: doi:10.1002/sim.6183
</p>
<p>Stallard N. and Todd S. (2003), Sequential designs for phase III clinical
trials incorporating treatment selection, Statistics in Medicine, 22(5),
689-703.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Note that some of these examples may take a few minutes to run
# 2-stage 3-treatments versus control design, all promising treatments
# are selected:
stepdown.mams(nMat=matrix(c(10, 20), nrow=2, ncol=4), 
              alpha.star=c(0.01, 0.05), lb=0, 
              selection="all.promising")
# select the best treatment after the first stage:
stepdown.mams(nMat=matrix(c(10, 20), nrow=2, ncol=4), 
              alpha.star=c(0.01, 0.05), lb=0, 
              selection="select.best")
# 3 stages and unequal randomization:
stepdown.mams(nMat=matrix(c(20, 40, 60, rep(c(10, 20, 30), 3)), 
              nrow=3, ncol=4), 
              alpha.star=c(0.01, 0.025, 0.05), lb=c(0, 0.75), 
              selection="all.promising")

</code></pre>

<hr>
<h2 id='stepdown.update'>Update the stopping boundaries of multi-arm multi-stage study at an interim
analysis, allowing for unplanned treatment selection and/or sample-size
reassessment.</h2><span id='topic+stepdown.update'></span>

<h3>Description</h3>

<p>Function to update a planned multi-arm multi-stage design to
account for unplanned adaptations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stepdown.update(
  current.mams = stepdown.mams(),
  nobs = NULL,
  zscores = NULL,
  selected.trts = NULL,
  nfuture = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stepdown.update_+3A_current.mams">current.mams</code></td>
<td>
<p>The planned step-down MAMS design prior to the current
interim analysis (=defaultstepdown.mams()).</p>
</td></tr>
<tr><td><code id="stepdown.update_+3A_nobs">nobs</code></td>
<td>
<p>Cumulative sample sizes observed on each treatment arm up to and
including the current interim analysis.</p>
</td></tr>
<tr><td><code id="stepdown.update_+3A_zscores">zscores</code></td>
<td>
<p>Observed vector of test statistics at the current interim
analysis.</p>
</td></tr>
<tr><td><code id="stepdown.update_+3A_selected.trts">selected.trts</code></td>
<td>
<p>The set of experimental treatments to be taken forward
to the next stage of testing. This argument should be omitted at the final
analysis.</p>
</td></tr>
<tr><td><code id="stepdown.update_+3A_nfuture">nfuture</code></td>
<td>
<p>A matrix of future cumulative sample sizes. The number of rows
must be equal to the originally planned number of stages (2 or 3) minus the
number of stages already observed. The number of columns must be equal to
the number of treatment arms (default=NULL).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function implements the ideas described in Magirr et al. (2014)
to update a design according to unplanned design modifications. It takes as
input the planned multi-arm multi-stage design prior to the interim analysis,
together with the actually observed cumulative sample sizes and test
statistics. Treatments to be included in future stages, as well as future
sample sizes, can be chosen without following pre-specified rules. The output
is a new multi-arm multi-stage design for the remaining stages such that the
familywise error remains controlled at the pre-specified level.
</p>


<h3>Author(s)</h3>

<p>Dominic Magirr
</p>


<h3>References</h3>

<p>Jaki T., Pallmann P. and Magirr D. (2019), The R Package MAMS for Designing
Multi-Arm Multi-Stage Clinical Trials, Journal of Statistical Software,
88(4), 1-25. Link: doi:10.18637/jss.v088.i04
</p>
<p>Magirr D., Jaki T. and Whitehead J. (2012), A generalized Dunnett test for
multi-arm multi-stage clinical studies with treatment selection, Biometrika,
99(2), 494-501. Link: doi:10.1093/biomet/ass002
</p>
<p>Magirr D., Stallard N. and Jaki T. (2014), Flexible sequential designs for
multi-arm clinical trials, Statistics in Medicine, 33(19), 3269-3279.
Link: doi:10.1002/sim.6183
</p>
<p>Stallard N. and Todd S. (2003), Sequential designs for phase III clinical
trials incorporating treatment selection, Statistics in Medicine,
22(5), 689-703.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 2-stage 3-treatments versus control design
# all promising treatments are selected:
orig_mams &lt;- stepdown.mams(nMat=matrix(c(10, 20), nrow=2, ncol=4), 
                           alpha.star=c(0.01, 0.05), lb=0, 
                           selection="all.promising")

# make adjustment for the observed sample sizes 
# not being exactly as planned:
stepdown.update(orig_mams, nobs=c(9, 8, 13, 11), 
                 zscores=c(1.1, -0.5, 0.2), 
                 selected.trts=1:3, nfuture=NULL)

# make adjustment for the observed sample sizes 
# not being exactly as planned. In addition, drop treatment 2:
stepdown.update(orig_mams, nobs=c(9, 8, 13, 11), 
                 zscores=c(1.1, -0.5, 0.2), 
                 selected.trts=c(1, 3), nfuture=NULL)

# make adjustment for the observed sample sizes not being 
# exactly as planned. In addition, drop treatment 2. In addition, 
# double the planed cumulative second stage sample sizes:
updated_mams &lt;- stepdown.update(orig_mams, nobs=c(9, 8, 13, 11), 
                                 zscores=c(1.1, -0.5, 0.2), 
                                 selected.trts=c(1, 3), 
                                 nfuture=matrix(c(40, 40, 13, 40), 
                                 nrow=1, ncol=4))

# Account for the observed second stage sample sizes:
stepdown.update(updated_mams, nobs=c(38, 41, 13, 36), 
                zscores=c(1.9, -Inf, 1.2), 
                selected.trts=NULL)

# 'select.best' design. Account for actually observed sample sizes 
# in first stage, and drop treatment 2:
orig_mams &lt;- stepdown.mams(nMat=matrix(c(10, 20), nrow=2, ncol=4), 
                           alpha.star=c(0.01, 0.05), lb=0, 
                           selection="select.best")

stepdown.update(orig_mams, nobs=c(9, 8, 13, 11), 
                 zscores=c(1.1, -0.5, 0.2), 
                 selected.trts=c(1, 3), nfuture=NULL)

</code></pre>

<hr>
<h2 id='summary.MAMS'>Generic summary function for class MAMS.</h2><span id='topic+summary.MAMS'></span>

<h3>Description</h3>

<p>Produces a detailed summary of an object from class MAMS
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MAMS'
summary(
  object,
  digits = max(3, getOption("digits") - 4),
  extended = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.MAMS_+3A_object">object</code></td>
<td>
<p>An output object of class MAMS</p>
</td></tr>
<tr><td><code id="summary.MAMS_+3A_digits">digits</code></td>
<td>
<p>Number of significant digits to be printed.</p>
</td></tr>
<tr><td><code id="summary.MAMS_+3A_extended">extended</code></td>
<td>
<p>TRUE or FALSE</p>
</td></tr>
<tr><td><code id="summary.MAMS_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Text output.
</p>


<h3>Author(s)</h3>

<p>Dominique-Laurent Couturier
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 2-stage design with triangular boundaries
res &lt;- mams(K=4, J=2, alpha=0.05, power=0.9, r=1:2, r0=1:2,
             p=0.65, p0=0.55,
             ushape="triangular", lshape="triangular", nstart=30)

summary(res)

</code></pre>

<hr>
<h2 id='summary.MAMS.stepdown'>Generic summary function for class MAMS.stepdown.</h2><span id='topic+summary.MAMS.stepdown'></span>

<h3>Description</h3>

<p>Generic summary function for class MAMS.stepdown.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MAMS.stepdown'
summary(object, digits = max(3, getOption("digits") - 4), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.MAMS.stepdown_+3A_object">object</code></td>
<td>
<p>An output object of class MAMS</p>
</td></tr>
<tr><td><code id="summary.MAMS.stepdown_+3A_digits">digits</code></td>
<td>
<p>Number of significant digits to be printed.</p>
</td></tr>
<tr><td><code id="summary.MAMS.stepdown_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>print produces a brief summary of an object from class MAMS.stepdown
including boundaries and requires sample size if initially requested.
</p>


<h3>Value</h3>

<p>Text output.
</p>

<hr>
<h2 id='tite.mams'>Function to design multi-arm multi-stage studies with time-to-event
endpoints</h2><span id='topic+tite.mams'></span>

<h3>Description</h3>

<p>The function determines (approximately) the boundaries of a
multi-arm multi-stage study with time-to-event endpoints for a given boundary
shape and finds the required number of events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tite.mams(
  hr = 1.5,
  hr0 = 1.1,
  K = 4,
  J = 2,
  alpha = 0.05,
  power = 0.9,
  r = 1:2,
  r0 = 1:2,
  ushape = "obf",
  lshape = "fixed",
  ufix = NULL,
  lfix = 0,
  nstart = 1,
  nstop = NULL,
  sample.size = TRUE,
  Q = 20,
  parallel = TRUE,
  print = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tite.mams_+3A_hr">hr</code></td>
<td>
<p>Interesting treatment effect on the scale of hazard ratios
(default=2).</p>
</td></tr>
<tr><td><code id="tite.mams_+3A_hr0">hr0</code></td>
<td>
<p>Uninteresting treatment effect on the scale of hazard ratios
(default=1.2).</p>
</td></tr>
<tr><td><code id="tite.mams_+3A_k">K</code></td>
<td>
<p>Number of experimental treatments (default=4).</p>
</td></tr>
<tr><td><code id="tite.mams_+3A_j">J</code></td>
<td>
<p>Number of stages (default=2).</p>
</td></tr>
<tr><td><code id="tite.mams_+3A_alpha">alpha</code></td>
<td>
<p>One-sided familywise error rate (default=0.05).</p>
</td></tr>
<tr><td><code id="tite.mams_+3A_power">power</code></td>
<td>
<p>Desired power (default=0.9).</p>
</td></tr>
<tr><td><code id="tite.mams_+3A_r">r</code></td>
<td>
<p>Vector of allocation ratios (default=1:2).</p>
</td></tr>
<tr><td><code id="tite.mams_+3A_r0">r0</code></td>
<td>
<p>Vector ratio on control (default=1:2).</p>
</td></tr>
<tr><td><code id="tite.mams_+3A_ushape">ushape</code></td>
<td>
<p>Shape of upper boundary. Either a function specifying the shape
or one of &quot;pocock&quot;, &quot;obf&quot; (the default), &quot;triangular&quot; and &quot;fixed&quot;.</p>
</td></tr>
<tr><td><code id="tite.mams_+3A_lshape">lshape</code></td>
<td>
<p>Shape of lower boundary. Either a function specifying the shape
or one of &quot;pocock&quot;, &quot;obf&quot;, &quot;triangular&quot; and &quot;fixed&quot; (the default).</p>
</td></tr>
<tr><td><code id="tite.mams_+3A_ufix">ufix</code></td>
<td>
<p>Fixed upper boundary (default=NULL). Only used if shape=&quot;fixed&quot;.</p>
</td></tr>
<tr><td><code id="tite.mams_+3A_lfix">lfix</code></td>
<td>
<p>Fixed lower boundary (default=0). Only used if shape=&quot;fixed&quot;.</p>
</td></tr>
<tr><td><code id="tite.mams_+3A_nstart">nstart</code></td>
<td>
<p>Starting point for finding the sample size (default=1).</p>
</td></tr>
<tr><td><code id="tite.mams_+3A_nstop">nstop</code></td>
<td>
<p>Stopping point for finding the sample size (default=NULL).</p>
</td></tr>
<tr><td><code id="tite.mams_+3A_sample.size">sample.size</code></td>
<td>
<p>Logical if sample size should be found as well
(default=TRUE).</p>
</td></tr>
<tr><td><code id="tite.mams_+3A_q">Q</code></td>
<td>
<p>Number of quadrature points per dimension in the outer integral
(default=20).</p>
</td></tr>
<tr><td><code id="tite.mams_+3A_parallel">parallel</code></td>
<td>
<p>if TRUE (default), allows parallelisation of the computation
via a user-defined strategy specified by means of the function
future::plan(). If not set differently, the default strategy is sequential,
which corresponds to a computation without parallelisation.</p>
</td></tr>
<tr><td><code id="tite.mams_+3A_print">print</code></td>
<td>
<p>if TRUE (default), indicate at which stage the computation is.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function finds the (approximate) boundaries and sample size of
a multi-arm multi-stage study with time-to-event endpoints with K active
treatments plus control in which all promising treatments are continued at
interim analyses as described in Magirr et al (2012). It is a wrapper around
the basic mams function to facilitate its use with time-to-event endpoints,
following ideas of Jaki &amp; Magirr (2013). Note that the sample size is
calculated as the required number of events, from which the total sample
size can be estimated (e.g., Whitehead 2001). See ?mams for further details
on the basic methodology.
</p>


<h3>Value</h3>

<p>An object of the class MAMS containing the following components:
</p>
<table role = "presentation">
<tr><td><code>l</code></td>
<td>
<p>Lower boundary.</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>Upper boundary.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Sample size on control in stage 1.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Maximum total sample size.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>Number of experimental treatments.</p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>Number of stages in the trial.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Familywise error rate.</p>
</td></tr>
<tr><td><code>alpha.star</code></td>
<td>
<p>Cumulative familywise error rate spent by each analysis.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>Power under least favorable configuration.</p>
</td></tr>
<tr><td><code>rMat</code></td>
<td>
<p>Matrix of allocation ratios. First row corresponds to control
while subsequent rows are for the experimental treatments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Philip Pallmann, Dominic Magirr
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## An example 2-stage design with triangular efficacy and futility boundaries
tite.mams(hr=2, hr0=1.5, K=3, J=2, alpha=0.05, power=0.9,
          r=1:2, r0=1:2, ushape="triangular", lshape="triangular")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
