<!DOCTYPE html><html lang="en"><head><title>Help for package weightQuant</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {weightQuant}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#weightQuant-package'>
<p>Weights for incomplete longitudinal data and quantile regression</p></a></li>
<li><a href='#bootwrq'>
<p>Bootstrap procedure for weighted quantile regressions</p></a></li>
<li><a href='#simdata'>
<p>Simulated dataset</p></a></li>
<li><a href='#summary.bootwrq'>
<p>Summary of a quantile regression model</p></a></li>
<li><a href='#test.bootwrq'>
<p>Test of covariate effects between different quantiles</p></a></li>
<li><a href='#weightsIMD'>
<p>Estimation of observation-specific weights with intermittent missing</p>
data</a></li>
<li><a href='#weightsMMD'>
<p>Estimation of observation-specific weights with monotone missing</p>
data</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Weights for Incomplete Longitudinal Data and Quantile Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-01-05</td>
</tr>
<tr>
<td>Author:</td>
<td>Viviane Philipps</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Viviane Philipps &lt;Viviane.Philipps@u-bordeaux.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation of observation-specific weights for incomplete longitudinal data and bootstrap procedure for weighted quantile regressions. See Jacqmin-Gadda, Rouanet, Mba, Philipps, Dartigues (2020) for details &lt;<a href="https://doi.org/10.1177%2F0962280220909986">doi:10.1177/0962280220909986</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2.0)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>quantreg, foreach, doParallel, stringr</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/VivianePhilipps/weightQuant/issues">https://github.com/VivianePhilipps/weightQuant/issues</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-01-05 11:14:00 UTC; vp3</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-01-05 12:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='weightQuant-package'>
Weights for incomplete longitudinal data and quantile regression
</h2><span id='topic+weightQuant-package'></span><span id='topic+weightQuant'></span>

<h3>Description</h3>

<p>Functions for the estimation of observation-specific weights for
incomplete longitudinal data. A bootstrap method is also provided to
obtain standard erros of weighted quantile regressions.
</p>


<h3>Details</h3>

<p><code style="white-space: pre;">&#8288;
&#8288;</code>
</p>
<p><code style="white-space: pre;">&#8288;
&#8288;</code>
</p>

<table>
<tr>
 <td style="text-align: left;">
    Package:  </td><td style="text-align: left;"> weightQuant</td>
</tr>
<tr>
 <td style="text-align: left;">
    Type:     </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
    Version:  </td><td style="text-align: left;"> 1.0.1 </td>
</tr>
<tr>
 <td style="text-align: left;">
    Date:     </td><td style="text-align: left;"> 2022-01-05</td>
</tr>
<tr>
 <td style="text-align: left;">
    License:  </td><td style="text-align: left;"> GPL (&gt;= 2.0)</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p>Index:
</p>
<pre>bootwrq                 Bootstrap procedure for weighted quantile
                        regressions
simdata                 Simulated dataset
summary.bootwrq         Summary of a quantile regression model
test.bootwrq            Test of covariate effects between different
                        quantiles
weightQuant-package     Weights for incomplete longitudinal data and
                        quantile regression
weightsIMD              Estimation of observation-specific weights with
                        intermittent missing data
weightsMMD              Estimation of observation-specific weights with
                        monotone missing data</pre>


<h3>Author(s)</h3>

<p>Viviane Philipps
</p>


<h3>References</h3>

<p>Jacqmin-Gadda H, Rouanet A, Mba RD, Philipps V, Dartigues J-F. Quantile regression for incomplete longitudinal data with selection  by death. Statistical Methods in Medical Research. 2020;29(9):2697-2716. doi:10.1177/0962280220909986
</p>

<hr>
<h2 id='bootwrq'>
Bootstrap procedure for weighted quantile regressions
</h2><span id='topic+bootwrq'></span>

<h3>Description</h3>

<p>A subject-level bootstrap method for weighted quantile regressions is
implemented in this function. Quantile regressions are estimated in a
generalized estimating equation framework with independent working
covariance matrix. Weights are estimated using <code>weightsIMD</code> or
<code>weightsMMD</code> functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootwrq(B, form, tau, data, Y, X1 = NULL, X2 = NULL, subject,
death, time, interval.death = NULL, impute = NULL, weight = NULL,
wcompute = 2, seed = NULL, intermittent, file = NULL,
nproc = 1, MPI = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootwrq_+3A_b">B</code></td>
<td>

<p>integer, number of bootstrap samples
</p>
</td></tr>
<tr><td><code id="bootwrq_+3A_form">form</code></td>
<td>

<p>formula indicating the quantile regression model to be estimated
</p>
</td></tr>
<tr><td><code id="bootwrq_+3A_tau">tau</code></td>
<td>

<p>numeric vector indicating the quantiles to be estimated
</p>
</td></tr>
<tr><td><code id="bootwrq_+3A_data">data</code></td>
<td>

<p>data frame containing the data
</p>
</td></tr>
<tr><td><code id="bootwrq_+3A_y">Y</code></td>
<td>

<p>character indicating the name of the response outcome
</p>
</td></tr>
<tr><td><code id="bootwrq_+3A_x1">X1</code></td>
<td>

<p>optional character vector passed to the weight functions
</p>
</td></tr>
<tr><td><code id="bootwrq_+3A_x2">X2</code></td>
<td>

<p>optional character vector passed to the weight functions
</p>
</td></tr>
<tr><td><code id="bootwrq_+3A_subject">subject</code></td>
<td>

<p>character indicating the name of the subject identifier
</p>
</td></tr>
<tr><td><code id="bootwrq_+3A_death">death</code></td>
<td>

<p>optional character passed to the weight functions
</p>
</td></tr>
<tr><td><code id="bootwrq_+3A_time">time</code></td>
<td>

<p>optional character passed to the weight functions
</p>
</td></tr>
<tr><td><code id="bootwrq_+3A_interval.death">interval.death</code></td>
<td>

<p>optional numeric vector passed to the weight function weightsMMD
</p>
</td></tr>
<tr><td><code id="bootwrq_+3A_impute">impute</code></td>
<td>

<p>optional numeric vector passed to the weight function weightsIMD
</p>
</td></tr>
<tr><td><code id="bootwrq_+3A_weight">weight</code></td>
<td>

<p>character indicating the name of the weight variable in data
</p>
</td></tr>
<tr><td><code id="bootwrq_+3A_wcompute">wcompute</code></td>
<td>

<p>integer indicating if weights should be estimated in each bootstrap
sample. If wcompute=0, weights are supposed to be known. If
wcompute=1, weights are re-estimated in each bootstrp sample. If
wcompute=2, both results are returned.
</p>
</td></tr>
<tr><td><code id="bootwrq_+3A_seed">seed</code></td>
<td>

<p>optional integer vector of length B indicating the seeds.
</p>
</td></tr>
<tr><td><code id="bootwrq_+3A_intermittent">intermittent</code></td>
<td>

<p>logical indicating if data contains intermittent missing data. If
intermittent=TRUE, the weights are estimated using weightsIMD
function, if intermittent=FALSE, the weights are estimated using weightsMMD
function.
</p>
</td></tr>
<tr><td><code id="bootwrq_+3A_file">file</code></td>
<td>

<p>optional character indicating the name of the results file. If
file=NULL, no results file is created.
</p>
</td></tr>
<tr><td><code id="bootwrq_+3A_nproc">nproc</code></td>
<td>

<p>number of processors to be used for parallel computing. Default to 1,
sequential computation.
</p>
</td></tr>
<tr><td><code id="bootwrq_+3A_mpi">MPI</code></td>
<td>

<p>logical indicating if MPI parallelization should be used. Default to FALSE.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with B columns containing the results on each
bootstrap sample.
</p>


<h3>Author(s)</h3>

<p>Viviane Philipps, Robert Darlin Mba
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.bootwrq">summary.bootwrq</a></code>,  <code><a href="#topic+test.bootwrq">test.bootwrq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## computation of the weights with intermittent missing data 
w_simdata &lt;- weightsIMD(data=simdata,Y="Y",X1="X",X2=NULL,subject="id",
death="death",time="time",impute=20,name="w_imd")$data

## estimation of the weighted quantile regressions
## for the first quartile and the median
m_simdata &lt;- rq(Y~time*X,data=w_simdata,weights=w_imd,tau=c(0.25,0.5))

## estimation of the standard erros using the bootstrap procedure
boot_simdata &lt;- bootwrq(B=1000, form=Y~time*X, tau=c(0.25,0.5),
data=w_simdata, Y="Y",X1="X",X2=NULL,subject="id",
death="death",time="time",impute=20,wcompute=0,intermittent=TRUE)

## the summary of the results
summary(boot_simdata,m_simdata)

## comparison of the covariate effects
## between the first quartile and the median
test.bootwrq(boot_simdata,m_simdata)

## End(Not run)
</code></pre>

<hr>
<h2 id='simdata'>
Simulated dataset
</h2><span id='topic+simdata'></span>

<h3>Description</h3>

<p>The data were simulated from a linear mixed model. 
Repeated data of the longitudinal outcome were simulated for 500 subjects. 
Death time was simulated depending on the (observed and unobserved)
longitudinal outcome and on the binary covariate.
Missing data before death were simulated using a logistic regression
model including the binary covariate, the outcome at the previous visit and
the observation status at the previous visit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simdata</code></pre>


<h3>Format</h3>

<p>A data frame with 2123 observations over 500 different subjects and 7 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>subject identification number</p>
</dd>
<dt><code>X</code></dt><dd><p>binary covariate</p>
</dd>
<dt><code>death</code></dt><dd><p>death time (missing for subjects alive)</p>
</dd>
<dt><code>time</code></dt><dd><p>measurement time</p>
</dd>
<dt><code>age</code></dt><dd><p>age at measurement time</p>
</dd>
<dt><code>Y</code></dt><dd><p>longitudinal outcome</p>
</dd>
<dt><code>Ytrunc</code></dt><dd><p>longitudinal outcome truncated at the first
missing value</p>
</dd>
</dl>


<hr>
<h2 id='summary.bootwrq'>
Summary of a quantile regression model
</h2><span id='topic+summary.bootwrq'></span>

<h3>Description</h3>

<p>The function provides a summary of quantile regression
estimation. Standard erros and p values are obtained from a bootstrap procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bootwrq'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.bootwrq_+3A_object">object</code></td>
<td>

<p>results from bootstrap estimations obtained with bootwrq function
</p>
</td></tr>
<tr><td><code id="summary.bootwrq_+3A_...">...</code></td>
<td>
<p>additional arguments. If a quantile regression model
estimated with rq function from quantreg package is specified, the
function uses these estimated coefficients as results. Otherwise, the
coefficients are obtained as the mean over the B estimated
coefficients from the bootstrap results.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing :
</p>
<table role = "presentation">
<tr><td><code>results0</code></td>
<td>
<p>a matrix with 3 columns containing the results
(coefficients, standard erros and p-values) without computing the
weights in each bootstrap sample. Or NULL if the bootstrap results are
obtained with wcompute=1.</p>
</td></tr>
<tr><td><code>results1</code></td>
<td>
<p>a matrix with 3 columns containing the results
(coefficients, standard erros and p-values) with re-estimated weights
on each bootstrap sample. Or NULL if the bootstrap results are
obtained with wcompute=0.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Viviane Philipps
</p>

<hr>
<h2 id='test.bootwrq'>
Test of covariate effects between different quantiles
</h2><span id='topic+test.bootwrq'></span>

<h3>Description</h3>

<p>This function provides a test for the covariate effects estimated for
different quantiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test.bootwrq(x, m)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="test.bootwrq_+3A_x">x</code></td>
<td>

<p>results from bootstrap estimations obtained with bootwrq function
</p>
</td></tr>
<tr><td><code id="test.bootwrq_+3A_m">m</code></td>
<td>

<p>a quantile regression model estimated with rq function from quantreg
package. At least 2 quantiles should be specified in rq function.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For 2 quantiles tau1 and tau2, the test of the null hypothesis H0 : b_tau1 =
b_tau2 is obtained with the following procedure
:
1. estimate the difference diff = b_tau1 - b_tau2 on the initial sample
(ie from model m)
2. estimate the difference diff_b = b_tau1^b - b_tau2^b on each of the B
bootstrap samples
3. compute se_diff, the empirical standard error of these B differences
4. the associated p-value is obtained with the Gaussian assumption (
p-value = 2*P(N(0,1) &gt; abs(diff/se_diff)) )
</p>


<h3>Value</h3>

<p>A list containing :
</p>
<table role = "presentation">
<tr><td><code>results0</code></td>
<td>
<p>a matrix with 3 columns containing the results
(difference of the coefficients, standard erros of the diffrence and
assocated p-values) without computing the
weights in each bootstrap sample. Or NULL if the bootstrap results are
obtained with wcompute=1.</p>
</td></tr>
<tr><td><code>results1</code></td>
<td>
<p>a matrix with 3 columns containing the results
(difference of the coefficients, standard erros of the diffrence and
assocated p-values) with re-estimated weights
on each bootstrap sample. Or NULL if the bootstrap results are
obtained with wcompute=0.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Viviane Philipps
</p>

<hr>
<h2 id='weightsIMD'>
Estimation of observation-specific weights with intermittent missing
data
</h2><span id='topic+weightsIMD'></span>

<h3>Description</h3>

<p>This function provides stabilized weights for incomplete longitudinal
data selected by death. The procedure allows intermittent missing data
and assumes a missing at random (MAR) mechanism.
Weights are defined as the inverse of the probability of being
observed. These are obtained by pooled logistic regressions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weightsIMD(data, Y, X1, X2, subject, death, time, impute = 0, name = "weight")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="weightsIMD_+3A_data">data</code></td>
<td>

<p>data frame containing the observations and all variables named in
<code>Y</code>, <code>X1</code>, <code>X2</code>, <code>subject</code>, <code>death</code> and
<code>time</code> arguments.
</p>
</td></tr>
<tr><td><code id="weightsIMD_+3A_y">Y</code></td>
<td>

<p>character indicating the name of the response outcome
</p>
</td></tr>
<tr><td><code id="weightsIMD_+3A_x1">X1</code></td>
<td>

<p>character vector indicating the name of the covariates with 
interaction with the outcome Y in the logistic regressions
</p>
</td></tr>
<tr><td><code id="weightsIMD_+3A_x2">X2</code></td>
<td>

<p>character vector indicating the name of the covariates without 
interaction with the outcome Y in the logistic regressions
</p>
</td></tr>
<tr><td><code id="weightsIMD_+3A_subject">subject</code></td>
<td>

<p>character indicating the name of the subject identifier
</p>
</td></tr>
<tr><td><code id="weightsIMD_+3A_death">death</code></td>
<td>

<p>character indicating the time of death variable 
</p>
</td></tr>
<tr><td><code id="weightsIMD_+3A_time">time</code></td>
<td>

<p>character indicating the measurement time variable. Time should be 1 for
the first (theoretical) visit, 2 for the second (theoretical) visit, etc.
</p>
</td></tr>
<tr><td><code id="weightsIMD_+3A_impute">impute</code></td>
<td>

<p>numeric indicating the value to impute if the outcome Y is missing
</p>
</td></tr>
<tr><td><code id="weightsIMD_+3A_name">name</code></td>
<td>

<p>character indicating the name of the weight variable that will be added
to the data
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Denoting T_i the death time, R_ij the observation indicator for
subject i and occasion j, t the time, Y the outcome and X1 and X2 the covariates, we propose
weights for intermittent missing data defined as :
</p>
<p>w_ij = P(R_ij = 1 | T_i &gt; t_ij, X1_ij, X2_ij)  / P(R_ij = 1 | T_i &gt;
t_ij, X1_ij, X2_ij, Y_ij-1) 
</p>
<p>The numerator corresponds to the conditional probability of being
observed in the population currently alive under the MCAR assumption.
</p>
<p>The denominator is computed by recurrence :
</p>
<p>P(R_ij = 1 | T_i &gt; t_ij, X1_ij, X2_ij, Y_ij-1) =
</p>
<p>P(R_ij = 1 | T_i &gt; t_ij-1, X1_ij, X2_ij, Y_ij-1, R_ij-1 = 0) *
P(R_ij-1 = 0 | T_i &gt; t_ij, X1_ij, X2_ij, Y_ij-1) + P(R_ij =
1 | T_i &gt; t_ij-1, X1_ij, X2_ij, Y_ij-1, R_ij-1 = 1) *
P(R_ij-1 = 1 | T_i &gt; t_ij, X1_ij, X2_ij, Y_ij-1)
</p>
<p>Under the MAR assumption, the conditional probabilities lambda_ij = P(R_ij =
1 | T_i &gt; t_ij, X1_ij, X2_ij, Y_ij-1, R_ij-1) are obtained
from the logistic regression :
</p>
<p>logit(lambda_ij) = b_0j + b_1 X1_ij +  b_2 X2_ij +  b_3 Y_i(j-1) + b_4
X1_ij Y_i(j-1) + b_5 (1-R_ij-1)
</p>


<h3>Value</h3>

<p>A list containing :
</p>
<table role = "presentation">
<tr><td><code>data</code></td>
<td>
<p>the data frame with initial data and estimated weights as
last column</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>a list containing the estimates of the logistic
regressions. The first element of coef contains the estimates under the MCAR
assumption, the second contains the estimates under the MAR
assumption.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>a list containing the standard erros of the estimates
contained in coef, in the same order.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Viviane Philipps, Marion Medeville, Anais Rouanet, Helene Jacqmin-Gadda
</p>


<h3>See Also</h3>

<p><code><a href="#topic+weightsMMD">weightsMMD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>w_simdata &lt;- weightsIMD(data=simdata,Y="Y",X1="X",X2=NULL,subject="id",
death="death",time="time",impute=20,name="w_imd")$data
</code></pre>

<hr>
<h2 id='weightsMMD'>
Estimation of observation-specific weights with monotone missing
data
</h2><span id='topic+weightsMMD'></span>

<h3>Description</h3>

<p>This function provides stabilized weights for incomplete longitudinal
data selected by death. The procedure assumes monotne missing data and a
MAR-S mechanism, that is the probability of being observed depends also on
further death.
Weights are defined as the inverse of the probability of being
observed. These are obtained by pooled logistic regressions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weightsMMD(data, Y, X1, X2, subject, death, time, interval.death = 0, name = "weight")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="weightsMMD_+3A_data">data</code></td>
<td>

<p>data frame containing the observations and all variables named in
<code>Y</code>, <code>X1</code>, <code>X2</code>, <code>subject</code>, <code>death</code> and
<code>time</code> arguments.
</p>
</td></tr>
<tr><td><code id="weightsMMD_+3A_y">Y</code></td>
<td>

<p>character indicating the name of the response outcome
</p>
</td></tr>
<tr><td><code id="weightsMMD_+3A_x1">X1</code></td>
<td>

<p>character vector indicating the name of the covariates with 
interaction with the outcome Y in the logistic regressions
</p>
</td></tr>
<tr><td><code id="weightsMMD_+3A_x2">X2</code></td>
<td>

<p>character vector indicating the name of the covariates without 
interaction with the outcome Y in the logistic regressions
</p>
</td></tr>
<tr><td><code id="weightsMMD_+3A_subject">subject</code></td>
<td>

<p>character indicating the name of the subject identifier
</p>
</td></tr>
<tr><td><code id="weightsMMD_+3A_death">death</code></td>
<td>

<p>character indicating the time of death variable 
</p>
</td></tr>
<tr><td><code id="weightsMMD_+3A_time">time</code></td>
<td>

<p>character indicating the measurement time variable. Time should be 1 for
the first visit, 2 for the second visit, etc.
</p>
</td></tr>
<tr><td><code id="weightsMMD_+3A_interval.death">interval.death</code></td>
<td>

<p>integer vector, intervals (j-k) to consider for the MAR-S hypothesis (see
details). By default, interval.death=0, estimation under the MAR assumption.
</p>
</td></tr>
<tr><td><code id="weightsMMD_+3A_name">name</code></td>
<td>

<p>character indicating the name of the weight variable that will be added
to the data
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In longitudinal studies, follow-up can be truncated by death. Different
missingness mechanism can be assumed. Missing data can be :
1. MCAR (completely at random) if the missingness probability is
independent from the outcome and the death time
2. MAR (missing at random ) if the probability
is independent from the unobserved values of the outcome and from the
death time
3. MAR-S if the probability
is independent from the unobserved values but is different according to
the death time
4. MNAR (missing not at random) if the probability may depend on
unobserved values.
</p>
<p>Denoting T_i the death time, R_ij the observation indicator for
subject i and occasion j, t the time, Y the outcome and X1 and X2  the
covariates, we propose weights for monotone missing data defined as :
</p>
<p>w_ij = P(R_ij = 1 | T_i &gt; t_ij, X1_ij, X2_ij)  / P(R_ij = 1 | T_i &gt;
t_ij, X1_ij, X2_ij, Y_ij-1) 
</p>
<p>The numerator corresponds to the conditional probability of being
observed in the population currently alive under the MCAR assumption.
</p>
<p>The denominator is computed as a telescoping product :
</p>
<p>P(R_ij = 1 | T_i &gt; t_ij, X1_ij, X2_ij, Y_ij-1) =
</p>
<p>prod_k=2^j P(R_ik = 1 | R_ik-1 =  1, T_i &gt; t_ij, X1_ij,
X2_ij, Y_ij-1) = 
</p>
<p>prod_k=2^j lambda_ijk
</p>
<p>The probability lambda_ijk are obtained by logistic regressions.
</p>
<p>Under the MAR-S assumption, the regression model is :
</p>
<p>logit(lambda_ijk) = b_0k(j-k) + b_1(j-k) X1_ik +  b_2(j-k)
Y_i(k-1) + b_3(j-k) X1_ik Y_i(k-1) +  b_4(j-k) X2_ik 
</p>
<p>For each interval (j-k), one logistic regression is performed.
</p>
<p>Under the MAR assumption, one logistic regression is performed :
</p>
<p>logit(lambda_ikk) = b_0k + b_1 X1_ik + b_2 X2_ik +  b_3 Y_i(k-1) + b_4 X1_ik Y_i(k-1) 
</p>


<h3>Value</h3>

<p>A list containing :
</p>
<table role = "presentation">
<tr><td><code>data</code></td>
<td>
<p>the data frame with initial data and estimated weights as
last column</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>a list containing the estimates of the logistic
regressions. The first element of coef contains the estimates under the MCAR
assumption, the further contain the estimates under the MAR or MAR-S
assumption.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>a list containing the standard erros of the estimates
contained in coef, in the same order.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Viviane Philipps, Marion Medeville, Anais Rouanet, Helene Jacqmin-Gadda
</p>


<h3>See Also</h3>

<p><code><a href="#topic+weightsIMD">weightsIMD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>w_simdata &lt;- weightsMMD(data=simdata,Y="Ytrunc",X1="X", X2=NULL,
subject="id", death="death", time="time", interval.death = 0)$data
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
