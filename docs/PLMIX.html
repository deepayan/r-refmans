<!DOCTYPE html><html lang="en"><head><title>Help for package PLMIX</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PLMIX}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#PLMIX-package'>
<p>Bayesian Analysis of Finite Mixtures of Plackett-Luce Models for Partial Rankings/Orderings</p></a></li>
<li><a href='#as.top_ordering'><p>Coercion into top-ordering datasets</p></a></li>
<li><a href='#bicPLMIX'><p>BIC for the MLE of a mixture of Plackett-Luce models</p></a></li>
<li><a href='#binary_group_ind'><p>Binary group membership matrix</p></a></li>
<li><a href='#d_apa'><p>American Psychological Association Data (partial orderings)</p></a></li>
<li><a href='#d_carconf'><p>Car Configurator Data (partial orderings)</p></a></li>
<li><a href='#d_dublinwest'><p>Dublin West Data (partial orderings)</p></a></li>
<li><a href='#d_gaming'><p>Gaming Platforms Data (complete orderings)</p></a></li>
<li><a href='#d_german'><p>German Sample Data (complete orderings)</p></a></li>
<li><a href='#d_nascar'><p>NASCAR Data (partial orderings)</p></a></li>
<li><a href='#d_occup'><p>Occupation Data (complete orderings)</p></a></li>
<li><a href='#d_rice'><p>Rice Voting Data (partial orderings)</p></a></li>
<li><a href='#freq_to_unit'><p>Individual rankings/orderings from the frequency distribution</p></a></li>
<li><a href='#gibbsPLMIX'><p>Gibbs sampling for a Bayesian mixture of Plackett-Luce models</p></a></li>
<li><a href='#gsPLMIX_to_mcmc'><p>MCMC class objects from the Gibbs sampling simulations of a Bayesian mixture of Plackett-Luce models</p></a></li>
<li><a href='#is.top_ordering'><p>Top-ordering datasets</p></a></li>
<li><a href='#label_switchPLMIX'><p>Label switching adjustment  of the Gibbs sampling simulations for Bayesian mixtures of Plackett-Luce models</p></a></li>
<li><a href='#Loglikelihood'><p>Likelihood and log-likelihood evaluation for a mixture of Plackett-Luce models</p></a></li>
<li><a href='#make_complete'><p>Completion of partial rankings/orderings</p></a></li>
<li><a href='#make_partial'><p>Censoring of complete rankings/orderings</p></a></li>
<li><a href='#mapPLMIX'><p>MAP estimation for a Bayesian mixture of Plackett-Luce models</p></a></li>
<li><a href='#mapPLMIX_multistart'><p>MAP estimation for a Bayesian mixture of Plackett-Luce models with multiple starting values</p></a></li>
<li><a href='#paired_comparisons'><p>Paired comparison matrix for a partial ordering/ranking dataset</p></a></li>
<li><a href='#plot.gsPLMIX'><p>Plot the Gibbs sampling simulations for a Bayesian mixture of Plackett-Luce models</p></a></li>
<li><a href='#plot.mpPLMIX'><p>Plot the MAP estimates for a Bayesian mixture of Plackett-Luce models</p></a></li>
<li><a href='#ppcheckPLMIX'><p>Posterior predictive check for Bayesian mixtures of Plackett-Luce models</p></a></li>
<li><a href='#ppcheckPLMIX_cond'><p>Conditional posterior predictive check for Bayesian mixtures of Plackett-Luce models</p></a></li>
<li><a href='#print.gsPLMIX'><p>Print of the Gibbs sampling simulation of a Bayesian mixture of Plackett-Luce models</p></a></li>
<li><a href='#print.mpPLMIX'><p>Print of the MAP estimation algorithm for a Bayesian mixture of Plackett-Luce models</p></a></li>
<li><a href='#rank_ord_switch'><p>Switch from orderings to rankings and vice versa</p></a></li>
<li><a href='#rank_summaries'><p>Descriptive summaries for a partial ordering/ranking dataset</p></a></li>
<li><a href='#rPLMIX'><p>Random sample from a mixture of Plackett-Luce models</p></a></li>
<li><a href='#selectPLMIX'><p>Bayesian selection criteria for mixtures of Plackett-Luce models</p></a></li>
<li><a href='#summary.gsPLMIX'><p>Summary of the Gibbs sampling procedure for a Bayesian mixture of Plackett-Luce models</p></a></li>
<li><a href='#summary.mpPLMIX'><p>Summary of the MAP estimation for a Bayesian mixture of Plackett-Luce models</p></a></li>
<li><a href='#unit_to_freq'><p>Frequency distribution from the individual rankings/orderings</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Analysis of Finite Mixtures of Plackett-Luce Models for
Partial Rankings/Orderings</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-09-04</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit finite mixtures of Plackett-Luce models for partial top rankings/orderings within the Bayesian framework. It provides MAP point estimates via EM algorithm and posterior MCMC simulations via Gibbs Sampling. It also fits MLE as a special case of the noninformative Bayesian analysis with vague priors. In addition to inferential techniques, the package assists other fundamental phases of a model-based analysis for partial rankings/orderings, by including functions for data manipulation, simulation, descriptive summary, model selection and goodness-of-fit evaluation. Main references on the methods are Mollica and Tardella (2017) &lt;doi.org/10.1007/s11336-016-9530-0&gt; and Mollica and Tardella (2014) &lt;doi/10.1002/sim.6224&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.0), abind (&ge; 1.4-5), foreach (&ge; 1.4.4), ggplot2
(&ge; 2.2.1), ggmcmc (&ge; 1.2), coda (&ge; 0.19-1), reshape2 (&ge;
1.4.3), rcdd (&ge; 1.2), gridExtra (&ge; 2.3), MCMCpack (&ge; 1.4-2),
gtools (&ge; 3.8.1), label.switching (&ge; 1.6), radarchart (&ge;
0.3.1), prefmod (&ge; 0.8-34), rankdist (&ge; 1.1.3), StatRank (&ge;
0.0.6), pmr (&ge; 1.2.5), PlackettLuce (&ge; 0.2-3), stats, utils</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.0</td>
</tr>
<tr>
<td>Suggests:</td>
<td>doParallel</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-09-04 11:25:41 UTC; cmollica</td>
</tr>
<tr>
<td>Author:</td>
<td>Cristina Mollica [aut, cre],
  Luca Tardella [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Cristina Mollica &lt;cristina.mollica@uniroma1.it&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-09-04 11:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='PLMIX-package'>
Bayesian Analysis of Finite Mixtures of Plackett-Luce Models for Partial Rankings/Orderings
</h2><span id='topic+PLMIX-package'></span><span id='topic+PLMIX'></span>

<h3>Description</h3>

<p>The <span class="pkg">PLMIX</span> package for R provides functions to fit and analyze finite mixtures of Plackett-Luce models for partial top rankings/orderings within the Bayesian framework. It provides MAP point estimates via EM algorithm and posterior MCMC simulations via Gibbs Sampling. It also fits MLE as a special case of the noninformative Bayesian analysis with vague priors. 
</p>
<p>In addition to inferential techniques, the package assists other fundamental phases of a model-based analysis for partial rankings/orderings, by including functions for data manipulation, simulation, descriptive summary, model selection and goodness-of-fit evaluation.
</p>
<p>Specific S3 classes and methods are also supplied to enhance the usability and foster exchange with other packages. Finally, to address the issue of computationally demanding procedures typical in
ranking data analysis, <span class="pkg">PLMIX</span> takes advantage of a hybrid code linking the R environment with the C++ programming language.
</p>


<h3>Details</h3>

<p>The Plackett-Luce model is one of the most popular and frequently applied parametric distributions to analyze partial top rankings/orderings of a finite set of items. The present package allows to account for unobserved sample heterogeneity of partially ranked data with a model-based analysis relying on Bayesian finite mixtures of Plackett-Luce models. The package provides a suite of functions that covers the fundamental phases of a model-based analysis: 
</p>
<p><strong>Ranking data manipulation</strong>
</p>

<dl>
<dt><code><a href="#topic+binary_group_ind">binary_group_ind</a></code></dt><dd><p>Binary group membership matrix from the mixture component labels.</p>
</dd>
<dt><code><a href="#topic+freq_to_unit">freq_to_unit</a></code></dt><dd><p>From the frequency distribution to the dataset of individual orderings/rankings.</p>
</dd>
<dt><code><a href="#topic+make_complete">make_complete</a></code></dt><dd><p>Random completion of partial orderings/rankings data.</p>
</dd>
<dt><code><a href="#topic+make_partial">make_partial</a></code></dt><dd><p>Censoring of complete orderings/rankings data.</p>
</dd>
<dt><code><a href="#topic+rank_ord_switch">rank_ord_switch</a></code></dt><dd><p>From rankings to orderings and vice-versa.</p>
</dd>
<dt><code><a href="#topic+unit_to_freq">unit_to_freq</a></code></dt><dd><p>From the dataset of individual orderings/rankings to the frequency distribution.</p>
</dd>
</dl>

<p><strong>Ranking data simulation</strong>
</p>

<dl>
<dt><code><a href="#topic+rPLMIX">rPLMIX</a></code></dt><dd><p>Random sample from a finite mixture of Plackett-Luce models.</p>
</dd>
</dl>

<p><strong>Ranking data description</strong>
</p>

<dl>
<dt><code><a href="#topic+paired_comparisons">paired_comparisons</a></code></dt><dd><p>Paired comparison frequencies.</p>
</dd>
<dt><code><a href="#topic+rank_summaries">rank_summaries</a></code></dt><dd><p>Summary statistics of partial ranking/ordering data.</p>
</dd>
</dl>
    
<p><strong>Model estimation</strong>
</p>

<dl>
<dt><code><a href="#topic+gibbsPLMIX">gibbsPLMIX</a></code></dt><dd><p>Bayesian analysis with MCMC posterior simulation via Gibbs sampling.</p>
</dd>
<dt><code><a href="#topic+label_switchPLMIX">label_switchPLMIX</a></code></dt><dd><p>Label switching adjustment of the Gibbs sampling simulations.</p>
</dd>
<dt><code><a href="#topic+likPLMIX">likPLMIX</a></code></dt><dd><p>Likelihood evaluation for a mixture of Plackett-Luce models.</p>
</dd>
<dt><code><a href="#topic+loglikPLMIX">loglikPLMIX</a></code></dt><dd><p>Log-likelihood evaluation for a mixture of Plackett-Luce models.</p>
</dd>
<dt><code><a href="#topic+mapPLMIX">mapPLMIX</a></code></dt><dd><p>MAP estimation via EM algorithm.</p>
</dd>
<dt><code><a href="#topic+mapPLMIX_multistart">mapPLMIX_multistart</a></code></dt><dd><p>MAP estimation via EM algorithm with multiple starting values.</p>
</dd>
</dl>

<p><strong>Class coercion and membership</strong>
</p>

<dl>
<dt><code><a href="#topic+as.top_ordering">as.top_ordering</a></code></dt><dd><p>Coercion into top-ordering datasets.</p>
</dd>
<dt><code><a href="#topic+gsPLMIX_to_mcmc">gsPLMIX_to_mcmc</a></code></dt><dd><p>From the Gibbs sampling simulation to an MCMC class object.</p>
</dd>
<dt><code><a href="#topic+is.top_ordering">is.top_ordering</a></code></dt><dd><p>Test for the consistency of input data with a top-ordering dataset.</p>
</dd>
</dl>

<p><strong>S3 class methods</strong>
</p>

<dl>
<dt><code><a href="#topic+plot.gsPLMIX">plot.gsPLMIX</a></code></dt><dd><p>Plot of the Gibbs sampling simulations.</p>
</dd>
<dt><code><a href="#topic+plot.mpPLMIX">plot.mpPLMIX</a></code></dt><dd><p>Plot of the MAP estimates.</p>
</dd>
<dt><code><a href="#topic+print.gsPLMIX">print.gsPLMIX</a></code></dt><dd><p>Print of the Gibbs sampling simulations.</p>
</dd>
<dt><code><a href="#topic+print.mpPLMIX">print.mpPLMIX</a></code></dt><dd><p>Print of the MAP estimation algorithm.</p>
</dd>
<dt><code><a href="#topic+summary.gsPLMIX">summary.gsPLMIX</a></code></dt><dd><p>Summary of the Gibbs sampling procedure.</p>
</dd>
<dt><code><a href="#topic+summary.mpPLMIX">summary.mpPLMIX</a></code></dt><dd><p>Summary of the MAP estimation.</p>
</dd> 
</dl>

<p><strong>Model selection</strong>
</p>

<dl>
<dt><code><a href="#topic+bicPLMIX">bicPLMIX</a></code></dt><dd><p>BIC value for the MLE of a mixture of Plackett-Luce models.</p>
</dd>
<dt><code><a href="#topic+selectPLMIX">selectPLMIX</a></code></dt><dd><p>Bayesian model selection criteria.</p>
</dd>
</dl>

<p><strong>Model assessment</strong>
</p>

<dl>
<dt><code><a href="#topic+ppcheckPLMIX">ppcheckPLMIX</a></code></dt><dd><p>Posterior predictive diagnostics.</p>
</dd>
<dt><code><a href="#topic+ppcheckPLMIX_cond">ppcheckPLMIX_cond</a></code></dt><dd><p>Posterior predictive diagnostics conditionally on the number of ranked items.</p>
</dd>
</dl>

<p><strong>Datasets</strong>
</p>

<dl>
<dt><code><a href="#topic+d_apa">d_apa</a></code></dt><dd><p>American Psychological Association Data (partial orderings).</p>
</dd>
<dt><code><a href="#topic+d_carconf">d_carconf</a></code></dt><dd><p>Car Configurator Data (partial orderings).</p>
</dd>
<dt><code><a href="#topic+d_dublinwest">d_dublinwest</a></code></dt><dd><p>Dublin West Data (partial orderings).</p>
</dd>
<dt><code><a href="#topic+d_gaming">d_gaming</a></code></dt><dd><p>Gaming Platforms Data (complete orderings).</p>
</dd>
<dt><code><a href="#topic+d_german">d_german</a></code></dt><dd><p>German Sample Data (complete orderings).</p>
</dd>
<dt><code><a href="#topic+d_nascar">d_nascar</a></code></dt><dd><p>NASCAR Data (partial orderings).</p>
</dd>
<dt><code><a href="#topic+d_occup">d_occup</a></code></dt><dd><p>Occupation Data (complete orderings).</p>
</dd>
<dt><code><a href="#topic+d_rice">d_rice</a></code></dt><dd><p>Rice Voting Data (partial orderings).</p>
</dd>
</dl>

<p>Data have to be supplied as an object of class <code>matrix</code>, where missing positions/items are denoted with zero entries and Rank = 1 indicates the most-liked alternative. For a more efficient implementation of the methods, partial sequences with a single missing entry should be preliminarily filled in, as they correspond to complete rankings/orderings. In the present setting, ties are not allowed. Some quantities frequently recalled in the manual are the following: 
</p>

<dl>
<dt><code class="reqn">N</code></dt><dd><p>Sample size.</p>
</dd>
<dt><code class="reqn">K</code></dt><dd><p>Number of possible items.</p>
</dd>
<dt><code class="reqn">G</code></dt><dd><p>Number of mixture components.</p>
</dd>
<dt><code class="reqn">L</code></dt><dd><p>Size of the final posterior MCMC sample (after burn-in phase).</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>
<p>Maintainer: Cristina Mollica &lt;cristina.mollica@uniroma1.it&gt;
</p>


<h3>References</h3>

<p>Mollica, C. and Tardella, L. (2017). Bayesian Plackett-Luce mixture models for partially ranked data. <em>Psychometrika</em>, <b>82</b>(2), pages 442&ndash;458, ISSN: 0033-3123, <a href="http://dx.doi.org/10.1007/s11336-016-9530-0">http://dx.doi.org/10.1007/s11336-016-9530-0</a>.
</p>
<p>Mollica, C. and Tardella, L. (2014). Epitope profiling via mixture modeling for ranked data. <em>Statistics in Medicine</em>, <b>33</b>(21), pages 3738&ndash;3758, ISSN: 0277-6715, <a href="http://onlinelibrary.wiley.com/doi/10.1002/sim.6224/full">http://onlinelibrary.wiley.com/doi/10.1002/sim.6224/full</a>.
</p>

<hr>
<h2 id='as.top_ordering'>Coercion into top-ordering datasets</h2><span id='topic+as.top_ordering'></span>

<h3>Description</h3>

<p>Attempt to coerce the input data into a top-ordering dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.top_ordering(data, format_input = NULL, aggr = NULL,
  freq_col = NULL, ties_method = "random", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.top_ordering_+3A_data">data</code></td>
<td>
<p>An object containing the partial sequences to be coerced into an object of class <code>top_ordering</code>. The following classes are admissible for <code>data</code>: numeric <code>matrix</code>, <code>data.frame</code>, <code>RandData</code> from the <code>rankdist</code> package and <code>rankings</code> from the <code>PlackettLuce</code> package.</p>
</td></tr>
<tr><td><code id="as.top_ordering_+3A_format_input">format_input</code></td>
<td>
<p>Character string indicating the format of the <code>data</code> input, namely <code>"ordering"</code> or <code>"ranking"</code>. Used only when the class of the <code>data</code> argument is matrix or data frame. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="as.top_ordering_+3A_aggr">aggr</code></td>
<td>
<p>Logical: whether the <code>data</code> argument collects the distinct observed sequences with the corresponding frequencies (aggregated format). Used only when the class of the <code>data</code> aargument is matrix or data frame. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="as.top_ordering_+3A_freq_col">freq_col</code></td>
<td>
<p>Integer indicating the column of the <code>data</code> argument containing the frequencies of the distinct observed sequences. Used only when the class of the <code>data</code> argument is matrix or data frame and <code>aggr</code> argument is <code>TRUE</code>. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="as.top_ordering_+3A_ties_method">ties_method</code></td>
<td>
<p>Character string indicating the treatment of sequences with ties (not used for data of class <code>RankData</code>). If <code>"remove"</code>, the sequences with ties are removed before acting the coercion; if <code>"random"</code> (default), tied positions are re-assigned at random before acting the coercion.</p>
</td></tr>
<tr><td><code id="as.top_ordering_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods (not used).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The coercion function <code>as.top_ordering</code> tries to coerce the input data into an object of class <code>top_ordering</code> after checking for possible partial sequences that do not satisfy the top-ordering requirements. If none of the supplied sequences satisfies the top-ordering conditions, an error message is returned. <code>NA</code>'s in the input <code>data</code> are tacitly converted into zero entries.
</p>


<h3>Value</h3>

<p>An object of S3 class <code>c("top_ordering","matrix")</code>.
</p>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>References</h3>

<p>Turner, H., Kormidis, I. and Firth, D. (2018). PlackettLuce: Plackett-Luce Models for Rankings. R package version 0.2-3. <a href="https://CRAN.R-project.org/package=PlackettLuce">https://CRAN.R-project.org/package=PlackettLuce</a>
</p>
<p>Qian, Z. (2018). rankdist: Distance Based Ranking Models. R package version 1.1.3. <a href="https://CRAN.R-project.org/package=rankdist">https://CRAN.R-project.org/package=rankdist</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+is.top_ordering">is.top_ordering</a></code>, <code><a href="PlackettLuce.html#topic+as.rankings">as.rankings</a></code> and <code><a href="PlackettLuce.html#topic+rankings">rankings</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Coerce an object of class 'rankings' into an object of class 'top_ordering'
library(PlackettLuce)
RR &lt;- matrix(c(1, 2, 0, 0,
4, 1, 2, 3,
2, 1, 1, 1,
1, 2, 3, 0,
2, 1, 1, 0,
1, 0, 3, 2), nrow = 6, byrow = TRUE) 
RR_rank=as.rankings(RR)
RR_rank
as.top_ordering(RR_rank, ties_method="random")

## Coerce an object of class 'RankData' into an object of class 'top_ordering'
library(rankdist) 
data(apa_partial_obj)
d_apa_top_ord=as.top_ordering(data=apa_partial_obj)
identical(d_apa,d_apa_top_ord)

## Coerce a data frame from the package prefmod into an object of class 'top_ordering'
library(prefmod)
data(carconf)
carconf_rank=carconf[,1:6]
carconf_top_ord=as.top_ordering(data=carconf_rank,format_input="ranking",aggr=FALSE)
identical(d_carconf,carconf_top_ord)

## Coerce a data frame from the package pmr into an object of class 'top_ordering'
library(pmr)
data(big4)
head(big4)
big4_top_ord=as.top_ordering(data=big4,format_input="ranking",aggr=TRUE,freq_col=5)
head(big4_top_ord)

</code></pre>

<hr>
<h2 id='bicPLMIX'>BIC for the MLE of a mixture of Plackett-Luce models</h2><span id='topic+bicPLMIX'></span>

<h3>Description</h3>

<p>Compute BIC value for the MLE of a mixture of Plackett-Luce models fitted to partial orderings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bicPLMIX(max_log_lik, pi_inv, G, ref_known = TRUE, ref_vary = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bicPLMIX_+3A_max_log_lik">max_log_lik</code></td>
<td>
<p>Maximized log-likelihood value.</p>
</td></tr>
<tr><td><code id="bicPLMIX_+3A_pi_inv">pi_inv</code></td>
<td>
<p>An object of class <code>top_ordering</code>, collecting the numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of partial orderings, or an object that can be coerced with <code><a href="#topic+as.top_ordering">as.top_ordering</a></code>.</p>
</td></tr>
<tr><td><code id="bicPLMIX_+3A_g">G</code></td>
<td>
<p>Number of mixture components.</p>
</td></tr>
<tr><td><code id="bicPLMIX_+3A_ref_known">ref_known</code></td>
<td>
<p>Logical: whether the component-specific reference orders are known (not to be estimated). Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="bicPLMIX_+3A_ref_vary">ref_vary</code></td>
<td>
<p>Logical: whether the reference orders vary across mixture components. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>max_log_lik</code> and the BIC values can be straightforwardly obtained from the output of the <code><a href="#topic+mapPLMIX">mapPLMIX</a></code> and <code><a href="#topic+mapPLMIX_multistart">mapPLMIX_multistart</a></code> functions when the default noninformative priors are adopted in the MAP procedure. So, the <code>bicPLMIX</code> function is especially useful to compute the BIC value from the output of alternative MLE methods for mixtures of Plackett-Luce models implemented, for example, with other softwares.
</p>
<p>The <code>ref_known</code> and <code>ref_vary</code> arguments accommodate for the more general mixture of Extended Plackett-Luce models (EPL), involving the additional reference order parameters (Mollica and Tardella 2014). Since the Plackett-Luce model is a special instance of the EPL with the reference order equal to the identity permutation <code class="reqn">(1,\dots,K)</code>, the default values of <code>ref_known</code> and <code>ref_vary</code> are set equal, respectively, to <code>TRUE</code> and <code>FALSE</code>.
</p>


<h3>Value</h3>

<p>A list of two named objects:
</p>
<table role = "presentation">
<tr><td><code>max_log_lik</code></td>
<td>
<p> The <code>max_log_lik</code> argument.</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p> BIC value.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>References</h3>

<p>Mollica, C. and Tardella, L. (2017). Bayesian Plackett-Luce mixture models for partially ranked data. <em>Psychometrika</em>, <b>82</b>(2), pages 442&ndash;458, ISSN: 0033-3123, DOI: 10.1007/s11336-016-9530-0.
</p>
<p>Mollica, C. and Tardella, L. (2014). Epitope profiling via mixture modeling for ranked data. <em>Statistics in Medicine</em>, <b>33</b>(21), pages 3738&ndash;3758, ISSN: 0277-6715, DOI: 10.1002/sim.6224.
</p>
<p>Schwarz, G. (1978). Estimating the dimension of a model. <em>Ann. Statist.</em>, <b>6</b>(2), pages 461&ndash;464, ISSN: 0090-5364, DOI: 10.1002/sim.6224.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mapPLMIX">mapPLMIX</a></code> and <code><a href="#topic+mapPLMIX_multistart">mapPLMIX_multistart</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(d_carconf)
K &lt;- ncol(d_carconf)
MAP_mult &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=K, G=3, n_start=2, n_iter=400*3)
bicPLMIX(max_log_lik=MAP_mult$mod$max_objective, pi_inv=d_carconf, G=3)$bic

## Equivalently
MAP_mult$mod$bic

</code></pre>

<hr>
<h2 id='binary_group_ind'>Binary group membership matrix</h2><span id='topic+binary_group_ind'></span>

<h3>Description</h3>

<p>Construct the binary group membership matrix from the multinomial classification vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binary_group_ind(class, G)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="binary_group_ind_+3A_class">class</code></td>
<td>
<p>Numeric vector of class memberships.</p>
</td></tr>
<tr><td><code id="binary_group_ind_+3A_g">G</code></td>
<td>
<p>Number of possible different classes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric <code>length(class)</code><code class="reqn">\times</code><code class="reqn">G</code> matrix of binary group memberships.
</p>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
binary_group_ind(class=c(3,1,5), G=6)

</code></pre>

<hr>
<h2 id='d_apa'>American Psychological Association Data (partial orderings)</h2><span id='topic+d_apa'></span>

<h3>Description</h3>

<p>The popular American Psychological Association dataset (<code>d_apa</code>) contains the results of the voting ballots of the 1980 presidential election. A total of <code class="reqn">N=15449</code> voters ranked a maximum of <code class="reqn">K=5</code> candidates, conventionally classified as research psychologists (candidate 1 and 3), clinical psychologists (candidate 4 and 5) and community psychologists (candidate 2). The winner of the election was candidate 3. The dataset is composed of partial top orderings of varying lengths. Missing positions are denoted with zero entries.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(d_apa)</code></pre>


<h3>Format</h3>

<p>Object of S3 class <code>c("top_ordering","matrix")</code> gathering a matrix of partial orderings with <code class="reqn">N=15449</code> rows and <code class="reqn">K=5</code> columns Each row lists the candidates from the most-liked (<code>Rank_1</code>) to the least-liked (<code>Rank_5</code>) in a given voting ballot. 
</p>


<h3>References</h3>

<p>Mollica, C. and Tardella, L. (2017). Bayesian Plackett-Luce mixture models for partially ranked data. <em>Psychometrika</em>, <b>82</b>(2), pages 442&ndash;258, ISSN: 0033-3123, DOI: 10.1007/s11336-016-9530-0.
</p>
<p>Diaconis, P. W. (1988). Group representations in probability and statistics. <em>Lecture Notes-Monograph Series</em>, pages 94&ndash;96.
</p>
<p>Diaconis, P. W. (1987). Spectral analysis for ranked data. Technical Report 282, Dept of Statistics, Stanford University.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(d_apa)
head(d_apa)

## Subset of complete sequences
d_apa_compl=d_apa[rowSums(d_apa!=0)&gt;=(ncol(d_apa)-1),]
head(d_apa_compl)
</code></pre>

<hr>
<h2 id='d_carconf'>Car Configurator Data (partial orderings)</h2><span id='topic+d_carconf'></span>

<h3>Description</h3>

<p>The Car Configurator dataset (<code>d_carconf</code>) came up from a marketing study aimed at investigating customer preferences toward different car features.
A sample of <code class="reqn">N=435</code> customers were asked to construct their car by using an online configurator system and choose among <code class="reqn">K=6</code> car modules in order of preference. The car features are labeled as:
1 = price, 2 = exterior design, 3 = brand, 4 = technical equipment, 5 = producing country and 6 = interior design.
The survey did not require a complete ranking elicitation, therefore the dataset is composed of partial top orderings of varying lengths. Missing positions are denoted with zero entries.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(d_carconf)</code></pre>


<h3>Format</h3>

<p>Object of S3 class <code>c("top_ordering","matrix")</code> gathering a matrix of partial orderings with <code class="reqn">N=435</code> rows and <code class="reqn">K=6</code> columns. Each row lists the car features from the most important (<code>Rank_1</code>) to the least important (<code>Rank_6</code>) for a given customer.
</p>


<h3>References</h3>

<p>Mollica, C. and Tardella, L. (2017). Bayesian Plackett-Luce mixture models for partially ranked data. <em>Psychometrika</em>, <b>82</b>(2), pages 442&ndash;458, ISSN: 0033-3123, DOI: 10.1007/s11336-016-9530-0.
</p>
<p>Hatzinger, R. and Dittrich, R. (2012). Prefmod: An R package for modeling preferences based on paired comparisons, rankings, or ratings. <em>Journal of Statistical Software</em>, <b>48</b>(10), pages 1&ndash;31.
</p>
<p>Dabic, M. and Hatzinger, R. (2009). Zielgruppenadaequate Ablaeufe in Konfigurationssystemen - eine empirische Studie im Automobilmarkt - Partial Rankings. In Hatzinger, R., Dittrich, R. and  Salzberger, T. (eds), <em>Praeferenzanalyse mit R: Anwendungen aus Marketing, Behavioural
Finance und Human Resource Management</em>. Wien: Facultas.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(d_carconf)
head(d_carconf)

## Subset of complete sequences
d_carconf_compl=d_carconf[rowSums(d_carconf!=0)&gt;=(ncol(d_carconf)-1),]
head(d_carconf_compl)
</code></pre>

<hr>
<h2 id='d_dublinwest'>Dublin West Data (partial orderings)</h2><span id='topic+d_dublinwest'></span>

<h3>Description</h3>

<p>The Dublin West dataset (<code>d_dublinwest</code>) contains the results of the voting ballots of the 2002 Irish general election from the Dublin West constituency. The Irish voting system allows voters to rank the candidates in order of preferences, rather than only specify the favorite one. In the Dublin West constituency, <code class="reqn">N=29988</code> voters ranked a maximum of <code class="reqn">K=9</code> candidates, labeled as: 1 = Bonnie R., 2 = Burton J., 3 = Doherty-Ryan D., 4 = Higgins J., 5 = Lenihan B., 6 = McDonald M., 7 = Morrissey T., 8 = Smyth J. and 9 = Terry S..
The dataset is composed of partial top orderings of varying lengths. Missing positions are denoted with zero entries.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(d_dublinwest)</code></pre>


<h3>Format</h3>

<p>Object of S3 class <code>c("top_ordering","matrix")</code> gathering a partial orderings with <code class="reqn">N=29988</code> rows and <code class="reqn">K=9</code> columns. Each row lists the candidates from the most-liked (<code>Rank_1</code>) to the least-liked (<code>Rank_9</code>) in a given voting ballot. 
</p>


<h3>Source</h3>

<p>The 2002 Dublin West data have been downloaded from <a href="http://www.preflib.org/">http://www.preflib.org/</a> PrefLib: A Library for Preferences. In that repository, preferences with ties are also included. The original source was publicly available from the Dublin County Returning Officer
at the following URL: <a href="https://dublincountyreturningofficer.com/">https://dublincountyreturningofficer.com/</a>.</p>


<h3>References</h3>

<p>Mattei, N. and Walsh, T. (2013) PrefLib: A Library of Preference Data. <em>Proceedings of Third International Conference on Algorithmic Decision Theory</em> (ADT 2013). Springer, Lecture Notes in Artificial Intelligence, November 13-15, 2013.
</p>
<p>Gormley, I. C. and Murphy, T. B. (2009). A grade of membership model for rank data. <em>Bayesian Analysis</em>, <b>4</b>(2),  pages 65&ndash;295.
</p>
<p>Gormley, I. C. and Murphy, T. B. (2008). Exploring Voting Blocs Within the Irish Electorate: A Mixture Modeling Approach. <em>Journal of the America Statistical Association</em>, <b>103</b>(483), pages 1014&ndash;1027.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(d_dublinwest)
head(d_dublinwest)

## Subset of complete sequences
d_dublinwest_compl=d_dublinwest[rowSums(d_dublinwest!=0)&gt;=(ncol(d_dublinwest)-1),]
head(d_dublinwest_compl)
</code></pre>

<hr>
<h2 id='d_gaming'>Gaming Platforms Data (complete orderings)</h2><span id='topic+d_gaming'></span>

<h3>Description</h3>

<p>The Gaming Platforms dataset (<code>d_gaming</code>) collects the results of a survey conducted on a sample of <code class="reqn">N=91</code> Dutch students, who were asked to rank <code class="reqn">K=6</code> gaming platforms in order of preference, namely: 1 = X-Box, 2 = PlayStation, 3 = PSPortable, 4 = GameCube, 5 = GameBoy and 6 = Personal Computer. The dataset is composed of complete orderings. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(d_gaming)</code></pre>


<h3>Format</h3>

<p>Object of S3 class <code>c("top_ordering","matrix")</code> gathering a matrix of complete orderings with <code class="reqn">N=91</code> rows and <code class="reqn">K=6</code> columns. Each row lists the gaming platforms from the most-liked (<code>Rank_1</code>) to the least-liked (<code>Rank_6</code>) for a given student.
</p>


<h3>Source</h3>

<p>The Gaming Platforms dataset in .csv format can be downloaded from <a href="http://qed.econ.queensu.ca/jae/2012-v27.5/fok-paap-van_dijk/">http://qed.econ.queensu.ca/jae/2012-v27.5/fok-paap-van_dijk/</a>. The .csv files contains the preference data in ranking format and some covariates collected for each student.</p>


<h3>References</h3>

<p>Fok, D., Paap, R. and Van Dijk, B. (2012). A Rank-Ordered Logit Model With Unobserved Heterogeneity In Ranking Capatibilities. <em>Journal of Applied Econometrics</em>, <b>27</b>(5), pages 831&ndash;846.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(d_gaming)
head(d_gaming)
</code></pre>

<hr>
<h2 id='d_german'>German Sample Data (complete orderings)</h2><span id='topic+d_german'></span>

<h3>Description</h3>

<p>The German Sample dataset (<code>d_german</code>) is part of a comparative cross-sectional study on political actions and mass participation involving five Western countries. The dataset regards a sample of <code class="reqn">N=2262</code> German respondents who were asked to rank <code class="reqn">K=4</code> political goals in order of desirability, namely: 1 = maintaining order in the nation, 2 = giving people more say in the decisions of government, 3 = fighting rising prices and 4 = protecting freedom of speech. The dataset is composed of complete orderings. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(d_german)</code></pre>


<h3>Format</h3>

<p>Object of S3 class <code>c("top_ordering","matrix")</code> gathering a matrix of complete orderings with <code class="reqn">N=2262</code> rows and <code class="reqn">K=4</code> columns. Each row lists the political goals from the most desiderable (<code>Rank_1</code>) to the least desiderable (<code>Rank_4</code>) for a given respondent.
</p>


<h3>References</h3>

<p>Croon, M. A. (1989). Latent class models for the analysis of rankings. In De Soete, G., Feger, H. and Klauer, K. C. (eds), <em>New Developments in Psychological Choice Modeling</em>, pages 99&ndash;121. North-Holland: Amsterdam.
</p>
<p>Barnes, S. H. et al. (1979). Political action. Mass participation in five Western democracies. London: Sage.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(d_german)
head(d_german)
</code></pre>

<hr>
<h2 id='d_nascar'>NASCAR Data (partial orderings)</h2><span id='topic+d_nascar'></span>

<h3>Description</h3>

<p>The NASCAR dataset (<code>d_nascar</code>) collects the results of the 2002 season of stock car racing held in the United States. The 2002 championship consisted of <code class="reqn">N=36</code> races, with 43 car drivers competing in each race. A total of <code class="reqn">K=87</code> drivers participated in the 2002 season, taking part to a variable number of races: some of them competed in all the races, some others in only one. The results of the entire 2002 season were collected in the form of top-43 orderings, where the position of the not-competing drivers in each race is assumed lower than the 43th, but undetermined. Missing positions are denoted with zero entries.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(d_nascar)</code></pre>


<h3>Format</h3>

<p>Object of S3 class <code>c("top_ordering","matrix")</code> gathering a matrix of partial orderings with <code class="reqn">N=36</code> rows and <code class="reqn">K=87</code> columns. Each row lists the car drivers from the top position (<code>Rank_1</code>) to the bottom one (<code>Rank_87</code>) in a given race. Columns from the 44th to the 87th are filled with zeros, because only 43 drivers competed in each race.
</p>


<h3>Source</h3>

<p>The NASCAR dataset in the MATLAB format used by Hunter, D. R. (2004) can be downloaded from <a href="http://sites.stat.psu.edu/~dhunter/code/btmatlab/">http://sites.stat.psu.edu/~dhunter/code/btmatlab/</a>. At the same link, a .xls file with drivers' names is also available.</p>


<h3>References</h3>

<p>Caron, F. and Doucet, A. (2012). Efficient Bayesian inference for Generalized Bradley-Terry models. <em>J. Comput. Graph. Statist.</em>, <b>21</b>(1), pages 174&ndash;196.
</p>
<p>Guiver, J. and Snelson, E. (2009). Bayesian inference for Plackett-Luce ranking models. In Bottou, L. and Littman, M., editors, <em>Proceedings of the 26th International Conference on Machine Learning - ICML 2009</em>, pages 377&ndash;384. Omnipress.
</p>
<p>Hunter, D. R. (2004). MM algorithms for Generalized Bradley-Terry models. <em>Ann. Statist.</em>, <b>32</b>(1), pages 384&ndash;406.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(d_nascar)
head(d_nascar)

## Compute the number of races for each of the 87 drivers
table(c(d_nascar[,1:43]))

## Identify drivers arrived last (43th position) in all the races
which(colSums(rank_summaries(d_nascar, format="ordering")$marginals[1:42,])==0)

## Obscure drivers 84, 85, 86 and 87 to get the reduced dataset 
## with 83 racers employed by Hunter, D. R. (2004)
d_nascar_hunter=d_nascar[,1:83]
d_nascar_hunter[is.element(d_nascar_hunter,84:87)]=0
</code></pre>

<hr>
<h2 id='d_occup'>Occupation Data (complete orderings)</h2><span id='topic+d_occup'></span>

<h3>Description</h3>

<p>The Occupation dataset (<code>d_occup</code>) came up from a survey conducted on graduates from the Technion-Insrael Institute of Tecnology.
A sample of <code class="reqn">N=143</code> graduates were asked to rank <code class="reqn">K=10</code> professions according to the perceived prestige. The occupations are labeled as:
1 = faculty member, 2 = owner of a business, 3 = applied scientist, 4 = operations researcher, 5 = industrial engineer, 6 = manager, 7 = mechanical engineer, 8 = supervisor, 9 = technician and 10 = foreman. The dataset is composed of complete orderings.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(d_occup)</code></pre>


<h3>Format</h3>

<p>Object of S3 class <code>c("top_ordering","matrix")</code> gathering a matrix of complete orderings with <code class="reqn">N=143</code> rows and <code class="reqn">K=10</code> columns. Each row lists the professions from the most-liked (<code>Rank_1</code>) to the least-liked (<code>Rank_10</code>) for a given graduate.
</p>


<h3>References</h3>

<p>Cohen, A. and Mallows, C. L. (1983). Assessing goodness of fit of ranking models to data. <em>Journal of the Royal Statistical Society: Series D (The Statistician)</em>, <b>32</b>(4), pages 361&ndash;374, ISSN: 0039-0526.
</p>
<p>Cohen, A. (1982). Analysis of large sets of ranking data. <em>Communications in Statistics &ndash; Theory and Methods</em>, <b>11</b>(3), pages 235&ndash;256.
</p>
<p>Goldberg, A. I. (1976). The relevance of cosmopolitan/local orientations to professional values and behavior. <em>Sociology of Work and Occupations</em>, <b>3</b>(3), pages 331&ndash;356.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(d_occup)
head(d_occup)
</code></pre>

<hr>
<h2 id='d_rice'>Rice Voting Data (partial orderings)</h2><span id='topic+d_rice'></span>

<h3>Description</h3>

<p>The Rice Voting dataset (<code>d_rice</code>) collects the results of the 1992 election of a faculty member to serve on the Presidential Search Committee in the Rice University.
A total of <code class="reqn">N=300</code> people casted their vote in the ballots by ranking the <code class="reqn">K=5</code> candidates in the short list in a preferential manner. The dataset is composed of partial top orderings of varying lengths. Missing positions are denoted with zero entries.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(d_rice)</code></pre>


<h3>Format</h3>

<p>Object of S3 class <code>c("top_ordering","matrix")</code> gathering a matrix of partial orderings with <code class="reqn">N=300</code> rows and <code class="reqn">K=5</code> columns. Each row lists the faculty members from the most-liked (<code>Rank_1</code>) to the least-liked (<code>Rank_5</code>) in a given voting ballot. 
</p>


<h3>References</h3>

<p>Marcus, P., Heiser, W. J. and  D'Ambrosio, A. (2013). Comparison of heterogeneous probability models for ranking data, Master Thesis, Leiden University.
</p>
<p>Baggerly, K. A. (1995). Visual estimation of structure in ranked data, PhD thesis, Rice University.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(d_rice)
head(d_rice)

## Subset of complete sequences
d_rice_compl=d_rice[rowSums(d_rice!=0)&gt;=(ncol(d_rice)-1),]
head(d_rice_compl)

</code></pre>

<hr>
<h2 id='freq_to_unit'>Individual rankings/orderings from the frequency distribution</h2><span id='topic+freq_to_unit'></span>

<h3>Description</h3>

<p>Construct the dataset of individual rankings/orderings from the frequency distribution of the distinct observed sequences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>freq_to_unit(freq_distr)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="freq_to_unit_+3A_freq_distr">freq_distr</code></td>
<td>
<p>Numeric matrix of the distinct observed sequences with the corresponding frequencies indicated in the last <code class="reqn">(K+1)</code>-th column.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of observed individual sequences.
</p>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(gtools)
K &lt;- 4
perm_matrix &lt;- permutations(n=K, r=K)
freq_data &lt;- cbind(perm_matrix, sample(1:factorial(K)))
freq_data
freq_to_unit(freq_distr=freq_data)

</code></pre>

<hr>
<h2 id='gibbsPLMIX'>Gibbs sampling for a Bayesian mixture of Plackett-Luce models</h2><span id='topic+gibbsPLMIX'></span>

<h3>Description</h3>

<p>Perform Gibbs sampling simulation for a Bayesian mixture of Plackett-Luce models fitted to partial orderings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gibbsPLMIX(pi_inv, K, G, init = list(z = NULL, p = NULL),
  n_iter = 1000, n_burn = 500, hyper = list(shape0 = matrix(1, nrow =
  G, ncol = K), rate0 = rep(0.001, G), alpha0 = rep(1, G)),
  centered_start = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gibbsPLMIX_+3A_pi_inv">pi_inv</code></td>
<td>
<p>An object of class <code>top_ordering</code>, collecting the numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of partial orderings, or an object that can be coerced with <code><a href="#topic+as.top_ordering">as.top_ordering</a></code>.</p>
</td></tr>
<tr><td><code id="gibbsPLMIX_+3A_k">K</code></td>
<td>
<p>Number of possible items.</p>
</td></tr>
<tr><td><code id="gibbsPLMIX_+3A_g">G</code></td>
<td>
<p>Number of mixture components.</p>
</td></tr>
<tr><td><code id="gibbsPLMIX_+3A_init">init</code></td>
<td>
<p>List of named objects with initialization values: <code>z</code> is a numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">G</code> matrix of binary mixture component memberships; <code>p</code> is a numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix of component-specific support parameters. If starting values are not supplied (<code>NULL</code>), they are randomly generated with a uniform distribution. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gibbsPLMIX_+3A_n_iter">n_iter</code></td>
<td>
<p>Total number of MCMC iterations.</p>
</td></tr>
<tr><td><code id="gibbsPLMIX_+3A_n_burn">n_burn</code></td>
<td>
<p>Number of initial burn-in drawings removed from the returned MCMC sample.</p>
</td></tr>
<tr><td><code id="gibbsPLMIX_+3A_hyper">hyper</code></td>
<td>
<p>List of named objects with hyperparameter values for the conjugate prior specification: <code>shape0</code> is a numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix of shape hyperparameters; <code>rate0</code> is a numeric vector of <code class="reqn">G</code> rate hyperparameters; <code>alpha0</code> is a numeric vector of <code class="reqn">G</code> Dirichlet hyperparameters. Default is vague prior setting.</p>
</td></tr>
<tr><td><code id="gibbsPLMIX_+3A_centered_start">centered_start</code></td>
<td>
<p>Logical: whether a random start whose support parameters and weights should be centered around the observed relative frequency that each item has been ranked top. Default is <code>FALSE</code>. Ignored when <code>init</code> is not <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The size <code class="reqn">L</code> of the final MCMC sample is equal to <code>n_iter</code>-<code>n_burn</code>.
</p>


<h3>Value</h3>

<p>A list of S3 class <code>gsPLMIX</code> with named elements:
</p>
<table role = "presentation">
<tr><td><code>W</code></td>
<td>
<p> Numeric <code class="reqn">L</code><code class="reqn">\times</code><code class="reqn">G</code> matrix with MCMC samples of the mixture weights.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p> Numeric <code class="reqn">L</code><code class="reqn">\times</code><code class="reqn">(G*K)</code> matrix with MCMC samples of the component-specific support parameters.</p>
</td></tr>
<tr><td><code>log_lik</code></td>
<td>
<p> Numeric vector of <code class="reqn">L</code> posterior log-likelihood values.</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p> Numeric vector of <code class="reqn">L</code> posterior deviance values (<code class="reqn">-2 * </code><code>log_lik</code>).</p>
</td></tr>
<tr><td><code>objective</code></td>
<td>
<p> Numeric vector of <code class="reqn">L</code> objective function values (that is the kernel of the log-posterior distribution).</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p> The matched call.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>References</h3>

<p>Mollica, C. and Tardella, L. (2017). Bayesian Plackett-Luce mixture models for partially ranked data. <em>Psychometrika</em>, <b>82</b>(2), pages 442&ndash;458, ISSN: 0033-3123, DOI: 10.1007/s11336-016-9530-0.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(d_carconf)
GIBBS &lt;- gibbsPLMIX(pi_inv=d_carconf, K=ncol(d_carconf), G=3, n_iter=30, n_burn=10)
str(GIBBS)
GIBBS$P
GIBBS$W

</code></pre>

<hr>
<h2 id='gsPLMIX_to_mcmc'>MCMC class objects from the Gibbs sampling simulations of a Bayesian mixture of Plackett-Luce models</h2><span id='topic+gsPLMIX_to_mcmc'></span>

<h3>Description</h3>

<p>Coerce the Gibbs sampling simulations for a Bayesian mixture of Plackett-Luce models into an <code>mcmc</code> class object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gsPLMIX_to_mcmc(gsPLMIX_out)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gsPLMIX_to_mcmc_+3A_gsplmix_out">gsPLMIX_out</code></td>
<td>
<p>Object of class <code>gsPLMIX</code> returned by the <code>gibbsPLMIX</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>gsPLMIX_to_mcmc</code> attemps to coerce its argument by recalling the <code>as.mcmc</code> function of the <code>coda</code> package.
</p>


<h3>Value</h3>

<p>An <code>mcmc</code> class object.
</p>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>References</h3>

<p>Plummer, M., Best, N., Cowles, K. and Vines, K. (2006). CODA: Convergence Diagnosis and Output Analysis for MCMC, <em>R News</em>, <b>6</b>, pages 7&ndash;11, ISSN: 1609-3631.
</p>


<h3>See Also</h3>

<p><code><a href="coda.html#topic+as.mcmc">as.mcmc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(d_carconf)
GIBBS &lt;- gibbsPLMIX(pi_inv=d_carconf, K=ncol(d_carconf), G=3, n_iter=30, n_burn=10)

## Coerce the posterior samples into an mcmc class object
gsPLMIX_to_mcmc(GIBBS)

</code></pre>

<hr>
<h2 id='is.top_ordering'>Top-ordering datasets</h2><span id='topic+is.top_ordering'></span>

<h3>Description</h3>

<p>Check the consistency of partial ordering data with a top-ordering dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.top_ordering(data, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.top_ordering_+3A_data">data</code></td>
<td>
<p>An object containing the partial orderings whose consistency with a top-ordering dataset has to be tested. The following classes are admissible for <code>data</code>: numeric <code>matrix</code>, <code>data.frame</code>, <code>RandData</code> from the <code>rankdist</code> package and <code>rankings</code> from the <code>PlackettLuce</code> package.</p>
</td></tr>
<tr><td><code id="is.top_ordering_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods (not used).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>data</code> requires the partial sequences expressed in ordering format. When the value of <code>is.top-ordering</code> is <code>FALSE</code>, the membership function returns also a message with the conditions that are not met for the <code>data</code> to be a top-ordering dataset. <code>NA</code>'s in the input <code>data</code> are tacitly converted into zero entries.
</p>


<h3>Value</h3>

<p>Logical: <code>TRUE</code> if the <code>data</code> argument is consistent with a top-ordering dataset (with a possible warning message if the supplied data need a further treatment with the coercion function <code><a href="#topic+as.top_ordering">as.top_ordering</a></code> before being processed with the core functions of <span class="pkg">PLMIX</span>) and <code>FALSE</code> otherwise.
</p>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>References</h3>

<p>Turner, H., Kormidis, I. and Firth, D. (2018). PlackettLuce: Plackett-Luce Models for Rankings. R package version 0.2-3. <a href="https://CRAN.R-project.org/package=PlackettLuce">https://CRAN.R-project.org/package=PlackettLuce</a>
</p>
<p>Qian, Z. (2018). rankdist: Distance Based Ranking Models. R package version 1.1.3. <a href="https://CRAN.R-project.org/package=rankdist">https://CRAN.R-project.org/package=rankdist</a>
</p>


<h3>See Also</h3>

<p><code><a href="PlackettLuce.html#topic+rankings">rankings</a></code> and <code><a href="PlackettLuce.html#topic+rankings">rankings</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## A toy example of data matrix not satisfying the conditions to be a top-ordering dataset
toy_data=rbind(1:5,
c(0,4,3,2,1),
c(4,3.4,2,1,5),
c(2,3,0,0,NA),
c(4,4,3,2,5),
c(3,5,4,2,6),
c(2,-3,1,4,5),
c(2,0,1,4,5),
c(2,3,1,1,1),
c(2,3,0,4,0))

is.top_ordering(data=toy_data) 

## A dataset from the StatRank package satisfying the conditions to be a top-ordering dataset
library(StatRank) 
data(Data.Election9)
is.top_ordering(data=Data.Election9)

</code></pre>

<hr>
<h2 id='label_switchPLMIX'>Label switching adjustment  of the Gibbs sampling simulations for Bayesian mixtures of Plackett-Luce models</h2><span id='topic+label_switchPLMIX'></span>

<h3>Description</h3>

<p>Remove the label switching phenomenon from the MCMC samples of Bayesian mixtures of Plackett-Luce models with <code class="reqn">G&gt;1</code> components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>label_switchPLMIX(pi_inv, seq_G, MCMCsampleP, MCMCsampleW, MAPestP,
  MAPestW, parallel = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="label_switchPLMIX_+3A_pi_inv">pi_inv</code></td>
<td>
<p>An object of class <code>top_ordering</code>, collecting the numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of partial orderings, or an object that can be coerced with <code><a href="#topic+as.top_ordering">as.top_ordering</a></code>.</p>
</td></tr>
<tr><td><code id="label_switchPLMIX_+3A_seq_g">seq_G</code></td>
<td>
<p>Numeric vector with the number of components of the Plackett-Luce mixtures to be assessed.</p>
</td></tr>
<tr><td><code id="label_switchPLMIX_+3A_mcmcsamplep">MCMCsampleP</code></td>
<td>
<p>List of size <code>length(seq_G)</code>, whose generic element is a numeric <code class="reqn">L</code><code class="reqn">\times</code><code class="reqn">(G*K)</code> matrix with the MCMC samples of the component-specific support parameters to be processed.</p>
</td></tr>
<tr><td><code id="label_switchPLMIX_+3A_mcmcsamplew">MCMCsampleW</code></td>
<td>
<p>List of size <code>length(seq_G)</code>, whose generic element is a numeric <code class="reqn">L</code><code class="reqn">\times</code><code class="reqn">G</code> matrix with the MCMC samples of the mixture weights to be processed.</p>
</td></tr>
<tr><td><code id="label_switchPLMIX_+3A_mapestp">MAPestP</code></td>
<td>
<p>List of size <code>length(seq_G)</code>, whose generic element is a numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix with the MAP estimates of the component-specific support parameters to be used as a pivot in the PRA method (see 'Details').</p>
</td></tr>
<tr><td><code id="label_switchPLMIX_+3A_mapestw">MAPestW</code></td>
<td>
<p>List of size <code>length(seq_G)</code>, whose generic element is a numeric vector with the MAP estimates of the <code class="reqn">G</code> mixture weights to be used as a pivot in the PRA method (see 'Details').</p>
</td></tr>
<tr><td><code id="label_switchPLMIX_+3A_parallel">parallel</code></td>
<td>
<p>Logical: whether parallelization should be used. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>label_switchPLMIX</code> function performs the label switching adjustment of the MCMC samples via the Pivotal Reordering Algorithm (PRA) described in Marin et al (2005), by recalling the <code><a href="label.switching.html#topic+pra">pra</a></code> function from the <code><a href="label.switching.html#topic+label.switching">label.switching</a></code> package.
</p>


<h3>Value</h3>

<p>A list of named objects:
</p>
<table role = "presentation">
<tr><td><code>final_sampleP</code></td>
<td>
<p> List of size <code>length(seq_G)</code>, whose generic element is a numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code><code class="reqn">\times</code><code class="reqn">L</code> array with the MCMC samples of the component-specific support parameters adjusted for label switching.</p>
</td></tr>
<tr><td><code>final_sampleW</code></td>
<td>
<p> List of size <code>length(seq_G)</code>, whose generic element is a numeric <code class="reqn">L</code><code class="reqn">\times</code><code class="reqn">G</code> matrix with the MCMC samples of the mixture weights adjusted for label switching.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>References</h3>

<p>Mollica, C. and Tardella, L. (2017). Bayesian Plackett-Luce mixture models for partially ranked data. <em>Psychometrika</em>, <b>82</b>(2), pages 442&ndash;458, ISSN: 0033-3123, DOI: 10.1007/s11336-016-9530-0.
</p>
<p>Papastamoulis, P. (2016). label.switching: An R Package for Dealing with the Label Switching Problem in MCMC Outputs. <em>Journal of Statistical Software</em>, <b>69</b>(1), pages 1&ndash;24, DOI: 10.18637/jss.v069.c01.
</p>
<p>Marin, J. M., Mengersen, K. and Robert, C.P. (2005). Bayesian modelling and inference on mixtures of distributions. <em>Handbook of Statistics</em> (25), D. Dey and C.R. Rao (eds). Elsevier-Sciences.
</p>


<h3>See Also</h3>

<p><code><a href="label.switching.html#topic+pra">pra</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(d_carconf)
K &lt;- ncol(d_carconf)

## Fit 1- and 2-component PL mixtures via MAP estimation
MAP_1 &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=K, G=1, 
                             n_start=2, n_iter=400*1)

MAP_2 &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=K, G=2, 
                             n_start=2, n_iter=400*2)
                                   
MAP_3 &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=K, G=3, 
                             n_start=2, n_iter=400*3)
                                   
mcmc_iter &lt;- 30
burnin &lt;- 10

## Fit 1- and 2-component PL mixtures via Gibbs sampling procedure
GIBBS_1 &lt;- gibbsPLMIX(pi_inv=d_carconf, K=K, G=1, n_iter=mcmc_iter, 
                      n_burn=burnin, init=list(p=MAP_1$mod$P_map,
                      z=binary_group_ind(MAP_1$mod$class_map,G=1)))
GIBBS_2 &lt;- gibbsPLMIX(pi_inv=d_carconf, K=K, G=2, n_iter=mcmc_iter, 
                      n_burn=burnin, init=list(p=MAP_2$mod$P_map,
                      z=binary_group_ind(MAP_2$mod$class_map,G=2)))
GIBBS_3 &lt;- gibbsPLMIX(pi_inv=d_carconf, K=K, G=3, n_iter=mcmc_iter, 
                      n_burn=burnin, init=list(p=MAP_3$mod$P_map,
                      z=binary_group_ind(MAP_3$mod$class_map,G=3)))
                            
## Adjusting the MCMC samples for label switching
LS &lt;- label_switchPLMIX(pi_inv=d_carconf, seq_G=1:3, 
                   MCMCsampleP=list(GIBBS_1$P, GIBBS_2$P, GIBBS_3$P), 
                   MCMCsampleW=list(GIBBS_1$W, GIBBS_2$W, GIBBS_3$W), 
                   MAPestP=list(MAP_1$mod$P_map, MAP_2$mod$P_map, MAP_3$mod$P_map), 
                   MAPestW=list(MAP_1$mod$W_map, MAP_2$mod$W_map, MAP_3$mod$W_map))
str(LS)       
</code></pre>

<hr>
<h2 id='Loglikelihood'>Likelihood and log-likelihood evaluation for a mixture of Plackett-Luce models</h2><span id='topic+Loglikelihood'></span><span id='topic+likPLMIX'></span><span id='topic+loglikPLMIX'></span><span id='topic+loglikelihood'></span><span id='topic+Likelihood'></span><span id='topic+likelihood'></span>

<h3>Description</h3>

<p>Compute either the likelihood or the log-likelihood of the Plackett-Luce mixture model parameters for a partial ordering dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>likPLMIX(p, ref_order, weights, pi_inv)

loglikPLMIX(p, ref_order, weights, pi_inv)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Loglikelihood_+3A_p">p</code></td>
<td>
<p>Numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix of component-specific support parameters.</p>
</td></tr>
<tr><td><code id="Loglikelihood_+3A_ref_order">ref_order</code></td>
<td>
<p>Numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix of component-specific reference orders.</p>
</td></tr>
<tr><td><code id="Loglikelihood_+3A_weights">weights</code></td>
<td>
<p>Numeric vector of <code class="reqn">G</code> mixture weights.</p>
</td></tr>
<tr><td><code id="Loglikelihood_+3A_pi_inv">pi_inv</code></td>
<td>
<p>An object of class <code>top_ordering</code>, collecting the numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of partial orderings, or an object that can be coerced with <code><a href="#topic+as.top_ordering">as.top_ordering</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>ref_order</code> argument accommodates for the more general mixture of Extended Plackett-Luce models (EPL), involving the additional reference order parameters (Mollica and Tardella 2014). A permutation of the first <code class="reqn">K</code> integers can be specified in each row of the <code>ref_order</code> argument. Since the Plackett-Luce model is a special instance of the EPL with the reference order equal to the identity permutation, the <code>ref_order</code> argument must be a matrix with <code class="reqn">G</code> rows equal to <code class="reqn">(1,\dots,K)</code> when dealing with Plackett-Luce mixtures.
</p>


<h3>Value</h3>

<p>Either the likelihood or the log-likelihood value of the Plackett-Luce mixture model parameters for a partial ordering dataset.
</p>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>References</h3>

<p>Mollica, C. and Tardella, L. (2017). Bayesian Plackett-Luce mixture models for partially ranked data. <em>Psychometrika</em>, <b>82</b>(2), pages 442&ndash;458, ISSN: 0033-3123, DOI: 10.1007/s11336-016-9530-0.
</p>
<p>Mollica, C. and Tardella, L. (2014). Epitope profiling via mixture modeling for ranked data. <em>Statistics in Medicine</em>, <b>33</b>(21), pages 3738&ndash;3758, ISSN: 0277-6715, DOI: 10.1002/sim.6224.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(d_apa)
K &lt;- ncol(d_apa)
G &lt;- 3
support_par &lt;- matrix(1:(G*K), nrow=G, ncol=K)
weights_par &lt;- c(0.50, 0.25, 0.25)
loglikPLMIX(p=support_par, ref_order=matrix(1:K, nrow=G, ncol=K, byrow=TRUE), 
            weights=weights_par, pi_inv=d_apa)

</code></pre>

<hr>
<h2 id='make_complete'>Completion of partial rankings/orderings</h2><span id='topic+make_complete'></span>

<h3>Description</h3>

<p>Return complete rankings/orderings from partial sequences relying on a random generation of the missing positions/items.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_complete(data, format_input, nranked = NULL, probitems = rep(1,
  ncol(data)))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_complete_+3A_data">data</code></td>
<td>
<p>Numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of partial sequences to be completed.</p>
</td></tr>
<tr><td><code id="make_complete_+3A_format_input">format_input</code></td>
<td>
<p>Character string indicating the format of the <code>data</code> input, namely <code>"ordering"</code> or <code>"ranking"</code>.</p>
</td></tr>
<tr><td><code id="make_complete_+3A_nranked">nranked</code></td>
<td>
<p>Optional numeric vector of length <code class="reqn">N</code> with the number of items ranked by each sample unit.</p>
</td></tr>
<tr><td><code id="make_complete_+3A_probitems">probitems</code></td>
<td>
<p>Numeric vector with the <code class="reqn">K</code> item-specific probabilities to be employed for the random generation of the missing positions/items (see 'Details'). Default is equal probabilities.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The completion of the partial top rankings/orderings is performed according to the Plackett-Luce scheme, that is, with a sampling without replacement of the not-ranked items by using the positive values in the <code>probitems</code> argument as support parameters (normalization is not necessary).
</p>


<h3>Value</h3>

<p>A list of two named objects:
</p>
<table role = "presentation">
<tr><td><code>completedata</code></td>
<td>
<p> Numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of complete sequences with the same format of the input <code>data</code>.</p>
</td></tr>	
<tr><td><code>nranked</code></td>
<td>
<p> Numeric vector of length <code class="reqn">N</code> with the number of items ranked by each sample unit of the input <code>data</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Completion based on the top item frequencies
data(d_dublinwest)
head(d_dublinwest)
top_item_freq &lt;- rank_summaries(data=d_dublinwest, format_input="ordering", mean_rank=FALSE, 
                                pc=FALSE)$marginals["Rank_1",]

d_dublinwest_compl &lt;- make_complete(data=d_dublinwest, format_input="ordering", 
                                    probitems=top_item_freq)
head(d_dublinwest_compl$completedata)

</code></pre>

<hr>
<h2 id='make_partial'>Censoring of complete rankings/orderings</h2><span id='topic+make_partial'></span>

<h3>Description</h3>

<p>Return partial top rankings/orderings from complete sequences obtained either with user-specified censoring patterns or with a random truncation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_partial(data, format_input, nranked = NULL, probcens = rep(1,
  ncol(data) - 1))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_partial_+3A_data">data</code></td>
<td>
<p>Numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of complete sequences to be censored.</p>
</td></tr>
<tr><td><code id="make_partial_+3A_format_input">format_input</code></td>
<td>
<p>Character string indicating the format of the <code>data</code> input, namely <code>"ordering"</code> or <code>"ranking"</code>.</p>
</td></tr>
<tr><td><code id="make_partial_+3A_nranked">nranked</code></td>
<td>
<p>Numeric vector of length <code class="reqn">N</code> with the desired number of items ranked by each sample unit after censoring. If not supplied (<code>NULL</code>), the censoring patterns are randomly generated according to the probabilities in the <code>probcens</code> argument.</p>
</td></tr>
<tr><td><code id="make_partial_+3A_probcens">probcens</code></td>
<td>
<p>Numeric vector of length <code class="reqn">(K-1)</code> with the probability of each censoring pattern to be employed for the random truncation of the complete sequences (normalization is not necessary). It works only if <code>nranked</code> argument is <code>NULL</code> (see 'Details'). Default is equal probabilities.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The censoring of the complete sequences can be performed in: (i) a deterministic way, by specifying the number of top positions to be retained for each sample unit in the <code>nranked</code> argument; (ii) a random way, by sequentially specifying the probabilities of the top-1, top-2, <code class="reqn">...</code>, top-<code class="reqn">(K-1)</code> censoring patterns in the <code>probcens</code> argument. Recall that a top-<code class="reqn">(K-1)</code> sequence corresponds to a complete ordering/ranking.
</p>


<h3>Value</h3>

<p>A list of two named objects:
</p>
<table role = "presentation">
<tr><td><code>partialdata</code></td>
<td>
<p> Numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of partial (censored) sequences with the same format of the input <code>data</code> and missing positions/items denoted with zero entries.</p>
</td></tr>	
<tr><td><code>nranked</code></td>
<td>
<p> Numeric vector of length <code class="reqn">N</code> with the number of items ranked by each sample unit after censoring.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(d_german)
head(d_german)
d_german_cens &lt;- make_partial(data=d_german, format_input="ordering", 
                              probcens=c(0.3, 0.3, 0.4))  
head(d_german_cens$partialdata)

## Check consistency with the nominal censoring probabilities
round(prop.table(table(d_german_cens$nranked)), 2)

</code></pre>

<hr>
<h2 id='mapPLMIX'>MAP estimation for a Bayesian mixture of Plackett-Luce models</h2><span id='topic+mapPLMIX'></span>

<h3>Description</h3>

<p>Perform MAP estimation via EM algorithm for a Bayesian mixture of Plackett-Luce models fitted to partial orderings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mapPLMIX(pi_inv, K, G, init = list(p = NULL, omega = NULL),
  n_iter = 1000, hyper = list(shape0 = matrix(1, nrow = G, ncol = K),
  rate0 = rep(0, G), alpha0 = rep(1, G)), eps = 10^(-6),
  centered_start = FALSE, plot_objective = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mapPLMIX_+3A_pi_inv">pi_inv</code></td>
<td>
<p>An object of class <code>top_ordering</code>, collecting the numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of partial orderings, or an object that can be coerced with <code><a href="#topic+as.top_ordering">as.top_ordering</a></code>.</p>
</td></tr>
<tr><td><code id="mapPLMIX_+3A_k">K</code></td>
<td>
<p>Number of possible items.</p>
</td></tr>
<tr><td><code id="mapPLMIX_+3A_g">G</code></td>
<td>
<p>Number of mixture components.</p>
</td></tr>
<tr><td><code id="mapPLMIX_+3A_init">init</code></td>
<td>
<p>List of named objects with initialization values: <code>p</code> is a numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix of component-specific support parameters; <code>omega</code> is a numeric vector of <code class="reqn">G</code> mixture weights. If starting values are not supplied (<code>NULL</code>), they are randomly generated with a uniform distribution. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="mapPLMIX_+3A_n_iter">n_iter</code></td>
<td>
<p>Maximum number of EM iterations.</p>
</td></tr>
<tr><td><code id="mapPLMIX_+3A_hyper">hyper</code></td>
<td>
<p>List of named objects with hyperparameter values for the conjugate prior specification: <code>shape0</code> is a numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix of shape hyperparameters; <code>rate0</code> is a numeric vector of <code class="reqn">G</code> rate hyperparameters; <code>alpha0</code> is a numeric vector of <code class="reqn">G</code> Dirichlet hyperparameters. Default is noninformative (flat) prior setting.</p>
</td></tr>
<tr><td><code id="mapPLMIX_+3A_eps">eps</code></td>
<td>
<p>Tolerance value for the convergence criterion.</p>
</td></tr>
<tr><td><code id="mapPLMIX_+3A_centered_start">centered_start</code></td>
<td>
<p>Logical: whether a random start whose support parameters and weights should be centered around the observed relative frequency that each item has been ranked top. Default is <code>FALSE</code>. Ignored when <code>init</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="mapPLMIX_+3A_plot_objective">plot_objective</code></td>
<td>
<p>Logical: whether the objective function (that is the kernel of the log-posterior distribution) should be plotted. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Under noninformative (flat) prior setting, the EM algorithm for MAP estimation corresponds to the EMM algorithm described by Gormley and Murphy (2006) to perform frequentist inference. In this case, the MAP solution coincides with the MLE and the output vectors <code>log_lik</code> and <code>objective</code> coincide as well.
</p>
<p>The <code><a href="#topic+mapPLMIX">mapPLMIX</a></code> function performs the MAP procedure with a single starting value. To address the issue of local maxima in the posterior distribution, see the <code><a href="#topic+mapPLMIX_multistart">mapPLMIX_multistart</a></code> function.
</p>


<h3>Value</h3>

<p>A list of S3 class <code>mpPLMIX</code> with named elements:
</p>
<table role = "presentation">
<tr><td><code>W_map</code></td>
<td>
<p> Numeric vector with the MAP estimates of the <code class="reqn">G</code> mixture weights.</p>
</td></tr>
<tr><td><code>P_map</code></td>
<td>
<p> Numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix with the MAP estimates of the component-specific support parameters.</p>
</td></tr>
<tr><td><code>z_hat</code></td>
<td>
<p> Numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">G</code> matrix of estimated posterior component membership probabilities.</p>
</td></tr>
<tr><td><code>class_map</code></td>
<td>
<p> Numeric vector of <code class="reqn">N</code> mixture component memberships based on MAP allocation from the <code>z_hat</code> matrix.</p>
</td></tr>
<tr><td><code>log_lik</code></td>
<td>
<p> Numeric vector of the log-likelihood values at each iteration.</p>
</td></tr>
<tr><td><code>objective</code></td>
<td>
<p> Numeric vector of the objective function values (that is the kernel of the log-posterior distribution) at each iteration.</p>
</td></tr>
<tr><td><code>max_objective</code></td>
<td>
<p> Maximized objective function value.</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p> BIC value (only for the default flat priors, otherwise <code>NULL</code>).</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p> Binary convergence indicator: 1 = convergence has been achieved, 0 = otherwise.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p> The matched call.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>References</h3>

<p>Mollica, C. and Tardella, L. (2017). Bayesian Plackett-Luce mixture models for partially ranked data. <em>Psychometrika</em>, <b>82</b>(2), pages 442&ndash;458, ISSN: 0033-3123, DOI: 10.1007/s11336-016-9530-0.
</p>
<p>Gormley, I. C. and Murphy, T. B. (2006). Analysis of Irish third-level college applications data. <em>Journal of the Royal Statistical Society: Series A</em>, <b>169</b>(2), pages 361&ndash;379, ISSN: 0964-1998, DOI: 10.1111/j.1467-985X.2006.00412.x.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mapPLMIX_multistart">mapPLMIX_multistart</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(d_carconf)
MAP &lt;- mapPLMIX(pi_inv=d_carconf, K=ncol(d_carconf), G=3, n_iter=400*3)
str(MAP)
MAP$P_map
MAP$W_map

</code></pre>

<hr>
<h2 id='mapPLMIX_multistart'>MAP estimation for a Bayesian mixture of Plackett-Luce models with multiple starting values</h2><span id='topic+mapPLMIX_multistart'></span>

<h3>Description</h3>

<p>Perform MAP estimation via EM algorithm with multiple starting values for a Bayesian mixture of Plackett-Luce models fitted to partial orderings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mapPLMIX_multistart(pi_inv, K, G, n_start = 1, init = rep(list(list(p =
  NULL, omega = NULL)), times = n_start), n_iter = 200,
  hyper = list(shape0 = matrix(1, nrow = G, ncol = K), rate0 = rep(0, G),
  alpha0 = rep(1, G)), eps = 10^(-6), plot_objective = FALSE,
  init_index = 1:n_start, parallel = FALSE, centered_start = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mapPLMIX_multistart_+3A_pi_inv">pi_inv</code></td>
<td>
<p>An object of class <code>top_ordering</code>, collecting the numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of partial orderings, or an object that can be coerced with <code><a href="#topic+as.top_ordering">as.top_ordering</a></code>.</p>
</td></tr>
<tr><td><code id="mapPLMIX_multistart_+3A_k">K</code></td>
<td>
<p>Number of possible items.</p>
</td></tr>
<tr><td><code id="mapPLMIX_multistart_+3A_g">G</code></td>
<td>
<p>Number of mixture components.</p>
</td></tr>
<tr><td><code id="mapPLMIX_multistart_+3A_n_start">n_start</code></td>
<td>
<p>Number of starting values.</p>
</td></tr>
<tr><td><code id="mapPLMIX_multistart_+3A_init">init</code></td>
<td>
<p>List of <code>n_start</code> lists of named objects with initialization values: <code>p</code> is a numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix of component-specific support parameters; <code>omega</code> is a numeric vector of <code class="reqn">G</code> mixture weights. If starting values are not supplied (<code>NULL</code>), they are randomly generated with a uniform distribution. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="mapPLMIX_multistart_+3A_n_iter">n_iter</code></td>
<td>
<p>Maximum number of EM iterations.</p>
</td></tr>
<tr><td><code id="mapPLMIX_multistart_+3A_hyper">hyper</code></td>
<td>
<p>List of named objects with hyperparameter values for the conjugate prior specification: <code>shape0</code> is a numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix of shape hyperparameters; <code>rate0</code> is a numeric vector of <code class="reqn">G</code> rate hyperparameters; <code>alpha0</code> is a numeric vector of <code class="reqn">G</code> Dirichlet hyperparameters. Default is noninformative (flat) prior setting.</p>
</td></tr>
<tr><td><code id="mapPLMIX_multistart_+3A_eps">eps</code></td>
<td>
<p>Tolerance value for the convergence criterion.</p>
</td></tr>
<tr><td><code id="mapPLMIX_multistart_+3A_plot_objective">plot_objective</code></td>
<td>
<p>Logical: whether the objective function (that is the kernel of the log-posterior distribution) should be plotted. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="mapPLMIX_multistart_+3A_init_index">init_index</code></td>
<td>
<p>Numeric vector indicating the positions of the starting values in the <code>init</code> list to be actually launched. Useful to launch the most promising starting values identified after a preliminary run. Default is run all the starting points in the <code>init</code> list.</p>
</td></tr>
<tr><td><code id="mapPLMIX_multistart_+3A_parallel">parallel</code></td>
<td>
<p>Logical: whether parallelization should be used. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="mapPLMIX_multistart_+3A_centered_start">centered_start</code></td>
<td>
<p>Logical: whether a random start whose support parameters and weights should be centered around the observed relative frequency that each item has been ranked top. Default is <code>FALSE</code>. Ignored when <code>init</code> is not <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Under noninformative (flat) prior setting, the EM algorithm for MAP estimation corresponds to the EMM algorithm described by Gormley and Murphy (2006) to perform frequentist inference. In this case the MAP solution coincides with the MLE. The best model in terms of maximized posterior distribution is returned.
</p>


<h3>Value</h3>

<p>A list of S3 class <code>mpPLMIX</code> with named elements:
</p>
<table role = "presentation">
<tr><td><code>mod</code></td>
<td>
<p> List of named objects describing the best model in terms of maximized posterior distribution. See output values of the single-run <code><a href="#topic+mapPLMIX">mapPLMIX</a></code> function for a detailed explanation of the list elements.</p>
</td></tr>
<tr><td><code>max_objective</code></td>
<td>
<p> Numeric vector of the maximized objective function values for each initialization.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p> Binary vector with <code>length(init_index)</code> convergence indicators for each initialization: 1 = convergence has been achieved, 0 = otherwise.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p> The matched call.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>References</h3>

<p>Mollica, C. and Tardella, L. (2017). Bayesian Plackett-Luce mixture models for partially ranked data. <em>Psychometrika</em>, <b>82</b>(2), pages 442&ndash;458, ISSN: 0033-3123, DOI: 10.1007/s11336-016-9530-0.
</p>
<p>Gormley, I. C. and Murphy, T. B. (2006). Analysis of Irish third-level college applications data. <em>Journal of the Royal Statistical Society: Series A</em>, <b>169</b>(2), pages 361&ndash;379, ISSN: 0964-1998, DOI: 10.1111/j.1467-985X.2006.00412.x.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mapPLMIX">mapPLMIX</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(d_carconf)
MAP_mult &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=ncol(d_carconf), G=3, 
                                            n_start=2, n_iter=400*3)
str(MAP_mult)
MAP_mult$mod$P_map
MAP_mult$mod$W_map

</code></pre>

<hr>
<h2 id='paired_comparisons'>Paired comparison matrix for a partial ordering/ranking dataset</h2><span id='topic+paired_comparisons'></span>

<h3>Description</h3>

<p>Construct the paired comparison matrix for a partial ordering/ranking dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paired_comparisons(data, format_input, nranked = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="paired_comparisons_+3A_data">data</code></td>
<td>
<p>Numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of partial sequences.</p>
</td></tr>
<tr><td><code id="paired_comparisons_+3A_format_input">format_input</code></td>
<td>
<p>Character string indicating the format of the <code>data</code> input, namely <code>"ordering"</code> or <code>"ranking"</code>.</p>
</td></tr>
<tr><td><code id="paired_comparisons_+3A_nranked">nranked</code></td>
<td>
<p>Optional numeric vector of length <code class="reqn">N</code> with the number of items ranked by each sample unit.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric <code class="reqn">K</code><code class="reqn">\times</code><code class="reqn">K</code> paired comparison matrix: the <code class="reqn">(i,i')</code>-th entry indicates the number of sample units that preferred item <code class="reqn">i</code> to item <code class="reqn">i'</code>.
</p>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>References</h3>

<p>Mollica, C. and Tardella, L. (2017). Bayesian Plackett-Luce mixture models for partially ranked data. <em>Psychometrika</em>, <b>82</b>(2), pages 442&ndash;458, ISSN: 0033-3123, DOI: 10.1007/s11336-016-9530-0.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rank_summaries">rank_summaries</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(d_dublinwest)
paired_comparisons(data=d_dublinwest, format_input="ordering")
</code></pre>

<hr>
<h2 id='plot.gsPLMIX'>Plot the Gibbs sampling simulations for a Bayesian mixture of Plackett-Luce models</h2><span id='topic+plot.gsPLMIX'></span>

<h3>Description</h3>

<p><code>plot</code> method for class <code>gsPLMIX</code>. It builds a suite of plots, visual convergence diagnostics and credible intervals for the MCMC samples of a Bayesian mixture of Plackett-Luce models. Graphics can be plotted directly into the current working device or stored into an external file placed into the current working directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gsPLMIX'
plot(x, file = "ggmcmc-output.pdf", family = NA,
  plot = NULL, param_page = 5, width = 7, height = 10,
  dev_type_html = "png", post_est = "mean", max_scale_radar = NULL,
  ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.gsPLMIX_+3A_x">x</code></td>
<td>
<p>Object of class <code>gsPLMIX</code> returned by the <code>gibbsPLMIX</code> function.</p>
</td></tr>
<tr><td><code id="plot.gsPLMIX_+3A_file">file</code></td>
<td>
<p>Character vector with the name of the file to be created in the current working directory. Defaults is &quot;ggmcmc-output.pdf&quot;. When NULL, plots are directly returned into the current working device (not recommended). This option allows also the user to work with an opened pdf (or other) device. When the file has an html file extension, the output is an Rmarkdown report with the figures embedded in the html file.</p>
</td></tr>
<tr><td><code id="plot.gsPLMIX_+3A_family">family</code></td>
<td>
<p>Character string indicating the name of the family of parameters to be plotted. A family of parameters is considered to be any group of parameters with the same name but different numerical values (for example <code>w[1]</code>, <code>w[2]</code>, etc). Default is <code>NA</code> meaning that all the parameters in the chain are plotted. Alternatively, one can choose <code>"w"</code>, <code>"p"</code>, <code>"log_lik"</code>, <code>"deviance"</code> or <code>"objective"</code>.</p>
</td></tr>
<tr><td><code id="plot.gsPLMIX_+3A_plot">plot</code></td>
<td>
<p>Character vector containing the names of the desired plots. Default is <code>NULL</code> meaning that all the plots and convergence diagnostics are built (see 'Details').</p>
</td></tr>
<tr><td><code id="plot.gsPLMIX_+3A_param_page">param_page</code></td>
<td>
<p>Number of parameters to be plotted in each page. Defaults is 5.</p>
</td></tr>
<tr><td><code id="plot.gsPLMIX_+3A_width">width</code></td>
<td>
<p>Numeric scalar indicating the width of the pdf display in inches. Defaults is 7.</p>
</td></tr>
<tr><td><code id="plot.gsPLMIX_+3A_height">height</code></td>
<td>
<p>Numeric scalar indicating the height of the pdf display in inches. Defaults is 10.</p>
</td></tr>
<tr><td><code id="plot.gsPLMIX_+3A_dev_type_html">dev_type_html</code></td>
<td>
<p>Character vector indicating the type of graphical device for the html output. Default is <code>"png"</code>. Alternatively, one can choose <code>"svg"</code>.</p>
</td></tr>
<tr><td><code id="plot.gsPLMIX_+3A_post_est">post_est</code></td>
<td>
<p>Character string indicating the point estimates of the Plackett-Luce mixture parameters to be computed from the <code>gsPLMIX</code> class object and then plotted in the current working device. Default is <code>"mean"</code>. Alternatively, one can choose <code>"median"</code>.</p>
</td></tr>
<tr><td><code id="plot.gsPLMIX_+3A_max_scale_radar">max_scale_radar</code></td>
<td>
<p>Numeric scalar indicating the maximum value on each axis of the radar plot for the support parameter point estimates. Default is <code>NULL</code> meaning that the maximum of the estimated support parameters is used.</p>
</td></tr>
<tr><td><code id="plot.gsPLMIX_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods (not used).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plots of the MCMC samples include histograms, densities, traceplots, running means plots, overlapped densities comparing the complete and partial samples, autocorrelation functions, crosscorrelation plots and caterpillar plots of the 90 and 95% equal-tails credible intervals. Note that the latter are created for the support parameters (when either <code>family=NA</code> or <code>family="p"</code>), for the mixture weights in the case <code class="reqn">G&gt;1</code> (when either <code>family=NA</code> or <code>family="w"</code>), for the log-likelihood values (when <code>family="log_lik"</code>), for the deviance values (when <code>family="deviance"</code>). Convergence tools include the potential scale reduction factor and the Geweke z-score. These functionalities are implemented with a call to the <code>ggs</code> and <code>ggmcmc</code> functions of the <code>ggmcmc</code> package (see 'Examples' for the specification of the <code>plot</code> argument) and for the objective function values (when <code>family="objective"</code>).
</p>
<p>By recalling the <code>chartJSRadar</code> function from the <code>radarchart</code> package and the routines of the <code>ggplot2</code> package, <code>plot.gsPLMIX</code> additionally produces a radar plot of the support parameters and, when <code class="reqn">G&gt;1</code>, a donut plot of the mixture weights based on the posterior point estimates. The radar chart is returned in the Viewer Pane.
</p>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>References</h3>

<p>Ashton, D. and Porter, S. (2016). radarchart: Radar Chart from 'Chart.js'. R package version 0.3.1. <a href="https://CRAN.R-project.org/package=radarchart">https://CRAN.R-project.org/package=radarchart</a>
</p>
<p>Wickham, H. (2009). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York.
</p>
<p>Fernandez-i-Marin, X. (2006). ggmcmc: Analysis of MCMC Samples and Bayesian Inference, <em>Journal of Statistical Software</em>, <b>70</b>(9), pages 1&ndash;20, DOI: 10.18637/jss.v070.i09.
</p>


<h3>See Also</h3>

<p><code><a href="ggmcmc.html#topic+ggs">ggs</a></code>, <code><a href="ggmcmc.html#topic+ggmcmc">ggmcmc</a></code>, <code><a href="radarchart.html#topic+chartJSRadar">chartJSRadar</a></code> and <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Not run:
data(d_carconf)
GIBBS &lt;- gibbsPLMIX(pi_inv=d_carconf, K=ncol(d_carconf), G=5, n_iter=30, n_burn=10)

# Not run:
# Plot posterior samples supplied as an gsPLMIX class object
# plot(GIBBS)

# Selected plots of the posterior samples of the support parameters
# plot(GIBBS, family="p", plot=c("compare_partial","Rhat","caterpillar"), param_page=6)

# Selected plots of the posterior samples of the mixture weights
# plot(GIBBS, family="w", plot=c("histogram","running","crosscorrelation","caterpillar"))

# Selected plots of the posterior log-likelihood values
# plot(GIBBS, family="log_lik", plot=c("autocorrelation","geweke"), param_page=1)

# Selected plots of the posterior deviance values
# plot(GIBBS, family="deviance", plot=c("traceplot","density"), param_page=1)
</code></pre>

<hr>
<h2 id='plot.mpPLMIX'>Plot the MAP estimates for a Bayesian mixture of Plackett-Luce models</h2><span id='topic+plot.mpPLMIX'></span>

<h3>Description</h3>

<p><code>plot</code> method for class <code>mpPLMIX</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mpPLMIX'
plot(x, max_scale_radar = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.mpPLMIX_+3A_x">x</code></td>
<td>
<p>Object of class <code>mpPLMIX</code> returned by the <code>mpPLMIX</code> function.</p>
</td></tr>
<tr><td><code id="plot.mpPLMIX_+3A_max_scale_radar">max_scale_radar</code></td>
<td>
<p>Numeric scalar indicating the maximum value on each axis of the radar plot for the support parameter point estimates. Default is <code>NULL</code> meaning that the maximum of the estimated support parameters is used.</p>
</td></tr>
<tr><td><code id="plot.mpPLMIX_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods (not used).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By recalling the <code>chartJSRadar</code> function from the <code>radarchart</code> package and the routines of the <code>ggplot2</code> package, <code>plot.mpPLMIX</code> produces a radar plot of the support parameters and, when <code class="reqn">G&gt;1</code>, a donut plot of the mixture weights and a heatmap of the component membership probabilities based on the MAP estimates.  The radar chart is returned in the Viewer Pane.
</p>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>References</h3>

<p>Ashton, D. and Porter, S. (2016). radarchart: Radar Chart from 'Chart.js'. R package version 0.3.1. <a href="https://CRAN.R-project.org/package=radarchart">https://CRAN.R-project.org/package=radarchart</a>
</p>
<p>Wickham, H. (2009). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York.
</p>


<h3>See Also</h3>

<p><code><a href="radarchart.html#topic+chartJSRadar">chartJSRadar</a></code> and <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Not run:
data(d_carconf)
MAP &lt;- mapPLMIX(pi_inv=d_carconf, K=ncol(d_carconf), G=3)
plot(MAP)

# Not run:
MAP_multi &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=ncol(d_carconf), G=3, n_start=5)
plot(MAP_multi)
</code></pre>

<hr>
<h2 id='ppcheckPLMIX'>Posterior predictive check for Bayesian mixtures of Plackett-Luce models</h2><span id='topic+ppcheckPLMIX'></span>

<h3>Description</h3>

<p>Perform posterior predictive check to assess the goodness-of-fit of Bayesian mixtures of Plackett-Luce models with a different number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppcheckPLMIX(pi_inv, seq_G, MCMCsampleP, MCMCsampleW, top1 = TRUE,
  paired = TRUE, parallel = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ppcheckPLMIX_+3A_pi_inv">pi_inv</code></td>
<td>
<p>An object of class <code>top_ordering</code>, collecting the numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of partial orderings, or an object that can be coerced with <code><a href="#topic+as.top_ordering">as.top_ordering</a></code>.</p>
</td></tr>
<tr><td><code id="ppcheckPLMIX_+3A_seq_g">seq_G</code></td>
<td>
<p>Numeric vector with the number of components of the Plackett-Luce mixtures to be assessed.</p>
</td></tr>
<tr><td><code id="ppcheckPLMIX_+3A_mcmcsamplep">MCMCsampleP</code></td>
<td>
<p>List of size <code>length(seq_G)</code>, whose generic element is a numeric <code class="reqn">L</code><code class="reqn">\times</code><code class="reqn">(G*K)</code> matrix with the MCMC samples of the component-specific support parameters.</p>
</td></tr>
<tr><td><code id="ppcheckPLMIX_+3A_mcmcsamplew">MCMCsampleW</code></td>
<td>
<p>List of size <code>length(seq_G)</code>, whose generic element is a numeric <code class="reqn">L</code><code class="reqn">\times</code><code class="reqn">G</code> matrix with the MCMC samples of the mixture weights.</p>
</td></tr>
<tr><td><code id="ppcheckPLMIX_+3A_top1">top1</code></td>
<td>
<p>Logical: whether the posterior predictive <code class="reqn">p</code>-value based on the top item frequencies has to be computed. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ppcheckPLMIX_+3A_paired">paired</code></td>
<td>
<p>Logical: whether the posterior predictive <code class="reqn">p</code>-value based on the paired comparison frequencies has to be computed. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ppcheckPLMIX_+3A_parallel">parallel</code></td>
<td>
<p>Logical: whether parallelization should be used. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>ppcheckPLMIX</code> function returns two posterior predictive <code class="reqn">p</code>-values based on two chi squared discrepancy variables involving: (i) the top item frequencies and (ii) the paired comparison frequencies. In the presence of partial sequences in the <code>pi_inv</code> matrix, the same missingness patterns observed in the dataset (i.e., the number of items ranked by each sample unit) are reproduced on the replicated datasets from the posterior predictive distribution.
</p>


<h3>Value</h3>

<p>A list with a named element:
</p>
<table role = "presentation">
<tr><td><code>post_pred_pvalue</code></td>
<td>
<p> Numeric <code>length(seq_G)</code><code class="reqn">\times</code><code class="reqn">2</code> matrix of posterior predictive <code class="reqn">p</code>-values based on the top item and paired comparison frequencies. If either <code>top1</code> or <code>paired</code> argument is <code>FALSE</code>, the corresponding matrix entries are <code>NA</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>References</h3>

<p>Mollica, C. and Tardella, L. (2017). Bayesian Plackett-Luce mixture models for partially ranked data. <em>Psychometrika</em>, <b>82</b>(2), pages 442&ndash;458, ISSN: 0033-3123, DOI: 10.1007/s11336-016-9530-0.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ppcheckPLMIX_cond">ppcheckPLMIX_cond</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(d_carconf)
K &lt;- ncol(d_carconf)

## Fit 1- and 2-component PL mixtures via MAP estimation
MAP_1 &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=K, G=1, 
                             n_start=2, n_iter=400*1)

MAP_2 &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=K, G=2, 
                             n_start=2, n_iter=400*2)
                                   
MAP_3 &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=K, G=3, 
                             n_start=2, n_iter=400*3)
                                   
mcmc_iter &lt;- 30
burnin &lt;- 10

## Fit 1- and 2-component PL mixtures via Gibbs sampling procedure
GIBBS_1 &lt;- gibbsPLMIX(pi_inv=d_carconf, K=K, G=1, n_iter=mcmc_iter, 
                      n_burn=burnin, init=list(p=MAP_1$mod$P_map,
                      z=binary_group_ind(MAP_1$mod$class_map,G=1)))
GIBBS_2 &lt;- gibbsPLMIX(pi_inv=d_carconf, K=K, G=2, n_iter=mcmc_iter, 
                      n_burn=burnin, init=list(p=MAP_2$mod$P_map,
                      z=binary_group_ind(MAP_2$mod$class_map,G=2)))
GIBBS_3 &lt;- gibbsPLMIX(pi_inv=d_carconf, K=K, G=3, n_iter=mcmc_iter, 
                      n_burn=burnin, init=list(p=MAP_3$mod$P_map,
                      z=binary_group_ind(MAP_3$mod$class_map,G=3)))
                            
## Checking goodness-of-fit of the estimated mixtures
CHECK &lt;- ppcheckPLMIX(pi_inv=d_carconf, seq_G=1:3, 
                      MCMCsampleP=list(GIBBS_1$P, GIBBS_2$P, GIBBS_3$P), 
                      MCMCsampleW=list(GIBBS_1$W, GIBBS_2$W, GIBBS_3$W))
CHECK$post_pred_pvalue

</code></pre>

<hr>
<h2 id='ppcheckPLMIX_cond'>Conditional posterior predictive check for Bayesian mixtures of Plackett-Luce models</h2><span id='topic+ppcheckPLMIX_cond'></span>

<h3>Description</h3>

<p>Perform conditional posterior predictive check to assess the goodness-of-fit of Bayesian mixtures of Plackett-Luce models with a different number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppcheckPLMIX_cond(pi_inv, seq_G, MCMCsampleP, MCMCsampleW, top1 = TRUE,
  paired = TRUE, parallel = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ppcheckPLMIX_cond_+3A_pi_inv">pi_inv</code></td>
<td>
<p>An object of class <code>top_ordering</code>, collecting the numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of partial orderings, or an object that can be coerced with <code><a href="#topic+as.top_ordering">as.top_ordering</a></code>.</p>
</td></tr>
<tr><td><code id="ppcheckPLMIX_cond_+3A_seq_g">seq_G</code></td>
<td>
<p>Numeric vector with the number of components of the Plackett-Luce mixtures to be assessed.</p>
</td></tr>
<tr><td><code id="ppcheckPLMIX_cond_+3A_mcmcsamplep">MCMCsampleP</code></td>
<td>
<p>List of size <code>length(seq_G)</code>, whose generic element is a numeric <code class="reqn">L</code><code class="reqn">\times</code><code class="reqn">(G*K)</code> matrix with the MCMC samples of the component-specific support parameters.</p>
</td></tr>
<tr><td><code id="ppcheckPLMIX_cond_+3A_mcmcsamplew">MCMCsampleW</code></td>
<td>
<p>List of size <code>length(seq_G)</code>, whose generic element is a numeric <code class="reqn">L</code><code class="reqn">\times</code><code class="reqn">G</code> matrix with the MCMC samples of the mixture weights.</p>
</td></tr>
<tr><td><code id="ppcheckPLMIX_cond_+3A_top1">top1</code></td>
<td>
<p>Logical: whether the posterior predictive <code class="reqn">p</code>-value based on the top item frequencies has to be computed. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ppcheckPLMIX_cond_+3A_paired">paired</code></td>
<td>
<p>Logical: whether the posterior predictive <code class="reqn">p</code>-value based on the paired comparison frequencies has to be computed. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ppcheckPLMIX_cond_+3A_parallel">parallel</code></td>
<td>
<p>Logical: whether parallelization should be used. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>ppcheckPLMIX_cond</code> function returns two posterior predictive <code class="reqn">p</code>-values based on two chi squared discrepancy variables involving: (i) the top item frequencies and (ii) the paired comparison frequencies. In the presence of partial sequences in the <code>pi_inv</code> matrix, the same missingness patterns observed in the dataset (i.e., the number of items ranked by each sample unit) are reproduced on the replicated datasets from the posterior predictive distribution. Differently from the <code>ppcheckPLMIX</code> function, the condional discrepancy measures are obtained by summing up the chi squared discrepancies computed on subsamples of observations with the same number of ranked items.
</p>


<h3>Value</h3>

<p>A list with a named element:
</p>
<table role = "presentation">
<tr><td><code>post_pred_pvalue_cond</code></td>
<td>
<p> Numeric <code>length(seq_G)</code><code class="reqn">\times</code><code class="reqn">2</code> matrix of posterior predictive <code class="reqn">p</code>-values based on the top item and paired comparison frequencies. If either <code>top1</code> or <code>paired</code> argument is <code>FALSE</code>, the corresponding matrix entries are <code>NA</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>References</h3>

<p>Mollica, C. and Tardella, L. (2017). Bayesian Plackett-Luce mixture models for partially ranked data. <em>Psychometrika</em>, <b>82</b>(2), pages 442&ndash;458, ISSN: 0033-3123, DOI: 10.1007/s11336-016-9530-0.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ppcheckPLMIX">ppcheckPLMIX</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(d_carconf)
K &lt;- ncol(d_carconf)

## Fit 1- and 2-component PL mixtures via MAP estimation
MAP_1 &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=K, G=1, 
                             n_start=2, n_iter=400*1)

MAP_2 &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=K, G=2, 
                             n_start=2, n_iter=400*2)
                                   
MAP_3 &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=K, G=3, 
                             n_start=2, n_iter=400*3)
                                   
mcmc_iter &lt;- 30
burnin &lt;- 10

## Fit 1- and 2-component PL mixtures via Gibbs sampling procedure
GIBBS_1 &lt;- gibbsPLMIX(pi_inv=d_carconf, K=K, G=1, n_iter=mcmc_iter, 
                      n_burn=burnin, init=list(p=MAP_1$mod$P_map,
                      z=binary_group_ind(MAP_1$mod$class_map,G=1)))
GIBBS_2 &lt;- gibbsPLMIX(pi_inv=d_carconf, K=K, G=2, n_iter=mcmc_iter, 
                      n_burn=burnin, init=list(p=MAP_2$mod$P_map,
                      z=binary_group_ind(MAP_2$mod$class_map,G=2)))
GIBBS_3 &lt;- gibbsPLMIX(pi_inv=d_carconf, K=K, G=3, n_iter=mcmc_iter, 
                      n_burn=burnin, init=list(p=MAP_3$mod$P_map,
                      z=binary_group_ind(MAP_3$mod$class_map,G=3)))
                            
## Checking goodness-of-fit of the estimated mixtures
CHECKCOND &lt;- ppcheckPLMIX_cond(pi_inv=d_carconf, seq_G=1:3, 
                               MCMCsampleP=list(GIBBS_1$P, GIBBS_2$P, GIBBS_3$P), 
                               MCMCsampleW=list(GIBBS_1$W, GIBBS_2$W, GIBBS_3$W))
CHECKCOND$post_pred_pvalue

</code></pre>

<hr>
<h2 id='print.gsPLMIX'>Print of the Gibbs sampling simulation of a Bayesian mixture of Plackett-Luce models</h2><span id='topic+print.gsPLMIX'></span>

<h3>Description</h3>

<p><code>print</code> method for class <code>gsPLMIX</code>. It shows some general information on the Gibbs sampling simulation for a Bayesian mixture of Plackett-Luce models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gsPLMIX'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.gsPLMIX_+3A_x">x</code></td>
<td>
<p>Object of class <code>gsPLMIX</code> returned by the <code>gibbsPLMIX</code> function.</p>
</td></tr>
<tr><td><code id="print.gsPLMIX_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods (not used).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gibbsPLMIX">gibbsPLMIX</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Print of the Gibbs sampling procedure
data(d_carconf)
GIBBS &lt;- gibbsPLMIX(pi_inv=d_carconf, K=ncol(d_carconf), G=3, n_iter=30, n_burn=10)
print(GIBBS)
</code></pre>

<hr>
<h2 id='print.mpPLMIX'>Print of the MAP estimation algorithm for a Bayesian mixture of Plackett-Luce models</h2><span id='topic+print.mpPLMIX'></span>

<h3>Description</h3>

<p><code>print</code> method for class <code>mpPLMIX</code>. It shows some general information on the MAP estimation procedure for a Bayesian mixture of Plackett-Luce models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mpPLMIX'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.mpPLMIX_+3A_x">x</code></td>
<td>
<p>Object of class <code>mpPLMIX</code> returned by the <code>mapPLMIX</code> or <code>mapPLMIX_multistart</code> function.</p>
</td></tr>
<tr><td><code id="print.mpPLMIX_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods (not used).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mapPLMIX">mapPLMIX</a></code> and <code><a href="#topic+mapPLMIX_multistart">mapPLMIX_multistart</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Print of the MAP procedure with a single starting point
data(d_carconf)
MAP &lt;- mapPLMIX(pi_inv=d_carconf, K=ncol(d_carconf), G=3)
print(MAP)

## Print of the MAP procedure with 5 starting points
MAP_multi &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=ncol(d_carconf), G=3, n_start=5)
print(MAP_multi)
</code></pre>

<hr>
<h2 id='rank_ord_switch'>Switch from orderings to rankings and vice versa</h2><span id='topic+rank_ord_switch'></span>

<h3>Description</h3>

<p>Convert the format of the input dataset from orderings to rankings and vice versa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rank_ord_switch(data, format_input, nranked = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rank_ord_switch_+3A_data">data</code></td>
<td>
<p>Numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of partial sequences whose format has to be converted.</p>
</td></tr>
<tr><td><code id="rank_ord_switch_+3A_format_input">format_input</code></td>
<td>
<p>Character string indicating the format of the <code>data</code> input, namely <code>"ordering"</code> or <code>"ranking"</code>.</p>
</td></tr>
<tr><td><code id="rank_ord_switch_+3A_nranked">nranked</code></td>
<td>
<p>Optional numeric vector of length <code class="reqn">N</code> with the number of items ranked by each sample unit.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of partial sequences with inverse format.
</p>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## From orderings to rankings for the Dublin West dataset
data(d_dublinwest)
head(d_dublinwest)
rank_ord_switch(data=head(d_dublinwest), format_input="ordering")
</code></pre>

<hr>
<h2 id='rank_summaries'>Descriptive summaries for a partial ordering/ranking dataset</h2><span id='topic+rank_summaries'></span>

<h3>Description</h3>

<p>Compute rank summaries and censoring patterns for a partial ordering/ranking dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rank_summaries(data, format_input, mean_rank = TRUE, marginals = TRUE,
  pc = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rank_summaries_+3A_data">data</code></td>
<td>
<p>Numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of partial sequences.</p>
</td></tr>
<tr><td><code id="rank_summaries_+3A_format_input">format_input</code></td>
<td>
<p>Character string indicating the format of the <code>data</code> input, namely <code>"ordering"</code> or <code>"ranking"</code>.</p>
</td></tr>
<tr><td><code id="rank_summaries_+3A_mean_rank">mean_rank</code></td>
<td>
<p>Logical: whether the mean rank vector has to be computed. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="rank_summaries_+3A_marginals">marginals</code></td>
<td>
<p>Logical: whether the marginal rank distributions have to be computed. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="rank_summaries_+3A_pc">pc</code></td>
<td>
<p>Logical: whether the paired comparison matrix has to be computed. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of named objects:
</p>
<table role = "presentation">
<tr><td><code>nranked</code></td>
<td>
<p> Numeric vector of length <code class="reqn">N</code> with the number of items ranked by each sample unit.</p>
</td></tr>
<tr><td><code>nranked_distr</code></td>
<td>
<p> Frequency distribution of the <code>nranked</code> vector.</p>
</td></tr>
<tr><td><code>na_or_not</code></td>
<td>
<p> Numeric <code class="reqn">3</code><code class="reqn">\times</code><code class="reqn">K</code> matrix with the counts of sample units that ranked or not each item. The last row contains the total by column, corresponding to the sample size <code class="reqn">N</code>.</p>
</td></tr>
<tr><td><code>mean_rank</code></td>
<td>
<p> Numeric vector of length <code class="reqn">K</code> with the mean rank of each item.</p>
</td></tr>
<tr><td><code>marginals</code></td>
<td>
<p> Numeric <code class="reqn">K</code><code class="reqn">\times</code><code class="reqn">K</code> matrix of the marginal rank distributions: the <code class="reqn">(i,j)</code>-th entry indicates the number of units that ranked item <code class="reqn">i</code> in the <code class="reqn">j</code>-th position.</p>
</td></tr>
<tr><td><code>pc</code></td>
<td>
<p> Numeric <code class="reqn">K</code><code class="reqn">\times</code><code class="reqn">K</code> paired comparison matrix: the <code class="reqn">(i,i')</code>-th entry indicates the number of sample units that preferred item <code class="reqn">i</code> to item <code class="reqn">i'</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>References</h3>

<p>Marden, J. I. (1995). Analyzing and modeling rank data. <em>Monographs on Statistics and Applied Probability</em> (64). Chapman &amp; Hall, ISSN: 0-412-99521-2. London.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(d_carconf)
rank_summaries(data=d_carconf, format_input="ordering")
</code></pre>

<hr>
<h2 id='rPLMIX'>Random sample from a mixture of Plackett-Luce models</h2><span id='topic+rPLMIX'></span>

<h3>Description</h3>

<p>Draw a random sample of complete orderings/rankings from a <code class="reqn">G</code>-component mixture of Plackett-Luce models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rPLMIX(n = 1, K, G, p = t(matrix(1/K, nrow = K, ncol = G)),
  ref_order = t(matrix(1:K, nrow = K, ncol = G)), weights = rep(1/G,
  G), format_output = "ordering")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rPLMIX_+3A_n">n</code></td>
<td>
<p>Number of observations to be sampled. Default is 1.</p>
</td></tr>
<tr><td><code id="rPLMIX_+3A_k">K</code></td>
<td>
<p>Number of possible items.</p>
</td></tr>
<tr><td><code id="rPLMIX_+3A_g">G</code></td>
<td>
<p>Number of mixture components.</p>
</td></tr>
<tr><td><code id="rPLMIX_+3A_p">p</code></td>
<td>
<p>Numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix of component-specific support parameters. Default is equal support parameters (uniform mixture components).</p>
</td></tr>
<tr><td><code id="rPLMIX_+3A_ref_order">ref_order</code></td>
<td>
<p>Numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix of component-specific reference orders. Default is forward orders (identity permutations) in each row, corresponding to Plackett-Luce mixture components (see 'Details').</p>
</td></tr>
<tr><td><code id="rPLMIX_+3A_weights">weights</code></td>
<td>
<p>Numeric vector of <code class="reqn">G</code> mixture weights. Default is equal weights.</p>
</td></tr>
<tr><td><code id="rPLMIX_+3A_format_output">format_output</code></td>
<td>
<p>Character string indicating the format of the returned simulated dataset (<code>"ordering"</code> or <code>"ranking"</code>). Default is <code>"ordering"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Positive values are required for <code>p</code> and <code>weights</code> arguments (normalization is not necessary).
</p>
<p>The <code>ref_order</code> argument accommodates for the more general mixture of Extended Plackett-Luce models (EPL), involving the additional reference order parameters (Mollica and Tardella 2014). A permutation of the first <code class="reqn">K</code> integers can be specified in each row of the <code>ref_order</code> argument to generate a sample from a <code class="reqn">G</code>-component mixture of EPL. Since the Plackett-Luce model is a special instance of the EPL with the reference order equal to the identity permutation <code class="reqn">(1,\dots,K)</code>, the default value of the <code>ref_order</code> argument is forward orders.
</p>


<h3>Value</h3>

<p>If <code class="reqn">G=1</code>, a numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> matrix of simulated complete sequences. If <code class="reqn">G&gt;1</code>, a list of two named objects:
</p>
<table role = "presentation">
<tr><td><code>comp</code></td>
<td>
<p> Numeric vector of <code class="reqn">N</code> mixture component memberships.</p>
</td></tr>
<tr><td><code>sim_data</code></td>
<td>
<p> Numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> matrix of simulated complete sequences.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
K &lt;- 6
G &lt;- 3
support_par &lt;- matrix(1:(G*K), nrow=G, ncol=K)
weights_par &lt;- c(0.50, 0.25, 0.25)

set.seed(47201)
simulated_data &lt;- rPLMIX(n=5, K=K, G=G, p=support_par, weights=weights_par)
simulated_data$comp
simulated_data$sim_data

</code></pre>

<hr>
<h2 id='selectPLMIX'>Bayesian selection criteria for mixtures of Plackett-Luce models</h2><span id='topic+selectPLMIX'></span>

<h3>Description</h3>

<p>Compute Bayesian comparison criteria for mixtures of Plackett-Luce models with a different number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selectPLMIX(pi_inv, seq_G, MCMCsampleP = vector(mode = "list", length =
  length(seq_G)), MCMCsampleW = vector(mode = "list", length =
  length(seq_G)), MAPestP, MAPestW, deviance, post_est = "mean",
  parallel = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="selectPLMIX_+3A_pi_inv">pi_inv</code></td>
<td>
<p>An object of class <code>top_ordering</code>, collecting the numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of partial orderings, or an object that can be coerced with <code><a href="#topic+as.top_ordering">as.top_ordering</a></code>.</p>
</td></tr>
<tr><td><code id="selectPLMIX_+3A_seq_g">seq_G</code></td>
<td>
<p>Numeric vector with the number of components of the Plackett-Luce mixtures to be compared.</p>
</td></tr>
<tr><td><code id="selectPLMIX_+3A_mcmcsamplep">MCMCsampleP</code></td>
<td>
<p>List of size <code>length(seq_G)</code>, whose generic element is a numeric <code class="reqn">L</code><code class="reqn">\times</code><code class="reqn">(G*K)</code> matrix with the MCMC samples of the component-specific support parameters. Default is list of <code>NULL</code> elements.</p>
</td></tr>
<tr><td><code id="selectPLMIX_+3A_mcmcsamplew">MCMCsampleW</code></td>
<td>
<p>List of size <code>length(seq_G)</code>, whose generic element is a numeric <code class="reqn">L</code><code class="reqn">\times</code><code class="reqn">G</code> matrix with the MCMC samples of the mixture weights. Default is list of <code>NULL</code> elements.</p>
</td></tr>
<tr><td><code id="selectPLMIX_+3A_mapestp">MAPestP</code></td>
<td>
<p>List of size <code>length(seq_G)</code>, whose generic element is a numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix with the MAP estimates of the component-specific support parameters.</p>
</td></tr>
<tr><td><code id="selectPLMIX_+3A_mapestw">MAPestW</code></td>
<td>
<p>List of size <code>length(seq_G)</code>, whose generic element is a numeric vector with the MAP estimates of the <code class="reqn">G</code> mixture weights.</p>
</td></tr>
<tr><td><code id="selectPLMIX_+3A_deviance">deviance</code></td>
<td>
<p>List of size <code>length(seq_G)</code>, whose generic element is a numeric vector of posterior deviance values.</p>
</td></tr>
<tr><td><code id="selectPLMIX_+3A_post_est">post_est</code></td>
<td>
<p>Character string indicating the  point estimates of the Plackett-Luce mixture parameters to be computed from the MCMC sample. This argument is ignored when MAP estimates are supplied in the <code>MAPestP</code> and <code>MAPestW</code> arguments. Default is <code>"mean"</code>. Alternatively, one can choose <code>"median"</code> (see 'Details').</p>
</td></tr>
<tr><td><code id="selectPLMIX_+3A_parallel">parallel</code></td>
<td>
<p>Logical: whether parallelization should be used. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>selectPLMIX</code> function privileges the use of the MAP point estimates to compute the Bayesian model comparison criteria, since they are not affected by the label switching issue. By setting both the <code>MAPestP</code> and <code>MAPestW</code> arguments equal to NULL, the user can alternatively compute the selection measures by relying on a different posterior summary (<code>"mean"</code> or <code>"median"</code>) specified in the <code>post_est</code> argument. In the latter case, the MCMC samples for each Plackett-Luce mixture must be supplied in the lists <code>MCMCsampleP</code> and <code>MCMCsampleW</code>. The drawback when working with point estimates other than the MAP is that the possible presence of label switching has to be previously removed from the traces to obtain meaningful results. See the <code><a href="#topic+label_switchPLMIX">label_switchPLMIX</a></code> function to perfom label switching adjustment of the MCMC samples.
</p>
<p>Several model selection criteria are returned. The two versions of DIC correspond to alternative ways of computing the effective number of parameters: DIC1 was proposed by Spiegelhalter et al. (2002) with penalty named <code>pD</code>, whereas DIC2 was proposed by Gelman et al. (2004) with penalty named <code>pV</code>. The latter coincides with the AICM introduced by Raftery et al. (2007), that is, the Bayesian counterpart of AIC. BPIC1 and BPIC2 are obtained from the two DIC by simply doubling the penalty term, as suggested by Ando (2007) to contrast DIC's tendency to overfitting. BICM1 is the Bayesian variant of the BIC, originally presented by Raftery et al. (2007) and entirely based on the MCMC sample. The BICM2, instead, involved the MAP estimate without the need of its approximation from the MCMC sample as for the BICM1.
</p>


<h3>Value</h3>

<p>A list of named objects:
</p>
<table role = "presentation">
<tr><td><code>point_estP</code></td>
<td>
<p> List of size <code>length(seq_G)</code>, whose generic element is a numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix with the point estimates of the component-specific support parameters employed for the computation of the criteria.</p>
</td></tr>
<tr><td><code>point_estW</code></td>
<td>
<p> List of size <code>length(seq_G)</code>, whose generic element is a numeric vector with the <code class="reqn">G</code> point estimates of the mixture weights employed for the computation of the criteria.</p>
</td></tr>
<tr><td><code>fitting</code></td>
<td>
<p> Numeric <code>length(seq_G)</code><code class="reqn">\times</code><code class="reqn">2</code> matrix with the fitting terms of the comparison measures, given by the posterior expected deviance <code>D_bar</code> and the deviance <code>D_hat</code> evaluated at the point estimate.</p>
</td></tr>
<tr><td><code>penalties</code></td>
<td>
<p> Numeric <code>length(seq_G)</code><code class="reqn">\times</code><code class="reqn">2</code> matrix with the penalty terms <code>pD</code> and <code>pV</code> (effective number of parameters).</p>
</td></tr>
<tr><td><code>criteria</code></td>
<td>
<p> Numeric <code>length(seq_G)</code><code class="reqn">\times</code><code class="reqn">6</code> matrix of Bayesian model selection criteria: <code>DIC1</code>, <code>DIC2</code>, <code>BPIC1</code>, <code>BPIC2</code>, <code>BICM1</code> and <code>BICM2</code> (see 'Details').</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>References</h3>

<p>Mollica, C. and Tardella, L. (2017). Bayesian Plackett-Luce mixture models for partially ranked data. <em>Psychometrika</em>, <b>82</b>(2), pages 442&ndash;458, ISSN: 0033-3123, DOI: 10.1007/s11336-016-9530-0.
</p>
<p>Ando, T. (2007). Bayesian predictive information criterion for the evaluation of hierarchical Bayesian and empirical Bayes models. <em>Biometrika</em>, <b>94</b>(2), pages 443&ndash;458.
</p>
<p>Raftery, A. E, Satagopan, J. M., Newton M. A. and Krivitsky, P. N. (2007). BAYESIAN STATISTICS 8. <em>Proceedings of the eighth Valencia International Meeting 2006</em>, pages 371&ndash;416. Oxford University Press.
</p>
<p>Gelman, A., Carlin, J. B., Stern, H. S. and Rubin, D. B. (2004). Bayesian data analysis. Chapman &amp; Hall/CRC, Second Edition, ISBN: 1-58488-388-X. New York.
</p>
<p>Spiegelhalter, D. J., Best, N. G., Carlin, B. P. and Van Der Linde, A. (2002). Bayesian measures of model complexity and fit. <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>64</b>(4), pages 583&ndash;639.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(d_carconf)
K &lt;- ncol(d_carconf)

## Fit 1- and 2-component PL mixtures via MAP estimation 
MAP_1 &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=K, G=1, 
                                   n_start=2, n_iter=400*1)

MAP_2 &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=K, G=2, 
                                   n_start=2, n_iter=400*2)

mcmc_iter &lt;- 30
burnin &lt;- 10

## Fit 1- and 2-component PL mixtures via Gibbs sampling procedure
GIBBS_1 &lt;- gibbsPLMIX(pi_inv=d_carconf, K=K, G=1, n_iter=mcmc_iter, 
                      n_burn=burnin, init=list(p=MAP_1$mod$P_map,
                      z=binary_group_ind(MAP_1$mod$class_map,G=1)))
GIBBS_2 &lt;- gibbsPLMIX(pi_inv=d_carconf, K=K, G=2, n_iter=mcmc_iter, 
                      n_burn=burnin, init=list(p=MAP_2$mod$P_map,
                      z=binary_group_ind(MAP_2$mod$class_map,G=2)))
## Select the optimal number of components 
SELECT &lt;- selectPLMIX(pi_inv=d_carconf, seq_G=1:2, 
                      MAPestP=list(MAP_1$mod$P_map, MAP_2$mod$P_map), 
                      MAPestW=list(MAP_1$mod$W_map, MAP_2$mod$W_map), 
                      deviance=list(GIBBS_1$deviance, GIBBS_2$deviance))
SELECT$criteria

</code></pre>

<hr>
<h2 id='summary.gsPLMIX'>Summary of the Gibbs sampling procedure for a Bayesian mixture of Plackett-Luce models</h2><span id='topic+summary.gsPLMIX'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>gsPLMIX</code>. It provides summary statistics and credible intervals for the Gibbs sampling simulation of a Bayesian mixture of Plackett-Luce models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gsPLMIX'
summary(object, quantiles = c(0.025, 0.25, 0.5, 0.75,
  0.975), hpd_prob = 0.95, digits = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.gsPLMIX_+3A_object">object</code></td>
<td>
<p>Object of class <code>gsPLMIX</code> returned by the <code>gibbsPLMIX</code> function.</p>
</td></tr>
<tr><td><code id="summary.gsPLMIX_+3A_quantiles">quantiles</code></td>
<td>
<p>Numeric vector of quantile probabilities.</p>
</td></tr>
<tr><td><code id="summary.gsPLMIX_+3A_hpd_prob">hpd_prob</code></td>
<td>
<p>Numeric scalar in the grid of values spanning the interval (0,1) by 0.05, giving the posterior probability content of the HPD intervals. Supplied values outside the grid are rounded.</p>
</td></tr>
<tr><td><code id="summary.gsPLMIX_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places for rounding the posterior summaries.</p>
</td></tr>
<tr><td><code id="summary.gsPLMIX_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods (not used).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Posterior summaries include means, standard deviations, naive standard errors of the means (ignoring autocorrelation of the chain) and time-series standard errors based on an estimate of the spectral density at 0. They correspond to the <code>statistics</code> element of the output returned by the <code>summary.mcmc</code> function of the <code>coda</code> package. Highest posterior density (HPD) intervals are obtained by recalling the <code>HPDinterval</code> function of the <code>coda</code> package.
</p>


<h3>Value</h3>

<p>A list of summary statistics for the <code>gsPLMIX</code> class object:
</p>
<table role = "presentation">
<tr><td><code>statistics</code></td>
<td>
<p> Numeric matrix with posterior summaries in each row (see 'Details').</p>
</td></tr>
<tr><td><code>quantiles</code></td>
<td>
<p> Numeric matrix with posterior quantiles at the given <code>quantiles</code> probabilities in each row.</p>
</td></tr>
<tr><td><code>HPDintervals</code></td>
<td>
<p> Numeric matrix with 100<code class="reqn">*</code><code>hpd_prob</code>% HPD intervals in each row.</p>
</td></tr>
<tr><td><code>Modal_orderings</code></td>
<td>
<p> Numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix with the estimated posterior modal orderings of each mixture component.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p> The matched call.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>References</h3>

<p>Plummer, M., Best, N., Cowles, K. and Vines, K. (2006). CODA: Convergence Diagnosis and Output Analysis for MCMC, <em>R News</em>, <b>6</b>, pages 7&ndash;11, ISSN: 1609-3631.
</p>


<h3>See Also</h3>

<p><code><a href="coda.html#topic+summary.mcmc">summary.mcmc</a></code> and <code><a href="coda.html#topic+HPDinterval">HPDinterval</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(d_carconf)
GIBBS &lt;- gibbsPLMIX(pi_inv=d_carconf, K=ncol(d_carconf), G=3, n_iter=30, n_burn=10)

## Summary of the Gibbs sampling procedure
summary(GIBBS)
</code></pre>

<hr>
<h2 id='summary.mpPLMIX'>Summary of the MAP estimation for a Bayesian mixture of Plackett-Luce models</h2><span id='topic+summary.mpPLMIX'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>mpPLMIX</code>. It provides summaries for the MAP estimation of a Bayesian mixture of Plackett-Luce models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mpPLMIX'
summary(object, digits = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.mpPLMIX_+3A_object">object</code></td>
<td>
<p>Object of class <code>mpPLMIX</code> returned by the <code>mapPLMIX</code> or <code>mapPLMIX_multistart</code> function.</p>
</td></tr>
<tr><td><code id="summary.mpPLMIX_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places for rounding the summaries.</p>
</td></tr>
<tr><td><code id="summary.mpPLMIX_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods (not used).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of summaries for the <code>mpPLMIX</code> class object:
</p>
<table role = "presentation">
<tr><td><code>MAP_w</code></td>
<td>
<p> Numeric vector with the MAP estimates of the <code class="reqn">G</code> mixture weights. Returned only when when <code class="reqn">G&gt;1</code>.</p>
</td></tr>
<tr><td><code>MAP_p</code></td>
<td>
<p> Numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix with the MAP estimates of the component-specific support parameters.</p>
</td></tr>
<tr><td><code>MAP_modal_orderings</code></td>
<td>
<p> Numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix with the estimated modal orderings of each mixture component.</p>
</td></tr>
<tr><td><code>group_distr</code></td>
<td>
<p> Numeric vector with the relative frequency distribution of the mixture component memberships based on MAP allocation. Returned only when when <code class="reqn">G&gt;1</code>.</p>
</td></tr>
<tr><td><code>perc_conv_rate</code></td>
<td>
<p> Numeric scalar with the percentage of MAP algorithm convergence over the multiple starting points. Returned only when <code>summary.mpPLMIX</code> is applied to the output of the <code>mapPLMIX_multistart</code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Summary of the MAP procedure with a single starting point
data(d_carconf)
MAP &lt;- mapPLMIX(pi_inv=d_carconf, K=ncol(d_carconf), G=3)
summary(MAP)

## Summary of the MAP procedure with 5 starting points
MAP_multi &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=ncol(d_carconf), G=3, n_start=5)
summary(MAP_multi)
</code></pre>

<hr>
<h2 id='unit_to_freq'>Frequency distribution from the individual rankings/orderings</h2><span id='topic+unit_to_freq'></span>

<h3>Description</h3>

<p>Construct the frequency distribution of the distinct observed sequences from the dataset of individual rankings/orderings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unit_to_freq(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="unit_to_freq_+3A_data">data</code></td>
<td>
<p>Numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of observed individual sequences.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric matrix of the distinct observed sequences with the corresponding frequencies indicated in the last <code class="reqn">(K+1)</code>-th column.
</p>


<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Frequency distribution for the APA top-ordering dataset
data(d_apa)
unit_to_freq(data=d_apa)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
