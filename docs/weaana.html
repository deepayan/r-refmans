<!DOCTYPE html><html lang="en"><head><title>Help for package weaana</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {weaana}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+5B+2CWeaAna-method'><p>Getter to access the weather data at a specific position.</p></a></li>
<li><a href='#changeWeatherRecords'><p>Change weather records</p></a></li>
<li><a href='#convert2Records'><p>Convert a data frame to weaana class</p></a></li>
<li><a href='#createWeaAna'><p>create WeaAna class</p></a></li>
<li><a href='#dayLength'><p>The time elapsed in hours between the specified sun angle</p>
from 90 degree in am and pm. +ve above the horizon, -ve below the horizon.</a></li>
<li><a href='#diurnalT'><p>Calculate the diurnal variation in air temperature with Parton and Logan, 1981</p></a></li>
<li><a href='#getWeatherRecords'><p>Get all weather records by year range</p></a></li>
<li><a href='#interpolationFunction'><p>Return a y value from a linear interpolation function</p></a></li>
<li><a href='#readWeatherRecords'><p>Read weather records from a file list and/or a folder list</p></a></li>
<li><a href='#records'><p>Demo weather records</p></a></li>
<li><a href='#result-class'><p>Define the class for statistics results</p></a></li>
<li><a href='#show+2CWeaAna-method'><p>Show basic information of class WeaAna</p></a></li>
<li><a href='#siteInfor'><p>Get site information</p></a></li>
<li><a href='#sphericalDistance'><p>Calculate the sphere distance</p></a></li>
<li><a href='#thermalTime'><p>Calculate thermal time using cardinal temperatures</p></a></li>
<li><a href='#thermalTimeDaily'><p>Calculate thermal time using cardinal temperatures</p></a></li>
<li><a href='#thermalTimeHourly'><p>Calculate thermal time using the hourly temperature (non daily temperature)</p></a></li>
<li><a href='#ttest_ts'><p>Significantly t-test with auto-correlation for time serial data</p></a></li>
<li><a href='#WeaAna-class'><p>Define the class for multiple sites</p></a></li>
<li><a href='#WeaAnaSite-class'><p>Define the class of WeaAna</p></a></li>
<li><a href='#writeWeatherRecords'><p>Write weather records into file</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Maintainer:</td>
<td>Bangyou Zheng &lt;bangyou.zheng@csiro.au&gt;</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis the Weather Data</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions are collected to analyse weather data for agriculture 
    purposes including to read weather records in multiple formats, 
    calculate extreme climate index.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://weaana.bangyou.me/">https://weaana.bangyou.me/</a>, <a href="https://github.com/byzheng/weaana">https://github.com/byzheng/weaana</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/byzheng/weaana/issues">https://github.com/byzheng/weaana/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-09-06</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, stats, settings, reshape2, lubridate, magrittr,
rlang, dplyr, tibble</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-09-27 00:13:15 UTC; zhe00a</td>
</tr>
<tr>
<td>Author:</td>
<td>Bangyou Zheng [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-09-27 10:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+5B+2CWeaAna-method'>Getter to access the weather data at a specific position.</h2><span id='topic++5B+2CWeaAna-method'></span>

<h3>Description</h3>

<p>Getter to access the weather data at a specific position.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'WeaAna'
x[i, j, drop]
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B5B+2B2CWeaAna-method_+3A_x">x</code></td>
<td>
<p>A WeaAna object.</p>
</td></tr>
<tr><td><code id="+2B5B+2B2CWeaAna-method_+3A_i">i</code></td>
<td>
<p>the specific position which will access.</p>
</td></tr>
<tr><td><code id="+2B5B+2B2CWeaAna-method_+3A_j">j</code></td>
<td>
<p>None use parameter.</p>
</td></tr>
<tr><td><code id="+2B5B+2B2CWeaAna-method_+3A_drop">drop</code></td>
<td>
<p>None use parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A WeaAnaSite object at the position i.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(weaana)
data( "WeatherRecordsDemo" ) 
records[1]
records[1:2]
records[2:2]

</code></pre>

<hr>
<h2 id='changeWeatherRecords'>Change weather records</h2><span id='topic+changeWeatherRecords'></span><span id='topic+changeWeatherRecords+2CWeaAna-method'></span><span id='topic+changeWeatherRecords+2CWeaAna+2CWeaAna-method'></span>

<h3>Description</h3>

<p>Change weather records
</p>
<p>Change weather records
</p>


<h3>Usage</h3>

<pre><code class='language-R'>changeWeatherRecords(object, ...)

## S4 method for signature 'WeaAna'
changeWeatherRecords(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="changeWeatherRecords_+3A_object">object</code></td>
<td>
<p>A WeaAna object.</p>
</td></tr>
<tr><td><code id="changeWeatherRecords_+3A_...">...</code></td>
<td>
<p>New weather records</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A new WeaAna object with updated records
</p>

<hr>
<h2 id='convert2Records'>Convert a data frame to weaana class</h2><span id='topic+convert2Records'></span>

<h3>Description</h3>

<p>Convert a data frame to weaana class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert2Records(infor, records)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convert2Records_+3A_infor">infor</code></td>
<td>
<p>A list or data frame of site information</p>
</td></tr>
<tr><td><code id="convert2Records_+3A_records">records</code></td>
<td>
<p>A data frame will convert to records</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A new WeaAna object
</p>

<hr>
<h2 id='createWeaAna'>create WeaAna class</h2><span id='topic+createWeaAna'></span>

<h3>Description</h3>

<p>create WeaAna class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createWeaAna(mets)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createWeaAna_+3A_mets">mets</code></td>
<td>
<p>A list contained information of weather records.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A new WeaAna class
</p>

<hr>
<h2 id='dayLength'>The time elapsed in hours between the specified sun angle 
from 90 degree in am and pm. +ve above the horizon, -ve below the horizon.</h2><span id='topic+dayLength'></span>

<h3>Description</h3>

<p>The time elapsed in hours between the specified sun angle 
from 90 degree in am and pm. +ve above the horizon, -ve below the horizon.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dayLength(doy, lat, angle = -6)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dayLength_+3A_doy">doy</code></td>
<td>
<p>day of year number</p>
</td></tr>
<tr><td><code id="dayLength_+3A_lat">lat</code></td>
<td>
<p>latitude of site (deg)</p>
</td></tr>
<tr><td><code id="dayLength_+3A_angle">angle</code></td>
<td>
<p>angle to measure time between, such as twilight (deg).
angular distance between 90 deg and end of twilight - altitude of sun. +ve up, -ve down.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>day length in hours
</p>

<hr>
<h2 id='diurnalT'>Calculate the diurnal variation in air temperature with Parton and Logan, 1981</h2><span id='topic+diurnalT'></span>

<h3>Description</h3>

<p>Calculate the diurnal variation in air temperature.
Parton WJ, Logan JA (1981) A model for diurnal variation in soil and air temperature. 
Agricultural Meteorology, 23, 205?216.
Codes copied from APSIM Utilities.cpp
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diurnalT(maxt, mint, doy, hour, latitude, A = 1.5, B = 4, C = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diurnalT_+3A_maxt">maxt</code></td>
<td>
<p>maximum daily temperature</p>
</td></tr>
<tr><td><code id="diurnalT_+3A_mint">mint</code></td>
<td>
<p>minimum daily temperature</p>
</td></tr>
<tr><td><code id="diurnalT_+3A_doy">doy</code></td>
<td>
<p>day of year</p>
</td></tr>
<tr><td><code id="diurnalT_+3A_hour">hour</code></td>
<td>
<p>hour from 1 to 24</p>
</td></tr>
<tr><td><code id="diurnalT_+3A_latitude">latitude</code></td>
<td>
<p>latitude in radials</p>
</td></tr>
<tr><td><code id="diurnalT_+3A_a">A</code></td>
<td>
<p>is the time lag in temperature after noon</p>
</td></tr>
<tr><td><code id="diurnalT_+3A_b">B</code></td>
<td>
<p>is coef that controls temperature decrease at night</p>
</td></tr>
<tr><td><code id="diurnalT_+3A_c">C</code></td>
<td>
<p>is the time lag for min temperature after sunrise</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with diurnal air temperature
</p>


<h3>Examples</h3>

<pre><code class='language-R'>diurnalT(maxt = 20, mint = 10, doy  = 1, 
   hour = seq(from = 1, to = 23.99, by = 0.1), 
   latitude = -10, A = 1.5, B = 4, C = 1)
</code></pre>

<hr>
<h2 id='getWeatherRecords'>Get all weather records by year range</h2><span id='topic+getWeatherRecords'></span><span id='topic+getWeatherRecords+2CWeaAna-method'></span><span id='topic+getWeatherRecords+2CWeaAna+2CWeaAna-method'></span>

<h3>Description</h3>

<p>Get all weather records by year range
</p>
<p>Get all weather records by year range
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getWeatherRecords(object, ...)

## S4 method for signature 'WeaAna'
getWeatherRecords(object, yrange = NULL, vars = "all", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getWeatherRecords_+3A_object">object</code></td>
<td>
<p>A WeaAna object.</p>
</td></tr>
<tr><td><code id="getWeatherRecords_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
<tr><td><code id="getWeatherRecords_+3A_yrange">yrange</code></td>
<td>
<p>Year range.</p>
</td></tr>
<tr><td><code id="getWeatherRecords_+3A_vars">vars</code></td>
<td>
<p>Variable</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with all weather records
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(weaana)
data( "WeatherRecordsDemo" ) 
getWeatherRecords( records, yrange = c( 2008, 2009 ) )
getWeatherRecords( records, yrange = c( 2008, 2009 ), length = 10 )

</code></pre>

<hr>
<h2 id='interpolationFunction'>Return a y value from a linear interpolation function</h2><span id='topic+interpolationFunction'></span>

<h3>Description</h3>

<p>Return a y value from a linear interpolation function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interpolationFunction(x, y, values, split = "\\s+")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="interpolationFunction_+3A_x">x</code></td>
<td>
<p>x</p>
</td></tr>
<tr><td><code id="interpolationFunction_+3A_y">y</code></td>
<td>
<p>y</p>
</td></tr>
<tr><td><code id="interpolationFunction_+3A_values">values</code></td>
<td>
<p>values</p>
</td></tr>
<tr><td><code id="interpolationFunction_+3A_split">split</code></td>
<td>
<p>split</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The interpolated values
</p>

<hr>
<h2 id='readWeatherRecords'>Read weather records from a file list and/or a folder list</h2><span id='topic+readWeatherRecords'></span>

<h3>Description</h3>

<p>Read weather records from a file list and/or a folder list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readWeatherRecords(
  dataFiles = NULL,
  dataFolders = NULL,
  dataFormat = "APSIM",
  dataWeather = NULL,
  load.later = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="readWeatherRecords_+3A_datafiles">dataFiles</code></td>
<td>
<p>A character vector to specify the path of weather data files.</p>
</td></tr>
<tr><td><code id="readWeatherRecords_+3A_datafolders">dataFolders</code></td>
<td>
<p>A character vector to specify the path of weather data folders.</p>
</td></tr>
<tr><td><code id="readWeatherRecords_+3A_dataformat">dataFormat</code></td>
<td>
<p>The format of weather data file.</p>
</td></tr>
<tr><td><code id="readWeatherRecords_+3A_dataweather">dataWeather</code></td>
<td>
<p>A data.frame for existing data.</p>
</td></tr>
<tr><td><code id="readWeatherRecords_+3A_load.later">load.later</code></td>
<td>
<p>Whether load weather records now or later. 
&quot;dataFroamt&quot; should be One of &quot;APSIM&quot; and &quot;RDATA&quot;.</p>
</td></tr>
<tr><td><code id="readWeatherRecords_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A WeaAna class which contains all weather data.
</p>

<hr>
<h2 id='records'>Demo weather records</h2><span id='topic+records'></span>

<h3>Description</h3>

<p>Demo weather records
</p>


<h3>Usage</h3>

<pre><code class='language-R'>records
</code></pre>


<h3>Format</h3>

<p>An object of class <code>WeaAna</code> of length 1.
</p>

<hr>
<h2 id='result-class'>Define the class for statistics results</h2><span id='topic+result-class'></span>

<h3>Description</h3>

<p>Define the class for statistics results
</p>


<h3>Slots</h3>


<dl>
<dt><code>name</code></dt><dd><p>Name of result</p>
</dd>
<dt><code>type</code></dt><dd><p>Type of result</p>
</dd>
</dl>

<hr>
<h2 id='show+2CWeaAna-method'>Show basic information of class WeaAna</h2><span id='topic+show+2CWeaAna-method'></span>

<h3>Description</h3>

<p>Show the name, number, latitude, longitude of all weather stations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'WeaAna'
show(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="show+2B2CWeaAna-method_+3A_object">object</code></td>
<td>
<p>WeaAna objects</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(weaana)
data( "WeatherRecordsDemo" ) 
show( records )
records
</code></pre>

<hr>
<h2 id='siteInfor'>Get site information</h2><span id='topic+siteInfor'></span><span id='topic+siteInfor+2CWeaAna-method'></span><span id='topic+siteInfor+2CWeaAna+2CWeaAna-method'></span><span id='topic+siteInfor+2CWeaAnaSite-method'></span><span id='topic+siteInfor+2CWeaAnaSite+2CWeaAnaSite-method'></span>

<h3>Description</h3>

<p>Get site information
</p>
<p>Get site information
</p>
<p>Get site information
</p>


<h3>Usage</h3>

<pre><code class='language-R'>siteInfor(object, ...)

## S4 method for signature 'WeaAna'
siteInfor(object, load.now = FALSE)

## S4 method for signature 'WeaAnaSite'
siteInfor(object, load.now = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="siteInfor_+3A_object">object</code></td>
<td>
<p>A WeaAnaSite object.</p>
</td></tr>
<tr><td><code id="siteInfor_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
<tr><td><code id="siteInfor_+3A_load.now">load.now</code></td>
<td>
<p>Whether load site information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Site information in the WeaAna object
</p>
<p>Site information in the WeaAnaSite object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(weaana)
data( "WeatherRecordsDemo" ) 
siteInfor( records )
siteInfor( records, load.now = TRUE )
</code></pre>

<hr>
<h2 id='sphericalDistance'>Calculate the sphere distance</h2><span id='topic+sphericalDistance'></span>

<h3>Description</h3>

<p>Calculate the sphere distance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sphericalDistance(lat1, lon1, lat2, lon2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sphericalDistance_+3A_lat1">lat1</code></td>
<td>
<p>Latitude</p>
</td></tr>
<tr><td><code id="sphericalDistance_+3A_lon1">lon1</code></td>
<td>
<p>Longitude</p>
</td></tr>
<tr><td><code id="sphericalDistance_+3A_lat2">lat2</code></td>
<td>
<p>Latitude</p>
</td></tr>
<tr><td><code id="sphericalDistance_+3A_lon2">lon2</code></td>
<td>
<p>Longitude</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Distance in km
</p>

<hr>
<h2 id='thermalTime'>Calculate thermal time using cardinal temperatures</h2><span id='topic+thermalTime'></span>

<h3>Description</h3>

<p>Calculate thermal time using cardinal temperatures
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thermalTime(weather, x_temp, y_temp, method = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="thermalTime_+3A_weather">weather</code></td>
<td>
<p>WeaAna object</p>
</td></tr>
<tr><td><code id="thermalTime_+3A_x_temp">x_temp</code></td>
<td>
<p>The cardinal temperatures</p>
</td></tr>
<tr><td><code id="thermalTime_+3A_y_temp">y_temp</code></td>
<td>
<p>The effective thermal time</p>
</td></tr>
<tr><td><code id="thermalTime_+3A_method">method</code></td>
<td>
<p>The method to calculate thermal time. 
The default method is ( maxt + mint ) / 2 - base. 
The three hour temperature methods will be used if method = '3hr'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with three columns: year, day and thermalTime.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>met_file &lt;- system.file("extdata/WeatherRecordsDemo1.met", package = "weaana")
records &lt;- readWeatherRecords(met_file)
x_temp &lt;- c(0, 26, 34)
y_temp &lt;- c(0, 26, 0)
res &lt;- thermalTime(records, x_temp, y_temp)
head(res)
res &lt;- thermalTime(records, x_temp, y_temp, method = "3hr")
head(res)
</code></pre>

<hr>
<h2 id='thermalTimeDaily'>Calculate thermal time using cardinal temperatures</h2><span id='topic+thermalTimeDaily'></span>

<h3>Description</h3>

<p>Calculate thermal time using cardinal temperatures
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thermalTimeDaily(mint, maxt, x_temp, y_temp, method = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="thermalTimeDaily_+3A_mint">mint</code></td>
<td>
<p>The minimum temperature</p>
</td></tr>
<tr><td><code id="thermalTimeDaily_+3A_maxt">maxt</code></td>
<td>
<p>The maximum temperature</p>
</td></tr>
<tr><td><code id="thermalTimeDaily_+3A_x_temp">x_temp</code></td>
<td>
<p>The cardinal temperatures</p>
</td></tr>
<tr><td><code id="thermalTimeDaily_+3A_y_temp">y_temp</code></td>
<td>
<p>The effective thermal time</p>
</td></tr>
<tr><td><code id="thermalTimeDaily_+3A_method">method</code></td>
<td>
<p>The method to calculate thermal time. 
The default method is ( maxt + mint ) / 2 - base. 
The three hour temperature methods will be usesd if method = '3hr'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The thermal time.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mint &lt;- c(0, 10)
maxt &lt;- c(30, 40)
x_temp &lt;- c(0, 20, 35)
y_temp &lt;- c(0, 20, 0)
thermalTimeDaily(mint, maxt, x_temp, y_temp)
thermalTimeDaily(mint, maxt, x_temp, y_temp, method = '3hr')
</code></pre>

<hr>
<h2 id='thermalTimeHourly'>Calculate thermal time using the hourly temperature (non daily temperature)</h2><span id='topic+thermalTimeHourly'></span>

<h3>Description</h3>

<p>Calculate thermal time using the hourly temperature (non daily temperature)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thermalTimeHourly(timestamp, temperature, x_temp, y_temp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="thermalTimeHourly_+3A_timestamp">timestamp</code></td>
<td>
<p>The timestamp of weather records</p>
</td></tr>
<tr><td><code id="thermalTimeHourly_+3A_temperature">temperature</code></td>
<td>
<p>The temperature</p>
</td></tr>
<tr><td><code id="thermalTimeHourly_+3A_x_temp">x_temp</code></td>
<td>
<p>The cardinal temperatures</p>
</td></tr>
<tr><td><code id="thermalTimeHourly_+3A_y_temp">y_temp</code></td>
<td>
<p>The effective thermal time</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with daily thermal time
</p>


<h3>Examples</h3>

<pre><code class='language-R'>met_file &lt;- system.file("extdata/WeatherHourly.csv", package = "weaana")
hourly &lt;- read.csv(met_file, as.is = TRUE) 

hourly$timestamp &lt;- as.POSIXct(hourly$timestamp, format = "%Y-%m-%dT%H:%M:%SZ")
x_temp &lt;- c(0, 20, 35)
y_temp &lt;- c(0, 20, 0)
thermalTimeHourly(hourly$timestamp, hourly$temperature, x_temp, y_temp)
</code></pre>

<hr>
<h2 id='ttest_ts'>Significantly t-test with auto-correlation for time serial data</h2><span id='topic+ttest_ts'></span>

<h3>Description</h3>

<p>Method is presented by Santer et al. 2000
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ttest_ts(y, slope = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ttest_ts_+3A_y">y</code></td>
<td>
<p>A vector of time serial data</p>
</td></tr>
<tr><td><code id="ttest_ts_+3A_slope">slope</code></td>
<td>
<p>Whether export slope</p>
</td></tr>
</table>


<h3>Value</h3>

<p>p values of t-test
</p>

<hr>
<h2 id='WeaAna-class'>Define the class for multiple sites</h2><span id='topic+WeaAna-class'></span>

<h3>Description</h3>

<p>Define the class for multiple sites
</p>


<h3>Slots</h3>


<dl>
<dt><code>num</code></dt><dd><p>total number of weather station</p>
</dd>
<dt><code>records</code></dt><dd><p>A pointer vector to weather records of each site</p>
</dd>
<dt><code>result</code></dt><dd><p>A pointer for all results name and type.</p>
</dd>
</dl>

<hr>
<h2 id='WeaAnaSite-class'>Define the class of WeaAna</h2><span id='topic+WeaAnaSite-class'></span>

<h3>Description</h3>

<p>Define the class of WeaAna
</p>


<h3>Slots</h3>


<dl>
<dt><code>name</code></dt><dd><p>Name of weather station</p>
</dd>
<dt><code>number</code></dt><dd><p>Station number of weather station</p>
</dd>
<dt><code>latitude</code></dt><dd><p>Latitude of weather station</p>
</dd>
<dt><code>longitude</code></dt><dd><p>Latitude of weather station</p>
</dd>
<dt><code>tav</code></dt><dd><p>Annual average ambient temperature</p>
</dd>
<dt><code>amp</code></dt><dd><p>Annual amplitude in mean monthly temperature</p>
</dd>
<dt><code>marker</code></dt><dd><p>The extra marker for this site</p>
</dd>
<dt><code>year</code></dt><dd><p>A vector of year of weather station</p>
</dd>
<dt><code>day</code></dt><dd><p>A vector of day of weather station</p>
</dd>
<dt><code>radn</code></dt><dd><p>A vector of radiation of weather station</p>
</dd>
<dt><code>maxt</code></dt><dd><p>A vector of maximum temperature of weather station</p>
</dd>
<dt><code>mint</code></dt><dd><p>A vector of minimum temperature of weather station</p>
</dd>
<dt><code>evap</code></dt><dd><p>A vector of evaporation of weather station</p>
</dd>
<dt><code>rain</code></dt><dd><p>A vector of rainfall of weather station</p>
</dd>
<dt><code>vp</code></dt><dd><p>A vector of pressure atmosphere of weather station</p>
</dd>
<dt><code>code</code></dt><dd><p>The 6 digit code indicates the source of the 6 data columns</p>
</dd>
<dt><code>extra</code></dt><dd><p>A list of variables need to store</p>
</dd>
<dt><code>res</code></dt><dd><p>All statistics results store in this slot</p>
</dd>
<dt><code>figures</code></dt><dd><p>A list to store all plotted figures.</p>
</dd>
<dt><code>file.path</code></dt><dd><p>The file path for this site.</p>
</dd>
<dt><code>data.format</code></dt><dd><p>The data format for this site.</p>
</dd>
<dt><code>load.later</code></dt><dd><p>Whether are records loaded laterly.</p>
</dd>
</dl>

<hr>
<h2 id='writeWeatherRecords'>Write weather records into file</h2><span id='topic+writeWeatherRecords'></span><span id='topic+writeWeatherRecords+2CWeaAna-method'></span><span id='topic+writeWeatherRecords+2CWeaAna+2CWeaAna-method'></span>

<h3>Description</h3>

<p>Write weather records into file
</p>
<p>Write weather records into file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeWeatherRecords(object, ...)

## S4 method for signature 'WeaAna'
writeWeatherRecords(object, file, cols = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="writeWeatherRecords_+3A_object">object</code></td>
<td>
<p>A WeaAna object.</p>
</td></tr>
<tr><td><code id="writeWeatherRecords_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
<tr><td><code id="writeWeatherRecords_+3A_file">file</code></td>
<td>
<p>Path of output file.</p>
</td></tr>
<tr><td><code id="writeWeatherRecords_+3A_cols">cols</code></td>
<td>
<p>Columns to export. All columns exported if NULL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return values
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
