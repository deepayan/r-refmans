<!DOCTYPE html><html><head><title>Help for package gamselBayes</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gamselBayes}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#checkChains'><p>Check Markov chain Monte Carlo samples</p></a></li>
<li><a href='#effectTypes'><p>Tabulate the estimated effect types from a Bayesian generalized additive model object</p></a></li>
<li><a href='#effectTypesVector'><p>Obtain the estimated effect types from a Bayesian generalized additive model object</p></a></li>
<li><a href='#gamselBayes'><p>Bayesian generalized additive model selection including a fast variational option</p></a></li>
<li><a href='#gamselBayes.control'><p>Controlling Bayesian generalized additive model selection</p></a></li>
<li><a href='#gamselBayesUpdate'><p>Update a <code>gamselBayes()</code> fit object.</p></a></li>
<li><a href='#gamselBayesVignette'><p>Display the package's vignette.</p></a></li>
<li><a href='#plot.gamselBayes'><p>Plot components of the selected generalized additive model from a <code>gamselBayes()</code> fit</p></a></li>
<li><a href='#predict.gamselBayes'><p>Obtain predictions from a <code>gamselBayes()</code> fit</p></a></li>
<li><a href='#summary.gamselBayes'><p>Summarise components of the selected generalized additive model from a <code>gamselBayes()</code> fit</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>2.0-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-09-03</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Generalized Additive Model Selection</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matt P. Wand &lt;matt.wand@uts.edu.au&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Generalized additive model selection via approximate Bayesian inference is provided. Bayesian mixed model-based penalized splines with spike-and-slab-type coefficient prior distributions are used to facilitate fitting and selection. The approximate Bayesian inference engine options are: (1) Markov chain Monte Carlo and (2) mean field variational Bayes. Markov chain Monte Carlo has better Bayesian inferential accuracy, but requires a longer run-time. Mean field variational Bayes is faster, but less accurate. The methodology is described in He and Wand (2023) &lt;<a href="https://doi.org/10.48550/arXiv.2201.00412">doi:10.48550/arXiv.2201.00412</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>Ecdat</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-03 12:21:19 UTC; mwand</td>
</tr>
<tr>
<td>Author:</td>
<td>Virginia X. He <a href="https://orcid.org/0000-0002-0238-5018"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Matt P. Wand <a href="https://orcid.org/0000-0003-2555-896X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-03 12:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='checkChains'>Check Markov chain Monte Carlo samples</h2><span id='topic+checkChains'></span>

<h3>Description</h3>

<p>Facilitates a graphical check of the Markov chain Monte Carlo samples (&quot;chains&quot;) corresponding to key quantities for the predictors selected as having an effect.</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkChains(fitObject,colourVersion = TRUE,paletteNum = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkChains_+3A_fitobject">fitObject</code></td>
<td>
<p><code>gamselBayes()</code> fit object.</p>
</td></tr>
<tr><td><code id="checkChains_+3A_colourversion">colourVersion</code></td>
<td>
<p>Boolean flag:<br />
TRUE = produce a colour version of the graphical check (the default)<br />
FALSE = produce a black-and-white version of the graphical check.</p>
</td></tr>
<tr><td><code id="checkChains_+3A_palettenum">paletteNum</code></td>
<td>
<p>The palette of colours for the graphical display when colourVersion is TRUE. Two palettes, numbered 1 and 2, are available. The value of <code>paletteNum</code> specifies the palette to use. The default value is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A graphic is produced that summarises the Markov chain Monte Carlo samples (&quot;chains&quot;) corresponding to key quantities for the predictors selected as having an effect. If the predictor is found to have a linear effect then the chain for its coefficient is graphically checked. It the predictor is found to have a non-linear effect then the chain for the vertical slice of the penalized spline fit at the median of the predictor sample is graphically checked. The columns of the graphic are the following summaries of each chain: (1) trace (time series) plot, (2) lag-1 plot in which each chain value is plotted against its previous value and (3) sample autocorrelation function plot as produced by the R function acf(). A rudimentary graphical assessment of convergence involveschecking that the trace plots have flat-lined, rather than having any noticeable trends. If the latter occurs that a longer warmup is recommended.</p>


<h3>Value</h3>

<p>Nothing is returned.</p>


<h3>Author(s)</h3>

<p>Virginia X. He <a href="mailto:virginia.x.he@student.uts.edu.au">virginia.x.he@student.uts.edu.au</a> and Matt P. Wand <a href="mailto:matt.wand@uts.edu.au">matt.wand@uts.edu.au</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> 
library(gamselBayes) 

# Generate some simple regression-type data:

set.seed(1) ; n &lt;- 1000 ; x1 &lt;- rbinom(n,1,0.5) ; 
x2 &lt;- runif(n) ; x3 &lt;- runif(n) ; x4 &lt;- runif(n)
y &lt;- x1 + sin(2*pi*x2) - x3 + rnorm(n)
Xlinear &lt;- data.frame(x1) ; Xgeneral &lt;- data.frame(x2,x3,x4)

# Obtain a gamselBayes() fit for the data:

fitMCMC &lt;- gamselBayes(y,Xlinear,Xgeneral)
summary (fitMCMC)

# Obtain a graphic for checking the chains:

checkChains(fitMCMC)

if (require("Ecdat"))
{
   # Obtain a gamselBayes() fit for data on schools in California, U.S.A.:

   Caschool$log.avginc &lt;- log(Caschool$avginc)
   mathScore &lt;- Caschool$mathscr
   Xgeneral &lt;- Caschool[,c("mealpct","elpct","calwpct","compstu","log.avginc")]
   fitMCMC &lt;- gamselBayes(y = mathScore,Xgeneral = Xgeneral)
   summary(fitMCMC)

   # Obtain a graphic for checking the chains:

   checkChains(fitMCMC)
}

</code></pre>

<hr>
<h2 id='effectTypes'>Tabulate the estimated effect types from a Bayesian generalized additive model object</h2><span id='topic+effectTypes'></span>

<h3>Description</h3>

<p>Produces a tabular summary of the estimated effect types from a gamselBayes() fit object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>effectTypes(fitObject)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="effectTypes_+3A_fitobject">fitObject</code></td>
<td>
<p><code>gamselBayes()</code> fit object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Two tables are printed to standard output. The first table lists the names of the predictors that are estimated as having a linear effect. The second table lists the names of the predictors that are estimated as having a nonlinear effect.</p>


<h3>Value</h3>

<p>Nothing is returned.</p>


<h3>Author(s)</h3>

<p>Virginia X. He <a href="mailto:virginia.x.he@student.uts.edu.au">virginia.x.he@student.uts.edu.au</a> and Matt P. Wand <a href="mailto:matt.wand@uts.edu.au">matt.wand@uts.edu.au</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(gamselBayes) 

# Generate some simple regression-type data:

set.seed(1) ; n &lt;- 1000 ; x1 &lt;- rbinom(n,1,0.5) 
x2 &lt;- runif(n) ; x3 &lt;- runif(n) ; x4 &lt;- runif(n)
y &lt;- x1 + sin(2*pi*x2) - x3 + rnorm(n)
Xlinear &lt;- data.frame(x1) ; Xgeneral &lt;- data.frame(x2,x3,x4)

# Obtain a gamselBayes() fit for the data:

fit &lt;- gamselBayes(y,Xlinear,Xgeneral)

# Tabulate the estimated effect types:

effectTypes(fit)
</code></pre>

<hr>
<h2 id='effectTypesVector'>Obtain the estimated effect types from a Bayesian generalized additive model object</h2><span id='topic+effectTypesVector'></span>

<h3>Description</h3>

<p>Extracts the vector of estimated effect types from a gamselBayes() fit object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>effectTypesVector(fitObject)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="effectTypesVector_+3A_fitobject">fitObject</code></td>
<td>
<p><code>gamselBayes()</code> fit object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The result is a vector of character strings having the same length as the total number of predictors inputted through <code>Xlinear</code> and <code>Xgeneral</code>. The character strings are one of &quot;linear&quot;, &quot;nonlinear&quot; and &quot;zero&quot; according to whether each predictor is estimated as having a linear effect, nonlinear effect of zero effect. The ordering in the returned vector matches that of the columns of <code>Xlinear</code> and then the columns of <code>Xgeneral</code>.</p>


<h3>Value</h3>

<p>A vector of character strings having the same length as the number of predictors, which conveys the estimated effect types.</p>


<h3>Author(s)</h3>

<p>Virginia X. He <a href="mailto:virginia.x.he@student.uts.edu.au">virginia.x.he@student.uts.edu.au</a> and Matt P. Wand <a href="mailto:matt.wand@uts.edu.au">matt.wand@uts.edu.au</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(gamselBayes) 

# Generate some simple regression-type data:

set.seed(1) ; n &lt;- 1000 ; x1 &lt;- rbinom(n,1,0.5) ; 
x2 &lt;- runif(n) ; x3 &lt;- runif(n) ; x4 &lt;- runif(n)
y &lt;- x1 + sin(2*pi*x2) - x3 + rnorm(n)
Xlinear &lt;- data.frame(x1) ; Xgeneral &lt;- data.frame(x2,x3,x4)

# Obtain a gamselBayes() fit for the data:

fit &lt;- gamselBayes(y,Xlinear,Xgeneral)

# Obtain the vector of effect types:

effectTypesVector(fit)
</code></pre>

<hr>
<h2 id='gamselBayes'>Bayesian generalized additive model selection including a fast variational option</h2><span id='topic+gamselBayes'></span>

<h3>Description</h3>

<p>Selection of predictors and the nature of their impact on the mean response (linear versus non-linear) is a fundamental problem in regression analysis. This function uses the generalized additive models framework for estimating predictors effects. An approximate Bayesian inference approach and has two options for achieving this: (1) Markov chain Monte Carlo and (2) mean field variational Bayes.</p>


<h3>Usage</h3>

<pre><code class='language-R'>gamselBayes(y,Xlinear  = NULL,Xgeneral = NULL,method = "MCMC",lowerMakesSparser = NULL,   
            family = "gaussian",verbose = TRUE,control = gamselBayes.control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gamselBayes_+3A_y">y</code></td>
<td>
<p>Vector containing the response data. If 'family = &quot;gaussian&quot;' then the response data are modelled as being continuous with a Gaussian distribution. If 'family = &quot;binomial&quot;' then the response data must be binary with 0/1 coding.</p>
</td></tr>
<tr><td><code id="gamselBayes_+3A_xlinear">Xlinear</code></td>
<td>
<p>Data frame with number of rows equal to the length of <code>y</code>. Each column contains data for a predictor which potentially has a linear or zero effect, but not a nonlinear effect. Binary predictors must be inputted through this matrix.</p>
</td></tr>
<tr><td><code id="gamselBayes_+3A_xgeneral">Xgeneral</code></td>
<td>
<p>A data frame with number of rows equal to the length of <code>y</code>. Each column contains data for a predictor which potentially has a linear, nonlinear or zero effect. Binary predictors cannot be inputted through this matrix.</p>
</td></tr>
<tr><td><code id="gamselBayes_+3A_method">method</code></td>
<td>
<p>Character string for specifying the method to be used:<br />
&quot;MCMC&quot; = Markov chain Monte Carlo,<br />
&quot;MFVB&quot; = mean field variational Bayes.</p>
</td></tr>
<tr><td><code id="gamselBayes_+3A_lowermakessparser">lowerMakesSparser</code></td>
<td>
<p>A threshold parameter between 0 and 1, which is such that lower values lead to sparser fits.</p>
</td></tr>
<tr><td><code id="gamselBayes_+3A_family">family</code></td>
<td>
<p>Character string for specifying the response family:<br />
&quot;gaussian&quot; = response assumed to be Gaussian with constant variance,<br />
&quot;binomial&quot; = response assumed to be binary.<br />
The default is &quot;gaussian&quot;.</p>
</td></tr>
<tr><td><code id="gamselBayes_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable for specifying whether or not progress messages are printed to the console. The default is TRUE.</p>
</td></tr>
<tr><td><code id="gamselBayes_+3A_control">control</code></td>
<td>
<p>Function for controlling the spline bases, Markov chain Monte Carlo sampling, mean field variational Bayes and other specifications.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generalized additive model selection via approximate Bayesian inference is provided. Bayesian mixed model-based penalized splines with spike-and-slab-type coefficient prior distributions are used to facilitate fitting and selection. The approximate Bayesian inference engine options are: (1) Markov chain Monte Carlo and (2) mean field variational Bayes. Markov chain Monte Carlo has better Bayesian inferential accuracy, but requires a longer run-time. Mean field variational Bayes is faster, but less accurate. The methodology is described in He and Wand (2021) &lt;arXiv:2201.00412&gt;. 
</p>


<h3>Value</h3>

<p>An object of class <code>gamselBayes</code>, which is a list with the following components:
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>the value of <code>method</code>.</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>the value of <code>family</code>.</p>
</td></tr>
<tr><td><code>Xlinear</code></td>
<td>
<p>the inputted design matrix containing predictors that can only have linear effects.</p>
</td></tr>  
<tr><td><code>Xgeneral</code></td>
<td>
<p>the inputted design matrix containing predictors that are potentially have non-linear effects.</p>
</td></tr> 
<tr><td><code>rangex</code></td>
<td>
<p>the value of the control parameter <code>rangex</code>.</p>
</td></tr> 
<tr><td><code>intKnots</code></td>
<td>
<p>the value of the control parameter <code>intKnots</code>.</p>
</td></tr> 
<tr><td><code>truncateBasis</code></td>
<td>
<p>the value of the control parameter <code>truncateBasis</code>.</p>
</td></tr> 
<tr><td><code>numBasis</code></td>
<td>
<p>the value of the control parameter <code>numBasis</code>.</p>
</td></tr> 
<tr><td><code>MCMC</code></td>
<td>
<p>a list such that each component is the retained Markov chain Monte Carlo (MCMC)sample for a model parameter. The components are:<br />
<code>beta0</code> = overall intercept.<br />
<code>betaTilde</code> = linear component coefficients without multiplication by the <code>gammaBeta</code> values.<br />
<code>gammaBeta</code> = linear component coefficients spike-and-slab auxiliary indicator variables.<br />
<code>sigmaBeta</code> = standard deviation of the linear component coefficients.<br />
<code>rhoBeta</code> = the Bernoulli distribution probability parameter of the linear component coefficients spike-and-slab auxiliary indicator variables.<br />
<code>uTilde</code> = spline basis function coefficients without multiplication by the <code>gammaUMCMC</code> values. The MCMC samples are stored in a list. Each list component corresponds to a predictor that is treated as potentially having a non-linear effect, and is a matrix with columns corresponding to the spline basis function coefficients for that predictor and rows corresponding to the retained MCMC samples.<br />
<code>gammaU</code> = spline basis coefficients spike-and-slab auxiliary indicator variables.  The MCMC samples are stored in a list. Each list component corresponds to a predictor that is treated as potentially having a non-linear effect, and is a matrix with columns corresponding to the spline basis function coefficients for that predictor and rows corresponding to the retained MCMC samples.<br />
<code>rhoU</code> = the Bernoulli distribution probability parameters of the spline basis component coefficients spike-and-slab auxiliary indicator variables. The MCMC samples are stored in a matrix. Each column corresponds to a predictor that is treated as potentially having a non-linear effect. The rows of the matrix correspond to the retained MCMC samples.<br />
<code>sigmaEps</code> = error standard deviation.
</p>
</td></tr> 
<tr><td><code>MFVB</code></td>
<td>
<p>a list such that each component is the mean field variational Bayes approximate posterior density function, or q-density, parameters. The components are:<br /> 
<code>beta0</code> = a vector with 2 entries, consisting of the mean and variance of the Univariate Normal q-density of the overall intercept.<br />
<code>betaTilde</code> = a two-component list containing the Multivariate Normal q-density parameters of linear component coefficients without multiplication by the means of the <code>gammaBeta</code> q-densities. The list components are: <code>mu.q.betaTilde</code>, the mean vector; <code>Sigma.q.betaTilde</code>, the covariance matrix.<br />
<code>gammaBeta</code> = a vector containing the Bernoulli q-density means of the linear component coefficients spike-and-slab auxiliary indicator variables.<br />
<code>sigmaBeta</code> = a vector with 2 entries, consisting of the Inverse Gamma q-density shape and rate parameters of the variance of the linear component coefficients.<br />
<code>rhoBeta</code> = a vector with 2 entries, consisting of the Beta q-density shape parameters of the Bernoulli probability parameter of the linear component coefficients spike-and-slab auxiliary indicator variables.<br />
<code>uTilde</code> = a two-component list containing the Multivariate Normal q-density parameters of the spline basis function coefficients without multiplication by the means of the <code>gammaU</code> q-densities. The list components are: <code>mu.q.uTilde</code>, the mean vectors for each predictor that is treated as potentially having a non-linear effect; <code>sigsq.q.uTilde</code>, the diagonal entries of the covariance matrices of each predictor that is treated as potentially having a non-linear effect.<br />
<code>gammaU</code> = a list containing the q-density means of the spline basis coefficients spike-and-slab auxiliary indicator variables. Each list component corresponds to a predictor that is treated as potentially having a non-linear effect.<br />
<code>rhoU</code> = a two-component list with components <code>A.q.rho.u</code> and <code>B.q.rho.u</code>. The <code>A.q.rho.u</code> list component is a vector of Beta q-density first (one plus the power of rho) shape parameters corresponding to the spline basis coefficients spike-and-slab auxiliary indicator variables for each predictor that is treated as potentially having a non-linear effect. The <code>B.q.rho.u</code> list component is a vector of Beta q-density second (one plus the power of 1-rho) shape parameters corresponding to the spline basis coefficients spike-and-slab auxiliary indicator variables for each predictor that is treated as potentially having a non-linear effect.<br />
<code>sigmaEps</code> = a vector with 2 entries, consisting of the Inverse Gamma q-density shape and rate parameters of the error variance.
</p>
</td></tr> 
<tr><td><code>effectTypeHat</code></td>
<td>
<p>an array of character strings, with entry either &quot;zero&quot;, &quot;linear&quot; or &quot;nonlinear&quot;, signifying the estimated effect type for each candidate predictor.</p>
</td></tr> 
<tr><td><code>meanXlinear</code></td>
<td>
<p>an array containing the sample means of each column of <code>Xlinear</code>.</p>
</td></tr> 
<tr><td><code>sdXlinear</code></td>
<td>
<p>an array containing the sample standard deviations of each column of <code>Xlinear</code>.</p>
</td></tr> 
<tr><td><code>meanXgeneral</code></td>
<td>
<p>an array containing the sample means of each column of <code>Xgeneral</code>.</p>
</td></tr> 
<tr><td><code>sdXgeneral</code></td>
<td>
<p>an array containing the sample standard deviations of each column of <code>Xgeneral</code>.</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Virginia X. He <a href="mailto:virginia.x.he@student.uts.edu.au">virginia.x.he@student.uts.edu.au</a> and Matt P. Wand <a href="mailto:matt.wand@uts.edu.au">matt.wand@uts.edu.au</a></p>


<h3>References</h3>

<p>Chouldechova, A. and Hastie, T. (2015). Generalized additive model selection. &lt;arXiv:1506.03850v2&gt;.
</p>
<p>He, V.X. and Wand, M.P. (2021). Bayesian generalized additive model selection including a fast variational option. &lt;arXiv:2021.PLACE-HOLDER&gt;. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(gamselBayes) 

# Generate some simple regression-type data:

set.seed(1) ; n &lt;- 1000 ; x1 &lt;- rbinom(n,1,0.5) ; 
x2 &lt;- runif(n) ; x3 &lt;- runif(n) ; x4 &lt;- runif(n)
y &lt;- x1 + sin(2*pi*x2) - x3 + rnorm(n)
Xlinear &lt;- data.frame(x1) ; Xgeneral &lt;- data.frame(x2,x3,x4)

# Obtain a gamselBayes() fit for the data, using Markov chain Monte Carlo:

fitMCMC &lt;- gamselBayes(y,Xlinear,Xgeneral)
summary(fitMCMC) ; plot(fitMCMC) ; checkChains(fitMCMC)

# Obtain a gamselBayes() fit for the data, using mean field variational Bayes:

fitMFVB &lt;- gamselBayes(y,Xlinear,Xgeneral,method = "MFVB")
summary(fitMFVB) ; plot(fitMFVB)

if (require("Ecdat"))
{
   # Obtain a gamselBayes() fit for data on schools in California, U.S.A.:

   Caschool$log.avginc &lt;- log(Caschool$avginc)
   mathScore &lt;- Caschool$mathscr
   Xgeneral &lt;- Caschool[,c("mealpct","elpct","calwpct","compstu","log.avginc")]

   # Obtain a gamselBayes() fit for the data, using Markov chain Monte Carlo:

   fitMCMC &lt;- gamselBayes(y = mathScore,Xgeneral = Xgeneral)
   summary(fitMCMC) ; plot(fitMCMC) ; checkChains(fitMCMC)

   # Obtain a gamselBayes() fit for the data, using mean field variational Bayes:

   fitMFVB &lt;- gamselBayes(y = mathScore,Xgeneral = Xgeneral,method = "MFVB")
   summary(fitMFVB) ; plot(fitMFVB)
}
</code></pre>

<hr>
<h2 id='gamselBayes.control'>Controlling Bayesian generalized additive model selection</h2><span id='topic+gamselBayes.control'></span>

<h3>Description</h3>

<p>Function for optional use in calls to <code>gamselBayes()</code> to control spline basis dimension, hyperparameter choice and other specifications for generalized additive model selection via using Bayesian inference.</p>


<h3>Usage</h3>

<pre><code class='language-R'>gamselBayes.control(numIntKnots = 25,truncateBasis = TRUE,numBasis = 12,
                    sigmabeta0 = 100000,sbeta = 1000,sepsilon = 1000,
                    su= 1000,rhoBeta = 0.5,rhoU = 0.5,nWarm = 1000,
                    nKept = 1000,nThin = 1,maxIter = 1000,toler = 1e-8,
                    msgCode = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gamselBayes.control_+3A_numintknots">numIntKnots</code></td>
<td>
<p>The number of interior knots used in construction of the Demmler-Reinsch spline basis functions. The value of <code>numIntKnots</code> must be an integer between 8 and 50.</p>
</td></tr>
<tr><td><code id="gamselBayes.control_+3A_truncatebasis">truncateBasis</code></td>
<td>
<p>Boolean flag:<br />
TRUE = truncate the Demmler-Reinsch spline basis to the value specified by <code>numBasis</code> (the default)<br />
FALSE = produce a black-and-white version of the graphical check.</p>
</td></tr>
<tr><td><code id="gamselBayes.control_+3A_numbasis">numBasis</code></td>
<td>
<p>The number of spline basis functions retained after truncation when <code>truncateBasis</code> is <code>TRUE</code>. The value of <code>numBasis</code> cannot exceed <code>numIntKnots</code>+2. The default value of <code>numBasis</code> is 12.</p>
</td></tr> 
<tr><td><code id="gamselBayes.control_+3A_sigmabeta0">sigmabeta0</code></td>
<td>
<p>The standard deviation hyperparameter for the Normal prior distribution on the intercept parameter for the standardized version of the data used in Bayesian inference. The default is 100000.</p>
</td></tr> 
<tr><td><code id="gamselBayes.control_+3A_sbeta">sbeta</code></td>
<td>
<p>The standard deviation hyperparameter for the Normal prior distribution on the linear component coefficients parameters for the standardized version of the data used in Bayesian inference. The default is 1000.</p>
</td></tr> 
<tr><td><code id="gamselBayes.control_+3A_sepsilon">sepsilon</code></td>
<td>
<p>The scale hyperparameter for the Half-Cauchy prior distribution on the error standard deviation parameter for the standardized version of the data used in Bayesian inference. The default is 1000.</p>
</td></tr>
<tr><td><code id="gamselBayes.control_+3A_su">su</code></td>
<td>
<p>The scale hyperparameter for the Half-Cauchy prior distribution on the spline basis coefficients standard deviation parameter for the standardized version of the data used in Bayesian inference. The default is 1000.</p>
</td></tr>
<tr><td><code id="gamselBayes.control_+3A_rhobeta">rhoBeta</code></td>
<td>
<p>The probability parameter for the Bernoulli prior distribution on the linear component coefficients spike-and-slab auxiliary indicator variables probability parameter. The default is 0.5.</p>
</td></tr>
<tr><td><code id="gamselBayes.control_+3A_rhou">rhoU</code></td>
<td>
<p>The probability parameter for the Bernoulli prior distribution on the spline basis coefficients spike-and-slab auxiliary indicator variables probability parameter. The default is 0.5.</p>
</td></tr>
<tr><td><code id="gamselBayes.control_+3A_nwarm">nWarm</code></td>
<td>
<p>The size of the Markov chain Monte Carlo warmup, a positive integer, when method is Markov chain Monte Carlo. The default is 1000.</p>
</td></tr>
<tr><td><code id="gamselBayes.control_+3A_nkept">nKept</code></td>
<td>
<p>The size of the kept Markov chain Monte Carlo samples, a positive integer, when the method is Markov chain Monte Carlo. The default is 1000.</p>
</td></tr>
<tr><td><code id="gamselBayes.control_+3A_nthin">nThin</code></td>
<td>
<p>The thinning factor for the kept Markov chain Monte Carlo samples, a positive integer, when the method is Markov chain Monte Carlo. The default is 1.</p>
</td></tr>
<tr><td><code id="gamselBayes.control_+3A_maxiter">maxIter</code></td>
<td>
<p>The maximum number of mean field variational Bayes iterations, a positive integer, when the method is mean field variational Bayes. The default is 1000.</p>
</td></tr>
<tr><td><code id="gamselBayes.control_+3A_toler">toler</code></td>
<td>
<p>The convergence tolerance for mean field variational Bayes iterations, a positive number less than 0.5, when the method is mean field variational Bayes. Convergence is deemed to have occurred if the relative change in the logarithm of the approximate marginal likelihood falls below <code>toler</code>. The default is 1e-8.</p>
</td></tr>
<tr><td><code id="gamselBayes.control_+3A_msgcode">msgCode</code></td>
<td>
<p>Code for the nature of progress messages printed to the screen. If msgCode=0 then no progress messages are printed. If msgCode=1 then a messages printed each time approximately each 10% of the sampling is completed. If msgCode=2 then a messages printed each time approximately each 10% of the sampling is completed. The default is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing values of each of the seventeen control parameters, packaged to supply the <code>control</code> argument to <code>gamselBayes</code>. The values for <code>gamselBayes.control</code> can be specified in the call to <code>gamselBayes</code>.
</p>


<h3>Author(s)</h3>

<p>Virginia X. He <a href="mailto:virginia.x.he@student.uts.edu.au">virginia.x.he@student.uts.edu.au</a> and Matt P. Wand <a href="mailto:matt.wand@uts.edu.au">matt.wand@uts.edu.au</a></p>


<h3>References</h3>

<p>He, V.X. and Wand, M.P. (2021). 
Generalized additive model selection via Bayesian inference. Submitted.</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(gamselBayes) 

# Generate some simple regression-type data:

set.seed(1) ; n &lt;- 1000 ; x1 &lt;- rbinom(n,1,0.5)  
x2 &lt;- runif(n) ; x3 &lt;- runif(n) ; x4 &lt;- runif(n)
y &lt;- x1 + sin(2*pi*x2) - x3 + rnorm(n)
Xlinear &lt;- data.frame(x1) ; Xgeneral &lt;- data.frame(x2,x3,x4)

# Obtain a gamselBayes() fit for the data:

fit &lt;- gamselBayes(y,Xlinear,Xgeneral)
summary(fit) ; plot(fit) ; checkChains(fit)

# Now modify some of the control values:

fitControlled &lt;- gamselBayes(y,Xlinear,Xgeneral,control = gamselBayes.control(
                             numIntKnots = 35,truncateBasis = FALSE,
                             sbeta = 10000,su = 10000,nWarm = 2000,nKept = 1500))
summary(fitControlled) ; plot(fitControlled) ; checkChains(fitControlled)
</code></pre>

<hr>
<h2 id='gamselBayesUpdate'>Update a <code>gamselBayes()</code> fit object.</h2><span id='topic+gamselBayesUpdate'></span>

<h3>Description</h3>

<p>Facilitates updating of <code>gamselBayes</code> fit object when two key parameters controlling model selection are modified. Use of <code>gamselBayesUpdate()</code> allows for fast tweaking of such parameters without another, potentially time-consuming, call to <code>gamselBayes()</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>gamselBayesUpdate(fitObject,lowerMakesSparser = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gamselBayesUpdate_+3A_fitobject">fitObject</code></td>
<td>
<p><code>gamselBayes()</code> fit object.</p>
</td></tr>
<tr><td><code id="gamselBayesUpdate_+3A_lowermakessparser">lowerMakesSparser</code></td>
<td>
<p>A threshold parameter between 0 and 1, which is such that lower values lead to sparser fits.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>gamselBayesUpdate()</code> function is applicable when a <code>gamselBayes()</code> fit object has been obtained for particular data inputs <code>y</code>, <code>Xlinear</code> and <code>Xgeneral</code> (as well as other tuning-type inputs) and the analyst is interested in changing the value of the parameter that controls model selection. This parameter is named <code>lowerMakesSparser</code>, and is described above. A call to <code>gamselBayesUpdate()</code> with a new value of <code>lowerMakesSparse</code> produces an updated <code>gamselBayes()</code> fit object with, potentially, different effect type estimates.</p>


<h3>Value</h3>

<p>An object of class <code>gamselBayes</code> with the same components as those produced by the <code>gamselBayes()</code> function. See <code>help(gamselBayes)</code> for details.</p>


<h3>Author(s)</h3>

<p>Virginia X. He <a href="mailto:virginia.x.he@student.uts.edu.au">virginia.x.he@student.uts.edu.au</a> and Matt P. Wand <a href="mailto:matt.wand@uts.edu.au">matt.wand@uts.edu.au</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> 
library(gamselBayes) 

# Generate some regression-type data:

set.seed(1) ;  n &lt;- 5000  ; numPred &lt;- 15
Xgeneral &lt;- as.data.frame(matrix(runif(n*numPred),n,numPred))
names(Xgeneral) &lt;- paste("x",1:numPred,sep="")

y &lt;- as.vector(0.1 + 0.4*Xgeneral[,1] - 2*pnorm(3-6*Xgeneral[,2]) 
               - 0.9*Xgeneral[,4] + cos(3*pi*Xgeneral[,5]) + 2*rnorm(n))

# Obtain and assess a gamselBayes() fit:

fitOrig &lt;- gamselBayes(y,Xgeneral = Xgeneral)
summary(fitOrig) ; plot(fitOrig)
print(fitOrig$effectTypesHat)

# Update the gamselBayes() fit object with a new value of 
# the "lowerMakesSparser" parameter:

fitUpdated &lt;-  gamselBayesUpdate(fitOrig,lowerMakesSparser = 0.6)
summary(fitUpdated) ; plot(fitUpdated)
print(fitUpdated$effectTypesHat)

</code></pre>

<hr>
<h2 id='gamselBayesVignette'>Display the package's vignette.</h2><span id='topic+gamselBayesVignette'></span>

<h3>Description</h3>

<p>The vignette of the gamselBayes package is displayed using the default PDF file browser. It provides a detailed description of use of the package for Bayesian generalized additive model selection.</p>


<h3>Usage</h3>

<pre><code class='language-R'>gamselBayesVignette()
</code></pre>


<h3>Value</h3>

<p>Nothing is returned.</p>


<h3>Author(s)</h3>

<p>Virginia X. He <a href="mailto:virginia.x.he@student.uts.edu.au">virginia.x.he@student.uts.edu.au</a> and Matt P. Wand <a href="mailto:matt.wand@uts.edu.au">matt.wand@uts.edu.au</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>gamselBayesVignette()
</code></pre>

<hr>
<h2 id='plot.gamselBayes'>Plot components of the selected generalized additive model from a <code>gamselBayes()</code> fit</h2><span id='topic+plot.gamselBayes'></span>

<h3>Description</h3>

<p>The estimated non-linear components of the generalized additive model selected via <code>gamselBayes</code> are plotted.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gamselBayes'
plot(x,credLev = 0.95,gridSize = 251,nMC = 5000,varBand = TRUE,
     shade = TRUE,yscale = "response",rug = TRUE,rugSampSize = NULL,estCol = "darkgreen",
     varBandCol = NULL,rugCol = "dodgerblue",mfrow = NULL,xlim = NULL,ylim = NULL,
     xlab = NULL,ylab = NULL,mai = NULL,pages = NULL,cex.axis = 1.5,cex.lab = 1.5,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.gamselBayes_+3A_x">x</code></td>
<td>
<p>A <code>gamselBayes()</code> fit object.</p>
</td></tr>
<tr><td><code id="plot.gamselBayes_+3A_credlev">credLev</code></td>
<td>
<p>A number between 0 and 1 such that the credible interval band has (100*credLev)% approximate pointwise coverage. The default value is 0.95.</p>
</td></tr>
<tr><td><code id="plot.gamselBayes_+3A_gridsize">gridSize</code></td>
<td>
<p>A number of grid points used to display the density estimate curve and the pointwise credible interval band. The default value is 251.</p>
</td></tr>
<tr><td><code id="plot.gamselBayes_+3A_nmc">nMC</code></td>
<td>
<p>The size of the Monte Carlo sample, a positive integer, for carrying out approximate inference from the mean field variational Bayes-approximate posterior distributions when the method is mean field variational Bayes. The default value is 5000.</p>
</td></tr>
<tr><td><code id="plot.gamselBayes_+3A_varband">varBand</code></td>
<td>
<p>Boolean flag specifying whether or not a variability band is included:<br />
TRUE = add a pointwise approximate (100*credLev)% credible set variability band (the default)<br />
FALSE = only plot the density estimate, without a variability band.</p>
</td></tr>
<tr><td><code id="plot.gamselBayes_+3A_shade">shade</code></td>
<td>
<p>Boolean flag specifying whether or not the variability band is displayed using shading:<br />
TRUE = display the variability band using shading (the default)<br />
FALSE = display the variability band using dashed curves.</p>
</td></tr>
<tr><td><code id="plot.gamselBayes_+3A_yscale">yscale</code></td>
<td>
<p>Character string specifying the vertical axis scale for display of estimated non-linear functions:<br />
&quot;response&quot; = display on the response scale)<br />
&quot;link&quot; = display on the link scale.</p>
</td></tr>
<tr><td><code id="plot.gamselBayes_+3A_rug">rug</code></td>
<td>
<p>Boolean flag specifying whether or not rug-type displays for predictor data are used:<br />
TRUE = show the predictor data using rug-type displays (the default)<br />
FALSE = do not show the predictor data.</p>
</td></tr>
<tr><td><code id="plot.gamselBayes_+3A_rugsampsize">rugSampSize</code></td>
<td>
<p>The size of the random sample sample of each predictor to be used in rug-type displays.</p>
</td></tr>
<tr><td><code id="plot.gamselBayes_+3A_estcol">estCol</code></td>
<td>
<p>Colour of the density estimate curve. The default value is &quot;darkgreen&quot;.</p>
</td></tr>
<tr><td><code id="plot.gamselBayes_+3A_varbandcol">varBandCol</code></td>
<td>
<p>Colour of the pointwise credible interval variability band. If <code>shade</code>=TRUE then the default value is &quot;palegreen&quot;. If <code>shade</code>=FALSE then the default value is <code>estCol</code>.</p>
</td></tr>
<tr><td><code id="plot.gamselBayes_+3A_rugcol">rugCol</code></td>
<td>
<p>Colour of rug plot that shows values of the predictor data. The default value is &quot;dodgerblue&quot;.</p>
</td></tr>
<tr><td><code id="plot.gamselBayes_+3A_mfrow">mfrow</code></td>
<td>
<p>An optional two-entry vector for specifying the layout of the nonlinear fit displays.</p>
</td></tr>
<tr><td><code id="plot.gamselBayes_+3A_xlim">xlim</code></td>
<td>
<p>An optional two-column matrix for specification of horizontal frame limits in the plotting of the estimated non-linear predictor effects. The number of rows in <code>xlim</code> must equal length(effectTypesVector(x)==&quot;nonlin&quot;). If any of the rorows of <code>xlim</code> contain <code>NA</code> then the default horizontal frame limits value for that predictor is used. Therefore, if there are several predictors selected as non-linear and horizontal frame adjustments are required for a few of them then then <code>xlim</code> can be a matrix with mainly <code>NA</code> values, and with non-<code>NA</code> frame specification limits in the relevant rows.</p>
</td></tr> 
<tr><td><code id="plot.gamselBayes_+3A_ylim">ylim</code></td>
<td>
<p>The same as <code>xlim</code>, except for vertical frame limits.</p>
</td></tr>
<tr><td><code id="plot.gamselBayes_+3A_xlab">xlab</code></td>
<td>
<p>An optional vector of character strings containing labels for the horizontal axes. The number of entries in <code>xlab</code> must equal length(effectTypesVector(x)==&quot;nonlin&quot;).</p>
</td></tr>
<tr><td><code id="plot.gamselBayes_+3A_ylab">ylab</code></td>
<td>
<p>The same as <code>xlab</code>, except for vertical axis labels.</p>
</td></tr>
<tr><td><code id="plot.gamselBayes_+3A_mai">mai</code></td>
<td>
<p>An optional numerical vector of length 4 for specification of inner margin dimensions of each panel, ordered clockwise from below the panel.</p>
</td></tr>
<tr><td><code id="plot.gamselBayes_+3A_pages">pages</code></td>
<td>
<p>An optional positive integer that specifies the number of pages used to display the non-linear function estimates.</p>
</td></tr>
<tr><td><code id="plot.gamselBayes_+3A_cex.axis">cex.axis</code></td>
<td>
<p>An optional positive scalar value for specification of the character expansion factor for the axis values.</p>
</td></tr>
<tr><td><code id="plot.gamselBayes_+3A_cex.lab">cex.lab</code></td>
<td>
<p>An optional positive scalar value for specification of the character expansion factor for the labels.</p>
</td></tr>
<tr><td><code id="plot.gamselBayes_+3A_...">...</code></td>
<td>
<p>Place-holder for other graphical parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimated non-linear components of the selected generalized additive model are plotted. Each plot corresponds to a slice of the selected generalized additive model surface with all other predictors set to their median values. Pointwise credible intervals unless <code>varBand</code> is <code>FALSE</code>.</p>


<h3>Value</h3>

<p>Nothing is returned.</p>


<h3>Author(s)</h3>

<p>Virginia X. He <a href="mailto:virginia.x.he@student.uts.edu.au">virginia.x.he@student.uts.edu.au</a> and Matt P. Wand <a href="mailto:matt.wand@uts.edu.au">matt.wand@uts.edu.au</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(gamselBayes) 

# Generate some simple regression-type data:

set.seed(1) ; n &lt;- 1000 ; x1 &lt;- rbinom(n,1,0.5) ; 
x2 &lt;- runif(n) ; x3 &lt;- runif(n) ; x4 &lt;- runif(n)
y &lt;- x1 + sin(2*pi*x2) - x3 + rnorm(n)
Xlinear &lt;- data.frame(x1) ; Xgeneral &lt;- data.frame(x2,x3,x4)

# Obtain a gamselBayes() fit for the data and print out a summary:

fit &lt;- gamselBayes(y,Xlinear,Xgeneral)
summary(fit)

# Plot the predictor effect(s) estimated as being non-linear:

plot(fit)

# Plot the same fit(s) but with different colours and style:

plot(fit,shade = FALSE,estCol = "darkmagenta",varBandCol = "plum",
     rugCol = "goldenrod")

if (require("Ecdat"))
{
   # Obtain a gamselBayes() fit for data on schools in California, U.S.A.:

   Caschool$log.avginc &lt;- log(Caschool$avginc)
   mathScore &lt;- Caschool$mathscr
   Xgeneral &lt;- Caschool[,c("mealpct","elpct","calwpct","compstu","log.avginc")]
   fit &lt;- gamselBayes(y = mathScore,Xgeneral = Xgeneral)
   summary(fit)

   # Plot the predictor effect(s) estimated as being non-linear:

   plot(fit)
}
</code></pre>

<hr>
<h2 id='predict.gamselBayes'>Obtain predictions from a <code>gamselBayes()</code> fit</h2><span id='topic+predict.gamselBayes'></span>

<h3>Description</h3>

<p>The estimated non-linear components of the generalized additive model selected via <code>gamselBayes</code> are plotted.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gamselBayes'
predict(object,newdata,type = "response",...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.gamselBayes_+3A_object">object</code></td>
<td>
<p>A <code>gamselBayes()</code> fit object.</p>
</td></tr>
<tr><td><code id="predict.gamselBayes_+3A_newdata">newdata</code></td>
<td>
<p>A two-component list the following components:<br />
A data frame containing new data on the predictors that are only permitted to have a linear or zero effect and, if not NULL, must have the same names as the <code>Xlinear</code> component of <code>object</code>.<br /> 
A data frame containing new data for the predictors that are permitted to have a linear, nonlinear or zero effect and, if not NULL, must have the same names as the <code>Xgeneral</code> component of <code>object</code>.<br />
If both <code>Xlinear</code> and <code>Xgeneral</code> are not NULL then they must have the same numbers of rows.
</p>
</td></tr>
<tr><td><code id="predict.gamselBayes_+3A_type">type</code></td>
<td>
<p>A character string for specifying the type of prediction, with the following options:
&quot;link&quot;, &quot;response&quot; or &quot;terms&quot;, which leads to the value as described below.
</p>
</td></tr>
<tr><td><code id="predict.gamselBayes_+3A_...">...</code></td>
<td>
<p>A place-holder for other prediction parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector or data frame depending on the value of <code>type</code>:<br />
If <code>type</code>=&quot;link&quot; then the value is  a vector of linear predictor-scale fitted values.<br />
If <code>type</code>=&quot;response&quot; and <code>family</code>=&quot;binomial&quot; then the value is a vector of probability-scale fitted values.
Otherwise (i.e. <code>family</code>=&quot;binomial&quot;) the value is the vector of predictor-scale fitted values.<br />
If <code>type</code>=&quot;terms&quot; then the value is a  a data frame with number of columns equal to the total number of predictors. Each column is the contribution to the vector of linear predictor-scale fitted values from each predictor. These contributions do not include the intercept predicted value. The intercept predicted value is included as an attribute of the returned data frame.
</p>


<h3>Author(s)</h3>

<p>Virginia X. He <a href="mailto:virginia.x.he@student.uts.edu.au">virginia.x.he@student.uts.edu.au</a> and Matt P. Wand <a href="mailto:matt.wand@uts.edu.au">matt.wand@uts.edu.au</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> 
library(gamselBayes) 

# Generate some simple regression-type data:

n &lt;- 1000 ; x1 &lt;- rbinom(n,1,0.5) ; x2 &lt;- runif(n) ; x3 &lt;- runif(n) ; x4 &lt;- runif(n)
y &lt;- x1 + sin(2*pi*x2) - x3 + rnorm(n)
Xlinear &lt;- data.frame(x1) ; Xgeneral &lt;- data.frame(x2,x3,x4)
names(Xlinear) &lt;- c("x1") ; names(Xgeneral) &lt;- c("x2","x3","x4")

# Obtain and summarise a gamselBayes() fit for the data:

fit &lt;- gamselBayes(y,Xlinear,Xgeneral)
summary(fit)   

# Obtain some new data:

nNew &lt;- 10
x1new &lt;- rbinom(nNew,1,0.5) ; x2new &lt;- runif(nNew) ; x3new &lt;- runif(nNew) 
x4new &lt;- runif(nNew)
XlinearNew &lt;- data.frame(x1new) ; names(XlinearNew) &lt;- "x1"
XgeneralNew &lt;- data.frame(x2new,x3new,x4new)
names(XgeneralNew) &lt;- c("x2","x3","x4")

newdataList &lt;- list(XlinearNew,XgeneralNew)

# Obtain predictions at the new data:

predObjDefault &lt;- predict(fit,newdata=newdataList)
print(predObjDefault)
</code></pre>

<hr>
<h2 id='summary.gamselBayes'>Summarise components of the selected generalized additive model from a <code>gamselBayes()</code> fit</h2><span id='topic+summary.gamselBayes'></span>

<h3>Description</h3>

<p>Inference summaries of the estimated linear component coefficients of the generalized additive model selected via <code>gamselBayes</code> are tabulated.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gamselBayes'
summary(object,credLev = 0.95,sigFigs = 5,nMC = 10000,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.gamselBayes_+3A_object">object</code></td>
<td>
<p>A <code>gamselBayes()</code> fit object.</p>
</td></tr>
<tr><td><code id="summary.gamselBayes_+3A_credlev">credLev</code></td>
<td>
<p>A number between 0 and 1 such that the credible interval band has (100*credLev)% approximate pointwise coverage. The default value is 0.95.</p>
</td></tr>
<tr><td><code id="summary.gamselBayes_+3A_sigfigs">sigFigs</code></td>
<td>
<p>The number of significant figures used for the entries of the summary table.</p>
</td></tr>
<tr><td><code id="summary.gamselBayes_+3A_nmc">nMC</code></td>
<td>
<p>The size of the Monte Carlo sample, a positive integer, for carrying out approximate inference from the mean field variational Bayes-approximate posterior distributions when the method is mean field variational Bayes. The default value is 10000.</p>
</td></tr>
<tr><td><code id="summary.gamselBayes_+3A_...">...</code></td>
<td>
<p>Place-holder for other summary parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the selected generalized additive model has at least one predictor having a linear effect then a data frame is returned. The columns of the data correspond to posterior means and credible interval limits of the linear effects coefficients.</p>


<h3>Value</h3>

<p>A data frame containing linear effect Bayesian inferential summaries.</p>


<h3>Author(s)</h3>

<p>Virginia X. He <a href="mailto:virginia.x.he@student.uts.edu.au">virginia.x.he@student.uts.edu.au</a> and Matt P. Wand <a href="mailto:matt.wand@uts.edu.au">matt.wand@uts.edu.au</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(gamselBayes) 

# Generate some simple regression-type data:

set.seed(1) ; n &lt;- 1000 ; x1 &lt;- rbinom(n,1,0.5) ; 
x2 &lt;- runif(n) ; x3 &lt;- runif(n) ; x4 &lt;- runif(n)
y &lt;- x1 + sin(2*pi*x2) - x3 + rnorm(n)
Xlinear &lt;- data.frame(x1) ; Xgeneral &lt;- data.frame(x2,x3,x4)

# Obtain a gamselBayes() fit for the data and print out a summary:

fit &lt;- gamselBayes(y,Xlinear,Xgeneral)
summary(fit)

# Print the summary with different values of some of the arguments:

summary(fit,credLev=0.99,sigFigs=3)

if (require("Ecdat"))
{
   # Obtain a gamselBayes() fit for data on schools in California, U.S.A.:

   Caschool$log.avginc &lt;- log(Caschool$avginc)
   mathScore &lt;- Caschool$mathscr
   Xgeneral &lt;- Caschool[,c("mealpct","elpct","calwpct","compstu","log.avginc")]
   fit &lt;- gamselBayes(y = mathScore,Xgeneral = Xgeneral)
   summary(fit)
}
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
