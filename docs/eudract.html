<!DOCTYPE html><html><head><title>Help for package eudract</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {eudract}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#append_xml'><p>internal function to append rows to the output xml file</p></a></li>
<li><a href='#clintrials_gov_convert'><p>applies a conversion using xslt from a simple xml file to a ClinicalTrials.gov compatible file, and checks against the schema</p></a></li>
<li><a href='#clintrials_gov_upload'><p>applies a conversion using xslt from a simple xml file to a ClinicalTrials.gov compatible file, merges into a study record from the portal, and uploads the result.</p></a></li>
<li><a href='#create.safety_summary'><p>function that creates a safety_summary object from individual data.frames</p></a></li>
<li><a href='#df_to_char'><p>function to make a data frame be entirely character vectors</p></a></li>
<li><a href='#dot_plot'><p>creates a dot-plot of safety data showing the absolute and relative risks</p></a></li>
<li><a href='#eudract_convert'><p>applies a conversion using xslt from a simple xml file to a eudract compatible file, and checks against the schema</p></a></li>
<li><a href='#incidence_table'><p>provide standard structured tables to report incidence rates of AEs by arm</p></a></li>
<li><a href='#plot.dot_plot'><p>plot methods for dot_plot object</p></a></li>
<li><a href='#print.dot_plot'><p>print methods for dot_plot object</p></a></li>
<li><a href='#print.safety_summary'><p>print method for safety summary object</p></a></li>
<li><a href='#relative_risk'><p>Calculate relative risks to be reported or plotted as dot plot</p></a></li>
<li><a href='#safety'><p>Example of safety data</p></a></li>
<li><a href='#safety_summary'><p>Calculate frequency tables from a rectangular data frame with one row per subject-event</p></a></li>
<li><a href='#simple_safety_xml'><p>creates a simple xml file from the input of a safety_summary object</p></a></li>
<li><a href='#soc_code'><p>System Organ Class coding</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Creates Safety Results Summary in XML to Upload to EudraCT, or
ClinicalTrials.gov</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-14</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://eudract-tool.medschl.cam.ac.uk/">https://eudract-tool.medschl.cam.ac.uk/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/shug0131/eudraCT/issues">https://github.com/shug0131/eudraCT/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>The remit of the European Clinical Trials Data Base (EudraCT <a href="https://eudract.ema.europa.eu/">https://eudract.ema.europa.eu/</a> ), or ClinicalTrials.gov <a href="https://clinicaltrials.gov/">https://clinicaltrials.gov/</a>, is to provide open access to summaries of all registered clinical trial results; thus aiming to prevent non-reporting of negative results and provide open-access to results to inform future research. The amount of information required and the format of the results, however, imposes a large extra workload at the end of studies on clinical trial units. In particular, the adverse-event-reporting component requires entering: each unique combination of treatment group and safety event; for every such event above, a further 4 pieces of information (body system, number of occurrences, number of subjects, number exposed) for non-serious events, plus an extra three pieces of data for serious adverse events (numbers of causally related events, deaths, causally related deaths). This package prepares the required statistics needed by EudraCT and formats them into the precise requirements to directly upload an XML file into the web portal, with no further data entry by hand.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, httr, magrittr, patchwork, scales, tidyr,
utils, xml2, xslt</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, knitr, rmarkdown, stringr, testthat, tools, vdiffr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-14 14:27:44 UTC; rstudio</td>
</tr>
<tr>
<td>Author:</td>
<td>Simon Bond [cre],
  Beatrice Pantaleo [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Simon Bond &lt;simon.bond7@nhs.net&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-18 08:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='append_xml'>internal function to append rows to the output xml file</h2><span id='topic+append_xml'></span>

<h3>Description</h3>

<p>internal function to append rows to the output xml file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>append_xml(data, file_connection)
</code></pre>

<hr>
<h2 id='clintrials_gov_convert'>applies a conversion using xslt from a simple xml file to a ClinicalTrials.gov compatible file, and checks against the schema</h2><span id='topic+clintrials_gov_convert'></span>

<h3>Description</h3>

<p>applies a conversion using xslt from a simple xml file to a ClinicalTrials.gov compatible file, and checks against the schema
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clintrials_gov_convert(
  input,
  original,
  output,
  xslt = system.file("extdata", "simpleToCtGov.xslt", package = "eudract"),
  schema_input = system.file("extdata", "simple.xsd", package = "eudract"),
  schema_results = system.file("extdata", "RRSUploadSchema.xsd", package = "eudract"),
  schema_output = system.file("extdata", "ProtocolRecordSchema.xsd", package = "eudract"),
  soc = system.file("extdata", "soc.xml", package = "eudract")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clintrials_gov_convert_+3A_input">input</code></td>
<td>
<p>a character string giving the file path to the simple xml file</p>
</td></tr>
<tr><td><code id="clintrials_gov_convert_+3A_original">original</code></td>
<td>
<p>a character string giving the file path to the study file downloaded from ClinicalTrials.gov</p>
</td></tr>
<tr><td><code id="clintrials_gov_convert_+3A_output">output</code></td>
<td>
<p>a character string naming the output file</p>
</td></tr>
<tr><td><code id="clintrials_gov_convert_+3A_xslt">xslt</code></td>
<td>
<p>a character string giving the file path to the xslt script. Defaults to the script provided in this package</p>
</td></tr>
<tr><td><code id="clintrials_gov_convert_+3A_schema_input">schema_input</code></td>
<td>
<p>a character string giving the file path to the schema for the simple xml file. Defaults to the schema provided in this package</p>
</td></tr>
<tr><td><code id="clintrials_gov_convert_+3A_schema_results">schema_results</code></td>
<td>
<p>a character string giving the file path to the schema for the results section of the output. A copy was downloaded and is provided in this package as the default.</p>
</td></tr>
<tr><td><code id="clintrials_gov_convert_+3A_schema_output">schema_output</code></td>
<td>
<p>a character string giving the file path to the schema for the overall output. A copy was downloaded and is provided in this package as the default.</p>
</td></tr>
<tr><td><code id="clintrials_gov_convert_+3A_soc">soc</code></td>
<td>
<p>a character string giving an xml file that contains the System Organ Class look-up table going from EudraCT numbers to ClinicalTrials words.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the output from the validation against the schema. A new file is created as a side-effect, which is suitable to upload into ClinicalTrials.gov. This over-writes the file given in <code>original</code> with the additional safety events.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+safety_summary">safety_summary</a></code> <code><a href="#topic+simple_safety_xml">simple_safety_xml</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>safety_statistics &lt;- safety_summary(safety,
                                    exposed=c("Experimental"=60,"Control"=67))
simple &lt;- tempfile(fileext = ".xml")
eudract &lt;- tempfile(fileext = ".xml")
ct &lt;- tempfile(fileext = ".xml")
simple_safety_xml(safety_statistics, simple)
eudract_convert(input=simple,
                output=eudract)
clintrials_gov_convert(input=simple,
                       original=system.file("extdata", "1234.xml", package ="eudract"),
                output=ct)
## Not run: 
  # This needs a real user account to work
  clintrials_gov_upload(
    input=simple,
    orgname="CTU",
    username="Student",
    password="Guinness",
    studyid="1234"
    )


## End(Not run)
</code></pre>

<hr>
<h2 id='clintrials_gov_upload'>applies a conversion using xslt from a simple xml file to a ClinicalTrials.gov compatible file, merges into a study record from the portal, and uploads the result.</h2><span id='topic+clintrials_gov_upload'></span>

<h3>Description</h3>

<p>applies a conversion using xslt from a simple xml file to a ClinicalTrials.gov compatible file, merges into a study record from the portal, and uploads the result.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clintrials_gov_upload(
  input,
  orgname,
  username,
  password,
  studyid,
  url = "https://register.clinicaltrials.gov/",
  check = interactive(),
  output = "study_file.xml",
  backup = "bak_study_file.xml",
  xslt = system.file("extdata", "simpleToCtGov.xslt", package = "eudract"),
  schema_input = system.file("extdata", "simple.xsd", package = "eudract"),
  schema_results = system.file("extdata", "RRSUploadSchema.xsd", package = "eudract"),
  schema_output = system.file("extdata", "ProtocolRecordSchema.xsd", package = "eudract"),
  soc = system.file("extdata", "soc.xml", package = "eudract")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clintrials_gov_upload_+3A_input">input</code></td>
<td>
<p>a character string giving the file path to the simple xml file</p>
</td></tr>
<tr><td><code id="clintrials_gov_upload_+3A_orgname">orgname</code></td>
<td>
<p>a character string giving the organisation name used to log in</p>
</td></tr>
<tr><td><code id="clintrials_gov_upload_+3A_username">username</code></td>
<td>
<p>a character string giving the user-name used to log in</p>
</td></tr>
<tr><td><code id="clintrials_gov_upload_+3A_password">password</code></td>
<td>
<p>a character string giving the password used to log in</p>
</td></tr>
<tr><td><code id="clintrials_gov_upload_+3A_studyid">studyid</code></td>
<td>
<p>a character string given the unique study id within the portal</p>
</td></tr>
<tr><td><code id="clintrials_gov_upload_+3A_url">url</code></td>
<td>
<p>a character string giving the URL of the website to log in. Defaults to the live site, but the testing site is the alternative.</p>
</td></tr>
<tr><td><code id="clintrials_gov_upload_+3A_check">check</code></td>
<td>
<p>a logical that will check on the command line if you want to proceed as results will be overwritten. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="clintrials_gov_upload_+3A_output">output</code></td>
<td>
<p>a character string naming the output xml file</p>
</td></tr>
<tr><td><code id="clintrials_gov_upload_+3A_backup">backup</code></td>
<td>
<p>a character string naming the copy of the original data that is created.</p>
</td></tr>
<tr><td><code id="clintrials_gov_upload_+3A_xslt">xslt</code></td>
<td>
<p>a character string giving the file path to the xslt script. Defaults to the script provided in this package</p>
</td></tr>
<tr><td><code id="clintrials_gov_upload_+3A_schema_input">schema_input</code></td>
<td>
<p>a character string giving the file path to the schema for the simple xml file. Defaults to the schema provided in this package</p>
</td></tr>
<tr><td><code id="clintrials_gov_upload_+3A_schema_results">schema_results</code></td>
<td>
<p>a character string giving the file path to the schema for the results section of the output. A copy was downloaded and is provided in this package as the default.</p>
</td></tr>
<tr><td><code id="clintrials_gov_upload_+3A_schema_output">schema_output</code></td>
<td>
<p>a character string giving the file path to the schema for the overall output. A copy was downloaded and is provided in this package as the default.</p>
</td></tr>
<tr><td><code id="clintrials_gov_upload_+3A_soc">soc</code></td>
<td>
<p>a character string giving an xml file that contains the System Organ Class look-up table going from EudraCT numbers to ClinicalTrials words.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns the results from the two API with the portal <code><a href="httr.html#topic+response">response</a></code>, <code><a href="httr.html#topic+POST">POST</a></code>  .  A new file is created as a side-effect, which is uploaded into ClinicalTrials.gov. This over-writes the original safety data online with the additional safety events. A backup copy of the original data is also saved.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+safety_summary">safety_summary</a></code> <code><a href="#topic+simple_safety_xml">simple_safety_xml</a></code> [ClinicalTrials.gov manual](https://prsinfo.clinicaltrials.gov/prs-users-guide.html#section10)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>safety_statistics &lt;- safety_summary(safety,
                                    exposed=c("Experimental"=60,"Control"=67))
simple &lt;- tempfile(fileext = ".xml")
eudract &lt;- tempfile(fileext = ".xml")
ct &lt;- tempfile(fileext = ".xml")
simple_safety_xml(safety_statistics, simple)
eudract_convert(input=simple,
                output=eudract)
clintrials_gov_convert(input=simple,
                       original=system.file("extdata", "1234.xml", package ="eudract"),
                output=ct)
## Not run: 
  # This needs a real user account to work
  clintrials_gov_upload(
    input=simple,
    orgname="CTU",
    username="Student",
    password="Guinness",
    studyid="1234"
    )


## End(Not run)
</code></pre>

<hr>
<h2 id='create.safety_summary'>function that creates a safety_summary object from individual data.frames</h2><span id='topic+create.safety_summary'></span>

<h3>Description</h3>

<p>function that creates a safety_summary object from individual data.frames
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.safety_summary(group, non_serious, serious)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create.safety_summary_+3A_group">group</code></td>
<td>
<p>a data frame that contains the group-level statistics</p>
</td></tr>
<tr><td><code id="create.safety_summary_+3A_non_serious">non_serious</code></td>
<td>
<p>a data frame that contains the non-serious term-group level statistics</p>
</td></tr>
<tr><td><code id="create.safety_summary_+3A_serious">serious</code></td>
<td>
<p>a data frame that contains the serious term-group level statistics</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a safety_summary object
</p>

<hr>
<h2 id='df_to_char'>function to make a data frame be entirely character vectors</h2><span id='topic+df_to_char'></span>

<h3>Description</h3>

<p>function to make a data frame be entirely character vectors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_to_char(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="df_to_char_+3A_df">df</code></td>
<td>
<p>a data frame</p>
</td></tr>
</table>

<hr>
<h2 id='dot_plot'>creates a dot-plot of safety data showing the absolute and relative risks</h2><span id='topic+dot_plot'></span>

<h3>Description</h3>

<p>creates a dot-plot of safety data showing the absolute and relative risks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dot_plot(
  safety,
  type = c("non_serious", "serious"),
  reference = safety$GROUP$title[1],
  size = 95,
  text_width = 10,
  base = 2,
  valid_estimates = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dot_plot_+3A_safety">safety</code></td>
<td>
<p>an object created by <code><a href="#topic+safety_summary">safety_summary</a></code> or by <code><a href="#topic+relative_risk">relative_risk</a></code>, in case you want to re-order or filter the choice of rows.</p>
</td></tr>
<tr><td><code id="dot_plot_+3A_type">type</code></td>
<td>
<p>a choice of &quot;non_serious&quot; (default) or &quot;serious&quot; as to which type of AE to report on</p>
</td></tr>
<tr><td><code id="dot_plot_+3A_reference">reference</code></td>
<td>
<p>character vector naming the reference arm for the calculations. 
Defaults to the first row of the safety$GROUP.</p>
</td></tr>
<tr><td><code id="dot_plot_+3A_size">size</code></td>
<td>
<p>a number between 0-100, giving the size of the confidence interval. 
Default is 95.</p>
</td></tr>
<tr><td><code id="dot_plot_+3A_text_width">text_width</code></td>
<td>
<p>Integer giving a target width to which the labels are wrapped. Defaults to 10.</p>
</td></tr>
<tr><td><code id="dot_plot_+3A_base">base</code></td>
<td>
<p>numeric value to which a log scale uses as tick marks. Suggest powers of 2, or 5.</p>
</td></tr>
<tr><td><code id="dot_plot_+3A_valid_estimates">valid_estimates</code></td>
<td>
<p>a logical, which determines if only terms with valid estimates of relative risk are included in the table.
The alternative is to include terms with zeroes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is essentially a list of two ggplot objects joined together in a list, named
as &quot;left.panel&quot; and &quot;right.panel&quot;. 
They can each be individually edited if needed
</p>


<h3>Value</h3>

<p>a graphical object that shows the estimates and CI of relative and absolute risk.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+safety_summary">safety_summary</a></code> <code><a href="#topic+relative_risk">relative_risk</a></code> [relative_risks()]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>safety_statistics &lt;- safety_summary(safety,
           exposed=c("Experimental"=60,"Control"=67))
head( relative_risk(safety_statistics, type="serious") )
fig &lt;- dot_plot(safety_statistics, type="non_serious", base=4)
fig
fig$left.panel &lt;- fig$left.panel + ggplot2::labs(title="Absolute Risk")
fig
temp &lt;- tempfile(fileext=".png")
png(filename = temp)
print(fig)
dev.off()

</code></pre>

<hr>
<h2 id='eudract_convert'>applies a conversion using xslt from a simple xml file to a eudract compatible file, and checks against the schema</h2><span id='topic+eudract_convert'></span>

<h3>Description</h3>

<p>applies a conversion using xslt from a simple xml file to a eudract compatible file, and checks against the schema
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eudract_convert(
  input,
  output,
  xslt = system.file("extdata", "simpleToEudraCT.xslt", package = "eudract"),
  schema_input = system.file("extdata", "simple.xsd", package = "eudract"),
  schema_output = system.file("extdata", "adverseEvents.xsd", package = "eudract")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eudract_convert_+3A_input">input</code></td>
<td>
<p>a character string giving the file path to the simple xml file</p>
</td></tr>
<tr><td><code id="eudract_convert_+3A_output">output</code></td>
<td>
<p>a character string naming the output file</p>
</td></tr>
<tr><td><code id="eudract_convert_+3A_xslt">xslt</code></td>
<td>
<p>a character string giving the file path to the xslt script. Defaults to the script provided in this package</p>
</td></tr>
<tr><td><code id="eudract_convert_+3A_schema_input">schema_input</code></td>
<td>
<p>a character string giving the file path to the schema for the simple xml file. Defaults to the schema provided in this package</p>
</td></tr>
<tr><td><code id="eudract_convert_+3A_schema_output">schema_output</code></td>
<td>
<p>a character string giving the file path to the schema. A copy was downloaded and is provided in this package as the default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the output from the validation against the schema. A new file is created as a side-effect, which is suitable to upload into eudraCT.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+safety_summary">safety_summary</a></code> <code><a href="#topic+simple_safety_xml">simple_safety_xml</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>safety_statistics &lt;- safety_summary(safety,
                                    exposed=c("Experimental"=60,"Control"=67))
simple &lt;- tempfile(fileext = ".xml")
eudract &lt;- tempfile(fileext = ".xml")
ct &lt;- tempfile(fileext = ".xml")
simple_safety_xml(safety_statistics, simple)
eudract_convert(input=simple,
                output=eudract)
clintrials_gov_convert(input=simple,
                       original=system.file("extdata", "1234.xml", package ="eudract"),
                output=ct)
## Not run: 
  # This needs a real user account to work
  clintrials_gov_upload(
    input=simple,
    orgname="CTU",
    username="Student",
    password="Guinness",
    studyid="1234"
    )


## End(Not run)
</code></pre>

<hr>
<h2 id='incidence_table'>provide standard structured tables to report incidence rates of AEs by arm</h2><span id='topic+incidence_table'></span>

<h3>Description</h3>

<p>provide standard structured tables to report incidence rates of AEs by arm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incidence_table(safety, type = c("non_serious", "serious"), percent_round = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="incidence_table_+3A_safety">safety</code></td>
<td>
<p>an object created by <code><a href="#topic+safety_summary">safety_summary</a></code></p>
</td></tr>
<tr><td><code id="incidence_table_+3A_type">type</code></td>
<td>
<p>a choice of &quot;non_serious&quot; (default) or &quot;serious&quot; as to which type of AE to report on</p>
</td></tr>
<tr><td><code id="incidence_table_+3A_percent_round">percent_round</code></td>
<td>
<p>integer giving the number of decimal places to round the incidence
percentage. Default of 0. Maybe you need more if there is a large sample size 
and a rare event of interest</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame that can be directly printed as a table to a report.  Each arm has its own column
and the text contains &quot;p% (r, o)&quot;,  where r is the number of participants with the term, 
o is the number of occurrences, and p a percentage of participants with the term.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+safety_summary">safety_summary</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>safety_statistics &lt;- safety_summary(safety,
           exposed=c("Experimental"=60,"Control"=67))
head( incidence_table(safety_statistics, type="serious") )
</code></pre>

<hr>
<h2 id='plot.dot_plot'>plot methods for dot_plot object</h2><span id='topic+plot.dot_plot'></span>

<h3>Description</h3>

<p>plot methods for dot_plot object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dot_plot'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.dot_plot_+3A_x">x</code></td>
<td>
<p>dot_plot object</p>
</td></tr>
<tr><td><code id="plot.dot_plot_+3A_...">...</code></td>
<td>
<p>other arguments for generic methods</p>
</td></tr>
</table>

<hr>
<h2 id='print.dot_plot'>print methods for dot_plot object</h2><span id='topic+print.dot_plot'></span>

<h3>Description</h3>

<p>print methods for dot_plot object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dot_plot'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.dot_plot_+3A_x">x</code></td>
<td>
<p>dot_plot object</p>
</td></tr>
<tr><td><code id="print.dot_plot_+3A_...">...</code></td>
<td>
<p>other arguments for generic methods</p>
</td></tr>
</table>

<hr>
<h2 id='print.safety_summary'>print method for safety summary object</h2><span id='topic+print.safety_summary'></span>

<h3>Description</h3>

<p>print method for safety summary object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'safety_summary'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.safety_summary_+3A_x">x</code></td>
<td>
<p>a safety_summary object</p>
</td></tr>
<tr><td><code id="print.safety_summary_+3A_...">...</code></td>
<td>
<p>extra arguments for the generic print method</p>
</td></tr>
</table>

<hr>
<h2 id='relative_risk'>Calculate relative risks to be reported or plotted as dot plot</h2><span id='topic+relative_risk'></span><span id='topic+relative_risk_table'></span><span id='topic+order_filter'></span>

<h3>Description</h3>

<p>Calculate relative risks to be reported or plotted as dot plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>relative_risk(
  safety,
  type = c("non_serious", "serious"),
  reference = safety$GROUP$title[1],
  size = 95
)

relative_risk_table(
  safety,
  type = c("non_serious", "serious"),
  reference = safety$GROUP$title[1],
  size = 95,
  digits = 3,
  valid_estimates = TRUE
)

order_filter(rel_risk, threshold = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="relative_risk_+3A_safety">safety</code></td>
<td>
<p>an object created by <code><a href="#topic+safety_summary">safety_summary</a></code></p>
</td></tr>
<tr><td><code id="relative_risk_+3A_type">type</code></td>
<td>
<p>a choice of &quot;non_serious&quot; (default) or &quot;serious&quot; as to which type of AE to report on</p>
</td></tr>
<tr><td><code id="relative_risk_+3A_reference">reference</code></td>
<td>
<p>character vector naming the reference arm for the calculations. 
Defaults to the first row of the safety$GROUP.</p>
</td></tr>
<tr><td><code id="relative_risk_+3A_size">size</code></td>
<td>
<p>a number between 0-100, giving the size of the confidence interval. 
Default is 95.</p>
</td></tr>
<tr><td><code id="relative_risk_+3A_digits">digits</code></td>
<td>
<p>integer giving the number of significant figures to report to. Default of 3.</p>
</td></tr>
<tr><td><code id="relative_risk_+3A_valid_estimates">valid_estimates</code></td>
<td>
<p>a logical, which determines if only terms with valid estimates of relative risk are included in the table.
The alternative is to include terms with zeroes.</p>
</td></tr>
<tr><td><code id="relative_risk_+3A_rel_risk">rel_risk</code></td>
<td>
<p>a relative risk object</p>
</td></tr>
<tr><td><code id="relative_risk_+3A_threshold">threshold</code></td>
<td>
<p>a threshold on the percent scale, the max percentage for a term the incidence rate needs to exceed</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>relative_risk</code> returns of list of three items. &quot;relative_risk&quot; a data.frame that has the relative risk estimate and confidence intervals. 
&quot;percentage&quot; a data.frame with absolute percentages. &quot;GROUP&quot; a copy from the original <code>safety_summary</code> object.
No adjustment made to deal with zeroes. This is suitable input for the <code>dot_plot</code> function, and in most cases will not be 
used directly, but may potentially be modified with filtration, or editing of terms, see <code>order_filter</code>.
</p>
<p><code>relative_risk_table</code> returns a data frame that is suitable for printing to a report, giving relative risks
</p>
<p><code>order_filter</code> returns a revised relative risk object, with the terms concatenated with SOC if there are any duplicates, 
then ordered by relative risk, into a factor, and filtered to only those terms with an incidence rate above
the threshold.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+safety_summary">safety_summary</a></code> <code><a href="#topic+dot_plot">dot_plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>safety_statistics &lt;- safety_summary(safety,
           exposed=c("Experimental"=60,"Control"=67))
head( relative_risk(safety_statistics, type="serious") )
relative_risk_table(safety_statistics, type="serious")
rr &lt;- relative_risk(safety_statistics)
rr2 &lt;- order_filter(rr, threshold=2)
dot_plot(rr2)
</code></pre>

<hr>
<h2 id='safety'>Example of safety data</h2><span id='topic+safety'></span>

<h3>Description</h3>

<p>A dataset containing some example data of safety event in raw source format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>safety
</code></pre>


<h3>Format</h3>

<p>a data frame with 8 columns and 16 rows
</p>

<dl>
<dt>pt</dt><dd><p>meddra preferred term code</p>
</dd>
<dt>subjid</dt><dd><p>a unique subject identifier</p>
</dd>
<dt>related</dt><dd><p>a logical indicating if the event is related to the treatment</p>
</dd>
<dt>soc</dt><dd><p>the meddra code for the System Organ Class</p>
</dd>
<dt>fatal</dt><dd><p>a numerical 0/1 to indicate if the event was fatal</p>
</dd>
<dt>serious</dt><dd><p>a numerical 0/1 to indicate if the event was serious</p>
</dd>
<dt>group</dt><dd><p>the treatment group for the subject</p>
</dd>
<dt>term</dt><dd><p>a text description of the event. Needs to be matching 1-1 with the pt code</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data contains one row per patient-event. So the numbers exposed in each arm cannot be inferred from these data,
as patients with no events will not be included in these data.
</p>
<p>The variable names and formats are those required by <code><a href="#topic+safety_summary">safety_summary</a></code>. The variable <code>pt</code> is not strictly required.
An alternative to <code>soc</code> would be the equivalent character string from <code><a href="#topic+soc_code">soc_code</a></code>
</p>

<hr>
<h2 id='safety_summary'>Calculate frequency tables from a rectangular data frame with one row per subject-event</h2><span id='topic+safety_summary'></span>

<h3>Description</h3>

<p>Calculate frequency tables from a rectangular data frame with one row per subject-event
</p>


<h3>Usage</h3>

<pre><code class='language-R'>safety_summary(
  data,
  exposed,
  excess_deaths = 0,
  freq_threshold = 0,
  soc_index = c("meddra", "soc_term"),
  na.action = na.fail
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="safety_summary_+3A_data">data</code></td>
<td>
<p>a data set containing the following columns: <code>subjid, term, soc, serious, related, fatal, group</code>.
See <code><a href="#topic+safety">safety</a></code> for more details.</p>
</td></tr>
<tr><td><code id="safety_summary_+3A_exposed">exposed</code></td>
<td>
<p>a numeric vector giving the numbers of subjects exposed in each group.
This needs to be supplied directly by the user, and cannot be inferred from the input <code>data</code>
with one row per patient-event.
To ensure the ordering is correct either, name the vector with names matching the values in <code>data$group</code>, or
ensure that the data$group is an ordered factor, or relying on alphabetical ordering of the values in
<code>data$group</code></p>
</td></tr>
<tr><td><code id="safety_summary_+3A_excess_deaths">excess_deaths</code></td>
<td>
<p>a numeric vector giving the number of extra deaths not reported within <code>data</code>. Defaults to 0.</p>
</td></tr>
<tr><td><code id="safety_summary_+3A_freq_threshold">freq_threshold</code></td>
<td>
<p>a value on a percentage scale at which to remove events if the incidence falls below. Defaults to 0</p>
</td></tr>
<tr><td><code id="safety_summary_+3A_soc_index">soc_index</code></td>
<td>
<p>a character vector either &quot;meddra&quot; or &quot;soc_term&quot;, which is used to identify if the soc variable in data gives the numerical meddra code or the description in English.</p>
</td></tr>
<tr><td><code id="safety_summary_+3A_na.action">na.action</code></td>
<td>
<p>a function that indicates what should happen if the data contain missing values. The default is <code><a href="stats.html#topic+na.fail">na.fail</a></code>  as both repositories will not accept any missing values in the upload. Alternatives could be <code><a href="stats.html#topic+na.omit">na.omit</a></code>, <code><a href="stats.html#topic+na.exclude">na.exclude</a></code>, or <code><a href="stats.html#topic+na.pass">na.pass</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of three dataframes: GROUP, SERIOUS, NON_SERIOUS. Each contains the summary statistics required by EudraCT, and is suitable for export.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eudract_convert">eudract_convert</a></code> <code><a href="#topic+simple_safety_xml">simple_safety_xml</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>safety_statistics &lt;- safety_summary(safety,
                                    exposed=c("Experimental"=60,"Control"=67))
simple &lt;- tempfile(fileext = ".xml")
eudract &lt;- tempfile(fileext = ".xml")
ct &lt;- tempfile(fileext = ".xml")
simple_safety_xml(safety_statistics, simple)
eudract_convert(input=simple,
                output=eudract)
clintrials_gov_convert(input=simple,
                       original=system.file("extdata", "1234.xml", package ="eudract"),
                output=ct)
## Not run: 
  # This needs a real user account to work
  clintrials_gov_upload(
    input=simple,
    orgname="CTU",
    username="Student",
    password="Guinness",
    studyid="1234"
    )


## End(Not run)
</code></pre>

<hr>
<h2 id='simple_safety_xml'>creates a simple xml file from the input of a safety_summary object</h2><span id='topic+simple_safety_xml'></span>

<h3>Description</h3>

<p>creates a simple xml file from the input of a safety_summary object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simple_safety_xml(
  x,
  file,
  schema = system.file("extdata", "simple.xsd", package = "eudract")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simple_safety_xml_+3A_x">x</code></td>
<td>
<p>an object of class <code>safety_summary</code>, as created by <code><a href="#topic+safety_summary">safety_summary</a></code>.</p>
</td></tr>
<tr><td><code id="simple_safety_xml_+3A_file">file</code></td>
<td>
<p>a character string name the file to be created</p>
</td></tr>
<tr><td><code id="simple_safety_xml_+3A_schema">schema</code></td>
<td>
<p>a character string giving the file path to the schema for the outputxml file. Defaults to the schema provided in this package.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no output is returned, but a file is created as a side-effect.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eudract_convert">eudract_convert</a></code> <code><a href="#topic+safety_summary">safety_summary</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>safety_statistics &lt;- safety_summary(safety,
                                    exposed=c("Experimental"=60,"Control"=67))
simple &lt;- tempfile(fileext = ".xml")
eudract &lt;- tempfile(fileext = ".xml")
ct &lt;- tempfile(fileext = ".xml")
simple_safety_xml(safety_statistics, simple)
eudract_convert(input=simple,
                output=eudract)
clintrials_gov_convert(input=simple,
                       original=system.file("extdata", "1234.xml", package ="eudract"),
                output=ct)
## Not run: 
  # This needs a real user account to work
  clintrials_gov_upload(
    input=simple,
    orgname="CTU",
    username="Student",
    password="Guinness",
    studyid="1234"
    )


## End(Not run)
</code></pre>

<hr>
<h2 id='soc_code'>System Organ Class coding</h2><span id='topic+soc_code'></span>

<h3>Description</h3>

<p>A dataset containing text descriptions and medDRA and EudraCT codes for each system organ class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>soc_code
</code></pre>


<h3>Format</h3>

<p>a data frame with 3 columns and 27 rows
</p>

<dl>
<dt>soc_term</dt><dd><p>a text description</p>
</dd>
<dt>eutctId</dt><dd><p>the eudraCT coding</p>
</dd>
<dt>meddra</dt><dd><p>the meddra code</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://www.meddra.org/">https://www.meddra.org/</a>, <a href="https://spor.ema.europa.eu/rmswi/#/">https://spor.ema.europa.eu/rmswi/#/</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
