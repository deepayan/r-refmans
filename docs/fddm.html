<!DOCTYPE html><html><head><title>Help for package fddm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fddm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#da_dfddm'><p>Partial Derivative of 5-parameter DDM PDF with respect to a (threshold</p>
separation)</a></li>
<li><a href='#da2_dfddm'><p>Second-Order Partial Derivative of 5-parameter DDM PDF with respect to a</p>
(threshold separation)</a></li>
<li><a href='#ddm'><p>Estimation of 5-Parameter DDM</p></a></li>
<li><a href='#ddm-methods'><p>Methods for ddm objects</p></a></li>
<li><a href='#dfddm'><p>Density of Ratcliff Diffusion Decision Model</p></a></li>
<li><a href='#dsv_dfddm'><p>Partial Derivative of 5-parameter DDM PDF with respect to sv (inter-trial</p>
variability in the drift rate)</a></li>
<li><a href='#dsv2_dfddm'><p>Second-Order Partial Derivative of 5-parameter DDM PDF with respect to sv</p>
(inter-trial variability in the drift rate)</a></li>
<li><a href='#dt_dfddm'><p>Partial Derivative of 5-parameter DDM PDF with respect to t (response time)</p></a></li>
<li><a href='#dt0_dfddm'><p>Partial Derivative of 5-parameter DDM PDF with respect to t0 (non-decision</p>
time)</a></li>
<li><a href='#dt02_dfddm'><p>Second-Order Partial Derivative of 5-parameter DDM PDF with respect to t0</p>
(non-decision time)</a></li>
<li><a href='#dt2_dfddm'><p>Second-Order Partial Derivative of 5-parameter DDM PDF with respect to t</p>
(response time)</a></li>
<li><a href='#dv_dfddm'><p>Partial Derivative of 5-parameter DDM PDF with respect to v (drift rate)</p></a></li>
<li><a href='#dv2_dfddm'><p>Second-Order Partial Derivative of 5-parameter DDM PDF with respect to v</p>
(drift rate)</a></li>
<li><a href='#dw_dfddm'><p>Partial Derivative of 5-parameter DDM PDF with respect to w (initial bias)</p></a></li>
<li><a href='#dw2_dfddm'><p>Second-Order Partial Derivative of 5-parameter DDM PDF with respect to w</p>
(initial bias)</a></li>
<li><a href='#med_dec'><p>Medicial decision data</p></a></li>
<li><a href='#pfddm'><p>Distribution of Ratcliff Diffusion Decision Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fast Implementation of the Diffusion Decision Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0-2</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides the probability density function (PDF), cumulative
  distribution function (CDF), the first-order and second-order partial
  derivatives of the PDF, and a fitting function for the diffusion decision
  model (DDM; e.g.,
  Ratcliff &amp; McKoon, 2008, &lt;<a href="https://doi.org/10.1162%2Fneco.2008.12-06-420">doi:10.1162/neco.2008.12-06-420</a>&gt;) with across-trial
  variability in the drift rate. Because the PDF, its partial derivatives, and
  the CDF of the DDM both contain an infinite sum, they need to be approximated.
  'fddm' implements all published approximations
  (Navarro &amp; Fuss, 2009, &lt;<a href="https://doi.org/10.1016%2Fj.jmp.2009.02.003">doi:10.1016/j.jmp.2009.02.003</a>&gt;;
  Gondan, Blurton, &amp; Kesselmeier, 2014, &lt;<a href="https://doi.org/10.1016%2Fj.jmp.2014.05.002">doi:10.1016/j.jmp.2014.05.002</a>&gt;;
  Blurton, Kesselmeier, &amp; Gondan, 2017, &lt;<a href="https://doi.org/10.1016%2Fj.jmp.2016.11.003">doi:10.1016/j.jmp.2016.11.003</a>&gt;;
  Hartmann &amp; Klauer, 2021, &lt;<a href="https://doi.org/10.1016%2Fj.jmp.2021.102550">doi:10.1016/j.jmp.2021.102550</a>&gt;) plus
  new approximations. All approximations are implemented purely in 'C++'
  providing faster speed than existing packages.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.1), stats, methods, Formula</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rtdists, RWiener, ggplot2, reshape2, testthat, knitr,
rmarkdown, microbenchmark, ggnewscale, ggforce, WienR, emmeans,
estimability, lmtest, numDeriv</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/rtdists/fddm">https://github.com/rtdists/fddm</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/rtdists/fddm/issues">https://github.com/rtdists/fddm/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-07-01 13:22:08 UTC; kendal</td>
</tr>
<tr>
<td>Author:</td>
<td>Kendal B. Foster [aut],
  Henrik Singmann <a href="https://orcid.org/0000-0002-4842-3657"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb, cre],
  Achim Zeileis [ctb] (methods partially taken from betareg)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Henrik Singmann &lt;singmann@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-02 16:00:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='da_dfddm'>Partial Derivative of 5-parameter DDM PDF with respect to a (threshold
separation)</h2><span id='topic+da_dfddm'></span>

<h3>Description</h3>

<p>Partial Derivative of the density function for the 5-parameter variant of
the Ratcliff diffusion decision model (DDM) with respect to a, the
threshold separation. This variant contains the following parameters:
<code>v</code> (drift rate), <code>a</code> (threshold separation),
<code>t0</code> (non-decision time/response time constant), <code>w</code>
(relative starting point), <code>sv</code> (inter-trial variability of drift),
and <code>sigma</code> (diffusion coefficient of underlying Wiener process).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>da_dfddm(
  rt,
  response,
  v,
  a,
  t0,
  w = 0.5,
  sv = 0,
  sigma = 1,
  sl_thresh = 0.5,
  err_tol = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="da_dfddm_+3A_rt">rt</code></td>
<td>
<p>A vector of response times (in seconds). If a response time is
non-positve, then its density will evaluate to <code class="reqn">0</code> if log = FALSE and
-&#8734; if log = TRUE.</p>
</td></tr>
<tr><td><code id="da_dfddm_+3A_response">response</code></td>
<td>
<p>Binary response(s) that correspond(s) to either the &quot;lower&quot;
or &quot;upper&quot; threshold. This model parameter can either be a singular value
or a vector. The value(s) in 'response' can be of the following data
types:
</p>

<ul>
<li><p> integers or doubles (<code class="reqn">1</code>
&#8594; &quot;lower&quot;, <code class="reqn">2</code>
&#8594; &quot;upper&quot;);
</p>
</li>
<li><p> factors (the first level gets mapped to &quot;lower&quot;, and the second
level gets mapped to &quot;upper&quot;; any additional levels are ignored).
</p>
</li>
<li><p> strings (only the first character is checked, &quot;L&quot;
&#8594; &quot;lower&quot; or &quot;U&quot;
&#8594; &quot;upper&quot;, case insensitive);
</p>
</li>
<li><p> logicals (FALSE &#8594; &quot;lower&quot;,
TRUE &#8594; &quot;upper&quot;);
</p>
</li></ul>
</td></tr>
<tr><td><code id="da_dfddm_+3A_v">v</code></td>
<td>
<p>Drift rate. Average slope of the information accumulation process.
The drift gives information about the speed and direction of the
accumulation of information. Large (absolute) values of drift indicate a
good performance. If received information supports the response linked to
the upper threshold, then the sign will be positive; similarly a negative
value indicates that the received information supports the response linked
to the lower threshold. Allowed range: <code>v</code> is a real number. Typical
range: <code class="reqn">-5 &lt;</code> <code>v</code> <code class="reqn">&lt; 5</code>.</p>
</td></tr>
<tr><td><code id="da_dfddm_+3A_a">a</code></td>
<td>
<p>Threshold separation. Amount of information that is considered for
a decision. Large values indicate a conservative decisional style. Allowed
range: <code class="reqn">0 &lt;</code> <code>a</code>. Typical range: <code class="reqn">0.5 &lt;</code> <code>a</code> <code class="reqn">&lt; 2</code>.</p>
</td></tr>
<tr><td><code id="da_dfddm_+3A_t0">t0</code></td>
<td>
<p>Non-decision time or response time constant (in seconds). Lower
bound for the duration of all non-decisional processes (encoding and
response execution). If this value is greater than <code>rt</code>, then the
resulting density is returned as if <code>rt</code> <code class="reqn"> \le 0</code>. Allowed range:
<code class="reqn">0 \le</code> <code>t0</code>. Typical range: <code class="reqn">0.1 &lt;</code> <code>t0</code> <code class="reqn">&lt; 0.5</code>.</p>
</td></tr>
<tr><td><code id="da_dfddm_+3A_w">w</code></td>
<td>
<p>Relative starting point. Indicator of an a priori bias in decision
making. When the relative starting point <code>w</code> deviates from <code class="reqn">0.5</code>,
the amount of information necessary for a decision differs between
response alternatives. Allowed range: <code class="reqn">0 &lt;</code> <code>w</code> <code class="reqn">&lt; 1</code>.
Default value is <code class="reqn">0.5</code> (i.e., no bias).</p>
</td></tr>
<tr><td><code id="da_dfddm_+3A_sv">sv</code></td>
<td>
<p>Inter-trial-variability of drift rate. Standard deviation of a
normal distribution with mean <code>v</code> describing the distribution of
actual drift rates from specific trials. Values different from <code class="reqn">0</code> can
predict slow errors. Allowed range: <code class="reqn">0 \le</code> <code>sv</code>. Typical range:
<code class="reqn">0 &lt;</code> <code>sv</code> <code class="reqn">&lt; 2</code>. Default value is <code class="reqn">0</code>, which indicates
no drift in the function call. See Details for more information.</p>
</td></tr>
<tr><td><code id="da_dfddm_+3A_sigma">sigma</code></td>
<td>
<p>Diffusion coefficient of the underlying Wiener process. Allowed
range: <code class="reqn">0 &lt;</code> <code>sigma</code>. Default value is <code class="reqn">1</code>. This parameter
simply scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code> as follows.
See Details for more information. </p>
 <ul>
<li> <p><code>a</code>
&#8594; <code>a</code> <code class="reqn">/</code> <code>sigma</code>
</p>
</li>
<li> <p><code>v</code> &#8594; <code>v</code> <code class="reqn">/</code>
<code>sigma</code> </p>
</li>
<li> <p><code>sv</code> &#8594;
<code>sv</code> <code class="reqn">/</code> <code>sigma</code> </p>
</li></ul>
<p>.</p>
</td></tr>
<tr><td><code id="da_dfddm_+3A_sl_thresh">sl_thresh</code></td>
<td>
<p>Threshold for deciding when to use the &quot;small-time&quot; variant
or the &quot;large-time&quot; variant. If the &quot;effective response time&quot; is greater
than <code>sl_thresh</code> (i.e., <code class="reqn">\frac{rt}{a^2} &gt;</code> <code>sl_thresh</code>),
then the &quot;large-time&quot; variant is used; otherwise, the &quot;small-time&quot; variant
is used. Allowed values are any real number; however any non-positive
number means that the &quot;large-time&quot; variant will always be used. Similarly,
any very large positive number (e.g., +Inf) means that the &quot;small-time&quot;
variant will always be used. Default value is <code class="reqn">0.5</code>.</p>
</td></tr>
<tr><td><code id="da_dfddm_+3A_err_tol">err_tol</code></td>
<td>
<p>Allowed error tolerance of the overall calculation. Since the
partial derivative of the density function contains the sum of two
infinite sums, each approximation of these two infinite sums will have an
individual error tolerance of <code>err_tol</code> / 2; thus the total overall
error of the calculation will be at most <code>err_tol</code>. If the provided
error tolerance is less than <code class="reqn">1e-300</code>, it is set to <code class="reqn">1e-300</code>.
Default is <code class="reqn">1e-6</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All of the model inputs and parameters (<code>rt</code>, <code>response</code>,
<code>v</code>, <code>a</code>, <code>t0</code>, <code>w</code>, <code>sv</code>, <code>sigma</code>) can be
input as a single value or as a vector of values. If input as a vector of
values, then the standard <code>R</code> input wrapping will occur.
</p>
<p><code>sv</code> - Both the &quot;small-time&quot; and &quot;large-time&quot; variants of the density
function have two further variants: one with a constant drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">= 0</code>), and one with a variable drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">&gt; 0</code>). The details of the differences between these
two density functions can be found in our associated paper. To use the
density function with a constant drift rate, leave the parameter <code>sv</code>
to its default value of <code>sv = 0</code>, as this will indicate no drift to the
function. To use the density function with a variable drift rate, set the
parameter <code>sv</code> to some non-negative value, i.e., <code>sv</code> <code class="reqn">&gt; 0</code>.
</p>
<p><code>sigma</code> - The default value of this parameter is <code>1</code> because it
only scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code>, as shown
above. However, other formulations of the DDM may set <code>sigma = 0.1</code>
(see Ratcliff (1978), the fourth reference), so care must be taken when
comparing the results of different formulations.
</p>


<h3>Value</h3>

<p>A vector containing the partial derivatives of the DDM PDF with
precision <code>err_tol</code> whose length matches that of the longest input
parameter (usually <code>rt</code>).
</p>


<h3>References</h3>

<p>Navarro, D. J., &amp; Fuss, I. G. (2009). Fast and accurate
calculations for first-passage times in Wiener diffusion models. Journal
of Mathematical Psychology, 53(4), 222-230.
</p>
<p>Gondan, M., Blurton, S. P., &amp; Kesselmeier, M. (2014). Even faster and even
more accurate first-passage time densities and distributions for the
Wiener diffusion model. Journal of Mathematical Psychology, 60, 20-22.
</p>
<p>Blurton, S. P., Kesselmeier, M., &amp; Gondan, M. (2017). The first-passage
time distribution for the diffusion model with variable drift. Journal of
Mathematical Psychology, 76, 7-12.
</p>
<p>Hartmann, R., Klauer, K. C. (2021). Partial derivatives for the
first-passage time distribution in Wiener diffusion models. Journal of
Mathematical Psychology, 103, 102550.
</p>
<p>Ratcliff, R. (1978). A theory of memory retrieval. Psychological review,
85(2), 59.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># derivative with respect to rt (response time)
dt_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to t0 (non-decision time)
dt0_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

# derivative with respect to a (threshold separation)
da_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to v (drift rate)
dv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to w (relative starting point)
dw_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to sv (inter-trial variability in the drift rate)
dsv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

#-------- Log Versions --------#

# # derivative with respect to rt (response time)
# dt_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to t0 (non-decision time)
# dt0_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)

# # derivative with respect to a (threshold separation)
# da_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to v (drift rate)
# dv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to w (relative starting point)
# dw_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to sv (inter-trial variability in the drift rate)
# dsv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)
</code></pre>

<hr>
<h2 id='da2_dfddm'>Second-Order Partial Derivative of 5-parameter DDM PDF with respect to a
(threshold separation)</h2><span id='topic+da2_dfddm'></span>

<h3>Description</h3>

<p>Second-Order Partial Derivative of the density function for the 5-parameter
variant of the Ratcliff diffusion decision model (DDM) with respect to a,
the threshold separation. This variant contains the following parameters:
<code>v</code> (drift rate), <code>a</code> (threshold separation),
<code>t0</code> (non-decision time/response time constant), <code>w</code>
(relative starting point), <code>sv</code> (inter-trial variability of drift),
and <code>sigma</code> (diffusion coefficient of underlying Wiener process).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>da2_dfddm(
  rt,
  response,
  v,
  a,
  t0,
  w = 0.5,
  sv = 0,
  sigma = 1,
  sl_thresh = 0.5,
  err_tol = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="da2_dfddm_+3A_rt">rt</code></td>
<td>
<p>A vector of response times (in seconds). If a response time is
non-positve, then its density will evaluate to <code class="reqn">0</code> if log = FALSE and
-&#8734; if log = TRUE.</p>
</td></tr>
<tr><td><code id="da2_dfddm_+3A_response">response</code></td>
<td>
<p>Binary response(s) that correspond(s) to either the &quot;lower&quot;
or &quot;upper&quot; threshold. This model parameter can either be a singular value
or a vector. The value(s) in 'response' can be of the following data
types:
</p>

<ul>
<li><p> integers or doubles (<code class="reqn">1</code>
&#8594; &quot;lower&quot;, <code class="reqn">2</code>
&#8594; &quot;upper&quot;);
</p>
</li>
<li><p> factors (the first level gets mapped to &quot;lower&quot;, and the second
level gets mapped to &quot;upper&quot;; any additional levels are ignored).
</p>
</li>
<li><p> strings (only the first character is checked, &quot;L&quot;
&#8594; &quot;lower&quot; or &quot;U&quot;
&#8594; &quot;upper&quot;, case insensitive);
</p>
</li>
<li><p> logicals (FALSE &#8594; &quot;lower&quot;,
TRUE &#8594; &quot;upper&quot;);
</p>
</li></ul>
</td></tr>
<tr><td><code id="da2_dfddm_+3A_v">v</code></td>
<td>
<p>Drift rate. Average slope of the information accumulation process.
The drift gives information about the speed and direction of the
accumulation of information. Large (absolute) values of drift indicate a
good performance. If received information supports the response linked to
the upper threshold, then the sign will be positive; similarly a negative
value indicates that the received information supports the response linked
to the lower threshold. Allowed range: <code>v</code> is a real number. Typical
range: <code class="reqn">-5 &lt;</code> <code>v</code> <code class="reqn">&lt; 5</code>.</p>
</td></tr>
<tr><td><code id="da2_dfddm_+3A_a">a</code></td>
<td>
<p>Threshold separation. Amount of information that is considered for
a decision. Large values indicate a conservative decisional style. Allowed
range: <code class="reqn">0 &lt;</code> <code>a</code>. Typical range: <code class="reqn">0.5 &lt;</code> <code>a</code> <code class="reqn">&lt; 2</code>.</p>
</td></tr>
<tr><td><code id="da2_dfddm_+3A_t0">t0</code></td>
<td>
<p>Non-decision time or response time constant (in seconds). Lower
bound for the duration of all non-decisional processes (encoding and
response execution). If this value is greater than <code>rt</code>, then the
resulting density is returned as if <code>rt</code> <code class="reqn"> \le 0</code>. Allowed range:
<code class="reqn">0 \le</code> <code>t0</code>. Typical range: <code class="reqn">0.1 &lt;</code> <code>t0</code> <code class="reqn">&lt; 0.5</code>.</p>
</td></tr>
<tr><td><code id="da2_dfddm_+3A_w">w</code></td>
<td>
<p>Relative starting point. Indicator of an a priori bias in decision
making. When the relative starting point <code>w</code> deviates from <code class="reqn">0.5</code>,
the amount of information necessary for a decision differs between
response alternatives. Allowed range: <code class="reqn">0 &lt;</code> <code>w</code> <code class="reqn">&lt; 1</code>.
Default value is <code class="reqn">0.5</code> (i.e., no bias).</p>
</td></tr>
<tr><td><code id="da2_dfddm_+3A_sv">sv</code></td>
<td>
<p>Inter-trial-variability of drift rate. Standard deviation of a
normal distribution with mean <code>v</code> describing the distribution of
actual drift rates from specific trials. Values different from <code class="reqn">0</code> can
predict slow errors. Allowed range: <code class="reqn">0 \le</code> <code>sv</code>. Typical range:
<code class="reqn">0 &lt;</code> <code>sv</code> <code class="reqn">&lt; 2</code>. Default value is <code class="reqn">0</code>, which indicates
no drift in the function call. See Details for more information.</p>
</td></tr>
<tr><td><code id="da2_dfddm_+3A_sigma">sigma</code></td>
<td>
<p>Diffusion coefficient of the underlying Wiener process. Allowed
range: <code class="reqn">0 &lt;</code> <code>sigma</code>. Default value is <code class="reqn">1</code>. This parameter
simply scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code> as follows.
See Details for more information. </p>
 <ul>
<li> <p><code>a</code>
&#8594; <code>a</code> <code class="reqn">/</code> <code>sigma</code>
</p>
</li>
<li> <p><code>v</code> &#8594; <code>v</code> <code class="reqn">/</code>
<code>sigma</code> </p>
</li>
<li> <p><code>sv</code> &#8594;
<code>sv</code> <code class="reqn">/</code> <code>sigma</code> </p>
</li></ul>
<p>.</p>
</td></tr>
<tr><td><code id="da2_dfddm_+3A_sl_thresh">sl_thresh</code></td>
<td>
<p>Threshold for deciding when to use the &quot;small-time&quot; variant
or the &quot;large-time&quot; variant. If the &quot;effective response time&quot; is greater
than <code>sl_thresh</code> (i.e., <code class="reqn">\frac{rt}{a^2} &gt;</code> <code>sl_thresh</code>),
then the &quot;large-time&quot; variant is used; otherwise, the &quot;small-time&quot; variant
is used. Allowed values are any real number; however any non-positive
number means that the &quot;large-time&quot; variant will always be used. Similarly,
any very large positive number (e.g., +Inf) means that the &quot;small-time&quot;
variant will always be used. Default value is <code class="reqn">0.5</code>.</p>
</td></tr>
<tr><td><code id="da2_dfddm_+3A_err_tol">err_tol</code></td>
<td>
<p>Allowed error tolerance of the overall calculation. Since the
partial derivative of the density function contains the sum of two
infinite sums, each approximation of these two infinite sums will have an
individual error tolerance of <code>err_tol</code> / 2; thus the total overall
error of the calculation will be at most <code>err_tol</code>. If the provided
error tolerance is less than <code class="reqn">1e-300</code>, it is set to <code class="reqn">1e-300</code>.
Default is <code class="reqn">1e-6</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All of the model inputs and parameters (<code>rt</code>, <code>response</code>,
<code>v</code>, <code>a</code>, <code>t0</code>, <code>w</code>, <code>sv</code>, <code>sigma</code>) can be
input as a single value or as a vector of values. If input as a vector of
values, then the standard <code>R</code> input wrapping will occur.
</p>
<p><code>sv</code> - Both the &quot;small-time&quot; and &quot;large-time&quot; variants of the density
function have two further variants: one with a constant drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">= 0</code>), and one with a variable drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">&gt; 0</code>). The details of the differences between these
two density functions can be found in our associated paper. To use the
density function with a constant drift rate, leave the parameter <code>sv</code>
to its default value of <code>sv = 0</code>, as this will indicate no drift to the
function. To use the density function with a variable drift rate, set the
parameter <code>sv</code> to some non-negative value, i.e., <code>sv</code> <code class="reqn">&gt; 0</code>.
</p>
<p><code>sigma</code> - The default value of this parameter is <code>1</code> because it
only scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code>, as shown
above. However, other formulations of the DDM may set <code>sigma = 0.1</code>
(see Ratcliff (1978), the fourth reference), so care must be taken when
comparing the results of different formulations.
</p>


<h3>Value</h3>

<p>A vector containing the second-order partial derivatives of the
DDM PDF with precision <code>err_tol</code> whose length matches that of the
longest input parameter (usually <code>rt</code>).
</p>


<h3>References</h3>

<p>Navarro, D. J., &amp; Fuss, I. G. (2009). Fast and accurate
calculations for first-passage times in Wiener diffusion models. Journal
of Mathematical Psychology, 53(4), 222-230.
</p>
<p>Gondan, M., Blurton, S. P., &amp; Kesselmeier, M. (2014). Even faster and even
more accurate first-passage time densities and distributions for the
Wiener diffusion model. Journal of Mathematical Psychology, 60, 20-22.
</p>
<p>Blurton, S. P., Kesselmeier, M., &amp; Gondan, M. (2017). The first-passage
time distribution for the diffusion model with variable drift. Journal of
Mathematical Psychology, 76, 7-12.
</p>
<p>Hartmann, R., Klauer, K. C. (2021). Partial derivatives for the
first-passage time distribution in Wiener diffusion models. Journal of
Mathematical Psychology, 103, 102550.
</p>
<p>Ratcliff, R. (1978). A theory of memory retrieval. Psychological review,
85(2), 59.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># derivative with respect to rt (response time)
dt_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to t0 (non-decision time)
dt0_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

# derivative with respect to a (threshold separation)
da_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to v (drift rate)
dv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to w (relative starting point)
dw_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to sv (inter-trial variability in the drift rate)
dsv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

#-------- Log Versions --------#

# # derivative with respect to rt (response time)
# dt_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to t0 (non-decision time)
# dt0_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)

# # derivative with respect to a (threshold separation)
# da_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to v (drift rate)
# dv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to w (relative starting point)
# dw_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to sv (inter-trial variability in the drift rate)
# dsv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)
</code></pre>

<hr>
<h2 id='ddm'>Estimation of 5-Parameter DDM</h2><span id='topic+ddm'></span>

<h3>Description</h3>

<p>Fit the 5-parameter DDM (Diffusion Decision Model) via maximum likelihood
estimation. The model for each DDM parameter can be specified symbolically
using R's formula interface. With the exception of the drift rate (which is
always estimated) all parameters can be either fixed or estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ddm(
  drift,
  boundary = ~1,
  ndt = ~1,
  bias = 0.5,
  sv = 0,
  data,
  optim = "nlminb",
  args_optim = list(init = NULL, lo_bds = NULL, up_bds = NULL, control = list()),
  args_ddm = list(err_tol = 1e-06),
  use_gradient = TRUE,
  compiled_model = TRUE,
  model = TRUE,
  mmatrix = TRUE,
  response = TRUE,
  na.action,
  subset,
  contrasts = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ddm_+3A_drift">drift</code></td>
<td>
<p>Two-sided formula. The left-hand side describes the response,
the right-hand side provides a symbolic description of the regression model
underlying the drift rate (v). The left-hand side needs to specify the
column in the data containing response time and corresponding binary
decision, concatenated by <code>+</code> , e.g., <code>rt + response ~ ...</code></p>
</td></tr>
<tr><td><code id="ddm_+3A_boundary">boundary</code>, <code id="ddm_+3A_ndt">ndt</code>, <code id="ddm_+3A_bias">bias</code>, <code id="ddm_+3A_sv">sv</code></td>
<td>
<p>Either a one-sided formula providing a symbolic
description of the regression model or a scalar number given the value this
parameter should be fixed to. Boundary separation (a), non-decision time
(t0), relative initial bias (w), or inter-trial variability in the drift
rate (sv)</p>
</td></tr>
<tr><td><code id="ddm_+3A_data">data</code>, <code id="ddm_+3A_na.action">na.action</code>, <code id="ddm_+3A_subset">subset</code></td>
<td>
<p>arguments controlling formula processing via
<code><a href="stats.html#topic+model.frame">model.frame</a></code>.</p>
</td></tr>
<tr><td><code id="ddm_+3A_optim">optim</code></td>
<td>
<p>character string or fitting function indicating which numerical
optimization method should be used. The default <code>"nlminb"</code> uses the
corresponding function.</p>
</td></tr>
<tr><td><code id="ddm_+3A_args_optim">args_optim</code></td>
<td>
<p>named list of additional arguments for the optimization
function. The available options are:
</p>

<ul>
<li> <p><code>init</code> vector containing the initial values to be used in the
optimization for each coefficient. Note that the number and type of
coefficients used (i.e., intercept or difference) is determined by
the model matrices, which are in turn determined by the formulas
assigned to each DDM parameter (see the Details section for an
overview of formulas and coefficients). For an example, run the
<code>ddm()</code> function with parameter set to its default value, and
view the initial value vector via the slot
<code>$optim_info$args_optim$init</code>. By default for intercept
coefficients, the initial values for the drift rate (v), boundary
separation (a), and non-decision time (t0) will be generated using
EZ-Diffusion (Wagenmakers et al. 2007); bias (w) is initialized to
<code>0.5</code>; inter-trial variability in the drift rate (sv) is
initialized to <code>0.0</code>. Difference coefficients are initialized
to <code>0.0</code>.
</p>
</li>
<li> <p><code>lo_bds</code> vector containing the lower bounds to be used in the
optimization for each coefficient. The same consideration of
coefficient types occurs here as it does with <code>init</code>. The
defaults for intercept coefficients are: drift rate
<code>v &gt; -Inf</code>, boundary separation <code>a &gt; 0</code>, non-decision
time <code>t0 &gt; 0</code>, bias <code>w &gt; 0</code>, inter-trial variability in
the drift rate <code>sv</code> <code class="reqn"> \le 0</code>. All difference coefficients
have a lower bound of <code>-Inf</code>.
</p>
</li>
<li> <p><code>up_bds</code> vector containing the upper bounds to be used in the
optimization for each coefficient. The same consideration of
coefficient types occurs here as it does with <code>init</code>. The
defaults for intercept coefficients are: drift rate
<code>v &lt; Inf</code>, boundary separation <code>a &lt; Inf</code>, non-decision
time <code>t0 &lt; Inf</code>, bias <code>w &lt; 1</code>, inter-trial variability in
the drift rate <code>sv &lt; Inf</code>. All difference coefficients have a
upper bound of <code>Inf</code>.
</p>
</li>
<li> <p><code>control</code> additional control arguments passed to
<code>control</code> argument of optimization function specified in
<code>optim</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="ddm_+3A_args_ddm">args_ddm</code></td>
<td>
<p>named list of additional arguments passed to density function
calculation. Currently, the only option for this is <code>err_tol</code>, the
desired error tolerance used in the density function calculation.</p>
</td></tr>
<tr><td><code id="ddm_+3A_use_gradient">use_gradient</code></td>
<td>
<p>logical. Should gradient be used during numerical
optimization? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ddm_+3A_compiled_model">compiled_model</code>, <code id="ddm_+3A_model">model</code>, <code id="ddm_+3A_mmatrix">mmatrix</code>, <code id="ddm_+3A_response">response</code></td>
<td>
<p>logicals. If <code>TRUE</code> the
corresponding components of the fit (the compiled model object, the model
frame, the model matrix, the response matrix) are returned.</p>
</td></tr>
<tr><td><code id="ddm_+3A_contrasts">contrasts</code></td>
<td>
<p>optional list. See the contrasts.arg of
<code><a href="stats.html#topic+model.matrix.default">model.matrix.default</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ddm</code> uses <code><a href="stats.html#topic+model.matrix">model.matrix</a></code> for transforming the
symbolic description of the regression model underlying each parameter into
estimated coefficients. The following provides a few examples:
</p>

<ul>
<li> <p><code>~ 1</code> estimates a single coefficient, named <code>(Intercept)</code>
</p>
</li>
<li> <p><code>~ condition</code> estimates the intercept plus k - 1 coefficients
for a factor with k levels (e.g., intercept plus one coefficient if
condition has two levels). The interpretation of the coefficients
depend on the factor contrasts employed, which are usually based on
the contrasts specified in <code>options("contrasts")</code>. For the
default <code>treatment</code> contrasts (<code><a href="stats.html#topic+contr.treatment">contr.treatment</a></code>),
the intercept corresponds to the first factor level and the
additional coefficients correspond to the difference from the
intercept (i.e., first factor level). When using <code>contr.sum</code>
the intercept corresponds to the grand mean and the additional
coefficients correspond to the differences from the grand mean.
</p>
</li>
<li> <p><code>~ 0 + condition</code> estimates no intercept but one coefficient
per factor level. This specification can also be used to get one
coefficient per cell for a multi-factorial design, e.g.,
<code>~ 0 + condition1:condition2</code>.
</p>
</li>
<li> <p><code>~ 0 + condition1 + condition1:condition2</code> estimates one
&quot;intercept&quot; per level of <code>condition1</code> factor (which is not
called intercept) plus k - 1 difference parameters from the
condition-specific intercept for the k-levels of <code>condition2</code>.
The interpretation of the difference parameters again depends on
the contrasts used (e.g., treatment vs. sum-to-zero contrasts, see
examples). This formula specification can often make sense for the
drift rate when <code>condition1</code> is the factor (such as item type)
mapped to upper and lower response boundary of the DDM and
<code>condition2</code> is another factor by which we want the drift rate
to differ. This essentially gives one overall drift rate per
response boundary plus the differences from this overall one (note
again that with treatment contrasts this overall drift rate is the
first factor level of <code>condition2</code>).
</p>
</li></ul>

<p>To get meaningful results it is necessary to estimate separate drift rates
for the different condition/item-types that are mapped onto the upper and
lower boundary of the diffusion model.
</p>
<p>If a non-default fitting function is used, it needs to minimize the
negative log-likelihood, accept the following arguments,
<code>init, objective, gradient, lower, upper, control</code> , and return a list
with the following arguments <code>coefficients, loglik, converged, optim</code>
(where <code>converged</code> is boolean and <code>optim</code> can be an arbitrary
list with additional information).
</p>


<h3>Value</h3>

<p>Object of class <code>ddm</code> (i.e., a list with components as listed
below) for which a number of common methods such as <code>print</code>,
<code>coef</code>, and <code>logLik</code> are implemented, see
<code><a href="#topic+ddm-methods">ddm-methods</a></code>.
</p>

<ul>
<li> <p><code>coefficients</code> a named list whose elements are the values of
the estimated model parameters
</p>
</li>
<li> <p><code>dpar</code> a character vector containing the names of the
estimated model parameters
</p>
</li>
<li> <p><code>fixed_dpar</code> a named list whose elements are the values of the
fixed model parameters
</p>
</li>
<li> <p><code>loglik</code> the value of the log-likelihood function at the
optimized parameter values
</p>
</li>
<li> <p><code>hessians</code> a named list whose elements are the individual
Hessians for each of the model parameters
</p>
</li>
<li> <p><code>vcov</code> a named list whose elements are the individual
variance-covariance matrices for each of the model parameters
</p>
</li>
<li> <p><code>nobs</code> the number of observations in the data used for fitting
</p>
</li>
<li> <p><code>npar</code> the number of parameters used to fit the model (i.e.,
the estimated model parameters plus any hyperparameters)
</p>
</li>
<li> <p><code>df.residual</code> the residual degrees of freedom (the number of
observations - the number of parameters)
</p>
</li>
<li> <p><code>call</code> the original function call to <code>ddm</code>
</p>
</li>
<li> <p><code>formula</code> the formulas used in the model (<code>1</code> indicates
that the model parameter was estimated with a single coefficient;
<code>0</code> indicates that the model parameter was fixed)
</p>
</li>
<li> <p><code>dpar_formulas</code> a named list whose elements are the formulas
for the model parameters (<code>1</code> indicates that the model
parameter was estimated with a single coefficient; <code>0</code>
indicates that the model parameter was fixed)
</p>
</li>
<li> <p><code>na.action</code> na.action
</p>
</li>
<li> <p><code>terms</code> a named list whose elements are the model parameters,
except the last element is named <code>full</code> and shows the
breakdown of the model with all model parameters
</p>
</li>
<li> <p><code>levels</code> a named list whose elements are the levels associated
with any parameters that are factors (the elements are <code>NULL</code>
if the parameter is not a factor), and whose last element is named
<code>FULL</code> and shows all of the levels used in the model
</p>
</li>
<li> <p><code>contrasts</code> a named list whose elements are the type of
contrasts used in the model
</p>
</li>
<li> <p><code>args_ddm</code> a named list whose elements are the optional
arguments used in the calculation of the DDM log-likelihood
function
</p>
</li>
<li> <p><code>link</code> a named list whose elements show information about the
link function used for each model parameter (currently the only
link function is the identity function)
</p>
</li>
<li> <p><code>converged</code> a logical indicating whether the optimization
converged (<code>TRUE</code>) or not (<code>FALSE</code>)
</p>
</li>
<li> <p><code>optim_info</code> a named list whose elements are information about
the optimization process (e.g., the name of the algorithm used,
the final value of the objective function, the number of
evaluations of the gradient function, etc.)
</p>
</li>
<li> <p><code>model</code> the data used in the model (might need to check this)
</p>
</li>
<li> <p><code>response</code> the response data used in the model
</p>
</li>
<li> <p><code>mmatrix</code> a named list whose elements are the model matrices
for each of the estimated parameters
</p>
</li>
<li> <p><code>compiled_model</code> C++ object that contains the compiled model
(see list below for more details)
</p>
</li></ul>

<p>The C++ object accessible via the <code>compiled_model</code> component of the
above R object of class <code>ddm</code> contains the following components:
</p>

<ul>
<li> <p><code>rt</code> a numeric vector of the response time data used in the
model
</p>
</li>
<li> <p><code>response</code> an integer vector of the response data used in the
model (coded such that <code>1</code> corresponds to the &quot;lower&quot; boundary
and <code>2</code> corresponds to the &quot;upper&quot; boundary)
</p>
</li>
<li> <p><code>err_tol</code> the error tolerance used in the calculations for
fitting the DDM
</p>
</li>
<li> <p><code>coefficients</code> a numeric vector containing the current set of
coefficients for the formulas provided to the <code>ddm()</code> function
call; the coefficients correspond to the DDM parameters in the
following order: <code>v</code>, <code>a</code>, <code>t0</code>, <code>w</code>, <code>sv</code>
</p>
</li>
<li> <p><code>likelihood</code> a double containing the log-likelihood for the
current set of <code>coefficients</code> (note this can be changed by
calling the function <code>calculate_loglik()</code> below)
</p>
</li>
<li> <p><code>modmat_v</code> a numeric matrix containing the model matrix for
<code>v</code>, the drift rate, determined by the formula input to the
argument <code>drift</code> in the <code>ddm()</code> function call
</p>
</li>
<li> <p><code>modmat_a</code> a numeric matrix containing the model matrix for
<code>a</code>, the boundary separation, determined by the formula input
to the argument <code>boundary</code> in the <code>ddm()</code> function call
</p>
</li>
<li> <p><code>modmat_t0</code> a numeric matrix containing the model matrix for
<code>t0</code>, the non-decision time, determined by the formula input
to the argument <code>ndt</code> in the <code>ddm()</code> function call
</p>
</li>
<li> <p><code>modmat_w</code> a numeric matrix containing the model matrix for
<code>w</code>, the inital bias, determined by the formula input to the
argument <code>bias</code> in the <code>ddm()</code> function call
</p>
</li>
<li> <p><code>modmat_sv</code> a numeric matrix containing the model matrix for
<code>sv</code>, the inter-trial variability in the drift rate,
determined by the formula input to the argument <code>sv</code> in the
<code>ddm()</code> function call
</p>
</li>
<li> <p><code>hess_v</code> a numeric matrix containing the Hessian for <code>v</code>,
the drift rate, whose dimensions are determined by the formula
input to the argument <code>drift</code> in the <code>ddm()</code> function
call
</p>
</li>
<li> <p><code>hess_a</code> a numeric matrix containing the Hessian for <code>a</code>,
the boundary separation, whose dimensions are determined by the
formula input to the argument <code>drift</code> in the <code>ddm()</code>
function call
</p>
</li>
<li> <p><code>hess_t0</code> a numeric matrix containing the Hessian for
<code>t0</code>, the non-decision time, whose dimensions are determined
by the formula input to the argument <code>drift</code> in the
<code>ddm()</code> function call
</p>
</li>
<li> <p><code>hess_w</code> a numeric matrix containing the Hessian for <code>w</code>,
the initial bias, whose dimensions are determined by the formula
input to the argument <code>drift</code> in the <code>ddm()</code> function
call
</p>
</li>
<li> <p><code>hess_sv</code> a numeric matrix containing the Hessian for
<code>sv</code>, the inter-trial variability in the drift rate, whose
dimensions are determined by the formula input to the argument
<code>drift</code> in the <code>ddm()</code> function call
</p>
</li>
<li> <p><code>vcov_v</code> a numeric matrix containing the variance-covariance
matrix for <code>v</code>, the drift rate, whose dimensions are
determined by the formula input to the argument <code>drift</code> in the
<code>ddm()</code> function call
</p>
</li>
<li> <p><code>vcov_a</code> a numeric matrix containing the variance-covariance
matrix for <code>a</code>, the boundary separation, whose dimensions are
determined by the formula input to the argument <code>boundary</code> in
the <code>ddm()</code> function call
</p>
</li>
<li> <p><code>vcov_t0</code> a numeric matrix containing the variance-covariance
matrix for <code>t0</code>, the non-decision time, whose dimensions are
determined by the formula input to the argument <code>ndt</code> in the
<code>ddm()</code> function call
</p>
</li>
<li> <p><code>vcov_w</code> a numeric matrix containing the variance-covariance
matrix for <code>w</code>, the inital bias, whose dimensions are
determined by the formula input to the argument <code>bias</code> in the
<code>ddm()</code> function call
</p>
</li>
<li> <p><code>vcov_sv</code> a numeric matrix containing the variance-covariance
matrix for <code>v</code>, the inter-trial variability in the drift rate,
whose dimensions are determined by the formula input to the
argument <code>sv</code> in the <code>ddm()</code> function call
</p>
</li>
<li> <p><code>calculate_loglik</code> calculates and returns a double containing
the negated log-likelihood (note that this will overwrite the
<code>likelihood</code> component of the C++ object)
</p>
</li>
<li> <p><code>calculate_gradient</code> calculates and returns a numeric vector
of the negated gradients for the provided coefficient values; the
gradients are stored in the same manner as their corresponding
<code>coefficents</code> (note that this will overwrite the
<code>likelihood</code>) component of the C++ object)
</p>
</li>
<li> <p><code>calculate_hessians</code> calculates and returns a named list of
the negated Hessians for each model parameter for the provided
coefficient values (note that this will overwrite the
<code>likelihood</code>, <code>hess_v</code>, <code>hess_a</code>, <code>hess_t0</code>,
<code>hess_w</code>, and <code>hess_sv</code> components of the C++ object)
</p>
</li>
<li> <p><code>calculate_vcov</code> calculates and returns a named list of the
variance-covariance matrices for each model parameter for the
stored <code>coefficients</code> (note that this will overwrite the
<code>likelihood</code>, <code>hess_v</code>, <code>hess_a</code>, <code>hess_t0</code>,
<code>hess_w</code>, <code>hess_sv</code>, <code>vcov_v</code>, <code>vcov_a</code>,
<code>vcov_t0</code>, <code>vcov_w</code>, and <code>vcov_sv</code> components of the
C++ object)
</p>
</li>
<li> <p><code>calculate_standard_error</code> calculates and returns a numeric
vector of the standard errors of the stored <code>coefficients</code>;
the standard errors are stored in the same manner as their
corresponding <code>coefficients</code> (note that this will overwrite
the <code>likelihood</code>, <code>hess_v</code>, <code>hess_a</code>,
<code>hess_t0</code>, <code>hess_w</code>, <code>hess_sv</code>, <code>vcov_v</code>,
<code>vcov_a</code>, <code>vcov_t0</code>, <code>vcov_w</code>, and <code>vcov_sv</code>
components of the C++ object)
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># prepare data
data(med_dec, package = "fddm")
med_dec &lt;- med_dec[which(med_dec[["rt"]] &gt;= 0), ] ## only use valid RTs
## select data from one participant
p1 &lt;- med_dec[med_dec[["id"]] == 2 &amp; med_dec[["group"]] == "experienced", ]
head(p1)


##----------------------------------------------
##        Easiest: Fitting using emmeans       -
##----------------------------------------------

## Because we use an ANOVA approach, we set orthogonal sum-to-zero contrasts
op &lt;- options(contrasts = c('contr.sum', 'contr.poly'))

fit0 &lt;- ddm(rt + response ~ classification*difficulty, data = p1)
summary(fit0)

## for more tests, we use emmeans:
if (requireNamespace("emmeans")) {
# for ANOVA table:
emmeans::joint_tests(fit0)
# get conditional main effects of difficulty (for each level of classification):
emmeans::joint_tests(fit0, by = "classification")

# get mean drift rates per condition:
em1 &lt;- emmeans::emmeans(fit0, "difficulty", by = "classification")
em1
# compare mean drift rates per condition
pairs(em1)
update(pairs(em1), by = NULL, adjust = "holm")
}

options(op) # reset contrasts


##----------------------------------------------------------------
##              Fitting with custom parametrisation              -
##----------------------------------------------------------------

## one drift rate per classification by difficulty design cell
fit1 &lt;- ddm(rt + response ~ 0 + classification:difficulty, data = p1)
summary(fit1)

## set default contrasts (just in case contrasts have been changed)
op &lt;- options(contrasts = c('contr.treatment', 'contr.poly'))
## one drift rate "intercept" per classification condition (blast vs. non-blast)
## corresponding to first level of difficulty factor (easy)
## plus one further coefficient per classification condition corresponding to
## difference from "intercept" (hard - easy)
fit1b &lt;- ddm(rt + response ~ 0 + classification + classification:difficulty,
             data = p1, args_optim = list(control = list(iter.max = 1000,
                                                         eval.max = 1000)))
summary(fit1b)
options(op) # reset contrasts

## set orthogonal sum-to-zero contrasts
op &lt;- options(contrasts = c('contr.sum', 'contr.poly'))
## one drift rate "intercept" per classification condition (blast vs. non-blast)
## corresponding to mean drift rate for the classification condition
## plus one further coefficient per classification condition corresponding to
## difference from "intercept" (hard/easy - mean drift rate)
fit1c &lt;- ddm(rt + response ~ 0 + classification + classification:difficulty,
             data = p1)
summary(fit1c)
options(op) ## reset contrasts

## all variants produce same fit, only meaning of parameters differs
logLik(fit1)
logLik(fit1b)
logLik(fit1c)
logLik(fit0) ## also model above

## all models estimate same drift rates, but in different parametrisation:
coef(fit1)  ## drift rates per design cell
## same drift rates based on fit1b:
c(coef(fit1b)[1:2],
  coef(fit1b)[1] + coef(fit1b)[3], coef(fit1b)[2] + coef(fit1b)[4])
## same drift rates based on fit1c:
c(coef(fit1c)[1] + coef(fit1c)[3], coef(fit1c)[2] + coef(fit1c)[4],
  coef(fit1c)[1] - coef(fit1c)[3], coef(fit1c)[2] - coef(fit1c)[4])

# we can estimate a model that freely estimates response bias
# (instead of fixing it at 0.5)
fit2 &lt;- ddm(rt + response ~ 0 + classification:difficulty, bias = ~1, data = p1)
summary(fit2)
## Note: estimating bias only makes sense in situations like here where the
## response boundaries do not correspond to correct/incorrect but to the
## actual responses participants gave (here: blast vs. non-blast classification)

## now let's perform a likelihood ratio test to check if estimating response
## bias freely leads to a significant increase in model fit?
if (requireNamespace("lmtest")) { ## requires package lmtest
  lmtest::lrtest(fit1, fit2)
  ## does not look like it (p = 0.1691)
}


# we can also make a DDM parameter, such as boundary, depend on a numeric
# variable, such as block number
fit3 &lt;- ddm(rt + response ~ 0 + classification:difficulty,
            boundary = ~ block, data = p1)
summary(fit3)

## does making boundary depend on block leads to a significant increase in model
## fit?
if (requireNamespace("lmtest")) { ## requires package lmtest
  lmtest::lrtest(fit1, fit3)
  ## does not look like it (p = 0.198)
}


##----------------------------------------------------------------
##              Fitting with optimization arguments              -
##----------------------------------------------------------------
## example of how to use your own initial values and bounds for the optimization
## of the coefficients (determined by the model matrices/formulas)
options(op) # reset contrasts

# this uses the default generated initial values and bounds
fitex0 &lt;- ddm(rt + response ~ 0 + classification:difficulty, data = p1)

# we can see the number of coefficients (and thus the number of initial values
# and bounds) required if we wish to use our own
fitex0$optim_info$args_optim$init
fitex0$optim_info$args_optim$lo_bds
fitex0$optim_info$args_optim$up_bds
# -1.9270279  2.5408864 -1.9270279  0.3181987  1.7907438  0.1264035
# -Inf        -Inf      -Inf        -Inf       0          0
# Inf         Inf       Inf         Inf        Inf        0.461
# the first four coefficients are for the drift rate (given by the formula we
# provided), and the last two are for the boundary separation and non-decision
# time, respectively (note that the default is to estimate these two model
# parameters with a single coefficient).

# to use our own initial values, we can include them in the `args_optim` list,
# but note that they must be within the generated bounds
fitex1 &lt;- ddm(rt + response ~ 0 + classification:difficulty, data = p1,
              args_optim = list(init = c(-1.5, 1, -1, 1, 1.5, 0.3)))

# to use our own bounds, we again can include them in the `args_optim` list,
# but note that they must contain the generated initial values
fitex2 &lt;- ddm(rt + response ~ 0 + classification:difficulty, data = p1,
              args_optim = list(lo_bds = c(-20, -20, -20, -20, 0, 0),
                                up_bds = c(20, 20, 20, 20, 10, 0.5)))

# to use both our own initial values and bounds, we include them in the
# `args_optim` list, and the bounds must contain the initial values
fitex3 &lt;- ddm(rt + response ~ 0 + classification:difficulty, data = p1,
              args_optim = list(init = c(-1.5, 1, -1, 1, 1.5, 0.3),
                                lo_bds = c(-20, -20, -20, -20, 0, 0),
                                up_bds = c(20, 20, 20, 20, 10, 0.5)))

# the only other option in the `args_optim` list is the control parameters
# directly used by the optimization function (e.g., the maximum number of
# iterations); here we'll set the maximum number of iterations and function
# evaluations
fitex4 &lt;- ddm(rt + response ~ 0 + classification:difficulty, data = p1,
              args_optim = list(control = list(iter.max = 1000,
                                               eval.max = 1000)))
</code></pre>

<hr>
<h2 id='ddm-methods'>Methods for ddm objects</h2><span id='topic+ddm-methods'></span><span id='topic+print.ddm'></span><span id='topic+summary.ddm'></span><span id='topic+print.summary.ddm'></span><span id='topic+coef.ddm'></span><span id='topic+vcov.ddm'></span><span id='topic+model.frame.ddm'></span><span id='topic+model.matrix.ddm'></span><span id='topic+terms.ddm'></span><span id='topic+logLik.ddm'></span><span id='topic+update.ddm'></span><span id='topic+recover_data.ddm'></span><span id='topic+emm_basis.ddm'></span>

<h3>Description</h3>

<p>Implemented S3 methods for objects of class <code>ddm</code> as returned by
function <code><a href="#topic+ddm">ddm</a>()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ddm'
print(x, digits = max(3, getOption("digits") - 3), ...)

## S3 method for class 'ddm'
summary(object, ...)

## S3 method for class 'summary.ddm'
print(x, digits = max(3, getOption("digits") - 3), ...)

## S3 method for class 'ddm'
coef(object, dpar = c("drift", "boundary", "ndt", "bias", "sv", "full"), ...)

## S3 method for class 'ddm'
vcov(object, dpar = c("drift", "boundary", "ndt", "bias", "sv"), ...)

## S3 method for class 'ddm'
model.frame(formula, ...)

## S3 method for class 'ddm'
model.matrix(object, dpar = c("drift", "boundary", "ndt", "bias", "sv"), ...)

## S3 method for class 'ddm'
terms(x, dpar = c("drift", "boundary", "ndt", "bias", "sv"), ...)

## S3 method for class 'ddm'
logLik(object, ...)

## S3 method for class 'ddm'
update(object, ...)

recover_data.ddm(object, data, ...)

emm_basis.ddm(
  object,
  trms,
  xlev,
  grid,
  dpar = c("drift", "boundary", "ndt", "bias", "sv"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ddm-methods_+3A_digits">digits</code></td>
<td>
<p>minimal number of significant digits, see
<code><a href="base.html#topic+print.default">print.default</a></code>.</p>
</td></tr>
<tr><td><code id="ddm-methods_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="ddm-methods_+3A_object">object</code>, <code id="ddm-methods_+3A_x">x</code></td>
<td>
<p>object of class <code>ddm</code></p>
</td></tr>
<tr><td><code id="ddm-methods_+3A_dpar">dpar</code></td>
<td>
<p>which distributional parameter or DDM parameter to focus on. In
addition to the five DDM parameters <code>c("drift", "boundary", "ndt",
  "bias", "sv")</code>, some methods accept <code>"full"</code> which returns information
for all estimated parameters.</p>
</td></tr>
<tr><td><code id="ddm-methods_+3A_formula">formula</code></td>
<td>
<p>see <code><a href="stats.html#topic+model.frame">model.frame</a></code></p>
</td></tr>
<tr><td><code id="ddm-methods_+3A_data">data</code>, <code id="ddm-methods_+3A_trms">trms</code>, <code id="ddm-methods_+3A_xlev">xlev</code>, <code id="ddm-methods_+3A_grid">grid</code></td>
<td>
<p>arguments needed for <span class="pkg">emmeans</span> support.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The methods should fail with an informative error if a
distributional parameter is selected in <code>dpar</code> that is fixed and not
estimated.
</p>

<hr>
<h2 id='dfddm'>Density of Ratcliff Diffusion Decision Model</h2><span id='topic+dfddm'></span>

<h3>Description</h3>

<p>Density function for the Ratcliff diffusion decision model (DDM) with
following parameters: <code>v</code> (drift rate), <code>a</code> (threshold
separation), <code>t0</code> (non-decision time/response time constant), <code>w</code>
(relative starting point), <code>sv</code> (inter-trial variability of drift), and
<code>sigma</code> (diffusion coefficient of underlying Wiener process). If you
are looking to fit the DDM, see <code><a href="#topic+ddm">ddm()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dfddm(
  rt,
  response,
  v,
  a,
  t0,
  w = 0.5,
  sv = 0,
  sigma = 1,
  err_tol = 1e-06,
  log = FALSE,
  switch_mech = "eff_rt",
  switch_thresh = 0.8,
  n_terms_small = "SWSE",
  summation_small = "2017"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dfddm_+3A_rt">rt</code></td>
<td>
<p>A vector of response times (in seconds). If a response time is
non-positve, then its density will evaluate to <code class="reqn">0</code> if log = FALSE and
-&#8734; if log = TRUE.</p>
</td></tr>
<tr><td><code id="dfddm_+3A_response">response</code></td>
<td>
<p>Binary response(s) that correspond(s) to either the &quot;lower&quot;
or &quot;upper&quot; threshold. This model parameter can either be a singular value
or a vector. The value(s) in 'response' can be of the following data
types:
</p>

<ul>
<li><p> integers or doubles (<code class="reqn">1</code>
&#8594; &quot;lower&quot;, <code class="reqn">2</code>
&#8594; &quot;upper&quot;);
</p>
</li>
<li><p> factors (the first level gets mapped to &quot;lower&quot;, and the second
level gets mapped to &quot;upper&quot;; any additional levels are ignored).
</p>
</li>
<li><p> strings (only the first character is checked, &quot;L&quot;
&#8594; &quot;lower&quot; or &quot;U&quot;
&#8594; &quot;upper&quot;, case insensitive);
</p>
</li>
<li><p> logicals (FALSE &#8594; &quot;lower&quot;,
TRUE &#8594; &quot;upper&quot;);
</p>
</li></ul>
</td></tr>
<tr><td><code id="dfddm_+3A_v">v</code></td>
<td>
<p>Drift rate. Average slope of the information accumulation process.
The drift gives information about the speed and direction of the
accumulation of information. Large (absolute) values of drift indicate a
good performance. If received information supports the response linked to
the upper threshold, then the sign will be positive; similarly a negative
value indicates that the received information supports the response linked
to the lower threshold. Allowed range: <code>v</code> is a real number. Typical
range: <code class="reqn">-5 &lt;</code> <code>v</code> <code class="reqn">&lt; 5</code>.</p>
</td></tr>
<tr><td><code id="dfddm_+3A_a">a</code></td>
<td>
<p>Threshold separation. Amount of information that is considered for
a decision. Large values indicate a conservative decisional style. Allowed
range: <code class="reqn">0 &lt;</code> <code>a</code>. Typical range: <code class="reqn">0.5 &lt;</code> <code>a</code> <code class="reqn">&lt; 2</code>.</p>
</td></tr>
<tr><td><code id="dfddm_+3A_t0">t0</code></td>
<td>
<p>Non-decision time or response time constant (in seconds). Lower
bound for the duration of all non-decisional processes (encoding and
response execution). If this value is greater than <code>rt</code>, then the
resulting density is returned as if <code>rt</code> <code class="reqn"> \le 0</code>. Allowed range:
<code class="reqn">0 \le</code> <code>t0</code>. Typical range: <code class="reqn">0.1 &lt;</code> <code>t0</code> <code class="reqn">&lt; 0.5</code>.</p>
</td></tr>
<tr><td><code id="dfddm_+3A_w">w</code></td>
<td>
<p>Relative starting point. Indicator of an a priori bias in decision
making. When the relative starting point <code>w</code> deviates from <code class="reqn">0.5</code>,
the amount of information necessary for a decision differs between
response alternatives. Allowed range: <code class="reqn">0 &lt;</code> <code>w</code> <code class="reqn">&lt; 1</code>.
Default value is <code class="reqn">0.5</code> (i.e., no bias).</p>
</td></tr>
<tr><td><code id="dfddm_+3A_sv">sv</code></td>
<td>
<p>Inter-trial-variability of drift rate. Standard deviation of a
normal distribution with mean <code>v</code> describing the distribution of
actual drift rates from specific trials. Values different from <code class="reqn">0</code> can
predict slow errors. Allowed range: <code class="reqn">0 \le</code> <code>sv</code>. Typical range:
<code class="reqn">0 &lt;</code> <code>sv</code> <code class="reqn">&lt; 2</code>. Default value is <code class="reqn">0</code>, which indicates
no drift in the function call. See Details for more information.</p>
</td></tr>
<tr><td><code id="dfddm_+3A_sigma">sigma</code></td>
<td>
<p>Diffusion coefficient of the underlying Wiener process. Allowed
range: <code class="reqn">0 &lt;</code> <code>sigma</code>. Default value is <code class="reqn">1</code>. This parameter
simply scales the parameters <code>a</code>, <code>v</code>, and <code>sv</code> as follows.
See Details for more information. </p>
 <ul>
<li> <p><code>a</code>
&#8594; <code>a</code> <code class="reqn">/</code> <code>sigma</code>
</p>
</li>
<li> <p><code>v</code> &#8594; <code>v</code> <code class="reqn">/</code>
<code>sigma</code> </p>
</li>
<li> <p><code>sv</code> &#8594;
<code>sv</code> <code class="reqn">/</code> <code>sigma</code> </p>
</li></ul>
<p>.</p>
</td></tr>
<tr><td><code id="dfddm_+3A_err_tol">err_tol</code></td>
<td>
<p>Allowed error tolerance of the density function. The density
function contains an infinite sum that must be approximated; this
parameter is the upper bound of the total error incurred from this
approximation (in absolute value). See Details for more information.
Default is <code class="reqn">1e-6</code>.</p>
</td></tr>
<tr><td><code id="dfddm_+3A_log">log</code></td>
<td>
<p>Logical; if <code>TRUE</code>, probabilities <code class="reqn">p</code> are given as
<code class="reqn">log(p)</code>. Default is <code>FALSE</code>, which gives the density on the
probability scale.</p>
</td></tr>
<tr><td><code id="dfddm_+3A_switch_mech">switch_mech</code></td>
<td>
<p>Which switching mechanism to use in the choice of the
&quot;large-time&quot; or &quot;small-time&quot; density function. Can be one of
{<code>"eff_rt"</code>, <code>"terms_large"</code>, <code>"terms"</code>, <code>"small"</code>,
<code>"large"</code>}. Note that the large-time approximation is unstable for
small effective response times (<code class="reqn">(</code><code>rt</code><code class="reqn">-</code><code>t0</code><code class="reqn">)</code>
<code class="reqn">/(</code><code>a</code><code class="reqn">*</code><code>a</code><code class="reqn">) &lt; 0.009</code>). See Details for more
information. Default is <code>"eff_rt"</code>.</p>
</td></tr>
<tr><td><code id="dfddm_+3A_switch_thresh">switch_thresh</code></td>
<td>
<p>Threshold for determining whether the effective
response time (<code class="reqn">(</code><code>rt</code><code class="reqn">-</code><code>t0</code><code class="reqn">)</code>
<code class="reqn">/(</code><code>a</code><code class="reqn">*</code><code>a</code><code class="reqn">)</code>) is &quot;large&quot; or &quot;small&quot;. This
parameter is only considered if <code>switch_mech = "eff_rt"</code> or
<code>switch_mech = "terms_large"</code>.
If <code>switch_mech = "eff_rt"</code>, an effective response time greater than
<code>switch_thresh</code> is considered &quot;large&quot;, and the &quot;large-time&quot; variant
of the density function is used; otherwise, the &quot;small-time&quot; variant of
the density function is used. The default is <code class="reqn">0.8</code>.
If <code>switch_mech = "terms_large"</code>, this parameter is treated as
<code class="reqn">ceiling(</code><code>switch_thresh</code><code class="reqn">)</code>; the smallest integer that is
not less than <code>switch_thresh</code>. In this case, the default is
<code class="reqn">ceiling(0.8) = 1</code>. See the <code>switch_mech</code> section of Details for
more information.
Note that if <code>switch_thresh</code><code class="reqn"> \le 0</code>, then the effective response
time is always treated as &quot;large&quot;; contrarily, if <code>switch_thresh</code> =
&#8734; then the effective response
time is always treated as &quot;small&quot;. However, it is better to simply set
<code>switch_mech = "large"</code> or <code>switch_mech = "small"</code> to always use
the &quot;large-time&quot; or &quot;small-time&quot; variant, respectively.</p>
</td></tr>
<tr><td><code id="dfddm_+3A_n_terms_small">n_terms_small</code></td>
<td>
<p>Which method to use for calculating the &quot;small-time&quot;
approximation to the density function. Only applicable if
<code>switch_mech = "terms"</code> or <code>switch_mech = "small"</code>; all other
values of <code>switch_mech</code> cause this parameter to be ignored. If
<code>switch_mech = "small"</code>, the allowed values are <code>"SWSE"</code>,
<code>"Gondan"</code>, and <code>"Navarro"</code>. The default value is <code>"SWSE"</code>.
If <code>switch_mech = "terms"</code>, the allowed values are <code>"Gondan"</code>
and <code>"Navarro"</code>. Note that if the user inputs
<code>switch_mech = "terms"</code>, then the user must also explicitly input
either <code>n_terms_small = "Gondan"</code> or
<code>n_terms_small = "Navarro"</code>. See Details for more information.</p>
</td></tr>
<tr><td><code id="dfddm_+3A_summation_small">summation_small</code></td>
<td>
<p>Which style of summation to use for the small-time
approximation to the infinite sum. Can be one of {<code>"2017"</code>,
<code>"2014"</code>}. Only applicable if <code>switch_mech</code> is one of
{<code>"eff_rt"</code>, <code>"terms_large"</code>, <code>"terms"</code>, <code>"small"</code>}.
See Details for more information. Default is <code>"2017"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All of the model inputs and parameters (<code>rt</code>, <code>response</code>,
<code>v</code>, <code>a</code>, <code>t0</code>, <code>w</code>, <code>sv</code>, <code>sigma</code>) can be
input as a single value or as a vector of values. If input as a vector of
values, then the standard <code>R</code> recycling rules apply to ensure all
inputs are of the same length.
</p>
<p>The default settings of <code>switch_mech = "eff_rt"</code>,
<code>switch_thresh = "0.8"</code>, <code>n_terms_small = "SWSE"</code>,
<code>summation_small = "2017"</code> produce the fastest and most accurate
results, as shown in our associated paper.
</p>
<p><code>sv</code> - Both the &quot;small-time&quot; and &quot;large-time&quot; variants of the density
function have two further variants: one with a constant drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">= 0</code>), and one with a variable drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">&gt; 0</code>). The details of the differences between these
two density functions can be found in our associated paper. To use the
density function with a constant drift rate, leave the parameter <code>sv</code>
to its default value of <code>sv = 0</code>, as this will indicate no drift to the
function. To use the density function with a variable drift rate, set the
parameter <code>sv</code> to some non-negative value, i.e., <code>sv</code> <code class="reqn">&gt; 0</code>.
</p>
<p><code>sigma</code> - The default value of this parameter is <code>1</code> because it
only scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code>, as shown
above. However, other formulations of the DDM may set <code>sigma = 0.1</code>
(see Ratcliff (1978), the fourth reference), so care must be taken when
comparing the results of different formulations.
</p>
<p><code>err_tol</code> - The density function is composed of an infinite sum (that
must be approximated) and a multiplicative term outside the infinite sum,
<code class="reqn">m</code>. The total error of the approximation is the error incurred from
truncating the infinite sum multiplied by <code class="reqn">m</code>. Thus, to ensure that the
total error is bounded by the user-provided error tolerance, <code>err_tol</code>,
the approximation to the infinite sum uses a modified error tolerance
(<code>err_tol</code><code class="reqn"> / m</code>). If the error tolerance is small and <code class="reqn">m</code> is
large, the modified error tolerance can underflow to <code class="reqn">0</code>. To protect
against this, we check that the modified error tolerance is at least
<code class="reqn">1e-300</code> (near the smallest value that is representable by a floating
point number with double precision). If the modified error tolerance is
smaller than this threshold, then we silently change it to <code class="reqn">1e-300</code>.
This case should only be encountered if extreme values of error tolerance
are used (i.e., on the scale of <code class="reqn">1e-300</code>).
</p>
<p><code>switch_mech</code> - The density function for the DDM has traditionally been
written in two forms: a &quot;large-time&quot; variant, and a &quot;small-time&quot; variant
(Navarro and Fuss, 2009). These two forms are more
efficient at calculating the density for large and small response times,
respectively. The parameter <code>switch_mech</code> determines how <code>dfddm</code>
decides which of these two variants is used.
<code>switch_mech = "small"</code> uses
only the &quot;small-time&quot; variant, and <code>switch_mech = "large"</code> uses only
the &quot;large-time&quot; variant. The &quot;large-time&quot; variant is unstable for small
effective response times (<code class="reqn">(</code><code>rt</code><code class="reqn">-</code><code>t0</code><code class="reqn">)</code> <code class="reqn">/
(</code><code>a</code><code class="reqn">*</code><code>a</code><code class="reqn">) &lt; 0.009</code>) and may produce inaccurate
densities; thus, we do not recommend using the <code>switch_mech = "large"</code>
option if the inputs may contain such small effective response times. To
circumvent this accuracy issue and resolve the differing efficiencies of the
&quot;large-time&quot; and &quot;small-time&quot; variants, there are three switching mechanisms
that can be used to determine which of the two variants is more efficient.
First, <code>switch_mech = "terms"</code> is the traditional approach and
pre-calculates the number of terms required for the &quot;large-time&quot; and
&quot;small-time&quot; sums, and then uses whichever variant requires fewer terms.
This is the mechanism used in the Navarro and Fuss (2009) and Gondan,
Blurton, and Kesselmeier (2014) papers.
Second, <code>switch_mech = "terms_large"</code> pre-calculates the number of
terms only for the &quot;large-time&quot; variant, and compares that to the constant
value of <code class="reqn">ceil(</code><code>switch_thresh</code><code class="reqn">)</code> (default value of
<code class="reqn">ceil(0.8) = 1</code>) to determine if the &quot;large-time&quot; variant is
sufficiently efficient.
Third, <code>switch_mech = "eff_rt"</code> determines whether a given effective
response time (<code class="reqn">(</code><code>rt</code><code class="reqn">-</code><code>t0</code><code class="reqn">)</code>
<code class="reqn">/(</code><code>a</code><code class="reqn">*</code><code>a</code><code class="reqn">)</code>) is considered &quot;large&quot; or &quot;small&quot; by
comparing it to the value of the parameter <code>switch_thresh</code> (default
value of <code class="reqn">0.8</code>); it then uses the corresponding variant.
Both <code>switch_mech = "terms_large"</code> and <code>switch_mech = "eff_rt"</code>
only use the SWSE &quot;small-time&quot; approximation in the case that the
&quot;small-time&quot; variant is more efficient. <code>switch_mech = "eff_rt"</code> is the
most efficient method to determine which variant of the density function
should be used.
</p>
<p><code>switch_thresh</code> - This parameter determines what effective response
times (<code>rt</code><code class="reqn">/(</code><code>a</code> <code class="reqn">*</code><code>a</code><code class="reqn">)</code>) are &quot;large&quot; and
&quot;small&quot;. The <code>paper_analysis</code> folder in the <code>fddm</code> GitHub
repository contains plots showing the relative efficiencies of a range of
values for the <code>switch_thresh</code> parameter when used with
<code>switch_mech = "eff_rt"</code> and also <code>switch_mech = "terms_large"</code>.
Note that this parameter changed name and purpose with the release of
<code>fddm</code> version 0.5-0.
</p>
<p><code>n_terms_small</code> - The &quot;small-time&quot; variant has three different methods
for how to truncate the infinite sum in the density function. These
different methods are discussed extensively in our associated paper, but the
key distinction is that <code>n_terms_small = "SWSE"</code> uses a new method of
truncating the infinite sum. The <code>n_terms_small = "SWSE"</code> method is
currently recommended (when possible) because it is the fastest and most
stable algorithm when used with <code>switch_mech = "eff_rt"</code>.
</p>
<p><code>summation_small</code> - The &quot;large-time&quot; variant of the density function
does not have any further variants, but the &quot;small-time&quot; variant has more
options with respect to evaluating the infinite sum. There are two
equivalent styles of summation, <code>summation_small = "2017"</code> and
<code>summation_small = "2014"</code>, of which the <code>"2017"</code> version
evaluates slightly faster and thus earns our recommendation. These different
styles of summation are discussed in our associated paper.
</p>


<h3>Value</h3>

<p>A vector containing the densities of the DDM with precision
<code>err_tol</code> whose length matches that of the longest input parameter
(usually <code>rt</code>).
</p>


<h3>References</h3>

<p>Navarro, D. J., &amp; Fuss, I. G. (2009). Fast and accurate
calculations for first-passage times in Wiener diffusion models. Journal
of Mathematical Psychology, 53(4), 222-230.
</p>
<p>Gondan, M., Blurton, S. P., &amp; Kesselmeier, M. (2014). Even faster and even
more accurate first-passage time densities and distributions for the
Wiener diffusion model. Journal of Mathematical Psychology, 60, 20-22.
</p>
<p>Blurton, S. P., Kesselmeier, M., &amp; Gondan, M. (2017). The first-passage
time distribution for the diffusion model with variable drift. Journal of
Mathematical Psychology, 76, 7-12.
</p>
<p>Ratcliff, R. (1978). A theory of memory retrieval. Psychological review,
85(2), 59.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ddm">ddm()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># minimal example
dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3)

# example with all function parameters set to default or a practical value
dfddm(rt = c(1.2, 0.9, 1.1, 1.4, 0.8, 1.3),
      response = c("lower", "upper", "upper", "lower", "upper", "lower"),
      a = 1, v = -1, t0 = 0.2, w = 0.5, sv = 0, sigma = 1,
      err_tol = 1e-6, log = FALSE, switch_mech = "eff_rt", switch_thresh = 0.8,
      n_terms_small = "SWSE", summation_small = "2017")

# example of mismatched input lengths
dfddm(rt = c(1.2, 0.9, 1.1, 1.4, 0.8, 1.3),
      response = c("lower", "upper", "upper", "lower", "upper", "lower"),
      a = c(1, 3), v = c(-2, 2, 2, -2, 2, -2),
      t0 = 0.3, w = c(0.4, 0.5, 0.6), sv = 0.9,
      err_tol = 1e-10, log = FALSE, switch_mech = "large",
      summation_small = "2017")

# example with Wiener diffusion coefficient (sigma) not equal to 1
dfddm(rt = c(1.2, 0.9, 1.1, 1.4, 0.8, 1.3),
      response = c("lower", "upper", "upper", "lower", "upper", "lower"),
      a = 1, v = -1, t0 = 0.3, w = 0.5, sv = 0, sigma = 0.1,
      err_tol = 1e-10, log = TRUE, switch_mech = "terms_large",
      switch_thresh = 1, summation_small = "2017")


### examples of different response inputs

# integer
resp_int &lt;- as.integer(c(1, 2, 2, 1, 2, 1))
dfddm(rt = c(1.2, 0.9, 1.1, 1.4, 0.8, 1.3), response = resp_int,
      a = 1, v = -2, t0 = 0.3, w = 0.5, sv = 0.1,
      err_tol = 1e-10, log = FALSE, switch_mech = "eff_rt",
      summation_small = "2017")

# double
resp_dbl &lt;- as.double(c(1, 2, 2, 1, 2, 1))
dfddm(rt = c(1.2, 0.9, 1.1, 1.4, 0.8, 1.3), response = resp_dbl,
      a = 1, v = -2, t0 = 0.3, w = 0.5, sv = 0.1,
      err_tol = 1e-10, log = FALSE, switch_mech = "eff_rt",
      summation_small = "2017")

# factor (first level is mapped to "lower")
days &lt;- c("Monday", "Friday", "Friday", "Monday", "Friday", "Monday")
resp_fac &lt;- factor(days, levels = c("Monday", "Friday"))
dfddm(rt = c(1.2, 0.9, 1.1, 1.4, 0.8, 1.3), response = resp_fac,
      a = 1, v = -2, t0 = 0.3, w = 0.5, sv = 0.1,
      err_tol = 1e-10, log = FALSE, switch_mech = "eff_rt",
      summation_small = "2017")

# string
resp_str &lt;- c("lower", "upper", "upper", "lower", "upper", "lower")
dfddm(rt = c(1.2, 0.9, 1.1, 1.4, 0.8, 1.3), response = resp_str,
      a = 1, v = -2, t0 = 0.3, w = 0.5, sv = 0.1,
      err_tol = 1e-10, log = FALSE, switch_mech = "eff_rt",
      summation_small = "2017")

# logical
resp_log &lt;- c(FALSE, TRUE, TRUE, FALSE, TRUE, FALSE)
dfddm(rt = c(1.2, 0.9, 1.1, 1.4, 0.8, 1.3), response = resp_log,
      a = 1, v = -2, t0 = 0.3, w = 0.5, sv = 0.1,
      err_tol = 1e-10, log = FALSE, switch_mech = "eff_rt",
      summation_small = "2017")
</code></pre>

<hr>
<h2 id='dsv_dfddm'>Partial Derivative of 5-parameter DDM PDF with respect to sv (inter-trial
variability in the drift rate)</h2><span id='topic+dsv_dfddm'></span>

<h3>Description</h3>

<p>Partial Derivative of the density function for the 5-parameter variant of
the Ratcliff diffusion decision model (DDM) with respect to w, the
inter-trial variability in the drift rate. This variant contains the
following parameters:
<code>v</code> (drift rate), <code>a</code> (threshold separation),
<code>t0</code> (non-decision time/response time constant), <code>w</code>
(relative starting point), <code>sv</code> (inter-trial variability of drift),
and <code>sigma</code> (diffusion coefficient of underlying Wiener process).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dsv_dfddm(
  rt,
  response,
  v,
  a,
  t0,
  w = 0.5,
  sv = 0,
  sigma = 1,
  sl_thresh = 0.355,
  err_tol = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dsv_dfddm_+3A_rt">rt</code></td>
<td>
<p>A vector of response times (in seconds). If a response time is
non-positve, then its density will evaluate to <code class="reqn">0</code> if log = FALSE and
-&#8734; if log = TRUE.</p>
</td></tr>
<tr><td><code id="dsv_dfddm_+3A_response">response</code></td>
<td>
<p>Binary response(s) that correspond(s) to either the &quot;lower&quot;
or &quot;upper&quot; threshold. This model parameter can either be a singular value
or a vector. The value(s) in 'response' can be of the following data
types:
</p>

<ul>
<li><p> integers or doubles (<code class="reqn">1</code>
&#8594; &quot;lower&quot;, <code class="reqn">2</code>
&#8594; &quot;upper&quot;);
</p>
</li>
<li><p> factors (the first level gets mapped to &quot;lower&quot;, and the second
level gets mapped to &quot;upper&quot;; any additional levels are ignored).
</p>
</li>
<li><p> strings (only the first character is checked, &quot;L&quot;
&#8594; &quot;lower&quot; or &quot;U&quot;
&#8594; &quot;upper&quot;, case insensitive);
</p>
</li>
<li><p> logicals (FALSE &#8594; &quot;lower&quot;,
TRUE &#8594; &quot;upper&quot;);
</p>
</li></ul>
</td></tr>
<tr><td><code id="dsv_dfddm_+3A_v">v</code></td>
<td>
<p>Drift rate. Average slope of the information accumulation process.
The drift gives information about the speed and direction of the
accumulation of information. Large (absolute) values of drift indicate a
good performance. If received information supports the response linked to
the upper threshold, then the sign will be positive; similarly a negative
value indicates that the received information supports the response linked
to the lower threshold. Allowed range: <code>v</code> is a real number. Typical
range: <code class="reqn">-5 &lt;</code> <code>v</code> <code class="reqn">&lt; 5</code>.</p>
</td></tr>
<tr><td><code id="dsv_dfddm_+3A_a">a</code></td>
<td>
<p>Threshold separation. Amount of information that is considered for
a decision. Large values indicate a conservative decisional style. Allowed
range: <code class="reqn">0 &lt;</code> <code>a</code>. Typical range: <code class="reqn">0.5 &lt;</code> <code>a</code> <code class="reqn">&lt; 2</code>.</p>
</td></tr>
<tr><td><code id="dsv_dfddm_+3A_t0">t0</code></td>
<td>
<p>Non-decision time or response time constant (in seconds). Lower
bound for the duration of all non-decisional processes (encoding and
response execution). If this value is greater than <code>rt</code>, then the
resulting density is returned as if <code>rt</code> <code class="reqn"> \le 0</code>. Allowed range:
<code class="reqn">0 \le</code> <code>t0</code>. Typical range: <code class="reqn">0.1 &lt;</code> <code>t0</code> <code class="reqn">&lt; 0.5</code>.</p>
</td></tr>
<tr><td><code id="dsv_dfddm_+3A_w">w</code></td>
<td>
<p>Relative starting point. Indicator of an a priori bias in decision
making. When the relative starting point <code>w</code> deviates from <code class="reqn">0.5</code>,
the amount of information necessary for a decision differs between
response alternatives. Allowed range: <code class="reqn">0 &lt;</code> <code>w</code> <code class="reqn">&lt; 1</code>.
Default value is <code class="reqn">0.5</code> (i.e., no bias).</p>
</td></tr>
<tr><td><code id="dsv_dfddm_+3A_sv">sv</code></td>
<td>
<p>Inter-trial-variability of drift rate. Standard deviation of a
normal distribution with mean <code>v</code> describing the distribution of
actual drift rates from specific trials. Values different from <code class="reqn">0</code> can
predict slow errors. Allowed range: <code class="reqn">0 \le</code> <code>sv</code>. Typical range:
<code class="reqn">0 &lt;</code> <code>sv</code> <code class="reqn">&lt; 2</code>. Default value is <code class="reqn">0</code>, which indicates
no drift in the function call. See Details for more information.</p>
</td></tr>
<tr><td><code id="dsv_dfddm_+3A_sigma">sigma</code></td>
<td>
<p>Diffusion coefficient of the underlying Wiener process. Allowed
range: <code class="reqn">0 &lt;</code> <code>sigma</code>. Default value is <code class="reqn">1</code>. This parameter
simply scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code> as follows.
See Details for more information. </p>
 <ul>
<li> <p><code>a</code>
&#8594; <code>a</code> <code class="reqn">/</code> <code>sigma</code>
</p>
</li>
<li> <p><code>v</code> &#8594; <code>v</code> <code class="reqn">/</code>
<code>sigma</code> </p>
</li>
<li> <p><code>sv</code> &#8594;
<code>sv</code> <code class="reqn">/</code> <code>sigma</code> </p>
</li></ul>
<p>.</p>
</td></tr>
<tr><td><code id="dsv_dfddm_+3A_sl_thresh">sl_thresh</code></td>
<td>
<p>Threshold for deciding when to use the &quot;small-time&quot; variant
or the &quot;large-time&quot; variant. If the &quot;effective response time&quot; is greater
than <code>sl_thresh</code> (i.e., <code class="reqn">\frac{rt}{a^2} &gt;</code> <code>sl_thresh</code>),
then the &quot;large-time&quot; variant is used; otherwise, the &quot;small-time&quot; variant
is used. Allowed values are any real number; however any non-positive
number means that the &quot;large-time&quot; variant will always be used. Similarly,
any very large positive number (e.g., +Inf) means that the &quot;small-time&quot;
variant will always be used. Default value is <code class="reqn">0.355</code>.</p>
</td></tr>
<tr><td><code id="dsv_dfddm_+3A_err_tol">err_tol</code></td>
<td>
<p>Allowed error tolerance of the overall calculation. Since the
partial derivative of the density function contains one infinite sum, this
parameter defines the precision of the approximation to that infinite sum.
If the provided error tolerance is less than <code class="reqn">1e-300</code>, it is set to
<code class="reqn">1e-300</code>. Default is <code class="reqn">1e-6</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All of the model inputs and parameters (<code>rt</code>, <code>response</code>,
<code>v</code>, <code>a</code>, <code>t0</code>, <code>w</code>, <code>sv</code>, <code>sigma</code>) can be
input as a single value or as a vector of values. If input as a vector of
values, then the standard <code>R</code> input wrapping will occur.
</p>
<p><code>sv</code> - Both the &quot;small-time&quot; and &quot;large-time&quot; variants of the density
function have two further variants: one with a constant drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">= 0</code>), and one with a variable drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">&gt; 0</code>). The details of the differences between these
two density functions can be found in our associated paper. To use the
density function with a constant drift rate, leave the parameter <code>sv</code>
to its default value of <code>sv = 0</code>, as this will indicate no drift to the
function. To use the density function with a variable drift rate, set the
parameter <code>sv</code> to some non-negative value, i.e., <code>sv</code> <code class="reqn">&gt; 0</code>.
</p>
<p><code>sigma</code> - The default value of this parameter is <code>1</code> because it
only scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code>, as shown
above. However, other formulations of the DDM may set <code>sigma = 0.1</code>
(see Ratcliff (1978), the fourth reference), so care must be taken when
comparing the results of different formulations.
</p>


<h3>Value</h3>

<p>A vector containing the partial derivatives of the DDM PDF with
precision <code>err_tol</code> whose length matches that of the longest input
parameter (usually <code>rt</code>).
</p>


<h3>References</h3>

<p>Navarro, D. J., &amp; Fuss, I. G. (2009). Fast and accurate
calculations for first-passage times in Wiener diffusion models. Journal
of Mathematical Psychology, 53(4), 222-230.
</p>
<p>Gondan, M., Blurton, S. P., &amp; Kesselmeier, M. (2014). Even faster and even
more accurate first-passage time densities and distributions for the
Wiener diffusion model. Journal of Mathematical Psychology, 60, 20-22.
</p>
<p>Blurton, S. P., Kesselmeier, M., &amp; Gondan, M. (2017). The first-passage
time distribution for the diffusion model with variable drift. Journal of
Mathematical Psychology, 76, 7-12.
</p>
<p>Hartmann, R., Klauer, K. C. (2021). Partial derivatives for the
first-passage time distribution in Wiener diffusion models. Journal of
Mathematical Psychology, 103, 102550.
</p>
<p>Ratcliff, R. (1978). A theory of memory retrieval. Psychological review,
85(2), 59.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># derivative with respect to rt (response time)
dt_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to t0 (non-decision time)
dt0_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

# derivative with respect to a (threshold separation)
da_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to v (drift rate)
dv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to w (relative starting point)
dw_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to sv (inter-trial variability in the drift rate)
dsv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

#-------- Log Versions --------#

# # derivative with respect to rt (response time)
# dt_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to t0 (non-decision time)
# dt0_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)

# # derivative with respect to a (threshold separation)
# da_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to v (drift rate)
# dv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to w (relative starting point)
# dw_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to sv (inter-trial variability in the drift rate)
# dsv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)
</code></pre>

<hr>
<h2 id='dsv2_dfddm'>Second-Order Partial Derivative of 5-parameter DDM PDF with respect to sv
(inter-trial variability in the drift rate)</h2><span id='topic+dsv2_dfddm'></span>

<h3>Description</h3>

<p>Second-Order Partial Derivative of the density function for the 5-parameter
variant of the Ratcliff diffusion decision model (DDM) with respect to sv,
the inter-trial variability in the drift rate. This variant contains the
following parameters:
<code>v</code> (drift rate), <code>a</code> (threshold separation),
<code>t0</code> (non-decision time/response time constant), <code>w</code>
(relative starting point), <code>sv</code> (inter-trial variability of drift),
and <code>sigma</code> (diffusion coefficient of underlying Wiener process).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dsv2_dfddm(
  rt,
  response,
  v,
  a,
  t0,
  w = 0.5,
  sv = 0,
  sigma = 1,
  sl_thresh = 0.355,
  err_tol = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dsv2_dfddm_+3A_rt">rt</code></td>
<td>
<p>A vector of response times (in seconds). If a response time is
non-positve, then its density will evaluate to <code class="reqn">0</code> if log = FALSE and
-&#8734; if log = TRUE.</p>
</td></tr>
<tr><td><code id="dsv2_dfddm_+3A_response">response</code></td>
<td>
<p>Binary response(s) that correspond(s) to either the &quot;lower&quot;
or &quot;upper&quot; threshold. This model parameter can either be a singular value
or a vector. The value(s) in 'response' can be of the following data
types:
</p>

<ul>
<li><p> integers or doubles (<code class="reqn">1</code>
&#8594; &quot;lower&quot;, <code class="reqn">2</code>
&#8594; &quot;upper&quot;);
</p>
</li>
<li><p> factors (the first level gets mapped to &quot;lower&quot;, and the second
level gets mapped to &quot;upper&quot;; any additional levels are ignored).
</p>
</li>
<li><p> strings (only the first character is checked, &quot;L&quot;
&#8594; &quot;lower&quot; or &quot;U&quot;
&#8594; &quot;upper&quot;, case insensitive);
</p>
</li>
<li><p> logicals (FALSE &#8594; &quot;lower&quot;,
TRUE &#8594; &quot;upper&quot;);
</p>
</li></ul>
</td></tr>
<tr><td><code id="dsv2_dfddm_+3A_v">v</code></td>
<td>
<p>Drift rate. Average slope of the information accumulation process.
The drift gives information about the speed and direction of the
accumulation of information. Large (absolute) values of drift indicate a
good performance. If received information supports the response linked to
the upper threshold, then the sign will be positive; similarly a negative
value indicates that the received information supports the response linked
to the lower threshold. Allowed range: <code>v</code> is a real number. Typical
range: <code class="reqn">-5 &lt;</code> <code>v</code> <code class="reqn">&lt; 5</code>.</p>
</td></tr>
<tr><td><code id="dsv2_dfddm_+3A_a">a</code></td>
<td>
<p>Threshold separation. Amount of information that is considered for
a decision. Large values indicate a conservative decisional style. Allowed
range: <code class="reqn">0 &lt;</code> <code>a</code>. Typical range: <code class="reqn">0.5 &lt;</code> <code>a</code> <code class="reqn">&lt; 2</code>.</p>
</td></tr>
<tr><td><code id="dsv2_dfddm_+3A_t0">t0</code></td>
<td>
<p>Non-decision time or response time constant (in seconds). Lower
bound for the duration of all non-decisional processes (encoding and
response execution). If this value is greater than <code>rt</code>, then the
resulting density is returned as if <code>rt</code> <code class="reqn"> \le 0</code>. Allowed range:
<code class="reqn">0 \le</code> <code>t0</code>. Typical range: <code class="reqn">0.1 &lt;</code> <code>t0</code> <code class="reqn">&lt; 0.5</code>.</p>
</td></tr>
<tr><td><code id="dsv2_dfddm_+3A_w">w</code></td>
<td>
<p>Relative starting point. Indicator of an a priori bias in decision
making. When the relative starting point <code>w</code> deviates from <code class="reqn">0.5</code>,
the amount of information necessary for a decision differs between
response alternatives. Allowed range: <code class="reqn">0 &lt;</code> <code>w</code> <code class="reqn">&lt; 1</code>.
Default value is <code class="reqn">0.5</code> (i.e., no bias).</p>
</td></tr>
<tr><td><code id="dsv2_dfddm_+3A_sv">sv</code></td>
<td>
<p>Inter-trial-variability of drift rate. Standard deviation of a
normal distribution with mean <code>v</code> describing the distribution of
actual drift rates from specific trials. Values different from <code class="reqn">0</code> can
predict slow errors. Allowed range: <code class="reqn">0 \le</code> <code>sv</code>. Typical range:
<code class="reqn">0 &lt;</code> <code>sv</code> <code class="reqn">&lt; 2</code>. Default value is <code class="reqn">0</code>, which indicates
no drift in the function call. See Details for more information.</p>
</td></tr>
<tr><td><code id="dsv2_dfddm_+3A_sigma">sigma</code></td>
<td>
<p>Diffusion coefficient of the underlying Wiener process. Allowed
range: <code class="reqn">0 &lt;</code> <code>sigma</code>. Default value is <code class="reqn">1</code>. This parameter
simply scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code> as follows.
See Details for more information. </p>
 <ul>
<li> <p><code>a</code>
&#8594; <code>a</code> <code class="reqn">/</code> <code>sigma</code>
</p>
</li>
<li> <p><code>v</code> &#8594; <code>v</code> <code class="reqn">/</code>
<code>sigma</code> </p>
</li>
<li> <p><code>sv</code> &#8594;
<code>sv</code> <code class="reqn">/</code> <code>sigma</code> </p>
</li></ul>
<p>.</p>
</td></tr>
<tr><td><code id="dsv2_dfddm_+3A_sl_thresh">sl_thresh</code></td>
<td>
<p>Threshold for deciding when to use the &quot;small-time&quot; variant
or the &quot;large-time&quot; variant. If the &quot;effective response time&quot; is greater
than <code>sl_thresh</code> (i.e., <code class="reqn">\frac{rt}{a^2} &gt;</code> <code>sl_thresh</code>),
then the &quot;large-time&quot; variant is used; otherwise, the &quot;small-time&quot; variant
is used. Allowed values are any real number; however any non-positive
number means that the &quot;large-time&quot; variant will always be used. Similarly,
any very large positive number (e.g., +Inf) means that the &quot;small-time&quot;
variant will always be used. Default value is <code class="reqn">0.355</code>.</p>
</td></tr>
<tr><td><code id="dsv2_dfddm_+3A_err_tol">err_tol</code></td>
<td>
<p>Allowed error tolerance of the overall calculation. Since the
partial derivative of the density function contains one infinite sum, this
parameter defines the precision of the approximation to that infinite sum.
If the provided error tolerance is less than <code class="reqn">1e-300</code>, it is set to
<code class="reqn">1e-300</code>. Default is <code class="reqn">1e-6</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All of the model inputs and parameters (<code>rt</code>, <code>response</code>,
<code>v</code>, <code>a</code>, <code>t0</code>, <code>w</code>, <code>sv</code>, <code>sigma</code>) can be
input as a single value or as a vector of values. If input as a vector of
values, then the standard <code>R</code> input wrapping will occur.
</p>
<p><code>sv</code> - Both the &quot;small-time&quot; and &quot;large-time&quot; variants of the density
function have two further variants: one with a constant drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">= 0</code>), and one with a variable drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">&gt; 0</code>). The details of the differences between these
two density functions can be found in our associated paper. To use the
density function with a constant drift rate, leave the parameter <code>sv</code>
to its default value of <code>sv = 0</code>, as this will indicate no drift to the
function. To use the density function with a variable drift rate, set the
parameter <code>sv</code> to some non-negative value, i.e., <code>sv</code> <code class="reqn">&gt; 0</code>.
</p>
<p><code>sigma</code> - The default value of this parameter is <code>1</code> because it
only scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code>, as shown
above. However, other formulations of the DDM may set <code>sigma = 0.1</code>
(see Ratcliff (1978), the fourth reference), so care must be taken when
comparing the results of different formulations.
</p>


<h3>Value</h3>

<p>A vector containing the second-order partial derivatives of the
DDM PDF with precision <code>err_tol</code> whose length matches that of the
longest input parameter (usually <code>rt</code>).
</p>


<h3>References</h3>

<p>Navarro, D. J., &amp; Fuss, I. G. (2009). Fast and accurate
calculations for first-passage times in Wiener diffusion models. Journal
of Mathematical Psychology, 53(4), 222-230.
</p>
<p>Gondan, M., Blurton, S. P., &amp; Kesselmeier, M. (2014). Even faster and even
more accurate first-passage time densities and distributions for the
Wiener diffusion model. Journal of Mathematical Psychology, 60, 20-22.
</p>
<p>Blurton, S. P., Kesselmeier, M., &amp; Gondan, M. (2017). The first-passage
time distribution for the diffusion model with variable drift. Journal of
Mathematical Psychology, 76, 7-12.
</p>
<p>Hartmann, R., Klauer, K. C. (2021). Partial derivatives for the
first-passage time distribution in Wiener diffusion models. Journal of
Mathematical Psychology, 103, 102550.
</p>
<p>Ratcliff, R. (1978). A theory of memory retrieval. Psychological review,
85(2), 59.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># derivative with respect to rt (response time)
dt_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to t0 (non-decision time)
dt0_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

# derivative with respect to a (threshold separation)
da_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to v (drift rate)
dv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to w (relative starting point)
dw_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to sv (inter-trial variability in the drift rate)
dsv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

#-------- Log Versions --------#

# # derivative with respect to rt (response time)
# dt_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to t0 (non-decision time)
# dt0_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)

# # derivative with respect to a (threshold separation)
# da_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to v (drift rate)
# dv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to w (relative starting point)
# dw_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to sv (inter-trial variability in the drift rate)
# dsv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)
</code></pre>

<hr>
<h2 id='dt_dfddm'>Partial Derivative of 5-parameter DDM PDF with respect to t (response time)</h2><span id='topic+dt_dfddm'></span>

<h3>Description</h3>

<p>Partial Derivative of the density function for the 5-parameter variant of
the Ratcliff diffusion decision model (DDM) with respect to t, the
response time. This variant contains the following parameters:
<code>v</code> (drift rate), <code>a</code> (threshold separation),
<code>t0</code> (non-decision time/response time constant), <code>w</code>
(relative starting point), <code>sv</code> (inter-trial variability of drift),
and <code>sigma</code> (diffusion coefficient of underlying Wiener process).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dt_dfddm(
  rt,
  response,
  v,
  a,
  t0,
  w = 0.5,
  sv = 0,
  sigma = 1,
  sl_thresh = 0.5,
  err_tol = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dt_dfddm_+3A_rt">rt</code></td>
<td>
<p>A vector of response times (in seconds). If a response time is
non-positve, then its density will evaluate to <code class="reqn">0</code> if log = FALSE and
-&#8734; if log = TRUE.</p>
</td></tr>
<tr><td><code id="dt_dfddm_+3A_response">response</code></td>
<td>
<p>Binary response(s) that correspond(s) to either the &quot;lower&quot;
or &quot;upper&quot; threshold. This model parameter can either be a singular value
or a vector. The value(s) in 'response' can be of the following data
types:
</p>

<ul>
<li><p> integers or doubles (<code class="reqn">1</code>
&#8594; &quot;lower&quot;, <code class="reqn">2</code>
&#8594; &quot;upper&quot;);
</p>
</li>
<li><p> factors (the first level gets mapped to &quot;lower&quot;, and the second
level gets mapped to &quot;upper&quot;; any additional levels are ignored).
</p>
</li>
<li><p> strings (only the first character is checked, &quot;L&quot;
&#8594; &quot;lower&quot; or &quot;U&quot;
&#8594; &quot;upper&quot;, case insensitive);
</p>
</li>
<li><p> logicals (FALSE &#8594; &quot;lower&quot;,
TRUE &#8594; &quot;upper&quot;);
</p>
</li></ul>
</td></tr>
<tr><td><code id="dt_dfddm_+3A_v">v</code></td>
<td>
<p>Drift rate. Average slope of the information accumulation process.
The drift gives information about the speed and direction of the
accumulation of information. Large (absolute) values of drift indicate a
good performance. If received information supports the response linked to
the upper threshold, then the sign will be positive; similarly a negative
value indicates that the received information supports the response linked
to the lower threshold. Allowed range: <code>v</code> is a real number. Typical
range: <code class="reqn">-5 &lt;</code> <code>v</code> <code class="reqn">&lt; 5</code>.</p>
</td></tr>
<tr><td><code id="dt_dfddm_+3A_a">a</code></td>
<td>
<p>Threshold separation. Amount of information that is considered for
a decision. Large values indicate a conservative decisional style. Allowed
range: <code class="reqn">0 &lt;</code> <code>a</code>. Typical range: <code class="reqn">0.5 &lt;</code> <code>a</code> <code class="reqn">&lt; 2</code>.</p>
</td></tr>
<tr><td><code id="dt_dfddm_+3A_t0">t0</code></td>
<td>
<p>Non-decision time or response time constant (in seconds). Lower
bound for the duration of all non-decisional processes (encoding and
response execution). If this value is greater than <code>rt</code>, then the
resulting density is returned as if <code>rt</code> <code class="reqn"> \le 0</code>. Allowed range:
<code class="reqn">0 \le</code> <code>t0</code>. Typical range: <code class="reqn">0.1 &lt;</code> <code>t0</code> <code class="reqn">&lt; 0.5</code>.</p>
</td></tr>
<tr><td><code id="dt_dfddm_+3A_w">w</code></td>
<td>
<p>Relative starting point. Indicator of an a priori bias in decision
making. When the relative starting point <code>w</code> deviates from <code class="reqn">0.5</code>,
the amount of information necessary for a decision differs between
response alternatives. Allowed range: <code class="reqn">0 &lt;</code> <code>w</code> <code class="reqn">&lt; 1</code>.
Default value is <code class="reqn">0.5</code> (i.e., no bias).</p>
</td></tr>
<tr><td><code id="dt_dfddm_+3A_sv">sv</code></td>
<td>
<p>Inter-trial-variability of drift rate. Standard deviation of a
normal distribution with mean <code>v</code> describing the distribution of
actual drift rates from specific trials. Values different from <code class="reqn">0</code> can
predict slow errors. Allowed range: <code class="reqn">0 \le</code> <code>sv</code>. Typical range:
<code class="reqn">0 &lt;</code> <code>sv</code> <code class="reqn">&lt; 2</code>. Default value is <code class="reqn">0</code>, which indicates
no drift in the function call. See Details for more information.</p>
</td></tr>
<tr><td><code id="dt_dfddm_+3A_sigma">sigma</code></td>
<td>
<p>Diffusion coefficient of the underlying Wiener process. Allowed
range: <code class="reqn">0 &lt;</code> <code>sigma</code>. Default value is <code class="reqn">1</code>. This parameter
simply scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code> as follows.
See Details for more information. </p>
 <ul>
<li> <p><code>a</code>
&#8594; <code>a</code> <code class="reqn">/</code> <code>sigma</code>
</p>
</li>
<li> <p><code>v</code> &#8594; <code>v</code> <code class="reqn">/</code>
<code>sigma</code> </p>
</li>
<li> <p><code>sv</code> &#8594;
<code>sv</code> <code class="reqn">/</code> <code>sigma</code> </p>
</li></ul>
<p>.</p>
</td></tr>
<tr><td><code id="dt_dfddm_+3A_sl_thresh">sl_thresh</code></td>
<td>
<p>Threshold for deciding when to use the &quot;small-time&quot; variant
or the &quot;large-time&quot; variant. If the &quot;effective response time&quot; is greater
than <code>sl_thresh</code> (i.e., <code class="reqn">\frac{rt}{a^2} &gt;</code> <code>sl_thresh</code>),
then the &quot;large-time&quot; variant is used; otherwise, the &quot;small-time&quot; variant
is used. Allowed values are any real number; however any non-positive
number means that the &quot;large-time&quot; variant will always be used. Similarly,
any very large positive number (e.g., +Inf) means that the &quot;small-time&quot;
variant will always be used. Default value is <code class="reqn">0.5</code>.</p>
</td></tr>
<tr><td><code id="dt_dfddm_+3A_err_tol">err_tol</code></td>
<td>
<p>Allowed error tolerance of the overall calculation. Since the
partial derivative of the density function contains the sum of two
infinite sums, each approximation of these two infinite sums will have an
individual error tolerance of <code>err_tol</code> / 2; thus the total overall
error of the calculation will be at most <code>err_tol</code>. If the provided
error tolerance is less than <code class="reqn">1e-300</code>, it is set to <code class="reqn">1e-300</code>.
Default is <code class="reqn">1e-6</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All of the model inputs and parameters (<code>rt</code>, <code>response</code>,
<code>v</code>, <code>a</code>, <code>t0</code>, <code>w</code>, <code>sv</code>, <code>sigma</code>) can be
input as a single value or as a vector of values. If input as a vector of
values, then the standard <code>R</code> input wrapping will occur.
</p>
<p><code>sv</code> - Both the &quot;small-time&quot; and &quot;large-time&quot; variants of the density
function have two further variants: one with a constant drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">= 0</code>), and one with a variable drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">&gt; 0</code>). The details of the differences between these
two density functions can be found in our associated paper. To use the
density function with a constant drift rate, leave the parameter <code>sv</code>
to its default value of <code>sv = 0</code>, as this will indicate no drift to the
function. To use the density function with a variable drift rate, set the
parameter <code>sv</code> to some non-negative value, i.e., <code>sv</code> <code class="reqn">&gt; 0</code>.
</p>
<p><code>sigma</code> - The default value of this parameter is <code>1</code> because it
only scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code>, as shown
above. However, other formulations of the DDM may set <code>sigma = 0.1</code>
(see Ratcliff (1978), the fourth reference), so care must be taken when
comparing the results of different formulations.
</p>


<h3>Value</h3>

<p>A vector containing the partial derivatives of the DDM PDF with
precision <code>err_tol</code> whose length matches that of the longest input
parameter (usually <code>rt</code>).
</p>


<h3>References</h3>

<p>Navarro, D. J., &amp; Fuss, I. G. (2009). Fast and accurate
calculations for first-passage times in Wiener diffusion models. Journal
of Mathematical Psychology, 53(4), 222-230.
</p>
<p>Gondan, M., Blurton, S. P., &amp; Kesselmeier, M. (2014). Even faster and even
more accurate first-passage time densities and distributions for the
Wiener diffusion model. Journal of Mathematical Psychology, 60, 20-22.
</p>
<p>Blurton, S. P., Kesselmeier, M., &amp; Gondan, M. (2017). The first-passage
time distribution for the diffusion model with variable drift. Journal of
Mathematical Psychology, 76, 7-12.
</p>
<p>Hartmann, R., Klauer, K. C. (2021). Partial derivatives for the
first-passage time distribution in Wiener diffusion models. Journal of
Mathematical Psychology, 103, 102550.
</p>
<p>Ratcliff, R. (1978). A theory of memory retrieval. Psychological review,
85(2), 59.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># derivative with respect to rt (response time)
dt_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to t0 (non-decision time)
dt0_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

# derivative with respect to a (threshold separation)
da_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to v (drift rate)
dv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to w (relative starting point)
dw_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to sv (inter-trial variability in the drift rate)
dsv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

#-------- Log Versions --------#

# # derivative with respect to rt (response time)
# dt_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to t0 (non-decision time)
# dt0_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)

# # derivative with respect to a (threshold separation)
# da_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to v (drift rate)
# dv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to w (relative starting point)
# dw_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to sv (inter-trial variability in the drift rate)
# dsv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)
</code></pre>

<hr>
<h2 id='dt0_dfddm'>Partial Derivative of 5-parameter DDM PDF with respect to t0 (non-decision
time)</h2><span id='topic+dt0_dfddm'></span>

<h3>Description</h3>

<p>Partial Derivative of the density function for the 5-parameter variant of
the Ratcliff diffusion decision model (DDM) with respect to t0, the
non-decision time. This variant contains the following parameters:
<code>v</code> (drift rate), <code>a</code> (threshold separation),
<code>t0</code> (non-decision time/response time constant), <code>w</code>
(relative starting point), <code>sv</code> (inter-trial variability of drift),
and <code>sigma</code> (diffusion coefficient of underlying Wiener process).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dt0_dfddm(
  rt,
  response,
  v,
  a,
  t0,
  w = 0.5,
  sv = 0,
  sigma = 1,
  sl_thresh = 0.5,
  err_tol = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dt0_dfddm_+3A_rt">rt</code></td>
<td>
<p>A vector of response times (in seconds). If a response time is
non-positve, then its density will evaluate to <code class="reqn">0</code> if log = FALSE and
-&#8734; if log = TRUE.</p>
</td></tr>
<tr><td><code id="dt0_dfddm_+3A_response">response</code></td>
<td>
<p>Binary response(s) that correspond(s) to either the &quot;lower&quot;
or &quot;upper&quot; threshold. This model parameter can either be a singular value
or a vector. The value(s) in 'response' can be of the following data
types:
</p>

<ul>
<li><p> integers or doubles (<code class="reqn">1</code>
&#8594; &quot;lower&quot;, <code class="reqn">2</code>
&#8594; &quot;upper&quot;);
</p>
</li>
<li><p> factors (the first level gets mapped to &quot;lower&quot;, and the second
level gets mapped to &quot;upper&quot;; any additional levels are ignored).
</p>
</li>
<li><p> strings (only the first character is checked, &quot;L&quot;
&#8594; &quot;lower&quot; or &quot;U&quot;
&#8594; &quot;upper&quot;, case insensitive);
</p>
</li>
<li><p> logicals (FALSE &#8594; &quot;lower&quot;,
TRUE &#8594; &quot;upper&quot;);
</p>
</li></ul>
</td></tr>
<tr><td><code id="dt0_dfddm_+3A_v">v</code></td>
<td>
<p>Drift rate. Average slope of the information accumulation process.
The drift gives information about the speed and direction of the
accumulation of information. Large (absolute) values of drift indicate a
good performance. If received information supports the response linked to
the upper threshold, then the sign will be positive; similarly a negative
value indicates that the received information supports the response linked
to the lower threshold. Allowed range: <code>v</code> is a real number. Typical
range: <code class="reqn">-5 &lt;</code> <code>v</code> <code class="reqn">&lt; 5</code>.</p>
</td></tr>
<tr><td><code id="dt0_dfddm_+3A_a">a</code></td>
<td>
<p>Threshold separation. Amount of information that is considered for
a decision. Large values indicate a conservative decisional style. Allowed
range: <code class="reqn">0 &lt;</code> <code>a</code>. Typical range: <code class="reqn">0.5 &lt;</code> <code>a</code> <code class="reqn">&lt; 2</code>.</p>
</td></tr>
<tr><td><code id="dt0_dfddm_+3A_t0">t0</code></td>
<td>
<p>Non-decision time or response time constant (in seconds). Lower
bound for the duration of all non-decisional processes (encoding and
response execution). If this value is greater than <code>rt</code>, then the
resulting density is returned as if <code>rt</code> <code class="reqn"> \le 0</code>. Allowed range:
<code class="reqn">0 \le</code> <code>t0</code>. Typical range: <code class="reqn">0.1 &lt;</code> <code>t0</code> <code class="reqn">&lt; 0.5</code>.</p>
</td></tr>
<tr><td><code id="dt0_dfddm_+3A_w">w</code></td>
<td>
<p>Relative starting point. Indicator of an a priori bias in decision
making. When the relative starting point <code>w</code> deviates from <code class="reqn">0.5</code>,
the amount of information necessary for a decision differs between
response alternatives. Allowed range: <code class="reqn">0 &lt;</code> <code>w</code> <code class="reqn">&lt; 1</code>.
Default value is <code class="reqn">0.5</code> (i.e., no bias).</p>
</td></tr>
<tr><td><code id="dt0_dfddm_+3A_sv">sv</code></td>
<td>
<p>Inter-trial-variability of drift rate. Standard deviation of a
normal distribution with mean <code>v</code> describing the distribution of
actual drift rates from specific trials. Values different from <code class="reqn">0</code> can
predict slow errors. Allowed range: <code class="reqn">0 \le</code> <code>sv</code>. Typical range:
<code class="reqn">0 &lt;</code> <code>sv</code> <code class="reqn">&lt; 2</code>. Default value is <code class="reqn">0</code>, which indicates
no drift in the function call. See Details for more information.</p>
</td></tr>
<tr><td><code id="dt0_dfddm_+3A_sigma">sigma</code></td>
<td>
<p>Diffusion coefficient of the underlying Wiener process. Allowed
range: <code class="reqn">0 &lt;</code> <code>sigma</code>. Default value is <code class="reqn">1</code>. This parameter
simply scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code> as follows.
See Details for more information. </p>
 <ul>
<li> <p><code>a</code>
&#8594; <code>a</code> <code class="reqn">/</code> <code>sigma</code>
</p>
</li>
<li> <p><code>v</code> &#8594; <code>v</code> <code class="reqn">/</code>
<code>sigma</code> </p>
</li>
<li> <p><code>sv</code> &#8594;
<code>sv</code> <code class="reqn">/</code> <code>sigma</code> </p>
</li></ul>
<p>.</p>
</td></tr>
<tr><td><code id="dt0_dfddm_+3A_sl_thresh">sl_thresh</code></td>
<td>
<p>Threshold for deciding when to use the &quot;small-time&quot; variant
or the &quot;large-time&quot; variant. If the &quot;effective response time&quot; is greater
than <code>sl_thresh</code> (i.e., <code class="reqn">\frac{rt}{a^2} &gt;</code> <code>sl_thresh</code>),
then the &quot;large-time&quot; variant is used; otherwise, the &quot;small-time&quot; variant
is used. Allowed values are any real number; however any non-positive
number means that the &quot;large-time&quot; variant will always be used. Similarly,
any very large positive number (e.g., +Inf) means that the &quot;small-time&quot;
variant will always be used. Default value is <code class="reqn">0.5</code>.</p>
</td></tr>
<tr><td><code id="dt0_dfddm_+3A_err_tol">err_tol</code></td>
<td>
<p>Allowed error tolerance of the overall calculation. Since the
partial derivative of the density function contains the sum of two
infinite sums, each approximation of these two infinite sums will have an
individual error tolerance of <code>err_tol</code> / 2; thus the total overall
error of the calculation will be at most <code>err_tol</code>. If the provided
error tolerance is less than <code class="reqn">1e-300</code>, it is set to <code class="reqn">1e-300</code>.
Default is <code class="reqn">1e-6</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All of the model inputs and parameters (<code>rt</code>, <code>response</code>,
<code>v</code>, <code>a</code>, <code>t0</code>, <code>w</code>, <code>sv</code>, <code>sigma</code>) can be
input as a single value or as a vector of values. If input as a vector of
values, then the standard <code>R</code> input wrapping will occur.
</p>
<p><code>sv</code> - Both the &quot;small-time&quot; and &quot;large-time&quot; variants of the density
function have two further variants: one with a constant drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">= 0</code>), and one with a variable drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">&gt; 0</code>). The details of the differences between these
two density functions can be found in our associated paper. To use the
density function with a constant drift rate, leave the parameter <code>sv</code>
to its default value of <code>sv = 0</code>, as this will indicate no drift to the
function. To use the density function with a variable drift rate, set the
parameter <code>sv</code> to some non-negative value, i.e., <code>sv</code> <code class="reqn">&gt; 0</code>.
</p>
<p><code>sigma</code> - The default value of this parameter is <code>1</code> because it
only scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code>, as shown
above. However, other formulations of the DDM may set <code>sigma = 0.1</code>
(see Ratcliff (1978), the fourth reference), so care must be taken when
comparing the results of different formulations.
</p>


<h3>Value</h3>

<p>A vector containing the partial derivatives of the DDM PDF with
precision <code>err_tol</code> whose length matches that of the longest input
parameter (usually <code>rt</code>).
</p>


<h3>References</h3>

<p>Navarro, D. J., &amp; Fuss, I. G. (2009). Fast and accurate
calculations for first-passage times in Wiener diffusion models. Journal
of Mathematical Psychology, 53(4), 222-230.
</p>
<p>Gondan, M., Blurton, S. P., &amp; Kesselmeier, M. (2014). Even faster and even
more accurate first-passage time densities and distributions for the
Wiener diffusion model. Journal of Mathematical Psychology, 60, 20-22.
</p>
<p>Blurton, S. P., Kesselmeier, M., &amp; Gondan, M. (2017). The first-passage
time distribution for the diffusion model with variable drift. Journal of
Mathematical Psychology, 76, 7-12.
</p>
<p>Hartmann, R., Klauer, K. C. (2021). Partial derivatives for the
first-passage time distribution in Wiener diffusion models. Journal of
Mathematical Psychology, 103, 102550.
</p>
<p>Ratcliff, R. (1978). A theory of memory retrieval. Psychological review,
85(2), 59.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># derivative with respect to rt (response time)
dt_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to t0 (non-decision time)
dt0_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

# derivative with respect to a (threshold separation)
da_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to v (drift rate)
dv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to w (relative starting point)
dw_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to sv (inter-trial variability in the drift rate)
dsv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

#-------- Log Versions --------#

# # derivative with respect to rt (response time)
# dt_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to t0 (non-decision time)
# dt0_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)

# # derivative with respect to a (threshold separation)
# da_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to v (drift rate)
# dv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to w (relative starting point)
# dw_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to sv (inter-trial variability in the drift rate)
# dsv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)
</code></pre>

<hr>
<h2 id='dt02_dfddm'>Second-Order Partial Derivative of 5-parameter DDM PDF with respect to t0
(non-decision time)</h2><span id='topic+dt02_dfddm'></span>

<h3>Description</h3>

<p>Second-Order Partial Derivative of the density function for the 5-parameter
variant of the Ratcliff diffusion decision model (DDM) with respect to t0,
the non-decision time. This variant contains the following parameters:
<code>v</code> (drift rate), <code>a</code> (threshold separation),
<code>t0</code> (non-decision time/response time constant), <code>w</code>
(relative starting point), <code>sv</code> (inter-trial variability of drift),
and <code>sigma</code> (diffusion coefficient of underlying Wiener process).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dt02_dfddm(
  rt,
  response,
  v,
  a,
  t0,
  w = 0.5,
  sv = 0,
  sigma = 1,
  sl_thresh = 0.44,
  err_tol = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dt02_dfddm_+3A_rt">rt</code></td>
<td>
<p>A vector of response times (in seconds). If a response time is
non-positve, then its density will evaluate to <code class="reqn">0</code> if log = FALSE and
-&#8734; if log = TRUE.</p>
</td></tr>
<tr><td><code id="dt02_dfddm_+3A_response">response</code></td>
<td>
<p>Binary response(s) that correspond(s) to either the &quot;lower&quot;
or &quot;upper&quot; threshold. This model parameter can either be a singular value
or a vector. The value(s) in 'response' can be of the following data
types:
</p>

<ul>
<li><p> integers or doubles (<code class="reqn">1</code>
&#8594; &quot;lower&quot;, <code class="reqn">2</code>
&#8594; &quot;upper&quot;);
</p>
</li>
<li><p> factors (the first level gets mapped to &quot;lower&quot;, and the second
level gets mapped to &quot;upper&quot;; any additional levels are ignored).
</p>
</li>
<li><p> strings (only the first character is checked, &quot;L&quot;
&#8594; &quot;lower&quot; or &quot;U&quot;
&#8594; &quot;upper&quot;, case insensitive);
</p>
</li>
<li><p> logicals (FALSE &#8594; &quot;lower&quot;,
TRUE &#8594; &quot;upper&quot;);
</p>
</li></ul>
</td></tr>
<tr><td><code id="dt02_dfddm_+3A_v">v</code></td>
<td>
<p>Drift rate. Average slope of the information accumulation process.
The drift gives information about the speed and direction of the
accumulation of information. Large (absolute) values of drift indicate a
good performance. If received information supports the response linked to
the upper threshold, then the sign will be positive; similarly a negative
value indicates that the received information supports the response linked
to the lower threshold. Allowed range: <code>v</code> is a real number. Typical
range: <code class="reqn">-5 &lt;</code> <code>v</code> <code class="reqn">&lt; 5</code>.</p>
</td></tr>
<tr><td><code id="dt02_dfddm_+3A_a">a</code></td>
<td>
<p>Threshold separation. Amount of information that is considered for
a decision. Large values indicate a conservative decisional style. Allowed
range: <code class="reqn">0 &lt;</code> <code>a</code>. Typical range: <code class="reqn">0.5 &lt;</code> <code>a</code> <code class="reqn">&lt; 2</code>.</p>
</td></tr>
<tr><td><code id="dt02_dfddm_+3A_t0">t0</code></td>
<td>
<p>Non-decision time or response time constant (in seconds). Lower
bound for the duration of all non-decisional processes (encoding and
response execution). If this value is greater than <code>rt</code>, then the
resulting density is returned as if <code>rt</code> <code class="reqn"> \le 0</code>. Allowed range:
<code class="reqn">0 \le</code> <code>t0</code>. Typical range: <code class="reqn">0.1 &lt;</code> <code>t0</code> <code class="reqn">&lt; 0.5</code>.</p>
</td></tr>
<tr><td><code id="dt02_dfddm_+3A_w">w</code></td>
<td>
<p>Relative starting point. Indicator of an a priori bias in decision
making. When the relative starting point <code>w</code> deviates from <code class="reqn">0.5</code>,
the amount of information necessary for a decision differs between
response alternatives. Allowed range: <code class="reqn">0 &lt;</code> <code>w</code> <code class="reqn">&lt; 1</code>.
Default value is <code class="reqn">0.5</code> (i.e., no bias).</p>
</td></tr>
<tr><td><code id="dt02_dfddm_+3A_sv">sv</code></td>
<td>
<p>Inter-trial-variability of drift rate. Standard deviation of a
normal distribution with mean <code>v</code> describing the distribution of
actual drift rates from specific trials. Values different from <code class="reqn">0</code> can
predict slow errors. Allowed range: <code class="reqn">0 \le</code> <code>sv</code>. Typical range:
<code class="reqn">0 &lt;</code> <code>sv</code> <code class="reqn">&lt; 2</code>. Default value is <code class="reqn">0</code>, which indicates
no drift in the function call. See Details for more information.</p>
</td></tr>
<tr><td><code id="dt02_dfddm_+3A_sigma">sigma</code></td>
<td>
<p>Diffusion coefficient of the underlying Wiener process. Allowed
range: <code class="reqn">0 &lt;</code> <code>sigma</code>. Default value is <code class="reqn">1</code>. This parameter
simply scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code> as follows.
See Details for more information. </p>
 <ul>
<li> <p><code>a</code>
&#8594; <code>a</code> <code class="reqn">/</code> <code>sigma</code>
</p>
</li>
<li> <p><code>v</code> &#8594; <code>v</code> <code class="reqn">/</code>
<code>sigma</code> </p>
</li>
<li> <p><code>sv</code> &#8594;
<code>sv</code> <code class="reqn">/</code> <code>sigma</code> </p>
</li></ul>
<p>.</p>
</td></tr>
<tr><td><code id="dt02_dfddm_+3A_sl_thresh">sl_thresh</code></td>
<td>
<p>Threshold for deciding when to use the &quot;small-time&quot; variant
or the &quot;large-time&quot; variant. If the &quot;effective response time&quot; is greater
than <code>sl_thresh</code> (i.e., <code class="reqn">\frac{rt}{a^2} &gt;</code> <code>sl_thresh</code>),
then the &quot;large-time&quot; variant is used; otherwise, the &quot;small-time&quot; variant
is used. Allowed values are any real number; however any non-positive
number means that the &quot;large-time&quot; variant will always be used. Similarly,
any very large positive number (e.g., +Inf) means that the &quot;small-time&quot;
variant will always be used. Default value is <code class="reqn">0.5</code>.</p>
</td></tr>
<tr><td><code id="dt02_dfddm_+3A_err_tol">err_tol</code></td>
<td>
<p>Allowed error tolerance of the overall calculation. Since the
partial derivative of the density function contains the sum of two
infinite sums, each approximation of these two infinite sums will have an
individual error tolerance of <code>err_tol</code> / 2; thus the total overall
error of the calculation will be at most <code>err_tol</code>. If the provided
error tolerance is less than <code class="reqn">1e-300</code>, it is set to <code class="reqn">1e-300</code>.
Default is <code class="reqn">1e-6</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All of the model inputs and parameters (<code>rt</code>, <code>response</code>,
<code>v</code>, <code>a</code>, <code>t0</code>, <code>w</code>, <code>sv</code>, <code>sigma</code>) can be
input as a single value or as a vector of values. If input as a vector of
values, then the standard <code>R</code> input wrapping will occur.
</p>
<p><code>sv</code> - Both the &quot;small-time&quot; and &quot;large-time&quot; variants of the density
function have two further variants: one with a constant drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">= 0</code>), and one with a variable drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">&gt; 0</code>). The details of the differences between these
two density functions can be found in our associated paper. To use the
density function with a constant drift rate, leave the parameter <code>sv</code>
to its default value of <code>sv = 0</code>, as this will indicate no drift to the
function. To use the density function with a variable drift rate, set the
parameter <code>sv</code> to some non-negative value, i.e., <code>sv</code> <code class="reqn">&gt; 0</code>.
</p>
<p><code>sigma</code> - The default value of this parameter is <code>1</code> because it
only scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code>, as shown
above. However, other formulations of the DDM may set <code>sigma = 0.1</code>
(see Ratcliff (1978), the fourth reference), so care must be taken when
comparing the results of different formulations.
</p>


<h3>Value</h3>

<p>A vector containing the second-order partial derivatives of the
DDM PDF with precision <code>err_tol</code> whose length matches that of the
longest input parameter (usually <code>rt</code>).
</p>


<h3>References</h3>

<p>Navarro, D. J., &amp; Fuss, I. G. (2009). Fast and accurate
calculations for first-passage times in Wiener diffusion models. Journal
of Mathematical Psychology, 53(4), 222-230.
</p>
<p>Gondan, M., Blurton, S. P., &amp; Kesselmeier, M. (2014). Even faster and even
more accurate first-passage time densities and distributions for the
Wiener diffusion model. Journal of Mathematical Psychology, 60, 20-22.
</p>
<p>Blurton, S. P., Kesselmeier, M., &amp; Gondan, M. (2017). The first-passage
time distribution for the diffusion model with variable drift. Journal of
Mathematical Psychology, 76, 7-12.
</p>
<p>Hartmann, R., Klauer, K. C. (2021). Partial derivatives for the
first-passage time distribution in Wiener diffusion models. Journal of
Mathematical Psychology, 103, 102550.
</p>
<p>Ratcliff, R. (1978). A theory of memory retrieval. Psychological review,
85(2), 59.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># derivative with respect to rt (response time)
dt_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to t0 (non-decision time)
dt0_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

# derivative with respect to a (threshold separation)
da_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to v (drift rate)
dv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to w (relative starting point)
dw_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to sv (inter-trial variability in the drift rate)
dsv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

#-------- Log Versions --------#

# # derivative with respect to rt (response time)
# dt_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to t0 (non-decision time)
# dt0_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)

# # derivative with respect to a (threshold separation)
# da_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to v (drift rate)
# dv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to w (relative starting point)
# dw_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to sv (inter-trial variability in the drift rate)
# dsv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)
</code></pre>

<hr>
<h2 id='dt2_dfddm'>Second-Order Partial Derivative of 5-parameter DDM PDF with respect to t
(response time)</h2><span id='topic+dt2_dfddm'></span>

<h3>Description</h3>

<p>Second-Order Partial Derivative of the density function for the 5-parameter
variant of the Ratcliff diffusion decision model (DDM) with respect to t,
the response time. This variant contains the following parameters:
<code>v</code> (drift rate), <code>a</code> (threshold separation),
<code>t0</code> (non-decision time/response time constant), <code>w</code>
(relative starting point), <code>sv</code> (inter-trial variability of drift),
and <code>sigma</code> (diffusion coefficient of underlying Wiener process).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dt2_dfddm(
  rt,
  response,
  v,
  a,
  t0,
  w = 0.5,
  sv = 0,
  sigma = 1,
  sl_thresh = 0.5,
  err_tol = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dt2_dfddm_+3A_rt">rt</code></td>
<td>
<p>A vector of response times (in seconds). If a response time is
non-positve, then its density will evaluate to <code class="reqn">0</code> if log = FALSE and
-&#8734; if log = TRUE.</p>
</td></tr>
<tr><td><code id="dt2_dfddm_+3A_response">response</code></td>
<td>
<p>Binary response(s) that correspond(s) to either the &quot;lower&quot;
or &quot;upper&quot; threshold. This model parameter can either be a singular value
or a vector. The value(s) in 'response' can be of the following data
types:
</p>

<ul>
<li><p> integers or doubles (<code class="reqn">1</code>
&#8594; &quot;lower&quot;, <code class="reqn">2</code>
&#8594; &quot;upper&quot;);
</p>
</li>
<li><p> factors (the first level gets mapped to &quot;lower&quot;, and the second
level gets mapped to &quot;upper&quot;; any additional levels are ignored).
</p>
</li>
<li><p> strings (only the first character is checked, &quot;L&quot;
&#8594; &quot;lower&quot; or &quot;U&quot;
&#8594; &quot;upper&quot;, case insensitive);
</p>
</li>
<li><p> logicals (FALSE &#8594; &quot;lower&quot;,
TRUE &#8594; &quot;upper&quot;);
</p>
</li></ul>
</td></tr>
<tr><td><code id="dt2_dfddm_+3A_v">v</code></td>
<td>
<p>Drift rate. Average slope of the information accumulation process.
The drift gives information about the speed and direction of the
accumulation of information. Large (absolute) values of drift indicate a
good performance. If received information supports the response linked to
the upper threshold, then the sign will be positive; similarly a negative
value indicates that the received information supports the response linked
to the lower threshold. Allowed range: <code>v</code> is a real number. Typical
range: <code class="reqn">-5 &lt;</code> <code>v</code> <code class="reqn">&lt; 5</code>.</p>
</td></tr>
<tr><td><code id="dt2_dfddm_+3A_a">a</code></td>
<td>
<p>Threshold separation. Amount of information that is considered for
a decision. Large values indicate a conservative decisional style. Allowed
range: <code class="reqn">0 &lt;</code> <code>a</code>. Typical range: <code class="reqn">0.5 &lt;</code> <code>a</code> <code class="reqn">&lt; 2</code>.</p>
</td></tr>
<tr><td><code id="dt2_dfddm_+3A_t0">t0</code></td>
<td>
<p>Non-decision time or response time constant (in seconds). Lower
bound for the duration of all non-decisional processes (encoding and
response execution). If this value is greater than <code>rt</code>, then the
resulting density is returned as if <code>rt</code> <code class="reqn"> \le 0</code>. Allowed range:
<code class="reqn">0 \le</code> <code>t0</code>. Typical range: <code class="reqn">0.1 &lt;</code> <code>t0</code> <code class="reqn">&lt; 0.5</code>.</p>
</td></tr>
<tr><td><code id="dt2_dfddm_+3A_w">w</code></td>
<td>
<p>Relative starting point. Indicator of an a priori bias in decision
making. When the relative starting point <code>w</code> deviates from <code class="reqn">0.5</code>,
the amount of information necessary for a decision differs between
response alternatives. Allowed range: <code class="reqn">0 &lt;</code> <code>w</code> <code class="reqn">&lt; 1</code>.
Default value is <code class="reqn">0.5</code> (i.e., no bias).</p>
</td></tr>
<tr><td><code id="dt2_dfddm_+3A_sv">sv</code></td>
<td>
<p>Inter-trial-variability of drift rate. Standard deviation of a
normal distribution with mean <code>v</code> describing the distribution of
actual drift rates from specific trials. Values different from <code class="reqn">0</code> can
predict slow errors. Allowed range: <code class="reqn">0 \le</code> <code>sv</code>. Typical range:
<code class="reqn">0 &lt;</code> <code>sv</code> <code class="reqn">&lt; 2</code>. Default value is <code class="reqn">0</code>, which indicates
no drift in the function call. See Details for more information.</p>
</td></tr>
<tr><td><code id="dt2_dfddm_+3A_sigma">sigma</code></td>
<td>
<p>Diffusion coefficient of the underlying Wiener process. Allowed
range: <code class="reqn">0 &lt;</code> <code>sigma</code>. Default value is <code class="reqn">1</code>. This parameter
simply scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code> as follows.
See Details for more information. </p>
 <ul>
<li> <p><code>a</code>
&#8594; <code>a</code> <code class="reqn">/</code> <code>sigma</code>
</p>
</li>
<li> <p><code>v</code> &#8594; <code>v</code> <code class="reqn">/</code>
<code>sigma</code> </p>
</li>
<li> <p><code>sv</code> &#8594;
<code>sv</code> <code class="reqn">/</code> <code>sigma</code> </p>
</li></ul>
<p>.</p>
</td></tr>
<tr><td><code id="dt2_dfddm_+3A_sl_thresh">sl_thresh</code></td>
<td>
<p>Threshold for deciding when to use the &quot;small-time&quot; variant
or the &quot;large-time&quot; variant. If the &quot;effective response time&quot; is greater
than <code>sl_thresh</code> (i.e., <code class="reqn">\frac{rt}{a^2} &gt;</code> <code>sl_thresh</code>),
then the &quot;large-time&quot; variant is used; otherwise, the &quot;small-time&quot; variant
is used. Allowed values are any real number; however any non-positive
number means that the &quot;large-time&quot; variant will always be used. Similarly,
any very large positive number (e.g., +Inf) means that the &quot;small-time&quot;
variant will always be used. Default value is <code class="reqn">0.5</code>.</p>
</td></tr>
<tr><td><code id="dt2_dfddm_+3A_err_tol">err_tol</code></td>
<td>
<p>Allowed error tolerance of the overall calculation. Since the
partial derivative of the density function contains the sum of two
infinite sums, each approximation of these two infinite sums will have an
individual error tolerance of <code>err_tol</code> / 2; thus the total overall
error of the calculation will be at most <code>err_tol</code>. If the provided
error tolerance is less than <code class="reqn">1e-300</code>, it is set to <code class="reqn">1e-300</code>.
Default is <code class="reqn">1e-6</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All of the model inputs and parameters (<code>rt</code>, <code>response</code>,
<code>v</code>, <code>a</code>, <code>t0</code>, <code>w</code>, <code>sv</code>, <code>sigma</code>) can be
input as a single value or as a vector of values. If input as a vector of
values, then the standard <code>R</code> input wrapping will occur.
</p>
<p><code>sv</code> - Both the &quot;small-time&quot; and &quot;large-time&quot; variants of the density
function have two further variants: one with a constant drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">= 0</code>), and one with a variable drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">&gt; 0</code>). The details of the differences between these
two density functions can be found in our associated paper. To use the
density function with a constant drift rate, leave the parameter <code>sv</code>
to its default value of <code>sv = 0</code>, as this will indicate no drift to the
function. To use the density function with a variable drift rate, set the
parameter <code>sv</code> to some non-negative value, i.e., <code>sv</code> <code class="reqn">&gt; 0</code>.
</p>
<p><code>sigma</code> - The default value of this parameter is <code>1</code> because it
only scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code>, as shown
above. However, other formulations of the DDM may set <code>sigma = 0.1</code>
(see Ratcliff (1978), the fourth reference), so care must be taken when
comparing the results of different formulations.
</p>


<h3>Value</h3>

<p>A vector containing the second-order partial derivatives of the
DDM PDF with precision <code>err_tol</code> whose length matches that of the
longest input parameter (usually <code>rt</code>).
</p>


<h3>References</h3>

<p>Navarro, D. J., &amp; Fuss, I. G. (2009). Fast and accurate
calculations for first-passage times in Wiener diffusion models. Journal
of Mathematical Psychology, 53(4), 222-230.
</p>
<p>Gondan, M., Blurton, S. P., &amp; Kesselmeier, M. (2014). Even faster and even
more accurate first-passage time densities and distributions for the
Wiener diffusion model. Journal of Mathematical Psychology, 60, 20-22.
</p>
<p>Blurton, S. P., Kesselmeier, M., &amp; Gondan, M. (2017). The first-passage
time distribution for the diffusion model with variable drift. Journal of
Mathematical Psychology, 76, 7-12.
</p>
<p>Hartmann, R., Klauer, K. C. (2021). Partial derivatives for the
first-passage time distribution in Wiener diffusion models. Journal of
Mathematical Psychology, 103, 102550.
</p>
<p>Ratcliff, R. (1978). A theory of memory retrieval. Psychological review,
85(2), 59.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># derivative with respect to rt (response time)
dt_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to t0 (non-decision time)
dt0_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

# derivative with respect to a (threshold separation)
da_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to v (drift rate)
dv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to w (relative starting point)
dw_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to sv (inter-trial variability in the drift rate)
dsv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

#-------- Log Versions --------#

# # derivative with respect to rt (response time)
# dt_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to t0 (non-decision time)
# dt0_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)

# # derivative with respect to a (threshold separation)
# da_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to v (drift rate)
# dv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to w (relative starting point)
# dw_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to sv (inter-trial variability in the drift rate)
# dsv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)
</code></pre>

<hr>
<h2 id='dv_dfddm'>Partial Derivative of 5-parameter DDM PDF with respect to v (drift rate)</h2><span id='topic+dv_dfddm'></span>

<h3>Description</h3>

<p>Partial Derivative of the density function for the 5-parameter variant of
the Ratcliff diffusion decision model (DDM) with respect to v, the drift
rate. This variant contains the following parameters:
<code>v</code> (drift rate), <code>a</code> (threshold separation),
<code>t0</code> (non-decision time/response time constant), <code>w</code>
(relative starting point), <code>sv</code> (inter-trial variability of drift),
and <code>sigma</code> (diffusion coefficient of underlying Wiener process).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dv_dfddm(
  rt,
  response,
  v,
  a,
  t0,
  w = 0.5,
  sv = 0,
  sigma = 1,
  sl_thresh = 0.355,
  err_tol = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dv_dfddm_+3A_rt">rt</code></td>
<td>
<p>A vector of response times (in seconds). If a response time is
non-positve, then its density will evaluate to <code class="reqn">0</code> if log = FALSE and
-&#8734; if log = TRUE.</p>
</td></tr>
<tr><td><code id="dv_dfddm_+3A_response">response</code></td>
<td>
<p>Binary response(s) that correspond(s) to either the &quot;lower&quot;
or &quot;upper&quot; threshold. This model parameter can either be a singular value
or a vector. The value(s) in 'response' can be of the following data
types:
</p>

<ul>
<li><p> integers or doubles (<code class="reqn">1</code>
&#8594; &quot;lower&quot;, <code class="reqn">2</code>
&#8594; &quot;upper&quot;);
</p>
</li>
<li><p> factors (the first level gets mapped to &quot;lower&quot;, and the second
level gets mapped to &quot;upper&quot;; any additional levels are ignored).
</p>
</li>
<li><p> strings (only the first character is checked, &quot;L&quot;
&#8594; &quot;lower&quot; or &quot;U&quot;
&#8594; &quot;upper&quot;, case insensitive);
</p>
</li>
<li><p> logicals (FALSE &#8594; &quot;lower&quot;,
TRUE &#8594; &quot;upper&quot;);
</p>
</li></ul>
</td></tr>
<tr><td><code id="dv_dfddm_+3A_v">v</code></td>
<td>
<p>Drift rate. Average slope of the information accumulation process.
The drift gives information about the speed and direction of the
accumulation of information. Large (absolute) values of drift indicate a
good performance. If received information supports the response linked to
the upper threshold, then the sign will be positive; similarly a negative
value indicates that the received information supports the response linked
to the lower threshold. Allowed range: <code>v</code> is a real number. Typical
range: <code class="reqn">-5 &lt;</code> <code>v</code> <code class="reqn">&lt; 5</code>.</p>
</td></tr>
<tr><td><code id="dv_dfddm_+3A_a">a</code></td>
<td>
<p>Threshold separation. Amount of information that is considered for
a decision. Large values indicate a conservative decisional style. Allowed
range: <code class="reqn">0 &lt;</code> <code>a</code>. Typical range: <code class="reqn">0.5 &lt;</code> <code>a</code> <code class="reqn">&lt; 2</code>.</p>
</td></tr>
<tr><td><code id="dv_dfddm_+3A_t0">t0</code></td>
<td>
<p>Non-decision time or response time constant (in seconds). Lower
bound for the duration of all non-decisional processes (encoding and
response execution). If this value is greater than <code>rt</code>, then the
resulting density is returned as if <code>rt</code> <code class="reqn"> \le 0</code>. Allowed range:
<code class="reqn">0 \le</code> <code>t0</code>. Typical range: <code class="reqn">0.1 &lt;</code> <code>t0</code> <code class="reqn">&lt; 0.5</code>.</p>
</td></tr>
<tr><td><code id="dv_dfddm_+3A_w">w</code></td>
<td>
<p>Relative starting point. Indicator of an a priori bias in decision
making. When the relative starting point <code>w</code> deviates from <code class="reqn">0.5</code>,
the amount of information necessary for a decision differs between
response alternatives. Allowed range: <code class="reqn">0 &lt;</code> <code>w</code> <code class="reqn">&lt; 1</code>.
Default value is <code class="reqn">0.5</code> (i.e., no bias).</p>
</td></tr>
<tr><td><code id="dv_dfddm_+3A_sv">sv</code></td>
<td>
<p>Inter-trial-variability of drift rate. Standard deviation of a
normal distribution with mean <code>v</code> describing the distribution of
actual drift rates from specific trials. Values different from <code class="reqn">0</code> can
predict slow errors. Allowed range: <code class="reqn">0 \le</code> <code>sv</code>. Typical range:
<code class="reqn">0 &lt;</code> <code>sv</code> <code class="reqn">&lt; 2</code>. Default value is <code class="reqn">0</code>, which indicates
no drift in the function call. See Details for more information.</p>
</td></tr>
<tr><td><code id="dv_dfddm_+3A_sigma">sigma</code></td>
<td>
<p>Diffusion coefficient of the underlying Wiener process. Allowed
range: <code class="reqn">0 &lt;</code> <code>sigma</code>. Default value is <code class="reqn">1</code>. This parameter
simply scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code> as follows.
See Details for more information. </p>
 <ul>
<li> <p><code>a</code>
&#8594; <code>a</code> <code class="reqn">/</code> <code>sigma</code>
</p>
</li>
<li> <p><code>v</code> &#8594; <code>v</code> <code class="reqn">/</code>
<code>sigma</code> </p>
</li>
<li> <p><code>sv</code> &#8594;
<code>sv</code> <code class="reqn">/</code> <code>sigma</code> </p>
</li></ul>
<p>.</p>
</td></tr>
<tr><td><code id="dv_dfddm_+3A_sl_thresh">sl_thresh</code></td>
<td>
<p>Threshold for deciding when to use the &quot;small-time&quot; variant
or the &quot;large-time&quot; variant. If the &quot;effective response time&quot; is greater
than <code>sl_thresh</code> (i.e., <code class="reqn">\frac{rt}{a^2} &gt;</code> <code>sl_thresh</code>),
then the &quot;large-time&quot; variant is used; otherwise, the &quot;small-time&quot; variant
is used. Allowed values are any real number; however any non-positive
number means that the &quot;large-time&quot; variant will always be used. Similarly,
any very large positive number (e.g., +Inf) means that the &quot;small-time&quot;
variant will always be used. Default value is <code class="reqn">0.355</code>.</p>
</td></tr>
<tr><td><code id="dv_dfddm_+3A_err_tol">err_tol</code></td>
<td>
<p>Allowed error tolerance of the overall calculation. Since the
partial derivative of the density function contains one infinite sum, this
parameter defines the precision of the approximation to that infinite sum.
If the provided error tolerance is less than <code class="reqn">1e-300</code>, it is set to
<code class="reqn">1e-300</code>. Default is <code class="reqn">1e-6</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All of the model inputs and parameters (<code>rt</code>, <code>response</code>,
<code>v</code>, <code>a</code>, <code>t0</code>, <code>w</code>, <code>sv</code>, <code>sigma</code>) can be
input as a single value or as a vector of values. If input as a vector of
values, then the standard <code>R</code> input wrapping will occur.
</p>
<p><code>sv</code> - Both the &quot;small-time&quot; and &quot;large-time&quot; variants of the density
function have two further variants: one with a constant drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">= 0</code>), and one with a variable drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">&gt; 0</code>). The details of the differences between these
two density functions can be found in our associated paper. To use the
density function with a constant drift rate, leave the parameter <code>sv</code>
to its default value of <code>sv = 0</code>, as this will indicate no drift to the
function. To use the density function with a variable drift rate, set the
parameter <code>sv</code> to some non-negative value, i.e., <code>sv</code> <code class="reqn">&gt; 0</code>.
</p>
<p><code>sigma</code> - The default value of this parameter is <code>1</code> because it
only scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code>, as shown
above. However, other formulations of the DDM may set <code>sigma = 0.1</code>
(see Ratcliff (1978), the fourth reference), so care must be taken when
comparing the results of different formulations.
</p>


<h3>Value</h3>

<p>A vector containing the partial derivatives of the DDM PDF with
precision <code>err_tol</code> whose length matches that of the longest input
parameter (usually <code>rt</code>).
</p>


<h3>References</h3>

<p>Navarro, D. J., &amp; Fuss, I. G. (2009). Fast and accurate
calculations for first-passage times in Wiener diffusion models. Journal
of Mathematical Psychology, 53(4), 222-230.
</p>
<p>Gondan, M., Blurton, S. P., &amp; Kesselmeier, M. (2014). Even faster and even
more accurate first-passage time densities and distributions for the
Wiener diffusion model. Journal of Mathematical Psychology, 60, 20-22.
</p>
<p>Blurton, S. P., Kesselmeier, M., &amp; Gondan, M. (2017). The first-passage
time distribution for the diffusion model with variable drift. Journal of
Mathematical Psychology, 76, 7-12.
</p>
<p>Hartmann, R., Klauer, K. C. (2021). Partial derivatives for the
first-passage time distribution in Wiener diffusion models. Journal of
Mathematical Psychology, 103, 102550.
</p>
<p>Ratcliff, R. (1978). A theory of memory retrieval. Psychological review,
85(2), 59.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># derivative with respect to rt (response time)
dt_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to t0 (non-decision time)
dt0_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

# derivative with respect to a (threshold separation)
da_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to v (drift rate)
dv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to w (relative starting point)
dw_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to sv (inter-trial variability in the drift rate)
dsv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

#-------- Log Versions --------#

# # derivative with respect to rt (response time)
# dt_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to t0 (non-decision time)
# dt0_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)

# # derivative with respect to a (threshold separation)
# da_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to v (drift rate)
# dv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to w (relative starting point)
# dw_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to sv (inter-trial variability in the drift rate)
# dsv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)
</code></pre>

<hr>
<h2 id='dv2_dfddm'>Second-Order Partial Derivative of 5-parameter DDM PDF with respect to v
(drift rate)</h2><span id='topic+dv2_dfddm'></span>

<h3>Description</h3>

<p>Second-Order Partial Derivative of the density function for the 5-parameter
variant of the Ratcliff diffusion decision model (DDM) with respect to v,
the drift rate. This variant contains the following parameters:
<code>v</code> (drift rate), <code>a</code> (threshold separation),
<code>t0</code> (non-decision time/response time constant), <code>w</code>
(relative starting point), <code>sv</code> (inter-trial variability of drift),
and <code>sigma</code> (diffusion coefficient of underlying Wiener process).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dv2_dfddm(
  rt,
  response,
  v,
  a,
  t0,
  w = 0.5,
  sv = 0,
  sigma = 1,
  sl_thresh = 0.355,
  err_tol = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dv2_dfddm_+3A_rt">rt</code></td>
<td>
<p>A vector of response times (in seconds). If a response time is
non-positve, then its density will evaluate to <code class="reqn">0</code> if log = FALSE and
-&#8734; if log = TRUE.</p>
</td></tr>
<tr><td><code id="dv2_dfddm_+3A_response">response</code></td>
<td>
<p>Binary response(s) that correspond(s) to either the &quot;lower&quot;
or &quot;upper&quot; threshold. This model parameter can either be a singular value
or a vector. The value(s) in 'response' can be of the following data
types:
</p>

<ul>
<li><p> integers or doubles (<code class="reqn">1</code>
&#8594; &quot;lower&quot;, <code class="reqn">2</code>
&#8594; &quot;upper&quot;);
</p>
</li>
<li><p> factors (the first level gets mapped to &quot;lower&quot;, and the second
level gets mapped to &quot;upper&quot;; any additional levels are ignored).
</p>
</li>
<li><p> strings (only the first character is checked, &quot;L&quot;
&#8594; &quot;lower&quot; or &quot;U&quot;
&#8594; &quot;upper&quot;, case insensitive);
</p>
</li>
<li><p> logicals (FALSE &#8594; &quot;lower&quot;,
TRUE &#8594; &quot;upper&quot;);
</p>
</li></ul>
</td></tr>
<tr><td><code id="dv2_dfddm_+3A_v">v</code></td>
<td>
<p>Drift rate. Average slope of the information accumulation process.
The drift gives information about the speed and direction of the
accumulation of information. Large (absolute) values of drift indicate a
good performance. If received information supports the response linked to
the upper threshold, then the sign will be positive; similarly a negative
value indicates that the received information supports the response linked
to the lower threshold. Allowed range: <code>v</code> is a real number. Typical
range: <code class="reqn">-5 &lt;</code> <code>v</code> <code class="reqn">&lt; 5</code>.</p>
</td></tr>
<tr><td><code id="dv2_dfddm_+3A_a">a</code></td>
<td>
<p>Threshold separation. Amount of information that is considered for
a decision. Large values indicate a conservative decisional style. Allowed
range: <code class="reqn">0 &lt;</code> <code>a</code>. Typical range: <code class="reqn">0.5 &lt;</code> <code>a</code> <code class="reqn">&lt; 2</code>.</p>
</td></tr>
<tr><td><code id="dv2_dfddm_+3A_t0">t0</code></td>
<td>
<p>Non-decision time or response time constant (in seconds). Lower
bound for the duration of all non-decisional processes (encoding and
response execution). If this value is greater than <code>rt</code>, then the
resulting density is returned as if <code>rt</code> <code class="reqn"> \le 0</code>. Allowed range:
<code class="reqn">0 \le</code> <code>t0</code>. Typical range: <code class="reqn">0.1 &lt;</code> <code>t0</code> <code class="reqn">&lt; 0.5</code>.</p>
</td></tr>
<tr><td><code id="dv2_dfddm_+3A_w">w</code></td>
<td>
<p>Relative starting point. Indicator of an a priori bias in decision
making. When the relative starting point <code>w</code> deviates from <code class="reqn">0.5</code>,
the amount of information necessary for a decision differs between
response alternatives. Allowed range: <code class="reqn">0 &lt;</code> <code>w</code> <code class="reqn">&lt; 1</code>.
Default value is <code class="reqn">0.5</code> (i.e., no bias).</p>
</td></tr>
<tr><td><code id="dv2_dfddm_+3A_sv">sv</code></td>
<td>
<p>Inter-trial-variability of drift rate. Standard deviation of a
normal distribution with mean <code>v</code> describing the distribution of
actual drift rates from specific trials. Values different from <code class="reqn">0</code> can
predict slow errors. Allowed range: <code class="reqn">0 \le</code> <code>sv</code>. Typical range:
<code class="reqn">0 &lt;</code> <code>sv</code> <code class="reqn">&lt; 2</code>. Default value is <code class="reqn">0</code>, which indicates
no drift in the function call. See Details for more information.</p>
</td></tr>
<tr><td><code id="dv2_dfddm_+3A_sigma">sigma</code></td>
<td>
<p>Diffusion coefficient of the underlying Wiener process. Allowed
range: <code class="reqn">0 &lt;</code> <code>sigma</code>. Default value is <code class="reqn">1</code>. This parameter
simply scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code> as follows.
See Details for more information. </p>
 <ul>
<li> <p><code>a</code>
&#8594; <code>a</code> <code class="reqn">/</code> <code>sigma</code>
</p>
</li>
<li> <p><code>v</code> &#8594; <code>v</code> <code class="reqn">/</code>
<code>sigma</code> </p>
</li>
<li> <p><code>sv</code> &#8594;
<code>sv</code> <code class="reqn">/</code> <code>sigma</code> </p>
</li></ul>
<p>.</p>
</td></tr>
<tr><td><code id="dv2_dfddm_+3A_sl_thresh">sl_thresh</code></td>
<td>
<p>Threshold for deciding when to use the &quot;small-time&quot; variant
or the &quot;large-time&quot; variant. If the &quot;effective response time&quot; is greater
than <code>sl_thresh</code> (i.e., <code class="reqn">\frac{rt}{a^2} &gt;</code> <code>sl_thresh</code>),
then the &quot;large-time&quot; variant is used; otherwise, the &quot;small-time&quot; variant
is used. Allowed values are any real number; however any non-positive
number means that the &quot;large-time&quot; variant will always be used. Similarly,
any very large positive number (e.g., +Inf) means that the &quot;small-time&quot;
variant will always be used. Default value is <code class="reqn">0.355</code>.</p>
</td></tr>
<tr><td><code id="dv2_dfddm_+3A_err_tol">err_tol</code></td>
<td>
<p>Allowed error tolerance of the overall calculation. Since the
partial derivative of the density function contains one infinite sum, this
parameter defines the precision of the approximation to that infinite sum.
If the provided error tolerance is less than <code class="reqn">1e-300</code>, it is set to
<code class="reqn">1e-300</code>. Default is <code class="reqn">1e-6</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All of the model inputs and parameters (<code>rt</code>, <code>response</code>,
<code>v</code>, <code>a</code>, <code>t0</code>, <code>w</code>, <code>sv</code>, <code>sigma</code>) can be
input as a single value or as a vector of values. If input as a vector of
values, then the standard <code>R</code> input wrapping will occur.
</p>
<p><code>sv</code> - Both the &quot;small-time&quot; and &quot;large-time&quot; variants of the density
function have two further variants: one with a constant drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">= 0</code>), and one with a variable drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">&gt; 0</code>). The details of the differences between these
two density functions can be found in our associated paper. To use the
density function with a constant drift rate, leave the parameter <code>sv</code>
to its default value of <code>sv = 0</code>, as this will indicate no drift to the
function. To use the density function with a variable drift rate, set the
parameter <code>sv</code> to some non-negative value, i.e., <code>sv</code> <code class="reqn">&gt; 0</code>.
</p>
<p><code>sigma</code> - The default value of this parameter is <code>1</code> because it
only scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code>, as shown
above. However, other formulations of the DDM may set <code>sigma = 0.1</code>
(see Ratcliff (1978), the fourth reference), so care must be taken when
comparing the results of different formulations.
</p>


<h3>Value</h3>

<p>A vector containing the second-order partial derivatives of the
DDM PDF with precision <code>err_tol</code> whose length matches that of the
longest input parameter (usually <code>rt</code>).
</p>


<h3>References</h3>

<p>Navarro, D. J., &amp; Fuss, I. G. (2009). Fast and accurate
calculations for first-passage times in Wiener diffusion models. Journal
of Mathematical Psychology, 53(4), 222-230.
</p>
<p>Gondan, M., Blurton, S. P., &amp; Kesselmeier, M. (2014). Even faster and even
more accurate first-passage time densities and distributions for the
Wiener diffusion model. Journal of Mathematical Psychology, 60, 20-22.
</p>
<p>Blurton, S. P., Kesselmeier, M., &amp; Gondan, M. (2017). The first-passage
time distribution for the diffusion model with variable drift. Journal of
Mathematical Psychology, 76, 7-12.
</p>
<p>Hartmann, R., Klauer, K. C. (2021). Partial derivatives for the
first-passage time distribution in Wiener diffusion models. Journal of
Mathematical Psychology, 103, 102550.
</p>
<p>Ratcliff, R. (1978). A theory of memory retrieval. Psychological review,
85(2), 59.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># derivative with respect to rt (response time)
dt_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to t0 (non-decision time)
dt0_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

# derivative with respect to a (threshold separation)
da_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to v (drift rate)
dv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to w (relative starting point)
dw_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to sv (inter-trial variability in the drift rate)
dsv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

#-------- Log Versions --------#

# # derivative with respect to rt (response time)
# dt_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to t0 (non-decision time)
# dt0_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)

# # derivative with respect to a (threshold separation)
# da_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to v (drift rate)
# dv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to w (relative starting point)
# dw_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to sv (inter-trial variability in the drift rate)
# dsv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)
</code></pre>

<hr>
<h2 id='dw_dfddm'>Partial Derivative of 5-parameter DDM PDF with respect to w (initial bias)</h2><span id='topic+dw_dfddm'></span>

<h3>Description</h3>

<p>Partial Derivative of the density function for the 5-parameter variant of
the Ratcliff diffusion decision model (DDM) with respect to w, the initial
bias. This variant contains the following parameters:
<code>v</code> (drift rate), <code>a</code> (threshold separation),
<code>t0</code> (non-decision time/response time constant), <code>w</code>
(relative starting point), <code>sv</code> (inter-trial variability of drift),
and <code>sigma</code> (diffusion coefficient of underlying Wiener process).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dw_dfddm(
  rt,
  response,
  v,
  a,
  t0,
  w = 0.5,
  sv = 0,
  sigma = 1,
  sl_thresh = 1,
  err_tol = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dw_dfddm_+3A_rt">rt</code></td>
<td>
<p>A vector of response times (in seconds). If a response time is
non-positve, then its density will evaluate to <code class="reqn">0</code> if log = FALSE and
-&#8734; if log = TRUE.</p>
</td></tr>
<tr><td><code id="dw_dfddm_+3A_response">response</code></td>
<td>
<p>Binary response(s) that correspond(s) to either the &quot;lower&quot;
or &quot;upper&quot; threshold. This model parameter can either be a singular value
or a vector. The value(s) in 'response' can be of the following data
types:
</p>

<ul>
<li><p> integers or doubles (<code class="reqn">1</code>
&#8594; &quot;lower&quot;, <code class="reqn">2</code>
&#8594; &quot;upper&quot;);
</p>
</li>
<li><p> factors (the first level gets mapped to &quot;lower&quot;, and the second
level gets mapped to &quot;upper&quot;; any additional levels are ignored).
</p>
</li>
<li><p> strings (only the first character is checked, &quot;L&quot;
&#8594; &quot;lower&quot; or &quot;U&quot;
&#8594; &quot;upper&quot;, case insensitive);
</p>
</li>
<li><p> logicals (FALSE &#8594; &quot;lower&quot;,
TRUE &#8594; &quot;upper&quot;);
</p>
</li></ul>
</td></tr>
<tr><td><code id="dw_dfddm_+3A_v">v</code></td>
<td>
<p>Drift rate. Average slope of the information accumulation process.
The drift gives information about the speed and direction of the
accumulation of information. Large (absolute) values of drift indicate a
good performance. If received information supports the response linked to
the upper threshold, then the sign will be positive; similarly a negative
value indicates that the received information supports the response linked
to the lower threshold. Allowed range: <code>v</code> is a real number. Typical
range: <code class="reqn">-5 &lt;</code> <code>v</code> <code class="reqn">&lt; 5</code>.</p>
</td></tr>
<tr><td><code id="dw_dfddm_+3A_a">a</code></td>
<td>
<p>Threshold separation. Amount of information that is considered for
a decision. Large values indicate a conservative decisional style. Allowed
range: <code class="reqn">0 &lt;</code> <code>a</code>. Typical range: <code class="reqn">0.5 &lt;</code> <code>a</code> <code class="reqn">&lt; 2</code>.</p>
</td></tr>
<tr><td><code id="dw_dfddm_+3A_t0">t0</code></td>
<td>
<p>Non-decision time or response time constant (in seconds). Lower
bound for the duration of all non-decisional processes (encoding and
response execution). If this value is greater than <code>rt</code>, then the
resulting density is returned as if <code>rt</code> <code class="reqn"> \le 0</code>. Allowed range:
<code class="reqn">0 \le</code> <code>t0</code>. Typical range: <code class="reqn">0.1 &lt;</code> <code>t0</code> <code class="reqn">&lt; 0.5</code>.</p>
</td></tr>
<tr><td><code id="dw_dfddm_+3A_w">w</code></td>
<td>
<p>Relative starting point. Indicator of an a priori bias in decision
making. When the relative starting point <code>w</code> deviates from <code class="reqn">0.5</code>,
the amount of information necessary for a decision differs between
response alternatives. Allowed range: <code class="reqn">0 &lt;</code> <code>w</code> <code class="reqn">&lt; 1</code>.
Default value is <code class="reqn">0.5</code> (i.e., no bias).</p>
</td></tr>
<tr><td><code id="dw_dfddm_+3A_sv">sv</code></td>
<td>
<p>Inter-trial-variability of drift rate. Standard deviation of a
normal distribution with mean <code>v</code> describing the distribution of
actual drift rates from specific trials. Values different from <code class="reqn">0</code> can
predict slow errors. Allowed range: <code class="reqn">0 \le</code> <code>sv</code>. Typical range:
<code class="reqn">0 &lt;</code> <code>sv</code> <code class="reqn">&lt; 2</code>. Default value is <code class="reqn">0</code>, which indicates
no drift in the function call. See Details for more information.</p>
</td></tr>
<tr><td><code id="dw_dfddm_+3A_sigma">sigma</code></td>
<td>
<p>Diffusion coefficient of the underlying Wiener process. Allowed
range: <code class="reqn">0 &lt;</code> <code>sigma</code>. Default value is <code class="reqn">1</code>. This parameter
simply scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code> as follows.
See Details for more information. </p>
 <ul>
<li> <p><code>a</code>
&#8594; <code>a</code> <code class="reqn">/</code> <code>sigma</code>
</p>
</li>
<li> <p><code>v</code> &#8594; <code>v</code> <code class="reqn">/</code>
<code>sigma</code> </p>
</li>
<li> <p><code>sv</code> &#8594;
<code>sv</code> <code class="reqn">/</code> <code>sigma</code> </p>
</li></ul>
<p>.</p>
</td></tr>
<tr><td><code id="dw_dfddm_+3A_sl_thresh">sl_thresh</code></td>
<td>
<p>Threshold for deciding when to use the &quot;small-time&quot; variant
or the &quot;large-time&quot; variant in one half of the calculation of the partial
derivative of the density function. This acts in exactly the same way as
the parameter <code>max_terms_large</code> in the <code>dfddm()</code> function: it is
the maximum number of terms to use for the &quot;large-time&quot; variant before
switching to using the &quot;small-time&quot; variant. The other half of the
calculation leverages a different type of comparison between the
&quot;large-time&quot; and &quot;small-time&quot; variants that requires no input from the
user. Allowed values are any real number; however any non-positive number
means that the &quot;small-time&quot; variant will always be used. Similarly, any
very large positive number (e.g., +Inf) means that the &quot;large-time&quot;
variant will always be used. Default value is <code class="reqn">1</code>.</p>
</td></tr>
<tr><td><code id="dw_dfddm_+3A_err_tol">err_tol</code></td>
<td>
<p>Allowed error tolerance of the overall calculation. Since the
partial derivative of the density function contains the sum of two
infinite sums, each approximation of these two infinite sums will have an
individual error tolerance of <code>err_tol</code> / 2; thus the total overall
error of the calculation will be at most <code>err_tol</code>. If the provided
error tolerance is less than <code class="reqn">1e-300</code>, it is set to <code class="reqn">1e-300</code>.
Default is <code class="reqn">1e-6</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All of the model inputs and parameters (<code>rt</code>, <code>response</code>,
<code>v</code>, <code>a</code>, <code>t0</code>, <code>w</code>, <code>sv</code>, <code>sigma</code>) can be
input as a single value or as a vector of values. If input as a vector of
values, then the standard <code>R</code> input wrapping will occur.
</p>
<p><code>sv</code> - Both the &quot;small-time&quot; and &quot;large-time&quot; variants of the density
function have two further variants: one with a constant drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">= 0</code>), and one with a variable drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">&gt; 0</code>). The details of the differences between these
two density functions can be found in our associated paper. To use the
density function with a constant drift rate, leave the parameter <code>sv</code>
to its default value of <code>sv = 0</code>, as this will indicate no drift to the
function. To use the density function with a variable drift rate, set the
parameter <code>sv</code> to some non-negative value, i.e., <code>sv</code> <code class="reqn">&gt; 0</code>.
</p>
<p><code>sigma</code> - The default value of this parameter is <code>1</code> because it
only scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code>, as shown
above. However, other formulations of the DDM may set <code>sigma = 0.1</code>
(see Ratcliff (1978), the fourth reference), so care must be taken when
comparing the results of different formulations.
</p>


<h3>Value</h3>

<p>A vector containing the partial derivatives of the DDM PDF with
precision <code>err_tol</code> whose length matches that of the longest input
parameter (usually <code>rt</code>).
</p>


<h3>References</h3>

<p>Navarro, D. J., &amp; Fuss, I. G. (2009). Fast and accurate
calculations for first-passage times in Wiener diffusion models. Journal
of Mathematical Psychology, 53(4), 222-230.
</p>
<p>Gondan, M., Blurton, S. P., &amp; Kesselmeier, M. (2014). Even faster and even
more accurate first-passage time densities and distributions for the
Wiener diffusion model. Journal of Mathematical Psychology, 60, 20-22.
</p>
<p>Blurton, S. P., Kesselmeier, M., &amp; Gondan, M. (2017). The first-passage
time distribution for the diffusion model with variable drift. Journal of
Mathematical Psychology, 76, 7-12.
</p>
<p>Hartmann, R., Klauer, K. C. (2021). Partial derivatives for the
first-passage time distribution in Wiener diffusion models. Journal of
Mathematical Psychology, 103, 102550.
</p>
<p>Ratcliff, R. (1978). A theory of memory retrieval. Psychological review,
85(2), 59.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># derivative with respect to rt (response time)
dt_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to t0 (non-decision time)
dt0_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

# derivative with respect to a (threshold separation)
da_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to v (drift rate)
dv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to w (relative starting point)
dw_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to sv (inter-trial variability in the drift rate)
dsv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

#-------- Log Versions --------#

# # derivative with respect to rt (response time)
# dt_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to t0 (non-decision time)
# dt0_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)

# # derivative with respect to a (threshold separation)
# da_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to v (drift rate)
# dv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to w (relative starting point)
# dw_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to sv (inter-trial variability in the drift rate)
# dsv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)
</code></pre>

<hr>
<h2 id='dw2_dfddm'>Second-Order Partial Derivative of 5-parameter DDM PDF with respect to w
(initial bias)</h2><span id='topic+dw2_dfddm'></span>

<h3>Description</h3>

<p>Second-Order Partial Derivative of the density function for the 5-parameter
variant of the Ratcliff diffusion decision model (DDM) with respect to w,
the initial bias. This variant contains the following parameters:
<code>v</code> (drift rate), <code>a</code> (threshold separation),
<code>t0</code> (non-decision time/response time constant), <code>w</code>
(relative starting point), <code>sv</code> (inter-trial variability of drift),
and <code>sigma</code> (diffusion coefficient of underlying Wiener process).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dw2_dfddm(
  rt,
  response,
  v,
  a,
  t0,
  w = 0.5,
  sv = 0,
  sigma = 1,
  sl_thresh = 0.5,
  err_tol = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dw2_dfddm_+3A_rt">rt</code></td>
<td>
<p>A vector of response times (in seconds). If a response time is
non-positve, then its density will evaluate to <code class="reqn">0</code> if log = FALSE and
-&#8734; if log = TRUE.</p>
</td></tr>
<tr><td><code id="dw2_dfddm_+3A_response">response</code></td>
<td>
<p>Binary response(s) that correspond(s) to either the &quot;lower&quot;
or &quot;upper&quot; threshold. This model parameter can either be a singular value
or a vector. The value(s) in 'response' can be of the following data
types:
</p>

<ul>
<li><p> integers or doubles (<code class="reqn">1</code>
&#8594; &quot;lower&quot;, <code class="reqn">2</code>
&#8594; &quot;upper&quot;);
</p>
</li>
<li><p> factors (the first level gets mapped to &quot;lower&quot;, and the second
level gets mapped to &quot;upper&quot;; any additional levels are ignored).
</p>
</li>
<li><p> strings (only the first character is checked, &quot;L&quot;
&#8594; &quot;lower&quot; or &quot;U&quot;
&#8594; &quot;upper&quot;, case insensitive);
</p>
</li>
<li><p> logicals (FALSE &#8594; &quot;lower&quot;,
TRUE &#8594; &quot;upper&quot;);
</p>
</li></ul>
</td></tr>
<tr><td><code id="dw2_dfddm_+3A_v">v</code></td>
<td>
<p>Drift rate. Average slope of the information accumulation process.
The drift gives information about the speed and direction of the
accumulation of information. Large (absolute) values of drift indicate a
good performance. If received information supports the response linked to
the upper threshold, then the sign will be positive; similarly a negative
value indicates that the received information supports the response linked
to the lower threshold. Allowed range: <code>v</code> is a real number. Typical
range: <code class="reqn">-5 &lt;</code> <code>v</code> <code class="reqn">&lt; 5</code>.</p>
</td></tr>
<tr><td><code id="dw2_dfddm_+3A_a">a</code></td>
<td>
<p>Threshold separation. Amount of information that is considered for
a decision. Large values indicate a conservative decisional style. Allowed
range: <code class="reqn">0 &lt;</code> <code>a</code>. Typical range: <code class="reqn">0.5 &lt;</code> <code>a</code> <code class="reqn">&lt; 2</code>.</p>
</td></tr>
<tr><td><code id="dw2_dfddm_+3A_t0">t0</code></td>
<td>
<p>Non-decision time or response time constant (in seconds). Lower
bound for the duration of all non-decisional processes (encoding and
response execution). If this value is greater than <code>rt</code>, then the
resulting density is returned as if <code>rt</code> <code class="reqn"> \le 0</code>. Allowed range:
<code class="reqn">0 \le</code> <code>t0</code>. Typical range: <code class="reqn">0.1 &lt;</code> <code>t0</code> <code class="reqn">&lt; 0.5</code>.</p>
</td></tr>
<tr><td><code id="dw2_dfddm_+3A_w">w</code></td>
<td>
<p>Relative starting point. Indicator of an a priori bias in decision
making. When the relative starting point <code>w</code> deviates from <code class="reqn">0.5</code>,
the amount of information necessary for a decision differs between
response alternatives. Allowed range: <code class="reqn">0 &lt;</code> <code>w</code> <code class="reqn">&lt; 1</code>.
Default value is <code class="reqn">0.5</code> (i.e., no bias).</p>
</td></tr>
<tr><td><code id="dw2_dfddm_+3A_sv">sv</code></td>
<td>
<p>Inter-trial-variability of drift rate. Standard deviation of a
normal distribution with mean <code>v</code> describing the distribution of
actual drift rates from specific trials. Values different from <code class="reqn">0</code> can
predict slow errors. Allowed range: <code class="reqn">0 \le</code> <code>sv</code>. Typical range:
<code class="reqn">0 &lt;</code> <code>sv</code> <code class="reqn">&lt; 2</code>. Default value is <code class="reqn">0</code>, which indicates
no drift in the function call. See Details for more information.</p>
</td></tr>
<tr><td><code id="dw2_dfddm_+3A_sigma">sigma</code></td>
<td>
<p>Diffusion coefficient of the underlying Wiener process. Allowed
range: <code class="reqn">0 &lt;</code> <code>sigma</code>. Default value is <code class="reqn">1</code>. This parameter
simply scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code> as follows.
See Details for more information. </p>
 <ul>
<li> <p><code>a</code>
&#8594; <code>a</code> <code class="reqn">/</code> <code>sigma</code>
</p>
</li>
<li> <p><code>v</code> &#8594; <code>v</code> <code class="reqn">/</code>
<code>sigma</code> </p>
</li>
<li> <p><code>sv</code> &#8594;
<code>sv</code> <code class="reqn">/</code> <code>sigma</code> </p>
</li></ul>
<p>.</p>
</td></tr>
<tr><td><code id="dw2_dfddm_+3A_sl_thresh">sl_thresh</code></td>
<td>
<p>Threshold for deciding when to use the &quot;small-time&quot; variant
or the &quot;large-time&quot; variant in one half of the calculation of the partial
derivative of the density function. This acts in exactly the same way as
the parameter <code>max_terms_large</code> in the <code>dfddm()</code> function: it is
the maximum number of terms to use for the &quot;large-time&quot; variant before
switching to using the &quot;small-time&quot; variant. The other half of the
calculation leverages a different type of comparison between the
&quot;large-time&quot; and &quot;small-time&quot; variants that requires no input from the
user. Allowed values are any real number; however any non-positive number
means that the &quot;small-time&quot; variant will always be used. Similarly, any
very large positive number (e.g., +Inf) means that the &quot;large-time&quot;
variant will always be used. Default value is <code class="reqn">1</code>.</p>
</td></tr>
<tr><td><code id="dw2_dfddm_+3A_err_tol">err_tol</code></td>
<td>
<p>Allowed error tolerance of the overall calculation. Since the
partial derivative of the density function contains the sum of two
infinite sums, each approximation of these two infinite sums will have an
individual error tolerance of <code>err_tol</code> / 2; thus the total overall
error of the calculation will be at most <code>err_tol</code>. If the provided
error tolerance is less than <code class="reqn">1e-300</code>, it is set to <code class="reqn">1e-300</code>.
Default is <code class="reqn">1e-6</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All of the model inputs and parameters (<code>rt</code>, <code>response</code>,
<code>v</code>, <code>a</code>, <code>t0</code>, <code>w</code>, <code>sv</code>, <code>sigma</code>) can be
input as a single value or as a vector of values. If input as a vector of
values, then the standard <code>R</code> input wrapping will occur.
</p>
<p><code>sv</code> - Both the &quot;small-time&quot; and &quot;large-time&quot; variants of the density
function have two further variants: one with a constant drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">= 0</code>), and one with a variable drift rate <code>v</code>
(i.e., <code>sv</code> <code class="reqn">&gt; 0</code>). The details of the differences between these
two density functions can be found in our associated paper. To use the
density function with a constant drift rate, leave the parameter <code>sv</code>
to its default value of <code>sv = 0</code>, as this will indicate no drift to the
function. To use the density function with a variable drift rate, set the
parameter <code>sv</code> to some non-negative value, i.e., <code>sv</code> <code class="reqn">&gt; 0</code>.
</p>
<p><code>sigma</code> - The default value of this parameter is <code>1</code> because it
only scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code>, as shown
above. However, other formulations of the DDM may set <code>sigma = 0.1</code>
(see Ratcliff (1978), the fourth reference), so care must be taken when
comparing the results of different formulations.
</p>


<h3>Value</h3>

<p>A vector containing the second-order partial derivatives of the
DDM PDF with precision <code>err_tol</code> whose length matches that of the
longest input parameter (usually <code>rt</code>).
</p>


<h3>References</h3>

<p>Navarro, D. J., &amp; Fuss, I. G. (2009). Fast and accurate
calculations for first-passage times in Wiener diffusion models. Journal
of Mathematical Psychology, 53(4), 222-230.
</p>
<p>Gondan, M., Blurton, S. P., &amp; Kesselmeier, M. (2014). Even faster and even
more accurate first-passage time densities and distributions for the
Wiener diffusion model. Journal of Mathematical Psychology, 60, 20-22.
</p>
<p>Blurton, S. P., Kesselmeier, M., &amp; Gondan, M. (2017). The first-passage
time distribution for the diffusion model with variable drift. Journal of
Mathematical Psychology, 76, 7-12.
</p>
<p>Hartmann, R., Klauer, K. C. (2021). Partial derivatives for the
first-passage time distribution in Wiener diffusion models. Journal of
Mathematical Psychology, 103, 102550.
</p>
<p>Ratcliff, R. (1978). A theory of memory retrieval. Psychological review,
85(2), 59.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># derivative with respect to rt (response time)
dt_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to t0 (non-decision time)
dt0_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

# derivative with respect to a (threshold separation)
da_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to v (drift rate)
dv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to w (relative starting point)
dw_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
         sv = 0.4, err_tol = 1e-6)

# derivative with respect to sv (inter-trial variability in the drift rate)
dsv_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
          sv = 0.4, err_tol = 1e-6)

#-------- Log Versions --------#

# # derivative with respect to rt (response time)
# dt_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to t0 (non-decision time)
# dt0_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)

# # derivative with respect to a (threshold separation)
# da_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to v (drift rate)
# dv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to w (relative starting point)
# dw_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#              sv = 0.4, err_tol = 1e-6)

# # derivative with respect to sv (inter-trial variability in the drift rate)
# dsv_log_dfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3, w = 0.5,
#               sv = 0.4, err_tol = 1e-6)
</code></pre>

<hr>
<h2 id='med_dec'>Medicial decision data</h2><span id='topic+med_dec'></span>

<h3>Description</h3>

<p>Part of the accuracy and response time data presented in Trueblood et al.
(2017) investigating medical decision making among medical professionals
(pathologists) and novices (i.e., undergraduate students). The task of
participants was to judge whether pictures of blood cells show cancerous
cells (i.e., blast cells) or non-cancerous cells (i.e., non-blast cells). The
current data set contains 200 decisions per participant (the &quot;accuracy&quot;
condition from Trueblood et al.).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(med_dec)
</code></pre>


<h3>Format</h3>

<p>A data frame with 11000 rows and 9 variables:
</p>

<dl>
<dt>id</dt><dd><p>identification number of the participant</p>
</dd>
<dt>group</dt><dd><p>expertise of participant; &quot;experienced&quot;, &quot;inexperienced&quot;, or &quot;novice&quot;. The first two levels refer to different type of medical professional (i.e., experts).</p>
</dd>
<dt>block</dt><dd><p>block number</p>
</dd>
<dt>trial</dt><dd><p>index of trial for each participant</p>
</dd>
<dt>classification</dt><dd><p>true classification of the pictured cell; i.e. the correct response</p>
</dd>
<dt>difficulty</dt><dd><p>adjudged difficulty of the task for the particular image</p>
</dd>
<dt>response</dt><dd><p>response given by the participant; either &quot;blast&quot; or &quot;non-blast&quot;</p>
</dd>
<dt>rt</dt><dd><p>the response time associated with the response, in seconds</p>
</dd>
<dt>stimulus</dt><dd><p>the image file used for the specific trial</p>
</dd>
</dl>



<h3>Details</h3>

<p>At the beginning of the experiment, both novices and medical experts
completed a training to familiarize themselves with blast cells. After that,
each participant performed the main task in which they judged whether or not
presented images were blast cells or non-blast cells. Among them, some of the
cells were judged as easy and some as difficult trials by an additional group
of experts. The current data set only contains the data from the &quot;accuracy&quot;
condition (i.e., Trueblood et al. considered additional conditions that are
not part of the current data set).
</p>
<p>The relevant part of the method section for the accuracy condition from the
original paper is as follows:
</p>
<p>&quot;The main task consisted of six blocks with 100 trials in each block. The
main task was the same as the practice block, where participants were asked
to identify single images. However, participants did not receive
trial-by-trial feedback about their choices. They received feedback about
their performance at the end of each block. The 100 trials in each block were
composed of equal numbers of easy blast images, hard blast images, easy
non-blast images, and hard non-blast images, fully randomized.
</p>
<p>There were three manipulations across blocks: accuracy, speed, and bias. In
the accuracy blocks, participants were instructed to respond as accurately as
possible and were given 5 s to respond. [...] If they responded after the
deadline, they received the message &quot;Too Slow!&quot; The 5-s [...] response
windows for the accuracy [...] [condition was] based on the response time
data from the three expert raters. The 0.975 quantile of the expert raters'
response times was 4.96 s; thus, we set the accuracy response window to 5 s.
</p>
<p>The order of the first three blocks was randomized but with the constraint
that there was one block for each type of manipulation (i.e., accuracy,
speed, and bias). The order of the last three blocks was identical to the
order of the first three blocks.&quot;
</p>
<p>Note that this dataset contains some negative response times that indicate a
missing response (i.e., the response value for that trial is <code>NA</code>). Take care
in removing these values before using this dataset. See our Validity vignette
for an example of use in an optimization setting.
</p>


<h3>Source</h3>

<p>Trueblood, J.S., Holmes, W.R., Seegmiller, A.C. et al. The impact of
speed and bias on the cognitive processes of experts and novices in medical
image decision-making. Cogn. Research 3, 28 (2018).
https://doi.org/10.1186/s41235-018-0119-2
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("med_dec", package = "fddm")
str(med_dec)

## number of participants per expertise condition:
aggregate(id ~ group, med_dec, function(x) length(unique(x)))

## number of trials per participant
aggregate(rt ~ group + id, med_dec, length)
</code></pre>

<hr>
<h2 id='pfddm'>Distribution of Ratcliff Diffusion Decision Model</h2><span id='topic+pfddm'></span>

<h3>Description</h3>

<p>Density function for the Ratcliff diffusion decision model (DDM) with
following parameters: <code>v</code> (drift rate), <code>a</code> (threshold
separation), <code>t0</code> (non-decision time/response time constant), <code>w</code>
(relative starting point), <code>sv</code> (inter-trial variability of drift), and
<code>sigma</code> (diffusion coefficient of underlying Wiener process).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pfddm(
  rt,
  response,
  v,
  a,
  t0,
  w = 0.5,
  sv = 0,
  sigma = 1,
  err_tol = 1e-06,
  log = FALSE,
  method = "Mills"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pfddm_+3A_rt">rt</code></td>
<td>
<p>A vector of response times (in seconds). If a response time is
non-positve, then its density will evaluate to <code class="reqn">0</code> if log = FALSE and
-&#8734; if log = TRUE.</p>
</td></tr>
<tr><td><code id="pfddm_+3A_response">response</code></td>
<td>
<p>Binary response(s) that correspond(s) to either the &quot;lower&quot;
or &quot;upper&quot; threshold. This model parameter can either be a singular value
or a vector. The value(s) in 'response' can be of the following data
types:
</p>

<ul>
<li><p> integers or doubles (<code class="reqn">1</code>
&#8594; &quot;lower&quot;, <code class="reqn">2</code>
&#8594; &quot;upper&quot;);
</p>
</li>
<li><p> factors (the first level gets mapped to &quot;lower&quot;, and the second
level gets mapped to &quot;upper&quot;; any additional levels are ignored).
</p>
</li>
<li><p> strings (only the first character is checked, &quot;L&quot;
&#8594; &quot;lower&quot; or &quot;U&quot;
&#8594; &quot;upper&quot;, case insensitive);
</p>
</li>
<li><p> logicals (FALSE &#8594; &quot;lower&quot;,
TRUE &#8594; &quot;upper&quot;);
</p>
</li></ul>
</td></tr>
<tr><td><code id="pfddm_+3A_v">v</code></td>
<td>
<p>Drift rate. Average slope of the information accumulation process.
The drift gives information about the speed and direction of the
accumulation of information. Large (absolute) values of drift indicate a
good performance. If received information supports the response linked to
the upper threshold, then the sign will be positive; similarly a negative
value indicates that the received information supports the response linked
to the lower threshold. Allowed range: <code>v</code> is a real number. Typical
range: <code class="reqn">-5 &lt;</code> <code>v</code> <code class="reqn">&lt; 5</code>.</p>
</td></tr>
<tr><td><code id="pfddm_+3A_a">a</code></td>
<td>
<p>Threshold separation. Amount of information that is considered for
a decision. Large values indicate a conservative decisional style. Allowed
range: <code class="reqn">0 &lt;</code> <code>a</code>. Typical range: <code class="reqn">0.5 &lt;</code> <code>a</code> <code class="reqn">&lt; 2</code>.</p>
</td></tr>
<tr><td><code id="pfddm_+3A_t0">t0</code></td>
<td>
<p>Non-decision time or response time constant (in seconds). Lower
bound for the duration of all non-decisional processes (encoding and
response execution). If this value is greater than <code>rt</code>, then the
resulting density is returned as if <code>rt</code> <code class="reqn"> \le 0</code>. Allowed range:
<code class="reqn">0 \le</code> <code>t0</code>. Typical range: <code class="reqn">0.1 &lt;</code> <code>t0</code> <code class="reqn">&lt; 0.5</code>.</p>
</td></tr>
<tr><td><code id="pfddm_+3A_w">w</code></td>
<td>
<p>Relative starting point. Indicator of an a priori bias in decision
making. When the relative starting point <code>w</code> deviates from <code class="reqn">0.5</code>,
the amount of information necessary for a decision differs between
response alternatives. Allowed range: <code class="reqn">0 &lt;</code> <code>w</code> <code class="reqn">&lt; 1</code>.
Default value is <code class="reqn">0.5</code> (i.e., no bias).</p>
</td></tr>
<tr><td><code id="pfddm_+3A_sv">sv</code></td>
<td>
<p>Inter-trial-variability of drift rate. Standard deviation of a
normal distribution with mean <code>v</code> describing the distribution of
actual drift rates from specific trials. Values different from <code class="reqn">0</code> can
predict slow errors. Allowed range: <code class="reqn">0 \le</code> <code>sv</code>. Typical range:
<code class="reqn">0 &lt;</code> <code>sv</code> <code class="reqn">&lt; 2</code>. Default value is <code class="reqn">0</code>, which indicates
no drift in the function call. See Details for more information.</p>
</td></tr>
<tr><td><code id="pfddm_+3A_sigma">sigma</code></td>
<td>
<p>Diffusion coefficient of the underlying Wiener process. Allowed
range: <code class="reqn">0 &lt;</code> <code>sigma</code>. Default value is <code class="reqn">1</code>. This parameter
simply scales the parameters <code>a</code>, <code>v</code>, and <code>sv</code> as follows.
See Details for more information. </p>
 <ul>
<li> <p><code>a</code>
&#8594; <code>a</code> <code class="reqn">/</code> <code>sigma</code>
</p>
</li>
<li> <p><code>v</code> &#8594; <code>v</code> <code class="reqn">/</code>
<code>sigma</code> </p>
</li>
<li> <p><code>sv</code> &#8594;
<code>sv</code> <code class="reqn">/</code> <code>sigma</code> </p>
</li></ul>
<p>.</p>
</td></tr>
<tr><td><code id="pfddm_+3A_err_tol">err_tol</code></td>
<td>
<p>Allowed error tolerance of the density function. Since the
density function contains an infinite sum, this parameter defines the
precision of the approximation to that infinite sum. If the provided
error tolerance is less than <code class="reqn">1e-300</code>, it is set to <code class="reqn">1e-300</code>.
Default is <code class="reqn">1e-6</code>.</p>
</td></tr>
<tr><td><code id="pfddm_+3A_log">log</code></td>
<td>
<p>Logical; if <code>TRUE</code>, probabilities <code class="reqn">p</code> are given as
<code class="reqn">log(p)</code>. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="pfddm_+3A_method">method</code></td>
<td>
<p>Which method of calculating the CDF to use. Can be one of
{<code>"Mills"</code>, <code>"NCDF"</code>}, case-insensitive. Default is
<code>"Mills"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All of the model inputs and parameters (<code>rt</code>, <code>response</code>,
<code>v</code>, <code>a</code>, <code>t0</code>, <code>w</code>, <code>sv</code>, <code>sigma</code>) can be
input as a single value or as a vector of values. If input as a vector of
values, then the standard <code>R</code> input wrapping will occur.
</p>
<p><code>sigma</code> - The default value of this parameter is <code>1</code> because it
only scales the parameters <code>v</code>, <code>a</code>, and <code>sv</code>, as shown
above. However, other formulations of the DDM may set <code>sigma = 0.1</code>
(see Ratcliff (1978), the fourth reference), so care must be taken when
comparing the results of different formulations.
</p>


<h3>Value</h3>

<p>A vector containing the distribution of the DDM with precision
<code>err_tol</code> whose length matches that of the longest input parameter
(usually <code>rt</code>).
</p>


<h3>References</h3>

<p>Navarro, D. J., &amp; Fuss, I. G. (2009). Fast and accurate
calculations for first-passage times in Wiener diffusion models. Journal
of Mathematical Psychology, 53(4), 222-230.
</p>
<p>Gondan, M., Blurton, S. P., &amp; Kesselmeier, M. (2014). Even faster and even
more accurate first-passage time densities and distributions for the
Wiener diffusion model. Journal of Mathematical Psychology, 60, 20-22.
</p>
<p>Blurton, S. P., Kesselmeier, M., &amp; Gondan, M. (2017). The first-passage
time distribution for the diffusion model with variable drift. Journal of
Mathematical Psychology, 76, 7-12.
</p>
<p>Ratcliff, R. (1978). A theory of memory retrieval. Psychological review,
85(2), 59.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># minimal example
pfddm(rt = 1.2, response = "lower", a = 1, v = -1, t0 = 0.3)

# example with all function parameters set to default or a practical value
pfddm(rt = c(1.2, 0.9, 1.1, 1.4, 0.8, 1.3),
      response = c("lower", "upper", "upper", "lower", "upper", "lower"),
      a = 1, v = -1, t0 = 0.2, w = 0.5, sv = 0, sigma = 1,
      err_tol = 1e-6, log = FALSE, method = "Mills")

# example of mismatched input lengths
pfddm(rt = c(1.2, 0.9, 1.1, 1.4, 0.8, 1.3),
      response = c("lower", "upper", "upper", "lower", "upper", "lower"),
      a = c(1, 3), v = c(-2, 2, 2, -2, 2, -2),
      t0 = 0.3, w = c(0.4, 0.5, 0.6), sv = 0.9,
      err_tol = 1e-10, log = FALSE, method = "NCDF")

# example with Wiener diffusion coefficient (sigma) not equal to 1
pfddm(rt = c(1.2, 0.9, 1.1, 1.4, 0.8, 1.3),
      response = c("lower", "upper", "upper", "lower", "upper", "lower"),
      a = 1, v = -1, t0 = 0.3, w = 0.5, sv = 0, sigma = 0.1,
      err_tol = 1e-10, log = TRUE, method = "Mills")


### examples of different response inputs

# integer
resp_int &lt;- as.integer(c(1, 2, 2, 1, 2, 1))
pfddm(rt = c(1.2, 0.9, 1.1, 1.4, 0.8, 1.3), response = resp_int,
      a = 1, v = -2, t0 = 0.3, w = 0.5, sv = 0.1,
      err_tol = 1e-10, log = FALSE, method = "Mills")

# double
resp_dbl &lt;- as.double(c(1, 2, 2, 1, 2, 1))
pfddm(rt = c(1.2, 0.9, 1.1, 1.4, 0.8, 1.3), response = resp_dbl,
      a = 1, v = -2, t0 = 0.3, w = 0.5, sv = 0.1,
      err_tol = 1e-10, log = FALSE, method = "Mills")

# factor (first level is mapped to "lower")
days &lt;- c("Monday", "Friday", "Friday", "Monday", "Friday", "Monday")
resp_fac &lt;- factor(days, levels = c("Monday", "Friday"))
pfddm(rt = c(1.2, 0.9, 1.1, 1.4, 0.8, 1.3), response = resp_fac,
      a = 1, v = -2, t0 = 0.3, w = 0.5, sv = 0.1,
      err_tol = 1e-10, log = FALSE, method = "Mills")

# string
resp_str &lt;- c("lower", "upper", "upper", "lower", "upper", "lower")
pfddm(rt = c(1.2, 0.9, 1.1, 1.4, 0.8, 1.3), response = resp_str,
      a = 1, v = -2, t0 = 0.3, w = 0.5, sv = 0.1,
      err_tol = 1e-10, log = FALSE, method = "Mills")

# logical
resp_log &lt;- c(FALSE, TRUE, TRUE, FALSE, TRUE, FALSE)
pfddm(rt = c(1.2, 0.9, 1.1, 1.4, 0.8, 1.3), response = resp_log,
      a = 1, v = -2, t0 = 0.3, w = 0.5, sv = 0.1,
      err_tol = 1e-10, log = FALSE, method = "Mills")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
