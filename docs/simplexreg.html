<!DOCTYPE html><html><head><title>Help for package simplexreg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {simplexreg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#plot.simplexreg'><p>Plots for simplexreg Objects</p></a></li>
<li><a href='#predict.simplexreg'><p>Prediction Method for simplexreg Objects</p></a></li>
<li><a href='#residuals.simplexreg'><p>Extract residuals for simplexreg Objects</p></a></li>
<li><a href='#retinal'>
<p>Data on recorded decay of intraocular gas in complex retinal surgeries</p></a></li>
<li><a href='#sdac'>
<p>Data on Autologous Peripheral Blood Stem Cell Transplants in Alberta Health Service</p></a></li>
<li><a href='#simplex'><p>The Simplex Distribution Functions</p>
</a></li>
<li><a href='#simplexreg'><p>Simplex Generalized Linear Model Regression Function</p>
</a></li>
<li><a href='#simplexreg.control'><p>Control Parameters for Simplex Regression</p></a></li>
<li><a href='#summary.simplexreg'><p>Extracting Information from Objects simplexreg</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Regression Analysis of Proportional Data Using Simplex
Distribution</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-06-20</td>
</tr>
<tr>
<td>Author:</td>
<td>Peng Zhang, Zhengguo Qiu and Chengchun Shi</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Peng Zhang &lt;pengz@zju.edu.cn&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Simplex density, distribution, quantile functions as well as random variable
   	generation of the simplex distribution are given. Regression analysis of proportional data
   	using various kinds of simplex models is available. In addition, GEE method can be applied 
	to longitudinal data to model the correlation. Residual analysis is also involved. Some 
	subroutines are written in C with GNU Scientific Library (GSL) so as to facilitate the 
	computation. </td>
</tr>
<tr>
<td>Depends:</td>
<td>Formula, plotrix</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU Scientific Library version &gt;= 1.8</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-08-02 15:27:52 UTC; spring</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-08-03 10:10:03</td>
</tr>
</table>
<hr>
<h2 id='plot.simplexreg'>Plots for simplexreg Objects</h2><span id='topic+plot.simplexreg'></span>

<h3>Description</h3>

<p>Various types of plots could be produced for simplexreg Objects, including plots of correlation 
structure, plots of different types of residuals and plots of partial deviance. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simplexreg'
plot(x, type = c("residuals", "corr", "GOF"), res = "adjvar", lag = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.simplexreg_+3A_x">x</code></td>
<td>
<p>fitted model object of class &quot;simplexreg&quot;</p>
</td></tr>
<tr><td><code id="plot.simplexreg_+3A_type">type</code></td>
<td>
<p>character specifying types of plots: the correlation (<code>corr</code>),
residuals (<code>residuals</code>), partial deviances (<code>GOF</code>). See 'Details'</p>
</td></tr>
<tr><td><code id="plot.simplexreg_+3A_res">res</code></td>
<td>
<p>character specifying types of residuals:approximate Pearson residual (<code>appstdPerr</code>),
standard Pearson residual (<code>stdPerr</code>), adjusted dependent variable <code class="reqn">s_i</code> (<code>adjvar</code>).
See <code><a href="#topic+residuals.simplexreg">residuals.simplexreg</a></code></p>
</td></tr>
<tr><td><code id="plot.simplexreg_+3A_lag">lag</code></td>
<td>
<p>when <code>type = corr</code>, this function examine the autocorrelation at lag <code>lag</code></p>
</td></tr>
<tr><td><code id="plot.simplexreg_+3A_...">...</code></td>
<td>
<p>other parameters to be passed through to the plot function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provides graphical presentations for simplexreg objects. The plot of correlation aims
examine the correlation structure of the longitudinal data set. Let <code class="reqn">r_{ij}</code> be the standardised 
score residuals of the <code>i</code>th observation at time <code class="reqn">t_{ij}</code>, and <code>lag = k</code>, then <code class="reqn">r_{ij}</code> 
are plotted against <code class="reqn">r_{ik}</code> for all <code class="reqn">i</code> and <code class="reqn">j &lt; k</code>, if <code class="reqn">|t_{ij} - t_{ik}| = k</code>.
</p>
<p>Residuals can be plotted when specifying <code>type = "residuals"</code>, The upper and lower 95
(1.96) are also lined.
</p>
<p>Plots of partial deviance are for the goodness-of-fit test in the presence of within-subject dependence for 
longitudinal data. The partial deviances are defined as
</p>
<p style="text-align: center;"><code class="reqn">D_j^P=\sum_{i=1}^{m_j}d(y_{ij}-\hat{\mu}_{ij}) / \sigma_{ij}^2, j \in T</code>
</p>

<p>where T denotes a collection of all distinct times on which observation are made. Cross-sectionally, 
<code class="reqn">y_{ij}</code>'s are independent and hence <code class="reqn">D_j^P</code> follows approximately <code class="reqn">\chi^2</code>, with <code class="reqn">m_j</code> 
being the total number of <code class="reqn">y_{ij}</code>'s observed cross-sectionally at time <code class="reqn">t_j</code>. Both observed partial 
deviance <code class="reqn">D_j^P</code> statistics and the corresponding critical values are depicted and compared at each 
time point.
</p>


<h3>Author(s)</h3>

<p>Chengchun Shi
</p>


<h3>References</h3>

<p>Song, P. and Qiu, Z. and Tan, M. (2004) Modelling Heterogeneous Dispersion in 
Marginal Models for Longitudinal Proportional Data. <em> Biometrical Journal,</em> 
<b> 46:</b> 540&ndash;553
</p>
<p>Qiu Z. (2001) <em> Simplex Mixed Models for Longitudinal Proportional Data.</em> 
Ph.D. Dissertation, York University
</p>
<p>Zhang, P. and Qiu, Z. and Shi, C. (2016) simplexreg: An R Package for Regression
Analysis of Proportional Data Using the Simplex Distribution. <em> Journal of Statistical Software,</em>
<b> 71:</b> 1&ndash;21

</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.simplexreg">summary.simplexreg</a></code>, <code><a href="#topic+residuals.simplexreg">residuals.simplexreg</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## fit the model
data("sdac", package="simplexreg")
sim.glm2 &lt;- simplexreg(rcd~ageadj+chemo|age, 
  link = "logit", data = sdac)
	
data("retinal", package = "simplexreg")
sim.gee2 &lt;- simplexreg(Gas~LogT+LogT2+Level|LogT+Level|Time, 
  link = "logit", corr = "AR1", id = ID, data = retinal)  

## produce the plots
plot(sim.glm2, type = "residuals", res = "stdPerr", ylim = c(-3, 3))
plot(sim.gee2, type = "corr", xlab = "", ylab = "")
plot(sim.gee2, type = "GOF", xlab = "", ylab = "")
</code></pre>

<hr>
<h2 id='predict.simplexreg'>Prediction Method for simplexreg Objects</h2><span id='topic+predict.simplexreg'></span>

<h3>Description</h3>

<p>Predicted values based on simplex regression object</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simplexreg'
predict(object, newdata = NULL, type = c("response", "dispersion"), 
   	na.action, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.simplexreg_+3A_object">object</code></td>
<td>
<p>fitted model object of class <code>"simplexreg"</code></p>
</td></tr>
<tr><td><code id="predict.simplexreg_+3A_newdata">newdata</code></td>
<td>
<p>an optional data frame in which to look for variables with which to predict. 
If omitted, original observations are used.</p>
</td></tr>
<tr><td><code id="predict.simplexreg_+3A_type">type</code></td>
<td>
<p>character indicating type of predictions:fitted mean of response (<code>"response"</code>) or
fitted dispersion parameter(<code>"dispersion"</code>)</p>
</td></tr>
<tr><td><code id="predict.simplexreg_+3A_na.action">na.action</code></td>
<td>
<p>function determining what should be done with missing values in <code>newdata</code></p>
</td></tr>
<tr><td><code id="predict.simplexreg_+3A_...">...</code></td>
<td>
<p>currently not used</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chengchun Shi
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simplexreg">simplexreg</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## fit the model
data("sdac", package="simplexreg")
sim.glm2 &lt;- simplexreg(rcd~ageadj+chemo|age, link = "logit", 
  data = sdac)

data("retinal", package = "simplexreg")
sim.gee2 &lt;- simplexreg(Gas~LogT+LogT2+Level|LogT+Level|Time,
  link = "logit", corr = "AR1", id = ID, data = retinal)  	

## predict the mean
predict(sim.glm2, type = "response")

## predict the dispersion
predict(sim.gee2, type = "dispersion")
</code></pre>

<hr>
<h2 id='residuals.simplexreg'>Extract residuals for simplexreg Objects</h2><span id='topic+residuals.simplexreg'></span>

<h3>Description</h3>

<p>Methods for extracting various types of residuals from simplex regression, from 
approximate Pearson residuals, standard Pearson residuals and standardise score residuals to 
adjusted dependent variable suggested by McCullagh and Nelder (1989). The first three can be 
used to examine mean-variance relation while the last aims to test the link function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simplexreg'
residuals(object, type = c("appstdPerr", "stdPerr", "stdscor", "adjvar"), 
   	...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.simplexreg_+3A_object">object</code></td>
<td>
<p>fitted model object of class &quot;simplexreg&quot;</p>
</td></tr>
<tr><td><code id="residuals.simplexreg_+3A_type">type</code></td>
<td>
<p>character specifying types of residuals:approximate Pearson residual (<code>appstdPerr</code>),
standard Pearson residual (<code>stdPerr</code>), adjusted dependent variable <code class="reqn">s_i</code> (<code>adjvar</code>).
Details are given in 'Details'</p>
</td></tr>
<tr><td><code id="residuals.simplexreg_+3A_...">...</code></td>
<td>
<p>currently not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Pearson residual takes the form
</p>
<p style="text-align: center;"><code class="reqn">r_i^P=\frac{y_i-\hat{\mu}_i}{\hat{\tau}_i}</code>
</p>

<p>where <code class="reqn">\hat{\mu}_i</code> is the fitted mean parameter and details about calculation of
<code class="reqn">\tau</code> is given in Jorgensen (1997). When the dispersion parameter <code class="reqn">\sigma^2</code>
(see <code><a href="boot.html#topic+simplex">simplex</a></code>) is large the variance of response approaches to <code class="reqn">\mu(1-\mu)</code>
and this leads to the approximate Pearson residual
</p>
<p style="text-align: center;"><code class="reqn">r_i^a=\frac{y_i-\hat{\mu}_i}{\sqrt{\hat{\mu}_i(1-\hat{\mu}_i)}}</code>
</p>

<p>Plot of the standardised score residuals,
</p>
<p style="text-align: center;"><code class="reqn">r_i^S=\frac{u_i}{\sqrt{var(u_i)}}</code>
</p>

<p>where <code class="reqn">u_i</code> is the score function, can also detect model assumption violation. 
Details can be found in Song <em>et al.</em> (2004). 	
The adjusted dependent variable suggested by McCullagh and Nelder (1989) could be employed
as an informal check for the link function,
</p>
<p style="text-align: center;"><code class="reqn">s_i = g(\mu_i) + (\frac{3\sigma^4}{\mu_i(1-\mu_i)}+\frac{\sigma^2}{V(\mu_i)})^{-1/2} u(y_i;\mu_i)</code>
</p>

<p>where <code class="reqn">u(y_i;\mu_i)</code> and <code class="reqn">V(\mu_i)</code> are the score function and variance function. 
</p>


<h3>Author(s)</h3>

<p>Chengchun Shi
</p>


<h3>References</h3>

<p>Barndorff-Nielsen,  O.E. and  Jorgensen, B. (1991)
Some parametric models on the simplex.
<em> Journal of  Multivariate Analysis,</em> <b> 39:</b> 106&ndash;116
</p>
<p>Jorgensen, B. (1997)
<em> The Theory of Dispersion Models</em>. London: Chapman and Hall
</p>
<p>McCullagh, P and Nelder J. (1989)
<em> Generalized Linear Models</em>. London: Chapman and Hall
</p>
<p>Song, P. and Qiu, Z. and Tan, M. (2004) Modelling Heterogeneous Dispersion in 
Marginal Models for Longitudinal Proportional Data. <em> Biometrical Journal,</em> 
<b> 46:</b> 540&ndash;553
</p>
<p>Zhang, P. and Qiu, Z. and Shi, C. (2016) simplexreg: An R Package for Regression
Analysis of Proportional Data Using the Simplex Distribution. <em> Journal of Statistical Software,</em>
<b> 71:</b> 1&ndash;21

</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.simplexreg">summary.simplexreg</a></code>, <code><a href="boot.html#topic+simplex">simplex</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## fit the model
data("sdac", package="simplexreg")
sim.glm2 &lt;- simplexreg(rcd~ageadj+chemo|age,
  link = "logit", data = sdac)
	
data("retinal", package = "simplexreg")
sim.gee2 &lt;- simplexreg(Gas~LogT+LogT2+Level|LogT+Level|Time,
  link = "logit", corr = "AR1", id = ID, data = retinal)  

## extract the residuals
res &lt;- residuals(sim.glm2, type = "stdPerr")
res &lt;- residuals(sim.gee2, type = "adjvar")
</code></pre>

<hr>
<h2 id='retinal'>
Data on recorded decay of intraocular gas in complex retinal surgeries
</h2><span id='topic+retinal'></span>

<h3>Description</h3>

<p>The study recorded the decay of intraocular gas <code class="reqn">C_3F_8</code> in complex retinal surgeries 
following initial injection in an ophthalmology study, reported in Meyers <em>et al.</em> (1992). The outcome
variable was the percent of gas left in the eye. The gas, with three different concentration levels, 15%, 
20% and 25% was injected into the eye before surgery for 31 patients. They were then followed three to eight
(average of five) times over a three-month period, and the volume of gas in the eye at the follow-up times
were recorded as a percentage of the initial gas volume. The primary interest was to investigate whether 
concentration levels of the gas injected in patients' eyes affect the decay rate of the gas. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("retinal")</code></pre>


<h3>Format</h3>

<p>A data frame with 181 observations on the following 6 variables. 
</p>

<dl>
<dt><code>Gas</code></dt><dd><p>Percentage of the initial gas volume left</p>
</dd>
<dt><code>Time</code></dt><dd><p>Time covariate of days after the gas injection</p>
</dd>
<dt><code>LogT</code></dt><dd><p>Logarithm of <code>Time</code></p>
</dd>
<dt><code>LogT2</code></dt><dd><p>Square of <code>LogT</code></p>
</dd>
<dt><code>Level</code></dt><dd><p>Concentration levels of the initial intraocular gas. For each patient, 
<code>Level = -1</code> if the gas concentration level is 15%, <code>Level = 0</code> if 20%, or 
<code>1</code> if 25%. 
</p>
</dd>
<dt><code>ID</code></dt><dd><p>A factor indicating patients.</p>
</dd>
</dl>



<h3>References</h3>

<p>Meyers, S. M. and Ambler, J. S. and Tan, M. (1992) Variation of Perfluorpropane 
Disappearance after Vitrectomy. <em> Retinal,</em> <b> 12:</b> 359&ndash;363
</p>
<p>Zhang, P. and Qiu, Z. and Shi, C. (2016) simplexreg: An R Package for Regression
Analysis of Proportional Data Using the Simplex Distribution. <em> Journal of Statistical Software,</em>
<b> 71:</b> 1&ndash;21   
</p>

<hr>
<h2 id='sdac'>
Data on Autologous Peripheral Blood Stem Cell Transplants in Alberta Health Service
</h2><span id='topic+sdac'></span>

<h3>Description</h3>

<p>Autologous peripheral blood stem cell (PBSC) transplants have been widely used for rapid
hematologic recovery following myeloablative therapy for various malignant hematological disorders. A 
study enrolled 242 patients who consented to autologous PBSC transplant after myeloablative doses of 
chemotherapy between year 2003 and 2008 at the Edmonton Hematopoietic Stem Cell Lab in Cross Cancer 
Institute - Alberta Health Services. The Data is a data frame containing information about the patients'
age, gender, as well as their clinical characteristics. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("sdac")</code></pre>


<h3>Format</h3>

<p>A data frame with 239 observations on the following 5 variables. 
</p>

<dl>
<dt><code>age</code></dt><dd><p>patients' ages</p>
</dd>
<dt><code>gender</code></dt><dd><p>patients' genders</p>
</dd>
<dt><code>rcd</code></dt><dd><p>recovery rates for viable CD34+ cells</p>
</dd>
<dt><code>chemo</code></dt><dd><p>dummy variable indicating if a patient receives a chemotherapy on a one-day 
protocol(0) or on a 3-day protocol(1)</p>
</dd>
<dt><code>ageadj</code></dt><dd><p>adjusted age variable. <code>age</code> &lt; 40 is set as the baseline age and other ages
are adjusted by subtracting by 40</p>
</dd>
</dl>



<h3>References</h3>

<p>Allan, D. and Keeney, M. and Howson-Jan, K. and Popma, J. and Weir, K. and Bhatia, M. and Sutherland, D. and 
Chin_yee, I. (2002) Number of Viable CD34+ Cells Reinfused Predicts Engraftment in Autologous Hematopoietic 
Stem Cell Transplantation. <em>BONE MARROW TRANSPL,</em> <b> 20:</b> 967-72
</p>
<p>Yang, H. and Acker, J. and Cabuhat, M. and Letcher, B. and Larratt, L. and McGann, L. (2005) Association of 
Post_Thaw viable CD34+ Cells and CFU-GM with Time to Hematopoietic Engraftment. <em>BONE MARROW TRANSPL,</em> 
<b> 35:</b> 881-887
</p>
<p>Zhang, P. and Qiu, Z. and Shi, C. (2016) simplexreg: An R Package for Regression
Analysis of Proportional Data Using the Simplex Distribution. <em> Journal of Statistical Software,</em>
<b> 71:</b> 1&ndash;21
</p>

<hr>
<h2 id='simplex'>The Simplex Distribution Functions

</h2><span id='topic+dsimplex'></span><span id='topic+psimplex'></span><span id='topic+qsimplex'></span><span id='topic+rsimplex'></span><span id='topic+psimplex.norm'></span><span id='topic+qsimplex.norm'></span>

<h3>Description</h3>

<p>Density, cumulative distribution function, quantile function and random variable generation 
for the simplex distribution with mean equal to <code>mu</code> and dispersion equal to <code>sig</code>

</p>


<h3>Usage</h3>

<pre><code class='language-R'>dsimplex(x, mu, sig)
psimplex(q, mu, sig)
qsimplex(p, mu, sig)
rsimplex(n, mu, sig)
psimplex.norm(q, mu, sig)
qsimplex.norm(p, mu, sig)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simplex_+3A_x">x</code>, <code id="simplex_+3A_q">q</code></td>
<td>
<p>vector of quantiles

</p>
</td></tr>
<tr><td><code id="simplex_+3A_p">p</code></td>
<td>
<p>vector of probabilities</p>
</td></tr>
<tr><td><code id="simplex_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>   
<tr><td><code id="simplex_+3A_mu">mu</code></td>
<td>
<p>vector of means

</p>
</td></tr>
<tr><td><code id="simplex_+3A_sig">sig</code></td>
<td>
<p>vector of square root of dispersion parameter of simplex distribution

</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The simplex distribution has density
</p>
<p style="text-align: center;"><code class="reqn">p(y) = (2\pi \sigma^2)^{-\frac{1}{2}} (y(1-y))^{-\frac{3}{2}} \exp(-\frac{1}{2\sigma^2} d(y;\mu)), y \in (0, 1)</code>
</p>

<p>where <code class="reqn">d(y;\mu)</code> is a unit deviance function
</p>
<p style="text-align: center;"><code class="reqn">d(y;\mu) = \frac{(y-\mu)^2}{y(1-y) \mu^2 (1-\mu)^2}</code>
</p>
 
<p><code class="reqn">\mu</code> is the mean of simplex distribution and <code class="reqn">\sigma^2</code> the dispersion parameter. 
<code>qnorm</code> provides results up to about 6 digits.	  

</p>


<h3>Value</h3>

<p><code>dsimplex</code> gives density function, <code>psimplex</code> gives the distribution function, <code>qsimplex</code> gives quantile function and 
<code>rsimplex</code> gives random number generated from the simplex distribution. <code>psim.norm</code> and <code>qsimplex.norm</code> gives the 
renormalized distribution and quantile function.  





</p>


<h3>Author(s)</h3>

<p>Peng Zhang and Zhenguo Qiu

</p>


<h3>References</h3>

<p>Barndorff-Nielsen,  O.E. and  Jorgensen, B. (1991)
Some parametric models on the simplex.
<em> Journal of  Multivariate Analysis,</em> <b> 39:</b> 106&ndash;116
</p>
<p>Jorgensen, B. (1997)
<em> The Theory of Dispersion Models</em>. London: Chapman and Hall
</p>
<p>Song, P. and Qiu, Z. and Tan, M. (2004) Modelling Heterogeneous Dispersion in 
Marginal Models for Longitudinal Proportional Data. <em> Biometrical Journal,</em> 
<b> 46:</b> 540&ndash;553

</p>


<h3>Examples</h3>

<pre><code class='language-R'># simplex distribution function
dsimplex(seq(0.01,0.99,0.01), 0.5, 1)
psimplex(seq(0.01,0.99,0.01), 0.5, 1)
qsimplex(seq(0.01,0.99,0.01), 0.5, 1)

# random variable generation
n &lt;- 200
ga0 &lt;- 1.5
ga1 &lt;- 0.5
ga2 &lt;- -0.5
sigma &lt;- 4
T &lt;- c(rep(0, n/2), rep(1, n/2))
S &lt;- runif(n, 0, 5)
eta &lt;- ga0 + ga1 * T + ga2 * S
mu &lt;- exp(eta)/(1+exp(eta))
Y &lt;- rep(0, n)
for (i in 1:n){ 
  Y[i] &lt;- rsimplex(1, mu[i], sigma)
}
</code></pre>

<hr>
<h2 id='simplexreg'>Simplex Generalized Linear Model Regression Function

</h2><span id='topic+simplexreg'></span><span id='topic+print.simplexreg'></span><span id='topic+simplexreg.fit'></span>

<h3>Description</h3>

<p>Regression Analysis of Proportional Data Using Various Types of 
Simplex Models  

</p>


<h3>Usage</h3>

<pre><code class='language-R'>simplexreg(formula, data, subset, na.action, 
   	link = c("logit", "probit", "cloglog", "neglog"), corr = "Ind", id = NULL, 
   	control = simplexreg.control(...), model = TRUE, y = TRUE, x = TRUE, ...)
	
simplexreg.fit(y, x, z = NULL, t = NULL, link = "logit", corr = "Ind",
   	id = NULL, control = simplexreg.control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simplexreg_+3A_formula">formula</code></td>
<td>
<p>a symbolic description of the model to be fitted(of type y ~ x or y ~ x | z | t. 
The Details are given under 'Details'). 

</p>
</td></tr>
<tr><td><code id="simplexreg_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment containing variables in <code>formula</code> 
and <code>id</code>.

</p>
</td></tr>
<tr><td><code id="simplexreg_+3A_subset">subset</code>, <code id="simplexreg_+3A_na.action">na.action</code></td>
<td>
<p>arguments controlling formula processing via <code><a href="stats.html#topic+model.frame">model.frame</a></code></p>
</td></tr>



<tr><td><code id="simplexreg_+3A_link">link</code></td>
<td>
<p>type of link function to the mean. Currently, <code>"logit"</code>(logit function), 
<code>"probit"</code>(probit function), <code>"cloglog"</code>(complementary log-log function), 
<code>"neglog"</code>(negative log function) are supported. 

</p>
</td></tr>
<tr><td><code id="simplexreg_+3A_corr">corr</code></td>
<td>
<p>the covariance structure, chosen from <code>"Ind"</code>(independent structure), 
<code>"Exc"</code>(exchangeability) and <code>"AR1"</code>(AR(1)), see Details</p>
</td></tr>
<tr><td><code id="simplexreg_+3A_id">id</code></td>
<td>
<p>a factor identifies the clusters when <code>gee = TRUE</code>. The length of <code>id</code>
should be the same as the number of observations. <code>y</code>, <code>x</code>, <code>z</code>, <code>t</code> are 
assumed to be sorted in accordance with clusters specified by <code>id</code></p>
</td></tr>
<tr><td><code id="simplexreg_+3A_control">control</code></td>
<td>
<p>a list of control argument via <code><a href="#topic+simplexreg.control">simplexreg.control</a></code></p>
</td></tr>
<tr><td><code id="simplexreg_+3A_model">model</code></td>
<td>
<p>a logical value indicating whether <em>model frame</em> should be included
as a component of the return value</p>
</td></tr>
<tr><td><code id="simplexreg_+3A_y">y</code>, <code id="simplexreg_+3A_x">x</code></td>
<td>
<p>For <code>simplexreg</code>:logical values indicating whether response vector 
and covariates modelling the mean parameter should be returned as components of the 
returned value
For <code>simplexreg.fit</code>:<code>x</code> is the design matrix and <code>y</code> is the response vector</p>
</td></tr>
<tr><td><code id="simplexreg_+3A_z">z</code></td>
<td>
<p>regressor matrix modelling the dispersion parameter</p>
</td></tr>
<tr><td><code id="simplexreg_+3A_t">t</code></td>
<td>
<p>time covariate in the correlation structure, see Details</p>
</td></tr>
<tr><td><code id="simplexreg_+3A_...">...</code></td>
<td>
<p>argument passed to <code><a href="#topic+simplexreg.control">simplexreg.control</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Outcomes of continuous proportions arise in many applied areas. Such data could 
be properly modelled using simplex regression. See also <code><a href="boot.html#topic+simplex">simplex</a></code>. The mean and 
dispersion parameters are linked to set of regressors. Regression analysis of the simplex model 
is implemented in <code>simplexreg</code>. If <code>corr = "Ind"</code>, simplex generalized regression model
is employed. Estimations is performed by maximum likelihood via Fisher scoring technique. 
</p>
<p>Apart from including generalized simplex regression models, this function also provides users with 
generalized estimating equations (GEE) techniques to model longitudinal proportional response. 
Exchangeability and AR(1) structures are available. Parameter estimation and residual analysis 
are involved. 
</p>
<p>We employ the specification approach designed in the fitting model function <code>betareg</code> of
beta regression in the package <span class="pkg">betareg</span>. As for simplex regression models, assuming the dispersion
is homogeneous, the response is linked to a linear predictor described by <code>y ~ x1 + x2</code> using a <code>link</code> 
function. Four types of function are available linking the regressors to the mean. However, for dispersion, 
the <code>link</code> function is restricted to logarithm function. When modeling dispersion, the regressor 
modelling the dispersion parameter should be specified in a formula form of type <code>y ~ x1 + x2 | z1 + z2</code> 
where <code>z1</code> and <code>z2</code> are linked to the dispersion parameter <code class="reqn">\sigma^2</code>.
</p>
<p>Model specification is a bit complicated when it comes to modelling longitudinal proportional response. 
Song <em>et. al</em> (2004) proposed a marginal simplex model consists of three components, the 
population-average effects, the pattern of dispersion and the correlation structure. Let the percentage 
responses for the <code class="reqn">i</code>th subject be <code class="reqn">y_{ij}</code>, observed at time <code class="reqn">t_{ij}</code>. If <code>corr = "AR1"</code>, 
the working covariance matrix of <code class="reqn">y_{ij}</code>, 
<code class="reqn">j = 1, 2, ..., n_i</code>, is 
</p>
<p style="text-align: center;"><code class="reqn">{\exp(\alpha * |t_{ik} - t_{ij}|)}_{kj}</code>
</p>

<p>where <code class="reqn">\alpha &lt; 0</code> and <code class="reqn">\exp(\alpha)</code> is the lag-1 autocorrelation. If 
<code>corr = "Exc"</code>, the covariance matrix will be <code class="reqn">(1 - exp(\alpha)) I + exp(\alpha) 1</code>
where I is the identity matrix while 1 the matrix with all elements being equal to one.  
</p>
<p>For homogeneous dispersion, the formula is supposed to be of the form <code>y ~ x1 + x2 | 1 | t</code> where <code class="reqn">t</code> is the
time covariate. Otherwise, the formula will be of the form <code>y ~ x1 + x2 | z1 + z2 | t</code>.
</p>



<h3>Value</h3>



<table>
<tr><td><code>fixef</code></td>
<td>
<p>estimates of coefficients modelling the mean as well 
as the standard deviation</p>
</td></tr>
<tr><td><code>dispar</code></td>
<td>
<p>estimates of coefficients modelling dispersion as 
well as the standard deviation</p>
</td></tr>
<tr><td><code>Dispersion</code></td>
<td>
<p>estimate of the dispersion parameter</p>
</td></tr>
<tr><td><code>appstdPerr</code></td>
<td>
<p>approximated standard deviations of the regression coefficients</p>
</td></tr>
<tr><td><code>stdPerr</code></td>
<td>
<p>exact standard deviations of the regression coefficients</p>
</td></tr>
<tr><td><code>meanmu</code></td>
<td>
<p>estimate of mean parameter</p>
</td></tr>
<tr><td><code>adjvar</code></td>
<td>
<p>adjusted dependent variable <code class="reqn">s_i</code>. Details could be found in 
McCullagh and Nelder (1989)</p>
</td></tr> 
<tr><td><code>stdscor</code></td>
<td>
<p>standardised score residuals. Details can be found in Song <em>et al.</em> (2004)</p>
</td></tr>
<tr><td><code>predict</code></td>
<td>
<p>predicted values of <code class="reqn">g(\mu_i)</code> where g is the link function and 
<code class="reqn">\mu_i</code> the mean parameter</p>
</td></tr>
<tr><td><code>loglike</code></td>
<td>
<p>value of maximum log-likelihood function</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p>value of deviance</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the original function call</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>the original formula</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>a list with elements <code>"mean"</code> and <code>"dispersion"</code> containing term object for the model</p>
</td></tr>
<tr><td><code>levels</code></td>
<td>
<p>a list with elements <code>"mean"</code> and <code>"dispersion"</code> containing levels of categorical regressors</p>
</td></tr>
<tr><td><code>link</code></td>
<td>
<p>type of function linking to the mean</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>type = <code>"homo"</code> for homogeneous dispersion while type = <code>"hetero"</code> for 
heterogeneous dispersion</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the full model frame (if <code>model = TRUE</code>)</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>response vector (if <code>y = TRUE</code>)</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>a list with elements <code>mean</code>, <code>dispersion</code>, <code>time</code> and <code>id</code> containing 
corresponding variables</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of proportional observations</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>number of Fisher iterations</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>argument passed to <code><a href="#topic+simplexreg.control">simplexreg.control</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zhenguo Qiu, Peng Zhang and Chengchun Shi

</p>


<h3>References</h3>

<p>Barndorff-Nielsen,  O.E. and  Jorgensen, B. (1991)
Some parametric models on the simplex.
<em> Journal of  Multivariate Analysis,</em> <b> 39:</b> 106&ndash;116
</p>
<p>Jorgensen, B. (1997)
<em> The Theory of Dispersion Models</em>.  London: Chapman and Hall
</p>
<p>McCullagh, P and Nelder J. (1989)
<em> Generalized Linear Models</em>. London: Chapman and Hall
</p>
<p>Song, P. and Qiu, Z. and Tan, M. (2004) Modelling Heterogeneous Dispersion in 
Marginal Models for Longitudinal Proportional Data. <em> Biometrical Journal,</em> 
<b> 46:</b> 540&ndash;553
</p>
<p>Zhang, P. and Qiu, Z. and Shi, C. (2016) simplexreg: An R Package for Regression
Analysis of Proportional Data Using the Simplex Distribution. <em> Journal of Statistical Software,</em>
<b> 71:</b> 1&ndash;21

</p>


<h3>See Also</h3>

<p><code><a href="boot.html#topic+simplex">simplex</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'># GLM models
data("sdac", package = "simplexreg")
sim.glm1 &lt;- simplexreg(rcd~ageadj+chemo, link = "logit", 
  data = sdac)
sim.glm2 &lt;- simplexreg(rcd~ageadj+chemo|age, link = "logit", 
  data = sdac)

# GEE models
data("retinal", package = "simplexreg")
sim.gee1 &lt;- simplexreg(Gas~LogT+LogT2+Level|1|Time, link = "logit", 
  corr = "Exc", id = ID, data = retinal)
sim.gee2 &lt;- simplexreg(Gas~LogT+LogT2+Level|LogT+Level|Time, 
  link = "logit", corr = "AR1", id = ID, data = retinal)	
</code></pre>

<hr>
<h2 id='simplexreg.control'>Control Parameters for Simplex Regression</h2><span id='topic+simplexreg.control'></span>

<h3>Description</h3>

<p>Various parameters that control fitting of simplex regression models
using <code><a href="#topic+simplexreg">simplexreg</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simplexreg.control(maxit = 200, beta = NULL, gamma = NULL, alpha = NULL, 
   	tol = 1e-6, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simplexreg.control_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations</p>
</td></tr>
<tr><td><code id="simplexreg.control_+3A_beta">beta</code></td>
<td>
<p>start value for beta modelling the mean parameter</p>
</td></tr>
<tr><td><code id="simplexreg.control_+3A_gamma">gamma</code></td>
<td>
<p>start value for gamma modelling the dispersion</p>
</td></tr>
<tr><td><code id="simplexreg.control_+3A_alpha">alpha</code></td>
<td>
<p>start value for alpha modelling correlation structure using GEEs, see Song 
<em>et.al</em> (2004)</p>
</td></tr>
<tr><td><code id="simplexreg.control_+3A_tol">tol</code></td>
<td>
<p>numeric tolerance for convergence in Fisher scoring</p>
</td></tr>
<tr><td><code id="simplexreg.control_+3A_...">...</code></td>
<td>
<p>currently not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the arguments specified.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simplexreg">simplexreg</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># GLM models
data("sdac", package = "simplexreg")
sim.glm1 &lt;- simplexreg(rcd~ageadj+chemo, link = "logit", 
  data = sdac, beta = c(1.115, 0.013, 0.252))
sim.glm2 &lt;- simplexreg(rcd~ageadj+chemo|age, link = "logit", 
  data = sdac, beta = c(1.115, 0.013, 0.252), gamma = c(2.61, -0.015))

# GEE models
data("retinal", package = "simplexreg")
sim.gee1 &lt;- simplexreg(Gas~LogT+LogT2+Level|1|Time, link = "logit", 
  corr = "Exc", id = ID, data = retinal, beta = c(2.72, 0.034, -0.329, 0.409), 
  alpha = -0.3)
sim.gee2 &lt;- simplexreg(Gas~LogT+LogT2+Level|LogT+Level|Time, 
  link = "logit", corr = "AR1", id = ID, data = retinal, alpha = -0.3,
  beta = c(2.72, 0.034, -0.329, 0.409))
</code></pre>

<hr>
<h2 id='summary.simplexreg'>Extracting Information from Objects simplexreg</h2><span id='topic+summary.simplexreg'></span><span id='topic+print.summary.simplexreg'></span><span id='topic+coef.simplexreg'></span><span id='topic+vcov.simplexreg'></span><span id='topic+logLik.simplexreg'></span><span id='topic+nobs.simplexreg'></span><span id='topic+AIC.simplexreg'></span><span id='topic+BIC.simplexreg'></span>

<h3>Description</h3>

<p>Methods for extracting information from fitted simplex regression model
objects of class <code>"simplexreg"</code></p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simplexreg'
## S3 method for class 'simplexreg'
summary(object, type = "stdPerr", ...)

## S3 method for class 'simplexreg'
## S3 method for class 'simplexreg'
coef(object, ...)

## S3 method for class 'simplexreg'
## S3 method for class 'simplexreg'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.simplexreg_+3A_object">object</code></td>
<td>
<p>fitted model object of class &quot;simplexreg&quot;</p>
</td></tr>
<tr><td><code id="summary.simplexreg_+3A_type">type</code></td>
<td>
<p>character specifying type of residuals to be included, see 
<code><a href="#topic+residuals.simplexreg">residuals.simplexreg</a></code></p>
</td></tr>
<tr><td><code id="summary.simplexreg_+3A_...">...</code></td>
<td>
<p>currently not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions make it possible to extract information from objects of class
<code>"simplexreg"</code>. Wald statistics as well as the p-values of regression coefficients 
are given in the <code>summary</code> output. If <code>GEE = FALSE</code>, based on the fitted 
coefficients, a <code class="reqn">\chi^2</code> test is performed and the p-value is reported in the output. 
Otherwise, coefficients of the autocorrelation <code class="reqn">\alpha</code>, <code class="reqn">\rho</code>, (see Song 
<em>et. al</em> (2004)), are also involved. 
</p>
<p>Model coefficients and their covariance matrix could be extracted by the <code><a href="stats.html#topic+coef">coef</a></code>,
and <code><a href="stats.html#topic+vcov">vcov</a></code>, respectively. For simplex GLM models (<code>GEE = FALSE</code>), Akaike Information 
Criterion and Bayesian Information Criterion could be calculated using generic functions <code><a href="stats.html#topic+AIC">AIC</a></code>
and <code><a href="stats.html#topic+BIC">BIC</a></code>, respectively. 
</p>


<h3>Author(s)</h3>

<p>Chengchun Shi
</p>


<h3>References</h3>

<p>Barndorff-Nielsen,  O.E. and  Jorgensen, B. (1991)
Some parametric models on the simplex.
<em> Journal of  Multivariate Analysis,</em> <b> 39:</b> 106&ndash;116
</p>
<p>Jorgensen, B. (1997)
<em> The Theory of Dispersion Models</em>. London: Chapman and Hall
</p>
<p>Song, P. and Qiu, Z. and Tan, M. (2004) Modelling Heterogeneous Dispersion in 
Marginal Models for Longitudinal Proportional Data. <em> Biometrical Journal,</em> 
<b> 46:</b> 540&ndash;553
</p>
<p>Zhang, P. and Qiu, Z. and Shi, C. (2016) simplexreg: An R Package for Regression
Analysis of Proportional Data Using the Simplex Distribution. <em> Journal of Statistical Software,</em>
<b> 71:</b> 1&ndash;21

</p>


<h3>See Also</h3>

<p><code><a href="#topic+simplexreg">simplexreg</a></code>, <code><a href="#topic+residuals.simplexreg">residuals.simplexreg</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## fit the model
data("sdac", package = "simplexreg")
sim.glm2 &lt;- simplexreg(rcd~ageadj+chemo|age, link = "logit", 
  data = sdac)

data("retinal", package = "simplexreg")
sim.gee2 &lt;- simplexreg(Gas~LogT+LogT2+Level|LogT+Level|Time,
  link = "logit", corr = "AR1", id = ID, data = retinal)  
  
## extract information
summary(sim.glm2, type = "appstdPerr")
coef(sim.glm2)
vcov(sim.glm2)
AIC(sim.glm2)
BIC(sim.glm2)

summary(sim.gee2, type = "stdscor")
coef(sim.gee2)
vcov(sim.glm2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
