<!DOCTYPE html><html><head><title>Help for package panelSUR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {panelSUR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#obtainSigmas'><p>Compute errors' variance-covariance matrices</p></a></li>
<li><a href='#panelSUR'><p>panelSUR package: EC SUR system models estimation on (unbalanced) panel data</p></a></li>
<li><a href='#postEstimation'><p>Compute post-estimation indicators</p></a></li>
<li><a href='#preliminaryEstimate'><p>Obtain preliminary system equation estimates</p></a></li>
<li><a href='#prepareData'><p>Prepare data for use</p></a></li>
<li><a href='#printSUR'><p>Print summary of estimated equation system</p></a></li>
<li><a href='#SURdata'><p>Simulated data for a simultaneous equation system</p></a></li>
<li><a href='#SURest'><p>EC SUR System Models Estimation on (Unbalanced) Panel Data</p></a></li>
<li><a href='#system'><p>Build and solve system for beta coefficient estimates</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Two-Way Error Component SUR Systems Estimation on Unbalanced
Panel Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Generalized Least Squares (GLS) estimation of Seemingly Unrelated Regression
             (SUR) systems on unbalanced panel in the one/two-way cases also taking into 
             account the possibility of cross equation restrictions.  Methodological details
             can be found in Biørn (2004) &lt;<a href="https://doi.org/10.1016%2Fj.jeconom.2003.10.023">doi:10.1016/j.jeconom.2003.10.023</a>&gt; and Platoni,
             Sckokai, Moro (2012) &lt;<a href="https://doi.org/10.1080%2F07474938.2011.607098">doi:10.1080/07474938.2011.607098</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, formula.tools, plm, matlib, fastmatrix</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-06 16:51:05 UTC; laura.barbieri</td>
</tr>
<tr>
<td>Author:</td>
<td>Laura Barbieri [aut, cre],
  Silvia Platoni [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Laura Barbieri &lt;laura.barbieri@unicatt.it&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-08 09:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='obtainSigmas'>Compute errors' variance-covariance matrices</h2><span id='topic+obtainSigmas'></span>

<h3>Description</h3>

<p>This function aims to obtain the errors' variance-covariance matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>obtainSigmas(modelFrame=modelFrame,
             firstEstimate=firstEstimate,
             method=method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="obtainSigmas_+3A_modelframe">modelFrame</code></td>
<td>
<p>an object of the class <code>prepareData</code>,</p>
</td></tr>
<tr><td><code id="obtainSigmas_+3A_firstestimate">firstEstimate</code></td>
<td>
<p>an object of the class <code>preliminaryEstimate</code>,</p>
</td></tr>
<tr><td><code id="obtainSigmas_+3A_method">method</code></td>
<td>
<p>the estimation method to be used, one of &quot;1wayWB&quot;, &quot;2wayWB&quot;, or &quot;2wayQUE&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>obtainSigmas</code>, which is a list of the following elements:
</p>
<table>
<tr><td><code>Sigma_u</code></td>
<td>
<p>remainder error variance-covariance matrix,</p>
</td></tr>
<tr><td><code>Sigma_mu</code></td>
<td>
<p>individual error variance-covariance matrix,</p>
</td></tr>
<tr><td><code>Sigma_nu</code></td>
<td>
<p>time error variance-covariance matrix.</p>
</td></tr>
</table>

<hr>
<h2 id='panelSUR'>panelSUR package: EC SUR system models estimation on (unbalanced) panel data</h2><span id='topic+panelSUR'></span>

<h3>Description</h3>

<p>Allows to estimate one-way and two-way error component SUR systems on unbalanced panel by GLS
estimator with or without cross-equation restrictions.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> panelSUR</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-03-03</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Biørn E (2004). Regression Systems for Unbalanced Panel Data: a Stepwise Maximum Likelihood Procedure. <em>Journal of Econometrics</em>, <b>122</b>(2), 181-291.
</p>
<p>Platoni S, Barbieri L, Moro D, Sckokai P (2020). Heteroscedastic Stratified Two-way EC Models of Single
Equations and SUR Systems. <em>Econometrics and Statistics</em>, <b>15</b>, 46-66.
</p>
<p>Platoni S, Sckokai P, Moro D, (2012a). “A Note on Two-way ECM Estimation of SUR Systems on Unbalanced Panel Data. <em>Econometric Reviews</em>, <b>31</b>(2), 119–141.
</p>

<hr>
<h2 id='postEstimation'>Compute post-estimation indicators</h2><span id='topic+postEstimation'></span>

<h3>Description</h3>

<p>This function aims to compute some post estimation indicators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>postEstimation(modelFrame=modelFrame,
               firstEstimate=firstEstimate,
               system=system)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="postEstimation_+3A_modelframe">modelFrame</code></td>
<td>
<p>an object of the class <code>prepareData</code>,</p>
</td></tr>
<tr><td><code id="postEstimation_+3A_firstestimate">firstEstimate</code></td>
<td>
<p>an object of the class <code>preliminaryEstimate</code>,</p>
</td></tr>
<tr><td><code id="postEstimation_+3A_system">system</code></td>
<td>
<p>an object of the class <code>system</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>postEstimation</code>, which is the list of R-squared obtained for each equation of the estimated system.
</p>

<hr>
<h2 id='preliminaryEstimate'>Obtain preliminary system equation estimates</h2><span id='topic+preliminaryEstimate'></span>

<h3>Description</h3>

<p>This function aims to obtain the preliminary (single within one or two way) estimate of the system equations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preliminaryEstimate(modelFrame=modelFrame,
                    method=method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="preliminaryEstimate_+3A_modelframe">modelFrame</code></td>
<td>
<p>an object of the class <code>prepareData</code>,</p>
</td></tr>
<tr><td><code id="preliminaryEstimate_+3A_method">method</code></td>
<td>
<p>the estimation method to be used, one of &quot;1wayWB&quot;, &quot;2wayWB&quot;, or &quot;2wayQUE&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>preliminaryEstimate</code>, which is a list of the following elements:
</p>
<table>
<tr><td><code>f1w</code></td>
<td>
<p>centered residuals of the <em>oneway within</em> estimation obtained for each single equation of the system,</p>
</td></tr>
<tr><td><code>f2w</code></td>
<td>
<p>centered residuals of the <em>twoways within</em> estimation obtained for each single equation of the system,</p>
</td></tr>
<tr><td><code>mi_f1w</code></td>
<td>
<p>individual means of the centered <em>oneway within</em> residuals,</p>
</td></tr>
<tr><td><code>mi_f2w</code></td>
<td>
<p>individual means of the centered <em>twoways within</em> residuals,</p>
</td></tr>
<tr><td><code>mt_f2w</code></td>
<td>
<p>time means of the centered <em>twoways within</em> residuals,</p>
</td></tr>
<tr><td><code>m_f1w</code></td>
<td>
<p>mean of the centered <em>oneway within</em> residuals,</p>
</td></tr>
<tr><td><code>reglist</code></td>
<td>
<p>list of the regressor matrix of each equation,</p>
</td></tr>
<tr><td><code>reglist2</code></td>
<td>
<p>list of the regressors data frame of each equation,</p>
</td></tr>
<tr><td><code>regnames</code></td>
<td>
<p>a vector whose elements are the names of all the variables included in each equation of the system,</p>
</td></tr>
<tr><td><code>final_regnames</code></td>
<td>
<p>a vector whose elements are the names of the variables considered in the system equations, taking into account only the first appearance of those affected by restrictions on the coefficients.</p>
</td></tr>
</table>

<hr>
<h2 id='prepareData'>Prepare data for use</h2><span id='topic+prepareData'></span>

<h3>Description</h3>

<p>This function prepares data that have to be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepareData(data=data,
            restrictions=NULL,
            eqlist=eqlist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prepareData_+3A_eqlist">eqlist</code></td>
<td>
<p>a <code>list</code> containing the equations making up the SUR system. They should be object of the class &quot;formula&quot; and necessarly include the intercept,</p>
</td></tr>
<tr><td><code id="prepareData_+3A_restrictions">restrictions</code></td>
<td>
<p>a vector containing constraints on the equation coefficients, which should be expressed in the form &quot;equation_name$variable_name&quot;. Any spaces should be excluded from the restrictions definition. If one of the constraints includes an intercept term, the variable_name will be simply 'const'. Only simple restrictions involving equality between two parameters are considered, and not linear combinations involving more than two parameters,</p>
</td></tr>
<tr><td><code id="prepareData_+3A_data">data</code></td>
<td>
<p>a data frame of the class &quot;pdata.frame&quot; (mandatory).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>prepareData</code>, which is a list of the following elements:
</p>
<table>
<tr><td><code>eqlist</code></td>
<td>
<p>list of the equations of the system,</p>
</td></tr>
<tr><td><code>neq</code></td>
<td>
<p>number of the system equations,</p>
</td></tr>
<tr><td><code>varlist</code></td>
<td>
<p>list of the system variables,</p>
</td></tr>
<tr><td><code>ncoeff</code></td>
<td>
<p>number of the system coefficients,</p>
</td></tr>
<tr><td><code>sumreg</code></td>
<td>
<p>position of the first variable of each equation, including the constant, in the ordered list of the variables of the system,</p>
</td></tr>
<tr><td><code>nconstr</code></td>
<td>
<p>number of contraints,</p>
</td></tr>
<tr><td><code>constr</code></td>
<td>
<p>a matrix with as many rows as constraints, and whose row elements indicate the position, in the sorted list of model variables, of the variables affected by each constraint,</p>
</td></tr>
<tr><td><code>nind</code></td>
<td>
<p>total number of individuals,</p>
</td></tr>
<tr><td><code>nt</code></td>
<td>
<p>total number of individuals observed in each period,</p>
</td></tr>
<tr><td><code>psur</code></td>
<td>
<p>table reporting the number of times each individual is observed,</p>
</td></tr>
<tr><td><code>psurmax</code></td>
<td>
<p>maximum number of times the individuals are observed in the panel,</p>
</td></tr>
<tr><td><code>tmax</code></td>
<td>
<p>number of period included in the panel,</p>
</td></tr>
<tr><td><code>sumTi</code></td>
<td>
<p>sum of squares of the numbers of times each individual is observed,</p>
</td></tr>
<tr><td><code>sumNt</code></td>
<td>
<p>sum of squares of the numbers of individuals observed in each time period,</p>
</td></tr>
<tr><td><code>vectorTi</code></td>
<td>
<p>vector containing the number of times each individual is observed,</p>
</td></tr>
<tr><td><code>sysdata</code></td>
<td>
<p>subset of the original data frame containing only the variables used in the estimated system,</p>
</td></tr>
<tr><td><code>infoSample</code></td>
<td>
<p>information on the <code>sysdata</code> dataframe obtained trougth the <code>pdim</code> command of the <code>plm</code> package.</p>
</td></tr>
</table>

<hr>
<h2 id='printSUR'>Print summary of estimated equation system</h2><span id='topic+printSUR'></span>

<h3>Description</h3>

<p>This function prints a summary of the estimated equation system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>printSUR(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="printSUR_+3A_object">object</code></td>
<td>
<p>an object of class <code>SURest</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No values are returned from the <code>printSUR</code> function. However, when called, it generates a visual output in the console, consisting of a formatted table containing the results of the SUR estimation and other relevant information.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("SURdata", package="panelSUR")

## Data preparation
library(plm)
datap &lt;- pdata.frame(data, index=c("IND", "TIME"))

## Equations specification
eq1&lt;-Y1~X1+X2
eq2&lt;-Y2~X1+X2+X3
eqlist&lt;-c(eq1,eq2)

## System estimation
mod1&lt;-SURest(eqlist=eqlist,method="1wayWB",data=datap)

## Summary of estimation results
printSUR(mod1)
</code></pre>

<hr>
<h2 id='SURdata'>Simulated data for a simultaneous equation system</h2><span id='topic+SURdata'></span><span id='topic+data'></span>

<h3>Description</h3>

<p>The <code>SURdata</code> dataset consists of an unbalanced panel comprising 100 individuals observed across four time periods for a total of 220 observations (n=100, T=4, N=220). In order to construct this unbalanced panel, the procedure currently used for rotating panels, in which there is approximately the same number of individuals every year, has been used: a fixed percentage of individuals (20% in this case) is replaced each year, but they can re-enter the sample in the following years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SURdata)</code></pre>


<h3>Format</h3>

<p>A large unbalanced panel dataset</p>


<h3>Source</h3>

<p>Simulated data</p>

<hr>
<h2 id='SURest'>EC SUR System Models Estimation on (Unbalanced) Panel Data</h2><span id='topic+SURest'></span>

<h3>Description</h3>

<p><code>SURest</code> is used to estimate one-way and two-way SUR systems on unbalanced panel data by GLS
estimator also allowing cross-equation restrictions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SURest(data = data,
       eqlist = eqlist,
       restrictions = NULL,
       method="1wayWB")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SURest_+3A_eqlist">eqlist</code></td>
<td>
<p>a <code>list</code> containing the equations making up the SUR system. They should be object of the class &quot;formula&quot; and necessarly include the intercept,</p>
</td></tr>
<tr><td><code id="SURest_+3A_restrictions">restrictions</code></td>
<td>
<p>a vector containing constraints on the equation coefficients, which should be expressed in the form &quot;equation_name$variable_name&quot;. Any spaces should be excluded from the restrictions definition. If one of the constraints includes an intercept term, the variable_name will be simply 'const'. Only simple restrictions involving equality between two parameters are considered, and not linear combinations involving more than two parameters,</p>
</td></tr>
<tr><td><code id="SURest_+3A_method">method</code></td>
<td>
<p>the estimation method to be used, one of &quot;1wayWB&quot;, &quot;2wayWB&quot;, or &quot;2wayQUE&quot; (see details),</p>
</td></tr>
<tr><td><code id="SURest_+3A_data">data</code></td>
<td>
<p>a data frame of the class &quot;pdata.frame&quot; (mandatory).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>SURest</code> is a function for the GLS estimation of SUR system
models on (unbalanced) panel data.  It supports the following estimation methods: one-way error component procedure based on the Biorn (2004)’s procedure (<code>1wayWB</code>), two-way error component procedure based on the Biorn (2004)’s procedure (<code>2wayWB</code>), and the two-way QUE estimation procedure by Platoni <em>et al.</em> (2012) (<code>2wayQUE</code>).
</p>


<h3>Value</h3>

<p>An object of class <code>SURest</code>, which is a list of the following elements:
</p>
<table>
<tr><td><code>Sigma_u</code></td>
<td>
<p>remainder error variance-covariance matrix,</p>
</td></tr>
<tr><td><code>Sigma_mu</code></td>
<td>
<p>individual error variance-covariance matrix,</p>
</td></tr>
<tr><td><code>Sigma_nu</code></td>
<td>
<p>time error variance-covariance matrix,</p>
</td></tr>
<tr><td><code>varnames</code></td>
<td>
<p>a vector whose elements are the names of the variables considered in the system equations, taking into account only the first appearance of those affected by restrictions on the coefficients,</p>
</td></tr>
<tr><td><code>Estimate</code></td>
<td>
<p>vector of the coefficient estimates of the system equations, taking into account only the first appearance of those affected by restrictions,</p>
</td></tr>
<tr><td><code>std_error</code></td>
<td>
<p>vector of the standard errors of the coefficient estimates, taking into account only the first appearance of those affected by restrictions,</p>
</td></tr>
<tr><td><code>tstat</code></td>
<td>
<p>vector of the t-statistics associated to the coefficient estimates, taking into account only the first appearance of those affected by restrictions,</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>vector of the p-values associated to the t-statistics,</p>
</td></tr>
<tr><td><code>infoSample</code></td>
<td>
<p>information on the considered dataset obtained trougth the <code>pdim</code> command of the <code>plm</code> package,</p>
</td></tr>
<tr><td><code>neq</code></td>
<td>
<p>number of the system equations,</p>
</td></tr>
<tr><td><code>Rsquared</code></td>
<td>
<p>list of R-squared obtained for each equation of the estimated system,</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>method choosen for the system estimation.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Biorn E, (2004),
<em>Regression Systems for Unbalanced Panel Data: a Stepwise Maximum Likelihood Procedure</em>,
Journal of Econometrics, 122(2), 181&ndash;291.
</p>
<p>Platoni S, Sckokai P, Moro D (2012),
<em>A Note on Two-way ECM Estimation of SUR Systems on Unbalanced Panel Data</em>,
Econometric Reviews, 31(2), 119&ndash;141.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("SURdata", package="panelSUR")

## Data preparation
library(plm)
datap &lt;- pdata.frame(data, index=c("IND", "TIME"))

## Equations specification
eq1&lt;-Y1~X1+X2
eq2&lt;-Y2~X1+X2+X3
eq3&lt;-Y3~X2+X3
eqlist&lt;-c(eq1,eq2,eq3)

## Constraints specification
constraints&lt;-c("eq1$X2=eq2$X1","eq2$X3=eq3$X2")

## System estimation
mod1&lt;-SURest(eqlist=eqlist,restrictions=constraints,method="2wayQUE",data=datap)
</code></pre>

<hr>
<h2 id='system'>Build and solve system for beta coefficient estimates</h2><span id='topic+system'></span>

<h3>Description</h3>

<p>This function aims to built and solve the system in order to obtain beta coefficient
estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>system(modelFrame=modelFrame,
       firstEstimate=firstEstimate,
       matrices=matrices)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="system_+3A_modelframe">modelFrame</code></td>
<td>
<p>an object of the class <code>prepareData</code>,</p>
</td></tr>
<tr><td><code id="system_+3A_firstestimate">firstEstimate</code></td>
<td>
<p>an object of the class <code>preliminaryEstimate</code>,</p>
</td></tr>
<tr><td><code id="system_+3A_matrices">matrices</code></td>
<td>
<p>an object of the class <code>obtainSigmas</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>system</code>, which is a list of the following elements:
</p>
<table>
<tr><td><code>BsurQ</code></td>
<td>
<p>vector of the coefficient estimates of the system equations, taking into account only the first appearance of those affected by restrictions,</p>
</td></tr>
<tr><td><code>std_error</code></td>
<td>
<p>vector of the standard errors of the coefficient estimates, taking into account only the first appearance of those affected by restrictions,</p>
</td></tr>
<tr><td><code>t_stat</code></td>
<td>
<p>vector of the t-statistics associated to the coefficient estimates, taking into account only the first appearance of those affected by restrictions,</p>
</td></tr>
<tr><td><code>p_value</code></td>
<td>
<p>vector of the p-values associated to the t-statistics.</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
