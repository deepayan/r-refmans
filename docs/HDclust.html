<!DOCTYPE html><html><head><title>Help for package HDclust</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {HDclust}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#HDclust-package'><p>Clustering high dimensional data with Hidden Markov Model on Variable Blocks</p></a></li>
<li><a href='#clustControl'><p>Parameters for MBM clustering algorithm.</p></a></li>
<li><a href='#clustModes'><p>Hierarchical clustering of density modes</p></a></li>
<li><a href='#getBdim'><p>Accessor for 'bdim' slot</p></a></li>
<li><a href='#getBIC'><p>Accessor for 'BIC' slot.</p></a></li>
<li><a href='#getClsid'><p>Accessor for 'clsid' slot.</p></a></li>
<li><a href='#getClustParam'><p>Accessor for 'clustParam' slot.</p></a></li>
<li><a href='#getDiagCov'><p>Accessor for 'diagCov' slot.</p></a></li>
<li><a href='#getDim'><p>Accessor for 'dim' slot</p></a></li>
<li><a href='#getHmmChain'><p>Accessor for 'HmmChain' slot.</p></a></li>
<li><a href='#getHmmParam'><p>Accessor for parameters of HMM</p></a></li>
<li><a href='#getLoglikehd'><p>Accessor for 'Loglikehd' slot.</p></a></li>
<li><a href='#getNb'><p>Accessor for 'nb' slot</p></a></li>
<li><a href='#getNumst'><p>Accessor for 'numst' slot</p></a></li>
<li><a href='#getOptHMMVB'><p>Accessor for 'optHMMVB' slot.</p></a></li>
<li><a href='#getPrenumst'><p>Accessor for 'prenumst' slot</p></a></li>
<li><a href='#getSize'><p>Accessor for 'size' slot.</p></a></li>
<li><a href='#getVarorder'><p>Accessor for 'varorder' slot</p></a></li>
<li><a href='#getVb'><p>Accessor for 'VbStructure' slot.</p></a></li>
<li><a href='#hmm'><p>Make an instance of &quot;HMM&quot; class.</p></a></li>
<li><a href='#HMM-class'><p>Class &quot;HMM&quot; to represent parameters associated with a variable block in the HMM-VB</p></a></li>
<li><a href='#HMMVB-class'><p>Class &quot;HMMVB&quot; to represent a Hidden Markov Model on Variable Blocks (HMM-VB).</p></a></li>
<li><a href='#hmmvbBIC'><p>BIC for HMM-VB</p></a></li>
<li><a href='#HMMVBBIC-class'><p>Class &quot;HMMVBBIC&quot; to represent results of HMM-VB model selection.</p></a></li>
<li><a href='#hmmvbClust'><p>Cluster data with HMM-VB</p></a></li>
<li><a href='#HMMVBclust-class'><p>Class &quot;HMMVBclust&quot; to represent clustering results with Hidden Markov Model on variable block structure.</p></a></li>
<li><a href='#hmmvbFindModes'><p>Find density modes with HMM-VB</p></a></li>
<li><a href='#hmmvbTrain'><p>Train HMM-VB</p></a></li>
<li><a href='#mkhmmvb'><p>Make an instance of &quot;HMMVB&quot; class.</p></a></li>
<li><a href='#sim2'><p>Synthetic dataset used in section 5.1.2 of the reference paper.</p></a></li>
<li><a href='#sim3'><p>Synthetic dataset used in section 5.1.3 of the reference paper</p></a></li>
<li><a href='#trainControl'><p>Parameters for HMM-VB training.</p></a></li>
<li><a href='#vb'><p>Make an instance of class &quot;VB&quot;</p></a></li>
<li><a href='#VB-class'><p>Class &quot;VB&quot; to represent a variable block structure.</p></a></li>
<li><a href='#vbSearchControl'><p>Parameters for variable block structure search.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Clustering High Dimensional Data with Hidden Markov Model on
Variable Blocks</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-04-05</td>
</tr>
<tr>
<td>Description:</td>
<td>Clustering of high dimensional data with Hidden Markov Model on Variable Blocks (HMM-VB) fitted via Baum-Welch algorithm. Clustering is performed by the Modal Baum-Welch algorithm (MBW), which finds modes of the density function. Lin Lin and Jia Li (2017) <a href="http://jmlr.org/papers/v18/16-342.html">http://jmlr.org/papers/v18/16-342.html</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.16), RcppProgress (&ge; 0.1), Rtsne (&ge; 0.11.0)</td>
</tr>
<tr>
<td>Depends:</td>
<td>methods</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppProgress</td>
</tr>
<tr>
<td>Collate:</td>
<td>'AllClass.R' 'AllGeneric.R' 'AllMethod.R' 'clustControl.R'
'trainControl.R' 'hmmvbClust.R' 'hmmvbTrain.R'
'vbSearchControl.R' 'package-HDclust.R' 'RcppExports.R'
'sim3.R' 'sim2.R' 'hmmvbBIC.R' 'hmmvbFindModes.R'
'clustModes.R'</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-04-11 18:32:02 UTC; zhanglixiang</td>
</tr>
<tr>
<td>Author:</td>
<td>Yevhen Tupikov [aut],
  Lin Lin [aut],
  Lixiang Zhang [aut],
  Jia Li [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jia Li &lt;jiali@psu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-04-11 21:57:32 UTC</td>
</tr>
</table>
<hr>
<h2 id='HDclust-package'>Clustering high dimensional data with Hidden Markov Model on Variable Blocks</h2><span id='topic+HDclust-package'></span><span id='topic+HDclust'></span>

<h3>Description</h3>

<p>Clustering of high dimensional data with Hidden Markov Model on Variable Blocks (HMM-VB)
fitted via Baum-Welch algorithm. Clustering is performed by the Modal Baum-Welch
algorithm (MBW), which finds modes of the density function.
</p>


<h3>Details</h3>

<p>For a quick introduction to <span class="pkg">HDclust</span> see the vignette <a href="../doc/HDclust.html"><code>vignette("HDclust")</code></a>.
</p>


<h3>Author(s)</h3>

<p> Jia Li, Lin Lin and Yevhen Tupikov.
</p>
<p>Maintainer: Yevhen Tupikov <a href="mailto:yzt116@psu.edu">yzt116@psu.edu</a>

</p>


<h3>References</h3>

<p>Lin Lin and Jia Li, &quot;Clustering with hidden Markov model on variable blocks,&quot; <strong>Journal of Machine Learning Research</strong>, 18(110):1-49, 2017.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hmmvbTrain">hmmvbTrain</a></code>, <code><a href="#topic+hmmvbClust">hmmvbClust</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("sim3")
set.seed(12345)
Vb &lt;- vb(2, dim=40, bdim=c(10,30), numst=c(3,5), varorder=list(c(1:10),c(11:40)))
hmmvb &lt;- hmmvbTrain(sim3[,1:40], VbStructure=Vb)
clust &lt;- hmmvbClust(sim3[,1:40], model=hmmvb)
show(clust)
</code></pre>

<hr>
<h2 id='clustControl'>Parameters for MBM clustering algorithm.</h2><span id='topic+clustControl'></span>

<h3>Description</h3>

<p>This function creates a list with parameters for Modal Baum-Welch (MBW)
clustering algorithm used as an argument for <code>hmmvbClust</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clustControl(minSize = 1, modeTh = 0.01, useL1norm = FALSE,
  getlikelh = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clustControl_+3A_minsize">minSize</code></td>
<td>
<p>Minimum cluster size. Clusters that contain the number of data points
smaller than <code>minSize</code> are merged to the closest big cluster.</p>
</td></tr>
<tr><td><code id="clustControl_+3A_modeth">modeTh</code></td>
<td>
<p>Distance parameter that controls mode merging. Larger values 
promote merging of different clusters.</p>
</td></tr>
<tr><td><code id="clustControl_+3A_usel1norm">useL1norm</code></td>
<td>
<p>A logical value indicating whether or not L1 norm will be 
used to calculate the distance.</p>
</td></tr>
<tr><td><code id="clustControl_+3A_getlikelh">getlikelh</code></td>
<td>
<p>A logical value indicating whether or not to calculate the
loglikelihood for every data point.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The named list with parameters.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hmmvbTrain">hmmvbTrain</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># avoid clusters of size &lt; 60
Vb &lt;- vb(1, dim=4, numst=2)
set.seed(12345)
hmmvb &lt;- hmmvbTrain(iris[,1:4], VbStructure=Vb)
clust &lt;- hmmvbClust(iris[,1:4], model=hmmvb, control=clustControl(minSize=60))
show(clust)
</code></pre>

<hr>
<h2 id='clustModes'>Hierarchical clustering of density modes</h2><span id='topic+clustModes'></span>

<h3>Description</h3>

<p>This function performs hierarchical clustering of density modes found
by <code>hmmvbFindModes()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clustModes(modes, cutree.args, hclust.args = NULL, dist.args = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clustModes_+3A_modes">modes</code></td>
<td>
<p>An object of class 'HMMVBclust' returned by <code>hmmvbFindModes()</code>.</p>
</td></tr>
<tr><td><code id="clustModes_+3A_cutree.args">cutree.args</code></td>
<td>
<p>A list with arguments to <code>cutree</code> method from package <code>stats</code>.</p>
</td></tr>
<tr><td><code id="clustModes_+3A_hclust.args">hclust.args</code></td>
<td>
<p>A list with arguments to <code>hclust</code> method from package <code>stats</code>. It is used to 
specify a linkage method for hierarchical clustering of density modes. Complete linkage is used by default.
See <code>hclust</code> for details.</p>
</td></tr>
<tr><td><code id="clustModes_+3A_dist.args">dist.args</code></td>
<td>
<p>A list with arguments to <code>dist</code> method from package <code>stats</code>. It is used to 
specify a distance metric for the density modes. Euclidian distance is used by default. See <code>dist</code> for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'HMMVBclust' with new cluster labels and cluster sizes. Note that coordinates of modes after merging are not calculated and 
<code>clustParam</code> field is empty.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hmmvbClust">hmmvbClust</a></code>, <code><a href="#topic+hmmvbFindModes">hmmvbFindModes</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Vb &lt;- vb(1, dim=4, numst=2)
set.seed(12345)
hmmvb &lt;- hmmvbTrain(unique(iris[,1:4]), VbStructure=Vb)
modes &lt;- hmmvbFindModes(unique(iris[,1:4]), model=hmmvb)

# default mode clustering
merged &lt;- clustModes(modes, cutree.args=list(h=1.0))

# mode clustering using Manhattan distance
merged &lt;- clustModes(modes, dist.args=list(method="manhattan"), cutree.args=list(h=1.0))

# mode clustering using single linkage
merged &lt;- clustModes(modes, hclust.args=list(method="single"), cutree.args=list(h=1.0))
</code></pre>

<hr>
<h2 id='getBdim'>Accessor for 'bdim' slot</h2><span id='topic+getBdim'></span><span id='topic+getBdim+2CVB-method'></span><span id='topic+getBdim+2CHMMVB-method'></span>

<h3>Description</h3>

<p>This function outputs dimensionality of blocks of variable block structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getBdim(object)

## S4 method for signature 'VB'
getBdim(object)

## S4 method for signature 'HMMVB'
getBdim(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getBdim_+3A_object">object</code></td>
<td>
<p>Object of class &quot;VB&quot; or &quot;HMMVB&quot;.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># accessing bdim in instance of class VB
Vb &lt;- vb(2, dim=10, bdim=c(4,6), numst=c(3,11), varorder=list(c(1:4),c(5:10)))
getBdim(Vb)

# accessing bdim in instance of class HMMVB 
data("sim3")
Vb &lt;- vb(2, dim=40, bdim=c(10,30), numst=c(3,5), varorder=list(c(1:10),c(11:40)))
set.seed(12345)
hmmvb &lt;- hmmvbTrain(sim3[,1:40], VbStructure=Vb)
getBdim(hmmvb)  
    
</code></pre>

<hr>
<h2 id='getBIC'>Accessor for 'BIC' slot.</h2><span id='topic+getBIC'></span><span id='topic+getBIC+2CHMMVB-method'></span><span id='topic+getBIC+2CHMMVBBIC-method'></span>

<h3>Description</h3>

<p>This function outputs BIC for a trained HMM-VB model or a vector with BIC values calculated in model selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getBIC(object)

## S4 method for signature 'HMMVB'
getBIC(object)

## S4 method for signature 'HMMVBBIC'
getBIC(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getBIC_+3A_object">object</code></td>
<td>
<p>Object of class &quot;HMMVB&quot; or &quot;HMMVBBIC&quot;.</p>
</td></tr>
</table>

<hr>
<h2 id='getClsid'>Accessor for 'clsid' slot.</h2><span id='topic+getClsid'></span>

<h3>Description</h3>

<p>This function outputs the cluster labels for the object of class HMMVBclust.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getClsid(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getClsid_+3A_object">object</code></td>
<td>
<p>Object of class &quot;HMMVBclust&quot;.</p>
</td></tr>
</table>

<hr>
<h2 id='getClustParam'>Accessor for 'clustParam' slot.</h2><span id='topic+getClustParam'></span>

<h3>Description</h3>

<p>This function outputs clusterPar for the object of class HMMVBclust.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getClustParam(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getClustParam_+3A_object">object</code></td>
<td>
<p>Object of class &quot;HMMVBclust&quot;.</p>
</td></tr>
</table>

<hr>
<h2 id='getDiagCov'>Accessor for 'diagCov' slot.</h2><span id='topic+getDiagCov'></span>

<h3>Description</h3>

<p>This function outputs diagCov logical indicator of diagonal covariance 
matrices for HMM-VB model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDiagCov(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDiagCov_+3A_object">object</code></td>
<td>
<p>Object of class &quot;HMMVB&quot;.</p>
</td></tr>
</table>

<hr>
<h2 id='getDim'>Accessor for 'dim' slot</h2><span id='topic+getDim'></span><span id='topic+getDim+2CVB-method'></span><span id='topic+getDim+2CHMM-method'></span><span id='topic+getDim+2CHMMVB-method'></span>

<h3>Description</h3>

<p>This function outputs dimensionality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDim(object)

## S4 method for signature 'VB'
getDim(object)

## S4 method for signature 'HMM'
getDim(object)

## S4 method for signature 'HMMVB'
getDim(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDim_+3A_object">object</code></td>
<td>
<p>Object of class &quot;VB&quot;, &quot;HMM&quot; or &quot;HMMVB&quot;.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># accessing dim in instance of class VB
Vb &lt;- vb(nb=2, dim=10, bdim=c(4,6), numst=c(3,11), varorder=list(c(1:4),c(5:10)))
getDim(Vb)

# accessing dim in instance of class HMM 
data("sim3")
Vb &lt;- vb(2, dim=40, bdim=c(10,30), numst=c(3,5), varorder=list(c(1:10),c(11:40)))
set.seed(12345)
hmmvb &lt;- hmmvbTrain(sim3[,1:40], VbStructure=Vb)
getDim(getHmmChain(hmmvb)[[1]])  
    
# accessing dim in instance of class HMMVB 
data("sim3")
Vb &lt;- vb(2, dim=40, bdim=c(10,30), numst=c(3,5), varorder=list(c(1:10),c(11:40)))
set.seed(12345)
hmmvb &lt;- hmmvbTrain(sim3[,1:40], VbStructure=Vb)
getDim(hmmvb)  
    
</code></pre>

<hr>
<h2 id='getHmmChain'>Accessor for 'HmmChain' slot.</h2><span id='topic+getHmmChain'></span>

<h3>Description</h3>

<p>This function outputs a list with trained HMMs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getHmmChain(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getHmmChain_+3A_object">object</code></td>
<td>
<p>Object of class &quot;HMMVB&quot;.</p>
</td></tr>
</table>

<hr>
<h2 id='getHmmParam'>Accessor for parameters of HMM</h2><span id='topic+getHmmParam'></span>

<h3>Description</h3>

<p>This function outputs a list with means, covariance matrices, inverse covarince matrices and
logarithms of the determinants of the covariance matrices for all states of the HMM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getHmmParam(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getHmmParam_+3A_object">object</code></td>
<td>
<p>Object of class &quot;HMM&quot;.</p>
</td></tr>
</table>

<hr>
<h2 id='getLoglikehd'>Accessor for 'Loglikehd' slot.</h2><span id='topic+getLoglikehd'></span><span id='topic+getLoglikehd+2CHMMVB-method'></span><span id='topic+getLoglikehd+2CHMMVBBIC-method'></span><span id='topic+getLoglikehd+2CHMMVBclust-method'></span>

<h3>Description</h3>

<p>This function outputs Loglikelihood for each data point in a trained HMM-VB model or Loglikelihood for a new dataset in a HMM-VB model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getLoglikehd(object)

## S4 method for signature 'HMMVB'
getLoglikehd(object)

## S4 method for signature 'HMMVBBIC'
getLoglikehd(object)

## S4 method for signature 'HMMVBclust'
getLoglikehd(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getLoglikehd_+3A_object">object</code></td>
<td>
<p>Object of class &quot;HMMVB&quot;, &quot;HMMVBBIC&quot; &quot;HMMVBclust&quot;.</p>
</td></tr>
</table>

<hr>
<h2 id='getNb'>Accessor for 'nb' slot</h2><span id='topic+getNb'></span><span id='topic+getNb+2CVB-method'></span><span id='topic+getNb+2CHMMVB-method'></span>

<h3>Description</h3>

<p>This function outputs number of blocks of the variable block structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNb(object)

## S4 method for signature 'VB'
getNb(object)

## S4 method for signature 'HMMVB'
getNb(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getNb_+3A_object">object</code></td>
<td>
<p>Object of class &quot;VB&quot; or &quot;HMMVB&quot;.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># accessing nb in instance of class VB
Vb &lt;- vb(2, dim=10, bdim=c(4,6), numst=c(3,11), varorder=list(c(1:4),c(5:10)))
getNb(Vb)

# accessing nb in instance of class HMMVB 
data("sim3")
Vb &lt;- vb(2, dim=40, bdim=c(10,30), numst=c(3,5), varorder=list(c(1:10),c(11:40)))
set.seed(12345)
hmmvb &lt;- hmmvbTrain(sim3[,1:40], VbStructure=Vb)
getNb(hmmvb)  
    
</code></pre>

<hr>
<h2 id='getNumst'>Accessor for 'numst' slot</h2><span id='topic+getNumst'></span><span id='topic+getNumst+2CVB-method'></span><span id='topic+getNumst+2CHMM-method'></span><span id='topic+getNumst+2CHMMVB-method'></span>

<h3>Description</h3>

<p>This function outputs the number of states for each variable block in the variable block structure, 
the number of states of the HMM, or the number of states for each variable block of the HMM-VB.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNumst(object)

## S4 method for signature 'VB'
getNumst(object)

## S4 method for signature 'HMM'
getNumst(object)

## S4 method for signature 'HMMVB'
getNumst(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getNumst_+3A_object">object</code></td>
<td>
<p>Object of class &quot;VB&quot;, &quot;HMM&quot; or &quot;HMMVB&quot;.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># accessing numst in instance of class VB
Vb &lt;- vb(2, dim=10, bdim=c(4,6), numst=c(3,11), varorder=list(c(1:4),c(5:10)))
getNumst(Vb)

# accessing getNumst in instance of class HMM 
data("sim3")
Vb &lt;- vb(2, dim=40, bdim=c(10,30), numst=c(3,5), varorder=list(c(1:10),c(11:40)))
set.seed(12345)
hmmvb &lt;- hmmvbTrain(sim3[,1:40], VbStructure=Vb)
getNumst(getHmmChain(hmmvb)[[1]])  
    
# accessing numst in instance of class HMMVB 
data("sim3")
Vb &lt;- vb(2, dim=40, bdim=c(10,30), numst=c(3,5), varorder=list(c(1:10),c(11:40)))
set.seed(12345)
hmmvb &lt;- hmmvbTrain(sim3[,1:40], VbStructure=Vb)
getNumst(hmmvb)  
    
</code></pre>

<hr>
<h2 id='getOptHMMVB'>Accessor for 'optHMMVB' slot.</h2><span id='topic+getOptHMMVB'></span>

<h3>Description</h3>

<p>This function outputs the optimal HMM-VB found via BIC model selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getOptHMMVB(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getOptHMMVB_+3A_object">object</code></td>
<td>
<p>Object of class &quot;HMMVBBIC&quot;.</p>
</td></tr>
</table>

<hr>
<h2 id='getPrenumst'>Accessor for 'prenumst' slot</h2><span id='topic+getPrenumst'></span>

<h3>Description</h3>

<p>This function outputs the number of states in the HMM for the preceding block of HMM-VB.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPrenumst(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getPrenumst_+3A_object">object</code></td>
<td>
<p>Object of class &quot;HMM&quot;.</p>
</td></tr>
</table>

<hr>
<h2 id='getSize'>Accessor for 'size' slot.</h2><span id='topic+getSize'></span>

<h3>Description</h3>

<p>This function outputs the number of points in each cluster for the object of class HMMVBclust.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSize(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSize_+3A_object">object</code></td>
<td>
<p>Object of class &quot;HMMVBclust&quot;.</p>
</td></tr>
</table>

<hr>
<h2 id='getVarorder'>Accessor for 'varorder' slot</h2><span id='topic+getVarorder'></span><span id='topic+getVarorder+2CVB-method'></span><span id='topic+getVarorder+2CHMMVB-method'></span>

<h3>Description</h3>

<p>This function outputs the ordering of the variable blocks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getVarorder(object)

## S4 method for signature 'VB'
getVarorder(object)

## S4 method for signature 'HMMVB'
getVarorder(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getVarorder_+3A_object">object</code></td>
<td>
<p>Object of class &quot;VB&quot; or &quot;HMMVB&quot;.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># accessing varorder in instance of class VB
Vb &lt;- vb(2, dim=10, bdim=c(4,6), numst=c(3,11), varorder=list(c(1:4),c(5:10)))
getVarorder(Vb)

# accessing varorder in instance of class HMMVB 
data("sim3")
Vb &lt;- vb(2, dim=40, bdim=c(10,30), numst=c(3,5), varorder=list(c(1:10),c(11:40)))
set.seed(12345)
hmmvb &lt;- hmmvbTrain(sim3[,1:40], VbStructure=Vb)
getVarorder(hmmvb)  
    
</code></pre>

<hr>
<h2 id='getVb'>Accessor for 'VbStructure' slot.</h2><span id='topic+getVb'></span>

<h3>Description</h3>

<p>This function outputs the variable block structure in the HMM-VB.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getVb(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getVb_+3A_object">object</code></td>
<td>
<p>Object of class &quot;HMMVB&quot;.</p>
</td></tr>
</table>

<hr>
<h2 id='hmm'>Make an instance of &quot;HMM&quot; class.</h2><span id='topic+hmm'></span>

<h3>Description</h3>

<p>This function creates a Hidden Markov Model on a variable block.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hmm(dim, numst, prenumst, a00, a, mean, sigma, sigmaInv, sigmaDetLog)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hmm_+3A_dim">dim</code></td>
<td>
<p>Dimensionality of the data in HMM.</p>
</td></tr>
<tr><td><code id="hmm_+3A_numst">numst</code></td>
<td>
<p>An integer vector specifying the number of HMM states.</p>
</td></tr>
<tr><td><code id="hmm_+3A_prenumst">prenumst</code></td>
<td>
<p>An integer vector specifying the number of states of previous 
variable block HMM.</p>
</td></tr>
<tr><td><code id="hmm_+3A_a00">a00</code></td>
<td>
<p>Probabilities of HMM states.</p>
</td></tr>
<tr><td><code id="hmm_+3A_a">a</code></td>
<td>
<p>Transition probability matrix from states in the previous variable block
to the states in the current one.</p>
</td></tr>
<tr><td><code id="hmm_+3A_mean">mean</code></td>
<td>
<p>A numerical matrix with state means. <em>k</em>th row corresponds to the
<em>k</em>th state.</p>
</td></tr>
<tr><td><code id="hmm_+3A_sigma">sigma</code></td>
<td>
<p>A list containing state covariance matrices.</p>
</td></tr>
<tr><td><code id="hmm_+3A_sigmainv">sigmaInv</code></td>
<td>
<p>A list containing state inverse covariance matrices.</p>
</td></tr>
<tr><td><code id="hmm_+3A_sigmadetlog">sigmaDetLog</code></td>
<td>
<p>A vector with <code class="reqn">log(|sigma|)</code> for each state.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'HMM'.
</p>

<hr>
<h2 id='HMM-class'>Class &quot;HMM&quot; to represent parameters associated with a variable block in the HMM-VB</h2><span id='topic+HMM-class'></span><span id='topic+HMM'></span><span id='topic+show+2CHMM-method'></span><span id='topic+getPrenumst+2CHMM-method'></span><span id='topic+getHmmParam+2CHMM-method'></span>

<h3>Description</h3>

<p>An S4 class to represent the model parameters associated with one variable block in the HMM-VB.
For brevity, we call this part of HMM-VB, specific to a particular variable block, an &quot;HMM&quot; for the block. New instances of the class are created by <code><a href="#topic+hmmvbTrain">hmmvbTrain</a></code>.
</p>


<h3>Methods</h3>


<ul>
<li> <p><b>show</b> signature(object = &quot;HMM&quot;) : show parameters of the HMM object.
</p>
</li>
<li> <p><b>getPrenumst</b> signature(object = &quot;HMM&quot;) : accessor for 'prenumst' slot.
</p>
</li>
<li> <p><b>getHmmParam</b> signature(object = &quot;HMM&quot;) : accessor for parameters of the HMM object. This function outputs a list with means, covariance matrices, inverse covarince matrices and logarithms of the determinants of the covariance matrices for all states of the HMM.
</p>
</li></ul>


<h3>Slots</h3>


<dl>
<dt><code>dim</code></dt><dd><p>Dimensionality of the data in HMM.</p>
</dd>
<dt><code>numst</code></dt><dd><p>An integer vector specifying the number of HMM states.</p>
</dd>
<dt><code>prenumst</code></dt><dd><p>An integer vector specifying the number of states of previous 
variable block HMM.</p>
</dd>
<dt><code>a00</code></dt><dd><p>Probabilities of HMM states.</p>
</dd>
<dt><code>a</code></dt><dd><p>Transition probability matrix from states in the previous variable block
to the states in the current one.</p>
</dd>
<dt><code>mean</code></dt><dd><p>A numerical matrix with state means. <em>k</em>th row corresponds to the
<em>k</em>th state.</p>
</dd>
<dt><code>sigma</code></dt><dd><p>A list containing the covariance matrices of states.</p>
</dd>
<dt><code>sigmaInv</code></dt><dd><p>A list containing the inverse covariance matrices of states.</p>
</dd>
<dt><code>sigmaDetLog</code></dt><dd><p>A vector with <code class="reqn">log(|sigma|)</code> for each state.</p>
</dd>
</dl>

<hr>
<h2 id='HMMVB-class'>Class &quot;HMMVB&quot; to represent a Hidden Markov Model on Variable Blocks (HMM-VB).</h2><span id='topic+HMMVB-class'></span><span id='topic+HMMVB'></span><span id='topic+show+2CHMMVB-method'></span><span id='topic+getHmmChain+2CHMMVB-method'></span><span id='topic+getDiagCov+2CHMMVB-method'></span><span id='topic+getVb+2CHMMVB-method'></span>

<h3>Description</h3>

<p>An S4 class to represent a Hidden Markov Model on Variable Blocks (HMM-VB). 
New instances of the class are created by <code><a href="#topic+hmmvbTrain">hmmvbTrain</a></code>.
</p>


<h3>Methods</h3>


<ul>
<li> <p><b>show</b> signature(object = &quot;HMMVB&quot;) : show parameters of the HMM-VB.
</p>
</li>
<li> <p><b>getHmmChain</b> signature(object = &quot;HMMVB&quot;) : accessor for 'HmmChain' slot.
</p>
</li>
<li> <p><b>getDiagCov</b> signature(object = &quot;HMMVB&quot;) : accessor for 'diagCov' slot.
</p>
</li>
<li> <p><b>getBIC</b> signature(object = &quot;HMMVB&quot;) : accessor for 'BIC' slot.
</p>
</li>
<li> <p><b>getVb</b> signature(object = &quot;HMMVB&quot;) : accessor for 'VbStructure' slot.
</p>
</li></ul>


<h3>Slots</h3>


<dl>
<dt><code>VbStructure</code></dt><dd><p>An object of class 'VB' that contains the variable block structure.</p>
</dd>
<dt><code>HmmChain</code></dt><dd><p>A list of objects of class 'HMM' with trained Hidden Markov Models
for each variable block.</p>
</dd>
<dt><code>diagCov</code></dt><dd><p>A logical value indicating whether or not covariance matrices 
for mixture models are diagonal.</p>
</dd>
<dt><code>Loglikehd</code></dt><dd><p>Loglikelihood value for each data point.</p>
</dd>
<dt><code>BIC</code></dt><dd><p>BIC value for provided variable block structure or optimal BIC value
for found variable block structure.</p>
</dd>
</dl>

<hr>
<h2 id='hmmvbBIC'>BIC for HMM-VB</h2><span id='topic+hmmvbBIC'></span>

<h3>Description</h3>

<p>This function finds an optimal number of mixture components (states) for 
HMM-VB using the Bayesian Information Criterion (BIC). The variable block 
structure is provided as input and then BIC is estimated for HMM-VB with 
different configurations of states for the variable blocks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hmmvbBIC(data, VbStructure, configList = NULL, numst = 1:10,
  trControl = trainControl(), nthread = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hmmvbBIC_+3A_data">data</code></td>
<td>
<p>A numeric vector, matrix, or data frame of observations.
Categorical values are not allowed. If a matrix or data frame, rows 
correspond to observations and columns correspond to variables.</p>
</td></tr>
<tr><td><code id="hmmvbBIC_+3A_vbstructure">VbStructure</code></td>
<td>
<p>An object of class 'VB'. Variable block 
structure stored in VbStructure is used to train HMM-VB model. <code>numst</code> parameter
of the variable block structure is ignored.</p>
</td></tr>
<tr><td><code id="hmmvbBIC_+3A_configlist">configList</code></td>
<td>
<p>A list of integer vectors specifying number of states in each variable
block for which BIC is to be calculated.</p>
</td></tr>
<tr><td><code id="hmmvbBIC_+3A_numst">numst</code></td>
<td>
<p>An integer vector specifying the numbers of mixture components (states) in 
each variable block for which BIC is to be calculated. Number of states is the same for 
all variable blocks. The argument is ignored if <code>configList</code> argument is provided.</p>
</td></tr>
<tr><td><code id="hmmvbBIC_+3A_trcontrol">trControl</code></td>
<td>
<p>A list of control parameters for HMM-VB training algorithm.
The defaults are set by the call <code>hmmvbTrainControl()</code>.</p>
</td></tr>
<tr><td><code id="hmmvbBIC_+3A_nthread">nthread</code></td>
<td>
<p>An integer specifying the number of threads used in searching and 
training routines.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list with estimated BIC values and the number of states or state configurations
for which BIC was calculated.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VB">VB</a></code>, <code><a href="#topic+vb">vb</a></code>, <code><a href="#topic+trainControl">trainControl</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Default search for the optimal number of states for HMM-VB model 
data("sim3")
Vb &lt;- vb(2, dim=40, bdim=c(10,30), numst=c(1,1), varorder=list(c(1:10),c(11:40)))
set.seed(12345)
hmmvbBIC(sim3[1:40], VbStructure)

# Search for the optimal number of states for HMM-VB model using 
# provided values for the number of states 
data("sim3")
Vb &lt;- vb(2, dim=40, bdim=c(10,30), numst=c(1,1), varorder=list(c(1:10),c(11:40)))
set.seed(12345)
hmmvbBIC(sim3[1:40], VbStructure=Vb, numst=c(2L, 4L, 6L))

# Search for the optimal number of states for HMM-VB model using 
# provided configurations of the number of states 
data("sim3")
Vb &lt;- vb(2, dim=40, bdim=c(10,30), numst=c(1,1), varorder=list(c(1:10),c(11:40)))
set.seed(12345)
configs = list(c(1,2), c(3,5), c(6,7))
hmmvbBIC(sim3[1:40], VbStructure=Vb, configList=configs)
</code></pre>

<hr>
<h2 id='HMMVBBIC-class'>Class &quot;HMMVBBIC&quot; to represent results of HMM-VB model selection.</h2><span id='topic+HMMVBBIC-class'></span><span id='topic+HMMVBBIC'></span><span id='topic+show+2CHMMVBBIC-method'></span><span id='topic+plot+2CHMMVBBIC+2Cmissing-method'></span><span id='topic+getOptHMMVB+2CHMMVBBIC-method'></span>

<h3>Description</h3>

<p>An S4 class to represent results of HMM-VB model selection. New instances of the class are created by <code><a href="#topic+hmmvbBIC">hmmvbBIC</a></code>.
</p>


<h3>Methods</h3>


<ul>
<li> <p><b>show</b> signature(object = &quot;HMMVBBIC&quot;) : show optimal model.
</p>
</li>
<li> <p><b>plot</b> signature(x = &quot;HMMVBBIC&quot;, y = &quot;missing&quot;, ...) : plot model selection results (doesn't work for configuration list provided as input to model selection).
</p>
</li>
<li> <p><b>getBIC</b> signature(object = &quot;HMMVBBIC&quot;) : accessor for 'BIC' slot.
</p>
</li>
<li> <p><b>getLoglikehd</b> signature(object = &quot;HMMVBBIC&quot;) : accessor for 'Loglikehd' slot.
</p>
</li>
<li> <p><b>getOptHMMVB</b> signature(object = &quot;HMMVBBIC&quot;) : accessor for 'optHMMVB' slot.
</p>
</li></ul>


<h3>Slots</h3>


<dl>
<dt><code>BIC</code></dt><dd><p>A numeric vector specifying calculated BIC values.</p>
</dd>
<dt><code>optHMMVB</code></dt><dd><p>The optimal HMM-VB model with smallest BIC value.</p>
</dd>
<dt><code>numst</code></dt><dd><p>An integer vector specifying the number of mixture components (states) in each variable block for which BIC was calculated. Number of states is the same for all variable blocks.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+hmmvbBIC">hmmvbBIC</a></code>
</p>

<hr>
<h2 id='hmmvbClust'>Cluster data with HMM-VB</h2><span id='topic+hmmvbClust'></span>

<h3>Description</h3>

<p>This function clusters dataset with HMM-VB. First, for each data point it finds an optimal state sequence
using Viterbi algorithm. Next, it uses Modal Baum-Welch algorithm (MBW) to find the modes
of distinct Viterbi state sequences. Data points associated the same modes form clusters. 
If different data sets are clustered using the same HMM-VB, clustering results of one data set
can be supplied as a reference during clustering of another data set to produce aligned clusters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hmmvbClust(data, model = NULL, control = clustControl(),
  rfsClust = NULL, nthread = 1, bicObj = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hmmvbClust_+3A_data">data</code></td>
<td>
<p>A numeric vector, matrix, or data frame of observations.
Categorical values are not allowed. If a matrix or data frame, rows 
correspond to observations and columns correspond to variables.</p>
</td></tr>
<tr><td><code id="hmmvbClust_+3A_model">model</code></td>
<td>
<p>An object of class 'HMMVB' that contains trained HMM-VB obtained 
by the call to function <code>hmmvbTrain</code>.</p>
</td></tr>
<tr><td><code id="hmmvbClust_+3A_control">control</code></td>
<td>
<p>A list of control parameters for clustering. The defaults are set by 
the call <code>clustControl()</code>.</p>
</td></tr>
<tr><td><code id="hmmvbClust_+3A_rfsclust">rfsClust</code></td>
<td>
<p>A list of parameters for the reference cluster that can be used
for alignment. See <code>HMMVBclust</code>
for details.</p>
</td></tr>
<tr><td><code id="hmmvbClust_+3A_nthread">nthread</code></td>
<td>
<p>An integer specifying the number of threads used in clustering.</p>
</td></tr>
<tr><td><code id="hmmvbClust_+3A_bicobj">bicObj</code></td>
<td>
<p>An object of class 'HMMVBBIC' which stores results of model selection. 
If provided, argument <code>model</code> is ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'HMMVBclust'.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HMMVB-class">HMMVB-class</a></code>, <code><a href="#topic+HMMVBclust-class">HMMVBclust-class</a></code>, <code><a href="#topic+hmmvbTrain">hmmvbTrain</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># cluster using trained HMM-VB
Vb &lt;- vb(1, dim=4, numst=2)
set.seed(12345)
hmmvb &lt;- hmmvbTrain(iris[,1:4], VbStructure=Vb)
clust &lt;- hmmvbClust(iris[,1:4], model=hmmvb)
show(clust)
pairs(iris[,1:4], col=getClsid(clust))


# cluster using HMMVBBIC object obtained in model selection
Vb &lt;- vb(1, dim=4, numst=1)
set.seed(12345)
modelBIC &lt;- hmmvbBIC(iris[,1:4], VbStructure=Vb)
clust &lt;- hmmvbClust(iris[,1:4], bicObj=modelBIC)
show(clust)
pairs(iris[,1:4], col=getClsid(clust))
</code></pre>

<hr>
<h2 id='HMMVBclust-class'>Class &quot;HMMVBclust&quot; to represent clustering results with Hidden Markov Model on variable block structure.</h2><span id='topic+HMMVBclust-class'></span><span id='topic+HMMVBclust'></span><span id='topic+show+2CHMMVBclust-method'></span><span id='topic+plot+2CHMMVBclust+2Cmissing-method'></span><span id='topic+getClustParam+2CHMMVBclust-method'></span><span id='topic+getClsid+2CHMMVBclust-method'></span><span id='topic+getSize+2CHMMVBclust-method'></span>

<h3>Description</h3>

<p>An S4 class to represent a clustering result based on HMM-VB. New instances of the class are created by <code><a href="#topic+hmmvbClust">hmmvbClust</a></code>.
</p>


<h3>Methods</h3>


<ul>
<li> <p><b>show</b> signature(object = &quot;HMMVBclust&quot;) : show clustering results based on HMM-VB.
</p>
</li>
<li> <p><b>plot</b> signature(x = &quot;HMMVBclust&quot;, y = &quot;missing&quot;, method = &quot;t-sne&quot;, ...) : plot clustering results. 'method' controls the visualization algorithm. Two algorithms are supported:  method = 'PCA' plots the data using 2 component PCA space; and method = 't-SNE' plots the data using 2 component t-SNE space. Default setting is t-SNE.
</p>
</li>
<li> <p><b>getClustParam</b> signature(object = &quot;HMMVBclust&quot;) : accessor for 'clustParam' slot.
</p>
</li>
<li> <p><b>getLoglikehd</b> signature(object = &quot;HMMVBclust&quot;) : accessor for 'Loglikehd' slot.
</p>
</li>
<li> <p><b>getClsid</b> signature(object = &quot;HMMVBclust&quot;) : accessor for 'clsid' slot.
</p>
</li>
<li> <p><b>getSize</b> signature(object = &quot;HMMVBclust&quot;) : accessor for 'size' slot.
</p>
</li></ul>


<h3>Slots</h3>


<dl>
<dt><code>data</code></dt><dd><p>The input data matrix</p>
</dd>
<dt><code>clustParam</code></dt><dd><p>A list with cluster parameters:
</p>

<dl>
<dt>ncls</dt><dd><p>The number of clusters (same as the number of modes)</p>
</dd>
<dt>mode</dt><dd><p>A numeric matrix with cluster modes. <em>k</em>th row of the matrix 
stores coordinates of the <em>k</em>th mode.</p>
</dd>
<dt>ndseq</dt><dd><p>The number of distinct Viterbi sequences for the dataset</p>
</dd>
<dt>vseqid</dt><dd><p>An integer vector representing the map between Viterbi 
sequences and clusters. <em>k</em>th value in the vector stores cluster id for
<em>k</em>th Viterbi sequence.</p>
</dd>
<dt>vseq</dt><dd><p>A list with integer vectors representing distinct Viterbi sequences
for the dataset</p>
</dd>
<dt>sigma</dt><dd><p>A numeric vector with the dataset variance</p>
</dd>
</dl>
</dd>
<dt><code>clsid</code></dt><dd><p>An integer vector with cluster ids.</p>
</dd>
<dt><code>Loglikehd</code></dt><dd><p>Loglikelihood value for each data point.</p>
</dd>
<dt><code>size</code></dt><dd><p>An integer vector with cluster sizes.</p>
</dd>
</dl>

<hr>
<h2 id='hmmvbFindModes'>Find density modes with HMM-VB</h2><span id='topic+hmmvbFindModes'></span>

<h3>Description</h3>

<p>This function finds the density modes with HMM-VB. First, for each data point it finds an optimal state sequence
using Viterbi algorithm. Next, it uses Modal Baum-Welch algorithm (MBW) to find the modes
of distinct Viterbi state sequences. Data points associated the same modes form clusters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hmmvbFindModes(data, model = NULL, nthread = 1, bicObj = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hmmvbFindModes_+3A_data">data</code></td>
<td>
<p>A numeric vector, matrix, or data frame of observations.
Categorical values are not allowed. If a matrix or data frame, rows 
correspond to observations and columns correspond to variables.</p>
</td></tr>
<tr><td><code id="hmmvbFindModes_+3A_model">model</code></td>
<td>
<p>An object of class 'HMMVB' that contains trained HMM-VB obtained 
by the call to function <code>hmmvbTrain</code>.</p>
</td></tr>
<tr><td><code id="hmmvbFindModes_+3A_nthread">nthread</code></td>
<td>
<p>An integer specifying the number of threads used in clustering.</p>
</td></tr>
<tr><td><code id="hmmvbFindModes_+3A_bicobj">bicObj</code></td>
<td>
<p>An object of class 'HMMVBBIC' which stores results of model selection. 
If provided, argument <code>model</code> is ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'HMMVBclust'.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HMMVB-class">HMMVB-class</a></code>, <code><a href="#topic+HMMVBclust-class">HMMVBclust-class</a></code>, <code><a href="#topic+hmmvbTrain">hmmvbTrain</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># find modes using trained HMM-VB
Vb &lt;- vb(1, dim=4, numst=2)
set.seed(12345)
hmmvb &lt;- hmmvbTrain(iris[,1:4], VbStructure=Vb)
modes &lt;- hmmvbFindModes(iris[,1:4], model=hmmvb)
show(modes)


# find modes using HMMVBBIC object obtained in model selection
Vb &lt;- vb(1, dim=4, numst=1)
set.seed(12345)
modelBIC &lt;- hmmvbBIC(iris[,1:4], VbStructure=Vb)
modes &lt;- hmmvbClust(iris[,1:4], bicObj=modelBIC)
show(modes)
</code></pre>

<hr>
<h2 id='hmmvbTrain'>Train HMM-VB</h2><span id='topic+hmmvbTrain'></span>

<h3>Description</h3>

<p>This function estimates parameters for HMM-VB
using the Baum-Welch algorithm. If the variable block structure
is not provided, the function will first find the structure by
a greedy search algorithm that minimizes BIC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hmmvbTrain(data, VbStructure = NULL, searchControl = vbSearchControl(),
  trControl = trainControl(), nthread = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hmmvbTrain_+3A_data">data</code></td>
<td>
<p>A numeric vector, matrix, or data frame of observations.
Categorical values are not allowed. If a matrix or data frame, rows 
correspond to observations and columns correspond to variables.</p>
</td></tr>
<tr><td><code id="hmmvbTrain_+3A_vbstructure">VbStructure</code></td>
<td>
<p>An object of class 'VB'. If supplied, variable block 
structure stored in VbStructure is used to train HMM-VB. If not 
provided, a search algorithm will be perfomed to find a variable block
structure with minimal BIC.</p>
</td></tr>
<tr><td><code id="hmmvbTrain_+3A_searchcontrol">searchControl</code></td>
<td>
<p>A list of control parameters for variable block structure
search. This parameter is ignored if variable block structure VbStructure is provided.
The defaults are set by the call <code>vbSearchControl()</code>.</p>
</td></tr>
<tr><td><code id="hmmvbTrain_+3A_trcontrol">trControl</code></td>
<td>
<p>A list of control parameters for HMM-VB training algorithm.
The defaults are set by the call <code>hmmvbTrainControl()</code>.</p>
</td></tr>
<tr><td><code id="hmmvbTrain_+3A_nthread">nthread</code></td>
<td>
<p>An integer specifying the number of threads used in searching and 
training routines.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'HMMVB' providing estimation for HMM-VB.
The details of output components are as follows:
</p>
<table>
<tr><td><code>VbStructure</code></td>
<td>
<p>An object of class 'VB' with variable block structure for 
HMM-VB</p>
</td></tr>
<tr><td><code>HmmChain</code></td>
<td>
<p>A list of objects of class 'HMM' with trained Hidden Markov Models
for each variable block.</p>
</td></tr>
<tr><td><code>diagCov</code></td>
<td>
<p>A logical value indicating whether or not covariance matrices 
for mixture models are diagonal.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>BIC value for provided variable block structure or optimal BIC value
for found variable block structure.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+VB">VB</a></code>, <code><a href="#topic+vb">vb</a></code>, <code><a href="#topic+vbSearchControl">vbSearchControl</a></code>, 
<code><a href="#topic+trainControl">trainControl</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Train HMM-VB with known variable block structure
data("sim3")
Vb &lt;- vb(2, dim=40, bdim=c(10,30), numst=c(3,5), varorder=list(c(1:10),c(11:40)))
set.seed(12345)
hmmvb &lt;- hmmvbTrain(sim3[,1:40], VbStructure=Vb)
show(hmmvb)


# Train HMM-VB with unknown variable block structure using default parameters
data("sim2")
set.seed(12345)
hmmvb &lt;- hmmvbTrain(sim2[,1:5])
show(hmmvb)

# Train HMM-VB with unknown variable block structure using with ten permutations
# and several threads
data("sim2")
set.seed(12345)
hmmvb &lt;- hmmvbTrain(sim2[1:5], searchControl=vbSearchControl(nperm=10), nthread=3)
show(hmmvb)
</code></pre>

<hr>
<h2 id='mkhmmvb'>Make an instance of &quot;HMMVB&quot; class.</h2><span id='topic+mkhmmvb'></span>

<h3>Description</h3>

<p>This function creates an instance of &quot;HMMVB&quot; class. The function is called inside 
C code during HMMVB model training. It is not meant to be called by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkhmmvb(VbStructure, HmmChain, BIC, diagCov, Loglikehd)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mkhmmvb_+3A_vbstructure">VbStructure</code></td>
<td>
<p>An object of class 'VB' that contains variable block structure.</p>
</td></tr>
<tr><td><code id="mkhmmvb_+3A_hmmchain">HmmChain</code></td>
<td>
<p>A list of objects of class 'HMM' with trained Hidden Markov Models
for each variable block.</p>
</td></tr>
<tr><td><code id="mkhmmvb_+3A_bic">BIC</code></td>
<td>
<p>BIC value for provided variable block structure or optimal BIC value
for found variable block structure.</p>
</td></tr>
<tr><td><code id="mkhmmvb_+3A_diagcov">diagCov</code></td>
<td>
<p>A logical value indicating whether or not covariance matrices 
for mixture models are diagonal.</p>
</td></tr>
<tr><td><code id="mkhmmvb_+3A_loglikehd">Loglikehd</code></td>
<td>
<p>Loglikelihood value for each data point</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An instance of class &quot;HMMVB&quot;
</p>

<hr>
<h2 id='sim2'>Synthetic dataset used in section 5.1.2 of the reference paper.</h2><span id='topic+sim2'></span>

<h3>Description</h3>

<p>Dataset used for testing clustering with HMM-VB.
The data dimension is 5. Data points were drawn from a 10-component Gaussian Mixture Model.
By specific choice of the means, the data contains 10 distinct clusters. For details see the 
references.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim2
</code></pre>


<h3>Format</h3>

<p>A data frame with 5000 rows and 5 variables. Last column contains ground truth cluster labels.</p>


<h3>References</h3>

<p>Lin Lin and Jia Li, &quot;Clustering with hidden Markov model on variable blocks,&quot; <strong>Journal of Machine Learning Research</strong>, 18(110):1-49, 2017.
</p>

<hr>
<h2 id='sim3'>Synthetic dataset used in section 5.1.3 of the reference paper</h2><span id='topic+sim3'></span>

<h3>Description</h3>

<p>Dataset used for testing clustering with HMM-VB.
The data dimension is 40. The first 10 dimensions were generated from a 3-component Gaussian
Mixture Model (GMM). The remaining 30 dimensions were generated from a 5-component GMM. By specific design
of the means, covariance matrices and transition probabilities, the data contain 5 distinct clusters. 
For details see the references.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim3
</code></pre>


<h3>Format</h3>

<p>A data frame with 1000 rows and 40 variables. Last column contains ground truth cluster labels.</p>


<h3>References</h3>

<p>Lin Lin and Jia Li, &quot;Clustering with hidden Markov model on variable blocks,&quot; <strong>Journal of Machine Learning Research</strong>, 18(110):1-49, 2017.
</p>

<hr>
<h2 id='trainControl'>Parameters for HMM-VB training.</h2><span id='topic+trainControl'></span>

<h3>Description</h3>

<p>This function creates a list with parameters for estimating an HMM-VB,
which is used as an argument for <code>hmmvbTrain</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trainControl(ninit0 = 1, ninit1 = 0, ninit2 = 0, epsilon = 1e-04,
  diagCov = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trainControl_+3A_ninit0">ninit0</code></td>
<td>
<p>The number of initializations for default scheme 0, under
which the k-means clustering for entire dataset is used to initialize the model.</p>
</td></tr>
<tr><td><code id="trainControl_+3A_ninit1">ninit1</code></td>
<td>
<p>The number of initializations for default scheme 1, under
which the k-means clustering for a subset of data is used to initialize the model.</p>
</td></tr>
<tr><td><code id="trainControl_+3A_ninit2">ninit2</code></td>
<td>
<p>The number of initializations for default scheme 2, under
which a random subset of data is used as cluster centroids to initialize the model.</p>
</td></tr>
<tr><td><code id="trainControl_+3A_epsilon">epsilon</code></td>
<td>
<p>Stopping criteria for Baum-Welch algorithm. Should be a small number in 
range (0,1).</p>
</td></tr>
<tr><td><code id="trainControl_+3A_diagcov">diagCov</code></td>
<td>
<p>A logical value indicating whether or not variable block covariance matrices
will be diagonal.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The named list with parameters.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hmmvbTrain">hmmvbTrain</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># setting up multiple initialization schemes
Vb &lt;- vb(1, dim=4, numst=2)
set.seed(12345)
hmmvb &lt;- hmmvbTrain(iris[,1:4], VbStructure=Vb, 
          trControl=trainControl(ninit0=2, ninit1=2, ninit2=2))
show(hmmvb)

# forcing diagonal covariance matrices
Vb &lt;- vb(1, dim=4, numst=2)
set.seed(12345)
hmmvb &lt;- hmmvbTrain(iris[,1:4], VbStructure=Vb, 
          trControl=trainControl(diagCov=TRUE))
show(hmmvb)
</code></pre>

<hr>
<h2 id='vb'>Make an instance of class &quot;VB&quot;</h2><span id='topic+vb'></span>

<h3>Description</h3>

<p>This function creates a variable block structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vb(nb, dim, bdim = NULL, numst, varorder = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vb_+3A_nb">nb</code></td>
<td>
<p>The number of variable blocks.</p>
</td></tr>
<tr><td><code id="vb_+3A_dim">dim</code></td>
<td>
<p>Dimensionality of the data.</p>
</td></tr>
<tr><td><code id="vb_+3A_bdim">bdim</code></td>
<td>
<p>An integer vector specifying dimensionality of each variable block.
This argument can be omitted if the variable block structure has a single
block (case of GMM).</p>
</td></tr>
<tr><td><code id="vb_+3A_numst">numst</code></td>
<td>
<p>An integer vector specifying the number of mixture models in each 
variable block.</p>
</td></tr>
<tr><td><code id="vb_+3A_varorder">varorder</code></td>
<td>
<p>A list of integer vectors specifying the variable order in 
each variable block. This argument can be omitted if variable structure has a single
variable block (GMM).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;VB&quot;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VB">VB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># variable block structure for GMM with 3 dimensions and 2 mixture states
Vb &lt;- vb(1, dim=3, numst=2)

# variable block structure with 2 variable blocks
Vb &lt;- vb(2, dim=10, bdim=c(4,6), numst=c(3,11), varorder=list(c(1:4),c(5:10)))
</code></pre>

<hr>
<h2 id='VB-class'>Class &quot;VB&quot; to represent a variable block structure.</h2><span id='topic+VB-class'></span><span id='topic+VB'></span><span id='topic+show+2CVB-method'></span>

<h3>Description</h3>

<p>An S4 class to represent a variable block structure. To create a new
instance of the class, use <code><a href="#topic+vb">vb</a></code>.
</p>


<h3>Methods</h3>


<ul>
<li> <p><b>show</b> signature(object = &quot;VB&quot;) : show parameters of variable blocks structure.
</p>
</li>
<li> <p><b>getNb</b> signature(object = &quot;VB&quot;) : accessor for 'nb' slot.
</p>
</li>
<li> <p><b>getDim</b> signature(object = &quot;VB&quot;) : accessor for 'dim' slot.
</p>
</li>
<li> <p><b>getBdim</b> signature(object = &quot;VB&quot;) : accessor for 'bdim' slot.
</p>
</li>
<li> <p><b>getNumst</b> signature(object = &quot;VB&quot;) : accessor for 'numst' slot.
</p>
</li>
<li> <p><b>getVarorder</b> signature(object = &quot;VB&quot;) : accessor for 'varorder' slot.
</p>
</li></ul>


<h3>Slots</h3>


<dl>
<dt><code>nb</code></dt><dd><p>The number of variable blocks.</p>
</dd>
<dt><code>dim</code></dt><dd><p>Dimensionality of the data.</p>
</dd>
<dt><code>bdim</code></dt><dd><p>An integer vector specifying dimensionality of each variable block.</p>
</dd>
<dt><code>numst</code></dt><dd><p>An integer vector specifying the number of mixture models in each 
variable block.</p>
</dd>
<dt><code>varorder</code></dt><dd><p>A list of integer vectors specifying the variable order in 
each variable block.</p>
</dd>
</dl>

<hr>
<h2 id='vbSearchControl'>Parameters for variable block structure search.</h2><span id='topic+vbSearchControl'></span>

<h3>Description</h3>

<p>This function creates a list with parameters for the search of a variable 
block structure used as an argument for <code>hmmvbTrain</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vbSearchControl(perm = NULL, numstPerDim = NULL, dim = NULL,
  maxDim = 10, minDim = 1, nperm = 1, relax = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vbSearchControl_+3A_perm">perm</code></td>
<td>
<p>A list of integer vectors specifying variable permutations. If
provided, the argument <code>dim</code> must be supplied.</p>
</td></tr>
<tr><td><code id="vbSearchControl_+3A_numstperdim">numstPerDim</code></td>
<td>
<p>An integer vector of length <code>maxDim</code> specifying a map from
the variable block dimensionality to the number of states in the block. 
<em>k</em>th value in the vector corresponds to number of states for dimensionality <em>k</em>.</p>
</td></tr>
<tr><td><code id="vbSearchControl_+3A_dim">dim</code></td>
<td>
<p>Data dimensionality. Must be provided with <code>perm</code> argument,
otherwise is ignored.</p>
</td></tr>
<tr><td><code id="vbSearchControl_+3A_maxdim">maxDim</code></td>
<td>
<p>Maximum variable block dimension.</p>
</td></tr>
<tr><td><code id="vbSearchControl_+3A_mindim">minDim</code></td>
<td>
<p>Minimum variable block dimension. Should be an integer equal to 1 or 2.</p>
</td></tr>
<tr><td><code id="vbSearchControl_+3A_nperm">nperm</code></td>
<td>
<p>The number of variable permutations. This parameter is ignored 
if permutations are provided in <code>perm</code> argument.</p>
</td></tr>
<tr><td><code id="vbSearchControl_+3A_relax">relax</code></td>
<td>
<p>A logical value indicating whether or not variable block structure search 
will be performed under less restricting conditions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The named list with parameters.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hmmvbTrain">hmmvbTrain</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># setting up permutations
perm &lt;- list(c(1,2,3), c(1,3,2), c(3,2,1))
searchControl &lt;- vbSearchControl(perm=perm, dim=3)

# setting up a map between block dimensionality and number of states
searchControl &lt;- vbSearchControl(maxDim=5, numstPerDim=c(3,4,5,6,7))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
