<!DOCTYPE html><html><head><title>Help for package bayesmix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bayesmix}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BMMdiag'><p>Plot identifiability diagnostics for JAGSrun object</p></a></li>
<li><a href='#BMMmodel'><p>Creates bugs model.</p></a></li>
<li><a href='#BMMposteriori'><p>Plot aposteriori probabilities of data points</p></a></li>
<li><a href='#BMMpriors'><p>Create a 'BMMpriors' object</p></a></li>
<li><a href='#darwin'><p>Differences in heights between plants</p></a></li>
<li><a href='#fish'><p>Fish length data</p></a></li>
<li><a href='#initsFS'><p>Create initial values</p></a></li>
<li><a href='#JAGScall'><p>Call jags</p></a></li>
<li><a href='#JAGScontrol'><p>Control parameters for the sampling.</p></a></li>
<li><a href='#JAGSrun'><p>MCMC sampling of Bayesian models</p></a></li>
<li><a href='#plot.BMMposteriori'><p>Plot a posteriori probabilities of data points</p></a></li>
<li><a href='#plot.JAGSrun'><p>Plot JAGSrun object</p></a></li>
<li><a href='#priors'><p>Create list of prior specifications</p></a></li>
<li><a href='#randomPermutation'><p>Randomly permute segments for MCMC draws</p></a></li>
<li><a href='#Sort'><p>Sort MCMC chains according to certain variables</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.7-6</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-04-11</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Mixture Models with JAGS</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10),</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats, methods, rjags (&ge; 2.1.0), coda (&ge; 0.13)</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits finite mixture models of univariate Gaussian distributions using JAGS within a Bayesian framework.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://statmath.wu.ac.at/~gruen/BayesMix/">https://statmath.wu.ac.at/~gruen/BayesMix/</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-12 13:21:18 UTC; gruen</td>
</tr>
<tr>
<td>Author:</td>
<td>Bettina Gruen <a href="https://orcid.org/0000-0001-7265-4773"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Martyn Plummer <a href="https://orcid.org/0000-0001-5130-6497"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bettina Gruen &lt;Bettina.Gruen@R-project.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-12 13:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='BMMdiag'>Plot identifiability diagnostics for JAGSrun object</h2><span id='topic+BMMdiag'></span>

<h3>Description</h3>

<p>Two different plots are currently provided: a plot of different
variables against each other and a plot of the same variable against
its values in the other classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BMMdiag(object, which = 1:2, variables, ask = interactive(), fct1,
        fct2, xlim, ylim, auto.layout = TRUE, caption = NULL,
        main = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BMMdiag_+3A_object">object</code></td>
<td>
<p>a <code>JAGSrun</code> object with model of class <code>BMMmodel</code>.</p>
</td></tr>
<tr><td><code id="BMMdiag_+3A_which">which</code></td>
<td>
<p>if only one of the plots is required, specify its number.</p>
</td></tr>
<tr><td><code id="BMMdiag_+3A_variables">variables</code></td>
<td>
<p>if <code>variables</code> is missing, the names are taken
from the <code>JAGSrun</code> object.</p>
</td></tr>
<tr><td><code id="BMMdiag_+3A_ask">ask</code></td>
<td>
<p>prompt user before each page of plots</p>
</td></tr>
<tr><td><code id="BMMdiag_+3A_fct1">fct1</code></td>
<td>
<p>string: name of transformation function for variable on x-axis.</p>
</td></tr>
<tr><td><code id="BMMdiag_+3A_fct2">fct2</code></td>
<td>
<p>string: name of transformation function for variable on y-axis.</p>
</td></tr>
<tr><td><code id="BMMdiag_+3A_xlim">xlim</code></td>
<td>
<p>if no range for <code>xlim</code> is specified, a sensible range is
taken.</p>
</td></tr>
<tr><td><code id="BMMdiag_+3A_ylim">ylim</code></td>
<td>
<p>if no range for <code>ylim</code> is specified, a sensible range is
taken.</p>
</td></tr>
<tr><td><code id="BMMdiag_+3A_auto.layout">auto.layout</code></td>
<td>
<p>logical: if <code>TRUE</code> puts each of the two
different plots on one figure.</p>
</td></tr>
<tr><td><code id="BMMdiag_+3A_caption">caption</code></td>
<td>
<p>captions to appear above the plots.</p>
</td></tr>
<tr><td><code id="BMMdiag_+3A_main">main</code></td>
<td>
<p>title to each plot (in addition to the above 'caption').</p>
</td></tr>
<tr><td><code id="BMMdiag_+3A_...">...</code></td>
<td>
<p>further graphical parameters (see 'plot.xy' and 'par') may
also be supplied as arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plots help determining which variable will induce a unique
labelling when taken for ordering of the segments and indicate if the
model is overfitted by specifying too  many segments.
</p>


<h3>Author(s)</h3>

<p>Bettina Gruen</p>

<hr>
<h2 id='BMMmodel'>Creates bugs model.</h2><span id='topic+BMMmodel'></span><span id='topic+print.JAGSmodel'></span>

<h3>Description</h3>

<p>Creates the BUGS-model specification and return the values for the
initialization, the prior specification and the observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BMMmodel(y, k, priors, inits = "initsFS", aprioriWeights = 1,
         no.empty.classes = FALSE, restrict = "none", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BMMmodel_+3A_y">y</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
<tr><td><code id="BMMmodel_+3A_k">k</code></td>
<td>
<p>integer indicating the number of segments.</p>
</td></tr>
<tr><td><code id="BMMmodel_+3A_priors">priors</code></td>
<td>
<p>specification of priors by a named list or a
<code>BMMpriors</code> object.</p>
</td></tr>
<tr><td><code id="BMMmodel_+3A_inits">inits</code></td>
<td>
<p>specification of initial values by a named list or string
indicating the function to be called.</p>
</td></tr>
<tr><td><code id="BMMmodel_+3A_aprioriweights">aprioriWeights</code></td>
<td>
<p>specification of prior of the a-priori weights. If
<code>aprioriWeights</code> does not have length = k, there is an equal
prior for the a-priori weights assumed.</p>
</td></tr>
<tr><td><code id="BMMmodel_+3A_no.empty.classes">no.empty.classes</code></td>
<td>
<p>logical: should it be prevented that empty
classes arise during sampling.</p>
</td></tr>
<tr><td><code id="BMMmodel_+3A_restrict">restrict</code></td>
<td>
<p>one of &quot;none&quot;, &quot;mu&quot;, &quot;tau&quot;.</p>
</td></tr>
<tr><td><code id="BMMmodel_+3A_...">...</code></td>
<td>
<p>further parameters for the function specified in
<code>inits</code>.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>By default the function <code>initsFS</code> is called for generating
initial values. Any other function specified by <code>inits</code> is
assumed to have at least <code>x</code>, <code>k</code> and <code>restrict</code> as
input parameters.
</p>
<p>The parameter <code>restrict</code> indicates if a
location-shift model (&quot;tau&quot;), a scale contaminated model
(&quot;mu&quot;) or a model where both variables vary over components shall
be fitted.
</p>
<p>If the logical <code>no.empty.classes</code> is <code>TRUE</code> there
are observations added to the model that the classes are not empty. This
signifies that the likelihood when sampling the class affiliations is
changed thus that any data point which is sampled and is the last one
in its class stays there.  
</p>


<h3>Value</h3>

<p>If <code>y</code> is specified an object of class <code>BMMmodel</code> is
returned with components:
</p>
<table>
<tr><td><code>inits</code></td>
<td>
<p>named list.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>named list.</p>
</td></tr>
<tr><td><code>bugs</code></td>
<td>
<p>text for .bug-file with prefix missing.</p>
</td></tr>
</table>
<p>If <code>y</code> is missing an object of class <code>BMMsetup</code> is
returned containing the parameter specifications. When <code>JAGScall</code>
is called with this object as model argument, <code>BMMmodel</code> is
called with <code>y</code> and the other parameters as input arguments
before calling JAGS.
</p>


<h3>Author(s)</h3>

<p>Bettina Gruen</p>


<h3>See Also</h3>

<p><code><a href="#topic+JAGSrun">JAGSrun</a></code>, <code><a href="#topic+initsFS">initsFS</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("fish", package = "bayesmix")
model &lt;- BMMmodel(fish, k = 4, priors = list(kind = "independence",
                  parameter = "priorsFish", hierarchical = "tau"),
                  initialValues = list(S0 = 2))
model
</code></pre>

<hr>
<h2 id='BMMposteriori'>Plot aposteriori probabilities of data points</h2><span id='topic+BMMposteriori'></span>

<h3>Description</h3>

<p>Given a <code>JAGSrun</code> object with model of class <code>BMMmodel</code> the
aposteriori probabilities are determined. If <code>plot=TRUE</code>, the
resulting object of class <code>BMMposteriori</code> is plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BMMposteriori(object, class, caption = NULL, plot = TRUE,
              auto.layout = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BMMposteriori_+3A_object">object</code></td>
<td>
<p>a <code>JAGSrun</code> object with model of class <code>BMMmodel</code>.</p>
</td></tr>
<tr><td><code id="BMMposteriori_+3A_class">class</code></td>
<td>
<p>a vector of integers indicating for which classes the
posterior probabilities shall be plotted. The default is all.</p>
</td></tr>
<tr><td><code id="BMMposteriori_+3A_caption">caption</code></td>
<td>
<p>captions to appear above the plots.</p>
</td></tr>
<tr><td><code id="BMMposteriori_+3A_plot">plot</code></td>
<td>
<p>logical indicating if a plot shall be made.</p>
</td></tr>
<tr><td><code id="BMMposteriori_+3A_auto.layout">auto.layout</code></td>
<td>
<p>logical: if <code>TRUE</code> puts all classes in the
posterior probabilities plot on the same figure.</p>
</td></tr>
<tr><td><code id="BMMposteriori_+3A_...">...</code></td>
<td>
<p>further graphical parameters may also be supplied as
arguments.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>Given a <code>JAGSrun</code> object with model of class <code>BMMmodel</code> the a
posteriori probabilities are calculated for the unique data points
with respect to the components specified by <code>class</code>.
</p>


<h3>Value</h3>

<p>There is a <code>BMMposteriori</code> object returned which is a list
including the following components
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>vector of unique data points.</p>
</td></tr>
<tr><td><code>post</code></td>
<td>
<p>a matrix including the posteriori probability of the data
points for each class.</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Bettina Gruen</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.BMMposteriori">plot.BMMposteriori</a></code></p>

<hr>
<h2 id='BMMpriors'>Create a 'BMMpriors' object</h2><span id='topic+BMMpriors'></span>

<h3>Description</h3>

<p>This function enables a comfortable creation of
<code>BMMpriors</code> objects, which can be used for specifying the priors 
of a <code>BMMmodel</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BMMpriors(specification, y, eps = 10^-16)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BMMpriors_+3A_specification">specification</code></td>
<td>
<p>named list including <code>kind</code>, <code>parameter</code>,
<code>hierarchical</code> and <code>mod</code>.</p>
</td></tr>
<tr><td><code id="BMMpriors_+3A_y">y</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
<tr><td><code id="BMMpriors_+3A_eps">eps</code></td>
<td>
<p>a numeric value indicating the smallest value for flat priors.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In <code>specification</code> <code>kind</code> can be used for specifying
if an &quot;independent&quot; or a &quot;conditionallyconjugate&quot;
prior shall be used. <code>parameter</code> can be a named list of values for
the prior variables or a function name (e.g., &quot;priorsUncertain&quot;,
&quot;priorsFish&quot;, &quot;priorsRaftery&quot;). <code>hierarchical</code> can be <code>NULL</code>
or &quot;tau&quot; if a hierarchical prior shall be taken for
<code class="reqn">\tau</code>. <code>mod</code> is a named list which provides the possibility
to override the values from <code>parameter</code>. 
</p>


<h3>Value</h3>

<p>There is an object <code>BMMpriors</code> returned with components
</p>
<table>
<tr><td><code>name</code></td>
<td>
<p>vector indicating which kind of prior is specified and if
it is an hierarchical prior and if appropriate with respect to which
variable.</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>list of variables in the prior and their specified values.</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Bettina Gruen</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data("fish", package = "bayesmix")
  priors &lt;- BMMpriors(y = fish)
</code></pre>

<hr>
<h2 id='darwin'>Differences in heights between plants</h2><span id='topic+darwin'></span>

<h3>Description</h3>

<p>A numeric vector containing 15 observations of differences in heights
between pairs of self-fertilized and cross-fertilized plants grown in
the same condition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(darwin)</code></pre>


<h3>Format</h3>

<p>A numeric vector of length 15.
</p>


<h3>Details</h3>

<p>Darwin's data set contains two extremely small values. Therefore, this
data set can be used for outlier modelling.
</p>


<h3>Source</h3>

<p>Abraham, B. and G. Box (1978)
Linear models and spurious observations.
<em>Applied Statistics</em>, <b>27</b>, 131&ndash;8.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("darwin", package = "bayesmix")
## Estimated sample density
plot(density(darwin[[1]]), ylim = c(0, 0.02), main = "Outlier modelling")
ss &lt;- seq(-100, 100, by = 1)
## Normal density with estimated mean and sd of whole sample
lines(ss, dnorm(ss, mean = mean(darwin[[1]]), sd = sd(darwin[[1]])), col = "red")
## Normal density with estimated mean and sd of sample, where the 2
## extremely small values are removed
lines(ss, dnorm(ss, mean = mean(darwin[-c(1:2),1]),
      sd = sd(darwin[-c(1:2),1])), col = "green")
</code></pre>

<hr>
<h2 id='fish'>Fish length data</h2><span id='topic+fish'></span>

<h3>Description</h3>

<p>A numeric vector containing 256 observations of fish lengths.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fish)</code></pre>


<h3>Format</h3>

<p>A numeric vector of length 256.
</p>


<h3>Details</h3>

<p>This data set can be used for modeling unobserved
heterogeneity, as it can be assumed that underlying categories
present in the data are the age groups to which the fish belong.  
</p>


<h3>Source</h3>

<p>D. M. Titterington, A. F. M. Smith and U.E. Makov (1985)
<em>Statistical Analysis of Finite Mixture Distributions.</em>
Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("fish", package = "bayesmix")
ss &lt;- seq(-3, 13, by = 0.01)
hist(fish[[1]], 20, freq = FALSE, main = "Fish data")
lines(ss, dnorm(ss, mean(fish[[1]]), sd(fish[[1]])), col = "red")
</code></pre>

<hr>
<h2 id='initsFS'>Create initial values</h2><span id='topic+initsFS'></span>

<h3>Description</h3>

<p>Initial values for nodes are created after the suggestion in Sylvia
Fruehwirth-Schnatter's book.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initsFS(x, k, restrict, initialValues = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="initsFS_+3A_x">x</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
<tr><td><code id="initsFS_+3A_k">k</code></td>
<td>
<p>number of segments.</p>
</td></tr>
<tr><td><code id="initsFS_+3A_initialvalues">initialValues</code></td>
<td>
<p>additional initial values specifications.</p>
</td></tr>
<tr><td><code id="initsFS_+3A_restrict">restrict</code></td>
<td>
<p>one of &quot;none&quot;, &quot;mu&quot;, &quot;tau&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The initial values for <code class="reqn">\mu</code> are determined by the quantiles of
the data, those for <code class="reqn">\eta</code> give equal weight on each segment and
those for <code class="reqn">\tau</code> are equal for all segments and estimated by the
inverse of the IQR of the data divided by 1.34 and squared.
</p>


<h3>Value</h3>

<p>A list with initial values for the parameter indicated by the
name of the respective list element is returned. 
</p>


<h3>Author(s)</h3>

<p>Bettina Gruen</p>

<hr>
<h2 id='JAGScall'>Call jags</h2><span id='topic+JAGScall'></span>

<h3>Description</h3>

<p>Using functionality from package rjags the JAGS model is created and
posterior draws are sampled.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JAGScall(model, y, prefix, control, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JAGScall_+3A_model">model</code></td>
<td>
<p><code>JAGSmodel</code> object or output from <code>BMMmodel</code>.</p>
</td></tr>
<tr><td><code id="JAGScall_+3A_y">y</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
<tr><td><code id="JAGScall_+3A_prefix">prefix</code></td>
<td>
<p>character: prefix for .bug-file.</p>
</td></tr>
<tr><td><code id="JAGScall_+3A_control">control</code></td>
<td>
<p>named list or <code>JAGScontrol</code> object.</p>
</td></tr>
<tr><td><code id="JAGScall_+3A_...">...</code></td>
<td>
<p>additional parameters handed over to <code>BMMmodel</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>"JAGSrun"</code> object.
</p>


<h3>Author(s)</h3>

<p>Bettina Gruen</p>


<h3>See Also</h3>

<p><code><a href="#topic+JAGSrun">JAGSrun</a></code></p>

<hr>
<h2 id='JAGScontrol'>Control parameters for the sampling.</h2><span id='topic+JAGScontrol'></span>

<h3>Description</h3>

<p>The information on the number of burn-in draws and monitored draws is
specified. Furthermore, it includes the information which variables
shall be monitored and possibly a seed and a random number generator (RNG).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JAGScontrol(variables, n.iter = 1000, thin = 1, burn.in = 0, seed,
            rng = c("base::Wichmann-Hill",
                    "base::Marsaglia-Multicarry",
                    "base::Super-Duper",
                    "base::Mersenne-Twister"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JAGScontrol_+3A_variables">variables</code></td>
<td>
<p>names of variables which shall be monitored.</p>
</td></tr>
<tr><td><code id="JAGScontrol_+3A_n.iter">n.iter</code></td>
<td>
<p>number of monitored draws.</p>
</td></tr>
<tr><td><code id="JAGScontrol_+3A_thin">thin</code></td>
<td>
<p>thinning interval.</p>
</td></tr>
<tr><td><code id="JAGScontrol_+3A_burn.in">burn.in</code></td>
<td>
<p>number of discarded burn-in draws.</p>
</td></tr>
<tr><td><code id="JAGScontrol_+3A_seed">seed</code></td>
<td>
<p>integer setting the seed for the RNG.</p>
</td></tr>
<tr><td><code id="JAGScontrol_+3A_rng">rng</code></td>
<td>
<p>specification of RNG.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>JAGScontrol</code> is returned which is a list
containing the specified information.
</p>


<h3>Author(s)</h3>

<p>Bettina Gruen</p>


<h3>See Also</h3>

<p><code><a href="#topic+JAGSrun">JAGSrun</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>control &lt;- JAGScontrol(variables = "mu")
control
</code></pre>

<hr>
<h2 id='JAGSrun'>MCMC sampling of Bayesian models</h2><span id='topic+JAGSrun'></span><span id='topic+print.JAGSrun'></span>

<h3>Description</h3>

<p>Calls jags for MCMC sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JAGSrun(y, prefix = yname, model = BMMmodel(k = 2),
        control = JAGScontrol(variables = c("mu", "tau", "eta")),
        tmp = TRUE, cleanup = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JAGSrun_+3A_y">y</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
<tr><td><code id="JAGSrun_+3A_prefix">prefix</code></td>
<td>
<p>character: prefix for .bug-file.</p>
</td></tr>
<tr><td><code id="JAGSrun_+3A_model">model</code></td>
<td>
<p>object of class <code>JAGSmodel</code> or output from <code>BMMmodel</code>.</p>
</td></tr>
<tr><td><code id="JAGSrun_+3A_control">control</code></td>
<td>
<p>specification of control by a <code>JAGScontrol</code> object.</p>
</td></tr>
<tr><td><code id="JAGSrun_+3A_tmp">tmp</code></td>
<td>
<p>logical: shall the files be written in a temporary directory.</p>
</td></tr>
<tr><td><code id="JAGSrun_+3A_cleanup">cleanup</code></td>
<td>
<p>logical: shall the created files be removed.</p>
</td></tr>
<tr><td><code id="JAGSrun_+3A_yname">yname</code></td>
<td>
<p>a character string with the actual <code>y</code> argument name.</p>
</td></tr>
<tr><td><code id="JAGSrun_+3A_...">...</code></td>
<td>
<p>further parameters handed over to <code>BMMmodel</code> where it
is used for the function specifying the initial values, e.g.,
<code>initsFS</code>.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>This function is a wrapper calling <code>JAGScall</code>.
</p>


<h3>Value</h3>

<p>Returns a <code>JAGSrun</code> object with components
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>results</code></td>
<td>
<p>MCMC results obtained by calling functionality from
package <span class="pkg">rjags</span>.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>a <code>JAGSmodel</code> object.</p>
</td></tr>
<tr><td><code>variables</code></td>
<td>
<p>vector containing the names of the monitored variables.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bettina Gruen</p>


<h3>See Also</h3>

<p><code><a href="#topic+JAGScall">JAGScall</a></code>,
<code><a href="#topic+BMMmodel">BMMmodel</a></code>, <code><a href="#topic+initsFS">initsFS</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("fish", package = "bayesmix")
prefix &lt;- "fish"
variables &lt;- c("mu","tau","eta")
k &lt;- 3
modelFish &lt;- BMMmodel(k = k, priors = list(kind = "independence",
                      parameter = "priorsFish", hierarchical = "tau"))
controlFish &lt;- JAGScontrol(variables = c(variables, "S"), n.iter = 100)
z1 &lt;- JAGSrun(fish, prefix, model = modelFish, initialValues = list(S0 = 2),
              control = controlFish, cleanup = TRUE, tmp = FALSE)
zSort &lt;- Sort(z1, "mu")
BMMposteriori(zSort)

data("darwin", package = "bayesmix")
prefix &lt;- "darwin"
k &lt;- 2
modelDarwin &lt;- BMMmodel(k = k, priors = list(kind = "independence",
                        parameter = "priorsUncertain"),
                        aprioriWeights = c(1, 15),
                        no.empty.classes = TRUE, restrict = "tau")
z2 &lt;- JAGSrun(darwin, prefix, model = modelDarwin, control =
              JAGScontrol(variables = variables, n.iter = 3000,
              burn.in = 1000), cleanup = TRUE, tmp = FALSE)
plot(z2, variables = "mu")
</code></pre>

<hr>
<h2 id='plot.BMMposteriori'>Plot a posteriori probabilities of data points</h2><span id='topic+plot.BMMposteriori'></span>

<h3>Description</h3>

<p>Plot method for object of class <code>BMMposteriori</code>, typically
called by <code>BMMposteriori</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BMMposteriori'
plot(x, caption, main = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.BMMposteriori_+3A_x">x</code></td>
<td>
<p>a <code>BMMposteriori</code> object.</p>
</td></tr>
<tr><td><code id="plot.BMMposteriori_+3A_caption">caption</code></td>
<td>
<p>captions to appear above the plots.</p>
</td></tr>
<tr><td><code id="plot.BMMposteriori_+3A_main">main</code></td>
<td>
<p>title to each plot-in addition to the above <code>caption</code>.</p>
</td></tr>
<tr><td><code id="plot.BMMposteriori_+3A_...">...</code></td>
<td>
<p>further graphical parameters may also be supplied as
arguments.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>This function is called by <code>BMMposteriori</code> if <code>plot =
    TRUE</code>. 
</p>


<h3>Author(s)</h3>

<p>Bettina Gruen</p>


<h3>See Also</h3>

<p><code><a href="#topic+BMMposteriori">BMMposteriori</a></code></p>

<hr>
<h2 id='plot.JAGSrun'>Plot JAGSrun object</h2><span id='topic+plot.JAGSrun'></span>

<h3>Description</h3>

<p>Plots <code>mcmc</code> chains of a <code>JAGSrun</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'JAGSrun'
plot(x, variables = NULL, trace = TRUE, density = TRUE,
     smooth = TRUE, bwf, num, xlim, auto.layout = TRUE,
     ask = interactive(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.JAGSrun_+3A_x">x</code></td>
<td>
<p>a <code>JAGSrun</code> object.</p>
</td></tr>
<tr><td><code id="plot.JAGSrun_+3A_variables">variables</code></td>
<td>
<p>names of variables which shall be plotted. Default
are all names of results except those with a column dimension larger
than the number of classes <code>k</code>.</p>
</td></tr>
<tr><td><code id="plot.JAGSrun_+3A_trace">trace</code></td>
<td>
<p>plot trace of each variable.</p>
</td></tr>
<tr><td><code id="plot.JAGSrun_+3A_density">density</code></td>
<td>
<p>plot density estimate of each variable.</p>
</td></tr>
<tr><td><code id="plot.JAGSrun_+3A_smooth">smooth</code></td>
<td>
<p>draw a smooth line through trace plots.</p>
</td></tr>
<tr><td><code id="plot.JAGSrun_+3A_bwf">bwf</code></td>
<td>
<p>bandwidth function for density plots.</p>
</td></tr>
<tr><td><code id="plot.JAGSrun_+3A_num">num</code></td>
<td>
<p>if not all classes of a variable shall be plotted, a subset
can be specified.</p>
</td></tr>
<tr><td><code id="plot.JAGSrun_+3A_xlim">xlim</code></td>
<td>
<p>if not specified, the range of each variable over all
classes is taken as default.</p>
</td></tr>
<tr><td><code id="plot.JAGSrun_+3A_auto.layout">auto.layout</code></td>
<td>
<p>automatically generate output format.</p>
</td></tr>
<tr><td><code id="plot.JAGSrun_+3A_ask">ask</code></td>
<td>
<p>prompt user before each page of plots.</p>
</td></tr>
<tr><td><code id="plot.JAGSrun_+3A_...">...</code></td>
<td>
<p>further arguments for <code>densityplot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Adapted from <code>plot.mcmc</code>.
</p>
<p>Currently only implemented for <code>JAGSrun</code> objects with model of class
<code>BMMmodel</code>. Otherwise the default plot method for the <code>results</code>
of the <code>JAGSrun</code> object is called (<code>plot.mcmc</code>).
</p>


<h3>Author(s)</h3>

<p>Bettina Gruen</p>


<h3>See Also</h3>

<p><code><a href="coda.html#topic+plot.mcmc">plot.mcmc</a></code>, <code><a href="#topic+BMMdiag">BMMdiag</a></code>,
<code><a href="#topic+BMMposteriori">BMMposteriori</a></code></p>

<hr>
<h2 id='priors'>Create list of prior specifications</h2><span id='topic+priorsFish'></span><span id='topic+priorsRaftery'></span><span id='topic+priorsUncertain'></span>

<h3>Description</h3>

<p>Given the data values for the priors are determined.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>priorsFish(y, eps = 10^-16)
priorsRaftery(y)
priorsUncertain(y, eps = 10^-16)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="priors_+3A_y">y</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
<tr><td><code id="priors_+3A_eps">eps</code></td>
<td>
<p>a numeric value indicating the smallest value for flat priors.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Values for the prior parameter <code>b0</code>, <code>B0</code>, <code>nu0</code>
and <code>S0</code> are determined.
</p>


<h3>Value</h3>

<p>There is a list returned with named components of the prior parameters.
</p>


<h3>Author(s)</h3>

<p>Bettina Gruen</p>

<hr>
<h2 id='randomPermutation'>Randomly permute segments for MCMC draws</h2><span id='topic+randomPermutation'></span>

<h3>Description</h3>

<p>Random permutation of segment labels for each draw in order to get a
better estimate of the unrestricted likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randomPermutation(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="randomPermutation_+3A_x">x</code></td>
<td>
<p>a <code>JAGSrun</code> object with model of class <code>BMMmodel</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The draws are permuted with respect to the different classes
<code>k</code>. 
</p>


<h3>Value</h3>

<p>The input object with permuted results for each draw is returned.
</p>


<h3>Warning</h3>

<p>Any variables where there are neither <code>k</code>
different chains nor only one chain observed are dropped.</p>


<h3>Author(s)</h3>

<p>Bettina Gruen</p>

<hr>
<h2 id='Sort'>Sort MCMC chains according to certain variables</h2><span id='topic+Sort'></span>

<h3>Description</h3>

<p>Ascending sorting of results of <code>JAGSrun</code> object with
model of class <code>BMMmodel</code> with respect to a given variable. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sort(x, by = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sort_+3A_x">x</code></td>
<td>
<p>a <code>JAGSrun</code> object with model of class <code>BMMmodel</code>.</p>
</td></tr>
<tr><td><code id="Sort_+3A_by">by</code></td>
<td>
<p>variable name according to which the segments shall be
ordered.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>by</code> is not specified, the first variable in the
corresponding vector of the <code>JAGSrun</code> object is taken.
</p>


<h3>Value</h3>

<p>The input object with results sorted in ascending order according
to the variable given in <code>by</code> is returned.  
</p>


<h3>Warning</h3>

<p>If there arise problems, the original object is
returned with a warning.</p>


<h3>Author(s)</h3>

<p>Bettina Gruen</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
