<!DOCTYPE html><html lang="en"><head><title>Help for package quaxnat</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {quaxnat}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#extract_dist'><p>Extracting distances to nearest seed source for point data</p></a></li>
<li><a href='#k_exponential_power'><p>Dispersal kernels from exponential power family</p></a></li>
<li><a href='#k_lognormal'><p>Dispersal kernels for log-normal distance distributions</p></a></li>
<li><a href='#k_power'><p>Power-law dispersal kernels</p></a></li>
<li><a href='#k_t'><p>Dispersal kernels from spatial t distribution</p></a></li>
<li><a href='#k_weibull'><p>Dispersal kernels for Weibull distance distributions</p></a></li>
<li><a href='#predict_quax'><p>Prediction of potential regeneration densities</p></a></li>
<li><a href='#quax'><p>Estimating potential regeneration densities by quantile regression</p></a></li>
<li><a href='#regeneration'><p>Regeneration densities at inventory plots and potential dispersal distances</p>
to nearest seed trees</a></li>
<li><a href='#seed_tree_distmap'><p>Distance map to nearest seed source</p></a></li>
<li><a href='#summary.quax'><p>Summarizing quantile regression fits of potential regeneration densities</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Estimation of Natural Regeneration Potential</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for estimating the potential dispersal of tree species 
  using regeneration densities and dispersal distances to nearest seed trees. 
  A quantile regression is implemented to determine the dispersal potential.
  Spatial prediction can be used to identify natural regeneration potential for forest restoration as described in Axer et al (2021) &lt;<a href="https://doi.org/10.1016%2Fj.foreco.2020.118802">doi:10.1016/j.foreco.2020.118802</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/MaximilianAxer/quaxnat">https://github.com/MaximilianAxer/quaxnat</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/MaximilianAxer/quaxnat/issues">https://github.com/MaximilianAxer/quaxnat/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, terra</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-28 15:52:57 UTC; maxer</td>
</tr>
<tr>
<td>Author:</td>
<td>Maximilian Axer <a href="https://orcid.org/0000-0003-1482-9613"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Robert Schlicht [aut],
  Robert Nuske <a href="https://orcid.org/0000-0001-9773-2061"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Nordwestdeutsche Forstliche Versuchsanstalt (NW-FVA) [fnd],
  Staatsbetrieb Sachsenforst [fnd],
  Technische Universität Dresden [fnd, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maximilian Axer &lt;maximilian.axer@nw-fva.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-28 16:50:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='extract_dist'>Extracting distances to nearest seed source for point data</h2><span id='topic+extract_dist'></span>

<h3>Description</h3>

<p>Extracts a distance for the inventory plots. The distance to the
nearest seed source is used for the analysis of the regeneration potential.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_dist(raster, geom, species)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_dist_+3A_raster">raster</code></td>
<td>
<p>Raster dataset with tree species classification of specific
tree species and tree species groups.</p>
</td></tr>
<tr><td><code id="extract_dist_+3A_geom">geom</code></td>
<td>
<p>Geodata representing the study area. This can be a polygon
or point dataset. This describes the outer boundary of the study area.
A buffer of 1000 m is placed around the Bounding box to possibly take into
account seed trees outside the study area.</p>
</td></tr>
<tr><td><code id="extract_dist_+3A_species">species</code></td>
<td>
<p>Represents the numerical value by which the tree species
of interest was encoded in the raster dataset.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector with distances of every inventory plot to the
nearest seed source of a specific tree species.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create raster data set
set.seed(2023)
rr &lt;- terra::rast(
matrix(sample(0:10, 20 * 20, replace = TRUE),
        nrow = 20, ncol = 20))

## Create vector data set
vec &lt;- terra::vect(rbind(c(5,10), c(5,15)))

## Extract distance for the inventory plot
extract_dist(raster=rr, geom=vec, species="10")
</code></pre>

<hr>
<h2 id='k_exponential_power'>Dispersal kernels from exponential power family</h2><span id='topic+k_exponential_power'></span>

<h3>Description</h3>

<p><code>k_exponential_power</code> computes the value, multiplied by <code class="reqn">N</code>, of a
dispersal kernel from the exponential power family that includes, as
special cases, Gaussian kernels and kernels that follow an exponential
function of the distance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>k_exponential_power(x, par, N = 1, d = NCOL(x))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="k_exponential_power_+3A_x">x</code></td>
<td>
<p>Numeric matrix of positions <code class="reqn">x</code> relative to the seed source,
or vector of distances <code class="reqn">\left\|{x}\right\|</code> to the seed source.</p>
</td></tr>
<tr><td><code id="k_exponential_power_+3A_par">par</code></td>
<td>
<p>Numeric vector with two elements representing the
log-transformed scale and shape parameters <code class="reqn">a</code> and <code class="reqn">b</code>.</p>
</td></tr>
<tr><td><code id="k_exponential_power_+3A_n">N</code></td>
<td>
<p>The multiplier <code class="reqn">N</code>.</p>
</td></tr>
<tr><td><code id="k_exponential_power_+3A_d">d</code></td>
<td>
<p>The spatial dimension.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The dispersal kernel, i.e. spatial probability density
of the location of a seed relative to its source, is here given by
</p>
<p style="text-align: center;"><code class="reqn">k(x)={b\Gamma (d/2) \over 2\pi ^{d/2}a^{d}\Gamma (d/b)}
   e^{-(\left\|{x}\right\|/a)^{b}},</code>
</p>

<p>which corresponds to a probability density of the distance given by
</p>
<p style="text-align: center;"><code class="reqn">p(r)={b \over a^{d}\Gamma (d/b)}r^{d-1}e^{-(r/a)^{b}},</code>
</p>

<p>where <code class="reqn">d</code> is the spatial dimension, <code class="reqn">\left\|{\,}\right\|</code>
denotes the Euclidean norm and the normalizing constants involve the
<a href="base.html#topic+gamma">gamma</a> function; see Bateman (1947), Clark et al.
(1998), Austerlitz et al. (2004), Nathan et al. (2012) for the planar
case. This means the <code class="reqn">b</code>th power of the distance has a
<a href="stats.html#topic+GammaDist">gamma distribution</a> with shape parameter
<code class="reqn">d/b</code> and scale parameter <code class="reqn">a^{b}</code>.
</p>
<p>The kernel has its maximum at zero and represents a rather flexible family
that includes, for <code class="reqn">b=2</code> the classical Gaussian kernels and for
<code class="reqn">b=1</code>, kernels decreasing exponentially with the distance. For
<code class="reqn">b&lt;1</code> the distance distribution is fat-tailed in the sense of Kot et
al. (1996). Such kernels have consequently been applied in a number of
theoretical studies that address dispersal (Ribbens et al. 1994, Bullock
et al. 2017).
</p>


<h3>Value</h3>

<p>Numeric vector of function values <code class="reqn">k(x)</code> multiplied by <code class="reqn">N</code>.
</p>


<h3>References</h3>

<p>Bateman, A. (1947). Contamination in seed crops: III. relation with
isolation distance. <em>Heredity</em> <strong>1</strong>, 303–336.
<a href="https://doi.org/10.1038/hdy.1947.20">doi:10.1038/hdy.1947.20</a>
</p>
<p>Kot, M., Lewis, M.A., van den Driessche, P. (1996). Dispersal Data and the
Spread of Invading Organisms. <em>Ecology</em> <strong>77(7)</strong>, 2027–2042.
<a href="https://doi.org/10.2307/2265698">doi:10.2307/2265698</a>
</p>
<p>Ribbens, E., Silander Jr, J.A., Pacala, S.W. (1994). Seedling recruitment
in forests: calibrating models to predict patterns of tree seedling
dispersion. <em>Ecology</em> <strong>75</strong>, 1794–1806.
<a href="https://doi.org/10.2307/1939638">doi:10.2307/1939638</a>
</p>
<p>Clark, J.S., Macklin, E., Wood, L. (1998). Stages and spatial scales of
recruitment limitation in southern Appalachian forests. <em>Ecological
Monographs</em> <strong>68</strong>(2), 213–235.
<a href="https://doi.org/10.2307/2657201">doi:10.2307/2657201</a>
</p>
<p>Clark, J.S. (1998). Why trees migrate so fast: confronting theory with
dispersal biology and the paleorecord. <em>The American Naturalist</em>
<strong>152</strong>(2), 204–224.
<a href="https://doi.org/10.1086/286162">doi:10.1086/286162</a>
</p>
<p>Austerlitz, F., Dick, C.W., Dutech, C., Klein, E.K., Oddou-Muratorio, S.,
Smouse, P.E., Sork, V.L. (2004). Using genetic markers to estimate the
pollen dispersal curve. <em>Molecular Ecology</em> <strong>13</strong>, 937–954.
<a href="https://doi.org/10.1111/j.1365-294X.2004.02100.x">doi:10.1111/j.1365-294X.2004.02100.x</a>
</p>
<p>Bullock, J. M., Mallada González, L., Tamme, R., Götzenberger, L., White,
S.M., Pärtel, M., Hooftman, D.A. (2017).  A synthesis of empirical plant
dispersal kernels. <em>Journal of Ecology</em> <strong>105</strong>, 6–19.
<a href="https://doi.org/10.1111/1365-2745.12666">doi:10.1111/1365-2745.12666</a>
</p>
<p>Nathan, R., Klein, E., Robledo‐Arnuncio, J.J., Revilla, E. (2012).
Dispersal kernels: review, in Clobert, J., Baguette, M., Benton, T.G.,
Bullock, J.M. (eds.), <em>Dispersal ecology and evolution</em>, 186–210.
<a href="https://doi.org/10.1093/acprof%3Aoso/9780199608898.003.0015">doi:10.1093/acprof:oso/9780199608898.003.0015</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>k_exponential_power(2:5, par=c(0,0), d=2)
</code></pre>

<hr>
<h2 id='k_lognormal'>Dispersal kernels for log-normal distance distributions</h2><span id='topic+k_lognormal'></span>

<h3>Description</h3>

<p><code>k_lognormal</code> computes the value, multiplied by <code class="reqn">N</code>, of a dispersal
kernel based on seeds having a distance with a log-normal distribution
from the their source.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>k_lognormal(x, par, N = 1, d = NCOL(x))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="k_lognormal_+3A_x">x</code></td>
<td>
<p>Numeric matrix of positions <code class="reqn">x</code> relative to the seed source,
or vector of distances <code class="reqn">\left\|{x}\right\|</code> to the seed source.</p>
</td></tr>
<tr><td><code id="k_lognormal_+3A_par">par</code></td>
<td>
<p>Numeric vector with two elements representing log-transformed
scale and shape parameters, given by the median distance <code class="reqn">a</code> and by
the variance <code class="reqn">b</code> of the underlying normal distribution.</p>
</td></tr>
<tr><td><code id="k_lognormal_+3A_n">N</code></td>
<td>
<p>The multiplier <code class="reqn">N</code>.</p>
</td></tr>
<tr><td><code id="k_lognormal_+3A_d">d</code></td>
<td>
<p>The spatial dimension.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The dispersal kernel, i.e. spatial probability density
of the location of a seed relative to its source, is here given by
</p>
<p style="text-align: center;"><code class="reqn">k(x)={\Gamma (d/2) \over
  2\pi ^{d/2}\left\|{x}\right\|^{d}\sqrt{2\pi b}}
  e^{-{1 \over 2b}(\log (\left\|{x}\right\|/a))^{2}}
  ={\Gamma (d/2)e^{d^{2}b/2} \over 2\pi ^{d/2}a^{d}\sqrt{2\pi b}}
  e^{-{1 \over 2b}(\log {\left\|{x}\right\| \over a}+db)^{2}},</code>
</p>

<p>which corresponds to a probability density of the distance given by
</p>
<p style="text-align: center;"><code class="reqn">p(r)={1 \over r\sqrt{2\pi b}}e^{-{1 \over 2b}(\log (r/a))^{2}}
  ={e^{b/2} \over a\sqrt{2\pi b}}
  e^{-{1 \over 2b}(\log {r \over a}+b)^{2}},</code>
</p>

<p>where <code class="reqn">d</code> is the spatial dimension, <code class="reqn">\left\|{\,}\right\|</code>
denotes the Euclidean norm and the normalizing constant of the kernel
involves the <a href="base.html#topic+gamma">gamma</a> function; see Greene and Johnson
(1989), Stoyan and Wagner (2001) for the planar case. Thus, the distance
is assumed to have the <a href="stats.html#topic+Lognormal">log-normal distribution</a>
such that the log-distance has a normal distribution with mean
<code class="reqn">\log a</code> and variance <code class="reqn">b</code>. Here <code class="reqn">\log k(x)</code> is a quadratic
function of <code class="reqn">\log \left\|{x}\right\|</code> with a maximum at
<code class="reqn">\log a-db</code>, while <code class="reqn">\log p(r)</code> is a quadratic function of
<code class="reqn">\log r</code> with a maximum at <code class="reqn">\log a-b</code>.
</p>
<p>This kernel is particularly suitable if the maximum regeneration density
is not directly at the seed source (e.g. Janzen–Connell effect), cf.
Nathan et al. (2012).
</p>


<h3>Value</h3>

<p>Numeric vector of function values <code class="reqn">k(x)</code> multiplied by <code class="reqn">N</code>.
</p>


<h3>References</h3>

<p>Greene, D.F., Johnson, E.A. (1989). A model of wind dispersal of winged or
plumed seeds. <em>Ecology</em> <strong>70</strong>(2), 339–347.
<a href="https://doi.org/10.2307/1937538">doi:10.2307/1937538</a>
</p>
<p>Stoyan, D., Wagner, S. (2001). Estimating the fruit dispersion of
anemochorous forest trees. <em>Ecol. Modell.</em> <strong>145</strong>, 35–47.
<a href="https://doi.org/10.1016/S0304-3800%2801%2900385-4">doi:10.1016/S0304-3800(01)00385-4</a>
</p>
<p>Nathan, R., Klein, E., Robledo‐Arnuncio, J.J., Revilla, E. (2012).
Dispersal kernels: review, in Clobert, J., Baguette, M., Benton, T.G.,
Bullock, J.M. (eds.), <em>Dispersal ecology and evolution</em>, 186–210.
<a href="https://doi.org/10.1093/acprof%3Aoso/9780199608898.003.0015">doi:10.1093/acprof:oso/9780199608898.003.0015</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>k_lognormal(2:5, par=c(0,0), d=2)
</code></pre>

<hr>
<h2 id='k_power'>Power-law dispersal kernels</h2><span id='topic+k_power'></span>

<h3>Description</h3>

<p><code>k_power</code> computes the value, multiplied by <code class="reqn">N</code>, of a dispersal kernel
that follows a power law of a constant <code class="reqn">a</code> plus the distance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>k_power(x, par, N = 1, d = NCOL(x))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="k_power_+3A_x">x</code></td>
<td>
<p>Numeric matrix of positions <code class="reqn">x</code> relative to the seed source,
or vector of distances <code class="reqn">\left\|{x}\right\|</code> to the seed source.</p>
</td></tr>
<tr><td><code id="k_power_+3A_par">par</code></td>
<td>
<p>Numeric vector with two elements representing the
log-transformed parameters <code class="reqn">a</code> and <code class="reqn">b</code>.</p>
</td></tr>
<tr><td><code id="k_power_+3A_n">N</code></td>
<td>
<p>The multiplier <code class="reqn">N</code>.</p>
</td></tr>
<tr><td><code id="k_power_+3A_d">d</code></td>
<td>
<p>The spatial dimension.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The dispersal kernel, i.e. spatial probability density
of the location of a seed relative to its source, is here given by
</p>
<p style="text-align: center;"><code class="reqn">k(x)={\Gamma (d/2) \over 2\pi ^{d/2}a^{d}B(d,b)}
  (1+{\left\|{x}\right\| \over a})^{-(b+d)},</code>
</p>

<p>which corresponds to a probability density of the distance given by
</p>
<p style="text-align: center;"><code class="reqn">p(r)={1 \over a^{d}B(d,b)}r^{d-1}(1+{r \over a})^{-(b+d)},</code>
</p>

<p>where <code class="reqn">d</code> is the spatial dimension, <code class="reqn">\left\|{\,}\right\|</code>
denotes the Euclidean norm and the normalizing constants involve the
<a href="base.html#topic+beta">beta</a> and <a href="base.html#topic+gamma">gamma</a> functions; see Nathan
et al. (2012) for the planar case (with <code class="reqn">b</code> replaced by <code class="reqn">b-d</code>).
This means the distance is <code class="reqn">da \over b</code> times a random variable having
an <a href="stats.html#topic+FDist">F distribution</a> with <code class="reqn">2d</code> and <code class="reqn">2b</code> degrees
of freedom. This is a fat-tailed distribution for all choices of the
parameter <code class="reqn">b</code>.
</p>


<h3>Value</h3>

<p>Numeric vector of function values <code class="reqn">k(x)</code> multiplied by <code class="reqn">N</code>.
</p>


<h3>References</h3>

<p>Nathan, R., Klein, E., Robledo‐Arnuncio, J.J., Revilla, E. (2012).
Dispersal kernels: review, in Clobert, J., Baguette, M., Benton, T.G.,
Bullock, J.M. (eds.), <em>Dispersal ecology and evolution</em>, 186–210.
<a href="https://doi.org/10.1093/acprof%3Aoso/9780199608898.003.0015">doi:10.1093/acprof:oso/9780199608898.003.0015</a>
</p>
<p>Austerlitz, F., Dick, C.W., Dutech, C., Klein, E.K., Oddou-Muratorio, S.,
Smouse, P.E., Sork, V.L. (2004). Using genetic markers to estimate the
pollen dispersal curve. <em>Molecular Ecology</em> <strong>13</strong>, 937–954.
<a href="https://doi.org/10.1111/j.1365-294X.2004.02100.x">doi:10.1111/j.1365-294X.2004.02100.x</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>k_power(2:5, par=c(0,0), d=2)
</code></pre>

<hr>
<h2 id='k_t'>Dispersal kernels from spatial t distribution</h2><span id='topic+k_t'></span>

<h3>Description</h3>

<p><code>k_t</code> computes the value, multiplied by <code class="reqn">N</code>, of the dispersal kernel
from Clark et al. (1999) that represents a multivariate t distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>k_t(x, par, N = 1, d = NCOL(x))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="k_t_+3A_x">x</code></td>
<td>
<p>Numeric matrix of positions <code class="reqn">x</code> relative to the seed source,
or vector of distances <code class="reqn">\left\|{x}\right\|</code> to the seed source.</p>
</td></tr>
<tr><td><code id="k_t_+3A_par">par</code></td>
<td>
<p>Numeric vector with two elements representing the
log-transformed parameters <code class="reqn">a</code> and <code class="reqn">b</code>.</p>
</td></tr>
<tr><td><code id="k_t_+3A_n">N</code></td>
<td>
<p>The multiplier <code class="reqn">N</code>.</p>
</td></tr>
<tr><td><code id="k_t_+3A_d">d</code></td>
<td>
<p>The spatial dimension.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The dispersal kernel, i.e. spatial probability density
of the location of a seed relative to its source, is here given by
</p>
<p style="text-align: center;"><code class="reqn">k(x)={\Gamma ((b+d)/2) \over \pi ^{d/2}a^{d}\Gamma (b/2)}
  (1+{\left\|{x}\right\|^{2} \over a^{2}})^{-(b+d)/2},</code>
</p>

<p>which corresponds to a probability density of the distance given by
</p>
<p style="text-align: center;"><code class="reqn">p(r)={2 \over a^{d}B(d/2,b/2)}r^{d-1}
  (1+{r^{2} \over a^{2}})^{-(b+d)/2},</code>
</p>

<p>where <code class="reqn">d</code> is the spatial dimension, <code class="reqn">\left\|{\,}\right\|</code>
denotes the Euclidean norm and the normalizing constants involve the
<a href="base.html#topic+beta">beta</a> and <a href="base.html#topic+gamma">gamma</a> functions; see Clark
et al. (1999) and Austerlitz et al. (2004) for the planar case (with
<code class="reqn">a,b</code> replaced by <code class="reqn">\sqrt{u},2p</code> and
<code class="reqn">a,2b-d</code>, respectively). This means the position is
<code class="reqn">a \over \sqrt{b}</code> times a random vector having a standard
<code class="reqn">d</code>-variate t distribution with <code class="reqn">b</code> degrees of freedom (a standard
Gaussian vector divided by <code class="reqn">\sqrt{z/b}</code>, where <code class="reqn">z</code> is independent
and chi-squared distributed with <code class="reqn">b</code> degrees of freedom), and the
squared distance is <code class="reqn">da^{2} \over b</code> times a random variable having an
<a href="stats.html#topic+FDist">F distribution</a> with <code class="reqn">d</code> and <code class="reqn">b</code> degrees of
freedom.
</p>
<p>This results from the kernel being defined as a mixture of Gaussian
kernels with an inverse variance having a
<a href="stats.html#topic+GammaDist">gamma distribution</a> with shape parameter
<code class="reqn">b\over 2</code> and inverse scale parameter <code class="reqn">a^{2}\over 2</code>, which for
<code class="reqn">a=1</code> is a <a href="stats.html#topic+Chisquare">chi-squared distribution</a> with
<code class="reqn">b</code> degrees of freedom.
</p>
<p>The dispersal kernel always has its maximum at zero, and the distance has
a fat-tailed distribution for all choices of <code class="reqn">b</code>.
</p>


<h3>Value</h3>

<p>Numeric vector of function values <code class="reqn">k(x)</code> multiplied by <code class="reqn">N</code>.
</p>


<h3>References</h3>

<p>Clark, J.S., Silman, M., Kern, R., Macklin, E., HilleRisLambers, J.
(1999). Seed dispersal near and far: patterns across temperate and
tropical forests. <em>Ecology</em> <strong>80</strong>, 1475–1494.
<a href="https://doi.org/10.1890/0012-9658%281999%29080%5B1475%3ASDNAFP%5D2.0.CO%3B2">doi:10.1890/0012-9658(1999)080[1475:SDNAFP]2.0.CO;2</a>
</p>
<p>Austerlitz, F., Dick, C.W., Dutech, C., Klein, E.K., Oddou-Muratorio, S.,
Smouse, P.E., Sork, V.L. (2004). Using genetic markers to estimate the
pollen dispersal curve. <em>Molecular Ecology</em> <strong>13</strong>, 937–954.
<a href="https://doi.org/10.1111/j.1365-294X.2004.02100.x">doi:10.1111/j.1365-294X.2004.02100.x</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>k_t(2:5, par=c(0,0), d=2)
</code></pre>

<hr>
<h2 id='k_weibull'>Dispersal kernels for Weibull distance distributions</h2><span id='topic+k_weibull'></span>

<h3>Description</h3>

<p><code>k_weibull</code> computes the value, multiplied by <code class="reqn">N</code>, of the dispersal
kernel from Tufto et al. (1997) based on seeds having a distance with a
Weibull distribution from their source.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>k_weibull(x, par, N = 1, d = NCOL(x))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="k_weibull_+3A_x">x</code></td>
<td>
<p>Numeric matrix of positions <code class="reqn">x</code> relative to the seed source,
or vector of distances <code class="reqn">\left\|{x}\right\|</code> to the seed source.</p>
</td></tr>
<tr><td><code id="k_weibull_+3A_par">par</code></td>
<td>
<p>Numeric vector with two elements representing the
log-transformed scale and shape parameters <code class="reqn">a</code> and <code class="reqn">b</code> of the
distance distribution.</p>
</td></tr>
<tr><td><code id="k_weibull_+3A_n">N</code></td>
<td>
<p>The multiplier <code class="reqn">N</code>.</p>
</td></tr>
<tr><td><code id="k_weibull_+3A_d">d</code></td>
<td>
<p>The spatial dimension.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The dispersal kernel, i.e. spatial probability density
of the location of a seed relative to its source, is here given by
</p>
<p style="text-align: center;"><code class="reqn">k(x)={b\Gamma (d/2) \over 2\pi ^{d/2}a^{b}}\left\|{x}\right\|^{b-d}
  e^{-(\left\|{x}\right\|/a)^{b}},</code>
</p>

<p>which corresponds to a probability density of the distance given by
</p>
<p style="text-align: center;"><code class="reqn">p(r)={b \over a^{b}}r^{b-1}e^{-(r/a)^{b}},</code>
</p>

<p>where <code class="reqn">d</code> is the spatial dimension, <code class="reqn">\left\|{\,}\right\|</code>
denotes the Euclidean norm and the normalizing constants involve the
<a href="base.html#topic+gamma">gamma</a> function; see Tufto et al. (1997) for the planar
case. Thus, the distance is assumed to have the
<a href="stats.html#topic+Weibull">Weibull distribution</a> with scale parameter <code class="reqn">a</code>
and shape parameter <code class="reqn">b</code>. Equivalently, the <code class="reqn">b</code>th power of the
distance has an exponential distribution with scale parameter <code class="reqn">a^{b}</code>.
</p>
<p>Consequently, if and only if <code class="reqn">b&lt;1</code>, the distance distribution has
a heavier tail than an exponential distribution, although with tail
probabilities still decreasing faster than any power law; it is a
fat-tailed distribution in the sense of Kot et al. (1996). The kernel
coincides with a Gaussian kernel in the special case <code class="reqn">b=d=2</code>.
</p>


<h3>Value</h3>

<p>Numeric vector of function values <code class="reqn">k(x)</code> multiplied by <code class="reqn">N</code>.
</p>


<h3>References</h3>

<p>Tufto, J., Engen, S., Hindar, K. (1997). Stochastic dispersal processes in
plant populations, <em>Theoretical Population Biology</em> <strong>52</strong>(1), 16–26.
<a href="https://doi.org/10.1006/tpbi.1997.1306">doi:10.1006/tpbi.1997.1306</a>
</p>
<p>Austerlitz, F., Dick, C.W., Dutech, C., Klein, E.K., Oddou-Muratorio, S.,
Smouse, P.E., Sork, V.L. (2004). Using genetic markers to estimate the
pollen dispersal curve. <em>Molecular Ecology</em> <strong>13</strong>, 937–954.
<a href="https://doi.org/10.1111/j.1365-294X.2004.02100.x">doi:10.1111/j.1365-294X.2004.02100.x</a>
</p>
<p>Kot, M., Lewis, M.A., van den Driessche, P. (1996). Dispersal Data and the
Spread of Invading Organisms. <em>Ecology</em> <strong>77(7)</strong>, 2027–2042.
<a href="https://doi.org/10.2307/2265698">doi:10.2307/2265698</a>
</p>
<p>Nathan, R., Klein, E., Robledo‐Arnuncio, J.J., Revilla, E. (2012).
Dispersal kernels: review, in Clobert, J., Baguette, M., Benton, T.G.,
Bullock, J.M. (eds.), <em>Dispersal ecology and evolution</em>, 186–210.
<a href="https://doi.org/10.1093/acprof%3Aoso/9780199608898.003.0015">doi:10.1093/acprof:oso/9780199608898.003.0015</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>k_weibull(2:5, par=c(0,0), d=2)
</code></pre>

<hr>
<h2 id='predict_quax'>Prediction of potential regeneration densities</h2><span id='topic+predict_quax'></span>

<h3>Description</h3>

<p>Prediction of the potential regeneration density as a function
of the distance to the nearest seed tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_quax(distmap, quax)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict_quax_+3A_distmap">distmap</code></td>
<td>
<p>A SpatRaster with distances to the nearest seed tree is used
for the prediction of the potential regeneration densities. Usually a
result of the <code>seed_tree_distmap()</code> function</p>
</td></tr>
<tr><td><code id="predict_quax_+3A_quax">quax</code></td>
<td>
<p>A quax object is used for the prediction. This is a parameterised
dispersal function using quantile regression.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>, defined by the study area. The potential regeneration density is
calculated and given for each raster cell.
</p>


<h3>Value</h3>

<p>A SpatRaster with the same resolution as the input raster containing
the regeneration density on the same scale (e.g. numbers per hectare) as in
the input data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Prepare artificial data:
set.seed(0)
r &lt;- rgamma(200, shape=2, scale=150)
simulated.data &lt;- data.frame(distance = r, density = rpois(length(r),
k_lognormal(r, par=c(6,0), N=1000000, d=2)))

## Run quax function:
f1 &lt;- quax(x = simulated.data$distance, y = simulated.data$density,
          tau = 0.9, fun = k_lognormal)

## Create raster data set
 rr &lt;- terra::rast(
 matrix(sample(0:10, 20 * 20, replace = TRUE),
        nrow = 20, ncol = 20))

## Compute distance for prediction area
distance &lt;- seed_tree_distmap(raster = rr, species = "10")

## Prediction
p &lt;- predict_quax(distmap = distance, quax = f1)
terra::plot(p)
</code></pre>

<hr>
<h2 id='quax'>Estimating potential regeneration densities by quantile regression</h2><span id='topic+quax'></span><span id='topic+quax.default'></span><span id='topic+quax.formula'></span>

<h3>Description</h3>

<p><code>quax</code> estimates parameters of a spatial dispersal kernel that describes
the regeneration potential as the <code class="reqn">\tau </code>th quantile of the
regeneration density. Here <code class="reqn">\tau </code> is between 0 and 1, with typical
values close to 1 representing the situation that the full regeneration
potential is realized only at a small fraction of all sites.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quax(...)

## Default S3 method:
quax(
  ...,
  y,
  tau,
  fun = k_lognormal,
  weights = 1,
  dim = 2,
  par = c(log.a = 8, log.b = 1)
)

## S3 method for class 'formula'
quax(
  formula,
  data,
  tau,
  fun = k_lognormal,
  subset,
  weights,
  na.action,
  offset,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quax_+3A_...">...</code></td>
<td>
<p>Vector of positions <code class="reqn">x_{1},...,x_{n}</code> or distances to the
seed source as required by the specific dispersal kernel. Optionally,
further arguments passed to <code>optim</code>, to the default method or to the kernel.</p>
</td></tr>
<tr><td><code id="quax_+3A_y">y</code></td>
<td>
<p>Vector of observed values <code class="reqn">y_{1},...,y_{n}</code> of the regeneration
density of the inventory plot.</p>
</td></tr>
<tr><td><code id="quax_+3A_tau">tau</code></td>
<td>
<p>Numeric value between 0 and 1. Specifies the quantile <code class="reqn">\tau </code>
used in the regression.</p>
</td></tr>
<tr><td><code id="quax_+3A_fun">fun</code></td>
<td>
<p>Function representing the dispersal kernel <code class="reqn">k_{\theta }</code>,
multiplied by <code class="reqn">N</code>, that is assumed for the regeneration potential.
Values allowed are <code><a href="#topic+k_lognormal">k_lognormal</a></code>, <code><a href="#topic+k_t">k_t</a></code>,
<code><a href="#topic+k_power">k_power</a></code>, <code><a href="#topic+k_weibull">k_weibull</a></code>,
<code><a href="#topic+k_exponential_power">k_exponential_power</a></code> or a custom function with nonnegative
values whose parameters include, in addition to the arguments in <code>...</code> not
consumed by <code>optim</code> or the default method, the scaling factor <code>N</code> and the
spatial dimension <code>d</code> (see Examples). The default, <code>k_lognormal</code>, is to
fit a model with log-normal distance distributions.</p>
</td></tr>
<tr><td><code id="quax_+3A_weights">weights</code></td>
<td>
<p>Numeric vector of optional non-negative weights <code class="reqn">w_i</code> of
the observations in the estimation procedure. Default is 1.</p>
</td></tr>
<tr><td><code id="quax_+3A_dim">dim</code></td>
<td>
<p>The spatial dimension, by default equal to 2.</p>
</td></tr>
<tr><td><code id="quax_+3A_par">par</code></td>
<td>
<p>Numeric vector of initial values for the parameter vector
<code class="reqn">\theta </code>.</p>
</td></tr>
<tr><td><code id="quax_+3A_formula">formula</code></td>
<td>
<p>A formula of the form <code>y ~ x</code>.</p>
</td></tr>
<tr><td><code id="quax_+3A_data">data</code>, <code id="quax_+3A_subset">subset</code>, <code id="quax_+3A_na.action">na.action</code>, <code id="quax_+3A_offset">offset</code></td>
<td>
<p>For the formula interface:
Further arguments passed to <code>model.frame</code> (along with <code>weights</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function estimates the parameters <code class="reqn">N</code> and <code class="reqn">\theta </code>
of the regeneration potential <code class="reqn">Nk_{\theta }</code> by minimizing
</p>
<p style="text-align: center;"><code class="reqn">\displaystyle \sum _{i=1}^{n}w_{i}\rho _{\tau }(y_{i}-Nk_{\theta }
  (x_{i})),</code>
</p>

<p>where <code class="reqn">\rho _{\tau }(u)=\int _{0}^{u}\tau -\mathbf{1}_{s&lt;0}\;ds=\bigl\{
  \begin{smallmatrix}u\tau &amp; \text{if }u\geq 0\\u(\tau -1)&amp;\text{if }u&lt;0
  \end{smallmatrix}</code>
(Koenker and Bassett 1978, Chapter 6.6 in Koenker 2005). The preceding
line, after subtracting the same expression for <code class="reqn">N=0</code> and substituting
<code class="reqn">s=y_{i}-tk_{\theta }(x_{i})</code> in the integral, becomes
<code class="reqn">\int _{0}^{N}\sum _{i=1}^{n}w_{i}k_{\theta }(x_{i})(
  \mathbf{1}_{y_{i}&lt;tk_{\theta }(x_{i})}-\tau )\;dt</code>,
and any <code class="reqn">N</code> such that the last integrand is <code class="reqn">\leq 0</code> for <code class="reqn">t&lt;N</code>
and <code class="reqn">\geq 0</code> for <code class="reqn">t&gt;N</code>, which can always be found as the integrand
is increasing in <code class="reqn">t</code>, minimizes this integral. The integrand being the
difference of the sum of <code class="reqn">w_{i}k_{\theta }(x_{i})</code> over the <code class="reqn">i</code>
with <code class="reqn">y_{i}&lt;tk_{\theta }(x_{i})</code> and <code class="reqn">\tau </code> times the sum over
all <code class="reqn">i</code>, with relevant terms for nonzero <code class="reqn">k_{\theta }(x_{i})</code>,
this means that the estimate of <code class="reqn">N</code> for a given vector <code class="reqn">\theta </code>
can be computed as a <code class="reqn">\tau </code>th quantile. This is implemented as an
inner, nested minimization, the result of which is minimized in
<code class="reqn">\theta </code> using <code><a href="stats.html#topic+optim">optim</a></code>.
</p>
<p>This is a rather naive approach to quantile regression that appears to
work reasonably well for scaled dispersal kernels <code class="reqn">Nk_{\theta }</code> as
considered here, see Appendix A in Axer et al. (2021). For general
quantile regression problems the more sophisticated procedure
<code><a href="quantreg.html#topic+nlrq">nlrq</a></code> in the package <code>quantreg</code>, based on
Koenker and Park (1996), is expected to provide better results.
</p>
<p>In particular, <code>quax</code> is subject to the usual numerical issues inherent in
optimization: It can get stuck in a local minimum or altogether miss a
minimum if the initial values (as specified by the argument <code>par</code>) are too
far off or if the objective function exhibits bad behavior. Problems can
further arise in the dispersal kernels if parameter values passed on a log
scale become too large. It is therefore recommended to visually check the
results (see Examples). Also, the <code>optim</code> arguments <code>method</code> and <code>control</code>
can be added in <code>...</code> to select and tune the optimization algorithm, but
note that the objective function is usually not differentiable.
</p>
<p>See Koenker (2005) for a detailed exposition of quantile regression.
</p>


<h3>Value</h3>

<p>An object of class <code>quax</code> containing the estimated function,
including an attribute <code>o</code> containing the results of <code>optim</code>.
Generic functions with methods defined for <code>quax</code> objects invoke these
methods; see <code><a href="#topic+summary.quax">summary.quax</a></code> for an example.
</p>


<h3>References</h3>

<p>Koenker, R., Bassett, G. (1978). Regression quantiles. <em>Econometrica</em>
<strong>46</strong>(1), 33–50.
<a href="https://doi.org/10.2307/1913643">doi:10.2307/1913643</a>
</p>
<p>Axer, M., Schlicht, R., Wagner, S. (2021). Modelling potential density of
natural regeneration of European oak species (<em>Quercus robur</em> L., <em>Quercus
petraea</em> (Matt.) Liebl.) depending on the distance to the potential seed
source: Methodological approach for modelling dispersal from inventory
data at forest enterprise level. <em>Forest Ecology and Management</em> <strong>482</strong>,
118802.
<a href="https://doi.org/10.1016/j.foreco.2020.118802">doi:10.1016/j.foreco.2020.118802</a>
</p>
<p>Koenker, R., Park, B.J. (1996). An interior point algorithm for nonlinear
quantile regression. <em>Journal of Econometrics</em> <strong>71</strong>(1–2), 265–283.
<a href="https://doi.org/10.1016/0304-4076%2896%2984507-6">doi:10.1016/0304-4076(96)84507-6</a>
</p>
<p>Koenker, R. (2005). Quantile regression. Cambridge University Press.
<a href="https://doi.org/10.1017/CBO9780511754098">doi:10.1017/CBO9780511754098</a>
</p>


<h3>See Also</h3>

<p>Function <code><a href="quantreg.html#topic+nlrq">nlrq</a></code> in the package
<code><a href="quantreg.html#topic+nlrq">quantreg</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Prepare artificial data:
set.seed(0)
r &lt;- rgamma(200, shape=2, scale=150)
simulated.data &lt;- data.frame(distance = r, density =
  rpois(length(r), k_lognormal(r, par=c(6,0), N=1000000, d=2)))
plot(density ~ distance, simulated.data)

## Run quax function:
f1 &lt;- quax(x = simulated.data$distance, y = simulated.data$density,
  tau = 0.9, fun = k_lognormal)
summary(f1)
curve(f1(x), add=TRUE)

## Do the same using formula interface:
f1 &lt;- quax(density ~ distance, simulated.data,
  tau = 0.9, fun = k_lognormal)
summary(f1)
#quantreg::nlrq(density ~ k_lognormal(distance,c(log.a,log.b),N=N,d=2),
#  simulated.data, start = c(log.a=6,log.b=0,N=1e6), tau = 0.9)  # similar

## Use another quantile:
f2 &lt;- quax(density ~ distance, simulated.data,
  tau = 0.99, fun = k_lognormal)
summary(f2)
curve(f2(x), add=TRUE, lwd=0)

## Show effect of weights:
f3 &lt;- quax(density ~ distance, simulated.data,
  tau = 0.9, fun = k_lognormal, weights = distance)
summary(f3)
curve(f3(x), add=TRUE, lty=3)

## Compare various dispersal models:
fun &lt;- c("k_lognormal","k_t","k_weibull","k_power","k_exponential_power")
for (i in seq_along(fun))
  curve(quax(density ~ distance, simulated.data,
    tau = 0.9, fun = get(fun[i]), weights = distance)(x),
    add=TRUE, col=i, lty=3)
legend("topright", fun, col=seq_along(fun), lty=3)

## Use positions in computation:
simulated.data$position &lt;- r *
  (\(a) cbind(cos(a),sin(a))) (rnorm(length(r)))
f3 &lt;- quax(density ~ position, simulated.data,
  tau = 0.9, fun = k_lognormal, weights = distance)
summary(f3)

## Show problems with bad initial values and try another parameterization:
curve(quax(density ~ distance, simulated.data, par = c(log.a=0,log.b=0),
  tau = 0.99, fun = k_lognormal)(x), add=TRUE, lty=2)
curve(quax(density ~ distance, simulated.data, par = c(a=1,b=1),
  tau = 0.99, fun = function(x,par,N,d) if (any(par&lt;=0)) rep(NA,NROW(x))
    else k_lognormal(x,log(par),N,d))(x), add=TRUE, lty=2)

## Use custom variant of lognormal model that includes a shift:
plot(simulated.data$position)
f4 &lt;- quax(density ~ position, simulated.data,
  tau = 0.9, par = c(8, 1, 0, 0),
  fun = function(x, par, N, d)
    k_lognormal(x - rep(par[-(1:2)],each=NROW(x)), par[1:2], N, d)
)
summary(f4)
</code></pre>

<hr>
<h2 id='regeneration'>Regeneration densities at inventory plots and potential dispersal distances
to nearest seed trees</h2><span id='topic+regeneration'></span>

<h3>Description</h3>

<p>A dataset containing the regeneration densities of beech, oak and Douglas fir
of the inventory plots and the distance to the nearest conspecific nearest
seed tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(regeneration)
</code></pre>


<h3>Format</h3>

<p>A data frame with 484 rows and 7 variables
</p>

<ul>
<li><p> id. An identifier for each inventory plot as an integer
</p>
</li>
<li><p> distance_beech. Distance in m from the plot to the nearest beech (0&ndash;3206.57)
</p>
</li>
<li><p> distance_oak. Distance in m from the plot to the nearest oak (0&ndash;1481.2)
</p>
</li>
<li><p> distance_dgl. Distance in m from the plot to the nearest Douglas fir (0&ndash;1807)
</p>
</li>
<li><p> oak_regen. Regeneration density of oak (N/ha) of the plot (0&ndash;30)
</p>
</li>
<li><p> beech_regen. Regeneration density of beech (N/ha) of the plot (0&ndash;30)
</p>
</li>
<li><p> douglas_regen. Regeneration density of Douglas fir (N/ha) of the plot (0&ndash;30)
</p>
</li></ul>


<hr>
<h2 id='seed_tree_distmap'>Distance map to nearest seed source</h2><span id='topic+seed_tree_distmap'></span>

<h3>Description</h3>

<p>Creation of a distance map for the study area. The distance to
the nearest seed source is calculated for every raster cell.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seed_tree_distmap(raster, species)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="seed_tree_distmap_+3A_raster">raster</code></td>
<td>
<p>Raster data set with tree species classification of specific
tree species and tree species groups.</p>
</td></tr>
<tr><td><code id="seed_tree_distmap_+3A_species">species</code></td>
<td>
<p>Represents the numerical value by which the tree species of
interest is encoded in the raster data set.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A SpatRaster object containing the distances to seed source.
The object has the same resolution and extent as the input raster.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create raster data set
 rr &lt;- terra::rast(
 matrix(sample(0:10, 20 * 20, replace = TRUE),
        nrow = 20, ncol = 20))

## Compute distance for study area
distance &lt;- seed_tree_distmap(raster = rr, species = "10")

## Plot the seed_tree_distmap
terra::plot(distance)

</code></pre>

<hr>
<h2 id='summary.quax'>Summarizing quantile regression fits of potential regeneration densities</h2><span id='topic+summary.quax'></span>

<h3>Description</h3>

<p>This function is the <code>summary</code> method for class <code>quax</code> objects as returned
by <code><a href="#topic+quax">quax</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'quax'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.quax_+3A_object">object</code></td>
<td>
<p>The function returned by <code><a href="#topic+quax">quax</a></code>.</p>
</td></tr>
<tr><td><code id="summary.quax_+3A_...">...</code></td>
<td>
<p>not in use here</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>value</code> component of the result can be used to compare the
quality of the fit of different dispersal kernels for the same quantile
to the same data.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>

<dl>
<dt><code>coefficients</code></dt><dd><p>The parameters of the estimated dispersal kernel.</p>
</dd>
<dt><code>value</code></dt><dd><p>The attained value of the objective function that is
minimised in the quantile regression.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>## Prepare artificial data:
set.seed(0)
r &lt;- rgamma(200, shape=2, scale=150)
simulated.data &lt;- data.frame(distance = r, density =
  rpois(length(r), k_lognormal(r, par=c(6,0), N=1000000, d=2)))
plot(density ~ distance, simulated.data)

## Fit a log-normal and a power-law dispersal kernel to the data:
f1 &lt;- quax(density ~ distance, simulated.data,
  tau = 0.9, fun = k_lognormal)
f2 &lt;- quax(density ~ distance, simulated.data,
  tau = 0.9, fun = k_power)

## Compare both fits:
summary(f1)
summary(f2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
