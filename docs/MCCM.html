<!DOCTYPE html><html><head><title>Help for package MCCM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MCCM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CECERS'><p>Chinese Early Childhood Environment Rating Scale</p></a></li>
<li><a href='#dphixy'><p>Scaled Bivariate Normal Density</p></a></li>
<li><a href='#draw_correlation_matrix'><p>Draw the Correlation Matrix</p></a></li>
<li><a href='#est_mixedGMM'><p>Estimating Mixed Correlation Matrix by IGMM</p></a></li>
<li><a href='#est_thre'><p>Thresholds Estimation</p></a></li>
<li><a href='#esti_polychoric'><p>Polychoric Correlation</p></a></li>
<li><a href='#esti_polyserial'><p>Polyserial Correlation</p></a></li>
<li><a href='#gen_CCM'><p>Positive Semidefinite Correlation Matrix</p></a></li>
<li><a href='#gen_mixed'><p>Continuous and Ordinal Simulated Data</p></a></li>
<li><a href='#gen_polychoric'><p>Generate Polychoric Sample</p></a></li>
<li><a href='#gen_polyseries'><p>Generate Polyseries Sample</p></a></li>
<li><a href='#gen_rho'><p>Generate Specific Binormal Distribution</p></a></li>
<li><a href='#mb'><p>Mean Bias</p></a></li>
<li><a href='#MCCM_est'><p>General Function to Estimate Mixed Correlation Coefficient Matrix</p></a></li>
<li><a href='#mrb'><p>Mean Relative Bias</p></a></li>
<li><a href='#Parenteral_nutrition'><p>Parenteral_nutrition</p></a></li>
<li><a href='#Phixy'><p>Scaled Bivariate Normal Approximation</p></a></li>
<li><a href='#rmse'><p>Root Mean Squared Error</p></a></li>
<li><a href='#summary_MCCM_est'><p>Summary a MCCM Estimation Result</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Mixed Correlation Coefficient Matrix</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>The IRLS (Iteratively Reweighted Least Squares) and GMM (Generalized Method of Moments) methods are applied to estimate mixed correlation coefficient matrix (Pearson, Polyseries, Polychoric), which can be estimated in pairs or simultaneously. For more information see Peng Zhang and Ben Liu (2024) &lt;<a href="https://doi.org/10.1080%2F10618600.2023.2257251">doi:10.1080/10618600.2023.2257251</a>&gt;; Ben Liu and Peng Zhang (2024) &lt;<a href="https://doi.org/10.48550%2FarXiv.2404.06781">doi:10.48550/arXiv.2404.06781</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0),</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, polycor, lavaan, mvtnorm</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-17 07:07:41 UTC; Administrator</td>
</tr>
<tr>
<td>Author:</td>
<td>Ben Liu [aut, cre],
  Peng Zhang [ths],
  Xiaowei Lou [aut, dtc]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ben Liu &lt;12035024@zju.edu.cn&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-18 14:02:52 UTC</td>
</tr>
</table>
<hr>
<h2 id='CECERS'>Chinese Early Childhood Environment Rating Scale</h2><span id='topic+CECERS'></span>

<h3>Description</h3>

<p>The CECERS uses a 9-point scoring
system, 1-3 (inadequate), 5 (least acceptable), 7 (good), and 9 (excellent), to measure the quality
of Chinese early children education (ECE) programs for children aged 3 to 6.
The CECERS has a total of 51 items organized in eight categories: (1) Space and Furnishings (9 items); (2) Personal
Care Routines (6 items); (3) Curriculum Planning and Implementation (5 items); (4) Whole-Group
Instruction (7 items); (5) Activities (9 items); (6) Language-Reasoning (4 items); (7) Guidance and
Interaction (5 items); (8) Parents and Staff (6 items).
</p>


<h3>Format</h3>

<p>A data frame with 1383 rows and 95 variables:
</p>


<h3>Source</h3>

<p>Kejian Li, Peng Zhang, Bi Ying Hu, Margaret R Burchinal, Xitao Fan, and Jinliang Qin. Testing
the ‘thresholds’ of preschool education quality on child outcomes in china. Early Childhood
Research Quarterly, 47:445–456, 2019.
</p>

<hr>
<h2 id='dphixy'>Scaled Bivariate Normal Density</h2><span id='topic+dphixy'></span>

<h3>Description</h3>

<p>Bivariate normal density with mean 0 variance 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dphixy(x, y, rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dphixy_+3A_x">x</code>, <code id="dphixy_+3A_y">y</code></td>
<td>
<p>points value.</p>
</td></tr>
<tr><td><code id="dphixy_+3A_rho">rho</code></td>
<td>
<p>correlation coefficient.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the density value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(mvtnorm)
dmvnorm(c(1,-1),sigma = matrix(c(1,0.5,0.5,1),2,2))
dphixy(1,-1,0.5)
</code></pre>

<hr>
<h2 id='draw_correlation_matrix'>Draw the Correlation Matrix</h2><span id='topic+draw_correlation_matrix'></span>

<h3>Description</h3>

<p>Estimate the MCCM from dataframe and draw it with scatter plot of matrices (SPLOM). With bivariate scatter plots below the diagonal, histograms on the diagonal, and the polychoric correlation coefficients with standard errors above the diagonal. Correlation ellipses are drawn in the same graph. The red lines below the diagonal are the LOESS smoothed lines, fitting a smooth curve between two variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw_correlation_matrix(
  data1,
  order_indx,
  pair_est = FALSE,
  MLE = FALSE,
  R0 = NULL,
  app = TRUE,
  korder = 2,
  max_iter = 1000,
  max_tol = 1e-08,
  show_log = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="draw_correlation_matrix_+3A_data1">data1</code></td>
<td>
<p>a dataframe containing continuous or ordinal variable.</p>
</td></tr>
<tr><td><code id="draw_correlation_matrix_+3A_order_indx">order_indx</code></td>
<td>
<p>a vector to indicate the ordinal variables.</p>
</td></tr>
<tr><td><code id="draw_correlation_matrix_+3A_pair_est">pair_est</code></td>
<td>
<p>bool value, TRUE for pairwise estimation, FALSE for simultaneous estimation.</p>
</td></tr>
<tr><td><code id="draw_correlation_matrix_+3A_mle">MLE</code></td>
<td>
<p>bool value, TRUE for maximum likelihood estimation, FALSE for IRLS (pairwise) or IGMM (simultaneous) estimation.</p>
</td></tr>
<tr><td><code id="draw_correlation_matrix_+3A_r0">R0</code></td>
<td>
<p>the initial value for correlation vector, default Pearson correlation matrix.</p>
</td></tr>
<tr><td><code id="draw_correlation_matrix_+3A_app">app</code></td>
<td>
<p>bool value for approximation, TRUE for Legendre approximation, FALSE for common integral.</p>
</td></tr>
<tr><td><code id="draw_correlation_matrix_+3A_korder">korder</code></td>
<td>
<p>the order of Legendre approximation.</p>
</td></tr>
<tr><td><code id="draw_correlation_matrix_+3A_max_iter">max_iter</code></td>
<td>
<p>max iteration number for IGMM.</p>
</td></tr>
<tr><td><code id="draw_correlation_matrix_+3A_max_tol">max_tol</code></td>
<td>
<p>max tolerance for iteration algorithm.</p>
</td></tr>
<tr><td><code id="draw_correlation_matrix_+3A_show_log">show_log</code></td>
<td>
<p>bool value, TRUE for showing calculation log.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the SPLOM plot.
</p>


<h3>See Also</h3>

<p><a href="#topic+MCCM_est">MCCM_est</a>,
<a href="#topic+summary_MCCM_est">summary_MCCM_est</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(mvtnorm)
library(MASS)
library(polycor)
library(lavaan)
set.seed(1997)
n = 10000
rho12=0.3
rho13=0.4
rho14=0.5
rho23=0.6
rho24=0.7
rho34=0.8

R = matrix(c(1,rho12,rho13,rho14,rho12,1,rho23,rho24,rho13,rho23,1,rho34,
rho14,rho24,rho34,1),4,4)
indc = c(3,4)
thresholds = list(c(),c(),0,0)
data1 = gen_mixed(n=n,R=R,indc=indc,thresholds=thresholds)
data2 = data.frame(data1$observed)

# pairwise MLE estimation
draw_correlation_matrix(data2,indc,TRUE,TRUE)
# pairwise IRLS estimation
draw_correlation_matrix(data2,indc,TRUE,FALSE)
# simultaneous MLE estimation
draw_correlation_matrix(data2,indc,FALSE,TRUE)
# simultaneous IGMM estimation
draw_correlation_matrix(data2,indc,FALSE,FALSE)
</code></pre>

<hr>
<h2 id='est_mixedGMM'>Estimating Mixed Correlation Matrix by IGMM</h2><span id='topic+est_mixedGMM'></span>

<h3>Description</h3>

<p>An accelerated function to estimate a mixed correlation coefficient matrix, as well as its covariance matrix, for dataframes containing continuous and ordinal variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_mixedGMM(
  dataYX,
  order_indx,
  R0 = NULL,
  app = TRUE,
  korder = 2,
  max_iter = 1000,
  max_tol = 1e-08,
  show_log = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_mixedGMM_+3A_datayx">dataYX</code></td>
<td>
<p>a dataframe or matrix containing both continuous and ordinal variables.</p>
</td></tr>
<tr><td><code id="est_mixedGMM_+3A_order_indx">order_indx</code></td>
<td>
<p>a vector to indicate the ordinal variables.</p>
</td></tr>
<tr><td><code id="est_mixedGMM_+3A_r0">R0</code></td>
<td>
<p>the initial value for correlation vector, default Pearson correlation matrix.</p>
</td></tr>
<tr><td><code id="est_mixedGMM_+3A_app">app</code></td>
<td>
<p>bool value for approximation, TRUE for Legendre approximation, FALSE for common integral.</p>
</td></tr>
<tr><td><code id="est_mixedGMM_+3A_korder">korder</code></td>
<td>
<p>the order of Legendre approximation.</p>
</td></tr>
<tr><td><code id="est_mixedGMM_+3A_max_iter">max_iter</code></td>
<td>
<p>max iteration number for IGMM.</p>
</td></tr>
<tr><td><code id="est_mixedGMM_+3A_max_tol">max_tol</code></td>
<td>
<p>max tolerance for iteration algorithm.</p>
</td></tr>
<tr><td><code id="est_mixedGMM_+3A_show_log">show_log</code></td>
<td>
<p>bool value, TRUE for showing calculation log.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Rhat</code></td>
<td>
<p>The estimated correlation coefficients.</p>
</td></tr>
<tr><td><code>COV</code></td>
<td>
<p>The estimated covariance matrix for Rhat</p>
</td></tr>
</table>


<h3>References</h3>

<p>arXiv:2404.06781
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(mvtnorm)
library(MASS)
set.seed(1997)
n = 500
rho12=0.3
rho13=0.4
rho14=0.5
rho23=0.6
rho24=0.7
rho34=0.8

R = matrix(c(1,rho12,rho13,rho14,rho12,1,rho23,rho24,rho13,rho23,1,rho34,
rho14,rho24,rho34,1),4,4)
indc = c(3,4)
thresholds = list(c(),c(),0,0)
data1 = gen_mixed(n=n,R=R,indc=indc,thresholds=thresholds)
data2 = data.frame(data1$observed)
out1 = est_mixedGMM(dataYX = data2,order_indx = indc)
print(out1$Rhat)
print(out1$COV)
</code></pre>

<hr>
<h2 id='est_thre'>Thresholds Estimation</h2><span id='topic+est_thre'></span>

<h3>Description</h3>

<p>Function to calculate thresholds from ordinal variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_thre(X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_thre_+3A_x">X</code></td>
<td>
<p>a ordinal series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the estimated value for thresholds.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(mvtnorm)
set.seed(1997)
R1 = gen_CCM(4)
n = 1000
indc = 3:4
thresholds = list(c(),c(),c(-1),c(1))
data1 = gen_mixed(n,R1,indc,thresholds=thresholds)$observed
est_thre(data1[,3])
est_thre(data1[,4])
</code></pre>

<hr>
<h2 id='esti_polychoric'>Polychoric Correlation</h2><span id='topic+esti_polychoric'></span>

<h3>Description</h3>

<p>Estimate the polychoric correlation coefficient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>esti_polychoric(X, maxn = 100, e = 1e-08, ct = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="esti_polychoric_+3A_x">X</code></td>
<td>
<p>a matrix(2*N) or dataframe contains two polychoric variable, or a contingency table with both columns and rows names.</p>
</td></tr>
<tr><td><code id="esti_polychoric_+3A_maxn">maxn</code></td>
<td>
<p>the maximum iterations times.</p>
</td></tr>
<tr><td><code id="esti_polychoric_+3A_e">e</code></td>
<td>
<p>the maximum tolerance of convergence.</p>
</td></tr>
<tr><td><code id="esti_polychoric_+3A_ct">ct</code></td>
<td>
<p><code>TRUE</code> for contingency table, <code>FALSE</code> for matrix or dataframe</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>rho</code></td>
<td>
<p>estimated value of polychoric correlation coefficient.</p>
</td></tr>
<tr><td><code>std</code></td>
<td>
<p>standard deviation of rho.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>times of iteration convergence.</p>
</td></tr>
<tr><td><code>Ex</code>, <code>Ey</code></td>
<td>
<p>the support points series of regression model</p>
</td></tr>
</table>


<h3>References</h3>

<p>Zhang, P., Liu, B., &amp; Pan, J. (2024). Iteratively Reweighted Least Squares Method for Estimating Polyserial and Polychoric Correlation Coefficients. Journal of Computational and Graphical Statistics, 33(1), 316–328. https://doi.org/10.1080/10618600.2023.2257251
</p>


<h3>See Also</h3>

<p><a href="#topic+esti_polyserial">esti_polyserial</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X = gen_polychoric(1000,0.5,0:1,-1:0)
result = esti_polychoric(X)
print(c(result$rho,result$std,result$iter))
</code></pre>

<hr>
<h2 id='esti_polyserial'>Polyserial Correlation</h2><span id='topic+esti_polyserial'></span>

<h3>Description</h3>

<p>Estimate the polyserial correlation coefficient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>esti_polyserial(X, maxn = 100, e = 1e-08)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="esti_polyserial_+3A_x">X</code></td>
<td>
<p>a matrix(2*N) or dataframe contains two polyserial variable(Continuous variable first).</p>
</td></tr>
<tr><td><code id="esti_polyserial_+3A_maxn">maxn</code></td>
<td>
<p>the maximum iterations times.</p>
</td></tr>
<tr><td><code id="esti_polyserial_+3A_e">e</code></td>
<td>
<p>the maximum tolerance of convergence.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>rho</code></td>
<td>
<p>estimated value of polyserial correlation coefficient.</p>
</td></tr>
<tr><td><code>std</code></td>
<td>
<p>standard deviation of rho.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>times of iteration convergence.</p>
</td></tr>
<tr><td><code>Ex</code>, <code>Ey</code></td>
<td>
<p>the support point of regression model.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Zhang, P., Liu, B., &amp; Pan, J. (2024). Iteratively Reweighted Least Squares Method for Estimating Polyserial and Polychoric Correlation Coefficients. Journal of Computational and Graphical Statistics, 33(1), 316–328. https://doi.org/10.1080/10618600.2023.2257251
</p>


<h3>See Also</h3>

<p><a href="#topic+esti_polychoric">esti_polychoric</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X = gen_polyseries(1000,0.5,-1:1)
result = esti_polyserial(X)
result
</code></pre>

<hr>
<h2 id='gen_CCM'>Positive Semidefinite Correlation Matrix</h2><span id='topic+gen_CCM'></span>

<h3>Description</h3>

<p>Generate a positive semidefinite correlation coefficients matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen_CCM(d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen_CCM_+3A_d">d</code></td>
<td>
<p>the dimension of matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a correlation coefficients matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X = gen_CCM(4)
print(X)
</code></pre>

<hr>
<h2 id='gen_mixed'>Continuous and Ordinal Simulated Data</h2><span id='topic+gen_mixed'></span>

<h3>Description</h3>

<p>Generate multi-normal sample and segment it into ordinal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen_mixed(n, R, indc, thresholds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen_mixed_+3A_n">n</code></td>
<td>
<p>the sample size.</p>
</td></tr>
<tr><td><code id="gen_mixed_+3A_r">R</code></td>
<td>
<p>the correlation coefficient matrix.</p>
</td></tr>
<tr><td><code id="gen_mixed_+3A_indc">indc</code></td>
<td>
<p>vector to indicate whether variables are continuous or categorical.</p>
</td></tr>
<tr><td><code id="gen_mixed_+3A_thresholds">thresholds</code></td>
<td>
<p>list contains thresholds for ordinal variables</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>latent</code></td>
<td>
<p>the original normal data.</p>
</td></tr>
<tr><td><code>observed</code></td>
<td>
<p>the observed ordinal data.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(mvtnorm)
set.seed(1997)
R1 = gen_CCM(6)
n = 1000
indc = 4:6
thresholds = list(
  c(),
  c(),
  c(),
  c(0),
  c(-0.5,0),
  c(0,0.5)
)
data1 = gen_mixed(n,R1,indc,thresholds)$observed
data1 = data.frame(data1)
table(data1$X4,data1$X5)
table(data1$X5,data1$X6)
</code></pre>

<hr>
<h2 id='gen_polychoric'>Generate Polychoric Sample</h2><span id='topic+gen_polychoric'></span>

<h3>Description</h3>

<p>Generate polychoric sample with hidden distribution: binormal with correlation coefficient rho.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen_polychoric(n, rho, a, b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen_polychoric_+3A_n">n</code></td>
<td>
<p>sample size.</p>
</td></tr>
<tr><td><code id="gen_polychoric_+3A_rho">rho</code></td>
<td>
<p>correlation coefficient.</p>
</td></tr>
<tr><td><code id="gen_polychoric_+3A_a">a</code></td>
<td>
<p>the cutoff points array.</p>
</td></tr>
<tr><td><code id="gen_polychoric_+3A_b">b</code></td>
<td>
<p>the cutoff points array.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Polychoric sample with size n(in a 2*n matrix).
</p>


<h3>See Also</h3>

<p><a href="#topic+gen_polyseries">gen_polyseries</a>
<a href="#topic+gen_rho">gen_rho</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>gen_polychoric(100,0.5,-1:1,1:2)
</code></pre>

<hr>
<h2 id='gen_polyseries'>Generate Polyseries Sample</h2><span id='topic+gen_polyseries'></span>

<h3>Description</h3>

<p>Generate polyseries sample with hidden distribution: binormal with correlation coefficient rho.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen_polyseries(n, rho, a)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen_polyseries_+3A_n">n</code></td>
<td>
<p>sample size.</p>
</td></tr>
<tr><td><code id="gen_polyseries_+3A_rho">rho</code></td>
<td>
<p>correlation coefficient.</p>
</td></tr>
<tr><td><code id="gen_polyseries_+3A_a">a</code></td>
<td>
<p>the cutoff points array.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Polyseries sample with size n(in a 2*n matrix).
</p>


<h3>See Also</h3>

<p><a href="#topic+gen_rho">gen_rho</a>
<a href="#topic+gen_polychoric">gen_polychoric</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>gen_polyseries(100,0.5,-1:1)
</code></pre>

<hr>
<h2 id='gen_rho'>Generate Specific Binormal Distribution</h2><span id='topic+gen_rho'></span>

<h3>Description</h3>

<p>Generate random number of binormal distribution with 0 mean unit variance and correlation coefficient rho.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen_rho(n, rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen_rho_+3A_n">n</code></td>
<td>
<p>sample size.</p>
</td></tr>
<tr><td><code id="gen_rho_+3A_rho">rho</code></td>
<td>
<p>correlation coefficient.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Binormal random number with length n(in a 2*n matrix).
</p>


<h3>See Also</h3>

<p><a href="#topic+gen_polyseries">gen_polyseries</a>
<a href="#topic+gen_polychoric">gen_polychoric</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>gen_rho(100,0.5)
</code></pre>

<hr>
<h2 id='mb'>Mean Bias</h2><span id='topic+mb'></span>

<h3>Description</h3>

<p>Calculate the MB of an array of estimates relative to the true value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mb(rhohat, rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mb_+3A_rhohat">rhohat</code></td>
<td>
<p>an array of estimators of rho.</p>
</td></tr>
<tr><td><code id="mb_+3A_rho">rho</code></td>
<td>
<p>the true value of rho.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the mean bias of rhohat array.
</p>


<h3>See Also</h3>

<p><a href="#topic+mrb">mrb</a>
<a href="#topic+rmse">rmse</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rho = 0.5
rhohat = 0.5 + rnorm(10)
mb(rhohat,rho)
</code></pre>

<hr>
<h2 id='MCCM_est'>General Function to Estimate Mixed Correlation Coefficient Matrix</h2><span id='topic+MCCM_est'></span>

<h3>Description</h3>

<p>Estimate the correlation matrix for dataframes containing continuous and ordinal variable, in pairs or simultaneously, using MLE, IRLS, or IGMM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCCM_est(
  dataYX,
  order_indx,
  pair_est = FALSE,
  MLE = FALSE,
  R0 = NULL,
  app = TRUE,
  korder = 2,
  max_iter = 1000,
  max_tol = 1e-08,
  show_log = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCCM_est_+3A_datayx">dataYX</code></td>
<td>
<p>a dataframe or matrix containing both continuous and ordinal variables.</p>
</td></tr>
<tr><td><code id="MCCM_est_+3A_order_indx">order_indx</code></td>
<td>
<p>a vector to indicate the ordinal variables.</p>
</td></tr>
<tr><td><code id="MCCM_est_+3A_pair_est">pair_est</code></td>
<td>
<p>bool value, TRUE for pairwise estimation, FALSE for simultaneous estimation.</p>
</td></tr>
<tr><td><code id="MCCM_est_+3A_mle">MLE</code></td>
<td>
<p>bool value, TRUE for maximum likelihood estimation, FALSE for IRLS (pairwise) or IGMM (simultaneous) estimation.</p>
</td></tr>
<tr><td><code id="MCCM_est_+3A_r0">R0</code></td>
<td>
<p>the initial value for correlation vector, default Pearson correlation matrix.</p>
</td></tr>
<tr><td><code id="MCCM_est_+3A_app">app</code></td>
<td>
<p>bool value for approximation, TRUE for Legendre approximation, FALSE for common integral.</p>
</td></tr>
<tr><td><code id="MCCM_est_+3A_korder">korder</code></td>
<td>
<p>the order of Legendre approximation.</p>
</td></tr>
<tr><td><code id="MCCM_est_+3A_max_iter">max_iter</code></td>
<td>
<p>max iteration number for IGMM.</p>
</td></tr>
<tr><td><code id="MCCM_est_+3A_max_tol">max_tol</code></td>
<td>
<p>max tolerance for iteration algorithm.</p>
</td></tr>
<tr><td><code id="MCCM_est_+3A_show_log">show_log</code></td>
<td>
<p>bool value, TRUE for showing calculation log.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Rmatrix</code></td>
<td>
<p>Estimated mixed correlation coefficient matrix.</p>
</td></tr>
<tr><td><code>std_matrix</code></td>
<td>
<p>Estimated standard deviation for each mixed correlation coefficient.</p>
</td></tr>
<tr><td><code>COV</code></td>
<td>
<p>The covariance matrix for MCCM (simultaneous estimation only).</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><a href="#topic+esti_polyserial">esti_polyserial</a>,
<a href="#topic+esti_polychoric">esti_polychoric</a>,
<a href="#topic+est_mixedGMM">est_mixedGMM</a>,
<a href="#topic+summary_MCCM_est">summary_MCCM_est</a>,
<a href="#topic+draw_correlation_matrix">draw_correlation_matrix</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(mvtnorm)
library(MASS)
library(polycor)
library(lavaan)
set.seed(1997)
n = 10000
rho12=0.3
rho13=0.4
rho14=0.5
rho23=0.6
rho24=0.7
rho34=0.8

R = matrix(c(1,rho12,rho13,rho14,rho12,1,rho23,rho24,rho13,rho23,1,rho34,
rho14,rho24,rho34,1),4,4)
indc = c(3,4)
thresholds = list(c(),c(),0,0)
data1 = gen_mixed(n=n,R=R,indc=indc,thresholds=thresholds)
data2 = data.frame(data1$observed)

# pairwise MLE estimation
out_pair_MLE = MCCM_est(dataYX=data2,order_indx=indc,pair_est=TRUE,MLE=TRUE)
# pairwise IRLS estimation
out_pair_IRLS = MCCM_est(dataYX=data2,order_indx=indc,pair_est=TRUE,MLE=FALSE)
# simultaneous MLE estimation
out_sim_MLE = MCCM_est(dataYX=data2,order_indx=indc,pair_est=FALSE,MLE=TRUE)
# simultaneous IGMM estimation
out_sim_IGMM = MCCM_est(dataYX=data2,order_indx=indc,pair_est=FALSE,MLE=FALSE)

summary_MCCM_est(out_pair_MLE)
summary_MCCM_est(out_pair_IRLS)
summary_MCCM_est(out_sim_MLE)
summary_MCCM_est(out_sim_IGMM)
</code></pre>

<hr>
<h2 id='mrb'>Mean Relative Bias</h2><span id='topic+mrb'></span>

<h3>Description</h3>

<p>Calculate the MRB of an array of estimates relative to the true value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mrb(rhohat, rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mrb_+3A_rhohat">rhohat</code></td>
<td>
<p>an array of estimators of rho.</p>
</td></tr>
<tr><td><code id="mrb_+3A_rho">rho</code></td>
<td>
<p>the true value of rho.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the mean relative bias of rhohat array.
</p>


<h3>See Also</h3>

<p><a href="#topic+mb">mb</a>
<a href="#topic+rmse">rmse</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rho = 0.5
rhohat = 0.5 + rnorm(10)
mrb(rhohat,rho)
</code></pre>

<hr>
<h2 id='Parenteral_nutrition'>Parenteral_nutrition</h2><span id='topic+Parenteral_nutrition'></span>

<h3>Description</h3>

<p>The Parenteral Nutrition data were collected from 543 patients
of whom 386 were given parenteral nutrition alone, 145 were given enteral and
parenteral nutrition, and 3 were given enteral nutrition only. There are 23
main discrete variables, such as: clinical stages(1-4), dietary status(1-3),
NRS(0-6), PG-SGA-qualitative(1-3), etc.
</p>


<h3>Format</h3>

<p>A data frame with 1086 rows and 29 variables:
</p>

<hr>
<h2 id='Phixy'>Scaled Bivariate Normal Approximation</h2><span id='topic+Phixy'></span>

<h3>Description</h3>

<p>Standard bivariate normal distribution approximated with Legendre polynomials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Phixy(x, y, rho, korder = 3, app = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Phixy_+3A_x">x</code>, <code id="Phixy_+3A_y">y</code></td>
<td>
<p>P(X&lt;=x,Y&lt;=y).</p>
</td></tr>
<tr><td><code id="Phixy_+3A_rho">rho</code></td>
<td>
<p>correlation coefficient.</p>
</td></tr>
<tr><td><code id="Phixy_+3A_korder">korder</code></td>
<td>
<p>order of Legendre approximation.</p>
</td></tr>
<tr><td><code id="Phixy_+3A_app">app</code></td>
<td>
<p>bool value TRUE for approximation, FALSE for integral.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>P(X&lt;=x,Y&lt;=y).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(mvtnorm)
pmvnorm(upper = c(1,-1),sigma = matrix(c(1,0.5,0.5,1),2,2))
Phixy(1,-1,0.5,2,app=TRUE)
Phixy(1,-1,0.5,app=TRUE)
</code></pre>

<hr>
<h2 id='rmse'>Root Mean Squared Error</h2><span id='topic+rmse'></span>

<h3>Description</h3>

<p>Calculate the RMSE of an array of estimates relative to the true value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmse(rhohat, rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmse_+3A_rhohat">rhohat</code></td>
<td>
<p>an array of estimators of rho.</p>
</td></tr>
<tr><td><code id="rmse_+3A_rho">rho</code></td>
<td>
<p>the true value of rho.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the root mean squared error of rhohat array.
</p>


<h3>See Also</h3>

<p><a href="#topic+mb">mb</a>
<a href="#topic+mrb">mrb</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rho = 0.5
rhohat = 0.5 + rnorm(10)
rmse(rhohat,rho)
</code></pre>

<hr>
<h2 id='summary_MCCM_est'>Summary a MCCM Estimation Result</h2><span id='topic+summary_MCCM_est'></span>

<h3>Description</h3>

<p>Display the estimated correlation matrix and std matrix for a MCCM_est list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary_MCCM_est(out_MCCM)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_MCCM_est_+3A_out_mccm">out_MCCM</code></td>
<td>
<p>output of function MCCM_est.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The summary of estimation.
</p>


<h3>See Also</h3>

<p><a href="#topic+MCCM_est">MCCM_est</a>,
<a href="#topic+draw_correlation_matrix">draw_correlation_matrix</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
