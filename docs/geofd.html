<!DOCTYPE html><html><head><title>Help for package geofd</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {geofd}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fit.tracevariog'>
<p>Variogram Estimation</p></a></li>
<li><a href='#geofd-package'>
<p>Spatial Prediction for Function Value Data</p></a></li>
<li><a href='#l2.norm'>
<p>Calculates L2 norm among functions</p></a></li>
<li><a href='#maritimes.avg'>
<p>Moncton averages</p></a></li>
<li><a href='#maritimes.coords'><p>Coordinates of the sites referred by maritimes.data</p></a></li>
<li><a href='#maritimes.data'><p>Maritime provinces temperatures</p></a></li>
<li><a href='#okfd'>
<p>Function for doing Ordinary Kriging for function-value Data</p></a></li>
<li><a href='#okfd.cv'>
<p>Function for doing Cross-Validation analysis for Ordinary Kriging for function-value data</p></a></li>
<li><a href='#plot.geofd'><p>Plot Trace Variogram and adjusted models</p></a></li>
<li><a href='#trace.variog'>
<p>Empirical Variograms for function-value data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>2.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Ramon Giraldo &lt;rgiraldoh@unal.edu.co&gt;, Pedro Delicado
        &lt;pedro.delicado@upc.edu&gt;, Jorge Mateu &lt;mateu@mat.uji.es&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pedro Delicado &lt;pedro.delicado@upc.edu&gt;</td>
</tr>
<tr>
<td>Title:</td>
<td>Spatial Prediction for Function Value Data</td>
</tr>
<tr>
<td>Description:</td>
<td>Kriging based methods are used for predicting functional data 
             (curves) with spatial dependence.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>fda</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-01-29</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-01-29 14:28:52 UTC; delicado</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-01-29 15:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='fit.tracevariog'>
Variogram Estimation
</h2><span id='topic+fit.tracevariog'></span><span id='topic+geofd.fit.tracevariog'></span>

<h3>Description</h3>

<p>Fits a parametric model to a empirical variogram and estimates covariance parameters. Aditionally all fitted variogram models are plotted for verification purpose.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.tracevariog(emp.trace.vari, models, sigma2.0, phi.0,
                fix.nugget=FALSE, nugget=0,
                fix.kappa=TRUE, kappa=0.5,
                max.dist.variogram=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.tracevariog_+3A_emp.trace.vari">emp.trace.vari</code></td>
<td>

<p>empirical trace-variogram. An object returned from the <code><a href="#topic+trace.variog">trace.variog</a></code> function.
</p>
</td></tr>
<tr><td><code id="fit.tracevariog_+3A_models">models</code></td>
<td>

<p>a character vector of correlation function names used in geoR against which empirical trace variogram will be fitted.
</p>
</td></tr>
<tr><td><code id="fit.tracevariog_+3A_sigma2.0">sigma2.0</code></td>
<td>

<p>initial value for the covariance parameter <code class="reqn">\sigma^2</code> (partial sill). 

</p>
</td></tr>
<tr><td><code id="fit.tracevariog_+3A_phi.0">phi.0</code></td>
<td>

<p>initial value for the covariance parameter <code class="reqn">\phi</code> (range).  

</p>
</td></tr>
<tr><td><code id="fit.tracevariog_+3A_fix.nugget">fix.nugget</code></td>
<td>

<p>logical, indicating whether the <code>nugget</code> parameter should be estimated or not. 

</p>
</td></tr>
<tr><td><code id="fit.tracevariog_+3A_nugget">nugget</code></td>
<td>

<p>value for the nugget parameter. 

</p>
</td></tr>
<tr><td><code id="fit.tracevariog_+3A_fix.kappa">fix.kappa</code></td>
<td>

<p>logical, indicating whether the <code>kappa</code> parameter should be estimated or not. 

</p>
</td></tr>
<tr><td><code id="fit.tracevariog_+3A_kappa">kappa</code></td>
<td>

<p>value of the smoothness parameter. 

</p>
</td></tr>
<tr><td><code id="fit.tracevariog_+3A_max.dist.variogram">max.dist.variogram</code></td>
<td>

<p>a numerical value defining the maximum distance considered when fitting the variogram. 

</p>
</td></tr>
</table>


<h3>Details</h3>


<p><b>Variogram models and parameters</b>
</p>
<p>When the <code>cov.model</code> parameter is <code>NULL</code> a function determines the optimal model between spherical, exponential gaussian and matern using the received parameters. The arguments <code>sigma2.0</code> and <code>phi.0</code> are used as initial values for fitting each variogram model.
</p>
<p>The parameters <code>fix.nugget</code>, <code>nugget</code>, <code>fix.kappa</code>, <code>kappa</code> and <code>max.dist.variogram</code> are the same for each variogram model specified in <code>models</code>.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>trace.vari</code></td>
<td>
<p>choosed theoretical variogram model</p>
</td></tr>
<tr><td><code>trace.vari.array</code></td>
<td>
<p>vector of all fitted theoretical variogram models</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ramon Giraldo <a href="mailto:rgiraldoh@unal.edu.co">rgiraldoh@unal.edu.co</a>, <br />
Pedro Delicado <a href="mailto:pedro.delicado@upc.edu">pedro.delicado@upc.edu</a>, <br />
Jorge Mateu <a href="mailto:mateu@mat.uji.es">mateu@mat.uji.es</a>.
</p>


<h3>References</h3>

<p>Giraldo, R. (2009) <em>Geostatistical Analysis of Functional Data.</em> Ph.D. thesis. Universitat Politecnica de Catalunya.
</p>
<p>Giraldo, R., Delicado, P. and Mateu, J. (2012) <em><span class="pkg">geofd</span>: An R package for function-valued geostatistical prediction</em>. 
Revista Colombiana de Estadistica. 35, 385-407.
</p>

<hr>
<h2 id='geofd-package'>
Spatial Prediction for Function Value Data
</h2><span id='topic+geofd-package'></span><span id='topic+geofd'></span>

<h3>Description</h3>

<p>Kriging based methods are used for predicting functional data (curves) with spatial dependence.
Initially the curves are pre-processed by fitting a Fourier or B-splines basis functions.
Then the spatial dependence among curves is estimated 
by means of the trace-variogram function. 
Finally the parameters for performing prediction by Ordinary Kriging 
at unsampled locations are estimated by solving a linear system based on the estimated trace-variogram. 
</p>


<h3>Details</h3>

<p>Index:
</p>
<pre>
geofd-package           Spatial prediction for function value data
</pre>


<h3>Author(s)</h3>

<p>Ramon Giraldo &lt;rgiraldoh@unal.edu.co&gt;, 
Pedro Delicado &lt;pedro.delicado@upc.edu&gt;, 
Jorge Mateu &lt;mateu@mat.uji.es&gt;
</p>
<p>Maintainer: Pedro Delicado &lt;pedro.delicado@upc.edu&gt;
</p>

<hr>
<h2 id='l2.norm'>
Calculates L2 norm among functions
</h2><span id='topic+l2.norm'></span><span id='topic+geofd.l2.norm'></span>

<h3>Description</h3>

<p>Calculates the integral of the squared differences between functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  l2.norm(s, datafd, M)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="l2.norm_+3A_s">s</code></td>
<td>

<p>number of sites where the original dataset was measured
</p>
</td></tr>
<tr><td><code id="l2.norm_+3A_datafd">datafd</code></td>
<td>

<p>a functional data object representing a smoothed dataset. See DETAILS below.
</p>
</td></tr>
<tr><td><code id="l2.norm_+3A_m">M</code></td>
<td>

<p>symmetric matrix defining the roughness penalty for functions expressed in terms of a B-spline or Fourier basis. See DETAILS below.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>Roughness penalty matrix</b>
</p>
<p>This matrix is the output of one of the following functions: <code>fourierpen</code> y <code>bsplinepen</code>. The used function depends upon the smoothing type which is going to be applied.
</p>
<p>When the roughness penalty matrix is being calculated, the following considerations are taked in count:
</p>

<ul>
<li><p> The differential operator passed as parameter for both <code>fourierpen</code> and <code>bsplinepen</code> is always zero.
</p>
</li>
<li><p> When the selected smooth method is bsplines, the basis object passed to <code>bsplinepen</code> is the output of the function <code>create.bspline.basis</code> using 
<code>argvals</code> as the <code>rangeval</code> parameter, <code>nbasis</code> as the number of basis functions parameter and the default order of b-splines, which is four, a cubic spline, as the <code>norder</code> parameter.
</p>
</li>
<li><p> When the selected smooth method is fourier, the basis object is the output of the function <code>fourierpen</code>. The parameters <code>rangeval</code> and <code>nbasis</code> are the same as for <code>create.bspline.basis</code>, and the <code>period</code> parameter as the number of observations on each curve.
</p>
</li></ul>



<h3>Value</h3>

<p>The calculated matrix of squared differences between each observation for each measured site. This matrix has two properties:
</p>

<ul>
<li>
<p>Is symmetric.
</p>
</li>
<li>
<p>It's diagonal is filled with zeros.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+okfd">okfd</a></code> for doing Ordinary Kriging for function-value data, <code><a href="#topic+trace.variog">trace.variog</a></code> for functional empirical trace variogram calculation, <code><a href="#topic+fit.tracevariog">fit.tracevariog</a></code> for fitting a variogram model in the functional scenario.
</p>

<hr>
<h2 id='maritimes.avg'>
Moncton averages
</h2><span id='topic+maritimes.avg'></span><span id='topic+geofd.maritimes.avg'></span>

<h3>Description</h3>

<p>Moncton averages
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(maritimes.avg)</code></pre>


<h3>Format</h3>

<p>A matrix with 365 averages.
</p>

<hr>
<h2 id='maritimes.coords'>Coordinates of the sites referred by maritimes.data</h2><span id='topic+maritimes.coords'></span><span id='topic+geofd.maritimes.coords'></span>

<h3>Description</h3>

<p>The geographical coordinates in decimal degrees of 35 weather stations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(maritimes.coords)</code></pre>


<h3>Format</h3>

<p>A matrix with the coordinates of 35 weather stations.
</p>


<h3>Source</h3>

<p>The coordinates were obtained from the database of geographic coordinate information <a href="http://www.tageo.com">http://www.tageo.com</a>
</p>

<hr>
<h2 id='maritimes.data'>Maritime provinces temperatures</h2><span id='topic+maritimes.data'></span><span id='topic+geofd.maritimes.data'></span>

<h3>Description</h3>

<p>Temperature measurements recorded at 35 weather stations located in the Maritime Provinces over a region of Canada consisting of three provinces: Nova Scotia (NS), New Brunswick (NB), and Prince Edward Island (PEI).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(maritimes.data)</code></pre>


<h3>Format</h3>

<p>A matrix with 365 observations on 35 sites.
</p>


<h3>Details</h3>

<p>This data set contains information of daily temperatures averaged over the years 1960 to 1994 (February 29th combined with February 28th)
</p>


<h3>Source</h3>

<p>The data for each station were obtained from the Meteorological Service of Canada <a href="http://climate.weather.gc.ca">http://climate.weather.gc.ca</a>
</p>

<hr>
<h2 id='okfd'>
Function for doing Ordinary Kriging for function-value Data
</h2><span id='topic+okfd'></span><span id='topic+geofd.okfd'></span>

<h3>Description</h3>

<p>This function allows to carry out prediction by Ordinary Kriging for function-value data by considering a Fourier or B-splines basis for smoothing the observed data set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>okfd(new.coords, coords, data, smooth.type=NULL, nbasis=max(50,dim(data)[1]),
    argvals=seq(0, 1, len = dim(data)[1]), lambda=0, cov.model=NULL,
    fix.nugget=FALSE, nugget=0, fix.kappa=TRUE,
    kappa=0.5, max.dist.variogram=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="okfd_+3A_new.coords">new.coords</code></td>
<td>

<p>an n x 2 matrix containing the coordinates of the new n sites where functional Kriging has to be done
</p>
</td></tr>
<tr><td><code id="okfd_+3A_coords">coords</code></td>
<td>

<p>an s x 2 matrix containing the coordinates of the n sites where functional data are observed
</p>
</td></tr>
<tr><td><code id="okfd_+3A_data">data</code></td>
<td>

<p>an m x s matrix with values for the observed functions
</p>
</td></tr>
<tr><td><code id="okfd_+3A_smooth.type">smooth.type</code></td>
<td>

<p>a string with the name of smoothing method to be applied to <code>data</code>. Available choices are: &quot;bsplines&quot; and &quot;fourier&quot;. 
</p>
</td></tr>
<tr><td><code id="okfd_+3A_nbasis">nbasis</code></td>
<td>

<p>a numeric value defining the number of basis functions used to smooth the discrete data set recorded at each site
</p>
</td></tr>
<tr><td><code id="okfd_+3A_argvals">argvals</code></td>
<td>

<p>a vector of argument values corresponding to the observations in matrix data
</p>
</td></tr>
<tr><td><code id="okfd_+3A_lambda">lambda</code></td>
<td>

<p>optional. Penalization parameter for smoothing the observed functions.
</p>
</td></tr>
<tr><td><code id="okfd_+3A_cov.model">cov.model</code></td>
<td>

<p>a string with the name of the correlation function. Default is NULL, see <code>DETAILS</code> below. 

</p>
</td></tr>
<tr><td><code id="okfd_+3A_fix.nugget">fix.nugget</code></td>
<td>

<p>logical, indicating whether the <code>nugget</code> parameter should be estimated or not. 

</p>
</td></tr>
<tr><td><code id="okfd_+3A_nugget">nugget</code></td>
<td>

<p>value for the nugget parameter. 

</p>
</td></tr>
<tr><td><code id="okfd_+3A_fix.kappa">fix.kappa</code></td>
<td>

<p>logical, indicating whether the <code>kappa</code> parameter should be estimated or not. 

</p>
</td></tr>
<tr><td><code id="okfd_+3A_kappa">kappa</code></td>
<td>

<p>value of the smoothness parameter. 

</p>
</td></tr>
<tr><td><code id="okfd_+3A_max.dist.variogram">max.dist.variogram</code></td>
<td>

<p>a numerical value defining the maximum distance considered when fitting the variogram. 

</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a common sequence of the proposed process for doing Ordinary Kriging in the functional scenario, covers from the preparation of the original data and variogram estimation, unto data prediction.
</p>
<p><b>Functional data object</b>
</p>
<p>This is an object of the class <code>fd</code> it can be created using some functions like <code>Data2fd</code> or <code>smooth.basis</code>, take in count if a penalization parameter is going to be used.
</p>
<p><b>Penalization parameter</b>
</p>
<p>The penalization parameter <code>lambda</code> is used in both smoothing methods. When the selected smooth method is:
</p>

<ol>
<li>
<p>bsplines, the function which uses it is <code>fdPar</code>
</p>
</li>
<li>
<p>fourier, the function which uses it is <code>Data2fd</code>
</p>
</li></ol>

<p><b>Functional data object</b>
</p>
<p>The function which creates the functional data object is determined based on the selected smooth method:
</p>

<ul>
<li><p> When it is bsplines, the functional data object must be created using two different functions, <code>fdPar</code> and <code>smooth.basis</code> in order to include the penalization parameter lambda.
</p>
</li>
<li><p> When it is fourier, the functional data object is directly returned by <code>Data2fd</code> because it includes the penalization parameter, the basis object, the argument values and the data, all at the same time.
</p>
</li></ul>



<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>coords</code></td>
<td>
<p>a matrix containing the coordinates of the sites where functional data are observed.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>a matrix with values for the observed functions.</p>
</td></tr>
<tr><td><code>argvals</code></td>
<td>
<p>a vector of argument values corresponding to the observations in matrix data</p>
</td></tr>
<tr><td><code>nbasis</code></td>
<td>
<p>a numeric value defining the number of basis functions used to smooth the discrete data set recorded at each site.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>penalization parameter for smoothing the observed functions.</p>
</td></tr>
<tr><td><code>new.coords</code></td>
<td>
<p>matrix containing the coordinates of the new sites where functional Kriging has to be done.</p>
</td></tr>
<tr><td><code>emp.trace.vari</code></td>
<td>
<p>empirical trace-variogram.</p>
</td></tr>
<tr><td><code>trace.vari</code></td>
<td>
<p>choosed theoretical variogram model</p>
</td></tr>
<tr><td><code>new.Eu.d</code></td>
<td>
<p>distance matrix among sampling and new sites.</p>
</td></tr>
<tr><td><code>functional.Kriging.weights</code></td>
<td>
<p>functional Kriging weights.</p>
</td></tr>
<tr><td><code>krig.new.data</code></td>
<td>
<p>predicted values for the new sites.</p>
</td></tr>
<tr><td><code>pred.var</code></td>
<td>
<p>prediction variance.</p>
</td></tr>
<tr><td><code>trace.vari.array</code></td>
<td>
<p>vector of all fitted variogram models.</p>
</td></tr>
<tr><td><code>datafd</code></td>
<td>
<p>a functional data object containing a smooth of the data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ramon Giraldo <a href="mailto:rgiraldoh@unal.edu.co">rgiraldoh@unal.edu.co</a>, <br />
Pedro Delicado <a href="mailto:pedro.delicado@upc.edu">pedro.delicado@upc.edu</a>, <br />
Jorge Mateu <a href="mailto:mateu@mat.uji.es">mateu@mat.uji.es</a>.
</p>


<h3>References</h3>

<p>Giraldo, R. (2009) <em>Geostatistical Analysis of Functional Data.</em> Ph.D. thesis. Universitat Politecnica de Catalunya.
</p>
<p>Giraldo, R., Delicado, P. and Mateu, J. (2012) <em><span class="pkg">geofd</span>: An R package for function-valued geostatistical prediction</em>. 
Revista Colombiana de Estadistica. 35, 385-407.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+l2.norm">l2.norm</a></code> for calculating L2 norm among functions, <code><a href="#topic+trace.variog">trace.variog</a></code> for functional empirical trace variogram calculation, <code><a href="#topic+fit.tracevariog">fit.tracevariog</a></code> for fitting a variogram model in the funcional scenario.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# First example: one site prediction using B-splines for smoothing

data(maritimes.avg)
data(maritimes.coords)
data(maritimes.data)

coord.cero &lt;- matrix(c(-64.06, 45.79),nrow=1,ncol=2)

n&lt;-dim(maritimes.data)[1]

argvals&lt;-seq(1,n, by=1)

# Prediction by okfd

okfd.res&lt;-okfd(new.coords=coord.cero, coords=maritimes.coords,
              data=maritimes.data, nbasis=65, argvals=argvals,
              fix.nugget=TRUE, kappa=0.7)

# Smoothed and predicted curves, and predicted site average values are plotted

plot(okfd.res$datafd, lty=1, col=8,
    main="Smoothed", xlab="Day", ylab="Temperature (Degrees C)")

lines(okfd.res$argvals, okfd.res$krig.new.data,
      col=1, lwd=2, type="l", lty=1,
      main="Predictions", xlab="Day", ylab="Temperature (Degrees C)")

lines(maritimes.avg,  type="p", pch=20,cex=0.5, col=2, lwd=1)

# Second example: multiple sites prediction using Fourier basis functions for smoothing

data(maritimes)

n&lt;-dim(maritimes.data)[1]

argvals&lt;-seq(1,n, by=1)

col1&lt;-sample( (min(maritimes.coords[,1])*100):(max(maritimes.coords[,1])*100),
              10, replace=TRUE)/100

col2&lt;-sample( (min(maritimes.coords[,2])*100):(max(maritimes.coords[,2])*100),
              10, replace=TRUE)/100

new.coords &lt;- cbind(col1,col2)

# Prediction by okfd

okfd.res&lt;-okfd(new.coords=new.coords, coords=maritimes.coords,
              data=maritimes.data, smooth.type="fourier",
              nbasis=65, argvals=argvals)

# The smoothed and predicted curves are plotted

par(mfrow=c(1,2))

plot(okfd.res$datafd, lty=1, col=8,
    main="Smoothed", xlab="Day", ylab="Temperature (Degrees C)")

matplot(okfd.res$argvals, okfd.res$krig.new.data, col=1, lwd=1, type="l", lty=1,
        main="Predictions", xlab="Day", ylab="Temperature (Degrees C)")

</code></pre>

<hr>
<h2 id='okfd.cv'>
Function for doing Cross-Validation analysis for Ordinary Kriging for function-value data
</h2><span id='topic+okfd.cv'></span><span id='topic+geofd.okfd.cv'></span>

<h3>Description</h3>

<p>Unreviewed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>okfd.cv(coords, data, argnames=c("argument", "sites", "values"),
        one.model=TRUE, smooth.type=NULL,
        array.nbasis=max(50,dim(data)[1]),
        argvals=seq(0,1,len=dim(data)[1]), array.lambda=0, cov.model=NULL,
        fix.nugget=FALSE, nugget=0, fix.kappa=TRUE, kappa=0.5,
        max.dist.variogram=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="okfd.cv_+3A_coords">coords</code></td>
<td>

<p>coordinates of the sites where functional data are observed (dim: s by 2)
</p>
</td></tr>
<tr><td><code id="okfd.cv_+3A_data">data</code></td>
<td>

<p>matrix with values for the observed functions (dim: m by s)
</p>
</td></tr>
<tr><td><code id="okfd.cv_+3A_argnames">argnames</code></td>
<td>

<p>a character vector of length three containing: the name of the argument (argvals), a description of the sites (coord), the name of the observed function values.
</p>
</td></tr>
<tr><td><code id="okfd.cv_+3A_one.model">one.model</code></td>
<td>

<p>logical, indicates whether the cross validation is going to be done just one model or one model for each site. Deafult is TRUE. See details below.
</p>
</td></tr>
<tr><td><code id="okfd.cv_+3A_smooth.type">smooth.type</code></td>
<td>

<p>a string with the name of smoothing method to be applied to <code>data</code>. Available choices are: &quot;bsplines&quot; and &quot;fourier&quot;. 
</p>
</td></tr>
<tr><td><code id="okfd.cv_+3A_array.nbasis">array.nbasis</code></td>
<td>

<p>array with values for the number of elements in the cubic B-spline basis.
</p>
</td></tr>
<tr><td><code id="okfd.cv_+3A_argvals">argvals</code></td>
<td>

<p>a set of argument values. (length: m)
</p>
</td></tr>
<tr><td><code id="okfd.cv_+3A_array.lambda">array.lambda</code></td>
<td>

<p>array of penalization parameters for smoothing the observed functions.
</p>
</td></tr>
<tr><td><code id="okfd.cv_+3A_cov.model">cov.model</code></td>
<td>

<p>a string with the name of the correlation function. Default is NULL, see <code>DETAILS</code> below. 

</p>
</td></tr>
<tr><td><code id="okfd.cv_+3A_fix.nugget">fix.nugget</code></td>
<td>

<p>logical, indicating whether the <code>nugget</code> parameter should be estimated or not. 

</p>
</td></tr>
<tr><td><code id="okfd.cv_+3A_nugget">nugget</code></td>
<td>

<p>value for the nugget parameter. 

</p>
</td></tr>
<tr><td><code id="okfd.cv_+3A_fix.kappa">fix.kappa</code></td>
<td>

<p>logical, indicating whether the <code>kappa</code> parameter should be estimated or not. 

</p>
</td></tr>
<tr><td><code id="okfd.cv_+3A_kappa">kappa</code></td>
<td>

<p>value of the smoothness parameter. 

</p>
</td></tr>
<tr><td><code id="okfd.cv_+3A_max.dist.variogram">max.dist.variogram</code></td>
<td>

<p>a numerical value defining the maximum distance considered when fitting the variogram. 

</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>Validation models</b>
</p>
<p>The parameter <code>one.model</code> is used to define the models used in the cross validation:
</p>

<ul>
<li>
<p>If it is <code>TRUE</code>, a model and smoothed data are created before the beginning and used inside the cross validation process.
</p>
</li>
<li>
<p>If it is <code>FALSE</code>, then for each site a model and smoothed data are created and used on each iteration.
</p>
</li></ul>



<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>k.opt</code></td>
<td>
<p>unreviewed</p>
</td></tr>
<tr><td><code>l.opt</code></td>
<td>
<p>unreviewed</p>
</td></tr>
<tr><td><code>krig.cv</code></td>
<td>
<p>unreviewed</p>
</td></tr>
<tr><td><code>mse.cv</code></td>
<td>
<p>unreviewed</p>
</td></tr>
<tr><td><code>mse.cv.opt</code></td>
<td>
<p>unreviewed</p>
</td></tr>
<tr><td><code>fd.models</code></td>
<td>
<p>unreviewed</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ramon Giraldo <a href="mailto:rgiraldoh@unal.edu.co">rgiraldoh@unal.edu.co</a>, <br />
Pedro Delicado <a href="mailto:pedro.delicado@upc.edu">pedro.delicado@upc.edu</a>, <br />
Jorge Mateu <a href="mailto:mateu@mat.uji.es">mateu@mat.uji.es</a>.
</p>


<h3>References</h3>

<p>Giraldo, R. (2009) <em>Geostatistical Analysis of Functional Data.</em> Ph.D. thesis. Universitat Politecnica de Catalunya.
</p>
<p>Giraldo, R., Delicado, P. and Mateu, J. (2012) <em><span class="pkg">geofd</span>: An R package for function-valued geostatistical prediction</em>. 
Revista Colombiana de Estadistica. 35, 385-407.
</p>

<hr>
<h2 id='plot.geofd'>Plot Trace Variogram and adjusted models</h2><span id='topic+plot.geofd'></span>

<h3>Description</h3>

<p>This funcion produces a plot of an object of class geofd which contains...
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'geofd'
plot(x, emp.trace.vari=x$emp.trace.vari,
                    trace.vari.array=x$trace.vari.array,
                    colors=rainbow(length(trace.vari.array)), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.geofd_+3A_x">x</code></td>
<td>
<p>a list containing elements <code>emp.trace.vari</code> and <code>trace.vari.array</code> described below. Typically an object of the class <code>"geofd"</code>. If not provided the arguments <code>emp.trace.vari</code> and <code>trace.vari.array</code> must be provided instead.</p>
</td></tr>
<tr><td><code id="plot.geofd_+3A_emp.trace.vari">emp.trace.vari</code></td>
<td>
<p>empirical trace-variogram.</p>
</td></tr>
<tr><td><code id="plot.geofd_+3A_trace.vari.array">trace.vari.array</code></td>
<td>
<p>vector of variogram models.</p>
</td></tr>
<tr><td><code id="plot.geofd_+3A_colors">colors</code></td>
<td>
<p>a character vector of color names used to plot each variogram model. Dimensions must be the same of <code>trace.vari.array</code>.</p>
</td></tr>
<tr><td><code id="plot.geofd_+3A_...">...</code></td>
<td>
<p>graphical arguments to be passed to <code><a href="graphics.html#topic+plot">plot</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='trace.variog'>
Empirical Variograms for function-value data
</h2><span id='topic+trace.variog'></span><span id='topic+geofd.trace.variog'></span>

<h3>Description</h3>

<p>Computes empirical trace-variograms using the L2 norm matrix for the semivariance values. Output a variogram cloud.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  trace.variog(coords, L2norm, bin=FALSE, max.dist, uvec="default",
              breaks="default", nugget.tolerance)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trace.variog_+3A_coords">coords</code></td>
<td>
<p>an s x 2 matrix containing the coordinates of the n sites where functional data are observed.</p>
</td></tr>
<tr><td><code id="trace.variog_+3A_l2norm">L2norm</code></td>
<td>
<p>L2 norm among functions.</p>
</td></tr>
<tr><td><code id="trace.variog_+3A_bin">bin</code></td>
<td>
<p>logical, indicating whether the output is the binned variogram.</p>
</td></tr>
<tr><td><code id="trace.variog_+3A_max.dist">max.dist</code></td>
<td>
<p>a numerical value defining the maximum distance for the variogram.</p>
</td></tr>
<tr><td><code id="trace.variog_+3A_uvec">uvec</code></td>
<td>
<p>a vector with values defining the centers of the bins or the number of bins.
Only used when 'bin = TRUE'.</p>
</td></tr>
<tr><td><code id="trace.variog_+3A_breaks">breaks</code></td>
<td>
<p>a vector with values defining the variogram binning. 
Only used when 'bin = TRUE'.</p>
</td></tr>
<tr><td><code id="trace.variog_+3A_nugget.tolerance">nugget.tolerance</code></td>
<td>
<p>a numeric value defining the shortest lag distance. Only used when 'bin = TRUE'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>Binned variogram</b>
This is just a visual feature adapted from the cloud variogram and it doesn't have any relation against the fitting of the variogram model or the calculation of the predictions.
</p>



<h3>Value</h3>

<p>An object of the class variogram 
which is a list with the following components:
</p>
<table>
<tr><td><code>u</code></td>
<td>
<p>a vector with distances.</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>a vector with estimated variogram values at distances given in u.</p>
</td></tr>
<tr><td><code>max.dist</code></td>
<td>
<p>maximum distance of the variogram.</p>
</td></tr>
<tr><td><code>output.type</code></td>
<td>
<p>variogram type.</p>
</td></tr>
<tr><td><code>Eu.d</code></td>
<td>
<p>euclidian distance array among sites.</p>
</td></tr>
<tr><td><code>L2norm</code></td>
<td>
<p>echoes the 'L2norm' argument.</p>
</td></tr>
<tr><td><code>bins.lim</code></td>
<td>
<p>limits defining the interval spanned by each bin.
Only returned when 'bin = TRUE'.</p>
</td></tr>
<tr><td><code>nugget.tolerance</code></td>
<td>
<p>echoes the 'nugget.tolerance' argument.</p>
</td></tr>

</table>


<h3>Author(s)</h3>

<p>Ramon Giraldo <a href="mailto:rgiraldoh@unal.edu.co">rgiraldoh@unal.edu.co</a>, <br />
Pedro Delicado <a href="mailto:pedro.delicado@upc.edu">pedro.delicado@upc.edu</a>, <br />
Jorge Mateu <a href="mailto:mateu@mat.uji.es">mateu@mat.uji.es</a>.
</p>


<h3>References</h3>

<p>Giraldo, R. (2009) <em>Geostatistical Analysis of Functional Data.</em> Ph.D. thesis. Universitat Politecnica de Catalunya.
</p>
<p>Giraldo, R., Delicado, P. and Mateu, J. (2012) <em><span class="pkg">geofd</span>: An R package for function-valued geostatistical prediction</em>. 
Revista Colombiana de Estadistica. 35, 385-407.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# First example: creating a binned variogram
# okfd first example

data(maritimes.avg)
data(maritimes.coords)
data(maritimes.data)
coord.cero &lt;- matrix(c(-64.06, 45.79),nrow=1,ncol=2)
n&lt;-dim(maritimes.data)[1]
argvals&lt;-seq(1,n, by=1)
okfd.res&lt;-okfd(new.coords=coord.cero, coords=maritimes.coords,
              data=maritimes.data, nbasis=65, argvals=argvals, fix.nugget=TRUE,
              kappa=0.7)

# Calculating the empiricial trace bin variogram
new.emp.trace.vari &lt;- trace.variog(coords=okfd.res$coords,
                      L2norm=okfd.res$emp.trace.vari$L2norm, bin=TRUE)

# The empirical trace cloud variogram is replaced with the trace bin variogram
okfd.res$emp.trace.vari &lt;- new.emp.trace.vari

# The modified okfd result is plotted
plot(okfd.res)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
