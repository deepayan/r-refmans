<!DOCTYPE html><html lang="en"><head><title>Help for package GDILM.SEIRS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GDILM.SEIRS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Datasets'><p>Hypothetical Datasets</p></a></li>
<li><a href='#GDILM_SEIRS_Par_Est'><p>GDILM SEIRS for Real Data</p></a></li>
<li><a href='#GDILM_SEIRS_Sim_Par_Est'><p>GDILM SEIRS for a Simulation Study</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Spatial Modeling of Infectious Disease with Reinfection</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Geographically Dependent Individual Level Models (GDILMs) within the Susceptible-Exposed-Infectious-Recovered-Susceptible (SEIRS) framework are applied to model infectious disease transmission, incorporating reinfection dynamics. This package employs a likelihood based Monte Carlo Expectation Conditional Maximization (MCECM) algorithm for estimating model parameters. It also provides tools for GDILM fitting, parameter estimation, AIC calculation on real pandemic data, and simulation studies customized to user-defined model settings.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, mvtnorm, ngspatial, stats</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-13 21:51:42 UTC; aminabed</td>
</tr>
<tr>
<td>Author:</td>
<td>Amin Abed <a href="https://orcid.org/0000-0002-7381-4721"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre, cph],
  Mahmoud Torabi [ths],
  Zeinab Mashreghi [ths]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Amin Abed &lt;abeda@myumanitoba.ca&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-13 22:20:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='Datasets'>Hypothetical Datasets</h2><span id='topic+adjacency_matrix'></span><span id='topic+data'></span>

<h3>Description</h3>

<p>The primary function, <code>GDILM_SEIRS_Par_Est</code>, fits the Geographically Dependent Individual Level Model (GDILM) for infectious disease transmission incorporating reinfection dynamics within the SEIRS framework, using real-world data. It can be applied to any dataset with the appropriate structure, requiring two dataframes: <code>data</code> and <code>adjacency_matrix</code>, along with the necessary parameters. For illustration purposes, we provide two hypothetical examples of <code>data</code> and <code>adjacency_matrix</code> to demonstrate the structure of the inputs. These examples will also be used to illustrate how the function works in practice.
</p>


<h3><code>data</code></h3>

<p>A data frame with 100 rows and 12 columns.
</p>
<p>This hypothetical dataset demonstrates the structure required for the dataframe used in this package. The dataset for use with the package should adhere to the same column format and order but can include any number of rows, with each row representing an infected individual. The example dataset includes individual-level characteristics (e.g., age, infection status) and area-level characteristics (e.g., socioeconomic status, STI rate) for 100 individuals, each associated with a postal code. This dataset will be used as input in the example for the <code>GDILM_SEIRS_Par_Est</code> function.
</p>

<dl>
<dt>Ave_Postal_Pop</dt><dd><p>Average population of each postal code</p>
</dd>
<dt>AverageAge</dt><dd><p>Average age of individuals within each postal code (individual-level data)</p>
</dd>
<dt>InfectedTime</dt><dd><p>Time of infection for each individual, represented as a numerical value from 1 to the end of the pandemic period</p>
</dd>
<dt>LAT</dt><dd><p>Latitude of the postal code</p>
</dd>
<dt>LONG</dt><dd><p>Longitude of the postal code</p>
</dd>
<dt>Label_NC_shape</dt><dd><p>The region number that the postal code belongs to, here assuming the study area is divided into five subregions</p>
</dd>
<dt>MaleRate</dt><dd><p>Rate of males in the population of the postal code (individual-level data)</p>
</dd>
<dt>NInfected</dt><dd><p>Number of infected individuals in the postal code</p>
</dd>
<dt>SES</dt><dd><p>Socioeconomic status indicator of the region to which the postal code belongs (area-level data)</p>
</dd>
<dt>STI</dt><dd><p>Sexually transmitted infection rate of the region that the postal code belongs to (area-level data)</p>
</dd>
<dt>SymptomRate</dt><dd><p>Rate of disease symptoms in the postal code (individual-level data), indicating whether individuals are symptomatic or asymptomatic</p>
</dd>
<dt>status</dt><dd><p>1 if the postal code is infected for the first time, and 0 if the postal code is reinfected</p>
</dd>
</dl>



<h3><code>adjacency_matrix</code></h3>

<p>A 5x5 matrix.
</p>
<p>This hypothetical adjacency matrix is provided to illustrate the structure required for use with this package. The matrix used with the package should follow a similar format, maintaining the same layout but allowing for any number of regions. The adjacency matrix  defines the neighborhood relationships between subregions in a hypothetical study area. In this example, it represents a spatial structure with five subregions, where each cell indicates the presence or absence of a connection between the corresponding subregions. The example for the <code>GDILM_SEIRS_Par_Est</code> function will use this matrix as input.
</p>

<dl>
<dt>V1</dt><dd><p>Subregion 1: Represents the first subregion in the region under study</p>
</dd>
<dt>V2</dt><dd><p>Subregion 2: Represents the second subregion in the region under study</p>
</dd>
<dt>V3</dt><dd><p>Subregion 3: Represents the third subregion in the region under study</p>
</dd>
<dt>V4</dt><dd><p>Subregion 4: Represents the fourth subregion in the region under study</p>
</dd>
<dt>V5</dt><dd><p>Subregion 5: Represents the fifth subregion in the region under study</p>
</dd>
<dt>Value</dt><dd><p>Each cell in the matrix (e.g., between subregion 1 and subregion 2) represents the connection (typically 0 or 1) between the two subregions, where 1 indicates they are neighbors and 0 indicates they are not.</p>
</dd>
</dl>


<hr>
<h2 id='GDILM_SEIRS_Par_Est'>GDILM SEIRS for Real Data</h2><span id='topic+GDILM_SEIRS_Par_Est'></span>

<h3>Description</h3>

<p>This function applies the Geographically Dependent Individual Level Model (GDILM) for infectious disease transmission, incorporating reinfection dynamics within the Susceptible-Exposed-Infectious-Recovered-Susceptible (SEIRS) framework, to real data. It employs a likelihood based Monte Carlo Expectation Conditional Maximization (MCECM) algorithm for parameter estimation and AIC calculation. This function requires two dataframes, named <code>data</code> and <code>adjacency_matrix</code>, along with the necessary parameters. Detailed information on the structure of these two datasets is provided in the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GDILM_SEIRS_Par_Est(
  data,
  adjacency_matrix,
  DimCovInf,
  DimCovSus,
  DimCovSusReInf,
  tau0,
  lambda0,
  alphaS0,
  delta0,
  alphaT0,
  InfPrd,
  IncPrd,
  NIterMC,
  NIterMCECM
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GDILM_SEIRS_Par_Est_+3A_data">data</code></td>
<td>
<p>Dataset. The dataset should exactly match the <code>data</code> file in the data folder, including all the columns with the same names.</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Par_Est_+3A_adjacency_matrix">adjacency_matrix</code></td>
<td>
<p>Adjacency matrix representing the regions in the study area (0 if no connection between regions)</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Par_Est_+3A_dimcovinf">DimCovInf</code></td>
<td>
<p>Dimensions of the individual infectivity covariate</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Par_Est_+3A_dimcovsus">DimCovSus</code></td>
<td>
<p>Dimensions of the area-level susceptibility to initial infection covariate</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Par_Est_+3A_dimcovsusreinf">DimCovSusReInf</code></td>
<td>
<p>Dimensions of the area-level susceptibility to reinfection covariate</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Par_Est_+3A_tau0">tau0</code></td>
<td>
<p>Initial value for spatial precision</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Par_Est_+3A_lambda0">lambda0</code></td>
<td>
<p>Initial value for spatial dependence</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Par_Est_+3A_alphas0">alphaS0</code></td>
<td>
<p>Initial value for the susceptibility intercept</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Par_Est_+3A_delta0">delta0</code></td>
<td>
<p>Initial value for the spatial decay parameter</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Par_Est_+3A_alphat0">alphaT0</code></td>
<td>
<p>Initial value for the infectivity intercept</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Par_Est_+3A_infprd">InfPrd</code></td>
<td>
<p>Infectious period that can be obtained either from the literature or by fitting an SEIRS model to the data</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Par_Est_+3A_incprd">IncPrd</code></td>
<td>
<p>Incubation period that can be obtained either from the literature or by fitting an SEIRS model to the data</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Par_Est_+3A_nitermc">NIterMC</code></td>
<td>
<p>Number of MCMC iterations</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Par_Est_+3A_nitermcecm">NIterMCECM</code></td>
<td>
<p>Number of MCECM iterations</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>alphaS</code> Estimate of alpha S
</p>
<p><code>BetaCovInf</code> Estimate of beta vector for the individual level infection covariate
</p>
<p><code>BetaCovSus</code> Estimate of beta vector for the areal susceptibility to first infection covariate
</p>
<p><code>BetaCovSusReInf</code> Estimate of beta vector for the areal susceptibility to reinfection covariate
</p>
<p><code>alphaT</code> Estimate of alpha T
</p>
<p><code>delta</code> Estimate of delta
</p>
<p><code>tau1</code> Estimate of tau
</p>
<p><code>lambda1</code> Estimate of lambda
</p>
<p><code>AIC</code> AIC of the fitted GDILM SEIRS
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(data)
data(adjacency_matrix)
GDILM_SEIRS_Par_Est(data,adjacency_matrix,2,2,2,0.5, 0.5, 1, 2, 1, 1, 1, 20, 2)


</code></pre>

<hr>
<h2 id='GDILM_SEIRS_Sim_Par_Est'>GDILM SEIRS for a Simulation Study</h2><span id='topic+GDILM_SEIRS_Sim_Par_Est'></span>

<h3>Description</h3>

<p>This function conducts a simulation study for the Geographically Dependent Individual Level Model (GDILM) of infectious disease transmission, incorporating reinfection dynamics within the Susceptible-Exposed-Infectious-Recovered-Susceptible (SEIRS) framework, using a user-defined grid size. It applies a likelihood based Monte Carlo Expectation Conditional Maximization (MCECM) algorithm to estimate model parameters and compute the AIC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GDILM_SEIRS_Sim_Par_Est(
  GridDim1,
  GridDim2,
  NPostPerGrid,
  MaxTimePand,
  tau0,
  lambda0,
  alphaS0,
  delta0,
  alphaT0,
  PopMin,
  PopMax,
  InfFraction,
  ReInfFraction,
  InfPrd,
  IncPrd,
  NIterMC,
  NIterMCECM
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GDILM_SEIRS_Sim_Par_Est_+3A_griddim1">GridDim1</code></td>
<td>
<p>First dimension of the grid</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Sim_Par_Est_+3A_griddim2">GridDim2</code></td>
<td>
<p>Second dimension of the grid</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Sim_Par_Est_+3A_npostpergrid">NPostPerGrid</code></td>
<td>
<p>Number of postal codes per grid cell</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Sim_Par_Est_+3A_maxtimepand">MaxTimePand</code></td>
<td>
<p>Last time point of the pandemic</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Sim_Par_Est_+3A_tau0">tau0</code></td>
<td>
<p>Initial value for spatial precision</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Sim_Par_Est_+3A_lambda0">lambda0</code></td>
<td>
<p>Initial value for spatial dependence</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Sim_Par_Est_+3A_alphas0">alphaS0</code></td>
<td>
<p>Initial value for the susceptibility intercept</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Sim_Par_Est_+3A_delta0">delta0</code></td>
<td>
<p>Initial value for the spatial decay parameter</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Sim_Par_Est_+3A_alphat0">alphaT0</code></td>
<td>
<p>Initial value for the infectivity intercept</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Sim_Par_Est_+3A_popmin">PopMin</code></td>
<td>
<p>Minimum population per postal code</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Sim_Par_Est_+3A_popmax">PopMax</code></td>
<td>
<p>Maximum population per postal code</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Sim_Par_Est_+3A_inffraction">InfFraction</code></td>
<td>
<p>Fraction of each grid cell's population to be infected</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Sim_Par_Est_+3A_reinffraction">ReInfFraction</code></td>
<td>
<p>Fraction of each grid cell's population to be reinfected</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Sim_Par_Est_+3A_infprd">InfPrd</code></td>
<td>
<p>Infectious period that can be obtained either from the literature or by fitting an SEIRS model to the data</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Sim_Par_Est_+3A_incprd">IncPrd</code></td>
<td>
<p>Incubation period that can be obtained either from the literature or by fitting an SEIRS model to the data</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Sim_Par_Est_+3A_nitermc">NIterMC</code></td>
<td>
<p>Number of MCMC iterations</p>
</td></tr>
<tr><td><code id="GDILM_SEIRS_Sim_Par_Est_+3A_nitermcecm">NIterMCECM</code></td>
<td>
<p>Number of MCECM iterations</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>alphaS</code> Estimate of alpha S
</p>
<p><code>BetaCovInf</code> Estimate of beta vector for the individual level infection covariate
</p>
<p><code>BetaCovSus</code> Estimate of beta vector for the areal susceptibility to first infection covariate
</p>
<p><code>BetaCovSusReInf</code> Estimate of beta vector for the areal susceptibility to reinfection covariate
</p>
<p><code>alphaT</code> Estimate of alpha T
</p>
<p><code>delta</code> Estimate of delta
</p>
<p><code>tau1</code> Estimate of tau
</p>
<p><code>lambda1</code> Estimate of lambda
</p>
<p><code>AIC</code> AIC of the fitted GDILM SEIRS
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
GDILM_SEIRS_Sim_Par_Est(5,5,10,30,0.7, 0.5, -1, 2.5, 0,40, 50,0.3,0.6, 3, 3, 10, 3)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
