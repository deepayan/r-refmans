<!DOCTYPE html><html><head><title>Help for package optimsimplex</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {optimsimplex}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#optimsimplex-package'>
<p>R port of the Scilab optimsimplex module</p></a></li>
<li><a href='#Function evaluations'>
<p>Computation of Function Value(s)</p></a></li>
<li><a href='#Get functions'>
<p>Optimsimplex Get Function Class</p></a></li>
<li><a href='#optimsimplex'>
<p>S3 optimsimplex class</p></a></li>
<li><a href='#optimsimplex.destroy'>
<p>Erase Simplex Object</p></a></li>
<li><a href='#optimsimplex.log'>
<p>Optimsimplex Logging</p></a></li>
<li><a href='#optimsimplex.reflect'>
<p>Simplex Reflection</p></a></li>
<li><a href='#optimsimplex.shrink'>
<p>Simplex Shrink</p></a></li>
<li><a href='#optimsimplex.utils'>
<p>Optimsimplex Utility Functions</p></a></li>
<li><a href='#osimplex'>
<p>S3 osimplex and vertex classes</p></a></li>
<li><a href='#Set functions'>
<p>Optimsimplex Set Function Class</p></a></li>
<li><a href='#Simplex gradient'>
<p>Simplex Gradient</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>R Port of the 'Scilab' Optimsimplex Module</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0-8</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-01-28</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a building block for optimization algorithms
        based on a simplex. The 'optimsimplex' package may be used in the
        following optimization methods: the simplex method of Spendley
        et al. (1962) &lt;<a href="https://doi.org/10.1080%2F00401706.1962.10490033">doi:10.1080/00401706.1962.10490033</a>&gt;, the method of 
        Nelder and Mead (1965) &lt;<a href="https://doi.org/10.1093%2Fcomjnl%2F7.4.308">doi:10.1093/comjnl/7.4.308</a>&gt;, Box's algorithm for
        constrained optimization (1965) &lt;<a href="https://doi.org/10.1093%2Fcomjnl%2F8.1.42">doi:10.1093/comjnl/8.1.42</a>&gt;, the 
        multi-dimensional search by Torczon (1989) 
        <a href="https://www.cs.wm.edu/~va/research/thesis.pdf">https://www.cs.wm.edu/~va/research/thesis.pdf</a>, etc...</td>
</tr>
<tr>
<td>Depends:</td>
<td>optimbase (&ge; 1.0-8),methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr (&ge; 1.28),rmarkdown (&ge; 2.2)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.cecill.info/licences/Licence_CeCILL_V2-en.txt">CeCILL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-01-28 11:57:01 UTC; sebastien</td>
</tr>
<tr>
<td>Author:</td>
<td>Sebastien Bihorel [aut, cre],
  Michael Baudin [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sebastien Bihorel &lt;sb.pmlab@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-01-28 21:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='optimsimplex-package'>
R port of the Scilab optimsimplex module
</h2><span id='topic+optimsimplex-package'></span>

<h3>Description</h3>

<p>The goal of this package is to provide a building block for optimization
algorithms based on a simplex. The <span class="pkg">optimsimplex</span> package may be used in
the following optimization methods: </p>

<ul>
<li><p> the simplex method of Spendley et al.,
</p>
</li>
<li><p> the method of Nelder and Mead,
</p>
</li>
<li><p> the Box's algorithm for constrained optimization,
</p>
</li>
<li><p> the multi-dimensional search by Torczon,
</p>
</li>
<li><p> etc ...
</p>
</li></ul>

<p><strong>Features</strong>
The following is a list of features currently provided:
</p>

<ul>
<li><p> Manage various simplex initializations </p>

<ul>
<li><p> initial simplex given by user,
</p>
</li>
<li><p> initial simplex computed with a length and along the coordinate
axes,
</p>
</li>
<li><p> initial regular simplex computed with Spendley et al. formula,
</p>
</li>
<li><p> initial simplex computed by a small perturbation around the initial
guess point,
</p>
</li>
<li><p> initial simplex computed from randomized bounds.
</p>
</li></ul>

</li>
<li><p> sort the vertices by increasing function values,
</p>
</li>
<li><p> compute the standard deviation of the function values in the simplex,
</p>
</li>
<li><p> compute the simplex gradient with forward or centered differences,
</p>
</li>
<li><p> shrink the simplex toward the best vertex,
</p>
</li>
<li><p> etc...
</p>
</li></ul>



<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
  Package: </td><td style="text-align: left;"> optimsimplex</td>
</tr>
<tr>
 <td style="text-align: left;">
  Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
  Version: </td><td style="text-align: left;"> 1.0-8</td>
</tr>
<tr>
 <td style="text-align: left;">
  Date: </td><td style="text-align: left;"> 2022-01-28</td>
</tr>
<tr>
 <td style="text-align: left;">
  License: </td><td style="text-align: left;"> CeCILL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
  LazyLoad: </td><td style="text-align: left;"> yes
  </td>
</tr>

</table>

<p>See <code>vignette('optimsimplex',package='optimsimplex')</code> for more
information.
</p>


<h3>Author(s)</h3>

<p>Author of Scilab optimsimplex module: Michael Baudin (INRIA - Digiteo)
</p>
<p>Author of R adaptation: Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>

<hr>
<h2 id='Function+20evaluations'>
Computation of Function Value(s)
</h2><span id='topic+optimsimplex.computefv'></span><span id='topic+optimsimplex.compsomefv'></span>

<h3>Description</h3>

<p>These functions compute the value of the function at the vertices points
stored in the current simplex object and stored them back into the simplex
object. <code>optimsimplex.computefv</code> determines how many vertices are stored
in the simplex object and delegates the calculation of the function values to
<code>optimsimplex.compsomefv</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  optimsimplex.computefv(this = NULL, fun = NULL, data = NULL)
  optimsimplex.compsomefv(this = NULL, fun = NULL, indices = NULL, data = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Function+2B20evaluations_+3A_this">this</code></td>
<td>
<p>The current simplex object, containing the nbve x n matrix of
vertice coordinates (i.e. <code>x</code> element), where n is the
dimension of the space and nbve the number of vertices.</p>
</td></tr>
<tr><td><code id="Function+2B20evaluations_+3A_fun">fun</code></td>
<td>
<p>The function to compute at vertices. The function is expected to
have the following input and output arguments:
</p>

<table>
<tr>
 <td style="text-align: left;">
      myfunction &lt;- function(x, this){ </td>
</tr>
<tr>
 <td style="text-align: left;">
        ... </td>
</tr>
<tr>
 <td style="text-align: left;">
        return(list(f=f,this=this)) </td>
</tr>
<tr>
 <td style="text-align: left;">
      }
    </td>
</tr>

</table>

<p>where x is a row vector and this a user-defined data, i.e. the <code>data</code> 
argument.</p>
</td></tr>
<tr><td><code id="Function+2B20evaluations_+3A_data">data</code></td>
<td>
<p>A user-defined data passed to the function. If data is provided,
it is passed to the callback function both as an input and output argument.
<code>data</code> may be used if the function uses some additionnal parameters. It
is returned as an output parameter because the function may modify the data
while computing the function value. This feature may be used, for example,
to count the number of times that the function has been called.</p>
</td></tr>
<tr><td><code id="Function+2B20evaluations_+3A_indices">indices</code></td>
<td>
<p>A vector of increasing integers from 1 to nbve.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>optimsimplex.computefv</code> and <code>optimsimplex.compsomefv</code> return a
list with the following elements: </p>

<dl>
<dt>this</dt><dd><p>The updated simplex object.</p>
</dd>
<dt>data</dt><dd><p>The updated user-defined data.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Author of Scilab optimsimplex module: Michael Baudin (INRIA - Digiteo)
</p>
<p>Author of R adaptation: Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+optimsimplex">optimsimplex</a></code>
</p>

<hr>
<h2 id='Get+20functions'>
Optimsimplex Get Function Class
</h2><span id='topic+optimsimplex.getall'></span><span id='topic+optimsimplex.getallfv'></span><span id='topic+optimsimplex.getallx'></span><span id='topic+optimsimplex.getfv'></span><span id='topic+optimsimplex.getn'></span><span id='topic+optimsimplex.getnbve'></span><span id='topic+optimsimplex.getve'></span><span id='topic+optimsimplex.getx'></span>

<h3>Description</h3>

<p>The functions extract the content to various elements of a simplex object:
</p>

<dl>
<dt><code>optimsimplex.getall</code></dt><dd><p>Get all the coordinates and the function
values of all the vertices.</p>
</dd>
<dt><code>optimsimplex.getallfv</code></dt><dd><p>Get all the function values of all the
vertices.</p>
</dd>
<dt><code>optimsimplex.getallx</code></dt><dd><p>Get all the coordinates of all the
vertices.</p>
</dd>
<dt><code>optimsimplex.getfv</code></dt><dd><p>Get the function value at a given index.</p>
</dd>
<dt><code>optimsimplex.getn</code></dt><dd><p>Get the dimension of the space of the
simplex.</p>
</dd>
<dt><code>optimsimplex.getnbve</code></dt><dd><p>Get the number of vertices of the
simplex.</p>
</dd>
<dt><code>optimsimplex.getve</code></dt><dd><p>Get the vertex at a given index in the
current simplex.</p>
</dd>
<dt><code>optimsimplex.getx</code></dt><dd><p>Get the coordinates of the vertex at a given
index in the current simplex.</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>  optimsimplex.getall(this = NULL)
  optimsimplex.getallfv(this = NULL)
  optimsimplex.getallx(this = NULL)
  optimsimplex.getfv(this = NULL, ive = NULL)
  optimsimplex.getn(this = NULL)
  optimsimplex.getnbve(this = NULL)
  optimsimplex.getve(this = NULL, ive = NULL)
  optimsimplex.getx(this = NULL, ive = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Get+2B20functions_+3A_this">this</code></td>
<td>
<p>A simplex object.</p>
</td></tr>
<tr><td><code id="Get+2B20functions_+3A_ive">ive</code></td>
<td>
<p>Vertex index.</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt><code>optimsimplex.getall</code></dt><dd><p>Return a nbve x n+1 matrix, where n is the
dimension of the space, nbve is the number of vertices and with the
following content: </p>

<ul>
<li> <p><code>simplex[k,1]</code> is the function value of the vertex k, with k =
1 to nbve,
</p>
</li>
<li> <p><code>simplex[k,2:(n+1)]</code> is the coordinates of the vertex k, with
k = 1 to nbve.
</p>
</li></ul>

</dd>
<dt><code>optimsimplex.getallfv</code></dt><dd><p>Return a row vector of function values,
which k^th element is the function value for the vertex k, with k = 1 to
nbve.</p>
</dd>
<dt><code>optimsimplex.getallx</code></dt><dd><p>Return a nbve x n matrix of vertice
coordinates; any given vertex is expected to be stored at row k, with k =
1 to nbve.</p>
</dd>
<dt><code>optimsimplex.getfv</code></dt><dd><p>Return a numeric scalar.</p>
</dd>
<dt><code>optimsimplex.getn</code></dt><dd><p>Return a numeric scalar.</p>
</dd>
<dt><code>optimsimplex.getnbve</code></dt><dd><p>Return a numeric scalar.</p>
</dd>
<dt><code>optimsimplex.getve</code></dt><dd><p>Return an object of class 'vertex', i.e. a
list with the following elements: </p>

<dl>
<dt>n</dt><dd><p>The dimension of the space of the simplex.</p>
</dd>
<dt>x</dt><dd><p>The coordinates of the vertex at index <code>ive</code>.</p>
</dd>
<dt>fv</dt><dd><p>The value of the function at index <code>ive</code>.</p>
</dd>
</dl>

</dd>
<dt>optimsimplex.getx</dt><dd><p>Return a row vector, representing the coordinates
of the vertex at index <code>ive</code>.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Author of Scilab optimsimplex module: Michael Baudin (INRIA - Digiteo)
</p>
<p>Author of R adaptation: Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+optimsimplex">optimsimplex</a></code>
</p>

<hr>
<h2 id='optimsimplex'>
S3 optimsimplex class
</h2><span id='topic+optimsimplex'></span><span id='topic+print.optimsimplex'></span><span id='topic+is.optimsimplex'></span><span id='topic+optimsimplex.tostring'></span>

<h3>Description</h3>

<p>These functions support the S3 class 'optimsimplex' and are intended to either 
create objects of this class or check if an object is of this class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  optimsimplex(coords = NULL, fun = NULL, data = NULL, method = NULL,
               x0 = NULL, len = NULL, deltausual = NULL, deltazero = NULL,
               boundsmax = NULL, boundsmin = NULL, nbve = NULL,
               simplex0 = NULL)
  
  optimsimplex.tostring(x)
  
  ## S3 method for class 'optimsimplex'
print(x,...)
  
  ## S3 method for class 'optimsimplex'
is(x)
  
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optimsimplex_+3A_coords">coords</code></td>
<td>
<p>The matrix of point estimate coordinates in the simplex. The
coords matrix is expected to be a nbve x n matrix, where n is the dimension
of the space and nbve is the number of vertices in the simplex, with nbve&gt;=
n+1. Only used if <code>method</code> is set to NULL.</p>
</td></tr>
<tr><td><code id="optimsimplex_+3A_fun">fun</code></td>
<td>
<p>The function to compute at vertices. The function is expected to
have the following input and output arguments:
</p>

<table>
<tr>
 <td style="text-align: left;">
      myfunction &lt;- function(x, this){ </td>
</tr>
<tr>
 <td style="text-align: left;">
        ... </td>
</tr>
<tr>
 <td style="text-align: left;">
        return(list(f=f,this=this)) </td>
</tr>
<tr>
 <td style="text-align: left;">
      }
    </td>
</tr>

</table>

<p>where x is a row vector and this a user-defined data, i.e. the <code>data</code>
argument.</p>
</td></tr>
<tr><td><code id="optimsimplex_+3A_data">data</code></td>
<td>
<p>A user-defined data passed to the function. If data is provided,
it is passed to the callback function both as an input and output argument.
<code>data</code> may be used if the function uses some additionnal parameters. It
is returned as an output parameter because the function may modify the data
while computing the function value. This feature may be used, for example,
to count the number of times that the function has been called.</p>
</td></tr>
<tr><td><code id="optimsimplex_+3A_method">method</code></td>
<td>
<p>The method used to create the new optimsimplex object, either
'axes', 'pfeffer', 'randbounds', 'spendley' or 'oriented'.</p>
</td></tr>
<tr><td><code id="optimsimplex_+3A_x0">x0</code></td>
<td>
<p>The initial point estimates, as a row vector of length n.</p>
</td></tr>
<tr><td><code id="optimsimplex_+3A_len">len</code></td>
<td>
<p>The dimension of the simplex. If length is a value, that unique
length is used in all directions. If length is a vector with n values, each
length is used with the corresponding direction. Only used if <code>method</code>
is set to 'axes' or 'spendley'.</p>
</td></tr>
<tr><td><code id="optimsimplex_+3A_deltausual">deltausual</code></td>
<td>
<p>The absolute delta for non-zero values. Only used if
<code>method</code> is set to 'pfeffer'.</p>
</td></tr>
<tr><td><code id="optimsimplex_+3A_deltazero">deltazero</code></td>
<td>
<p>The absolute delta for zero values. Only used if
<code>method</code> is set to 'pfeffer'.</p>
</td></tr>
<tr><td><code id="optimsimplex_+3A_boundsmin">boundsmin</code></td>
<td>
<p>A vector of minimum bounds. Only used if <code>method</code> is
set to 'randbounds'.</p>
</td></tr>
<tr><td><code id="optimsimplex_+3A_boundsmax">boundsmax</code></td>
<td>
<p>A vector of maximum bounds. Only used if <code>method</code> is
set to 'randbounds'.</p>
</td></tr>
<tr><td><code id="optimsimplex_+3A_nbve">nbve</code></td>
<td>
<p>The total number of vertices in the simplex. Only used if
<code>method</code> is set to 'randbounds'.</p>
</td></tr>
<tr><td><code id="optimsimplex_+3A_simplex0">simplex0</code></td>
<td>
<p>The initial simplex. Only used if <code>method</code> is set to
'oriented'.</p>
</td></tr>
<tr><td><code id="optimsimplex_+3A_x">x</code></td>
<td>
<p>An object of class 'optimsimplex'.</p>
</td></tr>
<tr><td><code id="optimsimplex_+3A_...">...</code></td>
<td>
<p>optional arguments to 'print' or 'plot' methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All arguments of <code>optimsimplex</code> are optional. If no input is provided,
the new optimsimplex object is empty.
</p>
<p>If <code>method</code> is NULL, the new optimsimplex object is created by
<code>optimsimplex.coords</code>. If <code>coords</code> is NULL, the optimsimplex object 
is empty; otherwise, <code>coords</code> is used as the initial vertice coordinates
in the new simplex.
</p>
<p>If <code>method</code> is set to 'axes', the initial vertice coordinates are stored 
in a nbve x n matrix built as follows:</p>

<table>
<tr>
 <td style="text-align: left;">
    [,1] </td><td style="text-align: left;">| </td><td style="text-align: center;"> x0[1] </td><td style="text-align: center;">.... </td><td style="text-align: center;"> x0[n] </td><td style="text-align: right;"> | </td><td style="text-align: center;"> </td><td style="text-align: left;"> | </td><td style="text-align: center;"> len[1]
      </td><td style="text-align: center;">... </td><td style="text-align: center;"> 0 </td><td style="text-align: right;">| </td>
</tr>
<tr>
 <td style="text-align: left;">
    [,.] </td><td style="text-align: left;">| </td><td style="text-align: center;">... </td><td style="text-align: center;">... </td><td style="text-align: center;">... </td><td style="text-align: right;"> | </td><td style="text-align: center;"> + </td><td style="text-align: left;"> | </td><td style="text-align: center;">... </td><td style="text-align: center;">...
      </td><td style="text-align: center;">... </td><td style="text-align: right;">| </td>
</tr>
<tr>
 <td style="text-align: left;">
    [,nbve] </td><td style="text-align: left;">| </td><td style="text-align: center;"> x0[1] </td><td style="text-align: center;">... </td><td style="text-align: center;"> x0[n] </td><td style="text-align: right;"> | </td><td style="text-align: center;"> </td><td style="text-align: left;"> | </td><td style="text-align: center;"> 0
      </td><td style="text-align: center;">... </td><td style="text-align: center;"> len[n] </td><td style="text-align: right;">| </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p>If <code>method</code> is set to 'pfeffer', the new optimsimplex object is created 
using the Pfeffer's method, i.e. a relative delta for non-zero values and an 
absolute delta for zero values.
</p>
<p>If <code>method</code> is set to 'randbounds', the initial vertice coordinates are 
stored in a nbve x n matrix consisting of the initial point estimates (on the 
first row) and a (nbve-1) x n matrix of randomly sampled numbers between the
specified the bounds. The number of vertices <code>nbve</code> in the optimsimplex 
is arbitrary.
</p>
<p>If <code>method</code> is set to 'spendley', the new optimsimplex object is created 
using the Spendely's method, i.e. a regular simplex made of nbve = n+1 
vertices. 
</p>
<p>If <code>method</code> is set to 'oriented', the new optimsimplex object is created 
in sorted order. The new simplex has the same sigma- length of the base 
simplex, but is &quot;oriented&quot; depending on the function value. The created 
optimsimplex may be used, as Kelley suggests, for a restart of Nelder-Mead 
algorithm.
</p>
<p>The <code>optimsimplex.tostring</code> function is a utility function, which formats
the content of a optimsimplex object into a single string of characters.
</p>


<h3>Value</h3>

<p>The <code>optimsimplex</code> function returns a list with the following elements: 
</p>

<dl>
<dt>newobj</dt><dd><p>An object of class 'simplex', i.e. a list with the following 
elements: </p>

<dl>
<dt>verbose</dt><dd><p>The verbose option, controlling the amount of messages.
Set to FALSE.</p>
</dd>
<dt>x</dt><dd><p>The coordinates of the vertices, with size nbve x n.</p>
</dd>
<dt>n</dt><dd><p>The dimension of the space.</p>
</dd>
<dt>fv</dt><dd><p>The values of the function at given vertices. It is a column
matrix of length nbve.</p>
</dd>
<dt>nbve</dt><dd><p>The number of vertices.</p>
</dd>
</dl>

</dd>
<dt>data</dt><dd><p>The updated <code>data</code> input argument.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Author of Scilab optimsimplex module: Michael Baudin (INRIA - Digiteo)
</p>
<p>Author of R adaptation: Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>References</h3>

<p>&quot;A Simplex Method for Function Minimization&quot;, Nelder, J. A. and Mead, R. The
Computer Journal, January, 1965, 308-313
</p>
<p>&quot;Sequential Application of Simplex Designs in Optimisation and Evolutionary
Operation&quot;, W. Spendley, G. R. Hext, F. R. Himsworth, Technometrics, Vol. 4, No.
4 (Nov., 1962), pp. 441-461, Section 3.1
</p>
<p>&quot;A New Method of Constrained Optimization and a Comparison With Other Methods&quot;,
M. J. Box, The Computer Journal 1965 8(1):42-52, 1965 by British Computer
Society
</p>
<p>&quot;Detection and Remediation of Stagnation in the Nelder-Mead Algorithm Using a
Sufficient Decrease Condition&quot;, SIAM J. on Optimization, Kelley C.T., 1999
</p>
<p>&quot;Multi-Directional Search: A Direct Search Algorithm for Parallel Machines&quot;, by
E. Boyd, Kenneth W. Kennedy, Richard A. Tapia, Virginia Joanne Torczon,
Virginia Joanne Torczon, 1989, Phd Thesis, Rice University
</p>
<p>&quot;Grid Restrained Nelder-Mead Algorithm&quot;, Arpad Burmen, Janez Puhan, Tadej Tuma,
Computational Optimization and Applications, Volume 34 , Issue 3 (July 2006),
Pages: 359 - 375
</p>
<p>&quot;A convergent variant of the Nelder-Mead algorithm&quot;, C. J. Price, I. D. Coope,
D. Byatt, Journal of Optimization Theory and Applications, Volume 113 , Issue 1
(April 2002), Pages: 5 - 19,
</p>
<p>&quot;Global Optimization Of Lennard-Jones Atomic Clusters&quot;, Ellen Fan, Thesis,
February 26, 2002, McMaster University
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  myfun &lt;- function(x,this){return(list(f=sum(x^2),this=this))}
  mat &lt;- matrix(c(0,1,0,0,0,1),ncol=2)
  
  optimsimplex()
  optimsimplex(coords=mat,x0=1:4,fun=myfun)
  optimsimplex(method='axes',x0=1:4,fun=myfun)
  optimsimplex(method='pfeffer',x0=1:6,fun=myfun)
  opt &lt;- optimsimplex(method='randbounds',x0=1:6,boundsmin=rep(0,6),
                          boundsmax=rep(10,6),fun=myfun)
  opt
  optimsimplex(method='spendley',x0=1:6,fun=myfun,len=10)
  optimsimplex(method='oriented',simplex=opt$newobj,fun=myfun)
 
</code></pre>

<hr>
<h2 id='optimsimplex.destroy'>
Erase Simplex Object 
</h2><span id='topic+optimsimplex.destroy'></span>

<h3>Description</h3>

<p>This function erases the coordinates of the vertices (<code>x</code>) and the
function values (<code>fv</code>) in a simplex object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  optimsimplex.destroy(this = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optimsimplex.destroy_+3A_this">this</code></td>
<td>
<p>A simplex object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return an updated simplex object for which the content of the <code>x</code> and
<code>fv</code> elements were set to NULL.
</p>


<h3>Author(s)</h3>

<p>Author of Scilab optimsimplex module: Michael Baudin (INRIA - Digiteo)
</p>
<p>Author of R adaptation: Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+optimsimplex">optimsimplex</a></code>
</p>

<hr>
<h2 id='optimsimplex.log'>
Optimsimplex Logging
</h2><span id='topic+optimsimplex.log'></span>

<h3>Description</h3>

<p>This function prints a message to screen (or log file).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  optimsimplex.log(this = NULL, msg = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optimsimplex.log_+3A_this">this</code></td>
<td>
<p>An simplex object.</p>
</td></tr>
<tr><td><code id="optimsimplex.log_+3A_msg">msg</code></td>
<td>
<p>A message to print.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Do not return any value but print <code>msg</code> to screen if the <code>verbose</code>
in <code>this</code> is set to 1.
</p>


<h3>Author(s)</h3>

<p>Author of Scilab optimsimplex module: Michael Baudin (INRIA - Digiteo)
</p>
<p>Author of R adaptation: Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+optimsimplex">optimsimplex</a></code>
</p>

<hr>
<h2 id='optimsimplex.reflect'>
Simplex Reflection
</h2><span id='topic+optimsimplex.reflect'></span>

<h3>Description</h3>

<p>This function returns a new simplex by reflection of the current simplex with
respect to the first vertex in the simplex. This move is used in the centered
simplex gradient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  optimsimplex.reflect(this = NULL, fun = NULL, data = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optimsimplex.reflect_+3A_this">this</code></td>
<td>
<p>An simplex object.</p>
</td></tr>
<tr><td><code id="optimsimplex.reflect_+3A_fun">fun</code></td>
<td>
<p>The function to compute at vertices. The function is expected to
have the following input and output arguments:
</p>

<table>
<tr>
 <td style="text-align: left;">
      myfunction &lt;- function(x, this){ </td>
</tr>
<tr>
 <td style="text-align: left;">
        ... </td>
</tr>
<tr>
 <td style="text-align: left;">
        return(list(f=f,this=this)) </td>
</tr>
<tr>
 <td style="text-align: left;">
      }
    </td>
</tr>

</table>

<p>where x is a row vector and this a user-defined data, i.e. the <code>data</code>
argument.</p>
</td></tr>
<tr><td><code id="optimsimplex.reflect_+3A_data">data</code></td>
<td>
<p>A user-defined data passed to the function. If data is provided,
it is passed to the callback function both as an input and output argument.
<code>data</code> may be used if the function uses some additionnal parameters. It
is returned as an output parameter because the function may modify the data
while computing the function value. This feature may be used, for example,
to count the number of times that the function has been called.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a list with the following elements: </p>

<dl>
<dt>r</dt><dd><p>The reflected simplex object.</p>
</dd>
<dt>data</dt><dd><p>The updated user-defined data.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Author of Scilab optimsimplex module: Michael Baudin (INRIA - Digiteo)
</p>
<p>Author of R adaptation: Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+optimsimplex">optimsimplex</a></code>
</p>

<hr>
<h2 id='optimsimplex.shrink'>
Simplex Shrink
</h2><span id='topic+optimsimplex.shrink'></span>

<h3>Description</h3>

<p>This function shrinks the simplex with given coefficient sigma and returns an
updated simplex. The shrink is performed with respect to the first point in
the simplex.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  optimsimplex.shrink(this = NULL, fun = NULL, sigma = 0.5, data = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optimsimplex.shrink_+3A_this">this</code></td>
<td>
<p>An simplex object</p>
</td></tr>
<tr><td><code id="optimsimplex.shrink_+3A_fun">fun</code></td>
<td>
<p>The function to compute at vertices. The function is expected to
have the following input and output arguments:
</p>

<table>
<tr>
 <td style="text-align: left;">
      myfunction &lt;- function(x, this){ </td>
</tr>
<tr>
 <td style="text-align: left;">
        ... </td>
</tr>
<tr>
 <td style="text-align: left;">
        return(list(f=f,this=this)) </td>
</tr>
<tr>
 <td style="text-align: left;">
      }
    </td>
</tr>

</table>

<p>where x is a row vector and this a user-defined data, i.e. the <code>data</code>.</p>
</td></tr>
<tr><td><code id="optimsimplex.shrink_+3A_sigma">sigma</code></td>
<td>
<p>The shrinkage coefficient. The default value is 0.5.</p>
</td></tr>
<tr><td><code id="optimsimplex.shrink_+3A_data">data</code></td>
<td>
<p>A user-defined data passed to the function. If data is provided,
it is passed to the callback function both as an input and output argument.
<code>data</code> may be used if the function uses some additionnal parameters. It
is returned as an output parameter because the function may modify the data
while computing the function value. This feature may be used, for example,
to count the number of times that the function has been called.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a list with the following elements: </p>

<dl>
<dt>this</dt><dd><p>The updated simplex object.</p>
</dd>
<dt>data</dt><dd><p>The updated user-defined data.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Author of Scilab optimsimplex module: Michael Baudin (INRIA - Digiteo)
</p>
<p>Author of R adaptation: Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+optimsimplex">optimsimplex</a></code>
</p>

<hr>
<h2 id='optimsimplex.utils'>
Optimsimplex Utility Functions
</h2><span id='topic+optimsimplex.center'></span><span id='topic+optimsimplex.check'></span><span id='topic+optimsimplex.deltafv'></span><span id='topic+optimsimplex.deltafvmax'></span><span id='topic+optimsimplex.dirmat'></span><span id='topic+optimsimplex.fvmean'></span><span id='topic+optimsimplex.fvstdev'></span><span id='topic+optimsimplex.fvvariance'></span><span id='topic+optimsimplex.size'></span><span id='topic+optimsimplex.sort'></span><span id='topic+optimsimplex.xbar'></span>

<h3>Description</h3>

<p>These functions enable various calculations and checks on the current simplex:
</p>

<dl>
<dt><code>optimsimplex.center</code></dt><dd><p>Compute the center of the current
simplex.</p>
</dd>
<dt><code>optimsimplex.check</code></dt><dd><p>Check the consistency of the data in the
current simplex.</p>
</dd>
<dt><code>optimsimplex.deltafv</code></dt><dd><p>Compute the vector of function value
differences with respect to the function value at the first vertex (the
lowest).</p>
</dd>
<dt><code>optimsimplex.deltafvmax</code></dt><dd><p>Compute the difference of function
value between the lowest and the highest vertices. It is expected that the
first vertex (<code>this$x[1,]</code>) is associated with the smallest function
value and that the last vertex (<code>this$x[nbve,]</code>) is associated with
the highest function value.</p>
</dd>
<dt><code>optimsimplex.dirmat</code></dt><dd><p>Compute the matrix of simplex direction,
i.e. the matrix of differences of vertice coordinates with respect to the
first vertex.</p>
</dd>
<dt><code>optimsimplex.fvmean</code></dt><dd><p>Compute the mean of the function values in
the current simplex.</p>
</dd>
<dt><code>optimsimplex.fvstdev</code></dt><dd><p>Compute the standard deviation of the
function values in the current simplex.</p>
</dd>
<dt><code>optimsimplex.fvvariance</code></dt><dd><p>Compute the variance of the function
values in the current simplex.</p>
</dd>
<dt><code>optimsimplex.size</code></dt><dd><p>Determines the size of the simplex.</p>
</dd>
<dt><code>optimsimplex.sort</code></dt><dd><p>Sort the simplex by increasing order of
function value, so the smallest function is at the first vertex.</p>
</dd>
<dt><code>optimsimplex.xbar</code></dt><dd><p>Compute the center of n vertices, by
excluding the vertex with index <code>iexcl</code>. The default of <code>iexcl</code>
is the number of vertices: in that case, if the simplex is sorted in
increasing function value order, the worst vertex is excluded.</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>  optimsimplex.center(this = NULL)
  optimsimplex.check(this = NULL)
  optimsimplex.deltafv(this = NULL)
  optimsimplex.deltafvmax(this = NULL)
  optimsimplex.dirmat(this = NULL)
  optimsimplex.fvmean(this = NULL)
  optimsimplex.fvstdev(this = NULL)
  optimsimplex.fvvariance(this = NULL)
  optimsimplex.size(this = NULL, method = NULL)
  optimsimplex.sort(this = NULL)
  optimsimplex.xbar(this = NULL, iexcl = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optimsimplex.utils_+3A_this">this</code></td>
<td>
<p>The current simplex.</p>
</td></tr>
<tr><td><code id="optimsimplex.utils_+3A_method">method</code></td>
<td>
<p>The method to use to compute the size of the simplex. The
available methods are the following: </p>

<dl>
<dt>'sigmaplus'</dt><dd><p>(this is the default) The sigmamplus size is the
maximum 2-norm length of the vector from each vertex to the first
vertex. It requires one loop over the vertices.</p>
</dd>
<dt>'sigmaminus'</dt><dd><p>The sigmaminus size is the minimum 2-norm length of
the vector from each vertex to the first vertex. It requires one loop
over the vertices.</p>
</dd>
<dt>'Nash'</dt><dd><p>The 'Nash' size is the sum of the norm of the norm-1 length
of the vector from the given vertex to the first vertex. It requires one
loop over the vertices.</p>
</dd>
<dt>'diameter'</dt><dd><p>The diameter is the maximum norm-2 length of all the
edges of the simplex. It requires 2 nested loops over the vertices.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="optimsimplex.utils_+3A_iexcl">iexcl</code></td>
<td>
<p>The index of the vertex to exclude in center computation.</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt><code>optimsimplex.center</code></dt><dd><p>Return a vector of length nbve, where nbve
is the number of vertices in the current simplex.</p>
</dd>
<dt><code>optimsimplex.check</code></dt><dd><p>Return an error message if the dimensions
of the various elements of the current simplex do not match.</p>
</dd>
<dt><code>optimsimplex.deltafv</code></dt><dd><p>Return a column vector of length nbve-1.</p>
</dd>
<dt><code>optimsimplex.deltafvmax</code></dt><dd><p>Return a numeric scalar.</p>
</dd>
<dt><code>optimsimplex.dirmat</code></dt><dd><p>Return a n x n numeric matrix, where n is
the dimension of the space of the simplex.</p>
</dd>
<dt><code>optimsimplex.fvmean</code></dt><dd><p>Return a numeric scalar.</p>
</dd>
<dt><code>optimsimplex.fvstdev</code></dt><dd><p>Return a numeric scalar.</p>
</dd>
<dt><code>optimsimplex.fvvariance</code></dt><dd><p>Return a numeric scalar.</p>
</dd>
<dt><code>optimsimplex.size</code></dt><dd><p>Return a numeric scalar.</p>
</dd>
<dt><code>optimsimplex.sort</code></dt><dd><p>Return an updated simplex object.</p>
</dd>
<dt><code>optimsimplex.xbar</code></dt><dd><p>Return a row vector of length n.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Author of Scilab optimsimplex module: Michael Baudin (INRIA - Digiteo)
</p>
<p>Author of R adaptation: Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>References</h3>

<p>&quot;Compact Numerical Methods For Computers - Linear Algebra and Function
Minimization&quot;, J.C. Nash, 1990, Chapter 14. Direct Search Methods
</p>
<p>&quot;Iterative Methods for Optimization&quot;, C.T. Kelley, 1999, Chapter 6., section
6.2
</p>


<h3>See Also</h3>

<p><code><a href="#topic+optimsimplex">optimsimplex</a></code>
</p>

<hr>
<h2 id='osimplex'>
S3 osimplex and vertex classes
</h2><span id='topic+osimplex'></span><span id='topic+vertex'></span><span id='topic+print.osimplex'></span><span id='topic+is.osimplex'></span><span id='topic+print.vertex'></span><span id='topic+is.vertex'></span>

<h3>Description</h3>

<p>These functions support the S3 classes 'osimplex' and 'vertex'. They are 
intended to either create objects of these classes or check if an object is 
of these classes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  osimplex(verbose,x,n,fv,nbve)
  
  vertex(x,n,fv)
  
  ## S3 method for class 'osimplex'
print(x,...)
  
  ## S3 method for class 'vertex'
print(x,...)
  
  ## S3 method for class 'osimplex'
is(x)
  
  ## S3 method for class 'vertex'
is(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="osimplex_+3A_verbose">verbose</code></td>
<td>
<p>The verbose option, controlling the amount of messages</p>
</td></tr>
<tr><td><code id="osimplex_+3A_x">x</code></td>
<td>
<p>The coordinates of the vertices, with size nbve x n in a simplex 
object or 1 x n in a vertex.</p>
</td></tr>
<tr><td><code id="osimplex_+3A_n">n</code></td>
<td>
<p>The dimension of the space.</p>
</td></tr>
<tr><td><code id="osimplex_+3A_fv">fv</code></td>
<td>
<p>The values of the function at given vertices. It is a column
matrix of length nbve in a simplex or a single value in a vertex.</p>
</td></tr>
<tr><td><code id="osimplex_+3A_nbve">nbve</code></td>
<td>
<p>The number of vertices in a simplex.</p>
</td></tr>
<tr><td><code id="osimplex_+3A_...">...</code></td>
<td>
<p>optional arguments to 'print' or 'plot' methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A simplex of size n x nbve is essentially a collection of vertex of size n. 
</p>


<h3>Value</h3>

<p><code>osimplex</code> returns a list with the following elements: verbose, x, n, fv, 
and nbve.
<code>vertex</code> returns a list with the following elements: x, n, and fv.
</p>


<h3>Author(s)</h3>

<p>Author of Scilab optimsimplex module: Michael Baudin (INRIA - Digiteo)
</p>
<p>Author of R adaptation: Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>

<hr>
<h2 id='Set+20functions'>
Optimsimplex Set Function Class
</h2><span id='topic+optimsimplex.setall'></span><span id='topic+optimsimplex.setallfv'></span><span id='topic+optimsimplex.setallx'></span><span id='topic+optimsimplex.setfv'></span><span id='topic+optimsimplex.setn'></span><span id='topic+optimsimplex.setnbve'></span><span id='topic+optimsimplex.setve'></span><span id='topic+optimsimplex.setx'></span>

<h3>Description</h3>

<p>The functions assign content to various elements of a simplex object:
</p>

<dl>
<dt><code>optimsimplex.setall</code></dt><dd><p>Set all the coordinates and the function
values of all the vertices.</p>
</dd>
<dt><code>optimsimplex.setallfv</code></dt><dd><p>Set all the function values of all the
vertices.</p>
</dd>
<dt><code>optimsimplex.setallx</code></dt><dd><p>Set all the coordinates of all the
vertices.</p>
</dd>
<dt><code>optimsimplex.setfv</code></dt><dd><p>Set the function value at a givenindex.</p>
</dd>
<dt><code>optimsimplex.setn</code></dt><dd><p>Set the dimension of the space of the
simplex.</p>
</dd>
<dt><code>optimsimplex.setnbve</code></dt><dd><p>Set the number of vertices of the
simplex.</p>
</dd>
<dt><code>optimsimplex.setve</code></dt><dd><p>Set the coordinates of the vertex and the
function values at a given index in the current simplex.</p>
</dd>
<dt><code>optimsimplex.setx</code></dt><dd><p>Set the coordinates of the vertex at a given
index in the current simplex.</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>  optimsimplex.setall(this = NULL, simplex = NULL)
  optimsimplex.setallfv(this = NULL, fv = NULL)
  optimsimplex.setallx(this = NULL, x = NULL)
  optimsimplex.setfv(this = NULL, ive = NULL, fv = NULL)
  optimsimplex.setn(this = NULL, n = NULL)
  optimsimplex.setnbve(this = NULL, nbve = NULL)
  optimsimplex.setve(this = NULL, ive = NULL, fv = NULL, x = NULL)
  optimsimplex.setx(this = NULL, ive = NULL, x = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Set+2B20functions_+3A_this">this</code></td>
<td>
<p>A simplex object.</p>
</td></tr>
<tr><td><code id="Set+2B20functions_+3A_simplex">simplex</code></td>
<td>
<p>The simplex to set. It is expected to be a nbve x n+1 matrix
where n is the dimension of the space, nbve is the number of vertices and
with the following content: </p>

<ul>
<li> <p><code>simplex[k,1]</code> is the function value of the vertex k, with k =
1 to nbve,
</p>
</li>
<li> <p><code>simplex[k,2:(n+1)]</code> is the coordinates of the vertex k, with
k = 1 to nbve.
</p>
</li></ul>

</td></tr>
<tr><td><code id="Set+2B20functions_+3A_fv">fv</code></td>
<td>
<p>A row vector of function values; <code>fv[k]</code> is expected to be the
function value for the vertex k, with k = 1 to nbve. For
<code>optimsimplex.setfv</code>, <code>fv</code> is expected to be a numerical scalar.</p>
</td></tr>
<tr><td><code id="Set+2B20functions_+3A_x">x</code></td>
<td>
<p>The nbve x n matrix of vertice coordinates; the vertex is expected to
be stored in <code>x[k,1:n]</code>, with k = 1 to nbve. For
<code>optimsimplex.setve</code> and <code>optimsimplex.setx</code>, <code>x</code> is expected
to be a row matrix.</p>
</td></tr>
<tr><td><code id="Set+2B20functions_+3A_ive">ive</code></td>
<td>
<p>Vertex index.</p>
</td></tr>
<tr><td><code id="Set+2B20functions_+3A_n">n</code></td>
<td>
<p>The dimension of the space of the simplex.</p>
</td></tr>
<tr><td><code id="Set+2B20functions_+3A_nbve">nbve</code></td>
<td>
<p>The number of vertices of the simplex.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a updated simplex object <code>this</code>.
</p>


<h3>Author(s)</h3>

<p>Author of Scilab optimsimplex module: Michael Baudin (INRIA - Digiteo)
</p>
<p>Author of R adaptation: Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+optimsimplex">optimsimplex</a></code>
</p>

<hr>
<h2 id='Simplex+20gradient'>
Simplex Gradient
</h2><span id='topic+optimsimplex.gradientfv'></span><span id='topic+optimsimplex.gradcenter'></span><span id='topic+optimsimplex.gradforward'></span>

<h3>Description</h3>

<p><code>optimsimplex.gradientfv</code> determines the simplex gradient of the function
which is computed by the secondary functions <code>optimsimplex.gradcenter</code>
and <code>optimsimplex.gradforward</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  optimsimplex.gradientfv(this = NULL, fun = NULL, method = "forward",
                          data = NULL)
  optimsimplex.gradcenter(this = NULL, fun = NULL, data = NULL)
  optimsimplex.gradforward(this = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Simplex+2B20gradient_+3A_this">this</code></td>
<td>
<p>An simplex object</p>
</td></tr>
<tr><td><code id="Simplex+2B20gradient_+3A_fun">fun</code></td>
<td>
<p>The function to compute at vertices. The function is expected to
have the following input and output arguments:
</p>

<table>
<tr>
 <td style="text-align: left;">
      myfunction &lt;- function(x, this){ </td>
</tr>
<tr>
 <td style="text-align: left;">
        ... </td>
</tr>
<tr>
 <td style="text-align: left;">
        return(list(f=f,this=this)) </td>
</tr>
<tr>
 <td style="text-align: left;">
      }
    </td>
</tr>

</table>

<p>where x is a row vector and this a user-defined data, i.e. the <code>data</code>
argument.</p>
</td></tr>
<tr><td><code id="Simplex+2B20gradient_+3A_method">method</code></td>
<td>
<p>The method used to compute the simplex gradient. Two methods
are available: 'forward' and 'centered'. The 'forward' method uses the
current simplex to compute the gradient (using <code>optimsimplex.dirmat</code>
and  <code>optimsimplex.deltafv</code>). The 'centered' method creates an
intermediate simplex and computes the average.</p>
</td></tr>
<tr><td><code id="Simplex+2B20gradient_+3A_data">data</code></td>
<td>
<p>A user-defined data passed to the function. If data is provided,
it is passed to the callback function both as an input and output argument.
<code>data</code> may be used if the function uses some additionnal parameters. It
is returned as an output parameter because the function may modify the data
while computing the function value. This feature may be used, for example,
to count the number of times that the function has been called.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>optimsimplex.gradientfv</code> returns a list with the following elements:
</p>

<dl>
<dt>g</dt><dd><p>A column vector of function gradient (with length <code>this$n</code>).</p>
</dd>
<dt>data</dt><dd><p>The updated user-defined data.</p>
</dd>
</dl>

<p><code>optimsimplex.gradcenter</code> returns a list with the following elements:
</p>

<dl>
<dt>g</dt><dd><p>A column vector of function gradient (with length <code>this$n</code>).</p>
</dd>
<dt>data</dt><dd><p>The updated user-defined data.</p>
</dd>
</dl>

<p><code>optimsimplex.gradforward</code> returns a column vector of function gradient
(with length <code>this$n</code>).
</p>


<h3>Author(s)</h3>

<p>Author of Scilab optimsimplex module: Michael Baudin (INRIA - Digiteo)
</p>
<p>Author of R adaptation: Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+optimsimplex">optimsimplex</a></code>,
<code><a href="#topic+optimsimplex.dirmat">optimsimplex.dirmat</a></code>,
<code><a href="#topic+optimsimplex.deltafv">optimsimplex.deltafv</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
