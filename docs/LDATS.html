<!DOCTYPE html><html><head><title>Help for package LDATS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LDATS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AICc'><p>Calculate AICc</p></a></li>
<li><a href='#autocorr_plot'><p>Produce the autocorrelation panel for the TS diagnostic plot of</p>
a parameter</a></li>
<li><a href='#check_changepoints'><p>Check that a set of change point locations is proper</p></a></li>
<li><a href='#check_control'><p>Check that a control list is proper</p></a></li>
<li><a href='#check_document_covariate_table'><p>Check that the document covariate table is proper</p></a></li>
<li><a href='#check_document_term_table'><p>Check that document term table is proper</p></a></li>
<li><a href='#check_formula'><p>Check that a formula is proper</p></a></li>
<li><a href='#check_formulas'><p>Check that formulas vector is proper and append the response</p>
variable</a></li>
<li><a href='#check_LDA_models'><p>Check that LDA model input is proper</p></a></li>
<li><a href='#check_nchangepoints'><p>Check that nchangepoints vector is proper</p></a></li>
<li><a href='#check_seeds'><p>Check that nseeds value or seeds vector is proper</p></a></li>
<li><a href='#check_timename'><p>Check that the time vector is proper</p></a></li>
<li><a href='#check_topics'><p>Check that topics vector is proper</p></a></li>
<li><a href='#check_weights'><p>Check that weights vector is proper</p></a></li>
<li><a href='#count_trips'><p>Count trips of the ptMCMC particles</p></a></li>
<li><a href='#diagnose_ptMCMC'><p>Calculate ptMCMC summary diagnostics</p></a></li>
<li><a href='#document_weights'><p>Calculate document weights for a corpus</p></a></li>
<li><a href='#ecdf_plot'><p>Produce the posterior distribution ECDF panel for the TS</p>
diagnostic plot of a parameter</a></li>
<li><a href='#est_changepoints'><p>Use ptMCMC to estimate the distribution of change point locations</p></a></li>
<li><a href='#est_regressors'><p>Estimate the distribution of regressors, unconditional on the</p>
change point locations</a></li>
<li><a href='#expand_TS'><p>Expand the TS models across the factorial combination of</p>
LDA models, formulas, and number of change points</a></li>
<li><a href='#iftrue'><p>Replace if TRUE</p></a></li>
<li><a href='#jornada'><p>Jornada rodent data</p></a></li>
<li><a href='#LDA_msg'><p>Create the model-running-message for an LDA</p></a></li>
<li><a href='#LDA_set'><p>Run a set of Latent Dirichlet Allocation models</p></a></li>
<li><a href='#LDA_set_control'><p>Create control list for set of LDA models</p></a></li>
<li><a href='#LDA_TS'><p>Run a full set of Latent Dirichlet Allocations and Time</p>
Series models</a></li>
<li><a href='#LDA_TS_control'><p>Create the controls list for the LDATS model</p></a></li>
<li><a href='#LDATS'><p>Package to conduct two-stage analyses combining Latent Dirichlet</p>
Allocation with Bayesian Time Series models</a></li>
<li><a href='#logLik.LDA_VEM'><p>Calculate the log likelihood of a VEM LDA model fit</p></a></li>
<li><a href='#logLik.multinom_TS_fit'><p>Log likelihood of a multinomial TS model</p></a></li>
<li><a href='#logLik.TS_fit'><p>Determine the log likelihood of a Time Series model</p></a></li>
<li><a href='#logsumexp'><p>Calculate the log-sum-exponential (LSE) of a vector</p></a></li>
<li><a href='#memoise_fun'><p>Logical control on whether or not to memoise</p></a></li>
<li><a href='#messageq'><p>Optionally generate a message based on a logical input</p></a></li>
<li><a href='#mirror_vcov'><p>Create a properly symmetric variance covariance matrix</p></a></li>
<li><a href='#modalvalue'><p>Determine the mode of a distribution</p></a></li>
<li><a href='#multinom_TS'><p>Fit a multinomial change point Time Series model</p></a></li>
<li><a href='#multinom_TS_chunk'><p>Fit a multinomial Time Series model chunk</p></a></li>
<li><a href='#normalize'><p>Normalize a vector</p></a></li>
<li><a href='#package_chunk_fits'><p>Package the output of the chunk-level multinomial models into a</p>
multinom_TS_fit list</a></li>
<li><a href='#package_LDA_set'><p>Package the output from LDA_set</p></a></li>
<li><a href='#package_LDA_TS'><p>Package the output of LDA_TS</p></a></li>
<li><a href='#package_TS'><p>Summarize the Time Series model</p></a></li>
<li><a href='#package_TS_on_LDA'><p>Package the output of TS_on_LDA</p></a></li>
<li><a href='#plot.LDA_set'><p>Plot a set of LDATS LDA models</p></a></li>
<li><a href='#plot.LDA_TS'><p>Plot the key results from a full LDATS analysis</p></a></li>
<li><a href='#plot.LDA_VEM'><p>Plot the results of an LDATS LDA model</p></a></li>
<li><a href='#plot.TS_fit'><p>Plot an LDATS TS model</p></a></li>
<li><a href='#posterior_plot'><p>Produce the posterior distribution histogram panel for the TS</p>
diagnostic plot of a parameter</a></li>
<li><a href='#prep_chunks'><p>Prepare the time chunk table for a multinomial change point</p>
Time Series model</a></li>
<li><a href='#prep_cpts'><p>Initialize and update the change point matrix used in the ptMCMC</p>
algorithm</a></li>
<li><a href='#prep_ids'><p>Initialize and update the chain ids throughout the ptMCMC algorithm</p></a></li>
<li><a href='#prep_LDA_control'><p>Set the control inputs to include the seed</p></a></li>
<li><a href='#prep_pbar'><p>Initialize and tick through the progress bar</p></a></li>
<li><a href='#prep_proposal_dist'><p>Pre-calculate the change point proposal distribution for the ptMCMC</p>
algorithm</a></li>
<li><a href='#prep_ptMCMC_inputs'><p>Prepare the inputs for the ptMCMC algorithm estimation of</p>
change points</a></li>
<li><a href='#prep_saves'><p>Prepare and update the data structures to save the ptMCMC output</p></a></li>
<li><a href='#prep_temp_sequence'><p>Prepare the ptMCMC temperature sequence</p></a></li>
<li><a href='#prep_TS_data'><p>Prepare the model-specific data to be used in the TS analysis</p>
of LDA output</a></li>
<li><a href='#print_model_run_message'><p>Print the message to the console about which combination of the</p>
Time Series and LDA models is being run</a></li>
<li><a href='#print.LDA_TS'><p>Print the selected LDA and TS models of LDA_TS object</p></a></li>
<li><a href='#print.TS_fit'><p>Print a Time Series model fit</p></a></li>
<li><a href='#print.TS_on_LDA'><p>Print a set of Time Series models fit to LDAs</p></a></li>
<li><a href='#proposed_step_mods'><p>Fit the chunk-level models to a time series, given a set of</p>
proposed change points within the ptMCMC algorithm</a></li>
<li><a href='#rho_lines'><p>Add change point location lines to the time series plot</p></a></li>
<li><a href='#rodents'><p>Portal rodent data</p></a></li>
<li><a href='#select_LDA'><p>Select the best LDA model(s) for use in time series</p></a></li>
<li><a href='#select_TS'><p>Select the best Time Series model</p></a></li>
<li><a href='#set_gamma_colors'><p>Prepare the colors to be used in the gamma time series</p></a></li>
<li><a href='#set_LDA_plot_colors'><p>Prepare the colors to be used in the LDA plots</p></a></li>
<li><a href='#set_LDA_TS_plot_cols'><p>Create the list of colors for the LDATS summary plot</p></a></li>
<li><a href='#set_rho_hist_colors'><p>Prepare the colors to be used in the change point histogram</p></a></li>
<li><a href='#set_TS_summary_plot_cols'><p>Create the list of colors for the TS summary plot</p></a></li>
<li><a href='#sim_LDA_data'><p>Simulate LDA data from an LDA structure given parameters</p></a></li>
<li><a href='#sim_LDA_TS_data'><p>Simulate LDA_TS data from LDA and TS model structures and parameters</p></a></li>
<li><a href='#sim_TS_data'><p>Simulate TS data from a TS model structure given parameters</p></a></li>
<li><a href='#softmax'><p>Calculate the softmax of a vector or matrix of values</p></a></li>
<li><a href='#step_chains'><p>Conduct a within-chain step of the ptMCMC algorithm</p></a></li>
<li><a href='#summarize_etas'><p>Summarize the regressor (eta) distributions</p></a></li>
<li><a href='#summarize_rhos'><p>Summarize the rho distributions</p></a></li>
<li><a href='#swap_chains'><p>Conduct a set of among-chain swaps for the ptMCMC algorithm</p></a></li>
<li><a href='#trace_plot'><p>Produce the trace plot panel for the TS diagnostic plot of a</p>
parameter</a></li>
<li><a href='#TS'><p>Conduct a single multinomial Bayesian Time Series analysis</p></a></li>
<li><a href='#TS_control'><p>Create the controls list for the Time Series model</p></a></li>
<li><a href='#TS_diagnostics_plot'><p>Plot the diagnostics of the parameters fit in a TS model</p></a></li>
<li><a href='#TS_on_LDA'><p>Conduct a set of Time Series analyses on a set of LDA models</p></a></li>
<li><a href='#TS_summary_plot'><p>Create the summary plot for a TS fit to an LDA model</p></a></li>
<li><a href='#verify_changepoint_locations'><p>Verify the change points of a multinomial time series model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Latent Dirichlet Allocation Coupled with Time Series Analyses</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Combines Latent Dirichlet Allocation (LDA) and Bayesian multinomial time series methods in a two-stage analysis to quantify dynamics in high-dimensional temporal data. LDA decomposes multivariate data into lower-dimension latent groupings, whose relative proportions are modeled using generalized Bayesian time series models that include abrupt changepoints and smooth dynamics. The methods are described in Blei et al. (2003) &lt;<a href="https://doi.org/10.1162%2Fjmlr.2003.3.4-5.993">doi:10.1162/jmlr.2003.3.4-5.993</a>&gt;, Western and Kleykamp (2004) &lt;<a href="https://doi.org/10.1093%2Fpan%2Fmph023">doi:10.1093/pan/mph023</a>&gt;, Venables and Ripley (2002, ISBN-13:978-0387954578), and Christensen et al. (2018) &lt;<a href="https://doi.org/10.1002%2Fecy.2373">doi:10.1002/ecy.2373</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://weecology.github.io/LDATS/">https://weecology.github.io/LDATS/</a>,
<a href="https://github.com/weecology/LDATS">https://github.com/weecology/LDATS</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/weecology/LDATS/issues">https://github.com/weecology/LDATS/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>coda, digest, extraDistr, graphics, grDevices, lubridate,
magrittr, memoise, methods, mvtnorm, nnet, progress, stats,
topicmodels, viridis</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, pkgdown, rmarkdown, testthat, vdiffr</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>gsl</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-18 16:29:40 UTC; dappe</td>
</tr>
<tr>
<td>Author:</td>
<td>Juniper L. Simonis
    <a href="https://orcid.org/0000-0001-9798-0460"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Erica M. Christensen
    <a href="https://orcid.org/0000-0002-5635-2502"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  David J. Harris <a href="https://orcid.org/0000-0003-3332-9307"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Renata M. Diaz <a href="https://orcid.org/0000-0003-0803-4734"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Hao Ye <a href="https://orcid.org/0000-0002-8630-1458"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Ethan P. White <a href="https://orcid.org/0000-0001-6728-7745"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  S.K. Morgan Ernest
    <a href="https://orcid.org/0000-0002-6026-8530"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Weecology [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Juniper L. Simonis &lt;juniper.simonis@weecology.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-19 09:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='AICc'>Calculate AICc</h2><span id='topic+AICc'></span>

<h3>Description</h3>

<p>Calculate the small sample size correction of
<code><a href="stats.html#topic+AIC">AIC</a></code> for the input object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AICc(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AICc_+3A_object">object</code></td>
<td>
<p>An object for which <code><a href="stats.html#topic+AIC">AIC</a></code> and 
<code><a href="stats.html#topic+logLik">logLik</a></code> have defined methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>numeric</code> value of AICc.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  dat &lt;- data.frame(y = rnorm(50), x = rnorm(50))
  mod &lt;- lm(dat)
  AICc(mod)

</code></pre>

<hr>
<h2 id='autocorr_plot'>Produce the autocorrelation panel for the TS diagnostic plot of
a parameter</h2><span id='topic+autocorr_plot'></span>

<h3>Description</h3>

<p>Produce a vanilla ACF plot using <code><a href="stats.html#topic+acf">acf</a></code> for
the parameter of interest (rho or eta) as part of 
<code><a href="#topic+TS_diagnostics_plot">TS_diagnostics_plot</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autocorr_plot(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autocorr_plot_+3A_x">x</code></td>
<td>
<p>Vector of parameter values drawn from the posterior distribution,
indexed to the iteration by the order of the vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> autocorr_plot(rnorm(100, 0, 1))

</code></pre>

<hr>
<h2 id='check_changepoints'>Check that a set of change point locations is proper</h2><span id='topic+check_changepoints'></span>

<h3>Description</h3>

<p>Check that the change point locations are <code>numeric</code>
and conformable to <code>interger</code> values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_changepoints(changepoints = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_changepoints_+3A_changepoints">changepoints</code></td>
<td>
<p>Change point locations to evaluate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error message is thrown if <code>changepoints</code> are not proper,
else <code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  check_changepoints(100)

</code></pre>

<hr>
<h2 id='check_control'>Check that a control list is proper</h2><span id='topic+check_control'></span>

<h3>Description</h3>

<p>Check that a list of controls is of the right class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_control(control, eclass = "list")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_control_+3A_control">control</code></td>
<td>
<p>Control list to evaluate.</p>
</td></tr>
<tr><td><code id="check_control_+3A_eclass">eclass</code></td>
<td>
<p>Expected class of the list to be evaluated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an error message is thrown if the input is improper, otherwise 
<code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> check_control(list())

</code></pre>

<hr>
<h2 id='check_document_covariate_table'>Check that the document covariate table is proper</h2><span id='topic+check_document_covariate_table'></span>

<h3>Description</h3>

<p>Check that the table of document-level covariates is 
conformable to a data frame and of the right size (correct number of 
documents) for the document-topic output from the LDA models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_document_covariate_table(
  document_covariate_table,
  LDA_models = NULL,
  document_term_table = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_document_covariate_table_+3A_document_covariate_table">document_covariate_table</code></td>
<td>
<p>Document covariate table to evaluate.</p>
</td></tr>
<tr><td><code id="check_document_covariate_table_+3A_lda_models">LDA_models</code></td>
<td>
<p>Reference LDA model list (class <code>LDA_set</code>) that 
includes as its first element a properly fitted <code>LDA</code> model with 
a <code>gamma</code> slot with the document-topic distribution.</p>
</td></tr>
<tr><td><code id="check_document_covariate_table_+3A_document_term_table">document_term_table</code></td>
<td>
<p>Optional input for checking when
<code>LDA_models</code> is <code>NULL</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error message is thrown if <code>document_covariate_table</code> is 
not proper, else <code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(rodents)
  check_document_covariate_table(rodents$document_covariate_table)

</code></pre>

<hr>
<h2 id='check_document_term_table'>Check that document term table is proper</h2><span id='topic+check_document_term_table'></span>

<h3>Description</h3>

<p>Check that the table of observations is conformable to
a matrix of integers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_document_term_table(document_term_table)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_document_term_table_+3A_document_term_table">document_term_table</code></td>
<td>
<p>Table of observation count data (rows: 
documents, columns: terms. May be a class <code>matrix</code> or 
<code>data.frame</code> but must be conformable to a matrix of integers,
as verified by <code><a href="#topic+check_document_term_table">check_document_term_table</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an error message is thrown if the input is improper, otherwise 
<code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(rodents)
 check_document_term_table(rodents$document_term_table)

</code></pre>

<hr>
<h2 id='check_formula'>Check that a formula is proper</h2><span id='topic+check_formula'></span>

<h3>Description</h3>

<p>Check that <code>formula</code> is actually a 
<code><a href="stats.html#topic+formula">formula</a></code> and that the
response and predictor variables are all included in <code>data</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_formula(data, formula)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_formula_+3A_data">data</code></td>
<td>
<p><code>data.frame</code> including [1] the time variable (indicated 
in <code>timename</code>), [2] the predictor variables (required by
<code>formula</code>) and [3], the multinomial response variable (indicated in
<code>formula</code>) as verified by <code><a href="#topic+check_timename">check_timename</a></code> and 
<code><a href="#topic+check_formula">check_formula</a></code>. Note that the response variables should be
formatted as a <code>data.frame</code> object named as indicated by the 
<code>response</code> entry in the <code>control</code> list, such as <code>gamma</code> 
for a standard TS analysis on LDA output.</p>
</td></tr>
<tr><td><code id="check_formula_+3A_formula">formula</code></td>
<td>
<p><code>formula</code> to evaluate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error message is thrown if <code>formula</code> is not proper,
else <code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  check_formula(data, gamma ~ 1)

</code></pre>

<hr>
<h2 id='check_formulas'>Check that formulas vector is proper and append the response 
variable</h2><span id='topic+check_formulas'></span>

<h3>Description</h3>

<p>Check that the vector of formulas is actually formatted
as a vector of <code><a href="stats.html#topic+formula">formula</a></code> objects and that the 
predictor variables are all included in the document covariate table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_formulas(formulas, document_covariate_table, control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_formulas_+3A_formulas">formulas</code></td>
<td>
<p>Vector of the formulas to evaluate.</p>
</td></tr>
<tr><td><code id="check_formulas_+3A_document_covariate_table">document_covariate_table</code></td>
<td>
<p>Document covariate table used to evaluate
the availability of the data required by the formula inputs.</p>
</td></tr>
<tr><td><code id="check_formulas_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the fitting of the
Time Series model including the parallel tempering Markov Chain 
Monte Carlo (ptMCMC) controls. Values not input assume defaults set by 
<code><a href="#topic+TS_control">TS_control</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error message is thrown if <code>formulas</code> is 
not proper, else <code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(rodents)
  check_formulas(~ 1, rodents$document_covariate_table)

</code></pre>

<hr>
<h2 id='check_LDA_models'>Check that LDA model input is proper</h2><span id='topic+check_LDA_models'></span>

<h3>Description</h3>

<p>Check that the <code>LDA_models</code> input is either a set of 
LDA models (class <code>LDA_set</code>, produced by
<code><a href="#topic+LDA_set">LDA_set</a></code>) or a singular LDA model (class <code>LDA</code>,
produced by <code><a href="topicmodels.html#topic+LDA">LDA</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_LDA_models(LDA_models)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_LDA_models_+3A_lda_models">LDA_models</code></td>
<td>
<p>List of LDA models or singular LDA model to evaluate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error message is thrown if <code>LDA_models</code> is not proper,
else <code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDAs &lt;- LDA_set(document_term_table, topics = 2, nseeds = 1)
  LDA_models &lt;- select_LDA(LDAs)
  check_LDA_models(LDA_models)

</code></pre>

<hr>
<h2 id='check_nchangepoints'>Check that nchangepoints vector is proper</h2><span id='topic+check_nchangepoints'></span>

<h3>Description</h3>

<p>Check that the vector of numbers of changepoints is 
conformable to integers greater than 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_nchangepoints(nchangepoints)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_nchangepoints_+3A_nchangepoints">nchangepoints</code></td>
<td>
<p>Vector of the number of changepoints to evaluate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error message is thrown if <code>nchangepoints</code> is not proper,
else <code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  check_nchangepoints(0)
  check_nchangepoints(2)

</code></pre>

<hr>
<h2 id='check_seeds'>Check that nseeds value or seeds vector is proper</h2><span id='topic+check_seeds'></span>

<h3>Description</h3>

<p>Check that the vector of numbers of seeds is conformable to
integers greater than 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_seeds(nseeds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_seeds_+3A_nseeds">nseeds</code></td>
<td>
<p><code>integer</code> number of seeds (replicate starts) to use for 
each value of <code>topics</code> in the LDAs. Must be conformable to a  
positive <code>integer</code> value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an error message is thrown if the input is improper, otherwise 
<code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> check_seeds(1)
 check_seeds(2)

</code></pre>

<hr>
<h2 id='check_timename'>Check that the time vector is proper</h2><span id='topic+check_timename'></span>

<h3>Description</h3>

<p>Check that the vector of time values is included in the 
document covariate table and that it is either a integer-conformable or
a <code>date</code>. If it is a <code>date</code>, the input is converted to an 
integer, resulting in the timestep being 1 day, which is often not 
desired behavior.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_timename(document_covariate_table, timename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_timename_+3A_document_covariate_table">document_covariate_table</code></td>
<td>
<p>Document covariate table used to query
for the time column.</p>
</td></tr>
<tr><td><code id="check_timename_+3A_timename">timename</code></td>
<td>
<p>Column name for the time variable to evaluate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error message is thrown if <code>timename</code> is 
not proper, else <code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(rodents)
  check_timename(rodents$document_covariate_table, "newmoon")

</code></pre>

<hr>
<h2 id='check_topics'>Check that topics vector is proper</h2><span id='topic+check_topics'></span>

<h3>Description</h3>

<p>Check that the vector of numbers of topics is conformable to
integers greater than 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_topics(topics)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_topics_+3A_topics">topics</code></td>
<td>
<p>Vector of the number of topics to evaluate for each model.
Must be conformable to <code>integer</code> values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an error message is thrown if the input is improper, otherwise 
<code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> check_topics(2)

</code></pre>

<hr>
<h2 id='check_weights'>Check that weights vector is proper</h2><span id='topic+check_weights'></span>

<h3>Description</h3>

<p>Check that the vector of document weights is numeric and 
positive and inform the user if the average weight isn't 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_weights(weights)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_weights_+3A_weights">weights</code></td>
<td>
<p>Vector of the document weights to evaluate, or <code>TRUE</code>
for triggering internal weighting by document sizes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error message is thrown if <code>weights</code> is not proper,
else <code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  check_weights(1)
  wts &lt;- runif(100, 0.1, 100)
  check_weights(wts)
  wts2 &lt;- wts / mean(wts)
  check_weights(wts2)
  check_weights(TRUE)

</code></pre>

<hr>
<h2 id='count_trips'>Count trips of the ptMCMC particles</h2><span id='topic+count_trips'></span>

<h3>Description</h3>

<p>Count the full trips (from one extreme temperature chain to
the other and back again; Katzgraber <em>et al.</em> 2006) for each of the
ptMCMC particles, as identified by their id on initialization.
<br /> <br />
This function was designed to work within <code><a href="#topic+TS">TS</a></code> and process
the output of <code><a href="#topic+est_changepoints">est_changepoints</a></code> as a component of 
<code><a href="#topic+diagnose_ptMCMC">diagnose_ptMCMC</a></code>, but has been generalized
and would work with any output from a ptMCMC as long as <code>ids</code>
is formatted properly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>count_trips(ids)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="count_trips_+3A_ids">ids</code></td>
<td>
<p><code>matrix</code> of identifiers of the particles in each chain for 
each iteration of the ptMCMC algorithm (rows: chains, 
columns: iterations).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>list</code> of [1] <code>vector</code> of within particle trip counts 
(<code>$trip_counts</code>), and [2] <code>vector</code> of within-particle average 
trip rates (<code>$trip_rates</code>).
</p>


<h3>References</h3>

<p>Katzgraber, H. G., S. Trebst, D. A. Huse. And M. Troyer. 2006. 
Feedback-optimized parallel tempering Monte Carlo. <em>Journal of 
Statistical Mechanics: Theory and Experiment</em> <strong>3</strong>:P03018
<a href="https://iopscience.iop.org/article/10.1088/1742-5468/2006/03/P03018">link</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  weights &lt;- document_weights(document_term_table)
  data &lt;- data[order(data[,"newmoon"]), ]
  rho_dist &lt;- est_changepoints(data, gamma ~ 1, 1, "newmoon", weights,
                               TS_control())
  count_trips(rho_dist$ids)


</code></pre>

<hr>
<h2 id='diagnose_ptMCMC'>Calculate ptMCMC summary diagnostics</h2><span id='topic+diagnose_ptMCMC'></span>

<h3>Description</h3>

<p>Summarize the step and swap acceptance rates as well as trip
metrics from the saved output of a ptMCMC estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diagnose_ptMCMC(ptMCMCout)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diagnose_ptMCMC_+3A_ptmcmcout">ptMCMCout</code></td>
<td>
<p>Named <code>list</code> of saved data objects from a ptMCMC 
estimation including elements named <code>step_accepts</code> (matrix of 
<code>logical</code> outcomes of each step; rows: chains, columns: iterations),
<code>swap_accepts</code> (matrix of <code>logical</code> outcomes of each swap;
rows: chain pairs, columns: iterations), and <code>ids</code> (matrix of 
particle identifiers; rows: chains, columns: iterations). 
<code>ptMCMCout = NULL</code> indicates no use of ptMCMC and so the function
returns <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Within-chain step acceptance rates are averaged for each of the
chains from the raw step acceptance histories 
(<code>ptMCMCout$step_accepts</code>) and between-chain swap acceptance rates
are similarly averaged for each of the neighboring pairs of chains from
the raw swap acceptance histories (<code>ptMCMCout$swap_accepts</code>).
Trips are defined as movement from one extreme chain to the other and
back again (Katzgraber <em>et al.</em> 2006). Trips are counted and turned 
to per-iteration rates using <code><a href="#topic+count_trips">count_trips</a></code>.
<br /> <br /> 
This function was first designed to work within <code><a href="#topic+TS">TS</a></code> and 
process the output of <code><a href="#topic+est_changepoints">est_changepoints</a></code>, but has been 
generalized and would work with any output from a ptMCMC as long as 
<code>ptMCMCout</code> is formatted properly.
</p>


<h3>Value</h3>

<p><code>list</code> of [1] within-chain average step acceptance rates 
(<code>$step_acceptance_rate</code>), [2] average between-chain swap acceptance
rates (<code>$swap_acceptance_rate</code>), [3] within particle trip counts 
(<code>$trip_counts</code>), and [4] within-particle average trip rates 
(<code>$trip_rates</code>).
</p>


<h3>References</h3>

<p>Katzgraber, H. G., S. Trebst, D. A. Huse. And M. Troyer. 2006. 
Feedback-optimized parallel tempering Monte Carlo. <em>Journal of 
Statistical Mechanics: Theory and Experiment</em> <strong>3</strong>:P03018
<a href="https://iopscience.iop.org/article/10.1088/1742-5468/2006/03/P03018">link</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  weights &lt;- document_weights(document_term_table)
  data &lt;- data[order(data[,"newmoon"]), ]
  rho_dist &lt;- est_changepoints(data, gamma ~ 1, 1, "newmoon", 
                               weights, TS_control())
  diagnose_ptMCMC(rho_dist)


</code></pre>

<hr>
<h2 id='document_weights'>Calculate document weights for a corpus</h2><span id='topic+document_weights'></span>

<h3>Description</h3>

<p>Simple calculation of document weights based on the average
number of words in a document within the corpus (mean value = 1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>document_weights(document_term_table)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="document_weights_+3A_document_term_table">document_term_table</code></td>
<td>
<p>Table of observation count data (rows: 
documents, columns: terms. May be a class <code>matrix</code> or 
<code>data.frame</code> but must be conformable to a matrix of integers,
as verified by <code><a href="#topic+check_document_term_table">check_document_term_table</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of weights, one for each document, with the average sample
receiving a weight of 1.0.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(rodents)
 document_weights(rodents$document_term_table)

</code></pre>

<hr>
<h2 id='ecdf_plot'>Produce the posterior distribution ECDF panel for the TS 
diagnostic plot of a parameter</h2><span id='topic+ecdf_plot'></span>

<h3>Description</h3>

<p>Produce a vanilla ECDF (empirical cumulative distribution
function) plot using <code>ecdf</code> for the parameter of interest (rho or 
eta) as part of <code><a href="#topic+TS_diagnostics_plot">TS_diagnostics_plot</a></code>. A horizontal line 
is added to show the median of the posterior.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecdf_plot(x, xlab = "parameter value")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecdf_plot_+3A_x">x</code></td>
<td>
<p>Vector of parameter values drawn from the posterior distribution,
indexed to the iteration by the order of the vector.</p>
</td></tr>
<tr><td><code id="ecdf_plot_+3A_xlab">xlab</code></td>
<td>
<p><code>character</code> value used to label the x axis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ecdf_plot(rnorm(100, 0, 1))

</code></pre>

<hr>
<h2 id='est_changepoints'>Use ptMCMC to estimate the distribution of change point locations</h2><span id='topic+est_changepoints'></span>

<h3>Description</h3>

<p>This function executes ptMCMC-based estimation of the 
change point location distributions for multinomial Time Series analyses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_changepoints(
  data,
  formula,
  nchangepoints,
  timename,
  weights,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_changepoints_+3A_data">data</code></td>
<td>
<p><code>data.frame</code> including [1] the time variable (indicated 
in <code>timename</code>), [2] the predictor variables (required by
<code>formula</code>) and [3], the multinomial response variable (indicated in
<code>formula</code>) as verified by <code><a href="#topic+check_timename">check_timename</a></code> and 
<code><a href="#topic+check_formula">check_formula</a></code>. Note that the response variables should be
formatted as a <code>data.frame</code> object named as indicated by the 
<code>response</code> entry in the <code>control</code> list, such as <code>gamma</code> 
for a standard TS analysis on LDA output.</p>
</td></tr>
<tr><td><code id="est_changepoints_+3A_formula">formula</code></td>
<td>
<p><code><a href="stats.html#topic+formula">formula</a></code> defining the regression between
relationship the change points. Any 
predictor variable included must also be a column in 
<code>data</code> and any (multinomial) response variable must be a set of
columns in <code>data</code>, as verified by <code><a href="#topic+check_formula">check_formula</a></code>.</p>
</td></tr>
<tr><td><code id="est_changepoints_+3A_nchangepoints">nchangepoints</code></td>
<td>
<p><code>integer</code> corresponding to the number of 
change points to include in the model. 0 is a valid input (corresponding
to no change points, so a singular time series model), and the current 
implementation can reasonably include up to 6 change points. The 
number of change points is used to dictate the segmentation of the 
time series into chunks fit with separate models dictated by 
<code>formula</code>.</p>
</td></tr>
<tr><td><code id="est_changepoints_+3A_timename">timename</code></td>
<td>
<p><code>character</code> element indicating the time variable
used in the time series.</p>
</td></tr>
<tr><td><code id="est_changepoints_+3A_weights">weights</code></td>
<td>
<p>Optional class <code>numeric</code> vector of weights for each 
document. Defaults to <code>NULL</code>, translating to an equal weight for
each document. When using <code>multinom_TS</code> in a standard LDATS 
analysis, it is advisable to weight the documents by their total size,
as the result of <code><a href="topicmodels.html#topic+LDA">LDA</a></code> is a matrix of 
proportions, which does not account for size differences among documents.
For most models, a scaling of the weights (so that the average is 1) is
most appropriate, and this is accomplished using <code>document_weights</code>.</p>
</td></tr>
<tr><td><code id="est_changepoints_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the fitting of the
Time Series model including the parallel tempering Markov Chain 
Monte Carlo (ptMCMC) controls. Values not input assume defaults set by 
<code><a href="#topic+TS_control">TS_control</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of saved data objects from the ptMCMC estimation of
change point locations (unless <code>nchangepoints</code> is 0, then 
<code>NULL</code> is returned).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  weights &lt;- document_weights(document_term_table)
  formula &lt;- gamma ~ 1
  nchangepoints &lt;- 1
  control &lt;- TS_control()
  data &lt;- data[order(data[,"newmoon"]), ]
  rho_dist &lt;- est_changepoints(data, formula, nchangepoints, "newmoon", 
                               weights, control)


</code></pre>

<hr>
<h2 id='est_regressors'>Estimate the distribution of regressors, unconditional on the
change point locations</h2><span id='topic+est_regressors'></span>

<h3>Description</h3>

<p>This function uses the marginal posterior distributions of
the change point locations (estimated by <code><a href="#topic+est_changepoints">est_changepoints</a></code>)
in combination with the conditional (on the change point locations) 
posterior distributions of the regressors (estimated by
<code><a href="#topic+multinom_TS">multinom_TS</a></code>) to estimate the marginal posterior 
distribution of the regressors, unconditional on the change point 
locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_regressors(rho_dist, data, formula, timename, weights, control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_regressors_+3A_rho_dist">rho_dist</code></td>
<td>
<p>List of saved data objects from the ptMCMC estimation of
change point locations (unless <code>nchangepoints</code> is 0, then 
<code>NULL</code>) returned from <code><a href="#topic+est_changepoints">est_changepoints</a></code>.</p>
</td></tr>
<tr><td><code id="est_regressors_+3A_data">data</code></td>
<td>
<p><code>data.frame</code> including [1] the time variable (indicated 
in <code>timename</code>), [2] the predictor variables (required by
<code>formula</code>) and [3], the multinomial response variable (indicated in
<code>formula</code>) as verified by <code><a href="#topic+check_timename">check_timename</a></code> and 
<code><a href="#topic+check_formula">check_formula</a></code>. Note that the response variables should be
formatted as a <code>data.frame</code> object named as indicated by the 
<code>response</code> entry in the <code>control</code> list, such as <code>gamma</code> 
for a standard TS analysis on LDA output.</p>
</td></tr>
<tr><td><code id="est_regressors_+3A_formula">formula</code></td>
<td>
<p><code><a href="stats.html#topic+formula">formula</a></code> defining the regression between
relationship the change points. Any 
predictor variable included must also be a column in 
<code>data</code> and any (multinomial) response variable must be a set of
columns in <code>data</code>, as verified by <code><a href="#topic+check_formula">check_formula</a></code>.</p>
</td></tr>
<tr><td><code id="est_regressors_+3A_timename">timename</code></td>
<td>
<p><code>character</code> element indicating the time variable
used in the time series.</p>
</td></tr>
<tr><td><code id="est_regressors_+3A_weights">weights</code></td>
<td>
<p>Optional class <code>numeric</code> vector of weights for each 
document. Defaults to <code>NULL</code>, translating to an equal weight for
each document. When using <code>multinom_TS</code> in a standard LDATS 
analysis, it is advisable to weight the documents by their total size,
as the result of <code><a href="topicmodels.html#topic+LDA">LDA</a></code> is a matrix of 
proportions, which does not account for size differences among documents.
For most models, a scaling of the weights (so that the average is 1) is
most appropriate, and this is accomplished using <code>document_weights</code>.</p>
</td></tr>
<tr><td><code id="est_regressors_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the fitting of the
Time Series model including the parallel tempering Markov Chain 
Monte Carlo (ptMCMC) controls. Values not input assume defaults set by 
<code><a href="#topic+TS_control">TS_control</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The general approach follows that of Western and Kleykamp
(2004), although we note some important differences. Our regression
models are fit independently for each chunk (segment of time), and 
therefore the variance-covariance matrix for the full model 
has <code>0</code> entries for covariances between regressors in different
chunks of the time series. Further, because the regression model here
is a standard (non-hierarchical) softmax (Ripley 1996, Venables and 
Ripley 2002, Bishop 2006), there is no error term in the regression  
(as there is in the normal model used by Western and Kleykamp 2004), 
and so the posterior distribution used here is a multivariate normal,
as opposed to a multivariate t, as used by Western and Kleykamp (2004).
</p>


<h3>Value</h3>

<p><code>matrix</code> of draws (rows) from the marginal posteriors of the 
coefficients across the segments (columns).
</p>


<h3>References</h3>

<p>Bishop, C. M. 2006. <em>Pattern Recognition and Machine Learning</em>. 
Springer, New York, NY, USA.
</p>
<p>Ripley, B. D. 1996. <em>Pattern Recognition and Neural Networks</em>. 
Cambridge University Press, Cambridge, UK.
</p>
<p>Venables, W. N. and B. D. Ripley. 2002. <em>Modern and Applied
Statistics with S</em>. Fourth Edition. Springer, New York, NY, USA.
</p>
<p>Western, B. and M. Kleykamp. 2004. A Bayesian change point model for 
historical time series analysis. <em>Political Analysis</em>
<strong>12</strong>:354-374.
<a href="https://www.cambridge.org/core/journals/political-analysis/article/abs/bayesian-change-point-model-for-historical-time-series-analysis/F7D2EDBBC211278EC6C6CB43FE170812">link</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  weights &lt;- document_weights(document_term_table)
  formula &lt;- gamma ~ 1
  nchangepoints &lt;- 1
  control &lt;- TS_control()
  data &lt;- data[order(data[,"newmoon"]), ]
  rho_dist &lt;- est_changepoints(data, formula, nchangepoints, "newmoon", 
                               weights, control)
  eta_dist &lt;- est_regressors(rho_dist, data, formula, "newmoon", weights, 
                             control)


</code></pre>

<hr>
<h2 id='expand_TS'>Expand the TS models across the factorial combination of
LDA models, formulas, and number of change points</h2><span id='topic+expand_TS'></span>

<h3>Description</h3>

<p>Expand the completely crossed combination of model inputs: 
LDA model results, formulas, and number of change points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expand_TS(LDA_models, formulas, nchangepoints)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expand_TS_+3A_lda_models">LDA_models</code></td>
<td>
<p>List of LDA models (class <code>LDA_set</code>, produced by
<code><a href="#topic+LDA_set">LDA_set</a></code>) or a singular LDA model (class <code>LDA</code>,
produced by <code><a href="topicmodels.html#topic+LDA">LDA</a></code>).</p>
</td></tr>
<tr><td><code id="expand_TS_+3A_formulas">formulas</code></td>
<td>
<p>Vector of <code><a href="stats.html#topic+formula">formula</a></code>(s) for the 
continuous (non-change point) component of the time series models. Any 
predictor variable included in a formula must also be a column in the
<code>document_covariate_table</code>. Each element (formula) in the vector
is evaluated for each number of change points and each LDA model.</p>
</td></tr>
<tr><td><code id="expand_TS_+3A_nchangepoints">nchangepoints</code></td>
<td>
<p>Vector of <code>integer</code>s corresponding to the number 
of change points to include in the time series models. 0 is a valid input 
corresponding to no change points (<em>i.e.</em>, a singular time series
model), and the current implementation can reasonably include up to 6 
change points. Each element in the vector is the number of change points 
used to segment the data for each formula (entry in <code>formulas</code>) 
component of the TS model, for each selected LDA model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Expanded <code>data.frame</code> table of the three values (columns) for
each unique model run (rows): [1] the LDA model (indicated
as a numeric element reference to the <code>LDA_models</code> object), [2] the 
regressor formula, and [3] the number of changepoints.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDAs &lt;- LDA_set(document_term_table, topics = 2:3, nseeds = 2)
  LDA_models &lt;- select_LDA(LDAs)
  weights &lt;- document_weights(document_term_table)
  formulas &lt;- c(~ 1, ~ newmoon)
  nchangepoints &lt;- 0:1
  expand_TS(LDA_models, formulas, nchangepoints)


</code></pre>

<hr>
<h2 id='iftrue'>Replace if TRUE</h2><span id='topic+iftrue'></span>

<h3>Description</h3>

<p>If the focal input is <code>TRUE</code>, replace it with 
alternative.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iftrue(x = TRUE, alt = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iftrue_+3A_x">x</code></td>
<td>
<p>Focal input.</p>
</td></tr>
<tr><td><code id="iftrue_+3A_alt">alt</code></td>
<td>
<p>Alternative value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>x</code> if not <code>TRUE</code>, <code>alt</code> otherwise.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> iftrue()
 iftrue(TRUE, 1)
 iftrue(2, 1)
 iftrue(FALSE, 1)

</code></pre>

<hr>
<h2 id='jornada'>Jornada rodent data</h2><span id='topic+jornada'></span>

<h3>Description</h3>

<p>Counts of 17 rodent species across 24 sampling events, 
with the count being the total number observed across three trapping webs
(146 traps in total) (Lightfoot <em>et al.</em> 2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jornada
</code></pre>


<h3>Format</h3>

<p>A <code>list</code> of two <code>data.frame</code>-class objects with rows 
corresponding to documents (sampling events). One element is the
document term table (called <code>document_term_table</code>), which contains
counts of the species (terms) in each sample (document), and the other is
the document covariate table (called <code>document_covariate_table</code>) 
with columns of covariates (time step, year, season).
</p>


<h3>Source</h3>

<p><a href="https://lter.jornada.nmsu.edu/data-catalog/">https://lter.jornada.nmsu.edu/data-catalog/</a>
</p>


<h3>References</h3>

<p>Lightfoot, D. C., A. D. Davidson, D. G. Parker, L. Hernandez, and J. W. 
Laundre. 2012. Bottom-up regulation of desert grassland and shrubland 
rodent communities: implications of species-specific reproductive
potentials. <em>Journal of Mammalogy</em> <strong>93</strong>:1017-1028.
<a href="https://academic.oup.com/jmammal/article/93/4/1017/957927">link</a>.
</p>

<hr>
<h2 id='LDA_msg'>Create the model-running-message for an LDA</h2><span id='topic+LDA_msg'></span>

<h3>Description</h3>

<p>Produce and print the message for a given LDA model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LDA_msg(mod_topics, mod_seeds, control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LDA_msg_+3A_mod_topics">mod_topics</code></td>
<td>
<p><code>integer</code> value corresponding to the number of 
topics in the model.</p>
</td></tr>
<tr><td><code id="LDA_msg_+3A_mod_seeds">mod_seeds</code></td>
<td>
<p><code>integer</code> value corresponding to the seed used for 
the model.</p>
</td></tr>
<tr><td><code id="LDA_msg_+3A_control">control</code></td>
<td>
<p>Class <code>LDA_controls</code> list of control parameters to be
used in <code>LDA</code> (note that &quot;seed&quot; will be overwritten).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>  LDA_msg(mod_topics = 4, mod_seeds = 2)

</code></pre>

<hr>
<h2 id='LDA_set'>Run a set of Latent Dirichlet Allocation models</h2><span id='topic+LDA_set'></span><span id='topic+check_LDA_set_inputs'></span>

<h3>Description</h3>

<p>For a given dataset consisting of counts of words across 
multiple documents in a corpus, conduct multiple Latent Dirichlet 
Allocation (LDA) models (using the Variational Expectation 
Maximization (VEM) algorithm; Blei <em>et al.</em> 2003) to account for [1]  
uncertainty in the number of latent topics and [2] the impact of initial
values in the estimation procedure. <br /> <br />
<code>LDA_set</code> is a list wrapper of <code><a href="topicmodels.html#topic+LDA">LDA</a></code>
in the <code>topicmodels</code> package (Grun and Hornik 2011). <br /> <br />
<code>check_LDA_set_inputs</code> checks that all of the inputs 
are proper for <code>LDA_set</code> (that the table of observations is 
conformable to a matrix of integers, the number of topics is an integer, 
the number of seeds is an integer and the controls list is proper).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LDA_set(document_term_table, topics = 2, nseeds = 1, control = list())

check_LDA_set_inputs(document_term_table, topics, nseeds, control)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LDA_set_+3A_document_term_table">document_term_table</code></td>
<td>
<p>Table of observation count data (rows: 
documents, columns: terms. May be a class <code>matrix</code> or 
<code>data.frame</code> but must be conformable to a matrix of integers,
as verified by <code><a href="#topic+check_document_term_table">check_document_term_table</a></code>.</p>
</td></tr>
<tr><td><code id="LDA_set_+3A_topics">topics</code></td>
<td>
<p>Vector of the number of topics to evaluate for each model.
Must be conformable to <code>integer</code> values.</p>
</td></tr>
<tr><td><code id="LDA_set_+3A_nseeds">nseeds</code></td>
<td>
<p>Number of seeds (replicate starts) to use for each 
value of <code>topics</code>. Must be conformable to <code>integer</code> value.</p>
</td></tr>
<tr><td><code id="LDA_set_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the running and 
selecting of LDA models. Values not input assume default values set 
by <code><a href="#topic+LDA_set_control">LDA_set_control</a></code>. Values for running the LDAs replace 
defaults in (<code>LDAcontol</code>, see <code><a href="topicmodels.html#topic+LDA">LDA</a></code> (but if
<code>seed</code> is given, it will be overwritten; use <code>iseed</code> instead).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>LDA_set</code>: <code>list</code> (class: <code>LDA_set</code>) of LDA models 
(class: <code>LDA_VEM</code>).
<code>check_LDA_set_inputs</code>: an error message is thrown if any input is 
improper, otherwise <code>NULL</code>.
</p>


<h3>References</h3>

<p>Blei, D. M., A. Y. Ng, and M. I. Jordan. 2003. Latent Dirichlet
Allocation. <em>Journal of Machine Learning Research</em> 
<strong>3</strong>:993-1022.
<a href="https://jmlr.csail.mit.edu/papers/v3/blei03a.html">link</a>.
</p>
<p>Grun B. and K. Hornik. 2011. topicmodels: An R Package for Fitting Topic
Models. <em>Journal of Statistical Software</em> <strong>40</strong>:13.
<a href="https://www.jstatsoft.org/article/view/v040i13">link</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(rodents)
  lda_data &lt;- rodents$document_term_table
  r_LDA &lt;- LDA_set(lda_data, topics = 2, nseeds = 2)                         

</code></pre>

<hr>
<h2 id='LDA_set_control'>Create control list for set of LDA models</h2><span id='topic+LDA_set_control'></span>

<h3>Description</h3>

<p>This function provides a simple creation and definition of 
the list used to control the set of LDA models. It is set up to be easy
to work with the existing control capacity of 
<code><a href="topicmodels.html#topic+LDA">LDA</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LDA_set_control(quiet = FALSE, measurer = AIC, selector = min, iseed = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LDA_set_control_+3A_quiet">quiet</code></td>
<td>
<p><code>logical</code> indicator of whether the model should run 
quietly.</p>
</td></tr>
<tr><td><code id="LDA_set_control_+3A_measurer">measurer</code>, <code id="LDA_set_control_+3A_selector">selector</code></td>
<td>
<p>Function names for use in evaluation of the LDA
models. <code>measurer</code> is used to create a value for each model
and <code>selector</code> operates on the values to choose the model(s) to 
pass on.</p>
</td></tr>
<tr><td><code id="LDA_set_control_+3A_iseed">iseed</code></td>
<td>
<p><code>integer</code> initial seed for the model set.</p>
</td></tr>
<tr><td><code id="LDA_set_control_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to 
<code><a href="topicmodels.html#topic+LDA">LDA</a></code> as a <code>control</code> input.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>list</code> for controlling the LDA model fit.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  LDA_set_control()

</code></pre>

<hr>
<h2 id='LDA_TS'>Run a full set of Latent Dirichlet Allocations and Time 
Series models</h2><span id='topic+LDA_TS'></span><span id='topic+conform_LDA_TS_data'></span><span id='topic+check_LDA_TS_inputs'></span>

<h3>Description</h3>

<p>Conduct a complete LDATS analysis (Christensen 
<em>et al.</em> 2018), including running a suite of Latent Dirichlet
Allocation (LDA) models (Blei <em>et al.</em> 2003, Grun and Hornik 2011) 
via <code><a href="#topic+LDA_set">LDA_set</a></code>, selecting LDA model(s) via 
<code><a href="#topic+select_LDA">select_LDA</a></code>, running a complete set of Bayesian Time Series
(TS) models (Western and Kleykamp 2004) via <code><a href="#topic+TS_on_LDA">TS_on_LDA</a></code> on
the chosen LDA model(s), and selecting the best TS model via 
<code><a href="#topic+select_TS">select_TS</a></code>. <br /> <br />
<code>conform_LDA_TS_data</code> converts the <code>data</code> input to
match internal and sub-function specifications. <br /> <br />
<code>check_LDA_TS_inputs</code> checks that the inputs to 
<code>LDA_TS</code> are of proper classes for a full analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LDA_TS(
  data,
  topics = 2,
  nseeds = 1,
  formulas = ~1,
  nchangepoints = 0,
  timename = "time",
  weights = TRUE,
  control = list()
)

conform_LDA_TS_data(data, quiet = FALSE)

check_LDA_TS_inputs(
  data = NULL,
  topics = 2,
  nseeds = 1,
  formulas = ~1,
  nchangepoints = 0,
  timename = "time",
  weights = TRUE,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LDA_TS_+3A_data">data</code></td>
<td>
<p>Either a document term table or a list including at least
a document term table (with the word &quot;term&quot; in the name of the element)
and optionally also a document covariate table  (with the word 
&quot;covariate&quot; in the name of the element). 
<br /> <br /> 
The document term table is a table of observation count data (rows: 
documents, columns: terms) that may be a <code>matrix</code> or 
<code>data.frame</code>, but must be conformable to a matrix of integers,
as verified by <code><a href="#topic+check_document_term_table">check_document_term_table</a></code>.   
<br /> <br />
The document covariate table is a table of associated data (rows: 
documents, columns: time index and covariate options) that may be a
<code>matrix</code> or <code>data.frame</code>, but must be a conformable to a data 
table, as verified by <code><a href="#topic+check_document_covariate_table">check_document_covariate_table</a></code>. Every 
model needs a covariate to describe the time value for each document 
(in whatever units and whose name in the table is input in 
<code>timename</code>) that dictates the application of the change points. 
<strong><em>If a covariate table is not provided, the model assumes the 
observations were equi-spaced in time</em></strong>. All covariates named within 
specific models in <code>formulas</code> must be included.</p>
</td></tr>
<tr><td><code id="LDA_TS_+3A_topics">topics</code></td>
<td>
<p>Vector of the number of topics to evaluate for each model.
Must be conformable to <code>integer</code> values.</p>
</td></tr>
<tr><td><code id="LDA_TS_+3A_nseeds">nseeds</code></td>
<td>
<p><code>integer</code> number of seeds (replicate starts) to use for 
each value of <code>topics</code> in the LDAs. Must be conformable to 
<code>integer</code> value.</p>
</td></tr>
<tr><td><code id="LDA_TS_+3A_formulas">formulas</code></td>
<td>
<p>Vector of <code><a href="stats.html#topic+formula">formula</a></code>(s) for the 
continuous (non-change point) component of the time series models. Any 
predictor variable included in a formula must also be a column in the
<code>document_covariate_table</code>. Each element (formula) in the vector
is evaluated for each number of change points and each LDA model.</p>
</td></tr>
<tr><td><code id="LDA_TS_+3A_nchangepoints">nchangepoints</code></td>
<td>
<p>Vector of <code>integer</code>s corresponding to the number 
of change points to include in the time series models. 0 is a valid input 
corresponding to no change points (<em>i.e.</em>, a singular time series
model), and the current implementation can reasonably include up to 6 
change points. Each element in the vector is the number of change points 
used to segment the data for each formula (entry in <code>formulas</code>) 
component of the TS model, for each selected LDA model.</p>
</td></tr>
<tr><td><code id="LDA_TS_+3A_timename">timename</code></td>
<td>
<p><code>character</code> element indicating the time variable
used in the time series. Defaults to <code>"time"</code>. The variable must be
integer-conformable or a <code>Date</code>. If the variable named
is a <code>Date</code>, the input is converted to an integer, resulting in the
timestep being 1 day, which is often not desired behavior.</p>
</td></tr>
<tr><td><code id="LDA_TS_+3A_weights">weights</code></td>
<td>
<p>Optional input for overriding standard weighting for 
documents in the time series. Defaults to <code>TRUE</code>,
translating to an appropriate weighting of the documents
based on the size (number of words) each document (the result of 
<code><a href="topicmodels.html#topic+LDA">LDA</a></code> is a matrix of proportions, which does not
account for size differences among documents. Alternatively can be 
<code>NULL</code> for an equal weighting among documents or a <code>numeric</code>
vector.</p>
</td></tr>
<tr><td><code id="LDA_TS_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the running and 
selecting of LDA and TS models. Values not input assume default values 
set by <code><a href="#topic+LDA_TS_control">LDA_TS_control</a></code>.</p>
</td></tr>
<tr><td><code id="LDA_TS_+3A_quiet">quiet</code></td>
<td>
<p><code>logical</code> indicator for <code>conform_LDA_TS_data</code> to 
indicate if messages should be printed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>LDA_TS</code>: a class <code>LDA_TS</code> list object including all 
fitted LDA and TS models and selected models specifically as elements 
<code>"LDA models"</code> (from <code><a href="#topic+LDA_set">LDA_set</a></code>),
<code>"Selected LDA model"</code> (from <code><a href="#topic+select_LDA">select_LDA</a></code>), 
<code>"TS models"</code> (from <code><a href="#topic+TS_on_LDA">TS_on_LDA</a></code>), and
<code>"Selected TS model"</code> (from <code><a href="#topic+select_TS">select_TS</a></code>). <br /> <br />
<code>conform_LDA_TS_data</code>: a data <code>list</code> that is ready for analyses 
using the stage-specific functions. <br /> <br />
<code>check_LDA_TS_inputs</code>: an error message is thrown if any input is 
improper, otherwise <code>NULL</code>.
</p>


<h3>References</h3>

<p>Blei, D. M., A. Y. Ng, and M. I. Jordan. 2003. Latent Dirichlet
Allocation. <em>Journal of Machine Learning Research</em> 
<strong>3</strong>:993-1022.
<a href="https://jmlr.csail.mit.edu/papers/v3/blei03a.html">link</a>.
</p>
<p>Christensen, E., D. J. Harris, and S. K. M. Ernest. 2018.
Long-term community change through multiple rapid transitions in a 
desert rodent community. <em>Ecology</em> <strong>99</strong>:1523-1529. 
<a href="https://pubmed.ncbi.nlm.nih.gov/29718539/">link</a>.
</p>
<p>Grun B. and K. Hornik. 2011. topicmodels: An R Package for Fitting Topic
Models. <em>Journal of Statistical Software</em> <strong>40</strong>:13.
<a href="https://www.jstatsoft.org/article/view/v040i13">link</a>.
</p>
<p>Western, B. and M. Kleykamp. 2004. A Bayesian change point model for 
historical time series analysis. <em>Political Analysis</em>
<strong>12</strong>:354-374.
<a href="https://www.cambridge.org/core/journals/political-analysis/article/abs/bayesian-change-point-model-for-historical-time-series-analysis/F7D2EDBBC211278EC6C6CB43FE170812">link</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(rodents)

  mod &lt;- LDA_TS(data = rodents, topics = 2, nseeds = 1, formulas = ~1,
                nchangepoints = 1, timename = "newmoon")

  conform_LDA_TS_data(rodents)
  check_LDA_TS_inputs(rodents, timename = "newmoon")

</code></pre>

<hr>
<h2 id='LDA_TS_control'>Create the controls list for the LDATS model</h2><span id='topic+LDA_TS_control'></span>

<h3>Description</h3>

<p>Create and define a list of control options used to run the
LDATS model, as implemented by <code><a href="#topic+LDA_TS">LDA_TS</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LDA_TS_control(
  quiet = FALSE,
  measurer_LDA = AIC,
  selector_LDA = min,
  iseed = 2,
  memoise = TRUE,
  response = "gamma",
  lambda = 0,
  measurer_TS = AIC,
  selector_TS = min,
  ntemps = 6,
  penultimate_temp = 2^6,
  ultimate_temp = 1e+10,
  q = 0,
  nit = 10000,
  magnitude = 12,
  burnin = 0,
  thin_frac = 1,
  summary_prob = 0.95,
  seed = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LDA_TS_control_+3A_quiet">quiet</code></td>
<td>
<p><code>logical</code> indicator of whether the model should run 
quietly.</p>
</td></tr>
<tr><td><code id="LDA_TS_control_+3A_measurer_lda">measurer_LDA</code>, <code id="LDA_TS_control_+3A_selector_lda">selector_LDA</code></td>
<td>
<p>Function names for use in evaluation of 
the LDA models. <code>measurer_LDA</code> is used to create a value for each 
model and <code>selector_LDA</code> operates on the values to choose the model.</p>
</td></tr>
<tr><td><code id="LDA_TS_control_+3A_iseed">iseed</code></td>
<td>
<p><code>integer</code> initial seed for the LDA model set.</p>
</td></tr>
<tr><td><code id="LDA_TS_control_+3A_memoise">memoise</code></td>
<td>
<p><code>logical</code> indicator of whether the multinomial 
functions should be memoised (via <code><a href="memoise.html#topic+memoise">memoise</a></code>). 
Memoisation happens to both <code><a href="#topic+multinom_TS">multinom_TS</a></code> and 
<code><a href="#topic+multinom_TS_chunk">multinom_TS_chunk</a></code>.</p>
</td></tr>
<tr><td><code id="LDA_TS_control_+3A_response">response</code></td>
<td>
<p><code>character</code> element indicating the response variable 
used in the time series. Should be set to <code>"gamma"</code> for LDATS.</p>
</td></tr>
<tr><td><code id="LDA_TS_control_+3A_lambda">lambda</code></td>
<td>
<p><code>numeric</code> &quot;weight&quot; decay term used to set the prior
on the regressors within each chunk-level model. Defaults to 0, 
corresponding to a fully vague prior.</p>
</td></tr>
<tr><td><code id="LDA_TS_control_+3A_measurer_ts">measurer_TS</code>, <code id="LDA_TS_control_+3A_selector_ts">selector_TS</code></td>
<td>
<p>Function names for use in evaluation of the 
TS models. <code>measurer_TS</code> is used to create a value for each model
and <code>selector_TS</code> operates on the values to choose the model.</p>
</td></tr>
<tr><td><code id="LDA_TS_control_+3A_ntemps">ntemps</code></td>
<td>
<p><code>integer</code> number of temperatures (chains) to use in the 
ptMCMC algorithm.</p>
</td></tr>
<tr><td><code id="LDA_TS_control_+3A_penultimate_temp">penultimate_temp</code></td>
<td>
<p>Penultimate temperature in the ptMCMC sequence.</p>
</td></tr>
<tr><td><code id="LDA_TS_control_+3A_ultimate_temp">ultimate_temp</code></td>
<td>
<p>Ultimate temperature in the ptMCMC sequence.</p>
</td></tr>
<tr><td><code id="LDA_TS_control_+3A_q">q</code></td>
<td>
<p>Exponent controlling the ptMCMC temperature sequence from the 
focal chain (reference with temperature = 1) to the penultimate chain. 0
(default) implies a geometric sequence. 1 implies squaring before 
exponentiating.</p>
</td></tr>
<tr><td><code id="LDA_TS_control_+3A_nit">nit</code></td>
<td>
<p><code>integer</code> number of iterations (steps) used in the ptMCMC
algorithm.</p>
</td></tr>
<tr><td><code id="LDA_TS_control_+3A_magnitude">magnitude</code></td>
<td>
<p>Average magnitude (defining a geometric distribution)
for the proposed step size in the ptMCMC algorithm.</p>
</td></tr>
<tr><td><code id="LDA_TS_control_+3A_burnin">burnin</code></td>
<td>
<p><code>integer</code> number of iterations to remove from the 
beginning of the ptMCMC algorithm.</p>
</td></tr>
<tr><td><code id="LDA_TS_control_+3A_thin_frac">thin_frac</code></td>
<td>
<p>Fraction of iterations to retain, from the ptMCMC. Must be
<code class="reqn">(0, 1]</code>, and the default value of 1 represents no thinning.</p>
</td></tr>
<tr><td><code id="LDA_TS_control_+3A_summary_prob">summary_prob</code></td>
<td>
<p>Probability used for summarizing the posterior 
distributions (via the highest posterior density interval, see
<code><a href="coda.html#topic+HPDinterval">HPDinterval</a></code>) of the TS model.</p>
</td></tr>
<tr><td><code id="LDA_TS_control_+3A_seed">seed</code></td>
<td>
<p>Input to <code>set.seed</code> in the time series model for 
replication purposes.</p>
</td></tr>
<tr><td><code id="LDA_TS_control_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to 
<code><a href="topicmodels.html#topic+LDA">LDA</a></code> as a <code>control</code> input.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>list</code> of control <code>lists</code>, with named elements 
<code>LDAcontrol</code>, <code>TScontrol</code>, and <code>quiet</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  LDA_TS_control()

</code></pre>

<hr>
<h2 id='LDATS'>Package to conduct two-stage analyses combining Latent Dirichlet 
Allocation with Bayesian Time Series models</h2><span id='topic+LDATS'></span>

<h3>Description</h3>

<p>Performs two-stage analysis of multivariate temporal data
using a combination of Latent Dirichlet Allocation (Blei <em>et al.</em>
2003) and Bayesian Time Series models (Western and Kleykamp 2004) that we
extend for multinomial data using softmax regression (Venables and Ripley
2002) following Christensen <em>et al.</em> (2018).
</p>


<h3>Documentation</h3>

<p><a href="https://github.com/weecology/LDATS/blob/main/LDATS_model.pdf">Technical mathematical manuscript</a>
<br /> <br /> 
<a href="https://weecology.github.io/LDATS/articles/rodents-example.html">End-user-focused vignette worked example</a>
<br /> <br /> 
<a href="https://weecology.github.io/LDATS/articles/LDATS_codebase.html">Computational pipeline vignette</a>
<br /> <br /> 
<a href="https://weecology.github.io/LDATS/articles/paper-comparison.html">Comparison to Christensen <em>et al.</em></a>
</p>


<h3>References</h3>

<p>Blei, D. M., A. Y. Ng, and M. I. Jordan. 2003. Latent Dirichlet
Allocation. <em>Journal of Machine Learning Research</em> 
<strong>3</strong>:993-1022.
<a href="https://jmlr.csail.mit.edu/papers/v3/blei03a.html">link</a>.
</p>
<p>Christensen, E., D. J. Harris, and S. K. M. Ernest. 2018.
Long-term community change through multiple rapid transitions in a 
desert rodent community. <em>Ecology</em> <strong>99</strong>:1523-1529. 
<a href="https://pubmed.ncbi.nlm.nih.gov/29718539/">link</a>.
</p>
<p>Venables, W. N. and B. D. Ripley. 2002. <em>Modern and Applied
Statistics with S</em>. Fourth Edition. Springer, New York, NY, USA.
</p>
<p>Western, B. and M. Kleykamp. 2004. A Bayesian change point model for 
historical time series analysis. <em>Political Analysis</em>
<strong>12</strong>:354-374.
<a href="https://www.cambridge.org/core/journals/political-analysis/article/abs/bayesian-change-point-model-for-historical-time-series-analysis/F7D2EDBBC211278EC6C6CB43FE170812">link</a>.
</p>

<hr>
<h2 id='logLik.LDA_VEM'>Calculate the log likelihood of a VEM LDA model fit</h2><span id='topic+logLik.LDA_VEM'></span>

<h3>Description</h3>

<p>Imported but updated calculations from topicmodels package, as
applied to Latent Dirichlet Allocation fit with Variational Expectation 
Maximization via <code><a href="topicmodels.html#topic+LDA">LDA</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'LDA_VEM'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.LDA_VEM_+3A_object">object</code></td>
<td>
<p>A <code>LDA_VEM</code>-class object.</p>
</td></tr>
<tr><td><code id="logLik.LDA_VEM_+3A_...">...</code></td>
<td>
<p>Not used, simply included to maintain method compatibility.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The number of degrees of freedom is 1 (for alpha) plus the number
of entries in the document-topic matrix. The number of observations is 
the number of entries in the document-term matrix.
</p>


<h3>Value</h3>

<p>Log likelihood of the model <code>logLik</code>, also with <code>df</code>
(degrees of freedom) and <code>nobs</code> (number of observations) values.
</p>


<h3>References</h3>

<p>Buntine, W. 2002. Variational extensions to EM and multinomial PCA. 
<em>European Conference on Machine Learning, Lecture Notes in Computer 
Science</em> <strong>2430</strong>:23-34. <a href="https://link.springer.com/chapter/10.1007/3-540-36755-1_3">link</a>.
</p>
<p>Grun B. and K. Hornik. 2011. topicmodels: An R Package for Fitting Topic
Models. <em>Journal of Statistical Software</em> <strong>40</strong>:13.
<a href="https://www.jstatsoft.org/article/view/v040i13">link</a>.
</p>
<p>Hoffman, M. D., D. M. Blei, and F. Bach. 2010. Online learning for 
latent Dirichlet allocation. <em>Advances in Neural Information 
Processing Systems</em> <strong>23</strong>:856-864.
<a href="https://papers.nips.cc/paper/3902-online-learning-for-latent-dirichlet-allocation">link</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(rodents)
  lda_data &lt;- rodents$document_term_table
  r_LDA &lt;- LDA_set(lda_data, topics = 2)   
  logLik(r_LDA[[1]])

</code></pre>

<hr>
<h2 id='logLik.multinom_TS_fit'>Log likelihood of a multinomial TS model</h2><span id='topic+logLik.multinom_TS_fit'></span>

<h3>Description</h3>

<p>Convenience function to simply extract the <code>logLik</code>
element (and <code>df</code> and <code>nobs</code>) from a <code>multinom_TS_fit</code>
object fit by <code><a href="#topic+multinom_TS">multinom_TS</a></code>. Extends 
<code><a href="stats.html#topic+logLik">logLik</a></code> from <code><a href="nnet.html#topic+multinom">multinom</a></code> to 
<code>multinom_TS_fit</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'multinom_TS_fit'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.multinom_TS_fit_+3A_object">object</code></td>
<td>
<p>A <code>multinom_TS_fit</code>-class object.</p>
</td></tr>
<tr><td><code id="logLik.multinom_TS_fit_+3A_...">...</code></td>
<td>
<p>Not used, simply included to maintain method compatibility.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Log likelihood of the model, as class <code>logLik</code>, with 
attributes <code>df</code> (degrees of freedom) and <code>nobs</code> (the number of
weighted observations, accounting for size differences among documents).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(rodents)
  dtt &lt;- rodents$document_term_table
  lda &lt;- LDA_set(dtt, 2, 1, list(quiet = TRUE))
  dct &lt;- rodents$document_covariate_table
  dct$gamma &lt;- lda[[1]]@gamma
  weights &lt;- document_weights(dtt)
  mts &lt;- multinom_TS(dct, formula = gamma ~ 1, changepoints = c(20,50),
                     timename = "newmoon", weights = weights)
  logLik(mts)

</code></pre>

<hr>
<h2 id='logLik.TS_fit'>Determine the log likelihood of a Time Series model</h2><span id='topic+logLik.TS_fit'></span>

<h3>Description</h3>

<p>Convenience function to extract and format the log likelihood
of a <code>TS_fit</code>-class object fit by <code><a href="#topic+multinom_TS">multinom_TS</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TS_fit'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.TS_fit_+3A_object">object</code></td>
<td>
<p>Class <code>TS_fit</code> object to be evaluated.</p>
</td></tr>
<tr><td><code id="logLik.TS_fit_+3A_...">...</code></td>
<td>
<p>Not used, simply included to maintain method compatibility.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Log likelihood of the model <code>logLik</code>, also with <code>df</code>
(degrees of freedom) and <code>nobs</code> (number of observations) values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  weights &lt;- document_weights(document_term_table)
  TSmod &lt;- TS(data, gamma ~ 1, nchangepoints = 1, "newmoon", weights)
  logLik(TSmod)


</code></pre>

<hr>
<h2 id='logsumexp'>Calculate the log-sum-exponential (LSE) of a vector</h2><span id='topic+logsumexp'></span>

<h3>Description</h3>

<p>Calculate the exponent of a vector (offset by the max), sum
the elements, calculate the log, remove the offset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logsumexp(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logsumexp_+3A_x">x</code></td>
<td>
<p><code>numeric</code> vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The LSE.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  logsumexp(1:10)

</code></pre>

<hr>
<h2 id='memoise_fun'>Logical control on whether or not to memoise</h2><span id='topic+memoise_fun'></span>

<h3>Description</h3>

<p>This function provides a simple, logical toggle control on
whether the function <code>fun</code> should be memoised via
<code><a href="memoise.html#topic+memoise">memoise</a></code> or not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>memoise_fun(fun, memoise_tf = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="memoise_fun_+3A_fun">fun</code></td>
<td>
<p>Function name to (potentially) be memoised.</p>
</td></tr>
<tr><td><code id="memoise_fun_+3A_memoise_tf">memoise_tf</code></td>
<td>
<p><code>logical</code> value indicating if <code>fun</code> should be 
memoised.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>fun</code>, memoised if desired.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  sum_memo &lt;- memoise_fun(sum)

</code></pre>

<hr>
<h2 id='messageq'>Optionally generate a message based on a logical input</h2><span id='topic+messageq'></span>

<h3>Description</h3>

<p>Given the input to <code>quiet</code>, generate the message(s) 
in <code>msg</code> or not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>messageq(msg = NULL, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="messageq_+3A_msg">msg</code></td>
<td>
<p><code>character</code> vector of the message(s) to generate or 
<code>NULL</code>. If more than one element is contained in <code>msg</code>, they
are concatenated with a newline between.</p>
</td></tr>
<tr><td><code id="messageq_+3A_quiet">quiet</code></td>
<td>
<p><code>logical</code> indicator controlling if the message is
generated.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>  messageq("hello")
  messageq("hello", TRUE)

</code></pre>

<hr>
<h2 id='mirror_vcov'>Create a properly symmetric variance covariance matrix</h2><span id='topic+mirror_vcov'></span>

<h3>Description</h3>

<p>A wrapper on <code><a href="stats.html#topic+vcov">vcov</a></code> to produce a symmetric
matrix. If the default matrix returned by <code><a href="stats.html#topic+vcov">vcov</a></code> is
symmetric it is returned simply. If it is not, in fact, symmetric
(as occurs occasionally with <code><a href="nnet.html#topic+multinom">multinom</a></code> applied to 
proportions), the matrix is made symmetric by averaging the lower and
upper triangles. If the relative difference between the upper and lower 
triangles for any entry is more than 0.1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mirror_vcov(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mirror_vcov_+3A_x">x</code></td>
<td>
<p>Model object that has a defined method for 
<code><a href="stats.html#topic+vcov">vcov</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Properly symmetric variance covariance <code>matrix</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  dat &lt;- data.frame(y = rnorm(50), x = rnorm(50))
  mod &lt;- lm(dat)
  mirror_vcov(mod)

</code></pre>

<hr>
<h2 id='modalvalue'>Determine the mode of a distribution</h2><span id='topic+modalvalue'></span>

<h3>Description</h3>

<p>Find the most common entry in a vector. Ties are not allowed,
the first value encountered within the modal set if there are ties is
deemed the mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modalvalue(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modalvalue_+3A_x">x</code></td>
<td>
<p><code>numeric</code> vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric value of the mode.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> d1 &lt;- c(1, 1, 1, 2, 2, 3)
 modalvalue(d1)

</code></pre>

<hr>
<h2 id='multinom_TS'>Fit a multinomial change point Time Series model</h2><span id='topic+multinom_TS'></span><span id='topic+check_multinom_TS_inputs'></span>

<h3>Description</h3>

<p>Fit a set of multinomial regression models (via
<code><a href="nnet.html#topic+multinom">multinom</a></code>, Venables and Ripley 2002) to a time series
of data divided into multiple segments (a.k.a. chunks) based on given 
locations for a set of change points. <br /> <br />
<code>check_multinom_TS_inputs</code> checks that the inputs to 
<code>multinom_TS</code> are of proper classes for an analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multinom_TS(
  data,
  formula,
  changepoints = NULL,
  timename = "time",
  weights = NULL,
  control = list()
)

check_multinom_TS_inputs(
  data,
  formula = gamma ~ 1,
  changepoints = NULL,
  timename = "time",
  weights = NULL,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multinom_TS_+3A_data">data</code></td>
<td>
<p><code>data.frame</code> including [1] the time variable (indicated 
in <code>timename</code>), [2] the predictor variables (required by
<code>formula</code>) and [3], the multinomial response variable (indicated in
<code>formula</code>) as verified by <code><a href="#topic+check_timename">check_timename</a></code> and 
<code><a href="#topic+check_formula">check_formula</a></code>. Note that the response variables should be
formatted as a <code>data.frame</code> object named as indicated by the 
<code>response</code> entry in the <code>control</code> list, such as <code>gamma</code> 
for a standard TS analysis on LDA output. See <code>Examples</code>.</p>
</td></tr>
<tr><td><code id="multinom_TS_+3A_formula">formula</code></td>
<td>
<p><code><a href="stats.html#topic+formula">formula</a></code> defining the regression between
relationship the change points. Any 
predictor variable included must also be a column in 
<code>data</code> and any (multinomial) response variable must be a set of
columns in <code>data</code>, as verified by <code><a href="#topic+check_formula">check_formula</a></code>.</p>
</td></tr>
<tr><td><code id="multinom_TS_+3A_changepoints">changepoints</code></td>
<td>
<p>Numeric vector indicating locations of the change 
points. Must be conformable to <code>integer</code> values. Validity 
checked by <code><a href="#topic+check_changepoints">check_changepoints</a></code> and
<code><a href="#topic+verify_changepoint_locations">verify_changepoint_locations</a></code>.</p>
</td></tr>
<tr><td><code id="multinom_TS_+3A_timename">timename</code></td>
<td>
<p><code>character</code> element indicating the time variable
used in the time series. Defaults to <code>"time"</code>. The variable must be
integer-conformable or a <code>Date</code>. If the variable named
is a <code>Date</code>, the input is converted to an integer, resulting in the
timestep being 1 day, which is often not desired behavior.</p>
</td></tr>
<tr><td><code id="multinom_TS_+3A_weights">weights</code></td>
<td>
<p>Optional class <code>numeric</code> vector of weights for each 
document. Defaults to <code>NULL</code>, translating to an equal weight for
each document. When using <code>multinom_TS</code> in a standard LDATS 
analysis, it is advisable to weight the documents by their total size,
as the result of <code><a href="topicmodels.html#topic+LDA">LDA</a></code> is a matrix of 
proportions, which does not account for size differences among documents.
For most models, a scaling of the weights (so that the average is 1) is
most appropriate, and this is accomplished using 
<code><a href="#topic+document_weights">document_weights</a></code>.</p>
</td></tr>
<tr><td><code id="multinom_TS_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the fitting of the
Time Series model including the parallel tempering Markov Chain 
Monte Carlo (ptMCMC) controls. Values not input assume defaults set by 
<code><a href="#topic+TS_control">TS_control</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>multinom_TS</code>: Object of class <code>multinom_TS_fit</code>, 
which is a list of [1]
chunk-level model fits (<code>"chunk models"</code>), [2] the total log 
likelihood combined across all chunks (<code>"logLik"</code>), and [3] a 
<code>data.frame</code> of chunk beginning and ending times (<code>"logLik"</code>
with columns <code>"start"</code> and <code>"end"</code>). <br /> <br />
<code>check_multinom_TS_inputs</code>: an error message is thrown if any 
input is improper, otherwise <code>NULL</code>.
</p>


<h3>References</h3>

<p>Venables, W. N. and B. D. Ripley. 2002. <em>Modern and Applied
Statistics with S</em>. Fourth Edition. Springer, New York, NY, USA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(rodents)
  dtt &lt;- rodents$document_term_table
  lda &lt;- LDA_set(dtt, 2, 1, list(quiet = TRUE))
  dct &lt;- rodents$document_covariate_table
  dct$gamma &lt;- lda[[1]]@gamma
  weights &lt;- document_weights(dtt)
  check_multinom_TS_inputs(dct, timename = "newmoon")
  mts &lt;- multinom_TS(dct, formula = gamma ~ 1, changepoints = c(20,50),
                     timename = "newmoon", weights = weights) 

</code></pre>

<hr>
<h2 id='multinom_TS_chunk'>Fit a multinomial Time Series model chunk</h2><span id='topic+multinom_TS_chunk'></span>

<h3>Description</h3>

<p>Fit a multinomial regression model (via
<code><a href="nnet.html#topic+multinom">multinom</a></code>, Ripley 1996, Venables and Ripley 2002)
to a defined chunk of time (a.k.a. segment)
<code>[chunk$start, chunk$end]</code> within a time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multinom_TS_chunk(
  data,
  formula,
  chunk,
  timename = "time",
  weights = NULL,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multinom_TS_chunk_+3A_data">data</code></td>
<td>
<p>Class <code>data.frame</code> object including the predictor and 
response variables.</p>
</td></tr>
<tr><td><code id="multinom_TS_chunk_+3A_formula">formula</code></td>
<td>
<p>Formula as a <code><a href="stats.html#topic+formula">formula</a></code> or 
<code><a href="base.html#topic+character">character</a></code> object describing the chunk.</p>
</td></tr>
<tr><td><code id="multinom_TS_chunk_+3A_chunk">chunk</code></td>
<td>
<p>Length-2 vector of times: [1] <code>start</code>, the start time 
for the chunk and [2] <code>end</code>, the end time for the chunk.</p>
</td></tr>
<tr><td><code id="multinom_TS_chunk_+3A_timename">timename</code></td>
<td>
<p><code>character</code> element indicating the time variable
used in the time series. Defaults to <code>"time"</code>. The variable must be
integer-conformable or a <code>Date</code>. If the variable named
is a <code>Date</code>, the input is converted to an integer, resulting in the
timestep being 1 day, which is often not desired behavior.</p>
</td></tr>
<tr><td><code id="multinom_TS_chunk_+3A_weights">weights</code></td>
<td>
<p>Optional class <code>numeric</code> vector of weights for each 
document. Defaults to <code>NULL</code>, translating to an equal weight for
each document. When using <code>multinom_TS</code> in a standard LDATS 
analysis, it is advisable to weight the documents by their total size,
as the result of <code><a href="topicmodels.html#topic+LDA">LDA</a></code> is a matrix of 
proportions, which does not account for size differences among documents.
For most models, a scaling of the weights (so that the average is 1) is
most appropriate, and this is accomplished using <code>document_weights</code>.</p>
</td></tr>
<tr><td><code id="multinom_TS_chunk_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the fitting of the
Time Series model including the parallel tempering Markov Chain 
Monte Carlo (ptMCMC) controls. Values not input assume defaults set by 
<code><a href="#topic+TS_control">TS_control</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Fitted model object for the chunk, of classes <code>multinom</code> and
<code>nnet</code>.
</p>


<h3>References</h3>

<p>Ripley, B. D. 1996. Pattern Recognition and Neural Networks. Cambridge.
</p>
<p>Venables, W. N. and B. D. Ripley. 2002. Modern Applied Statistics with S.
Fourth edition. Springer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(rodents)
  dtt &lt;- rodents$document_term_table
  lda &lt;- LDA_set(dtt, 2, 1, list(quiet = TRUE))
  dct &lt;- rodents$document_covariate_table
  dct$gamma &lt;- lda[[1]]@gamma
  weights &lt;- document_weights(dtt)
  chunk &lt;- c(start = 0, end = 100)
  mtsc &lt;- multinom_TS_chunk(dct, formula = gamma ~ 1, chunk = chunk,
                     timename = "newmoon", weights = weights) 

</code></pre>

<hr>
<h2 id='normalize'>Normalize a vector</h2><span id='topic+normalize'></span>

<h3>Description</h3>

<p>Normalize a <code>numeric</code> vector to be on the scale of [0,1].
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalize(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalize_+3A_x">x</code></td>
<td>
<p><code>numeric</code> vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Normalized <code>x</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> normalize(1:10)

</code></pre>

<hr>
<h2 id='package_chunk_fits'>Package the output of the chunk-level multinomial models into a
multinom_TS_fit list</h2><span id='topic+package_chunk_fits'></span>

<h3>Description</h3>

<p>Takes the list of fitted chunk-level models returned from
<code>TS_chunk_memo</code> (the memoised version of 
<code><a href="#topic+multinom_TS_chunk">multinom_TS_chunk</a></code> and packages it as a 
<code>multinom_TS_fit</code> object. This involves naming the model fits based 
on the chunk time windows, combining the log likelihood values across the 
chunks, and setting the class of the output object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>package_chunk_fits(chunks, fits)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="package_chunk_fits_+3A_chunks">chunks</code></td>
<td>
<p>Data frame of <code>start</code> and <code>end</code> times for each 
chunk (row).</p>
</td></tr>
<tr><td><code id="package_chunk_fits_+3A_fits">fits</code></td>
<td>
<p>List of chunk-level fits returned by <code>TS_chunk_memo</code>,
the memoised version of <code><a href="#topic+multinom_TS_chunk">multinom_TS_chunk</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>multinom_TS_fit</code>, which is a list of [1]
chunk-level model fits, [2] the total log likelihood combined across 
all chunks, and [3] the chunk time data table.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(rodents)
  dtt &lt;- rodents$document_term_table
  lda &lt;- LDA_set(dtt, 2, 1, list(quiet = TRUE))
  dct &lt;- rodents$document_covariate_table
  dct$gamma &lt;- lda[[1]]@gamma
  weights &lt;- document_weights(dtt)
  formula &lt;- gamma ~ 1
  changepoints &lt;- c(20,50)
  timename &lt;- "newmoon"
  TS_chunk_memo &lt;- memoise_fun(multinom_TS_chunk, TRUE)
  chunks &lt;- prep_chunks(dct, changepoints, timename)
  nchunks &lt;- nrow(chunks)
  fits &lt;- vector("list", length = nchunks)
  for (i in 1:nchunks){
    fits[[i]] &lt;- TS_chunk_memo(dct, formula, chunks[i, ], timename, 
                               weights, TS_control())
  }
  package_chunk_fits(chunks, fits) 

</code></pre>

<hr>
<h2 id='package_LDA_set'>Package the output from LDA_set</h2><span id='topic+package_LDA_set'></span>

<h3>Description</h3>

<p>Name the elements (LDA models) and set the class 
(<code>LDA_set</code>) of the models returned by <code><a href="#topic+LDA_set">LDA_set</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>package_LDA_set(mods, mod_topics, mod_seeds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="package_LDA_set_+3A_mods">mods</code></td>
<td>
<p>Fitted models returned from <code><a href="topicmodels.html#topic+LDA">LDA</a></code>.</p>
</td></tr>
<tr><td><code id="package_LDA_set_+3A_mod_topics">mod_topics</code></td>
<td>
<p>Vector of <code>integer</code> values corresponding to the 
number of topics in each model.</p>
</td></tr>
<tr><td><code id="package_LDA_set_+3A_mod_seeds">mod_seeds</code></td>
<td>
<p>Vector of <code>integer</code> values corresponding to the 
seed used for each model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>lis</code> (class: <code>LDA_set</code>) of LDA models (class: 
<code>LDA_VEM</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  topics &lt;- 2
  nseeds &lt;- 2
  control &lt;- LDA_set_control()
  mod_topics &lt;- rep(topics, each = length(seq(2, nseeds * 2, 2)))
  iseed &lt;- control$iseed
  mod_seeds &lt;- rep(seq(iseed, iseed + (nseeds - 1)* 2, 2), length(topics))
  nmods &lt;- length(mod_topics)
  mods &lt;- vector("list", length = nmods)
  for (i in 1:nmods){
    LDA_msg(mod_topics[i], mod_seeds[i], control)
    control_i &lt;- prep_LDA_control(seed = mod_seeds[i], control = control)
    mods[[i]] &lt;- topicmodels::LDA(document_term_table, k = mod_topics[i], 
                     control = control_i)
  }
  package_LDA_set(mods, mod_topics, mod_seeds)


</code></pre>

<hr>
<h2 id='package_LDA_TS'>Package the output of LDA_TS</h2><span id='topic+package_LDA_TS'></span>

<h3>Description</h3>

<p>Combine the objects returned by <code><a href="#topic+LDA_set">LDA_set</a></code>,
<code><a href="#topic+select_LDA">select_LDA</a></code>, <code><a href="#topic+TS_on_LDA">TS_on_LDA</a></code>, and
<code><a href="#topic+select_TS">select_TS</a></code>, name them as elements of the list, and
set the class of the list as <code>LDA_TS</code>, for the return from
<code><a href="#topic+LDA_TS">LDA_TS</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>package_LDA_TS(LDAs, sel_LDA, TSs, sel_TSs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="package_LDA_TS_+3A_ldas">LDAs</code></td>
<td>
<p>List (class: <code>LDA_set</code>) of LDA models (class: 
<code>LDA</code>), as returned by <code><a href="#topic+LDA_set">LDA_set</a></code>.</p>
</td></tr>
<tr><td><code id="package_LDA_TS_+3A_sel_lda">sel_LDA</code></td>
<td>
<p>A reduced version of <code>LDAs</code> that only includes the 
LDA model(s) selected by <code><a href="#topic+select_LDA">select_LDA</a></code>. Still should be of
class <code>LDA_set</code>.</p>
</td></tr>
<tr><td><code id="package_LDA_TS_+3A_tss">TSs</code></td>
<td>
<p>Class <code>TS_on_LDA</code> list of results from <code><a href="#topic+TS">TS</a></code> 
applied for each model on each LDA model input, as returned by 
<code><a href="#topic+TS_on_LDA">TS_on_LDA</a></code>.</p>
</td></tr>
<tr><td><code id="package_LDA_TS_+3A_sel_tss">sel_TSs</code></td>
<td>
<p>A reduced version of <code>TSs</code> (of class <code>TS_fit</code>)
that only includes the TS model chosen via <code><a href="#topic+select_TS">select_TS</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Class <code>LDA_TS</code>-class object including all fitted models and 
selected models specifically, ready to be returned from 
<code><a href="#topic+LDA_TS">LDA_TS</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  data &lt;- rodents
  control &lt;- LDA_TS_control()              
  dtt &lt;- data$document_term_table
  dct &lt;- data$document_covariate_table
  weights &lt;- document_weights(dtt)
  LDAs &lt;- LDA_set(dtt, 2, 1, control$LDA_set_control)
  sel_LDA &lt;- select_LDA(LDAs, control$LDA_set_control)
  TSs &lt;- TS_on_LDA(sel_LDA, dct, ~1, 1, "newmoon", weights,  
                   control$TS_control)
  sel_TSs &lt;- select_TS(TSs, control$TS_control)
  package_LDA_TS(LDAs, sel_LDA, TSs, sel_TSs)

 
</code></pre>

<hr>
<h2 id='package_TS'>Summarize the Time Series model</h2><span id='topic+package_TS'></span>

<h3>Description</h3>

<p>Calculate relevant summaries for the run of a Time Series
model within <code><a href="#topic+TS">TS</a></code> and package the output as a
<code>TS_fit</code>-class object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>package_TS(data, formula, timename, weights, control, rho_dist, eta_dist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="package_TS_+3A_data">data</code></td>
<td>
<p><code>data.frame</code> including [1] the time variable (indicated 
in <code>timename</code>), [2] the predictor variables (required by
<code>formula</code>) and [3], the multinomial response variable (indicated in
<code>formula</code>) as verified by <code><a href="#topic+check_timename">check_timename</a></code> and 
<code><a href="#topic+check_formula">check_formula</a></code>. Note that the response variables should be
formatted as a <code>data.frame</code> object named as indicated by the 
<code>response</code> entry in the <code>control</code> list, such as <code>gamma</code> 
for a standard TS analysis on LDA output.</p>
</td></tr>
<tr><td><code id="package_TS_+3A_formula">formula</code></td>
<td>
<p><code><a href="stats.html#topic+formula">formula</a></code> defining the regression between
relationship the change points. Any 
predictor variable included must also be a column in 
<code>data</code> and any (multinomial) response variable must be a set of
columns in <code>data</code>, as verified by <code><a href="#topic+check_formula">check_formula</a></code>.</p>
</td></tr>
<tr><td><code id="package_TS_+3A_timename">timename</code></td>
<td>
<p><code>character</code> element indicating the time variable
used in the time series.</p>
</td></tr>
<tr><td><code id="package_TS_+3A_weights">weights</code></td>
<td>
<p>Optional class <code>numeric</code> vector of weights for each 
document. Defaults to <code>NULL</code>, translating to an equal weight for
each document. When using <code>multinom_TS</code> in a standard LDATS 
analysis, it is advisable to weight the documents by their total size,
as the result of <code><a href="topicmodels.html#topic+LDA">LDA</a></code> is a matrix of 
proportions, which does not account for size differences among documents.
For most models, a scaling of the weights (so that the average is 1) is
most appropriate, and this is accomplished using <code>document_weights</code>.</p>
</td></tr>
<tr><td><code id="package_TS_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the fitting of the
Time Series model including the parallel tempering Markov Chain 
Monte Carlo (ptMCMC) controls. Values not input assume defaults set by 
<code><a href="#topic+TS_control">TS_control</a></code>.</p>
</td></tr>
<tr><td><code id="package_TS_+3A_rho_dist">rho_dist</code></td>
<td>
<p>List of saved data objects from the ptMCMC estimation of
change point locations returned by <code><a href="#topic+est_changepoints">est_changepoints</a></code>
(unless <code>nchangepoints</code> is 0, then <code>NULL</code>).</p>
</td></tr>
<tr><td><code id="package_TS_+3A_eta_dist">eta_dist</code></td>
<td>
<p>Matrix of draws (rows) from the marginal posteriors of the 
coefficients across the segments (columns), as estimated by
<code><a href="#topic+est_regressors">est_regressors</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TS_fit</code>-class list containing the following elements, many of
which are hidden for <code>print</code>ing, but are accessible:
</p>

<dl>
<dt>data</dt><dd><p><code>data</code> input to the function.</p>
</dd>
<dt>formula</dt><dd><p><code><a href="stats.html#topic+formula">formula</a></code> input to the function.</p>
</dd>
<dt>nchangepoints</dt><dd><p><code>nchangepoints</code> input to the function.</p>
</dd>
<dt>weights</dt><dd><p><code>weights</code> input to the function.</p>
</dd>
<dt>timename</dt><dd><p><code>timename</code> input to the function.</p>
</dd>
<dt>control</dt><dd><p><code>control</code> input to the function.</p>
</dd>
<dt>lls</dt><dd><p>Iteration-by-iteration 
<a href="#topic+logLik.multinom_TS_fit">logLik</a> values for the
full time series fit by <code><a href="#topic+multinom_TS">multinom_TS</a></code>.</p>
</dd>
<dt>rhos</dt><dd><p>Iteration-by-iteration change point estimates from
<code><a href="#topic+est_changepoints">est_changepoints</a></code>.</p>
</dd>
<dt>etas</dt><dd><p>Iteration-by-iteration marginal regressor estimates from
<code><a href="#topic+est_regressors">est_regressors</a></code>, which have been 
unconditioned with respect to the change point locations.</p>
</dd>
<dt>ptMCMC_diagnostics</dt><dd><p>ptMCMC diagnostics, 
see <code><a href="#topic+diagnose_ptMCMC">diagnose_ptMCMC</a></code></p>
</dd>
<dt>rho_summary</dt><dd><p>Summary table describing <code>rhos</code> (the change
point locations), 
see <code><a href="#topic+summarize_rhos">summarize_rhos</a></code>.</p>
</dd>
<dt>rho_vcov</dt><dd><p>Variance-covariance matrix for the estimates of
<code>rhos</code> (the change point locations), see 
<code><a href="#topic+measure_rho_vcov">measure_rho_vcov</a></code>.</p>
</dd>
<dt>eta_summary</dt><dd><p>Summary table describing <code>ets</code> (the 
regressors), 
see <code><a href="#topic+summarize_etas">summarize_etas</a></code>.</p>
</dd>
<dt>eta_vcov</dt><dd><p>Variance-covariance matrix for the estimates of
<code>etas</code> (the regressors), see 
<code><a href="#topic+measure_eta_vcov">measure_eta_vcov</a></code>.</p>
</dd>
<dt>logLik</dt><dd><p>Across-iteration average of log-likelihoods 
(<code>lls</code>).</p>
</dd>
<dt>nparams</dt><dd><p>Total number of parameters in the full model,
including the change point locations and regressors.</p>
</dd>
<dt>AIC</dt><dd><p>Penalized negative log-likelihood, based on 
<code>logLik</code> and <code>nparams</code>.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  weights &lt;- document_weights(document_term_table)
  formula &lt;- gamma ~ 1
  nchangepoints &lt;- 1
  control &lt;- TS_control()
  data &lt;- data[order(data[,"newmoon"]), ]
  rho_dist &lt;- est_changepoints(data, formula, nchangepoints, "newmoon", 
                               weights, control)
  eta_dist &lt;- est_regressors(rho_dist, data, formula, "newmoon", weights, 
                             control)
  package_TS(data, formula, "newmoon", weights, control, rho_dist, 
             eta_dist)


</code></pre>

<hr>
<h2 id='package_TS_on_LDA'>Package the output of TS_on_LDA</h2><span id='topic+package_TS_on_LDA'></span>

<h3>Description</h3>

<p>Set the class and name the elements of the results list 
returned from applying <code><a href="#topic+TS">TS</a></code> to the combination of TS models
requested for the LDA model(s) input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>package_TS_on_LDA(TSmods, LDA_models, models)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="package_TS_on_LDA_+3A_tsmods">TSmods</code></td>
<td>
<p>list of results from <code><a href="#topic+TS">TS</a></code> applied for each model 
on each LDA model input.</p>
</td></tr>
<tr><td><code id="package_TS_on_LDA_+3A_lda_models">LDA_models</code></td>
<td>
<p>List of LDA models (class <code>LDA_set</code>, produced by
<code><a href="#topic+LDA_set">LDA_set</a></code>) or a singular LDA model (class <code>LDA</code>,
produced by <code><a href="topicmodels.html#topic+LDA">LDA</a></code>).</p>
</td></tr>
<tr><td><code id="package_TS_on_LDA_+3A_models">models</code></td>
<td>
<p><code>data.frame</code> object returned from 
<code><a href="#topic+expand_TS">expand_TS</a></code> that contains the combinations of LDA models, 
and formulas and nchangepoints used in the TS models.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Class <code>TS_on_LDA</code> list of results from <code><a href="#topic+TS">TS</a></code> 
applied for each model on each LDA model input.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDAs &lt;- LDA_set(document_term_table, topics = 2:3, nseeds = 2)
  LDA_models &lt;- select_LDA(LDAs)
  weights &lt;- document_weights(document_term_table)
  mods &lt;- expand_TS(LDA_models, c(~ 1, ~ newmoon), 0:1)
  nmods &lt;- nrow(mods)
  TSmods &lt;- vector("list", nmods)
  for(i in 1:nmods){
    formula_i &lt;- mods$formula[[i]]
    nchangepoints_i &lt;- mods$nchangepoints[i]
    data_i &lt;- prep_TS_data(document_covariate_table, LDA_models, mods, i)
    TSmods[[i]] &lt;- TS(data_i, formula_i, nchangepoints_i, "newmoon", 
                      weights, TS_control())
  }
  package_TS_on_LDA(TSmods, LDA_models, mods)


</code></pre>

<hr>
<h2 id='plot.LDA_set'>Plot a set of LDATS LDA models</h2><span id='topic+plot.LDA_set'></span>

<h3>Description</h3>

<p>Generalization of the <code><a href="graphics.html#topic+plot">plot</a></code> function to 
work on a list of LDA topic models (class <code>LDA_set</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'LDA_set'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.LDA_set_+3A_x">x</code></td>
<td>
<p>An <code>LDA_set</code> object of LDA topic models.</p>
</td></tr>
<tr><td><code id="plot.LDA_set_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to subfunctions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  lda_data &lt;- rodents$document_term_table
  r_LDA &lt;- LDA_set(lda_data, topics = 2, nseeds = 2) 
  plot(r_LDA)


</code></pre>

<hr>
<h2 id='plot.LDA_TS'>Plot the key results from a full LDATS analysis</h2><span id='topic+plot.LDA_TS'></span>

<h3>Description</h3>

<p>Generalization of the <code><a href="graphics.html#topic+plot">plot</a></code> function to
work on fitted LDA_TS model objects (class <code>LDA_TS</code>) returned by
<code><a href="#topic+LDA_TS">LDA_TS</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'LDA_TS'
plot(
  x,
  ...,
  cols = set_LDA_TS_plot_cols(),
  bin_width = 1,
  xname = NULL,
  border = NA,
  selection = "median"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.LDA_TS_+3A_x">x</code></td>
<td>
<p>A <code>LDA_TS</code> object of a full LDATS model fit by
<code><a href="#topic+LDA_TS">LDA_TS</a></code>.</p>
</td></tr>
<tr><td><code id="plot.LDA_TS_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to subfunctions. Not currently
used, just retained for alignment with <code>plot</code>.</p>
</td></tr>
<tr><td><code id="plot.LDA_TS_+3A_cols">cols</code></td>
<td>
<p><code>list</code> of elements used to define the colors for the two
panels of the summary plot, as generated simply using
<code><a href="#topic+set_LDA_TS_plot_cols">set_LDA_TS_plot_cols</a></code>. <code>cols</code> has two elements:
<code>LDA</code> and <code>TS</code>, each corresponding the set of plots for
its stage in the full model. <code>LDA</code> contains entries <code>cols</code>
and <code>option</code> (see <code><a href="#topic+set_LDA_plot_colors">set_LDA_plot_colors</a></code>). <code>TS</code>
contains two entries, <code>rho</code> and <code>gamma</code>, each corresponding
to the related panel, and each containing default values for entries
named <code>cols</code>, <code>option</code>, and <code>alpha</code> (see
<code><a href="#topic+set_TS_summary_plot_cols">set_TS_summary_plot_cols</a></code>, <code><a href="#topic+set_gamma_colors">set_gamma_colors</a></code>,
and <code><a href="#topic+set_rho_hist_colors">set_rho_hist_colors</a></code>).</p>
</td></tr>
<tr><td><code id="plot.LDA_TS_+3A_bin_width">bin_width</code></td>
<td>
<p>Width of the bins used in the histograms of the summary
time series plot, in units of the time variable used to fit the model
(the x-axis).</p>
</td></tr>
<tr><td><code id="plot.LDA_TS_+3A_xname">xname</code></td>
<td>
<p>Label for the x-axis in the summary time series plot. Defaults
to <code>NULL</code>, which results in usage of the <code>timename</code> element
of the control list (held in<code>control$TS_control$timename</code>). To have
no label printed, set <code>xname = ""</code>.</p>
</td></tr>
<tr><td><code id="plot.LDA_TS_+3A_border">border</code></td>
<td>
<p>Border for the histogram, default is <code>NA</code>.</p>
</td></tr>
<tr><td><code id="plot.LDA_TS_+3A_selection">selection</code></td>
<td>
<p>Indicator of the change points to use in the time series
summary plot. Currently only defined for <code>"median"</code> and
<code>"mode"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  mod &lt;- LDA_TS(data = rodents, topics = 2, nseeds = 1, formulas = ~1,
                nchangepoints = 1, timename = "newmoon")
  plot(mod, binwidth = 5, xlab = "New moon")


</code></pre>

<hr>
<h2 id='plot.LDA_VEM'>Plot the results of an LDATS LDA model</h2><span id='topic+plot.LDA_VEM'></span><span id='topic+LDA_plot_top_panel'></span><span id='topic+LDA_plot_bottom_panel'></span>

<h3>Description</h3>

<p>Create an LDATS LDA summary plot, with a top panel showing
the topic proportions for each word and a bottom panel showing the topic
proportions of each document/over time. The plot function is defined for
class <code>LDA_VEM</code> specifically (see <code><a href="topicmodels.html#topic+LDA">LDA</a></code>).
<br /> <br />
<code>LDA_plot_top_panel</code> creates an LDATS LDA summary plot 
top panel showing the topic proportions word-by-word. <br /> <br />
<code>LDA_plot_bottom_panel</code> creates an LDATS LDA summary plot
bottom panel showing the topic proportions over time/documents.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'LDA_VEM'
plot(
  x,
  ...,
  xtime = NULL,
  xname = NULL,
  cols = NULL,
  option = "C",
  alpha = 0.8,
  LDATS = FALSE
)

LDA_plot_top_panel(
  x,
  cols = NULL,
  option = "C",
  alpha = 0.8,
  together = FALSE,
  LDATS = FALSE
)

LDA_plot_bottom_panel(
  x,
  xtime = NULL,
  xname = NULL,
  cols = NULL,
  option = "C",
  alpha = 0.8,
  together = FALSE,
  LDATS = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.LDA_VEM_+3A_x">x</code></td>
<td>
<p>Object of class <code>LDA_VEM</code>.</p>
</td></tr>
<tr><td><code id="plot.LDA_VEM_+3A_...">...</code></td>
<td>
<p>Not used, retained for alignment with base function.</p>
</td></tr>
<tr><td><code id="plot.LDA_VEM_+3A_xtime">xtime</code></td>
<td>
<p>Optional x values used to plot the topic proportions according
to a specific time value (rather than simply the order of observations).</p>
</td></tr>
<tr><td><code id="plot.LDA_VEM_+3A_xname">xname</code></td>
<td>
<p>Optional name for the x values used in plotting the topic
proportions (otherwise defaults to &quot;Document&quot;).</p>
</td></tr>
<tr><td><code id="plot.LDA_VEM_+3A_cols">cols</code></td>
<td>
<p>Colors to be used to plot the topics.
Any valid color values (<em>e.g.</em>, see <code><a href="grDevices.html#topic+colors">colors</a></code>,
<code><a href="grDevices.html#topic+rgb">rgb</a></code>) can be input as with a standard plot. 
The default (<code>cols = NULL</code>) triggers use of 
<code><a href="viridis.html#topic+viridis">viridis</a></code> color options (see <code>option</code>).</p>
</td></tr>
<tr><td><code id="plot.LDA_VEM_+3A_option">option</code></td>
<td>
<p>A <code>character</code> string indicating the color option
from <code><a href="viridis.html#topic+viridis">viridis</a></code> to use if 'cols == NULL'. Four 
options are available: &quot;magma&quot; (or &quot;A&quot;), &quot;inferno&quot; (or &quot;B&quot;), &quot;plasma&quot; 
(or &quot;C&quot;, the default option), &quot;viridis&quot; (or &quot;D&quot;) and &quot;cividis&quot; (or &quot;E&quot;).</p>
</td></tr>
<tr><td><code id="plot.LDA_VEM_+3A_alpha">alpha</code></td>
<td>
<p>Numeric value [0,1] that indicates the transparency of the 
colors used. Supported only on some devices, see 
<code><a href="grDevices.html#topic+rgb">rgb</a></code>.</p>
</td></tr>
<tr><td><code id="plot.LDA_VEM_+3A_ldats">LDATS</code></td>
<td>
<p><code>logical</code> indicating if the LDA plot is part of a larger 
LDATS plot output.</p>
</td></tr>
<tr><td><code id="plot.LDA_VEM_+3A_together">together</code></td>
<td>
<p><code>logical</code> indicating if the subplots are part of a 
larger LDA plot output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  lda_data &lt;- rodents$document_term_table
  r_LDA &lt;- LDA_set(lda_data, topics = 4, nseeds = 10) 
  best_lda &lt;- select_LDA(r_LDA)[[1]]
  plot(best_lda, option = "cividis")
  LDA_plot_top_panel(best_lda, option = "cividis")
  LDA_plot_bottom_panel(best_lda, option = "cividis")


</code></pre>

<hr>
<h2 id='plot.TS_fit'>Plot an LDATS TS model</h2><span id='topic+plot.TS_fit'></span>

<h3>Description</h3>

<p>Generalization of the <code><a href="graphics.html#topic+plot">plot</a></code> function to 
work on fitted TS model objects (class <code>TS_fit</code>) returned from 
<code><a href="#topic+TS">TS</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TS_fit'
plot(
  x,
  ...,
  plot_type = "summary",
  interactive = FALSE,
  cols = set_TS_summary_plot_cols(),
  bin_width = 1,
  xname = NULL,
  border = NA,
  selection = "median",
  LDATS = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.TS_fit_+3A_x">x</code></td>
<td>
<p>A <code>TS_fit</code> object of a multinomial time series model fit by
<code><a href="#topic+TS">TS</a></code>.</p>
</td></tr>
<tr><td><code id="plot.TS_fit_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to subfunctions. Not currently
used, just retained for alignment with <code><a href="graphics.html#topic+plot">plot</a></code>.</p>
</td></tr>
<tr><td><code id="plot.TS_fit_+3A_plot_type">plot_type</code></td>
<td>
<p>&quot;diagnostic&quot; or &quot;summary&quot;.</p>
</td></tr>
<tr><td><code id="plot.TS_fit_+3A_interactive">interactive</code></td>
<td>
<p><code>logical</code> input, should be codeTRUE unless
testing.</p>
</td></tr>
<tr><td><code id="plot.TS_fit_+3A_cols">cols</code></td>
<td>
<p><code>list</code> of elements used to define the colors for the two
panels of the summary plot, as generated simply using 
<code><a href="#topic+set_TS_summary_plot_cols">set_TS_summary_plot_cols</a></code>. <code>cols</code> has two elements 
<code>rho</code> and <code>gamma</code>, each corresponding to the related panel, 
and each containing default values for entries named <code>cols</code>,
<code>option</code>, and <code>alpha</code>. See <code><a href="#topic+set_gamma_colors">set_gamma_colors</a></code> and 
<code><a href="#topic+set_rho_hist_colors">set_rho_hist_colors</a></code> for details on usage.</p>
</td></tr>
<tr><td><code id="plot.TS_fit_+3A_bin_width">bin_width</code></td>
<td>
<p>Width of the bins used in the histograms of the summary 
time series plot, in units of the x-axis (the time variable used to fit 
the model).</p>
</td></tr>
<tr><td><code id="plot.TS_fit_+3A_xname">xname</code></td>
<td>
<p>Label for the x-axis in the summary time series plot. Defaults
to <code>NULL</code>, which results in usage of the <code>timename</code> element
of the control list (held in<code>control$TS_control$timename</code>). To have
no label printed, set <code>xname = ""</code>.</p>
</td></tr>
<tr><td><code id="plot.TS_fit_+3A_border">border</code></td>
<td>
<p>Border for the histogram, default is <code>NA</code>.</p>
</td></tr>
<tr><td><code id="plot.TS_fit_+3A_selection">selection</code></td>
<td>
<p>Indicator of the change points to use in the time series
summary plot. Currently only defined for <code>"median"</code> and 
<code>"mode"</code>.</p>
</td></tr>
<tr><td><code id="plot.TS_fit_+3A_ldats">LDATS</code></td>
<td>
<p><code>logical</code> indicating if the plot is part of a larger 
LDATS plot output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  weights &lt;- document_weights(document_term_table)
  TSmod &lt;- TS(data, gamma ~ 1, nchangepoints = 1, "newmoon", weights)
  plot(TSmod)


</code></pre>

<hr>
<h2 id='posterior_plot'>Produce the posterior distribution histogram panel for the TS 
diagnostic plot of a parameter</h2><span id='topic+posterior_plot'></span>

<h3>Description</h3>

<p>Produce a vanilla histogram plot using <code>hist</code> for the 
parameter of interest (rho or eta) as part of 
<code><a href="#topic+TS_diagnostics_plot">TS_diagnostics_plot</a></code>. A vertical line is added to show the 
median of the posterior.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posterior_plot(x, xlab = "parameter value")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="posterior_plot_+3A_x">x</code></td>
<td>
<p>Vector of parameter values drawn from the posterior distribution,
indexed to the iteration by the order of the vector.</p>
</td></tr>
<tr><td><code id="posterior_plot_+3A_xlab">xlab</code></td>
<td>
<p><code>character</code> value used to label the x axis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> posterior_plot(rnorm(100, 0, 1))

</code></pre>

<hr>
<h2 id='prep_chunks'>Prepare the time chunk table for a multinomial change point 
Time Series model</h2><span id='topic+prep_chunks'></span>

<h3>Description</h3>

<p>Creates the table containing the start and end times for each
chunk within a time series, based on the change points (used to break up
the time series) and the range of the time series. If there are no 
change points (i.e. <code>changepoints</code> is <code>NULL</code>, there is still a
single chunk defined by the start and end of the time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_chunks(data, changepoints = NULL, timename = "time")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep_chunks_+3A_data">data</code></td>
<td>
<p>Class <code>data.frame</code> object including the predictor and 
response variables, but specifically here containing the column indicated
by the <code>timename</code> input.</p>
</td></tr>
<tr><td><code id="prep_chunks_+3A_changepoints">changepoints</code></td>
<td>
<p>Numeric vector indicating locations of the change 
points. Must be conformable to <code>integer</code> values.</p>
</td></tr>
<tr><td><code id="prep_chunks_+3A_timename">timename</code></td>
<td>
<p><code>character</code> element indicating the time variable
used in the time series. Defaults to <code>"time"</code>. The variable must be
integer-conformable or a <code>Date</code>. If the variable named
is a <code>Date</code>, the input is converted to an integer, resulting in the
timestep being 1 day, which is often not desired behavior.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>data.frame</code> of <code>start</code> and <code>end</code> times (columns)
for each chunk (rows).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(rodents)
  dtt &lt;- rodents$document_term_table
  lda &lt;- LDA_set(dtt, 2, 1, list(quiet = TRUE))
  dct &lt;- rodents$document_covariate_table
  dct$gamma &lt;- lda[[1]]@gamma
  chunks &lt;- prep_chunks(dct, changepoints = 100, timename = "newmoon")   

</code></pre>

<hr>
<h2 id='prep_cpts'>Initialize and update the change point matrix used in the ptMCMC
algorithm</h2><span id='topic+prep_cpts'></span><span id='topic+update_cpts'></span>

<h3>Description</h3>

<p>Each of the chains is initialized by <code>prep_cpts</code> using a 
draw from the available times (i.e. assuming a uniform prior), the best 
fit (by likelihood) draw is put in the focal chain with each subsequently 
worse fit placed into the subsequently hotter chain. <code>update_cpts</code>
updates the change points after every iteration in the ptMCMC algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_cpts(data, formula, nchangepoints, timename, weights, control = list())

update_cpts(cpts, swaps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep_cpts_+3A_data">data</code></td>
<td>
<p><code>data.frame</code> including [1] the time variable (indicated 
in <code>timename</code>), [2] the predictor variables (required by
<code>formula</code>) and [3], the multinomial response variable (indicated in
<code>formula</code>) as verified by <code><a href="#topic+check_timename">check_timename</a></code> and 
<code><a href="#topic+check_formula">check_formula</a></code>. Note that the response variables should be
formatted as a <code>data.frame</code> object named as indicated by the 
<code>response</code> entry in the <code>control</code> list, such as <code>gamma</code> 
for a standard TS analysis on LDA output.</p>
</td></tr>
<tr><td><code id="prep_cpts_+3A_formula">formula</code></td>
<td>
<p><code>formula</code> defining the regression relationship between
the change points, see <code><a href="stats.html#topic+formula">formula</a></code>. Any 
predictor variable included must also be a column in 
<code>data</code> and any (multinomial) response variable must be a set of
columns in <code>data</code>, as verified by <code><a href="#topic+check_formula">check_formula</a></code>.</p>
</td></tr>
<tr><td><code id="prep_cpts_+3A_nchangepoints">nchangepoints</code></td>
<td>
<p><code>integer</code> corresponding to the number of 
change points to include in the model. 0 is a valid input (corresponding
to no change points, so a singular time series model), and the current 
implementation can reasonably include up to 6 change points. The 
number of change points is used to dictate the segmentation of the data  
for each continuous model and each LDA model.</p>
</td></tr>
<tr><td><code id="prep_cpts_+3A_timename">timename</code></td>
<td>
<p><code>character</code> element indicating the time variable
used in the time series. Defaults to <code>"time"</code>. The variable must be
integer-conformable or a <code>Date</code>. If the variable named
is a <code>Date</code>, the input is converted to an integer, resulting in the
timestep being 1 day, which is often not desired behavior.</p>
</td></tr>
<tr><td><code id="prep_cpts_+3A_weights">weights</code></td>
<td>
<p>Optional class <code>numeric</code> vector of weights for each 
document. Defaults to <code>NULL</code>, translating to an equal weight for
each document. When using <code>multinom_TS</code> in a standard LDATS 
analysis, it is advisable to weight the documents by their total size,
as the result of <code><a href="topicmodels.html#topic+LDA">LDA</a></code> is a matrix of 
proportions, which does not account for size differences among documents.
For most models, a scaling of the weights (so that the average is 1) is
most appropriate, and this is accomplished using 
<code><a href="#topic+document_weights">document_weights</a></code>.</p>
</td></tr>
<tr><td><code id="prep_cpts_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the fitting of the
Time Series model including the parallel tempering Markov Chain 
Monte Carlo (ptMCMC) controls. Values not input assume defaults set by 
<code><a href="#topic+TS_control">TS_control</a></code>.</p>
</td></tr>
<tr><td><code id="prep_cpts_+3A_cpts">cpts</code></td>
<td>
<p>The existing matrix of change points.</p>
</td></tr>
<tr><td><code id="prep_cpts_+3A_swaps">swaps</code></td>
<td>
<p>Chain configuration after among-temperature swaps.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>list</code> of [1] <code>matrix</code> of change points (rows) for 
each temperature (columns) and [2] <code>vector</code> of log-likelihood 
values for each of the chains.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  weights &lt;- document_weights(document_term_table)
  data &lt;- data[order(data[,"newmoon"]), ]
  saves &lt;- prep_saves(1, TS_control())
  inputs &lt;- prep_ptMCMC_inputs(data, gamma ~ 1, 1, "newmoon", weights,
                               TS_control())
  cpts &lt;- prep_cpts(data, gamma ~ 1, 1, "newmoon", weights, TS_control())
  ids &lt;- prep_ids(TS_control())
  for(i in 1:TS_control()$nit){
    steps &lt;- step_chains(i, cpts, inputs)
    swaps &lt;- swap_chains(steps, inputs, ids)
    saves &lt;- update_saves(i, saves, steps, swaps)
    cpts &lt;- update_cpts(cpts, swaps)
    ids &lt;- update_ids(ids, swaps)
  }


</code></pre>

<hr>
<h2 id='prep_ids'>Initialize and update the chain ids throughout the ptMCMC algorithm</h2><span id='topic+prep_ids'></span><span id='topic+update_ids'></span>

<h3>Description</h3>

<p><code>prep_ids</code> creates and <code>update_ids</code> updates 
the active vector of identities (ids) for each of the chains in the 
ptMCMC algorithm. These ids are used to track trips of the particles
among chains.
<br /> <br />
These functions were designed to work within <code><a href="#topic+TS">TS</a></code> and 
specifically <code><a href="#topic+est_changepoints">est_changepoints</a></code>, but have been generalized
and would work within any general ptMCMC as long as <code>control</code>,
<code>ids</code>, and <code>swaps</code> are formatted properly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_ids(control = list())

update_ids(ids, swaps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep_ids_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the fitting of the
Time Series model including the parallel tempering Markov Chain 
Monte Carlo (ptMCMC) controls. Values not input assume defaults set by 
<code><a href="#topic+TS_control">TS_control</a></code>.</p>
</td></tr>
<tr><td><code id="prep_ids_+3A_ids">ids</code></td>
<td>
<p>The existing vector of chain ids.</p>
</td></tr>
<tr><td><code id="prep_ids_+3A_swaps">swaps</code></td>
<td>
<p>Chain configuration after among-temperature swaps.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The vector of chain ids.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  prep_ids()

  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  weights &lt;- document_weights(document_term_table)
  data &lt;- data[order(data[,"newmoon"]), ]
  saves &lt;- prep_saves(1, TS_control())
  inputs &lt;- prep_ptMCMC_inputs(data, gamma ~ 1, 1, "newmoon", weights,
                               TS_control())
  cpts &lt;- prep_cpts(data, gamma ~ 1, 1, "newmoon", weights, TS_control())
  ids &lt;- prep_ids(TS_control())
  for(i in 1:TS_control()$nit){
    steps &lt;- step_chains(i, cpts, inputs)
    swaps &lt;- swap_chains(steps, inputs, ids)
    saves &lt;- update_saves(i, saves, steps, swaps)
    cpts &lt;- update_cpts(cpts, swaps)
    ids &lt;- update_ids(ids, swaps)
  }


</code></pre>

<hr>
<h2 id='prep_LDA_control'>Set the control inputs to include the seed</h2><span id='topic+prep_LDA_control'></span>

<h3>Description</h3>

<p>Update the control list for the LDA model with the specific
seed as indicated. And remove controls not used within the LDA itself.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_LDA_control(seed, control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep_LDA_control_+3A_seed">seed</code></td>
<td>
<p><code>integer</code> used to set the seed of the specific model.</p>
</td></tr>
<tr><td><code id="prep_LDA_control_+3A_control">control</code></td>
<td>
<p>Named list of control parameters to be used in 
<code><a href="topicmodels.html#topic+LDA">LDA</a></code> Note that if <code>control</code> has an 
element named <code>seed</code> it will be overwritten by the <code>seed</code> 
argument of <code>prep_LDA_control</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>list</code> of controls to be used in the LDA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  prep_LDA_control(seed = 1) 

</code></pre>

<hr>
<h2 id='prep_pbar'>Initialize and tick through the progress bar</h2><span id='topic+prep_pbar'></span><span id='topic+update_pbar'></span>

<h3>Description</h3>

<p><code>prep_pbar</code> creates and <code>update_pbar</code> steps
through the progress bars (if desired) in <code><a href="#topic+TS">TS</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_pbar(control = list(), bar_type = "rho", nr = NULL)

update_pbar(pbar, control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep_pbar_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the fitting of the
Time Series model including the parallel tempering Markov Chain 
Monte Carlo (ptMCMC) controls. Values not input assume defaults set by 
<code><a href="#topic+TS_control">TS_control</a></code>. Of use here is <code>quiet</code> which is a
a <code>logical</code> indicator of whether there should be information 
(i.e. the progress bar) printed during the run or not. Default is 
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="prep_pbar_+3A_bar_type">bar_type</code></td>
<td>
<p>&quot;rho&quot; (for change point locations) or &quot;eta&quot; (for 
regressors).</p>
</td></tr>
<tr><td><code id="prep_pbar_+3A_nr">nr</code></td>
<td>
<p><code>integer</code> number of unique realizations, needed when
<code>bar_type</code> = &quot;eta&quot;.</p>
</td></tr>
<tr><td><code id="prep_pbar_+3A_pbar">pbar</code></td>
<td>
<p>The progress bar object returned from <code>prep_pbar</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>prep_pbar</code>: the initialized progress bar object. <br /> <br />
<code>update_pbar</code>: the ticked-forward <code>pbar</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  pb &lt;- prep_pbar(control = list(nit = 2)); pb
  pb &lt;- update_pbar(pb); pb
  pb &lt;- update_pbar(pb); pb

</code></pre>

<hr>
<h2 id='prep_proposal_dist'>Pre-calculate the change point proposal distribution for the ptMCMC 
algorithm</h2><span id='topic+prep_proposal_dist'></span>

<h3>Description</h3>

<p>Calculate the proposal distribution in advance of actually
running the ptMCMC algorithm in order to decrease computation time.
The proposal distribution is a joint of three distributions:
[1] a multinomial distribution selecting among the change points within
the chain, [2] a binomial distribution selecting the direction of the 
step of the change point (earlier or later in the time series), and 
[3] a geometric distribution selecting the magnitude of the step.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_proposal_dist(nchangepoints, control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep_proposal_dist_+3A_nchangepoints">nchangepoints</code></td>
<td>
<p>Integer corresponding to the number of 
change points to include in the model. 0 is a valid input (corresponding
to no change points, so a singular time series model), and the current 
implementation can reasonably include up to 6 change points. The 
number of change points is used to dictate the segmentation of the data  
for each continuous model and each LDA model.</p>
</td></tr>
<tr><td><code id="prep_proposal_dist_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the fitting of the
Time Series model including the parallel tempering Markov Chain 
Monte Carlo (ptMCMC) controls. Values not input assume defaults set by 
<code><a href="#topic+TS_control">TS_control</a></code>. Currently relevant here is 
<code>magnitude</code>, which controls the magnitude of the step size (is the 
average of the geometric distribution).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>list</code> of two <code>matrix</code> elements: [1] the size of the 
proposed step for each iteration of each chain and [2] the identity of 
the change point location to be shifted by the step for each iteration of
each chain.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  prep_proposal_dist(nchangepoints = 2)

</code></pre>

<hr>
<h2 id='prep_ptMCMC_inputs'>Prepare the inputs for the ptMCMC algorithm estimation of 
change points</h2><span id='topic+prep_ptMCMC_inputs'></span>

<h3>Description</h3>

<p>Package the static inputs (controls and data structures) used
by the ptMCMC algorithm in the context of estimating change points. 
<br /> <br />
This function was designed to work within <code><a href="#topic+TS">TS</a></code> and 
specifically <code><a href="#topic+est_changepoints">est_changepoints</a></code>. It is still hardcoded to do
so, but has the capacity to be generalized to work with any estimation
via ptMCMC with additional coding work.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_ptMCMC_inputs(
  data,
  formula,
  nchangepoints,
  timename,
  weights = NULL,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep_ptMCMC_inputs_+3A_data">data</code></td>
<td>
<p>Class <code>data.frame</code> object including [1] the time variable
(indicated in <code>control</code>), [2] the predictor variables (required by
<code>formula</code>) and [3], the multinomial response variable (indicated
in <code>formula</code>).</p>
</td></tr>
<tr><td><code id="prep_ptMCMC_inputs_+3A_formula">formula</code></td>
<td>
<p><code>formula</code> describing the continuous change. Any 
predictor variable included must also be a column in the
<code>data</code>.  Any (multinomial) response variable must also be a set of
columns in <code>data</code>.</p>
</td></tr>
<tr><td><code id="prep_ptMCMC_inputs_+3A_nchangepoints">nchangepoints</code></td>
<td>
<p>Integer corresponding to the number of 
change points to include in the model. 0 is a valid input (corresponding
to no change points, so a singular time series model), and the current 
implementation can reasonably include up to 6 change points. The 
number of change points is used to dictate the segmentation of the data  
for each continuous model and each LDA model.</p>
</td></tr>
<tr><td><code id="prep_ptMCMC_inputs_+3A_timename">timename</code></td>
<td>
<p><code>character</code> element indicating the time variable
used in the time series. Defaults to <code>"time"</code>. The variable must be
integer-conformable or a <code>Date</code>. If the variable named
is a <code>Date</code>, the input is converted to an integer, resulting in the
timestep being 1 day, which is often not desired behavior.</p>
</td></tr>
<tr><td><code id="prep_ptMCMC_inputs_+3A_weights">weights</code></td>
<td>
<p>Optional class <code>numeric</code> vector of weights for each 
document. Defaults to <code>NULL</code>, translating to an equal weight for
each document. When using <code>multinom_TS</code> in a standard LDATS 
analysis, it is advisable to weight the documents by their total size,
as the result of <code><a href="topicmodels.html#topic+LDA">LDA</a></code> is a matrix of 
proportions, which does not account for size differences among documents.
For most models, a scaling of the weights (so that the average is 1) is
most appropriate, and this is accomplished using 
<code><a href="#topic+document_weights">document_weights</a></code>.</p>
</td></tr>
<tr><td><code id="prep_ptMCMC_inputs_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the fitting of the
Time Series model including the parallel tempering Markov Chain 
Monte Carlo (ptMCMC) controls. Values not input assume defaults set by 
<code><a href="#topic+TS_control">TS_control</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Class <code>ptMCMC_inputs</code> <code>list</code>, containing the static 
inputs for use within the ptMCMC algorithm for estimating change points.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  weights &lt;- document_weights(document_term_table)
  data &lt;- data[order(data[,"newmoon"]), ]
  saves &lt;- prep_saves(1, TS_control())
  inputs &lt;- prep_ptMCMC_inputs(data, gamma ~ 1, 1, "newmoon", weights, 
                               TS_control())

</code></pre>

<hr>
<h2 id='prep_saves'>Prepare and update the data structures to save the ptMCMC output</h2><span id='topic+prep_saves'></span><span id='topic+update_saves'></span><span id='topic+process_saves'></span>

<h3>Description</h3>

<p><code>prep_saves</code> creates the data structure used to save the 
output from each iteration of the ptMCMC algorithm, which is added via
<code>update_saves</code>. Once the ptMCMC is complete, the saved data objects
are then processed (burn-in iterations are dropped and the remaining
iterations are thinned) via <code>process_saves</code>.
<br /> <br />
This set of functions was designed to work within <code><a href="#topic+TS">TS</a></code> and 
specifically <code><a href="#topic+est_changepoints">est_changepoints</a></code>. They are still hardcoded to
do so, but have the capacity to be generalized to work with any
estimation via ptMCMC with additional coding work.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_saves(nchangepoints, control = list())

update_saves(i, saves, steps, swaps)

process_saves(saves, control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep_saves_+3A_nchangepoints">nchangepoints</code></td>
<td>
<p><code>integer</code> corresponding to the number of 
change points to include in the model. 0 is a valid input (corresponding
to no change points, so a singular time series model), and the current 
implementation can reasonably include up to 6 change points. The 
number of change points is used to dictate the segmentation of the data  
for each continuous model and each LDA model.</p>
</td></tr>
<tr><td><code id="prep_saves_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the fitting of the
Time Series model including the parallel tempering Markov Chain 
Monte Carlo (ptMCMC) controls. Values not input assume defaults set by 
<code><a href="#topic+TS_control">TS_control</a></code>.</p>
</td></tr>
<tr><td><code id="prep_saves_+3A_i">i</code></td>
<td>
<p><code>integer</code> iteration index.</p>
</td></tr>
<tr><td><code id="prep_saves_+3A_saves">saves</code></td>
<td>
<p>The existing list of saved data objects.</p>
</td></tr>
<tr><td><code id="prep_saves_+3A_steps">steps</code></td>
<td>
<p>Chain configuration after within-temperature steps.</p>
</td></tr>
<tr><td><code id="prep_saves_+3A_swaps">swaps</code></td>
<td>
<p>Chain configuration after among-temperature swaps.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>list</code> of ptMCMC objects: change points (<code>$cpts</code>), 
log-likelihoods (<code>$lls</code>), chain ids (<code>$ids</code>), step acceptances
(<code>$step_accepts</code>), and swap acceptances (<code>$swap_accepts</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  weights &lt;- document_weights(document_term_table)
  data &lt;- data[order(data[,"newmoon"]), ]
  saves &lt;- prep_saves(1, TS_control())
  inputs &lt;- prep_ptMCMC_inputs(data, gamma ~ 1, 1, "newmoon", weights, 
                               TS_control())
  cpts &lt;- prep_cpts(data, gamma ~ 1, 1, "newmoon", weights, TS_control())
  ids &lt;- prep_ids(TS_control())
  for(i in 1:TS_control()$nit){
    steps &lt;- step_chains(i, cpts, inputs)
    swaps &lt;- swap_chains(steps, inputs, ids)
    saves &lt;- update_saves(i, saves, steps, swaps)
    cpts &lt;- update_cpts(cpts, swaps)
    ids &lt;- update_ids(ids, swaps)
  }
  process_saves(saves, TS_control())


</code></pre>

<hr>
<h2 id='prep_temp_sequence'>Prepare the ptMCMC temperature sequence</h2><span id='topic+prep_temp_sequence'></span>

<h3>Description</h3>

<p>Create the series of temperatures used in the ptMCMC 
algorithm.
<br /> <br />
This function was designed to work within <code><a href="#topic+TS">TS</a></code> and 
<code><a href="#topic+est_changepoints">est_changepoints</a></code> specifically, but has been generalized
and would work with any ptMCMC model as long as <code>control</code>
includes the relevant control parameters (and provided that the 
<code><a href="#topic+check_control">check_control</a></code> function and its use here are generalized).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_temp_sequence(control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep_temp_sequence_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the fitting of the
Time Series model including the parallel tempering Markov Chain 
Monte Carlo (ptMCMC) controls. Values not input assume defaults set by 
<code><a href="#topic+TS_control">TS_control</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>vector</code> of temperatures.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  prep_temp_sequence()

</code></pre>

<hr>
<h2 id='prep_TS_data'>Prepare the model-specific data to be used in the TS analysis
of LDA output</h2><span id='topic+prep_TS_data'></span>

<h3>Description</h3>

<p>Append the estimated topic proportions from a fitted LDA model 
to the document covariate table to create the data structure needed for 
<code><a href="#topic+TS">TS</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_TS_data(document_covariate_table, LDA_models, mods, i = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep_TS_data_+3A_document_covariate_table">document_covariate_table</code></td>
<td>
<p>Document covariate table (rows: documents,
columns: time index and covariate options). Every model needs a
covariate to describe the time value for each document (in whatever 
units and whose name in the table is input in <code>timename</code>)
that dictates the application of the change points. 
In addition, all covariates named within specific models in
<code>formula</code> must be included. Must be a conformable to a data table,
as verified by <code><a href="#topic+check_document_covariate_table">check_document_covariate_table</a></code>.</p>
</td></tr>
<tr><td><code id="prep_TS_data_+3A_lda_models">LDA_models</code></td>
<td>
<p>List of LDA models (class <code>LDA_set</code>, produced by
<code><a href="#topic+LDA_set">LDA_set</a></code>) or a singular LDA model (class <code>LDA</code>,
produced by <code><a href="topicmodels.html#topic+LDA">LDA</a></code>).</p>
</td></tr>
<tr><td><code id="prep_TS_data_+3A_mods">mods</code></td>
<td>
<p>The <code>data.table</code> created by <code><a href="#topic+expand_TS">expand_TS</a></code> that 
contains each of the models (defined by the LDA model to use and the and
formula number of changepoints for the TS model). Indexed here by 
<code>i</code>.</p>
</td></tr>
<tr><td><code id="prep_TS_data_+3A_i">i</code></td>
<td>
<p><code>integer</code> index referencing the row in <code>mods</code> to use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Class <code>data.frame</code> object including [1] the time variable
(indicated in <code>control</code>), [2] the predictor variables (required by
<code>formula</code>) and [3], the multinomial response variable (indicated
in <code>formula</code>), ready for input into <code>TS</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDAs &lt;- LDA_set(document_term_table, topics = 2:3, nseeds = 2)
  LDA_models &lt;- select_LDA(LDAs)
  weights &lt;- document_weights(document_term_table)
  formulas &lt;- c(~ 1, ~ newmoon)
  mods &lt;- expand_TS(LDA_models, formulas = ~1, nchangepoints = 0)
  data1 &lt;- prep_TS_data(document_covariate_table, LDA_models, mods)


</code></pre>

<hr>
<h2 id='print_model_run_message'>Print the message to the console about which combination of the 
Time Series and LDA models is being run</h2><span id='topic+print_model_run_message'></span>

<h3>Description</h3>

<p>If desired, print a message at the beginning of every model
combination stating the TS model and the LDA model being evaluated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>print_model_run_message(models, i, LDA_models, control)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print_model_run_message_+3A_models">models</code></td>
<td>
<p><code>data.frame</code> object returned from 
<code><a href="#topic+expand_TS">expand_TS</a></code> that contains the combinations of LDA models, 
and formulas and nchangepoints used in the TS models.</p>
</td></tr>
<tr><td><code id="print_model_run_message_+3A_i">i</code></td>
<td>
<p><code>integer</code> index of the row to use from <code>models</code>.</p>
</td></tr>
<tr><td><code id="print_model_run_message_+3A_lda_models">LDA_models</code></td>
<td>
<p>List of LDA models (class <code>LDA_set</code>, produced by
<code><a href="#topic+LDA_set">LDA_set</a></code>) or a singular LDA model (class <code>LDA</code>,
produced by <code><a href="topicmodels.html#topic+LDA">LDA</a></code>).</p>
</td></tr>
<tr><td><code id="print_model_run_message_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the fitting of the
Time Series model including the parallel tempering Markov Chain 
Monte Carlo (ptMCMC) controls. Values not input assume defaults set by 
<code><a href="#topic+TS_control">TS_control</a></code>. Of particular importance here is 
the <code>logical</code>-class element named <code>quiet</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDAs &lt;- LDA_set(document_term_table, topics = 2:3, nseeds = 2)
  LDA_models &lt;- select_LDA(LDAs)
  weights &lt;- document_weights(document_term_table)
  formulas &lt;- c(~ 1, ~ newmoon)
  nchangepoints &lt;- 0:1
  mods &lt;- expand_TS(LDA_models, formulas, nchangepoints)
  print_model_run_message(mods, 1, LDA_models, TS_control())


</code></pre>

<hr>
<h2 id='print.LDA_TS'>Print the selected LDA and TS models of LDA_TS object</h2><span id='topic+print.LDA_TS'></span>

<h3>Description</h3>

<p>Convenience function to print only the selected elements of a 
<code>LDA_TS</code>-class object returned by <code><a href="#topic+LDA_TS">LDA_TS</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'LDA_TS'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.LDA_TS_+3A_x">x</code></td>
<td>
<p>Class <code>LDA_TS</code> object to be printed.</p>
</td></tr>
<tr><td><code id="print.LDA_TS_+3A_...">...</code></td>
<td>
<p>Not used, simply included to maintain method compatibility.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The selected models in <code>x</code> as a two-element <code>list</code> with
the TS component only returning the non-hidden components.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  mod &lt;- LDA_TS(data = rodents, topics = 2, nseeds = 1, formulas = ~1,
                nchangepoints = 1, timename = "newmoon")
  print(mod)


</code></pre>

<hr>
<h2 id='print.TS_fit'>Print a Time Series model fit</h2><span id='topic+print.TS_fit'></span>

<h3>Description</h3>

<p>Convenience function to print only the most important 
components of a <code>TS_fit</code>-class object fit by 
<code><a href="#topic+TS">TS</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TS_fit'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.TS_fit_+3A_x">x</code></td>
<td>
<p>Class <code>TS_fit</code> object to be printed.</p>
</td></tr>
<tr><td><code id="print.TS_fit_+3A_...">...</code></td>
<td>
<p>Not used, simply included to maintain method compatibility.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The non-hidden parts of <code>x</code> as a <code>list</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  weights &lt;- document_weights(document_term_table)
  TSmod &lt;- TS(data, gamma ~ 1, nchangepoints = 1, "newmoon", weights)
  print(TSmod)


</code></pre>

<hr>
<h2 id='print.TS_on_LDA'>Print a set of Time Series models fit to LDAs</h2><span id='topic+print.TS_on_LDA'></span>

<h3>Description</h3>

<p>Convenience function to print only the names of a 
<code>TS_on_LDA</code>-class object generated by <code><a href="#topic+TS_on_LDA">TS_on_LDA</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TS_on_LDA'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.TS_on_LDA_+3A_x">x</code></td>
<td>
<p>Class <code>TS_on_LDA</code> object to be printed.</p>
</td></tr>
<tr><td><code id="print.TS_on_LDA_+3A_...">...</code></td>
<td>
<p>Not used, simply included to maintain method compatibility.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>character</code> <code>vector</code> of the names of <code>x</code>'s models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDAs &lt;- LDA_set(document_term_table, topics = 2:3, nseeds = 2)
  LDA_models &lt;- select_LDA(LDAs)
  weights &lt;- document_weights(document_term_table)
  formulas &lt;- c(~ 1, ~ newmoon)
  mods &lt;- TS_on_LDA(LDA_models, document_covariate_table, formulas,
                    nchangepoints = 0:1, timename = "newmoon", weights)
  print(mods)


</code></pre>

<hr>
<h2 id='proposed_step_mods'>Fit the chunk-level models to a time series, given a set of 
proposed change points within the ptMCMC algorithm</h2><span id='topic+proposed_step_mods'></span>

<h3>Description</h3>

<p>This function wraps around <code>TS_memo</code> 
(optionally memoised <code><a href="#topic+multinom_TS">multinom_TS</a></code>) to provide a
simpler interface within the ptMCMC algorithm and is implemented within
<code><a href="#topic+propose_step">propose_step</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>proposed_step_mods(prop_changepts, inputs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="proposed_step_mods_+3A_prop_changepts">prop_changepts</code></td>
<td>
<p><code>matrix</code> of proposed change points across 
chains.</p>
</td></tr>
<tr><td><code id="proposed_step_mods_+3A_inputs">inputs</code></td>
<td>
<p>Class <code>ptMCMC_inputs</code> list, containing the static inputs
for use within the ptMCMC algorithm.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of models associated with the proposed step, with an element
for each chain.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  weights &lt;- document_weights(document_term_table)
  data &lt;- data[order(data[,"newmoon"]), ]
  saves &lt;- prep_saves(1, TS_control())
  inputs &lt;- prep_ptMCMC_inputs(data, gamma ~ 1, 1, "newmoon", weights,
                               TS_control())
  cpts &lt;- prep_cpts(data, gamma ~ 1, 1, "newmoon", weights, TS_control())
  i &lt;- 1
  pdist &lt;- inputs$pdist
  ntemps &lt;- length(inputs$temps)
  selection &lt;- cbind(pdist$which_steps[i, ], 1:ntemps)
  prop_changepts &lt;- cpts$changepts
  curr_changepts_s &lt;- cpts$changepts[selection]
  prop_changepts_s &lt;- curr_changepts_s + pdist$steps[i, ]
  if(all(is.na(prop_changepts_s))){
    prop_changepts_s &lt;- NULL
  }
  prop_changepts[selection] &lt;- prop_changepts_s
  mods &lt;- proposed_step_mods(prop_changepts, inputs)


</code></pre>

<hr>
<h2 id='rho_lines'>Add change point location lines to the time series plot</h2><span id='topic+rho_lines'></span>

<h3>Description</h3>

<p>Adds vertical lines to the plot of the time series of fitted
proportions associated with the change points of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rho_lines(spec_rhos)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rho_lines_+3A_spec_rhos">spec_rhos</code></td>
<td>
<p><code>numeric</code> vector indicating the locations along the
x axis where the specific change points being used are located.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  weights &lt;- document_weights(document_term_table)
  TSmod &lt;- TS(data, gamma ~ 1, nchangepoints = 1, "newmoon", weights)
  pred_gamma_TS_plot(TSmod)
  rho_lines(200)


</code></pre>

<hr>
<h2 id='rodents'>Portal rodent data</h2><span id='topic+rodents'></span>

<h3>Description</h3>

<p>An example LDATS dataset, functionally that used in 
Christensen <em>et al.</em> (2018). The data are counts of 21 rodent 
species across 436 sampling events, with the count being the total number 
observed across 8 50 m x 50 m plots, each sampled using 49 live traps 
(Brown 1998, Ernest <em>et al.</em> 2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rodents
</code></pre>


<h3>Format</h3>

<p>A <code>list</code> of two <code>data.frame</code>-class objects with rows 
corresponding to documents (sampling events). One element is the
document term table (called <code>document_term_table</code>), which contains
counts of the species (terms) in each sample (document), and the other is
the document covariate table (called <code>document_covariate_table</code>) 
with columns of covariates (newmoon number, sin and cos of the fraction
of the year).
</p>


<h3>Source</h3>

<p><a href="https://github.com/weecology/PortalData/tree/master/Rodents">https://github.com/weecology/PortalData/tree/master/Rodents</a>
</p>


<h3>References</h3>

<p>Brown, J. H. 1998. 
The desert granivory experiments at Portal. 
Pages 71-95 in W. J. Resetarits Jr. and J. Bernardo, <em>editors</em>, 
<em>Experimental Ecology</em>. 
Oxford University Press, New York, New York, USA.
</p>
<p>Christensen, E., D. J. Harris, and S. K. M. Ernest. 2018.
Long-term community change through multiple rapid transitions in a 
desert rodent community. <em>Ecology</em> <strong>99</strong>:1523-1529. 
<a href="https://pubmed.ncbi.nlm.nih.gov/29718539/">link</a>.
</p>
<p>Ernest, S. K. M., <em>et al</em>. 2016. 
Long-term monitoring and experimental manipulation of a Chihuahuan desert
ecosystem near Portal, Arizona (1977-2013).
<em>Ecology</em> <strong>97</strong>:1082. 
<a href="https://experts.nebraska.edu/en/publications/long-term-monitoring-and-experimental-manipulation-of-a-chihuahua">link</a>.
</p>

<hr>
<h2 id='select_LDA'>Select the best LDA model(s) for use in time series</h2><span id='topic+select_LDA'></span>

<h3>Description</h3>

<p>Select the best model(s) of interest from an
<code>LDA_set</code> object, based on a set of user-provided functions. The
functions default to choosing the model with the lowest AIC value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_LDA(LDA_models = NULL, control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select_LDA_+3A_lda_models">LDA_models</code></td>
<td>
<p>An object of class <code>LDA_set</code> produced by
<code><a href="#topic+LDA_set">LDA_set</a></code>.</p>
</td></tr>
<tr><td><code id="select_LDA_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the running and 
selecting of LDA models. Values not input assume default values set 
by <code><a href="#topic+LDA_set_control">LDA_set_control</a></code>. Values for running the LDAs replace 
defaults in (<code>LDAcontol</code>, see <code><a href="topicmodels.html#topic+LDA">LDA</a></code> (but if
<code>seed</code> is given, it will be overwritten; use <code>iseed</code> instead).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A reduced version of <code>LDA_models</code> that only includes the 
selected LDA model(s). The returned object is still an object of
class <code>LDA_set</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(rodents)
  lda_data &lt;- rodents$document_term_table
  r_LDA &lt;- LDA_set(lda_data, topics = 2, nseeds = 2)  
  select_LDA(r_LDA)                       

</code></pre>

<hr>
<h2 id='select_TS'>Select the best Time Series model</h2><span id='topic+select_TS'></span>

<h3>Description</h3>

<p>Select the best model of interest from an
<code>TS_on_LDA</code> object generated by <code><a href="#topic+TS_on_LDA">TS_on_LDA</a></code>, based on
a set of user-provided functions. The functions default to choosing the 
model with the lowest AIC value. <br /> <br />
Presently, the set of functions should result in a singular selected
model. If multiple models are chosen via the selection, only the first
is returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_TS(TS_models, control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select_TS_+3A_ts_models">TS_models</code></td>
<td>
<p>An object of class <code>TS_on_LDA</code> produced by
<code><a href="#topic+TS_on_LDA">TS_on_LDA</a></code>.</p>
</td></tr>
<tr><td><code id="select_TS_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the fitting of the
Time Series model including the parallel tempering Markov Chain 
Monte Carlo (ptMCMC) controls. Values not input assume defaults set by 
<code><a href="#topic+TS_control">TS_control</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A reduced version of <code>TS_models</code> that only includes the 
selected TS model. The returned object is a single TS model object of
class <code>TS_fit</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDAs &lt;- LDA_set(document_term_table, topics = 2:3, nseeds = 2)
  LDA_models &lt;- select_LDA(LDAs)
  weights &lt;- document_weights(document_term_table)
  formulas &lt;- c(~ 1, ~ newmoon)
  mods &lt;- TS_on_LDA(LDA_models, document_covariate_table, formulas,
                    nchangepoints = 0:1, timename = "newmoon", weights)
  select_TS(mods)


</code></pre>

<hr>
<h2 id='set_gamma_colors'>Prepare the colors to be used in the gamma time series</h2><span id='topic+set_gamma_colors'></span>

<h3>Description</h3>

<p>Based on the inputs, create the set of colors to be used in
the time series of the fitted gamma (topic proportion) values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_gamma_colors(x, cols = NULL, option = "D", alpha = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_gamma_colors_+3A_x">x</code></td>
<td>
<p>Object of class <code>TS_fit</code>, fit by <code><a href="#topic+TS">TS</a></code>.</p>
</td></tr>
<tr><td><code id="set_gamma_colors_+3A_cols">cols</code></td>
<td>
<p>Colors to be used to plot the time series of fitted topic 
proportions.</p>
</td></tr>
<tr><td><code id="set_gamma_colors_+3A_option">option</code></td>
<td>
<p>A <code>character</code> string indicating the color option
from <code><a href="viridis.html#topic+viridis">viridis</a></code> to use if &quot;cols == NULL&quot;. Four 
options are available: &quot;magma&quot; (or &quot;A&quot;), &quot;inferno&quot; (or &quot;B&quot;), &quot;plasma&quot; 
(or &quot;C&quot;), &quot;viridis&quot; (or &quot;D&quot;, the default option) and &quot;cividis&quot; (or &quot;E&quot;).</p>
</td></tr>
<tr><td><code id="set_gamma_colors_+3A_alpha">alpha</code></td>
<td>
<p>Numeric value [0,1] that indicates the transparency of the 
colors used. Supported only on some devices, see 
<code><a href="grDevices.html#topic+rgb">rgb</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of <code>character</code> hex codes indicating colors to use.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  weights &lt;- document_weights(document_term_table)
  TSmod &lt;- TS(data, gamma ~ 1, nchangepoints = 1, "newmoon", weights)
  set_gamma_colors(TSmod)


</code></pre>

<hr>
<h2 id='set_LDA_plot_colors'>Prepare the colors to be used in the LDA plots</h2><span id='topic+set_LDA_plot_colors'></span>

<h3>Description</h3>

<p>Based on the inputs, create the set of colors to be used in
the LDA plots made by <code><a href="#topic+plot.LDA_TS">plot.LDA_TS</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_LDA_plot_colors(x, cols = NULL, option = "C", alpha = 0.8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_LDA_plot_colors_+3A_x">x</code></td>
<td>
<p>Object of class <code>LDA</code>.</p>
</td></tr>
<tr><td><code id="set_LDA_plot_colors_+3A_cols">cols</code></td>
<td>
<p>Colors to be used to plot the topics.
Any valid color values (<em>e.g.</em>, see <code><a href="grDevices.html#topic+colors">colors</a></code>,
<code><a href="grDevices.html#topic+rgb">rgb</a></code>) can be input as with a standard plot. 
The default (<code>cols = NULL</code>) triggers use of 
<code><a href="viridis.html#topic+viridis">viridis</a></code> color options (see <code>option</code>).</p>
</td></tr>
<tr><td><code id="set_LDA_plot_colors_+3A_option">option</code></td>
<td>
<p>A <code>character</code> string indicating the color option
from <code><a href="viridis.html#topic+viridis">viridis</a></code> to use if 'cols == NULL'. Four 
options are available: &quot;magma&quot; (or &quot;A&quot;), &quot;inferno&quot; (or &quot;B&quot;), &quot;plasma&quot; 
(or &quot;C&quot;, the default option), &quot;viridis&quot; (or &quot;D&quot;) and &quot;cividis&quot; (or &quot;E&quot;).</p>
</td></tr>
<tr><td><code id="set_LDA_plot_colors_+3A_alpha">alpha</code></td>
<td>
<p>Numeric value [0,1] that indicates the transparency of the 
colors used. Supported only on some devices, see 
<code><a href="grDevices.html#topic+rgb">rgb</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>vector</code> of <code>character</code> hex codes indicating colors to 
use.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  lda_data &lt;- rodents$document_term_table
  r_LDA &lt;- LDA_set(lda_data, topics = 4, nseeds = 10) 
  set_LDA_plot_colors(r_LDA[[1]])


</code></pre>

<hr>
<h2 id='set_LDA_TS_plot_cols'>Create the list of colors for the LDATS summary plot</h2><span id='topic+set_LDA_TS_plot_cols'></span>

<h3>Description</h3>

<p>A default list generator function that produces the options
for the colors controlling the panels of the LDATS summary plots, needed
because the change point histogram panel should be in a different color
scheme than the LDA and fitted time series model panels, which should be
in a matching color scheme. See <code><a href="#topic+set_LDA_plot_colors">set_LDA_plot_colors</a></code>,
<code><a href="#topic+set_TS_summary_plot_cols">set_TS_summary_plot_cols</a></code>, <code><a href="#topic+set_gamma_colors">set_gamma_colors</a></code>,
and <code><a href="#topic+set_rho_hist_colors">set_rho_hist_colors</a></code> for specific details on usage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_LDA_TS_plot_cols(
  rho_cols = NULL,
  rho_option = "D",
  rho_alpha = 0.4,
  gamma_cols = NULL,
  gamma_option = "C",
  gamma_alpha = 0.8
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_LDA_TS_plot_cols_+3A_rho_cols">rho_cols</code></td>
<td>
<p>Colors to be used to plot the histograms of change points.
Any valid color values (<em>e.g.</em>, see <code><a href="grDevices.html#topic+colors">colors</a></code>,
<code><a href="grDevices.html#topic+rgb">rgb</a></code>) can be input as with a standard plot.
The default (<code>rho_cols = NULL</code>) triggers use of
<code><a href="viridis.html#topic+viridis">viridis</a></code> color options (see <code>rho_option</code>).</p>
</td></tr>
<tr><td><code id="set_LDA_TS_plot_cols_+3A_rho_option">rho_option</code></td>
<td>
<p>A <code>character</code> string indicating the color option
from <code><a href="viridis.html#topic+viridis">viridis</a></code> to use if 'rho_cols == NULL'. Four
options are available: &quot;magma&quot; (or &quot;A&quot;), &quot;inferno&quot; (or &quot;B&quot;), &quot;plasma&quot;
(or &quot;C&quot;), &quot;viridis&quot; (or &quot;D&quot;, the default option) and &quot;cividis&quot; (or &quot;E&quot;).</p>
</td></tr>
<tr><td><code id="set_LDA_TS_plot_cols_+3A_rho_alpha">rho_alpha</code></td>
<td>
<p>Numeric value [0,1] that indicates the transparency of the
colors used. Supported only on some devices, see
<code><a href="grDevices.html#topic+rgb">rgb</a></code>.</p>
</td></tr>
<tr><td><code id="set_LDA_TS_plot_cols_+3A_gamma_cols">gamma_cols</code></td>
<td>
<p>Colors to be used to plot the LDA topic proportions,
time series of observed topic proportions, and time series of fitted
topic proportions. Any valid color values (<em>e.g.</em>, see
<code><a href="grDevices.html#topic+colors">colors</a></code>, <code><a href="grDevices.html#topic+rgb">rgb</a></code>) can be
input as with a standard plot. The default (<code>gamma_cols = NULL</code>)
triggers use of <code><a href="viridis.html#topic+viridis">viridis</a></code> color options (see
<code>gamma_option</code>).</p>
</td></tr>
<tr><td><code id="set_LDA_TS_plot_cols_+3A_gamma_option">gamma_option</code></td>
<td>
<p>A <code>character</code> string indicating the color option
from <code><a href="viridis.html#topic+viridis">viridis</a></code> to use if gamma_cols == NULL'. Four
options are available: &quot;magma&quot; (or &quot;A&quot;), &quot;inferno&quot; (or &quot;B&quot;), &quot;plasma&quot;
(or &quot;C&quot;, the default option), &quot;viridis&quot; (or &quot;D&quot;) and &quot;cividis&quot; (or &quot;E&quot;).</p>
</td></tr>
<tr><td><code id="set_LDA_TS_plot_cols_+3A_gamma_alpha">gamma_alpha</code></td>
<td>
<p>Numeric value [0,1] that indicates the transparency of
the colors used. Supported only on some devices, see
<code><a href="grDevices.html#topic+rgb">rgb</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>list</code> of elements used to define the colors for the two
panels of the summary plot, as generated simply using
<code><a href="#topic+set_LDA_TS_plot_cols">set_LDA_TS_plot_cols</a></code>. <code>cols</code> has two elements:
<code>LDA</code> and <code>TS</code>, each corresponding the set of plots for
its stage in the full model. <code>LDA</code> contains entries <code>cols</code>
and <code>options</code> (see <code><a href="#topic+set_LDA_plot_colors">set_LDA_plot_colors</a></code>). <code>TS</code>
contains two entries, <code>rho</code> and <code>gamma</code>, each corresponding
to the related panel, and each containing default values for entries
named <code>cols</code>, <code>option</code>, and <code>alpha</code> (see
<code><a href="#topic+set_TS_summary_plot_cols">set_TS_summary_plot_cols</a></code>, <code><a href="#topic+set_gamma_colors">set_gamma_colors</a></code>,
and <code><a href="#topic+set_rho_hist_colors">set_rho_hist_colors</a></code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  set_LDA_TS_plot_cols()

</code></pre>

<hr>
<h2 id='set_rho_hist_colors'>Prepare the colors to be used in the change point histogram</h2><span id='topic+set_rho_hist_colors'></span>

<h3>Description</h3>

<p>Based on the inputs, create the set of colors to be used in
the change point histogram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_rho_hist_colors(x = NULL, cols = NULL, option = "D", alpha = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_rho_hist_colors_+3A_x">x</code></td>
<td>
<p><code>matrix</code> of change point locations (element <code>rhos</code>) 
from an object of class <code>TS_fit</code>, fit by <code><a href="#topic+TS">TS</a></code>.</p>
</td></tr>
<tr><td><code id="set_rho_hist_colors_+3A_cols">cols</code></td>
<td>
<p>Colors to be used to plot the histograms of change points.
Any valid color values (<em>e.g.</em>, see <code><a href="grDevices.html#topic+colors">colors</a></code>,
<code><a href="grDevices.html#topic+rgb">rgb</a></code>) can be input as with a standard plot. 
The default (<code>rho_cols = NULL</code>) triggers use of 
<code><a href="viridis.html#topic+viridis">viridis</a></code> color options (see <code>rho_option</code>).</p>
</td></tr>
<tr><td><code id="set_rho_hist_colors_+3A_option">option</code></td>
<td>
<p>A <code>character</code> string indicating the color option
from <code><a href="viridis.html#topic+viridis">viridis</a></code> to use if &quot;cols == NULL&quot;. Four 
options are available: &quot;magma&quot; (or &quot;A&quot;), &quot;inferno&quot; (or &quot;B&quot;), &quot;plasma&quot; 
(or &quot;C&quot;), &quot;viridis&quot; (or &quot;D&quot;, the default option) and &quot;cividis&quot; (or &quot;E&quot;).</p>
</td></tr>
<tr><td><code id="set_rho_hist_colors_+3A_alpha">alpha</code></td>
<td>
<p>Numeric value [0,1] that indicates the transparency of the 
colors used. Supported only on some devices, see 
<code><a href="grDevices.html#topic+rgb">rgb</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of <code>character</code> hex codes indicating colors to use.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  weights &lt;- document_weights(document_term_table)
  TSmod &lt;- TS(data, gamma ~ 1, nchangepoints = 1, "newmoon", weights)
  set_rho_hist_colors(TSmod$rhos)


</code></pre>

<hr>
<h2 id='set_TS_summary_plot_cols'>Create the list of colors for the TS summary plot</h2><span id='topic+set_TS_summary_plot_cols'></span>

<h3>Description</h3>

<p>A default list generator function that produces the options
for the colors controlling the panels of the TS summary plots, so needed
because the panels should be in different color schemes. See 
<code><a href="#topic+set_gamma_colors">set_gamma_colors</a></code> and <code><a href="#topic+set_rho_hist_colors">set_rho_hist_colors</a></code> for
specific details on usage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_TS_summary_plot_cols(
  rho_cols = NULL,
  rho_option = "D",
  rho_alpha = 0.4,
  gamma_cols = NULL,
  gamma_option = "C",
  gamma_alpha = 0.8
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_TS_summary_plot_cols_+3A_rho_cols">rho_cols</code></td>
<td>
<p>Colors to be used to plot the histograms of change points.
Any valid color values (<em>e.g.</em>, see <code><a href="grDevices.html#topic+colors">colors</a></code>,
<code><a href="grDevices.html#topic+rgb">rgb</a></code>) can be input as with a standard plot. 
The default (<code>rho_cols = NULL</code>) triggers use of 
<code><a href="viridis.html#topic+viridis">viridis</a></code> color options (see <code>rho_option</code>).</p>
</td></tr>
<tr><td><code id="set_TS_summary_plot_cols_+3A_rho_option">rho_option</code></td>
<td>
<p>A <code>character</code> string indicating the color option
from <code><a href="viridis.html#topic+viridis">viridis</a></code> to use if 'rho_cols == NULL'. Four 
options are available: &quot;magma&quot; (or &quot;A&quot;), &quot;inferno&quot; (or &quot;B&quot;), &quot;plasma&quot; 
(or &quot;C&quot;), &quot;viridis&quot; (or &quot;D&quot;, the default option) and &quot;cividis&quot; (or &quot;E&quot;).</p>
</td></tr>
<tr><td><code id="set_TS_summary_plot_cols_+3A_rho_alpha">rho_alpha</code></td>
<td>
<p>Numeric value [0,1] that indicates the transparency of the 
colors used. Supported only on some devices, see 
<code><a href="grDevices.html#topic+rgb">rgb</a></code>.</p>
</td></tr>
<tr><td><code id="set_TS_summary_plot_cols_+3A_gamma_cols">gamma_cols</code></td>
<td>
<p>Colors to be used to plot the LDA topic proportions,
time series of observed topic proportions, and time series of fitted 
topic proportions. Any valid color values (<em>e.g.</em>, see 
<code><a href="grDevices.html#topic+colors">colors</a></code>, <code><a href="grDevices.html#topic+rgb">rgb</a></code>) can be 
input as with a standard plot. The default (<code>gamma_cols = NULL</code>)
triggers use of <code><a href="viridis.html#topic+viridis">viridis</a></code> color options (see 
<code>gamma_option</code>).</p>
</td></tr>
<tr><td><code id="set_TS_summary_plot_cols_+3A_gamma_option">gamma_option</code></td>
<td>
<p>A <code>character</code> string indicating the color option
from <code><a href="viridis.html#topic+viridis">viridis</a></code> to use if gamma_cols == NULL'. Four 
options are available: &quot;magma&quot; (or &quot;A&quot;), &quot;inferno&quot; (or &quot;B&quot;), &quot;plasma&quot; 
(or &quot;C&quot;), &quot;viridis&quot; (or &quot;D&quot;, the default option) and &quot;cividis&quot; (or &quot;E&quot;).</p>
</td></tr>
<tr><td><code id="set_TS_summary_plot_cols_+3A_gamma_alpha">gamma_alpha</code></td>
<td>
<p>Numeric value [0,1] that indicates the transparency of 
the colors used. Supported only on some devices, see 
<code><a href="grDevices.html#topic+rgb">rgb</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>list</code> of elements used to define the colors for the two
panels. Contains two elements <code>rho</code> and <code>gamma</code>, each 
corresponding to the related panel, and each containing default values 
for entries named <code>cols</code>, <code>option</code>, and <code>alpha</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  set_TS_summary_plot_cols()

</code></pre>

<hr>
<h2 id='sim_LDA_data'>Simulate LDA data from an LDA structure given parameters</h2><span id='topic+sim_LDA_data'></span>

<h3>Description</h3>

<p>For a given set of parameters <code>alpha</code> and <code>Beta</code> and
document-specific total word counts, simulate a document-by-term matrix.
Additional structuring variables (the numbers of topics (k),
documents (M), terms (V)) are inferred from input objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_LDA_data(N, Beta, alpha = NULL, Theta = NULL, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_LDA_data_+3A_n">N</code></td>
<td>
<p>A vector of document sizes (total word counts). Must be integer
conformable. Is used to infer the total number of documents.</p>
</td></tr>
<tr><td><code id="sim_LDA_data_+3A_beta">Beta</code></td>
<td>
<p><code>matrix</code> of categorical distribution parameters defining
terms within topics. Dimension: k x V (number of topics x number of 
terms). Used to infer both (k) and (V). Must be non-negative and sum to 
1 within topics.</p>
</td></tr>
<tr><td><code id="sim_LDA_data_+3A_alpha">alpha</code></td>
<td>
<p>Single positive numeric value for the Dirichlet distribution
parameter defining topics within documents. To specifically define
document topic probabilities, use <code>Theta</code>.</p>
</td></tr>
<tr><td><code id="sim_LDA_data_+3A_theta">Theta</code></td>
<td>
<p><code>matrix</code> of probabilities defining topics within 
documents. Dimension: M x k (documents x topics). Must be non-negative 
and sum to 1 within documents. To generally define document topic 
probabilities, use <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="sim_LDA_data_+3A_seed">seed</code></td>
<td>
<p>Input to <code><a href="base.html#topic+set.seed">set.seed</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A document-by-term <code>matrix</code> of counts (dim: M x V).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  N &lt;- c(10, 22, 15, 31)
  alpha &lt;- 1.2
  Beta &lt;- matrix(c(0.1, 0.1, 0.8, 0.2, 0.6, 0.2), 2, 3, byrow = TRUE)
  sim_LDA_data(N, Beta, alpha = alpha)
  Theta &lt;- matrix(c(0.2, 0.8, 0.8, 0.2, 0.5, 0.5, 0.9, 0.1), 4, 2, 
               byrow = TRUE)
  sim_LDA_data(N, Beta, Theta = Theta)

</code></pre>

<hr>
<h2 id='sim_LDA_TS_data'>Simulate LDA_TS data from LDA and TS model structures and parameters</h2><span id='topic+sim_LDA_TS_data'></span>

<h3>Description</h3>

<p>For a given set of covariates <code>X</code>; parameters 
<code>Beta</code>, <code>Eta</code>, <code>rho</code>, and <code>err</code>; and 
document-specific time stamps <code>tD</code> and lengths <code>N</code>),
simulate a document-by-topic matrix.
Additional structuring variables (the numbers of topics (k), terms (V), 
documents (M), segments (S), and covariates per segment (C))
are inferred from input objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_LDA_TS_data(N, Beta, X, Eta, rho, tD, err = 0, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_LDA_TS_data_+3A_n">N</code></td>
<td>
<p>A vector of document sizes (total word counts). Must be integer
conformable. Is used to infer the total number of documents.</p>
</td></tr>
<tr><td><code id="sim_LDA_TS_data_+3A_beta">Beta</code></td>
<td>
<p><code>matrix</code> of categorical distribution parameters defining
terms within topics. Dimension: k x V (number of topics x number of 
terms). Used to infer both (k) and (V). Must be non-negative and sum to 
1 within topics.</p>
</td></tr>
<tr><td><code id="sim_LDA_TS_data_+3A_x">X</code></td>
<td>
<p><code>matrix</code> of covariates, dimension M (number of documents) x 
C (number of covariates, including the intercept) (a.k.a the design
matrix).</p>
</td></tr>
<tr><td><code id="sim_LDA_TS_data_+3A_eta">Eta</code></td>
<td>
<p><code>matrix</code> of regression parameters across the segments,
dimension: SC (number of segments x number of covariates, including the
intercept) x k (number of topics).</p>
</td></tr>
<tr><td><code id="sim_LDA_TS_data_+3A_rho">rho</code></td>
<td>
<p>Vector of integer-conformable time locations of changepoints or 
<code>NULL</code> if no changepoints. Used to determine the number of 
segments. Must exist within the bounds of the times of the documents,
<code>tD</code>.</p>
</td></tr>
<tr><td><code id="sim_LDA_TS_data_+3A_td">tD</code></td>
<td>
<p>Vector of integer-conformable times of the documents. Must be
of length M (as determined by <code>X</code>).</p>
</td></tr>
<tr><td><code id="sim_LDA_TS_data_+3A_err">err</code></td>
<td>
<p>Additive error on the link-scale. Must be a non-negative 
<code>numeric</code> value. Default value of <code>0</code> indicates no error.</p>
</td></tr>
<tr><td><code id="sim_LDA_TS_data_+3A_seed">seed</code></td>
<td>
<p>Input to <code><a href="base.html#topic+set.seed">set.seed</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A document-by-term <code>matrix</code> of counts (dim: M x V).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  N &lt;- c(10, 22, 15, 31)
  tD &lt;- c(1, 3, 4, 6)
  rho &lt;- 3
  X &lt;- cbind(rep(1, 4), 1:4)
  Eta &lt;- cbind(c(0.5, 0.3, 0.9, 0.5), c(1.2, 1.1, 0.1, 0.5))
  Beta &lt;- matrix(c(0.1, 0.1, 0.8, 0.2, 0.6, 0.2), 2, 3, byrow = TRUE)
  err &lt;- 1
  sim_LDA_TS_data(N, Beta, X, Eta, rho, tD, err)
  
</code></pre>

<hr>
<h2 id='sim_TS_data'>Simulate TS data from a TS model structure given parameters</h2><span id='topic+sim_TS_data'></span>

<h3>Description</h3>

<p>For a given set of covariates <code>X</code>; parameters <code>Eta</code>,
<code>rho</code>, and <code>err</code>; and document-specific time stamps <code>tD</code>,
simulate a document-by-topic matrix. Additional structuring variables 
(numbers of topics (k), documents (M), segments (S), and 
covariates per segment (C)) are inferred from input objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_TS_data(X, Eta, rho, tD, err = 0, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_TS_data_+3A_x">X</code></td>
<td>
<p><code>matrix</code> of covariates, dimension M (number of documents) x 
C (number of covariates, including the intercept) (a.k.a. the design
matrix).</p>
</td></tr>
<tr><td><code id="sim_TS_data_+3A_eta">Eta</code></td>
<td>
<p><code>matrix</code> of regression parameters across the segments,
dimension: SC (number of segments x number of covariates, including the
intercept) x k (number of topics).</p>
</td></tr>
<tr><td><code id="sim_TS_data_+3A_rho">rho</code></td>
<td>
<p>Vector of integer-conformable time locations of changepoints or 
<code>NULL</code> if no changepoints. Used to determine the number of 
segments. Must exist within the bounds of the times of the documents,
<code>tD</code>.</p>
</td></tr>
<tr><td><code id="sim_TS_data_+3A_td">tD</code></td>
<td>
<p>Vector of integer-conformable times of the documents. Must be
of length M (as determined by <code>X</code>).</p>
</td></tr>
<tr><td><code id="sim_TS_data_+3A_err">err</code></td>
<td>
<p>Additive error on the link-scale. Must be a non-negative 
<code>numeric</code> value. Default value of <code>0</code> indicates no error.</p>
</td></tr>
<tr><td><code id="sim_TS_data_+3A_seed">seed</code></td>
<td>
<p>Input to <code><a href="base.html#topic+set.seed">set.seed</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A document-by-topic <code>matrix</code> of probabilities (dim: M x k).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  tD &lt;- c(1, 3, 4, 6)
  rho &lt;- 3
  X &lt;- cbind(rep(1, 4), 1:4)
  Eta &lt;- cbind(c(0.5, 0.3, 0.9, 0.5), c(1.2, 1.1, 0.1, 0.5))
  sim_TS_data(X, Eta, rho, tD, err = 1)
  
</code></pre>

<hr>
<h2 id='softmax'>Calculate the softmax of a vector or matrix of values</h2><span id='topic+softmax'></span>

<h3>Description</h3>

<p>Calculate the softmax (normalized exponential) of a vector
of values or a set of vectors stacked rowwise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>softmax(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="softmax_+3A_x">x</code></td>
<td>
<p><code>numeric</code> vector or matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The softmax of <code>x</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  dat &lt;- matrix(runif(100, -1, 1), 25, 4)
  softmax(dat)
  softmax(dat[,1])

</code></pre>

<hr>
<h2 id='step_chains'>Conduct a within-chain step of the ptMCMC algorithm</h2><span id='topic+step_chains'></span><span id='topic+propose_step'></span><span id='topic+eval_step'></span><span id='topic+take_step'></span>

<h3>Description</h3>

<p>This set of functions steps the chains forward one iteration 
of the within-chain component of the ptMCMC algorithm. <code>step_chains</code>
is the main function, comprised of a proposal (made by <code>prop_step</code>),
an evaluation of that proposal (made by <code>eval_step</code>), and then an 
update of the configuration (made by <code>take_step</code>). 
<br /> <br />
This set of functions was designed to work within <code><a href="#topic+TS">TS</a></code> and 
specifically <code><a href="#topic+est_changepoints">est_changepoints</a></code>. They are still hardcoded to
do so, but have the capacity to be generalized to work with any 
estimation via ptMCMC with additional coding work.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>step_chains(i, cpts, inputs)

propose_step(i, cpts, inputs)

eval_step(i, cpts, prop_step, inputs)

take_step(cpts, prop_step, accept_step)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="step_chains_+3A_i">i</code></td>
<td>
<p><code>integer</code> iteration index.</p>
</td></tr>
<tr><td><code id="step_chains_+3A_cpts">cpts</code></td>
<td>
<p><code>matrix</code> of change point locations across chains.</p>
</td></tr>
<tr><td><code id="step_chains_+3A_inputs">inputs</code></td>
<td>
<p>Class <code>ptMCMC_inputs</code> <code>list</code>, containing the 
static inputs for use within the ptMCMC algorithm.</p>
</td></tr>
<tr><td><code id="step_chains_+3A_prop_step">prop_step</code></td>
<td>
<p>Proposed step output from <code>propose_step</code>.</p>
</td></tr>
<tr><td><code id="step_chains_+3A_accept_step">accept_step</code></td>
<td>
<p><code>logical</code> indicator of acceptance of each chain's
proposed step.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each iteration of the ptMCMC algorithm, all of the chains
have the potential to take a step. The possible step is proposed under
a proposal distribution (here for change points we use a symmetric
geometric distribution), the proposed step is then evaluated and either
accepted or not (following the Metropolis-Hastings rule; Metropolis,
<em>et al.</em> 1953, Hasting 1960, Gupta <em>et al.</em> 2018), and then
accordingly taken or not (the configurations are updated).
</p>


<h3>Value</h3>

<p><code>step_chains</code>: <code>list</code> of change points, log-likelihoods, 
and logical indicators of acceptance for each chain. <br /> <br />
<code>propose_step</code>: <code>list</code> of change points and 
log-likelihood values for the proposal. <br /> <br />
<code>eval_step</code>: <code>logical</code> vector indicating if each 
chain's proposal was accepted. <br /> <br />
<code>take_step</code>: <code>list</code> of change points, log-likelihoods, 
and logical indicators of acceptance for each chain.
</p>


<h3>References</h3>

<p>Gupta, S., L. Hainsworth, J. S. Hogg, R. E. C. Lee, and J. R. Faeder. 
2018. Evaluation of parallel tempering to accelerate Bayesian parameter
estimation in systems biology. 
<a href="https://arxiv.org/abs/1801.09831">link</a>.
</p>
<p>Hastings, W. K. 1970. Monte Carlo sampling methods using Markov Chains
and their applications. <em>Biometrika</em> <strong>57</strong>:97-109.
<a href="https://academic.oup.com/biomet/article-abstract/57/1/97/284580">link</a>.
</p>
<p>Metropolis, N., A. W. Rosenbluth, M. N. Rosenbluth, A. H. Teller, and E.
Teller. 1953. Equations of state calculations by fast computing machines.
<em>Journal of Chemical Physics</em> <strong>21</strong>: 1087-1092.
<a href="https://bayes.wustl.edu/Manual/EquationOfState.pdf">link</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  weights &lt;- document_weights(document_term_table)
  data &lt;- data[order(data[,"newmoon"]), ]
  saves &lt;- prep_saves(1, TS_control())
  inputs &lt;- prep_ptMCMC_inputs(data, gamma ~ 1, 1, "newmoon", weights, 
                               TS_control())
  cpts &lt;- prep_cpts(data, gamma ~ 1, 1, "newmoon", weights, TS_control())
  ids &lt;- prep_ids(TS_control())
  for(i in 1:TS_control()$nit){
    steps &lt;- step_chains(i, cpts, inputs)
    swaps &lt;- swap_chains(steps, inputs, ids)
    saves &lt;- update_saves(i, saves, steps, swaps)
    cpts &lt;- update_cpts(cpts, swaps)
    ids &lt;- update_ids(ids, swaps)
  }
  # within step_chains()
  cpts &lt;- prep_cpts(data, gamma ~ 1, 1, "newmoon", weights, TS_control())
  i &lt;- 1
  prop_step &lt;- propose_step(i, cpts, inputs)
  accept_step &lt;- eval_step(i, cpts, prop_step, inputs)
  take_step(cpts, prop_step, accept_step)


</code></pre>

<hr>
<h2 id='summarize_etas'>Summarize the regressor (eta) distributions</h2><span id='topic+summarize_etas'></span><span id='topic+measure_eta_vcov'></span>

<h3>Description</h3>

<p><code>summarize_etas</code> calculates summary statistics for each
of the chunk-level regressors. 
<br /> <br />
<code>measure_ets_vcov</code> generates the variance-covariance matrix for 
the regressors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarize_etas(etas, control = list())

measure_eta_vcov(etas)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summarize_etas_+3A_etas">etas</code></td>
<td>
<p>Matrix of regressors (columns) across iterations of the 
ptMCMC (rows), as returned from <code><a href="#topic+est_regressors">est_regressors</a></code>.</p>
</td></tr>
<tr><td><code id="summarize_etas_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the fitting of the
Time Series model including the parallel tempering Markov Chain 
Monte Carlo (ptMCMC) controls. Values not input assume defaults set by 
<code><a href="#topic+TS_control">TS_control</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summarize_etas</code>: table of summary statistics for chunk-level
regressors including mean, median, mode, posterior interval, standard
deviation, MCMC error, autocorrelation, and effective sample size for 
each regressor. <br /> <br />
<code>measure_eta_vcov</code>: variance-covariance matrix for chunk-level
regressors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> etas &lt;- matrix(rnorm(100), 50, 2)
 summarize_etas(etas)
 measure_eta_vcov(etas)

</code></pre>

<hr>
<h2 id='summarize_rhos'>Summarize the rho distributions</h2><span id='topic+summarize_rhos'></span><span id='topic+measure_rho_vcov'></span>

<h3>Description</h3>

<p><code>summarize_rho</code> calculates summary statistics for each
of the change point locations.
<br /> <br />
<code>measure_rho_vcov</code> generates the variance-covariance matrix for the 
change point locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarize_rhos(rhos, control = list())

measure_rho_vcov(rhos)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summarize_rhos_+3A_rhos">rhos</code></td>
<td>
<p>Matrix of change point locations (columns) across iterations of 
the ptMCMC (rows) or <code>NULL</code> if no change points are in the model,
as returned from <code><a href="#topic+est_changepoints">est_changepoints</a></code>.</p>
</td></tr>
<tr><td><code id="summarize_rhos_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the fitting of the
Time Series model including the parallel tempering Markov Chain 
Monte Carlo (ptMCMC) controls. Values not input assume defaults set by 
<code><a href="#topic+TS_control">TS_control</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summarize_rhos</code>: table of summary statistics for change point
locations including mean, median, mode, posterior interval, standard
deviation, MCMC error, autocorrelation, and effective sample size for 
each change point location. <br /> <br />
<code>measure_rho_vcov</code>: variance-covariance matrix for change 
point locations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> rhos &lt;- matrix(sample(80:100, 100, TRUE), 50, 2)
 summarize_rhos(rhos)
 measure_rho_vcov(rhos)

</code></pre>

<hr>
<h2 id='swap_chains'>Conduct a set of among-chain swaps for the ptMCMC algorithm</h2><span id='topic+swap_chains'></span>

<h3>Description</h3>

<p>This function handles the among-chain swapping based on 
temperatures and likelihood differentials.  
<br /> <br />
This function was designed to work within <code><a href="#topic+TS">TS</a></code> and 
specifically <code><a href="#topic+est_changepoints">est_changepoints</a></code>. It is still hardcoded to do
so, but has the capacity to be generalized to work with any estimation
via ptMCMC with additional coding work.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swap_chains(chainsin, inputs, ids)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="swap_chains_+3A_chainsin">chainsin</code></td>
<td>
<p>Chain configuration to be evaluated for swapping.</p>
</td></tr>
<tr><td><code id="swap_chains_+3A_inputs">inputs</code></td>
<td>
<p>Class <code>ptMCMC_inputs</code> list, containing the static inputs
for use within the ptMCMC algorithm.</p>
</td></tr>
<tr><td><code id="swap_chains_+3A_ids">ids</code></td>
<td>
<p>The vector of integer chain ids.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ptMCMC algorithm couples the chains (which are 
taking their own walks on the distribution surface) through &quot;swaps&quot;, 
where neighboring chains exchange configurations (Geyer 1991, Falcioni 
and Deem 1999) following the Metropolis criterion (Metropolis 
<em>et al.</em> 1953). This allows them to share information and search the
surface in combination (Earl and Deem 2005).
</p>


<h3>Value</h3>

<p><code>list</code> of updated change points, log-likelihoods, and chain
ids, as well as a vector of acceptance indicators for each swap.
</p>


<h3>References</h3>

<p>Earl, D. J. and M. W. Deem. 2005. Parallel tempering: theory, 
applications, and new perspectives. <em>Physical Chemistry Chemical 
Physics</em> <strong>7</strong>: 3910-3916.
<a href="https://pubs.rsc.org/en/content/articlelanding/2005/cp/b509983h">link</a>.
</p>
<p>Falcioni, M. and M. W. Deem. 1999. A biased Monte Carlo scheme for 
zeolite structure solution.  <em>Journal of Chemical Physics</em>
<strong>110</strong>: 1754-1766.
<a href="https://pubs.aip.org/aip/jcp/article/110/3/1754/475486/A-biased-Monte-Carlo-scheme-for-zeolite-structure">link</a>.
</p>
<p>Geyer, C. J. 1991. Markov Chain Monte Carlo maximum likelihood. <em>In
Computing Science and Statistics: Proceedings of the 23rd Symposium on 
the Interface</em>. pp 156-163. American Statistical Association, New York,
USA. <a href="https://www.stat.umn.edu/geyer/f05/8931/c.pdf">link</a>.
</p>
<p>Metropolis, N., A. W. Rosenbluth, M. N. Rosenbluth, A. H. Teller, and E.
Teller. 1953. Equations of state calculations by fast computing machines.
<em>Journal of Chemical Physics</em> <strong>21</strong>: 1087-1092.
<a href="https://bayes.wustl.edu/Manual/EquationOfState.pdf">link</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  weights &lt;- document_weights(document_term_table)
  data &lt;- data[order(data[,"newmoon"]), ]
  saves &lt;- prep_saves(1, TS_control())
  inputs &lt;- prep_ptMCMC_inputs(data, gamma ~ 1, 1, "newmoon", weights, 
                               TS_control())
  cpts &lt;- prep_cpts(data, gamma ~ 1, 1, "newmoon", weights, TS_control())
  ids &lt;- prep_ids(TS_control())
  for(i in 1:TS_control()$nit){
    steps &lt;- step_chains(i, cpts, inputs)
    swaps &lt;- swap_chains(steps, inputs, ids)
    saves &lt;- update_saves(i, saves, steps, swaps)
    cpts &lt;- update_cpts(cpts, swaps)
    ids &lt;- update_ids(ids, swaps)
  }


</code></pre>

<hr>
<h2 id='trace_plot'>Produce the trace plot panel for the TS diagnostic plot of a 
parameter</h2><span id='topic+trace_plot'></span>

<h3>Description</h3>

<p>Produce a trace plot for the parameter of interest (rho or 
eta) as part of <code><a href="#topic+TS_diagnostics_plot">TS_diagnostics_plot</a></code>. A horizontal line 
is added to show the median of the posterior.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trace_plot(x, ylab = "parameter value")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trace_plot_+3A_x">x</code></td>
<td>
<p>Vector of parameter values drawn from the posterior distribution,
indexed to the iteration by the order of the vector.</p>
</td></tr>
<tr><td><code id="trace_plot_+3A_ylab">ylab</code></td>
<td>
<p><code>character</code> value used to label the y axis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> trace_plot(rnorm(100, 0, 1))

</code></pre>

<hr>
<h2 id='TS'>Conduct a single multinomial Bayesian Time Series analysis</h2><span id='topic+TS'></span><span id='topic+check_TS_inputs'></span>

<h3>Description</h3>

<p>This is the main interface function for the LDATS application
of Bayesian change point Time Series analyses (Christensen <em>et al.</em>
2018), which extends the model of Western and Kleykamp (2004;
see also Ruggieri 2013) to multinomial (proportional) response data using
softmax regression (Ripley 1996, Venables and Ripley 2002, Bishop 2006) 
using a generalized linear modeling approach (McCullagh and Nelder 1989).
The models are fit using parallel tempering Markov Chain Monte Carlo
(ptMCMC) methods (Earl and Deem 2005) to locate change points and 
neural networks (Ripley 1996, Venables and Ripley 2002, Bishop 2006) to
estimate regressors. <br /> <br />
<code>check_TS_inputs</code> checks that the inputs to 
<code>TS</code> are of proper classes for a full analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TS(
  data,
  formula = gamma ~ 1,
  nchangepoints = 0,
  timename = "time",
  weights = NULL,
  control = list()
)

check_TS_inputs(
  data,
  formula = gamma ~ 1,
  nchangepoints = 0,
  timename = "time",
  weights = NULL,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TS_+3A_data">data</code></td>
<td>
<p><code>data.frame</code> including [1] the time variable (indicated 
in <code>timename</code>), [2] the predictor variables (required by
<code>formula</code>) and [3], the multinomial response variable (indicated in
<code>formula</code>) as verified by <code><a href="#topic+check_timename">check_timename</a></code> and 
<code><a href="#topic+check_formula">check_formula</a></code>. Note that the response variables should be
formatted as a <code>data.frame</code> object named as indicated by the 
<code>response</code> entry in the <code>control</code> list, such as <code>gamma</code> 
for a standard TS analysis on LDA output. See <code>Examples</code>.</p>
</td></tr>
<tr><td><code id="TS_+3A_formula">formula</code></td>
<td>
<p><code><a href="stats.html#topic+formula">formula</a></code> defining the regression between
relationship the change points. Any 
predictor variable included must also be a column in 
<code>data</code> and any (multinomial) response variable must be a set of
columns in <code>data</code>, as verified by <code><a href="#topic+check_formula">check_formula</a></code>.</p>
</td></tr>
<tr><td><code id="TS_+3A_nchangepoints">nchangepoints</code></td>
<td>
<p><code>integer</code> corresponding to the number of 
change points to include in the model. 0 is a valid input (corresponding
to no change points, so a singular time series model), and the current 
implementation can reasonably include up to 6 change points. The 
number of change points is used to dictate the segmentation of the 
time series into chunks fit with separate models dictated by 
<code>formula</code>.</p>
</td></tr>
<tr><td><code id="TS_+3A_timename">timename</code></td>
<td>
<p><code>character</code> element indicating the time variable
used in the time series. Defaults to <code>"time"</code>. The variable must be
integer-conformable or a <code>Date</code>. If the variable named
is a <code>Date</code>, the input is converted to an integer, resulting in the
timestep being 1 day, which is often not desired behavior.</p>
</td></tr>
<tr><td><code id="TS_+3A_weights">weights</code></td>
<td>
<p>Optional class <code>numeric</code> vector of weights for each 
document. Defaults to <code>NULL</code>, translating to an equal weight for
each document. When using <code>multinom_TS</code> in a standard LDATS 
analysis, it is advisable to weight the documents by their total size,
as the result of <code><a href="topicmodels.html#topic+LDA">LDA</a></code> is a matrix of 
proportions, which does not account for size differences among documents.
For most models, a scaling of the weights (so that the average is 1) is
most appropriate, and this is accomplished using <code>document_weights</code>.</p>
</td></tr>
<tr><td><code id="TS_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the fitting of the
Time Series model including the parallel tempering Markov Chain 
Monte Carlo (ptMCMC) controls. Values not input assume defaults set by 
<code><a href="#topic+TS_control">TS_control</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TS</code>: <code>TS_fit</code>-class list containing the following
elements, many of
which are hidden for <code>print</code>ing, but are accessible:
</p>

<dl>
<dt>data</dt><dd><p><code>data</code> input to the function.</p>
</dd>
<dt>formula</dt><dd><p><code><a href="stats.html#topic+formula">formula</a></code> input to the function.</p>
</dd>
<dt>nchangepoints</dt><dd><p><code>nchangepoints</code> input to the function.</p>
</dd>
<dt>weights</dt><dd><p><code>weights</code> input to the function.</p>
</dd>
<dt>control</dt><dd><p><code>control</code> input to the function.</p>
</dd>
<dt>lls</dt><dd><p>Iteration-by-iteration 
<a href="#topic+logLik.multinom_TS_fit">logLik</a> values for the
full time series fit by <code><a href="#topic+multinom_TS">multinom_TS</a></code>.</p>
</dd>
<dt>rhos</dt><dd><p>Iteration-by-iteration change point estimates from
<code><a href="#topic+est_changepoints">est_changepoints</a></code>.</p>
</dd>
<dt>etas</dt><dd><p>Iteration-by-iteration marginal regressor estimates from
<code><a href="#topic+est_regressors">est_regressors</a></code>, which have been 
unconditioned with respect to the change point locations.</p>
</dd>
<dt>ptMCMC_diagnostics</dt><dd><p>ptMCMC diagnostics, 
see <code><a href="#topic+diagnose_ptMCMC">diagnose_ptMCMC</a></code></p>
</dd>
<dt>rho_summary</dt><dd><p>Summary table describing <code>rhos</code> (the change
point locations), 
see <code><a href="#topic+summarize_rhos">summarize_rhos</a></code>.</p>
</dd>
<dt>rho_vcov</dt><dd><p>Variance-covariance matrix for the estimates of
<code>rhos</code> (the change point locations), see 
<code><a href="#topic+measure_rho_vcov">measure_rho_vcov</a></code>.</p>
</dd>
<dt>eta_summary</dt><dd><p>Summary table describing <code>ets</code> (the 
regressors), 
see <code><a href="#topic+summarize_etas">summarize_etas</a></code>.</p>
</dd>
<dt>eta_vcov</dt><dd><p>Variance-covariance matrix for the estimates of
<code>etas</code> (the regressors), see 
<code><a href="#topic+measure_eta_vcov">measure_eta_vcov</a></code>.</p>
</dd>
<dt>logLik</dt><dd><p>Across-iteration average of log-likelihoods 
(<code>lls</code>).</p>
</dd>
<dt>nparams</dt><dd><p>Total number of parameters in the full model,
including the change point locations and regressors.</p>
</dd>
<dt>deviance</dt><dd><p>Penalized negative log-likelihood, based on 
<code>logLik</code> and <code>nparams</code>.</p>
</dd>
</dl>
 
<p><code>check_TS_inputs</code>: An error message is thrown if any input
is not proper, else <code>NULL</code>.
</p>


<h3>References</h3>

<p>Bishop, C. M. 2006. <em>Pattern Recognition and Machine Learning</em>. 
Springer, New York, NY, USA.
</p>
<p>Christensen, E., D. J. Harris, and S. K. M. Ernest. 2018.
Long-term community change through multiple rapid transitions in a 
desert rodent community. <em>Ecology</em> <strong>99</strong>:1523-1529. 
<a href="https://pubmed.ncbi.nlm.nih.gov/29718539/">link</a>.
</p>
<p>Earl, D. J. and M. W. Deem. 2005. Parallel tempering: theory, 
applications, and new perspectives. <em>Physical Chemistry Chemical 
Physics</em> <strong>7</strong>: 3910-3916.
<a href="https://pubs.rsc.org/en/content/articlelanding/2005/CP/b509983h">link</a>.
</p>
<p>McCullagh, P. and J. A. Nelder. 1989. <em>Generalized Linear Models</em>.
2nd Edition. Chapman and Hall, New York, NY, USA.
</p>
<p>Ripley, B. D. 1996. <em>Pattern Recognition and Neural Networks</em>. 
Cambridge University Press, Cambridge, UK.
</p>
<p>Ruggieri, E. 2013. A Bayesian approach to detecting change points in 
climactic records. <em>International Journal of Climatology</em>
<strong>33</strong>:520-528.
<a href="https://mathcs.holycross.edu/~eruggier/joc3447.pdf">link</a>.
</p>
<p>Venables, W. N. and B. D. Ripley. 2002. <em>Modern and Applied
Statistics with S</em>. Fourth Edition. Springer, New York, NY, USA.
</p>
<p>Western, B. and M. Kleykamp. 2004. A Bayesian change point model for 
historical time series analysis. <em>Political Analysis</em>
<strong>12</strong>:354-374.
<a href="https://www.cambridge.org/core/journals/political-analysis/article/abs/bayesian-change-point-model-for-historical-time-series-analysis/F7D2EDBBC211278EC6C6CB43FE170812">link</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  weights &lt;- document_weights(document_term_table)

  TSmod &lt;- TS(data, gamma ~ 1, nchangepoints = 1, "newmoon", weights)

  check_TS_inputs(data, timename = "newmoon")

</code></pre>

<hr>
<h2 id='TS_control'>Create the controls list for the Time Series model</h2><span id='topic+TS_control'></span>

<h3>Description</h3>

<p>This function provides a simple creation and definition of a
list used to control the time series model fit occurring within 
<code><a href="#topic+TS">TS</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TS_control(
  memoise = TRUE,
  response = "gamma",
  lambda = 0,
  measurer = AIC,
  selector = min,
  ntemps = 6,
  penultimate_temp = 2^6,
  ultimate_temp = 1e+10,
  q = 0,
  nit = 10000,
  magnitude = 12,
  quiet = FALSE,
  burnin = 0,
  thin_frac = 1,
  summary_prob = 0.95,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TS_control_+3A_memoise">memoise</code></td>
<td>
<p><code>logical</code> indicator of whether the multinomial 
functions should be memoised (via <code><a href="memoise.html#topic+memoise">memoise</a></code>). 
Memoisation happens to both <code><a href="#topic+multinom_TS">multinom_TS</a></code> and 
<code><a href="#topic+multinom_TS_chunk">multinom_TS_chunk</a></code>.</p>
</td></tr>
<tr><td><code id="TS_control_+3A_response">response</code></td>
<td>
<p><code>character</code> element indicating the response variable 
used in the time series.</p>
</td></tr>
<tr><td><code id="TS_control_+3A_lambda">lambda</code></td>
<td>
<p><code>numeric</code> &quot;weight&quot; decay term used to set the prior
on the regressors within each chunk-level model. Defaults to 0, 
corresponding to a fully vague prior.</p>
</td></tr>
<tr><td><code id="TS_control_+3A_measurer">measurer</code>, <code id="TS_control_+3A_selector">selector</code></td>
<td>
<p>Function names for use in evaluation of the TS
models. <code>measurer</code> is used to create a value for each model
and <code>selector</code> operates on the values to choose the model.</p>
</td></tr>
<tr><td><code id="TS_control_+3A_ntemps">ntemps</code></td>
<td>
<p><code>integer</code> number of temperatures (chains) to use in the 
ptMCMC algorithm.</p>
</td></tr>
<tr><td><code id="TS_control_+3A_penultimate_temp">penultimate_temp</code></td>
<td>
<p>Penultimate temperature in the ptMCMC sequence.</p>
</td></tr>
<tr><td><code id="TS_control_+3A_ultimate_temp">ultimate_temp</code></td>
<td>
<p>Ultimate temperature in the ptMCMC sequence.</p>
</td></tr>
<tr><td><code id="TS_control_+3A_q">q</code></td>
<td>
<p>Exponent controlling the ptMCMC temperature sequence from the 
focal chain (reference with temperature = 1) to the penultimate chain. 0
(default) implies a geometric sequence. 1 implies squaring before 
exponentiating.</p>
</td></tr>
<tr><td><code id="TS_control_+3A_nit">nit</code></td>
<td>
<p><code>integer</code> number of iterations (steps) used in the ptMCMC
algorithm.</p>
</td></tr>
<tr><td><code id="TS_control_+3A_magnitude">magnitude</code></td>
<td>
<p>Average magnitude (defining a geometric distribution)
for the proposed step size in the ptMCMC algorithm.</p>
</td></tr>
<tr><td><code id="TS_control_+3A_quiet">quiet</code></td>
<td>
<p><code>logical</code> indicator of whether the model should run 
quietly (if <code>FALSE</code>, a progress bar and notifications are printed).</p>
</td></tr>
<tr><td><code id="TS_control_+3A_burnin">burnin</code></td>
<td>
<p><code>integer</code> number of iterations to remove from the 
beginning of the ptMCMC algorithm.</p>
</td></tr>
<tr><td><code id="TS_control_+3A_thin_frac">thin_frac</code></td>
<td>
<p>Fraction of iterations to retain, must be <code class="reqn">(0, 1]</code>,
and the default value of 1 represents no thinning.</p>
</td></tr>
<tr><td><code id="TS_control_+3A_summary_prob">summary_prob</code></td>
<td>
<p>Probability used for summarizing the posterior 
distributions (via the highest posterior density interval, see
<code><a href="coda.html#topic+HPDinterval">HPDinterval</a></code>).</p>
</td></tr>
<tr><td><code id="TS_control_+3A_seed">seed</code></td>
<td>
<p>Input to <code>set.seed</code> for replication purposes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>list</code>, with named elements corresponding to the arguments.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  TS_control()

</code></pre>

<hr>
<h2 id='TS_diagnostics_plot'>Plot the diagnostics of the parameters fit in a TS model</h2><span id='topic+TS_diagnostics_plot'></span><span id='topic+eta_diagnostics_plots'></span><span id='topic+rho_diagnostics_plots'></span>

<h3>Description</h3>

<p>Plot 4-panel figures (showing trace plots, posterior ECDF, 
posterior density, and iteration autocorrelation) for each of the 
parameters (change point locations and regressors) fitted within a 
multinomial time series model (fit by <code><a href="#topic+TS">TS</a></code>). <br /> <br />
<code>eta_diagnostics_plots</code> creates the diagnostic plots
for the regressors (etas) of a time series model. <br /> <br />
<code>rho_diagnostics_plots</code> creates the diagnostic plots
for the change point locations (rho) of a time series model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TS_diagnostics_plot(x, interactive = TRUE)

eta_diagnostics_plots(x, interactive)

rho_diagnostics_plots(x, interactive)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TS_diagnostics_plot_+3A_x">x</code></td>
<td>
<p>Object of class <code>TS_fit</code>, generated by <code><a href="#topic+TS">TS</a></code> to
have its diagnostics plotted.</p>
</td></tr>
<tr><td><code id="TS_diagnostics_plot_+3A_interactive">interactive</code></td>
<td>
<p><code>logical</code> input, should be codeTRUE unless
testing.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  weights &lt;- document_weights(document_term_table)
  TSmod &lt;- TS(data, gamma ~ 1, nchangepoints = 1, "newmoon", weights)
  TS_diagnostics_plot(TSmod)


</code></pre>

<hr>
<h2 id='TS_on_LDA'>Conduct a set of Time Series analyses on a set of LDA models</h2><span id='topic+TS_on_LDA'></span><span id='topic+check_TS_on_LDA_inputs'></span>

<h3>Description</h3>

<p>This is a wrapper function that expands the main Time Series
analyses function (<code><a href="#topic+TS">TS</a></code>) across the LDA models (estimated
using <code><a href="topicmodels.html#topic+LDA">LDA</a></code> or <code><a href="#topic+LDA_set">LDA_set</a></code> and the 
Time Series models, with respect to both continuous time formulas and the 
number of discrete changepoints. This function allows direct passage of
the control parameters for the parallel tempering MCMC through to the 
main Time Series function, <code><a href="#topic+TS">TS</a></code>, via the 
<code>ptMCMC_controls</code> argument. <br /> <br />
<code>check_TS_on_LDA_inputs</code> checks that the inputs to 
<code>TS_on_LDA</code> are of proper classes for a full analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TS_on_LDA(
  LDA_models,
  document_covariate_table,
  formulas = ~1,
  nchangepoints = 0,
  timename = "time",
  weights = NULL,
  control = list()
)

check_TS_on_LDA_inputs(
  LDA_models,
  document_covariate_table,
  formulas = ~1,
  nchangepoints = 0,
  timename = "time",
  weights = NULL,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TS_on_LDA_+3A_lda_models">LDA_models</code></td>
<td>
<p>List of LDA models (class <code>LDA_set</code>, produced by
<code><a href="#topic+LDA_set">LDA_set</a></code>) or a singular LDA model (class <code>LDA</code>,
produced by <code><a href="topicmodels.html#topic+LDA">LDA</a></code>).</p>
</td></tr>
<tr><td><code id="TS_on_LDA_+3A_document_covariate_table">document_covariate_table</code></td>
<td>
<p>Document covariate table (rows: documents,
columns: time index and covariate options). Every model needs a
covariate to describe the time value for each document (in whatever 
units and whose name in the table is input in <code>timename</code>)
that dictates the application of the change points. 
In addition, all covariates named within specific models in
<code>formula</code> must be included. Must be a conformable to a data table,
as verified by <code><a href="#topic+check_document_covariate_table">check_document_covariate_table</a></code>.</p>
</td></tr>
<tr><td><code id="TS_on_LDA_+3A_formulas">formulas</code></td>
<td>
<p>Vector of <code><a href="stats.html#topic+formula">formula</a></code>(s) for the 
continuous (non-change point) component of the time series models. Any 
predictor variable included in a formula must also be a column in the
<code>document_covariate_table</code>. Each element (formula) in the vector
is evaluated for each number of change points and each LDA model.</p>
</td></tr>
<tr><td><code id="TS_on_LDA_+3A_nchangepoints">nchangepoints</code></td>
<td>
<p>Vector of <code>integer</code>s corresponding to the number 
of change points to include in the time series models. 0 is a valid input 
corresponding to no change points (<em>i.e.</em>, a singular time series
model), and the current implementation can reasonably include up to 6 
change points. Each element in the vector is the number of change points 
used to segment the data for each formula (entry in <code>formulas</code>) 
component of the TS model, for each selected LDA model.</p>
</td></tr>
<tr><td><code id="TS_on_LDA_+3A_timename">timename</code></td>
<td>
<p><code>character</code> element indicating the time variable
used in the time series. Defaults to <code>"time"</code>. The variable must be
integer-conformable or a <code>Date</code>. If the variable named
is a <code>Date</code>, the input is converted to an integer, resulting in the
timestep being 1 day, which is often not desired behavior.</p>
</td></tr>
<tr><td><code id="TS_on_LDA_+3A_weights">weights</code></td>
<td>
<p>Optional class <code>numeric</code> vector of weights for each 
document. Defaults to <code>NULL</code>, translating to an equal weight for
each document. When using <code>multinom_TS</code> in a standard LDATS 
analysis, it is advisable to weight the documents by their total size,
as the result of <code><a href="topicmodels.html#topic+LDA">LDA</a></code> is a matrix of 
proportions, which does not account for size differences among documents.
For most models, a scaling of the weights (so that the average is 1) is
most appropriate, and this is accomplished using <code>document_weights</code>.</p>
</td></tr>
<tr><td><code id="TS_on_LDA_+3A_control">control</code></td>
<td>
<p>A <code>list</code> of parameters to control the fitting of the
Time Series model including the parallel tempering Markov Chain 
Monte Carlo (ptMCMC) controls. Values not input assume defaults set by 
<code><a href="#topic+TS_control">TS_control</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TS_on_LDA</code>: <code>TS_on_LDA</code>-class <code>list</code> of results 
from <code><a href="#topic+TS">TS</a></code> applied for each model on each LDA model input.
<br /> <br />
<code>check_TS_inputs</code>: An error message is thrown if any input
is not proper, else <code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDAs &lt;- LDA_set(document_term_table, topics = 2:3, nseeds = 2)
  LDA_models &lt;- select_LDA(LDAs)
  weights &lt;- document_weights(document_term_table)
  formulas &lt;- c(~ 1, ~ newmoon)
  mods &lt;- TS_on_LDA(LDA_models, document_covariate_table, formulas,
                    nchangepoints = 0:1, timename = "newmoon", weights)


</code></pre>

<hr>
<h2 id='TS_summary_plot'>Create the summary plot for a TS fit to an LDA model</h2><span id='topic+TS_summary_plot'></span><span id='topic+pred_gamma_TS_plot'></span><span id='topic+rho_hist'></span>

<h3>Description</h3>

<p>Produces a two-panel figure of [1] the change point 
distributions as histograms over time and [2] the time series of the 
fitted topic proportions over time, based on a selected set of 
change point locations. <br /> <br />
<code>pred_gamma_TS_plot</code> produces a time series of the 
fitted topic proportions over time, based on a selected set of change 
point locations. <br /> <br />
<code>rho_hist</code>: make a plot of the change point 
distributions as histograms over time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TS_summary_plot(
  x,
  cols = set_TS_summary_plot_cols(),
  bin_width = 1,
  xname = NULL,
  border = NA,
  selection = "median",
  LDATS = FALSE
)

pred_gamma_TS_plot(
  x,
  selection = "median",
  cols = set_gamma_colors(x),
  xname = NULL,
  together = FALSE,
  LDATS = FALSE
)

rho_hist(
  x,
  cols = set_rho_hist_colors(x$rhos),
  bin_width = 1,
  xname = NULL,
  border = NA,
  together = FALSE,
  LDATS = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TS_summary_plot_+3A_x">x</code></td>
<td>
<p>Object of class <code>TS_fit</code> produced by <code><a href="#topic+TS">TS</a></code>.</p>
</td></tr>
<tr><td><code id="TS_summary_plot_+3A_cols">cols</code></td>
<td>
<p><code>list</code> of elements used to define the colors for the two
panels, as generated simply using <code><a href="#topic+set_TS_summary_plot_cols">set_TS_summary_plot_cols</a></code>. 
Has two elements <code>rho</code> and <code>gamma</code>, each corresponding to the
related panel, and each containing default values for entries named
<code>cols</code>, <code>option</code>, and <code>alpha</code>. See
<code><a href="#topic+set_gamma_colors">set_gamma_colors</a></code> and <code><a href="#topic+set_rho_hist_colors">set_rho_hist_colors</a></code> for
details on usage.</p>
</td></tr>
<tr><td><code id="TS_summary_plot_+3A_bin_width">bin_width</code></td>
<td>
<p>Width of the bins used in the histograms, in units of the
x-axis (the time variable used to fit the model).</p>
</td></tr>
<tr><td><code id="TS_summary_plot_+3A_xname">xname</code></td>
<td>
<p>Label for the x-axis in the summary time series plot. Defaults
to <code>NULL</code>, which results in usage of the <code>timename</code> element
of the control list (held in<code>control$TS_control$timename</code>). To have
no label printed, set <code>xname = ""</code>.</p>
</td></tr>
<tr><td><code id="TS_summary_plot_+3A_border">border</code></td>
<td>
<p>Border for the histogram, default is <code>NA</code>.</p>
</td></tr>
<tr><td><code id="TS_summary_plot_+3A_selection">selection</code></td>
<td>
<p>Indicator of the change points to use. Currently only
defined for &quot;median&quot; and &quot;mode&quot;.</p>
</td></tr>
<tr><td><code id="TS_summary_plot_+3A_ldats">LDATS</code></td>
<td>
<p><code>logical</code> indicating if the plot is part of a larger 
LDATS plot output.</p>
</td></tr>
<tr><td><code id="TS_summary_plot_+3A_together">together</code></td>
<td>
<p><code>logical</code> indicating if the subplots are part of a 
larger LDA plot output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(rodents)
  document_term_table &lt;- rodents$document_term_table
  document_covariate_table &lt;- rodents$document_covariate_table
  LDA_models &lt;- LDA_set(document_term_table, topics = 2)[[1]]
  data &lt;- document_covariate_table
  data$gamma &lt;- LDA_models@gamma
  weights &lt;- document_weights(document_term_table)
  TSmod &lt;- TS(data, gamma ~ 1, nchangepoints = 1, "newmoon", weights)
  TS_summary_plot(TSmod)
  pred_gamma_TS_plot(TSmod)
  rho_hist(TSmod)


</code></pre>

<hr>
<h2 id='verify_changepoint_locations'>Verify the change points of a multinomial time series model</h2><span id='topic+verify_changepoint_locations'></span>

<h3>Description</h3>

<p>Verify that a time series can be broken into a set 
of chunks based on input change points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>verify_changepoint_locations(data, changepoints = NULL, timename = "time")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="verify_changepoint_locations_+3A_data">data</code></td>
<td>
<p>Class <code>data.frame</code> object including the predictor and 
response variables.</p>
</td></tr>
<tr><td><code id="verify_changepoint_locations_+3A_changepoints">changepoints</code></td>
<td>
<p>Numeric vector indicating locations of the change 
points. Must be conformable to <code>integer</code> values.</p>
</td></tr>
<tr><td><code id="verify_changepoint_locations_+3A_timename">timename</code></td>
<td>
<p><code>character</code> element indicating the time variable
used in the time series. Defaults to <code>"time"</code>. The variable must be
integer-conformable or a <code>Date</code>. If the variable named
is a <code>Date</code>, the input is converted to an integer, resulting in the
timestep being 1 day, which is often not desired behavior.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical indicator of the check passing <code>TRUE</code> or failing
<code>FALSE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(rodents)
  dtt &lt;- rodents$document_term_table
  lda &lt;- LDA_set(dtt, 2, 1, list(quiet = TRUE))
  dct &lt;- rodents$document_covariate_table
  dct$gamma &lt;- lda[[1]]@gamma
  verify_changepoint_locations(dct, changepoints = 100, 
                               timename = "newmoon")   

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
