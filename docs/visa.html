<!DOCTYPE html><html lang="en"><head><title>Help for package visa</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {visa}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#visa'><p>visa: Vegetation Imaging Spectroscopy Analyzer</p></a></li>
<li><a href='#as.spectra.dataframe'><p>Create a SpectraDataframe</p></a></li>
<li><a href='#cm.nsr'><p>Selecting the best 2-Band combinations for Normalized Simple Ratio (NSR)</p></a></li>
<li><a href='#cm.rbd3'><p>Calculate 3-Band Correlation Array for Spectral Data correlating with another variable x</p></a></li>
<li><a href='#cm.sr'><p>Selecting the best 2-Band combinations for Simple Ratio (SR)</p></a></li>
<li><a href='#find.bestBands'><p>Find Best Band Combinations</p></a></li>
<li><a href='#ggplot-method'><p>Plot functions</p></a></li>
<li><a href='#ggplot.cm'><p>Create a ggplot Plot from Correlation Coefficients (Deprecated)</p></a></li>
<li><a href='#ggplot.spectra'><p>Create a new ggplot plot with a geom_line() layer from spectra data</p></a></li>
<li><a href='#ndvi2'><p>Calculate and plot a 2-band NDVI.</p></a></li>
<li><a href='#NSpec.DF'><p>Example data in the Spectra.Dataframe format</p></a></li>
<li><a href='#NSpec.Lib'><p>Example data in the Spectra/SpectraLibrary format.</p></a></li>
<li><a href='#nsr'><p>Calculate Normalized Simple Ratio (NSR) index.</p></a></li>
<li><a href='#plt.2dcm'><p>Create a ggplot Plot from a 2D Correlation Matrix</p></a></li>
<li><a href='#plt.3dcm_best'><p>Create a 3D Slice Plot of Correlation Array</p></a></li>
<li><a href='#spectra'><p>Access the spectra data of 'SpectraLibrary'.</p></a></li>
<li><a href='#Spectra-class'><p>Create a Spectra or SpectraLibrary</p></a></li>
<li><a href='#SpectraDataframe-class'><p>Class 'SpectraDataframe'</p></a></li>
<li><a href='#SpectraLibrary-class'><p>Class 'SpectraLibrary'</p></a></li>
<li><a href='#SpectraMatrix-class'><p>Class 'SpectraMatrix'</p></a></li>
<li><a href='#sr'><p>Calculate Simple Ratio (SR).</p></a></li>
<li><a href='#wavelength'><p>Retrieve Wavelength Information from Spectra Objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Vegetation Imaging Spectroscopy Analyzer</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides easy-to-use tools for data analysis and visualization for hyperspectral remote sensing (also known as imaging spectroscopy), with 
    a particular focus on vegetation hyperspectral data analysis. It consists of a set of functions, ranging from the organization of hyperspectral data 
    in the proper data structure for spectral feature selection, calculation of vegetation index, multivariate analysis, as well as to the visualization 
    of spectra and results of analysis in the 'ggplot2' style.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/kang-yu/visa">https://github.com/kang-yu/visa</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/kang-yu/visa/issues">https://github.com/kang-yu/visa/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, ggpmisc, methods, magrittr, Matrix, plot3D, plotly,
reshape2, RColorBrewer</td>
</tr>
<tr>
<td>Suggests:</td>
<td>devtools, testthat, knitr, rmarkdown, stringi</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Collate:</td>
<td>'visa.R' 'Spectra-class.R' 'cm.nsr.R' 'cm.rbd3.R' 'cm.sr.R'
'data-specdf.R' 'data-speclib.R' 'find.bestBands.R'
'ggplot-method.R' 'ggplot.cm.R' 'ggplot.lmfit.R'
'ggplot.spectra.R' 'ndvi2.R' 'nsr.R' 'plt.2dcm.R'
'plt.3dcm_best.R' 'spectra.R' 'sr.R' 'wavelength.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-19 19:34:09 UTC; Yu</td>
</tr>
<tr>
<td>Author:</td>
<td>Kang Yu [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kang Yu &lt;kang.yu@outlook.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-19 19:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='visa'>visa: Vegetation Imaging Spectroscopy Analyzer</h2><span id='topic+visa-package'></span><span id='topic+visa'></span>

<h3>Description</h3>

<p>Provides easy-to-use tools for data analysis and visualization for hyperspectral remote sensing (also known as imaging spectroscopy), with a particular focus on vegetation hyperspectral data analysis. It consists of a set of functions, ranging from the organization of hyperspectral data in the proper data structure for spectral feature selection, calculation of vegetation index, multivariate analysis, as well as to the visualization of spectra and results of analysis in the 'ggplot2' style.
</p>


<h3>Details</h3>

<p>The visa package provides a set of functions for hyperspectral data analysis,
with the main purpose of simplifying the analysis and interpretation of
vegetation spectral data.
</p>
<p>It implement two categories of important functions, including its own function
and also some built on other r packages.
</p>

<ul>
<li><p> vegetation indices, and
</p>
</li>
<li><p> multivariate analyses....
</p>
</li></ul>

<p>To know more about visa, check the vignettes:
'browseVignettes(&quot;visa&quot;)'
</p>


<h3>Vegetation Indices</h3>

<p>Support the calculation of vegetation indices from literature, as well as
creation of new indices.
</p>


<h3>Multivariate analysis</h3>

<p>... not implemented yet
The multivariate analysis use the Spectra.Dataframe format.
</p>


<h3>Author(s)</h3>

<p>Kang Yu
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/kang-yu/visa">https://github.com/kang-yu/visa</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/kang-yu/visa/issues">https://github.com/kang-yu/visa/issues</a>
</p>
</li></ul>


<hr>
<h2 id='as.spectra.dataframe'>Create a SpectraDataframe</h2><span id='topic+as.spectra.dataframe'></span><span id='topic+as.specdf'></span>

<h3>Description</h3>

<p>Constructor <code>as.spectra.dataframe</code> function creates a SpectraDataframe object, which is equivalent to the use of <a href="#topic+as.specdf">as.specdf</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.spectra.dataframe(
  spectra = matrix(0),
  wavelength = numeric(0),
  w.unit = character(0),
  data = data.frame(0),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.spectra.dataframe_+3A_spectra">spectra</code></td>
<td>
<p>A matrix</p>
</td></tr>
<tr><td><code id="as.spectra.dataframe_+3A_wavelength">wavelength</code></td>
<td>
<p>A numeric vector</p>
</td></tr>
<tr><td><code id="as.spectra.dataframe_+3A_w.unit">w.unit</code></td>
<td>
<p>A character string</p>
</td></tr>
<tr><td><code id="as.spectra.dataframe_+3A_data">data</code></td>
<td>
<p>A data.frame</p>
</td></tr>
<tr><td><code id="as.spectra.dataframe_+3A_...">...</code></td>
<td>
<p>Other options for similar format of variables</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>sdf</code></td>
<td>
<p>Returns a SpectraDataframe.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>sdf &lt;- as.spectra.dataframe(matrix(1:10, 1), 1:10, "nm", data.frame(a = 1, b =2))
str(sdf)
</code></pre>

<hr>
<h2 id='cm.nsr'>Selecting the best 2-Band combinations for Normalized Simple Ratio (NSR)</h2><span id='topic+cm.nsr'></span>

<h3>Description</h3>

<p>This function develops an optimization algorithm based on correlation analysis between the spectral matrix <code>spectra</code> and the
vegetation variable of interest <code>x</code>. It determines the best spectral band combinations (i, j) of the full spectrum that are most predictive for <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cm.nsr(S, x, w = wavelength(S), w.unit = NULL, cm.plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cm.nsr_+3A_s">S</code></td>
<td>
<p>A matrix of spectral data, where each row is a spectrum across all spectral bands.</p>
</td></tr>
<tr><td><code id="cm.nsr_+3A_x">x</code></td>
<td>
<p>A numeric vector (e.g., a vegetation variable).</p>
</td></tr>
<tr><td><code id="cm.nsr_+3A_w">w</code></td>
<td>
<p>A numeric vector of wavelengths; by default it is derived using <code>wavelength(S)</code>.</p>
</td></tr>
<tr><td><code id="cm.nsr_+3A_w.unit">w.unit</code></td>
<td>
<p>A character string specifying the unit of wavelengths (default is <code>NULL</code>).</p>
</td></tr>
<tr><td><code id="cm.nsr_+3A_cm.plot">cm.plot</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the correlation coefficient matrix is plotted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For every possible pair of distinct bands (i, j), the function calculates
</p>
<p style="text-align: center;"><code class="reqn"> \mathrm{NSR} = \frac{R_j - R_i}{R_j + R_i} </code>
</p>

<p>and then computes the squared Pearson correlation (<code class="reqn">R^2</code>) between <code>x</code> and the resulting NSR values.
</p>
<p>If the two bands are identical or the standard deviation of computed <code>VI</code> (for a given band combination) is zero, the correlation is set to 0,
thereby avoiding warnings.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>cm</code></td>
<td>
<p>A correlation coefficient matrix with squared Pearson correlation values.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+cor">cor</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  library(visa)
  data(NSpec.DF)
  X &lt;- NSpec.DF$spectra[, seq(1, ncol(NSpec.DF$spectra), 5)]  # resampled to 5 nm steps
  y &lt;- NSpec.DF$N  # nitrogen
  cm &lt;- cm.nsr(X, y, cm.plot = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='cm.rbd3'>Calculate 3-Band Correlation Array for Spectral Data correlating with another variable x</h2><span id='topic+cm.rbd3'></span>

<h3>Description</h3>

<p>This function computes the squared Pearson correlation (<code class="reqn">R^2</code>) between a response vector <code>x</code>
and a derived variable <code class="reqn">V</code> for every possible combination of three distinct spectral bands. The derived variable <code class="reqn">V</code>
is calculated using the formula:
</p>
<p style="text-align: center;"><code class="reqn">V = \frac{R_k - R_j}{R_j - R_i}</code>
</p>

<p>where <code class="reqn">R_i</code>, <code class="reqn">R_j</code>, and <code class="reqn">R_k</code> represent the reflectance values at bands <code class="reqn">i</code>, <code class="reqn">j</code>, and <code class="reqn">k</code>, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cm.rbd3(
  S,
  x,
  w = wavelength(S),
  w.unit = NULL,
  cm.plot = FALSE,
  plot.method = "default"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cm.rbd3_+3A_s">S</code></td>
<td>
<p>A spectral data object or matrix. Each column corresponds to a spectral band.</p>
</td></tr>
<tr><td><code id="cm.rbd3_+3A_x">x</code></td>
<td>
<p>A numeric vector representing the response variable (e.g., chlorophyll).</p>
</td></tr>
<tr><td><code id="cm.rbd3_+3A_w">w</code></td>
<td>
<p>A numeric vector of wavelengths; by default, it is derived using <code>wavelength(S)</code>.</p>
</td></tr>
<tr><td><code id="cm.rbd3_+3A_w.unit">w.unit</code></td>
<td>
<p>Character string specifying the unit of wavelengths (optional).</p>
</td></tr>
<tr><td><code id="cm.rbd3_+3A_cm.plot">cm.plot</code></td>
<td>
<p>Logical. If <code>TRUE</code>, a 3D slice plot of the correlation array is generated.</p>
</td></tr>
<tr><td><code id="cm.rbd3_+3A_plot.method">plot.method</code></td>
<td>
<p>Character string specifying the plotting method. Currently, the plotting option uses <code>plot3D</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function prints the maximum <code class="reqn">R^2</code> value and the corresponding band wavelengths. Optionally, it can produce a 3D slice plot
of the correlation array using <code>plot3D::slice3D</code>.
</p>
<p>For every combination of three distinct bands (<code class="reqn">i</code>, <code class="reqn">j</code>, <code class="reqn">k</code>), the function computes
</p>
<p style="text-align: center;"><code class="reqn">V = \frac{R_k - R_j}{R_j - R_i}</code>
</p>

<p>and then calculates the squared Pearson correlation between <code>x</code> and <code>V</code>.
The maximum <code class="reqn">R^2</code> value and its associated band combination are printed.
</p>
<p>If <code>cm.plot</code> is set to <code>TRUE</code>, the function generates a 3D slice plot of the correlation array using the best band combination,
where the slices correspond to the wavelengths of the bands.
</p>


<h3>Value</h3>

<p>A 3-dimensional array of squared correlation (<code class="reqn">R^2</code>) values with dimensions corresponding to the
combinations of bands <code class="reqn">i</code>, <code class="reqn">j</code>, and <code class="reqn">k</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  library(visa)
  data(NSpec.DF)
  x &lt;- NSpec.DF$N # nitrogen
  # Below resamples spectra to 20 nm for fast computation
  S &lt;- NSpec.DF$spectra[, seq(1, ncol(NSpec.DF$spectra), 20)]
  # S is a spectral data object and x is a numeric vector.
  Rsq3 &lt;- cm.rbd3(S, x, cm.plot = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='cm.sr'>Selecting the best 2-Band combinations for Simple Ratio (SR)</h2><span id='topic+cm.sr'></span>

<h3>Description</h3>

<p>This function develops an optimization algorithm based on correlation analysis between the spectral matrix <code>spectra</code> and the
vegetation variable of interest <code>x</code>. It determines the best spectral band combinations of the full spectrum that are most predictive for <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cm.sr(S, x, w = wavelength(S), w.unit = NULL, cm.plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cm.sr_+3A_s">S</code></td>
<td>
<p>A matrix of spectral data, where each row is a spectrum across all spectral bands.</p>
</td></tr>
<tr><td><code id="cm.sr_+3A_x">x</code></td>
<td>
<p>A numeric vector (e.g., a vegetation variable).</p>
</td></tr>
<tr><td><code id="cm.sr_+3A_w">w</code></td>
<td>
<p>A numeric vector of wavelengths; by default it is derived using <code>wavelength(S)</code>.</p>
</td></tr>
<tr><td><code id="cm.sr_+3A_w.unit">w.unit</code></td>
<td>
<p>A character string specifying the unit of wavelengths (default is <code>NULL</code>).</p>
</td></tr>
<tr><td><code id="cm.sr_+3A_cm.plot">cm.plot</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the correlation coefficient matrix is plotted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function runs a calculation of </p>
<p style="text-align: center;"><code class="reqn"> SR = \lambda_i / \lambda_j </code>
</p>
<p> using the spectra data for all the possible pairs/combinations of any two bands (i, j)
within the full spectrum range. Next, correlation analysis is then performed between all possible SR values and another vector variable <code>y</code>, and it returns
the squared Pearson correlation (<code class="reqn">R^2</code>) which indicates the predictive performance of each SR and its corresponding two-band combination. The
output is the wavelength (nm) indicating the best two bands that produce the highest value of <code class="reqn">R^2</code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>cm</code></td>
<td>
<p>Returns a correlation coefficients matrix.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+cm.nsr">cm.nsr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  library(visa)
  data(NSpec.DF)
  # Using the example spectra matrix of the spectra.dataframe
  X &lt;- NSpec.DF$spectra[, seq(1, ncol(NSpec.DF$spectra), 10)]  # resampled to 10 nm steps
  y &lt;- NSpec.DF$N  # nitrogen
  cm &lt;- cm.sr(X, y, cm.plot = FALSE)

## End(Not run)

</code></pre>

<hr>
<h2 id='find.bestBands'>Find Best Band Combinations</h2><span id='topic+find.bestBands'></span>

<h3>Description</h3>

<p>This function identifies the best band combination from the <a href="#topic+cm.nsr">cm.nsr</a> or <a href="#topic+cm.sr">cm.sr</a>
calculated correlation coefficients - a numeric matrix (2D), or the <a href="#topic+cm.rbd3">cm.rbd3</a> returned array (3D)
by locating the maximum value in the input <code>R</code> and returning the corresponding wavelengths
from <code>w</code>. For a 2D matrix, it returns a two-element vector (i, j); for a 3D array, a three-element
vector (i, j, k).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find.bestBands(R, w)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="find.bestBands_+3A_r">R</code></td>
<td>
<p>A numeric matrix (2D) or array (3D) containing metric values (e.g., correlation values).</p>
</td></tr>
<tr><td><code id="find.bestBands_+3A_w">w</code></td>
<td>
<p>A numeric vector of wavelengths corresponding to the bands.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function first verifies that <code>R</code> has dimensions. It then computes the maximum value in <code>R</code>,
retrieves the indices corresponding to that value, and extracts the wavelengths from <code>w</code> based on the
dimensionality of <code>R</code>. If <code>R</code> is 2D, the order is assumed to be (i, j); if <code>R</code> is 3D, the order
is (i, j, k).
</p>


<h3>Value</h3>

<p>A vector of wavelengths corresponding to the best band combination.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example for a 2D matrix:
R_mat &lt;- matrix(c(0.2, 0.8, 0.5, 0.3), nrow = 2)
wavelengths &lt;- c(450, 550)
bestBands &lt;- find.bestBands(R_mat, wavelengths)

# Example for a 3D array:
R_arr &lt;- array(runif(27), dim = c(3, 3, 3))
wavelengths &lt;- c(400, 450, 500)
bestBands &lt;- find.bestBands(R_arr, wavelengths)

</code></pre>

<hr>
<h2 id='ggplot-method'>Plot functions</h2><span id='topic+ggplot-method'></span><span id='topic+ggplot.lmfit'></span>

<h3>Description</h3>

<p>This function plots a linear model fit using ggplot2. It creates a scatter plot with a regression line,
and displays the regression equation along with the R² value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmfit'
ggplot(data, mapping = NULL, ..., environment = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggplot-method_+3A_data">data</code></td>
<td>
<p>Either a numeric vector (to be used as x) or an object containing the data (e.g., a data frame).</p>
</td></tr>
<tr><td><code id="ggplot-method_+3A_mapping">mapping</code></td>
<td>
<p>Either a numeric vector (to be used as y when data is numeric) or an aesthetic mapping
created with <code>ggplot2::aes()</code>. If <code>mapping</code> is missing and <code>data</code> is a data frame,
the default mapping <code>aes(x, y)</code> is used.</p>
</td></tr>
<tr><td><code id="ggplot-method_+3A_...">...</code></td>
<td>
<p>Other arguments passed to ggplot2 components.</p>
</td></tr>
<tr><td><code id="ggplot-method_+3A_environment">environment</code></td>
<td>
<p>The environment in which to evaluate the plot. Defaults to <code>parent.frame()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When provided with two numeric vectors, the function treats them as x and y values, respectively,
constructs a data frame, and applies a default mapping. Alternatively, if a data frame is provided,
an aesthetic mapping (or default mapping) will be used.
</p>


<h3>Value</h3>

<p>A ggplot object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  library(visa)
  # Using numeric vectors for x and y:
  ggplot.lmfit(1:10, 2:11)

  # Using a data frame:
  df &lt;- data.frame(x = runif(10, 1, 10), y = runif(10, 2, 11) + 0.5)
  ggplot.lmfit(df, aes(x, y))

## End(Not run)

</code></pre>

<hr>
<h2 id='ggplot.cm'>Create a ggplot Plot from Correlation Coefficients (Deprecated)</h2><span id='topic+ggplot.cm'></span>

<h3>Description</h3>

<p>**Deprecated:** This function is deprecated and will be removed in a future release.
Please use <code>plt.2dcm</code> for 2D correlation matrices or the appropriate new functions for 3D plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cm'
ggplot(
  data,
  mapping = NULL,
  ...,
  show.stat = TRUE,
  environment = parent.frame()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggplot.cm_+3A_data">data</code></td>
<td>
<p>A numeric 2D matrix of correlation coefficients. (For 3D arrays, a warning is issued.)</p>
</td></tr>
<tr><td><code id="ggplot.cm_+3A_mapping">mapping</code></td>
<td>
<p>Optional ggplot2 aesthetic mapping.</p>
</td></tr>
<tr><td><code id="ggplot.cm_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>ggplot</code>.</p>
</td></tr>
<tr><td><code id="ggplot.cm_+3A_show.stat">show.stat</code></td>
<td>
<p>Logical. If <code>TRUE</code>, prints the best <code class="reqn">R^2</code> value and corresponding bands.</p>
</td></tr>
<tr><td><code id="ggplot.cm_+3A_environment">environment</code></td>
<td>
<p>The environment in which to evaluate the plot. Defaults to <code>parent.frame()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates a ggplot visualization from a 2D correlation matrix.
It attempts to extract numeric wavelengths from the column names of the input matrix.
</p>
<p>This function extracts numeric wavelengths from the column names of <code>data</code>. If these
cannot be determined, sequential indices are used instead.
</p>


<h3>Value</h3>

<p>A ggplot object visualizing the correlation matrix. For 3D arrays, returns <code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  library(visa)
  data(NSpec.DF)
  x &lt;- NSpec.DF$N  # nitrogen
   # resampled to 10 nm steps
  S &lt;- NSpec.DF$spectra[, seq(1, ncol(NSpec.DF$spectra), 10)]
  cm2d &lt;- cm.sr(S, x, cm.plot = FALSE)
  p2d &lt;- ggplot.cm(cm2d)
  print(p2d)


## End(Not run)

</code></pre>

<hr>
<h2 id='ggplot.spectra'>Create a new ggplot plot with a geom_line() layer from spectra data</h2><span id='topic+ggplot.spectra'></span>

<h3>Description</h3>

<p><code>ggplot()</code> initializes a ggplot object. It can be used to
declare the input spectra object for a graphic and to optionally specify the
set of plot aesthetics intended to be common throughout all
subsequent layers unless specifically overridden.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spectra'
ggplot(
  data,
  mapping = NULL,
  ...,
  wl = NULL,
  w.unit = "nm",
  environment = parent.frame()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggplot.spectra_+3A_data">data</code></td>
<td>
<p>Default spectra database to use for plot. If not a spectra database, the
methods used will be those defined in package <code>ggplot2</code>. See <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.
If not specified, must be supplied in each layer added to the plot.</p>
</td></tr>
<tr><td><code id="ggplot.spectra_+3A_mapping">mapping</code></td>
<td>
<p>Default list of aesthetic mappings to use for plot.
If not specified, in the case of spectra objects, a default mapping will
be used.</p>
</td></tr>
<tr><td><code id="ggplot.spectra_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to methods. Not currently used.</p>
</td></tr>
<tr><td><code id="ggplot.spectra_+3A_wl">wl</code></td>
<td>
<p>numeric The wavelength vector.</p>
</td></tr>
<tr><td><code id="ggplot.spectra_+3A_w.unit">w.unit</code></td>
<td>
<p>character The wavelength unit of the spectra.</p>
</td></tr>
<tr><td><code id="ggplot.spectra_+3A_environment">environment</code></td>
<td>
<p>If an variable defined in the aesthetic mapping is not
found in the data, ggplot will look for it in this environment. It defaults
to using the environment in which <code>ggplot()</code> is called.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ggplot()</code> is typically used to construct a plot
incrementally, using the + operator to add layers to the
existing ggplot object. This is advantageous in that the
code is explicit about which layers are added and the order
in which they are added. For complex graphics with multiple
layers, initialization with <code>ggplot</code> is recommended.
</p>


<h3>Note</h3>

<p>Current implementation does not merge default mapping with user
supplied mapping. If user supplies a mapping, it is used as is.
To add to the default mapping, aes() can be used by itself to compose
the ggplot.
</p>


<h3>See Also</h3>

<p><code>?ggpmisc::ggplot()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(visa)
library(ggplot2)
ggplot.spectra(NSpec.DF)

</code></pre>

<hr>
<h2 id='ndvi2'>Calculate and plot a 2-band NDVI.</h2><span id='topic+ndvi2'></span>

<h3>Description</h3>

<p>This function calculates a 2-band NDVI using the <code><a href="#topic+nsr">nsr</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ndvi2(s, b1, b2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ndvi2_+3A_s">s</code></td>
<td>
<p>Spectral data in the format of visa's Spectra object, spectra.dataframe or spectra.matrix.</p>
</td></tr>
<tr><td><code id="ndvi2_+3A_b1">b1</code></td>
<td>
<p>A integer number which defines the wavelength of the 1st spectral band.</p>
</td></tr>
<tr><td><code id="ndvi2_+3A_b2">b2</code></td>
<td>
<p>A integer number which defines the wavelength of the 2nd spectral band.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculate a NDVI with two specific bands of choice. The new NDVI follows the
the standard formula </p>
<p style="text-align: center;"><code class="reqn">NDVI = (\lambda_i + \lambda_j)/(\lambda_i - \lambda_j)</code>
</p>
<p>.
Bands i and j correspond to the b1 and b2 input arguments, respectively. Wavelength
indexes are determined based on the first argument 's'.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>ndvi</code></td>
<td>
<p>The returned values are the new NDVI.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(visa)
s &lt;- NSpec.DF$spectra
ndvi2(s, 780, 680)

</code></pre>

<hr>
<h2 id='NSpec.DF'>Example data in the Spectra.Dataframe format</h2><span id='topic+NSpec.DF'></span><span id='topic+Data-Spectra.Dataframe'></span>

<h3>Description</h3>

<p>A dataset containing the plant Nitrogen content and spectra.
The Spectra matrix is stored as a variable (in a column) of a data.frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NSpec.DF
</code></pre>


<h3>Format</h3>

<p>A data frame with 19 rows and 2 variables:
</p>

<dl>
<dt>N</dt><dd><p>Plant nitrogen content</p>
</dd>
<dt>spectra</dt><dd><p>A variable of Matrix of plant spectra</p>
</dd>
</dl>
<p>...

</p>


<h3>See Also</h3>

<p><a href="base.html#topic+data.frame">data.frame</a> and <code><a href="#topic+NSpec.Lib">NSpec.Lib</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(visa)
data(NSpec.DF)
str(NSpec.DF)
</code></pre>

<hr>
<h2 id='NSpec.Lib'>Example data in the Spectra/SpectraLibrary format.</h2><span id='topic+NSpec.Lib'></span><span id='topic+Data-SpectraLibrary+2C'></span><span id='topic+Data-speclib+2C'></span><span id='topic+Data-Spectra'></span>

<h3>Description</h3>

<p>A S4 data structure containing the plant spectra and nitorgen (N) content. Spectra is organized as a matrix and is stored as a slot,
named 'spectra'. The corresponding N content is stored in the slot 'data', which is a data.frame used for storing supporting data and
plant/vegetation traits, such as here the plant N content.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NSpec.Lib
</code></pre>


<h3>Format</h3>

<p>A Spectra object with 19 rows and 4 slots (spectra, wavelength, w.unit, data).
</p>

<dl>
<dt>spectra</dt><dd><p>A matrix of plant spectral data</p>
</dd>
<dt>wavelength</dt><dd><p>A vector of wavelength for the 'spectra' data</p>
</dd>
<dt>w.unit</dt><dd><p>A character string of wavelength unit (default &quot;nm&quot;)</p>
</dd>
<dt>data</dt><dd><p>A data.frame of vegetation traits, here plant nitrogen content</p>
</dd>
</dl>
<p><code>...{currently not used}</code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(visa)
data(NSpec.Lib)
str(NSpec.Lib)

</code></pre>

<hr>
<h2 id='nsr'>Calculate Normalized Simple Ratio (NSR) index.</h2><span id='topic+nsr'></span><span id='topic+lm.nsr'></span>

<h3>Description</h3>

<p>It is a normalization of SR by doing NSR = (1-SR)/(1+SR), with the same two spectral bands.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nsr(s, b1, b2)

lm.nsr(s, b1, b2, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nsr_+3A_s">s</code></td>
<td>
<p>Spectral data in the format of visa's Spectra object, spectra.dataframe or spectra.matrix.</p>
</td></tr>
<tr><td><code id="nsr_+3A_b1">b1</code></td>
<td>
<p>A integer number which defines the wavelength of the 1st spectral band.</p>
</td></tr>
<tr><td><code id="nsr_+3A_b2">b2</code></td>
<td>
<p>A integer number which defines the wavelength of the 2nd spectral band.</p>
</td></tr>
<tr><td><code id="nsr_+3A_y">y</code></td>
<td>
<p>A numeric variable to correlate with SR</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As it exactly reads in its name, it is a normalization of the SR and ranges in (0,1).
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>nsr</code></td>
<td>
<p>Returns a NSR index.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Returns a ggplot object.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>s &lt;- NSpec.DF$spectra
nsr1 &lt;- nsr(s, 480, 550)

s &lt;- NSpec.DF
y &lt;- NSpec.DF$N
lm.nsr(s,600,500,y)

</code></pre>

<hr>
<h2 id='plt.2dcm'>Create a ggplot Plot from a 2D Correlation Matrix</h2><span id='topic+plt.2dcm'></span>

<h3>Description</h3>

<p>This function creates a ggplot visualization from a 2D correlation matrix,
such as those produced by <code>cm.sr</code> or <code>cm.nsr</code>. The function attempts
to extract numeric wavelengths from the column names. If the extraction fails,
sequential indices are used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plt.2dcm(
  data,
  mapping = NULL,
  ...,
  show.stat = TRUE,
  environment = parent.frame()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plt.2dcm_+3A_data">data</code></td>
<td>
<p>A numeric 2D matrix of correlation coefficients.</p>
</td></tr>
<tr><td><code id="plt.2dcm_+3A_mapping">mapping</code></td>
<td>
<p>Optional ggplot2 aesthetic mapping.</p>
</td></tr>
<tr><td><code id="plt.2dcm_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>ggplot</code>.</p>
</td></tr>
<tr><td><code id="plt.2dcm_+3A_show.stat">show.stat</code></td>
<td>
<p>Logical. If <code>TRUE</code>, prints the best <code class="reqn">R^2</code> value and corresponding bands.</p>
</td></tr>
<tr><td><code id="plt.2dcm_+3A_environment">environment</code></td>
<td>
<p>The environment in which to evaluate the plot. Defaults to <code>parent.frame()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It replaces the former <code>ggplot.cm()</code>.
</p>
<p>The function extracts numeric wavelengths from the column names of <code>data</code>.
If these cannot be determined, sequential indices are used instead.
</p>


<h3>Value</h3>

<p>A ggplot object visualizing the correlation matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  library(visa)
  data(NSpec.DF)
  x &lt;- NSpec.DF$N  # nitrogen
  S &lt;- NSpec.DF$spectra[, seq(1, ncol(NSpec.DF$spectra), 10)]  # resampled to 10 nm steps
  cm2d &lt;- cm.sr(S, x, cm.plot = FALSE)
  p2d &lt;- plt.2dcm(cm2d)
  print(p2d)

## End(Not run)

</code></pre>

<hr>
<h2 id='plt.3dcm_best'>Create a 3D Slice Plot of Correlation Array</h2><span id='topic+plt.3dcm_best'></span>

<h3>Description</h3>

<p>This function creates an interactive Plotly 3D slice plot from a 3D correlation array.
The function uses the array's dimnames to define the coordinate values. If no dimnames are present,
a warning is issued and sequential indices are used. The plot displays three surfaces corresponding
to slices along each dimension (i, j, k) at the best band combination (where the correlation value is maximal).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plt.3dcm_best(R3, colorscale = "Spectral")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plt.3dcm_best_+3A_r3">R3</code></td>
<td>
<p>A 3D numeric array of correlation coefficients.</p>
</td></tr>
<tr><td><code id="plt.3dcm_best_+3A_colorscale">colorscale</code></td>
<td>
<p>A character string specifying the colorscale to use. If <code>"Spectral"</code>, a custom
colorscale is created using <code>colorRampPalette(rev(RColorBrewer::brewer.pal(11, "Spectral")), space = "Lab")(100)</code>.
Otherwise, the provided value is used (default is <code>"Spectral"</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function first checks if the input 3D array has proper dimnames. If not, it issues a warning
and assigns sequential indices as dimnames. It then melts the array to find the best band combination based on the
maximum correlation value. Using the dimnames, it finds the numeric indices for the best bands and creates grid matrices
for each slice. A custom colorscale is built when <code>colorscale = "Spectral"</code>, and the Plotly figure is constructed
with a single color bar.
</p>


<h3>Value</h3>

<p>An interactive Plotly figure showing three surfaces corresponding to constant slices along dimensions i, j, and k.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  # Assume cm3d is a 3D correlation array with proper dimnames.
  plt.3dcm_best(cm3d)

## End(Not run)

</code></pre>

<hr>
<h2 id='spectra'>Access the spectra data of 'SpectraLibrary'.</h2><span id='topic+spectra'></span><span id='topic+spectra+2CSpectra-method'></span><span id='topic+spectra+2CSpectra+2CANY-method'></span><span id='topic+spectra+2Cdata.frame-method'></span><span id='topic+spectra+2Cdata.frame+2CANY-method'></span><span id='topic+spectra+2Cmatrix-method'></span><span id='topic+spectra+2Cmatrix+2CANY-method'></span>

<h3>Description</h3>

<p>Functions to access slot data of the Class Spectra.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spectra(object, ...)

## S4 method for signature 'Spectra'
spectra(object, ...)

## S4 method for signature 'data.frame'
spectra(object, ...)

## S4 method for signature 'matrix'
spectra(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spectra_+3A_object">object</code></td>
<td>
<p>A Spectra object, spectra.data.frame, or spectra.matrix.</p>
</td></tr>
<tr><td><code id="spectra_+3A_...">...</code></td>
<td>
<p>Other options.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Construct generic functions for the Spectra object, spectra.data.frame,
and spectra.matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For the S4 class 'Spectra'
library(visa)
data(NSpec.Lib)
spectra_matrix &lt;- spectra(NSpec.Lib)
# For the spectra data.frame
data(NSpec.DF)
spectra_matrix &lt;- spectra(NSpec.DF)

</code></pre>

<hr>
<h2 id='Spectra-class'>Create a Spectra or SpectraLibrary</h2><span id='topic+Spectra-class'></span><span id='topic+Spectra'></span><span id='topic+Spectra+2CSpectra-class'></span><span id='topic+as.spectra'></span><span id='topic+as.spectra.library'></span>

<h3>Description</h3>

<p>Constructor <code>as.spectra</code> creates a Spectra object.
</p>
<p>Constructor <code>as.spectra.library</code> creates a SpectraLibrary object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.spectra(
  spectra = matrix(0),
  wavelength = numeric(0),
  w.unit = "nm",
  data = data.frame(),
  ...
)

as.spectra.library(
  spectra = matrix(0),
  wavelength = numeric(0),
  w.unit = "nm",
  data = data.frame(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Spectra-class_+3A_spectra">spectra</code></td>
<td>
<p>A matrix</p>
</td></tr>
<tr><td><code id="Spectra-class_+3A_wavelength">wavelength</code></td>
<td>
<p>A numeric vector</p>
</td></tr>
<tr><td><code id="Spectra-class_+3A_w.unit">w.unit</code></td>
<td>
<p>A character string</p>
</td></tr>
<tr><td><code id="Spectra-class_+3A_data">data</code></td>
<td>
<p>A data.frame</p>
</td></tr>
<tr><td><code id="Spectra-class_+3A_...">...</code></td>
<td>
<p>Other parameters</p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>spectra</code></dt><dd><p>A matrix</p>
</dd>
<dt><code>wavelength</code></dt><dd><p>A numeric vector</p>
</dd>
<dt><code>w.unit</code></dt><dd><p>A character string</p>
</dd>
<dt><code>data</code></dt><dd><p>A data.frame</p>
</dd>
</dl>


<h3>Examples</h3>

<pre><code class='language-R'>s &lt;- as.spectra(matrix(1:100, 4), 1:25, "nm", data.frame(x = letters[1:4]))
str(s)

s &lt;- as.spectra.library(matrix(1:100, 4), 1:25, "nm", data.frame(x = letters[1:4]))
str(s)
</code></pre>

<hr>
<h2 id='SpectraDataframe-class'>Class 'SpectraDataframe'</h2><span id='topic+SpectraDataframe-class'></span><span id='topic+SpectraDataframe+2C'></span><span id='topic+spectra.dataframe'></span>

<h3>Description</h3>

<p>SpectraDataframe is an extended 'Spectra' class, with associated vegetation data ('data')
in a <a href="base.html#topic+data.frame">data.frame</a>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>spectra</code></dt><dd><p>A matrix</p>
</dd>
<dt><code>wavelength</code></dt><dd><p>A numeric vector</p>
</dd>
<dt><code>w.unit</code></dt><dd><p>A character string</p>
</dd>
<dt><code>data</code></dt><dd><p>A data.frame of vegetation data corresponding to the spectra</p>
</dd>
</dl>

<hr>
<h2 id='SpectraLibrary-class'>Class 'SpectraLibrary'</h2><span id='topic+SpectraLibrary-class'></span><span id='topic+SpectraLibrary-class+2Cspectra.library+2C'></span><span id='topic+speclib'></span>

<h3>Description</h3>

<p>SpectraLibrary is an extended 'Spectra' class, with associated vegetation data ('data')
in a <a href="base.html#topic+data.frame">data.frame</a>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>spectra</code></dt><dd><p>A matrix</p>
</dd>
<dt><code>wavelength</code></dt><dd><p>A numeric vector</p>
</dd>
<dt><code>w.unit</code></dt><dd><p>A character string</p>
</dd>
<dt><code>data</code></dt><dd><p>A data.frame of vegetation data corresponding to the spectra</p>
</dd>
</dl>

<hr>
<h2 id='SpectraMatrix-class'>Class 'SpectraMatrix'</h2><span id='topic+SpectraMatrix-class'></span><span id='topic+SpectraMatrix-class+2C'></span><span id='topic+spectra.maxtrix'></span><span id='topic+as.spectra.matrix'></span>

<h3>Description</h3>

<p>SpectraMatrix is a extended 'Spectra' class.
</p>
<p>Constructor <code>as.spectra.matrix</code> creates a SpectraMatrix object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.spectra.matrix(
  spectra = matrix(0),
  wavelength = numeric(0),
  w.unit = character(0)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpectraMatrix-class_+3A_spectra">spectra</code></td>
<td>
<p>A matrix</p>
</td></tr>
<tr><td><code id="SpectraMatrix-class_+3A_wavelength">wavelength</code></td>
<td>
<p>A numeric vector</p>
</td></tr>
<tr><td><code id="SpectraMatrix-class_+3A_w.unit">w.unit</code></td>
<td>
<p>A character string</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>sdf</code></td>
<td>
<p>Returns a SpectraDataframe.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>smatrix &lt;- as.spectra.matrix(matrix(1:10, 1), 1:10, "nm")
str(smatrix)
</code></pre>

<hr>
<h2 id='sr'>Calculate Simple Ratio (SR).</h2><span id='topic+sr'></span><span id='topic+lm.sr'></span>

<h3>Description</h3>

<p>Simple Ratio is the ratio of the spectra (mostly reflectance) between two bands
in the format of </p>
<p style="text-align: center;"><code class="reqn">SR = \lambda_i/\lambda_j</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>sr(s, b1, b2)

lm.sr(s, b1, b2, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sr_+3A_s">s</code></td>
<td>
<p>Spectral data in the format of visa's Spectra object, spectra.dataframe or spectra.matrix.</p>
</td></tr>
<tr><td><code id="sr_+3A_b1">b1</code></td>
<td>
<p>A integer number which defines the wavelength of the 1st spectral band.</p>
</td></tr>
<tr><td><code id="sr_+3A_b2">b2</code></td>
<td>
<p>A integer number which defines the wavelength of the 2nd spectral band.</p>
</td></tr>
<tr><td><code id="sr_+3A_y">y</code></td>
<td>
<p>A numeric variable to correlate with SR</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simple ratio and NDVI looking indices are the two groups of mostly used spectral indices in remote sensing.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>sr</code></td>
<td>
<p>Returns a simple ratio index.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Returns a ggplot object.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(visa)
s &lt;- NSpec.DF$spectra
sr1 &lt;- sr(s, 480, 550)

s &lt;- NSpec.DF
y &lt;- NSpec.DF$N
lm.sr(s,600,500,y)

</code></pre>

<hr>
<h2 id='wavelength'>Retrieve Wavelength Information from Spectra Objects</h2><span id='topic+wavelength'></span><span id='topic+wavlen'></span><span id='topic+wavelength+2CSpectra-method'></span><span id='topic+wavelength+2CSpectra+2CANY-method'></span><span id='topic+wavelength+2Cdata.frame-method'></span><span id='topic+wavelength+2Cdata.frame+2CANY-method'></span><span id='topic+wavelength+2Cmatrix-method'></span><span id='topic+wavelength+2Cmatrix+2CANY-method'></span>

<h3>Description</h3>

<p>This function extracts the wavelength information from various representations of spectra.
It supports the S4 class <code>Spectra</code>, as well as data.frame and matrix representations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wavelength(object, ...)

## S4 method for signature 'Spectra'
wavelength(object, ...)

## S4 method for signature 'data.frame'
wavelength(object, ...)

## S4 method for signature 'matrix'
wavelength(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wavelength_+3A_object">object</code></td>
<td>
<p>An object containing spectra data. This can be an S4 object of class <code>Spectra</code>,
a <code>data.frame</code>, or a <code>matrix</code>.</p>
</td></tr>
<tr><td><code id="wavelength_+3A_...">...</code></td>
<td>
<p>Additional arguments for future extensions (currently not used).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For an object of class <code>Spectra</code>, the method returns the value stored in the <code>wavelength</code>
slot. For a data.frame or matrix, it extracts numeric values from the column names (by removing
non-digit characters) of the spectra data.
</p>


<h3>Value</h3>

<p>A numeric vector representing the wavelength information extracted from the object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  library(visa)

  # For an S4 Spectra object
  wavelengths &lt;- wavelength(NSpec.Lib)

  # For spectra stored in a data.frame
  wavelengths &lt;- wavelength(NSpec.DF)

  # For spectra stored in a matrix
  wavelengths &lt;- wavelength(spectra_matrix)

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
