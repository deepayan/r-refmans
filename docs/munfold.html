<!DOCTYPE html><html><head><title>Help for package munfold</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {munfold}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#procrustes'><p>Procrustes Rotation</p></a></li>
<li><a href='#unfold'><p>Metric Unfolding</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Metric Unfolding</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-02-08</td>
</tr>
<tr>
<td>Author:</td>
<td>Martin Elff</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Martin Elff &lt;martin@elff.eu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Multidimensional unfolding using Schoenemann's algorithm for metric
   and Procrustes rotation of unfolding results.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>Yes</td>
</tr>
<tr>
<td>Imports:</td>
<td>memisc, MASS, stats, graphics</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.elff.eu/software/munfold/">http://www.elff.eu/software/munfold/</a>,<a href="http://github.com/melff/munfold/">http://github.com/melff/munfold/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-02-08 20:11:04 UTC; elff</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-02-08 23:32:37</td>
</tr>
</table>
<hr>
<h2 id='procrustes'>Procrustes Rotation</h2><span id='topic+procrustes'></span><span id='topic+procrustes.unfolding'></span>

<h3>Description</h3>

<p><code>procrustes</code> performs procrustes rotation, at the moment only of
<code>unfold</code> solutions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>procrustes(x, ...)

## S3 method for class 'unfolding'
procrustes(x, use=attr(x,"procrustes_use"), target, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="procrustes_+3A_x">x</code></td>
<td>
<p>an object the components of which to rotate.</p>
</td></tr></table>
<p>,
</p>
<table>
<tr><td><code id="procrustes_+3A_use">use</code></td>
<td>
<p>which of the components of <code>x</code> should be used
as criterion for rotation.</p>
</td></tr>
<tr><td><code id="procrustes_+3A_target">target</code></td>
<td>
<p>a matrix to which the rotation criterion should
be brought as close as possible.</p>
</td></tr>
<tr><td><code id="procrustes_+3A_...">...</code></td>
<td>
<p>further arguments for future methods, currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a copy of <code>x</code> with components appropriately rotated. </p>

<hr>
<h2 id='unfold'>Metric Unfolding</h2><span id='topic+unfold'></span><span id='topic+biplot.unfolding'></span><span id='topic+plot.unfolding'></span><span id='topic+uapply'></span><span id='topic+unfold.matrix'></span><span id='topic+unfold.formula'></span>

<h3>Description</h3>

<p><code>unfold</code> computes a metric unfolding solution
based on a rectangular matrix, that is, reconstructs
two sets of points from the distances between points
of the first set and the points of the second set.
</p>
<p><code>uapply</code> applies a function
the two point sets that are reconstructed by <code>unfold</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unfold(x,...)

## S3 method for class 'matrix'
unfold(x, ndims=NULL, squared=FALSE, tol=1e-7,
          method=c("Schoenemann", "CG"), ...)

## S3 method for class 'formula'
unfold(x,data=parent.frame(), ...)

## S3 method for class 'unfolding'
biplot(x, dimen=c(1,2), type=attr(x,"biplot_type"),
  xlim, ylim, tpos=c(4,2), tposdim=1,
  asp=1, lty=c(1,2), lwd=c(1,1), pch=c(1,3), cex=c(1,1),
  col=c("black","black"), contour.col="black", contour.lty=1,
  xlab=paste("Dimension ",dimen[1]),
  ylab=paste("Dimension ",dimen[2]),
  ...)

## S3 method for class 'unfolding'
plot(x, y=NULL ,dimen=1, discrete=attr(x,"plot_discrete"),
  use.rownames=discrete, xlab=paste("Dimension ",dimen), ...)

uapply(x,FUN)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unfold_+3A_x">x</code></td>
<td>
<p>for <code>unfold.matrix</code>: a rectangular matrix that contains distances
or squared distances (if argument <code>squared</code> is <code>TRUE</code>).
For <code>unfold.formula</code>: a formula which specifies the variables
that form the columns of the matrix of distances.
For <code>biplot.unfolding</code> and <code>plot.unfolding</code>: an object that contains an unfolding solution.
</p>
</td></tr>
<tr><td><code id="unfold_+3A_data">data</code></td>
<td>
<p>a data frame or an environment that contains variables specified in
the formula given as first argument.</p>
</td></tr>
<tr><td><code id="unfold_+3A_ndims">ndims</code></td>
<td>
<p>an optional integer value that specifies the
dimensionality of the solution. If <code>NULL</code> the
dimensionality is selected automatically based
on a singular value decomposition of the matrix
of squared distances.
</p>
</td></tr>
<tr><td><code id="unfold_+3A_squared">squared</code></td>
<td>
<p>a logical value; does the matrix <code>D</code> contain squared distances?</p>
</td></tr>
<tr><td><code id="unfold_+3A_tol">tol</code></td>
<td>
<p>a tolerance value for the convergence of the
conjugate gradients method.</p>
</td></tr>
<tr><td><code id="unfold_+3A_method">method</code></td>
<td>
<p>a method for the iterative computation
of the unfolding solution.</p>
</td></tr>
<tr><td><code id="unfold_+3A_y">y</code></td>
<td>
<p>a dummy argument for compatibility with default methods, ignored.</p>
</td></tr>
<tr><td><code id="unfold_+3A_dimen">dimen</code></td>
<td>
<p>for <code>biplot</code>: a two-element integer vector,
for <code>plot</code>: a single integer value, that specifies
the dimension(s) of the unfolding solution to be plotted.
</p>
</td></tr>
<tr><td><code id="unfold_+3A_type">type</code></td>
<td>
<p>a character vector of length less then or equal to 2.
Determines how each of the two point sets of the unfolding
solutions are represented in the biplot.
Valid choices are
</p>

<ul>
<li><p><code>"points"</code>the respective set of points are plotted
as points in the biplot.
</p>
</li>
<li><p><code>"lines"</code>the points of the respective set
are connected by lines.
</p>
</li>
<li><p><code>"both"</code>the points of the respective set
are plotted as points and connected by lines.
</p>
</li>
<li><p><code>"text"</code>the points of the respective set
are represented by the corresponding row names
and, if argument <code>tpos</code> is present,
by points.

</p>
</li>
<li><p><code>"density"</code>contour lines are drawn of
two-dimensional kernel density estimate for the
respective set of points.
This biplot type
uses the function <code><a href="MASS.html#topic+kde2d">kde2d</a></code>
of library <code>MASS</code>.

</p>
</li></ul>

</td></tr>
<tr><td><code id="unfold_+3A_tpos">tpos</code></td>
<td>
<p>a two-element integer vector; specifies
the position of text labels relative
to the points. For the meaning of these integer values
see <code><a href="graphics.html#topic+text">text</a></code> </p>
</td></tr>
<tr><td><code id="unfold_+3A_tposdim">tposdim</code></td>
<td>
<p>an integer value; specifies which how elements of <code>tpos</code>
are used. Labels of points with negative positions along coordinate axis
<code>dimen[tposdim]</code> are positioned according to <code>tpos[1]</code>,
labels of other points are positioned according to <code>tpos[1]</code>.
</p>
</td></tr>
<tr><td><code id="unfold_+3A_xlab">xlab</code>, <code id="unfold_+3A_ylab">ylab</code>, <code id="unfold_+3A_xlim">xlim</code>, <code id="unfold_+3A_ylim">ylim</code>, <code id="unfold_+3A_asp">asp</code>, <code id="unfold_+3A_lty">lty</code>, <code id="unfold_+3A_lwd">lwd</code>, <code id="unfold_+3A_pch">pch</code>, <code id="unfold_+3A_cex">cex</code>, <code id="unfold_+3A_col">col</code></td>
<td>
<p>arguments passed to base graphics functions</p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code id="unfold_+3A_contour.col">contour.col</code>, <code id="unfold_+3A_contour.lty">contour.lty</code></td>
<td>
<p>colour and line type for contour lines,
see <code><a href="graphics.html#topic+contour">contour</a></code>. </p>
</td></tr>
<tr><td><code id="unfold_+3A_discrete">discrete</code></td>
<td>
<p>a logical vector of lenght 2;
if <code>TRUE</code>, the respective set of points are represented
by spikes in theplot, otherwise the set is represented
by a graph of a kernel density estimate.
</p>
</td></tr>
<tr><td><code id="unfold_+3A_use.rownames">use.rownames</code></td>
<td>
<p>logical; should row names used for annotation?</p>
</td></tr>
<tr><td><code id="unfold_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="stats.html#topic+optim">optim</a></code> in
case of <code>unfold</code> or <code><a href="graphics.html#topic+points">points</a></code>
in case of the plotting methods.</p>
</td></tr>
<tr><td><code id="unfold_+3A_fun">FUN</code></td>
<td>
<p>a function applied to the two sets of points that result
from the unfolding.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>unfold</code> first computes an unfolding solution according to
Schoenemanns metric unfolding algorithm that uses only
linear algebra operations. This preliminary solution is
then refined by minimizing the stress using a conjugate-gradients
method.
</p>
<p><code>uapply</code> applies a given function to the two sets of points
recovered by an unfolding solution. It applies the function
to the components <code>A</code> and <code>B</code> of an object
of class <code>"unfolding"</code>.
</p>


<h3>Value</h3>

<p><code>unfold</code> returns an object of class <code>"unfolding"</code>
with components
</p>
<table>
<tr><td><code>A</code></td>
<td>
<p>a numeric matrix representing
the first set of points. Each row contains the coordinate
of one point of the first set.</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>a numeric matrix representing
the second set of points. Each row contains the coordinate
of one point of the second set.</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>a numeric matrix that contains the
fitted squared distances.</p>
</td></tr>
<tr><td><code>stress</code></td>
<td>
<p>A stress value, denotes the &quot;badness of fit&quot;.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>r &lt;- seq(from=0,to=2*pi,length=24)
a1 &lt;- cos(r)*4 + 0.00001*rnorm(r)
a2 &lt;- sin(r)*4 + 0.00001*rnorm(r)
b1 &lt;- c(.5,-.5,-.5,.5)*3 + 5
b2 &lt;- c(.5,.5,-.5,-.5)*3 + 1

D1 &lt;- outer(b1,a1,"-")
D2 &lt;- outer(b2,a2,"-")

Dsq &lt;- D1^2+D2^2


Dsq.uf&lt;-unfold(sqrt(Dsq),squared=FALSE)

oldpar &lt;- par(mfrow=c(1,2))
A &lt;- cbind(a1,a2)
B &lt;- cbind(b1,b2)

ltype &lt;- c(rep(1,NROW(A)),rep(2,NROW(A)))

orig &lt;- rbind(A,B)
unfolded &lt;- rbind(Dsq.uf$A,Dsq.uf$B)

xlim &lt;- ylim &lt;- range(orig)#*1.5

plot(A,type="b",pch=1,
    xlim=xlim,ylim=ylim,
    xlab="Dimension 1",ylab="Dimension 2",main=expression("Original data"),asp=1)
lines(B,type="b",pch=3,lty=2)
abline(h=0,v=0,lty=3)

biplot(Dsq.uf,type="b",
    xlim=xlim,ylim=ylim,
    main=expression(paste(italic(unfold)," solution")),asp=1)


par(oldpar)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
