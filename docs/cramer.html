<!DOCTYPE html><html><head><title>Help for package cramer</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cramer}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cramer-package'><p>Cramer-Test for uni- and multivariate two-sample-problem</p></a></li>
<li><a href='#cramer.test'><p>Perform Cramer-Test for uni- and multivariate two-sample-problem</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.9-4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-04</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Nonparametric Cramer-Test for the
Two-Sample-Problem</td>
</tr>
<tr>
<td>Author:</td>
<td>Carsten Franz &lt;carsten.franz@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Carsten Franz &lt;carsten.franz@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 0.65), boot</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides R routine for the so called two-sample
        Cramer-Test.  This nonparametric two-sample-test on equality
        of the underlying distributions can be applied to 
        multivariate data as well as univariate data. It offers two 
        possibilities to approximate the critical value both of which 
        are included in this package.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.12)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-04 17:07:59 UTC; carsten</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-05 21:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cramer-package'>Cramer-Test for uni- and multivariate two-sample-problem</h2><span id='topic+cramer'></span><span id='topic+cramer-package'></span>

<h3>Description</h3>

<p>Provides R routine for the so called two-sample Cramer-Test. This nonparametric two-sample-test on equality of the underlying distributions can be applied to multivariate data as well as univariate data. It offers two possibilities to approximate the critical value both of which are included in this package.
</p>


<h3>Author(s)</h3>

<p>Carsten Franz &lt;carsten.franz@gmail.com&gt;
</p>

<hr>
<h2 id='cramer.test'>Perform Cramer-Test for uni- and multivariate two-sample-problem</h2><span id='topic+cramer.test'></span>

<h3>Description</h3>

<p>Perform Cramér-test for two-sample-problem. 
</p>
<p>Both univariate and multivariate data is possible. For calculation of the critical value
Monte-Carlo-bootstrap-methods and eigenvalue-methods are available. For the bootstrap
access ordinary and permutation methods can be chosen as well as the number
of bootstrap-replicates taken.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cramer.test(
  x,
  y,
  conf.level = 0.95,
  replicates = 1000,
  sim = "ordinary",
  just.statistic = FALSE,
  kernel = "phiCramer",
  maxM = 2^14,
  K = 160
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cramer.test_+3A_x">x</code></td>
<td>
<p>First set of observations. Either in vector form (univariate) or in a matrix with 
one observation per row (multivariate).</p>
</td></tr>
<tr><td><code id="cramer.test_+3A_y">y</code></td>
<td>
<p>Second set of observations. Same dimension as <code>x</code>.</p>
</td></tr>
<tr><td><code id="cramer.test_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level of test. The default is <code>conf.level=0.95</code>.</p>
</td></tr>
<tr><td><code id="cramer.test_+3A_replicates">replicates</code></td>
<td>
<p>Number of bootstrap-replicates taken to obtain critical value. The default 
is <code>replicates=1000</code>. When using the eigenvalue method, this variable is unused.</p>
</td></tr>
<tr><td><code id="cramer.test_+3A_sim">sim</code></td>
<td>
<p>Type of Monte-Carlo-bootstrap method or eigenvalue method. Possible values are
<code>"ordinary"</code> (default) for normal Monte-Carlo-bootstrap, <code>"permutation"</code>
for a permutation Monte-Carlo-bootstrap or <code>"eigenvalue"</code> for bootstrapping
the limit distribution, evaluating the (approximate) eigenvalues being the weights
of the limiting chisquared-distribution and using the critical value of this
approximation (calculated via fast fourier transform). This method is especially good 
if the dataset is too large to perform Monte-Carlo-bootstrapping (although it must not
be too large so the matrix eigenvalue problem can still be solved).</p>
</td></tr>
<tr><td><code id="cramer.test_+3A_just.statistic">just.statistic</code></td>
<td>
<p>Boolean variable. If <code>TRUE</code> just the value of the Cram<code class="reqn">\mbox{\'e}</code>r-statistic
is calculated and no bootstrap-replicates are produced.</p>
</td></tr>
<tr><td><code id="cramer.test_+3A_kernel">kernel</code></td>
<td>
<p>Character-string giving the name of the kernel function. The default is <code>"phiCramer"</code> which
is the Cram<code class="reqn">\mbox{\'e}</code>r-test included 
in earlier versions of this package and which is used in the paper of Baringhaus and the author mentioned 
below. It is possible to use user-defined kernel functions here. The functions needs to be able to deal with
matrix arguments. Kernel functions need to be defined on 
the positive real line with value 0 at 0 and have a non-constant completely monotone first 
derivative. An example is show in the Examples section below. Build-in functions are <code>"phiCramer"</code>,
<code>"phiBahr"</code>, <code>"phiLog"</code>, <code>"phiFracA"</code> and <code>"phiFracB"</code>.</p>
</td></tr>
<tr><td><code id="cramer.test_+3A_maxm">maxM</code></td>
<td>
<p>Gives the maximum number of points used for the fast fourier transform. When using
Monte-Carlo-bootstrap methods, this variable is unused.</p>
</td></tr>
<tr><td><code id="cramer.test_+3A_k">K</code></td>
<td>
<p>Gives the upper value up to which the integral for the calculation of the
distribution function out of the characteristic function (Gurlands formula) is
evaluated. The default ist 160. Careful: When increasing <code>K</code> it is necessary to 
increase <code>maxM</code> as well since the resolution of the points where the distribution 
function is calculated is </p>
<p style="text-align: center;"><code class="reqn">\frac{2\pi}{K}.</code>
</p>

<p>Thus, if just <code>K</code> is increased the maximum value, where the distribution function
is calculated is lower. 
When using Monte-Carlo-bootstrap methods, this variable is unused.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Cramér-statistic is given by
</p>
<p style="text-align: center;"><code class="reqn">T_{m,n} = \frac{mn}{m+n}\biggl(\frac{2}{mn}\sum_{i,j}^{m,n}\phi(\|\vec{X}_i-\vec{Y}_j\|^2)-\frac{1}{m^2}\sum_{i,j=1}^m\phi(\|\vec{X}_{i}-\vec{X}_{j}\|^2)</code>
</p>

<p style="text-align: center;"><code class="reqn">-\frac{1}{n^2}\sum_{i,j=1}^n\phi(\|\vec{Y}_{i}-\vec{Y}_{j}\|^2)\biggr),</code>
</p>

<p>The function <code class="reqn">\phi</code> is the kernel function mentioned in the Parameters section.
The proof that the Monte-Carlo-Bootstrap and eigenvalue methods work is given in the reference given below. Other build-in kernel functions are
</p>
<p style="text-align: center;"><code class="reqn">\phi_{Cramer}(z)=\sqrt{z}/2</code>
</p>
<p> (recommended for location alternatives),
</p>
<p style="text-align: center;"><code class="reqn">\phi_{Bahr}(z)=1-\exp(-z/2)</code>
</p>
<p> (recommended for dispersion as well as location alternatives),
</p>
<p style="text-align: center;"><code class="reqn">\phi_{log}(z)=\log(1+z)</code>
</p>
<p> (preferrably for location alternatives),
</p>
<p style="text-align: center;"><code class="reqn">\phi_{FracA}(z)=1-\frac{1}{1+z}</code>
</p>
<p> (preferrably for dispersion alternatives) and
</p>
<p style="text-align: center;"><code class="reqn">\phi_{FracB}(z)=1-\frac{1}{(1+z)^2}.</code>
</p>
<p> (also for dispersion alternatives). 
Test performance was investigated in the below referenced 2010 publication. The idea of using this statistic is 
due to L. Baringhaus, University of Hanover.
</p>


<h3>Value</h3>

<p>The returned value is an object of class <code>"cramertest"</code>, containing the following components:
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>Describing the test in words.</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>Dimension of the observations.</p>
</td></tr>
<tr><td><code>m</code></td>
<td>
<p>Number of <code>x</code> observations.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Number of <code>y</code> observations.</p>
</td></tr> 
<tr><td><code>statistic</code></td>
<td>
<p>Value of the Cram<code class="reqn">\mbox{\'e}</code>r-statistic for the given observations.</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>Confidence level for the test.</p>
</td></tr>
<tr><td><code>crit.value</code></td>
<td>
<p>Critical value calculated by bootstrap method, eigenvalue method, respectively. When using 
the eigenvalue method, the distribution under the hypothesis will be interpolated linearly.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>Estimated p-value of the test.</p>
</td></tr>
<tr><td><code>result</code></td>
<td>
<p>Contains <code>1</code> if the hypothesis of equal distributions should not be accepted and <code>0</code> otherwise.</p>
</td></tr>
<tr><td><code>sim</code></td>
<td>
<p>Method used for obtaining the critical value.</p>
</td></tr>
<tr><td><code>replicates</code></td>
<td>
<p>Number of bootstrap-replicates taken.</p>
</td></tr>
<tr><td><code>ev</code></td>
<td>
<p>Contains eigenvalues and eigenfunctions when using the eigenvalue-method to obtain the critical value</p>
</td></tr>
<tr><td><code>hypdist</code></td>
<td>
<p>Contains the via fft reconstructed distribution function under the hypothesis. <code>$x</code>
contains the x-values and <code>$Fx</code> the values of the distribution function at the positions.</p>
</td></tr>
</table>


<h3>References</h3>

<p>The test and its properties is described in:
</p>

<ul>
<li><p>Baringhaus, L. and Franz, C. (2004) <em>On a new multivariate two-sample test</em>, Journal of Multivariate Analysis, 88, p. 190-206
</p>
</li>
<li><p>Baringhaus, L. and Franz, C. (2010) <em>Rigid motion invariant two-sample tests</em>, Statistica Sinica 20, 1333-1361
</p>
</li></ul>

<p>The test of Bahr is also discussed in:
</p>
  
<ul>
<li><p>Bahr, R. (1996) <em>Ein neuer Test fuer das mehrdimensionale Zwei-Stichproben-Problem bei allgemeiner Alternative</em>, German, Ph.D. thesis, University of Hanover
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># comparison of two univariate normal distributions
x&lt;-rnorm(20,mean=0,sd=1)
y&lt;-rnorm(50,mean=0.5,sd=1)
cramer.test(x,y)

# comparison of two multivariate normal distributions with permutation test:
# library "MASS" for multivariate routines (included in package "VR")
 
# library(MASS)
# x&lt;-mvrnorm(n=20,mu=c(0,0),Sigma=diag(c(1,1)))
# y&lt;-mvrnorm(n=50,mu=c(0.3,0),Sigma=diag(c(1,1)))
# cramer.test(x,y,sim="permutation")

# comparison of two univariate normal distributions with Bahrs Kernel
phiBahr&lt;-function(x) return(1-exp(-x/2))
x&lt;-rnorm(20,mean=0,sd=1)
y&lt;-rnorm(50,mean=0,sd=2)
cramer.test(x,y,sim="eigenvalue",kernel="phiBahr")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
